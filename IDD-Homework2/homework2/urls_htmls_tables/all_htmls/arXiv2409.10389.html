<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation</title>
<!--Generated on Mon Sep 16 15:16:57 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
Few-shot Learning,  Semantic Segmentation,  Few-shot Segmentation,  Prompt Learning
" lang="en" name="keywords"/>
<base href="/html/2409.10389v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S1" title="In Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S2" title="In Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span><span class="ltx_text ltx_font_smallcaps">Related Work</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S2.SS1" title="In 2 Related Work ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span><span class="ltx_text ltx_font_italic">Few-shot Learning</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S2.SS2" title="In 2 Related Work ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span><span class="ltx_text ltx_font_italic">Few-shot Segmentation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S2.SS3" title="In 2 Related Work ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span><span class="ltx_text ltx_font_italic">Prompt Learning</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3" title="In Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span><span class="ltx_text ltx_font_smallcaps">Methodology</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.SS1" title="In 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span><span class="ltx_text ltx_font_italic">Problem Definition</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.SS2" title="In 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span><span class="ltx_text ltx_font_italic">Method Overall</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.SS3" title="In 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span><span class="ltx_text ltx_font_italic">Prompt Initialization</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.SS4" title="In 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span><span class="ltx_text ltx_font_italic">Prompt Enhancement</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.SS4.SSS1" title="In 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.1 </span> Part Mask Generator (PMG)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.SS4.SSS2" title="In 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.2 </span>Semantic Prompt Transfer (SPT)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.SS5" title="In 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span><span class="ltx_text ltx_font_italic">Prompting</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.SS6" title="In 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span><span class="ltx_text ltx_font_italic">Matching</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4" title="In Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span><span class="ltx_text ltx_font_smallcaps">Experiments</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS1" title="In 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span><span class="ltx_text ltx_font_italic">Experimental Setup</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS1.SSS1" title="In 4.1 Experimental Setup ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Datasets and Evaluation Metric</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS1.SSS2" title="In 4.1 Experimental Setup ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Implementation details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS2" title="In 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span><span class="ltx_text ltx_font_italic">Comparison with the State of-the-Arts</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS2.SSS1" title="In 4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>Quantitative Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS2.SSS2" title="In 4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span>Qualitative Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS3" title="In 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span><span class="ltx_text ltx_font_italic">Ablation Studies</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS3.SSS1" title="In 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Component Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS3.SSS2" title="In 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Ablation study on Prompt Initialization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS3.SSS3" title="In 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.3 </span>Ablation study on Prompt Enhancement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS3.SSS4" title="In 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.4 </span>Ablation study on Backbone Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS3.SSS5" title="In 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.5 </span>Comparison employing the Consistent Encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS3.SSS6" title="In 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.6 </span>Combination of PAT and other FSS methods</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS4" title="In 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span><span class="ltx_text ltx_font_italic">Extended Experiments</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS4.SSS1" title="In 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.1 </span>Cross-domain Few-shot Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS4.SSS2" title="In 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.2 </span>Weak-label Few-shot Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS4.SSS3" title="In 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.3 </span>Zero-shot Segmentation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS5" title="In 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span><span class="ltx_text ltx_font_italic">Failure case analysis</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S5" title="In Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span><span class="ltx_text ltx_font_smallcaps">Conclusion</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hanbo Bi, Yingchao Feng, 
Wenhui Diao, 
Peijin Wang, 
<br class="ltx_break"/>Yongqiang Mao, 
Kun Fu, 
Hongqi Wang, 
<br class="ltx_break"/>and Xian Sun
</span><span class="ltx_author_notes">
H. Bi, K. Fu, X. Sun are with the Aerospace Information Research Institute, Chinese Academy of Sciences, Beijing 100190, China, also with the School of Electronic, Electrical and Communication Engineering, University of Chinese Academy of Sciences, Beijing 100190, China, also with the University of Chinese Academy of Sciences, Beijing 100190, China, and also with the Key Laboratory of Network Information System Technology (NIST), Aerospace Information Research Institute, Chinese Academy of Sciences, Beijing 100190, China.
Y. Feng, W. Diao, P. Wang, and H. Wang are with the Aerospace Information Research Institute, Chinese Academy of Sciences, Beijing 100190, China, and also with the Key Laboratory of Network Information System Technology (NIST), Aerospace Information Research Institute, Chinese Academy of Sciences, Beijing 100094, China.
Y. Mao is with the Department of Electronic Engineering, Tsinghua University, Beijing 100084, China.
Corresponding authors: X. Sun (e-mail: sunxian@aircas.ac.cn).
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">For more efficient generalization to unseen domains (classes), most Few-shot Segmentation (FSS) would directly exploit pre-trained encoders and only fine-tune the decoder, especially in the current era of large models. However, such fixed feature encoders tend to be class-agnostic, inevitably activating objects that are irrelevant to the target class. In contrast, humans can effortlessly focus on specific objects in the line of sight. This paper mimics the visual perception pattern of human beings and proposes a novel and powerful prompt-driven scheme, called “Prompt and Transfer” (PAT), which constructs a dynamic class-aware prompting paradigm to tune the encoder for focusing on the interested object (target class) in the current task. Three key points are elaborated to enhance the prompting: 1) Cross-modal linguistic information is introduced to initialize prompts for each task. 2) Semantic Prompt Transfer (SPT) that precisely transfers the class-specific semantics within the images to prompts. 3) Part Mask Generator (PMG) that works in conjunction with SPT to adaptively generate different but complementary part prompts for different individuals. Surprisingly, PAT achieves competitive performance on 4 different tasks including standard FSS, Cross-domain FSS (e.g., CV, medical, and remote sensing domains), Weak-label FSS, and Zero-shot Segmentation, setting new state-of-the-arts on 11 benchmarks.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Few-shot Learning, Semantic Segmentation, Few-shot Segmentation, Prompt Learning

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">With the growing wave of deep learning, various computer vision tasks have made remarkable progress, such as image classification, object detection, semantic segmentation, spatiotemporal prediction, and 3D reconstruction <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib12" title="">12</a>]</cite>. However, such techniques are data-driven and tend to fail with satisfactory performance when labeled data is insufficient <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib14" title="">14</a>]</cite>. Even though semi-supervised learning has been suggested to tackle the problem of data scarcity, they fail to generalize well to the unseen (novel) classes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib17" title="">17</a>]</cite>. In contrast, humans can recognize new patterns or concepts easily from a few examples. The vast gap has tremendously aroused the interest of researchers. Thus, Few-shot Learning (FSL) has been developed to generalize quickly to unseen domains (classes) with a handful of labeled samples <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib21" title="">21</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="198" id="S1.F1.g1" src="extracted/5858111/Figure/motivation.jpg" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span> (a) Comparison of our PAT and previous work. For more efficient generalization, most FSS methods prefer to directly employ the pre-trained encoders and only fine-tune the decoder. However, such frozen feature encoders tend to be class-agnostic, inevitably activating other classes irrelevant to the current FSS task (the 2nd row), due to their semantic clues derived from pre-training on image classification. (b) Human visual perception pattern. When processing visual stimuli from the retina, the cerebral cortex simultaneously parses stimuli from the mental, sound, etc., in the current state, selectively focusing on specific objects in view while leaving the rest parts in the shadow of consciousness. Inspired by the unique visual perception pattern, our “Prompt and Transfer” (PAT) method instead dynamically drives the encoder to focus on specific objects in a class-aware prompting manner (the 3rd row in (a)).</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Few-shot Segmentation (FSS) is the application of FSL to the task of semantic segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib22" title="">22</a>]</cite>. Given the original (query) image, the FSS model aims at segmenting objects of the specific category in the query image by utilizing one or several labeled samples, namely support images. Remarkably, the categories segmented are unseen and rely solely on several support images to provide target category information. For more efficient generalization to unseen classes, most FSS researchers would directly employ pre-trained encoders (e.g., ResNet-50 trained on ImageNet-1K <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib23" title="">23</a>]</cite>) and only fine-tune the decoder <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib30" title="">30</a>]</cite>. A major reason for this trend is to prevent the feature encoder from being biased towards seen (base) classes during the training phase <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib33" title="">33</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Despite the promising progress, we observe that these methods overlook a critical issue, i.e., such feature encoders with fixed parameters tend to be class-agnostic. In other words, they will inevitably activate other classes irrelevant to the target class in FSS tasks, due to their semantic clues derived from pre-training on image classification (e.g., ImageNet-1K). As depicted in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>(a), the encoder fails to effectively focus on task objects such as ”Train” and ”Sofa”, and likewise activates irrelevant regions around them. Such cluttered features would exacerbate the burden on the subsequent decoder to segment novel classes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib36" title="">36</a>]</cite>. Even though FSS researchers have designed various powerful decoders such as HSNet’s 4D convolution <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib30" title="">30</a>]</cite> and CyCTR’s transformer variant <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib37" title="">37</a>]</cite>, to perform more precise feature matching for superior segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib44" title="">44</a>]</cite> (see Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>(a)-(c)), the irrelevant activation introduced by the frozen encoder has not been substantially addressed.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Humans can selectively focus on critical objects in a unique pattern of visual perception, which is because ”<span class="ltx_text ltx_font_italic" id="S1.p4.1.1">we are not passive recipients of retinal information, but active participants in the perceptual process</span>” <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib45" title="">45</a>]</cite>. As depicted in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>(b)), when processing stimuli from the retina, the cerebral cortex simultaneously parses other stimuli from the psyche, sound, etc., selectively focusing on specific objects in view while leaving other parts in the shadow of consciousness. Inspired by this, we argue that the ideal feature encoder in FSS should be class-aware, activating corresponding class objects for different tasks, even for unseen classes. Prompt learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib49" title="">49</a>]</cite>, which aims to construct several prompt words or vectors to provide prior task information to the model and adapt the model behavior to task-specific patterns, provides us with the solution. Thus, this work proposes a prompt-driven scheme for FSS, dynamically prompting the encoder to focus on class-specific objects in the query image for class-aware enhancement (see Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>(d)), called ”Prompt and Transfer”, i.e., <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">PAT</span>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Concretely, the core of PAT is to adaptively learn class-specific prompts from the support- and query- pixels in the current task, which will continuously interact with image features through the self-attention structure <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib50" title="">50</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib51" title="">51</a>]</cite> of the encoder to generate the image features focused on specific objects, i.e., class-aware features. In this case, without the need to design complex decoders, effective segmentation can be achieved by utilizing these prompts for simple similarity computation with the class-aware features. Against this background, it is crucial to dynamically derive the corresponding effective prompts for different tasks. PAT elaborates on three key points for the enhancement of dynamic class-aware prompting:</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><span class="ltx_text ltx_font_bold" id="S1.p6.1.1">Firstly,</span> we introduce cross-modal linguistic information to endow prompts with initial class-awareness in each task. The insight behind such an operation is that the pre-trained language model can characterize category-representative textual semantics based on different task descriptions, thus initially localizing the target object in the visual feature. <span class="ltx_text ltx_font_bold" id="S1.p6.1.2">Secondly,</span> we design the Semantic Prompt Transfer (SPT) to continuously enhance the dynamic class-awareness of prompts. For better tuning the encoder to focus on the target class in the current task, SPT then adaptively transfers the target semantics within a specific region (e.g., foreground region) to the prompts via the cross-attention manner, where Gaussian suppression is proposed to optimize the attention distribution. Considering the vast gap between the image pair resulting from the large intra-class variations and cluttered background, singularly capturing target semantics from the support image is inadequate. We attempt to construct the pseudo-mask for the query image and then utilize it for guiding SPT to capture the target clues of the query itself, thus bridging the semantic gap. <span class="ltx_text ltx_font_bold" id="S1.p6.1.3">Thirdly,</span> we construct the Part Mask Generator (PMG) to mine fine-grained part-level semantic prompts. To enhance the semantic diversity of the prompts, PMG adaptively generates a series of part-level local masks for different individuals in different tasks. The SPT, with the help of PMG, can constrain different prompts to aggregate the semantics under different part masks, yielding different but complementary part prompts. In this way, the redundancy of prompts is avoided and local semantic clues are fully explored simultaneously.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Extensive experiments on popular FSS benchmarks validate the effectiveness of PAT, which sets new state-of-the-art performance. Moreover, due to its flexibility, we extend it to three more realistic yet complex scenarios, including Cross-domain FSS (e.g., CV, medical, and remote sensing domains), Weak-label FSS, and Zero-shot Segmentation (ZSS) (see Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S1.F3" title="Figure 3 ‣ 1 Introduction ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">3</span></a>). In summary, our primary contributions can be summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">This paper mimics the visual perception pattern of humans and develops a novel dynamic class-aware prompting paradigm (PAT) to tune the encoder for focusing on specific objects in different FSS tasks.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Three key points including Prompt Initialization, Semantic Prompt Transfer, and Part Mask Generator, are constructed to assign class-specific semantics to prompts for better enhancing the dynamic class-aware prompting.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.2">The prompt-driven scheme establishes new state-of-the-arts under all settings on three standard FSS benchmarks, including PASCAL-5<sup class="ltx_sup" id="S1.I1.i3.p1.2.1"><span class="ltx_text ltx_font_italic" id="S1.I1.i3.p1.2.1.1">i</span></sup>, COCO-20<sup class="ltx_sup" id="S1.I1.i3.p1.2.2"><span class="ltx_text ltx_font_italic" id="S1.I1.i3.p1.2.2.1">i</span></sup> and iSAID.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We extend the proposed method to three more realistic yet challenging tasks, including Cross-domain, Weak-label, and Zero-shot Segmentation, comprehensively demonstrating its versatility and flexibility.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="172" id="S1.F2.g1" src="extracted/5858111/Figure/framework_contrast.jpg" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span> Overview of various Few-shot Segmentation (FSS) structures. (a) Prototype Matching-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib42" title="">42</a>]</cite>. (b) Feature Fusion-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib32" title="">32</a>]</cite>. (c) Pixel Matching-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib53" title="">53</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib54" title="">54</a>]</cite>. (d) Our ”Prompt and Transfer” (PAT) method, dynamically generates part-level semantic prompts (i.e. part prompts) to tune the encoder for activating class-specific objects in the query image.</figcaption>
</figure>
<figure class="ltx_figure" id="S1.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="409" id="S1.F3.g1" src="extracted/5858111/Figure/Comparison.jpg" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Our PAT has performed excellently (11 received SOTA) on 12 benchmarks over 4 different tasks. All results are obtained with the backbone of Deit-B/16 under the 1-shot setting (except for Zero-shot Segmentation).</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Related Work</span>
</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span><span class="ltx_text ltx_font_italic" id="S2.SS1.1.1">Few-shot Learning</span>
</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Recently, community researchers have proposed Few-shot Learning (FSL) to explore the generalizability in unseen domains, which can quickly identify unseen classes with limited samples. The vast majority of current methods follow the meta-learning paradigm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib18" title="">18</a>]</cite>, where transferable meta-knowledge is learned from a series of tasks (i.e., episodes) sampled from a base dataset and generalized to novel tasks. On this basis, such methods can be further subdivided into two branches: (1) Optimization-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib56" title="">56</a>]</cite>, aiming to derive the most appropriate parameters to enable the model to be rapidly adapted to novel tasks. (2) Metrics-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib57" title="">57</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib58" title="">58</a>]</cite>, aiming to learn a specific distance metric, e.g., cosine similarity distance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib19" title="">19</a>]</cite>, Euclidean distance<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib57" title="">57</a>]</cite>, to derive similarities between different objects in the embedding space. Inspired by the utilization of textual information for classification in the recent FSL method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib59" title="">59</a>]</cite>, we attempt to introduce the textual information of language modality to the segmentation task for tackling the lack of semantics under the low-data regime.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span><span class="ltx_text ltx_font_italic" id="S2.SS2.1.1">Few-shot Segmentation</span>
</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Few-shot Segmentation (FSS) is the extension of Few-shot Learning for handling dense prediction tasks that aim to segment unseen classes in the query image with several labeled samples <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib22" title="">22</a>]</cite>.
Previous FSS methods can be divided broadly into three branches: (1) prototype matching-based methods (see Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>(a)) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib31" title="">31</a>]</cite>, which compress the support features into one or multiple category-representative prototypes through Mask Average Pooling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib24" title="">24</a>]</cite>. For example, SSPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib42" title="">42</a>]</cite> aims to aggregate prototypes from semantic clues of the query image itself to guide its segmentation. DCPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib31" title="">31</a>]</cite> subdivides the support features into several prototype proxies with different properties. (2) feature fusion-based methods (see Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>(b)) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib52" title="">52</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib60" title="">60</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib61" title="">61</a>]</cite>, which aggregates support- and query- features for feature fusion. For example, HSNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib30" title="">30</a>]</cite> constructs multi-scale feature fusion utilizing 4D convolution. IPMT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>]</cite> integrates support- and query- semantics into an intermediate prototype to bridge the gap between image pairs. (3) pixel matching-based methods (see Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>(c)) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib53" title="">53</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib54" title="">54</a>]</cite>, which further consider the similarity between support-query pixel pairs. For example, CyCTR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib37" title="">37</a>]</cite> aggregates the pixel-level semantics of the support image via the cross-attention structure. Overall, the majority of previous methods simply employ the frozen pre-trained encoders and focus on designing various decoders to achieve superior feature matching.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Recently several researchers have indicated the potential and necessity of exploring a feature encoder that serves the FSS task, in addition to designing powerful decoders. SVF <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib62" title="">62</a>]</cite> argues that fine-tuning a small part of the encoder parameters not only avoids overfitting the base class but also allows for a better generalization to novel classes. Specifically, it decomposes the parameters of the encoder into three successive matrices via the Singular Value Decomposition (SVD), where only the singular value matrix is fine-tuned while keeping others frozen. In addition, BAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib40" title="">40</a>]</cite> additionally trains a base learner (i.e., encoder) to explicitly identify base classes, i.e., regions that do not need to be segmented, to better focus on novel classes. Different from them, this work develops a novel dynamic class-aware encoder that selectively focuses on corresponding classes within the image for different tasks (i.e., novel classes) in a prompting manner.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span><span class="ltx_text ltx_font_italic" id="S2.SS3.1.1">Prompt Learning</span>
</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Prompt Learning was first proposed in NLP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib63" title="">63</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib64" title="">64</a>]</cite>, which aims to construct several prompt words or vectors to provide prior task information to the model and adapt the model behavior to task-specific patterns. Inspired by its huge success, some recent works in CV have attempted to introduce a series of learnable parameters to activate the corresponding semantic knowledge in the visual model for different tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib59" title="">59</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib49" title="">49</a>]</cite>. Such the paradigm of prompting models to activate different semantics for different tasks matches well with the meta-learning framework in FSL, which expects to learn generalizability from a series of tasks. Recent works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib65" title="">65</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib66" title="">66</a>]</cite> have explored combining prompt learning and few-shot learning. For example, SP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib59" title="">59</a>]</cite> leverages semantic information as prompts to tune the visual feature encoder adaptively in the Few-shot Classification task. FPTrans <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib66" title="">66</a>]</cite> directly takes the support prototypes as prompts, which interact with the query feature in the encoder to activate the object. However, forcing the support prototypes as prompts to activate the query feature may be sub-optimal due to the differences between image pairs. In this paper, we construct class-specific prompts for different tasks (i.e., novel classes). For further enhancing prompting, besides introducing cross-modal linguistic information to initialize prompts, Semantic Prompt Transfer and Part Mask Generator are proposed to transfer the fine-grained local semantics of support and query images to prompts.</p>
</div>
<figure class="ltx_figure" id="S2.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="278" id="S2.F4.g1" src="extracted/5858111/Figure/framework.jpg" width="550"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Overview structure of the proposed PAT. PAT first derives the image tokens through the Embedding layer. Then a pre-trained text encoder is introduced to mine representative textual semantics, which along with randomly initialized embeddings are utilized as the initial prompts to interact with image features. For better enhancing the dynamic class-aware prompting, Prompt Enhancement is introduced to adaptively transfer the target semantics within a specific region (e.g., fine-grained local regions) from the support/query image to prompts via the Semantic Prompt Transfer and Part Mask Generator. These prompts will in turn interact with image features in the next encoder block to activate specific objects within the features. After several alternations of prompting and transferring in the encoder blocks, the derived prompts are directly utilized to perform similarity computation with the class-aware query feature to produce the segmentation results in the Matching Head. Notably, we only describe the encoder blocks that perform the Prompt Enhancement, while omitting others.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Methodology</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span><span class="ltx_text ltx_font_italic" id="S3.SS1.1.1">Problem Definition</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.16"><span class="ltx_text ltx_font_bold" id="S3.SS1.p1.16.1">Standard FSS:</span> The purpose of Few-shot Segmentation (FSS) is to segment unseen objects utilizing several labeled images. Specifically, given two datasets <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.16.2">D</em><sub class="ltx_sub" id="S3.SS1.p1.16.3"><span class="ltx_text ltx_font_italic" id="S3.SS1.p1.16.3.1">train</span></sub> and <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.16.4">D</em><sub class="ltx_sub" id="S3.SS1.p1.16.5"><span class="ltx_text ltx_font_italic" id="S3.SS1.p1.16.5.1">val</span></sub> with seen classes <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.16.6">C</em><sub class="ltx_sub" id="S3.SS1.p1.16.7"><span class="ltx_text ltx_font_italic" id="S3.SS1.p1.16.7.1">seen</span></sub> and unseen classes <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.16.8">C</em><sub class="ltx_sub" id="S3.SS1.p1.16.9"><span class="ltx_text ltx_font_italic" id="S3.SS1.p1.16.9.1">unseen</span></sub> (<math alttext="C_{seen}\cap C_{unseen}=\emptyset" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mrow id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml"><msub id="S3.SS1.p1.5.m5.1.1.2.2" xref="S3.SS1.p1.5.m5.1.1.2.2.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.2.2" xref="S3.SS1.p1.5.m5.1.1.2.2.2.cmml">C</mi><mrow id="S3.SS1.p1.5.m5.1.1.2.2.3" xref="S3.SS1.p1.5.m5.1.1.2.2.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.2.3.2" xref="S3.SS1.p1.5.m5.1.1.2.2.3.2.cmml">s</mi><mo id="S3.SS1.p1.5.m5.1.1.2.2.3.1" xref="S3.SS1.p1.5.m5.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m5.1.1.2.2.3.3" xref="S3.SS1.p1.5.m5.1.1.2.2.3.3.cmml">e</mi><mo id="S3.SS1.p1.5.m5.1.1.2.2.3.1a" xref="S3.SS1.p1.5.m5.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m5.1.1.2.2.3.4" xref="S3.SS1.p1.5.m5.1.1.2.2.3.4.cmml">e</mi><mo id="S3.SS1.p1.5.m5.1.1.2.2.3.1b" xref="S3.SS1.p1.5.m5.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m5.1.1.2.2.3.5" xref="S3.SS1.p1.5.m5.1.1.2.2.3.5.cmml">n</mi></mrow></msub><mo id="S3.SS1.p1.5.m5.1.1.2.1" xref="S3.SS1.p1.5.m5.1.1.2.1.cmml">∩</mo><msub id="S3.SS1.p1.5.m5.1.1.2.3" xref="S3.SS1.p1.5.m5.1.1.2.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.3.2" xref="S3.SS1.p1.5.m5.1.1.2.3.2.cmml">C</mi><mrow id="S3.SS1.p1.5.m5.1.1.2.3.3" xref="S3.SS1.p1.5.m5.1.1.2.3.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.3.3.2" xref="S3.SS1.p1.5.m5.1.1.2.3.3.2.cmml">u</mi><mo id="S3.SS1.p1.5.m5.1.1.2.3.3.1" xref="S3.SS1.p1.5.m5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m5.1.1.2.3.3.3" xref="S3.SS1.p1.5.m5.1.1.2.3.3.3.cmml">n</mi><mo id="S3.SS1.p1.5.m5.1.1.2.3.3.1a" xref="S3.SS1.p1.5.m5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m5.1.1.2.3.3.4" xref="S3.SS1.p1.5.m5.1.1.2.3.3.4.cmml">s</mi><mo id="S3.SS1.p1.5.m5.1.1.2.3.3.1b" xref="S3.SS1.p1.5.m5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m5.1.1.2.3.3.5" xref="S3.SS1.p1.5.m5.1.1.2.3.3.5.cmml">e</mi><mo id="S3.SS1.p1.5.m5.1.1.2.3.3.1c" xref="S3.SS1.p1.5.m5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m5.1.1.2.3.3.6" xref="S3.SS1.p1.5.m5.1.1.2.3.3.6.cmml">e</mi><mo id="S3.SS1.p1.5.m5.1.1.2.3.3.1d" xref="S3.SS1.p1.5.m5.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m5.1.1.2.3.3.7" xref="S3.SS1.p1.5.m5.1.1.2.3.3.7.cmml">n</mi></mrow></msub></mrow><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">=</mo><mi id="S3.SS1.p1.5.m5.1.1.3" mathvariant="normal" xref="S3.SS1.p1.5.m5.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><eq id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></eq><apply id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2"><intersect id="S3.SS1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.1"></intersect><apply id="S3.SS1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.2.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2.2">𝐶</ci><apply id="S3.SS1.p1.5.m5.1.1.2.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2.3"><times id="S3.SS1.p1.5.m5.1.1.2.2.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2.3.1"></times><ci id="S3.SS1.p1.5.m5.1.1.2.2.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2.3.2">𝑠</ci><ci id="S3.SS1.p1.5.m5.1.1.2.2.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2.3.3">𝑒</ci><ci id="S3.SS1.p1.5.m5.1.1.2.2.3.4.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2.3.4">𝑒</ci><ci id="S3.SS1.p1.5.m5.1.1.2.2.3.5.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2.3.5">𝑛</ci></apply></apply><apply id="S3.SS1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.2">𝐶</ci><apply id="S3.SS1.p1.5.m5.1.1.2.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.3"><times id="S3.SS1.p1.5.m5.1.1.2.3.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.3.1"></times><ci id="S3.SS1.p1.5.m5.1.1.2.3.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.3.2">𝑢</ci><ci id="S3.SS1.p1.5.m5.1.1.2.3.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.3.3">𝑛</ci><ci id="S3.SS1.p1.5.m5.1.1.2.3.3.4.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.3.4">𝑠</ci><ci id="S3.SS1.p1.5.m5.1.1.2.3.3.5.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.3.5">𝑒</ci><ci id="S3.SS1.p1.5.m5.1.1.2.3.3.6.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.3.6">𝑒</ci><ci id="S3.SS1.p1.5.m5.1.1.2.3.3.7.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3.3.7">𝑛</ci></apply></apply></apply><emptyset id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">C_{seen}\cap C_{unseen}=\emptyset</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_C start_POSTSUBSCRIPT italic_s italic_e italic_e italic_n end_POSTSUBSCRIPT ∩ italic_C start_POSTSUBSCRIPT italic_u italic_n italic_s italic_e italic_e italic_n end_POSTSUBSCRIPT = ∅</annotation></semantics></math>), respectively, the FSS model is trained on <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.16.10">D</em><sub class="ltx_sub" id="S3.SS1.p1.16.11"><span class="ltx_text ltx_font_italic" id="S3.SS1.p1.16.11.1">train</span></sub> and generalized directly to <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.16.12">D</em><sub class="ltx_sub" id="S3.SS1.p1.16.13"><span class="ltx_text ltx_font_italic" id="S3.SS1.p1.16.13.1">val</span></sub>. Following the previous methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib26" title="">26</a>]</cite>, episode training is employed in this work: Each episode will contain a support set <math alttext="S=\left\{\left(I_{i}^{s},M_{i}^{s}\right)\right\}_{i=1}^{K}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">S</mi><mo id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p1.8.m8.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.cmml"><mrow id="S3.SS1.p1.8.m8.1.1.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.cmml"><mo id="S3.SS1.p1.8.m8.1.1.1.1.1.1.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.3.cmml"><mo id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.2.2.cmml">I</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.4" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.2.2.cmml">M</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.3.cmml">s</mi></msubsup><mo id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.5" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S3.SS1.p1.8.m8.1.1.1.1.1.1.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.8.m8.1.1.1.1.3" xref="S3.SS1.p1.8.m8.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1.3.2" xref="S3.SS1.p1.8.m8.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.8.m8.1.1.1.1.3.1" xref="S3.SS1.p1.8.m8.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.8.m8.1.1.1.1.3.3" xref="S3.SS1.p1.8.m8.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.8.m8.1.1.1.3" xref="S3.SS1.p1.8.m8.1.1.1.3.cmml">K</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><eq id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2"></eq><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑆</ci><apply id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.8.m8.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1">subscript</csymbol><set id="S3.SS1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1"><interval closure="open" id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2"><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.2.2">𝐼</ci><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.2.2">𝑀</ci><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.2.2.3">𝑠</ci></apply></interval></set><apply id="S3.SS1.p1.8.m8.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.3"><eq id="S3.SS1.p1.8.m8.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.3.1"></eq><ci id="S3.SS1.p1.8.m8.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS1.p1.8.m8.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.8.m8.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.8.m8.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">S=\left\{\left(I_{i}^{s},M_{i}^{s}\right)\right\}_{i=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_S = { ( italic_I start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT , italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math> and a query set <math alttext="Q=\left\{\left(I^{q},M^{q}\right)\right\}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">Q</mi><mo id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.9.m9.1.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.2.cmml"><mo id="S3.SS1.p1.9.m9.1.1.1.1.2" xref="S3.SS1.p1.9.m9.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.9.m9.1.1.1.1.1.2" xref="S3.SS1.p1.9.m9.1.1.1.1.1.3.cmml"><mo id="S3.SS1.p1.9.m9.1.1.1.1.1.2.3" xref="S3.SS1.p1.9.m9.1.1.1.1.1.3.cmml">(</mo><msup id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.2.cmml">I</mi><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.3.cmml">q</mi></msup><mo id="S3.SS1.p1.9.m9.1.1.1.1.1.2.4" xref="S3.SS1.p1.9.m9.1.1.1.1.1.3.cmml">,</mo><msup id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.cmml">M</mi><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.3.cmml">q</mi></msup><mo id="S3.SS1.p1.9.m9.1.1.1.1.1.2.5" xref="S3.SS1.p1.9.m9.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S3.SS1.p1.9.m9.1.1.1.1.3" xref="S3.SS1.p1.9.m9.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><eq id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2"></eq><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝑄</ci><set id="S3.SS1.p1.9.m9.1.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1"><interval closure="open" id="S3.SS1.p1.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2"><apply id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.2">𝐼</ci><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2">𝑀</ci><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.3">𝑞</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">Q=\left\{\left(I^{q},M^{q}\right)\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_Q = { ( italic_I start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , italic_M start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ) }</annotation></semantics></math>, where <math alttext="I^{*}_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><msubsup id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2.2" xref="S3.SS1.p1.10.m10.1.1.2.2.cmml">I</mi><mi id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">i</mi><mo id="S3.SS1.p1.10.m10.1.1.2.3" xref="S3.SS1.p1.10.m10.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><apply id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.2.1.cmml" xref="S3.SS1.p1.10.m10.1.1">superscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2.2">𝐼</ci><times id="S3.SS1.p1.10.m10.1.1.2.3.cmml" xref="S3.SS1.p1.10.m10.1.1.2.3"></times></apply><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">I^{*}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_I start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="M^{*}_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><msubsup id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2.2" xref="S3.SS1.p1.11.m11.1.1.2.2.cmml">M</mi><mi id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">i</mi><mo id="S3.SS1.p1.11.m11.1.1.2.3" xref="S3.SS1.p1.11.m11.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">subscript</csymbol><apply id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1">superscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2.2">𝑀</ci><times id="S3.SS1.p1.11.m11.1.1.2.3.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3"></times></apply><ci id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">M^{*}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">italic_M start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denote the image and the corresponding mask. Notably, both <math alttext="I^{s}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><msup id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">I</mi><mi id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">superscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">𝐼</ci><ci id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">I^{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">italic_I start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="I^{q}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><msup id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">I</mi><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">superscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝐼</ci><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">I^{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_I start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT</annotation></semantics></math> contain the same category and <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><mi id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><ci id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">italic_K</annotation></semantics></math> indicates the number of labeled samples provided in the support set, where we just discuss the segmentation performance under the 1-shot and 5-shot settings, i.e., <math alttext="K=1,5" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.2"><semantics id="S3.SS1.p1.15.m15.2a"><mrow id="S3.SS1.p1.15.m15.2.3" xref="S3.SS1.p1.15.m15.2.3.cmml"><mi id="S3.SS1.p1.15.m15.2.3.2" xref="S3.SS1.p1.15.m15.2.3.2.cmml">K</mi><mo id="S3.SS1.p1.15.m15.2.3.1" xref="S3.SS1.p1.15.m15.2.3.1.cmml">=</mo><mrow id="S3.SS1.p1.15.m15.2.3.3.2" xref="S3.SS1.p1.15.m15.2.3.3.1.cmml"><mn id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml">1</mn><mo id="S3.SS1.p1.15.m15.2.3.3.2.1" xref="S3.SS1.p1.15.m15.2.3.3.1.cmml">,</mo><mn id="S3.SS1.p1.15.m15.2.2" xref="S3.SS1.p1.15.m15.2.2.cmml">5</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.2b"><apply id="S3.SS1.p1.15.m15.2.3.cmml" xref="S3.SS1.p1.15.m15.2.3"><eq id="S3.SS1.p1.15.m15.2.3.1.cmml" xref="S3.SS1.p1.15.m15.2.3.1"></eq><ci id="S3.SS1.p1.15.m15.2.3.2.cmml" xref="S3.SS1.p1.15.m15.2.3.2">𝐾</ci><list id="S3.SS1.p1.15.m15.2.3.3.1.cmml" xref="S3.SS1.p1.15.m15.2.3.3.2"><cn id="S3.SS1.p1.15.m15.1.1.cmml" type="integer" xref="S3.SS1.p1.15.m15.1.1">1</cn><cn id="S3.SS1.p1.15.m15.2.2.cmml" type="integer" xref="S3.SS1.p1.15.m15.2.2">5</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.2c">K=1,5</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.2d">italic_K = 1 , 5</annotation></semantics></math>. In every episode, the model will segment the specific objects in the query image <math alttext="I^{q}" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m16.1"><semantics id="S3.SS1.p1.16.m16.1a"><msup id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml"><mi id="S3.SS1.p1.16.m16.1.1.2" xref="S3.SS1.p1.16.m16.1.1.2.cmml">I</mi><mi id="S3.SS1.p1.16.m16.1.1.3" xref="S3.SS1.p1.16.m16.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><apply id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.1.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">superscript</csymbol><ci id="S3.SS1.p1.16.m16.1.1.2.cmml" xref="S3.SS1.p1.16.m16.1.1.2">𝐼</ci><ci id="S3.SS1.p1.16.m16.1.1.3.cmml" xref="S3.SS1.p1.16.m16.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">I^{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.16.m16.1d">italic_I start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT</annotation></semantics></math> guided by the support set <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.16.14">S</em>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.4">Variant: In previous work, the masks <math alttext="M_{i}^{s}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msubsup id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2.2" xref="S3.SS1.p2.1.m1.1.1.2.2.cmml">M</mi><mi id="S3.SS1.p2.1.m1.1.1.2.3" xref="S3.SS1.p2.1.m1.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">superscript</csymbol><apply id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2.2">𝑀</ci><ci id="S3.SS1.p2.1.m1.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">M_{i}^{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> are usually represented as one-hot vectors, e.g., <math alttext="M_{i}^{s}=[1,0,1,0,...]" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.5"><semantics id="S3.SS1.p2.2.m2.5a"><mrow id="S3.SS1.p2.2.m2.5.6" xref="S3.SS1.p2.2.m2.5.6.cmml"><msubsup id="S3.SS1.p2.2.m2.5.6.2" xref="S3.SS1.p2.2.m2.5.6.2.cmml"><mi id="S3.SS1.p2.2.m2.5.6.2.2.2" xref="S3.SS1.p2.2.m2.5.6.2.2.2.cmml">M</mi><mi id="S3.SS1.p2.2.m2.5.6.2.2.3" xref="S3.SS1.p2.2.m2.5.6.2.2.3.cmml">i</mi><mi id="S3.SS1.p2.2.m2.5.6.2.3" xref="S3.SS1.p2.2.m2.5.6.2.3.cmml">s</mi></msubsup><mo id="S3.SS1.p2.2.m2.5.6.1" xref="S3.SS1.p2.2.m2.5.6.1.cmml">=</mo><mrow id="S3.SS1.p2.2.m2.5.6.3.2" xref="S3.SS1.p2.2.m2.5.6.3.1.cmml"><mo id="S3.SS1.p2.2.m2.5.6.3.2.1" stretchy="false" xref="S3.SS1.p2.2.m2.5.6.3.1.cmml">[</mo><mn id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">1</mn><mo id="S3.SS1.p2.2.m2.5.6.3.2.2" xref="S3.SS1.p2.2.m2.5.6.3.1.cmml">,</mo><mn id="S3.SS1.p2.2.m2.2.2" xref="S3.SS1.p2.2.m2.2.2.cmml">0</mn><mo id="S3.SS1.p2.2.m2.5.6.3.2.3" xref="S3.SS1.p2.2.m2.5.6.3.1.cmml">,</mo><mn id="S3.SS1.p2.2.m2.3.3" xref="S3.SS1.p2.2.m2.3.3.cmml">1</mn><mo id="S3.SS1.p2.2.m2.5.6.3.2.4" xref="S3.SS1.p2.2.m2.5.6.3.1.cmml">,</mo><mn id="S3.SS1.p2.2.m2.4.4" xref="S3.SS1.p2.2.m2.4.4.cmml">0</mn><mo id="S3.SS1.p2.2.m2.5.6.3.2.5" xref="S3.SS1.p2.2.m2.5.6.3.1.cmml">,</mo><mi id="S3.SS1.p2.2.m2.5.5" mathvariant="normal" xref="S3.SS1.p2.2.m2.5.5.cmml">…</mi><mo id="S3.SS1.p2.2.m2.5.6.3.2.6" stretchy="false" xref="S3.SS1.p2.2.m2.5.6.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.5b"><apply id="S3.SS1.p2.2.m2.5.6.cmml" xref="S3.SS1.p2.2.m2.5.6"><eq id="S3.SS1.p2.2.m2.5.6.1.cmml" xref="S3.SS1.p2.2.m2.5.6.1"></eq><apply id="S3.SS1.p2.2.m2.5.6.2.cmml" xref="S3.SS1.p2.2.m2.5.6.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.5.6.2.1.cmml" xref="S3.SS1.p2.2.m2.5.6.2">superscript</csymbol><apply id="S3.SS1.p2.2.m2.5.6.2.2.cmml" xref="S3.SS1.p2.2.m2.5.6.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.5.6.2.2.1.cmml" xref="S3.SS1.p2.2.m2.5.6.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.5.6.2.2.2.cmml" xref="S3.SS1.p2.2.m2.5.6.2.2.2">𝑀</ci><ci id="S3.SS1.p2.2.m2.5.6.2.2.3.cmml" xref="S3.SS1.p2.2.m2.5.6.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.2.m2.5.6.2.3.cmml" xref="S3.SS1.p2.2.m2.5.6.2.3">𝑠</ci></apply><list id="S3.SS1.p2.2.m2.5.6.3.1.cmml" xref="S3.SS1.p2.2.m2.5.6.3.2"><cn id="S3.SS1.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1">1</cn><cn id="S3.SS1.p2.2.m2.2.2.cmml" type="integer" xref="S3.SS1.p2.2.m2.2.2">0</cn><cn id="S3.SS1.p2.2.m2.3.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.3.3">1</cn><cn id="S3.SS1.p2.2.m2.4.4.cmml" type="integer" xref="S3.SS1.p2.2.m2.4.4">0</cn><ci id="S3.SS1.p2.2.m2.5.5.cmml" xref="S3.SS1.p2.2.m2.5.5">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.5c">M_{i}^{s}=[1,0,1,0,...]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.5d">italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT = [ 1 , 0 , 1 , 0 , … ]</annotation></semantics></math>. However, such numerical representations ignore the valuable linguistic semantics of the class labels (e.g., ”dog”, ”car”). This work additionally introduces the class label <math alttext="M^{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><msup id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">M</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝑀</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">M^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_M start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> to mine the text semantics, at which point the support set <math alttext="S=\left\{\left(I_{i}^{s},M_{i}^{s},M^{t}\right)\right\}_{i=1}^{K}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">S</mi><mo id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml"><mrow id="S3.SS1.p2.4.m4.1.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml"><mo id="S3.SS1.p2.4.m4.1.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.4.cmml"><mo id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.4" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.4.cmml">(</mo><msubsup id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.cmml">I</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.5" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.4.cmml">,</mo><msubsup id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.2.2.cmml">M</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.3.cmml">s</mi></msubsup><mo id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.6" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.4.cmml">,</mo><msup id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3.2.cmml">M</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3.3.cmml">t</mi></msup><mo id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.7" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="S3.SS1.p2.4.m4.1.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.4.m4.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p2.4.m4.1.1.1.1.3.1" xref="S3.SS1.p2.4.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p2.4.m4.1.1.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.4.m4.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.3.cmml">K</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><eq id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2"></eq><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝑆</ci><apply id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.4.m4.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1">subscript</csymbol><set id="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1"><vector id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.4.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3"><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.2">𝐼</ci><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.2.2">𝑀</ci><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.2.2.3">𝑠</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3.2">𝑀</ci><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.1.3.3.3">𝑡</ci></apply></vector></set><apply id="S3.SS1.p2.4.m4.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3"><eq id="S3.SS1.p2.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3.1"></eq><ci id="S3.SS1.p2.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS1.p2.4.m4.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p2.4.m4.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.4.m4.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">S=\left\{\left(I_{i}^{s},M_{i}^{s},M^{t}\right)\right\}_{i=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_S = { ( italic_I start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT , italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT , italic_M start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.1.1">Cross-domain FSS:</span> The samples during the training and testing phases are from different domains (datasets), rather than the same domain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib67" title="">67</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib68" title="">68</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p4.1.1">Weak-label FSS:</span> The Support images with sparse annotations, e.g., scribbles, bounding boxes, rather than dense annotations, are provided to guide segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib26" title="">26</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p5.1.1">Zero-shot Segmentation:</span> Only the task (category) information is provided to guide segmentation without any annotated samples (support images) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib69" title="">69</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib70" title="">70</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><span class="ltx_text ltx_font_italic" id="S3.SS2.1.1">Method Overall</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Recent works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib71" title="">71</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib72" title="">72</a>]</cite> have proven that exploiting the biological plausibility of the human brain to build up intelligent systems brings significant performance gains for various tasks. With a unique pattern of visual perception, humans can selectively focus on critical objects in the line of sight while leaving the rest in the shadow of consciousness <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib45" title="">45</a>]</cite>. This motivates us to explore the dynamic class-aware feature encoder, which can adaptively activate corresponding class objects for different tasks. Based on the prompt learning technology<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib59" title="">59</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib49" title="">49</a>]</cite>, we expect to construct dynamic semantic prompts to adjust the encoder in FSS.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.7">Thus, we propose introducing a dynamic class-aware prompting paradigm to tune the encoder for focusing on the class-specific objects in the current task. Based on this prompting pattern, we construct a novel prompt-driven FSS framework called ”Prompt and Transfer”, i.e., PAT. Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S2.F4" title="Figure 4 ‣ 2.3 Prompt Learning ‣ 2 Related Work ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4</span></a> illustrates the overall architecture of PAT. Given the support image <math alttext="I^{s}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msup id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">I</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐼</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">I^{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_I start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> and query image <math alttext="I^{q}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">I</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐼</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">I^{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_I start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT</annotation></semantics></math>, we feed them into the patch embedding layer to derive support tokens <math alttext="X^{s}\in\mathbb{R}{{}^{N_{l}\times d}}" class="ltx_math_unparsed" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1b"><msup id="S3.SS2.p2.3.m3.1.1"><mi id="S3.SS2.p2.3.m3.1.1.2">X</mi><mi id="S3.SS2.p2.3.m3.1.1.3">s</mi></msup><mo id="S3.SS2.p2.3.m3.1.2">∈</mo><mi id="S3.SS2.p2.3.m3.1.3">ℝ</mi><msup id="S3.SS2.p2.3.m3.1.4"><mi id="S3.SS2.p2.3.m3.1.4a"></mi><mrow id="S3.SS2.p2.3.m3.1.4.1"><msub id="S3.SS2.p2.3.m3.1.4.1.2"><mi id="S3.SS2.p2.3.m3.1.4.1.2.2">N</mi><mi id="S3.SS2.p2.3.m3.1.4.1.2.3">l</mi></msub><mo id="S3.SS2.p2.3.m3.1.4.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS2.p2.3.m3.1.4.1.3">d</mi></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">X^{s}\in\mathbb{R}{{}^{N_{l}\times d}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_X start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ∈ blackboard_R start_FLOATSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT × italic_d end_FLOATSUPERSCRIPT</annotation></semantics></math> and query tokens <math alttext="X^{q}\in\mathbb{R}{{}^{N_{l}\times d}}" class="ltx_math_unparsed" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1b"><msup id="S3.SS2.p2.4.m4.1.1"><mi id="S3.SS2.p2.4.m4.1.1.2">X</mi><mi id="S3.SS2.p2.4.m4.1.1.3">q</mi></msup><mo id="S3.SS2.p2.4.m4.1.2">∈</mo><mi id="S3.SS2.p2.4.m4.1.3">ℝ</mi><msup id="S3.SS2.p2.4.m4.1.4"><mi id="S3.SS2.p2.4.m4.1.4a"></mi><mrow id="S3.SS2.p2.4.m4.1.4.1"><msub id="S3.SS2.p2.4.m4.1.4.1.2"><mi id="S3.SS2.p2.4.m4.1.4.1.2.2">N</mi><mi id="S3.SS2.p2.4.m4.1.4.1.2.3">l</mi></msub><mo id="S3.SS2.p2.4.m4.1.4.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS2.p2.4.m4.1.4.1.3">d</mi></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">X^{q}\in\mathbb{R}{{}^{N_{l}\times d}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_X start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ∈ blackboard_R start_FLOATSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT × italic_d end_FLOATSUPERSCRIPT</annotation></semantics></math> (<math alttext="N_{l}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">N</mi><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝑁</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">N_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> embedding vectors with <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mi id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">italic_d</annotation></semantics></math> dimensions, unless otherwise noted, support and query tokens are collectively denoted as <math alttext="X" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1"><semantics id="S3.SS2.p2.7.m7.1a"><mi id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.1d">italic_X</annotation></semantics></math>). In summary, our PAT consists of the following four key steps:</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.1.1">1) Prompt Initialization:</span> PAT introduces a typical pre-trained visual language model to extract the text semantics in category names and add them to several randomly initialized embeddings exploited as initial prompts.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.1.1">2) Prompt Enhancement:</span>
The Prompt Enhancement consists of a Semantic Prompt Transfer (SPT) and a Part Mask Generator (PMG), which transfers semantics within specific regions (e.g., fine-grained local regions) of the support/query images to prompts, enhancing class-awareness of prompts for adjusting the encoder.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p5.1.1">3) Prompting:</span> After transferring, such prompts will in turn interact with the image features in the next encoder block. This alternation of prompting and transferring can prompt the model to further activate the objects, yielding more discriminative class-aware features for every task.</p>
</div>
<div class="ltx_para" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p6.1.1">4) Matching:</span> In this case, effective segmentation can be achieved by simply utilizing these prompts for similarity computation with the enhanced query feature.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span><span class="ltx_text ltx_font_italic" id="S3.SS3.1.1">Prompt Initialization</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The prompting process is implemented via the self-attention of the transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib48" title="">48</a>]</cite>. Through the interaction of prompts and image features in the self-attention structure, images can activate specific target regions while prompts further aggregate target semantics from images. At this time, the source of the prompt will greatly affect its performance. As mentioned in Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S2.SS3" title="2.3 Prompt Learning ‣ 2 Related Work ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">2.3</span></a>, choosing the support mask feature as semantic prompts is not optimal due to the information differences between the image pair. We argue that other modal semantics might be a suitable source. Given that textual information being strongly representative can nicely characterize the category semantics of different tasks, we utilize it as the initial prompt to tune the image feature.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.3">Concretely, as illustrated in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S2.F4" title="Figure 4 ‣ 2.3 Prompt Learning ‣ 2 Related Work ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4</span></a>, the Pre-trained visual language model CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib73" title="">73</a>]</cite> (frozen during the whole process) is employed to extract the text feature from the uniform template “<span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.3.1">a photo of a [CLS]</span>.” where [CLS] is the class label <math alttext="M^{t}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msup id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">M</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑀</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">M^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_M start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>. The two-layer MLP module is then utilized to align it with the visual features. At this point, it is feasible to directly utilize this text embedding as an initial prompt. To enhance the effectiveness of prompting, following the previous prompt learning methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib48" title="">48</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib49" title="">49</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib59" title="">59</a>]</cite>, we employ multiple prompts to tune the encoder. More specifically, we utilize the Xavier uniform initialization scheme to generate multiple learnable embeddings <math alttext="t_{i}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">t</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝑡</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with mean 0, then sum (add) these learnable embeddings with the text embedding generated by CLIP to derive our initial FG-prompts (foreground prompts), i.e., <math alttext="P=\left[p_{1},p_{2},...,p_{N_{p}}\right]\in\mathbb{R}{{}^{N_{p}\times d}}" class="ltx_math_unparsed" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1b"><mi id="S3.SS3.p2.3.m3.1.2">P</mi><mo id="S3.SS3.p2.3.m3.1.3">=</mo><mrow id="S3.SS3.p2.3.m3.1.4"><mo id="S3.SS3.p2.3.m3.1.4.1">[</mo><msub id="S3.SS3.p2.3.m3.1.4.2"><mi id="S3.SS3.p2.3.m3.1.4.2.2">p</mi><mn id="S3.SS3.p2.3.m3.1.4.2.3">1</mn></msub><mo id="S3.SS3.p2.3.m3.1.4.3">,</mo><msub id="S3.SS3.p2.3.m3.1.4.4"><mi id="S3.SS3.p2.3.m3.1.4.4.2">p</mi><mn id="S3.SS3.p2.3.m3.1.4.4.3">2</mn></msub><mo id="S3.SS3.p2.3.m3.1.4.5">,</mo><mi id="S3.SS3.p2.3.m3.1.1" mathvariant="normal">…</mi><mo id="S3.SS3.p2.3.m3.1.4.6">,</mo><msub id="S3.SS3.p2.3.m3.1.4.7"><mi id="S3.SS3.p2.3.m3.1.4.7.2">p</mi><msub id="S3.SS3.p2.3.m3.1.4.7.3"><mi id="S3.SS3.p2.3.m3.1.4.7.3.2">N</mi><mi id="S3.SS3.p2.3.m3.1.4.7.3.3">p</mi></msub></msub><mo id="S3.SS3.p2.3.m3.1.4.8">]</mo></mrow><mo id="S3.SS3.p2.3.m3.1.5">∈</mo><mi id="S3.SS3.p2.3.m3.1.6">ℝ</mi><msup id="S3.SS3.p2.3.m3.1.7"><mi id="S3.SS3.p2.3.m3.1.7a"></mi><mrow id="S3.SS3.p2.3.m3.1.7.1"><msub id="S3.SS3.p2.3.m3.1.7.1.2"><mi id="S3.SS3.p2.3.m3.1.7.1.2.2">N</mi><mi id="S3.SS3.p2.3.m3.1.7.1.2.3">p</mi></msub><mo id="S3.SS3.p2.3.m3.1.7.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS3.p2.3.m3.1.7.1.3">d</mi></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">P=\left[p_{1},p_{2},...,p_{N_{p}}\right]\in\mathbb{R}{{}^{N_{p}\times d}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_P = [ italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ∈ blackboard_R start_FLOATSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT × italic_d end_FLOATSUPERSCRIPT</annotation></semantics></math>, which is equivalent to sampling multiple learnable embeddings from a normal distribution with mean text embedding:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{i}={\mathcal{F}}_{M}\left({\mathcal{F}}_{T}\left(M^{t}\right)\right)+t_{i},%
i=1,2,...,N_{p}" class="ltx_Math" display="block" id="S3.E1.m1.5"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.2" xref="S3.E1.m1.5.5.3.cmml"><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><msub id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml"><mi id="S3.E1.m1.4.4.1.1.3.2" xref="S3.E1.m1.4.4.1.1.3.2.cmml">p</mi><mi id="S3.E1.m1.4.4.1.1.3.3" xref="S3.E1.m1.4.4.1.1.3.3.cmml">i</mi></msub><mo id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.1" xref="S3.E1.m1.4.4.1.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.cmml"><msub id="S3.E1.m1.4.4.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.1.1.3.2" xref="S3.E1.m1.4.4.1.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E1.m1.4.4.1.1.1.1.3.3" xref="S3.E1.m1.4.4.1.1.1.1.3.3.cmml">M</mi></msub><mo id="S3.E1.m1.4.4.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">ℱ</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.3.cmml">T</mi></msub><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">M</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.2.cmml">+</mo><msub id="S3.E1.m1.4.4.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.3.cmml"><mi id="S3.E1.m1.4.4.1.1.1.3.2" xref="S3.E1.m1.4.4.1.1.1.3.2.cmml">t</mi><mi id="S3.E1.m1.4.4.1.1.1.3.3" xref="S3.E1.m1.4.4.1.1.1.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E1.m1.5.5.2.3" xref="S3.E1.m1.5.5.3a.cmml">,</mo><mrow id="S3.E1.m1.5.5.2.2" xref="S3.E1.m1.5.5.2.2.cmml"><mi id="S3.E1.m1.5.5.2.2.3" xref="S3.E1.m1.5.5.2.2.3.cmml">i</mi><mo id="S3.E1.m1.5.5.2.2.2" xref="S3.E1.m1.5.5.2.2.2.cmml">=</mo><mrow id="S3.E1.m1.5.5.2.2.1.1" xref="S3.E1.m1.5.5.2.2.1.2.cmml"><mn id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">1</mn><mo id="S3.E1.m1.5.5.2.2.1.1.2" xref="S3.E1.m1.5.5.2.2.1.2.cmml">,</mo><mn id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">2</mn><mo id="S3.E1.m1.5.5.2.2.1.1.3" xref="S3.E1.m1.5.5.2.2.1.2.cmml">,</mo><mi id="S3.E1.m1.3.3" mathvariant="normal" xref="S3.E1.m1.3.3.cmml">…</mi><mo id="S3.E1.m1.5.5.2.2.1.1.4" xref="S3.E1.m1.5.5.2.2.1.2.cmml">,</mo><msub id="S3.E1.m1.5.5.2.2.1.1.1" xref="S3.E1.m1.5.5.2.2.1.1.1.cmml"><mi id="S3.E1.m1.5.5.2.2.1.1.1.2" xref="S3.E1.m1.5.5.2.2.1.1.1.2.cmml">N</mi><mi id="S3.E1.m1.5.5.2.2.1.1.1.3" xref="S3.E1.m1.5.5.2.2.1.1.1.3.cmml">p</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.3.cmml" xref="S3.E1.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3a.cmml" xref="S3.E1.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1.1"><eq id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2"></eq><apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2">𝑝</ci><ci id="S3.E1.m1.4.4.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1"><plus id="S3.E1.m1.4.4.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.2"></plus><apply id="S3.E1.m1.4.4.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1"><times id="S3.E1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2"></times><apply id="S3.E1.m1.4.4.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.3.2">ℱ</ci><ci id="S3.E1.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.3.3">𝑀</ci></apply><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1"><times id="S3.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.2">ℱ</ci><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.3">𝑇</ci></apply><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">𝑀</ci><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.E1.m1.4.4.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.3.2">𝑡</ci><ci id="S3.E1.m1.4.4.1.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E1.m1.5.5.2.2.cmml" xref="S3.E1.m1.5.5.2.2"><eq id="S3.E1.m1.5.5.2.2.2.cmml" xref="S3.E1.m1.5.5.2.2.2"></eq><ci id="S3.E1.m1.5.5.2.2.3.cmml" xref="S3.E1.m1.5.5.2.2.3">𝑖</ci><list id="S3.E1.m1.5.5.2.2.1.2.cmml" xref="S3.E1.m1.5.5.2.2.1.1"><cn id="S3.E1.m1.1.1.cmml" type="integer" xref="S3.E1.m1.1.1">1</cn><cn id="S3.E1.m1.2.2.cmml" type="integer" xref="S3.E1.m1.2.2">2</cn><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">…</ci><apply id="S3.E1.m1.5.5.2.2.1.1.1.cmml" xref="S3.E1.m1.5.5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.1.1.1.1.cmml" xref="S3.E1.m1.5.5.2.2.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.2.2.1.1.1.2.cmml" xref="S3.E1.m1.5.5.2.2.1.1.1.2">𝑁</ci><ci id="S3.E1.m1.5.5.2.2.1.1.1.3.cmml" xref="S3.E1.m1.5.5.2.2.1.1.1.3">𝑝</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">p_{i}={\mathcal{F}}_{M}\left({\mathcal{F}}_{T}\left(M^{t}\right)\right)+t_{i},%
i=1,2,...,N_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.5d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = caligraphic_F start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( caligraphic_F start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ( italic_M start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) ) + italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_i = 1 , 2 , … , italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.9">where <math alttext="{\mathcal{F}}_{T}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m1.1"><semantics id="S3.SS3.p2.4.m1.1a"><msub id="S3.SS3.p2.4.m1.1.1" xref="S3.SS3.p2.4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.4.m1.1.1.2" xref="S3.SS3.p2.4.m1.1.1.2.cmml">ℱ</mi><mi id="S3.SS3.p2.4.m1.1.1.3" xref="S3.SS3.p2.4.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m1.1b"><apply id="S3.SS3.p2.4.m1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m1.1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m1.1.1.2.cmml" xref="S3.SS3.p2.4.m1.1.1.2">ℱ</ci><ci id="S3.SS3.p2.4.m1.1.1.3.cmml" xref="S3.SS3.p2.4.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m1.1c">{\mathcal{F}}_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> indicates the text encoder in CLIP, <math alttext="{\mathcal{F}}_{M}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m2.1"><semantics id="S3.SS3.p2.5.m2.1a"><msub id="S3.SS3.p2.5.m2.1.1" xref="S3.SS3.p2.5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.5.m2.1.1.2" xref="S3.SS3.p2.5.m2.1.1.2.cmml">ℱ</mi><mi id="S3.SS3.p2.5.m2.1.1.3" xref="S3.SS3.p2.5.m2.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m2.1b"><apply id="S3.SS3.p2.5.m2.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.1.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m2.1.1.2.cmml" xref="S3.SS3.p2.5.m2.1.1.2">ℱ</ci><ci id="S3.SS3.p2.5.m2.1.1.3.cmml" xref="S3.SS3.p2.5.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m2.1c">{\mathcal{F}}_{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m2.1d">caligraphic_F start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> indicates the MLP module, <math alttext="M^{t}" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m3.1"><semantics id="S3.SS3.p2.6.m3.1a"><msup id="S3.SS3.p2.6.m3.1.1" xref="S3.SS3.p2.6.m3.1.1.cmml"><mi id="S3.SS3.p2.6.m3.1.1.2" xref="S3.SS3.p2.6.m3.1.1.2.cmml">M</mi><mi id="S3.SS3.p2.6.m3.1.1.3" xref="S3.SS3.p2.6.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m3.1b"><apply id="S3.SS3.p2.6.m3.1.1.cmml" xref="S3.SS3.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m3.1.1.1.cmml" xref="S3.SS3.p2.6.m3.1.1">superscript</csymbol><ci id="S3.SS3.p2.6.m3.1.1.2.cmml" xref="S3.SS3.p2.6.m3.1.1.2">𝑀</ci><ci id="S3.SS3.p2.6.m3.1.1.3.cmml" xref="S3.SS3.p2.6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m3.1c">M^{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m3.1d">italic_M start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> indicates the class label in every episode, <math alttext="N_{p}" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m4.1"><semantics id="S3.SS3.p2.7.m4.1a"><msub id="S3.SS3.p2.7.m4.1.1" xref="S3.SS3.p2.7.m4.1.1.cmml"><mi id="S3.SS3.p2.7.m4.1.1.2" xref="S3.SS3.p2.7.m4.1.1.2.cmml">N</mi><mi id="S3.SS3.p2.7.m4.1.1.3" xref="S3.SS3.p2.7.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m4.1b"><apply id="S3.SS3.p2.7.m4.1.1.cmml" xref="S3.SS3.p2.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m4.1.1.1.cmml" xref="S3.SS3.p2.7.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.7.m4.1.1.2.cmml" xref="S3.SS3.p2.7.m4.1.1.2">𝑁</ci><ci id="S3.SS3.p2.7.m4.1.1.3.cmml" xref="S3.SS3.p2.7.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m4.1c">N_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m4.1d">italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> indicates the number of FG-prompts. In addition, giving the importance of background information for segmentation, we randomly initialize <math alttext="N_{b}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m5.1"><semantics id="S3.SS3.p2.8.m5.1a"><msub id="S3.SS3.p2.8.m5.1.1" xref="S3.SS3.p2.8.m5.1.1.cmml"><mi id="S3.SS3.p2.8.m5.1.1.2" xref="S3.SS3.p2.8.m5.1.1.2.cmml">N</mi><mi id="S3.SS3.p2.8.m5.1.1.3" xref="S3.SS3.p2.8.m5.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m5.1b"><apply id="S3.SS3.p2.8.m5.1.1.cmml" xref="S3.SS3.p2.8.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m5.1.1.1.cmml" xref="S3.SS3.p2.8.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m5.1.1.2.cmml" xref="S3.SS3.p2.8.m5.1.1.2">𝑁</ci><ci id="S3.SS3.p2.8.m5.1.1.3.cmml" xref="S3.SS3.p2.8.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m5.1c">N_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m5.1d">italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> embeddings as the initial BG-prompts (background prompts), i.e., <math alttext="B=\left[b_{1},b_{2},...,b_{N_{b}}\right]\in\mathbb{R}{{}^{N_{b}\times d}}" class="ltx_math_unparsed" display="inline" id="S3.SS3.p2.9.m6.1"><semantics id="S3.SS3.p2.9.m6.1a"><mrow id="S3.SS3.p2.9.m6.1b"><mi id="S3.SS3.p2.9.m6.1.2">B</mi><mo id="S3.SS3.p2.9.m6.1.3">=</mo><mrow id="S3.SS3.p2.9.m6.1.4"><mo id="S3.SS3.p2.9.m6.1.4.1">[</mo><msub id="S3.SS3.p2.9.m6.1.4.2"><mi id="S3.SS3.p2.9.m6.1.4.2.2">b</mi><mn id="S3.SS3.p2.9.m6.1.4.2.3">1</mn></msub><mo id="S3.SS3.p2.9.m6.1.4.3">,</mo><msub id="S3.SS3.p2.9.m6.1.4.4"><mi id="S3.SS3.p2.9.m6.1.4.4.2">b</mi><mn id="S3.SS3.p2.9.m6.1.4.4.3">2</mn></msub><mo id="S3.SS3.p2.9.m6.1.4.5">,</mo><mi id="S3.SS3.p2.9.m6.1.1" mathvariant="normal">…</mi><mo id="S3.SS3.p2.9.m6.1.4.6">,</mo><msub id="S3.SS3.p2.9.m6.1.4.7"><mi id="S3.SS3.p2.9.m6.1.4.7.2">b</mi><msub id="S3.SS3.p2.9.m6.1.4.7.3"><mi id="S3.SS3.p2.9.m6.1.4.7.3.2">N</mi><mi id="S3.SS3.p2.9.m6.1.4.7.3.3">b</mi></msub></msub><mo id="S3.SS3.p2.9.m6.1.4.8">]</mo></mrow><mo id="S3.SS3.p2.9.m6.1.5">∈</mo><mi id="S3.SS3.p2.9.m6.1.6">ℝ</mi><msup id="S3.SS3.p2.9.m6.1.7"><mi id="S3.SS3.p2.9.m6.1.7a"></mi><mrow id="S3.SS3.p2.9.m6.1.7.1"><msub id="S3.SS3.p2.9.m6.1.7.1.2"><mi id="S3.SS3.p2.9.m6.1.7.1.2.2">N</mi><mi id="S3.SS3.p2.9.m6.1.7.1.2.3">b</mi></msub><mo id="S3.SS3.p2.9.m6.1.7.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS3.p2.9.m6.1.7.1.3">d</mi></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m6.1c">B=\left[b_{1},b_{2},...,b_{N_{b}}\right]\in\mathbb{R}{{}^{N_{b}\times d}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m6.1d">italic_B = [ italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_b start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ∈ blackboard_R start_FLOATSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT × italic_d end_FLOATSUPERSCRIPT</annotation></semantics></math>, which adaptively learn the background semantics in the subsequent process.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">Thus, the prompts concatenated with feature tokens are fed into the transformer together for interactions.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span><span class="ltx_text ltx_font_italic" id="S3.SS4.1.1">Prompt Enhancement</span>
</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">For better enhancing the dynamic class-aware prompting, we suggest capturing richer class-specific semantics from the support and query images. Thus, the Prompt Enhancement is performed to transfer target semantics from the support/query feature to the proposed prompts, which consists of the FG-Prompt Enhancement and the BG-Prompt Enhancement (see Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S2.F4" title="Figure 4 ‣ 2.3 Prompt Learning ‣ 2 Related Work ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">Take the FG-Prompt Enhancement as an example, the whole enhancement is implemented via two main components: a Semantic Prompt Transfer (SPT) and a Part Mask Generator (PMG). The former is the core, which constructs robust semantic transfer between feature tokens and prompts under the constraints of the specific mask (e.g., foreground) via a cross-attention manner, in which we design Gaussian suppression to avoid preferring the few most discriminative pixels while neglecting other valuable pixel semantics. To prevent all prompts from aggregating similar category semantics during the migration, we construct a Part Mask Generator (PMG) that adaptively generates a series of different part-level masks for different individuals. With the help of PMG, Semantic Prompt Transfer (SPT) can constrain different prompts to aggregate the semantics under different part masks, yielding different but complementary FG-prompts (part prompts). In this way, the redundancy of prompts is avoided and the local semantic clues are fully explored at the same time. The details are shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#alg1" title="In 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="alg1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg1.11">
<div class="ltx_listingline" id="alg1.2.2">
<span class="ltx_text" id="alg1.2.2.2" style="font-size:90%;">
<span class="ltx_text" id="alg1.2.2.2.1"><span class="ltx_text ltx_font_bold" id="alg1.2.2.2.1.1">Input:</span> </span> image feature <math alttext="X" class="ltx_Math" display="inline" id="alg1.1.1.1.m1.1"><semantics id="alg1.1.1.1.m1.1a"><mi id="alg1.1.1.1.m1.1.1" xref="alg1.1.1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg1.1.1.1.m1.1b"><ci id="alg1.1.1.1.m1.1.1.cmml" xref="alg1.1.1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="alg1.1.1.1.m1.1d">italic_X</annotation></semantics></math>, FG-prompts <math alttext="P" class="ltx_Math" display="inline" id="alg1.2.2.2.m2.1"><semantics id="alg1.2.2.2.m2.1a"><mi id="alg1.2.2.2.m2.1.1" xref="alg1.2.2.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.2.2.2.m2.1b"><ci id="alg1.2.2.2.m2.1.1.cmml" xref="alg1.2.2.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg1.2.2.2.m2.1d">italic_P</annotation></semantics></math></span>
</div>
<div class="ltx_listingline" id="alg1.3.3">
<span class="ltx_text" id="alg1.3.3.1" style="font-size:90%;">
</span><span class="ltx_text" id="alg1.3.3.2" style="font-size:90%;"><span class="ltx_text ltx_font_bold" id="alg1.3.3.2.1">Output:</span> </span><span class="ltx_text" id="alg1.3.3.3" style="font-size:90%;"> Class-aware FG-prompts </span><math alttext="\widetilde{P}" class="ltx_Math" display="inline" id="alg1.3.3.m1.1"><semantics id="alg1.3.3.m1.1a"><mover accent="true" id="alg1.3.3.m1.1.1" xref="alg1.3.3.m1.1.1.cmml"><mi id="alg1.3.3.m1.1.1.2" mathsize="90%" xref="alg1.3.3.m1.1.1.2.cmml">P</mi><mo id="alg1.3.3.m1.1.1.1" mathsize="90%" xref="alg1.3.3.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.3.3.m1.1b"><apply id="alg1.3.3.m1.1.1.cmml" xref="alg1.3.3.m1.1.1"><ci id="alg1.3.3.m1.1.1.1.cmml" xref="alg1.3.3.m1.1.1.1">~</ci><ci id="alg1.3.3.m1.1.1.2.cmml" xref="alg1.3.3.m1.1.1.2">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m1.1c">\widetilde{P}</annotation><annotation encoding="application/x-llamapun" id="alg1.3.3.m1.1d">over~ start_ARG italic_P end_ARG</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.11.12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.11.12.1.1.1" style="font-size:90%;">1</span></span><span class="ltx_text" id="alg1.11.12.2" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.11.13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.11.13.1.1.1" style="font-size:90%;">2</span></span><span class="ltx_text ltx_font_bold" id="alg1.11.13.2" style="font-size:90%;">Part Mask Generator</span><span class="ltx_text" id="alg1.11.13.3" style="font-size:90%;"> (Sec.</span><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.SS4.SSS1" style="font-size:90%;" title="3.4.1 Part Mask Generator (PMG) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">3.4.1</span></a><span class="ltx_text" id="alg1.11.13.4" style="font-size:90%;">)
</span>
</div>
<div class="ltx_listingline" id="alg1.4.4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.4.4.1.1.1" style="font-size:90%;">3</span></span><span class="ltx_text" id="alg1.4.4.2" style="font-size:90%;">First, generate the parameters of Part Filters </span><math alttext="\varphi\leftarrow P" class="ltx_Math" display="inline" id="alg1.4.4.m1.1"><semantics id="alg1.4.4.m1.1a"><mrow id="alg1.4.4.m1.1.1" xref="alg1.4.4.m1.1.1.cmml"><mi id="alg1.4.4.m1.1.1.2" mathsize="90%" xref="alg1.4.4.m1.1.1.2.cmml">φ</mi><mo id="alg1.4.4.m1.1.1.1" mathsize="90%" stretchy="false" xref="alg1.4.4.m1.1.1.1.cmml">←</mo><mi id="alg1.4.4.m1.1.1.3" mathsize="90%" xref="alg1.4.4.m1.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.4.m1.1b"><apply id="alg1.4.4.m1.1.1.cmml" xref="alg1.4.4.m1.1.1"><ci id="alg1.4.4.m1.1.1.1.cmml" xref="alg1.4.4.m1.1.1.1">←</ci><ci id="alg1.4.4.m1.1.1.2.cmml" xref="alg1.4.4.m1.1.1.2">𝜑</ci><ci id="alg1.4.4.m1.1.1.3.cmml" xref="alg1.4.4.m1.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m1.1c">\varphi\leftarrow P</annotation><annotation encoding="application/x-llamapun" id="alg1.4.4.m1.1d">italic_φ ← italic_P</annotation></semantics></math><span class="ltx_text" id="alg1.4.4.3" style="font-size:90%;"> according to Eq.(</span><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E2" style="font-size:90%;" title="In 3.4.1 Part Mask Generator (PMG) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a><span class="ltx_text" id="alg1.4.4.4" style="font-size:90%;">);
</span>
</div>
<div class="ltx_listingline" id="alg1.6.6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.6.6.3.1.1" style="font-size:90%;">4</span></span><span class="ltx_text ltx_font_bold" id="alg1.6.6.4" style="font-size:90%;">for</span><span class="ltx_text" id="alg1.6.6.5" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.6.6.2" style="font-size:90%;"><math alttext="\varphi_{i}" class="ltx_Math" display="inline" id="alg1.5.5.1.m1.1"><semantics id="alg1.5.5.1.m1.1a"><msub id="alg1.5.5.1.m1.1.1" xref="alg1.5.5.1.m1.1.1.cmml"><mi id="alg1.5.5.1.m1.1.1.2" xref="alg1.5.5.1.m1.1.1.2.cmml">φ</mi><mi id="alg1.5.5.1.m1.1.1.3" xref="alg1.5.5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.5.5.1.m1.1b"><apply id="alg1.5.5.1.m1.1.1.cmml" xref="alg1.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.5.5.1.m1.1.1.1.cmml" xref="alg1.5.5.1.m1.1.1">subscript</csymbol><ci id="alg1.5.5.1.m1.1.1.2.cmml" xref="alg1.5.5.1.m1.1.1.2">𝜑</ci><ci id="alg1.5.5.1.m1.1.1.3.cmml" xref="alg1.5.5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.1.m1.1c">\varphi_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.5.5.1.m1.1d">italic_φ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="\varphi" class="ltx_Math" display="inline" id="alg1.6.6.2.m2.1"><semantics id="alg1.6.6.2.m2.1a"><mi id="alg1.6.6.2.m2.1.1" xref="alg1.6.6.2.m2.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="alg1.6.6.2.m2.1b"><ci id="alg1.6.6.2.m2.1.1.cmml" xref="alg1.6.6.2.m2.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.2.m2.1c">\varphi</annotation><annotation encoding="application/x-llamapun" id="alg1.6.6.2.m2.1d">italic_φ</annotation></semantics></math> </em><span class="ltx_text" id="alg1.6.6.6" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.6.6.7" style="font-size:90%;">do</span><span class="ltx_text" id="alg1.6.6.8" style="font-size:90%;"> </span>
</div>
<div class="ltx_listingline" id="alg1.7.7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.7.7.1.1.1" style="font-size:90%;">5</span></span><span class="ltx_text" id="alg1.7.7.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.7.7.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.7.7.4" style="font-size:90%;">
Derive the part mask by the Part Filter </span><math alttext="M^{p}_{i}\leftarrow\left(\varphi_{i},X\right)" class="ltx_Math" display="inline" id="alg1.7.7.m1.2"><semantics id="alg1.7.7.m1.2a"><mrow id="alg1.7.7.m1.2.2" xref="alg1.7.7.m1.2.2.cmml"><msubsup id="alg1.7.7.m1.2.2.3" xref="alg1.7.7.m1.2.2.3.cmml"><mi id="alg1.7.7.m1.2.2.3.2.2" mathsize="90%" xref="alg1.7.7.m1.2.2.3.2.2.cmml">M</mi><mi id="alg1.7.7.m1.2.2.3.3" mathsize="90%" xref="alg1.7.7.m1.2.2.3.3.cmml">i</mi><mi id="alg1.7.7.m1.2.2.3.2.3" mathsize="90%" xref="alg1.7.7.m1.2.2.3.2.3.cmml">p</mi></msubsup><mo id="alg1.7.7.m1.2.2.2" mathsize="90%" stretchy="false" xref="alg1.7.7.m1.2.2.2.cmml">←</mo><mrow id="alg1.7.7.m1.2.2.1.1" xref="alg1.7.7.m1.2.2.1.2.cmml"><mo id="alg1.7.7.m1.2.2.1.1.2" xref="alg1.7.7.m1.2.2.1.2.cmml">(</mo><msub id="alg1.7.7.m1.2.2.1.1.1" xref="alg1.7.7.m1.2.2.1.1.1.cmml"><mi id="alg1.7.7.m1.2.2.1.1.1.2" mathsize="90%" xref="alg1.7.7.m1.2.2.1.1.1.2.cmml">φ</mi><mi id="alg1.7.7.m1.2.2.1.1.1.3" mathsize="90%" xref="alg1.7.7.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="alg1.7.7.m1.2.2.1.1.3" mathsize="90%" xref="alg1.7.7.m1.2.2.1.2.cmml">,</mo><mi id="alg1.7.7.m1.1.1" mathsize="90%" xref="alg1.7.7.m1.1.1.cmml">X</mi><mo id="alg1.7.7.m1.2.2.1.1.4" xref="alg1.7.7.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.7.m1.2b"><apply id="alg1.7.7.m1.2.2.cmml" xref="alg1.7.7.m1.2.2"><ci id="alg1.7.7.m1.2.2.2.cmml" xref="alg1.7.7.m1.2.2.2">←</ci><apply id="alg1.7.7.m1.2.2.3.cmml" xref="alg1.7.7.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.7.7.m1.2.2.3.1.cmml" xref="alg1.7.7.m1.2.2.3">subscript</csymbol><apply id="alg1.7.7.m1.2.2.3.2.cmml" xref="alg1.7.7.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.7.7.m1.2.2.3.2.1.cmml" xref="alg1.7.7.m1.2.2.3">superscript</csymbol><ci id="alg1.7.7.m1.2.2.3.2.2.cmml" xref="alg1.7.7.m1.2.2.3.2.2">𝑀</ci><ci id="alg1.7.7.m1.2.2.3.2.3.cmml" xref="alg1.7.7.m1.2.2.3.2.3">𝑝</ci></apply><ci id="alg1.7.7.m1.2.2.3.3.cmml" xref="alg1.7.7.m1.2.2.3.3">𝑖</ci></apply><interval closure="open" id="alg1.7.7.m1.2.2.1.2.cmml" xref="alg1.7.7.m1.2.2.1.1"><apply id="alg1.7.7.m1.2.2.1.1.1.cmml" xref="alg1.7.7.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.7.7.m1.2.2.1.1.1.1.cmml" xref="alg1.7.7.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.7.7.m1.2.2.1.1.1.2.cmml" xref="alg1.7.7.m1.2.2.1.1.1.2">𝜑</ci><ci id="alg1.7.7.m1.2.2.1.1.1.3.cmml" xref="alg1.7.7.m1.2.2.1.1.1.3">𝑖</ci></apply><ci id="alg1.7.7.m1.1.1.cmml" xref="alg1.7.7.m1.1.1">𝑋</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.m1.2c">M^{p}_{i}\leftarrow\left(\varphi_{i},X\right)</annotation><annotation encoding="application/x-llamapun" id="alg1.7.7.m1.2d">italic_M start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← ( italic_φ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_X )</annotation></semantics></math><span class="ltx_text" id="alg1.7.7.5" style="font-size:90%;"> according to Eq.(</span><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E3" style="font-size:90%;" title="In 3.4.1 Part Mask Generator (PMG) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">3</span></a><span class="ltx_text" id="alg1.7.7.6" style="font-size:90%;">);
</span>
</div>
<div class="ltx_listingline" id="alg1.11.14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.11.14.1.1.1" style="font-size:90%;">6</span></span><span class="ltx_text" id="alg1.11.14.2" style="font-size:90%;"> end for</span>
</div>
<div class="ltx_listingline" id="alg1.11.15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.11.15.1.1.1" style="font-size:90%;">7</span></span><span class="ltx_text ltx_font_bold" id="alg1.11.15.2" style="font-size:90%;">Semantic Prompt Transfer</span><span class="ltx_text" id="alg1.11.15.3" style="font-size:90%;"> (Sec.</span><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.SS4.SSS2" style="font-size:90%;" title="3.4.2 Semantic Prompt Transfer (SPT) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">3.4.2</span></a><span class="ltx_text" id="alg1.11.15.4" style="font-size:90%;">)
</span>
</div>
<div class="ltx_listingline" id="alg1.9.9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.9.9.3.1.1" style="font-size:90%;">8</span></span><span class="ltx_text ltx_font_bold" id="alg1.9.9.4" style="font-size:90%;">for</span><span class="ltx_text" id="alg1.9.9.5" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.9.9.2" style="font-size:90%;"><math alttext="P_{i}" class="ltx_Math" display="inline" id="alg1.8.8.1.m1.1"><semantics id="alg1.8.8.1.m1.1a"><msub id="alg1.8.8.1.m1.1.1" xref="alg1.8.8.1.m1.1.1.cmml"><mi id="alg1.8.8.1.m1.1.1.2" xref="alg1.8.8.1.m1.1.1.2.cmml">P</mi><mi id="alg1.8.8.1.m1.1.1.3" xref="alg1.8.8.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.8.8.1.m1.1b"><apply id="alg1.8.8.1.m1.1.1.cmml" xref="alg1.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.8.8.1.m1.1.1.1.cmml" xref="alg1.8.8.1.m1.1.1">subscript</csymbol><ci id="alg1.8.8.1.m1.1.1.2.cmml" xref="alg1.8.8.1.m1.1.1.2">𝑃</ci><ci id="alg1.8.8.1.m1.1.1.3.cmml" xref="alg1.8.8.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.1.m1.1c">P_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.8.8.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="P" class="ltx_Math" display="inline" id="alg1.9.9.2.m2.1"><semantics id="alg1.9.9.2.m2.1a"><mi id="alg1.9.9.2.m2.1.1" xref="alg1.9.9.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.9.9.2.m2.1b"><ci id="alg1.9.9.2.m2.1.1.cmml" xref="alg1.9.9.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg1.9.9.2.m2.1d">italic_P</annotation></semantics></math> </em><span class="ltx_text" id="alg1.9.9.6" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.9.9.7" style="font-size:90%;">do</span><span class="ltx_text" id="alg1.9.9.8" style="font-size:90%;"> </span>
</div>
<div class="ltx_listingline" id="alg1.11.11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.11.11.1.1.1" style="font-size:90%;">9</span></span><span class="ltx_text" id="alg1.11.11.2" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.11.11.3" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.11.11.4" style="font-size:90%;">
Transfer the semantics of the </span><math alttext="i^{th}" class="ltx_Math" display="inline" id="alg1.10.10.m1.1"><semantics id="alg1.10.10.m1.1a"><msup id="alg1.10.10.m1.1.1" xref="alg1.10.10.m1.1.1.cmml"><mi id="alg1.10.10.m1.1.1.2" mathsize="90%" xref="alg1.10.10.m1.1.1.2.cmml">i</mi><mrow id="alg1.10.10.m1.1.1.3" xref="alg1.10.10.m1.1.1.3.cmml"><mi id="alg1.10.10.m1.1.1.3.2" mathsize="90%" xref="alg1.10.10.m1.1.1.3.2.cmml">t</mi><mo id="alg1.10.10.m1.1.1.3.1" xref="alg1.10.10.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.10.10.m1.1.1.3.3" mathsize="90%" xref="alg1.10.10.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.10.10.m1.1b"><apply id="alg1.10.10.m1.1.1.cmml" xref="alg1.10.10.m1.1.1"><csymbol cd="ambiguous" id="alg1.10.10.m1.1.1.1.cmml" xref="alg1.10.10.m1.1.1">superscript</csymbol><ci id="alg1.10.10.m1.1.1.2.cmml" xref="alg1.10.10.m1.1.1.2">𝑖</ci><apply id="alg1.10.10.m1.1.1.3.cmml" xref="alg1.10.10.m1.1.1.3"><times id="alg1.10.10.m1.1.1.3.1.cmml" xref="alg1.10.10.m1.1.1.3.1"></times><ci id="alg1.10.10.m1.1.1.3.2.cmml" xref="alg1.10.10.m1.1.1.3.2">𝑡</ci><ci id="alg1.10.10.m1.1.1.3.3.cmml" xref="alg1.10.10.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m1.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="alg1.10.10.m1.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.11.11.5" style="font-size:90%;"> part mask to the prompt
</span><math alttext="\widetilde{P_{i}}\leftarrow\left(P_{i},X,M^{p}_{i}\right)" class="ltx_Math" display="inline" id="alg1.11.11.m2.3"><semantics id="alg1.11.11.m2.3a"><mrow id="alg1.11.11.m2.3.3" xref="alg1.11.11.m2.3.3.cmml"><mover accent="true" id="alg1.11.11.m2.3.3.4" xref="alg1.11.11.m2.3.3.4.cmml"><msub id="alg1.11.11.m2.3.3.4.2" xref="alg1.11.11.m2.3.3.4.2.cmml"><mi id="alg1.11.11.m2.3.3.4.2.2" mathsize="90%" xref="alg1.11.11.m2.3.3.4.2.2.cmml">P</mi><mi id="alg1.11.11.m2.3.3.4.2.3" mathsize="90%" xref="alg1.11.11.m2.3.3.4.2.3.cmml">i</mi></msub><mo id="alg1.11.11.m2.3.3.4.1" mathsize="90%" xref="alg1.11.11.m2.3.3.4.1.cmml">~</mo></mover><mo id="alg1.11.11.m2.3.3.3" mathsize="90%" stretchy="false" xref="alg1.11.11.m2.3.3.3.cmml">←</mo><mrow id="alg1.11.11.m2.3.3.2.2" xref="alg1.11.11.m2.3.3.2.3.cmml"><mo id="alg1.11.11.m2.3.3.2.2.3" xref="alg1.11.11.m2.3.3.2.3.cmml">(</mo><msub id="alg1.11.11.m2.2.2.1.1.1" xref="alg1.11.11.m2.2.2.1.1.1.cmml"><mi id="alg1.11.11.m2.2.2.1.1.1.2" mathsize="90%" xref="alg1.11.11.m2.2.2.1.1.1.2.cmml">P</mi><mi id="alg1.11.11.m2.2.2.1.1.1.3" mathsize="90%" xref="alg1.11.11.m2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="alg1.11.11.m2.3.3.2.2.4" mathsize="90%" xref="alg1.11.11.m2.3.3.2.3.cmml">,</mo><mi id="alg1.11.11.m2.1.1" mathsize="90%" xref="alg1.11.11.m2.1.1.cmml">X</mi><mo id="alg1.11.11.m2.3.3.2.2.5" mathsize="90%" xref="alg1.11.11.m2.3.3.2.3.cmml">,</mo><msubsup id="alg1.11.11.m2.3.3.2.2.2" xref="alg1.11.11.m2.3.3.2.2.2.cmml"><mi id="alg1.11.11.m2.3.3.2.2.2.2.2" mathsize="90%" xref="alg1.11.11.m2.3.3.2.2.2.2.2.cmml">M</mi><mi id="alg1.11.11.m2.3.3.2.2.2.3" mathsize="90%" xref="alg1.11.11.m2.3.3.2.2.2.3.cmml">i</mi><mi id="alg1.11.11.m2.3.3.2.2.2.2.3" mathsize="90%" xref="alg1.11.11.m2.3.3.2.2.2.2.3.cmml">p</mi></msubsup><mo id="alg1.11.11.m2.3.3.2.2.6" xref="alg1.11.11.m2.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.11.11.m2.3b"><apply id="alg1.11.11.m2.3.3.cmml" xref="alg1.11.11.m2.3.3"><ci id="alg1.11.11.m2.3.3.3.cmml" xref="alg1.11.11.m2.3.3.3">←</ci><apply id="alg1.11.11.m2.3.3.4.cmml" xref="alg1.11.11.m2.3.3.4"><ci id="alg1.11.11.m2.3.3.4.1.cmml" xref="alg1.11.11.m2.3.3.4.1">~</ci><apply id="alg1.11.11.m2.3.3.4.2.cmml" xref="alg1.11.11.m2.3.3.4.2"><csymbol cd="ambiguous" id="alg1.11.11.m2.3.3.4.2.1.cmml" xref="alg1.11.11.m2.3.3.4.2">subscript</csymbol><ci id="alg1.11.11.m2.3.3.4.2.2.cmml" xref="alg1.11.11.m2.3.3.4.2.2">𝑃</ci><ci id="alg1.11.11.m2.3.3.4.2.3.cmml" xref="alg1.11.11.m2.3.3.4.2.3">𝑖</ci></apply></apply><vector id="alg1.11.11.m2.3.3.2.3.cmml" xref="alg1.11.11.m2.3.3.2.2"><apply id="alg1.11.11.m2.2.2.1.1.1.cmml" xref="alg1.11.11.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.11.11.m2.2.2.1.1.1.1.cmml" xref="alg1.11.11.m2.2.2.1.1.1">subscript</csymbol><ci id="alg1.11.11.m2.2.2.1.1.1.2.cmml" xref="alg1.11.11.m2.2.2.1.1.1.2">𝑃</ci><ci id="alg1.11.11.m2.2.2.1.1.1.3.cmml" xref="alg1.11.11.m2.2.2.1.1.1.3">𝑖</ci></apply><ci id="alg1.11.11.m2.1.1.cmml" xref="alg1.11.11.m2.1.1">𝑋</ci><apply id="alg1.11.11.m2.3.3.2.2.2.cmml" xref="alg1.11.11.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.11.11.m2.3.3.2.2.2.1.cmml" xref="alg1.11.11.m2.3.3.2.2.2">subscript</csymbol><apply id="alg1.11.11.m2.3.3.2.2.2.2.cmml" xref="alg1.11.11.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.11.11.m2.3.3.2.2.2.2.1.cmml" xref="alg1.11.11.m2.3.3.2.2.2">superscript</csymbol><ci id="alg1.11.11.m2.3.3.2.2.2.2.2.cmml" xref="alg1.11.11.m2.3.3.2.2.2.2.2">𝑀</ci><ci id="alg1.11.11.m2.3.3.2.2.2.2.3.cmml" xref="alg1.11.11.m2.3.3.2.2.2.2.3">𝑝</ci></apply><ci id="alg1.11.11.m2.3.3.2.2.2.3.cmml" xref="alg1.11.11.m2.3.3.2.2.2.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.m2.3c">\widetilde{P_{i}}\leftarrow\left(P_{i},X,M^{p}_{i}\right)</annotation><annotation encoding="application/x-llamapun" id="alg1.11.11.m2.3d">over~ start_ARG italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ← ( italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_X , italic_M start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.11.11.6" style="font-size:90%;"> according to Eq.(</span><a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E8" style="font-size:90%;" title="In 3.4.2 Semantic Prompt Transfer (SPT) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">8</span></a><span class="ltx_text" id="alg1.11.11.7" style="font-size:90%;">);
</span>
</div>
<div class="ltx_listingline" id="alg1.11.16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.11.16.1.1.1" style="font-size:90%;">10</span></span><span class="ltx_text" id="alg1.11.16.2" style="font-size:90%;"> end for</span>
</div>
<div class="ltx_listingline" id="alg1.11.17">
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.15.1.1">Algorithm 1</span> </span> FG-Prompt Enhancement </figcaption>
</figure>
<section class="ltx_subsubsection" id="S3.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.1 </span> Part Mask Generator (PMG)</h4>
<div class="ltx_para" id="S3.SS4.SSS1.p1">
<p class="ltx_p" id="S3.SS4.SSS1.p1.3">Part Mask Generator (PMG) aims to adaptively generate different but complementary part masks for different individuals (images). As illustrated in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.F5" title="Figure 5 ‣ 3.4.1 Part Mask Generator (PMG) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">5</span></a>, multiple Part Filters, i.e., <math alttext="\varphi=\left\{\varphi_{1},\varphi_{2},...,\varphi_{N_{p}}\right\}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.1.m1.4"><semantics id="S3.SS4.SSS1.p1.1.m1.4a"><mrow id="S3.SS4.SSS1.p1.1.m1.4.4" xref="S3.SS4.SSS1.p1.1.m1.4.4.cmml"><mi id="S3.SS4.SSS1.p1.1.m1.4.4.5" xref="S3.SS4.SSS1.p1.1.m1.4.4.5.cmml">φ</mi><mo id="S3.SS4.SSS1.p1.1.m1.4.4.4" xref="S3.SS4.SSS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS4.SSS1.p1.1.m1.4.4.3.3" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.4.cmml"><mo id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.4" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1" xref="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1.2.cmml">φ</mi><mn id="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.5" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2" xref="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2.2.cmml">φ</mi><mn id="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.6" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS4.SSS1.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS4.SSS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.7" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.2" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.2.cmml">φ</mi><msub id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3.cmml"><mi id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3.2" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3.2.cmml">N</mi><mi id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3.3" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3.3.cmml">p</mi></msub></msub><mo id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.8" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.1.m1.4b"><apply id="S3.SS4.SSS1.p1.1.m1.4.4.cmml" xref="S3.SS4.SSS1.p1.1.m1.4.4"><eq id="S3.SS4.SSS1.p1.1.m1.4.4.4.cmml" xref="S3.SS4.SSS1.p1.1.m1.4.4.4"></eq><ci id="S3.SS4.SSS1.p1.1.m1.4.4.5.cmml" xref="S3.SS4.SSS1.p1.1.m1.4.4.5">𝜑</ci><set id="S3.SS4.SSS1.p1.1.m1.4.4.3.4.cmml" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3"><apply id="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1.2">𝜑</ci><cn id="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2.2">𝜑</ci><cn id="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.1.1">…</ci><apply id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.2">𝜑</ci><apply id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3.1.cmml" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3.2.cmml" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3.2">𝑁</ci><ci id="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3.3.cmml" xref="S3.SS4.SSS1.p1.1.m1.4.4.3.3.3.3.3">𝑝</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.1.m1.4c">\varphi=\left\{\varphi_{1},\varphi_{2},...,\varphi_{N_{p}}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.1.m1.4d">italic_φ = { italic_φ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_φ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_φ start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math>, are introduced to generate part-level local masks in PMG, with different filters responsible for filtering different part regions. However, since different tasks need to focus on different category objects, it is sub-optimal to share the parameters with the same set of Part Filters across different tasks. In this case, we introduce a Part Filter Learner, i.e., <math alttext="G_{p}=\left\{g_{1},g_{2},...,g_{N_{p}}\right\}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.2.m2.4"><semantics id="S3.SS4.SSS1.p1.2.m2.4a"><mrow id="S3.SS4.SSS1.p1.2.m2.4.4" xref="S3.SS4.SSS1.p1.2.m2.4.4.cmml"><msub id="S3.SS4.SSS1.p1.2.m2.4.4.5" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.4.4.5.2" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.2.cmml">G</mi><mi id="S3.SS4.SSS1.p1.2.m2.4.4.5.3" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.3.cmml">p</mi></msub><mo id="S3.SS4.SSS1.p1.2.m2.4.4.4" xref="S3.SS4.SSS1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS4.SSS1.p1.2.m2.4.4.3.3" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml"><mo id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.4" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.2.cmml">g</mi><mn id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.5" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.2.cmml">g</mi><mn id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.6" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS4.SSS1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS4.SSS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.7" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.2" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.2.cmml">g</mi><msub id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.cmml"><mi id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.2" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.2.cmml">N</mi><mi id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.3" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.3.cmml">p</mi></msub></msub><mo id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.8" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.2.m2.4b"><apply id="S3.SS4.SSS1.p1.2.m2.4.4.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4"><eq id="S3.SS4.SSS1.p1.2.m2.4.4.4.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.4"></eq><apply id="S3.SS4.SSS1.p1.2.m2.4.4.5.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.5"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.4.4.5.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.5">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.4.4.5.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.2">𝐺</ci><ci id="S3.SS4.SSS1.p1.2.m2.4.4.5.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.5.3">𝑝</ci></apply><set id="S3.SS4.SSS1.p1.2.m2.4.4.3.4.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3"><apply id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.2">𝑔</ci><cn id="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.2">𝑔</ci><cn id="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS4.SSS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS4.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.1.1">…</ci><apply id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.2">𝑔</ci><apply id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.1.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.2.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.2">𝑁</ci><ci id="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.3.cmml" xref="S3.SS4.SSS1.p1.2.m2.4.4.3.3.3.3.3">𝑝</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.2.m2.4c">G_{p}=\left\{g_{1},g_{2},...,g_{N_{p}}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.2.m2.4d">italic_G start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = { italic_g start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_g start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_g start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math>, to adaptively learn filter parameters for different tasks. Concretely, the learner <math alttext="G_{p}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.3.m3.1"><semantics id="S3.SS4.SSS1.p1.3.m3.1a"><msub id="S3.SS4.SSS1.p1.3.m3.1.1" xref="S3.SS4.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS4.SSS1.p1.3.m3.1.1.2" xref="S3.SS4.SSS1.p1.3.m3.1.1.2.cmml">G</mi><mi id="S3.SS4.SSS1.p1.3.m3.1.1.3" xref="S3.SS4.SSS1.p1.3.m3.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.3.m3.1b"><apply id="S3.SS4.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1.2">𝐺</ci><ci id="S3.SS4.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS4.SSS1.p1.3.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.3.m3.1c">G_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.3.m3.1d">italic_G start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> takes the current FG-prompts (from support or query) as input and maps the class-specific semantics contained in the prompts as the parameters of different Part Filters, which can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\varphi_{i}=g_{i}\left(p_{i}\right),i=1,2,...,N_{p}" class="ltx_Math" display="block" id="S3.E2.m1.5"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.2" xref="S3.E2.m1.5.5.3.cmml"><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml"><msub id="S3.E2.m1.4.4.1.1.3" xref="S3.E2.m1.4.4.1.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.3.2" xref="S3.E2.m1.4.4.1.1.3.2.cmml">φ</mi><mi id="S3.E2.m1.4.4.1.1.3.3" xref="S3.E2.m1.4.4.1.1.3.3.cmml">i</mi></msub><mo id="S3.E2.m1.4.4.1.1.2" xref="S3.E2.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml"><msub id="S3.E2.m1.4.4.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.3.2" xref="S3.E2.m1.4.4.1.1.1.3.2.cmml">g</mi><mi id="S3.E2.m1.4.4.1.1.1.3.3" xref="S3.E2.m1.4.4.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E2.m1.4.4.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.4.4.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.4.4.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.4.4.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.2.3" xref="S3.E2.m1.5.5.3a.cmml">,</mo><mrow id="S3.E2.m1.5.5.2.2" xref="S3.E2.m1.5.5.2.2.cmml"><mi id="S3.E2.m1.5.5.2.2.3" xref="S3.E2.m1.5.5.2.2.3.cmml">i</mi><mo id="S3.E2.m1.5.5.2.2.2" xref="S3.E2.m1.5.5.2.2.2.cmml">=</mo><mrow id="S3.E2.m1.5.5.2.2.1.1" xref="S3.E2.m1.5.5.2.2.1.2.cmml"><mn id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">1</mn><mo id="S3.E2.m1.5.5.2.2.1.1.2" xref="S3.E2.m1.5.5.2.2.1.2.cmml">,</mo><mn id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">2</mn><mo id="S3.E2.m1.5.5.2.2.1.1.3" xref="S3.E2.m1.5.5.2.2.1.2.cmml">,</mo><mi id="S3.E2.m1.3.3" mathvariant="normal" xref="S3.E2.m1.3.3.cmml">…</mi><mo id="S3.E2.m1.5.5.2.2.1.1.4" xref="S3.E2.m1.5.5.2.2.1.2.cmml">,</mo><msub id="S3.E2.m1.5.5.2.2.1.1.1" xref="S3.E2.m1.5.5.2.2.1.1.1.cmml"><mi id="S3.E2.m1.5.5.2.2.1.1.1.2" xref="S3.E2.m1.5.5.2.2.1.1.1.2.cmml">N</mi><mi id="S3.E2.m1.5.5.2.2.1.1.1.3" xref="S3.E2.m1.5.5.2.2.1.1.1.3.cmml">p</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.3.cmml" xref="S3.E2.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3a.cmml" xref="S3.E2.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1.1"><eq id="S3.E2.m1.4.4.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2"></eq><apply id="S3.E2.m1.4.4.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2">𝜑</ci><ci id="S3.E2.m1.4.4.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3">𝑖</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1"><times id="S3.E2.m1.4.4.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.2"></times><apply id="S3.E2.m1.4.4.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.3.2">𝑔</ci><ci id="S3.E2.m1.4.4.1.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.5.5.2.2.cmml" xref="S3.E2.m1.5.5.2.2"><eq id="S3.E2.m1.5.5.2.2.2.cmml" xref="S3.E2.m1.5.5.2.2.2"></eq><ci id="S3.E2.m1.5.5.2.2.3.cmml" xref="S3.E2.m1.5.5.2.2.3">𝑖</ci><list id="S3.E2.m1.5.5.2.2.1.2.cmml" xref="S3.E2.m1.5.5.2.2.1.1"><cn id="S3.E2.m1.1.1.cmml" type="integer" xref="S3.E2.m1.1.1">1</cn><cn id="S3.E2.m1.2.2.cmml" type="integer" xref="S3.E2.m1.2.2">2</cn><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">…</ci><apply id="S3.E2.m1.5.5.2.2.1.1.1.cmml" xref="S3.E2.m1.5.5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.2.2.1.1.1.1.cmml" xref="S3.E2.m1.5.5.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.5.5.2.2.1.1.1.2.cmml" xref="S3.E2.m1.5.5.2.2.1.1.1.2">𝑁</ci><ci id="S3.E2.m1.5.5.2.2.1.1.1.3.cmml" xref="S3.E2.m1.5.5.2.2.1.1.1.3">𝑝</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\varphi_{i}=g_{i}\left(p_{i}\right),i=1,2,...,N_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">italic_φ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_i = 1 , 2 , … , italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS1.p1.6">where <math alttext="g_{i}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.4.m1.1"><semantics id="S3.SS4.SSS1.p1.4.m1.1a"><msub id="S3.SS4.SSS1.p1.4.m1.1.1" xref="S3.SS4.SSS1.p1.4.m1.1.1.cmml"><mi id="S3.SS4.SSS1.p1.4.m1.1.1.2" xref="S3.SS4.SSS1.p1.4.m1.1.1.2.cmml">g</mi><mi id="S3.SS4.SSS1.p1.4.m1.1.1.3" xref="S3.SS4.SSS1.p1.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.4.m1.1b"><apply id="S3.SS4.SSS1.p1.4.m1.1.1.cmml" xref="S3.SS4.SSS1.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.4.m1.1.1.1.cmml" xref="S3.SS4.SSS1.p1.4.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p1.4.m1.1.1.2.cmml" xref="S3.SS4.SSS1.p1.4.m1.1.1.2">𝑔</ci><ci id="S3.SS4.SSS1.p1.4.m1.1.1.3.cmml" xref="S3.SS4.SSS1.p1.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.4.m1.1c">g_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.4.m1.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is formed by a two-layer MLP module and <math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.5.m2.1"><semantics id="S3.SS4.SSS1.p1.5.m2.1a"><msub id="S3.SS4.SSS1.p1.5.m2.1.1" xref="S3.SS4.SSS1.p1.5.m2.1.1.cmml"><mi id="S3.SS4.SSS1.p1.5.m2.1.1.2" xref="S3.SS4.SSS1.p1.5.m2.1.1.2.cmml">p</mi><mi id="S3.SS4.SSS1.p1.5.m2.1.1.3" xref="S3.SS4.SSS1.p1.5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.5.m2.1b"><apply id="S3.SS4.SSS1.p1.5.m2.1.1.cmml" xref="S3.SS4.SSS1.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.5.m2.1.1.1.cmml" xref="S3.SS4.SSS1.p1.5.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p1.5.m2.1.1.2.cmml" xref="S3.SS4.SSS1.p1.5.m2.1.1.2">𝑝</ci><ci id="S3.SS4.SSS1.p1.5.m2.1.1.3.cmml" xref="S3.SS4.SSS1.p1.5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.5.m2.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.5.m2.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes the <math alttext="i^{th}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p1.6.m3.1"><semantics id="S3.SS4.SSS1.p1.6.m3.1a"><msup id="S3.SS4.SSS1.p1.6.m3.1.1" xref="S3.SS4.SSS1.p1.6.m3.1.1.cmml"><mi id="S3.SS4.SSS1.p1.6.m3.1.1.2" xref="S3.SS4.SSS1.p1.6.m3.1.1.2.cmml">i</mi><mrow id="S3.SS4.SSS1.p1.6.m3.1.1.3" xref="S3.SS4.SSS1.p1.6.m3.1.1.3.cmml"><mi id="S3.SS4.SSS1.p1.6.m3.1.1.3.2" xref="S3.SS4.SSS1.p1.6.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS4.SSS1.p1.6.m3.1.1.3.1" xref="S3.SS4.SSS1.p1.6.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.SSS1.p1.6.m3.1.1.3.3" xref="S3.SS4.SSS1.p1.6.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p1.6.m3.1b"><apply id="S3.SS4.SSS1.p1.6.m3.1.1.cmml" xref="S3.SS4.SSS1.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p1.6.m3.1.1.1.cmml" xref="S3.SS4.SSS1.p1.6.m3.1.1">superscript</csymbol><ci id="S3.SS4.SSS1.p1.6.m3.1.1.2.cmml" xref="S3.SS4.SSS1.p1.6.m3.1.1.2">𝑖</ci><apply id="S3.SS4.SSS1.p1.6.m3.1.1.3.cmml" xref="S3.SS4.SSS1.p1.6.m3.1.1.3"><times id="S3.SS4.SSS1.p1.6.m3.1.1.3.1.cmml" xref="S3.SS4.SSS1.p1.6.m3.1.1.3.1"></times><ci id="S3.SS4.SSS1.p1.6.m3.1.1.3.2.cmml" xref="S3.SS4.SSS1.p1.6.m3.1.1.3.2">𝑡</ci><ci id="S3.SS4.SSS1.p1.6.m3.1.1.3.3.cmml" xref="S3.SS4.SSS1.p1.6.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p1.6.m3.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p1.6.m3.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> FG-prompt. With this learner, the Part Filter can adaptively obtain the most suitable set of parameters for different tasks (classes), thus generating part regions more accurately.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS1.p2">
<p class="ltx_p" id="S3.SS4.SSS1.p2.5">After that, we apply the Part Filters <math alttext="\varphi\in\mathbb{R}{{}^{N_{p}\times d\times 1\times 1}}" class="ltx_math_unparsed" display="inline" id="S3.SS4.SSS1.p2.1.m1.1"><semantics id="S3.SS4.SSS1.p2.1.m1.1a"><mrow id="S3.SS4.SSS1.p2.1.m1.1b"><mi id="S3.SS4.SSS1.p2.1.m1.1.1">φ</mi><mo id="S3.SS4.SSS1.p2.1.m1.1.2">∈</mo><mi id="S3.SS4.SSS1.p2.1.m1.1.3">ℝ</mi><msup id="S3.SS4.SSS1.p2.1.m1.1.4"><mi id="S3.SS4.SSS1.p2.1.m1.1.4a"></mi><mrow id="S3.SS4.SSS1.p2.1.m1.1.4.1"><msub id="S3.SS4.SSS1.p2.1.m1.1.4.1.2"><mi id="S3.SS4.SSS1.p2.1.m1.1.4.1.2.2">N</mi><mi id="S3.SS4.SSS1.p2.1.m1.1.4.1.2.3">p</mi></msub><mo id="S3.SS4.SSS1.p2.1.m1.1.4.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS4.SSS1.p2.1.m1.1.4.1.3">d</mi><mo id="S3.SS4.SSS1.p2.1.m1.1.4.1.1a" lspace="0.222em" rspace="0.222em">×</mo><mn id="S3.SS4.SSS1.p2.1.m1.1.4.1.4">1</mn><mo id="S3.SS4.SSS1.p2.1.m1.1.4.1.1b" lspace="0.222em" rspace="0.222em">×</mo><mn id="S3.SS4.SSS1.p2.1.m1.1.4.1.5">1</mn></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p2.1.m1.1c">\varphi\in\mathbb{R}{{}^{N_{p}\times d\times 1\times 1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p2.1.m1.1d">italic_φ ∈ blackboard_R start_FLOATSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT × italic_d × 1 × 1 end_FLOATSUPERSCRIPT</annotation></semantics></math> as <math alttext="1\times 1" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p2.2.m2.1"><semantics id="S3.SS4.SSS1.p2.2.m2.1a"><mrow id="S3.SS4.SSS1.p2.2.m2.1.1" xref="S3.SS4.SSS1.p2.2.m2.1.1.cmml"><mn id="S3.SS4.SSS1.p2.2.m2.1.1.2" xref="S3.SS4.SSS1.p2.2.m2.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS1.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS1.p2.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS4.SSS1.p2.2.m2.1.1.3" xref="S3.SS4.SSS1.p2.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p2.2.m2.1b"><apply id="S3.SS4.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS4.SSS1.p2.2.m2.1.1"><times id="S3.SS4.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS4.SSS1.p2.2.m2.1.1.1"></times><cn id="S3.SS4.SSS1.p2.2.m2.1.1.2.cmml" type="integer" xref="S3.SS4.SSS1.p2.2.m2.1.1.2">1</cn><cn id="S3.SS4.SSS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.SSS1.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p2.2.m2.1c">1\times 1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p2.2.m2.1d">1 × 1</annotation></semantics></math> convolution kernels to map the image features <math alttext="X" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p2.3.m3.1"><semantics id="S3.SS4.SSS1.p2.3.m3.1a"><mi id="S3.SS4.SSS1.p2.3.m3.1.1" xref="S3.SS4.SSS1.p2.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p2.3.m3.1b"><ci id="S3.SS4.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS4.SSS1.p2.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p2.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p2.3.m3.1d">italic_X</annotation></semantics></math> (reshaped into <math alttext="H\times W\times d" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p2.4.m4.1"><semantics id="S3.SS4.SSS1.p2.4.m4.1a"><mrow id="S3.SS4.SSS1.p2.4.m4.1.1" xref="S3.SS4.SSS1.p2.4.m4.1.1.cmml"><mi id="S3.SS4.SSS1.p2.4.m4.1.1.2" xref="S3.SS4.SSS1.p2.4.m4.1.1.2.cmml">H</mi><mo id="S3.SS4.SSS1.p2.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS1.p2.4.m4.1.1.1.cmml">×</mo><mi id="S3.SS4.SSS1.p2.4.m4.1.1.3" xref="S3.SS4.SSS1.p2.4.m4.1.1.3.cmml">W</mi><mo id="S3.SS4.SSS1.p2.4.m4.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS1.p2.4.m4.1.1.1.cmml">×</mo><mi id="S3.SS4.SSS1.p2.4.m4.1.1.4" xref="S3.SS4.SSS1.p2.4.m4.1.1.4.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p2.4.m4.1b"><apply id="S3.SS4.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS4.SSS1.p2.4.m4.1.1"><times id="S3.SS4.SSS1.p2.4.m4.1.1.1.cmml" xref="S3.SS4.SSS1.p2.4.m4.1.1.1"></times><ci id="S3.SS4.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS4.SSS1.p2.4.m4.1.1.2">𝐻</ci><ci id="S3.SS4.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS4.SSS1.p2.4.m4.1.1.3">𝑊</ci><ci id="S3.SS4.SSS1.p2.4.m4.1.1.4.cmml" xref="S3.SS4.SSS1.p2.4.m4.1.1.4">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p2.4.m4.1c">H\times W\times d</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p2.4.m4.1d">italic_H × italic_W × italic_d</annotation></semantics></math>) into the part activation maps. We then normalize these activation maps for distinction and multiply them by the foreground mask to force attention to the foreground region. Thus, the part masks <math alttext="M^{p}=\left\{m^{p}_{1},m^{p}_{2},...,m^{p}_{N_{p}}\right\}\in\mathbb{R}{{}^{N_%
{p}\times H\times W}}" class="ltx_math_unparsed" display="inline" id="S3.SS4.SSS1.p2.5.m5.1"><semantics id="S3.SS4.SSS1.p2.5.m5.1a"><mrow id="S3.SS4.SSS1.p2.5.m5.1b"><msup id="S3.SS4.SSS1.p2.5.m5.1.2"><mi id="S3.SS4.SSS1.p2.5.m5.1.2.2">M</mi><mi id="S3.SS4.SSS1.p2.5.m5.1.2.3">p</mi></msup><mo id="S3.SS4.SSS1.p2.5.m5.1.3">=</mo><mrow id="S3.SS4.SSS1.p2.5.m5.1.4"><mo id="S3.SS4.SSS1.p2.5.m5.1.4.1">{</mo><msubsup id="S3.SS4.SSS1.p2.5.m5.1.4.2"><mi id="S3.SS4.SSS1.p2.5.m5.1.4.2.2.2">m</mi><mn id="S3.SS4.SSS1.p2.5.m5.1.4.2.3">1</mn><mi id="S3.SS4.SSS1.p2.5.m5.1.4.2.2.3">p</mi></msubsup><mo id="S3.SS4.SSS1.p2.5.m5.1.4.3">,</mo><msubsup id="S3.SS4.SSS1.p2.5.m5.1.4.4"><mi id="S3.SS4.SSS1.p2.5.m5.1.4.4.2.2">m</mi><mn id="S3.SS4.SSS1.p2.5.m5.1.4.4.3">2</mn><mi id="S3.SS4.SSS1.p2.5.m5.1.4.4.2.3">p</mi></msubsup><mo id="S3.SS4.SSS1.p2.5.m5.1.4.5">,</mo><mi id="S3.SS4.SSS1.p2.5.m5.1.1" mathvariant="normal">…</mi><mo id="S3.SS4.SSS1.p2.5.m5.1.4.6">,</mo><msubsup id="S3.SS4.SSS1.p2.5.m5.1.4.7"><mi id="S3.SS4.SSS1.p2.5.m5.1.4.7.2.2">m</mi><msub id="S3.SS4.SSS1.p2.5.m5.1.4.7.3"><mi id="S3.SS4.SSS1.p2.5.m5.1.4.7.3.2">N</mi><mi id="S3.SS4.SSS1.p2.5.m5.1.4.7.3.3">p</mi></msub><mi id="S3.SS4.SSS1.p2.5.m5.1.4.7.2.3">p</mi></msubsup><mo id="S3.SS4.SSS1.p2.5.m5.1.4.8">}</mo></mrow><mo id="S3.SS4.SSS1.p2.5.m5.1.5">∈</mo><mi id="S3.SS4.SSS1.p2.5.m5.1.6">ℝ</mi><msup id="S3.SS4.SSS1.p2.5.m5.1.7"><mi id="S3.SS4.SSS1.p2.5.m5.1.7a"></mi><mrow id="S3.SS4.SSS1.p2.5.m5.1.7.1"><msub id="S3.SS4.SSS1.p2.5.m5.1.7.1.2"><mi id="S3.SS4.SSS1.p2.5.m5.1.7.1.2.2">N</mi><mi id="S3.SS4.SSS1.p2.5.m5.1.7.1.2.3">p</mi></msub><mo id="S3.SS4.SSS1.p2.5.m5.1.7.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS4.SSS1.p2.5.m5.1.7.1.3">H</mi><mo id="S3.SS4.SSS1.p2.5.m5.1.7.1.1a" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS4.SSS1.p2.5.m5.1.7.1.4">W</mi></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p2.5.m5.1c">M^{p}=\left\{m^{p}_{1},m^{p}_{2},...,m^{p}_{N_{p}}\right\}\in\mathbb{R}{{}^{N_%
{p}\times H\times W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p2.5.m5.1d">italic_M start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT = { italic_m start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_m start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_m start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT } ∈ blackboard_R start_FLOATSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT × italic_H × italic_W end_FLOATSUPERSCRIPT</annotation></semantics></math> are derived:</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS1.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="M^{p}=\mathrm{softmax}\left(\bigcup_{i=1}^{N_{p}}\mathcal{F}_{\varphi_{i}}%
\left(X\right)\right)\odot M^{f}" class="ltx_Math" display="block" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><msup id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml"><mi id="S3.E3.m1.2.2.3.2" xref="S3.E3.m1.2.2.3.2.cmml">M</mi><mi id="S3.E3.m1.2.2.3.3" xref="S3.E3.m1.2.2.3.3.cmml">p</mi></msup><mo id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml">=</mo><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml">softmax</mi><mo id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml"><mo id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml"><munderover id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml">⋃</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.2.cmml">N</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.3.cmml">p</mi></msub></munderover><mrow id="S3.E3.m1.2.2.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml"><msub id="S3.E3.m1.2.2.1.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.1.1.1.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.2.cmml">ℱ</mi><msub id="S3.E3.m1.2.2.1.1.1.1.1.2.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.2.cmml">φ</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.3.cmml">i</mi></msub></msub><mo id="S3.E3.m1.2.2.1.1.1.1.1.2.1" xref="S3.E3.m1.2.2.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.2.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.2.2.1.1.1.1.1.2.3.2.1" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">X</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.2.3.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.1.1.3" rspace="0.055em" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" rspace="0.222em" xref="S3.E3.m1.2.2.1.2.cmml">⊙</mo><msup id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.2.2.1.3.cmml"><mi id="S3.E3.m1.2.2.1.3.2" xref="S3.E3.m1.2.2.1.3.2.cmml">M</mi><mi id="S3.E3.m1.2.2.1.3.3" xref="S3.E3.m1.2.2.1.3.3.cmml">f</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><eq id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"></eq><apply id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.3.1.cmml" xref="S3.E3.m1.2.2.3">superscript</csymbol><ci id="S3.E3.m1.2.2.3.2.cmml" xref="S3.E3.m1.2.2.3.2">𝑀</ci><ci id="S3.E3.m1.2.2.3.3.cmml" xref="S3.E3.m1.2.2.3.3">𝑝</ci></apply><apply id="S3.E3.m1.2.2.1.cmml" xref="S3.E3.m1.2.2.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1.2">direct-product</csymbol><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1"><times id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2"></times><ci id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3">softmax</ci><apply id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1">subscript</csymbol><union id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2"></union><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3"><eq id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.2">𝑖</ci><cn id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.2">𝑁</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.3">𝑝</ci></apply></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2"><times id="S3.E3.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.1"></times><apply id="S3.E3.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.2">ℱ</ci><apply id="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.2">𝜑</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑋</ci></apply></apply></apply><apply id="S3.E3.m1.2.2.1.3.cmml" xref="S3.E3.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.3.1.cmml" xref="S3.E3.m1.2.2.1.3">superscript</csymbol><ci id="S3.E3.m1.2.2.1.3.2.cmml" xref="S3.E3.m1.2.2.1.3.2">𝑀</ci><ci id="S3.E3.m1.2.2.1.3.3.cmml" xref="S3.E3.m1.2.2.1.3.3">𝑓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">M^{p}=\mathrm{softmax}\left(\bigcup_{i=1}^{N_{p}}\mathcal{F}_{\varphi_{i}}%
\left(X\right)\right)\odot M^{f}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">italic_M start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT = roman_softmax ( ⋃ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT caligraphic_F start_POSTSUBSCRIPT italic_φ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_X ) ) ⊙ italic_M start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS1.p4">
<p class="ltx_p" id="S3.SS4.SSS1.p4.7">where <math alttext="\mathcal{F}_{\varphi}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p4.1.m1.1"><semantics id="S3.SS4.SSS1.p4.1.m1.1a"><msub id="S3.SS4.SSS1.p4.1.m1.1.1" xref="S3.SS4.SSS1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS1.p4.1.m1.1.1.2" xref="S3.SS4.SSS1.p4.1.m1.1.1.2.cmml">ℱ</mi><mi id="S3.SS4.SSS1.p4.1.m1.1.1.3" xref="S3.SS4.SSS1.p4.1.m1.1.1.3.cmml">φ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p4.1.m1.1b"><apply id="S3.SS4.SSS1.p4.1.m1.1.1.cmml" xref="S3.SS4.SSS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p4.1.m1.1.1.1.cmml" xref="S3.SS4.SSS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS1.p4.1.m1.1.1.2.cmml" xref="S3.SS4.SSS1.p4.1.m1.1.1.2">ℱ</ci><ci id="S3.SS4.SSS1.p4.1.m1.1.1.3.cmml" xref="S3.SS4.SSS1.p4.1.m1.1.1.3">𝜑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p4.1.m1.1c">\mathcal{F}_{\varphi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p4.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_φ end_POSTSUBSCRIPT</annotation></semantics></math> denotes the <math alttext="1\times 1" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p4.2.m2.1"><semantics id="S3.SS4.SSS1.p4.2.m2.1a"><mrow id="S3.SS4.SSS1.p4.2.m2.1.1" xref="S3.SS4.SSS1.p4.2.m2.1.1.cmml"><mn id="S3.SS4.SSS1.p4.2.m2.1.1.2" xref="S3.SS4.SSS1.p4.2.m2.1.1.2.cmml">1</mn><mo id="S3.SS4.SSS1.p4.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS1.p4.2.m2.1.1.1.cmml">×</mo><mn id="S3.SS4.SSS1.p4.2.m2.1.1.3" xref="S3.SS4.SSS1.p4.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p4.2.m2.1b"><apply id="S3.SS4.SSS1.p4.2.m2.1.1.cmml" xref="S3.SS4.SSS1.p4.2.m2.1.1"><times id="S3.SS4.SSS1.p4.2.m2.1.1.1.cmml" xref="S3.SS4.SSS1.p4.2.m2.1.1.1"></times><cn id="S3.SS4.SSS1.p4.2.m2.1.1.2.cmml" type="integer" xref="S3.SS4.SSS1.p4.2.m2.1.1.2">1</cn><cn id="S3.SS4.SSS1.p4.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.SSS1.p4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p4.2.m2.1c">1\times 1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p4.2.m2.1d">1 × 1</annotation></semantics></math> convolution operation with part filter parameters, <math alttext="\bigcup" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p4.3.m3.1"><semantics id="S3.SS4.SSS1.p4.3.m3.1a"><mo id="S3.SS4.SSS1.p4.3.m3.1.1" xref="S3.SS4.SSS1.p4.3.m3.1.1.cmml">⋃</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p4.3.m3.1b"><union id="S3.SS4.SSS1.p4.3.m3.1.1.cmml" xref="S3.SS4.SSS1.p4.3.m3.1.1"></union></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p4.3.m3.1c">\bigcup</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p4.3.m3.1d">⋃</annotation></semantics></math> denotes the concatenation of multiple part activation maps, <math alttext="\mathrm{softmax}()" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p4.4.m4.1"><semantics id="S3.SS4.SSS1.p4.4.m4.1a"><mrow id="S3.SS4.SSS1.p4.4.m4.1.1" xref="S3.SS4.SSS1.p4.4.m4.1.1.cmml"><mi id="S3.SS4.SSS1.p4.4.m4.1.1.2" xref="S3.SS4.SSS1.p4.4.m4.1.1.2.cmml">softmax</mi><mo id="S3.SS4.SSS1.p4.4.m4.1.1.1" xref="S3.SS4.SSS1.p4.4.m4.1.1.1.cmml">⁢</mo><mrow id="S3.SS4.SSS1.p4.4.m4.1.1.3.2" xref="S3.SS4.SSS1.p4.4.m4.1.1.cmml"><mo id="S3.SS4.SSS1.p4.4.m4.1.1.3.2.1" stretchy="false" xref="S3.SS4.SSS1.p4.4.m4.1.1.3.1.cmml">(</mo><mo id="S3.SS4.SSS1.p4.4.m4.1.1.3.2.2" stretchy="false" xref="S3.SS4.SSS1.p4.4.m4.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p4.4.m4.1b"><apply id="S3.SS4.SSS1.p4.4.m4.1.1.cmml" xref="S3.SS4.SSS1.p4.4.m4.1.1"><times id="S3.SS4.SSS1.p4.4.m4.1.1.1.cmml" xref="S3.SS4.SSS1.p4.4.m4.1.1.1"></times><ci id="S3.SS4.SSS1.p4.4.m4.1.1.2.cmml" xref="S3.SS4.SSS1.p4.4.m4.1.1.2">softmax</ci><list id="S3.SS4.SSS1.p4.4.m4.1.1.3.1.cmml" xref="S3.SS4.SSS1.p4.4.m4.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p4.4.m4.1c">\mathrm{softmax}()</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p4.4.m4.1d">roman_softmax ( )</annotation></semantics></math> is performed along the dimension of the number of part activation maps, <math alttext="X" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p4.5.m5.1"><semantics id="S3.SS4.SSS1.p4.5.m5.1a"><mi id="S3.SS4.SSS1.p4.5.m5.1.1" xref="S3.SS4.SSS1.p4.5.m5.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p4.5.m5.1b"><ci id="S3.SS4.SSS1.p4.5.m5.1.1.cmml" xref="S3.SS4.SSS1.p4.5.m5.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p4.5.m5.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p4.5.m5.1d">italic_X</annotation></semantics></math> denotes the query/support feature, <math alttext="\odot" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p4.6.m6.1"><semantics id="S3.SS4.SSS1.p4.6.m6.1a"><mo id="S3.SS4.SSS1.p4.6.m6.1.1" xref="S3.SS4.SSS1.p4.6.m6.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p4.6.m6.1b"><csymbol cd="latexml" id="S3.SS4.SSS1.p4.6.m6.1.1.cmml" xref="S3.SS4.SSS1.p4.6.m6.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p4.6.m6.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p4.6.m6.1d">⊙</annotation></semantics></math> represents the dot product operation and <math alttext="M^{f}\in\mathbb{R}{{}^{H\times W}}" class="ltx_math_unparsed" display="inline" id="S3.SS4.SSS1.p4.7.m7.1"><semantics id="S3.SS4.SSS1.p4.7.m7.1a"><mrow id="S3.SS4.SSS1.p4.7.m7.1b"><msup id="S3.SS4.SSS1.p4.7.m7.1.1"><mi id="S3.SS4.SSS1.p4.7.m7.1.1.2">M</mi><mi id="S3.SS4.SSS1.p4.7.m7.1.1.3">f</mi></msup><mo id="S3.SS4.SSS1.p4.7.m7.1.2">∈</mo><mi id="S3.SS4.SSS1.p4.7.m7.1.3">ℝ</mi><msup id="S3.SS4.SSS1.p4.7.m7.1.4"><mi id="S3.SS4.SSS1.p4.7.m7.1.4a"></mi><mrow id="S3.SS4.SSS1.p4.7.m7.1.4.1"><mi id="S3.SS4.SSS1.p4.7.m7.1.4.1.2">H</mi><mo id="S3.SS4.SSS1.p4.7.m7.1.4.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS4.SSS1.p4.7.m7.1.4.1.3">W</mi></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p4.7.m7.1c">M^{f}\in\mathbb{R}{{}^{H\times W}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p4.7.m7.1d">italic_M start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT ∈ blackboard_R start_FLOATSUPERSCRIPT italic_H × italic_W end_FLOATSUPERSCRIPT</annotation></semantics></math> represents the foreground mask of the support/query image.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS1.p5">
<p class="ltx_p" id="S3.SS4.SSS1.p5.3">Remarkably, we construct a pseudo-mask for the query image, which is derived by weighted aggregation of the support mask with the affinity map between the support- and the query- feature:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{M^{q}}=\mathrm{sigmoid}\left(\frac{X_{q}X_{s}^{T}}{\left\|X_{q}\right\|%
\left\|X_{s}\right\|}M^{s}\right)" class="ltx_Math" display="block" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml"><mover accent="true" id="S3.E4.m1.3.3.3" xref="S3.E4.m1.3.3.3.cmml"><msup id="S3.E4.m1.3.3.3.2" xref="S3.E4.m1.3.3.3.2.cmml"><mi id="S3.E4.m1.3.3.3.2.2" xref="S3.E4.m1.3.3.3.2.2.cmml">M</mi><mi id="S3.E4.m1.3.3.3.2.3" xref="S3.E4.m1.3.3.3.2.3.cmml">q</mi></msup><mo id="S3.E4.m1.3.3.3.1" xref="S3.E4.m1.3.3.3.1.cmml">^</mo></mover><mo id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.2.cmml">=</mo><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.cmml"><mi id="S3.E4.m1.3.3.1.3" xref="S3.E4.m1.3.3.1.3.cmml">sigmoid</mi><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml"><mo id="S3.E4.m1.3.3.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml"><mfrac id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><mrow id="S3.E4.m1.2.2.4" xref="S3.E4.m1.2.2.4.cmml"><msub id="S3.E4.m1.2.2.4.2" xref="S3.E4.m1.2.2.4.2.cmml"><mi id="S3.E4.m1.2.2.4.2.2" xref="S3.E4.m1.2.2.4.2.2.cmml">X</mi><mi id="S3.E4.m1.2.2.4.2.3" xref="S3.E4.m1.2.2.4.2.3.cmml">q</mi></msub><mo id="S3.E4.m1.2.2.4.1" xref="S3.E4.m1.2.2.4.1.cmml">⁢</mo><msubsup id="S3.E4.m1.2.2.4.3" xref="S3.E4.m1.2.2.4.3.cmml"><mi id="S3.E4.m1.2.2.4.3.2.2" xref="S3.E4.m1.2.2.4.3.2.2.cmml">X</mi><mi id="S3.E4.m1.2.2.4.3.2.3" xref="S3.E4.m1.2.2.4.3.2.3.cmml">s</mi><mi id="S3.E4.m1.2.2.4.3.3" xref="S3.E4.m1.2.2.4.3.3.cmml">T</mi></msubsup></mrow><mrow id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml"><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E4.m1.2.2.2.3" xref="S3.E4.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.cmml"><mo id="S3.E4.m1.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.2.1.cmml">‖</mo><msub id="S3.E4.m1.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.1.1.cmml"><mi id="S3.E4.m1.2.2.2.2.1.1.2" xref="S3.E4.m1.2.2.2.2.1.1.2.cmml">X</mi><mi id="S3.E4.m1.2.2.2.2.1.1.3" xref="S3.E4.m1.2.2.2.2.1.1.3.cmml">s</mi></msub><mo id="S3.E4.m1.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac><mo id="S3.E4.m1.3.3.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml">⁢</mo><msup id="S3.E4.m1.3.3.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.2.2" xref="S3.E4.m1.3.3.1.1.1.1.2.2.cmml">M</mi><mi id="S3.E4.m1.3.3.1.1.1.1.2.3" xref="S3.E4.m1.3.3.1.1.1.1.2.3.cmml">s</mi></msup></mrow><mo id="S3.E4.m1.3.3.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"><eq id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.2"></eq><apply id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.3"><ci id="S3.E4.m1.3.3.3.1.cmml" xref="S3.E4.m1.3.3.3.1">^</ci><apply id="S3.E4.m1.3.3.3.2.cmml" xref="S3.E4.m1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.2.1.cmml" xref="S3.E4.m1.3.3.3.2">superscript</csymbol><ci id="S3.E4.m1.3.3.3.2.2.cmml" xref="S3.E4.m1.3.3.3.2.2">𝑀</ci><ci id="S3.E4.m1.3.3.3.2.3.cmml" xref="S3.E4.m1.3.3.3.2.3">𝑞</ci></apply></apply><apply id="S3.E4.m1.3.3.1.cmml" xref="S3.E4.m1.3.3.1"><times id="S3.E4.m1.3.3.1.2.cmml" xref="S3.E4.m1.3.3.1.2"></times><ci id="S3.E4.m1.3.3.1.3.cmml" xref="S3.E4.m1.3.3.1.3">sigmoid</ci><apply id="S3.E4.m1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"><times id="S3.E4.m1.3.3.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1"></times><apply id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><divide id="S3.E4.m1.2.2.3.cmml" xref="S3.E4.m1.2.2"></divide><apply id="S3.E4.m1.2.2.4.cmml" xref="S3.E4.m1.2.2.4"><times id="S3.E4.m1.2.2.4.1.cmml" xref="S3.E4.m1.2.2.4.1"></times><apply id="S3.E4.m1.2.2.4.2.cmml" xref="S3.E4.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.4.2.1.cmml" xref="S3.E4.m1.2.2.4.2">subscript</csymbol><ci id="S3.E4.m1.2.2.4.2.2.cmml" xref="S3.E4.m1.2.2.4.2.2">𝑋</ci><ci id="S3.E4.m1.2.2.4.2.3.cmml" xref="S3.E4.m1.2.2.4.2.3">𝑞</ci></apply><apply id="S3.E4.m1.2.2.4.3.cmml" xref="S3.E4.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.4.3.1.cmml" xref="S3.E4.m1.2.2.4.3">superscript</csymbol><apply id="S3.E4.m1.2.2.4.3.2.cmml" xref="S3.E4.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.4.3.2.1.cmml" xref="S3.E4.m1.2.2.4.3">subscript</csymbol><ci id="S3.E4.m1.2.2.4.3.2.2.cmml" xref="S3.E4.m1.2.2.4.3.2.2">𝑋</ci><ci id="S3.E4.m1.2.2.4.3.2.3.cmml" xref="S3.E4.m1.2.2.4.3.2.3">𝑠</ci></apply><ci id="S3.E4.m1.2.2.4.3.3.cmml" xref="S3.E4.m1.2.2.4.3.3">𝑇</ci></apply></apply><apply id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"><times id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.3"></times><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">𝑞</ci></apply></apply><apply id="S3.E4.m1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E4.m1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.1.2">norm</csymbol><apply id="S3.E4.m1.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.2.2.1.1.2">𝑋</ci><ci id="S3.E4.m1.2.2.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.2.2.1.1.3">𝑠</ci></apply></apply></apply></apply><apply id="S3.E4.m1.3.3.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2.2">𝑀</ci><ci id="S3.E4.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\hat{M^{q}}=\mathrm{sigmoid}\left(\frac{X_{q}X_{s}^{T}}{\left\|X_{q}\right\|%
\left\|X_{s}\right\|}M^{s}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">over^ start_ARG italic_M start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT end_ARG = roman_sigmoid ( divide start_ARG italic_X start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG ∥ italic_X start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∥ ∥ italic_X start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ∥ end_ARG italic_M start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS1.p5.2">where <math alttext="\hat{M^{q}}" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p5.1.m1.1"><semantics id="S3.SS4.SSS1.p5.1.m1.1a"><mover accent="true" id="S3.SS4.SSS1.p5.1.m1.1.1" xref="S3.SS4.SSS1.p5.1.m1.1.1.cmml"><msup id="S3.SS4.SSS1.p5.1.m1.1.1.2" xref="S3.SS4.SSS1.p5.1.m1.1.1.2.cmml"><mi id="S3.SS4.SSS1.p5.1.m1.1.1.2.2" xref="S3.SS4.SSS1.p5.1.m1.1.1.2.2.cmml">M</mi><mi id="S3.SS4.SSS1.p5.1.m1.1.1.2.3" xref="S3.SS4.SSS1.p5.1.m1.1.1.2.3.cmml">q</mi></msup><mo id="S3.SS4.SSS1.p5.1.m1.1.1.1" xref="S3.SS4.SSS1.p5.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p5.1.m1.1b"><apply id="S3.SS4.SSS1.p5.1.m1.1.1.cmml" xref="S3.SS4.SSS1.p5.1.m1.1.1"><ci id="S3.SS4.SSS1.p5.1.m1.1.1.1.cmml" xref="S3.SS4.SSS1.p5.1.m1.1.1.1">^</ci><apply id="S3.SS4.SSS1.p5.1.m1.1.1.2.cmml" xref="S3.SS4.SSS1.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS1.p5.1.m1.1.1.2.1.cmml" xref="S3.SS4.SSS1.p5.1.m1.1.1.2">superscript</csymbol><ci id="S3.SS4.SSS1.p5.1.m1.1.1.2.2.cmml" xref="S3.SS4.SSS1.p5.1.m1.1.1.2.2">𝑀</ci><ci id="S3.SS4.SSS1.p5.1.m1.1.1.2.3.cmml" xref="S3.SS4.SSS1.p5.1.m1.1.1.2.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p5.1.m1.1c">\hat{M^{q}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p5.1.m1.1d">over^ start_ARG italic_M start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math> is reshaped into <math alttext="H\times W" class="ltx_Math" display="inline" id="S3.SS4.SSS1.p5.2.m2.1"><semantics id="S3.SS4.SSS1.p5.2.m2.1a"><mrow id="S3.SS4.SSS1.p5.2.m2.1.1" xref="S3.SS4.SSS1.p5.2.m2.1.1.cmml"><mi id="S3.SS4.SSS1.p5.2.m2.1.1.2" xref="S3.SS4.SSS1.p5.2.m2.1.1.2.cmml">H</mi><mo id="S3.SS4.SSS1.p5.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS1.p5.2.m2.1.1.1.cmml">×</mo><mi id="S3.SS4.SSS1.p5.2.m2.1.1.3" xref="S3.SS4.SSS1.p5.2.m2.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS1.p5.2.m2.1b"><apply id="S3.SS4.SSS1.p5.2.m2.1.1.cmml" xref="S3.SS4.SSS1.p5.2.m2.1.1"><times id="S3.SS4.SSS1.p5.2.m2.1.1.1.cmml" xref="S3.SS4.SSS1.p5.2.m2.1.1.1"></times><ci id="S3.SS4.SSS1.p5.2.m2.1.1.2.cmml" xref="S3.SS4.SSS1.p5.2.m2.1.1.2">𝐻</ci><ci id="S3.SS4.SSS1.p5.2.m2.1.1.3.cmml" xref="S3.SS4.SSS1.p5.2.m2.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS1.p5.2.m2.1c">H\times W</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS1.p5.2.m2.1d">italic_H × italic_W</annotation></semantics></math> for part mask generation in Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E3" title="In 3.4.1 Part Mask Generator (PMG) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">3</span></a>). We expect to exploit this coarse query foreground mask to capture the semantics from the query image itself, instead of utilizing support semantics solely. In this way, performance degradation due to the differences between image pairs can be minimized.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS1.p6">
<p class="ltx_p" id="S3.SS4.SSS1.p6.1">With the Part Mask Generator (PMG), we can obtain the part masks for the support and the query image, respectively, which will be fed to the Semantic Prompt Transfer (SPT) to constrain the route of transferring semantics.</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="389" id="S3.F5.g1" src="extracted/5858111/Figure/Part_mask_Generator.jpg" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>The specific process of the Part Mask Generator (PMG), which aims at adaptively generating a series of different part-level masks for different individuals. </figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.2 </span>Semantic Prompt Transfer (SPT)</h4>
<div class="ltx_para" id="S3.SS4.SSS2.p1">
<p class="ltx_p" id="S3.SS4.SSS2.p1.1">Prompt Enhancement aims at transferring target semantics to prompts for enhancing class-awareness, where exploiting cross-attention is a natural choice. Based on this, we construct a novel Semantic Prompt Transfer (SPT). As illustrated in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.F6" title="Figure 6 ‣ 3.4.2 Semantic Prompt Transfer (SPT) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">6</span></a>, our improvements can be summarized in two parts:</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p2">
<p class="ltx_p" id="S3.SS4.SSS2.p2.2">1) To precisely transfer the semantics within a specific region (e.g., the different part mask from PMG) to the prompt rather than the entire feature semantics, the attention region for cross-attention needs to be restricted. Notably, our part masks <math alttext="M^{p}\in\left[0,1\right]" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.1.m1.2"><semantics id="S3.SS4.SSS2.p2.1.m1.2a"><mrow id="S3.SS4.SSS2.p2.1.m1.2.3" xref="S3.SS4.SSS2.p2.1.m1.2.3.cmml"><msup id="S3.SS4.SSS2.p2.1.m1.2.3.2" xref="S3.SS4.SSS2.p2.1.m1.2.3.2.cmml"><mi id="S3.SS4.SSS2.p2.1.m1.2.3.2.2" xref="S3.SS4.SSS2.p2.1.m1.2.3.2.2.cmml">M</mi><mi id="S3.SS4.SSS2.p2.1.m1.2.3.2.3" xref="S3.SS4.SSS2.p2.1.m1.2.3.2.3.cmml">p</mi></msup><mo id="S3.SS4.SSS2.p2.1.m1.2.3.1" xref="S3.SS4.SSS2.p2.1.m1.2.3.1.cmml">∈</mo><mrow id="S3.SS4.SSS2.p2.1.m1.2.3.3.2" xref="S3.SS4.SSS2.p2.1.m1.2.3.3.1.cmml"><mo id="S3.SS4.SSS2.p2.1.m1.2.3.3.2.1" xref="S3.SS4.SSS2.p2.1.m1.2.3.3.1.cmml">[</mo><mn id="S3.SS4.SSS2.p2.1.m1.1.1" xref="S3.SS4.SSS2.p2.1.m1.1.1.cmml">0</mn><mo id="S3.SS4.SSS2.p2.1.m1.2.3.3.2.2" xref="S3.SS4.SSS2.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS4.SSS2.p2.1.m1.2.2" xref="S3.SS4.SSS2.p2.1.m1.2.2.cmml">1</mn><mo id="S3.SS4.SSS2.p2.1.m1.2.3.3.2.3" xref="S3.SS4.SSS2.p2.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.1.m1.2b"><apply id="S3.SS4.SSS2.p2.1.m1.2.3.cmml" xref="S3.SS4.SSS2.p2.1.m1.2.3"><in id="S3.SS4.SSS2.p2.1.m1.2.3.1.cmml" xref="S3.SS4.SSS2.p2.1.m1.2.3.1"></in><apply id="S3.SS4.SSS2.p2.1.m1.2.3.2.cmml" xref="S3.SS4.SSS2.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p2.1.m1.2.3.2.1.cmml" xref="S3.SS4.SSS2.p2.1.m1.2.3.2">superscript</csymbol><ci id="S3.SS4.SSS2.p2.1.m1.2.3.2.2.cmml" xref="S3.SS4.SSS2.p2.1.m1.2.3.2.2">𝑀</ci><ci id="S3.SS4.SSS2.p2.1.m1.2.3.2.3.cmml" xref="S3.SS4.SSS2.p2.1.m1.2.3.2.3">𝑝</ci></apply><interval closure="closed" id="S3.SS4.SSS2.p2.1.m1.2.3.3.1.cmml" xref="S3.SS4.SSS2.p2.1.m1.2.3.3.2"><cn id="S3.SS4.SSS2.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS4.SSS2.p2.1.m1.1.1">0</cn><cn id="S3.SS4.SSS2.p2.1.m1.2.2.cmml" type="integer" xref="S3.SS4.SSS2.p2.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.1.m1.2c">M^{p}\in\left[0,1\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.1.m1.2d">italic_M start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT ∈ [ 0 , 1 ]</annotation></semantics></math> are probability activation maps not binary masks, which prevents the direct utilization of Masked Attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib74" title="">74</a>]</cite> to adjust attention weights. Thus, we propose to construct a Log-Transformation to map the part masks <math alttext="M^{p}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.2.m2.1"><semantics id="S3.SS4.SSS2.p2.2.m2.1a"><msup id="S3.SS4.SSS2.p2.2.m2.1.1" xref="S3.SS4.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS4.SSS2.p2.2.m2.1.1.2" xref="S3.SS4.SSS2.p2.2.m2.1.1.2.cmml">M</mi><mi id="S3.SS4.SSS2.p2.2.m2.1.1.3" xref="S3.SS4.SSS2.p2.2.m2.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.2.m2.1b"><apply id="S3.SS4.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS4.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS4.SSS2.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS4.SSS2.p2.2.m2.1.1.2">𝑀</ci><ci id="S3.SS4.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS4.SSS2.p2.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.2.m2.1c">M^{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.2.m2.1d">italic_M start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> to the biases of attention weights:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widetilde{m}^{p}_{i}=\mathcal{F}_{log}{\left(m^{p}_{i}+\epsilon\right)},i=1,2%
,...,N_{p}" class="ltx_Math" display="block" id="S3.E5.m1.5"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5.2" xref="S3.E5.m1.5.5.3.cmml"><mrow id="S3.E5.m1.4.4.1.1" xref="S3.E5.m1.4.4.1.1.cmml"><msubsup id="S3.E5.m1.4.4.1.1.3" xref="S3.E5.m1.4.4.1.1.3.cmml"><mover accent="true" id="S3.E5.m1.4.4.1.1.3.2.2" xref="S3.E5.m1.4.4.1.1.3.2.2.cmml"><mi id="S3.E5.m1.4.4.1.1.3.2.2.2" xref="S3.E5.m1.4.4.1.1.3.2.2.2.cmml">m</mi><mo id="S3.E5.m1.4.4.1.1.3.2.2.1" xref="S3.E5.m1.4.4.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S3.E5.m1.4.4.1.1.3.3" xref="S3.E5.m1.4.4.1.1.3.3.cmml">i</mi><mi id="S3.E5.m1.4.4.1.1.3.2.3" xref="S3.E5.m1.4.4.1.1.3.2.3.cmml">p</mi></msubsup><mo id="S3.E5.m1.4.4.1.1.2" xref="S3.E5.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.4.4.1.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml"><msub id="S3.E5.m1.4.4.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.4.1.1.1.3.2" xref="S3.E5.m1.4.4.1.1.1.3.2.cmml">ℱ</mi><mrow id="S3.E5.m1.4.4.1.1.1.3.3" xref="S3.E5.m1.4.4.1.1.1.3.3.cmml"><mi id="S3.E5.m1.4.4.1.1.1.3.3.2" xref="S3.E5.m1.4.4.1.1.1.3.3.2.cmml">l</mi><mo id="S3.E5.m1.4.4.1.1.1.3.3.1" xref="S3.E5.m1.4.4.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.4.4.1.1.1.3.3.3" xref="S3.E5.m1.4.4.1.1.1.3.3.3.cmml">o</mi><mo id="S3.E5.m1.4.4.1.1.1.3.3.1a" xref="S3.E5.m1.4.4.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.4.4.1.1.1.3.3.4" xref="S3.E5.m1.4.4.1.1.1.3.3.4.cmml">g</mi></mrow></msub><mo id="S3.E5.m1.4.4.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.4.4.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.4.4.1.1.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.4.4.1.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.cmml"><msubsup id="S3.E5.m1.4.4.1.1.1.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">m</mi><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.2.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.cmml">p</mi></msubsup><mo id="S3.E5.m1.4.4.1.1.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="S3.E5.m1.4.4.1.1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.5.5.2.3" xref="S3.E5.m1.5.5.3a.cmml">,</mo><mrow id="S3.E5.m1.5.5.2.2" xref="S3.E5.m1.5.5.2.2.cmml"><mi id="S3.E5.m1.5.5.2.2.3" xref="S3.E5.m1.5.5.2.2.3.cmml">i</mi><mo id="S3.E5.m1.5.5.2.2.2" xref="S3.E5.m1.5.5.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.5.5.2.2.1.1" xref="S3.E5.m1.5.5.2.2.1.2.cmml"><mn id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">1</mn><mo id="S3.E5.m1.5.5.2.2.1.1.2" xref="S3.E5.m1.5.5.2.2.1.2.cmml">,</mo><mn id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">2</mn><mo id="S3.E5.m1.5.5.2.2.1.1.3" xref="S3.E5.m1.5.5.2.2.1.2.cmml">,</mo><mi id="S3.E5.m1.3.3" mathvariant="normal" xref="S3.E5.m1.3.3.cmml">…</mi><mo id="S3.E5.m1.5.5.2.2.1.1.4" xref="S3.E5.m1.5.5.2.2.1.2.cmml">,</mo><msub id="S3.E5.m1.5.5.2.2.1.1.1" xref="S3.E5.m1.5.5.2.2.1.1.1.cmml"><mi id="S3.E5.m1.5.5.2.2.1.1.1.2" xref="S3.E5.m1.5.5.2.2.1.1.1.2.cmml">N</mi><mi id="S3.E5.m1.5.5.2.2.1.1.1.3" xref="S3.E5.m1.5.5.2.2.1.1.1.3.cmml">p</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.3.cmml" xref="S3.E5.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.3a.cmml" xref="S3.E5.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.4.4.1.1.cmml" xref="S3.E5.m1.4.4.1.1"><eq id="S3.E5.m1.4.4.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.2"></eq><apply id="S3.E5.m1.4.4.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.3.1.cmml" xref="S3.E5.m1.4.4.1.1.3">subscript</csymbol><apply id="S3.E5.m1.4.4.1.1.3.2.cmml" xref="S3.E5.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.3.2.1.cmml" xref="S3.E5.m1.4.4.1.1.3">superscript</csymbol><apply id="S3.E5.m1.4.4.1.1.3.2.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2"><ci id="S3.E5.m1.4.4.1.1.3.2.2.1.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2.1">~</ci><ci id="S3.E5.m1.4.4.1.1.3.2.2.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2.2.2">𝑚</ci></apply><ci id="S3.E5.m1.4.4.1.1.3.2.3.cmml" xref="S3.E5.m1.4.4.1.1.3.2.3">𝑝</ci></apply><ci id="S3.E5.m1.4.4.1.1.3.3.cmml" xref="S3.E5.m1.4.4.1.1.3.3">𝑖</ci></apply><apply id="S3.E5.m1.4.4.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1"><times id="S3.E5.m1.4.4.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.2"></times><apply id="S3.E5.m1.4.4.1.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.3.1.cmml" xref="S3.E5.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.3.2.cmml" xref="S3.E5.m1.4.4.1.1.1.3.2">ℱ</ci><apply id="S3.E5.m1.4.4.1.1.1.3.3.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3"><times id="S3.E5.m1.4.4.1.1.1.3.3.1.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3.1"></times><ci id="S3.E5.m1.4.4.1.1.1.3.3.2.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3.2">𝑙</ci><ci id="S3.E5.m1.4.4.1.1.1.3.3.3.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3.3">𝑜</ci><ci id="S3.E5.m1.4.4.1.1.1.3.3.4.cmml" xref="S3.E5.m1.4.4.1.1.1.3.3.4">𝑔</ci></apply></apply><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1"><plus id="S3.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.1"></plus><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.2">𝑚</ci><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.2.3">𝑝</ci></apply><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3">italic-ϵ</ci></apply></apply></apply><apply id="S3.E5.m1.5.5.2.2.cmml" xref="S3.E5.m1.5.5.2.2"><eq id="S3.E5.m1.5.5.2.2.2.cmml" xref="S3.E5.m1.5.5.2.2.2"></eq><ci id="S3.E5.m1.5.5.2.2.3.cmml" xref="S3.E5.m1.5.5.2.2.3">𝑖</ci><list id="S3.E5.m1.5.5.2.2.1.2.cmml" xref="S3.E5.m1.5.5.2.2.1.1"><cn id="S3.E5.m1.1.1.cmml" type="integer" xref="S3.E5.m1.1.1">1</cn><cn id="S3.E5.m1.2.2.cmml" type="integer" xref="S3.E5.m1.2.2">2</cn><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">…</ci><apply id="S3.E5.m1.5.5.2.2.1.1.1.cmml" xref="S3.E5.m1.5.5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.2.2.1.1.1.1.cmml" xref="S3.E5.m1.5.5.2.2.1.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.2.2.1.1.1.2.cmml" xref="S3.E5.m1.5.5.2.2.1.1.1.2">𝑁</ci><ci id="S3.E5.m1.5.5.2.2.1.1.1.3.cmml" xref="S3.E5.m1.5.5.2.2.1.1.1.3">𝑝</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">\widetilde{m}^{p}_{i}=\mathcal{F}_{log}{\left(m^{p}_{i}+\epsilon\right)},i=1,2%
,...,N_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.5d">over~ start_ARG italic_m end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = caligraphic_F start_POSTSUBSCRIPT italic_l italic_o italic_g end_POSTSUBSCRIPT ( italic_m start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_ϵ ) , italic_i = 1 , 2 , … , italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS2.p2.6">where <math alttext="\mathcal{F}_{log}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.3.m1.1"><semantics id="S3.SS4.SSS2.p2.3.m1.1a"><msub id="S3.SS4.SSS2.p2.3.m1.1.1" xref="S3.SS4.SSS2.p2.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p2.3.m1.1.1.2" xref="S3.SS4.SSS2.p2.3.m1.1.1.2.cmml">ℱ</mi><mrow id="S3.SS4.SSS2.p2.3.m1.1.1.3" xref="S3.SS4.SSS2.p2.3.m1.1.1.3.cmml"><mi id="S3.SS4.SSS2.p2.3.m1.1.1.3.2" xref="S3.SS4.SSS2.p2.3.m1.1.1.3.2.cmml">l</mi><mo id="S3.SS4.SSS2.p2.3.m1.1.1.3.1" xref="S3.SS4.SSS2.p2.3.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.SSS2.p2.3.m1.1.1.3.3" xref="S3.SS4.SSS2.p2.3.m1.1.1.3.3.cmml">o</mi><mo id="S3.SS4.SSS2.p2.3.m1.1.1.3.1a" xref="S3.SS4.SSS2.p2.3.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.SSS2.p2.3.m1.1.1.3.4" xref="S3.SS4.SSS2.p2.3.m1.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.3.m1.1b"><apply id="S3.SS4.SSS2.p2.3.m1.1.1.cmml" xref="S3.SS4.SSS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p2.3.m1.1.1.1.cmml" xref="S3.SS4.SSS2.p2.3.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p2.3.m1.1.1.2.cmml" xref="S3.SS4.SSS2.p2.3.m1.1.1.2">ℱ</ci><apply id="S3.SS4.SSS2.p2.3.m1.1.1.3.cmml" xref="S3.SS4.SSS2.p2.3.m1.1.1.3"><times id="S3.SS4.SSS2.p2.3.m1.1.1.3.1.cmml" xref="S3.SS4.SSS2.p2.3.m1.1.1.3.1"></times><ci id="S3.SS4.SSS2.p2.3.m1.1.1.3.2.cmml" xref="S3.SS4.SSS2.p2.3.m1.1.1.3.2">𝑙</ci><ci id="S3.SS4.SSS2.p2.3.m1.1.1.3.3.cmml" xref="S3.SS4.SSS2.p2.3.m1.1.1.3.3">𝑜</ci><ci id="S3.SS4.SSS2.p2.3.m1.1.1.3.4.cmml" xref="S3.SS4.SSS2.p2.3.m1.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.3.m1.1c">\mathcal{F}_{log}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.3.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_l italic_o italic_g end_POSTSUBSCRIPT</annotation></semantics></math> denotes the log-transformation with base 10, with lower mask values indicating higher weight attenuation, and <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.4.m2.1"><semantics id="S3.SS4.SSS2.p2.4.m2.1a"><mi id="S3.SS4.SSS2.p2.4.m2.1.1" xref="S3.SS4.SSS2.p2.4.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.4.m2.1b"><ci id="S3.SS4.SSS2.p2.4.m2.1.1.cmml" xref="S3.SS4.SSS2.p2.4.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.4.m2.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.4.m2.1d">italic_ϵ</annotation></semantics></math> is set to <math alttext="1e-7" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p2.5.m3.1"><semantics id="S3.SS4.SSS2.p2.5.m3.1a"><mrow id="S3.SS4.SSS2.p2.5.m3.1.1" xref="S3.SS4.SSS2.p2.5.m3.1.1.cmml"><mrow id="S3.SS4.SSS2.p2.5.m3.1.1.2" xref="S3.SS4.SSS2.p2.5.m3.1.1.2.cmml"><mn id="S3.SS4.SSS2.p2.5.m3.1.1.2.2" xref="S3.SS4.SSS2.p2.5.m3.1.1.2.2.cmml">1</mn><mo id="S3.SS4.SSS2.p2.5.m3.1.1.2.1" xref="S3.SS4.SSS2.p2.5.m3.1.1.2.1.cmml">⁢</mo><mi id="S3.SS4.SSS2.p2.5.m3.1.1.2.3" xref="S3.SS4.SSS2.p2.5.m3.1.1.2.3.cmml">e</mi></mrow><mo id="S3.SS4.SSS2.p2.5.m3.1.1.1" xref="S3.SS4.SSS2.p2.5.m3.1.1.1.cmml">−</mo><mn id="S3.SS4.SSS2.p2.5.m3.1.1.3" xref="S3.SS4.SSS2.p2.5.m3.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p2.5.m3.1b"><apply id="S3.SS4.SSS2.p2.5.m3.1.1.cmml" xref="S3.SS4.SSS2.p2.5.m3.1.1"><minus id="S3.SS4.SSS2.p2.5.m3.1.1.1.cmml" xref="S3.SS4.SSS2.p2.5.m3.1.1.1"></minus><apply id="S3.SS4.SSS2.p2.5.m3.1.1.2.cmml" xref="S3.SS4.SSS2.p2.5.m3.1.1.2"><times id="S3.SS4.SSS2.p2.5.m3.1.1.2.1.cmml" xref="S3.SS4.SSS2.p2.5.m3.1.1.2.1"></times><cn id="S3.SS4.SSS2.p2.5.m3.1.1.2.2.cmml" type="integer" xref="S3.SS4.SSS2.p2.5.m3.1.1.2.2">1</cn><ci id="S3.SS4.SSS2.p2.5.m3.1.1.2.3.cmml" xref="S3.SS4.SSS2.p2.5.m3.1.1.2.3">𝑒</ci></apply><cn id="S3.SS4.SSS2.p2.5.m3.1.1.3.cmml" type="integer" xref="S3.SS4.SSS2.p2.5.m3.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.5.m3.1c">1e-7</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.5.m3.1d">1 italic_e - 7</annotation></semantics></math> to prevent computational crashes. Via this mapping, the part masks <math alttext="\widetilde{M}^{p}=\left\{\widetilde{m}^{p}_{1},\widetilde{m}^{p}_{2},...,%
\widetilde{m}^{p}_{N_{p}}\right\}\in\mathbb{R}{{}^{N_{p}\times N_{l}}}" class="ltx_math_unparsed" display="inline" id="S3.SS4.SSS2.p2.6.m4.1"><semantics id="S3.SS4.SSS2.p2.6.m4.1a"><mrow id="S3.SS4.SSS2.p2.6.m4.1b"><msup id="S3.SS4.SSS2.p2.6.m4.1.2"><mover accent="true" id="S3.SS4.SSS2.p2.6.m4.1.2.2"><mi id="S3.SS4.SSS2.p2.6.m4.1.2.2.2">M</mi><mo id="S3.SS4.SSS2.p2.6.m4.1.2.2.1">~</mo></mover><mi id="S3.SS4.SSS2.p2.6.m4.1.2.3">p</mi></msup><mo id="S3.SS4.SSS2.p2.6.m4.1.3">=</mo><mrow id="S3.SS4.SSS2.p2.6.m4.1.4"><mo id="S3.SS4.SSS2.p2.6.m4.1.4.1">{</mo><msubsup id="S3.SS4.SSS2.p2.6.m4.1.4.2"><mover accent="true" id="S3.SS4.SSS2.p2.6.m4.1.4.2.2.2"><mi id="S3.SS4.SSS2.p2.6.m4.1.4.2.2.2.2">m</mi><mo id="S3.SS4.SSS2.p2.6.m4.1.4.2.2.2.1">~</mo></mover><mn id="S3.SS4.SSS2.p2.6.m4.1.4.2.3">1</mn><mi id="S3.SS4.SSS2.p2.6.m4.1.4.2.2.3">p</mi></msubsup><mo id="S3.SS4.SSS2.p2.6.m4.1.4.3">,</mo><msubsup id="S3.SS4.SSS2.p2.6.m4.1.4.4"><mover accent="true" id="S3.SS4.SSS2.p2.6.m4.1.4.4.2.2"><mi id="S3.SS4.SSS2.p2.6.m4.1.4.4.2.2.2">m</mi><mo id="S3.SS4.SSS2.p2.6.m4.1.4.4.2.2.1">~</mo></mover><mn id="S3.SS4.SSS2.p2.6.m4.1.4.4.3">2</mn><mi id="S3.SS4.SSS2.p2.6.m4.1.4.4.2.3">p</mi></msubsup><mo id="S3.SS4.SSS2.p2.6.m4.1.4.5">,</mo><mi id="S3.SS4.SSS2.p2.6.m4.1.1" mathvariant="normal">…</mi><mo id="S3.SS4.SSS2.p2.6.m4.1.4.6">,</mo><msubsup id="S3.SS4.SSS2.p2.6.m4.1.4.7"><mover accent="true" id="S3.SS4.SSS2.p2.6.m4.1.4.7.2.2"><mi id="S3.SS4.SSS2.p2.6.m4.1.4.7.2.2.2">m</mi><mo id="S3.SS4.SSS2.p2.6.m4.1.4.7.2.2.1">~</mo></mover><msub id="S3.SS4.SSS2.p2.6.m4.1.4.7.3"><mi id="S3.SS4.SSS2.p2.6.m4.1.4.7.3.2">N</mi><mi id="S3.SS4.SSS2.p2.6.m4.1.4.7.3.3">p</mi></msub><mi id="S3.SS4.SSS2.p2.6.m4.1.4.7.2.3">p</mi></msubsup><mo id="S3.SS4.SSS2.p2.6.m4.1.4.8">}</mo></mrow><mo id="S3.SS4.SSS2.p2.6.m4.1.5">∈</mo><mi id="S3.SS4.SSS2.p2.6.m4.1.6">ℝ</mi><msup id="S3.SS4.SSS2.p2.6.m4.1.7"><mi id="S3.SS4.SSS2.p2.6.m4.1.7a"></mi><mrow id="S3.SS4.SSS2.p2.6.m4.1.7.1"><msub id="S3.SS4.SSS2.p2.6.m4.1.7.1.2"><mi id="S3.SS4.SSS2.p2.6.m4.1.7.1.2.2">N</mi><mi id="S3.SS4.SSS2.p2.6.m4.1.7.1.2.3">p</mi></msub><mo id="S3.SS4.SSS2.p2.6.m4.1.7.1.1" lspace="0.222em" rspace="0.222em">×</mo><msub id="S3.SS4.SSS2.p2.6.m4.1.7.1.3"><mi id="S3.SS4.SSS2.p2.6.m4.1.7.1.3.2">N</mi><mi id="S3.SS4.SSS2.p2.6.m4.1.7.1.3.3">l</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p2.6.m4.1c">\widetilde{M}^{p}=\left\{\widetilde{m}^{p}_{1},\widetilde{m}^{p}_{2},...,%
\widetilde{m}^{p}_{N_{p}}\right\}\in\mathbb{R}{{}^{N_{p}\times N_{l}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p2.6.m4.1d">over~ start_ARG italic_M end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT = { over~ start_ARG italic_m end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , over~ start_ARG italic_m end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , over~ start_ARG italic_m end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT } ∈ blackboard_R start_FLOATSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT × italic_N start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_FLOATSUPERSCRIPT</annotation></semantics></math> will be synchronized into the attention distribution space.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p3">
<p class="ltx_p" id="S3.SS4.SSS2.p3.2">Thus, the attention weight <math alttext="\widetilde{A}\left(P,X\right)\in\mathbb{R}{{}^{N_{p}\times N_{l}}}" class="ltx_math_unparsed" display="inline" id="S3.SS4.SSS2.p3.1.m1.2"><semantics id="S3.SS4.SSS2.p3.1.m1.2a"><mrow id="S3.SS4.SSS2.p3.1.m1.2b"><mover accent="true" id="S3.SS4.SSS2.p3.1.m1.2.3"><mi id="S3.SS4.SSS2.p3.1.m1.2.3.2">A</mi><mo id="S3.SS4.SSS2.p3.1.m1.2.3.1">~</mo></mover><mrow id="S3.SS4.SSS2.p3.1.m1.2.4"><mo id="S3.SS4.SSS2.p3.1.m1.2.4.1">(</mo><mi id="S3.SS4.SSS2.p3.1.m1.1.1">P</mi><mo id="S3.SS4.SSS2.p3.1.m1.2.4.2">,</mo><mi id="S3.SS4.SSS2.p3.1.m1.2.2">X</mi><mo id="S3.SS4.SSS2.p3.1.m1.2.4.3">)</mo></mrow><mo id="S3.SS4.SSS2.p3.1.m1.2.5">∈</mo><mi id="S3.SS4.SSS2.p3.1.m1.2.6">ℝ</mi><msup id="S3.SS4.SSS2.p3.1.m1.2.7"><mi id="S3.SS4.SSS2.p3.1.m1.2.7a"></mi><mrow id="S3.SS4.SSS2.p3.1.m1.2.7.1"><msub id="S3.SS4.SSS2.p3.1.m1.2.7.1.2"><mi id="S3.SS4.SSS2.p3.1.m1.2.7.1.2.2">N</mi><mi id="S3.SS4.SSS2.p3.1.m1.2.7.1.2.3">p</mi></msub><mo id="S3.SS4.SSS2.p3.1.m1.2.7.1.1" lspace="0.222em" rspace="0.222em">×</mo><msub id="S3.SS4.SSS2.p3.1.m1.2.7.1.3"><mi id="S3.SS4.SSS2.p3.1.m1.2.7.1.3.2">N</mi><mi id="S3.SS4.SSS2.p3.1.m1.2.7.1.3.3">l</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p3.1.m1.2c">\widetilde{A}\left(P,X\right)\in\mathbb{R}{{}^{N_{p}\times N_{l}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p3.1.m1.2d">over~ start_ARG italic_A end_ARG ( italic_P , italic_X ) ∈ blackboard_R start_FLOATSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT × italic_N start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_FLOATSUPERSCRIPT</annotation></semantics></math> can be efficiently constrained to the region of the part masks <math alttext="M^{p}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p3.2.m2.1"><semantics id="S3.SS4.SSS2.p3.2.m2.1a"><msup id="S3.SS4.SSS2.p3.2.m2.1.1" xref="S3.SS4.SSS2.p3.2.m2.1.1.cmml"><mi id="S3.SS4.SSS2.p3.2.m2.1.1.2" xref="S3.SS4.SSS2.p3.2.m2.1.1.2.cmml">M</mi><mi id="S3.SS4.SSS2.p3.2.m2.1.1.3" xref="S3.SS4.SSS2.p3.2.m2.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p3.2.m2.1b"><apply id="S3.SS4.SSS2.p3.2.m2.1.1.cmml" xref="S3.SS4.SSS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p3.2.m2.1.1.1.cmml" xref="S3.SS4.SSS2.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS4.SSS2.p3.2.m2.1.1.2.cmml" xref="S3.SS4.SSS2.p3.2.m2.1.1.2">𝑀</ci><ci id="S3.SS4.SSS2.p3.2.m2.1.1.3.cmml" xref="S3.SS4.SSS2.p3.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p3.2.m2.1c">M^{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p3.2.m2.1d">italic_M start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>, which can be calculated by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widetilde{A}_{i}\left(P,X\right)=A\left(P,X\right)+\widetilde{m}^{p}_{i},i=1,%
2,...,N_{p}" class="ltx_Math" display="block" id="S3.E6.m1.9"><semantics id="S3.E6.m1.9a"><mrow id="S3.E6.m1.9.9.2" xref="S3.E6.m1.9.9.3.cmml"><mrow id="S3.E6.m1.8.8.1.1" xref="S3.E6.m1.8.8.1.1.cmml"><mrow id="S3.E6.m1.8.8.1.1.2" xref="S3.E6.m1.8.8.1.1.2.cmml"><msub id="S3.E6.m1.8.8.1.1.2.2" xref="S3.E6.m1.8.8.1.1.2.2.cmml"><mover accent="true" id="S3.E6.m1.8.8.1.1.2.2.2" xref="S3.E6.m1.8.8.1.1.2.2.2.cmml"><mi id="S3.E6.m1.8.8.1.1.2.2.2.2" xref="S3.E6.m1.8.8.1.1.2.2.2.2.cmml">A</mi><mo id="S3.E6.m1.8.8.1.1.2.2.2.1" xref="S3.E6.m1.8.8.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.E6.m1.8.8.1.1.2.2.3" xref="S3.E6.m1.8.8.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.E6.m1.8.8.1.1.2.1" xref="S3.E6.m1.8.8.1.1.2.1.cmml">⁢</mo><mrow id="S3.E6.m1.8.8.1.1.2.3.2" xref="S3.E6.m1.8.8.1.1.2.3.1.cmml"><mo id="S3.E6.m1.8.8.1.1.2.3.2.1" xref="S3.E6.m1.8.8.1.1.2.3.1.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">P</mi><mo id="S3.E6.m1.8.8.1.1.2.3.2.2" xref="S3.E6.m1.8.8.1.1.2.3.1.cmml">,</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">X</mi><mo id="S3.E6.m1.8.8.1.1.2.3.2.3" xref="S3.E6.m1.8.8.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.8.8.1.1.1" xref="S3.E6.m1.8.8.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.8.8.1.1.3" xref="S3.E6.m1.8.8.1.1.3.cmml"><mrow id="S3.E6.m1.8.8.1.1.3.2" xref="S3.E6.m1.8.8.1.1.3.2.cmml"><mi id="S3.E6.m1.8.8.1.1.3.2.2" xref="S3.E6.m1.8.8.1.1.3.2.2.cmml">A</mi><mo id="S3.E6.m1.8.8.1.1.3.2.1" xref="S3.E6.m1.8.8.1.1.3.2.1.cmml">⁢</mo><mrow id="S3.E6.m1.8.8.1.1.3.2.3.2" xref="S3.E6.m1.8.8.1.1.3.2.3.1.cmml"><mo id="S3.E6.m1.8.8.1.1.3.2.3.2.1" xref="S3.E6.m1.8.8.1.1.3.2.3.1.cmml">(</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">P</mi><mo id="S3.E6.m1.8.8.1.1.3.2.3.2.2" xref="S3.E6.m1.8.8.1.1.3.2.3.1.cmml">,</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">X</mi><mo id="S3.E6.m1.8.8.1.1.3.2.3.2.3" xref="S3.E6.m1.8.8.1.1.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.8.8.1.1.3.1" xref="S3.E6.m1.8.8.1.1.3.1.cmml">+</mo><msubsup id="S3.E6.m1.8.8.1.1.3.3" xref="S3.E6.m1.8.8.1.1.3.3.cmml"><mover accent="true" id="S3.E6.m1.8.8.1.1.3.3.2.2" xref="S3.E6.m1.8.8.1.1.3.3.2.2.cmml"><mi id="S3.E6.m1.8.8.1.1.3.3.2.2.2" xref="S3.E6.m1.8.8.1.1.3.3.2.2.2.cmml">m</mi><mo id="S3.E6.m1.8.8.1.1.3.3.2.2.1" xref="S3.E6.m1.8.8.1.1.3.3.2.2.1.cmml">~</mo></mover><mi id="S3.E6.m1.8.8.1.1.3.3.3" xref="S3.E6.m1.8.8.1.1.3.3.3.cmml">i</mi><mi id="S3.E6.m1.8.8.1.1.3.3.2.3" xref="S3.E6.m1.8.8.1.1.3.3.2.3.cmml">p</mi></msubsup></mrow></mrow><mo id="S3.E6.m1.9.9.2.3" xref="S3.E6.m1.9.9.3a.cmml">,</mo><mrow id="S3.E6.m1.9.9.2.2" xref="S3.E6.m1.9.9.2.2.cmml"><mi id="S3.E6.m1.9.9.2.2.3" xref="S3.E6.m1.9.9.2.2.3.cmml">i</mi><mo id="S3.E6.m1.9.9.2.2.2" xref="S3.E6.m1.9.9.2.2.2.cmml">=</mo><mrow id="S3.E6.m1.9.9.2.2.1.1" xref="S3.E6.m1.9.9.2.2.1.2.cmml"><mn id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml">1</mn><mo id="S3.E6.m1.9.9.2.2.1.1.2" xref="S3.E6.m1.9.9.2.2.1.2.cmml">,</mo><mn id="S3.E6.m1.6.6" xref="S3.E6.m1.6.6.cmml">2</mn><mo id="S3.E6.m1.9.9.2.2.1.1.3" xref="S3.E6.m1.9.9.2.2.1.2.cmml">,</mo><mi id="S3.E6.m1.7.7" mathvariant="normal" xref="S3.E6.m1.7.7.cmml">…</mi><mo id="S3.E6.m1.9.9.2.2.1.1.4" xref="S3.E6.m1.9.9.2.2.1.2.cmml">,</mo><msub id="S3.E6.m1.9.9.2.2.1.1.1" xref="S3.E6.m1.9.9.2.2.1.1.1.cmml"><mi id="S3.E6.m1.9.9.2.2.1.1.1.2" xref="S3.E6.m1.9.9.2.2.1.1.1.2.cmml">N</mi><mi id="S3.E6.m1.9.9.2.2.1.1.1.3" xref="S3.E6.m1.9.9.2.2.1.1.1.3.cmml">p</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.9b"><apply id="S3.E6.m1.9.9.3.cmml" xref="S3.E6.m1.9.9.2"><csymbol cd="ambiguous" id="S3.E6.m1.9.9.3a.cmml" xref="S3.E6.m1.9.9.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.8.8.1.1.cmml" xref="S3.E6.m1.8.8.1.1"><eq id="S3.E6.m1.8.8.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.1"></eq><apply id="S3.E6.m1.8.8.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.2"><times id="S3.E6.m1.8.8.1.1.2.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1"></times><apply id="S3.E6.m1.8.8.1.1.2.2.cmml" xref="S3.E6.m1.8.8.1.1.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.2.2.1.cmml" xref="S3.E6.m1.8.8.1.1.2.2">subscript</csymbol><apply id="S3.E6.m1.8.8.1.1.2.2.2.cmml" xref="S3.E6.m1.8.8.1.1.2.2.2"><ci id="S3.E6.m1.8.8.1.1.2.2.2.1.cmml" xref="S3.E6.m1.8.8.1.1.2.2.2.1">~</ci><ci id="S3.E6.m1.8.8.1.1.2.2.2.2.cmml" xref="S3.E6.m1.8.8.1.1.2.2.2.2">𝐴</ci></apply><ci id="S3.E6.m1.8.8.1.1.2.2.3.cmml" xref="S3.E6.m1.8.8.1.1.2.2.3">𝑖</ci></apply><interval closure="open" id="S3.E6.m1.8.8.1.1.2.3.1.cmml" xref="S3.E6.m1.8.8.1.1.2.3.2"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝑃</ci><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝑋</ci></interval></apply><apply id="S3.E6.m1.8.8.1.1.3.cmml" xref="S3.E6.m1.8.8.1.1.3"><plus id="S3.E6.m1.8.8.1.1.3.1.cmml" xref="S3.E6.m1.8.8.1.1.3.1"></plus><apply id="S3.E6.m1.8.8.1.1.3.2.cmml" xref="S3.E6.m1.8.8.1.1.3.2"><times id="S3.E6.m1.8.8.1.1.3.2.1.cmml" xref="S3.E6.m1.8.8.1.1.3.2.1"></times><ci id="S3.E6.m1.8.8.1.1.3.2.2.cmml" xref="S3.E6.m1.8.8.1.1.3.2.2">𝐴</ci><interval closure="open" id="S3.E6.m1.8.8.1.1.3.2.3.1.cmml" xref="S3.E6.m1.8.8.1.1.3.2.3.2"><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝑃</ci><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝑋</ci></interval></apply><apply id="S3.E6.m1.8.8.1.1.3.3.cmml" xref="S3.E6.m1.8.8.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.3.3.1.cmml" xref="S3.E6.m1.8.8.1.1.3.3">subscript</csymbol><apply id="S3.E6.m1.8.8.1.1.3.3.2.cmml" xref="S3.E6.m1.8.8.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.3.3.2.1.cmml" xref="S3.E6.m1.8.8.1.1.3.3">superscript</csymbol><apply id="S3.E6.m1.8.8.1.1.3.3.2.2.cmml" xref="S3.E6.m1.8.8.1.1.3.3.2.2"><ci id="S3.E6.m1.8.8.1.1.3.3.2.2.1.cmml" xref="S3.E6.m1.8.8.1.1.3.3.2.2.1">~</ci><ci id="S3.E6.m1.8.8.1.1.3.3.2.2.2.cmml" xref="S3.E6.m1.8.8.1.1.3.3.2.2.2">𝑚</ci></apply><ci id="S3.E6.m1.8.8.1.1.3.3.2.3.cmml" xref="S3.E6.m1.8.8.1.1.3.3.2.3">𝑝</ci></apply><ci id="S3.E6.m1.8.8.1.1.3.3.3.cmml" xref="S3.E6.m1.8.8.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E6.m1.9.9.2.2.cmml" xref="S3.E6.m1.9.9.2.2"><eq id="S3.E6.m1.9.9.2.2.2.cmml" xref="S3.E6.m1.9.9.2.2.2"></eq><ci id="S3.E6.m1.9.9.2.2.3.cmml" xref="S3.E6.m1.9.9.2.2.3">𝑖</ci><list id="S3.E6.m1.9.9.2.2.1.2.cmml" xref="S3.E6.m1.9.9.2.2.1.1"><cn id="S3.E6.m1.5.5.cmml" type="integer" xref="S3.E6.m1.5.5">1</cn><cn id="S3.E6.m1.6.6.cmml" type="integer" xref="S3.E6.m1.6.6">2</cn><ci id="S3.E6.m1.7.7.cmml" xref="S3.E6.m1.7.7">…</ci><apply id="S3.E6.m1.9.9.2.2.1.1.1.cmml" xref="S3.E6.m1.9.9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.9.9.2.2.1.1.1.1.cmml" xref="S3.E6.m1.9.9.2.2.1.1.1">subscript</csymbol><ci id="S3.E6.m1.9.9.2.2.1.1.1.2.cmml" xref="S3.E6.m1.9.9.2.2.1.1.1.2">𝑁</ci><ci id="S3.E6.m1.9.9.2.2.1.1.1.3.cmml" xref="S3.E6.m1.9.9.2.2.1.1.1.3">𝑝</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.9c">\widetilde{A}_{i}\left(P,X\right)=A\left(P,X\right)+\widetilde{m}^{p}_{i},i=1,%
2,...,N_{p}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.9d">over~ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_P , italic_X ) = italic_A ( italic_P , italic_X ) + over~ start_ARG italic_m end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_i = 1 , 2 , … , italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS2.p3.10">where <math alttext="P" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p3.3.m1.1"><semantics id="S3.SS4.SSS2.p3.3.m1.1a"><mi id="S3.SS4.SSS2.p3.3.m1.1.1" xref="S3.SS4.SSS2.p3.3.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p3.3.m1.1b"><ci id="S3.SS4.SSS2.p3.3.m1.1.1.cmml" xref="S3.SS4.SSS2.p3.3.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p3.3.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p3.3.m1.1d">italic_P</annotation></semantics></math> and <math alttext="X" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p3.4.m2.1"><semantics id="S3.SS4.SSS2.p3.4.m2.1a"><mi id="S3.SS4.SSS2.p3.4.m2.1.1" xref="S3.SS4.SSS2.p3.4.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p3.4.m2.1b"><ci id="S3.SS4.SSS2.p3.4.m2.1.1.cmml" xref="S3.SS4.SSS2.p3.4.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p3.4.m2.1c">X</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p3.4.m2.1d">italic_X</annotation></semantics></math> represent FG-prompts and image features, respectively. <math alttext="A\left(P,X\right)=\frac{\left(PW_{q}\right)\left(XW_{k}\right)^{T}}{\sqrt{d}}%
\in\mathbb{R}{{}^{N_{p}\times N_{l}}}" class="ltx_math_unparsed" display="inline" id="S3.SS4.SSS2.p3.5.m3.4"><semantics id="S3.SS4.SSS2.p3.5.m3.4a"><mrow id="S3.SS4.SSS2.p3.5.m3.4b"><mi id="S3.SS4.SSS2.p3.5.m3.4.5">A</mi><mrow id="S3.SS4.SSS2.p3.5.m3.4.6"><mo id="S3.SS4.SSS2.p3.5.m3.4.6.1">(</mo><mi id="S3.SS4.SSS2.p3.5.m3.3.3">P</mi><mo id="S3.SS4.SSS2.p3.5.m3.4.6.2">,</mo><mi id="S3.SS4.SSS2.p3.5.m3.4.4">X</mi><mo id="S3.SS4.SSS2.p3.5.m3.4.6.3">)</mo></mrow><mo id="S3.SS4.SSS2.p3.5.m3.4.7">=</mo><mfrac id="S3.SS4.SSS2.p3.5.m3.2.2"><mrow id="S3.SS4.SSS2.p3.5.m3.2.2.2"><mrow id="S3.SS4.SSS2.p3.5.m3.1.1.1.1.1"><mo id="S3.SS4.SSS2.p3.5.m3.1.1.1.1.1.2">(</mo><mrow id="S3.SS4.SSS2.p3.5.m3.1.1.1.1.1.1"><mi id="S3.SS4.SSS2.p3.5.m3.1.1.1.1.1.1.2">P</mi><mo id="S3.SS4.SSS2.p3.5.m3.1.1.1.1.1.1.1">⁢</mo><msub id="S3.SS4.SSS2.p3.5.m3.1.1.1.1.1.1.3"><mi id="S3.SS4.SSS2.p3.5.m3.1.1.1.1.1.1.3.2">W</mi><mi id="S3.SS4.SSS2.p3.5.m3.1.1.1.1.1.1.3.3">q</mi></msub></mrow><mo id="S3.SS4.SSS2.p3.5.m3.1.1.1.1.1.3">)</mo></mrow><mo id="S3.SS4.SSS2.p3.5.m3.2.2.2.3">⁢</mo><msup id="S3.SS4.SSS2.p3.5.m3.2.2.2.2"><mrow id="S3.SS4.SSS2.p3.5.m3.2.2.2.2.1.1"><mo id="S3.SS4.SSS2.p3.5.m3.2.2.2.2.1.1.2">(</mo><mrow id="S3.SS4.SSS2.p3.5.m3.2.2.2.2.1.1.1"><mi id="S3.SS4.SSS2.p3.5.m3.2.2.2.2.1.1.1.2">X</mi><mo id="S3.SS4.SSS2.p3.5.m3.2.2.2.2.1.1.1.1">⁢</mo><msub id="S3.SS4.SSS2.p3.5.m3.2.2.2.2.1.1.1.3"><mi id="S3.SS4.SSS2.p3.5.m3.2.2.2.2.1.1.1.3.2">W</mi><mi id="S3.SS4.SSS2.p3.5.m3.2.2.2.2.1.1.1.3.3">k</mi></msub></mrow><mo id="S3.SS4.SSS2.p3.5.m3.2.2.2.2.1.1.3">)</mo></mrow><mi id="S3.SS4.SSS2.p3.5.m3.2.2.2.2.3">T</mi></msup></mrow><msqrt id="S3.SS4.SSS2.p3.5.m3.2.2.4"><mi id="S3.SS4.SSS2.p3.5.m3.2.2.4.2">d</mi></msqrt></mfrac><mo id="S3.SS4.SSS2.p3.5.m3.4.8">∈</mo><mi id="S3.SS4.SSS2.p3.5.m3.4.9">ℝ</mi><msup id="S3.SS4.SSS2.p3.5.m3.4.10"><mi id="S3.SS4.SSS2.p3.5.m3.4.10a"></mi><mrow id="S3.SS4.SSS2.p3.5.m3.4.10.1"><msub id="S3.SS4.SSS2.p3.5.m3.4.10.1.2"><mi id="S3.SS4.SSS2.p3.5.m3.4.10.1.2.2">N</mi><mi id="S3.SS4.SSS2.p3.5.m3.4.10.1.2.3">p</mi></msub><mo id="S3.SS4.SSS2.p3.5.m3.4.10.1.1" lspace="0.222em" rspace="0.222em">×</mo><msub id="S3.SS4.SSS2.p3.5.m3.4.10.1.3"><mi id="S3.SS4.SSS2.p3.5.m3.4.10.1.3.2">N</mi><mi id="S3.SS4.SSS2.p3.5.m3.4.10.1.3.3">l</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p3.5.m3.4c">A\left(P,X\right)=\frac{\left(PW_{q}\right)\left(XW_{k}\right)^{T}}{\sqrt{d}}%
\in\mathbb{R}{{}^{N_{p}\times N_{l}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p3.5.m3.4d">italic_A ( italic_P , italic_X ) = divide start_ARG ( italic_P italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) ( italic_X italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ∈ blackboard_R start_FLOATSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT × italic_N start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_FLOATSUPERSCRIPT</annotation></semantics></math> denotes the original attention weight (<math alttext="W_{q}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p3.6.m4.1"><semantics id="S3.SS4.SSS2.p3.6.m4.1a"><msub id="S3.SS4.SSS2.p3.6.m4.1.1" xref="S3.SS4.SSS2.p3.6.m4.1.1.cmml"><mi id="S3.SS4.SSS2.p3.6.m4.1.1.2" xref="S3.SS4.SSS2.p3.6.m4.1.1.2.cmml">W</mi><mi id="S3.SS4.SSS2.p3.6.m4.1.1.3" xref="S3.SS4.SSS2.p3.6.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p3.6.m4.1b"><apply id="S3.SS4.SSS2.p3.6.m4.1.1.cmml" xref="S3.SS4.SSS2.p3.6.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p3.6.m4.1.1.1.cmml" xref="S3.SS4.SSS2.p3.6.m4.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p3.6.m4.1.1.2.cmml" xref="S3.SS4.SSS2.p3.6.m4.1.1.2">𝑊</ci><ci id="S3.SS4.SSS2.p3.6.m4.1.1.3.cmml" xref="S3.SS4.SSS2.p3.6.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p3.6.m4.1c">W_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p3.6.m4.1d">italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="W_{k}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p3.7.m5.1"><semantics id="S3.SS4.SSS2.p3.7.m5.1a"><msub id="S3.SS4.SSS2.p3.7.m5.1.1" xref="S3.SS4.SSS2.p3.7.m5.1.1.cmml"><mi id="S3.SS4.SSS2.p3.7.m5.1.1.2" xref="S3.SS4.SSS2.p3.7.m5.1.1.2.cmml">W</mi><mi id="S3.SS4.SSS2.p3.7.m5.1.1.3" xref="S3.SS4.SSS2.p3.7.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p3.7.m5.1b"><apply id="S3.SS4.SSS2.p3.7.m5.1.1.cmml" xref="S3.SS4.SSS2.p3.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p3.7.m5.1.1.1.cmml" xref="S3.SS4.SSS2.p3.7.m5.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p3.7.m5.1.1.2.cmml" xref="S3.SS4.SSS2.p3.7.m5.1.1.2">𝑊</ci><ci id="S3.SS4.SSS2.p3.7.m5.1.1.3.cmml" xref="S3.SS4.SSS2.p3.7.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p3.7.m5.1c">W_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p3.7.m5.1d">italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> denote the projection weights). Notably, <math alttext="\widetilde{A}_{i}\left(P,X\right)\in\mathbb{R}{{}^{1\times N_{l}}}" class="ltx_math_unparsed" display="inline" id="S3.SS4.SSS2.p3.8.m6.2"><semantics id="S3.SS4.SSS2.p3.8.m6.2a"><mrow id="S3.SS4.SSS2.p3.8.m6.2b"><msub id="S3.SS4.SSS2.p3.8.m6.2.3"><mover accent="true" id="S3.SS4.SSS2.p3.8.m6.2.3.2"><mi id="S3.SS4.SSS2.p3.8.m6.2.3.2.2">A</mi><mo id="S3.SS4.SSS2.p3.8.m6.2.3.2.1">~</mo></mover><mi id="S3.SS4.SSS2.p3.8.m6.2.3.3">i</mi></msub><mrow id="S3.SS4.SSS2.p3.8.m6.2.4"><mo id="S3.SS4.SSS2.p3.8.m6.2.4.1">(</mo><mi id="S3.SS4.SSS2.p3.8.m6.1.1">P</mi><mo id="S3.SS4.SSS2.p3.8.m6.2.4.2">,</mo><mi id="S3.SS4.SSS2.p3.8.m6.2.2">X</mi><mo id="S3.SS4.SSS2.p3.8.m6.2.4.3">)</mo></mrow><mo id="S3.SS4.SSS2.p3.8.m6.2.5">∈</mo><mi id="S3.SS4.SSS2.p3.8.m6.2.6">ℝ</mi><msup id="S3.SS4.SSS2.p3.8.m6.2.7"><mi id="S3.SS4.SSS2.p3.8.m6.2.7a"></mi><mrow id="S3.SS4.SSS2.p3.8.m6.2.7.1"><mn id="S3.SS4.SSS2.p3.8.m6.2.7.1.2">1</mn><mo id="S3.SS4.SSS2.p3.8.m6.2.7.1.1" lspace="0.222em" rspace="0.222em">×</mo><msub id="S3.SS4.SSS2.p3.8.m6.2.7.1.3"><mi id="S3.SS4.SSS2.p3.8.m6.2.7.1.3.2">N</mi><mi id="S3.SS4.SSS2.p3.8.m6.2.7.1.3.3">l</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p3.8.m6.2c">\widetilde{A}_{i}\left(P,X\right)\in\mathbb{R}{{}^{1\times N_{l}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p3.8.m6.2d">over~ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_P , italic_X ) ∈ blackboard_R start_FLOATSUPERSCRIPT 1 × italic_N start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_FLOATSUPERSCRIPT</annotation></semantics></math> focuses only on the region of <math alttext="i^{th}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p3.9.m7.1"><semantics id="S3.SS4.SSS2.p3.9.m7.1a"><msup id="S3.SS4.SSS2.p3.9.m7.1.1" xref="S3.SS4.SSS2.p3.9.m7.1.1.cmml"><mi id="S3.SS4.SSS2.p3.9.m7.1.1.2" xref="S3.SS4.SSS2.p3.9.m7.1.1.2.cmml">i</mi><mrow id="S3.SS4.SSS2.p3.9.m7.1.1.3" xref="S3.SS4.SSS2.p3.9.m7.1.1.3.cmml"><mi id="S3.SS4.SSS2.p3.9.m7.1.1.3.2" xref="S3.SS4.SSS2.p3.9.m7.1.1.3.2.cmml">t</mi><mo id="S3.SS4.SSS2.p3.9.m7.1.1.3.1" xref="S3.SS4.SSS2.p3.9.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.SSS2.p3.9.m7.1.1.3.3" xref="S3.SS4.SSS2.p3.9.m7.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p3.9.m7.1b"><apply id="S3.SS4.SSS2.p3.9.m7.1.1.cmml" xref="S3.SS4.SSS2.p3.9.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p3.9.m7.1.1.1.cmml" xref="S3.SS4.SSS2.p3.9.m7.1.1">superscript</csymbol><ci id="S3.SS4.SSS2.p3.9.m7.1.1.2.cmml" xref="S3.SS4.SSS2.p3.9.m7.1.1.2">𝑖</ci><apply id="S3.SS4.SSS2.p3.9.m7.1.1.3.cmml" xref="S3.SS4.SSS2.p3.9.m7.1.1.3"><times id="S3.SS4.SSS2.p3.9.m7.1.1.3.1.cmml" xref="S3.SS4.SSS2.p3.9.m7.1.1.3.1"></times><ci id="S3.SS4.SSS2.p3.9.m7.1.1.3.2.cmml" xref="S3.SS4.SSS2.p3.9.m7.1.1.3.2">𝑡</ci><ci id="S3.SS4.SSS2.p3.9.m7.1.1.3.3.cmml" xref="S3.SS4.SSS2.p3.9.m7.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p3.9.m7.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p3.9.m7.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> part mask <math alttext="m^{p}_{i}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p3.10.m8.1"><semantics id="S3.SS4.SSS2.p3.10.m8.1a"><msubsup id="S3.SS4.SSS2.p3.10.m8.1.1" xref="S3.SS4.SSS2.p3.10.m8.1.1.cmml"><mi id="S3.SS4.SSS2.p3.10.m8.1.1.2.2" xref="S3.SS4.SSS2.p3.10.m8.1.1.2.2.cmml">m</mi><mi id="S3.SS4.SSS2.p3.10.m8.1.1.3" xref="S3.SS4.SSS2.p3.10.m8.1.1.3.cmml">i</mi><mi id="S3.SS4.SSS2.p3.10.m8.1.1.2.3" xref="S3.SS4.SSS2.p3.10.m8.1.1.2.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p3.10.m8.1b"><apply id="S3.SS4.SSS2.p3.10.m8.1.1.cmml" xref="S3.SS4.SSS2.p3.10.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p3.10.m8.1.1.1.cmml" xref="S3.SS4.SSS2.p3.10.m8.1.1">subscript</csymbol><apply id="S3.SS4.SSS2.p3.10.m8.1.1.2.cmml" xref="S3.SS4.SSS2.p3.10.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p3.10.m8.1.1.2.1.cmml" xref="S3.SS4.SSS2.p3.10.m8.1.1">superscript</csymbol><ci id="S3.SS4.SSS2.p3.10.m8.1.1.2.2.cmml" xref="S3.SS4.SSS2.p3.10.m8.1.1.2.2">𝑚</ci><ci id="S3.SS4.SSS2.p3.10.m8.1.1.2.3.cmml" xref="S3.SS4.SSS2.p3.10.m8.1.1.2.3">𝑝</ci></apply><ci id="S3.SS4.SSS2.p3.10.m8.1.1.3.cmml" xref="S3.SS4.SSS2.p3.10.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p3.10.m8.1c">m^{p}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p3.10.m8.1d">italic_m start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="S3.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="457" id="S3.F6.g1" src="extracted/5858111/Figure/Semantic_Prompt_Migrator.jpg" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>The specific process of the Semantic Prompt Transfer (SPT). Notably, for the BG-Prompt Enhancement, just adjusting the background mask fed into the SPT without the PMG.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS2.p4">
<p class="ltx_p" id="S3.SS4.SSS2.p4.3">2) To avoid preferring the few most discriminative pixels while neglecting other valuable pixel semantics in the specific mask, Gaussian suppression <math alttext="\mathcal{F}_{G}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p4.1.m1.1"><semantics id="S3.SS4.SSS2.p4.1.m1.1a"><msub id="S3.SS4.SSS2.p4.1.m1.1.1" xref="S3.SS4.SSS2.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p4.1.m1.1.1.2" xref="S3.SS4.SSS2.p4.1.m1.1.1.2.cmml">ℱ</mi><mi id="S3.SS4.SSS2.p4.1.m1.1.1.3" xref="S3.SS4.SSS2.p4.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p4.1.m1.1b"><apply id="S3.SS4.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS4.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p4.1.m1.1.1.1.cmml" xref="S3.SS4.SSS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p4.1.m1.1.1.2.cmml" xref="S3.SS4.SSS2.p4.1.m1.1.1.2">ℱ</ci><ci id="S3.SS4.SSS2.p4.1.m1.1.1.3.cmml" xref="S3.SS4.SSS2.p4.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p4.1.m1.1c">\mathcal{F}_{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p4.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math> is constructed to further adjust the attention distribution. Particularly, we select the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p4.2.m2.1"><semantics id="S3.SS4.SSS2.p4.2.m2.1a"><mi id="S3.SS4.SSS2.p4.2.m2.1.1" xref="S3.SS4.SSS2.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p4.2.m2.1b"><ci id="S3.SS4.SSS2.p4.2.m2.1.1.cmml" xref="S3.SS4.SSS2.p4.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p4.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p4.2.m2.1d">italic_K</annotation></semantics></math> pixels with the highest scores as the discriminative pixels and construct the distance metric between these pixels and the surrounding neighboring pixels via the Gaussian kernel function. On this basis, a weighted aggregation of neighboring pixels replaces the original center pixel scores to suppress discriminative regions in the distribution, thus allowing the attention to expand to neighboring regions. Such a gentle manner is effective in enabling global semantic migration to aggregate richer class-specific semantics to prompts. At this time, the attention weight <math alttext="\widetilde{A}_{i}\left(P,X\right)" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p4.3.m3.2"><semantics id="S3.SS4.SSS2.p4.3.m3.2a"><mrow id="S3.SS4.SSS2.p4.3.m3.2.3" xref="S3.SS4.SSS2.p4.3.m3.2.3.cmml"><msub id="S3.SS4.SSS2.p4.3.m3.2.3.2" xref="S3.SS4.SSS2.p4.3.m3.2.3.2.cmml"><mover accent="true" id="S3.SS4.SSS2.p4.3.m3.2.3.2.2" xref="S3.SS4.SSS2.p4.3.m3.2.3.2.2.cmml"><mi id="S3.SS4.SSS2.p4.3.m3.2.3.2.2.2" xref="S3.SS4.SSS2.p4.3.m3.2.3.2.2.2.cmml">A</mi><mo id="S3.SS4.SSS2.p4.3.m3.2.3.2.2.1" xref="S3.SS4.SSS2.p4.3.m3.2.3.2.2.1.cmml">~</mo></mover><mi id="S3.SS4.SSS2.p4.3.m3.2.3.2.3" xref="S3.SS4.SSS2.p4.3.m3.2.3.2.3.cmml">i</mi></msub><mo id="S3.SS4.SSS2.p4.3.m3.2.3.1" xref="S3.SS4.SSS2.p4.3.m3.2.3.1.cmml">⁢</mo><mrow id="S3.SS4.SSS2.p4.3.m3.2.3.3.2" xref="S3.SS4.SSS2.p4.3.m3.2.3.3.1.cmml"><mo id="S3.SS4.SSS2.p4.3.m3.2.3.3.2.1" xref="S3.SS4.SSS2.p4.3.m3.2.3.3.1.cmml">(</mo><mi id="S3.SS4.SSS2.p4.3.m3.1.1" xref="S3.SS4.SSS2.p4.3.m3.1.1.cmml">P</mi><mo id="S3.SS4.SSS2.p4.3.m3.2.3.3.2.2" xref="S3.SS4.SSS2.p4.3.m3.2.3.3.1.cmml">,</mo><mi id="S3.SS4.SSS2.p4.3.m3.2.2" xref="S3.SS4.SSS2.p4.3.m3.2.2.cmml">X</mi><mo id="S3.SS4.SSS2.p4.3.m3.2.3.3.2.3" xref="S3.SS4.SSS2.p4.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p4.3.m3.2b"><apply id="S3.SS4.SSS2.p4.3.m3.2.3.cmml" xref="S3.SS4.SSS2.p4.3.m3.2.3"><times id="S3.SS4.SSS2.p4.3.m3.2.3.1.cmml" xref="S3.SS4.SSS2.p4.3.m3.2.3.1"></times><apply id="S3.SS4.SSS2.p4.3.m3.2.3.2.cmml" xref="S3.SS4.SSS2.p4.3.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p4.3.m3.2.3.2.1.cmml" xref="S3.SS4.SSS2.p4.3.m3.2.3.2">subscript</csymbol><apply id="S3.SS4.SSS2.p4.3.m3.2.3.2.2.cmml" xref="S3.SS4.SSS2.p4.3.m3.2.3.2.2"><ci id="S3.SS4.SSS2.p4.3.m3.2.3.2.2.1.cmml" xref="S3.SS4.SSS2.p4.3.m3.2.3.2.2.1">~</ci><ci id="S3.SS4.SSS2.p4.3.m3.2.3.2.2.2.cmml" xref="S3.SS4.SSS2.p4.3.m3.2.3.2.2.2">𝐴</ci></apply><ci id="S3.SS4.SSS2.p4.3.m3.2.3.2.3.cmml" xref="S3.SS4.SSS2.p4.3.m3.2.3.2.3">𝑖</ci></apply><interval closure="open" id="S3.SS4.SSS2.p4.3.m3.2.3.3.1.cmml" xref="S3.SS4.SSS2.p4.3.m3.2.3.3.2"><ci id="S3.SS4.SSS2.p4.3.m3.1.1.cmml" xref="S3.SS4.SSS2.p4.3.m3.1.1">𝑃</ci><ci id="S3.SS4.SSS2.p4.3.m3.2.2.cmml" xref="S3.SS4.SSS2.p4.3.m3.2.2">𝑋</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p4.3.m3.2c">\widetilde{A}_{i}\left(P,X\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p4.3.m3.2d">over~ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_P , italic_X )</annotation></semantics></math> can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widetilde{A}_{i(u,v)}=\sum_{m,n\in\Upsilon}\mathcal{G}_{m,n}(\widetilde{A}_{i%
(u-m,v-n)}),\ s.t.\ \underset{u,v}{TopK}(\widetilde{A}_{i})" class="ltx_Math" display="block" id="S3.E7.m1.14"><semantics id="S3.E7.m1.14a"><mrow id="S3.E7.m1.14.14.2" xref="S3.E7.m1.14.14.3.cmml"><mrow id="S3.E7.m1.13.13.1.1" xref="S3.E7.m1.13.13.1.1.cmml"><msub id="S3.E7.m1.13.13.1.1.3" xref="S3.E7.m1.13.13.1.1.3.cmml"><mover accent="true" id="S3.E7.m1.13.13.1.1.3.2" xref="S3.E7.m1.13.13.1.1.3.2.cmml"><mi id="S3.E7.m1.13.13.1.1.3.2.2" xref="S3.E7.m1.13.13.1.1.3.2.2.cmml">A</mi><mo id="S3.E7.m1.13.13.1.1.3.2.1" xref="S3.E7.m1.13.13.1.1.3.2.1.cmml">~</mo></mover><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.4" xref="S3.E7.m1.2.2.2.4.cmml">i</mi><mo id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.2.5.2" xref="S3.E7.m1.2.2.2.5.1.cmml"><mo id="S3.E7.m1.2.2.2.5.2.1" stretchy="false" xref="S3.E7.m1.2.2.2.5.1.cmml">(</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">u</mi><mo id="S3.E7.m1.2.2.2.5.2.2" xref="S3.E7.m1.2.2.2.5.1.cmml">,</mo><mi id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">v</mi><mo id="S3.E7.m1.2.2.2.5.2.3" stretchy="false" xref="S3.E7.m1.2.2.2.5.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E7.m1.13.13.1.1.2" rspace="0.111em" xref="S3.E7.m1.13.13.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.13.13.1.1.1.1" xref="S3.E7.m1.13.13.1.1.1.2.cmml"><mrow id="S3.E7.m1.13.13.1.1.1.1.1" xref="S3.E7.m1.13.13.1.1.1.1.1.cmml"><munder id="S3.E7.m1.13.13.1.1.1.1.1.2" xref="S3.E7.m1.13.13.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.13.13.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E7.m1.13.13.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.4.4.2" xref="S3.E7.m1.4.4.2.cmml"><mrow id="S3.E7.m1.4.4.2.4.2" xref="S3.E7.m1.4.4.2.4.1.cmml"><mi id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml">m</mi><mo id="S3.E7.m1.4.4.2.4.2.1" xref="S3.E7.m1.4.4.2.4.1.cmml">,</mo><mi id="S3.E7.m1.4.4.2.2" xref="S3.E7.m1.4.4.2.2.cmml">n</mi></mrow><mo id="S3.E7.m1.4.4.2.3" xref="S3.E7.m1.4.4.2.3.cmml">∈</mo><mi id="S3.E7.m1.4.4.2.5" mathvariant="normal" xref="S3.E7.m1.4.4.2.5.cmml">Υ</mi></mrow></munder><mrow id="S3.E7.m1.13.13.1.1.1.1.1.1" xref="S3.E7.m1.13.13.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.13.13.1.1.1.1.1.1.3" xref="S3.E7.m1.13.13.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.13.13.1.1.1.1.1.1.3.2" xref="S3.E7.m1.13.13.1.1.1.1.1.1.3.2.cmml">𝒢</mi><mrow id="S3.E7.m1.6.6.2.4" xref="S3.E7.m1.6.6.2.3.cmml"><mi id="S3.E7.m1.5.5.1.1" xref="S3.E7.m1.5.5.1.1.cmml">m</mi><mo id="S3.E7.m1.6.6.2.4.1" xref="S3.E7.m1.6.6.2.3.cmml">,</mo><mi id="S3.E7.m1.6.6.2.2" xref="S3.E7.m1.6.6.2.2.cmml">n</mi></mrow></msub><mo id="S3.E7.m1.13.13.1.1.1.1.1.1.2" xref="S3.E7.m1.13.13.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2.2.cmml">A</mi><mo id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mrow id="S3.E7.m1.8.8.2" xref="S3.E7.m1.8.8.2.cmml"><mi id="S3.E7.m1.8.8.2.4" xref="S3.E7.m1.8.8.2.4.cmml">i</mi><mo id="S3.E7.m1.8.8.2.3" xref="S3.E7.m1.8.8.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.8.8.2.2.2" xref="S3.E7.m1.8.8.2.2.3.cmml"><mo id="S3.E7.m1.8.8.2.2.2.3" stretchy="false" xref="S3.E7.m1.8.8.2.2.3.cmml">(</mo><mrow id="S3.E7.m1.7.7.1.1.1.1" xref="S3.E7.m1.7.7.1.1.1.1.cmml"><mi id="S3.E7.m1.7.7.1.1.1.1.2" xref="S3.E7.m1.7.7.1.1.1.1.2.cmml">u</mi><mo id="S3.E7.m1.7.7.1.1.1.1.1" xref="S3.E7.m1.7.7.1.1.1.1.1.cmml">−</mo><mi id="S3.E7.m1.7.7.1.1.1.1.3" xref="S3.E7.m1.7.7.1.1.1.1.3.cmml">m</mi></mrow><mo id="S3.E7.m1.8.8.2.2.2.4" xref="S3.E7.m1.8.8.2.2.3.cmml">,</mo><mrow id="S3.E7.m1.8.8.2.2.2.2" xref="S3.E7.m1.8.8.2.2.2.2.cmml"><mi id="S3.E7.m1.8.8.2.2.2.2.2" xref="S3.E7.m1.8.8.2.2.2.2.2.cmml">v</mi><mo id="S3.E7.m1.8.8.2.2.2.2.1" xref="S3.E7.m1.8.8.2.2.2.2.1.cmml">−</mo><mi id="S3.E7.m1.8.8.2.2.2.2.3" xref="S3.E7.m1.8.8.2.2.2.2.3.cmml">n</mi></mrow><mo id="S3.E7.m1.8.8.2.2.2.5" stretchy="false" xref="S3.E7.m1.8.8.2.2.3.cmml">)</mo></mrow></mrow></msub><mo id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.13.13.1.1.1.1.2" rspace="0.667em" xref="S3.E7.m1.13.13.1.1.1.2.cmml">,</mo><mi id="S3.E7.m1.11.11" xref="S3.E7.m1.11.11.cmml">s</mi></mrow></mrow><mo id="S3.E7.m1.14.14.2.3" lspace="0em" rspace="0.167em" xref="S3.E7.m1.14.14.3a.cmml">.</mo><mi id="S3.E7.m1.12.12" xref="S3.E7.m1.12.12.cmml">t</mi><mo id="S3.E7.m1.14.14.2.4" lspace="0em" rspace="0.667em" xref="S3.E7.m1.14.14.3a.cmml">.</mo><mrow id="S3.E7.m1.14.14.2.2" xref="S3.E7.m1.14.14.2.2.cmml"><munder accentunder="true" id="S3.E7.m1.10.10" xref="S3.E7.m1.10.10.cmml"><mrow id="S3.E7.m1.10.10.3" xref="S3.E7.m1.10.10.3.cmml"><mi id="S3.E7.m1.10.10.3.2" xref="S3.E7.m1.10.10.3.2.cmml">T</mi><mo id="S3.E7.m1.10.10.3.1" xref="S3.E7.m1.10.10.3.1.cmml">⁢</mo><mi id="S3.E7.m1.10.10.3.3" xref="S3.E7.m1.10.10.3.3.cmml">o</mi><mo id="S3.E7.m1.10.10.3.1a" xref="S3.E7.m1.10.10.3.1.cmml">⁢</mo><mi id="S3.E7.m1.10.10.3.4" xref="S3.E7.m1.10.10.3.4.cmml">p</mi><mo id="S3.E7.m1.10.10.3.1b" xref="S3.E7.m1.10.10.3.1.cmml">⁢</mo><mi id="S3.E7.m1.10.10.3.5" xref="S3.E7.m1.10.10.3.5.cmml">K</mi></mrow><mrow id="S3.E7.m1.10.10.2.4" xref="S3.E7.m1.10.10.2.3.cmml"><mi id="S3.E7.m1.9.9.1.1" xref="S3.E7.m1.9.9.1.1.cmml">u</mi><mo id="S3.E7.m1.10.10.2.4.1" xref="S3.E7.m1.10.10.2.3.cmml">,</mo><mi id="S3.E7.m1.10.10.2.2" xref="S3.E7.m1.10.10.2.2.cmml">v</mi></mrow></munder><mo id="S3.E7.m1.14.14.2.2.2" xref="S3.E7.m1.14.14.2.2.2.cmml">⁢</mo><mrow id="S3.E7.m1.14.14.2.2.1.1" xref="S3.E7.m1.14.14.2.2.1.1.1.cmml"><mo id="S3.E7.m1.14.14.2.2.1.1.2" stretchy="false" xref="S3.E7.m1.14.14.2.2.1.1.1.cmml">(</mo><msub id="S3.E7.m1.14.14.2.2.1.1.1" xref="S3.E7.m1.14.14.2.2.1.1.1.cmml"><mover accent="true" id="S3.E7.m1.14.14.2.2.1.1.1.2" xref="S3.E7.m1.14.14.2.2.1.1.1.2.cmml"><mi id="S3.E7.m1.14.14.2.2.1.1.1.2.2" xref="S3.E7.m1.14.14.2.2.1.1.1.2.2.cmml">A</mi><mo id="S3.E7.m1.14.14.2.2.1.1.1.2.1" xref="S3.E7.m1.14.14.2.2.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E7.m1.14.14.2.2.1.1.1.3" xref="S3.E7.m1.14.14.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m1.14.14.2.2.1.1.3" stretchy="false" xref="S3.E7.m1.14.14.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.14b"><apply id="S3.E7.m1.14.14.3.cmml" xref="S3.E7.m1.14.14.2"><csymbol cd="ambiguous" id="S3.E7.m1.14.14.3a.cmml" xref="S3.E7.m1.14.14.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.13.13.1.1.cmml" xref="S3.E7.m1.13.13.1.1"><eq id="S3.E7.m1.13.13.1.1.2.cmml" xref="S3.E7.m1.13.13.1.1.2"></eq><apply id="S3.E7.m1.13.13.1.1.3.cmml" xref="S3.E7.m1.13.13.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.13.13.1.1.3.1.cmml" xref="S3.E7.m1.13.13.1.1.3">subscript</csymbol><apply id="S3.E7.m1.13.13.1.1.3.2.cmml" xref="S3.E7.m1.13.13.1.1.3.2"><ci id="S3.E7.m1.13.13.1.1.3.2.1.cmml" xref="S3.E7.m1.13.13.1.1.3.2.1">~</ci><ci id="S3.E7.m1.13.13.1.1.3.2.2.cmml" xref="S3.E7.m1.13.13.1.1.3.2.2">𝐴</ci></apply><apply id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2.2"><times id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.3"></times><ci id="S3.E7.m1.2.2.2.4.cmml" xref="S3.E7.m1.2.2.2.4">𝑖</ci><interval closure="open" id="S3.E7.m1.2.2.2.5.1.cmml" xref="S3.E7.m1.2.2.2.5.2"><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑢</ci><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">𝑣</ci></interval></apply></apply><list id="S3.E7.m1.13.13.1.1.1.2.cmml" xref="S3.E7.m1.13.13.1.1.1.1"><apply id="S3.E7.m1.13.13.1.1.1.1.1.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1"><apply id="S3.E7.m1.13.13.1.1.1.1.1.2.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.13.13.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.13.13.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.2.2"></sum><apply id="S3.E7.m1.4.4.2.cmml" xref="S3.E7.m1.4.4.2"><in id="S3.E7.m1.4.4.2.3.cmml" xref="S3.E7.m1.4.4.2.3"></in><list id="S3.E7.m1.4.4.2.4.1.cmml" xref="S3.E7.m1.4.4.2.4.2"><ci id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1">𝑚</ci><ci id="S3.E7.m1.4.4.2.2.cmml" xref="S3.E7.m1.4.4.2.2">𝑛</ci></list><ci id="S3.E7.m1.4.4.2.5.cmml" xref="S3.E7.m1.4.4.2.5">Υ</ci></apply></apply><apply id="S3.E7.m1.13.13.1.1.1.1.1.1.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.1"><times id="S3.E7.m1.13.13.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.1.2"></times><apply id="S3.E7.m1.13.13.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.13.13.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.13.13.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.1.3.2">𝒢</ci><list id="S3.E7.m1.6.6.2.3.cmml" xref="S3.E7.m1.6.6.2.4"><ci id="S3.E7.m1.5.5.1.1.cmml" xref="S3.E7.m1.5.5.1.1">𝑚</ci><ci id="S3.E7.m1.6.6.2.2.cmml" xref="S3.E7.m1.6.6.2.2">𝑛</ci></list></apply><apply id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.13.13.1.1.1.1.1.1.1.1.1.2.2">𝐴</ci></apply><apply id="S3.E7.m1.8.8.2.cmml" xref="S3.E7.m1.8.8.2"><times id="S3.E7.m1.8.8.2.3.cmml" xref="S3.E7.m1.8.8.2.3"></times><ci id="S3.E7.m1.8.8.2.4.cmml" xref="S3.E7.m1.8.8.2.4">𝑖</ci><interval closure="open" id="S3.E7.m1.8.8.2.2.3.cmml" xref="S3.E7.m1.8.8.2.2.2"><apply id="S3.E7.m1.7.7.1.1.1.1.cmml" xref="S3.E7.m1.7.7.1.1.1.1"><minus id="S3.E7.m1.7.7.1.1.1.1.1.cmml" xref="S3.E7.m1.7.7.1.1.1.1.1"></minus><ci id="S3.E7.m1.7.7.1.1.1.1.2.cmml" xref="S3.E7.m1.7.7.1.1.1.1.2">𝑢</ci><ci id="S3.E7.m1.7.7.1.1.1.1.3.cmml" xref="S3.E7.m1.7.7.1.1.1.1.3">𝑚</ci></apply><apply id="S3.E7.m1.8.8.2.2.2.2.cmml" xref="S3.E7.m1.8.8.2.2.2.2"><minus id="S3.E7.m1.8.8.2.2.2.2.1.cmml" xref="S3.E7.m1.8.8.2.2.2.2.1"></minus><ci id="S3.E7.m1.8.8.2.2.2.2.2.cmml" xref="S3.E7.m1.8.8.2.2.2.2.2">𝑣</ci><ci id="S3.E7.m1.8.8.2.2.2.2.3.cmml" xref="S3.E7.m1.8.8.2.2.2.2.3">𝑛</ci></apply></interval></apply></apply></apply></apply><ci id="S3.E7.m1.11.11.cmml" xref="S3.E7.m1.11.11">𝑠</ci></list></apply><ci id="S3.E7.m1.12.12.cmml" xref="S3.E7.m1.12.12">𝑡</ci><apply id="S3.E7.m1.14.14.2.2.cmml" xref="S3.E7.m1.14.14.2.2"><times id="S3.E7.m1.14.14.2.2.2.cmml" xref="S3.E7.m1.14.14.2.2.2"></times><apply id="S3.E7.m1.10.10.cmml" xref="S3.E7.m1.10.10"><list id="S3.E7.m1.10.10.2.3.cmml" xref="S3.E7.m1.10.10.2.4"><ci id="S3.E7.m1.9.9.1.1.cmml" xref="S3.E7.m1.9.9.1.1">𝑢</ci><ci id="S3.E7.m1.10.10.2.2.cmml" xref="S3.E7.m1.10.10.2.2">𝑣</ci></list><apply id="S3.E7.m1.10.10.3.cmml" xref="S3.E7.m1.10.10.3"><times id="S3.E7.m1.10.10.3.1.cmml" xref="S3.E7.m1.10.10.3.1"></times><ci id="S3.E7.m1.10.10.3.2.cmml" xref="S3.E7.m1.10.10.3.2">𝑇</ci><ci id="S3.E7.m1.10.10.3.3.cmml" xref="S3.E7.m1.10.10.3.3">𝑜</ci><ci id="S3.E7.m1.10.10.3.4.cmml" xref="S3.E7.m1.10.10.3.4">𝑝</ci><ci id="S3.E7.m1.10.10.3.5.cmml" xref="S3.E7.m1.10.10.3.5">𝐾</ci></apply></apply><apply id="S3.E7.m1.14.14.2.2.1.1.1.cmml" xref="S3.E7.m1.14.14.2.2.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.14.14.2.2.1.1.1.1.cmml" xref="S3.E7.m1.14.14.2.2.1.1">subscript</csymbol><apply id="S3.E7.m1.14.14.2.2.1.1.1.2.cmml" xref="S3.E7.m1.14.14.2.2.1.1.1.2"><ci id="S3.E7.m1.14.14.2.2.1.1.1.2.1.cmml" xref="S3.E7.m1.14.14.2.2.1.1.1.2.1">~</ci><ci id="S3.E7.m1.14.14.2.2.1.1.1.2.2.cmml" xref="S3.E7.m1.14.14.2.2.1.1.1.2.2">𝐴</ci></apply><ci id="S3.E7.m1.14.14.2.2.1.1.1.3.cmml" xref="S3.E7.m1.14.14.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.14c">\widetilde{A}_{i(u,v)}=\sum_{m,n\in\Upsilon}\mathcal{G}_{m,n}(\widetilde{A}_{i%
(u-m,v-n)}),\ s.t.\ \underset{u,v}{TopK}(\widetilde{A}_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.14d">over~ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i ( italic_u , italic_v ) end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_m , italic_n ∈ roman_Υ end_POSTSUBSCRIPT caligraphic_G start_POSTSUBSCRIPT italic_m , italic_n end_POSTSUBSCRIPT ( over~ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i ( italic_u - italic_m , italic_v - italic_n ) end_POSTSUBSCRIPT ) , italic_s . italic_t . start_UNDERACCENT italic_u , italic_v end_UNDERACCENT start_ARG italic_T italic_o italic_p italic_K end_ARG ( over~ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS2.p4.7">where <math alttext="(u,v)" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p4.4.m1.2"><semantics id="S3.SS4.SSS2.p4.4.m1.2a"><mrow id="S3.SS4.SSS2.p4.4.m1.2.3.2" xref="S3.SS4.SSS2.p4.4.m1.2.3.1.cmml"><mo id="S3.SS4.SSS2.p4.4.m1.2.3.2.1" stretchy="false" xref="S3.SS4.SSS2.p4.4.m1.2.3.1.cmml">(</mo><mi id="S3.SS4.SSS2.p4.4.m1.1.1" xref="S3.SS4.SSS2.p4.4.m1.1.1.cmml">u</mi><mo id="S3.SS4.SSS2.p4.4.m1.2.3.2.2" xref="S3.SS4.SSS2.p4.4.m1.2.3.1.cmml">,</mo><mi id="S3.SS4.SSS2.p4.4.m1.2.2" xref="S3.SS4.SSS2.p4.4.m1.2.2.cmml">v</mi><mo id="S3.SS4.SSS2.p4.4.m1.2.3.2.3" stretchy="false" xref="S3.SS4.SSS2.p4.4.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p4.4.m1.2b"><interval closure="open" id="S3.SS4.SSS2.p4.4.m1.2.3.1.cmml" xref="S3.SS4.SSS2.p4.4.m1.2.3.2"><ci id="S3.SS4.SSS2.p4.4.m1.1.1.cmml" xref="S3.SS4.SSS2.p4.4.m1.1.1">𝑢</ci><ci id="S3.SS4.SSS2.p4.4.m1.2.2.cmml" xref="S3.SS4.SSS2.p4.4.m1.2.2">𝑣</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p4.4.m1.2c">(u,v)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p4.4.m1.2d">( italic_u , italic_v )</annotation></semantics></math> denotes the coordinates of top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p4.5.m2.1"><semantics id="S3.SS4.SSS2.p4.5.m2.1a"><mi id="S3.SS4.SSS2.p4.5.m2.1.1" xref="S3.SS4.SSS2.p4.5.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p4.5.m2.1b"><ci id="S3.SS4.SSS2.p4.5.m2.1.1.cmml" xref="S3.SS4.SSS2.p4.5.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p4.5.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p4.5.m2.1d">italic_K</annotation></semantics></math> (i.e., set to 15) discriminative pixels, <math alttext="\Upsilon\in[-5,5]" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p4.6.m3.2"><semantics id="S3.SS4.SSS2.p4.6.m3.2a"><mrow id="S3.SS4.SSS2.p4.6.m3.2.2" xref="S3.SS4.SSS2.p4.6.m3.2.2.cmml"><mi id="S3.SS4.SSS2.p4.6.m3.2.2.3" mathvariant="normal" xref="S3.SS4.SSS2.p4.6.m3.2.2.3.cmml">Υ</mi><mo id="S3.SS4.SSS2.p4.6.m3.2.2.2" xref="S3.SS4.SSS2.p4.6.m3.2.2.2.cmml">∈</mo><mrow id="S3.SS4.SSS2.p4.6.m3.2.2.1.1" xref="S3.SS4.SSS2.p4.6.m3.2.2.1.2.cmml"><mo id="S3.SS4.SSS2.p4.6.m3.2.2.1.1.2" stretchy="false" xref="S3.SS4.SSS2.p4.6.m3.2.2.1.2.cmml">[</mo><mrow id="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1" xref="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1.cmml"><mo id="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1a" xref="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1.cmml">−</mo><mn id="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1.2" xref="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1.2.cmml">5</mn></mrow><mo id="S3.SS4.SSS2.p4.6.m3.2.2.1.1.3" xref="S3.SS4.SSS2.p4.6.m3.2.2.1.2.cmml">,</mo><mn id="S3.SS4.SSS2.p4.6.m3.1.1" xref="S3.SS4.SSS2.p4.6.m3.1.1.cmml">5</mn><mo id="S3.SS4.SSS2.p4.6.m3.2.2.1.1.4" stretchy="false" xref="S3.SS4.SSS2.p4.6.m3.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p4.6.m3.2b"><apply id="S3.SS4.SSS2.p4.6.m3.2.2.cmml" xref="S3.SS4.SSS2.p4.6.m3.2.2"><in id="S3.SS4.SSS2.p4.6.m3.2.2.2.cmml" xref="S3.SS4.SSS2.p4.6.m3.2.2.2"></in><ci id="S3.SS4.SSS2.p4.6.m3.2.2.3.cmml" xref="S3.SS4.SSS2.p4.6.m3.2.2.3">Υ</ci><interval closure="closed" id="S3.SS4.SSS2.p4.6.m3.2.2.1.2.cmml" xref="S3.SS4.SSS2.p4.6.m3.2.2.1.1"><apply id="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1.cmml" xref="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1"><minus id="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1.1.cmml" xref="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1"></minus><cn id="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1.2.cmml" type="integer" xref="S3.SS4.SSS2.p4.6.m3.2.2.1.1.1.2">5</cn></apply><cn id="S3.SS4.SSS2.p4.6.m3.1.1.cmml" type="integer" xref="S3.SS4.SSS2.p4.6.m3.1.1">5</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p4.6.m3.2c">\Upsilon\in[-5,5]</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p4.6.m3.2d">roman_Υ ∈ [ - 5 , 5 ]</annotation></semantics></math> denotes the neighborhood space and <math alttext="\mathcal{G}_{m,n}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p4.7.m4.2"><semantics id="S3.SS4.SSS2.p4.7.m4.2a"><msub id="S3.SS4.SSS2.p4.7.m4.2.3" xref="S3.SS4.SSS2.p4.7.m4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p4.7.m4.2.3.2" xref="S3.SS4.SSS2.p4.7.m4.2.3.2.cmml">𝒢</mi><mrow id="S3.SS4.SSS2.p4.7.m4.2.2.2.4" xref="S3.SS4.SSS2.p4.7.m4.2.2.2.3.cmml"><mi id="S3.SS4.SSS2.p4.7.m4.1.1.1.1" xref="S3.SS4.SSS2.p4.7.m4.1.1.1.1.cmml">m</mi><mo id="S3.SS4.SSS2.p4.7.m4.2.2.2.4.1" xref="S3.SS4.SSS2.p4.7.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS2.p4.7.m4.2.2.2.2" xref="S3.SS4.SSS2.p4.7.m4.2.2.2.2.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p4.7.m4.2b"><apply id="S3.SS4.SSS2.p4.7.m4.2.3.cmml" xref="S3.SS4.SSS2.p4.7.m4.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p4.7.m4.2.3.1.cmml" xref="S3.SS4.SSS2.p4.7.m4.2.3">subscript</csymbol><ci id="S3.SS4.SSS2.p4.7.m4.2.3.2.cmml" xref="S3.SS4.SSS2.p4.7.m4.2.3.2">𝒢</ci><list id="S3.SS4.SSS2.p4.7.m4.2.2.2.3.cmml" xref="S3.SS4.SSS2.p4.7.m4.2.2.2.4"><ci id="S3.SS4.SSS2.p4.7.m4.1.1.1.1.cmml" xref="S3.SS4.SSS2.p4.7.m4.1.1.1.1">𝑚</ci><ci id="S3.SS4.SSS2.p4.7.m4.2.2.2.2.cmml" xref="S3.SS4.SSS2.p4.7.m4.2.2.2.2">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p4.7.m4.2c">\mathcal{G}_{m,n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p4.7.m4.2d">caligraphic_G start_POSTSUBSCRIPT italic_m , italic_n end_POSTSUBSCRIPT</annotation></semantics></math> denotes Gaussian kernel function<span class="ltx_note ltx_role_footnote" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Gaussian kernel function is a distance metric function, i.e., <math alttext="\mathcal{G}_{m,n}=\frac{1}{2\pi\sigma^{2}}\exp(-\frac{m^{2}+n^{2}}{2\sigma^{2}})" class="ltx_Math" display="inline" id="footnotex1.m1.4"><semantics id="footnotex1.m1.4b"><mrow id="footnotex1.m1.4.4" xref="footnotex1.m1.4.4.cmml"><msub id="footnotex1.m1.4.4.3" xref="footnotex1.m1.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="footnotex1.m1.4.4.3.2" xref="footnotex1.m1.4.4.3.2.cmml">𝒢</mi><mrow id="footnotex1.m1.2.2.2.4" xref="footnotex1.m1.2.2.2.3.cmml"><mi id="footnotex1.m1.1.1.1.1" xref="footnotex1.m1.1.1.1.1.cmml">m</mi><mo id="footnotex1.m1.2.2.2.4.1" xref="footnotex1.m1.2.2.2.3.cmml">,</mo><mi id="footnotex1.m1.2.2.2.2" xref="footnotex1.m1.2.2.2.2.cmml">n</mi></mrow></msub><mo id="footnotex1.m1.4.4.2" xref="footnotex1.m1.4.4.2.cmml">=</mo><mrow id="footnotex1.m1.4.4.1" xref="footnotex1.m1.4.4.1.cmml"><mfrac id="footnotex1.m1.4.4.1.3" xref="footnotex1.m1.4.4.1.3.cmml"><mn id="footnotex1.m1.4.4.1.3.2" xref="footnotex1.m1.4.4.1.3.2.cmml">1</mn><mrow id="footnotex1.m1.4.4.1.3.3" xref="footnotex1.m1.4.4.1.3.3.cmml"><mn id="footnotex1.m1.4.4.1.3.3.2" xref="footnotex1.m1.4.4.1.3.3.2.cmml">2</mn><mo id="footnotex1.m1.4.4.1.3.3.1" xref="footnotex1.m1.4.4.1.3.3.1.cmml">⁢</mo><mi id="footnotex1.m1.4.4.1.3.3.3" xref="footnotex1.m1.4.4.1.3.3.3.cmml">π</mi><mo id="footnotex1.m1.4.4.1.3.3.1b" xref="footnotex1.m1.4.4.1.3.3.1.cmml">⁢</mo><msup id="footnotex1.m1.4.4.1.3.3.4" xref="footnotex1.m1.4.4.1.3.3.4.cmml"><mi id="footnotex1.m1.4.4.1.3.3.4.2" xref="footnotex1.m1.4.4.1.3.3.4.2.cmml">σ</mi><mn id="footnotex1.m1.4.4.1.3.3.4.3" xref="footnotex1.m1.4.4.1.3.3.4.3.cmml">2</mn></msup></mrow></mfrac><mo id="footnotex1.m1.4.4.1.2" lspace="0.167em" xref="footnotex1.m1.4.4.1.2.cmml">⁢</mo><mrow id="footnotex1.m1.4.4.1.1.1" xref="footnotex1.m1.4.4.1.1.2.cmml"><mi id="footnotex1.m1.3.3" xref="footnotex1.m1.3.3.cmml">exp</mi><mo id="footnotex1.m1.4.4.1.1.1b" xref="footnotex1.m1.4.4.1.1.2.cmml">⁡</mo><mrow id="footnotex1.m1.4.4.1.1.1.1" xref="footnotex1.m1.4.4.1.1.2.cmml"><mo id="footnotex1.m1.4.4.1.1.1.1.2" stretchy="false" xref="footnotex1.m1.4.4.1.1.2.cmml">(</mo><mrow id="footnotex1.m1.4.4.1.1.1.1.1" xref="footnotex1.m1.4.4.1.1.1.1.1.cmml"><mo id="footnotex1.m1.4.4.1.1.1.1.1b" xref="footnotex1.m1.4.4.1.1.1.1.1.cmml">−</mo><mfrac id="footnotex1.m1.4.4.1.1.1.1.1.2" xref="footnotex1.m1.4.4.1.1.1.1.1.2.cmml"><mrow id="footnotex1.m1.4.4.1.1.1.1.1.2.2" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.cmml"><msup id="footnotex1.m1.4.4.1.1.1.1.1.2.2.2" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.2.cmml"><mi id="footnotex1.m1.4.4.1.1.1.1.1.2.2.2.2" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.2.2.cmml">m</mi><mn id="footnotex1.m1.4.4.1.1.1.1.1.2.2.2.3" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.2.3.cmml">2</mn></msup><mo id="footnotex1.m1.4.4.1.1.1.1.1.2.2.1" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.1.cmml">+</mo><msup id="footnotex1.m1.4.4.1.1.1.1.1.2.2.3" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.3.cmml"><mi id="footnotex1.m1.4.4.1.1.1.1.1.2.2.3.2" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.3.2.cmml">n</mi><mn id="footnotex1.m1.4.4.1.1.1.1.1.2.2.3.3" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.3.3.cmml">2</mn></msup></mrow><mrow id="footnotex1.m1.4.4.1.1.1.1.1.2.3" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.cmml"><mn id="footnotex1.m1.4.4.1.1.1.1.1.2.3.2" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.2.cmml">2</mn><mo id="footnotex1.m1.4.4.1.1.1.1.1.2.3.1" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.1.cmml">⁢</mo><msup id="footnotex1.m1.4.4.1.1.1.1.1.2.3.3" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.3.cmml"><mi id="footnotex1.m1.4.4.1.1.1.1.1.2.3.3.2" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.3.2.cmml">σ</mi><mn id="footnotex1.m1.4.4.1.1.1.1.1.2.3.3.3" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.3.3.cmml">2</mn></msup></mrow></mfrac></mrow><mo id="footnotex1.m1.4.4.1.1.1.1.3" stretchy="false" xref="footnotex1.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnotex1.m1.4c"><apply id="footnotex1.m1.4.4.cmml" xref="footnotex1.m1.4.4"><eq id="footnotex1.m1.4.4.2.cmml" xref="footnotex1.m1.4.4.2"></eq><apply id="footnotex1.m1.4.4.3.cmml" xref="footnotex1.m1.4.4.3"><csymbol cd="ambiguous" id="footnotex1.m1.4.4.3.1.cmml" xref="footnotex1.m1.4.4.3">subscript</csymbol><ci id="footnotex1.m1.4.4.3.2.cmml" xref="footnotex1.m1.4.4.3.2">𝒢</ci><list id="footnotex1.m1.2.2.2.3.cmml" xref="footnotex1.m1.2.2.2.4"><ci id="footnotex1.m1.1.1.1.1.cmml" xref="footnotex1.m1.1.1.1.1">𝑚</ci><ci id="footnotex1.m1.2.2.2.2.cmml" xref="footnotex1.m1.2.2.2.2">𝑛</ci></list></apply><apply id="footnotex1.m1.4.4.1.cmml" xref="footnotex1.m1.4.4.1"><times id="footnotex1.m1.4.4.1.2.cmml" xref="footnotex1.m1.4.4.1.2"></times><apply id="footnotex1.m1.4.4.1.3.cmml" xref="footnotex1.m1.4.4.1.3"><divide id="footnotex1.m1.4.4.1.3.1.cmml" xref="footnotex1.m1.4.4.1.3"></divide><cn id="footnotex1.m1.4.4.1.3.2.cmml" type="integer" xref="footnotex1.m1.4.4.1.3.2">1</cn><apply id="footnotex1.m1.4.4.1.3.3.cmml" xref="footnotex1.m1.4.4.1.3.3"><times id="footnotex1.m1.4.4.1.3.3.1.cmml" xref="footnotex1.m1.4.4.1.3.3.1"></times><cn id="footnotex1.m1.4.4.1.3.3.2.cmml" type="integer" xref="footnotex1.m1.4.4.1.3.3.2">2</cn><ci id="footnotex1.m1.4.4.1.3.3.3.cmml" xref="footnotex1.m1.4.4.1.3.3.3">𝜋</ci><apply id="footnotex1.m1.4.4.1.3.3.4.cmml" xref="footnotex1.m1.4.4.1.3.3.4"><csymbol cd="ambiguous" id="footnotex1.m1.4.4.1.3.3.4.1.cmml" xref="footnotex1.m1.4.4.1.3.3.4">superscript</csymbol><ci id="footnotex1.m1.4.4.1.3.3.4.2.cmml" xref="footnotex1.m1.4.4.1.3.3.4.2">𝜎</ci><cn id="footnotex1.m1.4.4.1.3.3.4.3.cmml" type="integer" xref="footnotex1.m1.4.4.1.3.3.4.3">2</cn></apply></apply></apply><apply id="footnotex1.m1.4.4.1.1.2.cmml" xref="footnotex1.m1.4.4.1.1.1"><exp id="footnotex1.m1.3.3.cmml" xref="footnotex1.m1.3.3"></exp><apply id="footnotex1.m1.4.4.1.1.1.1.1.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1"><minus id="footnotex1.m1.4.4.1.1.1.1.1.1.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1"></minus><apply id="footnotex1.m1.4.4.1.1.1.1.1.2.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2"><divide id="footnotex1.m1.4.4.1.1.1.1.1.2.1.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2"></divide><apply id="footnotex1.m1.4.4.1.1.1.1.1.2.2.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2"><plus id="footnotex1.m1.4.4.1.1.1.1.1.2.2.1.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.1"></plus><apply id="footnotex1.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="footnotex1.m1.4.4.1.1.1.1.1.2.2.2.1.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="footnotex1.m1.4.4.1.1.1.1.1.2.2.2.2.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.2.2">𝑚</ci><cn id="footnotex1.m1.4.4.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.2.3">2</cn></apply><apply id="footnotex1.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="footnotex1.m1.4.4.1.1.1.1.1.2.2.3.1.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.3">superscript</csymbol><ci id="footnotex1.m1.4.4.1.1.1.1.1.2.2.3.2.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.3.2">𝑛</ci><cn id="footnotex1.m1.4.4.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="footnotex1.m1.4.4.1.1.1.1.1.2.2.3.3">2</cn></apply></apply><apply id="footnotex1.m1.4.4.1.1.1.1.1.2.3.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3"><times id="footnotex1.m1.4.4.1.1.1.1.1.2.3.1.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.1"></times><cn id="footnotex1.m1.4.4.1.1.1.1.1.2.3.2.cmml" type="integer" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.2">2</cn><apply id="footnotex1.m1.4.4.1.1.1.1.1.2.3.3.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="footnotex1.m1.4.4.1.1.1.1.1.2.3.3.1.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.3">superscript</csymbol><ci id="footnotex1.m1.4.4.1.1.1.1.1.2.3.3.2.cmml" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.3.2">𝜎</ci><cn id="footnotex1.m1.4.4.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="footnotex1.m1.4.4.1.1.1.1.1.2.3.3.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnotex1.m1.4d">\mathcal{G}_{m,n}=\frac{1}{2\pi\sigma^{2}}\exp(-\frac{m^{2}+n^{2}}{2\sigma^{2}})</annotation><annotation encoding="application/x-llamapun" id="footnotex1.m1.4e">caligraphic_G start_POSTSUBSCRIPT italic_m , italic_n end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG 2 italic_π italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG roman_exp ( - divide start_ARG italic_m start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG 2 italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math></span></span></span>.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p5">
<p class="ltx_p" id="S3.SS4.SSS2.p5.7">Therefore, based on the above improvements, SPT can transfer the part-level semantics within different part masks to prompts by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widetilde{P}=\left(1+\mathcal{F}_{proj}\right)\left(\mathrm{softmax}\left(%
\widetilde{A}\left(P,X\right)\right)\left(XW_{v}\right)\right)" class="ltx_Math" display="block" id="S3.E8.m1.4"><semantics id="S3.E8.m1.4a"><mrow id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml"><mover accent="true" id="S3.E8.m1.4.4.4" xref="S3.E8.m1.4.4.4.cmml"><mi id="S3.E8.m1.4.4.4.2" xref="S3.E8.m1.4.4.4.2.cmml">P</mi><mo id="S3.E8.m1.4.4.4.1" xref="S3.E8.m1.4.4.4.1.cmml">~</mo></mover><mo id="S3.E8.m1.4.4.3" xref="S3.E8.m1.4.4.3.cmml">=</mo><mrow id="S3.E8.m1.4.4.2" xref="S3.E8.m1.4.4.2.cmml"><mrow id="S3.E8.m1.3.3.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.cmml"><mo id="S3.E8.m1.3.3.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.cmml"><mn id="S3.E8.m1.3.3.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml">1</mn><mo id="S3.E8.m1.3.3.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.cmml">+</mo><msub id="S3.E8.m1.3.3.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.3.3.1.1.1.1.3.2" xref="S3.E8.m1.3.3.1.1.1.1.3.2.cmml">ℱ</mi><mrow id="S3.E8.m1.3.3.1.1.1.1.3.3" xref="S3.E8.m1.3.3.1.1.1.1.3.3.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.3.3.2" xref="S3.E8.m1.3.3.1.1.1.1.3.3.2.cmml">p</mi><mo id="S3.E8.m1.3.3.1.1.1.1.3.3.1" xref="S3.E8.m1.3.3.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E8.m1.3.3.1.1.1.1.3.3.3" xref="S3.E8.m1.3.3.1.1.1.1.3.3.3.cmml">r</mi><mo id="S3.E8.m1.3.3.1.1.1.1.3.3.1a" xref="S3.E8.m1.3.3.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E8.m1.3.3.1.1.1.1.3.3.4" xref="S3.E8.m1.3.3.1.1.1.1.3.3.4.cmml">o</mi><mo id="S3.E8.m1.3.3.1.1.1.1.3.3.1b" xref="S3.E8.m1.3.3.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E8.m1.3.3.1.1.1.1.3.3.5" xref="S3.E8.m1.3.3.1.1.1.1.3.3.5.cmml">j</mi></mrow></msub></mrow><mo id="S3.E8.m1.3.3.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.4.4.2.3" xref="S3.E8.m1.4.4.2.3.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.2.2.1" xref="S3.E8.m1.4.4.2.2.1.1.cmml"><mo id="S3.E8.m1.4.4.2.2.1.2" xref="S3.E8.m1.4.4.2.2.1.1.cmml">(</mo><mrow id="S3.E8.m1.4.4.2.2.1.1" xref="S3.E8.m1.4.4.2.2.1.1.cmml"><mi id="S3.E8.m1.4.4.2.2.1.1.4" xref="S3.E8.m1.4.4.2.2.1.1.4.cmml">softmax</mi><mo id="S3.E8.m1.4.4.2.2.1.1.3" xref="S3.E8.m1.4.4.2.2.1.1.3.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.2.2.1.1.1.1" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.cmml"><mo id="S3.E8.m1.4.4.2.2.1.1.1.1.2" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.4.4.2.2.1.1.1.1.1" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.cmml"><mover accent="true" id="S3.E8.m1.4.4.2.2.1.1.1.1.1.2" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.4.4.2.2.1.1.1.1.1.2.2" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.2.2.cmml">A</mi><mo id="S3.E8.m1.4.4.2.2.1.1.1.1.1.2.1" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.2.1.cmml">~</mo></mover><mo id="S3.E8.m1.4.4.2.2.1.1.1.1.1.1" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.2.2.1.1.1.1.1.3.2" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.3.1.cmml"><mo id="S3.E8.m1.4.4.2.2.1.1.1.1.1.3.2.1" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">P</mi><mo id="S3.E8.m1.4.4.2.2.1.1.1.1.1.3.2.2" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml">X</mi><mo id="S3.E8.m1.4.4.2.2.1.1.1.1.1.3.2.3" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.4.4.2.2.1.1.1.1.3" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.4.4.2.2.1.1.3a" xref="S3.E8.m1.4.4.2.2.1.1.3.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.2.2.1.1.2.1" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.cmml"><mo id="S3.E8.m1.4.4.2.2.1.1.2.1.2" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.cmml">(</mo><mrow id="S3.E8.m1.4.4.2.2.1.1.2.1.1" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.cmml"><mi id="S3.E8.m1.4.4.2.2.1.1.2.1.1.2" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.2.cmml">X</mi><mo id="S3.E8.m1.4.4.2.2.1.1.2.1.1.1" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.1.cmml">⁢</mo><msub id="S3.E8.m1.4.4.2.2.1.1.2.1.1.3" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.3.cmml"><mi id="S3.E8.m1.4.4.2.2.1.1.2.1.1.3.2" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.3.2.cmml">W</mi><mi id="S3.E8.m1.4.4.2.2.1.1.2.1.1.3.3" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.3.3.cmml">v</mi></msub></mrow><mo id="S3.E8.m1.4.4.2.2.1.1.2.1.3" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.4.4.2.2.1.3" xref="S3.E8.m1.4.4.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.4b"><apply id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4"><eq id="S3.E8.m1.4.4.3.cmml" xref="S3.E8.m1.4.4.3"></eq><apply id="S3.E8.m1.4.4.4.cmml" xref="S3.E8.m1.4.4.4"><ci id="S3.E8.m1.4.4.4.1.cmml" xref="S3.E8.m1.4.4.4.1">~</ci><ci id="S3.E8.m1.4.4.4.2.cmml" xref="S3.E8.m1.4.4.4.2">𝑃</ci></apply><apply id="S3.E8.m1.4.4.2.cmml" xref="S3.E8.m1.4.4.2"><times id="S3.E8.m1.4.4.2.3.cmml" xref="S3.E8.m1.4.4.2.3"></times><apply id="S3.E8.m1.3.3.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1"><plus id="S3.E8.m1.3.3.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1"></plus><cn id="S3.E8.m1.3.3.1.1.1.1.2.cmml" type="integer" xref="S3.E8.m1.3.3.1.1.1.1.2">1</cn><apply id="S3.E8.m1.3.3.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.2">ℱ</ci><apply id="S3.E8.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3"><times id="S3.E8.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.1"></times><ci id="S3.E8.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.2">𝑝</ci><ci id="S3.E8.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.3">𝑟</ci><ci id="S3.E8.m1.3.3.1.1.1.1.3.3.4.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.4">𝑜</ci><ci id="S3.E8.m1.3.3.1.1.1.1.3.3.5.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.5">𝑗</ci></apply></apply></apply><apply id="S3.E8.m1.4.4.2.2.1.1.cmml" xref="S3.E8.m1.4.4.2.2.1"><times id="S3.E8.m1.4.4.2.2.1.1.3.cmml" xref="S3.E8.m1.4.4.2.2.1.1.3"></times><ci id="S3.E8.m1.4.4.2.2.1.1.4.cmml" xref="S3.E8.m1.4.4.2.2.1.1.4">softmax</ci><apply id="S3.E8.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S3.E8.m1.4.4.2.2.1.1.1.1"><times id="S3.E8.m1.4.4.2.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.1"></times><apply id="S3.E8.m1.4.4.2.2.1.1.1.1.1.2.cmml" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.2"><ci id="S3.E8.m1.4.4.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.2.1">~</ci><ci id="S3.E8.m1.4.4.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.2.2">𝐴</ci></apply><interval closure="open" id="S3.E8.m1.4.4.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.4.4.2.2.1.1.1.1.1.3.2"><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝑃</ci><ci id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2">𝑋</ci></interval></apply><apply id="S3.E8.m1.4.4.2.2.1.1.2.1.1.cmml" xref="S3.E8.m1.4.4.2.2.1.1.2.1"><times id="S3.E8.m1.4.4.2.2.1.1.2.1.1.1.cmml" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.1"></times><ci id="S3.E8.m1.4.4.2.2.1.1.2.1.1.2.cmml" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.2">𝑋</ci><apply id="S3.E8.m1.4.4.2.2.1.1.2.1.1.3.cmml" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.2.2.1.1.2.1.1.3.1.cmml" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.3">subscript</csymbol><ci id="S3.E8.m1.4.4.2.2.1.1.2.1.1.3.2.cmml" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.3.2">𝑊</ci><ci id="S3.E8.m1.4.4.2.2.1.1.2.1.1.3.3.cmml" xref="S3.E8.m1.4.4.2.2.1.1.2.1.1.3.3">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.4c">\widetilde{P}=\left(1+\mathcal{F}_{proj}\right)\left(\mathrm{softmax}\left(%
\widetilde{A}\left(P,X\right)\right)\left(XW_{v}\right)\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.4d">over~ start_ARG italic_P end_ARG = ( 1 + caligraphic_F start_POSTSUBSCRIPT italic_p italic_r italic_o italic_j end_POSTSUBSCRIPT ) ( roman_softmax ( over~ start_ARG italic_A end_ARG ( italic_P , italic_X ) ) ( italic_X italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS2.p5.6">where <math alttext="\mathcal{F}_{Proj}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p5.1.m1.1"><semantics id="S3.SS4.SSS2.p5.1.m1.1a"><msub id="S3.SS4.SSS2.p5.1.m1.1.1" xref="S3.SS4.SSS2.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS2.p5.1.m1.1.1.2" xref="S3.SS4.SSS2.p5.1.m1.1.1.2.cmml">ℱ</mi><mrow id="S3.SS4.SSS2.p5.1.m1.1.1.3" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.cmml"><mi id="S3.SS4.SSS2.p5.1.m1.1.1.3.2" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.2.cmml">P</mi><mo id="S3.SS4.SSS2.p5.1.m1.1.1.3.1" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.SSS2.p5.1.m1.1.1.3.3" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.3.cmml">r</mi><mo id="S3.SS4.SSS2.p5.1.m1.1.1.3.1a" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.SSS2.p5.1.m1.1.1.3.4" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.4.cmml">o</mi><mo id="S3.SS4.SSS2.p5.1.m1.1.1.3.1b" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.SSS2.p5.1.m1.1.1.3.5" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.5.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p5.1.m1.1b"><apply id="S3.SS4.SSS2.p5.1.m1.1.1.cmml" xref="S3.SS4.SSS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p5.1.m1.1.1.1.cmml" xref="S3.SS4.SSS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p5.1.m1.1.1.2.cmml" xref="S3.SS4.SSS2.p5.1.m1.1.1.2">ℱ</ci><apply id="S3.SS4.SSS2.p5.1.m1.1.1.3.cmml" xref="S3.SS4.SSS2.p5.1.m1.1.1.3"><times id="S3.SS4.SSS2.p5.1.m1.1.1.3.1.cmml" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.1"></times><ci id="S3.SS4.SSS2.p5.1.m1.1.1.3.2.cmml" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.2">𝑃</ci><ci id="S3.SS4.SSS2.p5.1.m1.1.1.3.3.cmml" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.3">𝑟</ci><ci id="S3.SS4.SSS2.p5.1.m1.1.1.3.4.cmml" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.4">𝑜</ci><ci id="S3.SS4.SSS2.p5.1.m1.1.1.3.5.cmml" xref="S3.SS4.SSS2.p5.1.m1.1.1.3.5">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p5.1.m1.1c">\mathcal{F}_{Proj}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p5.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_P italic_r italic_o italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is formed by a two-layer MLP and <math alttext="W_{v}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p5.2.m2.1"><semantics id="S3.SS4.SSS2.p5.2.m2.1a"><msub id="S3.SS4.SSS2.p5.2.m2.1.1" xref="S3.SS4.SSS2.p5.2.m2.1.1.cmml"><mi id="S3.SS4.SSS2.p5.2.m2.1.1.2" xref="S3.SS4.SSS2.p5.2.m2.1.1.2.cmml">W</mi><mi id="S3.SS4.SSS2.p5.2.m2.1.1.3" xref="S3.SS4.SSS2.p5.2.m2.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p5.2.m2.1b"><apply id="S3.SS4.SSS2.p5.2.m2.1.1.cmml" xref="S3.SS4.SSS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p5.2.m2.1.1.1.cmml" xref="S3.SS4.SSS2.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p5.2.m2.1.1.2.cmml" xref="S3.SS4.SSS2.p5.2.m2.1.1.2">𝑊</ci><ci id="S3.SS4.SSS2.p5.2.m2.1.1.3.cmml" xref="S3.SS4.SSS2.p5.2.m2.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p5.2.m2.1c">W_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p5.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> denotes the projection weight. <math alttext="\widetilde{P}=\left[\widetilde{p}_{1},\widetilde{p}_{2},...,\widetilde{p}_{N_{%
p}}\right]\in\mathbb{R}{{}^{N_{p}\times d}}" class="ltx_math_unparsed" display="inline" id="S3.SS4.SSS2.p5.3.m3.1"><semantics id="S3.SS4.SSS2.p5.3.m3.1a"><mrow id="S3.SS4.SSS2.p5.3.m3.1b"><mover accent="true" id="S3.SS4.SSS2.p5.3.m3.1.2"><mi id="S3.SS4.SSS2.p5.3.m3.1.2.2">P</mi><mo id="S3.SS4.SSS2.p5.3.m3.1.2.1">~</mo></mover><mo id="S3.SS4.SSS2.p5.3.m3.1.3">=</mo><mrow id="S3.SS4.SSS2.p5.3.m3.1.4"><mo id="S3.SS4.SSS2.p5.3.m3.1.4.1">[</mo><msub id="S3.SS4.SSS2.p5.3.m3.1.4.2"><mover accent="true" id="S3.SS4.SSS2.p5.3.m3.1.4.2.2"><mi id="S3.SS4.SSS2.p5.3.m3.1.4.2.2.2">p</mi><mo id="S3.SS4.SSS2.p5.3.m3.1.4.2.2.1">~</mo></mover><mn id="S3.SS4.SSS2.p5.3.m3.1.4.2.3">1</mn></msub><mo id="S3.SS4.SSS2.p5.3.m3.1.4.3">,</mo><msub id="S3.SS4.SSS2.p5.3.m3.1.4.4"><mover accent="true" id="S3.SS4.SSS2.p5.3.m3.1.4.4.2"><mi id="S3.SS4.SSS2.p5.3.m3.1.4.4.2.2">p</mi><mo id="S3.SS4.SSS2.p5.3.m3.1.4.4.2.1">~</mo></mover><mn id="S3.SS4.SSS2.p5.3.m3.1.4.4.3">2</mn></msub><mo id="S3.SS4.SSS2.p5.3.m3.1.4.5">,</mo><mi id="S3.SS4.SSS2.p5.3.m3.1.1" mathvariant="normal">…</mi><mo id="S3.SS4.SSS2.p5.3.m3.1.4.6">,</mo><msub id="S3.SS4.SSS2.p5.3.m3.1.4.7"><mover accent="true" id="S3.SS4.SSS2.p5.3.m3.1.4.7.2"><mi id="S3.SS4.SSS2.p5.3.m3.1.4.7.2.2">p</mi><mo id="S3.SS4.SSS2.p5.3.m3.1.4.7.2.1">~</mo></mover><msub id="S3.SS4.SSS2.p5.3.m3.1.4.7.3"><mi id="S3.SS4.SSS2.p5.3.m3.1.4.7.3.2">N</mi><mi id="S3.SS4.SSS2.p5.3.m3.1.4.7.3.3">p</mi></msub></msub><mo id="S3.SS4.SSS2.p5.3.m3.1.4.8">]</mo></mrow><mo id="S3.SS4.SSS2.p5.3.m3.1.5">∈</mo><mi id="S3.SS4.SSS2.p5.3.m3.1.6">ℝ</mi><msup id="S3.SS4.SSS2.p5.3.m3.1.7"><mi id="S3.SS4.SSS2.p5.3.m3.1.7a"></mi><mrow id="S3.SS4.SSS2.p5.3.m3.1.7.1"><msub id="S3.SS4.SSS2.p5.3.m3.1.7.1.2"><mi id="S3.SS4.SSS2.p5.3.m3.1.7.1.2.2">N</mi><mi id="S3.SS4.SSS2.p5.3.m3.1.7.1.2.3">p</mi></msub><mo id="S3.SS4.SSS2.p5.3.m3.1.7.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS4.SSS2.p5.3.m3.1.7.1.3">d</mi></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p5.3.m3.1c">\widetilde{P}=\left[\widetilde{p}_{1},\widetilde{p}_{2},...,\widetilde{p}_{N_{%
p}}\right]\in\mathbb{R}{{}^{N_{p}\times d}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p5.3.m3.1d">over~ start_ARG italic_P end_ARG = [ over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ∈ blackboard_R start_FLOATSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT × italic_d end_FLOATSUPERSCRIPT</annotation></semantics></math> denotes the enhanced class-aware FG-prompts, in which <math alttext="\widetilde{p}_{i}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p5.4.m4.1"><semantics id="S3.SS4.SSS2.p5.4.m4.1a"><msub id="S3.SS4.SSS2.p5.4.m4.1.1" xref="S3.SS4.SSS2.p5.4.m4.1.1.cmml"><mover accent="true" id="S3.SS4.SSS2.p5.4.m4.1.1.2" xref="S3.SS4.SSS2.p5.4.m4.1.1.2.cmml"><mi id="S3.SS4.SSS2.p5.4.m4.1.1.2.2" xref="S3.SS4.SSS2.p5.4.m4.1.1.2.2.cmml">p</mi><mo id="S3.SS4.SSS2.p5.4.m4.1.1.2.1" xref="S3.SS4.SSS2.p5.4.m4.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS4.SSS2.p5.4.m4.1.1.3" xref="S3.SS4.SSS2.p5.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p5.4.m4.1b"><apply id="S3.SS4.SSS2.p5.4.m4.1.1.cmml" xref="S3.SS4.SSS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p5.4.m4.1.1.1.cmml" xref="S3.SS4.SSS2.p5.4.m4.1.1">subscript</csymbol><apply id="S3.SS4.SSS2.p5.4.m4.1.1.2.cmml" xref="S3.SS4.SSS2.p5.4.m4.1.1.2"><ci id="S3.SS4.SSS2.p5.4.m4.1.1.2.1.cmml" xref="S3.SS4.SSS2.p5.4.m4.1.1.2.1">~</ci><ci id="S3.SS4.SSS2.p5.4.m4.1.1.2.2.cmml" xref="S3.SS4.SSS2.p5.4.m4.1.1.2.2">𝑝</ci></apply><ci id="S3.SS4.SSS2.p5.4.m4.1.1.3.cmml" xref="S3.SS4.SSS2.p5.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p5.4.m4.1c">\widetilde{p}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p5.4.m4.1d">over~ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> aggregates the semantics from <math alttext="i^{th}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p5.5.m5.1"><semantics id="S3.SS4.SSS2.p5.5.m5.1a"><msup id="S3.SS4.SSS2.p5.5.m5.1.1" xref="S3.SS4.SSS2.p5.5.m5.1.1.cmml"><mi id="S3.SS4.SSS2.p5.5.m5.1.1.2" xref="S3.SS4.SSS2.p5.5.m5.1.1.2.cmml">i</mi><mrow id="S3.SS4.SSS2.p5.5.m5.1.1.3" xref="S3.SS4.SSS2.p5.5.m5.1.1.3.cmml"><mi id="S3.SS4.SSS2.p5.5.m5.1.1.3.2" xref="S3.SS4.SSS2.p5.5.m5.1.1.3.2.cmml">t</mi><mo id="S3.SS4.SSS2.p5.5.m5.1.1.3.1" xref="S3.SS4.SSS2.p5.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.SSS2.p5.5.m5.1.1.3.3" xref="S3.SS4.SSS2.p5.5.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p5.5.m5.1b"><apply id="S3.SS4.SSS2.p5.5.m5.1.1.cmml" xref="S3.SS4.SSS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p5.5.m5.1.1.1.cmml" xref="S3.SS4.SSS2.p5.5.m5.1.1">superscript</csymbol><ci id="S3.SS4.SSS2.p5.5.m5.1.1.2.cmml" xref="S3.SS4.SSS2.p5.5.m5.1.1.2">𝑖</ci><apply id="S3.SS4.SSS2.p5.5.m5.1.1.3.cmml" xref="S3.SS4.SSS2.p5.5.m5.1.1.3"><times id="S3.SS4.SSS2.p5.5.m5.1.1.3.1.cmml" xref="S3.SS4.SSS2.p5.5.m5.1.1.3.1"></times><ci id="S3.SS4.SSS2.p5.5.m5.1.1.3.2.cmml" xref="S3.SS4.SSS2.p5.5.m5.1.1.3.2">𝑡</ci><ci id="S3.SS4.SSS2.p5.5.m5.1.1.3.3.cmml" xref="S3.SS4.SSS2.p5.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p5.5.m5.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p5.5.m5.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> part mask region <math alttext="m_{i}^{p}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p5.6.m6.1"><semantics id="S3.SS4.SSS2.p5.6.m6.1a"><msubsup id="S3.SS4.SSS2.p5.6.m6.1.1" xref="S3.SS4.SSS2.p5.6.m6.1.1.cmml"><mi id="S3.SS4.SSS2.p5.6.m6.1.1.2.2" xref="S3.SS4.SSS2.p5.6.m6.1.1.2.2.cmml">m</mi><mi id="S3.SS4.SSS2.p5.6.m6.1.1.2.3" xref="S3.SS4.SSS2.p5.6.m6.1.1.2.3.cmml">i</mi><mi id="S3.SS4.SSS2.p5.6.m6.1.1.3" xref="S3.SS4.SSS2.p5.6.m6.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p5.6.m6.1b"><apply id="S3.SS4.SSS2.p5.6.m6.1.1.cmml" xref="S3.SS4.SSS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p5.6.m6.1.1.1.cmml" xref="S3.SS4.SSS2.p5.6.m6.1.1">superscript</csymbol><apply id="S3.SS4.SSS2.p5.6.m6.1.1.2.cmml" xref="S3.SS4.SSS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p5.6.m6.1.1.2.1.cmml" xref="S3.SS4.SSS2.p5.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p5.6.m6.1.1.2.2.cmml" xref="S3.SS4.SSS2.p5.6.m6.1.1.2.2">𝑚</ci><ci id="S3.SS4.SSS2.p5.6.m6.1.1.2.3.cmml" xref="S3.SS4.SSS2.p5.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S3.SS4.SSS2.p5.6.m6.1.1.3.cmml" xref="S3.SS4.SSS2.p5.6.m6.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p5.6.m6.1c">m_{i}^{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p5.6.m6.1d">italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p6">
<p class="ltx_p" id="S3.SS4.SSS2.p6.1">The BG-Prompt Enhancement follows a similar process, with the only difference being that the background masks (foreground masks reversed) are fed directly into the Semantic Prompt Transfer (SPT) to generate BG-prompts without Part Mask generator (PMG).</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p7">
<p class="ltx_p" id="S3.SS4.SSS2.p7.7">In summary, during the Prompt Enhancement, the prompts will aggregate class-specific semantics from the support/query image to generate corresponding class-aware prompts, which can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\widetilde{P}^{q},\widetilde{B}^{q}&amp;=\mathrm{PE}\left(X^{q},\hat{%
M}^{q},P^{q},B^{q}\right)\\
\widetilde{P}^{s},\widetilde{B}^{s}&amp;=\mathrm{PE}\left(X^{s},M^{s},P^{s},B^{s}%
\right)\end{split}" class="ltx_Math" display="block" id="S3.E9.m1.54"><semantics id="S3.E9.m1.54a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E9.m1.54.54.14" rowspacing="0pt"><mtr id="S3.E9.m1.54.54.14a"><mtd class="ltx_align_right" columnalign="right" id="S3.E9.m1.54.54.14b"><mrow id="S3.E9.m1.44.44.4.42.22.7.7"><msup id="S3.E9.m1.43.43.3.41.21.6.6.1"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml">P</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml">~</mo></mover><mi id="S3.E9.m1.2.2.2.2.2.2.1" xref="S3.E9.m1.2.2.2.2.2.2.1.cmml">q</mi></msup><mo id="S3.E9.m1.3.3.3.3.3.3" xref="S3.E9.m1.42.42.2.3.cmml">,</mo><msup id="S3.E9.m1.44.44.4.42.22.7.7.2"><mover accent="true" id="S3.E9.m1.4.4.4.4.4.4" xref="S3.E9.m1.4.4.4.4.4.4.cmml"><mi id="S3.E9.m1.4.4.4.4.4.4.2" xref="S3.E9.m1.4.4.4.4.4.4.2.cmml">B</mi><mo id="S3.E9.m1.4.4.4.4.4.4.1" xref="S3.E9.m1.4.4.4.4.4.4.1.cmml">~</mo></mover><mi id="S3.E9.m1.5.5.5.5.5.5.1" xref="S3.E9.m1.5.5.5.5.5.5.1.cmml">q</mi></msup></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.54.54.14c"><mrow id="S3.E9.m1.48.48.8.46.26.19"><mi id="S3.E9.m1.48.48.8.46.26.19.20" xref="S3.E9.m1.42.42.2.3.cmml"></mi><mo id="S3.E9.m1.6.6.6.6.1.1" xref="S3.E9.m1.6.6.6.6.1.1.cmml">=</mo><mrow id="S3.E9.m1.48.48.8.46.26.19.19"><mi id="S3.E9.m1.7.7.7.7.2.2" xref="S3.E9.m1.7.7.7.7.2.2.cmml">PE</mi><mo id="S3.E9.m1.48.48.8.46.26.19.19.5" xref="S3.E9.m1.42.42.2.3.cmml">⁢</mo><mrow id="S3.E9.m1.48.48.8.46.26.19.19.4.4"><mo id="S3.E9.m1.8.8.8.8.3.3" xref="S3.E9.m1.42.42.2.3.cmml">(</mo><msup id="S3.E9.m1.45.45.5.43.23.16.16.1.1.1"><mi id="S3.E9.m1.9.9.9.9.4.4" xref="S3.E9.m1.9.9.9.9.4.4.cmml">X</mi><mi id="S3.E9.m1.10.10.10.10.5.5.1" xref="S3.E9.m1.10.10.10.10.5.5.1.cmml">q</mi></msup><mo id="S3.E9.m1.11.11.11.11.6.6" xref="S3.E9.m1.42.42.2.3.cmml">,</mo><msup id="S3.E9.m1.46.46.6.44.24.17.17.2.2.2"><mover accent="true" id="S3.E9.m1.12.12.12.12.7.7" xref="S3.E9.m1.12.12.12.12.7.7.cmml"><mi id="S3.E9.m1.12.12.12.12.7.7.2" xref="S3.E9.m1.12.12.12.12.7.7.2.cmml">M</mi><mo id="S3.E9.m1.12.12.12.12.7.7.1" xref="S3.E9.m1.12.12.12.12.7.7.1.cmml">^</mo></mover><mi id="S3.E9.m1.13.13.13.13.8.8.1" xref="S3.E9.m1.13.13.13.13.8.8.1.cmml">q</mi></msup><mo id="S3.E9.m1.14.14.14.14.9.9" xref="S3.E9.m1.42.42.2.3.cmml">,</mo><msup id="S3.E9.m1.47.47.7.45.25.18.18.3.3.3"><mi id="S3.E9.m1.15.15.15.15.10.10" xref="S3.E9.m1.15.15.15.15.10.10.cmml">P</mi><mi id="S3.E9.m1.16.16.16.16.11.11.1" xref="S3.E9.m1.16.16.16.16.11.11.1.cmml">q</mi></msup><mo id="S3.E9.m1.17.17.17.17.12.12" xref="S3.E9.m1.42.42.2.3.cmml">,</mo><msup id="S3.E9.m1.48.48.8.46.26.19.19.4.4.4"><mi id="S3.E9.m1.18.18.18.18.13.13" xref="S3.E9.m1.18.18.18.18.13.13.cmml">B</mi><mi id="S3.E9.m1.19.19.19.19.14.14.1" xref="S3.E9.m1.19.19.19.19.14.14.1.cmml">q</mi></msup><mo id="S3.E9.m1.20.20.20.20.15.15" xref="S3.E9.m1.42.42.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E9.m1.54.54.14d"><mtd class="ltx_align_right" columnalign="right" id="S3.E9.m1.54.54.14e"><mrow id="S3.E9.m1.50.50.10.48.22.7.7"><msup id="S3.E9.m1.49.49.9.47.21.6.6.1"><mover accent="true" id="S3.E9.m1.21.21.21.1.1.1" xref="S3.E9.m1.21.21.21.1.1.1.cmml"><mi id="S3.E9.m1.21.21.21.1.1.1.2" xref="S3.E9.m1.21.21.21.1.1.1.2.cmml">P</mi><mo id="S3.E9.m1.21.21.21.1.1.1.1" xref="S3.E9.m1.21.21.21.1.1.1.1.cmml">~</mo></mover><mi id="S3.E9.m1.22.22.22.2.2.2.1" xref="S3.E9.m1.22.22.22.2.2.2.1.cmml">s</mi></msup><mo id="S3.E9.m1.23.23.23.3.3.3" xref="S3.E9.m1.42.42.2.3.cmml">,</mo><msup id="S3.E9.m1.50.50.10.48.22.7.7.2"><mover accent="true" id="S3.E9.m1.24.24.24.4.4.4" xref="S3.E9.m1.24.24.24.4.4.4.cmml"><mi id="S3.E9.m1.24.24.24.4.4.4.2" xref="S3.E9.m1.24.24.24.4.4.4.2.cmml">B</mi><mo id="S3.E9.m1.24.24.24.4.4.4.1" xref="S3.E9.m1.24.24.24.4.4.4.1.cmml">~</mo></mover><mi id="S3.E9.m1.25.25.25.5.5.5.1" xref="S3.E9.m1.25.25.25.5.5.5.1.cmml">s</mi></msup></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.54.54.14f"><mrow id="S3.E9.m1.54.54.14.52.26.19"><mi id="S3.E9.m1.54.54.14.52.26.19.20" xref="S3.E9.m1.42.42.2.3.cmml"></mi><mo id="S3.E9.m1.26.26.26.6.1.1" xref="S3.E9.m1.26.26.26.6.1.1.cmml">=</mo><mrow id="S3.E9.m1.54.54.14.52.26.19.19"><mi id="S3.E9.m1.27.27.27.7.2.2" xref="S3.E9.m1.27.27.27.7.2.2.cmml">PE</mi><mo id="S3.E9.m1.54.54.14.52.26.19.19.5" xref="S3.E9.m1.42.42.2.3.cmml">⁢</mo><mrow id="S3.E9.m1.54.54.14.52.26.19.19.4.4"><mo id="S3.E9.m1.28.28.28.8.3.3" xref="S3.E9.m1.42.42.2.3.cmml">(</mo><msup id="S3.E9.m1.51.51.11.49.23.16.16.1.1.1"><mi id="S3.E9.m1.29.29.29.9.4.4" xref="S3.E9.m1.29.29.29.9.4.4.cmml">X</mi><mi id="S3.E9.m1.30.30.30.10.5.5.1" xref="S3.E9.m1.30.30.30.10.5.5.1.cmml">s</mi></msup><mo id="S3.E9.m1.31.31.31.11.6.6" xref="S3.E9.m1.42.42.2.3.cmml">,</mo><msup id="S3.E9.m1.52.52.12.50.24.17.17.2.2.2"><mi id="S3.E9.m1.32.32.32.12.7.7" xref="S3.E9.m1.32.32.32.12.7.7.cmml">M</mi><mi id="S3.E9.m1.33.33.33.13.8.8.1" xref="S3.E9.m1.33.33.33.13.8.8.1.cmml">s</mi></msup><mo id="S3.E9.m1.34.34.34.14.9.9" xref="S3.E9.m1.42.42.2.3.cmml">,</mo><msup id="S3.E9.m1.53.53.13.51.25.18.18.3.3.3"><mi id="S3.E9.m1.35.35.35.15.10.10" xref="S3.E9.m1.35.35.35.15.10.10.cmml">P</mi><mi id="S3.E9.m1.36.36.36.16.11.11.1" xref="S3.E9.m1.36.36.36.16.11.11.1.cmml">s</mi></msup><mo id="S3.E9.m1.37.37.37.17.12.12" xref="S3.E9.m1.42.42.2.3.cmml">,</mo><msup id="S3.E9.m1.54.54.14.52.26.19.19.4.4.4"><mi id="S3.E9.m1.38.38.38.18.13.13" xref="S3.E9.m1.38.38.38.18.13.13.cmml">B</mi><mi id="S3.E9.m1.39.39.39.19.14.14.1" xref="S3.E9.m1.39.39.39.19.14.14.1.cmml">s</mi></msup><mo id="S3.E9.m1.40.40.40.20.15.15" xref="S3.E9.m1.42.42.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E9.m1.54b"><apply id="S3.E9.m1.42.42.2.3.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.42.42.2.3a.cmml" xref="S3.E9.m1.3.3.3.3.3.3">formulae-sequence</csymbol><apply id="S3.E9.m1.41.41.1.1.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><eq id="S3.E9.m1.6.6.6.6.1.1.cmml" xref="S3.E9.m1.6.6.6.6.1.1"></eq><list id="S3.E9.m1.41.41.1.1.1.2.3.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><apply id="S3.E9.m1.41.41.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.41.41.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"><ci id="S3.E9.m1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1">~</ci><ci id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2">𝑃</ci></apply><ci id="S3.E9.m1.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1">𝑞</ci></apply><apply id="S3.E9.m1.41.41.1.1.1.2.2.2.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.41.41.1.1.1.2.2.2.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><apply id="S3.E9.m1.4.4.4.4.4.4.cmml" xref="S3.E9.m1.4.4.4.4.4.4"><ci id="S3.E9.m1.4.4.4.4.4.4.1.cmml" xref="S3.E9.m1.4.4.4.4.4.4.1">~</ci><ci id="S3.E9.m1.4.4.4.4.4.4.2.cmml" xref="S3.E9.m1.4.4.4.4.4.4.2">𝐵</ci></apply><ci id="S3.E9.m1.5.5.5.5.5.5.1.cmml" xref="S3.E9.m1.5.5.5.5.5.5.1">𝑞</ci></apply></list><apply id="S3.E9.m1.41.41.1.1.1.6.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><times id="S3.E9.m1.41.41.1.1.1.6.5.cmml" xref="S3.E9.m1.3.3.3.3.3.3"></times><ci id="S3.E9.m1.7.7.7.7.2.2.cmml" xref="S3.E9.m1.7.7.7.7.2.2">PE</ci><vector id="S3.E9.m1.41.41.1.1.1.6.4.5.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><apply id="S3.E9.m1.41.41.1.1.1.3.1.1.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.41.41.1.1.1.3.1.1.1.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><ci id="S3.E9.m1.9.9.9.9.4.4.cmml" xref="S3.E9.m1.9.9.9.9.4.4">𝑋</ci><ci id="S3.E9.m1.10.10.10.10.5.5.1.cmml" xref="S3.E9.m1.10.10.10.10.5.5.1">𝑞</ci></apply><apply id="S3.E9.m1.41.41.1.1.1.4.2.2.2.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.41.41.1.1.1.4.2.2.2.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><apply id="S3.E9.m1.12.12.12.12.7.7.cmml" xref="S3.E9.m1.12.12.12.12.7.7"><ci id="S3.E9.m1.12.12.12.12.7.7.1.cmml" xref="S3.E9.m1.12.12.12.12.7.7.1">^</ci><ci id="S3.E9.m1.12.12.12.12.7.7.2.cmml" xref="S3.E9.m1.12.12.12.12.7.7.2">𝑀</ci></apply><ci id="S3.E9.m1.13.13.13.13.8.8.1.cmml" xref="S3.E9.m1.13.13.13.13.8.8.1">𝑞</ci></apply><apply id="S3.E9.m1.41.41.1.1.1.5.3.3.3.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.41.41.1.1.1.5.3.3.3.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><ci id="S3.E9.m1.15.15.15.15.10.10.cmml" xref="S3.E9.m1.15.15.15.15.10.10">𝑃</ci><ci id="S3.E9.m1.16.16.16.16.11.11.1.cmml" xref="S3.E9.m1.16.16.16.16.11.11.1">𝑞</ci></apply><apply id="S3.E9.m1.41.41.1.1.1.6.4.4.4.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.41.41.1.1.1.6.4.4.4.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><ci id="S3.E9.m1.18.18.18.18.13.13.cmml" xref="S3.E9.m1.18.18.18.18.13.13">𝐵</ci><ci id="S3.E9.m1.19.19.19.19.14.14.1.cmml" xref="S3.E9.m1.19.19.19.19.14.14.1">𝑞</ci></apply></vector><apply id="S3.E9.m1.41.41.1.1.1.6.7.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.41.41.1.1.1.6.7.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><apply id="S3.E9.m1.21.21.21.1.1.1.cmml" xref="S3.E9.m1.21.21.21.1.1.1"><ci id="S3.E9.m1.21.21.21.1.1.1.1.cmml" xref="S3.E9.m1.21.21.21.1.1.1.1">~</ci><ci id="S3.E9.m1.21.21.21.1.1.1.2.cmml" xref="S3.E9.m1.21.21.21.1.1.1.2">𝑃</ci></apply><ci id="S3.E9.m1.22.22.22.2.2.2.1.cmml" xref="S3.E9.m1.22.22.22.2.2.2.1">𝑠</ci></apply></apply></apply><apply id="S3.E9.m1.42.42.2.2.2.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><eq id="S3.E9.m1.26.26.26.6.1.1.cmml" xref="S3.E9.m1.26.26.26.6.1.1"></eq><apply id="S3.E9.m1.42.42.2.2.2.6.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.42.42.2.2.2.6.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><apply id="S3.E9.m1.24.24.24.4.4.4.cmml" xref="S3.E9.m1.24.24.24.4.4.4"><ci id="S3.E9.m1.24.24.24.4.4.4.1.cmml" xref="S3.E9.m1.24.24.24.4.4.4.1">~</ci><ci id="S3.E9.m1.24.24.24.4.4.4.2.cmml" xref="S3.E9.m1.24.24.24.4.4.4.2">𝐵</ci></apply><ci id="S3.E9.m1.25.25.25.5.5.5.1.cmml" xref="S3.E9.m1.25.25.25.5.5.5.1">𝑠</ci></apply><apply id="S3.E9.m1.42.42.2.2.2.4.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><times id="S3.E9.m1.42.42.2.2.2.4.5.cmml" xref="S3.E9.m1.3.3.3.3.3.3"></times><ci id="S3.E9.m1.27.27.27.7.2.2.cmml" xref="S3.E9.m1.27.27.27.7.2.2">PE</ci><vector id="S3.E9.m1.42.42.2.2.2.4.4.5.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><apply id="S3.E9.m1.42.42.2.2.2.1.1.1.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.42.42.2.2.2.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><ci id="S3.E9.m1.29.29.29.9.4.4.cmml" xref="S3.E9.m1.29.29.29.9.4.4">𝑋</ci><ci id="S3.E9.m1.30.30.30.10.5.5.1.cmml" xref="S3.E9.m1.30.30.30.10.5.5.1">𝑠</ci></apply><apply id="S3.E9.m1.42.42.2.2.2.2.2.2.2.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.42.42.2.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><ci id="S3.E9.m1.32.32.32.12.7.7.cmml" xref="S3.E9.m1.32.32.32.12.7.7">𝑀</ci><ci id="S3.E9.m1.33.33.33.13.8.8.1.cmml" xref="S3.E9.m1.33.33.33.13.8.8.1">𝑠</ci></apply><apply id="S3.E9.m1.42.42.2.2.2.3.3.3.3.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.42.42.2.2.2.3.3.3.3.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><ci id="S3.E9.m1.35.35.35.15.10.10.cmml" xref="S3.E9.m1.35.35.35.15.10.10">𝑃</ci><ci id="S3.E9.m1.36.36.36.16.11.11.1.cmml" xref="S3.E9.m1.36.36.36.16.11.11.1">𝑠</ci></apply><apply id="S3.E9.m1.42.42.2.2.2.4.4.4.4.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.42.42.2.2.2.4.4.4.4.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">superscript</csymbol><ci id="S3.E9.m1.38.38.38.18.13.13.cmml" xref="S3.E9.m1.38.38.38.18.13.13">𝐵</ci><ci id="S3.E9.m1.39.39.39.19.14.14.1.cmml" xref="S3.E9.m1.39.39.39.19.14.14.1">𝑠</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.54c">\begin{split}\widetilde{P}^{q},\widetilde{B}^{q}&amp;=\mathrm{PE}\left(X^{q},\hat{%
M}^{q},P^{q},B^{q}\right)\\
\widetilde{P}^{s},\widetilde{B}^{s}&amp;=\mathrm{PE}\left(X^{s},M^{s},P^{s},B^{s}%
\right)\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.54d">start_ROW start_CELL over~ start_ARG italic_P end_ARG start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , over~ start_ARG italic_B end_ARG start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT end_CELL start_CELL = roman_PE ( italic_X start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , over^ start_ARG italic_M end_ARG start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , italic_P start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , italic_B start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ) end_CELL end_ROW start_ROW start_CELL over~ start_ARG italic_P end_ARG start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT , over~ start_ARG italic_B end_ARG start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT end_CELL start_CELL = roman_PE ( italic_X start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT , italic_M start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT , italic_P start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT , italic_B start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS2.p7.6">where <math alttext="\mathrm{PE}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p7.1.m1.1"><semantics id="S3.SS4.SSS2.p7.1.m1.1a"><mi id="S3.SS4.SSS2.p7.1.m1.1.1" xref="S3.SS4.SSS2.p7.1.m1.1.1.cmml">PE</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p7.1.m1.1b"><ci id="S3.SS4.SSS2.p7.1.m1.1.1.cmml" xref="S3.SS4.SSS2.p7.1.m1.1.1">PE</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p7.1.m1.1c">\mathrm{PE}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p7.1.m1.1d">roman_PE</annotation></semantics></math> denotes the entire Prompt Enhancement process via Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E2" title="In 3.4.1 Part Mask Generator (PMG) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>)-Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E8" title="In 3.4.2 Semantic Prompt Transfer (SPT) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">8</span></a>). <math alttext="X^{q}(X^{s})" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p7.2.m2.1"><semantics id="S3.SS4.SSS2.p7.2.m2.1a"><mrow id="S3.SS4.SSS2.p7.2.m2.1.1" xref="S3.SS4.SSS2.p7.2.m2.1.1.cmml"><msup id="S3.SS4.SSS2.p7.2.m2.1.1.3" xref="S3.SS4.SSS2.p7.2.m2.1.1.3.cmml"><mi id="S3.SS4.SSS2.p7.2.m2.1.1.3.2" xref="S3.SS4.SSS2.p7.2.m2.1.1.3.2.cmml">X</mi><mi id="S3.SS4.SSS2.p7.2.m2.1.1.3.3" xref="S3.SS4.SSS2.p7.2.m2.1.1.3.3.cmml">q</mi></msup><mo id="S3.SS4.SSS2.p7.2.m2.1.1.2" xref="S3.SS4.SSS2.p7.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS2.p7.2.m2.1.1.1.1" xref="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS2.p7.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.cmml">(</mo><msup id="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1" xref="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.2" xref="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.2.cmml">X</mi><mi id="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.3" xref="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.3.cmml">s</mi></msup><mo id="S3.SS4.SSS2.p7.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p7.2.m2.1b"><apply id="S3.SS4.SSS2.p7.2.m2.1.1.cmml" xref="S3.SS4.SSS2.p7.2.m2.1.1"><times id="S3.SS4.SSS2.p7.2.m2.1.1.2.cmml" xref="S3.SS4.SSS2.p7.2.m2.1.1.2"></times><apply id="S3.SS4.SSS2.p7.2.m2.1.1.3.cmml" xref="S3.SS4.SSS2.p7.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p7.2.m2.1.1.3.1.cmml" xref="S3.SS4.SSS2.p7.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.SSS2.p7.2.m2.1.1.3.2.cmml" xref="S3.SS4.SSS2.p7.2.m2.1.1.3.2">𝑋</ci><ci id="S3.SS4.SSS2.p7.2.m2.1.1.3.3.cmml" xref="S3.SS4.SSS2.p7.2.m2.1.1.3.3">𝑞</ci></apply><apply id="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p7.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p7.2.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS2.p7.2.m2.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p7.2.m2.1c">X^{q}(X^{s})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p7.2.m2.1d">italic_X start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ( italic_X start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT )</annotation></semantics></math> denotes the query (support) feature. <math alttext="\hat{M^{q}}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p7.3.m3.1"><semantics id="S3.SS4.SSS2.p7.3.m3.1a"><mover accent="true" id="S3.SS4.SSS2.p7.3.m3.1.1" xref="S3.SS4.SSS2.p7.3.m3.1.1.cmml"><msup id="S3.SS4.SSS2.p7.3.m3.1.1.2" xref="S3.SS4.SSS2.p7.3.m3.1.1.2.cmml"><mi id="S3.SS4.SSS2.p7.3.m3.1.1.2.2" xref="S3.SS4.SSS2.p7.3.m3.1.1.2.2.cmml">M</mi><mi id="S3.SS4.SSS2.p7.3.m3.1.1.2.3" xref="S3.SS4.SSS2.p7.3.m3.1.1.2.3.cmml">q</mi></msup><mo id="S3.SS4.SSS2.p7.3.m3.1.1.1" xref="S3.SS4.SSS2.p7.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p7.3.m3.1b"><apply id="S3.SS4.SSS2.p7.3.m3.1.1.cmml" xref="S3.SS4.SSS2.p7.3.m3.1.1"><ci id="S3.SS4.SSS2.p7.3.m3.1.1.1.cmml" xref="S3.SS4.SSS2.p7.3.m3.1.1.1">^</ci><apply id="S3.SS4.SSS2.p7.3.m3.1.1.2.cmml" xref="S3.SS4.SSS2.p7.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p7.3.m3.1.1.2.1.cmml" xref="S3.SS4.SSS2.p7.3.m3.1.1.2">superscript</csymbol><ci id="S3.SS4.SSS2.p7.3.m3.1.1.2.2.cmml" xref="S3.SS4.SSS2.p7.3.m3.1.1.2.2">𝑀</ci><ci id="S3.SS4.SSS2.p7.3.m3.1.1.2.3.cmml" xref="S3.SS4.SSS2.p7.3.m3.1.1.2.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p7.3.m3.1c">\hat{M^{q}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p7.3.m3.1d">over^ start_ARG italic_M start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math> denotes the pseudo query mask while <math alttext="M_{s}" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p7.4.m4.1"><semantics id="S3.SS4.SSS2.p7.4.m4.1a"><msub id="S3.SS4.SSS2.p7.4.m4.1.1" xref="S3.SS4.SSS2.p7.4.m4.1.1.cmml"><mi id="S3.SS4.SSS2.p7.4.m4.1.1.2" xref="S3.SS4.SSS2.p7.4.m4.1.1.2.cmml">M</mi><mi id="S3.SS4.SSS2.p7.4.m4.1.1.3" xref="S3.SS4.SSS2.p7.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p7.4.m4.1b"><apply id="S3.SS4.SSS2.p7.4.m4.1.1.cmml" xref="S3.SS4.SSS2.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p7.4.m4.1.1.1.cmml" xref="S3.SS4.SSS2.p7.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.SSS2.p7.4.m4.1.1.2.cmml" xref="S3.SS4.SSS2.p7.4.m4.1.1.2">𝑀</ci><ci id="S3.SS4.SSS2.p7.4.m4.1.1.3.cmml" xref="S3.SS4.SSS2.p7.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p7.4.m4.1c">M_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p7.4.m4.1d">italic_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> denotes the support mask. <math alttext="\widetilde{P}^{*}(\widetilde{B}^{*})" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p7.5.m5.1"><semantics id="S3.SS4.SSS2.p7.5.m5.1a"><mrow id="S3.SS4.SSS2.p7.5.m5.1.1" xref="S3.SS4.SSS2.p7.5.m5.1.1.cmml"><msup id="S3.SS4.SSS2.p7.5.m5.1.1.3" xref="S3.SS4.SSS2.p7.5.m5.1.1.3.cmml"><mover accent="true" id="S3.SS4.SSS2.p7.5.m5.1.1.3.2" xref="S3.SS4.SSS2.p7.5.m5.1.1.3.2.cmml"><mi id="S3.SS4.SSS2.p7.5.m5.1.1.3.2.2" xref="S3.SS4.SSS2.p7.5.m5.1.1.3.2.2.cmml">P</mi><mo id="S3.SS4.SSS2.p7.5.m5.1.1.3.2.1" xref="S3.SS4.SSS2.p7.5.m5.1.1.3.2.1.cmml">~</mo></mover><mo id="S3.SS4.SSS2.p7.5.m5.1.1.3.3" xref="S3.SS4.SSS2.p7.5.m5.1.1.3.3.cmml">∗</mo></msup><mo id="S3.SS4.SSS2.p7.5.m5.1.1.2" xref="S3.SS4.SSS2.p7.5.m5.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS2.p7.5.m5.1.1.1.1" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.2" stretchy="false" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.cmml">(</mo><msup id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2.cmml"><mi id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2.2" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2.2.cmml">B</mi><mo id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2.1" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2.1.cmml">~</mo></mover><mo id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.3" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.3" stretchy="false" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p7.5.m5.1b"><apply id="S3.SS4.SSS2.p7.5.m5.1.1.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1"><times id="S3.SS4.SSS2.p7.5.m5.1.1.2.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.2"></times><apply id="S3.SS4.SSS2.p7.5.m5.1.1.3.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p7.5.m5.1.1.3.1.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.3">superscript</csymbol><apply id="S3.SS4.SSS2.p7.5.m5.1.1.3.2.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.3.2"><ci id="S3.SS4.SSS2.p7.5.m5.1.1.3.2.1.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.3.2.1">~</ci><ci id="S3.SS4.SSS2.p7.5.m5.1.1.3.2.2.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.3.2.2">𝑃</ci></apply><times id="S3.SS4.SSS2.p7.5.m5.1.1.3.3.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.3.3"></times></apply><apply id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1">superscript</csymbol><apply id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2"><ci id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2.1">~</ci><ci id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.2.2">𝐵</ci></apply><times id="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS2.p7.5.m5.1.1.1.1.1.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p7.5.m5.1c">\widetilde{P}^{*}(\widetilde{B}^{*})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p7.5.m5.1d">over~ start_ARG italic_P end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( over~ start_ARG italic_B end_ARG start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT )</annotation></semantics></math> denotes the enhanced FG-prompts (BG-prompts). Notably, given that deep features are more class-specific, we choose to perform Prompt Enhancement in the last <math alttext="L" class="ltx_Math" display="inline" id="S3.SS4.SSS2.p7.6.m6.1"><semantics id="S3.SS4.SSS2.p7.6.m6.1a"><mi id="S3.SS4.SSS2.p7.6.m6.1.1" xref="S3.SS4.SSS2.p7.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS2.p7.6.m6.1b"><ci id="S3.SS4.SSS2.p7.6.m6.1.1.cmml" xref="S3.SS4.SSS2.p7.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS2.p7.6.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS2.p7.6.m6.1d">italic_L</annotation></semantics></math> blocks of the encoder.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span><span class="ltx_text ltx_font_italic" id="S3.SS5.1.1">Prompting</span>
</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.7">After the Prompt Enhancement via Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E9" title="In 3.4.2 Semantic Prompt Transfer (SPT) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">9</span></a>), the enhanced FG-prompts and BG-prompts will interact with image features in the next encoder blocks. Given the similarity of image-level background information <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib75" title="">75</a>]</cite>, e.g., the ”airplane” tends to appear in the air and the ”ship” appears in the sea, we synchronize the support BG-prompts and query BG-prompts to generate generic BG-prompts. On the other hand, given the image-specific nature of the part-level semantics, FG-prompts interact with the corresponding image features independently without synchronization. The whole process of prompting can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}B_{n-1}&amp;=\left(B_{n-1}^{q}+B_{n-1}^{s}\right)/2\\
\left[X_{n}^{q};{P_{n}^{q}};{B_{n}^{q}}\right]&amp;=E_{n}\left(\left[X_{n-1}^{q};P%
_{n-1}^{q};B_{n-1}\right]\right)\\
\left[X_{n}^{s};{P_{n}^{s}};{B_{n}^{s}}\right]&amp;=E_{n}\left(\left[X_{n-1}^{s};P%
_{n-1}^{s};B_{n-1}\right]\right)\end{split}" class="ltx_Math" display="block" id="S3.E10.m1.92"><semantics id="S3.E10.m1.92a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E10.m1.92.92.18" rowspacing="0pt" xref="S3.E10.m1.83.83.9.cmml"><mtr id="S3.E10.m1.92.92.18a" xref="S3.E10.m1.83.83.9.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E10.m1.92.92.18b" xref="S3.E10.m1.83.83.9.cmml"><msub id="S3.E10.m1.2.2.2.2.2" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml">B</mi><mrow id="S3.E10.m1.2.2.2.2.2.2.1" xref="S3.E10.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.1.2" xref="S3.E10.m1.2.2.2.2.2.2.1.2.cmml">n</mi><mo id="S3.E10.m1.2.2.2.2.2.2.1.1" xref="S3.E10.m1.2.2.2.2.2.2.1.1.cmml">−</mo><mn id="S3.E10.m1.2.2.2.2.2.2.1.3" xref="S3.E10.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.92.92.18c" xref="S3.E10.m1.83.83.9.cmml"><mrow id="S3.E10.m1.84.84.10.75.15.13" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.84.84.10.75.15.13.14" xref="S3.E10.m1.83.83.9a.cmml"></mi><mo id="S3.E10.m1.3.3.3.3.1.1" xref="S3.E10.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S3.E10.m1.84.84.10.75.15.13.13" xref="S3.E10.m1.83.83.9.cmml"><mrow id="S3.E10.m1.84.84.10.75.15.13.13.1.1" xref="S3.E10.m1.83.83.9.cmml"><mo id="S3.E10.m1.4.4.4.4.2.2" xref="S3.E10.m1.83.83.9a.cmml">(</mo><mrow id="S3.E10.m1.84.84.10.75.15.13.13.1.1.1" xref="S3.E10.m1.83.83.9.cmml"><msubsup id="S3.E10.m1.84.84.10.75.15.13.13.1.1.1.1" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.5.5.5.5.3.3" xref="S3.E10.m1.5.5.5.5.3.3.cmml">B</mi><mrow id="S3.E10.m1.6.6.6.6.4.4.1" xref="S3.E10.m1.6.6.6.6.4.4.1.cmml"><mi id="S3.E10.m1.6.6.6.6.4.4.1.2" xref="S3.E10.m1.6.6.6.6.4.4.1.2.cmml">n</mi><mo id="S3.E10.m1.6.6.6.6.4.4.1.1" xref="S3.E10.m1.6.6.6.6.4.4.1.1.cmml">−</mo><mn id="S3.E10.m1.6.6.6.6.4.4.1.3" xref="S3.E10.m1.6.6.6.6.4.4.1.3.cmml">1</mn></mrow><mi id="S3.E10.m1.7.7.7.7.5.5.1" xref="S3.E10.m1.7.7.7.7.5.5.1.cmml">q</mi></msubsup><mo id="S3.E10.m1.8.8.8.8.6.6" xref="S3.E10.m1.8.8.8.8.6.6.cmml">+</mo><msubsup id="S3.E10.m1.84.84.10.75.15.13.13.1.1.1.2" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.9.9.9.9.7.7" xref="S3.E10.m1.9.9.9.9.7.7.cmml">B</mi><mrow id="S3.E10.m1.10.10.10.10.8.8.1" xref="S3.E10.m1.10.10.10.10.8.8.1.cmml"><mi id="S3.E10.m1.10.10.10.10.8.8.1.2" xref="S3.E10.m1.10.10.10.10.8.8.1.2.cmml">n</mi><mo id="S3.E10.m1.10.10.10.10.8.8.1.1" xref="S3.E10.m1.10.10.10.10.8.8.1.1.cmml">−</mo><mn id="S3.E10.m1.10.10.10.10.8.8.1.3" xref="S3.E10.m1.10.10.10.10.8.8.1.3.cmml">1</mn></mrow><mi id="S3.E10.m1.11.11.11.11.9.9.1" xref="S3.E10.m1.11.11.11.11.9.9.1.cmml">s</mi></msubsup></mrow><mo id="S3.E10.m1.12.12.12.12.10.10" xref="S3.E10.m1.83.83.9a.cmml">)</mo></mrow><mo id="S3.E10.m1.13.13.13.13.11.11" xref="S3.E10.m1.13.13.13.13.11.11.cmml">/</mo><mn id="S3.E10.m1.14.14.14.14.12.12" xref="S3.E10.m1.14.14.14.14.12.12.cmml">2</mn></mrow></mrow></mtd></mtr><mtr id="S3.E10.m1.92.92.18d" xref="S3.E10.m1.83.83.9.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E10.m1.92.92.18e" xref="S3.E10.m1.83.83.9.cmml"><mrow id="S3.E10.m1.87.87.13.78.33.16.16" xref="S3.E10.m1.83.83.9.cmml"><mo id="S3.E10.m1.15.15.15.1.1.1" xref="S3.E10.m1.83.83.9a.cmml">[</mo><msubsup id="S3.E10.m1.85.85.11.76.31.14.14.1" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.16.16.16.2.2.2" xref="S3.E10.m1.16.16.16.2.2.2.cmml">X</mi><mi id="S3.E10.m1.17.17.17.3.3.3.1" xref="S3.E10.m1.17.17.17.3.3.3.1.cmml">n</mi><mi id="S3.E10.m1.18.18.18.4.4.4.1" xref="S3.E10.m1.18.18.18.4.4.4.1.cmml">q</mi></msubsup><mo id="S3.E10.m1.19.19.19.5.5.5" xref="S3.E10.m1.83.83.9a.cmml">;</mo><msubsup id="S3.E10.m1.86.86.12.77.32.15.15.2" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.20.20.20.6.6.6" xref="S3.E10.m1.20.20.20.6.6.6.cmml">P</mi><mi id="S3.E10.m1.21.21.21.7.7.7.1" xref="S3.E10.m1.21.21.21.7.7.7.1.cmml">n</mi><mi id="S3.E10.m1.22.22.22.8.8.8.1" xref="S3.E10.m1.22.22.22.8.8.8.1.cmml">q</mi></msubsup><mo id="S3.E10.m1.23.23.23.9.9.9" xref="S3.E10.m1.83.83.9a.cmml">;</mo><msubsup id="S3.E10.m1.87.87.13.78.33.16.16.3" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.24.24.24.10.10.10" xref="S3.E10.m1.24.24.24.10.10.10.cmml">B</mi><mi id="S3.E10.m1.25.25.25.11.11.11.1" xref="S3.E10.m1.25.25.25.11.11.11.1.cmml">n</mi><mi id="S3.E10.m1.26.26.26.12.12.12.1" xref="S3.E10.m1.26.26.26.12.12.12.1.cmml">q</mi></msubsup><mo id="S3.E10.m1.27.27.27.13.13.13" xref="S3.E10.m1.83.83.9a.cmml">]</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.92.92.18f" xref="S3.E10.m1.83.83.9.cmml"><mrow id="S3.E10.m1.88.88.14.79.34.18" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.88.88.14.79.34.18.19" xref="S3.E10.m1.83.83.9a.cmml"></mi><mo id="S3.E10.m1.28.28.28.14.1.1" xref="S3.E10.m1.28.28.28.14.1.1.cmml">=</mo><mrow id="S3.E10.m1.88.88.14.79.34.18.18" xref="S3.E10.m1.83.83.9.cmml"><msub id="S3.E10.m1.88.88.14.79.34.18.18.3" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.29.29.29.15.2.2" xref="S3.E10.m1.29.29.29.15.2.2.cmml">E</mi><mi id="S3.E10.m1.30.30.30.16.3.3.1" xref="S3.E10.m1.30.30.30.16.3.3.1.cmml">n</mi></msub><mo id="S3.E10.m1.88.88.14.79.34.18.18.2" xref="S3.E10.m1.83.83.9a.cmml">⁢</mo><mrow id="S3.E10.m1.88.88.14.79.34.18.18.1.1" xref="S3.E10.m1.83.83.9.cmml"><mo id="S3.E10.m1.31.31.31.17.4.4" xref="S3.E10.m1.83.83.9a.cmml">(</mo><mrow id="S3.E10.m1.88.88.14.79.34.18.18.1.1.1" xref="S3.E10.m1.83.83.9.cmml"><mo id="S3.E10.m1.32.32.32.18.5.5" xref="S3.E10.m1.83.83.9a.cmml">[</mo><msubsup id="S3.E10.m1.88.88.14.79.34.18.18.1.1.1.1.1" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.33.33.33.19.6.6" xref="S3.E10.m1.33.33.33.19.6.6.cmml">X</mi><mrow id="S3.E10.m1.34.34.34.20.7.7.1" xref="S3.E10.m1.34.34.34.20.7.7.1.cmml"><mi id="S3.E10.m1.34.34.34.20.7.7.1.2" xref="S3.E10.m1.34.34.34.20.7.7.1.2.cmml">n</mi><mo id="S3.E10.m1.34.34.34.20.7.7.1.1" xref="S3.E10.m1.34.34.34.20.7.7.1.1.cmml">−</mo><mn id="S3.E10.m1.34.34.34.20.7.7.1.3" xref="S3.E10.m1.34.34.34.20.7.7.1.3.cmml">1</mn></mrow><mi id="S3.E10.m1.35.35.35.21.8.8.1" xref="S3.E10.m1.35.35.35.21.8.8.1.cmml">q</mi></msubsup><mo id="S3.E10.m1.36.36.36.22.9.9" xref="S3.E10.m1.83.83.9a.cmml">;</mo><msubsup id="S3.E10.m1.88.88.14.79.34.18.18.1.1.1.2.2" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.37.37.37.23.10.10" xref="S3.E10.m1.37.37.37.23.10.10.cmml">P</mi><mrow id="S3.E10.m1.38.38.38.24.11.11.1" xref="S3.E10.m1.38.38.38.24.11.11.1.cmml"><mi id="S3.E10.m1.38.38.38.24.11.11.1.2" xref="S3.E10.m1.38.38.38.24.11.11.1.2.cmml">n</mi><mo id="S3.E10.m1.38.38.38.24.11.11.1.1" xref="S3.E10.m1.38.38.38.24.11.11.1.1.cmml">−</mo><mn id="S3.E10.m1.38.38.38.24.11.11.1.3" xref="S3.E10.m1.38.38.38.24.11.11.1.3.cmml">1</mn></mrow><mi id="S3.E10.m1.39.39.39.25.12.12.1" xref="S3.E10.m1.39.39.39.25.12.12.1.cmml">q</mi></msubsup><mo id="S3.E10.m1.40.40.40.26.13.13" xref="S3.E10.m1.83.83.9a.cmml">;</mo><msub id="S3.E10.m1.88.88.14.79.34.18.18.1.1.1.3.3" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.41.41.41.27.14.14" xref="S3.E10.m1.41.41.41.27.14.14.cmml">B</mi><mrow id="S3.E10.m1.42.42.42.28.15.15.1" xref="S3.E10.m1.42.42.42.28.15.15.1.cmml"><mi id="S3.E10.m1.42.42.42.28.15.15.1.2" xref="S3.E10.m1.42.42.42.28.15.15.1.2.cmml">n</mi><mo id="S3.E10.m1.42.42.42.28.15.15.1.1" xref="S3.E10.m1.42.42.42.28.15.15.1.1.cmml">−</mo><mn id="S3.E10.m1.42.42.42.28.15.15.1.3" xref="S3.E10.m1.42.42.42.28.15.15.1.3.cmml">1</mn></mrow></msub><mo id="S3.E10.m1.43.43.43.29.16.16" xref="S3.E10.m1.83.83.9a.cmml">]</mo></mrow><mo id="S3.E10.m1.44.44.44.30.17.17" xref="S3.E10.m1.83.83.9a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E10.m1.92.92.18g" xref="S3.E10.m1.83.83.9.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E10.m1.92.92.18h" xref="S3.E10.m1.83.83.9.cmml"><mrow id="S3.E10.m1.91.91.17.82.33.16.16" xref="S3.E10.m1.83.83.9.cmml"><mo id="S3.E10.m1.45.45.45.1.1.1" xref="S3.E10.m1.83.83.9a.cmml">[</mo><msubsup id="S3.E10.m1.89.89.15.80.31.14.14.1" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.46.46.46.2.2.2" xref="S3.E10.m1.46.46.46.2.2.2.cmml">X</mi><mi id="S3.E10.m1.47.47.47.3.3.3.1" xref="S3.E10.m1.47.47.47.3.3.3.1.cmml">n</mi><mi id="S3.E10.m1.48.48.48.4.4.4.1" xref="S3.E10.m1.48.48.48.4.4.4.1.cmml">s</mi></msubsup><mo id="S3.E10.m1.49.49.49.5.5.5" xref="S3.E10.m1.83.83.9a.cmml">;</mo><msubsup id="S3.E10.m1.90.90.16.81.32.15.15.2" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.50.50.50.6.6.6" xref="S3.E10.m1.50.50.50.6.6.6.cmml">P</mi><mi id="S3.E10.m1.51.51.51.7.7.7.1" xref="S3.E10.m1.51.51.51.7.7.7.1.cmml">n</mi><mi id="S3.E10.m1.52.52.52.8.8.8.1" xref="S3.E10.m1.52.52.52.8.8.8.1.cmml">s</mi></msubsup><mo id="S3.E10.m1.53.53.53.9.9.9" xref="S3.E10.m1.83.83.9a.cmml">;</mo><msubsup id="S3.E10.m1.91.91.17.82.33.16.16.3" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.54.54.54.10.10.10" xref="S3.E10.m1.54.54.54.10.10.10.cmml">B</mi><mi id="S3.E10.m1.55.55.55.11.11.11.1" xref="S3.E10.m1.55.55.55.11.11.11.1.cmml">n</mi><mi id="S3.E10.m1.56.56.56.12.12.12.1" xref="S3.E10.m1.56.56.56.12.12.12.1.cmml">s</mi></msubsup><mo id="S3.E10.m1.57.57.57.13.13.13" xref="S3.E10.m1.83.83.9a.cmml">]</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.92.92.18i" xref="S3.E10.m1.83.83.9.cmml"><mrow id="S3.E10.m1.92.92.18.83.34.18" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.92.92.18.83.34.18.19" xref="S3.E10.m1.83.83.9a.cmml"></mi><mo id="S3.E10.m1.58.58.58.14.1.1" xref="S3.E10.m1.58.58.58.14.1.1.cmml">=</mo><mrow id="S3.E10.m1.92.92.18.83.34.18.18" xref="S3.E10.m1.83.83.9.cmml"><msub id="S3.E10.m1.92.92.18.83.34.18.18.3" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.59.59.59.15.2.2" xref="S3.E10.m1.59.59.59.15.2.2.cmml">E</mi><mi id="S3.E10.m1.60.60.60.16.3.3.1" xref="S3.E10.m1.60.60.60.16.3.3.1.cmml">n</mi></msub><mo id="S3.E10.m1.92.92.18.83.34.18.18.2" xref="S3.E10.m1.83.83.9a.cmml">⁢</mo><mrow id="S3.E10.m1.92.92.18.83.34.18.18.1.1" xref="S3.E10.m1.83.83.9.cmml"><mo id="S3.E10.m1.61.61.61.17.4.4" xref="S3.E10.m1.83.83.9a.cmml">(</mo><mrow id="S3.E10.m1.92.92.18.83.34.18.18.1.1.1" xref="S3.E10.m1.83.83.9.cmml"><mo id="S3.E10.m1.62.62.62.18.5.5" xref="S3.E10.m1.83.83.9a.cmml">[</mo><msubsup id="S3.E10.m1.92.92.18.83.34.18.18.1.1.1.1.1" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.63.63.63.19.6.6" xref="S3.E10.m1.63.63.63.19.6.6.cmml">X</mi><mrow id="S3.E10.m1.64.64.64.20.7.7.1" xref="S3.E10.m1.64.64.64.20.7.7.1.cmml"><mi id="S3.E10.m1.64.64.64.20.7.7.1.2" xref="S3.E10.m1.64.64.64.20.7.7.1.2.cmml">n</mi><mo id="S3.E10.m1.64.64.64.20.7.7.1.1" xref="S3.E10.m1.64.64.64.20.7.7.1.1.cmml">−</mo><mn id="S3.E10.m1.64.64.64.20.7.7.1.3" xref="S3.E10.m1.64.64.64.20.7.7.1.3.cmml">1</mn></mrow><mi id="S3.E10.m1.65.65.65.21.8.8.1" xref="S3.E10.m1.65.65.65.21.8.8.1.cmml">s</mi></msubsup><mo id="S3.E10.m1.66.66.66.22.9.9" xref="S3.E10.m1.83.83.9a.cmml">;</mo><msubsup id="S3.E10.m1.92.92.18.83.34.18.18.1.1.1.2.2" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.67.67.67.23.10.10" xref="S3.E10.m1.67.67.67.23.10.10.cmml">P</mi><mrow id="S3.E10.m1.68.68.68.24.11.11.1" xref="S3.E10.m1.68.68.68.24.11.11.1.cmml"><mi id="S3.E10.m1.68.68.68.24.11.11.1.2" xref="S3.E10.m1.68.68.68.24.11.11.1.2.cmml">n</mi><mo id="S3.E10.m1.68.68.68.24.11.11.1.1" xref="S3.E10.m1.68.68.68.24.11.11.1.1.cmml">−</mo><mn id="S3.E10.m1.68.68.68.24.11.11.1.3" xref="S3.E10.m1.68.68.68.24.11.11.1.3.cmml">1</mn></mrow><mi id="S3.E10.m1.69.69.69.25.12.12.1" xref="S3.E10.m1.69.69.69.25.12.12.1.cmml">s</mi></msubsup><mo id="S3.E10.m1.70.70.70.26.13.13" xref="S3.E10.m1.83.83.9a.cmml">;</mo><msub id="S3.E10.m1.92.92.18.83.34.18.18.1.1.1.3.3" xref="S3.E10.m1.83.83.9.cmml"><mi id="S3.E10.m1.71.71.71.27.14.14" xref="S3.E10.m1.71.71.71.27.14.14.cmml">B</mi><mrow id="S3.E10.m1.72.72.72.28.15.15.1" xref="S3.E10.m1.72.72.72.28.15.15.1.cmml"><mi id="S3.E10.m1.72.72.72.28.15.15.1.2" xref="S3.E10.m1.72.72.72.28.15.15.1.2.cmml">n</mi><mo id="S3.E10.m1.72.72.72.28.15.15.1.1" xref="S3.E10.m1.72.72.72.28.15.15.1.1.cmml">−</mo><mn id="S3.E10.m1.72.72.72.28.15.15.1.3" xref="S3.E10.m1.72.72.72.28.15.15.1.3.cmml">1</mn></mrow></msub><mo id="S3.E10.m1.73.73.73.29.16.16" xref="S3.E10.m1.83.83.9a.cmml">]</mo></mrow><mo id="S3.E10.m1.74.74.74.30.17.17" xref="S3.E10.m1.83.83.9a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E10.m1.92b"><apply id="S3.E10.m1.83.83.9.cmml" xref="S3.E10.m1.92.92.18"><and id="S3.E10.m1.83.83.9a.cmml" xref="S3.E10.m1.84.84.10.75.15.13.14"></and><apply id="S3.E10.m1.83.83.9b.cmml" xref="S3.E10.m1.92.92.18"><eq id="S3.E10.m1.3.3.3.3.1.1.cmml" xref="S3.E10.m1.3.3.3.3.1.1"></eq><apply id="S3.E10.m1.83.83.9.11.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.83.83.9.11.1.cmml" xref="S3.E10.m1.84.84.10.75.15.13.14">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1">𝐵</ci><apply id="S3.E10.m1.2.2.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1"><minus id="S3.E10.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1"></minus><ci id="S3.E10.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.2">𝑛</ci><cn id="S3.E10.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S3.E10.m1.2.2.2.2.2.2.1.3">1</cn></apply></apply><apply id="S3.E10.m1.78.78.4.4.cmml" xref="S3.E10.m1.92.92.18"><times id="S3.E10.m1.78.78.4.4.5.cmml" xref="S3.E10.m1.84.84.10.75.15.13.14"></times><apply id="S3.E10.m1.75.75.1.1.1.cmml" xref="S3.E10.m1.92.92.18"><divide id="S3.E10.m1.13.13.13.13.11.11.cmml" xref="S3.E10.m1.13.13.13.13.11.11"></divide><apply id="S3.E10.m1.75.75.1.1.1.1.1.1.cmml" xref="S3.E10.m1.92.92.18"><plus id="S3.E10.m1.8.8.8.8.6.6.cmml" xref="S3.E10.m1.8.8.8.8.6.6"></plus><apply id="S3.E10.m1.75.75.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.75.75.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.75.75.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.75.75.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.5.5.5.5.3.3.cmml" xref="S3.E10.m1.5.5.5.5.3.3">𝐵</ci><apply id="S3.E10.m1.6.6.6.6.4.4.1.cmml" xref="S3.E10.m1.6.6.6.6.4.4.1"><minus id="S3.E10.m1.6.6.6.6.4.4.1.1.cmml" xref="S3.E10.m1.6.6.6.6.4.4.1.1"></minus><ci id="S3.E10.m1.6.6.6.6.4.4.1.2.cmml" xref="S3.E10.m1.6.6.6.6.4.4.1.2">𝑛</ci><cn id="S3.E10.m1.6.6.6.6.4.4.1.3.cmml" type="integer" xref="S3.E10.m1.6.6.6.6.4.4.1.3">1</cn></apply></apply><ci id="S3.E10.m1.7.7.7.7.5.5.1.cmml" xref="S3.E10.m1.7.7.7.7.5.5.1">𝑞</ci></apply><apply id="S3.E10.m1.75.75.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.75.75.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.75.75.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.75.75.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.9.9.9.9.7.7.cmml" xref="S3.E10.m1.9.9.9.9.7.7">𝐵</ci><apply id="S3.E10.m1.10.10.10.10.8.8.1.cmml" xref="S3.E10.m1.10.10.10.10.8.8.1"><minus id="S3.E10.m1.10.10.10.10.8.8.1.1.cmml" xref="S3.E10.m1.10.10.10.10.8.8.1.1"></minus><ci id="S3.E10.m1.10.10.10.10.8.8.1.2.cmml" xref="S3.E10.m1.10.10.10.10.8.8.1.2">𝑛</ci><cn id="S3.E10.m1.10.10.10.10.8.8.1.3.cmml" type="integer" xref="S3.E10.m1.10.10.10.10.8.8.1.3">1</cn></apply></apply><ci id="S3.E10.m1.11.11.11.11.9.9.1.cmml" xref="S3.E10.m1.11.11.11.11.9.9.1">𝑠</ci></apply></apply><cn id="S3.E10.m1.14.14.14.14.12.12.cmml" type="integer" xref="S3.E10.m1.14.14.14.14.12.12">2</cn></apply><list id="S3.E10.m1.78.78.4.4.4.4.cmml" xref="S3.E10.m1.92.92.18"><apply id="S3.E10.m1.76.76.2.2.2.1.1.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.76.76.2.2.2.1.1.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.76.76.2.2.2.1.1.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.76.76.2.2.2.1.1.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.16.16.16.2.2.2.cmml" xref="S3.E10.m1.16.16.16.2.2.2">𝑋</ci><ci id="S3.E10.m1.17.17.17.3.3.3.1.cmml" xref="S3.E10.m1.17.17.17.3.3.3.1">𝑛</ci></apply><ci id="S3.E10.m1.18.18.18.4.4.4.1.cmml" xref="S3.E10.m1.18.18.18.4.4.4.1">𝑞</ci></apply><apply id="S3.E10.m1.77.77.3.3.3.2.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.77.77.3.3.3.2.2.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.77.77.3.3.3.2.2.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.77.77.3.3.3.2.2.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.20.20.20.6.6.6.cmml" xref="S3.E10.m1.20.20.20.6.6.6">𝑃</ci><ci id="S3.E10.m1.21.21.21.7.7.7.1.cmml" xref="S3.E10.m1.21.21.21.7.7.7.1">𝑛</ci></apply><ci id="S3.E10.m1.22.22.22.8.8.8.1.cmml" xref="S3.E10.m1.22.22.22.8.8.8.1">𝑞</ci></apply><apply id="S3.E10.m1.78.78.4.4.4.3.3.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.78.78.4.4.4.3.3.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.78.78.4.4.4.3.3.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.78.78.4.4.4.3.3.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.24.24.24.10.10.10.cmml" xref="S3.E10.m1.24.24.24.10.10.10">𝐵</ci><ci id="S3.E10.m1.25.25.25.11.11.11.1.cmml" xref="S3.E10.m1.25.25.25.11.11.11.1">𝑛</ci></apply><ci id="S3.E10.m1.26.26.26.12.12.12.1.cmml" xref="S3.E10.m1.26.26.26.12.12.12.1">𝑞</ci></apply></list></apply></apply><apply id="S3.E10.m1.83.83.9c.cmml" xref="S3.E10.m1.92.92.18"><eq id="S3.E10.m1.28.28.28.14.1.1.cmml" xref="S3.E10.m1.28.28.28.14.1.1"></eq><share href="https://arxiv.org/html/2409.10389v1#S3.E10.m1.78.78.4.4.cmml" id="S3.E10.m1.83.83.9d.cmml" xref="S3.E10.m1.84.84.10.75.15.13.14"></share><apply id="S3.E10.m1.82.82.8.8.cmml" xref="S3.E10.m1.92.92.18"><times id="S3.E10.m1.82.82.8.8.5.cmml" xref="S3.E10.m1.84.84.10.75.15.13.14"></times><apply id="S3.E10.m1.82.82.8.8.6.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.82.82.8.8.6.1.cmml" xref="S3.E10.m1.84.84.10.75.15.13.14">subscript</csymbol><ci id="S3.E10.m1.29.29.29.15.2.2.cmml" xref="S3.E10.m1.29.29.29.15.2.2">𝐸</ci><ci id="S3.E10.m1.30.30.30.16.3.3.1.cmml" xref="S3.E10.m1.30.30.30.16.3.3.1">𝑛</ci></apply><list id="S3.E10.m1.79.79.5.5.1.1.1.4.cmml" xref="S3.E10.m1.92.92.18"><apply id="S3.E10.m1.79.79.5.5.1.1.1.1.1.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.79.79.5.5.1.1.1.1.1.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.79.79.5.5.1.1.1.1.1.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.79.79.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.33.33.33.19.6.6.cmml" xref="S3.E10.m1.33.33.33.19.6.6">𝑋</ci><apply id="S3.E10.m1.34.34.34.20.7.7.1.cmml" xref="S3.E10.m1.34.34.34.20.7.7.1"><minus id="S3.E10.m1.34.34.34.20.7.7.1.1.cmml" xref="S3.E10.m1.34.34.34.20.7.7.1.1"></minus><ci id="S3.E10.m1.34.34.34.20.7.7.1.2.cmml" xref="S3.E10.m1.34.34.34.20.7.7.1.2">𝑛</ci><cn id="S3.E10.m1.34.34.34.20.7.7.1.3.cmml" type="integer" xref="S3.E10.m1.34.34.34.20.7.7.1.3">1</cn></apply></apply><ci id="S3.E10.m1.35.35.35.21.8.8.1.cmml" xref="S3.E10.m1.35.35.35.21.8.8.1">𝑞</ci></apply><apply id="S3.E10.m1.79.79.5.5.1.1.1.2.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.79.79.5.5.1.1.1.2.2.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.79.79.5.5.1.1.1.2.2.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.79.79.5.5.1.1.1.2.2.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.37.37.37.23.10.10.cmml" xref="S3.E10.m1.37.37.37.23.10.10">𝑃</ci><apply id="S3.E10.m1.38.38.38.24.11.11.1.cmml" xref="S3.E10.m1.38.38.38.24.11.11.1"><minus id="S3.E10.m1.38.38.38.24.11.11.1.1.cmml" xref="S3.E10.m1.38.38.38.24.11.11.1.1"></minus><ci id="S3.E10.m1.38.38.38.24.11.11.1.2.cmml" xref="S3.E10.m1.38.38.38.24.11.11.1.2">𝑛</ci><cn id="S3.E10.m1.38.38.38.24.11.11.1.3.cmml" type="integer" xref="S3.E10.m1.38.38.38.24.11.11.1.3">1</cn></apply></apply><ci id="S3.E10.m1.39.39.39.25.12.12.1.cmml" xref="S3.E10.m1.39.39.39.25.12.12.1">𝑞</ci></apply><apply id="S3.E10.m1.79.79.5.5.1.1.1.3.3.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.79.79.5.5.1.1.1.3.3.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.41.41.41.27.14.14.cmml" xref="S3.E10.m1.41.41.41.27.14.14">𝐵</ci><apply id="S3.E10.m1.42.42.42.28.15.15.1.cmml" xref="S3.E10.m1.42.42.42.28.15.15.1"><minus id="S3.E10.m1.42.42.42.28.15.15.1.1.cmml" xref="S3.E10.m1.42.42.42.28.15.15.1.1"></minus><ci id="S3.E10.m1.42.42.42.28.15.15.1.2.cmml" xref="S3.E10.m1.42.42.42.28.15.15.1.2">𝑛</ci><cn id="S3.E10.m1.42.42.42.28.15.15.1.3.cmml" type="integer" xref="S3.E10.m1.42.42.42.28.15.15.1.3">1</cn></apply></apply></list><list id="S3.E10.m1.82.82.8.8.4.4.cmml" xref="S3.E10.m1.92.92.18"><apply id="S3.E10.m1.80.80.6.6.2.1.1.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.80.80.6.6.2.1.1.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.80.80.6.6.2.1.1.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.80.80.6.6.2.1.1.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.46.46.46.2.2.2.cmml" xref="S3.E10.m1.46.46.46.2.2.2">𝑋</ci><ci id="S3.E10.m1.47.47.47.3.3.3.1.cmml" xref="S3.E10.m1.47.47.47.3.3.3.1">𝑛</ci></apply><ci id="S3.E10.m1.48.48.48.4.4.4.1.cmml" xref="S3.E10.m1.48.48.48.4.4.4.1">𝑠</ci></apply><apply id="S3.E10.m1.81.81.7.7.3.2.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.81.81.7.7.3.2.2.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.81.81.7.7.3.2.2.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.81.81.7.7.3.2.2.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.50.50.50.6.6.6.cmml" xref="S3.E10.m1.50.50.50.6.6.6">𝑃</ci><ci id="S3.E10.m1.51.51.51.7.7.7.1.cmml" xref="S3.E10.m1.51.51.51.7.7.7.1">𝑛</ci></apply><ci id="S3.E10.m1.52.52.52.8.8.8.1.cmml" xref="S3.E10.m1.52.52.52.8.8.8.1">𝑠</ci></apply><apply id="S3.E10.m1.82.82.8.8.4.3.3.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.82.82.8.8.4.3.3.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.82.82.8.8.4.3.3.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.82.82.8.8.4.3.3.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.54.54.54.10.10.10.cmml" xref="S3.E10.m1.54.54.54.10.10.10">𝐵</ci><ci id="S3.E10.m1.55.55.55.11.11.11.1.cmml" xref="S3.E10.m1.55.55.55.11.11.11.1">𝑛</ci></apply><ci id="S3.E10.m1.56.56.56.12.12.12.1.cmml" xref="S3.E10.m1.56.56.56.12.12.12.1">𝑠</ci></apply></list></apply></apply><apply id="S3.E10.m1.83.83.9e.cmml" xref="S3.E10.m1.92.92.18"><eq id="S3.E10.m1.58.58.58.14.1.1.cmml" xref="S3.E10.m1.58.58.58.14.1.1"></eq><share href="https://arxiv.org/html/2409.10389v1#S3.E10.m1.82.82.8.8.cmml" id="S3.E10.m1.83.83.9f.cmml" xref="S3.E10.m1.84.84.10.75.15.13.14"></share><apply id="S3.E10.m1.83.83.9.9.cmml" xref="S3.E10.m1.92.92.18"><times id="S3.E10.m1.83.83.9.9.2.cmml" xref="S3.E10.m1.84.84.10.75.15.13.14"></times><apply id="S3.E10.m1.83.83.9.9.3.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.83.83.9.9.3.1.cmml" xref="S3.E10.m1.84.84.10.75.15.13.14">subscript</csymbol><ci id="S3.E10.m1.59.59.59.15.2.2.cmml" xref="S3.E10.m1.59.59.59.15.2.2">𝐸</ci><ci id="S3.E10.m1.60.60.60.16.3.3.1.cmml" xref="S3.E10.m1.60.60.60.16.3.3.1">𝑛</ci></apply><list id="S3.E10.m1.83.83.9.9.1.1.1.4.cmml" xref="S3.E10.m1.92.92.18"><apply id="S3.E10.m1.83.83.9.9.1.1.1.1.1.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.83.83.9.9.1.1.1.1.1.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.83.83.9.9.1.1.1.1.1.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.83.83.9.9.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.63.63.63.19.6.6.cmml" xref="S3.E10.m1.63.63.63.19.6.6">𝑋</ci><apply id="S3.E10.m1.64.64.64.20.7.7.1.cmml" xref="S3.E10.m1.64.64.64.20.7.7.1"><minus id="S3.E10.m1.64.64.64.20.7.7.1.1.cmml" xref="S3.E10.m1.64.64.64.20.7.7.1.1"></minus><ci id="S3.E10.m1.64.64.64.20.7.7.1.2.cmml" xref="S3.E10.m1.64.64.64.20.7.7.1.2">𝑛</ci><cn id="S3.E10.m1.64.64.64.20.7.7.1.3.cmml" type="integer" xref="S3.E10.m1.64.64.64.20.7.7.1.3">1</cn></apply></apply><ci id="S3.E10.m1.65.65.65.21.8.8.1.cmml" xref="S3.E10.m1.65.65.65.21.8.8.1">𝑠</ci></apply><apply id="S3.E10.m1.83.83.9.9.1.1.1.2.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.83.83.9.9.1.1.1.2.2.1.cmml" xref="S3.E10.m1.92.92.18">superscript</csymbol><apply id="S3.E10.m1.83.83.9.9.1.1.1.2.2.2.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.83.83.9.9.1.1.1.2.2.2.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.67.67.67.23.10.10.cmml" xref="S3.E10.m1.67.67.67.23.10.10">𝑃</ci><apply id="S3.E10.m1.68.68.68.24.11.11.1.cmml" xref="S3.E10.m1.68.68.68.24.11.11.1"><minus id="S3.E10.m1.68.68.68.24.11.11.1.1.cmml" xref="S3.E10.m1.68.68.68.24.11.11.1.1"></minus><ci id="S3.E10.m1.68.68.68.24.11.11.1.2.cmml" xref="S3.E10.m1.68.68.68.24.11.11.1.2">𝑛</ci><cn id="S3.E10.m1.68.68.68.24.11.11.1.3.cmml" type="integer" xref="S3.E10.m1.68.68.68.24.11.11.1.3">1</cn></apply></apply><ci id="S3.E10.m1.69.69.69.25.12.12.1.cmml" xref="S3.E10.m1.69.69.69.25.12.12.1">𝑠</ci></apply><apply id="S3.E10.m1.83.83.9.9.1.1.1.3.3.cmml" xref="S3.E10.m1.92.92.18"><csymbol cd="ambiguous" id="S3.E10.m1.83.83.9.9.1.1.1.3.3.1.cmml" xref="S3.E10.m1.92.92.18">subscript</csymbol><ci id="S3.E10.m1.71.71.71.27.14.14.cmml" xref="S3.E10.m1.71.71.71.27.14.14">𝐵</ci><apply id="S3.E10.m1.72.72.72.28.15.15.1.cmml" xref="S3.E10.m1.72.72.72.28.15.15.1"><minus id="S3.E10.m1.72.72.72.28.15.15.1.1.cmml" xref="S3.E10.m1.72.72.72.28.15.15.1.1"></minus><ci id="S3.E10.m1.72.72.72.28.15.15.1.2.cmml" xref="S3.E10.m1.72.72.72.28.15.15.1.2">𝑛</ci><cn id="S3.E10.m1.72.72.72.28.15.15.1.3.cmml" type="integer" xref="S3.E10.m1.72.72.72.28.15.15.1.3">1</cn></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.92c">\begin{split}B_{n-1}&amp;=\left(B_{n-1}^{q}+B_{n-1}^{s}\right)/2\\
\left[X_{n}^{q};{P_{n}^{q}};{B_{n}^{q}}\right]&amp;=E_{n}\left(\left[X_{n-1}^{q};P%
_{n-1}^{q};B_{n-1}\right]\right)\\
\left[X_{n}^{s};{P_{n}^{s}};{B_{n}^{s}}\right]&amp;=E_{n}\left(\left[X_{n-1}^{s};P%
_{n-1}^{s};B_{n-1}\right]\right)\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.92d">start_ROW start_CELL italic_B start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT end_CELL start_CELL = ( italic_B start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + italic_B start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ) / 2 end_CELL end_ROW start_ROW start_CELL [ italic_X start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ; italic_P start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ; italic_B start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ] end_CELL start_CELL = italic_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( [ italic_X start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ; italic_P start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ; italic_B start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT ] ) end_CELL end_ROW start_ROW start_CELL [ italic_X start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ; italic_P start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ; italic_B start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ] end_CELL start_CELL = italic_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( [ italic_X start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ; italic_P start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ; italic_B start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT ] ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p1.6">where <math alttext="E_{n}" class="ltx_Math" display="inline" id="S3.SS5.p1.1.m1.1"><semantics id="S3.SS5.p1.1.m1.1a"><msub id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml"><mi id="S3.SS5.p1.1.m1.1.1.2" xref="S3.SS5.p1.1.m1.1.1.2.cmml">E</mi><mi id="S3.SS5.p1.1.m1.1.1.3" xref="S3.SS5.p1.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><apply id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p1.1.m1.1.1.2.cmml" xref="S3.SS5.p1.1.m1.1.1.2">𝐸</ci><ci id="S3.SS5.p1.1.m1.1.1.3.cmml" xref="S3.SS5.p1.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">E_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.1.m1.1d">italic_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> denotes the <math alttext="n" class="ltx_Math" display="inline" id="S3.SS5.p1.2.m2.1"><semantics id="S3.SS5.p1.2.m2.1a"><mi id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><ci id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.2.m2.1d">italic_n</annotation></semantics></math>-layer encoder block and <math alttext="\left[;\right]" class="ltx_math_unparsed" display="inline" id="S3.SS5.p1.3.m3.1"><semantics id="S3.SS5.p1.3.m3.1a"><mrow id="S3.SS5.p1.3.m3.1b"><mo id="S3.SS5.p1.3.m3.1.1">[</mo><mo id="S3.SS5.p1.3.m3.1.2">;</mo><mo id="S3.SS5.p1.3.m3.1.3">]</mo></mrow><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.1c">\left[;\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.3.m3.1d">[ ; ]</annotation></semantics></math> denotes the feature concatenate operation. <math alttext="\left[{P_{n}^{*}};{B_{n}^{*}}\right]" class="ltx_Math" display="inline" id="S3.SS5.p1.4.m4.2"><semantics id="S3.SS5.p1.4.m4.2a"><mrow id="S3.SS5.p1.4.m4.2.2.2" xref="S3.SS5.p1.4.m4.2.2.3.cmml"><mo id="S3.SS5.p1.4.m4.2.2.2.3" xref="S3.SS5.p1.4.m4.2.2.3.cmml">[</mo><msubsup id="S3.SS5.p1.4.m4.1.1.1.1" xref="S3.SS5.p1.4.m4.1.1.1.1.cmml"><mi id="S3.SS5.p1.4.m4.1.1.1.1.2.2" xref="S3.SS5.p1.4.m4.1.1.1.1.2.2.cmml">P</mi><mi id="S3.SS5.p1.4.m4.1.1.1.1.2.3" xref="S3.SS5.p1.4.m4.1.1.1.1.2.3.cmml">n</mi><mo id="S3.SS5.p1.4.m4.1.1.1.1.3" xref="S3.SS5.p1.4.m4.1.1.1.1.3.cmml">∗</mo></msubsup><mo id="S3.SS5.p1.4.m4.2.2.2.4" xref="S3.SS5.p1.4.m4.2.2.3.cmml">;</mo><msubsup id="S3.SS5.p1.4.m4.2.2.2.2" xref="S3.SS5.p1.4.m4.2.2.2.2.cmml"><mi id="S3.SS5.p1.4.m4.2.2.2.2.2.2" xref="S3.SS5.p1.4.m4.2.2.2.2.2.2.cmml">B</mi><mi id="S3.SS5.p1.4.m4.2.2.2.2.2.3" xref="S3.SS5.p1.4.m4.2.2.2.2.2.3.cmml">n</mi><mo id="S3.SS5.p1.4.m4.2.2.2.2.3" xref="S3.SS5.p1.4.m4.2.2.2.2.3.cmml">∗</mo></msubsup><mo id="S3.SS5.p1.4.m4.2.2.2.5" xref="S3.SS5.p1.4.m4.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.2b"><list id="S3.SS5.p1.4.m4.2.2.3.cmml" xref="S3.SS5.p1.4.m4.2.2.2"><apply id="S3.SS5.p1.4.m4.1.1.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1.1.1">superscript</csymbol><apply id="S3.SS5.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS5.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.1.1.1.1.2.1.cmml" xref="S3.SS5.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS5.p1.4.m4.1.1.1.1.2.2.cmml" xref="S3.SS5.p1.4.m4.1.1.1.1.2.2">𝑃</ci><ci id="S3.SS5.p1.4.m4.1.1.1.1.2.3.cmml" xref="S3.SS5.p1.4.m4.1.1.1.1.2.3">𝑛</ci></apply><times id="S3.SS5.p1.4.m4.1.1.1.1.3.cmml" xref="S3.SS5.p1.4.m4.1.1.1.1.3"></times></apply><apply id="S3.SS5.p1.4.m4.2.2.2.2.cmml" xref="S3.SS5.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.2.2.2.2.1.cmml" xref="S3.SS5.p1.4.m4.2.2.2.2">superscript</csymbol><apply id="S3.SS5.p1.4.m4.2.2.2.2.2.cmml" xref="S3.SS5.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS5.p1.4.m4.2.2.2.2">subscript</csymbol><ci id="S3.SS5.p1.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS5.p1.4.m4.2.2.2.2.2.2">𝐵</ci><ci id="S3.SS5.p1.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS5.p1.4.m4.2.2.2.2.2.3">𝑛</ci></apply><times id="S3.SS5.p1.4.m4.2.2.2.2.3.cmml" xref="S3.SS5.p1.4.m4.2.2.2.2.3"></times></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.2c">\left[{P_{n}^{*}};{B_{n}^{*}}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.4.m4.2d">[ italic_P start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ; italic_B start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ]</annotation></semantics></math> denote the support/query prompts after independent interaction with support/query tokens <math alttext="X^{*}_{n-1}" class="ltx_Math" display="inline" id="S3.SS5.p1.5.m5.1"><semantics id="S3.SS5.p1.5.m5.1a"><msubsup id="S3.SS5.p1.5.m5.1.1" xref="S3.SS5.p1.5.m5.1.1.cmml"><mi id="S3.SS5.p1.5.m5.1.1.2.2" xref="S3.SS5.p1.5.m5.1.1.2.2.cmml">X</mi><mrow id="S3.SS5.p1.5.m5.1.1.3" xref="S3.SS5.p1.5.m5.1.1.3.cmml"><mi id="S3.SS5.p1.5.m5.1.1.3.2" xref="S3.SS5.p1.5.m5.1.1.3.2.cmml">n</mi><mo id="S3.SS5.p1.5.m5.1.1.3.1" xref="S3.SS5.p1.5.m5.1.1.3.1.cmml">−</mo><mn id="S3.SS5.p1.5.m5.1.1.3.3" xref="S3.SS5.p1.5.m5.1.1.3.3.cmml">1</mn></mrow><mo id="S3.SS5.p1.5.m5.1.1.2.3" xref="S3.SS5.p1.5.m5.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.5.m5.1b"><apply id="S3.SS5.p1.5.m5.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.5.m5.1.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS5.p1.5.m5.1.1.2.cmml" xref="S3.SS5.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.5.m5.1.1.2.1.cmml" xref="S3.SS5.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS5.p1.5.m5.1.1.2.2.cmml" xref="S3.SS5.p1.5.m5.1.1.2.2">𝑋</ci><times id="S3.SS5.p1.5.m5.1.1.2.3.cmml" xref="S3.SS5.p1.5.m5.1.1.2.3"></times></apply><apply id="S3.SS5.p1.5.m5.1.1.3.cmml" xref="S3.SS5.p1.5.m5.1.1.3"><minus id="S3.SS5.p1.5.m5.1.1.3.1.cmml" xref="S3.SS5.p1.5.m5.1.1.3.1"></minus><ci id="S3.SS5.p1.5.m5.1.1.3.2.cmml" xref="S3.SS5.p1.5.m5.1.1.3.2">𝑛</ci><cn id="S3.SS5.p1.5.m5.1.1.3.3.cmml" type="integer" xref="S3.SS5.p1.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.5.m5.1c">X^{*}_{n-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.5.m5.1d">italic_X start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, in <math alttext="n" class="ltx_Math" display="inline" id="S3.SS5.p1.6.m6.1"><semantics id="S3.SS5.p1.6.m6.1a"><mi id="S3.SS5.p1.6.m6.1.1" xref="S3.SS5.p1.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.6.m6.1b"><ci id="S3.SS5.p1.6.m6.1.1.cmml" xref="S3.SS5.p1.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.6.m6.1d">italic_n</annotation></semantics></math>-layer block.</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.1">Thus, we can alternate the above prompting and transferring processes (Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E9" title="In 3.4.2 Semantic Prompt Transfer (SPT) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">9</span></a>)-(<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E10" title="In 3.5 Prompting ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">10</span></a>)) <math alttext="L" class="ltx_Math" display="inline" id="S3.SS5.p2.1.m1.1"><semantics id="S3.SS5.p2.1.m1.1a"><mi id="S3.SS5.p2.1.m1.1.1" xref="S3.SS5.p2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.1.m1.1b"><ci id="S3.SS5.p2.1.m1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.1.m1.1d">italic_L</annotation></semantics></math> times (i.e., the number of the Prompt Enhancements) in the encoder blocks to continuously activate the specific objects in the image features and further refine the class-specific semantic descriptions of the prompts.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span><span class="ltx_text ltx_font_italic" id="S3.SS6.1.1">Matching</span>
</h3>
<div class="ltx_para" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.7">Therefore, after <math alttext="N" class="ltx_Math" display="inline" id="S3.SS6.p1.1.m1.1"><semantics id="S3.SS6.p1.1.m1.1a"><mi id="S3.SS6.p1.1.m1.1.1" xref="S3.SS6.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.1.m1.1b"><ci id="S3.SS6.p1.1.m1.1.1.cmml" xref="S3.SS6.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.1.m1.1d">italic_N</annotation></semantics></math>-layer encoder blocks, we directly utilize enhanced class-aware prompts <math alttext="\left[P^{q};P^{s};B\right]" class="ltx_Math" display="inline" id="S3.SS6.p1.2.m2.3"><semantics id="S3.SS6.p1.2.m2.3a"><mrow id="S3.SS6.p1.2.m2.3.3.2" xref="S3.SS6.p1.2.m2.3.3.3.cmml"><mo id="S3.SS6.p1.2.m2.3.3.2.3" xref="S3.SS6.p1.2.m2.3.3.3.cmml">[</mo><msup id="S3.SS6.p1.2.m2.2.2.1.1" xref="S3.SS6.p1.2.m2.2.2.1.1.cmml"><mi id="S3.SS6.p1.2.m2.2.2.1.1.2" xref="S3.SS6.p1.2.m2.2.2.1.1.2.cmml">P</mi><mi id="S3.SS6.p1.2.m2.2.2.1.1.3" xref="S3.SS6.p1.2.m2.2.2.1.1.3.cmml">q</mi></msup><mo id="S3.SS6.p1.2.m2.3.3.2.4" xref="S3.SS6.p1.2.m2.3.3.3.cmml">;</mo><msup id="S3.SS6.p1.2.m2.3.3.2.2" xref="S3.SS6.p1.2.m2.3.3.2.2.cmml"><mi id="S3.SS6.p1.2.m2.3.3.2.2.2" xref="S3.SS6.p1.2.m2.3.3.2.2.2.cmml">P</mi><mi id="S3.SS6.p1.2.m2.3.3.2.2.3" xref="S3.SS6.p1.2.m2.3.3.2.2.3.cmml">s</mi></msup><mo id="S3.SS6.p1.2.m2.3.3.2.5" xref="S3.SS6.p1.2.m2.3.3.3.cmml">;</mo><mi id="S3.SS6.p1.2.m2.1.1" xref="S3.SS6.p1.2.m2.1.1.cmml">B</mi><mo id="S3.SS6.p1.2.m2.3.3.2.6" xref="S3.SS6.p1.2.m2.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.2.m2.3b"><list id="S3.SS6.p1.2.m2.3.3.3.cmml" xref="S3.SS6.p1.2.m2.3.3.2"><apply id="S3.SS6.p1.2.m2.2.2.1.1.cmml" xref="S3.SS6.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS6.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS6.p1.2.m2.2.2.1.1">superscript</csymbol><ci id="S3.SS6.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS6.p1.2.m2.2.2.1.1.2">𝑃</ci><ci id="S3.SS6.p1.2.m2.2.2.1.1.3.cmml" xref="S3.SS6.p1.2.m2.2.2.1.1.3">𝑞</ci></apply><apply id="S3.SS6.p1.2.m2.3.3.2.2.cmml" xref="S3.SS6.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS6.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS6.p1.2.m2.3.3.2.2">superscript</csymbol><ci id="S3.SS6.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS6.p1.2.m2.3.3.2.2.2">𝑃</ci><ci id="S3.SS6.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS6.p1.2.m2.3.3.2.2.3">𝑠</ci></apply><ci id="S3.SS6.p1.2.m2.1.1.cmml" xref="S3.SS6.p1.2.m2.1.1">𝐵</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.2.m2.3c">\left[P^{q};P^{s};B\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.2.m2.3d">[ italic_P start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ; italic_P start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ; italic_B ]</annotation></semantics></math> to segment the activated query feature. Concretely, we perform cosine similarity computation of the class-aware query feature <math alttext="X^{q}" class="ltx_Math" display="inline" id="S3.SS6.p1.3.m3.1"><semantics id="S3.SS6.p1.3.m3.1a"><msup id="S3.SS6.p1.3.m3.1.1" xref="S3.SS6.p1.3.m3.1.1.cmml"><mi id="S3.SS6.p1.3.m3.1.1.2" xref="S3.SS6.p1.3.m3.1.1.2.cmml">X</mi><mi id="S3.SS6.p1.3.m3.1.1.3" xref="S3.SS6.p1.3.m3.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.3.m3.1b"><apply id="S3.SS6.p1.3.m3.1.1.cmml" xref="S3.SS6.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS6.p1.3.m3.1.1.1.cmml" xref="S3.SS6.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS6.p1.3.m3.1.1.2.cmml" xref="S3.SS6.p1.3.m3.1.1.2">𝑋</ci><ci id="S3.SS6.p1.3.m3.1.1.3.cmml" xref="S3.SS6.p1.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.3.m3.1c">X^{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.3.m3.1d">italic_X start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT</annotation></semantics></math> with fused FG-prompts, i.e. <math alttext="\overline{P}=\lambda\cdot P^{q}+\left(1-\lambda\right)\cdot P^{s}=\left[%
\overline{p}_{1},\overline{p}_{2},...,\overline{p}_{N_{p}}\right]\in\mathbb{R}%
{{}^{N_{p}\times d}}" class="ltx_math_unparsed" display="inline" id="S3.SS6.p1.4.m4.1"><semantics id="S3.SS6.p1.4.m4.1a"><mrow id="S3.SS6.p1.4.m4.1b"><mover accent="true" id="S3.SS6.p1.4.m4.1.2"><mi id="S3.SS6.p1.4.m4.1.2.2">P</mi><mo id="S3.SS6.p1.4.m4.1.2.1">¯</mo></mover><mo id="S3.SS6.p1.4.m4.1.3">=</mo><mi id="S3.SS6.p1.4.m4.1.4">λ</mi><mo id="S3.SS6.p1.4.m4.1.5" lspace="0.222em" rspace="0.222em">⋅</mo><msup id="S3.SS6.p1.4.m4.1.6"><mi id="S3.SS6.p1.4.m4.1.6.2">P</mi><mi id="S3.SS6.p1.4.m4.1.6.3">q</mi></msup><mo id="S3.SS6.p1.4.m4.1.7">+</mo><mrow id="S3.SS6.p1.4.m4.1.8"><mo id="S3.SS6.p1.4.m4.1.8.1">(</mo><mn id="S3.SS6.p1.4.m4.1.8.2">1</mn><mo id="S3.SS6.p1.4.m4.1.8.3">−</mo><mi id="S3.SS6.p1.4.m4.1.8.4">λ</mi><mo id="S3.SS6.p1.4.m4.1.8.5" rspace="0.055em">)</mo></mrow><mo id="S3.SS6.p1.4.m4.1.9" rspace="0.222em">⋅</mo><msup id="S3.SS6.p1.4.m4.1.10"><mi id="S3.SS6.p1.4.m4.1.10.2">P</mi><mi id="S3.SS6.p1.4.m4.1.10.3">s</mi></msup><mo id="S3.SS6.p1.4.m4.1.11">=</mo><mrow id="S3.SS6.p1.4.m4.1.12"><mo id="S3.SS6.p1.4.m4.1.12.1">[</mo><msub id="S3.SS6.p1.4.m4.1.12.2"><mover accent="true" id="S3.SS6.p1.4.m4.1.12.2.2"><mi id="S3.SS6.p1.4.m4.1.12.2.2.2">p</mi><mo id="S3.SS6.p1.4.m4.1.12.2.2.1">¯</mo></mover><mn id="S3.SS6.p1.4.m4.1.12.2.3">1</mn></msub><mo id="S3.SS6.p1.4.m4.1.12.3">,</mo><msub id="S3.SS6.p1.4.m4.1.12.4"><mover accent="true" id="S3.SS6.p1.4.m4.1.12.4.2"><mi id="S3.SS6.p1.4.m4.1.12.4.2.2">p</mi><mo id="S3.SS6.p1.4.m4.1.12.4.2.1">¯</mo></mover><mn id="S3.SS6.p1.4.m4.1.12.4.3">2</mn></msub><mo id="S3.SS6.p1.4.m4.1.12.5">,</mo><mi id="S3.SS6.p1.4.m4.1.1" mathvariant="normal">…</mi><mo id="S3.SS6.p1.4.m4.1.12.6">,</mo><msub id="S3.SS6.p1.4.m4.1.12.7"><mover accent="true" id="S3.SS6.p1.4.m4.1.12.7.2"><mi id="S3.SS6.p1.4.m4.1.12.7.2.2">p</mi><mo id="S3.SS6.p1.4.m4.1.12.7.2.1">¯</mo></mover><msub id="S3.SS6.p1.4.m4.1.12.7.3"><mi id="S3.SS6.p1.4.m4.1.12.7.3.2">N</mi><mi id="S3.SS6.p1.4.m4.1.12.7.3.3">p</mi></msub></msub><mo id="S3.SS6.p1.4.m4.1.12.8">]</mo></mrow><mo id="S3.SS6.p1.4.m4.1.13">∈</mo><mi id="S3.SS6.p1.4.m4.1.14">ℝ</mi><msup id="S3.SS6.p1.4.m4.1.15"><mi id="S3.SS6.p1.4.m4.1.15a"></mi><mrow id="S3.SS6.p1.4.m4.1.15.1"><msub id="S3.SS6.p1.4.m4.1.15.1.2"><mi id="S3.SS6.p1.4.m4.1.15.1.2.2">N</mi><mi id="S3.SS6.p1.4.m4.1.15.1.2.3">p</mi></msub><mo id="S3.SS6.p1.4.m4.1.15.1.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.SS6.p1.4.m4.1.15.1.3">d</mi></mrow></msup></mrow><annotation encoding="application/x-tex" id="S3.SS6.p1.4.m4.1c">\overline{P}=\lambda\cdot P^{q}+\left(1-\lambda\right)\cdot P^{s}=\left[%
\overline{p}_{1},\overline{p}_{2},...,\overline{p}_{N_{p}}\right]\in\mathbb{R}%
{{}^{N_{p}\times d}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.4.m4.1d">over¯ start_ARG italic_P end_ARG = italic_λ ⋅ italic_P start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT + ( 1 - italic_λ ) ⋅ italic_P start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT = [ over¯ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , over¯ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , over¯ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ∈ blackboard_R start_FLOATSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT × italic_d end_FLOATSUPERSCRIPT</annotation></semantics></math> (<math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS6.p1.5.m5.1"><semantics id="S3.SS6.p1.5.m5.1a"><mi id="S3.SS6.p1.5.m5.1.1" xref="S3.SS6.p1.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.5.m5.1b"><ci id="S3.SS6.p1.5.m5.1.1.cmml" xref="S3.SS6.p1.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.5.m5.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.5.m5.1d">italic_λ</annotation></semantics></math> is learnable), and averaged BG-prompt <math alttext="\overline{b}=\frac{1}{\left|N_{b}\right|}\sum_{j=1}^{N_{b}}b_{j}" class="ltx_Math" display="inline" id="S3.SS6.p1.6.m6.1"><semantics id="S3.SS6.p1.6.m6.1a"><mrow id="S3.SS6.p1.6.m6.1.2" xref="S3.SS6.p1.6.m6.1.2.cmml"><mover accent="true" id="S3.SS6.p1.6.m6.1.2.2" xref="S3.SS6.p1.6.m6.1.2.2.cmml"><mi id="S3.SS6.p1.6.m6.1.2.2.2" xref="S3.SS6.p1.6.m6.1.2.2.2.cmml">b</mi><mo id="S3.SS6.p1.6.m6.1.2.2.1" xref="S3.SS6.p1.6.m6.1.2.2.1.cmml">¯</mo></mover><mo id="S3.SS6.p1.6.m6.1.2.1" xref="S3.SS6.p1.6.m6.1.2.1.cmml">=</mo><mrow id="S3.SS6.p1.6.m6.1.2.3" xref="S3.SS6.p1.6.m6.1.2.3.cmml"><mfrac id="S3.SS6.p1.6.m6.1.1" xref="S3.SS6.p1.6.m6.1.1.cmml"><mn id="S3.SS6.p1.6.m6.1.1.3" xref="S3.SS6.p1.6.m6.1.1.3.cmml">1</mn><mrow id="S3.SS6.p1.6.m6.1.1.1.1" xref="S3.SS6.p1.6.m6.1.1.1.2.cmml"><mo id="S3.SS6.p1.6.m6.1.1.1.1.2" xref="S3.SS6.p1.6.m6.1.1.1.2.1.cmml">|</mo><msub id="S3.SS6.p1.6.m6.1.1.1.1.1" xref="S3.SS6.p1.6.m6.1.1.1.1.1.cmml"><mi id="S3.SS6.p1.6.m6.1.1.1.1.1.2" xref="S3.SS6.p1.6.m6.1.1.1.1.1.2.cmml">N</mi><mi id="S3.SS6.p1.6.m6.1.1.1.1.1.3" xref="S3.SS6.p1.6.m6.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S3.SS6.p1.6.m6.1.1.1.1.3" xref="S3.SS6.p1.6.m6.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.SS6.p1.6.m6.1.2.3.1" xref="S3.SS6.p1.6.m6.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS6.p1.6.m6.1.2.3.2" xref="S3.SS6.p1.6.m6.1.2.3.2.cmml"><msubsup id="S3.SS6.p1.6.m6.1.2.3.2.1" xref="S3.SS6.p1.6.m6.1.2.3.2.1.cmml"><mo id="S3.SS6.p1.6.m6.1.2.3.2.1.2.2" xref="S3.SS6.p1.6.m6.1.2.3.2.1.2.2.cmml">∑</mo><mrow id="S3.SS6.p1.6.m6.1.2.3.2.1.2.3" xref="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.cmml"><mi id="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.2" xref="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.2.cmml">j</mi><mo id="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.1" xref="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.1.cmml">=</mo><mn id="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.3" xref="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.3.cmml">1</mn></mrow><msub id="S3.SS6.p1.6.m6.1.2.3.2.1.3" xref="S3.SS6.p1.6.m6.1.2.3.2.1.3.cmml"><mi id="S3.SS6.p1.6.m6.1.2.3.2.1.3.2" xref="S3.SS6.p1.6.m6.1.2.3.2.1.3.2.cmml">N</mi><mi id="S3.SS6.p1.6.m6.1.2.3.2.1.3.3" xref="S3.SS6.p1.6.m6.1.2.3.2.1.3.3.cmml">b</mi></msub></msubsup><msub id="S3.SS6.p1.6.m6.1.2.3.2.2" xref="S3.SS6.p1.6.m6.1.2.3.2.2.cmml"><mi id="S3.SS6.p1.6.m6.1.2.3.2.2.2" xref="S3.SS6.p1.6.m6.1.2.3.2.2.2.cmml">b</mi><mi id="S3.SS6.p1.6.m6.1.2.3.2.2.3" xref="S3.SS6.p1.6.m6.1.2.3.2.2.3.cmml">j</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.6.m6.1b"><apply id="S3.SS6.p1.6.m6.1.2.cmml" xref="S3.SS6.p1.6.m6.1.2"><eq id="S3.SS6.p1.6.m6.1.2.1.cmml" xref="S3.SS6.p1.6.m6.1.2.1"></eq><apply id="S3.SS6.p1.6.m6.1.2.2.cmml" xref="S3.SS6.p1.6.m6.1.2.2"><ci id="S3.SS6.p1.6.m6.1.2.2.1.cmml" xref="S3.SS6.p1.6.m6.1.2.2.1">¯</ci><ci id="S3.SS6.p1.6.m6.1.2.2.2.cmml" xref="S3.SS6.p1.6.m6.1.2.2.2">𝑏</ci></apply><apply id="S3.SS6.p1.6.m6.1.2.3.cmml" xref="S3.SS6.p1.6.m6.1.2.3"><times id="S3.SS6.p1.6.m6.1.2.3.1.cmml" xref="S3.SS6.p1.6.m6.1.2.3.1"></times><apply id="S3.SS6.p1.6.m6.1.1.cmml" xref="S3.SS6.p1.6.m6.1.1"><divide id="S3.SS6.p1.6.m6.1.1.2.cmml" xref="S3.SS6.p1.6.m6.1.1"></divide><cn id="S3.SS6.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS6.p1.6.m6.1.1.3">1</cn><apply id="S3.SS6.p1.6.m6.1.1.1.2.cmml" xref="S3.SS6.p1.6.m6.1.1.1.1"><abs id="S3.SS6.p1.6.m6.1.1.1.2.1.cmml" xref="S3.SS6.p1.6.m6.1.1.1.1.2"></abs><apply id="S3.SS6.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS6.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS6.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS6.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS6.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS6.p1.6.m6.1.1.1.1.1.2">𝑁</ci><ci id="S3.SS6.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS6.p1.6.m6.1.1.1.1.1.3">𝑏</ci></apply></apply></apply><apply id="S3.SS6.p1.6.m6.1.2.3.2.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2"><apply id="S3.SS6.p1.6.m6.1.2.3.2.1.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1"><csymbol cd="ambiguous" id="S3.SS6.p1.6.m6.1.2.3.2.1.1.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1">superscript</csymbol><apply id="S3.SS6.p1.6.m6.1.2.3.2.1.2.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1"><csymbol cd="ambiguous" id="S3.SS6.p1.6.m6.1.2.3.2.1.2.1.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1">subscript</csymbol><sum id="S3.SS6.p1.6.m6.1.2.3.2.1.2.2.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1.2.2"></sum><apply id="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1.2.3"><eq id="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.1.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.1"></eq><ci id="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.2.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.2">𝑗</ci><cn id="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.3.cmml" type="integer" xref="S3.SS6.p1.6.m6.1.2.3.2.1.2.3.3">1</cn></apply></apply><apply id="S3.SS6.p1.6.m6.1.2.3.2.1.3.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1.3"><csymbol cd="ambiguous" id="S3.SS6.p1.6.m6.1.2.3.2.1.3.1.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1.3">subscript</csymbol><ci id="S3.SS6.p1.6.m6.1.2.3.2.1.3.2.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1.3.2">𝑁</ci><ci id="S3.SS6.p1.6.m6.1.2.3.2.1.3.3.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.1.3.3">𝑏</ci></apply></apply><apply id="S3.SS6.p1.6.m6.1.2.3.2.2.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS6.p1.6.m6.1.2.3.2.2.1.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.2">subscript</csymbol><ci id="S3.SS6.p1.6.m6.1.2.3.2.2.2.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.2.2">𝑏</ci><ci id="S3.SS6.p1.6.m6.1.2.3.2.2.3.cmml" xref="S3.SS6.p1.6.m6.1.2.3.2.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.6.m6.1c">\overline{b}=\frac{1}{\left|N_{b}\right|}\sum_{j=1}^{N_{b}}b_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.6.m6.1d">over¯ start_ARG italic_b end_ARG = divide start_ARG 1 end_ARG start_ARG | italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, to achieve the final prediction <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.SS6.p1.7.m7.1"><semantics id="S3.SS6.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS6.p1.7.m7.1.1" xref="S3.SS6.p1.7.m7.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.7.m7.1b"><ci id="S3.SS6.p1.7.m7.1.1.cmml" xref="S3.SS6.p1.7.m7.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.7.m7.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.7.m7.1d">caligraphic_P</annotation></semantics></math>, which can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\mathcal{P}_{(u,v)}}=\left[\left\langle X^{q}_{(u,v)},\overline{b}\right%
\rangle;{\max_{i\in\left[1,N_{p}\right]}}\left\{\left\langle X^{q}_{(u,v)},%
\overline{p}_{i}\right\rangle\right\}\right]" class="ltx_Math" display="block" id="S3.E11.m1.11"><semantics id="S3.E11.m1.11a"><mrow id="S3.E11.m1.11.11" xref="S3.E11.m1.11.11.cmml"><msub id="S3.E11.m1.11.11.4" xref="S3.E11.m1.11.11.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.11.11.4.2" xref="S3.E11.m1.11.11.4.2.cmml">𝒫</mi><mrow id="S3.E11.m1.2.2.2.4" xref="S3.E11.m1.2.2.2.3.cmml"><mo id="S3.E11.m1.2.2.2.4.1" stretchy="false" xref="S3.E11.m1.2.2.2.3.cmml">(</mo><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">u</mi><mo id="S3.E11.m1.2.2.2.4.2" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><mi id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.2.cmml">v</mi><mo id="S3.E11.m1.2.2.2.4.3" stretchy="false" xref="S3.E11.m1.2.2.2.3.cmml">)</mo></mrow></msub><mo id="S3.E11.m1.11.11.3" xref="S3.E11.m1.11.11.3.cmml">=</mo><mrow id="S3.E11.m1.11.11.2.2" xref="S3.E11.m1.11.11.2.3.cmml"><mo id="S3.E11.m1.11.11.2.2.3" xref="S3.E11.m1.11.11.2.3.cmml">[</mo><mrow id="S3.E11.m1.10.10.1.1.1.1" xref="S3.E11.m1.10.10.1.1.1.2.cmml"><mo id="S3.E11.m1.10.10.1.1.1.1.2" xref="S3.E11.m1.10.10.1.1.1.2.cmml">⟨</mo><msubsup id="S3.E11.m1.10.10.1.1.1.1.1" xref="S3.E11.m1.10.10.1.1.1.1.1.cmml"><mi id="S3.E11.m1.10.10.1.1.1.1.1.2.2" xref="S3.E11.m1.10.10.1.1.1.1.1.2.2.cmml">X</mi><mrow id="S3.E11.m1.4.4.2.4" xref="S3.E11.m1.4.4.2.3.cmml"><mo id="S3.E11.m1.4.4.2.4.1" stretchy="false" xref="S3.E11.m1.4.4.2.3.cmml">(</mo><mi id="S3.E11.m1.3.3.1.1" xref="S3.E11.m1.3.3.1.1.cmml">u</mi><mo id="S3.E11.m1.4.4.2.4.2" xref="S3.E11.m1.4.4.2.3.cmml">,</mo><mi id="S3.E11.m1.4.4.2.2" xref="S3.E11.m1.4.4.2.2.cmml">v</mi><mo id="S3.E11.m1.4.4.2.4.3" stretchy="false" xref="S3.E11.m1.4.4.2.3.cmml">)</mo></mrow><mi id="S3.E11.m1.10.10.1.1.1.1.1.2.3" xref="S3.E11.m1.10.10.1.1.1.1.1.2.3.cmml">q</mi></msubsup><mo id="S3.E11.m1.10.10.1.1.1.1.3" xref="S3.E11.m1.10.10.1.1.1.2.cmml">,</mo><mover accent="true" id="S3.E11.m1.9.9" xref="S3.E11.m1.9.9.cmml"><mi id="S3.E11.m1.9.9.2" xref="S3.E11.m1.9.9.2.cmml">b</mi><mo id="S3.E11.m1.9.9.1" xref="S3.E11.m1.9.9.1.cmml">¯</mo></mover><mo id="S3.E11.m1.10.10.1.1.1.1.4" xref="S3.E11.m1.10.10.1.1.1.2.cmml">⟩</mo></mrow><mo id="S3.E11.m1.11.11.2.2.4" xref="S3.E11.m1.11.11.2.3.cmml">;</mo><mrow id="S3.E11.m1.11.11.2.2.2.2" xref="S3.E11.m1.11.11.2.2.2.3.cmml"><munder id="S3.E11.m1.11.11.2.2.2.1.1" xref="S3.E11.m1.11.11.2.2.2.1.1.cmml"><mi id="S3.E11.m1.11.11.2.2.2.1.1.2" xref="S3.E11.m1.11.11.2.2.2.1.1.2.cmml">max</mi><mrow id="S3.E11.m1.6.6.2" xref="S3.E11.m1.6.6.2.cmml"><mi id="S3.E11.m1.6.6.2.4" xref="S3.E11.m1.6.6.2.4.cmml">i</mi><mo id="S3.E11.m1.6.6.2.3" xref="S3.E11.m1.6.6.2.3.cmml">∈</mo><mrow id="S3.E11.m1.6.6.2.2.1" xref="S3.E11.m1.6.6.2.2.2.cmml"><mo id="S3.E11.m1.6.6.2.2.1.2" xref="S3.E11.m1.6.6.2.2.2.cmml">[</mo><mn id="S3.E11.m1.5.5.1.1" xref="S3.E11.m1.5.5.1.1.cmml">1</mn><mo id="S3.E11.m1.6.6.2.2.1.3" xref="S3.E11.m1.6.6.2.2.2.cmml">,</mo><msub id="S3.E11.m1.6.6.2.2.1.1" xref="S3.E11.m1.6.6.2.2.1.1.cmml"><mi id="S3.E11.m1.6.6.2.2.1.1.2" xref="S3.E11.m1.6.6.2.2.1.1.2.cmml">N</mi><mi id="S3.E11.m1.6.6.2.2.1.1.3" xref="S3.E11.m1.6.6.2.2.1.1.3.cmml">p</mi></msub><mo id="S3.E11.m1.6.6.2.2.1.4" xref="S3.E11.m1.6.6.2.2.2.cmml">]</mo></mrow></mrow></munder><mo id="S3.E11.m1.11.11.2.2.2.2a" xref="S3.E11.m1.11.11.2.2.2.3.cmml">⁡</mo><mrow id="S3.E11.m1.11.11.2.2.2.2.2" xref="S3.E11.m1.11.11.2.2.2.3.cmml"><mo id="S3.E11.m1.11.11.2.2.2.2.2.2" xref="S3.E11.m1.11.11.2.2.2.3.cmml">{</mo><mrow id="S3.E11.m1.11.11.2.2.2.2.2.1.2" xref="S3.E11.m1.11.11.2.2.2.2.2.1.3.cmml"><mo id="S3.E11.m1.11.11.2.2.2.2.2.1.2.3" xref="S3.E11.m1.11.11.2.2.2.2.2.1.3.cmml">⟨</mo><msubsup id="S3.E11.m1.11.11.2.2.2.2.2.1.1.1" xref="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.2.2" xref="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.2.2.cmml">X</mi><mrow id="S3.E11.m1.8.8.2.4" xref="S3.E11.m1.8.8.2.3.cmml"><mo id="S3.E11.m1.8.8.2.4.1" stretchy="false" xref="S3.E11.m1.8.8.2.3.cmml">(</mo><mi id="S3.E11.m1.7.7.1.1" xref="S3.E11.m1.7.7.1.1.cmml">u</mi><mo id="S3.E11.m1.8.8.2.4.2" xref="S3.E11.m1.8.8.2.3.cmml">,</mo><mi id="S3.E11.m1.8.8.2.2" xref="S3.E11.m1.8.8.2.2.cmml">v</mi><mo id="S3.E11.m1.8.8.2.4.3" stretchy="false" xref="S3.E11.m1.8.8.2.3.cmml">)</mo></mrow><mi id="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.2.3" xref="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.2.3.cmml">q</mi></msubsup><mo id="S3.E11.m1.11.11.2.2.2.2.2.1.2.4" xref="S3.E11.m1.11.11.2.2.2.2.2.1.3.cmml">,</mo><msub id="S3.E11.m1.11.11.2.2.2.2.2.1.2.2" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.cmml"><mover accent="true" id="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2.cmml"><mi id="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2.2" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2.2.cmml">p</mi><mo id="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2.1" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2.1.cmml">¯</mo></mover><mi id="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.3" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.3.cmml">i</mi></msub><mo id="S3.E11.m1.11.11.2.2.2.2.2.1.2.5" xref="S3.E11.m1.11.11.2.2.2.2.2.1.3.cmml">⟩</mo></mrow><mo id="S3.E11.m1.11.11.2.2.2.2.2.3" xref="S3.E11.m1.11.11.2.2.2.3.cmml">}</mo></mrow></mrow><mo id="S3.E11.m1.11.11.2.2.5" xref="S3.E11.m1.11.11.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.11b"><apply id="S3.E11.m1.11.11.cmml" xref="S3.E11.m1.11.11"><eq id="S3.E11.m1.11.11.3.cmml" xref="S3.E11.m1.11.11.3"></eq><apply id="S3.E11.m1.11.11.4.cmml" xref="S3.E11.m1.11.11.4"><csymbol cd="ambiguous" id="S3.E11.m1.11.11.4.1.cmml" xref="S3.E11.m1.11.11.4">subscript</csymbol><ci id="S3.E11.m1.11.11.4.2.cmml" xref="S3.E11.m1.11.11.4.2">𝒫</ci><interval closure="open" id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.4"><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">𝑢</ci><ci id="S3.E11.m1.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2">𝑣</ci></interval></apply><list id="S3.E11.m1.11.11.2.3.cmml" xref="S3.E11.m1.11.11.2.2"><list id="S3.E11.m1.10.10.1.1.1.2.cmml" xref="S3.E11.m1.10.10.1.1.1.1"><apply id="S3.E11.m1.10.10.1.1.1.1.1.cmml" xref="S3.E11.m1.10.10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.10.10.1.1.1.1.1.1.cmml" xref="S3.E11.m1.10.10.1.1.1.1.1">subscript</csymbol><apply id="S3.E11.m1.10.10.1.1.1.1.1.2.cmml" xref="S3.E11.m1.10.10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.10.10.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.10.10.1.1.1.1.1">superscript</csymbol><ci id="S3.E11.m1.10.10.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.10.10.1.1.1.1.1.2.2">𝑋</ci><ci id="S3.E11.m1.10.10.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.10.10.1.1.1.1.1.2.3">𝑞</ci></apply><interval closure="open" id="S3.E11.m1.4.4.2.3.cmml" xref="S3.E11.m1.4.4.2.4"><ci id="S3.E11.m1.3.3.1.1.cmml" xref="S3.E11.m1.3.3.1.1">𝑢</ci><ci id="S3.E11.m1.4.4.2.2.cmml" xref="S3.E11.m1.4.4.2.2">𝑣</ci></interval></apply><apply id="S3.E11.m1.9.9.cmml" xref="S3.E11.m1.9.9"><ci id="S3.E11.m1.9.9.1.cmml" xref="S3.E11.m1.9.9.1">¯</ci><ci id="S3.E11.m1.9.9.2.cmml" xref="S3.E11.m1.9.9.2">𝑏</ci></apply></list><apply id="S3.E11.m1.11.11.2.2.2.3.cmml" xref="S3.E11.m1.11.11.2.2.2.2"><apply id="S3.E11.m1.11.11.2.2.2.1.1.cmml" xref="S3.E11.m1.11.11.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.11.11.2.2.2.1.1.1.cmml" xref="S3.E11.m1.11.11.2.2.2.1.1">subscript</csymbol><max id="S3.E11.m1.11.11.2.2.2.1.1.2.cmml" xref="S3.E11.m1.11.11.2.2.2.1.1.2"></max><apply id="S3.E11.m1.6.6.2.cmml" xref="S3.E11.m1.6.6.2"><in id="S3.E11.m1.6.6.2.3.cmml" xref="S3.E11.m1.6.6.2.3"></in><ci id="S3.E11.m1.6.6.2.4.cmml" xref="S3.E11.m1.6.6.2.4">𝑖</ci><interval closure="closed" id="S3.E11.m1.6.6.2.2.2.cmml" xref="S3.E11.m1.6.6.2.2.1"><cn id="S3.E11.m1.5.5.1.1.cmml" type="integer" xref="S3.E11.m1.5.5.1.1">1</cn><apply id="S3.E11.m1.6.6.2.2.1.1.cmml" xref="S3.E11.m1.6.6.2.2.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.2.2.1.1.1.cmml" xref="S3.E11.m1.6.6.2.2.1.1">subscript</csymbol><ci id="S3.E11.m1.6.6.2.2.1.1.2.cmml" xref="S3.E11.m1.6.6.2.2.1.1.2">𝑁</ci><ci id="S3.E11.m1.6.6.2.2.1.1.3.cmml" xref="S3.E11.m1.6.6.2.2.1.1.3">𝑝</ci></apply></interval></apply></apply><list id="S3.E11.m1.11.11.2.2.2.2.2.1.3.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2"><apply id="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.1.1">subscript</csymbol><apply id="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.1.1">superscript</csymbol><ci id="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.2.2">𝑋</ci><ci id="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.1.1.2.3">𝑞</ci></apply><interval closure="open" id="S3.E11.m1.8.8.2.3.cmml" xref="S3.E11.m1.8.8.2.4"><ci id="S3.E11.m1.7.7.1.1.cmml" xref="S3.E11.m1.7.7.1.1">𝑢</ci><ci id="S3.E11.m1.8.8.2.2.cmml" xref="S3.E11.m1.8.8.2.2">𝑣</ci></interval></apply><apply id="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.1.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2.2">subscript</csymbol><apply id="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2"><ci id="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2.1.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2.1">¯</ci><ci id="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2.2.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.2.2">𝑝</ci></apply><ci id="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.3.cmml" xref="S3.E11.m1.11.11.2.2.2.2.2.1.2.2.3">𝑖</ci></apply></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.11c">{\mathcal{P}_{(u,v)}}=\left[\left\langle X^{q}_{(u,v)},\overline{b}\right%
\rangle;{\max_{i\in\left[1,N_{p}\right]}}\left\{\left\langle X^{q}_{(u,v)},%
\overline{p}_{i}\right\rangle\right\}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.11d">caligraphic_P start_POSTSUBSCRIPT ( italic_u , italic_v ) end_POSTSUBSCRIPT = [ ⟨ italic_X start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_u , italic_v ) end_POSTSUBSCRIPT , over¯ start_ARG italic_b end_ARG ⟩ ; roman_max start_POSTSUBSCRIPT italic_i ∈ [ 1 , italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ] end_POSTSUBSCRIPT { ⟨ italic_X start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_u , italic_v ) end_POSTSUBSCRIPT , over¯ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩ } ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS6.p1.9">where <math alttext="\left\langle\cdot,\cdot\right\rangle" class="ltx_Math" display="inline" id="S3.SS6.p1.8.m1.2"><semantics id="S3.SS6.p1.8.m1.2a"><mrow id="S3.SS6.p1.8.m1.2.3.2" xref="S3.SS6.p1.8.m1.2.3.1.cmml"><mo id="S3.SS6.p1.8.m1.2.3.2.1" xref="S3.SS6.p1.8.m1.2.3.1.cmml">⟨</mo><mo id="S3.SS6.p1.8.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS6.p1.8.m1.1.1.cmml">⋅</mo><mo id="S3.SS6.p1.8.m1.2.3.2.2" rspace="0em" xref="S3.SS6.p1.8.m1.2.3.1.cmml">,</mo><mo id="S3.SS6.p1.8.m1.2.2" lspace="0em" rspace="0em" xref="S3.SS6.p1.8.m1.2.2.cmml">⋅</mo><mo id="S3.SS6.p1.8.m1.2.3.2.3" xref="S3.SS6.p1.8.m1.2.3.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.8.m1.2b"><list id="S3.SS6.p1.8.m1.2.3.1.cmml" xref="S3.SS6.p1.8.m1.2.3.2"><ci id="S3.SS6.p1.8.m1.1.1.cmml" xref="S3.SS6.p1.8.m1.1.1">⋅</ci><ci id="S3.SS6.p1.8.m1.2.2.cmml" xref="S3.SS6.p1.8.m1.2.2">⋅</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.8.m1.2c">\left\langle\cdot,\cdot\right\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.8.m1.2d">⟨ ⋅ , ⋅ ⟩</annotation></semantics></math> denotes the cosine similarity. Benefiting from the part-level local semantics of FG-prompts, we employ the <math alttext="\max" class="ltx_Math" display="inline" id="S3.SS6.p1.9.m2.1"><semantics id="S3.SS6.p1.9.m2.1a"><mi id="S3.SS6.p1.9.m2.1.1" xref="S3.SS6.p1.9.m2.1.1.cmml">max</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.9.m2.1b"><max id="S3.SS6.p1.9.m2.1.1.cmml" xref="S3.SS6.p1.9.m2.1.1"></max></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.9.m2.1c">\max</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.9.m2.1d">roman_max</annotation></semantics></math> operation to find the closest prompt to the feature pixel for part-level feature matching, which better handles the inter-image differences and region-level differences within images.</p>
</div>
<div class="ltx_para" id="S3.SS6.p2">
<p class="ltx_p" id="S3.SS6.p2.5">Thus, we utilize the cross-entropy loss <math alttext="\mathcal{L}_{pred}" class="ltx_Math" display="inline" id="S3.SS6.p2.1.m1.1"><semantics id="S3.SS6.p2.1.m1.1a"><msub id="S3.SS6.p2.1.m1.1.1" xref="S3.SS6.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS6.p2.1.m1.1.1.2" xref="S3.SS6.p2.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS6.p2.1.m1.1.1.3" xref="S3.SS6.p2.1.m1.1.1.3.cmml"><mi id="S3.SS6.p2.1.m1.1.1.3.2" xref="S3.SS6.p2.1.m1.1.1.3.2.cmml">p</mi><mo id="S3.SS6.p2.1.m1.1.1.3.1" xref="S3.SS6.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS6.p2.1.m1.1.1.3.3" xref="S3.SS6.p2.1.m1.1.1.3.3.cmml">r</mi><mo id="S3.SS6.p2.1.m1.1.1.3.1a" xref="S3.SS6.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS6.p2.1.m1.1.1.3.4" xref="S3.SS6.p2.1.m1.1.1.3.4.cmml">e</mi><mo id="S3.SS6.p2.1.m1.1.1.3.1b" xref="S3.SS6.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS6.p2.1.m1.1.1.3.5" xref="S3.SS6.p2.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.1.m1.1b"><apply id="S3.SS6.p2.1.m1.1.1.cmml" xref="S3.SS6.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS6.p2.1.m1.1.1.1.cmml" xref="S3.SS6.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS6.p2.1.m1.1.1.2.cmml" xref="S3.SS6.p2.1.m1.1.1.2">ℒ</ci><apply id="S3.SS6.p2.1.m1.1.1.3.cmml" xref="S3.SS6.p2.1.m1.1.1.3"><times id="S3.SS6.p2.1.m1.1.1.3.1.cmml" xref="S3.SS6.p2.1.m1.1.1.3.1"></times><ci id="S3.SS6.p2.1.m1.1.1.3.2.cmml" xref="S3.SS6.p2.1.m1.1.1.3.2">𝑝</ci><ci id="S3.SS6.p2.1.m1.1.1.3.3.cmml" xref="S3.SS6.p2.1.m1.1.1.3.3">𝑟</ci><ci id="S3.SS6.p2.1.m1.1.1.3.4.cmml" xref="S3.SS6.p2.1.m1.1.1.3.4">𝑒</ci><ci id="S3.SS6.p2.1.m1.1.1.3.5.cmml" xref="S3.SS6.p2.1.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.1.m1.1c">\mathcal{L}_{pred}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math> to supervise the optimization of <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S3.SS6.p2.2.m2.1"><semantics id="S3.SS6.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS6.p2.2.m2.1.1" xref="S3.SS6.p2.2.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.2.m2.1b"><ci id="S3.SS6.p2.2.m2.1.1.cmml" xref="S3.SS6.p2.2.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.2.m2.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.2.m2.1d">caligraphic_P</annotation></semantics></math> towards the ground-truth label <math alttext="M^{q}" class="ltx_Math" display="inline" id="S3.SS6.p2.3.m3.1"><semantics id="S3.SS6.p2.3.m3.1a"><msup id="S3.SS6.p2.3.m3.1.1" xref="S3.SS6.p2.3.m3.1.1.cmml"><mi id="S3.SS6.p2.3.m3.1.1.2" xref="S3.SS6.p2.3.m3.1.1.2.cmml">M</mi><mi id="S3.SS6.p2.3.m3.1.1.3" xref="S3.SS6.p2.3.m3.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.3.m3.1b"><apply id="S3.SS6.p2.3.m3.1.1.cmml" xref="S3.SS6.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS6.p2.3.m3.1.1.1.cmml" xref="S3.SS6.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS6.p2.3.m3.1.1.2.cmml" xref="S3.SS6.p2.3.m3.1.1.2">𝑀</ci><ci id="S3.SS6.p2.3.m3.1.1.3.cmml" xref="S3.SS6.p2.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.3.m3.1c">M^{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.3.m3.1d">italic_M start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT</annotation></semantics></math>. Furthermore, two losses <math alttext="\mathcal{L}_{reg}" class="ltx_Math" display="inline" id="S3.SS6.p2.4.m4.1"><semantics id="S3.SS6.p2.4.m4.1a"><msub id="S3.SS6.p2.4.m4.1.1" xref="S3.SS6.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS6.p2.4.m4.1.1.2" xref="S3.SS6.p2.4.m4.1.1.2.cmml">ℒ</mi><mrow id="S3.SS6.p2.4.m4.1.1.3" xref="S3.SS6.p2.4.m4.1.1.3.cmml"><mi id="S3.SS6.p2.4.m4.1.1.3.2" xref="S3.SS6.p2.4.m4.1.1.3.2.cmml">r</mi><mo id="S3.SS6.p2.4.m4.1.1.3.1" xref="S3.SS6.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS6.p2.4.m4.1.1.3.3" xref="S3.SS6.p2.4.m4.1.1.3.3.cmml">e</mi><mo id="S3.SS6.p2.4.m4.1.1.3.1a" xref="S3.SS6.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS6.p2.4.m4.1.1.3.4" xref="S3.SS6.p2.4.m4.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.4.m4.1b"><apply id="S3.SS6.p2.4.m4.1.1.cmml" xref="S3.SS6.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS6.p2.4.m4.1.1.1.cmml" xref="S3.SS6.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS6.p2.4.m4.1.1.2.cmml" xref="S3.SS6.p2.4.m4.1.1.2">ℒ</ci><apply id="S3.SS6.p2.4.m4.1.1.3.cmml" xref="S3.SS6.p2.4.m4.1.1.3"><times id="S3.SS6.p2.4.m4.1.1.3.1.cmml" xref="S3.SS6.p2.4.m4.1.1.3.1"></times><ci id="S3.SS6.p2.4.m4.1.1.3.2.cmml" xref="S3.SS6.p2.4.m4.1.1.3.2">𝑟</ci><ci id="S3.SS6.p2.4.m4.1.1.3.3.cmml" xref="S3.SS6.p2.4.m4.1.1.3.3">𝑒</ci><ci id="S3.SS6.p2.4.m4.1.1.3.4.cmml" xref="S3.SS6.p2.4.m4.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.4.m4.1c">\mathcal{L}_{reg}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_g end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{dis}" class="ltx_Math" display="inline" id="S3.SS6.p2.5.m5.1"><semantics id="S3.SS6.p2.5.m5.1a"><msub id="S3.SS6.p2.5.m5.1.1" xref="S3.SS6.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS6.p2.5.m5.1.1.2" xref="S3.SS6.p2.5.m5.1.1.2.cmml">ℒ</mi><mrow id="S3.SS6.p2.5.m5.1.1.3" xref="S3.SS6.p2.5.m5.1.1.3.cmml"><mi id="S3.SS6.p2.5.m5.1.1.3.2" xref="S3.SS6.p2.5.m5.1.1.3.2.cmml">d</mi><mo id="S3.SS6.p2.5.m5.1.1.3.1" xref="S3.SS6.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS6.p2.5.m5.1.1.3.3" xref="S3.SS6.p2.5.m5.1.1.3.3.cmml">i</mi><mo id="S3.SS6.p2.5.m5.1.1.3.1a" xref="S3.SS6.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS6.p2.5.m5.1.1.3.4" xref="S3.SS6.p2.5.m5.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.5.m5.1b"><apply id="S3.SS6.p2.5.m5.1.1.cmml" xref="S3.SS6.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS6.p2.5.m5.1.1.1.cmml" xref="S3.SS6.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS6.p2.5.m5.1.1.2.cmml" xref="S3.SS6.p2.5.m5.1.1.2">ℒ</ci><apply id="S3.SS6.p2.5.m5.1.1.3.cmml" xref="S3.SS6.p2.5.m5.1.1.3"><times id="S3.SS6.p2.5.m5.1.1.3.1.cmml" xref="S3.SS6.p2.5.m5.1.1.3.1"></times><ci id="S3.SS6.p2.5.m5.1.1.3.2.cmml" xref="S3.SS6.p2.5.m5.1.1.3.2">𝑑</ci><ci id="S3.SS6.p2.5.m5.1.1.3.3.cmml" xref="S3.SS6.p2.5.m5.1.1.3.3">𝑖</ci><ci id="S3.SS6.p2.5.m5.1.1.3.4.cmml" xref="S3.SS6.p2.5.m5.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.5.m5.1c">\mathcal{L}_{dis}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.5.m5.1d">caligraphic_L start_POSTSUBSCRIPT italic_d italic_i italic_s end_POSTSUBSCRIPT</annotation></semantics></math> are proposed to capture more representative semantic prompts:</p>
</div>
<div class="ltx_para" id="S3.SS6.p3">
<p class="ltx_p" id="S3.SS6.p3.3">1) We propose a loss of part-level regularization for preventing the part masks <math alttext="M^{p}" class="ltx_Math" display="inline" id="S3.SS6.p3.1.m1.1"><semantics id="S3.SS6.p3.1.m1.1a"><msup id="S3.SS6.p3.1.m1.1.1" xref="S3.SS6.p3.1.m1.1.1.cmml"><mi id="S3.SS6.p3.1.m1.1.1.2" xref="S3.SS6.p3.1.m1.1.1.2.cmml">M</mi><mi id="S3.SS6.p3.1.m1.1.1.3" xref="S3.SS6.p3.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.1.m1.1b"><apply id="S3.SS6.p3.1.m1.1.1.cmml" xref="S3.SS6.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS6.p3.1.m1.1.1.1.cmml" xref="S3.SS6.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS6.p3.1.m1.1.1.2.cmml" xref="S3.SS6.p3.1.m1.1.1.2">𝑀</ci><ci id="S3.SS6.p3.1.m1.1.1.3.cmml" xref="S3.SS6.p3.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.1.m1.1c">M^{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.1.m1.1d">italic_M start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> (include query <math alttext="M^{q;p}" class="ltx_Math" display="inline" id="S3.SS6.p3.2.m2.2"><semantics id="S3.SS6.p3.2.m2.2a"><msup id="S3.SS6.p3.2.m2.2.3" xref="S3.SS6.p3.2.m2.2.3.cmml"><mi id="S3.SS6.p3.2.m2.2.3.2" xref="S3.SS6.p3.2.m2.2.3.2.cmml">M</mi><mrow id="S3.SS6.p3.2.m2.2.2.2.4" xref="S3.SS6.p3.2.m2.2.2.2.3.cmml"><mi id="S3.SS6.p3.2.m2.1.1.1.1" xref="S3.SS6.p3.2.m2.1.1.1.1.cmml">q</mi><mo id="S3.SS6.p3.2.m2.2.2.2.4.1" xref="S3.SS6.p3.2.m2.2.2.2.3.cmml">;</mo><mi id="S3.SS6.p3.2.m2.2.2.2.2" xref="S3.SS6.p3.2.m2.2.2.2.2.cmml">p</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.2.m2.2b"><apply id="S3.SS6.p3.2.m2.2.3.cmml" xref="S3.SS6.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS6.p3.2.m2.2.3.1.cmml" xref="S3.SS6.p3.2.m2.2.3">superscript</csymbol><ci id="S3.SS6.p3.2.m2.2.3.2.cmml" xref="S3.SS6.p3.2.m2.2.3.2">𝑀</ci><list id="S3.SS6.p3.2.m2.2.2.2.3.cmml" xref="S3.SS6.p3.2.m2.2.2.2.4"><ci id="S3.SS6.p3.2.m2.1.1.1.1.cmml" xref="S3.SS6.p3.2.m2.1.1.1.1">𝑞</ci><ci id="S3.SS6.p3.2.m2.2.2.2.2.cmml" xref="S3.SS6.p3.2.m2.2.2.2.2">𝑝</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.2.m2.2c">M^{q;p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.2.m2.2d">italic_M start_POSTSUPERSCRIPT italic_q ; italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> and support <math alttext="M^{s;p}" class="ltx_Math" display="inline" id="S3.SS6.p3.3.m3.2"><semantics id="S3.SS6.p3.3.m3.2a"><msup id="S3.SS6.p3.3.m3.2.3" xref="S3.SS6.p3.3.m3.2.3.cmml"><mi id="S3.SS6.p3.3.m3.2.3.2" xref="S3.SS6.p3.3.m3.2.3.2.cmml">M</mi><mrow id="S3.SS6.p3.3.m3.2.2.2.4" xref="S3.SS6.p3.3.m3.2.2.2.3.cmml"><mi id="S3.SS6.p3.3.m3.1.1.1.1" xref="S3.SS6.p3.3.m3.1.1.1.1.cmml">s</mi><mo id="S3.SS6.p3.3.m3.2.2.2.4.1" xref="S3.SS6.p3.3.m3.2.2.2.3.cmml">;</mo><mi id="S3.SS6.p3.3.m3.2.2.2.2" xref="S3.SS6.p3.3.m3.2.2.2.2.cmml">p</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.3.m3.2b"><apply id="S3.SS6.p3.3.m3.2.3.cmml" xref="S3.SS6.p3.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS6.p3.3.m3.2.3.1.cmml" xref="S3.SS6.p3.3.m3.2.3">superscript</csymbol><ci id="S3.SS6.p3.3.m3.2.3.2.cmml" xref="S3.SS6.p3.3.m3.2.3.2">𝑀</ci><list id="S3.SS6.p3.3.m3.2.2.2.3.cmml" xref="S3.SS6.p3.3.m3.2.2.2.4"><ci id="S3.SS6.p3.3.m3.1.1.1.1.cmml" xref="S3.SS6.p3.3.m3.1.1.1.1">𝑠</ci><ci id="S3.SS6.p3.3.m3.2.2.2.2.cmml" xref="S3.SS6.p3.3.m3.2.2.2.2">𝑝</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.3.m3.2c">M^{s;p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.3.m3.2d">italic_M start_POSTSUPERSCRIPT italic_s ; italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>) from all gathering in the most salient target regions, thus generating similar part semantics:
<span class="ltx_text" id="S3.SS6.p3.3.1" style="font-size:90%;"></span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\mathcal{L}_{reg}}=\frac{\sum_{i=1}^{N_{p}}\sum_{j\neq i\ }^{N_{p}}\left[{%
\left\langle m^{q;p}_{i},m^{q;p}_{j}\right\rangle+\left\langle m^{s;p}_{i},m^{%
s;p}_{j}\right\rangle}\right]}{2*N_{p}*\left(N_{p}-1\right)}" class="ltx_Math" display="block" id="S3.E12.m1.10"><semantics id="S3.E12.m1.10a"><mrow id="S3.E12.m1.10.11" xref="S3.E12.m1.10.11.cmml"><msub id="S3.E12.m1.10.11.2" xref="S3.E12.m1.10.11.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.10.11.2.2" mathsize="90%" xref="S3.E12.m1.10.11.2.2.cmml">ℒ</mi><mrow id="S3.E12.m1.10.11.2.3" xref="S3.E12.m1.10.11.2.3.cmml"><mi id="S3.E12.m1.10.11.2.3.2" mathsize="90%" xref="S3.E12.m1.10.11.2.3.2.cmml">r</mi><mo id="S3.E12.m1.10.11.2.3.1" xref="S3.E12.m1.10.11.2.3.1.cmml">⁢</mo><mi id="S3.E12.m1.10.11.2.3.3" mathsize="90%" xref="S3.E12.m1.10.11.2.3.3.cmml">e</mi><mo id="S3.E12.m1.10.11.2.3.1a" xref="S3.E12.m1.10.11.2.3.1.cmml">⁢</mo><mi id="S3.E12.m1.10.11.2.3.4" mathsize="90%" xref="S3.E12.m1.10.11.2.3.4.cmml">g</mi></mrow></msub><mo id="S3.E12.m1.10.11.1" mathsize="90%" xref="S3.E12.m1.10.11.1.cmml">=</mo><mfrac id="S3.E12.m1.10.10" xref="S3.E12.m1.10.10.cmml"><mrow id="S3.E12.m1.9.9.9" xref="S3.E12.m1.9.9.9.cmml"><msubsup id="S3.E12.m1.9.9.9.10" xref="S3.E12.m1.9.9.9.10.cmml"><mo id="S3.E12.m1.9.9.9.10.2.2" maxsize="90%" minsize="90%" stretchy="true" xref="S3.E12.m1.9.9.9.10.2.2.cmml">∑</mo><mrow id="S3.E12.m1.9.9.9.10.2.3" xref="S3.E12.m1.9.9.9.10.2.3.cmml"><mi id="S3.E12.m1.9.9.9.10.2.3.2" mathsize="90%" xref="S3.E12.m1.9.9.9.10.2.3.2.cmml">i</mi><mo id="S3.E12.m1.9.9.9.10.2.3.1" mathsize="90%" xref="S3.E12.m1.9.9.9.10.2.3.1.cmml">=</mo><mn id="S3.E12.m1.9.9.9.10.2.3.3" mathsize="90%" xref="S3.E12.m1.9.9.9.10.2.3.3.cmml">1</mn></mrow><msub id="S3.E12.m1.9.9.9.10.3" xref="S3.E12.m1.9.9.9.10.3.cmml"><mi id="S3.E12.m1.9.9.9.10.3.2" mathsize="90%" xref="S3.E12.m1.9.9.9.10.3.2.cmml">N</mi><mi id="S3.E12.m1.9.9.9.10.3.3" mathsize="90%" xref="S3.E12.m1.9.9.9.10.3.3.cmml">p</mi></msub></msubsup><mrow id="S3.E12.m1.9.9.9.9" xref="S3.E12.m1.9.9.9.9.cmml"><msubsup id="S3.E12.m1.9.9.9.9.2" xref="S3.E12.m1.9.9.9.9.2.cmml"><mo id="S3.E12.m1.9.9.9.9.2.2.2" lspace="0.167em" maxsize="90%" minsize="90%" rspace="0em" stretchy="true" xref="S3.E12.m1.9.9.9.9.2.2.2.cmml">∑</mo><mrow id="S3.E12.m1.9.9.9.9.2.2.3" xref="S3.E12.m1.9.9.9.9.2.2.3.cmml"><mi id="S3.E12.m1.9.9.9.9.2.2.3.2" mathsize="90%" xref="S3.E12.m1.9.9.9.9.2.2.3.2.cmml">j</mi><mo id="S3.E12.m1.9.9.9.9.2.2.3.1" mathsize="90%" xref="S3.E12.m1.9.9.9.9.2.2.3.1.cmml">≠</mo><mi id="S3.E12.m1.9.9.9.9.2.2.3.3" mathsize="90%" xref="S3.E12.m1.9.9.9.9.2.2.3.3.cmml">i</mi></mrow><msub id="S3.E12.m1.9.9.9.9.2.3" xref="S3.E12.m1.9.9.9.9.2.3.cmml"><mi id="S3.E12.m1.9.9.9.9.2.3.2" mathsize="90%" xref="S3.E12.m1.9.9.9.9.2.3.2.cmml">N</mi><mi id="S3.E12.m1.9.9.9.9.2.3.3" mathsize="90%" xref="S3.E12.m1.9.9.9.9.2.3.3.cmml">p</mi></msub></msubsup><mrow id="S3.E12.m1.9.9.9.9.1.1" xref="S3.E12.m1.9.9.9.9.1.2.cmml"><mo id="S3.E12.m1.9.9.9.9.1.1.2" xref="S3.E12.m1.9.9.9.9.1.2.1.cmml">[</mo><mrow id="S3.E12.m1.9.9.9.9.1.1.1" xref="S3.E12.m1.9.9.9.9.1.1.1.cmml"><mrow id="S3.E12.m1.9.9.9.9.1.1.1.2.2" xref="S3.E12.m1.9.9.9.9.1.1.1.2.3.cmml"><mo id="S3.E12.m1.9.9.9.9.1.1.1.2.2.3" xref="S3.E12.m1.9.9.9.9.1.1.1.2.3.cmml">⟨</mo><msubsup id="S3.E12.m1.9.9.9.9.1.1.1.1.1.1" xref="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.2.2" mathsize="90%" xref="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.2.2.cmml">m</mi><mi id="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.3" mathsize="90%" xref="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.3.cmml">i</mi><mrow id="S3.E12.m1.2.2.2.2.2.4" xref="S3.E12.m1.2.2.2.2.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1" mathsize="90%" xref="S3.E12.m1.1.1.1.1.1.1.cmml">q</mi><mo id="S3.E12.m1.2.2.2.2.2.4.1" mathsize="90%" xref="S3.E12.m1.2.2.2.2.2.3.cmml">;</mo><mi id="S3.E12.m1.2.2.2.2.2.2" mathsize="90%" xref="S3.E12.m1.2.2.2.2.2.2.cmml">p</mi></mrow></msubsup><mo id="S3.E12.m1.9.9.9.9.1.1.1.2.2.4" mathsize="90%" xref="S3.E12.m1.9.9.9.9.1.1.1.2.3.cmml">,</mo><msubsup id="S3.E12.m1.9.9.9.9.1.1.1.2.2.2" xref="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.cmml"><mi id="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.2.2" mathsize="90%" xref="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.2.2.cmml">m</mi><mi id="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.3" mathsize="90%" xref="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.3.cmml">j</mi><mrow id="S3.E12.m1.4.4.4.4.2.4" xref="S3.E12.m1.4.4.4.4.2.3.cmml"><mi id="S3.E12.m1.3.3.3.3.1.1" mathsize="90%" xref="S3.E12.m1.3.3.3.3.1.1.cmml">q</mi><mo id="S3.E12.m1.4.4.4.4.2.4.1" mathsize="90%" xref="S3.E12.m1.4.4.4.4.2.3.cmml">;</mo><mi id="S3.E12.m1.4.4.4.4.2.2" mathsize="90%" xref="S3.E12.m1.4.4.4.4.2.2.cmml">p</mi></mrow></msubsup><mo id="S3.E12.m1.9.9.9.9.1.1.1.2.2.5" xref="S3.E12.m1.9.9.9.9.1.1.1.2.3.cmml">⟩</mo></mrow><mo id="S3.E12.m1.9.9.9.9.1.1.1.5" mathsize="90%" xref="S3.E12.m1.9.9.9.9.1.1.1.5.cmml">+</mo><mrow id="S3.E12.m1.9.9.9.9.1.1.1.4.2" xref="S3.E12.m1.9.9.9.9.1.1.1.4.3.cmml"><mo id="S3.E12.m1.9.9.9.9.1.1.1.4.2.3" xref="S3.E12.m1.9.9.9.9.1.1.1.4.3.cmml">⟨</mo><msubsup id="S3.E12.m1.9.9.9.9.1.1.1.3.1.1" xref="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.cmml"><mi id="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.2.2" mathsize="90%" xref="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.2.2.cmml">m</mi><mi id="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.3" mathsize="90%" xref="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.3.cmml">i</mi><mrow id="S3.E12.m1.6.6.6.6.2.4" xref="S3.E12.m1.6.6.6.6.2.3.cmml"><mi id="S3.E12.m1.5.5.5.5.1.1" mathsize="90%" xref="S3.E12.m1.5.5.5.5.1.1.cmml">s</mi><mo id="S3.E12.m1.6.6.6.6.2.4.1" mathsize="90%" xref="S3.E12.m1.6.6.6.6.2.3.cmml">;</mo><mi id="S3.E12.m1.6.6.6.6.2.2" mathsize="90%" xref="S3.E12.m1.6.6.6.6.2.2.cmml">p</mi></mrow></msubsup><mo id="S3.E12.m1.9.9.9.9.1.1.1.4.2.4" mathsize="90%" xref="S3.E12.m1.9.9.9.9.1.1.1.4.3.cmml">,</mo><msubsup id="S3.E12.m1.9.9.9.9.1.1.1.4.2.2" xref="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.cmml"><mi id="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.2.2" mathsize="90%" xref="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.2.2.cmml">m</mi><mi id="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.3" mathsize="90%" xref="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.3.cmml">j</mi><mrow id="S3.E12.m1.8.8.8.8.2.4" xref="S3.E12.m1.8.8.8.8.2.3.cmml"><mi id="S3.E12.m1.7.7.7.7.1.1" mathsize="90%" xref="S3.E12.m1.7.7.7.7.1.1.cmml">s</mi><mo id="S3.E12.m1.8.8.8.8.2.4.1" mathsize="90%" xref="S3.E12.m1.8.8.8.8.2.3.cmml">;</mo><mi id="S3.E12.m1.8.8.8.8.2.2" mathsize="90%" xref="S3.E12.m1.8.8.8.8.2.2.cmml">p</mi></mrow></msubsup><mo id="S3.E12.m1.9.9.9.9.1.1.1.4.2.5" xref="S3.E12.m1.9.9.9.9.1.1.1.4.3.cmml">⟩</mo></mrow></mrow><mo id="S3.E12.m1.9.9.9.9.1.1.3" xref="S3.E12.m1.9.9.9.9.1.2.1.cmml">]</mo></mrow></mrow></mrow><mrow id="S3.E12.m1.10.10.10" xref="S3.E12.m1.10.10.10.cmml"><mn id="S3.E12.m1.10.10.10.3" mathsize="90%" xref="S3.E12.m1.10.10.10.3.cmml">2</mn><mo id="S3.E12.m1.10.10.10.2" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S3.E12.m1.10.10.10.2.cmml">∗</mo><msub id="S3.E12.m1.10.10.10.4" xref="S3.E12.m1.10.10.10.4.cmml"><mi id="S3.E12.m1.10.10.10.4.2" mathsize="90%" xref="S3.E12.m1.10.10.10.4.2.cmml">N</mi><mi id="S3.E12.m1.10.10.10.4.3" mathsize="90%" xref="S3.E12.m1.10.10.10.4.3.cmml">p</mi></msub><mo id="S3.E12.m1.10.10.10.2a" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S3.E12.m1.10.10.10.2.cmml">∗</mo><mrow id="S3.E12.m1.10.10.10.1.1" xref="S3.E12.m1.10.10.10.1.1.1.cmml"><mo id="S3.E12.m1.10.10.10.1.1.2" xref="S3.E12.m1.10.10.10.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.10.10.10.1.1.1" xref="S3.E12.m1.10.10.10.1.1.1.cmml"><msub id="S3.E12.m1.10.10.10.1.1.1.2" xref="S3.E12.m1.10.10.10.1.1.1.2.cmml"><mi id="S3.E12.m1.10.10.10.1.1.1.2.2" mathsize="90%" xref="S3.E12.m1.10.10.10.1.1.1.2.2.cmml">N</mi><mi id="S3.E12.m1.10.10.10.1.1.1.2.3" mathsize="90%" xref="S3.E12.m1.10.10.10.1.1.1.2.3.cmml">p</mi></msub><mo id="S3.E12.m1.10.10.10.1.1.1.1" mathsize="90%" xref="S3.E12.m1.10.10.10.1.1.1.1.cmml">−</mo><mn id="S3.E12.m1.10.10.10.1.1.1.3" mathsize="90%" xref="S3.E12.m1.10.10.10.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E12.m1.10.10.10.1.1.3" xref="S3.E12.m1.10.10.10.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.10b"><apply id="S3.E12.m1.10.11.cmml" xref="S3.E12.m1.10.11"><eq id="S3.E12.m1.10.11.1.cmml" xref="S3.E12.m1.10.11.1"></eq><apply id="S3.E12.m1.10.11.2.cmml" xref="S3.E12.m1.10.11.2"><csymbol cd="ambiguous" id="S3.E12.m1.10.11.2.1.cmml" xref="S3.E12.m1.10.11.2">subscript</csymbol><ci id="S3.E12.m1.10.11.2.2.cmml" xref="S3.E12.m1.10.11.2.2">ℒ</ci><apply id="S3.E12.m1.10.11.2.3.cmml" xref="S3.E12.m1.10.11.2.3"><times id="S3.E12.m1.10.11.2.3.1.cmml" xref="S3.E12.m1.10.11.2.3.1"></times><ci id="S3.E12.m1.10.11.2.3.2.cmml" xref="S3.E12.m1.10.11.2.3.2">𝑟</ci><ci id="S3.E12.m1.10.11.2.3.3.cmml" xref="S3.E12.m1.10.11.2.3.3">𝑒</ci><ci id="S3.E12.m1.10.11.2.3.4.cmml" xref="S3.E12.m1.10.11.2.3.4">𝑔</ci></apply></apply><apply id="S3.E12.m1.10.10.cmml" xref="S3.E12.m1.10.10"><divide id="S3.E12.m1.10.10.11.cmml" xref="S3.E12.m1.10.10"></divide><apply id="S3.E12.m1.9.9.9.cmml" xref="S3.E12.m1.9.9.9"><apply id="S3.E12.m1.9.9.9.10.cmml" xref="S3.E12.m1.9.9.9.10"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.10.1.cmml" xref="S3.E12.m1.9.9.9.10">superscript</csymbol><apply id="S3.E12.m1.9.9.9.10.2.cmml" xref="S3.E12.m1.9.9.9.10"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.10.2.1.cmml" xref="S3.E12.m1.9.9.9.10">subscript</csymbol><sum id="S3.E12.m1.9.9.9.10.2.2.cmml" xref="S3.E12.m1.9.9.9.10.2.2"></sum><apply id="S3.E12.m1.9.9.9.10.2.3.cmml" xref="S3.E12.m1.9.9.9.10.2.3"><eq id="S3.E12.m1.9.9.9.10.2.3.1.cmml" xref="S3.E12.m1.9.9.9.10.2.3.1"></eq><ci id="S3.E12.m1.9.9.9.10.2.3.2.cmml" xref="S3.E12.m1.9.9.9.10.2.3.2">𝑖</ci><cn id="S3.E12.m1.9.9.9.10.2.3.3.cmml" type="integer" xref="S3.E12.m1.9.9.9.10.2.3.3">1</cn></apply></apply><apply id="S3.E12.m1.9.9.9.10.3.cmml" xref="S3.E12.m1.9.9.9.10.3"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.10.3.1.cmml" xref="S3.E12.m1.9.9.9.10.3">subscript</csymbol><ci id="S3.E12.m1.9.9.9.10.3.2.cmml" xref="S3.E12.m1.9.9.9.10.3.2">𝑁</ci><ci id="S3.E12.m1.9.9.9.10.3.3.cmml" xref="S3.E12.m1.9.9.9.10.3.3">𝑝</ci></apply></apply><apply id="S3.E12.m1.9.9.9.9.cmml" xref="S3.E12.m1.9.9.9.9"><apply id="S3.E12.m1.9.9.9.9.2.cmml" xref="S3.E12.m1.9.9.9.9.2"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.9.2.1.cmml" xref="S3.E12.m1.9.9.9.9.2">superscript</csymbol><apply id="S3.E12.m1.9.9.9.9.2.2.cmml" xref="S3.E12.m1.9.9.9.9.2"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.9.2.2.1.cmml" xref="S3.E12.m1.9.9.9.9.2">subscript</csymbol><sum id="S3.E12.m1.9.9.9.9.2.2.2.cmml" xref="S3.E12.m1.9.9.9.9.2.2.2"></sum><apply id="S3.E12.m1.9.9.9.9.2.2.3.cmml" xref="S3.E12.m1.9.9.9.9.2.2.3"><neq id="S3.E12.m1.9.9.9.9.2.2.3.1.cmml" xref="S3.E12.m1.9.9.9.9.2.2.3.1"></neq><ci id="S3.E12.m1.9.9.9.9.2.2.3.2.cmml" xref="S3.E12.m1.9.9.9.9.2.2.3.2">𝑗</ci><ci id="S3.E12.m1.9.9.9.9.2.2.3.3.cmml" xref="S3.E12.m1.9.9.9.9.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.E12.m1.9.9.9.9.2.3.cmml" xref="S3.E12.m1.9.9.9.9.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.9.2.3.1.cmml" xref="S3.E12.m1.9.9.9.9.2.3">subscript</csymbol><ci id="S3.E12.m1.9.9.9.9.2.3.2.cmml" xref="S3.E12.m1.9.9.9.9.2.3.2">𝑁</ci><ci id="S3.E12.m1.9.9.9.9.2.3.3.cmml" xref="S3.E12.m1.9.9.9.9.2.3.3">𝑝</ci></apply></apply><apply id="S3.E12.m1.9.9.9.9.1.2.cmml" xref="S3.E12.m1.9.9.9.9.1.1"><csymbol cd="latexml" id="S3.E12.m1.9.9.9.9.1.2.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.2">delimited-[]</csymbol><apply id="S3.E12.m1.9.9.9.9.1.1.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1"><plus id="S3.E12.m1.9.9.9.9.1.1.1.5.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.5"></plus><list id="S3.E12.m1.9.9.9.9.1.1.1.2.3.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.2.2"><apply id="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.2.2">𝑚</ci><list id="S3.E12.m1.2.2.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.2.2.4"><ci id="S3.E12.m1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1">𝑞</ci><ci id="S3.E12.m1.2.2.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2.2.2">𝑝</ci></list></apply><ci id="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.2.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.2.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.2.2.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.2.2">𝑚</ci><list id="S3.E12.m1.4.4.4.4.2.3.cmml" xref="S3.E12.m1.4.4.4.4.2.4"><ci id="S3.E12.m1.3.3.3.3.1.1.cmml" xref="S3.E12.m1.3.3.3.3.1.1">𝑞</ci><ci id="S3.E12.m1.4.4.4.4.2.2.cmml" xref="S3.E12.m1.4.4.4.4.2.2">𝑝</ci></list></apply><ci id="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.3.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.2.2.2.3">𝑗</ci></apply></list><list id="S3.E12.m1.9.9.9.9.1.1.1.4.3.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.4.2"><apply id="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.3.1.1">subscript</csymbol><apply id="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.2.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.2.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.3.1.1">superscript</csymbol><ci id="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.2.2.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.2.2">𝑚</ci><list id="S3.E12.m1.6.6.6.6.2.3.cmml" xref="S3.E12.m1.6.6.6.6.2.4"><ci id="S3.E12.m1.5.5.5.5.1.1.cmml" xref="S3.E12.m1.5.5.5.5.1.1">𝑠</ci><ci id="S3.E12.m1.6.6.6.6.2.2.cmml" xref="S3.E12.m1.6.6.6.6.2.2">𝑝</ci></list></apply><ci id="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.3.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.3.1.1.3">𝑖</ci></apply><apply id="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.4.2.2">subscript</csymbol><apply id="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.2.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.2.1.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.4.2.2">superscript</csymbol><ci id="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.2.2.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.2.2">𝑚</ci><list id="S3.E12.m1.8.8.8.8.2.3.cmml" xref="S3.E12.m1.8.8.8.8.2.4"><ci id="S3.E12.m1.7.7.7.7.1.1.cmml" xref="S3.E12.m1.7.7.7.7.1.1">𝑠</ci><ci id="S3.E12.m1.8.8.8.8.2.2.cmml" xref="S3.E12.m1.8.8.8.8.2.2">𝑝</ci></list></apply><ci id="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.3.cmml" xref="S3.E12.m1.9.9.9.9.1.1.1.4.2.2.3">𝑗</ci></apply></list></apply></apply></apply></apply><apply id="S3.E12.m1.10.10.10.cmml" xref="S3.E12.m1.10.10.10"><times id="S3.E12.m1.10.10.10.2.cmml" xref="S3.E12.m1.10.10.10.2"></times><cn id="S3.E12.m1.10.10.10.3.cmml" type="integer" xref="S3.E12.m1.10.10.10.3">2</cn><apply id="S3.E12.m1.10.10.10.4.cmml" xref="S3.E12.m1.10.10.10.4"><csymbol cd="ambiguous" id="S3.E12.m1.10.10.10.4.1.cmml" xref="S3.E12.m1.10.10.10.4">subscript</csymbol><ci id="S3.E12.m1.10.10.10.4.2.cmml" xref="S3.E12.m1.10.10.10.4.2">𝑁</ci><ci id="S3.E12.m1.10.10.10.4.3.cmml" xref="S3.E12.m1.10.10.10.4.3">𝑝</ci></apply><apply id="S3.E12.m1.10.10.10.1.1.1.cmml" xref="S3.E12.m1.10.10.10.1.1"><minus id="S3.E12.m1.10.10.10.1.1.1.1.cmml" xref="S3.E12.m1.10.10.10.1.1.1.1"></minus><apply id="S3.E12.m1.10.10.10.1.1.1.2.cmml" xref="S3.E12.m1.10.10.10.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.10.10.10.1.1.1.2.1.cmml" xref="S3.E12.m1.10.10.10.1.1.1.2">subscript</csymbol><ci id="S3.E12.m1.10.10.10.1.1.1.2.2.cmml" xref="S3.E12.m1.10.10.10.1.1.1.2.2">𝑁</ci><ci id="S3.E12.m1.10.10.10.1.1.1.2.3.cmml" xref="S3.E12.m1.10.10.10.1.1.1.2.3">𝑝</ci></apply><cn id="S3.E12.m1.10.10.10.1.1.1.3.cmml" type="integer" xref="S3.E12.m1.10.10.10.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.10c">{\mathcal{L}_{reg}}=\frac{\sum_{i=1}^{N_{p}}\sum_{j\neq i\ }^{N_{p}}\left[{%
\left\langle m^{q;p}_{i},m^{q;p}_{j}\right\rangle+\left\langle m^{s;p}_{i},m^{%
s;p}_{j}\right\rangle}\right]}{2*N_{p}*\left(N_{p}-1\right)}</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.10d">caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_g end_POSTSUBSCRIPT = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j ≠ italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUPERSCRIPT [ ⟨ italic_m start_POSTSUPERSCRIPT italic_q ; italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_m start_POSTSUPERSCRIPT italic_q ; italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ + ⟨ italic_m start_POSTSUPERSCRIPT italic_s ; italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_m start_POSTSUPERSCRIPT italic_s ; italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ ] end_ARG start_ARG 2 ∗ italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ∗ ( italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT - 1 ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS6.p4">
<p class="ltx_p" id="S3.SS6.p4.1">By minimizing the similarity between different part masks, the part masks are restricted to focus on different regions thus capturing different part prompts.</p>
</div>
<div class="ltx_para" id="S3.SS6.p5">
<p class="ltx_p" id="S3.SS6.p5.1">2) We propose a prompt-based contrast loss to efficiently distinguish foreground semantics from background semantics:
<span class="ltx_text" id="S3.SS6.p5.1.1" style="font-size:90%;"></span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\mathcal{L}_{dis}}=-{\log}{\frac{\exp{\left\langle P^{*},w_{f}^{*}\right%
\rangle}+\exp{\left\langle B^{*},w_{b}^{*}\right\rangle}}{\exp{\left\langle P^%
{*},B^{*}\right\rangle}+\exp{\left\langle P^{*},w_{b}^{*}\right\rangle}+\exp{%
\left\langle B^{*},w_{f}^{*}\right\rangle}}}" class="ltx_Math" display="block" id="S3.E13.m1.15"><semantics id="S3.E13.m1.15a"><mrow id="S3.E13.m1.15.16" xref="S3.E13.m1.15.16.cmml"><msub id="S3.E13.m1.15.16.2" xref="S3.E13.m1.15.16.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.15.16.2.2" mathsize="90%" xref="S3.E13.m1.15.16.2.2.cmml">ℒ</mi><mrow id="S3.E13.m1.15.16.2.3" xref="S3.E13.m1.15.16.2.3.cmml"><mi id="S3.E13.m1.15.16.2.3.2" mathsize="90%" xref="S3.E13.m1.15.16.2.3.2.cmml">d</mi><mo id="S3.E13.m1.15.16.2.3.1" xref="S3.E13.m1.15.16.2.3.1.cmml">⁢</mo><mi id="S3.E13.m1.15.16.2.3.3" mathsize="90%" xref="S3.E13.m1.15.16.2.3.3.cmml">i</mi><mo id="S3.E13.m1.15.16.2.3.1a" xref="S3.E13.m1.15.16.2.3.1.cmml">⁢</mo><mi id="S3.E13.m1.15.16.2.3.4" mathsize="90%" xref="S3.E13.m1.15.16.2.3.4.cmml">s</mi></mrow></msub><mo id="S3.E13.m1.15.16.1" mathsize="90%" xref="S3.E13.m1.15.16.1.cmml">=</mo><mrow id="S3.E13.m1.15.16.3" xref="S3.E13.m1.15.16.3.cmml"><mo id="S3.E13.m1.15.16.3a" mathsize="90%" rspace="0.167em" xref="S3.E13.m1.15.16.3.cmml">−</mo><mrow id="S3.E13.m1.15.16.3.2" xref="S3.E13.m1.15.16.3.2.cmml"><mi id="S3.E13.m1.15.16.3.2.1" mathsize="90%" xref="S3.E13.m1.15.16.3.2.1.cmml">log</mi><mo id="S3.E13.m1.15.16.3.2a" lspace="0.167em" xref="S3.E13.m1.15.16.3.2.cmml">⁡</mo><mfrac id="S3.E13.m1.15.15" xref="S3.E13.m1.15.15.cmml"><mrow id="S3.E13.m1.6.6.6" xref="S3.E13.m1.6.6.6.cmml"><mrow id="S3.E13.m1.4.4.4.4.2" xref="S3.E13.m1.4.4.4.4.3.cmml"><mi id="S3.E13.m1.1.1.1.1" mathsize="90%" xref="S3.E13.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E13.m1.4.4.4.4.2a" xref="S3.E13.m1.4.4.4.4.3.cmml">⁡</mo><mrow id="S3.E13.m1.4.4.4.4.2.2" xref="S3.E13.m1.4.4.4.4.3.cmml"><mo id="S3.E13.m1.4.4.4.4.2.2.3" xref="S3.E13.m1.4.4.4.4.3.cmml">⟨</mo><msup id="S3.E13.m1.3.3.3.3.1.1.1" xref="S3.E13.m1.3.3.3.3.1.1.1.cmml"><mi id="S3.E13.m1.3.3.3.3.1.1.1.2" mathsize="90%" xref="S3.E13.m1.3.3.3.3.1.1.1.2.cmml">P</mi><mo id="S3.E13.m1.3.3.3.3.1.1.1.3" mathsize="90%" xref="S3.E13.m1.3.3.3.3.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E13.m1.4.4.4.4.2.2.4" mathsize="90%" xref="S3.E13.m1.4.4.4.4.3.cmml">,</mo><msubsup id="S3.E13.m1.4.4.4.4.2.2.2" xref="S3.E13.m1.4.4.4.4.2.2.2.cmml"><mi id="S3.E13.m1.4.4.4.4.2.2.2.2.2" mathsize="90%" xref="S3.E13.m1.4.4.4.4.2.2.2.2.2.cmml">w</mi><mi id="S3.E13.m1.4.4.4.4.2.2.2.2.3" mathsize="90%" xref="S3.E13.m1.4.4.4.4.2.2.2.2.3.cmml">f</mi><mo id="S3.E13.m1.4.4.4.4.2.2.2.3" mathsize="90%" xref="S3.E13.m1.4.4.4.4.2.2.2.3.cmml">∗</mo></msubsup><mo id="S3.E13.m1.4.4.4.4.2.2.5" xref="S3.E13.m1.4.4.4.4.3.cmml">⟩</mo></mrow></mrow><mo id="S3.E13.m1.6.6.6.7" mathsize="90%" xref="S3.E13.m1.6.6.6.7.cmml">+</mo><mrow id="S3.E13.m1.6.6.6.6.2" xref="S3.E13.m1.6.6.6.6.3.cmml"><mi id="S3.E13.m1.2.2.2.2" mathsize="90%" xref="S3.E13.m1.2.2.2.2.cmml">exp</mi><mo id="S3.E13.m1.6.6.6.6.2a" xref="S3.E13.m1.6.6.6.6.3.cmml">⁡</mo><mrow id="S3.E13.m1.6.6.6.6.2.2" xref="S3.E13.m1.6.6.6.6.3.cmml"><mo id="S3.E13.m1.6.6.6.6.2.2.3" xref="S3.E13.m1.6.6.6.6.3.cmml">⟨</mo><msup id="S3.E13.m1.5.5.5.5.1.1.1" xref="S3.E13.m1.5.5.5.5.1.1.1.cmml"><mi id="S3.E13.m1.5.5.5.5.1.1.1.2" mathsize="90%" xref="S3.E13.m1.5.5.5.5.1.1.1.2.cmml">B</mi><mo id="S3.E13.m1.5.5.5.5.1.1.1.3" mathsize="90%" xref="S3.E13.m1.5.5.5.5.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E13.m1.6.6.6.6.2.2.4" mathsize="90%" xref="S3.E13.m1.6.6.6.6.3.cmml">,</mo><msubsup id="S3.E13.m1.6.6.6.6.2.2.2" xref="S3.E13.m1.6.6.6.6.2.2.2.cmml"><mi id="S3.E13.m1.6.6.6.6.2.2.2.2.2" mathsize="90%" xref="S3.E13.m1.6.6.6.6.2.2.2.2.2.cmml">w</mi><mi id="S3.E13.m1.6.6.6.6.2.2.2.2.3" mathsize="90%" xref="S3.E13.m1.6.6.6.6.2.2.2.2.3.cmml">b</mi><mo id="S3.E13.m1.6.6.6.6.2.2.2.3" mathsize="90%" xref="S3.E13.m1.6.6.6.6.2.2.2.3.cmml">∗</mo></msubsup><mo id="S3.E13.m1.6.6.6.6.2.2.5" xref="S3.E13.m1.6.6.6.6.3.cmml">⟩</mo></mrow></mrow></mrow><mrow id="S3.E13.m1.15.15.15" xref="S3.E13.m1.15.15.15.cmml"><mrow id="S3.E13.m1.11.11.11.5.2" xref="S3.E13.m1.11.11.11.5.3.cmml"><mi id="S3.E13.m1.7.7.7.1" mathsize="90%" xref="S3.E13.m1.7.7.7.1.cmml">exp</mi><mo id="S3.E13.m1.11.11.11.5.2a" xref="S3.E13.m1.11.11.11.5.3.cmml">⁡</mo><mrow id="S3.E13.m1.11.11.11.5.2.2" xref="S3.E13.m1.11.11.11.5.3.cmml"><mo id="S3.E13.m1.11.11.11.5.2.2.3" xref="S3.E13.m1.11.11.11.5.3.cmml">⟨</mo><msup id="S3.E13.m1.10.10.10.4.1.1.1" xref="S3.E13.m1.10.10.10.4.1.1.1.cmml"><mi id="S3.E13.m1.10.10.10.4.1.1.1.2" mathsize="90%" xref="S3.E13.m1.10.10.10.4.1.1.1.2.cmml">P</mi><mo id="S3.E13.m1.10.10.10.4.1.1.1.3" mathsize="90%" xref="S3.E13.m1.10.10.10.4.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E13.m1.11.11.11.5.2.2.4" mathsize="90%" xref="S3.E13.m1.11.11.11.5.3.cmml">,</mo><msup id="S3.E13.m1.11.11.11.5.2.2.2" xref="S3.E13.m1.11.11.11.5.2.2.2.cmml"><mi id="S3.E13.m1.11.11.11.5.2.2.2.2" mathsize="90%" xref="S3.E13.m1.11.11.11.5.2.2.2.2.cmml">B</mi><mo id="S3.E13.m1.11.11.11.5.2.2.2.3" mathsize="90%" xref="S3.E13.m1.11.11.11.5.2.2.2.3.cmml">∗</mo></msup><mo id="S3.E13.m1.11.11.11.5.2.2.5" xref="S3.E13.m1.11.11.11.5.3.cmml">⟩</mo></mrow></mrow><mo id="S3.E13.m1.15.15.15.10" mathsize="90%" xref="S3.E13.m1.15.15.15.10.cmml">+</mo><mrow id="S3.E13.m1.13.13.13.7.2" xref="S3.E13.m1.13.13.13.7.3.cmml"><mi id="S3.E13.m1.8.8.8.2" mathsize="90%" xref="S3.E13.m1.8.8.8.2.cmml">exp</mi><mo id="S3.E13.m1.13.13.13.7.2a" xref="S3.E13.m1.13.13.13.7.3.cmml">⁡</mo><mrow id="S3.E13.m1.13.13.13.7.2.2" xref="S3.E13.m1.13.13.13.7.3.cmml"><mo id="S3.E13.m1.13.13.13.7.2.2.3" xref="S3.E13.m1.13.13.13.7.3.cmml">⟨</mo><msup id="S3.E13.m1.12.12.12.6.1.1.1" xref="S3.E13.m1.12.12.12.6.1.1.1.cmml"><mi id="S3.E13.m1.12.12.12.6.1.1.1.2" mathsize="90%" xref="S3.E13.m1.12.12.12.6.1.1.1.2.cmml">P</mi><mo id="S3.E13.m1.12.12.12.6.1.1.1.3" mathsize="90%" xref="S3.E13.m1.12.12.12.6.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E13.m1.13.13.13.7.2.2.4" mathsize="90%" xref="S3.E13.m1.13.13.13.7.3.cmml">,</mo><msubsup id="S3.E13.m1.13.13.13.7.2.2.2" xref="S3.E13.m1.13.13.13.7.2.2.2.cmml"><mi id="S3.E13.m1.13.13.13.7.2.2.2.2.2" mathsize="90%" xref="S3.E13.m1.13.13.13.7.2.2.2.2.2.cmml">w</mi><mi id="S3.E13.m1.13.13.13.7.2.2.2.2.3" mathsize="90%" xref="S3.E13.m1.13.13.13.7.2.2.2.2.3.cmml">b</mi><mo id="S3.E13.m1.13.13.13.7.2.2.2.3" mathsize="90%" xref="S3.E13.m1.13.13.13.7.2.2.2.3.cmml">∗</mo></msubsup><mo id="S3.E13.m1.13.13.13.7.2.2.5" xref="S3.E13.m1.13.13.13.7.3.cmml">⟩</mo></mrow></mrow><mo id="S3.E13.m1.15.15.15.10a" mathsize="90%" xref="S3.E13.m1.15.15.15.10.cmml">+</mo><mrow id="S3.E13.m1.15.15.15.9.2" xref="S3.E13.m1.15.15.15.9.3.cmml"><mi id="S3.E13.m1.9.9.9.3" mathsize="90%" xref="S3.E13.m1.9.9.9.3.cmml">exp</mi><mo id="S3.E13.m1.15.15.15.9.2a" xref="S3.E13.m1.15.15.15.9.3.cmml">⁡</mo><mrow id="S3.E13.m1.15.15.15.9.2.2" xref="S3.E13.m1.15.15.15.9.3.cmml"><mo id="S3.E13.m1.15.15.15.9.2.2.3" xref="S3.E13.m1.15.15.15.9.3.cmml">⟨</mo><msup id="S3.E13.m1.14.14.14.8.1.1.1" xref="S3.E13.m1.14.14.14.8.1.1.1.cmml"><mi id="S3.E13.m1.14.14.14.8.1.1.1.2" mathsize="90%" xref="S3.E13.m1.14.14.14.8.1.1.1.2.cmml">B</mi><mo id="S3.E13.m1.14.14.14.8.1.1.1.3" mathsize="90%" xref="S3.E13.m1.14.14.14.8.1.1.1.3.cmml">∗</mo></msup><mo id="S3.E13.m1.15.15.15.9.2.2.4" mathsize="90%" xref="S3.E13.m1.15.15.15.9.3.cmml">,</mo><msubsup id="S3.E13.m1.15.15.15.9.2.2.2" xref="S3.E13.m1.15.15.15.9.2.2.2.cmml"><mi id="S3.E13.m1.15.15.15.9.2.2.2.2.2" mathsize="90%" xref="S3.E13.m1.15.15.15.9.2.2.2.2.2.cmml">w</mi><mi id="S3.E13.m1.15.15.15.9.2.2.2.2.3" mathsize="90%" xref="S3.E13.m1.15.15.15.9.2.2.2.2.3.cmml">f</mi><mo id="S3.E13.m1.15.15.15.9.2.2.2.3" mathsize="90%" xref="S3.E13.m1.15.15.15.9.2.2.2.3.cmml">∗</mo></msubsup><mo id="S3.E13.m1.15.15.15.9.2.2.5" xref="S3.E13.m1.15.15.15.9.3.cmml">⟩</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.15b"><apply id="S3.E13.m1.15.16.cmml" xref="S3.E13.m1.15.16"><eq id="S3.E13.m1.15.16.1.cmml" xref="S3.E13.m1.15.16.1"></eq><apply id="S3.E13.m1.15.16.2.cmml" xref="S3.E13.m1.15.16.2"><csymbol cd="ambiguous" id="S3.E13.m1.15.16.2.1.cmml" xref="S3.E13.m1.15.16.2">subscript</csymbol><ci id="S3.E13.m1.15.16.2.2.cmml" xref="S3.E13.m1.15.16.2.2">ℒ</ci><apply id="S3.E13.m1.15.16.2.3.cmml" xref="S3.E13.m1.15.16.2.3"><times id="S3.E13.m1.15.16.2.3.1.cmml" xref="S3.E13.m1.15.16.2.3.1"></times><ci id="S3.E13.m1.15.16.2.3.2.cmml" xref="S3.E13.m1.15.16.2.3.2">𝑑</ci><ci id="S3.E13.m1.15.16.2.3.3.cmml" xref="S3.E13.m1.15.16.2.3.3">𝑖</ci><ci id="S3.E13.m1.15.16.2.3.4.cmml" xref="S3.E13.m1.15.16.2.3.4">𝑠</ci></apply></apply><apply id="S3.E13.m1.15.16.3.cmml" xref="S3.E13.m1.15.16.3"><minus id="S3.E13.m1.15.16.3.1.cmml" xref="S3.E13.m1.15.16.3"></minus><apply id="S3.E13.m1.15.16.3.2.cmml" xref="S3.E13.m1.15.16.3.2"><log id="S3.E13.m1.15.16.3.2.1.cmml" xref="S3.E13.m1.15.16.3.2.1"></log><apply id="S3.E13.m1.15.15.cmml" xref="S3.E13.m1.15.15"><divide id="S3.E13.m1.15.15.16.cmml" xref="S3.E13.m1.15.15"></divide><apply id="S3.E13.m1.6.6.6.cmml" xref="S3.E13.m1.6.6.6"><plus id="S3.E13.m1.6.6.6.7.cmml" xref="S3.E13.m1.6.6.6.7"></plus><apply id="S3.E13.m1.4.4.4.4.3.cmml" xref="S3.E13.m1.4.4.4.4.2"><exp id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1"></exp><apply id="S3.E13.m1.3.3.3.3.1.1.1.cmml" xref="S3.E13.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E13.m1.3.3.3.3.1.1.1">superscript</csymbol><ci id="S3.E13.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E13.m1.3.3.3.3.1.1.1.2">𝑃</ci><times id="S3.E13.m1.3.3.3.3.1.1.1.3.cmml" xref="S3.E13.m1.3.3.3.3.1.1.1.3"></times></apply><apply id="S3.E13.m1.4.4.4.4.2.2.2.cmml" xref="S3.E13.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.4.4.2.2.2.1.cmml" xref="S3.E13.m1.4.4.4.4.2.2.2">superscript</csymbol><apply id="S3.E13.m1.4.4.4.4.2.2.2.2.cmml" xref="S3.E13.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.4.4.2.2.2.2.1.cmml" xref="S3.E13.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="S3.E13.m1.4.4.4.4.2.2.2.2.2.cmml" xref="S3.E13.m1.4.4.4.4.2.2.2.2.2">𝑤</ci><ci id="S3.E13.m1.4.4.4.4.2.2.2.2.3.cmml" xref="S3.E13.m1.4.4.4.4.2.2.2.2.3">𝑓</ci></apply><times id="S3.E13.m1.4.4.4.4.2.2.2.3.cmml" xref="S3.E13.m1.4.4.4.4.2.2.2.3"></times></apply></apply><apply id="S3.E13.m1.6.6.6.6.3.cmml" xref="S3.E13.m1.6.6.6.6.2"><exp id="S3.E13.m1.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2"></exp><apply id="S3.E13.m1.5.5.5.5.1.1.1.cmml" xref="S3.E13.m1.5.5.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.5.5.5.5.1.1.1.1.cmml" xref="S3.E13.m1.5.5.5.5.1.1.1">superscript</csymbol><ci id="S3.E13.m1.5.5.5.5.1.1.1.2.cmml" xref="S3.E13.m1.5.5.5.5.1.1.1.2">𝐵</ci><times id="S3.E13.m1.5.5.5.5.1.1.1.3.cmml" xref="S3.E13.m1.5.5.5.5.1.1.1.3"></times></apply><apply id="S3.E13.m1.6.6.6.6.2.2.2.cmml" xref="S3.E13.m1.6.6.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.6.6.6.6.2.2.2.1.cmml" xref="S3.E13.m1.6.6.6.6.2.2.2">superscript</csymbol><apply id="S3.E13.m1.6.6.6.6.2.2.2.2.cmml" xref="S3.E13.m1.6.6.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.6.6.6.6.2.2.2.2.1.cmml" xref="S3.E13.m1.6.6.6.6.2.2.2">subscript</csymbol><ci id="S3.E13.m1.6.6.6.6.2.2.2.2.2.cmml" xref="S3.E13.m1.6.6.6.6.2.2.2.2.2">𝑤</ci><ci id="S3.E13.m1.6.6.6.6.2.2.2.2.3.cmml" xref="S3.E13.m1.6.6.6.6.2.2.2.2.3">𝑏</ci></apply><times id="S3.E13.m1.6.6.6.6.2.2.2.3.cmml" xref="S3.E13.m1.6.6.6.6.2.2.2.3"></times></apply></apply></apply><apply id="S3.E13.m1.15.15.15.cmml" xref="S3.E13.m1.15.15.15"><plus id="S3.E13.m1.15.15.15.10.cmml" xref="S3.E13.m1.15.15.15.10"></plus><apply id="S3.E13.m1.11.11.11.5.3.cmml" xref="S3.E13.m1.11.11.11.5.2"><exp id="S3.E13.m1.7.7.7.1.cmml" xref="S3.E13.m1.7.7.7.1"></exp><apply id="S3.E13.m1.10.10.10.4.1.1.1.cmml" xref="S3.E13.m1.10.10.10.4.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.10.10.10.4.1.1.1.1.cmml" xref="S3.E13.m1.10.10.10.4.1.1.1">superscript</csymbol><ci id="S3.E13.m1.10.10.10.4.1.1.1.2.cmml" xref="S3.E13.m1.10.10.10.4.1.1.1.2">𝑃</ci><times id="S3.E13.m1.10.10.10.4.1.1.1.3.cmml" xref="S3.E13.m1.10.10.10.4.1.1.1.3"></times></apply><apply id="S3.E13.m1.11.11.11.5.2.2.2.cmml" xref="S3.E13.m1.11.11.11.5.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.11.11.11.5.2.2.2.1.cmml" xref="S3.E13.m1.11.11.11.5.2.2.2">superscript</csymbol><ci id="S3.E13.m1.11.11.11.5.2.2.2.2.cmml" xref="S3.E13.m1.11.11.11.5.2.2.2.2">𝐵</ci><times id="S3.E13.m1.11.11.11.5.2.2.2.3.cmml" xref="S3.E13.m1.11.11.11.5.2.2.2.3"></times></apply></apply><apply id="S3.E13.m1.13.13.13.7.3.cmml" xref="S3.E13.m1.13.13.13.7.2"><exp id="S3.E13.m1.8.8.8.2.cmml" xref="S3.E13.m1.8.8.8.2"></exp><apply id="S3.E13.m1.12.12.12.6.1.1.1.cmml" xref="S3.E13.m1.12.12.12.6.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.12.12.12.6.1.1.1.1.cmml" xref="S3.E13.m1.12.12.12.6.1.1.1">superscript</csymbol><ci id="S3.E13.m1.12.12.12.6.1.1.1.2.cmml" xref="S3.E13.m1.12.12.12.6.1.1.1.2">𝑃</ci><times id="S3.E13.m1.12.12.12.6.1.1.1.3.cmml" xref="S3.E13.m1.12.12.12.6.1.1.1.3"></times></apply><apply id="S3.E13.m1.13.13.13.7.2.2.2.cmml" xref="S3.E13.m1.13.13.13.7.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.13.13.13.7.2.2.2.1.cmml" xref="S3.E13.m1.13.13.13.7.2.2.2">superscript</csymbol><apply id="S3.E13.m1.13.13.13.7.2.2.2.2.cmml" xref="S3.E13.m1.13.13.13.7.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.13.13.13.7.2.2.2.2.1.cmml" xref="S3.E13.m1.13.13.13.7.2.2.2">subscript</csymbol><ci id="S3.E13.m1.13.13.13.7.2.2.2.2.2.cmml" xref="S3.E13.m1.13.13.13.7.2.2.2.2.2">𝑤</ci><ci id="S3.E13.m1.13.13.13.7.2.2.2.2.3.cmml" xref="S3.E13.m1.13.13.13.7.2.2.2.2.3">𝑏</ci></apply><times id="S3.E13.m1.13.13.13.7.2.2.2.3.cmml" xref="S3.E13.m1.13.13.13.7.2.2.2.3"></times></apply></apply><apply id="S3.E13.m1.15.15.15.9.3.cmml" xref="S3.E13.m1.15.15.15.9.2"><exp id="S3.E13.m1.9.9.9.3.cmml" xref="S3.E13.m1.9.9.9.3"></exp><apply id="S3.E13.m1.14.14.14.8.1.1.1.cmml" xref="S3.E13.m1.14.14.14.8.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.14.14.14.8.1.1.1.1.cmml" xref="S3.E13.m1.14.14.14.8.1.1.1">superscript</csymbol><ci id="S3.E13.m1.14.14.14.8.1.1.1.2.cmml" xref="S3.E13.m1.14.14.14.8.1.1.1.2">𝐵</ci><times id="S3.E13.m1.14.14.14.8.1.1.1.3.cmml" xref="S3.E13.m1.14.14.14.8.1.1.1.3"></times></apply><apply id="S3.E13.m1.15.15.15.9.2.2.2.cmml" xref="S3.E13.m1.15.15.15.9.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.15.15.15.9.2.2.2.1.cmml" xref="S3.E13.m1.15.15.15.9.2.2.2">superscript</csymbol><apply id="S3.E13.m1.15.15.15.9.2.2.2.2.cmml" xref="S3.E13.m1.15.15.15.9.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.15.15.15.9.2.2.2.2.1.cmml" xref="S3.E13.m1.15.15.15.9.2.2.2">subscript</csymbol><ci id="S3.E13.m1.15.15.15.9.2.2.2.2.2.cmml" xref="S3.E13.m1.15.15.15.9.2.2.2.2.2">𝑤</ci><ci id="S3.E13.m1.15.15.15.9.2.2.2.2.3.cmml" xref="S3.E13.m1.15.15.15.9.2.2.2.2.3">𝑓</ci></apply><times id="S3.E13.m1.15.15.15.9.2.2.2.3.cmml" xref="S3.E13.m1.15.15.15.9.2.2.2.3"></times></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.15c">{\mathcal{L}_{dis}}=-{\log}{\frac{\exp{\left\langle P^{*},w_{f}^{*}\right%
\rangle}+\exp{\left\langle B^{*},w_{b}^{*}\right\rangle}}{\exp{\left\langle P^%
{*},B^{*}\right\rangle}+\exp{\left\langle P^{*},w_{b}^{*}\right\rangle}+\exp{%
\left\langle B^{*},w_{f}^{*}\right\rangle}}}</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.15d">caligraphic_L start_POSTSUBSCRIPT italic_d italic_i italic_s end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ⟨ italic_P start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ⟩ + roman_exp ⟨ italic_B start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ⟩ end_ARG start_ARG roman_exp ⟨ italic_P start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , italic_B start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ⟩ + roman_exp ⟨ italic_P start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ⟩ + roman_exp ⟨ italic_B start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ⟩ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS6.p6">
<p class="ltx_p" id="S3.SS6.p6.4">where <math alttext="w_{f}^{*}" class="ltx_Math" display="inline" id="S3.SS6.p6.1.m1.1"><semantics id="S3.SS6.p6.1.m1.1a"><msubsup id="S3.SS6.p6.1.m1.1.1" xref="S3.SS6.p6.1.m1.1.1.cmml"><mi id="S3.SS6.p6.1.m1.1.1.2.2" xref="S3.SS6.p6.1.m1.1.1.2.2.cmml">w</mi><mi id="S3.SS6.p6.1.m1.1.1.2.3" xref="S3.SS6.p6.1.m1.1.1.2.3.cmml">f</mi><mo id="S3.SS6.p6.1.m1.1.1.3" xref="S3.SS6.p6.1.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS6.p6.1.m1.1b"><apply id="S3.SS6.p6.1.m1.1.1.cmml" xref="S3.SS6.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS6.p6.1.m1.1.1.1.cmml" xref="S3.SS6.p6.1.m1.1.1">superscript</csymbol><apply id="S3.SS6.p6.1.m1.1.1.2.cmml" xref="S3.SS6.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS6.p6.1.m1.1.1.2.1.cmml" xref="S3.SS6.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS6.p6.1.m1.1.1.2.2.cmml" xref="S3.SS6.p6.1.m1.1.1.2.2">𝑤</ci><ci id="S3.SS6.p6.1.m1.1.1.2.3.cmml" xref="S3.SS6.p6.1.m1.1.1.2.3">𝑓</ci></apply><times id="S3.SS6.p6.1.m1.1.1.3.cmml" xref="S3.SS6.p6.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p6.1.m1.1c">w_{f}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p6.1.m1.1d">italic_w start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="w_{b}^{*}" class="ltx_Math" display="inline" id="S3.SS6.p6.2.m2.1"><semantics id="S3.SS6.p6.2.m2.1a"><msubsup id="S3.SS6.p6.2.m2.1.1" xref="S3.SS6.p6.2.m2.1.1.cmml"><mi id="S3.SS6.p6.2.m2.1.1.2.2" xref="S3.SS6.p6.2.m2.1.1.2.2.cmml">w</mi><mi id="S3.SS6.p6.2.m2.1.1.2.3" xref="S3.SS6.p6.2.m2.1.1.2.3.cmml">b</mi><mo id="S3.SS6.p6.2.m2.1.1.3" xref="S3.SS6.p6.2.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS6.p6.2.m2.1b"><apply id="S3.SS6.p6.2.m2.1.1.cmml" xref="S3.SS6.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS6.p6.2.m2.1.1.1.cmml" xref="S3.SS6.p6.2.m2.1.1">superscript</csymbol><apply id="S3.SS6.p6.2.m2.1.1.2.cmml" xref="S3.SS6.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS6.p6.2.m2.1.1.2.1.cmml" xref="S3.SS6.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS6.p6.2.m2.1.1.2.2.cmml" xref="S3.SS6.p6.2.m2.1.1.2.2">𝑤</ci><ci id="S3.SS6.p6.2.m2.1.1.2.3.cmml" xref="S3.SS6.p6.2.m2.1.1.2.3">𝑏</ci></apply><times id="S3.SS6.p6.2.m2.1.1.3.cmml" xref="S3.SS6.p6.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p6.2.m2.1c">w_{b}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p6.2.m2.1d">italic_w start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> are obtained by performing the masked average pooling operation from image features (query or support) with the ground-truth foreground mask and background mask, respectively. <math alttext="P^{*}" class="ltx_Math" display="inline" id="S3.SS6.p6.3.m3.1"><semantics id="S3.SS6.p6.3.m3.1a"><msup id="S3.SS6.p6.3.m3.1.1" xref="S3.SS6.p6.3.m3.1.1.cmml"><mi id="S3.SS6.p6.3.m3.1.1.2" xref="S3.SS6.p6.3.m3.1.1.2.cmml">P</mi><mo id="S3.SS6.p6.3.m3.1.1.3" xref="S3.SS6.p6.3.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS6.p6.3.m3.1b"><apply id="S3.SS6.p6.3.m3.1.1.cmml" xref="S3.SS6.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS6.p6.3.m3.1.1.1.cmml" xref="S3.SS6.p6.3.m3.1.1">superscript</csymbol><ci id="S3.SS6.p6.3.m3.1.1.2.cmml" xref="S3.SS6.p6.3.m3.1.1.2">𝑃</ci><times id="S3.SS6.p6.3.m3.1.1.3.cmml" xref="S3.SS6.p6.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p6.3.m3.1c">P^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p6.3.m3.1d">italic_P start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="B^{*}" class="ltx_Math" display="inline" id="S3.SS6.p6.4.m4.1"><semantics id="S3.SS6.p6.4.m4.1a"><msup id="S3.SS6.p6.4.m4.1.1" xref="S3.SS6.p6.4.m4.1.1.cmml"><mi id="S3.SS6.p6.4.m4.1.1.2" xref="S3.SS6.p6.4.m4.1.1.2.cmml">B</mi><mo id="S3.SS6.p6.4.m4.1.1.3" xref="S3.SS6.p6.4.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS6.p6.4.m4.1b"><apply id="S3.SS6.p6.4.m4.1.1.cmml" xref="S3.SS6.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS6.p6.4.m4.1.1.1.cmml" xref="S3.SS6.p6.4.m4.1.1">superscript</csymbol><ci id="S3.SS6.p6.4.m4.1.1.2.cmml" xref="S3.SS6.p6.4.m4.1.1.2">𝐵</ci><times id="S3.SS6.p6.4.m4.1.1.3.cmml" xref="S3.SS6.p6.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p6.4.m4.1c">B^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p6.4.m4.1d">italic_B start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> are the FG-prompts and BG-prompts (query or support), respectively.</p>
</div>
<div class="ltx_para" id="S3.SS6.p7">
<p class="ltx_p" id="S3.SS6.p7.3">Overall, the training loss is:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathcal{L}_{pred}+\alpha\cdot\mathcal{L}_{reg}+\beta\cdot\mathcal%
{L}_{dis}" class="ltx_Math" display="block" id="S3.E14.m1.1"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.1.1.2" xref="S3.E14.m1.1.1.2.cmml">ℒ</mi><mo id="S3.E14.m1.1.1.1" xref="S3.E14.m1.1.1.1.cmml">=</mo><mrow id="S3.E14.m1.1.1.3" xref="S3.E14.m1.1.1.3.cmml"><msub id="S3.E14.m1.1.1.3.2" xref="S3.E14.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.1.1.3.2.2" xref="S3.E14.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E14.m1.1.1.3.2.3" xref="S3.E14.m1.1.1.3.2.3.cmml"><mi id="S3.E14.m1.1.1.3.2.3.2" xref="S3.E14.m1.1.1.3.2.3.2.cmml">p</mi><mo id="S3.E14.m1.1.1.3.2.3.1" xref="S3.E14.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E14.m1.1.1.3.2.3.3" xref="S3.E14.m1.1.1.3.2.3.3.cmml">r</mi><mo id="S3.E14.m1.1.1.3.2.3.1a" xref="S3.E14.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E14.m1.1.1.3.2.3.4" xref="S3.E14.m1.1.1.3.2.3.4.cmml">e</mi><mo id="S3.E14.m1.1.1.3.2.3.1b" xref="S3.E14.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E14.m1.1.1.3.2.3.5" xref="S3.E14.m1.1.1.3.2.3.5.cmml">d</mi></mrow></msub><mo id="S3.E14.m1.1.1.3.1" xref="S3.E14.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E14.m1.1.1.3.3" xref="S3.E14.m1.1.1.3.3.cmml"><mi id="S3.E14.m1.1.1.3.3.2" xref="S3.E14.m1.1.1.3.3.2.cmml">α</mi><mo id="S3.E14.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E14.m1.1.1.3.3.1.cmml">⋅</mo><msub id="S3.E14.m1.1.1.3.3.3" xref="S3.E14.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.1.1.3.3.3.2" xref="S3.E14.m1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S3.E14.m1.1.1.3.3.3.3" xref="S3.E14.m1.1.1.3.3.3.3.cmml"><mi id="S3.E14.m1.1.1.3.3.3.3.2" xref="S3.E14.m1.1.1.3.3.3.3.2.cmml">r</mi><mo id="S3.E14.m1.1.1.3.3.3.3.1" xref="S3.E14.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.1.1.3.3.3.3.3" xref="S3.E14.m1.1.1.3.3.3.3.3.cmml">e</mi><mo id="S3.E14.m1.1.1.3.3.3.3.1a" xref="S3.E14.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.1.1.3.3.3.3.4" xref="S3.E14.m1.1.1.3.3.3.3.4.cmml">g</mi></mrow></msub></mrow><mo id="S3.E14.m1.1.1.3.1a" xref="S3.E14.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E14.m1.1.1.3.4" xref="S3.E14.m1.1.1.3.4.cmml"><mi id="S3.E14.m1.1.1.3.4.2" xref="S3.E14.m1.1.1.3.4.2.cmml">β</mi><mo id="S3.E14.m1.1.1.3.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E14.m1.1.1.3.4.1.cmml">⋅</mo><msub id="S3.E14.m1.1.1.3.4.3" xref="S3.E14.m1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.1.1.3.4.3.2" xref="S3.E14.m1.1.1.3.4.3.2.cmml">ℒ</mi><mrow id="S3.E14.m1.1.1.3.4.3.3" xref="S3.E14.m1.1.1.3.4.3.3.cmml"><mi id="S3.E14.m1.1.1.3.4.3.3.2" xref="S3.E14.m1.1.1.3.4.3.3.2.cmml">d</mi><mo id="S3.E14.m1.1.1.3.4.3.3.1" xref="S3.E14.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.1.1.3.4.3.3.3" xref="S3.E14.m1.1.1.3.4.3.3.3.cmml">i</mi><mo id="S3.E14.m1.1.1.3.4.3.3.1a" xref="S3.E14.m1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.1.1.3.4.3.3.4" xref="S3.E14.m1.1.1.3.4.3.3.4.cmml">s</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1"><eq id="S3.E14.m1.1.1.1.cmml" xref="S3.E14.m1.1.1.1"></eq><ci id="S3.E14.m1.1.1.2.cmml" xref="S3.E14.m1.1.1.2">ℒ</ci><apply id="S3.E14.m1.1.1.3.cmml" xref="S3.E14.m1.1.1.3"><plus id="S3.E14.m1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.3.1"></plus><apply id="S3.E14.m1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.3.2.1.cmml" xref="S3.E14.m1.1.1.3.2">subscript</csymbol><ci id="S3.E14.m1.1.1.3.2.2.cmml" xref="S3.E14.m1.1.1.3.2.2">ℒ</ci><apply id="S3.E14.m1.1.1.3.2.3.cmml" xref="S3.E14.m1.1.1.3.2.3"><times id="S3.E14.m1.1.1.3.2.3.1.cmml" xref="S3.E14.m1.1.1.3.2.3.1"></times><ci id="S3.E14.m1.1.1.3.2.3.2.cmml" xref="S3.E14.m1.1.1.3.2.3.2">𝑝</ci><ci id="S3.E14.m1.1.1.3.2.3.3.cmml" xref="S3.E14.m1.1.1.3.2.3.3">𝑟</ci><ci id="S3.E14.m1.1.1.3.2.3.4.cmml" xref="S3.E14.m1.1.1.3.2.3.4">𝑒</ci><ci id="S3.E14.m1.1.1.3.2.3.5.cmml" xref="S3.E14.m1.1.1.3.2.3.5">𝑑</ci></apply></apply><apply id="S3.E14.m1.1.1.3.3.cmml" xref="S3.E14.m1.1.1.3.3"><ci id="S3.E14.m1.1.1.3.3.1.cmml" xref="S3.E14.m1.1.1.3.3.1">⋅</ci><ci id="S3.E14.m1.1.1.3.3.2.cmml" xref="S3.E14.m1.1.1.3.3.2">𝛼</ci><apply id="S3.E14.m1.1.1.3.3.3.cmml" xref="S3.E14.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.3.3.3.1.cmml" xref="S3.E14.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E14.m1.1.1.3.3.3.2.cmml" xref="S3.E14.m1.1.1.3.3.3.2">ℒ</ci><apply id="S3.E14.m1.1.1.3.3.3.3.cmml" xref="S3.E14.m1.1.1.3.3.3.3"><times id="S3.E14.m1.1.1.3.3.3.3.1.cmml" xref="S3.E14.m1.1.1.3.3.3.3.1"></times><ci id="S3.E14.m1.1.1.3.3.3.3.2.cmml" xref="S3.E14.m1.1.1.3.3.3.3.2">𝑟</ci><ci id="S3.E14.m1.1.1.3.3.3.3.3.cmml" xref="S3.E14.m1.1.1.3.3.3.3.3">𝑒</ci><ci id="S3.E14.m1.1.1.3.3.3.3.4.cmml" xref="S3.E14.m1.1.1.3.3.3.3.4">𝑔</ci></apply></apply></apply><apply id="S3.E14.m1.1.1.3.4.cmml" xref="S3.E14.m1.1.1.3.4"><ci id="S3.E14.m1.1.1.3.4.1.cmml" xref="S3.E14.m1.1.1.3.4.1">⋅</ci><ci id="S3.E14.m1.1.1.3.4.2.cmml" xref="S3.E14.m1.1.1.3.4.2">𝛽</ci><apply id="S3.E14.m1.1.1.3.4.3.cmml" xref="S3.E14.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.3.4.3.1.cmml" xref="S3.E14.m1.1.1.3.4.3">subscript</csymbol><ci id="S3.E14.m1.1.1.3.4.3.2.cmml" xref="S3.E14.m1.1.1.3.4.3.2">ℒ</ci><apply id="S3.E14.m1.1.1.3.4.3.3.cmml" xref="S3.E14.m1.1.1.3.4.3.3"><times id="S3.E14.m1.1.1.3.4.3.3.1.cmml" xref="S3.E14.m1.1.1.3.4.3.3.1"></times><ci id="S3.E14.m1.1.1.3.4.3.3.2.cmml" xref="S3.E14.m1.1.1.3.4.3.3.2">𝑑</ci><ci id="S3.E14.m1.1.1.3.4.3.3.3.cmml" xref="S3.E14.m1.1.1.3.4.3.3.3">𝑖</ci><ci id="S3.E14.m1.1.1.3.4.3.3.4.cmml" xref="S3.E14.m1.1.1.3.4.3.3.4">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">\mathcal{L}=\mathcal{L}_{pred}+\alpha\cdot\mathcal{L}_{reg}+\beta\cdot\mathcal%
{L}_{dis}</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT + italic_α ⋅ caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_g end_POSTSUBSCRIPT + italic_β ⋅ caligraphic_L start_POSTSUBSCRIPT italic_d italic_i italic_s end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS6.p7.2">where <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS6.p7.1.m1.1"><semantics id="S3.SS6.p7.1.m1.1a"><mi id="S3.SS6.p7.1.m1.1.1" xref="S3.SS6.p7.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p7.1.m1.1b"><ci id="S3.SS6.p7.1.m1.1.1.cmml" xref="S3.SS6.p7.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p7.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p7.1.m1.1d">italic_α</annotation></semantics></math> and <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS6.p7.2.m2.1"><semantics id="S3.SS6.p7.2.m2.1a"><mi id="S3.SS6.p7.2.m2.1.1" xref="S3.SS6.p7.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p7.2.m2.1b"><ci id="S3.SS6.p7.2.m2.1.1.cmml" xref="S3.SS6.p7.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p7.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p7.2.m2.1d">italic_β</annotation></semantics></math> are loss weights to balance the corresponding contributions.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="alg2">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg2.11">
<div class="ltx_listingline" id="alg2.1.1">
<span class="ltx_text" id="alg2.1.1.1"><span class="ltx_text ltx_font_bold" id="alg2.1.1.1.1">Input:</span> </span> Support image with mask <math alttext="\left(I^{s},M^{s},M^{t}\right)" class="ltx_Math" display="inline" id="alg2.1.1.m1.3"><semantics id="alg2.1.1.m1.3a"><mrow id="alg2.1.1.m1.3.3.3" xref="alg2.1.1.m1.3.3.4.cmml"><mo id="alg2.1.1.m1.3.3.3.4" xref="alg2.1.1.m1.3.3.4.cmml">(</mo><msup id="alg2.1.1.m1.1.1.1.1" xref="alg2.1.1.m1.1.1.1.1.cmml"><mi id="alg2.1.1.m1.1.1.1.1.2" xref="alg2.1.1.m1.1.1.1.1.2.cmml">I</mi><mi id="alg2.1.1.m1.1.1.1.1.3" xref="alg2.1.1.m1.1.1.1.1.3.cmml">s</mi></msup><mo id="alg2.1.1.m1.3.3.3.5" xref="alg2.1.1.m1.3.3.4.cmml">,</mo><msup id="alg2.1.1.m1.2.2.2.2" xref="alg2.1.1.m1.2.2.2.2.cmml"><mi id="alg2.1.1.m1.2.2.2.2.2" xref="alg2.1.1.m1.2.2.2.2.2.cmml">M</mi><mi id="alg2.1.1.m1.2.2.2.2.3" xref="alg2.1.1.m1.2.2.2.2.3.cmml">s</mi></msup><mo id="alg2.1.1.m1.3.3.3.6" xref="alg2.1.1.m1.3.3.4.cmml">,</mo><msup id="alg2.1.1.m1.3.3.3.3" xref="alg2.1.1.m1.3.3.3.3.cmml"><mi id="alg2.1.1.m1.3.3.3.3.2" xref="alg2.1.1.m1.3.3.3.3.2.cmml">M</mi><mi id="alg2.1.1.m1.3.3.3.3.3" xref="alg2.1.1.m1.3.3.3.3.3.cmml">t</mi></msup><mo id="alg2.1.1.m1.3.3.3.7" xref="alg2.1.1.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.1.1.m1.3b"><vector id="alg2.1.1.m1.3.3.4.cmml" xref="alg2.1.1.m1.3.3.3"><apply id="alg2.1.1.m1.1.1.1.1.cmml" xref="alg2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.1.1.m1.1.1.1.1.1.cmml" xref="alg2.1.1.m1.1.1.1.1">superscript</csymbol><ci id="alg2.1.1.m1.1.1.1.1.2.cmml" xref="alg2.1.1.m1.1.1.1.1.2">𝐼</ci><ci id="alg2.1.1.m1.1.1.1.1.3.cmml" xref="alg2.1.1.m1.1.1.1.1.3">𝑠</ci></apply><apply id="alg2.1.1.m1.2.2.2.2.cmml" xref="alg2.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.1.1.m1.2.2.2.2.1.cmml" xref="alg2.1.1.m1.2.2.2.2">superscript</csymbol><ci id="alg2.1.1.m1.2.2.2.2.2.cmml" xref="alg2.1.1.m1.2.2.2.2.2">𝑀</ci><ci id="alg2.1.1.m1.2.2.2.2.3.cmml" xref="alg2.1.1.m1.2.2.2.2.3">𝑠</ci></apply><apply id="alg2.1.1.m1.3.3.3.3.cmml" xref="alg2.1.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg2.1.1.m1.3.3.3.3.1.cmml" xref="alg2.1.1.m1.3.3.3.3">superscript</csymbol><ci id="alg2.1.1.m1.3.3.3.3.2.cmml" xref="alg2.1.1.m1.3.3.3.3.2">𝑀</ci><ci id="alg2.1.1.m1.3.3.3.3.3.cmml" xref="alg2.1.1.m1.3.3.3.3.3">𝑡</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.m1.3c">\left(I^{s},M^{s},M^{t}\right)</annotation><annotation encoding="application/x-llamapun" id="alg2.1.1.m1.3d">( italic_I start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT , italic_M start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT , italic_M start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.2.2">
     Query image <math alttext="I^{q}" class="ltx_Math" display="inline" id="alg2.2.2.m1.1"><semantics id="alg2.2.2.m1.1a"><msup id="alg2.2.2.m1.1.1" xref="alg2.2.2.m1.1.1.cmml"><mi id="alg2.2.2.m1.1.1.2" xref="alg2.2.2.m1.1.1.2.cmml">I</mi><mi id="alg2.2.2.m1.1.1.3" xref="alg2.2.2.m1.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.2.2.m1.1b"><apply id="alg2.2.2.m1.1.1.cmml" xref="alg2.2.2.m1.1.1"><csymbol cd="ambiguous" id="alg2.2.2.m1.1.1.1.cmml" xref="alg2.2.2.m1.1.1">superscript</csymbol><ci id="alg2.2.2.m1.1.1.2.cmml" xref="alg2.2.2.m1.1.1.2">𝐼</ci><ci id="alg2.2.2.m1.1.1.3.cmml" xref="alg2.2.2.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.m1.1c">I^{q}</annotation><annotation encoding="application/x-llamapun" id="alg2.2.2.m1.1d">italic_I start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.3.3">
<span class="ltx_text" id="alg2.3.3.1"><span class="ltx_text ltx_font_bold" id="alg2.3.3.1.1">Output:</span> </span> Segmentation result <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="alg2.3.3.m1.1"><semantics id="alg2.3.3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.3.3.m1.1.1" xref="alg2.3.3.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg2.3.3.m1.1b"><ci id="alg2.3.3.m1.1.1.cmml" xref="alg2.3.3.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.3.m1.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="alg2.3.3.m1.1d">caligraphic_P</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.4.4">
<span class="ltx_tag ltx_tag_listingline">1</span>
Generate image tokens via the patch embedding layer <math alttext="X^{s}\leftarrow I^{s};X^{q}\leftarrow I^{q}" class="ltx_Math" display="inline" id="alg2.4.4.m1.2"><semantics id="alg2.4.4.m1.2a"><mrow id="alg2.4.4.m1.2.2.2" xref="alg2.4.4.m1.2.2.3.cmml"><mrow id="alg2.4.4.m1.1.1.1.1" xref="alg2.4.4.m1.1.1.1.1.cmml"><msup id="alg2.4.4.m1.1.1.1.1.2" xref="alg2.4.4.m1.1.1.1.1.2.cmml"><mi id="alg2.4.4.m1.1.1.1.1.2.2" xref="alg2.4.4.m1.1.1.1.1.2.2.cmml">X</mi><mi id="alg2.4.4.m1.1.1.1.1.2.3" xref="alg2.4.4.m1.1.1.1.1.2.3.cmml">s</mi></msup><mo id="alg2.4.4.m1.1.1.1.1.1" stretchy="false" xref="alg2.4.4.m1.1.1.1.1.1.cmml">←</mo><msup id="alg2.4.4.m1.1.1.1.1.3" xref="alg2.4.4.m1.1.1.1.1.3.cmml"><mi id="alg2.4.4.m1.1.1.1.1.3.2" xref="alg2.4.4.m1.1.1.1.1.3.2.cmml">I</mi><mi id="alg2.4.4.m1.1.1.1.1.3.3" xref="alg2.4.4.m1.1.1.1.1.3.3.cmml">s</mi></msup></mrow><mo id="alg2.4.4.m1.2.2.2.3" xref="alg2.4.4.m1.2.2.3a.cmml">;</mo><mrow id="alg2.4.4.m1.2.2.2.2" xref="alg2.4.4.m1.2.2.2.2.cmml"><msup id="alg2.4.4.m1.2.2.2.2.2" xref="alg2.4.4.m1.2.2.2.2.2.cmml"><mi id="alg2.4.4.m1.2.2.2.2.2.2" xref="alg2.4.4.m1.2.2.2.2.2.2.cmml">X</mi><mi id="alg2.4.4.m1.2.2.2.2.2.3" xref="alg2.4.4.m1.2.2.2.2.2.3.cmml">q</mi></msup><mo id="alg2.4.4.m1.2.2.2.2.1" stretchy="false" xref="alg2.4.4.m1.2.2.2.2.1.cmml">←</mo><msup id="alg2.4.4.m1.2.2.2.2.3" xref="alg2.4.4.m1.2.2.2.2.3.cmml"><mi id="alg2.4.4.m1.2.2.2.2.3.2" xref="alg2.4.4.m1.2.2.2.2.3.2.cmml">I</mi><mi id="alg2.4.4.m1.2.2.2.2.3.3" xref="alg2.4.4.m1.2.2.2.2.3.3.cmml">q</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.4.4.m1.2b"><apply id="alg2.4.4.m1.2.2.3.cmml" xref="alg2.4.4.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.4.4.m1.2.2.3a.cmml" xref="alg2.4.4.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.4.4.m1.1.1.1.1.cmml" xref="alg2.4.4.m1.1.1.1.1"><ci id="alg2.4.4.m1.1.1.1.1.1.cmml" xref="alg2.4.4.m1.1.1.1.1.1">←</ci><apply id="alg2.4.4.m1.1.1.1.1.2.cmml" xref="alg2.4.4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.4.4.m1.1.1.1.1.2.1.cmml" xref="alg2.4.4.m1.1.1.1.1.2">superscript</csymbol><ci id="alg2.4.4.m1.1.1.1.1.2.2.cmml" xref="alg2.4.4.m1.1.1.1.1.2.2">𝑋</ci><ci id="alg2.4.4.m1.1.1.1.1.2.3.cmml" xref="alg2.4.4.m1.1.1.1.1.2.3">𝑠</ci></apply><apply id="alg2.4.4.m1.1.1.1.1.3.cmml" xref="alg2.4.4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.4.4.m1.1.1.1.1.3.1.cmml" xref="alg2.4.4.m1.1.1.1.1.3">superscript</csymbol><ci id="alg2.4.4.m1.1.1.1.1.3.2.cmml" xref="alg2.4.4.m1.1.1.1.1.3.2">𝐼</ci><ci id="alg2.4.4.m1.1.1.1.1.3.3.cmml" xref="alg2.4.4.m1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="alg2.4.4.m1.2.2.2.2.cmml" xref="alg2.4.4.m1.2.2.2.2"><ci id="alg2.4.4.m1.2.2.2.2.1.cmml" xref="alg2.4.4.m1.2.2.2.2.1">←</ci><apply id="alg2.4.4.m1.2.2.2.2.2.cmml" xref="alg2.4.4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.4.4.m1.2.2.2.2.2.1.cmml" xref="alg2.4.4.m1.2.2.2.2.2">superscript</csymbol><ci id="alg2.4.4.m1.2.2.2.2.2.2.cmml" xref="alg2.4.4.m1.2.2.2.2.2.2">𝑋</ci><ci id="alg2.4.4.m1.2.2.2.2.2.3.cmml" xref="alg2.4.4.m1.2.2.2.2.2.3">𝑞</ci></apply><apply id="alg2.4.4.m1.2.2.2.2.3.cmml" xref="alg2.4.4.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg2.4.4.m1.2.2.2.2.3.1.cmml" xref="alg2.4.4.m1.2.2.2.2.3">superscript</csymbol><ci id="alg2.4.4.m1.2.2.2.2.3.2.cmml" xref="alg2.4.4.m1.2.2.2.2.3.2">𝐼</ci><ci id="alg2.4.4.m1.2.2.2.2.3.3.cmml" xref="alg2.4.4.m1.2.2.2.2.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.4.m1.2c">X^{s}\leftarrow I^{s};X^{q}\leftarrow I^{q}</annotation><annotation encoding="application/x-llamapun" id="alg2.4.4.m1.2d">italic_X start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ← italic_I start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT ; italic_X start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT ← italic_I start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="alg2.11.12">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="alg2.5.5">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_font_bold" id="alg2.5.5.1">Prompt Initialization</span>:
Derive initial FG-prompts and BG-prompts <math alttext="\left(P,B\right)\leftarrow M^{t}" class="ltx_Math" display="inline" id="alg2.5.5.m1.2"><semantics id="alg2.5.5.m1.2a"><mrow id="alg2.5.5.m1.2.3" xref="alg2.5.5.m1.2.3.cmml"><mrow id="alg2.5.5.m1.2.3.2.2" xref="alg2.5.5.m1.2.3.2.1.cmml"><mo id="alg2.5.5.m1.2.3.2.2.1" xref="alg2.5.5.m1.2.3.2.1.cmml">(</mo><mi id="alg2.5.5.m1.1.1" xref="alg2.5.5.m1.1.1.cmml">P</mi><mo id="alg2.5.5.m1.2.3.2.2.2" xref="alg2.5.5.m1.2.3.2.1.cmml">,</mo><mi id="alg2.5.5.m1.2.2" xref="alg2.5.5.m1.2.2.cmml">B</mi><mo id="alg2.5.5.m1.2.3.2.2.3" xref="alg2.5.5.m1.2.3.2.1.cmml">)</mo></mrow><mo id="alg2.5.5.m1.2.3.1" stretchy="false" xref="alg2.5.5.m1.2.3.1.cmml">←</mo><msup id="alg2.5.5.m1.2.3.3" xref="alg2.5.5.m1.2.3.3.cmml"><mi id="alg2.5.5.m1.2.3.3.2" xref="alg2.5.5.m1.2.3.3.2.cmml">M</mi><mi id="alg2.5.5.m1.2.3.3.3" xref="alg2.5.5.m1.2.3.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.5.5.m1.2b"><apply id="alg2.5.5.m1.2.3.cmml" xref="alg2.5.5.m1.2.3"><ci id="alg2.5.5.m1.2.3.1.cmml" xref="alg2.5.5.m1.2.3.1">←</ci><interval closure="open" id="alg2.5.5.m1.2.3.2.1.cmml" xref="alg2.5.5.m1.2.3.2.2"><ci id="alg2.5.5.m1.1.1.cmml" xref="alg2.5.5.m1.1.1">𝑃</ci><ci id="alg2.5.5.m1.2.2.cmml" xref="alg2.5.5.m1.2.2">𝐵</ci></interval><apply id="alg2.5.5.m1.2.3.3.cmml" xref="alg2.5.5.m1.2.3.3"><csymbol cd="ambiguous" id="alg2.5.5.m1.2.3.3.1.cmml" xref="alg2.5.5.m1.2.3.3">superscript</csymbol><ci id="alg2.5.5.m1.2.3.3.2.cmml" xref="alg2.5.5.m1.2.3.3.2">𝑀</ci><ci id="alg2.5.5.m1.2.3.3.3.cmml" xref="alg2.5.5.m1.2.3.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.5.m1.2c">\left(P,B\right)\leftarrow M^{t}</annotation><annotation encoding="application/x-llamapun" id="alg2.5.5.m1.2d">( italic_P , italic_B ) ← italic_M start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> according to Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E1" title="In 3.3 Prompt Initialization ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>);

</div>
<div class="ltx_listingline" id="alg2.7.7">
<span class="ltx_tag ltx_tag_listingline">4</span>Feed the tokens and initial prompts to the Feature Encoder <math alttext="E" class="ltx_Math" display="inline" id="alg2.6.6.m1.1"><semantics id="alg2.6.6.m1.1a"><mi id="alg2.6.6.m1.1.1" xref="alg2.6.6.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.6.6.m1.1b"><ci id="alg2.6.6.m1.1.1.cmml" xref="alg2.6.6.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.6.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg2.6.6.m1.1d">italic_E</annotation></semantics></math> which contains <math alttext="N" class="ltx_Math" display="inline" id="alg2.7.7.m2.1"><semantics id="alg2.7.7.m2.1a"><mi id="alg2.7.7.m2.1.1" xref="alg2.7.7.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.7.7.m2.1b"><ci id="alg2.7.7.m2.1.1.cmml" xref="alg2.7.7.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.7.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg2.7.7.m2.1d">italic_N</annotation></semantics></math> blocks;

</div>
<div class="ltx_listingline" id="alg2.9.9">
<span class="ltx_tag ltx_tag_listingline">5</span><span class="ltx_text ltx_font_bold" id="alg2.9.9.3">for</span> <em class="ltx_emph ltx_font_italic" id="alg2.9.9.2"><math alttext="E_{n}" class="ltx_Math" display="inline" id="alg2.8.8.1.m1.1"><semantics id="alg2.8.8.1.m1.1a"><msub id="alg2.8.8.1.m1.1.1" xref="alg2.8.8.1.m1.1.1.cmml"><mi id="alg2.8.8.1.m1.1.1.2" xref="alg2.8.8.1.m1.1.1.2.cmml">E</mi><mi id="alg2.8.8.1.m1.1.1.3" xref="alg2.8.8.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.8.8.1.m1.1b"><apply id="alg2.8.8.1.m1.1.1.cmml" xref="alg2.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.8.8.1.m1.1.1.1.cmml" xref="alg2.8.8.1.m1.1.1">subscript</csymbol><ci id="alg2.8.8.1.m1.1.1.2.cmml" xref="alg2.8.8.1.m1.1.1.2">𝐸</ci><ci id="alg2.8.8.1.m1.1.1.3.cmml" xref="alg2.8.8.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.8.1.m1.1c">E_{n}</annotation><annotation encoding="application/x-llamapun" id="alg2.8.8.1.m1.1d">italic_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="E" class="ltx_Math" display="inline" id="alg2.9.9.2.m2.1"><semantics id="alg2.9.9.2.m2.1a"><mi id="alg2.9.9.2.m2.1.1" xref="alg2.9.9.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.9.9.2.m2.1b"><ci id="alg2.9.9.2.m2.1.1.cmml" xref="alg2.9.9.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.9.2.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg2.9.9.2.m2.1d">italic_E</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.9.9.4">do</span>
</div>
<div class="ltx_listingline" id="alg2.10.10">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="alg2.10.10.2">if</span> <em class="ltx_emph ltx_font_italic" id="alg2.10.10.1">N-n <math alttext="\leq" class="ltx_Math" display="inline" id="alg2.10.10.1.m1.1"><semantics id="alg2.10.10.1.m1.1a"><mo id="alg2.10.10.1.m1.1.1" xref="alg2.10.10.1.m1.1.1.cmml">≤</mo><annotation-xml encoding="MathML-Content" id="alg2.10.10.1.m1.1b"><leq id="alg2.10.10.1.m1.1.1.cmml" xref="alg2.10.10.1.m1.1.1"></leq></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.10.1.m1.1c">\leq</annotation><annotation encoding="application/x-llamapun" id="alg2.10.10.1.m1.1d">≤</annotation></semantics></math> L</em> <span class="ltx_text ltx_font_bold" id="alg2.10.10.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.11.13">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="alg2.11.13.1">Prompt Enhancement</span>:
Transfer the class-specific semantics from image features to prompts according to Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E9" title="In 3.4.2 Semantic Prompt Transfer (SPT) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">9</span></a>);

</div>
<div class="ltx_listingline" id="alg2.11.14">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end if
</div>
<div class="ltx_listingline" id="alg2.11.15">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="alg2.11.15.1">Prompting</span>: The tokens interact with the prompts to activate the object according to Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E10" title="In 3.5 Prompting ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">10</span></a>);

</div>
<div class="ltx_listingline" id="alg2.11.16">
<span class="ltx_tag ltx_tag_listingline">10</span> end for
</div>
<div class="ltx_listingline" id="alg2.11.17">
<span class="ltx_tag ltx_tag_listingline">11</span>
</div>
<div class="ltx_listingline" id="alg2.11.11">
<span class="ltx_text ltx_font_bold" id="alg2.11.11.1">Matching</span>: Calculate the similarity between the enhanced query feature with prompts <math alttext="\mathcal{P}\leftarrow\left(X^{q},P,B\right)" class="ltx_Math" display="inline" id="alg2.11.11.m1.3"><semantics id="alg2.11.11.m1.3a"><mrow id="alg2.11.11.m1.3.3" xref="alg2.11.11.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.11.11.m1.3.3.3" xref="alg2.11.11.m1.3.3.3.cmml">𝒫</mi><mo id="alg2.11.11.m1.3.3.2" stretchy="false" xref="alg2.11.11.m1.3.3.2.cmml">←</mo><mrow id="alg2.11.11.m1.3.3.1.1" xref="alg2.11.11.m1.3.3.1.2.cmml"><mo id="alg2.11.11.m1.3.3.1.1.2" xref="alg2.11.11.m1.3.3.1.2.cmml">(</mo><msup id="alg2.11.11.m1.3.3.1.1.1" xref="alg2.11.11.m1.3.3.1.1.1.cmml"><mi id="alg2.11.11.m1.3.3.1.1.1.2" xref="alg2.11.11.m1.3.3.1.1.1.2.cmml">X</mi><mi id="alg2.11.11.m1.3.3.1.1.1.3" xref="alg2.11.11.m1.3.3.1.1.1.3.cmml">q</mi></msup><mo id="alg2.11.11.m1.3.3.1.1.3" xref="alg2.11.11.m1.3.3.1.2.cmml">,</mo><mi id="alg2.11.11.m1.1.1" xref="alg2.11.11.m1.1.1.cmml">P</mi><mo id="alg2.11.11.m1.3.3.1.1.4" xref="alg2.11.11.m1.3.3.1.2.cmml">,</mo><mi id="alg2.11.11.m1.2.2" xref="alg2.11.11.m1.2.2.cmml">B</mi><mo id="alg2.11.11.m1.3.3.1.1.5" xref="alg2.11.11.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.11.11.m1.3b"><apply id="alg2.11.11.m1.3.3.cmml" xref="alg2.11.11.m1.3.3"><ci id="alg2.11.11.m1.3.3.2.cmml" xref="alg2.11.11.m1.3.3.2">←</ci><ci id="alg2.11.11.m1.3.3.3.cmml" xref="alg2.11.11.m1.3.3.3">𝒫</ci><vector id="alg2.11.11.m1.3.3.1.2.cmml" xref="alg2.11.11.m1.3.3.1.1"><apply id="alg2.11.11.m1.3.3.1.1.1.cmml" xref="alg2.11.11.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg2.11.11.m1.3.3.1.1.1.1.cmml" xref="alg2.11.11.m1.3.3.1.1.1">superscript</csymbol><ci id="alg2.11.11.m1.3.3.1.1.1.2.cmml" xref="alg2.11.11.m1.3.3.1.1.1.2">𝑋</ci><ci id="alg2.11.11.m1.3.3.1.1.1.3.cmml" xref="alg2.11.11.m1.3.3.1.1.1.3">𝑞</ci></apply><ci id="alg2.11.11.m1.1.1.cmml" xref="alg2.11.11.m1.1.1">𝑃</ci><ci id="alg2.11.11.m1.2.2.cmml" xref="alg2.11.11.m1.2.2">𝐵</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.11.m1.3c">\mathcal{P}\leftarrow\left(X^{q},P,B\right)</annotation><annotation encoding="application/x-llamapun" id="alg2.11.11.m1.3d">caligraphic_P ← ( italic_X start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , italic_P , italic_B )</annotation></semantics></math> according to Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E11" title="In 3.6 Matching ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">11</span></a>).

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.13.1.1">Algorithm 2</span> </span>The overall process of our PAT</figcaption>
</figure>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Performance on PASCAL-5<sup class="ltx_sup" id="S3.T1.4.1"><span class="ltx_text ltx_font_italic" id="S3.T1.4.1.1">i</span></sup> benchmark in terms of mIoU and FB-IoU (%). “-” indicates that the result is not recorded. “Mean” and “FB-IoU” indicate the average mIoU scores and average FB-IoU scores for four folds, respectively.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.5" style="width:398.9pt;height:288.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-186.6pt,134.9pt) scale(0.516635763472324,0.516635763472324) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S3.T1.5.1.1.1.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S3.T1.5.1.1.1.1.1">Backbone</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.5.1.1.1.2" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S3.T1.5.1.1.1.2.1">Methond</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="6" id="S3.T1.5.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">1-shot</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S3.T1.5.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">5-shot</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.2.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">Mean</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.2.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.2.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.2.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.2.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.2.2.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.2.2.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">Mean</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.2.2.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T1.5.1.3.3.1" rowspan="12" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S3.T1.5.1.3.3.1.1">ResNet-50</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.5.1.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">PFENet (TPAMI’2020)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib28" title="">28</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.3.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.40</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.3.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">56.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.3.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.73</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.3.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.3.3.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.3.3.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.3.3.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.80</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.3.3.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.3.3.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.3.3.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.90</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.4.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.4.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">CyCTR (NeurIPS’2021)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.4.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.4.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.00</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.4.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.50</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.4.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.4.4.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.98</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.4.4.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.4.4.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.4.4.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.4.4.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.4.4.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.4.4.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.53</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.4.4.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.5.5">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.5.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">HSNet (ICCV’2020)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib30" title="">30</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.5.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.5.5.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.5.5.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.5.5.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.5.5.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.95</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.5.5.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.5.5.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.5.5.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.5.5.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.5.5.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.5.5.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.5.5.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">80.60</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.6.6">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.6.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">HPA (TPAMI’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib52" title="">52</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.6.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.94</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.6.6.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.96</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.6.6.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.66</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.6.6.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">56.78</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.6.6.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.84</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.6.6.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.6.6.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.54</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.6.6.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.28</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.6.6.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.37</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.6.6.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.41</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.6.6.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.6.6.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.10</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.7.7">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.7.7.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">AAFormer (ECCV’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib34" title="">34</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.7.7.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.7.7.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.7.7.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.7.7.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.7.7.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.18</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.7.7.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.7.7.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.7.7.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.7.7.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.7.7.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.7.7.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.63</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.7.7.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.2</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.8.8">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.8.8.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">NERTNet (CVPR’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib32" title="">32</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.8.8.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.8.8.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.8.8.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.8.8.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.8.8.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.23</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.8.8.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.00</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.8.8.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.8.8.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.8.8.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.8.8.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.8.8.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.73</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.8.8.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">78.40</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.9.9">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.9.9.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">BAM (CVPR’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib40" title="">40</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.9.9.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.97</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.9.9.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.59</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.9.9.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.55</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.9.9.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.13</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.9.9.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.81</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.9.9.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">79.71</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.9.9.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.59</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.9.9.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.05</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.9.9.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.79</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.9.9.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.9.9.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.91</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.9.9.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">82.20</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.10.10">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.10.10.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">SVF (NeurIPS’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib62" title="">62</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.10.10.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.38</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.10.10.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.51</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.10.10.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.10.10.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.09</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.10.10.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.95</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.10.10.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.10.10.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.05</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.10.10.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.17</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.10.10.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.97</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.10.10.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.91</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.10.10.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.28</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.10.10.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.11.11">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.11.11.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">IPMT (NeurIPS’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.11.11.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.11.11.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.11.11.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.11.11.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.60</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.11.11.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.83</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.11.11.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.11.11.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.11.11.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.11.11.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.11.11.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.11.11.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.11.11.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.40</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.12.12">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.12.12.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">ASNet (CVPR’2023)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib76" title="">76</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.12.12.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.12.12.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.12.12.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.12.12.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.12.12.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.12.12.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.12.12.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.60</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.12.12.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.12.12.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.12.12.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.12.12.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.83</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.12.12.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">80.40</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.13.13">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.13.13.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">HDMNet (CVPR’2023)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib54" title="">54</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.13.13.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.00</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.13.13.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.13.13.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.13.13.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.13.13.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.35</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.13.13.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.13.13.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.13.13.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.13.13.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.13.13.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.13.13.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.83</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.13.13.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.14.14">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.14.14.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">MIANet (CVPR’2023)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib60" title="">60</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.14.14.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.51</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.14.14.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.76</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.14.14.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.46</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.14.14.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.15</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.14.14.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.72</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.14.14.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.14.14.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.14.14.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.38</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.14.14.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.02</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.14.14.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.77</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.14.14.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.59</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.14.14.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.15.15">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.5.1.15.15.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.15.15.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">RiFeNet (AAAI’2024)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib43" title="">43</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.15.15.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.15.15.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.15.15.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.15.15.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.15.15.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.15.15.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.15.15.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.00</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.15.15.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.15.15.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.15.15.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.15.15.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.60</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.15.15.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.16.16">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.5.1.16.16.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.16.16.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">PMNet (WACV’2024)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib77" title="">77</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.16.16.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.16.16.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.00</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.16.16.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.16.16.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.16.16.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.16.16.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.16.16.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.60</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.16.16.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.60</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.16.16.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.16.16.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.16.16.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.16.16.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.17.17">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T1.5.1.17.17.1" rowspan="9" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S3.T1.5.1.17.17.1.1">ResNet-101</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.5.1.17.17.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">CyCTR (NeurIPS’2021)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.17.17.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.17.17.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.17.17.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.60</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.17.17.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.17.17.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.73</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.17.17.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.17.17.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.17.17.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.17.17.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.17.17.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.17.17.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.38</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.17.17.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.00</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.18.18">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.18.18.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">HSNet (ICCV’2021)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib30" title="">30</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.18.18.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.18.18.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.18.18.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.18.18.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.18.18.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.18</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.18.18.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.60</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.18.18.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.18.18.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.18.18.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.18.18.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.18.18.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.38</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.18.18.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">80.60</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.19.19">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.19.19.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">APANet (TMM’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib29" title="">29</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.19.19.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.19.19.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.19.19.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.19.19.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.19.19.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.98</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.19.19.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.19.19.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.19.19.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.19.19.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.19.19.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.19.19.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.95</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.19.19.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">78.80</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.20.20">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.20.20.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">HPA (TPAMI’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib52" title="">52</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.20.20.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.20.20.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.65</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.20.20.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.20.20.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.42</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.20.20.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.64</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.20.20.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.60</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.20.20.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.02</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.20.20.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.60</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.20.20.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.85</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.20.20.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.11</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.20.20.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.20.20.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">80.40</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.21.21">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.21.21.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">SSPNet (ECCV’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib42" title="">42</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.21.21.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.21.21.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.21.21.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.21.21.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.21.21.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.98</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.21.21.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.21.21.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.21.21.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.21.21.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.21.21.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.21.21.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.48</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.21.21.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.22.22">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.22.22.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">AAFormer (ECCV’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib34" title="">34</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.22.22.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.22.22.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.60</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.22.22.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.22.22.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.22.22.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.28</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.22.22.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.22.22.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.00</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.22.22.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.22.22.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.22.22.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.22.22.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.08</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.22.22.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.30</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.23.23">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.23.23.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">NERTNet (CVPR’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib32" title="">32</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.23.23.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.23.23.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.23.23.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.23.23.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.23.23.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.68</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.23.23.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.23.23.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.23.23.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.23.23.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.23.23.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.23.23.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.00</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.23.23.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">78.20</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.24.24">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.24.24.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">IPMT (NeurIPS’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.24.24.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.60</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.24.24.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.24.24.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.24.24.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.24.24.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.08</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.24.24.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">78.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.24.24.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.24.24.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.24.24.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.24.24.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.24.24.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.23</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.24.24.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">80.30</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.25.25">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.25.25.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">RiFeNet (AAAI’2024)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib43" title="">43</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.25.25.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.25.25.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.25.25.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.25.25.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.25.25.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.25.25.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.25.25.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.25.25.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.25.25.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.25.25.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.25.25.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.25.25.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.26.26">
<th class="ltx_td ltx_th ltx_th_row" id="S3.T1.5.1.26.26.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.26.26.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">PMNet (WACV’2024)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib77" title="">77</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.26.26.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.30</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.26.26.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.40</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.26.26.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.26.26.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.26.26.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.26.26.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.26.26.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.26.26.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.26.26.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.26.26.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.26.26.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.90</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.26.26.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.27.27">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T1.5.1.27.27.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S3.T1.5.1.27.27.1.1">ViT-B/16</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.5.1.27.27.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fptrans (NeurIPS’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib66" title="">66</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.27.27.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.27.27.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.27.27.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.60</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.27.27.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">56.40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.27.27.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.73</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.27.27.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.27.27.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.27.27.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.27.27.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.40</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.27.27.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.27.27.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.73</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.27.27.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.28.28">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.28.28.1" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.1.1">PAT (Ours)</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.28.28.2" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.2.1">68.33</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.28.28.3" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.3.1">73.24</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.28.28.4" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.4.1">66.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.28.28.5" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.5.1">60.11</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.28.28.6" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.6.1">66.96</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.28.28.7" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.7.1">78.81</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.28.28.8" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.8.1">73.33</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.28.28.9" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.9.1">77.61</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.28.28.10" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.10.1">75.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.28.28.11" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.11.1">69.45</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.28.28.12" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.12.1">73.88</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.28.28.13" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.28.28.13.1">83.55</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.29.29">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S3.T1.5.1.29.29.1" rowspan="3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S3.T1.5.1.29.29.1.1">DeiT-B/16</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.5.1.29.29.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fptrans (NeurIPS’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib66" title="">66</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.29.29.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.29.29.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.29.29.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.30</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.29.29.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.29.29.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.83</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.29.29.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.29.29.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.70</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.29.29.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">79.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.29.29.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.00</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.1.29.29.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.29.29.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.95</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.5.1.29.29.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.30.30">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.1.30.30.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">MuHS (ICLR’2023)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib78" title="">78</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.30.30.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.20</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.30.30.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.50</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.30.30.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.30.30.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.60</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.30.30.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.08</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.30.30.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.30.30.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.30.30.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.80</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.30.30.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">78.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.1.30.30.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.30.30.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.70</td>
<td class="ltx_td ltx_align_center" id="S3.T1.5.1.30.30.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.1.31.31">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T1.5.1.31.31.1" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.1.1">PAT (Ours)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.5.1.31.31.2" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.2.1">71.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.5.1.31.31.3" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.3.1">76.85</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.5.1.31.31.4" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.4.1">67.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.5.1.31.31.5" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.5.1">70.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.5.1.31.31.6" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.6.1">71.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.5.1.31.31.7" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.7.1">81.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.5.1.31.31.8" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.8.1">76.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.5.1.31.31.9" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.9.1">80.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.5.1.31.31.10" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.10.1">78.13</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.5.1.31.31.11" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.11.1">76.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.5.1.31.31.12" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.12.1">78.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.5.1.31.31.13" style="background-color:#EBECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.5.1.31.31.13.1">86.43</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S3.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="284" id="S3.F7.g1" src="extracted/5858111/Figure/visual.jpg" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Qualitative results of the proposed method and several competitive methods under the 1-shot setting. Results in the left panel are from PASCAL-5<sup class="ltx_sup" id="S3.F7.12.1"><span class="ltx_text ltx_font_italic" id="S3.F7.12.1.1">i</span></sup> while those in the right panel are from COCO-20<sup class="ltx_sup" id="S3.F7.13.2"><span class="ltx_text ltx_font_italic" id="S3.F7.13.2.1">i</span></sup>. Each row from the top to the bottom represents: support images with GT (<span class="ltx_text" id="S3.F7.14.3" style="color:#0000FF;">blue</span>), query images with GT (<span class="ltx_text" id="S3.F7.15.4" style="color:#00FF00;">green</span>), results of BAM (<span class="ltx_text" id="S3.F7.16.5" style="color:#FF0000;">red</span>), results of FPTrans (<span class="ltx_text" id="S3.F7.17.6" style="color:#FF0000;">red</span>), and our results (<span class="ltx_text" id="S3.F7.18.7" style="color:#FF0000;">red</span>).</figcaption>
</figure>
<figure class="ltx_figure" id="S3.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="316" id="S3.F8.g1" src="extracted/5858111/Figure/5shot.jpg" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Comparison results of our method under the 1- and 5-shot settings on COCO-20<sup class="ltx_sup" id="S3.F8.4.1"><span class="ltx_text ltx_font_italic" id="S3.F8.4.1.1">i</span></sup> dataset. The first labeled image (blue border) in the Support Set is sampled for 1-shot segmentation.</figcaption>
</figure>
<figure class="ltx_figure" id="S3.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="368" id="S3.F9.g1" src="extracted/5858111/Figure/ablation.jpg" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Qualitative Comparison of the variants of PAT. Each column from left to right: support images (GT), query images (GT), results of baseline, results of exploiting FG-prompts, results of exploiting FG-prompts+SPT, results of exploiting FG-prompts+BG-prompts+SPT, results of exploiting FG-prompts+BG-prompts+SPT+PMG (i.e., PAT).</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Experiments</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we demonstrate the performance of our method on four different tasks. Firstly, we describe the experimental setup for the standard FSS in Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS1" title="4.1 Experimental Setup ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4.1</span></a>. Then Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS2" title="4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4.2</span></a> and Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS3" title="4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4.3</span></a> describe the performance comparisons with other methods and ablation studies, respectively, on the standard FSS task. Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS4" title="4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4.4</span></a> demonstrates the performance of the proposed PAT on several more challenging extended tasks. Finally, some failure cases are described in Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS5" title="4.5 Failure case analysis ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4.5</span></a>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span><span class="ltx_text ltx_font_italic" id="S4.SS1.1.1">Experimental Setup</span>
</h3>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Datasets and Evaluation Metric</h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.6">We evaluate the proposed method on three popular FSS datasets PASCAL-5<sup class="ltx_sup" id="S4.SS1.SSS1.p1.6.1"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p1.6.1.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib22" title="">22</a>]</cite>, COCO-20<sup class="ltx_sup" id="S4.SS1.SSS1.p1.6.2"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p1.6.2.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib25" title="">25</a>]</cite> and iSAID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib36" title="">36</a>]</cite>. PASCAL-5<sup class="ltx_sup" id="S4.SS1.SSS1.p1.6.3"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p1.6.3.1">i</span></sup> is composed of PASCAL VOC 2012 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib79" title="">79</a>]</cite> and SBD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib80" title="">80</a>]</cite>, which includes 20 classes. COCO-20<sup class="ltx_sup" id="S4.SS1.SSS1.p1.6.4"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p1.6.4.1">i</span></sup> is constructed from MSCOCO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib81" title="">81</a>]</cite>, which includes 80 classes. We divide the two datasets into 4 folds, each fold in PASCAL-5<sup class="ltx_sup" id="S4.SS1.SSS1.p1.6.5"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p1.6.5.1">i</span></sup> contains 15 classes for training and 5 classes for testing, while in COCO-20<sup class="ltx_sup" id="S4.SS1.SSS1.p1.6.6"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS1.p1.6.6.1">i</span></sup> contains 60 classes for training and 20 classes for testing. For each fold, we randomly sample 5000 image pairs for validation. In addition, we perform the FSS task on a remote sensing dataset, i.e., iSAID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib82" title="">82</a>]</cite>, which includes 15 classes. We divide the dataset into 3 folds, each containing 10 classes for training and 5 classes for testing.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p2">
<p class="ltx_p" id="S4.SS1.SSS1.p2.1">For a fair comparison, mean intersection-over-union (mIoU) and foreground-background IoU (FB-IoU) are employed as evaluation metrics <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib28" title="">28</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Implementation details</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.8">The proposed model is implemented on Tesla A40 GPUs by using the PyTorch framework. We employ two vision transformers, DeiT-B/16 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib50" title="">50</a>]</cite> and ViT-B/16 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib51" title="">51</a>]</cite>, as encoders due to their unique attention structure to flexibly insert inputs (prompts). Both of them are pre-trained on ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib23" title="">23</a>]</cite>. The batch size is set to 4 and the SGD optimizer is employed to update the parameters of the model. Following the previous FSS setups <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib36" title="">36</a>]</cite>, we randomly crop the images to 480<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.1.m1.1"><semantics id="S4.SS1.SSS2.p1.1.m1.1a"><mo id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.1b"><times id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.1.m1.1d">×</annotation></semantics></math>480 (iSAID cropped to 256<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.2.m2.1"><semantics id="S4.SS1.SSS2.p1.2.m2.1a"><mo id="S4.SS1.SSS2.p1.2.m2.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.2.m2.1b"><times id="S4.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.2.m2.1d">×</annotation></semantics></math>256) and adopt the same data augmentation strategies. For PASCAL-5<sup class="ltx_sup" id="S4.SS1.SSS2.p1.8.1"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS2.p1.8.1.1">i</span></sup>, we train the model for 50 epochs and set the initial learning rate to 1e-3. For COCO-20<sup class="ltx_sup" id="S4.SS1.SSS2.p1.8.2"><span class="ltx_text ltx_font_italic" id="S4.SS1.SSS2.p1.8.2.1">i</span></sup>, we train the model for 40 epochs and set the initial learning rate to 6e-4. For iSAID, we train the model for 40 epochs and set the initial learning rate to 1e-3. We set both the number of FG-prompts <math alttext="N_{p}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.5.m5.1"><semantics id="S4.SS1.SSS2.p1.5.m5.1a"><msub id="S4.SS1.SSS2.p1.5.m5.1.1" xref="S4.SS1.SSS2.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS2.p1.5.m5.1.1.2" xref="S4.SS1.SSS2.p1.5.m5.1.1.2.cmml">N</mi><mi id="S4.SS1.SSS2.p1.5.m5.1.1.3" xref="S4.SS1.SSS2.p1.5.m5.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.5.m5.1b"><apply id="S4.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.2">𝑁</ci><ci id="S4.SS1.SSS2.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.5.m5.1c">N_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and BG-prompts <math alttext="N_{b}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.6.m6.1"><semantics id="S4.SS1.SSS2.p1.6.m6.1a"><msub id="S4.SS1.SSS2.p1.6.m6.1.1" xref="S4.SS1.SSS2.p1.6.m6.1.1.cmml"><mi id="S4.SS1.SSS2.p1.6.m6.1.1.2" xref="S4.SS1.SSS2.p1.6.m6.1.1.2.cmml">N</mi><mi id="S4.SS1.SSS2.p1.6.m6.1.1.3" xref="S4.SS1.SSS2.p1.6.m6.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.6.m6.1b"><apply id="S4.SS1.SSS2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1.2">𝑁</ci><ci id="S4.SS1.SSS2.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.6.m6.1c">N_{b}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.6.m6.1d">italic_N start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> to 8. The factors <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.7.m7.1"><semantics id="S4.SS1.SSS2.p1.7.m7.1a"><mi id="S4.SS1.SSS2.p1.7.m7.1.1" xref="S4.SS1.SSS2.p1.7.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.7.m7.1b"><ci id="S4.SS1.SSS2.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.7.m7.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.7.m7.1d">italic_α</annotation></semantics></math> and <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.8.m8.1"><semantics id="S4.SS1.SSS2.p1.8.m8.1a"><mi id="S4.SS1.SSS2.p1.8.m8.1.1" xref="S4.SS1.SSS2.p1.8.m8.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.8.m8.1b"><ci id="S4.SS1.SSS2.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.8.m8.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.8.m8.1d">italic_β</annotation></semantics></math> for balancing the loss contribution in Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.E14" title="In 3.6 Matching ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">14</span></a>) are set to 5e-2.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span class="ltx_text ltx_font_italic" id="S4.SS2.1.1">Comparison with the State of-the-Arts</span>
</h3>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Quantitative Analysis</h4>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS1.p1.1.1">PASCAL-5<sup class="ltx_sup" id="S4.SS2.SSS1.p1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.SS2.SSS1.p1.1.1.1.1">i</span></sup>: </span>
Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.T1" title="TABLE I ‣ 3.6 Matching ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">I</span></a> demonstrates the performance comparison of different FSS methods on PASCAL-5<sup class="ltx_sup" id="S4.SS2.SSS1.p1.3.2"><span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p1.3.2.1">i</span></sup> benchmark, where our PAT achieves state-of-the-art performance in all cases. With the backbone of DeiT-B/16, PAT surpasses the most competitive CNN-based HDMNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib54" title="">54</a>]</cite> by 2.31% (1-shot) and 6.18% (5-shot) mIoU, respectively. Notably, our 1-shot result almost achieves the 5-shot result of HDMNet, i.e., 71.66% <math alttext="vs." class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.3.m2.1"><semantics id="S4.SS2.SSS1.p1.3.m2.1a"><mrow id="S4.SS2.SSS1.p1.3.m2.1.1.1" xref="S4.SS2.SSS1.p1.3.m2.1.1.1.1.cmml"><mrow id="S4.SS2.SSS1.p1.3.m2.1.1.1.1" xref="S4.SS2.SSS1.p1.3.m2.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p1.3.m2.1.1.1.1.2" xref="S4.SS2.SSS1.p1.3.m2.1.1.1.1.2.cmml">v</mi><mo id="S4.SS2.SSS1.p1.3.m2.1.1.1.1.1" xref="S4.SS2.SSS1.p1.3.m2.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p1.3.m2.1.1.1.1.3" xref="S4.SS2.SSS1.p1.3.m2.1.1.1.1.3.cmml">s</mi></mrow><mo id="S4.SS2.SSS1.p1.3.m2.1.1.1.2" lspace="0em" xref="S4.SS2.SSS1.p1.3.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m2.1b"><apply id="S4.SS2.SSS1.p1.3.m2.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m2.1.1.1"><times id="S4.SS2.SSS1.p1.3.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m2.1.1.1.1.1"></times><ci id="S4.SS2.SSS1.p1.3.m2.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.3.m2.1.1.1.1.2">𝑣</ci><ci id="S4.SS2.SSS1.p1.3.m2.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.3.m2.1.1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m2.1c">vs.</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.3.m2.1d">italic_v italic_s .</annotation></semantics></math> 71.83%, indicating its superiority in effectively minimizing the number of support samples required for FSS. In addition, the proposed PAT also achieves a 2.58% mIoU increment compared to two transformer-based methods, FPTrans <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib66" title="">66</a>]</cite>, and MuHS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib78" title="">78</a>]</cite>, under the 1-shot setting. Moreover, the 1.88% (1-shot) and 4.23% (5-shot) FB-IoU increments similarly demonstrate its superiority.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS1.p2">
<p class="ltx_p" id="S4.SS2.SSS1.p2.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS1.p2.1.1">COCO-20<sup class="ltx_sup" id="S4.SS2.SSS1.p2.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.SS2.SSS1.p2.1.1.1.1">i</span></sup>: </span> Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T2" title="TABLE II ‣ 4.2.2 Qualitative Analysis ‣ 4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">II</span></a> presents the performance on COCO-20<sup class="ltx_sup" id="S4.SS2.SSS1.p2.2.2"><span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p2.2.2.1">i</span></sup> benchmark. We can find that our PAT also achieves competitive segmentation performance when faced with more complex and diverse scenarios. In particular, our method achieves the 48.05% mIoU score, outperforming the best CNN-based competitor and the best transformer-based competitor by 1.82% and 0.7% mIoU, respectively. Furthermore, in terms of FB-IoU, our PAT beats the state-of-the-arts by 0.34% and 2.38% FB-IoU under the 1- and 5-shot settings, respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS1.p3">
<p class="ltx_p" id="S4.SS2.SSS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS1.p3.1.1">iSAID: </span> Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T3" title="TABLE III ‣ 4.2.2 Qualitative Analysis ‣ 4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">III</span></a> demonstrates the performance on iSAID benchmark. Our PAT achieves the best segmentation performance even in remote sensing scenarios with larger intra- and inter-class variance, with 50.51% and 59.41% mIoU under the 1- and 5-shot settings, respectively.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Qualitative Analysis</h4>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.4">To further demonstrate the superiority of the proposed method, we visualize the corresponding segmentation results in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.F7" title="Figure 7 ‣ 3.6 Matching ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">7</span></a>. Our PAT exhibits several advantages over other competitors: (1) PAT can efficiently focus on the novel class in a dynamic class-aware prompting manner, and significantly suppress false activation of base classes (e.g., the ”Chair” in <math alttext="1^{st}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.1.m1.1"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><msup id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml"><mn id="S4.SS2.SSS2.p1.1.m1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml">1</mn><mrow id="S4.SS2.SSS2.p1.1.m1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.1.1.3.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.2.cmml">s</mi><mo id="S4.SS2.SSS2.p1.1.m1.1.1.3.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p1.1.m1.1.1.3.3" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><apply id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">superscript</csymbol><cn id="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS2.SSS2.p1.1.m1.1.1.2">1</cn><apply id="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.3"><times id="S4.SS2.SSS2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.1"></times><ci id="S4.SS2.SSS2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.2">𝑠</ci><ci id="S4.SS2.SSS2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">1^{st}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.1.m1.1d">1 start_POSTSUPERSCRIPT italic_s italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> column, the ”Person” in the <math alttext="6^{th}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.2.m2.1"><semantics id="S4.SS2.SSS2.p1.2.m2.1a"><msup id="S4.SS2.SSS2.p1.2.m2.1.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.SSS2.p1.2.m2.1.1.2" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.cmml">6</mn><mrow id="S4.SS2.SSS2.p1.2.m2.1.1.3" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.2.m2.1.1.3.2" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.2.cmml">t</mi><mo id="S4.SS2.SSS2.p1.2.m2.1.1.3.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p1.2.m2.1.1.3.3" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m2.1b"><apply id="S4.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">superscript</csymbol><cn id="S4.SS2.SSS2.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS2.SSS2.p1.2.m2.1.1.2">6</cn><apply id="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3"><times id="S4.SS2.SSS2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.1"></times><ci id="S4.SS2.SSS2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.2">𝑡</ci><ci id="S4.SS2.SSS2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m2.1c">6^{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.2.m2.1d">6 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> column). (2) By mining the part-level prompts, PAT can construct fine-grained part-level feature matching to tackle region-level differences within images and inter-image differences, while other competitors are prone to produce imprecise and incomplete results (e.g., ”Potted plant” in <math alttext="5^{th}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.3.m3.1"><semantics id="S4.SS2.SSS2.p1.3.m3.1a"><msup id="S4.SS2.SSS2.p1.3.m3.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.cmml"><mn id="S4.SS2.SSS2.p1.3.m3.1.1.2" xref="S4.SS2.SSS2.p1.3.m3.1.1.2.cmml">5</mn><mrow id="S4.SS2.SSS2.p1.3.m3.1.1.3" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.3.m3.1.1.3.2" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS2.SSS2.p1.3.m3.1.1.3.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p1.3.m3.1.1.3.3" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m3.1b"><apply id="S4.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1">superscript</csymbol><cn id="S4.SS2.SSS2.p1.3.m3.1.1.2.cmml" type="integer" xref="S4.SS2.SSS2.p1.3.m3.1.1.2">5</cn><apply id="S4.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.3"><times id="S4.SS2.SSS2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.1"></times><ci id="S4.SS2.SSS2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S4.SS2.SSS2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m3.1c">5^{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.3.m3.1d">5 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> column and ”Apple” in <math alttext="7^{th}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.4.m4.1"><semantics id="S4.SS2.SSS2.p1.4.m4.1a"><msup id="S4.SS2.SSS2.p1.4.m4.1.1" xref="S4.SS2.SSS2.p1.4.m4.1.1.cmml"><mn id="S4.SS2.SSS2.p1.4.m4.1.1.2" xref="S4.SS2.SSS2.p1.4.m4.1.1.2.cmml">7</mn><mrow id="S4.SS2.SSS2.p1.4.m4.1.1.3" xref="S4.SS2.SSS2.p1.4.m4.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.4.m4.1.1.3.2" xref="S4.SS2.SSS2.p1.4.m4.1.1.3.2.cmml">t</mi><mo id="S4.SS2.SSS2.p1.4.m4.1.1.3.1" xref="S4.SS2.SSS2.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p1.4.m4.1.1.3.3" xref="S4.SS2.SSS2.p1.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.4.m4.1b"><apply id="S4.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1">superscript</csymbol><cn id="S4.SS2.SSS2.p1.4.m4.1.1.2.cmml" type="integer" xref="S4.SS2.SSS2.p1.4.m4.1.1.2">7</cn><apply id="S4.SS2.SSS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.3"><times id="S4.SS2.SSS2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.3.1"></times><ci id="S4.SS2.SSS2.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.3.2">𝑡</ci><ci id="S4.SS2.SSS2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.4.m4.1c">7^{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.4.m4.1d">7 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> column). In addition, Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.F8" title="Figure 8 ‣ 3.6 Matching ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">8</span></a> compares the performance of our PAT under the 1- and 5-shot settings. It can be found that the 5-shot results are superior to the 1-shot results with more accurate boundaries and complete objects. The insight behind the phenomenon is that the class-aware prompts derived from aggregating multiple support image clues are more discriminative and representative.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span> Performance on COCO-20<sup class="ltx_sup" id="S4.T2.4.1"><span class="ltx_text ltx_font_italic" id="S4.T2.4.1.1">i</span></sup> benchmark in terms of mIoU and FB-IoU (%). “-” indicates that the result is not recorded. “Mean” and “FB-IoU” indicate the average mIoU scores and average FB-IoU scores for four folds, respectively.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.5" style="width:390.3pt;height:209.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-191.0pt,102.4pt) scale(0.50540212577854,0.50540212577854) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T2.5.1.1.1.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T2.5.1.1.1.1.1">Backbone</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.5.1.1.1.2" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T2.5.1.1.1.2.1">Methond</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="6" id="S4.T2.5.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">1-shot</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S4.T2.5.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">5-shot</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">Mean</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.2.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.2.2.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.2.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">Mean</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.2.2.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T2.5.1.3.3.1" rowspan="11" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T2.5.1.3.3.1.1">ResNet-50</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.5.1.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">CyCTR (NeurIPS’2021)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.60</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.3.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.33</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.3.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.3.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.3.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.3.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.20</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.3.3.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.3.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.55</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.3.3.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.4.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.4.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">HSNet (ICCV’2021)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib30" title="">30</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">36.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.4.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.4.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.4.4.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.20</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.4.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.4.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.4.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.4.4.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.00</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.4.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.95</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.4.4.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.70</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.5.5">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.5.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">HPA (TPAMI’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib52" title="">52</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.5.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.57</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.5.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.12</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.5.5.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.71</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.5.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.43</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.5.5.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.21</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.5.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.54</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.5.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.43</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.5.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.5.5.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.21</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.5.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.02</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.5.5.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.15</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.6.6">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.6.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">AAFormer (ECCV’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib34" title="">34</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.6.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.6.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.6.6.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.6.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.6.6.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.6.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.90</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.6.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.6.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.50</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.6.6.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.20</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.6.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.93</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.6.6.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.20</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.7.7">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.7.7.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">NERTNet (CVPR’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib32" title="">32</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.7.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">36.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.7.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.7.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.7.7.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">37.90</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.7.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.7.7.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.7.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.20</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.7.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.7.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.7.7.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.7.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.28</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.7.7.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.20</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.8.8">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.8.8.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">BAM (CVPR’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib40" title="">40</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.8.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.41</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.8.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.59</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.8.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.49</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.8.8.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.43</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.8.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.23</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.8.8.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.8.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.26</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.8.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.20</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.8.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.63</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.8.8.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.55</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.8.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.16</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.8.8.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.9.9">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.9.9.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">IPMT (NeurIPS’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.9.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.9.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.9.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.9.9.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.00</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.9.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.03</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.9.9.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.9.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.9.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.9.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.9.9.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.90</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.9.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.45</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.9.9.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.10.10">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.10.10.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">ASNet (CVPR’2023)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib76" title="">76</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.10.10.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.10.10.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.10.10.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.10.10.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.10.10.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.10.10.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.10.10.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.10.10.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.10.10.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.10.10.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.10.10.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.90</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.10.10.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.60</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.11.11">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.11.11.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">ABCNet
(CVPR’2023)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib83" title="">83</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.11.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.11.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.90</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.11.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.11.11.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.11.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.11.11.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.11.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.20</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.11.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.11.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.11.11.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.11.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.11.11.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.80</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.12.12">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.12.12.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">RiFeNet
(AAAI’2024)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib43" title="">43</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.12.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.12.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.20</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.12.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.12.12.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.12.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.12.12.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.12.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.12.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.12.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.12.12.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.12.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.12.12.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.13.13">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.13.13.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PMNet (WACV’2024)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib77" title="">77</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.13.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.13.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.00</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.13.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.13.13.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.13.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.13.13.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.13.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.13.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.00</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.13.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.13.13.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.13.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.13.13.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.14.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T2.5.1.14.14.1" rowspan="7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T2.5.1.14.14.1.1">ResNet-101</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.5.1.14.14.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">PFENet (TPAMI’2020)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib28" title="">28</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.14.14.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.14.14.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">33.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.14.14.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">32.30</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.14.14.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">30.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.14.14.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">32.45</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.14.14.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.14.14.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.14.14.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.14.14.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.20</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.14.14.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.14.14.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">37.40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.14.14.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.80</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.15.15">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.15.15.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">APANet (TMM’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib29" title="">29</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.15.15.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.15.15.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.15.15.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.50</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.15.15.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.15.15.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.85</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.15.15.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.15.15.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.15.15.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.15.15.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.15.15.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.15.15.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.15.15.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.80</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.16.16">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.16.16.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">HPA (TPAMI’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib52" title="">52</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.16.16.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.08</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.16.16.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.01</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.16.16.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.16.16.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.19</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.16.16.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.77</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.16.16.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.37</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.16.16.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.18</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.16.16.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.76</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.16.16.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.97</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.16.16.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.64</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.16.16.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.39</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.16.16.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.02</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.17.17">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.17.17.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">SSPNet (ECCV’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib42" title="">42</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.17.17.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.17.17.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.17.17.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.17.17.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.20</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.17.17.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.03</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.17.17.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.17.17.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.17.17.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.17.17.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.17.17.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.17.17.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.48</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.17.17.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.18.18">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.18.18.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">NTRENet (CVPR’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib32" title="">32</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.18.18.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.18.18.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.18.18.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.50</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.18.18.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.18.18.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.08</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.18.18.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.18.18.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.18.18.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.40</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.18.18.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.18.18.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.18.18.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.15</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.18.18.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.60</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.19.19">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.19.19.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">IPMT (NeurIPS’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.19.19.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.19.19.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.19.19.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.19.19.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.19.19.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.58</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.19.19.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.19.19.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.19.19.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.19.19.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.19.19.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.19.19.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.88</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.19.19.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.20.20">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.20.20.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PMNet (WACV’2024)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib77" title="">77</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.20.20.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.70</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.20.20.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.20.20.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.20.20.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.20.20.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.20.20.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.20.20.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.20.20.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.20.20.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.50</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.20.20.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.80</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.20.20.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.20.20.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.21.21">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T2.5.1.21.21.1" rowspan="3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T2.5.1.21.21.1.1">DeiT-B/16</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.5.1.21.21.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fptrans (NeurIPS’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib66" title="">66</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.21.21.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.21.21.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.21.21.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.60</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.21.21.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.21.21.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.98</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.21.21.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.21.21.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.21.21.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.21.21.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.30</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.1.21.21.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.21.21.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.1.21.21.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.22.22">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T2.5.1.22.22.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">MuHS (ICLR’2023)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib78" title="">78</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.22.22.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.00</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.22.22.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.00</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.22.22.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.22.22.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.30</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.22.22.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.35</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.22.22.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.22.22.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.22.22.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.22.22.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.5.1.22.22.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.20</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.22.22.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">56.65</td>
<td class="ltx_td ltx_align_center" id="S4.T2.5.1.22.22.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.1.23.23">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T2.5.1.23.23.1" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.1.1">PAT (Ours)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.23.23.2" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.2.1">40.62</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.23.23.3" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.3.1">51.94</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.23.23.4" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.4.1">48.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.5.1.23.23.5" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.5.1">50.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.23.23.6" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.6.1">48.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.5.1.23.23.7" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.7.1">69.14</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.23.23.8" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.8.1">51.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.23.23.9" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.9.1">63.15</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.23.23.10" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.10.1">59.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T2.5.1.23.23.11" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.11.1">55.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.23.23.12" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.12.1">57.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.5.1.23.23.13" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.1.23.23.13.1">76.40</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Performance on iSAID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib82" title="">82</a>]</cite> benchmark in terms of mIoU and FB-IoU (%). ”Mean” and ”FB-IoU” indicate the average mIoU scores and average FB-IoU scores for three folds, respectively.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.1" style="width:368.6pt;height:193.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-158.5pt,83.2pt) scale(0.537616400997796,0.537616400997796) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T3.1.1.1.1.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T3.1.1.1.1.1.1">Backbone</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T3.1.1.1.1.2" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T3.1.1.1.1.2.1">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="5" id="S4.T3.1.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">1-shot</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S4.T3.1.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">5-shot</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Mean</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.2.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.2.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">Mean</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.2.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.1.3.3.1" rowspan="8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T3.1.1.3.3.1.1">ResNet-50</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">PFENet (TPAMI’2020) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib28" title="">28</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.34</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.79</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.3.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.46</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.3.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.34</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.71</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.51</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.3.3.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.45</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.3.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.99</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.4.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.4.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">CyCTR (NeurIPS’2021) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.15</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.4.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.79</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.4.4.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.86</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.91</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.01</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.4.4.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.83</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.58</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.4.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.81</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.5.5">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.5.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">IPMT (NeurIPS’2021) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.96</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.76</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.5.5.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.73</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.82</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.5.5.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.68</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.50</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.5.5.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">56.71</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.54</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.5.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.69</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.6.6">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.6.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">NTRENet (CVPR’2022) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib32" title="">32</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.52</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.66</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.6.6.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.87</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.68</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.6.6.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.84</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.60</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.99</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.6.6.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.07</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.89</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.6.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.74</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.7.7">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.7.7.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">DCPNet (IJCV’2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib31" title="">31</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.43</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">37.59</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.7.7.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.09</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.04</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.7.7.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.76</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.34</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.75</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.7.7.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.33</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.47</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.7.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.10</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.8.8">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.8.8.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">SCCAN (ICCV’2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib53" title="">53</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.24</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.8.8.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.84</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.89</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.8.8.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.26</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.75</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.95</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.8.8.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.26</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.65</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.8.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.23</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.9.9">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.9.9.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">R2Net (TGRS’2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib84" title="">84</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.9.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">56.81</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.9.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.85</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.9.9.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.02</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.9.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.56</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.9.9.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.65</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.9.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.47</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.9.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.43</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.9.9.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.24</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.9.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.71</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.9.9.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.70</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.10.10">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.10.10.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">DMNet (TGRS’2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib36" title="">36</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.10.10.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.45</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.10.10.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.68</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.10.10.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.60</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.10.10.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.58</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.10.10.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.46</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.10.10.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.67</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.10.10.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.06</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.10.10.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.28</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.10.10.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.34</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.10.10.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.81</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.1.11.11.1" rowspan="8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T3.1.1.11.11.1.1">ResNet-101</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.11.11.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">PFENet (TPAMI’2020) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib28" title="">28</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.11.11.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.11.11.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.37</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.11.11.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.11.11.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.30</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.11.11.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.46</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.11.11.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.11.11.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.55</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.11.11.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.55</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.11.11.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.83</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.11.11.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.57</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.12.12">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.12.12.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">CyCTR (NeurIPS’2021) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.89</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.89</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.12.12.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.22</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.33</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.12.12.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.35</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.15</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.28</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.12.12.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.32</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.25</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.12.12.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.45</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.13.13">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.13.13.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">IPMT (NeurIPS’2021) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.62</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.83</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.13.13.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.10</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.85</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.13.13.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.19</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.38</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.13.13.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.50</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.76</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.13.13.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.35</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.14.14">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.14.14.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">NTRENet (CVPR’2022) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib32" title="">32</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.33</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.73</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.14.14.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.23</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.76</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.14.14.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.25</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.24</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.87</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.14.14.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.53</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.88</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.14.14.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.16</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.15.15">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.15.15.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">DCPNet (IJCV’2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib31" title="">31</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.63</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.15.15.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.34</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.26</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.15.15.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.56</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.68</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.02</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.15.15.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.52</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.41</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.15.15.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.96</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.16.16">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.16.16.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">SCCAN (ICCV’2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib53" title="">53</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.71</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.76</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.16.16.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.45</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.31</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.16.16.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.72</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.85</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.11</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.16.16.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.56</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.17</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.16.16.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.27</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.17.17">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.17.17.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">R2Net (TGRS’2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib84" title="">84</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.74</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.76</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.17.17.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.45</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.65</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.17.17.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.38</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.83</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.58</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.17.17.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.69</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.70</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.17.17.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.79</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.18.18">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.18.18.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">DMNet (TGRS’2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib36" title="">36</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.18.18.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">54.01</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.18.18.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.04</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.18.18.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.57</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.18.18.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.21</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.18.18.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.03</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.18.18.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.70</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.18.18.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.69</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.18.18.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">56.47</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.18.18.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.29</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.18.18.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.88</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.19.19">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T3.1.1.19.19.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T3.1.1.19.19.1.1">DeiT-B/16</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.19.19.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">FPTrans (NeurIPS’2022) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib66" title="">66</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.19.19.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.59</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.19.19.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">37.79</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.19.19.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.19.19.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.41</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.19.19.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.19.19.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.19.19.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.24</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.19.19.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.19.19.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.04</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.19.19.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.63</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.20.20">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T3.1.1.20.20.1" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.20.20.1.1">PAT (Ours)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.20.20.2" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.20.20.2.1">54.81</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.20.20.3" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.20.20.3.1">43.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.1.1.20.20.4" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.20.20.4.1">53.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.20.20.5" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.20.20.5.1">50.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.1.1.20.20.6" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.20.20.6.1">64.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.20.20.7" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.20.20.7.1">62.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.20.20.8" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.20.20.8.1">49.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.1.1.20.20.9" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.20.20.9.1">66.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.20.20.10" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.20.20.10.1">59.41</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.20.20.11" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.20.20.11.1">70.20</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE IV: </span> Ablation studies of different components of our PAT under the 1-shot setting. “FG” and “BG” indicate FG-prompts and BG-prompts, respectively. “SPT” indicates the Semantic Prompt Transfer and “PMG” indicates the Part Mask Generator. <span class="ltx_text ltx_font_bold" id="S4.T4.5.1">Bold</span> and <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.6.2">underline</span> indicate the best and the sub-best performance, respectively.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.2" style="width:411.9pt;height:188.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(48.3pt,-22.0pt) scale(1.30595175542517,1.30595175542517) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T4.2.2.2.3" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T4.2.2.2.3.1">#</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2" id="S4.T4.2.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Prompting</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2" id="S4.T4.2.2.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">Transferring</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2" id="S4.T4.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PASCAL-<math alttext="5^{i}" class="ltx_Math" display="inline" id="S4.T4.1.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.1.m1.1a"><msup id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml"><mn id="S4.T4.1.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.1.m1.1.1.2.cmml">5</mn><mi id="S4.T4.1.1.1.1.m1.1.1.3" xref="S4.T4.1.1.1.1.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.1.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1">superscript</csymbol><cn id="S4.T4.1.1.1.1.m1.1.1.2.cmml" type="integer" xref="S4.T4.1.1.1.1.m1.1.1.2">5</cn><ci id="S4.T4.1.1.1.1.m1.1.1.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">5^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.1.m1.1d">5 start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T4.2.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">COCO-<math alttext="20^{i}" class="ltx_Math" display="inline" id="S4.T4.2.2.2.2.m1.1"><semantics id="S4.T4.2.2.2.2.m1.1a"><msup id="S4.T4.2.2.2.2.m1.1.1" xref="S4.T4.2.2.2.2.m1.1.1.cmml"><mn id="S4.T4.2.2.2.2.m1.1.1.2" xref="S4.T4.2.2.2.2.m1.1.1.2.cmml">20</mn><mi id="S4.T4.2.2.2.2.m1.1.1.3" xref="S4.T4.2.2.2.2.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.m1.1b"><apply id="S4.T4.2.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.2.2.2.2.m1.1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1">superscript</csymbol><cn id="S4.T4.2.2.2.2.m1.1.1.2.cmml" type="integer" xref="S4.T4.2.2.2.2.m1.1.1.2">20</cn><ci id="S4.T4.2.2.2.2.m1.1.1.3.cmml" xref="S4.T4.2.2.2.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.m1.1c">20^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.2.2.m1.1d">20 start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</th>
</tr>
<tr class="ltx_tr" id="S4.T4.2.2.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.2.2.3.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">FG</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T4.2.2.3.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">BG</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S4.T4.2.2.3.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">SPT</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T4.2.2.3.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">PMG</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.2.2.3.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">mIoU</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T4.2.2.3.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.2.2.3.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">mIoU</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.2.2.3.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.2.2.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.2.2.4.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(a)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.2.4.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.2.2.4.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.2.4.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.2.2.4.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.2.4.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.30</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.2.2.4.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.56</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.2.4.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.14</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.2.4.1.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.00</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.2.5.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.2.2.5.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(b)</th>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.5.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.5.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.5.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.5.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.5.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.26</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.5.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">78.81</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.5.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.75</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.5.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.16</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.2.6.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.2.2.6.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(c)</th>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.6.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.6.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.6.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.6.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.6.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.57</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.6.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">79.58</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.6.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.58</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.6.3.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.82</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.2.7.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.2.2.7.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(d)</th>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.7.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.7.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.7.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.7.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.7.4.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.52</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.7.4.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">80.40</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.7.4.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.71</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.7.4.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.87</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.2.8.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.2.2.8.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(e)</th>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.8.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.8.5.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.8.5.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.8.5.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.8.5.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.2.2.8.5.6.1">70.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.2.2.8.5.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.2.2.8.5.7.1">80.96</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.8.5.8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.2.2.8.5.8.1">46.92</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.8.5.9" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.2.2.8.5.9.1">68.11</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.2.9.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T4.2.2.9.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(f)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.2.2.9.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.2.2.9.6.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.2.2.9.6.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.2.2.9.6.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.2.2.9.6.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.9.6.6.1">71.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T4.2.2.9.6.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.9.6.7.1">81.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.2.2.9.6.8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.9.6.8.1">48.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.2.2.9.6.9" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.9.6.9.1">69.14</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S4.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="339" id="S4.F10.g1" src="extracted/5858111/Figure/t_sne.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span> T-SNE results for the feature distribution of all unseen classes in the four folds (each contains 5 classes) on PASCAL-<math alttext="5^{i}" class="ltx_Math" display="inline" id="S4.F10.2.m1.1"><semantics id="S4.F10.2.m1.1b"><msup id="S4.F10.2.m1.1.1" xref="S4.F10.2.m1.1.1.cmml"><mn id="S4.F10.2.m1.1.1.2" xref="S4.F10.2.m1.1.1.2.cmml">5</mn><mi id="S4.F10.2.m1.1.1.3" xref="S4.F10.2.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.F10.2.m1.1c"><apply id="S4.F10.2.m1.1.1.cmml" xref="S4.F10.2.m1.1.1"><csymbol cd="ambiguous" id="S4.F10.2.m1.1.1.1.cmml" xref="S4.F10.2.m1.1.1">superscript</csymbol><cn id="S4.F10.2.m1.1.1.2.cmml" type="integer" xref="S4.F10.2.m1.1.1.2">5</cn><ci id="S4.F10.2.m1.1.1.3.cmml" xref="S4.F10.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F10.2.m1.1d">5^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.F10.2.m1.1e">5 start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE V: </span>Ablation studies of initialization scheme of FG-prompts, which are conducted under case (b) in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T4" title="TABLE IV ‣ 4.2.2 Qualitative Analysis ‣ 4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">IV</span></a>. “SBERT” is a pre-trained language model and “CLIP” is a pre-trained visual language model.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T5.2" style="width:355.6pt;height:104.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(24.3pt,-7.1pt) scale(1.15864092174022,1.15864092174022) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T5.2.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">#</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T5.2.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Initialization Scheme</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PASCAL-5<sup class="ltx_sup" id="S4.T5.1.1.1.1.1"><span class="ltx_text ltx_font_italic" id="S4.T5.1.1.1.1.1.1">i</span></sup>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.2.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">COCO-20<sup class="ltx_sup" id="S4.T5.2.2.2.2.1"><span class="ltx_text ltx_font_italic" id="S4.T5.2.2.2.2.1.1">i</span></sup>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.2.2.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.2.2.3.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(a)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.2.2.3.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Random Initial</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.2.2.3.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.34</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.2.2.3.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.07</td>
</tr>
<tr class="ltx_tr" id="S4.T5.2.2.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.2.2.4.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(b)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.2.2.4.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Support Average Token</th>
<td class="ltx_td ltx_align_center" id="S4.T5.2.2.4.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.85</td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.2.4.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.91</td>
</tr>
<tr class="ltx_tr" id="S4.T5.2.2.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.2.2.5.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(c)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.2.2.5.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">SBERT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib85" title="">85</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T5.2.2.5.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.2.2.5.3.3.1">68.03</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.2.2.5.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T5.2.2.5.3.4.1">43.28</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.2.2.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T5.2.2.6.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(d)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T5.2.2.6.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib73" title="">73</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.2.2.6.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.2.2.6.4.3.1">68.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.2.2.6.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.2.2.6.4.4.1">43.75</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VI: </span> Ablation studies of Semantic Prompt Transfer (SPT). “Support” and “Query” indicate the semantic migration from support images to prompts and from the query image to prompts, respectively. “<math alttext="\mathcal{F}_{G}" class="ltx_Math" display="inline" id="S4.T6.2.m1.1"><semantics id="S4.T6.2.m1.1b"><msub id="S4.T6.2.m1.1.1" xref="S4.T6.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T6.2.m1.1.1.2" xref="S4.T6.2.m1.1.1.2.cmml">ℱ</mi><mi id="S4.T6.2.m1.1.1.3" xref="S4.T6.2.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T6.2.m1.1c"><apply id="S4.T6.2.m1.1.1.cmml" xref="S4.T6.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.2.m1.1.1.1.cmml" xref="S4.T6.2.m1.1.1">subscript</csymbol><ci id="S4.T6.2.m1.1.1.2.cmml" xref="S4.T6.2.m1.1.1.2">ℱ</ci><ci id="S4.T6.2.m1.1.1.3.cmml" xref="S4.T6.2.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.2.m1.1d">\mathcal{F}_{G}</annotation><annotation encoding="application/x-llamapun" id="S4.T6.2.m1.1e">caligraphic_F start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math>” indicates the Gaussian suppression.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T6.3" style="width:325.2pt;height:133.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(52.9pt,-21.7pt) scale(1.48245760345797,1.48245760345797) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T6.3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T6.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T6.3.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">#</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.3.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Support</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.3.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Query</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T6.3.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="\mathcal{F}_{G}" class="ltx_Math" display="inline" id="S4.T6.3.1.1.1.m1.1"><semantics id="S4.T6.3.1.1.1.m1.1a"><msub id="S4.T6.3.1.1.1.m1.1.1" xref="S4.T6.3.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T6.3.1.1.1.m1.1.1.2" xref="S4.T6.3.1.1.1.m1.1.1.2.cmml">ℱ</mi><mi id="S4.T6.3.1.1.1.m1.1.1.3" xref="S4.T6.3.1.1.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T6.3.1.1.1.m1.1b"><apply id="S4.T6.3.1.1.1.m1.1.1.cmml" xref="S4.T6.3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T6.3.1.1.1.m1.1.1.1.cmml" xref="S4.T6.3.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T6.3.1.1.1.m1.1.1.2.cmml" xref="S4.T6.3.1.1.1.m1.1.1.2">ℱ</ci><ci id="S4.T6.3.1.1.1.m1.1.1.3.cmml" xref="S4.T6.3.1.1.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.3.1.1.1.m1.1c">\mathcal{F}_{G}</annotation><annotation encoding="application/x-llamapun" id="S4.T6.3.1.1.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.3.1.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">mIoU</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.3.1.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T6.3.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T6.3.1.2.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(a)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.1.2.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.1.2.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T6.3.1.2.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.1.2.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.07</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.1.2.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T6.3.1.2.1.6.1">81.4</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T6.3.1.3.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(b)</th>
<td class="ltx_td ltx_align_center" id="S4.T6.3.1.3.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.1.3.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.1.3.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.1.3.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.15</td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.1.3.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.1</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T6.3.1.4.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(c)</th>
<td class="ltx_td ltx_align_center" id="S4.T6.3.1.4.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.1.4.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T6.3.1.4.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">✗</td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.1.4.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T6.3.1.4.3.5.1">71.37</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.3.1.4.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.25</td>
</tr>
<tr class="ltx_tr" id="S4.T6.3.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T6.3.1.5.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(d)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.3.1.5.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.3.1.5.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T6.3.1.5.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">✓</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.3.1.5.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.5.4.5.1">71.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.3.1.5.4.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.3.1.5.4.6.1">81.59</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span class="ltx_text ltx_font_italic" id="S4.SS3.1.1">Ablation Studies</span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">This section conducts a series of ablation studies to analyze the role of each component. Unless otherwise noted, the experiments are conducted on PASCAL-5<sup class="ltx_sup" id="S4.SS3.p1.1.1"><span class="ltx_text ltx_font_italic" id="S4.SS3.p1.1.1.1">i</span></sup> benchmark with the backbone of DeiT-B/16 under the 1-shot setting.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Component Analysis</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.6">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T4" title="TABLE IV ‣ 4.2.2 Qualitative Analysis ‣ 4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">IV</span></a> demonstrates the impact of different components on performance and the following phenomena can be observed: (1) Introducing class-specific FG-prompts (FG) (case (b)) can achieve effective performance gains compared to baseline, e.g., 0.96% mIoU on PASCAL-5<sup class="ltx_sup" id="S4.SS3.SSS1.p1.6.1"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.6.1.1">i</span></sup> and 1.61% on COCO-20<sup class="ltx_sup" id="S4.SS3.SSS1.p1.6.2"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.6.2.1">i</span></sup>, which demonstrates the effectiveness of the dynamic class-aware prompting paradigm for FSS. (2) After incorporating the Semantic Prompt Transfer (SPT), 2.27% and 3.44% mIoU gains on PASCAL-5<sup class="ltx_sup" id="S4.SS3.SSS1.p1.6.3"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.6.3.1">i</span></sup> and COCO-20<sup class="ltx_sup" id="S4.SS3.SSS1.p1.6.4"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.6.4.1">i</span></sup> (case (c)) can be achieved. These improvements highlight that extracting class-specific clues from support and query images significantly enhances the class-awareness, enabling the encoder to precisely focus on the objects. (3) Combining with the Part Mask Generator (PMG) to mine fine-grained part-level prompts achieves the performance gains of 3.38% mIoU on PASCAL-5<sup class="ltx_sup" id="S4.SS3.SSS1.p1.6.5"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.6.5.1">i</span></sup> and 4.78% mIoU on COCO-20<sup class="ltx_sup" id="S4.SS3.SSS1.p1.6.6"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.6.6.1">i</span></sup> (case (e)), which suggests that mining fine-grained part-level semantics further enable the role of prompts for more accurate segmentation. (4) When additionally introducing BG-prompts (BG) and enriching their description with SPT can achieve 4.36% and 5.91% mIoU gains (case (f)), illustrating the importance of background semantics for segmentation.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p2">
<p class="ltx_p" id="S4.SS3.SSS1.p2.6">Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.F9" title="Figure 9 ‣ 3.6 Matching ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">9</span></a> illustrates the segmentation results for different variants of our method. Remarkably, compared to the baseline (3<sup class="ltx_sup" id="S4.SS3.SSS1.p2.6.1"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p2.6.1.1">rd</span></sup> column), introducing FG-prompts better focuses the target region, in spite of interference from other irrelevant classes, e.g., the ”person” next to the ”bottle” (3<sup class="ltx_sup" id="S4.SS3.SSS1.p2.6.2"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p2.6.2.1">rd</span></sup> row). SPT refines the description of the prompts to achieve more precise segmentation results (5<sup class="ltx_sup" id="S4.SS3.SSS1.p2.6.3"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p2.6.3.1">th</span></sup> column), e.g., the leaves of the ”potted plant” (2<sup class="ltx_sup" id="S4.SS3.SSS1.p2.6.4"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p2.6.4.1">nd</span></sup> row). When further adding BG-prompts (6<sup class="ltx_sup" id="S4.SS3.SSS1.p2.6.5"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p2.6.5.1">th</span></sup> column), it is possible to differentiate excellently between the target and background, e.g., the ”person” on the motorcycle (1<sup class="ltx_sup" id="S4.SS3.SSS1.p2.6.6"><span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p2.6.6.1">st</span></sup> row). The segmentation results in the last column show that PMG is committed to mining the part-level local semantics to derive more precise target regions and less false activation.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p3">
<p class="ltx_p" id="S4.SS3.SSS1.p3.1">In addition, we visualize the feature distribution of all unseen classes in the four folds on PASCAL-<math alttext="5^{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p3.1.m1.1"><semantics id="S4.SS3.SSS1.p3.1.m1.1a"><msup id="S4.SS3.SSS1.p3.1.m1.1.1" xref="S4.SS3.SSS1.p3.1.m1.1.1.cmml"><mn id="S4.SS3.SSS1.p3.1.m1.1.1.2" xref="S4.SS3.SSS1.p3.1.m1.1.1.2.cmml">5</mn><mi id="S4.SS3.SSS1.p3.1.m1.1.1.3" xref="S4.SS3.SSS1.p3.1.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p3.1.m1.1b"><apply id="S4.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1">superscript</csymbol><cn id="S4.SS3.SSS1.p3.1.m1.1.1.2.cmml" type="integer" xref="S4.SS3.SSS1.p3.1.m1.1.1.2">5</cn><ci id="S4.SS3.SSS1.p3.1.m1.1.1.3.cmml" xref="S4.SS3.SSS1.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p3.1.m1.1c">5^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p3.1.m1.1d">5 start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> during the testing phase (see Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.F10" title="Figure 10 ‣ 4.2.2 Qualitative Analysis ‣ 4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">10</span></a>). The class prototypes generated by performing MAP on the support features are projected into 2D space using t-SNE. It can be found that our method captures more discriminative unseen-class semantics, with more compact class representations and stronger inter-class variations. The above results explicitly demonstrate that PAT can drive the encoder to focus on different classes in a dynamically class-aware prompting manner, yielding category-representative features.</p>
</div>
<figure class="ltx_figure" id="S4.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="339" id="S4.F11.g1" src="extracted/5858111/Figure/Part_mask.jpg" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span> Visualization results for part masks in PMG (take four local masks as an example). It can be observed that for different tasks, different part masks adaptively focus on different part-level local regions.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="386" id="S4.F12.g1" src="extracted/5858111/Figure/number_part.jpg" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span> Ablation studies of the number of part masks on PASCAL-5<sup class="ltx_sup" id="S4.F12.6.1"><span class="ltx_text ltx_font_italic" id="S4.F12.6.1.1">i</span></sup> dataset in terms of mIoU and FB-IoU. Best mIoU accuracy is achieved when the number of part masks (i.e., <math alttext="N_{p}" class="ltx_Math" display="inline" id="S4.F12.4.m2.1"><semantics id="S4.F12.4.m2.1b"><msub id="S4.F12.4.m2.1.1" xref="S4.F12.4.m2.1.1.cmml"><mi id="S4.F12.4.m2.1.1.2" xref="S4.F12.4.m2.1.1.2.cmml">N</mi><mi id="S4.F12.4.m2.1.1.3" xref="S4.F12.4.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F12.4.m2.1c"><apply id="S4.F12.4.m2.1.1.cmml" xref="S4.F12.4.m2.1.1"><csymbol cd="ambiguous" id="S4.F12.4.m2.1.1.1.cmml" xref="S4.F12.4.m2.1.1">subscript</csymbol><ci id="S4.F12.4.m2.1.1.2.cmml" xref="S4.F12.4.m2.1.1.2">𝑁</ci><ci id="S4.F12.4.m2.1.1.3.cmml" xref="S4.F12.4.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F12.4.m2.1d">N_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.F12.4.m2.1e">italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>) is set to 8.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VII: </span> Ablation studies of the number of Prompt Enhancements. Given the deep features are more category-specific, we perform the Prompt Enhancement in the last <math alttext="L" class="ltx_Math" display="inline" id="S4.T7.2.m1.1"><semantics id="S4.T7.2.m1.1b"><mi id="S4.T7.2.m1.1.1" xref="S4.T7.2.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T7.2.m1.1c"><ci id="S4.T7.2.m1.1.1.cmml" xref="S4.T7.2.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.2.m1.1d">L</annotation><annotation encoding="application/x-llamapun" id="S4.T7.2.m1.1e">italic_L</annotation></semantics></math> blocks of the feature encoder.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T7.3" style="width:316.5pt;height:76.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(47.1pt,-11.5pt) scale(1.42407462121815,1.42407462121815) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T7.3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T7.3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T7.3.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Layers</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.3.1.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.3.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.3.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.3.1.1.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T7.3.1.1.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">7</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T7.3.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T7.3.1.2.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">mIoU</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.3.1.2.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.3.1.2.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.3.1.2.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.3.1.2.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.62</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.3.1.2.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.79</td>
</tr>
<tr class="ltx_tr" id="S4.T7.3.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T7.3.1.3.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.3.1.3.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.19</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.3.1.3.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.42</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.3.1.3.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.59</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.3.1.3.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.67</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.3.1.3.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.71</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VIII: </span> Ablation studies of various encoder backbones on PASCAL-5<sup class="ltx_sup" id="S4.T8.4.1"><span class="ltx_text ltx_font_italic" id="S4.T8.4.1.1">i</span></sup>. </figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T8.5" style="width:411.9pt;height:153.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(37.0pt,-13.8pt) scale(1.21894909502216,1.21894909502216) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T8.5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T8.5.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T8.5.1.1.1.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T8.5.1.1.1.1.1">#</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T8.5.1.1.1.2" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T8.5.1.1.1.2.1">Backbone</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T8.5.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">1-shot</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T8.5.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">5-shot</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T8.5.1.1.1.5" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T8.5.1.1.1.5.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T8.5.1.1.1.5.1.1">
<span class="ltx_tr" id="S4.T8.5.1.1.1.5.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T8.5.1.1.1.5.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Inference Speed</span></span>
<span class="ltx_tr" id="S4.T8.5.1.1.1.5.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T8.5.1.1.1.5.1.1.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(FPS)</span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="S4.T8.5.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.5.1.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">mIoU</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.5.1.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.5.1.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">mIoU</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.5.1.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
</tr>
<tr class="ltx_tr" id="S4.T8.5.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.5.1.3.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(a)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.5.1.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">ViT-S/16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.5.1.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.41</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.5.1.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.5.1.3.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.99</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.5.1.3.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.5.1.3.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T8.5.1.3.3.7.1">21.58</span></td>
</tr>
<tr class="ltx_tr" id="S4.T8.5.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.5.1.4.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(b)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.5.1.4.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">ViT-B/16</td>
<td class="ltx_td ltx_align_center" id="S4.T8.5.1.4.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.96</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.5.1.4.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">78.81</td>
<td class="ltx_td ltx_align_center" id="S4.T8.5.1.4.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.88</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.5.1.4.4.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">83.55</td>
<td class="ltx_td ltx_align_center" id="S4.T8.5.1.4.4.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">16.56</td>
</tr>
<tr class="ltx_tr" id="S4.T8.5.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.5.1.5.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(c)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.5.1.5.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">DeiT-T/16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.5.1.5.5.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.78</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.5.1.5.5.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.5.1.5.5.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.76</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T8.5.1.5.5.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">80.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T8.5.1.5.5.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T8.5.1.5.5.7.1">20.19</span></td>
</tr>
<tr class="ltx_tr" id="S4.T8.5.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.5.1.6.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(d)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.5.1.6.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">DeiT-S/16</td>
<td class="ltx_td ltx_align_center" id="S4.T8.5.1.6.6.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T8.5.1.6.6.3.1">68.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.5.1.6.6.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T8.5.1.6.6.4.1">79.85</span></td>
<td class="ltx_td ltx_align_center" id="S4.T8.5.1.6.6.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T8.5.1.6.6.5.1">73.94</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T8.5.1.6.6.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T8.5.1.6.6.6.1">84.01</span></td>
<td class="ltx_td ltx_align_center" id="S4.T8.5.1.6.6.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">19.12</td>
</tr>
<tr class="ltx_tr" id="S4.T8.5.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T8.5.1.7.7.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">(e)</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T8.5.1.7.7.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">DeiT-B/16</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T8.5.1.7.7.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T8.5.1.7.7.3.1">71.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T8.5.1.7.7.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T8.5.1.7.7.4.1">81.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T8.5.1.7.7.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T8.5.1.7.7.5.1">78.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T8.5.1.7.7.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T8.5.1.7.7.6.1">86.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T8.5.1.7.7.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">14.59</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S4.F13"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="256" id="S4.F13.g1" src="extracted/5858111/Figure/transformer_blocks.jpg" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span> Ablation studies of the number of transformer blocks in different encoder backbones under the 1-shot setting.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Ablation study on Prompt Initialization</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">We first examine the impact of the initialization scheme of FG-prompts on performance. Notably, this experiment is conducted under case (b) in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T4" title="TABLE IV ‣ 4.2.2 Qualitative Analysis ‣ 4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">IV</span></a> to highlight the effect of prompt initialization. From Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T5" title="TABLE V ‣ 4.2.2 Qualitative Analysis ‣ 4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">V</span></a>, the following phenomena can be observed: (1) Tuning the encoder employing randomly initialized prompts yields no performance gains without SPT and PMG consistently enhancing their class-awareness. (2) Introducing additional category semantics as initial prompts can adjust the encoder to initially localize the target, boosting higher segmentation accuracy. (3) Linguistic information is more category-representative than the support average token. (4) Employing the linguistic information extracted by CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib73" title="">73</a>]</cite> as initial prompts has the most superior segmentation results.</p>
</div>
<figure class="ltx_table" id="S4.T9">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE IX: </span>Performance comparison of several FSS methods employing the transformer encoders on PASCAL-5<sup class="ltx_sup" id="S4.T9.13.1"><span class="ltx_text ltx_font_italic" id="S4.T9.13.1.1">i</span></sup> under the 1-shot setting. ”<math alttext="\dagger" class="ltx_Math" display="inline" id="S4.T9.5.m2.1"><semantics id="S4.T9.5.m2.1b"><mo id="S4.T9.5.m2.1.1" xref="S4.T9.5.m2.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="S4.T9.5.m2.1c"><ci id="S4.T9.5.m2.1.1.cmml" xref="S4.T9.5.m2.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T9.5.m2.1d">\dagger</annotation><annotation encoding="application/x-llamapun" id="S4.T9.5.m2.1e">†</annotation></semantics></math>” denote the results with the transformer encoders are from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib31" title="">31</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib66" title="">66</a>]</cite>. PAT<sup class="ltx_sup" id="S4.T9.14.2">⋆</sup> indicates no additional linguistic information generated by CLIP is introduced for prompt initialization while PAT does the opposite.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T9.10" style="width:411.9pt;height:173pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(13.1pt,-5.5pt) scale(1.06803988573128,1.06803988573128) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T9.10.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T9.10.4.5.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T9.10.4.5.1.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T9.10.4.5.1.1.1">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T9.10.4.5.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">CNN Encoder</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T9.10.4.5.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Transformer Encoder</td>
</tr>
<tr class="ltx_tr" id="S4.T9.10.4.6.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T9.10.4.6.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">ResNet-50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T9.10.4.6.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">ResNet-101</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T9.10.4.6.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">ViT-B/16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T9.10.4.6.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">DeiT-B/16</td>
</tr>
<tr class="ltx_tr" id="S4.T9.10.4.7.3">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T9.10.4.7.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PMNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib77" title="">77</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T9.10.4.7.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.40</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T9.10.4.7.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T9.10.4.7.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.83</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T9.10.4.7.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.72</td>
</tr>
<tr class="ltx_tr" id="S4.T9.10.4.8.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T9.10.4.8.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">IPMT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T9.10.4.8.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.83</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T9.10.4.8.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.08</td>
<td class="ltx_td ltx_align_center" id="S4.T9.10.4.8.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.35</td>
<td class="ltx_td ltx_align_center" id="S4.T9.10.4.8.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.10</td>
</tr>
<tr class="ltx_tr" id="S4.T9.7.1.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T9.7.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PFENet<sup class="ltx_sup" id="S4.T9.7.1.1.1.1">†</sup> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib28" title="">28</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T9.7.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T9.7.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.10</td>
<td class="ltx_td ltx_align_center" id="S4.T9.7.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.70</td>
<td class="ltx_td ltx_align_center" id="S4.T9.7.1.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.70</td>
</tr>
<tr class="ltx_tr" id="S4.T9.8.2.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T9.8.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">CyCTR<sup class="ltx_sup" id="S4.T9.8.2.2.1.1">†</sup> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib37" title="">37</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T9.8.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T9.8.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.30</td>
<td class="ltx_td ltx_align_center" id="S4.T9.8.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.10</td>
<td class="ltx_td ltx_align_center" id="S4.T9.8.2.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.00</td>
</tr>
<tr class="ltx_tr" id="S4.T9.9.3.3">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T9.9.3.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">DCPNet<sup class="ltx_sup" id="S4.T9.9.3.3.1.1">†</sup> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib31" title="">31</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T9.9.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T9.9.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.30</td>
<td class="ltx_td ltx_align_center" id="S4.T9.9.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.60</td>
<td class="ltx_td ltx_align_center" id="S4.T9.9.3.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T9.10.4.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T9.10.4.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PAT<sup class="ltx_sup" id="S4.T9.10.4.4.1.1">⋆</sup> (Ours)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T9.10.4.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T9.10.4.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T9.10.4.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T9.10.4.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.25</td>
</tr>
<tr class="ltx_tr" id="S4.T9.10.4.9.5">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T9.10.4.9.5.1" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T9.10.4.9.5.1.1">PAT (Ours)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T9.10.4.9.5.2" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T9.10.4.9.5.3" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T9.10.4.9.5.4" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T9.10.4.9.5.4.1">66.96</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T9.10.4.9.5.5" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T9.10.4.9.5.5.1">71.66</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T10">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE X: </span>Ablation studies of PAT combined with existing decoder-based FSS methods on PASCAL-5<sup class="ltx_sup" id="S4.T10.13.1"><span class="ltx_text ltx_font_italic" id="S4.T10.13.1.1">i</span></sup>. “PAT<sup class="ltx_sup" id="S4.T10.14.2">†</sup>” denotes the dynamic class-aware encoder of the proposed PAT. “<math alttext="\Delta" class="ltx_Math" display="inline" id="S4.T10.6.m3.1"><semantics id="S4.T10.6.m3.1b"><mi id="S4.T10.6.m3.1.1" mathvariant="normal" xref="S4.T10.6.m3.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T10.6.m3.1c"><ci id="S4.T10.6.m3.1.1.cmml" xref="S4.T10.6.m3.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T10.6.m3.1d">\Delta</annotation><annotation encoding="application/x-llamapun" id="S4.T10.6.m3.1e">roman_Δ</annotation></semantics></math>” denotes the mIoU gains of utilizing PAT’s class-aware encoder as the feature encoder of the previous FSS methods under the 5-shot setting.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T10.10" style="width:411.9pt;height:189pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(29.5pt,-13.5pt) scale(1.16697141258508,1.16697141258508) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T10.10.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T10.7.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T10.7.1.1.2" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T10.7.1.1.2.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T10.7.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">1-shot</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T10.7.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">5-shot</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T10.7.1.1.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T10.7.1.1.1.1"><math alttext="\Delta" class="ltx_Math" display="inline" id="S4.T10.7.1.1.1.1.m1.1"><semantics id="S4.T10.7.1.1.1.1.m1.1a"><mi id="S4.T10.7.1.1.1.1.m1.1.1" mathvariant="normal" xref="S4.T10.7.1.1.1.1.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T10.7.1.1.1.1.m1.1b"><ci id="S4.T10.7.1.1.1.1.m1.1.1.cmml" xref="S4.T10.7.1.1.1.1.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T10.7.1.1.1.1.m1.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="S4.T10.7.1.1.1.1.m1.1d">roman_Δ</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T10.10.4.5.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.10.4.5.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">mIoU</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T10.10.4.5.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.10.4.5.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">mIoU</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T10.10.4.5.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
</tr>
<tr class="ltx_tr" id="S4.T10.10.4.6.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T10.10.4.6.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PFENet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib28" title="">28</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.10.4.6.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.73</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T10.10.4.6.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.10.4.6.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.88</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T10.10.4.6.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.10.4.6.2.6" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T10.10.4.6.2.6.1">+8.46</span></td>
</tr>
<tr class="ltx_tr" id="S4.T10.8.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T10.8.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PFENet w/ PAT<sup class="ltx_sup" id="S4.T10.8.2.2.1.1">†</sup>
</td>
<td class="ltx_td ltx_align_center" id="S4.T10.8.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.11</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T10.8.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">78.62</td>
<td class="ltx_td ltx_align_center" id="S4.T10.8.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.34</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T10.8.2.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.55</td>
</tr>
<tr class="ltx_tr" id="S4.T10.10.4.7.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T10.10.4.7.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">IPMT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.10.4.7.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.83</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T10.10.4.7.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.10.4.7.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.20</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T10.10.4.7.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.40</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.10.4.7.3.6" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T10.10.4.7.3.6.1">+6.03</span></td>
</tr>
<tr class="ltx_tr" id="S4.T10.9.3.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T10.9.3.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">IPMT w/ PAT<sup class="ltx_sup" id="S4.T10.9.3.3.1.1">†</sup>
</td>
<td class="ltx_td ltx_align_center" id="S4.T10.9.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T10.9.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">78.95</td>
<td class="ltx_td ltx_align_center" id="S4.T10.9.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">74.23</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T10.9.3.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">83.37</td>
</tr>
<tr class="ltx_tr" id="S4.T10.10.4.8.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T10.10.4.8.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">SSPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib42" title="">42</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.10.4.8.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.98</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T10.10.4.8.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.10.4.8.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">72.48</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T10.10.4.8.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T10.10.4.8.4.6" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T10.10.4.8.4.6.1">+6.88</span></td>
</tr>
<tr class="ltx_tr" id="S4.T10.10.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T10.10.4.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">SSPNet w/ PAT<sup class="ltx_sup" id="S4.T10.10.4.4.1.1">†</sup>
</td>
<td class="ltx_td ltx_align_center" id="S4.T10.10.4.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.19</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T10.10.4.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.81</td>
<td class="ltx_td ltx_align_center" id="S4.T10.10.4.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">79.36</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T10.10.4.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">87.70</td>
</tr>
<tr class="ltx_tr" id="S4.T10.10.4.9.5">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T10.10.4.9.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PAT</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T10.10.4.9.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">71.66</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T10.10.4.9.5.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">81.59</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T10.10.4.9.5.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">78.01</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T10.10.4.9.5.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">86.43</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T10.10.4.9.5.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3 </span>Ablation study on Prompt Enhancement</h4>
<div class="ltx_para" id="S4.SS3.SSS3.p1">
<p class="ltx_p" id="S4.SS3.SSS3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p1.1.1">1) Part Mask Generator:</span> As stated in Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.SS4.SSS1" title="3.4.1 Part Mask Generator (PMG) ‣ 3.4 Prompt Enhancement ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">3.4.1</span></a>, the Part Mask Generator (PMG) is designed to adaptively generate multiple part-level local masks to work with SPT to assign different part-level semantics for prompts. First, we qualitatively evaluate the visualization of part masks (see Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.F11" title="Figure 11 ‣ 4.3.1 Component Analysis ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">11</span></a>). As can be noticed, the target object can be clearly divided into different complementary part-level local regions, e.g., the ”bird” is divided into head, breast, back, and tail in the first row, which further demonstrates that the proposed PMG can adaptively generate different part-level masks.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS3.p2">
<p class="ltx_p" id="S4.SS3.SSS3.p2.1">Then, we examine the effect of various numbers of part masks on performance. As shown in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.F12" title="Figure 12 ‣ 4.3.1 Component Analysis ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">12</span></a>, mIoU accuracy increases as the number of part masks (i.e., <math alttext="N_{p}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p2.1.m1.1"><semantics id="S4.SS3.SSS3.p2.1.m1.1a"><msub id="S4.SS3.SSS3.p2.1.m1.1.1" xref="S4.SS3.SSS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.SSS3.p2.1.m1.1.1.2" xref="S4.SS3.SSS3.p2.1.m1.1.1.2.cmml">N</mi><mi id="S4.SS3.SSS3.p2.1.m1.1.1.3" xref="S4.SS3.SSS3.p2.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p2.1.m1.1b"><apply id="S4.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.SSS3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.SSS3.p2.1.m1.1.1.2">𝑁</ci><ci id="S4.SS3.SSS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.SSS3.p2.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p2.1.m1.1c">N_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p2.1.m1.1d">italic_N start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>) rises from 1 to 8, because more part masks can mine more different part-level local semantics to refine the target description in the prompts. When continuing to increase, the mIoU accuracy decreases instead, especially with an increase to 32, where the mIoU falls below 71%. This is because excessive part masks may result in the target object not being clearly divided into different interpretable local regions, thus creating redundancy and even noise from semantic fine-grained mismatches. A similar phenomenon is observed for FB-IoU.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS3.p3">
<p class="ltx_p" id="S4.SS3.SSS3.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p3.1.1">2) Semantic Prompt Transfer:</span></p>
</div>
<div class="ltx_para" id="S4.SS3.SSS3.p4">
<p class="ltx_p" id="S4.SS3.SSS3.p4.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T6" title="TABLE VI ‣ 4.2.2 Qualitative Analysis ‣ 4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">VI</span></a> demonstrates the effect of different variants in SPT on performance. The following phenomena can be derived: (1) Merely transferring either the support target semantics or the query target semantics to the prompts produces varying degrees of performance degradation, which is a good indication that for segmenting the query image, both accurate target semantics in support images and target semantics in query image itself are essential. (2) Gaussian suppression <math alttext="\mathcal{F}_{G}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p4.1.m1.1"><semantics id="S4.SS3.SSS3.p4.1.m1.1a"><msub id="S4.SS3.SSS3.p4.1.m1.1.1" xref="S4.SS3.SSS3.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS3.p4.1.m1.1.1.2" xref="S4.SS3.SSS3.p4.1.m1.1.1.2.cmml">ℱ</mi><mi id="S4.SS3.SSS3.p4.1.m1.1.1.3" xref="S4.SS3.SSS3.p4.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p4.1.m1.1b"><apply id="S4.SS3.SSS3.p4.1.m1.1.1.cmml" xref="S4.SS3.SSS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS3.p4.1.m1.1.1.1.cmml" xref="S4.SS3.SSS3.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS3.p4.1.m1.1.1.2.cmml" xref="S4.SS3.SSS3.p4.1.m1.1.1.2">ℱ</ci><ci id="S4.SS3.SSS3.p4.1.m1.1.1.3.cmml" xref="S4.SS3.SSS3.p4.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p4.1.m1.1c">\mathcal{F}_{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p4.1.m1.1d">caligraphic_F start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math> in SPT allows for better aggregation of global semantics of specific regions to prompts by adjusting the attention distribution, thus yielding higher segmentation accuracy.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS3.p5">
<p class="ltx_p" id="S4.SS3.SSS3.p5.3"><span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p5.3.1">3) The number of Prompt Enhancements:</span>
Then, we analyze the effect of the number of Prompt Enhancements (i.e., the number of alternations for prompting and transferring) on performance, as illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T7" title="TABLE VII ‣ 4.3.1 Component Analysis ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">VII</span></a>. During the experiments, considering that deep features are more category-specific, we perform the Prompt Enhancement in the last <math alttext="L" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p5.1.m1.1"><semantics id="S4.SS3.SSS3.p5.1.m1.1a"><mi id="S4.SS3.SSS3.p5.1.m1.1.1" xref="S4.SS3.SSS3.p5.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p5.1.m1.1b"><ci id="S4.SS3.SSS3.p5.1.m1.1.1.cmml" xref="S4.SS3.SSS3.p5.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p5.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p5.1.m1.1d">italic_L</annotation></semantics></math> blocks of the transformer encoder to assign richer category semantics to prompts. Overall, higher segmentation accuracy can be achieved by performing more semantic migrations, especially reaching a 71.79% mIoU accuracy when performing 7 times (i.e., <math alttext="L=7" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p5.2.m2.1"><semantics id="S4.SS3.SSS3.p5.2.m2.1a"><mrow id="S4.SS3.SSS3.p5.2.m2.1.1" xref="S4.SS3.SSS3.p5.2.m2.1.1.cmml"><mi id="S4.SS3.SSS3.p5.2.m2.1.1.2" xref="S4.SS3.SSS3.p5.2.m2.1.1.2.cmml">L</mi><mo id="S4.SS3.SSS3.p5.2.m2.1.1.1" xref="S4.SS3.SSS3.p5.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS3.p5.2.m2.1.1.3" xref="S4.SS3.SSS3.p5.2.m2.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p5.2.m2.1b"><apply id="S4.SS3.SSS3.p5.2.m2.1.1.cmml" xref="S4.SS3.SSS3.p5.2.m2.1.1"><eq id="S4.SS3.SSS3.p5.2.m2.1.1.1.cmml" xref="S4.SS3.SSS3.p5.2.m2.1.1.1"></eq><ci id="S4.SS3.SSS3.p5.2.m2.1.1.2.cmml" xref="S4.SS3.SSS3.p5.2.m2.1.1.2">𝐿</ci><cn id="S4.SS3.SSS3.p5.2.m2.1.1.3.cmml" type="integer" xref="S4.SS3.SSS3.p5.2.m2.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p5.2.m2.1c">L=7</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p5.2.m2.1d">italic_L = 7</annotation></semantics></math>). Considering the balance between efficiency and performance, we believe that 3 times (i.e., <math alttext="L=3" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p5.3.m3.1"><semantics id="S4.SS3.SSS3.p5.3.m3.1a"><mrow id="S4.SS3.SSS3.p5.3.m3.1.1" xref="S4.SS3.SSS3.p5.3.m3.1.1.cmml"><mi id="S4.SS3.SSS3.p5.3.m3.1.1.2" xref="S4.SS3.SSS3.p5.3.m3.1.1.2.cmml">L</mi><mo id="S4.SS3.SSS3.p5.3.m3.1.1.1" xref="S4.SS3.SSS3.p5.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS3.p5.3.m3.1.1.3" xref="S4.SS3.SSS3.p5.3.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p5.3.m3.1b"><apply id="S4.SS3.SSS3.p5.3.m3.1.1.cmml" xref="S4.SS3.SSS3.p5.3.m3.1.1"><eq id="S4.SS3.SSS3.p5.3.m3.1.1.1.cmml" xref="S4.SS3.SSS3.p5.3.m3.1.1.1"></eq><ci id="S4.SS3.SSS3.p5.3.m3.1.1.2.cmml" xref="S4.SS3.SSS3.p5.3.m3.1.1.2">𝐿</ci><cn id="S4.SS3.SSS3.p5.3.m3.1.1.3.cmml" type="integer" xref="S4.SS3.SSS3.p5.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p5.3.m3.1c">L=3</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p5.3.m3.1d">italic_L = 3</annotation></semantics></math>) would be the appropriate choice.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.4 </span>Ablation study on Backbone Setup</h4>
<div class="ltx_para" id="S4.SS3.SSS4.p1">
<p class="ltx_p" id="S4.SS3.SSS4.p1.1">This section examines the impact of various encoder backbones and the number of blocks on performance. First, according to Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T8" title="TABLE VIII ‣ 4.3.1 Component Analysis ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">VIII</span></a> the following phenomenon can be observed: (1) Using the backbone of DeiT-B/16 has the best segmentation accuracy under all settings, while using the backbone of DeiT-S/16 achieves the second-best accuracy, which is even superior to the larger ViT-B/16. (2) Despite the poor segmentation performance achieved by using the smaller ViT-S/16 (88M) or DeiT-T/16 (23M) compared to other backbones, they have competitive inference speeds. Even so, their performance is comparable to some ResNet101-based (179M) FSS methods, eg., PFENet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib28" title="">28</a>]</cite> (60.05%) and CyCTR<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib37" title="">37</a>]</cite> (63.73%).</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS4.p2">
<p class="ltx_p" id="S4.SS3.SSS4.p2.1">Next, Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.F13" title="Figure 13 ‣ 4.3.1 Component Analysis ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">13</span></a> demonstrates the effect of different numbers of blocks in various encoder backbones. It can be found that more blocks won’t necessarily work better. For example, the two ViT variants work best with 10 blocks while the three DeiT variants work best with 11 blocks. Such a phenomenon is consistent with the fact that CNN-based FSS methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>]</cite> prefer mid-level features over high-level features.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.5 </span>Comparison employing the Consistent Encoder</h4>
<div class="ltx_para" id="S4.SS3.SSS5.p1">
<p class="ltx_p" id="S4.SS3.SSS5.p1.1">To construct a fair comparison, we replace the CNN encoders of the competitive FSS methods PMNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib77" title="">77</a>]</cite> and IPMT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib41" title="">41</a>]</cite> with ViT-B/16 and DeiT-B/16 transformer encoders. In addition, for PAT, instead of introducing additional linguistic information generated by CLIP, we directly utilize the support average tokens as initial prompts. The performance results are illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T9" title="TABLE IX ‣ 4.3.2 Ablation study on Prompt Initialization ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">IX</span></a>. We can observe the following phenomenons: (1) With the consistent feature encoder setup, the proposed PAT achieves the best segmentation performance. For example, with the encoder of ViT-B/16, the PAT (without linguistic information) obtains 66.26% mIoU, outperforming PMNet and IPMT by 3.43% and 3.91%, respectively. (2) Blindly employing the transformer to extract features may not yield the expected performance gains. Similar experimental findings were reported by DCPNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib31" title="">31</a>]</cite>. This indicates that the transformer structure may not be applicable to the universal FSS structure with the frozen encoder and learnable decoders. (3) The performance gain of introducing additional linguistic information (i.e., 0.7% mIoU gain with ViT) similarly demonstrates that cross-modal linguistic information facilitates more robust prompts for generating class-aware features.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS6">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.6 </span>Combination of PAT and other FSS methods</h4>
<div class="ltx_para" id="S4.SS3.SSS6.p1">
<p class="ltx_p" id="S4.SS3.SSS6.p1.1">Since PAT aims to build a dynamic class-aware encoder for FSS, a natural exploration is whether performance can be consistently increased when PAT meets the previous decoder-based FSS methods (i.e., complex decoders). The segmentation results in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T10" title="TABLE X ‣ 4.3.2 Ablation study on Prompt Initialization ‣ 4.3 Ablation Studies ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">X</span></a> reveal the following phenomena: (1) Utilizing more complex decoders may not necessarily outperform the simple similarity computation. Possible reasons include: a) PAT already generates class-aware features focused on target classes, so reprocessing these features with complex decoders may have little effect and could even reduce accuracy. b) Directly utilizing features extracted from the transformer structure (i.e., PAT) for the CNN structure (i.e., PFENet and IPMT) may impact segmentation performance as ViT already constructs global associations through self-attention, making further local smoothing via convolutional layers potentially redundant. (2) Equipped with the proposed dynamic class-aware encoder, these FSS methods yield significant performance gains. Although PFENet and IPMT with the proposed class-aware encoder are not as effective as PAT itself, they perform significantly better compared to their original versions. The above gains indicate that compared to the frozen pre-trained encoder employed in previous FSS, the proposed dynamic class-aware encoder can generate class-aware features for different novel classes flexibly and is well-compatible with decoder-based methods.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span><span class="ltx_text ltx_font_italic" id="S4.SS4.1.1">Extended Experiments</span>
</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">For further exploring the extensibility and flexibility of our PAT, we conduct a series of extension experiments in this section, including Cross-domain Few-shot Segmentation (see Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS4.SSS1" title="4.4.1 Cross-domain Few-shot Segmentation ‣ 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4.4.1</span></a>), Weak-label Few-shot Segmentation (see Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS4.SSS2" title="4.4.2 Weak-label Few-shot Segmentation ‣ 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4.4.2</span></a>), and Zero-shot Segmentation (see Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS4.SSS3" title="4.4.3 Zero-shot Segmentation ‣ 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4.4.3</span></a>).</p>
</div>
<section class="ltx_subsubsection" id="S4.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.1 </span>Cross-domain Few-shot Segmentation</h4>
<div class="ltx_para" id="S4.SS4.SSS1.p1">
<p class="ltx_p" id="S4.SS4.SSS1.p1.2">To explore the generalization of FSS to unseen domains (datasets) in real-world situations, we follow the CWT<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib67" title="">67</a>]</cite> and PATNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib68" title="">68</a>]</cite> setups to evaluate our method in cross-domain scenarios comprehensively. Specifically, the model trained in the meta-training phase is employed directly to the unseen domains for evaluation without any fine-tuning. Notably, the categories that appear in the source domain are removed from the unseen domain. First, we perform a cross-domain evaluation between PASCAL-5<sup class="ltx_sup" id="S4.SS4.SSS1.p1.2.1"><span class="ltx_text ltx_font_italic" id="S4.SS4.SSS1.p1.2.1.1">i</span></sup> and COCO-20<sup class="ltx_sup" id="S4.SS4.SSS1.p1.2.2"><span class="ltx_text ltx_font_italic" id="S4.SS4.SSS1.p1.2.2.1">i</span></sup>. As indicated in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T11" title="TABLE XI ‣ 4.4.1 Cross-domain Few-shot Segmentation ‣ 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">XI</span></a>, our PAT beats other methods by a considerable margin under both cross-domain settings, establishing the new state-of-the-arts. To further explore the segmentation performance under larger domain shifts, we select three more complex datasets for evaluation, FSS-1000<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib86" title="">86</a>]</cite>, Chest X-ray<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib87" title="">87</a>]</cite>, and DeepGlobe<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib88" title="">88</a>]</cite>, which cover 1,000 classes of daily objects, X-ray imagery, and six classes of satellite imagery, respectively. Following PATNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib68" title="">68</a>]</cite>, the proposed method is trained on PASCAL VOC and evaluated on these three datasets, with the mIoU results presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T12" title="TABLE XII ‣ 4.4.1 Cross-domain Few-shot Segmentation ‣ 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">XII</span></a>. Our method reaches top performance in all cases, especially yielding 15.84% (1-shot) and 19.63% (5-shot) mIoU gains on Chest X-ray. Furthermore, we visualize the cross-domain results on these three datasets, as illustrated in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.F14" title="Figure 14 ‣ 4.4.1 Cross-domain Few-shot Segmentation ‣ 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">14</span></a>. The above results strongly demonstrate that the proposed PAT can handle various cross-domain scenarios well and exhibits powerful robustness.</p>
</div>
<figure class="ltx_table" id="S4.T11">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE XI: </span> Extended experiments of Cross-domain Few-shot Segmentation between PASCAL-5<sup class="ltx_sup" id="S4.T11.9.1"><span class="ltx_text ltx_font_italic" id="S4.T11.9.1.1">i</span></sup> and COCO-20<sup class="ltx_sup" id="S4.T11.10.2"><span class="ltx_text ltx_font_italic" id="S4.T11.10.2.1">i</span></sup>. “-” denotes that the results are not recorded. Some comparison results are from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib67" title="">67</a>]</cite>.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T11.6" style="width:411.9pt;height:169.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(9.2pt,-3.8pt) scale(1.04655838702663,1.04655838702663) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T11.6.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T11.6.2.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T11.6.2.2.3" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T11.6.2.2.3.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T11.6.2.2.4" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T11.6.2.2.4.1">Backbone</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T11.5.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">COCO<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T11.5.1.1.1.m1.1"><semantics id="S4.T11.5.1.1.1.m1.1a"><mo id="S4.T11.5.1.1.1.m1.1.1" stretchy="false" xref="S4.T11.5.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T11.5.1.1.1.m1.1b"><ci id="S4.T11.5.1.1.1.m1.1.1.cmml" xref="S4.T11.5.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T11.5.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T11.5.1.1.1.m1.1d">→</annotation></semantics></math>PASCAL</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T11.6.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">PASCAL<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T11.6.2.2.2.m1.1"><semantics id="S4.T11.6.2.2.2.m1.1a"><mo id="S4.T11.6.2.2.2.m1.1.1" stretchy="false" xref="S4.T11.6.2.2.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T11.6.2.2.2.m1.1b"><ci id="S4.T11.6.2.2.2.m1.1.1.cmml" xref="S4.T11.6.2.2.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T11.6.2.2.2.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T11.6.2.2.2.m1.1d">→</annotation></semantics></math>COCO</td>
</tr>
<tr class="ltx_tr" id="S4.T11.6.2.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.3.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">1-shot</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T11.6.2.3.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">5-shot</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.3.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">1-shot</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.3.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">5-shot</td>
</tr>
<tr class="ltx_tr" id="S4.T11.6.2.4.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T11.6.2.4.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">RPMMs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib35" title="">35</a>]</cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T11.6.2.4.2.2" rowspan="4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T11.6.2.4.2.2.1">ResNet-50</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.4.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">49.60</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T11.6.2.4.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.4.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">36.38</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.4.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.95</td>
</tr>
<tr class="ltx_tr" id="S4.T11.6.2.5.3">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T11.6.2.5.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">CWT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib67" title="">67</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T11.6.2.5.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.45</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T11.6.2.5.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.50</td>
<td class="ltx_td ltx_align_center" id="S4.T11.6.2.5.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.15</td>
<td class="ltx_td ltx_align_center" id="S4.T11.6.2.5.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.75</td>
</tr>
<tr class="ltx_tr" id="S4.T11.6.2.6.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T11.6.2.6.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PFENet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib28" title="">28</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T11.6.2.6.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T11.6.2.6.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.40</td>
<td class="ltx_td ltx_align_center" id="S4.T11.6.2.6.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T11.6.2.6.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T11.6.2.7.5">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T11.6.2.7.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">RePRI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib38" title="">38</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T11.6.2.7.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.20</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T11.6.2.7.5.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.70</td>
<td class="ltx_td ltx_align_center" id="S4.T11.6.2.7.5.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S4.T11.6.2.7.5.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T11.6.2.8.6">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T11.6.2.8.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">HSNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib30" title="">30</a>]</cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T11.6.2.8.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T11.6.2.8.6.2.1">ResNet-101</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.8.6.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.10</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T11.6.2.8.6.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">70.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.8.6.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.8.6.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T11.6.2.9.7">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T11.6.2.9.7.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T11.6.2.9.7.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T11.6.2.9.7.2.1" style="background-color:#ECECEC;">ViT-B/16</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.9.7.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T11.6.2.9.7.3.1" style="background-color:#ECECEC;">66.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T11.6.2.9.7.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T11.6.2.9.7.4.1" style="background-color:#ECECEC;">75.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.9.7.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T11.6.2.9.7.5.1" style="background-color:#ECECEC;">40.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T11.6.2.9.7.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T11.6.2.9.7.6.1" style="background-color:#ECECEC;">47.07</span></td>
</tr>
<tr class="ltx_tr" id="S4.T11.6.2.10.8" style="background-color:#ECECEC;">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T11.6.2.10.8.1" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T11.6.2.10.8.1.1" style="background-color:#ECECEC;">Ours</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T11.6.2.10.8.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T11.6.2.10.8.2.1" style="background-color:#ECECEC;">DeiT-B/16</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T11.6.2.10.8.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T11.6.2.10.8.3.1" style="background-color:#ECECEC;">70.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T11.6.2.10.8.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T11.6.2.10.8.4.1" style="background-color:#ECECEC;">78.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T11.6.2.10.8.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T11.6.2.10.8.5.1" style="background-color:#ECECEC;">43.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T11.6.2.10.8.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T11.6.2.10.8.6.1" style="background-color:#ECECEC;">52.31</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S4.F14"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="161" id="S4.F14.g1" src="extracted/5858111/Figure/cross_domain.jpg" width="449"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span> Qualitative visualization results for Cross-domain Few-shot Segmentation under the 1-shot setting, where the model is trained on PASCAL VOC dataset and evaluated on three datasets with larger domain shifts, including FSS-1000, Chest X-ray, and DeepGlobe.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T12">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE XII: </span> Extended experiments of Cross-domain FSS on three datasets with larger domain shifts. Notably, the proposed model is trained on PASCAL VOC and evaluated on these three datasets. Some comparison results are from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib68" title="">68</a>]</cite>.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T12.1" style="width:303.5pt;height:89.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-91.5pt,27.1pt) scale(0.62380308983951,0.62380308983951) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T12.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T12.1.1.1.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T12.1.1.1.1.1" rowspan="2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text" id="S4.T12.1.1.1.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2" id="S4.T12.1.1.1.1.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">FSS-1000 (CV)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2" id="S4.T12.1.1.1.1.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">Chest X-ray (Medical)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="2" id="S4.T12.1.1.1.1.4" style="padding-top:1.25pt;padding-bottom:1.25pt;">DeepGlobe (RS)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T12.1.1.1.1.5" style="padding-top:1.25pt;padding-bottom:1.25pt;">Average</th>
</tr>
<tr class="ltx_tr" id="S4.T12.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T12.1.1.2.2.1" style="padding-top:1.25pt;padding-bottom:1.25pt;">1-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T12.1.1.2.2.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">5-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T12.1.1.2.2.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">1-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T12.1.1.2.2.4" style="padding-top:1.25pt;padding-bottom:1.25pt;">5-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T12.1.1.2.2.5" style="padding-top:1.25pt;padding-bottom:1.25pt;">1-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T12.1.1.2.2.6" style="padding-top:1.25pt;padding-bottom:1.25pt;">5-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T12.1.1.2.2.7" style="padding-top:1.25pt;padding-bottom:1.25pt;">1-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T12.1.1.2.2.8" style="padding-top:1.25pt;padding-bottom:1.25pt;">5-shot</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T12.1.1.3.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T12.1.1.3.1.1" style="padding-top:1.25pt;padding-bottom:1.25pt;">PFENet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib28" title="">28</a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T12.1.1.3.1.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">70.87</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T12.1.1.3.1.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">70.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T12.1.1.3.1.4" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.22</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T12.1.1.3.1.5" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.57</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T12.1.1.3.1.6" style="padding-top:1.25pt;padding-bottom:1.25pt;">16.88</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T12.1.1.3.1.7" style="padding-top:1.25pt;padding-bottom:1.25pt;">18.01</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T12.1.1.3.1.8" style="padding-top:1.25pt;padding-bottom:1.25pt;">38.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T12.1.1.3.1.9" style="padding-top:1.25pt;padding-bottom:1.25pt;">38.70</td>
</tr>
<tr class="ltx_tr" id="S4.T12.1.1.4.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T12.1.1.4.2.1" style="padding-top:1.25pt;padding-bottom:1.25pt;">RPMMs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib35" title="">35</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.4.2.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">65.12</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.4.2.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">67.06</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.4.2.4" style="padding-top:1.25pt;padding-bottom:1.25pt;">30.11</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.4.2.5" style="padding-top:1.25pt;padding-bottom:1.25pt;">30.82</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.4.2.6" style="padding-top:1.25pt;padding-bottom:1.25pt;">12.99</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.4.2.7" style="padding-top:1.25pt;padding-bottom:1.25pt;">13.47</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.4.2.8" style="padding-top:1.25pt;padding-bottom:1.25pt;">36.07</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.4.2.9" style="padding-top:1.25pt;padding-bottom:1.25pt;">37.12</td>
</tr>
<tr class="ltx_tr" id="S4.T12.1.1.5.3">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T12.1.1.5.3.1" style="padding-top:1.25pt;padding-bottom:1.25pt;">RePRI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib38" title="">38</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.5.3.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">70.96</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.5.3.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">74.23</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.5.3.4" style="padding-top:1.25pt;padding-bottom:1.25pt;">65.08</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.5.3.5" style="padding-top:1.25pt;padding-bottom:1.25pt;">65.48</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.5.3.6" style="padding-top:1.25pt;padding-bottom:1.25pt;">25.03</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.5.3.7" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.41</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.5.3.8" style="padding-top:1.25pt;padding-bottom:1.25pt;">53.69</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.5.3.9" style="padding-top:1.25pt;padding-bottom:1.25pt;">55.71</td>
</tr>
<tr class="ltx_tr" id="S4.T12.1.1.6.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T12.1.1.6.4.1" style="padding-top:1.25pt;padding-bottom:1.25pt;">HSNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib30" title="">30</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.6.4.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.53</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.6.4.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">80.99</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.6.4.4" style="padding-top:1.25pt;padding-bottom:1.25pt;">51.88</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.6.4.5" style="padding-top:1.25pt;padding-bottom:1.25pt;">54.36</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.6.4.6" style="padding-top:1.25pt;padding-bottom:1.25pt;">29.65</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.6.4.7" style="padding-top:1.25pt;padding-bottom:1.25pt;">35.08</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.6.4.8" style="padding-top:1.25pt;padding-bottom:1.25pt;">53.02</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.6.4.9" style="padding-top:1.25pt;padding-bottom:1.25pt;">56.81</td>
</tr>
<tr class="ltx_tr" id="S4.T12.1.1.7.5">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T12.1.1.7.5.1" style="padding-top:1.25pt;padding-bottom:1.25pt;">PATNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib68" title="">68</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.7.5.2" style="padding-top:1.25pt;padding-bottom:1.25pt;">78.59</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.7.5.3" style="padding-top:1.25pt;padding-bottom:1.25pt;">81.23</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.7.5.4" style="padding-top:1.25pt;padding-bottom:1.25pt;">66.61</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.7.5.5" style="padding-top:1.25pt;padding-bottom:1.25pt;">70.20</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.7.5.6" style="padding-top:1.25pt;padding-bottom:1.25pt;">37.89</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T12.1.1.7.5.7" style="padding-top:1.25pt;padding-bottom:1.25pt;">42.97</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.7.5.8" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.03</td>
<td class="ltx_td ltx_align_center" id="S4.T12.1.1.7.5.9" style="padding-top:1.25pt;padding-bottom:1.25pt;">64.80</td>
</tr>
<tr class="ltx_tr" id="S4.T12.1.1.8.6" style="background-color:#ECECEC;">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T12.1.1.8.6.1" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_bold" id="S4.T12.1.1.8.6.1.1" style="background-color:#ECECEC;">Ours</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T12.1.1.8.6.2" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_bold" id="S4.T12.1.1.8.6.2.1" style="background-color:#ECECEC;">81.15</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T12.1.1.8.6.3" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_bold" id="S4.T12.1.1.8.6.3.1" style="background-color:#ECECEC;">83.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T12.1.1.8.6.4" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_bold" id="S4.T12.1.1.8.6.4.1" style="background-color:#ECECEC;">82.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T12.1.1.8.6.5" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_bold" id="S4.T12.1.1.8.6.5.1" style="background-color:#ECECEC;">89.83</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T12.1.1.8.6.6" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_bold" id="S4.T12.1.1.8.6.6.1" style="background-color:#ECECEC;">38.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T12.1.1.8.6.7" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_bold" id="S4.T12.1.1.8.6.7.1" style="background-color:#ECECEC;">43.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T12.1.1.8.6.8" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_bold" id="S4.T12.1.1.8.6.8.1" style="background-color:#ECECEC;">67.41</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T12.1.1.8.6.9" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span class="ltx_text ltx_font_bold" id="S4.T12.1.1.8.6.9.1" style="background-color:#ECECEC;">72.11</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S4.T13">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE XIII: </span> Extended Experiments of Weak-label FSS on PASCAL-5<sup class="ltx_sup" id="S4.T13.4.1"><span class="ltx_text ltx_font_italic" id="S4.T13.4.1.1">i</span></sup>. “Dense” denotes the densely labeled mask. “Scribble” and “Bounding box” denote the scribble label and bounding box label, respectively.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T13.5" style="width:411.9pt;height:206.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(62.2pt,-31.1pt) scale(1.43227053481484,1.43227053481484) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T13.5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T13.5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T13.5.1.1.1.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T13.5.1.1.1.1.1">Annotation</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T13.5.1.1.1.2" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T13.5.1.1.1.2.1">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T13.5.1.1.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">1-shot</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T13.5.1.1.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">5-shot</td>
</tr>
<tr class="ltx_tr" id="S4.T13.5.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">mIoU</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T13.5.1.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">mIoU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
</tr>
<tr class="ltx_tr" id="S4.T13.5.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T13.5.1.3.3.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T13.5.1.3.3.1.1">Dense</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T13.5.1.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Baseline</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.30</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T13.5.1.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">77.56</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.3.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">75.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.3.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">84.76</td>
</tr>
<tr class="ltx_tr" id="S4.T13.5.1.4.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T13.5.1.4.4.1" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.4.4.1.1">Ours</span></th>
<td class="ltx_td ltx_align_center" id="S4.T13.5.1.4.4.2" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.4.4.2.1">71.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T13.5.1.4.4.3" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.4.4.3.1">81.59</span></td>
<td class="ltx_td ltx_align_center" id="S4.T13.5.1.4.4.4" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.4.4.4.1">78.01</span></td>
<td class="ltx_td ltx_align_center" id="S4.T13.5.1.4.4.5" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.4.4.5.1">86.43</span></td>
</tr>
<tr class="ltx_tr" id="S4.T13.5.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T13.5.1.5.5.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T13.5.1.5.5.1.1">Scribble</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T13.5.1.5.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Baseline</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.5.5.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.85</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T13.5.1.5.5.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.5.5.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">73.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.5.5.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">83.05</td>
</tr>
<tr class="ltx_tr" id="S4.T13.5.1.6.6">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T13.5.1.6.6.1" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.6.6.1.1">Ours</span></th>
<td class="ltx_td ltx_align_center" id="S4.T13.5.1.6.6.2" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.6.6.2.1">69.08</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T13.5.1.6.6.3" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.6.6.3.1">77.92</span></td>
<td class="ltx_td ltx_align_center" id="S4.T13.5.1.6.6.4" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.6.6.4.1">75.13</span></td>
<td class="ltx_td ltx_align_center" id="S4.T13.5.1.6.6.5" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.6.6.5.1">84.19</span></td>
</tr>
<tr class="ltx_tr" id="S4.T13.5.1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T13.5.1.7.7.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T13.5.1.7.7.1.1">Bounding box</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T13.5.1.7.7.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Baseline</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.7.7.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.96</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T13.5.1.7.7.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">68.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.7.7.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.56</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T13.5.1.7.7.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">76.89</td>
</tr>
<tr class="ltx_tr" id="S4.T13.5.1.8.8">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T13.5.1.8.8.1" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.8.8.1.1">Ours</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T13.5.1.8.8.2" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.8.8.2.1">64.83</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T13.5.1.8.8.3" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.8.8.3.1">73.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T13.5.1.8.8.4" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.8.8.4.1">69.15</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T13.5.1.8.8.5" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T13.5.1.8.8.5.1">79.37</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S4.F15"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="368" id="S4.F15.g1" src="extracted/5858111/Figure/weak.jpg" width="550"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span> Qualitative visualization results for Weak-label Few-shot Segmentation under the 1-shot setting.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T14">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE XIV: </span> Performance comparison with state-of-the-art ZSS methods under the Zero-shot setting on PASCAL-5<sup class="ltx_sup" id="S4.T14.12.1"><span class="ltx_text ltx_font_italic" id="S4.T14.12.1.1">i</span></sup> and COCO-20<sup class="ltx_sup" id="S4.T14.13.2"><span class="ltx_text ltx_font_italic" id="S4.T14.13.2.1">i</span></sup>. ‘<math alttext="\ast" class="ltx_Math" display="inline" id="S4.T14.6.m3.1"><semantics id="S4.T14.6.m3.1b"><mo id="S4.T14.6.m3.1.1" xref="S4.T14.6.m3.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S4.T14.6.m3.1c"><ci id="S4.T14.6.m3.1.1.cmml" xref="S4.T14.6.m3.1.1">∗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T14.6.m3.1d">\ast</annotation><annotation encoding="application/x-llamapun" id="S4.T14.6.m3.1e">∗</annotation></semantics></math>’ denotes the variant of our method under the Zero-shot setting. </figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T14.9" style="width:411.9pt;height:116.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-175.9pt,49.7pt) scale(0.539361038280828,0.539361038280828) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T14.9.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T14.8.2.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T14.8.2.2.3" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T14.8.2.2.3.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T14.8.2.2.4" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T14.8.2.2.4.1">Backbone</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="6" id="S4.T14.7.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">PASCAL-<math alttext="5^{i}" class="ltx_Math" display="inline" id="S4.T14.7.1.1.1.m1.1"><semantics id="S4.T14.7.1.1.1.m1.1a"><msup id="S4.T14.7.1.1.1.m1.1.1" xref="S4.T14.7.1.1.1.m1.1.1.cmml"><mn id="S4.T14.7.1.1.1.m1.1.1.2" xref="S4.T14.7.1.1.1.m1.1.1.2.cmml">5</mn><mi id="S4.T14.7.1.1.1.m1.1.1.3" xref="S4.T14.7.1.1.1.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T14.7.1.1.1.m1.1b"><apply id="S4.T14.7.1.1.1.m1.1.1.cmml" xref="S4.T14.7.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T14.7.1.1.1.m1.1.1.1.cmml" xref="S4.T14.7.1.1.1.m1.1.1">superscript</csymbol><cn id="S4.T14.7.1.1.1.m1.1.1.2.cmml" type="integer" xref="S4.T14.7.1.1.1.m1.1.1.2">5</cn><ci id="S4.T14.7.1.1.1.m1.1.1.3.cmml" xref="S4.T14.7.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T14.7.1.1.1.m1.1c">5^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.T14.7.1.1.1.m1.1d">5 start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="6" id="S4.T14.8.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">COCO-<math alttext="20^{i}" class="ltx_Math" display="inline" id="S4.T14.8.2.2.2.m1.1"><semantics id="S4.T14.8.2.2.2.m1.1a"><msup id="S4.T14.8.2.2.2.m1.1.1" xref="S4.T14.8.2.2.2.m1.1.1.cmml"><mn id="S4.T14.8.2.2.2.m1.1.1.2" xref="S4.T14.8.2.2.2.m1.1.1.2.cmml">20</mn><mi id="S4.T14.8.2.2.2.m1.1.1.3" xref="S4.T14.8.2.2.2.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T14.8.2.2.2.m1.1b"><apply id="S4.T14.8.2.2.2.m1.1.1.cmml" xref="S4.T14.8.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T14.8.2.2.2.m1.1.1.1.cmml" xref="S4.T14.8.2.2.2.m1.1.1">superscript</csymbol><cn id="S4.T14.8.2.2.2.m1.1.1.2.cmml" type="integer" xref="S4.T14.8.2.2.2.m1.1.1.2">20</cn><ci id="S4.T14.8.2.2.2.m1.1.1.3.cmml" xref="S4.T14.8.2.2.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T14.8.2.2.2.m1.1c">20^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.T14.8.2.2.2.m1.1d">20 start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T14.9.3.4.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.4.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.4.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.4.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T14.9.3.4.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.4.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">Mean</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T14.9.3.4.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.4.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.4.1.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.4.1.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T14.9.3.4.1.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">Fold-3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.4.1.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">Mean</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.4.1.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">FB-IoU</td>
</tr>
<tr class="ltx_tr" id="S4.T14.9.3.5.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T14.9.3.5.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">SPNet (CVPR’2019) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib69" title="">69</a>]</cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T14.9.3.5.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">ResNet-101</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.5.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">23.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.5.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">17.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.5.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">14.10</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T14.9.3.5.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">18.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.5.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">18.30</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T14.9.3.5.2.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.5.2.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.5.2.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.5.2.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T14.9.3.5.2.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.5.2.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.5.2.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">-</td>
</tr>
<tr class="ltx_tr" id="S4.T14.9.3.6.3">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.6.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">ZS3Net (NeurIPS’2019) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib70" title="">70</a>]</cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.6.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">ResNet-101</th>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.6.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">40.80</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.6.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.40</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.6.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">39.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.6.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">33.60</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.6.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.28</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.6.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.70</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.6.3.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">18.80</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.6.3.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">20.10</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.6.3.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">24.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.6.3.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">20.50</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.6.3.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">21.05</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.6.3.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.10</td>
</tr>
<tr class="ltx_tr" id="S4.T14.9.3.7.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.7.4.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T14.9.3.7.4.1.1">LSeg (ICLR’2022)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib89" title="">89</a>]</cite></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.7.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">ResNet-101</th>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.7.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.80</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.7.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.80</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.7.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">44.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.7.4.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.50</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.7.4.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.38</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.7.4.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.10</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.7.4.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">22.10</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.7.4.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">25.10</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.7.4.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">24.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.7.4.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">21.60</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.7.4.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">23.43</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.7.4.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.90</td>
</tr>
<tr class="ltx_tr" id="S4.T14.9.3.8.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.8.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">ViT-L/16</th>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.8.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.30</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.8.5.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">63.60</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.8.5.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">43.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.8.5.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">41.00</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.8.5.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">52.25</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.8.5.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.00</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.8.5.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">28.10</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.8.5.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">27.50</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.8.5.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">30.00</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.8.5.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">23.20</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.8.5.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">27.20</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.8.5.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.90</td>
</tr>
<tr class="ltx_tr" id="S4.T14.9.3.9.6">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.9.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">CLIPSeg (CVPR’2022) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib90" title="">90</a>]</cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.9.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">ViT-B/16</th>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.9.6.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">53.90</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.9.6.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.00</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.9.6.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">42.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.9.6.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">48.00</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.9.6.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">51.68</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.9.6.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.20</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.9.6.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.20</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.9.6.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.90</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.9.6.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.9.6.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">31.90</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.9.6.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.98</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.9.6.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.50</td>
</tr>
<tr class="ltx_tr" id="S4.T14.9.3.10.7">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.10.7.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">UniBoost (arXiv’20223) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib91" title="">91</a>]</cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.10.7.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">ViT-L/16</th>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.10.7.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">67.30</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.10.7.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">65.10</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.10.7.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">46.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.10.7.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">47.30</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.10.7.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">56.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.10.7.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.40</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.10.7.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">30.40</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.10.7.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">31.90</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.10.7.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.70</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.10.7.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">33.50</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.10.7.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">32.88</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.10.7.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">61.90</td>
</tr>
<tr class="ltx_tr" id="S4.T14.9.3.11.8">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.11.8.1" rowspan="2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text" id="S4.T14.9.3.11.8.1.1">SAZS (CVPR’2023) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib92" title="">92</a>]</cite></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.11.8.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">DRN</th>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.11.8.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">57.30</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.11.8.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.30</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.11.8.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.11.8.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">45.90</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.11.8.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">55.48</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.11.8.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">66.40</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.11.8.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.20</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.11.8.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">36.50</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.11.8.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.11.8.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.60</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.11.8.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.23</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.11.8.14" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.40</td>
</tr>
<tr class="ltx_tr" id="S4.T14.9.3.12.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T14.9.3.12.9.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">ViT-L/16</th>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.12.9.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">62.70</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.12.9.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">64.30</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.12.9.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">60.60</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.12.9.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">50.20</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.12.9.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">59.45</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.12.9.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">69.00</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.12.9.8" style="padding-top:1.5pt;padding-bottom:1.5pt;">33.80</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.12.9.9" style="padding-top:1.5pt;padding-bottom:1.5pt;">38.10</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.12.9.10" style="padding-top:1.5pt;padding-bottom:1.5pt;">34.40</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T14.9.3.12.9.11" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.00</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.12.9.12" style="padding-top:1.5pt;padding-bottom:1.5pt;">35.33</td>
<td class="ltx_td ltx_align_center" id="S4.T14.9.3.12.9.13" style="padding-top:1.5pt;padding-bottom:1.5pt;">58.20</td>
</tr>
<tr class="ltx_tr" id="S4.T14.9.3.13.10">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T14.9.3.13.10.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T14.9.3.13.10.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.2.1" style="background-color:#ECECEC;">ViT-B/16</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.13.10.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.3.1" style="background-color:#ECECEC;">67.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.13.10.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.4.1" style="background-color:#ECECEC;">69.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.13.10.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.5.1" style="background-color:#ECECEC;">56.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T14.9.3.13.10.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.6.1" style="background-color:#ECECEC;">51.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.13.10.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.7.1" style="background-color:#ECECEC;">61.24</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T14.9.3.13.10.8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.8.1" style="background-color:#ECECEC;">75.14</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.13.10.9" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.9.1" style="background-color:#ECECEC;">28.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.13.10.10" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.10.1" style="background-color:#ECECEC;">36.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.13.10.11" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.11.1" style="background-color:#ECECEC;">32.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T14.9.3.13.10.12" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.12.1" style="background-color:#ECECEC;">33.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.13.10.13" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.13.1" style="background-color:#ECECEC;">32.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T14.9.3.13.10.14" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.13.10.14.1" style="background-color:#ECECEC;">57.77</span></td>
</tr>
<tr class="ltx_tr" id="S4.T14.9.3.3" style="background-color:#ECECEC;">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T14.9.3.3.1" style="background-color:#ECECEC;padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.1.1" style="background-color:#ECECEC;">Ours<sup class="ltx_sup" id="S4.T14.9.3.3.1.1.2"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T14.9.3.3.1.1.2.1">∗</span></sup></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T14.9.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.2.1" style="background-color:#ECECEC;">DeiT-B/16</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T14.9.3.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.3.1" style="background-color:#ECECEC;">70.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T14.9.3.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.4.1" style="background-color:#ECECEC;">70.60</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T14.9.3.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.5.1" style="background-color:#ECECEC;">54.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T14.9.3.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.6.1" style="background-color:#ECECEC;">54.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T14.9.3.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.7.1" style="background-color:#ECECEC;">62.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T14.9.3.3.8" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.8.1" style="background-color:#ECECEC;">74.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T14.9.3.3.9" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.9.1" style="background-color:#ECECEC;">30.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T14.9.3.3.10" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.10.1" style="background-color:#ECECEC;">37.96</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T14.9.3.3.11" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.11.1" style="background-color:#ECECEC;">37.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T14.9.3.3.12" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.12.1" style="background-color:#ECECEC;">34.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T14.9.3.3.13" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.13.1" style="background-color:#ECECEC;">34.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T14.9.3.3.14" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T14.9.3.3.14.1" style="background-color:#ECECEC;">59.14</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S4.F16"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="432" id="S4.F16.g1" src="extracted/5858111/Figure/failure.jpg" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span> Several typical failure cases of our PAT. Note that the areas where the segmentation fails are highlighted with yellow boxes.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.2 </span>Weak-label Few-shot Segmentation</h4>
<div class="ltx_para" id="S4.SS4.SSS2.p1">
<p class="ltx_p" id="S4.SS4.SSS2.p1.1">To alleviate the burden imposed by dense mask labeling in real-world applications, we further explore the effectiveness of FSS with weak-label samples. We employ two cheaper weak-label schemes for evaluation, i.e., scribble and bounding box, which are randomly produced from the original dense labeled masks (see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib26" title="">26</a>]</cite> for more details). As can be seen from Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T13" title="TABLE XIII ‣ 4.4.1 Cross-domain Few-shot Segmentation ‣ 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">XIII</span></a> and Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.F15" title="Figure 15 ‣ 4.4.1 Cross-domain Few-shot Segmentation ‣ 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">15</span></a>, our method significantly beats the baseline in all cases, whatever the type of labeling. More interestingly, our method with scribble annotations achieves a 69.08% mIoU accuracy, which is comparable to the accuracy of the best method HDMNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#bib.bib54" title="">54</a>]</cite> with dense annotations (i.e., 69.35% mIoU). The above results indicate that our PAT is highly tolerant to the annotation quality and exhibits strong robustness both in the case of insufficient annotation information and excessive noise.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.3 </span>Zero-shot Segmentation</h4>
<div class="ltx_para" id="S4.SS4.SSS3.p1">
<p class="ltx_p" id="S4.SS4.SSS3.p1.1">Our PAT is also extended to the more challenging but realistic scenario, i.e. Zero-shot Segmentation (ZSS), which aims to segment unseen categories without any annotated sample. Even though our method is designed for the standard FSS task, it can be readily adapted to the ZSS task. Specifically, we still exploit CLIP to encode category names as initial FG prompts, which utilize SPT to continuously capture the target semantics of the query image. Notably, we remove the background prompts and focus only on the target foreground. For decoding, we utilize several convolutional layers to directly predict the segmentation result instead of the original Matching Head.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS3.p2">
<p class="ltx_p" id="S4.SS4.SSS3.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.T14" title="TABLE XIV ‣ 4.4.1 Cross-domain Few-shot Segmentation ‣ 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">XIV</span></a> demonstrates the comparison of our method with other ZSS methods. As can be noticed, our variant enables competitive segmentation accuracy compared to other methods designed specifically for ZSS. In particular, our variant with the backbone of DeiT-B/16 outperforms the best method by 2.87% mIoU and 4.96% FB-IoU on PASCAL-5<sup class="ltx_sup" id="S4.SS4.SSS3.p2.1.1"><span class="ltx_text ltx_font_italic" id="S4.SS4.SSS3.p2.1.1.1">i</span></sup>, setting a new state-of-the-art. Notably, our variant even outperforms several methods under the 5-shot setting, such as PFENet’s 61.88% mIoU in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S3.T1" title="TABLE I ‣ 3.6 Matching ‣ 3 Methodology ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">I</span></a>. The above satisfactory results strongly prove that the proposed prompt-driven method can effectively focus on specific objects, exhibiting good robustness and extensibility.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span><span class="ltx_text ltx_font_italic" id="S4.SS5.1.1">Failure case analysis</span>
</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">Sec.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS2" title="4.2 Comparison with the State of-the-Arts ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4.2</span></a>-<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.SS4" title="4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">4.4</span></a> have shown that the proposed PAT accomplishes efficient segmentation. Yet, there are still several failure cases that require further attention. From Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10389v1#S4.F16" title="Figure 16 ‣ 4.4.1 Cross-domain Few-shot Segmentation ‣ 4.4 Extended Experiments ‣ 4 Experiments ‣ Prompt-and-Transfer: Dynamic Class-aware Enhancement for Few-shot Segmentation"><span class="ltx_text ltx_ref_tag">16</span></a>(a)-(b), false segmentation may occur in cases where the target and background overlap or have particularly similar textures and colors, e.g., the ”person” and the ”bus”, the tail of the ”cat” and the sweater. In addition, when significant appearance differences exist between target pixels, e.g., the tongue and body of the ”dog” have significantly different color textures, the model may fail to focus on all target pixels effectively. We offer several thoughts that perhaps help to address these shortcomings: (1) Introducing more detailed text descriptions rather than category names to help segment specific categories. (2) Utilizing diffusion models to generate multiple support images to provide richer category semantics instead of one/few-shots.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Conclusion</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, discarding the previous FSS practice of freezing the encoder for generalization to unseen classes, we mimic the visual perception pattern of human beings and introduce a novel dynamic class-aware prompting paradigm (PAT) to tune the encoder for focusing on specific objects in different FSS tasks. Our method sets new state-of-the-art (SOTA) on three popular FSS benchmarks. Surprisingly, when extended to more realistic scenarios including cross-domain, weak-label and even zero-shot, it yields equally satisfactory results. We hope that our work could offer fresh perspectives and inspire future research to focus on designing encoders for few-shot scenarios.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This work was supported by the National Natural Science Foundation of China (NSFC) under Grant 62301538.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Identity mappings in deep residual networks,” in <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Proc. Eur. Conf. Comput. Vis.</span>, pp. 630–645, Springer, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image recognition,” in <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 770–778, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
R. Girshick, “Fast r-cnn,” in <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Proc. IEEE Int. Conf. Comput. Vis.</span>, pp. 1440–1448, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
J. Redmon, S. Divvala, R. Girshick, and A. Farhadi, “You only look once: Unified, real-time object detection,” in <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 779–788, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
T.-Y. Lin, P. Dollár, R. Girshick, K. He, B. Hariharan, and S. Belongie, “Feature pyramid networks for object detection,” in <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 2117–2125, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. Long, E. Shelhamer, and T. Darrell, “Fully convolutional networks for semantic segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 3431–3440, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
O. Ronneberger, P. Fischer, and T. Brox, “U-net: Convolutional networks for biomedical image segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">Proc. Int. Conf. Med. Image Comput. Comput.-Assist. Interv.</span>, pp. 234–241, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
F. Yao, W. Lu, H. Yang, L. Xu, C. Liu, L. Hu, H. Yu, N. Liu, C. Deng, D. Tang, C. Chen, J. Yu, X. Sun, and K. Fu, “Ringmo-sense: Remote sensing foundation model for spatiotemporal prediction via spatiotemporal evolution disentangling,” <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">IEEE Transactions on Geoscience and Remote Sensing</span>, vol. 61, pp. 1–21, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
L. Xu, W. Lu, H. Yu, F. Yao, X. Sun, and K. Fu, “Sftformer: A spatial-frequency-temporal correlation-decoupling transformer for radar echo extrapolation,” <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">IEEE Transactions on Geoscience and Remote Sensing</span>, vol. 62, pp. 1–15, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Y. Mao, K. Chen, W. Diao, X. Sun, X. Lu, K. Fu, and M. Weinmann, “Beyond single receptive field: A receptive field fusion-and-stratification network for airborne laser scanning point cloud classification,” <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">ISPRS Journal of Photogrammetry and Remote Sensing</span>, vol. 188, pp. 45–61, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Y. Mao, K. Chen, L. Zhao, W. Chen, D. Tang, W. Liu, Z. Wang, W. Diao, X. Sun, and K. Fu, “Elevation estimation-driven building 3-d reconstruction from single-view remote sensing imagery,” <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">IEEE Transactions on Geoscience and Remote Sensing</span>, vol. 61, pp. 1–18, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
L. Xu, W. Lu, H. Yu, Y. Mao, H. Bi, C. Liu, X. Sun, and K. Fu, “Taformer: A unified target-aware transformer for video and motion joint prediction in aerial scenes,” <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">IEEE Transactions on Geoscience and Remote Sensing</span>, vol. 62, pp. 1–16, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
M. Reichstein, G. Camps-Valls, B. Stevens, M. Jung, J. Denzler, N. Carvalhais, and F. Prabhat, “Deep learning and process understanding for data-driven earth system science,” <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">Nature</span>, vol. 566, no. 7743, pp. 195–204, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
F. Zhuang, Z. Qi, K. Duan, D. Xi, Y. Zhu, H. Zhu, H. Xiong, and Q. He, “A comprehensive survey on transfer learning,” <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">Proceedings of the IEEE</span>, vol. 109, no. 1, pp. 43–76, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
D. Berthelot, N. Carlini, I. Goodfellow, N. Papernot, A. Oliver, and C. A. Raffel, “Mixmatch: A holistic approach to semi-supervised learning,” <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">Adv. Neural Inform. Process. Syst.</span>, vol. 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
X. Zhai, A. Oliver, A. Kolesnikov, and L. Beyer, “S4l: Self-supervised semi-supervised learning,” in <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">Proc. IEEE Int. Conf. Comput. Vis.</span>, pp. 1476–1485, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
J. E. Van Engelen and H. H. Hoos, “A survey on semi-supervised learning,” <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">Machine learning</span>, vol. 109, no. 2, pp. 373–440, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
C. Finn, P. Abbeel, and S. Levine, “Model-agnostic meta-learning for fast adaptation of deep networks,” in <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">Proc. IEEE Int. Conf. Mach. Learn.</span>, pp. 1126–1135, PMLR, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
O. Vinyals, C. Blundell, T. Lillicrap, D. Wierstra, <span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">et al.</span>, “Matching networks for one shot learning,” <span class="ltx_text ltx_font_italic" id="bib.bib19.2.2">Adv. Neural Inform. Process. Syst.</span>, vol. 29, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
S. Ravi and H. Larochelle, “Optimization as a model for few-shot learning,” in <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">Proc. Int. Conf. Learn. Represent.</span>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Y. Xu, H. Bi, H. Yu, W. Lu, P. Li, X. Li, and X. Sun, “Attention-based contrastive learning for few-shot remote sensing image classification,” <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">IEEE Transactions on Geoscience and Remote Sensing</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
A. Shaban, S. Bansal, Z. Liu, I. Essa, and B. Boots, “One-shot learning for semantic segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:1709.03410</span>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
O. Russakovsky, J. Deng, H. Su, J. Krause, S. Satheesh, S. Ma, Z. Huang, A. Karpathy, A. Khosla, M. Bernstein, <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">et al.</span>, “Imagenet large scale visual recognition challenge,” <span class="ltx_text ltx_font_italic" id="bib.bib23.2.2">Int. J. Comput. Vis.</span>, vol. 115, pp. 211–252, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
X. Zhang, Y. Wei, Y. Yang, and T. S. Huang, “Sg-one: Similarity guidance network for one-shot semantic segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">IEEE Trans. Cybern.</span>, vol. 50, no. 9, pp. 3855–3865, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
K. Nguyen and S. Todorovic, “Feature weighting and boosting for few-shot segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">Proc. IEEE Int. Conf. Comput. Vis.</span>, pp. 622–631, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
K. Wang, J. H. Liew, Y. Zou, D. Zhou, and J. Feng, “Panet: Few-shot image semantic segmentation with prototype alignment,” in <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">Proc. IEEE Int. Conf. Comput. Vis.</span>, pp. 9197–9206, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Y. Liu, X. Zhang, S. Zhang, and X. He, “Part-aware prototype network for few-shot semantic segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">Proc. Eur. Conf. Comput. Vis.</span>, pp. 142–158, Springer, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Z. Tian, H. Zhao, M. Shu, Z. Yang, R. Li, and J. Jia, “Prior guided feature enrichment network for few-shot segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">IEEE Trans. Pattern Anal. Mach. Intell.</span>, vol. 44, no. 2, pp. 1050–1065, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
J. Chen, B.-B. Gao, Z. Lu, J.-H. Xue, C. Wang, and Q. Liao, “Apanet: adaptive prototypes alignment network for few-shot semantic segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:2111.12263</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
J. Min, D. Kang, and M. Cho, “Hypercorrelation squeeze for few-shot segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">Proc. IEEE Int. Conf. Comput. Vis.</span>, pp. 6941–6952, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
C. Lang, G. Cheng, B. Tu, and J. Han, “Few-shot segmentation via divide-and-conquer proxies,” <span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">Int. J. Comput. Vis.</span>, vol. 132, no. 1, pp. 261–283, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Y. Liu, N. Liu, Q. Cao, X. Yao, J. Han, and L. Shao, “Learning non-target knowledge for few-shot semantic segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 11573–11582, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Y. Mao, Z. Guo, L. Xiaonan, Z. Yuan, and H. Guo, “Bidirectional feature globalization for few-shot semantic segmentation of 3d point cloud scenes,” in <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">2022 International Conference on 3D Vision (3DV)</span>, pp. 505–514, IEEE, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Y. Wang, R. Sun, Z. Zhang, and T. Zhang, “Adaptive agent transformer for few-shot segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">Proc. Eur. Conf. Comput. Vis.</span>, pp. 36–52, Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
B. Yang, C. Liu, B. Li, J. Jiao, and Q. Ye, “Prototype mixture models for few-shot semantic segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">Proc. Eur. Conf. Comput. Vis.</span>, pp. 763–778, Springer, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
H. Bi, Y. Feng, Z. Yan, Y. Mao, W. Diao, H. Wang, and X. Sun, “Not just learning from others but relying on yourself: A new perspective on few-shot segmentation in remote sensing,” <span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:2310.12452</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
G. Zhang, G. Kang, Y. Yang, and Y. Wei, “Few-shot segmentation via cycle-consistent transformer,” <span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">Adv. Neural Inform. Process. Syst.</span>, vol. 34, pp. 21984–21996, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
M. Boudiaf, H. Kervadec, Z. I. Masud, P. Piantanida, I. Ben Ayed, and J. Dolz, “Few-shot segmentation without meta-learning: A good transductive inference is all you need?,” in <span class="ltx_text ltx_font_italic" id="bib.bib38.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 13979–13988, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
L. Yang, W. Zhuo, L. Qi, Y. Shi, and Y. Gao, “Mining latent classes for few-shot segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib39.1.1">Proc. IEEE Int. Conf. Comput. Vis.</span>, pp. 8721–8730, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
C. Lang, G. Cheng, B. Tu, and J. Han, “Learning what not to segment: A new perspective on few-shot segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib40.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 8057–8067, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Y. Liu, N. Liu, X. Yao, and J. Han, “Intermediate prototype mining transformer for few-shot semantic segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">Adv. Neural Inform. Process. Syst.</span>, vol. 35, pp. 38020–38031, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Q. Fan, W. Pei, Y.-W. Tai, and C.-K. Tang, “Self-support few-shot semantic segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">Proc. Eur. Conf. Comput. Vis.</span>, pp. 701–719, Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
X. Bao, J. Qin, S. Sun, Y. Zheng, and X. Wang, “Relevant intrinsic feature enhancement network for few-shot semantic segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2312.06474</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
C. Lang, J. Wang, G. Cheng, B. Tu, and J. Han, “Progressive parsing and commonality distillation for few-shot remote sensing segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">IEEE Transactions on Geoscience and Remote Sensing</span>, vol. 61, pp. 1–10, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
N. Kanwisher and E. Wojciulik, “Visual attention: insights from brain imaging,” <span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">Nature reviews neuroscience</span>, vol. 1, no. 2, pp. 91–100, 2000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P. Dhariwal, A. Neelakantan, P. Shyam, G. Sastry, A. Askell, <span class="ltx_text ltx_font_italic" id="bib.bib46.1.1">et al.</span>, “Language models are few-shot learners,” <span class="ltx_text ltx_font_italic" id="bib.bib46.2.2">Adv. Neural Inform. Process. Syst.</span>, vol. 33, pp. 1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
X. L. Li and P. Liang, “Prefix-tuning: Optimizing continuous prompts for generation,” <span class="ltx_text ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2101.00190</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
M. Jia, L. Tang, B.-C. Chen, C. Cardie, S. Belongie, B. Hariharan, and S.-N. Lim, “Visual prompt tuning,” in <span class="ltx_text ltx_font_italic" id="bib.bib48.1.1">Proc. Eur. Conf. Comput. Vis.</span>, pp. 709–727, Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
K. Zhou, J. Yang, C. C. Loy, and Z. Liu, “Learning to prompt for vision-language models,” <span class="ltx_text ltx_font_italic" id="bib.bib49.1.1">Int. J. Comput. Vis.</span>, vol. 130, no. 9, pp. 2337–2348, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
H. Touvron, M. Cord, M. Douze, F. Massa, A. Sablayrolles, and H. Jégou, “Training data-efficient image transformers &amp; distillation through attention,” in <span class="ltx_text ltx_font_italic" id="bib.bib50.1.1">Proc. IEEE Int. Conf. Mach. Learn.</span>, pp. 10347–10357, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai, T. Unterthiner, M. Dehghani, M. Minderer, G. Heigold, S. Gelly, <span class="ltx_text ltx_font_italic" id="bib.bib51.1.1">et al.</span>, “An image is worth 16x16 words: Transformers for image recognition at scale,” <span class="ltx_text ltx_font_italic" id="bib.bib51.2.2">arXiv preprint arXiv:2010.11929</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
G. Cheng, C. Lang, and J. Han, “Holistic prototype activation for few-shot segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib52.1.1">IEEE Trans. Pattern Anal. Mach. Intell.</span>, vol. 45, no. 4, pp. 4650–4666, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Q. Xu, W. Zhao, G. Lin, and C. Long, “Self-calibrated cross attention network for few-shot segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib53.1.1">Proc. IEEE Int. Conf. Comput. Vis.</span>, pp. 655–665, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
B. Peng, Z. Tian, X. Wu, C. Wang, S. Liu, J. Su, and J. Jia, “Hierarchical dense correlation distillation for few-shot segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib54.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 23641–23651, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Z. Li, F. Zhou, F. Chen, and H. Li, “Meta-sgd: Learning to learn quickly for few-shot learning,” <span class="ltx_text ltx_font_italic" id="bib.bib55.1.1">arXiv preprint arXiv:1707.09835</span>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
A. Nichol, J. Achiam, and J. Schulman, “On first-order meta-learning algorithms,” <span class="ltx_text ltx_font_italic" id="bib.bib56.1.1">arXiv preprint arXiv:1803.02999</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
J. Snell, K. Swersky, and R. Zemel, “Prototypical networks for few-shot learning,” <span class="ltx_text ltx_font_italic" id="bib.bib57.1.1">Adv. Neural Inform. Process. Syst.</span>, vol. 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
F. Sung, Y. Yang, L. Zhang, T. Xiang, P. H. Torr, and T. M. Hospedales, “Learning to compare: Relation network for few-shot learning,” in <span class="ltx_text ltx_font_italic" id="bib.bib58.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 1199–1208, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
W. Chen, C. Si, Z. Zhang, L. Wang, Z. Wang, and T. Tan, “Semantic prompt for few-shot image recognition,” in <span class="ltx_text ltx_font_italic" id="bib.bib59.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 23581–23591, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Y. Yang, Q. Chen, Y. Feng, and T. Huang, “Mianet: Aggregating unbiased instance and general information for few-shot semantic segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib60.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 7131–7140, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
C. Lang, G. Cheng, B. Tu, C. Li, and J. Han, “Retain and recover: Delving into information loss for few-shot segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib61.1.1">IEEE Transactions on Image Processing</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Y. Sun, Q. Chen, X. He, J. Wang, H. Feng, J. Han, E. Ding, J. Cheng, Z. Li, and J. Wang, “Singular value fine-tuning: Few-shot segmentation requires few-parameters fine-tuning,” <span class="ltx_text ltx_font_italic" id="bib.bib62.1.1">Adv. Neural Inform. Process. Syst.</span>, vol. 35, pp. 37484–37496, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
T. Gao, A. Fisch, and D. Chen, “Making pre-trained language models better few-shot learners,” <span class="ltx_text ltx_font_italic" id="bib.bib63.1.1">arXiv preprint arXiv:2012.15723</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
P. Liu, W. Yuan, J. Fu, Z. Jiang, H. Hayashi, and G. Neubig, “Pre-train, prompt, and predict: A systematic survey of prompting methods in natural language processing,” <span class="ltx_text ltx_font_italic" id="bib.bib64.1.1">ACM Computing Surveys</span>, vol. 55, no. 9, pp. 1–35, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
M. Tsimpoukelli, J. L. Menick, S. Cabi, S. Eslami, O. Vinyals, and F. Hill, “Multimodal few-shot learning with frozen language models,” <span class="ltx_text ltx_font_italic" id="bib.bib65.1.1">Adv. Neural Inform. Process. Syst.</span>, vol. 34, pp. 200–212, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
J.-W. Zhang, Y. Sun, Y. Yang, and W. Chen, “Feature-proxy transformer for few-shot segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib66.1.1">Adv. Neural Inform. Process. Syst.</span>, vol. 35, pp. 6575–6588, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
Z. Lu, S. He, X. Zhu, L. Zhang, Y.-Z. Song, and T. Xiang, “Simpler is better: Few-shot semantic segmentation with classifier weight transformer,” in <span class="ltx_text ltx_font_italic" id="bib.bib67.1.1">Proc. IEEE Int. Conf. Comput. Vis.</span>, pp. 8741–8750, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
S. Lei, X. Zhang, J. He, F. Chen, B. Du, and C.-T. Lu, “Cross-domain few-shot semantic segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib68.1.1">Proc. Eur. Conf. Comput. Vis.</span>, pp. 73–90, Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
Y. Xian, S. Choudhury, Y. He, B. Schiele, and Z. Akata, “Semantic projection network for zero-and few-label semantic segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib69.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 8256–8265, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
M. Bucher, T.-H. Vu, M. Cord, and P. Pérez, “Zero-shot semantic segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib70.1.1">Adv. Neural Inform. Process. Syst.</span>, vol. 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
D. Hassabis, D. Kumaran, C. Summerfield, and M. Botvinick, “Neuroscience-inspired artificial intelligence,” <span class="ltx_text ltx_font_italic" id="bib.bib71.1.1">Neuron</span>, vol. 95, no. 2, pp. 245–258, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock">
L. Du, X. Ye, X. Tan, E. Johns, B. Chen, E. Ding, X. Xue, and J. Feng, “Ago-net: Association-guided 3d point cloud object detection network,” <span class="ltx_text ltx_font_italic" id="bib.bib72.1.1">IEEE Trans. Pattern Anal. Mach. Intell.</span>, vol. 44, no. 11, pp. 8097–8109, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_tag_bibitem">[73]</span>
<span class="ltx_bibblock">
A. Radford, J. W. Kim, C. Hallacy, A. Ramesh, G. Goh, S. Agarwal, G. Sastry, A. Askell, P. Mishkin, J. Clark, <span class="ltx_text ltx_font_italic" id="bib.bib73.1.1">et al.</span>, “Learning transferable visual models from natural language supervision,” in <span class="ltx_text ltx_font_italic" id="bib.bib73.2.2">Proc. IEEE Int. Conf. Mach. Learn.</span>, pp. 8748–8763, PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_tag_bibitem">[74]</span>
<span class="ltx_bibblock">
B. Cheng, I. Misra, A. G. Schwing, A. Kirillov, and R. Girdhar, “Masked-attention mask transformer for universal image segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib74.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 1290–1299, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_tag_bibitem">[75]</span>
<span class="ltx_bibblock">
K. Fu, X. Chou, B. Han, and X. Sun, “A new method for high precision processing of multi-system earth observation satellite data,” <span class="ltx_text ltx_font_italic" id="bib.bib75.1.1">National Remote Sensing Bulletin</span>, pp. 1511–1522, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_tag_bibitem">[76]</span>
<span class="ltx_bibblock">
D. Kang and M. Cho, “Integrative few-shot learning for classification and segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib76.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 9979–9990, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_tag_bibitem">[77]</span>
<span class="ltx_bibblock">
H. Chen, Y. Dong, Z. Lu, Y. Yu, and J. Han, “Pixel matching network for cross-domain few-shot segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib77.1.1">Proc. IEEE Winter Conf. on Appli. Comput. Vis.</span>, pp. 978–987, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_tag_bibitem">[78]</span>
<span class="ltx_bibblock">
Z. Hu, Y. Sun, and Y. Yang, “Suppressing the heterogeneity: A strong feature extractor for few-shot segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib78.1.1">Proc. Int. Conf. Learn. Represent.</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_tag_bibitem">[79]</span>
<span class="ltx_bibblock">
M. Everingham, L. Van Gool, C. K. Williams, J. Winn, and A. Zisserman, “The pascal visual object classes (voc) challenge,” <span class="ltx_text ltx_font_italic" id="bib.bib79.1.1">Int. J. Comput. Vis.</span>, vol. 88, pp. 303–338, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_tag_bibitem">[80]</span>
<span class="ltx_bibblock">
B. Hariharan, P. Arbeláez, L. Bourdev, S. Maji, and J. Malik, “Semantic contours from inverse detectors,” in <span class="ltx_text ltx_font_italic" id="bib.bib80.1.1">2011 international conference on computer vision</span>, pp. 991–998, IEEE, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_tag_bibitem">[81]</span>
<span class="ltx_bibblock">
T.-Y. Lin, M. Maire, S. Belongie, J. Hays, P. Perona, D. Ramanan, P. Dollár, and C. L. Zitnick, “Microsoft coco: Common objects in context,” in <span class="ltx_text ltx_font_italic" id="bib.bib81.1.1">Proc. Eur. Conf. Comput. Vis.</span>, pp. 740–755, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_tag_bibitem">[82]</span>
<span class="ltx_bibblock">
S. Waqas Zamir, A. Arora, A. Gupta, S. Khan, G. Sun, F. Shahbaz Khan, F. Zhu, L. Shao, G.-S. Xia, and X. Bai, “isaid: A large-scale dataset for instance segmentation in aerial images,” in <span class="ltx_text ltx_font_italic" id="bib.bib82.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit. Workshops</span>, pp. 28–37, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_tag_bibitem">[83]</span>
<span class="ltx_bibblock">
Y. Wang, R. Sun, and T. Zhang, “Rethinking the correlation in few-shot segmentation: A buoys view,” in <span class="ltx_text ltx_font_italic" id="bib.bib83.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 7183–7192, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_tag_bibitem">[84]</span>
<span class="ltx_bibblock">
C. Lang, G. Cheng, B. Tu, and J. Han, “Global rectification and decoupled registration for few-shot segmentation in remote sensing imagery,” <span class="ltx_text ltx_font_italic" id="bib.bib84.1.1">IEEE Trans. Geosci. Remote Sens.</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_tag_bibitem">[85]</span>
<span class="ltx_bibblock">
N. Reimers and I. Gurevych, “Sentence-bert: Sentence embeddings using siamese bert-networks,” <span class="ltx_text ltx_font_italic" id="bib.bib85.1.1">arXiv preprint arXiv:1908.10084</span>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib86">
<span class="ltx_tag ltx_tag_bibitem">[86]</span>
<span class="ltx_bibblock">
X. Li, T. Wei, Y. P. Chen, Y.-W. Tai, and C.-K. Tang, “Fss-1000: A 1000-class dataset for few-shot segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib86.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 2869–2878, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib87">
<span class="ltx_tag ltx_tag_bibitem">[87]</span>
<span class="ltx_bibblock">
S. Jaeger, S. Candemir, S. Antani, Y.-X. J. Wáng, P.-X. Lu, and G. Thoma, “Two public chest x-ray datasets for computer-aided screening of pulmonary diseases,” <span class="ltx_text ltx_font_italic" id="bib.bib87.1.1">Quantitative imaging in medicine and surgery</span>, vol. 4, no. 6, p. 475, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib88">
<span class="ltx_tag ltx_tag_bibitem">[88]</span>
<span class="ltx_bibblock">
I. Demir, K. Koperski, D. Lindenbaum, G. Pang, J. Huang, S. Basu, F. Hughes, D. Tuia, and R. Raskar, “Deepglobe 2018: A challenge to parse the earth through satellite images,” in <span class="ltx_text ltx_font_italic" id="bib.bib88.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit. Workshops</span>, pp. 172–181, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib89">
<span class="ltx_tag ltx_tag_bibitem">[89]</span>
<span class="ltx_bibblock">
B. Li, K. Q. Weinberger, S. Belongie, V. Koltun, and R. Ranftl, “Language-driven semantic segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib89.1.1">arXiv preprint arXiv:2201.03546</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib90">
<span class="ltx_tag ltx_tag_bibitem">[90]</span>
<span class="ltx_bibblock">
T. Lüddecke and A. Ecker, “Image segmentation using text and image prompts,” in <span class="ltx_text ltx_font_italic" id="bib.bib90.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 7086–7096, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib91">
<span class="ltx_tag ltx_tag_bibitem">[91]</span>
<span class="ltx_bibblock">
Y. Sun, Z. Zhong, Q. Fan, C.-K. Tang, and Y.-W. Tai, “Uniboost: Unsupervised unimodal pre-training for boosting zero-shot vision-language tasks,” <span class="ltx_text ltx_font_italic" id="bib.bib91.1.1">arXiv preprint arXiv:2306.04715</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib92">
<span class="ltx_tag ltx_tag_bibitem">[92]</span>
<span class="ltx_bibblock">
X. Liu, B. Tian, Z. Wang, R. Wang, K. Sheng, B. Zhang, H. Zhao, and G. Zhou, “Delving into shape-aware zero-shot semantic segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib92.1.1">Proc. IEEE Int. Conf. Comput. Vis. Pattern Recognit.</span>, pp. 2999–3009, 2023.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep 16 15:16:57 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
