<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1711.08105] Visual Question Answering as a Meta Learning Task</title><meta property="og:description" content="The predominant approach to Visual Question Answering (VQA) demands that the model represents within its weights all of the information required to answer any question about any image. Learning this information from an…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Visual Question Answering as a Meta Learning Task">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Visual Question Answering as a Meta Learning Task">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1711.08105">

<!--Generated on Fri Mar  8 00:06:02 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Visual Question Answering as a Meta Learning Task</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Damien Teney      Anton van den Hengel
<br class="ltx_break">Australian Centre for Visual Technologies
<br class="ltx_break">The University of Adelaide
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{damien.teney,anton.vandenhengel}@adelaide.edu.au</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">The predominant approach to Visual Question Answering (VQA) demands that the model represents within its weights all of the information required to answer any question about any image. Learning this information from any real training set seems unlikely, and representing it in a reasonable number of weights doubly so. We propose instead to approach VQA as a meta learning task, thus separating the question answering method from the information required. At test time, the method is provided with a support set of example questions/answers, over which it reasons to resolve the given question. The support set is not fixed and can be extended without retraining, thereby expanding the capabilities of the model. To exploit this dynamically provided information, we adapt a state-of-the-art VQA model with two techniques from the recent meta learning literature, namely prototypical networks and meta networks. Experiments demonstrate the capability of the system to learn to produce completely novel answers (<em id="id2.id1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="id2.id1.2" class="ltx_text"></span> never seen during training) from examples provided at test time.
In comparison to the existing state of the art, the proposed method produces qualitatively distinct results with higher recall of rare answers, and a better sample efficiency that allows training with little initial data. More importantly, it represents an important step towards vision-and-language methods that can learn and reason on-the-fly.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The task of Visual Question Answering (VQA) demands that an agent correctly answer a previously unseen question about a previously unseen image. The fact that neither the question nor the image is specified until test time means that the agent must embody most of the achievements of Computer Vision and Natural Language Processing, and many of those of Artificial Intelligence.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">VQA is typically framed in a purely supervised learning setting. A large training set of example questions, images, and their correct answers is used to train a method to map a question and image to scores over a predetermined, fixed vocabulary of possible answers using the maximum likelihood <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. This approach has inherent scalability issues, as it attempts to represent all world knowledge within the finite set of parameters of a model such as deep neural network. Consequently, a trained VQA system can only be expected to produce correct answers to questions from a very similar distribution to those in the training set. Extending the model knowledge or expanding its domain coverage is only possible by retraining it from scratch, which is computationally costly, at best. This approach is thus fundamentally incapable of fulfilling the ultimate promise of VQA, which is answering general questions about general images.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1711.08105/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="433" height="369" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>This paper considers Visual Question Answering in a meta learning setting. The model is initially trained on a small set of questions/answers, and is provided with a, possibly large, additional <em id="S1.F1.3.1" class="ltx_emph ltx_font_italic">support set</em> of examples at test time. The model must <em id="S1.F1.4.2" class="ltx_emph ltx_font_italic">learn to learn</em>, or to exploit the additional data on-the-fly, without the need for retraining the model. Notably, performance improves as additional and more relevant examples are included.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">As a solution to these issues we propose a meta-learning approach to the problem.
The meta learning approach implies that the model <em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">learns to learn</em>, <em id="S1.p3.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S1.p3.1.3" class="ltx_text"></span> it learns to use a set of examples provided at test time to answer the given question (Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). Those examples are questions and images, each with their correct answer, such as might form part of the training set in a traditional setting. They are referred to here as the <em id="S1.p3.1.4" class="ltx_emph ltx_font_italic">support set</em>. Importantly, the support set is not fixed. Note also that the support set may be large, and that the majority of its elements may have no relevance to the current question. It is provided to the model at test time, and can be expanded with additional examples to increase the capabilities of the model.
The model we propose ‘learns to learn’ in that it is able to identify and exploit the relevant examples within a potentially large support set dynamically, at test time.
Providing the model with more information thus does not require retraining, and the ability to exploit such a support set greatly improves the practicality and scalability of the system. Indeed, it is ultimately desirable for a practical VQA system to be adaptable to new domains and to continuously improve as more data becomes available. That vision is a long term objective and this work takes only a small step in that direction.
</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our primary technical contribution is to adapt a state-of-the-art VQA model<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> to the meta learning scenario. Our resulting model is a deep neural network that uses sets of dynamic parameters – also known as fast weights – determined at test time depending on the provided support set. The dynamic parameters allow to modify adaptively the computations performed by the network and adapt its behaviour depending on the support set. We perform a detailed study to evaluate the effectiveness of those techniques under various regimes of training and support set sizes. Those experiments are based on the VQA v2 benchmark, for which we propose data splits appropriate to study a meta learning setting.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">A completely new capability demonstrated by the resulting system is to learn to produce completely novel answers (<em id="S1.p5.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S1.p5.1.2" class="ltx_text"></span> answers not seen during training). Those new answers are only demonstrated by instances of the support set provided at test time. In addition to these new capabilities, the system exhibits a qualitatively distinct behaviour to existing VQA systems in its improved handling of rare answers. Since datasets for VQA exhibit a heavy class imbalance, with a small number of answers being much more frequent than most others, models optimized for current benchmarks are prone to fall back on frequent “safe” answers. In contrast, the proposed model is inherently less likely to fall victim to dataset biases, and exhibits a higher recall over rare answers. The proposed model does <em id="S1.p5.1.3" class="ltx_emph ltx_font_italic">not</em> surpass existing methods on the common aggregate accuracy metric, as is to be expected given that it does not overfit to the dataset bias, but it nonetheless exhibits desirable traits overall.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">The contributions of this paper are summarized as follows.

</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We re-frame VQA as a meta learning task, in which the model is provided a test time with a support set of supervised examples (questions and images with their correct answers).</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We describe a neural network architecture and training procedure able to leverage the meta learning scenario. The model is based on a state-of-the-art VQA system and takes inspiration in techniques from the recent meta learning literature, namely prototypical networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and meta networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We provide an experimental evaluation of the proposed model in different regimes of training and support set sizes and across variations in design choices.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Our results demonstrate the unique capability of the model to produce novel answers, <em id="S1.I1.i4.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S1.I1.i4.p1.1.2" class="ltx_text"></span> answers never seen during training, by learning from support instances, an improved recall of rare answers, and a better sample efficiency than existing models.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Visual question answering</h5>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">Visual question answering has gathered significant interest from the computer vision community <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, as it constitutes a practical setting to evaluate deep visual understanding. In addition to visual parsing, VQA requires the comprehension of a text question, and combined reasoning over vision and language, sometimes on the basis of external or common-sense knowledge. See <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> for a recent survey of methods and datasets.</p>
</div>
<div id="S2.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p2.1" class="ltx_p">VQA is always approached in a supervised setting, using large datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> of human-proposed questions with their correct answers to train a machine learning model. The <em id="S2.SS0.SSS0.Px1.p2.1.1" class="ltx_emph ltx_font_italic">VQA-real</em> and <em id="S2.SS0.SSS0.Px1.p2.1.2" class="ltx_emph ltx_font_italic">VQA v2</em> datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> have served as popular benchmarks by which to evaluate and compare methods. Despite the large scale of those datasets, <em id="S2.SS0.SSS0.Px1.p2.1.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.SS0.SSS0.Px1.p2.1.4" class="ltx_text"></span> more than 650,000 questions in <em id="S2.SS0.SSS0.Px1.p2.1.5" class="ltx_emph ltx_font_italic">VQA v2</em>, several limitations have been recognized. These relate to the dataset bias (<em id="S2.SS0.SSS0.Px1.p2.1.6" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S2.SS0.SSS0.Px1.p2.1.7" class="ltx_text"></span> the non-uniform, long-tailed distribution of answers) and the question-conditioned bias (making answers easy to guess given a question without the image). For example, the answer <em id="S2.SS0.SSS0.Px1.p2.1.8" class="ltx_emph ltx_font_italic">Yes</em> is particularly prominent in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> compared to <em id="S2.SS0.SSS0.Px1.p2.1.9" class="ltx_emph ltx_font_italic">no</em>, and questions starting with <em id="S2.SS0.SSS0.Px1.p2.1.10" class="ltx_emph ltx_font_italic">How many</em> can be answered correctly with the answer <em id="S2.SS0.SSS0.Px1.p2.1.11" class="ltx_emph ltx_font_italic">two</em> more than 30% of the time <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. These issues plague development in the field by encouraging methods which fare well on common questions and concepts, rather than on rare answers or more complicated questions. The aggregate accuracy metric used to compare methods is thus a poor indication of method capabilities for visual understanding. Improvements to datasets have been introduced <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, including the <em id="S2.SS0.SSS0.Px1.p2.1.12" class="ltx_emph ltx_font_italic">VQA v2</em>, but they only partially solve the evaluation problems. An increased interest has appeared in the handling of rare words and answers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. The model proposed in this paper is inherently less prone to incorporate dataset biases than existing methods, and shows superior performance for handling rare answers. It accomplishes this by keeping a memory made up of explicit representations of training and support instances.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">VQA with additional data</h5>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">In the classical supervised setting, a fixed set of questions and answers is used to train a model once and for all. With few exceptions, the performance of such a model is fixed as it cannot use additional information at test time. Among those exceptions, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> use an external knowledge base to gather non-visual information related to the input question. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, the authors use visual information from web searches in the form of exemplar images of question words, and better handle rare and novel words appearing in questions as a result. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, the same authors use similar images from web searches to obtain visual representations of candidate answers.</p>
</div>
<div id="S2.SS0.SSS0.Px2.p2" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p2.1" class="ltx_p">Those methods use ad-hoc engineered techniques to incorporate external knowledge in the VQA model. In comparison, this paper presents a much more general approach. We expands the model knowledge with data provided in the form of additional supervised examples (questions and images with their correct answer). A demonstration of the broader generality of our framework over the works above is its ability to produce novel answers, <em id="S2.SS0.SSS0.Px2.p2.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S2.SS0.SSS0.Px2.p2.1.2" class="ltx_text"></span> never observed during initial training and learned only from test-time examples.</p>
</div>
<div id="S2.SS0.SSS0.Px2.p3" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p3.1" class="ltx_p">Recent works on text-based question answering have investigated the retrieval of external information with reinforcement learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Those works are tangentially related and complementary to the approach explored in this paper.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Meta learning and few shot learning</h5>

<div id="S2.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px3.p1.1" class="ltx_p">The term <em id="S2.SS0.SSS0.Px3.p1.1.1" class="ltx_emph ltx_font_italic">meta learning</em> broadly refers to methods that <em id="S2.SS0.SSS0.Px3.p1.1.2" class="ltx_emph ltx_font_italic">learn to learn</em>, <em id="S2.SS0.SSS0.Px3.p1.1.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S2.SS0.SSS0.Px3.p1.1.4" class="ltx_text"></span> that train models to make better use of training data. It applies to approaches including the learning of gradient descent-like algorithms such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> for faster training or fine-tuning of neural networks, and the learning of models that can be directly fed training examples at test time <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. The method we propose falls into the latter category. Most works on meta learning are motivated by the challenge of one-shot and few-shot visual recognition, where the task is to classify an image into categories defined by a few examples each. Our meta learning setting for VQA bears many similarities. VQA is treated as a classification task, and we are provided, at test time, with examples that illustrate the possible answers – possibly a small number per answer. Most existing methods are, however, not directly applicable to our setting, due to the large number of classes (<em id="S2.SS0.SSS0.Px3.p1.1.5" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S2.SS0.SSS0.Px3.p1.1.6" class="ltx_text"></span> possible answers), the heavy class imbalance, and the need to integrate into an architecture suitable to VQA. For example, recent works such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> propose efficient training procedures that are only suitable for a small number of classes.</p>
</div>
<div id="S2.SS0.SSS0.Px3.p2" class="ltx_para">
<p id="S2.SS0.SSS0.Px3.p2.1" class="ltx_p">Our model uses a set of memories within a neural network to store the activations computed over the support set. Similarly, Kaiser <em id="S2.SS0.SSS0.Px3.p2.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px3.p2.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> store past activations to remember “rare events”, which was notably evaluated on machine translation. Our model also uses network layers parametrized by dynamic weights, also known as fast weights. Those are determined at test time depending on the actual input to the network. Dynamic parameters have a long history in neural networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> and have been used previously for few-shot recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and for VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. One of the memories within our network stores the gradient of the loss with respect to static weights of the network, which is similar to the Meta Networks model proposed by Munkhdalai <em id="S2.SS0.SSS0.Px3.p2.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px3.p2.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. Finally, our output stage produces scores over possible answers by similarity to prototypes representing the output classes (answers). This follows a similar idea to the Prototypical Networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Continuum learning</h5>

<div id="S2.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px4.p1.1" class="ltx_p">An important outcome of framing VQA in a meta learning setting is to develop models capable of improving as more data becomes available. This touches the fields of incremental <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> and continuum learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>. Those works focus on the fine-tuning of a network with new training data, output classes and/or tasks. In comparison, our model does not modify itself over time and cannot experience negative domain shift or catastrophic forgetting, which are a central concern of continuum learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. Our approach is rather to use such additional data on-the-fly, at test time, <em id="S2.SS0.SSS0.Px4.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S2.SS0.SSS0.Px4.p1.1.2" class="ltx_text"></span> without an iterative retraining. An important motivation for our framework is its potential to apply to support data of a different nature than question/answer examples. We consider this to be an important direction for future work. This would allow to leverage general, non VQA-specific data, <em id="S2.SS0.SSS0.Px4.p1.1.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.SS0.SSS0.Px4.p1.1.4" class="ltx_text"></span> from knowledge bases or web searches.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>VQA in a Meta Learning Setting</h2>

<figure id="S3.F2" class="ltx_figure"><img src="/html/1711.08105/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="492" height="143" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of the proposed model. We obtain an embedding the input question and image following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> and our contributions concern the mapping of this embedding to scores over a set of candidate answers. First, a <span id="S3.F2.3.1" class="ltx_text ltx_font_bold">non-linear transformation</span> (implemented as a gated hyperbolic tangent layer) is parametrized by static and dynamic weights. Static ones are learned like traditional weights by gradient descent, while dynamic ones are determined based on the actual input and a memory of candidate dynamic weights filled by processing the support set. Second, a <span id="S3.F2.4.2" class="ltx_text ltx_font_bold">similarity measure</span> compares the resulting feature vector to a set of prototypes, each representing a specific candidate answer. Static prototypes are learned like traditional weights, while dynamic prototypes are determined by processing the support set. Dashed lines indicate data flow during the processing of the support set. See Section <a href="#S4" title="4 Proposed Model ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> for details.</figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.10" class="ltx_p">The traditional approach to VQA is in a supervised setting described as follows. A model is trained to map an input question <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\mathsf{Q}" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">𝖰</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝖰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathsf{Q}</annotation></semantics></math> and image <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="\mathsf{I}" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">𝖨</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝖨</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\mathsf{I}</annotation></semantics></math> to scores over candidate answers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. The model is trained to maximize the likelihood of correct answers over a training set <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="{\mathcal{T}}" display="inline"><semantics id="S3.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">{\mathcal{T}}</annotation></semantics></math> of triplets <math id="S3.p1.4.m4.3" class="ltx_Math" alttext="(\mathsf{Q},\mathsf{I},\hat{{\boldsymbol{s}}})" display="inline"><semantics id="S3.p1.4.m4.3a"><mrow id="S3.p1.4.m4.3.4.2" xref="S3.p1.4.m4.3.4.1.cmml"><mo stretchy="false" id="S3.p1.4.m4.3.4.2.1" xref="S3.p1.4.m4.3.4.1.cmml">(</mo><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">𝖰</mi><mo id="S3.p1.4.m4.3.4.2.2" xref="S3.p1.4.m4.3.4.1.cmml">,</mo><mi id="S3.p1.4.m4.2.2" xref="S3.p1.4.m4.2.2.cmml">𝖨</mi><mo id="S3.p1.4.m4.3.4.2.3" xref="S3.p1.4.m4.3.4.1.cmml">,</mo><mover accent="true" id="S3.p1.4.m4.3.3" xref="S3.p1.4.m4.3.3.cmml"><mi id="S3.p1.4.m4.3.3.2" xref="S3.p1.4.m4.3.3.2.cmml">𝒔</mi><mo id="S3.p1.4.m4.3.3.1" xref="S3.p1.4.m4.3.3.1.cmml">^</mo></mover><mo stretchy="false" id="S3.p1.4.m4.3.4.2.4" xref="S3.p1.4.m4.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.3b"><vector id="S3.p1.4.m4.3.4.1.cmml" xref="S3.p1.4.m4.3.4.2"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝖰</ci><ci id="S3.p1.4.m4.2.2.cmml" xref="S3.p1.4.m4.2.2">𝖨</ci><apply id="S3.p1.4.m4.3.3.cmml" xref="S3.p1.4.m4.3.3"><ci id="S3.p1.4.m4.3.3.1.cmml" xref="S3.p1.4.m4.3.3.1">^</ci><ci id="S3.p1.4.m4.3.3.2.cmml" xref="S3.p1.4.m4.3.3.2">𝒔</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.3c">(\mathsf{Q},\mathsf{I},\hat{{\boldsymbol{s}}})</annotation></semantics></math>, where <math id="S3.p1.5.m5.2" class="ltx_Math" alttext="\boldsymbol{\hat{s}}\in[0,1]^{A}" display="inline"><semantics id="S3.p1.5.m5.2a"><mrow id="S3.p1.5.m5.2.3" xref="S3.p1.5.m5.2.3.cmml"><mover accent="true" id="S3.p1.5.m5.2.3.2" xref="S3.p1.5.m5.2.3.2.cmml"><mi id="S3.p1.5.m5.2.3.2.2" xref="S3.p1.5.m5.2.3.2.2.cmml">𝒔</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.p1.5.m5.2.3.2.1" xref="S3.p1.5.m5.2.3.2.1.cmml">^</mo></mover><mo id="S3.p1.5.m5.2.3.1" xref="S3.p1.5.m5.2.3.1.cmml">∈</mo><msup id="S3.p1.5.m5.2.3.3" xref="S3.p1.5.m5.2.3.3.cmml"><mrow id="S3.p1.5.m5.2.3.3.2.2" xref="S3.p1.5.m5.2.3.3.2.1.cmml"><mo stretchy="false" id="S3.p1.5.m5.2.3.3.2.2.1" xref="S3.p1.5.m5.2.3.3.2.1.cmml">[</mo><mn id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">0</mn><mo id="S3.p1.5.m5.2.3.3.2.2.2" xref="S3.p1.5.m5.2.3.3.2.1.cmml">,</mo><mn id="S3.p1.5.m5.2.2" xref="S3.p1.5.m5.2.2.cmml">1</mn><mo stretchy="false" id="S3.p1.5.m5.2.3.3.2.2.3" xref="S3.p1.5.m5.2.3.3.2.1.cmml">]</mo></mrow><mi id="S3.p1.5.m5.2.3.3.3" xref="S3.p1.5.m5.2.3.3.3.cmml">A</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.2b"><apply id="S3.p1.5.m5.2.3.cmml" xref="S3.p1.5.m5.2.3"><in id="S3.p1.5.m5.2.3.1.cmml" xref="S3.p1.5.m5.2.3.1"></in><apply id="S3.p1.5.m5.2.3.2.cmml" xref="S3.p1.5.m5.2.3.2"><ci id="S3.p1.5.m5.2.3.2.1.cmml" xref="S3.p1.5.m5.2.3.2.1">bold-^</ci><ci id="S3.p1.5.m5.2.3.2.2.cmml" xref="S3.p1.5.m5.2.3.2.2">𝒔</ci></apply><apply id="S3.p1.5.m5.2.3.3.cmml" xref="S3.p1.5.m5.2.3.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.2.3.3.1.cmml" xref="S3.p1.5.m5.2.3.3">superscript</csymbol><interval closure="closed" id="S3.p1.5.m5.2.3.3.2.1.cmml" xref="S3.p1.5.m5.2.3.3.2.2"><cn type="integer" id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">0</cn><cn type="integer" id="S3.p1.5.m5.2.2.cmml" xref="S3.p1.5.m5.2.2">1</cn></interval><ci id="S3.p1.5.m5.2.3.3.3.cmml" xref="S3.p1.5.m5.2.3.3.3">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.2c">\boldsymbol{\hat{s}}\in[0,1]^{A}</annotation></semantics></math> represents the vector of ground truth scores of the predefined set of <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">A</annotation></semantics></math> possible answers. At test time, the model is evaluated on another triplet <math id="S3.p1.7.m7.3" class="ltx_Math" alttext="(\mathsf{Q}^{\prime},\mathsf{I}^{\prime},\hat{{\boldsymbol{s}}}^{\prime})" display="inline"><semantics id="S3.p1.7.m7.3a"><mrow id="S3.p1.7.m7.3.3.3" xref="S3.p1.7.m7.3.3.4.cmml"><mo stretchy="false" id="S3.p1.7.m7.3.3.3.4" xref="S3.p1.7.m7.3.3.4.cmml">(</mo><msup id="S3.p1.7.m7.1.1.1.1" xref="S3.p1.7.m7.1.1.1.1.cmml"><mi id="S3.p1.7.m7.1.1.1.1.2" xref="S3.p1.7.m7.1.1.1.1.2.cmml">𝖰</mi><mo id="S3.p1.7.m7.1.1.1.1.3" xref="S3.p1.7.m7.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.p1.7.m7.3.3.3.5" xref="S3.p1.7.m7.3.3.4.cmml">,</mo><msup id="S3.p1.7.m7.2.2.2.2" xref="S3.p1.7.m7.2.2.2.2.cmml"><mi id="S3.p1.7.m7.2.2.2.2.2" xref="S3.p1.7.m7.2.2.2.2.2.cmml">𝖨</mi><mo id="S3.p1.7.m7.2.2.2.2.3" xref="S3.p1.7.m7.2.2.2.2.3.cmml">′</mo></msup><mo id="S3.p1.7.m7.3.3.3.6" xref="S3.p1.7.m7.3.3.4.cmml">,</mo><msup id="S3.p1.7.m7.3.3.3.3" xref="S3.p1.7.m7.3.3.3.3.cmml"><mover accent="true" id="S3.p1.7.m7.3.3.3.3.2" xref="S3.p1.7.m7.3.3.3.3.2.cmml"><mi id="S3.p1.7.m7.3.3.3.3.2.2" xref="S3.p1.7.m7.3.3.3.3.2.2.cmml">𝒔</mi><mo id="S3.p1.7.m7.3.3.3.3.2.1" xref="S3.p1.7.m7.3.3.3.3.2.1.cmml">^</mo></mover><mo id="S3.p1.7.m7.3.3.3.3.3" xref="S3.p1.7.m7.3.3.3.3.3.cmml">′</mo></msup><mo stretchy="false" id="S3.p1.7.m7.3.3.3.7" xref="S3.p1.7.m7.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.3b"><vector id="S3.p1.7.m7.3.3.4.cmml" xref="S3.p1.7.m7.3.3.3"><apply id="S3.p1.7.m7.1.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1.1">superscript</csymbol><ci id="S3.p1.7.m7.1.1.1.1.2.cmml" xref="S3.p1.7.m7.1.1.1.1.2">𝖰</ci><ci id="S3.p1.7.m7.1.1.1.1.3.cmml" xref="S3.p1.7.m7.1.1.1.1.3">′</ci></apply><apply id="S3.p1.7.m7.2.2.2.2.cmml" xref="S3.p1.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.2.2.2.2.1.cmml" xref="S3.p1.7.m7.2.2.2.2">superscript</csymbol><ci id="S3.p1.7.m7.2.2.2.2.2.cmml" xref="S3.p1.7.m7.2.2.2.2.2">𝖨</ci><ci id="S3.p1.7.m7.2.2.2.2.3.cmml" xref="S3.p1.7.m7.2.2.2.2.3">′</ci></apply><apply id="S3.p1.7.m7.3.3.3.3.cmml" xref="S3.p1.7.m7.3.3.3.3"><csymbol cd="ambiguous" id="S3.p1.7.m7.3.3.3.3.1.cmml" xref="S3.p1.7.m7.3.3.3.3">superscript</csymbol><apply id="S3.p1.7.m7.3.3.3.3.2.cmml" xref="S3.p1.7.m7.3.3.3.3.2"><ci id="S3.p1.7.m7.3.3.3.3.2.1.cmml" xref="S3.p1.7.m7.3.3.3.3.2.1">^</ci><ci id="S3.p1.7.m7.3.3.3.3.2.2.cmml" xref="S3.p1.7.m7.3.3.3.3.2.2">𝒔</ci></apply><ci id="S3.p1.7.m7.3.3.3.3.3.cmml" xref="S3.p1.7.m7.3.3.3.3.3">′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.3c">(\mathsf{Q}^{\prime},\mathsf{I}^{\prime},\hat{{\boldsymbol{s}}}^{\prime})</annotation></semantics></math> from an evaluation or test set <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="{\mathcal{E}}" display="inline"><semantics id="S3.p1.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">{\mathcal{E}}</annotation></semantics></math>. The model predicts scores <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="{\boldsymbol{s}}^{\prime}" display="inline"><semantics id="S3.p1.9.m9.1a"><msup id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml"><mi id="S3.p1.9.m9.1.1.2" xref="S3.p1.9.m9.1.1.2.cmml">𝒔</mi><mo id="S3.p1.9.m9.1.1.3" xref="S3.p1.9.m9.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.cmml" xref="S3.p1.9.m9.1.1">superscript</csymbol><ci id="S3.p1.9.m9.1.1.2.cmml" xref="S3.p1.9.m9.1.1.2">𝒔</ci><ci id="S3.p1.9.m9.1.1.3.cmml" xref="S3.p1.9.m9.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">{\boldsymbol{s}}^{\prime}</annotation></semantics></math> over the set of candidate answers, which can be compared to the ground truth <math id="S3.p1.10.m10.1" class="ltx_Math" alttext="\hat{{\boldsymbol{s}}}^{\prime}" display="inline"><semantics id="S3.p1.10.m10.1a"><msup id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml"><mover accent="true" id="S3.p1.10.m10.1.1.2" xref="S3.p1.10.m10.1.1.2.cmml"><mi id="S3.p1.10.m10.1.1.2.2" xref="S3.p1.10.m10.1.1.2.2.cmml">𝒔</mi><mo id="S3.p1.10.m10.1.1.2.1" xref="S3.p1.10.m10.1.1.2.1.cmml">^</mo></mover><mo id="S3.p1.10.m10.1.1.3" xref="S3.p1.10.m10.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><apply id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.cmml" xref="S3.p1.10.m10.1.1">superscript</csymbol><apply id="S3.p1.10.m10.1.1.2.cmml" xref="S3.p1.10.m10.1.1.2"><ci id="S3.p1.10.m10.1.1.2.1.cmml" xref="S3.p1.10.m10.1.1.2.1">^</ci><ci id="S3.p1.10.m10.1.1.2.2.cmml" xref="S3.p1.10.m10.1.1.2.2">𝒔</ci></apply><ci id="S3.p1.10.m10.1.1.3.cmml" xref="S3.p1.10.m10.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">\hat{{\boldsymbol{s}}}^{\prime}</annotation></semantics></math> for evaluation purposes.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.8" class="ltx_p">We extend the formulation above to a meta learning setting by introducing an additional <em id="S3.p2.8.1" class="ltx_emph ltx_font_italic">support set</em> <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="{\mathcal{S}}" display="inline"><semantics id="S3.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">{\mathcal{S}}</annotation></semantics></math> of similar triplets <math id="S3.p2.2.m2.3" class="ltx_Math" alttext="(\mathsf{Q}^{\prime\prime},\mathsf{I}^{\prime\prime},\hat{{\boldsymbol{s}}}^{\prime\prime})" display="inline"><semantics id="S3.p2.2.m2.3a"><mrow id="S3.p2.2.m2.3.3.3" xref="S3.p2.2.m2.3.3.4.cmml"><mo stretchy="false" id="S3.p2.2.m2.3.3.3.4" xref="S3.p2.2.m2.3.3.4.cmml">(</mo><msup id="S3.p2.2.m2.1.1.1.1" xref="S3.p2.2.m2.1.1.1.1.cmml"><mi id="S3.p2.2.m2.1.1.1.1.2" xref="S3.p2.2.m2.1.1.1.1.2.cmml">𝖰</mi><mo id="S3.p2.2.m2.1.1.1.1.3" xref="S3.p2.2.m2.1.1.1.1.3.cmml">′′</mo></msup><mo id="S3.p2.2.m2.3.3.3.5" xref="S3.p2.2.m2.3.3.4.cmml">,</mo><msup id="S3.p2.2.m2.2.2.2.2" xref="S3.p2.2.m2.2.2.2.2.cmml"><mi id="S3.p2.2.m2.2.2.2.2.2" xref="S3.p2.2.m2.2.2.2.2.2.cmml">𝖨</mi><mo id="S3.p2.2.m2.2.2.2.2.3" xref="S3.p2.2.m2.2.2.2.2.3.cmml">′′</mo></msup><mo id="S3.p2.2.m2.3.3.3.6" xref="S3.p2.2.m2.3.3.4.cmml">,</mo><msup id="S3.p2.2.m2.3.3.3.3" xref="S3.p2.2.m2.3.3.3.3.cmml"><mover accent="true" id="S3.p2.2.m2.3.3.3.3.2" xref="S3.p2.2.m2.3.3.3.3.2.cmml"><mi id="S3.p2.2.m2.3.3.3.3.2.2" xref="S3.p2.2.m2.3.3.3.3.2.2.cmml">𝒔</mi><mo id="S3.p2.2.m2.3.3.3.3.2.1" xref="S3.p2.2.m2.3.3.3.3.2.1.cmml">^</mo></mover><mo id="S3.p2.2.m2.3.3.3.3.3" xref="S3.p2.2.m2.3.3.3.3.3.cmml">′′</mo></msup><mo stretchy="false" id="S3.p2.2.m2.3.3.3.7" xref="S3.p2.2.m2.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.3b"><vector id="S3.p2.2.m2.3.3.4.cmml" xref="S3.p2.2.m2.3.3.3"><apply id="S3.p2.2.m2.1.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1.1">superscript</csymbol><ci id="S3.p2.2.m2.1.1.1.1.2.cmml" xref="S3.p2.2.m2.1.1.1.1.2">𝖰</ci><ci id="S3.p2.2.m2.1.1.1.1.3.cmml" xref="S3.p2.2.m2.1.1.1.1.3">′′</ci></apply><apply id="S3.p2.2.m2.2.2.2.2.cmml" xref="S3.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.2.2.2.2.1.cmml" xref="S3.p2.2.m2.2.2.2.2">superscript</csymbol><ci id="S3.p2.2.m2.2.2.2.2.2.cmml" xref="S3.p2.2.m2.2.2.2.2.2">𝖨</ci><ci id="S3.p2.2.m2.2.2.2.2.3.cmml" xref="S3.p2.2.m2.2.2.2.2.3">′′</ci></apply><apply id="S3.p2.2.m2.3.3.3.3.cmml" xref="S3.p2.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.p2.2.m2.3.3.3.3.1.cmml" xref="S3.p2.2.m2.3.3.3.3">superscript</csymbol><apply id="S3.p2.2.m2.3.3.3.3.2.cmml" xref="S3.p2.2.m2.3.3.3.3.2"><ci id="S3.p2.2.m2.3.3.3.3.2.1.cmml" xref="S3.p2.2.m2.3.3.3.3.2.1">^</ci><ci id="S3.p2.2.m2.3.3.3.3.2.2.cmml" xref="S3.p2.2.m2.3.3.3.3.2.2">𝒔</ci></apply><ci id="S3.p2.2.m2.3.3.3.3.3.cmml" xref="S3.p2.2.m2.3.3.3.3.3">′′</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.3c">(\mathsf{Q}^{\prime\prime},\mathsf{I}^{\prime\prime},\hat{{\boldsymbol{s}}}^{\prime\prime})</annotation></semantics></math>. These are provided to the model at test time. At a minimum, we define the support set to include the training examples themselves, <em id="S3.p2.8.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.p2.8.3" class="ltx_text"></span> <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="{\mathcal{S}}={\mathcal{T}}" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">𝒮</mi><mo id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">𝒯</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><eq id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1"></eq><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝒮</ci><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">𝒯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">{\mathcal{S}}={\mathcal{T}}</annotation></semantics></math>, but more interestingly, the support set can include novel examples <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="{\mathcal{S^{\prime}}}" display="inline"><semantics id="S3.p2.4.m4.1a"><msup id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">𝒮</mi><mo id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">superscript</csymbol><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝒮</ci><ci id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">{\mathcal{S^{\prime}}}</annotation></semantics></math> provided at test time. They constitute additional data to learn from, such that <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="{\mathcal{S}}={\mathcal{T}}\cup{\mathcal{S^{\prime}}}" display="inline"><semantics id="S3.p2.5.m5.1a"><mrow id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">𝒮</mi><mo id="S3.p2.5.m5.1.1.1" xref="S3.p2.5.m5.1.1.1.cmml">=</mo><mrow id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.1.1.3.2" xref="S3.p2.5.m5.1.1.3.2.cmml">𝒯</mi><mo id="S3.p2.5.m5.1.1.3.1" xref="S3.p2.5.m5.1.1.3.1.cmml">∪</mo><msup id="S3.p2.5.m5.1.1.3.3" xref="S3.p2.5.m5.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.1.1.3.3.2" xref="S3.p2.5.m5.1.1.3.3.2.cmml">𝒮</mi><mo id="S3.p2.5.m5.1.1.3.3.3" xref="S3.p2.5.m5.1.1.3.3.3.cmml">′</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><eq id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1.1"></eq><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">𝒮</ci><apply id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3"><union id="S3.p2.5.m5.1.1.3.1.cmml" xref="S3.p2.5.m5.1.1.3.1"></union><ci id="S3.p2.5.m5.1.1.3.2.cmml" xref="S3.p2.5.m5.1.1.3.2">𝒯</ci><apply id="S3.p2.5.m5.1.1.3.3.cmml" xref="S3.p2.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.3.3.1.cmml" xref="S3.p2.5.m5.1.1.3.3">superscript</csymbol><ci id="S3.p2.5.m5.1.1.3.3.2.cmml" xref="S3.p2.5.m5.1.1.3.3.2">𝒮</ci><ci id="S3.p2.5.m5.1.1.3.3.3.cmml" xref="S3.p2.5.m5.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">{\mathcal{S}}={\mathcal{T}}\cup{\mathcal{S^{\prime}}}</annotation></semantics></math>. The triplets <math id="S3.p2.6.m6.3" class="ltx_Math" alttext="(\mathsf{Q},\mathsf{I},\hat{{\boldsymbol{s}}})" display="inline"><semantics id="S3.p2.6.m6.3a"><mrow id="S3.p2.6.m6.3.4.2" xref="S3.p2.6.m6.3.4.1.cmml"><mo stretchy="false" id="S3.p2.6.m6.3.4.2.1" xref="S3.p2.6.m6.3.4.1.cmml">(</mo><mi id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml">𝖰</mi><mo id="S3.p2.6.m6.3.4.2.2" xref="S3.p2.6.m6.3.4.1.cmml">,</mo><mi id="S3.p2.6.m6.2.2" xref="S3.p2.6.m6.2.2.cmml">𝖨</mi><mo id="S3.p2.6.m6.3.4.2.3" xref="S3.p2.6.m6.3.4.1.cmml">,</mo><mover accent="true" id="S3.p2.6.m6.3.3" xref="S3.p2.6.m6.3.3.cmml"><mi id="S3.p2.6.m6.3.3.2" xref="S3.p2.6.m6.3.3.2.cmml">𝒔</mi><mo id="S3.p2.6.m6.3.3.1" xref="S3.p2.6.m6.3.3.1.cmml">^</mo></mover><mo stretchy="false" id="S3.p2.6.m6.3.4.2.4" xref="S3.p2.6.m6.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.3b"><vector id="S3.p2.6.m6.3.4.1.cmml" xref="S3.p2.6.m6.3.4.2"><ci id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1">𝖰</ci><ci id="S3.p2.6.m6.2.2.cmml" xref="S3.p2.6.m6.2.2">𝖨</ci><apply id="S3.p2.6.m6.3.3.cmml" xref="S3.p2.6.m6.3.3"><ci id="S3.p2.6.m6.3.3.1.cmml" xref="S3.p2.6.m6.3.3.1">^</ci><ci id="S3.p2.6.m6.3.3.2.cmml" xref="S3.p2.6.m6.3.3.2">𝒔</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.3c">(\mathsf{Q},\mathsf{I},\hat{{\boldsymbol{s}}})</annotation></semantics></math> in the support set can also include novel answers, never seen in the training set. In that case, the ground truth score vectors <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="\hat{bs}" display="inline"><semantics id="S3.p2.7.m7.1a"><mover accent="true" id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mrow id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml"><mi id="S3.p2.7.m7.1.1.2.2" xref="S3.p2.7.m7.1.1.2.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.p2.7.m7.1.1.2.1" xref="S3.p2.7.m7.1.1.2.1.cmml">​</mo><mi id="S3.p2.7.m7.1.1.2.3" xref="S3.p2.7.m7.1.1.2.3.cmml">s</mi></mrow><mo id="S3.p2.7.m7.1.1.1" xref="S3.p2.7.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><ci id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1.1">^</ci><apply id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2"><times id="S3.p2.7.m7.1.1.2.1.cmml" xref="S3.p2.7.m7.1.1.2.1"></times><ci id="S3.p2.7.m7.1.1.2.2.cmml" xref="S3.p2.7.m7.1.1.2.2">𝑏</ci><ci id="S3.p2.7.m7.1.1.2.3.cmml" xref="S3.p2.7.m7.1.1.2.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">\hat{bs}</annotation></semantics></math> of the other elements in the support are simply padded with zeros to match the larger size <math id="S3.p2.8.m8.1" class="ltx_Math" alttext="A^{\prime}" display="inline"><semantics id="S3.p2.8.m8.1a"><msup id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><mi id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml">A</mi><mo id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.1.cmml" xref="S3.p2.8.m8.1.1">superscript</csymbol><ci id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2">𝐴</ci><ci id="S3.p2.8.m8.1.1.3.cmml" xref="S3.p2.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">A^{\prime}</annotation></semantics></math> of the extended set of answers.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">The following sections describe a deep neural network that can take advantage of the support set at test time. To leverage the information contained in the support set, the model must learn to utilize these examples on-the-fly at test time, without retraining of the whole model.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Proposed Model</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The proposed model (Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 VQA in a Meta Learning Setting ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) is a deep neural network that extends the state-of-art VQA system of Teney <em id="S4.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S4.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. Their system implements the joint embedding approach common to most modern VQA models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, which is followed by a multi-label classifier over candidate answers. Conceptually, we separate the architecture into (1) the embedding part that encodes the input question and image, and (2) the classifier part that handles the reasoning and actual question answering<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The separation of the network into an embedding and a classifier parts is conceptual. The division is arbitrarily placed after the fusion of the question and image embeddings. Computational requirements aside, the concept of dynamic parameters is in principle applicable to earlier layers as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.</span></span></span>. The contributions of this paper address only the second part. Our contributions are orthogonal to developments on the embedding part, which could also benefit <em id="S4.p1.1.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.p1.1.4" class="ltx_text"></span> from advanced attention mechanisms or other computer vision techniques <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. We follow the implementation of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> for the embedding part. For concreteness, let us mention that the question embedding uses <span id="S4.p1.1.5" class="ltx_text ltx_font_italic">GloVe</span> word vectors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> and a Recurrent Gated Unit (GRU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>). The image embedding uses features from a CNN (Convolutional Neural Network) with bottom-up attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and question-guided attention over those features. See <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> for details.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.13" class="ltx_p">For the remainder of this paper, we abstract the embedding to modules that produce respectively the question and image vectors <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="{\boldsymbol{q}}" display="inline"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">{\boldsymbol{q}}</annotation></semantics></math> and <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="{\boldsymbol{v}}\in\mathbb{R}^{D}" display="inline"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">𝒗</mi><mo id="S4.p2.2.m2.1.1.1" xref="S4.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml"><mi id="S4.p2.2.m2.1.1.3.2" xref="S4.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S4.p2.2.m2.1.1.3.3" xref="S4.p2.2.m2.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><in id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1"></in><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">𝒗</ci><apply id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.3.1.cmml" xref="S4.p2.2.m2.1.1.3">superscript</csymbol><ci id="S4.p2.2.m2.1.1.3.2.cmml" xref="S4.p2.2.m2.1.1.3.2">ℝ</ci><ci id="S4.p2.2.m2.1.1.3.3.cmml" xref="S4.p2.2.m2.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">{\boldsymbol{v}}\in\mathbb{R}^{D}</annotation></semantics></math>. They are combined with a Hadamard (element-wise) product into <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="{\boldsymbol{h}}={\boldsymbol{q}}~{}\circ~{}{\boldsymbol{v}}" display="inline"><semantics id="S4.p2.3.m3.1a"><mrow id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mi id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">𝒉</mi><mo id="S4.p2.3.m3.1.1.1" xref="S4.p2.3.m3.1.1.1.cmml">=</mo><mrow id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml"><mi id="S4.p2.3.m3.1.1.3.2" xref="S4.p2.3.m3.1.1.3.2.cmml">𝒒</mi><mo lspace="0.552em" rspace="0.552em" id="S4.p2.3.m3.1.1.3.1" xref="S4.p2.3.m3.1.1.3.1.cmml">∘</mo><mi id="S4.p2.3.m3.1.1.3.3" xref="S4.p2.3.m3.1.1.3.3.cmml">𝒗</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><eq id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1.1"></eq><ci id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2">𝒉</ci><apply id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3"><compose id="S4.p2.3.m3.1.1.3.1.cmml" xref="S4.p2.3.m3.1.1.3.1"></compose><ci id="S4.p2.3.m3.1.1.3.2.cmml" xref="S4.p2.3.m3.1.1.3.2">𝒒</ci><ci id="S4.p2.3.m3.1.1.3.3.cmml" xref="S4.p2.3.m3.1.1.3.3">𝒗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">{\boldsymbol{h}}={\boldsymbol{q}}~{}\circ~{}{\boldsymbol{v}}</annotation></semantics></math>, which forms the input to the classifier on which we now focus on. The role of the classifier is to map <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="{\boldsymbol{h}}" display="inline"><semantics id="S4.p2.4.m4.1a"><mi id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">𝒉</mi><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><ci id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1">𝒉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">{\boldsymbol{h}}</annotation></semantics></math> to a vector of scores <math id="S4.p2.5.m5.2" class="ltx_Math" alttext="{\boldsymbol{s}}\in[0,1]^{A}" display="inline"><semantics id="S4.p2.5.m5.2a"><mrow id="S4.p2.5.m5.2.3" xref="S4.p2.5.m5.2.3.cmml"><mi id="S4.p2.5.m5.2.3.2" xref="S4.p2.5.m5.2.3.2.cmml">𝒔</mi><mo id="S4.p2.5.m5.2.3.1" xref="S4.p2.5.m5.2.3.1.cmml">∈</mo><msup id="S4.p2.5.m5.2.3.3" xref="S4.p2.5.m5.2.3.3.cmml"><mrow id="S4.p2.5.m5.2.3.3.2.2" xref="S4.p2.5.m5.2.3.3.2.1.cmml"><mo stretchy="false" id="S4.p2.5.m5.2.3.3.2.2.1" xref="S4.p2.5.m5.2.3.3.2.1.cmml">[</mo><mn id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml">0</mn><mo id="S4.p2.5.m5.2.3.3.2.2.2" xref="S4.p2.5.m5.2.3.3.2.1.cmml">,</mo><mn id="S4.p2.5.m5.2.2" xref="S4.p2.5.m5.2.2.cmml">1</mn><mo stretchy="false" id="S4.p2.5.m5.2.3.3.2.2.3" xref="S4.p2.5.m5.2.3.3.2.1.cmml">]</mo></mrow><mi id="S4.p2.5.m5.2.3.3.3" xref="S4.p2.5.m5.2.3.3.3.cmml">A</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.2b"><apply id="S4.p2.5.m5.2.3.cmml" xref="S4.p2.5.m5.2.3"><in id="S4.p2.5.m5.2.3.1.cmml" xref="S4.p2.5.m5.2.3.1"></in><ci id="S4.p2.5.m5.2.3.2.cmml" xref="S4.p2.5.m5.2.3.2">𝒔</ci><apply id="S4.p2.5.m5.2.3.3.cmml" xref="S4.p2.5.m5.2.3.3"><csymbol cd="ambiguous" id="S4.p2.5.m5.2.3.3.1.cmml" xref="S4.p2.5.m5.2.3.3">superscript</csymbol><interval closure="closed" id="S4.p2.5.m5.2.3.3.2.1.cmml" xref="S4.p2.5.m5.2.3.3.2.2"><cn type="integer" id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1">0</cn><cn type="integer" id="S4.p2.5.m5.2.2.cmml" xref="S4.p2.5.m5.2.2">1</cn></interval><ci id="S4.p2.5.m5.2.3.3.3.cmml" xref="S4.p2.5.m5.2.3.3.3">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.2c">{\boldsymbol{s}}\in[0,1]^{A}</annotation></semantics></math> over the candidate answers. We propose a definition of the classifier that generalizes the implementation of traditional models such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. The input to the classifier <math id="S4.p2.6.m6.1" class="ltx_Math" alttext="{\boldsymbol{h}}\in\mathbb{R}^{D}" display="inline"><semantics id="S4.p2.6.m6.1a"><mrow id="S4.p2.6.m6.1.1" xref="S4.p2.6.m6.1.1.cmml"><mi id="S4.p2.6.m6.1.1.2" xref="S4.p2.6.m6.1.1.2.cmml">𝒉</mi><mo id="S4.p2.6.m6.1.1.1" xref="S4.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S4.p2.6.m6.1.1.3" xref="S4.p2.6.m6.1.1.3.cmml"><mi id="S4.p2.6.m6.1.1.3.2" xref="S4.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mi id="S4.p2.6.m6.1.1.3.3" xref="S4.p2.6.m6.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.6.m6.1b"><apply id="S4.p2.6.m6.1.1.cmml" xref="S4.p2.6.m6.1.1"><in id="S4.p2.6.m6.1.1.1.cmml" xref="S4.p2.6.m6.1.1.1"></in><ci id="S4.p2.6.m6.1.1.2.cmml" xref="S4.p2.6.m6.1.1.2">𝒉</ci><apply id="S4.p2.6.m6.1.1.3.cmml" xref="S4.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.p2.6.m6.1.1.3.1.cmml" xref="S4.p2.6.m6.1.1.3">superscript</csymbol><ci id="S4.p2.6.m6.1.1.3.2.cmml" xref="S4.p2.6.m6.1.1.3.2">ℝ</ci><ci id="S4.p2.6.m6.1.1.3.3.cmml" xref="S4.p2.6.m6.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m6.1c">{\boldsymbol{h}}\in\mathbb{R}^{D}</annotation></semantics></math> is first passed through a non-linear transformation <math id="S4.p2.7.m7.1" class="ltx_Math" alttext="f_{\boldsymbol{\theta}}:\mathbb{R}^{D}\to\mathbb{R}^{D}" display="inline"><semantics id="S4.p2.7.m7.1a"><mrow id="S4.p2.7.m7.1.1" xref="S4.p2.7.m7.1.1.cmml"><msub id="S4.p2.7.m7.1.1.2" xref="S4.p2.7.m7.1.1.2.cmml"><mi id="S4.p2.7.m7.1.1.2.2" xref="S4.p2.7.m7.1.1.2.2.cmml">f</mi><mi id="S4.p2.7.m7.1.1.2.3" xref="S4.p2.7.m7.1.1.2.3.cmml">𝜽</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.p2.7.m7.1.1.1" xref="S4.p2.7.m7.1.1.1.cmml">:</mo><mrow id="S4.p2.7.m7.1.1.3" xref="S4.p2.7.m7.1.1.3.cmml"><msup id="S4.p2.7.m7.1.1.3.2" xref="S4.p2.7.m7.1.1.3.2.cmml"><mi id="S4.p2.7.m7.1.1.3.2.2" xref="S4.p2.7.m7.1.1.3.2.2.cmml">ℝ</mi><mi id="S4.p2.7.m7.1.1.3.2.3" xref="S4.p2.7.m7.1.1.3.2.3.cmml">D</mi></msup><mo stretchy="false" id="S4.p2.7.m7.1.1.3.1" xref="S4.p2.7.m7.1.1.3.1.cmml">→</mo><msup id="S4.p2.7.m7.1.1.3.3" xref="S4.p2.7.m7.1.1.3.3.cmml"><mi id="S4.p2.7.m7.1.1.3.3.2" xref="S4.p2.7.m7.1.1.3.3.2.cmml">ℝ</mi><mi id="S4.p2.7.m7.1.1.3.3.3" xref="S4.p2.7.m7.1.1.3.3.3.cmml">D</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.7.m7.1b"><apply id="S4.p2.7.m7.1.1.cmml" xref="S4.p2.7.m7.1.1"><ci id="S4.p2.7.m7.1.1.1.cmml" xref="S4.p2.7.m7.1.1.1">:</ci><apply id="S4.p2.7.m7.1.1.2.cmml" xref="S4.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.p2.7.m7.1.1.2.1.cmml" xref="S4.p2.7.m7.1.1.2">subscript</csymbol><ci id="S4.p2.7.m7.1.1.2.2.cmml" xref="S4.p2.7.m7.1.1.2.2">𝑓</ci><ci id="S4.p2.7.m7.1.1.2.3.cmml" xref="S4.p2.7.m7.1.1.2.3">𝜽</ci></apply><apply id="S4.p2.7.m7.1.1.3.cmml" xref="S4.p2.7.m7.1.1.3"><ci id="S4.p2.7.m7.1.1.3.1.cmml" xref="S4.p2.7.m7.1.1.3.1">→</ci><apply id="S4.p2.7.m7.1.1.3.2.cmml" xref="S4.p2.7.m7.1.1.3.2"><csymbol cd="ambiguous" id="S4.p2.7.m7.1.1.3.2.1.cmml" xref="S4.p2.7.m7.1.1.3.2">superscript</csymbol><ci id="S4.p2.7.m7.1.1.3.2.2.cmml" xref="S4.p2.7.m7.1.1.3.2.2">ℝ</ci><ci id="S4.p2.7.m7.1.1.3.2.3.cmml" xref="S4.p2.7.m7.1.1.3.2.3">𝐷</ci></apply><apply id="S4.p2.7.m7.1.1.3.3.cmml" xref="S4.p2.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S4.p2.7.m7.1.1.3.3.1.cmml" xref="S4.p2.7.m7.1.1.3.3">superscript</csymbol><ci id="S4.p2.7.m7.1.1.3.3.2.cmml" xref="S4.p2.7.m7.1.1.3.3.2">ℝ</ci><ci id="S4.p2.7.m7.1.1.3.3.3.cmml" xref="S4.p2.7.m7.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m7.1c">f_{\boldsymbol{\theta}}:\mathbb{R}^{D}\to\mathbb{R}^{D}</annotation></semantics></math>, then through a mapping to scores over the set of candidate answers <math id="S4.p2.8.m8.2" class="ltx_Math" alttext="g_{\mathit{\Phi}}:\mathbb{R}^{D}\to[0,1]^{A}" display="inline"><semantics id="S4.p2.8.m8.2a"><mrow id="S4.p2.8.m8.2.3" xref="S4.p2.8.m8.2.3.cmml"><msub id="S4.p2.8.m8.2.3.2" xref="S4.p2.8.m8.2.3.2.cmml"><mi id="S4.p2.8.m8.2.3.2.2" xref="S4.p2.8.m8.2.3.2.2.cmml">g</mi><mi id="S4.p2.8.m8.2.3.2.3" xref="S4.p2.8.m8.2.3.2.3.cmml">Φ</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.p2.8.m8.2.3.1" xref="S4.p2.8.m8.2.3.1.cmml">:</mo><mrow id="S4.p2.8.m8.2.3.3" xref="S4.p2.8.m8.2.3.3.cmml"><msup id="S4.p2.8.m8.2.3.3.2" xref="S4.p2.8.m8.2.3.3.2.cmml"><mi id="S4.p2.8.m8.2.3.3.2.2" xref="S4.p2.8.m8.2.3.3.2.2.cmml">ℝ</mi><mi id="S4.p2.8.m8.2.3.3.2.3" xref="S4.p2.8.m8.2.3.3.2.3.cmml">D</mi></msup><mo stretchy="false" id="S4.p2.8.m8.2.3.3.1" xref="S4.p2.8.m8.2.3.3.1.cmml">→</mo><msup id="S4.p2.8.m8.2.3.3.3" xref="S4.p2.8.m8.2.3.3.3.cmml"><mrow id="S4.p2.8.m8.2.3.3.3.2.2" xref="S4.p2.8.m8.2.3.3.3.2.1.cmml"><mo stretchy="false" id="S4.p2.8.m8.2.3.3.3.2.2.1" xref="S4.p2.8.m8.2.3.3.3.2.1.cmml">[</mo><mn id="S4.p2.8.m8.1.1" xref="S4.p2.8.m8.1.1.cmml">0</mn><mo id="S4.p2.8.m8.2.3.3.3.2.2.2" xref="S4.p2.8.m8.2.3.3.3.2.1.cmml">,</mo><mn id="S4.p2.8.m8.2.2" xref="S4.p2.8.m8.2.2.cmml">1</mn><mo stretchy="false" id="S4.p2.8.m8.2.3.3.3.2.2.3" xref="S4.p2.8.m8.2.3.3.3.2.1.cmml">]</mo></mrow><mi id="S4.p2.8.m8.2.3.3.3.3" xref="S4.p2.8.m8.2.3.3.3.3.cmml">A</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.8.m8.2b"><apply id="S4.p2.8.m8.2.3.cmml" xref="S4.p2.8.m8.2.3"><ci id="S4.p2.8.m8.2.3.1.cmml" xref="S4.p2.8.m8.2.3.1">:</ci><apply id="S4.p2.8.m8.2.3.2.cmml" xref="S4.p2.8.m8.2.3.2"><csymbol cd="ambiguous" id="S4.p2.8.m8.2.3.2.1.cmml" xref="S4.p2.8.m8.2.3.2">subscript</csymbol><ci id="S4.p2.8.m8.2.3.2.2.cmml" xref="S4.p2.8.m8.2.3.2.2">𝑔</ci><ci id="S4.p2.8.m8.2.3.2.3.cmml" xref="S4.p2.8.m8.2.3.2.3">𝛷</ci></apply><apply id="S4.p2.8.m8.2.3.3.cmml" xref="S4.p2.8.m8.2.3.3"><ci id="S4.p2.8.m8.2.3.3.1.cmml" xref="S4.p2.8.m8.2.3.3.1">→</ci><apply id="S4.p2.8.m8.2.3.3.2.cmml" xref="S4.p2.8.m8.2.3.3.2"><csymbol cd="ambiguous" id="S4.p2.8.m8.2.3.3.2.1.cmml" xref="S4.p2.8.m8.2.3.3.2">superscript</csymbol><ci id="S4.p2.8.m8.2.3.3.2.2.cmml" xref="S4.p2.8.m8.2.3.3.2.2">ℝ</ci><ci id="S4.p2.8.m8.2.3.3.2.3.cmml" xref="S4.p2.8.m8.2.3.3.2.3">𝐷</ci></apply><apply id="S4.p2.8.m8.2.3.3.3.cmml" xref="S4.p2.8.m8.2.3.3.3"><csymbol cd="ambiguous" id="S4.p2.8.m8.2.3.3.3.1.cmml" xref="S4.p2.8.m8.2.3.3.3">superscript</csymbol><interval closure="closed" id="S4.p2.8.m8.2.3.3.3.2.1.cmml" xref="S4.p2.8.m8.2.3.3.3.2.2"><cn type="integer" id="S4.p2.8.m8.1.1.cmml" xref="S4.p2.8.m8.1.1">0</cn><cn type="integer" id="S4.p2.8.m8.2.2.cmml" xref="S4.p2.8.m8.2.2">1</cn></interval><ci id="S4.p2.8.m8.2.3.3.3.3.cmml" xref="S4.p2.8.m8.2.3.3.3.3">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m8.2c">g_{\mathit{\Phi}}:\mathbb{R}^{D}\to[0,1]^{A}</annotation></semantics></math>. This produces a vector of predicted scores <math id="S4.p2.9.m9.2" class="ltx_Math" alttext="{\boldsymbol{s}}=f_{\boldsymbol{\theta}}(g_{\mathit{\Phi}}({\boldsymbol{h}}))" display="inline"><semantics id="S4.p2.9.m9.2a"><mrow id="S4.p2.9.m9.2.2" xref="S4.p2.9.m9.2.2.cmml"><mi id="S4.p2.9.m9.2.2.3" xref="S4.p2.9.m9.2.2.3.cmml">𝒔</mi><mo id="S4.p2.9.m9.2.2.2" xref="S4.p2.9.m9.2.2.2.cmml">=</mo><mrow id="S4.p2.9.m9.2.2.1" xref="S4.p2.9.m9.2.2.1.cmml"><msub id="S4.p2.9.m9.2.2.1.3" xref="S4.p2.9.m9.2.2.1.3.cmml"><mi id="S4.p2.9.m9.2.2.1.3.2" xref="S4.p2.9.m9.2.2.1.3.2.cmml">f</mi><mi id="S4.p2.9.m9.2.2.1.3.3" xref="S4.p2.9.m9.2.2.1.3.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.p2.9.m9.2.2.1.2" xref="S4.p2.9.m9.2.2.1.2.cmml">​</mo><mrow id="S4.p2.9.m9.2.2.1.1.1" xref="S4.p2.9.m9.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.p2.9.m9.2.2.1.1.1.2" xref="S4.p2.9.m9.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.p2.9.m9.2.2.1.1.1.1" xref="S4.p2.9.m9.2.2.1.1.1.1.cmml"><msub id="S4.p2.9.m9.2.2.1.1.1.1.2" xref="S4.p2.9.m9.2.2.1.1.1.1.2.cmml"><mi id="S4.p2.9.m9.2.2.1.1.1.1.2.2" xref="S4.p2.9.m9.2.2.1.1.1.1.2.2.cmml">g</mi><mi id="S4.p2.9.m9.2.2.1.1.1.1.2.3" xref="S4.p2.9.m9.2.2.1.1.1.1.2.3.cmml">Φ</mi></msub><mo lspace="0em" rspace="0em" id="S4.p2.9.m9.2.2.1.1.1.1.1" xref="S4.p2.9.m9.2.2.1.1.1.1.1.cmml">​</mo><mrow id="S4.p2.9.m9.2.2.1.1.1.1.3.2" xref="S4.p2.9.m9.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.p2.9.m9.2.2.1.1.1.1.3.2.1" xref="S4.p2.9.m9.2.2.1.1.1.1.cmml">(</mo><mi id="S4.p2.9.m9.1.1" xref="S4.p2.9.m9.1.1.cmml">𝒉</mi><mo stretchy="false" id="S4.p2.9.m9.2.2.1.1.1.1.3.2.2" xref="S4.p2.9.m9.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.p2.9.m9.2.2.1.1.1.3" xref="S4.p2.9.m9.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.9.m9.2b"><apply id="S4.p2.9.m9.2.2.cmml" xref="S4.p2.9.m9.2.2"><eq id="S4.p2.9.m9.2.2.2.cmml" xref="S4.p2.9.m9.2.2.2"></eq><ci id="S4.p2.9.m9.2.2.3.cmml" xref="S4.p2.9.m9.2.2.3">𝒔</ci><apply id="S4.p2.9.m9.2.2.1.cmml" xref="S4.p2.9.m9.2.2.1"><times id="S4.p2.9.m9.2.2.1.2.cmml" xref="S4.p2.9.m9.2.2.1.2"></times><apply id="S4.p2.9.m9.2.2.1.3.cmml" xref="S4.p2.9.m9.2.2.1.3"><csymbol cd="ambiguous" id="S4.p2.9.m9.2.2.1.3.1.cmml" xref="S4.p2.9.m9.2.2.1.3">subscript</csymbol><ci id="S4.p2.9.m9.2.2.1.3.2.cmml" xref="S4.p2.9.m9.2.2.1.3.2">𝑓</ci><ci id="S4.p2.9.m9.2.2.1.3.3.cmml" xref="S4.p2.9.m9.2.2.1.3.3">𝜽</ci></apply><apply id="S4.p2.9.m9.2.2.1.1.1.1.cmml" xref="S4.p2.9.m9.2.2.1.1.1"><times id="S4.p2.9.m9.2.2.1.1.1.1.1.cmml" xref="S4.p2.9.m9.2.2.1.1.1.1.1"></times><apply id="S4.p2.9.m9.2.2.1.1.1.1.2.cmml" xref="S4.p2.9.m9.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p2.9.m9.2.2.1.1.1.1.2.1.cmml" xref="S4.p2.9.m9.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.p2.9.m9.2.2.1.1.1.1.2.2.cmml" xref="S4.p2.9.m9.2.2.1.1.1.1.2.2">𝑔</ci><ci id="S4.p2.9.m9.2.2.1.1.1.1.2.3.cmml" xref="S4.p2.9.m9.2.2.1.1.1.1.2.3">𝛷</ci></apply><ci id="S4.p2.9.m9.1.1.cmml" xref="S4.p2.9.m9.1.1">𝒉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.9.m9.2c">{\boldsymbol{s}}=f_{\boldsymbol{\theta}}(g_{\mathit{\Phi}}({\boldsymbol{h}}))</annotation></semantics></math>. In traditional models, the two functions correspond to a stack of non-linear layers for <math id="S4.p2.10.m10.1" class="ltx_Math" alttext="f_{\boldsymbol{\theta}}" display="inline"><semantics id="S4.p2.10.m10.1a"><msub id="S4.p2.10.m10.1.1" xref="S4.p2.10.m10.1.1.cmml"><mi id="S4.p2.10.m10.1.1.2" xref="S4.p2.10.m10.1.1.2.cmml">f</mi><mi id="S4.p2.10.m10.1.1.3" xref="S4.p2.10.m10.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.10.m10.1b"><apply id="S4.p2.10.m10.1.1.cmml" xref="S4.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.p2.10.m10.1.1.1.cmml" xref="S4.p2.10.m10.1.1">subscript</csymbol><ci id="S4.p2.10.m10.1.1.2.cmml" xref="S4.p2.10.m10.1.1.2">𝑓</ci><ci id="S4.p2.10.m10.1.1.3.cmml" xref="S4.p2.10.m10.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.10.m10.1c">f_{\boldsymbol{\theta}}</annotation></semantics></math>, and a linear layer followed by a softmax or sigmoid for <math id="S4.p2.11.m11.1" class="ltx_Math" alttext="g_{\mathit{\Phi}}" display="inline"><semantics id="S4.p2.11.m11.1a"><msub id="S4.p2.11.m11.1.1" xref="S4.p2.11.m11.1.1.cmml"><mi id="S4.p2.11.m11.1.1.2" xref="S4.p2.11.m11.1.1.2.cmml">g</mi><mi id="S4.p2.11.m11.1.1.3" xref="S4.p2.11.m11.1.1.3.cmml">Φ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.11.m11.1b"><apply id="S4.p2.11.m11.1.1.cmml" xref="S4.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.p2.11.m11.1.1.1.cmml" xref="S4.p2.11.m11.1.1">subscript</csymbol><ci id="S4.p2.11.m11.1.1.2.cmml" xref="S4.p2.11.m11.1.1.2">𝑔</ci><ci id="S4.p2.11.m11.1.1.3.cmml" xref="S4.p2.11.m11.1.1.3">𝛷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.11.m11.1c">g_{\mathit{\Phi}}</annotation></semantics></math>. We now show how to extend <math id="S4.p2.12.m12.1" class="ltx_Math" alttext="f_{\boldsymbol{\theta}}" display="inline"><semantics id="S4.p2.12.m12.1a"><msub id="S4.p2.12.m12.1.1" xref="S4.p2.12.m12.1.1.cmml"><mi id="S4.p2.12.m12.1.1.2" xref="S4.p2.12.m12.1.1.2.cmml">f</mi><mi id="S4.p2.12.m12.1.1.3" xref="S4.p2.12.m12.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.12.m12.1b"><apply id="S4.p2.12.m12.1.1.cmml" xref="S4.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S4.p2.12.m12.1.1.1.cmml" xref="S4.p2.12.m12.1.1">subscript</csymbol><ci id="S4.p2.12.m12.1.1.2.cmml" xref="S4.p2.12.m12.1.1.2">𝑓</ci><ci id="S4.p2.12.m12.1.1.3.cmml" xref="S4.p2.12.m12.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.12.m12.1c">f_{\boldsymbol{\theta}}</annotation></semantics></math> and <math id="S4.p2.13.m13.1" class="ltx_Math" alttext="g_{\mathit{\Phi}}" display="inline"><semantics id="S4.p2.13.m13.1a"><msub id="S4.p2.13.m13.1.1" xref="S4.p2.13.m13.1.1.cmml"><mi id="S4.p2.13.m13.1.1.2" xref="S4.p2.13.m13.1.1.2.cmml">g</mi><mi id="S4.p2.13.m13.1.1.3" xref="S4.p2.13.m13.1.1.3.cmml">Φ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.13.m13.1b"><apply id="S4.p2.13.m13.1.1.cmml" xref="S4.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S4.p2.13.m13.1.1.1.cmml" xref="S4.p2.13.m13.1.1">subscript</csymbol><ci id="S4.p2.13.m13.1.1.2.cmml" xref="S4.p2.13.m13.1.1.2">𝑔</ci><ci id="S4.p2.13.m13.1.1.3.cmml" xref="S4.p2.13.m13.1.1.3">𝛷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.13.m13.1c">g_{\mathit{\Phi}}</annotation></semantics></math> to take advantage of the meta learning setting.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Non-linear Transformation <math id="S4.SS1.1.m1.1" class="ltx_Math" alttext="f_{\boldsymbol{\theta}}(\cdot)" display="inline"><semantics id="S4.SS1.1.m1.1b"><mrow id="S4.SS1.1.m1.1.2" xref="S4.SS1.1.m1.1.2.cmml"><msub id="S4.SS1.1.m1.1.2.2" xref="S4.SS1.1.m1.1.2.2.cmml"><mi id="S4.SS1.1.m1.1.2.2.2" xref="S4.SS1.1.m1.1.2.2.2.cmml">f</mi><mi id="S4.SS1.1.m1.1.2.2.3" xref="S4.SS1.1.m1.1.2.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.1.m1.1.2.1" xref="S4.SS1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.1.m1.1.2.3.2" xref="S4.SS1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.1.m1.1.2.3.2.1" xref="S4.SS1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.1.m1.1.1" xref="S4.SS1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.1.m1.1.2.3.2.2" xref="S4.SS1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.1.m1.1c"><apply id="S4.SS1.1.m1.1.2.cmml" xref="S4.SS1.1.m1.1.2"><times id="S4.SS1.1.m1.1.2.1.cmml" xref="S4.SS1.1.m1.1.2.1"></times><apply id="S4.SS1.1.m1.1.2.2.cmml" xref="S4.SS1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.1.m1.1.2.2.1.cmml" xref="S4.SS1.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS1.1.m1.1.2.2.2.cmml" xref="S4.SS1.1.m1.1.2.2.2">𝑓</ci><ci id="S4.SS1.1.m1.1.2.2.3.cmml" xref="S4.SS1.1.m1.1.2.2.3">𝜽</ci></apply><ci id="S4.SS1.1.m1.1.1.cmml" xref="S4.SS1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.1.m1.1d">f_{\boldsymbol{\theta}}(\cdot)</annotation></semantics></math>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">The role of the non-linear transformation <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="f_{\boldsymbol{\theta}}({\boldsymbol{h}})" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.2" xref="S4.SS1.p1.1.m1.1.2.cmml"><msub id="S4.SS1.p1.1.m1.1.2.2" xref="S4.SS1.p1.1.m1.1.2.2.cmml"><mi id="S4.SS1.p1.1.m1.1.2.2.2" xref="S4.SS1.p1.1.m1.1.2.2.2.cmml">f</mi><mi id="S4.SS1.p1.1.m1.1.2.2.3" xref="S4.SS1.p1.1.m1.1.2.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.1.m1.1.2.1" xref="S4.SS1.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.p1.1.m1.1.2.3.2" xref="S4.SS1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.1.m1.1.2.3.2.1" xref="S4.SS1.p1.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">𝒉</mi><mo stretchy="false" id="S4.SS1.p1.1.m1.1.2.3.2.2" xref="S4.SS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.2"><times id="S4.SS1.p1.1.m1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.1"></times><apply id="S4.SS1.p1.1.m1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.2.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.2.2.2.cmml" xref="S4.SS1.p1.1.m1.1.2.2.2">𝑓</ci><ci id="S4.SS1.p1.1.m1.1.2.2.3.cmml" xref="S4.SS1.p1.1.m1.1.2.2.3">𝜽</ci></apply><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝒉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">f_{\boldsymbol{\theta}}({\boldsymbol{h}})</annotation></semantics></math> is to map the embedding of the question/image <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="{\boldsymbol{h}}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">𝒉</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝒉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">{\boldsymbol{h}}</annotation></semantics></math> to a representation suitable for the following (typically linear) classifier. This transformation can be implemented in a neural network with any type of non-linear layers. Our contributions are agnostic to this implementation choice. We follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> and use a gated hyperbolic tangent layer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, defined as</p>
<table id="A4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E1.m1.4" class="ltx_Math" alttext="\displaystyle f_{\boldsymbol{\theta}}({\boldsymbol{h}})~{}~{}=~{}~{}\sigma(W{\boldsymbol{h}}+\boldsymbol{b})~{}\circ~{}\tanh\,(W^{\prime}{\boldsymbol{h}}+\boldsymbol{b}^{\prime})" display="inline"><semantics id="S4.E1.m1.4a"><mrow id="S4.E1.m1.4.4" xref="S4.E1.m1.4.4.cmml"><mrow id="S4.E1.m1.4.4.4" xref="S4.E1.m1.4.4.4.cmml"><msub id="S4.E1.m1.4.4.4.2" xref="S4.E1.m1.4.4.4.2.cmml"><mi id="S4.E1.m1.4.4.4.2.2" xref="S4.E1.m1.4.4.4.2.2.cmml">f</mi><mi id="S4.E1.m1.4.4.4.2.3" xref="S4.E1.m1.4.4.4.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.4.1" xref="S4.E1.m1.4.4.4.1.cmml">​</mo><mrow id="S4.E1.m1.4.4.4.3.2" xref="S4.E1.m1.4.4.4.cmml"><mo stretchy="false" id="S4.E1.m1.4.4.4.3.2.1" xref="S4.E1.m1.4.4.4.cmml">(</mo><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">𝒉</mi><mo rspace="0.660em" stretchy="false" id="S4.E1.m1.4.4.4.3.2.2" xref="S4.E1.m1.4.4.4.cmml">)</mo></mrow></mrow><mo rspace="0.938em" id="S4.E1.m1.4.4.3" xref="S4.E1.m1.4.4.3.cmml">=</mo><mrow id="S4.E1.m1.4.4.2" xref="S4.E1.m1.4.4.2.cmml"><mrow id="S4.E1.m1.3.3.1.1" xref="S4.E1.m1.3.3.1.1.cmml"><mi id="S4.E1.m1.3.3.1.1.3" xref="S4.E1.m1.3.3.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.3.3.1.1.2" xref="S4.E1.m1.3.3.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.3.3.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.3.3.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.3.3.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.cmml"><mrow id="S4.E1.m1.3.3.1.1.1.1.1.2" xref="S4.E1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S4.E1.m1.3.3.1.1.1.1.1.2.2" xref="S4.E1.m1.3.3.1.1.1.1.1.2.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.3.3.1.1.1.1.1.2.1" xref="S4.E1.m1.3.3.1.1.1.1.1.2.1.cmml">​</mo><mi id="S4.E1.m1.3.3.1.1.1.1.1.2.3" xref="S4.E1.m1.3.3.1.1.1.1.1.2.3.cmml">𝒉</mi></mrow><mo id="S4.E1.m1.3.3.1.1.1.1.1.1" xref="S4.E1.m1.3.3.1.1.1.1.1.1.cmml">+</mo><mi id="S4.E1.m1.3.3.1.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.3.cmml">𝒃</mi></mrow><mo rspace="0.385em" stretchy="false" id="S4.E1.m1.3.3.1.1.1.1.3" xref="S4.E1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.552em" id="S4.E1.m1.4.4.2.3" xref="S4.E1.m1.4.4.2.3.cmml">∘</mo><mrow id="S4.E1.m1.4.4.2.2.1" xref="S4.E1.m1.4.4.2.2.2.cmml"><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">tanh</mi><mo lspace="0.170em" id="S4.E1.m1.4.4.2.2.1a" xref="S4.E1.m1.4.4.2.2.2.cmml">⁡</mo><mrow id="S4.E1.m1.4.4.2.2.1.1" xref="S4.E1.m1.4.4.2.2.2.cmml"><mo stretchy="false" id="S4.E1.m1.4.4.2.2.1.1.2" xref="S4.E1.m1.4.4.2.2.2.cmml">(</mo><mrow id="S4.E1.m1.4.4.2.2.1.1.1" xref="S4.E1.m1.4.4.2.2.1.1.1.cmml"><mrow id="S4.E1.m1.4.4.2.2.1.1.1.2" xref="S4.E1.m1.4.4.2.2.1.1.1.2.cmml"><msup id="S4.E1.m1.4.4.2.2.1.1.1.2.2" xref="S4.E1.m1.4.4.2.2.1.1.1.2.2.cmml"><mi id="S4.E1.m1.4.4.2.2.1.1.1.2.2.2" xref="S4.E1.m1.4.4.2.2.1.1.1.2.2.2.cmml">W</mi><mo id="S4.E1.m1.4.4.2.2.1.1.1.2.2.3" xref="S4.E1.m1.4.4.2.2.1.1.1.2.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="S4.E1.m1.4.4.2.2.1.1.1.2.1" xref="S4.E1.m1.4.4.2.2.1.1.1.2.1.cmml">​</mo><mi id="S4.E1.m1.4.4.2.2.1.1.1.2.3" xref="S4.E1.m1.4.4.2.2.1.1.1.2.3.cmml">𝒉</mi></mrow><mo id="S4.E1.m1.4.4.2.2.1.1.1.1" xref="S4.E1.m1.4.4.2.2.1.1.1.1.cmml">+</mo><msup id="S4.E1.m1.4.4.2.2.1.1.1.3" xref="S4.E1.m1.4.4.2.2.1.1.1.3.cmml"><mi id="S4.E1.m1.4.4.2.2.1.1.1.3.2" xref="S4.E1.m1.4.4.2.2.1.1.1.3.2.cmml">𝒃</mi><mo id="S4.E1.m1.4.4.2.2.1.1.1.3.3" xref="S4.E1.m1.4.4.2.2.1.1.1.3.3.cmml">′</mo></msup></mrow><mo stretchy="false" id="S4.E1.m1.4.4.2.2.1.1.3" xref="S4.E1.m1.4.4.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.4b"><apply id="S4.E1.m1.4.4.cmml" xref="S4.E1.m1.4.4"><eq id="S4.E1.m1.4.4.3.cmml" xref="S4.E1.m1.4.4.3"></eq><apply id="S4.E1.m1.4.4.4.cmml" xref="S4.E1.m1.4.4.4"><times id="S4.E1.m1.4.4.4.1.cmml" xref="S4.E1.m1.4.4.4.1"></times><apply id="S4.E1.m1.4.4.4.2.cmml" xref="S4.E1.m1.4.4.4.2"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.4.2.1.cmml" xref="S4.E1.m1.4.4.4.2">subscript</csymbol><ci id="S4.E1.m1.4.4.4.2.2.cmml" xref="S4.E1.m1.4.4.4.2.2">𝑓</ci><ci id="S4.E1.m1.4.4.4.2.3.cmml" xref="S4.E1.m1.4.4.4.2.3">𝜽</ci></apply><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝒉</ci></apply><apply id="S4.E1.m1.4.4.2.cmml" xref="S4.E1.m1.4.4.2"><compose id="S4.E1.m1.4.4.2.3.cmml" xref="S4.E1.m1.4.4.2.3"></compose><apply id="S4.E1.m1.3.3.1.1.cmml" xref="S4.E1.m1.3.3.1.1"><times id="S4.E1.m1.3.3.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.2"></times><ci id="S4.E1.m1.3.3.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.3">𝜎</ci><apply id="S4.E1.m1.3.3.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1"><plus id="S4.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.1"></plus><apply id="S4.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.2"><times id="S4.E1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.2.1"></times><ci id="S4.E1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.2.2">𝑊</ci><ci id="S4.E1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.2.3">𝒉</ci></apply><ci id="S4.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E1.m1.3.3.1.1.1.1.1.3">𝒃</ci></apply></apply><apply id="S4.E1.m1.4.4.2.2.2.cmml" xref="S4.E1.m1.4.4.2.2.1"><tanh id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2"></tanh><apply id="S4.E1.m1.4.4.2.2.1.1.1.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1"><plus id="S4.E1.m1.4.4.2.2.1.1.1.1.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.1"></plus><apply id="S4.E1.m1.4.4.2.2.1.1.1.2.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.2"><times id="S4.E1.m1.4.4.2.2.1.1.1.2.1.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.2.1"></times><apply id="S4.E1.m1.4.4.2.2.1.1.1.2.2.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.2.2.1.1.1.2.2.1.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.2.2">superscript</csymbol><ci id="S4.E1.m1.4.4.2.2.1.1.1.2.2.2.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.2.2.2">𝑊</ci><ci id="S4.E1.m1.4.4.2.2.1.1.1.2.2.3.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.2.2.3">′</ci></apply><ci id="S4.E1.m1.4.4.2.2.1.1.1.2.3.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.2.3">𝒉</ci></apply><apply id="S4.E1.m1.4.4.2.2.1.1.1.3.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.4.4.2.2.1.1.1.3.1.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.3">superscript</csymbol><ci id="S4.E1.m1.4.4.2.2.1.1.1.3.2.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.3.2">𝒃</ci><ci id="S4.E1.m1.4.4.2.2.1.1.1.3.3.cmml" xref="S4.E1.m1.4.4.2.2.1.1.1.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.4c">\displaystyle f_{\boldsymbol{\theta}}({\boldsymbol{h}})~{}~{}=~{}~{}\sigma(W{\boldsymbol{h}}+\boldsymbol{b})~{}\circ~{}\tanh\,(W^{\prime}{\boldsymbol{h}}+\boldsymbol{b}^{\prime})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.15" class="ltx_p">where <math id="S4.SS1.p1.3.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS1.p1.3.m1.1a"><mi id="S4.SS1.p1.3.m1.1.1" xref="S4.SS1.p1.3.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m1.1b"><ci id="S4.SS1.p1.3.m1.1.1.cmml" xref="S4.SS1.p1.3.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m1.1c">\sigma</annotation></semantics></math> is the logistic activation function, <math id="S4.SS1.p1.4.m2.2" class="ltx_Math" alttext="W,W^{\prime}\in\mathbb{R}^{D\times D}" display="inline"><semantics id="S4.SS1.p1.4.m2.2a"><mrow id="S4.SS1.p1.4.m2.2.2" xref="S4.SS1.p1.4.m2.2.2.cmml"><mrow id="S4.SS1.p1.4.m2.2.2.1.1" xref="S4.SS1.p1.4.m2.2.2.1.2.cmml"><mi id="S4.SS1.p1.4.m2.1.1" xref="S4.SS1.p1.4.m2.1.1.cmml">W</mi><mo id="S4.SS1.p1.4.m2.2.2.1.1.2" xref="S4.SS1.p1.4.m2.2.2.1.2.cmml">,</mo><msup id="S4.SS1.p1.4.m2.2.2.1.1.1" xref="S4.SS1.p1.4.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.4.m2.2.2.1.1.1.2" xref="S4.SS1.p1.4.m2.2.2.1.1.1.2.cmml">W</mi><mo id="S4.SS1.p1.4.m2.2.2.1.1.1.3" xref="S4.SS1.p1.4.m2.2.2.1.1.1.3.cmml">′</mo></msup></mrow><mo id="S4.SS1.p1.4.m2.2.2.2" xref="S4.SS1.p1.4.m2.2.2.2.cmml">∈</mo><msup id="S4.SS1.p1.4.m2.2.2.3" xref="S4.SS1.p1.4.m2.2.2.3.cmml"><mi id="S4.SS1.p1.4.m2.2.2.3.2" xref="S4.SS1.p1.4.m2.2.2.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.4.m2.2.2.3.3" xref="S4.SS1.p1.4.m2.2.2.3.3.cmml"><mi id="S4.SS1.p1.4.m2.2.2.3.3.2" xref="S4.SS1.p1.4.m2.2.2.3.3.2.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p1.4.m2.2.2.3.3.1" xref="S4.SS1.p1.4.m2.2.2.3.3.1.cmml">×</mo><mi id="S4.SS1.p1.4.m2.2.2.3.3.3" xref="S4.SS1.p1.4.m2.2.2.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m2.2b"><apply id="S4.SS1.p1.4.m2.2.2.cmml" xref="S4.SS1.p1.4.m2.2.2"><in id="S4.SS1.p1.4.m2.2.2.2.cmml" xref="S4.SS1.p1.4.m2.2.2.2"></in><list id="S4.SS1.p1.4.m2.2.2.1.2.cmml" xref="S4.SS1.p1.4.m2.2.2.1.1"><ci id="S4.SS1.p1.4.m2.1.1.cmml" xref="S4.SS1.p1.4.m2.1.1">𝑊</ci><apply id="S4.SS1.p1.4.m2.2.2.1.1.1.cmml" xref="S4.SS1.p1.4.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.4.m2.2.2.1.1.1">superscript</csymbol><ci id="S4.SS1.p1.4.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.4.m2.2.2.1.1.1.2">𝑊</ci><ci id="S4.SS1.p1.4.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.4.m2.2.2.1.1.1.3">′</ci></apply></list><apply id="S4.SS1.p1.4.m2.2.2.3.cmml" xref="S4.SS1.p1.4.m2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m2.2.2.3.1.cmml" xref="S4.SS1.p1.4.m2.2.2.3">superscript</csymbol><ci id="S4.SS1.p1.4.m2.2.2.3.2.cmml" xref="S4.SS1.p1.4.m2.2.2.3.2">ℝ</ci><apply id="S4.SS1.p1.4.m2.2.2.3.3.cmml" xref="S4.SS1.p1.4.m2.2.2.3.3"><times id="S4.SS1.p1.4.m2.2.2.3.3.1.cmml" xref="S4.SS1.p1.4.m2.2.2.3.3.1"></times><ci id="S4.SS1.p1.4.m2.2.2.3.3.2.cmml" xref="S4.SS1.p1.4.m2.2.2.3.3.2">𝐷</ci><ci id="S4.SS1.p1.4.m2.2.2.3.3.3.cmml" xref="S4.SS1.p1.4.m2.2.2.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m2.2c">W,W^{\prime}\in\mathbb{R}^{D\times D}</annotation></semantics></math> are learned weights, <math id="S4.SS1.p1.5.m3.2" class="ltx_Math" alttext="\boldsymbol{b},\boldsymbol{b}^{\prime}\in\mathbb{R}^{D}" display="inline"><semantics id="S4.SS1.p1.5.m3.2a"><mrow id="S4.SS1.p1.5.m3.2.2" xref="S4.SS1.p1.5.m3.2.2.cmml"><mrow id="S4.SS1.p1.5.m3.2.2.1.1" xref="S4.SS1.p1.5.m3.2.2.1.2.cmml"><mi id="S4.SS1.p1.5.m3.1.1" xref="S4.SS1.p1.5.m3.1.1.cmml">𝒃</mi><mo id="S4.SS1.p1.5.m3.2.2.1.1.2" xref="S4.SS1.p1.5.m3.2.2.1.2.cmml">,</mo><msup id="S4.SS1.p1.5.m3.2.2.1.1.1" xref="S4.SS1.p1.5.m3.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.5.m3.2.2.1.1.1.2" xref="S4.SS1.p1.5.m3.2.2.1.1.1.2.cmml">𝒃</mi><mo id="S4.SS1.p1.5.m3.2.2.1.1.1.3" xref="S4.SS1.p1.5.m3.2.2.1.1.1.3.cmml">′</mo></msup></mrow><mo id="S4.SS1.p1.5.m3.2.2.2" xref="S4.SS1.p1.5.m3.2.2.2.cmml">∈</mo><msup id="S4.SS1.p1.5.m3.2.2.3" xref="S4.SS1.p1.5.m3.2.2.3.cmml"><mi id="S4.SS1.p1.5.m3.2.2.3.2" xref="S4.SS1.p1.5.m3.2.2.3.2.cmml">ℝ</mi><mi id="S4.SS1.p1.5.m3.2.2.3.3" xref="S4.SS1.p1.5.m3.2.2.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m3.2b"><apply id="S4.SS1.p1.5.m3.2.2.cmml" xref="S4.SS1.p1.5.m3.2.2"><in id="S4.SS1.p1.5.m3.2.2.2.cmml" xref="S4.SS1.p1.5.m3.2.2.2"></in><list id="S4.SS1.p1.5.m3.2.2.1.2.cmml" xref="S4.SS1.p1.5.m3.2.2.1.1"><ci id="S4.SS1.p1.5.m3.1.1.cmml" xref="S4.SS1.p1.5.m3.1.1">𝒃</ci><apply id="S4.SS1.p1.5.m3.2.2.1.1.1.cmml" xref="S4.SS1.p1.5.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m3.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.5.m3.2.2.1.1.1">superscript</csymbol><ci id="S4.SS1.p1.5.m3.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.5.m3.2.2.1.1.1.2">𝒃</ci><ci id="S4.SS1.p1.5.m3.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.5.m3.2.2.1.1.1.3">′</ci></apply></list><apply id="S4.SS1.p1.5.m3.2.2.3.cmml" xref="S4.SS1.p1.5.m3.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m3.2.2.3.1.cmml" xref="S4.SS1.p1.5.m3.2.2.3">superscript</csymbol><ci id="S4.SS1.p1.5.m3.2.2.3.2.cmml" xref="S4.SS1.p1.5.m3.2.2.3.2">ℝ</ci><ci id="S4.SS1.p1.5.m3.2.2.3.3.cmml" xref="S4.SS1.p1.5.m3.2.2.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m3.2c">\boldsymbol{b},\boldsymbol{b}^{\prime}\in\mathbb{R}^{D}</annotation></semantics></math> are learned biases, and <math id="S4.SS1.p1.6.m4.1" class="ltx_Math" alttext="\circ" display="inline"><semantics id="S4.SS1.p1.6.m4.1a"><mo id="S4.SS1.p1.6.m4.1.1" xref="S4.SS1.p1.6.m4.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m4.1b"><compose id="S4.SS1.p1.6.m4.1.1.cmml" xref="S4.SS1.p1.6.m4.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m4.1c">\circ</annotation></semantics></math> is the Hadamard (element-wise) product. For notation purposes, we define the parameters <math id="S4.SS1.p1.7.m5.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}" display="inline"><semantics id="S4.SS1.p1.7.m5.1a"><mi id="S4.SS1.p1.7.m5.1.1" xref="S4.SS1.p1.7.m5.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m5.1b"><ci id="S4.SS1.p1.7.m5.1.1.cmml" xref="S4.SS1.p1.7.m5.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m5.1c">{\boldsymbol{\theta}}</annotation></semantics></math> as the concatenation of the vectorized weights and biases, <em id="S4.SS1.p1.15.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS1.p1.15.2" class="ltx_text"></span> <math id="S4.SS1.p1.8.m6.4" class="ltx_Math" alttext="{\boldsymbol{\theta}}=[W_{:};W^{\prime}_{:};\boldsymbol{b};\boldsymbol{b}^{\prime}]" display="inline"><semantics id="S4.SS1.p1.8.m6.4a"><mrow id="S4.SS1.p1.8.m6.4.4" xref="S4.SS1.p1.8.m6.4.4.cmml"><mi id="S4.SS1.p1.8.m6.4.4.5" xref="S4.SS1.p1.8.m6.4.4.5.cmml">𝜽</mi><mo id="S4.SS1.p1.8.m6.4.4.4" xref="S4.SS1.p1.8.m6.4.4.4.cmml">=</mo><mrow id="S4.SS1.p1.8.m6.4.4.3.3" xref="S4.SS1.p1.8.m6.4.4.3.4.cmml"><mo stretchy="false" id="S4.SS1.p1.8.m6.4.4.3.3.4" xref="S4.SS1.p1.8.m6.4.4.3.4.cmml">[</mo><msub id="S4.SS1.p1.8.m6.2.2.1.1.1" xref="S4.SS1.p1.8.m6.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.8.m6.2.2.1.1.1.2" xref="S4.SS1.p1.8.m6.2.2.1.1.1.2.cmml">W</mi><mo id="S4.SS1.p1.8.m6.2.2.1.1.1.3" xref="S4.SS1.p1.8.m6.2.2.1.1.1.3.cmml">:</mo></msub><mo id="S4.SS1.p1.8.m6.4.4.3.3.5" xref="S4.SS1.p1.8.m6.4.4.3.4.cmml">;</mo><msubsup id="S4.SS1.p1.8.m6.3.3.2.2.2" xref="S4.SS1.p1.8.m6.3.3.2.2.2.cmml"><mi id="S4.SS1.p1.8.m6.3.3.2.2.2.2.2" xref="S4.SS1.p1.8.m6.3.3.2.2.2.2.2.cmml">W</mi><mo id="S4.SS1.p1.8.m6.3.3.2.2.2.3" xref="S4.SS1.p1.8.m6.3.3.2.2.2.3.cmml">:</mo><mo id="S4.SS1.p1.8.m6.3.3.2.2.2.2.3" xref="S4.SS1.p1.8.m6.3.3.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S4.SS1.p1.8.m6.4.4.3.3.6" xref="S4.SS1.p1.8.m6.4.4.3.4.cmml">;</mo><mi id="S4.SS1.p1.8.m6.1.1" xref="S4.SS1.p1.8.m6.1.1.cmml">𝒃</mi><mo id="S4.SS1.p1.8.m6.4.4.3.3.7" xref="S4.SS1.p1.8.m6.4.4.3.4.cmml">;</mo><msup id="S4.SS1.p1.8.m6.4.4.3.3.3" xref="S4.SS1.p1.8.m6.4.4.3.3.3.cmml"><mi id="S4.SS1.p1.8.m6.4.4.3.3.3.2" xref="S4.SS1.p1.8.m6.4.4.3.3.3.2.cmml">𝒃</mi><mo id="S4.SS1.p1.8.m6.4.4.3.3.3.3" xref="S4.SS1.p1.8.m6.4.4.3.3.3.3.cmml">′</mo></msup><mo stretchy="false" id="S4.SS1.p1.8.m6.4.4.3.3.8" xref="S4.SS1.p1.8.m6.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m6.4b"><apply id="S4.SS1.p1.8.m6.4.4.cmml" xref="S4.SS1.p1.8.m6.4.4"><eq id="S4.SS1.p1.8.m6.4.4.4.cmml" xref="S4.SS1.p1.8.m6.4.4.4"></eq><ci id="S4.SS1.p1.8.m6.4.4.5.cmml" xref="S4.SS1.p1.8.m6.4.4.5">𝜽</ci><list id="S4.SS1.p1.8.m6.4.4.3.4.cmml" xref="S4.SS1.p1.8.m6.4.4.3.3"><apply id="S4.SS1.p1.8.m6.2.2.1.1.1.cmml" xref="S4.SS1.p1.8.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m6.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.8.m6.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.8.m6.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.8.m6.2.2.1.1.1.2">𝑊</ci><ci id="S4.SS1.p1.8.m6.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.8.m6.2.2.1.1.1.3">:</ci></apply><apply id="S4.SS1.p1.8.m6.3.3.2.2.2.cmml" xref="S4.SS1.p1.8.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m6.3.3.2.2.2.1.cmml" xref="S4.SS1.p1.8.m6.3.3.2.2.2">subscript</csymbol><apply id="S4.SS1.p1.8.m6.3.3.2.2.2.2.cmml" xref="S4.SS1.p1.8.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m6.3.3.2.2.2.2.1.cmml" xref="S4.SS1.p1.8.m6.3.3.2.2.2">superscript</csymbol><ci id="S4.SS1.p1.8.m6.3.3.2.2.2.2.2.cmml" xref="S4.SS1.p1.8.m6.3.3.2.2.2.2.2">𝑊</ci><ci id="S4.SS1.p1.8.m6.3.3.2.2.2.2.3.cmml" xref="S4.SS1.p1.8.m6.3.3.2.2.2.2.3">′</ci></apply><ci id="S4.SS1.p1.8.m6.3.3.2.2.2.3.cmml" xref="S4.SS1.p1.8.m6.3.3.2.2.2.3">:</ci></apply><ci id="S4.SS1.p1.8.m6.1.1.cmml" xref="S4.SS1.p1.8.m6.1.1">𝒃</ci><apply id="S4.SS1.p1.8.m6.4.4.3.3.3.cmml" xref="S4.SS1.p1.8.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m6.4.4.3.3.3.1.cmml" xref="S4.SS1.p1.8.m6.4.4.3.3.3">superscript</csymbol><ci id="S4.SS1.p1.8.m6.4.4.3.3.3.2.cmml" xref="S4.SS1.p1.8.m6.4.4.3.3.3.2">𝒃</ci><ci id="S4.SS1.p1.8.m6.4.4.3.3.3.3.cmml" xref="S4.SS1.p1.8.m6.4.4.3.3.3.3">′</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m6.4c">{\boldsymbol{\theta}}=[W_{:};W^{\prime}_{:};\boldsymbol{b};\boldsymbol{b}^{\prime}]</annotation></semantics></math>. This vector thus contains all of the weights and biases used by the non-linear transformation. A traditional model would learn the weights <math id="S4.SS1.p1.9.m7.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}" display="inline"><semantics id="S4.SS1.p1.9.m7.1a"><mi id="S4.SS1.p1.9.m7.1.1" xref="S4.SS1.p1.9.m7.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m7.1b"><ci id="S4.SS1.p1.9.m7.1.1.cmml" xref="S4.SS1.p1.9.m7.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m7.1c">{\boldsymbol{\theta}}</annotation></semantics></math> by backpropagation and gradient descent on the training set, and they would be held static during test time. We propose instead to adaptively adjust the weights at test time, depending on the input <math id="S4.SS1.p1.10.m8.1" class="ltx_Math" alttext="{\boldsymbol{h}}" display="inline"><semantics id="S4.SS1.p1.10.m8.1a"><mi id="S4.SS1.p1.10.m8.1.1" xref="S4.SS1.p1.10.m8.1.1.cmml">𝒉</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m8.1b"><ci id="S4.SS1.p1.10.m8.1.1.cmml" xref="S4.SS1.p1.10.m8.1.1">𝒉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m8.1c">{\boldsymbol{h}}</annotation></semantics></math> and the available support set. Concretely, we use a combination of static parameters <math id="S4.SS1.p1.11.m9.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}^{\mathsf{s}}" display="inline"><semantics id="S4.SS1.p1.11.m9.1a"><msup id="S4.SS1.p1.11.m9.1.1" xref="S4.SS1.p1.11.m9.1.1.cmml"><mi id="S4.SS1.p1.11.m9.1.1.2" xref="S4.SS1.p1.11.m9.1.1.2.cmml">𝜽</mi><mi id="S4.SS1.p1.11.m9.1.1.3" xref="S4.SS1.p1.11.m9.1.1.3.cmml">𝗌</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m9.1b"><apply id="S4.SS1.p1.11.m9.1.1.cmml" xref="S4.SS1.p1.11.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m9.1.1.1.cmml" xref="S4.SS1.p1.11.m9.1.1">superscript</csymbol><ci id="S4.SS1.p1.11.m9.1.1.2.cmml" xref="S4.SS1.p1.11.m9.1.1.2">𝜽</ci><ci id="S4.SS1.p1.11.m9.1.1.3.cmml" xref="S4.SS1.p1.11.m9.1.1.3">𝗌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m9.1c">{\boldsymbol{\theta}}^{\mathsf{s}}</annotation></semantics></math> learned in the traditional manner, and dynamic ones <math id="S4.SS1.p1.12.m10.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}^{\mathsf{d}}" display="inline"><semantics id="S4.SS1.p1.12.m10.1a"><msup id="S4.SS1.p1.12.m10.1.1" xref="S4.SS1.p1.12.m10.1.1.cmml"><mi id="S4.SS1.p1.12.m10.1.1.2" xref="S4.SS1.p1.12.m10.1.1.2.cmml">𝜽</mi><mi id="S4.SS1.p1.12.m10.1.1.3" xref="S4.SS1.p1.12.m10.1.1.3.cmml">𝖽</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m10.1b"><apply id="S4.SS1.p1.12.m10.1.1.cmml" xref="S4.SS1.p1.12.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m10.1.1.1.cmml" xref="S4.SS1.p1.12.m10.1.1">superscript</csymbol><ci id="S4.SS1.p1.12.m10.1.1.2.cmml" xref="S4.SS1.p1.12.m10.1.1.2">𝜽</ci><ci id="S4.SS1.p1.12.m10.1.1.3.cmml" xref="S4.SS1.p1.12.m10.1.1.3">𝖽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m10.1c">{\boldsymbol{\theta}}^{\mathsf{d}}</annotation></semantics></math> determined at test time. They are combined as <math id="S4.SS1.p1.13.m11.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}={\boldsymbol{\theta}}^{\mathsf{s}}\,+\,{\boldsymbol{w}}{\boldsymbol{\theta}}^{\mathsf{d}}" display="inline"><semantics id="S4.SS1.p1.13.m11.1a"><mrow id="S4.SS1.p1.13.m11.1.1" xref="S4.SS1.p1.13.m11.1.1.cmml"><mi id="S4.SS1.p1.13.m11.1.1.2" xref="S4.SS1.p1.13.m11.1.1.2.cmml">𝜽</mi><mo id="S4.SS1.p1.13.m11.1.1.1" xref="S4.SS1.p1.13.m11.1.1.1.cmml">=</mo><mrow id="S4.SS1.p1.13.m11.1.1.3" xref="S4.SS1.p1.13.m11.1.1.3.cmml"><msup id="S4.SS1.p1.13.m11.1.1.3.2" xref="S4.SS1.p1.13.m11.1.1.3.2.cmml"><mi id="S4.SS1.p1.13.m11.1.1.3.2.2" xref="S4.SS1.p1.13.m11.1.1.3.2.2.cmml">𝜽</mi><mi id="S4.SS1.p1.13.m11.1.1.3.2.3" xref="S4.SS1.p1.13.m11.1.1.3.2.3.cmml">𝗌</mi></msup><mo rspace="0.392em" id="S4.SS1.p1.13.m11.1.1.3.1" xref="S4.SS1.p1.13.m11.1.1.3.1.cmml">+</mo><mrow id="S4.SS1.p1.13.m11.1.1.3.3" xref="S4.SS1.p1.13.m11.1.1.3.3.cmml"><mi id="S4.SS1.p1.13.m11.1.1.3.3.2" xref="S4.SS1.p1.13.m11.1.1.3.3.2.cmml">𝒘</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.13.m11.1.1.3.3.1" xref="S4.SS1.p1.13.m11.1.1.3.3.1.cmml">​</mo><msup id="S4.SS1.p1.13.m11.1.1.3.3.3" xref="S4.SS1.p1.13.m11.1.1.3.3.3.cmml"><mi id="S4.SS1.p1.13.m11.1.1.3.3.3.2" xref="S4.SS1.p1.13.m11.1.1.3.3.3.2.cmml">𝜽</mi><mi id="S4.SS1.p1.13.m11.1.1.3.3.3.3" xref="S4.SS1.p1.13.m11.1.1.3.3.3.3.cmml">𝖽</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m11.1b"><apply id="S4.SS1.p1.13.m11.1.1.cmml" xref="S4.SS1.p1.13.m11.1.1"><eq id="S4.SS1.p1.13.m11.1.1.1.cmml" xref="S4.SS1.p1.13.m11.1.1.1"></eq><ci id="S4.SS1.p1.13.m11.1.1.2.cmml" xref="S4.SS1.p1.13.m11.1.1.2">𝜽</ci><apply id="S4.SS1.p1.13.m11.1.1.3.cmml" xref="S4.SS1.p1.13.m11.1.1.3"><plus id="S4.SS1.p1.13.m11.1.1.3.1.cmml" xref="S4.SS1.p1.13.m11.1.1.3.1"></plus><apply id="S4.SS1.p1.13.m11.1.1.3.2.cmml" xref="S4.SS1.p1.13.m11.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m11.1.1.3.2.1.cmml" xref="S4.SS1.p1.13.m11.1.1.3.2">superscript</csymbol><ci id="S4.SS1.p1.13.m11.1.1.3.2.2.cmml" xref="S4.SS1.p1.13.m11.1.1.3.2.2">𝜽</ci><ci id="S4.SS1.p1.13.m11.1.1.3.2.3.cmml" xref="S4.SS1.p1.13.m11.1.1.3.2.3">𝗌</ci></apply><apply id="S4.SS1.p1.13.m11.1.1.3.3.cmml" xref="S4.SS1.p1.13.m11.1.1.3.3"><times id="S4.SS1.p1.13.m11.1.1.3.3.1.cmml" xref="S4.SS1.p1.13.m11.1.1.3.3.1"></times><ci id="S4.SS1.p1.13.m11.1.1.3.3.2.cmml" xref="S4.SS1.p1.13.m11.1.1.3.3.2">𝒘</ci><apply id="S4.SS1.p1.13.m11.1.1.3.3.3.cmml" xref="S4.SS1.p1.13.m11.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m11.1.1.3.3.3.1.cmml" xref="S4.SS1.p1.13.m11.1.1.3.3.3">superscript</csymbol><ci id="S4.SS1.p1.13.m11.1.1.3.3.3.2.cmml" xref="S4.SS1.p1.13.m11.1.1.3.3.3.2">𝜽</ci><ci id="S4.SS1.p1.13.m11.1.1.3.3.3.3.cmml" xref="S4.SS1.p1.13.m11.1.1.3.3.3.3">𝖽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m11.1c">{\boldsymbol{\theta}}={\boldsymbol{\theta}}^{\mathsf{s}}\,+\,{\boldsymbol{w}}{\boldsymbol{\theta}}^{\mathsf{d}}</annotation></semantics></math>, with <math id="S4.SS1.p1.14.m12.1" class="ltx_Math" alttext="{\boldsymbol{w}}^{\prime\prime}\in\mathbb{R}^{D}" display="inline"><semantics id="S4.SS1.p1.14.m12.1a"><mrow id="S4.SS1.p1.14.m12.1.1" xref="S4.SS1.p1.14.m12.1.1.cmml"><msup id="S4.SS1.p1.14.m12.1.1.2" xref="S4.SS1.p1.14.m12.1.1.2.cmml"><mi id="S4.SS1.p1.14.m12.1.1.2.2" xref="S4.SS1.p1.14.m12.1.1.2.2.cmml">𝒘</mi><mo id="S4.SS1.p1.14.m12.1.1.2.3" xref="S4.SS1.p1.14.m12.1.1.2.3.cmml">′′</mo></msup><mo id="S4.SS1.p1.14.m12.1.1.1" xref="S4.SS1.p1.14.m12.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.14.m12.1.1.3" xref="S4.SS1.p1.14.m12.1.1.3.cmml"><mi id="S4.SS1.p1.14.m12.1.1.3.2" xref="S4.SS1.p1.14.m12.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS1.p1.14.m12.1.1.3.3" xref="S4.SS1.p1.14.m12.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m12.1b"><apply id="S4.SS1.p1.14.m12.1.1.cmml" xref="S4.SS1.p1.14.m12.1.1"><in id="S4.SS1.p1.14.m12.1.1.1.cmml" xref="S4.SS1.p1.14.m12.1.1.1"></in><apply id="S4.SS1.p1.14.m12.1.1.2.cmml" xref="S4.SS1.p1.14.m12.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m12.1.1.2.1.cmml" xref="S4.SS1.p1.14.m12.1.1.2">superscript</csymbol><ci id="S4.SS1.p1.14.m12.1.1.2.2.cmml" xref="S4.SS1.p1.14.m12.1.1.2.2">𝒘</ci><ci id="S4.SS1.p1.14.m12.1.1.2.3.cmml" xref="S4.SS1.p1.14.m12.1.1.2.3">′′</ci></apply><apply id="S4.SS1.p1.14.m12.1.1.3.cmml" xref="S4.SS1.p1.14.m12.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m12.1.1.3.1.cmml" xref="S4.SS1.p1.14.m12.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.14.m12.1.1.3.2.cmml" xref="S4.SS1.p1.14.m12.1.1.3.2">ℝ</ci><ci id="S4.SS1.p1.14.m12.1.1.3.3.cmml" xref="S4.SS1.p1.14.m12.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m12.1c">{\boldsymbol{w}}^{\prime\prime}\in\mathbb{R}^{D}</annotation></semantics></math> a vector of learned weights. The dynamic weights can therefore be seen as an adjustment made to the static ones depending on the input <math id="S4.SS1.p1.15.m13.1" class="ltx_Math" alttext="{\boldsymbol{h}}" display="inline"><semantics id="S4.SS1.p1.15.m13.1a"><mi id="S4.SS1.p1.15.m13.1.1" xref="S4.SS1.p1.15.m13.1.1.cmml">𝒉</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m13.1b"><ci id="S4.SS1.p1.15.m13.1.1.cmml" xref="S4.SS1.p1.15.m13.1.1">𝒉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.15.m13.1c">{\boldsymbol{h}}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.5" class="ltx_p">A set of candidate dynamic weights are maintained in an associative memory <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="{\mathcal{M}}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">{\mathcal{M}}</annotation></semantics></math>. This memory is a large set (as large as the support set, see Section <a href="#S4.SS2" title="4.2 Processing of Support Set ‣ 4 Proposed Model ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>) of key/value pairs <math id="S4.SS1.p2.2.m2.3" class="ltx_Math" alttext="{\mathcal{M}}=\{(\tilde{{\boldsymbol{h}}_{i}},\tilde{{\boldsymbol{\theta}}}^{\mathsf{d}}_{i})\}_{i\in 1\ldots|{\mathcal{S}}|}" display="inline"><semantics id="S4.SS1.p2.2.m2.3a"><mrow id="S4.SS1.p2.2.m2.3.3" xref="S4.SS1.p2.2.m2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.2.m2.3.3.3" xref="S4.SS1.p2.2.m2.3.3.3.cmml">ℳ</mi><mo id="S4.SS1.p2.2.m2.3.3.2" xref="S4.SS1.p2.2.m2.3.3.2.cmml">=</mo><msub id="S4.SS1.p2.2.m2.3.3.1" xref="S4.SS1.p2.2.m2.3.3.1.cmml"><mrow id="S4.SS1.p2.2.m2.3.3.1.1.1" xref="S4.SS1.p2.2.m2.3.3.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.2.m2.3.3.1.1.1.2" xref="S4.SS1.p2.2.m2.3.3.1.1.2.cmml">{</mo><mrow id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.2" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.cmml">(</mo><mover accent="true" id="S4.SS1.p2.2.m2.2.2" xref="S4.SS1.p2.2.m2.2.2.cmml"><msub id="S4.SS1.p2.2.m2.2.2.2" xref="S4.SS1.p2.2.m2.2.2.2.cmml"><mi id="S4.SS1.p2.2.m2.2.2.2.2" xref="S4.SS1.p2.2.m2.2.2.2.2.cmml">𝒉</mi><mi id="S4.SS1.p2.2.m2.2.2.2.3" xref="S4.SS1.p2.2.m2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS1.p2.2.m2.2.2.1" xref="S4.SS1.p2.2.m2.2.2.1.cmml">~</mo></mover><mo id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.3" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.cmml">,</mo><msubsup id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2.2" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2.2.cmml">𝜽</mi><mo id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2.1" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.3" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.3.cmml">i</mi><mi id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.3" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.3.cmml">𝖽</mi></msubsup><mo stretchy="false" id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.4" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.cmml">)</mo></mrow><mo stretchy="false" id="S4.SS1.p2.2.m2.3.3.1.1.1.3" xref="S4.SS1.p2.2.m2.3.3.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.1.3" xref="S4.SS1.p2.2.m2.1.1.1.3.cmml">i</mi><mo id="S4.SS1.p2.2.m2.1.1.1.2" xref="S4.SS1.p2.2.m2.1.1.1.2.cmml">∈</mo><mrow id="S4.SS1.p2.2.m2.1.1.1.4" xref="S4.SS1.p2.2.m2.1.1.1.4.cmml"><mn id="S4.SS1.p2.2.m2.1.1.1.4.2" xref="S4.SS1.p2.2.m2.1.1.1.4.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p2.2.m2.1.1.1.4.1" xref="S4.SS1.p2.2.m2.1.1.1.4.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS1.p2.2.m2.1.1.1.4.3" xref="S4.SS1.p2.2.m2.1.1.1.4.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.2.m2.1.1.1.4.1a" xref="S4.SS1.p2.2.m2.1.1.1.4.1.cmml">​</mo><mrow id="S4.SS1.p2.2.m2.1.1.1.4.4.2" xref="S4.SS1.p2.2.m2.1.1.1.4.4.1.cmml"><mo stretchy="false" id="S4.SS1.p2.2.m2.1.1.1.4.4.2.1" xref="S4.SS1.p2.2.m2.1.1.1.4.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.2.m2.1.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.1.cmml">𝒮</mi><mo stretchy="false" id="S4.SS1.p2.2.m2.1.1.1.4.4.2.2" xref="S4.SS1.p2.2.m2.1.1.1.4.4.1.1.cmml">|</mo></mrow></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.3b"><apply id="S4.SS1.p2.2.m2.3.3.cmml" xref="S4.SS1.p2.2.m2.3.3"><eq id="S4.SS1.p2.2.m2.3.3.2.cmml" xref="S4.SS1.p2.2.m2.3.3.2"></eq><ci id="S4.SS1.p2.2.m2.3.3.3.cmml" xref="S4.SS1.p2.2.m2.3.3.3">ℳ</ci><apply id="S4.SS1.p2.2.m2.3.3.1.cmml" xref="S4.SS1.p2.2.m2.3.3.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.1.2.cmml" xref="S4.SS1.p2.2.m2.3.3.1">subscript</csymbol><set id="S4.SS1.p2.2.m2.3.3.1.1.2.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1"><interval closure="open" id="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1"><apply id="S4.SS1.p2.2.m2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2"><ci id="S4.SS1.p2.2.m2.2.2.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1">~</ci><apply id="S4.SS1.p2.2.m2.2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.2.2.2.1.cmml" xref="S4.SS1.p2.2.m2.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.2.m2.2.2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2.2.2">𝒉</ci><ci id="S4.SS1.p2.2.m2.2.2.2.3.cmml" xref="S4.SS1.p2.2.m2.2.2.2.3">𝑖</ci></apply></apply><apply id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2"><ci id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2.1">~</ci><ci id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.2.2">𝜽</ci></apply><ci id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.2.3">𝖽</ci></apply><ci id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.1.3">𝑖</ci></apply></interval></set><apply id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"><in id="S4.SS1.p2.2.m2.1.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.1.2"></in><ci id="S4.SS1.p2.2.m2.1.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.1.3">𝑖</ci><apply id="S4.SS1.p2.2.m2.1.1.1.4.cmml" xref="S4.SS1.p2.2.m2.1.1.1.4"><times id="S4.SS1.p2.2.m2.1.1.1.4.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1.4.1"></times><cn type="integer" id="S4.SS1.p2.2.m2.1.1.1.4.2.cmml" xref="S4.SS1.p2.2.m2.1.1.1.4.2">1</cn><ci id="S4.SS1.p2.2.m2.1.1.1.4.3.cmml" xref="S4.SS1.p2.2.m2.1.1.1.4.3">…</ci><apply id="S4.SS1.p2.2.m2.1.1.1.4.4.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1.4.4.2"><abs id="S4.SS1.p2.2.m2.1.1.1.4.4.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1.4.4.2.1"></abs><ci id="S4.SS1.p2.2.m2.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1.1">𝒮</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.3c">{\mathcal{M}}=\{(\tilde{{\boldsymbol{h}}_{i}},\tilde{{\boldsymbol{\theta}}}^{\mathsf{d}}_{i})\}_{i\in 1\ldots|{\mathcal{S}}|}</annotation></semantics></math>. The interpretation for <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\tilde{{\boldsymbol{\theta}}}^{\mathsf{d}}_{i}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><msubsup id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mover accent="true" id="S4.SS1.p2.3.m3.1.1.2.2" xref="S4.SS1.p2.3.m3.1.1.2.2.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2.2.2" xref="S4.SS1.p2.3.m3.1.1.2.2.2.cmml">𝜽</mi><mo id="S4.SS1.p2.3.m3.1.1.2.2.1" xref="S4.SS1.p2.3.m3.1.1.2.2.1.cmml">~</mo></mover><mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">i</mi><mi id="S4.SS1.p2.3.m3.1.1.2.3" xref="S4.SS1.p2.3.m3.1.1.2.3.cmml">𝖽</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">subscript</csymbol><apply id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.2.1.cmml" xref="S4.SS1.p2.3.m3.1.1">superscript</csymbol><apply id="S4.SS1.p2.3.m3.1.1.2.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2.2"><ci id="S4.SS1.p2.3.m3.1.1.2.2.1.cmml" xref="S4.SS1.p2.3.m3.1.1.2.2.1">~</ci><ci id="S4.SS1.p2.3.m3.1.1.2.2.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2.2.2">𝜽</ci></apply><ci id="S4.SS1.p2.3.m3.1.1.2.3.cmml" xref="S4.SS1.p2.3.m3.1.1.2.3">𝖽</ci></apply><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\tilde{{\boldsymbol{\theta}}}^{\mathsf{d}}_{i}</annotation></semantics></math> is of dynamic weights suited to an input similar to <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="\tilde{{\boldsymbol{h}}_{i}}" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mover accent="true" id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><msub id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml"><mi id="S4.SS1.p2.4.m4.1.1.2.2" xref="S4.SS1.p2.4.m4.1.1.2.2.cmml">𝒉</mi><mi id="S4.SS1.p2.4.m4.1.1.2.3" xref="S4.SS1.p2.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.p2.4.m4.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><ci id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1">~</ci><apply id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.2.1.cmml" xref="S4.SS1.p2.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.2.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2.2">𝒉</ci><ci id="S4.SS1.p2.4.m4.1.1.2.3.cmml" xref="S4.SS1.p2.4.m4.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\tilde{{\boldsymbol{h}}_{i}}</annotation></semantics></math>. Therefore, at test time, we retrieve appropriate dynamic weights <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}^{\mathsf{d}}" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><msup id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">𝜽</mi><mi id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml">𝖽</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">𝜽</ci><ci id="S4.SS1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3">𝖽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">{\boldsymbol{\theta}}^{\mathsf{d}}</annotation></semantics></math> by soft key matching:</p>
<table id="A4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E2.m1.4" class="ltx_Math" alttext="\displaystyle{\boldsymbol{\theta}}^{\mathsf{d}}~{}~{}=~{}~{}\sum_{i}\tilde{{\boldsymbol{\theta}}}^{\mathsf{d}}_{i}\;\operatorname*{softmax}_{i}\big{(}d_{\mathsf{cos}}({\boldsymbol{h}},\tilde{{\boldsymbol{h}}_{i}})\big{)}" display="inline"><semantics id="S4.E2.m1.4a"><mrow id="S4.E2.m1.4.4" xref="S4.E2.m1.4.4.cmml"><msup id="S4.E2.m1.4.4.4" xref="S4.E2.m1.4.4.4.cmml"><mi id="S4.E2.m1.4.4.4.2" xref="S4.E2.m1.4.4.4.2.cmml">𝜽</mi><mi id="S4.E2.m1.4.4.4.3" xref="S4.E2.m1.4.4.4.3.cmml">𝖽</mi></msup><mo lspace="0.938em" rspace="0.938em" id="S4.E2.m1.4.4.3" xref="S4.E2.m1.4.4.3.cmml">=</mo><mrow id="S4.E2.m1.4.4.2" xref="S4.E2.m1.4.4.2.cmml"><mstyle displaystyle="true" id="S4.E2.m1.4.4.2.3" xref="S4.E2.m1.4.4.2.3.cmml"><munder id="S4.E2.m1.4.4.2.3a" xref="S4.E2.m1.4.4.2.3.cmml"><mo movablelimits="false" id="S4.E2.m1.4.4.2.3.2" xref="S4.E2.m1.4.4.2.3.2.cmml">∑</mo><mi id="S4.E2.m1.4.4.2.3.3" xref="S4.E2.m1.4.4.2.3.3.cmml">i</mi></munder></mstyle><mrow id="S4.E2.m1.4.4.2.2" xref="S4.E2.m1.4.4.2.2.cmml"><msubsup id="S4.E2.m1.4.4.2.2.4" xref="S4.E2.m1.4.4.2.2.4.cmml"><mover accent="true" id="S4.E2.m1.4.4.2.2.4.2.2" xref="S4.E2.m1.4.4.2.2.4.2.2.cmml"><mi id="S4.E2.m1.4.4.2.2.4.2.2.2" xref="S4.E2.m1.4.4.2.2.4.2.2.2.cmml">𝜽</mi><mo id="S4.E2.m1.4.4.2.2.4.2.2.1" xref="S4.E2.m1.4.4.2.2.4.2.2.1.cmml">~</mo></mover><mi id="S4.E2.m1.4.4.2.2.4.3" xref="S4.E2.m1.4.4.2.2.4.3.cmml">i</mi><mi id="S4.E2.m1.4.4.2.2.4.2.3" xref="S4.E2.m1.4.4.2.2.4.2.3.cmml">𝖽</mi></msubsup><mo lspace="0.167em" rspace="0em" id="S4.E2.m1.4.4.2.2.3" xref="S4.E2.m1.4.4.2.2.3.cmml">​</mo><mrow id="S4.E2.m1.4.4.2.2.2.2" xref="S4.E2.m1.4.4.2.2.2.3.cmml"><munder id="S4.E2.m1.3.3.1.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.1.cmml"><mo rspace="0em" id="S4.E2.m1.3.3.1.1.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.1.1.2.cmml">softmax</mo><mi id="S4.E2.m1.3.3.1.1.1.1.1.3" xref="S4.E2.m1.3.3.1.1.1.1.1.3.cmml">i</mi></munder><mrow id="S4.E2.m1.4.4.2.2.2.2.2" xref="S4.E2.m1.4.4.2.2.2.3.cmml"><mo maxsize="120%" minsize="120%" id="S4.E2.m1.4.4.2.2.2.2.2.2" xref="S4.E2.m1.4.4.2.2.2.3.cmml">(</mo><mrow id="S4.E2.m1.4.4.2.2.2.2.2.1" xref="S4.E2.m1.4.4.2.2.2.2.2.1.cmml"><msub id="S4.E2.m1.4.4.2.2.2.2.2.1.2" xref="S4.E2.m1.4.4.2.2.2.2.2.1.2.cmml"><mi id="S4.E2.m1.4.4.2.2.2.2.2.1.2.2" xref="S4.E2.m1.4.4.2.2.2.2.2.1.2.2.cmml">d</mi><mi id="S4.E2.m1.4.4.2.2.2.2.2.1.2.3" xref="S4.E2.m1.4.4.2.2.2.2.2.1.2.3.cmml">𝖼𝗈𝗌</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.4.4.2.2.2.2.2.1.1" xref="S4.E2.m1.4.4.2.2.2.2.2.1.1.cmml">​</mo><mrow id="S4.E2.m1.4.4.2.2.2.2.2.1.3.2" xref="S4.E2.m1.4.4.2.2.2.2.2.1.3.1.cmml"><mo stretchy="false" id="S4.E2.m1.4.4.2.2.2.2.2.1.3.2.1" xref="S4.E2.m1.4.4.2.2.2.2.2.1.3.1.cmml">(</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">𝒉</mi><mo id="S4.E2.m1.4.4.2.2.2.2.2.1.3.2.2" xref="S4.E2.m1.4.4.2.2.2.2.2.1.3.1.cmml">,</mo><mover accent="true" id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml"><msub id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml"><mi id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml">𝒉</mi><mi id="S4.E2.m1.2.2.2.3" xref="S4.E2.m1.2.2.2.3.cmml">i</mi></msub><mo id="S4.E2.m1.2.2.1" xref="S4.E2.m1.2.2.1.cmml">~</mo></mover><mo stretchy="false" id="S4.E2.m1.4.4.2.2.2.2.2.1.3.2.3" xref="S4.E2.m1.4.4.2.2.2.2.2.1.3.1.cmml">)</mo></mrow></mrow><mo maxsize="120%" minsize="120%" id="S4.E2.m1.4.4.2.2.2.2.2.3" xref="S4.E2.m1.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.4b"><apply id="S4.E2.m1.4.4.cmml" xref="S4.E2.m1.4.4"><eq id="S4.E2.m1.4.4.3.cmml" xref="S4.E2.m1.4.4.3"></eq><apply id="S4.E2.m1.4.4.4.cmml" xref="S4.E2.m1.4.4.4"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.4.1.cmml" xref="S4.E2.m1.4.4.4">superscript</csymbol><ci id="S4.E2.m1.4.4.4.2.cmml" xref="S4.E2.m1.4.4.4.2">𝜽</ci><ci id="S4.E2.m1.4.4.4.3.cmml" xref="S4.E2.m1.4.4.4.3">𝖽</ci></apply><apply id="S4.E2.m1.4.4.2.cmml" xref="S4.E2.m1.4.4.2"><apply id="S4.E2.m1.4.4.2.3.cmml" xref="S4.E2.m1.4.4.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.2.3.1.cmml" xref="S4.E2.m1.4.4.2.3">subscript</csymbol><sum id="S4.E2.m1.4.4.2.3.2.cmml" xref="S4.E2.m1.4.4.2.3.2"></sum><ci id="S4.E2.m1.4.4.2.3.3.cmml" xref="S4.E2.m1.4.4.2.3.3">𝑖</ci></apply><apply id="S4.E2.m1.4.4.2.2.cmml" xref="S4.E2.m1.4.4.2.2"><times id="S4.E2.m1.4.4.2.2.3.cmml" xref="S4.E2.m1.4.4.2.2.3"></times><apply id="S4.E2.m1.4.4.2.2.4.cmml" xref="S4.E2.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.2.2.4.1.cmml" xref="S4.E2.m1.4.4.2.2.4">subscript</csymbol><apply id="S4.E2.m1.4.4.2.2.4.2.cmml" xref="S4.E2.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.2.2.4.2.1.cmml" xref="S4.E2.m1.4.4.2.2.4">superscript</csymbol><apply id="S4.E2.m1.4.4.2.2.4.2.2.cmml" xref="S4.E2.m1.4.4.2.2.4.2.2"><ci id="S4.E2.m1.4.4.2.2.4.2.2.1.cmml" xref="S4.E2.m1.4.4.2.2.4.2.2.1">~</ci><ci id="S4.E2.m1.4.4.2.2.4.2.2.2.cmml" xref="S4.E2.m1.4.4.2.2.4.2.2.2">𝜽</ci></apply><ci id="S4.E2.m1.4.4.2.2.4.2.3.cmml" xref="S4.E2.m1.4.4.2.2.4.2.3">𝖽</ci></apply><ci id="S4.E2.m1.4.4.2.2.4.3.cmml" xref="S4.E2.m1.4.4.2.2.4.3">𝑖</ci></apply><apply id="S4.E2.m1.4.4.2.2.2.3.cmml" xref="S4.E2.m1.4.4.2.2.2.2"><apply id="S4.E2.m1.3.3.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.2">softmax</ci><ci id="S4.E2.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E2.m1.4.4.2.2.2.2.2.1.cmml" xref="S4.E2.m1.4.4.2.2.2.2.2.1"><times id="S4.E2.m1.4.4.2.2.2.2.2.1.1.cmml" xref="S4.E2.m1.4.4.2.2.2.2.2.1.1"></times><apply id="S4.E2.m1.4.4.2.2.2.2.2.1.2.cmml" xref="S4.E2.m1.4.4.2.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.2.2.2.2.2.1.2.1.cmml" xref="S4.E2.m1.4.4.2.2.2.2.2.1.2">subscript</csymbol><ci id="S4.E2.m1.4.4.2.2.2.2.2.1.2.2.cmml" xref="S4.E2.m1.4.4.2.2.2.2.2.1.2.2">𝑑</ci><ci id="S4.E2.m1.4.4.2.2.2.2.2.1.2.3.cmml" xref="S4.E2.m1.4.4.2.2.2.2.2.1.2.3">𝖼𝗈𝗌</ci></apply><interval closure="open" id="S4.E2.m1.4.4.2.2.2.2.2.1.3.1.cmml" xref="S4.E2.m1.4.4.2.2.2.2.2.1.3.2"><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝒉</ci><apply id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2"><ci id="S4.E2.m1.2.2.1.cmml" xref="S4.E2.m1.2.2.1">~</ci><apply id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.1.cmml" xref="S4.E2.m1.2.2.2">subscript</csymbol><ci id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2">𝒉</ci><ci id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.3">𝑖</ci></apply></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.4c">\displaystyle{\boldsymbol{\theta}}^{\mathsf{d}}~{}~{}=~{}~{}\sum_{i}\tilde{{\boldsymbol{\theta}}}^{\mathsf{d}}_{i}\;\operatorname*{softmax}_{i}\big{(}d_{\mathsf{cos}}({\boldsymbol{h}},\tilde{{\boldsymbol{h}}_{i}})\big{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.12" class="ltx_p">where <math id="S4.SS1.p2.6.m1.2" class="ltx_Math" alttext="d_{\mathsf{cos}}(\cdot,\cdot)" display="inline"><semantics id="S4.SS1.p2.6.m1.2a"><mrow id="S4.SS1.p2.6.m1.2.3" xref="S4.SS1.p2.6.m1.2.3.cmml"><msub id="S4.SS1.p2.6.m1.2.3.2" xref="S4.SS1.p2.6.m1.2.3.2.cmml"><mi id="S4.SS1.p2.6.m1.2.3.2.2" xref="S4.SS1.p2.6.m1.2.3.2.2.cmml">d</mi><mi id="S4.SS1.p2.6.m1.2.3.2.3" xref="S4.SS1.p2.6.m1.2.3.2.3.cmml">𝖼𝗈𝗌</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p2.6.m1.2.3.1" xref="S4.SS1.p2.6.m1.2.3.1.cmml">​</mo><mrow id="S4.SS1.p2.6.m1.2.3.3.2" xref="S4.SS1.p2.6.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.6.m1.2.3.3.2.1" xref="S4.SS1.p2.6.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p2.6.m1.1.1" xref="S4.SS1.p2.6.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S4.SS1.p2.6.m1.2.3.3.2.2" xref="S4.SS1.p2.6.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p2.6.m1.2.2" xref="S4.SS1.p2.6.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p2.6.m1.2.3.3.2.3" xref="S4.SS1.p2.6.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m1.2b"><apply id="S4.SS1.p2.6.m1.2.3.cmml" xref="S4.SS1.p2.6.m1.2.3"><times id="S4.SS1.p2.6.m1.2.3.1.cmml" xref="S4.SS1.p2.6.m1.2.3.1"></times><apply id="S4.SS1.p2.6.m1.2.3.2.cmml" xref="S4.SS1.p2.6.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m1.2.3.2.1.cmml" xref="S4.SS1.p2.6.m1.2.3.2">subscript</csymbol><ci id="S4.SS1.p2.6.m1.2.3.2.2.cmml" xref="S4.SS1.p2.6.m1.2.3.2.2">𝑑</ci><ci id="S4.SS1.p2.6.m1.2.3.2.3.cmml" xref="S4.SS1.p2.6.m1.2.3.2.3">𝖼𝗈𝗌</ci></apply><interval closure="open" id="S4.SS1.p2.6.m1.2.3.3.1.cmml" xref="S4.SS1.p2.6.m1.2.3.3.2"><ci id="S4.SS1.p2.6.m1.1.1.cmml" xref="S4.SS1.p2.6.m1.1.1">⋅</ci><ci id="S4.SS1.p2.6.m1.2.2.cmml" xref="S4.SS1.p2.6.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m1.2c">d_{\mathsf{cos}}(\cdot,\cdot)</annotation></semantics></math> is the cosine similarity function. We therefore retrieve a weighted sum, in which the similarity of <math id="S4.SS1.p2.7.m2.1" class="ltx_Math" alttext="{\boldsymbol{h}}" display="inline"><semantics id="S4.SS1.p2.7.m2.1a"><mi id="S4.SS1.p2.7.m2.1.1" xref="S4.SS1.p2.7.m2.1.1.cmml">𝒉</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m2.1b"><ci id="S4.SS1.p2.7.m2.1.1.cmml" xref="S4.SS1.p2.7.m2.1.1">𝒉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m2.1c">{\boldsymbol{h}}</annotation></semantics></math> with the memory keys <math id="S4.SS1.p2.8.m3.1" class="ltx_Math" alttext="\tilde{{\boldsymbol{h}}_{i}}" display="inline"><semantics id="S4.SS1.p2.8.m3.1a"><mover accent="true" id="S4.SS1.p2.8.m3.1.1" xref="S4.SS1.p2.8.m3.1.1.cmml"><msub id="S4.SS1.p2.8.m3.1.1.2" xref="S4.SS1.p2.8.m3.1.1.2.cmml"><mi id="S4.SS1.p2.8.m3.1.1.2.2" xref="S4.SS1.p2.8.m3.1.1.2.2.cmml">𝒉</mi><mi id="S4.SS1.p2.8.m3.1.1.2.3" xref="S4.SS1.p2.8.m3.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.p2.8.m3.1.1.1" xref="S4.SS1.p2.8.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m3.1b"><apply id="S4.SS1.p2.8.m3.1.1.cmml" xref="S4.SS1.p2.8.m3.1.1"><ci id="S4.SS1.p2.8.m3.1.1.1.cmml" xref="S4.SS1.p2.8.m3.1.1.1">~</ci><apply id="S4.SS1.p2.8.m3.1.1.2.cmml" xref="S4.SS1.p2.8.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.8.m3.1.1.2.1.cmml" xref="S4.SS1.p2.8.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.8.m3.1.1.2.2.cmml" xref="S4.SS1.p2.8.m3.1.1.2.2">𝒉</ci><ci id="S4.SS1.p2.8.m3.1.1.2.3.cmml" xref="S4.SS1.p2.8.m3.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m3.1c">\tilde{{\boldsymbol{h}}_{i}}</annotation></semantics></math> serves to weight the memory values <math id="S4.SS1.p2.9.m4.1" class="ltx_Math" alttext="\tilde{{\boldsymbol{\theta}}}^{\mathsf{d}}_{i}" display="inline"><semantics id="S4.SS1.p2.9.m4.1a"><msubsup id="S4.SS1.p2.9.m4.1.1" xref="S4.SS1.p2.9.m4.1.1.cmml"><mover accent="true" id="S4.SS1.p2.9.m4.1.1.2.2" xref="S4.SS1.p2.9.m4.1.1.2.2.cmml"><mi id="S4.SS1.p2.9.m4.1.1.2.2.2" xref="S4.SS1.p2.9.m4.1.1.2.2.2.cmml">𝜽</mi><mo id="S4.SS1.p2.9.m4.1.1.2.2.1" xref="S4.SS1.p2.9.m4.1.1.2.2.1.cmml">~</mo></mover><mi id="S4.SS1.p2.9.m4.1.1.3" xref="S4.SS1.p2.9.m4.1.1.3.cmml">i</mi><mi id="S4.SS1.p2.9.m4.1.1.2.3" xref="S4.SS1.p2.9.m4.1.1.2.3.cmml">𝖽</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m4.1b"><apply id="S4.SS1.p2.9.m4.1.1.cmml" xref="S4.SS1.p2.9.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m4.1.1.1.cmml" xref="S4.SS1.p2.9.m4.1.1">subscript</csymbol><apply id="S4.SS1.p2.9.m4.1.1.2.cmml" xref="S4.SS1.p2.9.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m4.1.1.2.1.cmml" xref="S4.SS1.p2.9.m4.1.1">superscript</csymbol><apply id="S4.SS1.p2.9.m4.1.1.2.2.cmml" xref="S4.SS1.p2.9.m4.1.1.2.2"><ci id="S4.SS1.p2.9.m4.1.1.2.2.1.cmml" xref="S4.SS1.p2.9.m4.1.1.2.2.1">~</ci><ci id="S4.SS1.p2.9.m4.1.1.2.2.2.cmml" xref="S4.SS1.p2.9.m4.1.1.2.2.2">𝜽</ci></apply><ci id="S4.SS1.p2.9.m4.1.1.2.3.cmml" xref="S4.SS1.p2.9.m4.1.1.2.3">𝖽</ci></apply><ci id="S4.SS1.p2.9.m4.1.1.3.cmml" xref="S4.SS1.p2.9.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m4.1c">\tilde{{\boldsymbol{\theta}}}^{\mathsf{d}}_{i}</annotation></semantics></math>. In practice and for computational reasons, the softmax function cuts off after the top <math id="S4.SS1.p2.10.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p2.10.m5.1a"><mi id="S4.SS1.p2.10.m5.1.1" xref="S4.SS1.p2.10.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m5.1b"><ci id="S4.SS1.p2.10.m5.1.1.cmml" xref="S4.SS1.p2.10.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m5.1c">k</annotation></semantics></math> largest values, with <math id="S4.SS1.p2.11.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p2.11.m6.1a"><mi id="S4.SS1.p2.11.m6.1.1" xref="S4.SS1.p2.11.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m6.1b"><ci id="S4.SS1.p2.11.m6.1.1.cmml" xref="S4.SS1.p2.11.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m6.1c">k</annotation></semantics></math> in the order of a thousand elements (see Section <a href="#S5" title="5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). We detail in Section <a href="#S4.SS2" title="4.2 Processing of Support Set ‣ 4 Proposed Model ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> how the memory is filled by processing the support set. Note that the above formulation can be made equivalent to the original model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> by using only static weights (<math id="S4.SS1.p2.12.m7.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}={\boldsymbol{\theta}}^{\mathsf{s}}" display="inline"><semantics id="S4.SS1.p2.12.m7.1a"><mrow id="S4.SS1.p2.12.m7.1.1" xref="S4.SS1.p2.12.m7.1.1.cmml"><mi id="S4.SS1.p2.12.m7.1.1.2" xref="S4.SS1.p2.12.m7.1.1.2.cmml">𝜽</mi><mo id="S4.SS1.p2.12.m7.1.1.1" xref="S4.SS1.p2.12.m7.1.1.1.cmml">=</mo><msup id="S4.SS1.p2.12.m7.1.1.3" xref="S4.SS1.p2.12.m7.1.1.3.cmml"><mi id="S4.SS1.p2.12.m7.1.1.3.2" xref="S4.SS1.p2.12.m7.1.1.3.2.cmml">𝜽</mi><mi id="S4.SS1.p2.12.m7.1.1.3.3" xref="S4.SS1.p2.12.m7.1.1.3.3.cmml">𝗌</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.12.m7.1b"><apply id="S4.SS1.p2.12.m7.1.1.cmml" xref="S4.SS1.p2.12.m7.1.1"><eq id="S4.SS1.p2.12.m7.1.1.1.cmml" xref="S4.SS1.p2.12.m7.1.1.1"></eq><ci id="S4.SS1.p2.12.m7.1.1.2.cmml" xref="S4.SS1.p2.12.m7.1.1.2">𝜽</ci><apply id="S4.SS1.p2.12.m7.1.1.3.cmml" xref="S4.SS1.p2.12.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m7.1.1.3.1.cmml" xref="S4.SS1.p2.12.m7.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.12.m7.1.1.3.2.cmml" xref="S4.SS1.p2.12.m7.1.1.3.2">𝜽</ci><ci id="S4.SS1.p2.12.m7.1.1.3.3.cmml" xref="S4.SS1.p2.12.m7.1.1.3.3">𝗌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.12.m7.1c">{\boldsymbol{\theta}}={\boldsymbol{\theta}}^{\mathsf{s}}</annotation></semantics></math>). This serves as a baseline in our experiments (see Section <a href="#S5" title="5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Mapping to Candidate Answers <math id="S4.SS1.SSS1.1.m1.1" class="ltx_Math" alttext="g_{\mathit{\Phi}}(\cdot)" display="inline"><semantics id="S4.SS1.SSS1.1.m1.1b"><mrow id="S4.SS1.SSS1.1.m1.1.2" xref="S4.SS1.SSS1.1.m1.1.2.cmml"><msub id="S4.SS1.SSS1.1.m1.1.2.2" xref="S4.SS1.SSS1.1.m1.1.2.2.cmml"><mi id="S4.SS1.SSS1.1.m1.1.2.2.2" xref="S4.SS1.SSS1.1.m1.1.2.2.2.cmml">g</mi><mi id="S4.SS1.SSS1.1.m1.1.2.2.3" xref="S4.SS1.SSS1.1.m1.1.2.2.3.cmml">Φ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.1.m1.1.2.1" xref="S4.SS1.SSS1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.1.m1.1.2.3.2" xref="S4.SS1.SSS1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.1.m1.1.2.3.2.1" xref="S4.SS1.SSS1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.1.m1.1.1" xref="S4.SS1.SSS1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS1.1.m1.1.2.3.2.2" xref="S4.SS1.SSS1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.1.m1.1c"><apply id="S4.SS1.SSS1.1.m1.1.2.cmml" xref="S4.SS1.SSS1.1.m1.1.2"><times id="S4.SS1.SSS1.1.m1.1.2.1.cmml" xref="S4.SS1.SSS1.1.m1.1.2.1"></times><apply id="S4.SS1.SSS1.1.m1.1.2.2.cmml" xref="S4.SS1.SSS1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.1.m1.1.2.2.1.cmml" xref="S4.SS1.SSS1.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.1.m1.1.2.2.2.cmml" xref="S4.SS1.SSS1.1.m1.1.2.2.2">𝑔</ci><ci id="S4.SS1.SSS1.1.m1.1.2.2.3.cmml" xref="S4.SS1.SSS1.1.m1.1.2.2.3">𝛷</ci></apply><ci id="S4.SS1.SSS1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.1.m1.1d">g_{\mathit{\Phi}}(\cdot)</annotation></semantics></math>
</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.11" class="ltx_p">The function <math id="S4.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="g_{\mathit{\Phi}}({\boldsymbol{h}})" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mrow id="S4.SS1.SSS1.p1.1.m1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.2.cmml"><msub id="S4.SS1.SSS1.p1.1.m1.1.2.2" xref="S4.SS1.SSS1.p1.1.m1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.2.2.2" xref="S4.SS1.SSS1.p1.1.m1.1.2.2.2.cmml">g</mi><mi id="S4.SS1.SSS1.p1.1.m1.1.2.2.3" xref="S4.SS1.SSS1.p1.1.m1.1.2.2.3.cmml">Φ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.1.m1.1.2.1" xref="S4.SS1.SSS1.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p1.1.m1.1.2.3.2" xref="S4.SS1.SSS1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.1.m1.1.2.3.2.1" xref="S4.SS1.SSS1.p1.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml">𝒉</mi><mo stretchy="false" id="S4.SS1.SSS1.p1.1.m1.1.2.3.2.2" xref="S4.SS1.SSS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><apply id="S4.SS1.SSS1.p1.1.m1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.2"><times id="S4.SS1.SSS1.p1.1.m1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.2.1"></times><apply id="S4.SS1.SSS1.p1.1.m1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p1.1.m1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.2.2.2">𝑔</ci><ci id="S4.SS1.SSS1.p1.1.m1.1.2.2.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.2.2.3">𝛷</ci></apply><ci id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1">𝒉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">g_{\mathit{\Phi}}({\boldsymbol{h}})</annotation></semantics></math> maps the output of the non-linear transformation to a vector of scores <math id="S4.SS1.SSS1.p1.2.m2.2" class="ltx_Math" alttext="s\in[0,1]^{A}" display="inline"><semantics id="S4.SS1.SSS1.p1.2.m2.2a"><mrow id="S4.SS1.SSS1.p1.2.m2.2.3" xref="S4.SS1.SSS1.p1.2.m2.2.3.cmml"><mi id="S4.SS1.SSS1.p1.2.m2.2.3.2" xref="S4.SS1.SSS1.p1.2.m2.2.3.2.cmml">s</mi><mo id="S4.SS1.SSS1.p1.2.m2.2.3.1" xref="S4.SS1.SSS1.p1.2.m2.2.3.1.cmml">∈</mo><msup id="S4.SS1.SSS1.p1.2.m2.2.3.3" xref="S4.SS1.SSS1.p1.2.m2.2.3.3.cmml"><mrow id="S4.SS1.SSS1.p1.2.m2.2.3.3.2.2" xref="S4.SS1.SSS1.p1.2.m2.2.3.3.2.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.2.m2.2.3.3.2.2.1" xref="S4.SS1.SSS1.p1.2.m2.2.3.3.2.1.cmml">[</mo><mn id="S4.SS1.SSS1.p1.2.m2.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.cmml">0</mn><mo id="S4.SS1.SSS1.p1.2.m2.2.3.3.2.2.2" xref="S4.SS1.SSS1.p1.2.m2.2.3.3.2.1.cmml">,</mo><mn id="S4.SS1.SSS1.p1.2.m2.2.2" xref="S4.SS1.SSS1.p1.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.SSS1.p1.2.m2.2.3.3.2.2.3" xref="S4.SS1.SSS1.p1.2.m2.2.3.3.2.1.cmml">]</mo></mrow><mi id="S4.SS1.SSS1.p1.2.m2.2.3.3.3" xref="S4.SS1.SSS1.p1.2.m2.2.3.3.3.cmml">A</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.2.m2.2b"><apply id="S4.SS1.SSS1.p1.2.m2.2.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3"><in id="S4.SS1.SSS1.p1.2.m2.2.3.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3.1"></in><ci id="S4.SS1.SSS1.p1.2.m2.2.3.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3.2">𝑠</ci><apply id="S4.SS1.SSS1.p1.2.m2.2.3.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.2.m2.2.3.3.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3.3">superscript</csymbol><interval closure="closed" id="S4.SS1.SSS1.p1.2.m2.2.3.3.2.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3.3.2.2"><cn type="integer" id="S4.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1">0</cn><cn type="integer" id="S4.SS1.SSS1.p1.2.m2.2.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.2">1</cn></interval><ci id="S4.SS1.SSS1.p1.2.m2.2.3.3.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.2.3.3.3">𝐴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.2.m2.2c">s\in[0,1]^{A}</annotation></semantics></math> over the set of candidate answers. It is traditionally implemented as a simple affine or linear transformation (<em id="S4.SS1.SSS1.p1.11.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS1.SSS1.p1.11.2" class="ltx_text"></span> a matrix multiplication). We generalize the definition of <math id="S4.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="g_{\mathit{\Phi}}({\boldsymbol{h}})" display="inline"><semantics id="S4.SS1.SSS1.p1.3.m3.1a"><mrow id="S4.SS1.SSS1.p1.3.m3.1.2" xref="S4.SS1.SSS1.p1.3.m3.1.2.cmml"><msub id="S4.SS1.SSS1.p1.3.m3.1.2.2" xref="S4.SS1.SSS1.p1.3.m3.1.2.2.cmml"><mi id="S4.SS1.SSS1.p1.3.m3.1.2.2.2" xref="S4.SS1.SSS1.p1.3.m3.1.2.2.2.cmml">g</mi><mi id="S4.SS1.SSS1.p1.3.m3.1.2.2.3" xref="S4.SS1.SSS1.p1.3.m3.1.2.2.3.cmml">Φ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.3.m3.1.2.1" xref="S4.SS1.SSS1.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p1.3.m3.1.2.3.2" xref="S4.SS1.SSS1.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.3.m3.1.2.3.2.1" xref="S4.SS1.SSS1.p1.3.m3.1.2.cmml">(</mo><mi id="S4.SS1.SSS1.p1.3.m3.1.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.cmml">𝒉</mi><mo stretchy="false" id="S4.SS1.SSS1.p1.3.m3.1.2.3.2.2" xref="S4.SS1.SSS1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.3.m3.1b"><apply id="S4.SS1.SSS1.p1.3.m3.1.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.2"><times id="S4.SS1.SSS1.p1.3.m3.1.2.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.2.1"></times><apply id="S4.SS1.SSS1.p1.3.m3.1.2.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.3.m3.1.2.2.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p1.3.m3.1.2.2.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.2.2.2">𝑔</ci><ci id="S4.SS1.SSS1.p1.3.m3.1.2.2.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.2.2.3">𝛷</ci></apply><ci id="S4.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1">𝒉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.3.m3.1c">g_{\mathit{\Phi}}({\boldsymbol{h}})</annotation></semantics></math> by interpreting it as a similarity measure between its input <math id="S4.SS1.SSS1.p1.4.m4.1" class="ltx_Math" alttext="{\boldsymbol{h}}" display="inline"><semantics id="S4.SS1.SSS1.p1.4.m4.1a"><mi id="S4.SS1.SSS1.p1.4.m4.1.1" xref="S4.SS1.SSS1.p1.4.m4.1.1.cmml">𝒉</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.4.m4.1b"><ci id="S4.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.1">𝒉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.4.m4.1c">{\boldsymbol{h}}</annotation></semantics></math> and prototypes <math id="S4.SS1.SSS1.p1.5.m5.3" class="ltx_Math" alttext="\mathit{\Phi}=\{\boldsymbol{\phi}_{i}^{a}\}_{i,a}" display="inline"><semantics id="S4.SS1.SSS1.p1.5.m5.3a"><mrow id="S4.SS1.SSS1.p1.5.m5.3.3" xref="S4.SS1.SSS1.p1.5.m5.3.3.cmml"><mi id="S4.SS1.SSS1.p1.5.m5.3.3.3" xref="S4.SS1.SSS1.p1.5.m5.3.3.3.cmml">Φ</mi><mo id="S4.SS1.SSS1.p1.5.m5.3.3.2" xref="S4.SS1.SSS1.p1.5.m5.3.3.2.cmml">=</mo><msub id="S4.SS1.SSS1.p1.5.m5.3.3.1" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.cmml"><mrow id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.2" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.2.cmml">{</mo><msubsup id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.2.2" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.2.2.cmml">ϕ</mi><mi id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.2.3" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.3" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.3.cmml">a</mi></msubsup><mo stretchy="false" id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.3" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.SSS1.p1.5.m5.2.2.2.4" xref="S4.SS1.SSS1.p1.5.m5.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p1.5.m5.1.1.1.1" xref="S4.SS1.SSS1.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p1.5.m5.2.2.2.4.1" xref="S4.SS1.SSS1.p1.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p1.5.m5.2.2.2.2" xref="S4.SS1.SSS1.p1.5.m5.2.2.2.2.cmml">a</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.5.m5.3b"><apply id="S4.SS1.SSS1.p1.5.m5.3.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3"><eq id="S4.SS1.SSS1.p1.5.m5.3.3.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.2"></eq><ci id="S4.SS1.SSS1.p1.5.m5.3.3.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.3">𝛷</ci><apply id="S4.SS1.SSS1.p1.5.m5.3.3.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.5.m5.3.3.1.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.1">subscript</csymbol><set id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1"><apply id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.3.3.1.1.1.1.3">𝑎</ci></apply></set><list id="S4.SS1.SSS1.p1.5.m5.2.2.2.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.2.2.2.4"><ci id="S4.SS1.SSS1.p1.5.m5.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.1.1">𝑖</ci><ci id="S4.SS1.SSS1.p1.5.m5.2.2.2.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.2.2.2.2">𝑎</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.5.m5.3c">\mathit{\Phi}=\{\boldsymbol{\phi}_{i}^{a}\}_{i,a}</annotation></semantics></math> representing the possible answers. In traditional models, each prototype corresponds to one row of the weight matrix. Our general formulation allows one or several prototypes per possible answer <math id="S4.SS1.SSS1.p1.6.m6.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.SS1.SSS1.p1.6.m6.1a"><mi id="S4.SS1.SSS1.p1.6.m6.1.1" xref="S4.SS1.SSS1.p1.6.m6.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.6.m6.1b"><ci id="S4.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.6.m6.1c">a</annotation></semantics></math> as <math id="S4.SS1.SSS1.p1.7.m7.1" class="ltx_Math" alttext="\{\boldsymbol{\phi}_{i}^{a}\}_{i=1}^{N^{a}}" display="inline"><semantics id="S4.SS1.SSS1.p1.7.m7.1a"><msubsup id="S4.SS1.SSS1.p1.7.m7.1.1" xref="S4.SS1.SSS1.p1.7.m7.1.1.cmml"><mrow id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.2.cmml">{</mo><msubsup id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.2.2" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.2.2.cmml">ϕ</mi><mi id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.2.3" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.3.cmml">a</mi></msubsup><mo stretchy="false" id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.SSS1.p1.7.m7.1.1.1.3" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.7.m7.1.1.1.3.2" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.SSS1.p1.7.m7.1.1.1.3.1" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.SSS1.p1.7.m7.1.1.1.3.3" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.3.3.cmml">1</mn></mrow><msup id="S4.SS1.SSS1.p1.7.m7.1.1.3" xref="S4.SS1.SSS1.p1.7.m7.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.7.m7.1.1.3.2" xref="S4.SS1.SSS1.p1.7.m7.1.1.3.2.cmml">N</mi><mi id="S4.SS1.SSS1.p1.7.m7.1.1.3.3" xref="S4.SS1.SSS1.p1.7.m7.1.1.3.3.cmml">a</mi></msup></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.7.m7.1b"><apply id="S4.SS1.SSS1.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1">subscript</csymbol><set id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1"><apply id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.1.3">𝑎</ci></apply></set><apply id="S4.SS1.SSS1.p1.7.m7.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.3"><eq id="S4.SS1.SSS1.p1.7.m7.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.3.1"></eq><ci id="S4.SS1.SSS1.p1.7.m7.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.3.2">𝑖</ci><cn type="integer" id="S4.SS1.SSS1.p1.7.m7.1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS1.p1.7.m7.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.3.2">𝑁</ci><ci id="S4.SS1.SSS1.p1.7.m7.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.7.m7.1c">\{\boldsymbol{\phi}_{i}^{a}\}_{i=1}^{N^{a}}</annotation></semantics></math>. Intuitively, the prototypes represent the typical expected feature vector when <math id="S4.SS1.SSS1.p1.8.m8.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.SS1.SSS1.p1.8.m8.1a"><mi id="S4.SS1.SSS1.p1.8.m8.1.1" xref="S4.SS1.SSS1.p1.8.m8.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.8.m8.1b"><ci id="S4.SS1.SSS1.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.8.m8.1c">a</annotation></semantics></math> is a correct answer. The score for <math id="S4.SS1.SSS1.p1.9.m9.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.SS1.SSS1.p1.9.m9.1a"><mi id="S4.SS1.SSS1.p1.9.m9.1.1" xref="S4.SS1.SSS1.p1.9.m9.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.9.m9.1b"><ci id="S4.SS1.SSS1.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS1.p1.9.m9.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.9.m9.1c">a</annotation></semantics></math> is therefore obtained as the similarity between the provided <math id="S4.SS1.SSS1.p1.10.m10.1" class="ltx_Math" alttext="{\boldsymbol{h}}^{\prime}" display="inline"><semantics id="S4.SS1.SSS1.p1.10.m10.1a"><msup id="S4.SS1.SSS1.p1.10.m10.1.1" xref="S4.SS1.SSS1.p1.10.m10.1.1.cmml"><mi id="S4.SS1.SSS1.p1.10.m10.1.1.2" xref="S4.SS1.SSS1.p1.10.m10.1.1.2.cmml">𝒉</mi><mo id="S4.SS1.SSS1.p1.10.m10.1.1.3" xref="S4.SS1.SSS1.p1.10.m10.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.10.m10.1b"><apply id="S4.SS1.SSS1.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p1.10.m10.1.1.2.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.2">𝒉</ci><ci id="S4.SS1.SSS1.p1.10.m10.1.1.3.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.10.m10.1c">{\boldsymbol{h}}^{\prime}</annotation></semantics></math> and the corresponding prototypes of <math id="S4.SS1.SSS1.p1.11.m11.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.SS1.SSS1.p1.11.m11.1a"><mi id="S4.SS1.SSS1.p1.11.m11.1.1" xref="S4.SS1.SSS1.p1.11.m11.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.11.m11.1b"><ci id="S4.SS1.SSS1.p1.11.m11.1.1.cmml" xref="S4.SS1.SSS1.p1.11.m11.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.11.m11.1c">a</annotation></semantics></math>. When multiple prototypes are available, the similarities are averaged. Concretely, we define</p>
<table id="A4.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E3.m1.2" class="ltx_Math" alttext="\displaystyle g^{a}_{\mathit{\Phi}}({\boldsymbol{h}}^{\prime})~{}~{}=~{}~{}\sigma\Big{(}\,\frac{1}{N^{a}}\sum^{N^{a}}_{i=1}d({\boldsymbol{h}}^{\prime},\boldsymbol{\phi}_{i}^{a})\,+b^{\prime\prime}\,\Big{)}" display="inline"><semantics id="S4.E3.m1.2a"><mrow id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml"><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.cmml"><msubsup id="S4.E3.m1.1.1.1.3" xref="S4.E3.m1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.3.2.2" xref="S4.E3.m1.1.1.1.3.2.2.cmml">g</mi><mi id="S4.E3.m1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.3.3.cmml">Φ</mi><mi id="S4.E3.m1.1.1.1.3.2.3" xref="S4.E3.m1.1.1.1.3.2.3.cmml">a</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.2.cmml">𝒉</mi><mo id="S4.E3.m1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo rspace="0.660em" stretchy="false" id="S4.E3.m1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.938em" id="S4.E3.m1.2.2.3" xref="S4.E3.m1.2.2.3.cmml">=</mo><mrow id="S4.E3.m1.2.2.2" xref="S4.E3.m1.2.2.2.cmml"><mi id="S4.E3.m1.2.2.2.3" xref="S4.E3.m1.2.2.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.2.cmml">​</mo><mrow id="S4.E3.m1.2.2.2.1.1" xref="S4.E3.m1.2.2.2.1.1.1.cmml"><mo maxsize="160%" minsize="160%" rspace="0.170em" id="S4.E3.m1.2.2.2.1.1.2" xref="S4.E3.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.2.2.2.1.1.1" xref="S4.E3.m1.2.2.2.1.1.1.cmml"><mrow id="S4.E3.m1.2.2.2.1.1.1.2" xref="S4.E3.m1.2.2.2.1.1.1.2.cmml"><mstyle displaystyle="true" id="S4.E3.m1.2.2.2.1.1.1.2.4" xref="S4.E3.m1.2.2.2.1.1.1.2.4.cmml"><mfrac id="S4.E3.m1.2.2.2.1.1.1.2.4a" xref="S4.E3.m1.2.2.2.1.1.1.2.4.cmml"><mn id="S4.E3.m1.2.2.2.1.1.1.2.4.2" xref="S4.E3.m1.2.2.2.1.1.1.2.4.2.cmml">1</mn><msup id="S4.E3.m1.2.2.2.1.1.1.2.4.3" xref="S4.E3.m1.2.2.2.1.1.1.2.4.3.cmml"><mi id="S4.E3.m1.2.2.2.1.1.1.2.4.3.2" xref="S4.E3.m1.2.2.2.1.1.1.2.4.3.2.cmml">N</mi><mi id="S4.E3.m1.2.2.2.1.1.1.2.4.3.3" xref="S4.E3.m1.2.2.2.1.1.1.2.4.3.3.cmml">a</mi></msup></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.1.1.1.2.3" xref="S4.E3.m1.2.2.2.1.1.1.2.3.cmml">​</mo><mrow id="S4.E3.m1.2.2.2.1.1.1.2.2" xref="S4.E3.m1.2.2.2.1.1.1.2.2.cmml"><mstyle displaystyle="true" id="S4.E3.m1.2.2.2.1.1.1.2.2.3" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.cmml"><munderover id="S4.E3.m1.2.2.2.1.1.1.2.2.3a" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.cmml"><mo movablelimits="false" id="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.2" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E3.m1.2.2.2.1.1.1.2.2.3.3" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.cmml"><mi id="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.2" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.2.cmml">i</mi><mo id="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.1" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.1.cmml">=</mo><mn id="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.3" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.3.cmml">1</mn></mrow><msup id="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3.cmml"><mi id="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3.2" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3.2.cmml">N</mi><mi id="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3.3" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3.3.cmml">a</mi></msup></munderover></mstyle><mrow id="S4.E3.m1.2.2.2.1.1.1.2.2.2" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.cmml"><mi id="S4.E3.m1.2.2.2.1.1.1.2.2.2.4" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.1.1.1.2.2.2.3" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.3.cmml">​</mo><mrow id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.3.cmml">(</mo><msup id="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝒉</mi><mo id="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.4" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.3.cmml">,</mo><msubsup id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.2.2.cmml">ϕ</mi><mi id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.2.3.cmml">i</mi><mi id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.3.cmml">a</mi></msubsup><mo rspace="0.170em" stretchy="false" id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.5" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E3.m1.2.2.2.1.1.1.3" xref="S4.E3.m1.2.2.2.1.1.1.3.cmml">+</mo><msup id="S4.E3.m1.2.2.2.1.1.1.4" xref="S4.E3.m1.2.2.2.1.1.1.4.cmml"><mi id="S4.E3.m1.2.2.2.1.1.1.4.2" xref="S4.E3.m1.2.2.2.1.1.1.4.2.cmml">b</mi><mo id="S4.E3.m1.2.2.2.1.1.1.4.3" xref="S4.E3.m1.2.2.2.1.1.1.4.3.cmml">′′</mo></msup></mrow><mo maxsize="160%" minsize="160%" id="S4.E3.m1.2.2.2.1.1.3" xref="S4.E3.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b"><apply id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2"><eq id="S4.E3.m1.2.2.3.cmml" xref="S4.E3.m1.2.2.3"></eq><apply id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><times id="S4.E3.m1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.2"></times><apply id="S4.E3.m1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.3">subscript</csymbol><apply id="S4.E3.m1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.3.2.1.cmml" xref="S4.E3.m1.1.1.1.3">superscript</csymbol><ci id="S4.E3.m1.1.1.1.3.2.2.cmml" xref="S4.E3.m1.1.1.1.3.2.2">𝑔</ci><ci id="S4.E3.m1.1.1.1.3.2.3.cmml" xref="S4.E3.m1.1.1.1.3.2.3">𝑎</ci></apply><ci id="S4.E3.m1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.3.3">𝛷</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2">𝒉</ci><ci id="S4.E3.m1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.3">′</ci></apply></apply><apply id="S4.E3.m1.2.2.2.cmml" xref="S4.E3.m1.2.2.2"><times id="S4.E3.m1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2"></times><ci id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.3">𝜎</ci><apply id="S4.E3.m1.2.2.2.1.1.1.cmml" xref="S4.E3.m1.2.2.2.1.1"><plus id="S4.E3.m1.2.2.2.1.1.1.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.3"></plus><apply id="S4.E3.m1.2.2.2.1.1.1.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2"><times id="S4.E3.m1.2.2.2.1.1.1.2.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.3"></times><apply id="S4.E3.m1.2.2.2.1.1.1.2.4.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.4"><divide id="S4.E3.m1.2.2.2.1.1.1.2.4.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.4"></divide><cn type="integer" id="S4.E3.m1.2.2.2.1.1.1.2.4.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.4.2">1</cn><apply id="S4.E3.m1.2.2.2.1.1.1.2.4.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.4.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.1.1.1.2.4.3.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.4.3">superscript</csymbol><ci id="S4.E3.m1.2.2.2.1.1.1.2.4.3.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.4.3.2">𝑁</ci><ci id="S4.E3.m1.2.2.2.1.1.1.2.4.3.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.4.3.3">𝑎</ci></apply></apply><apply id="S4.E3.m1.2.2.2.1.1.1.2.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2"><apply id="S4.E3.m1.2.2.2.1.1.1.2.2.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.1.1.1.2.2.3.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3">subscript</csymbol><apply id="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3">superscript</csymbol><sum id="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.2"></sum><apply id="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3">superscript</csymbol><ci id="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3.2">𝑁</ci><ci id="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.2.3.3">𝑎</ci></apply></apply><apply id="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.3"><eq id="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.1"></eq><ci id="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.2">𝑖</ci><cn type="integer" id="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.3.3.3">1</cn></apply></apply><apply id="S4.E3.m1.2.2.2.1.1.1.2.2.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2"><times id="S4.E3.m1.2.2.2.1.1.1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.3"></times><ci id="S4.E3.m1.2.2.2.1.1.1.2.2.2.4.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.4">𝑑</ci><interval closure="open" id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2"><apply id="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.2">𝒉</ci><ci id="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2">superscript</csymbol><apply id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.2.2">bold-italic-ϕ</ci><ci id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2.2.2.2.2.3">𝑎</ci></apply></interval></apply></apply></apply><apply id="S4.E3.m1.2.2.2.1.1.1.4.cmml" xref="S4.E3.m1.2.2.2.1.1.1.4"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.1.1.1.4.1.cmml" xref="S4.E3.m1.2.2.2.1.1.1.4">superscript</csymbol><ci id="S4.E3.m1.2.2.2.1.1.1.4.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.4.2">𝑏</ci><ci id="S4.E3.m1.2.2.2.1.1.1.4.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.4.3">′′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.2c">\displaystyle g^{a}_{\mathit{\Phi}}({\boldsymbol{h}}^{\prime})~{}~{}=~{}~{}\sigma\Big{(}\,\frac{1}{N^{a}}\sum^{N^{a}}_{i=1}d({\boldsymbol{h}}^{\prime},\boldsymbol{\phi}_{i}^{a})\,+b^{\prime\prime}\,\Big{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS1.p1.16" class="ltx_p">where <math id="S4.SS1.SSS1.p1.12.m1.2" class="ltx_Math" alttext="d(\cdot,\cdot)" display="inline"><semantics id="S4.SS1.SSS1.p1.12.m1.2a"><mrow id="S4.SS1.SSS1.p1.12.m1.2.3" xref="S4.SS1.SSS1.p1.12.m1.2.3.cmml"><mi id="S4.SS1.SSS1.p1.12.m1.2.3.2" xref="S4.SS1.SSS1.p1.12.m1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.12.m1.2.3.1" xref="S4.SS1.SSS1.p1.12.m1.2.3.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p1.12.m1.2.3.3.2" xref="S4.SS1.SSS1.p1.12.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.12.m1.2.3.3.2.1" xref="S4.SS1.SSS1.p1.12.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.12.m1.1.1" xref="S4.SS1.SSS1.p1.12.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S4.SS1.SSS1.p1.12.m1.2.3.3.2.2" xref="S4.SS1.SSS1.p1.12.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.12.m1.2.2" xref="S4.SS1.SSS1.p1.12.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS1.p1.12.m1.2.3.3.2.3" xref="S4.SS1.SSS1.p1.12.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.12.m1.2b"><apply id="S4.SS1.SSS1.p1.12.m1.2.3.cmml" xref="S4.SS1.SSS1.p1.12.m1.2.3"><times id="S4.SS1.SSS1.p1.12.m1.2.3.1.cmml" xref="S4.SS1.SSS1.p1.12.m1.2.3.1"></times><ci id="S4.SS1.SSS1.p1.12.m1.2.3.2.cmml" xref="S4.SS1.SSS1.p1.12.m1.2.3.2">𝑑</ci><interval closure="open" id="S4.SS1.SSS1.p1.12.m1.2.3.3.1.cmml" xref="S4.SS1.SSS1.p1.12.m1.2.3.3.2"><ci id="S4.SS1.SSS1.p1.12.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.12.m1.1.1">⋅</ci><ci id="S4.SS1.SSS1.p1.12.m1.2.2.cmml" xref="S4.SS1.SSS1.p1.12.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.12.m1.2c">d(\cdot,\cdot)</annotation></semantics></math> is a similarity measure, <math id="S4.SS1.SSS1.p1.13.m2.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS1.SSS1.p1.13.m2.1a"><mi id="S4.SS1.SSS1.p1.13.m2.1.1" xref="S4.SS1.SSS1.p1.13.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.13.m2.1b"><ci id="S4.SS1.SSS1.p1.13.m2.1.1.cmml" xref="S4.SS1.SSS1.p1.13.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.13.m2.1c">\sigma</annotation></semantics></math> is a sigmoid (logistic) activation function to map the similarities to <math id="S4.SS1.SSS1.p1.14.m3.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S4.SS1.SSS1.p1.14.m3.2a"><mrow id="S4.SS1.SSS1.p1.14.m3.2.3.2" xref="S4.SS1.SSS1.p1.14.m3.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.14.m3.2.3.2.1" xref="S4.SS1.SSS1.p1.14.m3.2.3.1.cmml">[</mo><mn id="S4.SS1.SSS1.p1.14.m3.1.1" xref="S4.SS1.SSS1.p1.14.m3.1.1.cmml">0</mn><mo id="S4.SS1.SSS1.p1.14.m3.2.3.2.2" xref="S4.SS1.SSS1.p1.14.m3.2.3.1.cmml">,</mo><mn id="S4.SS1.SSS1.p1.14.m3.2.2" xref="S4.SS1.SSS1.p1.14.m3.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.SSS1.p1.14.m3.2.3.2.3" xref="S4.SS1.SSS1.p1.14.m3.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.14.m3.2b"><interval closure="closed" id="S4.SS1.SSS1.p1.14.m3.2.3.1.cmml" xref="S4.SS1.SSS1.p1.14.m3.2.3.2"><cn type="integer" id="S4.SS1.SSS1.p1.14.m3.1.1.cmml" xref="S4.SS1.SSS1.p1.14.m3.1.1">0</cn><cn type="integer" id="S4.SS1.SSS1.p1.14.m3.2.2.cmml" xref="S4.SS1.SSS1.p1.14.m3.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.14.m3.2c">[0,1]</annotation></semantics></math>, and <math id="S4.SS1.SSS1.p1.15.m4.1" class="ltx_Math" alttext="b^{\prime\prime}" display="inline"><semantics id="S4.SS1.SSS1.p1.15.m4.1a"><msup id="S4.SS1.SSS1.p1.15.m4.1.1" xref="S4.SS1.SSS1.p1.15.m4.1.1.cmml"><mi id="S4.SS1.SSS1.p1.15.m4.1.1.2" xref="S4.SS1.SSS1.p1.15.m4.1.1.2.cmml">b</mi><mo id="S4.SS1.SSS1.p1.15.m4.1.1.3" xref="S4.SS1.SSS1.p1.15.m4.1.1.3.cmml">′′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.15.m4.1b"><apply id="S4.SS1.SSS1.p1.15.m4.1.1.cmml" xref="S4.SS1.SSS1.p1.15.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.15.m4.1.1.1.cmml" xref="S4.SS1.SSS1.p1.15.m4.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p1.15.m4.1.1.2.cmml" xref="S4.SS1.SSS1.p1.15.m4.1.1.2">𝑏</ci><ci id="S4.SS1.SSS1.p1.15.m4.1.1.3.cmml" xref="S4.SS1.SSS1.p1.15.m4.1.1.3">′′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.15.m4.1c">b^{\prime\prime}</annotation></semantics></math> is a learned bias term. The traditional models that use a matrix multiplication <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> correspond to <math id="S4.SS1.SSS1.p1.16.m5.1" class="ltx_Math" alttext="g_{\mathit{\Phi}}(\cdot)" display="inline"><semantics id="S4.SS1.SSS1.p1.16.m5.1a"><mrow id="S4.SS1.SSS1.p1.16.m5.1.2" xref="S4.SS1.SSS1.p1.16.m5.1.2.cmml"><msub id="S4.SS1.SSS1.p1.16.m5.1.2.2" xref="S4.SS1.SSS1.p1.16.m5.1.2.2.cmml"><mi id="S4.SS1.SSS1.p1.16.m5.1.2.2.2" xref="S4.SS1.SSS1.p1.16.m5.1.2.2.2.cmml">g</mi><mi id="S4.SS1.SSS1.p1.16.m5.1.2.2.3" xref="S4.SS1.SSS1.p1.16.m5.1.2.2.3.cmml">Φ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.16.m5.1.2.1" xref="S4.SS1.SSS1.p1.16.m5.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p1.16.m5.1.2.3.2" xref="S4.SS1.SSS1.p1.16.m5.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.16.m5.1.2.3.2.1" xref="S4.SS1.SSS1.p1.16.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.16.m5.1.1" xref="S4.SS1.SSS1.p1.16.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS1.p1.16.m5.1.2.3.2.2" xref="S4.SS1.SSS1.p1.16.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.16.m5.1b"><apply id="S4.SS1.SSS1.p1.16.m5.1.2.cmml" xref="S4.SS1.SSS1.p1.16.m5.1.2"><times id="S4.SS1.SSS1.p1.16.m5.1.2.1.cmml" xref="S4.SS1.SSS1.p1.16.m5.1.2.1"></times><apply id="S4.SS1.SSS1.p1.16.m5.1.2.2.cmml" xref="S4.SS1.SSS1.p1.16.m5.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.16.m5.1.2.2.1.cmml" xref="S4.SS1.SSS1.p1.16.m5.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p1.16.m5.1.2.2.2.cmml" xref="S4.SS1.SSS1.p1.16.m5.1.2.2.2">𝑔</ci><ci id="S4.SS1.SSS1.p1.16.m5.1.2.2.3.cmml" xref="S4.SS1.SSS1.p1.16.m5.1.2.2.3">𝛷</ci></apply><ci id="S4.SS1.SSS1.p1.16.m5.1.1.cmml" xref="S4.SS1.SSS1.p1.16.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.16.m5.1c">g_{\mathit{\Phi}}(\cdot)</annotation></semantics></math> that uses a dot product as the similarity function. In comparison, our definition generalizes to multiple prototypes per answer and to different similarity measures. Our experiments evaluate the dot product and the weighted L-p norm of vector differences:</p>
<table id="A4.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4.m1.2" class="ltx_Math" alttext="\displaystyle d_{\mathsf{dot}}({\boldsymbol{h}},{\boldsymbol{\theta}})" display="inline"><semantics id="S4.E4.m1.2a"><mrow id="S4.E4.m1.2.3" xref="S4.E4.m1.2.3.cmml"><msub id="S4.E4.m1.2.3.2" xref="S4.E4.m1.2.3.2.cmml"><mi id="S4.E4.m1.2.3.2.2" xref="S4.E4.m1.2.3.2.2.cmml">d</mi><mi id="S4.E4.m1.2.3.2.3" xref="S4.E4.m1.2.3.2.3.cmml">𝖽𝗈𝗍</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.3.1" xref="S4.E4.m1.2.3.1.cmml">​</mo><mrow id="S4.E4.m1.2.3.3.2" xref="S4.E4.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.E4.m1.2.3.3.2.1" xref="S4.E4.m1.2.3.3.1.cmml">(</mo><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">𝒉</mi><mo id="S4.E4.m1.2.3.3.2.2" xref="S4.E4.m1.2.3.3.1.cmml">,</mo><mi id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml">𝜽</mi><mo stretchy="false" id="S4.E4.m1.2.3.3.2.3" xref="S4.E4.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b"><apply id="S4.E4.m1.2.3.cmml" xref="S4.E4.m1.2.3"><times id="S4.E4.m1.2.3.1.cmml" xref="S4.E4.m1.2.3.1"></times><apply id="S4.E4.m1.2.3.2.cmml" xref="S4.E4.m1.2.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.3.2.1.cmml" xref="S4.E4.m1.2.3.2">subscript</csymbol><ci id="S4.E4.m1.2.3.2.2.cmml" xref="S4.E4.m1.2.3.2.2">𝑑</ci><ci id="S4.E4.m1.2.3.2.3.cmml" xref="S4.E4.m1.2.3.2.3">𝖽𝗈𝗍</ci></apply><interval closure="open" id="S4.E4.m1.2.3.3.1.cmml" xref="S4.E4.m1.2.3.3.2"><ci id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">𝒉</ci><ci id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2">𝜽</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.2c">\displaystyle d_{\mathsf{dot}}({\boldsymbol{h}},{\boldsymbol{\theta}})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E4.m2.1" class="ltx_Math" alttext="\displaystyle~{}~{}=~{}~{}{\boldsymbol{h}}^{\intercal}\,{\boldsymbol{\theta}}" display="inline"><semantics id="S4.E4.m2.1a"><mrow id="S4.E4.m2.1.1" xref="S4.E4.m2.1.1.cmml"><mi id="S4.E4.m2.1.1.2" xref="S4.E4.m2.1.1.2.cmml"></mi><mo lspace="0.938em" rspace="0.938em" id="S4.E4.m2.1.1.1" xref="S4.E4.m2.1.1.1.cmml">=</mo><mrow id="S4.E4.m2.1.1.3" xref="S4.E4.m2.1.1.3.cmml"><msup id="S4.E4.m2.1.1.3.2" xref="S4.E4.m2.1.1.3.2.cmml"><mi id="S4.E4.m2.1.1.3.2.2" xref="S4.E4.m2.1.1.3.2.2.cmml">𝒉</mi><mo id="S4.E4.m2.1.1.3.2.3" xref="S4.E4.m2.1.1.3.2.3.cmml">⊺</mo></msup><mo lspace="0em" rspace="0em" id="S4.E4.m2.1.1.3.1" xref="S4.E4.m2.1.1.3.1.cmml">​</mo><mi id="S4.E4.m2.1.1.3.3" xref="S4.E4.m2.1.1.3.3.cmml">𝜽</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m2.1b"><apply id="S4.E4.m2.1.1.cmml" xref="S4.E4.m2.1.1"><eq id="S4.E4.m2.1.1.1.cmml" xref="S4.E4.m2.1.1.1"></eq><csymbol cd="latexml" id="S4.E4.m2.1.1.2.cmml" xref="S4.E4.m2.1.1.2">absent</csymbol><apply id="S4.E4.m2.1.1.3.cmml" xref="S4.E4.m2.1.1.3"><times id="S4.E4.m2.1.1.3.1.cmml" xref="S4.E4.m2.1.1.3.1"></times><apply id="S4.E4.m2.1.1.3.2.cmml" xref="S4.E4.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E4.m2.1.1.3.2.1.cmml" xref="S4.E4.m2.1.1.3.2">superscript</csymbol><ci id="S4.E4.m2.1.1.3.2.2.cmml" xref="S4.E4.m2.1.1.3.2.2">𝒉</ci><ci id="S4.E4.m2.1.1.3.2.3.cmml" xref="S4.E4.m2.1.1.3.2.3">⊺</ci></apply><ci id="S4.E4.m2.1.1.3.3.cmml" xref="S4.E4.m2.1.1.3.3">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m2.1c">\displaystyle~{}~{}=~{}~{}{\boldsymbol{h}}^{\intercal}\,{\boldsymbol{\theta}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E5.m1.2" class="ltx_Math" alttext="\displaystyle d_{\mathsf{L1}}({\boldsymbol{h}},{\boldsymbol{\theta}})" display="inline"><semantics id="S4.E5.m1.2a"><mrow id="S4.E5.m1.2.3" xref="S4.E5.m1.2.3.cmml"><msub id="S4.E5.m1.2.3.2" xref="S4.E5.m1.2.3.2.cmml"><mi id="S4.E5.m1.2.3.2.2" xref="S4.E5.m1.2.3.2.2.cmml">d</mi><mi id="S4.E5.m1.2.3.2.3" xref="S4.E5.m1.2.3.2.3.cmml">𝖫𝟣</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.3.1" xref="S4.E5.m1.2.3.1.cmml">​</mo><mrow id="S4.E5.m1.2.3.3.2" xref="S4.E5.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.E5.m1.2.3.3.2.1" xref="S4.E5.m1.2.3.3.1.cmml">(</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">𝒉</mi><mo id="S4.E5.m1.2.3.3.2.2" xref="S4.E5.m1.2.3.3.1.cmml">,</mo><mi id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">𝜽</mi><mo stretchy="false" id="S4.E5.m1.2.3.3.2.3" xref="S4.E5.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.2b"><apply id="S4.E5.m1.2.3.cmml" xref="S4.E5.m1.2.3"><times id="S4.E5.m1.2.3.1.cmml" xref="S4.E5.m1.2.3.1"></times><apply id="S4.E5.m1.2.3.2.cmml" xref="S4.E5.m1.2.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.3.2.1.cmml" xref="S4.E5.m1.2.3.2">subscript</csymbol><ci id="S4.E5.m1.2.3.2.2.cmml" xref="S4.E5.m1.2.3.2.2">𝑑</ci><ci id="S4.E5.m1.2.3.2.3.cmml" xref="S4.E5.m1.2.3.2.3">𝖫𝟣</ci></apply><interval closure="open" id="S4.E5.m1.2.3.3.1.cmml" xref="S4.E5.m1.2.3.3.2"><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝒉</ci><ci id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">𝜽</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.2c">\displaystyle d_{\mathsf{L1}}({\boldsymbol{h}},{\boldsymbol{\theta}})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E5.m2.3" class="ltx_Math" alttext="\displaystyle~{}~{}=~{}~{}{\boldsymbol{w}}^{\prime\prime\prime\intercal}\,\left|{\boldsymbol{h}}-{\boldsymbol{\theta}}\right|" display="inline"><semantics id="S4.E5.m2.3a"><mrow id="S4.E5.m2.3.3" xref="S4.E5.m2.3.3.cmml"><mi id="S4.E5.m2.3.3.3" xref="S4.E5.m2.3.3.3.cmml"></mi><mo lspace="0.938em" rspace="0.938em" id="S4.E5.m2.3.3.2" xref="S4.E5.m2.3.3.2.cmml">=</mo><mrow id="S4.E5.m2.3.3.1" xref="S4.E5.m2.3.3.1.cmml"><msup id="S4.E5.m2.3.3.1.3" xref="S4.E5.m2.3.3.1.3.cmml"><mi id="S4.E5.m2.3.3.1.3.2" xref="S4.E5.m2.3.3.1.3.2.cmml">𝒘</mi><mrow id="S4.E5.m2.2.2.2.2" xref="S4.E5.m2.2.2.2.3.cmml"><mo mathsize="142%" id="S4.E5.m2.2.2.2.2.1" xref="S4.E5.m2.2.2.2.2.1.cmml">′′′</mo><mo lspace="0.222em" id="S4.E5.m2.2.2.2.2.2" xref="S4.E5.m2.2.2.2.3.cmml">⁣</mo><mo id="S4.E5.m2.1.1.1.1" xref="S4.E5.m2.1.1.1.1.cmml">⊺</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S4.E5.m2.3.3.1.2" xref="S4.E5.m2.3.3.1.2.cmml">​</mo><mrow id="S4.E5.m2.3.3.1.1.1" xref="S4.E5.m2.3.3.1.1.2.cmml"><mo id="S4.E5.m2.3.3.1.1.1.2" xref="S4.E5.m2.3.3.1.1.2.1.cmml">|</mo><mrow id="S4.E5.m2.3.3.1.1.1.1" xref="S4.E5.m2.3.3.1.1.1.1.cmml"><mi id="S4.E5.m2.3.3.1.1.1.1.2" xref="S4.E5.m2.3.3.1.1.1.1.2.cmml">𝒉</mi><mo id="S4.E5.m2.3.3.1.1.1.1.1" xref="S4.E5.m2.3.3.1.1.1.1.1.cmml">−</mo><mi id="S4.E5.m2.3.3.1.1.1.1.3" xref="S4.E5.m2.3.3.1.1.1.1.3.cmml">𝜽</mi></mrow><mo id="S4.E5.m2.3.3.1.1.1.3" xref="S4.E5.m2.3.3.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m2.3b"><apply id="S4.E5.m2.3.3.cmml" xref="S4.E5.m2.3.3"><eq id="S4.E5.m2.3.3.2.cmml" xref="S4.E5.m2.3.3.2"></eq><csymbol cd="latexml" id="S4.E5.m2.3.3.3.cmml" xref="S4.E5.m2.3.3.3">absent</csymbol><apply id="S4.E5.m2.3.3.1.cmml" xref="S4.E5.m2.3.3.1"><times id="S4.E5.m2.3.3.1.2.cmml" xref="S4.E5.m2.3.3.1.2"></times><apply id="S4.E5.m2.3.3.1.3.cmml" xref="S4.E5.m2.3.3.1.3"><csymbol cd="ambiguous" id="S4.E5.m2.3.3.1.3.1.cmml" xref="S4.E5.m2.3.3.1.3">superscript</csymbol><ci id="S4.E5.m2.3.3.1.3.2.cmml" xref="S4.E5.m2.3.3.1.3.2">𝒘</ci><list id="S4.E5.m2.2.2.2.3.cmml" xref="S4.E5.m2.2.2.2.2"><ci id="S4.E5.m2.2.2.2.2.1.cmml" xref="S4.E5.m2.2.2.2.2.1">′′′</ci><ci id="S4.E5.m2.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1">⊺</ci></list></apply><apply id="S4.E5.m2.3.3.1.1.2.cmml" xref="S4.E5.m2.3.3.1.1.1"><abs id="S4.E5.m2.3.3.1.1.2.1.cmml" xref="S4.E5.m2.3.3.1.1.1.2"></abs><apply id="S4.E5.m2.3.3.1.1.1.1.cmml" xref="S4.E5.m2.3.3.1.1.1.1"><minus id="S4.E5.m2.3.3.1.1.1.1.1.cmml" xref="S4.E5.m2.3.3.1.1.1.1.1"></minus><ci id="S4.E5.m2.3.3.1.1.1.1.2.cmml" xref="S4.E5.m2.3.3.1.1.1.1.2">𝒉</ci><ci id="S4.E5.m2.3.3.1.1.1.1.3.cmml" xref="S4.E5.m2.3.3.1.1.1.1.3">𝜽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m2.3c">\displaystyle~{}~{}=~{}~{}{\boldsymbol{w}}^{\prime\prime\prime\intercal}\,\left|{\boldsymbol{h}}-{\boldsymbol{\theta}}\right|</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6.m1.2" class="ltx_Math" alttext="\displaystyle d_{\mathsf{L2}}({\boldsymbol{h}},{\boldsymbol{\theta}})" display="inline"><semantics id="S4.E6.m1.2a"><mrow id="S4.E6.m1.2.3" xref="S4.E6.m1.2.3.cmml"><msub id="S4.E6.m1.2.3.2" xref="S4.E6.m1.2.3.2.cmml"><mi id="S4.E6.m1.2.3.2.2" xref="S4.E6.m1.2.3.2.2.cmml">d</mi><mi id="S4.E6.m1.2.3.2.3" xref="S4.E6.m1.2.3.2.3.cmml">𝖫𝟤</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.3.1" xref="S4.E6.m1.2.3.1.cmml">​</mo><mrow id="S4.E6.m1.2.3.3.2" xref="S4.E6.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.E6.m1.2.3.3.2.1" xref="S4.E6.m1.2.3.3.1.cmml">(</mo><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">𝒉</mi><mo id="S4.E6.m1.2.3.3.2.2" xref="S4.E6.m1.2.3.3.1.cmml">,</mo><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">𝜽</mi><mo stretchy="false" id="S4.E6.m1.2.3.3.2.3" xref="S4.E6.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.2b"><apply id="S4.E6.m1.2.3.cmml" xref="S4.E6.m1.2.3"><times id="S4.E6.m1.2.3.1.cmml" xref="S4.E6.m1.2.3.1"></times><apply id="S4.E6.m1.2.3.2.cmml" xref="S4.E6.m1.2.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.3.2.1.cmml" xref="S4.E6.m1.2.3.2">subscript</csymbol><ci id="S4.E6.m1.2.3.2.2.cmml" xref="S4.E6.m1.2.3.2.2">𝑑</ci><ci id="S4.E6.m1.2.3.2.3.cmml" xref="S4.E6.m1.2.3.2.3">𝖫𝟤</ci></apply><interval closure="open" id="S4.E6.m1.2.3.3.1.cmml" xref="S4.E6.m1.2.3.3.2"><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">𝒉</ci><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">𝜽</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.2c">\displaystyle d_{\mathsf{L2}}({\boldsymbol{h}},{\boldsymbol{\theta}})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E6.m2.3" class="ltx_Math" alttext="\displaystyle~{}~{}=~{}~{}{\boldsymbol{w}}^{\prime\prime\prime\intercal}\,({\boldsymbol{h}}-{\boldsymbol{\theta}})^{2}" display="inline"><semantics id="S4.E6.m2.3a"><mrow id="S4.E6.m2.3.3" xref="S4.E6.m2.3.3.cmml"><mi id="S4.E6.m2.3.3.3" xref="S4.E6.m2.3.3.3.cmml"></mi><mo lspace="0.938em" rspace="0.938em" id="S4.E6.m2.3.3.2" xref="S4.E6.m2.3.3.2.cmml">=</mo><mrow id="S4.E6.m2.3.3.1" xref="S4.E6.m2.3.3.1.cmml"><msup id="S4.E6.m2.3.3.1.3" xref="S4.E6.m2.3.3.1.3.cmml"><mi id="S4.E6.m2.3.3.1.3.2" xref="S4.E6.m2.3.3.1.3.2.cmml">𝒘</mi><mrow id="S4.E6.m2.2.2.2.2" xref="S4.E6.m2.2.2.2.3.cmml"><mo mathsize="142%" id="S4.E6.m2.2.2.2.2.1" xref="S4.E6.m2.2.2.2.2.1.cmml">′′′</mo><mo lspace="0.222em" id="S4.E6.m2.2.2.2.2.2" xref="S4.E6.m2.2.2.2.3.cmml">⁣</mo><mo id="S4.E6.m2.1.1.1.1" xref="S4.E6.m2.1.1.1.1.cmml">⊺</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S4.E6.m2.3.3.1.2" xref="S4.E6.m2.3.3.1.2.cmml">​</mo><msup id="S4.E6.m2.3.3.1.1" xref="S4.E6.m2.3.3.1.1.cmml"><mrow id="S4.E6.m2.3.3.1.1.1.1" xref="S4.E6.m2.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m2.3.3.1.1.1.1.2" xref="S4.E6.m2.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m2.3.3.1.1.1.1.1" xref="S4.E6.m2.3.3.1.1.1.1.1.cmml"><mi id="S4.E6.m2.3.3.1.1.1.1.1.2" xref="S4.E6.m2.3.3.1.1.1.1.1.2.cmml">𝒉</mi><mo id="S4.E6.m2.3.3.1.1.1.1.1.1" xref="S4.E6.m2.3.3.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E6.m2.3.3.1.1.1.1.1.3" xref="S4.E6.m2.3.3.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo stretchy="false" id="S4.E6.m2.3.3.1.1.1.1.3" xref="S4.E6.m2.3.3.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E6.m2.3.3.1.1.3" xref="S4.E6.m2.3.3.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m2.3b"><apply id="S4.E6.m2.3.3.cmml" xref="S4.E6.m2.3.3"><eq id="S4.E6.m2.3.3.2.cmml" xref="S4.E6.m2.3.3.2"></eq><csymbol cd="latexml" id="S4.E6.m2.3.3.3.cmml" xref="S4.E6.m2.3.3.3">absent</csymbol><apply id="S4.E6.m2.3.3.1.cmml" xref="S4.E6.m2.3.3.1"><times id="S4.E6.m2.3.3.1.2.cmml" xref="S4.E6.m2.3.3.1.2"></times><apply id="S4.E6.m2.3.3.1.3.cmml" xref="S4.E6.m2.3.3.1.3"><csymbol cd="ambiguous" id="S4.E6.m2.3.3.1.3.1.cmml" xref="S4.E6.m2.3.3.1.3">superscript</csymbol><ci id="S4.E6.m2.3.3.1.3.2.cmml" xref="S4.E6.m2.3.3.1.3.2">𝒘</ci><list id="S4.E6.m2.2.2.2.3.cmml" xref="S4.E6.m2.2.2.2.2"><ci id="S4.E6.m2.2.2.2.2.1.cmml" xref="S4.E6.m2.2.2.2.2.1">′′′</ci><ci id="S4.E6.m2.1.1.1.1.cmml" xref="S4.E6.m2.1.1.1.1">⊺</ci></list></apply><apply id="S4.E6.m2.3.3.1.1.cmml" xref="S4.E6.m2.3.3.1.1"><csymbol cd="ambiguous" id="S4.E6.m2.3.3.1.1.2.cmml" xref="S4.E6.m2.3.3.1.1">superscript</csymbol><apply id="S4.E6.m2.3.3.1.1.1.1.1.cmml" xref="S4.E6.m2.3.3.1.1.1.1"><minus id="S4.E6.m2.3.3.1.1.1.1.1.1.cmml" xref="S4.E6.m2.3.3.1.1.1.1.1.1"></minus><ci id="S4.E6.m2.3.3.1.1.1.1.1.2.cmml" xref="S4.E6.m2.3.3.1.1.1.1.1.2">𝒉</ci><ci id="S4.E6.m2.3.3.1.1.1.1.1.3.cmml" xref="S4.E6.m2.3.3.1.1.1.1.1.3">𝜽</ci></apply><cn type="integer" id="S4.E6.m2.3.3.1.1.3.cmml" xref="S4.E6.m2.3.3.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m2.3c">\displaystyle~{}~{}=~{}~{}{\boldsymbol{w}}^{\prime\prime\prime\intercal}\,({\boldsymbol{h}}-{\boldsymbol{\theta}})^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS1.p1.17" class="ltx_p">where <math id="S4.SS1.SSS1.p1.17.m1.1" class="ltx_Math" alttext="{\boldsymbol{w}}^{\prime\prime\prime}\in\mathbb{R}^{D}" display="inline"><semantics id="S4.SS1.SSS1.p1.17.m1.1a"><mrow id="S4.SS1.SSS1.p1.17.m1.1.1" xref="S4.SS1.SSS1.p1.17.m1.1.1.cmml"><msup id="S4.SS1.SSS1.p1.17.m1.1.1.2" xref="S4.SS1.SSS1.p1.17.m1.1.1.2.cmml"><mi id="S4.SS1.SSS1.p1.17.m1.1.1.2.2" xref="S4.SS1.SSS1.p1.17.m1.1.1.2.2.cmml">𝒘</mi><mo id="S4.SS1.SSS1.p1.17.m1.1.1.2.3" xref="S4.SS1.SSS1.p1.17.m1.1.1.2.3.cmml">′′′</mo></msup><mo id="S4.SS1.SSS1.p1.17.m1.1.1.1" xref="S4.SS1.SSS1.p1.17.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS1.p1.17.m1.1.1.3" xref="S4.SS1.SSS1.p1.17.m1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.17.m1.1.1.3.2" xref="S4.SS1.SSS1.p1.17.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS1.SSS1.p1.17.m1.1.1.3.3" xref="S4.SS1.SSS1.p1.17.m1.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.17.m1.1b"><apply id="S4.SS1.SSS1.p1.17.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.17.m1.1.1"><in id="S4.SS1.SSS1.p1.17.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.17.m1.1.1.1"></in><apply id="S4.SS1.SSS1.p1.17.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.17.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.17.m1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.17.m1.1.1.2">superscript</csymbol><ci id="S4.SS1.SSS1.p1.17.m1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.17.m1.1.1.2.2">𝒘</ci><ci id="S4.SS1.SSS1.p1.17.m1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p1.17.m1.1.1.2.3">′′′</ci></apply><apply id="S4.SS1.SSS1.p1.17.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.17.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.17.m1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.17.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS1.p1.17.m1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.17.m1.1.1.3.2">ℝ</ci><ci id="S4.SS1.SSS1.p1.17.m1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.17.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.17.m1.1c">{\boldsymbol{w}}^{\prime\prime\prime}\in\mathbb{R}^{D}</annotation></semantics></math> is a vector of learned weights applied coordinate-wise.</p>
</div>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.6" class="ltx_p">Our model uses two sets of prototypes, the static <math id="S4.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\mathit{\Phi}^{\mathsf{s}}" display="inline"><semantics id="S4.SS1.SSS1.p2.1.m1.1a"><msup id="S4.SS1.SSS1.p2.1.m1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.cmml">Φ</mi><mi id="S4.SS1.SSS1.p2.1.m1.1.1.3" xref="S4.SS1.SSS1.p2.1.m1.1.1.3.cmml">𝗌</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.1.m1.1b"><apply id="S4.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2">𝛷</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.3">𝗌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.1.m1.1c">\mathit{\Phi}^{\mathsf{s}}</annotation></semantics></math> and the dynamic <math id="S4.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\mathit{\Phi}^{\mathsf{d}}" display="inline"><semantics id="S4.SS1.SSS1.p2.2.m2.1a"><msup id="S4.SS1.SSS1.p2.2.m2.1.1" xref="S4.SS1.SSS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.SSS1.p2.2.m2.1.1.2" xref="S4.SS1.SSS1.p2.2.m2.1.1.2.cmml">Φ</mi><mi id="S4.SS1.SSS1.p2.2.m2.1.1.3" xref="S4.SS1.SSS1.p2.2.m2.1.1.3.cmml">𝖽</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.2.m2.1b"><apply id="S4.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.2">𝛷</ci><ci id="S4.SS1.SSS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1.3">𝖽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.2.m2.1c">\mathit{\Phi}^{\mathsf{d}}</annotation></semantics></math>. The static ones are learned during training as traditional weights by backpropagation and gradient descent, and held fixed at test time. The dynamic ones are determined at test time by processing the provided support set (see Section <a href="#S4.SS2" title="4.2 Processing of Support Set ‣ 4 Proposed Model ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>). Thereafter, all prototypes <math id="S4.SS1.SSS1.p2.3.m3.1" class="ltx_Math" alttext="\mathit{\Phi}=\mathit{\Phi}^{\mathsf{s}}\,\cup\,\mathit{\Phi}^{\mathsf{d}}" display="inline"><semantics id="S4.SS1.SSS1.p2.3.m3.1a"><mrow id="S4.SS1.SSS1.p2.3.m3.1.1" xref="S4.SS1.SSS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.SSS1.p2.3.m3.1.1.2" xref="S4.SS1.SSS1.p2.3.m3.1.1.2.cmml">Φ</mi><mo id="S4.SS1.SSS1.p2.3.m3.1.1.1" xref="S4.SS1.SSS1.p2.3.m3.1.1.1.cmml">=</mo><mrow id="S4.SS1.SSS1.p2.3.m3.1.1.3" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.cmml"><msup id="S4.SS1.SSS1.p2.3.m3.1.1.3.2" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.2.cmml"><mi id="S4.SS1.SSS1.p2.3.m3.1.1.3.2.2" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.2.2.cmml">Φ</mi><mi id="S4.SS1.SSS1.p2.3.m3.1.1.3.2.3" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.2.3.cmml">𝗌</mi></msup><mo rspace="0.392em" id="S4.SS1.SSS1.p2.3.m3.1.1.3.1" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.1.cmml">∪</mo><msup id="S4.SS1.SSS1.p2.3.m3.1.1.3.3" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.2" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.2.cmml">Φ</mi><mi id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.3" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.3.cmml">𝖽</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.3.m3.1b"><apply id="S4.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1"><eq id="S4.SS1.SSS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.1"></eq><ci id="S4.SS1.SSS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.2">𝛷</ci><apply id="S4.SS1.SSS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3"><union id="S4.SS1.SSS1.p2.3.m3.1.1.3.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.1"></union><apply id="S4.SS1.SSS1.p2.3.m3.1.1.3.2.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.3.m3.1.1.3.2.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.2">superscript</csymbol><ci id="S4.SS1.SSS1.p2.3.m3.1.1.3.2.2.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.2.2">𝛷</ci><ci id="S4.SS1.SSS1.p2.3.m3.1.1.3.2.3.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.2.3">𝗌</ci></apply><apply id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3">superscript</csymbol><ci id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.2">𝛷</ci><ci id="S4.SS1.SSS1.p2.3.m3.1.1.3.3.3.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1.3.3.3">𝖽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.3.m3.1c">\mathit{\Phi}=\mathit{\Phi}^{\mathsf{s}}\,\cup\,\mathit{\Phi}^{\mathsf{d}}</annotation></semantics></math> are used indistinctively. Note that our formulation of <math id="S4.SS1.SSS1.p2.4.m4.1" class="ltx_Math" alttext="g_{\mathit{\Phi}}(\cdot)" display="inline"><semantics id="S4.SS1.SSS1.p2.4.m4.1a"><mrow id="S4.SS1.SSS1.p2.4.m4.1.2" xref="S4.SS1.SSS1.p2.4.m4.1.2.cmml"><msub id="S4.SS1.SSS1.p2.4.m4.1.2.2" xref="S4.SS1.SSS1.p2.4.m4.1.2.2.cmml"><mi id="S4.SS1.SSS1.p2.4.m4.1.2.2.2" xref="S4.SS1.SSS1.p2.4.m4.1.2.2.2.cmml">g</mi><mi id="S4.SS1.SSS1.p2.4.m4.1.2.2.3" xref="S4.SS1.SSS1.p2.4.m4.1.2.2.3.cmml">Φ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.4.m4.1.2.1" xref="S4.SS1.SSS1.p2.4.m4.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p2.4.m4.1.2.3.2" xref="S4.SS1.SSS1.p2.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p2.4.m4.1.2.3.2.1" xref="S4.SS1.SSS1.p2.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.4.m4.1.1" xref="S4.SS1.SSS1.p2.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS1.p2.4.m4.1.2.3.2.2" xref="S4.SS1.SSS1.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.4.m4.1b"><apply id="S4.SS1.SSS1.p2.4.m4.1.2.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.2"><times id="S4.SS1.SSS1.p2.4.m4.1.2.1.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.2.1"></times><apply id="S4.SS1.SSS1.p2.4.m4.1.2.2.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.4.m4.1.2.2.1.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p2.4.m4.1.2.2.2.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.2.2.2">𝑔</ci><ci id="S4.SS1.SSS1.p2.4.m4.1.2.2.3.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.2.2.3">𝛷</ci></apply><ci id="S4.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.4.m4.1c">g_{\mathit{\Phi}}(\cdot)</annotation></semantics></math> can be made equivalent to the original model of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> by using only static prototypes (<math id="S4.SS1.SSS1.p2.5.m5.1" class="ltx_Math" alttext="\mathit{\Phi}=\mathit{\Phi}^{\mathsf{d}}" display="inline"><semantics id="S4.SS1.SSS1.p2.5.m5.1a"><mrow id="S4.SS1.SSS1.p2.5.m5.1.1" xref="S4.SS1.SSS1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.SSS1.p2.5.m5.1.1.2" xref="S4.SS1.SSS1.p2.5.m5.1.1.2.cmml">Φ</mi><mo id="S4.SS1.SSS1.p2.5.m5.1.1.1" xref="S4.SS1.SSS1.p2.5.m5.1.1.1.cmml">=</mo><msup id="S4.SS1.SSS1.p2.5.m5.1.1.3" xref="S4.SS1.SSS1.p2.5.m5.1.1.3.cmml"><mi id="S4.SS1.SSS1.p2.5.m5.1.1.3.2" xref="S4.SS1.SSS1.p2.5.m5.1.1.3.2.cmml">Φ</mi><mi id="S4.SS1.SSS1.p2.5.m5.1.1.3.3" xref="S4.SS1.SSS1.p2.5.m5.1.1.3.3.cmml">𝖽</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.5.m5.1b"><apply id="S4.SS1.SSS1.p2.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1"><eq id="S4.SS1.SSS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1.1"></eq><ci id="S4.SS1.SSS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1.2">𝛷</ci><apply id="S4.SS1.SSS1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.5.m5.1.1.3.1.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS1.p2.5.m5.1.1.3.2.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1.3.2">𝛷</ci><ci id="S4.SS1.SSS1.p2.5.m5.1.1.3.3.cmml" xref="S4.SS1.SSS1.p2.5.m5.1.1.3.3">𝖽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.5.m5.1c">\mathit{\Phi}=\mathit{\Phi}^{\mathsf{d}}</annotation></semantics></math>) and the dot-product similarity measure <math id="S4.SS1.SSS1.p2.6.m6.2" class="ltx_Math" alttext="d_{\mathsf{dot}}(\cdot,\cdot)" display="inline"><semantics id="S4.SS1.SSS1.p2.6.m6.2a"><mrow id="S4.SS1.SSS1.p2.6.m6.2.3" xref="S4.SS1.SSS1.p2.6.m6.2.3.cmml"><msub id="S4.SS1.SSS1.p2.6.m6.2.3.2" xref="S4.SS1.SSS1.p2.6.m6.2.3.2.cmml"><mi id="S4.SS1.SSS1.p2.6.m6.2.3.2.2" xref="S4.SS1.SSS1.p2.6.m6.2.3.2.2.cmml">d</mi><mi id="S4.SS1.SSS1.p2.6.m6.2.3.2.3" xref="S4.SS1.SSS1.p2.6.m6.2.3.2.3.cmml">𝖽𝗈𝗍</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.6.m6.2.3.1" xref="S4.SS1.SSS1.p2.6.m6.2.3.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p2.6.m6.2.3.3.2" xref="S4.SS1.SSS1.p2.6.m6.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p2.6.m6.2.3.3.2.1" xref="S4.SS1.SSS1.p2.6.m6.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.6.m6.1.1" xref="S4.SS1.SSS1.p2.6.m6.1.1.cmml">⋅</mo><mo rspace="0em" id="S4.SS1.SSS1.p2.6.m6.2.3.3.2.2" xref="S4.SS1.SSS1.p2.6.m6.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.6.m6.2.2" xref="S4.SS1.SSS1.p2.6.m6.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS1.p2.6.m6.2.3.3.2.3" xref="S4.SS1.SSS1.p2.6.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.6.m6.2b"><apply id="S4.SS1.SSS1.p2.6.m6.2.3.cmml" xref="S4.SS1.SSS1.p2.6.m6.2.3"><times id="S4.SS1.SSS1.p2.6.m6.2.3.1.cmml" xref="S4.SS1.SSS1.p2.6.m6.2.3.1"></times><apply id="S4.SS1.SSS1.p2.6.m6.2.3.2.cmml" xref="S4.SS1.SSS1.p2.6.m6.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p2.6.m6.2.3.2.1.cmml" xref="S4.SS1.SSS1.p2.6.m6.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS1.p2.6.m6.2.3.2.2.cmml" xref="S4.SS1.SSS1.p2.6.m6.2.3.2.2">𝑑</ci><ci id="S4.SS1.SSS1.p2.6.m6.2.3.2.3.cmml" xref="S4.SS1.SSS1.p2.6.m6.2.3.2.3">𝖽𝗈𝗍</ci></apply><interval closure="open" id="S4.SS1.SSS1.p2.6.m6.2.3.3.1.cmml" xref="S4.SS1.SSS1.p2.6.m6.2.3.3.2"><ci id="S4.SS1.SSS1.p2.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p2.6.m6.1.1">⋅</ci><ci id="S4.SS1.SSS1.p2.6.m6.2.2.cmml" xref="S4.SS1.SSS1.p2.6.m6.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.6.m6.2c">d_{\mathsf{dot}}(\cdot,\cdot)</annotation></semantics></math>. This will serve as a baseline in our experiments (Section <a href="#S5" title="5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
<div id="S4.SS1.SSS1.p3" class="ltx_para">
<p id="S4.SS1.SSS1.p3.1" class="ltx_p">Finally, the output of the network is attached to a cross-entropy loss <math id="S4.SS1.SSS1.p3.1.m1.2" class="ltx_Math" alttext="\mathscr{L}({\boldsymbol{s}},\hat{{\boldsymbol{s}}})" display="inline"><semantics id="S4.SS1.SSS1.p3.1.m1.2a"><mrow id="S4.SS1.SSS1.p3.1.m1.2.3" xref="S4.SS1.SSS1.p3.1.m1.2.3.cmml"><mi class="ltx_font_mathscript" id="S4.SS1.SSS1.p3.1.m1.2.3.2" xref="S4.SS1.SSS1.p3.1.m1.2.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p3.1.m1.2.3.1" xref="S4.SS1.SSS1.p3.1.m1.2.3.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p3.1.m1.2.3.3.2" xref="S4.SS1.SSS1.p3.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p3.1.m1.2.3.3.2.1" xref="S4.SS1.SSS1.p3.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS1.SSS1.p3.1.m1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.cmml">𝒔</mi><mo id="S4.SS1.SSS1.p3.1.m1.2.3.3.2.2" xref="S4.SS1.SSS1.p3.1.m1.2.3.3.1.cmml">,</mo><mover accent="true" id="S4.SS1.SSS1.p3.1.m1.2.2" xref="S4.SS1.SSS1.p3.1.m1.2.2.cmml"><mi id="S4.SS1.SSS1.p3.1.m1.2.2.2" xref="S4.SS1.SSS1.p3.1.m1.2.2.2.cmml">𝒔</mi><mo id="S4.SS1.SSS1.p3.1.m1.2.2.1" xref="S4.SS1.SSS1.p3.1.m1.2.2.1.cmml">^</mo></mover><mo stretchy="false" id="S4.SS1.SSS1.p3.1.m1.2.3.3.2.3" xref="S4.SS1.SSS1.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.1.m1.2b"><apply id="S4.SS1.SSS1.p3.1.m1.2.3.cmml" xref="S4.SS1.SSS1.p3.1.m1.2.3"><times id="S4.SS1.SSS1.p3.1.m1.2.3.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.2.3.1"></times><ci id="S4.SS1.SSS1.p3.1.m1.2.3.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.2.3.2">ℒ</ci><interval closure="open" id="S4.SS1.SSS1.p3.1.m1.2.3.3.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.2.3.3.2"><ci id="S4.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1">𝒔</ci><apply id="S4.SS1.SSS1.p3.1.m1.2.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.2.2"><ci id="S4.SS1.SSS1.p3.1.m1.2.2.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.2.2.1">^</ci><ci id="S4.SS1.SSS1.p3.1.m1.2.2.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.2.2.2">𝒔</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.1.m1.2c">\mathscr{L}({\boldsymbol{s}},\hat{{\boldsymbol{s}}})</annotation></semantics></math> between the predicted and ground truth for training the model end-to-end <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Processing of Support Set</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.2" class="ltx_p">Both functions <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="f_{\boldsymbol{\theta}}(\cdot)" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.2" xref="S4.SS2.p1.1.m1.1.2.cmml"><msub id="S4.SS2.p1.1.m1.1.2.2" xref="S4.SS2.p1.1.m1.1.2.2.cmml"><mi id="S4.SS2.p1.1.m1.1.2.2.2" xref="S4.SS2.p1.1.m1.1.2.2.2.cmml">f</mi><mi id="S4.SS2.p1.1.m1.1.2.2.3" xref="S4.SS2.p1.1.m1.1.2.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.2.1" xref="S4.SS2.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.1.m1.1.2.3.2" xref="S4.SS2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.3.2.1" xref="S4.SS2.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.3.2.2" xref="S4.SS2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.2"><times id="S4.SS2.p1.1.m1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.2.1"></times><apply id="S4.SS2.p1.1.m1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.2.2.1.cmml" xref="S4.SS2.p1.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.2.2.2.cmml" xref="S4.SS2.p1.1.m1.1.2.2.2">𝑓</ci><ci id="S4.SS2.p1.1.m1.1.2.2.3.cmml" xref="S4.SS2.p1.1.m1.1.2.2.3">𝜽</ci></apply><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">f_{\boldsymbol{\theta}}(\cdot)</annotation></semantics></math> and <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="g_{\mathit{\Phi}}(\cdot)" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.2" xref="S4.SS2.p1.2.m2.1.2.cmml"><msub id="S4.SS2.p1.2.m2.1.2.2" xref="S4.SS2.p1.2.m2.1.2.2.cmml"><mi id="S4.SS2.p1.2.m2.1.2.2.2" xref="S4.SS2.p1.2.m2.1.2.2.2.cmml">g</mi><mi id="S4.SS2.p1.2.m2.1.2.2.3" xref="S4.SS2.p1.2.m2.1.2.2.3.cmml">Φ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m2.1.2.1" xref="S4.SS2.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.2.m2.1.2.3.2" xref="S4.SS2.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.1.2.3.2.1" xref="S4.SS2.p1.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p1.2.m2.1.2.3.2.2" xref="S4.SS2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.2.cmml" xref="S4.SS2.p1.2.m2.1.2"><times id="S4.SS2.p1.2.m2.1.2.1.cmml" xref="S4.SS2.p1.2.m2.1.2.1"></times><apply id="S4.SS2.p1.2.m2.1.2.2.cmml" xref="S4.SS2.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.2.2.1.cmml" xref="S4.SS2.p1.2.m2.1.2.2">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.2.2.2.cmml" xref="S4.SS2.p1.2.m2.1.2.2.2">𝑔</ci><ci id="S4.SS2.p1.2.m2.1.2.2.3.cmml" xref="S4.SS2.p1.2.m2.1.2.2.3">𝛷</ci></apply><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">g_{\mathit{\Phi}}(\cdot)</annotation></semantics></math> defined above use dynamic parameters that are dependent on the support set. Our model processes the entire support set in a forward and backward pass through the network as described below. This step is to be carried out once at test time, prior to making predictions on any instance of the test set. At training time, it is repeated before every epoch to account for the evolving static parameters of the network as training progresses (see Algorithm <a href="#algorithm1" title="In 4.2 Processing of Support Set ‣ 4 Proposed Model ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.12" class="ltx_p">We pass all elements of the support set <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="{\mathcal{S}}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">{\mathcal{S}}</annotation></semantics></math> through the network in mini-batches for both a forward and backward pass. The evaluation of <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="f_{\boldsymbol{\theta}}(\cdot)" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.2" xref="S4.SS2.p2.2.m2.1.2.cmml"><msub id="S4.SS2.p2.2.m2.1.2.2" xref="S4.SS2.p2.2.m2.1.2.2.cmml"><mi id="S4.SS2.p2.2.m2.1.2.2.2" xref="S4.SS2.p2.2.m2.1.2.2.2.cmml">f</mi><mi id="S4.SS2.p2.2.m2.1.2.2.3" xref="S4.SS2.p2.2.m2.1.2.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.2.1" xref="S4.SS2.p2.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS2.p2.2.m2.1.2.3.2" xref="S4.SS2.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.2.m2.1.2.3.2.1" xref="S4.SS2.p2.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p2.2.m2.1.2.3.2.2" xref="S4.SS2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.2.cmml" xref="S4.SS2.p2.2.m2.1.2"><times id="S4.SS2.p2.2.m2.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.2.1"></times><apply id="S4.SS2.p2.2.m2.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.2.2.1.cmml" xref="S4.SS2.p2.2.m2.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.2.2.2.cmml" xref="S4.SS2.p2.2.m2.1.2.2.2">𝑓</ci><ci id="S4.SS2.p2.2.m2.1.2.2.3.cmml" xref="S4.SS2.p2.2.m2.1.2.2.3">𝜽</ci></apply><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">f_{\boldsymbol{\theta}}(\cdot)</annotation></semantics></math> and <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="g_{\mathit{\Phi}}(\cdot)" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.2" xref="S4.SS2.p2.3.m3.1.2.cmml"><msub id="S4.SS2.p2.3.m3.1.2.2" xref="S4.SS2.p2.3.m3.1.2.2.cmml"><mi id="S4.SS2.p2.3.m3.1.2.2.2" xref="S4.SS2.p2.3.m3.1.2.2.2.cmml">g</mi><mi id="S4.SS2.p2.3.m3.1.2.2.3" xref="S4.SS2.p2.3.m3.1.2.2.3.cmml">Φ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.2.1" xref="S4.SS2.p2.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS2.p2.3.m3.1.2.3.2" xref="S4.SS2.p2.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.3.m3.1.2.3.2.1" xref="S4.SS2.p2.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p2.3.m3.1.2.3.2.2" xref="S4.SS2.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.2.cmml" xref="S4.SS2.p2.3.m3.1.2"><times id="S4.SS2.p2.3.m3.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.2.1"></times><apply id="S4.SS2.p2.3.m3.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.2.2.1.cmml" xref="S4.SS2.p2.3.m3.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.2.2.2.cmml" xref="S4.SS2.p2.3.m3.1.2.2.2">𝑔</ci><ci id="S4.SS2.p2.3.m3.1.2.2.3.cmml" xref="S4.SS2.p2.3.m3.1.2.2.3">𝛷</ci></apply><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">g_{\mathit{\Phi}}(\cdot)</annotation></semantics></math> use <em id="S4.SS2.p2.12.1" class="ltx_emph ltx_font_italic">only static weights and prototypes</em>, <em id="S4.SS2.p2.12.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS2.p2.12.3" class="ltx_text"></span> <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}={\boldsymbol{\theta}}^{\mathsf{s}}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">𝜽</mi><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">=</mo><msup id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml"><mi id="S4.SS2.p2.4.m4.1.1.3.2" xref="S4.SS2.p2.4.m4.1.1.3.2.cmml">𝜽</mi><mi id="S4.SS2.p2.4.m4.1.1.3.3" xref="S4.SS2.p2.4.m4.1.1.3.3.cmml">𝗌</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><eq id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1"></eq><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝜽</ci><apply id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.3.1.cmml" xref="S4.SS2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.3.2.cmml" xref="S4.SS2.p2.4.m4.1.1.3.2">𝜽</ci><ci id="S4.SS2.p2.4.m4.1.1.3.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3.3">𝗌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">{\boldsymbol{\theta}}={\boldsymbol{\theta}}^{\mathsf{s}}</annotation></semantics></math> and <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="\boldsymbol{\phi}=\boldsymbol{\phi}^{\mathsf{s}}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mrow id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">ϕ</mi><mo id="S4.SS2.p2.5.m5.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.cmml">=</mo><msup id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS2.p2.5.m5.1.1.3.2" xref="S4.SS2.p2.5.m5.1.1.3.2.cmml">ϕ</mi><mi id="S4.SS2.p2.5.m5.1.1.3.3" xref="S4.SS2.p2.5.m5.1.1.3.3.cmml">𝗌</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><eq id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1"></eq><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">bold-italic-ϕ</ci><apply id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.3.1.cmml" xref="S4.SS2.p2.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.3.2.cmml" xref="S4.SS2.p2.5.m5.1.1.3.2">bold-italic-ϕ</ci><ci id="S4.SS2.p2.5.m5.1.1.3.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3.3">𝗌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\boldsymbol{\phi}=\boldsymbol{\phi}^{\mathsf{s}}</annotation></semantics></math>. To fill the memory <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="{\mathcal{M}}" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><ci id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">{\mathcal{M}}</annotation></semantics></math>, we collect, for every element of the support set, its feature vector <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="{\boldsymbol{h}}" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><mi id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">𝒉</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><ci id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">𝒉</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">{\boldsymbol{h}}</annotation></semantics></math> and the gradient <math id="S4.SS2.p2.8.m8.1" class="ltx_Math" alttext="\nabla_{{\boldsymbol{\theta}}^{\mathsf{s}}}\mathscr{L}" display="inline"><semantics id="S4.SS2.p2.8.m8.1a"><mrow id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml"><msub id="S4.SS2.p2.8.m8.1.1.1" xref="S4.SS2.p2.8.m8.1.1.1.cmml"><mo id="S4.SS2.p2.8.m8.1.1.1.2" xref="S4.SS2.p2.8.m8.1.1.1.2.cmml">∇</mo><msup id="S4.SS2.p2.8.m8.1.1.1.3" xref="S4.SS2.p2.8.m8.1.1.1.3.cmml"><mi id="S4.SS2.p2.8.m8.1.1.1.3.2" xref="S4.SS2.p2.8.m8.1.1.1.3.2.cmml">𝜽</mi><mi id="S4.SS2.p2.8.m8.1.1.1.3.3" xref="S4.SS2.p2.8.m8.1.1.1.3.3.cmml">𝗌</mi></msup></msub><mi class="ltx_font_mathscript" id="S4.SS2.p2.8.m8.1.1.2" xref="S4.SS2.p2.8.m8.1.1.2.cmml">ℒ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><apply id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1"><apply id="S4.SS2.p2.8.m8.1.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.1.1.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m8.1.1.1.2.cmml" xref="S4.SS2.p2.8.m8.1.1.1.2">∇</ci><apply id="S4.SS2.p2.8.m8.1.1.1.3.cmml" xref="S4.SS2.p2.8.m8.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.1.1.1.3.1.cmml" xref="S4.SS2.p2.8.m8.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.8.m8.1.1.1.3.2.cmml" xref="S4.SS2.p2.8.m8.1.1.1.3.2">𝜽</ci><ci id="S4.SS2.p2.8.m8.1.1.1.3.3.cmml" xref="S4.SS2.p2.8.m8.1.1.1.3.3">𝗌</ci></apply></apply><ci id="S4.SS2.p2.8.m8.1.1.2.cmml" xref="S4.SS2.p2.8.m8.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">\nabla_{{\boldsymbol{\theta}}^{\mathsf{s}}}\mathscr{L}</annotation></semantics></math> of the final loss relative to the static weights <math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><mi id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><ci id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">{\boldsymbol{\theta}}</annotation></semantics></math>. This effectively captures the adjustments that would be made by a gradient descent algorithm to those weights for that particular example. The pair <math id="S4.SS2.p2.10.m10.2" class="ltx_Math" alttext="({\boldsymbol{h}},\nabla_{{\boldsymbol{\theta}}^{\mathsf{s}}}\mathscr{L})" display="inline"><semantics id="S4.SS2.p2.10.m10.2a"><mrow id="S4.SS2.p2.10.m10.2.2.1" xref="S4.SS2.p2.10.m10.2.2.2.cmml"><mo stretchy="false" id="S4.SS2.p2.10.m10.2.2.1.2" xref="S4.SS2.p2.10.m10.2.2.2.cmml">(</mo><mi id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml">𝒉</mi><mo id="S4.SS2.p2.10.m10.2.2.1.3" xref="S4.SS2.p2.10.m10.2.2.2.cmml">,</mo><mrow id="S4.SS2.p2.10.m10.2.2.1.1" xref="S4.SS2.p2.10.m10.2.2.1.1.cmml"><msub id="S4.SS2.p2.10.m10.2.2.1.1.1" xref="S4.SS2.p2.10.m10.2.2.1.1.1.cmml"><mo rspace="0.167em" id="S4.SS2.p2.10.m10.2.2.1.1.1.2" xref="S4.SS2.p2.10.m10.2.2.1.1.1.2.cmml">∇</mo><msup id="S4.SS2.p2.10.m10.2.2.1.1.1.3" xref="S4.SS2.p2.10.m10.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p2.10.m10.2.2.1.1.1.3.2" xref="S4.SS2.p2.10.m10.2.2.1.1.1.3.2.cmml">𝜽</mi><mi id="S4.SS2.p2.10.m10.2.2.1.1.1.3.3" xref="S4.SS2.p2.10.m10.2.2.1.1.1.3.3.cmml">𝗌</mi></msup></msub><mi class="ltx_font_mathscript" id="S4.SS2.p2.10.m10.2.2.1.1.2" xref="S4.SS2.p2.10.m10.2.2.1.1.2.cmml">ℒ</mi></mrow><mo stretchy="false" id="S4.SS2.p2.10.m10.2.2.1.4" xref="S4.SS2.p2.10.m10.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.2b"><interval closure="open" id="S4.SS2.p2.10.m10.2.2.2.cmml" xref="S4.SS2.p2.10.m10.2.2.1"><ci id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1">𝒉</ci><apply id="S4.SS2.p2.10.m10.2.2.1.1.cmml" xref="S4.SS2.p2.10.m10.2.2.1.1"><apply id="S4.SS2.p2.10.m10.2.2.1.1.1.cmml" xref="S4.SS2.p2.10.m10.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m10.2.2.1.1.1.1.cmml" xref="S4.SS2.p2.10.m10.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.10.m10.2.2.1.1.1.2.cmml" xref="S4.SS2.p2.10.m10.2.2.1.1.1.2">∇</ci><apply id="S4.SS2.p2.10.m10.2.2.1.1.1.3.cmml" xref="S4.SS2.p2.10.m10.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m10.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p2.10.m10.2.2.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.10.m10.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p2.10.m10.2.2.1.1.1.3.2">𝜽</ci><ci id="S4.SS2.p2.10.m10.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p2.10.m10.2.2.1.1.1.3.3">𝗌</ci></apply></apply><ci id="S4.SS2.p2.10.m10.2.2.1.1.2.cmml" xref="S4.SS2.p2.10.m10.2.2.1.1.2">ℒ</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.2c">({\boldsymbol{h}},\nabla_{{\boldsymbol{\theta}}^{\mathsf{s}}}\mathscr{L})</annotation></semantics></math> is added to the memory <math id="S4.SS2.p2.11.m11.1" class="ltx_Math" alttext="{\mathcal{M}}" display="inline"><semantics id="S4.SS2.p2.11.m11.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.11.m11.1.1" xref="S4.SS2.p2.11.m11.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m11.1b"><ci id="S4.SS2.p2.11.m11.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m11.1c">{\mathcal{M}}</annotation></semantics></math>, which thus holds <math id="S4.SS2.p2.12.m12.1" class="ltx_Math" alttext="|{\mathcal{S}}|" display="inline"><semantics id="S4.SS2.p2.12.m12.1a"><mrow id="S4.SS2.p2.12.m12.1.2.2" xref="S4.SS2.p2.12.m12.1.2.1.cmml"><mo stretchy="false" id="S4.SS2.p2.12.m12.1.2.2.1" xref="S4.SS2.p2.12.m12.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.12.m12.1.1" xref="S4.SS2.p2.12.m12.1.1.cmml">𝒮</mi><mo stretchy="false" id="S4.SS2.p2.12.m12.1.2.2.2" xref="S4.SS2.p2.12.m12.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m12.1b"><apply id="S4.SS2.p2.12.m12.1.2.1.cmml" xref="S4.SS2.p2.12.m12.1.2.2"><abs id="S4.SS2.p2.12.m12.1.2.1.1.cmml" xref="S4.SS2.p2.12.m12.1.2.2.1"></abs><ci id="S4.SS2.p2.12.m12.1.1.cmml" xref="S4.SS2.p2.12.m12.1.1">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m12.1c">|{\mathcal{S}}|</annotation></semantics></math> elements at the end of the process.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.4" class="ltx_p">To determine the set of dynamic prototypes <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\phi}^{\mathsf{d}}" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><msup id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">ϕ</mi><mi id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">𝖽</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">𝖽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\boldsymbol{\phi}^{\mathsf{d}}</annotation></semantics></math>, we collect the feature vectors <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="{\boldsymbol{h}}^{\prime}=f_{\boldsymbol{\theta}}({\boldsymbol{h}})" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.2" xref="S4.SS2.p3.2.m2.1.2.cmml"><msup id="S4.SS2.p3.2.m2.1.2.2" xref="S4.SS2.p3.2.m2.1.2.2.cmml"><mi id="S4.SS2.p3.2.m2.1.2.2.2" xref="S4.SS2.p3.2.m2.1.2.2.2.cmml">𝒉</mi><mo id="S4.SS2.p3.2.m2.1.2.2.3" xref="S4.SS2.p3.2.m2.1.2.2.3.cmml">′</mo></msup><mo id="S4.SS2.p3.2.m2.1.2.1" xref="S4.SS2.p3.2.m2.1.2.1.cmml">=</mo><mrow id="S4.SS2.p3.2.m2.1.2.3" xref="S4.SS2.p3.2.m2.1.2.3.cmml"><msub id="S4.SS2.p3.2.m2.1.2.3.2" xref="S4.SS2.p3.2.m2.1.2.3.2.cmml"><mi id="S4.SS2.p3.2.m2.1.2.3.2.2" xref="S4.SS2.p3.2.m2.1.2.3.2.2.cmml">f</mi><mi id="S4.SS2.p3.2.m2.1.2.3.2.3" xref="S4.SS2.p3.2.m2.1.2.3.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p3.2.m2.1.2.3.1" xref="S4.SS2.p3.2.m2.1.2.3.1.cmml">​</mo><mrow id="S4.SS2.p3.2.m2.1.2.3.3.2" xref="S4.SS2.p3.2.m2.1.2.3.cmml"><mo stretchy="false" id="S4.SS2.p3.2.m2.1.2.3.3.2.1" xref="S4.SS2.p3.2.m2.1.2.3.cmml">(</mo><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">𝒉</mi><mo stretchy="false" id="S4.SS2.p3.2.m2.1.2.3.3.2.2" xref="S4.SS2.p3.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.2.cmml" xref="S4.SS2.p3.2.m2.1.2"><eq id="S4.SS2.p3.2.m2.1.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.1"></eq><apply id="S4.SS2.p3.2.m2.1.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.2.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.2">superscript</csymbol><ci id="S4.SS2.p3.2.m2.1.2.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.2.2">𝒉</ci><ci id="S4.SS2.p3.2.m2.1.2.2.3.cmml" xref="S4.SS2.p3.2.m2.1.2.2.3">′</ci></apply><apply id="S4.SS2.p3.2.m2.1.2.3.cmml" xref="S4.SS2.p3.2.m2.1.2.3"><times id="S4.SS2.p3.2.m2.1.2.3.1.cmml" xref="S4.SS2.p3.2.m2.1.2.3.1"></times><apply id="S4.SS2.p3.2.m2.1.2.3.2.cmml" xref="S4.SS2.p3.2.m2.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.2.3.2.1.cmml" xref="S4.SS2.p3.2.m2.1.2.3.2">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.2.3.2.2.cmml" xref="S4.SS2.p3.2.m2.1.2.3.2.2">𝑓</ci><ci id="S4.SS2.p3.2.m2.1.2.3.2.3.cmml" xref="S4.SS2.p3.2.m2.1.2.3.2.3">𝜽</ci></apply><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝒉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">{\boldsymbol{h}}^{\prime}=f_{\boldsymbol{\theta}}({\boldsymbol{h}})</annotation></semantics></math> over all instances of the support set. We then compute their average over instances having the same correct answer. Concretely, the dynamic prototype for answer <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">a</annotation></semantics></math> is obtained as <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="\boldsymbol{\phi}^{a}=\frac{1}{N^{a}}\sum_{i:\hat{s}_{i}^{a}=1}^{N^{a}}{\boldsymbol{h}}^{\prime}_{i}" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mrow id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><msup id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS2.p3.4.m4.1.1.2.2" xref="S4.SS2.p3.4.m4.1.1.2.2.cmml">ϕ</mi><mi id="S4.SS2.p3.4.m4.1.1.2.3" xref="S4.SS2.p3.4.m4.1.1.2.3.cmml">a</mi></msup><mo id="S4.SS2.p3.4.m4.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.cmml">=</mo><mrow id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml"><mfrac id="S4.SS2.p3.4.m4.1.1.3.2" xref="S4.SS2.p3.4.m4.1.1.3.2.cmml"><mn id="S4.SS2.p3.4.m4.1.1.3.2.2" xref="S4.SS2.p3.4.m4.1.1.3.2.2.cmml">1</mn><msup id="S4.SS2.p3.4.m4.1.1.3.2.3" xref="S4.SS2.p3.4.m4.1.1.3.2.3.cmml"><mi id="S4.SS2.p3.4.m4.1.1.3.2.3.2" xref="S4.SS2.p3.4.m4.1.1.3.2.3.2.cmml">N</mi><mi id="S4.SS2.p3.4.m4.1.1.3.2.3.3" xref="S4.SS2.p3.4.m4.1.1.3.2.3.3.cmml">a</mi></msup></mfrac><mo lspace="0em" rspace="0em" id="S4.SS2.p3.4.m4.1.1.3.1" xref="S4.SS2.p3.4.m4.1.1.3.1.cmml">​</mo><mrow id="S4.SS2.p3.4.m4.1.1.3.3" xref="S4.SS2.p3.4.m4.1.1.3.3.cmml"><msubsup id="S4.SS2.p3.4.m4.1.1.3.3.1" xref="S4.SS2.p3.4.m4.1.1.3.3.1.cmml"><mo id="S4.SS2.p3.4.m4.1.1.3.3.1.2.2" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.cmml"><mi id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.2" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.2.cmml">i</mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.1" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.1.cmml">:</mo><mrow id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.cmml"><msubsup id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.cmml"><mover accent="true" id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2.cmml"><mi id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2.2" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2.2.cmml">s</mi><mo id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2.1" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2.1.cmml">^</mo></mover><mi id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.3" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.3.cmml">i</mi><mi id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.3" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.3.cmml">a</mi></msubsup><mo id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.1" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.1.cmml">=</mo><mn id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.3" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.3.cmml">1</mn></mrow></mrow><msup id="S4.SS2.p3.4.m4.1.1.3.3.1.3" xref="S4.SS2.p3.4.m4.1.1.3.3.1.3.cmml"><mi id="S4.SS2.p3.4.m4.1.1.3.3.1.3.2" xref="S4.SS2.p3.4.m4.1.1.3.3.1.3.2.cmml">N</mi><mi id="S4.SS2.p3.4.m4.1.1.3.3.1.3.3" xref="S4.SS2.p3.4.m4.1.1.3.3.1.3.3.cmml">a</mi></msup></msubsup><msubsup id="S4.SS2.p3.4.m4.1.1.3.3.2" xref="S4.SS2.p3.4.m4.1.1.3.3.2.cmml"><mi id="S4.SS2.p3.4.m4.1.1.3.3.2.2.2" xref="S4.SS2.p3.4.m4.1.1.3.3.2.2.2.cmml">𝒉</mi><mi id="S4.SS2.p3.4.m4.1.1.3.3.2.3" xref="S4.SS2.p3.4.m4.1.1.3.3.2.3.cmml">i</mi><mo id="S4.SS2.p3.4.m4.1.1.3.3.2.2.3" xref="S4.SS2.p3.4.m4.1.1.3.3.2.2.3.cmml">′</mo></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><eq id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1"></eq><apply id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.2">superscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2">bold-italic-ϕ</ci><ci id="S4.SS2.p3.4.m4.1.1.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.2.3">𝑎</ci></apply><apply id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3"><times id="S4.SS2.p3.4.m4.1.1.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.1"></times><apply id="S4.SS2.p3.4.m4.1.1.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.2"><divide id="S4.SS2.p3.4.m4.1.1.3.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.2"></divide><cn type="integer" id="S4.SS2.p3.4.m4.1.1.3.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.2.2">1</cn><apply id="S4.SS2.p3.4.m4.1.1.3.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.3.2.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.2.3">superscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.3.2.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.2.3.2">𝑁</ci><ci id="S4.SS2.p3.4.m4.1.1.3.2.3.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.2.3.3">𝑎</ci></apply></apply><apply id="S4.SS2.p3.4.m4.1.1.3.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3"><apply id="S4.SS2.p3.4.m4.1.1.3.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.3.3.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1">superscript</csymbol><apply id="S4.SS2.p3.4.m4.1.1.3.3.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.3.3.1.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1">subscript</csymbol><sum id="S4.SS2.p3.4.m4.1.1.3.3.1.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.2"></sum><apply id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3"><ci id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.1">:</ci><ci id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.2">𝑖</ci><apply id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3"><eq id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.1"></eq><apply id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2">superscript</csymbol><apply id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2">subscript</csymbol><apply id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2"><ci id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2.1">^</ci><ci id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.2.2">𝑠</ci></apply><ci id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.2.3">𝑖</ci></apply><ci id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.2.3">𝑎</ci></apply><cn type="integer" id="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S4.SS2.p3.4.m4.1.1.3.3.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.3.3.1.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.3">superscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.3.3.1.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.3.2">𝑁</ci><ci id="S4.SS2.p3.4.m4.1.1.3.3.1.3.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1.3.3">𝑎</ci></apply></apply><apply id="S4.SS2.p3.4.m4.1.1.3.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.3.3.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.2">subscript</csymbol><apply id="S4.SS2.p3.4.m4.1.1.3.3.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.3.3.2.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.2">superscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.3.3.2.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.2.2.2">𝒉</ci><ci id="S4.SS2.p3.4.m4.1.1.3.3.2.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.2.2.3">′</ci></apply><ci id="S4.SS2.p3.4.m4.1.1.3.3.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\boldsymbol{\phi}^{a}=\frac{1}{N^{a}}\sum_{i:\hat{s}_{i}^{a}=1}^{N^{a}}{\boldsymbol{h}}^{\prime}_{i}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.3" class="ltx_p">During training, we must balance the need for data to train the static parameters of the network, and the need for an “example” support set, such that the network can learn to use novel data. If the network is provided with a fixed, constant support set, it will overfit to that input and be unable to make use of novel examples at test time. Our training procedure uses all available data as the training set <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="{\mathcal{T}}" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">{\mathcal{T}}</annotation></semantics></math>, and we form a different support set <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="{\mathcal{S}}" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">{\mathcal{S}}</annotation></semantics></math> at each training epoch as a random subset of <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="{\mathcal{T}}" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><ci id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">{\mathcal{T}}</annotation></semantics></math>. The procedure is summarized in Algorithm <a href="#algorithm1" title="In 4.2 Processing of Support Set ‣ 4 Proposed Model ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Note that in practice, it is parallelized to process instances in mini-batches rather than individually.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.26" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.26.27" class="ltx_listingline">
<span id="algorithm1.26.27.1" class="ltx_text"><span id="algorithm1.26.27.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>
</div>
<div id="algorithm1.1.1" class="ltx_listingline">
Support set  <math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="\mathscr{S}\,=\,\{(\mathsf{Q}_{i},\mathsf{I}_{i},\hat{{\boldsymbol{s}}}_{i})\}_{i}" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mrow id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathscript" id="algorithm1.1.1.m1.1.1.3" xref="algorithm1.1.1.m1.1.1.3.cmml">𝒮</mi><mo lspace="0.448em" rspace="0.448em" id="algorithm1.1.1.m1.1.1.2" xref="algorithm1.1.1.m1.1.1.2.cmml">=</mo><msub id="algorithm1.1.1.m1.1.1.1" xref="algorithm1.1.1.m1.1.1.1.cmml"><mrow id="algorithm1.1.1.m1.1.1.1.1.1" xref="algorithm1.1.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.1.1.m1.1.1.1.1.1.2" xref="algorithm1.1.1.m1.1.1.1.1.2.cmml">{</mo><mrow id="algorithm1.1.1.m1.1.1.1.1.1.1.3" xref="algorithm1.1.1.m1.1.1.1.1.1.1.4.cmml"><mo stretchy="false" id="algorithm1.1.1.m1.1.1.1.1.1.1.3.4" xref="algorithm1.1.1.m1.1.1.1.1.1.1.4.cmml">(</mo><msub id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.2" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">𝖰</mi><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.3" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.1.1.m1.1.1.1.1.1.1.3.5" xref="algorithm1.1.1.m1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm1.1.1.m1.1.1.1.1.1.1.2.2" xref="algorithm1.1.1.m1.1.1.1.1.1.1.2.2.cmml"><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.2.2.2" xref="algorithm1.1.1.m1.1.1.1.1.1.1.2.2.2.cmml">𝖨</mi><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.2.2.3" xref="algorithm1.1.1.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="algorithm1.1.1.m1.1.1.1.1.1.1.3.6" xref="algorithm1.1.1.m1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm1.1.1.m1.1.1.1.1.1.1.3.3" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.cmml"><mover accent="true" id="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2.cmml"><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2.2" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2.2.cmml">𝒔</mi><mo id="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2.1" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2.1.cmml">^</mo></mover><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.3" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="algorithm1.1.1.m1.1.1.1.1.1.1.3.7" xref="algorithm1.1.1.m1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo stretchy="false" id="algorithm1.1.1.m1.1.1.1.1.1.3" xref="algorithm1.1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mi id="algorithm1.1.1.m1.1.1.1.3" xref="algorithm1.1.1.m1.1.1.1.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><apply id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1"><eq id="algorithm1.1.1.m1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.2"></eq><ci id="algorithm1.1.1.m1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.3">𝒮</ci><apply id="algorithm1.1.1.m1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.1">subscript</csymbol><set id="algorithm1.1.1.m1.1.1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1"><vector id="algorithm1.1.1.m1.1.1.1.1.1.1.4.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3"><apply id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.2">𝖰</ci><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.2.2.2">𝖨</ci><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2"><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2.1">^</ci><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.2.2">𝒔</ci></apply><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></vector></set><ci id="algorithm1.1.1.m1.1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">\mathscr{S}\,=\,\{(\mathsf{Q}_{i},\mathsf{I}_{i},\hat{{\boldsymbol{s}}}_{i})\}_{i}</annotation></semantics></math>
</div>
<div id="algorithm1.2.2" class="ltx_listingline">
Instance to evaluate <math id="algorithm1.2.2.m1.3" class="ltx_Math" alttext="(\mathsf{Q},\mathsf{I},\boldsymbol{\hat{s}})" display="inline"><semantics id="algorithm1.2.2.m1.3a"><mrow id="algorithm1.2.2.m1.3.4.2" xref="algorithm1.2.2.m1.3.4.1.cmml"><mo stretchy="false" id="algorithm1.2.2.m1.3.4.2.1" xref="algorithm1.2.2.m1.3.4.1.cmml">(</mo><mi id="algorithm1.2.2.m1.1.1" xref="algorithm1.2.2.m1.1.1.cmml">𝖰</mi><mo id="algorithm1.2.2.m1.3.4.2.2" xref="algorithm1.2.2.m1.3.4.1.cmml">,</mo><mi id="algorithm1.2.2.m1.2.2" xref="algorithm1.2.2.m1.2.2.cmml">𝖨</mi><mo id="algorithm1.2.2.m1.3.4.2.3" xref="algorithm1.2.2.m1.3.4.1.cmml">,</mo><mover accent="true" id="algorithm1.2.2.m1.3.3" xref="algorithm1.2.2.m1.3.3.cmml"><mi id="algorithm1.2.2.m1.3.3.2" xref="algorithm1.2.2.m1.3.3.2.cmml">𝒔</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="algorithm1.2.2.m1.3.3.1" xref="algorithm1.2.2.m1.3.3.1.cmml">^</mo></mover><mo stretchy="false" id="algorithm1.2.2.m1.3.4.2.4" xref="algorithm1.2.2.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m1.3b"><vector id="algorithm1.2.2.m1.3.4.1.cmml" xref="algorithm1.2.2.m1.3.4.2"><ci id="algorithm1.2.2.m1.1.1.cmml" xref="algorithm1.2.2.m1.1.1">𝖰</ci><ci id="algorithm1.2.2.m1.2.2.cmml" xref="algorithm1.2.2.m1.2.2">𝖨</ci><apply id="algorithm1.2.2.m1.3.3.cmml" xref="algorithm1.2.2.m1.3.3"><ci id="algorithm1.2.2.m1.3.3.1.cmml" xref="algorithm1.2.2.m1.3.3.1">bold-^</ci><ci id="algorithm1.2.2.m1.3.3.2.cmml" xref="algorithm1.2.2.m1.3.3.2">𝒔</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m1.3c">(\mathsf{Q},\mathsf{I},\boldsymbol{\hat{s}})</annotation></semantics></math> from training or test set
</div>
<div id="algorithm1.3.3" class="ltx_listingline">
<span id="algorithm1.3.3.1" class="ltx_text"><span id="algorithm1.3.3.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>Predicted scores <math id="algorithm1.3.3.m1.1" class="ltx_Math" alttext="{\boldsymbol{s}}" display="inline"><semantics id="algorithm1.3.3.m1.1a"><mi id="algorithm1.3.3.m1.1.1" xref="algorithm1.3.3.m1.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m1.1b"><ci id="algorithm1.3.3.m1.1.1.cmml" xref="algorithm1.3.3.m1.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m1.1c">{\boldsymbol{s}}</annotation></semantics></math> over candidate answers
</div>
<div id="algorithm1.4.4" class="ltx_listingline">
<math id="algorithm1.4.4.m1.1" class="ltx_Math" alttext="\Phi^{\mathsf{d}}\leftarrow\emptyset" display="inline"><semantics id="algorithm1.4.4.m1.1a"><mrow id="algorithm1.4.4.m1.1.1" xref="algorithm1.4.4.m1.1.1.cmml"><msup id="algorithm1.4.4.m1.1.1.2" xref="algorithm1.4.4.m1.1.1.2.cmml"><mi mathvariant="normal" id="algorithm1.4.4.m1.1.1.2.2" xref="algorithm1.4.4.m1.1.1.2.2.cmml">Φ</mi><mi id="algorithm1.4.4.m1.1.1.2.3" xref="algorithm1.4.4.m1.1.1.2.3.cmml">𝖽</mi></msup><mo stretchy="false" id="algorithm1.4.4.m1.1.1.1" xref="algorithm1.4.4.m1.1.1.1.cmml">←</mo><mi mathvariant="normal" id="algorithm1.4.4.m1.1.1.3" xref="algorithm1.4.4.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m1.1b"><apply id="algorithm1.4.4.m1.1.1.cmml" xref="algorithm1.4.4.m1.1.1"><ci id="algorithm1.4.4.m1.1.1.1.cmml" xref="algorithm1.4.4.m1.1.1.1">←</ci><apply id="algorithm1.4.4.m1.1.1.2.cmml" xref="algorithm1.4.4.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.4.4.m1.1.1.2.1.cmml" xref="algorithm1.4.4.m1.1.1.2">superscript</csymbol><ci id="algorithm1.4.4.m1.1.1.2.2.cmml" xref="algorithm1.4.4.m1.1.1.2.2">Φ</ci><ci id="algorithm1.4.4.m1.1.1.2.3.cmml" xref="algorithm1.4.4.m1.1.1.2.3">𝖽</ci></apply><emptyset id="algorithm1.4.4.m1.1.1.3.cmml" xref="algorithm1.4.4.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m1.1c">\Phi^{\mathsf{d}}\leftarrow\emptyset</annotation></semantics></math>  // <span id="algorithm1.4.4.1" class="ltx_text ltx_font_italic">Initialize dynamic prototypes</span>
</div>
<div id="algorithm1.5.5" class="ltx_listingline">
<math id="algorithm1.5.5.m1.1" class="ltx_Math" alttext="{\mathcal{M}}\leftarrow\emptyset" display="inline"><semantics id="algorithm1.5.5.m1.1a"><mrow id="algorithm1.5.5.m1.1.1" xref="algorithm1.5.5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.5.5.m1.1.1.2" xref="algorithm1.5.5.m1.1.1.2.cmml">ℳ</mi><mo stretchy="false" id="algorithm1.5.5.m1.1.1.1" xref="algorithm1.5.5.m1.1.1.1.cmml">←</mo><mi mathvariant="normal" id="algorithm1.5.5.m1.1.1.3" xref="algorithm1.5.5.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m1.1b"><apply id="algorithm1.5.5.m1.1.1.cmml" xref="algorithm1.5.5.m1.1.1"><ci id="algorithm1.5.5.m1.1.1.1.cmml" xref="algorithm1.5.5.m1.1.1.1">←</ci><ci id="algorithm1.5.5.m1.1.1.2.cmml" xref="algorithm1.5.5.m1.1.1.2">ℳ</ci><emptyset id="algorithm1.5.5.m1.1.1.3.cmml" xref="algorithm1.5.5.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m1.1c">{\mathcal{M}}\leftarrow\emptyset</annotation></semantics></math>  // <span id="algorithm1.5.5.1" class="ltx_text ltx_font_italic">Initialize memory of dynamic weights</span>
</div>
<div id="algorithm1.7.7" class="ltx_listingline">
<span id="algorithm1.7.7.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.7.7.2" class="ltx_emph ltx_font_italic">each element <math id="algorithm1.6.6.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="algorithm1.6.6.1.m1.1a"><mi id="algorithm1.6.6.1.m1.1.1" xref="algorithm1.6.6.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.1.m1.1b"><ci id="algorithm1.6.6.1.m1.1.1.cmml" xref="algorithm1.6.6.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.1.m1.1c">i</annotation></semantics></math> in support set <math id="algorithm1.7.7.2.m2.1" class="ltx_Math" alttext="\mathscr{S}" display="inline"><semantics id="algorithm1.7.7.2.m2.1a"><mi class="ltx_font_mathscript" id="algorithm1.7.7.2.m2.1.1" xref="algorithm1.7.7.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.2.m2.1b"><ci id="algorithm1.7.7.2.m2.1.1.cmml" xref="algorithm1.7.7.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.2.m2.1c">\mathscr{S}</annotation></semantics></math></em> <span id="algorithm1.7.7.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.8.8" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.8.8.2" class="ltx_text ltx_font_bold">if</span> <em id="algorithm1.8.8.1" class="ltx_emph ltx_font_italic">training, with probability <math id="algorithm1.8.8.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="algorithm1.8.8.1.m1.1a"><mi id="algorithm1.8.8.1.m1.1.1" xref="algorithm1.8.8.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.1.m1.1b"><ci id="algorithm1.8.8.1.m1.1.1.cmml" xref="algorithm1.8.8.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.1.m1.1c">p</annotation></semantics></math></em> <span id="algorithm1.8.8.3" class="ltx_text ltx_font_bold">then</span> 
</div>
<div id="algorithm1.26.28" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.26.28.1" class="ltx_text ltx_font_bold">continue</span>  // <span id="algorithm1.26.28.2" class="ltx_text ltx_font_italic">Drop random support elements</span>
</div>
<div id="algorithm1.26.29" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.26.30" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end if
</div>
<div id="algorithm1.9.9" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Forward and backward propagation of <math id="algorithm1.9.9.m1.3" class="ltx_Math" alttext="(\mathsf{Q}_{i},\mathsf{I}_{i},\hat{{\boldsymbol{s}}}_{i})" display="inline"><semantics id="algorithm1.9.9.m1.3a"><mrow id="algorithm1.9.9.m1.3.3.3" xref="algorithm1.9.9.m1.3.3.4.cmml"><mo stretchy="false" id="algorithm1.9.9.m1.3.3.3.4" xref="algorithm1.9.9.m1.3.3.4.cmml">(</mo><msub id="algorithm1.9.9.m1.1.1.1.1" xref="algorithm1.9.9.m1.1.1.1.1.cmml"><mi id="algorithm1.9.9.m1.1.1.1.1.2" xref="algorithm1.9.9.m1.1.1.1.1.2.cmml">𝖰</mi><mi id="algorithm1.9.9.m1.1.1.1.1.3" xref="algorithm1.9.9.m1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.9.9.m1.3.3.3.5" xref="algorithm1.9.9.m1.3.3.4.cmml">,</mo><msub id="algorithm1.9.9.m1.2.2.2.2" xref="algorithm1.9.9.m1.2.2.2.2.cmml"><mi id="algorithm1.9.9.m1.2.2.2.2.2" xref="algorithm1.9.9.m1.2.2.2.2.2.cmml">𝖨</mi><mi id="algorithm1.9.9.m1.2.2.2.2.3" xref="algorithm1.9.9.m1.2.2.2.2.3.cmml">i</mi></msub><mo id="algorithm1.9.9.m1.3.3.3.6" xref="algorithm1.9.9.m1.3.3.4.cmml">,</mo><msub id="algorithm1.9.9.m1.3.3.3.3" xref="algorithm1.9.9.m1.3.3.3.3.cmml"><mover accent="true" id="algorithm1.9.9.m1.3.3.3.3.2" xref="algorithm1.9.9.m1.3.3.3.3.2.cmml"><mi id="algorithm1.9.9.m1.3.3.3.3.2.2" xref="algorithm1.9.9.m1.3.3.3.3.2.2.cmml">𝒔</mi><mo id="algorithm1.9.9.m1.3.3.3.3.2.1" xref="algorithm1.9.9.m1.3.3.3.3.2.1.cmml">^</mo></mover><mi id="algorithm1.9.9.m1.3.3.3.3.3" xref="algorithm1.9.9.m1.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="algorithm1.9.9.m1.3.3.3.7" xref="algorithm1.9.9.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m1.3b"><vector id="algorithm1.9.9.m1.3.3.4.cmml" xref="algorithm1.9.9.m1.3.3.3"><apply id="algorithm1.9.9.m1.1.1.1.1.cmml" xref="algorithm1.9.9.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.1.1.1.1.1.cmml" xref="algorithm1.9.9.m1.1.1.1.1">subscript</csymbol><ci id="algorithm1.9.9.m1.1.1.1.1.2.cmml" xref="algorithm1.9.9.m1.1.1.1.1.2">𝖰</ci><ci id="algorithm1.9.9.m1.1.1.1.1.3.cmml" xref="algorithm1.9.9.m1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.9.9.m1.2.2.2.2.cmml" xref="algorithm1.9.9.m1.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.2.2.2.2.1.cmml" xref="algorithm1.9.9.m1.2.2.2.2">subscript</csymbol><ci id="algorithm1.9.9.m1.2.2.2.2.2.cmml" xref="algorithm1.9.9.m1.2.2.2.2.2">𝖨</ci><ci id="algorithm1.9.9.m1.2.2.2.2.3.cmml" xref="algorithm1.9.9.m1.2.2.2.2.3">𝑖</ci></apply><apply id="algorithm1.9.9.m1.3.3.3.3.cmml" xref="algorithm1.9.9.m1.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.3.3.3.3.1.cmml" xref="algorithm1.9.9.m1.3.3.3.3">subscript</csymbol><apply id="algorithm1.9.9.m1.3.3.3.3.2.cmml" xref="algorithm1.9.9.m1.3.3.3.3.2"><ci id="algorithm1.9.9.m1.3.3.3.3.2.1.cmml" xref="algorithm1.9.9.m1.3.3.3.3.2.1">^</ci><ci id="algorithm1.9.9.m1.3.3.3.3.2.2.cmml" xref="algorithm1.9.9.m1.3.3.3.3.2.2">𝒔</ci></apply><ci id="algorithm1.9.9.m1.3.3.3.3.3.cmml" xref="algorithm1.9.9.m1.3.3.3.3.3">𝑖</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.3c">(\mathsf{Q}_{i},\mathsf{I}_{i},\hat{{\boldsymbol{s}}}_{i})</annotation></semantics></math>
</div>
<div id="algorithm1.11.11" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
    using only static weights <math id="algorithm1.10.10.m1.1" class="ltx_Math" alttext="\theta^{\mathsf{s}}" display="inline"><semantics id="algorithm1.10.10.m1.1a"><msup id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><mi id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml">θ</mi><mi id="algorithm1.10.10.m1.1.1.3" xref="algorithm1.10.10.m1.1.1.3.cmml">𝗌</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1">superscript</csymbol><ci id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2">𝜃</ci><ci id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3">𝗌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">\theta^{\mathsf{s}}</annotation></semantics></math> and prototypes <math id="algorithm1.11.11.m2.1" class="ltx_Math" alttext="\Phi^{\mathsf{s}}" display="inline"><semantics id="algorithm1.11.11.m2.1a"><msup id="algorithm1.11.11.m2.1.1" xref="algorithm1.11.11.m2.1.1.cmml"><mi mathvariant="normal" id="algorithm1.11.11.m2.1.1.2" xref="algorithm1.11.11.m2.1.1.2.cmml">Φ</mi><mi id="algorithm1.11.11.m2.1.1.3" xref="algorithm1.11.11.m2.1.1.3.cmml">𝗌</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m2.1b"><apply id="algorithm1.11.11.m2.1.1.cmml" xref="algorithm1.11.11.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m2.1.1.1.cmml" xref="algorithm1.11.11.m2.1.1">superscript</csymbol><ci id="algorithm1.11.11.m2.1.1.2.cmml" xref="algorithm1.11.11.m2.1.1.2">Φ</ci><ci id="algorithm1.11.11.m2.1.1.3.cmml" xref="algorithm1.11.11.m2.1.1.3">𝗌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m2.1c">\Phi^{\mathsf{s}}</annotation></semantics></math>
</div>
<div id="algorithm1.12.12" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Collect <math id="algorithm1.12.12.m1.1" class="ltx_Math" alttext="{\boldsymbol{h}}_{i}" display="inline"><semantics id="algorithm1.12.12.m1.1a"><msub id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml"><mi id="algorithm1.12.12.m1.1.1.2" xref="algorithm1.12.12.m1.1.1.2.cmml">𝒉</mi><mi id="algorithm1.12.12.m1.1.1.3" xref="algorithm1.12.12.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.1b"><apply id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1">subscript</csymbol><ci id="algorithm1.12.12.m1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1.2">𝒉</ci><ci id="algorithm1.12.12.m1.1.1.3.cmml" xref="algorithm1.12.12.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.1c">{\boldsymbol{h}}_{i}</annotation></semantics></math>
</div>
<div id="algorithm1.13.13" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
             <math id="algorithm1.13.13.m1.1" class="ltx_Math" alttext="{\boldsymbol{h}}^{\prime}_{i}=f_{\theta}({\boldsymbol{h}}_{i})" display="inline"><semantics id="algorithm1.13.13.m1.1a"><mrow id="algorithm1.13.13.m1.1.1" xref="algorithm1.13.13.m1.1.1.cmml"><msubsup id="algorithm1.13.13.m1.1.1.3" xref="algorithm1.13.13.m1.1.1.3.cmml"><mi id="algorithm1.13.13.m1.1.1.3.2.2" xref="algorithm1.13.13.m1.1.1.3.2.2.cmml">𝒉</mi><mi id="algorithm1.13.13.m1.1.1.3.3" xref="algorithm1.13.13.m1.1.1.3.3.cmml">i</mi><mo id="algorithm1.13.13.m1.1.1.3.2.3" xref="algorithm1.13.13.m1.1.1.3.2.3.cmml">′</mo></msubsup><mo id="algorithm1.13.13.m1.1.1.2" xref="algorithm1.13.13.m1.1.1.2.cmml">=</mo><mrow id="algorithm1.13.13.m1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.cmml"><msub id="algorithm1.13.13.m1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.3.cmml"><mi id="algorithm1.13.13.m1.1.1.1.3.2" xref="algorithm1.13.13.m1.1.1.1.3.2.cmml">f</mi><mi id="algorithm1.13.13.m1.1.1.1.3.3" xref="algorithm1.13.13.m1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.13.13.m1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.13.13.m1.1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.13.13.m1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.1.1.2.cmml">𝒉</mi><mi id="algorithm1.13.13.m1.1.1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="algorithm1.13.13.m1.1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><eq id="algorithm1.13.13.m1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.2"></eq><apply id="algorithm1.13.13.m1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.3.1.cmml" xref="algorithm1.13.13.m1.1.1.3">subscript</csymbol><apply id="algorithm1.13.13.m1.1.1.3.2.cmml" xref="algorithm1.13.13.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.3.2.1.cmml" xref="algorithm1.13.13.m1.1.1.3">superscript</csymbol><ci id="algorithm1.13.13.m1.1.1.3.2.2.cmml" xref="algorithm1.13.13.m1.1.1.3.2.2">𝒉</ci><ci id="algorithm1.13.13.m1.1.1.3.2.3.cmml" xref="algorithm1.13.13.m1.1.1.3.2.3">′</ci></apply><ci id="algorithm1.13.13.m1.1.1.3.3.cmml" xref="algorithm1.13.13.m1.1.1.3.3">𝑖</ci></apply><apply id="algorithm1.13.13.m1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1"><times id="algorithm1.13.13.m1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.2"></times><apply id="algorithm1.13.13.m1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.3.1.cmml" xref="algorithm1.13.13.m1.1.1.1.3">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.1.3.2.cmml" xref="algorithm1.13.13.m1.1.1.1.3.2">𝑓</ci><ci id="algorithm1.13.13.m1.1.1.1.3.3.cmml" xref="algorithm1.13.13.m1.1.1.1.3.3">𝜃</ci></apply><apply id="algorithm1.13.13.m1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.2">𝒉</ci><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">{\boldsymbol{h}}^{\prime}_{i}=f_{\theta}({\boldsymbol{h}}_{i})</annotation></semantics></math>
</div>
<div id="algorithm1.14.14" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
             <math id="algorithm1.14.14.m1.1" class="ltx_Math" alttext="{\boldsymbol{s}}_{i}=g_{\Phi}({\boldsymbol{h}}^{\prime}_{i})" display="inline"><semantics id="algorithm1.14.14.m1.1a"><mrow id="algorithm1.14.14.m1.1.1" xref="algorithm1.14.14.m1.1.1.cmml"><msub id="algorithm1.14.14.m1.1.1.3" xref="algorithm1.14.14.m1.1.1.3.cmml"><mi id="algorithm1.14.14.m1.1.1.3.2" xref="algorithm1.14.14.m1.1.1.3.2.cmml">𝒔</mi><mi id="algorithm1.14.14.m1.1.1.3.3" xref="algorithm1.14.14.m1.1.1.3.3.cmml">i</mi></msub><mo id="algorithm1.14.14.m1.1.1.2" xref="algorithm1.14.14.m1.1.1.2.cmml">=</mo><mrow id="algorithm1.14.14.m1.1.1.1" xref="algorithm1.14.14.m1.1.1.1.cmml"><msub id="algorithm1.14.14.m1.1.1.1.3" xref="algorithm1.14.14.m1.1.1.1.3.cmml"><mi id="algorithm1.14.14.m1.1.1.1.3.2" xref="algorithm1.14.14.m1.1.1.1.3.2.cmml">g</mi><mi mathvariant="normal" id="algorithm1.14.14.m1.1.1.1.3.3" xref="algorithm1.14.14.m1.1.1.1.3.3.cmml">Φ</mi></msub><mo lspace="0em" rspace="0em" id="algorithm1.14.14.m1.1.1.1.2" xref="algorithm1.14.14.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.14.14.m1.1.1.1.1.1" xref="algorithm1.14.14.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.14.14.m1.1.1.1.1.1.2" xref="algorithm1.14.14.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="algorithm1.14.14.m1.1.1.1.1.1.1" xref="algorithm1.14.14.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.14.14.m1.1.1.1.1.1.1.2.2" xref="algorithm1.14.14.m1.1.1.1.1.1.1.2.2.cmml">𝒉</mi><mi id="algorithm1.14.14.m1.1.1.1.1.1.1.3" xref="algorithm1.14.14.m1.1.1.1.1.1.1.3.cmml">i</mi><mo id="algorithm1.14.14.m1.1.1.1.1.1.1.2.3" xref="algorithm1.14.14.m1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="algorithm1.14.14.m1.1.1.1.1.1.3" xref="algorithm1.14.14.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m1.1b"><apply id="algorithm1.14.14.m1.1.1.cmml" xref="algorithm1.14.14.m1.1.1"><eq id="algorithm1.14.14.m1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1.2"></eq><apply id="algorithm1.14.14.m1.1.1.3.cmml" xref="algorithm1.14.14.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.3.1.cmml" xref="algorithm1.14.14.m1.1.1.3">subscript</csymbol><ci id="algorithm1.14.14.m1.1.1.3.2.cmml" xref="algorithm1.14.14.m1.1.1.3.2">𝒔</ci><ci id="algorithm1.14.14.m1.1.1.3.3.cmml" xref="algorithm1.14.14.m1.1.1.3.3">𝑖</ci></apply><apply id="algorithm1.14.14.m1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1.1"><times id="algorithm1.14.14.m1.1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1.1.2"></times><apply id="algorithm1.14.14.m1.1.1.1.3.cmml" xref="algorithm1.14.14.m1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.1.3.1.cmml" xref="algorithm1.14.14.m1.1.1.1.3">subscript</csymbol><ci id="algorithm1.14.14.m1.1.1.1.3.2.cmml" xref="algorithm1.14.14.m1.1.1.1.3.2">𝑔</ci><ci id="algorithm1.14.14.m1.1.1.1.3.3.cmml" xref="algorithm1.14.14.m1.1.1.1.3.3">Φ</ci></apply><apply id="algorithm1.14.14.m1.1.1.1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1">subscript</csymbol><apply id="algorithm1.14.14.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.14.14.m1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1.2.2">𝒉</ci><ci id="algorithm1.14.14.m1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="algorithm1.14.14.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.1c">{\boldsymbol{s}}_{i}=g_{\Phi}({\boldsymbol{h}}^{\prime}_{i})</annotation></semantics></math>
</div>
<div id="algorithm1.15.15" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
             <math id="algorithm1.15.15.m1.2" class="ltx_Math" alttext="\nabla_{\theta^{\mathsf{s}}}\mathscr{L}({\boldsymbol{s}}_{i},\hat{{\boldsymbol{s}}}_{i})" display="inline"><semantics id="algorithm1.15.15.m1.2a"><mrow id="algorithm1.15.15.m1.2.2" xref="algorithm1.15.15.m1.2.2.cmml"><mrow id="algorithm1.15.15.m1.2.2.4" xref="algorithm1.15.15.m1.2.2.4.cmml"><msub id="algorithm1.15.15.m1.2.2.4.1" xref="algorithm1.15.15.m1.2.2.4.1.cmml"><mo id="algorithm1.15.15.m1.2.2.4.1.2" xref="algorithm1.15.15.m1.2.2.4.1.2.cmml">∇</mo><msup id="algorithm1.15.15.m1.2.2.4.1.3" xref="algorithm1.15.15.m1.2.2.4.1.3.cmml"><mi id="algorithm1.15.15.m1.2.2.4.1.3.2" xref="algorithm1.15.15.m1.2.2.4.1.3.2.cmml">θ</mi><mi id="algorithm1.15.15.m1.2.2.4.1.3.3" xref="algorithm1.15.15.m1.2.2.4.1.3.3.cmml">𝗌</mi></msup></msub><mi class="ltx_font_mathscript" id="algorithm1.15.15.m1.2.2.4.2" xref="algorithm1.15.15.m1.2.2.4.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="algorithm1.15.15.m1.2.2.3" xref="algorithm1.15.15.m1.2.2.3.cmml">​</mo><mrow id="algorithm1.15.15.m1.2.2.2.2" xref="algorithm1.15.15.m1.2.2.2.3.cmml"><mo stretchy="false" id="algorithm1.15.15.m1.2.2.2.2.3" xref="algorithm1.15.15.m1.2.2.2.3.cmml">(</mo><msub id="algorithm1.15.15.m1.1.1.1.1.1" xref="algorithm1.15.15.m1.1.1.1.1.1.cmml"><mi id="algorithm1.15.15.m1.1.1.1.1.1.2" xref="algorithm1.15.15.m1.1.1.1.1.1.2.cmml">𝒔</mi><mi id="algorithm1.15.15.m1.1.1.1.1.1.3" xref="algorithm1.15.15.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.15.15.m1.2.2.2.2.4" xref="algorithm1.15.15.m1.2.2.2.3.cmml">,</mo><msub id="algorithm1.15.15.m1.2.2.2.2.2" xref="algorithm1.15.15.m1.2.2.2.2.2.cmml"><mover accent="true" id="algorithm1.15.15.m1.2.2.2.2.2.2" xref="algorithm1.15.15.m1.2.2.2.2.2.2.cmml"><mi id="algorithm1.15.15.m1.2.2.2.2.2.2.2" xref="algorithm1.15.15.m1.2.2.2.2.2.2.2.cmml">𝒔</mi><mo id="algorithm1.15.15.m1.2.2.2.2.2.2.1" xref="algorithm1.15.15.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="algorithm1.15.15.m1.2.2.2.2.2.3" xref="algorithm1.15.15.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="algorithm1.15.15.m1.2.2.2.2.5" xref="algorithm1.15.15.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.2b"><apply id="algorithm1.15.15.m1.2.2.cmml" xref="algorithm1.15.15.m1.2.2"><times id="algorithm1.15.15.m1.2.2.3.cmml" xref="algorithm1.15.15.m1.2.2.3"></times><apply id="algorithm1.15.15.m1.2.2.4.cmml" xref="algorithm1.15.15.m1.2.2.4"><apply id="algorithm1.15.15.m1.2.2.4.1.cmml" xref="algorithm1.15.15.m1.2.2.4.1"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.2.2.4.1.1.cmml" xref="algorithm1.15.15.m1.2.2.4.1">subscript</csymbol><ci id="algorithm1.15.15.m1.2.2.4.1.2.cmml" xref="algorithm1.15.15.m1.2.2.4.1.2">∇</ci><apply id="algorithm1.15.15.m1.2.2.4.1.3.cmml" xref="algorithm1.15.15.m1.2.2.4.1.3"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.2.2.4.1.3.1.cmml" xref="algorithm1.15.15.m1.2.2.4.1.3">superscript</csymbol><ci id="algorithm1.15.15.m1.2.2.4.1.3.2.cmml" xref="algorithm1.15.15.m1.2.2.4.1.3.2">𝜃</ci><ci id="algorithm1.15.15.m1.2.2.4.1.3.3.cmml" xref="algorithm1.15.15.m1.2.2.4.1.3.3">𝗌</ci></apply></apply><ci id="algorithm1.15.15.m1.2.2.4.2.cmml" xref="algorithm1.15.15.m1.2.2.4.2">ℒ</ci></apply><interval closure="open" id="algorithm1.15.15.m1.2.2.2.3.cmml" xref="algorithm1.15.15.m1.2.2.2.2"><apply id="algorithm1.15.15.m1.1.1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.15.15.m1.1.1.1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1.2">𝒔</ci><ci id="algorithm1.15.15.m1.1.1.1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.15.15.m1.2.2.2.2.2.cmml" xref="algorithm1.15.15.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.2.2.2.2.2.1.cmml" xref="algorithm1.15.15.m1.2.2.2.2.2">subscript</csymbol><apply id="algorithm1.15.15.m1.2.2.2.2.2.2.cmml" xref="algorithm1.15.15.m1.2.2.2.2.2.2"><ci id="algorithm1.15.15.m1.2.2.2.2.2.2.1.cmml" xref="algorithm1.15.15.m1.2.2.2.2.2.2.1">^</ci><ci id="algorithm1.15.15.m1.2.2.2.2.2.2.2.cmml" xref="algorithm1.15.15.m1.2.2.2.2.2.2.2">𝒔</ci></apply><ci id="algorithm1.15.15.m1.2.2.2.2.2.3.cmml" xref="algorithm1.15.15.m1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.2c">\nabla_{\theta^{\mathsf{s}}}\mathscr{L}({\boldsymbol{s}}_{i},\hat{{\boldsymbol{s}}}_{i})</annotation></semantics></math>
</div>
<div id="algorithm1.26.31" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
// <span id="algorithm1.26.31.1" class="ltx_text ltx_font_italic">Store (key, value) in memory of dynamic weights</span>
</div>
<div id="algorithm1.16.16" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.16.16.m1.2" class="ltx_Math" alttext="{\mathcal{M}}\,\leftarrow\,{\mathcal{M}}~{}~{}\;\cup\,~{}~{}({\boldsymbol{h}},\;\nabla_{\theta^{\mathsf{s}}}\mathscr{L}({\boldsymbol{s}}_{i},\hat{{\boldsymbol{s}}}_{i}))" display="inline"><semantics id="algorithm1.16.16.m1.2a"><mrow id="algorithm1.16.16.m1.2.2" xref="algorithm1.16.16.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.16.16.m1.2.2.3" xref="algorithm1.16.16.m1.2.2.3.cmml">ℳ</mi><mo lspace="0.448em" rspace="0.448em" stretchy="false" id="algorithm1.16.16.m1.2.2.2" xref="algorithm1.16.16.m1.2.2.2.cmml">←</mo><mrow id="algorithm1.16.16.m1.2.2.1" xref="algorithm1.16.16.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.16.16.m1.2.2.1.3" xref="algorithm1.16.16.m1.2.2.1.3.cmml">ℳ</mi><mo lspace="1.162em" rspace="1.052em" id="algorithm1.16.16.m1.2.2.1.2" xref="algorithm1.16.16.m1.2.2.1.2.cmml">∪</mo><mrow id="algorithm1.16.16.m1.2.2.1.1.1" xref="algorithm1.16.16.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="algorithm1.16.16.m1.2.2.1.1.1.2" xref="algorithm1.16.16.m1.2.2.1.1.2.cmml">(</mo><mi id="algorithm1.16.16.m1.1.1" xref="algorithm1.16.16.m1.1.1.cmml">𝒉</mi><mo rspace="0.447em" id="algorithm1.16.16.m1.2.2.1.1.1.3" xref="algorithm1.16.16.m1.2.2.1.1.2.cmml">,</mo><mrow id="algorithm1.16.16.m1.2.2.1.1.1.1" xref="algorithm1.16.16.m1.2.2.1.1.1.1.cmml"><mrow id="algorithm1.16.16.m1.2.2.1.1.1.1.4" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.cmml"><msub id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.2" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.2.cmml">∇</mo><msup id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3.cmml"><mi id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3.2" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3.2.cmml">θ</mi><mi id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3.3" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3.3.cmml">𝗌</mi></msup></msub><mi class="ltx_font_mathscript" id="algorithm1.16.16.m1.2.2.1.1.1.1.4.2" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="algorithm1.16.16.m1.2.2.1.1.1.1.3" xref="algorithm1.16.16.m1.2.2.1.1.1.1.3.cmml">​</mo><mrow id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.3.cmml"><mo stretchy="false" id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.3" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.3.cmml">(</mo><msub id="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1" xref="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1.2" xref="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝒔</mi><mi id="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1.3" xref="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.4" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.3.cmml">,</mo><msub id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.cmml"><mover accent="true" id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2.cmml"><mi id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2.2" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2.2.cmml">𝒔</mi><mo id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2.1" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.3" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.5" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="algorithm1.16.16.m1.2.2.1.1.1.4" xref="algorithm1.16.16.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.2b"><apply id="algorithm1.16.16.m1.2.2.cmml" xref="algorithm1.16.16.m1.2.2"><ci id="algorithm1.16.16.m1.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.2">←</ci><ci id="algorithm1.16.16.m1.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.3">ℳ</ci><apply id="algorithm1.16.16.m1.2.2.1.cmml" xref="algorithm1.16.16.m1.2.2.1"><union id="algorithm1.16.16.m1.2.2.1.2.cmml" xref="algorithm1.16.16.m1.2.2.1.2"></union><ci id="algorithm1.16.16.m1.2.2.1.3.cmml" xref="algorithm1.16.16.m1.2.2.1.3">ℳ</ci><interval closure="open" id="algorithm1.16.16.m1.2.2.1.1.2.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1"><ci id="algorithm1.16.16.m1.1.1.cmml" xref="algorithm1.16.16.m1.1.1">𝒉</ci><apply id="algorithm1.16.16.m1.2.2.1.1.1.1.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1"><times id="algorithm1.16.16.m1.2.2.1.1.1.1.3.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.3"></times><apply id="algorithm1.16.16.m1.2.2.1.1.1.1.4.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4"><apply id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.1.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1">subscript</csymbol><ci id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.2.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.2">∇</ci><apply id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3.1.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3">superscript</csymbol><ci id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3.2.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3.2">𝜃</ci><ci id="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3.3.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.1.3.3">𝗌</ci></apply></apply><ci id="algorithm1.16.16.m1.2.2.1.1.1.1.4.2.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.4.2">ℒ</ci></apply><interval closure="open" id="algorithm1.16.16.m1.2.2.1.1.1.1.2.3.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2"><apply id="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1.2">𝒔</ci><ci id="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2">subscript</csymbol><apply id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2"><ci id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2.1">^</ci><ci id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.2.2">𝒔</ci></apply><ci id="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="algorithm1.16.16.m1.2.2.1.1.1.1.2.2.2.3">𝑖</ci></apply></interval></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.2c">{\mathcal{M}}\,\leftarrow\,{\mathcal{M}}~{}~{}\;\cup\,~{}~{}({\boldsymbol{h}},\;\nabla_{\theta^{\mathsf{s}}}\mathscr{L}({\boldsymbol{s}}_{i},\hat{{\boldsymbol{s}}}_{i}))</annotation></semantics></math>

</div>
<div id="algorithm1.26.32" class="ltx_listingline"> end for
</div>
<div id="algorithm1.17.17" class="ltx_listingline">
<math id="algorithm1.17.17.m1.1" class="ltx_Math" alttext="\phi^{a}~{}=~{}\frac{1}{N^{a}}\sum_{i:\hat{s}_{i}^{a}=1}^{N^{a}}{\boldsymbol{h}}^{\prime}_{i}~{}~{}~{}\forall a" display="inline"><semantics id="algorithm1.17.17.m1.1a"><mrow id="algorithm1.17.17.m1.1.1" xref="algorithm1.17.17.m1.1.1.cmml"><msup id="algorithm1.17.17.m1.1.1.2" xref="algorithm1.17.17.m1.1.1.2.cmml"><mi id="algorithm1.17.17.m1.1.1.2.2" xref="algorithm1.17.17.m1.1.1.2.2.cmml">ϕ</mi><mi id="algorithm1.17.17.m1.1.1.2.3" xref="algorithm1.17.17.m1.1.1.2.3.cmml">a</mi></msup><mo lspace="0.608em" rspace="0.608em" id="algorithm1.17.17.m1.1.1.1" xref="algorithm1.17.17.m1.1.1.1.cmml">=</mo><mrow id="algorithm1.17.17.m1.1.1.3" xref="algorithm1.17.17.m1.1.1.3.cmml"><mfrac id="algorithm1.17.17.m1.1.1.3.2" xref="algorithm1.17.17.m1.1.1.3.2.cmml"><mn id="algorithm1.17.17.m1.1.1.3.2.2" xref="algorithm1.17.17.m1.1.1.3.2.2.cmml">1</mn><msup id="algorithm1.17.17.m1.1.1.3.2.3" xref="algorithm1.17.17.m1.1.1.3.2.3.cmml"><mi id="algorithm1.17.17.m1.1.1.3.2.3.2" xref="algorithm1.17.17.m1.1.1.3.2.3.2.cmml">N</mi><mi id="algorithm1.17.17.m1.1.1.3.2.3.3" xref="algorithm1.17.17.m1.1.1.3.2.3.3.cmml">a</mi></msup></mfrac><mo lspace="0em" rspace="0em" id="algorithm1.17.17.m1.1.1.3.1" xref="algorithm1.17.17.m1.1.1.3.1.cmml">​</mo><mrow id="algorithm1.17.17.m1.1.1.3.3" xref="algorithm1.17.17.m1.1.1.3.3.cmml"><msubsup id="algorithm1.17.17.m1.1.1.3.3.1" xref="algorithm1.17.17.m1.1.1.3.3.1.cmml"><mo id="algorithm1.17.17.m1.1.1.3.3.1.2.2" xref="algorithm1.17.17.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.17.17.m1.1.1.3.3.1.2.3" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.cmml"><mi id="algorithm1.17.17.m1.1.1.3.3.1.2.3.2" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo lspace="0.278em" rspace="0.278em" id="algorithm1.17.17.m1.1.1.3.3.1.2.3.1" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.1.cmml">:</mo><mrow id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.cmml"><msubsup id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.cmml"><mover accent="true" id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2.cmml"><mi id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2.2" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2.2.cmml">s</mi><mo id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2.1" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2.1.cmml">^</mo></mover><mi id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.3" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.3.cmml">i</mi><mi id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.3" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.3.cmml">a</mi></msubsup><mo id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.1" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.1.cmml">=</mo><mn id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.3" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.3.cmml">1</mn></mrow></mrow><msup id="algorithm1.17.17.m1.1.1.3.3.1.3" xref="algorithm1.17.17.m1.1.1.3.3.1.3.cmml"><mi id="algorithm1.17.17.m1.1.1.3.3.1.3.2" xref="algorithm1.17.17.m1.1.1.3.3.1.3.2.cmml">N</mi><mi id="algorithm1.17.17.m1.1.1.3.3.1.3.3" xref="algorithm1.17.17.m1.1.1.3.3.1.3.3.cmml">a</mi></msup></msubsup><mrow id="algorithm1.17.17.m1.1.1.3.3.2" xref="algorithm1.17.17.m1.1.1.3.3.2.cmml"><msubsup id="algorithm1.17.17.m1.1.1.3.3.2.2" xref="algorithm1.17.17.m1.1.1.3.3.2.2.cmml"><mi id="algorithm1.17.17.m1.1.1.3.3.2.2.2.2" xref="algorithm1.17.17.m1.1.1.3.3.2.2.2.2.cmml">𝒉</mi><mi id="algorithm1.17.17.m1.1.1.3.3.2.2.3" xref="algorithm1.17.17.m1.1.1.3.3.2.2.3.cmml">i</mi><mo id="algorithm1.17.17.m1.1.1.3.3.2.2.2.3" xref="algorithm1.17.17.m1.1.1.3.3.2.2.2.3.cmml">′</mo></msubsup><mo lspace="0.167em" rspace="0em" id="algorithm1.17.17.m1.1.1.3.3.2.1" xref="algorithm1.17.17.m1.1.1.3.3.2.1.cmml">​</mo><mrow id="algorithm1.17.17.m1.1.1.3.3.2.3" xref="algorithm1.17.17.m1.1.1.3.3.2.3.cmml"><mo rspace="0.167em" id="algorithm1.17.17.m1.1.1.3.3.2.3.1" xref="algorithm1.17.17.m1.1.1.3.3.2.3.1.cmml">∀</mo><mi id="algorithm1.17.17.m1.1.1.3.3.2.3.2" xref="algorithm1.17.17.m1.1.1.3.3.2.3.2.cmml">a</mi></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m1.1b"><apply id="algorithm1.17.17.m1.1.1.cmml" xref="algorithm1.17.17.m1.1.1"><eq id="algorithm1.17.17.m1.1.1.1.cmml" xref="algorithm1.17.17.m1.1.1.1"></eq><apply id="algorithm1.17.17.m1.1.1.2.cmml" xref="algorithm1.17.17.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.2.1.cmml" xref="algorithm1.17.17.m1.1.1.2">superscript</csymbol><ci id="algorithm1.17.17.m1.1.1.2.2.cmml" xref="algorithm1.17.17.m1.1.1.2.2">italic-ϕ</ci><ci id="algorithm1.17.17.m1.1.1.2.3.cmml" xref="algorithm1.17.17.m1.1.1.2.3">𝑎</ci></apply><apply id="algorithm1.17.17.m1.1.1.3.cmml" xref="algorithm1.17.17.m1.1.1.3"><times id="algorithm1.17.17.m1.1.1.3.1.cmml" xref="algorithm1.17.17.m1.1.1.3.1"></times><apply id="algorithm1.17.17.m1.1.1.3.2.cmml" xref="algorithm1.17.17.m1.1.1.3.2"><divide id="algorithm1.17.17.m1.1.1.3.2.1.cmml" xref="algorithm1.17.17.m1.1.1.3.2"></divide><cn type="integer" id="algorithm1.17.17.m1.1.1.3.2.2.cmml" xref="algorithm1.17.17.m1.1.1.3.2.2">1</cn><apply id="algorithm1.17.17.m1.1.1.3.2.3.cmml" xref="algorithm1.17.17.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.3.2.3.1.cmml" xref="algorithm1.17.17.m1.1.1.3.2.3">superscript</csymbol><ci id="algorithm1.17.17.m1.1.1.3.2.3.2.cmml" xref="algorithm1.17.17.m1.1.1.3.2.3.2">𝑁</ci><ci id="algorithm1.17.17.m1.1.1.3.2.3.3.cmml" xref="algorithm1.17.17.m1.1.1.3.2.3.3">𝑎</ci></apply></apply><apply id="algorithm1.17.17.m1.1.1.3.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3"><apply id="algorithm1.17.17.m1.1.1.3.3.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.3.3.1.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1">superscript</csymbol><apply id="algorithm1.17.17.m1.1.1.3.3.1.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.3.3.1.2.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1">subscript</csymbol><sum id="algorithm1.17.17.m1.1.1.3.3.1.2.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.2"></sum><apply id="algorithm1.17.17.m1.1.1.3.3.1.2.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3"><ci id="algorithm1.17.17.m1.1.1.3.3.1.2.3.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.1">:</ci><ci id="algorithm1.17.17.m1.1.1.3.3.1.2.3.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.2">𝑖</ci><apply id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3"><eq id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.1"></eq><apply id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2">superscript</csymbol><apply id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2">subscript</csymbol><apply id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2"><ci id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2.1">^</ci><ci id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.2.2">𝑠</ci></apply><ci id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.2.3">𝑖</ci></apply><ci id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.2.3">𝑎</ci></apply><cn type="integer" id="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.2.3.3.3">1</cn></apply></apply></apply><apply id="algorithm1.17.17.m1.1.1.3.3.1.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.3"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.3.3.1.3.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.3">superscript</csymbol><ci id="algorithm1.17.17.m1.1.1.3.3.1.3.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.3.2">𝑁</ci><ci id="algorithm1.17.17.m1.1.1.3.3.1.3.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3.1.3.3">𝑎</ci></apply></apply><apply id="algorithm1.17.17.m1.1.1.3.3.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2"><times id="algorithm1.17.17.m1.1.1.3.3.2.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2.1"></times><apply id="algorithm1.17.17.m1.1.1.3.3.2.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.3.3.2.2.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2.2">subscript</csymbol><apply id="algorithm1.17.17.m1.1.1.3.3.2.2.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.3.3.2.2.2.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2.2">superscript</csymbol><ci id="algorithm1.17.17.m1.1.1.3.3.2.2.2.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2.2.2.2">𝒉</ci><ci id="algorithm1.17.17.m1.1.1.3.3.2.2.2.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2.2.2.3">′</ci></apply><ci id="algorithm1.17.17.m1.1.1.3.3.2.2.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="algorithm1.17.17.m1.1.1.3.3.2.3.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2.3"><csymbol cd="latexml" id="algorithm1.17.17.m1.1.1.3.3.2.3.1.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2.3.1">for-all</csymbol><ci id="algorithm1.17.17.m1.1.1.3.3.2.3.2.cmml" xref="algorithm1.17.17.m1.1.1.3.3.2.3.2">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m1.1c">\phi^{a}~{}=~{}\frac{1}{N^{a}}\sum_{i:\hat{s}_{i}^{a}=1}^{N^{a}}{\boldsymbol{h}}^{\prime}_{i}~{}~{}~{}\forall a</annotation></semantics></math>  // <span id="algorithm1.17.17.1" class="ltx_text ltx_font_italic">One average per answer</span>
</div>
<div id="algorithm1.18.18" class="ltx_listingline">
<math id="algorithm1.18.18.m1.1" class="ltx_Math" alttext="\Phi^{\mathsf{d}}~{}=~{}\cup_{a}\phi^{a}" display="inline"><semantics id="algorithm1.18.18.m1.1a"><mrow id="algorithm1.18.18.m1.1.1" xref="algorithm1.18.18.m1.1.1.cmml"><msup id="algorithm1.18.18.m1.1.1.2" xref="algorithm1.18.18.m1.1.1.2.cmml"><mi mathvariant="normal" id="algorithm1.18.18.m1.1.1.2.2" xref="algorithm1.18.18.m1.1.1.2.2.cmml">Φ</mi><mi id="algorithm1.18.18.m1.1.1.2.3" xref="algorithm1.18.18.m1.1.1.2.3.cmml">𝖽</mi></msup><mo lspace="0.608em" rspace="0.108em" id="algorithm1.18.18.m1.1.1.1" xref="algorithm1.18.18.m1.1.1.1.cmml">=</mo><mrow id="algorithm1.18.18.m1.1.1.3" xref="algorithm1.18.18.m1.1.1.3.cmml"><msub id="algorithm1.18.18.m1.1.1.3.1" xref="algorithm1.18.18.m1.1.1.3.1.cmml"><mo id="algorithm1.18.18.m1.1.1.3.1.2" xref="algorithm1.18.18.m1.1.1.3.1.2.cmml">∪</mo><mi id="algorithm1.18.18.m1.1.1.3.1.3" xref="algorithm1.18.18.m1.1.1.3.1.3.cmml">a</mi></msub><msup id="algorithm1.18.18.m1.1.1.3.2" xref="algorithm1.18.18.m1.1.1.3.2.cmml"><mi id="algorithm1.18.18.m1.1.1.3.2.2" xref="algorithm1.18.18.m1.1.1.3.2.2.cmml">ϕ</mi><mi id="algorithm1.18.18.m1.1.1.3.2.3" xref="algorithm1.18.18.m1.1.1.3.2.3.cmml">a</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.1b"><apply id="algorithm1.18.18.m1.1.1.cmml" xref="algorithm1.18.18.m1.1.1"><eq id="algorithm1.18.18.m1.1.1.1.cmml" xref="algorithm1.18.18.m1.1.1.1"></eq><apply id="algorithm1.18.18.m1.1.1.2.cmml" xref="algorithm1.18.18.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.2.1.cmml" xref="algorithm1.18.18.m1.1.1.2">superscript</csymbol><ci id="algorithm1.18.18.m1.1.1.2.2.cmml" xref="algorithm1.18.18.m1.1.1.2.2">Φ</ci><ci id="algorithm1.18.18.m1.1.1.2.3.cmml" xref="algorithm1.18.18.m1.1.1.2.3">𝖽</ci></apply><apply id="algorithm1.18.18.m1.1.1.3.cmml" xref="algorithm1.18.18.m1.1.1.3"><apply id="algorithm1.18.18.m1.1.1.3.1.cmml" xref="algorithm1.18.18.m1.1.1.3.1"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.3.1.1.cmml" xref="algorithm1.18.18.m1.1.1.3.1">subscript</csymbol><union id="algorithm1.18.18.m1.1.1.3.1.2.cmml" xref="algorithm1.18.18.m1.1.1.3.1.2"></union><ci id="algorithm1.18.18.m1.1.1.3.1.3.cmml" xref="algorithm1.18.18.m1.1.1.3.1.3">𝑎</ci></apply><apply id="algorithm1.18.18.m1.1.1.3.2.cmml" xref="algorithm1.18.18.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.3.2.1.cmml" xref="algorithm1.18.18.m1.1.1.3.2">superscript</csymbol><ci id="algorithm1.18.18.m1.1.1.3.2.2.cmml" xref="algorithm1.18.18.m1.1.1.3.2.2">italic-ϕ</ci><ci id="algorithm1.18.18.m1.1.1.3.2.3.cmml" xref="algorithm1.18.18.m1.1.1.3.2.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.1c">\Phi^{\mathsf{d}}~{}=~{}\cup_{a}\phi^{a}</annotation></semantics></math>  // <span id="algorithm1.18.18.1" class="ltx_text ltx_font_italic">Store dynamic prototypes</span>
</div>
<div id="algorithm1.20.20" class="ltx_listingline">
Forward prop. of (<math id="algorithm1.19.19.m1.1" class="ltx_Math" alttext="\mathsf{Q}" display="inline"><semantics id="algorithm1.19.19.m1.1a"><mi id="algorithm1.19.19.m1.1.1" xref="algorithm1.19.19.m1.1.1.cmml">𝖰</mi><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m1.1b"><ci id="algorithm1.19.19.m1.1.1.cmml" xref="algorithm1.19.19.m1.1.1">𝖰</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m1.1c">\mathsf{Q}</annotation></semantics></math>, <math id="algorithm1.20.20.m2.1" class="ltx_Math" alttext="\mathsf{I}" display="inline"><semantics id="algorithm1.20.20.m2.1a"><mi id="algorithm1.20.20.m2.1.1" xref="algorithm1.20.20.m2.1.1.cmml">𝖨</mi><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m2.1b"><ci id="algorithm1.20.20.m2.1.1.cmml" xref="algorithm1.20.20.m2.1.1">𝖨</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m2.1c">\mathsf{I}</annotation></semantics></math>) with static and dynamic param.
</div>
<div id="algorithm1.26.33" class="ltx_listingline">
<span id="algorithm1.26.33.1" class="ltx_text ltx_font_bold">if</span> <em id="algorithm1.26.33.2" class="ltx_emph ltx_font_italic">test time</em> <span id="algorithm1.26.33.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="algorithm1.21.21" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Return predicted scores <math id="algorithm1.21.21.m1.2" class="ltx_Math" alttext="{\boldsymbol{s}}=g_{\Phi}\big{(}f_{\theta}({\boldsymbol{h}})\big{)}" display="inline"><semantics id="algorithm1.21.21.m1.2a"><mrow id="algorithm1.21.21.m1.2.2" xref="algorithm1.21.21.m1.2.2.cmml"><mi id="algorithm1.21.21.m1.2.2.3" xref="algorithm1.21.21.m1.2.2.3.cmml">𝒔</mi><mo id="algorithm1.21.21.m1.2.2.2" xref="algorithm1.21.21.m1.2.2.2.cmml">=</mo><mrow id="algorithm1.21.21.m1.2.2.1" xref="algorithm1.21.21.m1.2.2.1.cmml"><msub id="algorithm1.21.21.m1.2.2.1.3" xref="algorithm1.21.21.m1.2.2.1.3.cmml"><mi id="algorithm1.21.21.m1.2.2.1.3.2" xref="algorithm1.21.21.m1.2.2.1.3.2.cmml">g</mi><mi mathvariant="normal" id="algorithm1.21.21.m1.2.2.1.3.3" xref="algorithm1.21.21.m1.2.2.1.3.3.cmml">Φ</mi></msub><mo lspace="0em" rspace="0em" id="algorithm1.21.21.m1.2.2.1.2" xref="algorithm1.21.21.m1.2.2.1.2.cmml">​</mo><mrow id="algorithm1.21.21.m1.2.2.1.1.1" xref="algorithm1.21.21.m1.2.2.1.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="algorithm1.21.21.m1.2.2.1.1.1.2" xref="algorithm1.21.21.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="algorithm1.21.21.m1.2.2.1.1.1.1" xref="algorithm1.21.21.m1.2.2.1.1.1.1.cmml"><msub id="algorithm1.21.21.m1.2.2.1.1.1.1.2" xref="algorithm1.21.21.m1.2.2.1.1.1.1.2.cmml"><mi id="algorithm1.21.21.m1.2.2.1.1.1.1.2.2" xref="algorithm1.21.21.m1.2.2.1.1.1.1.2.2.cmml">f</mi><mi id="algorithm1.21.21.m1.2.2.1.1.1.1.2.3" xref="algorithm1.21.21.m1.2.2.1.1.1.1.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="algorithm1.21.21.m1.2.2.1.1.1.1.1" xref="algorithm1.21.21.m1.2.2.1.1.1.1.1.cmml">​</mo><mrow id="algorithm1.21.21.m1.2.2.1.1.1.1.3.2" xref="algorithm1.21.21.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.21.21.m1.2.2.1.1.1.1.3.2.1" xref="algorithm1.21.21.m1.2.2.1.1.1.1.cmml">(</mo><mi id="algorithm1.21.21.m1.1.1" xref="algorithm1.21.21.m1.1.1.cmml">𝒉</mi><mo stretchy="false" id="algorithm1.21.21.m1.2.2.1.1.1.1.3.2.2" xref="algorithm1.21.21.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo maxsize="120%" minsize="120%" id="algorithm1.21.21.m1.2.2.1.1.1.3" xref="algorithm1.21.21.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.2b"><apply id="algorithm1.21.21.m1.2.2.cmml" xref="algorithm1.21.21.m1.2.2"><eq id="algorithm1.21.21.m1.2.2.2.cmml" xref="algorithm1.21.21.m1.2.2.2"></eq><ci id="algorithm1.21.21.m1.2.2.3.cmml" xref="algorithm1.21.21.m1.2.2.3">𝒔</ci><apply id="algorithm1.21.21.m1.2.2.1.cmml" xref="algorithm1.21.21.m1.2.2.1"><times id="algorithm1.21.21.m1.2.2.1.2.cmml" xref="algorithm1.21.21.m1.2.2.1.2"></times><apply id="algorithm1.21.21.m1.2.2.1.3.cmml" xref="algorithm1.21.21.m1.2.2.1.3"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.2.2.1.3.1.cmml" xref="algorithm1.21.21.m1.2.2.1.3">subscript</csymbol><ci id="algorithm1.21.21.m1.2.2.1.3.2.cmml" xref="algorithm1.21.21.m1.2.2.1.3.2">𝑔</ci><ci id="algorithm1.21.21.m1.2.2.1.3.3.cmml" xref="algorithm1.21.21.m1.2.2.1.3.3">Φ</ci></apply><apply id="algorithm1.21.21.m1.2.2.1.1.1.1.cmml" xref="algorithm1.21.21.m1.2.2.1.1.1"><times id="algorithm1.21.21.m1.2.2.1.1.1.1.1.cmml" xref="algorithm1.21.21.m1.2.2.1.1.1.1.1"></times><apply id="algorithm1.21.21.m1.2.2.1.1.1.1.2.cmml" xref="algorithm1.21.21.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.2.2.1.1.1.1.2.1.cmml" xref="algorithm1.21.21.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="algorithm1.21.21.m1.2.2.1.1.1.1.2.2.cmml" xref="algorithm1.21.21.m1.2.2.1.1.1.1.2.2">𝑓</ci><ci id="algorithm1.21.21.m1.2.2.1.1.1.1.2.3.cmml" xref="algorithm1.21.21.m1.2.2.1.1.1.1.2.3">𝜃</ci></apply><ci id="algorithm1.21.21.m1.1.1.cmml" xref="algorithm1.21.21.m1.1.1">𝒉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.2c">{\boldsymbol{s}}=g_{\Phi}\big{(}f_{\theta}({\boldsymbol{h}})\big{)}</annotation></semantics></math>

</div>
<div id="algorithm1.26.34" class="ltx_listingline">
<span id="algorithm1.26.34.1" class="ltx_text ltx_font_bold">else if</span> <em id="algorithm1.26.34.2" class="ltx_emph ltx_font_italic">training time</em> <span id="algorithm1.26.34.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="algorithm1.26.35" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Backpropagation and gradient descent
</div>
<div id="algorithm1.26.26" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Update static parameters <math id="algorithm1.22.22.m1.1" class="ltx_Math" alttext="\theta^{\mathsf{s}}" display="inline"><semantics id="algorithm1.22.22.m1.1a"><msup id="algorithm1.22.22.m1.1.1" xref="algorithm1.22.22.m1.1.1.cmml"><mi id="algorithm1.22.22.m1.1.1.2" xref="algorithm1.22.22.m1.1.1.2.cmml">θ</mi><mi id="algorithm1.22.22.m1.1.1.3" xref="algorithm1.22.22.m1.1.1.3.cmml">𝗌</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m1.1b"><apply id="algorithm1.22.22.m1.1.1.cmml" xref="algorithm1.22.22.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1">superscript</csymbol><ci id="algorithm1.22.22.m1.1.1.2.cmml" xref="algorithm1.22.22.m1.1.1.2">𝜃</ci><ci id="algorithm1.22.22.m1.1.1.3.cmml" xref="algorithm1.22.22.m1.1.1.3">𝗌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m1.1c">\theta^{\mathsf{s}}</annotation></semantics></math>, <math id="algorithm1.23.23.m2.1" class="ltx_Math" alttext="\phi^{\mathsf{s}}" display="inline"><semantics id="algorithm1.23.23.m2.1a"><msup id="algorithm1.23.23.m2.1.1" xref="algorithm1.23.23.m2.1.1.cmml"><mi id="algorithm1.23.23.m2.1.1.2" xref="algorithm1.23.23.m2.1.1.2.cmml">ϕ</mi><mi id="algorithm1.23.23.m2.1.1.3" xref="algorithm1.23.23.m2.1.1.3.cmml">𝗌</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.m2.1b"><apply id="algorithm1.23.23.m2.1.1.cmml" xref="algorithm1.23.23.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.23.23.m2.1.1.1.cmml" xref="algorithm1.23.23.m2.1.1">superscript</csymbol><ci id="algorithm1.23.23.m2.1.1.2.cmml" xref="algorithm1.23.23.m2.1.1.2">italic-ϕ</ci><ci id="algorithm1.23.23.m2.1.1.3.cmml" xref="algorithm1.23.23.m2.1.1.3">𝗌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.m2.1c">\phi^{\mathsf{s}}</annotation></semantics></math>, <math id="algorithm1.24.24.m3.1" class="ltx_Math" alttext="b^{\prime\prime}" display="inline"><semantics id="algorithm1.24.24.m3.1a"><msup id="algorithm1.24.24.m3.1.1" xref="algorithm1.24.24.m3.1.1.cmml"><mi id="algorithm1.24.24.m3.1.1.2" xref="algorithm1.24.24.m3.1.1.2.cmml">b</mi><mo id="algorithm1.24.24.m3.1.1.3" xref="algorithm1.24.24.m3.1.1.3.cmml">′′</mo></msup><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.m3.1b"><apply id="algorithm1.24.24.m3.1.1.cmml" xref="algorithm1.24.24.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.24.24.m3.1.1.1.cmml" xref="algorithm1.24.24.m3.1.1">superscript</csymbol><ci id="algorithm1.24.24.m3.1.1.2.cmml" xref="algorithm1.24.24.m3.1.1.2">𝑏</ci><ci id="algorithm1.24.24.m3.1.1.3.cmml" xref="algorithm1.24.24.m3.1.1.3">′′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.m3.1c">b^{\prime\prime}</annotation></semantics></math>, <math id="algorithm1.25.25.m4.1" class="ltx_Math" alttext="w^{\prime\prime}" display="inline"><semantics id="algorithm1.25.25.m4.1a"><msup id="algorithm1.25.25.m4.1.1" xref="algorithm1.25.25.m4.1.1.cmml"><mi id="algorithm1.25.25.m4.1.1.2" xref="algorithm1.25.25.m4.1.1.2.cmml">w</mi><mo id="algorithm1.25.25.m4.1.1.3" xref="algorithm1.25.25.m4.1.1.3.cmml">′′</mo></msup><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.m4.1b"><apply id="algorithm1.25.25.m4.1.1.cmml" xref="algorithm1.25.25.m4.1.1"><csymbol cd="ambiguous" id="algorithm1.25.25.m4.1.1.1.cmml" xref="algorithm1.25.25.m4.1.1">superscript</csymbol><ci id="algorithm1.25.25.m4.1.1.2.cmml" xref="algorithm1.25.25.m4.1.1.2">𝑤</ci><ci id="algorithm1.25.25.m4.1.1.3.cmml" xref="algorithm1.25.25.m4.1.1.3">′′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.m4.1c">w^{\prime\prime}</annotation></semantics></math>, <math id="algorithm1.26.26.m5.1" class="ltx_Math" alttext="w^{\prime\prime\prime}" display="inline"><semantics id="algorithm1.26.26.m5.1a"><msup id="algorithm1.26.26.m5.1.1" xref="algorithm1.26.26.m5.1.1.cmml"><mi id="algorithm1.26.26.m5.1.1.2" xref="algorithm1.26.26.m5.1.1.2.cmml">w</mi><mo id="algorithm1.26.26.m5.1.1.3" xref="algorithm1.26.26.m5.1.1.3.cmml">′′′</mo></msup><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.m5.1b"><apply id="algorithm1.26.26.m5.1.1.cmml" xref="algorithm1.26.26.m5.1.1"><csymbol cd="ambiguous" id="algorithm1.26.26.m5.1.1.1.cmml" xref="algorithm1.26.26.m5.1.1">superscript</csymbol><ci id="algorithm1.26.26.m5.1.1.2.cmml" xref="algorithm1.26.26.m5.1.1.2">𝑤</ci><ci id="algorithm1.26.26.m5.1.1.3.cmml" xref="algorithm1.26.26.m5.1.1.3">′′′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.m5.1c">w^{\prime\prime\prime}</annotation></semantics></math>, and those of the question and image embeddings

</div>
<div id="algorithm1.26.36" class="ltx_listingline">
<span id="algorithm1.26.36.1" class="ltx_text ltx_font_bold">end</span>

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.28.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Evaluation of one test or training instance.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We perform a series of experiments to evaluate (1) how effectively the proposed model and its different components can use the support set, (2) how useful novel support instances are for VQA, (3) whether the model learns different aspects of a dataset from classical VQA methods trained in the classical setting.</p>
</div>
<section id="S5.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Datasets</h5>

<div id="S5.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px1.p1.1" class="ltx_p">The <em id="S5.SS0.SSS0.Px1.p1.1.1" class="ltx_emph ltx_font_italic">VQA v2</em> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> serves as the principal current benchmark for VQA. The heavy class imbalance among answers makes it very difficult to draw meaningful conclusions or perform a qualitative evaluation, however. We additionally propose a series of experiments on a subset referred to as <em id="S5.SS0.SSS0.Px1.p1.1.2" class="ltx_emph ltx_font_italic">VQA-Numbers</em>. It includes all questions marked in <em id="S5.SS0.SSS0.Px1.p1.1.3" class="ltx_emph ltx_font_italic">VQA v2</em> as a “number” question, which are further cleaned up to remove answers appearing less than 1,000 times in the training set, and to remove questions that do not have an unambiguous answer (we keep only those with ground truth scores containing a single element equal to <math id="S5.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S5.SS0.SSS0.Px1.p1.1.m1.1a"><mn id="S5.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px1.p1.1.m1.1b"><cn type="float" id="S5.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px1.p1.1.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px1.p1.1.m1.1c">1.0</annotation></semantics></math>). Questions from the original validation set of <em id="S5.SS0.SSS0.Px1.p1.1.4" class="ltx_emph ltx_font_italic">VQA v2</em> are used for evaluation, and the original training set (45,965 questions after clean up) is used for training, support, and validation. The precise data splits will be available publicly. Most importantly, the resulting set of candidate answers corresponds to the seven numbers from 0 to 6.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Metrics</h5>

<div id="S5.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px2.p1.6" class="ltx_p">The aggregate metric used for evaluation on <em id="S5.SS0.SSS0.Px2.p1.6.1" class="ltx_emph ltx_font_italic">VQA v2</em> is the accuracy defined as <math id="S5.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\frac{1}{|\mathscr{E}|}\sum_{i}\hat{s}_{i}^{a^{\star}_{i}}" display="inline"><semantics id="S5.SS0.SSS0.Px2.p1.1.m1.1a"><mrow id="S5.SS0.SSS0.Px2.p1.1.m1.1.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.cmml"><mfrac id="S5.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mn id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml">1</mn><mrow id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.3" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathscript" id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.cmml">ℰ</mi><mo stretchy="false" id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.cmml"><msub id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.cmml"><mo id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.2.cmml">∑</mo><mi id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.3" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.3.cmml">i</mi></msub><msubsup id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.cmml"><mover accent="true" id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2.cmml"><mi id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2.2.cmml">s</mi><mo id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2.1" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.3" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.3.cmml">i</mi><msubsup id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.cmml"><mi id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.2.2" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.2.2.cmml">a</mi><mi id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.3" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.3.cmml">i</mi><mo id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.2.3" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.2.3.cmml">⋆</mo></msubsup></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2"><times id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.1"></times><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1"><divide id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1"></divide><cn type="integer" id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.3">1</cn><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.3"><abs id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.1"></abs><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.1.1.1">ℰ</ci></apply></apply><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2"><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1">subscript</csymbol><sum id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.2"></sum><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.3">𝑖</ci></apply><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2">superscript</csymbol><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2">subscript</csymbol><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2"><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2.1">^</ci><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.2.2">𝑠</ci></apply><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2.3">𝑖</ci></apply><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3">subscript</csymbol><apply id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3">superscript</csymbol><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.2.2">𝑎</ci><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.2.3">⋆</ci></apply><ci id="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.3.cmml" xref="S5.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.1.m1.1c">\frac{1}{|\mathscr{E}|}\sum_{i}\hat{s}_{i}^{a^{\star}_{i}}</annotation></semantics></math> with ground truth scores <math id="S5.SS0.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="\hat{s}_{i}" display="inline"><semantics id="S5.SS0.SSS0.Px2.p1.2.m2.1a"><msub id="S5.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><mover accent="true" id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml"><mi id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.2" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.cmml">s</mi><mo id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.1" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><apply id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2"><ci id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.1">^</ci><ci id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.2.2">𝑠</ci></apply><ci id="S5.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.2.m2.1c">\hat{s}_{i}</annotation></semantics></math> and <math id="S5.SS0.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="{a^{\star}_{i}}" display="inline"><semantics id="S5.SS0.SSS0.Px2.p1.3.m3.1a"><msubsup id="S5.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.2.2" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1.2.2.cmml">a</mi><mi id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml">i</mi><mo id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.2.3" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1.2.3.cmml">⋆</mo></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><apply id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1">superscript</csymbol><ci id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1.2.2">𝑎</ci><ci id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1.2.3">⋆</ci></apply><ci id="S5.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.3.m3.1c">{a^{\star}_{i}}</annotation></semantics></math> the answer of highest predicted score, <math id="S5.SS0.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="\operatorname*{arg\,max}_{a}s_{i}^{a}" display="inline"><semantics id="S5.SS0.SSS0.Px2.p1.4.m4.1a"><mrow id="S5.SS0.SSS0.Px2.p1.4.m4.1.1" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.cmml"><msub id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml"><mrow id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.cmml"><mi id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.1" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.1.cmml">​</mo><mi id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.3" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.3.cmml">max</mi></mrow><mi id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.3" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.3.cmml">a</mi></msub><mo lspace="0.167em" id="S5.SS0.SSS0.Px2.p1.4.m4.1.1a" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.cmml">⁡</mo><msubsup id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml"><mi id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.2" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.2.cmml">s</mi><mi id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.3" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.3.cmml">i</mi><mi id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.3" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.3.cmml">a</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.4.m4.1b"><apply id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1"><apply id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1">subscript</csymbol><apply id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2"><times id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.1"></times><ci id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.2">arg</ci><ci id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.2.3">max</ci></apply><ci id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.1.3">𝑎</ci></apply><apply id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2">superscript</csymbol><apply id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2">subscript</csymbol><ci id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.2">𝑠</ci><ci id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.3">𝑖</ci></apply><ci id="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.4.m4.1.1.2.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.4.m4.1c">\operatorname*{arg\,max}_{a}s_{i}^{a}</annotation></semantics></math>. We also define the recall of an answer <math id="S5.SS0.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S5.SS0.SSS0.Px2.p1.5.m5.1a"><mi id="S5.SS0.SSS0.Px2.p1.5.m5.1.1" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.5.m5.1b"><ci id="S5.SS0.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.5.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.5.m5.1c">a</annotation></semantics></math> as <math id="S5.SS0.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="\sum_{i}s_{i}^{a^{\star}}~{}~{}/~{}~{}\sum_{i}\hat{s}_{i}^{a}" display="inline"><semantics id="S5.SS0.SSS0.Px2.p1.6.m6.1a"><mrow id="S5.SS0.SSS0.Px2.p1.6.m6.1.1" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.cmml"><msub id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1.cmml"><mo id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1.2" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1.2.cmml">∑</mo><mi id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1.3" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1.3.cmml">i</mi></msub><mrow id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.cmml"><msubsup id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.cmml"><mi id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.2.2" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.2.2.cmml">s</mi><mi id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.2.3" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.2.3.cmml">i</mi><msup id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3.cmml"><mi id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3.2" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3.2.cmml">a</mi><mo id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3.3" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3.3.cmml">⋆</mo></msup></msubsup><mo rspace="0.715em" id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.1" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.1.cmml">/</mo><mrow id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.cmml"><msub id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1.cmml"><mo id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1.2" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1.2.cmml">∑</mo><mi id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1.3" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1.3.cmml">i</mi></msub><msubsup id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.cmml"><mover accent="true" id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2.cmml"><mi id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2.2" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2.2.cmml">s</mi><mo id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2.1" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2.1.cmml">^</mo></mover><mi id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.3" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.3.cmml">i</mi><mi id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.3" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.3.cmml">a</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px2.p1.6.m6.1b"><apply id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1"><apply id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1">subscript</csymbol><sum id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1.2"></sum><ci id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.1.3">𝑖</ci></apply><apply id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2"><divide id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.1"></divide><apply id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2">superscript</csymbol><apply id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2">subscript</csymbol><ci id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.2.2">𝑠</ci><ci id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.2.3">𝑖</ci></apply><apply id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3">superscript</csymbol><ci id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3.2.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3.2">𝑎</ci><ci id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3.3.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.2.3.3">⋆</ci></apply></apply><apply id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3"><apply id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1">subscript</csymbol><sum id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1.2.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1.2"></sum><ci id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1.3.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.1.3">𝑖</ci></apply><apply id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2">superscript</csymbol><apply id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2"><csymbol cd="ambiguous" id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2">subscript</csymbol><apply id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2"><ci id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2.1.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2.1">^</ci><ci id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2.2.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.2.2">𝑠</ci></apply><ci id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.2.3">𝑖</ci></apply><ci id="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.3.cmml" xref="S5.SS0.SSS0.Px2.p1.6.m6.1.1.2.3.2.3">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px2.p1.6.m6.1c">\sum_{i}s_{i}^{a^{\star}}~{}~{}/~{}~{}\sum_{i}\hat{s}_{i}^{a}</annotation></semantics></math>. We look at the recall averaged (uniformly) over all possible answers to better reflect performance across a variety of answers, rather than on the most common ones.</p>
</div>
</section>
<section id="S5.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Implementation</h5>

<div id="S5.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS0.SSS0.Px3.p1.3" class="ltx_p">Our implementation is based on the code provided by the authors of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. Details non-specific to our contributions can be found there. We initialize all parameters, in particular static weights and static prototypes as if they were those of a linear layer in a traditional architecture, following Glorot and Bengio <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. During training, the support set is subsampled (Section <a href="#S4.SS2" title="4.2 Processing of Support Set ‣ 4 Proposed Model ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>) to yield a set of 1,000 elements. We use, per answer, one or two static prototypes, and zero or one dynamic prototype (as noted in the experiments). All experiments use an embedding dimension <math id="S5.SS0.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.1.m1.1a"><mi id="S5.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.1.m1.1b"><ci id="S5.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.1.m1.1c">D</annotation></semantics></math>=128 and a mini-batches of <math id="S5.SS0.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="256" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.2.m2.1a"><mn id="S5.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S5.SS0.SSS0.Px3.p1.2.m2.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.2.m2.1b"><cn type="integer" id="S5.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.2.m2.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.2.m2.1c">256</annotation></semantics></math> instances. Experiments with <em id="S5.SS0.SSS0.Px3.p1.3.1" class="ltx_emph ltx_font_italic">VQA v2</em> use a set of candidate answers capped to a minimum number of training occurrences of <math id="S5.SS0.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S5.SS0.SSS0.Px3.p1.3.m3.1a"><mn id="S5.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S5.SS0.SSS0.Px3.p1.3.m3.1b"><cn type="integer" id="S5.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S5.SS0.SSS0.Px3.p1.3.m3.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSS0.Px3.p1.3.m3.1c">16</annotation></semantics></math>, giving 1,960 possible answers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. Past works have shown that small differences in implementation can have noticeable impact on performance. Therefore, to ensure fair comparisons, we repeated all evaluations of the baseline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> with our code and preprocessing. Results are therefore not directly comparable with those reported in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. In particular, we do not use the <em id="S5.SS0.SSS0.Px3.p1.3.2" class="ltx_emph ltx_font_italic">Visual Genome</em> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> for training.</p>
</div>
</section>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>VQA-Numbers</h3>

<section id="S5.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Ablative evaluation</h5>

<div id="S5.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px1.p1.1" class="ltx_p">We first evaluate the components of the proposed model in comparison to the state-of-the-art of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> which serves as a baseline, being equivalent to our model with 1 static prototype per answer, the dot product similarity, and no dynamic parameters. We train and evaluate on all 7 answers. To provide the baseline with a fair chance<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>The <em id="footnote2.1" class="ltx_emph ltx_font_italic">VQA-Numbers</em> data is still heavily imbalanced, “1” and “2” making up almost <math id="footnote2.m1.1" class="ltx_Math" alttext="60\%" display="inline"><semantics id="footnote2.m1.1b"><mrow id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml"><mn id="footnote2.m1.1.1.2" xref="footnote2.m1.1.1.2.cmml">60</mn><mo id="footnote2.m1.1.1.1" xref="footnote2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="footnote2.m1.1c"><apply id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1"><csymbol cd="latexml" id="footnote2.m1.1.1.1.cmml" xref="footnote2.m1.1.1.1">percent</csymbol><cn type="integer" id="footnote2.m1.1.1.2.cmml" xref="footnote2.m1.1.1.2">60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.1d">60\%</annotation></semantics></math> of correct answers in equal parts.</span></span></span>, we train all models with standard supersampling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, <em id="S5.SS1.SSS0.Px1.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS1.SSS0.Px1.p1.1.2" class="ltx_text"></span> selecting training examples with equal probability with respect to their correct answer. In these experiments, the support set is equal to the training set.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<table id="S5.T1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T1.1.1" class="ltx_tr">
<td id="S5.T1.1.1.1" class="ltx_td ltx_align_justify" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">
<span id="S5.T1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T1.1.1.1.1.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:0.4pt;background:black;display:inline-block;"> </span></span>
</span><span id="S5.T1.1.1.1.2" class="ltx_text" style="font-size:70%;">     Average answer recall</span>
</td>
</tr>
<tr id="S5.T1.1.2" class="ltx_tr">
<td id="S5.T1.1.2.1" class="ltx_td ltx_align_justify" style="padding-top:1.25pt;padding-bottom:1.25pt;">
<span id="S5.T1.1.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T1.1.2.1.1.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:0.4pt;background:black;display:inline-block;"> </span></span>
</span><span id="S5.T1.1.2.1.2" class="ltx_text" style="font-size:70%;">
(1a)   Chance</span>
</td>
<td id="S5.T1.1.2.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S5.T1.1.2.2.1" class="ltx_text" style="font-size:70%;">14.28</span></td>
</tr>
<tr id="S5.T1.1.3" class="ltx_tr">
<td id="S5.T1.1.3.1" class="ltx_td ltx_align_justify" style="padding-top:1.25pt;padding-bottom:1.25pt;">
<span id="S5.T1.1.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T1.1.3.1.1.1" class="ltx_p"><span id="S5.T1.1.3.1.1.1.1" class="ltx_text" style="font-size:70%;">(1b)   State-of-the-art model </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T1.1.3.1.1.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib34" title="" class="ltx_ref">34</a><span id="S5.T1.1.3.1.1.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite></span>
</span>
</td>
<td id="S5.T1.1.3.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S5.T1.1.3.2.1" class="ltx_text" style="font-size:70%;">29.72</span></td>
</tr>
<tr id="S5.T1.1.4" class="ltx_tr">
<td id="S5.T1.1.4.1" class="ltx_td ltx_align_justify" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2"><span id="S5.T1.1.4.1.1" class="ltx_text" style="font-size:70%;">Equivalent to 1 static prototype per answer, dot prod. similarity, no dynamic param.</span></td>
</tr>
<tr id="S5.T1.1.5" class="ltx_tr">
<td id="S5.T1.1.5.1" class="ltx_td ltx_align_justify ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">
<span id="S5.T1.1.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T1.1.5.1.1.1" class="ltx_p"><span id="S5.T1.1.5.1.1.1.1" class="ltx_text" style="font-size:70%;">(2b)   1 Static prot./ans., L1 similarity</span></span>
</span>
</td>
<td id="S5.T1.1.5.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S5.T1.1.5.2.1" class="ltx_text" style="font-size:70%;">29.97</span></td>
</tr>
<tr id="S5.T1.1.6" class="ltx_tr">
<td id="S5.T1.1.6.1" class="ltx_td ltx_align_justify" style="padding-top:1.25pt;padding-bottom:1.25pt;">
<span id="S5.T1.1.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T1.1.6.1.1.1" class="ltx_p"><span id="S5.T1.1.6.1.1.1.1" class="ltx_text" style="font-size:70%;">(2c)   1 Static prot./ans., L2 similarity</span></span>
</span>
</td>
<td id="S5.T1.1.6.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S5.T1.1.6.2.1" class="ltx_text" style="font-size:70%;">27.80</span></td>
</tr>
<tr id="S5.T1.1.7" class="ltx_tr">
<td id="S5.T1.1.7.1" class="ltx_td ltx_align_justify" style="padding-top:1.25pt;padding-bottom:1.25pt;">
<span id="S5.T1.1.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T1.1.7.1.1.1" class="ltx_p"><span id="S5.T1.1.7.1.1.1.1" class="ltx_text" style="font-size:70%;">(2d)   2 Static prot./ans., dot prod. similarity</span></span>
</span>
</td>
<td id="S5.T1.1.7.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S5.T1.1.7.2.1" class="ltx_text" style="font-size:70%;">30.28</span></td>
</tr>
<tr id="S5.T1.1.8" class="ltx_tr">
<td id="S5.T1.1.8.1" class="ltx_td ltx_align_justify" style="padding-top:1.25pt;padding-bottom:1.25pt;">
<span id="S5.T1.1.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T1.1.8.1.1.1" class="ltx_p"><span id="S5.T1.1.8.1.1.1.1" class="ltx_text" style="font-size:70%;">(2e)   2 Static prot./ans., L1 similarity</span></span>
</span>
</td>
<td id="S5.T1.1.8.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S5.T1.1.8.2.1" class="ltx_text" style="font-size:70%;">28.34</span></td>
</tr>
<tr id="S5.T1.1.9" class="ltx_tr">
<td id="S5.T1.1.9.1" class="ltx_td ltx_align_justify" style="padding-top:1.25pt;padding-bottom:1.25pt;">
<span id="S5.T1.1.9.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T1.1.9.1.1.1" class="ltx_p"><span id="S5.T1.1.9.1.1.1.1" class="ltx_text" style="font-size:70%;">(2f)   2 Static prot./ans., L2 similarity</span></span>
</span>
</td>
<td id="S5.T1.1.9.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S5.T1.1.9.2.1" class="ltx_text" style="font-size:70%;">31.48</span></td>
</tr>
<tr id="S5.T1.1.10" class="ltx_tr">
<td id="S5.T1.1.10.1" class="ltx_td ltx_align_justify" style="padding-top:1.25pt;padding-bottom:1.25pt;">
<span id="S5.T1.1.10.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T1.1.10.1.1.1" class="ltx_p"><span id="S5.T1.1.10.1.1.1.1" class="ltx_text" style="font-size:70%;">(3a)   Dynamic Weights (+2f)</span></span>
</span>
</td>
<td id="S5.T1.1.10.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S5.T1.1.10.2.1" class="ltx_text" style="font-size:70%;">31.81</span></td>
</tr>
<tr id="S5.T1.1.11" class="ltx_tr">
<td id="S5.T1.1.11.1" class="ltx_td ltx_align_justify" style="padding-top:1.25pt;padding-bottom:1.25pt;">
<span id="S5.T1.1.11.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T1.1.11.1.1.1" class="ltx_p"><span id="S5.T1.1.11.1.1.1.1" class="ltx_text" style="font-size:70%;">(3b)   </span><span id="S5.T1.1.11.1.1.1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">Proposed: dynamic weights and prototypes</span><span id="S5.T1.1.11.1.1.1.3" class="ltx_text" style="font-size:70%;"> (+2f)</span></span>
</span>
</td>
<td id="S5.T1.1.11.2" class="ltx_td ltx_align_left" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S5.T1.1.11.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">32.32</span></td>
</tr>
<tr id="S5.T1.1.12" class="ltx_tr">
<td id="S5.T1.1.12.1" class="ltx_td ltx_align_justify" style="padding-top:1.25pt;padding-bottom:1.25pt;">
<span id="S5.T1.1.12.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T1.1.12.1.1.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:0.4pt;background:black;display:inline-block;"> </span></span>
</span>
</td>
<td id="S5.T1.1.12.2" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Ablative evaluation on <em id="S5.T1.3.1" class="ltx_emph ltx_font_italic">VQA-Numbers</em>, trained and evaluated on all answers. See discussion in Section <a href="#S5.SS1.SSS0.Px1" title="Ablative evaluation ‣ 5.1 VQA-Numbers ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>.</figcaption>
</figure>
<div id="S5.SS1.SSS0.Px1.p2" class="ltx_para">
<p id="S5.SS1.SSS0.Px1.p2.1" class="ltx_p">As reported in Table <a href="#S5.T1" title="Table 1 ‣ Ablative evaluation ‣ 5.1 VQA-Numbers ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the proposed dynamic weights improve over the baseline, and the dynamic prototypes bring an additional improvement. We compare different choices for the similarity function. Interestingly, swapping the dot product in the baseline for an L2 distance has a negative impact. When using two static prototypes however, the L2 distances proves superior to the L1 or to the dot product. This is consistent with <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> where a prototypes network also performed best with an L2 distance.</p>
</div>
</section>
<section id="S5.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Additional Support Set and Novel answers</h5>

<div id="S5.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px2.p1.2" class="ltx_p">We now evaluate the ability of the model to exploit support data never seen until test time (see Fig. <a href="#S5.F3" title="Figure 3 ‣ Additional Support Set and Novel answers ‣ 5.1 VQA-Numbers ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). We train the same models designed for 7 candidate answers, but only provide them with training data for a subset of them. The proposed model is additionally provided with a complete support set, covering all 7 answers. Each reported result is averaged over 10 runs. The set of <math id="S5.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="S5.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="S5.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.1.m1.1c">k</annotation></semantics></math> answers excluded from training is randomized across runs but identical to all models for a given <math id="S5.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS1.SSS0.Px2.p1.2.m2.1a"><mi id="S5.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p1.2.m2.1b"><ci id="S5.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS0.Px2.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p1.2.m2.1c">k</annotation></semantics></math>.</p>
</div>
<div id="S5.SS1.SSS0.Px2.p2" class="ltx_para">
<p id="S5.SS1.SSS0.Px2.p2.2" class="ltx_p">The proposed model proves superior than the baseline and all other ablations (Fig. <a href="#S5.F3" title="Figure 3 ‣ Additional Support Set and Novel answers ‣ 5.1 VQA-Numbers ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, top). The dynamic prototypes are particularly beneficial. With very little training data, the use of dynamic weights is less effective and sometimes even detrimental. We hypothesize that the model may then suffer from overfitting due to the additional learned parameters. When evaluated on novel answers (not seen during training and only present in the test-time support set), the dynamic prototypes provide a remarkable ability to learn those from the support set alone (Fig. <a href="#S5.F3" title="Figure 3 ‣ Additional Support Set and Novel answers ‣ 5.1 VQA-Numbers ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, bottom). Their efficacy is particularly strong when only a single novel answer has to be learned. Remarkably, a model trained on only two answers maintains some capacity to learn about all others (average recall of <math id="S5.SS1.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="17.05\%" display="inline"><semantics id="S5.SS1.SSS0.Px2.p2.1.m1.1a"><mrow id="S5.SS1.SSS0.Px2.p2.1.m1.1.1" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.1.cmml"><mn id="S5.SS1.SSS0.Px2.p2.1.m1.1.1.2" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.1.2.cmml">17.05</mn><mo id="S5.SS1.SSS0.Px2.p2.1.m1.1.1.1" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p2.1.m1.1b"><apply id="S5.SS1.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="latexml" id="S5.SS1.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S5.SS1.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.1.m1.1.1.2">17.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p2.1.m1.1c">17.05\%</annotation></semantics></math>, versus the chance baseline of <math id="S5.SS1.SSS0.Px2.p2.2.m2.1" class="ltx_Math" alttext="14.28\%" display="inline"><semantics id="S5.SS1.SSS0.Px2.p2.2.m2.1a"><mrow id="S5.SS1.SSS0.Px2.p2.2.m2.1.1" xref="S5.SS1.SSS0.Px2.p2.2.m2.1.1.cmml"><mn id="S5.SS1.SSS0.Px2.p2.2.m2.1.1.2" xref="S5.SS1.SSS0.Px2.p2.2.m2.1.1.2.cmml">14.28</mn><mo id="S5.SS1.SSS0.Px2.p2.2.m2.1.1.1" xref="S5.SS1.SSS0.Px2.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px2.p2.2.m2.1b"><apply id="S5.SS1.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.2.m2.1.1"><csymbol cd="latexml" id="S5.SS1.SSS0.Px2.p2.2.m2.1.1.1.cmml" xref="S5.SS1.SSS0.Px2.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S5.SS1.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="S5.SS1.SSS0.Px2.p2.2.m2.1.1.2">14.28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px2.p2.2.m2.1c">14.28\%</annotation></semantics></math>). Note that we cannot claim the ability of the model to count to those novel numbers, but at the very least it is able to associate those answers with particular images/questions (possibly utilizing question-conditioned biases).</p>
</div>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/1711.08105/assets/x3.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="415" height="236" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/1711.08105/assets/x4.png" id="S5.F3.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="415" height="250" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Performance of the proposed model and ablations on <em id="S5.F3.2.1" class="ltx_emph ltx_font_italic">VQA-Numbers</em> with training data for a subset of the 7 answers. (Top) Performance on all answers. (Bottom) Performance on answers not seen in training. Only the model with dynamic prototypes makes this setting possible. Remarkably, a model trained on two answers (2/7) maintains a capacity to learn about all others. Chance baseline shown as horizontal dashes.</figcaption>
</figure>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>VQA v2</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We performed experiments on the complete <em id="S5.SS2.p1.1.1" class="ltx_emph ltx_font_italic">VQA v2</em> dataset. We report results of different ablations, trained with 50% or 100% of the official training set, evaluated on the validation set as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. The proposed model uses the remaining of the official training set as additional support data at test time. The complexity and varying quality of this dataset do not lead to clear-cut conclusions from the standard accuracy metric (see Table <a href="#S5.T2" title="Table 2 ‣ 5.2 VQA v2 ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). The answer recall leads to more consistent observations that align with those made on <em id="S5.SS2.p1.1.2" class="ltx_emph ltx_font_italic">VQA-Numbers</em>. Both dynamic weights and dynamic parameters provide a consistent advantage (Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.2 VQA v2 ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). Each technique is beneficial in isolation, but their combination performs generally best. Individually, the dynamic prototypes appear more impactful than the dynamic weights. Note that our experiments on <em id="S5.SS2.p1.1.3" class="ltx_emph ltx_font_italic">VQA v2</em> aimed at quantifying the effect of the contributions in the meta learning setting, and we did not seek to maximize absolute performance in the traditional benchmark setting.</p>
</div>
<figure id="S5.F4" class="ltx_figure"><img src="/html/1711.08105/assets/x5.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="207" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Performance using varying amounts of training data on <em id="S5.F4.2.1" class="ltx_emph ltx_font_italic">VQA v2</em>. See Section <a href="#S5.SS2" title="5.2 VQA v2 ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>.</figcaption>
</figure>
<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T2.1.1" class="ltx_tr">
<td id="S5.T2.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.1.1.1.1.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:0.4pt;background:black;display:inline-block;"> </span></span>
</span>
</td>
<td id="S5.T2.1.1.2" class="ltx_td ltx_nopad_l ltx_align_center" style="padding:1.25pt 0.0pt;" colspan="2"><span id="S5.T2.1.1.2.1" class="ltx_text" style="font-size:70%;">Question accuracy   /  Answer recall</span></td>
</tr>
<tr id="S5.T2.1.2" class="ltx_tr">
<td id="S5.T2.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r" style="padding:1.25pt 0.0pt;"></td>
<td id="S5.T2.1.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:1.25pt 0.0pt;"><span id="S5.T2.1.2.2.1" class="ltx_text" style="font-size:70%;">Trained on 50%</span></td>
<td id="S5.T2.1.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding:1.25pt 0.0pt;"><span id="S5.T2.1.2.3.1" class="ltx_text" style="font-size:70%;">Trained on 100%</span></td>
</tr>
<tr id="S5.T2.1.3" class="ltx_tr">
<td id="S5.T2.1.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.1.3.1.1.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:0.4pt;background:black;display:inline-block;"> </span></span>
</span><span id="S5.T2.1.3.1.2" class="ltx_text" style="font-size:70%;">
Baseline </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.1.3.1.3.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib34" title="" class="ltx_ref">34</a><span id="S5.T2.1.3.1.4.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S5.T2.1.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.3.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">57.6</span><span id="S5.T2.1.3.2.2" class="ltx_text" style="font-size:70%;"> / 14.0</span>
</td>
<td id="S5.T2.1.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="S5.T2.1.3.3.1" class="ltx_text" style="font-size:70%;">59.8 / 15.8</span></td>
</tr>
<tr id="S5.T2.1.4" class="ltx_tr">
<td id="S5.T2.1.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify ltx_border_t" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.1.4.1.1.1" class="ltx_p"><span id="S5.T2.1.4.1.1.1.1" class="ltx_text" style="font-size:70%;">Proposed model</span></span>
</span>
</td>
<td id="S5.T2.1.4.2" class="ltx_td ltx_border_t" style="padding:1.25pt 0.0pt;"></td>
<td id="S5.T2.1.4.3" class="ltx_td ltx_border_t" style="padding:1.25pt 0.0pt;"></td>
</tr>
<tr id="S5.T2.1.5" class="ltx_tr">
<td id="S5.T2.1.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.1.5.1.1.1" class="ltx_p"><span id="S5.T2.1.5.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">With</span><span id="S5.T2.1.5.1.1.1.2" class="ltx_text" style="font-size:70%;"> dynamic weights, no dynamic prototypes</span></span>
</span>
</td>
<td id="S5.T2.1.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.5.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">57.6</span><span id="S5.T2.1.5.2.2" class="ltx_text" style="font-size:70%;"> / 14.1</span>
</td>
<td id="S5.T2.1.5.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.5.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">60.0</span><span id="S5.T2.1.5.3.2" class="ltx_text" style="font-size:70%;"> / 16.3</span>
</td>
</tr>
<tr id="S5.T2.1.6" class="ltx_tr">
<td id="S5.T2.1.6.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.1.6.1.1.1" class="ltx_p"><span id="S5.T2.1.6.1.1.1.1" class="ltx_text" style="font-size:70%;">No dynamic weights, </span><span id="S5.T2.1.6.1.1.1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">with</span><span id="S5.T2.1.6.1.1.1.3" class="ltx_text" style="font-size:70%;"> dynamic prototypes</span></span>
</span>
</td>
<td id="S5.T2.1.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.6.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">57.6</span><span id="S5.T2.1.6.2.2" class="ltx_text" style="font-size:70%;"> / 15.2</span>
</td>
<td id="S5.T2.1.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.6.3.1" class="ltx_text" style="font-size:70%;">59.7 / </span><span id="S5.T2.1.6.3.2" class="ltx_text ltx_font_bold" style="font-size:70%;">18.0</span>
</td>
</tr>
<tr id="S5.T2.1.7" class="ltx_tr">
<td id="S5.T2.1.7.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.1.7.1.1.1" class="ltx_p"><span id="S5.T2.1.7.1.1.1.1" class="ltx_text" style="font-size:70%;">Same, no static prototypes, only dyn. ones</span></span>
</span>
</td>
<td id="S5.T2.1.7.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="S5.T2.1.7.2.1" class="ltx_text" style="font-size:70%;">57.2 /  3.6</span></td>
<td id="S5.T2.1.7.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="S5.T2.1.7.3.1" class="ltx_text" style="font-size:70%;">58.6 /  4.29</span></td>
</tr>
<tr id="S5.T2.1.8" class="ltx_tr">
<td id="S5.T2.1.8.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.1.8.1.1.1" class="ltx_p"><span id="S5.T2.1.8.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:70%;">With</span><span id="S5.T2.1.8.1.1.1.2" class="ltx_text" style="font-size:70%;"> dyn. weights and dyn. prototypes</span></span>
</span>
</td>
<td id="S5.T2.1.8.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.8.2.1" class="ltx_text" style="font-size:70%;">57.5 / </span><span id="S5.T2.1.8.2.2" class="ltx_text ltx_font_bold" style="font-size:70%;">15.5</span>
</td>
<td id="S5.T2.1.8.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.8.3.1" class="ltx_text" style="font-size:70%;">59.9 / </span><span id="S5.T2.1.8.3.2" class="ltx_text ltx_font_bold" style="font-size:70%;">18.0</span>
</td>
</tr>
<tr id="S5.T2.1.9" class="ltx_tr">
<td id="S5.T2.1.9.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_justify" style="padding:1.25pt 0.0pt;">
<span id="S5.T2.1.9.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.1.9.1.1.1" class="ltx_p"><span class="ltx_rule" style="width:100%;height:0.4pt;background:black;display:inline-block;"> </span></span>
</span>
</td>
<td id="S5.T2.1.9.2" class="ltx_td" style="padding:1.25pt 0.0pt;"></td>
<td id="S5.T2.1.9.3" class="ltx_td" style="padding:1.25pt 0.0pt;"></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Evaluation on <em id="S5.T2.3.1" class="ltx_emph ltx_font_italic">VQA v2</em>. The proposed method exhibits qualitatively different strengths than the classical approach of the baseline <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, producing a generally higher recall (averaged over possible answers) and lower accuracy (averaged over questions).</figcaption>
</figure>
<figure id="S5.F5" class="ltx_figure"><img src="/html/1711.08105/assets/x6.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="234" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Difference in answer recall between the proposed model (Table <a href="#S5.T2" title="Table 2 ‣ 5.2 VQA v2 ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, last row, last column) and the baseline (Table <a href="#S5.T2" title="Table 2 ‣ 5.2 VQA v2 ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, first row, last column) on <em id="S5.F5.2.1" class="ltx_emph ltx_font_italic">VQA v2</em>. Each blue bar corresponds to one of the candidate answers, sorted decreasing number of occurrences in the training set (gray background, units not displayed). The two models show qualitatively different behaviour: the baseline is effective with frequent answers, but the proposed model fares better (mostly positive values) in the long tail of rare answers.</figcaption>
</figure>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">To obtain a better insight into the predictions of the model, we examine the individual recall of possible answers. We compare the values with those obtained by the baseline. The difference (Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.2 VQA v2 ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) indicates which of the two models provides the best predictions for every answer. We observe a qualitatively different behaviour between the models. While the baseline is most effective with frequent answers, the proposed model fares better (mostly positive values) in the long tail of rare answers. This corroborates previous discussions on dataset biases <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> which classical models are prone to overfit to. The proposed model is inherently more robust to such behaviour.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions and Future Work</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We have devised a new approach to VQA through framing it as a meta learning task. This approach enables us to provide the model with supervised data at test time, thereby allowing the model to adapt or improve as more data is made available. We believe this view could lead to the development of scalable VQA systems better suited to practical applications. We proposed a deep learning model that takes advantage of the meta learning scenario, and demonstrated a range of benefits: improved recall of rare answers, better sample efficiency, and a unique capability of to learn to produce novel answers, <em id="S6.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S6.p1.1.2" class="ltx_text"></span> those never seen during training, and learned only from support instances.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">The learning-to-learn approach we propose here enables a far greater separation of the questions answering method from the information used in the process than has previously been possible. Our contention is that this separation is essential if vision-and-language methods are to move beyond benchmarks to tackle real problems, because embedding all of the information a method needs to answer real questions in the model weights is impractical.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">Even though the proposed model is able to use novel support data, the experiments showed room for improvement, since a model trained initially from the same amount of data still shows superior performance. Practical considerations should also be addressed to apply this model to a larger scale, in particular for handling the memory of dynamic weights that currently grows linearly with the support set. Clustering schemes could be envisioned to reduce its size <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and hashing methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> could improve the efficiency of the content-based retrieval.</p>
</div>
<div id="S6.p4" class="ltx_para">
<p id="S6.p4.1" class="ltx_p">Generally, the handling of additional data at test time opens the door to VQA systems that interact with other sources of information. While the proposed model was demonstrated with a support set of questions/answers, the principles extend to any type of data obtained at test time <em id="S6.p4.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S6.p4.1.2" class="ltx_text"></span> from knowledge bases or web searches. This would drastically enhance the scalability of VQA systems.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
A. Agrawal, A. Kembhavi, D. Batra, and D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">C-vqa: A compositional split of the visual question answering (vqa)
v1. 0 dataset.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1704.08243</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
R. Aljundi, P. Chakravarty, and T. Tuytelaars.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Expert gate: Lifelong learning with a network of experts.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1611.06194</span><span id="bib.bib2.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
P. Anderson, X. He, C. Buehler, D. Teney, M. Johnson, S. Gould, and L. Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Bottom-up and top-down attention for image captioning and vqa.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1707.07998</span><span id="bib.bib3.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
A. Andoni and P. Indyk.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Near-optimal hashing algorithms for approximate nearest neighbor in
high dimensions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Foundations of Computer Science, 2006. FOCS’06. 47th Annual
IEEE Symposium on</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, pages 459–468. IEEE, 2006.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
M. Andrychowicz, M. Denil, S. Gomez, M. W. Hoffman, D. Pfau, T. Schaul, and
N. de Freitas.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Learning to learn by gradient descent by gradient descent.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, pages
3981–3989, 2016.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
S. Antol, A. Agrawal, J. Lu, M. Mitchell, D. Batra, C. L. Zitnick, and
D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">VQA: Visual Question Answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Int. Conf. Comp. Vis.</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
L. Bertinetto, J. F. Henriques, J. Valmadre, P. H. S. Torr, and A. Vedaldi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Learning feed-forward one-shot learners.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, pages 523–531, 2016.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
C. Buck, J. Bulian, M. Ciaramita, A. Gesmundo, N. Houlsby, W. Gajewski, and
W. Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Ask the right questions: Active question reformulation with
reinforcement learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1705.07830</span><span id="bib.bib8.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
M. Buda, A. Maki, and M. A. Mazurowski.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">A systematic study of the class imbalance problem in convolutional
neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1710.05381</span><span id="bib.bib9.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
K. Cho, B. van Merrienboer, C. Gulcehre, F. Bougares, H. Schwenk, and
Y. Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Learning phrase representations using RNN encoder-decoder for
statistical machine translation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. Conf. Empirical Methods in Natural Language
Processing</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Y. N. Dauphin, A. Fan, M. Auli, and D. Grangier.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Language modeling with gated convolutional networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1612.08083</span><span id="bib.bib11.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
C. Fernando, D. Banarse, C. Blundell, Y. Zwols, D. Ha, A. A. Rusu, A. Pritzel,
and D. Wierstra.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Pathnet: Evolution channels gradient descent in super neural
networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1701.08734</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
C. Finn, P. Abbeel, and S. Levine.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Model-agnostic meta-learning for fast adaptation of deep networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1703.03400</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
X. Glorot and Y. Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Understanding the difficulty of training deep feedforward neural
networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. Int. Conf. Artificial Intell. &amp; Stat.</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, pages
249–256, 2010.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Y. Goyal, T. Khot, D. Summers-Stay, D. Batra, and D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Making the V in VQA matter: Elevating the role of image
understanding in Visual Question Answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1612.00837</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
H. Guo, Y. Li, J. Shang, G. Mingyun, H. Yuanyue, and G. Bing.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Learning from class-imbalanced data: Review of methods and
applications.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Expert Syst. Appl.</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, 73:220–239, 2017.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
S. Hochreiter, A. S. Younger, and P. R. Conwell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Learning to learn using gradient descent.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Artificial Neural Networks</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">,
pages 87–94. Springer, 2001.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
A. Jabri, A. Joulin, and L. van der Maaten.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Revisiting visual question answering baselines.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">2016.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
L. Kaiser, O. Nachum, A. Roy, and S. Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Learning to remember rare events.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CoRR</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
V. Kazemi and A. Elqursh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Show, ask, attend, and answer: A strong baseline for visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1704.03162</span><span id="bib.bib20.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
J. Kirkpatrick, R. Pascanu, N. C. Rabinowitz, J. Veness, G. Desjardins, A. A.
Rusu, K. Milan, J. Quan, T. Ramalho, A. Grabska-Barwinska, D. Hassabis,
C. Clopath, D. Kumaran, and R. Hadsell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Overcoming catastrophic forgetting in neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1612.00796</span><span id="bib.bib21.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
R. Krishna, Y. Zhu, O. Groth, J. Johnson, K. Hata, J. Kravitz, S. Chen,
Y. Kalantidis, L.-J. Li, D. A. Shamma, M. Bernstein, and L. Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1602.07332</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
D. Lopez-Paz and M. Ranzato.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Gradient episodic memory for continuum learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1706.08840</span><span id="bib.bib23.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
T. Munkhdalai and H. Yu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Meta networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning (ICML)</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, pages
2554–2563, 2017.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
K. Narasimhan, A. Yala, and R. Barzilay.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Improving information extraction by acquiring external evidence with
reinforcement learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1603.07954</span><span id="bib.bib25.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
R. Nogueira and K. Cho.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Task-oriented query reformulation with reinforcement learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1704.04572</span><span id="bib.bib26.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
H. Noh, P. H. Seo, and B. Han.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Image Question Answering using Convolutional Neural Network with
Dynamic Parameter Prediction.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
J. Pennington, R. Socher, and C. Manning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Glove: Global Vectors for Word Representation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Conference on Empirical Methods in Natural Language
Processing</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
S. K. Ramakrishnan, A. Pal, G. Sharma, and A. Mittal.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">An empirical evaluation of visual question answering for novel
objects.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1704.02516</span><span id="bib.bib29.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
S. Ravi and H. Larochelle.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Optimization as a model for few-shot learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">2017.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
S. Rebuffi, A. Kolesnikov, and C. H. Lampert.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">icarl: Incremental classifier and representation learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1611.07725</span><span id="bib.bib31.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
J. Schmidhuber.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Learning to control fast-weight memories: An alternative to dynamic
recurrent networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Learning</span><span id="bib.bib32.4.2" class="ltx_text" style="font-size:90%;">, 4(1), 2008.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
J. Snell, K. Swersky, and R. S. Zemel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Prototypical networks for few-shot learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1703.05175</span><span id="bib.bib33.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
D. Teney, P. Anderson, X. He, and A. van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Tips and tricks for visual question answering: Learnings from the
2017 challenge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1708.02711</span><span id="bib.bib34.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
D. Teney and A. van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Zero-shot visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">2016.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
E. Triantafillou, R. Zemel, and R. Urtasun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Few-shot learning through an information retrieval lens.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1707.02610</span><span id="bib.bib36.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
P. Wang, Q. Wu, C. Shen, and A. van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">The VQA-Machine: Learning how to use existing vision algorithms to
answer new questions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1612.05386</span><span id="bib.bib37.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
P. Wang, Q. Wu, C. Shen, A. van den Hengel, and A. Dick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Explicit knowledge-based reasoning for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1511.02570</span><span id="bib.bib38.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Q. Wu, D. Teney, P. Wang, C. Shen, A. Dick, and A. van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Visual question answering: A survey of methods and datasets.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision and Image Understanding</span><span id="bib.bib39.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Q. Wu, P. Wang, C. Shen, A. Dick, and A. v. d. Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Ask Me Anything: Free-form Visual Question Answering Based on
Knowledge from External Sources.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib40.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib40.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Z. Yang, X. He, J. Gao, L. Deng, and A. Smola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Stacked Attention Networks for Image Question Answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib41.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib41.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
J. Yoon, E. Yang, J. Lee, and S. ju Hwang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Lifelong learning with dynamically expandable networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1708.01547</span><span id="bib.bib42.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
P. Zhang, Y. Goyal, D. Summers-Stay, D. Batra, and D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Yin and yang: Balancing and answering binary visual questions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib43.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib43.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Y. Zhu, O. Groth, M. Bernstein, and L. Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Visual7W: Grounded Question Answering in Images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib44.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib44.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="Ax1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">Supplementary material</h2>

</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Factorized Non-Linear Transformation</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.2" class="ltx_p">We defined in Eq. <a href="#S4.E1" title="In 4.1 Non-linear Transformation 𝑓_𝜽⁢(⋅) ‣ 4 Proposed Model ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> our non-linear transformations using weights (static or dynamic) <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}" display="inline"><semantics id="A1.p1.1.m1.1a"><mi id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">{\boldsymbol{\theta}}</annotation></semantics></math> containing all the parameters of a gated tanh layer. Although this is sound in principle, it is computationally costly to handle a memory containing dynamic weights of such a large dimensionality (<math id="A1.p1.2.m2.1" class="ltx_Math" alttext="2D^{2}+2D" display="inline"><semantics id="A1.p1.2.m2.1a"><mrow id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml"><mrow id="A1.p1.2.m2.1.1.2" xref="A1.p1.2.m2.1.1.2.cmml"><mn id="A1.p1.2.m2.1.1.2.2" xref="A1.p1.2.m2.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A1.p1.2.m2.1.1.2.1" xref="A1.p1.2.m2.1.1.2.1.cmml">​</mo><msup id="A1.p1.2.m2.1.1.2.3" xref="A1.p1.2.m2.1.1.2.3.cmml"><mi id="A1.p1.2.m2.1.1.2.3.2" xref="A1.p1.2.m2.1.1.2.3.2.cmml">D</mi><mn id="A1.p1.2.m2.1.1.2.3.3" xref="A1.p1.2.m2.1.1.2.3.3.cmml">2</mn></msup></mrow><mo id="A1.p1.2.m2.1.1.1" xref="A1.p1.2.m2.1.1.1.cmml">+</mo><mrow id="A1.p1.2.m2.1.1.3" xref="A1.p1.2.m2.1.1.3.cmml"><mn id="A1.p1.2.m2.1.1.3.2" xref="A1.p1.2.m2.1.1.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A1.p1.2.m2.1.1.3.1" xref="A1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="A1.p1.2.m2.1.1.3.3" xref="A1.p1.2.m2.1.1.3.3.cmml">D</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><apply id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1"><plus id="A1.p1.2.m2.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1"></plus><apply id="A1.p1.2.m2.1.1.2.cmml" xref="A1.p1.2.m2.1.1.2"><times id="A1.p1.2.m2.1.1.2.1.cmml" xref="A1.p1.2.m2.1.1.2.1"></times><cn type="integer" id="A1.p1.2.m2.1.1.2.2.cmml" xref="A1.p1.2.m2.1.1.2.2">2</cn><apply id="A1.p1.2.m2.1.1.2.3.cmml" xref="A1.p1.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.2.3.1.cmml" xref="A1.p1.2.m2.1.1.2.3">superscript</csymbol><ci id="A1.p1.2.m2.1.1.2.3.2.cmml" xref="A1.p1.2.m2.1.1.2.3.2">𝐷</ci><cn type="integer" id="A1.p1.2.m2.1.1.2.3.3.cmml" xref="A1.p1.2.m2.1.1.2.3.3">2</cn></apply></apply><apply id="A1.p1.2.m2.1.1.3.cmml" xref="A1.p1.2.m2.1.1.3"><times id="A1.p1.2.m2.1.1.3.1.cmml" xref="A1.p1.2.m2.1.1.3.1"></times><cn type="integer" id="A1.p1.2.m2.1.1.3.2.cmml" xref="A1.p1.2.m2.1.1.3.2">2</cn><ci id="A1.p1.2.m2.1.1.3.3.cmml" xref="A1.p1.2.m2.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">2D^{2}+2D</annotation></semantics></math>). To alleviate this, we follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and factorize the parameters of the gated tanh layer, rewriting Eq. <a href="#S4.E1" title="In 4.1 Non-linear Transformation 𝑓_𝜽⁢(⋅) ‣ 4 Proposed Model ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> as follows:
</p>
<table id="A4.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E7.m1.4" class="ltx_Math" alttext="\displaystyle f_{\boldsymbol{\theta}}({\boldsymbol{h}})~{}~{}=~{}~{}\sigma({\boldsymbol{w}}_{a}W_{b}{\boldsymbol{h}}+\boldsymbol{b})~{}\circ~{}\tanh\,({\boldsymbol{w}}^{\prime}_{a}W_{b}^{\prime}{\boldsymbol{h}}+\boldsymbol{b}^{\prime})" display="inline"><semantics id="A1.E7.m1.4a"><mrow id="A1.E7.m1.4.4" xref="A1.E7.m1.4.4.cmml"><mrow id="A1.E7.m1.4.4.4" xref="A1.E7.m1.4.4.4.cmml"><msub id="A1.E7.m1.4.4.4.2" xref="A1.E7.m1.4.4.4.2.cmml"><mi id="A1.E7.m1.4.4.4.2.2" xref="A1.E7.m1.4.4.4.2.2.cmml">f</mi><mi id="A1.E7.m1.4.4.4.2.3" xref="A1.E7.m1.4.4.4.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="A1.E7.m1.4.4.4.1" xref="A1.E7.m1.4.4.4.1.cmml">​</mo><mrow id="A1.E7.m1.4.4.4.3.2" xref="A1.E7.m1.4.4.4.cmml"><mo stretchy="false" id="A1.E7.m1.4.4.4.3.2.1" xref="A1.E7.m1.4.4.4.cmml">(</mo><mi id="A1.E7.m1.1.1" xref="A1.E7.m1.1.1.cmml">𝒉</mi><mo rspace="0.660em" stretchy="false" id="A1.E7.m1.4.4.4.3.2.2" xref="A1.E7.m1.4.4.4.cmml">)</mo></mrow></mrow><mo rspace="0.938em" id="A1.E7.m1.4.4.3" xref="A1.E7.m1.4.4.3.cmml">=</mo><mrow id="A1.E7.m1.4.4.2" xref="A1.E7.m1.4.4.2.cmml"><mrow id="A1.E7.m1.3.3.1.1" xref="A1.E7.m1.3.3.1.1.cmml"><mi id="A1.E7.m1.3.3.1.1.3" xref="A1.E7.m1.3.3.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="A1.E7.m1.3.3.1.1.2" xref="A1.E7.m1.3.3.1.1.2.cmml">​</mo><mrow id="A1.E7.m1.3.3.1.1.1.1" xref="A1.E7.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.E7.m1.3.3.1.1.1.1.2" xref="A1.E7.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A1.E7.m1.3.3.1.1.1.1.1" xref="A1.E7.m1.3.3.1.1.1.1.1.cmml"><mrow id="A1.E7.m1.3.3.1.1.1.1.1.2" xref="A1.E7.m1.3.3.1.1.1.1.1.2.cmml"><msub id="A1.E7.m1.3.3.1.1.1.1.1.2.2" xref="A1.E7.m1.3.3.1.1.1.1.1.2.2.cmml"><mi id="A1.E7.m1.3.3.1.1.1.1.1.2.2.2" xref="A1.E7.m1.3.3.1.1.1.1.1.2.2.2.cmml">𝒘</mi><mi id="A1.E7.m1.3.3.1.1.1.1.1.2.2.3" xref="A1.E7.m1.3.3.1.1.1.1.1.2.2.3.cmml">a</mi></msub><mo lspace="0em" rspace="0em" id="A1.E7.m1.3.3.1.1.1.1.1.2.1" xref="A1.E7.m1.3.3.1.1.1.1.1.2.1.cmml">​</mo><msub id="A1.E7.m1.3.3.1.1.1.1.1.2.3" xref="A1.E7.m1.3.3.1.1.1.1.1.2.3.cmml"><mi id="A1.E7.m1.3.3.1.1.1.1.1.2.3.2" xref="A1.E7.m1.3.3.1.1.1.1.1.2.3.2.cmml">W</mi><mi id="A1.E7.m1.3.3.1.1.1.1.1.2.3.3" xref="A1.E7.m1.3.3.1.1.1.1.1.2.3.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="A1.E7.m1.3.3.1.1.1.1.1.2.1a" xref="A1.E7.m1.3.3.1.1.1.1.1.2.1.cmml">​</mo><mi id="A1.E7.m1.3.3.1.1.1.1.1.2.4" xref="A1.E7.m1.3.3.1.1.1.1.1.2.4.cmml">𝒉</mi></mrow><mo id="A1.E7.m1.3.3.1.1.1.1.1.1" xref="A1.E7.m1.3.3.1.1.1.1.1.1.cmml">+</mo><mi id="A1.E7.m1.3.3.1.1.1.1.1.3" xref="A1.E7.m1.3.3.1.1.1.1.1.3.cmml">𝒃</mi></mrow><mo rspace="0.385em" stretchy="false" id="A1.E7.m1.3.3.1.1.1.1.3" xref="A1.E7.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.552em" id="A1.E7.m1.4.4.2.3" xref="A1.E7.m1.4.4.2.3.cmml">∘</mo><mrow id="A1.E7.m1.4.4.2.2.1" xref="A1.E7.m1.4.4.2.2.2.cmml"><mi id="A1.E7.m1.2.2" xref="A1.E7.m1.2.2.cmml">tanh</mi><mo lspace="0.170em" id="A1.E7.m1.4.4.2.2.1a" xref="A1.E7.m1.4.4.2.2.2.cmml">⁡</mo><mrow id="A1.E7.m1.4.4.2.2.1.1" xref="A1.E7.m1.4.4.2.2.2.cmml"><mo stretchy="false" id="A1.E7.m1.4.4.2.2.1.1.2" xref="A1.E7.m1.4.4.2.2.2.cmml">(</mo><mrow id="A1.E7.m1.4.4.2.2.1.1.1" xref="A1.E7.m1.4.4.2.2.1.1.1.cmml"><mrow id="A1.E7.m1.4.4.2.2.1.1.1.2" xref="A1.E7.m1.4.4.2.2.1.1.1.2.cmml"><msubsup id="A1.E7.m1.4.4.2.2.1.1.1.2.2" xref="A1.E7.m1.4.4.2.2.1.1.1.2.2.cmml"><mi id="A1.E7.m1.4.4.2.2.1.1.1.2.2.2.2" xref="A1.E7.m1.4.4.2.2.1.1.1.2.2.2.2.cmml">𝒘</mi><mi id="A1.E7.m1.4.4.2.2.1.1.1.2.2.3" xref="A1.E7.m1.4.4.2.2.1.1.1.2.2.3.cmml">a</mi><mo id="A1.E7.m1.4.4.2.2.1.1.1.2.2.2.3" xref="A1.E7.m1.4.4.2.2.1.1.1.2.2.2.3.cmml">′</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.E7.m1.4.4.2.2.1.1.1.2.1" xref="A1.E7.m1.4.4.2.2.1.1.1.2.1.cmml">​</mo><msubsup id="A1.E7.m1.4.4.2.2.1.1.1.2.3" xref="A1.E7.m1.4.4.2.2.1.1.1.2.3.cmml"><mi id="A1.E7.m1.4.4.2.2.1.1.1.2.3.2.2" xref="A1.E7.m1.4.4.2.2.1.1.1.2.3.2.2.cmml">W</mi><mi id="A1.E7.m1.4.4.2.2.1.1.1.2.3.2.3" xref="A1.E7.m1.4.4.2.2.1.1.1.2.3.2.3.cmml">b</mi><mo id="A1.E7.m1.4.4.2.2.1.1.1.2.3.3" xref="A1.E7.m1.4.4.2.2.1.1.1.2.3.3.cmml">′</mo></msubsup><mo lspace="0em" rspace="0em" id="A1.E7.m1.4.4.2.2.1.1.1.2.1a" xref="A1.E7.m1.4.4.2.2.1.1.1.2.1.cmml">​</mo><mi id="A1.E7.m1.4.4.2.2.1.1.1.2.4" xref="A1.E7.m1.4.4.2.2.1.1.1.2.4.cmml">𝒉</mi></mrow><mo id="A1.E7.m1.4.4.2.2.1.1.1.1" xref="A1.E7.m1.4.4.2.2.1.1.1.1.cmml">+</mo><msup id="A1.E7.m1.4.4.2.2.1.1.1.3" xref="A1.E7.m1.4.4.2.2.1.1.1.3.cmml"><mi id="A1.E7.m1.4.4.2.2.1.1.1.3.2" xref="A1.E7.m1.4.4.2.2.1.1.1.3.2.cmml">𝒃</mi><mo id="A1.E7.m1.4.4.2.2.1.1.1.3.3" xref="A1.E7.m1.4.4.2.2.1.1.1.3.3.cmml">′</mo></msup></mrow><mo stretchy="false" id="A1.E7.m1.4.4.2.2.1.1.3" xref="A1.E7.m1.4.4.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E7.m1.4b"><apply id="A1.E7.m1.4.4.cmml" xref="A1.E7.m1.4.4"><eq id="A1.E7.m1.4.4.3.cmml" xref="A1.E7.m1.4.4.3"></eq><apply id="A1.E7.m1.4.4.4.cmml" xref="A1.E7.m1.4.4.4"><times id="A1.E7.m1.4.4.4.1.cmml" xref="A1.E7.m1.4.4.4.1"></times><apply id="A1.E7.m1.4.4.4.2.cmml" xref="A1.E7.m1.4.4.4.2"><csymbol cd="ambiguous" id="A1.E7.m1.4.4.4.2.1.cmml" xref="A1.E7.m1.4.4.4.2">subscript</csymbol><ci id="A1.E7.m1.4.4.4.2.2.cmml" xref="A1.E7.m1.4.4.4.2.2">𝑓</ci><ci id="A1.E7.m1.4.4.4.2.3.cmml" xref="A1.E7.m1.4.4.4.2.3">𝜽</ci></apply><ci id="A1.E7.m1.1.1.cmml" xref="A1.E7.m1.1.1">𝒉</ci></apply><apply id="A1.E7.m1.4.4.2.cmml" xref="A1.E7.m1.4.4.2"><compose id="A1.E7.m1.4.4.2.3.cmml" xref="A1.E7.m1.4.4.2.3"></compose><apply id="A1.E7.m1.3.3.1.1.cmml" xref="A1.E7.m1.3.3.1.1"><times id="A1.E7.m1.3.3.1.1.2.cmml" xref="A1.E7.m1.3.3.1.1.2"></times><ci id="A1.E7.m1.3.3.1.1.3.cmml" xref="A1.E7.m1.3.3.1.1.3">𝜎</ci><apply id="A1.E7.m1.3.3.1.1.1.1.1.cmml" xref="A1.E7.m1.3.3.1.1.1.1"><plus id="A1.E7.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.1"></plus><apply id="A1.E7.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.2"><times id="A1.E7.m1.3.3.1.1.1.1.1.2.1.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.2.1"></times><apply id="A1.E7.m1.3.3.1.1.1.1.1.2.2.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.E7.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.2.2.2">𝒘</ci><ci id="A1.E7.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.2.2.3">𝑎</ci></apply><apply id="A1.E7.m1.3.3.1.1.1.1.1.2.3.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E7.m1.3.3.1.1.1.1.1.2.3.1.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.2.3">subscript</csymbol><ci id="A1.E7.m1.3.3.1.1.1.1.1.2.3.2.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.2.3.2">𝑊</ci><ci id="A1.E7.m1.3.3.1.1.1.1.1.2.3.3.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.2.3.3">𝑏</ci></apply><ci id="A1.E7.m1.3.3.1.1.1.1.1.2.4.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.2.4">𝒉</ci></apply><ci id="A1.E7.m1.3.3.1.1.1.1.1.3.cmml" xref="A1.E7.m1.3.3.1.1.1.1.1.3">𝒃</ci></apply></apply><apply id="A1.E7.m1.4.4.2.2.2.cmml" xref="A1.E7.m1.4.4.2.2.1"><tanh id="A1.E7.m1.2.2.cmml" xref="A1.E7.m1.2.2"></tanh><apply id="A1.E7.m1.4.4.2.2.1.1.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1"><plus id="A1.E7.m1.4.4.2.2.1.1.1.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.1"></plus><apply id="A1.E7.m1.4.4.2.2.1.1.1.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2"><times id="A1.E7.m1.4.4.2.2.1.1.1.2.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.1"></times><apply id="A1.E7.m1.4.4.2.2.1.1.1.2.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.4.4.2.2.1.1.1.2.2.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.2">subscript</csymbol><apply id="A1.E7.m1.4.4.2.2.1.1.1.2.2.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.E7.m1.4.4.2.2.1.1.1.2.2.2.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.2">superscript</csymbol><ci id="A1.E7.m1.4.4.2.2.1.1.1.2.2.2.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.2.2.2">𝒘</ci><ci id="A1.E7.m1.4.4.2.2.1.1.1.2.2.2.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.2.2.3">′</ci></apply><ci id="A1.E7.m1.4.4.2.2.1.1.1.2.2.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.2.3">𝑎</ci></apply><apply id="A1.E7.m1.4.4.2.2.1.1.1.2.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E7.m1.4.4.2.2.1.1.1.2.3.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.3">superscript</csymbol><apply id="A1.E7.m1.4.4.2.2.1.1.1.2.3.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.E7.m1.4.4.2.2.1.1.1.2.3.2.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.3">subscript</csymbol><ci id="A1.E7.m1.4.4.2.2.1.1.1.2.3.2.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.3.2.2">𝑊</ci><ci id="A1.E7.m1.4.4.2.2.1.1.1.2.3.2.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.3.2.3">𝑏</ci></apply><ci id="A1.E7.m1.4.4.2.2.1.1.1.2.3.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.3.3">′</ci></apply><ci id="A1.E7.m1.4.4.2.2.1.1.1.2.4.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.2.4">𝒉</ci></apply><apply id="A1.E7.m1.4.4.2.2.1.1.1.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A1.E7.m1.4.4.2.2.1.1.1.3.1.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.3">superscript</csymbol><ci id="A1.E7.m1.4.4.2.2.1.1.1.3.2.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.3.2">𝒃</ci><ci id="A1.E7.m1.4.4.2.2.1.1.1.3.3.cmml" xref="A1.E7.m1.4.4.2.2.1.1.1.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E7.m1.4c">\displaystyle f_{\boldsymbol{\theta}}({\boldsymbol{h}})~{}~{}=~{}~{}\sigma({\boldsymbol{w}}_{a}W_{b}{\boldsymbol{h}}+\boldsymbol{b})~{}\circ~{}\tanh\,({\boldsymbol{w}}^{\prime}_{a}W_{b}^{\prime}{\boldsymbol{h}}+\boldsymbol{b}^{\prime})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="A1.p1.16" class="ltx_p">with vectors <math id="A1.p1.3.m1.2" class="ltx_Math" alttext="{\boldsymbol{w}}_{a},{\boldsymbol{w}}^{\prime}_{a}\in\mathbb{R}^{D}" display="inline"><semantics id="A1.p1.3.m1.2a"><mrow id="A1.p1.3.m1.2.2" xref="A1.p1.3.m1.2.2.cmml"><mrow id="A1.p1.3.m1.2.2.2.2" xref="A1.p1.3.m1.2.2.2.3.cmml"><msub id="A1.p1.3.m1.1.1.1.1.1" xref="A1.p1.3.m1.1.1.1.1.1.cmml"><mi id="A1.p1.3.m1.1.1.1.1.1.2" xref="A1.p1.3.m1.1.1.1.1.1.2.cmml">𝒘</mi><mi id="A1.p1.3.m1.1.1.1.1.1.3" xref="A1.p1.3.m1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="A1.p1.3.m1.2.2.2.2.3" xref="A1.p1.3.m1.2.2.2.3.cmml">,</mo><msubsup id="A1.p1.3.m1.2.2.2.2.2" xref="A1.p1.3.m1.2.2.2.2.2.cmml"><mi id="A1.p1.3.m1.2.2.2.2.2.2.2" xref="A1.p1.3.m1.2.2.2.2.2.2.2.cmml">𝒘</mi><mi id="A1.p1.3.m1.2.2.2.2.2.3" xref="A1.p1.3.m1.2.2.2.2.2.3.cmml">a</mi><mo id="A1.p1.3.m1.2.2.2.2.2.2.3" xref="A1.p1.3.m1.2.2.2.2.2.2.3.cmml">′</mo></msubsup></mrow><mo id="A1.p1.3.m1.2.2.3" xref="A1.p1.3.m1.2.2.3.cmml">∈</mo><msup id="A1.p1.3.m1.2.2.4" xref="A1.p1.3.m1.2.2.4.cmml"><mi id="A1.p1.3.m1.2.2.4.2" xref="A1.p1.3.m1.2.2.4.2.cmml">ℝ</mi><mi id="A1.p1.3.m1.2.2.4.3" xref="A1.p1.3.m1.2.2.4.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.3.m1.2b"><apply id="A1.p1.3.m1.2.2.cmml" xref="A1.p1.3.m1.2.2"><in id="A1.p1.3.m1.2.2.3.cmml" xref="A1.p1.3.m1.2.2.3"></in><list id="A1.p1.3.m1.2.2.2.3.cmml" xref="A1.p1.3.m1.2.2.2.2"><apply id="A1.p1.3.m1.1.1.1.1.1.cmml" xref="A1.p1.3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.3.m1.1.1.1.1.1.1.cmml" xref="A1.p1.3.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.p1.3.m1.1.1.1.1.1.2.cmml" xref="A1.p1.3.m1.1.1.1.1.1.2">𝒘</ci><ci id="A1.p1.3.m1.1.1.1.1.1.3.cmml" xref="A1.p1.3.m1.1.1.1.1.1.3">𝑎</ci></apply><apply id="A1.p1.3.m1.2.2.2.2.2.cmml" xref="A1.p1.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.p1.3.m1.2.2.2.2.2.1.cmml" xref="A1.p1.3.m1.2.2.2.2.2">subscript</csymbol><apply id="A1.p1.3.m1.2.2.2.2.2.2.cmml" xref="A1.p1.3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.p1.3.m1.2.2.2.2.2.2.1.cmml" xref="A1.p1.3.m1.2.2.2.2.2">superscript</csymbol><ci id="A1.p1.3.m1.2.2.2.2.2.2.2.cmml" xref="A1.p1.3.m1.2.2.2.2.2.2.2">𝒘</ci><ci id="A1.p1.3.m1.2.2.2.2.2.2.3.cmml" xref="A1.p1.3.m1.2.2.2.2.2.2.3">′</ci></apply><ci id="A1.p1.3.m1.2.2.2.2.2.3.cmml" xref="A1.p1.3.m1.2.2.2.2.2.3">𝑎</ci></apply></list><apply id="A1.p1.3.m1.2.2.4.cmml" xref="A1.p1.3.m1.2.2.4"><csymbol cd="ambiguous" id="A1.p1.3.m1.2.2.4.1.cmml" xref="A1.p1.3.m1.2.2.4">superscript</csymbol><ci id="A1.p1.3.m1.2.2.4.2.cmml" xref="A1.p1.3.m1.2.2.4.2">ℝ</ci><ci id="A1.p1.3.m1.2.2.4.3.cmml" xref="A1.p1.3.m1.2.2.4.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m1.2c">{\boldsymbol{w}}_{a},{\boldsymbol{w}}^{\prime}_{a}\in\mathbb{R}^{D}</annotation></semantics></math> and matrices <math id="A1.p1.4.m2.2" class="ltx_Math" alttext="W_{b},W^{\prime}_{b}\in\mathbb{R}^{D\times D}" display="inline"><semantics id="A1.p1.4.m2.2a"><mrow id="A1.p1.4.m2.2.2" xref="A1.p1.4.m2.2.2.cmml"><mrow id="A1.p1.4.m2.2.2.2.2" xref="A1.p1.4.m2.2.2.2.3.cmml"><msub id="A1.p1.4.m2.1.1.1.1.1" xref="A1.p1.4.m2.1.1.1.1.1.cmml"><mi id="A1.p1.4.m2.1.1.1.1.1.2" xref="A1.p1.4.m2.1.1.1.1.1.2.cmml">W</mi><mi id="A1.p1.4.m2.1.1.1.1.1.3" xref="A1.p1.4.m2.1.1.1.1.1.3.cmml">b</mi></msub><mo id="A1.p1.4.m2.2.2.2.2.3" xref="A1.p1.4.m2.2.2.2.3.cmml">,</mo><msubsup id="A1.p1.4.m2.2.2.2.2.2" xref="A1.p1.4.m2.2.2.2.2.2.cmml"><mi id="A1.p1.4.m2.2.2.2.2.2.2.2" xref="A1.p1.4.m2.2.2.2.2.2.2.2.cmml">W</mi><mi id="A1.p1.4.m2.2.2.2.2.2.3" xref="A1.p1.4.m2.2.2.2.2.2.3.cmml">b</mi><mo id="A1.p1.4.m2.2.2.2.2.2.2.3" xref="A1.p1.4.m2.2.2.2.2.2.2.3.cmml">′</mo></msubsup></mrow><mo id="A1.p1.4.m2.2.2.3" xref="A1.p1.4.m2.2.2.3.cmml">∈</mo><msup id="A1.p1.4.m2.2.2.4" xref="A1.p1.4.m2.2.2.4.cmml"><mi id="A1.p1.4.m2.2.2.4.2" xref="A1.p1.4.m2.2.2.4.2.cmml">ℝ</mi><mrow id="A1.p1.4.m2.2.2.4.3" xref="A1.p1.4.m2.2.2.4.3.cmml"><mi id="A1.p1.4.m2.2.2.4.3.2" xref="A1.p1.4.m2.2.2.4.3.2.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="A1.p1.4.m2.2.2.4.3.1" xref="A1.p1.4.m2.2.2.4.3.1.cmml">×</mo><mi id="A1.p1.4.m2.2.2.4.3.3" xref="A1.p1.4.m2.2.2.4.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.4.m2.2b"><apply id="A1.p1.4.m2.2.2.cmml" xref="A1.p1.4.m2.2.2"><in id="A1.p1.4.m2.2.2.3.cmml" xref="A1.p1.4.m2.2.2.3"></in><list id="A1.p1.4.m2.2.2.2.3.cmml" xref="A1.p1.4.m2.2.2.2.2"><apply id="A1.p1.4.m2.1.1.1.1.1.cmml" xref="A1.p1.4.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.4.m2.1.1.1.1.1.1.cmml" xref="A1.p1.4.m2.1.1.1.1.1">subscript</csymbol><ci id="A1.p1.4.m2.1.1.1.1.1.2.cmml" xref="A1.p1.4.m2.1.1.1.1.1.2">𝑊</ci><ci id="A1.p1.4.m2.1.1.1.1.1.3.cmml" xref="A1.p1.4.m2.1.1.1.1.1.3">𝑏</ci></apply><apply id="A1.p1.4.m2.2.2.2.2.2.cmml" xref="A1.p1.4.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.p1.4.m2.2.2.2.2.2.1.cmml" xref="A1.p1.4.m2.2.2.2.2.2">subscript</csymbol><apply id="A1.p1.4.m2.2.2.2.2.2.2.cmml" xref="A1.p1.4.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.p1.4.m2.2.2.2.2.2.2.1.cmml" xref="A1.p1.4.m2.2.2.2.2.2">superscript</csymbol><ci id="A1.p1.4.m2.2.2.2.2.2.2.2.cmml" xref="A1.p1.4.m2.2.2.2.2.2.2.2">𝑊</ci><ci id="A1.p1.4.m2.2.2.2.2.2.2.3.cmml" xref="A1.p1.4.m2.2.2.2.2.2.2.3">′</ci></apply><ci id="A1.p1.4.m2.2.2.2.2.2.3.cmml" xref="A1.p1.4.m2.2.2.2.2.2.3">𝑏</ci></apply></list><apply id="A1.p1.4.m2.2.2.4.cmml" xref="A1.p1.4.m2.2.2.4"><csymbol cd="ambiguous" id="A1.p1.4.m2.2.2.4.1.cmml" xref="A1.p1.4.m2.2.2.4">superscript</csymbol><ci id="A1.p1.4.m2.2.2.4.2.cmml" xref="A1.p1.4.m2.2.2.4.2">ℝ</ci><apply id="A1.p1.4.m2.2.2.4.3.cmml" xref="A1.p1.4.m2.2.2.4.3"><times id="A1.p1.4.m2.2.2.4.3.1.cmml" xref="A1.p1.4.m2.2.2.4.3.1"></times><ci id="A1.p1.4.m2.2.2.4.3.2.cmml" xref="A1.p1.4.m2.2.2.4.3.2">𝐷</ci><ci id="A1.p1.4.m2.2.2.4.3.3.cmml" xref="A1.p1.4.m2.2.2.4.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m2.2c">W_{b},W^{\prime}_{b}\in\mathbb{R}^{D\times D}</annotation></semantics></math>. The matrices <math id="A1.p1.5.m3.1" class="ltx_Math" alttext="W_{b}" display="inline"><semantics id="A1.p1.5.m3.1a"><msub id="A1.p1.5.m3.1.1" xref="A1.p1.5.m3.1.1.cmml"><mi id="A1.p1.5.m3.1.1.2" xref="A1.p1.5.m3.1.1.2.cmml">W</mi><mi id="A1.p1.5.m3.1.1.3" xref="A1.p1.5.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.5.m3.1b"><apply id="A1.p1.5.m3.1.1.cmml" xref="A1.p1.5.m3.1.1"><csymbol cd="ambiguous" id="A1.p1.5.m3.1.1.1.cmml" xref="A1.p1.5.m3.1.1">subscript</csymbol><ci id="A1.p1.5.m3.1.1.2.cmml" xref="A1.p1.5.m3.1.1.2">𝑊</ci><ci id="A1.p1.5.m3.1.1.3.cmml" xref="A1.p1.5.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m3.1c">W_{b}</annotation></semantics></math> and <math id="A1.p1.6.m4.1" class="ltx_Math" alttext="W^{\prime}_{b}" display="inline"><semantics id="A1.p1.6.m4.1a"><msubsup id="A1.p1.6.m4.1.1" xref="A1.p1.6.m4.1.1.cmml"><mi id="A1.p1.6.m4.1.1.2.2" xref="A1.p1.6.m4.1.1.2.2.cmml">W</mi><mi id="A1.p1.6.m4.1.1.3" xref="A1.p1.6.m4.1.1.3.cmml">b</mi><mo id="A1.p1.6.m4.1.1.2.3" xref="A1.p1.6.m4.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A1.p1.6.m4.1b"><apply id="A1.p1.6.m4.1.1.cmml" xref="A1.p1.6.m4.1.1"><csymbol cd="ambiguous" id="A1.p1.6.m4.1.1.1.cmml" xref="A1.p1.6.m4.1.1">subscript</csymbol><apply id="A1.p1.6.m4.1.1.2.cmml" xref="A1.p1.6.m4.1.1"><csymbol cd="ambiguous" id="A1.p1.6.m4.1.1.2.1.cmml" xref="A1.p1.6.m4.1.1">superscript</csymbol><ci id="A1.p1.6.m4.1.1.2.2.cmml" xref="A1.p1.6.m4.1.1.2.2">𝑊</ci><ci id="A1.p1.6.m4.1.1.2.3.cmml" xref="A1.p1.6.m4.1.1.2.3">′</ci></apply><ci id="A1.p1.6.m4.1.1.3.cmml" xref="A1.p1.6.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m4.1c">W^{\prime}_{b}</annotation></semantics></math> are learned like traditional weights, and only <math id="A1.p1.7.m5.1" class="ltx_Math" alttext="{\boldsymbol{w}}_{a}" display="inline"><semantics id="A1.p1.7.m5.1a"><msub id="A1.p1.7.m5.1.1" xref="A1.p1.7.m5.1.1.cmml"><mi id="A1.p1.7.m5.1.1.2" xref="A1.p1.7.m5.1.1.2.cmml">𝒘</mi><mi id="A1.p1.7.m5.1.1.3" xref="A1.p1.7.m5.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.7.m5.1b"><apply id="A1.p1.7.m5.1.1.cmml" xref="A1.p1.7.m5.1.1"><csymbol cd="ambiguous" id="A1.p1.7.m5.1.1.1.cmml" xref="A1.p1.7.m5.1.1">subscript</csymbol><ci id="A1.p1.7.m5.1.1.2.cmml" xref="A1.p1.7.m5.1.1.2">𝒘</ci><ci id="A1.p1.7.m5.1.1.3.cmml" xref="A1.p1.7.m5.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.7.m5.1c">{\boldsymbol{w}}_{a}</annotation></semantics></math> and <math id="A1.p1.8.m6.1" class="ltx_Math" alttext="{\boldsymbol{w}}^{\prime}_{a}" display="inline"><semantics id="A1.p1.8.m6.1a"><msubsup id="A1.p1.8.m6.1.1" xref="A1.p1.8.m6.1.1.cmml"><mi id="A1.p1.8.m6.1.1.2.2" xref="A1.p1.8.m6.1.1.2.2.cmml">𝒘</mi><mi id="A1.p1.8.m6.1.1.3" xref="A1.p1.8.m6.1.1.3.cmml">a</mi><mo id="A1.p1.8.m6.1.1.2.3" xref="A1.p1.8.m6.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A1.p1.8.m6.1b"><apply id="A1.p1.8.m6.1.1.cmml" xref="A1.p1.8.m6.1.1"><csymbol cd="ambiguous" id="A1.p1.8.m6.1.1.1.cmml" xref="A1.p1.8.m6.1.1">subscript</csymbol><apply id="A1.p1.8.m6.1.1.2.cmml" xref="A1.p1.8.m6.1.1"><csymbol cd="ambiguous" id="A1.p1.8.m6.1.1.2.1.cmml" xref="A1.p1.8.m6.1.1">superscript</csymbol><ci id="A1.p1.8.m6.1.1.2.2.cmml" xref="A1.p1.8.m6.1.1.2.2">𝒘</ci><ci id="A1.p1.8.m6.1.1.2.3.cmml" xref="A1.p1.8.m6.1.1.2.3">′</ci></apply><ci id="A1.p1.8.m6.1.1.3.cmml" xref="A1.p1.8.m6.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.8.m6.1c">{\boldsymbol{w}}^{\prime}_{a}</annotation></semantics></math> are those incorporated into the vector of weights <math id="A1.p1.9.m7.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}" display="inline"><semantics id="A1.p1.9.m7.1a"><mi id="A1.p1.9.m7.1.1" xref="A1.p1.9.m7.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="A1.p1.9.m7.1b"><ci id="A1.p1.9.m7.1.1.cmml" xref="A1.p1.9.m7.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.9.m7.1c">{\boldsymbol{\theta}}</annotation></semantics></math> (static or dynamic). This reduces the dimensionality of <math id="A1.p1.10.m8.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}" display="inline"><semantics id="A1.p1.10.m8.1a"><mi id="A1.p1.10.m8.1.1" xref="A1.p1.10.m8.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="A1.p1.10.m8.1b"><ci id="A1.p1.10.m8.1.1.cmml" xref="A1.p1.10.m8.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.10.m8.1c">{\boldsymbol{\theta}}</annotation></semantics></math> from <math id="A1.p1.11.m9.1" class="ltx_Math" alttext="(2D^{2}+2D)" display="inline"><semantics id="A1.p1.11.m9.1a"><mrow id="A1.p1.11.m9.1.1.1" xref="A1.p1.11.m9.1.1.1.1.cmml"><mo stretchy="false" id="A1.p1.11.m9.1.1.1.2" xref="A1.p1.11.m9.1.1.1.1.cmml">(</mo><mrow id="A1.p1.11.m9.1.1.1.1" xref="A1.p1.11.m9.1.1.1.1.cmml"><mrow id="A1.p1.11.m9.1.1.1.1.2" xref="A1.p1.11.m9.1.1.1.1.2.cmml"><mn id="A1.p1.11.m9.1.1.1.1.2.2" xref="A1.p1.11.m9.1.1.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A1.p1.11.m9.1.1.1.1.2.1" xref="A1.p1.11.m9.1.1.1.1.2.1.cmml">​</mo><msup id="A1.p1.11.m9.1.1.1.1.2.3" xref="A1.p1.11.m9.1.1.1.1.2.3.cmml"><mi id="A1.p1.11.m9.1.1.1.1.2.3.2" xref="A1.p1.11.m9.1.1.1.1.2.3.2.cmml">D</mi><mn id="A1.p1.11.m9.1.1.1.1.2.3.3" xref="A1.p1.11.m9.1.1.1.1.2.3.3.cmml">2</mn></msup></mrow><mo id="A1.p1.11.m9.1.1.1.1.1" xref="A1.p1.11.m9.1.1.1.1.1.cmml">+</mo><mrow id="A1.p1.11.m9.1.1.1.1.3" xref="A1.p1.11.m9.1.1.1.1.3.cmml"><mn id="A1.p1.11.m9.1.1.1.1.3.2" xref="A1.p1.11.m9.1.1.1.1.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A1.p1.11.m9.1.1.1.1.3.1" xref="A1.p1.11.m9.1.1.1.1.3.1.cmml">​</mo><mi id="A1.p1.11.m9.1.1.1.1.3.3" xref="A1.p1.11.m9.1.1.1.1.3.3.cmml">D</mi></mrow></mrow><mo stretchy="false" id="A1.p1.11.m9.1.1.1.3" xref="A1.p1.11.m9.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.11.m9.1b"><apply id="A1.p1.11.m9.1.1.1.1.cmml" xref="A1.p1.11.m9.1.1.1"><plus id="A1.p1.11.m9.1.1.1.1.1.cmml" xref="A1.p1.11.m9.1.1.1.1.1"></plus><apply id="A1.p1.11.m9.1.1.1.1.2.cmml" xref="A1.p1.11.m9.1.1.1.1.2"><times id="A1.p1.11.m9.1.1.1.1.2.1.cmml" xref="A1.p1.11.m9.1.1.1.1.2.1"></times><cn type="integer" id="A1.p1.11.m9.1.1.1.1.2.2.cmml" xref="A1.p1.11.m9.1.1.1.1.2.2">2</cn><apply id="A1.p1.11.m9.1.1.1.1.2.3.cmml" xref="A1.p1.11.m9.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A1.p1.11.m9.1.1.1.1.2.3.1.cmml" xref="A1.p1.11.m9.1.1.1.1.2.3">superscript</csymbol><ci id="A1.p1.11.m9.1.1.1.1.2.3.2.cmml" xref="A1.p1.11.m9.1.1.1.1.2.3.2">𝐷</ci><cn type="integer" id="A1.p1.11.m9.1.1.1.1.2.3.3.cmml" xref="A1.p1.11.m9.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="A1.p1.11.m9.1.1.1.1.3.cmml" xref="A1.p1.11.m9.1.1.1.1.3"><times id="A1.p1.11.m9.1.1.1.1.3.1.cmml" xref="A1.p1.11.m9.1.1.1.1.3.1"></times><cn type="integer" id="A1.p1.11.m9.1.1.1.1.3.2.cmml" xref="A1.p1.11.m9.1.1.1.1.3.2">2</cn><ci id="A1.p1.11.m9.1.1.1.1.3.3.cmml" xref="A1.p1.11.m9.1.1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.11.m9.1c">(2D^{2}+2D)</annotation></semantics></math> to <math id="A1.p1.12.m10.1" class="ltx_Math" alttext="4D" display="inline"><semantics id="A1.p1.12.m10.1a"><mrow id="A1.p1.12.m10.1.1" xref="A1.p1.12.m10.1.1.cmml"><mn id="A1.p1.12.m10.1.1.2" xref="A1.p1.12.m10.1.1.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="A1.p1.12.m10.1.1.1" xref="A1.p1.12.m10.1.1.1.cmml">​</mo><mi id="A1.p1.12.m10.1.1.3" xref="A1.p1.12.m10.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.12.m10.1b"><apply id="A1.p1.12.m10.1.1.cmml" xref="A1.p1.12.m10.1.1"><times id="A1.p1.12.m10.1.1.1.cmml" xref="A1.p1.12.m10.1.1.1"></times><cn type="integer" id="A1.p1.12.m10.1.1.2.cmml" xref="A1.p1.12.m10.1.1.2">4</cn><ci id="A1.p1.12.m10.1.1.3.cmml" xref="A1.p1.12.m10.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.12.m10.1c">4D</annotation></semantics></math> (accounting for <math id="A1.p1.13.m11.1" class="ltx_Math" alttext="{\boldsymbol{w}}_{a}" display="inline"><semantics id="A1.p1.13.m11.1a"><msub id="A1.p1.13.m11.1.1" xref="A1.p1.13.m11.1.1.cmml"><mi id="A1.p1.13.m11.1.1.2" xref="A1.p1.13.m11.1.1.2.cmml">𝒘</mi><mi id="A1.p1.13.m11.1.1.3" xref="A1.p1.13.m11.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.13.m11.1b"><apply id="A1.p1.13.m11.1.1.cmml" xref="A1.p1.13.m11.1.1"><csymbol cd="ambiguous" id="A1.p1.13.m11.1.1.1.cmml" xref="A1.p1.13.m11.1.1">subscript</csymbol><ci id="A1.p1.13.m11.1.1.2.cmml" xref="A1.p1.13.m11.1.1.2">𝒘</ci><ci id="A1.p1.13.m11.1.1.3.cmml" xref="A1.p1.13.m11.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.13.m11.1c">{\boldsymbol{w}}_{a}</annotation></semantics></math>, <math id="A1.p1.14.m12.1" class="ltx_Math" alttext="{\boldsymbol{w}}_{b}" display="inline"><semantics id="A1.p1.14.m12.1a"><msub id="A1.p1.14.m12.1.1" xref="A1.p1.14.m12.1.1.cmml"><mi id="A1.p1.14.m12.1.1.2" xref="A1.p1.14.m12.1.1.2.cmml">𝒘</mi><mi id="A1.p1.14.m12.1.1.3" xref="A1.p1.14.m12.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.14.m12.1b"><apply id="A1.p1.14.m12.1.1.cmml" xref="A1.p1.14.m12.1.1"><csymbol cd="ambiguous" id="A1.p1.14.m12.1.1.1.cmml" xref="A1.p1.14.m12.1.1">subscript</csymbol><ci id="A1.p1.14.m12.1.1.2.cmml" xref="A1.p1.14.m12.1.1.2">𝒘</ci><ci id="A1.p1.14.m12.1.1.3.cmml" xref="A1.p1.14.m12.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.14.m12.1c">{\boldsymbol{w}}_{b}</annotation></semantics></math>, <math id="A1.p1.15.m13.1" class="ltx_Math" alttext="\boldsymbol{b}" display="inline"><semantics id="A1.p1.15.m13.1a"><mi id="A1.p1.15.m13.1.1" xref="A1.p1.15.m13.1.1.cmml">𝒃</mi><annotation-xml encoding="MathML-Content" id="A1.p1.15.m13.1b"><ci id="A1.p1.15.m13.1.1.cmml" xref="A1.p1.15.m13.1.1">𝒃</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.15.m13.1c">\boldsymbol{b}</annotation></semantics></math>, and <math id="A1.p1.16.m14.1" class="ltx_Math" alttext="\boldsymbol{b}^{\prime}" display="inline"><semantics id="A1.p1.16.m14.1a"><msup id="A1.p1.16.m14.1.1" xref="A1.p1.16.m14.1.1.cmml"><mi id="A1.p1.16.m14.1.1.2" xref="A1.p1.16.m14.1.1.2.cmml">𝒃</mi><mo id="A1.p1.16.m14.1.1.3" xref="A1.p1.16.m14.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A1.p1.16.m14.1b"><apply id="A1.p1.16.m14.1.1.cmml" xref="A1.p1.16.m14.1.1"><csymbol cd="ambiguous" id="A1.p1.16.m14.1.1.1.cmml" xref="A1.p1.16.m14.1.1">superscript</csymbol><ci id="A1.p1.16.m14.1.1.2.cmml" xref="A1.p1.16.m14.1.1.2">𝒃</ci><ci id="A1.p1.16.m14.1.1.3.cmml" xref="A1.p1.16.m14.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.16.m14.1c">\boldsymbol{b}^{\prime}</annotation></semantics></math>).</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Bias in the Output Mapping</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">In Eq. <a href="#S4.E3" title="In 4.1.1 Mapping to Candidate Answers 𝑔_𝛷⁢(⋅) ‣ 4.1 Non-linear Transformation 𝑓_𝜽⁢(⋅) ‣ 4 Proposed Model ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the output mapping to answer scores uses a <em id="A2.p1.1.1" class="ltx_emph ltx_font_italic">scalar</em> bias term. This is different to the vector bias in a classical model that use a linear (affine) layer to implement <math id="A2.p1.1.m1.1" class="ltx_Math" alttext="g_{\mathit{\Phi}}(\cdot)" display="inline"><semantics id="A2.p1.1.m1.1a"><mrow id="A2.p1.1.m1.1.2" xref="A2.p1.1.m1.1.2.cmml"><msub id="A2.p1.1.m1.1.2.2" xref="A2.p1.1.m1.1.2.2.cmml"><mi id="A2.p1.1.m1.1.2.2.2" xref="A2.p1.1.m1.1.2.2.2.cmml">g</mi><mi id="A2.p1.1.m1.1.2.2.3" xref="A2.p1.1.m1.1.2.2.3.cmml">Φ</mi></msub><mo lspace="0em" rspace="0em" id="A2.p1.1.m1.1.2.1" xref="A2.p1.1.m1.1.2.1.cmml">​</mo><mrow id="A2.p1.1.m1.1.2.3.2" xref="A2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="A2.p1.1.m1.1.2.3.2.1" xref="A2.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="A2.p1.1.m1.1.2.3.2.2" xref="A2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><apply id="A2.p1.1.m1.1.2.cmml" xref="A2.p1.1.m1.1.2"><times id="A2.p1.1.m1.1.2.1.cmml" xref="A2.p1.1.m1.1.2.1"></times><apply id="A2.p1.1.m1.1.2.2.cmml" xref="A2.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="A2.p1.1.m1.1.2.2.1.cmml" xref="A2.p1.1.m1.1.2.2">subscript</csymbol><ci id="A2.p1.1.m1.1.2.2.2.cmml" xref="A2.p1.1.m1.1.2.2.2">𝑔</ci><ci id="A2.p1.1.m1.1.2.2.3.cmml" xref="A2.p1.1.m1.1.2.2.3">𝛷</ci></apply><ci id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">g_{\mathit{\Phi}}(\cdot)</annotation></semantics></math>. A vector contains a value for each output class (<em id="A2.p1.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="A2.p1.1.3" class="ltx_text"></span> each candidate answer), whereas our formulation uses a single value shared among all of them. Our formulation helps avoid the model incorporating biases towards frequent training answers, as discussed in Section <a href="#S1" title="1 Introduction ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S2" title="2 Related Work ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. This feature is essential to enable the capability of our model to produce novel answers (unseen during training) only demonstrated by instances in the support set. A vector of answer-specific biases would prevent this capability, as the bias for the novel answers can not be learned from training data.</p>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p">Completely removing the bias term is another option. At test time, it is without effect compared to a scalar bias, since it is only followed by a (monotonic) sigmoid. Removing the bias term however renders the training by gradient descent numerically unstable, because the chosen similarity function can map to saturating regions of the domain of the sigmoid.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>VQA-Numbers Dataset</h2>

<div id="A3.p1" class="ltx_para ltx_noindent">
<p id="A3.p1.1" class="ltx_p">We provide below statistics of the <em id="A3.p1.1.1" class="ltx_emph ltx_font_italic">VQA-Numbers</em> dataset.</p>
</div>
<figure id="A3.T3" class="ltx_table">
<table id="A3.T3.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="A3.T3.1.1" class="ltx_tr">
<td id="A3.T3.1.1.1" class="ltx_td ltx_nopad_l ltx_align_center" style="padding:1.25pt 0.0pt;" colspan="7">
<span class="ltx_rule" style="width:100%;height:0.4pt;background:black;display:inline-block;"> </span><span id="A3.T3.1.1.1.1" class="ltx_text" style="font-size:70%;">  Correct answer</span>
</td>
<td id="A3.T3.1.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.1.2.1" class="ltx_text" style="font-size:70%;">Row</span></td>
</tr>
<tr id="A3.T3.1.2" class="ltx_tr">
<td id="A3.T3.1.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.2.1.1" class="ltx_text" style="font-size:70%;">0</span></td>
<td id="A3.T3.1.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.2.2.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="A3.T3.1.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.2.3.1" class="ltx_text" style="font-size:70%;">2</span></td>
<td id="A3.T3.1.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.2.4.1" class="ltx_text" style="font-size:70%;">3</span></td>
<td id="A3.T3.1.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.2.5.1" class="ltx_text" style="font-size:70%;">4</span></td>
<td id="A3.T3.1.2.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.2.6.1" class="ltx_text" style="font-size:70%;">5</span></td>
<td id="A3.T3.1.2.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.2.7.1" class="ltx_text" style="font-size:70%;">6</span></td>
<td id="A3.T3.1.2.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.2.8.1" class="ltx_text" style="font-size:70%;">sum</span></td>
</tr>
<tr id="A3.T3.1.3" class="ltx_tr">
<td id="A3.T3.1.3.1" class="ltx_td ltx_nopad_l ltx_align_center" style="padding:1.25pt 0.0pt;" colspan="7">
<span class="ltx_rule" style="width:100%;height:0.4pt;background:black;display:inline-block;"> </span><span id="A3.T3.1.3.1.1" class="ltx_text" style="font-size:70%;"> Training/validation/support set</span>
</td>
<td id="A3.T3.1.3.2" class="ltx_td" style="padding:1.25pt 0.0pt;"></td>
</tr>
<tr id="A3.T3.1.4" class="ltx_tr">
<td id="A3.T3.1.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.4.1.1" class="ltx_text" style="font-size:70%;">2,529</span></td>
<td id="A3.T3.1.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.4.2.1" class="ltx_text" style="font-size:70%;">8,193</span></td>
<td id="A3.T3.1.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.4.3.1" class="ltx_text" style="font-size:70%;">7,030</span></td>
<td id="A3.T3.1.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.4.4.1" class="ltx_text" style="font-size:70%;">2,485</span></td>
<td id="A3.T3.1.4.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.4.5.1" class="ltx_text" style="font-size:70%;">1,520</span></td>
<td id="A3.T3.1.4.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.4.6.1" class="ltx_text" style="font-size:70%;">579</span></td>
<td id="A3.T3.1.4.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.4.7.1" class="ltx_text" style="font-size:70%;">602</span></td>
<td id="A3.T3.1.4.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.4.8.1" class="ltx_text" style="font-size:70%;">22,938</span></td>
</tr>
<tr id="A3.T3.1.5" class="ltx_tr">
<td id="A3.T3.1.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.5.1.1" class="ltx_text" style="font-size:70%;">11.0%</span></td>
<td id="A3.T3.1.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.5.2.1" class="ltx_text" style="font-size:70%;">35.7%</span></td>
<td id="A3.T3.1.5.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.5.3.1" class="ltx_text" style="font-size:70%;">30.7%</span></td>
<td id="A3.T3.1.5.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.5.4.1" class="ltx_text" style="font-size:70%;">10.8%</span></td>
<td id="A3.T3.1.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.5.5.1" class="ltx_text" style="font-size:70%;">6.6%</span></td>
<td id="A3.T3.1.5.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.5.6.1" class="ltx_text" style="font-size:70%;">2.6%</span></td>
<td id="A3.T3.1.5.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.5.7.1" class="ltx_text" style="font-size:70%;">2.6%</span></td>
<td id="A3.T3.1.5.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.5.8.1" class="ltx_text" style="font-size:70%;">100%</span></td>
</tr>
<tr id="A3.T3.1.6" class="ltx_tr">
<td id="A3.T3.1.6.1" class="ltx_td ltx_nopad_l ltx_align_center" style="padding:1.25pt 0.0pt;" colspan="7">
<span class="ltx_rule" style="width:100%;height:0.4pt;background:black;display:inline-block;"> </span><span id="A3.T3.1.6.1.1" class="ltx_text" style="font-size:70%;"> Test set</span>
</td>
<td id="A3.T3.1.6.2" class="ltx_td" style="padding:1.25pt 0.0pt;"></td>
</tr>
<tr id="A3.T3.1.7" class="ltx_tr">
<td id="A3.T3.1.7.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.7.1.1" class="ltx_text" style="font-size:70%;">858</span></td>
<td id="A3.T3.1.7.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.7.2.1" class="ltx_text" style="font-size:70%;">2,804</span></td>
<td id="A3.T3.1.7.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.7.3.1" class="ltx_text" style="font-size:70%;">2,434</span></td>
<td id="A3.T3.1.7.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.7.4.1" class="ltx_text" style="font-size:70%;">843</span></td>
<td id="A3.T3.1.7.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.7.5.1" class="ltx_text" style="font-size:70%;">495</span></td>
<td id="A3.T3.1.7.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.7.6.1" class="ltx_text" style="font-size:70%;">173</span></td>
<td id="A3.T3.1.7.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.7.7.1" class="ltx_text" style="font-size:70%;">205</span></td>
<td id="A3.T3.1.7.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.7.8.1" class="ltx_text" style="font-size:70%;">7,812</span></td>
</tr>
<tr id="A3.T3.1.8" class="ltx_tr">
<td id="A3.T3.1.8.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.8.1.1" class="ltx_text" style="font-size:70%;">11.0%</span></td>
<td id="A3.T3.1.8.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.8.2.1" class="ltx_text" style="font-size:70%;">35.9%</span></td>
<td id="A3.T3.1.8.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.8.3.1" class="ltx_text" style="font-size:70%;">31.2%</span></td>
<td id="A3.T3.1.8.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.8.4.1" class="ltx_text" style="font-size:70%;">10.8%</span></td>
<td id="A3.T3.1.8.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.8.5.1" class="ltx_text" style="font-size:70%;">6.3%</span></td>
<td id="A3.T3.1.8.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.8.6.1" class="ltx_text" style="font-size:70%;">2.2%</span></td>
<td id="A3.T3.1.8.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.8.7.1" class="ltx_text" style="font-size:70%;">2.6%</span></td>
<td id="A3.T3.1.8.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span id="A3.T3.1.8.8.1" class="ltx_text" style="font-size:70%;">100%</span></td>
</tr>
<tr id="A3.T3.1.9" class="ltx_tr">
<td id="A3.T3.1.9.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding:1.25pt 0.0pt;"><span class="ltx_rule" style="width:100%;height:0.4pt;background:black;display:inline-block;"> </span></td>
<td id="A3.T3.1.9.2" class="ltx_td" style="padding:1.25pt 0.0pt;"></td>
<td id="A3.T3.1.9.3" class="ltx_td" style="padding:1.25pt 0.0pt;"></td>
<td id="A3.T3.1.9.4" class="ltx_td" style="padding:1.25pt 0.0pt;"></td>
<td id="A3.T3.1.9.5" class="ltx_td" style="padding:1.25pt 0.0pt;"></td>
<td id="A3.T3.1.9.6" class="ltx_td" style="padding:1.25pt 0.0pt;"></td>
<td id="A3.T3.1.9.7" class="ltx_td" style="padding:1.25pt 0.0pt;"></td>
<td id="A3.T3.1.9.8" class="ltx_td" style="padding:1.25pt 0.0pt;"></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Number and ratio of questions per type of correct answer in the <em id="A3.T3.3.1" class="ltx_emph ltx_font_italic">VQA-Numbers</em> dataset.</figcaption>
</figure>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>VQA-Numbers Experiments</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p">Our experiments on <em id="A4.p1.1.1" class="ltx_emph ltx_font_italic">VQA-Numbers</em> (Section <a href="#S5.SS1" title="5.1 VQA-Numbers ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>) use supersampling during training to ensure that none of the compared models can be influenced by dataset biases (<em id="A4.p1.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="A4.p1.1.3" class="ltx_text"></span> class imbalance). The supersampling is performed at the epoch level, not at the mini-batch level. Concretely, the training instances of all answers (classes) except the most frequent one are repeated at random such that there are as many of them as instances with the most frequent one. The elements within a mini-batch are selected at random. Each training epoch will thus go through every training instance at least once. We did not try to constrain the sampling within mini-batches.</p>
</div>
<div id="A4.p2" class="ltx_para">
<p id="A4.p2.1" class="ltx_p">Note finally that the supersampling strategy is practical on VQA-Numbers thanks to the small number of classes and only mild imbalance. It would not be suitable to <em id="A4.p2.1.1" class="ltx_emph ltx_font_italic">VQA v2</em> for the opposite reasons.</p>
</div>
<figure id="A4.F6" class="ltx_figure"><img src="/html/1711.08105/assets/x7.png" id="A4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="414" height="236" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Additional results of the experiments of Fig. <a href="#S5.F3" title="Figure 3 ‣ Additional Support Set and Novel answers ‣ 5.1 VQA-Numbers ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Performance is reported here only on answers seen in the training set. See text for discussion.</figcaption>
</figure>
<div id="A4.p3" class="ltx_para">
<p id="A4.p3.1" class="ltx_p">We provide in Fig.  <a href="#A4.F6" title="Figure 6 ‣ Appendix D VQA-Numbers Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> additional results of the experiments of Section <a href="#S5.SS1" title="5.1 VQA-Numbers ‣ 5 Experiments ‣ Visual Question Answering as a Meta Learning Task" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>. We report the performance of the same models, now evaluated only on answers present in the training set. The number of those answers is varied from 1 to 7. The chance performance (gray dashes) diminishes as the number of possible answers gets larger. As expected, the baseline model performs at 100% recall in the trivial case of 1 possible answer. The proposed model however receives a support set containing examples of all other answers (<em id="A4.p3.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="A4.p3.1.2" class="ltx_text"></span> all 7 of them). This explains the non-perfect result in the trivial case. As the number of possible answers is increased, the proposed models (with dynamic weights and dynamic prototypes) shows a growing advantage and finally surpass the baseline by a clear margin on the most interesting cases of 5, 6, and 7 answers.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1711.08104" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1711.08105" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1711.08105">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1711.08105" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1711.08106" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  8 00:06:02 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
