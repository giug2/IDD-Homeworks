<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles</title>
<!--Generated on Sun Oct  6 19:36:56 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.17630v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S1" title="In System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S2" title="In System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Related Works</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S3" title="In System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Problem Setup</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S4" title="In System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">Background: RH Planner</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5" title="In System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">System-Level Safety Monitoring and Recovery</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.SS1" title="In V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-A</span> </span><span class="ltx_text ltx_font_italic">Safety Score</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.SS2" title="In V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-B</span> </span><span class="ltx_text ltx_font_italic">Scene Encoding</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.SS3" title="In V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-C</span> </span><span class="ltx_text ltx_font_italic">Dataset</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.SS4" title="In V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-D</span> </span><span class="ltx_text ltx_font_italic">Training</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.SS5" title="In V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-E</span> </span><span class="ltx_text ltx_font_italic">Recovery Planning</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6" title="In System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VI </span><span class="ltx_text ltx_font_smallcaps">Experimental Results and Discussion</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.SS1" title="In VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-A</span> </span><span class="ltx_text ltx_font_italic">Test Datasets and Scenarios</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.SS2" title="In VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-B</span> </span><span class="ltx_text ltx_font_italic">Baseline: Hamilton Jacobi Reachability</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.SS3" title="In VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-C</span> </span><span class="ltx_text ltx_font_italic">Quantitative Performance</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.SS4" title="In VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-D</span> </span><span class="ltx_text ltx_font_italic">Qualitative Performance</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S7" title="In System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VII </span><span class="ltx_text ltx_font_smallcaps">Conclusion and Future Work</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kaustav Chakraborty<sup class="ltx_sup" id="id10.10.id1"><span class="ltx_text ltx_font_italic" id="id10.10.id1.1">∗1</span></sup>, Zeyuan Feng<sup class="ltx_sup" id="id11.11.id2"><span class="ltx_text ltx_font_italic" id="id11.11.id2.1">∗1</span></sup>, Sushant Veer<sup class="ltx_sup" id="id12.12.id3"><span class="ltx_text ltx_font_italic" id="id12.12.id3.1">2</span></sup>, Apoorva Sharma<sup class="ltx_sup" id="id13.13.id4"><span class="ltx_text ltx_font_italic" id="id13.13.id4.1">2</span></sup>,
<br class="ltx_break"/>Boris Ivanovic<sup class="ltx_sup" id="id14.14.id5"><span class="ltx_text ltx_font_italic" id="id14.14.id5.1">2</span></sup>, Marco Pavone<sup class="ltx_sup" id="id15.15.id6"><span class="ltx_text ltx_font_italic" id="id15.15.id6.1">2</span></sup>, Somil Bansal<sup class="ltx_sup" id="id16.16.id7"><span class="ltx_text ltx_font_italic" id="id16.16.id7.1">1</span></sup>
</span><span class="ltx_author_notes">*equal contribution. Corresponding author: kaustavc@usc.edu.<sup class="ltx_sup" id="id17.17.id1"><span class="ltx_text ltx_font_italic" id="id17.17.id1.1">1</span></sup>Authors are with Department of Electrical and Computer Engineering, University of Southern California, Los Angeles, USA.<sup class="ltx_sup" id="id18.18.id1"><span class="ltx_text ltx_font_italic" id="id18.18.id1.1">2</span></sup>Authors are with NVIDIA Research
 This work is supported in part by the DARPA Assured NeuroSymbolic Learning and Reasoning (ANSR) program and by the NSF CAREER program (2240163).</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id19.id1">The safety-critical nature of autonomous vehicle (AV) operation necessitates development of task-relevant algorithms that can reason about safety at the system level and not just at the component level. To reason about the impact of a perception failure on the entire system performance, such task-relevant algorithms must contend with various challenges: complexity of AV stacks, high uncertainty in the operating environments, and the need for real-time performance. To overcome these challenges, in this work, we introduce a Q-network called SPARQ (abbreviation for <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.1">S</span>afety evaluation for <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.2">P</span>erception <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.3">A</span>nd <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.4">R</span>ecovery <span class="ltx_text ltx_framed ltx_framed_underline" id="id19.id1.5">Q</span>-network) that evaluates the safety of a plan generated by a planning algorithm, accounting for perception failures that the planning process may have overlooked. This Q-network can be queried during system runtime to assess whether a proposed plan is safe for execution or poses potential safety risks. If a violation is detected, the network can then recommend a corrective plan while accounting for the perceptual failure. We validate our algorithm using the NuPlan-Vegas dataset, demonstrating its ability to handle cases where a perception failure compromises a proposed plan while the corrective plan remains safe. We observe an overall accuracy and recall of <span class="ltx_text ltx_font_bold" id="id19.id1.6">90%</span> while sustaining a frequency of <span class="ltx_text ltx_font_bold" id="id19.id1.7">42Hz</span> on the unseen testing dataset. We compare our performance to a popular reachability-based baseline and analyze some interesting properties of our approach in improving the safety properties of an AV pipeline. 
<br class="ltx_break"/>Website: <a class="ltx_ref ltx_url ltx_font_typewriter" href="vatsuak.github.io/sparq" style="font-size:80%;" title="">vatsuak.github.io/sparq</a></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Safety of autonomous vehicles (AVs) heavily relies on the correctness of perception systems. This has spurred a plethora of work in developing monitors aimed at detecting perception failures <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib4" title="">4</a>]</cite>. However, triggering a fail-safe maneuver for every detected perception error is impractical and detrimental to the AV’s navigation goals. Not all perception failures are equal; some bear no impact on the AV’s safety (e.g., missed parked vehicle far off from the AV’s motion plan), while others can be catastrophic (e.g., missed pedestrian along the AV’s motion plan); the latter are referred to as task-relevant (or system-level) perception failures <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib5" title="">5</a>]</cite>. Identifying task-relevant perception failures and reacting to them poses significant challenges: First, the AV operates in highly uncertain environments, making it difficult to assess the system-level impact of perception failures. Second, these monitors must assess the system-level impact of complex AV stacks at run-time, ideally at a much higher frequency than the AV stack. Finally, even if the perception failure is detected, there might not be enough time to replan a safe motion accounting for the perception errors. In this work, we address these challenges by developing a Q-network-based monitor called SPARQ (abbreviation for <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p1.1.1">S</span>afety evaluation for <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p1.1.2">P</span>erception <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p1.1.3">A</span>nd <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p1.1.4">R</span>ecovery <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p1.1.5">Q</span>-network) that, in real-time, detects task-relevant perception failures and generates corrective recovery plans.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="442" id="S1.F1.g1" src="extracted/5904926/figures/cover_image.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.3.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.4.2" style="font-size:90%;">
We propose SPARQ, a run-time system-level safety monitor to detect and mitigate task-relevant perception failures.
Here, the perception suite failed to detect the red car. This resulted in AV (the green car) planning an unsafe trajectory (blue line). SPARQ flags the planned trajectory as unsafe and suggests a corrective safe plan (cyan line) that accounts for the perception failure.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">We envision a task-relevant perception monitoring and recovery pipeline that has four main blocks: a component-level <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">perception monitor</em> that identifies the failure mode that is occurring, a <em class="ltx_emph ltx_font_italic" id="S1.p2.1.2">plausible scene generator</em> which produces plausible scenes accounting for the perception failure, a <em class="ltx_emph ltx_font_italic" id="S1.p2.1.3">safety monitor</em> which quantifies how risky it is to execute a given motion plan in the plausible scenes while accounting for the uncertain future predictions of other agents, and finally, a <em class="ltx_emph ltx_font_italic" id="S1.p2.1.4">recovery planner</em> which generates a recovery maneuver in the event of a task-relevant perception failure (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S1.F2" title="Figure 2 ‣ I Introduction ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">2</span></a> for the block diagram). Unfortunately, perception monitors have very stringent compute requirements and need to run at frequencies much higher than that of the AV stack, which makes it infeasible to run such an intricate monitoring pipeline online – indeed, the slow speed of the modular monitoring pipeline was something we observed in our previous work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib5" title="">5</a>]</cite> as well. SPARQ resolves this problem by learning a neural approximation of the last three blocks, providing run-time capabilities for our task-relevant perception monitoring and recovery pipeline. SPARQ leverages a lightweight transformer-based encoder-decoder architecture and is trained via supervised learning. To generate the training data, we construct the plausible scene generator, safety monitor, and recovery planner and run them offline. In our experiments, we observe that SPARQ is able to provide low false-positive and false-negative detection rates of <span class="ltx_text ltx_font_bold" id="S1.p2.1.5">8.1%</span> and <span class="ltx_text ltx_font_bold" id="S1.p2.1.6">8.5%</span>, respectively, while being able to execute at a frequency of <span class="ltx_text ltx_font_bold" id="S1.p2.1.7">42</span> Hz.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1"><span class="ltx_text ltx_font_bold" id="S1.p3.1.1">Statement of Contributions.</span> Our main contributions are: (i) We develop SPARQ, a Q-function-based run-time capable system-level safety monitor that detects task-relevant perception failures and <em class="ltx_emph ltx_font_italic" id="S1.p3.1.2">simultaneously</em> plans recovery motions for them. (ii) In the absence of perception failures, we show that SPARQ acts as a general-purpose safety monitor for motion plans, i.e., it detects if a plan is unsafe to execute. (iii) Finally, we demonstrate the ability of SPARQ to assess the system-level impact of perception failures and generate recovery plans on nuPlan <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib6" title="">6</a>]</cite>, a real-world driving dataset.</p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="111" id="S1.F2.g1" src="extracted/5904926/figures/SPARQ-block-diagram.png" width="533"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F2.4.2.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S1.F2.2.1" style="font-size:90%;">Block diagram for task-relevant perception failure detection and recovery monitor. SPARQ learns a Q-network-based neural approximator for the last three blocks in this pipeline enabling it to operate at run-time at a frequency of <math alttext="\sim" class="ltx_Math" display="inline" id="S1.F2.2.1.m1.1"><semantics id="S1.F2.2.1.m1.1b"><mo id="S1.F2.2.1.m1.1.1" xref="S1.F2.2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S1.F2.2.1.m1.1c"><csymbol cd="latexml" id="S1.F2.2.1.m1.1.1.cmml" xref="S1.F2.2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.2.1.m1.1d">\sim</annotation><annotation encoding="application/x-llamapun" id="S1.F2.2.1.m1.1e">∼</annotation></semantics></math>42 Hz.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Related Works</span>
</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Safety for AVs.</span> Due to the safety-critical nature of AV operation, a lot of research has focused on ensuring the system-level safety of AVs. These approaches can broadly be classified under two overarching notions: safety under worst-case and probabilistic notions of safety. Approaches within the former category often take the form of control invariant sets within the state space; some notable examples include Hamilton Jacobi (HJ)-reachability <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib7" title="">7</a>]</cite>, control-barrier functions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib8" title="">8</a>]</cite>, collision-free forward reachable sets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib9" title="">9</a>]</cite>, and control contraction metrics <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib10" title="">10</a>]</cite>. Approaches within the latter category use probabilistic notions of safety such as estimating collision probability using trajectory prediction <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib11" title="">11</a>]</cite>, conditional value at risk (CVaR) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib12" title="">12</a>]</cite>, and conformal prediction <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib13" title="">13</a>]</cite>. Various metrics have also been used for assessing safety, many of which can be found in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib14" title="">14</a>]</cite>. Unlike this paper, the above methods assess system-level safety under the assumption of perfect perception.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Safety Under Perception Failures.</span> There has been a significant amount of work on monitoring perception systems, such as <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib2" title="">2</a>]</cite>, and also on identifying specific perception failures such as object detection <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib3" title="">3</a>]</cite> and semantic segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib4" title="">4</a>]</cite>, among many others. However, methods for assessing the system-level impact of perception failures is still a growing topic. Studies like <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib15" title="">15</a>]</cite>, introduced risk-ranked recall for object detection, and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib16" title="">16</a>]</cite>, created risk envelopes based on perception uncertainty, but both overlook predicting other agents’ future actions. Some recent approaches have used HJ reachability zones to account for the potential future actions of other agents to detect perception failures <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib18" title="">18</a>]</cite>. However, HJ reachability-based methods are overly conservative due to worst-case assumptions on other agent behavior. Antonante et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib1" title="">1</a>]</cite> propose replacing this worst-case assumption by leveraging learned trajectory prediction models to only consider statistically likely behaviors for other agents, but this method is too computationally heavy for online operation.
SPARQ takes a similar probabilistic approach when considering agent behavior, but only explicitly generates the future trajectories of agents at train time, distilling the final safety assessment of a candidate plan into a single lightweight neural network.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Recovery Planning.</span> The controls literature is rich with the class of algorithms known as safety filters which keep an autonomous system within a safe set by generating corrective actions whenever the system’s state approaches the “edge” of the safe set; see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib19" title="">19</a>]</cite> for an overview on safety filters. These approaches, though powerful and accompanied by safety guarantees, are often overly conservative and struggle to incorporate the rich information and uncertainty rife in autonomous driving. Some approaches that address fallback planning for perception-driven uncertainties include shield model-predictive path integral (MPPI) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib20" title="">20</a>]</cite> and hand-crafted fallback policies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib21" title="">21</a>]</cite>. However, both these approaches are applied to single-agent settings unlike autonomous driving. Other recent approaches include game-theoretic trajectory repair <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib22" title="">22</a>]</cite>, satisfiability modulo theory (SMT)-based repair <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib23" title="">23</a>]</cite>, and leveraging Large Language Models (LLMs) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib24" title="">24</a>]</cite>. Notably, none of these approaches operate under perception failures. Unlike the prior literature, SPARQ generates recovery plans for autonomous driving in dense multi-agent scenes while accounting for perceptual errors.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Problem Setup</span>
</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We consider an autonomous vehicle (referred to as the “ego”) operating as a dynamic system on a roadway, equipped with sensing and planning modules. We assume access to the map data showing pedestrian crossing, road lanes etc, which we term as road graph elements. In addition to static elements, the ego shares its environment with other vehicles, whose states are accurately estimated up to the current moment. The task of the ego is to utilize its autonomous capabilities to plan and execute dynamically feasible trajectories to achieve the task of navigation while ensuring safety concerning its surroundings. We call this as safe operation of the AV.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">However, the ego’s sensors are susceptible to performing sub-optimally and producing erroneous data, such as missed agents, leading to inaccurate predictions and potentially flawed planning. To mitigate this issue of <span class="ltx_text ltx_font_italic" id="S3.p2.1.1">perception failure</span>, a real-time perception monitor is used to detect discrepancies between the sensed data and the actual environment. Additionally, we assume access to a reliable “offline” algorithm that evaluates the safety of any trajectory proposed by the base planner within the AV’s navigation stack.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">The challenge arises when the perception monitor detects an error in the sensor feedback during runtime. In such cases, it becomes difficult to determine whether the currently planned trajectory (the “candidate plan”) can still ensure safe operation.
Thus, it is essential to possess an algorithm that can evaluate the candidate plan’s safety under the presence of perception errors <em class="ltx_emph ltx_font_italic" id="S3.p3.1.1">online</em>, and if the plan is deemed unsafe, the algorithm should correct the plan in real-time based on feedback from the perception monitor.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1">Hence, our key objectives in this work are:
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S3.p4.1.1">Online Safety Evaluation of Candidate plan Under Perception Failure:</span> Develop an <span class="ltx_text ltx_font_italic" id="S3.p4.1.2">online</span> algorithm that integrates real-time feedback from the perception monitor to evaluate the safety score of any candidate plan.</p>
</div>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.1"><span class="ltx_text ltx_font_bold" id="S3.p5.1.1">Plan Repair</span>: Design an algorithm to adjust and repair any candidate plan to ensure safety, taking into account both the faulty sensor observations and the corrections provided by the perception monitor.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Background: RH Planner</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.2">We will now go over a quick description of the rule hierarchy (RH) planner <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib25" title="">25</a>]</cite>, which we use as our offline recovery planner for data collection.
The RH Planner generates a trajectory tree and then evaluates a reward <math alttext="R" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">italic_R</annotation></semantics></math> for each branch of the tree. The trajectory with the highest reward is chosen for execution. The reward function encompasses various traffic rules in the form of a rule hierarchy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib25" title="">25</a>]</cite> wherein each rule is expressed as a Signal Temporal Logic (STL) formula. Rules in a rule hierarchy are assigned an importance ranking – the key distinguishing property of rule hierarchies is their ability to relax less important rules in favor of the more important ones in the event that all rules cannot be simultaneously satisfied. Rule hierarchies are a powerful tool to prescribe criteria for over-specified systems where multiple criteria exist that may conflict with one another, e.g., violate speed limit to avoid collision. The rule hierarchy reward <math alttext="R" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">R</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">italic_R</annotation></semantics></math> measures how well a trajectory adheres to the rule hierarchy, i.e., trajectories that satisfy more important rules receive a higher reward than those that only satisfy less important rules. In this paper, our rule hierarchy comprises of the following rules in decreasing order of importance: (i) <span class="ltx_text ltx_font_typewriter" id="S4.p1.2.1">collision avoidance</span>; (ii) <span class="ltx_text ltx_font_typewriter" id="S4.p1.2.2">offroad avoidance</span>; (iii) <span class="ltx_text ltx_font_typewriter" id="S4.p1.2.3">traffic light compliance</span>; (iv) <span class="ltx_text ltx_font_typewriter" id="S4.p1.2.4">speed limit compliance</span>; (v) <span class="ltx_text ltx_font_typewriter" id="S4.p1.2.5">progression</span>; (vi) <span class="ltx_text ltx_font_typewriter" id="S4.p1.2.6">stay near the route plan center line</span>; and (vii) <span class="ltx_text ltx_font_typewriter" id="S4.p1.2.7">stay aligned with the route plan center line</span>. Finally, we note that we use a lane-keep predictor to forecast the future of non-ego vehicles, while we use a constant-velocity predictor for pedestrians.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">System-Level Safety Monitoring and Recovery</span>
</h2>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="232" id="S5.F3.g1" src="extracted/5904926/figures/network_structure.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F3.3.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S5.F3.4.2" style="font-size:90%;">The SPARQ Network Structure</span></figcaption>
</figure>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">SPARQ takes as input the (i) scene information, which includes the state history of the ego and surrounding agents and the road graph (RG) elements; (ii) output of a component-level perception monitor which indicates the nature of a potential perception error if one exists, such as the estimated position and velocity of a missed agent; and (iii) a candidate ego plan. The network then outputs a safety score for the plan and recovery plans if the original plan is unsafe. A detailed architecture of SPARQ is provided in Fig. <a class="ltx_ref ltx_font_bold" href="https://arxiv.org/html/2409.17630v2#S5.F3" title="Figure 3 ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">3</span></a>. In the rest of this section we will discuss the various aspects involved in developing SPARQ.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS1.5.1.1">V-A</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS1.6.2">Safety Score</span>
</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">SPARQ predicts the safety score of a given motion plan, which quantifies how risky the plan is to execute. Our approach can work with any base safety score, such as time-to-collision or distance to the nearest agent, but we use the rule-hierarchy reward function presented in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S4" title="IV Background: RH Planner ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">IV</span></a> for its ability to tie in multiple safety criteria.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">However, on its own, these base scores can only assess the risk of a motion plan relative to perceived map elements and obstacles, and fail to account for safety violations due to interactions with scene elements that the AV perception system did not detect at runtime.
Runtime perception monitors can often provide some information about potential perception failures, for example, roughly localizing a potentially missed obstacle in the scene <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib1" title="">1</a>]</cite>.
In SPARQ, we develop a module which adapts a base safety score into a safety score which can account for information provided by a runtime perception monitor.
The key advantage of SPARQ is its fast inference speed, which enables online evaluation of safety-critical violations under the current plan while accounting for the perception error information from perception monitors.</p>
</div>
<div class="ltx_theorem ltx_theorem_remark" id="Thmremark1">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmremark1.1.1.1">Remark 1</span></span></h6>
<div class="ltx_para" id="Thmremark1.p1">
<p class="ltx_p" id="Thmremark1.p1.1"><span class="ltx_text ltx_font_italic" id="Thmremark1.p1.1.1">Note that since the predicted safety score is conditioned on the ego plan, notionally, SPARQ is reminiscent of a Q-function, where the perceived scene and the perception failure information comprise the observation, and the ego plan is the action. Therefore, we refer to it as a Q-network.</span></p>
</div>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS2.5.1.1">V-B</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS2.6.2">Scene Encoding</span>
</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">As input, SPARQ takes the scene, the candidate plan for the ego, and the monitor input, transforming them into a latent embeddings. The road graph, represented by point clouds of various map elements, is processed using the PointNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib26" title="">26</a>]</cite> architecture to extract relevant features, while other inputs are processed via Multi-Layer Perceptrons (MLPs). Both spatial and temporal encodings are added to these features, resulting in a unified embedding for each input type.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">To further refine these embeddings, we employ a transformer-based attention mechanism. Specifically, the model iterates self-attention over the plan embeddings and cross-attention to the embeddings of other elements (e.g., ego, agents, road graph elements and monitor). To optimize computational efficiency, we leverage a Multi-Axial Attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib27" title="">27</a>]</cite> mechanism, alternatively performing attention over timesteps and attention across elements, which significantly reduces the complexity relative to attending across all dimensions simultaneously.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">The encoded embeddings are then passed through a decoder that uses self-attention to refine the latent representation. Finally, an aggregation MLP projects the latent representation to a single vector representing logits for the quantized values of the safety score.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS3.5.1.1">V-C</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS3.6.2">Dataset</span>
</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">SPARQ is trained using supervised learning using existing AV datasets like nuPlan <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib6" title="">6</a>]</cite>. Each training sample consists of a scene, a planned trajectory, and a monitor input simulating a missed agent. The dataset collection process is depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.F4" title="Figure 4 ‣ V-C Dataset ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">4</span></a> and outlined in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#alg1" title="Algorithm 1 ‣ V-D Training ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.3">We first sample a scene <math alttext="s" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><mi id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><ci id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">italic_s</annotation></semantics></math> (Algorithm:Line <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#alg1.l5" title="In Algorithm 1 ‣ V-D Training ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">5</span></a>, Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.F4" title="Figure 4 ‣ V-C Dataset ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">4</span></a>a) from the nuPlan dataset. Next, we simulate a perception failure at a random state <math alttext="p_{mon}" class="ltx_Math" display="inline" id="S5.SS3.p2.2.m2.1"><semantics id="S5.SS3.p2.2.m2.1a"><msub id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mi id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">p</mi><mrow id="S5.SS3.p2.2.m2.1.1.3" xref="S5.SS3.p2.2.m2.1.1.3.cmml"><mi id="S5.SS3.p2.2.m2.1.1.3.2" xref="S5.SS3.p2.2.m2.1.1.3.2.cmml">m</mi><mo id="S5.SS3.p2.2.m2.1.1.3.1" xref="S5.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p2.2.m2.1.1.3.3" xref="S5.SS3.p2.2.m2.1.1.3.3.cmml">o</mi><mo id="S5.SS3.p2.2.m2.1.1.3.1a" xref="S5.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p2.2.m2.1.1.3.4" xref="S5.SS3.p2.2.m2.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">𝑝</ci><apply id="S5.SS3.p2.2.m2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3"><times id="S5.SS3.p2.2.m2.1.1.3.1.cmml" xref="S5.SS3.p2.2.m2.1.1.3.1"></times><ci id="S5.SS3.p2.2.m2.1.1.3.2.cmml" xref="S5.SS3.p2.2.m2.1.1.3.2">𝑚</ci><ci id="S5.SS3.p2.2.m2.1.1.3.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3.3">𝑜</ci><ci id="S5.SS3.p2.2.m2.1.1.3.4.cmml" xref="S5.SS3.p2.2.m2.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">p_{mon}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.2.m2.1d">italic_p start_POSTSUBSCRIPT italic_m italic_o italic_n end_POSTSUBSCRIPT</annotation></semantics></math> (assumed to be normally distributed <math alttext="N(\mathbf{0,I})" class="ltx_Math" display="inline" id="S5.SS3.p2.3.m3.2"><semantics id="S5.SS3.p2.3.m3.2a"><mrow id="S5.SS3.p2.3.m3.2.3" xref="S5.SS3.p2.3.m3.2.3.cmml"><mi id="S5.SS3.p2.3.m3.2.3.2" xref="S5.SS3.p2.3.m3.2.3.2.cmml">N</mi><mo id="S5.SS3.p2.3.m3.2.3.1" xref="S5.SS3.p2.3.m3.2.3.1.cmml">⁢</mo><mrow id="S5.SS3.p2.3.m3.2.3.3.2" xref="S5.SS3.p2.3.m3.2.3.3.1.cmml"><mo id="S5.SS3.p2.3.m3.2.3.3.2.1" stretchy="false" xref="S5.SS3.p2.3.m3.2.3.3.1.cmml">(</mo><mn id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml">𝟎</mn><mo id="S5.SS3.p2.3.m3.2.3.3.2.2" xref="S5.SS3.p2.3.m3.2.3.3.1.cmml">,</mo><mi id="S5.SS3.p2.3.m3.2.2" xref="S5.SS3.p2.3.m3.2.2.cmml">𝐈</mi><mo id="S5.SS3.p2.3.m3.2.3.3.2.3" stretchy="false" xref="S5.SS3.p2.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.2b"><apply id="S5.SS3.p2.3.m3.2.3.cmml" xref="S5.SS3.p2.3.m3.2.3"><times id="S5.SS3.p2.3.m3.2.3.1.cmml" xref="S5.SS3.p2.3.m3.2.3.1"></times><ci id="S5.SS3.p2.3.m3.2.3.2.cmml" xref="S5.SS3.p2.3.m3.2.3.2">𝑁</ci><interval closure="open" id="S5.SS3.p2.3.m3.2.3.3.1.cmml" xref="S5.SS3.p2.3.m3.2.3.3.2"><cn id="S5.SS3.p2.3.m3.1.1.cmml" type="integer" xref="S5.SS3.p2.3.m3.1.1">0</cn><ci id="S5.SS3.p2.3.m3.2.2.cmml" xref="S5.SS3.p2.3.m3.2.2">𝐈</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.2c">N(\mathbf{0,I})</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.3.m3.2d">italic_N ( bold_0 , bold_I )</annotation></semantics></math>, Algorithm:Line <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#alg1.l7" title="In Algorithm 1 ‣ V-D Training ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">7</span></a>, Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.F4" title="Figure 4 ‣ V-C Dataset ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">4</span></a>b).
This can give rise to two possible scenarios:<span class="ltx_text ltx_font_bold" id="S5.SS3.p2.3.1">(i)</span> There are no agents near the failure (Algorithm:Line <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#alg1.l13" title="In Algorithm 1 ‣ V-D Training ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">13</span></a>, Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.F4" title="Figure 4 ‣ V-C Dataset ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">4</span></a> <span class="ltx_text ltx_font_bold" id="S5.SS3.p2.3.2">bottom row</span>), <span class="ltx_text ltx_font_bold" id="S5.SS3.p2.3.3">(ii)</span> There are agents near the perception failure. (Algorithm:Line <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#alg1.l18" title="In Algorithm 1 ‣ V-D Training ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">18</span></a>, Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.F4" title="Figure 4 ‣ V-C Dataset ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">4</span></a> <span class="ltx_text ltx_font_bold" id="S5.SS3.p2.3.4">top row</span>)
Depending on the case, we manually edit the scene to simulate the perception failure and obtain the monitored scene (e.g., Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.F4" title="Figure 4 ‣ V-C Dataset ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">4</span></a>c) and the corresponding perceived scene (e.g., Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.F4" title="Figure 4 ‣ V-C Dataset ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">4</span></a>d). We then <span class="ltx_text ltx_font_typewriter" id="S5.SS3.p2.3.5">Plan</span> the planned trajectory tree (Algorithm:Line <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#alg1.l23" title="In Algorithm 1 ‣ V-D Training ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">23</span></a>) on the perceived scene and <span class="ltx_text ltx_font_typewriter" id="S5.SS3.p2.3.6">Evaluate</span> the safety reward by using the rule-based scoring system of RHPlanner on the monitored scene (Algorithm:Line <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#alg1.l24" title="In Algorithm 1 ‣ V-D Training ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">24</span></a>). The rewards are finally categorized into class labels.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="298" id="S5.F4.g1" src="extracted/5904926/figures/data_collection_procedure.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F4.3.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S5.F4.4.2" style="font-size:90%;"> Data Generation Structure. As our first step we sample a random position as our monitor input. The <span class="ltx_text ltx_font_bold" id="S5.F4.4.2.1">top row</span> shows the case when an agent exists at the sampled position of the perception monitor (column (b)). We remove the agent from the ground truth (GT) scene to construct our perceived scene (column (d)). The <span class="ltx_text ltx_font_bold" id="S5.F4.4.2.2">bottom row</span> shows the case when an agent does not exist. In such cases we use the GT scene as the perceived scene. In either case, our training sample comprises of (perceived scene, ego candidate plan), while the corresponding class label is obtained by evaluating the plan in the monitored scene (column (c)).</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.1">To maintain dataset realism, it is crucial to balance the randomness of the monitor input while ensuring that the edits to the scene remain plausible. To achieve this, we prioritize the sampling of the failure states near existing agents in the scene (<span class="ltx_text ltx_font_bold" id="S5.SS3.p3.1.1">top row</span> in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.F4" title="Figure 4 ‣ V-C Dataset ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">4</span></a>). This approach reduces the need to introduce artificial information about agent behavior or account for interaction dynamics between newly introduced or missing agents, as the monitored agents were already part of the original scene; consequently, the monitored scenes (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.F4" title="Figure 4 ‣ V-C Dataset ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">4</span></a>c <span class="ltx_text ltx_font_bold" id="S5.SS3.p3.1.2">top row</span>) are similar to the raw ground truth scene (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S5.F4" title="Figure 4 ‣ V-C Dataset ‣ V System-Level Safety Monitoring and Recovery ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">4</span></a>a <span class="ltx_text ltx_font_bold" id="S5.SS3.p3.1.3">top row</span>) which are obtained using real-world driving logs.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS4.5.1.1">V-D</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS4.6.2">Training</span>
</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">Training SPARQ using this dataset in a self-supervised approach takes around 2 days on an NVIDIA RTX 4090 GPU for 25 epochs, with batches of 256 scenarios per iteration. We use the Adam optimizer with a learning rate of <math alttext="2\times 10^{-5}" class="ltx_Math" display="inline" id="S5.SS4.p1.1.m1.1"><semantics id="S5.SS4.p1.1.m1.1a"><mrow id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mn id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml">2</mn><mo id="S5.SS4.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS4.p1.1.m1.1.1.1.cmml">×</mo><msup id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml"><mn id="S5.SS4.p1.1.m1.1.1.3.2" xref="S5.SS4.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S5.SS4.p1.1.m1.1.1.3.3" xref="S5.SS4.p1.1.m1.1.1.3.3.cmml"><mo id="S5.SS4.p1.1.m1.1.1.3.3a" xref="S5.SS4.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S5.SS4.p1.1.m1.1.1.3.3.2" xref="S5.SS4.p1.1.m1.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><times id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1.1"></times><cn id="S5.SS4.p1.1.m1.1.1.2.cmml" type="integer" xref="S5.SS4.p1.1.m1.1.1.2">2</cn><apply id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3">superscript</csymbol><cn id="S5.SS4.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S5.SS4.p1.1.m1.1.1.3.2">10</cn><apply id="S5.SS4.p1.1.m1.1.1.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3"><minus id="S5.SS4.p1.1.m1.1.1.3.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3"></minus><cn id="S5.SS4.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S5.SS4.p1.1.m1.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">2\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.1d">2 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> and a linear decay schedule.</p>
</div>
<div class="ltx_theorem ltx_theorem_remark" id="Thmremark2">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmremark2.1.1.1">Remark 2</span></span></h6>
<div class="ltx_para" id="Thmremark2.p1">
<p class="ltx_p" id="Thmremark2.p1.1"><span class="ltx_text ltx_font_italic" id="Thmremark2.p1.1.1">Even though our safety monitor predicts a discrete safety class, the proposed framework can readily be adapted to regress a continuous safety score instead.</span></p>
</div>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Dataset Collection for Training Safety Monitor</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l1.2">Input:</span> number of samples <math alttext="N" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_N</annotation></semantics></math>, raw dataset <math alttext="D_{raw}" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">D</mi><mrow id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml"><mi id="alg1.l1.m2.1.1.3.2" xref="alg1.l1.m2.1.1.3.2.cmml">r</mi><mo id="alg1.l1.m2.1.1.3.1" xref="alg1.l1.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.3.3" xref="alg1.l1.m2.1.1.3.3.cmml">a</mi><mo id="alg1.l1.m2.1.1.3.1a" xref="alg1.l1.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.3.4" xref="alg1.l1.m2.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝐷</ci><apply id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3"><times id="alg1.l1.m2.1.1.3.1.cmml" xref="alg1.l1.m2.1.1.3.1"></times><ci id="alg1.l1.m2.1.1.3.2.cmml" xref="alg1.l1.m2.1.1.3.2">𝑟</ci><ci id="alg1.l1.m2.1.1.3.3.cmml" xref="alg1.l1.m2.1.1.3.3">𝑎</ci><ci id="alg1.l1.m2.1.1.3.4.cmml" xref="alg1.l1.m2.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">D_{raw}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_D start_POSTSUBSCRIPT italic_r italic_a italic_w end_POSTSUBSCRIPT</annotation></semantics></math>, e.g., the Nuplan dataset, planner <math alttext="Plan" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">P</mi><mo id="alg1.l1.m3.1.1.1" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">l</mi><mo id="alg1.l1.m3.1.1.1a" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.4" xref="alg1.l1.m3.1.1.4.cmml">a</mi><mo id="alg1.l1.m3.1.1.1b" xref="alg1.l1.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m3.1.1.5" xref="alg1.l1.m3.1.1.5.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><times id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1"></times><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝑃</ci><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝑙</ci><ci id="alg1.l1.m3.1.1.4.cmml" xref="alg1.l1.m3.1.1.4">𝑎</ci><ci id="alg1.l1.m3.1.1.5.cmml" xref="alg1.l1.m3.1.1.5">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">Plan</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_P italic_l italic_a italic_n</annotation></semantics></math>, rule-based evaluator <math alttext="Eval" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><mrow id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">E</mi><mo id="alg1.l1.m4.1.1.1" xref="alg1.l1.m4.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m4.1.1.3" xref="alg1.l1.m4.1.1.3.cmml">v</mi><mo id="alg1.l1.m4.1.1.1a" xref="alg1.l1.m4.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m4.1.1.4" xref="alg1.l1.m4.1.1.4.cmml">a</mi><mo id="alg1.l1.m4.1.1.1b" xref="alg1.l1.m4.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m4.1.1.5" xref="alg1.l1.m4.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><times id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1.1"></times><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">𝐸</ci><ci id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3">𝑣</ci><ci id="alg1.l1.m4.1.1.4.cmml" xref="alg1.l1.m4.1.1.4">𝑎</ci><ci id="alg1.l1.m4.1.1.5.cmml" xref="alg1.l1.m4.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">Eval</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_E italic_v italic_a italic_l</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l2.2">Output:</span> Monitor dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">caligraphic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l3.2">Initialize</span> <math alttext="\mathcal{D}\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">𝒟</mi><mo id="alg1.l3.m1.1.1.1" stretchy="false" xref="alg1.l3.m1.1.1.1.cmml">←</mo><mi id="alg1.l3.m1.1.1.3" mathvariant="normal" xref="alg1.l3.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝒟</ci><emptyset id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathcal{D}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">caligraphic_D ← ∅</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l4.2">for</span> <span class="ltx_text ltx_font_typewriter" id="alg1.l4.3">i = {1,2...,N}</span> <span class="ltx_text ltx_font_bold" id="alg1.l4.4">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>     Sample a scene <math alttext="s\in\mathcal{D}_{raw}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">s</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">∈</mo><msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">𝒟</mi><mrow id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml"><mi id="alg1.l5.m1.1.1.3.3.2" xref="alg1.l5.m1.1.1.3.3.2.cmml">r</mi><mo id="alg1.l5.m1.1.1.3.3.1" xref="alg1.l5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.3.3.3" xref="alg1.l5.m1.1.1.3.3.3.cmml">a</mi><mo id="alg1.l5.m1.1.1.3.3.1a" xref="alg1.l5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.3.3.4" xref="alg1.l5.m1.1.1.3.3.4.cmml">w</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><in id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></in><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑠</ci><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝒟</ci><apply id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3"><times id="alg1.l5.m1.1.1.3.3.1.cmml" xref="alg1.l5.m1.1.1.3.3.1"></times><ci id="alg1.l5.m1.1.1.3.3.2.cmml" xref="alg1.l5.m1.1.1.3.3.2">𝑟</ci><ci id="alg1.l5.m1.1.1.3.3.3.cmml" xref="alg1.l5.m1.1.1.3.3.3">𝑎</ci><ci id="alg1.l5.m1.1.1.3.3.4.cmml" xref="alg1.l5.m1.1.1.3.3.4">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">s\in\mathcal{D}_{raw}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_s ∈ caligraphic_D start_POSTSUBSCRIPT italic_r italic_a italic_w end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.2.1.1" style="font-size:80%;">6:</span></span>     all_agents <math alttext="\leftarrow get\_agents(s)" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.2" xref="alg1.l6.m1.1.2.cmml"><mi id="alg1.l6.m1.1.2.2" xref="alg1.l6.m1.1.2.2.cmml"></mi><mo id="alg1.l6.m1.1.2.1" stretchy="false" xref="alg1.l6.m1.1.2.1.cmml">←</mo><mrow id="alg1.l6.m1.1.2.3" xref="alg1.l6.m1.1.2.3.cmml"><mi id="alg1.l6.m1.1.2.3.2" xref="alg1.l6.m1.1.2.3.2.cmml">g</mi><mo id="alg1.l6.m1.1.2.3.1" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.2.3.3" xref="alg1.l6.m1.1.2.3.3.cmml">e</mi><mo id="alg1.l6.m1.1.2.3.1a" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.2.3.4" xref="alg1.l6.m1.1.2.3.4.cmml">t</mi><mo id="alg1.l6.m1.1.2.3.1b" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.2.3.5" mathvariant="normal" xref="alg1.l6.m1.1.2.3.5.cmml">_</mi><mo id="alg1.l6.m1.1.2.3.1c" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.2.3.6" xref="alg1.l6.m1.1.2.3.6.cmml">a</mi><mo id="alg1.l6.m1.1.2.3.1d" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.2.3.7" xref="alg1.l6.m1.1.2.3.7.cmml">g</mi><mo id="alg1.l6.m1.1.2.3.1e" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.2.3.8" xref="alg1.l6.m1.1.2.3.8.cmml">e</mi><mo id="alg1.l6.m1.1.2.3.1f" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.2.3.9" xref="alg1.l6.m1.1.2.3.9.cmml">n</mi><mo id="alg1.l6.m1.1.2.3.1g" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.2.3.10" xref="alg1.l6.m1.1.2.3.10.cmml">t</mi><mo id="alg1.l6.m1.1.2.3.1h" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.2.3.11" xref="alg1.l6.m1.1.2.3.11.cmml">s</mi><mo id="alg1.l6.m1.1.2.3.1i" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l6.m1.1.2.3.12.2" xref="alg1.l6.m1.1.2.3.cmml"><mo id="alg1.l6.m1.1.2.3.12.2.1" stretchy="false" xref="alg1.l6.m1.1.2.3.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">s</mi><mo id="alg1.l6.m1.1.2.3.12.2.2" stretchy="false" xref="alg1.l6.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.2.cmml" xref="alg1.l6.m1.1.2"><ci id="alg1.l6.m1.1.2.1.cmml" xref="alg1.l6.m1.1.2.1">←</ci><csymbol cd="latexml" id="alg1.l6.m1.1.2.2.cmml" xref="alg1.l6.m1.1.2.2">absent</csymbol><apply id="alg1.l6.m1.1.2.3.cmml" xref="alg1.l6.m1.1.2.3"><times id="alg1.l6.m1.1.2.3.1.cmml" xref="alg1.l6.m1.1.2.3.1"></times><ci id="alg1.l6.m1.1.2.3.2.cmml" xref="alg1.l6.m1.1.2.3.2">𝑔</ci><ci id="alg1.l6.m1.1.2.3.3.cmml" xref="alg1.l6.m1.1.2.3.3">𝑒</ci><ci id="alg1.l6.m1.1.2.3.4.cmml" xref="alg1.l6.m1.1.2.3.4">𝑡</ci><ci id="alg1.l6.m1.1.2.3.5.cmml" xref="alg1.l6.m1.1.2.3.5">_</ci><ci id="alg1.l6.m1.1.2.3.6.cmml" xref="alg1.l6.m1.1.2.3.6">𝑎</ci><ci id="alg1.l6.m1.1.2.3.7.cmml" xref="alg1.l6.m1.1.2.3.7">𝑔</ci><ci id="alg1.l6.m1.1.2.3.8.cmml" xref="alg1.l6.m1.1.2.3.8">𝑒</ci><ci id="alg1.l6.m1.1.2.3.9.cmml" xref="alg1.l6.m1.1.2.3.9">𝑛</ci><ci id="alg1.l6.m1.1.2.3.10.cmml" xref="alg1.l6.m1.1.2.3.10">𝑡</ci><ci id="alg1.l6.m1.1.2.3.11.cmml" xref="alg1.l6.m1.1.2.3.11">𝑠</ci><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\leftarrow get\_agents(s)</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">← italic_g italic_e italic_t _ italic_a italic_g italic_e italic_n italic_t italic_s ( italic_s )</annotation></semantics></math> <span class="ltx_text" id="alg1.l6.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.m1.1d">▷</annotation></semantics></math> Get all agents
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.2.1.1" style="font-size:80%;">7:</span></span>     <math alttext="p_{mon}\sim N(p_{mon};\mathbf{0},\mathbf{I})" class="ltx_Math" display="inline" id="alg1.l7.m1.3"><semantics id="alg1.l7.m1.3a"><mrow id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml"><msub id="alg1.l7.m1.3.3.3" xref="alg1.l7.m1.3.3.3.cmml"><mi id="alg1.l7.m1.3.3.3.2" xref="alg1.l7.m1.3.3.3.2.cmml">p</mi><mrow id="alg1.l7.m1.3.3.3.3" xref="alg1.l7.m1.3.3.3.3.cmml"><mi id="alg1.l7.m1.3.3.3.3.2" xref="alg1.l7.m1.3.3.3.3.2.cmml">m</mi><mo id="alg1.l7.m1.3.3.3.3.1" xref="alg1.l7.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.3.3.3.3.3" xref="alg1.l7.m1.3.3.3.3.3.cmml">o</mi><mo id="alg1.l7.m1.3.3.3.3.1a" xref="alg1.l7.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.3.3.3.3.4" xref="alg1.l7.m1.3.3.3.3.4.cmml">n</mi></mrow></msub><mo id="alg1.l7.m1.3.3.2" xref="alg1.l7.m1.3.3.2.cmml">∼</mo><mrow id="alg1.l7.m1.3.3.1" xref="alg1.l7.m1.3.3.1.cmml"><mi id="alg1.l7.m1.3.3.1.3" xref="alg1.l7.m1.3.3.1.3.cmml">N</mi><mo id="alg1.l7.m1.3.3.1.2" xref="alg1.l7.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l7.m1.3.3.1.1.1" xref="alg1.l7.m1.3.3.1.1.2.cmml"><mo id="alg1.l7.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.l7.m1.3.3.1.1.2.cmml">(</mo><msub id="alg1.l7.m1.3.3.1.1.1.1" xref="alg1.l7.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l7.m1.3.3.1.1.1.1.2" xref="alg1.l7.m1.3.3.1.1.1.1.2.cmml">p</mi><mrow id="alg1.l7.m1.3.3.1.1.1.1.3" xref="alg1.l7.m1.3.3.1.1.1.1.3.cmml"><mi id="alg1.l7.m1.3.3.1.1.1.1.3.2" xref="alg1.l7.m1.3.3.1.1.1.1.3.2.cmml">m</mi><mo id="alg1.l7.m1.3.3.1.1.1.1.3.1" xref="alg1.l7.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.3.3.1.1.1.1.3.3" xref="alg1.l7.m1.3.3.1.1.1.1.3.3.cmml">o</mi><mo id="alg1.l7.m1.3.3.1.1.1.1.3.1a" xref="alg1.l7.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l7.m1.3.3.1.1.1.1.3.4" xref="alg1.l7.m1.3.3.1.1.1.1.3.4.cmml">n</mi></mrow></msub><mo id="alg1.l7.m1.3.3.1.1.1.3" xref="alg1.l7.m1.3.3.1.1.2.cmml">;</mo><mn id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">𝟎</mn><mo id="alg1.l7.m1.3.3.1.1.1.4" xref="alg1.l7.m1.3.3.1.1.2.cmml">,</mo><mi id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">𝐈</mi><mo id="alg1.l7.m1.3.3.1.1.1.5" stretchy="false" xref="alg1.l7.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.3b"><apply id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3"><csymbol cd="latexml" id="alg1.l7.m1.3.3.2.cmml" xref="alg1.l7.m1.3.3.2">similar-to</csymbol><apply id="alg1.l7.m1.3.3.3.cmml" xref="alg1.l7.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.3.1.cmml" xref="alg1.l7.m1.3.3.3">subscript</csymbol><ci id="alg1.l7.m1.3.3.3.2.cmml" xref="alg1.l7.m1.3.3.3.2">𝑝</ci><apply id="alg1.l7.m1.3.3.3.3.cmml" xref="alg1.l7.m1.3.3.3.3"><times id="alg1.l7.m1.3.3.3.3.1.cmml" xref="alg1.l7.m1.3.3.3.3.1"></times><ci id="alg1.l7.m1.3.3.3.3.2.cmml" xref="alg1.l7.m1.3.3.3.3.2">𝑚</ci><ci id="alg1.l7.m1.3.3.3.3.3.cmml" xref="alg1.l7.m1.3.3.3.3.3">𝑜</ci><ci id="alg1.l7.m1.3.3.3.3.4.cmml" xref="alg1.l7.m1.3.3.3.3.4">𝑛</ci></apply></apply><apply id="alg1.l7.m1.3.3.1.cmml" xref="alg1.l7.m1.3.3.1"><times id="alg1.l7.m1.3.3.1.2.cmml" xref="alg1.l7.m1.3.3.1.2"></times><ci id="alg1.l7.m1.3.3.1.3.cmml" xref="alg1.l7.m1.3.3.1.3">𝑁</ci><list id="alg1.l7.m1.3.3.1.1.2.cmml" xref="alg1.l7.m1.3.3.1.1.1"><apply id="alg1.l7.m1.3.3.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2">𝑝</ci><apply id="alg1.l7.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.3"><times id="alg1.l7.m1.3.3.1.1.1.1.3.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.3.1"></times><ci id="alg1.l7.m1.3.3.1.1.1.1.3.2.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.3.2">𝑚</ci><ci id="alg1.l7.m1.3.3.1.1.1.1.3.3.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.3.3">𝑜</ci><ci id="alg1.l7.m1.3.3.1.1.1.1.3.4.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.3.4">𝑛</ci></apply></apply><cn id="alg1.l7.m1.1.1.cmml" type="integer" xref="alg1.l7.m1.1.1">0</cn><ci id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">𝐈</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.3c">p_{mon}\sim N(p_{mon};\mathbf{0},\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.3d">italic_p start_POSTSUBSCRIPT italic_m italic_o italic_n end_POSTSUBSCRIPT ∼ italic_N ( italic_p start_POSTSUBSCRIPT italic_m italic_o italic_n end_POSTSUBSCRIPT ; bold_0 , bold_I )</annotation></semantics></math> <span class="ltx_text" id="alg1.l7.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l7.1.m1.1"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.1.m1.1d">▷</annotation></semantics></math> Sample failure 
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>     nearby_agents <math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mo id="alg1.l8.m1.1.1" stretchy="false" xref="alg1.l8.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">←</annotation></semantics></math> <math alttext="agents\_near(p_{mon})" class="ltx_Math" display="inline" id="alg1.l8.m2.1"><semantics id="alg1.l8.m2.1a"><mrow id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mi id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">a</mi><mo id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.4" xref="alg1.l8.m2.1.1.4.cmml">g</mi><mo id="alg1.l8.m2.1.1.2a" xref="alg1.l8.m2.1.1.2.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.5" xref="alg1.l8.m2.1.1.5.cmml">e</mi><mo id="alg1.l8.m2.1.1.2b" xref="alg1.l8.m2.1.1.2.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.6" xref="alg1.l8.m2.1.1.6.cmml">n</mi><mo id="alg1.l8.m2.1.1.2c" xref="alg1.l8.m2.1.1.2.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.7" xref="alg1.l8.m2.1.1.7.cmml">t</mi><mo id="alg1.l8.m2.1.1.2d" xref="alg1.l8.m2.1.1.2.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.8" xref="alg1.l8.m2.1.1.8.cmml">s</mi><mo id="alg1.l8.m2.1.1.2e" xref="alg1.l8.m2.1.1.2.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.9" mathvariant="normal" xref="alg1.l8.m2.1.1.9.cmml">_</mi><mo id="alg1.l8.m2.1.1.2f" xref="alg1.l8.m2.1.1.2.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.10" xref="alg1.l8.m2.1.1.10.cmml">n</mi><mo id="alg1.l8.m2.1.1.2g" xref="alg1.l8.m2.1.1.2.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.11" xref="alg1.l8.m2.1.1.11.cmml">e</mi><mo id="alg1.l8.m2.1.1.2h" xref="alg1.l8.m2.1.1.2.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.12" xref="alg1.l8.m2.1.1.12.cmml">a</mi><mo id="alg1.l8.m2.1.1.2i" xref="alg1.l8.m2.1.1.2.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.13" xref="alg1.l8.m2.1.1.13.cmml">r</mi><mo id="alg1.l8.m2.1.1.2j" xref="alg1.l8.m2.1.1.2.cmml">⁢</mo><mrow id="alg1.l8.m2.1.1.1.1" xref="alg1.l8.m2.1.1.1.1.1.cmml"><mo id="alg1.l8.m2.1.1.1.1.2" stretchy="false" xref="alg1.l8.m2.1.1.1.1.1.cmml">(</mo><msub id="alg1.l8.m2.1.1.1.1.1" xref="alg1.l8.m2.1.1.1.1.1.cmml"><mi id="alg1.l8.m2.1.1.1.1.1.2" xref="alg1.l8.m2.1.1.1.1.1.2.cmml">p</mi><mrow id="alg1.l8.m2.1.1.1.1.1.3" xref="alg1.l8.m2.1.1.1.1.1.3.cmml"><mi id="alg1.l8.m2.1.1.1.1.1.3.2" xref="alg1.l8.m2.1.1.1.1.1.3.2.cmml">m</mi><mo id="alg1.l8.m2.1.1.1.1.1.3.1" xref="alg1.l8.m2.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.1.1.1.3.3" xref="alg1.l8.m2.1.1.1.1.1.3.3.cmml">o</mi><mo id="alg1.l8.m2.1.1.1.1.1.3.1a" xref="alg1.l8.m2.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.1.1.1.3.4" xref="alg1.l8.m2.1.1.1.1.1.3.4.cmml">n</mi></mrow></msub><mo id="alg1.l8.m2.1.1.1.1.3" stretchy="false" xref="alg1.l8.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><times id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2"></times><ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">𝑎</ci><ci id="alg1.l8.m2.1.1.4.cmml" xref="alg1.l8.m2.1.1.4">𝑔</ci><ci id="alg1.l8.m2.1.1.5.cmml" xref="alg1.l8.m2.1.1.5">𝑒</ci><ci id="alg1.l8.m2.1.1.6.cmml" xref="alg1.l8.m2.1.1.6">𝑛</ci><ci id="alg1.l8.m2.1.1.7.cmml" xref="alg1.l8.m2.1.1.7">𝑡</ci><ci id="alg1.l8.m2.1.1.8.cmml" xref="alg1.l8.m2.1.1.8">𝑠</ci><ci id="alg1.l8.m2.1.1.9.cmml" xref="alg1.l8.m2.1.1.9">_</ci><ci id="alg1.l8.m2.1.1.10.cmml" xref="alg1.l8.m2.1.1.10">𝑛</ci><ci id="alg1.l8.m2.1.1.11.cmml" xref="alg1.l8.m2.1.1.11">𝑒</ci><ci id="alg1.l8.m2.1.1.12.cmml" xref="alg1.l8.m2.1.1.12">𝑎</ci><ci id="alg1.l8.m2.1.1.13.cmml" xref="alg1.l8.m2.1.1.13">𝑟</ci><apply id="alg1.l8.m2.1.1.1.1.1.cmml" xref="alg1.l8.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.1.1.1.1.1.1.cmml" xref="alg1.l8.m2.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m2.1.1.1.1.1.2.cmml" xref="alg1.l8.m2.1.1.1.1.1.2">𝑝</ci><apply id="alg1.l8.m2.1.1.1.1.1.3.cmml" xref="alg1.l8.m2.1.1.1.1.1.3"><times id="alg1.l8.m2.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m2.1.1.1.1.1.3.1"></times><ci id="alg1.l8.m2.1.1.1.1.1.3.2.cmml" xref="alg1.l8.m2.1.1.1.1.1.3.2">𝑚</ci><ci id="alg1.l8.m2.1.1.1.1.1.3.3.cmml" xref="alg1.l8.m2.1.1.1.1.1.3.3">𝑜</ci><ci id="alg1.l8.m2.1.1.1.1.1.3.4.cmml" xref="alg1.l8.m2.1.1.1.1.1.3.4">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">agents\_near(p_{mon})</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">italic_a italic_g italic_e italic_n italic_t italic_s _ italic_n italic_e italic_a italic_r ( italic_p start_POSTSUBSCRIPT italic_m italic_o italic_n end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.2.1.1" style="font-size:80%;">9:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l9.3">if</span> all_agents = <math alttext="\emptyset" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mi id="alg1.l9.m1.1.1" mathvariant="normal" xref="alg1.l9.m1.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><emptyset id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">∅</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l9.4">then</span> <span class="ltx_text" id="alg1.l9.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l9.1.m1.1"><semantics id="alg1.l9.1.m1.1a"><mo id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.1b"><ci id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.1.m1.1d">▷</annotation></semantics></math> s has no agents 
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>         failure <math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mo id="alg1.l10.m1.1.1" stretchy="false" xref="alg1.l10.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">←</annotation></semantics></math> random state in s

</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>         <math alttext="\text{perceived}_{scene}" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><msub id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mtext id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2a.cmml">perceived</mtext><mrow id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l11.m1.1.1.3.1" xref="alg1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">c</mi><mo id="alg1.l11.m1.1.1.3.1a" xref="alg1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.3.4" xref="alg1.l11.m1.1.1.3.4.cmml">e</mi><mo id="alg1.l11.m1.1.1.3.1b" xref="alg1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.3.5" xref="alg1.l11.m1.1.1.3.5.cmml">n</mi><mo id="alg1.l11.m1.1.1.3.1c" xref="alg1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.3.6" xref="alg1.l11.m1.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2a.cmml" xref="alg1.l11.m1.1.1.2"><mtext id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">perceived</mtext></ci><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><times id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3.1"></times><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝑠</ci><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝑐</ci><ci id="alg1.l11.m1.1.1.3.4.cmml" xref="alg1.l11.m1.1.1.3.4">𝑒</ci><ci id="alg1.l11.m1.1.1.3.5.cmml" xref="alg1.l11.m1.1.1.3.5">𝑛</ci><ci id="alg1.l11.m1.1.1.3.6.cmml" xref="alg1.l11.m1.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\text{perceived}_{scene}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">perceived start_POSTSUBSCRIPT italic_s italic_c italic_e italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\leftarrow s" class="ltx_Math" display="inline" id="alg1.l11.m2.1"><semantics id="alg1.l11.m2.1a"><mrow id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml"></mi><mo id="alg1.l11.m2.1.1.1" stretchy="false" xref="alg1.l11.m2.1.1.1.cmml">←</mo><mi id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><ci id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1.1">←</ci><csymbol cd="latexml" id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">absent</csymbol><ci id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">\leftarrow s</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m2.1d">← italic_s</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.2.1.1" style="font-size:80%;">12:</span></span>         <math alttext="\text{monitored}_{scene}" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><msub id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mtext id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2a.cmml">monitored</mtext><mrow id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l12.m1.1.1.3.1" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml">c</mi><mo id="alg1.l12.m1.1.1.3.1a" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.3.4" xref="alg1.l12.m1.1.1.3.4.cmml">e</mi><mo id="alg1.l12.m1.1.1.3.1b" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.3.5" xref="alg1.l12.m1.1.1.3.5.cmml">n</mi><mo id="alg1.l12.m1.1.1.3.1c" xref="alg1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.3.6" xref="alg1.l12.m1.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2a.cmml" xref="alg1.l12.m1.1.1.2"><mtext id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">monitored</mtext></ci><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><times id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3.1"></times><ci id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2">𝑠</ci><ci id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3">𝑐</ci><ci id="alg1.l12.m1.1.1.3.4.cmml" xref="alg1.l12.m1.1.1.3.4">𝑒</ci><ci id="alg1.l12.m1.1.1.3.5.cmml" xref="alg1.l12.m1.1.1.3.5">𝑛</ci><ci id="alg1.l12.m1.1.1.3.6.cmml" xref="alg1.l12.m1.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\text{monitored}_{scene}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">monitored start_POSTSUBSCRIPT italic_s italic_c italic_e italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\leftarrow s+\text{failure}" class="ltx_Math" display="inline" id="alg1.l12.m2.1"><semantics id="alg1.l12.m2.1a"><mrow id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><mi id="alg1.l12.m2.1.1.2" xref="alg1.l12.m2.1.1.2.cmml"></mi><mo id="alg1.l12.m2.1.1.1" stretchy="false" xref="alg1.l12.m2.1.1.1.cmml">←</mo><mrow id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml"><mi id="alg1.l12.m2.1.1.3.2" xref="alg1.l12.m2.1.1.3.2.cmml">s</mi><mo id="alg1.l12.m2.1.1.3.1" xref="alg1.l12.m2.1.1.3.1.cmml">+</mo><mtext id="alg1.l12.m2.1.1.3.3" xref="alg1.l12.m2.1.1.3.3a.cmml">failure</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><ci id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1.1">←</ci><csymbol cd="latexml" id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1.2">absent</csymbol><apply id="alg1.l12.m2.1.1.3.cmml" xref="alg1.l12.m2.1.1.3"><plus id="alg1.l12.m2.1.1.3.1.cmml" xref="alg1.l12.m2.1.1.3.1"></plus><ci id="alg1.l12.m2.1.1.3.2.cmml" xref="alg1.l12.m2.1.1.3.2">𝑠</ci><ci id="alg1.l12.m2.1.1.3.3a.cmml" xref="alg1.l12.m2.1.1.3.3"><mtext id="alg1.l12.m2.1.1.3.3.cmml" xref="alg1.l12.m2.1.1.3.3">failure</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">\leftarrow s+\text{failure}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m2.1d">← italic_s + failure</annotation></semantics></math> <span class="ltx_text" id="alg1.l12.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l12.1.m1.1"><semantics id="alg1.l12.1.m1.1a"><mo id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b"><ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.1.m1.1d">▷</annotation></semantics></math> add failure
</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.2.1.1" style="font-size:80%;">13:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l13.3">else</span> <span class="ltx_text ltx_font_bold" id="alg1.l13.4">if</span> nearby_agents <math alttext="=\emptyset" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml"></mi><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">=</mo><mi id="alg1.l13.m1.1.1.3" mathvariant="normal" xref="alg1.l13.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><eq id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></eq><csymbol cd="latexml" id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">absent</csymbol><emptyset id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">=\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">= ∅</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l13.5">then</span> <span class="ltx_text" id="alg1.l13.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l13.1.m1.1"><semantics id="alg1.l13.1.m1.1a"><mo id="alg1.l13.1.m1.1.1" xref="alg1.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l13.1.m1.1b"><ci id="alg1.l13.1.m1.1.1.cmml" xref="alg1.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.1.m1.1d">▷</annotation></semantics></math> No nearby agents 
</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.2.1.1" style="font-size:80%;">14:</span></span>         agent <math alttext="\sim" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mo id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><csymbol cd="latexml" id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">∼</annotation></semantics></math> all_agents <span class="ltx_text" id="alg1.l14.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l14.1.m1.1"><semantics id="alg1.l14.1.m1.1a"><mo id="alg1.l14.1.m1.1.1" xref="alg1.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l14.1.m1.1b"><ci id="alg1.l14.1.m1.1.1.cmml" xref="alg1.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.1.m1.1d">▷</annotation></semantics></math> random sample
</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span>         failure <math alttext="\leftarrow get\_state(agent)" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"></mi><mo id="alg1.l15.m1.1.1.2" stretchy="false" xref="alg1.l15.m1.1.1.2.cmml">←</mo><mrow id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.3" xref="alg1.l15.m1.1.1.1.3.cmml">g</mi><mo id="alg1.l15.m1.1.1.1.2" xref="alg1.l15.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.4" xref="alg1.l15.m1.1.1.1.4.cmml">e</mi><mo id="alg1.l15.m1.1.1.1.2a" xref="alg1.l15.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.5" xref="alg1.l15.m1.1.1.1.5.cmml">t</mi><mo id="alg1.l15.m1.1.1.1.2b" xref="alg1.l15.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.6" mathvariant="normal" xref="alg1.l15.m1.1.1.1.6.cmml">_</mi><mo id="alg1.l15.m1.1.1.1.2c" xref="alg1.l15.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.7" xref="alg1.l15.m1.1.1.1.7.cmml">s</mi><mo id="alg1.l15.m1.1.1.1.2d" xref="alg1.l15.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.8" xref="alg1.l15.m1.1.1.1.8.cmml">t</mi><mo id="alg1.l15.m1.1.1.1.2e" xref="alg1.l15.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.9" xref="alg1.l15.m1.1.1.1.9.cmml">a</mi><mo id="alg1.l15.m1.1.1.1.2f" xref="alg1.l15.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.10" xref="alg1.l15.m1.1.1.1.10.cmml">t</mi><mo id="alg1.l15.m1.1.1.1.2g" xref="alg1.l15.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.11" xref="alg1.l15.m1.1.1.1.11.cmml">e</mi><mo id="alg1.l15.m1.1.1.1.2h" xref="alg1.l15.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l15.m1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l15.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.2.cmml">a</mi><mo id="alg1.l15.m1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.3.cmml">g</mi><mo id="alg1.l15.m1.1.1.1.1.1.1.1a" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.1.1.1.4" xref="alg1.l15.m1.1.1.1.1.1.1.4.cmml">e</mi><mo id="alg1.l15.m1.1.1.1.1.1.1.1b" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.1.1.1.5" xref="alg1.l15.m1.1.1.1.1.1.1.5.cmml">n</mi><mo id="alg1.l15.m1.1.1.1.1.1.1.1c" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l15.m1.1.1.1.1.1.1.6" xref="alg1.l15.m1.1.1.1.1.1.1.6.cmml">t</mi></mrow><mo id="alg1.l15.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">←</ci><csymbol cd="latexml" id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">absent</csymbol><apply id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"><times id="alg1.l15.m1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.2"></times><ci id="alg1.l15.m1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.3">𝑔</ci><ci id="alg1.l15.m1.1.1.1.4.cmml" xref="alg1.l15.m1.1.1.1.4">𝑒</ci><ci id="alg1.l15.m1.1.1.1.5.cmml" xref="alg1.l15.m1.1.1.1.5">𝑡</ci><ci id="alg1.l15.m1.1.1.1.6.cmml" xref="alg1.l15.m1.1.1.1.6">_</ci><ci id="alg1.l15.m1.1.1.1.7.cmml" xref="alg1.l15.m1.1.1.1.7">𝑠</ci><ci id="alg1.l15.m1.1.1.1.8.cmml" xref="alg1.l15.m1.1.1.1.8">𝑡</ci><ci id="alg1.l15.m1.1.1.1.9.cmml" xref="alg1.l15.m1.1.1.1.9">𝑎</ci><ci id="alg1.l15.m1.1.1.1.10.cmml" xref="alg1.l15.m1.1.1.1.10">𝑡</ci><ci id="alg1.l15.m1.1.1.1.11.cmml" xref="alg1.l15.m1.1.1.1.11">𝑒</ci><apply id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1"><times id="alg1.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l15.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.2">𝑎</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.3">𝑔</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.4">𝑒</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.5.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.5">𝑛</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.6.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.6">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\leftarrow get\_state(agent)</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">← italic_g italic_e italic_t _ italic_s italic_t italic_a italic_t italic_e ( italic_a italic_g italic_e italic_n italic_t )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span>         <math alttext="\text{perceived}_{scene}" class="ltx_Math" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><msub id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mtext id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2a.cmml">perceived</mtext><mrow id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.3.2" xref="alg1.l16.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l16.m1.1.1.3.1" xref="alg1.l16.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml">c</mi><mo id="alg1.l16.m1.1.1.3.1a" xref="alg1.l16.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.3.4" xref="alg1.l16.m1.1.1.3.4.cmml">e</mi><mo id="alg1.l16.m1.1.1.3.1b" xref="alg1.l16.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.3.5" xref="alg1.l16.m1.1.1.3.5.cmml">n</mi><mo id="alg1.l16.m1.1.1.3.1c" xref="alg1.l16.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.3.6" xref="alg1.l16.m1.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.2a.cmml" xref="alg1.l16.m1.1.1.2"><mtext id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">perceived</mtext></ci><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><times id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3.1"></times><ci id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2">𝑠</ci><ci id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3">𝑐</ci><ci id="alg1.l16.m1.1.1.3.4.cmml" xref="alg1.l16.m1.1.1.3.4">𝑒</ci><ci id="alg1.l16.m1.1.1.3.5.cmml" xref="alg1.l16.m1.1.1.3.5">𝑛</ci><ci id="alg1.l16.m1.1.1.3.6.cmml" xref="alg1.l16.m1.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\text{perceived}_{scene}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">perceived start_POSTSUBSCRIPT italic_s italic_c italic_e italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\leftarrow s" class="ltx_Math" display="inline" id="alg1.l16.m2.1"><semantics id="alg1.l16.m2.1a"><mrow id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml"><mi id="alg1.l16.m2.1.1.2" xref="alg1.l16.m2.1.1.2.cmml"></mi><mo id="alg1.l16.m2.1.1.1" stretchy="false" xref="alg1.l16.m2.1.1.1.cmml">←</mo><mi id="alg1.l16.m2.1.1.3" xref="alg1.l16.m2.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><apply id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1"><ci id="alg1.l16.m2.1.1.1.cmml" xref="alg1.l16.m2.1.1.1">←</ci><csymbol cd="latexml" id="alg1.l16.m2.1.1.2.cmml" xref="alg1.l16.m2.1.1.2">absent</csymbol><ci id="alg1.l16.m2.1.1.3.cmml" xref="alg1.l16.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">\leftarrow s</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m2.1d">← italic_s</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.2.1.1" style="font-size:80%;">17:</span></span>         <math alttext="\text{monitored}_{scene}" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><msub id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mtext id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2a.cmml">monitored</mtext><mrow id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l17.m1.1.1.3.1" xref="alg1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">c</mi><mo id="alg1.l17.m1.1.1.3.1a" xref="alg1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.3.4" xref="alg1.l17.m1.1.1.3.4.cmml">e</mi><mo id="alg1.l17.m1.1.1.3.1b" xref="alg1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.3.5" xref="alg1.l17.m1.1.1.3.5.cmml">n</mi><mo id="alg1.l17.m1.1.1.3.1c" xref="alg1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.3.6" xref="alg1.l17.m1.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.2a.cmml" xref="alg1.l17.m1.1.1.2"><mtext id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">monitored</mtext></ci><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><times id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3.1"></times><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">𝑠</ci><ci id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3">𝑐</ci><ci id="alg1.l17.m1.1.1.3.4.cmml" xref="alg1.l17.m1.1.1.3.4">𝑒</ci><ci id="alg1.l17.m1.1.1.3.5.cmml" xref="alg1.l17.m1.1.1.3.5">𝑛</ci><ci id="alg1.l17.m1.1.1.3.6.cmml" xref="alg1.l17.m1.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\text{monitored}_{scene}</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">monitored start_POSTSUBSCRIPT italic_s italic_c italic_e italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\leftarrow s+\text{failure}" class="ltx_Math" display="inline" id="alg1.l17.m2.1"><semantics id="alg1.l17.m2.1a"><mrow id="alg1.l17.m2.1.1" xref="alg1.l17.m2.1.1.cmml"><mi id="alg1.l17.m2.1.1.2" xref="alg1.l17.m2.1.1.2.cmml"></mi><mo id="alg1.l17.m2.1.1.1" stretchy="false" xref="alg1.l17.m2.1.1.1.cmml">←</mo><mrow id="alg1.l17.m2.1.1.3" xref="alg1.l17.m2.1.1.3.cmml"><mi id="alg1.l17.m2.1.1.3.2" xref="alg1.l17.m2.1.1.3.2.cmml">s</mi><mo id="alg1.l17.m2.1.1.3.1" xref="alg1.l17.m2.1.1.3.1.cmml">+</mo><mtext id="alg1.l17.m2.1.1.3.3" xref="alg1.l17.m2.1.1.3.3a.cmml">failure</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m2.1b"><apply id="alg1.l17.m2.1.1.cmml" xref="alg1.l17.m2.1.1"><ci id="alg1.l17.m2.1.1.1.cmml" xref="alg1.l17.m2.1.1.1">←</ci><csymbol cd="latexml" id="alg1.l17.m2.1.1.2.cmml" xref="alg1.l17.m2.1.1.2">absent</csymbol><apply id="alg1.l17.m2.1.1.3.cmml" xref="alg1.l17.m2.1.1.3"><plus id="alg1.l17.m2.1.1.3.1.cmml" xref="alg1.l17.m2.1.1.3.1"></plus><ci id="alg1.l17.m2.1.1.3.2.cmml" xref="alg1.l17.m2.1.1.3.2">𝑠</ci><ci id="alg1.l17.m2.1.1.3.3a.cmml" xref="alg1.l17.m2.1.1.3.3"><mtext id="alg1.l17.m2.1.1.3.3.cmml" xref="alg1.l17.m2.1.1.3.3">failure</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m2.1c">\leftarrow s+\text{failure}</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m2.1d">← italic_s + failure</annotation></semantics></math> <span class="ltx_text" id="alg1.l17.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l17.1.m1.1"><semantics id="alg1.l17.1.m1.1a"><mo id="alg1.l17.1.m1.1.1" xref="alg1.l17.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l17.1.m1.1b"><ci id="alg1.l17.1.m1.1.1.cmml" xref="alg1.l17.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.1.m1.1d">▷</annotation></semantics></math> add failure
</span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l18.2">else</span> <span class="ltx_text ltx_font_bold" id="alg1.l18.3">if</span> nearby agents <math alttext="\neq\emptyset" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><mi id="alg1.l18.m1.1.1.2" xref="alg1.l18.m1.1.1.2.cmml"></mi><mo id="alg1.l18.m1.1.1.1" xref="alg1.l18.m1.1.1.1.cmml">≠</mo><mi id="alg1.l18.m1.1.1.3" mathvariant="normal" xref="alg1.l18.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><neq id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1"></neq><csymbol cd="latexml" id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2">absent</csymbol><emptyset id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">\neq\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">≠ ∅</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l18.4">then</span>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.2.1.1" style="font-size:80%;">19:</span></span>         agent <math alttext="\sim" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><mo id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><csymbol cd="latexml" id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">∼</annotation></semantics></math> nearby_agents <span class="ltx_text" id="alg1.l19.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l19.1.m1.1"><semantics id="alg1.l19.1.m1.1a"><mo id="alg1.l19.1.m1.1.1" xref="alg1.l19.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l19.1.m1.1b"><ci id="alg1.l19.1.m1.1.1.cmml" xref="alg1.l19.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.1.m1.1d">▷</annotation></semantics></math> random sample
</span>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">20:</span></span>         failure <math alttext="\leftarrow get\_state(agent)" class="ltx_Math" display="inline" id="alg1.l20.m1.1"><semantics id="alg1.l20.m1.1a"><mrow id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><mi id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml"></mi><mo id="alg1.l20.m1.1.1.2" stretchy="false" xref="alg1.l20.m1.1.1.2.cmml">←</mo><mrow id="alg1.l20.m1.1.1.1" xref="alg1.l20.m1.1.1.1.cmml"><mi id="alg1.l20.m1.1.1.1.3" xref="alg1.l20.m1.1.1.1.3.cmml">g</mi><mo id="alg1.l20.m1.1.1.1.2" xref="alg1.l20.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.4" xref="alg1.l20.m1.1.1.1.4.cmml">e</mi><mo id="alg1.l20.m1.1.1.1.2a" xref="alg1.l20.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.5" xref="alg1.l20.m1.1.1.1.5.cmml">t</mi><mo id="alg1.l20.m1.1.1.1.2b" xref="alg1.l20.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.6" mathvariant="normal" xref="alg1.l20.m1.1.1.1.6.cmml">_</mi><mo id="alg1.l20.m1.1.1.1.2c" xref="alg1.l20.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.7" xref="alg1.l20.m1.1.1.1.7.cmml">s</mi><mo id="alg1.l20.m1.1.1.1.2d" xref="alg1.l20.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.8" xref="alg1.l20.m1.1.1.1.8.cmml">t</mi><mo id="alg1.l20.m1.1.1.1.2e" xref="alg1.l20.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.9" xref="alg1.l20.m1.1.1.1.9.cmml">a</mi><mo id="alg1.l20.m1.1.1.1.2f" xref="alg1.l20.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.10" xref="alg1.l20.m1.1.1.1.10.cmml">t</mi><mo id="alg1.l20.m1.1.1.1.2g" xref="alg1.l20.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.11" xref="alg1.l20.m1.1.1.1.11.cmml">e</mi><mo id="alg1.l20.m1.1.1.1.2h" xref="alg1.l20.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l20.m1.1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l20.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l20.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l20.m1.1.1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l20.m1.1.1.1.1.1.1.2" xref="alg1.l20.m1.1.1.1.1.1.1.2.cmml">a</mi><mo id="alg1.l20.m1.1.1.1.1.1.1.1" xref="alg1.l20.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.1.1.1.3" xref="alg1.l20.m1.1.1.1.1.1.1.3.cmml">g</mi><mo id="alg1.l20.m1.1.1.1.1.1.1.1a" xref="alg1.l20.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.1.1.1.4" xref="alg1.l20.m1.1.1.1.1.1.1.4.cmml">e</mi><mo id="alg1.l20.m1.1.1.1.1.1.1.1b" xref="alg1.l20.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.1.1.1.5" xref="alg1.l20.m1.1.1.1.1.1.1.5.cmml">n</mi><mo id="alg1.l20.m1.1.1.1.1.1.1.1c" xref="alg1.l20.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l20.m1.1.1.1.1.1.1.6" xref="alg1.l20.m1.1.1.1.1.1.1.6.cmml">t</mi></mrow><mo id="alg1.l20.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l20.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><ci id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2">←</ci><csymbol cd="latexml" id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3">absent</csymbol><apply id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1"><times id="alg1.l20.m1.1.1.1.2.cmml" xref="alg1.l20.m1.1.1.1.2"></times><ci id="alg1.l20.m1.1.1.1.3.cmml" xref="alg1.l20.m1.1.1.1.3">𝑔</ci><ci id="alg1.l20.m1.1.1.1.4.cmml" xref="alg1.l20.m1.1.1.1.4">𝑒</ci><ci id="alg1.l20.m1.1.1.1.5.cmml" xref="alg1.l20.m1.1.1.1.5">𝑡</ci><ci id="alg1.l20.m1.1.1.1.6.cmml" xref="alg1.l20.m1.1.1.1.6">_</ci><ci id="alg1.l20.m1.1.1.1.7.cmml" xref="alg1.l20.m1.1.1.1.7">𝑠</ci><ci id="alg1.l20.m1.1.1.1.8.cmml" xref="alg1.l20.m1.1.1.1.8">𝑡</ci><ci id="alg1.l20.m1.1.1.1.9.cmml" xref="alg1.l20.m1.1.1.1.9">𝑎</ci><ci id="alg1.l20.m1.1.1.1.10.cmml" xref="alg1.l20.m1.1.1.1.10">𝑡</ci><ci id="alg1.l20.m1.1.1.1.11.cmml" xref="alg1.l20.m1.1.1.1.11">𝑒</ci><apply id="alg1.l20.m1.1.1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1.1"><times id="alg1.l20.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l20.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l20.m1.1.1.1.1.1.1.2">𝑎</ci><ci id="alg1.l20.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l20.m1.1.1.1.1.1.1.3">𝑔</ci><ci id="alg1.l20.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l20.m1.1.1.1.1.1.1.4">𝑒</ci><ci id="alg1.l20.m1.1.1.1.1.1.1.5.cmml" xref="alg1.l20.m1.1.1.1.1.1.1.5">𝑛</ci><ci id="alg1.l20.m1.1.1.1.1.1.1.6.cmml" xref="alg1.l20.m1.1.1.1.1.1.1.6">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">\leftarrow get\_state(agent)</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m1.1d">← italic_g italic_e italic_t _ italic_s italic_t italic_a italic_t italic_e ( italic_a italic_g italic_e italic_n italic_t )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l21.2.1.1" style="font-size:80%;">21:</span></span>         <math alttext="\text{perceived}_{scene}" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><msub id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mtext id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2a.cmml">perceived</mtext><mrow id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml"><mi id="alg1.l21.m1.1.1.3.2" xref="alg1.l21.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l21.m1.1.1.3.1" xref="alg1.l21.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.1.3.3" xref="alg1.l21.m1.1.1.3.3.cmml">c</mi><mo id="alg1.l21.m1.1.1.3.1a" xref="alg1.l21.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.1.3.4" xref="alg1.l21.m1.1.1.3.4.cmml">e</mi><mo id="alg1.l21.m1.1.1.3.1b" xref="alg1.l21.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.1.3.5" xref="alg1.l21.m1.1.1.3.5.cmml">n</mi><mo id="alg1.l21.m1.1.1.3.1c" xref="alg1.l21.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l21.m1.1.1.3.6" xref="alg1.l21.m1.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1">subscript</csymbol><ci id="alg1.l21.m1.1.1.2a.cmml" xref="alg1.l21.m1.1.1.2"><mtext id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">perceived</mtext></ci><apply id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3"><times id="alg1.l21.m1.1.1.3.1.cmml" xref="alg1.l21.m1.1.1.3.1"></times><ci id="alg1.l21.m1.1.1.3.2.cmml" xref="alg1.l21.m1.1.1.3.2">𝑠</ci><ci id="alg1.l21.m1.1.1.3.3.cmml" xref="alg1.l21.m1.1.1.3.3">𝑐</ci><ci id="alg1.l21.m1.1.1.3.4.cmml" xref="alg1.l21.m1.1.1.3.4">𝑒</ci><ci id="alg1.l21.m1.1.1.3.5.cmml" xref="alg1.l21.m1.1.1.3.5">𝑛</ci><ci id="alg1.l21.m1.1.1.3.6.cmml" xref="alg1.l21.m1.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">\text{perceived}_{scene}</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">perceived start_POSTSUBSCRIPT italic_s italic_c italic_e italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\leftarrow s-agent" class="ltx_Math" display="inline" id="alg1.l21.m2.1"><semantics id="alg1.l21.m2.1a"><mrow id="alg1.l21.m2.1.1" xref="alg1.l21.m2.1.1.cmml"><mi id="alg1.l21.m2.1.1.2" xref="alg1.l21.m2.1.1.2.cmml"></mi><mo id="alg1.l21.m2.1.1.1" stretchy="false" xref="alg1.l21.m2.1.1.1.cmml">←</mo><mrow id="alg1.l21.m2.1.1.3" xref="alg1.l21.m2.1.1.3.cmml"><mi id="alg1.l21.m2.1.1.3.2" xref="alg1.l21.m2.1.1.3.2.cmml">s</mi><mo id="alg1.l21.m2.1.1.3.1" xref="alg1.l21.m2.1.1.3.1.cmml">−</mo><mrow id="alg1.l21.m2.1.1.3.3" xref="alg1.l21.m2.1.1.3.3.cmml"><mi id="alg1.l21.m2.1.1.3.3.2" xref="alg1.l21.m2.1.1.3.3.2.cmml">a</mi><mo id="alg1.l21.m2.1.1.3.3.1" xref="alg1.l21.m2.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l21.m2.1.1.3.3.3" xref="alg1.l21.m2.1.1.3.3.3.cmml">g</mi><mo id="alg1.l21.m2.1.1.3.3.1a" xref="alg1.l21.m2.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l21.m2.1.1.3.3.4" xref="alg1.l21.m2.1.1.3.3.4.cmml">e</mi><mo id="alg1.l21.m2.1.1.3.3.1b" xref="alg1.l21.m2.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l21.m2.1.1.3.3.5" xref="alg1.l21.m2.1.1.3.3.5.cmml">n</mi><mo id="alg1.l21.m2.1.1.3.3.1c" xref="alg1.l21.m2.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l21.m2.1.1.3.3.6" xref="alg1.l21.m2.1.1.3.3.6.cmml">t</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.1b"><apply id="alg1.l21.m2.1.1.cmml" xref="alg1.l21.m2.1.1"><ci id="alg1.l21.m2.1.1.1.cmml" xref="alg1.l21.m2.1.1.1">←</ci><csymbol cd="latexml" id="alg1.l21.m2.1.1.2.cmml" xref="alg1.l21.m2.1.1.2">absent</csymbol><apply id="alg1.l21.m2.1.1.3.cmml" xref="alg1.l21.m2.1.1.3"><minus id="alg1.l21.m2.1.1.3.1.cmml" xref="alg1.l21.m2.1.1.3.1"></minus><ci id="alg1.l21.m2.1.1.3.2.cmml" xref="alg1.l21.m2.1.1.3.2">𝑠</ci><apply id="alg1.l21.m2.1.1.3.3.cmml" xref="alg1.l21.m2.1.1.3.3"><times id="alg1.l21.m2.1.1.3.3.1.cmml" xref="alg1.l21.m2.1.1.3.3.1"></times><ci id="alg1.l21.m2.1.1.3.3.2.cmml" xref="alg1.l21.m2.1.1.3.3.2">𝑎</ci><ci id="alg1.l21.m2.1.1.3.3.3.cmml" xref="alg1.l21.m2.1.1.3.3.3">𝑔</ci><ci id="alg1.l21.m2.1.1.3.3.4.cmml" xref="alg1.l21.m2.1.1.3.3.4">𝑒</ci><ci id="alg1.l21.m2.1.1.3.3.5.cmml" xref="alg1.l21.m2.1.1.3.3.5">𝑛</ci><ci id="alg1.l21.m2.1.1.3.3.6.cmml" xref="alg1.l21.m2.1.1.3.3.6">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.1c">\leftarrow s-agent</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m2.1d">← italic_s - italic_a italic_g italic_e italic_n italic_t</annotation></semantics></math> <span class="ltx_text" id="alg1.l21.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l21.1.m1.1"><semantics id="alg1.l21.1.m1.1a"><mo id="alg1.l21.1.m1.1.1" xref="alg1.l21.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l21.1.m1.1b"><ci id="alg1.l21.1.m1.1.1.cmml" xref="alg1.l21.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.1.m1.1d">▷</annotation></semantics></math> remove agent
</span>
</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l22.1.1.1" style="font-size:80%;">22:</span></span>         <math alttext="\text{monitored}_{scene}" class="ltx_Math" display="inline" id="alg1.l22.m1.1"><semantics id="alg1.l22.m1.1a"><msub id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><mtext id="alg1.l22.m1.1.1.2" xref="alg1.l22.m1.1.1.2a.cmml">monitored</mtext><mrow id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml"><mi id="alg1.l22.m1.1.1.3.2" xref="alg1.l22.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l22.m1.1.1.3.1" xref="alg1.l22.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l22.m1.1.1.3.3" xref="alg1.l22.m1.1.1.3.3.cmml">c</mi><mo id="alg1.l22.m1.1.1.3.1a" xref="alg1.l22.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l22.m1.1.1.3.4" xref="alg1.l22.m1.1.1.3.4.cmml">e</mi><mo id="alg1.l22.m1.1.1.3.1b" xref="alg1.l22.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l22.m1.1.1.3.5" xref="alg1.l22.m1.1.1.3.5.cmml">n</mi><mo id="alg1.l22.m1.1.1.3.1c" xref="alg1.l22.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l22.m1.1.1.3.6" xref="alg1.l22.m1.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1">subscript</csymbol><ci id="alg1.l22.m1.1.1.2a.cmml" xref="alg1.l22.m1.1.1.2"><mtext id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1.2">monitored</mtext></ci><apply id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3"><times id="alg1.l22.m1.1.1.3.1.cmml" xref="alg1.l22.m1.1.1.3.1"></times><ci id="alg1.l22.m1.1.1.3.2.cmml" xref="alg1.l22.m1.1.1.3.2">𝑠</ci><ci id="alg1.l22.m1.1.1.3.3.cmml" xref="alg1.l22.m1.1.1.3.3">𝑐</ci><ci id="alg1.l22.m1.1.1.3.4.cmml" xref="alg1.l22.m1.1.1.3.4">𝑒</ci><ci id="alg1.l22.m1.1.1.3.5.cmml" xref="alg1.l22.m1.1.1.3.5">𝑛</ci><ci id="alg1.l22.m1.1.1.3.6.cmml" xref="alg1.l22.m1.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">\text{monitored}_{scene}</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m1.1d">monitored start_POSTSUBSCRIPT italic_s italic_c italic_e italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math> <math alttext="\leftarrow s" class="ltx_Math" display="inline" id="alg1.l22.m2.1"><semantics id="alg1.l22.m2.1a"><mrow id="alg1.l22.m2.1.1" xref="alg1.l22.m2.1.1.cmml"><mi id="alg1.l22.m2.1.1.2" xref="alg1.l22.m2.1.1.2.cmml"></mi><mo id="alg1.l22.m2.1.1.1" stretchy="false" xref="alg1.l22.m2.1.1.1.cmml">←</mo><mi id="alg1.l22.m2.1.1.3" xref="alg1.l22.m2.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m2.1b"><apply id="alg1.l22.m2.1.1.cmml" xref="alg1.l22.m2.1.1"><ci id="alg1.l22.m2.1.1.1.cmml" xref="alg1.l22.m2.1.1.1">←</ci><csymbol cd="latexml" id="alg1.l22.m2.1.1.2.cmml" xref="alg1.l22.m2.1.1.2">absent</csymbol><ci id="alg1.l22.m2.1.1.3.cmml" xref="alg1.l22.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m2.1c">\leftarrow s</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m2.1d">← italic_s</annotation></semantics></math>
     
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l23.1.1.1" style="font-size:80%;">23:</span></span>     plans <math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.l23.m1.1"><semantics id="alg1.l23.m1.1a"><mo id="alg1.l23.m1.1.1" stretchy="false" xref="alg1.l23.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><ci id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m1.1d">←</annotation></semantics></math> <math alttext="Plan" class="ltx_Math" display="inline" id="alg1.l23.m2.1"><semantics id="alg1.l23.m2.1a"><mrow id="alg1.l23.m2.1.1" xref="alg1.l23.m2.1.1.cmml"><mi id="alg1.l23.m2.1.1.2" xref="alg1.l23.m2.1.1.2.cmml">P</mi><mo id="alg1.l23.m2.1.1.1" xref="alg1.l23.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l23.m2.1.1.3" xref="alg1.l23.m2.1.1.3.cmml">l</mi><mo id="alg1.l23.m2.1.1.1a" xref="alg1.l23.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l23.m2.1.1.4" xref="alg1.l23.m2.1.1.4.cmml">a</mi><mo id="alg1.l23.m2.1.1.1b" xref="alg1.l23.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l23.m2.1.1.5" xref="alg1.l23.m2.1.1.5.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m2.1b"><apply id="alg1.l23.m2.1.1.cmml" xref="alg1.l23.m2.1.1"><times id="alg1.l23.m2.1.1.1.cmml" xref="alg1.l23.m2.1.1.1"></times><ci id="alg1.l23.m2.1.1.2.cmml" xref="alg1.l23.m2.1.1.2">𝑃</ci><ci id="alg1.l23.m2.1.1.3.cmml" xref="alg1.l23.m2.1.1.3">𝑙</ci><ci id="alg1.l23.m2.1.1.4.cmml" xref="alg1.l23.m2.1.1.4">𝑎</ci><ci id="alg1.l23.m2.1.1.5.cmml" xref="alg1.l23.m2.1.1.5">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m2.1c">Plan</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m2.1d">italic_P italic_l italic_a italic_n</annotation></semantics></math>(<math alttext="\text{perceived}_{scene}" class="ltx_Math" display="inline" id="alg1.l23.m3.1"><semantics id="alg1.l23.m3.1a"><msub id="alg1.l23.m3.1.1" xref="alg1.l23.m3.1.1.cmml"><mtext id="alg1.l23.m3.1.1.2" xref="alg1.l23.m3.1.1.2a.cmml">perceived</mtext><mrow id="alg1.l23.m3.1.1.3" xref="alg1.l23.m3.1.1.3.cmml"><mi id="alg1.l23.m3.1.1.3.2" xref="alg1.l23.m3.1.1.3.2.cmml">s</mi><mo id="alg1.l23.m3.1.1.3.1" xref="alg1.l23.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l23.m3.1.1.3.3" xref="alg1.l23.m3.1.1.3.3.cmml">c</mi><mo id="alg1.l23.m3.1.1.3.1a" xref="alg1.l23.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l23.m3.1.1.3.4" xref="alg1.l23.m3.1.1.3.4.cmml">e</mi><mo id="alg1.l23.m3.1.1.3.1b" xref="alg1.l23.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l23.m3.1.1.3.5" xref="alg1.l23.m3.1.1.3.5.cmml">n</mi><mo id="alg1.l23.m3.1.1.3.1c" xref="alg1.l23.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l23.m3.1.1.3.6" xref="alg1.l23.m3.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l23.m3.1b"><apply id="alg1.l23.m3.1.1.cmml" xref="alg1.l23.m3.1.1"><csymbol cd="ambiguous" id="alg1.l23.m3.1.1.1.cmml" xref="alg1.l23.m3.1.1">subscript</csymbol><ci id="alg1.l23.m3.1.1.2a.cmml" xref="alg1.l23.m3.1.1.2"><mtext id="alg1.l23.m3.1.1.2.cmml" xref="alg1.l23.m3.1.1.2">perceived</mtext></ci><apply id="alg1.l23.m3.1.1.3.cmml" xref="alg1.l23.m3.1.1.3"><times id="alg1.l23.m3.1.1.3.1.cmml" xref="alg1.l23.m3.1.1.3.1"></times><ci id="alg1.l23.m3.1.1.3.2.cmml" xref="alg1.l23.m3.1.1.3.2">𝑠</ci><ci id="alg1.l23.m3.1.1.3.3.cmml" xref="alg1.l23.m3.1.1.3.3">𝑐</ci><ci id="alg1.l23.m3.1.1.3.4.cmml" xref="alg1.l23.m3.1.1.3.4">𝑒</ci><ci id="alg1.l23.m3.1.1.3.5.cmml" xref="alg1.l23.m3.1.1.3.5">𝑛</ci><ci id="alg1.l23.m3.1.1.3.6.cmml" xref="alg1.l23.m3.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m3.1c">\text{perceived}_{scene}</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m3.1d">perceived start_POSTSUBSCRIPT italic_s italic_c italic_e italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math>) 

</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l24.1.1.1" style="font-size:80%;">24:</span></span>     label <math alttext="\leftarrow" class="ltx_Math" display="inline" id="alg1.l24.m1.1"><semantics id="alg1.l24.m1.1a"><mo id="alg1.l24.m1.1.1" stretchy="false" xref="alg1.l24.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><ci id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m1.1d">←</annotation></semantics></math> <math alttext="Evaluate" class="ltx_Math" display="inline" id="alg1.l24.m2.1"><semantics id="alg1.l24.m2.1a"><mrow id="alg1.l24.m2.1.1" xref="alg1.l24.m2.1.1.cmml"><mi id="alg1.l24.m2.1.1.2" xref="alg1.l24.m2.1.1.2.cmml">E</mi><mo id="alg1.l24.m2.1.1.1" xref="alg1.l24.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l24.m2.1.1.3" xref="alg1.l24.m2.1.1.3.cmml">v</mi><mo id="alg1.l24.m2.1.1.1a" xref="alg1.l24.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l24.m2.1.1.4" xref="alg1.l24.m2.1.1.4.cmml">a</mi><mo id="alg1.l24.m2.1.1.1b" xref="alg1.l24.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l24.m2.1.1.5" xref="alg1.l24.m2.1.1.5.cmml">l</mi><mo id="alg1.l24.m2.1.1.1c" xref="alg1.l24.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l24.m2.1.1.6" xref="alg1.l24.m2.1.1.6.cmml">u</mi><mo id="alg1.l24.m2.1.1.1d" xref="alg1.l24.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l24.m2.1.1.7" xref="alg1.l24.m2.1.1.7.cmml">a</mi><mo id="alg1.l24.m2.1.1.1e" xref="alg1.l24.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l24.m2.1.1.8" xref="alg1.l24.m2.1.1.8.cmml">t</mi><mo id="alg1.l24.m2.1.1.1f" xref="alg1.l24.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l24.m2.1.1.9" xref="alg1.l24.m2.1.1.9.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m2.1b"><apply id="alg1.l24.m2.1.1.cmml" xref="alg1.l24.m2.1.1"><times id="alg1.l24.m2.1.1.1.cmml" xref="alg1.l24.m2.1.1.1"></times><ci id="alg1.l24.m2.1.1.2.cmml" xref="alg1.l24.m2.1.1.2">𝐸</ci><ci id="alg1.l24.m2.1.1.3.cmml" xref="alg1.l24.m2.1.1.3">𝑣</ci><ci id="alg1.l24.m2.1.1.4.cmml" xref="alg1.l24.m2.1.1.4">𝑎</ci><ci id="alg1.l24.m2.1.1.5.cmml" xref="alg1.l24.m2.1.1.5">𝑙</ci><ci id="alg1.l24.m2.1.1.6.cmml" xref="alg1.l24.m2.1.1.6">𝑢</ci><ci id="alg1.l24.m2.1.1.7.cmml" xref="alg1.l24.m2.1.1.7">𝑎</ci><ci id="alg1.l24.m2.1.1.8.cmml" xref="alg1.l24.m2.1.1.8">𝑡</ci><ci id="alg1.l24.m2.1.1.9.cmml" xref="alg1.l24.m2.1.1.9">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m2.1c">Evaluate</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m2.1d">italic_E italic_v italic_a italic_l italic_u italic_a italic_t italic_e</annotation></semantics></math>(plans, <math alttext="\text{monitored}_{scene}" class="ltx_Math" display="inline" id="alg1.l24.m3.1"><semantics id="alg1.l24.m3.1a"><msub id="alg1.l24.m3.1.1" xref="alg1.l24.m3.1.1.cmml"><mtext id="alg1.l24.m3.1.1.2" xref="alg1.l24.m3.1.1.2a.cmml">monitored</mtext><mrow id="alg1.l24.m3.1.1.3" xref="alg1.l24.m3.1.1.3.cmml"><mi id="alg1.l24.m3.1.1.3.2" xref="alg1.l24.m3.1.1.3.2.cmml">s</mi><mo id="alg1.l24.m3.1.1.3.1" xref="alg1.l24.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l24.m3.1.1.3.3" xref="alg1.l24.m3.1.1.3.3.cmml">c</mi><mo id="alg1.l24.m3.1.1.3.1a" xref="alg1.l24.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l24.m3.1.1.3.4" xref="alg1.l24.m3.1.1.3.4.cmml">e</mi><mo id="alg1.l24.m3.1.1.3.1b" xref="alg1.l24.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l24.m3.1.1.3.5" xref="alg1.l24.m3.1.1.3.5.cmml">n</mi><mo id="alg1.l24.m3.1.1.3.1c" xref="alg1.l24.m3.1.1.3.1.cmml">⁢</mo><mi id="alg1.l24.m3.1.1.3.6" xref="alg1.l24.m3.1.1.3.6.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l24.m3.1b"><apply id="alg1.l24.m3.1.1.cmml" xref="alg1.l24.m3.1.1"><csymbol cd="ambiguous" id="alg1.l24.m3.1.1.1.cmml" xref="alg1.l24.m3.1.1">subscript</csymbol><ci id="alg1.l24.m3.1.1.2a.cmml" xref="alg1.l24.m3.1.1.2"><mtext id="alg1.l24.m3.1.1.2.cmml" xref="alg1.l24.m3.1.1.2">monitored</mtext></ci><apply id="alg1.l24.m3.1.1.3.cmml" xref="alg1.l24.m3.1.1.3"><times id="alg1.l24.m3.1.1.3.1.cmml" xref="alg1.l24.m3.1.1.3.1"></times><ci id="alg1.l24.m3.1.1.3.2.cmml" xref="alg1.l24.m3.1.1.3.2">𝑠</ci><ci id="alg1.l24.m3.1.1.3.3.cmml" xref="alg1.l24.m3.1.1.3.3">𝑐</ci><ci id="alg1.l24.m3.1.1.3.4.cmml" xref="alg1.l24.m3.1.1.3.4">𝑒</ci><ci id="alg1.l24.m3.1.1.3.5.cmml" xref="alg1.l24.m3.1.1.3.5">𝑛</ci><ci id="alg1.l24.m3.1.1.3.6.cmml" xref="alg1.l24.m3.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m3.1c">\text{monitored}_{scene}</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m3.1d">monitored start_POSTSUBSCRIPT italic_s italic_c italic_e italic_n italic_e end_POSTSUBSCRIPT</annotation></semantics></math>) 

</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l25.1.1.1" style="font-size:80%;">25:</span></span>     <math alttext="\mathcal{D}\leftarrow\mathcal{D}\cup\left\{\text{($\text{perceived}_{scene}$, %
failure, plans, label)}\right\}" class="ltx_Math" display="inline" id="alg1.l25.m1.1"><semantics id="alg1.l25.m1.1a"><mrow id="alg1.l25.m1.1.2" xref="alg1.l25.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l25.m1.1.2.2" xref="alg1.l25.m1.1.2.2.cmml">𝒟</mi><mo id="alg1.l25.m1.1.2.1" stretchy="false" xref="alg1.l25.m1.1.2.1.cmml">←</mo><mrow id="alg1.l25.m1.1.2.3" xref="alg1.l25.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l25.m1.1.2.3.2" xref="alg1.l25.m1.1.2.3.2.cmml">𝒟</mi><mo id="alg1.l25.m1.1.2.3.1" xref="alg1.l25.m1.1.2.3.1.cmml">∪</mo><mrow id="alg1.l25.m1.1.2.3.3.2" xref="alg1.l25.m1.1.2.3.3.1.cmml"><mo id="alg1.l25.m1.1.2.3.3.2.1" xref="alg1.l25.m1.1.2.3.3.1.cmml">{</mo><mrow id="alg1.l25.m1.1.1.1" xref="alg1.l25.m1.1.1.1c.cmml"><mtext id="alg1.l25.m1.1.1.1a" xref="alg1.l25.m1.1.1.1c.cmml">(</mtext><msub id="alg1.l25.m1.1.1.1.m1.1.1" xref="alg1.l25.m1.1.1.1.m1.1.1.cmml"><mtext id="alg1.l25.m1.1.1.1.m1.1.1.2" xref="alg1.l25.m1.1.1.1.m1.1.1.2.cmml">perceived</mtext><mrow id="alg1.l25.m1.1.1.1.m1.1.1.3" xref="alg1.l25.m1.1.1.1.m1.1.1.3.cmml"><mi id="alg1.l25.m1.1.1.1.m1.1.1.3.2" xref="alg1.l25.m1.1.1.1.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l25.m1.1.1.1.m1.1.1.3.1" xref="alg1.l25.m1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l25.m1.1.1.1.m1.1.1.3.3" xref="alg1.l25.m1.1.1.1.m1.1.1.3.3.cmml">c</mi><mo id="alg1.l25.m1.1.1.1.m1.1.1.3.1a" xref="alg1.l25.m1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l25.m1.1.1.1.m1.1.1.3.4" xref="alg1.l25.m1.1.1.1.m1.1.1.3.4.cmml">e</mi><mo id="alg1.l25.m1.1.1.1.m1.1.1.3.1b" xref="alg1.l25.m1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l25.m1.1.1.1.m1.1.1.3.5" xref="alg1.l25.m1.1.1.1.m1.1.1.3.5.cmml">n</mi><mo id="alg1.l25.m1.1.1.1.m1.1.1.3.1c" xref="alg1.l25.m1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l25.m1.1.1.1.m1.1.1.3.6" xref="alg1.l25.m1.1.1.1.m1.1.1.3.6.cmml">e</mi></mrow></msub><mtext id="alg1.l25.m1.1.1.1b" xref="alg1.l25.m1.1.1.1c.cmml">, failure, plans, label)</mtext></mrow><mo id="alg1.l25.m1.1.2.3.3.2.2" xref="alg1.l25.m1.1.2.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><apply id="alg1.l25.m1.1.2.cmml" xref="alg1.l25.m1.1.2"><ci id="alg1.l25.m1.1.2.1.cmml" xref="alg1.l25.m1.1.2.1">←</ci><ci id="alg1.l25.m1.1.2.2.cmml" xref="alg1.l25.m1.1.2.2">𝒟</ci><apply id="alg1.l25.m1.1.2.3.cmml" xref="alg1.l25.m1.1.2.3"><union id="alg1.l25.m1.1.2.3.1.cmml" xref="alg1.l25.m1.1.2.3.1"></union><ci id="alg1.l25.m1.1.2.3.2.cmml" xref="alg1.l25.m1.1.2.3.2">𝒟</ci><set id="alg1.l25.m1.1.2.3.3.1.cmml" xref="alg1.l25.m1.1.2.3.3.2"><ci id="alg1.l25.m1.1.1.1c.cmml" xref="alg1.l25.m1.1.1.1"><mrow id="alg1.l25.m1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1"><mtext id="alg1.l25.m1.1.1.1a.cmml" xref="alg1.l25.m1.1.1.1">(</mtext><msub id="alg1.l25.m1.1.1.1.m1.1.1.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1"><mtext id="alg1.l25.m1.1.1.1.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1.2">perceived</mtext><mrow id="alg1.l25.m1.1.1.1.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1.3"><mi id="alg1.l25.m1.1.1.1.m1.1.1.3.2.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1.3.2">s</mi><mo id="alg1.l25.m1.1.1.1.m1.1.1.3.1.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1.3.1">⁢</mo><mi id="alg1.l25.m1.1.1.1.m1.1.1.3.3.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1.3.3">c</mi><mo id="alg1.l25.m1.1.1.1.m1.1.1.3.1a.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1.3.1">⁢</mo><mi id="alg1.l25.m1.1.1.1.m1.1.1.3.4.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1.3.4">e</mi><mo id="alg1.l25.m1.1.1.1.m1.1.1.3.1b.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1.3.1">⁢</mo><mi id="alg1.l25.m1.1.1.1.m1.1.1.3.5.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1.3.5">n</mi><mo id="alg1.l25.m1.1.1.1.m1.1.1.3.1c.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1.3.1">⁢</mo><mi id="alg1.l25.m1.1.1.1.m1.1.1.3.6.cmml" xref="alg1.l25.m1.1.1.1.m1.1.1.3.6">e</mi></mrow></msub><mtext id="alg1.l25.m1.1.1.1b.cmml" xref="alg1.l25.m1.1.1.1">, failure, plans, label)</mtext></mrow></ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">\mathcal{D}\leftarrow\mathcal{D}\cup\left\{\text{($\text{perceived}_{scene}$, %
failure, plans, label)}\right\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m1.1d">caligraphic_D ← caligraphic_D ∪ { ( perceived start_POSTSUBSCRIPT italic_s italic_c italic_e italic_n italic_e end_POSTSUBSCRIPT , failure, plans, label) }</annotation></semantics></math>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS5.5.1.1">V-E</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS5.6.2">Recovery Planning</span>
</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">Unlike the modular pipeline presented in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S1.F2" title="Figure 2 ‣ I Introduction ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">2</span></a>, SPARQ can produce safety evaluation as well as a recovery plan simultaneously. Owing to the ability to parallelize computations in a neural network, SPARQ allows us to evaluate a batch of proposed plans including the candidate ego plan under the monitor input in a single forward pass of the network. The candidate plans can either be generated for this purpose online or alternate plan candidates can directly be ported over from the original planner. In this paper, we use the trajectory tree generator from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib28" title="">28</a>]</cite> which leverages the differential flatness of vehicular dynamics and GPU parallelization to rapidly produce the tree during run-time. If the candidate ego plan is evaluated as unsafe, we perform plan repair by using one of the proposed plans in the batch that are deemed to be safe by SPARQ, otherwise we return the candidate plan as our safe plan. Since SPARQ incorporates the effects of perception failures, any plan classified as safe by the network is robust to the input perception failures.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span class="ltx_text ltx_font_smallcaps" id="S6.1.1">Experimental Results and Discussion</span>
</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this section, we demonstrate the following key findings: (i) SPARQ outperforms the reachability-based baseline on all metrics demonstrating better balance of safety and performance; (ii) in lieu of perception errors, SPARQ acts as a general-purpose safety filter; and (iii) SPARQ is run-time capable with an operating frequency of <math alttext="\sim" class="ltx_Math" display="inline" id="S6.p1.1.m1.1"><semantics id="S6.p1.1.m1.1a"><mo id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><csymbol cd="latexml" id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.m1.1d">∼</annotation></semantics></math>42 Hz.</p>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS1.5.1.1">VI-A</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS1.6.2">Test Datasets and Scenarios</span>
</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.3">We use the nuPlan-Vegas dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib6" title="">6</a>]</cite> to showcase our proposed approach. Each data sample has been modified to include a perception failure detected by the monitor. Since the base planner is unaware of this failure, the reward of the planned trajectories may degrade due to the modification.
We sample two sets of 60K scenarios from the dataset; for each scene, we introduce approximately 25 failures for the first set, and 1 failure per scene for the second set, resulting in a total of <span class="ltx_text ltx_font_bold" id="S6.SS1.p1.3.1">1.5M</span> monitored scenes for the entire training set.
We re-evaluate the candidate plans to obtain the reward on the monitored scene, as mentioned before, and categorize each plan into one of three classes based on the reward range: Safe (reward <math alttext="&gt;225" class="ltx_Math" display="inline" id="S6.SS1.p1.1.m1.1"><semantics id="S6.SS1.p1.1.m1.1a"><mrow id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml"><mi id="S6.SS1.p1.1.m1.1.1.2" xref="S6.SS1.p1.1.m1.1.1.2.cmml"></mi><mo id="S6.SS1.p1.1.m1.1.1.1" xref="S6.SS1.p1.1.m1.1.1.1.cmml">&gt;</mo><mn id="S6.SS1.p1.1.m1.1.1.3" xref="S6.SS1.p1.1.m1.1.1.3.cmml">225</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b"><apply id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1"><gt id="S6.SS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S6.SS1.p1.1.m1.1.1.2.cmml" xref="S6.SS1.p1.1.m1.1.1.2">absent</csymbol><cn id="S6.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS1.p1.1.m1.1.1.3">225</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">&gt;225</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.1.m1.1d">&gt; 225</annotation></semantics></math>), Risky (reward <math alttext="150-225" class="ltx_Math" display="inline" id="S6.SS1.p1.2.m2.1"><semantics id="S6.SS1.p1.2.m2.1a"><mrow id="S6.SS1.p1.2.m2.1.1" xref="S6.SS1.p1.2.m2.1.1.cmml"><mn id="S6.SS1.p1.2.m2.1.1.2" xref="S6.SS1.p1.2.m2.1.1.2.cmml">150</mn><mo id="S6.SS1.p1.2.m2.1.1.1" xref="S6.SS1.p1.2.m2.1.1.1.cmml">−</mo><mn id="S6.SS1.p1.2.m2.1.1.3" xref="S6.SS1.p1.2.m2.1.1.3.cmml">225</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.1b"><apply id="S6.SS1.p1.2.m2.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1"><minus id="S6.SS1.p1.2.m2.1.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1.1"></minus><cn id="S6.SS1.p1.2.m2.1.1.2.cmml" type="integer" xref="S6.SS1.p1.2.m2.1.1.2">150</cn><cn id="S6.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S6.SS1.p1.2.m2.1.1.3">225</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.1c">150-225</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.2.m2.1d">150 - 225</annotation></semantics></math>), and Safety-Critical (reward <math alttext="&lt;150" class="ltx_Math" display="inline" id="S6.SS1.p1.3.m3.1"><semantics id="S6.SS1.p1.3.m3.1a"><mrow id="S6.SS1.p1.3.m3.1.1" xref="S6.SS1.p1.3.m3.1.1.cmml"><mi id="S6.SS1.p1.3.m3.1.1.2" xref="S6.SS1.p1.3.m3.1.1.2.cmml"></mi><mo id="S6.SS1.p1.3.m3.1.1.1" xref="S6.SS1.p1.3.m3.1.1.1.cmml">&lt;</mo><mn id="S6.SS1.p1.3.m3.1.1.3" xref="S6.SS1.p1.3.m3.1.1.3.cmml">150</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.3.m3.1b"><apply id="S6.SS1.p1.3.m3.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1"><lt id="S6.SS1.p1.3.m3.1.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1.1"></lt><csymbol cd="latexml" id="S6.SS1.p1.3.m3.1.1.2.cmml" xref="S6.SS1.p1.3.m3.1.1.2">absent</csymbol><cn id="S6.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S6.SS1.p1.3.m3.1.1.3">150</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.3.m3.1c">&lt;150</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.3.m3.1d">&lt; 150</annotation></semantics></math>).</p>
</div>
<figure class="ltx_figure" id="S6.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="231" id="S6.F5.g1" src="extracted/5904926/figures/reward_distribution.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F5.3.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S6.F5.4.2" style="font-size:90%;">Dataset Reward Distribution.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1">These boundaries were determined by analyzing the raw reward distribution in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.F5" title="Figure 5 ‣ VI-A Test Datasets and Scenarios ‣ VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">5</span></a>.
At runtime, we incorporate the perception monitor’s input and utilize SPARQ to estimate the safety classification of the plans under the monitored scene, offering alternative plans as a repair strategy when necessary.
The network only has access to the original perceived scene, the state of the missing agent as the failure information, and the plan to be evaluated.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS2.5.1.1">VI-B</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS2.6.2">Baseline: Hamilton Jacobi Reachability</span>
</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">We compare our approach to different flavours of reachability-based baselines with increasing level of conservativeness. These baselines are chosen to prioritize the safety of the AV and assess the effect of safety over the performance when compared to SPARQ .</p>
<ol class="ltx_enumerate" id="S6.I1">
<li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S6.I1.i1.p1">
<p class="ltx_p" id="S6.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.i1.p1.1.1">Forward Reachable Tube (FRT)</span> Here, we compute the forward reachable tube (FRT) of the agent that caused the perception failure. The FRT of an agent is the set of all possible states that the agent can reach within a time horizon. If the candidate plan intersects with FRT, the plan is classified as unsafe; otherwise, it is declared safe. We compute the FRT assuming that the missed agent follows unicycle dynamics <math alttext="f" class="ltx_Math" display="inline" id="S6.I1.i1.p1.1.m1.1"><semantics id="S6.I1.i1.p1.1.m1.1a"><mi id="S6.I1.i1.p1.1.m1.1.1" xref="S6.I1.i1.p1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.1.m1.1b"><ci id="S6.I1.i1.p1.1.m1.1.1.cmml" xref="S6.I1.i1.p1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i1.p1.1.m1.1d">italic_f</annotation></semantics></math>, which governs the state evolution as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S6.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\dot{\mathbf{x}}=f(\mathbf{x},u)=\bigr{[}v\,cos(\theta)\quad v\,sin(\theta)%
\quad\omega\quad a\bigr{]}\vspace{-0.6em}" class="ltx_math_unparsed" display="block" id="S6.E1.m1.2"><semantics id="S6.E1.m1.2a"><mrow id="S6.E1.m1.2b"><mrow id="S6.E1.m1.2.3"><mover accent="true" id="S6.E1.m1.2.3.1"><mi id="S6.E1.m1.2.3.1.2">𝐱</mi><mo id="S6.E1.m1.2.3.1.1">˙</mo></mover><mo id="S6.E1.m1.2.3.2">=</mo><mi id="S6.E1.m1.2.3.3">f</mi><mrow id="S6.E1.m1.2.3.4"><mo id="S6.E1.m1.2.3.4.1" stretchy="false">(</mo><mi id="S6.E1.m1.1.1">𝐱</mi><mo id="S6.E1.m1.2.3.4.2">,</mo><mi id="S6.E1.m1.2.2">u</mi><mo id="S6.E1.m1.2.3.4.3" stretchy="false">)</mo></mrow><mo id="S6.E1.m1.2.3.5" rspace="0em">=</mo><mo id="S6.E1.m1.2.3.6" lspace="0em" mathsize="120%" rspace="0em">[</mo></mrow><mi id="S6.E1.m1.2.4">v</mi><mi id="S6.E1.m1.2.5">c</mi><mi id="S6.E1.m1.2.6">o</mi><mi id="S6.E1.m1.2.7">s</mi><mrow id="S6.E1.m1.2.8"><mo id="S6.E1.m1.2.8.1" stretchy="false">(</mo><mi id="S6.E1.m1.2.8.2">θ</mi><mo id="S6.E1.m1.2.8.3" stretchy="false">)</mo></mrow><mspace id="S6.E1.m1.2.9" width="1em"></mspace><mi id="S6.E1.m1.2.10">v</mi><mi id="S6.E1.m1.2.11">s</mi><mi id="S6.E1.m1.2.12">i</mi><mi id="S6.E1.m1.2.13">n</mi><mrow id="S6.E1.m1.2.14"><mo id="S6.E1.m1.2.14.1" stretchy="false">(</mo><mi id="S6.E1.m1.2.14.2">θ</mi><mo id="S6.E1.m1.2.14.3" stretchy="false">)</mo></mrow><mspace id="S6.E1.m1.2.15" width="1em"></mspace><mi id="S6.E1.m1.2.16">ω</mi><mspace id="S6.E1.m1.2.17" width="1em"></mspace><mi id="S6.E1.m1.2.18">a</mi><mo id="S6.E1.m1.2.19" maxsize="120%" minsize="120%">]</mo></mrow><annotation encoding="application/x-tex" id="S6.E1.m1.2c">\dot{\mathbf{x}}=f(\mathbf{x},u)=\bigr{[}v\,cos(\theta)\quad v\,sin(\theta)%
\quad\omega\quad a\bigr{]}\vspace{-0.6em}</annotation><annotation encoding="application/x-llamapun" id="S6.E1.m1.2d">over˙ start_ARG bold_x end_ARG = italic_f ( bold_x , italic_u ) = [ italic_v italic_c italic_o italic_s ( italic_θ ) italic_v italic_s italic_i italic_n ( italic_θ ) italic_ω italic_a ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S6.I1.i1.p1.9">where <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S6.I1.i1.p1.2.m1.1"><semantics id="S6.I1.i1.p1.2.m1.1a"><mi id="S6.I1.i1.p1.2.m1.1.1" xref="S6.I1.i1.p1.2.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.2.m1.1b"><ci id="S6.I1.i1.p1.2.m1.1.1.cmml" xref="S6.I1.i1.p1.2.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.2.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i1.p1.2.m1.1d">bold_x</annotation></semantics></math> is the state of the missed agent composed of the xy-position, and heading <math alttext="\theta" class="ltx_Math" display="inline" id="S6.I1.i1.p1.3.m2.1"><semantics id="S6.I1.i1.p1.3.m2.1a"><mi id="S6.I1.i1.p1.3.m2.1.1" xref="S6.I1.i1.p1.3.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.3.m2.1b"><ci id="S6.I1.i1.p1.3.m2.1.1.cmml" xref="S6.I1.i1.p1.3.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.3.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i1.p1.3.m2.1d">italic_θ</annotation></semantics></math> and <math alttext="v" class="ltx_Math" display="inline" id="S6.I1.i1.p1.4.m3.1"><semantics id="S6.I1.i1.p1.4.m3.1a"><mi id="S6.I1.i1.p1.4.m3.1.1" xref="S6.I1.i1.p1.4.m3.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.4.m3.1b"><ci id="S6.I1.i1.p1.4.m3.1.1.cmml" xref="S6.I1.i1.p1.4.m3.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.4.m3.1c">v</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i1.p1.4.m3.1d">italic_v</annotation></semantics></math>, the car’s velocity. The control actions are given by <math alttext="u=\big{[}\omega\quad a\big{]}" class="ltx_Math" display="inline" id="S6.I1.i1.p1.5.m4.2"><semantics id="S6.I1.i1.p1.5.m4.2a"><mrow id="S6.I1.i1.p1.5.m4.2.3" xref="S6.I1.i1.p1.5.m4.2.3.cmml"><mi id="S6.I1.i1.p1.5.m4.2.3.2" xref="S6.I1.i1.p1.5.m4.2.3.2.cmml">u</mi><mo id="S6.I1.i1.p1.5.m4.2.3.1" xref="S6.I1.i1.p1.5.m4.2.3.1.cmml">=</mo><mrow id="S6.I1.i1.p1.5.m4.2.3.3.2" xref="S6.I1.i1.p1.5.m4.2.3.3.1.cmml"><mo id="S6.I1.i1.p1.5.m4.2.3.3.2.1" maxsize="120%" minsize="120%" xref="S6.I1.i1.p1.5.m4.2.3.3.1.cmml">[</mo><mi id="S6.I1.i1.p1.5.m4.1.1" xref="S6.I1.i1.p1.5.m4.1.1.cmml">ω</mi><mspace id="S6.I1.i1.p1.5.m4.2.3.3.2.2" width="1em" xref="S6.I1.i1.p1.5.m4.2.3.3.1.cmml"></mspace><mi id="S6.I1.i1.p1.5.m4.2.2" xref="S6.I1.i1.p1.5.m4.2.2.cmml">a</mi><mo id="S6.I1.i1.p1.5.m4.2.3.3.2.3" maxsize="120%" minsize="120%" xref="S6.I1.i1.p1.5.m4.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.5.m4.2b"><apply id="S6.I1.i1.p1.5.m4.2.3.cmml" xref="S6.I1.i1.p1.5.m4.2.3"><eq id="S6.I1.i1.p1.5.m4.2.3.1.cmml" xref="S6.I1.i1.p1.5.m4.2.3.1"></eq><ci id="S6.I1.i1.p1.5.m4.2.3.2.cmml" xref="S6.I1.i1.p1.5.m4.2.3.2">𝑢</ci><list id="S6.I1.i1.p1.5.m4.2.3.3.1.cmml" xref="S6.I1.i1.p1.5.m4.2.3.3.2"><ci id="S6.I1.i1.p1.5.m4.1.1.cmml" xref="S6.I1.i1.p1.5.m4.1.1">𝜔</ci><ci id="S6.I1.i1.p1.5.m4.2.2.cmml" xref="S6.I1.i1.p1.5.m4.2.2">𝑎</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.5.m4.2c">u=\big{[}\omega\quad a\big{]}</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i1.p1.5.m4.2d">italic_u = [ italic_ω italic_a ]</annotation></semantics></math>, where <math alttext="\omega" class="ltx_Math" display="inline" id="S6.I1.i1.p1.6.m5.1"><semantics id="S6.I1.i1.p1.6.m5.1a"><mi id="S6.I1.i1.p1.6.m5.1.1" xref="S6.I1.i1.p1.6.m5.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.6.m5.1b"><ci id="S6.I1.i1.p1.6.m5.1.1.cmml" xref="S6.I1.i1.p1.6.m5.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.6.m5.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i1.p1.6.m5.1d">italic_ω</annotation></semantics></math> is the steering rate, and <math alttext="a" class="ltx_Math" display="inline" id="S6.I1.i1.p1.7.m6.1"><semantics id="S6.I1.i1.p1.7.m6.1a"><mi id="S6.I1.i1.p1.7.m6.1.1" xref="S6.I1.i1.p1.7.m6.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.7.m6.1b"><ci id="S6.I1.i1.p1.7.m6.1.1.cmml" xref="S6.I1.i1.p1.7.m6.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.7.m6.1c">a</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i1.p1.7.m6.1d">italic_a</annotation></semantics></math> is the acceleration. In addition, we compute a three-dimensional reduction of the model, which assumes a constant velocity (<math alttext="a=0" class="ltx_Math" display="inline" id="S6.I1.i1.p1.8.m7.1"><semantics id="S6.I1.i1.p1.8.m7.1a"><mrow id="S6.I1.i1.p1.8.m7.1.1" xref="S6.I1.i1.p1.8.m7.1.1.cmml"><mi id="S6.I1.i1.p1.8.m7.1.1.2" xref="S6.I1.i1.p1.8.m7.1.1.2.cmml">a</mi><mo id="S6.I1.i1.p1.8.m7.1.1.1" xref="S6.I1.i1.p1.8.m7.1.1.1.cmml">=</mo><mn id="S6.I1.i1.p1.8.m7.1.1.3" xref="S6.I1.i1.p1.8.m7.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.8.m7.1b"><apply id="S6.I1.i1.p1.8.m7.1.1.cmml" xref="S6.I1.i1.p1.8.m7.1.1"><eq id="S6.I1.i1.p1.8.m7.1.1.1.cmml" xref="S6.I1.i1.p1.8.m7.1.1.1"></eq><ci id="S6.I1.i1.p1.8.m7.1.1.2.cmml" xref="S6.I1.i1.p1.8.m7.1.1.2">𝑎</ci><cn id="S6.I1.i1.p1.8.m7.1.1.3.cmml" type="integer" xref="S6.I1.i1.p1.8.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.8.m7.1c">a=0</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i1.p1.8.m7.1d">italic_a = 0</annotation></semantics></math>).
We use DeepReach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib29" title="">29</a>]</cite> to approximate a value function whose sub-zero level set gives us the FRT of the agent; additionally, for the 3D system with zero acceleration, we compute a parameterized value function (parameterized by different velocities <math alttext="v" class="ltx_Math" display="inline" id="S6.I1.i1.p1.9.m8.1"><semantics id="S6.I1.i1.p1.9.m8.1a"><mi id="S6.I1.i1.p1.9.m8.1.1" xref="S6.I1.i1.p1.9.m8.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.9.m8.1b"><ci id="S6.I1.i1.p1.9.m8.1.1.cmml" xref="S6.I1.i1.p1.9.m8.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.9.m8.1c">v</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i1.p1.9.m8.1d">italic_v</annotation></semantics></math>) whose subzero-level again gives us the FRT.
An example FRT is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.F6" title="Figure 6 ‣ VI-B Baseline: Hamilton Jacobi Reachability ‣ VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">6</span></a>(b)-(c), which flags the ego plan as unsafe since it enters the FRT.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S6.I1.i2.p1">
<p class="ltx_p" id="S6.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.i2.p1.1.1">Two Player Cooperative Game (2P-Game)</span>. For our second baseline, we compare our approach to a reachability-based baseline inspired by previous work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib17" title="">17</a>]</cite>. In this baseline, the ego and the missed perception failure are involved in a two-player dynamic game where both the players choose to act to maximize the chances of collision using any dynamically feasible trajectory. Here, both the agents follow the unicycle dynamics from eqn. (<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.E1" title="In item 1 ‣ VI-B Baseline: Hamilton Jacobi Reachability ‣ VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">1</span></a>). An example of a possible trajectory choice made by the agent and the perception failure in any instance of time is shown Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.F6" title="Figure 6 ‣ VI-B Baseline: Hamilton Jacobi Reachability ‣ VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">6</span></a>. We utilize the framework used in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#bib.bib5" title="">5</a>]</cite> to compute the Backward Reachable Tube (BRT), which is the set of all possible initial states from which the system inevitably enters a collation state after a fixed interval of time (3s in our example).</p>
</div>
</li>
</ol>
</div>
<figure class="ltx_figure" id="S6.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="212" id="S6.F6.g1" src="extracted/5904926/figures/baselines.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F6.3.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S6.F6.4.2" style="font-size:90%;">Baselines <span class="ltx_text ltx_font_bold" id="S6.F6.4.2.1">(a)</span> Two-player game where both the ego and the perception failure choose to maximize the occurrence of collisions. The black trajectories are instantaneous optimal decisions that lead to a possible collision. The blue dashed trajectory depicts the candidate ego plan we wish to analyze for safety. <span class="ltx_text ltx_font_bold" id="S6.F6.4.2.2">(b)</span> Relaxed baseline where the ego follows the candidate plan, which we wish to check, while we compute the FRT for the perception failure.
<span class="ltx_text ltx_font_bold" id="S6.F6.4.2.3">(c)</span> FRT projected on a random scenario from our dataset.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.1">A key distinction between the choice of the baseline is that the FRT-based approach utilizes the candidate ego plan as part of the safety check; in contrast, the 2P-Game version requires that the ego and the agent follow an optimal control strategy that encourages failure. Hence the 2P-Game version cannot be used as a monitor to assess the safety of a candidate plan. On the other hand, due to the closed-loop nature of the game, the 2P-Game version is less conservative as it accounts for the temporal aspects of the interaction, while the instersection of a candidate plan with the FRT does not signify a guaranteed collision. For instance, even if the ego trajectory is flagged as unsafe due to the intersection with the FRT, there is no guarantee that the ego and the agent will reach the exact spatial locations simultaneously (and hence avoid a collision), leading to a more conservative estimate for the safety check. Whereas by definition, states flagged as unsafe by the 2P-Game are certified to lead to a collision within a fixed time interval.</p>
</div>
<figure class="ltx_table" id="S6.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T1.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S6.T1.5.5.6"><span class="ltx_text ltx_font_bold" id="S6.T1.5.5.6.1">Algorithm</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S6.T1.1.1.1.1">F1 Score</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T1.1.1.1.m1.1"><semantics id="S6.T1.1.1.1.m1.1a"><mo id="S6.T1.1.1.1.m1.1.1" stretchy="false" xref="S6.T1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T1.1.1.1.m1.1b"><ci id="S6.T1.1.1.1.m1.1.1.cmml" xref="S6.T1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T1.1.1.1.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T1.2.2.2">
<span class="ltx_text ltx_font_bold" id="S6.T1.2.2.2.1">Accuracy</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T1.2.2.2.m1.1"><semantics id="S6.T1.2.2.2.m1.1a"><mo id="S6.T1.2.2.2.m1.1.1" stretchy="false" xref="S6.T1.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T1.2.2.2.m1.1b"><ci id="S6.T1.2.2.2.m1.1.1.cmml" xref="S6.T1.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T1.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T1.3.3.3">
<span class="ltx_text ltx_font_bold" id="S6.T1.3.3.3.1">Precision</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T1.3.3.3.m1.1"><semantics id="S6.T1.3.3.3.m1.1a"><mo id="S6.T1.3.3.3.m1.1.1" stretchy="false" xref="S6.T1.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T1.3.3.3.m1.1b"><ci id="S6.T1.3.3.3.m1.1.1.cmml" xref="S6.T1.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T1.3.3.3.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T1.4.4.4">
<span class="ltx_text ltx_font_bold" id="S6.T1.4.4.4.1">Recall</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T1.4.4.4.m1.1"><semantics id="S6.T1.4.4.4.m1.1a"><mo id="S6.T1.4.4.4.m1.1.1" stretchy="false" xref="S6.T1.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T1.4.4.4.m1.1b"><ci id="S6.T1.4.4.4.m1.1.1.cmml" xref="S6.T1.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T1.4.4.4.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T1.5.5.5">
<span class="ltx_text ltx_font_bold" id="S6.T1.5.5.5.1">Runtime [Hz]</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S6.T1.5.5.5.m1.1"><semantics id="S6.T1.5.5.5.m1.1a"><mo id="S6.T1.5.5.5.m1.1.1" stretchy="false" xref="S6.T1.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S6.T1.5.5.5.m1.1b"><ci id="S6.T1.5.5.5.m1.1.1.cmml" xref="S6.T1.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S6.T1.5.5.5.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T1.5.6.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.5.6.1.1"><span class="ltx_text ltx_font_bold" id="S6.T1.5.6.1.1.1">SPARQ (ours)</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.5.6.1.2"><span class="ltx_text ltx_font_bold" id="S6.T1.5.6.1.2.1">0.91 (0.81)</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.5.6.1.3">
<span class="ltx_text ltx_font_bold" id="S6.T1.5.6.1.3.1">0.90 </span>(0.92)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.5.6.1.4"><span class="ltx_text ltx_font_bold" id="S6.T1.5.6.1.4.1">0.93 (0.72)</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.5.6.1.5">
<span class="ltx_text ltx_font_bold" id="S6.T1.5.6.1.5.1">0.90</span> (0.92)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T1.5.6.1.6">42</td>
</tr>
<tr class="ltx_tr" id="S6.T1.5.7.2">
<td class="ltx_td ltx_align_left" id="S6.T1.5.7.2.1"><span class="ltx_text ltx_font_bold" id="S6.T1.5.7.2.1.1">Two-Player Game</span></td>
<td class="ltx_td ltx_align_center" id="S6.T1.5.7.2.2">0.57 (0.37)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.5.7.2.3">0.75 (0.94)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.5.7.2.4">0.61 (0.23)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.5.7.2.5">0.75 (0.94)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.5.7.2.6"><span class="ltx_text ltx_font_bold" id="S6.T1.5.7.2.6.1">100</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.5.8.3">
<td class="ltx_td ltx_align_left" id="S6.T1.5.8.3.1"><span class="ltx_text ltx_font_bold" id="S6.T1.5.8.3.1.1">FRT (3D)</span></td>
<td class="ltx_td ltx_align_center" id="S6.T1.5.8.3.2">0.77 (0.51)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.5.8.3.3">0.75 (0.92)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.5.8.3.4">0.85 (0.35)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.5.8.3.5">0.75 (0.92)</td>
<td class="ltx_td ltx_align_center" id="S6.T1.5.8.3.6"><span class="ltx_text ltx_font_bold" id="S6.T1.5.8.3.6.1">100</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.5.9.4">
<td class="ltx_td ltx_align_left ltx_border_b" id="S6.T1.5.9.4.1"><span class="ltx_text ltx_font_bold" id="S6.T1.5.9.4.1.1">FRT (4D)</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T1.5.9.4.2">0.60 (0.46)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T1.5.9.4.3">0.80 <span class="ltx_text ltx_font_bold" id="S6.T1.5.9.4.3.1">(0.99)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T1.5.9.4.4">0.65 (0.30)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T1.5.9.4.5">0.80 <span class="ltx_text ltx_font_bold" id="S6.T1.5.9.4.5.1">(0.99)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S6.T1.5.9.4.6"><span class="ltx_text ltx_font_bold" id="S6.T1.5.9.4.6.1">100</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T1.7.1.1" style="font-size:90%;">TABLE I</span>: </span><span class="ltx_text" id="S6.T1.8.2" style="font-size:90%;">Performance of SPARQ and reachability-based baseline on the nuPlan-Vegas validation dataset.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS3.5.1.1">VI-C</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS3.6.2">Quantitative Performance</span>
</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">We assess the performance of SPARQ on the validation</p>
</div>
<figure class="ltx_figure" id="S6.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="223" id="S6.F7.g1" src="extracted/5904926/figures/result_plans_and_monitor.png" width="497"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F7.3.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text ltx_font_bold" id="S6.F7.4.2" style="font-size:90%;">(a-d) Plan Repair.<span class="ltx_text ltx_font_medium" id="S6.F7.4.2.1"> Results showing our algorithm preventing a possible collision by detecting the candidate plan as “Critical” and subsequently returning a repair plan that was either of the “Safe” class </span>(top row)<span class="ltx_text ltx_font_medium" id="S6.F7.4.2.2"> by lane switch maneuver or “Risky” class </span>(bottom row)<span class="ltx_text ltx_font_medium" id="S6.F7.4.2.3"> via going off-road to perform overtaking action. In both cases the baseline (column (d)) was able to detect the base plan as “Critical”. 
<br class="ltx_break"/></span>(e) Robustness to monitor heatmaps<span class="ltx_text ltx_font_medium" id="S6.F7.4.2.4">. (</span>top<span class="ltx_text ltx_font_medium" id="S6.F7.4.2.5">) Shows the perceived scene and (</span>bottom<span class="ltx_text ltx_font_medium" id="S6.F7.4.2.6">) shows the SPARQ predictions for each location of the monitor input. Red corresponds to that particular location being classified as <span class="ltx_text ltx_font_italic" id="S6.F7.4.2.6.1">Critical</span>, while Blue is classified as <span class="ltx_text ltx_font_italic" id="S6.F7.4.2.6.2">Safe</span>.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS3.p2">
<p class="ltx_p" id="S6.SS3.p2.1">split of the nuPlan-Vegas dataset. The evaluation uses four different metrics: accuracy, precision, recall, and F1 score. Accuracy measures the correctness of the detections, precision measures the quality of positive detections (soundness), recall measures the ability to capture all positive detections (completeness), and F1 score balances both precision and recall to provide a single performance measure for detection.
The metrics are averaged over the three prediction classes.
Since this work prioritizes AV safety, we also compare the methods over their performance on the safety-critical class; the values corresponding to this metric are mentioned in parentheses along with the average metrics.</p>
</div>
<div class="ltx_para" id="S6.SS3.p3">
<p class="ltx_p" id="S6.SS3.p3.1">The results are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.T1" title="TABLE I ‣ VI-B Baseline: Hamilton Jacobi Reachability ‣ VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">I</span></a>. Overall, we see that SPARQ either equals or does better than the baselines for almost all the metrics. The FRT and the Two-Player Game baseline exhibit a high recall for the safety-critical class, which is essential for ensuring the safety of autonomous systems. This is not surprising as the Reachability-based methods are known to be conservative. However, it comes at a cost of loss in performance, as evident by the lower precision. This results from a high false positive rate for the safety-critical class for this method.
Hence, the plans that are actually safe, despite the presence of perception errors, are classified as unsafe. This worst-case assumption approach further leads to the rejection of all the proposed plans, ultimately halting the vehicle as an aggressive option to enforce safety.
On the other hand, SPARQ balances safety and performance as shown by the consistent performance over all the metrics. Furthermore, we computed a strong AUROC score of <span class="ltx_text ltx_font_bold" id="S6.SS3.p3.1.1">0.9</span> by SPARQ for all three classes, nearing the performance of an ideal detector (AUROC = 1).
In our computation, we pre-calculated the value function for the reachability-based methods, resulting in a lookup table that could be efficiently queried for any state at runtime.</p>
</div>
<div class="ltx_para" id="S6.SS3.p4">
<p class="ltx_p" id="S6.SS3.p4.1">Interestingly, SPARQ demonstrated an unexpected ability to detect failure cases not caused by perception failures, functioning as a general-purpose safety filter. It filtered <span class="ltx_text ltx_font_bold" id="S6.SS3.p4.1.1">96%</span> of plans from the base planner that would have led to safety violations, even without perception failures. We hypothesize that the diversity of our dataset enabled SPARQ to identify fundamental features causing safety failures.</p>
</div>
<div class="ltx_theorem ltx_theorem_remark" id="Thmremark3">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmremark3.1.1.1">Remark 3</span></span></h6>
<div class="ltx_para" id="Thmremark3.p1">
<p class="ltx_p" id="Thmremark3.p1.1"><span class="ltx_text ltx_font_italic" id="Thmremark3.p1.1.1">It was interesting to observe that in spite of being a conservative approach, the reachability-based methods were unable to detect some critical failure scenarios. Additionally, the two-player game version has a lower recall than the FRT-based baseline. This was a direct consequence of using the non-holonomic unicycle dynamics for the prediction model for the FRT and the two-player-based baselines, while the ground truth was computed using differentially-flat dynamics involving motion primitives. The reachable tube for a system obeying a simpler dynamics model(e.g., the motion primitives) is generally larger when compared with the same system with additional non-holonomic constraints (e.g., the unicycle model). The two-player game baseline uses the unicycle dynamics for both the ego as well as the missed agent, while the FRT-based baseline uses it once for the missed agent. SPARQ is able to leverage the flat dynamics model from the trajectory tree planner to its advantage, resulting in a more accurate safety monitor.</span></p>
</div>
</div>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS4.5.1.1">VI-D</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS4.6.2">Qualitative Performance</span>
</h3>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">We now analyze two cases of plan repair exhibited by our algorithm in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.F7" title="Figure 7 ‣ VI-C Quantitative Performance ‣ VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">7</span></a>(a-d). In both cases (presented in the top and bottom rows, respectively), our algorithm was able to correctly detect that the candidate ego plan (obtained by RHPlanner on the perceived scene in column (a)) would be compromised due to the presence of the unaccounted perception failure exposed by the monitor (shown with the red marker in column (b) on the monitored scene). In the <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.1">first row</span> SPARQ was able to propose a repaired plan that is in the “Safe” class and was able to prevent crashing into the missed agent by executing a lane change to the left. A lane switch to the right would have again resulted in a critical situation due to the presence of another agent on that side, and indeed, such a plan was not predicted as safe by SPARQ. In the <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.2">second row</span>, however, SPARQ was unable to propose a plan from the safe class given that the ego vehicle faced a more constrained environment with a curb on its right and another agent to its left, making this a <em class="ltx_emph ltx_font_italic" id="S6.SS4.p1.1.3">hard</em> scenario. Thus, SPARQ proposes a repair from the “Risky” class. This plan leads the ego vehicle off-road and <span class="ltx_text ltx_font_italic" id="S6.SS4.p1.1.4">overtakes</span> the missed agent.
While this plan violated the rule of keeping the AV on the road, it still averted a catastrophic failure – a collision with another agent. In both cases, being a conservative approach, the baseline method predicted that the candidate plan would enter the FRT of the missed agent and, hence, flagged it as unsafe. However, the maneuvers suggested by SPARQ are also deemed unsafe under FRT, with coming to a complete stop being the only safe plan.</p>
</div>
<div class="ltx_para" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.1">Finally, we show the robustness of our algorithm with respect to different inputs of the safety monitor. Essentially, we want to visualize all possible locations of a missed agent that are critical to the ego plan. Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.F7" title="Figure 7 ‣ VI-C Quantitative Performance ‣ VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">7</span></a> (column e) shows a perceived scene (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.F7" title="Figure 7 ‣ VI-C Quantitative Performance ‣ VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">7</span></a>e <span class="ltx_text ltx_font_bold" id="S6.SS4.p2.1.1">top</span>) and the corresponding predictions of SPARQ for each possible location of the missed agent in the scene (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17630v2#S6.F7" title="Figure 7 ‣ VI-C Quantitative Performance ‣ VI Experimental Results and Discussion ‣ System-Level Safety Monitoring and Recovery for Perception Failures in Autonomous Vehicles"><span class="ltx_text ltx_ref_tag">7</span></a>e <span class="ltx_text ltx_font_bold" id="S6.SS4.p2.1.2">bottom</span>). The network predicts that the presence of the perception failure around the ego position will result in its plans being classified as “Critical” (shown in red). In contrast, missing agents at the periphery of the map do not affect the ego plan, and hence, the plan would still be safe, as predicted by SPARQ (“Safe” class predictions are shown in blue).</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS4.p3">
<p class="ltx_p" id="S6.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS4.p3.1.1">Runtime details.</span> One of the key advantages of SPARQ is its significantly smaller inference time, making it feasible for real-time deployment in AV stacks. We demonstrated that our method can classify the task-relevant safety score of approximately 256 plans in 0.024s (or <math alttext="\sim" class="ltx_Math" display="inline" id="S6.SS4.p3.1.m1.1"><semantics id="S6.SS4.p3.1.m1.1a"><mo id="S6.SS4.p3.1.m1.1.1" xref="S6.SS4.p3.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S6.SS4.p3.1.m1.1b"><csymbol cd="latexml" id="S6.SS4.p3.1.m1.1.1.cmml" xref="S6.SS4.p3.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p3.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p3.1.m1.1d">∼</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S6.SS4.p3.1.2">42Hz</span>) for a given scenario.
Additionally, it requires only 0.006s to propose a safer alternative plan if the original candidate plan is deemed unsafe. In contrast, the default RHPlanner-based pipeline takes around 0.05s (or <span class="ltx_text ltx_font_bold" id="S6.SS4.p3.1.3">20Hz</span>) to perform the same task. This speedup is primarily due to replacing analytical components with neural network-based elements.</p>
</div>
<div class="ltx_para" id="S6.SS4.p4">
<p class="ltx_p" id="S6.SS4.p4.1">Another strength of our method is its modularity. Once trained, SPARQ can be seamlessly integrated with any other planner, serving as a filter for unsafe plans and enabling plan repair under perception failure.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span class="ltx_text ltx_font_smallcaps" id="S7.1.1">Conclusion and Future Work</span>
</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this paper, we present SPARQ, a Q-network-based approach for run-time monitoring of system-level
perception failures <em class="ltx_emph ltx_font_italic" id="S7.p1.1.1">and</em> generating recovery plans. Furthermore, SPARQ doubles down as a general-purpose safety monitor in the absence of any perception failures. In our experiments, SPARQ delivered a low false-positive and false-negative rate while being run-time capable for modern AV stacks.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">As a part of our future work, we will explore injecting out-of-distribution (OOD) robustness in the monitor which would allow it to serve as a run-time monitor despite distribution shifts, such as geographical locations, driving behaviors of other agents, etc. Another exciting opportunity is the exploration of natural-language-based descriptions as inputs to the encoder to facilitate multi-modal reasoning in SPARQ.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
P. Antonante, H. Nilsen, and L. Carlone, “Monitoring of perception systems: Deterministic, probabilistic, and learning-based fault detection and identification,” <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv: 2205.10906</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
A. Balakrishnan, J. Deshmukh, B. Hoxha, T. Yamaguchi, and G. Fainekos, “Percemon: Online monitoring for perception systems,” in <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of International Conference on Runtime Verification</em>.   Springer, 2021, pp. 297–308.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
D. Miller, P. Moghadam, M. Cox, M. Wildie, and R. Jurdak, “What’s in the black box? the false negative mechanisms inside object detectors,” <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">IEEE Robotics and Automation Letters</em>, vol. 7, no. 3, pp. 8510–8517, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Q. M. Rahman, N. Sünderhauf, P. Corke, and F. Dayoub, “Fsnet: A failure detection framework for semantic segmentation,” <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">IEEE Robotics and Automation Letters</em>, vol. 7, no. 2, pp. 3030–3037, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
P. Antonante, S. Veer, K. Leung, X. Weng, L. Carlone, and M. Pavone, “Task-aware risk estimation of perception failures for autonomous vehicles,” <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2305.01870</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
H. Caesar, J. Kabzan, K. S. Tan, W. K. Fong, E. Wolff, A. Lang, L. Fletcher, O. Beijbom, and S. Omari, “nuplan: A closed-loop ml-based planning benchmark for autonomous vehicles,” <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2106.11810</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
S. Bansal, M. Chen, S. Herbert, and C. J. Tomlin, “Hamilton-jacobi reachability: A brief overview and recent advances,” in <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">2017 IEEE 56th Annual Conference on Decision and Control (CDC)</em>.   IEEE, 2017, pp. 2242–2253.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
A. D. Ames, S. Coogan, M. Egerstedt, G. Notomista, K. Sreenath, and P. Tabuada, “Control barrier functions: Theory and applications,” in <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">2019 18th European control conference (ECC)</em>.   IEEE, 2019, pp. 3420–3431.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
S. Manzinger, C. Pek, and M. Althoff, “Using reachable sets for trajectory planning of automated vehicles,” <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">IEEE Transactions on Intelligent Vehicles</em>, vol. 6, no. 2, pp. 232–248, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
S. Singh, A. Majumdar, J.-J. Slotine, and M. Pavone, “Robust online motion planning via contraction theory and convex optimization,” in <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">2017 IEEE International Conference on Robotics and Automation (ICRA)</em>.   IEEE, 2017, pp. 5883–5890.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
A. Farid, S. Veer, B. Ivanovic, K. Leung, and M. Pavone, “Task-relevant failure detection for trajectory predictors in autonomous vehicles,” <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2207.12380</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
T. Nyberg, C. Pek, L. Dal Col, C. Norén, and J. Tumova, “Risk-aware motion planning for autonomous vehicles with safety specifications,” in <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">2021 ieee intelligent vehicles symposium (iv)</em>.   IEEE, 2021, pp. 1016–1023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
L. Lindemann, M. Cleaveland, G. Shim, and G. J. Pappas, “Safe planning in dynamic environments using conformal prediction,” <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">IEEE Robotics and Automation Letters</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
L. Westhofen, C. Neurohr, T. Koopmann, M. Butz, B. Schütt, F. Utesch, B. Kramer, C. Gutenkunst, and E. Böde, “Criticality metrics for automated driving: A review and suitability analysis of the state of the art,” <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2108.02403</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
A. Bansal, J. Singh, M. Verucchi, M. Caccamo, and L. Sha, “Risk ranked recall: Collision safety metric for object detection systems in autonomous vehicles,” in <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of Mediterranean Conference on Embedded Computing (MECO)</em>, 2021, pp. 1–4.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
J. Bernhard, P. Hart, A. Sahu, C. Schöller, and M. G. Cancimance, “Risk-based safety envelopes for autonomous vehicles under perception uncertainty,” in <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of IEEE Intelligent Vehicles Symposium (IV)</em>, 2022, pp. 104–111.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
S. Topan, K. Leung, Y. Chen, P. Tupekar, E. Schmerling, J. Nilsson, M. Cox, and M. Pavone, “Interaction-dynamics-aware perception zones for obstacle detection safety evaluation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">2022 IEEE Intelligent Vehicles Symposium (IV)</em>.   IEEE, 2022, pp. 1201–1210.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
K. Chakraborty and S. Bansal, “Discovering closed-loop failures of vision-based controllers via reachability analysis,” <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">IEEE RAL</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
K. P. Wabersich, A. J. Taylor, J. J. Choi, K. Sreenath, C. J. Tomlin, A. D. Ames, and M. N. Zeilinger, “Data-driven safety filters: Hamilton-jacobi reachability, control barrier functions, and predictive methods for uncertain systems,” <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">IEEE Control Systems Magazine</em>, vol. 43, no. 5, pp. 137–177, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
J. Yin, C. Dawson, C. Fan, and P. Tsiotras, “Shield model predictive path integral: A computationally efficient robust mpc approach using control barrier functions,” <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2302.11719</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
A. Gupta, K. Chakraborty, and S. Bansal, “Detecting and mitigating system-level anomalies of vision-based controllers,” in <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">2024 IEEE ICRA</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Y. Wang, Y. Lin, and M. Althoff, “Interaction-aware trajectory repair in compliance with formalized traffic rules,” in <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">The 27th IEEE International Conference on Intelligent Transportation Systems (IEEE ITSC 2024)</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Y. Lin and M. Althoff, “Rule-compliant trajectory repairing using satisfiability modulo theories,” in <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">2022 IEEE Intelligent Vehicles Symposium (IV)</em>.   IEEE, 2022, pp. 449–456.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Y. Lin, C. Li, M. Ding, M. Tomizuka, W. Zhan, and M. Althoff, “Drplanner: Diagnosis and repair of motion planners for automated vehicles using large language models,” <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">IEEE Robotics and Automation Letters</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
S. Veer, K. Leung, R. K. Cosner, Y. Chen, P. Karkus, and M. Pavone, “Receding horizon planning with rule hierarchies for autonomous vehicles,” in <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">IEEE ICRA</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
C. R. Qi, L. Yi, H. Su, and L. J. Guibas, “Pointnet++: Deep hierarchical feature learning on point sets in a metric space,” <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Advances in neural information processing systems</em>, vol. 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
J. Ho, N. Kalchbrenner, D. Weissenborn, and T. Salimans, “Axial attention in multidimensional transformers,” <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:1912.12180</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Y. Chen, S. Veer, P. Karkus, and M. Pavone, “Interactive joint planning for autonomous vehicles,” <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">IEEE Robotics and Automation Letters</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
S. Bansal and C. J. Tomlin, “Deepreach: A deep learning approach to high-dimensional reachability,” in <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">ICRA</em>.   IEEE, 2021.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Oct  6 19:36:56 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
