<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2104.00365] Federated Few-Shot Learning with Adversarial Learning</title><meta property="og:description" content="We are interested in developing a unified machine learning model over many mobile devices for practical learning tasks, where each device only has very few training data. This is a commonly encountered situation in mob…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Few-Shot Learning with Adversarial Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Few-Shot Learning with Adversarial Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2104.00365">

<!--Generated on Sat Mar  2 06:38:01 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="federated learning,  few-shot learning,  adversarial optimization">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Federated Few-Shot Learning with Adversarial Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chenyou Fan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:fanchenyou@cuhk.edu.cn">fanchenyou@cuhk.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_affiliation_institution">Shenzhen Institute of Artificial Intelligence and Robotics for Society</span><span id="id2.2.id2" class="ltx_text ltx_affiliation_country">China</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jianwei Huang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:jianweihuang@cuhk.edu.cn">jianweihuang@cuhk.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span id="id3.1.id1" class="ltx_text ltx_affiliation_institution">The Chinese University of Hong Kong, Shenzhen</span><span id="id4.2.id2" class="ltx_text ltx_affiliation_country">China</span>
</span></span></span>
</div>
<div class="ltx_dates">(2021)</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id5.id1" class="ltx_p">We are interested in developing a unified machine learning model over many mobile devices for practical learning tasks, where each device only has very few training data. This is a commonly encountered situation in mobile computing scenarios, where data is scarce and distributed while the tasks are distinct. In this paper, we propose a federated few-shot learning (FedFSL) framework to learn a few-shot classification model that can classify unseen data classes with only a few labeled samples. With the federated learning strategy, FedFSL can utilize many data sources while keeping data privacy and communication efficiency. There are two technical challenges: 1) directly using the existing federated learning approach may lead to misaligned decision boundaries produced by client models, and 2) constraining the decision boundaries to be similar over clients would overfit to training tasks but not adapt well to unseen tasks. To address these issues, we propose to regularize local updates by minimizing the divergence of client models. We also formulate the training in an adversarial fashion and optimize the client models to produce a discriminative feature space that can better represent unseen data samples. We demonstrate the intuitions and conduct experiments to show our approaches outperform baselines by more than 10% in learning vision tasks and 5% in language tasks.</p>
</div>
<div class="ltx_keywords">federated learning, few-shot learning, adversarial optimization
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_journalyear"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2021</span></span></span><span id="id3" class="ltx_note ltx_note_frontmatter ltx_role_doi"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/1122445.1122456</span></span></span><span id="id4" class="ltx_note ltx_note_frontmatter ltx_role_conference"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>;  submission</span></span></span><span id="id5" class="ltx_note ltx_note_frontmatter ltx_role_booktitle"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>;</span></span></span><span id="id6" class="ltx_note ltx_note_frontmatter ltx_role_price"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span id="id7" class="ltx_note ltx_note_frontmatter ltx_role_isbn"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span id="id8" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Artificial intelligence</span></span></span><span id="id9" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Distributed artificial intelligence</span></span></span><span id="id10" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Computer vision</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/2104.00365/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="140" height="112" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>. </span><span id="S1.F1.4.2" class="ltx_text" style="font-size:90%;">Overview of a FedFSL system. Distributed client devices train client models with sampled FSL tasks from local data. Then client models are sent to the central server and aggregated to a central model, which is sent back to clients for the next round of local updates.
</span></figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In recent years, mobile devices such as smartphones and tablet computers have become perhaps the most frequent and convenient way of connecting users to the Internet. A capable mobile device can now get access to first-hand user data such as photos, voice, typing records, and so on, thus it becomes an ideal platform to deploy machine learning models to better understand user intents and assist in completing daily tasks.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Conventional distributed machine learning approaches <cite class="ltx_cite ltx_citemacro_citep">(Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2014</a>; Zhang
et al<span class="ltx_text">.</span>, <a href="#bib.bib43" title="" class="ltx_ref">2015</a>)</cite> require the data to be transferred from clients to a central server, which raises serious concerns of data privacy.
A recent proposed approach to address this issue is federated learning (FedL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2017</a>; Zhao
et al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2018</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2020c</a>)</cite>. In the FedL paradigm, each participating client computes a local machine learning model with its own data, while a central server periodically coordinates client models by model aggregation (without collecting the actual data). FedL provides a promising way of learning models on distributed devices while preserving data privacy and locality.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">However, existing FedL approaches assume each participating client has sufficient training data for the tasks of interest. The realistic situation is that data collected with mobile devices can be insufficient and almost always unlabeled. This severely limits the practicality and scalability of FedL in realistic applications.
For example, image classification with federated deep neural networks (DNNs) is a commonly compared task in recent FedL studies <cite class="ltx_cite ltx_citemacro_citep">(McMahan
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2017</a>; Zhao
et al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2018</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2020c</a>)</cite>. Training such a DNN in supervised fashion requires hundreds of labeled training samples or more for every class. In reality, each mobile user may own just one or a few samples of each interested image category, and the mobile user often does not have time or interest to label these images. The huge gap between lab scenarios with abundant labeled data and real situations with scarce and mostly unlabeled data motivates us to consider the following question: <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">How to make FedL effective in data-scarce scenarios?</span></p>
</div>
<figure id="S1.T1" class="ltx_table">
<table id="S1.T1.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S1.T1.2.1.1" class="ltx_tr">
<td id="S1.T1.2.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S1.T1.2.1.1.1.1" class="ltx_text" style="font-size:90%;">Method</span></td>
<td id="S1.T1.2.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S1.T1.2.1.1.2.1" class="ltx_text" style="font-size:90%;">Federated learning</span></td>
<td id="S1.T1.2.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S1.T1.2.1.1.3.1" class="ltx_text" style="font-size:90%;">Non-convex model</span></td>
<td id="S1.T1.2.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S1.T1.2.1.1.4.1" class="ltx_text" style="font-size:90%;">SGD solver</span></td>
<td id="S1.T1.2.1.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S1.T1.2.1.1.5.1" class="ltx_text" style="font-size:90%;">Few-shot learning</span></td>
<td id="S1.T1.2.1.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S1.T1.2.1.1.6.1" class="ltx_text" style="font-size:90%;">Divergence</span></td>
<td id="S1.T1.2.1.1.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="S1.T1.2.1.1.7.1" class="ltx_text" style="font-size:90%;">Feature learning</span></td>
</tr>
<tr id="S1.T1.2.2.2" class="ltx_tr">
<td id="S1.T1.2.2.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">
<span id="S1.T1.2.2.2.1.1" class="ltx_text" style="font-size:90%;">FedAvg</span><cite class="ltx_cite ltx_citemacro_citep"><span id="S1.T1.2.2.2.1.2.1" class="ltx_text" style="font-size:90%;">(</span>McMahan
et al<span class="ltx_text">.</span><span id="S1.T1.2.2.2.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib24" title="" class="ltx_ref">2017</a><span id="S1.T1.2.2.2.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite><span id="S1.T1.2.2.2.1.5" class="ltx_text" style="font-size:90%;"> / FedProx</span><cite class="ltx_cite ltx_citemacro_citep"><span id="S1.T1.2.2.2.1.6.1" class="ltx_text" style="font-size:90%;">(</span>Li et al<span class="ltx_text">.</span><span id="S1.T1.2.2.2.1.7.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib21" title="" class="ltx_ref">2018</a><span id="S1.T1.2.2.2.1.8.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</td>
<td id="S1.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S1.T1.2.2.2.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.2.2.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S1.T1.2.2.2.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.2.2.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S1.T1.2.2.2.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.2.2.5" class="ltx_td ltx_border_tt"></td>
<td id="S1.T1.2.2.2.6" class="ltx_td ltx_border_tt"></td>
<td id="S1.T1.2.2.2.7" class="ltx_td ltx_border_tt"></td>
</tr>
<tr id="S1.T1.2.3.3" class="ltx_tr">
<td id="S1.T1.2.3.3.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S1.T1.2.3.3.1.1" class="ltx_text" style="font-size:90%;">FEDL </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S1.T1.2.3.3.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Dinh et al<span class="ltx_text">.</span><span id="S1.T1.2.3.3.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib6" title="" class="ltx_ref">2019</a><span id="S1.T1.2.3.3.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</td>
<td id="S1.T1.2.3.3.2" class="ltx_td ltx_align_center"><span id="S1.T1.2.3.3.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.3.3.3" class="ltx_td"></td>
<td id="S1.T1.2.3.3.4" class="ltx_td ltx_align_center"><span id="S1.T1.2.3.3.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.3.3.5" class="ltx_td"></td>
<td id="S1.T1.2.3.3.6" class="ltx_td"></td>
<td id="S1.T1.2.3.3.7" class="ltx_td"></td>
</tr>
<tr id="S1.T1.2.4.4" class="ltx_tr">
<td id="S1.T1.2.4.4.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S1.T1.2.4.4.1.1" class="ltx_text" style="font-size:90%;">Mutual learning </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S1.T1.2.4.4.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Zhang
et al<span class="ltx_text">.</span><span id="S1.T1.2.4.4.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib45" title="" class="ltx_ref">2018b</a><span id="S1.T1.2.4.4.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</td>
<td id="S1.T1.2.4.4.2" class="ltx_td"></td>
<td id="S1.T1.2.4.4.3" class="ltx_td ltx_align_center"><span id="S1.T1.2.4.4.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.4.4.4" class="ltx_td ltx_align_center"><span id="S1.T1.2.4.4.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.4.4.5" class="ltx_td"></td>
<td id="S1.T1.2.4.4.6" class="ltx_td ltx_align_center"><span id="S1.T1.2.4.4.6.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.4.4.7" class="ltx_td"></td>
</tr>
<tr id="S1.T1.2.5.5" class="ltx_tr">
<td id="S1.T1.2.5.5.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S1.T1.2.5.5.1.1" class="ltx_text" style="font-size:90%;">Local adaptation </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S1.T1.2.5.5.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Yu
et al<span class="ltx_text">.</span><span id="S1.T1.2.5.5.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib40" title="" class="ltx_ref">2020</a><span id="S1.T1.2.5.5.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</td>
<td id="S1.T1.2.5.5.2" class="ltx_td ltx_align_center"><span id="S1.T1.2.5.5.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.5.5.3" class="ltx_td ltx_align_center"><span id="S1.T1.2.5.5.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.5.5.4" class="ltx_td ltx_align_center"><span id="S1.T1.2.5.5.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.5.5.5" class="ltx_td"></td>
<td id="S1.T1.2.5.5.6" class="ltx_td ltx_align_center"><span id="S1.T1.2.5.5.6.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.5.5.7" class="ltx_td"></td>
</tr>
<tr id="S1.T1.2.6.6" class="ltx_tr">
<td id="S1.T1.2.6.6.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S1.T1.2.6.6.1.1" class="ltx_text" style="font-size:90%;">Gradient-based FSL</span><cite class="ltx_cite ltx_citemacro_citep"><span id="S1.T1.2.6.6.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Finn
et al<span class="ltx_text">.</span><span id="S1.T1.2.6.6.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib7" title="" class="ltx_ref">2017</a><span id="S1.T1.2.6.6.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</td>
<td id="S1.T1.2.6.6.2" class="ltx_td"></td>
<td id="S1.T1.2.6.6.3" class="ltx_td ltx_align_center"><span id="S1.T1.2.6.6.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.6.6.4" class="ltx_td ltx_align_center"><span id="S1.T1.2.6.6.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.6.6.5" class="ltx_td ltx_align_center"><span id="S1.T1.2.6.6.5.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.6.6.6" class="ltx_td"></td>
<td id="S1.T1.2.6.6.7" class="ltx_td"></td>
</tr>
<tr id="S1.T1.2.7.7" class="ltx_tr">
<td id="S1.T1.2.7.7.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S1.T1.2.7.7.1.1" class="ltx_text" style="font-size:90%;">Metric-based FSL </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S1.T1.2.7.7.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Gidaris and
Komodakis<span id="S1.T1.2.7.7.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib10" title="" class="ltx_ref">2018</a><span id="S1.T1.2.7.7.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</td>
<td id="S1.T1.2.7.7.2" class="ltx_td"></td>
<td id="S1.T1.2.7.7.3" class="ltx_td ltx_align_center"><span id="S1.T1.2.7.7.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.7.7.4" class="ltx_td ltx_align_center"><span id="S1.T1.2.7.7.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.7.7.5" class="ltx_td ltx_align_center"><span id="S1.T1.2.7.7.5.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.7.7.6" class="ltx_td"></td>
<td id="S1.T1.2.7.7.7" class="ltx_td ltx_align_center"><span id="S1.T1.2.7.7.7.1" class="ltx_text" style="font-size:90%;">✓</span></td>
</tr>
<tr id="S1.T1.2.8.8" class="ltx_tr">
<td id="S1.T1.2.8.8.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<span id="S1.T1.2.8.8.1.1" class="ltx_text" style="font-size:90%;">FedFSL-naive (</span><cite class="ltx_cite ltx_citemacro_citep"><span id="S1.T1.2.8.8.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Chen
et al<span class="ltx_text">.</span><span id="S1.T1.2.8.8.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib4" title="" class="ltx_ref">2018</a><span id="S1.T1.2.8.8.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite><span id="S1.T1.2.8.8.1.5" class="ltx_text" style="font-size:90%;">, </span><a href="#S3.SS3" title="3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">3.3</span></a><span id="S1.T1.2.8.8.1.6" class="ltx_text" style="font-size:90%;">)</span>
</td>
<td id="S1.T1.2.8.8.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.2.8.8.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.8.8.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.2.8.8.3.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.8.8.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.2.8.8.4.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.8.8.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S1.T1.2.8.8.5.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.8.8.6" class="ltx_td ltx_border_t"></td>
<td id="S1.T1.2.8.8.7" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S1.T1.2.9.9" class="ltx_tr">
<td id="S1.T1.2.9.9.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S1.T1.2.9.9.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">FedFSL-MI</span><span id="S1.T1.2.9.9.1.2" class="ltx_text" style="font-size:90%;"> (ours, </span><a href="#S4.SS1" title="4.1. FedFSL with Mutual Information (MI) ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">4.1</span></a><span id="S1.T1.2.9.9.1.3" class="ltx_text" style="font-size:90%;">)</span>
</td>
<td id="S1.T1.2.9.9.2" class="ltx_td ltx_align_center"><span id="S1.T1.2.9.9.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.9.9.3" class="ltx_td ltx_align_center"><span id="S1.T1.2.9.9.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.9.9.4" class="ltx_td ltx_align_center"><span id="S1.T1.2.9.9.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.9.9.5" class="ltx_td ltx_align_center"><span id="S1.T1.2.9.9.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.9.9.6" class="ltx_td ltx_align_center"><span id="S1.T1.2.9.9.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.9.9.7" class="ltx_td"></td>
</tr>
<tr id="S1.T1.2.10.10" class="ltx_tr">
<td id="S1.T1.2.10.10.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">
<span id="S1.T1.2.10.10.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">FedFSL-MI-Adv</span><span id="S1.T1.2.10.10.1.2" class="ltx_text" style="font-size:90%;"> (ours, </span><a href="#S4.SS2" title="4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">4.2</span></a><span id="S1.T1.2.10.10.1.3" class="ltx_text" style="font-size:90%;">)</span>
</td>
<td id="S1.T1.2.10.10.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S1.T1.2.10.10.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.10.10.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S1.T1.2.10.10.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.10.10.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S1.T1.2.10.10.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.10.10.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S1.T1.2.10.10.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.10.10.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S1.T1.2.10.10.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">✓</span></td>
<td id="S1.T1.2.10.10.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S1.T1.2.10.10.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">✓</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1. </span>Comparisons of relevant approaches with supported features.</figcaption>
</figure>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">A recently developed approach to address the issue of insufficient training data is few-shot learning (FSL) <cite class="ltx_cite ltx_citemacro_citep">(Vinyals et al<span class="ltx_text">.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2016</a>; Finn
et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2017</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2017</a>)</cite>. FSL aims to develop machine learning models to solve unseen tasks with very few labeled training data, but often in the context of a single data source.
In this paper, we propose a federated few-shot learning (FedFSL) framework for efficiently training few-shot classification models from many data sources. The few-shot model can tackle novel tasks with just a few labeled data for unseen classes. As shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the paradigm of FedFSL is to first perform local updates with few-shot tasks sampled from local data, then send local models to a central server for model aggregation and coordination.
Through inheriting the merits of FedL, FedFSL also preserves the data privacy and communication efficiency.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">FedFSL has many potential applications for utilizing machine learning models on mobile devices. For example, a few-shot language model can be used to suggest words by learning from just a few typing records from each of many users; a few-shot sentiment analysis model can be used to depict user profiles given only a few tweets posted by each of the many users; a few-shot face recognition model can identify users and their friends by learning from just few annotated photos by each of many mobile users.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">There are two technical challenges we encounter during the development of the FedFSL framework: 1) directly using the existing FedL approaches to the data-scarce scenarios may lead to misaligned decision boundaries produced by client models, and 2) constraining the decision boundaries to be similar over clients would develop a classifier overfit to training tasks but not transferable to unseen tasks. To address these issues, we propose to regularize local updates by minimizing the divergence between client models and the central model. We then formulate the training of the feature generator part and classifier part of the model in adversarial fashion. In this way, the client models are explicitly optimized to produce a discriminative feature space that can better represent unseen data samples. We demonstrate the intuitions and conduct experiments to show the effectiveness of our approaches.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">Our contributions can be summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a novel federated few-shot learning framework (FedFSL) that can perform effective federated learning on few-shot tasks. This represents the first step in addressing the commonly encountered but overlooked scenarios in mobile computing where training data is scarce and testing tasks are distinct.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We present the key innovations in formulating FSL with federated clients as well as explicitly optimizing the federated model by minimizing model discrepancy in challenging non-IID scenarios.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We define a novel concept of mutual divergence of federated client models, which can be minimized to better coordinate the client training on scarce local data.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">We design a dedicated adversarial learning approach to construct a discriminative feature space, which better generalizes to unseen tasks compared with existing training procedures of FSL models.</p>
</div>
</li>
<li id="S1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i5.p1" class="ltx_para">
<p id="S1.I1.i5.p1.1" class="ltx_p">We evaluate our framework by modelling different types of structured data (such as images and sentences) with both CNN and RNN models, showing its effectiveness and practical usability in modelling various learning tasks in machine vision and NLP.</p>
</div>
</li>
<li id="S1.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i6.p1" class="ltx_para">
<p id="S1.I1.i6.p1.1" class="ltx_p">Our approaches significantly outperform baselines that are either non-distributed or not aligning the feature space across the clients by more than 10% on vision tasks and 5% on language tasks.
</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">We will briefly review recent related work
in two categories: (i) studies
either federated learning (FedL) (e.g., <cite class="ltx_cite ltx_citemacro_citep">(McMahan
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2017</a>; Zhao
et al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2018</a>; Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2018</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2020c</a>; Dinh et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2019</a>; Zhang
et al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2020</a>)</cite>) or few-shot learning (FSL) (e.g., <cite class="ltx_cite ltx_citemacro_citep">(Vinyals et al<span class="ltx_text">.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2016</a>; Snell
et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2017</a>; Munkhdalai and Yu, <a href="#bib.bib25" title="" class="ltx_ref">2017</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2017</a>; Sun
et al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2019</a>; Gidaris and
Komodakis, <a href="#bib.bib10" title="" class="ltx_ref">2018</a>; Sung et al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2018</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2020a</a>)</cite>), or both of them <cite class="ltx_cite ltx_citemacro_citep">(Chen
et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite> (ii) studies proposing similar ideas of minimizing model divergence to better learn individual models or an ensemble model.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">To our best knowledge, training FSL models on distributed devices is still an under-explored open problem.
The first work of this topic was from
Chen <span id="S2.p2.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Chen
et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite> who explored federated meta-learning by applying FedAvg on meta-learning approaches such as MAML <cite class="ltx_cite ltx_citemacro_citep">(Finn
et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite> in a straightforward way. However, their goal is to improve supervised learning by better sharing models among
federated clients, instead of learning few-shot tasks.
They neither evaluated their models on FSL tasks, nor explicitly considered dealing with the underlying data heterogeneity in different devices (e.g., non-IID case) which can severely harm FSL.
Our model captures the idea of federating transferable knowledge
among distributed clients. We further explore the practical data-scarce scenarios and evaluate our models on challenging benchmark FSL datasets.
In addition, we explicitly resolve the data heterogeneity issue by proposing a family of more effective meta-learning approaches designed for federated settings.
</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">The other work that loosely connects FSL with FedL
is Li <span id="S2.p3.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2020b</a>)</cite>, which proposed a differentially private algorithm for securing parameter transfer across devices or learning stages. The authors considered FedL and FSL as two separated applications of their technique, and their goal is to secure data privacy during model sharing instead of performing FSL with federated devices.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">There are two recent studies relating to the techniques that we utilize to coordinate client model training and to learn the consistent feature space, though neither of them considered few-shot learning.
Yu <span id="S2.p4.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Yu
et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2020</a>)</cite> used knowledge distillation <cite class="ltx_cite ltx_citemacro_citep">(Hinton
et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2015</a>)</cite> (a variant of KL-divergence) in federated learning to learn different client models to better fit local data.
Our approach is different from theirs such that 1) they did not perform model aggregation as they want to train client models that fit on local data, but our method performs aggregation for learning a unified global model, 2) their method followed the normal supervised learning paradigm which cannot solve few-shot tasks, and 3) they did not consider feature space learning but our method does.
Zhang <span id="S2.p4.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhang
et al<span class="ltx_text">.</span>, <a href="#bib.bib45" title="" class="ltx_ref">2018b</a>)</cite> proposed to minimize the KL-divergence of every client model pair to enhance ensemble learning. However, this imposes heavy computation and communication costs in distributed scenarios. On the contrary, we propose to approximate the client pairwise KL-divergence with the divergence between the client model and the federated global model, which integrates into FedL seamlessly.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">It’s also worth to clarify that several recent studies <cite class="ltx_cite ltx_citemacro_citep">(Guha
et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2019</a>; Salehkaleybar et al<span class="ltx_text">.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2019</a>; Shin
et al<span class="ltx_text">.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite>
focused on reducing the communications of distributed learning with one or a few communication rounds under federated learning settings. Though this topic is also referred as “few-shot federated learning”, it’s totally different from our work which studies federated learning under data-scarce scenarios.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Federated Few-shot Learning</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we formulate the Federated Few-Shot Learning (FedFSL) framework in details. Specifically, we will study the few-shot classification task which learns to classify on novel classes with few training samples.
We will first review the general federated learning (FedL) objective in <a href="#S3.SS1" title="3.1. General Federated Learning Objective ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> and the general centralized few-shot learning (FSL) procedures in <a href="#S3.SS2" title="3.2. General Centralized Few-Shot Learning ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> respectively, based on which we propose the FedFSL formally in
<a href="#S3.SS3" title="3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>General Federated Learning Objective</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">First, we briefly review federated learning (FedL) paradigm and its common implementations in this subsection.
We consider a distributed system of <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation></semantics></math> clients, each owning a local data source. In FedL, each client trains a local machine learning model based on its local data, while a central server coordinates the clients periodically by collecting their parameters, aggregating them into a central model and sending its parameter back to all clients.
This process will repeat for multiple communication rounds until convergence or timeout.
</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.5" class="ltx_p">Formally, let
<math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">n</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝑛</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">n_{k}</annotation></semantics></math> be number of data samples of client <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">k</annotation></semantics></math>, <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="n=\sum_{k}n_{k}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">n</mi><mo rspace="0.111em" id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><msub id="S3.SS1.p2.3.m3.1.1.3.1" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml"><mo id="S3.SS1.p2.3.m3.1.1.3.1.2" xref="S3.SS1.p2.3.m3.1.1.3.1.2.cmml">∑</mo><mi id="S3.SS1.p2.3.m3.1.1.3.1.3" xref="S3.SS1.p2.3.m3.1.1.3.1.3.cmml">k</mi></msub><msub id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2.2" xref="S3.SS1.p2.3.m3.1.1.3.2.2.cmml">n</mi><mi id="S3.SS1.p2.3.m3.1.1.3.2.3" xref="S3.SS1.p2.3.m3.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><eq id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></eq><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝑛</ci><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><apply id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.1">subscript</csymbol><sum id="S3.SS1.p2.3.m3.1.1.3.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.1.2"></sum><ci id="S3.SS1.p2.3.m3.1.1.3.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.1.3">𝑘</ci></apply><apply id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2.2">𝑛</ci><ci id="S3.SS1.p2.3.m3.1.1.3.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">n=\sum_{k}n_{k}</annotation></semantics></math> be total samples across the devices, <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">w</annotation></semantics></math> be the learning model.
We consider a local objective for client <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">k</annotation></semantics></math> as the average loss over all data samples</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\small\mathcal{L}_{k}(w)=\frac{1}{n_{k}}\sum_{i=1}^{n_{k}}f(x_{i},y_{i};w)," display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.4" xref="S3.E1.m1.3.3.1.1.4.cmml"><msub id="S3.E1.m1.3.3.1.1.4.2" xref="S3.E1.m1.3.3.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E1.m1.3.3.1.1.4.2.2" xref="S3.E1.m1.3.3.1.1.4.2.2.cmml">ℒ</mi><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.4.2.3" xref="S3.E1.m1.3.3.1.1.4.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.4.1" xref="S3.E1.m1.3.3.1.1.4.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.4.3.2" xref="S3.E1.m1.3.3.1.1.4.cmml"><mo maxsize="90%" minsize="90%" id="S3.E1.m1.3.3.1.1.4.3.2.1" xref="S3.E1.m1.3.3.1.1.4.cmml">(</mo><mi mathsize="90%" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">w</mi><mo maxsize="90%" minsize="90%" id="S3.E1.m1.3.3.1.1.4.3.2.2" xref="S3.E1.m1.3.3.1.1.4.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml"><mfrac id="S3.E1.m1.3.3.1.1.2.4" xref="S3.E1.m1.3.3.1.1.2.4.cmml"><mn mathsize="90%" id="S3.E1.m1.3.3.1.1.2.4.2" xref="S3.E1.m1.3.3.1.1.2.4.2.cmml">1</mn><msub id="S3.E1.m1.3.3.1.1.2.4.3" xref="S3.E1.m1.3.3.1.1.2.4.3.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.2.4.3.2" xref="S3.E1.m1.3.3.1.1.2.4.3.2.cmml">n</mi><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.2.4.3.3" xref="S3.E1.m1.3.3.1.1.2.4.3.3.cmml">k</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.3" xref="S3.E1.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml"><munderover id="S3.E1.m1.3.3.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E1.m1.3.3.1.1.2.2.3.2.2" xref="S3.E1.m1.3.3.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.3.2.3" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.3.2.3.2" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.2.cmml">i</mi><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.3.2.3.1" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.1.cmml">=</mo><mn mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.3.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E1.m1.3.3.1.1.2.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.3.3.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.3.3.2" xref="S3.E1.m1.3.3.1.1.2.2.3.3.2.cmml">n</mi><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.3.3.3" xref="S3.E1.m1.3.3.1.1.2.2.3.3.3.cmml">k</mi></msub></munderover><mrow id="S3.E1.m1.3.3.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.4" xref="S3.E1.m1.3.3.1.1.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml">(</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.4" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo mathsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.5" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml">;</mo><mi mathsize="90%" id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">w</mi><mo maxsize="90%" minsize="90%" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.6" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"></eq><apply id="S3.E1.m1.3.3.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.4"><times id="S3.E1.m1.3.3.1.1.4.1.cmml" xref="S3.E1.m1.3.3.1.1.4.1"></times><apply id="S3.E1.m1.3.3.1.1.4.2.cmml" xref="S3.E1.m1.3.3.1.1.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.4.2.1.cmml" xref="S3.E1.m1.3.3.1.1.4.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.4.2.2.cmml" xref="S3.E1.m1.3.3.1.1.4.2.2">ℒ</ci><ci id="S3.E1.m1.3.3.1.1.4.2.3.cmml" xref="S3.E1.m1.3.3.1.1.4.2.3">𝑘</ci></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑤</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"><times id="S3.E1.m1.3.3.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.3"></times><apply id="S3.E1.m1.3.3.1.1.2.4.cmml" xref="S3.E1.m1.3.3.1.1.2.4"><divide id="S3.E1.m1.3.3.1.1.2.4.1.cmml" xref="S3.E1.m1.3.3.1.1.2.4"></divide><cn type="integer" id="S3.E1.m1.3.3.1.1.2.4.2.cmml" xref="S3.E1.m1.3.3.1.1.2.4.2">1</cn><apply id="S3.E1.m1.3.3.1.1.2.4.3.cmml" xref="S3.E1.m1.3.3.1.1.2.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.4.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.4.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.4.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.4.3.2">𝑛</ci><ci id="S3.E1.m1.3.3.1.1.2.4.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.4.3.3">𝑘</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.2.2.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.2"></sum><apply id="S3.E1.m1.3.3.1.1.2.2.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3"><eq id="S3.E1.m1.3.3.1.1.2.2.3.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.1"></eq><ci id="S3.E1.m1.3.3.1.1.2.2.3.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.3.3.1.1.2.2.3.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.3.2">𝑛</ci><ci id="S3.E1.m1.3.3.1.1.2.2.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3.3.3">𝑘</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2"><times id="S3.E1.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3"></times><ci id="S3.E1.m1.3.3.1.1.2.2.2.4.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4">𝑓</ci><vector id="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑤</ci></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\small\mathcal{L}_{k}(w)=\frac{1}{n_{k}}\sum_{i=1}^{n_{k}}f(x_{i},y_{i};w),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.10" class="ltx_p">in which <math id="S3.SS1.p2.6.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS1.p2.6.m1.1a"><mi id="S3.SS1.p2.6.m1.1.1" xref="S3.SS1.p2.6.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m1.1b"><ci id="S3.SS1.p2.6.m1.1.1.cmml" xref="S3.SS1.p2.6.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m1.1c">f</annotation></semantics></math> is a loss function that evaluates the prediction of model <math id="S3.SS1.p2.7.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p2.7.m2.1a"><mi id="S3.SS1.p2.7.m2.1.1" xref="S3.SS1.p2.7.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m2.1b"><ci id="S3.SS1.p2.7.m2.1.1.cmml" xref="S3.SS1.p2.7.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m2.1c">w</annotation></semantics></math> on a data sample <math id="S3.SS1.p2.8.m3.2" class="ltx_Math" alttext="(x_{i},y_{i})" display="inline"><semantics id="S3.SS1.p2.8.m3.2a"><mrow id="S3.SS1.p2.8.m3.2.2.2" xref="S3.SS1.p2.8.m3.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.8.m3.2.2.2.3" xref="S3.SS1.p2.8.m3.2.2.3.cmml">(</mo><msub id="S3.SS1.p2.8.m3.1.1.1.1" xref="S3.SS1.p2.8.m3.1.1.1.1.cmml"><mi id="S3.SS1.p2.8.m3.1.1.1.1.2" xref="S3.SS1.p2.8.m3.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p2.8.m3.1.1.1.1.3" xref="S3.SS1.p2.8.m3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p2.8.m3.2.2.2.4" xref="S3.SS1.p2.8.m3.2.2.3.cmml">,</mo><msub id="S3.SS1.p2.8.m3.2.2.2.2" xref="S3.SS1.p2.8.m3.2.2.2.2.cmml"><mi id="S3.SS1.p2.8.m3.2.2.2.2.2" xref="S3.SS1.p2.8.m3.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p2.8.m3.2.2.2.2.3" xref="S3.SS1.p2.8.m3.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p2.8.m3.2.2.2.5" xref="S3.SS1.p2.8.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m3.2b"><interval closure="open" id="S3.SS1.p2.8.m3.2.2.3.cmml" xref="S3.SS1.p2.8.m3.2.2.2"><apply id="S3.SS1.p2.8.m3.1.1.1.1.cmml" xref="S3.SS1.p2.8.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m3.1.1.1.1.1.cmml" xref="S3.SS1.p2.8.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.8.m3.1.1.1.1.2.cmml" xref="S3.SS1.p2.8.m3.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p2.8.m3.1.1.1.1.3.cmml" xref="S3.SS1.p2.8.m3.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p2.8.m3.2.2.2.2.cmml" xref="S3.SS1.p2.8.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m3.2.2.2.2.1.cmml" xref="S3.SS1.p2.8.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.8.m3.2.2.2.2.2.cmml" xref="S3.SS1.p2.8.m3.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p2.8.m3.2.2.2.2.3.cmml" xref="S3.SS1.p2.8.m3.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m3.2c">(x_{i},y_{i})</annotation></semantics></math>.
The type of loss function <math id="S3.SS1.p2.9.m4.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS1.p2.9.m4.1a"><mi id="S3.SS1.p2.9.m4.1.1" xref="S3.SS1.p2.9.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m4.1b"><ci id="S3.SS1.p2.9.m4.1.1.cmml" xref="S3.SS1.p2.9.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m4.1c">f</annotation></semantics></math> depends on the task and is known by all clients.
For example, in a classification task with deep neural networks (DNNs), <math id="S3.SS1.p2.10.m5.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS1.p2.10.m5.1a"><mi id="S3.SS1.p2.10.m5.1.1" xref="S3.SS1.p2.10.m5.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m5.1b"><ci id="S3.SS1.p2.10.m5.1.1.cmml" xref="S3.SS1.p2.10.m5.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m5.1c">f</annotation></semantics></math> is often chosen as the cross-entropy loss applied on the models’ probabilistic outputs.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.3" class="ltx_p">The global target is a weighted average of local objectives</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.3" class="ltx_Math" alttext="\small\underset{w}{\text{min}}\ \mathcal{L}(w)=\sum_{k=1}^{K}p_{k}\mathcal{L}_{k}(w)," display="block"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><munder accentunder="true" id="S3.E2.m1.3.3.1.1.2.2" xref="S3.E2.m1.3.3.1.1.2.2.cmml"><mtext mathsize="90%" id="S3.E2.m1.3.3.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2a.cmml">min</mtext><mo mathsize="90%" id="S3.E2.m1.3.3.1.1.2.2.1" xref="S3.E2.m1.3.3.1.1.2.2.1.cmml">𝑤</mo></munder><mo lspace="0.450em" rspace="0em" id="S3.E2.m1.3.3.1.1.2.1" xref="S3.E2.m1.3.3.1.1.2.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E2.m1.3.3.1.1.2.3" xref="S3.E2.m1.3.3.1.1.2.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.2.1a" xref="S3.E2.m1.3.3.1.1.2.1.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.2.4.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.E2.m1.3.3.1.1.2.4.2.1" xref="S3.E2.m1.3.3.1.1.2.cmml">(</mo><mi mathsize="90%" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">w</mi><mo maxsize="90%" minsize="90%" id="S3.E2.m1.3.3.1.1.2.4.2.2" xref="S3.E2.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.111em" id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><munderover id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E2.m1.3.3.1.1.3.1.2.2" xref="S3.E2.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.3.3.1.1.3.1.2.3" xref="S3.E2.m1.3.3.1.1.3.1.2.3.cmml"><mi mathsize="90%" id="S3.E2.m1.3.3.1.1.3.1.2.3.2" xref="S3.E2.m1.3.3.1.1.3.1.2.3.2.cmml">k</mi><mo mathsize="90%" id="S3.E2.m1.3.3.1.1.3.1.2.3.1" xref="S3.E2.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S3.E2.m1.3.3.1.1.3.1.2.3.3" xref="S3.E2.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S3.E2.m1.3.3.1.1.3.1.3" xref="S3.E2.m1.3.3.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml"><msub id="S3.E2.m1.3.3.1.1.3.2.2" xref="S3.E2.m1.3.3.1.1.3.2.2.cmml"><mi mathsize="90%" id="S3.E2.m1.3.3.1.1.3.2.2.2" xref="S3.E2.m1.3.3.1.1.3.2.2.2.cmml">p</mi><mi mathsize="90%" id="S3.E2.m1.3.3.1.1.3.2.2.3" xref="S3.E2.m1.3.3.1.1.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.2.1" xref="S3.E2.m1.3.3.1.1.3.2.1.cmml">​</mo><msub id="S3.E2.m1.3.3.1.1.3.2.3" xref="S3.E2.m1.3.3.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E2.m1.3.3.1.1.3.2.3.2" xref="S3.E2.m1.3.3.1.1.3.2.3.2.cmml">ℒ</mi><mi mathsize="90%" id="S3.E2.m1.3.3.1.1.3.2.3.3" xref="S3.E2.m1.3.3.1.1.3.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.2.1a" xref="S3.E2.m1.3.3.1.1.3.2.1.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.3.2.4.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.E2.m1.3.3.1.1.3.2.4.2.1" xref="S3.E2.m1.3.3.1.1.3.2.cmml">(</mo><mi mathsize="90%" id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">w</mi><mo maxsize="90%" minsize="90%" id="S3.E2.m1.3.3.1.1.3.2.4.2.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"></eq><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><times id="S3.E2.m1.3.3.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1"></times><apply id="S3.E2.m1.3.3.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2"><ci id="S3.E2.m1.3.3.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2.1">𝑤</ci><ci id="S3.E2.m1.3.3.1.1.2.2.2a.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2"><mtext mathsize="90%" id="S3.E2.m1.3.3.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2">min</mtext></ci></apply><ci id="S3.E2.m1.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3">ℒ</ci><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑤</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><apply id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.3.1.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S3.E2.m1.3.3.1.1.3.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.2.2"></sum><apply id="S3.E2.m1.3.3.1.1.3.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.2.3"><eq id="S3.E2.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S3.E2.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.3.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.3.3.1.1.3.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.3">𝐾</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2"><times id="S3.E2.m1.3.3.1.1.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.1"></times><apply id="S3.E2.m1.3.3.1.1.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.2">𝑝</ci><ci id="S3.E2.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2.3">𝑘</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3.2">ℒ</ci><ci id="S3.E2.m1.3.3.1.1.3.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3.3">𝑘</ci></apply><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\small\underset{w}{\text{min}}\ \mathcal{L}(w)=\sum_{k=1}^{K}p_{k}\mathcal{L}_{k}(w),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p3.2" class="ltx_p">in which <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="p_{k}=n_{k}/n" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><msub id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2.2" xref="S3.SS1.p3.1.m1.1.1.2.2.cmml">p</mi><mi id="S3.SS1.p3.1.m1.1.1.2.3" xref="S3.SS1.p3.1.m1.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><msub id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2.2" xref="S3.SS1.p3.1.m1.1.1.3.2.2.cmml">n</mi><mi id="S3.SS1.p3.1.m1.1.1.3.2.3" xref="S3.SS1.p3.1.m1.1.1.3.2.3.cmml">k</mi></msub><mo id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">/</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><eq id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></eq><apply id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2.2">𝑝</ci><ci id="S3.SS1.p3.1.m1.1.1.2.3.cmml" xref="S3.SS1.p3.1.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><divide id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1"></divide><apply id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.3.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.3.2.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2.2">𝑛</ci><ci id="S3.SS1.p3.1.m1.1.1.3.2.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">p_{k}=n_{k}/n</annotation></semantics></math>.
However, as direct data exchange is prohibited in FedL, directly optimizing the global objective (<a href="#S3.E2" title="In 3.1. General Federated Learning Objective ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) needs to perform a
full batch gradient descent on all data that each client holds, and perform
model aggregation after each client update. This requires high memory usage (if the client model is large) and excessive communications for exchanging models between clients and the server.
A common practice to resolve this issue is to approximate the global objective, such as in the
FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> algorithm which optimizes each local objective <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{k}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">ℒ</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">ℒ</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mathcal{L}_{k}</annotation></semantics></math> individually and in the FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2018</a>)</cite> which solves the local objectives with proximal terms to regularize training.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p">Existing FedL approaches often assume that the clients
always hold sufficient training data for a same task, e.g., all the clients should own enough data samples of the same categories in a classification task.
However, the realistic situation is each client may own a few labeled data samples for certain categories for training, and may encounter unlabeled data samples for testing with unseen true categories. This leads us to study the few-shot classification task which learns to classify on novel classes with few training samples in the following sections.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>General Centralized Few-Shot Learning</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.7" class="ltx_p">Next, we briefly review centralized few-shot learning (FSL) procedures. FSL aims to learn a generic model which can adapt to
unseen tasks with only a few labeled training samples. In this paper, we study the few-shot classification task which aims to classify novel classes. We define an <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">N</annotation></semantics></math>-way <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">P</annotation></semantics></math>-shot <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">Q</annotation></semantics></math>-query FSL task as a task of training a model with <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">P</annotation></semantics></math> labeled images for each of <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">N</annotation></semantics></math> classes and then
evaluating the model with <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">Q</annotation></semantics></math> unlabeled query images for each class. <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">P</annotation></semantics></math> is typically very small such as 1 or 5 as “few-shot” implies.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Let us consider a toy example of classifying animal pictures. The training data are images of cats and dogs which we call <span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_italic">base classes</span>. The testing data are images of tigers and wolves which we call <span id="S3.SS2.p2.1.2" class="ltx_text ltx_font_italic">novel classes</span>; each novel class owns one labeled image and many unlabeled images.
We wish to develop a model trained with base classes (cat and dog) that can predict on tiger and wolf (2-way) samples by observing each category just one labeled image (1-shot), i.e., a 2-way 1-shot FSL task.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2104.00365/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="152" height="35" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.3.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>. </span><span id="S3.F2.4.2" class="ltx_text" style="font-size:90%;">Three-step meta-learning of FSL.
</span></figcaption>
</figure>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">To train a capable FSL model, recent state-of-the-art work <cite class="ltx_cite ltx_citemacro_citep">(Gidaris and
Komodakis, <a href="#bib.bib10" title="" class="ltx_ref">2018</a>; Sung et al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2018</a>; Finn
et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2017</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2017</a>)</cite> adopted a training strategy called meta-learning which samples various few-shot tasks from training data and optimizes the model to fast adapt to these new tasks. The key idea of meta-learning is to learn some transferable knowledge from few data samples in training data that can apply on unseen data.
State-of-the-art gradient-based approaches <cite class="ltx_cite ltx_citemacro_citep">(Finn
et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2017</a>; Sun
et al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2019</a>)</cite> consider a good model initialization as transferable knowledge if it could adapt to various few-shot tasks with just a few gradient steps. They propose to explicitly search for such an initial model as follows.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">The training objective is to minimize the training loss over a batch of tasks <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{T}\in\mathcal{B}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">𝒯</mi><mo id="S3.SS2.p4.1.m1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">ℬ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><in id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1"></in><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝒯</ci><ci id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\mathcal{T}\in\mathcal{B}</annotation></semantics></math> as follows</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.20" class="ltx_Math" alttext="\begin{split}w^{*}&amp;=\underset{w}{\text{min}}\ \mathcal{L}(w)=\frac{1}{|\mathcal{B}|}\sum_{\mathcal{T}\in\mathcal{B}}\ell_{\mathcal{T}}(w),\\
\end{split}" display="block"><semantics id="S3.E3.m1.20a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E3.m1.20.20.2"><mtr id="S3.E3.m1.20.20.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.20.20.2b"><msup id="S3.E3.m1.2.2.2.2.2"><mi id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">w</mi><mo id="S3.E3.m1.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml">∗</mo></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E3.m1.20.20.2c"><mrow id="S3.E3.m1.20.20.2.19.19.17.17"><mrow id="S3.E3.m1.20.20.2.19.19.17.17.1"><mi id="S3.E3.m1.20.20.2.19.19.17.17.1.2" xref="S3.E3.m1.19.19.1.1.1.cmml"></mi><mo id="S3.E3.m1.3.3.3.3.1.1" xref="S3.E3.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S3.E3.m1.20.20.2.19.19.17.17.1.3"><munder accentunder="true" id="S3.E3.m1.4.4.4.4.2.2" xref="S3.E3.m1.4.4.4.4.2.2.cmml"><mtext id="S3.E3.m1.4.4.4.4.2.2.2" xref="S3.E3.m1.4.4.4.4.2.2.2a.cmml">min</mtext><mo id="S3.E3.m1.4.4.4.4.2.2.1" xref="S3.E3.m1.4.4.4.4.2.2.1.cmml">𝑤</mo></munder><mo lspace="0em" rspace="0em" id="S3.E3.m1.20.20.2.19.19.17.17.1.3.1" xref="S3.E3.m1.19.19.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.5.5.3.3" xref="S3.E3.m1.5.5.5.5.3.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.20.20.2.19.19.17.17.1.3.1a" xref="S3.E3.m1.19.19.1.1.1.cmml">​</mo><mrow id="S3.E3.m1.20.20.2.19.19.17.17.1.3.2"><mo stretchy="false" id="S3.E3.m1.6.6.6.6.4.4" xref="S3.E3.m1.19.19.1.1.1.cmml">(</mo><mi id="S3.E3.m1.7.7.7.7.5.5" xref="S3.E3.m1.7.7.7.7.5.5.cmml">w</mi><mo stretchy="false" id="S3.E3.m1.8.8.8.8.6.6" xref="S3.E3.m1.19.19.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.9.9.9.9.7.7" xref="S3.E3.m1.9.9.9.9.7.7.cmml">=</mo><mrow id="S3.E3.m1.20.20.2.19.19.17.17.1.4"><mfrac id="S3.E3.m1.10.10.10.10.8.8" xref="S3.E3.m1.10.10.10.10.8.8.cmml"><mn id="S3.E3.m1.10.10.10.10.8.8.3" xref="S3.E3.m1.10.10.10.10.8.8.3.cmml">1</mn><mrow id="S3.E3.m1.10.10.10.10.8.8.1.3" xref="S3.E3.m1.10.10.10.10.8.8.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.10.10.10.10.8.8.1.3.1" xref="S3.E3.m1.10.10.10.10.8.8.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.10.10.10.10.8.8.1.1" xref="S3.E3.m1.10.10.10.10.8.8.1.1.cmml">ℬ</mi><mo stretchy="false" id="S3.E3.m1.10.10.10.10.8.8.1.3.2" xref="S3.E3.m1.10.10.10.10.8.8.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.20.20.2.19.19.17.17.1.4.1" xref="S3.E3.m1.19.19.1.1.1.cmml">​</mo><mrow id="S3.E3.m1.20.20.2.19.19.17.17.1.4.2"><munder id="S3.E3.m1.20.20.2.19.19.17.17.1.4.2.1"><mo movablelimits="false" id="S3.E3.m1.11.11.11.11.9.9" xref="S3.E3.m1.11.11.11.11.9.9.cmml">∑</mo><mrow id="S3.E3.m1.12.12.12.12.10.10.1" xref="S3.E3.m1.12.12.12.12.10.10.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.12.12.12.12.10.10.1.2" xref="S3.E3.m1.12.12.12.12.10.10.1.2.cmml">𝒯</mi><mo id="S3.E3.m1.12.12.12.12.10.10.1.1" xref="S3.E3.m1.12.12.12.12.10.10.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.12.12.12.12.10.10.1.3" xref="S3.E3.m1.12.12.12.12.10.10.1.3.cmml">ℬ</mi></mrow></munder><mrow id="S3.E3.m1.20.20.2.19.19.17.17.1.4.2.2"><msub id="S3.E3.m1.20.20.2.19.19.17.17.1.4.2.2.2"><mi mathvariant="normal" id="S3.E3.m1.13.13.13.13.11.11" xref="S3.E3.m1.13.13.13.13.11.11.cmml">ℓ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.14.14.14.14.12.12.1" xref="S3.E3.m1.14.14.14.14.12.12.1.cmml">𝒯</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.20.20.2.19.19.17.17.1.4.2.2.1" xref="S3.E3.m1.19.19.1.1.1.cmml">​</mo><mrow id="S3.E3.m1.20.20.2.19.19.17.17.1.4.2.2.3"><mo stretchy="false" id="S3.E3.m1.15.15.15.15.13.13" xref="S3.E3.m1.19.19.1.1.1.cmml">(</mo><mi id="S3.E3.m1.16.16.16.16.14.14" xref="S3.E3.m1.16.16.16.16.14.14.cmml">w</mi><mo stretchy="false" id="S3.E3.m1.17.17.17.17.15.15" xref="S3.E3.m1.19.19.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.18.18.18.18.16.16" xref="S3.E3.m1.19.19.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.20b"><apply id="S3.E3.m1.19.19.1.1.1.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"><and id="S3.E3.m1.19.19.1.1.1a.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"></and><apply id="S3.E3.m1.19.19.1.1.1b.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"><eq id="S3.E3.m1.3.3.3.3.1.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1"></eq><apply id="S3.E3.m1.19.19.1.1.1.2.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.1.1.1.2.1.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">𝑤</ci><times id="S3.E3.m1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1"></times></apply><apply id="S3.E3.m1.19.19.1.1.1.4.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"><times id="S3.E3.m1.19.19.1.1.1.4.1.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"></times><apply id="S3.E3.m1.4.4.4.4.2.2.cmml" xref="S3.E3.m1.4.4.4.4.2.2"><ci id="S3.E3.m1.4.4.4.4.2.2.1.cmml" xref="S3.E3.m1.4.4.4.4.2.2.1">𝑤</ci><ci id="S3.E3.m1.4.4.4.4.2.2.2a.cmml" xref="S3.E3.m1.4.4.4.4.2.2.2"><mtext id="S3.E3.m1.4.4.4.4.2.2.2.cmml" xref="S3.E3.m1.4.4.4.4.2.2.2">min</mtext></ci></apply><ci id="S3.E3.m1.5.5.5.5.3.3.cmml" xref="S3.E3.m1.5.5.5.5.3.3">ℒ</ci><ci id="S3.E3.m1.7.7.7.7.5.5.cmml" xref="S3.E3.m1.7.7.7.7.5.5">𝑤</ci></apply></apply><apply id="S3.E3.m1.19.19.1.1.1c.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"><eq id="S3.E3.m1.9.9.9.9.7.7.cmml" xref="S3.E3.m1.9.9.9.9.7.7"></eq><share href="#S3.E3.m1.19.19.1.1.1.4.cmml" id="S3.E3.m1.19.19.1.1.1d.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"></share><apply id="S3.E3.m1.19.19.1.1.1.6.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"><times id="S3.E3.m1.19.19.1.1.1.6.1.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"></times><apply id="S3.E3.m1.10.10.10.10.8.8.cmml" xref="S3.E3.m1.10.10.10.10.8.8"><divide id="S3.E3.m1.10.10.10.10.8.8.2.cmml" xref="S3.E3.m1.10.10.10.10.8.8"></divide><cn type="integer" id="S3.E3.m1.10.10.10.10.8.8.3.cmml" xref="S3.E3.m1.10.10.10.10.8.8.3">1</cn><apply id="S3.E3.m1.10.10.10.10.8.8.1.2.cmml" xref="S3.E3.m1.10.10.10.10.8.8.1.3"><abs id="S3.E3.m1.10.10.10.10.8.8.1.2.1.cmml" xref="S3.E3.m1.10.10.10.10.8.8.1.3.1"></abs><ci id="S3.E3.m1.10.10.10.10.8.8.1.1.cmml" xref="S3.E3.m1.10.10.10.10.8.8.1.1">ℬ</ci></apply></apply><apply id="S3.E3.m1.19.19.1.1.1.6.3.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"><apply id="S3.E3.m1.19.19.1.1.1.6.3.1.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.1.1.1.6.3.1.1.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2">subscript</csymbol><sum id="S3.E3.m1.11.11.11.11.9.9.cmml" xref="S3.E3.m1.11.11.11.11.9.9"></sum><apply id="S3.E3.m1.12.12.12.12.10.10.1.cmml" xref="S3.E3.m1.12.12.12.12.10.10.1"><in id="S3.E3.m1.12.12.12.12.10.10.1.1.cmml" xref="S3.E3.m1.12.12.12.12.10.10.1.1"></in><ci id="S3.E3.m1.12.12.12.12.10.10.1.2.cmml" xref="S3.E3.m1.12.12.12.12.10.10.1.2">𝒯</ci><ci id="S3.E3.m1.12.12.12.12.10.10.1.3.cmml" xref="S3.E3.m1.12.12.12.12.10.10.1.3">ℬ</ci></apply></apply><apply id="S3.E3.m1.19.19.1.1.1.6.3.2.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"><times id="S3.E3.m1.19.19.1.1.1.6.3.2.1.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"></times><apply id="S3.E3.m1.19.19.1.1.1.6.3.2.2.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.1.1.1.6.3.2.2.1.cmml" xref="S3.E3.m1.20.20.2.19.19.17.17.1.2">subscript</csymbol><ci id="S3.E3.m1.13.13.13.13.11.11.cmml" xref="S3.E3.m1.13.13.13.13.11.11">ℓ</ci><ci id="S3.E3.m1.14.14.14.14.12.12.1.cmml" xref="S3.E3.m1.14.14.14.14.12.12.1">𝒯</ci></apply><ci id="S3.E3.m1.16.16.16.16.14.14.cmml" xref="S3.E3.m1.16.16.16.16.14.14">𝑤</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.20c">\begin{split}w^{*}&amp;=\underset{w}{\text{min}}\ \mathcal{L}(w)=\frac{1}{|\mathcal{B}|}\sum_{\mathcal{T}\in\mathcal{B}}\ell_{\mathcal{T}}(w),\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p4.3" class="ltx_p">in which <math id="S3.SS2.p4.2.m1.1" class="ltx_Math" alttext="w^{*}" display="inline"><semantics id="S3.SS2.p4.2.m1.1a"><msup id="S3.SS2.p4.2.m1.1.1" xref="S3.SS2.p4.2.m1.1.1.cmml"><mi id="S3.SS2.p4.2.m1.1.1.2" xref="S3.SS2.p4.2.m1.1.1.2.cmml">w</mi><mo id="S3.SS2.p4.2.m1.1.1.3" xref="S3.SS2.p4.2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m1.1b"><apply id="S3.SS2.p4.2.m1.1.1.cmml" xref="S3.SS2.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m1.1.1.1.cmml" xref="S3.SS2.p4.2.m1.1.1">superscript</csymbol><ci id="S3.SS2.p4.2.m1.1.1.2.cmml" xref="S3.SS2.p4.2.m1.1.1.2">𝑤</ci><times id="S3.SS2.p4.2.m1.1.1.3.cmml" xref="S3.SS2.p4.2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m1.1c">w^{*}</annotation></semantics></math> is the optimized model that trains to fast adapt to new tasks and <math id="S3.SS2.p4.3.m2.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.SS2.p4.3.m2.1a"><mi mathvariant="normal" id="S3.SS2.p4.3.m2.1.1" xref="S3.SS2.p4.3.m2.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m2.1b"><ci id="S3.SS2.p4.3.m2.1.1.cmml" xref="S3.SS2.p4.3.m2.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m2.1c">\ell</annotation></semantics></math> is a task loss. This can be tackled with an iterative approach in which each iteration can be decomposed into three steps, as shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2. General Centralized Few-Shot Learning ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.11" class="ltx_p"><span id="S3.I1.i1.p1.11.1" class="ltx_text ltx_font_bold">Sampling step:</span> The first step is to sample a few-shot task
<math id="S3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S3.I1.i1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">\mathcal{T}</annotation></semantics></math>, also called an <span id="S3.I1.i1.p1.11.2" class="ltx_text ltx_font_italic">episode</span>, from base classes.
For an <math id="S3.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.I1.i1.p1.2.m2.1a"><mi id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><ci id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">N</annotation></semantics></math>-way <math id="S3.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.I1.i1.p1.3.m3.1a"><mi id="S3.I1.i1.p1.3.m3.1.1" xref="S3.I1.i1.p1.3.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m3.1b"><ci id="S3.I1.i1.p1.3.m3.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m3.1c">P</annotation></semantics></math>-shot <math id="S3.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.I1.i1.p1.4.m4.1a"><mi id="S3.I1.i1.p1.4.m4.1.1" xref="S3.I1.i1.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.4.m4.1b"><ci id="S3.I1.i1.p1.4.m4.1.1.cmml" xref="S3.I1.i1.p1.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.4.m4.1c">Q</annotation></semantics></math>-query few-shot task, an episode consists of <math id="S3.I1.i1.p1.5.m5.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.I1.i1.p1.5.m5.1a"><mi id="S3.I1.i1.p1.5.m5.1.1" xref="S3.I1.i1.p1.5.m5.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.5.m5.1b"><ci id="S3.I1.i1.p1.5.m5.1.1.cmml" xref="S3.I1.i1.p1.5.m5.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.5.m5.1c">P</annotation></semantics></math> data instances sampled from each of <math id="S3.I1.i1.p1.6.m6.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.I1.i1.p1.6.m6.1a"><mi id="S3.I1.i1.p1.6.m6.1.1" xref="S3.I1.i1.p1.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.6.m6.1b"><ci id="S3.I1.i1.p1.6.m6.1.1.cmml" xref="S3.I1.i1.p1.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.6.m6.1c">N</annotation></semantics></math> distinct base classes as a support set <math id="S3.I1.i1.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{T}^{(s)}" display="inline"><semantics id="S3.I1.i1.p1.7.m7.1a"><msup id="S3.I1.i1.p1.7.m7.1.2" xref="S3.I1.i1.p1.7.m7.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i1.p1.7.m7.1.2.2" xref="S3.I1.i1.p1.7.m7.1.2.2.cmml">𝒯</mi><mrow id="S3.I1.i1.p1.7.m7.1.1.1.3" xref="S3.I1.i1.p1.7.m7.1.2.cmml"><mo stretchy="false" id="S3.I1.i1.p1.7.m7.1.1.1.3.1" xref="S3.I1.i1.p1.7.m7.1.2.cmml">(</mo><mi id="S3.I1.i1.p1.7.m7.1.1.1.1" xref="S3.I1.i1.p1.7.m7.1.1.1.1.cmml">s</mi><mo stretchy="false" id="S3.I1.i1.p1.7.m7.1.1.1.3.2" xref="S3.I1.i1.p1.7.m7.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.7.m7.1b"><apply id="S3.I1.i1.p1.7.m7.1.2.cmml" xref="S3.I1.i1.p1.7.m7.1.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.7.m7.1.2.1.cmml" xref="S3.I1.i1.p1.7.m7.1.2">superscript</csymbol><ci id="S3.I1.i1.p1.7.m7.1.2.2.cmml" xref="S3.I1.i1.p1.7.m7.1.2.2">𝒯</ci><ci id="S3.I1.i1.p1.7.m7.1.1.1.1.cmml" xref="S3.I1.i1.p1.7.m7.1.1.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.7.m7.1c">\mathcal{T}^{(s)}</annotation></semantics></math>, and <math id="S3.I1.i1.p1.8.m8.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.I1.i1.p1.8.m8.1a"><mi id="S3.I1.i1.p1.8.m8.1.1" xref="S3.I1.i1.p1.8.m8.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.8.m8.1b"><ci id="S3.I1.i1.p1.8.m8.1.1.cmml" xref="S3.I1.i1.p1.8.m8.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.8.m8.1c">Q</annotation></semantics></math> data instances sampled from the same <math id="S3.I1.i1.p1.9.m9.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.I1.i1.p1.9.m9.1a"><mi id="S3.I1.i1.p1.9.m9.1.1" xref="S3.I1.i1.p1.9.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.9.m9.1b"><ci id="S3.I1.i1.p1.9.m9.1.1.cmml" xref="S3.I1.i1.p1.9.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.9.m9.1c">N</annotation></semantics></math> classes as a query set <math id="S3.I1.i1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{T}^{(q)}" display="inline"><semantics id="S3.I1.i1.p1.10.m10.1a"><msup id="S3.I1.i1.p1.10.m10.1.2" xref="S3.I1.i1.p1.10.m10.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i1.p1.10.m10.1.2.2" xref="S3.I1.i1.p1.10.m10.1.2.2.cmml">𝒯</mi><mrow id="S3.I1.i1.p1.10.m10.1.1.1.3" xref="S3.I1.i1.p1.10.m10.1.2.cmml"><mo stretchy="false" id="S3.I1.i1.p1.10.m10.1.1.1.3.1" xref="S3.I1.i1.p1.10.m10.1.2.cmml">(</mo><mi id="S3.I1.i1.p1.10.m10.1.1.1.1" xref="S3.I1.i1.p1.10.m10.1.1.1.1.cmml">q</mi><mo stretchy="false" id="S3.I1.i1.p1.10.m10.1.1.1.3.2" xref="S3.I1.i1.p1.10.m10.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.10.m10.1b"><apply id="S3.I1.i1.p1.10.m10.1.2.cmml" xref="S3.I1.i1.p1.10.m10.1.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.10.m10.1.2.1.cmml" xref="S3.I1.i1.p1.10.m10.1.2">superscript</csymbol><ci id="S3.I1.i1.p1.10.m10.1.2.2.cmml" xref="S3.I1.i1.p1.10.m10.1.2.2">𝒯</ci><ci id="S3.I1.i1.p1.10.m10.1.1.1.1.cmml" xref="S3.I1.i1.p1.10.m10.1.1.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.10.m10.1c">\mathcal{T}^{(q)}</annotation></semantics></math>, which gives a total of <math id="S3.I1.i1.p1.11.m11.1" class="ltx_Math" alttext="(P+Q)\cdot N" display="inline"><semantics id="S3.I1.i1.p1.11.m11.1a"><mrow id="S3.I1.i1.p1.11.m11.1.1" xref="S3.I1.i1.p1.11.m11.1.1.cmml"><mrow id="S3.I1.i1.p1.11.m11.1.1.1.1" xref="S3.I1.i1.p1.11.m11.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.I1.i1.p1.11.m11.1.1.1.1.2" xref="S3.I1.i1.p1.11.m11.1.1.1.1.1.cmml">(</mo><mrow id="S3.I1.i1.p1.11.m11.1.1.1.1.1" xref="S3.I1.i1.p1.11.m11.1.1.1.1.1.cmml"><mi id="S3.I1.i1.p1.11.m11.1.1.1.1.1.2" xref="S3.I1.i1.p1.11.m11.1.1.1.1.1.2.cmml">P</mi><mo id="S3.I1.i1.p1.11.m11.1.1.1.1.1.1" xref="S3.I1.i1.p1.11.m11.1.1.1.1.1.1.cmml">+</mo><mi id="S3.I1.i1.p1.11.m11.1.1.1.1.1.3" xref="S3.I1.i1.p1.11.m11.1.1.1.1.1.3.cmml">Q</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.I1.i1.p1.11.m11.1.1.1.1.3" xref="S3.I1.i1.p1.11.m11.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.I1.i1.p1.11.m11.1.1.2" xref="S3.I1.i1.p1.11.m11.1.1.2.cmml">⋅</mo><mi id="S3.I1.i1.p1.11.m11.1.1.3" xref="S3.I1.i1.p1.11.m11.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.11.m11.1b"><apply id="S3.I1.i1.p1.11.m11.1.1.cmml" xref="S3.I1.i1.p1.11.m11.1.1"><ci id="S3.I1.i1.p1.11.m11.1.1.2.cmml" xref="S3.I1.i1.p1.11.m11.1.1.2">⋅</ci><apply id="S3.I1.i1.p1.11.m11.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.11.m11.1.1.1.1"><plus id="S3.I1.i1.p1.11.m11.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.11.m11.1.1.1.1.1.1"></plus><ci id="S3.I1.i1.p1.11.m11.1.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.11.m11.1.1.1.1.1.2">𝑃</ci><ci id="S3.I1.i1.p1.11.m11.1.1.1.1.1.3.cmml" xref="S3.I1.i1.p1.11.m11.1.1.1.1.1.3">𝑄</ci></apply><ci id="S3.I1.i1.p1.11.m11.1.1.3.cmml" xref="S3.I1.i1.p1.11.m11.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.11.m11.1c">(P+Q)\cdot N</annotation></semantics></math> instances.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p"><span id="S3.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Adaptation step:</span> The second step is to adapt the current model to the sampled task with gradient descents. This step uses the few labeled data in the support set <math id="S3.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{T}^{(s)}" display="inline"><semantics id="S3.I1.i2.p1.1.m1.1a"><msup id="S3.I1.i2.p1.1.m1.1.2" xref="S3.I1.i2.p1.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p1.1.m1.1.2.2" xref="S3.I1.i2.p1.1.m1.1.2.2.cmml">𝒯</mi><mrow id="S3.I1.i2.p1.1.m1.1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.I1.i2.p1.1.m1.1.1.1.3.1" xref="S3.I1.i2.p1.1.m1.1.2.cmml">(</mo><mi id="S3.I1.i2.p1.1.m1.1.1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.1.1.cmml">s</mi><mo stretchy="false" id="S3.I1.i2.p1.1.m1.1.1.1.3.2" xref="S3.I1.i2.p1.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.1.2.1.cmml" xref="S3.I1.i2.p1.1.m1.1.2">superscript</csymbol><ci id="S3.I1.i2.p1.1.m1.1.2.2.cmml" xref="S3.I1.i2.p1.1.m1.1.2.2">𝒯</ci><ci id="S3.I1.i2.p1.1.m1.1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">\mathcal{T}^{(s)}</annotation></semantics></math> and performs one or several gradient steps towards optimizing the model weights to the sampled task such that</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.16" class="ltx_Math" alttext="\begin{split}w^{{}^{\prime}}=w-\alpha\nabla_{w}f_{\mathcal{T}^{(s)}}(w),\end{split}" display="block"><semantics id="S3.E4.m1.16a"><mtable displaystyle="true" id="S3.E4.m1.16.16.2"><mtr id="S3.E4.m1.16.16.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.16.16.2b"><mrow id="S3.E4.m1.16.16.2.15.15.15.15"><mrow id="S3.E4.m1.16.16.2.15.15.15.15.1"><msup id="S3.E4.m1.16.16.2.15.15.15.15.1.1"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">w</mi><msup id="S3.E4.m1.2.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.1a" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml"></mi><mo id="S3.E4.m1.2.2.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">′</mo></msup></msup><mo id="S3.E4.m1.3.3.3.3.3.3" xref="S3.E4.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E4.m1.16.16.2.15.15.15.15.1.2"><mi id="S3.E4.m1.4.4.4.4.4.4" xref="S3.E4.m1.4.4.4.4.4.4.cmml">w</mi><mo id="S3.E4.m1.5.5.5.5.5.5" xref="S3.E4.m1.5.5.5.5.5.5.cmml">−</mo><mrow id="S3.E4.m1.16.16.2.15.15.15.15.1.2.1"><mi id="S3.E4.m1.6.6.6.6.6.6" xref="S3.E4.m1.6.6.6.6.6.6.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1" xref="S3.E4.m1.15.15.1.1.1.cmml">​</mo><mrow id="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.2"><msub id="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.2.1"><mo rspace="0.167em" id="S3.E4.m1.7.7.7.7.7.7" xref="S3.E4.m1.7.7.7.7.7.7.cmml">∇</mo><mi id="S3.E4.m1.8.8.8.8.8.8.1" xref="S3.E4.m1.8.8.8.8.8.8.1.cmml">w</mi></msub><msub id="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.2.2"><mi id="S3.E4.m1.9.9.9.9.9.9" xref="S3.E4.m1.9.9.9.9.9.9.cmml">f</mi><msup id="S3.E4.m1.10.10.10.10.10.10.1" xref="S3.E4.m1.10.10.10.10.10.10.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.10.10.10.10.10.10.1.3" xref="S3.E4.m1.10.10.10.10.10.10.1.3.cmml">𝒯</mi><mrow id="S3.E4.m1.10.10.10.10.10.10.1.1.1.3" xref="S3.E4.m1.10.10.10.10.10.10.1.cmml"><mo stretchy="false" id="S3.E4.m1.10.10.10.10.10.10.1.1.1.3.1" xref="S3.E4.m1.10.10.10.10.10.10.1.cmml">(</mo><mi id="S3.E4.m1.10.10.10.10.10.10.1.1.1.1" xref="S3.E4.m1.10.10.10.10.10.10.1.1.1.1.cmml">s</mi><mo stretchy="false" id="S3.E4.m1.10.10.10.10.10.10.1.1.1.3.2" xref="S3.E4.m1.10.10.10.10.10.10.1.cmml">)</mo></mrow></msup></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1a" xref="S3.E4.m1.15.15.1.1.1.cmml">​</mo><mrow id="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.3"><mo stretchy="false" id="S3.E4.m1.11.11.11.11.11.11" xref="S3.E4.m1.15.15.1.1.1.cmml">(</mo><mi id="S3.E4.m1.12.12.12.12.12.12" xref="S3.E4.m1.12.12.12.12.12.12.cmml">w</mi><mo stretchy="false" id="S3.E4.m1.13.13.13.13.13.13" xref="S3.E4.m1.15.15.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.14.14.14.14.14.14" xref="S3.E4.m1.15.15.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.16b"><apply id="S3.E4.m1.15.15.1.1.1.cmml" xref="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1"><eq id="S3.E4.m1.3.3.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3.3.3"></eq><apply id="S3.E4.m1.15.15.1.1.1.2.cmml" xref="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.15.15.1.1.1.2.1.cmml" xref="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝑤</ci><apply id="S3.E4.m1.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1"><ci id="S3.E4.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.1">′</ci></apply></apply><apply id="S3.E4.m1.15.15.1.1.1.3.cmml" xref="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1"><minus id="S3.E4.m1.5.5.5.5.5.5.cmml" xref="S3.E4.m1.5.5.5.5.5.5"></minus><ci id="S3.E4.m1.4.4.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4.4.4">𝑤</ci><apply id="S3.E4.m1.15.15.1.1.1.3.3.cmml" xref="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1"><times id="S3.E4.m1.15.15.1.1.1.3.3.1.cmml" xref="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1"></times><ci id="S3.E4.m1.6.6.6.6.6.6.cmml" xref="S3.E4.m1.6.6.6.6.6.6">𝛼</ci><apply id="S3.E4.m1.15.15.1.1.1.3.3.3.cmml" xref="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1"><apply id="S3.E4.m1.15.15.1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.15.15.1.1.1.3.3.3.1.1.cmml" xref="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1">subscript</csymbol><ci id="S3.E4.m1.7.7.7.7.7.7.cmml" xref="S3.E4.m1.7.7.7.7.7.7">∇</ci><ci id="S3.E4.m1.8.8.8.8.8.8.1.cmml" xref="S3.E4.m1.8.8.8.8.8.8.1">𝑤</ci></apply><apply id="S3.E4.m1.15.15.1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.15.15.1.1.1.3.3.3.2.1.cmml" xref="S3.E4.m1.16.16.2.15.15.15.15.1.2.1.1">subscript</csymbol><ci id="S3.E4.m1.9.9.9.9.9.9.cmml" xref="S3.E4.m1.9.9.9.9.9.9">𝑓</ci><apply id="S3.E4.m1.10.10.10.10.10.10.1.cmml" xref="S3.E4.m1.10.10.10.10.10.10.1"><csymbol cd="ambiguous" id="S3.E4.m1.10.10.10.10.10.10.1.2.cmml" xref="S3.E4.m1.10.10.10.10.10.10.1">superscript</csymbol><ci id="S3.E4.m1.10.10.10.10.10.10.1.3.cmml" xref="S3.E4.m1.10.10.10.10.10.10.1.3">𝒯</ci><ci id="S3.E4.m1.10.10.10.10.10.10.1.1.1.1.cmml" xref="S3.E4.m1.10.10.10.10.10.10.1.1.1.1">𝑠</ci></apply></apply></apply><ci id="S3.E4.m1.12.12.12.12.12.12.cmml" xref="S3.E4.m1.12.12.12.12.12.12">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.16c">\begin{split}w^{{}^{\prime}}=w-\alpha\nabla_{w}f_{\mathcal{T}^{(s)}}(w),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.I1.i2.p1.3" class="ltx_p">in which <math id="S3.I1.i2.p1.2.m1.1" class="ltx_Math" alttext="w^{\prime}" display="inline"><semantics id="S3.I1.i2.p1.2.m1.1a"><msup id="S3.I1.i2.p1.2.m1.1.1" xref="S3.I1.i2.p1.2.m1.1.1.cmml"><mi id="S3.I1.i2.p1.2.m1.1.1.2" xref="S3.I1.i2.p1.2.m1.1.1.2.cmml">w</mi><mo id="S3.I1.i2.p1.2.m1.1.1.3" xref="S3.I1.i2.p1.2.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m1.1b"><apply id="S3.I1.i2.p1.2.m1.1.1.cmml" xref="S3.I1.i2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.2.m1.1.1.1.cmml" xref="S3.I1.i2.p1.2.m1.1.1">superscript</csymbol><ci id="S3.I1.i2.p1.2.m1.1.1.2.cmml" xref="S3.I1.i2.p1.2.m1.1.1.2">𝑤</ci><ci id="S3.I1.i2.p1.2.m1.1.1.3.cmml" xref="S3.I1.i2.p1.2.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m1.1c">w^{\prime}</annotation></semantics></math> is the adapted model, <math id="S3.I1.i2.p1.3.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.I1.i2.p1.3.m2.1a"><mi id="S3.I1.i2.p1.3.m2.1.1" xref="S3.I1.i2.p1.3.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m2.1b"><ci id="S3.I1.i2.p1.3.m2.1.1.cmml" xref="S3.I1.i2.p1.3.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m2.1c">\alpha</annotation></semantics></math> is the step size. </p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.2" class="ltx_p"><span id="S3.I1.i3.p1.2.1" class="ltx_text ltx_font_bold">Optimization step:</span> The final step is to evaluate <math id="S3.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="w^{\prime}" display="inline"><semantics id="S3.I1.i3.p1.1.m1.1a"><msup id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml"><mi id="S3.I1.i3.p1.1.m1.1.1.2" xref="S3.I1.i3.p1.1.m1.1.1.2.cmml">w</mi><mo id="S3.I1.i3.p1.1.m1.1.1.3" xref="S3.I1.i3.p1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><apply id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.1.m1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.I1.i3.p1.1.m1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.1.1.2">𝑤</ci><ci id="S3.I1.i3.p1.1.m1.1.1.3.cmml" xref="S3.I1.i3.p1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">w^{\prime}</annotation></semantics></math> with more samples in the query set <math id="S3.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{T}^{(q)}" display="inline"><semantics id="S3.I1.i3.p1.2.m2.1a"><msup id="S3.I1.i3.p1.2.m2.1.2" xref="S3.I1.i3.p1.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i3.p1.2.m2.1.2.2" xref="S3.I1.i3.p1.2.m2.1.2.2.cmml">𝒯</mi><mrow id="S3.I1.i3.p1.2.m2.1.1.1.3" xref="S3.I1.i3.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.I1.i3.p1.2.m2.1.1.1.3.1" xref="S3.I1.i3.p1.2.m2.1.2.cmml">(</mo><mi id="S3.I1.i3.p1.2.m2.1.1.1.1" xref="S3.I1.i3.p1.2.m2.1.1.1.1.cmml">q</mi><mo stretchy="false" id="S3.I1.i3.p1.2.m2.1.1.1.3.2" xref="S3.I1.i3.p1.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.2.m2.1b"><apply id="S3.I1.i3.p1.2.m2.1.2.cmml" xref="S3.I1.i3.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S3.I1.i3.p1.2.m2.1.2.1.cmml" xref="S3.I1.i3.p1.2.m2.1.2">superscript</csymbol><ci id="S3.I1.i3.p1.2.m2.1.2.2.cmml" xref="S3.I1.i3.p1.2.m2.1.2.2">𝒯</ci><ci id="S3.I1.i3.p1.2.m2.1.1.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.2.m2.1c">\mathcal{T}^{(q)}</annotation></semantics></math> with the empirical loss function</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.29" class="ltx_Math" alttext="\begin{split}\ell_{\mathcal{T}}(w)&amp;=f_{\mathcal{T}^{(q)}}(w^{\prime})=f_{\mathcal{T}^{(q)}}(w-\alpha\nabla f_{\mathcal{T}^{(s)}}(w)),\\
\end{split}" display="block"><semantics id="S3.E5.m1.29a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E5.m1.29.29.2"><mtr id="S3.E5.m1.29.29.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.29.29.2b"><mrow id="S3.E5.m1.5.5.5.5.5"><msub id="S3.E5.m1.5.5.5.5.5.7"><mi mathvariant="normal" id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">ℓ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.2.1.cmml">𝒯</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.5.5.5.5.5.6" xref="S3.E5.m1.28.28.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.5.5.5.5.5.8"><mo stretchy="false" id="S3.E5.m1.3.3.3.3.3.3" xref="S3.E5.m1.28.28.1.1.1.cmml">(</mo><mi id="S3.E5.m1.4.4.4.4.4.4" xref="S3.E5.m1.4.4.4.4.4.4.cmml">w</mi><mo stretchy="false" id="S3.E5.m1.5.5.5.5.5.5" xref="S3.E5.m1.28.28.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.29.29.2c"><mrow id="S3.E5.m1.29.29.2.28.28.23.23"><mrow id="S3.E5.m1.29.29.2.28.28.23.23.1"><mi id="S3.E5.m1.29.29.2.28.28.23.23.1.4" xref="S3.E5.m1.28.28.1.1.1.cmml"></mi><mo id="S3.E5.m1.6.6.6.6.1.1" xref="S3.E5.m1.6.6.6.6.1.1.cmml">=</mo><mrow id="S3.E5.m1.29.29.2.28.28.23.23.1.1"><msub id="S3.E5.m1.29.29.2.28.28.23.23.1.1.3"><mi id="S3.E5.m1.7.7.7.7.2.2" xref="S3.E5.m1.7.7.7.7.2.2.cmml">f</mi><msup id="S3.E5.m1.8.8.8.8.3.3.1" xref="S3.E5.m1.8.8.8.8.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.8.8.8.8.3.3.1.3" xref="S3.E5.m1.8.8.8.8.3.3.1.3.cmml">𝒯</mi><mrow id="S3.E5.m1.8.8.8.8.3.3.1.1.1.3" xref="S3.E5.m1.8.8.8.8.3.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.8.8.8.8.3.3.1.1.1.3.1" xref="S3.E5.m1.8.8.8.8.3.3.1.cmml">(</mo><mi id="S3.E5.m1.8.8.8.8.3.3.1.1.1.1" xref="S3.E5.m1.8.8.8.8.3.3.1.1.1.1.cmml">q</mi><mo stretchy="false" id="S3.E5.m1.8.8.8.8.3.3.1.1.1.3.2" xref="S3.E5.m1.8.8.8.8.3.3.1.cmml">)</mo></mrow></msup></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.29.29.2.28.28.23.23.1.1.2" xref="S3.E5.m1.28.28.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.29.29.2.28.28.23.23.1.1.1.1"><mo stretchy="false" id="S3.E5.m1.9.9.9.9.4.4" xref="S3.E5.m1.28.28.1.1.1.cmml">(</mo><msup id="S3.E5.m1.29.29.2.28.28.23.23.1.1.1.1.1"><mi id="S3.E5.m1.10.10.10.10.5.5" xref="S3.E5.m1.10.10.10.10.5.5.cmml">w</mi><mo id="S3.E5.m1.11.11.11.11.6.6.1" xref="S3.E5.m1.11.11.11.11.6.6.1.cmml">′</mo></msup><mo stretchy="false" id="S3.E5.m1.12.12.12.12.7.7" xref="S3.E5.m1.28.28.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.13.13.13.13.8.8" xref="S3.E5.m1.13.13.13.13.8.8.cmml">=</mo><mrow id="S3.E5.m1.29.29.2.28.28.23.23.1.2"><msub id="S3.E5.m1.29.29.2.28.28.23.23.1.2.3"><mi id="S3.E5.m1.14.14.14.14.9.9" xref="S3.E5.m1.14.14.14.14.9.9.cmml">f</mi><msup id="S3.E5.m1.15.15.15.15.10.10.1" xref="S3.E5.m1.15.15.15.15.10.10.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.15.15.15.15.10.10.1.3" xref="S3.E5.m1.15.15.15.15.10.10.1.3.cmml">𝒯</mi><mrow id="S3.E5.m1.15.15.15.15.10.10.1.1.1.3" xref="S3.E5.m1.15.15.15.15.10.10.1.cmml"><mo stretchy="false" id="S3.E5.m1.15.15.15.15.10.10.1.1.1.3.1" xref="S3.E5.m1.15.15.15.15.10.10.1.cmml">(</mo><mi id="S3.E5.m1.15.15.15.15.10.10.1.1.1.1" xref="S3.E5.m1.15.15.15.15.10.10.1.1.1.1.cmml">q</mi><mo stretchy="false" id="S3.E5.m1.15.15.15.15.10.10.1.1.1.3.2" xref="S3.E5.m1.15.15.15.15.10.10.1.cmml">)</mo></mrow></msup></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.29.29.2.28.28.23.23.1.2.2" xref="S3.E5.m1.28.28.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.29.29.2.28.28.23.23.1.2.1.1"><mo stretchy="false" id="S3.E5.m1.16.16.16.16.11.11" xref="S3.E5.m1.28.28.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.29.29.2.28.28.23.23.1.2.1.1.1"><mi id="S3.E5.m1.17.17.17.17.12.12" xref="S3.E5.m1.17.17.17.17.12.12.cmml">w</mi><mo id="S3.E5.m1.18.18.18.18.13.13" xref="S3.E5.m1.18.18.18.18.13.13.cmml">−</mo><mrow id="S3.E5.m1.29.29.2.28.28.23.23.1.2.1.1.1.1"><mi id="S3.E5.m1.19.19.19.19.14.14" xref="S3.E5.m1.19.19.19.19.14.14.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="S3.E5.m1.29.29.2.28.28.23.23.1.2.1.1.1.1.1" xref="S3.E5.m1.28.28.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.29.29.2.28.28.23.23.1.2.1.1.1.1.2"><mo rspace="0.167em" id="S3.E5.m1.20.20.20.20.15.15" xref="S3.E5.m1.20.20.20.20.15.15.cmml">∇</mo><msub id="S3.E5.m1.29.29.2.28.28.23.23.1.2.1.1.1.1.2.1"><mi id="S3.E5.m1.21.21.21.21.16.16" xref="S3.E5.m1.21.21.21.21.16.16.cmml">f</mi><msup id="S3.E5.m1.22.22.22.22.17.17.1" xref="S3.E5.m1.22.22.22.22.17.17.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.22.22.22.22.17.17.1.3" xref="S3.E5.m1.22.22.22.22.17.17.1.3.cmml">𝒯</mi><mrow id="S3.E5.m1.22.22.22.22.17.17.1.1.1.3" xref="S3.E5.m1.22.22.22.22.17.17.1.cmml"><mo stretchy="false" id="S3.E5.m1.22.22.22.22.17.17.1.1.1.3.1" xref="S3.E5.m1.22.22.22.22.17.17.1.cmml">(</mo><mi id="S3.E5.m1.22.22.22.22.17.17.1.1.1.1" xref="S3.E5.m1.22.22.22.22.17.17.1.1.1.1.cmml">s</mi><mo stretchy="false" id="S3.E5.m1.22.22.22.22.17.17.1.1.1.3.2" xref="S3.E5.m1.22.22.22.22.17.17.1.cmml">)</mo></mrow></msup></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.29.29.2.28.28.23.23.1.2.1.1.1.1.1a" xref="S3.E5.m1.28.28.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.29.29.2.28.28.23.23.1.2.1.1.1.1.3"><mo stretchy="false" id="S3.E5.m1.23.23.23.23.18.18" xref="S3.E5.m1.28.28.1.1.1.cmml">(</mo><mi id="S3.E5.m1.24.24.24.24.19.19" xref="S3.E5.m1.24.24.24.24.19.19.cmml">w</mi><mo stretchy="false" id="S3.E5.m1.25.25.25.25.20.20" xref="S3.E5.m1.28.28.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E5.m1.26.26.26.26.21.21" xref="S3.E5.m1.28.28.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.27.27.27.27.22.22" xref="S3.E5.m1.28.28.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E5.m1.29b"><apply id="S3.E5.m1.28.28.1.1.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><and id="S3.E5.m1.28.28.1.1.1a.cmml" xref="S3.E5.m1.5.5.5.5.5.6"></and><apply id="S3.E5.m1.28.28.1.1.1b.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><eq id="S3.E5.m1.6.6.6.6.1.1.cmml" xref="S3.E5.m1.6.6.6.6.1.1"></eq><apply id="S3.E5.m1.28.28.1.1.1.4.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><times id="S3.E5.m1.28.28.1.1.1.4.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6"></times><apply id="S3.E5.m1.28.28.1.1.1.4.2.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><csymbol cd="ambiguous" id="S3.E5.m1.28.28.1.1.1.4.2.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">ℓ</ci><ci id="S3.E5.m1.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.1">𝒯</ci></apply><ci id="S3.E5.m1.4.4.4.4.4.4.cmml" xref="S3.E5.m1.4.4.4.4.4.4">𝑤</ci></apply><apply id="S3.E5.m1.28.28.1.1.1.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><times id="S3.E5.m1.28.28.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.5.5.5.6"></times><apply id="S3.E5.m1.28.28.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><csymbol cd="ambiguous" id="S3.E5.m1.28.28.1.1.1.1.3.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6">subscript</csymbol><ci id="S3.E5.m1.7.7.7.7.2.2.cmml" xref="S3.E5.m1.7.7.7.7.2.2">𝑓</ci><apply id="S3.E5.m1.8.8.8.8.3.3.1.cmml" xref="S3.E5.m1.8.8.8.8.3.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.8.3.3.1.2.cmml" xref="S3.E5.m1.8.8.8.8.3.3.1">superscript</csymbol><ci id="S3.E5.m1.8.8.8.8.3.3.1.3.cmml" xref="S3.E5.m1.8.8.8.8.3.3.1.3">𝒯</ci><ci id="S3.E5.m1.8.8.8.8.3.3.1.1.1.1.cmml" xref="S3.E5.m1.8.8.8.8.3.3.1.1.1.1">𝑞</ci></apply></apply><apply id="S3.E5.m1.28.28.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><csymbol cd="ambiguous" id="S3.E5.m1.28.28.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6">superscript</csymbol><ci id="S3.E5.m1.10.10.10.10.5.5.cmml" xref="S3.E5.m1.10.10.10.10.5.5">𝑤</ci><ci id="S3.E5.m1.11.11.11.11.6.6.1.cmml" xref="S3.E5.m1.11.11.11.11.6.6.1">′</ci></apply></apply></apply><apply id="S3.E5.m1.28.28.1.1.1c.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><eq id="S3.E5.m1.13.13.13.13.8.8.cmml" xref="S3.E5.m1.13.13.13.13.8.8"></eq><share href="#S3.E5.m1.28.28.1.1.1.1.cmml" id="S3.E5.m1.28.28.1.1.1d.cmml" xref="S3.E5.m1.5.5.5.5.5.6"></share><apply id="S3.E5.m1.28.28.1.1.1.2.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><times id="S3.E5.m1.28.28.1.1.1.2.2.cmml" xref="S3.E5.m1.5.5.5.5.5.6"></times><apply id="S3.E5.m1.28.28.1.1.1.2.3.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><csymbol cd="ambiguous" id="S3.E5.m1.28.28.1.1.1.2.3.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6">subscript</csymbol><ci id="S3.E5.m1.14.14.14.14.9.9.cmml" xref="S3.E5.m1.14.14.14.14.9.9">𝑓</ci><apply id="S3.E5.m1.15.15.15.15.10.10.1.cmml" xref="S3.E5.m1.15.15.15.15.10.10.1"><csymbol cd="ambiguous" id="S3.E5.m1.15.15.15.15.10.10.1.2.cmml" xref="S3.E5.m1.15.15.15.15.10.10.1">superscript</csymbol><ci id="S3.E5.m1.15.15.15.15.10.10.1.3.cmml" xref="S3.E5.m1.15.15.15.15.10.10.1.3">𝒯</ci><ci id="S3.E5.m1.15.15.15.15.10.10.1.1.1.1.cmml" xref="S3.E5.m1.15.15.15.15.10.10.1.1.1.1">𝑞</ci></apply></apply><apply id="S3.E5.m1.28.28.1.1.1.2.1.1.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><minus id="S3.E5.m1.18.18.18.18.13.13.cmml" xref="S3.E5.m1.18.18.18.18.13.13"></minus><ci id="S3.E5.m1.17.17.17.17.12.12.cmml" xref="S3.E5.m1.17.17.17.17.12.12">𝑤</ci><apply id="S3.E5.m1.28.28.1.1.1.2.1.1.1.3.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><times id="S3.E5.m1.28.28.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6"></times><ci id="S3.E5.m1.19.19.19.19.14.14.cmml" xref="S3.E5.m1.19.19.19.19.14.14">𝛼</ci><apply id="S3.E5.m1.28.28.1.1.1.2.1.1.1.3.3.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><ci id="S3.E5.m1.20.20.20.20.15.15.cmml" xref="S3.E5.m1.20.20.20.20.15.15">∇</ci><apply id="S3.E5.m1.28.28.1.1.1.2.1.1.1.3.3.2.cmml" xref="S3.E5.m1.5.5.5.5.5.6"><csymbol cd="ambiguous" id="S3.E5.m1.28.28.1.1.1.2.1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.5.5.5.5.5.6">subscript</csymbol><ci id="S3.E5.m1.21.21.21.21.16.16.cmml" xref="S3.E5.m1.21.21.21.21.16.16">𝑓</ci><apply id="S3.E5.m1.22.22.22.22.17.17.1.cmml" xref="S3.E5.m1.22.22.22.22.17.17.1"><csymbol cd="ambiguous" id="S3.E5.m1.22.22.22.22.17.17.1.2.cmml" xref="S3.E5.m1.22.22.22.22.17.17.1">superscript</csymbol><ci id="S3.E5.m1.22.22.22.22.17.17.1.3.cmml" xref="S3.E5.m1.22.22.22.22.17.17.1.3">𝒯</ci><ci id="S3.E5.m1.22.22.22.22.17.17.1.1.1.1.cmml" xref="S3.E5.m1.22.22.22.22.17.17.1.1.1.1">𝑠</ci></apply></apply></apply><ci id="S3.E5.m1.24.24.24.24.19.19.cmml" xref="S3.E5.m1.24.24.24.24.19.19">𝑤</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.29c">\begin{split}\ell_{\mathcal{T}}(w)&amp;=f_{\mathcal{T}^{(q)}}(w^{\prime})=f_{\mathcal{T}^{(q)}}(w-\alpha\nabla f_{\mathcal{T}^{(s)}}(w)),\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.I1.i3.p1.4" class="ltx_p">which can be
solved by another gradient descent</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.15" class="ltx_Math" alttext="\begin{split}w\leftarrow w-\beta\ \nabla_{w}\ell_{\mathcal{T}}(w),\end{split}" display="block"><semantics id="S3.E6.m1.15a"><mtable displaystyle="true" id="S3.E6.m1.15.15.2"><mtr id="S3.E6.m1.15.15.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.15.15.2b"><mrow id="S3.E6.m1.15.15.2.14.14.14.14"><mrow id="S3.E6.m1.15.15.2.14.14.14.14.1"><mi id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">w</mi><mo stretchy="false" id="S3.E6.m1.2.2.2.2.2.2" xref="S3.E6.m1.2.2.2.2.2.2.cmml">←</mo><mrow id="S3.E6.m1.15.15.2.14.14.14.14.1.1"><mi id="S3.E6.m1.3.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.3.cmml">w</mi><mo id="S3.E6.m1.4.4.4.4.4.4" xref="S3.E6.m1.4.4.4.4.4.4.cmml">−</mo><mrow id="S3.E6.m1.15.15.2.14.14.14.14.1.1.1"><mi id="S3.E6.m1.5.5.5.5.5.5" xref="S3.E6.m1.5.5.5.5.5.5.cmml">β</mi><mo lspace="0.667em" rspace="0em" id="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.1" xref="S3.E6.m1.14.14.1.1.1.cmml">​</mo><mrow id="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.2"><msub id="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.2.1"><mo rspace="0.167em" id="S3.E6.m1.6.6.6.6.6.6" xref="S3.E6.m1.6.6.6.6.6.6.cmml">∇</mo><mi id="S3.E6.m1.7.7.7.7.7.7.1" xref="S3.E6.m1.7.7.7.7.7.7.1.cmml">w</mi></msub><msub id="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.2.2"><mi mathvariant="normal" id="S3.E6.m1.8.8.8.8.8.8" xref="S3.E6.m1.8.8.8.8.8.8.cmml">ℓ</mi><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.9.9.9.9.9.9.1" xref="S3.E6.m1.9.9.9.9.9.9.1.cmml">𝒯</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.1a" xref="S3.E6.m1.14.14.1.1.1.cmml">​</mo><mrow id="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.3"><mo stretchy="false" id="S3.E6.m1.10.10.10.10.10.10" xref="S3.E6.m1.14.14.1.1.1.cmml">(</mo><mi id="S3.E6.m1.11.11.11.11.11.11" xref="S3.E6.m1.11.11.11.11.11.11.cmml">w</mi><mo stretchy="false" id="S3.E6.m1.12.12.12.12.12.12" xref="S3.E6.m1.14.14.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.13.13.13.13.13.13" xref="S3.E6.m1.14.14.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E6.m1.15b"><apply id="S3.E6.m1.14.14.1.1.1.cmml" xref="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.1"><ci id="S3.E6.m1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2">←</ci><ci id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">𝑤</ci><apply id="S3.E6.m1.14.14.1.1.1.3.cmml" xref="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.1"><minus id="S3.E6.m1.4.4.4.4.4.4.cmml" xref="S3.E6.m1.4.4.4.4.4.4"></minus><ci id="S3.E6.m1.3.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3">𝑤</ci><apply id="S3.E6.m1.14.14.1.1.1.3.3.cmml" xref="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.1"><times id="S3.E6.m1.14.14.1.1.1.3.3.1.cmml" xref="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.1"></times><ci id="S3.E6.m1.5.5.5.5.5.5.cmml" xref="S3.E6.m1.5.5.5.5.5.5">𝛽</ci><apply id="S3.E6.m1.14.14.1.1.1.3.3.3.cmml" xref="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.1"><apply id="S3.E6.m1.14.14.1.1.1.3.3.3.1.cmml" xref="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.14.14.1.1.1.3.3.3.1.1.cmml" xref="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.6.6.6.6.6.6.cmml" xref="S3.E6.m1.6.6.6.6.6.6">∇</ci><ci id="S3.E6.m1.7.7.7.7.7.7.1.cmml" xref="S3.E6.m1.7.7.7.7.7.7.1">𝑤</ci></apply><apply id="S3.E6.m1.14.14.1.1.1.3.3.3.2.cmml" xref="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.14.14.1.1.1.3.3.3.2.1.cmml" xref="S3.E6.m1.15.15.2.14.14.14.14.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.8.8.8.8.8.8.cmml" xref="S3.E6.m1.8.8.8.8.8.8">ℓ</ci><ci id="S3.E6.m1.9.9.9.9.9.9.1.cmml" xref="S3.E6.m1.9.9.9.9.9.9.1">𝒯</ci></apply></apply><ci id="S3.E6.m1.11.11.11.11.11.11.cmml" xref="S3.E6.m1.11.11.11.11.11.11">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.15c">\begin{split}w\leftarrow w-\beta\ \nabla_{w}\ell_{\mathcal{T}}(w),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.I1.i3.p1.3" class="ltx_p">in which <math id="S3.I1.i3.p1.3.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.I1.i3.p1.3.m1.1a"><mi id="S3.I1.i3.p1.3.m1.1.1" xref="S3.I1.i3.p1.3.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.3.m1.1b"><ci id="S3.I1.i3.p1.3.m1.1.1.cmml" xref="S3.I1.i3.p1.3.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.3.m1.1c">\beta</annotation></semantics></math> is the learning rate.</p>
</div>
</li>
</ul>
<p id="S3.SS2.p4.4" class="ltx_p">The above procedures are summarized in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2. General Centralized Few-Shot Learning ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
For a centralized FSL to converge, the sampling-adaptation-optimization procedures are repeated for many iterations. This will produce the optimal parameter that best adapts to few-shot tasks.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">During inference, a learned FSL model firstly adapts to unseen tasks with a few labeled samples with (<a href="#S3.E4" title="In 2nd item ‣ 3.2. General Centralized Few-Shot Learning ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), then predicts the labels on query samples. In our toy example mentioned above, the model is trained with cat and dog samples to discern two species, then is used to classify tiger and wolf samples with its learned capacity of distinguishing patterns.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2104.00365/assets/x3.png" id="S3.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="133" height="95" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.3.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>. </span><span id="S3.F3.4.2" class="ltx_text" style="font-size:90%;">Demo of a two-client case of FedFSL based on meta-learning procedure.
</span></figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Federated Few-shot Learning (FedFSL)</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">As our purpose is to facilitate distributed devices to learn models for few-shot tasks, we need study how to design such a framework in which meta-learning procedures can be integrated in the federated learning.
We propose Federated Few-shot Learning (FedFSL) in this section. The goal of FedFSL is to search for a <span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_italic">global</span> optimal model <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="w^{*}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msup id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">w</mi><mo id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑤</ci><times id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">w^{*}</annotation></semantics></math> learned on distributed data sources that can best perform few-shot tasks.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.3" class="ltx_p">Suppose we have <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">K</annotation></semantics></math> participating clients and each of them can sample batches of few-shot tasks <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{T}_{k}\in\mathcal{B}_{k}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><msub id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.cmml">𝒯</mi><mi id="S3.SS3.p2.2.m2.1.1.2.3" xref="S3.SS3.p2.2.m2.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">∈</mo><msub id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.3.2.cmml">ℬ</mi><mi id="S3.SS3.p2.2.m2.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><in id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"></in><apply id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2">𝒯</ci><ci id="S3.SS3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.2">ℬ</ci><ci id="S3.SS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathcal{T}_{k}\in\mathcal{B}_{k}</annotation></semantics></math> from their local data sources as discussed in previous section. We first define <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">k</annotation></semantics></math>-th client’s local FSL objective by extending from (<a href="#S3.E3" title="In 3.2. General Centralized Few-Shot Learning ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>)</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.17" class="ltx_Math" alttext="\begin{split}\mathcal{L}_{k}(w)&amp;=\frac{1}{|\mathcal{B}_{k}|}\sum_{\mathcal{T}_{k}\in\mathcal{B}_{k}}\ell_{\mathcal{T}_{k}}(w),\\
\end{split}" display="block"><semantics id="S3.E7.m1.17a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E7.m1.17.17.2"><mtr id="S3.E7.m1.17.17.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E7.m1.17.17.2b"><mrow id="S3.E7.m1.5.5.5.5.5"><msub id="S3.E7.m1.5.5.5.5.5.7"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml">ℒ</mi><mi id="S3.E7.m1.2.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.2.1.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.5.5.5.6" xref="S3.E7.m1.16.16.1.1.1.cmml">​</mo><mrow id="S3.E7.m1.5.5.5.5.5.8"><mo stretchy="false" id="S3.E7.m1.3.3.3.3.3.3" xref="S3.E7.m1.16.16.1.1.1.cmml">(</mo><mi id="S3.E7.m1.4.4.4.4.4.4" xref="S3.E7.m1.4.4.4.4.4.4.cmml">w</mi><mo stretchy="false" id="S3.E7.m1.5.5.5.5.5.5" xref="S3.E7.m1.16.16.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.17.17.2c"><mrow id="S3.E7.m1.17.17.2.16.16.11.11"><mrow id="S3.E7.m1.17.17.2.16.16.11.11.1"><mi id="S3.E7.m1.17.17.2.16.16.11.11.1.1" xref="S3.E7.m1.16.16.1.1.1.cmml"></mi><mo id="S3.E7.m1.6.6.6.6.1.1" xref="S3.E7.m1.6.6.6.6.1.1.cmml">=</mo><mrow id="S3.E7.m1.17.17.2.16.16.11.11.1.2"><mfrac id="S3.E7.m1.7.7.7.7.2.2" xref="S3.E7.m1.7.7.7.7.2.2.cmml"><mn id="S3.E7.m1.7.7.7.7.2.2.3" xref="S3.E7.m1.7.7.7.7.2.2.3.cmml">1</mn><mrow id="S3.E7.m1.7.7.7.7.2.2.1.1" xref="S3.E7.m1.7.7.7.7.2.2.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.7.7.7.7.2.2.1.1.2" xref="S3.E7.m1.7.7.7.7.2.2.1.2.1.cmml">|</mo><msub id="S3.E7.m1.7.7.7.7.2.2.1.1.1" xref="S3.E7.m1.7.7.7.7.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.7.7.7.7.2.2.1.1.1.2" xref="S3.E7.m1.7.7.7.7.2.2.1.1.1.2.cmml">ℬ</mi><mi id="S3.E7.m1.7.7.7.7.2.2.1.1.1.3" xref="S3.E7.m1.7.7.7.7.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E7.m1.7.7.7.7.2.2.1.1.3" xref="S3.E7.m1.7.7.7.7.2.2.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E7.m1.17.17.2.16.16.11.11.1.2.1" xref="S3.E7.m1.16.16.1.1.1.cmml">​</mo><mrow id="S3.E7.m1.17.17.2.16.16.11.11.1.2.2"><munder id="S3.E7.m1.17.17.2.16.16.11.11.1.2.2.1"><mo movablelimits="false" id="S3.E7.m1.8.8.8.8.3.3" xref="S3.E7.m1.8.8.8.8.3.3.cmml">∑</mo><mrow id="S3.E7.m1.9.9.9.9.4.4.1" xref="S3.E7.m1.9.9.9.9.4.4.1.cmml"><msub id="S3.E7.m1.9.9.9.9.4.4.1.2" xref="S3.E7.m1.9.9.9.9.4.4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.9.9.9.9.4.4.1.2.2" xref="S3.E7.m1.9.9.9.9.4.4.1.2.2.cmml">𝒯</mi><mi id="S3.E7.m1.9.9.9.9.4.4.1.2.3" xref="S3.E7.m1.9.9.9.9.4.4.1.2.3.cmml">k</mi></msub><mo id="S3.E7.m1.9.9.9.9.4.4.1.1" xref="S3.E7.m1.9.9.9.9.4.4.1.1.cmml">∈</mo><msub id="S3.E7.m1.9.9.9.9.4.4.1.3" xref="S3.E7.m1.9.9.9.9.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.9.9.9.9.4.4.1.3.2" xref="S3.E7.m1.9.9.9.9.4.4.1.3.2.cmml">ℬ</mi><mi id="S3.E7.m1.9.9.9.9.4.4.1.3.3" xref="S3.E7.m1.9.9.9.9.4.4.1.3.3.cmml">k</mi></msub></mrow></munder><mrow id="S3.E7.m1.17.17.2.16.16.11.11.1.2.2.2"><msub id="S3.E7.m1.17.17.2.16.16.11.11.1.2.2.2.2"><mi mathvariant="normal" id="S3.E7.m1.10.10.10.10.5.5" xref="S3.E7.m1.10.10.10.10.5.5.cmml">ℓ</mi><msub id="S3.E7.m1.11.11.11.11.6.6.1" xref="S3.E7.m1.11.11.11.11.6.6.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.11.11.11.11.6.6.1.2" xref="S3.E7.m1.11.11.11.11.6.6.1.2.cmml">𝒯</mi><mi id="S3.E7.m1.11.11.11.11.6.6.1.3" xref="S3.E7.m1.11.11.11.11.6.6.1.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.17.17.2.16.16.11.11.1.2.2.2.1" xref="S3.E7.m1.16.16.1.1.1.cmml">​</mo><mrow id="S3.E7.m1.17.17.2.16.16.11.11.1.2.2.2.3"><mo stretchy="false" id="S3.E7.m1.12.12.12.12.7.7" xref="S3.E7.m1.16.16.1.1.1.cmml">(</mo><mi id="S3.E7.m1.13.13.13.13.8.8" xref="S3.E7.m1.13.13.13.13.8.8.cmml">w</mi><mo stretchy="false" id="S3.E7.m1.14.14.14.14.9.9" xref="S3.E7.m1.16.16.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.15.15.15.15.10.10" xref="S3.E7.m1.16.16.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E7.m1.17b"><apply id="S3.E7.m1.16.16.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.6"><eq id="S3.E7.m1.6.6.6.6.1.1.cmml" xref="S3.E7.m1.6.6.6.6.1.1"></eq><apply id="S3.E7.m1.16.16.1.1.1.2.cmml" xref="S3.E7.m1.5.5.5.5.5.6"><times id="S3.E7.m1.16.16.1.1.1.2.1.cmml" xref="S3.E7.m1.5.5.5.5.5.6"></times><apply id="S3.E7.m1.16.16.1.1.1.2.2.cmml" xref="S3.E7.m1.5.5.5.5.5.6"><csymbol cd="ambiguous" id="S3.E7.m1.16.16.1.1.1.2.2.1.cmml" xref="S3.E7.m1.5.5.5.5.5.6">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">ℒ</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1">𝑘</ci></apply><ci id="S3.E7.m1.4.4.4.4.4.4.cmml" xref="S3.E7.m1.4.4.4.4.4.4">𝑤</ci></apply><apply id="S3.E7.m1.16.16.1.1.1.3.cmml" xref="S3.E7.m1.5.5.5.5.5.6"><times id="S3.E7.m1.16.16.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.5.5.5.6"></times><apply id="S3.E7.m1.7.7.7.7.2.2.cmml" xref="S3.E7.m1.7.7.7.7.2.2"><divide id="S3.E7.m1.7.7.7.7.2.2.2.cmml" xref="S3.E7.m1.7.7.7.7.2.2"></divide><cn type="integer" id="S3.E7.m1.7.7.7.7.2.2.3.cmml" xref="S3.E7.m1.7.7.7.7.2.2.3">1</cn><apply id="S3.E7.m1.7.7.7.7.2.2.1.2.cmml" xref="S3.E7.m1.7.7.7.7.2.2.1.1"><abs id="S3.E7.m1.7.7.7.7.2.2.1.2.1.cmml" xref="S3.E7.m1.7.7.7.7.2.2.1.1.2"></abs><apply id="S3.E7.m1.7.7.7.7.2.2.1.1.1.cmml" xref="S3.E7.m1.7.7.7.7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.7.7.2.2.1.1.1.1.cmml" xref="S3.E7.m1.7.7.7.7.2.2.1.1.1">subscript</csymbol><ci id="S3.E7.m1.7.7.7.7.2.2.1.1.1.2.cmml" xref="S3.E7.m1.7.7.7.7.2.2.1.1.1.2">ℬ</ci><ci id="S3.E7.m1.7.7.7.7.2.2.1.1.1.3.cmml" xref="S3.E7.m1.7.7.7.7.2.2.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S3.E7.m1.16.16.1.1.1.3.3.cmml" xref="S3.E7.m1.5.5.5.5.5.6"><apply id="S3.E7.m1.16.16.1.1.1.3.3.1.cmml" xref="S3.E7.m1.5.5.5.5.5.6"><csymbol cd="ambiguous" id="S3.E7.m1.16.16.1.1.1.3.3.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.6">subscript</csymbol><sum id="S3.E7.m1.8.8.8.8.3.3.cmml" xref="S3.E7.m1.8.8.8.8.3.3"></sum><apply id="S3.E7.m1.9.9.9.9.4.4.1.cmml" xref="S3.E7.m1.9.9.9.9.4.4.1"><in id="S3.E7.m1.9.9.9.9.4.4.1.1.cmml" xref="S3.E7.m1.9.9.9.9.4.4.1.1"></in><apply id="S3.E7.m1.9.9.9.9.4.4.1.2.cmml" xref="S3.E7.m1.9.9.9.9.4.4.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.9.9.4.4.1.2.1.cmml" xref="S3.E7.m1.9.9.9.9.4.4.1.2">subscript</csymbol><ci id="S3.E7.m1.9.9.9.9.4.4.1.2.2.cmml" xref="S3.E7.m1.9.9.9.9.4.4.1.2.2">𝒯</ci><ci id="S3.E7.m1.9.9.9.9.4.4.1.2.3.cmml" xref="S3.E7.m1.9.9.9.9.4.4.1.2.3">𝑘</ci></apply><apply id="S3.E7.m1.9.9.9.9.4.4.1.3.cmml" xref="S3.E7.m1.9.9.9.9.4.4.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.9.9.4.4.1.3.1.cmml" xref="S3.E7.m1.9.9.9.9.4.4.1.3">subscript</csymbol><ci id="S3.E7.m1.9.9.9.9.4.4.1.3.2.cmml" xref="S3.E7.m1.9.9.9.9.4.4.1.3.2">ℬ</ci><ci id="S3.E7.m1.9.9.9.9.4.4.1.3.3.cmml" xref="S3.E7.m1.9.9.9.9.4.4.1.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E7.m1.16.16.1.1.1.3.3.2.cmml" xref="S3.E7.m1.5.5.5.5.5.6"><times id="S3.E7.m1.16.16.1.1.1.3.3.2.1.cmml" xref="S3.E7.m1.5.5.5.5.5.6"></times><apply id="S3.E7.m1.16.16.1.1.1.3.3.2.2.cmml" xref="S3.E7.m1.5.5.5.5.5.6"><csymbol cd="ambiguous" id="S3.E7.m1.16.16.1.1.1.3.3.2.2.1.cmml" xref="S3.E7.m1.5.5.5.5.5.6">subscript</csymbol><ci id="S3.E7.m1.10.10.10.10.5.5.cmml" xref="S3.E7.m1.10.10.10.10.5.5">ℓ</ci><apply id="S3.E7.m1.11.11.11.11.6.6.1.cmml" xref="S3.E7.m1.11.11.11.11.6.6.1"><csymbol cd="ambiguous" id="S3.E7.m1.11.11.11.11.6.6.1.1.cmml" xref="S3.E7.m1.11.11.11.11.6.6.1">subscript</csymbol><ci id="S3.E7.m1.11.11.11.11.6.6.1.2.cmml" xref="S3.E7.m1.11.11.11.11.6.6.1.2">𝒯</ci><ci id="S3.E7.m1.11.11.11.11.6.6.1.3.cmml" xref="S3.E7.m1.11.11.11.11.6.6.1.3">𝑘</ci></apply></apply><ci id="S3.E7.m1.13.13.13.13.8.8.cmml" xref="S3.E7.m1.13.13.13.13.8.8">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.17c">\begin{split}\mathcal{L}_{k}(w)&amp;=\frac{1}{|\mathcal{B}_{k}|}\sum_{\mathcal{T}_{k}\in\mathcal{B}_{k}}\ell_{\mathcal{T}_{k}}(w),\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.6" class="ltx_p">in which the subscript <math id="S3.SS3.p2.4.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p2.4.m1.1a"><mi id="S3.SS3.p2.4.m1.1.1" xref="S3.SS3.p2.4.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m1.1b"><ci id="S3.SS3.p2.4.m1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m1.1c">k</annotation></semantics></math> of <math id="S3.SS3.p2.5.m2.1" class="ltx_Math" alttext="\mathcal{T}_{k}" display="inline"><semantics id="S3.SS3.p2.5.m2.1a"><msub id="S3.SS3.p2.5.m2.1.1" xref="S3.SS3.p2.5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.5.m2.1.1.2" xref="S3.SS3.p2.5.m2.1.1.2.cmml">𝒯</mi><mi id="S3.SS3.p2.5.m2.1.1.3" xref="S3.SS3.p2.5.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m2.1b"><apply id="S3.SS3.p2.5.m2.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.1.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m2.1.1.2.cmml" xref="S3.SS3.p2.5.m2.1.1.2">𝒯</ci><ci id="S3.SS3.p2.5.m2.1.1.3.cmml" xref="S3.SS3.p2.5.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m2.1c">\mathcal{T}_{k}</annotation></semantics></math> emphasizes that it’s sampled from local data source of client <math id="S3.SS3.p2.6.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p2.6.m3.1a"><mi id="S3.SS3.p2.6.m3.1.1" xref="S3.SS3.p2.6.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m3.1b"><ci id="S3.SS3.p2.6.m3.1.1.cmml" xref="S3.SS3.p2.6.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m3.1c">k</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">Our goal is to find a global optimal model <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="w^{*}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><msup id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">w</mi><mo id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝑤</ci><times id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">w^{*}</annotation></semantics></math> which minimizes the weighted average of local FSL objectives. We formulate this global target as an FedL problem similar to (<a href="#S3.E2" title="In 3.1. General Federated Learning Objective ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), i.e.,</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.29" class="ltx_Math" alttext="\begin{split}w^{*}&amp;=\underset{w}{\text{min}}\ \mathcal{L}(w)=\sum_{k=1}^{K}p_{k}\mathcal{L}_{k}(w)=\sum_{k=1}^{K}\frac{|\mathcal{B}_{k}|}{|\mathcal{B}|}\mathcal{L}_{k}(w)\\
\end{split}" display="block"><semantics id="S3.E8.m1.29a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E8.m1.29.29" xref="S3.E8.m1.29.30.1.cmml"><mtr id="S3.E8.m1.29.29a" xref="S3.E8.m1.29.30.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E8.m1.29.29b" xref="S3.E8.m1.29.30.1.cmml"><msup id="S3.E8.m1.2.2.2.2.2" xref="S3.E8.m1.29.30.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml">w</mi><mo id="S3.E8.m1.2.2.2.2.2.2.1" xref="S3.E8.m1.2.2.2.2.2.2.1.cmml">∗</mo></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E8.m1.29.29c" xref="S3.E8.m1.29.30.1.cmml"><mrow id="S3.E8.m1.29.29.29.29.27" xref="S3.E8.m1.29.30.1.cmml"><mi id="S3.E8.m1.29.29.29.29.27.29" xref="S3.E8.m1.29.30.1a.cmml"></mi><mo id="S3.E8.m1.3.3.3.3.1.1" xref="S3.E8.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S3.E8.m1.29.29.29.29.27.30" xref="S3.E8.m1.29.30.1.cmml"><munder accentunder="true" id="S3.E8.m1.4.4.4.4.2.2" xref="S3.E8.m1.4.4.4.4.2.2.cmml"><mtext id="S3.E8.m1.4.4.4.4.2.2.2" xref="S3.E8.m1.4.4.4.4.2.2.2a.cmml">min</mtext><mo id="S3.E8.m1.4.4.4.4.2.2.1" xref="S3.E8.m1.4.4.4.4.2.2.1.cmml">𝑤</mo></munder><mo lspace="0em" rspace="0em" id="S3.E8.m1.29.29.29.29.27.30.1" xref="S3.E8.m1.29.30.1a.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.5.5.5.5.3.3" xref="S3.E8.m1.5.5.5.5.3.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.29.29.29.29.27.30.1a" xref="S3.E8.m1.29.30.1a.cmml">​</mo><mrow id="S3.E8.m1.29.29.29.29.27.30.2" xref="S3.E8.m1.29.30.1.cmml"><mo stretchy="false" id="S3.E8.m1.6.6.6.6.4.4" xref="S3.E8.m1.29.30.1a.cmml">(</mo><mi id="S3.E8.m1.7.7.7.7.5.5" xref="S3.E8.m1.7.7.7.7.5.5.cmml">w</mi><mo stretchy="false" id="S3.E8.m1.8.8.8.8.6.6" xref="S3.E8.m1.29.30.1a.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E8.m1.9.9.9.9.7.7" xref="S3.E8.m1.9.9.9.9.7.7.cmml">=</mo><mrow id="S3.E8.m1.29.29.29.29.27.31" xref="S3.E8.m1.29.30.1.cmml"><munderover id="S3.E8.m1.29.29.29.29.27.31.1" xref="S3.E8.m1.29.30.1.cmml"><mo movablelimits="false" id="S3.E8.m1.10.10.10.10.8.8" xref="S3.E8.m1.10.10.10.10.8.8.cmml">∑</mo><mrow id="S3.E8.m1.11.11.11.11.9.9.1" xref="S3.E8.m1.11.11.11.11.9.9.1.cmml"><mi id="S3.E8.m1.11.11.11.11.9.9.1.2" xref="S3.E8.m1.11.11.11.11.9.9.1.2.cmml">k</mi><mo id="S3.E8.m1.11.11.11.11.9.9.1.1" xref="S3.E8.m1.11.11.11.11.9.9.1.1.cmml">=</mo><mn id="S3.E8.m1.11.11.11.11.9.9.1.3" xref="S3.E8.m1.11.11.11.11.9.9.1.3.cmml">1</mn></mrow><mi id="S3.E8.m1.12.12.12.12.10.10.1" xref="S3.E8.m1.12.12.12.12.10.10.1.cmml">K</mi></munderover><mrow id="S3.E8.m1.29.29.29.29.27.31.2" xref="S3.E8.m1.29.30.1.cmml"><msub id="S3.E8.m1.29.29.29.29.27.31.2.2" xref="S3.E8.m1.29.30.1.cmml"><mi id="S3.E8.m1.13.13.13.13.11.11" xref="S3.E8.m1.13.13.13.13.11.11.cmml">p</mi><mi id="S3.E8.m1.14.14.14.14.12.12.1" xref="S3.E8.m1.14.14.14.14.12.12.1.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.29.29.29.29.27.31.2.1" xref="S3.E8.m1.29.30.1a.cmml">​</mo><msub id="S3.E8.m1.29.29.29.29.27.31.2.3" xref="S3.E8.m1.29.30.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.15.15.15.15.13.13" xref="S3.E8.m1.15.15.15.15.13.13.cmml">ℒ</mi><mi id="S3.E8.m1.16.16.16.16.14.14.1" xref="S3.E8.m1.16.16.16.16.14.14.1.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.29.29.29.29.27.31.2.1a" xref="S3.E8.m1.29.30.1a.cmml">​</mo><mrow id="S3.E8.m1.29.29.29.29.27.31.2.4" xref="S3.E8.m1.29.30.1.cmml"><mo stretchy="false" id="S3.E8.m1.17.17.17.17.15.15" xref="S3.E8.m1.29.30.1a.cmml">(</mo><mi id="S3.E8.m1.18.18.18.18.16.16" xref="S3.E8.m1.18.18.18.18.16.16.cmml">w</mi><mo stretchy="false" id="S3.E8.m1.19.19.19.19.17.17" xref="S3.E8.m1.29.30.1a.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.111em" id="S3.E8.m1.20.20.20.20.18.18" xref="S3.E8.m1.20.20.20.20.18.18.cmml">=</mo><mrow id="S3.E8.m1.29.29.29.29.27.32" xref="S3.E8.m1.29.30.1.cmml"><munderover id="S3.E8.m1.29.29.29.29.27.32.1" xref="S3.E8.m1.29.30.1.cmml"><mo movablelimits="false" id="S3.E8.m1.21.21.21.21.19.19" xref="S3.E8.m1.21.21.21.21.19.19.cmml">∑</mo><mrow id="S3.E8.m1.22.22.22.22.20.20.1" xref="S3.E8.m1.22.22.22.22.20.20.1.cmml"><mi id="S3.E8.m1.22.22.22.22.20.20.1.2" xref="S3.E8.m1.22.22.22.22.20.20.1.2.cmml">k</mi><mo id="S3.E8.m1.22.22.22.22.20.20.1.1" xref="S3.E8.m1.22.22.22.22.20.20.1.1.cmml">=</mo><mn id="S3.E8.m1.22.22.22.22.20.20.1.3" xref="S3.E8.m1.22.22.22.22.20.20.1.3.cmml">1</mn></mrow><mi id="S3.E8.m1.23.23.23.23.21.21.1" xref="S3.E8.m1.23.23.23.23.21.21.1.cmml">K</mi></munderover><mrow id="S3.E8.m1.29.29.29.29.27.32.2" xref="S3.E8.m1.29.30.1.cmml"><mfrac id="S3.E8.m1.24.24.24.24.22.22" xref="S3.E8.m1.24.24.24.24.22.22.cmml"><mrow id="S3.E8.m1.24.24.24.24.22.22.1.1" xref="S3.E8.m1.24.24.24.24.22.22.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.24.24.24.24.22.22.1.1.2" xref="S3.E8.m1.24.24.24.24.22.22.1.2.1.cmml">|</mo><msub id="S3.E8.m1.24.24.24.24.22.22.1.1.1" xref="S3.E8.m1.24.24.24.24.22.22.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.24.24.24.24.22.22.1.1.1.2" xref="S3.E8.m1.24.24.24.24.22.22.1.1.1.2.cmml">ℬ</mi><mi id="S3.E8.m1.24.24.24.24.22.22.1.1.1.3" xref="S3.E8.m1.24.24.24.24.22.22.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E8.m1.24.24.24.24.22.22.1.1.3" xref="S3.E8.m1.24.24.24.24.22.22.1.2.1.cmml">|</mo></mrow><mrow id="S3.E8.m1.24.24.24.24.22.22.2.3" xref="S3.E8.m1.24.24.24.24.22.22.2.2.cmml"><mo stretchy="false" id="S3.E8.m1.24.24.24.24.22.22.2.3.1" xref="S3.E8.m1.24.24.24.24.22.22.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.24.24.24.24.22.22.2.1" xref="S3.E8.m1.24.24.24.24.22.22.2.1.cmml">ℬ</mi><mo stretchy="false" id="S3.E8.m1.24.24.24.24.22.22.2.3.2" xref="S3.E8.m1.24.24.24.24.22.22.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E8.m1.29.29.29.29.27.32.2.1" xref="S3.E8.m1.29.30.1a.cmml">​</mo><msub id="S3.E8.m1.29.29.29.29.27.32.2.2" xref="S3.E8.m1.29.30.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.25.25.25.25.23.23" xref="S3.E8.m1.25.25.25.25.23.23.cmml">ℒ</mi><mi id="S3.E8.m1.26.26.26.26.24.24.1" xref="S3.E8.m1.26.26.26.26.24.24.1.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.29.29.29.29.27.32.2.1a" xref="S3.E8.m1.29.30.1a.cmml">​</mo><mrow id="S3.E8.m1.29.29.29.29.27.32.2.3" xref="S3.E8.m1.29.30.1.cmml"><mo stretchy="false" id="S3.E8.m1.27.27.27.27.25.25" xref="S3.E8.m1.29.30.1a.cmml">(</mo><mi id="S3.E8.m1.28.28.28.28.26.26" xref="S3.E8.m1.28.28.28.28.26.26.cmml">w</mi><mo stretchy="false" id="S3.E8.m1.29.29.29.29.27.27" xref="S3.E8.m1.29.30.1a.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E8.m1.29b"><apply id="S3.E8.m1.29.30.1.cmml" xref="S3.E8.m1.29.29"><and id="S3.E8.m1.29.30.1a.cmml" xref="S3.E8.m1.29.29.29.29.27.29"></and><apply id="S3.E8.m1.29.30.1b.cmml" xref="S3.E8.m1.29.29"><eq id="S3.E8.m1.3.3.3.3.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1"></eq><apply id="S3.E8.m1.29.30.1.2.cmml" xref="S3.E8.m1.29.29"><csymbol cd="ambiguous" id="S3.E8.m1.29.30.1.2.1.cmml" xref="S3.E8.m1.29.29.29.29.27.29">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1">𝑤</ci><times id="S3.E8.m1.2.2.2.2.2.2.1.cmml" xref="S3.E8.m1.2.2.2.2.2.2.1"></times></apply><apply id="S3.E8.m1.29.30.1.4.cmml" xref="S3.E8.m1.29.29"><times id="S3.E8.m1.29.30.1.4.1.cmml" xref="S3.E8.m1.29.29.29.29.27.29"></times><apply id="S3.E8.m1.4.4.4.4.2.2.cmml" xref="S3.E8.m1.4.4.4.4.2.2"><ci id="S3.E8.m1.4.4.4.4.2.2.1.cmml" xref="S3.E8.m1.4.4.4.4.2.2.1">𝑤</ci><ci id="S3.E8.m1.4.4.4.4.2.2.2a.cmml" xref="S3.E8.m1.4.4.4.4.2.2.2"><mtext id="S3.E8.m1.4.4.4.4.2.2.2.cmml" xref="S3.E8.m1.4.4.4.4.2.2.2">min</mtext></ci></apply><ci id="S3.E8.m1.5.5.5.5.3.3.cmml" xref="S3.E8.m1.5.5.5.5.3.3">ℒ</ci><ci id="S3.E8.m1.7.7.7.7.5.5.cmml" xref="S3.E8.m1.7.7.7.7.5.5">𝑤</ci></apply></apply><apply id="S3.E8.m1.29.30.1c.cmml" xref="S3.E8.m1.29.29"><eq id="S3.E8.m1.9.9.9.9.7.7.cmml" xref="S3.E8.m1.9.9.9.9.7.7"></eq><share href="#S3.E8.m1.29.30.1.4.cmml" id="S3.E8.m1.29.30.1d.cmml" xref="S3.E8.m1.29.29.29.29.27.29"></share><apply id="S3.E8.m1.29.30.1.6.cmml" xref="S3.E8.m1.29.29"><apply id="S3.E8.m1.29.30.1.6.1.cmml" xref="S3.E8.m1.29.29"><csymbol cd="ambiguous" id="S3.E8.m1.29.30.1.6.1.1.cmml" xref="S3.E8.m1.29.29.29.29.27.29">superscript</csymbol><apply id="S3.E8.m1.29.30.1.6.1.2.cmml" xref="S3.E8.m1.29.29"><csymbol cd="ambiguous" id="S3.E8.m1.29.30.1.6.1.2.1.cmml" xref="S3.E8.m1.29.29.29.29.27.29">subscript</csymbol><sum id="S3.E8.m1.10.10.10.10.8.8.cmml" xref="S3.E8.m1.10.10.10.10.8.8"></sum><apply id="S3.E8.m1.11.11.11.11.9.9.1.cmml" xref="S3.E8.m1.11.11.11.11.9.9.1"><eq id="S3.E8.m1.11.11.11.11.9.9.1.1.cmml" xref="S3.E8.m1.11.11.11.11.9.9.1.1"></eq><ci id="S3.E8.m1.11.11.11.11.9.9.1.2.cmml" xref="S3.E8.m1.11.11.11.11.9.9.1.2">𝑘</ci><cn type="integer" id="S3.E8.m1.11.11.11.11.9.9.1.3.cmml" xref="S3.E8.m1.11.11.11.11.9.9.1.3">1</cn></apply></apply><ci id="S3.E8.m1.12.12.12.12.10.10.1.cmml" xref="S3.E8.m1.12.12.12.12.10.10.1">𝐾</ci></apply><apply id="S3.E8.m1.29.30.1.6.2.cmml" xref="S3.E8.m1.29.29"><times id="S3.E8.m1.29.30.1.6.2.1.cmml" xref="S3.E8.m1.29.29.29.29.27.29"></times><apply id="S3.E8.m1.29.30.1.6.2.2.cmml" xref="S3.E8.m1.29.29"><csymbol cd="ambiguous" id="S3.E8.m1.29.30.1.6.2.2.1.cmml" xref="S3.E8.m1.29.29.29.29.27.29">subscript</csymbol><ci id="S3.E8.m1.13.13.13.13.11.11.cmml" xref="S3.E8.m1.13.13.13.13.11.11">𝑝</ci><ci id="S3.E8.m1.14.14.14.14.12.12.1.cmml" xref="S3.E8.m1.14.14.14.14.12.12.1">𝑘</ci></apply><apply id="S3.E8.m1.29.30.1.6.2.3.cmml" xref="S3.E8.m1.29.29"><csymbol cd="ambiguous" id="S3.E8.m1.29.30.1.6.2.3.1.cmml" xref="S3.E8.m1.29.29.29.29.27.29">subscript</csymbol><ci id="S3.E8.m1.15.15.15.15.13.13.cmml" xref="S3.E8.m1.15.15.15.15.13.13">ℒ</ci><ci id="S3.E8.m1.16.16.16.16.14.14.1.cmml" xref="S3.E8.m1.16.16.16.16.14.14.1">𝑘</ci></apply><ci id="S3.E8.m1.18.18.18.18.16.16.cmml" xref="S3.E8.m1.18.18.18.18.16.16">𝑤</ci></apply></apply></apply><apply id="S3.E8.m1.29.30.1e.cmml" xref="S3.E8.m1.29.29"><eq id="S3.E8.m1.20.20.20.20.18.18.cmml" xref="S3.E8.m1.20.20.20.20.18.18"></eq><share href="#S3.E8.m1.29.30.1.6.cmml" id="S3.E8.m1.29.30.1f.cmml" xref="S3.E8.m1.29.29.29.29.27.29"></share><apply id="S3.E8.m1.29.30.1.8.cmml" xref="S3.E8.m1.29.29"><apply id="S3.E8.m1.29.30.1.8.1.cmml" xref="S3.E8.m1.29.29"><csymbol cd="ambiguous" id="S3.E8.m1.29.30.1.8.1.1.cmml" xref="S3.E8.m1.29.29.29.29.27.29">superscript</csymbol><apply id="S3.E8.m1.29.30.1.8.1.2.cmml" xref="S3.E8.m1.29.29"><csymbol cd="ambiguous" id="S3.E8.m1.29.30.1.8.1.2.1.cmml" xref="S3.E8.m1.29.29.29.29.27.29">subscript</csymbol><sum id="S3.E8.m1.21.21.21.21.19.19.cmml" xref="S3.E8.m1.21.21.21.21.19.19"></sum><apply id="S3.E8.m1.22.22.22.22.20.20.1.cmml" xref="S3.E8.m1.22.22.22.22.20.20.1"><eq id="S3.E8.m1.22.22.22.22.20.20.1.1.cmml" xref="S3.E8.m1.22.22.22.22.20.20.1.1"></eq><ci id="S3.E8.m1.22.22.22.22.20.20.1.2.cmml" xref="S3.E8.m1.22.22.22.22.20.20.1.2">𝑘</ci><cn type="integer" id="S3.E8.m1.22.22.22.22.20.20.1.3.cmml" xref="S3.E8.m1.22.22.22.22.20.20.1.3">1</cn></apply></apply><ci id="S3.E8.m1.23.23.23.23.21.21.1.cmml" xref="S3.E8.m1.23.23.23.23.21.21.1">𝐾</ci></apply><apply id="S3.E8.m1.29.30.1.8.2.cmml" xref="S3.E8.m1.29.29"><times id="S3.E8.m1.29.30.1.8.2.1.cmml" xref="S3.E8.m1.29.29.29.29.27.29"></times><apply id="S3.E8.m1.24.24.24.24.22.22.cmml" xref="S3.E8.m1.24.24.24.24.22.22"><divide id="S3.E8.m1.24.24.24.24.22.22.3.cmml" xref="S3.E8.m1.24.24.24.24.22.22"></divide><apply id="S3.E8.m1.24.24.24.24.22.22.1.2.cmml" xref="S3.E8.m1.24.24.24.24.22.22.1.1"><abs id="S3.E8.m1.24.24.24.24.22.22.1.2.1.cmml" xref="S3.E8.m1.24.24.24.24.22.22.1.1.2"></abs><apply id="S3.E8.m1.24.24.24.24.22.22.1.1.1.cmml" xref="S3.E8.m1.24.24.24.24.22.22.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.24.24.24.24.22.22.1.1.1.1.cmml" xref="S3.E8.m1.24.24.24.24.22.22.1.1.1">subscript</csymbol><ci id="S3.E8.m1.24.24.24.24.22.22.1.1.1.2.cmml" xref="S3.E8.m1.24.24.24.24.22.22.1.1.1.2">ℬ</ci><ci id="S3.E8.m1.24.24.24.24.22.22.1.1.1.3.cmml" xref="S3.E8.m1.24.24.24.24.22.22.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E8.m1.24.24.24.24.22.22.2.2.cmml" xref="S3.E8.m1.24.24.24.24.22.22.2.3"><abs id="S3.E8.m1.24.24.24.24.22.22.2.2.1.cmml" xref="S3.E8.m1.24.24.24.24.22.22.2.3.1"></abs><ci id="S3.E8.m1.24.24.24.24.22.22.2.1.cmml" xref="S3.E8.m1.24.24.24.24.22.22.2.1">ℬ</ci></apply></apply><apply id="S3.E8.m1.29.30.1.8.2.3.cmml" xref="S3.E8.m1.29.29"><csymbol cd="ambiguous" id="S3.E8.m1.29.30.1.8.2.3.1.cmml" xref="S3.E8.m1.29.29.29.29.27.29">subscript</csymbol><ci id="S3.E8.m1.25.25.25.25.23.23.cmml" xref="S3.E8.m1.25.25.25.25.23.23">ℒ</ci><ci id="S3.E8.m1.26.26.26.26.24.24.1.cmml" xref="S3.E8.m1.26.26.26.26.24.24.1">𝑘</ci></apply><ci id="S3.E8.m1.28.28.28.28.26.26.cmml" xref="S3.E8.m1.28.28.28.28.26.26">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.29c">\begin{split}w^{*}&amp;=\underset{w}{\text{min}}\ \mathcal{L}(w)=\sum_{k=1}^{K}p_{k}\mathcal{L}_{k}(w)=\sum_{k=1}^{K}\frac{|\mathcal{B}_{k}|}{|\mathcal{B}|}\mathcal{L}_{k}(w)\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.2" class="ltx_p">Directly optimizing (<a href="#S3.E8" title="In 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) would be difficult, as learning an optimal <math id="S3.SS3.p3.2.m1.1" class="ltx_Math" alttext="w^{*}" display="inline"><semantics id="S3.SS3.p3.2.m1.1a"><msup id="S3.SS3.p3.2.m1.1.1" xref="S3.SS3.p3.2.m1.1.1.cmml"><mi id="S3.SS3.p3.2.m1.1.1.2" xref="S3.SS3.p3.2.m1.1.1.2.cmml">w</mi><mo id="S3.SS3.p3.2.m1.1.1.3" xref="S3.SS3.p3.2.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m1.1b"><apply id="S3.SS3.p3.2.m1.1.1.cmml" xref="S3.SS3.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m1.1.1.1.cmml" xref="S3.SS3.p3.2.m1.1.1">superscript</csymbol><ci id="S3.SS3.p3.2.m1.1.1.2.cmml" xref="S3.SS3.p3.2.m1.1.1.2">𝑤</ci><times id="S3.SS3.p3.2.m1.1.1.3.cmml" xref="S3.SS3.p3.2.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m1.1c">w^{*}</annotation></semantics></math> for all distributed clients would require excessive communications across clients, as discussed in <a href="#S3.SS1" title="3.1. General Federated Learning Objective ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>. We thus provide an efficient algorithm for tackling this issue.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.1" class="ltx_p">Motivated by FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan
et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite>, we propose a straightforward way of solving a surrogate objective of (<a href="#S3.E8" title="In 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) to approximate the global solution, which we call <span id="S3.SS3.p4.1.1" class="ltx_text ltx_font_bold">FedFSL-naive</span>.
As shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.2. General Centralized Few-Shot Learning ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>,
FedFSL-naive iteratively updates the central model <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">w</annotation></semantics></math> by (i) first optimizing each local objective of (<a href="#S3.E7" title="In 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) in parallel, and (ii) aggregating local models to the central model, which update the global model and send it back to clients for the next round of optimization. Formally,</p>
<ul id="S3.I2" class="ltx_itemize">
<li id="S3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i1.p1" class="ltx_para">
<p id="S3.I2.i1.p1.2" class="ltx_p">At the <math id="S3.I2.i1.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.I2.i1.p1.1.m1.1a"><mi id="S3.I2.i1.p1.1.m1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.m1.1b"><ci id="S3.I2.i1.p1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.m1.1c">t</annotation></semantics></math>-th optimization round, each client <math id="S3.I2.i1.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.I2.i1.p1.2.m2.1a"><mi id="S3.I2.i1.p1.2.m2.1.1" xref="S3.I2.i1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.2.m2.1b"><ci id="S3.I2.i1.p1.2.m2.1.1.cmml" xref="S3.I2.i1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.2.m2.1c">k</annotation></semantics></math> optimizes the following local objective</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.23" class="ltx_Math" alttext="\begin{split}w^{*,t}_{k}&amp;=\underset{w}{\text{argmin}}\ \mathcal{L}_{k}(w)=\underset{w}{\text{argmin}}\ \frac{1}{|\mathcal{B}_{k}|}\sum_{\mathcal{T}_{k}\in\mathcal{B}_{k}}\ell_{\mathcal{T}_{k}}(w),\\
\end{split}" display="block"><semantics id="S3.E9.m1.23a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E9.m1.23.23.2"><mtr id="S3.E9.m1.23.23.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E9.m1.23.23.2b"><msubsup id="S3.E9.m1.3.3.3.3.3"><mi id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml">w</mi><mi id="S3.E9.m1.3.3.3.3.3.3.1" xref="S3.E9.m1.3.3.3.3.3.3.1.cmml">k</mi><mrow id="S3.E9.m1.2.2.2.2.2.2.1.4" xref="S3.E9.m1.2.2.2.2.2.2.1.3.cmml"><mo rspace="0em" id="S3.E9.m1.2.2.2.2.2.2.1.1" xref="S3.E9.m1.2.2.2.2.2.2.1.1.cmml">∗</mo><mo id="S3.E9.m1.2.2.2.2.2.2.1.4.1" xref="S3.E9.m1.2.2.2.2.2.2.1.3.cmml">,</mo><mi id="S3.E9.m1.2.2.2.2.2.2.1.2" xref="S3.E9.m1.2.2.2.2.2.2.1.2.cmml">t</mi></mrow></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.23.23.2c"><mrow id="S3.E9.m1.23.23.2.22.22.19.19"><mrow id="S3.E9.m1.23.23.2.22.22.19.19.1"><mi id="S3.E9.m1.23.23.2.22.22.19.19.1.2" xref="S3.E9.m1.22.22.1.1.1.cmml"></mi><mo id="S3.E9.m1.4.4.4.4.1.1" xref="S3.E9.m1.4.4.4.4.1.1.cmml">=</mo><mrow id="S3.E9.m1.23.23.2.22.22.19.19.1.3"><munder accentunder="true" id="S3.E9.m1.5.5.5.5.2.2" xref="S3.E9.m1.5.5.5.5.2.2.cmml"><mtext id="S3.E9.m1.5.5.5.5.2.2.2" xref="S3.E9.m1.5.5.5.5.2.2.2a.cmml">argmin</mtext><mo id="S3.E9.m1.5.5.5.5.2.2.1" xref="S3.E9.m1.5.5.5.5.2.2.1.cmml">𝑤</mo></munder><mo lspace="0em" rspace="0em" id="S3.E9.m1.23.23.2.22.22.19.19.1.3.1" xref="S3.E9.m1.22.22.1.1.1.cmml">​</mo><msub id="S3.E9.m1.23.23.2.22.22.19.19.1.3.2"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.6.6.6.6.3.3" xref="S3.E9.m1.6.6.6.6.3.3.cmml">ℒ</mi><mi id="S3.E9.m1.7.7.7.7.4.4.1" xref="S3.E9.m1.7.7.7.7.4.4.1.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.23.23.2.22.22.19.19.1.3.1a" xref="S3.E9.m1.22.22.1.1.1.cmml">​</mo><mrow id="S3.E9.m1.23.23.2.22.22.19.19.1.3.3"><mo stretchy="false" id="S3.E9.m1.8.8.8.8.5.5" xref="S3.E9.m1.22.22.1.1.1.cmml">(</mo><mi id="S3.E9.m1.9.9.9.9.6.6" xref="S3.E9.m1.9.9.9.9.6.6.cmml">w</mi><mo stretchy="false" id="S3.E9.m1.10.10.10.10.7.7" xref="S3.E9.m1.22.22.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.11.11.11.11.8.8" xref="S3.E9.m1.11.11.11.11.8.8.cmml">=</mo><mrow id="S3.E9.m1.23.23.2.22.22.19.19.1.4"><munder accentunder="true" id="S3.E9.m1.12.12.12.12.9.9" xref="S3.E9.m1.12.12.12.12.9.9.cmml"><mtext id="S3.E9.m1.12.12.12.12.9.9.2" xref="S3.E9.m1.12.12.12.12.9.9.2a.cmml">argmin</mtext><mo id="S3.E9.m1.12.12.12.12.9.9.1" xref="S3.E9.m1.12.12.12.12.9.9.1.cmml">𝑤</mo></munder><mo lspace="0em" rspace="0em" id="S3.E9.m1.23.23.2.22.22.19.19.1.4.1" xref="S3.E9.m1.22.22.1.1.1.cmml">​</mo><mfrac id="S3.E9.m1.13.13.13.13.10.10" xref="S3.E9.m1.13.13.13.13.10.10.cmml"><mn id="S3.E9.m1.13.13.13.13.10.10.3" xref="S3.E9.m1.13.13.13.13.10.10.3.cmml">1</mn><mrow id="S3.E9.m1.13.13.13.13.10.10.1.1" xref="S3.E9.m1.13.13.13.13.10.10.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.13.13.13.13.10.10.1.1.2" xref="S3.E9.m1.13.13.13.13.10.10.1.2.1.cmml">|</mo><msub id="S3.E9.m1.13.13.13.13.10.10.1.1.1" xref="S3.E9.m1.13.13.13.13.10.10.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.13.13.13.13.10.10.1.1.1.2" xref="S3.E9.m1.13.13.13.13.10.10.1.1.1.2.cmml">ℬ</mi><mi id="S3.E9.m1.13.13.13.13.10.10.1.1.1.3" xref="S3.E9.m1.13.13.13.13.10.10.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E9.m1.13.13.13.13.10.10.1.1.3" xref="S3.E9.m1.13.13.13.13.10.10.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E9.m1.23.23.2.22.22.19.19.1.4.1a" xref="S3.E9.m1.22.22.1.1.1.cmml">​</mo><mrow id="S3.E9.m1.23.23.2.22.22.19.19.1.4.2"><munder id="S3.E9.m1.23.23.2.22.22.19.19.1.4.2.1"><mo movablelimits="false" id="S3.E9.m1.14.14.14.14.11.11" xref="S3.E9.m1.14.14.14.14.11.11.cmml">∑</mo><mrow id="S3.E9.m1.15.15.15.15.12.12.1" xref="S3.E9.m1.15.15.15.15.12.12.1.cmml"><msub id="S3.E9.m1.15.15.15.15.12.12.1.2" xref="S3.E9.m1.15.15.15.15.12.12.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.15.15.15.15.12.12.1.2.2" xref="S3.E9.m1.15.15.15.15.12.12.1.2.2.cmml">𝒯</mi><mi id="S3.E9.m1.15.15.15.15.12.12.1.2.3" xref="S3.E9.m1.15.15.15.15.12.12.1.2.3.cmml">k</mi></msub><mo id="S3.E9.m1.15.15.15.15.12.12.1.1" xref="S3.E9.m1.15.15.15.15.12.12.1.1.cmml">∈</mo><msub id="S3.E9.m1.15.15.15.15.12.12.1.3" xref="S3.E9.m1.15.15.15.15.12.12.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.15.15.15.15.12.12.1.3.2" xref="S3.E9.m1.15.15.15.15.12.12.1.3.2.cmml">ℬ</mi><mi id="S3.E9.m1.15.15.15.15.12.12.1.3.3" xref="S3.E9.m1.15.15.15.15.12.12.1.3.3.cmml">k</mi></msub></mrow></munder><mrow id="S3.E9.m1.23.23.2.22.22.19.19.1.4.2.2"><msub id="S3.E9.m1.23.23.2.22.22.19.19.1.4.2.2.2"><mi mathvariant="normal" id="S3.E9.m1.16.16.16.16.13.13" xref="S3.E9.m1.16.16.16.16.13.13.cmml">ℓ</mi><msub id="S3.E9.m1.17.17.17.17.14.14.1" xref="S3.E9.m1.17.17.17.17.14.14.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.17.17.17.17.14.14.1.2" xref="S3.E9.m1.17.17.17.17.14.14.1.2.cmml">𝒯</mi><mi id="S3.E9.m1.17.17.17.17.14.14.1.3" xref="S3.E9.m1.17.17.17.17.14.14.1.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.23.23.2.22.22.19.19.1.4.2.2.1" xref="S3.E9.m1.22.22.1.1.1.cmml">​</mo><mrow id="S3.E9.m1.23.23.2.22.22.19.19.1.4.2.2.3"><mo stretchy="false" id="S3.E9.m1.18.18.18.18.15.15" xref="S3.E9.m1.22.22.1.1.1.cmml">(</mo><mi id="S3.E9.m1.19.19.19.19.16.16" xref="S3.E9.m1.19.19.19.19.16.16.cmml">w</mi><mo stretchy="false" id="S3.E9.m1.20.20.20.20.17.17" xref="S3.E9.m1.22.22.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.21.21.21.21.18.18" xref="S3.E9.m1.22.22.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E9.m1.23b"><apply id="S3.E9.m1.22.22.1.1.1.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><and id="S3.E9.m1.22.22.1.1.1a.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"></and><apply id="S3.E9.m1.22.22.1.1.1b.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><eq id="S3.E9.m1.4.4.4.4.1.1.cmml" xref="S3.E9.m1.4.4.4.4.1.1"></eq><apply id="S3.E9.m1.22.22.1.1.1.2.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.22.22.1.1.1.2.1.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2">subscript</csymbol><apply id="S3.E9.m1.22.22.1.1.1.2.2.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.22.22.1.1.1.2.2.1.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2">superscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1">𝑤</ci><list id="S3.E9.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.4"><times id="S3.E9.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1"></times><ci id="S3.E9.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.2">𝑡</ci></list></apply><ci id="S3.E9.m1.3.3.3.3.3.3.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3.1">𝑘</ci></apply><apply id="S3.E9.m1.22.22.1.1.1.4.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><times id="S3.E9.m1.22.22.1.1.1.4.1.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"></times><apply id="S3.E9.m1.5.5.5.5.2.2.cmml" xref="S3.E9.m1.5.5.5.5.2.2"><ci id="S3.E9.m1.5.5.5.5.2.2.1.cmml" xref="S3.E9.m1.5.5.5.5.2.2.1">𝑤</ci><ci id="S3.E9.m1.5.5.5.5.2.2.2a.cmml" xref="S3.E9.m1.5.5.5.5.2.2.2"><mtext id="S3.E9.m1.5.5.5.5.2.2.2.cmml" xref="S3.E9.m1.5.5.5.5.2.2.2">argmin</mtext></ci></apply><apply id="S3.E9.m1.22.22.1.1.1.4.3.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.22.22.1.1.1.4.3.1.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2">subscript</csymbol><ci id="S3.E9.m1.6.6.6.6.3.3.cmml" xref="S3.E9.m1.6.6.6.6.3.3">ℒ</ci><ci id="S3.E9.m1.7.7.7.7.4.4.1.cmml" xref="S3.E9.m1.7.7.7.7.4.4.1">𝑘</ci></apply><ci id="S3.E9.m1.9.9.9.9.6.6.cmml" xref="S3.E9.m1.9.9.9.9.6.6">𝑤</ci></apply></apply><apply id="S3.E9.m1.22.22.1.1.1c.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><eq id="S3.E9.m1.11.11.11.11.8.8.cmml" xref="S3.E9.m1.11.11.11.11.8.8"></eq><share href="#S3.E9.m1.22.22.1.1.1.4.cmml" id="S3.E9.m1.22.22.1.1.1d.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"></share><apply id="S3.E9.m1.22.22.1.1.1.6.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><times id="S3.E9.m1.22.22.1.1.1.6.1.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"></times><apply id="S3.E9.m1.12.12.12.12.9.9.cmml" xref="S3.E9.m1.12.12.12.12.9.9"><ci id="S3.E9.m1.12.12.12.12.9.9.1.cmml" xref="S3.E9.m1.12.12.12.12.9.9.1">𝑤</ci><ci id="S3.E9.m1.12.12.12.12.9.9.2a.cmml" xref="S3.E9.m1.12.12.12.12.9.9.2"><mtext id="S3.E9.m1.12.12.12.12.9.9.2.cmml" xref="S3.E9.m1.12.12.12.12.9.9.2">argmin</mtext></ci></apply><apply id="S3.E9.m1.13.13.13.13.10.10.cmml" xref="S3.E9.m1.13.13.13.13.10.10"><divide id="S3.E9.m1.13.13.13.13.10.10.2.cmml" xref="S3.E9.m1.13.13.13.13.10.10"></divide><cn type="integer" id="S3.E9.m1.13.13.13.13.10.10.3.cmml" xref="S3.E9.m1.13.13.13.13.10.10.3">1</cn><apply id="S3.E9.m1.13.13.13.13.10.10.1.2.cmml" xref="S3.E9.m1.13.13.13.13.10.10.1.1"><abs id="S3.E9.m1.13.13.13.13.10.10.1.2.1.cmml" xref="S3.E9.m1.13.13.13.13.10.10.1.1.2"></abs><apply id="S3.E9.m1.13.13.13.13.10.10.1.1.1.cmml" xref="S3.E9.m1.13.13.13.13.10.10.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.13.13.13.13.10.10.1.1.1.1.cmml" xref="S3.E9.m1.13.13.13.13.10.10.1.1.1">subscript</csymbol><ci id="S3.E9.m1.13.13.13.13.10.10.1.1.1.2.cmml" xref="S3.E9.m1.13.13.13.13.10.10.1.1.1.2">ℬ</ci><ci id="S3.E9.m1.13.13.13.13.10.10.1.1.1.3.cmml" xref="S3.E9.m1.13.13.13.13.10.10.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S3.E9.m1.22.22.1.1.1.6.4.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><apply id="S3.E9.m1.22.22.1.1.1.6.4.1.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.22.22.1.1.1.6.4.1.1.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2">subscript</csymbol><sum id="S3.E9.m1.14.14.14.14.11.11.cmml" xref="S3.E9.m1.14.14.14.14.11.11"></sum><apply id="S3.E9.m1.15.15.15.15.12.12.1.cmml" xref="S3.E9.m1.15.15.15.15.12.12.1"><in id="S3.E9.m1.15.15.15.15.12.12.1.1.cmml" xref="S3.E9.m1.15.15.15.15.12.12.1.1"></in><apply id="S3.E9.m1.15.15.15.15.12.12.1.2.cmml" xref="S3.E9.m1.15.15.15.15.12.12.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.15.15.15.15.12.12.1.2.1.cmml" xref="S3.E9.m1.15.15.15.15.12.12.1.2">subscript</csymbol><ci id="S3.E9.m1.15.15.15.15.12.12.1.2.2.cmml" xref="S3.E9.m1.15.15.15.15.12.12.1.2.2">𝒯</ci><ci id="S3.E9.m1.15.15.15.15.12.12.1.2.3.cmml" xref="S3.E9.m1.15.15.15.15.12.12.1.2.3">𝑘</ci></apply><apply id="S3.E9.m1.15.15.15.15.12.12.1.3.cmml" xref="S3.E9.m1.15.15.15.15.12.12.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.15.15.15.15.12.12.1.3.1.cmml" xref="S3.E9.m1.15.15.15.15.12.12.1.3">subscript</csymbol><ci id="S3.E9.m1.15.15.15.15.12.12.1.3.2.cmml" xref="S3.E9.m1.15.15.15.15.12.12.1.3.2">ℬ</ci><ci id="S3.E9.m1.15.15.15.15.12.12.1.3.3.cmml" xref="S3.E9.m1.15.15.15.15.12.12.1.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E9.m1.22.22.1.1.1.6.4.2.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><times id="S3.E9.m1.22.22.1.1.1.6.4.2.1.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"></times><apply id="S3.E9.m1.22.22.1.1.1.6.4.2.2.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.22.22.1.1.1.6.4.2.2.1.cmml" xref="S3.E9.m1.23.23.2.22.22.19.19.1.2">subscript</csymbol><ci id="S3.E9.m1.16.16.16.16.13.13.cmml" xref="S3.E9.m1.16.16.16.16.13.13">ℓ</ci><apply id="S3.E9.m1.17.17.17.17.14.14.1.cmml" xref="S3.E9.m1.17.17.17.17.14.14.1"><csymbol cd="ambiguous" id="S3.E9.m1.17.17.17.17.14.14.1.1.cmml" xref="S3.E9.m1.17.17.17.17.14.14.1">subscript</csymbol><ci id="S3.E9.m1.17.17.17.17.14.14.1.2.cmml" xref="S3.E9.m1.17.17.17.17.14.14.1.2">𝒯</ci><ci id="S3.E9.m1.17.17.17.17.14.14.1.3.cmml" xref="S3.E9.m1.17.17.17.17.14.14.1.3">𝑘</ci></apply></apply><ci id="S3.E9.m1.19.19.19.19.16.16.cmml" xref="S3.E9.m1.19.19.19.19.16.16">𝑤</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.23c">\begin{split}w^{*,t}_{k}&amp;=\underset{w}{\text{argmin}}\ \mathcal{L}_{k}(w)=\underset{w}{\text{argmin}}\ \frac{1}{|\mathcal{B}_{k}|}\sum_{\mathcal{T}_{k}\in\mathcal{B}_{k}}\ell_{\mathcal{T}_{k}}(w),\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.I2.i1.p1.5" class="ltx_p">in which the FSL loss <math id="S3.I2.i1.p1.3.m1.1" class="ltx_Math" alttext="\ell(w)" display="inline"><semantics id="S3.I2.i1.p1.3.m1.1a"><mrow id="S3.I2.i1.p1.3.m1.1.2" xref="S3.I2.i1.p1.3.m1.1.2.cmml"><mi mathvariant="normal" id="S3.I2.i1.p1.3.m1.1.2.2" xref="S3.I2.i1.p1.3.m1.1.2.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.I2.i1.p1.3.m1.1.2.1" xref="S3.I2.i1.p1.3.m1.1.2.1.cmml">​</mo><mrow id="S3.I2.i1.p1.3.m1.1.2.3.2" xref="S3.I2.i1.p1.3.m1.1.2.cmml"><mo stretchy="false" id="S3.I2.i1.p1.3.m1.1.2.3.2.1" xref="S3.I2.i1.p1.3.m1.1.2.cmml">(</mo><mi id="S3.I2.i1.p1.3.m1.1.1" xref="S3.I2.i1.p1.3.m1.1.1.cmml">w</mi><mo stretchy="false" id="S3.I2.i1.p1.3.m1.1.2.3.2.2" xref="S3.I2.i1.p1.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.3.m1.1b"><apply id="S3.I2.i1.p1.3.m1.1.2.cmml" xref="S3.I2.i1.p1.3.m1.1.2"><times id="S3.I2.i1.p1.3.m1.1.2.1.cmml" xref="S3.I2.i1.p1.3.m1.1.2.1"></times><ci id="S3.I2.i1.p1.3.m1.1.2.2.cmml" xref="S3.I2.i1.p1.3.m1.1.2.2">ℓ</ci><ci id="S3.I2.i1.p1.3.m1.1.1.cmml" xref="S3.I2.i1.p1.3.m1.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.3.m1.1c">\ell(w)</annotation></semantics></math> is given by (<a href="#S3.E5" title="In 3rd item ‣ 3.2. General Centralized Few-Shot Learning ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.2. General Centralized Few-Shot Learning ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows a two-client example, in which each client updates on three sampled tasks with (<a href="#S3.E9" title="In 1st item ‣ 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) and obtains local optimal models <math id="S3.I2.i1.p1.4.m2.2" class="ltx_Math" alttext="w^{*,t}_{1}" display="inline"><semantics id="S3.I2.i1.p1.4.m2.2a"><msubsup id="S3.I2.i1.p1.4.m2.2.3" xref="S3.I2.i1.p1.4.m2.2.3.cmml"><mi id="S3.I2.i1.p1.4.m2.2.3.2.2" xref="S3.I2.i1.p1.4.m2.2.3.2.2.cmml">w</mi><mn id="S3.I2.i1.p1.4.m2.2.3.3" xref="S3.I2.i1.p1.4.m2.2.3.3.cmml">1</mn><mrow id="S3.I2.i1.p1.4.m2.2.2.2.4" xref="S3.I2.i1.p1.4.m2.2.2.2.3.cmml"><mo rspace="0em" id="S3.I2.i1.p1.4.m2.1.1.1.1" xref="S3.I2.i1.p1.4.m2.1.1.1.1.cmml">∗</mo><mo id="S3.I2.i1.p1.4.m2.2.2.2.4.1" xref="S3.I2.i1.p1.4.m2.2.2.2.3.cmml">,</mo><mi id="S3.I2.i1.p1.4.m2.2.2.2.2" xref="S3.I2.i1.p1.4.m2.2.2.2.2.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.4.m2.2b"><apply id="S3.I2.i1.p1.4.m2.2.3.cmml" xref="S3.I2.i1.p1.4.m2.2.3"><csymbol cd="ambiguous" id="S3.I2.i1.p1.4.m2.2.3.1.cmml" xref="S3.I2.i1.p1.4.m2.2.3">subscript</csymbol><apply id="S3.I2.i1.p1.4.m2.2.3.2.cmml" xref="S3.I2.i1.p1.4.m2.2.3"><csymbol cd="ambiguous" id="S3.I2.i1.p1.4.m2.2.3.2.1.cmml" xref="S3.I2.i1.p1.4.m2.2.3">superscript</csymbol><ci id="S3.I2.i1.p1.4.m2.2.3.2.2.cmml" xref="S3.I2.i1.p1.4.m2.2.3.2.2">𝑤</ci><list id="S3.I2.i1.p1.4.m2.2.2.2.3.cmml" xref="S3.I2.i1.p1.4.m2.2.2.2.4"><times id="S3.I2.i1.p1.4.m2.1.1.1.1.cmml" xref="S3.I2.i1.p1.4.m2.1.1.1.1"></times><ci id="S3.I2.i1.p1.4.m2.2.2.2.2.cmml" xref="S3.I2.i1.p1.4.m2.2.2.2.2">𝑡</ci></list></apply><cn type="integer" id="S3.I2.i1.p1.4.m2.2.3.3.cmml" xref="S3.I2.i1.p1.4.m2.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.4.m2.2c">w^{*,t}_{1}</annotation></semantics></math> and <math id="S3.I2.i1.p1.5.m3.2" class="ltx_Math" alttext="w^{*,t}_{2}" display="inline"><semantics id="S3.I2.i1.p1.5.m3.2a"><msubsup id="S3.I2.i1.p1.5.m3.2.3" xref="S3.I2.i1.p1.5.m3.2.3.cmml"><mi id="S3.I2.i1.p1.5.m3.2.3.2.2" xref="S3.I2.i1.p1.5.m3.2.3.2.2.cmml">w</mi><mn id="S3.I2.i1.p1.5.m3.2.3.3" xref="S3.I2.i1.p1.5.m3.2.3.3.cmml">2</mn><mrow id="S3.I2.i1.p1.5.m3.2.2.2.4" xref="S3.I2.i1.p1.5.m3.2.2.2.3.cmml"><mo rspace="0em" id="S3.I2.i1.p1.5.m3.1.1.1.1" xref="S3.I2.i1.p1.5.m3.1.1.1.1.cmml">∗</mo><mo id="S3.I2.i1.p1.5.m3.2.2.2.4.1" xref="S3.I2.i1.p1.5.m3.2.2.2.3.cmml">,</mo><mi id="S3.I2.i1.p1.5.m3.2.2.2.2" xref="S3.I2.i1.p1.5.m3.2.2.2.2.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.5.m3.2b"><apply id="S3.I2.i1.p1.5.m3.2.3.cmml" xref="S3.I2.i1.p1.5.m3.2.3"><csymbol cd="ambiguous" id="S3.I2.i1.p1.5.m3.2.3.1.cmml" xref="S3.I2.i1.p1.5.m3.2.3">subscript</csymbol><apply id="S3.I2.i1.p1.5.m3.2.3.2.cmml" xref="S3.I2.i1.p1.5.m3.2.3"><csymbol cd="ambiguous" id="S3.I2.i1.p1.5.m3.2.3.2.1.cmml" xref="S3.I2.i1.p1.5.m3.2.3">superscript</csymbol><ci id="S3.I2.i1.p1.5.m3.2.3.2.2.cmml" xref="S3.I2.i1.p1.5.m3.2.3.2.2">𝑤</ci><list id="S3.I2.i1.p1.5.m3.2.2.2.3.cmml" xref="S3.I2.i1.p1.5.m3.2.2.2.4"><times id="S3.I2.i1.p1.5.m3.1.1.1.1.cmml" xref="S3.I2.i1.p1.5.m3.1.1.1.1"></times><ci id="S3.I2.i1.p1.5.m3.2.2.2.2.cmml" xref="S3.I2.i1.p1.5.m3.2.2.2.2">𝑡</ci></list></apply><cn type="integer" id="S3.I2.i1.p1.5.m3.2.3.3.cmml" xref="S3.I2.i1.p1.5.m3.2.3.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.5.m3.2c">w^{*,t}_{2}</annotation></semantics></math>. The clients then send these local parameters to the central server.</p>
</div>
</li>
<li id="S3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i2.p1" class="ltx_para">
<p id="S3.I2.i2.p1.1" class="ltx_p">Then the central server approximates the optimal global solution by averaging the client models such that</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.5" class="ltx_Math" alttext="w^{t+1}=\sum_{k=1}^{C}\frac{|\mathcal{B}_{k}|}{|\mathcal{B}|}w^{*,t}_{k}," display="block"><semantics id="S3.E10.m1.5a"><mrow id="S3.E10.m1.5.5.1" xref="S3.E10.m1.5.5.1.1.cmml"><mrow id="S3.E10.m1.5.5.1.1" xref="S3.E10.m1.5.5.1.1.cmml"><msup id="S3.E10.m1.5.5.1.1.2" xref="S3.E10.m1.5.5.1.1.2.cmml"><mi id="S3.E10.m1.5.5.1.1.2.2" xref="S3.E10.m1.5.5.1.1.2.2.cmml">w</mi><mrow id="S3.E10.m1.5.5.1.1.2.3" xref="S3.E10.m1.5.5.1.1.2.3.cmml"><mi id="S3.E10.m1.5.5.1.1.2.3.2" xref="S3.E10.m1.5.5.1.1.2.3.2.cmml">t</mi><mo id="S3.E10.m1.5.5.1.1.2.3.1" xref="S3.E10.m1.5.5.1.1.2.3.1.cmml">+</mo><mn id="S3.E10.m1.5.5.1.1.2.3.3" xref="S3.E10.m1.5.5.1.1.2.3.3.cmml">1</mn></mrow></msup><mo rspace="0.111em" id="S3.E10.m1.5.5.1.1.1" xref="S3.E10.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E10.m1.5.5.1.1.3" xref="S3.E10.m1.5.5.1.1.3.cmml"><munderover id="S3.E10.m1.5.5.1.1.3.1" xref="S3.E10.m1.5.5.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E10.m1.5.5.1.1.3.1.2.2" xref="S3.E10.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E10.m1.5.5.1.1.3.1.2.3" xref="S3.E10.m1.5.5.1.1.3.1.2.3.cmml"><mi id="S3.E10.m1.5.5.1.1.3.1.2.3.2" xref="S3.E10.m1.5.5.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E10.m1.5.5.1.1.3.1.2.3.1" xref="S3.E10.m1.5.5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E10.m1.5.5.1.1.3.1.2.3.3" xref="S3.E10.m1.5.5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E10.m1.5.5.1.1.3.1.3" xref="S3.E10.m1.5.5.1.1.3.1.3.cmml">C</mi></munderover><mrow id="S3.E10.m1.5.5.1.1.3.2" xref="S3.E10.m1.5.5.1.1.3.2.cmml"><mfrac id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.2.cmml">ℬ</mi><mi id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E10.m1.2.2.2.3" xref="S3.E10.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.2.3.1" xref="S3.E10.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.2.2.2.1" xref="S3.E10.m1.2.2.2.1.cmml">ℬ</mi><mo stretchy="false" id="S3.E10.m1.2.2.2.3.2" xref="S3.E10.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E10.m1.5.5.1.1.3.2.1" xref="S3.E10.m1.5.5.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E10.m1.5.5.1.1.3.2.2" xref="S3.E10.m1.5.5.1.1.3.2.2.cmml"><mi id="S3.E10.m1.5.5.1.1.3.2.2.2.2" xref="S3.E10.m1.5.5.1.1.3.2.2.2.2.cmml">w</mi><mi id="S3.E10.m1.5.5.1.1.3.2.2.3" xref="S3.E10.m1.5.5.1.1.3.2.2.3.cmml">k</mi><mrow id="S3.E10.m1.4.4.2.4" xref="S3.E10.m1.4.4.2.3.cmml"><mo rspace="0em" id="S3.E10.m1.3.3.1.1" xref="S3.E10.m1.3.3.1.1.cmml">∗</mo><mo id="S3.E10.m1.4.4.2.4.1" xref="S3.E10.m1.4.4.2.3.cmml">,</mo><mi id="S3.E10.m1.4.4.2.2" xref="S3.E10.m1.4.4.2.2.cmml">t</mi></mrow></msubsup></mrow></mrow></mrow><mo id="S3.E10.m1.5.5.1.2" xref="S3.E10.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.5b"><apply id="S3.E10.m1.5.5.1.1.cmml" xref="S3.E10.m1.5.5.1"><eq id="S3.E10.m1.5.5.1.1.1.cmml" xref="S3.E10.m1.5.5.1.1.1"></eq><apply id="S3.E10.m1.5.5.1.1.2.cmml" xref="S3.E10.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.1.1.2.1.cmml" xref="S3.E10.m1.5.5.1.1.2">superscript</csymbol><ci id="S3.E10.m1.5.5.1.1.2.2.cmml" xref="S3.E10.m1.5.5.1.1.2.2">𝑤</ci><apply id="S3.E10.m1.5.5.1.1.2.3.cmml" xref="S3.E10.m1.5.5.1.1.2.3"><plus id="S3.E10.m1.5.5.1.1.2.3.1.cmml" xref="S3.E10.m1.5.5.1.1.2.3.1"></plus><ci id="S3.E10.m1.5.5.1.1.2.3.2.cmml" xref="S3.E10.m1.5.5.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E10.m1.5.5.1.1.2.3.3.cmml" xref="S3.E10.m1.5.5.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E10.m1.5.5.1.1.3.cmml" xref="S3.E10.m1.5.5.1.1.3"><apply id="S3.E10.m1.5.5.1.1.3.1.cmml" xref="S3.E10.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.1.1.3.1.1.cmml" xref="S3.E10.m1.5.5.1.1.3.1">superscript</csymbol><apply id="S3.E10.m1.5.5.1.1.3.1.2.cmml" xref="S3.E10.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.1.1.3.1.2.1.cmml" xref="S3.E10.m1.5.5.1.1.3.1">subscript</csymbol><sum id="S3.E10.m1.5.5.1.1.3.1.2.2.cmml" xref="S3.E10.m1.5.5.1.1.3.1.2.2"></sum><apply id="S3.E10.m1.5.5.1.1.3.1.2.3.cmml" xref="S3.E10.m1.5.5.1.1.3.1.2.3"><eq id="S3.E10.m1.5.5.1.1.3.1.2.3.1.cmml" xref="S3.E10.m1.5.5.1.1.3.1.2.3.1"></eq><ci id="S3.E10.m1.5.5.1.1.3.1.2.3.2.cmml" xref="S3.E10.m1.5.5.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E10.m1.5.5.1.1.3.1.2.3.3.cmml" xref="S3.E10.m1.5.5.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E10.m1.5.5.1.1.3.1.3.cmml" xref="S3.E10.m1.5.5.1.1.3.1.3">𝐶</ci></apply><apply id="S3.E10.m1.5.5.1.1.3.2.cmml" xref="S3.E10.m1.5.5.1.1.3.2"><times id="S3.E10.m1.5.5.1.1.3.2.1.cmml" xref="S3.E10.m1.5.5.1.1.3.2.1"></times><apply id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2"><divide id="S3.E10.m1.2.2.3.cmml" xref="S3.E10.m1.2.2"></divide><apply id="S3.E10.m1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1"><abs id="S3.E10.m1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2"></abs><apply id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.2">ℬ</ci><ci id="S3.E10.m1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.3"><abs id="S3.E10.m1.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.3.1"></abs><ci id="S3.E10.m1.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.1">ℬ</ci></apply></apply><apply id="S3.E10.m1.5.5.1.1.3.2.2.cmml" xref="S3.E10.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.E10.m1.5.5.1.1.3.2.2">subscript</csymbol><apply id="S3.E10.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.E10.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S3.E10.m1.5.5.1.1.3.2.2">superscript</csymbol><ci id="S3.E10.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S3.E10.m1.5.5.1.1.3.2.2.2.2">𝑤</ci><list id="S3.E10.m1.4.4.2.3.cmml" xref="S3.E10.m1.4.4.2.4"><times id="S3.E10.m1.3.3.1.1.cmml" xref="S3.E10.m1.3.3.1.1"></times><ci id="S3.E10.m1.4.4.2.2.cmml" xref="S3.E10.m1.4.4.2.2">𝑡</ci></list></apply><ci id="S3.E10.m1.5.5.1.1.3.2.2.3.cmml" xref="S3.E10.m1.5.5.1.1.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.5c">w^{t+1}=\sum_{k=1}^{C}\frac{|\mathcal{B}_{k}|}{|\mathcal{B}|}w^{*,t}_{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.I2.i2.p1.2" class="ltx_p">which will be synchronized to all clients for next round of optimization.</p>
</div>
</li>
</ul>
<p id="S3.SS3.p4.2" class="ltx_p">The above steps (<a href="#S3.E9" title="In 1st item ‣ 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) and (<a href="#S3.E10" title="In 2nd item ‣ 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) are repeated for multiple rounds until convergence. We summarize the procedures in Algorithm <a href="#alg1" title="In 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_algorithm">
<div id="alg1.23" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg1.3.3" class="ltx_listingline">
<span id="alg1.3.3.4" class="ltx_text" style="font-size:90%;"><span id="alg1.3.3.4.1" class="ltx_text ltx_font_bold">Input:</span> </span><span id="alg1.3.3.3" class="ltx_text" style="font-size:90%;">A set of <math id="alg1.1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.1.1.1.m1.1a"><mi id="alg1.1.1.1.m1.1.1" xref="alg1.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.1.1.1.m1.1b"><ci id="alg1.1.1.1.m1.1.1.cmml" xref="alg1.1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.1.m1.1c">K</annotation></semantics></math> federated clients. A local FSL objective <math id="alg1.2.2.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{k}" display="inline"><semantics id="alg1.2.2.2.m2.1a"><msub id="alg1.2.2.2.m2.1.1" xref="alg1.2.2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.2.2.2.m2.1.1.2" xref="alg1.2.2.2.m2.1.1.2.cmml">ℒ</mi><mi id="alg1.2.2.2.m2.1.1.3" xref="alg1.2.2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.2.2.2.m2.1b"><apply id="alg1.2.2.2.m2.1.1.cmml" xref="alg1.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.2.2.2.m2.1.1.1.cmml" xref="alg1.2.2.2.m2.1.1">subscript</csymbol><ci id="alg1.2.2.2.m2.1.1.2.cmml" xref="alg1.2.2.2.m2.1.1.2">ℒ</ci><ci id="alg1.2.2.2.m2.1.1.3.cmml" xref="alg1.2.2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.2.m2.1c">\mathcal{L}_{k}</annotation></semantics></math> for each client <math id="alg1.3.3.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.3.3.3.m3.1a"><mi id="alg1.3.3.3.m3.1.1" xref="alg1.3.3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.3.3.3.m3.1b"><ci id="alg1.3.3.3.m3.1.1.cmml" xref="alg1.3.3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.3.m3.1c">k</annotation></semantics></math>.
</span>
</div>
<div id="alg1.4.4" class="ltx_listingline">
<span id="alg1.4.4.1" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.4.4.2" class="ltx_text" style="font-size:90%;"><span id="alg1.4.4.2.1" class="ltx_text ltx_font_bold">Output:</span> </span><span id="alg1.4.4.3" class="ltx_text" style="font-size:90%;">A global model </span><math id="alg1.4.4.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.4.4.m1.1a"><mi mathsize="90%" id="alg1.4.4.m1.1.1" xref="alg1.4.4.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.4.4.m1.1b"><ci id="alg1.4.4.m1.1.1.cmml" xref="alg1.4.4.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m1.1c">w</annotation></semantics></math><span id="alg1.4.4.4" class="ltx_text" style="font-size:90%;"> optimized for FSL task.</span>
</div>
<div id="alg1.23.24" class="ltx_listingline">
<span id="alg1.23.24.1" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.23.24.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Server executes:</span><span id="alg1.23.24.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.5.5" class="ltx_listingline">
<span id="alg1.5.5.1" class="ltx_text" style="font-size:90%;">
Initialize global model </span><math id="alg1.5.5.m1.1" class="ltx_Math" alttext="w^{0}" display="inline"><semantics id="alg1.5.5.m1.1a"><msup id="alg1.5.5.m1.1.1" xref="alg1.5.5.m1.1.1.cmml"><mi mathsize="90%" id="alg1.5.5.m1.1.1.2" xref="alg1.5.5.m1.1.1.2.cmml">w</mi><mn mathsize="90%" id="alg1.5.5.m1.1.1.3" xref="alg1.5.5.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.5.5.m1.1b"><apply id="alg1.5.5.m1.1.1.cmml" xref="alg1.5.5.m1.1.1"><csymbol cd="ambiguous" id="alg1.5.5.m1.1.1.1.cmml" xref="alg1.5.5.m1.1.1">superscript</csymbol><ci id="alg1.5.5.m1.1.1.2.cmml" xref="alg1.5.5.m1.1.1.2">𝑤</ci><cn type="integer" id="alg1.5.5.m1.1.1.3.cmml" xref="alg1.5.5.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m1.1c">w^{0}</annotation></semantics></math><span id="alg1.5.5.2" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.6.6" class="ltx_listingline">
<span id="alg1.6.6.1" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.6.6.m1.1" class="ltx_Math" alttext="t\leftarrow 1" display="inline"><semantics id="alg1.6.6.m1.1a"><mrow id="alg1.6.6.m1.1.1" xref="alg1.6.6.m1.1.1.cmml"><mi mathsize="90%" id="alg1.6.6.m1.1.1.2" xref="alg1.6.6.m1.1.1.2.cmml">t</mi><mo mathsize="90%" stretchy="false" id="alg1.6.6.m1.1.1.1" xref="alg1.6.6.m1.1.1.1.cmml">←</mo><mn mathsize="90%" id="alg1.6.6.m1.1.1.3" xref="alg1.6.6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.6.6.m1.1b"><apply id="alg1.6.6.m1.1.1.cmml" xref="alg1.6.6.m1.1.1"><ci id="alg1.6.6.m1.1.1.1.cmml" xref="alg1.6.6.m1.1.1.1">←</ci><ci id="alg1.6.6.m1.1.1.2.cmml" xref="alg1.6.6.m1.1.1.2">𝑡</ci><cn type="integer" id="alg1.6.6.m1.1.1.3.cmml" xref="alg1.6.6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.m1.1c">t\leftarrow 1</annotation></semantics></math><span id="alg1.6.6.2" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.8.8" class="ltx_listingline">
<span id="alg1.8.8.3" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.8.8.4" class="ltx_text ltx_font_bold" style="font-size:90%;">while</span><span id="alg1.8.8.5" class="ltx_text" style="font-size:90%;"> </span><em id="alg1.8.8.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">t <math id="alg1.7.7.1.m1.1" class="ltx_Math" alttext="\leq" display="inline"><semantics id="alg1.7.7.1.m1.1a"><mo id="alg1.7.7.1.m1.1.1" xref="alg1.7.7.1.m1.1.1.cmml">≤</mo><annotation-xml encoding="MathML-Content" id="alg1.7.7.1.m1.1b"><leq id="alg1.7.7.1.m1.1.1.cmml" xref="alg1.7.7.1.m1.1.1"></leq></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.1.m1.1c">\leq</annotation></semantics></math> maximum rounds <math id="alg1.8.8.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.8.8.2.m2.1a"><mi id="alg1.8.8.2.m2.1.1" xref="alg1.8.8.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.8.8.2.m2.1b"><ci id="alg1.8.8.2.m2.1.1.cmml" xref="alg1.8.8.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.2.m2.1c">T</annotation></semantics></math></em><span id="alg1.8.8.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.8.8.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.8.8.8" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.9.9" class="ltx_listingline">
<span id="alg1.9.9.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg1.9.9.3" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.9.9.4" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.9.9.5" class="ltx_text" style="font-size:90%;"> </span><em id="alg1.9.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><span id="alg1.9.9.1.1" class="ltx_text ltx_font_upright">each client</span> <math id="alg1.9.9.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.9.9.1.m1.1a"><mi id="alg1.9.9.1.m1.1.1" xref="alg1.9.9.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.9.9.1.m1.1b"><ci id="alg1.9.9.1.m1.1.1.cmml" xref="alg1.9.9.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.1.m1.1c">k</annotation></semantics></math> <span id="alg1.9.9.1.2" class="ltx_text ltx_font_bold ltx_font_upright">in parallel</span></em><span id="alg1.9.9.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.9.9.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.9.9.8" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.11.11" class="ltx_listingline">
<span id="alg1.11.11.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.11.11.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.10.10.m1.1" class="ltx_Math" alttext="w_{k}^{t}\leftarrow" display="inline"><semantics id="alg1.10.10.m1.1a"><mrow id="alg1.10.10.m1.1.1" xref="alg1.10.10.m1.1.1.cmml"><msubsup id="alg1.10.10.m1.1.1.2" xref="alg1.10.10.m1.1.1.2.cmml"><mi mathsize="90%" id="alg1.10.10.m1.1.1.2.2.2" xref="alg1.10.10.m1.1.1.2.2.2.cmml">w</mi><mi mathsize="90%" id="alg1.10.10.m1.1.1.2.2.3" xref="alg1.10.10.m1.1.1.2.2.3.cmml">k</mi><mi mathsize="90%" id="alg1.10.10.m1.1.1.2.3" xref="alg1.10.10.m1.1.1.2.3.cmml">t</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.10.10.m1.1.1.1" xref="alg1.10.10.m1.1.1.1.cmml">←</mo><mi id="alg1.10.10.m1.1.1.3" xref="alg1.10.10.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.10.10.m1.1b"><apply id="alg1.10.10.m1.1.1.cmml" xref="alg1.10.10.m1.1.1"><ci id="alg1.10.10.m1.1.1.1.cmml" xref="alg1.10.10.m1.1.1.1">←</ci><apply id="alg1.10.10.m1.1.1.2.cmml" xref="alg1.10.10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.10.10.m1.1.1.2.1.cmml" xref="alg1.10.10.m1.1.1.2">superscript</csymbol><apply id="alg1.10.10.m1.1.1.2.2.cmml" xref="alg1.10.10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.10.10.m1.1.1.2.2.1.cmml" xref="alg1.10.10.m1.1.1.2">subscript</csymbol><ci id="alg1.10.10.m1.1.1.2.2.2.cmml" xref="alg1.10.10.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.10.10.m1.1.1.2.2.3.cmml" xref="alg1.10.10.m1.1.1.2.2.3">𝑘</ci></apply><ci id="alg1.10.10.m1.1.1.2.3.cmml" xref="alg1.10.10.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.10.10.m1.1.1.3.cmml" xref="alg1.10.10.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m1.1c">w_{k}^{t}\leftarrow</annotation></semantics></math><span id="alg1.11.11.3" class="ltx_text" style="font-size:90%;"> ClientUpdate</span><math id="alg1.11.11.m2.1" class="ltx_Math" alttext="(w^{t})" display="inline"><semantics id="alg1.11.11.m2.1a"><mrow id="alg1.11.11.m2.1.1.1" xref="alg1.11.11.m2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.11.11.m2.1.1.1.2" xref="alg1.11.11.m2.1.1.1.1.cmml">(</mo><msup id="alg1.11.11.m2.1.1.1.1" xref="alg1.11.11.m2.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.11.11.m2.1.1.1.1.2" xref="alg1.11.11.m2.1.1.1.1.2.cmml">w</mi><mi mathsize="90%" id="alg1.11.11.m2.1.1.1.1.3" xref="alg1.11.11.m2.1.1.1.1.3.cmml">t</mi></msup><mo maxsize="90%" minsize="90%" id="alg1.11.11.m2.1.1.1.3" xref="alg1.11.11.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.11.11.m2.1b"><apply id="alg1.11.11.m2.1.1.1.1.cmml" xref="alg1.11.11.m2.1.1.1"><csymbol cd="ambiguous" id="alg1.11.11.m2.1.1.1.1.1.cmml" xref="alg1.11.11.m2.1.1.1">superscript</csymbol><ci id="alg1.11.11.m2.1.1.1.1.2.cmml" xref="alg1.11.11.m2.1.1.1.1.2">𝑤</ci><ci id="alg1.11.11.m2.1.1.1.1.3.cmml" xref="alg1.11.11.m2.1.1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.m2.1c">(w^{t})</annotation></semantics></math><span id="alg1.11.11.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.23.25" class="ltx_listingline">
<span id="alg1.23.25.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.23.25.2" class="ltx_text" style="font-size:90%;">  end for</span>
</div>
<div id="alg1.12.12" class="ltx_listingline">
<span id="alg1.12.12.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.12.12.2" class="ltx_text" style="font-size:90%;">Clients send model parameters </span><math id="alg1.12.12.m1.1" class="ltx_Math" alttext="w_{1...K}^{t}" display="inline"><semantics id="alg1.12.12.m1.1a"><msubsup id="alg1.12.12.m1.1.1" xref="alg1.12.12.m1.1.1.cmml"><mi mathsize="90%" id="alg1.12.12.m1.1.1.2.2" xref="alg1.12.12.m1.1.1.2.2.cmml">w</mi><mrow id="alg1.12.12.m1.1.1.2.3" xref="alg1.12.12.m1.1.1.2.3.cmml"><mn mathsize="90%" id="alg1.12.12.m1.1.1.2.3.2" xref="alg1.12.12.m1.1.1.2.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg1.12.12.m1.1.1.2.3.1" xref="alg1.12.12.m1.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.12.12.m1.1.1.2.3.3" xref="alg1.12.12.m1.1.1.2.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.12.12.m1.1.1.2.3.1a" xref="alg1.12.12.m1.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.12.12.m1.1.1.2.3.4" xref="alg1.12.12.m1.1.1.2.3.4.cmml">K</mi></mrow><mi mathsize="90%" id="alg1.12.12.m1.1.1.3" xref="alg1.12.12.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.12.12.m1.1b"><apply id="alg1.12.12.m1.1.1.cmml" xref="alg1.12.12.m1.1.1"><csymbol cd="ambiguous" id="alg1.12.12.m1.1.1.1.cmml" xref="alg1.12.12.m1.1.1">superscript</csymbol><apply id="alg1.12.12.m1.1.1.2.cmml" xref="alg1.12.12.m1.1.1"><csymbol cd="ambiguous" id="alg1.12.12.m1.1.1.2.1.cmml" xref="alg1.12.12.m1.1.1">subscript</csymbol><ci id="alg1.12.12.m1.1.1.2.2.cmml" xref="alg1.12.12.m1.1.1.2.2">𝑤</ci><apply id="alg1.12.12.m1.1.1.2.3.cmml" xref="alg1.12.12.m1.1.1.2.3"><times id="alg1.12.12.m1.1.1.2.3.1.cmml" xref="alg1.12.12.m1.1.1.2.3.1"></times><cn type="integer" id="alg1.12.12.m1.1.1.2.3.2.cmml" xref="alg1.12.12.m1.1.1.2.3.2">1</cn><ci id="alg1.12.12.m1.1.1.2.3.3.cmml" xref="alg1.12.12.m1.1.1.2.3.3">…</ci><ci id="alg1.12.12.m1.1.1.2.3.4.cmml" xref="alg1.12.12.m1.1.1.2.3.4">𝐾</ci></apply></apply><ci id="alg1.12.12.m1.1.1.3.cmml" xref="alg1.12.12.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.m1.1c">w_{1...K}^{t}</annotation></semantics></math><span id="alg1.12.12.3" class="ltx_text" style="font-size:90%;"> to server </span>
</div>
<div id="alg1.13.13" class="ltx_listingline">
<span id="alg1.13.13.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.13.13.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.13.13.m1.2" class="ltx_Math" alttext="w^{t+1}\leftarrow\sum_{k=1}^{K}\frac{|\mathcal{B}_{k}|}{|\mathcal{B}|}w^{t}_{k}" display="inline"><semantics id="alg1.13.13.m1.2a"><mrow id="alg1.13.13.m1.2.3" xref="alg1.13.13.m1.2.3.cmml"><msup id="alg1.13.13.m1.2.3.2" xref="alg1.13.13.m1.2.3.2.cmml"><mi mathsize="90%" id="alg1.13.13.m1.2.3.2.2" xref="alg1.13.13.m1.2.3.2.2.cmml">w</mi><mrow id="alg1.13.13.m1.2.3.2.3" xref="alg1.13.13.m1.2.3.2.3.cmml"><mi mathsize="90%" id="alg1.13.13.m1.2.3.2.3.2" xref="alg1.13.13.m1.2.3.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.13.13.m1.2.3.2.3.1" xref="alg1.13.13.m1.2.3.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.13.13.m1.2.3.2.3.3" xref="alg1.13.13.m1.2.3.2.3.3.cmml">1</mn></mrow></msup><mo mathsize="90%" rspace="0.111em" stretchy="false" id="alg1.13.13.m1.2.3.1" xref="alg1.13.13.m1.2.3.1.cmml">←</mo><mrow id="alg1.13.13.m1.2.3.3" xref="alg1.13.13.m1.2.3.3.cmml"><msubsup id="alg1.13.13.m1.2.3.3.1" xref="alg1.13.13.m1.2.3.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="alg1.13.13.m1.2.3.3.1.2.2" xref="alg1.13.13.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.13.13.m1.2.3.3.1.2.3" xref="alg1.13.13.m1.2.3.3.1.2.3.cmml"><mi mathsize="90%" id="alg1.13.13.m1.2.3.3.1.2.3.2" xref="alg1.13.13.m1.2.3.3.1.2.3.2.cmml">k</mi><mo mathsize="90%" id="alg1.13.13.m1.2.3.3.1.2.3.1" xref="alg1.13.13.m1.2.3.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="alg1.13.13.m1.2.3.3.1.2.3.3" xref="alg1.13.13.m1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.13.13.m1.2.3.3.1.3" xref="alg1.13.13.m1.2.3.3.1.3.cmml">K</mi></msubsup><mrow id="alg1.13.13.m1.2.3.3.2" xref="alg1.13.13.m1.2.3.3.2.cmml"><mfrac id="alg1.13.13.m1.2.2" xref="alg1.13.13.m1.2.2.cmml"><mrow id="alg1.13.13.m1.1.1.1.1" xref="alg1.13.13.m1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.13.13.m1.1.1.1.1.2" xref="alg1.13.13.m1.1.1.1.2.1.cmml">|</mo><msub id="alg1.13.13.m1.1.1.1.1.1" xref="alg1.13.13.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.13.13.m1.1.1.1.1.1.2" xref="alg1.13.13.m1.1.1.1.1.1.2.cmml">ℬ</mi><mi mathsize="90%" id="alg1.13.13.m1.1.1.1.1.1.3" xref="alg1.13.13.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.13.13.m1.1.1.1.1.3" xref="alg1.13.13.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg1.13.13.m1.2.2.2.3" xref="alg1.13.13.m1.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.13.13.m1.2.2.2.3.1" xref="alg1.13.13.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.13.13.m1.2.2.2.1" xref="alg1.13.13.m1.2.2.2.1.cmml">ℬ</mi><mo maxsize="90%" minsize="90%" id="alg1.13.13.m1.2.2.2.3.2" xref="alg1.13.13.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.13.13.m1.2.3.3.2.1" xref="alg1.13.13.m1.2.3.3.2.1.cmml">​</mo><msubsup id="alg1.13.13.m1.2.3.3.2.2" xref="alg1.13.13.m1.2.3.3.2.2.cmml"><mi mathsize="90%" id="alg1.13.13.m1.2.3.3.2.2.2.2" xref="alg1.13.13.m1.2.3.3.2.2.2.2.cmml">w</mi><mi mathsize="90%" id="alg1.13.13.m1.2.3.3.2.2.3" xref="alg1.13.13.m1.2.3.3.2.2.3.cmml">k</mi><mi mathsize="90%" id="alg1.13.13.m1.2.3.3.2.2.2.3" xref="alg1.13.13.m1.2.3.3.2.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.13.13.m1.2b"><apply id="alg1.13.13.m1.2.3.cmml" xref="alg1.13.13.m1.2.3"><ci id="alg1.13.13.m1.2.3.1.cmml" xref="alg1.13.13.m1.2.3.1">←</ci><apply id="alg1.13.13.m1.2.3.2.cmml" xref="alg1.13.13.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.13.13.m1.2.3.2.1.cmml" xref="alg1.13.13.m1.2.3.2">superscript</csymbol><ci id="alg1.13.13.m1.2.3.2.2.cmml" xref="alg1.13.13.m1.2.3.2.2">𝑤</ci><apply id="alg1.13.13.m1.2.3.2.3.cmml" xref="alg1.13.13.m1.2.3.2.3"><plus id="alg1.13.13.m1.2.3.2.3.1.cmml" xref="alg1.13.13.m1.2.3.2.3.1"></plus><ci id="alg1.13.13.m1.2.3.2.3.2.cmml" xref="alg1.13.13.m1.2.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.13.13.m1.2.3.2.3.3.cmml" xref="alg1.13.13.m1.2.3.2.3.3">1</cn></apply></apply><apply id="alg1.13.13.m1.2.3.3.cmml" xref="alg1.13.13.m1.2.3.3"><apply id="alg1.13.13.m1.2.3.3.1.cmml" xref="alg1.13.13.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.13.13.m1.2.3.3.1.1.cmml" xref="alg1.13.13.m1.2.3.3.1">superscript</csymbol><apply id="alg1.13.13.m1.2.3.3.1.2.cmml" xref="alg1.13.13.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.13.13.m1.2.3.3.1.2.1.cmml" xref="alg1.13.13.m1.2.3.3.1">subscript</csymbol><sum id="alg1.13.13.m1.2.3.3.1.2.2.cmml" xref="alg1.13.13.m1.2.3.3.1.2.2"></sum><apply id="alg1.13.13.m1.2.3.3.1.2.3.cmml" xref="alg1.13.13.m1.2.3.3.1.2.3"><eq id="alg1.13.13.m1.2.3.3.1.2.3.1.cmml" xref="alg1.13.13.m1.2.3.3.1.2.3.1"></eq><ci id="alg1.13.13.m1.2.3.3.1.2.3.2.cmml" xref="alg1.13.13.m1.2.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.13.13.m1.2.3.3.1.2.3.3.cmml" xref="alg1.13.13.m1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.13.13.m1.2.3.3.1.3.cmml" xref="alg1.13.13.m1.2.3.3.1.3">𝐾</ci></apply><apply id="alg1.13.13.m1.2.3.3.2.cmml" xref="alg1.13.13.m1.2.3.3.2"><times id="alg1.13.13.m1.2.3.3.2.1.cmml" xref="alg1.13.13.m1.2.3.3.2.1"></times><apply id="alg1.13.13.m1.2.2.cmml" xref="alg1.13.13.m1.2.2"><divide id="alg1.13.13.m1.2.2.3.cmml" xref="alg1.13.13.m1.2.2"></divide><apply id="alg1.13.13.m1.1.1.1.2.cmml" xref="alg1.13.13.m1.1.1.1.1"><abs id="alg1.13.13.m1.1.1.1.2.1.cmml" xref="alg1.13.13.m1.1.1.1.1.2"></abs><apply id="alg1.13.13.m1.1.1.1.1.1.cmml" xref="alg1.13.13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.13.13.m1.1.1.1.1.1.1.cmml" xref="alg1.13.13.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.13.13.m1.1.1.1.1.1.2.cmml" xref="alg1.13.13.m1.1.1.1.1.1.2">ℬ</ci><ci id="alg1.13.13.m1.1.1.1.1.1.3.cmml" xref="alg1.13.13.m1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="alg1.13.13.m1.2.2.2.2.cmml" xref="alg1.13.13.m1.2.2.2.3"><abs id="alg1.13.13.m1.2.2.2.2.1.cmml" xref="alg1.13.13.m1.2.2.2.3.1"></abs><ci id="alg1.13.13.m1.2.2.2.1.cmml" xref="alg1.13.13.m1.2.2.2.1">ℬ</ci></apply></apply><apply id="alg1.13.13.m1.2.3.3.2.2.cmml" xref="alg1.13.13.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.13.13.m1.2.3.3.2.2.1.cmml" xref="alg1.13.13.m1.2.3.3.2.2">subscript</csymbol><apply id="alg1.13.13.m1.2.3.3.2.2.2.cmml" xref="alg1.13.13.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.13.13.m1.2.3.3.2.2.2.1.cmml" xref="alg1.13.13.m1.2.3.3.2.2">superscript</csymbol><ci id="alg1.13.13.m1.2.3.3.2.2.2.2.cmml" xref="alg1.13.13.m1.2.3.3.2.2.2.2">𝑤</ci><ci id="alg1.13.13.m1.2.3.3.2.2.2.3.cmml" xref="alg1.13.13.m1.2.3.3.2.2.2.3">𝑡</ci></apply><ci id="alg1.13.13.m1.2.3.3.2.2.3.cmml" xref="alg1.13.13.m1.2.3.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.m1.2c">w^{t+1}\leftarrow\sum_{k=1}^{K}\frac{|\mathcal{B}_{k}|}{|\mathcal{B}|}w^{t}_{k}</annotation></semantics></math><span id="alg1.13.13.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.23.26" class="ltx_listingline">
<span id="alg1.23.26.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.23.26.2" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.23.26.3" class="ltx_text ltx_font_typewriter" style="font-size:90%;">// </span><span id="alg1.23.26.4" class="ltx_text ltx_font_typewriter" style="font-size:90%;">model avg </span>
</div>
<div id="alg1.14.14" class="ltx_listingline">
<span id="alg1.14.14.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.14.14.2" class="ltx_text" style="font-size:90%;">
The server sends </span><math id="alg1.14.14.m1.1" class="ltx_Math" alttext="w^{t+1}" display="inline"><semantics id="alg1.14.14.m1.1a"><msup id="alg1.14.14.m1.1.1" xref="alg1.14.14.m1.1.1.cmml"><mi mathsize="90%" id="alg1.14.14.m1.1.1.2" xref="alg1.14.14.m1.1.1.2.cmml">w</mi><mrow id="alg1.14.14.m1.1.1.3" xref="alg1.14.14.m1.1.1.3.cmml"><mi mathsize="90%" id="alg1.14.14.m1.1.1.3.2" xref="alg1.14.14.m1.1.1.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.14.14.m1.1.1.3.1" xref="alg1.14.14.m1.1.1.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.14.14.m1.1.1.3.3" xref="alg1.14.14.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.14.14.m1.1b"><apply id="alg1.14.14.m1.1.1.cmml" xref="alg1.14.14.m1.1.1"><csymbol cd="ambiguous" id="alg1.14.14.m1.1.1.1.cmml" xref="alg1.14.14.m1.1.1">superscript</csymbol><ci id="alg1.14.14.m1.1.1.2.cmml" xref="alg1.14.14.m1.1.1.2">𝑤</ci><apply id="alg1.14.14.m1.1.1.3.cmml" xref="alg1.14.14.m1.1.1.3"><plus id="alg1.14.14.m1.1.1.3.1.cmml" xref="alg1.14.14.m1.1.1.3.1"></plus><ci id="alg1.14.14.m1.1.1.3.2.cmml" xref="alg1.14.14.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.14.14.m1.1.1.3.3.cmml" xref="alg1.14.14.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.m1.1c">w^{t+1}</annotation></semantics></math><span id="alg1.14.14.3" class="ltx_text" style="font-size:90%;"> back to clients </span>
</div>
<div id="alg1.15.15" class="ltx_listingline">
<span id="alg1.15.15.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.15.15.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.15.15.m1.1" class="ltx_Math" alttext="t\leftarrow t+1" display="inline"><semantics id="alg1.15.15.m1.1a"><mrow id="alg1.15.15.m1.1.1" xref="alg1.15.15.m1.1.1.cmml"><mi mathsize="90%" id="alg1.15.15.m1.1.1.2" xref="alg1.15.15.m1.1.1.2.cmml">t</mi><mo mathsize="90%" stretchy="false" id="alg1.15.15.m1.1.1.1" xref="alg1.15.15.m1.1.1.1.cmml">←</mo><mrow id="alg1.15.15.m1.1.1.3" xref="alg1.15.15.m1.1.1.3.cmml"><mi mathsize="90%" id="alg1.15.15.m1.1.1.3.2" xref="alg1.15.15.m1.1.1.3.2.cmml">t</mi><mo mathsize="90%" id="alg1.15.15.m1.1.1.3.1" xref="alg1.15.15.m1.1.1.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.15.15.m1.1.1.3.3" xref="alg1.15.15.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.15.15.m1.1b"><apply id="alg1.15.15.m1.1.1.cmml" xref="alg1.15.15.m1.1.1"><ci id="alg1.15.15.m1.1.1.1.cmml" xref="alg1.15.15.m1.1.1.1">←</ci><ci id="alg1.15.15.m1.1.1.2.cmml" xref="alg1.15.15.m1.1.1.2">𝑡</ci><apply id="alg1.15.15.m1.1.1.3.cmml" xref="alg1.15.15.m1.1.1.3"><plus id="alg1.15.15.m1.1.1.3.1.cmml" xref="alg1.15.15.m1.1.1.3.1"></plus><ci id="alg1.15.15.m1.1.1.3.2.cmml" xref="alg1.15.15.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.15.15.m1.1.1.3.3.cmml" xref="alg1.15.15.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.m1.1c">t\leftarrow t+1</annotation></semantics></math><span id="alg1.15.15.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.23.27" class="ltx_listingline">
<span id="alg1.23.27.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.23.27.2" class="ltx_text" style="font-size:90%;">  end while</span>
</div>
<div id="alg1.16.16" class="ltx_listingline">
<span id="alg1.16.16.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.16.16.2" class="ltx_text" style="font-size:90%;">Return </span><math id="alg1.16.16.m1.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="alg1.16.16.m1.1a"><msup id="alg1.16.16.m1.1.1" xref="alg1.16.16.m1.1.1.cmml"><mi mathsize="90%" id="alg1.16.16.m1.1.1.2" xref="alg1.16.16.m1.1.1.2.cmml">w</mi><mi mathsize="90%" id="alg1.16.16.m1.1.1.3" xref="alg1.16.16.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.16.16.m1.1b"><apply id="alg1.16.16.m1.1.1.cmml" xref="alg1.16.16.m1.1.1"><csymbol cd="ambiguous" id="alg1.16.16.m1.1.1.1.cmml" xref="alg1.16.16.m1.1.1">superscript</csymbol><ci id="alg1.16.16.m1.1.1.2.cmml" xref="alg1.16.16.m1.1.1.2">𝑤</ci><ci id="alg1.16.16.m1.1.1.3.cmml" xref="alg1.16.16.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m1.1c">w^{t}</annotation></semantics></math><span id="alg1.16.16.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.23.28" class="ltx_listingline">
<span id="alg1.23.28.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.23.28.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.17.17" class="ltx_listingline">
<span id="alg1.17.17.2" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.17.17.3" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.17.17.1" class="ltx_text ltx_font_bold" style="font-size:90%;">ClientUpdate<math id="alg1.17.17.1.m1.1" class="ltx_Math" alttext="(w)" display="inline"><semantics id="alg1.17.17.1.m1.1a"><mrow id="alg1.17.17.1.m1.1.2.2"><mo stretchy="false" id="alg1.17.17.1.m1.1.2.2.1">(</mo><mi id="alg1.17.17.1.m1.1.1" xref="alg1.17.17.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="alg1.17.17.1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.17.17.1.m1.1b"><ci id="alg1.17.17.1.m1.1.1.cmml" xref="alg1.17.17.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.1.m1.1c">(w)</annotation></semantics></math></span><span id="alg1.17.17.4" class="ltx_text" style="font-size:90%;">: </span>
</div>
<div id="alg1.18.18" class="ltx_listingline">
<span id="alg1.18.18.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.18.18.2" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.18.18.3" class="ltx_text" style="font-size:90%;"><span id="alg1.18.18.3.1" class="ltx_text ltx_font_bold">Input:</span> </span><span id="alg1.18.18.4" class="ltx_text" style="font-size:90%;">global model from previous round </span><math id="alg1.18.18.m1.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="alg1.18.18.m1.1a"><msup id="alg1.18.18.m1.1.1" xref="alg1.18.18.m1.1.1.cmml"><mi mathsize="90%" id="alg1.18.18.m1.1.1.2" xref="alg1.18.18.m1.1.1.2.cmml">w</mi><mi mathsize="90%" id="alg1.18.18.m1.1.1.3" xref="alg1.18.18.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.18.18.m1.1b"><apply id="alg1.18.18.m1.1.1.cmml" xref="alg1.18.18.m1.1.1"><csymbol cd="ambiguous" id="alg1.18.18.m1.1.1.1.cmml" xref="alg1.18.18.m1.1.1">superscript</csymbol><ci id="alg1.18.18.m1.1.1.2.cmml" xref="alg1.18.18.m1.1.1.2">𝑤</ci><ci id="alg1.18.18.m1.1.1.3.cmml" xref="alg1.18.18.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.m1.1c">w^{t}</annotation></semantics></math>
</div>
<div id="alg1.19.19" class="ltx_listingline">
<span id="alg1.19.19.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.19.19.2" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.19.19.3" class="ltx_text" style="font-size:90%;"><span id="alg1.19.19.3.1" class="ltx_text ltx_font_bold">Output:</span> </span><span id="alg1.19.19.4" class="ltx_text" style="font-size:90%;">updated local model </span><math id="alg1.19.19.m1.1" class="ltx_Math" alttext="w^{t}_{k}" display="inline"><semantics id="alg1.19.19.m1.1a"><msubsup id="alg1.19.19.m1.1.1" xref="alg1.19.19.m1.1.1.cmml"><mi mathsize="90%" id="alg1.19.19.m1.1.1.2.2" xref="alg1.19.19.m1.1.1.2.2.cmml">w</mi><mi mathsize="90%" id="alg1.19.19.m1.1.1.3" xref="alg1.19.19.m1.1.1.3.cmml">k</mi><mi mathsize="90%" id="alg1.19.19.m1.1.1.2.3" xref="alg1.19.19.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.19.19.m1.1b"><apply id="alg1.19.19.m1.1.1.cmml" xref="alg1.19.19.m1.1.1"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.1.cmml" xref="alg1.19.19.m1.1.1">subscript</csymbol><apply id="alg1.19.19.m1.1.1.2.cmml" xref="alg1.19.19.m1.1.1"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.2.1.cmml" xref="alg1.19.19.m1.1.1">superscript</csymbol><ci id="alg1.19.19.m1.1.1.2.2.cmml" xref="alg1.19.19.m1.1.1.2.2">𝑤</ci><ci id="alg1.19.19.m1.1.1.2.3.cmml" xref="alg1.19.19.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.19.19.m1.1.1.3.cmml" xref="alg1.19.19.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.m1.1c">w^{t}_{k}</annotation></semantics></math>
</div>
<div id="alg1.20.20" class="ltx_listingline">
<span id="alg1.20.20.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.20.20.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.20.20.m1.1" class="ltx_Math" alttext="w\leftarrow w^{t}" display="inline"><semantics id="alg1.20.20.m1.1a"><mrow id="alg1.20.20.m1.1.1" xref="alg1.20.20.m1.1.1.cmml"><mi mathsize="90%" id="alg1.20.20.m1.1.1.2" xref="alg1.20.20.m1.1.1.2.cmml">w</mi><mo mathsize="90%" stretchy="false" id="alg1.20.20.m1.1.1.1" xref="alg1.20.20.m1.1.1.1.cmml">←</mo><msup id="alg1.20.20.m1.1.1.3" xref="alg1.20.20.m1.1.1.3.cmml"><mi mathsize="90%" id="alg1.20.20.m1.1.1.3.2" xref="alg1.20.20.m1.1.1.3.2.cmml">w</mi><mi mathsize="90%" id="alg1.20.20.m1.1.1.3.3" xref="alg1.20.20.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.20.20.m1.1b"><apply id="alg1.20.20.m1.1.1.cmml" xref="alg1.20.20.m1.1.1"><ci id="alg1.20.20.m1.1.1.1.cmml" xref="alg1.20.20.m1.1.1.1">←</ci><ci id="alg1.20.20.m1.1.1.2.cmml" xref="alg1.20.20.m1.1.1.2">𝑤</ci><apply id="alg1.20.20.m1.1.1.3.cmml" xref="alg1.20.20.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.20.20.m1.1.1.3.1.cmml" xref="alg1.20.20.m1.1.1.3">superscript</csymbol><ci id="alg1.20.20.m1.1.1.3.2.cmml" xref="alg1.20.20.m1.1.1.3.2">𝑤</ci><ci id="alg1.20.20.m1.1.1.3.3.cmml" xref="alg1.20.20.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.20.m1.1c">w\leftarrow w^{t}</annotation></semantics></math><span id="alg1.20.20.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.21.21" class="ltx_listingline">
<span id="alg1.21.21.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.21.21.2" class="ltx_text" style="font-size:90%;">
Sample a batch of episodes </span><math id="alg1.21.21.m1.3" class="ltx_Math" alttext="\mathcal{B}_{k}=\{\mathcal{T}_{1},...,\mathcal{T}_{n}\}" display="inline"><semantics id="alg1.21.21.m1.3a"><mrow id="alg1.21.21.m1.3.3" xref="alg1.21.21.m1.3.3.cmml"><msub id="alg1.21.21.m1.3.3.4" xref="alg1.21.21.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.21.21.m1.3.3.4.2" xref="alg1.21.21.m1.3.3.4.2.cmml">ℬ</mi><mi mathsize="90%" id="alg1.21.21.m1.3.3.4.3" xref="alg1.21.21.m1.3.3.4.3.cmml">k</mi></msub><mo mathsize="90%" id="alg1.21.21.m1.3.3.3" xref="alg1.21.21.m1.3.3.3.cmml">=</mo><mrow id="alg1.21.21.m1.3.3.2.2" xref="alg1.21.21.m1.3.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.21.21.m1.3.3.2.2.3" xref="alg1.21.21.m1.3.3.2.3.cmml">{</mo><msub id="alg1.21.21.m1.2.2.1.1.1" xref="alg1.21.21.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.21.21.m1.2.2.1.1.1.2" xref="alg1.21.21.m1.2.2.1.1.1.2.cmml">𝒯</mi><mn mathsize="90%" id="alg1.21.21.m1.2.2.1.1.1.3" xref="alg1.21.21.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="alg1.21.21.m1.3.3.2.2.4" xref="alg1.21.21.m1.3.3.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.21.21.m1.1.1" xref="alg1.21.21.m1.1.1.cmml">…</mi><mo mathsize="90%" id="alg1.21.21.m1.3.3.2.2.5" xref="alg1.21.21.m1.3.3.2.3.cmml">,</mo><msub id="alg1.21.21.m1.3.3.2.2.2" xref="alg1.21.21.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.21.21.m1.3.3.2.2.2.2" xref="alg1.21.21.m1.3.3.2.2.2.2.cmml">𝒯</mi><mi mathsize="90%" id="alg1.21.21.m1.3.3.2.2.2.3" xref="alg1.21.21.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.21.21.m1.3.3.2.2.6" xref="alg1.21.21.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.21.21.m1.3b"><apply id="alg1.21.21.m1.3.3.cmml" xref="alg1.21.21.m1.3.3"><eq id="alg1.21.21.m1.3.3.3.cmml" xref="alg1.21.21.m1.3.3.3"></eq><apply id="alg1.21.21.m1.3.3.4.cmml" xref="alg1.21.21.m1.3.3.4"><csymbol cd="ambiguous" id="alg1.21.21.m1.3.3.4.1.cmml" xref="alg1.21.21.m1.3.3.4">subscript</csymbol><ci id="alg1.21.21.m1.3.3.4.2.cmml" xref="alg1.21.21.m1.3.3.4.2">ℬ</ci><ci id="alg1.21.21.m1.3.3.4.3.cmml" xref="alg1.21.21.m1.3.3.4.3">𝑘</ci></apply><set id="alg1.21.21.m1.3.3.2.3.cmml" xref="alg1.21.21.m1.3.3.2.2"><apply id="alg1.21.21.m1.2.2.1.1.1.cmml" xref="alg1.21.21.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.21.21.m1.2.2.1.1.1.1.cmml" xref="alg1.21.21.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.21.21.m1.2.2.1.1.1.2.cmml" xref="alg1.21.21.m1.2.2.1.1.1.2">𝒯</ci><cn type="integer" id="alg1.21.21.m1.2.2.1.1.1.3.cmml" xref="alg1.21.21.m1.2.2.1.1.1.3">1</cn></apply><ci id="alg1.21.21.m1.1.1.cmml" xref="alg1.21.21.m1.1.1">…</ci><apply id="alg1.21.21.m1.3.3.2.2.2.cmml" xref="alg1.21.21.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.21.21.m1.3.3.2.2.2.1.cmml" xref="alg1.21.21.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.21.21.m1.3.3.2.2.2.2.cmml" xref="alg1.21.21.m1.3.3.2.2.2.2">𝒯</ci><ci id="alg1.21.21.m1.3.3.2.2.2.3.cmml" xref="alg1.21.21.m1.3.3.2.2.2.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.21.m1.3c">\mathcal{B}_{k}=\{\mathcal{T}_{1},...,\mathcal{T}_{n}\}</annotation></semantics></math><span id="alg1.21.21.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.22.22" class="ltx_listingline">
<span id="alg1.22.22.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.22.22.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.22.22.m1.1" class="ltx_Math" alttext="w^{k}_{t}\leftarrow" display="inline"><semantics id="alg1.22.22.m1.1a"><mrow id="alg1.22.22.m1.1.1" xref="alg1.22.22.m1.1.1.cmml"><msubsup id="alg1.22.22.m1.1.1.2" xref="alg1.22.22.m1.1.1.2.cmml"><mi mathsize="90%" id="alg1.22.22.m1.1.1.2.2.2" xref="alg1.22.22.m1.1.1.2.2.2.cmml">w</mi><mi mathsize="90%" id="alg1.22.22.m1.1.1.2.3" xref="alg1.22.22.m1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.22.22.m1.1.1.2.2.3" xref="alg1.22.22.m1.1.1.2.2.3.cmml">k</mi></msubsup><mo mathsize="90%" stretchy="false" id="alg1.22.22.m1.1.1.1" xref="alg1.22.22.m1.1.1.1.cmml">←</mo><mi id="alg1.22.22.m1.1.1.3" xref="alg1.22.22.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.22.22.m1.1b"><apply id="alg1.22.22.m1.1.1.cmml" xref="alg1.22.22.m1.1.1"><ci id="alg1.22.22.m1.1.1.1.cmml" xref="alg1.22.22.m1.1.1.1">←</ci><apply id="alg1.22.22.m1.1.1.2.cmml" xref="alg1.22.22.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.22.22.m1.1.1.2.1.cmml" xref="alg1.22.22.m1.1.1.2">subscript</csymbol><apply id="alg1.22.22.m1.1.1.2.2.cmml" xref="alg1.22.22.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.22.22.m1.1.1.2.2.1.cmml" xref="alg1.22.22.m1.1.1.2">superscript</csymbol><ci id="alg1.22.22.m1.1.1.2.2.2.cmml" xref="alg1.22.22.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.22.22.m1.1.1.2.2.3.cmml" xref="alg1.22.22.m1.1.1.2.2.3">𝑘</ci></apply><ci id="alg1.22.22.m1.1.1.2.3.cmml" xref="alg1.22.22.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.22.22.m1.1.1.3.cmml" xref="alg1.22.22.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.22.m1.1c">w^{k}_{t}\leftarrow</annotation></semantics></math><span id="alg1.22.22.3" class="ltx_text" style="font-size:90%;"> Solve Eq.(</span><a href="#S3.E9" title="In 1st item ‣ 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">9</span></a><span id="alg1.22.22.4" class="ltx_text" style="font-size:90%;">) with SGD </span>
</div>
<div id="alg1.23.23" class="ltx_listingline">
<span id="alg1.23.23.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg1.23.23.2" class="ltx_text" style="font-size:90%;">
Return </span><math id="alg1.23.23.m1.1" class="ltx_Math" alttext="w^{t}_{k}" display="inline"><semantics id="alg1.23.23.m1.1a"><msubsup id="alg1.23.23.m1.1.1" xref="alg1.23.23.m1.1.1.cmml"><mi mathsize="90%" id="alg1.23.23.m1.1.1.2.2" xref="alg1.23.23.m1.1.1.2.2.cmml">w</mi><mi mathsize="90%" id="alg1.23.23.m1.1.1.3" xref="alg1.23.23.m1.1.1.3.cmml">k</mi><mi mathsize="90%" id="alg1.23.23.m1.1.1.2.3" xref="alg1.23.23.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.23.23.m1.1b"><apply id="alg1.23.23.m1.1.1.cmml" xref="alg1.23.23.m1.1.1"><csymbol cd="ambiguous" id="alg1.23.23.m1.1.1.1.cmml" xref="alg1.23.23.m1.1.1">subscript</csymbol><apply id="alg1.23.23.m1.1.1.2.cmml" xref="alg1.23.23.m1.1.1"><csymbol cd="ambiguous" id="alg1.23.23.m1.1.1.2.1.cmml" xref="alg1.23.23.m1.1.1">superscript</csymbol><ci id="alg1.23.23.m1.1.1.2.2.cmml" xref="alg1.23.23.m1.1.1.2.2">𝑤</ci><ci id="alg1.23.23.m1.1.1.2.3.cmml" xref="alg1.23.23.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.23.23.m1.1.1.3.cmml" xref="alg1.23.23.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.23.m1.1c">w^{t}_{k}</annotation></semantics></math><span id="alg1.23.23.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.23.29" class="ltx_listingline">
<span id="alg1.23.29.1" class="ltx_text" style="font-size:90%;">

</span>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg1.27.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>FedFSL-naive framework.</figcaption>
</figure>
<div id="Thmprop1" class="ltx_theorem ltx_theorem_prop">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Proposition 1.</h6>
<div id="Thmprop1.p1" class="ltx_para">
<p id="Thmprop1.p1.3" class="ltx_p"><span id="Thmprop1.p1.3.3" class="ltx_text ltx_font_italic">If loss function <math id="Thmprop1.p1.1.1.m1.1" class="ltx_Math" alttext="f_{\mathcal{T}}(w)" display="inline"><semantics id="Thmprop1.p1.1.1.m1.1a"><mrow id="Thmprop1.p1.1.1.m1.1.2" xref="Thmprop1.p1.1.1.m1.1.2.cmml"><msub id="Thmprop1.p1.1.1.m1.1.2.2" xref="Thmprop1.p1.1.1.m1.1.2.2.cmml"><mi id="Thmprop1.p1.1.1.m1.1.2.2.2" xref="Thmprop1.p1.1.1.m1.1.2.2.2.cmml">f</mi><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.1.1.m1.1.2.2.3" xref="Thmprop1.p1.1.1.m1.1.2.2.3.cmml">𝒯</mi></msub><mo lspace="0em" rspace="0em" id="Thmprop1.p1.1.1.m1.1.2.1" xref="Thmprop1.p1.1.1.m1.1.2.1.cmml">​</mo><mrow id="Thmprop1.p1.1.1.m1.1.2.3.2" xref="Thmprop1.p1.1.1.m1.1.2.cmml"><mo stretchy="false" id="Thmprop1.p1.1.1.m1.1.2.3.2.1" xref="Thmprop1.p1.1.1.m1.1.2.cmml">(</mo><mi id="Thmprop1.p1.1.1.m1.1.1" xref="Thmprop1.p1.1.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="Thmprop1.p1.1.1.m1.1.2.3.2.2" xref="Thmprop1.p1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmprop1.p1.1.1.m1.1b"><apply id="Thmprop1.p1.1.1.m1.1.2.cmml" xref="Thmprop1.p1.1.1.m1.1.2"><times id="Thmprop1.p1.1.1.m1.1.2.1.cmml" xref="Thmprop1.p1.1.1.m1.1.2.1"></times><apply id="Thmprop1.p1.1.1.m1.1.2.2.cmml" xref="Thmprop1.p1.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="Thmprop1.p1.1.1.m1.1.2.2.1.cmml" xref="Thmprop1.p1.1.1.m1.1.2.2">subscript</csymbol><ci id="Thmprop1.p1.1.1.m1.1.2.2.2.cmml" xref="Thmprop1.p1.1.1.m1.1.2.2.2">𝑓</ci><ci id="Thmprop1.p1.1.1.m1.1.2.2.3.cmml" xref="Thmprop1.p1.1.1.m1.1.2.2.3">𝒯</ci></apply><ci id="Thmprop1.p1.1.1.m1.1.1.cmml" xref="Thmprop1.p1.1.1.m1.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmprop1.p1.1.1.m1.1c">f_{\mathcal{T}}(w)</annotation></semantics></math> in (<a href="#S3.E4" title="In 2nd item ‣ 3.2. General Centralized Few-Shot Learning ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) satisfies
the strongly-convex conditions as in Corollary 1, Finn et al. <cite class="ltx_cite ltx_citemacro_citep">(Finn
et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>
<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnote1.1.1.1" class="ltx_text ltx_font_upright">1</span></span><span id="footnote1.5" class="ltx_text ltx_font_upright"> </span><math id="footnote1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="footnote1.m1.1b"><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">f</annotation></semantics></math><span id="footnote1.6" class="ltx_text ltx_font_upright"> is </span><span id="footnote1.7" class="ltx_text">G-Lipschitz</span><span id="footnote1.8" class="ltx_text ltx_font_upright">, </span><math id="footnote1.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="footnote1.m2.1b"><mi id="footnote1.m2.1.1" xref="footnote1.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="footnote1.m2.1c"><ci id="footnote1.m2.1.1.cmml" xref="footnote1.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m2.1d">\beta</annotation></semantics></math><span id="footnote1.9" class="ltx_text ltx_font_upright">-</span><span id="footnote1.10" class="ltx_text">smooth</span><span id="footnote1.11" class="ltx_text ltx_font_upright">, </span><math id="footnote1.m3.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="footnote1.m3.1b"><mi id="footnote1.m3.1.1" xref="footnote1.m3.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="footnote1.m3.1c"><ci id="footnote1.m3.1.1.cmml" xref="footnote1.m3.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m3.1d">\rho</annotation></semantics></math><span id="footnote1.12" class="ltx_text ltx_font_upright">-</span><span id="footnote1.13" class="ltx_text">Lipschitz</span><span id="footnote1.14" class="ltx_text ltx_font_upright"> Hessians and </span><math id="footnote1.m4.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="footnote1.m4.1b"><mi id="footnote1.m4.1.1" xref="footnote1.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="footnote1.m4.1c"><ci id="footnote1.m4.1.1.cmml" xref="footnote1.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m4.1d">\mu</annotation></semantics></math><span id="footnote1.15" class="ltx_text ltx_font_upright">-</span><span id="footnote1.16" class="ltx_text">strongly</span><span id="footnote1.17" class="ltx_text ltx_font_upright"> convex</span></span></span></span>
, Algorithm <a href="#alg1" title="In 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> converges at a rate of <math id="Thmprop1.p1.2.2.m2.1" class="ltx_Math" alttext="\mathcal{O}(\frac{1}{T})" display="inline"><semantics id="Thmprop1.p1.2.2.m2.1a"><mrow id="Thmprop1.p1.2.2.m2.1.2" xref="Thmprop1.p1.2.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.2.2.m2.1.2.2" xref="Thmprop1.p1.2.2.m2.1.2.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Thmprop1.p1.2.2.m2.1.2.1" xref="Thmprop1.p1.2.2.m2.1.2.1.cmml">​</mo><mrow id="Thmprop1.p1.2.2.m2.1.2.3.2" xref="Thmprop1.p1.2.2.m2.1.1.cmml"><mo stretchy="false" id="Thmprop1.p1.2.2.m2.1.2.3.2.1" xref="Thmprop1.p1.2.2.m2.1.1.cmml">(</mo><mfrac id="Thmprop1.p1.2.2.m2.1.1" xref="Thmprop1.p1.2.2.m2.1.1.cmml"><mn id="Thmprop1.p1.2.2.m2.1.1.2" xref="Thmprop1.p1.2.2.m2.1.1.2.cmml">1</mn><mi id="Thmprop1.p1.2.2.m2.1.1.3" xref="Thmprop1.p1.2.2.m2.1.1.3.cmml">T</mi></mfrac><mo stretchy="false" id="Thmprop1.p1.2.2.m2.1.2.3.2.2" xref="Thmprop1.p1.2.2.m2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmprop1.p1.2.2.m2.1b"><apply id="Thmprop1.p1.2.2.m2.1.2.cmml" xref="Thmprop1.p1.2.2.m2.1.2"><times id="Thmprop1.p1.2.2.m2.1.2.1.cmml" xref="Thmprop1.p1.2.2.m2.1.2.1"></times><ci id="Thmprop1.p1.2.2.m2.1.2.2.cmml" xref="Thmprop1.p1.2.2.m2.1.2.2">𝒪</ci><apply id="Thmprop1.p1.2.2.m2.1.1.cmml" xref="Thmprop1.p1.2.2.m2.1.2.3.2"><divide id="Thmprop1.p1.2.2.m2.1.1.1.cmml" xref="Thmprop1.p1.2.2.m2.1.2.3.2"></divide><cn type="integer" id="Thmprop1.p1.2.2.m2.1.1.2.cmml" xref="Thmprop1.p1.2.2.m2.1.1.2">1</cn><ci id="Thmprop1.p1.2.2.m2.1.1.3.cmml" xref="Thmprop1.p1.2.2.m2.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmprop1.p1.2.2.m2.1c">\mathcal{O}(\frac{1}{T})</annotation></semantics></math> in which <math id="Thmprop1.p1.3.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Thmprop1.p1.3.3.m3.1a"><mi id="Thmprop1.p1.3.3.m3.1.1" xref="Thmprop1.p1.3.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Thmprop1.p1.3.3.m3.1b"><ci id="Thmprop1.p1.3.3.m3.1.1.cmml" xref="Thmprop1.p1.3.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmprop1.p1.3.3.m3.1c">T</annotation></semantics></math> is the total number of every device’s gradient updates during training.</span></p>
</div>
</div>
<div id="S3.SS3.1" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="S3.SS3.1.p1" class="ltx_para">
<p id="S3.SS3.1.p1.4" class="ltx_p">As <math id="S3.SS3.1.p1.1.m1.1" class="ltx_Math" alttext="f_{\mathcal{T}}(w)" display="inline"><semantics id="S3.SS3.1.p1.1.m1.1a"><mrow id="S3.SS3.1.p1.1.m1.1.2" xref="S3.SS3.1.p1.1.m1.1.2.cmml"><msub id="S3.SS3.1.p1.1.m1.1.2.2" xref="S3.SS3.1.p1.1.m1.1.2.2.cmml"><mi id="S3.SS3.1.p1.1.m1.1.2.2.2" xref="S3.SS3.1.p1.1.m1.1.2.2.2.cmml">f</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS3.1.p1.1.m1.1.2.2.3" xref="S3.SS3.1.p1.1.m1.1.2.2.3.cmml">𝒯</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.1.p1.1.m1.1.2.1" xref="S3.SS3.1.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.1.p1.1.m1.1.2.3.2" xref="S3.SS3.1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.1.p1.1.m1.1.2.3.2.1" xref="S3.SS3.1.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.1.p1.1.m1.1.1" xref="S3.SS3.1.p1.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="S3.SS3.1.p1.1.m1.1.2.3.2.2" xref="S3.SS3.1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.1.m1.1b"><apply id="S3.SS3.1.p1.1.m1.1.2.cmml" xref="S3.SS3.1.p1.1.m1.1.2"><times id="S3.SS3.1.p1.1.m1.1.2.1.cmml" xref="S3.SS3.1.p1.1.m1.1.2.1"></times><apply id="S3.SS3.1.p1.1.m1.1.2.2.cmml" xref="S3.SS3.1.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.1.p1.1.m1.1.2.2.1.cmml" xref="S3.SS3.1.p1.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS3.1.p1.1.m1.1.2.2.2.cmml" xref="S3.SS3.1.p1.1.m1.1.2.2.2">𝑓</ci><ci id="S3.SS3.1.p1.1.m1.1.2.2.3.cmml" xref="S3.SS3.1.p1.1.m1.1.2.2.3">𝒯</ci></apply><ci id="S3.SS3.1.p1.1.m1.1.1.cmml" xref="S3.SS3.1.p1.1.m1.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.1.m1.1c">f_{\mathcal{T}}(w)</annotation></semantics></math> is strongly-convex,
Corollary 1, <cite class="ltx_cite ltx_citemacro_citep">(Finn
et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite> implies that the local FSL objective <math id="S3.SS3.1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{k}" display="inline"><semantics id="S3.SS3.1.p1.2.m2.1a"><msub id="S3.SS3.1.p1.2.m2.1.1" xref="S3.SS3.1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.1.p1.2.m2.1.1.2" xref="S3.SS3.1.p1.2.m2.1.1.2.cmml">ℒ</mi><mi id="S3.SS3.1.p1.2.m2.1.1.3" xref="S3.SS3.1.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.2.m2.1b"><apply id="S3.SS3.1.p1.2.m2.1.1.cmml" xref="S3.SS3.1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.1.p1.2.m2.1.1.2">ℒ</ci><ci id="S3.SS3.1.p1.2.m2.1.1.3.cmml" xref="S3.SS3.1.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.2.m2.1c">\mathcal{L}_{k}</annotation></semantics></math> in (<a href="#S3.E7" title="In 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) is also strongly-convex. By taking Algorithm <a href="#alg1" title="In 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> as a FedAvg algorithm with a strongly-convex objective, Theorem 3, <cite class="ltx_cite ltx_citemacro_citep">(Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite> implies that it converges at a rate of <math id="S3.SS3.1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{O}(\frac{1}{T})" display="inline"><semantics id="S3.SS3.1.p1.3.m3.1a"><mrow id="S3.SS3.1.p1.3.m3.1.2" xref="S3.SS3.1.p1.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.1.p1.3.m3.1.2.2" xref="S3.SS3.1.p1.3.m3.1.2.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S3.SS3.1.p1.3.m3.1.2.1" xref="S3.SS3.1.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S3.SS3.1.p1.3.m3.1.2.3.2" xref="S3.SS3.1.p1.3.m3.1.1.cmml"><mo stretchy="false" id="S3.SS3.1.p1.3.m3.1.2.3.2.1" xref="S3.SS3.1.p1.3.m3.1.1.cmml">(</mo><mfrac id="S3.SS3.1.p1.3.m3.1.1" xref="S3.SS3.1.p1.3.m3.1.1.cmml"><mn id="S3.SS3.1.p1.3.m3.1.1.2" xref="S3.SS3.1.p1.3.m3.1.1.2.cmml">1</mn><mi id="S3.SS3.1.p1.3.m3.1.1.3" xref="S3.SS3.1.p1.3.m3.1.1.3.cmml">T</mi></mfrac><mo stretchy="false" id="S3.SS3.1.p1.3.m3.1.2.3.2.2" xref="S3.SS3.1.p1.3.m3.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.3.m3.1b"><apply id="S3.SS3.1.p1.3.m3.1.2.cmml" xref="S3.SS3.1.p1.3.m3.1.2"><times id="S3.SS3.1.p1.3.m3.1.2.1.cmml" xref="S3.SS3.1.p1.3.m3.1.2.1"></times><ci id="S3.SS3.1.p1.3.m3.1.2.2.cmml" xref="S3.SS3.1.p1.3.m3.1.2.2">𝒪</ci><apply id="S3.SS3.1.p1.3.m3.1.1.cmml" xref="S3.SS3.1.p1.3.m3.1.2.3.2"><divide id="S3.SS3.1.p1.3.m3.1.1.1.cmml" xref="S3.SS3.1.p1.3.m3.1.2.3.2"></divide><cn type="integer" id="S3.SS3.1.p1.3.m3.1.1.2.cmml" xref="S3.SS3.1.p1.3.m3.1.1.2">1</cn><ci id="S3.SS3.1.p1.3.m3.1.1.3.cmml" xref="S3.SS3.1.p1.3.m3.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.3.m3.1c">\mathcal{O}(\frac{1}{T})</annotation></semantics></math> in which <math id="S3.SS3.1.p1.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.1.p1.4.m4.1a"><mi id="S3.SS3.1.p1.4.m4.1.1" xref="S3.SS3.1.p1.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.4.m4.1b"><ci id="S3.SS3.1.p1.4.m4.1.1.cmml" xref="S3.SS3.1.p1.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.4.m4.1c">T</annotation></semantics></math> is total number of local gradient updates of all devices during training.
∎</p>
</div>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.1" class="ltx_p">Proposition <a href="#Thmprop1" title="Proposition 1. ‣ 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows that for a convex FSL objective,
e.g., the cross-entropy loss of a linear or logistic model with <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><msub id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><mi id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">L</mi><mn id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S3.SS3.p5.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">L_{2}</annotation></semantics></math>-regularization, Algorithm <a href="#alg1" title="In 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> converges.
For a broader family of non-convex models, such as deep neural networks, convergence of FedL is still an open research topic though
some attempts have been made <cite class="ltx_cite ltx_citemacro_citep">(Smith et al<span class="ltx_text">.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2017</a>; Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.5" class="ltx_p">We note that solving (<a href="#S3.E9" title="In 1st item ‣ 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) requires computing a gradient through <math id="S3.SS3.p6.1.m1.1" class="ltx_Math" alttext="w^{\prime}" display="inline"><semantics id="S3.SS3.p6.1.m1.1a"><msup id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml"><mi id="S3.SS3.p6.1.m1.1.1.2" xref="S3.SS3.p6.1.m1.1.1.2.cmml">w</mi><mo id="S3.SS3.p6.1.m1.1.1.3" xref="S3.SS3.p6.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><apply id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.1.m1.1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p6.1.m1.1.1.2.cmml" xref="S3.SS3.p6.1.m1.1.1.2">𝑤</ci><ci id="S3.SS3.p6.1.m1.1.1.3.cmml" xref="S3.SS3.p6.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">w^{\prime}</annotation></semantics></math>, which is another function of gradient of <math id="S3.SS3.p6.2.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS3.p6.2.m2.1a"><mi id="S3.SS3.p6.2.m2.1.1" xref="S3.SS3.p6.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m2.1b"><ci id="S3.SS3.p6.2.m2.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m2.1c">w</annotation></semantics></math> as given by (<a href="#S3.E4" title="In 2nd item ‣ 3.2. General Centralized Few-Shot Learning ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), and thus requires computing the Hessian. Fortunately, fast Hessian-vector products <cite class="ltx_cite ltx_citemacro_citep">(Ghorbani
et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite> are widely adopted to approximate the second-order information, which is equivalent of performing backward passes twice with SGD.
If we denote the number of parameters of the model as <math id="S3.SS3.p6.3.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS3.p6.3.m3.1a"><mi id="S3.SS3.p6.3.m3.1.1" xref="S3.SS3.p6.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.3.m3.1b"><ci id="S3.SS3.p6.3.m3.1.1.cmml" xref="S3.SS3.p6.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.3.m3.1c">W</annotation></semantics></math>, this results in <math id="S3.SS3.p6.4.m4.1" class="ltx_Math" alttext="\mathcal{O}(W)" display="inline"><semantics id="S3.SS3.p6.4.m4.1a"><mrow id="S3.SS3.p6.4.m4.1.2" xref="S3.SS3.p6.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p6.4.m4.1.2.2" xref="S3.SS3.p6.4.m4.1.2.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p6.4.m4.1.2.1" xref="S3.SS3.p6.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS3.p6.4.m4.1.2.3.2" xref="S3.SS3.p6.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS3.p6.4.m4.1.2.3.2.1" xref="S3.SS3.p6.4.m4.1.2.cmml">(</mo><mi id="S3.SS3.p6.4.m4.1.1" xref="S3.SS3.p6.4.m4.1.1.cmml">W</mi><mo stretchy="false" id="S3.SS3.p6.4.m4.1.2.3.2.2" xref="S3.SS3.p6.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.4.m4.1b"><apply id="S3.SS3.p6.4.m4.1.2.cmml" xref="S3.SS3.p6.4.m4.1.2"><times id="S3.SS3.p6.4.m4.1.2.1.cmml" xref="S3.SS3.p6.4.m4.1.2.1"></times><ci id="S3.SS3.p6.4.m4.1.2.2.cmml" xref="S3.SS3.p6.4.m4.1.2.2">𝒪</ci><ci id="S3.SS3.p6.4.m4.1.1.cmml" xref="S3.SS3.p6.4.m4.1.1">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.4.m4.1c">\mathcal{O}(W)</annotation></semantics></math> computational time for one iteration of model update. Thus the total computational time of FedFSL-naive is <math id="S3.SS3.p6.5.m5.1" class="ltx_Math" alttext="\mathcal{O}(W\cdot T)" display="inline"><semantics id="S3.SS3.p6.5.m5.1a"><mrow id="S3.SS3.p6.5.m5.1.1" xref="S3.SS3.p6.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p6.5.m5.1.1.3" xref="S3.SS3.p6.5.m5.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p6.5.m5.1.1.2" xref="S3.SS3.p6.5.m5.1.1.2.cmml">​</mo><mrow id="S3.SS3.p6.5.m5.1.1.1.1" xref="S3.SS3.p6.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p6.5.m5.1.1.1.1.2" xref="S3.SS3.p6.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p6.5.m5.1.1.1.1.1" xref="S3.SS3.p6.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS3.p6.5.m5.1.1.1.1.1.2" xref="S3.SS3.p6.5.m5.1.1.1.1.1.2.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p6.5.m5.1.1.1.1.1.1" xref="S3.SS3.p6.5.m5.1.1.1.1.1.1.cmml">⋅</mo><mi id="S3.SS3.p6.5.m5.1.1.1.1.1.3" xref="S3.SS3.p6.5.m5.1.1.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S3.SS3.p6.5.m5.1.1.1.1.3" xref="S3.SS3.p6.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.5.m5.1b"><apply id="S3.SS3.p6.5.m5.1.1.cmml" xref="S3.SS3.p6.5.m5.1.1"><times id="S3.SS3.p6.5.m5.1.1.2.cmml" xref="S3.SS3.p6.5.m5.1.1.2"></times><ci id="S3.SS3.p6.5.m5.1.1.3.cmml" xref="S3.SS3.p6.5.m5.1.1.3">𝒪</ci><apply id="S3.SS3.p6.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.p6.5.m5.1.1.1.1"><ci id="S3.SS3.p6.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.p6.5.m5.1.1.1.1.1.1">⋅</ci><ci id="S3.SS3.p6.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS3.p6.5.m5.1.1.1.1.1.2">𝑊</ci><ci id="S3.SS3.p6.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS3.p6.5.m5.1.1.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.5.m5.1c">\mathcal{O}(W\cdot T)</annotation></semantics></math>. Note that Chen <span id="S3.SS3.p6.5.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_citep">(Chen
et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite> proposed similar federated meta-learning procedures for supervised learning tasks.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Improving FedFSL with better coordination</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">So far, we have provided FedFSL-naive as a straightforward way of performing distributed few-shot learning. However, one unresolved technical challenge is that meta-learning
depends on sampled episodes that contain only very few labeled data points. In data-scarce scenarios, even the data distribution over the clients could be the same, the high variance of the data
may lead to quite distinct gradient descent directions, and thus
the trained few-shot models could become quite distinct over the clients. This results in model divergence in aggregation.
Similar observations were also found in FedL tasks with non-IID data <cite class="ltx_cite ltx_citemacro_citep">(Zhao
et al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2018</a>; Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2018</a>)</cite> but this problem has been amplified in the data-scarce scenarios we consider.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2104.00365/assets/x4.png" id="S4.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="140" height="115" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.3.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>. </span><span id="S4.F4.4.2" class="ltx_text" style="font-size:90%;">Illustration of decision boundaries learned by (a) FedFSL-naive and (b) FedFSL-MI in two-client case. </span></figcaption>
</figure>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">In Fig. <a href="#S4.F4" title="Figure 4 ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(a), we illustrate a two-client case which follows FedFSL-naive scheme to learn models individually (left) first and average the models to obtain the federated decision boundary (right). However, the discrepancy between two client models makes them provide misaligned individual decision boundaries (left). Thus the aggregated central model provides less optimal federated decision boundary (right) with lots of misclassified data samples.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">In this section, we will discuss how to better coordinate client models with mutual information in <a href="#S4.SS1" title="4.1. FedFSL with Mutual Information (MI) ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>, and we propose an adversarial learning procedures to further learn a discriminative feature space in <a href="#S4.SS2" title="4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>FedFSL with Mutual Information (MI)</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">To better coordinate client models learned on distinct data sources, we propose to regularize the local updates by minimizing the divergence between client models and the central model.
As the central model is shared with the clients at each round, it serves as an intermediate way of training the clients collaboratively without overfitting local data.</p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1. </span>Mutual information (MI)</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p">Kullback-Leibler (KL) divergence is commonly used as a measure of the difference of two probability distributions.
In a collection of multiple distributions, a summed pair-wise KL-divergence is used in
recent studies <cite class="ltx_cite ltx_citemacro_citep">(Belghazi et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2018</a>; Zhang
et al<span class="ltx_text">.</span>, <a href="#bib.bib45" title="" class="ltx_ref">2018b</a>)</cite> in ensemble learning to measure the total discrepancy of all those distributions, which we term it <span id="S4.SS1.SSS1.p1.1.1" class="ltx_text ltx_font_italic">mutual information</span> (MI).
In FedL, MI can be utilized to measure the discrepancy of all the participating client models. However, calculating the pairwise KL-divergence requires <math id="S4.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{O}(K^{2})" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mrow id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p1.1.m1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p1.1.m1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS1.p1.1.m1.1.1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.2.cmml">K</mi><mn id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><apply id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><times id="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.2"></times><ci id="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3">𝒪</ci><apply id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.2">𝐾</ci><cn type="integer" id="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">\mathcal{O}(K^{2})</annotation></semantics></math> calculations which could impose heavy burdens to the central server.
We will propose a simplified MI proximal term and integrate it in FedFSL, and we target to minimize it for reducing internal discrepancy over client models.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2. </span>FedFSL-MI</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.2" class="ltx_p">Formally, at <math id="S4.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS1.SSS2.p1.1.m1.1a"><mi id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.1b"><ci id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.1c">t</annotation></semantics></math>-th optimization round, we ask the central server to produce a k-exclusive global model <math id="S4.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="w^{t}_{\text{-}k}" display="inline"><semantics id="S4.SS1.SSS2.p1.2.m2.1a"><msubsup id="S4.SS1.SSS2.p1.2.m2.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p1.2.m2.1.1.2.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.2.2.cmml">w</mi><mrow id="S4.SS1.SSS2.p1.2.m2.1.1.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.cmml"><mtext id="S4.SS1.SSS2.p1.2.m2.1.1.3.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.2a.cmml">-</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p1.2.m2.1.1.3.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS2.p1.2.m2.1.1.3.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.3.cmml">k</mi></mrow><mi id="S4.SS1.SSS2.p1.2.m2.1.1.2.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.2.m2.1b"><apply id="S4.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1">subscript</csymbol><apply id="S4.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.SSS2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.2.2">𝑤</ci><ci id="S4.SS1.SSS2.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3"><times id="S4.SS1.SSS2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.1"></times><ci id="S4.SS1.SSS2.p1.2.m2.1.1.3.2a.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.2"><mtext mathsize="70%" id="S4.SS1.SSS2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.2">-</mtext></ci><ci id="S4.SS1.SSS2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.2.m2.1c">w^{t}_{\text{-}k}</annotation></semantics></math> such that</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.5" class="ltx_Math" alttext="w^{t}_{\text{-}k}=\sum_{c=1,c\neq k}^{K}\frac{|\mathcal{B}_{c}|}{|\mathcal{B}_{\textit{-}k}|}w^{t}_{c}\ ," display="block"><semantics id="S4.E11.m1.5a"><mrow id="S4.E11.m1.5.5.1" xref="S4.E11.m1.5.5.1.1.cmml"><mrow id="S4.E11.m1.5.5.1.1" xref="S4.E11.m1.5.5.1.1.cmml"><msubsup id="S4.E11.m1.5.5.1.1.2" xref="S4.E11.m1.5.5.1.1.2.cmml"><mi id="S4.E11.m1.5.5.1.1.2.2.2" xref="S4.E11.m1.5.5.1.1.2.2.2.cmml">w</mi><mrow id="S4.E11.m1.5.5.1.1.2.3" xref="S4.E11.m1.5.5.1.1.2.3.cmml"><mtext id="S4.E11.m1.5.5.1.1.2.3.2" xref="S4.E11.m1.5.5.1.1.2.3.2a.cmml">-</mtext><mo lspace="0em" rspace="0em" id="S4.E11.m1.5.5.1.1.2.3.1" xref="S4.E11.m1.5.5.1.1.2.3.1.cmml">​</mo><mi id="S4.E11.m1.5.5.1.1.2.3.3" xref="S4.E11.m1.5.5.1.1.2.3.3.cmml">k</mi></mrow><mi id="S4.E11.m1.5.5.1.1.2.2.3" xref="S4.E11.m1.5.5.1.1.2.2.3.cmml">t</mi></msubsup><mo rspace="0.111em" id="S4.E11.m1.5.5.1.1.1" xref="S4.E11.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E11.m1.5.5.1.1.3" xref="S4.E11.m1.5.5.1.1.3.cmml"><munderover id="S4.E11.m1.5.5.1.1.3.1" xref="S4.E11.m1.5.5.1.1.3.1.cmml"><mo movablelimits="false" id="S4.E11.m1.5.5.1.1.3.1.2.2" xref="S4.E11.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.3.cmml"><mrow id="S4.E11.m1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.2.cmml">c</mi><mo id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.cmml">=</mo><mn id="S4.E11.m1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E11.m1.2.2.2.2.3" xref="S4.E11.m1.2.2.2.3a.cmml">,</mo><mrow id="S4.E11.m1.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.cmml"><mi id="S4.E11.m1.2.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.2.cmml">c</mi><mo id="S4.E11.m1.2.2.2.2.2.1" xref="S4.E11.m1.2.2.2.2.2.1.cmml">≠</mo><mi id="S4.E11.m1.2.2.2.2.2.3" xref="S4.E11.m1.2.2.2.2.2.3.cmml">k</mi></mrow></mrow><mi id="S4.E11.m1.5.5.1.1.3.1.3" xref="S4.E11.m1.5.5.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S4.E11.m1.5.5.1.1.3.2" xref="S4.E11.m1.5.5.1.1.3.2.cmml"><mfrac id="S4.E11.m1.4.4" xref="S4.E11.m1.4.4.cmml"><mrow id="S4.E11.m1.3.3.1.1" xref="S4.E11.m1.3.3.1.2.cmml"><mo stretchy="false" id="S4.E11.m1.3.3.1.1.2" xref="S4.E11.m1.3.3.1.2.1.cmml">|</mo><msub id="S4.E11.m1.3.3.1.1.1" xref="S4.E11.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.3.3.1.1.1.2" xref="S4.E11.m1.3.3.1.1.1.2.cmml">ℬ</mi><mi id="S4.E11.m1.3.3.1.1.1.3" xref="S4.E11.m1.3.3.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.E11.m1.3.3.1.1.3" xref="S4.E11.m1.3.3.1.2.1.cmml">|</mo></mrow><mrow id="S4.E11.m1.4.4.2.1" xref="S4.E11.m1.4.4.2.2.cmml"><mo stretchy="false" id="S4.E11.m1.4.4.2.1.2" xref="S4.E11.m1.4.4.2.2.1.cmml">|</mo><msub id="S4.E11.m1.4.4.2.1.1" xref="S4.E11.m1.4.4.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.4.4.2.1.1.2" xref="S4.E11.m1.4.4.2.1.1.2.cmml">ℬ</mi><mrow id="S4.E11.m1.4.4.2.1.1.3" xref="S4.E11.m1.4.4.2.1.1.3.cmml"><mtext class="ltx_mathvariant_italic" id="S4.E11.m1.4.4.2.1.1.3.2" xref="S4.E11.m1.4.4.2.1.1.3.2a.cmml">-</mtext><mo lspace="0em" rspace="0em" id="S4.E11.m1.4.4.2.1.1.3.1" xref="S4.E11.m1.4.4.2.1.1.3.1.cmml">​</mo><mi id="S4.E11.m1.4.4.2.1.1.3.3" xref="S4.E11.m1.4.4.2.1.1.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S4.E11.m1.4.4.2.1.3" xref="S4.E11.m1.4.4.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E11.m1.5.5.1.1.3.2.1" xref="S4.E11.m1.5.5.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E11.m1.5.5.1.1.3.2.2" xref="S4.E11.m1.5.5.1.1.3.2.2.cmml"><mi id="S4.E11.m1.5.5.1.1.3.2.2.2.2" xref="S4.E11.m1.5.5.1.1.3.2.2.2.2.cmml">w</mi><mi id="S4.E11.m1.5.5.1.1.3.2.2.3" xref="S4.E11.m1.5.5.1.1.3.2.2.3.cmml">c</mi><mi id="S4.E11.m1.5.5.1.1.3.2.2.2.3" xref="S4.E11.m1.5.5.1.1.3.2.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><mo id="S4.E11.m1.5.5.1.2" xref="S4.E11.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.5b"><apply id="S4.E11.m1.5.5.1.1.cmml" xref="S4.E11.m1.5.5.1"><eq id="S4.E11.m1.5.5.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.1"></eq><apply id="S4.E11.m1.5.5.1.1.2.cmml" xref="S4.E11.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.2.1.cmml" xref="S4.E11.m1.5.5.1.1.2">subscript</csymbol><apply id="S4.E11.m1.5.5.1.1.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.2">superscript</csymbol><ci id="S4.E11.m1.5.5.1.1.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2.2.2">𝑤</ci><ci id="S4.E11.m1.5.5.1.1.2.2.3.cmml" xref="S4.E11.m1.5.5.1.1.2.2.3">𝑡</ci></apply><apply id="S4.E11.m1.5.5.1.1.2.3.cmml" xref="S4.E11.m1.5.5.1.1.2.3"><times id="S4.E11.m1.5.5.1.1.2.3.1.cmml" xref="S4.E11.m1.5.5.1.1.2.3.1"></times><ci id="S4.E11.m1.5.5.1.1.2.3.2a.cmml" xref="S4.E11.m1.5.5.1.1.2.3.2"><mtext mathsize="70%" id="S4.E11.m1.5.5.1.1.2.3.2.cmml" xref="S4.E11.m1.5.5.1.1.2.3.2">-</mtext></ci><ci id="S4.E11.m1.5.5.1.1.2.3.3.cmml" xref="S4.E11.m1.5.5.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S4.E11.m1.5.5.1.1.3.cmml" xref="S4.E11.m1.5.5.1.1.3"><apply id="S4.E11.m1.5.5.1.1.3.1.cmml" xref="S4.E11.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.1.1.cmml" xref="S4.E11.m1.5.5.1.1.3.1">superscript</csymbol><apply id="S4.E11.m1.5.5.1.1.3.1.2.cmml" xref="S4.E11.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.1.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.1">subscript</csymbol><sum id="S4.E11.m1.5.5.1.1.3.1.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.1.2.2"></sum><apply id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.3a.cmml" xref="S4.E11.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E11.m1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1"><eq id="S4.E11.m1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1"></eq><ci id="S4.E11.m1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.2">𝑐</ci><cn type="integer" id="S4.E11.m1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E11.m1.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2"><neq id="S4.E11.m1.2.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.2.1"></neq><ci id="S4.E11.m1.2.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2">𝑐</ci><ci id="S4.E11.m1.2.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.2.3">𝑘</ci></apply></apply></apply><ci id="S4.E11.m1.5.5.1.1.3.1.3.cmml" xref="S4.E11.m1.5.5.1.1.3.1.3">𝐾</ci></apply><apply id="S4.E11.m1.5.5.1.1.3.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2"><times id="S4.E11.m1.5.5.1.1.3.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2.1"></times><apply id="S4.E11.m1.4.4.cmml" xref="S4.E11.m1.4.4"><divide id="S4.E11.m1.4.4.3.cmml" xref="S4.E11.m1.4.4"></divide><apply id="S4.E11.m1.3.3.1.2.cmml" xref="S4.E11.m1.3.3.1.1"><abs id="S4.E11.m1.3.3.1.2.1.cmml" xref="S4.E11.m1.3.3.1.1.2"></abs><apply id="S4.E11.m1.3.3.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.1.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1">subscript</csymbol><ci id="S4.E11.m1.3.3.1.1.1.2.cmml" xref="S4.E11.m1.3.3.1.1.1.2">ℬ</ci><ci id="S4.E11.m1.3.3.1.1.1.3.cmml" xref="S4.E11.m1.3.3.1.1.1.3">𝑐</ci></apply></apply><apply id="S4.E11.m1.4.4.2.2.cmml" xref="S4.E11.m1.4.4.2.1"><abs id="S4.E11.m1.4.4.2.2.1.cmml" xref="S4.E11.m1.4.4.2.1.2"></abs><apply id="S4.E11.m1.4.4.2.1.1.cmml" xref="S4.E11.m1.4.4.2.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.1.1.1.cmml" xref="S4.E11.m1.4.4.2.1.1">subscript</csymbol><ci id="S4.E11.m1.4.4.2.1.1.2.cmml" xref="S4.E11.m1.4.4.2.1.1.2">ℬ</ci><apply id="S4.E11.m1.4.4.2.1.1.3.cmml" xref="S4.E11.m1.4.4.2.1.1.3"><times id="S4.E11.m1.4.4.2.1.1.3.1.cmml" xref="S4.E11.m1.4.4.2.1.1.3.1"></times><ci id="S4.E11.m1.4.4.2.1.1.3.2a.cmml" xref="S4.E11.m1.4.4.2.1.1.3.2"><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S4.E11.m1.4.4.2.1.1.3.2.cmml" xref="S4.E11.m1.4.4.2.1.1.3.2">-</mtext></ci><ci id="S4.E11.m1.4.4.2.1.1.3.3.cmml" xref="S4.E11.m1.4.4.2.1.1.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S4.E11.m1.5.5.1.1.3.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2">subscript</csymbol><apply id="S4.E11.m1.5.5.1.1.3.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2">superscript</csymbol><ci id="S4.E11.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2.2.2">𝑤</ci><ci id="S4.E11.m1.5.5.1.1.3.2.2.2.3.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2.2.3">𝑡</ci></apply><ci id="S4.E11.m1.5.5.1.1.3.2.2.3.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.5c">w^{t}_{\text{-}k}=\sum_{c=1,c\neq k}^{K}\frac{|\mathcal{B}_{c}|}{|\mathcal{B}_{\textit{-}k}|}w^{t}_{c}\ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS2.p1.5" class="ltx_p">and send back to <math id="S4.SS1.SSS2.p1.3.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.SSS2.p1.3.m1.1a"><mi id="S4.SS1.SSS2.p1.3.m1.1.1" xref="S4.SS1.SSS2.p1.3.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.3.m1.1b"><ci id="S4.SS1.SSS2.p1.3.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.3.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.3.m1.1c">k</annotation></semantics></math>-th client. The k-exclusive global model <math id="S4.SS1.SSS2.p1.4.m2.1" class="ltx_Math" alttext="w^{t}_{\text{-}k}" display="inline"><semantics id="S4.SS1.SSS2.p1.4.m2.1a"><msubsup id="S4.SS1.SSS2.p1.4.m2.1.1" xref="S4.SS1.SSS2.p1.4.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p1.4.m2.1.1.2.2" xref="S4.SS1.SSS2.p1.4.m2.1.1.2.2.cmml">w</mi><mrow id="S4.SS1.SSS2.p1.4.m2.1.1.3" xref="S4.SS1.SSS2.p1.4.m2.1.1.3.cmml"><mtext id="S4.SS1.SSS2.p1.4.m2.1.1.3.2" xref="S4.SS1.SSS2.p1.4.m2.1.1.3.2a.cmml">-</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p1.4.m2.1.1.3.1" xref="S4.SS1.SSS2.p1.4.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS2.p1.4.m2.1.1.3.3" xref="S4.SS1.SSS2.p1.4.m2.1.1.3.3.cmml">k</mi></mrow><mi id="S4.SS1.SSS2.p1.4.m2.1.1.2.3" xref="S4.SS1.SSS2.p1.4.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.4.m2.1b"><apply id="S4.SS1.SSS2.p1.4.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.4.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p1.4.m2.1.1">subscript</csymbol><apply id="S4.SS1.SSS2.p1.4.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.4.m2.1.1.2.1.cmml" xref="S4.SS1.SSS2.p1.4.m2.1.1">superscript</csymbol><ci id="S4.SS1.SSS2.p1.4.m2.1.1.2.2.cmml" xref="S4.SS1.SSS2.p1.4.m2.1.1.2.2">𝑤</ci><ci id="S4.SS1.SSS2.p1.4.m2.1.1.2.3.cmml" xref="S4.SS1.SSS2.p1.4.m2.1.1.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS2.p1.4.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p1.4.m2.1.1.3"><times id="S4.SS1.SSS2.p1.4.m2.1.1.3.1.cmml" xref="S4.SS1.SSS2.p1.4.m2.1.1.3.1"></times><ci id="S4.SS1.SSS2.p1.4.m2.1.1.3.2a.cmml" xref="S4.SS1.SSS2.p1.4.m2.1.1.3.2"><mtext mathsize="70%" id="S4.SS1.SSS2.p1.4.m2.1.1.3.2.cmml" xref="S4.SS1.SSS2.p1.4.m2.1.1.3.2">-</mtext></ci><ci id="S4.SS1.SSS2.p1.4.m2.1.1.3.3.cmml" xref="S4.SS1.SSS2.p1.4.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.4.m2.1c">w^{t}_{\text{-}k}</annotation></semantics></math> is taken as an ensemble of all other client models except the <math id="S4.SS1.SSS2.p1.5.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.SSS2.p1.5.m3.1a"><mi id="S4.SS1.SSS2.p1.5.m3.1.1" xref="S4.SS1.SSS2.p1.5.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.5.m3.1b"><ci id="S4.SS1.SSS2.p1.5.m3.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.5.m3.1c">k</annotation></semantics></math>-th client.</p>
</div>
<div id="S4.SS1.SSS2.p2" class="ltx_para">
<p id="S4.SS1.SSS2.p2.2" class="ltx_p">We now define the MI loss as the Kullback-Leibler (KL) divergence of probability outputs produced by the k-exclusive global model <math id="S4.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="w^{t}_{\text{-}k}" display="inline"><semantics id="S4.SS1.SSS2.p2.1.m1.1a"><msubsup id="S4.SS1.SSS2.p2.1.m1.1.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.cmml"><mi id="S4.SS1.SSS2.p2.1.m1.1.1.2.2" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.2.cmml">w</mi><mrow id="S4.SS1.SSS2.p2.1.m1.1.1.3" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.cmml"><mtext id="S4.SS1.SSS2.p2.1.m1.1.1.3.2" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.2a.cmml">-</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p2.1.m1.1.1.3.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS2.p2.1.m1.1.1.3.3" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3.cmml">k</mi></mrow><mi id="S4.SS1.SSS2.p2.1.m1.1.1.2.3" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.1.m1.1b"><apply id="S4.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1">subscript</csymbol><apply id="S4.SS1.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.SSS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.2">𝑤</ci><ci id="S4.SS1.SSS2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3"><times id="S4.SS1.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.1"></times><ci id="S4.SS1.SSS2.p2.1.m1.1.1.3.2a.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.2"><mtext mathsize="70%" id="S4.SS1.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.2">-</mtext></ci><ci id="S4.SS1.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.1.m1.1c">w^{t}_{\text{-}k}</annotation></semantics></math> and the client model <math id="S4.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="S4.SS1.SSS2.p2.2.m2.1a"><msub id="S4.SS1.SSS2.p2.2.m2.1.1" xref="S4.SS1.SSS2.p2.2.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p2.2.m2.1.1.2" xref="S4.SS1.SSS2.p2.2.m2.1.1.2.cmml">w</mi><mi id="S4.SS1.SSS2.p2.2.m2.1.1.3" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.2.m2.1b"><apply id="S4.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.2">𝑤</ci><ci id="S4.SS1.SSS2.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.2.m2.1c">w_{k}</annotation></semantics></math> over sampled tasks such that</p>
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E12.m1.68" class="ltx_math_unparsed" alttext="\begin{split}&amp;\mathcal{L}_{k}^{MI}(w^{t}_{-k},w_{k})=\frac{1}{|\mathcal{B}_{k}|}\sum_{\mathcal{T}_{k}}D_{KL}\left(p(w^{t}_{-k})~{}||~{}p(w_{k})\right)\\
=&amp;\frac{1}{|\mathcal{B}_{k}|}\sum_{\mathcal{T}_{k}}(p(w^{t}_{-k})\cdot\log p(w^{t}_{-k})-p(w^{t}_{-k})\cdot\log p(w_{k})),\\
\end{split}" display="block"><semantics id="S4.E12.m1.68a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S4.E12.m1.68.68.1"><mtr id="S4.E12.m1.68.68.1a"><mtd id="S4.E12.m1.68.68.1b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.68.68.1c"><mrow id="S4.E12.m1.32.32.32.32.32"><msubsup id="S4.E12.m1.32.32.32.32.32.33"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.1.1.1.1">ℒ</mi><mi id="S4.E12.m1.2.2.2.2.2.2.1">k</mi><mrow id="S4.E12.m1.3.3.3.3.3.3.1"><mi id="S4.E12.m1.3.3.3.3.3.3.1.2">M</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.3.3.3.3.1.1">​</mo><mi id="S4.E12.m1.3.3.3.3.3.3.1.3">I</mi></mrow></msubsup><mrow id="S4.E12.m1.32.32.32.32.32.34"><mo stretchy="false" id="S4.E12.m1.4.4.4.4.4.4">(</mo><msubsup id="S4.E12.m1.32.32.32.32.32.34.1"><mi id="S4.E12.m1.5.5.5.5.5.5">w</mi><mrow id="S4.E12.m1.7.7.7.7.7.7.1"><mo id="S4.E12.m1.7.7.7.7.7.7.1a">−</mo><mi id="S4.E12.m1.7.7.7.7.7.7.1.2">k</mi></mrow><mi id="S4.E12.m1.6.6.6.6.6.6.1">t</mi></msubsup><mo id="S4.E12.m1.8.8.8.8.8.8">,</mo><msub id="S4.E12.m1.32.32.32.32.32.34.2"><mi id="S4.E12.m1.9.9.9.9.9.9">w</mi><mi id="S4.E12.m1.10.10.10.10.10.10.1">k</mi></msub><mo stretchy="false" id="S4.E12.m1.11.11.11.11.11.11">)</mo></mrow><mo id="S4.E12.m1.12.12.12.12.12.12">=</mo><mfrac id="S4.E12.m1.13.13.13.13.13.13"><mn id="S4.E12.m1.13.13.13.13.13.13.3">1</mn><mrow id="S4.E12.m1.13.13.13.13.13.13.1.1"><mo stretchy="false" id="S4.E12.m1.13.13.13.13.13.13.1.1.2">|</mo><msub id="S4.E12.m1.13.13.13.13.13.13.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.13.13.13.13.13.13.1.1.1.2">ℬ</mi><mi id="S4.E12.m1.13.13.13.13.13.13.1.1.1.3">k</mi></msub><mo stretchy="false" id="S4.E12.m1.13.13.13.13.13.13.1.1.3">|</mo></mrow></mfrac><munder id="S4.E12.m1.32.32.32.32.32.35"><mo movablelimits="false" id="S4.E12.m1.14.14.14.14.14.14">∑</mo><msub id="S4.E12.m1.15.15.15.15.15.15.1"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.15.15.15.15.15.15.1.2">𝒯</mi><mi id="S4.E12.m1.15.15.15.15.15.15.1.3">k</mi></msub></munder><msub id="S4.E12.m1.32.32.32.32.32.36"><mi id="S4.E12.m1.16.16.16.16.16.16">D</mi><mrow id="S4.E12.m1.17.17.17.17.17.17.1"><mi id="S4.E12.m1.17.17.17.17.17.17.1.2">K</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.17.17.17.17.17.17.1.1">​</mo><mi id="S4.E12.m1.17.17.17.17.17.17.1.3">L</mi></mrow></msub><mrow id="S4.E12.m1.32.32.32.32.32.37"><mo id="S4.E12.m1.18.18.18.18.18.18">(</mo><mi id="S4.E12.m1.19.19.19.19.19.19">p</mi><mrow id="S4.E12.m1.32.32.32.32.32.37.1"><mo stretchy="false" id="S4.E12.m1.20.20.20.20.20.20">(</mo><msubsup id="S4.E12.m1.32.32.32.32.32.37.1.1"><mi id="S4.E12.m1.21.21.21.21.21.21">w</mi><mrow id="S4.E12.m1.23.23.23.23.23.23.1"><mo id="S4.E12.m1.23.23.23.23.23.23.1a">−</mo><mi id="S4.E12.m1.23.23.23.23.23.23.1.2">k</mi></mrow><mi id="S4.E12.m1.22.22.22.22.22.22.1">t</mi></msubsup><mo rspace="0.330em" stretchy="false" id="S4.E12.m1.24.24.24.24.24.24">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S4.E12.m1.25.25.25.25.25.25">|</mo><mo fence="false" rspace="0.497em" stretchy="false" id="S4.E12.m1.26.26.26.26.26.26">|</mo><mi id="S4.E12.m1.27.27.27.27.27.27">p</mi><mrow id="S4.E12.m1.32.32.32.32.32.37.2"><mo stretchy="false" id="S4.E12.m1.28.28.28.28.28.28">(</mo><msub id="S4.E12.m1.32.32.32.32.32.37.2.1"><mi id="S4.E12.m1.29.29.29.29.29.29">w</mi><mi id="S4.E12.m1.30.30.30.30.30.30.1">k</mi></msub><mo stretchy="false" id="S4.E12.m1.31.31.31.31.31.31">)</mo></mrow><mo id="S4.E12.m1.32.32.32.32.32.32">)</mo></mrow></mrow></mtd></mtr><mtr id="S4.E12.m1.68.68.1d"><mtd class="ltx_align_right" columnalign="right" id="S4.E12.m1.68.68.1e"><mo id="S4.E12.m1.33.33.33.1.1.1">=</mo></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.68.68.1f"><mrow id="S4.E12.m1.68.68.1.68.36.35.35"><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1"><mfrac id="S4.E12.m1.34.34.34.2.1.1"><mn id="S4.E12.m1.34.34.34.2.1.1.3">1</mn><mrow id="S4.E12.m1.34.34.34.2.1.1.1.1"><mo stretchy="false" id="S4.E12.m1.34.34.34.2.1.1.1.1.2">|</mo><msub id="S4.E12.m1.34.34.34.2.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.34.34.34.2.1.1.1.1.1.2">ℬ</mi><mi id="S4.E12.m1.34.34.34.2.1.1.1.1.1.3">k</mi></msub><mo stretchy="false" id="S4.E12.m1.34.34.34.2.1.1.1.1.3">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E12.m1.68.68.1.68.36.35.35.1.2">​</mo><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1"><munder id="S4.E12.m1.68.68.1.68.36.35.35.1.1.2"><mo movablelimits="false" rspace="0em" id="S4.E12.m1.35.35.35.3.2.2">∑</mo><msub id="S4.E12.m1.36.36.36.4.3.3.1"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.36.36.36.4.3.3.1.2">𝒯</mi><mi id="S4.E12.m1.36.36.36.4.3.3.1.3">k</mi></msub></munder><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1"><mo stretchy="false" id="S4.E12.m1.37.37.37.5.4.4">(</mo><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1"><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.2"><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.1.1"><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.1.1.1"><mi id="S4.E12.m1.38.38.38.6.5.5">p</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.1.1.1.2">​</mo><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S4.E12.m1.39.39.39.7.6.6">(</mo><msubsup id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E12.m1.40.40.40.8.7.7">w</mi><mrow id="S4.E12.m1.42.42.42.10.9.9.1"><mo id="S4.E12.m1.42.42.42.10.9.9.1a">−</mo><mi id="S4.E12.m1.42.42.42.10.9.9.1.2">k</mi></mrow><mi id="S4.E12.m1.41.41.41.9.8.8.1">t</mi></msubsup><mo rspace="0.055em" stretchy="false" id="S4.E12.m1.43.43.43.11.10.10">)</mo></mrow></mrow><mo rspace="0.222em" id="S4.E12.m1.44.44.44.12.11.11">⋅</mo><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.1.1.2"><mi id="S4.E12.m1.45.45.45.13.12.12">log</mi><mo lspace="0.167em" id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.1.1.2a">⁡</mo><mi id="S4.E12.m1.46.46.46.14.13.13">p</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.2.3">​</mo><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.2.2.1"><mo stretchy="false" id="S4.E12.m1.47.47.47.15.14.14">(</mo><msubsup id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.2.2.1.1"><mi id="S4.E12.m1.48.48.48.16.15.15">w</mi><mrow id="S4.E12.m1.50.50.50.18.17.17.1"><mo id="S4.E12.m1.50.50.50.18.17.17.1a">−</mo><mi id="S4.E12.m1.50.50.50.18.17.17.1.2">k</mi></mrow><mi id="S4.E12.m1.49.49.49.17.16.16.1">t</mi></msubsup><mo stretchy="false" id="S4.E12.m1.51.51.51.19.18.18">)</mo></mrow></mrow><mo id="S4.E12.m1.52.52.52.20.19.19">−</mo><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.4"><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.3.1"><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.3.1.1"><mi id="S4.E12.m1.53.53.53.21.20.20">p</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.3.1.1.2">​</mo><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.3.1.1.1.1"><mo stretchy="false" id="S4.E12.m1.54.54.54.22.21.21">(</mo><msubsup id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.3.1.1.1.1.1"><mi id="S4.E12.m1.55.55.55.23.22.22">w</mi><mrow id="S4.E12.m1.57.57.57.25.24.24.1"><mo id="S4.E12.m1.57.57.57.25.24.24.1a">−</mo><mi id="S4.E12.m1.57.57.57.25.24.24.1.2">k</mi></mrow><mi id="S4.E12.m1.56.56.56.24.23.23.1">t</mi></msubsup><mo rspace="0.055em" stretchy="false" id="S4.E12.m1.58.58.58.26.25.25">)</mo></mrow></mrow><mo rspace="0.222em" id="S4.E12.m1.59.59.59.27.26.26">⋅</mo><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.3.1.2"><mi id="S4.E12.m1.60.60.60.28.27.27">log</mi><mo lspace="0.167em" id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.3.1.2a">⁡</mo><mi id="S4.E12.m1.61.61.61.29.28.28">p</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.4.3">​</mo><mrow id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.4.2.1"><mo stretchy="false" id="S4.E12.m1.62.62.62.30.29.29">(</mo><msub id="S4.E12.m1.68.68.1.68.36.35.35.1.1.1.1.1.4.2.1.1"><mi id="S4.E12.m1.63.63.63.31.30.30">w</mi><mi id="S4.E12.m1.64.64.64.32.31.31.1">k</mi></msub><mo stretchy="false" id="S4.E12.m1.65.65.65.33.32.32">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E12.m1.66.66.66.34.33.33">)</mo></mrow></mrow></mrow><mo id="S4.E12.m1.67.67.67.35.34.34">,</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S4.E12.m1.68b">\begin{split}&amp;\mathcal{L}_{k}^{MI}(w^{t}_{-k},w_{k})=\frac{1}{|\mathcal{B}_{k}|}\sum_{\mathcal{T}_{k}}D_{KL}\left(p(w^{t}_{-k})~{}||~{}p(w_{k})\right)\\
=&amp;\frac{1}{|\mathcal{B}_{k}|}\sum_{\mathcal{T}_{k}}(p(w^{t}_{-k})\cdot\log p(w^{t}_{-k})-p(w^{t}_{-k})\cdot\log p(w_{k})),\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS2.p2.8" class="ltx_p">in which <math id="S4.SS1.SSS2.p2.3.m1.1" class="ltx_Math" alttext="p(\cdot)" display="inline"><semantics id="S4.SS1.SSS2.p2.3.m1.1a"><mrow id="S4.SS1.SSS2.p2.3.m1.1.2" xref="S4.SS1.SSS2.p2.3.m1.1.2.cmml"><mi id="S4.SS1.SSS2.p2.3.m1.1.2.2" xref="S4.SS1.SSS2.p2.3.m1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p2.3.m1.1.2.1" xref="S4.SS1.SSS2.p2.3.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS2.p2.3.m1.1.2.3.2" xref="S4.SS1.SSS2.p2.3.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p2.3.m1.1.2.3.2.1" xref="S4.SS1.SSS2.p2.3.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p2.3.m1.1.1" xref="S4.SS1.SSS2.p2.3.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS2.p2.3.m1.1.2.3.2.2" xref="S4.SS1.SSS2.p2.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.3.m1.1b"><apply id="S4.SS1.SSS2.p2.3.m1.1.2.cmml" xref="S4.SS1.SSS2.p2.3.m1.1.2"><times id="S4.SS1.SSS2.p2.3.m1.1.2.1.cmml" xref="S4.SS1.SSS2.p2.3.m1.1.2.1"></times><ci id="S4.SS1.SSS2.p2.3.m1.1.2.2.cmml" xref="S4.SS1.SSS2.p2.3.m1.1.2.2">𝑝</ci><ci id="S4.SS1.SSS2.p2.3.m1.1.1.cmml" xref="S4.SS1.SSS2.p2.3.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.3.m1.1c">p(\cdot)</annotation></semantics></math> is the probability outputs of an FSL model. Given an <math id="S4.SS1.SSS2.p2.4.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS1.SSS2.p2.4.m2.1a"><mi id="S4.SS1.SSS2.p2.4.m2.1.1" xref="S4.SS1.SSS2.p2.4.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.4.m2.1b"><ci id="S4.SS1.SSS2.p2.4.m2.1.1.cmml" xref="S4.SS1.SSS2.p2.4.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.4.m2.1c">N</annotation></semantics></math>-way FSL task <math id="S4.SS1.SSS2.p2.5.m3.1" class="ltx_Math" alttext="\mathcal{T}_{k}" display="inline"><semantics id="S4.SS1.SSS2.p2.5.m3.1a"><msub id="S4.SS1.SSS2.p2.5.m3.1.1" xref="S4.SS1.SSS2.p2.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p2.5.m3.1.1.2" xref="S4.SS1.SSS2.p2.5.m3.1.1.2.cmml">𝒯</mi><mi id="S4.SS1.SSS2.p2.5.m3.1.1.3" xref="S4.SS1.SSS2.p2.5.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.5.m3.1b"><apply id="S4.SS1.SSS2.p2.5.m3.1.1.cmml" xref="S4.SS1.SSS2.p2.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.5.m3.1.1.1.cmml" xref="S4.SS1.SSS2.p2.5.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p2.5.m3.1.1.2.cmml" xref="S4.SS1.SSS2.p2.5.m3.1.1.2">𝒯</ci><ci id="S4.SS1.SSS2.p2.5.m3.1.1.3.cmml" xref="S4.SS1.SSS2.p2.5.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.5.m3.1c">\mathcal{T}_{k}</annotation></semantics></math>, <math id="S4.SS1.SSS2.p2.6.m4.1" class="ltx_Math" alttext="p(w)" display="inline"><semantics id="S4.SS1.SSS2.p2.6.m4.1a"><mrow id="S4.SS1.SSS2.p2.6.m4.1.2" xref="S4.SS1.SSS2.p2.6.m4.1.2.cmml"><mi id="S4.SS1.SSS2.p2.6.m4.1.2.2" xref="S4.SS1.SSS2.p2.6.m4.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p2.6.m4.1.2.1" xref="S4.SS1.SSS2.p2.6.m4.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS2.p2.6.m4.1.2.3.2" xref="S4.SS1.SSS2.p2.6.m4.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p2.6.m4.1.2.3.2.1" xref="S4.SS1.SSS2.p2.6.m4.1.2.cmml">(</mo><mi id="S4.SS1.SSS2.p2.6.m4.1.1" xref="S4.SS1.SSS2.p2.6.m4.1.1.cmml">w</mi><mo stretchy="false" id="S4.SS1.SSS2.p2.6.m4.1.2.3.2.2" xref="S4.SS1.SSS2.p2.6.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.6.m4.1b"><apply id="S4.SS1.SSS2.p2.6.m4.1.2.cmml" xref="S4.SS1.SSS2.p2.6.m4.1.2"><times id="S4.SS1.SSS2.p2.6.m4.1.2.1.cmml" xref="S4.SS1.SSS2.p2.6.m4.1.2.1"></times><ci id="S4.SS1.SSS2.p2.6.m4.1.2.2.cmml" xref="S4.SS1.SSS2.p2.6.m4.1.2.2">𝑝</ci><ci id="S4.SS1.SSS2.p2.6.m4.1.1.cmml" xref="S4.SS1.SSS2.p2.6.m4.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.6.m4.1c">p(w)</annotation></semantics></math> is the normalized <math id="S4.SS1.SSS2.p2.7.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS1.SSS2.p2.7.m5.1a"><mi id="S4.SS1.SSS2.p2.7.m5.1.1" xref="S4.SS1.SSS2.p2.7.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.7.m5.1b"><ci id="S4.SS1.SSS2.p2.7.m5.1.1.cmml" xref="S4.SS1.SSS2.p2.7.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.7.m5.1c">N</annotation></semantics></math>-way predictions over <math id="S4.SS1.SSS2.p2.8.m6.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS1.SSS2.p2.8.m6.1a"><mi id="S4.SS1.SSS2.p2.8.m6.1.1" xref="S4.SS1.SSS2.p2.8.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.8.m6.1b"><ci id="S4.SS1.SSS2.p2.8.m6.1.1.cmml" xref="S4.SS1.SSS2.p2.8.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.8.m6.1c">N</annotation></semantics></math> classes that sums to one. We aim to minimize MI in order to reduce the discrepancy.</p>
</div>
<div id="S4.SS1.SSS2.p3" class="ltx_para">
<p id="S4.SS1.SSS2.p3.2" class="ltx_p">By integrating MI into the original local FedFSL objective function (<a href="#S3.E7" title="In 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>),
our new target is to jointly minimize the MI loss together with the local FSL task loss such that</p>
<table id="S4.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E13.m1.27" class="ltx_Math" alttext="\begin{split}&amp;w^{*,t}_{k}=\underset{w_{k}}{\text{min}}\ \mathcal{L}_{k}(w_{k})+\gamma\mathcal{L}_{k}^{MI}(w^{t}_{\text{-}k},w_{k}),\end{split}" display="block"><semantics id="S4.E13.m1.27a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E13.m1.27.27.2"><mtr id="S4.E13.m1.27.27.2a"><mtd id="S4.E13.m1.27.27.2b" xref="S4.E13.m1.26.26.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E13.m1.27.27.2c"><mrow id="S4.E13.m1.27.27.2.26.26.26.26"><mrow id="S4.E13.m1.27.27.2.26.26.26.26.1"><msubsup id="S4.E13.m1.27.27.2.26.26.26.26.1.4"><mi id="S4.E13.m1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml">w</mi><mi id="S4.E13.m1.3.3.3.3.3.3.1" xref="S4.E13.m1.3.3.3.3.3.3.1.cmml">k</mi><mrow id="S4.E13.m1.2.2.2.2.2.2.1.4" xref="S4.E13.m1.2.2.2.2.2.2.1.3.cmml"><mo rspace="0em" id="S4.E13.m1.2.2.2.2.2.2.1.1" xref="S4.E13.m1.2.2.2.2.2.2.1.1.cmml">∗</mo><mo id="S4.E13.m1.2.2.2.2.2.2.1.4.1" xref="S4.E13.m1.2.2.2.2.2.2.1.3.cmml">,</mo><mi id="S4.E13.m1.2.2.2.2.2.2.1.2" xref="S4.E13.m1.2.2.2.2.2.2.1.2.cmml">t</mi></mrow></msubsup><mo id="S4.E13.m1.4.4.4.4.4.4" xref="S4.E13.m1.4.4.4.4.4.4.cmml">=</mo><mrow id="S4.E13.m1.27.27.2.26.26.26.26.1.3"><mrow id="S4.E13.m1.27.27.2.26.26.26.26.1.1.1"><munder accentunder="true" id="S4.E13.m1.5.5.5.5.5.5" xref="S4.E13.m1.5.5.5.5.5.5.cmml"><mtext id="S4.E13.m1.5.5.5.5.5.5.2" xref="S4.E13.m1.5.5.5.5.5.5.2a.cmml">min</mtext><msub id="S4.E13.m1.5.5.5.5.5.5.1" xref="S4.E13.m1.5.5.5.5.5.5.1.cmml"><mi id="S4.E13.m1.5.5.5.5.5.5.1.2" xref="S4.E13.m1.5.5.5.5.5.5.1.2.cmml">w</mi><mi id="S4.E13.m1.5.5.5.5.5.5.1.3" xref="S4.E13.m1.5.5.5.5.5.5.1.3.cmml">k</mi></msub></munder><mo lspace="0em" rspace="0em" id="S4.E13.m1.27.27.2.26.26.26.26.1.1.1.2" xref="S4.E13.m1.26.26.1.1.1.cmml">​</mo><msub id="S4.E13.m1.27.27.2.26.26.26.26.1.1.1.3"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.6.6.6.6.6.6" xref="S4.E13.m1.6.6.6.6.6.6.cmml">ℒ</mi><mi id="S4.E13.m1.7.7.7.7.7.7.1" xref="S4.E13.m1.7.7.7.7.7.7.1.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E13.m1.27.27.2.26.26.26.26.1.1.1.2a" xref="S4.E13.m1.26.26.1.1.1.cmml">​</mo><mrow id="S4.E13.m1.27.27.2.26.26.26.26.1.1.1.1.1"><mo stretchy="false" id="S4.E13.m1.8.8.8.8.8.8" xref="S4.E13.m1.26.26.1.1.1.cmml">(</mo><msub id="S4.E13.m1.27.27.2.26.26.26.26.1.1.1.1.1.1"><mi id="S4.E13.m1.9.9.9.9.9.9" xref="S4.E13.m1.9.9.9.9.9.9.cmml">w</mi><mi id="S4.E13.m1.10.10.10.10.10.10.1" xref="S4.E13.m1.10.10.10.10.10.10.1.cmml">k</mi></msub><mo stretchy="false" id="S4.E13.m1.11.11.11.11.11.11" xref="S4.E13.m1.26.26.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.12.12.12.12.12.12" xref="S4.E13.m1.12.12.12.12.12.12.cmml">+</mo><mrow id="S4.E13.m1.27.27.2.26.26.26.26.1.3.3"><mi id="S4.E13.m1.13.13.13.13.13.13" xref="S4.E13.m1.13.13.13.13.13.13.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.27.27.2.26.26.26.26.1.3.3.3" xref="S4.E13.m1.26.26.1.1.1.cmml">​</mo><msubsup id="S4.E13.m1.27.27.2.26.26.26.26.1.3.3.4"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.14.14.14.14.14.14" xref="S4.E13.m1.14.14.14.14.14.14.cmml">ℒ</mi><mi id="S4.E13.m1.15.15.15.15.15.15.1" xref="S4.E13.m1.15.15.15.15.15.15.1.cmml">k</mi><mrow id="S4.E13.m1.16.16.16.16.16.16.1" xref="S4.E13.m1.16.16.16.16.16.16.1.cmml"><mi id="S4.E13.m1.16.16.16.16.16.16.1.2" xref="S4.E13.m1.16.16.16.16.16.16.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.16.16.16.16.16.16.1.1" xref="S4.E13.m1.16.16.16.16.16.16.1.1.cmml">​</mo><mi id="S4.E13.m1.16.16.16.16.16.16.1.3" xref="S4.E13.m1.16.16.16.16.16.16.1.3.cmml">I</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E13.m1.27.27.2.26.26.26.26.1.3.3.3a" xref="S4.E13.m1.26.26.1.1.1.cmml">​</mo><mrow id="S4.E13.m1.27.27.2.26.26.26.26.1.3.3.2.2"><mo stretchy="false" id="S4.E13.m1.17.17.17.17.17.17" xref="S4.E13.m1.26.26.1.1.1.cmml">(</mo><msubsup id="S4.E13.m1.27.27.2.26.26.26.26.1.2.2.1.1.1"><mi id="S4.E13.m1.18.18.18.18.18.18" xref="S4.E13.m1.18.18.18.18.18.18.cmml">w</mi><mrow id="S4.E13.m1.20.20.20.20.20.20.1" xref="S4.E13.m1.20.20.20.20.20.20.1.cmml"><mtext id="S4.E13.m1.20.20.20.20.20.20.1.2" xref="S4.E13.m1.20.20.20.20.20.20.1.2a.cmml">-</mtext><mo lspace="0em" rspace="0em" id="S4.E13.m1.20.20.20.20.20.20.1.1" xref="S4.E13.m1.20.20.20.20.20.20.1.1.cmml">​</mo><mi id="S4.E13.m1.20.20.20.20.20.20.1.3" xref="S4.E13.m1.20.20.20.20.20.20.1.3.cmml">k</mi></mrow><mi id="S4.E13.m1.19.19.19.19.19.19.1" xref="S4.E13.m1.19.19.19.19.19.19.1.cmml">t</mi></msubsup><mo id="S4.E13.m1.21.21.21.21.21.21" xref="S4.E13.m1.26.26.1.1.1.cmml">,</mo><msub id="S4.E13.m1.27.27.2.26.26.26.26.1.3.3.2.2.2"><mi id="S4.E13.m1.22.22.22.22.22.22" xref="S4.E13.m1.22.22.22.22.22.22.cmml">w</mi><mi id="S4.E13.m1.23.23.23.23.23.23.1" xref="S4.E13.m1.23.23.23.23.23.23.1.cmml">k</mi></msub><mo stretchy="false" id="S4.E13.m1.24.24.24.24.24.24" xref="S4.E13.m1.26.26.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E13.m1.25.25.25.25.25.25" xref="S4.E13.m1.26.26.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E13.m1.27b"><apply id="S4.E13.m1.26.26.1.1.1.cmml" xref="S4.E13.m1.27.27.2b"><eq id="S4.E13.m1.4.4.4.4.4.4.cmml" xref="S4.E13.m1.4.4.4.4.4.4"></eq><apply id="S4.E13.m1.26.26.1.1.1.5.cmml" xref="S4.E13.m1.27.27.2b"><csymbol cd="ambiguous" id="S4.E13.m1.26.26.1.1.1.5.1.cmml" xref="S4.E13.m1.27.27.2b">subscript</csymbol><apply id="S4.E13.m1.26.26.1.1.1.5.2.cmml" xref="S4.E13.m1.27.27.2b"><csymbol cd="ambiguous" id="S4.E13.m1.26.26.1.1.1.5.2.1.cmml" xref="S4.E13.m1.27.27.2b">superscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1">𝑤</ci><list id="S4.E13.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E13.m1.2.2.2.2.2.2.1.4"><times id="S4.E13.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E13.m1.2.2.2.2.2.2.1.1"></times><ci id="S4.E13.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E13.m1.2.2.2.2.2.2.1.2">𝑡</ci></list></apply><ci id="S4.E13.m1.3.3.3.3.3.3.1.cmml" xref="S4.E13.m1.3.3.3.3.3.3.1">𝑘</ci></apply><apply id="S4.E13.m1.26.26.1.1.1.3.cmml" xref="S4.E13.m1.27.27.2b"><plus id="S4.E13.m1.12.12.12.12.12.12.cmml" xref="S4.E13.m1.12.12.12.12.12.12"></plus><apply id="S4.E13.m1.26.26.1.1.1.1.1.cmml" xref="S4.E13.m1.27.27.2b"><times id="S4.E13.m1.26.26.1.1.1.1.1.2.cmml" xref="S4.E13.m1.27.27.2b"></times><apply id="S4.E13.m1.5.5.5.5.5.5.cmml" xref="S4.E13.m1.5.5.5.5.5.5"><apply id="S4.E13.m1.5.5.5.5.5.5.1.cmml" xref="S4.E13.m1.5.5.5.5.5.5.1"><csymbol cd="ambiguous" id="S4.E13.m1.5.5.5.5.5.5.1.1.cmml" xref="S4.E13.m1.5.5.5.5.5.5.1">subscript</csymbol><ci id="S4.E13.m1.5.5.5.5.5.5.1.2.cmml" xref="S4.E13.m1.5.5.5.5.5.5.1.2">𝑤</ci><ci id="S4.E13.m1.5.5.5.5.5.5.1.3.cmml" xref="S4.E13.m1.5.5.5.5.5.5.1.3">𝑘</ci></apply><ci id="S4.E13.m1.5.5.5.5.5.5.2a.cmml" xref="S4.E13.m1.5.5.5.5.5.5.2"><mtext id="S4.E13.m1.5.5.5.5.5.5.2.cmml" xref="S4.E13.m1.5.5.5.5.5.5.2">min</mtext></ci></apply><apply id="S4.E13.m1.26.26.1.1.1.1.1.4.cmml" xref="S4.E13.m1.27.27.2b"><csymbol cd="ambiguous" id="S4.E13.m1.26.26.1.1.1.1.1.4.1.cmml" xref="S4.E13.m1.27.27.2b">subscript</csymbol><ci id="S4.E13.m1.6.6.6.6.6.6.cmml" xref="S4.E13.m1.6.6.6.6.6.6">ℒ</ci><ci id="S4.E13.m1.7.7.7.7.7.7.1.cmml" xref="S4.E13.m1.7.7.7.7.7.7.1">𝑘</ci></apply><apply id="S4.E13.m1.26.26.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.27.27.2b"><csymbol cd="ambiguous" id="S4.E13.m1.26.26.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.27.27.2b">subscript</csymbol><ci id="S4.E13.m1.9.9.9.9.9.9.cmml" xref="S4.E13.m1.9.9.9.9.9.9">𝑤</ci><ci id="S4.E13.m1.10.10.10.10.10.10.1.cmml" xref="S4.E13.m1.10.10.10.10.10.10.1">𝑘</ci></apply></apply><apply id="S4.E13.m1.26.26.1.1.1.3.3.cmml" xref="S4.E13.m1.27.27.2b"><times id="S4.E13.m1.26.26.1.1.1.3.3.3.cmml" xref="S4.E13.m1.27.27.2b"></times><ci id="S4.E13.m1.13.13.13.13.13.13.cmml" xref="S4.E13.m1.13.13.13.13.13.13">𝛾</ci><apply id="S4.E13.m1.26.26.1.1.1.3.3.5.cmml" xref="S4.E13.m1.27.27.2b"><csymbol cd="ambiguous" id="S4.E13.m1.26.26.1.1.1.3.3.5.1.cmml" xref="S4.E13.m1.27.27.2b">superscript</csymbol><apply id="S4.E13.m1.26.26.1.1.1.3.3.5.2.cmml" xref="S4.E13.m1.27.27.2b"><csymbol cd="ambiguous" id="S4.E13.m1.26.26.1.1.1.3.3.5.2.1.cmml" xref="S4.E13.m1.27.27.2b">subscript</csymbol><ci id="S4.E13.m1.14.14.14.14.14.14.cmml" xref="S4.E13.m1.14.14.14.14.14.14">ℒ</ci><ci id="S4.E13.m1.15.15.15.15.15.15.1.cmml" xref="S4.E13.m1.15.15.15.15.15.15.1">𝑘</ci></apply><apply id="S4.E13.m1.16.16.16.16.16.16.1.cmml" xref="S4.E13.m1.16.16.16.16.16.16.1"><times id="S4.E13.m1.16.16.16.16.16.16.1.1.cmml" xref="S4.E13.m1.16.16.16.16.16.16.1.1"></times><ci id="S4.E13.m1.16.16.16.16.16.16.1.2.cmml" xref="S4.E13.m1.16.16.16.16.16.16.1.2">𝑀</ci><ci id="S4.E13.m1.16.16.16.16.16.16.1.3.cmml" xref="S4.E13.m1.16.16.16.16.16.16.1.3">𝐼</ci></apply></apply><interval closure="open" id="S4.E13.m1.26.26.1.1.1.3.3.2.3.cmml" xref="S4.E13.m1.27.27.2b"><apply id="S4.E13.m1.26.26.1.1.1.2.2.1.1.1.cmml" xref="S4.E13.m1.27.27.2b"><csymbol cd="ambiguous" id="S4.E13.m1.26.26.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E13.m1.27.27.2b">subscript</csymbol><apply id="S4.E13.m1.26.26.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E13.m1.27.27.2b"><csymbol cd="ambiguous" id="S4.E13.m1.26.26.1.1.1.2.2.1.1.1.2.1.cmml" xref="S4.E13.m1.27.27.2b">superscript</csymbol><ci id="S4.E13.m1.18.18.18.18.18.18.cmml" xref="S4.E13.m1.18.18.18.18.18.18">𝑤</ci><ci id="S4.E13.m1.19.19.19.19.19.19.1.cmml" xref="S4.E13.m1.19.19.19.19.19.19.1">𝑡</ci></apply><apply id="S4.E13.m1.20.20.20.20.20.20.1.cmml" xref="S4.E13.m1.20.20.20.20.20.20.1"><times id="S4.E13.m1.20.20.20.20.20.20.1.1.cmml" xref="S4.E13.m1.20.20.20.20.20.20.1.1"></times><ci id="S4.E13.m1.20.20.20.20.20.20.1.2a.cmml" xref="S4.E13.m1.20.20.20.20.20.20.1.2"><mtext mathsize="70%" id="S4.E13.m1.20.20.20.20.20.20.1.2.cmml" xref="S4.E13.m1.20.20.20.20.20.20.1.2">-</mtext></ci><ci id="S4.E13.m1.20.20.20.20.20.20.1.3.cmml" xref="S4.E13.m1.20.20.20.20.20.20.1.3">𝑘</ci></apply></apply><apply id="S4.E13.m1.26.26.1.1.1.3.3.2.2.2.cmml" xref="S4.E13.m1.27.27.2b"><csymbol cd="ambiguous" id="S4.E13.m1.26.26.1.1.1.3.3.2.2.2.1.cmml" xref="S4.E13.m1.27.27.2b">subscript</csymbol><ci id="S4.E13.m1.22.22.22.22.22.22.cmml" xref="S4.E13.m1.22.22.22.22.22.22">𝑤</ci><ci id="S4.E13.m1.23.23.23.23.23.23.1.cmml" xref="S4.E13.m1.23.23.23.23.23.23.1">𝑘</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.27c">\begin{split}&amp;w^{*,t}_{k}=\underset{w_{k}}{\text{min}}\ \mathcal{L}_{k}(w_{k})+\gamma\mathcal{L}_{k}^{MI}(w^{t}_{\text{-}k},w_{k}),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS2.p3.1" class="ltx_p">in which the weight <math id="S4.SS1.SSS2.p3.1.m1.1" class="ltx_Math" alttext="\gamma&gt;0" display="inline"><semantics id="S4.SS1.SSS2.p3.1.m1.1a"><mrow id="S4.SS1.SSS2.p3.1.m1.1.1" xref="S4.SS1.SSS2.p3.1.m1.1.1.cmml"><mi id="S4.SS1.SSS2.p3.1.m1.1.1.2" xref="S4.SS1.SSS2.p3.1.m1.1.1.2.cmml">γ</mi><mo id="S4.SS1.SSS2.p3.1.m1.1.1.1" xref="S4.SS1.SSS2.p3.1.m1.1.1.1.cmml">&gt;</mo><mn id="S4.SS1.SSS2.p3.1.m1.1.1.3" xref="S4.SS1.SSS2.p3.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.1.m1.1b"><apply id="S4.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1"><gt id="S4.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.1"></gt><ci id="S4.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.2">𝛾</ci><cn type="integer" id="S4.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.1.m1.1c">\gamma&gt;0</annotation></semantics></math> can be searched by cross-validation. We call this new method <span id="S4.SS1.SSS2.p3.1.1" class="ltx_text ltx_font_bold">FedFSL-MI</span> (FedFSL with Mutual Information regularization).</p>
</div>
<div id="S4.SS1.SSS2.p4" class="ltx_para">
<p id="S4.SS1.SSS2.p4.7" class="ltx_p">As the k-exclusive global model is different from client to client, the central server needs to compute the global model <math id="S4.SS1.SSS2.p4.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS1.SSS2.p4.1.m1.1a"><mi id="S4.SS1.SSS2.p4.1.m1.1.1" xref="S4.SS1.SSS2.p4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p4.1.m1.1b"><ci id="S4.SS1.SSS2.p4.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p4.1.m1.1c">K</annotation></semantics></math> times.
In practice, when <math id="S4.SS1.SSS2.p4.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS1.SSS2.p4.2.m2.1a"><mi id="S4.SS1.SSS2.p4.2.m2.1.1" xref="S4.SS1.SSS2.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p4.2.m2.1b"><ci id="S4.SS1.SSS2.p4.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p4.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p4.2.m2.1c">K</annotation></semantics></math> is large (e.g., <math id="S4.SS1.SSS2.p4.3.m3.1" class="ltx_Math" alttext="\geq" display="inline"><semantics id="S4.SS1.SSS2.p4.3.m3.1a"><mo id="S4.SS1.SSS2.p4.3.m3.1.1" xref="S4.SS1.SSS2.p4.3.m3.1.1.cmml">≥</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p4.3.m3.1b"><geq id="S4.SS1.SSS2.p4.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p4.3.m3.1.1"></geq></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p4.3.m3.1c">\geq</annotation></semantics></math>10), we can conveniently reuse the aggregated central model <math id="S4.SS1.SSS2.p4.4.m4.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="S4.SS1.SSS2.p4.4.m4.1a"><msup id="S4.SS1.SSS2.p4.4.m4.1.1" xref="S4.SS1.SSS2.p4.4.m4.1.1.cmml"><mi id="S4.SS1.SSS2.p4.4.m4.1.1.2" xref="S4.SS1.SSS2.p4.4.m4.1.1.2.cmml">w</mi><mi id="S4.SS1.SSS2.p4.4.m4.1.1.3" xref="S4.SS1.SSS2.p4.4.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p4.4.m4.1b"><apply id="S4.SS1.SSS2.p4.4.m4.1.1.cmml" xref="S4.SS1.SSS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p4.4.m4.1.1.1.cmml" xref="S4.SS1.SSS2.p4.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.SSS2.p4.4.m4.1.1.2.cmml" xref="S4.SS1.SSS2.p4.4.m4.1.1.2">𝑤</ci><ci id="S4.SS1.SSS2.p4.4.m4.1.1.3.cmml" xref="S4.SS1.SSS2.p4.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p4.4.m4.1c">w^{t}</annotation></semantics></math> as in (<a href="#S3.E10" title="In 2nd item ‣ 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) to
approximate <math id="S4.SS1.SSS2.p4.5.m5.1" class="ltx_Math" alttext="w^{t}_{\text{-}k}" display="inline"><semantics id="S4.SS1.SSS2.p4.5.m5.1a"><msubsup id="S4.SS1.SSS2.p4.5.m5.1.1" xref="S4.SS1.SSS2.p4.5.m5.1.1.cmml"><mi id="S4.SS1.SSS2.p4.5.m5.1.1.2.2" xref="S4.SS1.SSS2.p4.5.m5.1.1.2.2.cmml">w</mi><mrow id="S4.SS1.SSS2.p4.5.m5.1.1.3" xref="S4.SS1.SSS2.p4.5.m5.1.1.3.cmml"><mtext id="S4.SS1.SSS2.p4.5.m5.1.1.3.2" xref="S4.SS1.SSS2.p4.5.m5.1.1.3.2a.cmml">-</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p4.5.m5.1.1.3.1" xref="S4.SS1.SSS2.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS2.p4.5.m5.1.1.3.3" xref="S4.SS1.SSS2.p4.5.m5.1.1.3.3.cmml">k</mi></mrow><mi id="S4.SS1.SSS2.p4.5.m5.1.1.2.3" xref="S4.SS1.SSS2.p4.5.m5.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p4.5.m5.1b"><apply id="S4.SS1.SSS2.p4.5.m5.1.1.cmml" xref="S4.SS1.SSS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p4.5.m5.1.1.1.cmml" xref="S4.SS1.SSS2.p4.5.m5.1.1">subscript</csymbol><apply id="S4.SS1.SSS2.p4.5.m5.1.1.2.cmml" xref="S4.SS1.SSS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p4.5.m5.1.1.2.1.cmml" xref="S4.SS1.SSS2.p4.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.SSS2.p4.5.m5.1.1.2.2.cmml" xref="S4.SS1.SSS2.p4.5.m5.1.1.2.2">𝑤</ci><ci id="S4.SS1.SSS2.p4.5.m5.1.1.2.3.cmml" xref="S4.SS1.SSS2.p4.5.m5.1.1.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS2.p4.5.m5.1.1.3.cmml" xref="S4.SS1.SSS2.p4.5.m5.1.1.3"><times id="S4.SS1.SSS2.p4.5.m5.1.1.3.1.cmml" xref="S4.SS1.SSS2.p4.5.m5.1.1.3.1"></times><ci id="S4.SS1.SSS2.p4.5.m5.1.1.3.2a.cmml" xref="S4.SS1.SSS2.p4.5.m5.1.1.3.2"><mtext mathsize="70%" id="S4.SS1.SSS2.p4.5.m5.1.1.3.2.cmml" xref="S4.SS1.SSS2.p4.5.m5.1.1.3.2">-</mtext></ci><ci id="S4.SS1.SSS2.p4.5.m5.1.1.3.3.cmml" xref="S4.SS1.SSS2.p4.5.m5.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p4.5.m5.1c">w^{t}_{\text{-}k}</annotation></semantics></math>, leading to no additional computation cost. We will default to use <math id="S4.SS1.SSS2.p4.6.m6.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="S4.SS1.SSS2.p4.6.m6.1a"><msup id="S4.SS1.SSS2.p4.6.m6.1.1" xref="S4.SS1.SSS2.p4.6.m6.1.1.cmml"><mi id="S4.SS1.SSS2.p4.6.m6.1.1.2" xref="S4.SS1.SSS2.p4.6.m6.1.1.2.cmml">w</mi><mi id="S4.SS1.SSS2.p4.6.m6.1.1.3" xref="S4.SS1.SSS2.p4.6.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p4.6.m6.1b"><apply id="S4.SS1.SSS2.p4.6.m6.1.1.cmml" xref="S4.SS1.SSS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p4.6.m6.1.1.1.cmml" xref="S4.SS1.SSS2.p4.6.m6.1.1">superscript</csymbol><ci id="S4.SS1.SSS2.p4.6.m6.1.1.2.cmml" xref="S4.SS1.SSS2.p4.6.m6.1.1.2">𝑤</ci><ci id="S4.SS1.SSS2.p4.6.m6.1.1.3.cmml" xref="S4.SS1.SSS2.p4.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p4.6.m6.1c">w^{t}</annotation></semantics></math> to approximate <math id="S4.SS1.SSS2.p4.7.m7.1" class="ltx_Math" alttext="w^{t}_{\text{-}k}" display="inline"><semantics id="S4.SS1.SSS2.p4.7.m7.1a"><msubsup id="S4.SS1.SSS2.p4.7.m7.1.1" xref="S4.SS1.SSS2.p4.7.m7.1.1.cmml"><mi id="S4.SS1.SSS2.p4.7.m7.1.1.2.2" xref="S4.SS1.SSS2.p4.7.m7.1.1.2.2.cmml">w</mi><mrow id="S4.SS1.SSS2.p4.7.m7.1.1.3" xref="S4.SS1.SSS2.p4.7.m7.1.1.3.cmml"><mtext id="S4.SS1.SSS2.p4.7.m7.1.1.3.2" xref="S4.SS1.SSS2.p4.7.m7.1.1.3.2a.cmml">-</mtext><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p4.7.m7.1.1.3.1" xref="S4.SS1.SSS2.p4.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS2.p4.7.m7.1.1.3.3" xref="S4.SS1.SSS2.p4.7.m7.1.1.3.3.cmml">k</mi></mrow><mi id="S4.SS1.SSS2.p4.7.m7.1.1.2.3" xref="S4.SS1.SSS2.p4.7.m7.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p4.7.m7.1b"><apply id="S4.SS1.SSS2.p4.7.m7.1.1.cmml" xref="S4.SS1.SSS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p4.7.m7.1.1.1.cmml" xref="S4.SS1.SSS2.p4.7.m7.1.1">subscript</csymbol><apply id="S4.SS1.SSS2.p4.7.m7.1.1.2.cmml" xref="S4.SS1.SSS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p4.7.m7.1.1.2.1.cmml" xref="S4.SS1.SSS2.p4.7.m7.1.1">superscript</csymbol><ci id="S4.SS1.SSS2.p4.7.m7.1.1.2.2.cmml" xref="S4.SS1.SSS2.p4.7.m7.1.1.2.2">𝑤</ci><ci id="S4.SS1.SSS2.p4.7.m7.1.1.2.3.cmml" xref="S4.SS1.SSS2.p4.7.m7.1.1.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS2.p4.7.m7.1.1.3.cmml" xref="S4.SS1.SSS2.p4.7.m7.1.1.3"><times id="S4.SS1.SSS2.p4.7.m7.1.1.3.1.cmml" xref="S4.SS1.SSS2.p4.7.m7.1.1.3.1"></times><ci id="S4.SS1.SSS2.p4.7.m7.1.1.3.2a.cmml" xref="S4.SS1.SSS2.p4.7.m7.1.1.3.2"><mtext mathsize="70%" id="S4.SS1.SSS2.p4.7.m7.1.1.3.2.cmml" xref="S4.SS1.SSS2.p4.7.m7.1.1.3.2">-</mtext></ci><ci id="S4.SS1.SSS2.p4.7.m7.1.1.3.3.cmml" xref="S4.SS1.SSS2.p4.7.m7.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p4.7.m7.1c">w^{t}_{\text{-}k}</annotation></semantics></math> in our experiments to reduce computations in simulated mobile devices, and we will compare them in Sec.<a href="#S5.SS4.SSS4" title="5.4.4. Mutual information with 𝑘-exclusive global model ‣ 5.4. Results on benchmark datasets ‣ 5. Experiments and Discussions ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4.4</span></a>.</p>
</div>
<div id="S4.SS1.SSS2.p5" class="ltx_para">
<p id="S4.SS1.SSS2.p5.1" class="ltx_p">We illustrate the intuition of using MI in Figure <a href="#S4.F4" title="Figure 4 ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(b). As we minimize the discrepancy among client models, we encourage the decision boundaries to be consistent across the clients. Thus the federated model could produce a better aligned decision boundary. In the empirical study, we will show that it leads to a significant improvement over FedFSL-naive.
However, the decision boundaries could become complex due to the consistency constraint (Figure <a href="#S4.F4" title="Figure 4 ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(b) right), which we will discuss in next section.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Improving feature space with adversarial learning</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">One technical disadvantage of FedFSL-MI is that constraining the decision boundaries to be similar over clients would develop a complex classifier that overfits to training tasks.
However, the classes of testing data for FSL are different from the base classes of training data, which makes the complex decision boundary not useful to unseen tasks. This also presents a key difference between FSL and conventional supervised learning.</p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1. </span>Feature space</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p">We aim to improve the FedFSL-MI by learning a central model that can produce a better-aligned decision boundary for unseen tasks.
Recent studies of metric learning <cite class="ltx_cite ltx_citemacro_citep">(Schroff
et al<span class="ltx_text">.</span>, <a href="#bib.bib31" title="" class="ltx_ref">2015</a>; Gidaris and
Komodakis, <a href="#bib.bib10" title="" class="ltx_ref">2018</a>)</cite> have shown that learning a good feature space is beneficial to various tasks as it provides good
representations (also known as features or feature embeddings) for data samples. In an ideal feature space, samples of the same class or similar classes are close to each other, while samples of different classes are far away. For example, images of cats and tigers are close in feature space, while tigers and wolves could be far away due to their distinct visual features.</p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para">
<p id="S4.SS2.SSS1.p2.1" class="ltx_p">Researchers have also found that a representative feature space is a kind of transferable knowledge that can be used to learn unseen data samples. For example, pre-trained vision recognition models (i.e., ResNet) <cite class="ltx_cite ltx_citemacro_citep">(Sharif Razavian et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2014</a>; Ren
et al<span class="ltx_text">.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite> and language models (i.e. BERT) <cite class="ltx_cite ltx_citemacro_citep">(Pennington
et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2014</a>; Vaswani et al<span class="ltx_text">.</span>, <a href="#bib.bib38" title="" class="ltx_ref">2017</a>)</cite> can produce off-the-shelf image/language representations for various tasks. Few-shot classification, as we consider in this paper, will especially benefit from a discriminative and transferable feature space if such a feature space can be derived properly and efficiently in distributed scenarios. We will show it is feasible in next sections.</p>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2. </span>Learn a consistent feature space</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p">To our best knowledge, how to learn a consistent and discriminative feature space with FedL has never been studied before.
The difficulty is how to construct a consistent feature space over many clients without sharing data.
Motivated by recent progress in Generative Adversarial Networks (GANs) <cite class="ltx_cite ltx_citemacro_citep">(Goodfellow et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2014</a>; Saito
et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2018</a>)</cite>, we will decompose an FSL model as a feature generator and a classifier (i.e., discriminator) which can be optimized in an alternative and iterative fashion.
This new adversarial learning approach is named as <span id="S4.SS2.SSS2.p1.1.1" class="ltx_text ltx_font_bold">FedFSL-MI-Adv</span> (FedFSL with Mutual Information regularization and Adversarial learning).</p>
</div>
<div id="S4.SS2.SSS2.p2" class="ltx_para">
<p id="S4.SS2.SSS2.p2.8" class="ltx_p">We first introduce some new notations to facilitate discussion.
Without loss of generality, a few-shot classification model can be represented as a feature generator <math id="S4.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S4.SS2.SSS2.p2.1.m1.1a"><mi mathvariant="normal" id="S4.SS2.SSS2.p2.1.m1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.1.m1.1b"><ci id="S4.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.1.m1.1c">\Theta</annotation></semantics></math> and a classifier <math id="S4.SS2.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.SS2.SSS2.p2.2.m2.1a"><mi id="S4.SS2.SSS2.p2.2.m2.1.1" xref="S4.SS2.SSS2.p2.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.2.m2.1b"><ci id="S4.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.2.m2.1c">\theta</annotation></semantics></math>. For a given data sample <math id="S4.SS2.SSS2.p2.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS2.SSS2.p2.3.m3.1a"><mi id="S4.SS2.SSS2.p2.3.m3.1.1" xref="S4.SS2.SSS2.p2.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.3.m3.1b"><ci id="S4.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p2.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.3.m3.1c">x</annotation></semantics></math>, we denote its generated feature as <math id="S4.SS2.SSS2.p2.4.m4.1" class="ltx_Math" alttext="f_{\Theta}(x)" display="inline"><semantics id="S4.SS2.SSS2.p2.4.m4.1a"><mrow id="S4.SS2.SSS2.p2.4.m4.1.2" xref="S4.SS2.SSS2.p2.4.m4.1.2.cmml"><msub id="S4.SS2.SSS2.p2.4.m4.1.2.2" xref="S4.SS2.SSS2.p2.4.m4.1.2.2.cmml"><mi id="S4.SS2.SSS2.p2.4.m4.1.2.2.2" xref="S4.SS2.SSS2.p2.4.m4.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S4.SS2.SSS2.p2.4.m4.1.2.2.3" xref="S4.SS2.SSS2.p2.4.m4.1.2.2.3.cmml">Θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p2.4.m4.1.2.1" xref="S4.SS2.SSS2.p2.4.m4.1.2.1.cmml">​</mo><mrow id="S4.SS2.SSS2.p2.4.m4.1.2.3.2" xref="S4.SS2.SSS2.p2.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p2.4.m4.1.2.3.2.1" xref="S4.SS2.SSS2.p2.4.m4.1.2.cmml">(</mo><mi id="S4.SS2.SSS2.p2.4.m4.1.1" xref="S4.SS2.SSS2.p2.4.m4.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS2.SSS2.p2.4.m4.1.2.3.2.2" xref="S4.SS2.SSS2.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.4.m4.1b"><apply id="S4.SS2.SSS2.p2.4.m4.1.2.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.2"><times id="S4.SS2.SSS2.p2.4.m4.1.2.1.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.2.1"></times><apply id="S4.SS2.SSS2.p2.4.m4.1.2.2.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.4.m4.1.2.2.1.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS2.p2.4.m4.1.2.2.2.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.2.2.2">𝑓</ci><ci id="S4.SS2.SSS2.p2.4.m4.1.2.2.3.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.2.2.3">Θ</ci></apply><ci id="S4.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p2.4.m4.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.4.m4.1c">f_{\Theta}(x)</annotation></semantics></math>. The output logits of the classification model is derived by applying the classifier on the feature such that <math id="S4.SS2.SSS2.p2.5.m5.1" class="ltx_Math" alttext="f_{\theta}\circ f_{\Theta}(x)" display="inline"><semantics id="S4.SS2.SSS2.p2.5.m5.1a"><mrow id="S4.SS2.SSS2.p2.5.m5.1.2" xref="S4.SS2.SSS2.p2.5.m5.1.2.cmml"><mrow id="S4.SS2.SSS2.p2.5.m5.1.2.2" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.cmml"><msub id="S4.SS2.SSS2.p2.5.m5.1.2.2.2" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.2.cmml"><mi id="S4.SS2.SSS2.p2.5.m5.1.2.2.2.2" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.2.2.cmml">f</mi><mi id="S4.SS2.SSS2.p2.5.m5.1.2.2.2.3" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.2.3.cmml">θ</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.SSS2.p2.5.m5.1.2.2.1" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.1.cmml">∘</mo><msub id="S4.SS2.SSS2.p2.5.m5.1.2.2.3" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.3.cmml"><mi id="S4.SS2.SSS2.p2.5.m5.1.2.2.3.2" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.3.2.cmml">f</mi><mi mathvariant="normal" id="S4.SS2.SSS2.p2.5.m5.1.2.2.3.3" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.3.3.cmml">Θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p2.5.m5.1.2.1" xref="S4.SS2.SSS2.p2.5.m5.1.2.1.cmml">​</mo><mrow id="S4.SS2.SSS2.p2.5.m5.1.2.3.2" xref="S4.SS2.SSS2.p2.5.m5.1.2.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p2.5.m5.1.2.3.2.1" xref="S4.SS2.SSS2.p2.5.m5.1.2.cmml">(</mo><mi id="S4.SS2.SSS2.p2.5.m5.1.1" xref="S4.SS2.SSS2.p2.5.m5.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS2.SSS2.p2.5.m5.1.2.3.2.2" xref="S4.SS2.SSS2.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.5.m5.1b"><apply id="S4.SS2.SSS2.p2.5.m5.1.2.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2"><times id="S4.SS2.SSS2.p2.5.m5.1.2.1.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2.1"></times><apply id="S4.SS2.SSS2.p2.5.m5.1.2.2.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2.2"><compose id="S4.SS2.SSS2.p2.5.m5.1.2.2.1.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.1"></compose><apply id="S4.SS2.SSS2.p2.5.m5.1.2.2.2.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.5.m5.1.2.2.2.1.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS2.p2.5.m5.1.2.2.2.2.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.2.2">𝑓</ci><ci id="S4.SS2.SSS2.p2.5.m5.1.2.2.2.3.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.2.3">𝜃</ci></apply><apply id="S4.SS2.SSS2.p2.5.m5.1.2.2.3.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.5.m5.1.2.2.3.1.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.3">subscript</csymbol><ci id="S4.SS2.SSS2.p2.5.m5.1.2.2.3.2.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.3.2">𝑓</ci><ci id="S4.SS2.SSS2.p2.5.m5.1.2.2.3.3.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.2.2.3.3">Θ</ci></apply></apply><ci id="S4.SS2.SSS2.p2.5.m5.1.1.cmml" xref="S4.SS2.SSS2.p2.5.m5.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.5.m5.1c">f_{\theta}\circ f_{\Theta}(x)</annotation></semantics></math>. Thus the predicted probabilistic distribution over <math id="S4.SS2.SSS2.p2.6.m6.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.SSS2.p2.6.m6.1a"><mi id="S4.SS2.SSS2.p2.6.m6.1.1" xref="S4.SS2.SSS2.p2.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.6.m6.1b"><ci id="S4.SS2.SSS2.p2.6.m6.1.1.cmml" xref="S4.SS2.SSS2.p2.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.6.m6.1c">N</annotation></semantics></math> classes is denoted as
<math id="S4.SS2.SSS2.p2.7.m7.4" class="ltx_Math" alttext="p(\Theta,\theta)=\sigma(f_{\theta}\circ f_{\Theta}(x))" display="inline"><semantics id="S4.SS2.SSS2.p2.7.m7.4a"><mrow id="S4.SS2.SSS2.p2.7.m7.4.4" xref="S4.SS2.SSS2.p2.7.m7.4.4.cmml"><mrow id="S4.SS2.SSS2.p2.7.m7.4.4.3" xref="S4.SS2.SSS2.p2.7.m7.4.4.3.cmml"><mi id="S4.SS2.SSS2.p2.7.m7.4.4.3.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p2.7.m7.4.4.3.1" xref="S4.SS2.SSS2.p2.7.m7.4.4.3.1.cmml">​</mo><mrow id="S4.SS2.SSS2.p2.7.m7.4.4.3.3.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p2.7.m7.4.4.3.3.2.1" xref="S4.SS2.SSS2.p2.7.m7.4.4.3.3.1.cmml">(</mo><mi mathvariant="normal" id="S4.SS2.SSS2.p2.7.m7.1.1" xref="S4.SS2.SSS2.p2.7.m7.1.1.cmml">Θ</mi><mo id="S4.SS2.SSS2.p2.7.m7.4.4.3.3.2.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.3.3.1.cmml">,</mo><mi id="S4.SS2.SSS2.p2.7.m7.2.2" xref="S4.SS2.SSS2.p2.7.m7.2.2.cmml">θ</mi><mo stretchy="false" id="S4.SS2.SSS2.p2.7.m7.4.4.3.3.2.3" xref="S4.SS2.SSS2.p2.7.m7.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS2.p2.7.m7.4.4.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.2.cmml">=</mo><mrow id="S4.SS2.SSS2.p2.7.m7.4.4.1" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.cmml"><mi id="S4.SS2.SSS2.p2.7.m7.4.4.1.3" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p2.7.m7.4.4.1.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.2.cmml">​</mo><mrow id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.cmml"><mrow id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.cmml"><msub id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2.cmml"><mi id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2.2.cmml">f</mi><mi id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2.3" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.1" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.1.cmml">∘</mo><msub id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3.cmml"><mi id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3.2.cmml">f</mi><mi mathvariant="normal" id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3.3" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3.3.cmml">Θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.1" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.1.cmml">​</mo><mrow id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.3.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.3.2.1" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.cmml">(</mo><mi id="S4.SS2.SSS2.p2.7.m7.3.3" xref="S4.SS2.SSS2.p2.7.m7.3.3.cmml">x</mi><mo stretchy="false" id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.3.2.2" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.3" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.7.m7.4b"><apply id="S4.SS2.SSS2.p2.7.m7.4.4.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4"><eq id="S4.SS2.SSS2.p2.7.m7.4.4.2.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.2"></eq><apply id="S4.SS2.SSS2.p2.7.m7.4.4.3.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.3"><times id="S4.SS2.SSS2.p2.7.m7.4.4.3.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.3.1"></times><ci id="S4.SS2.SSS2.p2.7.m7.4.4.3.2.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.3.2">𝑝</ci><interval closure="open" id="S4.SS2.SSS2.p2.7.m7.4.4.3.3.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.3.3.2"><ci id="S4.SS2.SSS2.p2.7.m7.1.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.1.1">Θ</ci><ci id="S4.SS2.SSS2.p2.7.m7.2.2.cmml" xref="S4.SS2.SSS2.p2.7.m7.2.2">𝜃</ci></interval></apply><apply id="S4.SS2.SSS2.p2.7.m7.4.4.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1"><times id="S4.SS2.SSS2.p2.7.m7.4.4.1.2.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.2"></times><ci id="S4.SS2.SSS2.p2.7.m7.4.4.1.3.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.3">𝜎</ci><apply id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1"><times id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.1"></times><apply id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2"><compose id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.1"></compose><apply id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2.2.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2.2">𝑓</ci><ci id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2.3.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.2.3">𝜃</ci></apply><apply id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3.1.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3">subscript</csymbol><ci id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3.2.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3.2">𝑓</ci><ci id="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3.3.cmml" xref="S4.SS2.SSS2.p2.7.m7.4.4.1.1.1.1.2.3.3">Θ</ci></apply></apply><ci id="S4.SS2.SSS2.p2.7.m7.3.3.cmml" xref="S4.SS2.SSS2.p2.7.m7.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.7.m7.4c">p(\Theta,\theta)=\sigma(f_{\theta}\circ f_{\Theta}(x))</annotation></semantics></math> in which <math id="S4.SS2.SSS2.p2.8.m8.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS2.SSS2.p2.8.m8.1a"><mi id="S4.SS2.SSS2.p2.8.m8.1.1" xref="S4.SS2.SSS2.p2.8.m8.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.8.m8.1b"><ci id="S4.SS2.SSS2.p2.8.m8.1.1.cmml" xref="S4.SS2.SSS2.p2.8.m8.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.8.m8.1c">\sigma</annotation></semantics></math> is the softmax function.</p>
</div>
<div id="S4.SS2.SSS2.p3" class="ltx_para">
<p id="S4.SS2.SSS2.p3.1" class="ltx_p">In centralized training, the
feature generator and the classifier could be learned with supervised learning without many tricks. However, in distributed scenarios, we have to additionally consider aligning feature space learned with many clients. We propose a novel procedure that
alternatively trains the classifier and the generator as two opponents. We train the client model classifier to maximize the difference between its predictions and central model predictions, while train the client feature generator to minimize the difference. We will explain the details and intuitions.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2104.00365/assets/x5.png" id="S4.F5.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="140" height="105" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.3.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>. </span><span id="S4.F5.4.2" class="ltx_text" style="font-size:90%;">An example of federated decision boundaries learned by FedFSL-MI-adv with two-stage adversarial learning on two clients of different data distributions. </span></figcaption>
</figure>
</section>
<section id="S4.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.3. </span>Adversarial learning procedure</h4>

<div id="S4.SS2.SSS3.p1" class="ltx_para">
<p id="S4.SS2.SSS3.p1.6" class="ltx_p">We design a two-stage adversarial learning procedure for the local update for explicitly learning a consistent feature space.
In overall, the <math id="S4.SS2.SSS3.p1.1.m1.1" class="ltx_Math" alttext="(t\text{-}1)" display="inline"><semantics id="S4.SS2.SSS3.p1.1.m1.1a"><mrow id="S4.SS2.SSS3.p1.1.m1.1.1.1" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS3.p1.1.m1.1.1.1.2" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS3.p1.1.m1.1.1.1.1" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.cmml"><mi id="S4.SS2.SSS3.p1.1.m1.1.1.1.1.2" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS3.p1.1.m1.1.1.1.1.1" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.1.cmml">​</mo><mtext id="S4.SS2.SSS3.p1.1.m1.1.1.1.1.3" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.3a.cmml">-</mtext><mo lspace="0em" rspace="0em" id="S4.SS2.SSS3.p1.1.m1.1.1.1.1.1a" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.1.cmml">​</mo><mn id="S4.SS2.SSS3.p1.1.m1.1.1.1.1.4" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.4.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS2.SSS3.p1.1.m1.1.1.1.3" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.1.m1.1b"><apply id="S4.SS2.SSS3.p1.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.1"><times id="S4.SS2.SSS3.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.1"></times><ci id="S4.SS2.SSS3.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.2">𝑡</ci><ci id="S4.SS2.SSS3.p1.1.m1.1.1.1.1.3a.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.3"><mtext id="S4.SS2.SSS3.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.3">-</mtext></ci><cn type="integer" id="S4.SS2.SSS3.p1.1.m1.1.1.1.1.4.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.1.1.4">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.1.m1.1c">(t\text{-}1)</annotation></semantics></math>-th communication round ends up by aggregating the
client models to a central model in (<a href="#S3.E10" title="In 2nd item ‣ 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) and sending it back to clients as <math id="S4.SS2.SSS3.p1.2.m2.2" class="ltx_Math" alttext="w_{k}=[\Theta_{k},\theta_{k}]" display="inline"><semantics id="S4.SS2.SSS3.p1.2.m2.2a"><mrow id="S4.SS2.SSS3.p1.2.m2.2.2" xref="S4.SS2.SSS3.p1.2.m2.2.2.cmml"><msub id="S4.SS2.SSS3.p1.2.m2.2.2.4" xref="S4.SS2.SSS3.p1.2.m2.2.2.4.cmml"><mi id="S4.SS2.SSS3.p1.2.m2.2.2.4.2" xref="S4.SS2.SSS3.p1.2.m2.2.2.4.2.cmml">w</mi><mi id="S4.SS2.SSS3.p1.2.m2.2.2.4.3" xref="S4.SS2.SSS3.p1.2.m2.2.2.4.3.cmml">k</mi></msub><mo id="S4.SS2.SSS3.p1.2.m2.2.2.3" xref="S4.SS2.SSS3.p1.2.m2.2.2.3.cmml">=</mo><mrow id="S4.SS2.SSS3.p1.2.m2.2.2.2.2" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS2.SSS3.p1.2.m2.2.2.2.2.3" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.3.cmml">[</mo><msub id="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1" xref="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1.2" xref="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1.2.cmml">Θ</mi><mi id="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1.3" xref="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS2.SSS3.p1.2.m2.2.2.2.2.4" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.3.cmml">,</mo><msub id="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2.cmml"><mi id="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2.2" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2.2.cmml">θ</mi><mi id="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2.3" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S4.SS2.SSS3.p1.2.m2.2.2.2.2.5" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.2.m2.2b"><apply id="S4.SS2.SSS3.p1.2.m2.2.2.cmml" xref="S4.SS2.SSS3.p1.2.m2.2.2"><eq id="S4.SS2.SSS3.p1.2.m2.2.2.3.cmml" xref="S4.SS2.SSS3.p1.2.m2.2.2.3"></eq><apply id="S4.SS2.SSS3.p1.2.m2.2.2.4.cmml" xref="S4.SS2.SSS3.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.2.m2.2.2.4.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.2.2.4">subscript</csymbol><ci id="S4.SS2.SSS3.p1.2.m2.2.2.4.2.cmml" xref="S4.SS2.SSS3.p1.2.m2.2.2.4.2">𝑤</ci><ci id="S4.SS2.SSS3.p1.2.m2.2.2.4.3.cmml" xref="S4.SS2.SSS3.p1.2.m2.2.2.4.3">𝑘</ci></apply><interval closure="closed" id="S4.SS2.SSS3.p1.2.m2.2.2.2.3.cmml" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.2"><apply id="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1.2">Θ</ci><ci id="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2.cmml" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2.2">𝜃</ci><ci id="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2.3.cmml" xref="S4.SS2.SSS3.p1.2.m2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.2.m2.2c">w_{k}=[\Theta_{k},\theta_{k}]</annotation></semantics></math>.
At the beginning of next round of local update,
each client initializes a new classifier <math id="S4.SS2.SSS3.p1.3.m3.1" class="ltx_Math" alttext="\theta_{k}^{\prime}" display="inline"><semantics id="S4.SS2.SSS3.p1.3.m3.1a"><msubsup id="S4.SS2.SSS3.p1.3.m3.1.1" xref="S4.SS2.SSS3.p1.3.m3.1.1.cmml"><mi id="S4.SS2.SSS3.p1.3.m3.1.1.2.2" xref="S4.SS2.SSS3.p1.3.m3.1.1.2.2.cmml">θ</mi><mi id="S4.SS2.SSS3.p1.3.m3.1.1.2.3" xref="S4.SS2.SSS3.p1.3.m3.1.1.2.3.cmml">k</mi><mo id="S4.SS2.SSS3.p1.3.m3.1.1.3" xref="S4.SS2.SSS3.p1.3.m3.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.3.m3.1b"><apply id="S4.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1">superscript</csymbol><apply id="S4.SS2.SSS3.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.3.m3.1.1.2.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.3.m3.1.1.2.2.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1.2.2">𝜃</ci><ci id="S4.SS2.SSS3.p1.3.m3.1.1.2.3.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1.2.3">𝑘</ci></apply><ci id="S4.SS2.SSS3.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.3.m3.1c">\theta_{k}^{\prime}</annotation></semantics></math>.
The feature generator <math id="S4.SS2.SSS3.p1.4.m4.1" class="ltx_Math" alttext="\Theta_{k}" display="inline"><semantics id="S4.SS2.SSS3.p1.4.m4.1a"><msub id="S4.SS2.SSS3.p1.4.m4.1.1" xref="S4.SS2.SSS3.p1.4.m4.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.SSS3.p1.4.m4.1.1.2" xref="S4.SS2.SSS3.p1.4.m4.1.1.2.cmml">Θ</mi><mi id="S4.SS2.SSS3.p1.4.m4.1.1.3" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.4.m4.1b"><apply id="S4.SS2.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.2">Θ</ci><ci id="S4.SS2.SSS3.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.4.m4.1c">\Theta_{k}</annotation></semantics></math> and two classifiers <math id="S4.SS2.SSS3.p1.5.m5.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="S4.SS2.SSS3.p1.5.m5.1a"><msub id="S4.SS2.SSS3.p1.5.m5.1.1" xref="S4.SS2.SSS3.p1.5.m5.1.1.cmml"><mi id="S4.SS2.SSS3.p1.5.m5.1.1.2" xref="S4.SS2.SSS3.p1.5.m5.1.1.2.cmml">θ</mi><mi id="S4.SS2.SSS3.p1.5.m5.1.1.3" xref="S4.SS2.SSS3.p1.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.5.m5.1b"><apply id="S4.SS2.SSS3.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1.2">𝜃</ci><ci id="S4.SS2.SSS3.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.5.m5.1c">\theta_{k}</annotation></semantics></math> and <math id="S4.SS2.SSS3.p1.6.m6.1" class="ltx_Math" alttext="\theta_{k}^{\prime}" display="inline"><semantics id="S4.SS2.SSS3.p1.6.m6.1a"><msubsup id="S4.SS2.SSS3.p1.6.m6.1.1" xref="S4.SS2.SSS3.p1.6.m6.1.1.cmml"><mi id="S4.SS2.SSS3.p1.6.m6.1.1.2.2" xref="S4.SS2.SSS3.p1.6.m6.1.1.2.2.cmml">θ</mi><mi id="S4.SS2.SSS3.p1.6.m6.1.1.2.3" xref="S4.SS2.SSS3.p1.6.m6.1.1.2.3.cmml">k</mi><mo id="S4.SS2.SSS3.p1.6.m6.1.1.3" xref="S4.SS2.SSS3.p1.6.m6.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.6.m6.1b"><apply id="S4.SS2.SSS3.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.6.m6.1.1.1.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1">superscript</csymbol><apply id="S4.SS2.SSS3.p1.6.m6.1.1.2.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.6.m6.1.1.2.1.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.6.m6.1.1.2.2.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1.2.2">𝜃</ci><ci id="S4.SS2.SSS3.p1.6.m6.1.1.2.3.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1.2.3">𝑘</ci></apply><ci id="S4.SS2.SSS3.p1.6.m6.1.1.3.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.6.m6.1c">\theta_{k}^{\prime}</annotation></semantics></math> are all trainable and will involve in a two-stage adversarial training procedure as follows.</p>
</div>
<div id="S4.SS2.SSS3.p2" class="ltx_para">
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.3" class="ltx_p"><span id="S4.I1.i1.p1.3.1" class="ltx_text ltx_font_bold">Training stage-1</span> is to
train two classifiers to produce <em id="S4.I1.i1.p1.3.2" class="ltx_emph ltx_font_italic">distinct</em> decision boundaries, in the motivation of detecting ambiguous data samples in current feature space. Ambiguous samples are those lying near the decision boundaries that tend to be misclassified by two different classifiers, as shown in Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.2.2. Learn a consistent feature space ‣ 4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>(stage-1). Intuitively, detecting those samples is the prerequisite of optimizing a feature space that resolves the ambiguity.
During this stage, the feature generator <math id="S4.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\Theta_{k}" display="inline"><semantics id="S4.I1.i1.p1.1.m1.1a"><msub id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">Θ</mi><mi id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">Θ</ci><ci id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">\Theta_{k}</annotation></semantics></math> remains fixed, while <math id="S4.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="S4.I1.i1.p1.2.m2.1a"><msub id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml"><mi id="S4.I1.i1.p1.2.m2.1.1.2" xref="S4.I1.i1.p1.2.m2.1.1.2.cmml">θ</mi><mi id="S4.I1.i1.p1.2.m2.1.1.3" xref="S4.I1.i1.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><apply id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.2.m2.1.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.2.m2.1.1.2.cmml" xref="S4.I1.i1.p1.2.m2.1.1.2">𝜃</ci><ci id="S4.I1.i1.p1.2.m2.1.1.3.cmml" xref="S4.I1.i1.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">\theta_{k}</annotation></semantics></math> and <math id="S4.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="\theta_{k}^{\prime}" display="inline"><semantics id="S4.I1.i1.p1.3.m3.1a"><msubsup id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml"><mi id="S4.I1.i1.p1.3.m3.1.1.2.2" xref="S4.I1.i1.p1.3.m3.1.1.2.2.cmml">θ</mi><mi id="S4.I1.i1.p1.3.m3.1.1.2.3" xref="S4.I1.i1.p1.3.m3.1.1.2.3.cmml">k</mi><mo id="S4.I1.i1.p1.3.m3.1.1.3" xref="S4.I1.i1.p1.3.m3.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><apply id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.3.m3.1.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.3.m3.1.1.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.3.m3.1.1.2.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.3.m3.1.1.2.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1.2.2">𝜃</ci><ci id="S4.I1.i1.p1.3.m3.1.1.2.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.2.3">𝑘</ci></apply><ci id="S4.I1.i1.p1.3.m3.1.1.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">\theta_{k}^{\prime}</annotation></semantics></math> are updated.</p>
</div>
<div id="S4.I1.i1.p2" class="ltx_para">
<p id="S4.I1.i1.p2.3" class="ltx_p">We first define the adversarial loss to measure the difference of two classifiers <math id="S4.I1.i1.p2.1.m1.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="S4.I1.i1.p2.1.m1.1a"><msub id="S4.I1.i1.p2.1.m1.1.1" xref="S4.I1.i1.p2.1.m1.1.1.cmml"><mi id="S4.I1.i1.p2.1.m1.1.1.2" xref="S4.I1.i1.p2.1.m1.1.1.2.cmml">θ</mi><mi id="S4.I1.i1.p2.1.m1.1.1.3" xref="S4.I1.i1.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p2.1.m1.1b"><apply id="S4.I1.i1.p2.1.m1.1.1.cmml" xref="S4.I1.i1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p2.1.m1.1.1.1.cmml" xref="S4.I1.i1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i1.p2.1.m1.1.1.2.cmml" xref="S4.I1.i1.p2.1.m1.1.1.2">𝜃</ci><ci id="S4.I1.i1.p2.1.m1.1.1.3.cmml" xref="S4.I1.i1.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p2.1.m1.1c">\theta_{k}</annotation></semantics></math> and <math id="S4.I1.i1.p2.2.m2.1" class="ltx_Math" alttext="\theta_{k}^{\prime}" display="inline"><semantics id="S4.I1.i1.p2.2.m2.1a"><msubsup id="S4.I1.i1.p2.2.m2.1.1" xref="S4.I1.i1.p2.2.m2.1.1.cmml"><mi id="S4.I1.i1.p2.2.m2.1.1.2.2" xref="S4.I1.i1.p2.2.m2.1.1.2.2.cmml">θ</mi><mi id="S4.I1.i1.p2.2.m2.1.1.2.3" xref="S4.I1.i1.p2.2.m2.1.1.2.3.cmml">k</mi><mo id="S4.I1.i1.p2.2.m2.1.1.3" xref="S4.I1.i1.p2.2.m2.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p2.2.m2.1b"><apply id="S4.I1.i1.p2.2.m2.1.1.cmml" xref="S4.I1.i1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p2.2.m2.1.1.1.cmml" xref="S4.I1.i1.p2.2.m2.1.1">superscript</csymbol><apply id="S4.I1.i1.p2.2.m2.1.1.2.cmml" xref="S4.I1.i1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p2.2.m2.1.1.2.1.cmml" xref="S4.I1.i1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i1.p2.2.m2.1.1.2.2.cmml" xref="S4.I1.i1.p2.2.m2.1.1.2.2">𝜃</ci><ci id="S4.I1.i1.p2.2.m2.1.1.2.3.cmml" xref="S4.I1.i1.p2.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S4.I1.i1.p2.2.m2.1.1.3.cmml" xref="S4.I1.i1.p2.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p2.2.m2.1c">\theta_{k}^{\prime}</annotation></semantics></math> by the KL divergence of their probabilistic outputs <math id="S4.I1.i1.p2.3.m3.2" class="ltx_Math" alttext="p(\Theta,\theta)" display="inline"><semantics id="S4.I1.i1.p2.3.m3.2a"><mrow id="S4.I1.i1.p2.3.m3.2.3" xref="S4.I1.i1.p2.3.m3.2.3.cmml"><mi id="S4.I1.i1.p2.3.m3.2.3.2" xref="S4.I1.i1.p2.3.m3.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.I1.i1.p2.3.m3.2.3.1" xref="S4.I1.i1.p2.3.m3.2.3.1.cmml">​</mo><mrow id="S4.I1.i1.p2.3.m3.2.3.3.2" xref="S4.I1.i1.p2.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S4.I1.i1.p2.3.m3.2.3.3.2.1" xref="S4.I1.i1.p2.3.m3.2.3.3.1.cmml">(</mo><mi mathvariant="normal" id="S4.I1.i1.p2.3.m3.1.1" xref="S4.I1.i1.p2.3.m3.1.1.cmml">Θ</mi><mo id="S4.I1.i1.p2.3.m3.2.3.3.2.2" xref="S4.I1.i1.p2.3.m3.2.3.3.1.cmml">,</mo><mi id="S4.I1.i1.p2.3.m3.2.2" xref="S4.I1.i1.p2.3.m3.2.2.cmml">θ</mi><mo stretchy="false" id="S4.I1.i1.p2.3.m3.2.3.3.2.3" xref="S4.I1.i1.p2.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p2.3.m3.2b"><apply id="S4.I1.i1.p2.3.m3.2.3.cmml" xref="S4.I1.i1.p2.3.m3.2.3"><times id="S4.I1.i1.p2.3.m3.2.3.1.cmml" xref="S4.I1.i1.p2.3.m3.2.3.1"></times><ci id="S4.I1.i1.p2.3.m3.2.3.2.cmml" xref="S4.I1.i1.p2.3.m3.2.3.2">𝑝</ci><interval closure="open" id="S4.I1.i1.p2.3.m3.2.3.3.1.cmml" xref="S4.I1.i1.p2.3.m3.2.3.3.2"><ci id="S4.I1.i1.p2.3.m3.1.1.cmml" xref="S4.I1.i1.p2.3.m3.1.1">Θ</ci><ci id="S4.I1.i1.p2.3.m3.2.2.cmml" xref="S4.I1.i1.p2.3.m3.2.2">𝜃</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p2.3.m3.2c">p(\Theta,\theta)</annotation></semantics></math> such that</p>
<table id="S4.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E14.m1.42" class="ltx_math_unparsed" alttext="\begin{split}&amp;\mathcal{L}_{k}^{adv}(\theta_{k},\theta_{k}^{\prime},\Theta_{k})=\frac{1}{|\mathcal{B}_{k}|}\sum_{\mathcal{T}_{k}}D_{KL}\left(p(\Theta_{k},\theta_{k})~{}||~{}p(\Theta_{k},\theta_{k}^{\prime})\right).\end{split}" display="block"><semantics id="S4.E14.m1.42a"><mtable columnspacing="0pt" displaystyle="true" id="S4.E14.m1.42.42"><mtr id="S4.E14.m1.42.42a"><mtd id="S4.E14.m1.42.42b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E14.m1.42.42c"><mrow id="S4.E14.m1.42.42.42.42.42"><msubsup id="S4.E14.m1.42.42.42.42.42.43"><mi class="ltx_font_mathcaligraphic" id="S4.E14.m1.1.1.1.1.1.1">ℒ</mi><mi id="S4.E14.m1.2.2.2.2.2.2.1">k</mi><mrow id="S4.E14.m1.3.3.3.3.3.3.1"><mi id="S4.E14.m1.3.3.3.3.3.3.1.2">a</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.3.3.3.3.3.3.1.1">​</mo><mi id="S4.E14.m1.3.3.3.3.3.3.1.3">d</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.3.3.3.3.3.3.1.1a">​</mo><mi id="S4.E14.m1.3.3.3.3.3.3.1.4">v</mi></mrow></msubsup><mrow id="S4.E14.m1.42.42.42.42.42.44"><mo stretchy="false" id="S4.E14.m1.4.4.4.4.4.4">(</mo><msub id="S4.E14.m1.42.42.42.42.42.44.1"><mi id="S4.E14.m1.5.5.5.5.5.5">θ</mi><mi id="S4.E14.m1.6.6.6.6.6.6.1">k</mi></msub><mo id="S4.E14.m1.7.7.7.7.7.7">,</mo><msubsup id="S4.E14.m1.42.42.42.42.42.44.2"><mi id="S4.E14.m1.8.8.8.8.8.8">θ</mi><mi id="S4.E14.m1.9.9.9.9.9.9.1">k</mi><mo id="S4.E14.m1.10.10.10.10.10.10.1">′</mo></msubsup><mo id="S4.E14.m1.11.11.11.11.11.11">,</mo><msub id="S4.E14.m1.42.42.42.42.42.44.3"><mi mathvariant="normal" id="S4.E14.m1.12.12.12.12.12.12">Θ</mi><mi id="S4.E14.m1.13.13.13.13.13.13.1">k</mi></msub><mo stretchy="false" id="S4.E14.m1.14.14.14.14.14.14">)</mo></mrow><mo id="S4.E14.m1.15.15.15.15.15.15">=</mo><mfrac id="S4.E14.m1.16.16.16.16.16.16"><mn id="S4.E14.m1.16.16.16.16.16.16.3">1</mn><mrow id="S4.E14.m1.16.16.16.16.16.16.1.1"><mo stretchy="false" id="S4.E14.m1.16.16.16.16.16.16.1.1.2">|</mo><msub id="S4.E14.m1.16.16.16.16.16.16.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S4.E14.m1.16.16.16.16.16.16.1.1.1.2">ℬ</mi><mi id="S4.E14.m1.16.16.16.16.16.16.1.1.1.3">k</mi></msub><mo stretchy="false" id="S4.E14.m1.16.16.16.16.16.16.1.1.3">|</mo></mrow></mfrac><munder id="S4.E14.m1.42.42.42.42.42.45"><mo movablelimits="false" id="S4.E14.m1.17.17.17.17.17.17">∑</mo><msub id="S4.E14.m1.18.18.18.18.18.18.1"><mi class="ltx_font_mathcaligraphic" id="S4.E14.m1.18.18.18.18.18.18.1.2">𝒯</mi><mi id="S4.E14.m1.18.18.18.18.18.18.1.3">k</mi></msub></munder><msub id="S4.E14.m1.42.42.42.42.42.46"><mi id="S4.E14.m1.19.19.19.19.19.19">D</mi><mrow id="S4.E14.m1.20.20.20.20.20.20.1"><mi id="S4.E14.m1.20.20.20.20.20.20.1.2">K</mi><mo lspace="0em" rspace="0em" id="S4.E14.m1.20.20.20.20.20.20.1.1">​</mo><mi id="S4.E14.m1.20.20.20.20.20.20.1.3">L</mi></mrow></msub><mrow id="S4.E14.m1.42.42.42.42.42.47"><mo id="S4.E14.m1.21.21.21.21.21.21">(</mo><mi id="S4.E14.m1.22.22.22.22.22.22">p</mi><mrow id="S4.E14.m1.42.42.42.42.42.47.1"><mo stretchy="false" id="S4.E14.m1.23.23.23.23.23.23">(</mo><msub id="S4.E14.m1.42.42.42.42.42.47.1.1"><mi mathvariant="normal" id="S4.E14.m1.24.24.24.24.24.24">Θ</mi><mi id="S4.E14.m1.25.25.25.25.25.25.1">k</mi></msub><mo id="S4.E14.m1.26.26.26.26.26.26">,</mo><msub id="S4.E14.m1.42.42.42.42.42.47.1.2"><mi id="S4.E14.m1.27.27.27.27.27.27">θ</mi><mi id="S4.E14.m1.28.28.28.28.28.28.1">k</mi></msub><mo rspace="0.330em" stretchy="false" id="S4.E14.m1.29.29.29.29.29.29">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S4.E14.m1.30.30.30.30.30.30">|</mo><mo fence="false" rspace="0.497em" stretchy="false" id="S4.E14.m1.31.31.31.31.31.31">|</mo><mi id="S4.E14.m1.32.32.32.32.32.32">p</mi><mrow id="S4.E14.m1.42.42.42.42.42.47.2"><mo stretchy="false" id="S4.E14.m1.33.33.33.33.33.33">(</mo><msub id="S4.E14.m1.42.42.42.42.42.47.2.1"><mi mathvariant="normal" id="S4.E14.m1.34.34.34.34.34.34">Θ</mi><mi id="S4.E14.m1.35.35.35.35.35.35.1">k</mi></msub><mo id="S4.E14.m1.36.36.36.36.36.36">,</mo><msubsup id="S4.E14.m1.42.42.42.42.42.47.2.2"><mi id="S4.E14.m1.37.37.37.37.37.37">θ</mi><mi id="S4.E14.m1.38.38.38.38.38.38.1">k</mi><mo id="S4.E14.m1.39.39.39.39.39.39.1">′</mo></msubsup><mo stretchy="false" id="S4.E14.m1.40.40.40.40.40.40">)</mo></mrow><mo id="S4.E14.m1.41.41.41.41.41.41">)</mo></mrow><mo lspace="0em" id="S4.E14.m1.42.42.42.42.42.42">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S4.E14.m1.42b">\begin{split}&amp;\mathcal{L}_{k}^{adv}(\theta_{k},\theta_{k}^{\prime},\Theta_{k})=\frac{1}{|\mathcal{B}_{k}|}\sum_{\mathcal{T}_{k}}D_{KL}\left(p(\Theta_{k},\theta_{k})~{}||~{}p(\Theta_{k},\theta_{k}^{\prime})\right).\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.I1.i1.p2.6" class="ltx_p">We simultaneously minimize the FSL local objective (<a href="#S3.E7" title="In 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) while <em id="S4.I1.i1.p2.6.1" class="ltx_emph ltx_font_italic">maximize</em> the adversarial loss to encourage the disagreement of the two classifiers. Formally,
we define the objective of stage-1 as a combination of local task objective <math id="S4.I1.i1.p2.4.m1.1" class="ltx_Math" alttext="\mathcal{L}_{k}" display="inline"><semantics id="S4.I1.i1.p2.4.m1.1a"><msub id="S4.I1.i1.p2.4.m1.1.1" xref="S4.I1.i1.p2.4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i1.p2.4.m1.1.1.2" xref="S4.I1.i1.p2.4.m1.1.1.2.cmml">ℒ</mi><mi id="S4.I1.i1.p2.4.m1.1.1.3" xref="S4.I1.i1.p2.4.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p2.4.m1.1b"><apply id="S4.I1.i1.p2.4.m1.1.1.cmml" xref="S4.I1.i1.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p2.4.m1.1.1.1.cmml" xref="S4.I1.i1.p2.4.m1.1.1">subscript</csymbol><ci id="S4.I1.i1.p2.4.m1.1.1.2.cmml" xref="S4.I1.i1.p2.4.m1.1.1.2">ℒ</ci><ci id="S4.I1.i1.p2.4.m1.1.1.3.cmml" xref="S4.I1.i1.p2.4.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p2.4.m1.1c">\mathcal{L}_{k}</annotation></semantics></math> (<a href="#S3.E7" title="In 3.3. Federated Few-shot Learning (FedFSL) ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) and adversarial loss <math id="S4.I1.i1.p2.5.m2.1" class="ltx_Math" alttext="\mathcal{L}_{k}^{adv}" display="inline"><semantics id="S4.I1.i1.p2.5.m2.1a"><msubsup id="S4.I1.i1.p2.5.m2.1.1" xref="S4.I1.i1.p2.5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i1.p2.5.m2.1.1.2.2" xref="S4.I1.i1.p2.5.m2.1.1.2.2.cmml">ℒ</mi><mi id="S4.I1.i1.p2.5.m2.1.1.2.3" xref="S4.I1.i1.p2.5.m2.1.1.2.3.cmml">k</mi><mrow id="S4.I1.i1.p2.5.m2.1.1.3" xref="S4.I1.i1.p2.5.m2.1.1.3.cmml"><mi id="S4.I1.i1.p2.5.m2.1.1.3.2" xref="S4.I1.i1.p2.5.m2.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.I1.i1.p2.5.m2.1.1.3.1" xref="S4.I1.i1.p2.5.m2.1.1.3.1.cmml">​</mo><mi id="S4.I1.i1.p2.5.m2.1.1.3.3" xref="S4.I1.i1.p2.5.m2.1.1.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.I1.i1.p2.5.m2.1.1.3.1a" xref="S4.I1.i1.p2.5.m2.1.1.3.1.cmml">​</mo><mi id="S4.I1.i1.p2.5.m2.1.1.3.4" xref="S4.I1.i1.p2.5.m2.1.1.3.4.cmml">v</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p2.5.m2.1b"><apply id="S4.I1.i1.p2.5.m2.1.1.cmml" xref="S4.I1.i1.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p2.5.m2.1.1.1.cmml" xref="S4.I1.i1.p2.5.m2.1.1">superscript</csymbol><apply id="S4.I1.i1.p2.5.m2.1.1.2.cmml" xref="S4.I1.i1.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p2.5.m2.1.1.2.1.cmml" xref="S4.I1.i1.p2.5.m2.1.1">subscript</csymbol><ci id="S4.I1.i1.p2.5.m2.1.1.2.2.cmml" xref="S4.I1.i1.p2.5.m2.1.1.2.2">ℒ</ci><ci id="S4.I1.i1.p2.5.m2.1.1.2.3.cmml" xref="S4.I1.i1.p2.5.m2.1.1.2.3">𝑘</ci></apply><apply id="S4.I1.i1.p2.5.m2.1.1.3.cmml" xref="S4.I1.i1.p2.5.m2.1.1.3"><times id="S4.I1.i1.p2.5.m2.1.1.3.1.cmml" xref="S4.I1.i1.p2.5.m2.1.1.3.1"></times><ci id="S4.I1.i1.p2.5.m2.1.1.3.2.cmml" xref="S4.I1.i1.p2.5.m2.1.1.3.2">𝑎</ci><ci id="S4.I1.i1.p2.5.m2.1.1.3.3.cmml" xref="S4.I1.i1.p2.5.m2.1.1.3.3">𝑑</ci><ci id="S4.I1.i1.p2.5.m2.1.1.3.4.cmml" xref="S4.I1.i1.p2.5.m2.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p2.5.m2.1c">\mathcal{L}_{k}^{adv}</annotation></semantics></math> (<a href="#S4.E14" title="In 1st item ‣ 4.2.3. Adversarial learning procedure ‣ 4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>) with weight <math id="S4.I1.i1.p2.6.m3.1" class="ltx_Math" alttext="\eta&gt;0" display="inline"><semantics id="S4.I1.i1.p2.6.m3.1a"><mrow id="S4.I1.i1.p2.6.m3.1.1" xref="S4.I1.i1.p2.6.m3.1.1.cmml"><mi id="S4.I1.i1.p2.6.m3.1.1.2" xref="S4.I1.i1.p2.6.m3.1.1.2.cmml">η</mi><mo id="S4.I1.i1.p2.6.m3.1.1.1" xref="S4.I1.i1.p2.6.m3.1.1.1.cmml">&gt;</mo><mn id="S4.I1.i1.p2.6.m3.1.1.3" xref="S4.I1.i1.p2.6.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p2.6.m3.1b"><apply id="S4.I1.i1.p2.6.m3.1.1.cmml" xref="S4.I1.i1.p2.6.m3.1.1"><gt id="S4.I1.i1.p2.6.m3.1.1.1.cmml" xref="S4.I1.i1.p2.6.m3.1.1.1"></gt><ci id="S4.I1.i1.p2.6.m3.1.1.2.cmml" xref="S4.I1.i1.p2.6.m3.1.1.2">𝜂</ci><cn type="integer" id="S4.I1.i1.p2.6.m3.1.1.3.cmml" xref="S4.I1.i1.p2.6.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p2.6.m3.1c">\eta&gt;0</annotation></semantics></math> such that
</p>
<table id="S4.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E15.m1.58" class="ltx_Math" alttext="\underset{\theta_{k},\theta_{k}^{\prime}}{\text{min}}\ \mathcal{L}_{k}^{st\text{-}1}(\theta_{k},\theta_{k}^{\prime};\Theta_{k})\\
=\mathcal{L}_{k}(\theta_{k};\Theta_{k})+\mathcal{L}_{k}(\theta_{k}^{\prime};\Theta_{k})-\eta\mathcal{L}_{k}^{adv}(\theta_{k},\theta_{k}^{\prime};\Theta_{k})." display="block"><semantics id="S4.E15.m1.58a"><mtable displaystyle="true" rowspacing="0pt" id="S4.E15.m1.58.58.5"><mtr id="S4.E15.m1.58.58.5a"><mtd class="ltx_align_left" columnalign="left" id="S4.E15.m1.58.58.5b"><mrow id="S4.E15.m1.57.57.4.56.18.18"><munder accentunder="true" id="S4.E15.m1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.cmml"><mtext id="S4.E15.m1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.3a.cmml">min</mtext><mrow id="S4.E15.m1.1.1.1.1.1.1.2.2" xref="S4.E15.m1.1.1.1.1.1.1.2.3.cmml"><msub id="S4.E15.m1.1.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.E15.m1.1.1.1.1.1.1.2.2.3" xref="S4.E15.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S4.E15.m1.1.1.1.1.1.1.2.2.2" xref="S4.E15.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E15.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">θ</mi><mi id="S4.E15.m1.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E15.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">k</mi><mo id="S4.E15.m1.1.1.1.1.1.1.2.2.2.3" xref="S4.E15.m1.1.1.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup></mrow></munder><mo lspace="0.500em" rspace="0em" id="S4.E15.m1.57.57.4.56.18.18.19" xref="S4.E15.m1.54.54.1.1.1.cmml">​</mo><msubsup id="S4.E15.m1.57.57.4.56.18.18.20"><mi class="ltx_font_mathcaligraphic" id="S4.E15.m1.2.2.2.2.2.2" xref="S4.E15.m1.2.2.2.2.2.2.cmml">ℒ</mi><mi id="S4.E15.m1.3.3.3.3.3.3.1" xref="S4.E15.m1.3.3.3.3.3.3.1.cmml">k</mi><mrow id="S4.E15.m1.4.4.4.4.4.4.1" xref="S4.E15.m1.4.4.4.4.4.4.1.cmml"><mi id="S4.E15.m1.4.4.4.4.4.4.1.2" xref="S4.E15.m1.4.4.4.4.4.4.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E15.m1.4.4.4.4.4.4.1.1" xref="S4.E15.m1.4.4.4.4.4.4.1.1.cmml">​</mo><mi id="S4.E15.m1.4.4.4.4.4.4.1.3" xref="S4.E15.m1.4.4.4.4.4.4.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E15.m1.4.4.4.4.4.4.1.1a" xref="S4.E15.m1.4.4.4.4.4.4.1.1.cmml">​</mo><mtext id="S4.E15.m1.4.4.4.4.4.4.1.4" xref="S4.E15.m1.4.4.4.4.4.4.1.4a.cmml">-</mtext><mo lspace="0em" rspace="0em" id="S4.E15.m1.4.4.4.4.4.4.1.1b" xref="S4.E15.m1.4.4.4.4.4.4.1.1.cmml">​</mo><mn id="S4.E15.m1.4.4.4.4.4.4.1.5" xref="S4.E15.m1.4.4.4.4.4.4.1.5.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E15.m1.57.57.4.56.18.18.19a" xref="S4.E15.m1.54.54.1.1.1.cmml">​</mo><mrow id="S4.E15.m1.57.57.4.56.18.18.18.3"><mo stretchy="false" id="S4.E15.m1.5.5.5.5.5.5" xref="S4.E15.m1.54.54.1.1.1.cmml">(</mo><msub id="S4.E15.m1.55.55.2.54.16.16.16.1.1"><mi id="S4.E15.m1.6.6.6.6.6.6" xref="S4.E15.m1.6.6.6.6.6.6.cmml">θ</mi><mi id="S4.E15.m1.7.7.7.7.7.7.1" xref="S4.E15.m1.7.7.7.7.7.7.1.cmml">k</mi></msub><mo id="S4.E15.m1.8.8.8.8.8.8" xref="S4.E15.m1.54.54.1.1.1.cmml">,</mo><msubsup id="S4.E15.m1.56.56.3.55.17.17.17.2.2"><mi id="S4.E15.m1.9.9.9.9.9.9" xref="S4.E15.m1.9.9.9.9.9.9.cmml">θ</mi><mi id="S4.E15.m1.10.10.10.10.10.10.1" xref="S4.E15.m1.10.10.10.10.10.10.1.cmml">k</mi><mo id="S4.E15.m1.11.11.11.11.11.11.1" xref="S4.E15.m1.11.11.11.11.11.11.1.cmml">′</mo></msubsup><mo id="S4.E15.m1.12.12.12.12.12.12" xref="S4.E15.m1.54.54.1.1.1.cmml">;</mo><msub id="S4.E15.m1.57.57.4.56.18.18.18.3.3"><mi mathvariant="normal" id="S4.E15.m1.13.13.13.13.13.13" xref="S4.E15.m1.13.13.13.13.13.13.cmml">Θ</mi><mi id="S4.E15.m1.14.14.14.14.14.14.1" xref="S4.E15.m1.14.14.14.14.14.14.1.cmml">k</mi></msub><mo stretchy="false" id="S4.E15.m1.15.15.15.15.15.15" xref="S4.E15.m1.54.54.1.1.1.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S4.E15.m1.58.58.5c"><mtd class="ltx_align_right" columnalign="right" id="S4.E15.m1.58.58.5d"><mrow id="S4.E15.m1.58.58.5.57.39.39.39"><mrow id="S4.E15.m1.58.58.5.57.39.39.39.1"><mi id="S4.E15.m1.58.58.5.57.39.39.39.1.8" xref="S4.E15.m1.54.54.1.1.1.cmml"></mi><mo id="S4.E15.m1.16.16.16.1.1.1" xref="S4.E15.m1.16.16.16.1.1.1.cmml">=</mo><mrow id="S4.E15.m1.58.58.5.57.39.39.39.1.7"><mrow id="S4.E15.m1.58.58.5.57.39.39.39.1.4.4"><mrow id="S4.E15.m1.58.58.5.57.39.39.39.1.2.2.2"><msub id="S4.E15.m1.58.58.5.57.39.39.39.1.2.2.2.4"><mi class="ltx_font_mathcaligraphic" id="S4.E15.m1.17.17.17.2.2.2" xref="S4.E15.m1.17.17.17.2.2.2.cmml">ℒ</mi><mi id="S4.E15.m1.18.18.18.3.3.3.1" xref="S4.E15.m1.18.18.18.3.3.3.1.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E15.m1.58.58.5.57.39.39.39.1.2.2.2.3" xref="S4.E15.m1.54.54.1.1.1.cmml">​</mo><mrow id="S4.E15.m1.58.58.5.57.39.39.39.1.2.2.2.2.2"><mo stretchy="false" id="S4.E15.m1.19.19.19.4.4.4" xref="S4.E15.m1.54.54.1.1.1.cmml">(</mo><msub id="S4.E15.m1.58.58.5.57.39.39.39.1.1.1.1.1.1.1"><mi id="S4.E15.m1.20.20.20.5.5.5" xref="S4.E15.m1.20.20.20.5.5.5.cmml">θ</mi><mi id="S4.E15.m1.21.21.21.6.6.6.1" xref="S4.E15.m1.21.21.21.6.6.6.1.cmml">k</mi></msub><mo id="S4.E15.m1.22.22.22.7.7.7" xref="S4.E15.m1.54.54.1.1.1.cmml">;</mo><msub id="S4.E15.m1.58.58.5.57.39.39.39.1.2.2.2.2.2.2"><mi mathvariant="normal" id="S4.E15.m1.23.23.23.8.8.8" xref="S4.E15.m1.23.23.23.8.8.8.cmml">Θ</mi><mi id="S4.E15.m1.24.24.24.9.9.9.1" xref="S4.E15.m1.24.24.24.9.9.9.1.cmml">k</mi></msub><mo stretchy="false" id="S4.E15.m1.25.25.25.10.10.10" xref="S4.E15.m1.54.54.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E15.m1.26.26.26.11.11.11" xref="S4.E15.m1.26.26.26.11.11.11.cmml">+</mo><mrow id="S4.E15.m1.58.58.5.57.39.39.39.1.4.4.4"><msub id="S4.E15.m1.58.58.5.57.39.39.39.1.4.4.4.4"><mi class="ltx_font_mathcaligraphic" id="S4.E15.m1.27.27.27.12.12.12" xref="S4.E15.m1.27.27.27.12.12.12.cmml">ℒ</mi><mi id="S4.E15.m1.28.28.28.13.13.13.1" xref="S4.E15.m1.28.28.28.13.13.13.1.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E15.m1.58.58.5.57.39.39.39.1.4.4.4.3" xref="S4.E15.m1.54.54.1.1.1.cmml">​</mo><mrow id="S4.E15.m1.58.58.5.57.39.39.39.1.4.4.4.2.2"><mo stretchy="false" id="S4.E15.m1.29.29.29.14.14.14" xref="S4.E15.m1.54.54.1.1.1.cmml">(</mo><msubsup id="S4.E15.m1.58.58.5.57.39.39.39.1.3.3.3.1.1.1"><mi id="S4.E15.m1.30.30.30.15.15.15" xref="S4.E15.m1.30.30.30.15.15.15.cmml">θ</mi><mi id="S4.E15.m1.31.31.31.16.16.16.1" xref="S4.E15.m1.31.31.31.16.16.16.1.cmml">k</mi><mo id="S4.E15.m1.32.32.32.17.17.17.1" xref="S4.E15.m1.32.32.32.17.17.17.1.cmml">′</mo></msubsup><mo id="S4.E15.m1.33.33.33.18.18.18" xref="S4.E15.m1.54.54.1.1.1.cmml">;</mo><msub id="S4.E15.m1.58.58.5.57.39.39.39.1.4.4.4.2.2.2"><mi mathvariant="normal" id="S4.E15.m1.34.34.34.19.19.19" xref="S4.E15.m1.34.34.34.19.19.19.cmml">Θ</mi><mi id="S4.E15.m1.35.35.35.20.20.20.1" xref="S4.E15.m1.35.35.35.20.20.20.1.cmml">k</mi></msub><mo stretchy="false" id="S4.E15.m1.36.36.36.21.21.21" xref="S4.E15.m1.54.54.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E15.m1.37.37.37.22.22.22" xref="S4.E15.m1.37.37.37.22.22.22.cmml">−</mo><mrow id="S4.E15.m1.58.58.5.57.39.39.39.1.7.7"><mi id="S4.E15.m1.38.38.38.23.23.23" xref="S4.E15.m1.38.38.38.23.23.23.cmml">η</mi><mo lspace="0em" rspace="0em" id="S4.E15.m1.58.58.5.57.39.39.39.1.7.7.4" xref="S4.E15.m1.54.54.1.1.1.cmml">​</mo><msubsup id="S4.E15.m1.58.58.5.57.39.39.39.1.7.7.5"><mi class="ltx_font_mathcaligraphic" id="S4.E15.m1.39.39.39.24.24.24" xref="S4.E15.m1.39.39.39.24.24.24.cmml">ℒ</mi><mi id="S4.E15.m1.40.40.40.25.25.25.1" xref="S4.E15.m1.40.40.40.25.25.25.1.cmml">k</mi><mrow id="S4.E15.m1.41.41.41.26.26.26.1" xref="S4.E15.m1.41.41.41.26.26.26.1.cmml"><mi id="S4.E15.m1.41.41.41.26.26.26.1.2" xref="S4.E15.m1.41.41.41.26.26.26.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E15.m1.41.41.41.26.26.26.1.1" xref="S4.E15.m1.41.41.41.26.26.26.1.1.cmml">​</mo><mi id="S4.E15.m1.41.41.41.26.26.26.1.3" xref="S4.E15.m1.41.41.41.26.26.26.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E15.m1.41.41.41.26.26.26.1.1a" xref="S4.E15.m1.41.41.41.26.26.26.1.1.cmml">​</mo><mi id="S4.E15.m1.41.41.41.26.26.26.1.4" xref="S4.E15.m1.41.41.41.26.26.26.1.4.cmml">v</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E15.m1.58.58.5.57.39.39.39.1.7.7.4a" xref="S4.E15.m1.54.54.1.1.1.cmml">​</mo><mrow id="S4.E15.m1.58.58.5.57.39.39.39.1.7.7.3.3"><mo stretchy="false" id="S4.E15.m1.42.42.42.27.27.27" xref="S4.E15.m1.54.54.1.1.1.cmml">(</mo><msub id="S4.E15.m1.58.58.5.57.39.39.39.1.5.5.1.1.1"><mi id="S4.E15.m1.43.43.43.28.28.28" xref="S4.E15.m1.43.43.43.28.28.28.cmml">θ</mi><mi id="S4.E15.m1.44.44.44.29.29.29.1" xref="S4.E15.m1.44.44.44.29.29.29.1.cmml">k</mi></msub><mo id="S4.E15.m1.45.45.45.30.30.30" xref="S4.E15.m1.54.54.1.1.1.cmml">,</mo><msubsup id="S4.E15.m1.58.58.5.57.39.39.39.1.6.6.2.2.2"><mi id="S4.E15.m1.46.46.46.31.31.31" xref="S4.E15.m1.46.46.46.31.31.31.cmml">θ</mi><mi id="S4.E15.m1.47.47.47.32.32.32.1" xref="S4.E15.m1.47.47.47.32.32.32.1.cmml">k</mi><mo id="S4.E15.m1.48.48.48.33.33.33.1" xref="S4.E15.m1.48.48.48.33.33.33.1.cmml">′</mo></msubsup><mo id="S4.E15.m1.49.49.49.34.34.34" xref="S4.E15.m1.54.54.1.1.1.cmml">;</mo><msub id="S4.E15.m1.58.58.5.57.39.39.39.1.7.7.3.3.3"><mi mathvariant="normal" id="S4.E15.m1.50.50.50.35.35.35" xref="S4.E15.m1.50.50.50.35.35.35.cmml">Θ</mi><mi id="S4.E15.m1.51.51.51.36.36.36.1" xref="S4.E15.m1.51.51.51.36.36.36.1.cmml">k</mi></msub><mo stretchy="false" id="S4.E15.m1.52.52.52.37.37.37" xref="S4.E15.m1.54.54.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E15.m1.53.53.53.38.38.38" xref="S4.E15.m1.54.54.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E15.m1.58b"><apply id="S4.E15.m1.54.54.1.1.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><eq id="S4.E15.m1.16.16.16.1.1.1.cmml" xref="S4.E15.m1.16.16.16.1.1.1"></eq><apply id="S4.E15.m1.54.54.1.1.1.3.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><times id="S4.E15.m1.54.54.1.1.1.3.4.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"></times><apply id="S4.E15.m1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1"><list id="S4.E15.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.2"><apply id="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E15.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S4.E15.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.2.2.2.2">𝜃</ci><ci id="S4.E15.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply><ci id="S4.E15.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.2.2.3">′</ci></apply></list><ci id="S4.E15.m1.1.1.1.1.1.1.3a.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3"><mtext id="S4.E15.m1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3">min</mtext></ci></apply><apply id="S4.E15.m1.54.54.1.1.1.3.6.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.3.6.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">superscript</csymbol><apply id="S4.E15.m1.54.54.1.1.1.3.6.2.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.3.6.2.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.2.2.2.2.2.2.cmml" xref="S4.E15.m1.2.2.2.2.2.2">ℒ</ci><ci id="S4.E15.m1.3.3.3.3.3.3.1.cmml" xref="S4.E15.m1.3.3.3.3.3.3.1">𝑘</ci></apply><apply id="S4.E15.m1.4.4.4.4.4.4.1.cmml" xref="S4.E15.m1.4.4.4.4.4.4.1"><times id="S4.E15.m1.4.4.4.4.4.4.1.1.cmml" xref="S4.E15.m1.4.4.4.4.4.4.1.1"></times><ci id="S4.E15.m1.4.4.4.4.4.4.1.2.cmml" xref="S4.E15.m1.4.4.4.4.4.4.1.2">𝑠</ci><ci id="S4.E15.m1.4.4.4.4.4.4.1.3.cmml" xref="S4.E15.m1.4.4.4.4.4.4.1.3">𝑡</ci><ci id="S4.E15.m1.4.4.4.4.4.4.1.4a.cmml" xref="S4.E15.m1.4.4.4.4.4.4.1.4"><mtext mathsize="70%" id="S4.E15.m1.4.4.4.4.4.4.1.4.cmml" xref="S4.E15.m1.4.4.4.4.4.4.1.4">-</mtext></ci><cn type="integer" id="S4.E15.m1.4.4.4.4.4.4.1.5.cmml" xref="S4.E15.m1.4.4.4.4.4.4.1.5">1</cn></apply></apply><vector id="S4.E15.m1.54.54.1.1.1.3.3.4.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><apply id="S4.E15.m1.54.54.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.6.6.6.6.6.6.cmml" xref="S4.E15.m1.6.6.6.6.6.6">𝜃</ci><ci id="S4.E15.m1.7.7.7.7.7.7.1.cmml" xref="S4.E15.m1.7.7.7.7.7.7.1">𝑘</ci></apply><apply id="S4.E15.m1.54.54.1.1.1.2.2.2.2.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.2.2.2.2.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">superscript</csymbol><apply id="S4.E15.m1.54.54.1.1.1.2.2.2.2.2.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.9.9.9.9.9.9.cmml" xref="S4.E15.m1.9.9.9.9.9.9">𝜃</ci><ci id="S4.E15.m1.10.10.10.10.10.10.1.cmml" xref="S4.E15.m1.10.10.10.10.10.10.1">𝑘</ci></apply><ci id="S4.E15.m1.11.11.11.11.11.11.1.cmml" xref="S4.E15.m1.11.11.11.11.11.11.1">′</ci></apply><apply id="S4.E15.m1.54.54.1.1.1.3.3.3.3.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.3.3.3.3.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.13.13.13.13.13.13.cmml" xref="S4.E15.m1.13.13.13.13.13.13">Θ</ci><ci id="S4.E15.m1.14.14.14.14.14.14.1.cmml" xref="S4.E15.m1.14.14.14.14.14.14.1">𝑘</ci></apply></vector></apply><apply id="S4.E15.m1.54.54.1.1.1.10.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><minus id="S4.E15.m1.37.37.37.22.22.22.cmml" xref="S4.E15.m1.37.37.37.22.22.22"></minus><apply id="S4.E15.m1.54.54.1.1.1.7.4.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><plus id="S4.E15.m1.26.26.26.11.11.11.cmml" xref="S4.E15.m1.26.26.26.11.11.11"></plus><apply id="S4.E15.m1.54.54.1.1.1.5.2.2.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><times id="S4.E15.m1.54.54.1.1.1.5.2.2.3.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"></times><apply id="S4.E15.m1.54.54.1.1.1.5.2.2.4.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.5.2.2.4.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.17.17.17.2.2.2.cmml" xref="S4.E15.m1.17.17.17.2.2.2">ℒ</ci><ci id="S4.E15.m1.18.18.18.3.3.3.1.cmml" xref="S4.E15.m1.18.18.18.3.3.3.1">𝑘</ci></apply><list id="S4.E15.m1.54.54.1.1.1.5.2.2.2.3.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><apply id="S4.E15.m1.54.54.1.1.1.4.1.1.1.1.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.4.1.1.1.1.1.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.20.20.20.5.5.5.cmml" xref="S4.E15.m1.20.20.20.5.5.5">𝜃</ci><ci id="S4.E15.m1.21.21.21.6.6.6.1.cmml" xref="S4.E15.m1.21.21.21.6.6.6.1">𝑘</ci></apply><apply id="S4.E15.m1.54.54.1.1.1.5.2.2.2.2.2.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.5.2.2.2.2.2.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.23.23.23.8.8.8.cmml" xref="S4.E15.m1.23.23.23.8.8.8">Θ</ci><ci id="S4.E15.m1.24.24.24.9.9.9.1.cmml" xref="S4.E15.m1.24.24.24.9.9.9.1">𝑘</ci></apply></list></apply><apply id="S4.E15.m1.54.54.1.1.1.7.4.4.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><times id="S4.E15.m1.54.54.1.1.1.7.4.4.3.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"></times><apply id="S4.E15.m1.54.54.1.1.1.7.4.4.4.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.7.4.4.4.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.27.27.27.12.12.12.cmml" xref="S4.E15.m1.27.27.27.12.12.12">ℒ</ci><ci id="S4.E15.m1.28.28.28.13.13.13.1.cmml" xref="S4.E15.m1.28.28.28.13.13.13.1">𝑘</ci></apply><list id="S4.E15.m1.54.54.1.1.1.7.4.4.2.3.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><apply id="S4.E15.m1.54.54.1.1.1.6.3.3.1.1.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.6.3.3.1.1.1.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">superscript</csymbol><apply id="S4.E15.m1.54.54.1.1.1.6.3.3.1.1.1.2.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.6.3.3.1.1.1.2.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.30.30.30.15.15.15.cmml" xref="S4.E15.m1.30.30.30.15.15.15">𝜃</ci><ci id="S4.E15.m1.31.31.31.16.16.16.1.cmml" xref="S4.E15.m1.31.31.31.16.16.16.1">𝑘</ci></apply><ci id="S4.E15.m1.32.32.32.17.17.17.1.cmml" xref="S4.E15.m1.32.32.32.17.17.17.1">′</ci></apply><apply id="S4.E15.m1.54.54.1.1.1.7.4.4.2.2.2.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.7.4.4.2.2.2.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.34.34.34.19.19.19.cmml" xref="S4.E15.m1.34.34.34.19.19.19">Θ</ci><ci id="S4.E15.m1.35.35.35.20.20.20.1.cmml" xref="S4.E15.m1.35.35.35.20.20.20.1">𝑘</ci></apply></list></apply></apply><apply id="S4.E15.m1.54.54.1.1.1.10.7.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><times id="S4.E15.m1.54.54.1.1.1.10.7.4.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"></times><ci id="S4.E15.m1.38.38.38.23.23.23.cmml" xref="S4.E15.m1.38.38.38.23.23.23">𝜂</ci><apply id="S4.E15.m1.54.54.1.1.1.10.7.6.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.10.7.6.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">superscript</csymbol><apply id="S4.E15.m1.54.54.1.1.1.10.7.6.2.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.10.7.6.2.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.39.39.39.24.24.24.cmml" xref="S4.E15.m1.39.39.39.24.24.24">ℒ</ci><ci id="S4.E15.m1.40.40.40.25.25.25.1.cmml" xref="S4.E15.m1.40.40.40.25.25.25.1">𝑘</ci></apply><apply id="S4.E15.m1.41.41.41.26.26.26.1.cmml" xref="S4.E15.m1.41.41.41.26.26.26.1"><times id="S4.E15.m1.41.41.41.26.26.26.1.1.cmml" xref="S4.E15.m1.41.41.41.26.26.26.1.1"></times><ci id="S4.E15.m1.41.41.41.26.26.26.1.2.cmml" xref="S4.E15.m1.41.41.41.26.26.26.1.2">𝑎</ci><ci id="S4.E15.m1.41.41.41.26.26.26.1.3.cmml" xref="S4.E15.m1.41.41.41.26.26.26.1.3">𝑑</ci><ci id="S4.E15.m1.41.41.41.26.26.26.1.4.cmml" xref="S4.E15.m1.41.41.41.26.26.26.1.4">𝑣</ci></apply></apply><vector id="S4.E15.m1.54.54.1.1.1.10.7.3.4.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><apply id="S4.E15.m1.54.54.1.1.1.8.5.1.1.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.8.5.1.1.1.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.43.43.43.28.28.28.cmml" xref="S4.E15.m1.43.43.43.28.28.28">𝜃</ci><ci id="S4.E15.m1.44.44.44.29.29.29.1.cmml" xref="S4.E15.m1.44.44.44.29.29.29.1">𝑘</ci></apply><apply id="S4.E15.m1.54.54.1.1.1.9.6.2.2.2.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.9.6.2.2.2.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">superscript</csymbol><apply id="S4.E15.m1.54.54.1.1.1.9.6.2.2.2.2.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.9.6.2.2.2.2.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.46.46.46.31.31.31.cmml" xref="S4.E15.m1.46.46.46.31.31.31">𝜃</ci><ci id="S4.E15.m1.47.47.47.32.32.32.1.cmml" xref="S4.E15.m1.47.47.47.32.32.32.1">𝑘</ci></apply><ci id="S4.E15.m1.48.48.48.33.33.33.1.cmml" xref="S4.E15.m1.48.48.48.33.33.33.1">′</ci></apply><apply id="S4.E15.m1.54.54.1.1.1.10.7.3.3.3.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E15.m1.54.54.1.1.1.10.7.3.3.3.1.cmml" xref="S4.E15.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E15.m1.50.50.50.35.35.35.cmml" xref="S4.E15.m1.50.50.50.35.35.35">Θ</ci><ci id="S4.E15.m1.51.51.51.36.36.36.1.cmml" xref="S4.E15.m1.51.51.51.36.36.36.1">𝑘</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.58c">\underset{\theta_{k},\theta_{k}^{\prime}}{\text{min}}\ \mathcal{L}_{k}^{st\text{-}1}(\theta_{k},\theta_{k}^{\prime};\Theta_{k})\\
=\mathcal{L}_{k}(\theta_{k};\Theta_{k})+\mathcal{L}_{k}(\theta_{k}^{\prime};\Theta_{k})-\eta\mathcal{L}_{k}^{adv}(\theta_{k},\theta_{k}^{\prime};\Theta_{k}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.5" class="ltx_p"><span id="S4.I1.i2.p1.5.1" class="ltx_text ltx_font_bold">Training stage-2</span> is to minimize adversarial loss for learning the discriminative feature generator.
In this stage, we fix the classifiers <math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><msub id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml">θ</mi><mi id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.2">𝜃</ci><ci id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">\theta_{k}</annotation></semantics></math> and <math id="S4.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="\theta_{k}^{\prime}" display="inline"><semantics id="S4.I1.i2.p1.2.m2.1a"><msubsup id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.2.2" xref="S4.I1.i2.p1.2.m2.1.1.2.2.cmml">θ</mi><mi id="S4.I1.i2.p1.2.m2.1.1.2.3" xref="S4.I1.i2.p1.2.m2.1.1.2.3.cmml">k</mi><mo id="S4.I1.i2.p1.2.m2.1.1.3" xref="S4.I1.i2.p1.2.m2.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><apply id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">superscript</csymbol><apply id="S4.I1.i2.p1.2.m2.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.1.1.2.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.2.m2.1.1.2.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.2.2">𝜃</ci><ci id="S4.I1.i2.p1.2.m2.1.1.2.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S4.I1.i2.p1.2.m2.1.1.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">\theta_{k}^{\prime}</annotation></semantics></math> and train the generator <math id="S4.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="\Theta_{k}" display="inline"><semantics id="S4.I1.i2.p1.3.m3.1a"><msub id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml"><mi mathvariant="normal" id="S4.I1.i2.p1.3.m3.1.1.2" xref="S4.I1.i2.p1.3.m3.1.1.2.cmml">Θ</mi><mi id="S4.I1.i2.p1.3.m3.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><apply id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.3.m3.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2">Θ</ci><ci id="S4.I1.i2.p1.3.m3.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">\Theta_{k}</annotation></semantics></math> to minimize the discrepancy of the two classifiers measured by the adversarial loss.
The intuition is shown in Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.2.2. Learn a consistent feature space ‣ 4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>(stage-2):
by <span id="S4.I1.i2.p1.5.2" class="ltx_text ltx_font_italic">minimizing</span> (<a href="#S4.E14" title="In 1st item ‣ 4.2.3. Adversarial learning procedure ‣ 4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>), the feature generator <math id="S4.I1.i2.p1.4.m4.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S4.I1.i2.p1.4.m4.1a"><mi mathvariant="normal" id="S4.I1.i2.p1.4.m4.1.1" xref="S4.I1.i2.p1.4.m4.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.1b"><ci id="S4.I1.i2.p1.4.m4.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.1c">\Theta</annotation></semantics></math> is learning to push ambiguous data samples away from the decision boundaries, so that both classifiers could make the right predictions and their discrepancy gets reduced. As a result, the feature space (dashed circles) generated by <math id="S4.I1.i2.p1.5.m5.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S4.I1.i2.p1.5.m5.1a"><mi mathvariant="normal" id="S4.I1.i2.p1.5.m5.1.1" xref="S4.I1.i2.p1.5.m5.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.5.m5.1b"><ci id="S4.I1.i2.p1.5.m5.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.5.m5.1c">\Theta</annotation></semantics></math> is trained to be discriminative which produces larger inter-class margins.</p>
</div>
<div id="S4.I1.i2.p2" class="ltx_para">
<p id="S4.I1.i2.p2.3" class="ltx_p">Formally, we define the objective of stage-2 as a combination of local task objective <math id="S4.I1.i2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{k}" display="inline"><semantics id="S4.I1.i2.p2.1.m1.1a"><msub id="S4.I1.i2.p2.1.m1.1.1" xref="S4.I1.i2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p2.1.m1.1.1.2" xref="S4.I1.i2.p2.1.m1.1.1.2.cmml">ℒ</mi><mi id="S4.I1.i2.p2.1.m1.1.1.3" xref="S4.I1.i2.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p2.1.m1.1b"><apply id="S4.I1.i2.p2.1.m1.1.1.cmml" xref="S4.I1.i2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p2.1.m1.1.1.1.cmml" xref="S4.I1.i2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i2.p2.1.m1.1.1.2.cmml" xref="S4.I1.i2.p2.1.m1.1.1.2">ℒ</ci><ci id="S4.I1.i2.p2.1.m1.1.1.3.cmml" xref="S4.I1.i2.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p2.1.m1.1c">\mathcal{L}_{k}</annotation></semantics></math> and adversarial loss <math id="S4.I1.i2.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{k}^{adv}" display="inline"><semantics id="S4.I1.i2.p2.2.m2.1a"><msubsup id="S4.I1.i2.p2.2.m2.1.1" xref="S4.I1.i2.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p2.2.m2.1.1.2.2" xref="S4.I1.i2.p2.2.m2.1.1.2.2.cmml">ℒ</mi><mi id="S4.I1.i2.p2.2.m2.1.1.2.3" xref="S4.I1.i2.p2.2.m2.1.1.2.3.cmml">k</mi><mrow id="S4.I1.i2.p2.2.m2.1.1.3" xref="S4.I1.i2.p2.2.m2.1.1.3.cmml"><mi id="S4.I1.i2.p2.2.m2.1.1.3.2" xref="S4.I1.i2.p2.2.m2.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.I1.i2.p2.2.m2.1.1.3.1" xref="S4.I1.i2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.I1.i2.p2.2.m2.1.1.3.3" xref="S4.I1.i2.p2.2.m2.1.1.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.I1.i2.p2.2.m2.1.1.3.1a" xref="S4.I1.i2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.I1.i2.p2.2.m2.1.1.3.4" xref="S4.I1.i2.p2.2.m2.1.1.3.4.cmml">v</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p2.2.m2.1b"><apply id="S4.I1.i2.p2.2.m2.1.1.cmml" xref="S4.I1.i2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p2.2.m2.1.1.1.cmml" xref="S4.I1.i2.p2.2.m2.1.1">superscript</csymbol><apply id="S4.I1.i2.p2.2.m2.1.1.2.cmml" xref="S4.I1.i2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p2.2.m2.1.1.2.1.cmml" xref="S4.I1.i2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i2.p2.2.m2.1.1.2.2.cmml" xref="S4.I1.i2.p2.2.m2.1.1.2.2">ℒ</ci><ci id="S4.I1.i2.p2.2.m2.1.1.2.3.cmml" xref="S4.I1.i2.p2.2.m2.1.1.2.3">𝑘</ci></apply><apply id="S4.I1.i2.p2.2.m2.1.1.3.cmml" xref="S4.I1.i2.p2.2.m2.1.1.3"><times id="S4.I1.i2.p2.2.m2.1.1.3.1.cmml" xref="S4.I1.i2.p2.2.m2.1.1.3.1"></times><ci id="S4.I1.i2.p2.2.m2.1.1.3.2.cmml" xref="S4.I1.i2.p2.2.m2.1.1.3.2">𝑎</ci><ci id="S4.I1.i2.p2.2.m2.1.1.3.3.cmml" xref="S4.I1.i2.p2.2.m2.1.1.3.3">𝑑</ci><ci id="S4.I1.i2.p2.2.m2.1.1.3.4.cmml" xref="S4.I1.i2.p2.2.m2.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p2.2.m2.1c">\mathcal{L}_{k}^{adv}</annotation></semantics></math> with weight <math id="S4.I1.i2.p2.3.m3.1" class="ltx_Math" alttext="\lambda&gt;0" display="inline"><semantics id="S4.I1.i2.p2.3.m3.1a"><mrow id="S4.I1.i2.p2.3.m3.1.1" xref="S4.I1.i2.p2.3.m3.1.1.cmml"><mi id="S4.I1.i2.p2.3.m3.1.1.2" xref="S4.I1.i2.p2.3.m3.1.1.2.cmml">λ</mi><mo id="S4.I1.i2.p2.3.m3.1.1.1" xref="S4.I1.i2.p2.3.m3.1.1.1.cmml">&gt;</mo><mn id="S4.I1.i2.p2.3.m3.1.1.3" xref="S4.I1.i2.p2.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p2.3.m3.1b"><apply id="S4.I1.i2.p2.3.m3.1.1.cmml" xref="S4.I1.i2.p2.3.m3.1.1"><gt id="S4.I1.i2.p2.3.m3.1.1.1.cmml" xref="S4.I1.i2.p2.3.m3.1.1.1"></gt><ci id="S4.I1.i2.p2.3.m3.1.1.2.cmml" xref="S4.I1.i2.p2.3.m3.1.1.2">𝜆</ci><cn type="integer" id="S4.I1.i2.p2.3.m3.1.1.3.cmml" xref="S4.I1.i2.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p2.3.m3.1c">\lambda&gt;0</annotation></semantics></math> such that</p>
<table id="S4.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(16)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E16.m1.58" class="ltx_Math" alttext="\underset{\Theta_{k}}{\text{min}}\ \mathcal{L}_{k}^{st\text{-}2}(\Theta_{k};\theta_{k},\theta_{k}^{\prime})\\
=\mathcal{L}_{k}(\Theta_{k};\theta_{k})+\mathcal{L}_{k}(\Theta_{k};\theta_{k}^{\prime})+\lambda\mathcal{L}_{k}^{adv}(\Theta_{k};\theta_{k},\theta_{k}^{\prime})." display="block"><semantics id="S4.E16.m1.58a"><mtable displaystyle="true" rowspacing="0pt" id="S4.E16.m1.58.58.5"><mtr id="S4.E16.m1.58.58.5a"><mtd class="ltx_align_left" columnalign="left" id="S4.E16.m1.58.58.5b"><mrow id="S4.E16.m1.57.57.4.56.18.18"><munder accentunder="true" id="S4.E16.m1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.cmml"><mtext id="S4.E16.m1.1.1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.1.1.2a.cmml">min</mtext><msub id="S4.E16.m1.1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E16.m1.1.1.1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.1.1.1.2.cmml">Θ</mi><mi id="S4.E16.m1.1.1.1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.1.1.1.3.cmml">k</mi></msub></munder><mo lspace="0.500em" rspace="0em" id="S4.E16.m1.57.57.4.56.18.18.19" xref="S4.E16.m1.54.54.1.1.1.cmml">​</mo><msubsup id="S4.E16.m1.57.57.4.56.18.18.20"><mi class="ltx_font_mathcaligraphic" id="S4.E16.m1.2.2.2.2.2.2" xref="S4.E16.m1.2.2.2.2.2.2.cmml">ℒ</mi><mi id="S4.E16.m1.3.3.3.3.3.3.1" xref="S4.E16.m1.3.3.3.3.3.3.1.cmml">k</mi><mrow id="S4.E16.m1.4.4.4.4.4.4.1" xref="S4.E16.m1.4.4.4.4.4.4.1.cmml"><mi id="S4.E16.m1.4.4.4.4.4.4.1.2" xref="S4.E16.m1.4.4.4.4.4.4.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.4.4.4.4.4.4.1.1" xref="S4.E16.m1.4.4.4.4.4.4.1.1.cmml">​</mo><mi id="S4.E16.m1.4.4.4.4.4.4.1.3" xref="S4.E16.m1.4.4.4.4.4.4.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.4.4.4.4.4.4.1.1a" xref="S4.E16.m1.4.4.4.4.4.4.1.1.cmml">​</mo><mtext id="S4.E16.m1.4.4.4.4.4.4.1.4" xref="S4.E16.m1.4.4.4.4.4.4.1.4a.cmml">-</mtext><mo lspace="0em" rspace="0em" id="S4.E16.m1.4.4.4.4.4.4.1.1b" xref="S4.E16.m1.4.4.4.4.4.4.1.1.cmml">​</mo><mn id="S4.E16.m1.4.4.4.4.4.4.1.5" xref="S4.E16.m1.4.4.4.4.4.4.1.5.cmml">2</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E16.m1.57.57.4.56.18.18.19a" xref="S4.E16.m1.54.54.1.1.1.cmml">​</mo><mrow id="S4.E16.m1.57.57.4.56.18.18.18.3"><mo stretchy="false" id="S4.E16.m1.5.5.5.5.5.5" xref="S4.E16.m1.54.54.1.1.1.cmml">(</mo><msub id="S4.E16.m1.55.55.2.54.16.16.16.1.1"><mi mathvariant="normal" id="S4.E16.m1.6.6.6.6.6.6" xref="S4.E16.m1.6.6.6.6.6.6.cmml">Θ</mi><mi id="S4.E16.m1.7.7.7.7.7.7.1" xref="S4.E16.m1.7.7.7.7.7.7.1.cmml">k</mi></msub><mo id="S4.E16.m1.8.8.8.8.8.8" xref="S4.E16.m1.54.54.1.1.1.cmml">;</mo><msub id="S4.E16.m1.56.56.3.55.17.17.17.2.2"><mi id="S4.E16.m1.9.9.9.9.9.9" xref="S4.E16.m1.9.9.9.9.9.9.cmml">θ</mi><mi id="S4.E16.m1.10.10.10.10.10.10.1" xref="S4.E16.m1.10.10.10.10.10.10.1.cmml">k</mi></msub><mo id="S4.E16.m1.11.11.11.11.11.11" xref="S4.E16.m1.54.54.1.1.1.cmml">,</mo><msubsup id="S4.E16.m1.57.57.4.56.18.18.18.3.3"><mi id="S4.E16.m1.12.12.12.12.12.12" xref="S4.E16.m1.12.12.12.12.12.12.cmml">θ</mi><mi id="S4.E16.m1.13.13.13.13.13.13.1" xref="S4.E16.m1.13.13.13.13.13.13.1.cmml">k</mi><mo id="S4.E16.m1.14.14.14.14.14.14.1" xref="S4.E16.m1.14.14.14.14.14.14.1.cmml">′</mo></msubsup><mo stretchy="false" id="S4.E16.m1.15.15.15.15.15.15" xref="S4.E16.m1.54.54.1.1.1.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S4.E16.m1.58.58.5c"><mtd class="ltx_align_right" columnalign="right" id="S4.E16.m1.58.58.5d"><mrow id="S4.E16.m1.58.58.5.57.39.39.39"><mrow id="S4.E16.m1.58.58.5.57.39.39.39.1"><mi id="S4.E16.m1.58.58.5.57.39.39.39.1.8" xref="S4.E16.m1.54.54.1.1.1.cmml"></mi><mo id="S4.E16.m1.16.16.16.1.1.1" xref="S4.E16.m1.16.16.16.1.1.1.cmml">=</mo><mrow id="S4.E16.m1.58.58.5.57.39.39.39.1.7"><mrow id="S4.E16.m1.58.58.5.57.39.39.39.1.2.2"><msub id="S4.E16.m1.58.58.5.57.39.39.39.1.2.2.4"><mi class="ltx_font_mathcaligraphic" id="S4.E16.m1.17.17.17.2.2.2" xref="S4.E16.m1.17.17.17.2.2.2.cmml">ℒ</mi><mi id="S4.E16.m1.18.18.18.3.3.3.1" xref="S4.E16.m1.18.18.18.3.3.3.1.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E16.m1.58.58.5.57.39.39.39.1.2.2.3" xref="S4.E16.m1.54.54.1.1.1.cmml">​</mo><mrow id="S4.E16.m1.58.58.5.57.39.39.39.1.2.2.2.2"><mo stretchy="false" id="S4.E16.m1.19.19.19.4.4.4" xref="S4.E16.m1.54.54.1.1.1.cmml">(</mo><msub id="S4.E16.m1.58.58.5.57.39.39.39.1.1.1.1.1.1"><mi mathvariant="normal" id="S4.E16.m1.20.20.20.5.5.5" xref="S4.E16.m1.20.20.20.5.5.5.cmml">Θ</mi><mi id="S4.E16.m1.21.21.21.6.6.6.1" xref="S4.E16.m1.21.21.21.6.6.6.1.cmml">k</mi></msub><mo id="S4.E16.m1.22.22.22.7.7.7" xref="S4.E16.m1.54.54.1.1.1.cmml">;</mo><msub id="S4.E16.m1.58.58.5.57.39.39.39.1.2.2.2.2.2"><mi id="S4.E16.m1.23.23.23.8.8.8" xref="S4.E16.m1.23.23.23.8.8.8.cmml">θ</mi><mi id="S4.E16.m1.24.24.24.9.9.9.1" xref="S4.E16.m1.24.24.24.9.9.9.1.cmml">k</mi></msub><mo stretchy="false" id="S4.E16.m1.25.25.25.10.10.10" xref="S4.E16.m1.54.54.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E16.m1.26.26.26.11.11.11" xref="S4.E16.m1.26.26.26.11.11.11.cmml">+</mo><mrow id="S4.E16.m1.58.58.5.57.39.39.39.1.4.4"><msub id="S4.E16.m1.58.58.5.57.39.39.39.1.4.4.4"><mi class="ltx_font_mathcaligraphic" id="S4.E16.m1.27.27.27.12.12.12" xref="S4.E16.m1.27.27.27.12.12.12.cmml">ℒ</mi><mi id="S4.E16.m1.28.28.28.13.13.13.1" xref="S4.E16.m1.28.28.28.13.13.13.1.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E16.m1.58.58.5.57.39.39.39.1.4.4.3" xref="S4.E16.m1.54.54.1.1.1.cmml">​</mo><mrow id="S4.E16.m1.58.58.5.57.39.39.39.1.4.4.2.2"><mo stretchy="false" id="S4.E16.m1.29.29.29.14.14.14" xref="S4.E16.m1.54.54.1.1.1.cmml">(</mo><msub id="S4.E16.m1.58.58.5.57.39.39.39.1.3.3.1.1.1"><mi mathvariant="normal" id="S4.E16.m1.30.30.30.15.15.15" xref="S4.E16.m1.30.30.30.15.15.15.cmml">Θ</mi><mi id="S4.E16.m1.31.31.31.16.16.16.1" xref="S4.E16.m1.31.31.31.16.16.16.1.cmml">k</mi></msub><mo id="S4.E16.m1.32.32.32.17.17.17" xref="S4.E16.m1.54.54.1.1.1.cmml">;</mo><msubsup id="S4.E16.m1.58.58.5.57.39.39.39.1.4.4.2.2.2"><mi id="S4.E16.m1.33.33.33.18.18.18" xref="S4.E16.m1.33.33.33.18.18.18.cmml">θ</mi><mi id="S4.E16.m1.34.34.34.19.19.19.1" xref="S4.E16.m1.34.34.34.19.19.19.1.cmml">k</mi><mo id="S4.E16.m1.35.35.35.20.20.20.1" xref="S4.E16.m1.35.35.35.20.20.20.1.cmml">′</mo></msubsup><mo stretchy="false" id="S4.E16.m1.36.36.36.21.21.21" xref="S4.E16.m1.54.54.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E16.m1.26.26.26.11.11.11a" xref="S4.E16.m1.26.26.26.11.11.11.cmml">+</mo><mrow id="S4.E16.m1.58.58.5.57.39.39.39.1.7.7"><mi id="S4.E16.m1.38.38.38.23.23.23" xref="S4.E16.m1.38.38.38.23.23.23.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.58.58.5.57.39.39.39.1.7.7.4" xref="S4.E16.m1.54.54.1.1.1.cmml">​</mo><msubsup id="S4.E16.m1.58.58.5.57.39.39.39.1.7.7.5"><mi class="ltx_font_mathcaligraphic" id="S4.E16.m1.39.39.39.24.24.24" xref="S4.E16.m1.39.39.39.24.24.24.cmml">ℒ</mi><mi id="S4.E16.m1.40.40.40.25.25.25.1" xref="S4.E16.m1.40.40.40.25.25.25.1.cmml">k</mi><mrow id="S4.E16.m1.41.41.41.26.26.26.1" xref="S4.E16.m1.41.41.41.26.26.26.1.cmml"><mi id="S4.E16.m1.41.41.41.26.26.26.1.2" xref="S4.E16.m1.41.41.41.26.26.26.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.41.41.41.26.26.26.1.1" xref="S4.E16.m1.41.41.41.26.26.26.1.1.cmml">​</mo><mi id="S4.E16.m1.41.41.41.26.26.26.1.3" xref="S4.E16.m1.41.41.41.26.26.26.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.41.41.41.26.26.26.1.1a" xref="S4.E16.m1.41.41.41.26.26.26.1.1.cmml">​</mo><mi id="S4.E16.m1.41.41.41.26.26.26.1.4" xref="S4.E16.m1.41.41.41.26.26.26.1.4.cmml">v</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E16.m1.58.58.5.57.39.39.39.1.7.7.4a" xref="S4.E16.m1.54.54.1.1.1.cmml">​</mo><mrow id="S4.E16.m1.58.58.5.57.39.39.39.1.7.7.3.3"><mo stretchy="false" id="S4.E16.m1.42.42.42.27.27.27" xref="S4.E16.m1.54.54.1.1.1.cmml">(</mo><msub id="S4.E16.m1.58.58.5.57.39.39.39.1.5.5.1.1.1"><mi mathvariant="normal" id="S4.E16.m1.43.43.43.28.28.28" xref="S4.E16.m1.43.43.43.28.28.28.cmml">Θ</mi><mi id="S4.E16.m1.44.44.44.29.29.29.1" xref="S4.E16.m1.44.44.44.29.29.29.1.cmml">k</mi></msub><mo id="S4.E16.m1.45.45.45.30.30.30" xref="S4.E16.m1.54.54.1.1.1.cmml">;</mo><msub id="S4.E16.m1.58.58.5.57.39.39.39.1.6.6.2.2.2"><mi id="S4.E16.m1.46.46.46.31.31.31" xref="S4.E16.m1.46.46.46.31.31.31.cmml">θ</mi><mi id="S4.E16.m1.47.47.47.32.32.32.1" xref="S4.E16.m1.47.47.47.32.32.32.1.cmml">k</mi></msub><mo id="S4.E16.m1.48.48.48.33.33.33" xref="S4.E16.m1.54.54.1.1.1.cmml">,</mo><msubsup id="S4.E16.m1.58.58.5.57.39.39.39.1.7.7.3.3.3"><mi id="S4.E16.m1.49.49.49.34.34.34" xref="S4.E16.m1.49.49.49.34.34.34.cmml">θ</mi><mi id="S4.E16.m1.50.50.50.35.35.35.1" xref="S4.E16.m1.50.50.50.35.35.35.1.cmml">k</mi><mo id="S4.E16.m1.51.51.51.36.36.36.1" xref="S4.E16.m1.51.51.51.36.36.36.1.cmml">′</mo></msubsup><mo stretchy="false" id="S4.E16.m1.52.52.52.37.37.37" xref="S4.E16.m1.54.54.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E16.m1.53.53.53.38.38.38" xref="S4.E16.m1.54.54.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E16.m1.58b"><apply id="S4.E16.m1.54.54.1.1.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><eq id="S4.E16.m1.16.16.16.1.1.1.cmml" xref="S4.E16.m1.16.16.16.1.1.1"></eq><apply id="S4.E16.m1.54.54.1.1.1.3.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><times id="S4.E16.m1.54.54.1.1.1.3.4.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"></times><apply id="S4.E16.m1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1"><apply id="S4.E16.m1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.2">Θ</ci><ci id="S4.E16.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.3">𝑘</ci></apply><ci id="S4.E16.m1.1.1.1.1.1.1.2a.cmml" xref="S4.E16.m1.1.1.1.1.1.1.2"><mtext id="S4.E16.m1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.2">min</mtext></ci></apply><apply id="S4.E16.m1.54.54.1.1.1.3.6.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.3.6.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">superscript</csymbol><apply id="S4.E16.m1.54.54.1.1.1.3.6.2.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.3.6.2.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.2.2.2.2.2.2.cmml" xref="S4.E16.m1.2.2.2.2.2.2">ℒ</ci><ci id="S4.E16.m1.3.3.3.3.3.3.1.cmml" xref="S4.E16.m1.3.3.3.3.3.3.1">𝑘</ci></apply><apply id="S4.E16.m1.4.4.4.4.4.4.1.cmml" xref="S4.E16.m1.4.4.4.4.4.4.1"><times id="S4.E16.m1.4.4.4.4.4.4.1.1.cmml" xref="S4.E16.m1.4.4.4.4.4.4.1.1"></times><ci id="S4.E16.m1.4.4.4.4.4.4.1.2.cmml" xref="S4.E16.m1.4.4.4.4.4.4.1.2">𝑠</ci><ci id="S4.E16.m1.4.4.4.4.4.4.1.3.cmml" xref="S4.E16.m1.4.4.4.4.4.4.1.3">𝑡</ci><ci id="S4.E16.m1.4.4.4.4.4.4.1.4a.cmml" xref="S4.E16.m1.4.4.4.4.4.4.1.4"><mtext mathsize="70%" id="S4.E16.m1.4.4.4.4.4.4.1.4.cmml" xref="S4.E16.m1.4.4.4.4.4.4.1.4">-</mtext></ci><cn type="integer" id="S4.E16.m1.4.4.4.4.4.4.1.5.cmml" xref="S4.E16.m1.4.4.4.4.4.4.1.5">2</cn></apply></apply><list id="S4.E16.m1.54.54.1.1.1.3.3.4.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><apply id="S4.E16.m1.54.54.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.6.6.6.6.6.6.cmml" xref="S4.E16.m1.6.6.6.6.6.6">Θ</ci><ci id="S4.E16.m1.7.7.7.7.7.7.1.cmml" xref="S4.E16.m1.7.7.7.7.7.7.1">𝑘</ci></apply><apply id="S4.E16.m1.54.54.1.1.1.2.2.2.2.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.2.2.2.2.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.9.9.9.9.9.9.cmml" xref="S4.E16.m1.9.9.9.9.9.9">𝜃</ci><ci id="S4.E16.m1.10.10.10.10.10.10.1.cmml" xref="S4.E16.m1.10.10.10.10.10.10.1">𝑘</ci></apply><apply id="S4.E16.m1.54.54.1.1.1.3.3.3.3.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.3.3.3.3.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">superscript</csymbol><apply id="S4.E16.m1.54.54.1.1.1.3.3.3.3.2.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.3.3.3.3.2.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.12.12.12.12.12.12.cmml" xref="S4.E16.m1.12.12.12.12.12.12">𝜃</ci><ci id="S4.E16.m1.13.13.13.13.13.13.1.cmml" xref="S4.E16.m1.13.13.13.13.13.13.1">𝑘</ci></apply><ci id="S4.E16.m1.14.14.14.14.14.14.1.cmml" xref="S4.E16.m1.14.14.14.14.14.14.1">′</ci></apply></list></apply><apply id="S4.E16.m1.54.54.1.1.1.10.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><plus id="S4.E16.m1.26.26.26.11.11.11.cmml" xref="S4.E16.m1.26.26.26.11.11.11"></plus><apply id="S4.E16.m1.54.54.1.1.1.5.2.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><times id="S4.E16.m1.54.54.1.1.1.5.2.3.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"></times><apply id="S4.E16.m1.54.54.1.1.1.5.2.4.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.5.2.4.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.17.17.17.2.2.2.cmml" xref="S4.E16.m1.17.17.17.2.2.2">ℒ</ci><ci id="S4.E16.m1.18.18.18.3.3.3.1.cmml" xref="S4.E16.m1.18.18.18.3.3.3.1">𝑘</ci></apply><list id="S4.E16.m1.54.54.1.1.1.5.2.2.3.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><apply id="S4.E16.m1.54.54.1.1.1.4.1.1.1.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.4.1.1.1.1.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.20.20.20.5.5.5.cmml" xref="S4.E16.m1.20.20.20.5.5.5">Θ</ci><ci id="S4.E16.m1.21.21.21.6.6.6.1.cmml" xref="S4.E16.m1.21.21.21.6.6.6.1">𝑘</ci></apply><apply id="S4.E16.m1.54.54.1.1.1.5.2.2.2.2.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.5.2.2.2.2.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.23.23.23.8.8.8.cmml" xref="S4.E16.m1.23.23.23.8.8.8">𝜃</ci><ci id="S4.E16.m1.24.24.24.9.9.9.1.cmml" xref="S4.E16.m1.24.24.24.9.9.9.1">𝑘</ci></apply></list></apply><apply id="S4.E16.m1.54.54.1.1.1.7.4.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><times id="S4.E16.m1.54.54.1.1.1.7.4.3.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"></times><apply id="S4.E16.m1.54.54.1.1.1.7.4.4.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.7.4.4.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.27.27.27.12.12.12.cmml" xref="S4.E16.m1.27.27.27.12.12.12">ℒ</ci><ci id="S4.E16.m1.28.28.28.13.13.13.1.cmml" xref="S4.E16.m1.28.28.28.13.13.13.1">𝑘</ci></apply><list id="S4.E16.m1.54.54.1.1.1.7.4.2.3.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><apply id="S4.E16.m1.54.54.1.1.1.6.3.1.1.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.6.3.1.1.1.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.30.30.30.15.15.15.cmml" xref="S4.E16.m1.30.30.30.15.15.15">Θ</ci><ci id="S4.E16.m1.31.31.31.16.16.16.1.cmml" xref="S4.E16.m1.31.31.31.16.16.16.1">𝑘</ci></apply><apply id="S4.E16.m1.54.54.1.1.1.7.4.2.2.2.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.7.4.2.2.2.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">superscript</csymbol><apply id="S4.E16.m1.54.54.1.1.1.7.4.2.2.2.2.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.7.4.2.2.2.2.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.33.33.33.18.18.18.cmml" xref="S4.E16.m1.33.33.33.18.18.18">𝜃</ci><ci id="S4.E16.m1.34.34.34.19.19.19.1.cmml" xref="S4.E16.m1.34.34.34.19.19.19.1">𝑘</ci></apply><ci id="S4.E16.m1.35.35.35.20.20.20.1.cmml" xref="S4.E16.m1.35.35.35.20.20.20.1">′</ci></apply></list></apply><apply id="S4.E16.m1.54.54.1.1.1.10.7.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><times id="S4.E16.m1.54.54.1.1.1.10.7.4.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"></times><ci id="S4.E16.m1.38.38.38.23.23.23.cmml" xref="S4.E16.m1.38.38.38.23.23.23">𝜆</ci><apply id="S4.E16.m1.54.54.1.1.1.10.7.6.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.10.7.6.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">superscript</csymbol><apply id="S4.E16.m1.54.54.1.1.1.10.7.6.2.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.10.7.6.2.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.39.39.39.24.24.24.cmml" xref="S4.E16.m1.39.39.39.24.24.24">ℒ</ci><ci id="S4.E16.m1.40.40.40.25.25.25.1.cmml" xref="S4.E16.m1.40.40.40.25.25.25.1">𝑘</ci></apply><apply id="S4.E16.m1.41.41.41.26.26.26.1.cmml" xref="S4.E16.m1.41.41.41.26.26.26.1"><times id="S4.E16.m1.41.41.41.26.26.26.1.1.cmml" xref="S4.E16.m1.41.41.41.26.26.26.1.1"></times><ci id="S4.E16.m1.41.41.41.26.26.26.1.2.cmml" xref="S4.E16.m1.41.41.41.26.26.26.1.2">𝑎</ci><ci id="S4.E16.m1.41.41.41.26.26.26.1.3.cmml" xref="S4.E16.m1.41.41.41.26.26.26.1.3">𝑑</ci><ci id="S4.E16.m1.41.41.41.26.26.26.1.4.cmml" xref="S4.E16.m1.41.41.41.26.26.26.1.4">𝑣</ci></apply></apply><list id="S4.E16.m1.54.54.1.1.1.10.7.3.4.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><apply id="S4.E16.m1.54.54.1.1.1.8.5.1.1.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.8.5.1.1.1.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.43.43.43.28.28.28.cmml" xref="S4.E16.m1.43.43.43.28.28.28">Θ</ci><ci id="S4.E16.m1.44.44.44.29.29.29.1.cmml" xref="S4.E16.m1.44.44.44.29.29.29.1">𝑘</ci></apply><apply id="S4.E16.m1.54.54.1.1.1.9.6.2.2.2.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.9.6.2.2.2.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.46.46.46.31.31.31.cmml" xref="S4.E16.m1.46.46.46.31.31.31">𝜃</ci><ci id="S4.E16.m1.47.47.47.32.32.32.1.cmml" xref="S4.E16.m1.47.47.47.32.32.32.1">𝑘</ci></apply><apply id="S4.E16.m1.54.54.1.1.1.10.7.3.3.3.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.10.7.3.3.3.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">superscript</csymbol><apply id="S4.E16.m1.54.54.1.1.1.10.7.3.3.3.2.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19"><csymbol cd="ambiguous" id="S4.E16.m1.54.54.1.1.1.10.7.3.3.3.2.1.cmml" xref="S4.E16.m1.57.57.4.56.18.18.19">subscript</csymbol><ci id="S4.E16.m1.49.49.49.34.34.34.cmml" xref="S4.E16.m1.49.49.49.34.34.34">𝜃</ci><ci id="S4.E16.m1.50.50.50.35.35.35.1.cmml" xref="S4.E16.m1.50.50.50.35.35.35.1">𝑘</ci></apply><ci id="S4.E16.m1.51.51.51.36.36.36.1.cmml" xref="S4.E16.m1.51.51.51.36.36.36.1">′</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.58c">\underset{\Theta_{k}}{\text{min}}\ \mathcal{L}_{k}^{st\text{-}2}(\Theta_{k};\theta_{k},\theta_{k}^{\prime})\\
=\mathcal{L}_{k}(\Theta_{k};\theta_{k})+\mathcal{L}_{k}(\Theta_{k};\theta_{k}^{\prime})+\lambda\mathcal{L}_{k}^{adv}(\Theta_{k};\theta_{k},\theta_{k}^{\prime}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</li>
</ul>
</div>
<div id="S4.SS2.SSS3.p3" class="ltx_para">
<p id="S4.SS2.SSS3.p3.1" class="ltx_p">By training the classifiers and the feature generator in an adversarial manner, we iteratively optimize the model to learn a discriminative feature generator which helps boost few-shot learning on unseen tasks.</p>
</div>
<div id="S4.SS2.SSS3.p4" class="ltx_para">
<p id="S4.SS2.SSS3.p4.1" class="ltx_p">In our toy example, the feature generator learned by cat and dog images is likely to distinguish these two categories by eyes and ears and other unique features of these two species. Thus, cat-like and dog-like images are projected with large margins in the feature space learned explicitly by our approach. This space is transferable to tasks such as classifying tiger and wolf images. In reality, the richer and more representative are the base classes, the more discriminative the feature space will be.
Recently, centralized machine learning models <cite class="ltx_cite ltx_citemacro_citep">(Sharif Razavian et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2014</a>; Vaswani et al<span class="ltx_text">.</span>, <a href="#bib.bib38" title="" class="ltx_ref">2017</a>)</cite> have been shown to be capable of learning generic and versatile feature spaces on complex structured data such as images and texts. We have shown that such a feature space can also be efficiently learned in distributed scenarios.</p>
</div>
<div id="S4.SS2.SSS3.p5" class="ltx_para">
<p id="S4.SS2.SSS3.p5.1" class="ltx_p">In conclusion, we have proposed a novel way of learning a discriminative feature space in FedFSL with an adversarial learning strategy.
We summarize FedFSL-MI-Adv in Algorithm <a href="#alg2" title="In 4.2.3. Adversarial learning procedure ‣ 4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="alg2" class="ltx_float ltx_algorithm">
<div id="alg2.26" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg2.3.3" class="ltx_listingline">
<span id="alg2.3.3.4" class="ltx_text" style="font-size:90%;"><span id="alg2.3.3.4.1" class="ltx_text ltx_font_bold">Input:</span> </span><span id="alg2.3.3.3" class="ltx_text" style="font-size:90%;">A set of <math id="alg2.1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg2.1.1.1.m1.1a"><mi id="alg2.1.1.1.m1.1.1" xref="alg2.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.1.1.1.m1.1b"><ci id="alg2.1.1.1.m1.1.1.cmml" xref="alg2.1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.1.m1.1c">K</annotation></semantics></math> federated clients. A local FSL objective <math id="alg2.2.2.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{k}" display="inline"><semantics id="alg2.2.2.2.m2.1a"><msub id="alg2.2.2.2.m2.1.1" xref="alg2.2.2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.2.2.2.m2.1.1.2" xref="alg2.2.2.2.m2.1.1.2.cmml">ℒ</mi><mi id="alg2.2.2.2.m2.1.1.3" xref="alg2.2.2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.2.2.2.m2.1b"><apply id="alg2.2.2.2.m2.1.1.cmml" xref="alg2.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.2.2.2.m2.1.1.1.cmml" xref="alg2.2.2.2.m2.1.1">subscript</csymbol><ci id="alg2.2.2.2.m2.1.1.2.cmml" xref="alg2.2.2.2.m2.1.1.2">ℒ</ci><ci id="alg2.2.2.2.m2.1.1.3.cmml" xref="alg2.2.2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.2.m2.1c">\mathcal{L}_{k}</annotation></semantics></math> for each client <math id="alg2.3.3.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg2.3.3.3.m3.1a"><mi id="alg2.3.3.3.m3.1.1" xref="alg2.3.3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.3.3.3.m3.1b"><ci id="alg2.3.3.3.m3.1.1.cmml" xref="alg2.3.3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.3.3.m3.1c">k</annotation></semantics></math>.
</span>
</div>
<div id="alg2.4.4" class="ltx_listingline">
<span id="alg2.4.4.1" class="ltx_text" style="font-size:90%;">
</span><span id="alg2.4.4.2" class="ltx_text" style="font-size:90%;"><span id="alg2.4.4.2.1" class="ltx_text ltx_font_bold">Output:</span> </span><span id="alg2.4.4.3" class="ltx_text" style="font-size:90%;">A global model </span><math id="alg2.4.4.m1.2" class="ltx_Math" alttext="w=[\Theta,\theta]" display="inline"><semantics id="alg2.4.4.m1.2a"><mrow id="alg2.4.4.m1.2.3" xref="alg2.4.4.m1.2.3.cmml"><mi mathsize="90%" id="alg2.4.4.m1.2.3.2" xref="alg2.4.4.m1.2.3.2.cmml">w</mi><mo mathsize="90%" id="alg2.4.4.m1.2.3.1" xref="alg2.4.4.m1.2.3.1.cmml">=</mo><mrow id="alg2.4.4.m1.2.3.3.2" xref="alg2.4.4.m1.2.3.3.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.4.4.m1.2.3.3.2.1" xref="alg2.4.4.m1.2.3.3.1.cmml">[</mo><mi mathsize="90%" mathvariant="normal" id="alg2.4.4.m1.1.1" xref="alg2.4.4.m1.1.1.cmml">Θ</mi><mo mathsize="90%" id="alg2.4.4.m1.2.3.3.2.2" xref="alg2.4.4.m1.2.3.3.1.cmml">,</mo><mi mathsize="90%" id="alg2.4.4.m1.2.2" xref="alg2.4.4.m1.2.2.cmml">θ</mi><mo maxsize="90%" minsize="90%" id="alg2.4.4.m1.2.3.3.2.3" xref="alg2.4.4.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.4.4.m1.2b"><apply id="alg2.4.4.m1.2.3.cmml" xref="alg2.4.4.m1.2.3"><eq id="alg2.4.4.m1.2.3.1.cmml" xref="alg2.4.4.m1.2.3.1"></eq><ci id="alg2.4.4.m1.2.3.2.cmml" xref="alg2.4.4.m1.2.3.2">𝑤</ci><interval closure="closed" id="alg2.4.4.m1.2.3.3.1.cmml" xref="alg2.4.4.m1.2.3.3.2"><ci id="alg2.4.4.m1.1.1.cmml" xref="alg2.4.4.m1.1.1">Θ</ci><ci id="alg2.4.4.m1.2.2.cmml" xref="alg2.4.4.m1.2.2">𝜃</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.4.m1.2c">w=[\Theta,\theta]</annotation></semantics></math><span id="alg2.4.4.4" class="ltx_text" style="font-size:90%;"> optimized for FSL task.</span>
</div>
<div id="alg2.26.27" class="ltx_listingline">
<span id="alg2.26.27.1" class="ltx_text" style="font-size:90%;">
</span><span id="alg2.26.27.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Server executes:</span><span id="alg2.26.27.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.5.5" class="ltx_listingline">
<span id="alg2.5.5.1" class="ltx_text" style="font-size:90%;">
Initialize global model </span><math id="alg2.5.5.m1.2" class="ltx_Math" alttext="w^{0}=[\Theta^{0},\theta^{0}]" display="inline"><semantics id="alg2.5.5.m1.2a"><mrow id="alg2.5.5.m1.2.2" xref="alg2.5.5.m1.2.2.cmml"><msup id="alg2.5.5.m1.2.2.4" xref="alg2.5.5.m1.2.2.4.cmml"><mi mathsize="90%" id="alg2.5.5.m1.2.2.4.2" xref="alg2.5.5.m1.2.2.4.2.cmml">w</mi><mn mathsize="90%" id="alg2.5.5.m1.2.2.4.3" xref="alg2.5.5.m1.2.2.4.3.cmml">0</mn></msup><mo mathsize="90%" id="alg2.5.5.m1.2.2.3" xref="alg2.5.5.m1.2.2.3.cmml">=</mo><mrow id="alg2.5.5.m1.2.2.2.2" xref="alg2.5.5.m1.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.5.5.m1.2.2.2.2.3" xref="alg2.5.5.m1.2.2.2.3.cmml">[</mo><msup id="alg2.5.5.m1.1.1.1.1.1" xref="alg2.5.5.m1.1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.5.5.m1.1.1.1.1.1.2" xref="alg2.5.5.m1.1.1.1.1.1.2.cmml">Θ</mi><mn mathsize="90%" id="alg2.5.5.m1.1.1.1.1.1.3" xref="alg2.5.5.m1.1.1.1.1.1.3.cmml">0</mn></msup><mo mathsize="90%" id="alg2.5.5.m1.2.2.2.2.4" xref="alg2.5.5.m1.2.2.2.3.cmml">,</mo><msup id="alg2.5.5.m1.2.2.2.2.2" xref="alg2.5.5.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.5.5.m1.2.2.2.2.2.2" xref="alg2.5.5.m1.2.2.2.2.2.2.cmml">θ</mi><mn mathsize="90%" id="alg2.5.5.m1.2.2.2.2.2.3" xref="alg2.5.5.m1.2.2.2.2.2.3.cmml">0</mn></msup><mo maxsize="90%" minsize="90%" id="alg2.5.5.m1.2.2.2.2.5" xref="alg2.5.5.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.5.5.m1.2b"><apply id="alg2.5.5.m1.2.2.cmml" xref="alg2.5.5.m1.2.2"><eq id="alg2.5.5.m1.2.2.3.cmml" xref="alg2.5.5.m1.2.2.3"></eq><apply id="alg2.5.5.m1.2.2.4.cmml" xref="alg2.5.5.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.5.5.m1.2.2.4.1.cmml" xref="alg2.5.5.m1.2.2.4">superscript</csymbol><ci id="alg2.5.5.m1.2.2.4.2.cmml" xref="alg2.5.5.m1.2.2.4.2">𝑤</ci><cn type="integer" id="alg2.5.5.m1.2.2.4.3.cmml" xref="alg2.5.5.m1.2.2.4.3">0</cn></apply><interval closure="closed" id="alg2.5.5.m1.2.2.2.3.cmml" xref="alg2.5.5.m1.2.2.2.2"><apply id="alg2.5.5.m1.1.1.1.1.1.cmml" xref="alg2.5.5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.5.5.m1.1.1.1.1.1.1.cmml" xref="alg2.5.5.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.5.5.m1.1.1.1.1.1.2.cmml" xref="alg2.5.5.m1.1.1.1.1.1.2">Θ</ci><cn type="integer" id="alg2.5.5.m1.1.1.1.1.1.3.cmml" xref="alg2.5.5.m1.1.1.1.1.1.3">0</cn></apply><apply id="alg2.5.5.m1.2.2.2.2.2.cmml" xref="alg2.5.5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.5.5.m1.2.2.2.2.2.1.cmml" xref="alg2.5.5.m1.2.2.2.2.2">superscript</csymbol><ci id="alg2.5.5.m1.2.2.2.2.2.2.cmml" xref="alg2.5.5.m1.2.2.2.2.2.2">𝜃</ci><cn type="integer" id="alg2.5.5.m1.2.2.2.2.2.3.cmml" xref="alg2.5.5.m1.2.2.2.2.2.3">0</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.5.m1.2c">w^{0}=[\Theta^{0},\theta^{0}]</annotation></semantics></math><span id="alg2.5.5.2" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.6.6" class="ltx_listingline">
<span id="alg2.6.6.1" class="ltx_text" style="font-size:90%;">
</span><math id="alg2.6.6.m1.1" class="ltx_Math" alttext="t\leftarrow 1" display="inline"><semantics id="alg2.6.6.m1.1a"><mrow id="alg2.6.6.m1.1.1" xref="alg2.6.6.m1.1.1.cmml"><mi mathsize="90%" id="alg2.6.6.m1.1.1.2" xref="alg2.6.6.m1.1.1.2.cmml">t</mi><mo mathsize="90%" stretchy="false" id="alg2.6.6.m1.1.1.1" xref="alg2.6.6.m1.1.1.1.cmml">←</mo><mn mathsize="90%" id="alg2.6.6.m1.1.1.3" xref="alg2.6.6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.6.6.m1.1b"><apply id="alg2.6.6.m1.1.1.cmml" xref="alg2.6.6.m1.1.1"><ci id="alg2.6.6.m1.1.1.1.cmml" xref="alg2.6.6.m1.1.1.1">←</ci><ci id="alg2.6.6.m1.1.1.2.cmml" xref="alg2.6.6.m1.1.1.2">𝑡</ci><cn type="integer" id="alg2.6.6.m1.1.1.3.cmml" xref="alg2.6.6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.6.m1.1c">t\leftarrow 1</annotation></semantics></math><span id="alg2.6.6.2" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.8.8" class="ltx_listingline">
<span id="alg2.8.8.3" class="ltx_text" style="font-size:90%;">
</span><span id="alg2.8.8.4" class="ltx_text ltx_font_bold" style="font-size:90%;">while</span><span id="alg2.8.8.5" class="ltx_text" style="font-size:90%;"> </span><em id="alg2.8.8.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">t <math id="alg2.7.7.1.m1.1" class="ltx_Math" alttext="\leq" display="inline"><semantics id="alg2.7.7.1.m1.1a"><mo id="alg2.7.7.1.m1.1.1" xref="alg2.7.7.1.m1.1.1.cmml">≤</mo><annotation-xml encoding="MathML-Content" id="alg2.7.7.1.m1.1b"><leq id="alg2.7.7.1.m1.1.1.cmml" xref="alg2.7.7.1.m1.1.1"></leq></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.7.1.m1.1c">\leq</annotation></semantics></math> maximum rounds <math id="alg2.8.8.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg2.8.8.2.m2.1a"><mi id="alg2.8.8.2.m2.1.1" xref="alg2.8.8.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.8.8.2.m2.1b"><ci id="alg2.8.8.2.m2.1.1.cmml" xref="alg2.8.8.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.8.2.m2.1c">T</annotation></semantics></math></em><span id="alg2.8.8.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.8.8.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.8.8.8" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.9.9" class="ltx_listingline">
<span id="alg2.9.9.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg2.9.9.3" class="ltx_text" style="font-size:90%;">
</span><span id="alg2.9.9.4" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg2.9.9.5" class="ltx_text" style="font-size:90%;"> </span><em id="alg2.9.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><span id="alg2.9.9.1.1" class="ltx_text ltx_font_upright">each client</span> <math id="alg2.9.9.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg2.9.9.1.m1.1a"><mi id="alg2.9.9.1.m1.1.1" xref="alg2.9.9.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.9.9.1.m1.1b"><ci id="alg2.9.9.1.m1.1.1.cmml" xref="alg2.9.9.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.9.1.m1.1c">k</annotation></semantics></math> <span id="alg2.9.9.1.2" class="ltx_text ltx_font_bold ltx_font_upright">in parallel</span></em><span id="alg2.9.9.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.9.9.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.9.9.8" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.11.11" class="ltx_listingline">
<span id="alg2.11.11.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.11.11.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg2.10.10.m1.2" class="ltx_Math" alttext="[\Theta^{t}_{k},\theta^{t}_{k}]\leftarrow" display="inline"><semantics id="alg2.10.10.m1.2a"><mrow id="alg2.10.10.m1.2.2" xref="alg2.10.10.m1.2.2.cmml"><mrow id="alg2.10.10.m1.2.2.2.2" xref="alg2.10.10.m1.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.10.10.m1.2.2.2.2.3" xref="alg2.10.10.m1.2.2.2.3.cmml">[</mo><msubsup id="alg2.10.10.m1.1.1.1.1.1" xref="alg2.10.10.m1.1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.10.10.m1.1.1.1.1.1.2.2" xref="alg2.10.10.m1.1.1.1.1.1.2.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.10.10.m1.1.1.1.1.1.3" xref="alg2.10.10.m1.1.1.1.1.1.3.cmml">k</mi><mi mathsize="90%" id="alg2.10.10.m1.1.1.1.1.1.2.3" xref="alg2.10.10.m1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo mathsize="90%" id="alg2.10.10.m1.2.2.2.2.4" xref="alg2.10.10.m1.2.2.2.3.cmml">,</mo><msubsup id="alg2.10.10.m1.2.2.2.2.2" xref="alg2.10.10.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.10.10.m1.2.2.2.2.2.2.2" xref="alg2.10.10.m1.2.2.2.2.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.10.10.m1.2.2.2.2.2.3" xref="alg2.10.10.m1.2.2.2.2.2.3.cmml">k</mi><mi mathsize="90%" id="alg2.10.10.m1.2.2.2.2.2.2.3" xref="alg2.10.10.m1.2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg2.10.10.m1.2.2.2.2.5" xref="alg2.10.10.m1.2.2.2.3.cmml">]</mo></mrow><mo mathsize="90%" stretchy="false" id="alg2.10.10.m1.2.2.3" xref="alg2.10.10.m1.2.2.3.cmml">←</mo><mi id="alg2.10.10.m1.2.2.4" xref="alg2.10.10.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.10.10.m1.2b"><apply id="alg2.10.10.m1.2.2.cmml" xref="alg2.10.10.m1.2.2"><ci id="alg2.10.10.m1.2.2.3.cmml" xref="alg2.10.10.m1.2.2.3">←</ci><interval closure="closed" id="alg2.10.10.m1.2.2.2.3.cmml" xref="alg2.10.10.m1.2.2.2.2"><apply id="alg2.10.10.m1.1.1.1.1.1.cmml" xref="alg2.10.10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.10.10.m1.1.1.1.1.1.1.cmml" xref="alg2.10.10.m1.1.1.1.1.1">subscript</csymbol><apply id="alg2.10.10.m1.1.1.1.1.1.2.cmml" xref="alg2.10.10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.10.10.m1.1.1.1.1.1.2.1.cmml" xref="alg2.10.10.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.10.10.m1.1.1.1.1.1.2.2.cmml" xref="alg2.10.10.m1.1.1.1.1.1.2.2">Θ</ci><ci id="alg2.10.10.m1.1.1.1.1.1.2.3.cmml" xref="alg2.10.10.m1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg2.10.10.m1.1.1.1.1.1.3.cmml" xref="alg2.10.10.m1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg2.10.10.m1.2.2.2.2.2.cmml" xref="alg2.10.10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.10.10.m1.2.2.2.2.2.1.cmml" xref="alg2.10.10.m1.2.2.2.2.2">subscript</csymbol><apply id="alg2.10.10.m1.2.2.2.2.2.2.cmml" xref="alg2.10.10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.10.10.m1.2.2.2.2.2.2.1.cmml" xref="alg2.10.10.m1.2.2.2.2.2">superscript</csymbol><ci id="alg2.10.10.m1.2.2.2.2.2.2.2.cmml" xref="alg2.10.10.m1.2.2.2.2.2.2.2">𝜃</ci><ci id="alg2.10.10.m1.2.2.2.2.2.2.3.cmml" xref="alg2.10.10.m1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg2.10.10.m1.2.2.2.2.2.3.cmml" xref="alg2.10.10.m1.2.2.2.2.2.3">𝑘</ci></apply></interval><csymbol cd="latexml" id="alg2.10.10.m1.2.2.4.cmml" xref="alg2.10.10.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.10.m1.2c">[\Theta^{t}_{k},\theta^{t}_{k}]\leftarrow</annotation></semantics></math><span id="alg2.11.11.3" class="ltx_text" style="font-size:90%;"> ClientUpdate</span><math id="alg2.11.11.m2.1" class="ltx_Math" alttext="([\Theta^{t},\theta^{t}])" display="inline"><semantics id="alg2.11.11.m2.1a"><mrow id="alg2.11.11.m2.1.1.1"><mo maxsize="90%" minsize="90%" id="alg2.11.11.m2.1.1.1.2">(</mo><mrow id="alg2.11.11.m2.1.1.1.1.2" xref="alg2.11.11.m2.1.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.11.11.m2.1.1.1.1.2.3" xref="alg2.11.11.m2.1.1.1.1.3.cmml">[</mo><msup id="alg2.11.11.m2.1.1.1.1.1.1" xref="alg2.11.11.m2.1.1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.11.11.m2.1.1.1.1.1.1.2" xref="alg2.11.11.m2.1.1.1.1.1.1.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.11.11.m2.1.1.1.1.1.1.3" xref="alg2.11.11.m2.1.1.1.1.1.1.3.cmml">t</mi></msup><mo mathsize="90%" id="alg2.11.11.m2.1.1.1.1.2.4" xref="alg2.11.11.m2.1.1.1.1.3.cmml">,</mo><msup id="alg2.11.11.m2.1.1.1.1.2.2" xref="alg2.11.11.m2.1.1.1.1.2.2.cmml"><mi mathsize="90%" id="alg2.11.11.m2.1.1.1.1.2.2.2" xref="alg2.11.11.m2.1.1.1.1.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.11.11.m2.1.1.1.1.2.2.3" xref="alg2.11.11.m2.1.1.1.1.2.2.3.cmml">t</mi></msup><mo maxsize="90%" minsize="90%" id="alg2.11.11.m2.1.1.1.1.2.5" xref="alg2.11.11.m2.1.1.1.1.3.cmml">]</mo></mrow><mo maxsize="90%" minsize="90%" id="alg2.11.11.m2.1.1.1.3">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.11.11.m2.1b"><interval closure="closed" id="alg2.11.11.m2.1.1.1.1.3.cmml" xref="alg2.11.11.m2.1.1.1.1.2"><apply id="alg2.11.11.m2.1.1.1.1.1.1.cmml" xref="alg2.11.11.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.11.11.m2.1.1.1.1.1.1.1.cmml" xref="alg2.11.11.m2.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.11.11.m2.1.1.1.1.1.1.2.cmml" xref="alg2.11.11.m2.1.1.1.1.1.1.2">Θ</ci><ci id="alg2.11.11.m2.1.1.1.1.1.1.3.cmml" xref="alg2.11.11.m2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg2.11.11.m2.1.1.1.1.2.2.cmml" xref="alg2.11.11.m2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.11.11.m2.1.1.1.1.2.2.1.cmml" xref="alg2.11.11.m2.1.1.1.1.2.2">superscript</csymbol><ci id="alg2.11.11.m2.1.1.1.1.2.2.2.cmml" xref="alg2.11.11.m2.1.1.1.1.2.2.2">𝜃</ci><ci id="alg2.11.11.m2.1.1.1.1.2.2.3.cmml" xref="alg2.11.11.m2.1.1.1.1.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.11.m2.1c">([\Theta^{t},\theta^{t}])</annotation></semantics></math><span id="alg2.11.11.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.26.28" class="ltx_listingline">
<span id="alg2.26.28.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.26.28.2" class="ltx_text" style="font-size:90%;">  end for</span>
</div>
<div id="alg2.12.12" class="ltx_listingline">
<span id="alg2.12.12.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.12.12.2" class="ltx_text" style="font-size:90%;">Clients send models </span><math id="alg2.12.12.m1.2" class="ltx_Math" alttext="[\Theta^{t}_{1...K},\theta^{t}_{1...K}]" display="inline"><semantics id="alg2.12.12.m1.2a"><mrow id="alg2.12.12.m1.2.2.2" xref="alg2.12.12.m1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.12.12.m1.2.2.2.3" xref="alg2.12.12.m1.2.2.3.cmml">[</mo><msubsup id="alg2.12.12.m1.1.1.1.1" xref="alg2.12.12.m1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.12.12.m1.1.1.1.1.2.2" xref="alg2.12.12.m1.1.1.1.1.2.2.cmml">Θ</mi><mrow id="alg2.12.12.m1.1.1.1.1.3" xref="alg2.12.12.m1.1.1.1.1.3.cmml"><mn mathsize="90%" id="alg2.12.12.m1.1.1.1.1.3.2" xref="alg2.12.12.m1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1.1.3.1" xref="alg2.12.12.m1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg2.12.12.m1.1.1.1.1.3.3" xref="alg2.12.12.m1.1.1.1.1.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.1.1.1.1.3.1a" xref="alg2.12.12.m1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.12.12.m1.1.1.1.1.3.4" xref="alg2.12.12.m1.1.1.1.1.3.4.cmml">K</mi></mrow><mi mathsize="90%" id="alg2.12.12.m1.1.1.1.1.2.3" xref="alg2.12.12.m1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo mathsize="90%" id="alg2.12.12.m1.2.2.2.4" xref="alg2.12.12.m1.2.2.3.cmml">,</mo><msubsup id="alg2.12.12.m1.2.2.2.2" xref="alg2.12.12.m1.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.12.12.m1.2.2.2.2.2.2" xref="alg2.12.12.m1.2.2.2.2.2.2.cmml">θ</mi><mrow id="alg2.12.12.m1.2.2.2.2.3" xref="alg2.12.12.m1.2.2.2.2.3.cmml"><mn mathsize="90%" id="alg2.12.12.m1.2.2.2.2.3.2" xref="alg2.12.12.m1.2.2.2.2.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.2.2.2.2.3.1" xref="alg2.12.12.m1.2.2.2.2.3.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg2.12.12.m1.2.2.2.2.3.3" xref="alg2.12.12.m1.2.2.2.2.3.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.12.12.m1.2.2.2.2.3.1a" xref="alg2.12.12.m1.2.2.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.12.12.m1.2.2.2.2.3.4" xref="alg2.12.12.m1.2.2.2.2.3.4.cmml">K</mi></mrow><mi mathsize="90%" id="alg2.12.12.m1.2.2.2.2.2.3" xref="alg2.12.12.m1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg2.12.12.m1.2.2.2.5" xref="alg2.12.12.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.12.12.m1.2b"><interval closure="closed" id="alg2.12.12.m1.2.2.3.cmml" xref="alg2.12.12.m1.2.2.2"><apply id="alg2.12.12.m1.1.1.1.1.cmml" xref="alg2.12.12.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.12.12.m1.1.1.1.1.1.cmml" xref="alg2.12.12.m1.1.1.1.1">subscript</csymbol><apply id="alg2.12.12.m1.1.1.1.1.2.cmml" xref="alg2.12.12.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.12.12.m1.1.1.1.1.2.1.cmml" xref="alg2.12.12.m1.1.1.1.1">superscript</csymbol><ci id="alg2.12.12.m1.1.1.1.1.2.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2.2">Θ</ci><ci id="alg2.12.12.m1.1.1.1.1.2.3.cmml" xref="alg2.12.12.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg2.12.12.m1.1.1.1.1.3.cmml" xref="alg2.12.12.m1.1.1.1.1.3"><times id="alg2.12.12.m1.1.1.1.1.3.1.cmml" xref="alg2.12.12.m1.1.1.1.1.3.1"></times><cn type="integer" id="alg2.12.12.m1.1.1.1.1.3.2.cmml" xref="alg2.12.12.m1.1.1.1.1.3.2">1</cn><ci id="alg2.12.12.m1.1.1.1.1.3.3.cmml" xref="alg2.12.12.m1.1.1.1.1.3.3">…</ci><ci id="alg2.12.12.m1.1.1.1.1.3.4.cmml" xref="alg2.12.12.m1.1.1.1.1.3.4">𝐾</ci></apply></apply><apply id="alg2.12.12.m1.2.2.2.2.cmml" xref="alg2.12.12.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.12.12.m1.2.2.2.2.1.cmml" xref="alg2.12.12.m1.2.2.2.2">subscript</csymbol><apply id="alg2.12.12.m1.2.2.2.2.2.cmml" xref="alg2.12.12.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.12.12.m1.2.2.2.2.2.1.cmml" xref="alg2.12.12.m1.2.2.2.2">superscript</csymbol><ci id="alg2.12.12.m1.2.2.2.2.2.2.cmml" xref="alg2.12.12.m1.2.2.2.2.2.2">𝜃</ci><ci id="alg2.12.12.m1.2.2.2.2.2.3.cmml" xref="alg2.12.12.m1.2.2.2.2.2.3">𝑡</ci></apply><apply id="alg2.12.12.m1.2.2.2.2.3.cmml" xref="alg2.12.12.m1.2.2.2.2.3"><times id="alg2.12.12.m1.2.2.2.2.3.1.cmml" xref="alg2.12.12.m1.2.2.2.2.3.1"></times><cn type="integer" id="alg2.12.12.m1.2.2.2.2.3.2.cmml" xref="alg2.12.12.m1.2.2.2.2.3.2">1</cn><ci id="alg2.12.12.m1.2.2.2.2.3.3.cmml" xref="alg2.12.12.m1.2.2.2.2.3.3">…</ci><ci id="alg2.12.12.m1.2.2.2.2.3.4.cmml" xref="alg2.12.12.m1.2.2.2.2.3.4">𝐾</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.12.m1.2c">[\Theta^{t}_{1...K},\theta^{t}_{1...K}]</annotation></semantics></math><span id="alg2.12.12.3" class="ltx_text" style="font-size:90%;"> to server </span>
</div>
<div id="alg2.13.13" class="ltx_listingline">
<span id="alg2.13.13.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.13.13.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg2.13.13.m1.6" class="ltx_Math" alttext="[\Theta^{t+1},\theta^{t+1}]\leftarrow\sum_{k=1}^{K}\frac{|\mathcal{B}_{k}|}{|\mathcal{B}|}[\Theta^{t}_{k},\theta^{t}_{k}]" display="inline"><semantics id="alg2.13.13.m1.6a"><mrow id="alg2.13.13.m1.6.6" xref="alg2.13.13.m1.6.6.cmml"><mrow id="alg2.13.13.m1.4.4.2.2" xref="alg2.13.13.m1.4.4.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.13.13.m1.4.4.2.2.3" xref="alg2.13.13.m1.4.4.2.3.cmml">[</mo><msup id="alg2.13.13.m1.3.3.1.1.1" xref="alg2.13.13.m1.3.3.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.13.13.m1.3.3.1.1.1.2" xref="alg2.13.13.m1.3.3.1.1.1.2.cmml">Θ</mi><mrow id="alg2.13.13.m1.3.3.1.1.1.3" xref="alg2.13.13.m1.3.3.1.1.1.3.cmml"><mi mathsize="90%" id="alg2.13.13.m1.3.3.1.1.1.3.2" xref="alg2.13.13.m1.3.3.1.1.1.3.2.cmml">t</mi><mo mathsize="90%" id="alg2.13.13.m1.3.3.1.1.1.3.1" xref="alg2.13.13.m1.3.3.1.1.1.3.1.cmml">+</mo><mn mathsize="90%" id="alg2.13.13.m1.3.3.1.1.1.3.3" xref="alg2.13.13.m1.3.3.1.1.1.3.3.cmml">1</mn></mrow></msup><mo mathsize="90%" id="alg2.13.13.m1.4.4.2.2.4" xref="alg2.13.13.m1.4.4.2.3.cmml">,</mo><msup id="alg2.13.13.m1.4.4.2.2.2" xref="alg2.13.13.m1.4.4.2.2.2.cmml"><mi mathsize="90%" id="alg2.13.13.m1.4.4.2.2.2.2" xref="alg2.13.13.m1.4.4.2.2.2.2.cmml">θ</mi><mrow id="alg2.13.13.m1.4.4.2.2.2.3" xref="alg2.13.13.m1.4.4.2.2.2.3.cmml"><mi mathsize="90%" id="alg2.13.13.m1.4.4.2.2.2.3.2" xref="alg2.13.13.m1.4.4.2.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg2.13.13.m1.4.4.2.2.2.3.1" xref="alg2.13.13.m1.4.4.2.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg2.13.13.m1.4.4.2.2.2.3.3" xref="alg2.13.13.m1.4.4.2.2.2.3.3.cmml">1</mn></mrow></msup><mo maxsize="90%" minsize="90%" id="alg2.13.13.m1.4.4.2.2.5" xref="alg2.13.13.m1.4.4.2.3.cmml">]</mo></mrow><mo mathsize="90%" rspace="0.111em" stretchy="false" id="alg2.13.13.m1.6.6.5" xref="alg2.13.13.m1.6.6.5.cmml">←</mo><mrow id="alg2.13.13.m1.6.6.4" xref="alg2.13.13.m1.6.6.4.cmml"><msubsup id="alg2.13.13.m1.6.6.4.3" xref="alg2.13.13.m1.6.6.4.3.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="alg2.13.13.m1.6.6.4.3.2.2" xref="alg2.13.13.m1.6.6.4.3.2.2.cmml">∑</mo><mrow id="alg2.13.13.m1.6.6.4.3.2.3" xref="alg2.13.13.m1.6.6.4.3.2.3.cmml"><mi mathsize="90%" id="alg2.13.13.m1.6.6.4.3.2.3.2" xref="alg2.13.13.m1.6.6.4.3.2.3.2.cmml">k</mi><mo mathsize="90%" id="alg2.13.13.m1.6.6.4.3.2.3.1" xref="alg2.13.13.m1.6.6.4.3.2.3.1.cmml">=</mo><mn mathsize="90%" id="alg2.13.13.m1.6.6.4.3.2.3.3" xref="alg2.13.13.m1.6.6.4.3.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg2.13.13.m1.6.6.4.3.3" xref="alg2.13.13.m1.6.6.4.3.3.cmml">K</mi></msubsup><mrow id="alg2.13.13.m1.6.6.4.2" xref="alg2.13.13.m1.6.6.4.2.cmml"><mfrac id="alg2.13.13.m1.2.2" xref="alg2.13.13.m1.2.2.cmml"><mrow id="alg2.13.13.m1.1.1.1.1" xref="alg2.13.13.m1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.13.13.m1.1.1.1.1.2" xref="alg2.13.13.m1.1.1.1.2.1.cmml">|</mo><msub id="alg2.13.13.m1.1.1.1.1.1" xref="alg2.13.13.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.13.13.m1.1.1.1.1.1.2" xref="alg2.13.13.m1.1.1.1.1.1.2.cmml">ℬ</mi><mi mathsize="90%" id="alg2.13.13.m1.1.1.1.1.1.3" xref="alg2.13.13.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.13.13.m1.1.1.1.1.3" xref="alg2.13.13.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg2.13.13.m1.2.2.2.3" xref="alg2.13.13.m1.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.13.13.m1.2.2.2.3.1" xref="alg2.13.13.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.13.13.m1.2.2.2.1" xref="alg2.13.13.m1.2.2.2.1.cmml">ℬ</mi><mo maxsize="90%" minsize="90%" id="alg2.13.13.m1.2.2.2.3.2" xref="alg2.13.13.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg2.13.13.m1.6.6.4.2.3" xref="alg2.13.13.m1.6.6.4.2.3.cmml">​</mo><mrow id="alg2.13.13.m1.6.6.4.2.2.2" xref="alg2.13.13.m1.6.6.4.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.13.13.m1.6.6.4.2.2.2.3" xref="alg2.13.13.m1.6.6.4.2.2.3.cmml">[</mo><msubsup id="alg2.13.13.m1.5.5.3.1.1.1.1" xref="alg2.13.13.m1.5.5.3.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.13.13.m1.5.5.3.1.1.1.1.2.2" xref="alg2.13.13.m1.5.5.3.1.1.1.1.2.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.13.13.m1.5.5.3.1.1.1.1.3" xref="alg2.13.13.m1.5.5.3.1.1.1.1.3.cmml">k</mi><mi mathsize="90%" id="alg2.13.13.m1.5.5.3.1.1.1.1.2.3" xref="alg2.13.13.m1.5.5.3.1.1.1.1.2.3.cmml">t</mi></msubsup><mo mathsize="90%" id="alg2.13.13.m1.6.6.4.2.2.2.4" xref="alg2.13.13.m1.6.6.4.2.2.3.cmml">,</mo><msubsup id="alg2.13.13.m1.6.6.4.2.2.2.2" xref="alg2.13.13.m1.6.6.4.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.13.13.m1.6.6.4.2.2.2.2.2.2" xref="alg2.13.13.m1.6.6.4.2.2.2.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.13.13.m1.6.6.4.2.2.2.2.3" xref="alg2.13.13.m1.6.6.4.2.2.2.2.3.cmml">k</mi><mi mathsize="90%" id="alg2.13.13.m1.6.6.4.2.2.2.2.2.3" xref="alg2.13.13.m1.6.6.4.2.2.2.2.2.3.cmml">t</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg2.13.13.m1.6.6.4.2.2.2.5" xref="alg2.13.13.m1.6.6.4.2.2.3.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.13.13.m1.6b"><apply id="alg2.13.13.m1.6.6.cmml" xref="alg2.13.13.m1.6.6"><ci id="alg2.13.13.m1.6.6.5.cmml" xref="alg2.13.13.m1.6.6.5">←</ci><interval closure="closed" id="alg2.13.13.m1.4.4.2.3.cmml" xref="alg2.13.13.m1.4.4.2.2"><apply id="alg2.13.13.m1.3.3.1.1.1.cmml" xref="alg2.13.13.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg2.13.13.m1.3.3.1.1.1.1.cmml" xref="alg2.13.13.m1.3.3.1.1.1">superscript</csymbol><ci id="alg2.13.13.m1.3.3.1.1.1.2.cmml" xref="alg2.13.13.m1.3.3.1.1.1.2">Θ</ci><apply id="alg2.13.13.m1.3.3.1.1.1.3.cmml" xref="alg2.13.13.m1.3.3.1.1.1.3"><plus id="alg2.13.13.m1.3.3.1.1.1.3.1.cmml" xref="alg2.13.13.m1.3.3.1.1.1.3.1"></plus><ci id="alg2.13.13.m1.3.3.1.1.1.3.2.cmml" xref="alg2.13.13.m1.3.3.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg2.13.13.m1.3.3.1.1.1.3.3.cmml" xref="alg2.13.13.m1.3.3.1.1.1.3.3">1</cn></apply></apply><apply id="alg2.13.13.m1.4.4.2.2.2.cmml" xref="alg2.13.13.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg2.13.13.m1.4.4.2.2.2.1.cmml" xref="alg2.13.13.m1.4.4.2.2.2">superscript</csymbol><ci id="alg2.13.13.m1.4.4.2.2.2.2.cmml" xref="alg2.13.13.m1.4.4.2.2.2.2">𝜃</ci><apply id="alg2.13.13.m1.4.4.2.2.2.3.cmml" xref="alg2.13.13.m1.4.4.2.2.2.3"><plus id="alg2.13.13.m1.4.4.2.2.2.3.1.cmml" xref="alg2.13.13.m1.4.4.2.2.2.3.1"></plus><ci id="alg2.13.13.m1.4.4.2.2.2.3.2.cmml" xref="alg2.13.13.m1.4.4.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg2.13.13.m1.4.4.2.2.2.3.3.cmml" xref="alg2.13.13.m1.4.4.2.2.2.3.3">1</cn></apply></apply></interval><apply id="alg2.13.13.m1.6.6.4.cmml" xref="alg2.13.13.m1.6.6.4"><apply id="alg2.13.13.m1.6.6.4.3.cmml" xref="alg2.13.13.m1.6.6.4.3"><csymbol cd="ambiguous" id="alg2.13.13.m1.6.6.4.3.1.cmml" xref="alg2.13.13.m1.6.6.4.3">superscript</csymbol><apply id="alg2.13.13.m1.6.6.4.3.2.cmml" xref="alg2.13.13.m1.6.6.4.3"><csymbol cd="ambiguous" id="alg2.13.13.m1.6.6.4.3.2.1.cmml" xref="alg2.13.13.m1.6.6.4.3">subscript</csymbol><sum id="alg2.13.13.m1.6.6.4.3.2.2.cmml" xref="alg2.13.13.m1.6.6.4.3.2.2"></sum><apply id="alg2.13.13.m1.6.6.4.3.2.3.cmml" xref="alg2.13.13.m1.6.6.4.3.2.3"><eq id="alg2.13.13.m1.6.6.4.3.2.3.1.cmml" xref="alg2.13.13.m1.6.6.4.3.2.3.1"></eq><ci id="alg2.13.13.m1.6.6.4.3.2.3.2.cmml" xref="alg2.13.13.m1.6.6.4.3.2.3.2">𝑘</ci><cn type="integer" id="alg2.13.13.m1.6.6.4.3.2.3.3.cmml" xref="alg2.13.13.m1.6.6.4.3.2.3.3">1</cn></apply></apply><ci id="alg2.13.13.m1.6.6.4.3.3.cmml" xref="alg2.13.13.m1.6.6.4.3.3">𝐾</ci></apply><apply id="alg2.13.13.m1.6.6.4.2.cmml" xref="alg2.13.13.m1.6.6.4.2"><times id="alg2.13.13.m1.6.6.4.2.3.cmml" xref="alg2.13.13.m1.6.6.4.2.3"></times><apply id="alg2.13.13.m1.2.2.cmml" xref="alg2.13.13.m1.2.2"><divide id="alg2.13.13.m1.2.2.3.cmml" xref="alg2.13.13.m1.2.2"></divide><apply id="alg2.13.13.m1.1.1.1.2.cmml" xref="alg2.13.13.m1.1.1.1.1"><abs id="alg2.13.13.m1.1.1.1.2.1.cmml" xref="alg2.13.13.m1.1.1.1.1.2"></abs><apply id="alg2.13.13.m1.1.1.1.1.1.cmml" xref="alg2.13.13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.13.13.m1.1.1.1.1.1.1.cmml" xref="alg2.13.13.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.13.13.m1.1.1.1.1.1.2.cmml" xref="alg2.13.13.m1.1.1.1.1.1.2">ℬ</ci><ci id="alg2.13.13.m1.1.1.1.1.1.3.cmml" xref="alg2.13.13.m1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="alg2.13.13.m1.2.2.2.2.cmml" xref="alg2.13.13.m1.2.2.2.3"><abs id="alg2.13.13.m1.2.2.2.2.1.cmml" xref="alg2.13.13.m1.2.2.2.3.1"></abs><ci id="alg2.13.13.m1.2.2.2.1.cmml" xref="alg2.13.13.m1.2.2.2.1">ℬ</ci></apply></apply><interval closure="closed" id="alg2.13.13.m1.6.6.4.2.2.3.cmml" xref="alg2.13.13.m1.6.6.4.2.2.2"><apply id="alg2.13.13.m1.5.5.3.1.1.1.1.cmml" xref="alg2.13.13.m1.5.5.3.1.1.1.1"><csymbol cd="ambiguous" id="alg2.13.13.m1.5.5.3.1.1.1.1.1.cmml" xref="alg2.13.13.m1.5.5.3.1.1.1.1">subscript</csymbol><apply id="alg2.13.13.m1.5.5.3.1.1.1.1.2.cmml" xref="alg2.13.13.m1.5.5.3.1.1.1.1"><csymbol cd="ambiguous" id="alg2.13.13.m1.5.5.3.1.1.1.1.2.1.cmml" xref="alg2.13.13.m1.5.5.3.1.1.1.1">superscript</csymbol><ci id="alg2.13.13.m1.5.5.3.1.1.1.1.2.2.cmml" xref="alg2.13.13.m1.5.5.3.1.1.1.1.2.2">Θ</ci><ci id="alg2.13.13.m1.5.5.3.1.1.1.1.2.3.cmml" xref="alg2.13.13.m1.5.5.3.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg2.13.13.m1.5.5.3.1.1.1.1.3.cmml" xref="alg2.13.13.m1.5.5.3.1.1.1.1.3">𝑘</ci></apply><apply id="alg2.13.13.m1.6.6.4.2.2.2.2.cmml" xref="alg2.13.13.m1.6.6.4.2.2.2.2"><csymbol cd="ambiguous" id="alg2.13.13.m1.6.6.4.2.2.2.2.1.cmml" xref="alg2.13.13.m1.6.6.4.2.2.2.2">subscript</csymbol><apply id="alg2.13.13.m1.6.6.4.2.2.2.2.2.cmml" xref="alg2.13.13.m1.6.6.4.2.2.2.2"><csymbol cd="ambiguous" id="alg2.13.13.m1.6.6.4.2.2.2.2.2.1.cmml" xref="alg2.13.13.m1.6.6.4.2.2.2.2">superscript</csymbol><ci id="alg2.13.13.m1.6.6.4.2.2.2.2.2.2.cmml" xref="alg2.13.13.m1.6.6.4.2.2.2.2.2.2">𝜃</ci><ci id="alg2.13.13.m1.6.6.4.2.2.2.2.2.3.cmml" xref="alg2.13.13.m1.6.6.4.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg2.13.13.m1.6.6.4.2.2.2.2.3.cmml" xref="alg2.13.13.m1.6.6.4.2.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.13.m1.6c">[\Theta^{t+1},\theta^{t+1}]\leftarrow\sum_{k=1}^{K}\frac{|\mathcal{B}_{k}|}{|\mathcal{B}|}[\Theta^{t}_{k},\theta^{t}_{k}]</annotation></semantics></math><span id="alg2.13.13.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.14.14" class="ltx_listingline">
<span id="alg2.14.14.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.14.14.2" class="ltx_text" style="font-size:90%;">
The server sends </span><math id="alg2.14.14.m1.2" class="ltx_Math" alttext="[\Theta^{t+1},\theta^{t+1}]" display="inline"><semantics id="alg2.14.14.m1.2a"><mrow id="alg2.14.14.m1.2.2.2" xref="alg2.14.14.m1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.14.14.m1.2.2.2.3" xref="alg2.14.14.m1.2.2.3.cmml">[</mo><msup id="alg2.14.14.m1.1.1.1.1" xref="alg2.14.14.m1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.14.14.m1.1.1.1.1.2" xref="alg2.14.14.m1.1.1.1.1.2.cmml">Θ</mi><mrow id="alg2.14.14.m1.1.1.1.1.3" xref="alg2.14.14.m1.1.1.1.1.3.cmml"><mi mathsize="90%" id="alg2.14.14.m1.1.1.1.1.3.2" xref="alg2.14.14.m1.1.1.1.1.3.2.cmml">t</mi><mo mathsize="90%" id="alg2.14.14.m1.1.1.1.1.3.1" xref="alg2.14.14.m1.1.1.1.1.3.1.cmml">+</mo><mn mathsize="90%" id="alg2.14.14.m1.1.1.1.1.3.3" xref="alg2.14.14.m1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo mathsize="90%" id="alg2.14.14.m1.2.2.2.4" xref="alg2.14.14.m1.2.2.3.cmml">,</mo><msup id="alg2.14.14.m1.2.2.2.2" xref="alg2.14.14.m1.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.14.14.m1.2.2.2.2.2" xref="alg2.14.14.m1.2.2.2.2.2.cmml">θ</mi><mrow id="alg2.14.14.m1.2.2.2.2.3" xref="alg2.14.14.m1.2.2.2.2.3.cmml"><mi mathsize="90%" id="alg2.14.14.m1.2.2.2.2.3.2" xref="alg2.14.14.m1.2.2.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="alg2.14.14.m1.2.2.2.2.3.1" xref="alg2.14.14.m1.2.2.2.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg2.14.14.m1.2.2.2.2.3.3" xref="alg2.14.14.m1.2.2.2.2.3.3.cmml">1</mn></mrow></msup><mo maxsize="90%" minsize="90%" id="alg2.14.14.m1.2.2.2.5" xref="alg2.14.14.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.14.14.m1.2b"><interval closure="closed" id="alg2.14.14.m1.2.2.3.cmml" xref="alg2.14.14.m1.2.2.2"><apply id="alg2.14.14.m1.1.1.1.1.cmml" xref="alg2.14.14.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.14.14.m1.1.1.1.1.1.cmml" xref="alg2.14.14.m1.1.1.1.1">superscript</csymbol><ci id="alg2.14.14.m1.1.1.1.1.2.cmml" xref="alg2.14.14.m1.1.1.1.1.2">Θ</ci><apply id="alg2.14.14.m1.1.1.1.1.3.cmml" xref="alg2.14.14.m1.1.1.1.1.3"><plus id="alg2.14.14.m1.1.1.1.1.3.1.cmml" xref="alg2.14.14.m1.1.1.1.1.3.1"></plus><ci id="alg2.14.14.m1.1.1.1.1.3.2.cmml" xref="alg2.14.14.m1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg2.14.14.m1.1.1.1.1.3.3.cmml" xref="alg2.14.14.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg2.14.14.m1.2.2.2.2.cmml" xref="alg2.14.14.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.14.14.m1.2.2.2.2.1.cmml" xref="alg2.14.14.m1.2.2.2.2">superscript</csymbol><ci id="alg2.14.14.m1.2.2.2.2.2.cmml" xref="alg2.14.14.m1.2.2.2.2.2">𝜃</ci><apply id="alg2.14.14.m1.2.2.2.2.3.cmml" xref="alg2.14.14.m1.2.2.2.2.3"><plus id="alg2.14.14.m1.2.2.2.2.3.1.cmml" xref="alg2.14.14.m1.2.2.2.2.3.1"></plus><ci id="alg2.14.14.m1.2.2.2.2.3.2.cmml" xref="alg2.14.14.m1.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg2.14.14.m1.2.2.2.2.3.3.cmml" xref="alg2.14.14.m1.2.2.2.2.3.3">1</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.14.m1.2c">[\Theta^{t+1},\theta^{t+1}]</annotation></semantics></math><span id="alg2.14.14.3" class="ltx_text" style="font-size:90%;"> back to clients </span>
</div>
<div id="alg2.15.15" class="ltx_listingline">
<span id="alg2.15.15.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.15.15.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg2.15.15.m1.1" class="ltx_Math" alttext="t\leftarrow t+1" display="inline"><semantics id="alg2.15.15.m1.1a"><mrow id="alg2.15.15.m1.1.1" xref="alg2.15.15.m1.1.1.cmml"><mi mathsize="90%" id="alg2.15.15.m1.1.1.2" xref="alg2.15.15.m1.1.1.2.cmml">t</mi><mo mathsize="90%" stretchy="false" id="alg2.15.15.m1.1.1.1" xref="alg2.15.15.m1.1.1.1.cmml">←</mo><mrow id="alg2.15.15.m1.1.1.3" xref="alg2.15.15.m1.1.1.3.cmml"><mi mathsize="90%" id="alg2.15.15.m1.1.1.3.2" xref="alg2.15.15.m1.1.1.3.2.cmml">t</mi><mo mathsize="90%" id="alg2.15.15.m1.1.1.3.1" xref="alg2.15.15.m1.1.1.3.1.cmml">+</mo><mn mathsize="90%" id="alg2.15.15.m1.1.1.3.3" xref="alg2.15.15.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.15.15.m1.1b"><apply id="alg2.15.15.m1.1.1.cmml" xref="alg2.15.15.m1.1.1"><ci id="alg2.15.15.m1.1.1.1.cmml" xref="alg2.15.15.m1.1.1.1">←</ci><ci id="alg2.15.15.m1.1.1.2.cmml" xref="alg2.15.15.m1.1.1.2">𝑡</ci><apply id="alg2.15.15.m1.1.1.3.cmml" xref="alg2.15.15.m1.1.1.3"><plus id="alg2.15.15.m1.1.1.3.1.cmml" xref="alg2.15.15.m1.1.1.3.1"></plus><ci id="alg2.15.15.m1.1.1.3.2.cmml" xref="alg2.15.15.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg2.15.15.m1.1.1.3.3.cmml" xref="alg2.15.15.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.15.m1.1c">t\leftarrow t+1</annotation></semantics></math><span id="alg2.15.15.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.26.29" class="ltx_listingline">
<span id="alg2.26.29.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.26.29.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.26.30" class="ltx_listingline">
<span id="alg2.26.30.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.26.30.2" class="ltx_text" style="font-size:90%;">  end while</span>
</div>
<div id="alg2.16.16" class="ltx_listingline">
<span id="alg2.16.16.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.16.16.2" class="ltx_text" style="font-size:90%;">Return </span><math id="alg2.16.16.m1.2" class="ltx_Math" alttext="[\Theta^{t},\theta^{t}]" display="inline"><semantics id="alg2.16.16.m1.2a"><mrow id="alg2.16.16.m1.2.2.2" xref="alg2.16.16.m1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.16.16.m1.2.2.2.3" xref="alg2.16.16.m1.2.2.3.cmml">[</mo><msup id="alg2.16.16.m1.1.1.1.1" xref="alg2.16.16.m1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.16.16.m1.1.1.1.1.2" xref="alg2.16.16.m1.1.1.1.1.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.16.16.m1.1.1.1.1.3" xref="alg2.16.16.m1.1.1.1.1.3.cmml">t</mi></msup><mo mathsize="90%" id="alg2.16.16.m1.2.2.2.4" xref="alg2.16.16.m1.2.2.3.cmml">,</mo><msup id="alg2.16.16.m1.2.2.2.2" xref="alg2.16.16.m1.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.16.16.m1.2.2.2.2.2" xref="alg2.16.16.m1.2.2.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.16.16.m1.2.2.2.2.3" xref="alg2.16.16.m1.2.2.2.2.3.cmml">t</mi></msup><mo maxsize="90%" minsize="90%" id="alg2.16.16.m1.2.2.2.5" xref="alg2.16.16.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.16.16.m1.2b"><interval closure="closed" id="alg2.16.16.m1.2.2.3.cmml" xref="alg2.16.16.m1.2.2.2"><apply id="alg2.16.16.m1.1.1.1.1.cmml" xref="alg2.16.16.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.16.16.m1.1.1.1.1.1.cmml" xref="alg2.16.16.m1.1.1.1.1">superscript</csymbol><ci id="alg2.16.16.m1.1.1.1.1.2.cmml" xref="alg2.16.16.m1.1.1.1.1.2">Θ</ci><ci id="alg2.16.16.m1.1.1.1.1.3.cmml" xref="alg2.16.16.m1.1.1.1.1.3">𝑡</ci></apply><apply id="alg2.16.16.m1.2.2.2.2.cmml" xref="alg2.16.16.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.16.16.m1.2.2.2.2.1.cmml" xref="alg2.16.16.m1.2.2.2.2">superscript</csymbol><ci id="alg2.16.16.m1.2.2.2.2.2.cmml" xref="alg2.16.16.m1.2.2.2.2.2">𝜃</ci><ci id="alg2.16.16.m1.2.2.2.2.3.cmml" xref="alg2.16.16.m1.2.2.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.16.m1.2c">[\Theta^{t},\theta^{t}]</annotation></semantics></math><span id="alg2.16.16.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.26.31" class="ltx_listingline">
<span id="alg2.26.31.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.26.31.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.17.17" class="ltx_listingline">
<span id="alg2.17.17.2" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.17.17.3" class="ltx_text" style="font-size:90%;">
</span><span id="alg2.17.17.1" class="ltx_text ltx_font_bold" style="font-size:90%;">ClientUpdate<math id="alg2.17.17.1.m1.3" class="ltx_Math" alttext="([\Theta,\theta])" display="inline"><semantics id="alg2.17.17.1.m1.3a"><mrow id="alg2.17.17.1.m1.3.3.1"><mo stretchy="false" id="alg2.17.17.1.m1.3.3.1.2">(</mo><mrow id="alg2.17.17.1.m1.3.3.1.1.2" xref="alg2.17.17.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="alg2.17.17.1.m1.3.3.1.1.2.1" xref="alg2.17.17.1.m1.3.3.1.1.1.cmml">[</mo><mi mathvariant="normal" id="alg2.17.17.1.m1.1.1" xref="alg2.17.17.1.m1.1.1.cmml">Θ</mi><mo id="alg2.17.17.1.m1.3.3.1.1.2.2" xref="alg2.17.17.1.m1.3.3.1.1.1.cmml">,</mo><mi id="alg2.17.17.1.m1.2.2" xref="alg2.17.17.1.m1.2.2.cmml">θ</mi><mo stretchy="false" id="alg2.17.17.1.m1.3.3.1.1.2.3" xref="alg2.17.17.1.m1.3.3.1.1.1.cmml">]</mo></mrow><mo stretchy="false" id="alg2.17.17.1.m1.3.3.1.3">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.17.17.1.m1.3b"><interval closure="closed" id="alg2.17.17.1.m1.3.3.1.1.1.cmml" xref="alg2.17.17.1.m1.3.3.1.1.2"><ci id="alg2.17.17.1.m1.1.1.cmml" xref="alg2.17.17.1.m1.1.1">Θ</ci><ci id="alg2.17.17.1.m1.2.2.cmml" xref="alg2.17.17.1.m1.2.2">𝜃</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.17.17.1.m1.3c">([\Theta,\theta])</annotation></semantics></math></span><span id="alg2.17.17.4" class="ltx_text" style="font-size:90%;">: </span>
</div>
<div id="alg2.26.32" class="ltx_listingline">
<span id="alg2.26.32.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.26.32.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.18.18" class="ltx_listingline">
<span id="alg2.18.18.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.18.18.2" class="ltx_text" style="font-size:90%;"><span id="alg2.18.18.2.1" class="ltx_text ltx_font_bold">Input:</span> </span><span id="alg2.18.18.3" class="ltx_text" style="font-size:90%;">global model from previous round </span><math id="alg2.18.18.m1.2" class="ltx_Math" alttext="[\Theta^{t},\theta^{t}]" display="inline"><semantics id="alg2.18.18.m1.2a"><mrow id="alg2.18.18.m1.2.2.2" xref="alg2.18.18.m1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.18.18.m1.2.2.2.3" xref="alg2.18.18.m1.2.2.3.cmml">[</mo><msup id="alg2.18.18.m1.1.1.1.1" xref="alg2.18.18.m1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.18.18.m1.1.1.1.1.2" xref="alg2.18.18.m1.1.1.1.1.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.18.18.m1.1.1.1.1.3" xref="alg2.18.18.m1.1.1.1.1.3.cmml">t</mi></msup><mo mathsize="90%" id="alg2.18.18.m1.2.2.2.4" xref="alg2.18.18.m1.2.2.3.cmml">,</mo><msup id="alg2.18.18.m1.2.2.2.2" xref="alg2.18.18.m1.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.18.18.m1.2.2.2.2.2" xref="alg2.18.18.m1.2.2.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.18.18.m1.2.2.2.2.3" xref="alg2.18.18.m1.2.2.2.2.3.cmml">t</mi></msup><mo maxsize="90%" minsize="90%" id="alg2.18.18.m1.2.2.2.5" xref="alg2.18.18.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.18.18.m1.2b"><interval closure="closed" id="alg2.18.18.m1.2.2.3.cmml" xref="alg2.18.18.m1.2.2.2"><apply id="alg2.18.18.m1.1.1.1.1.cmml" xref="alg2.18.18.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.18.18.m1.1.1.1.1.1.cmml" xref="alg2.18.18.m1.1.1.1.1">superscript</csymbol><ci id="alg2.18.18.m1.1.1.1.1.2.cmml" xref="alg2.18.18.m1.1.1.1.1.2">Θ</ci><ci id="alg2.18.18.m1.1.1.1.1.3.cmml" xref="alg2.18.18.m1.1.1.1.1.3">𝑡</ci></apply><apply id="alg2.18.18.m1.2.2.2.2.cmml" xref="alg2.18.18.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.18.18.m1.2.2.2.2.1.cmml" xref="alg2.18.18.m1.2.2.2.2">superscript</csymbol><ci id="alg2.18.18.m1.2.2.2.2.2.cmml" xref="alg2.18.18.m1.2.2.2.2.2">𝜃</ci><ci id="alg2.18.18.m1.2.2.2.2.3.cmml" xref="alg2.18.18.m1.2.2.2.2.3">𝑡</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.18.18.m1.2c">[\Theta^{t},\theta^{t}]</annotation></semantics></math>
</div>
<div id="alg2.19.19" class="ltx_listingline">
<span id="alg2.19.19.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.19.19.2" class="ltx_text" style="font-size:90%;">
</span><span id="alg2.19.19.3" class="ltx_text" style="font-size:90%;"><span id="alg2.19.19.3.1" class="ltx_text ltx_font_bold">Output:</span> </span><span id="alg2.19.19.4" class="ltx_text" style="font-size:90%;">updated local model </span><math id="alg2.19.19.m1.2" class="ltx_Math" alttext="[\Theta^{t}_{k},\theta^{t}_{k}]" display="inline"><semantics id="alg2.19.19.m1.2a"><mrow id="alg2.19.19.m1.2.2.2" xref="alg2.19.19.m1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.19.19.m1.2.2.2.3" xref="alg2.19.19.m1.2.2.3.cmml">[</mo><msubsup id="alg2.19.19.m1.1.1.1.1" xref="alg2.19.19.m1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.19.19.m1.1.1.1.1.2.2" xref="alg2.19.19.m1.1.1.1.1.2.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.19.19.m1.1.1.1.1.3" xref="alg2.19.19.m1.1.1.1.1.3.cmml">k</mi><mi mathsize="90%" id="alg2.19.19.m1.1.1.1.1.2.3" xref="alg2.19.19.m1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo mathsize="90%" id="alg2.19.19.m1.2.2.2.4" xref="alg2.19.19.m1.2.2.3.cmml">,</mo><msubsup id="alg2.19.19.m1.2.2.2.2" xref="alg2.19.19.m1.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.19.19.m1.2.2.2.2.2.2" xref="alg2.19.19.m1.2.2.2.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.19.19.m1.2.2.2.2.3" xref="alg2.19.19.m1.2.2.2.2.3.cmml">k</mi><mi mathsize="90%" id="alg2.19.19.m1.2.2.2.2.2.3" xref="alg2.19.19.m1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg2.19.19.m1.2.2.2.5" xref="alg2.19.19.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.19.19.m1.2b"><interval closure="closed" id="alg2.19.19.m1.2.2.3.cmml" xref="alg2.19.19.m1.2.2.2"><apply id="alg2.19.19.m1.1.1.1.1.cmml" xref="alg2.19.19.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.19.19.m1.1.1.1.1.1.cmml" xref="alg2.19.19.m1.1.1.1.1">subscript</csymbol><apply id="alg2.19.19.m1.1.1.1.1.2.cmml" xref="alg2.19.19.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.19.19.m1.1.1.1.1.2.1.cmml" xref="alg2.19.19.m1.1.1.1.1">superscript</csymbol><ci id="alg2.19.19.m1.1.1.1.1.2.2.cmml" xref="alg2.19.19.m1.1.1.1.1.2.2">Θ</ci><ci id="alg2.19.19.m1.1.1.1.1.2.3.cmml" xref="alg2.19.19.m1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg2.19.19.m1.1.1.1.1.3.cmml" xref="alg2.19.19.m1.1.1.1.1.3">𝑘</ci></apply><apply id="alg2.19.19.m1.2.2.2.2.cmml" xref="alg2.19.19.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.19.19.m1.2.2.2.2.1.cmml" xref="alg2.19.19.m1.2.2.2.2">subscript</csymbol><apply id="alg2.19.19.m1.2.2.2.2.2.cmml" xref="alg2.19.19.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.19.19.m1.2.2.2.2.2.1.cmml" xref="alg2.19.19.m1.2.2.2.2">superscript</csymbol><ci id="alg2.19.19.m1.2.2.2.2.2.2.cmml" xref="alg2.19.19.m1.2.2.2.2.2.2">𝜃</ci><ci id="alg2.19.19.m1.2.2.2.2.2.3.cmml" xref="alg2.19.19.m1.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg2.19.19.m1.2.2.2.2.3.cmml" xref="alg2.19.19.m1.2.2.2.2.3">𝑘</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.19.19.m1.2c">[\Theta^{t}_{k},\theta^{t}_{k}]</annotation></semantics></math>
</div>
<div id="alg2.26.33" class="ltx_listingline">
<span id="alg2.26.33.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.26.33.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.20.20" class="ltx_listingline">
<span id="alg2.20.20.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.20.20.2" class="ltx_text" style="font-size:90%;">Sample a batch of episodes </span><math id="alg2.20.20.m1.3" class="ltx_Math" alttext="\mathcal{B}_{k}=\{\mathcal{T}_{1},...,\mathcal{T}_{n}\}" display="inline"><semantics id="alg2.20.20.m1.3a"><mrow id="alg2.20.20.m1.3.3" xref="alg2.20.20.m1.3.3.cmml"><msub id="alg2.20.20.m1.3.3.4" xref="alg2.20.20.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.20.20.m1.3.3.4.2" xref="alg2.20.20.m1.3.3.4.2.cmml">ℬ</mi><mi mathsize="90%" id="alg2.20.20.m1.3.3.4.3" xref="alg2.20.20.m1.3.3.4.3.cmml">k</mi></msub><mo mathsize="90%" id="alg2.20.20.m1.3.3.3" xref="alg2.20.20.m1.3.3.3.cmml">=</mo><mrow id="alg2.20.20.m1.3.3.2.2" xref="alg2.20.20.m1.3.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.20.20.m1.3.3.2.2.3" xref="alg2.20.20.m1.3.3.2.3.cmml">{</mo><msub id="alg2.20.20.m1.2.2.1.1.1" xref="alg2.20.20.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.20.20.m1.2.2.1.1.1.2" xref="alg2.20.20.m1.2.2.1.1.1.2.cmml">𝒯</mi><mn mathsize="90%" id="alg2.20.20.m1.2.2.1.1.1.3" xref="alg2.20.20.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="alg2.20.20.m1.3.3.2.2.4" xref="alg2.20.20.m1.3.3.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg2.20.20.m1.1.1" xref="alg2.20.20.m1.1.1.cmml">…</mi><mo mathsize="90%" id="alg2.20.20.m1.3.3.2.2.5" xref="alg2.20.20.m1.3.3.2.3.cmml">,</mo><msub id="alg2.20.20.m1.3.3.2.2.2" xref="alg2.20.20.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg2.20.20.m1.3.3.2.2.2.2" xref="alg2.20.20.m1.3.3.2.2.2.2.cmml">𝒯</mi><mi mathsize="90%" id="alg2.20.20.m1.3.3.2.2.2.3" xref="alg2.20.20.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.20.20.m1.3.3.2.2.6" xref="alg2.20.20.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.20.20.m1.3b"><apply id="alg2.20.20.m1.3.3.cmml" xref="alg2.20.20.m1.3.3"><eq id="alg2.20.20.m1.3.3.3.cmml" xref="alg2.20.20.m1.3.3.3"></eq><apply id="alg2.20.20.m1.3.3.4.cmml" xref="alg2.20.20.m1.3.3.4"><csymbol cd="ambiguous" id="alg2.20.20.m1.3.3.4.1.cmml" xref="alg2.20.20.m1.3.3.4">subscript</csymbol><ci id="alg2.20.20.m1.3.3.4.2.cmml" xref="alg2.20.20.m1.3.3.4.2">ℬ</ci><ci id="alg2.20.20.m1.3.3.4.3.cmml" xref="alg2.20.20.m1.3.3.4.3">𝑘</ci></apply><set id="alg2.20.20.m1.3.3.2.3.cmml" xref="alg2.20.20.m1.3.3.2.2"><apply id="alg2.20.20.m1.2.2.1.1.1.cmml" xref="alg2.20.20.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.20.20.m1.2.2.1.1.1.1.cmml" xref="alg2.20.20.m1.2.2.1.1.1">subscript</csymbol><ci id="alg2.20.20.m1.2.2.1.1.1.2.cmml" xref="alg2.20.20.m1.2.2.1.1.1.2">𝒯</ci><cn type="integer" id="alg2.20.20.m1.2.2.1.1.1.3.cmml" xref="alg2.20.20.m1.2.2.1.1.1.3">1</cn></apply><ci id="alg2.20.20.m1.1.1.cmml" xref="alg2.20.20.m1.1.1">…</ci><apply id="alg2.20.20.m1.3.3.2.2.2.cmml" xref="alg2.20.20.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg2.20.20.m1.3.3.2.2.2.1.cmml" xref="alg2.20.20.m1.3.3.2.2.2">subscript</csymbol><ci id="alg2.20.20.m1.3.3.2.2.2.2.cmml" xref="alg2.20.20.m1.3.3.2.2.2.2">𝒯</ci><ci id="alg2.20.20.m1.3.3.2.2.2.3.cmml" xref="alg2.20.20.m1.3.3.2.2.2.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.20.20.m1.3c">\mathcal{B}_{k}=\{\mathcal{T}_{1},...,\mathcal{T}_{n}\}</annotation></semantics></math><span id="alg2.20.20.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.21.21" class="ltx_listingline">
<span id="alg2.21.21.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.21.21.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg2.21.21.m1.4" class="ltx_Math" alttext="[\Theta_{k},\theta_{k}]\leftarrow[\Theta^{t},\theta^{t}]" display="inline"><semantics id="alg2.21.21.m1.4a"><mrow id="alg2.21.21.m1.4.4" xref="alg2.21.21.m1.4.4.cmml"><mrow id="alg2.21.21.m1.2.2.2.2" xref="alg2.21.21.m1.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.21.21.m1.2.2.2.2.3" xref="alg2.21.21.m1.2.2.2.3.cmml">[</mo><msub id="alg2.21.21.m1.1.1.1.1.1" xref="alg2.21.21.m1.1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.21.21.m1.1.1.1.1.1.2" xref="alg2.21.21.m1.1.1.1.1.1.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.21.21.m1.1.1.1.1.1.3" xref="alg2.21.21.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo mathsize="90%" id="alg2.21.21.m1.2.2.2.2.4" xref="alg2.21.21.m1.2.2.2.3.cmml">,</mo><msub id="alg2.21.21.m1.2.2.2.2.2" xref="alg2.21.21.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.21.21.m1.2.2.2.2.2.2" xref="alg2.21.21.m1.2.2.2.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.21.21.m1.2.2.2.2.2.3" xref="alg2.21.21.m1.2.2.2.2.2.3.cmml">k</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.21.21.m1.2.2.2.2.5" xref="alg2.21.21.m1.2.2.2.3.cmml">]</mo></mrow><mo mathsize="90%" stretchy="false" id="alg2.21.21.m1.4.4.5" xref="alg2.21.21.m1.4.4.5.cmml">←</mo><mrow id="alg2.21.21.m1.4.4.4.2" xref="alg2.21.21.m1.4.4.4.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.21.21.m1.4.4.4.2.3" xref="alg2.21.21.m1.4.4.4.3.cmml">[</mo><msup id="alg2.21.21.m1.3.3.3.1.1" xref="alg2.21.21.m1.3.3.3.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.21.21.m1.3.3.3.1.1.2" xref="alg2.21.21.m1.3.3.3.1.1.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.21.21.m1.3.3.3.1.1.3" xref="alg2.21.21.m1.3.3.3.1.1.3.cmml">t</mi></msup><mo mathsize="90%" id="alg2.21.21.m1.4.4.4.2.4" xref="alg2.21.21.m1.4.4.4.3.cmml">,</mo><msup id="alg2.21.21.m1.4.4.4.2.2" xref="alg2.21.21.m1.4.4.4.2.2.cmml"><mi mathsize="90%" id="alg2.21.21.m1.4.4.4.2.2.2" xref="alg2.21.21.m1.4.4.4.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.21.21.m1.4.4.4.2.2.3" xref="alg2.21.21.m1.4.4.4.2.2.3.cmml">t</mi></msup><mo maxsize="90%" minsize="90%" id="alg2.21.21.m1.4.4.4.2.5" xref="alg2.21.21.m1.4.4.4.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.21.21.m1.4b"><apply id="alg2.21.21.m1.4.4.cmml" xref="alg2.21.21.m1.4.4"><ci id="alg2.21.21.m1.4.4.5.cmml" xref="alg2.21.21.m1.4.4.5">←</ci><interval closure="closed" id="alg2.21.21.m1.2.2.2.3.cmml" xref="alg2.21.21.m1.2.2.2.2"><apply id="alg2.21.21.m1.1.1.1.1.1.cmml" xref="alg2.21.21.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.21.21.m1.1.1.1.1.1.1.cmml" xref="alg2.21.21.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.21.21.m1.1.1.1.1.1.2.cmml" xref="alg2.21.21.m1.1.1.1.1.1.2">Θ</ci><ci id="alg2.21.21.m1.1.1.1.1.1.3.cmml" xref="alg2.21.21.m1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg2.21.21.m1.2.2.2.2.2.cmml" xref="alg2.21.21.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.21.21.m1.2.2.2.2.2.1.cmml" xref="alg2.21.21.m1.2.2.2.2.2">subscript</csymbol><ci id="alg2.21.21.m1.2.2.2.2.2.2.cmml" xref="alg2.21.21.m1.2.2.2.2.2.2">𝜃</ci><ci id="alg2.21.21.m1.2.2.2.2.2.3.cmml" xref="alg2.21.21.m1.2.2.2.2.2.3">𝑘</ci></apply></interval><interval closure="closed" id="alg2.21.21.m1.4.4.4.3.cmml" xref="alg2.21.21.m1.4.4.4.2"><apply id="alg2.21.21.m1.3.3.3.1.1.cmml" xref="alg2.21.21.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="alg2.21.21.m1.3.3.3.1.1.1.cmml" xref="alg2.21.21.m1.3.3.3.1.1">superscript</csymbol><ci id="alg2.21.21.m1.3.3.3.1.1.2.cmml" xref="alg2.21.21.m1.3.3.3.1.1.2">Θ</ci><ci id="alg2.21.21.m1.3.3.3.1.1.3.cmml" xref="alg2.21.21.m1.3.3.3.1.1.3">𝑡</ci></apply><apply id="alg2.21.21.m1.4.4.4.2.2.cmml" xref="alg2.21.21.m1.4.4.4.2.2"><csymbol cd="ambiguous" id="alg2.21.21.m1.4.4.4.2.2.1.cmml" xref="alg2.21.21.m1.4.4.4.2.2">superscript</csymbol><ci id="alg2.21.21.m1.4.4.4.2.2.2.cmml" xref="alg2.21.21.m1.4.4.4.2.2.2">𝜃</ci><ci id="alg2.21.21.m1.4.4.4.2.2.3.cmml" xref="alg2.21.21.m1.4.4.4.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.21.21.m1.4c">[\Theta_{k},\theta_{k}]\leftarrow[\Theta^{t},\theta^{t}]</annotation></semantics></math><span id="alg2.21.21.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.22.22" class="ltx_listingline">
<span id="alg2.22.22.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.22.22.2" class="ltx_text" style="font-size:90%;">
Initialize a new classifier </span><math id="alg2.22.22.m1.1" class="ltx_Math" alttext="\theta_{k}^{\prime}" display="inline"><semantics id="alg2.22.22.m1.1a"><msubsup id="alg2.22.22.m1.1.1" xref="alg2.22.22.m1.1.1.cmml"><mi mathsize="90%" id="alg2.22.22.m1.1.1.2.2" xref="alg2.22.22.m1.1.1.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.22.22.m1.1.1.2.3" xref="alg2.22.22.m1.1.1.2.3.cmml">k</mi><mo mathsize="90%" id="alg2.22.22.m1.1.1.3" xref="alg2.22.22.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg2.22.22.m1.1b"><apply id="alg2.22.22.m1.1.1.cmml" xref="alg2.22.22.m1.1.1"><csymbol cd="ambiguous" id="alg2.22.22.m1.1.1.1.cmml" xref="alg2.22.22.m1.1.1">superscript</csymbol><apply id="alg2.22.22.m1.1.1.2.cmml" xref="alg2.22.22.m1.1.1"><csymbol cd="ambiguous" id="alg2.22.22.m1.1.1.2.1.cmml" xref="alg2.22.22.m1.1.1">subscript</csymbol><ci id="alg2.22.22.m1.1.1.2.2.cmml" xref="alg2.22.22.m1.1.1.2.2">𝜃</ci><ci id="alg2.22.22.m1.1.1.2.3.cmml" xref="alg2.22.22.m1.1.1.2.3">𝑘</ci></apply><ci id="alg2.22.22.m1.1.1.3.cmml" xref="alg2.22.22.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.22.22.m1.1c">\theta_{k}^{\prime}</annotation></semantics></math><span id="alg2.22.22.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.23.23" class="ltx_listingline">
<span id="alg2.23.23.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.23.23.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg2.23.23.m1.2" class="ltx_Math" alttext="\theta_{k},\theta_{k}^{\prime}\leftarrow" display="inline"><semantics id="alg2.23.23.m1.2a"><mrow id="alg2.23.23.m1.2.2" xref="alg2.23.23.m1.2.2.cmml"><mrow id="alg2.23.23.m1.2.2.2.2" xref="alg2.23.23.m1.2.2.2.3.cmml"><msub id="alg2.23.23.m1.1.1.1.1.1" xref="alg2.23.23.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.23.23.m1.1.1.1.1.1.2" xref="alg2.23.23.m1.1.1.1.1.1.2.cmml">θ</mi><mi mathsize="90%" id="alg2.23.23.m1.1.1.1.1.1.3" xref="alg2.23.23.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo mathsize="90%" id="alg2.23.23.m1.2.2.2.2.3" xref="alg2.23.23.m1.2.2.2.3.cmml">,</mo><msubsup id="alg2.23.23.m1.2.2.2.2.2" xref="alg2.23.23.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.23.23.m1.2.2.2.2.2.2.2" xref="alg2.23.23.m1.2.2.2.2.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.23.23.m1.2.2.2.2.2.2.3" xref="alg2.23.23.m1.2.2.2.2.2.2.3.cmml">k</mi><mo mathsize="90%" id="alg2.23.23.m1.2.2.2.2.2.3" xref="alg2.23.23.m1.2.2.2.2.2.3.cmml">′</mo></msubsup></mrow><mo mathsize="90%" stretchy="false" id="alg2.23.23.m1.2.2.3" xref="alg2.23.23.m1.2.2.3.cmml">←</mo><mi id="alg2.23.23.m1.2.2.4" xref="alg2.23.23.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.23.23.m1.2b"><apply id="alg2.23.23.m1.2.2.cmml" xref="alg2.23.23.m1.2.2"><ci id="alg2.23.23.m1.2.2.3.cmml" xref="alg2.23.23.m1.2.2.3">←</ci><list id="alg2.23.23.m1.2.2.2.3.cmml" xref="alg2.23.23.m1.2.2.2.2"><apply id="alg2.23.23.m1.1.1.1.1.1.cmml" xref="alg2.23.23.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.23.23.m1.1.1.1.1.1.1.cmml" xref="alg2.23.23.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.23.23.m1.1.1.1.1.1.2.cmml" xref="alg2.23.23.m1.1.1.1.1.1.2">𝜃</ci><ci id="alg2.23.23.m1.1.1.1.1.1.3.cmml" xref="alg2.23.23.m1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg2.23.23.m1.2.2.2.2.2.cmml" xref="alg2.23.23.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.23.23.m1.2.2.2.2.2.1.cmml" xref="alg2.23.23.m1.2.2.2.2.2">superscript</csymbol><apply id="alg2.23.23.m1.2.2.2.2.2.2.cmml" xref="alg2.23.23.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.23.23.m1.2.2.2.2.2.2.1.cmml" xref="alg2.23.23.m1.2.2.2.2.2">subscript</csymbol><ci id="alg2.23.23.m1.2.2.2.2.2.2.2.cmml" xref="alg2.23.23.m1.2.2.2.2.2.2.2">𝜃</ci><ci id="alg2.23.23.m1.2.2.2.2.2.2.3.cmml" xref="alg2.23.23.m1.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="alg2.23.23.m1.2.2.2.2.2.3.cmml" xref="alg2.23.23.m1.2.2.2.2.2.3">′</ci></apply></list><csymbol cd="latexml" id="alg2.23.23.m1.2.2.4.cmml" xref="alg2.23.23.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.23.23.m1.2c">\theta_{k},\theta_{k}^{\prime}\leftarrow</annotation></semantics></math><span id="alg2.23.23.3" class="ltx_text" style="font-size:90%;"> Solve Eq.(</span><a href="#S4.E15" title="In 1st item ‣ 4.2.3. Adversarial learning procedure ‣ 4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">15</span></a><span id="alg2.23.23.4" class="ltx_text" style="font-size:90%;">) with SGD </span>
</div>
<div id="alg2.24.24" class="ltx_listingline">
<span id="alg2.24.24.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.24.24.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg2.24.24.m1.1" class="ltx_Math" alttext="\Theta_{k}\leftarrow" display="inline"><semantics id="alg2.24.24.m1.1a"><mrow id="alg2.24.24.m1.1.1" xref="alg2.24.24.m1.1.1.cmml"><msub id="alg2.24.24.m1.1.1.2" xref="alg2.24.24.m1.1.1.2.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.24.24.m1.1.1.2.2" xref="alg2.24.24.m1.1.1.2.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.24.24.m1.1.1.2.3" xref="alg2.24.24.m1.1.1.2.3.cmml">k</mi></msub><mo mathsize="90%" stretchy="false" id="alg2.24.24.m1.1.1.1" xref="alg2.24.24.m1.1.1.1.cmml">←</mo><mi id="alg2.24.24.m1.1.1.3" xref="alg2.24.24.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.24.24.m1.1b"><apply id="alg2.24.24.m1.1.1.cmml" xref="alg2.24.24.m1.1.1"><ci id="alg2.24.24.m1.1.1.1.cmml" xref="alg2.24.24.m1.1.1.1">←</ci><apply id="alg2.24.24.m1.1.1.2.cmml" xref="alg2.24.24.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.24.24.m1.1.1.2.1.cmml" xref="alg2.24.24.m1.1.1.2">subscript</csymbol><ci id="alg2.24.24.m1.1.1.2.2.cmml" xref="alg2.24.24.m1.1.1.2.2">Θ</ci><ci id="alg2.24.24.m1.1.1.2.3.cmml" xref="alg2.24.24.m1.1.1.2.3">𝑘</ci></apply><csymbol cd="latexml" id="alg2.24.24.m1.1.1.3.cmml" xref="alg2.24.24.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.24.24.m1.1c">\Theta_{k}\leftarrow</annotation></semantics></math><span id="alg2.24.24.3" class="ltx_text" style="font-size:90%;"> Solve Eq.(</span><a href="#S4.E16" title="In 2nd item ‣ 4.2.3. Adversarial learning procedure ‣ 4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">16</span></a><span id="alg2.24.24.4" class="ltx_text" style="font-size:90%;">) with SGD </span>
</div>
<div id="alg2.25.25" class="ltx_listingline">
<span id="alg2.25.25.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.25.25.2" class="ltx_text" style="font-size:90%;">
</span><math id="alg2.25.25.m1.4" class="ltx_Math" alttext="[\Theta^{t}_{k},\theta^{t}_{k}]\leftarrow[\Theta_{k},\theta_{k}]" display="inline"><semantics id="alg2.25.25.m1.4a"><mrow id="alg2.25.25.m1.4.4" xref="alg2.25.25.m1.4.4.cmml"><mrow id="alg2.25.25.m1.2.2.2.2" xref="alg2.25.25.m1.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.25.25.m1.2.2.2.2.3" xref="alg2.25.25.m1.2.2.2.3.cmml">[</mo><msubsup id="alg2.25.25.m1.1.1.1.1.1" xref="alg2.25.25.m1.1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.25.25.m1.1.1.1.1.1.2.2" xref="alg2.25.25.m1.1.1.1.1.1.2.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.25.25.m1.1.1.1.1.1.3" xref="alg2.25.25.m1.1.1.1.1.1.3.cmml">k</mi><mi mathsize="90%" id="alg2.25.25.m1.1.1.1.1.1.2.3" xref="alg2.25.25.m1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo mathsize="90%" id="alg2.25.25.m1.2.2.2.2.4" xref="alg2.25.25.m1.2.2.2.3.cmml">,</mo><msubsup id="alg2.25.25.m1.2.2.2.2.2" xref="alg2.25.25.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.25.25.m1.2.2.2.2.2.2.2" xref="alg2.25.25.m1.2.2.2.2.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.25.25.m1.2.2.2.2.2.3" xref="alg2.25.25.m1.2.2.2.2.2.3.cmml">k</mi><mi mathsize="90%" id="alg2.25.25.m1.2.2.2.2.2.2.3" xref="alg2.25.25.m1.2.2.2.2.2.2.3.cmml">t</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg2.25.25.m1.2.2.2.2.5" xref="alg2.25.25.m1.2.2.2.3.cmml">]</mo></mrow><mo mathsize="90%" stretchy="false" id="alg2.25.25.m1.4.4.5" xref="alg2.25.25.m1.4.4.5.cmml">←</mo><mrow id="alg2.25.25.m1.4.4.4.2" xref="alg2.25.25.m1.4.4.4.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.25.25.m1.4.4.4.2.3" xref="alg2.25.25.m1.4.4.4.3.cmml">[</mo><msub id="alg2.25.25.m1.3.3.3.1.1" xref="alg2.25.25.m1.3.3.3.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.25.25.m1.3.3.3.1.1.2" xref="alg2.25.25.m1.3.3.3.1.1.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.25.25.m1.3.3.3.1.1.3" xref="alg2.25.25.m1.3.3.3.1.1.3.cmml">k</mi></msub><mo mathsize="90%" id="alg2.25.25.m1.4.4.4.2.4" xref="alg2.25.25.m1.4.4.4.3.cmml">,</mo><msub id="alg2.25.25.m1.4.4.4.2.2" xref="alg2.25.25.m1.4.4.4.2.2.cmml"><mi mathsize="90%" id="alg2.25.25.m1.4.4.4.2.2.2" xref="alg2.25.25.m1.4.4.4.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.25.25.m1.4.4.4.2.2.3" xref="alg2.25.25.m1.4.4.4.2.2.3.cmml">k</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.25.25.m1.4.4.4.2.5" xref="alg2.25.25.m1.4.4.4.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.25.25.m1.4b"><apply id="alg2.25.25.m1.4.4.cmml" xref="alg2.25.25.m1.4.4"><ci id="alg2.25.25.m1.4.4.5.cmml" xref="alg2.25.25.m1.4.4.5">←</ci><interval closure="closed" id="alg2.25.25.m1.2.2.2.3.cmml" xref="alg2.25.25.m1.2.2.2.2"><apply id="alg2.25.25.m1.1.1.1.1.1.cmml" xref="alg2.25.25.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.25.25.m1.1.1.1.1.1.1.cmml" xref="alg2.25.25.m1.1.1.1.1.1">subscript</csymbol><apply id="alg2.25.25.m1.1.1.1.1.1.2.cmml" xref="alg2.25.25.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.25.25.m1.1.1.1.1.1.2.1.cmml" xref="alg2.25.25.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.25.25.m1.1.1.1.1.1.2.2.cmml" xref="alg2.25.25.m1.1.1.1.1.1.2.2">Θ</ci><ci id="alg2.25.25.m1.1.1.1.1.1.2.3.cmml" xref="alg2.25.25.m1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg2.25.25.m1.1.1.1.1.1.3.cmml" xref="alg2.25.25.m1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg2.25.25.m1.2.2.2.2.2.cmml" xref="alg2.25.25.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.25.25.m1.2.2.2.2.2.1.cmml" xref="alg2.25.25.m1.2.2.2.2.2">subscript</csymbol><apply id="alg2.25.25.m1.2.2.2.2.2.2.cmml" xref="alg2.25.25.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.25.25.m1.2.2.2.2.2.2.1.cmml" xref="alg2.25.25.m1.2.2.2.2.2">superscript</csymbol><ci id="alg2.25.25.m1.2.2.2.2.2.2.2.cmml" xref="alg2.25.25.m1.2.2.2.2.2.2.2">𝜃</ci><ci id="alg2.25.25.m1.2.2.2.2.2.2.3.cmml" xref="alg2.25.25.m1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg2.25.25.m1.2.2.2.2.2.3.cmml" xref="alg2.25.25.m1.2.2.2.2.2.3">𝑘</ci></apply></interval><interval closure="closed" id="alg2.25.25.m1.4.4.4.3.cmml" xref="alg2.25.25.m1.4.4.4.2"><apply id="alg2.25.25.m1.3.3.3.1.1.cmml" xref="alg2.25.25.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="alg2.25.25.m1.3.3.3.1.1.1.cmml" xref="alg2.25.25.m1.3.3.3.1.1">subscript</csymbol><ci id="alg2.25.25.m1.3.3.3.1.1.2.cmml" xref="alg2.25.25.m1.3.3.3.1.1.2">Θ</ci><ci id="alg2.25.25.m1.3.3.3.1.1.3.cmml" xref="alg2.25.25.m1.3.3.3.1.1.3">𝑘</ci></apply><apply id="alg2.25.25.m1.4.4.4.2.2.cmml" xref="alg2.25.25.m1.4.4.4.2.2"><csymbol cd="ambiguous" id="alg2.25.25.m1.4.4.4.2.2.1.cmml" xref="alg2.25.25.m1.4.4.4.2.2">subscript</csymbol><ci id="alg2.25.25.m1.4.4.4.2.2.2.cmml" xref="alg2.25.25.m1.4.4.4.2.2.2">𝜃</ci><ci id="alg2.25.25.m1.4.4.4.2.2.3.cmml" xref="alg2.25.25.m1.4.4.4.2.2.3">𝑘</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.25.25.m1.4c">[\Theta^{t}_{k},\theta^{t}_{k}]\leftarrow[\Theta_{k},\theta_{k}]</annotation></semantics></math><span id="alg2.25.25.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.26.26" class="ltx_listingline">
<span id="alg2.26.26.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.26.26.2" class="ltx_text" style="font-size:90%;">
Return </span><math id="alg2.26.26.m1.2" class="ltx_Math" alttext="[\Theta^{t}_{k},\theta^{t}_{k}]" display="inline"><semantics id="alg2.26.26.m1.2a"><mrow id="alg2.26.26.m1.2.2.2" xref="alg2.26.26.m1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.26.26.m1.2.2.2.3" xref="alg2.26.26.m1.2.2.3.cmml">[</mo><msubsup id="alg2.26.26.m1.1.1.1.1" xref="alg2.26.26.m1.1.1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="alg2.26.26.m1.1.1.1.1.2.2" xref="alg2.26.26.m1.1.1.1.1.2.2.cmml">Θ</mi><mi mathsize="90%" id="alg2.26.26.m1.1.1.1.1.3" xref="alg2.26.26.m1.1.1.1.1.3.cmml">k</mi><mi mathsize="90%" id="alg2.26.26.m1.1.1.1.1.2.3" xref="alg2.26.26.m1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo mathsize="90%" id="alg2.26.26.m1.2.2.2.4" xref="alg2.26.26.m1.2.2.3.cmml">,</mo><msubsup id="alg2.26.26.m1.2.2.2.2" xref="alg2.26.26.m1.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.26.26.m1.2.2.2.2.2.2" xref="alg2.26.26.m1.2.2.2.2.2.2.cmml">θ</mi><mi mathsize="90%" id="alg2.26.26.m1.2.2.2.2.3" xref="alg2.26.26.m1.2.2.2.2.3.cmml">k</mi><mi mathsize="90%" id="alg2.26.26.m1.2.2.2.2.2.3" xref="alg2.26.26.m1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg2.26.26.m1.2.2.2.5" xref="alg2.26.26.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.26.26.m1.2b"><interval closure="closed" id="alg2.26.26.m1.2.2.3.cmml" xref="alg2.26.26.m1.2.2.2"><apply id="alg2.26.26.m1.1.1.1.1.cmml" xref="alg2.26.26.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.26.26.m1.1.1.1.1.1.cmml" xref="alg2.26.26.m1.1.1.1.1">subscript</csymbol><apply id="alg2.26.26.m1.1.1.1.1.2.cmml" xref="alg2.26.26.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.26.26.m1.1.1.1.1.2.1.cmml" xref="alg2.26.26.m1.1.1.1.1">superscript</csymbol><ci id="alg2.26.26.m1.1.1.1.1.2.2.cmml" xref="alg2.26.26.m1.1.1.1.1.2.2">Θ</ci><ci id="alg2.26.26.m1.1.1.1.1.2.3.cmml" xref="alg2.26.26.m1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg2.26.26.m1.1.1.1.1.3.cmml" xref="alg2.26.26.m1.1.1.1.1.3">𝑘</ci></apply><apply id="alg2.26.26.m1.2.2.2.2.cmml" xref="alg2.26.26.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.26.26.m1.2.2.2.2.1.cmml" xref="alg2.26.26.m1.2.2.2.2">subscript</csymbol><apply id="alg2.26.26.m1.2.2.2.2.2.cmml" xref="alg2.26.26.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.26.26.m1.2.2.2.2.2.1.cmml" xref="alg2.26.26.m1.2.2.2.2">superscript</csymbol><ci id="alg2.26.26.m1.2.2.2.2.2.2.cmml" xref="alg2.26.26.m1.2.2.2.2.2.2">𝜃</ci><ci id="alg2.26.26.m1.2.2.2.2.2.3.cmml" xref="alg2.26.26.m1.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg2.26.26.m1.2.2.2.2.3.cmml" xref="alg2.26.26.m1.2.2.2.2.3">𝑘</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.26.26.m1.2c">[\Theta^{t}_{k},\theta^{t}_{k}]</annotation></semantics></math><span id="alg2.26.26.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg2.26.34" class="ltx_listingline">
<span id="alg2.26.34.1" class="ltx_text" style="font-size:90%;">          </span><span id="alg2.26.34.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.26.35" class="ltx_listingline">
<span id="alg2.26.35.1" class="ltx_text" style="font-size:90%;">
</span>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg2.30.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span>FedFSL-MI-Adv algorithm.</figcaption>
</figure>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiments and Discussions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We first provide details of the model architecture, parameter settings, and datasets that we use in the experiments.
Then we visualize the decision boundaries of our approaches with a toy example. We then demonstrate the performance of our proposed algorithms with two typical few-shot classification tasks – 5-way 1-shot and 5-way 5-shot – on three benchmark datasets which cover machine vision and NLP tasks. We will make in-depth discussions.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Model architecture</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.4" class="ltx_p">We utilize a 12-layer deep neural network (DNN) as our base model (adopted from ResNet-12 <cite class="ltx_cite ltx_citemacro_citep">(He
et al<span class="ltx_text">.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2016</a>)</cite> which is commonly used for image classification tasks <cite class="ltx_cite ltx_citemacro_citep">(Sun
et al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2019</a>; Oreshkin
et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2018</a>; Zhang et al<span class="ltx_text">.</span>, <a href="#bib.bib42" title="" class="ltx_ref">2018a</a>)</cite>).
It consists of the feature extractor with 12 convolutional layers and about 5 million parameters in total, as well as two fully-connected layers with a ReLU nonlinearity as the classifier. We update model parameters by Adam solver <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a href="#bib.bib16" title="" class="ltx_ref">2015</a>)</cite> with a fixed learning rate <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="10^{-3}" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><msup id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">10</mn><mrow id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml"><mo id="S5.SS1.p1.1.m1.1.1.3a" xref="S5.SS1.p1.1.m1.1.1.3.cmml">−</mo><mn id="S5.SS1.p1.1.m1.1.1.3.2" xref="S5.SS1.p1.1.m1.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">10</cn><apply id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3"><minus id="S5.SS1.p1.1.m1.1.1.3.1.cmml" xref="S5.SS1.p1.1.m1.1.1.3"></minus><cn type="integer" id="S5.SS1.p1.1.m1.1.1.3.2.cmml" xref="S5.SS1.p1.1.m1.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">10^{-3}</annotation></semantics></math>. We
set the adaptation step size <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="\alpha=0.01" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mi id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">α</mi><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><eq id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1"></eq><ci id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">𝛼</ci><cn type="float" id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\alpha=0.01</annotation></semantics></math> in (<a href="#S3.E4" title="In 2nd item ‣ 3.2. General Centralized Few-Shot Learning ‣ 3. Federated Few-shot Learning ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), the mutual information weight <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="\gamma=0.2" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mrow id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">γ</mi><mo id="S5.SS1.p1.3.m3.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.3.m3.1.1.3" xref="S5.SS1.p1.3.m3.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><eq id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1"></eq><ci id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">𝛾</ci><cn type="float" id="S5.SS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\gamma=0.2</annotation></semantics></math>, and the stage-1/-2 discrepancy loss weight <math id="S5.SS1.p1.4.m4.1" class="ltx_Math" alttext="\eta=\lambda=0.1" display="inline"><semantics id="S5.SS1.p1.4.m4.1a"><mrow id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml"><mi id="S5.SS1.p1.4.m4.1.1.2" xref="S5.SS1.p1.4.m4.1.1.2.cmml">η</mi><mo id="S5.SS1.p1.4.m4.1.1.3" xref="S5.SS1.p1.4.m4.1.1.3.cmml">=</mo><mi id="S5.SS1.p1.4.m4.1.1.4" xref="S5.SS1.p1.4.m4.1.1.4.cmml">λ</mi><mo id="S5.SS1.p1.4.m4.1.1.5" xref="S5.SS1.p1.4.m4.1.1.5.cmml">=</mo><mn id="S5.SS1.p1.4.m4.1.1.6" xref="S5.SS1.p1.4.m4.1.1.6.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><apply id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1"><and id="S5.SS1.p1.4.m4.1.1a.cmml" xref="S5.SS1.p1.4.m4.1.1"></and><apply id="S5.SS1.p1.4.m4.1.1b.cmml" xref="S5.SS1.p1.4.m4.1.1"><eq id="S5.SS1.p1.4.m4.1.1.3.cmml" xref="S5.SS1.p1.4.m4.1.1.3"></eq><ci id="S5.SS1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.p1.4.m4.1.1.2">𝜂</ci><ci id="S5.SS1.p1.4.m4.1.1.4.cmml" xref="S5.SS1.p1.4.m4.1.1.4">𝜆</ci></apply><apply id="S5.SS1.p1.4.m4.1.1c.cmml" xref="S5.SS1.p1.4.m4.1.1"><eq id="S5.SS1.p1.4.m4.1.1.5.cmml" xref="S5.SS1.p1.4.m4.1.1.5"></eq><share href="#S5.SS1.p1.4.m4.1.1.4.cmml" id="S5.SS1.p1.4.m4.1.1d.cmml" xref="S5.SS1.p1.4.m4.1.1"></share><cn type="float" id="S5.SS1.p1.4.m4.1.1.6.cmml" xref="S5.SS1.p1.4.m4.1.1.6">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">\eta=\lambda=0.1</annotation></semantics></math> in (<a href="#S4.E15" title="In 1st item ‣ 4.2.3. Adversarial learning procedure ‣ 4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>) and (<a href="#S4.E16" title="In 2nd item ‣ 4.2.3. Adversarial learning procedure ‣ 4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>).</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Datasets</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We briefly describe three benchmark datasets that are commonly used in studying FSL and FedL <cite class="ltx_cite ltx_citemacro_citep">(Finn
et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2017</a>; Munkhdalai and Yu, <a href="#bib.bib25" title="" class="ltx_ref">2017</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2017</a>; Sun
et al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2019</a>; Chen
et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite>.</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">mini<span id="S5.I1.i1.p1.1.1.1" class="ltx_text ltx_font_upright">ImageNet</span></span> <cite class="ltx_cite ltx_citemacro_citep">(Vinyals et al<span class="ltx_text">.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2016</a>)</cite> is based on a small portion of the full ImageNet images <cite class="ltx_cite ltx_citemacro_citep">(Deng
et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2009</a>)</cite>.
It has 100 classes of images split to 64/16/20 as train/val/test sets. Each class has 600 images with a resolution of 84 <math id="S5.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.I1.i1.p1.1.m1.1a"><mo id="S5.I1.i1.p1.1.m1.1.1" xref="S5.I1.i1.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.1.m1.1b"><times id="S5.I1.i1.p1.1.m1.1.1.cmml" xref="S5.I1.i1.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.1.m1.1c">\times</annotation></semantics></math> 84.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p"><span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">FC100</span> <cite class="ltx_cite ltx_citemacro_citep">(Oreshkin
et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2018</a>)</cite> is based on CIFAR-100 images that has 100 classes split to 60/20/20 as train/val/test splits. Each class has 600 images with a low resolution 32<math id="S5.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.I1.i2.p1.1.m1.1a"><mo id="S5.I1.i2.p1.1.m1.1.1" xref="S5.I1.i2.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.1.m1.1b"><times id="S5.I1.i2.p1.1.m1.1.1.cmml" xref="S5.I1.i2.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.1.m1.1c">\times</annotation></semantics></math>32. It is more challenging because of the low image quality.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p"><span id="S5.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Sent140</span> <cite class="ltx_cite ltx_citemacro_citep">(Caldas et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2018</a>)</cite> is a benchmark federated learning dataset for 2-way sentiment classification (positive and negative). We sampled from this dataset 10,000 annotated tweets provided by 310 twitter users and split them to train/val/test sets with provided tools. Each tweet has 1-20 English words. We tokenize the sentences and keep only common words which have GloVe representations <cite class="ltx_cite ltx_citemacro_citep">(Pennington
et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2014</a>)</cite>.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>MNIST Example</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">We provide a simple example on MNIST digit dataset in Fig. (<a href="#S5.F6" title="Figure 6 ‣ 5.3. MNIST Example ‣ 5. Experiments and Discussions ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>), to visualize and compare the decision boundaries of FedFSL-MI and FedFSL-MI-Adv.
We consider the 5-way 1-shot FSL task here: train a digit classification model on data of digits 0-4, and test its few-shot classification capability on digits 5-9 by observing just one labeled sample per class.
To better visualize the results, we manipulate the feature generator to produce a 2-dim feature for each input digit sample.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.1" class="ltx_p">In Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.3. MNIST Example ‣ 5. Experiments and Discussions ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>,
we plot the testing data samples from digit class 5-9 by projecting their features produced by the feature generators. We also depict the decision boundaries of the classifiers. Data samples of different classes are with different colors.
We observe that FedFSL-MI-Adv (left) produces more distinguishable decision boundaries than FedFSL-MI (right) as expected. The two algorithms achieve a few-shot classification accuracy of 87.5% and 83.6%, respectively.
The least accurate class recognized by FedFSL-MI-Adv is digit ’9’ (purple) of 73% correctness rate, with 18% misclassified as ’6’ (orange); while for FedFSL-MI is digit ’6’ (orange) of 64% correctness rate, with 23% misclassified as ’8’ (red).
This indicates that our adversarial learning approach proposed in Section <a href="#S4.SS2" title="4.2. Improving feature space with adversarial learning ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a> boosts the FedFSL task by constructing a more discriminative and transferable feature space for FSL.</p>
</div>
<figure id="S5.F6" class="ltx_figure"><img src="/html/2104.00365/assets/x6.png" id="S5.F6.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="133" height="56" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.3.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>. </span><span id="S5.F6.4.2" class="ltx_text" style="font-size:90%;">Visualization of decision boundaries of FedFSL-KD and FedFSL-KD-Adv at different epochs.</span></figcaption>
</figure>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Results on benchmark datasets</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.2" class="ltx_p">We experiment with our proposed three methods (FedFSL-naive, -MI, -MI-Adv) and two additional baselines (FSL-local and FedFSL-prox) for comparison.</p>
<ul id="S5.I2" class="ltx_itemize">
<li id="S5.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i1.p1" class="ltx_para">
<p id="S5.I2.i1.p1.1" class="ltx_p">FSL-local is a non-distributed baseline of training an individual FSL model for each client on local data and averaging their results on the shared testing tasks.</p>
</div>
</li>
<li id="S5.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i2.p1" class="ltx_para">
<p id="S5.I2.i2.p1.1" class="ltx_p">FedFSL-prox is a variant of FedFSL-naive by adding a weight regularization term as FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2018</a>)</cite> in objective.</p>
</div>
</li>
</ul>
<p id="S5.SS4.p1.1" class="ltx_p">We partition the data samples in IID and non-IID ways. For IID partition, data samples of each class are uniformly distributed to each client. To perform non-IID partition, we follow <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al<span class="ltx_text">.</span>, <a href="#bib.bib15" title="" class="ltx_ref">2019</a>; Yu
et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2020</a>)</cite> by dividing data samples to all clients class-by-class with Dirichlet distribution of concentration parameter <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><mrow id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS4.p1.1.m1.1.1.1" xref="S5.SS4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><eq id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1.1"></eq><ci id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">\alpha=1.0</annotation></semantics></math>. In Fig.<a href="#S5.SS4" title="5.4. Results on benchmark datasets ‣ 5. Experiments and Discussions ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a>, we show an example of such a partition of 64 training classes of miniImageNet on a randomly chosen client, when total device number is 2 to 30.</p>
</div>
<figure id="S5.SS4.1" class="ltx_figure ltx_minipage ltx_align_middle" style="width:95.4pt;"><img src="/html/2104.00365/assets/x7.png" id="S5.SS4.1.g1" class="ltx_graphics ltx_img_square" width="92" height="76" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.SS4.1.1.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>. </span><span id="S5.SS4.1.2.2" class="ltx_text" style="font-size:90%;">Non-IID data.</span></figcaption>
</figure>
<figure id="S5.SS4.fig1" class="ltx_figure ltx_minipage ltx_align_middle" style="width:112.7pt;">
<table id="S5.SS4.fig1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.SS4.fig1.1.1.1" class="ltx_tr">
<th id="S5.SS4.fig1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S5.SS4.fig1.1.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Method</span></th>
<th id="S5.SS4.fig1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S5.SS4.fig1.1.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Non-IID</span></th>
</tr>
<tr id="S5.SS4.fig1.1.2.2" class="ltx_tr">
<th id="S5.SS4.fig1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.SS4.fig1.1.2.2.1.1" class="ltx_text" style="font-size:90%;">1-shot</span></th>
<th id="S5.SS4.fig1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.SS4.fig1.1.2.2.2.1" class="ltx_text" style="font-size:90%;">5-shot</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.SS4.fig1.1.3.1" class="ltx_tr">
<th id="S5.SS4.fig1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S5.SS4.fig1.1.3.1.1.1" class="ltx_text" style="font-size:90%;">FedFSL-local</span></th>
<td id="S5.SS4.fig1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.SS4.fig1.1.3.1.2.1" class="ltx_text" style="font-size:90%;">59.70%</span></td>
<td id="S5.SS4.fig1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.SS4.fig1.1.3.1.3.1" class="ltx_text" style="font-size:90%;">66.68%</span></td>
</tr>
<tr id="S5.SS4.fig1.1.4.2" class="ltx_tr">
<th id="S5.SS4.fig1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.SS4.fig1.1.4.2.1.1" class="ltx_text" style="font-size:90%;">FedFSL-naive</span></th>
<td id="S5.SS4.fig1.1.4.2.2" class="ltx_td ltx_align_center"><span id="S5.SS4.fig1.1.4.2.2.1" class="ltx_text" style="font-size:90%;">68.85%</span></td>
<td id="S5.SS4.fig1.1.4.2.3" class="ltx_td ltx_align_center"><span id="S5.SS4.fig1.1.4.2.3.1" class="ltx_text" style="font-size:90%;">70.62%</span></td>
</tr>
<tr id="S5.SS4.fig1.1.5.3" class="ltx_tr">
<th id="S5.SS4.fig1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.SS4.fig1.1.5.3.1.1" class="ltx_text" style="font-size:90%;">FedFSL-prox</span></th>
<td id="S5.SS4.fig1.1.5.3.2" class="ltx_td ltx_align_center"><span id="S5.SS4.fig1.1.5.3.2.1" class="ltx_text" style="font-size:90%;">70.77%</span></td>
<td id="S5.SS4.fig1.1.5.3.3" class="ltx_td ltx_align_center"><span id="S5.SS4.fig1.1.5.3.3.1" class="ltx_text" style="font-size:90%;">72.25%</span></td>
</tr>
<tr id="S5.SS4.fig1.1.6.4" class="ltx_tr">
<th id="S5.SS4.fig1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.SS4.fig1.1.6.4.1.1" class="ltx_text" style="font-size:90%;">FedFSL-MI</span></th>
<td id="S5.SS4.fig1.1.6.4.2" class="ltx_td ltx_align_center"><span id="S5.SS4.fig1.1.6.4.2.1" class="ltx_text" style="font-size:90%;">70.37%</span></td>
<td id="S5.SS4.fig1.1.6.4.3" class="ltx_td ltx_align_center"><span id="S5.SS4.fig1.1.6.4.3.1" class="ltx_text" style="font-size:90%;">73.25%</span></td>
</tr>
<tr id="S5.SS4.fig1.1.7.5" class="ltx_tr">
<th id="S5.SS4.fig1.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_b"><span id="S5.SS4.fig1.1.7.5.1.1" class="ltx_text" style="font-size:90%;">FedFSL-MI-Adv</span></th>
<td id="S5.SS4.fig1.1.7.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S5.SS4.fig1.1.7.5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">71.35%</span></td>
<td id="S5.SS4.fig1.1.7.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S5.SS4.fig1.1.7.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">76.00%</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure">Table 2. </span>Sent140 results.</figcaption>
</figure>
<figure id="S5.T3" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T3.2.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>. </span><span id="S5.T3.3.2" class="ltx_text" style="font-size:90%;">Results on benchmark datasets.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.T3.st1" class="ltx_table ltx_figure_panel">
<table id="S5.T3.st1.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.st1.2.1.1" class="ltx_tr">
<th id="S5.T3.st1.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S5.T3.st1.2.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Method</span></th>
<th id="S5.T3.st1.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S5.T3.st1.2.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">IID</span></th>
<th id="S5.T3.st1.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S5.T3.st1.2.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Non-IID</span></th>
</tr>
<tr id="S5.T3.st1.2.2.2" class="ltx_tr">
<th id="S5.T3.st1.2.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.st1.2.2.2.1.1" class="ltx_text" style="font-size:90%;">1-shot</span></th>
<th id="S5.T3.st1.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.st1.2.2.2.2.1" class="ltx_text" style="font-size:90%;">5-shot</span></th>
<th id="S5.T3.st1.2.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.st1.2.2.2.3.1" class="ltx_text" style="font-size:90%;">1-shot</span></th>
<th id="S5.T3.st1.2.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.st1.2.2.2.4.1" class="ltx_text" style="font-size:90%;">5-shot</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.st1.2.3.1" class="ltx_tr">
<th id="S5.T3.st1.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S5.T3.st1.2.3.1.1.1" class="ltx_text" style="font-size:90%;">FSL-local</span></th>
<td id="S5.T3.st1.2.3.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T3.st1.2.3.1.2.1" class="ltx_text" style="font-size:90%;">50.83%</span></td>
<td id="S5.T3.st1.2.3.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T3.st1.2.3.1.3.1" class="ltx_text" style="font-size:90%;">67.47%</span></td>
<td id="S5.T3.st1.2.3.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T3.st1.2.3.1.4.1" class="ltx_text" style="font-size:90%;">48.08%</span></td>
<td id="S5.T3.st1.2.3.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T3.st1.2.3.1.5.1" class="ltx_text" style="font-size:90%;">63.25%</span></td>
</tr>
<tr id="S5.T3.st1.2.4.2" class="ltx_tr">
<th id="S5.T3.st1.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S5.T3.st1.2.4.2.1.1" class="ltx_text" style="font-size:90%;">FedFSL-naive </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T3.st1.2.4.2.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Chen
et al<span class="ltx_text">.</span><span id="S5.T3.st1.2.4.2.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib4" title="" class="ltx_ref">2018</a><span id="S5.T3.st1.2.4.2.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S5.T3.st1.2.4.2.2" class="ltx_td ltx_align_center"><span id="S5.T3.st1.2.4.2.2.1" class="ltx_text" style="font-size:90%;">53.00%</span></td>
<td id="S5.T3.st1.2.4.2.3" class="ltx_td ltx_align_center"><span id="S5.T3.st1.2.4.2.3.1" class="ltx_text" style="font-size:90%;">67.63%</span></td>
<td id="S5.T3.st1.2.4.2.4" class="ltx_td ltx_align_center"><span id="S5.T3.st1.2.4.2.4.1" class="ltx_text" style="font-size:90%;">49.95%</span></td>
<td id="S5.T3.st1.2.4.2.5" class="ltx_td ltx_align_center"><span id="S5.T3.st1.2.4.2.5.1" class="ltx_text" style="font-size:90%;">66.11%</span></td>
</tr>
<tr id="S5.T3.st1.2.5.3" class="ltx_tr">
<th id="S5.T3.st1.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S5.T3.st1.2.5.3.1.1" class="ltx_text" style="font-size:90%;">FedFSL-prox </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T3.st1.2.5.3.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Li et al<span class="ltx_text">.</span><span id="S5.T3.st1.2.5.3.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib21" title="" class="ltx_ref">2018</a><span id="S5.T3.st1.2.5.3.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S5.T3.st1.2.5.3.2" class="ltx_td ltx_align_center"><span id="S5.T3.st1.2.5.3.2.1" class="ltx_text" style="font-size:90%;">53.03%</span></td>
<td id="S5.T3.st1.2.5.3.3" class="ltx_td ltx_align_center"><span id="S5.T3.st1.2.5.3.3.1" class="ltx_text" style="font-size:90%;">69.05%</span></td>
<td id="S5.T3.st1.2.5.3.4" class="ltx_td ltx_align_center"><span id="S5.T3.st1.2.5.3.4.1" class="ltx_text" style="font-size:90%;">50.08%</span></td>
<td id="S5.T3.st1.2.5.3.5" class="ltx_td ltx_align_center"><span id="S5.T3.st1.2.5.3.5.1" class="ltx_text" style="font-size:90%;">68.53%</span></td>
</tr>
<tr id="S5.T3.st1.2.6.4" class="ltx_tr">
<th id="S5.T3.st1.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T3.st1.2.6.4.1.1" class="ltx_text" style="font-size:90%;">FedFSL-MI (ours)</span></th>
<td id="S5.T3.st1.2.6.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.st1.2.6.4.2.1" class="ltx_text" style="font-size:90%;">54.98%</span></td>
<td id="S5.T3.st1.2.6.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.st1.2.6.4.3.1" class="ltx_text" style="font-size:90%;">69.07%</span></td>
<td id="S5.T3.st1.2.6.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.st1.2.6.4.4.1" class="ltx_text" style="font-size:90%;">51.07%</span></td>
<td id="S5.T3.st1.2.6.4.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.st1.2.6.4.5.1" class="ltx_text" style="font-size:90%;">68.57%</span></td>
</tr>
<tr id="S5.T3.st1.2.7.5" class="ltx_tr">
<th id="S5.T3.st1.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_b"><span id="S5.T3.st1.2.7.5.1.1" class="ltx_text" style="font-size:90%;">FedFSL-MI-Adv (ours)</span></th>
<td id="S5.T3.st1.2.7.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S5.T3.st1.2.7.5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">56.42%</span></td>
<td id="S5.T3.st1.2.7.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S5.T3.st1.2.7.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">70.92%</span></td>
<td id="S5.T3.st1.2.7.5.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S5.T3.st1.2.7.5.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">53.69%</span></td>
<td id="S5.T3.st1.2.7.5.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S5.T3.st1.2.7.5.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">69.61%</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">(a) </span>MiniImageNet results.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.T3.st2" class="ltx_table ltx_figure_panel">
<table id="S5.T3.st2.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.st2.2.1.1" class="ltx_tr">
<th id="S5.T3.st2.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S5.T3.st2.2.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Method</span></th>
<th id="S5.T3.st2.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S5.T3.st2.2.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">IID</span></th>
<th id="S5.T3.st2.2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S5.T3.st2.2.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Non-IID</span></th>
</tr>
<tr id="S5.T3.st2.2.2.2" class="ltx_tr">
<th id="S5.T3.st2.2.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.st2.2.2.2.1.1" class="ltx_text" style="font-size:90%;">1-shot</span></th>
<th id="S5.T3.st2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.st2.2.2.2.2.1" class="ltx_text" style="font-size:90%;">5-shot</span></th>
<th id="S5.T3.st2.2.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.st2.2.2.2.3.1" class="ltx_text" style="font-size:90%;">1-shot</span></th>
<th id="S5.T3.st2.2.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.st2.2.2.2.4.1" class="ltx_text" style="font-size:90%;">5-shot</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.st2.2.3.1" class="ltx_tr">
<th id="S5.T3.st2.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S5.T3.st2.2.3.1.1.1" class="ltx_text" style="font-size:90%;">FSL-local</span></th>
<td id="S5.T3.st2.2.3.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T3.st2.2.3.1.2.1" class="ltx_text" style="font-size:90%;">36.45%</span></td>
<td id="S5.T3.st2.2.3.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T3.st2.2.3.1.3.1" class="ltx_text" style="font-size:90%;">47.68%</span></td>
<td id="S5.T3.st2.2.3.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T3.st2.2.3.1.4.1" class="ltx_text" style="font-size:90%;">35.90%</span></td>
<td id="S5.T3.st2.2.3.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T3.st2.2.3.1.5.1" class="ltx_text" style="font-size:90%;">52.93%</span></td>
</tr>
<tr id="S5.T3.st2.2.4.2" class="ltx_tr">
<th id="S5.T3.st2.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S5.T3.st2.2.4.2.1.1" class="ltx_text" style="font-size:90%;">FedFSL-naive </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T3.st2.2.4.2.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Chen
et al<span class="ltx_text">.</span><span id="S5.T3.st2.2.4.2.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib4" title="" class="ltx_ref">2018</a><span id="S5.T3.st2.2.4.2.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S5.T3.st2.2.4.2.2" class="ltx_td ltx_align_center"><span id="S5.T3.st2.2.4.2.2.1" class="ltx_text" style="font-size:90%;">38.42%</span></td>
<td id="S5.T3.st2.2.4.2.3" class="ltx_td ltx_align_center"><span id="S5.T3.st2.2.4.2.3.1" class="ltx_text" style="font-size:90%;">49.97%</span></td>
<td id="S5.T3.st2.2.4.2.4" class="ltx_td ltx_align_center"><span id="S5.T3.st2.2.4.2.4.1" class="ltx_text" style="font-size:90%;">36.11%</span></td>
<td id="S5.T3.st2.2.4.2.5" class="ltx_td ltx_align_center"><span id="S5.T3.st2.2.4.2.5.1" class="ltx_text" style="font-size:90%;">51.58%</span></td>
</tr>
<tr id="S5.T3.st2.2.5.3" class="ltx_tr">
<th id="S5.T3.st2.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S5.T3.st2.2.5.3.1.1" class="ltx_text" style="font-size:90%;">FedFSL-prox </span><cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T3.st2.2.5.3.1.2.1" class="ltx_text" style="font-size:90%;">(</span>Li et al<span class="ltx_text">.</span><span id="S5.T3.st2.2.5.3.1.3.2.1.1" class="ltx_text" style="font-size:90%;">, </span><a href="#bib.bib21" title="" class="ltx_ref">2018</a><span id="S5.T3.st2.2.5.3.1.4.3" class="ltx_text" style="font-size:90%;">)</span></cite>
</th>
<td id="S5.T3.st2.2.5.3.2" class="ltx_td ltx_align_center"><span id="S5.T3.st2.2.5.3.2.1" class="ltx_text" style="font-size:90%;">37.62%</span></td>
<td id="S5.T3.st2.2.5.3.3" class="ltx_td ltx_align_center"><span id="S5.T3.st2.2.5.3.3.1" class="ltx_text" style="font-size:90%;">48.99%</span></td>
<td id="S5.T3.st2.2.5.3.4" class="ltx_td ltx_align_center"><span id="S5.T3.st2.2.5.3.4.1" class="ltx_text" style="font-size:90%;">36.95%</span></td>
<td id="S5.T3.st2.2.5.3.5" class="ltx_td ltx_align_center"><span id="S5.T3.st2.2.5.3.5.1" class="ltx_text" style="font-size:90%;">53.02%</span></td>
</tr>
<tr id="S5.T3.st2.2.6.4" class="ltx_tr">
<th id="S5.T3.st2.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T3.st2.2.6.4.1.1" class="ltx_text" style="font-size:90%;">FedFSL-MI (ours)</span></th>
<td id="S5.T3.st2.2.6.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.st2.2.6.4.2.1" class="ltx_text" style="font-size:90%;">39.78%</span></td>
<td id="S5.T3.st2.2.6.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.st2.2.6.4.3.1" class="ltx_text" style="font-size:90%;">50.65%</span></td>
<td id="S5.T3.st2.2.6.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.st2.2.6.4.4.1" class="ltx_text" style="font-size:90%;">38.08%</span></td>
<td id="S5.T3.st2.2.6.4.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.st2.2.6.4.5.1" class="ltx_text" style="font-size:90%;">52.98%</span></td>
</tr>
<tr id="S5.T3.st2.2.7.5" class="ltx_tr">
<th id="S5.T3.st2.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_b"><span id="S5.T3.st2.2.7.5.1.1" class="ltx_text" style="font-size:90%;">FedFSL-MI-Adv (ours)</span></th>
<td id="S5.T3.st2.2.7.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S5.T3.st2.2.7.5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">40.22%</span></td>
<td id="S5.T3.st2.2.7.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S5.T3.st2.2.7.5.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">51.18%</span></td>
<td id="S5.T3.st2.2.7.5.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S5.T3.st2.2.7.5.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">38.51%</span></td>
<td id="S5.T3.st2.2.7.5.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b"><span id="S5.T3.st2.2.7.5.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">54.43%</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">(b) </span>FC100 results.</figcaption>
</figure>
</div>
</div>
</figure>
<section id="S5.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.1. </span>Results on Image Classification</h4>

<div id="S5.SS4.SSS1.p1" class="ltx_para">
<p id="S5.SS4.SSS1.p1.1" class="ltx_p">In Table <a href="#S5.T3.st2" title="In Table 3 ‣ 5.4. Results on benchmark datasets ‣ 5. Experiments and Discussions ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(b)</span></a>, we compare our methods on miniImageNet (a) and FC100 (b) with 1-shot / 5-shot tasks learned by a federation of 10 clients.
We observe that</p>
<ul id="S5.I3" class="ltx_itemize">
<li id="S5.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i1.p1" class="ltx_para">
<p id="S5.I3.i1.p1.1" class="ltx_p"><em id="S5.I3.i1.p1.1.1" class="ltx_emph ltx_font_italic">FedFSL-MI-Adv outperforms others</em>. For both IID and non-IID case, FedFSL-MI-Adv consistently outperforms others on both 1-shot and 5-shot tasks for both datasets.</p>
</div>
</li>
<li id="S5.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i2.p1" class="ltx_para">
<p id="S5.I3.i2.p1.1" class="ltx_p">For 1-shot and 5-shot IID task on miniImageNet, FedFSL-MI-Adv achieves the best accuracy of 56.42% and 70.92%, which outperforms the second best FedFSL-MI by more than 2.6% and 2.7% respectively and relatively. A similar trend has also been observed for FC100.</p>
</div>
</li>
<li id="S5.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i3.p1" class="ltx_para">
<p id="S5.I3.i3.p1.1" class="ltx_p">For non-IID task, FedFSL-MI-Adv outperforms the second best FedFSL-MI by more than 5% and 3.1% in 1-shot case on miniImageNet and FC100 datasets respectively, and outperforms FedFSL-naive by more than 7.2% and 5.5% respectively. This indicates that our designed modules indeed help achieve a better federated model especially for non-IID case.</p>
</div>
</li>
<li id="S5.I3.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i4.p1" class="ltx_para">
<p id="S5.I3.i4.p1.1" class="ltx_p">For FC100 5-shot task, FedFSL-MI-Adv performs better on non-IID partitions than IID partitions, with an accuracy 54.43% (non-IID) v.s. 51.18% (IID) shown by last line in Table <a href="#S5.T3.st2" title="In Table 3 ‣ 5.4. Results on benchmark datasets ‣ 5. Experiments and Discussions ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(b)</span></a>(b). One explanation is that non-IID partitions force each client model to learn on distinct local tasks where certain data classes get sampled more times and thus get represented well. As FedFSL-MI-Adv further aligns the feature spaces of all clients, we could derive a more representative joint feature space with the global model.</p>
</div>
</li>
<li id="S5.I3.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i5.p1" class="ltx_para">
<p id="S5.I3.i5.p1.1" class="ltx_p">Using FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2018</a>)</cite> performs no better than our FedFSL-MI. This is because FedProx directly constrains client model weights to be closer to global model, while our FedFSL-MI softly optimizes the model outputs of them to be closer, which makes the training end-to-end and easier to optimize.</p>
</div>
</li>
</ul>
</div>
<figure id="S5.F8" class="ltx_figure ltx_align_center"><img src="/html/2104.00365/assets/x8.png" id="S5.F8.1.g1" class="ltx_graphics ltx_img_landscape" width="664" height="335" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F8.3.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>. </span><span id="S5.F8.4.2" class="ltx_text" style="font-size:90%;">FSL accuracy of 1-shot task on MiniImageNet w.r.t. number of devices in federation.</span></figcaption>
</figure>
</section>
<section id="S5.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.2. </span>Results on Text Classification</h4>

<div id="S5.SS4.SSS2.p1" class="ltx_para">
<p id="S5.SS4.SSS2.p1.1" class="ltx_p">In Table <a href="#S5.SS4" title="5.4. Results on benchmark datasets ‣ 5. Experiments and Discussions ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a>, we compare our methods on Sent140 dataset with 1-shot / 5-shot tasks learned by a federation of 5 clients.
Following the provided tool of partitioning the dataset, we distribute different users’ data to each client without replacement. Since the data distributions vary for users, this sampling process provides non-IID data partitions. Our goal is to train an effective global sentiment classification model on one portion of users, which can be used to detect the sentiment on disjoint new users. This is particularly challenging because different users can use very distinct words and exclamations to express feelings, and many of them are rare.</p>
</div>
<div id="S5.SS4.SSS2.p2" class="ltx_para">
<p id="S5.SS4.SSS2.p2.1" class="ltx_p">In this task, our backbone model is a GRU (RNN) network with hidden size 128. We convert tweet sentences to sequences of 300-D GloVe <cite class="ltx_cite ltx_citemacro_citep">(Pennington
et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2014</a>)</cite> word vectors as input to the GRU model. We add a binary classifier upon GRU hidden output to classify negative and positive sentiment.
We examine the performance of baselines and our models and observe that</p>
<ul id="S5.I4" class="ltx_itemize">
<li id="S5.I4.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I4.i1.p1" class="ltx_para">
<p id="S5.I4.i1.p1.1" class="ltx_p">FedFSL-MI-Adv outperforms the other approaches in this natural language understanding task, similar as in image classification task. It also shows that our FedFSL framework can be applicable to both CNN and RNN models.</p>
</div>
</li>
<li id="S5.I4.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I4.i2.p1" class="ltx_para">
<p id="S5.I4.i2.p1.1" class="ltx_p">We found that the performance increases from 1-shot to 5-shot tasks are generally less than image classification tasks, e.g., less than 5% on Sent140 while more than 10% on miniImageNet. This is because the few-shot labelled sentences can only provide a few more words to help adapt to a user’s emotion, while images can provide much richer details and patterns of a given object.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S5.SS4.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.3. </span>Different device number</h4>

<div id="S5.SS4.SSS3.p1" class="ltx_para">
<p id="S5.SS4.SSS3.p1.2" class="ltx_p">We study the trend of accuracy of FedFSL with different number of participating devices <math id="S5.SS4.SSS3.p1.1.m1.5" class="ltx_Math" alttext="K=2,5,10,20,30" display="inline"><semantics id="S5.SS4.SSS3.p1.1.m1.5a"><mrow id="S5.SS4.SSS3.p1.1.m1.5.6" xref="S5.SS4.SSS3.p1.1.m1.5.6.cmml"><mi id="S5.SS4.SSS3.p1.1.m1.5.6.2" xref="S5.SS4.SSS3.p1.1.m1.5.6.2.cmml">K</mi><mo id="S5.SS4.SSS3.p1.1.m1.5.6.1" xref="S5.SS4.SSS3.p1.1.m1.5.6.1.cmml">=</mo><mrow id="S5.SS4.SSS3.p1.1.m1.5.6.3.2" xref="S5.SS4.SSS3.p1.1.m1.5.6.3.1.cmml"><mn id="S5.SS4.SSS3.p1.1.m1.1.1" xref="S5.SS4.SSS3.p1.1.m1.1.1.cmml">2</mn><mo id="S5.SS4.SSS3.p1.1.m1.5.6.3.2.1" xref="S5.SS4.SSS3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS4.SSS3.p1.1.m1.2.2" xref="S5.SS4.SSS3.p1.1.m1.2.2.cmml">5</mn><mo id="S5.SS4.SSS3.p1.1.m1.5.6.3.2.2" xref="S5.SS4.SSS3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS4.SSS3.p1.1.m1.3.3" xref="S5.SS4.SSS3.p1.1.m1.3.3.cmml">10</mn><mo id="S5.SS4.SSS3.p1.1.m1.5.6.3.2.3" xref="S5.SS4.SSS3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS4.SSS3.p1.1.m1.4.4" xref="S5.SS4.SSS3.p1.1.m1.4.4.cmml">20</mn><mo id="S5.SS4.SSS3.p1.1.m1.5.6.3.2.4" xref="S5.SS4.SSS3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS4.SSS3.p1.1.m1.5.5" xref="S5.SS4.SSS3.p1.1.m1.5.5.cmml">30</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS3.p1.1.m1.5b"><apply id="S5.SS4.SSS3.p1.1.m1.5.6.cmml" xref="S5.SS4.SSS3.p1.1.m1.5.6"><eq id="S5.SS4.SSS3.p1.1.m1.5.6.1.cmml" xref="S5.SS4.SSS3.p1.1.m1.5.6.1"></eq><ci id="S5.SS4.SSS3.p1.1.m1.5.6.2.cmml" xref="S5.SS4.SSS3.p1.1.m1.5.6.2">𝐾</ci><list id="S5.SS4.SSS3.p1.1.m1.5.6.3.1.cmml" xref="S5.SS4.SSS3.p1.1.m1.5.6.3.2"><cn type="integer" id="S5.SS4.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS4.SSS3.p1.1.m1.1.1">2</cn><cn type="integer" id="S5.SS4.SSS3.p1.1.m1.2.2.cmml" xref="S5.SS4.SSS3.p1.1.m1.2.2">5</cn><cn type="integer" id="S5.SS4.SSS3.p1.1.m1.3.3.cmml" xref="S5.SS4.SSS3.p1.1.m1.3.3">10</cn><cn type="integer" id="S5.SS4.SSS3.p1.1.m1.4.4.cmml" xref="S5.SS4.SSS3.p1.1.m1.4.4">20</cn><cn type="integer" id="S5.SS4.SSS3.p1.1.m1.5.5.cmml" xref="S5.SS4.SSS3.p1.1.m1.5.5">30</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS3.p1.1.m1.5c">K=2,5,10,20,30</annotation></semantics></math>, as well as <math id="S5.SS4.SSS3.p1.2.m2.1" class="ltx_Math" alttext="K=1" display="inline"><semantics id="S5.SS4.SSS3.p1.2.m2.1a"><mrow id="S5.SS4.SSS3.p1.2.m2.1.1" xref="S5.SS4.SSS3.p1.2.m2.1.1.cmml"><mi id="S5.SS4.SSS3.p1.2.m2.1.1.2" xref="S5.SS4.SSS3.p1.2.m2.1.1.2.cmml">K</mi><mo id="S5.SS4.SSS3.p1.2.m2.1.1.1" xref="S5.SS4.SSS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS4.SSS3.p1.2.m2.1.1.3" xref="S5.SS4.SSS3.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS3.p1.2.m2.1b"><apply id="S5.SS4.SSS3.p1.2.m2.1.1.cmml" xref="S5.SS4.SSS3.p1.2.m2.1.1"><eq id="S5.SS4.SSS3.p1.2.m2.1.1.1.cmml" xref="S5.SS4.SSS3.p1.2.m2.1.1.1"></eq><ci id="S5.SS4.SSS3.p1.2.m2.1.1.2.cmml" xref="S5.SS4.SSS3.p1.2.m2.1.1.2">𝐾</ci><cn type="integer" id="S5.SS4.SSS3.p1.2.m2.1.1.3.cmml" xref="S5.SS4.SSS3.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS3.p1.2.m2.1c">K=1</annotation></semantics></math> to simulate complete centralized training.
We illustrate the results for non-IID 5-way 1-shot task with miniImageNet in Fig. <a href="#S5.F8" title="Figure 8 ‣ 5.4.1. Results on Image Classification ‣ 5.4. Results on benchmark datasets ‣ 5. Experiments and Discussions ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> with detailed numbers.
Note that the more participating devices, the fewer training samples each device holds.
We observe that
</p>
<ul id="S5.I5" class="ltx_itemize">
<li id="S5.I5.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I5.i1.p1" class="ltx_para">
<p id="S5.I5.i1.p1.1" class="ltx_p">The overall trend is that more participating devices yielded decreased accuracy for all 3 approaches. The task becomes more difficult when <math id="S5.I5.i1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.I5.i1.p1.1.m1.1a"><mi id="S5.I5.i1.p1.1.m1.1.1" xref="S5.I5.i1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.I5.i1.p1.1.m1.1b"><ci id="S5.I5.i1.p1.1.m1.1.1.cmml" xref="S5.I5.i1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I5.i1.p1.1.m1.1c">K</annotation></semantics></math> increases as the device coordination grows harder and the client model becomes less capable with less training data.</p>
</div>
</li>
<li id="S5.I5.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I5.i2.p1" class="ltx_para">
<p id="S5.I5.i2.p1.1" class="ltx_p"><em id="S5.I5.i2.p1.1.1" class="ltx_emph ltx_font_italic">FedFSL-MI-Adv still achieves the best results</em> on all cases, leading the second best FedFSL-MI by more 2-5% relatively.</p>
</div>
</li>
<li id="S5.I5.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I5.i3.p1" class="ltx_para">
<p id="S5.I5.i3.p1.1" class="ltx_p">The performance of <em id="S5.I5.i3.p1.1.1" class="ltx_emph ltx_font_italic">FedFSL-MI-Adv decreases more slowly than other approaches</em> with the increase of <math id="S5.I5.i3.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.I5.i3.p1.1.m1.1a"><mi id="S5.I5.i3.p1.1.m1.1.1" xref="S5.I5.i3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.I5.i3.p1.1.m1.1b"><ci id="S5.I5.i3.p1.1.m1.1.1.cmml" xref="S5.I5.i3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I5.i3.p1.1.m1.1c">K</annotation></semantics></math>, which indicates the beneficial of learning a consistent feature space over the clients.</p>
</div>
</li>
<li id="S5.I5.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I5.i4.p1" class="ltx_para">
<p id="S5.I5.i4.p1.1" class="ltx_p"><em id="S5.I5.i4.p1.1.1" class="ltx_emph ltx_font_italic">FedFSL-MI-Adv in 2-device federation works even better than 1-device centralized training</em>, with accuracy 54.96% v.s. 54.41%. Note that the total training samples of each device get halved on each device when <math id="S5.I5.i4.p1.1.m1.1" class="ltx_Math" alttext="K=2" display="inline"><semantics id="S5.I5.i4.p1.1.m1.1a"><mrow id="S5.I5.i4.p1.1.m1.1.1" xref="S5.I5.i4.p1.1.m1.1.1.cmml"><mi id="S5.I5.i4.p1.1.m1.1.1.2" xref="S5.I5.i4.p1.1.m1.1.1.2.cmml">K</mi><mo id="S5.I5.i4.p1.1.m1.1.1.1" xref="S5.I5.i4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.I5.i4.p1.1.m1.1.1.3" xref="S5.I5.i4.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.I5.i4.p1.1.m1.1b"><apply id="S5.I5.i4.p1.1.m1.1.1.cmml" xref="S5.I5.i4.p1.1.m1.1.1"><eq id="S5.I5.i4.p1.1.m1.1.1.1.cmml" xref="S5.I5.i4.p1.1.m1.1.1.1"></eq><ci id="S5.I5.i4.p1.1.m1.1.1.2.cmml" xref="S5.I5.i4.p1.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S5.I5.i4.p1.1.m1.1.1.3.cmml" xref="S5.I5.i4.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I5.i4.p1.1.m1.1c">K=2</annotation></semantics></math>. The surprising result that distributed training outperforms centralized training can be explained that FSL is aiming to learn with very few training samples, instead of fitting a task with many samples as in supervised learning. Therefore, FSL is relative less sensitive to the number of examples in <em id="S5.I5.i4.p1.1.2" class="ltx_emph ltx_font_italic">base</em> classes on each client. Moreover, by utilizing our approach to align decision boundaries well, the two client models form an effective ensemble to enhance the overall performance, compared with a single-model case.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S5.SS4.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.4. </span>Mutual information with <math id="S5.SS4.SSS4.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS4.SSS4.1.m1.1b"><mi id="S5.SS4.SSS4.1.m1.1.1" xref="S5.SS4.SSS4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS4.1.m1.1c"><ci id="S5.SS4.SSS4.1.m1.1.1.cmml" xref="S5.SS4.SSS4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS4.1.m1.1d">k</annotation></semantics></math>-exclusive global model</h4>

<div id="S5.SS4.SSS4.p1" class="ltx_para">
<p id="S5.SS4.SSS4.p1.6" class="ltx_p">In Section <a href="#S4.SS1" title="4.1. FedFSL with Mutual Information (MI) ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>, we discussed that we can estimate the mutual information produced by <math id="S5.SS4.SSS4.p1.1.m1.1" class="ltx_Math" alttext="w_{-k}^{t}" display="inline"><semantics id="S5.SS4.SSS4.p1.1.m1.1a"><msubsup id="S5.SS4.SSS4.p1.1.m1.1.1" xref="S5.SS4.SSS4.p1.1.m1.1.1.cmml"><mi id="S5.SS4.SSS4.p1.1.m1.1.1.2.2" xref="S5.SS4.SSS4.p1.1.m1.1.1.2.2.cmml">w</mi><mrow id="S5.SS4.SSS4.p1.1.m1.1.1.2.3" xref="S5.SS4.SSS4.p1.1.m1.1.1.2.3.cmml"><mo id="S5.SS4.SSS4.p1.1.m1.1.1.2.3a" xref="S5.SS4.SSS4.p1.1.m1.1.1.2.3.cmml">−</mo><mi id="S5.SS4.SSS4.p1.1.m1.1.1.2.3.2" xref="S5.SS4.SSS4.p1.1.m1.1.1.2.3.2.cmml">k</mi></mrow><mi id="S5.SS4.SSS4.p1.1.m1.1.1.3" xref="S5.SS4.SSS4.p1.1.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS4.p1.1.m1.1b"><apply id="S5.SS4.SSS4.p1.1.m1.1.1.cmml" xref="S5.SS4.SSS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.SSS4.p1.1.m1.1.1">superscript</csymbol><apply id="S5.SS4.SSS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.SSS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS4.p1.1.m1.1.1.2.1.cmml" xref="S5.SS4.SSS4.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS4.SSS4.p1.1.m1.1.1.2.2.cmml" xref="S5.SS4.SSS4.p1.1.m1.1.1.2.2">𝑤</ci><apply id="S5.SS4.SSS4.p1.1.m1.1.1.2.3.cmml" xref="S5.SS4.SSS4.p1.1.m1.1.1.2.3"><minus id="S5.SS4.SSS4.p1.1.m1.1.1.2.3.1.cmml" xref="S5.SS4.SSS4.p1.1.m1.1.1.2.3"></minus><ci id="S5.SS4.SSS4.p1.1.m1.1.1.2.3.2.cmml" xref="S5.SS4.SSS4.p1.1.m1.1.1.2.3.2">𝑘</ci></apply></apply><ci id="S5.SS4.SSS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.SSS4.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS4.p1.1.m1.1c">w_{-k}^{t}</annotation></semantics></math> with the global model <math id="S5.SS4.SSS4.p1.2.m2.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="S5.SS4.SSS4.p1.2.m2.1a"><msup id="S5.SS4.SSS4.p1.2.m2.1.1" xref="S5.SS4.SSS4.p1.2.m2.1.1.cmml"><mi id="S5.SS4.SSS4.p1.2.m2.1.1.2" xref="S5.SS4.SSS4.p1.2.m2.1.1.2.cmml">w</mi><mi id="S5.SS4.SSS4.p1.2.m2.1.1.3" xref="S5.SS4.SSS4.p1.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS4.p1.2.m2.1b"><apply id="S5.SS4.SSS4.p1.2.m2.1.1.cmml" xref="S5.SS4.SSS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS4.p1.2.m2.1.1.1.cmml" xref="S5.SS4.SSS4.p1.2.m2.1.1">superscript</csymbol><ci id="S5.SS4.SSS4.p1.2.m2.1.1.2.cmml" xref="S5.SS4.SSS4.p1.2.m2.1.1.2">𝑤</ci><ci id="S5.SS4.SSS4.p1.2.m2.1.1.3.cmml" xref="S5.SS4.SSS4.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS4.p1.2.m2.1c">w^{t}</annotation></semantics></math> when the number of devices are large. We conducted experiments to compare using the original <math id="S5.SS4.SSS4.p1.3.m3.1" class="ltx_Math" alttext="w_{-k}^{t}" display="inline"><semantics id="S5.SS4.SSS4.p1.3.m3.1a"><msubsup id="S5.SS4.SSS4.p1.3.m3.1.1" xref="S5.SS4.SSS4.p1.3.m3.1.1.cmml"><mi id="S5.SS4.SSS4.p1.3.m3.1.1.2.2" xref="S5.SS4.SSS4.p1.3.m3.1.1.2.2.cmml">w</mi><mrow id="S5.SS4.SSS4.p1.3.m3.1.1.2.3" xref="S5.SS4.SSS4.p1.3.m3.1.1.2.3.cmml"><mo id="S5.SS4.SSS4.p1.3.m3.1.1.2.3a" xref="S5.SS4.SSS4.p1.3.m3.1.1.2.3.cmml">−</mo><mi id="S5.SS4.SSS4.p1.3.m3.1.1.2.3.2" xref="S5.SS4.SSS4.p1.3.m3.1.1.2.3.2.cmml">k</mi></mrow><mi id="S5.SS4.SSS4.p1.3.m3.1.1.3" xref="S5.SS4.SSS4.p1.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS4.p1.3.m3.1b"><apply id="S5.SS4.SSS4.p1.3.m3.1.1.cmml" xref="S5.SS4.SSS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS4.p1.3.m3.1.1.1.cmml" xref="S5.SS4.SSS4.p1.3.m3.1.1">superscript</csymbol><apply id="S5.SS4.SSS4.p1.3.m3.1.1.2.cmml" xref="S5.SS4.SSS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS4.p1.3.m3.1.1.2.1.cmml" xref="S5.SS4.SSS4.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS4.SSS4.p1.3.m3.1.1.2.2.cmml" xref="S5.SS4.SSS4.p1.3.m3.1.1.2.2">𝑤</ci><apply id="S5.SS4.SSS4.p1.3.m3.1.1.2.3.cmml" xref="S5.SS4.SSS4.p1.3.m3.1.1.2.3"><minus id="S5.SS4.SSS4.p1.3.m3.1.1.2.3.1.cmml" xref="S5.SS4.SSS4.p1.3.m3.1.1.2.3"></minus><ci id="S5.SS4.SSS4.p1.3.m3.1.1.2.3.2.cmml" xref="S5.SS4.SSS4.p1.3.m3.1.1.2.3.2">𝑘</ci></apply></apply><ci id="S5.SS4.SSS4.p1.3.m3.1.1.3.cmml" xref="S5.SS4.SSS4.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS4.p1.3.m3.1c">w_{-k}^{t}</annotation></semantics></math> with <math id="S5.SS4.SSS4.p1.4.m4.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="S5.SS4.SSS4.p1.4.m4.1a"><msup id="S5.SS4.SSS4.p1.4.m4.1.1" xref="S5.SS4.SSS4.p1.4.m4.1.1.cmml"><mi id="S5.SS4.SSS4.p1.4.m4.1.1.2" xref="S5.SS4.SSS4.p1.4.m4.1.1.2.cmml">w</mi><mi id="S5.SS4.SSS4.p1.4.m4.1.1.3" xref="S5.SS4.SSS4.p1.4.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS4.p1.4.m4.1b"><apply id="S5.SS4.SSS4.p1.4.m4.1.1.cmml" xref="S5.SS4.SSS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS4.p1.4.m4.1.1.1.cmml" xref="S5.SS4.SSS4.p1.4.m4.1.1">superscript</csymbol><ci id="S5.SS4.SSS4.p1.4.m4.1.1.2.cmml" xref="S5.SS4.SSS4.p1.4.m4.1.1.2">𝑤</ci><ci id="S5.SS4.SSS4.p1.4.m4.1.1.3.cmml" xref="S5.SS4.SSS4.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS4.p1.4.m4.1c">w^{t}</annotation></semantics></math> in (<a href="#S4.E13" title="In 4.1.2. FedFSL-MI ‣ 4.1. FedFSL with Mutual Information (MI) ‣ 4. Improving FedFSL with better coordination ‣ Federated Few-Shot Learning with Adversarial Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>).
Surprisingly, we found that using <math id="S5.SS4.SSS4.p1.5.m5.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="S5.SS4.SSS4.p1.5.m5.1a"><msup id="S5.SS4.SSS4.p1.5.m5.1.1" xref="S5.SS4.SSS4.p1.5.m5.1.1.cmml"><mi id="S5.SS4.SSS4.p1.5.m5.1.1.2" xref="S5.SS4.SSS4.p1.5.m5.1.1.2.cmml">w</mi><mi id="S5.SS4.SSS4.p1.5.m5.1.1.3" xref="S5.SS4.SSS4.p1.5.m5.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS4.p1.5.m5.1b"><apply id="S5.SS4.SSS4.p1.5.m5.1.1.cmml" xref="S5.SS4.SSS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS4.p1.5.m5.1.1.1.cmml" xref="S5.SS4.SSS4.p1.5.m5.1.1">superscript</csymbol><ci id="S5.SS4.SSS4.p1.5.m5.1.1.2.cmml" xref="S5.SS4.SSS4.p1.5.m5.1.1.2">𝑤</ci><ci id="S5.SS4.SSS4.p1.5.m5.1.1.3.cmml" xref="S5.SS4.SSS4.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS4.p1.5.m5.1c">w^{t}</annotation></semantics></math> either outperforms or ties with using <math id="S5.SS4.SSS4.p1.6.m6.1" class="ltx_Math" alttext="w_{-k}^{t}" display="inline"><semantics id="S5.SS4.SSS4.p1.6.m6.1a"><msubsup id="S5.SS4.SSS4.p1.6.m6.1.1" xref="S5.SS4.SSS4.p1.6.m6.1.1.cmml"><mi id="S5.SS4.SSS4.p1.6.m6.1.1.2.2" xref="S5.SS4.SSS4.p1.6.m6.1.1.2.2.cmml">w</mi><mrow id="S5.SS4.SSS4.p1.6.m6.1.1.2.3" xref="S5.SS4.SSS4.p1.6.m6.1.1.2.3.cmml"><mo id="S5.SS4.SSS4.p1.6.m6.1.1.2.3a" xref="S5.SS4.SSS4.p1.6.m6.1.1.2.3.cmml">−</mo><mi id="S5.SS4.SSS4.p1.6.m6.1.1.2.3.2" xref="S5.SS4.SSS4.p1.6.m6.1.1.2.3.2.cmml">k</mi></mrow><mi id="S5.SS4.SSS4.p1.6.m6.1.1.3" xref="S5.SS4.SSS4.p1.6.m6.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS4.p1.6.m6.1b"><apply id="S5.SS4.SSS4.p1.6.m6.1.1.cmml" xref="S5.SS4.SSS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS4.p1.6.m6.1.1.1.cmml" xref="S5.SS4.SSS4.p1.6.m6.1.1">superscript</csymbol><apply id="S5.SS4.SSS4.p1.6.m6.1.1.2.cmml" xref="S5.SS4.SSS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS4.p1.6.m6.1.1.2.1.cmml" xref="S5.SS4.SSS4.p1.6.m6.1.1">subscript</csymbol><ci id="S5.SS4.SSS4.p1.6.m6.1.1.2.2.cmml" xref="S5.SS4.SSS4.p1.6.m6.1.1.2.2">𝑤</ci><apply id="S5.SS4.SSS4.p1.6.m6.1.1.2.3.cmml" xref="S5.SS4.SSS4.p1.6.m6.1.1.2.3"><minus id="S5.SS4.SSS4.p1.6.m6.1.1.2.3.1.cmml" xref="S5.SS4.SSS4.p1.6.m6.1.1.2.3"></minus><ci id="S5.SS4.SSS4.p1.6.m6.1.1.2.3.2.cmml" xref="S5.SS4.SSS4.p1.6.m6.1.1.2.3.2">𝑘</ci></apply></apply><ci id="S5.SS4.SSS4.p1.6.m6.1.1.3.cmml" xref="S5.SS4.SSS4.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS4.p1.6.m6.1c">w_{-k}^{t}</annotation></semantics></math> as original definition in both 1-/5-shot tasks in all datasets, with the only exception of miniImageNet 5-shot task (69.61% v.s. 70.70%).
We found that this phenomenon could be explained by“self-knowledge distillation” such that a trained model can be used to improve itself <cite class="ltx_cite ltx_citemacro_citep">(Yun
et al<span class="ltx_text">.</span>, <a href="#bib.bib41" title="" class="ltx_ref">2020</a>; Zhang and Sabuncu, <a href="#bib.bib46" title="" class="ltx_ref">2020</a>)</cite> as it provides a kind of label smoothing which can make training processes robust to noises.</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we proposed a framework that makes federated learning effective in data-scarce scenarios.
We designed an adversarial learning strategy to
construct a consistent feature space over the clients, to better learn from scarce data.
Experimental results show that our adversarial learning based method outperforms baseline methods by 5%<math id="S6.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S6.p1.1.m1.1a"><mo id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><csymbol cd="latexml" id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">\sim</annotation></semantics></math>15% on benchmark datasets.
Future work can investigate the
theoretical convergence analysis of FedFSL with non-convex models and how to further extend FedFSL to regression and reinforcement learning tasks.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Belghazi et al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Mohamed Ishmael Belghazi,
Aristide Baratin, Sai Rajeshwar,
Sherjil Ozair, Yoshua Bengio,
Aaron Courville, and Devon Hjelm.
2018.

</span>
<span class="ltx_bibblock">Mutual information neural estimation. In
<em id="bib.bib2.3.1" class="ltx_emph ltx_font_italic">ICML</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldas et al<span id="bib.bib3.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Sebastian Caldas, Sai
Meher Karthik Duddu, Peter Wu, Tian Li,
Jakub Konečnỳ, H Brendan
McMahan, Virginia Smith, and Ameet
Talwalkar. 2018.

</span>
<span class="ltx_bibblock">Leaf: A benchmark for federated settings.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.01097</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen
et al<span id="bib.bib4.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Fei Chen, Mi Luo,
Zhenhua Dong, Zhenguo Li, and
Xiuqiang He. 2018.

</span>
<span class="ltx_bibblock">Federated meta-learning with fast convergence and
efficient communication.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1802.07876</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng
et al<span id="bib.bib5.2.2.1" class="ltx_text">.</span> (2009)</span>
<span class="ltx_bibblock">
Jia Deng, Wei Dong,
Richard Socher, Li-Jia Li,
Kai Li, and Li Fei-Fei.
2009.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image
database. In <em id="bib.bib5.3.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dinh et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Canh Dinh, Nguyen H Tran,
Minh NH Nguyen, Choong Seon Hong,
Wei Bao, Albert Zomaya, and
Vincent Gramoli. 2019.

</span>
<span class="ltx_bibblock">Federated learning over wireless networks:
Convergence analysis and resource allocation. In
<em id="bib.bib6.3.1" class="ltx_emph ltx_font_italic">Proc. IEEE INFOCOM’19</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Finn
et al<span id="bib.bib7.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Chelsea Finn, Pieter
Abbeel, and Sergey Levine.
2017.

</span>
<span class="ltx_bibblock">Model-agnostic meta-learning for fast adaptation of
deep networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.3.1" class="ltx_emph ltx_font_italic">ICML</em> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Finn
et al<span id="bib.bib8.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Chelsea Finn, Aravind
Rajeswaran, Sham Kakade, and Sergey
Levine. 2019.

</span>
<span class="ltx_bibblock">Online meta-learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.3.1" class="ltx_emph ltx_font_italic">NIPS</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghorbani
et al<span id="bib.bib9.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Behrooz Ghorbani, Shankar
Krishnan, and Ying Xiao.
2019.

</span>
<span class="ltx_bibblock">An Investigation into Neural Net Optimization via
Hessian Eigenvalue Density. In <em id="bib.bib9.3.1" class="ltx_emph ltx_font_italic">ICML</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gidaris and
Komodakis (2018)</span>
<span class="ltx_bibblock">
Spyros Gidaris and Nikos
Komodakis. 2018.

</span>
<span class="ltx_bibblock">Dynamic Few-Shot Visual Learning Without
Forgetting. In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodfellow et al<span id="bib.bib11.2.2.1" class="ltx_text">.</span> (2014)</span>
<span class="ltx_bibblock">
Ian Goodfellow, Jean
Pouget-Abadie, Mehdi Mirza, Bing Xu,
David Warde-Farley, Sherjil Ozair,
Aaron Courville, and Yoshua Bengio.
2014.

</span>
<span class="ltx_bibblock">Generative adversarial nets. In
<em id="bib.bib11.3.1" class="ltx_emph ltx_font_italic">NIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guha
et al<span id="bib.bib12.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Neel Guha, Ameet
Talwalkar, and Virginia Smith.
2019.

</span>
<span class="ltx_bibblock">One-shot federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1902.11175</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He
et al<span id="bib.bib13.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu
Zhang, Shaoqing Ren, and Jian Sun.
2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition. In
<em id="bib.bib13.3.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton
et al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Geoffrey Hinton, Oriol
Vinyals, and Jeff Dean.
2015.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.3.1" class="ltx_emph ltx_font_italic">NIPS Deep Learning and Representation
Learning Workshop</em> (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al<span id="bib.bib15.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang
Qi, and Matthew Brown. 2019.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data
distribution for federated visual classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.06335</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2015)</span>
<span class="ltx_bibblock">
Diederik P Kingma and
Jimmy Ba. 2015.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization. In
<em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">ICLR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li
et al<span id="bib.bib17.2.2.1" class="ltx_text">.</span> (2020a)</span>
<span class="ltx_bibblock">
Aoxue Li, Weiran Huang,
Xu Lan, Jiashi Feng,
Zhenguo Li, and Liwei Wang.
2020a.

</span>
<span class="ltx_bibblock">Boosting Few-Shot Learning With Adaptive Margin
Loss. In <em id="bib.bib17.3.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li
et al<span id="bib.bib18.2.2.1" class="ltx_text">.</span> (2020b)</span>
<span class="ltx_bibblock">
Jeffrey Li, Mikhail
Khodak, Sebastian Caldas, and Ameet
Talwalkar. 2020b.

</span>
<span class="ltx_bibblock">Differentially private meta-learning. In
<em id="bib.bib18.3.1" class="ltx_emph ltx_font_italic">ICLR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li
et al<span id="bib.bib19.3.3.1" class="ltx_text">.</span> (2014)</span>
<span class="ltx_bibblock">
Mu Li, Bor-Yiing Su,
et al<span id="bib.bib19.4.1" class="ltx_text">.</span> 2014.

</span>
<span class="ltx_bibblock">Scaling distributed machine learning with the
parameter server. In <em id="bib.bib19.5.1" class="ltx_emph ltx_font_italic">OSDI</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li
et al<span id="bib.bib20.2.2.1" class="ltx_text">.</span> (2020c)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu,
Ameet Talwalkar, and Virginia Smith.
2020c.

</span>
<span class="ltx_bibblock">Federated learning: Challenges, methods, and future
directions.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.3.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span id="bib.bib21.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu,
Manzil Zaheer, Maziar Sanjabi,
Ameet Talwalkar, and Virginia Smith.
2018.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.06127</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li
et al<span id="bib.bib22.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiang Li, Kaixuan Huang,
Wenhao Yang, Shusen Wang, and
Zhihua Zhang. 2019.

</span>
<span class="ltx_bibblock">On the convergence of fedavg on non-iid data. In
<em id="bib.bib22.3.1" class="ltx_emph ltx_font_italic">ICLR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li
et al<span id="bib.bib23.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Zhenguo Li, Fengwei Zhou,
Fei Chen, and Hang Li.
2017.

</span>
<span class="ltx_bibblock">Meta-sgd: Learning to learn quickly for few-shot
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1707.09835</em>
(2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan
et al<span id="bib.bib24.3.3.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
H Brendan McMahan, Seth
Hampson, et al<span id="bib.bib24.4.1" class="ltx_text">.</span> 2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks
from decentralized data. In <em id="bib.bib24.5.1" class="ltx_emph ltx_font_italic">AISTATS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munkhdalai and Yu (2017)</span>
<span class="ltx_bibblock">
Tsendsuren Munkhdalai and
Hong Yu. 2017.

</span>
<span class="ltx_bibblock">Meta networks. In
<em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">ICML</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oreshkin
et al<span id="bib.bib26.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Boris Oreshkin,
Pau Rodríguez López, and
Alexandre Lacoste. 2018.

</span>
<span class="ltx_bibblock">Tadam: Task dependent adaptive metric for improved
few-shot learning. In <em id="bib.bib26.3.1" class="ltx_emph ltx_font_italic">NIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pennington
et al<span id="bib.bib27.2.2.1" class="ltx_text">.</span> (2014)</span>
<span class="ltx_bibblock">
Jeffrey Pennington,
Richard Socher, and Christopher D
Manning. 2014.

</span>
<span class="ltx_bibblock">Glove: Global vectors for word representation. In
<em id="bib.bib27.3.1" class="ltx_emph ltx_font_italic">EMNLP</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren
et al<span id="bib.bib28.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Shaoqing Ren, Kaiming He,
Ross Girshick, and Jian Sun.
2015.

</span>
<span class="ltx_bibblock">Faster r-cnn: Towards real-time object detection
with region proposal networks. In <em id="bib.bib28.3.1" class="ltx_emph ltx_font_italic">NIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saito
et al<span id="bib.bib29.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Kuniaki Saito, Kohei
Watanabe, Yoshitaka Ushiku, and Tatsuya
Harada. 2018.

</span>
<span class="ltx_bibblock">Maximum classifier discrepancy for unsupervised
domain adaptation. In <em id="bib.bib29.3.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Salehkaleybar et al<span id="bib.bib30.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Saber Salehkaleybar,
Arsalan Sharifnassab, and S Jamaloddin
Golestani. 2019.

</span>
<span class="ltx_bibblock">One-shot federated learning: theoretical limits and
algorithms to achieve them.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1905.04634</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schroff
et al<span id="bib.bib31.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Florian Schroff, Dmitry
Kalenichenko, and James Philbin.
2015.

</span>
<span class="ltx_bibblock">Facenet: A unified embedding for face recognition
and clustering. In <em id="bib.bib31.3.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sharif Razavian et al<span id="bib.bib32.2.2.1" class="ltx_text">.</span> (2014)</span>
<span class="ltx_bibblock">
Ali Sharif Razavian,
Hossein Azizpour, Josephine Sullivan,
and Stefan Carlsson. 2014.

</span>
<span class="ltx_bibblock">CNN features off-the-shelf: an astounding baseline
for recognition. In <em id="bib.bib32.3.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shin
et al<span id="bib.bib33.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
MyungJae Shin, Chihoon
Hwang, Joongheon Kim, Jihong Park,
Mehdi Bennis, and Seong-Lyun Kim.
2020.

</span>
<span class="ltx_bibblock">XOR Mixup: Privacy-Preserving Data Augmentation for
One-Shot Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.05148</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith et al<span id="bib.bib34.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Virginia Smith, Simone
Forte, Chenxin Ma, Martin
Takáč, Michael I Jordan, and
Martin Jaggi. 2017.

</span>
<span class="ltx_bibblock">CoCoA: A general framework for
communication-efficient distributed optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.3.1" class="ltx_emph ltx_font_italic">JMLR</em> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Snell
et al<span id="bib.bib35.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Jake Snell, Kevin
Swersky, and Richard Zemel.
2017.

</span>
<span class="ltx_bibblock">Prototypical networks for few-shot learning. In
<em id="bib.bib35.3.1" class="ltx_emph ltx_font_italic">NIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun
et al<span id="bib.bib36.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Qianru Sun, Yaoyao Liu,
Tat-Seng Chua, and Bernt Schiele.
2019.

</span>
<span class="ltx_bibblock">Meta-transfer learning for few-shot learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.3.1" class="ltx_emph ltx_font_italic">CVPR</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sung et al<span id="bib.bib37.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Flood Sung, Yongxin Yang,
Li Zhang, Tao Xiang,
Philip HS Torr, and Timothy M
Hospedales. 2018.

</span>
<span class="ltx_bibblock">Learning to compare: Relation network for few-shot
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.3.1" class="ltx_emph ltx_font_italic">CVPR</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span id="bib.bib38.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam
Shazeer, Niki Parmar, Jakob Uszkoreit,
Llion Jones, Aidan N Gomez,
Łukasz Kaiser, and Illia
Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need. In
<em id="bib.bib38.3.1" class="ltx_emph ltx_font_italic">NIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vinyals et al<span id="bib.bib39.3.3.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Oriol Vinyals, Charles
Blundell, Timothy Lillicrap, Daan
Wierstra, et al<span id="bib.bib39.4.1" class="ltx_text">.</span> 2016.

</span>
<span class="ltx_bibblock">Matching networks for one shot learning. In
<em id="bib.bib39.5.1" class="ltx_emph ltx_font_italic">NIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu
et al<span id="bib.bib40.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tao Yu, Eugene
Bagdasaryan, and Vitaly Shmatikov.
2020.

</span>
<span class="ltx_bibblock">Salvaging federated learning by local adaptation.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.04758</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yun
et al<span id="bib.bib41.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Sukmin Yun, Jongjin Park,
Kimin Lee, and Jinwoo Shin.
2020.

</span>
<span class="ltx_bibblock">Regularizing class-wise predictions via
self-knowledge distillation. In <em id="bib.bib41.3.1" class="ltx_emph ltx_font_italic">CVPR</em>.
13876–13885.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span id="bib.bib42.2.2.1" class="ltx_text">.</span> (2018a)</span>
<span class="ltx_bibblock">
Ruixiang Zhang, Tong Che,
Zoubin Ghahramani, Yoshua Bengio, and
Yangqiu Song. 2018a.

</span>
<span class="ltx_bibblock">Metagan: An adversarial approach to few-shot
learning. In <em id="bib.bib42.3.1" class="ltx_emph ltx_font_italic">NIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang
et al<span id="bib.bib43.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Sixin Zhang, Anna E
Choromanska, and Yann LeCun.
2015.

</span>
<span class="ltx_bibblock">Deep learning with elastic averaging SGD. In
<em id="bib.bib43.3.1" class="ltx_emph ltx_font_italic">NeurIPS</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang
et al<span id="bib.bib44.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiaoli Zhang, Fengting
Li, Zeyu Zhang, Qi Li,
Cong Wang, and Jianping Wu.
2020.

</span>
<span class="ltx_bibblock">Enabling Execution Assurance of Federated Learning
at Untrusted Participants. In <em id="bib.bib44.3.1" class="ltx_emph ltx_font_italic">Proc. IEEE
INFOCOM’20</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang
et al<span id="bib.bib45.2.2.1" class="ltx_text">.</span> (2018b)</span>
<span class="ltx_bibblock">
Ying Zhang, Tao Xiang,
Timothy M Hospedales, and Huchuan Lu.
2018b.

</span>
<span class="ltx_bibblock">Deep mutual learning. In
<em id="bib.bib45.3.1" class="ltx_emph ltx_font_italic">CVPR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Sabuncu (2020)</span>
<span class="ltx_bibblock">
Zhilu Zhang and Mert R
Sabuncu. 2020.

</span>
<span class="ltx_bibblock">Self-Distillation as Instance-Specific Label
Smoothing.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.05065</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao
et al<span id="bib.bib47.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li,
Liangzhen Lai, Naveen Suda,
Damon Civin, and Vikas Chandra.
2018.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2104.00363" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2104.00365" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2104.00365">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2104.00365" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2104.00366" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 06:38:01 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
