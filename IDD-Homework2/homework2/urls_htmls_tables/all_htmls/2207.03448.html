<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2207.03448] Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data</title><meta property="og:description" content="Federated learning (FL) is a distributed learning method that offers medical institutes the prospect of collaboration in a global model while preserving the privacy of their patients. Although most medical centers cond…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2207.03448">

<!--Generated on Wed Mar 13 15:32:38 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated Learning Personalization Meta-learning Non-i.i.d data.">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>Technical University of Munich, Munich, Germany </span></span></span><span id="id2" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>Johns Hopkins University, Baltimore, USA
</span></span></span>
<h1 class="ltx_title ltx_title_document">Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yousef Yeganeh
</span><span class="ltx_author_notes">Equal Contribution11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Azade Farshad<sup id="id1.1.id1" class="ltx_sup">0</sup>
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Johann Boschmann
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Richard Gaus
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Maximilian Frantzen
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nassir Navab
</span><span class="ltx_author_notes">1122</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">Federated learning (FL) is a distributed learning method that offers medical institutes the prospect of collaboration in a global model while preserving the privacy of their patients. Although most medical centers conduct similar medical imaging tasks, their differences, such as specializations, number of patients, and devices, lead to distinctive data distributions. Data heterogeneity poses a challenge for FL and the personalization of the local models. In this work, we investigate an adaptive hierarchical clustering method for FL to produce intermediate semi-global models, so clients with similar data distribution have the chance of forming a more specialized model. Our method forms several clusters consisting of clients with the most similar data distributions; then, each cluster continues to train separately. Inside the cluster, we use meta-learning to improve the personalization of the participants’ models. We compare the clustering approach with classical FedAvg and centralized training by evaluating our proposed methods on the HAM10k dataset for skin lesion classification with extreme heterogeneous data distribution. Our experiments demonstrate significant performance gain in heterogeneous distribution compared to standard FL methods in classification accuracy. Moreover, we show that the models converge faster if applied in clusters and outperform centralized training while using only a small subset of data.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Federated Learning Personalization Meta-learning Non-i.i.d data.
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Deep learning models outperform classic techniques for pathological diagnoses in medical imaging tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>; however, their performance highly depends on the training data. Unavailability of medical imaging data due to privacy concerns, along with data heterogeneity, can negatively impact the representativity of the model. Federated learning (FL) tackles both of these challenges<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. A federated setting consists of multiple clients and a server; local clients send their models to the server, and the server aggregates them and produces a global model<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Weighted aggregation in FL aims to improve performance in favor of a global model; in turn, parts of the data distribution that potentially have distinctive features are considered outliers, e.g., since hospitals often outweigh specialized centers in terms of the number of patients, the global model tends to represent hospitals’ distribution, so the prospect of collaboration among institutes with similar data distribution is neglected. To improve personalization, we pose FL as a meta learning problem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. We demonstrate that clustering and applying a meta learning scheme improve personalization, preserve more specialized data, and enhance the convergence of the model.
FedAvg (federated averaging) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> was proposed as one of the first FL algorithms and has been used as a standard benchmark. Meta learning, or learning to learn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, is learning how to efficiently solve new tasks from a set of known tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. FL clients can be interpreted as meta learning tasks since each client’s data distribution equals a different problem; hence, meta learning ideas have been successfully applied to FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Inspired by MAML<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, clients with similar distributions are grouped in clusters as a set of tasks, so each cluster is redefined a separate FL problem. This improves the homogeneity of the data between the clients in their corresponding clusters. Although in FL data is not explicitly accessible, we used the value differences of model parameters between the clients from the latest round and the global model as a similarity measure between those clients. Briggs <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>let@tokeneonedotexplores a hierarchical clustering technique to group similar models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, and we utilized the same method for personalization of clients’ models and combined it with our proposed Adaptive Personalization (FedAP) for the final training inside clusters. We kept the simplicity of FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, but with two differences: 1) FedAP treats the aggregated global update as a meta-level gradient that can be used with a different optimizer to update the global model. Particularly, it introduces the new hyperparameter of a meta learning rate. 2) At the end of the training, FedAP personalizes the global model to each individual client. This can have a strong advantage in the context of FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. An overview of our method is depicted in  <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a>. The main contributions of this work are as follows: 1) We propose FedAP, a new hierarchical clustering approach to perform adaptive personalization inside the clusters and each client. 2) Significant performance gain in terms of classification accuracy and decreasing the accuracy variance between different clients. 3) The code of this work will be publicly released upon its acceptance.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2207.03448/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="106" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.2.1" class="ltx_text ltx_font_bold">Method Overview</span>. Our pipeline has four steps:
1) splitting the dataset, 2) training all clients with FedAvg for predefined rounds,
3) clustering the clients based on the latest model update,
4) performing FedAvg or FedAP on each separate cluster.
</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">A study on live data of millions of users shows that significant improvements can be achieved by personalizing the learning rate and batch size to clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. The FedOpt <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> extends the FedAvg algorithm and implements personalization by introducing adjustable gradient update strategies for each client and server. Employing weight decay over training rounds on the server-side is shown to be required to lower the error on non-i.i.d. data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> proposes to learn base layers globally while keeping classification layers private on the client-side. FedMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> introduces a framework for individually designed by each client. The MOCHA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> enables efficient meta-learning in the federated environment. Communication efficiency in federated learning is also addressed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> suggesting a compression protocol based on quantization. Non i.i.d. data is shown to impact both the convergence speed and the final performance of the FedAvg algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> tackle data heterogeneity by sharing a limited common dataset. IDA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> proposes to stabilize and improve the learning process by weighting the clients’ updates based on their distance from the global model. Motivated from classical machine learning techniques <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> introduces a weight regularization term to the local objective function to prevent the divergence between local and global models. Yue <em id="S2.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>let@tokeneonedot<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> surveys on the data availability and heterogeneity in the medical domain, concluding that privacy restrictions and missing data pipelines block the full potential of Deep Learning which requires big data sets. The described advances in the field of federated learning can help overcome the challenge of medical data privacy and disseminate machine learning techniques in healthcare <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. Notably, data heterogeneity remains a significant hurdle to this development, so robust techniques towards non-i.i.d. data carry considerable future potential <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we present our approach to tackling the problem of non-i.i.d. data distribution in federated learning. First, we describe the optimization process in a federated setting and its development in adaptive personalization. Then, we define the original federated averaging scenario. Later, we explain the entire pipeline of our proposed federated adaptive personalization method, followed by how hierarchical clustering can be embedded in our approach.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Definitions</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.9" class="ltx_p">The global data distribution is denoted by <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{D}</annotation></semantics></math>, while <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{S}\sim\mathcal{D}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">𝒮</mi><mo id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1">similar-to</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝒮</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{S}\sim\mathcal{D}</annotation></semantics></math> is the sampled data points and <math id="S3.SS1.p1.3.m3.2" class="ltx_Math" alttext="s_{1},...s_{N}=\mathcal{S}" display="inline"><semantics id="S3.SS1.p1.3.m3.2a"><mrow id="S3.SS1.p1.3.m3.2.2" xref="S3.SS1.p1.3.m3.2.2.cmml"><mrow id="S3.SS1.p1.3.m3.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.3.cmml"><msub id="S3.SS1.p1.3.m3.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml">s</mi><mn id="S3.SS1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.2.2.2.2.3" xref="S3.SS1.p1.3.m3.2.2.2.3.cmml">,</mo><mrow id="S3.SS1.p1.3.m3.2.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.SS1.p1.3.m3.2.2.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.2.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.2.2.2.2.2.1" xref="S3.SS1.p1.3.m3.2.2.2.2.2.1.cmml">​</mo><msub id="S3.SS1.p1.3.m3.2.2.2.2.2.3" xref="S3.SS1.p1.3.m3.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p1.3.m3.2.2.2.2.2.3.2" xref="S3.SS1.p1.3.m3.2.2.2.2.2.3.2.cmml">s</mi><mi id="S3.SS1.p1.3.m3.2.2.2.2.2.3.3" xref="S3.SS1.p1.3.m3.2.2.2.2.2.3.3.cmml">N</mi></msub></mrow></mrow><mo id="S3.SS1.p1.3.m3.2.2.3" xref="S3.SS1.p1.3.m3.2.2.3.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.2.2.4" xref="S3.SS1.p1.3.m3.2.2.4.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.2b"><apply id="S3.SS1.p1.3.m3.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2"><eq id="S3.SS1.p1.3.m3.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.3"></eq><list id="S3.SS1.p1.3.m3.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2"><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2">𝑠</ci><cn type="integer" id="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2"><times id="S3.SS1.p1.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2.1"></times><ci id="S3.SS1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2.2">…</ci><apply id="S3.SS1.p1.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.2.2.2.3.1.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.2.2.2.3.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2.3.2">𝑠</ci><ci id="S3.SS1.p1.3.m3.2.2.2.2.2.3.3.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2.3.3">𝑁</ci></apply></apply></list><ci id="S3.SS1.p1.3.m3.2.2.4.cmml" xref="S3.SS1.p1.3.m3.2.2.4">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.2c">s_{1},...s_{N}=\mathcal{S}</annotation></semantics></math>. The data points are distributed across <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">M</annotation></semantics></math> clients. Each client <math id="S3.SS1.p1.5.m5.3" class="ltx_Math" alttext="i\in\{1,\dots,M\}" display="inline"><semantics id="S3.SS1.p1.5.m5.3a"><mrow id="S3.SS1.p1.5.m5.3.4" xref="S3.SS1.p1.5.m5.3.4.cmml"><mi id="S3.SS1.p1.5.m5.3.4.2" xref="S3.SS1.p1.5.m5.3.4.2.cmml">i</mi><mo id="S3.SS1.p1.5.m5.3.4.1" xref="S3.SS1.p1.5.m5.3.4.1.cmml">∈</mo><mrow id="S3.SS1.p1.5.m5.3.4.3.2" xref="S3.SS1.p1.5.m5.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.3.4.3.2.1" xref="S3.SS1.p1.5.m5.3.4.3.1.cmml">{</mo><mn id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">1</mn><mo id="S3.SS1.p1.5.m5.3.4.3.2.2" xref="S3.SS1.p1.5.m5.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.5.m5.2.2" xref="S3.SS1.p1.5.m5.2.2.cmml">…</mi><mo id="S3.SS1.p1.5.m5.3.4.3.2.3" xref="S3.SS1.p1.5.m5.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p1.5.m5.3.3" xref="S3.SS1.p1.5.m5.3.3.cmml">M</mi><mo stretchy="false" id="S3.SS1.p1.5.m5.3.4.3.2.4" xref="S3.SS1.p1.5.m5.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.3b"><apply id="S3.SS1.p1.5.m5.3.4.cmml" xref="S3.SS1.p1.5.m5.3.4"><in id="S3.SS1.p1.5.m5.3.4.1.cmml" xref="S3.SS1.p1.5.m5.3.4.1"></in><ci id="S3.SS1.p1.5.m5.3.4.2.cmml" xref="S3.SS1.p1.5.m5.3.4.2">𝑖</ci><set id="S3.SS1.p1.5.m5.3.4.3.1.cmml" xref="S3.SS1.p1.5.m5.3.4.3.2"><cn type="integer" id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">1</cn><ci id="S3.SS1.p1.5.m5.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2">…</ci><ci id="S3.SS1.p1.5.m5.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3">𝑀</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.3c">i\in\{1,\dots,M\}</annotation></semantics></math> only sees its local dataset, which is a subset <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{S}_{i}\sim\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><msub id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.2.2" xref="S3.SS1.p1.6.m6.1.1.2.2.cmml">𝒮</mi><mi id="S3.SS1.p1.6.m6.1.1.2.3" xref="S3.SS1.p1.6.m6.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">∼</mo><msub id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">𝒟</mi><mi id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="latexml" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1">similar-to</csymbol><apply id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2.2">𝒮</ci><ci id="S3.SS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">𝒟</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathcal{S}_{i}\sim\mathcal{D}_{i}</annotation></semantics></math> of the global data and <math id="S3.SS1.p1.7.m7.3" class="ltx_Math" alttext="s_{1},...,s_{N_{i}}=\mathcal{S}_{i}" display="inline"><semantics id="S3.SS1.p1.7.m7.3a"><mrow id="S3.SS1.p1.7.m7.3.3" xref="S3.SS1.p1.7.m7.3.3.cmml"><mrow id="S3.SS1.p1.7.m7.3.3.2.2" xref="S3.SS1.p1.7.m7.3.3.2.3.cmml"><msub id="S3.SS1.p1.7.m7.2.2.1.1.1" xref="S3.SS1.p1.7.m7.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.7.m7.2.2.1.1.1.2" xref="S3.SS1.p1.7.m7.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS1.p1.7.m7.2.2.1.1.1.3" xref="S3.SS1.p1.7.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.7.m7.3.3.2.2.3" xref="S3.SS1.p1.7.m7.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">…</mi><mo id="S3.SS1.p1.7.m7.3.3.2.2.4" xref="S3.SS1.p1.7.m7.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.7.m7.3.3.2.2.2" xref="S3.SS1.p1.7.m7.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.7.m7.3.3.2.2.2.2" xref="S3.SS1.p1.7.m7.3.3.2.2.2.2.cmml">s</mi><msub id="S3.SS1.p1.7.m7.3.3.2.2.2.3" xref="S3.SS1.p1.7.m7.3.3.2.2.2.3.cmml"><mi id="S3.SS1.p1.7.m7.3.3.2.2.2.3.2" xref="S3.SS1.p1.7.m7.3.3.2.2.2.3.2.cmml">N</mi><mi id="S3.SS1.p1.7.m7.3.3.2.2.2.3.3" xref="S3.SS1.p1.7.m7.3.3.2.2.2.3.3.cmml">i</mi></msub></msub></mrow><mo id="S3.SS1.p1.7.m7.3.3.3" xref="S3.SS1.p1.7.m7.3.3.3.cmml">=</mo><msub id="S3.SS1.p1.7.m7.3.3.4" xref="S3.SS1.p1.7.m7.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.3.3.4.2" xref="S3.SS1.p1.7.m7.3.3.4.2.cmml">𝒮</mi><mi id="S3.SS1.p1.7.m7.3.3.4.3" xref="S3.SS1.p1.7.m7.3.3.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.3b"><apply id="S3.SS1.p1.7.m7.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3"><eq id="S3.SS1.p1.7.m7.3.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3.3"></eq><list id="S3.SS1.p1.7.m7.3.3.2.3.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2"><apply id="S3.SS1.p1.7.m7.2.2.1.1.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1.2">𝑠</ci><cn type="integer" id="S3.SS1.p1.7.m7.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">…</ci><apply id="S3.SS1.p1.7.m7.3.3.2.2.2.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2.2">𝑠</ci><apply id="S3.SS1.p1.7.m7.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.2.2.2.3.1.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.2.2.2.3.2.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2.3.2">𝑁</ci><ci id="S3.SS1.p1.7.m7.3.3.2.2.2.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2.3.3">𝑖</ci></apply></apply></list><apply id="S3.SS1.p1.7.m7.3.3.4.cmml" xref="S3.SS1.p1.7.m7.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.4.1.cmml" xref="S3.SS1.p1.7.m7.3.3.4">subscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.4.2.cmml" xref="S3.SS1.p1.7.m7.3.3.4.2">𝒮</ci><ci id="S3.SS1.p1.7.m7.3.3.4.3.cmml" xref="S3.SS1.p1.7.m7.3.3.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.3c">s_{1},...,s_{N_{i}}=\mathcal{S}_{i}</annotation></semantics></math>. <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝒟</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\mathcal{D}_{i}</annotation></semantics></math> being the client’s local data distribution. With the global model parameters <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="\theta_{global}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><msub id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">θ</mi><mrow id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3.2" xref="S3.SS1.p1.9.m9.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.1.1.3.1" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.1.1.3.3" xref="S3.SS1.p1.9.m9.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.1.1.3.1a" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.1.1.3.4" xref="S3.SS1.p1.9.m9.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.1.1.3.1b" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.1.1.3.5" xref="S3.SS1.p1.9.m9.1.1.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.1.1.3.1c" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.1.1.3.6" xref="S3.SS1.p1.9.m9.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.1.1.3.1d" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.1.1.3.7" xref="S3.SS1.p1.9.m9.1.1.3.7.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝜃</ci><apply id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3"><times id="S3.SS1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1"></times><ci id="S3.SS1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2">𝑔</ci><ci id="S3.SS1.p1.9.m9.1.1.3.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.3">𝑙</ci><ci id="S3.SS1.p1.9.m9.1.1.3.4.cmml" xref="S3.SS1.p1.9.m9.1.1.3.4">𝑜</ci><ci id="S3.SS1.p1.9.m9.1.1.3.5.cmml" xref="S3.SS1.p1.9.m9.1.1.3.5">𝑏</ci><ci id="S3.SS1.p1.9.m9.1.1.3.6.cmml" xref="S3.SS1.p1.9.m9.1.1.3.6">𝑎</ci><ci id="S3.SS1.p1.9.m9.1.1.3.7.cmml" xref="S3.SS1.p1.9.m9.1.1.3.7">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\theta_{global}</annotation></semantics></math>, the overall optimization task can be defined as:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.2" class="ltx_Math" alttext="\min_{\theta_{global}}\mathcal{L}_{\text{}}(\mathcal{S})=\min_{\theta_{global}}\frac{1}{M}\sum_{i=1}^{M}l_{\theta_{global}}(\mathcal{S}_{i})" display="block"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mrow id="S3.E1.m1.2.2.3" xref="S3.E1.m1.2.2.3.cmml"><mrow id="S3.E1.m1.2.2.3.2" xref="S3.E1.m1.2.2.3.2.cmml"><munder id="S3.E1.m1.2.2.3.2.1" xref="S3.E1.m1.2.2.3.2.1.cmml"><mi id="S3.E1.m1.2.2.3.2.1.2" xref="S3.E1.m1.2.2.3.2.1.2.cmml">min</mi><msub id="S3.E1.m1.2.2.3.2.1.3" xref="S3.E1.m1.2.2.3.2.1.3.cmml"><mi id="S3.E1.m1.2.2.3.2.1.3.2" xref="S3.E1.m1.2.2.3.2.1.3.2.cmml">θ</mi><mrow id="S3.E1.m1.2.2.3.2.1.3.3" xref="S3.E1.m1.2.2.3.2.1.3.3.cmml"><mi id="S3.E1.m1.2.2.3.2.1.3.3.2" xref="S3.E1.m1.2.2.3.2.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.3.2.1.3.3.1" xref="S3.E1.m1.2.2.3.2.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.3.2.1.3.3.3" xref="S3.E1.m1.2.2.3.2.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.3.2.1.3.3.1a" xref="S3.E1.m1.2.2.3.2.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.3.2.1.3.3.4" xref="S3.E1.m1.2.2.3.2.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.3.2.1.3.3.1b" xref="S3.E1.m1.2.2.3.2.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.3.2.1.3.3.5" xref="S3.E1.m1.2.2.3.2.1.3.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.3.2.1.3.3.1c" xref="S3.E1.m1.2.2.3.2.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.3.2.1.3.3.6" xref="S3.E1.m1.2.2.3.2.1.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.3.2.1.3.3.1d" xref="S3.E1.m1.2.2.3.2.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.3.2.1.3.3.7" xref="S3.E1.m1.2.2.3.2.1.3.3.7.cmml">l</mi></mrow></msub></munder><mo lspace="0.167em" id="S3.E1.m1.2.2.3.2a" xref="S3.E1.m1.2.2.3.2.cmml">⁡</mo><msub id="S3.E1.m1.2.2.3.2.2" xref="S3.E1.m1.2.2.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.3.2.2.2" xref="S3.E1.m1.2.2.3.2.2.2.cmml">ℒ</mi><mrow id="S3.E1.m1.2.2.3.2.2.3" xref="S3.E1.m1.2.2.3.2.2.3a.cmml"></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.3.1" xref="S3.E1.m1.2.2.3.1.cmml">​</mo><mrow id="S3.E1.m1.2.2.3.3.2" xref="S3.E1.m1.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.3.3.2.1" xref="S3.E1.m1.2.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝒮</mi><mo stretchy="false" id="S3.E1.m1.2.2.3.3.2.2" xref="S3.E1.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml">=</mo><mrow id="S3.E1.m1.2.2.1" xref="S3.E1.m1.2.2.1.cmml"><mrow id="S3.E1.m1.2.2.1.3" xref="S3.E1.m1.2.2.1.3.cmml"><munder id="S3.E1.m1.2.2.1.3.1" xref="S3.E1.m1.2.2.1.3.1.cmml"><mi id="S3.E1.m1.2.2.1.3.1.2" xref="S3.E1.m1.2.2.1.3.1.2.cmml">min</mi><msub id="S3.E1.m1.2.2.1.3.1.3" xref="S3.E1.m1.2.2.1.3.1.3.cmml"><mi id="S3.E1.m1.2.2.1.3.1.3.2" xref="S3.E1.m1.2.2.1.3.1.3.2.cmml">θ</mi><mrow id="S3.E1.m1.2.2.1.3.1.3.3" xref="S3.E1.m1.2.2.1.3.1.3.3.cmml"><mi id="S3.E1.m1.2.2.1.3.1.3.3.2" xref="S3.E1.m1.2.2.1.3.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.3.1.3.3.1" xref="S3.E1.m1.2.2.1.3.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.3.1.3.3.3" xref="S3.E1.m1.2.2.1.3.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.3.1.3.3.1a" xref="S3.E1.m1.2.2.1.3.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.3.1.3.3.4" xref="S3.E1.m1.2.2.1.3.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.3.1.3.3.1b" xref="S3.E1.m1.2.2.1.3.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.3.1.3.3.5" xref="S3.E1.m1.2.2.1.3.1.3.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.3.1.3.3.1c" xref="S3.E1.m1.2.2.1.3.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.3.1.3.3.6" xref="S3.E1.m1.2.2.1.3.1.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.3.1.3.3.1d" xref="S3.E1.m1.2.2.1.3.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.3.1.3.3.7" xref="S3.E1.m1.2.2.1.3.1.3.3.7.cmml">l</mi></mrow></msub></munder><mo lspace="0.167em" id="S3.E1.m1.2.2.1.3a" xref="S3.E1.m1.2.2.1.3.cmml">⁡</mo><mfrac id="S3.E1.m1.2.2.1.3.2" xref="S3.E1.m1.2.2.1.3.2.cmml"><mn id="S3.E1.m1.2.2.1.3.2.2" xref="S3.E1.m1.2.2.1.3.2.2.cmml">1</mn><mi id="S3.E1.m1.2.2.1.3.2.3" xref="S3.E1.m1.2.2.1.3.2.3.cmml">M</mi></mfrac></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.2" xref="S3.E1.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><munderover id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.2.2.1.1.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.3.2" xref="S3.E1.m1.2.2.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.2.2.1.1.2.2.3.1" xref="S3.E1.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.2.2.1.1.2.2.3.3" xref="S3.E1.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.2.2.1.1.2.3" xref="S3.E1.m1.2.2.1.1.2.3.cmml">M</mi></munderover><mrow id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml"><msub id="S3.E1.m1.2.2.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.3.2" xref="S3.E1.m1.2.2.1.1.1.3.2.cmml">l</mi><msub id="S3.E1.m1.2.2.1.1.1.3.3" xref="S3.E1.m1.2.2.1.1.1.3.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.3.3.2" xref="S3.E1.m1.2.2.1.1.1.3.3.2.cmml">θ</mi><mrow id="S3.E1.m1.2.2.1.1.1.3.3.3" xref="S3.E1.m1.2.2.1.1.1.3.3.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.3.3.3.2" xref="S3.E1.m1.2.2.1.1.1.3.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.3.3.3.1" xref="S3.E1.m1.2.2.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.1.1.3.3.3.3" xref="S3.E1.m1.2.2.1.1.1.3.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.3.3.3.1a" xref="S3.E1.m1.2.2.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.1.1.3.3.3.4" xref="S3.E1.m1.2.2.1.1.1.3.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.3.3.3.1b" xref="S3.E1.m1.2.2.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.1.1.3.3.3.5" xref="S3.E1.m1.2.2.1.1.1.3.3.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.3.3.3.1c" xref="S3.E1.m1.2.2.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.1.1.3.3.3.6" xref="S3.E1.m1.2.2.1.1.1.3.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.3.3.3.1d" xref="S3.E1.m1.2.2.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E1.m1.2.2.1.1.1.3.3.3.7" xref="S3.E1.m1.2.2.1.1.1.3.3.3.7.cmml">l</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.2.2.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.2.2.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><eq id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"></eq><apply id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2.3"><times id="S3.E1.m1.2.2.3.1.cmml" xref="S3.E1.m1.2.2.3.1"></times><apply id="S3.E1.m1.2.2.3.2.cmml" xref="S3.E1.m1.2.2.3.2"><apply id="S3.E1.m1.2.2.3.2.1.cmml" xref="S3.E1.m1.2.2.3.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.3.2.1.1.cmml" xref="S3.E1.m1.2.2.3.2.1">subscript</csymbol><min id="S3.E1.m1.2.2.3.2.1.2.cmml" xref="S3.E1.m1.2.2.3.2.1.2"></min><apply id="S3.E1.m1.2.2.3.2.1.3.cmml" xref="S3.E1.m1.2.2.3.2.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.3.2.1.3.1.cmml" xref="S3.E1.m1.2.2.3.2.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.3.2.1.3.2.cmml" xref="S3.E1.m1.2.2.3.2.1.3.2">𝜃</ci><apply id="S3.E1.m1.2.2.3.2.1.3.3.cmml" xref="S3.E1.m1.2.2.3.2.1.3.3"><times id="S3.E1.m1.2.2.3.2.1.3.3.1.cmml" xref="S3.E1.m1.2.2.3.2.1.3.3.1"></times><ci id="S3.E1.m1.2.2.3.2.1.3.3.2.cmml" xref="S3.E1.m1.2.2.3.2.1.3.3.2">𝑔</ci><ci id="S3.E1.m1.2.2.3.2.1.3.3.3.cmml" xref="S3.E1.m1.2.2.3.2.1.3.3.3">𝑙</ci><ci id="S3.E1.m1.2.2.3.2.1.3.3.4.cmml" xref="S3.E1.m1.2.2.3.2.1.3.3.4">𝑜</ci><ci id="S3.E1.m1.2.2.3.2.1.3.3.5.cmml" xref="S3.E1.m1.2.2.3.2.1.3.3.5">𝑏</ci><ci id="S3.E1.m1.2.2.3.2.1.3.3.6.cmml" xref="S3.E1.m1.2.2.3.2.1.3.3.6">𝑎</ci><ci id="S3.E1.m1.2.2.3.2.1.3.3.7.cmml" xref="S3.E1.m1.2.2.3.2.1.3.3.7">𝑙</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.3.2.2.cmml" xref="S3.E1.m1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.3.2.2.1.cmml" xref="S3.E1.m1.2.2.3.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.3.2.2.2.cmml" xref="S3.E1.m1.2.2.3.2.2.2">ℒ</ci><ci id="S3.E1.m1.2.2.3.2.2.3a.cmml" xref="S3.E1.m1.2.2.3.2.2.3"><mrow id="S3.E1.m1.2.2.3.2.2.3.cmml" xref="S3.E1.m1.2.2.3.2.2.3"></mrow></ci></apply></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝒮</ci></apply><apply id="S3.E1.m1.2.2.1.cmml" xref="S3.E1.m1.2.2.1"><times id="S3.E1.m1.2.2.1.2.cmml" xref="S3.E1.m1.2.2.1.2"></times><apply id="S3.E1.m1.2.2.1.3.cmml" xref="S3.E1.m1.2.2.1.3"><apply id="S3.E1.m1.2.2.1.3.1.cmml" xref="S3.E1.m1.2.2.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.3.1.1.cmml" xref="S3.E1.m1.2.2.1.3.1">subscript</csymbol><min id="S3.E1.m1.2.2.1.3.1.2.cmml" xref="S3.E1.m1.2.2.1.3.1.2"></min><apply id="S3.E1.m1.2.2.1.3.1.3.cmml" xref="S3.E1.m1.2.2.1.3.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.3.1.3.1.cmml" xref="S3.E1.m1.2.2.1.3.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.3.1.3.2.cmml" xref="S3.E1.m1.2.2.1.3.1.3.2">𝜃</ci><apply id="S3.E1.m1.2.2.1.3.1.3.3.cmml" xref="S3.E1.m1.2.2.1.3.1.3.3"><times id="S3.E1.m1.2.2.1.3.1.3.3.1.cmml" xref="S3.E1.m1.2.2.1.3.1.3.3.1"></times><ci id="S3.E1.m1.2.2.1.3.1.3.3.2.cmml" xref="S3.E1.m1.2.2.1.3.1.3.3.2">𝑔</ci><ci id="S3.E1.m1.2.2.1.3.1.3.3.3.cmml" xref="S3.E1.m1.2.2.1.3.1.3.3.3">𝑙</ci><ci id="S3.E1.m1.2.2.1.3.1.3.3.4.cmml" xref="S3.E1.m1.2.2.1.3.1.3.3.4">𝑜</ci><ci id="S3.E1.m1.2.2.1.3.1.3.3.5.cmml" xref="S3.E1.m1.2.2.1.3.1.3.3.5">𝑏</ci><ci id="S3.E1.m1.2.2.1.3.1.3.3.6.cmml" xref="S3.E1.m1.2.2.1.3.1.3.3.6">𝑎</ci><ci id="S3.E1.m1.2.2.1.3.1.3.3.7.cmml" xref="S3.E1.m1.2.2.1.3.1.3.3.7">𝑙</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.1.3.2.cmml" xref="S3.E1.m1.2.2.1.3.2"><divide id="S3.E1.m1.2.2.1.3.2.1.cmml" xref="S3.E1.m1.2.2.1.3.2"></divide><cn type="integer" id="S3.E1.m1.2.2.1.3.2.2.cmml" xref="S3.E1.m1.2.2.1.3.2.2">1</cn><ci id="S3.E1.m1.2.2.1.3.2.3.cmml" xref="S3.E1.m1.2.2.1.3.2.3">𝑀</ci></apply></apply><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1"><apply id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2">subscript</csymbol><sum id="S3.E1.m1.2.2.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2"></sum><apply id="S3.E1.m1.2.2.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3"><eq id="S3.E1.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.2.2.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.3">𝑀</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1"><times id="S3.E1.m1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2"></times><apply id="S3.E1.m1.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.3.2">𝑙</ci><apply id="S3.E1.m1.2.2.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.3.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.3.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3.2">𝜃</ci><apply id="S3.E1.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3.3"><times id="S3.E1.m1.2.2.1.1.1.3.3.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3.3.1"></times><ci id="S3.E1.m1.2.2.1.1.1.3.3.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3.3.2">𝑔</ci><ci id="S3.E1.m1.2.2.1.1.1.3.3.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3.3.3">𝑙</ci><ci id="S3.E1.m1.2.2.1.1.1.3.3.3.4.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3.3.4">𝑜</ci><ci id="S3.E1.m1.2.2.1.1.1.3.3.3.5.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3.3.5">𝑏</ci><ci id="S3.E1.m1.2.2.1.1.1.3.3.3.6.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3.3.6">𝑎</ci><ci id="S3.E1.m1.2.2.1.1.1.3.3.3.7.cmml" xref="S3.E1.m1.2.2.1.1.1.3.3.3.7">𝑙</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.2">𝒮</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\min_{\theta_{global}}\mathcal{L}_{\text{}}(\mathcal{S})=\min_{\theta_{global}}\frac{1}{M}\sum_{i=1}^{M}l_{\theta_{global}}(\mathcal{S}_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.16" class="ltx_p">where <math id="S3.SS1.p1.10.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\text{}}" display="inline"><semantics id="S3.SS1.p1.10.m1.1a"><msub id="S3.SS1.p1.10.m1.1.1" xref="S3.SS1.p1.10.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m1.1.1.2" xref="S3.SS1.p1.10.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS1.p1.10.m1.1.1.3" xref="S3.SS1.p1.10.m1.1.1.3a.cmml"></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m1.1b"><apply id="S3.SS1.p1.10.m1.1.1.cmml" xref="S3.SS1.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m1.1.1.1.cmml" xref="S3.SS1.p1.10.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m1.1.1.2.cmml" xref="S3.SS1.p1.10.m1.1.1.2">ℒ</ci><ci id="S3.SS1.p1.10.m1.1.1.3a.cmml" xref="S3.SS1.p1.10.m1.1.1.3"><mrow id="S3.SS1.p1.10.m1.1.1.3.cmml" xref="S3.SS1.p1.10.m1.1.1.3"></mrow></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m1.1c">\mathcal{L}_{\text{}}</annotation></semantics></math> is the global loss function and <math id="S3.SS1.p1.11.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p1.11.m2.1a"><mi id="S3.SS1.p1.11.m2.1.1" xref="S3.SS1.p1.11.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m2.1b"><ci id="S3.SS1.p1.11.m2.1.1.cmml" xref="S3.SS1.p1.11.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m2.1c">l</annotation></semantics></math> the local loss function of each client.
We hypothesize that, while each distribution <math id="S3.SS1.p1.12.m3.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p1.12.m3.1a"><msub id="S3.SS1.p1.12.m3.1.1" xref="S3.SS1.p1.12.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m3.1.1.2" xref="S3.SS1.p1.12.m3.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.12.m3.1.1.3" xref="S3.SS1.p1.12.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m3.1b"><apply id="S3.SS1.p1.12.m3.1.1.cmml" xref="S3.SS1.p1.12.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m3.1.1.1.cmml" xref="S3.SS1.p1.12.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m3.1.1.2.cmml" xref="S3.SS1.p1.12.m3.1.1.2">𝒟</ci><ci id="S3.SS1.p1.12.m3.1.1.3.cmml" xref="S3.SS1.p1.12.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m3.1c">\mathcal{D}_{i}</annotation></semantics></math> is different, they can be clustered by similarity. Following Briggs <em id="S3.SS1.p1.16.1" class="ltx_emph ltx_font_italic">et al</em>let@tokeneonedot<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, we introduce a distinct model <math id="S3.SS1.p1.13.m4.1" class="ltx_Math" alttext="\theta_{c}" display="inline"><semantics id="S3.SS1.p1.13.m4.1a"><msub id="S3.SS1.p1.13.m4.1.1" xref="S3.SS1.p1.13.m4.1.1.cmml"><mi id="S3.SS1.p1.13.m4.1.1.2" xref="S3.SS1.p1.13.m4.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.13.m4.1.1.3" xref="S3.SS1.p1.13.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m4.1b"><apply id="S3.SS1.p1.13.m4.1.1.cmml" xref="S3.SS1.p1.13.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m4.1.1.1.cmml" xref="S3.SS1.p1.13.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m4.1.1.2.cmml" xref="S3.SS1.p1.13.m4.1.1.2">𝜃</ci><ci id="S3.SS1.p1.13.m4.1.1.3.cmml" xref="S3.SS1.p1.13.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m4.1c">\theta_{c}</annotation></semantics></math> for each resulting cluster <math id="S3.SS1.p1.14.m5.1" class="ltx_Math" alttext="c\in C" display="inline"><semantics id="S3.SS1.p1.14.m5.1a"><mrow id="S3.SS1.p1.14.m5.1.1" xref="S3.SS1.p1.14.m5.1.1.cmml"><mi id="S3.SS1.p1.14.m5.1.1.2" xref="S3.SS1.p1.14.m5.1.1.2.cmml">c</mi><mo id="S3.SS1.p1.14.m5.1.1.1" xref="S3.SS1.p1.14.m5.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.14.m5.1.1.3" xref="S3.SS1.p1.14.m5.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m5.1b"><apply id="S3.SS1.p1.14.m5.1.1.cmml" xref="S3.SS1.p1.14.m5.1.1"><in id="S3.SS1.p1.14.m5.1.1.1.cmml" xref="S3.SS1.p1.14.m5.1.1.1"></in><ci id="S3.SS1.p1.14.m5.1.1.2.cmml" xref="S3.SS1.p1.14.m5.1.1.2">𝑐</ci><ci id="S3.SS1.p1.14.m5.1.1.3.cmml" xref="S3.SS1.p1.14.m5.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m5.1c">c\in C</annotation></semantics></math>, where <math id="S3.SS1.p1.15.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p1.15.m6.1a"><mi id="S3.SS1.p1.15.m6.1.1" xref="S3.SS1.p1.15.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m6.1b"><ci id="S3.SS1.p1.15.m6.1.1.cmml" xref="S3.SS1.p1.15.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m6.1c">C</annotation></semantics></math> is the set of all clusters and <math id="S3.SS1.p1.16.m7.1" class="ltx_Math" alttext="\theta_{C}" display="inline"><semantics id="S3.SS1.p1.16.m7.1a"><msub id="S3.SS1.p1.16.m7.1.1" xref="S3.SS1.p1.16.m7.1.1.cmml"><mi id="S3.SS1.p1.16.m7.1.1.2" xref="S3.SS1.p1.16.m7.1.1.2.cmml">θ</mi><mi id="S3.SS1.p1.16.m7.1.1.3" xref="S3.SS1.p1.16.m7.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m7.1b"><apply id="S3.SS1.p1.16.m7.1.1.cmml" xref="S3.SS1.p1.16.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m7.1.1.1.cmml" xref="S3.SS1.p1.16.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.16.m7.1.1.2.cmml" xref="S3.SS1.p1.16.m7.1.1.2">𝜃</ci><ci id="S3.SS1.p1.16.m7.1.1.3.cmml" xref="S3.SS1.p1.16.m7.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m7.1c">\theta_{C}</annotation></semantics></math> is the set of all cluster model parameters.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.4" class="ltx_p">We annotate the data distribution in each cluster by <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{c}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝒟</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{D}_{c}</annotation></semantics></math> with <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{S}_{c}\sim\mathcal{D}_{c}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1.2.2" xref="S3.SS1.p2.2.m2.1.1.2.2.cmml">𝒮</mi><mi id="S3.SS1.p2.2.m2.1.1.2.3" xref="S3.SS1.p2.2.m2.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml">∼</mo><msub id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">𝒟</mi><mi id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="latexml" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1">similar-to</csymbol><apply id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2.2">𝒮</ci><ci id="S3.SS1.p2.2.m2.1.1.2.3.cmml" xref="S3.SS1.p2.2.m2.1.1.2.3">𝑐</ci></apply><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">𝒟</ci><ci id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathcal{S}_{c}\sim\mathcal{D}_{c}</annotation></semantics></math> being the data points and <math id="S3.SS1.p2.3.m3.3" class="ltx_Math" alttext="s_{1},...,s_{N_{c}}=\mathcal{S}_{c}" display="inline"><semantics id="S3.SS1.p2.3.m3.3a"><mrow id="S3.SS1.p2.3.m3.3.3" xref="S3.SS1.p2.3.m3.3.3.cmml"><mrow id="S3.SS1.p2.3.m3.3.3.2.2" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml"><msub id="S3.SS1.p2.3.m3.2.2.1.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.2.2.1.1.1.2" xref="S3.SS1.p2.3.m3.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS1.p2.3.m3.2.2.1.1.1.3" xref="S3.SS1.p2.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.3.m3.3.3.2.2.3" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">…</mi><mo id="S3.SS1.p2.3.m3.3.3.2.2.4" xref="S3.SS1.p2.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p2.3.m3.3.3.2.2.2" xref="S3.SS1.p2.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.3.m3.3.3.2.2.2.2" xref="S3.SS1.p2.3.m3.3.3.2.2.2.2.cmml">s</mi><msub id="S3.SS1.p2.3.m3.3.3.2.2.2.3" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3.cmml"><mi id="S3.SS1.p2.3.m3.3.3.2.2.2.3.2" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3.2.cmml">N</mi><mi id="S3.SS1.p2.3.m3.3.3.2.2.2.3.3" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3.3.cmml">c</mi></msub></msub></mrow><mo id="S3.SS1.p2.3.m3.3.3.3" xref="S3.SS1.p2.3.m3.3.3.3.cmml">=</mo><msub id="S3.SS1.p2.3.m3.3.3.4" xref="S3.SS1.p2.3.m3.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.3.3.4.2" xref="S3.SS1.p2.3.m3.3.3.4.2.cmml">𝒮</mi><mi id="S3.SS1.p2.3.m3.3.3.4.3" xref="S3.SS1.p2.3.m3.3.3.4.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.3b"><apply id="S3.SS1.p2.3.m3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3"><eq id="S3.SS1.p2.3.m3.3.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3.3"></eq><list id="S3.SS1.p2.3.m3.3.3.2.3.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2"><apply id="S3.SS1.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.2">𝑠</ci><cn type="integer" id="S3.SS1.p2.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">…</ci><apply id="S3.SS1.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2.2">𝑠</ci><apply id="S3.SS1.p2.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.2.2.2.3.1.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.3.3.2.2.2.3.2.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3.2">𝑁</ci><ci id="S3.SS1.p2.3.m3.3.3.2.2.2.3.3.cmml" xref="S3.SS1.p2.3.m3.3.3.2.2.2.3.3">𝑐</ci></apply></apply></list><apply id="S3.SS1.p2.3.m3.3.3.4.cmml" xref="S3.SS1.p2.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.3.3.4.1.cmml" xref="S3.SS1.p2.3.m3.3.3.4">subscript</csymbol><ci id="S3.SS1.p2.3.m3.3.3.4.2.cmml" xref="S3.SS1.p2.3.m3.3.3.4.2">𝒮</ci><ci id="S3.SS1.p2.3.m3.3.3.4.3.cmml" xref="S3.SS1.p2.3.m3.3.3.4.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.3c">s_{1},...,s_{N_{c}}=\mathcal{S}_{c}</annotation></semantics></math>.
Integrating these clusters into <a href="#S3.E1" title="1 ‣ 3.1 Definitions ‣ 3 Method ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 1</span></a>, we arrive at the following global and local loss function for each cluster <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">c</annotation></semantics></math>:</p>
<table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle\min_{\theta_{C}}\mathcal{L}_{\text{}}(\mathcal{S})" display="inline"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.2" xref="S3.E2.m1.1.2.cmml"><mrow id="S3.E2.m1.1.2.2" xref="S3.E2.m1.1.2.2.cmml"><munder id="S3.E2.m1.1.2.2.1" xref="S3.E2.m1.1.2.2.1.cmml"><mi id="S3.E2.m1.1.2.2.1.2" xref="S3.E2.m1.1.2.2.1.2.cmml">min</mi><msub id="S3.E2.m1.1.2.2.1.3" xref="S3.E2.m1.1.2.2.1.3.cmml"><mi id="S3.E2.m1.1.2.2.1.3.2" xref="S3.E2.m1.1.2.2.1.3.2.cmml">θ</mi><mi id="S3.E2.m1.1.2.2.1.3.3" xref="S3.E2.m1.1.2.2.1.3.3.cmml">C</mi></msub></munder><mo lspace="0.167em" id="S3.E2.m1.1.2.2a" xref="S3.E2.m1.1.2.2.cmml">⁡</mo><msub id="S3.E2.m1.1.2.2.2" xref="S3.E2.m1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.2.2.2.2" xref="S3.E2.m1.1.2.2.2.2.cmml">ℒ</mi><mrow id="S3.E2.m1.1.2.2.2.3" xref="S3.E2.m1.1.2.2.2.3a.cmml"></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.2.1" xref="S3.E2.m1.1.2.1.cmml">​</mo><mrow id="S3.E2.m1.1.2.3.2" xref="S3.E2.m1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.2.3.2.1" xref="S3.E2.m1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝒮</mi><mo stretchy="false" id="S3.E2.m1.1.2.3.2.2" xref="S3.E2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.2.cmml" xref="S3.E2.m1.1.2"><times id="S3.E2.m1.1.2.1.cmml" xref="S3.E2.m1.1.2.1"></times><apply id="S3.E2.m1.1.2.2.cmml" xref="S3.E2.m1.1.2.2"><apply id="S3.E2.m1.1.2.2.1.cmml" xref="S3.E2.m1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.2.2.1.1.cmml" xref="S3.E2.m1.1.2.2.1">subscript</csymbol><min id="S3.E2.m1.1.2.2.1.2.cmml" xref="S3.E2.m1.1.2.2.1.2"></min><apply id="S3.E2.m1.1.2.2.1.3.cmml" xref="S3.E2.m1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.2.2.1.3.1.cmml" xref="S3.E2.m1.1.2.2.1.3">subscript</csymbol><ci id="S3.E2.m1.1.2.2.1.3.2.cmml" xref="S3.E2.m1.1.2.2.1.3.2">𝜃</ci><ci id="S3.E2.m1.1.2.2.1.3.3.cmml" xref="S3.E2.m1.1.2.2.1.3.3">𝐶</ci></apply></apply><apply id="S3.E2.m1.1.2.2.2.cmml" xref="S3.E2.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.2.2.2.1.cmml" xref="S3.E2.m1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.1.2.2.2.2.cmml" xref="S3.E2.m1.1.2.2.2.2">ℒ</ci><ci id="S3.E2.m1.1.2.2.2.3a.cmml" xref="S3.E2.m1.1.2.2.2.3"><mrow id="S3.E2.m1.1.2.2.2.3.cmml" xref="S3.E2.m1.1.2.2.2.3"></mrow></ci></apply></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle\min_{\theta_{C}}\mathcal{L}_{\text{}}(\mathcal{S})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m2.2" class="ltx_Math" alttext="\displaystyle=\min_{\theta_{C}}\frac{1}{|C|}\sum_{c\in C}l_{\theta_{c}}(\mathcal{S}_{c})" display="inline"><semantics id="S3.E2.m2.2a"><mrow id="S3.E2.m2.2.2" xref="S3.E2.m2.2.2.cmml"><mi id="S3.E2.m2.2.2.3" xref="S3.E2.m2.2.2.3.cmml"></mi><mo id="S3.E2.m2.2.2.2" xref="S3.E2.m2.2.2.2.cmml">=</mo><mrow id="S3.E2.m2.2.2.1" xref="S3.E2.m2.2.2.1.cmml"><mrow id="S3.E2.m2.2.2.1.3" xref="S3.E2.m2.2.2.1.3.cmml"><munder id="S3.E2.m2.2.2.1.3.1" xref="S3.E2.m2.2.2.1.3.1.cmml"><mi id="S3.E2.m2.2.2.1.3.1.2" xref="S3.E2.m2.2.2.1.3.1.2.cmml">min</mi><msub id="S3.E2.m2.2.2.1.3.1.3" xref="S3.E2.m2.2.2.1.3.1.3.cmml"><mi id="S3.E2.m2.2.2.1.3.1.3.2" xref="S3.E2.m2.2.2.1.3.1.3.2.cmml">θ</mi><mi id="S3.E2.m2.2.2.1.3.1.3.3" xref="S3.E2.m2.2.2.1.3.1.3.3.cmml">C</mi></msub></munder><mo lspace="0.167em" id="S3.E2.m2.2.2.1.3a" xref="S3.E2.m2.2.2.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E2.m2.1.1" xref="S3.E2.m2.1.1.cmml"><mfrac id="S3.E2.m2.1.1a" xref="S3.E2.m2.1.1.cmml"><mn id="S3.E2.m2.1.1.3" xref="S3.E2.m2.1.1.3.cmml">1</mn><mrow id="S3.E2.m2.1.1.1.3" xref="S3.E2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m2.1.1.1.3.1" xref="S3.E2.m2.1.1.1.2.1.cmml">|</mo><mi id="S3.E2.m2.1.1.1.1" xref="S3.E2.m2.1.1.1.1.cmml">C</mi><mo stretchy="false" id="S3.E2.m2.1.1.1.3.2" xref="S3.E2.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m2.2.2.1.2" xref="S3.E2.m2.2.2.1.2.cmml">​</mo><mrow id="S3.E2.m2.2.2.1.1" xref="S3.E2.m2.2.2.1.1.cmml"><mstyle displaystyle="true" id="S3.E2.m2.2.2.1.1.2" xref="S3.E2.m2.2.2.1.1.2.cmml"><munder id="S3.E2.m2.2.2.1.1.2a" xref="S3.E2.m2.2.2.1.1.2.cmml"><mo movablelimits="false" id="S3.E2.m2.2.2.1.1.2.2" xref="S3.E2.m2.2.2.1.1.2.2.cmml">∑</mo><mrow id="S3.E2.m2.2.2.1.1.2.3" xref="S3.E2.m2.2.2.1.1.2.3.cmml"><mi id="S3.E2.m2.2.2.1.1.2.3.2" xref="S3.E2.m2.2.2.1.1.2.3.2.cmml">c</mi><mo id="S3.E2.m2.2.2.1.1.2.3.1" xref="S3.E2.m2.2.2.1.1.2.3.1.cmml">∈</mo><mi id="S3.E2.m2.2.2.1.1.2.3.3" xref="S3.E2.m2.2.2.1.1.2.3.3.cmml">C</mi></mrow></munder></mstyle><mrow id="S3.E2.m2.2.2.1.1.1" xref="S3.E2.m2.2.2.1.1.1.cmml"><msub id="S3.E2.m2.2.2.1.1.1.3" xref="S3.E2.m2.2.2.1.1.1.3.cmml"><mi id="S3.E2.m2.2.2.1.1.1.3.2" xref="S3.E2.m2.2.2.1.1.1.3.2.cmml">l</mi><msub id="S3.E2.m2.2.2.1.1.1.3.3" xref="S3.E2.m2.2.2.1.1.1.3.3.cmml"><mi id="S3.E2.m2.2.2.1.1.1.3.3.2" xref="S3.E2.m2.2.2.1.1.1.3.3.2.cmml">θ</mi><mi id="S3.E2.m2.2.2.1.1.1.3.3.3" xref="S3.E2.m2.2.2.1.1.1.3.3.3.cmml">c</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E2.m2.2.2.1.1.1.2" xref="S3.E2.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m2.2.2.1.1.1.1.1" xref="S3.E2.m2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m2.2.2.1.1.1.1.1.2" xref="S3.E2.m2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m2.2.2.1.1.1.1.1.1" xref="S3.E2.m2.2.2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m2.2.2.1.1.1.1.1.1.2" xref="S3.E2.m2.2.2.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.E2.m2.2.2.1.1.1.1.1.1.3" xref="S3.E2.m2.2.2.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S3.E2.m2.2.2.1.1.1.1.1.3" xref="S3.E2.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m2.2b"><apply id="S3.E2.m2.2.2.cmml" xref="S3.E2.m2.2.2"><eq id="S3.E2.m2.2.2.2.cmml" xref="S3.E2.m2.2.2.2"></eq><csymbol cd="latexml" id="S3.E2.m2.2.2.3.cmml" xref="S3.E2.m2.2.2.3">absent</csymbol><apply id="S3.E2.m2.2.2.1.cmml" xref="S3.E2.m2.2.2.1"><times id="S3.E2.m2.2.2.1.2.cmml" xref="S3.E2.m2.2.2.1.2"></times><apply id="S3.E2.m2.2.2.1.3.cmml" xref="S3.E2.m2.2.2.1.3"><apply id="S3.E2.m2.2.2.1.3.1.cmml" xref="S3.E2.m2.2.2.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.1.3.1.1.cmml" xref="S3.E2.m2.2.2.1.3.1">subscript</csymbol><min id="S3.E2.m2.2.2.1.3.1.2.cmml" xref="S3.E2.m2.2.2.1.3.1.2"></min><apply id="S3.E2.m2.2.2.1.3.1.3.cmml" xref="S3.E2.m2.2.2.1.3.1.3"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.1.3.1.3.1.cmml" xref="S3.E2.m2.2.2.1.3.1.3">subscript</csymbol><ci id="S3.E2.m2.2.2.1.3.1.3.2.cmml" xref="S3.E2.m2.2.2.1.3.1.3.2">𝜃</ci><ci id="S3.E2.m2.2.2.1.3.1.3.3.cmml" xref="S3.E2.m2.2.2.1.3.1.3.3">𝐶</ci></apply></apply><apply id="S3.E2.m2.1.1.cmml" xref="S3.E2.m2.1.1"><divide id="S3.E2.m2.1.1.2.cmml" xref="S3.E2.m2.1.1"></divide><cn type="integer" id="S3.E2.m2.1.1.3.cmml" xref="S3.E2.m2.1.1.3">1</cn><apply id="S3.E2.m2.1.1.1.2.cmml" xref="S3.E2.m2.1.1.1.3"><abs id="S3.E2.m2.1.1.1.2.1.cmml" xref="S3.E2.m2.1.1.1.3.1"></abs><ci id="S3.E2.m2.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1.1">𝐶</ci></apply></apply></apply><apply id="S3.E2.m2.2.2.1.1.cmml" xref="S3.E2.m2.2.2.1.1"><apply id="S3.E2.m2.2.2.1.1.2.cmml" xref="S3.E2.m2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.1.1.2.1.cmml" xref="S3.E2.m2.2.2.1.1.2">subscript</csymbol><sum id="S3.E2.m2.2.2.1.1.2.2.cmml" xref="S3.E2.m2.2.2.1.1.2.2"></sum><apply id="S3.E2.m2.2.2.1.1.2.3.cmml" xref="S3.E2.m2.2.2.1.1.2.3"><in id="S3.E2.m2.2.2.1.1.2.3.1.cmml" xref="S3.E2.m2.2.2.1.1.2.3.1"></in><ci id="S3.E2.m2.2.2.1.1.2.3.2.cmml" xref="S3.E2.m2.2.2.1.1.2.3.2">𝑐</ci><ci id="S3.E2.m2.2.2.1.1.2.3.3.cmml" xref="S3.E2.m2.2.2.1.1.2.3.3">𝐶</ci></apply></apply><apply id="S3.E2.m2.2.2.1.1.1.cmml" xref="S3.E2.m2.2.2.1.1.1"><times id="S3.E2.m2.2.2.1.1.1.2.cmml" xref="S3.E2.m2.2.2.1.1.1.2"></times><apply id="S3.E2.m2.2.2.1.1.1.3.cmml" xref="S3.E2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.1.1.1.3.1.cmml" xref="S3.E2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E2.m2.2.2.1.1.1.3.2.cmml" xref="S3.E2.m2.2.2.1.1.1.3.2">𝑙</ci><apply id="S3.E2.m2.2.2.1.1.1.3.3.cmml" xref="S3.E2.m2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.1.1.1.3.3.1.cmml" xref="S3.E2.m2.2.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m2.2.2.1.1.1.3.3.2.cmml" xref="S3.E2.m2.2.2.1.1.1.3.3.2">𝜃</ci><ci id="S3.E2.m2.2.2.1.1.1.3.3.3.cmml" xref="S3.E2.m2.2.2.1.1.1.3.3.3">𝑐</ci></apply></apply><apply id="S3.E2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m2.2.2.1.1.1.1.1.1.2">𝒮</ci><ci id="S3.E2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m2.2.2.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.2c">\displaystyle=\min_{\theta_{C}}\frac{1}{|C|}\sum_{c\in C}l_{\theta_{c}}(\mathcal{S}_{c})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\displaystyle l_{\theta_{c}}(\mathcal{S}_{c})" display="inline"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msub id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml">l</mi><msub id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml"><mi id="S3.E3.m1.1.1.3.3.2" xref="S3.E3.m1.1.1.3.3.2.cmml">θ</mi><mi id="S3.E3.m1.1.1.3.3.3" xref="S3.E3.m1.1.1.3.3.3.cmml">c</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><times id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"></times><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2">𝑙</ci><apply id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2">𝜃</ci><ci id="S3.E3.m1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3">𝑐</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2">𝒮</ci><ci id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle l_{\theta_{c}}(\mathcal{S}_{c})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m2.2" class="ltx_Math" alttext="\displaystyle=\frac{1}{|c|}\sum_{i\in c}l_{\theta_{c}}(\mathcal{S}_{i})" display="inline"><semantics id="S3.E3.m2.2a"><mrow id="S3.E3.m2.2.2" xref="S3.E3.m2.2.2.cmml"><mi id="S3.E3.m2.2.2.3" xref="S3.E3.m2.2.2.3.cmml"></mi><mo id="S3.E3.m2.2.2.2" xref="S3.E3.m2.2.2.2.cmml">=</mo><mrow id="S3.E3.m2.2.2.1" xref="S3.E3.m2.2.2.1.cmml"><mstyle displaystyle="true" id="S3.E3.m2.1.1" xref="S3.E3.m2.1.1.cmml"><mfrac id="S3.E3.m2.1.1a" xref="S3.E3.m2.1.1.cmml"><mn id="S3.E3.m2.1.1.3" xref="S3.E3.m2.1.1.3.cmml">1</mn><mrow id="S3.E3.m2.1.1.1.3" xref="S3.E3.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m2.1.1.1.3.1" xref="S3.E3.m2.1.1.1.2.1.cmml">|</mo><mi id="S3.E3.m2.1.1.1.1" xref="S3.E3.m2.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E3.m2.1.1.1.3.2" xref="S3.E3.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E3.m2.2.2.1.2" xref="S3.E3.m2.2.2.1.2.cmml">​</mo><mrow id="S3.E3.m2.2.2.1.1" xref="S3.E3.m2.2.2.1.1.cmml"><mstyle displaystyle="true" id="S3.E3.m2.2.2.1.1.2" xref="S3.E3.m2.2.2.1.1.2.cmml"><munder id="S3.E3.m2.2.2.1.1.2a" xref="S3.E3.m2.2.2.1.1.2.cmml"><mo movablelimits="false" id="S3.E3.m2.2.2.1.1.2.2" xref="S3.E3.m2.2.2.1.1.2.2.cmml">∑</mo><mrow id="S3.E3.m2.2.2.1.1.2.3" xref="S3.E3.m2.2.2.1.1.2.3.cmml"><mi id="S3.E3.m2.2.2.1.1.2.3.2" xref="S3.E3.m2.2.2.1.1.2.3.2.cmml">i</mi><mo id="S3.E3.m2.2.2.1.1.2.3.1" xref="S3.E3.m2.2.2.1.1.2.3.1.cmml">∈</mo><mi id="S3.E3.m2.2.2.1.1.2.3.3" xref="S3.E3.m2.2.2.1.1.2.3.3.cmml">c</mi></mrow></munder></mstyle><mrow id="S3.E3.m2.2.2.1.1.1" xref="S3.E3.m2.2.2.1.1.1.cmml"><msub id="S3.E3.m2.2.2.1.1.1.3" xref="S3.E3.m2.2.2.1.1.1.3.cmml"><mi id="S3.E3.m2.2.2.1.1.1.3.2" xref="S3.E3.m2.2.2.1.1.1.3.2.cmml">l</mi><msub id="S3.E3.m2.2.2.1.1.1.3.3" xref="S3.E3.m2.2.2.1.1.1.3.3.cmml"><mi id="S3.E3.m2.2.2.1.1.1.3.3.2" xref="S3.E3.m2.2.2.1.1.1.3.3.2.cmml">θ</mi><mi id="S3.E3.m2.2.2.1.1.1.3.3.3" xref="S3.E3.m2.2.2.1.1.1.3.3.3.cmml">c</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E3.m2.2.2.1.1.1.2" xref="S3.E3.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m2.2.2.1.1.1.1.1" xref="S3.E3.m2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m2.2.2.1.1.1.1.1.2" xref="S3.E3.m2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m2.2.2.1.1.1.1.1.1" xref="S3.E3.m2.2.2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m2.2.2.1.1.1.1.1.1.2" xref="S3.E3.m2.2.2.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.E3.m2.2.2.1.1.1.1.1.1.3" xref="S3.E3.m2.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E3.m2.2.2.1.1.1.1.1.3" xref="S3.E3.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.2b"><apply id="S3.E3.m2.2.2.cmml" xref="S3.E3.m2.2.2"><eq id="S3.E3.m2.2.2.2.cmml" xref="S3.E3.m2.2.2.2"></eq><csymbol cd="latexml" id="S3.E3.m2.2.2.3.cmml" xref="S3.E3.m2.2.2.3">absent</csymbol><apply id="S3.E3.m2.2.2.1.cmml" xref="S3.E3.m2.2.2.1"><times id="S3.E3.m2.2.2.1.2.cmml" xref="S3.E3.m2.2.2.1.2"></times><apply id="S3.E3.m2.1.1.cmml" xref="S3.E3.m2.1.1"><divide id="S3.E3.m2.1.1.2.cmml" xref="S3.E3.m2.1.1"></divide><cn type="integer" id="S3.E3.m2.1.1.3.cmml" xref="S3.E3.m2.1.1.3">1</cn><apply id="S3.E3.m2.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.3"><abs id="S3.E3.m2.1.1.1.2.1.cmml" xref="S3.E3.m2.1.1.1.3.1"></abs><ci id="S3.E3.m2.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1">𝑐</ci></apply></apply><apply id="S3.E3.m2.2.2.1.1.cmml" xref="S3.E3.m2.2.2.1.1"><apply id="S3.E3.m2.2.2.1.1.2.cmml" xref="S3.E3.m2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.1.1.2.1.cmml" xref="S3.E3.m2.2.2.1.1.2">subscript</csymbol><sum id="S3.E3.m2.2.2.1.1.2.2.cmml" xref="S3.E3.m2.2.2.1.1.2.2"></sum><apply id="S3.E3.m2.2.2.1.1.2.3.cmml" xref="S3.E3.m2.2.2.1.1.2.3"><in id="S3.E3.m2.2.2.1.1.2.3.1.cmml" xref="S3.E3.m2.2.2.1.1.2.3.1"></in><ci id="S3.E3.m2.2.2.1.1.2.3.2.cmml" xref="S3.E3.m2.2.2.1.1.2.3.2">𝑖</ci><ci id="S3.E3.m2.2.2.1.1.2.3.3.cmml" xref="S3.E3.m2.2.2.1.1.2.3.3">𝑐</ci></apply></apply><apply id="S3.E3.m2.2.2.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1.1"><times id="S3.E3.m2.2.2.1.1.1.2.cmml" xref="S3.E3.m2.2.2.1.1.1.2"></times><apply id="S3.E3.m2.2.2.1.1.1.3.cmml" xref="S3.E3.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.1.1.1.3.1.cmml" xref="S3.E3.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E3.m2.2.2.1.1.1.3.2.cmml" xref="S3.E3.m2.2.2.1.1.1.3.2">𝑙</ci><apply id="S3.E3.m2.2.2.1.1.1.3.3.cmml" xref="S3.E3.m2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.1.1.1.3.3.1.cmml" xref="S3.E3.m2.2.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E3.m2.2.2.1.1.1.3.3.2.cmml" xref="S3.E3.m2.2.2.1.1.1.3.3.2">𝜃</ci><ci id="S3.E3.m2.2.2.1.1.1.3.3.3.cmml" xref="S3.E3.m2.2.2.1.1.1.3.3.3">𝑐</ci></apply></apply><apply id="S3.E3.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1.1.2">𝒮</ci><ci id="S3.E3.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.2c">\displaystyle=\frac{1}{|c|}\sum_{i\in c}l_{\theta_{c}}(\mathcal{S}_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.5" class="ltx_p">Extending this model to a personalized version where each client has its own model results in <a href="#S3.E4" title="4 ‣ 3.1 Definitions ‣ 3 Method ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 4</span></a>:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.8" class="ltx_Math" alttext="\min_{(\theta_{1},...,\theta_{n})}\mathcal{L}_{\text{}}(\mathcal{S})=\min_{(\theta_{1},...,\theta_{n})}\frac{1}{N}\sum_{i=1}^{N}l_{\theta_{i}}(\mathcal{S}_{i})" display="block"><semantics id="S3.E4.m1.8a"><mrow id="S3.E4.m1.8.8" xref="S3.E4.m1.8.8.cmml"><mrow id="S3.E4.m1.8.8.3" xref="S3.E4.m1.8.8.3.cmml"><mrow id="S3.E4.m1.8.8.3.2" xref="S3.E4.m1.8.8.3.2.cmml"><munder id="S3.E4.m1.8.8.3.2.1" xref="S3.E4.m1.8.8.3.2.1.cmml"><mi id="S3.E4.m1.8.8.3.2.1.2" xref="S3.E4.m1.8.8.3.2.1.2.cmml">min</mi><mrow id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.3.3.3" xref="S3.E4.m1.3.3.3.4.cmml">(</mo><msub id="S3.E4.m1.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.1.cmml"><mi id="S3.E4.m1.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.1.2.cmml">θ</mi><mn id="S3.E4.m1.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.1.3.cmml">1</mn></msub><mo id="S3.E4.m1.3.3.3.3.4" xref="S3.E4.m1.3.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">…</mi><mo id="S3.E4.m1.3.3.3.3.5" xref="S3.E4.m1.3.3.3.4.cmml">,</mo><msub id="S3.E4.m1.3.3.3.3.2" xref="S3.E4.m1.3.3.3.3.2.cmml"><mi id="S3.E4.m1.3.3.3.3.2.2" xref="S3.E4.m1.3.3.3.3.2.2.cmml">θ</mi><mi id="S3.E4.m1.3.3.3.3.2.3" xref="S3.E4.m1.3.3.3.3.2.3.cmml">n</mi></msub><mo stretchy="false" id="S3.E4.m1.3.3.3.3.6" xref="S3.E4.m1.3.3.3.4.cmml">)</mo></mrow></munder><mo lspace="0.167em" id="S3.E4.m1.8.8.3.2a" xref="S3.E4.m1.8.8.3.2.cmml">⁡</mo><msub id="S3.E4.m1.8.8.3.2.2" xref="S3.E4.m1.8.8.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.8.8.3.2.2.2" xref="S3.E4.m1.8.8.3.2.2.2.cmml">ℒ</mi><mrow id="S3.E4.m1.8.8.3.2.2.3" xref="S3.E4.m1.8.8.3.2.2.3a.cmml"></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.8.8.3.1" xref="S3.E4.m1.8.8.3.1.cmml">​</mo><mrow id="S3.E4.m1.8.8.3.3.2" xref="S3.E4.m1.8.8.3.cmml"><mo stretchy="false" id="S3.E4.m1.8.8.3.3.2.1" xref="S3.E4.m1.8.8.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.7.7" xref="S3.E4.m1.7.7.cmml">𝒮</mi><mo stretchy="false" id="S3.E4.m1.8.8.3.3.2.2" xref="S3.E4.m1.8.8.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.8.8.2" xref="S3.E4.m1.8.8.2.cmml">=</mo><mrow id="S3.E4.m1.8.8.1" xref="S3.E4.m1.8.8.1.cmml"><mrow id="S3.E4.m1.8.8.1.3" xref="S3.E4.m1.8.8.1.3.cmml"><munder id="S3.E4.m1.8.8.1.3.1" xref="S3.E4.m1.8.8.1.3.1.cmml"><mi id="S3.E4.m1.8.8.1.3.1.2" xref="S3.E4.m1.8.8.1.3.1.2.cmml">min</mi><mrow id="S3.E4.m1.6.6.3.3" xref="S3.E4.m1.6.6.3.4.cmml"><mo stretchy="false" id="S3.E4.m1.6.6.3.3.3" xref="S3.E4.m1.6.6.3.4.cmml">(</mo><msub id="S3.E4.m1.5.5.2.2.1" xref="S3.E4.m1.5.5.2.2.1.cmml"><mi id="S3.E4.m1.5.5.2.2.1.2" xref="S3.E4.m1.5.5.2.2.1.2.cmml">θ</mi><mn id="S3.E4.m1.5.5.2.2.1.3" xref="S3.E4.m1.5.5.2.2.1.3.cmml">1</mn></msub><mo id="S3.E4.m1.6.6.3.3.4" xref="S3.E4.m1.6.6.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml">…</mi><mo id="S3.E4.m1.6.6.3.3.5" xref="S3.E4.m1.6.6.3.4.cmml">,</mo><msub id="S3.E4.m1.6.6.3.3.2" xref="S3.E4.m1.6.6.3.3.2.cmml"><mi id="S3.E4.m1.6.6.3.3.2.2" xref="S3.E4.m1.6.6.3.3.2.2.cmml">θ</mi><mi id="S3.E4.m1.6.6.3.3.2.3" xref="S3.E4.m1.6.6.3.3.2.3.cmml">n</mi></msub><mo stretchy="false" id="S3.E4.m1.6.6.3.3.6" xref="S3.E4.m1.6.6.3.4.cmml">)</mo></mrow></munder><mo lspace="0.167em" id="S3.E4.m1.8.8.1.3a" xref="S3.E4.m1.8.8.1.3.cmml">⁡</mo><mfrac id="S3.E4.m1.8.8.1.3.2" xref="S3.E4.m1.8.8.1.3.2.cmml"><mn id="S3.E4.m1.8.8.1.3.2.2" xref="S3.E4.m1.8.8.1.3.2.2.cmml">1</mn><mi id="S3.E4.m1.8.8.1.3.2.3" xref="S3.E4.m1.8.8.1.3.2.3.cmml">N</mi></mfrac></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.8.8.1.2" xref="S3.E4.m1.8.8.1.2.cmml">​</mo><mrow id="S3.E4.m1.8.8.1.1" xref="S3.E4.m1.8.8.1.1.cmml"><munderover id="S3.E4.m1.8.8.1.1.2" xref="S3.E4.m1.8.8.1.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.8.8.1.1.2.2.2" xref="S3.E4.m1.8.8.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.8.8.1.1.2.2.3" xref="S3.E4.m1.8.8.1.1.2.2.3.cmml"><mi id="S3.E4.m1.8.8.1.1.2.2.3.2" xref="S3.E4.m1.8.8.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E4.m1.8.8.1.1.2.2.3.1" xref="S3.E4.m1.8.8.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.8.8.1.1.2.2.3.3" xref="S3.E4.m1.8.8.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.8.8.1.1.2.3" xref="S3.E4.m1.8.8.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E4.m1.8.8.1.1.1" xref="S3.E4.m1.8.8.1.1.1.cmml"><msub id="S3.E4.m1.8.8.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.3.cmml"><mi id="S3.E4.m1.8.8.1.1.1.3.2" xref="S3.E4.m1.8.8.1.1.1.3.2.cmml">l</mi><msub id="S3.E4.m1.8.8.1.1.1.3.3" xref="S3.E4.m1.8.8.1.1.1.3.3.cmml"><mi id="S3.E4.m1.8.8.1.1.1.3.3.2" xref="S3.E4.m1.8.8.1.1.1.3.3.2.cmml">θ</mi><mi id="S3.E4.m1.8.8.1.1.1.3.3.3" xref="S3.E4.m1.8.8.1.1.1.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.8.8.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.8.8.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.8.8.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.8.8.1.1.1.1.1.1" xref="S3.E4.m1.8.8.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.8.8.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2.cmml">𝒮</mi><mi id="S3.E4.m1.8.8.1.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.8.8.1.1.1.1.1.3" xref="S3.E4.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.8b"><apply id="S3.E4.m1.8.8.cmml" xref="S3.E4.m1.8.8"><eq id="S3.E4.m1.8.8.2.cmml" xref="S3.E4.m1.8.8.2"></eq><apply id="S3.E4.m1.8.8.3.cmml" xref="S3.E4.m1.8.8.3"><times id="S3.E4.m1.8.8.3.1.cmml" xref="S3.E4.m1.8.8.3.1"></times><apply id="S3.E4.m1.8.8.3.2.cmml" xref="S3.E4.m1.8.8.3.2"><apply id="S3.E4.m1.8.8.3.2.1.cmml" xref="S3.E4.m1.8.8.3.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.3.2.1.1.cmml" xref="S3.E4.m1.8.8.3.2.1">subscript</csymbol><min id="S3.E4.m1.8.8.3.2.1.2.cmml" xref="S3.E4.m1.8.8.3.2.1.2"></min><vector id="S3.E4.m1.3.3.3.4.cmml" xref="S3.E4.m1.3.3.3.3"><apply id="S3.E4.m1.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.1.2">𝜃</ci><cn type="integer" id="S3.E4.m1.2.2.2.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.1.3">1</cn></apply><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">…</ci><apply id="S3.E4.m1.3.3.3.3.2.cmml" xref="S3.E4.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.2.1.cmml" xref="S3.E4.m1.3.3.3.3.2">subscript</csymbol><ci id="S3.E4.m1.3.3.3.3.2.2.cmml" xref="S3.E4.m1.3.3.3.3.2.2">𝜃</ci><ci id="S3.E4.m1.3.3.3.3.2.3.cmml" xref="S3.E4.m1.3.3.3.3.2.3">𝑛</ci></apply></vector></apply><apply id="S3.E4.m1.8.8.3.2.2.cmml" xref="S3.E4.m1.8.8.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.3.2.2.1.cmml" xref="S3.E4.m1.8.8.3.2.2">subscript</csymbol><ci id="S3.E4.m1.8.8.3.2.2.2.cmml" xref="S3.E4.m1.8.8.3.2.2.2">ℒ</ci><ci id="S3.E4.m1.8.8.3.2.2.3a.cmml" xref="S3.E4.m1.8.8.3.2.2.3"><mrow id="S3.E4.m1.8.8.3.2.2.3.cmml" xref="S3.E4.m1.8.8.3.2.2.3"></mrow></ci></apply></apply><ci id="S3.E4.m1.7.7.cmml" xref="S3.E4.m1.7.7">𝒮</ci></apply><apply id="S3.E4.m1.8.8.1.cmml" xref="S3.E4.m1.8.8.1"><times id="S3.E4.m1.8.8.1.2.cmml" xref="S3.E4.m1.8.8.1.2"></times><apply id="S3.E4.m1.8.8.1.3.cmml" xref="S3.E4.m1.8.8.1.3"><apply id="S3.E4.m1.8.8.1.3.1.cmml" xref="S3.E4.m1.8.8.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.3.1.1.cmml" xref="S3.E4.m1.8.8.1.3.1">subscript</csymbol><min id="S3.E4.m1.8.8.1.3.1.2.cmml" xref="S3.E4.m1.8.8.1.3.1.2"></min><vector id="S3.E4.m1.6.6.3.4.cmml" xref="S3.E4.m1.6.6.3.3"><apply id="S3.E4.m1.5.5.2.2.1.cmml" xref="S3.E4.m1.5.5.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.2.2.1.1.cmml" xref="S3.E4.m1.5.5.2.2.1">subscript</csymbol><ci id="S3.E4.m1.5.5.2.2.1.2.cmml" xref="S3.E4.m1.5.5.2.2.1.2">𝜃</ci><cn type="integer" id="S3.E4.m1.5.5.2.2.1.3.cmml" xref="S3.E4.m1.5.5.2.2.1.3">1</cn></apply><ci id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1.1">…</ci><apply id="S3.E4.m1.6.6.3.3.2.cmml" xref="S3.E4.m1.6.6.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.3.3.2.1.cmml" xref="S3.E4.m1.6.6.3.3.2">subscript</csymbol><ci id="S3.E4.m1.6.6.3.3.2.2.cmml" xref="S3.E4.m1.6.6.3.3.2.2">𝜃</ci><ci id="S3.E4.m1.6.6.3.3.2.3.cmml" xref="S3.E4.m1.6.6.3.3.2.3">𝑛</ci></apply></vector></apply><apply id="S3.E4.m1.8.8.1.3.2.cmml" xref="S3.E4.m1.8.8.1.3.2"><divide id="S3.E4.m1.8.8.1.3.2.1.cmml" xref="S3.E4.m1.8.8.1.3.2"></divide><cn type="integer" id="S3.E4.m1.8.8.1.3.2.2.cmml" xref="S3.E4.m1.8.8.1.3.2.2">1</cn><ci id="S3.E4.m1.8.8.1.3.2.3.cmml" xref="S3.E4.m1.8.8.1.3.2.3">𝑁</ci></apply></apply><apply id="S3.E4.m1.8.8.1.1.cmml" xref="S3.E4.m1.8.8.1.1"><apply id="S3.E4.m1.8.8.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.2.1.cmml" xref="S3.E4.m1.8.8.1.1.2">superscript</csymbol><apply id="S3.E4.m1.8.8.1.1.2.2.cmml" xref="S3.E4.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.2.2.1.cmml" xref="S3.E4.m1.8.8.1.1.2">subscript</csymbol><sum id="S3.E4.m1.8.8.1.1.2.2.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.2"></sum><apply id="S3.E4.m1.8.8.1.1.2.2.3.cmml" xref="S3.E4.m1.8.8.1.1.2.2.3"><eq id="S3.E4.m1.8.8.1.1.2.2.3.1.cmml" xref="S3.E4.m1.8.8.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.8.8.1.1.2.2.3.2.cmml" xref="S3.E4.m1.8.8.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.8.8.1.1.2.2.3.3.cmml" xref="S3.E4.m1.8.8.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.8.8.1.1.2.3.cmml" xref="S3.E4.m1.8.8.1.1.2.3">𝑁</ci></apply><apply id="S3.E4.m1.8.8.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1"><times id="S3.E4.m1.8.8.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.2"></times><apply id="S3.E4.m1.8.8.1.1.1.3.cmml" xref="S3.E4.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.8.8.1.1.1.3.2.cmml" xref="S3.E4.m1.8.8.1.1.1.3.2">𝑙</ci><apply id="S3.E4.m1.8.8.1.1.1.3.3.cmml" xref="S3.E4.m1.8.8.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.3.3.1.cmml" xref="S3.E4.m1.8.8.1.1.1.3.3">subscript</csymbol><ci id="S3.E4.m1.8.8.1.1.1.3.3.2.cmml" xref="S3.E4.m1.8.8.1.1.1.3.3.2">𝜃</ci><ci id="S3.E4.m1.8.8.1.1.1.3.3.3.cmml" xref="S3.E4.m1.8.8.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.2">𝒮</ci><ci id="S3.E4.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.8.8.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.8c">\min_{(\theta_{1},...,\theta_{n})}\mathcal{L}_{\text{}}(\mathcal{S})=\min_{(\theta_{1},...,\theta_{n})}\frac{1}{N}\sum_{i=1}^{N}l_{\theta_{i}}(\mathcal{S}_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.6" class="ltx_p"><a href="#S3.E2" title="2 ‣ 3.1 Definitions ‣ 3 Method ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 2</span></a> and <a href="#S3.E4" title="4 ‣ 3.1 Definitions ‣ 3 Method ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 4</span></a> both introduce additional degrees of freedom which allow to learn the sampled training data points from the respective distributions better than a single model as shown in <a href="#S3.E1" title="1 ‣ 3.1 Definitions ‣ 3 Method ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 1</span></a>. We can sum up the results in the following form:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.6" class="ltx_Math" alttext="\min_{\theta_{global}}\mathcal{L}_{\text{}}(\mathcal{S})\geq\min_{\theta_{C}}\mathcal{L}_{\text{}}(\mathcal{S})\geq\min_{(\theta_{1},...,\theta_{M})}\mathcal{L}_{\text{}}(\mathcal{S})" display="block"><semantics id="S3.E5.m1.6a"><mrow id="S3.E5.m1.6.7" xref="S3.E5.m1.6.7.cmml"><mrow id="S3.E5.m1.6.7.2" xref="S3.E5.m1.6.7.2.cmml"><mrow id="S3.E5.m1.6.7.2.2" xref="S3.E5.m1.6.7.2.2.cmml"><munder id="S3.E5.m1.6.7.2.2.1" xref="S3.E5.m1.6.7.2.2.1.cmml"><mi id="S3.E5.m1.6.7.2.2.1.2" xref="S3.E5.m1.6.7.2.2.1.2.cmml">min</mi><msub id="S3.E5.m1.6.7.2.2.1.3" xref="S3.E5.m1.6.7.2.2.1.3.cmml"><mi id="S3.E5.m1.6.7.2.2.1.3.2" xref="S3.E5.m1.6.7.2.2.1.3.2.cmml">θ</mi><mrow id="S3.E5.m1.6.7.2.2.1.3.3" xref="S3.E5.m1.6.7.2.2.1.3.3.cmml"><mi id="S3.E5.m1.6.7.2.2.1.3.3.2" xref="S3.E5.m1.6.7.2.2.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.7.2.2.1.3.3.1" xref="S3.E5.m1.6.7.2.2.1.3.3.1.cmml">​</mo><mi id="S3.E5.m1.6.7.2.2.1.3.3.3" xref="S3.E5.m1.6.7.2.2.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.7.2.2.1.3.3.1a" xref="S3.E5.m1.6.7.2.2.1.3.3.1.cmml">​</mo><mi id="S3.E5.m1.6.7.2.2.1.3.3.4" xref="S3.E5.m1.6.7.2.2.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.7.2.2.1.3.3.1b" xref="S3.E5.m1.6.7.2.2.1.3.3.1.cmml">​</mo><mi id="S3.E5.m1.6.7.2.2.1.3.3.5" xref="S3.E5.m1.6.7.2.2.1.3.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.7.2.2.1.3.3.1c" xref="S3.E5.m1.6.7.2.2.1.3.3.1.cmml">​</mo><mi id="S3.E5.m1.6.7.2.2.1.3.3.6" xref="S3.E5.m1.6.7.2.2.1.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.7.2.2.1.3.3.1d" xref="S3.E5.m1.6.7.2.2.1.3.3.1.cmml">​</mo><mi id="S3.E5.m1.6.7.2.2.1.3.3.7" xref="S3.E5.m1.6.7.2.2.1.3.3.7.cmml">l</mi></mrow></msub></munder><mo lspace="0.167em" id="S3.E5.m1.6.7.2.2a" xref="S3.E5.m1.6.7.2.2.cmml">⁡</mo><msub id="S3.E5.m1.6.7.2.2.2" xref="S3.E5.m1.6.7.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.6.7.2.2.2.2" xref="S3.E5.m1.6.7.2.2.2.2.cmml">ℒ</mi><mrow id="S3.E5.m1.6.7.2.2.2.3" xref="S3.E5.m1.6.7.2.2.2.3a.cmml"></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.7.2.1" xref="S3.E5.m1.6.7.2.1.cmml">​</mo><mrow id="S3.E5.m1.6.7.2.3.2" xref="S3.E5.m1.6.7.2.cmml"><mo stretchy="false" id="S3.E5.m1.6.7.2.3.2.1" xref="S3.E5.m1.6.7.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">𝒮</mi><mo stretchy="false" id="S3.E5.m1.6.7.2.3.2.2" xref="S3.E5.m1.6.7.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.6.7.3" xref="S3.E5.m1.6.7.3.cmml">≥</mo><mrow id="S3.E5.m1.6.7.4" xref="S3.E5.m1.6.7.4.cmml"><mrow id="S3.E5.m1.6.7.4.2" xref="S3.E5.m1.6.7.4.2.cmml"><munder id="S3.E5.m1.6.7.4.2.1" xref="S3.E5.m1.6.7.4.2.1.cmml"><mi id="S3.E5.m1.6.7.4.2.1.2" xref="S3.E5.m1.6.7.4.2.1.2.cmml">min</mi><msub id="S3.E5.m1.6.7.4.2.1.3" xref="S3.E5.m1.6.7.4.2.1.3.cmml"><mi id="S3.E5.m1.6.7.4.2.1.3.2" xref="S3.E5.m1.6.7.4.2.1.3.2.cmml">θ</mi><mi id="S3.E5.m1.6.7.4.2.1.3.3" xref="S3.E5.m1.6.7.4.2.1.3.3.cmml">C</mi></msub></munder><mo lspace="0.167em" id="S3.E5.m1.6.7.4.2a" xref="S3.E5.m1.6.7.4.2.cmml">⁡</mo><msub id="S3.E5.m1.6.7.4.2.2" xref="S3.E5.m1.6.7.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.6.7.4.2.2.2" xref="S3.E5.m1.6.7.4.2.2.2.cmml">ℒ</mi><mrow id="S3.E5.m1.6.7.4.2.2.3" xref="S3.E5.m1.6.7.4.2.2.3a.cmml"></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.7.4.1" xref="S3.E5.m1.6.7.4.1.cmml">​</mo><mrow id="S3.E5.m1.6.7.4.3.2" xref="S3.E5.m1.6.7.4.cmml"><mo stretchy="false" id="S3.E5.m1.6.7.4.3.2.1" xref="S3.E5.m1.6.7.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml">𝒮</mi><mo stretchy="false" id="S3.E5.m1.6.7.4.3.2.2" xref="S3.E5.m1.6.7.4.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.6.7.5" xref="S3.E5.m1.6.7.5.cmml">≥</mo><mrow id="S3.E5.m1.6.7.6" xref="S3.E5.m1.6.7.6.cmml"><mrow id="S3.E5.m1.6.7.6.2" xref="S3.E5.m1.6.7.6.2.cmml"><munder id="S3.E5.m1.6.7.6.2.1" xref="S3.E5.m1.6.7.6.2.1.cmml"><mi id="S3.E5.m1.6.7.6.2.1.2" xref="S3.E5.m1.6.7.6.2.1.2.cmml">min</mi><mrow id="S3.E5.m1.3.3.3.3" xref="S3.E5.m1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.3.3.3" xref="S3.E5.m1.3.3.3.4.cmml">(</mo><msub id="S3.E5.m1.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.1.cmml"><mi id="S3.E5.m1.2.2.2.2.1.2" xref="S3.E5.m1.2.2.2.2.1.2.cmml">θ</mi><mn id="S3.E5.m1.2.2.2.2.1.3" xref="S3.E5.m1.2.2.2.2.1.3.cmml">1</mn></msub><mo id="S3.E5.m1.3.3.3.3.4" xref="S3.E5.m1.3.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">…</mi><mo id="S3.E5.m1.3.3.3.3.5" xref="S3.E5.m1.3.3.3.4.cmml">,</mo><msub id="S3.E5.m1.3.3.3.3.2" xref="S3.E5.m1.3.3.3.3.2.cmml"><mi id="S3.E5.m1.3.3.3.3.2.2" xref="S3.E5.m1.3.3.3.3.2.2.cmml">θ</mi><mi id="S3.E5.m1.3.3.3.3.2.3" xref="S3.E5.m1.3.3.3.3.2.3.cmml">M</mi></msub><mo stretchy="false" id="S3.E5.m1.3.3.3.3.6" xref="S3.E5.m1.3.3.3.4.cmml">)</mo></mrow></munder><mo lspace="0.167em" id="S3.E5.m1.6.7.6.2a" xref="S3.E5.m1.6.7.6.2.cmml">⁡</mo><msub id="S3.E5.m1.6.7.6.2.2" xref="S3.E5.m1.6.7.6.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.6.7.6.2.2.2" xref="S3.E5.m1.6.7.6.2.2.2.cmml">ℒ</mi><mrow id="S3.E5.m1.6.7.6.2.2.3" xref="S3.E5.m1.6.7.6.2.2.3a.cmml"></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.7.6.1" xref="S3.E5.m1.6.7.6.1.cmml">​</mo><mrow id="S3.E5.m1.6.7.6.3.2" xref="S3.E5.m1.6.7.6.cmml"><mo stretchy="false" id="S3.E5.m1.6.7.6.3.2.1" xref="S3.E5.m1.6.7.6.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.6.6" xref="S3.E5.m1.6.6.cmml">𝒮</mi><mo stretchy="false" id="S3.E5.m1.6.7.6.3.2.2" xref="S3.E5.m1.6.7.6.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.6b"><apply id="S3.E5.m1.6.7.cmml" xref="S3.E5.m1.6.7"><and id="S3.E5.m1.6.7a.cmml" xref="S3.E5.m1.6.7"></and><apply id="S3.E5.m1.6.7b.cmml" xref="S3.E5.m1.6.7"><geq id="S3.E5.m1.6.7.3.cmml" xref="S3.E5.m1.6.7.3"></geq><apply id="S3.E5.m1.6.7.2.cmml" xref="S3.E5.m1.6.7.2"><times id="S3.E5.m1.6.7.2.1.cmml" xref="S3.E5.m1.6.7.2.1"></times><apply id="S3.E5.m1.6.7.2.2.cmml" xref="S3.E5.m1.6.7.2.2"><apply id="S3.E5.m1.6.7.2.2.1.cmml" xref="S3.E5.m1.6.7.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.7.2.2.1.1.cmml" xref="S3.E5.m1.6.7.2.2.1">subscript</csymbol><min id="S3.E5.m1.6.7.2.2.1.2.cmml" xref="S3.E5.m1.6.7.2.2.1.2"></min><apply id="S3.E5.m1.6.7.2.2.1.3.cmml" xref="S3.E5.m1.6.7.2.2.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.7.2.2.1.3.1.cmml" xref="S3.E5.m1.6.7.2.2.1.3">subscript</csymbol><ci id="S3.E5.m1.6.7.2.2.1.3.2.cmml" xref="S3.E5.m1.6.7.2.2.1.3.2">𝜃</ci><apply id="S3.E5.m1.6.7.2.2.1.3.3.cmml" xref="S3.E5.m1.6.7.2.2.1.3.3"><times id="S3.E5.m1.6.7.2.2.1.3.3.1.cmml" xref="S3.E5.m1.6.7.2.2.1.3.3.1"></times><ci id="S3.E5.m1.6.7.2.2.1.3.3.2.cmml" xref="S3.E5.m1.6.7.2.2.1.3.3.2">𝑔</ci><ci id="S3.E5.m1.6.7.2.2.1.3.3.3.cmml" xref="S3.E5.m1.6.7.2.2.1.3.3.3">𝑙</ci><ci id="S3.E5.m1.6.7.2.2.1.3.3.4.cmml" xref="S3.E5.m1.6.7.2.2.1.3.3.4">𝑜</ci><ci id="S3.E5.m1.6.7.2.2.1.3.3.5.cmml" xref="S3.E5.m1.6.7.2.2.1.3.3.5">𝑏</ci><ci id="S3.E5.m1.6.7.2.2.1.3.3.6.cmml" xref="S3.E5.m1.6.7.2.2.1.3.3.6">𝑎</ci><ci id="S3.E5.m1.6.7.2.2.1.3.3.7.cmml" xref="S3.E5.m1.6.7.2.2.1.3.3.7">𝑙</ci></apply></apply></apply><apply id="S3.E5.m1.6.7.2.2.2.cmml" xref="S3.E5.m1.6.7.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.7.2.2.2.1.cmml" xref="S3.E5.m1.6.7.2.2.2">subscript</csymbol><ci id="S3.E5.m1.6.7.2.2.2.2.cmml" xref="S3.E5.m1.6.7.2.2.2.2">ℒ</ci><ci id="S3.E5.m1.6.7.2.2.2.3a.cmml" xref="S3.E5.m1.6.7.2.2.2.3"><mrow id="S3.E5.m1.6.7.2.2.2.3.cmml" xref="S3.E5.m1.6.7.2.2.2.3"></mrow></ci></apply></apply><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝒮</ci></apply><apply id="S3.E5.m1.6.7.4.cmml" xref="S3.E5.m1.6.7.4"><times id="S3.E5.m1.6.7.4.1.cmml" xref="S3.E5.m1.6.7.4.1"></times><apply id="S3.E5.m1.6.7.4.2.cmml" xref="S3.E5.m1.6.7.4.2"><apply id="S3.E5.m1.6.7.4.2.1.cmml" xref="S3.E5.m1.6.7.4.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.7.4.2.1.1.cmml" xref="S3.E5.m1.6.7.4.2.1">subscript</csymbol><min id="S3.E5.m1.6.7.4.2.1.2.cmml" xref="S3.E5.m1.6.7.4.2.1.2"></min><apply id="S3.E5.m1.6.7.4.2.1.3.cmml" xref="S3.E5.m1.6.7.4.2.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.7.4.2.1.3.1.cmml" xref="S3.E5.m1.6.7.4.2.1.3">subscript</csymbol><ci id="S3.E5.m1.6.7.4.2.1.3.2.cmml" xref="S3.E5.m1.6.7.4.2.1.3.2">𝜃</ci><ci id="S3.E5.m1.6.7.4.2.1.3.3.cmml" xref="S3.E5.m1.6.7.4.2.1.3.3">𝐶</ci></apply></apply><apply id="S3.E5.m1.6.7.4.2.2.cmml" xref="S3.E5.m1.6.7.4.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.7.4.2.2.1.cmml" xref="S3.E5.m1.6.7.4.2.2">subscript</csymbol><ci id="S3.E5.m1.6.7.4.2.2.2.cmml" xref="S3.E5.m1.6.7.4.2.2.2">ℒ</ci><ci id="S3.E5.m1.6.7.4.2.2.3a.cmml" xref="S3.E5.m1.6.7.4.2.2.3"><mrow id="S3.E5.m1.6.7.4.2.2.3.cmml" xref="S3.E5.m1.6.7.4.2.2.3"></mrow></ci></apply></apply><ci id="S3.E5.m1.5.5.cmml" xref="S3.E5.m1.5.5">𝒮</ci></apply></apply><apply id="S3.E5.m1.6.7c.cmml" xref="S3.E5.m1.6.7"><geq id="S3.E5.m1.6.7.5.cmml" xref="S3.E5.m1.6.7.5"></geq><share href="#S3.E5.m1.6.7.4.cmml" id="S3.E5.m1.6.7d.cmml" xref="S3.E5.m1.6.7"></share><apply id="S3.E5.m1.6.7.6.cmml" xref="S3.E5.m1.6.7.6"><times id="S3.E5.m1.6.7.6.1.cmml" xref="S3.E5.m1.6.7.6.1"></times><apply id="S3.E5.m1.6.7.6.2.cmml" xref="S3.E5.m1.6.7.6.2"><apply id="S3.E5.m1.6.7.6.2.1.cmml" xref="S3.E5.m1.6.7.6.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.7.6.2.1.1.cmml" xref="S3.E5.m1.6.7.6.2.1">subscript</csymbol><min id="S3.E5.m1.6.7.6.2.1.2.cmml" xref="S3.E5.m1.6.7.6.2.1.2"></min><vector id="S3.E5.m1.3.3.3.4.cmml" xref="S3.E5.m1.3.3.3.3"><apply id="S3.E5.m1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.2">𝜃</ci><cn type="integer" id="S3.E5.m1.2.2.2.2.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.3">1</cn></apply><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">…</ci><apply id="S3.E5.m1.3.3.3.3.2.cmml" xref="S3.E5.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.2.1.cmml" xref="S3.E5.m1.3.3.3.3.2">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.2.2.cmml" xref="S3.E5.m1.3.3.3.3.2.2">𝜃</ci><ci id="S3.E5.m1.3.3.3.3.2.3.cmml" xref="S3.E5.m1.3.3.3.3.2.3">𝑀</ci></apply></vector></apply><apply id="S3.E5.m1.6.7.6.2.2.cmml" xref="S3.E5.m1.6.7.6.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.7.6.2.2.1.cmml" xref="S3.E5.m1.6.7.6.2.2">subscript</csymbol><ci id="S3.E5.m1.6.7.6.2.2.2.cmml" xref="S3.E5.m1.6.7.6.2.2.2">ℒ</ci><ci id="S3.E5.m1.6.7.6.2.2.3a.cmml" xref="S3.E5.m1.6.7.6.2.2.3"><mrow id="S3.E5.m1.6.7.6.2.2.3.cmml" xref="S3.E5.m1.6.7.6.2.2.3"></mrow></ci></apply></apply><ci id="S3.E5.m1.6.6.cmml" xref="S3.E5.m1.6.6">𝒮</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.6c">\min_{\theta_{global}}\mathcal{L}_{\text{}}(\mathcal{S})\geq\min_{\theta_{C}}\mathcal{L}_{\text{}}(\mathcal{S})\geq\min_{(\theta_{1},...,\theta_{M})}\mathcal{L}_{\text{}}(\mathcal{S})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.4" class="ltx_p">While <a href="#S3.E5" title="5 ‣ 3.1 Definitions ‣ 3 Method ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Equation 5</span></a> introduces the idea of each client learning its own model to reduce the loss on its distribution, the amount of data available for training is reduced. As theoretical works in deep learning show, the generalization error of models grows if the number of training samples shrinks. This can also be observed in practice and is reflected by the overfitting phenomenon.
To maintain a good generalization performance, we propose to train on all of the mentioned levels, gathering information about as many training samples as possible while reducing the problem complexity each model has to solve step by step. We start an initial training overall clients to find a global model <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\theta_{global}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">θ</mi><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.3.1a" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.1.3.4" xref="S3.SS1.p3.1.m1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.3.1b" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.1.3.5" xref="S3.SS1.p3.1.m1.1.1.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.3.1c" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.1.3.6" xref="S3.SS1.p3.1.m1.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.3.1d" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.1.3.7" xref="S3.SS1.p3.1.m1.1.1.3.7.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝜃</ci><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><times id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1"></times><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">𝑔</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">𝑙</ci><ci id="S3.SS1.p3.1.m1.1.1.3.4.cmml" xref="S3.SS1.p3.1.m1.1.1.3.4">𝑜</ci><ci id="S3.SS1.p3.1.m1.1.1.3.5.cmml" xref="S3.SS1.p3.1.m1.1.1.3.5">𝑏</ci><ci id="S3.SS1.p3.1.m1.1.1.3.6.cmml" xref="S3.SS1.p3.1.m1.1.1.3.6">𝑎</ci><ci id="S3.SS1.p3.1.m1.1.1.3.7.cmml" xref="S3.SS1.p3.1.m1.1.1.3.7">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\theta_{global}</annotation></semantics></math> which should learn basic features of the whole distribution. In the next step, we cluster the clients and begin with the training inside the clusters. The resulting cluster models <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\theta_{C}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">θ</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝜃</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\theta_{C}</annotation></semantics></math> are then personalized in the final step by performing local training on each client <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">i</annotation></semantics></math>, leading to the final personalized model <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><msub id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml">θ</mi><mi id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2">𝜃</ci><ci id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\theta_{i}</annotation></semantics></math> for each client. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a> visualizes the whole pipeline.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Federated Averaging</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.3" class="ltx_p">In the following, we analyze the federated averaging (FedAvg) algorithm in more detail. If we have <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">M</annotation></semantics></math> clients and <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="N_{i}=|\mathcal{D}_{i}|" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">N</mi><mi id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">i</mi></msub><mo id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">=</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.2.1.cmml">|</mo><msub id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p1.2.m2.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><eq id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"></eq><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">𝑁</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">𝑖</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"><abs id="S3.SS2.p1.2.m2.1.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2"></abs><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2">𝒟</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">N_{i}=|\mathcal{D}_{i}|</annotation></semantics></math> is the number of data samples of client <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">i</annotation></semantics></math>, the global and local loss functions take the following form</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.7" class="ltx_Math" alttext="f(\theta)=\sum_{i=1}^{M}\frac{N_{i}}{N}F_{i}({\theta})\quad\textrm{where}\quad F_{i}(\theta)=\frac{1}{N_{i}}\sum_{j}f_{j}(\theta)" display="block"><semantics id="S3.E6.m1.7a"><mrow id="S3.E6.m1.7.7.2" xref="S3.E6.m1.7.7.3.cmml"><mrow id="S3.E6.m1.6.6.1.1" xref="S3.E6.m1.6.6.1.1.cmml"><mrow id="S3.E6.m1.6.6.1.1.3" xref="S3.E6.m1.6.6.1.1.3.cmml"><mi id="S3.E6.m1.6.6.1.1.3.2" xref="S3.E6.m1.6.6.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.1.1.3.1" xref="S3.E6.m1.6.6.1.1.3.1.cmml">​</mo><mrow id="S3.E6.m1.6.6.1.1.3.3.2" xref="S3.E6.m1.6.6.1.1.3.cmml"><mo stretchy="false" id="S3.E6.m1.6.6.1.1.3.3.2.1" xref="S3.E6.m1.6.6.1.1.3.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E6.m1.6.6.1.1.3.3.2.2" xref="S3.E6.m1.6.6.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E6.m1.6.6.1.1.2" xref="S3.E6.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.6.6.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.2.cmml"><mrow id="S3.E6.m1.6.6.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.1.cmml"><munderover id="S3.E6.m1.6.6.1.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.1.1.cmml"><mo movablelimits="false" id="S3.E6.m1.6.6.1.1.1.1.1.1.2.2" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E6.m1.6.6.1.1.1.1.1.1.2.3" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.2" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.1" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.3" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.6.6.1.1.1.1.1.1.3" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.cmml">M</mi></munderover><mrow id="S3.E6.m1.6.6.1.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.1.1.1.2.cmml"><mfrac id="S3.E6.m1.6.6.1.1.1.1.1.2.2" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2.cmml"><msub id="S3.E6.m1.6.6.1.1.1.1.1.2.2.2" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E6.m1.6.6.1.1.1.1.1.2.2.2.2" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2.2.2.cmml">N</mi><mi id="S3.E6.m1.6.6.1.1.1.1.1.2.2.2.3" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mi id="S3.E6.m1.6.6.1.1.1.1.1.2.2.3" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.1.1.1.1.1.2.1" xref="S3.E6.m1.6.6.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E6.m1.6.6.1.1.1.1.1.2.3" xref="S3.E6.m1.6.6.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.6.6.1.1.1.1.1.2.3.2" xref="S3.E6.m1.6.6.1.1.1.1.1.2.3.2.cmml">F</mi><mi id="S3.E6.m1.6.6.1.1.1.1.1.2.3.3" xref="S3.E6.m1.6.6.1.1.1.1.1.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.1.1.1.1.1.2.1a" xref="S3.E6.m1.6.6.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S3.E6.m1.6.6.1.1.1.1.1.2.4.2" xref="S3.E6.m1.6.6.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.6.6.1.1.1.1.1.2.4.2.1" xref="S3.E6.m1.6.6.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S3.E6.m1.6.6.1.1.1.1.1.2.4.2.2" xref="S3.E6.m1.6.6.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mspace width="1em" id="S3.E6.m1.6.6.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.1.2.cmml"></mspace><mtext id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5a.cmml">where</mtext></mrow></mrow><mspace width="1em" id="S3.E6.m1.7.7.2.3" xref="S3.E6.m1.7.7.3a.cmml"></mspace><mrow id="S3.E6.m1.7.7.2.2" xref="S3.E6.m1.7.7.2.2.cmml"><mrow id="S3.E6.m1.7.7.2.2.2" xref="S3.E6.m1.7.7.2.2.2.cmml"><msub id="S3.E6.m1.7.7.2.2.2.2" xref="S3.E6.m1.7.7.2.2.2.2.cmml"><mi id="S3.E6.m1.7.7.2.2.2.2.2" xref="S3.E6.m1.7.7.2.2.2.2.2.cmml">F</mi><mi id="S3.E6.m1.7.7.2.2.2.2.3" xref="S3.E6.m1.7.7.2.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.2.2.2.1" xref="S3.E6.m1.7.7.2.2.2.1.cmml">​</mo><mrow id="S3.E6.m1.7.7.2.2.2.3.2" xref="S3.E6.m1.7.7.2.2.2.cmml"><mo stretchy="false" id="S3.E6.m1.7.7.2.2.2.3.2.1" xref="S3.E6.m1.7.7.2.2.2.cmml">(</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S3.E6.m1.7.7.2.2.2.3.2.2" xref="S3.E6.m1.7.7.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.7.7.2.2.1" xref="S3.E6.m1.7.7.2.2.1.cmml">=</mo><mrow id="S3.E6.m1.7.7.2.2.3" xref="S3.E6.m1.7.7.2.2.3.cmml"><mfrac id="S3.E6.m1.7.7.2.2.3.2" xref="S3.E6.m1.7.7.2.2.3.2.cmml"><mn id="S3.E6.m1.7.7.2.2.3.2.2" xref="S3.E6.m1.7.7.2.2.3.2.2.cmml">1</mn><msub id="S3.E6.m1.7.7.2.2.3.2.3" xref="S3.E6.m1.7.7.2.2.3.2.3.cmml"><mi id="S3.E6.m1.7.7.2.2.3.2.3.2" xref="S3.E6.m1.7.7.2.2.3.2.3.2.cmml">N</mi><mi id="S3.E6.m1.7.7.2.2.3.2.3.3" xref="S3.E6.m1.7.7.2.2.3.2.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.2.2.3.1" xref="S3.E6.m1.7.7.2.2.3.1.cmml">​</mo><mrow id="S3.E6.m1.7.7.2.2.3.3" xref="S3.E6.m1.7.7.2.2.3.3.cmml"><munder id="S3.E6.m1.7.7.2.2.3.3.1" xref="S3.E6.m1.7.7.2.2.3.3.1.cmml"><mo movablelimits="false" id="S3.E6.m1.7.7.2.2.3.3.1.2" xref="S3.E6.m1.7.7.2.2.3.3.1.2.cmml">∑</mo><mi id="S3.E6.m1.7.7.2.2.3.3.1.3" xref="S3.E6.m1.7.7.2.2.3.3.1.3.cmml">j</mi></munder><mrow id="S3.E6.m1.7.7.2.2.3.3.2" xref="S3.E6.m1.7.7.2.2.3.3.2.cmml"><msub id="S3.E6.m1.7.7.2.2.3.3.2.2" xref="S3.E6.m1.7.7.2.2.3.3.2.2.cmml"><mi id="S3.E6.m1.7.7.2.2.3.3.2.2.2" xref="S3.E6.m1.7.7.2.2.3.3.2.2.2.cmml">f</mi><mi id="S3.E6.m1.7.7.2.2.3.3.2.2.3" xref="S3.E6.m1.7.7.2.2.3.3.2.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.7.7.2.2.3.3.2.1" xref="S3.E6.m1.7.7.2.2.3.3.2.1.cmml">​</mo><mrow id="S3.E6.m1.7.7.2.2.3.3.2.3.2" xref="S3.E6.m1.7.7.2.2.3.3.2.cmml"><mo stretchy="false" id="S3.E6.m1.7.7.2.2.3.3.2.3.2.1" xref="S3.E6.m1.7.7.2.2.3.3.2.cmml">(</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">θ</mi><mo stretchy="false" id="S3.E6.m1.7.7.2.2.3.3.2.3.2.2" xref="S3.E6.m1.7.7.2.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.7b"><apply id="S3.E6.m1.7.7.3.cmml" xref="S3.E6.m1.7.7.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.3a.cmml" xref="S3.E6.m1.7.7.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.6.6.1.1.cmml" xref="S3.E6.m1.6.6.1.1"><eq id="S3.E6.m1.6.6.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.2"></eq><apply id="S3.E6.m1.6.6.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.3"><times id="S3.E6.m1.6.6.1.1.3.1.cmml" xref="S3.E6.m1.6.6.1.1.3.1"></times><ci id="S3.E6.m1.6.6.1.1.3.2.cmml" xref="S3.E6.m1.6.6.1.1.3.2">𝑓</ci><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝜃</ci></apply><list id="S3.E6.m1.6.6.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1"><apply id="S3.E6.m1.6.6.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1"><apply id="S3.E6.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E6.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.2"></sum><apply id="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.3"><eq id="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S3.E6.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2"><times id="S3.E6.m1.6.6.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.1"></times><apply id="S3.E6.m1.6.6.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2"><divide id="S3.E6.m1.6.6.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2"></divide><apply id="S3.E6.m1.6.6.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2.2.2">𝑁</ci><ci id="S3.E6.m1.6.6.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.E6.m1.6.6.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.2.3">𝑁</ci></apply><apply id="S3.E6.m1.6.6.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.3.2">𝐹</ci><ci id="S3.E6.m1.6.6.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.2.3.3">𝑖</ci></apply><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝜃</ci></apply></apply><ci id="S3.E6.m1.5.5a.cmml" xref="S3.E6.m1.5.5"><mtext id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5">where</mtext></ci></list></apply><apply id="S3.E6.m1.7.7.2.2.cmml" xref="S3.E6.m1.7.7.2.2"><eq id="S3.E6.m1.7.7.2.2.1.cmml" xref="S3.E6.m1.7.7.2.2.1"></eq><apply id="S3.E6.m1.7.7.2.2.2.cmml" xref="S3.E6.m1.7.7.2.2.2"><times id="S3.E6.m1.7.7.2.2.2.1.cmml" xref="S3.E6.m1.7.7.2.2.2.1"></times><apply id="S3.E6.m1.7.7.2.2.2.2.cmml" xref="S3.E6.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.2.2.2.2.1.cmml" xref="S3.E6.m1.7.7.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.7.7.2.2.2.2.2.cmml" xref="S3.E6.m1.7.7.2.2.2.2.2">𝐹</ci><ci id="S3.E6.m1.7.7.2.2.2.2.3.cmml" xref="S3.E6.m1.7.7.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝜃</ci></apply><apply id="S3.E6.m1.7.7.2.2.3.cmml" xref="S3.E6.m1.7.7.2.2.3"><times id="S3.E6.m1.7.7.2.2.3.1.cmml" xref="S3.E6.m1.7.7.2.2.3.1"></times><apply id="S3.E6.m1.7.7.2.2.3.2.cmml" xref="S3.E6.m1.7.7.2.2.3.2"><divide id="S3.E6.m1.7.7.2.2.3.2.1.cmml" xref="S3.E6.m1.7.7.2.2.3.2"></divide><cn type="integer" id="S3.E6.m1.7.7.2.2.3.2.2.cmml" xref="S3.E6.m1.7.7.2.2.3.2.2">1</cn><apply id="S3.E6.m1.7.7.2.2.3.2.3.cmml" xref="S3.E6.m1.7.7.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.2.2.3.2.3.1.cmml" xref="S3.E6.m1.7.7.2.2.3.2.3">subscript</csymbol><ci id="S3.E6.m1.7.7.2.2.3.2.3.2.cmml" xref="S3.E6.m1.7.7.2.2.3.2.3.2">𝑁</ci><ci id="S3.E6.m1.7.7.2.2.3.2.3.3.cmml" xref="S3.E6.m1.7.7.2.2.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.7.7.2.2.3.3.cmml" xref="S3.E6.m1.7.7.2.2.3.3"><apply id="S3.E6.m1.7.7.2.2.3.3.1.cmml" xref="S3.E6.m1.7.7.2.2.3.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.2.2.3.3.1.1.cmml" xref="S3.E6.m1.7.7.2.2.3.3.1">subscript</csymbol><sum id="S3.E6.m1.7.7.2.2.3.3.1.2.cmml" xref="S3.E6.m1.7.7.2.2.3.3.1.2"></sum><ci id="S3.E6.m1.7.7.2.2.3.3.1.3.cmml" xref="S3.E6.m1.7.7.2.2.3.3.1.3">𝑗</ci></apply><apply id="S3.E6.m1.7.7.2.2.3.3.2.cmml" xref="S3.E6.m1.7.7.2.2.3.3.2"><times id="S3.E6.m1.7.7.2.2.3.3.2.1.cmml" xref="S3.E6.m1.7.7.2.2.3.3.2.1"></times><apply id="S3.E6.m1.7.7.2.2.3.3.2.2.cmml" xref="S3.E6.m1.7.7.2.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.2.2.3.3.2.2.1.cmml" xref="S3.E6.m1.7.7.2.2.3.3.2.2">subscript</csymbol><ci id="S3.E6.m1.7.7.2.2.3.3.2.2.2.cmml" xref="S3.E6.m1.7.7.2.2.3.3.2.2.2">𝑓</ci><ci id="S3.E6.m1.7.7.2.2.3.3.2.2.3.cmml" xref="S3.E6.m1.7.7.2.2.3.3.2.2.3">𝑗</ci></apply><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝜃</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.7c">f(\theta)=\sum_{i=1}^{M}\frac{N_{i}}{N}F_{i}({\theta})\quad\textrm{where}\quad F_{i}(\theta)=\frac{1}{N_{i}}\sum_{j}f_{j}(\theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.7" class="ltx_p">where, <math id="S3.SS2.p1.4.m1.1" class="ltx_Math" alttext="F_{i}(\theta)" display="inline"><semantics id="S3.SS2.p1.4.m1.1a"><mrow id="S3.SS2.p1.4.m1.1.2" xref="S3.SS2.p1.4.m1.1.2.cmml"><msub id="S3.SS2.p1.4.m1.1.2.2" xref="S3.SS2.p1.4.m1.1.2.2.cmml"><mi id="S3.SS2.p1.4.m1.1.2.2.2" xref="S3.SS2.p1.4.m1.1.2.2.2.cmml">F</mi><mi id="S3.SS2.p1.4.m1.1.2.2.3" xref="S3.SS2.p1.4.m1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m1.1.2.1" xref="S3.SS2.p1.4.m1.1.2.1.cmml">​</mo><mrow id="S3.SS2.p1.4.m1.1.2.3.2" xref="S3.SS2.p1.4.m1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m1.1.2.3.2.1" xref="S3.SS2.p1.4.m1.1.2.cmml">(</mo><mi id="S3.SS2.p1.4.m1.1.1" xref="S3.SS2.p1.4.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS2.p1.4.m1.1.2.3.2.2" xref="S3.SS2.p1.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m1.1b"><apply id="S3.SS2.p1.4.m1.1.2.cmml" xref="S3.SS2.p1.4.m1.1.2"><times id="S3.SS2.p1.4.m1.1.2.1.cmml" xref="S3.SS2.p1.4.m1.1.2.1"></times><apply id="S3.SS2.p1.4.m1.1.2.2.cmml" xref="S3.SS2.p1.4.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m1.1.2.2.1.cmml" xref="S3.SS2.p1.4.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.4.m1.1.2.2.2.cmml" xref="S3.SS2.p1.4.m1.1.2.2.2">𝐹</ci><ci id="S3.SS2.p1.4.m1.1.2.2.3.cmml" xref="S3.SS2.p1.4.m1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.4.m1.1.1.cmml" xref="S3.SS2.p1.4.m1.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m1.1c">F_{i}(\theta)</annotation></semantics></math> is the local objective of each client and <math id="S3.SS2.p1.5.m2.1" class="ltx_Math" alttext="f(\theta)" display="inline"><semantics id="S3.SS2.p1.5.m2.1a"><mrow id="S3.SS2.p1.5.m2.1.2" xref="S3.SS2.p1.5.m2.1.2.cmml"><mi id="S3.SS2.p1.5.m2.1.2.2" xref="S3.SS2.p1.5.m2.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m2.1.2.1" xref="S3.SS2.p1.5.m2.1.2.1.cmml">​</mo><mrow id="S3.SS2.p1.5.m2.1.2.3.2" xref="S3.SS2.p1.5.m2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m2.1.2.3.2.1" xref="S3.SS2.p1.5.m2.1.2.cmml">(</mo><mi id="S3.SS2.p1.5.m2.1.1" xref="S3.SS2.p1.5.m2.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS2.p1.5.m2.1.2.3.2.2" xref="S3.SS2.p1.5.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m2.1b"><apply id="S3.SS2.p1.5.m2.1.2.cmml" xref="S3.SS2.p1.5.m2.1.2"><times id="S3.SS2.p1.5.m2.1.2.1.cmml" xref="S3.SS2.p1.5.m2.1.2.1"></times><ci id="S3.SS2.p1.5.m2.1.2.2.cmml" xref="S3.SS2.p1.5.m2.1.2.2">𝑓</ci><ci id="S3.SS2.p1.5.m2.1.1.cmml" xref="S3.SS2.p1.5.m2.1.1">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m2.1c">f(\theta)</annotation></semantics></math> is the global objective averaged over all clients.
Training with FedAvg consists of two main updating schemes.
Firstly, the clients are training locally with an initially distributed model on their local data for a predefined amount of epochs <math id="S3.SS2.p1.6.m3.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS2.p1.6.m3.1a"><mi id="S3.SS2.p1.6.m3.1.1" xref="S3.SS2.p1.6.m3.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m3.1b"><ci id="S3.SS2.p1.6.m3.1.1.cmml" xref="S3.SS2.p1.6.m3.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m3.1c">e</annotation></semantics></math>. For each communication round a client updates its model parameter <math id="S3.SS2.p1.7.m4.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS2.p1.7.m4.1a"><msub id="S3.SS2.p1.7.m4.1.1" xref="S3.SS2.p1.7.m4.1.1.cmml"><mi id="S3.SS2.p1.7.m4.1.1.2" xref="S3.SS2.p1.7.m4.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.7.m4.1.1.3" xref="S3.SS2.p1.7.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m4.1b"><apply id="S3.SS2.p1.7.m4.1.1.cmml" xref="S3.SS2.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m4.1.1.1.cmml" xref="S3.SS2.p1.7.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m4.1.1.2.cmml" xref="S3.SS2.p1.7.m4.1.1.2">𝜃</ci><ci id="S3.SS2.p1.7.m4.1.1.3.cmml" xref="S3.SS2.p1.7.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m4.1c">\theta_{i}</annotation></semantics></math> as follows,</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.2" class="ltx_Math" alttext="\forall i,\ \theta_{i}^{t+1}\leftarrow\theta_{i}^{t}-\eta\cdot\Delta\theta" display="block"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml"><mrow id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.3.cmml"><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml">∀</mo><mi id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">i</mi></mrow><mo rspace="0.667em" id="S3.E7.m1.2.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml">,</mo><msubsup id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.2.cmml">θ</mi><mi id="S3.E7.m1.2.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.E7.m1.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.3.cmml"><mi id="S3.E7.m1.2.2.2.2.2.3.2" xref="S3.E7.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E7.m1.2.2.2.2.2.3.1" xref="S3.E7.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="S3.E7.m1.2.2.2.2.2.3.3" xref="S3.E7.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow><mo stretchy="false" id="S3.E7.m1.2.2.3" xref="S3.E7.m1.2.2.3.cmml">←</mo><mrow id="S3.E7.m1.2.2.4" xref="S3.E7.m1.2.2.4.cmml"><msubsup id="S3.E7.m1.2.2.4.2" xref="S3.E7.m1.2.2.4.2.cmml"><mi id="S3.E7.m1.2.2.4.2.2.2" xref="S3.E7.m1.2.2.4.2.2.2.cmml">θ</mi><mi id="S3.E7.m1.2.2.4.2.2.3" xref="S3.E7.m1.2.2.4.2.2.3.cmml">i</mi><mi id="S3.E7.m1.2.2.4.2.3" xref="S3.E7.m1.2.2.4.2.3.cmml">t</mi></msubsup><mo id="S3.E7.m1.2.2.4.1" xref="S3.E7.m1.2.2.4.1.cmml">−</mo><mrow id="S3.E7.m1.2.2.4.3" xref="S3.E7.m1.2.2.4.3.cmml"><mrow id="S3.E7.m1.2.2.4.3.2" xref="S3.E7.m1.2.2.4.3.2.cmml"><mi id="S3.E7.m1.2.2.4.3.2.2" xref="S3.E7.m1.2.2.4.3.2.2.cmml">η</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E7.m1.2.2.4.3.2.1" xref="S3.E7.m1.2.2.4.3.2.1.cmml">⋅</mo><mi mathvariant="normal" id="S3.E7.m1.2.2.4.3.2.3" xref="S3.E7.m1.2.2.4.3.2.3.cmml">Δ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.4.3.1" xref="S3.E7.m1.2.2.4.3.1.cmml">​</mo><mi id="S3.E7.m1.2.2.4.3.3" xref="S3.E7.m1.2.2.4.3.3.cmml">θ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"><ci id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2.3">←</ci><list id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2"><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">for-all</csymbol><ci id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2">𝑖</ci></apply><apply id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.E7.m1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2">𝜃</ci><ci id="S3.E7.m1.2.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.E7.m1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3"><plus id="S3.E7.m1.2.2.2.2.2.3.1.cmml" xref="S3.E7.m1.2.2.2.2.2.3.1"></plus><ci id="S3.E7.m1.2.2.2.2.2.3.2.cmml" xref="S3.E7.m1.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S3.E7.m1.2.2.2.2.2.3.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3.3">1</cn></apply></apply></list><apply id="S3.E7.m1.2.2.4.cmml" xref="S3.E7.m1.2.2.4"><minus id="S3.E7.m1.2.2.4.1.cmml" xref="S3.E7.m1.2.2.4.1"></minus><apply id="S3.E7.m1.2.2.4.2.cmml" xref="S3.E7.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.4.2.1.cmml" xref="S3.E7.m1.2.2.4.2">superscript</csymbol><apply id="S3.E7.m1.2.2.4.2.2.cmml" xref="S3.E7.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.4.2.2.1.cmml" xref="S3.E7.m1.2.2.4.2">subscript</csymbol><ci id="S3.E7.m1.2.2.4.2.2.2.cmml" xref="S3.E7.m1.2.2.4.2.2.2">𝜃</ci><ci id="S3.E7.m1.2.2.4.2.2.3.cmml" xref="S3.E7.m1.2.2.4.2.2.3">𝑖</ci></apply><ci id="S3.E7.m1.2.2.4.2.3.cmml" xref="S3.E7.m1.2.2.4.2.3">𝑡</ci></apply><apply id="S3.E7.m1.2.2.4.3.cmml" xref="S3.E7.m1.2.2.4.3"><times id="S3.E7.m1.2.2.4.3.1.cmml" xref="S3.E7.m1.2.2.4.3.1"></times><apply id="S3.E7.m1.2.2.4.3.2.cmml" xref="S3.E7.m1.2.2.4.3.2"><ci id="S3.E7.m1.2.2.4.3.2.1.cmml" xref="S3.E7.m1.2.2.4.3.2.1">⋅</ci><ci id="S3.E7.m1.2.2.4.3.2.2.cmml" xref="S3.E7.m1.2.2.4.3.2.2">𝜂</ci><ci id="S3.E7.m1.2.2.4.3.2.3.cmml" xref="S3.E7.m1.2.2.4.3.2.3">Δ</ci></apply><ci id="S3.E7.m1.2.2.4.3.3.cmml" xref="S3.E7.m1.2.2.4.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">\forall i,\ \theta_{i}^{t+1}\leftarrow\theta_{i}^{t}-\eta\cdot\Delta\theta</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.9" class="ltx_p">In a second step, the server computes a weighted average based on the number of data points of each client <math id="S3.SS2.p1.8.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.8.m1.1a"><mi id="S3.SS2.p1.8.m1.1.1" xref="S3.SS2.p1.8.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m1.1b"><ci id="S3.SS2.p1.8.m1.1.1.cmml" xref="S3.SS2.p1.8.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m1.1c">i</annotation></semantics></math> of all locally updated model parameters <math id="S3.SS2.p1.9.m2.1" class="ltx_Math" alttext="\theta_{i}^{\prime}s" display="inline"><semantics id="S3.SS2.p1.9.m2.1a"><mrow id="S3.SS2.p1.9.m2.1.1" xref="S3.SS2.p1.9.m2.1.1.cmml"><msubsup id="S3.SS2.p1.9.m2.1.1.2" xref="S3.SS2.p1.9.m2.1.1.2.cmml"><mi id="S3.SS2.p1.9.m2.1.1.2.2.2" xref="S3.SS2.p1.9.m2.1.1.2.2.2.cmml">θ</mi><mi id="S3.SS2.p1.9.m2.1.1.2.2.3" xref="S3.SS2.p1.9.m2.1.1.2.2.3.cmml">i</mi><mo id="S3.SS2.p1.9.m2.1.1.2.3" xref="S3.SS2.p1.9.m2.1.1.2.3.cmml">′</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m2.1.1.1" xref="S3.SS2.p1.9.m2.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.9.m2.1.1.3" xref="S3.SS2.p1.9.m2.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m2.1b"><apply id="S3.SS2.p1.9.m2.1.1.cmml" xref="S3.SS2.p1.9.m2.1.1"><times id="S3.SS2.p1.9.m2.1.1.1.cmml" xref="S3.SS2.p1.9.m2.1.1.1"></times><apply id="S3.SS2.p1.9.m2.1.1.2.cmml" xref="S3.SS2.p1.9.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m2.1.1.2.1.cmml" xref="S3.SS2.p1.9.m2.1.1.2">superscript</csymbol><apply id="S3.SS2.p1.9.m2.1.1.2.2.cmml" xref="S3.SS2.p1.9.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m2.1.1.2.2.1.cmml" xref="S3.SS2.p1.9.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.9.m2.1.1.2.2.2.cmml" xref="S3.SS2.p1.9.m2.1.1.2.2.2">𝜃</ci><ci id="S3.SS2.p1.9.m2.1.1.2.2.3.cmml" xref="S3.SS2.p1.9.m2.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.9.m2.1.1.2.3.cmml" xref="S3.SS2.p1.9.m2.1.1.2.3">′</ci></apply><ci id="S3.SS2.p1.9.m2.1.1.3.cmml" xref="S3.SS2.p1.9.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m2.1c">\theta_{i}^{\prime}s</annotation></semantics></math>:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\theta_{global}^{t+1}\leftarrow\sum_{i=1}^{M}\frac{N_{i}}{N}\theta_{i}^{t+1}" display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><msubsup id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.2.2.2" xref="S3.E8.m1.1.1.2.2.2.cmml">θ</mi><mrow id="S3.E8.m1.1.1.2.2.3" xref="S3.E8.m1.1.1.2.2.3.cmml"><mi id="S3.E8.m1.1.1.2.2.3.2" xref="S3.E8.m1.1.1.2.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.2.3.1" xref="S3.E8.m1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.2.2.3.3" xref="S3.E8.m1.1.1.2.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.2.3.1a" xref="S3.E8.m1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.2.2.3.4" xref="S3.E8.m1.1.1.2.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.2.3.1b" xref="S3.E8.m1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.2.2.3.5" xref="S3.E8.m1.1.1.2.2.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.2.3.1c" xref="S3.E8.m1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.2.2.3.6" xref="S3.E8.m1.1.1.2.2.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.2.3.1d" xref="S3.E8.m1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.2.2.3.7" xref="S3.E8.m1.1.1.2.2.3.7.cmml">l</mi></mrow><mrow id="S3.E8.m1.1.1.2.3" xref="S3.E8.m1.1.1.2.3.cmml"><mi id="S3.E8.m1.1.1.2.3.2" xref="S3.E8.m1.1.1.2.3.2.cmml">t</mi><mo id="S3.E8.m1.1.1.2.3.1" xref="S3.E8.m1.1.1.2.3.1.cmml">+</mo><mn id="S3.E8.m1.1.1.2.3.3" xref="S3.E8.m1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo rspace="0.111em" stretchy="false" id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml">←</mo><mrow id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><munderover id="S3.E8.m1.1.1.3.1" xref="S3.E8.m1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E8.m1.1.1.3.1.2.2" xref="S3.E8.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.1.1.3.1.2.3" xref="S3.E8.m1.1.1.3.1.2.3.cmml"><mi id="S3.E8.m1.1.1.3.1.2.3.2" xref="S3.E8.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E8.m1.1.1.3.1.2.3.1" xref="S3.E8.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E8.m1.1.1.3.1.2.3.3" xref="S3.E8.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.1.1.3.1.3" xref="S3.E8.m1.1.1.3.1.3.cmml">M</mi></munderover><mrow id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml"><mfrac id="S3.E8.m1.1.1.3.2.2" xref="S3.E8.m1.1.1.3.2.2.cmml"><msub id="S3.E8.m1.1.1.3.2.2.2" xref="S3.E8.m1.1.1.3.2.2.2.cmml"><mi id="S3.E8.m1.1.1.3.2.2.2.2" xref="S3.E8.m1.1.1.3.2.2.2.2.cmml">N</mi><mi id="S3.E8.m1.1.1.3.2.2.2.3" xref="S3.E8.m1.1.1.3.2.2.2.3.cmml">i</mi></msub><mi id="S3.E8.m1.1.1.3.2.2.3" xref="S3.E8.m1.1.1.3.2.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.2.1" xref="S3.E8.m1.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E8.m1.1.1.3.2.3" xref="S3.E8.m1.1.1.3.2.3.cmml"><mi id="S3.E8.m1.1.1.3.2.3.2.2" xref="S3.E8.m1.1.1.3.2.3.2.2.cmml">θ</mi><mi id="S3.E8.m1.1.1.3.2.3.2.3" xref="S3.E8.m1.1.1.3.2.3.2.3.cmml">i</mi><mrow id="S3.E8.m1.1.1.3.2.3.3" xref="S3.E8.m1.1.1.3.2.3.3.cmml"><mi id="S3.E8.m1.1.1.3.2.3.3.2" xref="S3.E8.m1.1.1.3.2.3.3.2.cmml">t</mi><mo id="S3.E8.m1.1.1.3.2.3.3.1" xref="S3.E8.m1.1.1.3.2.3.3.1.cmml">+</mo><mn id="S3.E8.m1.1.1.3.2.3.3.3" xref="S3.E8.m1.1.1.3.2.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><ci id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1">←</ci><apply id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.2">superscript</csymbol><apply id="S3.E8.m1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.2.1.cmml" xref="S3.E8.m1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.2.2.2.cmml" xref="S3.E8.m1.1.1.2.2.2">𝜃</ci><apply id="S3.E8.m1.1.1.2.2.3.cmml" xref="S3.E8.m1.1.1.2.2.3"><times id="S3.E8.m1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.1.1.2.2.3.1"></times><ci id="S3.E8.m1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.1.1.2.2.3.2">𝑔</ci><ci id="S3.E8.m1.1.1.2.2.3.3.cmml" xref="S3.E8.m1.1.1.2.2.3.3">𝑙</ci><ci id="S3.E8.m1.1.1.2.2.3.4.cmml" xref="S3.E8.m1.1.1.2.2.3.4">𝑜</ci><ci id="S3.E8.m1.1.1.2.2.3.5.cmml" xref="S3.E8.m1.1.1.2.2.3.5">𝑏</ci><ci id="S3.E8.m1.1.1.2.2.3.6.cmml" xref="S3.E8.m1.1.1.2.2.3.6">𝑎</ci><ci id="S3.E8.m1.1.1.2.2.3.7.cmml" xref="S3.E8.m1.1.1.2.2.3.7">𝑙</ci></apply></apply><apply id="S3.E8.m1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.2.3"><plus id="S3.E8.m1.1.1.2.3.1.cmml" xref="S3.E8.m1.1.1.2.3.1"></plus><ci id="S3.E8.m1.1.1.2.3.2.cmml" xref="S3.E8.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E8.m1.1.1.2.3.3.cmml" xref="S3.E8.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><apply id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.1.1.cmml" xref="S3.E8.m1.1.1.3.1">superscript</csymbol><apply id="S3.E8.m1.1.1.3.1.2.cmml" xref="S3.E8.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.1.2.1.cmml" xref="S3.E8.m1.1.1.3.1">subscript</csymbol><sum id="S3.E8.m1.1.1.3.1.2.2.cmml" xref="S3.E8.m1.1.1.3.1.2.2"></sum><apply id="S3.E8.m1.1.1.3.1.2.3.cmml" xref="S3.E8.m1.1.1.3.1.2.3"><eq id="S3.E8.m1.1.1.3.1.2.3.1.cmml" xref="S3.E8.m1.1.1.3.1.2.3.1"></eq><ci id="S3.E8.m1.1.1.3.1.2.3.2.cmml" xref="S3.E8.m1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E8.m1.1.1.3.1.2.3.3.cmml" xref="S3.E8.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.1.1.3.1.3.cmml" xref="S3.E8.m1.1.1.3.1.3">𝑀</ci></apply><apply id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3.2"><times id="S3.E8.m1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.3.2.1"></times><apply id="S3.E8.m1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.3.2.2"><divide id="S3.E8.m1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.1.1.3.2.2"></divide><apply id="S3.E8.m1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.2.2.2.1.cmml" xref="S3.E8.m1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.3.2.2.2.2.cmml" xref="S3.E8.m1.1.1.3.2.2.2.2">𝑁</ci><ci id="S3.E8.m1.1.1.3.2.2.2.3.cmml" xref="S3.E8.m1.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E8.m1.1.1.3.2.2.3.cmml" xref="S3.E8.m1.1.1.3.2.2.3">𝑁</ci></apply><apply id="S3.E8.m1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.2.3.1.cmml" xref="S3.E8.m1.1.1.3.2.3">superscript</csymbol><apply id="S3.E8.m1.1.1.3.2.3.2.cmml" xref="S3.E8.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.2.3.2.1.cmml" xref="S3.E8.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E8.m1.1.1.3.2.3.2.2.cmml" xref="S3.E8.m1.1.1.3.2.3.2.2">𝜃</ci><ci id="S3.E8.m1.1.1.3.2.3.2.3.cmml" xref="S3.E8.m1.1.1.3.2.3.2.3">𝑖</ci></apply><apply id="S3.E8.m1.1.1.3.2.3.3.cmml" xref="S3.E8.m1.1.1.3.2.3.3"><plus id="S3.E8.m1.1.1.3.2.3.3.1.cmml" xref="S3.E8.m1.1.1.3.2.3.3.1"></plus><ci id="S3.E8.m1.1.1.3.2.3.3.2.cmml" xref="S3.E8.m1.1.1.3.2.3.3.2">𝑡</ci><cn type="integer" id="S3.E8.m1.1.1.3.2.3.3.3.cmml" xref="S3.E8.m1.1.1.3.2.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\theta_{global}^{t+1}\leftarrow\sum_{i=1}^{M}\frac{N_{i}}{N}\theta_{i}^{t+1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Federated Adaptive Personalization</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.7" class="ltx_p">Our methodology (Federated Adaptive Personalization or FedAP) begins with the initialization of the global model parameters <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\theta_{global}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">θ</mi><mrow id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.3.1a" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.1.3.4" xref="S3.SS3.p1.1.m1.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.3.1b" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.1.3.5" xref="S3.SS3.p1.1.m1.1.1.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.3.1c" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.1.3.6" xref="S3.SS3.p1.1.m1.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.3.1d" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.1.3.7" xref="S3.SS3.p1.1.m1.1.1.3.7.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝜃</ci><apply id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><times id="S3.SS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2">𝑔</ci><ci id="S3.SS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3">𝑙</ci><ci id="S3.SS3.p1.1.m1.1.1.3.4.cmml" xref="S3.SS3.p1.1.m1.1.1.3.4">𝑜</ci><ci id="S3.SS3.p1.1.m1.1.1.3.5.cmml" xref="S3.SS3.p1.1.m1.1.1.3.5">𝑏</ci><ci id="S3.SS3.p1.1.m1.1.1.3.6.cmml" xref="S3.SS3.p1.1.m1.1.1.3.6">𝑎</ci><ci id="S3.SS3.p1.1.m1.1.1.3.7.cmml" xref="S3.SS3.p1.1.m1.1.1.3.7">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\theta_{global}</annotation></semantics></math>. At the start of each of <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">k</annotation></semantics></math> federated rounds, they are transferred to a batch of <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">n</annotation></semantics></math> randomly selected clients, and local training is performed, yielding updated local model parameters <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">θ</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝜃</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\theta_{i}</annotation></semantics></math> in each client <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">i</annotation></semantics></math>. Next, <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\theta</annotation></semantics></math> is updated using an adaptive meta learning rate <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">\eta</annotation></semantics></math> based on the current round number. The adaptive meta learning rate decreases linearly throughout the training.</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\theta_{global}\leftarrow\theta_{global}+\eta\sum_{i=1}^{n}\frac{N_{i}}{N}(\theta_{i}-\theta_{global})" display="block"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><msub id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.3.2" xref="S3.E9.m1.1.1.3.2.cmml">θ</mi><mrow id="S3.E9.m1.1.1.3.3" xref="S3.E9.m1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.3.3.2" xref="S3.E9.m1.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.3.3.1" xref="S3.E9.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.3.3.3" xref="S3.E9.m1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.3.3.1a" xref="S3.E9.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.3.3.4" xref="S3.E9.m1.1.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.3.3.1b" xref="S3.E9.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.3.3.5" xref="S3.E9.m1.1.1.3.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.3.3.1c" xref="S3.E9.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.3.3.6" xref="S3.E9.m1.1.1.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.3.3.1d" xref="S3.E9.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.3.3.7" xref="S3.E9.m1.1.1.3.3.7.cmml">l</mi></mrow></msub><mo stretchy="false" id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml">←</mo><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.3.2.cmml">θ</mi><mrow id="S3.E9.m1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.3.3.1" xref="S3.E9.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.3.3.1a" xref="S3.E9.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.3.3.4" xref="S3.E9.m1.1.1.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.3.3.1b" xref="S3.E9.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.3.3.5" xref="S3.E9.m1.1.1.1.3.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.3.3.1c" xref="S3.E9.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.3.3.6" xref="S3.E9.m1.1.1.1.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.3.3.1d" xref="S3.E9.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.3.3.7" xref="S3.E9.m1.1.1.1.3.3.7.cmml">l</mi></mrow></msub><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><munderover id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E9.m1.1.1.1.1.1.2.2.2" xref="S3.E9.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E9.m1.1.1.1.1.1.2.2.3" xref="S3.E9.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.2.2.3.2" xref="S3.E9.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E9.m1.1.1.1.1.1.2.2.3.1" xref="S3.E9.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E9.m1.1.1.1.1.1.2.2.3.3" xref="S3.E9.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.1.2.3.cmml">n</mi></munderover><mrow id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mfrac id="S3.E9.m1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.3.cmml"><msub id="S3.E9.m1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.1.1.3.2.2.cmml">N</mi><mi id="S3.E9.m1.1.1.1.1.1.1.3.2.3" xref="S3.E9.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mi id="S3.E9.m1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">θ</mi><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1a" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1b" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.5" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1c" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.6" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1d" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.7" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.7.cmml">l</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><ci id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2">←</ci><apply id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.3.2">𝜃</ci><apply id="S3.E9.m1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.3.3"><times id="S3.E9.m1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.3.3.1"></times><ci id="S3.E9.m1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.3.3.2">𝑔</ci><ci id="S3.E9.m1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.3.3.3">𝑙</ci><ci id="S3.E9.m1.1.1.3.3.4.cmml" xref="S3.E9.m1.1.1.3.3.4">𝑜</ci><ci id="S3.E9.m1.1.1.3.3.5.cmml" xref="S3.E9.m1.1.1.3.3.5">𝑏</ci><ci id="S3.E9.m1.1.1.3.3.6.cmml" xref="S3.E9.m1.1.1.3.3.6">𝑎</ci><ci id="S3.E9.m1.1.1.3.3.7.cmml" xref="S3.E9.m1.1.1.3.3.7">𝑙</ci></apply></apply><apply id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><plus id="S3.E9.m1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.2"></plus><apply id="S3.E9.m1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.3.2">𝜃</ci><apply id="S3.E9.m1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.3.3"><times id="S3.E9.m1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.3.3.1"></times><ci id="S3.E9.m1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.3.3.2">𝑔</ci><ci id="S3.E9.m1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.3.3.3">𝑙</ci><ci id="S3.E9.m1.1.1.1.3.3.4.cmml" xref="S3.E9.m1.1.1.1.3.3.4">𝑜</ci><ci id="S3.E9.m1.1.1.1.3.3.5.cmml" xref="S3.E9.m1.1.1.1.3.3.5">𝑏</ci><ci id="S3.E9.m1.1.1.1.3.3.6.cmml" xref="S3.E9.m1.1.1.1.3.3.6">𝑎</ci><ci id="S3.E9.m1.1.1.1.3.3.7.cmml" xref="S3.E9.m1.1.1.1.3.3.7">𝑙</ci></apply></apply><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2"></times><ci id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3">𝜂</ci><apply id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><apply id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E9.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E9.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.2.2.3"><eq id="S3.E9.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E9.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E9.m1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2"></times><apply id="S3.E9.m1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3"><divide id="S3.E9.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3"></divide><apply id="S3.E9.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.2.2">𝑁</ci><ci id="S3.E9.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E9.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1"><minus id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.2">𝜃</ci><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3"><times id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝑔</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑙</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.4">𝑜</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.5">𝑏</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.6.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.6">𝑎</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.7.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.3.7">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\theta_{global}\leftarrow\theta_{global}+\eta\sum_{i=1}^{n}\frac{N_{i}}{N}(\theta_{i}-\theta_{global})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.8" class="ltx_p">Following the last federated round, the local model parameters of all clients <math id="S3.SS3.p1.8.m1.3" class="ltx_Math" alttext="i\in\{1,\dots,M\}" display="inline"><semantics id="S3.SS3.p1.8.m1.3a"><mrow id="S3.SS3.p1.8.m1.3.4" xref="S3.SS3.p1.8.m1.3.4.cmml"><mi id="S3.SS3.p1.8.m1.3.4.2" xref="S3.SS3.p1.8.m1.3.4.2.cmml">i</mi><mo id="S3.SS3.p1.8.m1.3.4.1" xref="S3.SS3.p1.8.m1.3.4.1.cmml">∈</mo><mrow id="S3.SS3.p1.8.m1.3.4.3.2" xref="S3.SS3.p1.8.m1.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS3.p1.8.m1.3.4.3.2.1" xref="S3.SS3.p1.8.m1.3.4.3.1.cmml">{</mo><mn id="S3.SS3.p1.8.m1.1.1" xref="S3.SS3.p1.8.m1.1.1.cmml">1</mn><mo id="S3.SS3.p1.8.m1.3.4.3.2.2" xref="S3.SS3.p1.8.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.8.m1.2.2" xref="S3.SS3.p1.8.m1.2.2.cmml">…</mi><mo id="S3.SS3.p1.8.m1.3.4.3.2.3" xref="S3.SS3.p1.8.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS3.p1.8.m1.3.3" xref="S3.SS3.p1.8.m1.3.3.cmml">M</mi><mo stretchy="false" id="S3.SS3.p1.8.m1.3.4.3.2.4" xref="S3.SS3.p1.8.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m1.3b"><apply id="S3.SS3.p1.8.m1.3.4.cmml" xref="S3.SS3.p1.8.m1.3.4"><in id="S3.SS3.p1.8.m1.3.4.1.cmml" xref="S3.SS3.p1.8.m1.3.4.1"></in><ci id="S3.SS3.p1.8.m1.3.4.2.cmml" xref="S3.SS3.p1.8.m1.3.4.2">𝑖</ci><set id="S3.SS3.p1.8.m1.3.4.3.1.cmml" xref="S3.SS3.p1.8.m1.3.4.3.2"><cn type="integer" id="S3.SS3.p1.8.m1.1.1.cmml" xref="S3.SS3.p1.8.m1.1.1">1</cn><ci id="S3.SS3.p1.8.m1.2.2.cmml" xref="S3.SS3.p1.8.m1.2.2">…</ci><ci id="S3.SS3.p1.8.m1.3.3.cmml" xref="S3.SS3.p1.8.m1.3.3">𝑀</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m1.3c">i\in\{1,\dots,M\}</annotation></semantics></math> are personalized by performing a fixed number of gradient optimization epochs on the local training data.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Hierarchical Clustering</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">The personalization of the local models can benefit more from clients that share more similarities in their data with each specific client. Therefore, we propose to perform hierarchical clustering after an initial phase of global federated learning, including all the clients. After performing FedAvg for a specified number of federated rounds, clients are clustered via hierarchical clustering according to their model updates in the current round. Each of the resultant client clusters is then treated as an isolated federated learning problem where either FedAvg or our proposed FedAP is employed. The full pipeline is visualized in <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments and Results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we present the experimental setup and the results of our experiments. The dataset, data preprocessing, and the employed data split for federated learning are discussed in <a href="#S4.SS1.SSS1" title="4.1.1 Dataset and preprocessing ‣ 4.1 Experimental Setup ‣ 4 Experiments and Results ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">subsubsection 4.1.1</span></a> and <a href="#S4.SS1.SSS2" title="4.1.2 Federated data split ‣ 4.1 Experimental Setup ‣ 4 Experiments and Results ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">subsubsection 4.1.2</span></a>, respectively. We compare our proposed personalized clustered models to two baselines, a standard supervised model trained in the centralized setting and FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Furthermore, we present the results of combining clustering and personalization with existing approaches on the HAM10k skin lesion dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.9" class="ltx_p">We employ a pretrained MobileNetV2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> on ImageNet as a base classifier for all the baselines and our proposed model.
The hyperparameter tuning was performed using a validation set without any overlap with the test set for the centralized model.
For all the federated learning experiments, hyperparameter optimization comprised two steps: First, all clients were generated using a fixed random seed, and the hyperparameters were optimized against the client’s test sets. Then, we generated all clients anew for the evaluation using a different random seed, and a final learning curve was acquired using the previously fixed hyperparameter. The following hyperparameters were optimized: learning rate, batch size, and a number of local training epochs. The final values were re-used in all of the experiments. The models were optimized with SGD optimizer, with learning rate <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><cn type="float" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">0.001</annotation></semantics></math>, inner epochs <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="e=1" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">e</mi><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><eq id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></eq><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝑒</ci><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">e=1</annotation></semantics></math>, inner personalization epochs <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="7" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">7</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><cn type="integer" id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">7</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">7</annotation></semantics></math>, inner batch size <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mn id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><cn type="integer" id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">16</annotation></semantics></math>, initial and final meta-learning rate <math id="S4.SS1.p1.5.m5.2" class="ltx_Math" alttext="\eta_{0}=1.0,\eta_{k}=0.46" display="inline"><semantics id="S4.SS1.p1.5.m5.2a"><mrow id="S4.SS1.p1.5.m5.2.2.2" xref="S4.SS1.p1.5.m5.2.2.3.cmml"><mrow id="S4.SS1.p1.5.m5.1.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.1.cmml"><msub id="S4.SS1.p1.5.m5.1.1.1.1.2" xref="S4.SS1.p1.5.m5.1.1.1.1.2.cmml"><mi id="S4.SS1.p1.5.m5.1.1.1.1.2.2" xref="S4.SS1.p1.5.m5.1.1.1.1.2.2.cmml">η</mi><mn id="S4.SS1.p1.5.m5.1.1.1.1.2.3" xref="S4.SS1.p1.5.m5.1.1.1.1.2.3.cmml">0</mn></msub><mo id="S4.SS1.p1.5.m5.1.1.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.5.m5.1.1.1.1.3" xref="S4.SS1.p1.5.m5.1.1.1.1.3.cmml">1.0</mn></mrow><mo id="S4.SS1.p1.5.m5.2.2.2.3" xref="S4.SS1.p1.5.m5.2.2.3a.cmml">,</mo><mrow id="S4.SS1.p1.5.m5.2.2.2.2" xref="S4.SS1.p1.5.m5.2.2.2.2.cmml"><msub id="S4.SS1.p1.5.m5.2.2.2.2.2" xref="S4.SS1.p1.5.m5.2.2.2.2.2.cmml"><mi id="S4.SS1.p1.5.m5.2.2.2.2.2.2" xref="S4.SS1.p1.5.m5.2.2.2.2.2.2.cmml">η</mi><mi id="S4.SS1.p1.5.m5.2.2.2.2.2.3" xref="S4.SS1.p1.5.m5.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S4.SS1.p1.5.m5.2.2.2.2.1" xref="S4.SS1.p1.5.m5.2.2.2.2.1.cmml">=</mo><mn id="S4.SS1.p1.5.m5.2.2.2.2.3" xref="S4.SS1.p1.5.m5.2.2.2.2.3.cmml">0.46</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.2b"><apply id="S4.SS1.p1.5.m5.2.2.3.cmml" xref="S4.SS1.p1.5.m5.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.2.2.3a.cmml" xref="S4.SS1.p1.5.m5.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS1.p1.5.m5.1.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1"><eq id="S4.SS1.p1.5.m5.1.1.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1.1"></eq><apply id="S4.SS1.p1.5.m5.1.1.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1.2.2">𝜂</ci><cn type="integer" id="S4.SS1.p1.5.m5.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1.2.3">0</cn></apply><cn type="float" id="S4.SS1.p1.5.m5.1.1.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.1.1.3">1.0</cn></apply><apply id="S4.SS1.p1.5.m5.2.2.2.2.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2"><eq id="S4.SS1.p1.5.m5.2.2.2.2.1.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.1"></eq><apply id="S4.SS1.p1.5.m5.2.2.2.2.2.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.5.m5.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.2.2">𝜂</ci><ci id="S4.SS1.p1.5.m5.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.2.3">𝑘</ci></apply><cn type="float" id="S4.SS1.p1.5.m5.2.2.2.2.3.cmml" xref="S4.SS1.p1.5.m5.2.2.2.2.3">0.46</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.2c">\eta_{0}=1.0,\eta_{k}=0.46</annotation></semantics></math>, total federated rounds <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="k=220" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mrow id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml">k</mi><mo id="S4.SS1.p1.6.m6.1.1.1" xref="S4.SS1.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">220</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><eq id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1"></eq><ci id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2">𝑘</ci><cn type="integer" id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3">220</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">k=220</annotation></semantics></math>, meta batch size <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="n=5" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mrow id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">n</mi><mo id="S4.SS1.p1.7.m7.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><eq id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1"></eq><ci id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">𝑛</ci><cn type="integer" id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">n=5</annotation></semantics></math>, cluster initialization rounds <math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mn id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><cn type="integer" id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">20</annotation></semantics></math>, Euclidean distance metric, ward linkage mechanism and maximum distance of <math id="S4.SS1.p1.9.m9.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.SS1.p1.9.m9.1a"><mn id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><cn type="integer" id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">5</annotation></semantics></math>.</p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Dataset and preprocessing</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p">The HAM10k dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> is a collection of <math id="S4.SS1.SSS1.p1.1.m1.2" class="ltx_Math" alttext="10,015" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.2a"><mrow id="S4.SS1.SSS1.p1.1.m1.2.3.2" xref="S4.SS1.SSS1.p1.1.m1.2.3.1.cmml"><mn id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml">10</mn><mo id="S4.SS1.SSS1.p1.1.m1.2.3.2.1" xref="S4.SS1.SSS1.p1.1.m1.2.3.1.cmml">,</mo><mn id="S4.SS1.SSS1.p1.1.m1.2.2" xref="S4.SS1.SSS1.p1.1.m1.2.2.cmml">015</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.2b"><list id="S4.SS1.SSS1.p1.1.m1.2.3.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.2.3.2"><cn type="integer" id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1">10</cn><cn type="integer" id="S4.SS1.SSS1.p1.1.m1.2.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.2.2">015</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.2c">10,015</annotation></semantics></math> dermatoscopic images of seven types of skin lesions.
The ground truth labels in HAM10k are based on histopathology in over 50% of the cases and on follow-up examination, expert consensus, or in-vivo confocal microscopy. Our choice of HAM10k for evaluation of our method was due to this dataset’s unbalanced and high non-i.i.d nature. To address the problem of unbalancedness in the dataset, we utilized random undersampling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>; <em id="S4.SS1.SSS1.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>let@tokeneonedotat most 500 images from each lesion class were randomly sampled and used for training.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Federated data split</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.1" class="ltx_p">One of the common problems in clinical datasets that challenge machine learning methods is low statistical heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. We modeled highly non-i.i.d data distributions between our clients to represent this problem. Images within each class were partitioned into 35 groups, and the clients were randomly assigned two partitions from different classes until no partition pairs were left. This resulted in 34 clients, with 70 images assigned to each in total from two classes (see the supplementary material for the distribution heatmap). The 70 images were randomly split into training and test sets at an 80:20 ratio within each client.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results and Discussions</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In this section, we present the results of our experiments and the comparison of our proposed model to previous work. In order to take the number of personalization rounds in FedAP and initialization rounds in HC into account for our total training rounds, the reported accuracy values in <a href="#S4.T1" title="Table 1 ‣ 4.2 Results and Discussions ‣ 4 Experiments and Results ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Table 1</span></a> are based on the total number of training steps for all models.</p>
</div>
<div id="S4.SS2.2" class="ltx_logical-block ltx_minipage ltx_align_bottom" style="width:199.5pt;">
<div id="S4.SS2.2.p1" class="ltx_para">
<img src="/html/2207.03448/assets/figures/plotborderremoved.png" id="S4.SS2.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="453" alt="[Uncaptioned image]">
</div>
<figure id="S4.F2" class="ltx_figure ltx_align_center">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S4.F2.2.1" class="ltx_text ltx_font_bold">Average Test Accuracy in Different Rounds</span>. Classification accuracy averaged over all clients. This figure shows the increase in the convergence rate using both FedAP and HC.</figcaption>
</figure>
</div>
<div id="S4.SS2.7" class="ltx_logical-block ltx_minipage ltx_align_bottom" style="width:199.5pt;">
<div id="S4.SS2.7.p1" class="ltx_para">
<table id="S4.SS2.6.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.SS2.6.4.5.1" class="ltx_tr">
<th id="S4.SS2.6.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Method</th>
<th id="S4.SS2.6.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Accuracy (%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.SS2.6.4.6.1" class="ltx_tr">
<th id="S4.SS2.6.4.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">Centralized</th>
<td id="S4.SS2.6.4.6.1.2" class="ltx_td ltx_align_center ltx_border_tt">76.8</td>
</tr>
<tr id="S4.SS2.3.1.1" class="ltx_tr">
<th id="S4.SS2.3.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</th>
<td id="S4.SS2.3.1.1.1" class="ltx_td ltx_align_center ltx_border_t">41.1 <math id="S4.SS2.3.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.SS2.3.1.1.1.m1.1a"><mo id="S4.SS2.3.1.1.1.m1.1.1" xref="S4.SS2.3.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.3.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.SS2.3.1.1.1.m1.1.1.cmml" xref="S4.SS2.3.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.3.1.1.1.m1.1c">\pm</annotation></semantics></math> 34.31</td>
</tr>
<tr id="S4.SS2.4.2.2" class="ltx_tr">
<th id="S4.SS2.4.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvg + HC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>
</th>
<td id="S4.SS2.4.2.2.1" class="ltx_td ltx_align_center">44.1 <math id="S4.SS2.4.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.SS2.4.2.2.1.m1.1a"><mo id="S4.SS2.4.2.2.1.m1.1.1" xref="S4.SS2.4.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.4.2.2.1.m1.1b"><csymbol cd="latexml" id="S4.SS2.4.2.2.1.m1.1.1.cmml" xref="S4.SS2.4.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.4.2.2.1.m1.1c">\pm</annotation></semantics></math> 20.86</td>
</tr>
<tr id="S4.SS2.5.3.3" class="ltx_tr">
<th id="S4.SS2.5.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAP (Ours)</th>
<td id="S4.SS2.5.3.3.1" class="ltx_td ltx_align_center">84.1 <math id="S4.SS2.5.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.SS2.5.3.3.1.m1.1a"><mo id="S4.SS2.5.3.3.1.m1.1.1" xref="S4.SS2.5.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.5.3.3.1.m1.1b"><csymbol cd="latexml" id="S4.SS2.5.3.3.1.m1.1.1.cmml" xref="S4.SS2.5.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.5.3.3.1.m1.1c">\pm</annotation></semantics></math> 14.53</td>
</tr>
<tr id="S4.SS2.6.4.4" class="ltx_tr">
<th id="S4.SS2.6.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">FedAP + HC (Ours)</th>
<td id="S4.SS2.6.4.4.1" class="ltx_td ltx_align_center ltx_border_b">
<span id="S4.SS2.6.4.4.1.1" class="ltx_text ltx_font_bold">86.9</span> <math id="S4.SS2.6.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.SS2.6.4.4.1.m1.1a"><mo id="S4.SS2.6.4.4.1.m1.1.1" xref="S4.SS2.6.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.6.4.4.1.m1.1b"><csymbol cd="latexml" id="S4.SS2.6.4.4.1.m1.1.1.cmml" xref="S4.SS2.6.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.6.4.4.1.m1.1c">\pm</annotation></semantics></math> <span id="S4.SS2.6.4.4.1.2" class="ltx_text ltx_font_bold">12.81</span>
</td>
</tr>
</tbody>
</table>
</div>
<figure id="S4.T1" class="ltx_table ltx_align_center">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span><span id="S4.T1.2.1" class="ltx_text ltx_font_bold">Results</span>. The comparison of our methods to the baselines on the non-i.i.d HAM10k dataset. The reported values for federated models are based on the mean and std of all the clients.</figcaption>
</figure>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">A standard <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_bold">centralized</span> training setting was intended as a standard against which the more constrained federated learning experiments could be measured. For this experiment, a global training and test sets were created by pooling all clients’ respective training and test data. Due to the availability of all clients’ data to a single model, this model achieves relatively higher performance compared to FedAvg.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p"><span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_bold">FedAvg</span> achieves the worst performance across all methods. The learning curve shows a high degree of oscillation due to the fact that the single global model was not able to learn all necessary features from the different learning tasks imposed by different data distributions of the clients. Thus, this demonstrates the lack of robustness of <span id="S4.SS2.p3.1.2" class="ltx_text ltx_font_italic">FedAvg</span> in a highly non-i.i.d. data setting, as indicated by preliminary evidence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.2" class="ltx_p">For the <span id="S4.SS2.p4.2.1" class="ltx_text ltx_font_bold">FedAvg + HC</span> experiment, several FedAvg rounds (given by the hyperparameter "cluster initialization rounds") were performed before clustering. Following this, clients were clustered according to their local updates using hierarchical clustering (as in Briggs <em id="S4.SS2.p4.2.2" class="ltx_emph ltx_font_italic">et al</em>let@tokeneonedot<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>). Inside the individual clusters, conventional <span id="S4.SS2.p4.2.3" class="ltx_text ltx_font_italic">FedAvg</span> training was performed. The global accuracy was obtained by simply averaging the test set accuracy of all clients. Hierarchical clustering increased the overall convergence speed of <span id="S4.SS2.p4.2.4" class="ltx_text ltx_font_italic">FedAvg</span>. A sudden jump in the accuracy, as well as final model performance improvement, can be seen after clustering in <a href="#S4.F2" title="Figure 2 ‣ 4.2 Results and Discussions ‣ 4 Experiments and Results ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a>. We assume that an approximation of a homogeneous learning setting is recovered inside the clusters, and indeed the model updates can be used to represent the data distribution. However, this approach still falls far behind the performance of <span id="S4.SS2.p4.2.5" class="ltx_text ltx_font_italic">FedAP</span>, substantiating the crucial importance of model personalization in a highly non-i.i.d. data environment. similar to <span id="S4.SS2.p4.2.6" class="ltx_text ltx_font_italic">FedAvg</span>, <span id="S4.SS2.p4.2.7" class="ltx_text ltx_font_bold">FedAP</span> randomly samples a batch of <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">n</annotation></semantics></math> clients at each round and uses SGD for local training. SGD is also used for global training so that the global update rule became <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="\theta\leftarrow\theta+\eta\cdot\Delta\theta" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">θ</mi><mo stretchy="false" id="S4.SS2.p4.2.m2.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.cmml">←</mo><mrow id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml"><mi id="S4.SS2.p4.2.m2.1.1.3.2" xref="S4.SS2.p4.2.m2.1.1.3.2.cmml">θ</mi><mo id="S4.SS2.p4.2.m2.1.1.3.1" xref="S4.SS2.p4.2.m2.1.1.3.1.cmml">+</mo><mrow id="S4.SS2.p4.2.m2.1.1.3.3" xref="S4.SS2.p4.2.m2.1.1.3.3.cmml"><mrow id="S4.SS2.p4.2.m2.1.1.3.3.2" xref="S4.SS2.p4.2.m2.1.1.3.3.2.cmml"><mi id="S4.SS2.p4.2.m2.1.1.3.3.2.2" xref="S4.SS2.p4.2.m2.1.1.3.3.2.2.cmml">η</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p4.2.m2.1.1.3.3.2.1" xref="S4.SS2.p4.2.m2.1.1.3.3.2.1.cmml">⋅</mo><mi mathvariant="normal" id="S4.SS2.p4.2.m2.1.1.3.3.2.3" xref="S4.SS2.p4.2.m2.1.1.3.3.2.3.cmml">Δ</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.p4.2.m2.1.1.3.3.1" xref="S4.SS2.p4.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p4.2.m2.1.1.3.3.3" xref="S4.SS2.p4.2.m2.1.1.3.3.3.cmml">θ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><ci id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1">←</ci><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">𝜃</ci><apply id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3"><plus id="S4.SS2.p4.2.m2.1.1.3.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3.1"></plus><ci id="S4.SS2.p4.2.m2.1.1.3.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.2">𝜃</ci><apply id="S4.SS2.p4.2.m2.1.1.3.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3"><times id="S4.SS2.p4.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.1"></times><apply id="S4.SS2.p4.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.2"><ci id="S4.SS2.p4.2.m2.1.1.3.3.2.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.2.1">⋅</ci><ci id="S4.SS2.p4.2.m2.1.1.3.3.2.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.2.2">𝜂</ci><ci id="S4.SS2.p4.2.m2.1.1.3.3.2.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.2.3">Δ</ci></apply><ci id="S4.SS2.p4.2.m2.1.1.3.3.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\theta\leftarrow\theta+\eta\cdot\Delta\theta</annotation></semantics></math>. Moreover, the adaptive weight decreases linearly with the number of federated rounds, from specified initial to final values. The evaluation of <span id="S4.SS2.p4.2.8" class="ltx_text ltx_font_italic">FedAP</span> was performed in the same way as of FedAvg with the difference that, after the distribution of the global model, it was personalized to the clients by performing a number of gradient optimization steps on the local training sets. After this personalization, the model was evaluated on the test set, and again a global accuracy was calculated by averaging all local test set accuracies. The global model for <span id="S4.SS2.p4.2.9" class="ltx_text ltx_font_italic">FedAP</span> was able to learn continuously, while the personalization step allowed the adaption to the different client distributions. Especially the extreme non-i.i.d. setting with simple underlying tasks allows the personalization to perform very well.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.1" class="ltx_p">The <span id="S4.SS2.p5.1.1" class="ltx_text ltx_font_bold">FedAP + HC</span> experiment was performed in the same way as the previous one, only that the adaptive personalization is performed after hierarchical clustering. As in the <span id="S4.SS2.p5.1.2" class="ltx_text ltx_font_italic">FedAvg + HC</span> experiment, clusters were formed according to clients’ model updates after initial <math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><mn id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><cn type="integer" id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">20</annotation></semantics></math> rounds of FedAvg. <span id="S4.SS2.p5.1.3" class="ltx_text ltx_font_italic">FedAP + HC</span> shows the overall best performance compared to all other approaches. We observe the same learning curve behavior as in <span id="S4.SS2.p5.1.4" class="ltx_text ltx_font_italic">FedAvg + HC</span>. It improves the convergence speed of the algorithm, shown again by the immediate jump in balanced accuracy after clustering depicted in <a href="#S4.F2" title="Figure 2 ‣ 4.2 Results and Discussions ‣ 4 Experiments and Results ‣ Adaptive Personlization in Federated Learning for Highly Non-i.i.d. Data" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a>.
Despite achieving the best performance among the different mentioned variations of the federated setting, we observed that the FedAP + HC model suffers from overfitting in very long runs; <em id="S4.SS2.p5.1.5" class="ltx_emph ltx_font_italic">i.e</em>let@tokeneonedotif we train both FedAP and FedAP + HC for around 500 more rounds, the performance stays the same or gains minimal improvement in FedAP, but the FedAP + HC starts deteriorating. We assume that this is an indication of the global model’s higher adaptability to distinct tasks than the cluster models. The core idea of meta-learning roots in learning from many distinctive tasks. Indeed, clustering clients (representing the meta-learning task in a federated learning setting) reduces the diversity of tasks in each cluster to learn from. Therefore, this might be the reason behind FedAP + HC model’s sensitivity to overfitting in more extended training.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this work, we presented and analyzed an adaptive personalization approach along with hierarchical clustering of the clients to tackle the non-i.i.d. problem in federated learning. Our adaptive model parameter weighting with hierarchical clustering enables the better adaptation of the local models of clients to their distinctive data distribution while still taking advantage of the global aggregation of the different client model updates. The clients are clustered based on their similarity to local model updates and thus can approximate an i.i.d. setting in the respective clusters. Our experiments on the HAM10k dataset with the MobileNetV2 network show drastic improvements in classification accuracy over the standard supervised and over the FedAvg baseline. The lower standard deviation of our proposed method compared to previous work demonstrate that adaptive personalization of client models in the federated setting, inspired by meta-learning, yields higher generalizability of all clients models. In addition, hierarchical clustering increases the convergence speed and allows for better global models. Our experiments show that the models trained with FedAP and HC have the lowest standard deviation and highest average accuracy, demonstrating the proposed methods’ effectiveness in reaching a reasonable and high accuracy performance in all clients. Despite the high performance gain of our proposed method, if the model is trained for too many rounds, the performance decreases, which shows its sensitivity to overfitting. Therefore, we plan to investigate this issue in future work.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work was supported in part by the Munich Center for Machine Learning (MCML) with funding from the Bundesministerium für Bildung und Forschung (BMBF) under the project 01IS18036B.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Aliakbari, A., Yeganeh, Y.M., Safari, S.: Simulation of dac-based truncated
sine excitation pulse generator. In: 2015 2nd International Conference on
Knowledge-Based Engineering and Innovation (KBEI). pp. 689–693. IEEE (2015)

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Arivazhagan, M.G., Aggarwal, V., Singh, A.K., Choudhary, S.: Federated
Learning with Personalization Layers. arXiv:1912.00818 [cs, stat] (Dec
2019), <a target="_blank" href="http://arxiv.org/abs/1912.00818" title="" class="ltx_ref ltx_url" style="color:#0000FF;">http://arxiv.org/abs/1912.00818</a>, arXiv: 1912.00818

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Briggs, C., Fan, Z., Andras, P.: Federated learning with hierarchical
clustering of local updates to improve training on non-iid data (May 2020)

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Chen, F., Luo, M., Dong, Z., Li, Z., He, X.: Federated meta-learning with fast
convergence and efficient communication (2019)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Fallah, A., Mokhtari, A., Ozdaglar, A.: Personalized federated learning: A
meta-learning approach (2020)

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Farshad, A., Yeganeh, Y., Gehlbach, P., Navab, N.: Y-net: A spatiospectral
dual-encoder networkfor medical image segmentation. arXiv preprint
arXiv:2204.07613 (2022)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Fernández, A., García, S., Galar, M., Prati, R.C., Krawczyk, B.,
Herrera, F.: Learning from imbalanced data sets, vol. 11. Springer (2018)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Finn, C., Abbeel, P., Levine, S.: Model-agnostic meta-learning for fast
adaptation of deep networks. In: Precup, D., Teh, Y.W. (eds.) Proceedings of
the 34th International Conference on Machine Learning. Proceedings of Machine
Learning Research, vol. 70, pp. 1126–1135. PMLR, International Convention
Centre, Sydney, Australia (06–11 Aug 2017),
<a target="_blank" href="http://proceedings.mlr.press/v70/finn17a.html" title="" class="ltx_ref ltx_url" style="color:#0000FF;">http://proceedings.mlr.press/v70/finn17a.html</a>

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Jiang, Y., Konecny, J., Rush, K., Kannan, S.: Improving federated learning
personalization via model agnostic meta learning (2019)

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Khodak, M., Balcan, M.F., Talwalkar, A.: Adaptive gradient-based meta-learning
methods (2019)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Li, D., Wang, J.: FedMD: Heterogenous Federated Learning via Model
Distillation. arXiv:1910.03581 [cs, stat] (Oct 2019),
<a target="_blank" href="http://arxiv.org/abs/1910.03581" title="" class="ltx_ref ltx_url" style="color:#0000FF;">http://arxiv.org/abs/1910.03581</a>, arXiv: 1910.03581

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Li, T., Sahu, A.K., Talwalkar, A., Smith, V.: Federated learning: Challenges,
methods, and future directions. IEEE Signal Processing Magazine
<span id="bib.bib12.1.1" class="ltx_text ltx_font_bold">37</span>(3), 50–60 (2020)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Li, X., Huang, K., Yang, W., Wang, S., Zhang, Z.: On the Convergence of
FedAvg on Non-IID Data. arXiv:1907.02189 [cs, math, stat] (Jun
2020), <a target="_blank" href="http://arxiv.org/abs/1907.02189" title="" class="ltx_ref ltx_url" style="color:#0000FF;">http://arxiv.org/abs/1907.02189</a>, arXiv: 1907.02189

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Madabhushi, A., Lee, G.: Image analysis and machine learning in digital
pathology: Challenges and opportunities. Medical Image Analysis <span id="bib.bib14.1.1" class="ltx_text ltx_font_bold">33</span>,
170–175 (2016). https://doi.org/https://doi.org/10.1016/j.media.2016.06.037,
<a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S1361841516301141" title="" class="ltx_ref ltx_url" style="color:#0000FF;">https://www.sciencedirect.com/science/article/pii/S1361841516301141</a>,
20th anniversary of the Medical Image Analysis journal (MedIA)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., y Arcas, B.A.:
Communication-efficient learning of deep networks from decentralized data.
In: Singh, A., Zhu, J. (eds.) Proceedings of the 20th International
Conference on Artificial Intelligence and Statistics. Proceedings of Machine
Learning Research, vol. 54, pp. 1273–1282. PMLR, Fort Lauderdale, FL, USA
(20–22 Apr 2017), <a target="_blank" href="http://proceedings.mlr.press/v54/mcmahan17a.html" title="" class="ltx_ref ltx_url" style="color:#0000FF;">http://proceedings.mlr.press/v54/mcmahan17a.html</a>

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Nichol, A., Achiam, J., Schulman, J.: On first-order meta-learning algorithms
(2018)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Reddi, S., Charles, Z., Zaheer, M., Garrett, Z., Rush, K., Konečný, J.,
Kumar, S., McMahan, H.B.: Adaptive Federated Optimization.
arXiv:2003.00295 [cs, math, stat] (Dec 2020),
<a target="_blank" href="http://arxiv.org/abs/2003.00295" title="" class="ltx_ref ltx_url" style="color:#0000FF;">http://arxiv.org/abs/2003.00295</a>, arXiv: 2003.00295

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Rieke, N., Hancox, J., Li, W., Milletari, F., Roth, H., Albarqouni, S., Bakas,
S., Galtier, M.N., Landman, B., Maier-Hein, K., Ourselin, S., Sheller, M.,
Summers, R.M., Trask, A., Xu, D., Baust, M., Cardoso, M.J.: The future of
digital health with federated learning (2021)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Sae-Lim, W., Wettayaprasit, W., Aiyarak, P.: Convolutional neural networks
using mobilenet for skin lesion classification. In: 2019 16th international
joint conference on computer science and software engineering (JCSSE). pp.
242–247. IEEE (2019)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Sandler, M., Howard, A., Zhu, M., Zhmoginov, A., Chen, L.C.: Mobilenetv2:
Inverted residuals and linear bottlenecks. In: Proceedings of the IEEE
conference on computer vision and pattern recognition. pp. 4510–4520 (2018)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Sattler, F., Wiedemann, S., Müller, K.R., Samek, W.: Robust and
Communication-Efficient Federated Learning from Non-IID Data.
arXiv:1903.02891 [cs, stat] (Mar 2019),
<a target="_blank" href="http://arxiv.org/abs/1903.02891" title="" class="ltx_ref ltx_url" style="color:#0000FF;">http://arxiv.org/abs/1903.02891</a>, arXiv: 1903.02891

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Sheller, M.J., Edwards, B., Reina, G.A., Martin, J., Pati, S., Kotrotsou, A.,
Milchenko, M., Xu, W., Marcus, D., Colen, R.R., et al.: Federated learning in
medicine: facilitating multi-institutional collaborations without sharing
patient data. Scientific reports <span id="bib.bib22.1.1" class="ltx_text ltx_font_bold">10</span>(1), 1–12 (2020)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Smith, V., Chiang, C.K., Sanjabi, M., Talwalkar, A.: Federated Multi-Task
Learning. arXiv:1705.10467 [cs, stat] (Feb 2018),
<a target="_blank" href="http://arxiv.org/abs/1705.10467" title="" class="ltx_ref ltx_url" style="color:#0000FF;">http://arxiv.org/abs/1705.10467</a>, arXiv: 1705.10467

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Tschandl, P., Rosendahl, C., Kittler, H.: The ham10000 dataset, a large
collection of multi-source dermatoscopic images of common pigmented skin
lesions. Scientific data <span id="bib.bib24.1.1" class="ltx_text ltx_font_bold">5</span>(1),  1–9 (2018)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Vanschoren, J.: Meta-learning: A survey. arXiv preprint arXiv:1810.03548
(2018)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Wang, K., Mathews, R., Kiddon, C., Eichner, H., Beaufays, F., Ramage, D.:
Federated Evaluation of On-device Personalization. arXiv:1910.10252
[cs, stat] (Oct 2019), <a target="_blank" href="http://arxiv.org/abs/1910.10252" title="" class="ltx_ref ltx_url" style="color:#0000FF;">http://arxiv.org/abs/1910.10252</a>, arXiv:
1910.10252

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Wynants, L., Riley, R., Timmerman, D., Van Calster, B.: Random-effects
meta-analysis of the clinical utility of tests and prediction models.
Statistics in medicine <span id="bib.bib27.1.1" class="ltx_text ltx_font_bold">37</span>(12), 2034–2052 (2018)

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Yeganeh, Y., Farshad, A., Navab, N., Albarqouni, S.: Inverse Distance
Aggregation for Federated Learning with Non-IID Data.
arXiv:2008.07665 [cs, stat] (Aug 2020),
<a target="_blank" href="http://arxiv.org/abs/2008.07665" title="" class="ltx_ref ltx_url" style="color:#0000FF;">http://arxiv.org/abs/2008.07665</a>, arXiv: 2008.07665

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Yue, L., Tian, D., Chen, W., Han, X., Yin, M.: Deep learning for heterogeneous
medical data analysis. World Wide Web <span id="bib.bib29.1.1" class="ltx_text ltx_font_bold">23</span>(5), 2715–2737 (Sep
2020). https://doi.org/10.1007/s11280-019-00764-z,
<a target="_blank" href="https://doi.org/10.1007/s11280-019-00764-z" title="" class="ltx_ref ltx_url" style="color:#0000FF;">https://doi.org/10.1007/s11280-019-00764-z</a>

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Zhao, Y., Li, M., Lai, L., Suda, N., Civin, D., Chandra, V.: Federated learning
with non-iid data. CoRR <span id="bib.bib30.1.1" class="ltx_text ltx_font_bold">abs/1806.00582</span> (2018),
<a target="_blank" href="http://arxiv.org/abs/1806.00582" title="" class="ltx_ref ltx_url" style="color:#0000FF;">http://arxiv.org/abs/1806.00582</a>

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2207.03447" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2207.03448" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2207.03448">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2207.03448" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2207.03449" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Mar 13 15:32:38 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
