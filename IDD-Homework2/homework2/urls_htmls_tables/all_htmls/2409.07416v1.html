<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation</title>
<!--Generated on Wed Sep 11 16:56:14 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.07416v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S1" title="In Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S2" title="In Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S2.SS1" title="In 2 Related Work ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>RL-based Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S2.SS2" title="In 2 Related Work ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Hierarchical Reinforcement Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S2.SS3" title="In 2 Related Work ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>HRL-based Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S2.SS4" title="In 2 Related Work ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Edge-based Recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S3" title="In Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminary and Problem Formulation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S3.SS1" title="In 3 Preliminary and Problem Formulation ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Listwise Recommending Scenario</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S3.SS2" title="In 3 Preliminary and Problem Formulation ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Reinforcement Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S3.SS3" title="In 3 Preliminary and Problem Formulation ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Deep Deterministic Policy Gradient</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S3.SS4" title="In 3 Preliminary and Problem Formulation ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Gated Recurrent Unit</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S3.SS5" title="In 3 Preliminary and Problem Formulation ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>The mccHRL Framework</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4" title="In Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.SS1" title="In 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Session Recurrent Encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.SS2" title="In 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>High-Level Agent</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.SS3" title="In 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Low-Level Agent</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.SS4" title="In 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Mechanism</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.SS4.SSS1" title="In 4.4 Mechanism ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.1 </span>Training with Generic Environment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.SS4.SSS2" title="In 4.4 Mechanism ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.2 </span>Training with Offline Data</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5" title="In Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS1" title="In 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Environments</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS1.SSS1" title="In 5.1 Experimental Environments ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span>Simulator-based Experiment.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS1.SSS2" title="In 5.1 Experimental Environments ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span>Dataset-based Experiment.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS2" title="In 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS3" title="In 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS3.SSS1" title="In 5.3 Implementation Details ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.1 </span>Simulator-based Experiment.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS3.SSS2" title="In 5.3 Implementation Details ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.2 </span>Dataset-based Experiment.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS4" title="In 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS5" title="In 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Offline Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS6" title="In 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.6 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS7" title="In 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.7 </span>Sensitivity Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS8" title="In 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.8 </span>Live Experiment</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S6" title="In Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Discussion and Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S7" title="In Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Luo Ji , Gao Liu, Mingyang Yin, Hongxia Yang, Jingren Zhou 
<br class="ltx_break"/>DAMO Academy, Alibaba Group
</span><span class="ltx_author_notes">Corresponding author: <span class="ltx_text ltx_font_typewriter" id="id1.1.id1">jiluo.lj@alibaba-inc.com</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">Modern listwise recommendation systems need to consider both long-term user perceptions and short-term interest shifts. Reinforcement learning can be applied on recommendation to study such a problem but is also subject to large search space, sparse user feedback and long interactive latency. Motivated by recent progress in hierarchical reinforcement learning, we propose a novel framework called mccHRL to provide different levels of temporal abstraction on listwise recommendation. Within the hierarchical framework, the high-level agent studies the evolution of user perception, while the low-level agent produces the item selection policy by modeling the process as a sequential decision-making problem. We argue that such framework has a well-defined decomposition of the outra-session context and the intra-session context, which are encoded by the high-level and low-level agents, respectively. To verify this argument, we implement both a simulator-based environment and an industrial dataset-based experiment. Results observe significant performance improvement by our method, compared with several well-known baselines. Data and codes have been made public.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In recent years, hybrid Recommender systems (RS) have become increasingly popular to overcome information redundancy and have been widely utilized in a variety of domains (<em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">e.g.</em> products, articles, advertisements, music, and movies)  <cite class="ltx_cite ltx_citemacro_cite">Anidorifón et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib1" title="">2015</a>)</cite>. Hybrid RS selects a list of contents (usually called ‘items’) from overwhelmed candidates for exhibition to meet user preferences, with expected clicks, dwell times or purchases increased. Although with substantial achievement, more advanced recommendation techniques are always necessary because of the complexity of business scenarios, including listwise, cold-start, heterogeneous contents, spatiotemporal-aware (STA) recommendations, etc. Among these, the listwise recommendation is always an important issue, not only due to the wide application of Top-K recommendation  <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib4" title="">2019</a>)</cite> or feed recommendation  <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib27" title="">2021</a>)</cite>, but also the computational complexity with consideration of mutual-item influence, and position bias.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Reinforcement Learning (RL) is a natural, unified framework to learn interactively with the environment and maximize the global and long-term rewards, which highlights some promising solutions of listwise ranking. According to the formulation manner of the Markov Decision Process (MDP), we conclude that most such works can be classified into two main categories:
</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">Define the user perception/preference as state and the entire recommendation list as action, and model the user interest shift as state transition  <cite class="ltx_cite ltx_citemacro_cite">Zheng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib35" title="">2018</a>); Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib3" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib4" title="">2019</a>); Ie et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib11" title="">2019</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Formulate the listwise ranking problem as a sequential decision-making process, with the state represented by the current list ranked item, while the action is to select the next optimal item to the list <cite class="ltx_cite ltx_citemacro_cite">Gong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib8" title="">2019</a>); Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib34" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib33" title="">2018</a>)</cite>.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S1.p2.2">Nevertheless, both methodologies have their obstacles, which prevent the wide application of RL on industrial RS. For the first category, a thorough representation of user states can be expected especially for STA or POI-based recommendations, but the modeling of state transition is questionable since its modeling time interval is coarse-grained. Users naturally interact with RS based on the item-wise experience instead of the session, and they might leave the app for a while before the next session experience, both of which make the Markov assumption questionable. The second category, on the other hand, can consider the mutual influence of items, the intra-session user interest shift, and may even interact with users within the session. However, it is subject to the curse of dimensionality when serving all users simultaneously at a centralized server. It also has the sparse reward issue for an RL framework since the user response can not be observed by the agent until the end of the session. Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> indicates these two temporal patterns of listwise ranking.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="536" id="S1.F1.g1" src="x1.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Two levels of temporal abstractions in typical listwise recommendations. The user requests a session service at time <math alttext="t" class="ltx_Math" display="inline" id="S1.F1.3.m1.1"><semantics id="S1.F1.3.m1.1b"><mi id="S1.F1.3.m1.1.1" xref="S1.F1.3.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S1.F1.3.m1.1c"><ci id="S1.F1.3.m1.1.1.cmml" xref="S1.F1.3.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.3.m1.1d">t</annotation><annotation encoding="application/x-llamapun" id="S1.F1.3.m1.1e">italic_t</annotation></semantics></math>, then a ranking policy is executed <math alttext="k" class="ltx_Math" display="inline" id="S1.F1.4.m2.1"><semantics id="S1.F1.4.m2.1b"><mi id="S1.F1.4.m2.1.1" xref="S1.F1.4.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.F1.4.m2.1c"><ci id="S1.F1.4.m2.1.1.cmml" xref="S1.F1.4.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.m2.1d">k</annotation><annotation encoding="application/x-llamapun" id="S1.F1.4.m2.1e">italic_k</annotation></semantics></math> steps to provide a top-k recommendation.</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Here we aim to overcome the above obstacles through better temporal abstractions, by designing a fast-slow learning paradigm <cite class="ltx_cite ltx_citemacro_cite">Madan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib20" title="">2021</a>)</cite> of hierarchical reinforcement learning (HRL). Although there are some previous HRL-based RS efforts <cite class="ltx_cite ltx_citemacro_cite">Takanobu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib23" title="">2019</a>); Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib32" title="">2020</a>); Xie et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib29" title="">2021</a>)</cite>, they might focus on heterogeneous or multi-goal recommendation problems. Instead, we design our HRL such that one level encodes the user perception and outer-session context, while another level encodes the spatiotemporal status, intra-session context, and mutual-item influences. Besides that, we further improve the sample efficiency by applying Edge Computing or Edge-based AI <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib38" title="">2019b</a>)</cite> on our RS. With the rapid development of Edge Computing or Edge AI <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib38" title="">2019b</a>)</cite>, it is possible to utilize user features and feedback on mobile <cite class="ltx_cite ltx_citemacro_cite">Gong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib9" title="">2020</a>)</cite> or collaborative training with cloud <cite class="ltx_cite ltx_citemacro_cite">Yao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib30" title="">2021</a>); Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib5" title="">2021</a>)</cite> in recommendation. We embrace this benefit to further improve the modeling depth of user states and enhance the Markov assumption. We argue that the low-level HRL could be deployed on mobile devices, therefore the on-device features can be involved, training is decoupled, and the communication frequency of cloud service is reduced during model inference. Although this intuition belongs to the paradigm of collaborative training with mobile and cloud <cite class="ltx_cite ltx_citemacro_cite">Yao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib30" title="">2021</a>); Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib5" title="">2021</a>)</cite>, however, it is the first attempt that tries to train part of RL components on the edge side, to the best of our knowledge <cite class="ltx_cite ltx_citemacro_cite">Yao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib31" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we propose a novel methodology, named <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">mobile-cloud collaborative Hierarchical Reinforcement Learning</span> (mccHRL) for Listwise Recommendation, which employs HRL to solve a highly STA, listwise RS problem on a world-leading mobile application. The High-Level of mccHRL models the user perception and STA status, interacts with user responses at the end of session, and takes the suggested long-term user preference as action; while the Low-Level of mccHRL solves the listwise ranking problem, by providing an item selection policy based on user short-term interest and on-device features. The High-Level action is utilized as the goal of Low-Level policy to achieve, such that the Low-Level agent does not directly interact with user response. Embedding studied on the High-Level are transmitted to the Low-Level policy for knowledge transfer and generalization. Detailed implementation has been made public<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://anonymous.4open.science/r/eccHRL-F99B/</span></span></span>. To conclude, the major contributions of this paper include:</p>
</div>
<div class="ltx_para" id="S1.p5">
<ul class="ltx_itemize" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.1">We propose a novel HRL framework on listwise recommendation with a natural way of temporal abstractions. The High-Level agent studies the outra-session context (spatiotemporal effects) and directly interacts with users, while the Low-Level agent studies the intra-session context, intrinsically motivated by the high-level.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i2.p1">
<p class="ltx_p" id="S1.I2.i2.p1.1">We provide an explicit and detailed implementation of on-device features and cloud transmission latency in our framework. The HRL solves the mobile-cloud collaboration with its hierarchical architecture.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i3.p1">
<p class="ltx_p" id="S1.I2.i3.p1.1">Before the online deployment, we design two offline pipelines, including simulator-based and dataset-based experiments. We also develop the offline version of training algorithm and its performance is verified by industrial-scale experiments.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i4.p1">
<p class="ltx_p" id="S1.I2.i4.p1.1">We design and implement the realistic mobile-cloud recommendation environment in our experiments. On-device features, user one-device feedback, and mobile-cloud transmission delays are explicitly considered in an online studying manner, which is seldom practiced by previous edge-based recommendation studies.
</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The rest of the paper is organized as follows. The connection with previous works is first discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S2" title="2 Related Work ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>. Preliminaries and the problem formulation are then introduced in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S3" title="3 Preliminary and Problem Formulation ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. Our methodology and corresponding algorithms are stated in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4" title="4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. Experiment results are summarized in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5" title="5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>. Finally Section <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S7" title="7 Conclusion ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a> concludes this paper.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>RL-based Recommendation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">RL has been widely used in recommendation tasks, while their definitions of MDP can be diversified into two categories. The first categories models the user preference as state and recommendation the entire item list as action, such as <cite class="ltx_cite ltx_citemacro_cite">Zheng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib35" title="">2018</a>); Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib3" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib4" title="">2019</a>); Ie et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib11" title="">2019</a>)</cite>, in which the state transit depicts the user interest shift. On the other hand, the second category is to model the ranking steps of items as state, and the selection of the next favorite item is action. Such methods include MDPrank <cite class="ltx_cite ltx_citemacro_cite">Xia et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib28" title="">2017</a>); Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib26" title="">2017</a>)</cite>, Exact-K <cite class="ltx_cite ltx_citemacro_cite">Gong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib8" title="">2019</a>)</cite>, LIRD <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib34" title="">2019</a>)</cite> and DeepPage <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib33" title="">2018</a>)</cite>, which aims to model the mutual influence between items and listwise bias. The intuition of combining the advantages of two types of MDPs motivates our idea of mccHRL.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">There are also RL works aiming to fix some special recommendation issues, such as location or POI-based information <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib36" title="">2019a</a>)</cite>, cold start <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib25" title="">2020</a>)</cite>, heterogeneous items <cite class="ltx_cite ltx_citemacro_cite">Takanobu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib23" title="">2019</a>); Xie et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib29" title="">2021</a>)</cite>, user long-term engagement <cite class="ltx_cite ltx_citemacro_cite">Zou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib39" title="">2019</a>)</cite> or fairness of items <cite class="ltx_cite ltx_citemacro_cite">Ge et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib7" title="">2021</a>)</cite>. Our work shares similar interests to the POI-based recommendation with <cite class="ltx_cite ltx_citemacro_cite">Lian et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib16" title="">2020</a>); Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib36" title="">2019a</a>); Luo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib19" title="">2021</a>)</cite>. However, most of them work on the next-location recommendation given sparse spatial information, to learn a reasonable user-location relationship matrix, while we aim to provide an end-to-end solution of session recommendation with spatial information implicitly considered in our recommending policy.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Hierarchical Reinforcement Learning</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Hierarchical Reinforcement Learning (HRL) has a hierarchical structure of RL layers in order to solve more complex tasks, reduce the searching space, provide different levels of temporal abstractions, or deal with sparse rewards. HRL methods can be classified into two categories by the coordinated way between different levels. The first is the goal-conditional framework <cite class="ltx_cite ltx_citemacro_cite">Kulkarni et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib12" title="">2016</a>); Vezhnevets et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib24" title="">2017</a>); Nachum et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib21" title="">2018</a>); Levy et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib15" title="">2019</a>)</cite>, in which a high-level agent learns the goal to drive the low-level agent; the second is sub-task discovery framework, the high-level agent might provide some options (or skill) to reduce the search space of low-level agent <cite class="ltx_cite ltx_citemacro_cite">Bacon et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib2" title="">2017</a>); Florensa et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib6" title="">2017</a>)</cite>. Our methodology belongs to the first category in which the high-level agent studies the user perception embedding as the low-level agent decision basis.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">HRL methods also vary in hierarchical structures. Choices include multi-layer DQN <cite class="ltx_cite ltx_citemacro_cite">Kulkarni et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib12" title="">2016</a>)</cite>, multi-layer policy <cite class="ltx_cite ltx_citemacro_cite">Nachum et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib21" title="">2018</a>)</cite>, or multi-layer actor-critic <cite class="ltx_cite ltx_citemacro_cite">Levy et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib15" title="">2019</a>)</cite>. Our model is similar to hierarchical actor-critic (HAC) but reduces its complexity for practical edge deployment.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>HRL-based Recommendation</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">There are also attempts to apply Hierarchical Reinforcement Learning (HRL) on recommendation or search <cite class="ltx_cite ltx_citemacro_cite">Takanobu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib23" title="">2019</a>); Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib32" title="">2020</a>); Xie et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib29" title="">2021</a>)</cite>. <cite class="ltx_cite ltx_citemacro_cite">Takanobu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib23" title="">2019</a>)</cite> uses the High-Level RL as the heterogeneous search source selector; similarly, High-Level RL in HRL-rec <cite class="ltx_cite ltx_citemacro_cite">Xie et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib29" title="">2021</a>)</cite> is the content channel selector. MaHRL <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib32" title="">2020</a>)</cite> uses the High-Level RL to model the user perception state, to optimize multiple recommendation goals. All of these methods define the Low-Level RL as the item selector, which is similar to our framework. We have a similar definition of High-Level RL with MaHRL, however, our difference includes that (1) our target is to improve a session-based, STA recommendation CTR performance instead of multiple labels; (2) we provide a natural formulation of temporal abstraction to solve the sparse reward issue of listwise recommendation; (3) we deploy the Low-Level part of HRL on the edge side to further improve the methodology throughput.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Edge-based Recommendation</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">Edge Computing (might also be named Edge Intelligence, Edge AI, or on-device AI), in contrast to Cloud computing, has been widely studied recently years <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib38" title="">2019b</a>)</cite>. Efforts have been made on applications including IoT, 5G, and auto-driving. However, this field still is at its early stage with most efforts focusing on the lightweight and deployment of edge models <cite class="ltx_cite ltx_citemacro_cite">Yao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib31" title="">2022</a>)</cite>. For example, EdgeRec <cite class="ltx_cite ltx_citemacro_cite">Gong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib9" title="">2020</a>)</cite> works on the split-deployment which places the memory-consuming embedding module on the cloud while the lightweight recommender is inferenced on the device.</p>
</div>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.2">There has been increasing attention on Edge-Cloud collaboration, either privacy-primary such as Federated Learning, or efficient-primary. We are interested in efficient primary methods, to improve the recommender’s personalization. Such efforts including COLLA <cite class="ltx_cite ltx_citemacro_cite">Lu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib18" title="">2019</a>)</cite>, DCCL <cite class="ltx_cite ltx_citemacro_cite">Yao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib30" title="">2021</a>)</cite> and MC<sup class="ltx_sup" id="S2.SS4.p2.2.1">2</sup>-SF <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib5" title="">2021</a>)</cite>. For example, COLLA designed the cloud model as a global aggregator distilling knowledge from many edge models; MC<sup class="ltx_sup" id="S2.SS4.p2.2.2">2</sup>-SF proposes a slow-fast learning mechanism on RS, with the bidirectional collaboration between Edge and Cloud. However, edge-based RL has not been widely studied so far. Instead, RL is often utilized as an aside system to Edge Computing, to help service offloading, task scheduling, or resource allocation <cite class="ltx_cite ltx_citemacro_cite">Yao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib31" title="">2022</a>)</cite>. Therefore, our work can be regarded as the pioneering study on edge-based RL, with the slow-fast collaborative study mechanism between cloud and edge, similar to <cite class="ltx_cite ltx_citemacro_cite">Madan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib20" title="">2021</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib5" title="">2021</a>)</cite>. To differentiate from the traditional edge AI methods, we use the notation ‘mobile’ instead of ‘edge’ since most impressions of internet RS are on the users’ mobile devices (smartphones or pads).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminary and Problem Formulation</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">This section illustrates key concepts of our approach, including the system configuration, formulation, and detailed structure of mccHRL, as well as some necessary preliminaries.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Listwise Recommending Scenario</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.5">There is assumed to be a listwise recommendation task that exhibits <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_K</annotation></semantics></math> items upon each user query, in which the session length <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_K</annotation></semantics></math> is a pre-determined, fixed integer. User clicks response to exposed items within a session is then <math alttext="\mathbf{c}=\{c_{0},c_{1},\cdots,c_{K}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.4"><semantics id="S3.SS1.p1.3.m3.4a"><mrow id="S3.SS1.p1.3.m3.4.4" xref="S3.SS1.p1.3.m3.4.4.cmml"><mi id="S3.SS1.p1.3.m3.4.4.5" xref="S3.SS1.p1.3.m3.4.4.5.cmml">𝐜</mi><mo id="S3.SS1.p1.3.m3.4.4.4" xref="S3.SS1.p1.3.m3.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.4.4.3.3" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml"><mo id="S3.SS1.p1.3.m3.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.3.m3.2.2.1.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml">c</mi><mn id="S3.SS1.p1.3.m3.2.2.1.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS1.p1.3.m3.4.4.3.3.5" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.3.m3.3.3.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.3.3.2.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml">c</mi><mn id="S3.SS1.p1.3.m3.3.3.2.2.2.3" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.4.4.3.3.6" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS1.p1.3.m3.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.3.m3.4.4.3.3.7" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.3.m3.4.4.3.3.3" xref="S3.SS1.p1.3.m3.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.3.m3.4.4.3.3.3.2" xref="S3.SS1.p1.3.m3.4.4.3.3.3.2.cmml">c</mi><mi id="S3.SS1.p1.3.m3.4.4.3.3.3.3" xref="S3.SS1.p1.3.m3.4.4.3.3.3.3.cmml">K</mi></msub><mo id="S3.SS1.p1.3.m3.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.3.m3.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.4b"><apply id="S3.SS1.p1.3.m3.4.4.cmml" xref="S3.SS1.p1.3.m3.4.4"><eq id="S3.SS1.p1.3.m3.4.4.4.cmml" xref="S3.SS1.p1.3.m3.4.4.4"></eq><ci id="S3.SS1.p1.3.m3.4.4.5.cmml" xref="S3.SS1.p1.3.m3.4.4.5">𝐜</ci><set id="S3.SS1.p1.3.m3.4.4.3.4.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3"><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2">𝑐</ci><cn id="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3">0</cn></apply><apply id="S3.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2">𝑐</ci><cn id="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3">1</cn></apply><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">⋯</ci><apply id="S3.SS1.p1.3.m3.4.4.3.3.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3.2">𝑐</ci><ci id="S3.SS1.p1.3.m3.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3.3">𝐾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.4c">\mathbf{c}=\{c_{0},c_{1},\cdots,c_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.4d">bold_c = { italic_c start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , italic_c start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math> in which each <math alttext="c_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">c</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑐</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">c_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a binary variable, <math alttext="k\in[0,K]" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.2"><semantics id="S3.SS1.p1.5.m5.2a"><mrow id="S3.SS1.p1.5.m5.2.3" xref="S3.SS1.p1.5.m5.2.3.cmml"><mi id="S3.SS1.p1.5.m5.2.3.2" xref="S3.SS1.p1.5.m5.2.3.2.cmml">k</mi><mo id="S3.SS1.p1.5.m5.2.3.1" xref="S3.SS1.p1.5.m5.2.3.1.cmml">∈</mo><mrow id="S3.SS1.p1.5.m5.2.3.3.2" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml"><mo id="S3.SS1.p1.5.m5.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml">[</mo><mn id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">0</mn><mo id="S3.SS1.p1.5.m5.2.3.3.2.2" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.5.m5.2.2" xref="S3.SS1.p1.5.m5.2.2.cmml">K</mi><mo id="S3.SS1.p1.5.m5.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.5.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.2b"><apply id="S3.SS1.p1.5.m5.2.3.cmml" xref="S3.SS1.p1.5.m5.2.3"><in id="S3.SS1.p1.5.m5.2.3.1.cmml" xref="S3.SS1.p1.5.m5.2.3.1"></in><ci id="S3.SS1.p1.5.m5.2.3.2.cmml" xref="S3.SS1.p1.5.m5.2.3.2">𝑘</ci><interval closure="closed" id="S3.SS1.p1.5.m5.2.3.3.1.cmml" xref="S3.SS1.p1.5.m5.2.3.3.2"><cn id="S3.SS1.p1.5.m5.1.1.cmml" type="integer" xref="S3.SS1.p1.5.m5.1.1">0</cn><ci id="S3.SS1.p1.5.m5.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2">𝐾</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.2c">k\in[0,K]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.2d">italic_k ∈ [ 0 , italic_K ]</annotation></semantics></math>. The recommendation objective is generally to maximize the global session-wise click-through rate (CTR).</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2">We first encoder each item into the embedding vector <math alttext="e\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">e</mi><mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><in id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"></in><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝑒</ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">e\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_e ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>. Then a session recurrent encoder (SRE) is employed to encode the session’s historically exposed item sequence (We simply use the notation ‘historical sequence’ in the following contexts for briefly) into the same embedding space, <math alttext="l:=\{e_{0},e_{1},\cdots,e_{K}\}\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.4"><semantics id="S3.SS1.p2.2.m2.4a"><mrow id="S3.SS1.p2.2.m2.4.4" xref="S3.SS1.p2.2.m2.4.4.cmml"><mi id="S3.SS1.p2.2.m2.4.4.5" xref="S3.SS1.p2.2.m2.4.4.5.cmml">l</mi><mo id="S3.SS1.p2.2.m2.4.4.6" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p2.2.m2.4.4.6.cmml">:=</mo><mrow id="S3.SS1.p2.2.m2.4.4.3.3" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml"><mo id="S3.SS1.p2.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p2.2.m2.2.2.1.1.1" xref="S3.SS1.p2.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.2.2.1.1.1.2" xref="S3.SS1.p2.2.m2.2.2.1.1.1.2.cmml">e</mi><mn id="S3.SS1.p2.2.m2.2.2.1.1.1.3" xref="S3.SS1.p2.2.m2.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS1.p2.2.m2.4.4.3.3.5" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p2.2.m2.3.3.2.2.2" xref="S3.SS1.p2.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.2.m2.3.3.2.2.2.2" xref="S3.SS1.p2.2.m2.3.3.2.2.2.2.cmml">e</mi><mn id="S3.SS1.p2.2.m2.3.3.2.2.2.3" xref="S3.SS1.p2.2.m2.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS1.p2.2.m2.4.4.3.3.6" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p2.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p2.2.m2.1.1.cmml">⋯</mi><mo id="S3.SS1.p2.2.m2.4.4.3.3.7" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p2.2.m2.4.4.3.3.3" xref="S3.SS1.p2.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS1.p2.2.m2.4.4.3.3.3.2" xref="S3.SS1.p2.2.m2.4.4.3.3.3.2.cmml">e</mi><mi id="S3.SS1.p2.2.m2.4.4.3.3.3.3" xref="S3.SS1.p2.2.m2.4.4.3.3.3.3.cmml">K</mi></msub><mo id="S3.SS1.p2.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS1.p2.2.m2.4.4.3.4.cmml">}</mo></mrow><mo id="S3.SS1.p2.2.m2.4.4.7" xref="S3.SS1.p2.2.m2.4.4.7.cmml">∈</mo><msup id="S3.SS1.p2.2.m2.4.4.8" xref="S3.SS1.p2.2.m2.4.4.8.cmml"><mi id="S3.SS1.p2.2.m2.4.4.8.2" xref="S3.SS1.p2.2.m2.4.4.8.2.cmml">ℝ</mi><mi id="S3.SS1.p2.2.m2.4.4.8.3" xref="S3.SS1.p2.2.m2.4.4.8.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.4b"><apply id="S3.SS1.p2.2.m2.4.4.cmml" xref="S3.SS1.p2.2.m2.4.4"><and id="S3.SS1.p2.2.m2.4.4a.cmml" xref="S3.SS1.p2.2.m2.4.4"></and><apply id="S3.SS1.p2.2.m2.4.4b.cmml" xref="S3.SS1.p2.2.m2.4.4"><csymbol cd="latexml" id="S3.SS1.p2.2.m2.4.4.6.cmml" xref="S3.SS1.p2.2.m2.4.4.6">assign</csymbol><ci id="S3.SS1.p2.2.m2.4.4.5.cmml" xref="S3.SS1.p2.2.m2.4.4.5">𝑙</ci><set id="S3.SS1.p2.2.m2.4.4.3.4.cmml" xref="S3.SS1.p2.2.m2.4.4.3.3"><apply id="S3.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.2.2.1.1.1.2">𝑒</ci><cn id="S3.SS1.p2.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.2.2.1.1.1.3">0</cn></apply><apply id="S3.SS1.p2.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.3.3.2.2.2.2">𝑒</ci><cn id="S3.SS1.p2.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.3.3.2.2.2.3">1</cn></apply><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">⋯</ci><apply id="S3.SS1.p2.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.p2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS1.p2.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS1.p2.2.m2.4.4.3.3.3.2">𝑒</ci><ci id="S3.SS1.p2.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS1.p2.2.m2.4.4.3.3.3.3">𝐾</ci></apply></set></apply><apply id="S3.SS1.p2.2.m2.4.4c.cmml" xref="S3.SS1.p2.2.m2.4.4"><in id="S3.SS1.p2.2.m2.4.4.7.cmml" xref="S3.SS1.p2.2.m2.4.4.7"></in><share href="https://arxiv.org/html/2409.07416v1#S3.SS1.p2.2.m2.4.4.3.cmml" id="S3.SS1.p2.2.m2.4.4d.cmml" xref="S3.SS1.p2.2.m2.4.4"></share><apply id="S3.SS1.p2.2.m2.4.4.8.cmml" xref="S3.SS1.p2.2.m2.4.4.8"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.4.4.8.1.cmml" xref="S3.SS1.p2.2.m2.4.4.8">superscript</csymbol><ci id="S3.SS1.p2.2.m2.4.4.8.2.cmml" xref="S3.SS1.p2.2.m2.4.4.8.2">ℝ</ci><ci id="S3.SS1.p2.2.m2.4.4.8.3.cmml" xref="S3.SS1.p2.2.m2.4.4.8.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.4c">l:=\{e_{0},e_{1},\cdots,e_{K}\}\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.4d">italic_l := { italic_e start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , italic_e start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT } ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>. More details of SRE will be introduced in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.SS1" title="4.1 Session Recurrent Encoder ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.5">For personalization purpose, the user general profile, the user on-device feature, and the STA information are encoded into <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_u</annotation></semantics></math>, <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_m</annotation></semantics></math> and <math alttext="c^{o}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><msup id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">c</mi><mi id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">o</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">𝑐</ci><ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">c^{o}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT</annotation></semantics></math>. respectively. The superscript <math alttext="o" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">o</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">italic_o</annotation></semantics></math> denotes the outra-session context, to differentiate from the intra-session context (<math alttext="c^{i}" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m5.1"><semantics id="S3.SS1.p3.5.m5.1a"><msup id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml">c</mi><mi id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2">𝑐</ci><ci id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">c^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.1d">italic_c start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>) which is encoded inside the actor and will be mentioned in the later contexts.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Reinforcement Learning</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.13">Reinforcement Learning (RL) is an interactive learning technology that is generally built on Markov Decision Process (MDP). MDP can be represented with a four-tuple of <math alttext="\mathcal{M}_{t}:=(\mathcal{S},\mathcal{A},\mathcal{R},T)" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.4"><semantics id="S3.SS2.p1.1.m1.4a"><mrow id="S3.SS2.p1.1.m1.4.5" xref="S3.SS2.p1.1.m1.4.5.cmml"><msub id="S3.SS2.p1.1.m1.4.5.2" xref="S3.SS2.p1.1.m1.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.4.5.2.2" xref="S3.SS2.p1.1.m1.4.5.2.2.cmml">ℳ</mi><mi id="S3.SS2.p1.1.m1.4.5.2.3" xref="S3.SS2.p1.1.m1.4.5.2.3.cmml">t</mi></msub><mo id="S3.SS2.p1.1.m1.4.5.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p1.1.m1.4.5.1.cmml">:=</mo><mrow id="S3.SS2.p1.1.m1.4.5.3.2" xref="S3.SS2.p1.1.m1.4.5.3.1.cmml"><mo id="S3.SS2.p1.1.m1.4.5.3.2.1" stretchy="false" xref="S3.SS2.p1.1.m1.4.5.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">𝒮</mi><mo id="S3.SS2.p1.1.m1.4.5.3.2.2" xref="S3.SS2.p1.1.m1.4.5.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml">𝒜</mi><mo id="S3.SS2.p1.1.m1.4.5.3.2.3" xref="S3.SS2.p1.1.m1.4.5.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.3.3" xref="S3.SS2.p1.1.m1.3.3.cmml">ℛ</mi><mo id="S3.SS2.p1.1.m1.4.5.3.2.4" xref="S3.SS2.p1.1.m1.4.5.3.1.cmml">,</mo><mi id="S3.SS2.p1.1.m1.4.4" xref="S3.SS2.p1.1.m1.4.4.cmml">T</mi><mo id="S3.SS2.p1.1.m1.4.5.3.2.5" stretchy="false" xref="S3.SS2.p1.1.m1.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.4b"><apply id="S3.SS2.p1.1.m1.4.5.cmml" xref="S3.SS2.p1.1.m1.4.5"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.4.5.1.cmml" xref="S3.SS2.p1.1.m1.4.5.1">assign</csymbol><apply id="S3.SS2.p1.1.m1.4.5.2.cmml" xref="S3.SS2.p1.1.m1.4.5.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.5.2.1.cmml" xref="S3.SS2.p1.1.m1.4.5.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.4.5.2.2.cmml" xref="S3.SS2.p1.1.m1.4.5.2.2">ℳ</ci><ci id="S3.SS2.p1.1.m1.4.5.2.3.cmml" xref="S3.SS2.p1.1.m1.4.5.2.3">𝑡</ci></apply><vector id="S3.SS2.p1.1.m1.4.5.3.1.cmml" xref="S3.SS2.p1.1.m1.4.5.3.2"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝒮</ci><ci id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2">𝒜</ci><ci id="S3.SS2.p1.1.m1.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3">ℛ</ci><ci id="S3.SS2.p1.1.m1.4.4.cmml" xref="S3.SS2.p1.1.m1.4.4">𝑇</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.4c">\mathcal{M}_{t}:=(\mathcal{S},\mathcal{A},\mathcal{R},T)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.4d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT := ( caligraphic_S , caligraphic_A , caligraphic_R , italic_T )</annotation></semantics></math>, where <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">caligraphic_S</annotation></semantics></math> is the set of state <math alttext="s" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_s</annotation></semantics></math>, <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">caligraphic_A</annotation></semantics></math> is the set of action <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_a</annotation></semantics></math>, <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">caligraphic_R</annotation></semantics></math> is the set of reward <math alttext="r" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_r</annotation></semantics></math>, and <math alttext="T(s_{t+1}|s_{t},a_{t})" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><mrow id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">T</mi><mo id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.8.m8.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.8.m8.1.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.cmml"><msub id="S3.SS2.p1.8.m8.1.1.1.1.1.4" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.4.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4.2.cmml">s</mi><mrow id="S3.SS2.p1.8.m8.1.1.1.1.1.4.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.SS2.p1.8.m8.1.1.1.1.1.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS2.p1.8.m8.1.1.1.1.1.2.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.3.cmml"><msub id="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2.2" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2.3" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.SS2.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><times id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2"></times><ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">𝑇</ci><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.3">conditional</csymbol><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.4.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.1.1.4.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.4.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4.2">𝑠</ci><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4.3"><plus id="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.1"></plus><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.2">𝑡</ci><cn id="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S3.SS2.p1.8.m8.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S3.SS2.p1.8.m8.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.2"><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.p1.8.m8.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">T(s_{t+1}|s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">italic_T ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is the transition function of <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1"><semantics id="S3.SS2.p1.9.m9.1a"><msub id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml">s</mi><mrow id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml"><mi id="S3.SS2.p1.9.m9.1.1.3.2" xref="S3.SS2.p1.9.m9.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p1.9.m9.1.1.3.1" xref="S3.SS2.p1.9.m9.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p1.9.m9.1.1.3.3" xref="S3.SS2.p1.9.m9.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2">𝑠</ci><apply id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3"><plus id="S3.SS2.p1.9.m9.1.1.3.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.1"></plus><ci id="S3.SS2.p1.9.m9.1.1.3.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2">𝑡</ci><cn id="S3.SS2.p1.9.m9.1.1.3.3.cmml" type="integer" xref="S3.SS2.p1.9.m9.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> after executing <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m10.1"><semantics id="S3.SS2.p1.10.m10.1a"><msub id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><mi id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2.cmml">a</mi><mi id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2">𝑎</ci><ci id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m10.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> on <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m11.1"><semantics id="S3.SS2.p1.11.m11.1a"><msub id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml"><mi id="S3.SS2.p1.11.m11.1.1.2" xref="S3.SS2.p1.11.m11.1.1.2.cmml">s</mi><mi id="S3.SS2.p1.11.m11.1.1.3" xref="S3.SS2.p1.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><apply id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.p1.11.m11.1.1.2.cmml" xref="S3.SS2.p1.11.m11.1.1.2">𝑠</ci><ci id="S3.SS2.p1.11.m11.1.1.3.cmml" xref="S3.SS2.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m11.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. The subscript <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p1.12.m12.1"><semantics id="S3.SS2.p1.12.m12.1a"><mi id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><ci id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.12.m12.1d">italic_t</annotation></semantics></math> of <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS2.p1.13.m13.1"><semantics id="S3.SS2.p1.13.m13.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.13.m13.1.1" xref="S3.SS2.p1.13.m13.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m13.1b"><ci id="S3.SS2.p1.13.m13.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m13.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.13.m13.1d">caligraphic_M</annotation></semantics></math> works as the step indicator.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.4">RL optimizes a long-term objective which is defined as the discounted accumulated rewards <math alttext="J=\sum_{t=0}^{\infty}\gamma^{t}r_{t}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">J</mi><mo id="S3.SS2.p2.1.m1.1.1.1" rspace="0.111em" xref="S3.SS2.p2.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><msubsup id="S3.SS2.p2.1.m1.1.1.3.1" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml"><mo id="S3.SS2.p2.1.m1.1.1.3.1.2.2" xref="S3.SS2.p2.1.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p2.1.m1.1.1.3.1.2.3" xref="S3.SS2.p2.1.m1.1.1.3.1.2.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.1.2.3.2" xref="S3.SS2.p2.1.m1.1.1.3.1.2.3.2.cmml">t</mi><mo id="S3.SS2.p2.1.m1.1.1.3.1.2.3.1" xref="S3.SS2.p2.1.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p2.1.m1.1.1.3.1.2.3.3" xref="S3.SS2.p2.1.m1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mi id="S3.SS2.p2.1.m1.1.1.3.1.3" mathvariant="normal" xref="S3.SS2.p2.1.m1.1.1.3.1.3.cmml">∞</mi></msubsup><mrow id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml"><msup id="S3.SS2.p2.1.m1.1.1.3.2.2" xref="S3.SS2.p2.1.m1.1.1.3.2.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2.2.2" xref="S3.SS2.p2.1.m1.1.1.3.2.2.2.cmml">γ</mi><mi id="S3.SS2.p2.1.m1.1.1.3.2.2.3" xref="S3.SS2.p2.1.m1.1.1.3.2.2.3.cmml">t</mi></msup><mo id="S3.SS2.p2.1.m1.1.1.3.2.1" xref="S3.SS2.p2.1.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.SS2.p2.1.m1.1.1.3.2.3" xref="S3.SS2.p2.1.m1.1.1.3.2.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.3.2.cmml">r</mi><mi id="S3.SS2.p2.1.m1.1.1.3.2.3.3" xref="S3.SS2.p2.1.m1.1.1.3.2.3.3.cmml">t</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><eq id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"></eq><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐽</ci><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><apply id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1">superscript</csymbol><apply id="S3.SS2.p2.1.m1.1.1.3.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1">subscript</csymbol><sum id="S3.SS2.p2.1.m1.1.1.3.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1.2.2"></sum><apply id="S3.SS2.p2.1.m1.1.1.3.1.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1.2.3"><eq id="S3.SS2.p2.1.m1.1.1.3.1.2.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1.2.3.1"></eq><ci id="S3.SS2.p2.1.m1.1.1.3.1.2.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1.2.3.2">𝑡</ci><cn id="S3.SS2.p2.1.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.SS2.p2.1.m1.1.1.3.1.2.3.3">0</cn></apply></apply><infinity id="S3.SS2.p2.1.m1.1.1.3.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1.3"></infinity></apply><apply id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2"><times id="S3.SS2.p2.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.1"></times><apply id="S3.SS2.p2.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.2.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2.2">𝛾</ci><ci id="S3.SS2.p2.1.m1.1.1.3.2.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.2.3">𝑡</ci></apply><apply id="S3.SS2.p2.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.2.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.3.2">𝑟</ci><ci id="S3.SS2.p2.1.m1.1.1.3.2.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">J=\sum_{t=0}^{\infty}\gamma^{t}r_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_J = ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\gamma\in[0,1)" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.2"><semantics id="S3.SS2.p2.2.m2.2a"><mrow id="S3.SS2.p2.2.m2.2.3" xref="S3.SS2.p2.2.m2.2.3.cmml"><mi id="S3.SS2.p2.2.m2.2.3.2" xref="S3.SS2.p2.2.m2.2.3.2.cmml">γ</mi><mo id="S3.SS2.p2.2.m2.2.3.1" xref="S3.SS2.p2.2.m2.2.3.1.cmml">∈</mo><mrow id="S3.SS2.p2.2.m2.2.3.3.2" xref="S3.SS2.p2.2.m2.2.3.3.1.cmml"><mo id="S3.SS2.p2.2.m2.2.3.3.2.1" stretchy="false" xref="S3.SS2.p2.2.m2.2.3.3.1.cmml">[</mo><mn id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">0</mn><mo id="S3.SS2.p2.2.m2.2.3.3.2.2" xref="S3.SS2.p2.2.m2.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p2.2.m2.2.2" xref="S3.SS2.p2.2.m2.2.2.cmml">1</mn><mo id="S3.SS2.p2.2.m2.2.3.3.2.3" stretchy="false" xref="S3.SS2.p2.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.2b"><apply id="S3.SS2.p2.2.m2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.3"><in id="S3.SS2.p2.2.m2.2.3.1.cmml" xref="S3.SS2.p2.2.m2.2.3.1"></in><ci id="S3.SS2.p2.2.m2.2.3.2.cmml" xref="S3.SS2.p2.2.m2.2.3.2">𝛾</ci><interval closure="closed-open" id="S3.SS2.p2.2.m2.2.3.3.1.cmml" xref="S3.SS2.p2.2.m2.2.3.3.2"><cn id="S3.SS2.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p2.2.m2.1.1">0</cn><cn id="S3.SS2.p2.2.m2.2.2.cmml" type="integer" xref="S3.SS2.p2.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.2c">\gamma\in[0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.2d">italic_γ ∈ [ 0 , 1 )</annotation></semantics></math> is the discount factor. The goal of reinforcement learning is to learn a policy <math alttext="\pi(a|s)" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">π</mi><mo id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.3.m3.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.3.m3.1.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.2" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.SS2.p2.3.m3.1.1.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p2.3.m3.1.1.1.1.1.3" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S3.SS2.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><times id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2"></times><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝜋</ci><apply id="S3.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\pi(a|s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_π ( italic_a | italic_s )</annotation></semantics></math> which maximizes <math alttext="J" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">J</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_J</annotation></semantics></math>. In this work, we employ the classical model-free and off-policy algorithm called the Deep Deterministic Policy Gradient (DDPG) method <cite class="ltx_cite ltx_citemacro_cite">Lillicrap et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib17" title="">2016</a>)</cite> to solve this problem.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="424" id="S3.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The interaction procedure of mccHRL. I: Off-policy training of HRA, with external reward collected at the end of session. II: On-policy training of LRA, with intrinsic motivation from the goal. III: Goal initiates from the action of HRA, with a transit function provided by SRE implicitly along the session length.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Deep Deterministic Policy Gradient</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In this paper, we implement RL with a classical model-free and off-policy algorithm called the Deep Deterministic Policy Gradient (DDPG) method <cite class="ltx_cite ltx_citemacro_cite">Lillicrap et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib17" title="">2016</a>)</cite>. Here we briefly review its algorithmic details which is the basis of later derivation.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">The DDPG is borrowed to get the recommended score of the item (<em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.1.1">i.e.</em>, action) and the long-term estimate return (<em class="ltx_emph ltx_font_italic" id="S3.SS3.p2.1.2">i.e.</em>, Q-value).</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">DDPG has a typical actor-critic architecture in which the actor is the parametric policy network <math alttext="\pi_{\theta}(a|s)" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><msub id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.2" xref="S3.SS3.p3.1.m1.1.1.3.2.cmml">π</mi><mi id="S3.SS3.p3.1.m1.1.1.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.1.m1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.1.m1.1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S3.SS3.p3.1.m1.1.1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p3.1.m1.1.1.1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S3.SS3.p3.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><times id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2"></times><apply id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2">𝜋</ci><ci id="S3.SS3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\pi_{\theta}(a|s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_s )</annotation></semantics></math> while the critic is a state-action value function</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q_{w}(s,a)=\sum_{i=t}^{\infty}\gamma^{i-t}E(r_{i}|s_{t}=s,a_{t}=a)" class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><mrow id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml"><msub id="S3.E1.m1.3.3.3.2" xref="S3.E1.m1.3.3.3.2.cmml"><mi id="S3.E1.m1.3.3.3.2.2" xref="S3.E1.m1.3.3.3.2.2.cmml">Q</mi><mi id="S3.E1.m1.3.3.3.2.3" xref="S3.E1.m1.3.3.3.2.3.cmml">w</mi></msub><mo id="S3.E1.m1.3.3.3.1" xref="S3.E1.m1.3.3.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.3.3.2" xref="S3.E1.m1.3.3.3.3.1.cmml"><mo id="S3.E1.m1.3.3.3.3.2.1" stretchy="false" xref="S3.E1.m1.3.3.3.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">s</mi><mo id="S3.E1.m1.3.3.3.3.2.2" xref="S3.E1.m1.3.3.3.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">a</mi><mo id="S3.E1.m1.3.3.3.3.2.3" stretchy="false" xref="S3.E1.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.2" rspace="0.111em" xref="S3.E1.m1.3.3.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.cmml"><munderover id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.2.cmml"><mo id="S3.E1.m1.3.3.1.2.2.2" movablelimits="false" xref="S3.E1.m1.3.3.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.1.2.2.3" xref="S3.E1.m1.3.3.1.2.2.3.cmml"><mi id="S3.E1.m1.3.3.1.2.2.3.2" xref="S3.E1.m1.3.3.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.2.2.3.1" xref="S3.E1.m1.3.3.1.2.2.3.1.cmml">=</mo><mi id="S3.E1.m1.3.3.1.2.2.3.3" xref="S3.E1.m1.3.3.1.2.2.3.3.cmml">t</mi></mrow><mi id="S3.E1.m1.3.3.1.2.3" mathvariant="normal" xref="S3.E1.m1.3.3.1.2.3.cmml">∞</mi></munderover><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><msup id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml">γ</mi><mrow id="S3.E1.m1.3.3.1.1.3.3" xref="S3.E1.m1.3.3.1.1.3.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.3.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.3.3.1" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">−</mo><mi id="S3.E1.m1.3.3.1.1.3.3.3" xref="S3.E1.m1.3.3.1.1.3.3.3.cmml">t</mi></mrow></msup><mo id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.4" xref="S3.E1.m1.3.3.1.1.4.cmml">E</mi><mo id="S3.E1.m1.3.3.1.1.2a" xref="S3.E1.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">r</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo fence="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.2.2.1" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.1.cmml">=</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.3.cmml">a</mi></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><eq id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2"></eq><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"><times id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.1"></times><apply id="S3.E1.m1.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.2.1.cmml" xref="S3.E1.m1.3.3.3.2">subscript</csymbol><ci id="S3.E1.m1.3.3.3.2.2.cmml" xref="S3.E1.m1.3.3.3.2.2">𝑄</ci><ci id="S3.E1.m1.3.3.3.2.3.cmml" xref="S3.E1.m1.3.3.3.2.3">𝑤</ci></apply><interval closure="open" id="S3.E1.m1.3.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑠</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑎</ci></interval></apply><apply id="S3.E1.m1.3.3.1.cmml" xref="S3.E1.m1.3.3.1"><apply id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.2.1.cmml" xref="S3.E1.m1.3.3.1.2">superscript</csymbol><apply id="S3.E1.m1.3.3.1.2.2.cmml" xref="S3.E1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.2">subscript</csymbol><sum id="S3.E1.m1.3.3.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.2.2.2"></sum><apply id="S3.E1.m1.3.3.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.2.2.3"><eq id="S3.E1.m1.3.3.1.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.2.2.3.1"></eq><ci id="S3.E1.m1.3.3.1.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.2.2.3.2">𝑖</ci><ci id="S3.E1.m1.3.3.1.2.2.3.3.cmml" xref="S3.E1.m1.3.3.1.2.2.3.3">𝑡</ci></apply></apply><infinity id="S3.E1.m1.3.3.1.2.3.cmml" xref="S3.E1.m1.3.3.1.2.3"></infinity></apply><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1"><times id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></times><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2">𝛾</ci><apply id="S3.E1.m1.3.3.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3"><minus id="S3.E1.m1.3.3.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1"></minus><ci id="S3.E1.m1.3.3.1.1.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2">𝑖</ci><ci id="S3.E1.m1.3.3.1.1.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3">𝑡</ci></apply></apply><ci id="S3.E1.m1.3.3.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.4">𝐸</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.3a.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><eq id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1"></eq><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.1">conditional</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.2">𝑟</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2"><eq id="S3.E1.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.1"></eq><apply id="S3.E1.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.2.3">𝑡</ci></apply><ci id="S3.E1.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.3">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">Q_{w}(s,a)=\sum_{i=t}^{\infty}\gamma^{i-t}E(r_{i}|s_{t}=s,a_{t}=a)</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_s , italic_a ) = ∑ start_POSTSUBSCRIPT italic_i = italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_i - italic_t end_POSTSUPERSCRIPT italic_E ( italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_s , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.5">in which <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m1.1"><semantics id="S3.SS3.p3.2.m1.1a"><mi id="S3.SS3.p3.2.m1.1.1" xref="S3.SS3.p3.2.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m1.1b"><ci id="S3.SS3.p3.2.m1.1.1.cmml" xref="S3.SS3.p3.2.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m1.1d">italic_θ</annotation></semantics></math> and <math alttext="w" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m2.1"><semantics id="S3.SS3.p3.3.m2.1a"><mi id="S3.SS3.p3.3.m2.1.1" xref="S3.SS3.p3.3.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m2.1b"><ci id="S3.SS3.p3.3.m2.1.1.cmml" xref="S3.SS3.p3.3.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m2.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m2.1d">italic_w</annotation></semantics></math> are trainable parameters. DDPG also keeps a target actor and a target cricic network with their trainable parameters <math alttext="\theta^{{}^{\prime}}" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m3.1"><semantics id="S3.SS3.p3.4.m3.1a"><msup id="S3.SS3.p3.4.m3.1.1" xref="S3.SS3.p3.4.m3.1.1.cmml"><mi id="S3.SS3.p3.4.m3.1.1.2" xref="S3.SS3.p3.4.m3.1.1.2.cmml">θ</mi><msup id="S3.SS3.p3.4.m3.1.1.3" xref="S3.SS3.p3.4.m3.1.1.3.cmml"><mi id="S3.SS3.p3.4.m3.1.1.3a" xref="S3.SS3.p3.4.m3.1.1.3.cmml"></mi><mo id="S3.SS3.p3.4.m3.1.1.3.1" xref="S3.SS3.p3.4.m3.1.1.3.1.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m3.1b"><apply id="S3.SS3.p3.4.m3.1.1.cmml" xref="S3.SS3.p3.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m3.1.1.1.cmml" xref="S3.SS3.p3.4.m3.1.1">superscript</csymbol><ci id="S3.SS3.p3.4.m3.1.1.2.cmml" xref="S3.SS3.p3.4.m3.1.1.2">𝜃</ci><apply id="S3.SS3.p3.4.m3.1.1.3.cmml" xref="S3.SS3.p3.4.m3.1.1.3"><ci id="S3.SS3.p3.4.m3.1.1.3.1.cmml" xref="S3.SS3.p3.4.m3.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m3.1c">\theta^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m3.1d">italic_θ start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="w^{{}^{\prime}}" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m4.1"><semantics id="S3.SS3.p3.5.m4.1a"><msup id="S3.SS3.p3.5.m4.1.1" xref="S3.SS3.p3.5.m4.1.1.cmml"><mi id="S3.SS3.p3.5.m4.1.1.2" xref="S3.SS3.p3.5.m4.1.1.2.cmml">w</mi><msup id="S3.SS3.p3.5.m4.1.1.3" xref="S3.SS3.p3.5.m4.1.1.3.cmml"><mi id="S3.SS3.p3.5.m4.1.1.3a" xref="S3.SS3.p3.5.m4.1.1.3.cmml"></mi><mo id="S3.SS3.p3.5.m4.1.1.3.1" xref="S3.SS3.p3.5.m4.1.1.3.1.cmml">′</mo></msup></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m4.1b"><apply id="S3.SS3.p3.5.m4.1.1.cmml" xref="S3.SS3.p3.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m4.1.1.1.cmml" xref="S3.SS3.p3.5.m4.1.1">superscript</csymbol><ci id="S3.SS3.p3.5.m4.1.1.2.cmml" xref="S3.SS3.p3.5.m4.1.1.2">𝑤</ci><apply id="S3.SS3.p3.5.m4.1.1.3.cmml" xref="S3.SS3.p3.5.m4.1.1.3"><ci id="S3.SS3.p3.5.m4.1.1.3.1.cmml" xref="S3.SS3.p3.5.m4.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m4.1c">w^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m4.1d">italic_w start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as instead.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">With target networks fixed, <math alttext="w" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">italic_w</annotation></semantics></math> can be updated by minimizing</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="y_{t}=r_{t}+\gamma Q_{w^{{}^{\prime}}}(s_{t+1},\pi_{\theta^{{}^{\prime}}}(s_{t%
+1}))" class="ltx_Math" display="block" id="S3.E2.m1.2"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><msub id="S3.E2.m1.2.2.4" xref="S3.E2.m1.2.2.4.cmml"><mi id="S3.E2.m1.2.2.4.2" xref="S3.E2.m1.2.2.4.2.cmml">y</mi><mi id="S3.E2.m1.2.2.4.3" xref="S3.E2.m1.2.2.4.3.cmml">t</mi></msub><mo id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml">=</mo><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><msub id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.4.cmml"><mi id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.2.cmml">r</mi><mi id="S3.E2.m1.2.2.2.4.3" xref="S3.E2.m1.2.2.2.4.3.cmml">t</mi></msub><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">+</mo><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.4.cmml">γ</mi><mo id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml">⁢</mo><msub id="S3.E2.m1.2.2.2.2.5" xref="S3.E2.m1.2.2.2.2.5.cmml"><mi id="S3.E2.m1.2.2.2.2.5.2" xref="S3.E2.m1.2.2.2.2.5.2.cmml">Q</mi><msup id="S3.E2.m1.2.2.2.2.5.3" xref="S3.E2.m1.2.2.2.2.5.3.cmml"><mi id="S3.E2.m1.2.2.2.2.5.3.2" xref="S3.E2.m1.2.2.2.2.5.3.2.cmml">w</mi><msup id="S3.E2.m1.2.2.2.2.5.3.3" xref="S3.E2.m1.2.2.2.2.5.3.3.cmml"><mi id="S3.E2.m1.2.2.2.2.5.3.3a" xref="S3.E2.m1.2.2.2.2.5.3.3.cmml"></mi><mo id="S3.E2.m1.2.2.2.2.5.3.3.1" xref="S3.E2.m1.2.2.2.2.5.3.3.1.cmml">′</mo></msup></msup></msub><mo id="S3.E2.m1.2.2.2.2.3a" xref="S3.E2.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.3.cmml"><mo id="S3.E2.m1.2.2.2.2.2.2.3" stretchy="false" xref="S3.E2.m1.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E2.m1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E2.m1.2.2.2.2.2.2.4" xref="S3.E2.m1.2.2.2.2.2.3.cmml">,</mo><mrow id="S3.E2.m1.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.cmml"><msub id="S3.E2.m1.2.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.2.2.2.3.2.cmml">π</mi><msup id="S3.E2.m1.2.2.2.2.2.2.2.3.3" xref="S3.E2.m1.2.2.2.2.2.2.2.3.3.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2.3.3.2" xref="S3.E2.m1.2.2.2.2.2.2.2.3.3.2.cmml">θ</mi><msup id="S3.E2.m1.2.2.2.2.2.2.2.3.3.3" xref="S3.E2.m1.2.2.2.2.2.2.2.3.3.3.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2.3.3.3a" xref="S3.E2.m1.2.2.2.2.2.2.2.3.3.3.cmml"></mi><mo id="S3.E2.m1.2.2.2.2.2.2.2.3.3.3.1" xref="S3.E2.m1.2.2.2.2.2.2.2.3.3.3.1.cmml">′</mo></msup></msup></msub><mo id="S3.E2.m1.2.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.2.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.cmml"><mo id="S3.E2.m1.2.2.2.2.2.2.2.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.2" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.2.cmml">s</mi><mrow id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.2" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.2.cmml">t</mi><mo id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.1" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.1.cmml">+</mo><mn id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.3" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E2.m1.2.2.2.2.2.2.2.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.2.2.2.2.5" stretchy="false" xref="S3.E2.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><eq id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3"></eq><apply id="S3.E2.m1.2.2.4.cmml" xref="S3.E2.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.4.1.cmml" xref="S3.E2.m1.2.2.4">subscript</csymbol><ci id="S3.E2.m1.2.2.4.2.cmml" xref="S3.E2.m1.2.2.4.2">𝑦</ci><ci id="S3.E2.m1.2.2.4.3.cmml" xref="S3.E2.m1.2.2.4.3">𝑡</ci></apply><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><plus id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3"></plus><apply id="S3.E2.m1.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4">subscript</csymbol><ci id="S3.E2.m1.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.4.2">𝑟</ci><ci id="S3.E2.m1.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.4.3">𝑡</ci></apply><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><times id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3"></times><ci id="S3.E2.m1.2.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.2.4">𝛾</ci><apply id="S3.E2.m1.2.2.2.2.5.cmml" xref="S3.E2.m1.2.2.2.2.5"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.5.1.cmml" xref="S3.E2.m1.2.2.2.2.5">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.5.2.cmml" xref="S3.E2.m1.2.2.2.2.5.2">𝑄</ci><apply id="S3.E2.m1.2.2.2.2.5.3.cmml" xref="S3.E2.m1.2.2.2.2.5.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.5.3.1.cmml" xref="S3.E2.m1.2.2.2.2.5.3">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.5.3.2.cmml" xref="S3.E2.m1.2.2.2.2.5.3.2">𝑤</ci><apply id="S3.E2.m1.2.2.2.2.5.3.3.cmml" xref="S3.E2.m1.2.2.2.2.5.3.3"><ci id="S3.E2.m1.2.2.2.2.5.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.5.3.3.1">′</ci></apply></apply></apply><interval closure="open" id="S3.E2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3"><plus id="S3.E2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.1"></plus><ci id="S3.E2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E2.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2"><times id="S3.E2.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2"></times><apply id="S3.E2.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.3.2">𝜋</ci><apply id="S3.E2.m1.2.2.2.2.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.2.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.3.3">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.2.3.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.3.3.2">𝜃</ci><apply id="S3.E2.m1.2.2.2.2.2.2.2.3.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.3.3.3"><ci id="S3.E2.m1.2.2.2.2.2.2.2.3.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.3.3.3.1">′</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.2">𝑠</ci><apply id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3"><plus id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.1"></plus><ci id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.2">𝑡</ci><cn id="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.3.cmml" type="integer" xref="S3.E2.m1.2.2.2.2.2.2.2.1.1.1.3.3">1</cn></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">y_{t}=r_{t}+\gamma Q_{w^{{}^{\prime}}}(s_{t+1},\pi_{\theta^{{}^{\prime}}}(s_{t%
+1}))</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.2d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_γ italic_Q start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p4.2">then <math alttext="w" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m1.1"><semantics id="S3.SS3.p4.2.m1.1a"><mi id="S3.SS3.p4.2.m1.1.1" xref="S3.SS3.p4.2.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m1.1b"><ci id="S3.SS3.p4.2.m1.1.1.cmml" xref="S3.SS3.p4.2.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m1.1d">italic_w</annotation></semantics></math> is updated by minimizing</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small L=\mathbb{E}_{s\backsim d^{\pi}}(r_{t}+\gamma Q_{w^{{}^{\prime}}}(s_{t+%
1},\pi_{\theta^{{}^{\prime}}}(s_{t+1}))-Q_{w}(s_{t},\pi_{\theta}(s_{t})))^{2}" class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mi id="S3.E3.m1.1.1.3" mathsize="90%" xref="S3.E3.m1.1.1.3.cmml">L</mi><mo id="S3.E3.m1.1.1.2" mathsize="90%" xref="S3.E3.m1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.3.2" mathsize="90%" xref="S3.E3.m1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E3.m1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.1.1.1.3.3.2" mathsize="90%" xref="S3.E3.m1.1.1.1.3.3.2.cmml">s</mi><mo id="S3.E3.m1.1.1.1.3.3.1" mathsize="90%" xref="S3.E3.m1.1.1.1.3.3.1.cmml">∽</mo><msup id="S3.E3.m1.1.1.1.3.3.3" xref="S3.E3.m1.1.1.1.3.3.3.cmml"><mi id="S3.E3.m1.1.1.1.3.3.3.2" mathsize="90%" xref="S3.E3.m1.1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.E3.m1.1.1.1.3.3.3.3" mathsize="90%" xref="S3.E3.m1.1.1.1.3.3.3.3.cmml">π</mi></msup></mrow></msub><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">⁢</mo><msup id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.1.2.4" xref="S3.E3.m1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.4.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.4.2.cmml">r</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.4.3" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.4.3.cmml">t</mi></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3.cmml">+</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.2.4" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.4.cmml">γ</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.3.cmml">⁢</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.2.cmml">Q</mi><msup id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.2.cmml">w</mi><msup id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.3a" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.3.cmml"></mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.3.1" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.3.1.cmml">′</mo></msup></msup></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.2.3a" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.3" maxsize="90%" minsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.4" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.2.cmml">π</mi><msup id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.2.cmml">θ</mi><msup id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.3a" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.3.cmml"></mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.3.1" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.3.1.cmml">′</mo></msup></msup></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.2" maxsize="90%" minsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.2.cmml">s</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.2.cmml">t</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.1" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.1.cmml">+</mo><mn id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.3" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.3" maxsize="90%" minsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.5" maxsize="90%" minsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.5" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.5.cmml">−</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.1.1.1.4.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.1.4.4" xref="S3.E3.m1.1.1.1.1.1.1.1.4.4.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.4.4.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.4.4.2.cmml">Q</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.4.4.3" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.4.4.3.cmml">w</mi></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.4.3" xref="S3.E3.m1.1.1.1.1.1.1.1.4.3.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.3.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.3" maxsize="90%" minsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.3.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1.2.cmml">s</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1.3" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1.3.cmml">t</mi></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.4" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.3.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3.2.cmml">π</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3.3" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3.3.cmml">θ</mi></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.2" maxsize="90%" minsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.cmml">s</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3" mathsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.3" maxsize="90%" minsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.5" maxsize="90%" minsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E3.m1.1.1.1.1.3" mathsize="90%" xref="S3.E3.m1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"></eq><ci id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3">𝐿</ci><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><times id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></times><apply id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.3.2">𝔼</ci><apply id="S3.E3.m1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3"><ci id="S3.E3.m1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.1.3.3.1">∽</ci><ci id="S3.E3.m1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.1.3.3.2">𝑠</ci><apply id="S3.E3.m1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.3.3.3.1.cmml" xref="S3.E3.m1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E3.m1.1.1.1.3.3.3.2.cmml" xref="S3.E3.m1.1.1.1.3.3.3.2">𝑑</ci><ci id="S3.E3.m1.1.1.1.3.3.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3.3.3">𝜋</ci></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><minus id="S3.E3.m1.1.1.1.1.1.1.1.5.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.5"></minus><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2"><plus id="S3.E3.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.3"></plus><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.4.2">𝑟</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.4.3">𝑡</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2"><times id="S3.E3.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.3"></times><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.2.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.4">𝛾</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.2">𝑄</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.2">𝑤</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.3"><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.5.3.3.1">′</ci></apply></apply></apply><interval closure="open" id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2"><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><plus id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2"><times id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.2"></times><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.2">𝜋</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.2">𝜃</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.3"><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.3.3.3.1">′</ci></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.2">𝑠</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3"><plus id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.1"></plus><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.2">𝑡</ci><cn id="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.1.1.1.3.3">1</cn></apply></apply></apply></interval></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4"><times id="S3.E3.m1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.3"></times><apply id="S3.E3.m1.1.1.1.1.1.1.1.4.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.4.4.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.4">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.4.4.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.4.2">𝑄</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.4.4.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.4.3">𝑤</ci></apply><interval closure="open" id="S3.E3.m1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2"><apply id="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1.2">𝑠</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.1.1.1.3">𝑡</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2"><times id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.2"></times><apply id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3.2">𝜋</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.3.3">𝜃</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2">𝑠</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3">𝑡</ci></apply></apply></interval></apply></apply><cn id="S3.E3.m1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\small L=\mathbb{E}_{s\backsim d^{\pi}}(r_{t}+\gamma Q_{w^{{}^{\prime}}}(s_{t+%
1},\pi_{\theta^{{}^{\prime}}}(s_{t+1}))-Q_{w}(s_{t},\pi_{\theta}(s_{t})))^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">italic_L = blackboard_E start_POSTSUBSCRIPT italic_s ∽ italic_d start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_γ italic_Q start_POSTSUBSCRIPT italic_w start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) ) - italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p4.3">which is the famous Bellman Equation. <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS3.p4.3.m1.1"><semantics id="S3.SS3.p4.3.m1.1a"><mi id="S3.SS3.p4.3.m1.1.1" xref="S3.SS3.p4.3.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m1.1b"><ci id="S3.SS3.p4.3.m1.1.1.cmml" xref="S3.SS3.p4.3.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m1.1d">italic_θ</annotation></semantics></math> is updated by the policy gradient</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\triangledown_{\theta}J=\mathbb{E}_{s\backsim d^{\pi}}\triangledown_{a}Q_{w}(s%
,a)|_{a=\pi_{\theta}(s)}\triangledown_{\theta}\pi_{\theta}(s)" class="ltx_Math" display="block" id="S3.E4.m1.5"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml"><mrow id="S3.E4.m1.5.5.3" xref="S3.E4.m1.5.5.3.cmml"><msub id="S3.E4.m1.5.5.3.2" xref="S3.E4.m1.5.5.3.2.cmml"><mi id="S3.E4.m1.5.5.3.2.2" mathvariant="normal" xref="S3.E4.m1.5.5.3.2.2.cmml">▽</mi><mi id="S3.E4.m1.5.5.3.2.3" xref="S3.E4.m1.5.5.3.2.3.cmml">θ</mi></msub><mo id="S3.E4.m1.5.5.3.1" xref="S3.E4.m1.5.5.3.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.3.3" xref="S3.E4.m1.5.5.3.3.cmml">J</mi></mrow><mo id="S3.E4.m1.5.5.2" xref="S3.E4.m1.5.5.2.cmml">=</mo><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.cmml"><msub id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.2.cmml"><mrow id="S3.E4.m1.5.5.1.1.1.1" xref="S3.E4.m1.5.5.1.1.2.cmml"><mrow id="S3.E4.m1.5.5.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.cmml"><msub id="S3.E4.m1.5.5.1.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.2.2" xref="S3.E4.m1.5.5.1.1.1.1.1.2.2.cmml">𝔼</mi><mrow id="S3.E4.m1.5.5.1.1.1.1.1.2.3" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.2.3.2" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.2.cmml">s</mi><mo id="S3.E4.m1.5.5.1.1.1.1.1.2.3.1" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.1.cmml">∽</mo><msup id="S3.E4.m1.5.5.1.1.1.1.1.2.3.3" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.2.3.3.2" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.3.2.cmml">d</mi><mi id="S3.E4.m1.5.5.1.1.1.1.1.2.3.3.3" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.3.3.cmml">π</mi></msup></mrow></msub><mo id="S3.E4.m1.5.5.1.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E4.m1.5.5.1.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.E4.m1.5.5.1.1.1.1.1.3.2.cmml">▽</mi><mi id="S3.E4.m1.5.5.1.1.1.1.1.3.3" xref="S3.E4.m1.5.5.1.1.1.1.1.3.3.cmml">a</mi></msub><mo id="S3.E4.m1.5.5.1.1.1.1.1.1a" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E4.m1.5.5.1.1.1.1.1.4" xref="S3.E4.m1.5.5.1.1.1.1.1.4.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.4.2" xref="S3.E4.m1.5.5.1.1.1.1.1.4.2.cmml">Q</mi><mi id="S3.E4.m1.5.5.1.1.1.1.1.4.3" xref="S3.E4.m1.5.5.1.1.1.1.1.4.3.cmml">w</mi></msub><mo id="S3.E4.m1.5.5.1.1.1.1.1.1b" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.1.1.1.5.2" xref="S3.E4.m1.5.5.1.1.1.1.1.5.1.cmml"><mo id="S3.E4.m1.5.5.1.1.1.1.1.5.2.1" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.1.5.1.cmml">(</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">s</mi><mo id="S3.E4.m1.5.5.1.1.1.1.1.5.2.2" xref="S3.E4.m1.5.5.1.1.1.1.1.5.1.cmml">,</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">a</mi><mo id="S3.E4.m1.5.5.1.1.1.1.1.5.2.3" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.1.5.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml">a</mi><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.4" xref="S3.E4.m1.1.1.1.4.cmml"><msub id="S3.E4.m1.1.1.1.4.2" xref="S3.E4.m1.1.1.1.4.2.cmml"><mi id="S3.E4.m1.1.1.1.4.2.2" xref="S3.E4.m1.1.1.1.4.2.2.cmml">π</mi><mi id="S3.E4.m1.1.1.1.4.2.3" xref="S3.E4.m1.1.1.1.4.2.3.cmml">θ</mi></msub><mo id="S3.E4.m1.1.1.1.4.1" xref="S3.E4.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.4.3.2" xref="S3.E4.m1.1.1.1.4.cmml"><mo id="S3.E4.m1.1.1.1.4.3.2.1" stretchy="false" xref="S3.E4.m1.1.1.1.4.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">s</mi><mo id="S3.E4.m1.1.1.1.4.3.2.2" stretchy="false" xref="S3.E4.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.2.cmml">⁢</mo><msub id="S3.E4.m1.5.5.1.3" xref="S3.E4.m1.5.5.1.3.cmml"><mi id="S3.E4.m1.5.5.1.3.2" mathvariant="normal" xref="S3.E4.m1.5.5.1.3.2.cmml">▽</mi><mi id="S3.E4.m1.5.5.1.3.3" xref="S3.E4.m1.5.5.1.3.3.cmml">θ</mi></msub><mo id="S3.E4.m1.5.5.1.2a" xref="S3.E4.m1.5.5.1.2.cmml">⁢</mo><msub id="S3.E4.m1.5.5.1.4" xref="S3.E4.m1.5.5.1.4.cmml"><mi id="S3.E4.m1.5.5.1.4.2" xref="S3.E4.m1.5.5.1.4.2.cmml">π</mi><mi id="S3.E4.m1.5.5.1.4.3" xref="S3.E4.m1.5.5.1.4.3.cmml">θ</mi></msub><mo id="S3.E4.m1.5.5.1.2b" xref="S3.E4.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.5.2" xref="S3.E4.m1.5.5.1.cmml"><mo id="S3.E4.m1.5.5.1.5.2.1" stretchy="false" xref="S3.E4.m1.5.5.1.cmml">(</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">s</mi><mo id="S3.E4.m1.5.5.1.5.2.2" stretchy="false" xref="S3.E4.m1.5.5.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5"><eq id="S3.E4.m1.5.5.2.cmml" xref="S3.E4.m1.5.5.2"></eq><apply id="S3.E4.m1.5.5.3.cmml" xref="S3.E4.m1.5.5.3"><times id="S3.E4.m1.5.5.3.1.cmml" xref="S3.E4.m1.5.5.3.1"></times><apply id="S3.E4.m1.5.5.3.2.cmml" xref="S3.E4.m1.5.5.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.3.2.1.cmml" xref="S3.E4.m1.5.5.3.2">subscript</csymbol><ci id="S3.E4.m1.5.5.3.2.2.cmml" xref="S3.E4.m1.5.5.3.2.2">▽</ci><ci id="S3.E4.m1.5.5.3.2.3.cmml" xref="S3.E4.m1.5.5.3.2.3">𝜃</ci></apply><ci id="S3.E4.m1.5.5.3.3.cmml" xref="S3.E4.m1.5.5.3.3">𝐽</ci></apply><apply id="S3.E4.m1.5.5.1.cmml" xref="S3.E4.m1.5.5.1"><times id="S3.E4.m1.5.5.1.2.cmml" xref="S3.E4.m1.5.5.1.2"></times><apply id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.5.5.1.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.2">evaluated-at</csymbol><apply id="S3.E4.m1.5.5.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1"><times id="S3.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1"></times><apply id="S3.E4.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2.2">𝔼</ci><apply id="S3.E4.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3"><ci id="S3.E4.m1.5.5.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.1">∽</ci><ci id="S3.E4.m1.5.5.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.2">𝑠</ci><apply id="S3.E4.m1.5.5.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.3">superscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.3.2">𝑑</ci><ci id="S3.E4.m1.5.5.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.2.3.3.3">𝜋</ci></apply></apply></apply><apply id="S3.E4.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.3.2">▽</ci><ci id="S3.E4.m1.5.5.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.3.3">𝑎</ci></apply><apply id="S3.E4.m1.5.5.1.1.1.1.1.4.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.1.1.4.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.1.4.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.4.2">𝑄</ci><ci id="S3.E4.m1.5.5.1.1.1.1.1.4.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.4.3">𝑤</ci></apply><interval closure="open" id="S3.E4.m1.5.5.1.1.1.1.1.5.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.5.2"><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑠</ci><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝑎</ci></interval></apply><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></eq><ci id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3">𝑎</ci><apply id="S3.E4.m1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.4"><times id="S3.E4.m1.1.1.1.4.1.cmml" xref="S3.E4.m1.1.1.1.4.1"></times><apply id="S3.E4.m1.1.1.1.4.2.cmml" xref="S3.E4.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.4.2.1.cmml" xref="S3.E4.m1.1.1.1.4.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.4.2.2.cmml" xref="S3.E4.m1.1.1.1.4.2.2">𝜋</ci><ci id="S3.E4.m1.1.1.1.4.2.3.cmml" xref="S3.E4.m1.1.1.1.4.2.3">𝜃</ci></apply><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑠</ci></apply></apply></apply><apply id="S3.E4.m1.5.5.1.3.cmml" xref="S3.E4.m1.5.5.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.3.1.cmml" xref="S3.E4.m1.5.5.1.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.3.2.cmml" xref="S3.E4.m1.5.5.1.3.2">▽</ci><ci id="S3.E4.m1.5.5.1.3.3.cmml" xref="S3.E4.m1.5.5.1.3.3">𝜃</ci></apply><apply id="S3.E4.m1.5.5.1.4.cmml" xref="S3.E4.m1.5.5.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.4.1.cmml" xref="S3.E4.m1.5.5.1.4">subscript</csymbol><ci id="S3.E4.m1.5.5.1.4.2.cmml" xref="S3.E4.m1.5.5.1.4.2">𝜋</ci><ci id="S3.E4.m1.5.5.1.4.3.cmml" xref="S3.E4.m1.5.5.1.4.3">𝜃</ci></apply><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">\triangledown_{\theta}J=\mathbb{E}_{s\backsim d^{\pi}}\triangledown_{a}Q_{w}(s%
,a)|_{a=\pi_{\theta}(s)}\triangledown_{\theta}\pi_{\theta}(s)</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.5d">▽ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_J = blackboard_E start_POSTSUBSCRIPT italic_s ∽ italic_d start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ▽ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_s , italic_a ) | start_POSTSUBSCRIPT italic_a = italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s ) end_POSTSUBSCRIPT ▽ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p4.6">where <math alttext="d^{\pi}(s)" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m1.1"><semantics id="S3.SS3.p4.4.m1.1a"><mrow id="S3.SS3.p4.4.m1.1.2" xref="S3.SS3.p4.4.m1.1.2.cmml"><msup id="S3.SS3.p4.4.m1.1.2.2" xref="S3.SS3.p4.4.m1.1.2.2.cmml"><mi id="S3.SS3.p4.4.m1.1.2.2.2" xref="S3.SS3.p4.4.m1.1.2.2.2.cmml">d</mi><mi id="S3.SS3.p4.4.m1.1.2.2.3" xref="S3.SS3.p4.4.m1.1.2.2.3.cmml">π</mi></msup><mo id="S3.SS3.p4.4.m1.1.2.1" xref="S3.SS3.p4.4.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p4.4.m1.1.2.3.2" xref="S3.SS3.p4.4.m1.1.2.cmml"><mo id="S3.SS3.p4.4.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p4.4.m1.1.2.cmml">(</mo><mi id="S3.SS3.p4.4.m1.1.1" xref="S3.SS3.p4.4.m1.1.1.cmml">s</mi><mo id="S3.SS3.p4.4.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p4.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m1.1b"><apply id="S3.SS3.p4.4.m1.1.2.cmml" xref="S3.SS3.p4.4.m1.1.2"><times id="S3.SS3.p4.4.m1.1.2.1.cmml" xref="S3.SS3.p4.4.m1.1.2.1"></times><apply id="S3.SS3.p4.4.m1.1.2.2.cmml" xref="S3.SS3.p4.4.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m1.1.2.2.1.cmml" xref="S3.SS3.p4.4.m1.1.2.2">superscript</csymbol><ci id="S3.SS3.p4.4.m1.1.2.2.2.cmml" xref="S3.SS3.p4.4.m1.1.2.2.2">𝑑</ci><ci id="S3.SS3.p4.4.m1.1.2.2.3.cmml" xref="S3.SS3.p4.4.m1.1.2.2.3">𝜋</ci></apply><ci id="S3.SS3.p4.4.m1.1.1.cmml" xref="S3.SS3.p4.4.m1.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m1.1c">d^{\pi}(s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.4.m1.1d">italic_d start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT ( italic_s )</annotation></semantics></math> is the discounted distribution of state <math alttext="s" class="ltx_Math" display="inline" id="S3.SS3.p4.5.m2.1"><semantics id="S3.SS3.p4.5.m2.1a"><mi id="S3.SS3.p4.5.m2.1.1" xref="S3.SS3.p4.5.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m2.1b"><ci id="S3.SS3.p4.5.m2.1.1.cmml" xref="S3.SS3.p4.5.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.5.m2.1d">italic_s</annotation></semantics></math> sampling by policy <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS3.p4.6.m3.1"><semantics id="S3.SS3.p4.6.m3.1a"><mi id="S3.SS3.p4.6.m3.1.1" xref="S3.SS3.p4.6.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m3.1b"><ci id="S3.SS3.p4.6.m3.1.1.cmml" xref="S3.SS3.p4.6.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m3.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.6.m3.1d">italic_π</annotation></semantics></math>. Target network parameters are softly updated by</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S7.EGx1">
<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\theta^{\mu^{{}^{\prime}}}{\leftarrow}\tau{\theta^{\mu^{{}^{%
\prime}}}}+(1-\tau)\theta^{\mu}" class="ltx_Math" display="inline" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><msup id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.3.2" xref="S3.Ex1.m1.1.1.3.2.cmml">θ</mi><msup id="S3.Ex1.m1.1.1.3.3" xref="S3.Ex1.m1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.1.1.3.3.2" xref="S3.Ex1.m1.1.1.3.3.2.cmml">μ</mi><msup id="S3.Ex1.m1.1.1.3.3.3" xref="S3.Ex1.m1.1.1.3.3.3.cmml"><mi id="S3.Ex1.m1.1.1.3.3.3a" xref="S3.Ex1.m1.1.1.3.3.3.cmml"></mi><mo id="S3.Ex1.m1.1.1.3.3.3.1" xref="S3.Ex1.m1.1.1.3.3.3.1.cmml">′</mo></msup></msup></msup><mo id="S3.Ex1.m1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.2.cmml">←</mo><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.3.2.cmml">τ</mi><mo id="S3.Ex1.m1.1.1.1.3.1" xref="S3.Ex1.m1.1.1.1.3.1.cmml">⁢</mo><msup id="S3.Ex1.m1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.1.1.1.3.3.2" xref="S3.Ex1.m1.1.1.1.3.3.2.cmml">θ</mi><msup id="S3.Ex1.m1.1.1.1.3.3.3" xref="S3.Ex1.m1.1.1.1.3.3.3.cmml"><mi id="S3.Ex1.m1.1.1.1.3.3.3.2" xref="S3.Ex1.m1.1.1.1.3.3.3.2.cmml">μ</mi><msup id="S3.Ex1.m1.1.1.1.3.3.3.3" xref="S3.Ex1.m1.1.1.1.3.3.3.3.cmml"><mi id="S3.Ex1.m1.1.1.1.3.3.3.3a" xref="S3.Ex1.m1.1.1.1.3.3.3.3.cmml"></mi><mo id="S3.Ex1.m1.1.1.1.3.3.3.3.1" xref="S3.Ex1.m1.1.1.1.3.3.3.3.1.cmml">′</mo></msup></msup></msup></mrow><mo id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.2.cmml">+</mo><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.Ex1.m1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex1.m1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.2.cmml">⁢</mo><msup id="S3.Ex1.m1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2.cmml">θ</mi><mi id="S3.Ex1.m1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.3.3.cmml">μ</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><ci id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2">←</ci><apply id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.3.2">𝜃</ci><apply id="S3.Ex1.m1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.1.1.3.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.1.1.3.3.2">𝜇</ci><apply id="S3.Ex1.m1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.1.1.3.3.3"><ci id="S3.Ex1.m1.1.1.3.3.3.1.cmml" xref="S3.Ex1.m1.1.1.3.3.3.1">′</ci></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><plus id="S3.Ex1.m1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.2"></plus><apply id="S3.Ex1.m1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.3"><times id="S3.Ex1.m1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.3.1"></times><ci id="S3.Ex1.m1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.3.2">𝜏</ci><apply id="S3.Ex1.m1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.1.1.1.3.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.1.1.1.3.3.2">𝜃</ci><apply id="S3.Ex1.m1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.3.3.3.1.cmml" xref="S3.Ex1.m1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.3.3.3.2.cmml" xref="S3.Ex1.m1.1.1.1.3.3.3.2">𝜇</ci><apply id="S3.Ex1.m1.1.1.1.3.3.3.3.cmml" xref="S3.Ex1.m1.1.1.1.3.3.3.3"><ci id="S3.Ex1.m1.1.1.1.3.3.3.3.1.cmml" xref="S3.Ex1.m1.1.1.1.3.3.3.3.1">′</ci></apply></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1"><times id="S3.Ex1.m1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2"></times><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1"><minus id="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1"></minus><cn id="S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3">𝜏</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2">𝜃</ci><ci id="S3.Ex1.m1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.3">𝜇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle\theta^{\mu^{{}^{\prime}}}{\leftarrow}\tau{\theta^{\mu^{{}^{%
\prime}}}}+(1-\tau)\theta^{\mu}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">italic_θ start_POSTSUPERSCRIPT italic_μ start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ← italic_τ italic_θ start_POSTSUPERSCRIPT italic_μ start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT + ( 1 - italic_τ ) italic_θ start_POSTSUPERSCRIPT italic_μ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle w^{{}^{\prime}}\leftarrow\tau w^{{}^{\prime}}+(1-\tau)w" class="ltx_Math" display="inline" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><msup id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml">w</mi><msup id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3a" xref="S3.E5.m1.1.1.3.3.cmml"></mi><mo id="S3.E5.m1.1.1.3.3.1" xref="S3.E5.m1.1.1.3.3.1.cmml">′</mo></msup></msup><mo id="S3.E5.m1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.2.cmml">←</mo><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.3.2.cmml">τ</mi><mo id="S3.E5.m1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.3.1.cmml">⁢</mo><msup id="S3.E5.m1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.3.3.2.cmml">w</mi><msup id="S3.E5.m1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.1.1.1.3.3.3a" xref="S3.E5.m1.1.1.1.3.3.3.cmml"></mi><mo id="S3.E5.m1.1.1.1.3.3.3.1" xref="S3.E5.m1.1.1.1.3.3.3.1.cmml">′</mo></msup></msup></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E5.m1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E5.m1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml">w</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><ci id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2">←</ci><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3">superscript</csymbol><ci id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2">𝑤</ci><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><ci id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.1">′</ci></apply></apply><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><plus id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2"></plus><apply id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3"><times id="S3.E5.m1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.3.1"></times><ci id="S3.E5.m1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.3.2">𝜏</ci><apply id="S3.E5.m1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.3.3">superscript</csymbol><ci id="S3.E5.m1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.3.3.2">𝑤</ci><apply id="S3.E5.m1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.1.3.3.3"><ci id="S3.E5.m1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.3.3.3.1">′</ci></apply></apply></apply><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><minus id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E5.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E5.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3">𝜏</ci></apply><ci id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle w^{{}^{\prime}}\leftarrow\tau w^{{}^{\prime}}+(1-\tau)w</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">italic_w start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ← italic_τ italic_w start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT + ( 1 - italic_τ ) italic_w</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p4.7">in a pre-defined time interval with <math alttext="\tau\in(0,1)" class="ltx_Math" display="inline" id="S3.SS3.p4.7.m1.2"><semantics id="S3.SS3.p4.7.m1.2a"><mrow id="S3.SS3.p4.7.m1.2.3" xref="S3.SS3.p4.7.m1.2.3.cmml"><mi id="S3.SS3.p4.7.m1.2.3.2" xref="S3.SS3.p4.7.m1.2.3.2.cmml">τ</mi><mo id="S3.SS3.p4.7.m1.2.3.1" xref="S3.SS3.p4.7.m1.2.3.1.cmml">∈</mo><mrow id="S3.SS3.p4.7.m1.2.3.3.2" xref="S3.SS3.p4.7.m1.2.3.3.1.cmml"><mo id="S3.SS3.p4.7.m1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p4.7.m1.2.3.3.1.cmml">(</mo><mn id="S3.SS3.p4.7.m1.1.1" xref="S3.SS3.p4.7.m1.1.1.cmml">0</mn><mo id="S3.SS3.p4.7.m1.2.3.3.2.2" xref="S3.SS3.p4.7.m1.2.3.3.1.cmml">,</mo><mn id="S3.SS3.p4.7.m1.2.2" xref="S3.SS3.p4.7.m1.2.2.cmml">1</mn><mo id="S3.SS3.p4.7.m1.2.3.3.2.3" stretchy="false" xref="S3.SS3.p4.7.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m1.2b"><apply id="S3.SS3.p4.7.m1.2.3.cmml" xref="S3.SS3.p4.7.m1.2.3"><in id="S3.SS3.p4.7.m1.2.3.1.cmml" xref="S3.SS3.p4.7.m1.2.3.1"></in><ci id="S3.SS3.p4.7.m1.2.3.2.cmml" xref="S3.SS3.p4.7.m1.2.3.2">𝜏</ci><interval closure="open" id="S3.SS3.p4.7.m1.2.3.3.1.cmml" xref="S3.SS3.p4.7.m1.2.3.3.2"><cn id="S3.SS3.p4.7.m1.1.1.cmml" type="integer" xref="S3.SS3.p4.7.m1.1.1">0</cn><cn id="S3.SS3.p4.7.m1.2.2.cmml" type="integer" xref="S3.SS3.p4.7.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m1.2c">\tau\in(0,1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.7.m1.2d">italic_τ ∈ ( 0 , 1 )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1">Then <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.1"><semantics id="S3.SS3.p5.1.m1.1a"><mi id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.1d">italic_θ</annotation></semantics></math> can be updated as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\theta\leftarrow\theta+\eta\mathbb{E}_{s\backsim d^{\pi}}[\triangledown_{%
\theta}\pi_{\theta}(s)\triangledown_{a}Q_{w}(s,a)|_{a=\pi(s)}]" class="ltx_Math" display="block" id="S3.E6.m1.5"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml"><mi id="S3.E6.m1.5.5.3" xref="S3.E6.m1.5.5.3.cmml">θ</mi><mo id="S3.E6.m1.5.5.2" stretchy="false" xref="S3.E6.m1.5.5.2.cmml">←</mo><mrow id="S3.E6.m1.5.5.1" xref="S3.E6.m1.5.5.1.cmml"><mi id="S3.E6.m1.5.5.1.3" xref="S3.E6.m1.5.5.1.3.cmml">θ</mi><mo id="S3.E6.m1.5.5.1.2" xref="S3.E6.m1.5.5.1.2.cmml">+</mo><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml"><mi id="S3.E6.m1.5.5.1.1.3" xref="S3.E6.m1.5.5.1.1.3.cmml">η</mi><mo id="S3.E6.m1.5.5.1.1.2" xref="S3.E6.m1.5.5.1.1.2.cmml">⁢</mo><msub id="S3.E6.m1.5.5.1.1.4" xref="S3.E6.m1.5.5.1.1.4.cmml"><mi id="S3.E6.m1.5.5.1.1.4.2" xref="S3.E6.m1.5.5.1.1.4.2.cmml">𝔼</mi><mrow id="S3.E6.m1.5.5.1.1.4.3" xref="S3.E6.m1.5.5.1.1.4.3.cmml"><mi id="S3.E6.m1.5.5.1.1.4.3.2" xref="S3.E6.m1.5.5.1.1.4.3.2.cmml">s</mi><mo id="S3.E6.m1.5.5.1.1.4.3.1" xref="S3.E6.m1.5.5.1.1.4.3.1.cmml">∽</mo><msup id="S3.E6.m1.5.5.1.1.4.3.3" xref="S3.E6.m1.5.5.1.1.4.3.3.cmml"><mi id="S3.E6.m1.5.5.1.1.4.3.3.2" xref="S3.E6.m1.5.5.1.1.4.3.3.2.cmml">d</mi><mi id="S3.E6.m1.5.5.1.1.4.3.3.3" xref="S3.E6.m1.5.5.1.1.4.3.3.3.cmml">π</mi></msup></mrow></msub><mo id="S3.E6.m1.5.5.1.1.2a" xref="S3.E6.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.5.5.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.2.cmml"><mo id="S3.E6.m1.5.5.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.2.1.cmml">[</mo><msub id="S3.E6.m1.5.5.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.2.cmml"><mrow id="S3.E6.m1.5.5.1.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.2.cmml"><mrow id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2.2" mathvariant="normal" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml">▽</mi><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml">π</mi><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1a" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.4.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.4.2.1" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">s</mi><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.4.2.2" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1b" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5.2" mathvariant="normal" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5.2.cmml">▽</mi><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5.3.cmml">a</mi></msub><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1c" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6.2.cmml">Q</mi><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6.3.cmml">w</mi></msub><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1d" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.7.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.7.1.cmml"><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.7.2.1" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.7.1.cmml">(</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">s</mi><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.7.2.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.7.1.cmml">,</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">a</mi><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.7.2.3" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.7.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml">a</mi><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.4" xref="S3.E6.m1.1.1.1.4.cmml"><mi id="S3.E6.m1.1.1.1.4.2" xref="S3.E6.m1.1.1.1.4.2.cmml">π</mi><mo id="S3.E6.m1.1.1.1.4.1" xref="S3.E6.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.4.3.2" xref="S3.E6.m1.1.1.1.4.cmml"><mo id="S3.E6.m1.1.1.1.4.3.2.1" stretchy="false" xref="S3.E6.m1.1.1.1.4.cmml">(</mo><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">s</mi><mo id="S3.E6.m1.1.1.1.4.3.2.2" stretchy="false" xref="S3.E6.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo id="S3.E6.m1.5.5.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5"><ci id="S3.E6.m1.5.5.2.cmml" xref="S3.E6.m1.5.5.2">←</ci><ci id="S3.E6.m1.5.5.3.cmml" xref="S3.E6.m1.5.5.3">𝜃</ci><apply id="S3.E6.m1.5.5.1.cmml" xref="S3.E6.m1.5.5.1"><plus id="S3.E6.m1.5.5.1.2.cmml" xref="S3.E6.m1.5.5.1.2"></plus><ci id="S3.E6.m1.5.5.1.3.cmml" xref="S3.E6.m1.5.5.1.3">𝜃</ci><apply id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1.1"><times id="S3.E6.m1.5.5.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.2"></times><ci id="S3.E6.m1.5.5.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.3">𝜂</ci><apply id="S3.E6.m1.5.5.1.1.4.cmml" xref="S3.E6.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.4.1.cmml" xref="S3.E6.m1.5.5.1.1.4">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.4.2.cmml" xref="S3.E6.m1.5.5.1.1.4.2">𝔼</ci><apply id="S3.E6.m1.5.5.1.1.4.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3"><ci id="S3.E6.m1.5.5.1.1.4.3.1.cmml" xref="S3.E6.m1.5.5.1.1.4.3.1">∽</ci><ci id="S3.E6.m1.5.5.1.1.4.3.2.cmml" xref="S3.E6.m1.5.5.1.1.4.3.2">𝑠</ci><apply id="S3.E6.m1.5.5.1.1.4.3.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.4.3.3.1.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3">superscript</csymbol><ci id="S3.E6.m1.5.5.1.1.4.3.3.2.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.2">𝑑</ci><ci id="S3.E6.m1.5.5.1.1.4.3.3.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3">𝜋</ci></apply></apply></apply><apply id="S3.E6.m1.5.5.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.5.5.1.1.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E6.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.2">evaluated-at</csymbol><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2.2">▽</ci><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.2.3">𝜃</ci></apply><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3.2">𝜋</ci><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝑠</ci><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5.2">▽</ci><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.5.3">𝑎</ci></apply><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6.2">𝑄</ci><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.6.3">𝑤</ci></apply><interval closure="open" id="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.7.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.1.7.2"><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝑠</ci><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝑎</ci></interval></apply><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></eq><ci id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3">𝑎</ci><apply id="S3.E6.m1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.4"><times id="S3.E6.m1.1.1.1.4.1.cmml" xref="S3.E6.m1.1.1.1.4.1"></times><ci id="S3.E6.m1.1.1.1.4.2.cmml" xref="S3.E6.m1.1.1.1.4.2">𝜋</ci><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑠</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">\theta\leftarrow\theta+\eta\mathbb{E}_{s\backsim d^{\pi}}[\triangledown_{%
\theta}\pi_{\theta}(s)\triangledown_{a}Q_{w}(s,a)|_{a=\pi(s)}]</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.5d">italic_θ ← italic_θ + italic_η blackboard_E start_POSTSUBSCRIPT italic_s ∽ italic_d start_POSTSUPERSCRIPT italic_π end_POSTSUPERSCRIPT end_POSTSUBSCRIPT [ ▽ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s ) ▽ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_s , italic_a ) | start_POSTSUBSCRIPT italic_a = italic_π ( italic_s ) end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p5.2">with <math alttext="\eta" class="ltx_Math" display="inline" id="S3.SS3.p5.2.m1.1"><semantics id="S3.SS3.p5.2.m1.1a"><mi id="S3.SS3.p5.2.m1.1.1" xref="S3.SS3.p5.2.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m1.1b"><ci id="S3.SS3.p5.2.m1.1.1.cmml" xref="S3.SS3.p5.2.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m1.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.2.m1.1d">italic_η</annotation></semantics></math> as the learning rate.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Gated Recurrent Unit</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.2">Gated Recurrent Unit (GRU) is a special type of RNN that can sequentially capture the item-dependency impacts. It is found that GRU has better stability with fewer parameters than general GRN, therefore is usually used in recommendation studies <cite class="ltx_cite ltx_citemacro_cite">Hidasi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib10" title="">2016</a>); Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib34" title="">2019</a>); Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib38" title="">2019b</a>)</cite>. The core logic of GRU is the following:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;\mathnormal{z}_{t}=\mathnormal{\sigma}(W_{z}\cdot[h_{t-1},x_{t}]%
)\\
&amp;\mathnormal{r}_{t}=\mathnormal{\sigma}(W_{r}\cdot[h_{t-1},x_{t}])\\
&amp;\tilde{h}_{t}=\mathnormal{tanh}(W_{h}\cdot[\mathnormal{r}_{t}h_{t-1},x_{t}])%
\\
&amp;h_{t}=(1-z_{t})h_{t-1}+z_{t}(\tilde{h}_{t})\end{split}" class="ltx_Math" display="block" id="S3.E7.m1.81"><semantics id="S3.E7.m1.81a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E7.m1.81.81.10" rowspacing="0pt" xref="S3.E7.m1.76.76.5.cmml"><mtr id="S3.E7.m1.81.81.10a" xref="S3.E7.m1.76.76.5.cmml"><mtd id="S3.E7.m1.81.81.10b" xref="S3.E7.m1.76.76.5a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.81.81.10c" xref="S3.E7.m1.76.76.5.cmml"><mrow id="S3.E7.m1.77.77.6.72.17.17" xref="S3.E7.m1.76.76.5.cmml"><msub id="S3.E7.m1.77.77.6.72.17.17.18" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml">z</mi><mi id="S3.E7.m1.2.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.2.1.cmml">t</mi></msub><mo id="S3.E7.m1.3.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E7.m1.77.77.6.72.17.17.17" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.4.4.4.4.4.4" xref="S3.E7.m1.4.4.4.4.4.4.cmml">σ</mi><mo id="S3.E7.m1.77.77.6.72.17.17.17.2" xref="S3.E7.m1.76.76.5a.cmml">⁢</mo><mrow id="S3.E7.m1.77.77.6.72.17.17.17.1.1" xref="S3.E7.m1.76.76.5.cmml"><mo id="S3.E7.m1.5.5.5.5.5.5" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">(</mo><mrow id="S3.E7.m1.77.77.6.72.17.17.17.1.1.1" xref="S3.E7.m1.76.76.5.cmml"><msub id="S3.E7.m1.77.77.6.72.17.17.17.1.1.1.3" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.6.6.6.6.6.6" xref="S3.E7.m1.6.6.6.6.6.6.cmml">W</mi><mi id="S3.E7.m1.7.7.7.7.7.7.1" xref="S3.E7.m1.7.7.7.7.7.7.1.cmml">z</mi></msub><mo id="S3.E7.m1.8.8.8.8.8.8" lspace="0.222em" rspace="0.222em" xref="S3.E7.m1.8.8.8.8.8.8.cmml">⋅</mo><mrow id="S3.E7.m1.77.77.6.72.17.17.17.1.1.1.2.2" xref="S3.E7.m1.76.76.5.cmml"><mo id="S3.E7.m1.9.9.9.9.9.9" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">[</mo><msub id="S3.E7.m1.77.77.6.72.17.17.17.1.1.1.1.1.1" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.10.10.10.10.10.10" xref="S3.E7.m1.10.10.10.10.10.10.cmml">h</mi><mrow id="S3.E7.m1.11.11.11.11.11.11.1" xref="S3.E7.m1.11.11.11.11.11.11.1.cmml"><mi id="S3.E7.m1.11.11.11.11.11.11.1.2" xref="S3.E7.m1.11.11.11.11.11.11.1.2.cmml">t</mi><mo id="S3.E7.m1.11.11.11.11.11.11.1.1" xref="S3.E7.m1.11.11.11.11.11.11.1.1.cmml">−</mo><mn id="S3.E7.m1.11.11.11.11.11.11.1.3" xref="S3.E7.m1.11.11.11.11.11.11.1.3.cmml">1</mn></mrow></msub><mo id="S3.E7.m1.12.12.12.12.12.12" xref="S3.E7.m1.76.76.5a.cmml">,</mo><msub id="S3.E7.m1.77.77.6.72.17.17.17.1.1.1.2.2.2" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.13.13.13.13.13.13" xref="S3.E7.m1.13.13.13.13.13.13.cmml">x</mi><mi id="S3.E7.m1.14.14.14.14.14.14.1" xref="S3.E7.m1.14.14.14.14.14.14.1.cmml">t</mi></msub><mo id="S3.E7.m1.15.15.15.15.15.15" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">]</mo></mrow></mrow><mo id="S3.E7.m1.16.16.16.16.16.16" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E7.m1.81.81.10d" xref="S3.E7.m1.76.76.5.cmml"><mtd id="S3.E7.m1.81.81.10e" xref="S3.E7.m1.76.76.5a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.81.81.10f" xref="S3.E7.m1.76.76.5.cmml"><mrow id="S3.E7.m1.78.78.7.73.17.17" xref="S3.E7.m1.76.76.5.cmml"><msub id="S3.E7.m1.78.78.7.73.17.17.18" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.17.17.17.1.1.1" xref="S3.E7.m1.17.17.17.1.1.1.cmml">r</mi><mi id="S3.E7.m1.18.18.18.2.2.2.1" xref="S3.E7.m1.18.18.18.2.2.2.1.cmml">t</mi></msub><mo id="S3.E7.m1.19.19.19.3.3.3" xref="S3.E7.m1.19.19.19.3.3.3.cmml">=</mo><mrow id="S3.E7.m1.78.78.7.73.17.17.17" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.20.20.20.4.4.4" xref="S3.E7.m1.20.20.20.4.4.4.cmml">σ</mi><mo id="S3.E7.m1.78.78.7.73.17.17.17.2" xref="S3.E7.m1.76.76.5a.cmml">⁢</mo><mrow id="S3.E7.m1.78.78.7.73.17.17.17.1.1" xref="S3.E7.m1.76.76.5.cmml"><mo id="S3.E7.m1.21.21.21.5.5.5" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">(</mo><mrow id="S3.E7.m1.78.78.7.73.17.17.17.1.1.1" xref="S3.E7.m1.76.76.5.cmml"><msub id="S3.E7.m1.78.78.7.73.17.17.17.1.1.1.3" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.22.22.22.6.6.6" xref="S3.E7.m1.22.22.22.6.6.6.cmml">W</mi><mi id="S3.E7.m1.23.23.23.7.7.7.1" xref="S3.E7.m1.23.23.23.7.7.7.1.cmml">r</mi></msub><mo id="S3.E7.m1.24.24.24.8.8.8" lspace="0.222em" rspace="0.222em" xref="S3.E7.m1.24.24.24.8.8.8.cmml">⋅</mo><mrow id="S3.E7.m1.78.78.7.73.17.17.17.1.1.1.2.2" xref="S3.E7.m1.76.76.5.cmml"><mo id="S3.E7.m1.25.25.25.9.9.9" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">[</mo><msub id="S3.E7.m1.78.78.7.73.17.17.17.1.1.1.1.1.1" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.26.26.26.10.10.10" xref="S3.E7.m1.26.26.26.10.10.10.cmml">h</mi><mrow id="S3.E7.m1.27.27.27.11.11.11.1" xref="S3.E7.m1.27.27.27.11.11.11.1.cmml"><mi id="S3.E7.m1.27.27.27.11.11.11.1.2" xref="S3.E7.m1.27.27.27.11.11.11.1.2.cmml">t</mi><mo id="S3.E7.m1.27.27.27.11.11.11.1.1" xref="S3.E7.m1.27.27.27.11.11.11.1.1.cmml">−</mo><mn id="S3.E7.m1.27.27.27.11.11.11.1.3" xref="S3.E7.m1.27.27.27.11.11.11.1.3.cmml">1</mn></mrow></msub><mo id="S3.E7.m1.28.28.28.12.12.12" xref="S3.E7.m1.76.76.5a.cmml">,</mo><msub id="S3.E7.m1.78.78.7.73.17.17.17.1.1.1.2.2.2" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.29.29.29.13.13.13" xref="S3.E7.m1.29.29.29.13.13.13.cmml">x</mi><mi id="S3.E7.m1.30.30.30.14.14.14.1" xref="S3.E7.m1.30.30.30.14.14.14.1.cmml">t</mi></msub><mo id="S3.E7.m1.31.31.31.15.15.15" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">]</mo></mrow></mrow><mo id="S3.E7.m1.32.32.32.16.16.16" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E7.m1.81.81.10g" xref="S3.E7.m1.76.76.5.cmml"><mtd id="S3.E7.m1.81.81.10h" xref="S3.E7.m1.76.76.5a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.81.81.10i" xref="S3.E7.m1.76.76.5.cmml"><mrow id="S3.E7.m1.79.79.8.74.22.22" xref="S3.E7.m1.76.76.5.cmml"><msub id="S3.E7.m1.79.79.8.74.22.22.23" xref="S3.E7.m1.76.76.5.cmml"><mover accent="true" id="S3.E7.m1.33.33.33.1.1.1" xref="S3.E7.m1.33.33.33.1.1.1.cmml"><mi id="S3.E7.m1.33.33.33.1.1.1.2" xref="S3.E7.m1.33.33.33.1.1.1.2.cmml">h</mi><mo id="S3.E7.m1.33.33.33.1.1.1.1" xref="S3.E7.m1.33.33.33.1.1.1.1.cmml">~</mo></mover><mi id="S3.E7.m1.34.34.34.2.2.2.1" xref="S3.E7.m1.34.34.34.2.2.2.1.cmml">t</mi></msub><mo id="S3.E7.m1.35.35.35.3.3.3" xref="S3.E7.m1.35.35.35.3.3.3.cmml">=</mo><mrow id="S3.E7.m1.79.79.8.74.22.22.22" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.36.36.36.4.4.4" xref="S3.E7.m1.36.36.36.4.4.4.cmml">t</mi><mo id="S3.E7.m1.79.79.8.74.22.22.22.2" xref="S3.E7.m1.76.76.5a.cmml">⁢</mo><mi id="S3.E7.m1.37.37.37.5.5.5" xref="S3.E7.m1.37.37.37.5.5.5.cmml">a</mi><mo id="S3.E7.m1.79.79.8.74.22.22.22.2a" xref="S3.E7.m1.76.76.5a.cmml">⁢</mo><mi id="S3.E7.m1.38.38.38.6.6.6" xref="S3.E7.m1.38.38.38.6.6.6.cmml">n</mi><mo id="S3.E7.m1.79.79.8.74.22.22.22.2b" xref="S3.E7.m1.76.76.5a.cmml">⁢</mo><mi id="S3.E7.m1.39.39.39.7.7.7" xref="S3.E7.m1.39.39.39.7.7.7.cmml">h</mi><mo id="S3.E7.m1.79.79.8.74.22.22.22.2c" xref="S3.E7.m1.76.76.5a.cmml">⁢</mo><mrow id="S3.E7.m1.79.79.8.74.22.22.22.1.1" xref="S3.E7.m1.76.76.5.cmml"><mo id="S3.E7.m1.40.40.40.8.8.8" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">(</mo><mrow id="S3.E7.m1.79.79.8.74.22.22.22.1.1.1" xref="S3.E7.m1.76.76.5.cmml"><msub id="S3.E7.m1.79.79.8.74.22.22.22.1.1.1.3" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.41.41.41.9.9.9" xref="S3.E7.m1.41.41.41.9.9.9.cmml">W</mi><mi id="S3.E7.m1.42.42.42.10.10.10.1" xref="S3.E7.m1.42.42.42.10.10.10.1.cmml">h</mi></msub><mo id="S3.E7.m1.43.43.43.11.11.11" lspace="0.222em" rspace="0.222em" xref="S3.E7.m1.43.43.43.11.11.11.cmml">⋅</mo><mrow id="S3.E7.m1.79.79.8.74.22.22.22.1.1.1.2.2" xref="S3.E7.m1.76.76.5.cmml"><mo id="S3.E7.m1.44.44.44.12.12.12" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">[</mo><mrow id="S3.E7.m1.79.79.8.74.22.22.22.1.1.1.1.1.1" xref="S3.E7.m1.76.76.5.cmml"><msub id="S3.E7.m1.79.79.8.74.22.22.22.1.1.1.1.1.1.2" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.45.45.45.13.13.13" xref="S3.E7.m1.45.45.45.13.13.13.cmml">r</mi><mi id="S3.E7.m1.46.46.46.14.14.14.1" xref="S3.E7.m1.46.46.46.14.14.14.1.cmml">t</mi></msub><mo id="S3.E7.m1.79.79.8.74.22.22.22.1.1.1.1.1.1.1" xref="S3.E7.m1.76.76.5a.cmml">⁢</mo><msub id="S3.E7.m1.79.79.8.74.22.22.22.1.1.1.1.1.1.3" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.47.47.47.15.15.15" xref="S3.E7.m1.47.47.47.15.15.15.cmml">h</mi><mrow id="S3.E7.m1.48.48.48.16.16.16.1" xref="S3.E7.m1.48.48.48.16.16.16.1.cmml"><mi id="S3.E7.m1.48.48.48.16.16.16.1.2" xref="S3.E7.m1.48.48.48.16.16.16.1.2.cmml">t</mi><mo id="S3.E7.m1.48.48.48.16.16.16.1.1" xref="S3.E7.m1.48.48.48.16.16.16.1.1.cmml">−</mo><mn id="S3.E7.m1.48.48.48.16.16.16.1.3" xref="S3.E7.m1.48.48.48.16.16.16.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E7.m1.49.49.49.17.17.17" xref="S3.E7.m1.76.76.5a.cmml">,</mo><msub id="S3.E7.m1.79.79.8.74.22.22.22.1.1.1.2.2.2" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.50.50.50.18.18.18" xref="S3.E7.m1.50.50.50.18.18.18.cmml">x</mi><mi id="S3.E7.m1.51.51.51.19.19.19.1" xref="S3.E7.m1.51.51.51.19.19.19.1.cmml">t</mi></msub><mo id="S3.E7.m1.52.52.52.20.20.20" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">]</mo></mrow></mrow><mo id="S3.E7.m1.53.53.53.21.21.21" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E7.m1.81.81.10j" xref="S3.E7.m1.76.76.5.cmml"><mtd id="S3.E7.m1.81.81.10k" xref="S3.E7.m1.76.76.5a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.81.81.10l" xref="S3.E7.m1.76.76.5.cmml"><mrow id="S3.E7.m1.81.81.10.76.20.20" xref="S3.E7.m1.76.76.5.cmml"><msub id="S3.E7.m1.81.81.10.76.20.20.21" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.54.54.54.1.1.1" xref="S3.E7.m1.54.54.54.1.1.1.cmml">h</mi><mi id="S3.E7.m1.55.55.55.2.2.2.1" xref="S3.E7.m1.55.55.55.2.2.2.1.cmml">t</mi></msub><mo id="S3.E7.m1.56.56.56.3.3.3" xref="S3.E7.m1.56.56.56.3.3.3.cmml">=</mo><mrow id="S3.E7.m1.81.81.10.76.20.20.20" xref="S3.E7.m1.76.76.5.cmml"><mrow id="S3.E7.m1.80.80.9.75.19.19.19.1" xref="S3.E7.m1.76.76.5.cmml"><mrow id="S3.E7.m1.80.80.9.75.19.19.19.1.1.1" xref="S3.E7.m1.76.76.5.cmml"><mo id="S3.E7.m1.57.57.57.4.4.4" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">(</mo><mrow id="S3.E7.m1.80.80.9.75.19.19.19.1.1.1.1" xref="S3.E7.m1.76.76.5.cmml"><mn id="S3.E7.m1.58.58.58.5.5.5" xref="S3.E7.m1.58.58.58.5.5.5.cmml">1</mn><mo id="S3.E7.m1.59.59.59.6.6.6" xref="S3.E7.m1.59.59.59.6.6.6.cmml">−</mo><msub id="S3.E7.m1.80.80.9.75.19.19.19.1.1.1.1.1" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.60.60.60.7.7.7" xref="S3.E7.m1.60.60.60.7.7.7.cmml">z</mi><mi id="S3.E7.m1.61.61.61.8.8.8.1" xref="S3.E7.m1.61.61.61.8.8.8.1.cmml">t</mi></msub></mrow><mo id="S3.E7.m1.62.62.62.9.9.9" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">)</mo></mrow><mo id="S3.E7.m1.80.80.9.75.19.19.19.1.2" xref="S3.E7.m1.76.76.5a.cmml">⁢</mo><msub id="S3.E7.m1.80.80.9.75.19.19.19.1.3" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.63.63.63.10.10.10" xref="S3.E7.m1.63.63.63.10.10.10.cmml">h</mi><mrow id="S3.E7.m1.64.64.64.11.11.11.1" xref="S3.E7.m1.64.64.64.11.11.11.1.cmml"><mi id="S3.E7.m1.64.64.64.11.11.11.1.2" xref="S3.E7.m1.64.64.64.11.11.11.1.2.cmml">t</mi><mo id="S3.E7.m1.64.64.64.11.11.11.1.1" xref="S3.E7.m1.64.64.64.11.11.11.1.1.cmml">−</mo><mn id="S3.E7.m1.64.64.64.11.11.11.1.3" xref="S3.E7.m1.64.64.64.11.11.11.1.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E7.m1.65.65.65.12.12.12" xref="S3.E7.m1.65.65.65.12.12.12.cmml">+</mo><mrow id="S3.E7.m1.81.81.10.76.20.20.20.2" xref="S3.E7.m1.76.76.5.cmml"><msub id="S3.E7.m1.81.81.10.76.20.20.20.2.3" xref="S3.E7.m1.76.76.5.cmml"><mi id="S3.E7.m1.66.66.66.13.13.13" xref="S3.E7.m1.66.66.66.13.13.13.cmml">z</mi><mi id="S3.E7.m1.67.67.67.14.14.14.1" xref="S3.E7.m1.67.67.67.14.14.14.1.cmml">t</mi></msub><mo id="S3.E7.m1.81.81.10.76.20.20.20.2.2" xref="S3.E7.m1.76.76.5a.cmml">⁢</mo><mrow id="S3.E7.m1.81.81.10.76.20.20.20.2.1.1" xref="S3.E7.m1.76.76.5.cmml"><mo id="S3.E7.m1.68.68.68.15.15.15" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">(</mo><msub id="S3.E7.m1.81.81.10.76.20.20.20.2.1.1.1" xref="S3.E7.m1.76.76.5.cmml"><mover accent="true" id="S3.E7.m1.69.69.69.16.16.16" xref="S3.E7.m1.69.69.69.16.16.16.cmml"><mi id="S3.E7.m1.69.69.69.16.16.16.2" xref="S3.E7.m1.69.69.69.16.16.16.2.cmml">h</mi><mo id="S3.E7.m1.69.69.69.16.16.16.1" xref="S3.E7.m1.69.69.69.16.16.16.1.cmml">~</mo></mover><mi id="S3.E7.m1.70.70.70.17.17.17.1" xref="S3.E7.m1.70.70.70.17.17.17.1.cmml">t</mi></msub><mo id="S3.E7.m1.71.71.71.18.18.18" stretchy="false" xref="S3.E7.m1.76.76.5a.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E7.m1.81b"><apply id="S3.E7.m1.76.76.5.cmml" xref="S3.E7.m1.81.81.10"><and id="S3.E7.m1.76.76.5a.cmml" xref="S3.E7.m1.81.81.10b"></and><apply id="S3.E7.m1.76.76.5b.cmml" xref="S3.E7.m1.81.81.10"><eq id="S3.E7.m1.3.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3"></eq><apply id="S3.E7.m1.76.76.5.7.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.76.76.5.7.1.cmml" xref="S3.E7.m1.81.81.10b">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">𝑧</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1">𝑡</ci></apply><apply id="S3.E7.m1.72.72.1.1.cmml" xref="S3.E7.m1.81.81.10"><times id="S3.E7.m1.72.72.1.1.2.cmml" xref="S3.E7.m1.81.81.10b"></times><ci id="S3.E7.m1.4.4.4.4.4.4.cmml" xref="S3.E7.m1.4.4.4.4.4.4">𝜎</ci><apply id="S3.E7.m1.72.72.1.1.1.1.1.cmml" xref="S3.E7.m1.81.81.10"><ci id="S3.E7.m1.8.8.8.8.8.8.cmml" xref="S3.E7.m1.8.8.8.8.8.8">⋅</ci><apply id="S3.E7.m1.72.72.1.1.1.1.1.4.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.72.72.1.1.1.1.1.4.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><ci id="S3.E7.m1.6.6.6.6.6.6.cmml" xref="S3.E7.m1.6.6.6.6.6.6">𝑊</ci><ci id="S3.E7.m1.7.7.7.7.7.7.1.cmml" xref="S3.E7.m1.7.7.7.7.7.7.1">𝑧</ci></apply><interval closure="closed" id="S3.E7.m1.72.72.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.81.81.10"><apply id="S3.E7.m1.72.72.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.72.72.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><ci id="S3.E7.m1.10.10.10.10.10.10.cmml" xref="S3.E7.m1.10.10.10.10.10.10">ℎ</ci><apply id="S3.E7.m1.11.11.11.11.11.11.1.cmml" xref="S3.E7.m1.11.11.11.11.11.11.1"><minus id="S3.E7.m1.11.11.11.11.11.11.1.1.cmml" xref="S3.E7.m1.11.11.11.11.11.11.1.1"></minus><ci id="S3.E7.m1.11.11.11.11.11.11.1.2.cmml" xref="S3.E7.m1.11.11.11.11.11.11.1.2">𝑡</ci><cn id="S3.E7.m1.11.11.11.11.11.11.1.3.cmml" type="integer" xref="S3.E7.m1.11.11.11.11.11.11.1.3">1</cn></apply></apply><apply id="S3.E7.m1.72.72.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.72.72.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><ci id="S3.E7.m1.13.13.13.13.13.13.cmml" xref="S3.E7.m1.13.13.13.13.13.13">𝑥</ci><ci id="S3.E7.m1.14.14.14.14.14.14.1.cmml" xref="S3.E7.m1.14.14.14.14.14.14.1">𝑡</ci></apply></interval></apply><apply id="S3.E7.m1.72.72.1.1.4.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.72.72.1.1.4.1.cmml" xref="S3.E7.m1.81.81.10b">subscript</csymbol><ci id="S3.E7.m1.17.17.17.1.1.1.cmml" xref="S3.E7.m1.17.17.17.1.1.1">𝑟</ci><ci id="S3.E7.m1.18.18.18.2.2.2.1.cmml" xref="S3.E7.m1.18.18.18.2.2.2.1">𝑡</ci></apply></apply></apply><apply id="S3.E7.m1.76.76.5c.cmml" xref="S3.E7.m1.81.81.10"><eq id="S3.E7.m1.19.19.19.3.3.3.cmml" xref="S3.E7.m1.19.19.19.3.3.3"></eq><share href="https://arxiv.org/html/2409.07416v1#S3.E7.m1.72.72.1.1.cmml" id="S3.E7.m1.76.76.5d.cmml" xref="S3.E7.m1.81.81.10b"></share><apply id="S3.E7.m1.73.73.2.2.cmml" xref="S3.E7.m1.81.81.10"><times id="S3.E7.m1.73.73.2.2.2.cmml" xref="S3.E7.m1.81.81.10b"></times><ci id="S3.E7.m1.20.20.20.4.4.4.cmml" xref="S3.E7.m1.20.20.20.4.4.4">𝜎</ci><apply id="S3.E7.m1.73.73.2.2.1.1.1.cmml" xref="S3.E7.m1.81.81.10"><ci id="S3.E7.m1.24.24.24.8.8.8.cmml" xref="S3.E7.m1.24.24.24.8.8.8">⋅</ci><apply id="S3.E7.m1.73.73.2.2.1.1.1.4.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.73.73.2.2.1.1.1.4.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><ci id="S3.E7.m1.22.22.22.6.6.6.cmml" xref="S3.E7.m1.22.22.22.6.6.6">𝑊</ci><ci id="S3.E7.m1.23.23.23.7.7.7.1.cmml" xref="S3.E7.m1.23.23.23.7.7.7.1">𝑟</ci></apply><interval closure="closed" id="S3.E7.m1.73.73.2.2.1.1.1.2.3.cmml" xref="S3.E7.m1.81.81.10"><apply id="S3.E7.m1.73.73.2.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.73.73.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><ci id="S3.E7.m1.26.26.26.10.10.10.cmml" xref="S3.E7.m1.26.26.26.10.10.10">ℎ</ci><apply id="S3.E7.m1.27.27.27.11.11.11.1.cmml" xref="S3.E7.m1.27.27.27.11.11.11.1"><minus id="S3.E7.m1.27.27.27.11.11.11.1.1.cmml" xref="S3.E7.m1.27.27.27.11.11.11.1.1"></minus><ci id="S3.E7.m1.27.27.27.11.11.11.1.2.cmml" xref="S3.E7.m1.27.27.27.11.11.11.1.2">𝑡</ci><cn id="S3.E7.m1.27.27.27.11.11.11.1.3.cmml" type="integer" xref="S3.E7.m1.27.27.27.11.11.11.1.3">1</cn></apply></apply><apply id="S3.E7.m1.73.73.2.2.1.1.1.2.2.2.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.73.73.2.2.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><ci id="S3.E7.m1.29.29.29.13.13.13.cmml" xref="S3.E7.m1.29.29.29.13.13.13">𝑥</ci><ci id="S3.E7.m1.30.30.30.14.14.14.1.cmml" xref="S3.E7.m1.30.30.30.14.14.14.1">𝑡</ci></apply></interval></apply><apply id="S3.E7.m1.73.73.2.2.4.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.73.73.2.2.4.1.cmml" xref="S3.E7.m1.81.81.10b">subscript</csymbol><apply id="S3.E7.m1.33.33.33.1.1.1.cmml" xref="S3.E7.m1.33.33.33.1.1.1"><ci id="S3.E7.m1.33.33.33.1.1.1.1.cmml" xref="S3.E7.m1.33.33.33.1.1.1.1">~</ci><ci id="S3.E7.m1.33.33.33.1.1.1.2.cmml" xref="S3.E7.m1.33.33.33.1.1.1.2">ℎ</ci></apply><ci id="S3.E7.m1.34.34.34.2.2.2.1.cmml" xref="S3.E7.m1.34.34.34.2.2.2.1">𝑡</ci></apply></apply></apply><apply id="S3.E7.m1.76.76.5e.cmml" xref="S3.E7.m1.81.81.10"><eq id="S3.E7.m1.35.35.35.3.3.3.cmml" xref="S3.E7.m1.35.35.35.3.3.3"></eq><share href="https://arxiv.org/html/2409.07416v1#S3.E7.m1.73.73.2.2.cmml" id="S3.E7.m1.76.76.5f.cmml" xref="S3.E7.m1.81.81.10b"></share><apply id="S3.E7.m1.74.74.3.3.cmml" xref="S3.E7.m1.81.81.10"><times id="S3.E7.m1.74.74.3.3.2.cmml" xref="S3.E7.m1.81.81.10b"></times><ci id="S3.E7.m1.36.36.36.4.4.4.cmml" xref="S3.E7.m1.36.36.36.4.4.4">𝑡</ci><ci id="S3.E7.m1.37.37.37.5.5.5.cmml" xref="S3.E7.m1.37.37.37.5.5.5">𝑎</ci><ci id="S3.E7.m1.38.38.38.6.6.6.cmml" xref="S3.E7.m1.38.38.38.6.6.6">𝑛</ci><ci id="S3.E7.m1.39.39.39.7.7.7.cmml" xref="S3.E7.m1.39.39.39.7.7.7">ℎ</ci><apply id="S3.E7.m1.74.74.3.3.1.1.1.cmml" xref="S3.E7.m1.81.81.10"><ci id="S3.E7.m1.43.43.43.11.11.11.cmml" xref="S3.E7.m1.43.43.43.11.11.11">⋅</ci><apply id="S3.E7.m1.74.74.3.3.1.1.1.4.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.74.74.3.3.1.1.1.4.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><ci id="S3.E7.m1.41.41.41.9.9.9.cmml" xref="S3.E7.m1.41.41.41.9.9.9">𝑊</ci><ci id="S3.E7.m1.42.42.42.10.10.10.1.cmml" xref="S3.E7.m1.42.42.42.10.10.10.1">ℎ</ci></apply><interval closure="closed" id="S3.E7.m1.74.74.3.3.1.1.1.2.3.cmml" xref="S3.E7.m1.81.81.10"><apply id="S3.E7.m1.74.74.3.3.1.1.1.1.1.1.cmml" xref="S3.E7.m1.81.81.10"><times id="S3.E7.m1.74.74.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.81.81.10"></times><apply id="S3.E7.m1.74.74.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.74.74.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><ci id="S3.E7.m1.45.45.45.13.13.13.cmml" xref="S3.E7.m1.45.45.45.13.13.13">𝑟</ci><ci id="S3.E7.m1.46.46.46.14.14.14.1.cmml" xref="S3.E7.m1.46.46.46.14.14.14.1">𝑡</ci></apply><apply id="S3.E7.m1.74.74.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.74.74.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><ci id="S3.E7.m1.47.47.47.15.15.15.cmml" xref="S3.E7.m1.47.47.47.15.15.15">ℎ</ci><apply id="S3.E7.m1.48.48.48.16.16.16.1.cmml" xref="S3.E7.m1.48.48.48.16.16.16.1"><minus id="S3.E7.m1.48.48.48.16.16.16.1.1.cmml" xref="S3.E7.m1.48.48.48.16.16.16.1.1"></minus><ci id="S3.E7.m1.48.48.48.16.16.16.1.2.cmml" xref="S3.E7.m1.48.48.48.16.16.16.1.2">𝑡</ci><cn id="S3.E7.m1.48.48.48.16.16.16.1.3.cmml" type="integer" xref="S3.E7.m1.48.48.48.16.16.16.1.3">1</cn></apply></apply></apply><apply id="S3.E7.m1.74.74.3.3.1.1.1.2.2.2.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.74.74.3.3.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><ci id="S3.E7.m1.50.50.50.18.18.18.cmml" xref="S3.E7.m1.50.50.50.18.18.18">𝑥</ci><ci id="S3.E7.m1.51.51.51.19.19.19.1.cmml" xref="S3.E7.m1.51.51.51.19.19.19.1">𝑡</ci></apply></interval></apply><apply id="S3.E7.m1.74.74.3.3.7.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.74.74.3.3.7.1.cmml" xref="S3.E7.m1.81.81.10b">subscript</csymbol><ci id="S3.E7.m1.54.54.54.1.1.1.cmml" xref="S3.E7.m1.54.54.54.1.1.1">ℎ</ci><ci id="S3.E7.m1.55.55.55.2.2.2.1.cmml" xref="S3.E7.m1.55.55.55.2.2.2.1">𝑡</ci></apply></apply></apply><apply id="S3.E7.m1.76.76.5g.cmml" xref="S3.E7.m1.81.81.10"><eq id="S3.E7.m1.56.56.56.3.3.3.cmml" xref="S3.E7.m1.56.56.56.3.3.3"></eq><share href="https://arxiv.org/html/2409.07416v1#S3.E7.m1.74.74.3.3.cmml" id="S3.E7.m1.76.76.5h.cmml" xref="S3.E7.m1.81.81.10b"></share><apply id="S3.E7.m1.76.76.5.5.cmml" xref="S3.E7.m1.81.81.10"><plus id="S3.E7.m1.65.65.65.12.12.12.cmml" xref="S3.E7.m1.65.65.65.12.12.12"></plus><apply id="S3.E7.m1.75.75.4.4.1.cmml" xref="S3.E7.m1.81.81.10"><times id="S3.E7.m1.75.75.4.4.1.2.cmml" xref="S3.E7.m1.81.81.10b"></times><apply id="S3.E7.m1.75.75.4.4.1.1.1.1.cmml" xref="S3.E7.m1.81.81.10"><minus id="S3.E7.m1.59.59.59.6.6.6.cmml" xref="S3.E7.m1.59.59.59.6.6.6"></minus><cn id="S3.E7.m1.58.58.58.5.5.5.cmml" type="integer" xref="S3.E7.m1.58.58.58.5.5.5">1</cn><apply id="S3.E7.m1.75.75.4.4.1.1.1.1.3.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.75.75.4.4.1.1.1.1.3.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><ci id="S3.E7.m1.60.60.60.7.7.7.cmml" xref="S3.E7.m1.60.60.60.7.7.7">𝑧</ci><ci id="S3.E7.m1.61.61.61.8.8.8.1.cmml" xref="S3.E7.m1.61.61.61.8.8.8.1">𝑡</ci></apply></apply><apply id="S3.E7.m1.75.75.4.4.1.3.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.75.75.4.4.1.3.1.cmml" xref="S3.E7.m1.81.81.10b">subscript</csymbol><ci id="S3.E7.m1.63.63.63.10.10.10.cmml" xref="S3.E7.m1.63.63.63.10.10.10">ℎ</ci><apply id="S3.E7.m1.64.64.64.11.11.11.1.cmml" xref="S3.E7.m1.64.64.64.11.11.11.1"><minus id="S3.E7.m1.64.64.64.11.11.11.1.1.cmml" xref="S3.E7.m1.64.64.64.11.11.11.1.1"></minus><ci id="S3.E7.m1.64.64.64.11.11.11.1.2.cmml" xref="S3.E7.m1.64.64.64.11.11.11.1.2">𝑡</ci><cn id="S3.E7.m1.64.64.64.11.11.11.1.3.cmml" type="integer" xref="S3.E7.m1.64.64.64.11.11.11.1.3">1</cn></apply></apply></apply><apply id="S3.E7.m1.76.76.5.5.2.cmml" xref="S3.E7.m1.81.81.10"><times id="S3.E7.m1.76.76.5.5.2.2.cmml" xref="S3.E7.m1.81.81.10b"></times><apply id="S3.E7.m1.76.76.5.5.2.3.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.76.76.5.5.2.3.1.cmml" xref="S3.E7.m1.81.81.10b">subscript</csymbol><ci id="S3.E7.m1.66.66.66.13.13.13.cmml" xref="S3.E7.m1.66.66.66.13.13.13">𝑧</ci><ci id="S3.E7.m1.67.67.67.14.14.14.1.cmml" xref="S3.E7.m1.67.67.67.14.14.14.1">𝑡</ci></apply><apply id="S3.E7.m1.76.76.5.5.2.1.1.1.cmml" xref="S3.E7.m1.81.81.10"><csymbol cd="ambiguous" id="S3.E7.m1.76.76.5.5.2.1.1.1.1.cmml" xref="S3.E7.m1.81.81.10">subscript</csymbol><apply id="S3.E7.m1.69.69.69.16.16.16.cmml" xref="S3.E7.m1.69.69.69.16.16.16"><ci id="S3.E7.m1.69.69.69.16.16.16.1.cmml" xref="S3.E7.m1.69.69.69.16.16.16.1">~</ci><ci id="S3.E7.m1.69.69.69.16.16.16.2.cmml" xref="S3.E7.m1.69.69.69.16.16.16.2">ℎ</ci></apply><ci id="S3.E7.m1.70.70.70.17.17.17.1.cmml" xref="S3.E7.m1.70.70.70.17.17.17.1">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.81c">\begin{split}&amp;\mathnormal{z}_{t}=\mathnormal{\sigma}(W_{z}\cdot[h_{t-1},x_{t}]%
)\\
&amp;\mathnormal{r}_{t}=\mathnormal{\sigma}(W_{r}\cdot[h_{t-1},x_{t}])\\
&amp;\tilde{h}_{t}=\mathnormal{tanh}(W_{h}\cdot[\mathnormal{r}_{t}h_{t-1},x_{t}])%
\\
&amp;h_{t}=(1-z_{t})h_{t-1}+z_{t}(\tilde{h}_{t})\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.81d">start_ROW start_CELL end_CELL start_CELL italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_σ ( italic_W start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ⋅ [ italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_σ ( italic_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ⋅ [ italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL over~ start_ARG italic_h end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_t italic_a italic_n italic_h ( italic_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ⋅ [ italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( 1 - italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( over~ start_ARG italic_h end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.1">where <math alttext="\mathnormal{z}_{t},\mathnormal{r}_{t}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.2"><semantics id="S3.SS4.p1.1.m1.2a"><mrow id="S3.SS4.p1.1.m1.2.2.2" xref="S3.SS4.p1.1.m1.2.2.3.cmml"><msub id="S3.SS4.p1.1.m1.1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS4.p1.1.m1.1.1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS4.p1.1.m1.2.2.2.3" xref="S3.SS4.p1.1.m1.2.2.3.cmml">,</mo><msub id="S3.SS4.p1.1.m1.2.2.2.2" xref="S3.SS4.p1.1.m1.2.2.2.2.cmml"><mi id="S3.SS4.p1.1.m1.2.2.2.2.2" xref="S3.SS4.p1.1.m1.2.2.2.2.2.cmml">r</mi><mi id="S3.SS4.p1.1.m1.2.2.2.2.3" xref="S3.SS4.p1.1.m1.2.2.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.2b"><list id="S3.SS4.p1.1.m1.2.2.3.cmml" xref="S3.SS4.p1.1.m1.2.2.2"><apply id="S3.SS4.p1.1.m1.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1.2">𝑧</ci><ci id="S3.SS4.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS4.p1.1.m1.2.2.2.2.cmml" xref="S3.SS4.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS4.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS4.p1.1.m1.2.2.2.2.2">𝑟</ci><ci id="S3.SS4.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS4.p1.1.m1.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.2c">\mathnormal{z}_{t},\mathnormal{r}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.2d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are update and reset gates.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>The mccHRL Framework</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.7">Recalling the discussion in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S2" title="2 Related Work ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, the listwise ranking problem can be defined as two MDPs in varied time scales:</p>
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.2">The user state evolution at the real physical time <math alttext="t" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.1"><semantics id="S3.I1.i1.p1.1.m1.1a"><mi id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.1.m1.1d">italic_t</annotation></semantics></math>, with the notation of MDP as <math alttext="\mathcal{M}_{t}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.2.m2.1"><semantics id="S3.I1.i1.p1.2.m2.1a"><msub id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i1.p1.2.m2.1.1.2" xref="S3.I1.i1.p1.2.m2.1.1.2.cmml">ℳ</mi><mi id="S3.I1.i1.p1.2.m2.1.1.3" xref="S3.I1.i1.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><apply id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.2.m2.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.I1.i1.p1.2.m2.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.1.1.2">ℳ</ci><ci id="S3.I1.i1.p1.2.m2.1.1.3.cmml" xref="S3.I1.i1.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">\mathcal{M}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.2.m2.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>;</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.4">Determination of the <math alttext="k" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1"><semantics id="S3.I1.i2.p1.1.m1.1a"><mi id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><ci id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">italic_k</annotation></semantics></math>th optimal item selection among remained <math alttext="K-k" class="ltx_Math" display="inline" id="S3.I1.i2.p1.2.m2.1"><semantics id="S3.I1.i2.p1.2.m2.1a"><mrow id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.2" xref="S3.I1.i2.p1.2.m2.1.1.2.cmml">K</mi><mo id="S3.I1.i2.p1.2.m2.1.1.1" xref="S3.I1.i2.p1.2.m2.1.1.1.cmml">−</mo><mi id="S3.I1.i2.p1.2.m2.1.1.3" xref="S3.I1.i2.p1.2.m2.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><apply id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1"><minus id="S3.I1.i2.p1.2.m2.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.1"></minus><ci id="S3.I1.i2.p1.2.m2.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2">𝐾</ci><ci id="S3.I1.i2.p1.2.m2.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">K-k</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.2.m2.1d">italic_K - italic_k</annotation></semantics></math> candidates. The MDP is notated by <math alttext="\mathcal{M}_{k}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.3.m3.1"><semantics id="S3.I1.i2.p1.3.m3.1a"><msub id="S3.I1.i2.p1.3.m3.1.1" xref="S3.I1.i2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I1.i2.p1.3.m3.1.1.2" xref="S3.I1.i2.p1.3.m3.1.1.2.cmml">ℳ</mi><mi id="S3.I1.i2.p1.3.m3.1.1.3" xref="S3.I1.i2.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m3.1b"><apply id="S3.I1.i2.p1.3.m3.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.3.m3.1.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.3.m3.1.1.2.cmml" xref="S3.I1.i2.p1.3.m3.1.1.2">ℳ</ci><ci id="S3.I1.i2.p1.3.m3.1.1.3.cmml" xref="S3.I1.i2.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m3.1c">\mathcal{M}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.3.m3.1d">caligraphic_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, with <math alttext="k" class="ltx_Math" display="inline" id="S3.I1.i2.p1.4.m4.1"><semantics id="S3.I1.i2.p1.4.m4.1a"><mi id="S3.I1.i2.p1.4.m4.1.1" xref="S3.I1.i2.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.4.m4.1b"><ci id="S3.I1.i2.p1.4.m4.1.1.cmml" xref="S3.I1.i2.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.4.m4.1d">italic_k</annotation></semantics></math> as the virtual decision step.</p>
</div>
</li>
</ol>
<p class="ltx_p" id="S3.SS5.p1.6">In our work, we use HRL to address <math alttext="\mathcal{M}_{t}" class="ltx_Math" display="inline" id="S3.SS5.p1.1.m1.1"><semantics id="S3.SS5.p1.1.m1.1a"><msub id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.1.m1.1.1.2" xref="S3.SS5.p1.1.m1.1.1.2.cmml">ℳ</mi><mi id="S3.SS5.p1.1.m1.1.1.3" xref="S3.SS5.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><apply id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.1.m1.1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p1.1.m1.1.1.2.cmml" xref="S3.SS5.p1.1.m1.1.1.2">ℳ</ci><ci id="S3.SS5.p1.1.m1.1.1.3.cmml" xref="S3.SS5.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">\mathcal{M}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.1.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{M}_{k}" class="ltx_Math" display="inline" id="S3.SS5.p1.2.m2.1"><semantics id="S3.SS5.p1.2.m2.1a"><msub id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.2.m2.1.1.2" xref="S3.SS5.p1.2.m2.1.1.2.cmml">ℳ</mi><mi id="S3.SS5.p1.2.m2.1.1.3" xref="S3.SS5.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><apply id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.2.m2.1.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.p1.2.m2.1.1.2.cmml" xref="S3.SS5.p1.2.m2.1.1.2">ℳ</ci><ci id="S3.SS5.p1.2.m2.1.1.3.cmml" xref="S3.SS5.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">\mathcal{M}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.2.m2.1d">caligraphic_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> simultaneously. We define our High-Level recommendation Agent (HRA) as the user state encoder, with the tuple <math alttext="(s^{\text{h}},a^{\text{h}},r^{\text{h}})" class="ltx_Math" display="inline" id="S3.SS5.p1.3.m3.3"><semantics id="S3.SS5.p1.3.m3.3a"><mrow id="S3.SS5.p1.3.m3.3.3.3" xref="S3.SS5.p1.3.m3.3.3.4.cmml"><mo id="S3.SS5.p1.3.m3.3.3.3.4" stretchy="false" xref="S3.SS5.p1.3.m3.3.3.4.cmml">(</mo><msup id="S3.SS5.p1.3.m3.1.1.1.1" xref="S3.SS5.p1.3.m3.1.1.1.1.cmml"><mi id="S3.SS5.p1.3.m3.1.1.1.1.2" xref="S3.SS5.p1.3.m3.1.1.1.1.2.cmml">s</mi><mtext id="S3.SS5.p1.3.m3.1.1.1.1.3" xref="S3.SS5.p1.3.m3.1.1.1.1.3a.cmml">h</mtext></msup><mo id="S3.SS5.p1.3.m3.3.3.3.5" xref="S3.SS5.p1.3.m3.3.3.4.cmml">,</mo><msup id="S3.SS5.p1.3.m3.2.2.2.2" xref="S3.SS5.p1.3.m3.2.2.2.2.cmml"><mi id="S3.SS5.p1.3.m3.2.2.2.2.2" xref="S3.SS5.p1.3.m3.2.2.2.2.2.cmml">a</mi><mtext id="S3.SS5.p1.3.m3.2.2.2.2.3" xref="S3.SS5.p1.3.m3.2.2.2.2.3a.cmml">h</mtext></msup><mo id="S3.SS5.p1.3.m3.3.3.3.6" xref="S3.SS5.p1.3.m3.3.3.4.cmml">,</mo><msup id="S3.SS5.p1.3.m3.3.3.3.3" xref="S3.SS5.p1.3.m3.3.3.3.3.cmml"><mi id="S3.SS5.p1.3.m3.3.3.3.3.2" xref="S3.SS5.p1.3.m3.3.3.3.3.2.cmml">r</mi><mtext id="S3.SS5.p1.3.m3.3.3.3.3.3" xref="S3.SS5.p1.3.m3.3.3.3.3.3a.cmml">h</mtext></msup><mo id="S3.SS5.p1.3.m3.3.3.3.7" stretchy="false" xref="S3.SS5.p1.3.m3.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.3b"><vector id="S3.SS5.p1.3.m3.3.3.4.cmml" xref="S3.SS5.p1.3.m3.3.3.3"><apply id="S3.SS5.p1.3.m3.1.1.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1.1.1">superscript</csymbol><ci id="S3.SS5.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS5.p1.3.m3.1.1.1.1.2">𝑠</ci><ci id="S3.SS5.p1.3.m3.1.1.1.1.3a.cmml" xref="S3.SS5.p1.3.m3.1.1.1.1.3"><mtext id="S3.SS5.p1.3.m3.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p1.3.m3.1.1.1.1.3">h</mtext></ci></apply><apply id="S3.SS5.p1.3.m3.2.2.2.2.cmml" xref="S3.SS5.p1.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m3.2.2.2.2.1.cmml" xref="S3.SS5.p1.3.m3.2.2.2.2">superscript</csymbol><ci id="S3.SS5.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS5.p1.3.m3.2.2.2.2.2">𝑎</ci><ci id="S3.SS5.p1.3.m3.2.2.2.2.3a.cmml" xref="S3.SS5.p1.3.m3.2.2.2.2.3"><mtext id="S3.SS5.p1.3.m3.2.2.2.2.3.cmml" mathsize="70%" xref="S3.SS5.p1.3.m3.2.2.2.2.3">h</mtext></ci></apply><apply id="S3.SS5.p1.3.m3.3.3.3.3.cmml" xref="S3.SS5.p1.3.m3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m3.3.3.3.3.1.cmml" xref="S3.SS5.p1.3.m3.3.3.3.3">superscript</csymbol><ci id="S3.SS5.p1.3.m3.3.3.3.3.2.cmml" xref="S3.SS5.p1.3.m3.3.3.3.3.2">𝑟</ci><ci id="S3.SS5.p1.3.m3.3.3.3.3.3a.cmml" xref="S3.SS5.p1.3.m3.3.3.3.3.3"><mtext id="S3.SS5.p1.3.m3.3.3.3.3.3.cmml" mathsize="70%" xref="S3.SS5.p1.3.m3.3.3.3.3.3">h</mtext></ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.3c">(s^{\text{h}},a^{\text{h}},r^{\text{h}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.3.m3.3d">( italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT , italic_r start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT )</annotation></semantics></math> in <math alttext="\mathcal{M}_{t}" class="ltx_Math" display="inline" id="S3.SS5.p1.4.m4.1"><semantics id="S3.SS5.p1.4.m4.1a"><msub id="S3.SS5.p1.4.m4.1.1" xref="S3.SS5.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.4.m4.1.1.2" xref="S3.SS5.p1.4.m4.1.1.2.cmml">ℳ</mi><mi id="S3.SS5.p1.4.m4.1.1.3" xref="S3.SS5.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.1b"><apply id="S3.SS5.p1.4.m4.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.4.m4.1.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS5.p1.4.m4.1.1.2.cmml" xref="S3.SS5.p1.4.m4.1.1.2">ℳ</ci><ci id="S3.SS5.p1.4.m4.1.1.3.cmml" xref="S3.SS5.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.1c">\mathcal{M}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.4.m4.1d">caligraphic_M start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>; while the Low-Level recommendation Agent (LRA) is the item selector, working on <math alttext="\mathcal{M}_{k}" class="ltx_Math" display="inline" id="S3.SS5.p1.5.m5.1"><semantics id="S3.SS5.p1.5.m5.1a"><msub id="S3.SS5.p1.5.m5.1.1" xref="S3.SS5.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.5.m5.1.1.2" xref="S3.SS5.p1.5.m5.1.1.2.cmml">ℳ</mi><mi id="S3.SS5.p1.5.m5.1.1.3" xref="S3.SS5.p1.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.5.m5.1b"><apply id="S3.SS5.p1.5.m5.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.5.m5.1.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS5.p1.5.m5.1.1.2.cmml" xref="S3.SS5.p1.5.m5.1.1.2">ℳ</ci><ci id="S3.SS5.p1.5.m5.1.1.3.cmml" xref="S3.SS5.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.5.m5.1c">\mathcal{M}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.5.m5.1d">caligraphic_M start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> with tuple <math alttext="(s^{\text{l}},a^{\text{l}},r^{\text{l}})" class="ltx_Math" display="inline" id="S3.SS5.p1.6.m6.3"><semantics id="S3.SS5.p1.6.m6.3a"><mrow id="S3.SS5.p1.6.m6.3.3.3" xref="S3.SS5.p1.6.m6.3.3.4.cmml"><mo id="S3.SS5.p1.6.m6.3.3.3.4" stretchy="false" xref="S3.SS5.p1.6.m6.3.3.4.cmml">(</mo><msup id="S3.SS5.p1.6.m6.1.1.1.1" xref="S3.SS5.p1.6.m6.1.1.1.1.cmml"><mi id="S3.SS5.p1.6.m6.1.1.1.1.2" xref="S3.SS5.p1.6.m6.1.1.1.1.2.cmml">s</mi><mtext id="S3.SS5.p1.6.m6.1.1.1.1.3" xref="S3.SS5.p1.6.m6.1.1.1.1.3a.cmml">l</mtext></msup><mo id="S3.SS5.p1.6.m6.3.3.3.5" xref="S3.SS5.p1.6.m6.3.3.4.cmml">,</mo><msup id="S3.SS5.p1.6.m6.2.2.2.2" xref="S3.SS5.p1.6.m6.2.2.2.2.cmml"><mi id="S3.SS5.p1.6.m6.2.2.2.2.2" xref="S3.SS5.p1.6.m6.2.2.2.2.2.cmml">a</mi><mtext id="S3.SS5.p1.6.m6.2.2.2.2.3" xref="S3.SS5.p1.6.m6.2.2.2.2.3a.cmml">l</mtext></msup><mo id="S3.SS5.p1.6.m6.3.3.3.6" xref="S3.SS5.p1.6.m6.3.3.4.cmml">,</mo><msup id="S3.SS5.p1.6.m6.3.3.3.3" xref="S3.SS5.p1.6.m6.3.3.3.3.cmml"><mi id="S3.SS5.p1.6.m6.3.3.3.3.2" xref="S3.SS5.p1.6.m6.3.3.3.3.2.cmml">r</mi><mtext id="S3.SS5.p1.6.m6.3.3.3.3.3" xref="S3.SS5.p1.6.m6.3.3.3.3.3a.cmml">l</mtext></msup><mo id="S3.SS5.p1.6.m6.3.3.3.7" stretchy="false" xref="S3.SS5.p1.6.m6.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.6.m6.3b"><vector id="S3.SS5.p1.6.m6.3.3.4.cmml" xref="S3.SS5.p1.6.m6.3.3.3"><apply id="S3.SS5.p1.6.m6.1.1.1.1.cmml" xref="S3.SS5.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS5.p1.6.m6.1.1.1.1">superscript</csymbol><ci id="S3.SS5.p1.6.m6.1.1.1.1.2.cmml" xref="S3.SS5.p1.6.m6.1.1.1.1.2">𝑠</ci><ci id="S3.SS5.p1.6.m6.1.1.1.1.3a.cmml" xref="S3.SS5.p1.6.m6.1.1.1.1.3"><mtext id="S3.SS5.p1.6.m6.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p1.6.m6.1.1.1.1.3">l</mtext></ci></apply><apply id="S3.SS5.p1.6.m6.2.2.2.2.cmml" xref="S3.SS5.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.p1.6.m6.2.2.2.2.1.cmml" xref="S3.SS5.p1.6.m6.2.2.2.2">superscript</csymbol><ci id="S3.SS5.p1.6.m6.2.2.2.2.2.cmml" xref="S3.SS5.p1.6.m6.2.2.2.2.2">𝑎</ci><ci id="S3.SS5.p1.6.m6.2.2.2.2.3a.cmml" xref="S3.SS5.p1.6.m6.2.2.2.2.3"><mtext id="S3.SS5.p1.6.m6.2.2.2.2.3.cmml" mathsize="70%" xref="S3.SS5.p1.6.m6.2.2.2.2.3">l</mtext></ci></apply><apply id="S3.SS5.p1.6.m6.3.3.3.3.cmml" xref="S3.SS5.p1.6.m6.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS5.p1.6.m6.3.3.3.3.1.cmml" xref="S3.SS5.p1.6.m6.3.3.3.3">superscript</csymbol><ci id="S3.SS5.p1.6.m6.3.3.3.3.2.cmml" xref="S3.SS5.p1.6.m6.3.3.3.3.2">𝑟</ci><ci id="S3.SS5.p1.6.m6.3.3.3.3.3a.cmml" xref="S3.SS5.p1.6.m6.3.3.3.3.3"><mtext id="S3.SS5.p1.6.m6.3.3.3.3.3.cmml" mathsize="70%" xref="S3.SS5.p1.6.m6.3.3.3.3.3">l</mtext></ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.6.m6.3c">(s^{\text{l}},a^{\text{l}},r^{\text{l}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.6.m6.3d">( italic_s start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT , italic_r start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT )</annotation></semantics></math>. Below are further detailed definitions:</p>
<ul class="ltx_itemize" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.4"><span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.1">High-Level State <math alttext="s^{\text{h}}" class="ltx_Math" display="inline" id="S3.I2.i1.p1.1.1.m1.1"><semantics id="S3.I2.i1.p1.1.1.m1.1a"><msup id="S3.I2.i1.p1.1.1.m1.1.1" xref="S3.I2.i1.p1.1.1.m1.1.1.cmml"><mi id="S3.I2.i1.p1.1.1.m1.1.1.2" xref="S3.I2.i1.p1.1.1.m1.1.1.2.cmml">s</mi><mtext class="ltx_mathvariant_bold" id="S3.I2.i1.p1.1.1.m1.1.1.3" xref="S3.I2.i1.p1.1.1.m1.1.1.3a.cmml">h</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.1.m1.1b"><apply id="S3.I2.i1.p1.1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i1.p1.1.1.m1.1.1.1.cmml" xref="S3.I2.i1.p1.1.1.m1.1.1">superscript</csymbol><ci id="S3.I2.i1.p1.1.1.m1.1.1.2.cmml" xref="S3.I2.i1.p1.1.1.m1.1.1.2">𝑠</ci><ci id="S3.I2.i1.p1.1.1.m1.1.1.3a.cmml" xref="S3.I2.i1.p1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.I2.i1.p1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.I2.i1.p1.1.1.m1.1.1.3">h</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.1.m1.1c">s^{\text{h}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.1.1.m1.1d">italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT</annotation></semantics></math></span>: the user preference including the user profile <math alttext="u" class="ltx_Math" display="inline" id="S3.I2.i1.p1.2.m1.1"><semantics id="S3.I2.i1.p1.2.m1.1a"><mi id="S3.I2.i1.p1.2.m1.1.1" xref="S3.I2.i1.p1.2.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.2.m1.1b"><ci id="S3.I2.i1.p1.2.m1.1.1.cmml" xref="S3.I2.i1.p1.2.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.2.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.2.m1.1d">italic_u</annotation></semantics></math>, the user-wise browsing session histories <math alttext="\mathbf{l}:=\{l_{1},l_{2},\cdots,l_{N^{l}}\}" class="ltx_Math" display="inline" id="S3.I2.i1.p1.3.m2.4"><semantics id="S3.I2.i1.p1.3.m2.4a"><mrow id="S3.I2.i1.p1.3.m2.4.4" xref="S3.I2.i1.p1.3.m2.4.4.cmml"><mi id="S3.I2.i1.p1.3.m2.4.4.5" xref="S3.I2.i1.p1.3.m2.4.4.5.cmml">𝐥</mi><mo id="S3.I2.i1.p1.3.m2.4.4.4" lspace="0.278em" rspace="0.278em" xref="S3.I2.i1.p1.3.m2.4.4.4.cmml">:=</mo><mrow id="S3.I2.i1.p1.3.m2.4.4.3.3" xref="S3.I2.i1.p1.3.m2.4.4.3.4.cmml"><mo id="S3.I2.i1.p1.3.m2.4.4.3.3.4" stretchy="false" xref="S3.I2.i1.p1.3.m2.4.4.3.4.cmml">{</mo><msub id="S3.I2.i1.p1.3.m2.2.2.1.1.1" xref="S3.I2.i1.p1.3.m2.2.2.1.1.1.cmml"><mi id="S3.I2.i1.p1.3.m2.2.2.1.1.1.2" xref="S3.I2.i1.p1.3.m2.2.2.1.1.1.2.cmml">l</mi><mn id="S3.I2.i1.p1.3.m2.2.2.1.1.1.3" xref="S3.I2.i1.p1.3.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.I2.i1.p1.3.m2.4.4.3.3.5" xref="S3.I2.i1.p1.3.m2.4.4.3.4.cmml">,</mo><msub id="S3.I2.i1.p1.3.m2.3.3.2.2.2" xref="S3.I2.i1.p1.3.m2.3.3.2.2.2.cmml"><mi id="S3.I2.i1.p1.3.m2.3.3.2.2.2.2" xref="S3.I2.i1.p1.3.m2.3.3.2.2.2.2.cmml">l</mi><mn id="S3.I2.i1.p1.3.m2.3.3.2.2.2.3" xref="S3.I2.i1.p1.3.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.I2.i1.p1.3.m2.4.4.3.3.6" xref="S3.I2.i1.p1.3.m2.4.4.3.4.cmml">,</mo><mi id="S3.I2.i1.p1.3.m2.1.1" mathvariant="normal" xref="S3.I2.i1.p1.3.m2.1.1.cmml">⋯</mi><mo id="S3.I2.i1.p1.3.m2.4.4.3.3.7" xref="S3.I2.i1.p1.3.m2.4.4.3.4.cmml">,</mo><msub id="S3.I2.i1.p1.3.m2.4.4.3.3.3" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3.cmml"><mi id="S3.I2.i1.p1.3.m2.4.4.3.3.3.2" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3.2.cmml">l</mi><msup id="S3.I2.i1.p1.3.m2.4.4.3.3.3.3" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3.3.cmml"><mi id="S3.I2.i1.p1.3.m2.4.4.3.3.3.3.2" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3.3.2.cmml">N</mi><mi id="S3.I2.i1.p1.3.m2.4.4.3.3.3.3.3" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3.3.3.cmml">l</mi></msup></msub><mo id="S3.I2.i1.p1.3.m2.4.4.3.3.8" stretchy="false" xref="S3.I2.i1.p1.3.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.3.m2.4b"><apply id="S3.I2.i1.p1.3.m2.4.4.cmml" xref="S3.I2.i1.p1.3.m2.4.4"><csymbol cd="latexml" id="S3.I2.i1.p1.3.m2.4.4.4.cmml" xref="S3.I2.i1.p1.3.m2.4.4.4">assign</csymbol><ci id="S3.I2.i1.p1.3.m2.4.4.5.cmml" xref="S3.I2.i1.p1.3.m2.4.4.5">𝐥</ci><set id="S3.I2.i1.p1.3.m2.4.4.3.4.cmml" xref="S3.I2.i1.p1.3.m2.4.4.3.3"><apply id="S3.I2.i1.p1.3.m2.2.2.1.1.1.cmml" xref="S3.I2.i1.p1.3.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.I2.i1.p1.3.m2.2.2.1.1.1.1.cmml" xref="S3.I2.i1.p1.3.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.I2.i1.p1.3.m2.2.2.1.1.1.2.cmml" xref="S3.I2.i1.p1.3.m2.2.2.1.1.1.2">𝑙</ci><cn id="S3.I2.i1.p1.3.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.I2.i1.p1.3.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.I2.i1.p1.3.m2.3.3.2.2.2.cmml" xref="S3.I2.i1.p1.3.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.I2.i1.p1.3.m2.3.3.2.2.2.1.cmml" xref="S3.I2.i1.p1.3.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.I2.i1.p1.3.m2.3.3.2.2.2.2.cmml" xref="S3.I2.i1.p1.3.m2.3.3.2.2.2.2">𝑙</ci><cn id="S3.I2.i1.p1.3.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.I2.i1.p1.3.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.I2.i1.p1.3.m2.1.1.cmml" xref="S3.I2.i1.p1.3.m2.1.1">⋯</ci><apply id="S3.I2.i1.p1.3.m2.4.4.3.3.3.cmml" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.I2.i1.p1.3.m2.4.4.3.3.3.1.cmml" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.I2.i1.p1.3.m2.4.4.3.3.3.2.cmml" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3.2">𝑙</ci><apply id="S3.I2.i1.p1.3.m2.4.4.3.3.3.3.cmml" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.I2.i1.p1.3.m2.4.4.3.3.3.3.1.cmml" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3.3">superscript</csymbol><ci id="S3.I2.i1.p1.3.m2.4.4.3.3.3.3.2.cmml" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3.3.2">𝑁</ci><ci id="S3.I2.i1.p1.3.m2.4.4.3.3.3.3.3.cmml" xref="S3.I2.i1.p1.3.m2.4.4.3.3.3.3.3">𝑙</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.3.m2.4c">\mathbf{l}:=\{l_{1},l_{2},\cdots,l_{N^{l}}\}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.3.m2.4d">bold_l := { italic_l start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_l start_POSTSUBSCRIPT italic_N start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math>, and the outra-session context <math alttext="c^{o}" class="ltx_Math" display="inline" id="S3.I2.i1.p1.4.m3.1"><semantics id="S3.I2.i1.p1.4.m3.1a"><msup id="S3.I2.i1.p1.4.m3.1.1" xref="S3.I2.i1.p1.4.m3.1.1.cmml"><mi id="S3.I2.i1.p1.4.m3.1.1.2" xref="S3.I2.i1.p1.4.m3.1.1.2.cmml">c</mi><mi id="S3.I2.i1.p1.4.m3.1.1.3" xref="S3.I2.i1.p1.4.m3.1.1.3.cmml">o</mi></msup><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.4.m3.1b"><apply id="S3.I2.i1.p1.4.m3.1.1.cmml" xref="S3.I2.i1.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S3.I2.i1.p1.4.m3.1.1.1.cmml" xref="S3.I2.i1.p1.4.m3.1.1">superscript</csymbol><ci id="S3.I2.i1.p1.4.m3.1.1.2.cmml" xref="S3.I2.i1.p1.4.m3.1.1.2">𝑐</ci><ci id="S3.I2.i1.p1.4.m3.1.1.3.cmml" xref="S3.I2.i1.p1.4.m3.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.4.m3.1c">c^{o}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.4.m3.1d">italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.2"><span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.1.1">High-Level Action <math alttext="a^{\text{h}}" class="ltx_Math" display="inline" id="S3.I2.i2.p1.1.1.m1.1"><semantics id="S3.I2.i2.p1.1.1.m1.1a"><msup id="S3.I2.i2.p1.1.1.m1.1.1" xref="S3.I2.i2.p1.1.1.m1.1.1.cmml"><mi id="S3.I2.i2.p1.1.1.m1.1.1.2" xref="S3.I2.i2.p1.1.1.m1.1.1.2.cmml">a</mi><mtext class="ltx_mathvariant_bold" id="S3.I2.i2.p1.1.1.m1.1.1.3" xref="S3.I2.i2.p1.1.1.m1.1.1.3a.cmml">h</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.1.1.m1.1b"><apply id="S3.I2.i2.p1.1.1.m1.1.1.cmml" xref="S3.I2.i2.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i2.p1.1.1.m1.1.1.1.cmml" xref="S3.I2.i2.p1.1.1.m1.1.1">superscript</csymbol><ci id="S3.I2.i2.p1.1.1.m1.1.1.2.cmml" xref="S3.I2.i2.p1.1.1.m1.1.1.2">𝑎</ci><ci id="S3.I2.i2.p1.1.1.m1.1.1.3a.cmml" xref="S3.I2.i2.p1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.I2.i2.p1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.I2.i2.p1.1.1.m1.1.1.3">h</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.1.1.m1.1c">a^{\text{h}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.1.1.m1.1d">italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT</annotation></semantics></math></span>: embedding of the favorable recommended session <math alttext="l\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S3.I2.i2.p1.2.m1.1"><semantics id="S3.I2.i2.p1.2.m1.1a"><mrow id="S3.I2.i2.p1.2.m1.1.1" xref="S3.I2.i2.p1.2.m1.1.1.cmml"><mi id="S3.I2.i2.p1.2.m1.1.1.2" xref="S3.I2.i2.p1.2.m1.1.1.2.cmml">l</mi><mo id="S3.I2.i2.p1.2.m1.1.1.1" xref="S3.I2.i2.p1.2.m1.1.1.1.cmml">∈</mo><msup id="S3.I2.i2.p1.2.m1.1.1.3" xref="S3.I2.i2.p1.2.m1.1.1.3.cmml"><mi id="S3.I2.i2.p1.2.m1.1.1.3.2" xref="S3.I2.i2.p1.2.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.I2.i2.p1.2.m1.1.1.3.3" xref="S3.I2.i2.p1.2.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.2.m1.1b"><apply id="S3.I2.i2.p1.2.m1.1.1.cmml" xref="S3.I2.i2.p1.2.m1.1.1"><in id="S3.I2.i2.p1.2.m1.1.1.1.cmml" xref="S3.I2.i2.p1.2.m1.1.1.1"></in><ci id="S3.I2.i2.p1.2.m1.1.1.2.cmml" xref="S3.I2.i2.p1.2.m1.1.1.2">𝑙</ci><apply id="S3.I2.i2.p1.2.m1.1.1.3.cmml" xref="S3.I2.i2.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.I2.i2.p1.2.m1.1.1.3.1.cmml" xref="S3.I2.i2.p1.2.m1.1.1.3">superscript</csymbol><ci id="S3.I2.i2.p1.2.m1.1.1.3.2.cmml" xref="S3.I2.i2.p1.2.m1.1.1.3.2">ℝ</ci><ci id="S3.I2.i2.p1.2.m1.1.1.3.3.cmml" xref="S3.I2.i2.p1.2.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.2.m1.1c">l\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.2.m1.1d">italic_l ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>.
</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i3.p1">
<p class="ltx_p" id="S3.I2.i3.p1.2"><span class="ltx_text ltx_font_bold" id="S3.I2.i3.p1.1.1">High-Level Reward <math alttext="r^{\text{h}}" class="ltx_Math" display="inline" id="S3.I2.i3.p1.1.1.m1.1"><semantics id="S3.I2.i3.p1.1.1.m1.1a"><msup id="S3.I2.i3.p1.1.1.m1.1.1" xref="S3.I2.i3.p1.1.1.m1.1.1.cmml"><mi id="S3.I2.i3.p1.1.1.m1.1.1.2" xref="S3.I2.i3.p1.1.1.m1.1.1.2.cmml">r</mi><mtext class="ltx_mathvariant_bold" id="S3.I2.i3.p1.1.1.m1.1.1.3" xref="S3.I2.i3.p1.1.1.m1.1.1.3a.cmml">h</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.I2.i3.p1.1.1.m1.1b"><apply id="S3.I2.i3.p1.1.1.m1.1.1.cmml" xref="S3.I2.i3.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i3.p1.1.1.m1.1.1.1.cmml" xref="S3.I2.i3.p1.1.1.m1.1.1">superscript</csymbol><ci id="S3.I2.i3.p1.1.1.m1.1.1.2.cmml" xref="S3.I2.i3.p1.1.1.m1.1.1.2">𝑟</ci><ci id="S3.I2.i3.p1.1.1.m1.1.1.3a.cmml" xref="S3.I2.i3.p1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.I2.i3.p1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.I2.i3.p1.1.1.m1.1.1.3">h</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i3.p1.1.1.m1.1c">r^{\text{h}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i3.p1.1.1.m1.1d">italic_r start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT</annotation></semantics></math></span>: the user CTR response w.r.t the current session, <span class="ltx_text ltx_font_italic" id="S3.I2.i3.p1.2.2">i.e.</span>, <math alttext="\sum\mathbf{c}/K" class="ltx_Math" display="inline" id="S3.I2.i3.p1.2.m1.1"><semantics id="S3.I2.i3.p1.2.m1.1a"><mrow id="S3.I2.i3.p1.2.m1.1.1" xref="S3.I2.i3.p1.2.m1.1.1.cmml"><mo id="S3.I2.i3.p1.2.m1.1.1.1" xref="S3.I2.i3.p1.2.m1.1.1.1.cmml">∑</mo><mrow id="S3.I2.i3.p1.2.m1.1.1.2" xref="S3.I2.i3.p1.2.m1.1.1.2.cmml"><mi id="S3.I2.i3.p1.2.m1.1.1.2.2" xref="S3.I2.i3.p1.2.m1.1.1.2.2.cmml">𝐜</mi><mo id="S3.I2.i3.p1.2.m1.1.1.2.1" xref="S3.I2.i3.p1.2.m1.1.1.2.1.cmml">/</mo><mi id="S3.I2.i3.p1.2.m1.1.1.2.3" xref="S3.I2.i3.p1.2.m1.1.1.2.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i3.p1.2.m1.1b"><apply id="S3.I2.i3.p1.2.m1.1.1.cmml" xref="S3.I2.i3.p1.2.m1.1.1"><sum id="S3.I2.i3.p1.2.m1.1.1.1.cmml" xref="S3.I2.i3.p1.2.m1.1.1.1"></sum><apply id="S3.I2.i3.p1.2.m1.1.1.2.cmml" xref="S3.I2.i3.p1.2.m1.1.1.2"><divide id="S3.I2.i3.p1.2.m1.1.1.2.1.cmml" xref="S3.I2.i3.p1.2.m1.1.1.2.1"></divide><ci id="S3.I2.i3.p1.2.m1.1.1.2.2.cmml" xref="S3.I2.i3.p1.2.m1.1.1.2.2">𝐜</ci><ci id="S3.I2.i3.p1.2.m1.1.1.2.3.cmml" xref="S3.I2.i3.p1.2.m1.1.1.2.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i3.p1.2.m1.1c">\sum\mathbf{c}/K</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i3.p1.2.m1.1d">∑ bold_c / italic_K</annotation></semantics></math>.
</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i4.p1">
<p class="ltx_p" id="S3.I2.i4.p1.5"><span class="ltx_text ltx_font_bold" id="S3.I2.i4.p1.1.1">Low-Level State <math alttext="s^{\text{l}}" class="ltx_Math" display="inline" id="S3.I2.i4.p1.1.1.m1.1"><semantics id="S3.I2.i4.p1.1.1.m1.1a"><msup id="S3.I2.i4.p1.1.1.m1.1.1" xref="S3.I2.i4.p1.1.1.m1.1.1.cmml"><mi id="S3.I2.i4.p1.1.1.m1.1.1.2" xref="S3.I2.i4.p1.1.1.m1.1.1.2.cmml">s</mi><mtext class="ltx_mathvariant_bold" id="S3.I2.i4.p1.1.1.m1.1.1.3" xref="S3.I2.i4.p1.1.1.m1.1.1.3a.cmml">l</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.I2.i4.p1.1.1.m1.1b"><apply id="S3.I2.i4.p1.1.1.m1.1.1.cmml" xref="S3.I2.i4.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i4.p1.1.1.m1.1.1.1.cmml" xref="S3.I2.i4.p1.1.1.m1.1.1">superscript</csymbol><ci id="S3.I2.i4.p1.1.1.m1.1.1.2.cmml" xref="S3.I2.i4.p1.1.1.m1.1.1.2">𝑠</ci><ci id="S3.I2.i4.p1.1.1.m1.1.1.3a.cmml" xref="S3.I2.i4.p1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.I2.i4.p1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.I2.i4.p1.1.1.m1.1.1.3">l</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i4.p1.1.1.m1.1c">s^{\text{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i4.p1.1.1.m1.1d">italic_s start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT</annotation></semantics></math></span>: past item-selection decisions within a session inference. It includes the user on-device feature <math alttext="m" class="ltx_Math" display="inline" id="S3.I2.i4.p1.2.m1.1"><semantics id="S3.I2.i4.p1.2.m1.1a"><mi id="S3.I2.i4.p1.2.m1.1.1" xref="S3.I2.i4.p1.2.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i4.p1.2.m1.1b"><ci id="S3.I2.i4.p1.2.m1.1.1.cmml" xref="S3.I2.i4.p1.2.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i4.p1.2.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i4.p1.2.m1.1d">italic_m</annotation></semantics></math>, the intra-session context <math alttext="c^{i}" class="ltx_Math" display="inline" id="S3.I2.i4.p1.3.m2.1"><semantics id="S3.I2.i4.p1.3.m2.1a"><msup id="S3.I2.i4.p1.3.m2.1.1" xref="S3.I2.i4.p1.3.m2.1.1.cmml"><mi id="S3.I2.i4.p1.3.m2.1.1.2" xref="S3.I2.i4.p1.3.m2.1.1.2.cmml">c</mi><mi id="S3.I2.i4.p1.3.m2.1.1.3" xref="S3.I2.i4.p1.3.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.I2.i4.p1.3.m2.1b"><apply id="S3.I2.i4.p1.3.m2.1.1.cmml" xref="S3.I2.i4.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S3.I2.i4.p1.3.m2.1.1.1.cmml" xref="S3.I2.i4.p1.3.m2.1.1">superscript</csymbol><ci id="S3.I2.i4.p1.3.m2.1.1.2.cmml" xref="S3.I2.i4.p1.3.m2.1.1.2">𝑐</ci><ci id="S3.I2.i4.p1.3.m2.1.1.3.cmml" xref="S3.I2.i4.p1.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i4.p1.3.m2.1c">c^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i4.p1.3.m2.1d">italic_c start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>, the current selected item sequence <math alttext="\{e_{1},e_{2},\cdots,e_{k}\}" class="ltx_Math" display="inline" id="S3.I2.i4.p1.4.m3.4"><semantics id="S3.I2.i4.p1.4.m3.4a"><mrow id="S3.I2.i4.p1.4.m3.4.4.3" xref="S3.I2.i4.p1.4.m3.4.4.4.cmml"><mo id="S3.I2.i4.p1.4.m3.4.4.3.4" stretchy="false" xref="S3.I2.i4.p1.4.m3.4.4.4.cmml">{</mo><msub id="S3.I2.i4.p1.4.m3.2.2.1.1" xref="S3.I2.i4.p1.4.m3.2.2.1.1.cmml"><mi id="S3.I2.i4.p1.4.m3.2.2.1.1.2" xref="S3.I2.i4.p1.4.m3.2.2.1.1.2.cmml">e</mi><mn id="S3.I2.i4.p1.4.m3.2.2.1.1.3" xref="S3.I2.i4.p1.4.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.I2.i4.p1.4.m3.4.4.3.5" xref="S3.I2.i4.p1.4.m3.4.4.4.cmml">,</mo><msub id="S3.I2.i4.p1.4.m3.3.3.2.2" xref="S3.I2.i4.p1.4.m3.3.3.2.2.cmml"><mi id="S3.I2.i4.p1.4.m3.3.3.2.2.2" xref="S3.I2.i4.p1.4.m3.3.3.2.2.2.cmml">e</mi><mn id="S3.I2.i4.p1.4.m3.3.3.2.2.3" xref="S3.I2.i4.p1.4.m3.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.I2.i4.p1.4.m3.4.4.3.6" xref="S3.I2.i4.p1.4.m3.4.4.4.cmml">,</mo><mi id="S3.I2.i4.p1.4.m3.1.1" mathvariant="normal" xref="S3.I2.i4.p1.4.m3.1.1.cmml">⋯</mi><mo id="S3.I2.i4.p1.4.m3.4.4.3.7" xref="S3.I2.i4.p1.4.m3.4.4.4.cmml">,</mo><msub id="S3.I2.i4.p1.4.m3.4.4.3.3" xref="S3.I2.i4.p1.4.m3.4.4.3.3.cmml"><mi id="S3.I2.i4.p1.4.m3.4.4.3.3.2" xref="S3.I2.i4.p1.4.m3.4.4.3.3.2.cmml">e</mi><mi id="S3.I2.i4.p1.4.m3.4.4.3.3.3" xref="S3.I2.i4.p1.4.m3.4.4.3.3.3.cmml">k</mi></msub><mo id="S3.I2.i4.p1.4.m3.4.4.3.8" stretchy="false" xref="S3.I2.i4.p1.4.m3.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i4.p1.4.m3.4b"><set id="S3.I2.i4.p1.4.m3.4.4.4.cmml" xref="S3.I2.i4.p1.4.m3.4.4.3"><apply id="S3.I2.i4.p1.4.m3.2.2.1.1.cmml" xref="S3.I2.i4.p1.4.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.I2.i4.p1.4.m3.2.2.1.1.1.cmml" xref="S3.I2.i4.p1.4.m3.2.2.1.1">subscript</csymbol><ci id="S3.I2.i4.p1.4.m3.2.2.1.1.2.cmml" xref="S3.I2.i4.p1.4.m3.2.2.1.1.2">𝑒</ci><cn id="S3.I2.i4.p1.4.m3.2.2.1.1.3.cmml" type="integer" xref="S3.I2.i4.p1.4.m3.2.2.1.1.3">1</cn></apply><apply id="S3.I2.i4.p1.4.m3.3.3.2.2.cmml" xref="S3.I2.i4.p1.4.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.I2.i4.p1.4.m3.3.3.2.2.1.cmml" xref="S3.I2.i4.p1.4.m3.3.3.2.2">subscript</csymbol><ci id="S3.I2.i4.p1.4.m3.3.3.2.2.2.cmml" xref="S3.I2.i4.p1.4.m3.3.3.2.2.2">𝑒</ci><cn id="S3.I2.i4.p1.4.m3.3.3.2.2.3.cmml" type="integer" xref="S3.I2.i4.p1.4.m3.3.3.2.2.3">2</cn></apply><ci id="S3.I2.i4.p1.4.m3.1.1.cmml" xref="S3.I2.i4.p1.4.m3.1.1">⋯</ci><apply id="S3.I2.i4.p1.4.m3.4.4.3.3.cmml" xref="S3.I2.i4.p1.4.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.I2.i4.p1.4.m3.4.4.3.3.1.cmml" xref="S3.I2.i4.p1.4.m3.4.4.3.3">subscript</csymbol><ci id="S3.I2.i4.p1.4.m3.4.4.3.3.2.cmml" xref="S3.I2.i4.p1.4.m3.4.4.3.3.2">𝑒</ci><ci id="S3.I2.i4.p1.4.m3.4.4.3.3.3.cmml" xref="S3.I2.i4.p1.4.m3.4.4.3.3.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i4.p1.4.m3.4c">\{e_{1},e_{2},\cdots,e_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i4.p1.4.m3.4d">{ italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math>, and also the user profile <math alttext="u" class="ltx_Math" display="inline" id="S3.I2.i4.p1.5.m4.1"><semantics id="S3.I2.i4.p1.5.m4.1a"><mi id="S3.I2.i4.p1.5.m4.1.1" xref="S3.I2.i4.p1.5.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i4.p1.5.m4.1b"><ci id="S3.I2.i4.p1.5.m4.1.1.cmml" xref="S3.I2.i4.p1.5.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i4.p1.5.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i4.p1.5.m4.1d">italic_u</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i5.p1">
<p class="ltx_p" id="S3.I2.i5.p1.2"><span class="ltx_text ltx_font_bold" id="S3.I2.i5.p1.1.1">Low-Level Action <math alttext="a^{\text{l}}" class="ltx_Math" display="inline" id="S3.I2.i5.p1.1.1.m1.1"><semantics id="S3.I2.i5.p1.1.1.m1.1a"><msup id="S3.I2.i5.p1.1.1.m1.1.1" xref="S3.I2.i5.p1.1.1.m1.1.1.cmml"><mi id="S3.I2.i5.p1.1.1.m1.1.1.2" xref="S3.I2.i5.p1.1.1.m1.1.1.2.cmml">a</mi><mtext class="ltx_mathvariant_bold" id="S3.I2.i5.p1.1.1.m1.1.1.3" xref="S3.I2.i5.p1.1.1.m1.1.1.3a.cmml">l</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.I2.i5.p1.1.1.m1.1b"><apply id="S3.I2.i5.p1.1.1.m1.1.1.cmml" xref="S3.I2.i5.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i5.p1.1.1.m1.1.1.1.cmml" xref="S3.I2.i5.p1.1.1.m1.1.1">superscript</csymbol><ci id="S3.I2.i5.p1.1.1.m1.1.1.2.cmml" xref="S3.I2.i5.p1.1.1.m1.1.1.2">𝑎</ci><ci id="S3.I2.i5.p1.1.1.m1.1.1.3a.cmml" xref="S3.I2.i5.p1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.I2.i5.p1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.I2.i5.p1.1.1.m1.1.1.3">l</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i5.p1.1.1.m1.1c">a^{\text{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i5.p1.1.1.m1.1d">italic_a start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT</annotation></semantics></math></span>: the studied user local, preference <math alttext="\hat{e}_{k}\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S3.I2.i5.p1.2.m1.1"><semantics id="S3.I2.i5.p1.2.m1.1a"><mrow id="S3.I2.i5.p1.2.m1.1.1" xref="S3.I2.i5.p1.2.m1.1.1.cmml"><msub id="S3.I2.i5.p1.2.m1.1.1.2" xref="S3.I2.i5.p1.2.m1.1.1.2.cmml"><mover accent="true" id="S3.I2.i5.p1.2.m1.1.1.2.2" xref="S3.I2.i5.p1.2.m1.1.1.2.2.cmml"><mi id="S3.I2.i5.p1.2.m1.1.1.2.2.2" xref="S3.I2.i5.p1.2.m1.1.1.2.2.2.cmml">e</mi><mo id="S3.I2.i5.p1.2.m1.1.1.2.2.1" xref="S3.I2.i5.p1.2.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.I2.i5.p1.2.m1.1.1.2.3" xref="S3.I2.i5.p1.2.m1.1.1.2.3.cmml">k</mi></msub><mo id="S3.I2.i5.p1.2.m1.1.1.1" xref="S3.I2.i5.p1.2.m1.1.1.1.cmml">∈</mo><msup id="S3.I2.i5.p1.2.m1.1.1.3" xref="S3.I2.i5.p1.2.m1.1.1.3.cmml"><mi id="S3.I2.i5.p1.2.m1.1.1.3.2" xref="S3.I2.i5.p1.2.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.I2.i5.p1.2.m1.1.1.3.3" xref="S3.I2.i5.p1.2.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i5.p1.2.m1.1b"><apply id="S3.I2.i5.p1.2.m1.1.1.cmml" xref="S3.I2.i5.p1.2.m1.1.1"><in id="S3.I2.i5.p1.2.m1.1.1.1.cmml" xref="S3.I2.i5.p1.2.m1.1.1.1"></in><apply id="S3.I2.i5.p1.2.m1.1.1.2.cmml" xref="S3.I2.i5.p1.2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.I2.i5.p1.2.m1.1.1.2.1.cmml" xref="S3.I2.i5.p1.2.m1.1.1.2">subscript</csymbol><apply id="S3.I2.i5.p1.2.m1.1.1.2.2.cmml" xref="S3.I2.i5.p1.2.m1.1.1.2.2"><ci id="S3.I2.i5.p1.2.m1.1.1.2.2.1.cmml" xref="S3.I2.i5.p1.2.m1.1.1.2.2.1">^</ci><ci id="S3.I2.i5.p1.2.m1.1.1.2.2.2.cmml" xref="S3.I2.i5.p1.2.m1.1.1.2.2.2">𝑒</ci></apply><ci id="S3.I2.i5.p1.2.m1.1.1.2.3.cmml" xref="S3.I2.i5.p1.2.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.I2.i5.p1.2.m1.1.1.3.cmml" xref="S3.I2.i5.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.I2.i5.p1.2.m1.1.1.3.1.cmml" xref="S3.I2.i5.p1.2.m1.1.1.3">superscript</csymbol><ci id="S3.I2.i5.p1.2.m1.1.1.3.2.cmml" xref="S3.I2.i5.p1.2.m1.1.1.3.2">ℝ</ci><ci id="S3.I2.i5.p1.2.m1.1.1.3.3.cmml" xref="S3.I2.i5.p1.2.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i5.p1.2.m1.1c">\hat{e}_{k}\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i5.p1.2.m1.1d">over^ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>, as an indicator for item selection.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i6.p1">
<p class="ltx_p" id="S3.I2.i6.p1.2"><span class="ltx_text ltx_font_bold" id="S3.I2.i6.p1.1.1">Low-Level Reward <math alttext="r^{\text{l}}" class="ltx_Math" display="inline" id="S3.I2.i6.p1.1.1.m1.1"><semantics id="S3.I2.i6.p1.1.1.m1.1a"><msup id="S3.I2.i6.p1.1.1.m1.1.1" xref="S3.I2.i6.p1.1.1.m1.1.1.cmml"><mi id="S3.I2.i6.p1.1.1.m1.1.1.2" xref="S3.I2.i6.p1.1.1.m1.1.1.2.cmml">r</mi><mtext class="ltx_mathvariant_bold" id="S3.I2.i6.p1.1.1.m1.1.1.3" xref="S3.I2.i6.p1.1.1.m1.1.1.3a.cmml">l</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.I2.i6.p1.1.1.m1.1b"><apply id="S3.I2.i6.p1.1.1.m1.1.1.cmml" xref="S3.I2.i6.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i6.p1.1.1.m1.1.1.1.cmml" xref="S3.I2.i6.p1.1.1.m1.1.1">superscript</csymbol><ci id="S3.I2.i6.p1.1.1.m1.1.1.2.cmml" xref="S3.I2.i6.p1.1.1.m1.1.1.2">𝑟</ci><ci id="S3.I2.i6.p1.1.1.m1.1.1.3a.cmml" xref="S3.I2.i6.p1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.I2.i6.p1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.I2.i6.p1.1.1.m1.1.1.3">l</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i6.p1.1.1.m1.1c">r^{\text{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i6.p1.1.1.m1.1d">italic_r start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT</annotation></semantics></math></span>: the intrinsic motivation received by LRA. Here we embrace the goal-conditioned framework of HRL <cite class="ltx_cite ltx_citemacro_cite">Vezhnevets et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib24" title="">2017</a>); Nachum et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib21" title="">2018</a>); Nasiriany et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib22" title="">2019</a>)</cite>, <span class="ltx_text ltx_font_italic" id="S3.I2.i6.p1.2.2">i.e.</span>, the nearest action of HRA studies the current user preference and therefore can be used to calculate the goal of LRA action. For instance, the LRA reward <math alttext="r^{\text{l}}" class="ltx_Math" display="inline" id="S3.I2.i6.p1.2.m1.1"><semantics id="S3.I2.i6.p1.2.m1.1a"><msup id="S3.I2.i6.p1.2.m1.1.1" xref="S3.I2.i6.p1.2.m1.1.1.cmml"><mi id="S3.I2.i6.p1.2.m1.1.1.2" xref="S3.I2.i6.p1.2.m1.1.1.2.cmml">r</mi><mtext id="S3.I2.i6.p1.2.m1.1.1.3" xref="S3.I2.i6.p1.2.m1.1.1.3a.cmml">l</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.I2.i6.p1.2.m1.1b"><apply id="S3.I2.i6.p1.2.m1.1.1.cmml" xref="S3.I2.i6.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i6.p1.2.m1.1.1.1.cmml" xref="S3.I2.i6.p1.2.m1.1.1">superscript</csymbol><ci id="S3.I2.i6.p1.2.m1.1.1.2.cmml" xref="S3.I2.i6.p1.2.m1.1.1.2">𝑟</ci><ci id="S3.I2.i6.p1.2.m1.1.1.3a.cmml" xref="S3.I2.i6.p1.2.m1.1.1.3"><mtext id="S3.I2.i6.p1.2.m1.1.1.3.cmml" mathsize="70%" xref="S3.I2.i6.p1.2.m1.1.1.3">l</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i6.p1.2.m1.1c">r^{\text{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i6.p1.2.m1.1d">italic_r start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT</annotation></semantics></math> can be simply formulated as the Ellucidian distance between the HRA action and LRA action.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.2">Objectives of HRA and LRA are then formulated as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S7.EGx2">
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle J^{\text{h}}(a^{\text{h}})" class="ltx_Math" display="inline" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><msup id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml">J</mi><mtext id="S3.E8.m1.1.1.3.3" xref="S3.E8.m1.1.1.3.3a.cmml">h</mtext></msup><mo id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.cmml">(</mo><msup id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.2.cmml">a</mi><mtext id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3a.cmml">h</mtext></msup><mo id="S3.E8.m1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><times id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"></times><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3">superscript</csymbol><ci id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3.2">𝐽</ci><ci id="S3.E8.m1.1.1.3.3a.cmml" xref="S3.E8.m1.1.1.3.3"><mtext id="S3.E8.m1.1.1.3.3.cmml" mathsize="70%" xref="S3.E8.m1.1.1.3.3">h</mtext></ci></apply><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.2">𝑎</ci><ci id="S3.E8.m1.1.1.1.1.1.3a.cmml" xref="S3.E8.m1.1.1.1.1.1.3"><mtext id="S3.E8.m1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E8.m1.1.1.1.1.1.3">h</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle J^{\text{h}}(a^{\text{h}})</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">italic_J start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT ( italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{t=0}^{\infty}\gamma^{t}r^{\text{h}}_{t},\quad J^{\text{l}}%
(a^{\text{l}})=\sum_{k=0}^{K}\gamma^{k}r^{\text{l}}_{k}" class="ltx_Math" display="inline" id="S3.E8.m2.2"><semantics id="S3.E8.m2.2a"><mrow id="S3.E8.m2.2.2.2" xref="S3.E8.m2.2.2.3.cmml"><mrow id="S3.E8.m2.1.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml"><mi id="S3.E8.m2.1.1.1.1.2" xref="S3.E8.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E8.m2.1.1.1.1.1" xref="S3.E8.m2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m2.1.1.1.1.3" xref="S3.E8.m2.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E8.m2.1.1.1.1.3.1" xref="S3.E8.m2.1.1.1.1.3.1.cmml"><munderover id="S3.E8.m2.1.1.1.1.3.1a" xref="S3.E8.m2.1.1.1.1.3.1.cmml"><mo id="S3.E8.m2.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.E8.m2.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E8.m2.1.1.1.1.3.1.2.3" xref="S3.E8.m2.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E8.m2.1.1.1.1.3.1.2.3.2" xref="S3.E8.m2.1.1.1.1.3.1.2.3.2.cmml">t</mi><mo id="S3.E8.m2.1.1.1.1.3.1.2.3.1" xref="S3.E8.m2.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E8.m2.1.1.1.1.3.1.2.3.3" xref="S3.E8.m2.1.1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mi id="S3.E8.m2.1.1.1.1.3.1.3" mathvariant="normal" xref="S3.E8.m2.1.1.1.1.3.1.3.cmml">∞</mi></munderover></mstyle><mrow id="S3.E8.m2.1.1.1.1.3.2" xref="S3.E8.m2.1.1.1.1.3.2.cmml"><msup id="S3.E8.m2.1.1.1.1.3.2.2" xref="S3.E8.m2.1.1.1.1.3.2.2.cmml"><mi id="S3.E8.m2.1.1.1.1.3.2.2.2" xref="S3.E8.m2.1.1.1.1.3.2.2.2.cmml">γ</mi><mi id="S3.E8.m2.1.1.1.1.3.2.2.3" xref="S3.E8.m2.1.1.1.1.3.2.2.3.cmml">t</mi></msup><mo id="S3.E8.m2.1.1.1.1.3.2.1" xref="S3.E8.m2.1.1.1.1.3.2.1.cmml">⁢</mo><msubsup id="S3.E8.m2.1.1.1.1.3.2.3" xref="S3.E8.m2.1.1.1.1.3.2.3.cmml"><mi id="S3.E8.m2.1.1.1.1.3.2.3.2.2" xref="S3.E8.m2.1.1.1.1.3.2.3.2.2.cmml">r</mi><mi id="S3.E8.m2.1.1.1.1.3.2.3.3" xref="S3.E8.m2.1.1.1.1.3.2.3.3.cmml">t</mi><mtext id="S3.E8.m2.1.1.1.1.3.2.3.2.3" xref="S3.E8.m2.1.1.1.1.3.2.3.2.3a.cmml">h</mtext></msubsup></mrow></mrow></mrow><mo id="S3.E8.m2.2.2.2.3" rspace="1.167em" xref="S3.E8.m2.2.2.3a.cmml">,</mo><mrow id="S3.E8.m2.2.2.2.2" xref="S3.E8.m2.2.2.2.2.cmml"><mrow id="S3.E8.m2.2.2.2.2.1" xref="S3.E8.m2.2.2.2.2.1.cmml"><msup id="S3.E8.m2.2.2.2.2.1.3" xref="S3.E8.m2.2.2.2.2.1.3.cmml"><mi id="S3.E8.m2.2.2.2.2.1.3.2" xref="S3.E8.m2.2.2.2.2.1.3.2.cmml">J</mi><mtext id="S3.E8.m2.2.2.2.2.1.3.3" xref="S3.E8.m2.2.2.2.2.1.3.3a.cmml">l</mtext></msup><mo id="S3.E8.m2.2.2.2.2.1.2" xref="S3.E8.m2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E8.m2.2.2.2.2.1.1.1" xref="S3.E8.m2.2.2.2.2.1.1.1.1.cmml"><mo id="S3.E8.m2.2.2.2.2.1.1.1.2" stretchy="false" xref="S3.E8.m2.2.2.2.2.1.1.1.1.cmml">(</mo><msup id="S3.E8.m2.2.2.2.2.1.1.1.1" xref="S3.E8.m2.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E8.m2.2.2.2.2.1.1.1.1.2" xref="S3.E8.m2.2.2.2.2.1.1.1.1.2.cmml">a</mi><mtext id="S3.E8.m2.2.2.2.2.1.1.1.1.3" xref="S3.E8.m2.2.2.2.2.1.1.1.1.3a.cmml">l</mtext></msup><mo id="S3.E8.m2.2.2.2.2.1.1.1.3" stretchy="false" xref="S3.E8.m2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m2.2.2.2.2.2" xref="S3.E8.m2.2.2.2.2.2.cmml">=</mo><mrow id="S3.E8.m2.2.2.2.2.3" xref="S3.E8.m2.2.2.2.2.3.cmml"><mstyle displaystyle="true" id="S3.E8.m2.2.2.2.2.3.1" xref="S3.E8.m2.2.2.2.2.3.1.cmml"><munderover id="S3.E8.m2.2.2.2.2.3.1a" xref="S3.E8.m2.2.2.2.2.3.1.cmml"><mo id="S3.E8.m2.2.2.2.2.3.1.2.2" movablelimits="false" xref="S3.E8.m2.2.2.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E8.m2.2.2.2.2.3.1.2.3" xref="S3.E8.m2.2.2.2.2.3.1.2.3.cmml"><mi id="S3.E8.m2.2.2.2.2.3.1.2.3.2" xref="S3.E8.m2.2.2.2.2.3.1.2.3.2.cmml">k</mi><mo id="S3.E8.m2.2.2.2.2.3.1.2.3.1" xref="S3.E8.m2.2.2.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E8.m2.2.2.2.2.3.1.2.3.3" xref="S3.E8.m2.2.2.2.2.3.1.2.3.3.cmml">0</mn></mrow><mi id="S3.E8.m2.2.2.2.2.3.1.3" xref="S3.E8.m2.2.2.2.2.3.1.3.cmml">K</mi></munderover></mstyle><mrow id="S3.E8.m2.2.2.2.2.3.2" xref="S3.E8.m2.2.2.2.2.3.2.cmml"><msup id="S3.E8.m2.2.2.2.2.3.2.2" xref="S3.E8.m2.2.2.2.2.3.2.2.cmml"><mi id="S3.E8.m2.2.2.2.2.3.2.2.2" xref="S3.E8.m2.2.2.2.2.3.2.2.2.cmml">γ</mi><mi id="S3.E8.m2.2.2.2.2.3.2.2.3" xref="S3.E8.m2.2.2.2.2.3.2.2.3.cmml">k</mi></msup><mo id="S3.E8.m2.2.2.2.2.3.2.1" xref="S3.E8.m2.2.2.2.2.3.2.1.cmml">⁢</mo><msubsup id="S3.E8.m2.2.2.2.2.3.2.3" xref="S3.E8.m2.2.2.2.2.3.2.3.cmml"><mi id="S3.E8.m2.2.2.2.2.3.2.3.2.2" xref="S3.E8.m2.2.2.2.2.3.2.3.2.2.cmml">r</mi><mi id="S3.E8.m2.2.2.2.2.3.2.3.3" xref="S3.E8.m2.2.2.2.2.3.2.3.3.cmml">k</mi><mtext id="S3.E8.m2.2.2.2.2.3.2.3.2.3" xref="S3.E8.m2.2.2.2.2.3.2.3.2.3a.cmml">l</mtext></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m2.2b"><apply id="S3.E8.m2.2.2.3.cmml" xref="S3.E8.m2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.3a.cmml" xref="S3.E8.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E8.m2.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1"><eq id="S3.E8.m2.1.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E8.m2.1.1.1.1.2.cmml" xref="S3.E8.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E8.m2.1.1.1.1.3.cmml" xref="S3.E8.m2.1.1.1.1.3"><apply id="S3.E8.m2.1.1.1.1.3.1.cmml" xref="S3.E8.m2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.3.1.1.cmml" xref="S3.E8.m2.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E8.m2.1.1.1.1.3.1.2.cmml" xref="S3.E8.m2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.3.1.2.1.cmml" xref="S3.E8.m2.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E8.m2.1.1.1.1.3.1.2.2.cmml" xref="S3.E8.m2.1.1.1.1.3.1.2.2"></sum><apply id="S3.E8.m2.1.1.1.1.3.1.2.3.cmml" xref="S3.E8.m2.1.1.1.1.3.1.2.3"><eq id="S3.E8.m2.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E8.m2.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E8.m2.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E8.m2.1.1.1.1.3.1.2.3.2">𝑡</ci><cn id="S3.E8.m2.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E8.m2.1.1.1.1.3.1.2.3.3">0</cn></apply></apply><infinity id="S3.E8.m2.1.1.1.1.3.1.3.cmml" xref="S3.E8.m2.1.1.1.1.3.1.3"></infinity></apply><apply id="S3.E8.m2.1.1.1.1.3.2.cmml" xref="S3.E8.m2.1.1.1.1.3.2"><times id="S3.E8.m2.1.1.1.1.3.2.1.cmml" xref="S3.E8.m2.1.1.1.1.3.2.1"></times><apply id="S3.E8.m2.1.1.1.1.3.2.2.cmml" xref="S3.E8.m2.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.3.2.2.1.cmml" xref="S3.E8.m2.1.1.1.1.3.2.2">superscript</csymbol><ci id="S3.E8.m2.1.1.1.1.3.2.2.2.cmml" xref="S3.E8.m2.1.1.1.1.3.2.2.2">𝛾</ci><ci id="S3.E8.m2.1.1.1.1.3.2.2.3.cmml" xref="S3.E8.m2.1.1.1.1.3.2.2.3">𝑡</ci></apply><apply id="S3.E8.m2.1.1.1.1.3.2.3.cmml" xref="S3.E8.m2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.3.2.3.1.cmml" xref="S3.E8.m2.1.1.1.1.3.2.3">subscript</csymbol><apply id="S3.E8.m2.1.1.1.1.3.2.3.2.cmml" xref="S3.E8.m2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m2.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E8.m2.1.1.1.1.3.2.3">superscript</csymbol><ci id="S3.E8.m2.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E8.m2.1.1.1.1.3.2.3.2.2">𝑟</ci><ci id="S3.E8.m2.1.1.1.1.3.2.3.2.3a.cmml" xref="S3.E8.m2.1.1.1.1.3.2.3.2.3"><mtext id="S3.E8.m2.1.1.1.1.3.2.3.2.3.cmml" mathsize="70%" xref="S3.E8.m2.1.1.1.1.3.2.3.2.3">h</mtext></ci></apply><ci id="S3.E8.m2.1.1.1.1.3.2.3.3.cmml" xref="S3.E8.m2.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.E8.m2.2.2.2.2.cmml" xref="S3.E8.m2.2.2.2.2"><eq id="S3.E8.m2.2.2.2.2.2.cmml" xref="S3.E8.m2.2.2.2.2.2"></eq><apply id="S3.E8.m2.2.2.2.2.1.cmml" xref="S3.E8.m2.2.2.2.2.1"><times id="S3.E8.m2.2.2.2.2.1.2.cmml" xref="S3.E8.m2.2.2.2.2.1.2"></times><apply id="S3.E8.m2.2.2.2.2.1.3.cmml" xref="S3.E8.m2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.2.2.1.3.1.cmml" xref="S3.E8.m2.2.2.2.2.1.3">superscript</csymbol><ci id="S3.E8.m2.2.2.2.2.1.3.2.cmml" xref="S3.E8.m2.2.2.2.2.1.3.2">𝐽</ci><ci id="S3.E8.m2.2.2.2.2.1.3.3a.cmml" xref="S3.E8.m2.2.2.2.2.1.3.3"><mtext id="S3.E8.m2.2.2.2.2.1.3.3.cmml" mathsize="70%" xref="S3.E8.m2.2.2.2.2.1.3.3">l</mtext></ci></apply><apply id="S3.E8.m2.2.2.2.2.1.1.1.1.cmml" xref="S3.E8.m2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E8.m2.2.2.2.2.1.1.1">superscript</csymbol><ci id="S3.E8.m2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E8.m2.2.2.2.2.1.1.1.1.2">𝑎</ci><ci id="S3.E8.m2.2.2.2.2.1.1.1.1.3a.cmml" xref="S3.E8.m2.2.2.2.2.1.1.1.1.3"><mtext id="S3.E8.m2.2.2.2.2.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E8.m2.2.2.2.2.1.1.1.1.3">l</mtext></ci></apply></apply><apply id="S3.E8.m2.2.2.2.2.3.cmml" xref="S3.E8.m2.2.2.2.2.3"><apply id="S3.E8.m2.2.2.2.2.3.1.cmml" xref="S3.E8.m2.2.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.2.2.3.1.1.cmml" xref="S3.E8.m2.2.2.2.2.3.1">superscript</csymbol><apply id="S3.E8.m2.2.2.2.2.3.1.2.cmml" xref="S3.E8.m2.2.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.2.2.3.1.2.1.cmml" xref="S3.E8.m2.2.2.2.2.3.1">subscript</csymbol><sum id="S3.E8.m2.2.2.2.2.3.1.2.2.cmml" xref="S3.E8.m2.2.2.2.2.3.1.2.2"></sum><apply id="S3.E8.m2.2.2.2.2.3.1.2.3.cmml" xref="S3.E8.m2.2.2.2.2.3.1.2.3"><eq id="S3.E8.m2.2.2.2.2.3.1.2.3.1.cmml" xref="S3.E8.m2.2.2.2.2.3.1.2.3.1"></eq><ci id="S3.E8.m2.2.2.2.2.3.1.2.3.2.cmml" xref="S3.E8.m2.2.2.2.2.3.1.2.3.2">𝑘</ci><cn id="S3.E8.m2.2.2.2.2.3.1.2.3.3.cmml" type="integer" xref="S3.E8.m2.2.2.2.2.3.1.2.3.3">0</cn></apply></apply><ci id="S3.E8.m2.2.2.2.2.3.1.3.cmml" xref="S3.E8.m2.2.2.2.2.3.1.3">𝐾</ci></apply><apply id="S3.E8.m2.2.2.2.2.3.2.cmml" xref="S3.E8.m2.2.2.2.2.3.2"><times id="S3.E8.m2.2.2.2.2.3.2.1.cmml" xref="S3.E8.m2.2.2.2.2.3.2.1"></times><apply id="S3.E8.m2.2.2.2.2.3.2.2.cmml" xref="S3.E8.m2.2.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.2.2.3.2.2.1.cmml" xref="S3.E8.m2.2.2.2.2.3.2.2">superscript</csymbol><ci id="S3.E8.m2.2.2.2.2.3.2.2.2.cmml" xref="S3.E8.m2.2.2.2.2.3.2.2.2">𝛾</ci><ci id="S3.E8.m2.2.2.2.2.3.2.2.3.cmml" xref="S3.E8.m2.2.2.2.2.3.2.2.3">𝑘</ci></apply><apply id="S3.E8.m2.2.2.2.2.3.2.3.cmml" xref="S3.E8.m2.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.2.2.3.2.3.1.cmml" xref="S3.E8.m2.2.2.2.2.3.2.3">subscript</csymbol><apply id="S3.E8.m2.2.2.2.2.3.2.3.2.cmml" xref="S3.E8.m2.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m2.2.2.2.2.3.2.3.2.1.cmml" xref="S3.E8.m2.2.2.2.2.3.2.3">superscript</csymbol><ci id="S3.E8.m2.2.2.2.2.3.2.3.2.2.cmml" xref="S3.E8.m2.2.2.2.2.3.2.3.2.2">𝑟</ci><ci id="S3.E8.m2.2.2.2.2.3.2.3.2.3a.cmml" xref="S3.E8.m2.2.2.2.2.3.2.3.2.3"><mtext id="S3.E8.m2.2.2.2.2.3.2.3.2.3.cmml" mathsize="70%" xref="S3.E8.m2.2.2.2.2.3.2.3.2.3">l</mtext></ci></apply><ci id="S3.E8.m2.2.2.2.2.3.2.3.3.cmml" xref="S3.E8.m2.2.2.2.2.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.2c">\displaystyle=\sum_{t=0}^{\infty}\gamma^{t}r^{\text{h}}_{t},\quad J^{\text{l}}%
(a^{\text{l}})=\sum_{k=0}^{K}\gamma^{k}r^{\text{l}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m2.2d">= ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT italic_r start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_J start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT ( italic_a start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_k = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_γ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_r start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p2.1">in which the definition of the LRA reward connects the above two equations, <span class="ltx_text ltx_font_italic" id="S3.SS5.p2.1.1">i.e.</span>, <math alttext="r^{\text{l}}(a^{\text{h}},a^{\text{l}})" class="ltx_Math" display="inline" id="S3.SS5.p2.1.m1.2"><semantics id="S3.SS5.p2.1.m1.2a"><mrow id="S3.SS5.p2.1.m1.2.2" xref="S3.SS5.p2.1.m1.2.2.cmml"><msup id="S3.SS5.p2.1.m1.2.2.4" xref="S3.SS5.p2.1.m1.2.2.4.cmml"><mi id="S3.SS5.p2.1.m1.2.2.4.2" xref="S3.SS5.p2.1.m1.2.2.4.2.cmml">r</mi><mtext id="S3.SS5.p2.1.m1.2.2.4.3" xref="S3.SS5.p2.1.m1.2.2.4.3a.cmml">l</mtext></msup><mo id="S3.SS5.p2.1.m1.2.2.3" xref="S3.SS5.p2.1.m1.2.2.3.cmml">⁢</mo><mrow id="S3.SS5.p2.1.m1.2.2.2.2" xref="S3.SS5.p2.1.m1.2.2.2.3.cmml"><mo id="S3.SS5.p2.1.m1.2.2.2.2.3" stretchy="false" xref="S3.SS5.p2.1.m1.2.2.2.3.cmml">(</mo><msup id="S3.SS5.p2.1.m1.1.1.1.1.1" xref="S3.SS5.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS5.p2.1.m1.1.1.1.1.1.2" xref="S3.SS5.p2.1.m1.1.1.1.1.1.2.cmml">a</mi><mtext id="S3.SS5.p2.1.m1.1.1.1.1.1.3" xref="S3.SS5.p2.1.m1.1.1.1.1.1.3a.cmml">h</mtext></msup><mo id="S3.SS5.p2.1.m1.2.2.2.2.4" xref="S3.SS5.p2.1.m1.2.2.2.3.cmml">,</mo><msup id="S3.SS5.p2.1.m1.2.2.2.2.2" xref="S3.SS5.p2.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS5.p2.1.m1.2.2.2.2.2.2" xref="S3.SS5.p2.1.m1.2.2.2.2.2.2.cmml">a</mi><mtext id="S3.SS5.p2.1.m1.2.2.2.2.2.3" xref="S3.SS5.p2.1.m1.2.2.2.2.2.3a.cmml">l</mtext></msup><mo id="S3.SS5.p2.1.m1.2.2.2.2.5" stretchy="false" xref="S3.SS5.p2.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.1.m1.2b"><apply id="S3.SS5.p2.1.m1.2.2.cmml" xref="S3.SS5.p2.1.m1.2.2"><times id="S3.SS5.p2.1.m1.2.2.3.cmml" xref="S3.SS5.p2.1.m1.2.2.3"></times><apply id="S3.SS5.p2.1.m1.2.2.4.cmml" xref="S3.SS5.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS5.p2.1.m1.2.2.4.1.cmml" xref="S3.SS5.p2.1.m1.2.2.4">superscript</csymbol><ci id="S3.SS5.p2.1.m1.2.2.4.2.cmml" xref="S3.SS5.p2.1.m1.2.2.4.2">𝑟</ci><ci id="S3.SS5.p2.1.m1.2.2.4.3a.cmml" xref="S3.SS5.p2.1.m1.2.2.4.3"><mtext id="S3.SS5.p2.1.m1.2.2.4.3.cmml" mathsize="70%" xref="S3.SS5.p2.1.m1.2.2.4.3">l</mtext></ci></apply><interval closure="open" id="S3.SS5.p2.1.m1.2.2.2.3.cmml" xref="S3.SS5.p2.1.m1.2.2.2.2"><apply id="S3.SS5.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS5.p2.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS5.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS5.p2.1.m1.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS5.p2.1.m1.1.1.1.1.1.3a.cmml" xref="S3.SS5.p2.1.m1.1.1.1.1.1.3"><mtext id="S3.SS5.p2.1.m1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS5.p2.1.m1.1.1.1.1.1.3">h</mtext></ci></apply><apply id="S3.SS5.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS5.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS5.p2.1.m1.2.2.2.2.2">superscript</csymbol><ci id="S3.SS5.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS5.p2.1.m1.2.2.2.2.2.2">𝑎</ci><ci id="S3.SS5.p2.1.m1.2.2.2.2.2.3a.cmml" xref="S3.SS5.p2.1.m1.2.2.2.2.2.3"><mtext id="S3.SS5.p2.1.m1.2.2.2.2.2.3.cmml" mathsize="70%" xref="S3.SS5.p2.1.m1.2.2.2.2.2.3">l</mtext></ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.1.m1.2c">r^{\text{l}}(a^{\text{h}},a^{\text{l}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.1.m1.2d">italic_r start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT ( italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Notations.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.43">
<tr class="ltx_tr" id="S4.T1.43.44">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.43.44.1">Notation</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.43.44.2">Description</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1"><math alttext="t" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><mi id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">italic_t</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.1.2">the real physical time</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2">
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.1"><math alttext="k" class="ltx_Math" display="inline" id="S4.T1.2.2.1.m1.1"><semantics id="S4.T1.2.2.1.m1.1a"><mi id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><ci id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.1.m1.1d">italic_k</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.2.2.2">the position &amp; decision step within the recommended item list</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3">
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.1"><math alttext="K" class="ltx_Math" display="inline" id="S4.T1.3.3.1.m1.1"><semantics id="S4.T1.3.3.1.m1.1a"><mi id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><ci id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.1.m1.1d">italic_K</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.3.3.2">the maximum length of recommended item list</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7">
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.2">
<math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S4.T1.4.4.1.m1.1"><semantics id="S4.T1.4.4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.T1.4.4.1.m1.1.1" xref="S4.T1.4.4.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.1.m1.1b"><ci id="S4.T1.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.1.m1.1d">caligraphic_S</annotation></semantics></math>, <math alttext="s" class="ltx_Math" display="inline" id="S4.T1.5.5.2.m2.1"><semantics id="S4.T1.5.5.2.m2.1a"><mi id="S4.T1.5.5.2.m2.1.1" xref="S4.T1.5.5.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.2.m2.1b"><ci id="S4.T1.5.5.2.m2.1.1.cmml" xref="S4.T1.5.5.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.2.m2.1d">italic_s</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="S4.T1.7.7.4">state space <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S4.T1.6.6.3.m1.1"><semantics id="S4.T1.6.6.3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.T1.6.6.3.m1.1.1" xref="S4.T1.6.6.3.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.3.m1.1b"><ci id="S4.T1.6.6.3.m1.1.1.cmml" xref="S4.T1.6.6.3.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.3.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.3.m1.1d">caligraphic_S</annotation></semantics></math>, <math alttext="s\in\mathcal{S}" class="ltx_Math" display="inline" id="S4.T1.7.7.4.m2.1"><semantics id="S4.T1.7.7.4.m2.1a"><mrow id="S4.T1.7.7.4.m2.1.1" xref="S4.T1.7.7.4.m2.1.1.cmml"><mi id="S4.T1.7.7.4.m2.1.1.2" xref="S4.T1.7.7.4.m2.1.1.2.cmml">s</mi><mo id="S4.T1.7.7.4.m2.1.1.1" xref="S4.T1.7.7.4.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.T1.7.7.4.m2.1.1.3" xref="S4.T1.7.7.4.m2.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.4.m2.1b"><apply id="S4.T1.7.7.4.m2.1.1.cmml" xref="S4.T1.7.7.4.m2.1.1"><in id="S4.T1.7.7.4.m2.1.1.1.cmml" xref="S4.T1.7.7.4.m2.1.1.1"></in><ci id="S4.T1.7.7.4.m2.1.1.2.cmml" xref="S4.T1.7.7.4.m2.1.1.2">𝑠</ci><ci id="S4.T1.7.7.4.m2.1.1.3.cmml" xref="S4.T1.7.7.4.m2.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.4.m2.1c">s\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.7.4.m2.1d">italic_s ∈ caligraphic_S</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11">
<td class="ltx_td ltx_align_center" id="S4.T1.9.9.2">
<math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S4.T1.8.8.1.m1.1"><semantics id="S4.T1.8.8.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.T1.8.8.1.m1.1.1" xref="S4.T1.8.8.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.1.m1.1b"><ci id="S4.T1.8.8.1.m1.1.1.cmml" xref="S4.T1.8.8.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.1.m1.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.8.1.m1.1d">caligraphic_A</annotation></semantics></math>, <math alttext="a" class="ltx_Math" display="inline" id="S4.T1.9.9.2.m2.1"><semantics id="S4.T1.9.9.2.m2.1a"><mi id="S4.T1.9.9.2.m2.1.1" xref="S4.T1.9.9.2.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.2.m2.1b"><ci id="S4.T1.9.9.2.m2.1.1.cmml" xref="S4.T1.9.9.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.2.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.9.2.m2.1d">italic_a</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="S4.T1.11.11.4">action space <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S4.T1.10.10.3.m1.1"><semantics id="S4.T1.10.10.3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.T1.10.10.3.m1.1.1" xref="S4.T1.10.10.3.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.3.m1.1b"><ci id="S4.T1.10.10.3.m1.1.1.cmml" xref="S4.T1.10.10.3.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.3.m1.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.10.10.3.m1.1d">caligraphic_A</annotation></semantics></math>, <math alttext="a\in\mathcal{A}" class="ltx_Math" display="inline" id="S4.T1.11.11.4.m2.1"><semantics id="S4.T1.11.11.4.m2.1a"><mrow id="S4.T1.11.11.4.m2.1.1" xref="S4.T1.11.11.4.m2.1.1.cmml"><mi id="S4.T1.11.11.4.m2.1.1.2" xref="S4.T1.11.11.4.m2.1.1.2.cmml">a</mi><mo id="S4.T1.11.11.4.m2.1.1.1" xref="S4.T1.11.11.4.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.T1.11.11.4.m2.1.1.3" xref="S4.T1.11.11.4.m2.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.4.m2.1b"><apply id="S4.T1.11.11.4.m2.1.1.cmml" xref="S4.T1.11.11.4.m2.1.1"><in id="S4.T1.11.11.4.m2.1.1.1.cmml" xref="S4.T1.11.11.4.m2.1.1.1"></in><ci id="S4.T1.11.11.4.m2.1.1.2.cmml" xref="S4.T1.11.11.4.m2.1.1.2">𝑎</ci><ci id="S4.T1.11.11.4.m2.1.1.3.cmml" xref="S4.T1.11.11.4.m2.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.4.m2.1c">a\in\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.11.11.4.m2.1d">italic_a ∈ caligraphic_A</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15">
<td class="ltx_td ltx_align_center" id="S4.T1.13.13.2">
<math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S4.T1.12.12.1.m1.1"><semantics id="S4.T1.12.12.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.T1.12.12.1.m1.1.1" xref="S4.T1.12.12.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.12.12.1.m1.1b"><ci id="S4.T1.12.12.1.m1.1.1.cmml" xref="S4.T1.12.12.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.12.1.m1.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.12.12.1.m1.1d">caligraphic_R</annotation></semantics></math>, <math alttext="r" class="ltx_Math" display="inline" id="S4.T1.13.13.2.m2.1"><semantics id="S4.T1.13.13.2.m2.1a"><mi id="S4.T1.13.13.2.m2.1.1" xref="S4.T1.13.13.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.T1.13.13.2.m2.1b"><ci id="S4.T1.13.13.2.m2.1.1.cmml" xref="S4.T1.13.13.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.13.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.T1.13.13.2.m2.1d">italic_r</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_left" id="S4.T1.15.15.4">reward space <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S4.T1.14.14.3.m1.1"><semantics id="S4.T1.14.14.3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.T1.14.14.3.m1.1.1" xref="S4.T1.14.14.3.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.14.14.3.m1.1b"><ci id="S4.T1.14.14.3.m1.1.1.cmml" xref="S4.T1.14.14.3.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.14.3.m1.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.14.14.3.m1.1d">caligraphic_R</annotation></semantics></math>, <math alttext="r\in\mathcal{R}" class="ltx_Math" display="inline" id="S4.T1.15.15.4.m2.1"><semantics id="S4.T1.15.15.4.m2.1a"><mrow id="S4.T1.15.15.4.m2.1.1" xref="S4.T1.15.15.4.m2.1.1.cmml"><mi id="S4.T1.15.15.4.m2.1.1.2" xref="S4.T1.15.15.4.m2.1.1.2.cmml">r</mi><mo id="S4.T1.15.15.4.m2.1.1.1" xref="S4.T1.15.15.4.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.T1.15.15.4.m2.1.1.3" xref="S4.T1.15.15.4.m2.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.15.15.4.m2.1b"><apply id="S4.T1.15.15.4.m2.1.1.cmml" xref="S4.T1.15.15.4.m2.1.1"><in id="S4.T1.15.15.4.m2.1.1.1.cmml" xref="S4.T1.15.15.4.m2.1.1.1"></in><ci id="S4.T1.15.15.4.m2.1.1.2.cmml" xref="S4.T1.15.15.4.m2.1.1.2">𝑟</ci><ci id="S4.T1.15.15.4.m2.1.1.3.cmml" xref="S4.T1.15.15.4.m2.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.15.4.m2.1c">r\in\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.15.15.4.m2.1d">italic_r ∈ caligraphic_R</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.16.16">
<td class="ltx_td ltx_align_center" id="S4.T1.16.16.1"><math alttext="\gamma" class="ltx_Math" display="inline" id="S4.T1.16.16.1.m1.1"><semantics id="S4.T1.16.16.1.m1.1a"><mi id="S4.T1.16.16.1.m1.1.1" xref="S4.T1.16.16.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.16.16.1.m1.1b"><ci id="S4.T1.16.16.1.m1.1.1.cmml" xref="S4.T1.16.16.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.16.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.T1.16.16.1.m1.1d">italic_γ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.16.16.2">discount factor to balance immediate and future rewards</td>
</tr>
<tr class="ltx_tr" id="S4.T1.17.17">
<td class="ltx_td ltx_align_center" id="S4.T1.17.17.1"><math alttext="J" class="ltx_Math" display="inline" id="S4.T1.17.17.1.m1.1"><semantics id="S4.T1.17.17.1.m1.1a"><mi id="S4.T1.17.17.1.m1.1.1" xref="S4.T1.17.17.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S4.T1.17.17.1.m1.1b"><ci id="S4.T1.17.17.1.m1.1.1.cmml" xref="S4.T1.17.17.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.17.1.m1.1c">J</annotation><annotation encoding="application/x-llamapun" id="S4.T1.17.17.1.m1.1d">italic_J</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.17.17.2">discounted cumulative return</td>
</tr>
<tr class="ltx_tr" id="S4.T1.19.19">
<td class="ltx_td ltx_align_center" id="S4.T1.18.18.1"><math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.T1.18.18.1.m1.1"><semantics id="S4.T1.18.18.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.T1.18.18.1.m1.1.1" xref="S4.T1.18.18.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.T1.18.18.1.m1.1b"><ci id="S4.T1.18.18.1.m1.1.1.cmml" xref="S4.T1.18.18.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.18.18.1.m1.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.18.18.1.m1.1d">caligraphic_T</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.19.19.2">the transition <math alttext="(s_{t},a_{t},r_{t},s_{t+1})" class="ltx_Math" display="inline" id="S4.T1.19.19.2.m1.4"><semantics id="S4.T1.19.19.2.m1.4a"><mrow id="S4.T1.19.19.2.m1.4.4.4" xref="S4.T1.19.19.2.m1.4.4.5.cmml"><mo id="S4.T1.19.19.2.m1.4.4.4.5" stretchy="false" xref="S4.T1.19.19.2.m1.4.4.5.cmml">(</mo><msub id="S4.T1.19.19.2.m1.1.1.1.1" xref="S4.T1.19.19.2.m1.1.1.1.1.cmml"><mi id="S4.T1.19.19.2.m1.1.1.1.1.2" xref="S4.T1.19.19.2.m1.1.1.1.1.2.cmml">s</mi><mi id="S4.T1.19.19.2.m1.1.1.1.1.3" xref="S4.T1.19.19.2.m1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.T1.19.19.2.m1.4.4.4.6" xref="S4.T1.19.19.2.m1.4.4.5.cmml">,</mo><msub id="S4.T1.19.19.2.m1.2.2.2.2" xref="S4.T1.19.19.2.m1.2.2.2.2.cmml"><mi id="S4.T1.19.19.2.m1.2.2.2.2.2" xref="S4.T1.19.19.2.m1.2.2.2.2.2.cmml">a</mi><mi id="S4.T1.19.19.2.m1.2.2.2.2.3" xref="S4.T1.19.19.2.m1.2.2.2.2.3.cmml">t</mi></msub><mo id="S4.T1.19.19.2.m1.4.4.4.7" xref="S4.T1.19.19.2.m1.4.4.5.cmml">,</mo><msub id="S4.T1.19.19.2.m1.3.3.3.3" xref="S4.T1.19.19.2.m1.3.3.3.3.cmml"><mi id="S4.T1.19.19.2.m1.3.3.3.3.2" xref="S4.T1.19.19.2.m1.3.3.3.3.2.cmml">r</mi><mi id="S4.T1.19.19.2.m1.3.3.3.3.3" xref="S4.T1.19.19.2.m1.3.3.3.3.3.cmml">t</mi></msub><mo id="S4.T1.19.19.2.m1.4.4.4.8" xref="S4.T1.19.19.2.m1.4.4.5.cmml">,</mo><msub id="S4.T1.19.19.2.m1.4.4.4.4" xref="S4.T1.19.19.2.m1.4.4.4.4.cmml"><mi id="S4.T1.19.19.2.m1.4.4.4.4.2" xref="S4.T1.19.19.2.m1.4.4.4.4.2.cmml">s</mi><mrow id="S4.T1.19.19.2.m1.4.4.4.4.3" xref="S4.T1.19.19.2.m1.4.4.4.4.3.cmml"><mi id="S4.T1.19.19.2.m1.4.4.4.4.3.2" xref="S4.T1.19.19.2.m1.4.4.4.4.3.2.cmml">t</mi><mo id="S4.T1.19.19.2.m1.4.4.4.4.3.1" xref="S4.T1.19.19.2.m1.4.4.4.4.3.1.cmml">+</mo><mn id="S4.T1.19.19.2.m1.4.4.4.4.3.3" xref="S4.T1.19.19.2.m1.4.4.4.4.3.3.cmml">1</mn></mrow></msub><mo id="S4.T1.19.19.2.m1.4.4.4.9" stretchy="false" xref="S4.T1.19.19.2.m1.4.4.5.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.19.19.2.m1.4b"><vector id="S4.T1.19.19.2.m1.4.4.5.cmml" xref="S4.T1.19.19.2.m1.4.4.4"><apply id="S4.T1.19.19.2.m1.1.1.1.1.cmml" xref="S4.T1.19.19.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.T1.19.19.2.m1.1.1.1.1.1.cmml" xref="S4.T1.19.19.2.m1.1.1.1.1">subscript</csymbol><ci id="S4.T1.19.19.2.m1.1.1.1.1.2.cmml" xref="S4.T1.19.19.2.m1.1.1.1.1.2">𝑠</ci><ci id="S4.T1.19.19.2.m1.1.1.1.1.3.cmml" xref="S4.T1.19.19.2.m1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.T1.19.19.2.m1.2.2.2.2.cmml" xref="S4.T1.19.19.2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.T1.19.19.2.m1.2.2.2.2.1.cmml" xref="S4.T1.19.19.2.m1.2.2.2.2">subscript</csymbol><ci id="S4.T1.19.19.2.m1.2.2.2.2.2.cmml" xref="S4.T1.19.19.2.m1.2.2.2.2.2">𝑎</ci><ci id="S4.T1.19.19.2.m1.2.2.2.2.3.cmml" xref="S4.T1.19.19.2.m1.2.2.2.2.3">𝑡</ci></apply><apply id="S4.T1.19.19.2.m1.3.3.3.3.cmml" xref="S4.T1.19.19.2.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.T1.19.19.2.m1.3.3.3.3.1.cmml" xref="S4.T1.19.19.2.m1.3.3.3.3">subscript</csymbol><ci id="S4.T1.19.19.2.m1.3.3.3.3.2.cmml" xref="S4.T1.19.19.2.m1.3.3.3.3.2">𝑟</ci><ci id="S4.T1.19.19.2.m1.3.3.3.3.3.cmml" xref="S4.T1.19.19.2.m1.3.3.3.3.3">𝑡</ci></apply><apply id="S4.T1.19.19.2.m1.4.4.4.4.cmml" xref="S4.T1.19.19.2.m1.4.4.4.4"><csymbol cd="ambiguous" id="S4.T1.19.19.2.m1.4.4.4.4.1.cmml" xref="S4.T1.19.19.2.m1.4.4.4.4">subscript</csymbol><ci id="S4.T1.19.19.2.m1.4.4.4.4.2.cmml" xref="S4.T1.19.19.2.m1.4.4.4.4.2">𝑠</ci><apply id="S4.T1.19.19.2.m1.4.4.4.4.3.cmml" xref="S4.T1.19.19.2.m1.4.4.4.4.3"><plus id="S4.T1.19.19.2.m1.4.4.4.4.3.1.cmml" xref="S4.T1.19.19.2.m1.4.4.4.4.3.1"></plus><ci id="S4.T1.19.19.2.m1.4.4.4.4.3.2.cmml" xref="S4.T1.19.19.2.m1.4.4.4.4.3.2">𝑡</ci><cn id="S4.T1.19.19.2.m1.4.4.4.4.3.3.cmml" type="integer" xref="S4.T1.19.19.2.m1.4.4.4.4.3.3">1</cn></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.19.19.2.m1.4c">(s_{t},a_{t},r_{t},s_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S4.T1.19.19.2.m1.4d">( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.21.21">
<td class="ltx_td ltx_align_center" id="S4.T1.20.20.1"><math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S4.T1.20.20.1.m1.1"><semantics id="S4.T1.20.20.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.T1.20.20.1.m1.1.1" xref="S4.T1.20.20.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.20.20.1.m1.1b"><ci id="S4.T1.20.20.1.m1.1.1.cmml" xref="S4.T1.20.20.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.20.20.1.m1.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.20.20.1.m1.1d">caligraphic_M</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.21.21.2">MDP formed by <math alttext="(\mathcal{S},\mathcal{A},\mathcal{R},\gamma)" class="ltx_Math" display="inline" id="S4.T1.21.21.2.m1.4"><semantics id="S4.T1.21.21.2.m1.4a"><mrow id="S4.T1.21.21.2.m1.4.5.2" xref="S4.T1.21.21.2.m1.4.5.1.cmml"><mo id="S4.T1.21.21.2.m1.4.5.2.1" stretchy="false" xref="S4.T1.21.21.2.m1.4.5.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.T1.21.21.2.m1.1.1" xref="S4.T1.21.21.2.m1.1.1.cmml">𝒮</mi><mo id="S4.T1.21.21.2.m1.4.5.2.2" xref="S4.T1.21.21.2.m1.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.T1.21.21.2.m1.2.2" xref="S4.T1.21.21.2.m1.2.2.cmml">𝒜</mi><mo id="S4.T1.21.21.2.m1.4.5.2.3" xref="S4.T1.21.21.2.m1.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.T1.21.21.2.m1.3.3" xref="S4.T1.21.21.2.m1.3.3.cmml">ℛ</mi><mo id="S4.T1.21.21.2.m1.4.5.2.4" xref="S4.T1.21.21.2.m1.4.5.1.cmml">,</mo><mi id="S4.T1.21.21.2.m1.4.4" xref="S4.T1.21.21.2.m1.4.4.cmml">γ</mi><mo id="S4.T1.21.21.2.m1.4.5.2.5" stretchy="false" xref="S4.T1.21.21.2.m1.4.5.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.21.21.2.m1.4b"><vector id="S4.T1.21.21.2.m1.4.5.1.cmml" xref="S4.T1.21.21.2.m1.4.5.2"><ci id="S4.T1.21.21.2.m1.1.1.cmml" xref="S4.T1.21.21.2.m1.1.1">𝒮</ci><ci id="S4.T1.21.21.2.m1.2.2.cmml" xref="S4.T1.21.21.2.m1.2.2">𝒜</ci><ci id="S4.T1.21.21.2.m1.3.3.cmml" xref="S4.T1.21.21.2.m1.3.3">ℛ</ci><ci id="S4.T1.21.21.2.m1.4.4.cmml" xref="S4.T1.21.21.2.m1.4.4">𝛾</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.21.21.2.m1.4c">(\mathcal{S},\mathcal{A},\mathcal{R},\gamma)</annotation><annotation encoding="application/x-llamapun" id="S4.T1.21.21.2.m1.4d">( caligraphic_S , caligraphic_A , caligraphic_R , italic_γ )</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.23.23">
<td class="ltx_td ltx_align_center" id="S4.T1.22.22.1"><math alttext="\pi_{\theta}(a|s)" class="ltx_Math" display="inline" id="S4.T1.22.22.1.m1.1"><semantics id="S4.T1.22.22.1.m1.1a"><mrow id="S4.T1.22.22.1.m1.1.1" xref="S4.T1.22.22.1.m1.1.1.cmml"><msub id="S4.T1.22.22.1.m1.1.1.3" xref="S4.T1.22.22.1.m1.1.1.3.cmml"><mi id="S4.T1.22.22.1.m1.1.1.3.2" xref="S4.T1.22.22.1.m1.1.1.3.2.cmml">π</mi><mi id="S4.T1.22.22.1.m1.1.1.3.3" xref="S4.T1.22.22.1.m1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.T1.22.22.1.m1.1.1.2" xref="S4.T1.22.22.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.T1.22.22.1.m1.1.1.1.1" xref="S4.T1.22.22.1.m1.1.1.1.1.1.cmml"><mo id="S4.T1.22.22.1.m1.1.1.1.1.2" stretchy="false" xref="S4.T1.22.22.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.T1.22.22.1.m1.1.1.1.1.1" xref="S4.T1.22.22.1.m1.1.1.1.1.1.cmml"><mi id="S4.T1.22.22.1.m1.1.1.1.1.1.2" xref="S4.T1.22.22.1.m1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S4.T1.22.22.1.m1.1.1.1.1.1.1" xref="S4.T1.22.22.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.T1.22.22.1.m1.1.1.1.1.1.3" xref="S4.T1.22.22.1.m1.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S4.T1.22.22.1.m1.1.1.1.1.3" stretchy="false" xref="S4.T1.22.22.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.22.22.1.m1.1b"><apply id="S4.T1.22.22.1.m1.1.1.cmml" xref="S4.T1.22.22.1.m1.1.1"><times id="S4.T1.22.22.1.m1.1.1.2.cmml" xref="S4.T1.22.22.1.m1.1.1.2"></times><apply id="S4.T1.22.22.1.m1.1.1.3.cmml" xref="S4.T1.22.22.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.22.22.1.m1.1.1.3.1.cmml" xref="S4.T1.22.22.1.m1.1.1.3">subscript</csymbol><ci id="S4.T1.22.22.1.m1.1.1.3.2.cmml" xref="S4.T1.22.22.1.m1.1.1.3.2">𝜋</ci><ci id="S4.T1.22.22.1.m1.1.1.3.3.cmml" xref="S4.T1.22.22.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S4.T1.22.22.1.m1.1.1.1.1.1.cmml" xref="S4.T1.22.22.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.T1.22.22.1.m1.1.1.1.1.1.1.cmml" xref="S4.T1.22.22.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.T1.22.22.1.m1.1.1.1.1.1.2.cmml" xref="S4.T1.22.22.1.m1.1.1.1.1.1.2">𝑎</ci><ci id="S4.T1.22.22.1.m1.1.1.1.1.1.3.cmml" xref="S4.T1.22.22.1.m1.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.22.22.1.m1.1c">\pi_{\theta}(a|s)</annotation><annotation encoding="application/x-llamapun" id="S4.T1.22.22.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_s )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.23.23.2">policy function, parameterized by <math alttext="\theta" class="ltx_Math" display="inline" id="S4.T1.23.23.2.m1.1"><semantics id="S4.T1.23.23.2.m1.1a"><mi id="S4.T1.23.23.2.m1.1.1" xref="S4.T1.23.23.2.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.23.23.2.m1.1b"><ci id="S4.T1.23.23.2.m1.1.1.cmml" xref="S4.T1.23.23.2.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.23.23.2.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.T1.23.23.2.m1.1d">italic_θ</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.25.25">
<td class="ltx_td ltx_align_center" id="S4.T1.24.24.1"><math alttext="Q_{w}(s,a)" class="ltx_Math" display="inline" id="S4.T1.24.24.1.m1.2"><semantics id="S4.T1.24.24.1.m1.2a"><mrow id="S4.T1.24.24.1.m1.2.3" xref="S4.T1.24.24.1.m1.2.3.cmml"><msub id="S4.T1.24.24.1.m1.2.3.2" xref="S4.T1.24.24.1.m1.2.3.2.cmml"><mi id="S4.T1.24.24.1.m1.2.3.2.2" xref="S4.T1.24.24.1.m1.2.3.2.2.cmml">Q</mi><mi id="S4.T1.24.24.1.m1.2.3.2.3" xref="S4.T1.24.24.1.m1.2.3.2.3.cmml">w</mi></msub><mo id="S4.T1.24.24.1.m1.2.3.1" xref="S4.T1.24.24.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.T1.24.24.1.m1.2.3.3.2" xref="S4.T1.24.24.1.m1.2.3.3.1.cmml"><mo id="S4.T1.24.24.1.m1.2.3.3.2.1" stretchy="false" xref="S4.T1.24.24.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.T1.24.24.1.m1.1.1" xref="S4.T1.24.24.1.m1.1.1.cmml">s</mi><mo id="S4.T1.24.24.1.m1.2.3.3.2.2" xref="S4.T1.24.24.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.T1.24.24.1.m1.2.2" xref="S4.T1.24.24.1.m1.2.2.cmml">a</mi><mo id="S4.T1.24.24.1.m1.2.3.3.2.3" stretchy="false" xref="S4.T1.24.24.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.24.24.1.m1.2b"><apply id="S4.T1.24.24.1.m1.2.3.cmml" xref="S4.T1.24.24.1.m1.2.3"><times id="S4.T1.24.24.1.m1.2.3.1.cmml" xref="S4.T1.24.24.1.m1.2.3.1"></times><apply id="S4.T1.24.24.1.m1.2.3.2.cmml" xref="S4.T1.24.24.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.T1.24.24.1.m1.2.3.2.1.cmml" xref="S4.T1.24.24.1.m1.2.3.2">subscript</csymbol><ci id="S4.T1.24.24.1.m1.2.3.2.2.cmml" xref="S4.T1.24.24.1.m1.2.3.2.2">𝑄</ci><ci id="S4.T1.24.24.1.m1.2.3.2.3.cmml" xref="S4.T1.24.24.1.m1.2.3.2.3">𝑤</ci></apply><interval closure="open" id="S4.T1.24.24.1.m1.2.3.3.1.cmml" xref="S4.T1.24.24.1.m1.2.3.3.2"><ci id="S4.T1.24.24.1.m1.1.1.cmml" xref="S4.T1.24.24.1.m1.1.1">𝑠</ci><ci id="S4.T1.24.24.1.m1.2.2.cmml" xref="S4.T1.24.24.1.m1.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.24.24.1.m1.2c">Q_{w}(s,a)</annotation><annotation encoding="application/x-llamapun" id="S4.T1.24.24.1.m1.2d">italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_s , italic_a )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.25.25.2">state-action value function, parameterized by <math alttext="w" class="ltx_Math" display="inline" id="S4.T1.25.25.2.m1.1"><semantics id="S4.T1.25.25.2.m1.1a"><mi id="S4.T1.25.25.2.m1.1.1" xref="S4.T1.25.25.2.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S4.T1.25.25.2.m1.1b"><ci id="S4.T1.25.25.2.m1.1.1.cmml" xref="S4.T1.25.25.2.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.25.25.2.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="S4.T1.25.25.2.m1.1d">italic_w</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.26.26">
<td class="ltx_td ltx_align_center" id="S4.T1.26.26.1"><math alttext="c\in[0,1]" class="ltx_Math" display="inline" id="S4.T1.26.26.1.m1.2"><semantics id="S4.T1.26.26.1.m1.2a"><mrow id="S4.T1.26.26.1.m1.2.3" xref="S4.T1.26.26.1.m1.2.3.cmml"><mi id="S4.T1.26.26.1.m1.2.3.2" xref="S4.T1.26.26.1.m1.2.3.2.cmml">c</mi><mo id="S4.T1.26.26.1.m1.2.3.1" xref="S4.T1.26.26.1.m1.2.3.1.cmml">∈</mo><mrow id="S4.T1.26.26.1.m1.2.3.3.2" xref="S4.T1.26.26.1.m1.2.3.3.1.cmml"><mo id="S4.T1.26.26.1.m1.2.3.3.2.1" stretchy="false" xref="S4.T1.26.26.1.m1.2.3.3.1.cmml">[</mo><mn id="S4.T1.26.26.1.m1.1.1" xref="S4.T1.26.26.1.m1.1.1.cmml">0</mn><mo id="S4.T1.26.26.1.m1.2.3.3.2.2" xref="S4.T1.26.26.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.T1.26.26.1.m1.2.2" xref="S4.T1.26.26.1.m1.2.2.cmml">1</mn><mo id="S4.T1.26.26.1.m1.2.3.3.2.3" stretchy="false" xref="S4.T1.26.26.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.26.26.1.m1.2b"><apply id="S4.T1.26.26.1.m1.2.3.cmml" xref="S4.T1.26.26.1.m1.2.3"><in id="S4.T1.26.26.1.m1.2.3.1.cmml" xref="S4.T1.26.26.1.m1.2.3.1"></in><ci id="S4.T1.26.26.1.m1.2.3.2.cmml" xref="S4.T1.26.26.1.m1.2.3.2">𝑐</ci><interval closure="closed" id="S4.T1.26.26.1.m1.2.3.3.1.cmml" xref="S4.T1.26.26.1.m1.2.3.3.2"><cn id="S4.T1.26.26.1.m1.1.1.cmml" type="integer" xref="S4.T1.26.26.1.m1.1.1">0</cn><cn id="S4.T1.26.26.1.m1.2.2.cmml" type="integer" xref="S4.T1.26.26.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.26.26.1.m1.2c">c\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S4.T1.26.26.1.m1.2d">italic_c ∈ [ 0 , 1 ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.26.26.2">binary response of user click</td>
</tr>
<tr class="ltx_tr" id="S4.T1.27.27">
<td class="ltx_td ltx_align_center" id="S4.T1.27.27.1"><math alttext="L" class="ltx_Math" display="inline" id="S4.T1.27.27.1.m1.1"><semantics id="S4.T1.27.27.1.m1.1a"><mi id="S4.T1.27.27.1.m1.1.1" xref="S4.T1.27.27.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.T1.27.27.1.m1.1b"><ci id="S4.T1.27.27.1.m1.1.1.cmml" xref="S4.T1.27.27.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.27.27.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.T1.27.27.1.m1.1d">italic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.27.27.2">embedding dimension</td>
</tr>
<tr class="ltx_tr" id="S4.T1.28.28">
<td class="ltx_td ltx_align_center" id="S4.T1.28.28.1"><math alttext="u\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S4.T1.28.28.1.m1.1"><semantics id="S4.T1.28.28.1.m1.1a"><mrow id="S4.T1.28.28.1.m1.1.1" xref="S4.T1.28.28.1.m1.1.1.cmml"><mi id="S4.T1.28.28.1.m1.1.1.2" xref="S4.T1.28.28.1.m1.1.1.2.cmml">u</mi><mo id="S4.T1.28.28.1.m1.1.1.1" xref="S4.T1.28.28.1.m1.1.1.1.cmml">∈</mo><msup id="S4.T1.28.28.1.m1.1.1.3" xref="S4.T1.28.28.1.m1.1.1.3.cmml"><mi id="S4.T1.28.28.1.m1.1.1.3.2" xref="S4.T1.28.28.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.T1.28.28.1.m1.1.1.3.3" xref="S4.T1.28.28.1.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.28.28.1.m1.1b"><apply id="S4.T1.28.28.1.m1.1.1.cmml" xref="S4.T1.28.28.1.m1.1.1"><in id="S4.T1.28.28.1.m1.1.1.1.cmml" xref="S4.T1.28.28.1.m1.1.1.1"></in><ci id="S4.T1.28.28.1.m1.1.1.2.cmml" xref="S4.T1.28.28.1.m1.1.1.2">𝑢</ci><apply id="S4.T1.28.28.1.m1.1.1.3.cmml" xref="S4.T1.28.28.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.28.28.1.m1.1.1.3.1.cmml" xref="S4.T1.28.28.1.m1.1.1.3">superscript</csymbol><ci id="S4.T1.28.28.1.m1.1.1.3.2.cmml" xref="S4.T1.28.28.1.m1.1.1.3.2">ℝ</ci><ci id="S4.T1.28.28.1.m1.1.1.3.3.cmml" xref="S4.T1.28.28.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.28.28.1.m1.1c">u\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.28.28.1.m1.1d">italic_u ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.28.28.2">embedding of user feature</td>
</tr>
<tr class="ltx_tr" id="S4.T1.29.29">
<td class="ltx_td ltx_align_center" id="S4.T1.29.29.1"><math alttext="c^{o}\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S4.T1.29.29.1.m1.1"><semantics id="S4.T1.29.29.1.m1.1a"><mrow id="S4.T1.29.29.1.m1.1.1" xref="S4.T1.29.29.1.m1.1.1.cmml"><msup id="S4.T1.29.29.1.m1.1.1.2" xref="S4.T1.29.29.1.m1.1.1.2.cmml"><mi id="S4.T1.29.29.1.m1.1.1.2.2" xref="S4.T1.29.29.1.m1.1.1.2.2.cmml">c</mi><mi id="S4.T1.29.29.1.m1.1.1.2.3" xref="S4.T1.29.29.1.m1.1.1.2.3.cmml">o</mi></msup><mo id="S4.T1.29.29.1.m1.1.1.1" xref="S4.T1.29.29.1.m1.1.1.1.cmml">∈</mo><msup id="S4.T1.29.29.1.m1.1.1.3" xref="S4.T1.29.29.1.m1.1.1.3.cmml"><mi id="S4.T1.29.29.1.m1.1.1.3.2" xref="S4.T1.29.29.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.T1.29.29.1.m1.1.1.3.3" xref="S4.T1.29.29.1.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.29.29.1.m1.1b"><apply id="S4.T1.29.29.1.m1.1.1.cmml" xref="S4.T1.29.29.1.m1.1.1"><in id="S4.T1.29.29.1.m1.1.1.1.cmml" xref="S4.T1.29.29.1.m1.1.1.1"></in><apply id="S4.T1.29.29.1.m1.1.1.2.cmml" xref="S4.T1.29.29.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.29.29.1.m1.1.1.2.1.cmml" xref="S4.T1.29.29.1.m1.1.1.2">superscript</csymbol><ci id="S4.T1.29.29.1.m1.1.1.2.2.cmml" xref="S4.T1.29.29.1.m1.1.1.2.2">𝑐</ci><ci id="S4.T1.29.29.1.m1.1.1.2.3.cmml" xref="S4.T1.29.29.1.m1.1.1.2.3">𝑜</ci></apply><apply id="S4.T1.29.29.1.m1.1.1.3.cmml" xref="S4.T1.29.29.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.29.29.1.m1.1.1.3.1.cmml" xref="S4.T1.29.29.1.m1.1.1.3">superscript</csymbol><ci id="S4.T1.29.29.1.m1.1.1.3.2.cmml" xref="S4.T1.29.29.1.m1.1.1.3.2">ℝ</ci><ci id="S4.T1.29.29.1.m1.1.1.3.3.cmml" xref="S4.T1.29.29.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.29.29.1.m1.1c">c^{o}\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.29.29.1.m1.1d">italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.29.29.2">embedding of outra-session context</td>
</tr>
<tr class="ltx_tr" id="S4.T1.30.30">
<td class="ltx_td ltx_align_center" id="S4.T1.30.30.1"><math alttext="c^{i}\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S4.T1.30.30.1.m1.1"><semantics id="S4.T1.30.30.1.m1.1a"><mrow id="S4.T1.30.30.1.m1.1.1" xref="S4.T1.30.30.1.m1.1.1.cmml"><msup id="S4.T1.30.30.1.m1.1.1.2" xref="S4.T1.30.30.1.m1.1.1.2.cmml"><mi id="S4.T1.30.30.1.m1.1.1.2.2" xref="S4.T1.30.30.1.m1.1.1.2.2.cmml">c</mi><mi id="S4.T1.30.30.1.m1.1.1.2.3" xref="S4.T1.30.30.1.m1.1.1.2.3.cmml">i</mi></msup><mo id="S4.T1.30.30.1.m1.1.1.1" xref="S4.T1.30.30.1.m1.1.1.1.cmml">∈</mo><msup id="S4.T1.30.30.1.m1.1.1.3" xref="S4.T1.30.30.1.m1.1.1.3.cmml"><mi id="S4.T1.30.30.1.m1.1.1.3.2" xref="S4.T1.30.30.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.T1.30.30.1.m1.1.1.3.3" xref="S4.T1.30.30.1.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.30.30.1.m1.1b"><apply id="S4.T1.30.30.1.m1.1.1.cmml" xref="S4.T1.30.30.1.m1.1.1"><in id="S4.T1.30.30.1.m1.1.1.1.cmml" xref="S4.T1.30.30.1.m1.1.1.1"></in><apply id="S4.T1.30.30.1.m1.1.1.2.cmml" xref="S4.T1.30.30.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T1.30.30.1.m1.1.1.2.1.cmml" xref="S4.T1.30.30.1.m1.1.1.2">superscript</csymbol><ci id="S4.T1.30.30.1.m1.1.1.2.2.cmml" xref="S4.T1.30.30.1.m1.1.1.2.2">𝑐</ci><ci id="S4.T1.30.30.1.m1.1.1.2.3.cmml" xref="S4.T1.30.30.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S4.T1.30.30.1.m1.1.1.3.cmml" xref="S4.T1.30.30.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.30.30.1.m1.1.1.3.1.cmml" xref="S4.T1.30.30.1.m1.1.1.3">superscript</csymbol><ci id="S4.T1.30.30.1.m1.1.1.3.2.cmml" xref="S4.T1.30.30.1.m1.1.1.3.2">ℝ</ci><ci id="S4.T1.30.30.1.m1.1.1.3.3.cmml" xref="S4.T1.30.30.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.30.30.1.m1.1c">c^{i}\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.30.30.1.m1.1d">italic_c start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.30.30.2">embedding of intra-session context</td>
</tr>
<tr class="ltx_tr" id="S4.T1.31.31">
<td class="ltx_td ltx_align_center" id="S4.T1.31.31.1"><math alttext="m\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S4.T1.31.31.1.m1.1"><semantics id="S4.T1.31.31.1.m1.1a"><mrow id="S4.T1.31.31.1.m1.1.1" xref="S4.T1.31.31.1.m1.1.1.cmml"><mi id="S4.T1.31.31.1.m1.1.1.2" xref="S4.T1.31.31.1.m1.1.1.2.cmml">m</mi><mo id="S4.T1.31.31.1.m1.1.1.1" xref="S4.T1.31.31.1.m1.1.1.1.cmml">∈</mo><msup id="S4.T1.31.31.1.m1.1.1.3" xref="S4.T1.31.31.1.m1.1.1.3.cmml"><mi id="S4.T1.31.31.1.m1.1.1.3.2" xref="S4.T1.31.31.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.T1.31.31.1.m1.1.1.3.3" xref="S4.T1.31.31.1.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.31.31.1.m1.1b"><apply id="S4.T1.31.31.1.m1.1.1.cmml" xref="S4.T1.31.31.1.m1.1.1"><in id="S4.T1.31.31.1.m1.1.1.1.cmml" xref="S4.T1.31.31.1.m1.1.1.1"></in><ci id="S4.T1.31.31.1.m1.1.1.2.cmml" xref="S4.T1.31.31.1.m1.1.1.2">𝑚</ci><apply id="S4.T1.31.31.1.m1.1.1.3.cmml" xref="S4.T1.31.31.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.31.31.1.m1.1.1.3.1.cmml" xref="S4.T1.31.31.1.m1.1.1.3">superscript</csymbol><ci id="S4.T1.31.31.1.m1.1.1.3.2.cmml" xref="S4.T1.31.31.1.m1.1.1.3.2">ℝ</ci><ci id="S4.T1.31.31.1.m1.1.1.3.3.cmml" xref="S4.T1.31.31.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.31.31.1.m1.1c">m\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.31.31.1.m1.1d">italic_m ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.31.31.2">embedding of on-device user profile</td>
</tr>
<tr class="ltx_tr" id="S4.T1.32.32">
<td class="ltx_td ltx_align_center" id="S4.T1.32.32.1"><math alttext="e\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S4.T1.32.32.1.m1.1"><semantics id="S4.T1.32.32.1.m1.1a"><mrow id="S4.T1.32.32.1.m1.1.1" xref="S4.T1.32.32.1.m1.1.1.cmml"><mi id="S4.T1.32.32.1.m1.1.1.2" xref="S4.T1.32.32.1.m1.1.1.2.cmml">e</mi><mo id="S4.T1.32.32.1.m1.1.1.1" xref="S4.T1.32.32.1.m1.1.1.1.cmml">∈</mo><msup id="S4.T1.32.32.1.m1.1.1.3" xref="S4.T1.32.32.1.m1.1.1.3.cmml"><mi id="S4.T1.32.32.1.m1.1.1.3.2" xref="S4.T1.32.32.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.T1.32.32.1.m1.1.1.3.3" xref="S4.T1.32.32.1.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.32.32.1.m1.1b"><apply id="S4.T1.32.32.1.m1.1.1.cmml" xref="S4.T1.32.32.1.m1.1.1"><in id="S4.T1.32.32.1.m1.1.1.1.cmml" xref="S4.T1.32.32.1.m1.1.1.1"></in><ci id="S4.T1.32.32.1.m1.1.1.2.cmml" xref="S4.T1.32.32.1.m1.1.1.2">𝑒</ci><apply id="S4.T1.32.32.1.m1.1.1.3.cmml" xref="S4.T1.32.32.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.32.32.1.m1.1.1.3.1.cmml" xref="S4.T1.32.32.1.m1.1.1.3">superscript</csymbol><ci id="S4.T1.32.32.1.m1.1.1.3.2.cmml" xref="S4.T1.32.32.1.m1.1.1.3.2">ℝ</ci><ci id="S4.T1.32.32.1.m1.1.1.3.3.cmml" xref="S4.T1.32.32.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.32.32.1.m1.1c">e\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.32.32.1.m1.1d">italic_e ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.32.32.2">embedding of item feature</td>
</tr>
<tr class="ltx_tr" id="S4.T1.33.33">
<td class="ltx_td ltx_align_center" id="S4.T1.33.33.1"><math alttext="l\in\mathbb{R}^{L}" class="ltx_Math" display="inline" id="S4.T1.33.33.1.m1.1"><semantics id="S4.T1.33.33.1.m1.1a"><mrow id="S4.T1.33.33.1.m1.1.1" xref="S4.T1.33.33.1.m1.1.1.cmml"><mi id="S4.T1.33.33.1.m1.1.1.2" xref="S4.T1.33.33.1.m1.1.1.2.cmml">l</mi><mo id="S4.T1.33.33.1.m1.1.1.1" xref="S4.T1.33.33.1.m1.1.1.1.cmml">∈</mo><msup id="S4.T1.33.33.1.m1.1.1.3" xref="S4.T1.33.33.1.m1.1.1.3.cmml"><mi id="S4.T1.33.33.1.m1.1.1.3.2" xref="S4.T1.33.33.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.T1.33.33.1.m1.1.1.3.3" xref="S4.T1.33.33.1.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.33.33.1.m1.1b"><apply id="S4.T1.33.33.1.m1.1.1.cmml" xref="S4.T1.33.33.1.m1.1.1"><in id="S4.T1.33.33.1.m1.1.1.1.cmml" xref="S4.T1.33.33.1.m1.1.1.1"></in><ci id="S4.T1.33.33.1.m1.1.1.2.cmml" xref="S4.T1.33.33.1.m1.1.1.2">𝑙</ci><apply id="S4.T1.33.33.1.m1.1.1.3.cmml" xref="S4.T1.33.33.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.33.33.1.m1.1.1.3.1.cmml" xref="S4.T1.33.33.1.m1.1.1.3">superscript</csymbol><ci id="S4.T1.33.33.1.m1.1.1.3.2.cmml" xref="S4.T1.33.33.1.m1.1.1.3.2">ℝ</ci><ci id="S4.T1.33.33.1.m1.1.1.3.3.cmml" xref="S4.T1.33.33.1.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.33.33.1.m1.1c">l\in\mathbb{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.33.33.1.m1.1d">italic_l ∈ blackboard_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.33.33.2">embedding of session (sequence of items within the session)</td>
</tr>
<tr class="ltx_tr" id="S4.T1.35.35">
<td class="ltx_td ltx_align_center" id="S4.T1.34.34.1"><math alttext="SRE" class="ltx_Math" display="inline" id="S4.T1.34.34.1.m1.1"><semantics id="S4.T1.34.34.1.m1.1a"><mrow id="S4.T1.34.34.1.m1.1.1" xref="S4.T1.34.34.1.m1.1.1.cmml"><mi id="S4.T1.34.34.1.m1.1.1.2" xref="S4.T1.34.34.1.m1.1.1.2.cmml">S</mi><mo id="S4.T1.34.34.1.m1.1.1.1" xref="S4.T1.34.34.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.T1.34.34.1.m1.1.1.3" xref="S4.T1.34.34.1.m1.1.1.3.cmml">R</mi><mo id="S4.T1.34.34.1.m1.1.1.1a" xref="S4.T1.34.34.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.T1.34.34.1.m1.1.1.4" xref="S4.T1.34.34.1.m1.1.1.4.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.34.34.1.m1.1b"><apply id="S4.T1.34.34.1.m1.1.1.cmml" xref="S4.T1.34.34.1.m1.1.1"><times id="S4.T1.34.34.1.m1.1.1.1.cmml" xref="S4.T1.34.34.1.m1.1.1.1"></times><ci id="S4.T1.34.34.1.m1.1.1.2.cmml" xref="S4.T1.34.34.1.m1.1.1.2">𝑆</ci><ci id="S4.T1.34.34.1.m1.1.1.3.cmml" xref="S4.T1.34.34.1.m1.1.1.3">𝑅</ci><ci id="S4.T1.34.34.1.m1.1.1.4.cmml" xref="S4.T1.34.34.1.m1.1.1.4">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.34.34.1.m1.1c">SRE</annotation><annotation encoding="application/x-llamapun" id="S4.T1.34.34.1.m1.1d">italic_S italic_R italic_E</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.35.35.2">encodes any length of item sequence to <math alttext="\mathcal{R}^{L}" class="ltx_Math" display="inline" id="S4.T1.35.35.2.m1.1"><semantics id="S4.T1.35.35.2.m1.1a"><msup id="S4.T1.35.35.2.m1.1.1" xref="S4.T1.35.35.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.35.35.2.m1.1.1.2" xref="S4.T1.35.35.2.m1.1.1.2.cmml">ℛ</mi><mi id="S4.T1.35.35.2.m1.1.1.3" xref="S4.T1.35.35.2.m1.1.1.3.cmml">L</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T1.35.35.2.m1.1b"><apply id="S4.T1.35.35.2.m1.1.1.cmml" xref="S4.T1.35.35.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.35.35.2.m1.1.1.1.cmml" xref="S4.T1.35.35.2.m1.1.1">superscript</csymbol><ci id="S4.T1.35.35.2.m1.1.1.2.cmml" xref="S4.T1.35.35.2.m1.1.1.2">ℛ</ci><ci id="S4.T1.35.35.2.m1.1.1.3.cmml" xref="S4.T1.35.35.2.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.35.35.2.m1.1c">\mathcal{R}^{L}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.35.35.2.m1.1d">caligraphic_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.36.36">
<td class="ltx_td ltx_align_center" id="S4.T1.36.36.1"><math alttext="g" class="ltx_Math" display="inline" id="S4.T1.36.36.1.m1.1"><semantics id="S4.T1.36.36.1.m1.1a"><mi id="S4.T1.36.36.1.m1.1.1" xref="S4.T1.36.36.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.T1.36.36.1.m1.1b"><ci id="S4.T1.36.36.1.m1.1.1.cmml" xref="S4.T1.36.36.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.36.36.1.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.T1.36.36.1.m1.1d">italic_g</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.36.36.2">the studied user long-term preference by HRA, the goal of LRA</td>
</tr>
<tr class="ltx_tr" id="S4.T1.37.37">
<td class="ltx_td ltx_align_center" id="S4.T1.37.37.1"><math alttext="\hat{e}" class="ltx_Math" display="inline" id="S4.T1.37.37.1.m1.1"><semantics id="S4.T1.37.37.1.m1.1a"><mover accent="true" id="S4.T1.37.37.1.m1.1.1" xref="S4.T1.37.37.1.m1.1.1.cmml"><mi id="S4.T1.37.37.1.m1.1.1.2" xref="S4.T1.37.37.1.m1.1.1.2.cmml">e</mi><mo id="S4.T1.37.37.1.m1.1.1.1" xref="S4.T1.37.37.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.T1.37.37.1.m1.1b"><apply id="S4.T1.37.37.1.m1.1.1.cmml" xref="S4.T1.37.37.1.m1.1.1"><ci id="S4.T1.37.37.1.m1.1.1.1.cmml" xref="S4.T1.37.37.1.m1.1.1.1">^</ci><ci id="S4.T1.37.37.1.m1.1.1.2.cmml" xref="S4.T1.37.37.1.m1.1.1.2">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.37.37.1.m1.1c">\hat{e}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.37.37.1.m1.1d">over^ start_ARG italic_e end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.37.37.2">the studied user short-term preference by LRA</td>
</tr>
<tr class="ltx_tr" id="S4.T1.38.38">
<td class="ltx_td ltx_align_center" id="S4.T1.38.38.1"><math alttext="\hat{k}" class="ltx_Math" display="inline" id="S4.T1.38.38.1.m1.1"><semantics id="S4.T1.38.38.1.m1.1a"><mover accent="true" id="S4.T1.38.38.1.m1.1.1" xref="S4.T1.38.38.1.m1.1.1.cmml"><mi id="S4.T1.38.38.1.m1.1.1.2" xref="S4.T1.38.38.1.m1.1.1.2.cmml">k</mi><mo id="S4.T1.38.38.1.m1.1.1.1" xref="S4.T1.38.38.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.T1.38.38.1.m1.1b"><apply id="S4.T1.38.38.1.m1.1.1.cmml" xref="S4.T1.38.38.1.m1.1.1"><ci id="S4.T1.38.38.1.m1.1.1.1.cmml" xref="S4.T1.38.38.1.m1.1.1.1">^</ci><ci id="S4.T1.38.38.1.m1.1.1.2.cmml" xref="S4.T1.38.38.1.m1.1.1.2">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.38.38.1.m1.1c">\hat{k}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.38.38.1.m1.1d">over^ start_ARG italic_k end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.38.38.2">index of the optimal item to exhibit at the next position</td>
</tr>
<tr class="ltx_tr" id="S4.T1.39.39">
<td class="ltx_td ltx_align_center" id="S4.T1.39.39.1"><math alttext="\mathscr{R}" class="ltx_Math" display="inline" id="S4.T1.39.39.1.m1.1"><semantics id="S4.T1.39.39.1.m1.1a"><mi class="ltx_font_mathscript" id="S4.T1.39.39.1.m1.1.1" xref="S4.T1.39.39.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.39.39.1.m1.1b"><ci id="S4.T1.39.39.1.m1.1.1.cmml" xref="S4.T1.39.39.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.39.39.1.m1.1c">\mathscr{R}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.39.39.1.m1.1d">script_R</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.39.39.2">the replay memory buffer</td>
</tr>
<tr class="ltx_tr" id="S4.T1.40.40">
<td class="ltx_td ltx_align_center" id="S4.T1.40.40.1"><math alttext="N" class="ltx_Math" display="inline" id="S4.T1.40.40.1.m1.1"><semantics id="S4.T1.40.40.1.m1.1a"><mi id="S4.T1.40.40.1.m1.1.1" xref="S4.T1.40.40.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T1.40.40.1.m1.1b"><ci id="S4.T1.40.40.1.m1.1.1.cmml" xref="S4.T1.40.40.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.40.40.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.T1.40.40.1.m1.1d">italic_N</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.40.40.2">the batch size of off-policy sampling</td>
</tr>
<tr class="ltx_tr" id="S4.T1.41.41">
<td class="ltx_td ltx_align_center" id="S4.T1.41.41.1"><math alttext="\eta" class="ltx_Math" display="inline" id="S4.T1.41.41.1.m1.1"><semantics id="S4.T1.41.41.1.m1.1a"><mi id="S4.T1.41.41.1.m1.1.1" xref="S4.T1.41.41.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.T1.41.41.1.m1.1b"><ci id="S4.T1.41.41.1.m1.1.1.cmml" xref="S4.T1.41.41.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.41.41.1.m1.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S4.T1.41.41.1.m1.1d">italic_η</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.41.41.2">the learning rate</td>
</tr>
<tr class="ltx_tr" id="S4.T1.42.42">
<td class="ltx_td ltx_align_center" id="S4.T1.42.42.1"><math alttext="\tau" class="ltx_Math" display="inline" id="S4.T1.42.42.1.m1.1"><semantics id="S4.T1.42.42.1.m1.1a"><mi id="S4.T1.42.42.1.m1.1.1" xref="S4.T1.42.42.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.42.42.1.m1.1b"><ci id="S4.T1.42.42.1.m1.1.1.cmml" xref="S4.T1.42.42.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.42.42.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.T1.42.42.1.m1.1d">italic_τ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S4.T1.42.42.2">the learning weight of target critic and actor</td>
</tr>
<tr class="ltx_tr" id="S4.T1.43.43">
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.43.43.1"><math alttext="\alpha" class="ltx_Math" display="inline" id="S4.T1.43.43.1.m1.1"><semantics id="S4.T1.43.43.1.m1.1a"><mi id="S4.T1.43.43.1.m1.1.1" xref="S4.T1.43.43.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T1.43.43.1.m1.1b"><ci id="S4.T1.43.43.1.m1.1.1.cmml" xref="S4.T1.43.43.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.43.43.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.T1.43.43.1.m1.1d">italic_α</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S4.T1.43.43.2">the weighting parameter of CQL correction term</td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">This section introduces the training mechanisms of mccHRL, with Table <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.T1" title="Table 1 ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> summarizing important symbols frequently used in the paper. We inherite the famous actor-critic RL architecture. However, here we let the HRA to be the critic and the LRA to be the actor solely, to reduce the computational complexity.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="458" id="S4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The Network Structure as well as Data Flows.
Arrow I: embedding vectors downloaded from Critic to Actor at the beginning of the session;
Arrow II: user click behaviors uploaded with latency;
Arrow III: HRA action called for intrinsic motivation of LRA.</figcaption>
</figure>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Session Recurrent Encoder</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">The session recurrent encoder (SRE) is an incremental function that aims to provide a session embedding with arbitrary session length and can be applied both in the learning and planning stages. Here we utilize the famous GRU structure, with <math alttext="e_{k}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">e</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑒</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">e_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> as the input:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="l_{k+1}=\text{SRE}(l_{k},e_{k}),\quad k=0,\cdots,K-1" class="ltx_Math" display="block" id="S4.E9.m1.4"><semantics id="S4.E9.m1.4a"><mrow id="S4.E9.m1.4.4.2" xref="S4.E9.m1.4.4.3.cmml"><mrow id="S4.E9.m1.3.3.1.1" xref="S4.E9.m1.3.3.1.1.cmml"><msub id="S4.E9.m1.3.3.1.1.4" xref="S4.E9.m1.3.3.1.1.4.cmml"><mi id="S4.E9.m1.3.3.1.1.4.2" xref="S4.E9.m1.3.3.1.1.4.2.cmml">l</mi><mrow id="S4.E9.m1.3.3.1.1.4.3" xref="S4.E9.m1.3.3.1.1.4.3.cmml"><mi id="S4.E9.m1.3.3.1.1.4.3.2" xref="S4.E9.m1.3.3.1.1.4.3.2.cmml">k</mi><mo id="S4.E9.m1.3.3.1.1.4.3.1" xref="S4.E9.m1.3.3.1.1.4.3.1.cmml">+</mo><mn id="S4.E9.m1.3.3.1.1.4.3.3" xref="S4.E9.m1.3.3.1.1.4.3.3.cmml">1</mn></mrow></msub><mo id="S4.E9.m1.3.3.1.1.3" xref="S4.E9.m1.3.3.1.1.3.cmml">=</mo><mrow id="S4.E9.m1.3.3.1.1.2" xref="S4.E9.m1.3.3.1.1.2.cmml"><mtext id="S4.E9.m1.3.3.1.1.2.4" xref="S4.E9.m1.3.3.1.1.2.4a.cmml">SRE</mtext><mo id="S4.E9.m1.3.3.1.1.2.3" xref="S4.E9.m1.3.3.1.1.2.3.cmml">⁢</mo><mrow id="S4.E9.m1.3.3.1.1.2.2.2" xref="S4.E9.m1.3.3.1.1.2.2.3.cmml"><mo id="S4.E9.m1.3.3.1.1.2.2.2.3" stretchy="false" xref="S4.E9.m1.3.3.1.1.2.2.3.cmml">(</mo><msub id="S4.E9.m1.3.3.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.3.3.1.1.1.1.1.1.2" xref="S4.E9.m1.3.3.1.1.1.1.1.1.2.cmml">l</mi><mi id="S4.E9.m1.3.3.1.1.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.E9.m1.3.3.1.1.2.2.2.4" xref="S4.E9.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S4.E9.m1.3.3.1.1.2.2.2.2" xref="S4.E9.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S4.E9.m1.3.3.1.1.2.2.2.2.2" xref="S4.E9.m1.3.3.1.1.2.2.2.2.2.cmml">e</mi><mi id="S4.E9.m1.3.3.1.1.2.2.2.2.3" xref="S4.E9.m1.3.3.1.1.2.2.2.2.3.cmml">k</mi></msub><mo id="S4.E9.m1.3.3.1.1.2.2.2.5" stretchy="false" xref="S4.E9.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9.m1.4.4.2.3" rspace="1.167em" xref="S4.E9.m1.4.4.3a.cmml">,</mo><mrow id="S4.E9.m1.4.4.2.2" xref="S4.E9.m1.4.4.2.2.cmml"><mi id="S4.E9.m1.4.4.2.2.3" xref="S4.E9.m1.4.4.2.2.3.cmml">k</mi><mo id="S4.E9.m1.4.4.2.2.2" xref="S4.E9.m1.4.4.2.2.2.cmml">=</mo><mrow id="S4.E9.m1.4.4.2.2.1.1" xref="S4.E9.m1.4.4.2.2.1.2.cmml"><mn id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml">0</mn><mo id="S4.E9.m1.4.4.2.2.1.1.2" xref="S4.E9.m1.4.4.2.2.1.2.cmml">,</mo><mi id="S4.E9.m1.2.2" mathvariant="normal" xref="S4.E9.m1.2.2.cmml">⋯</mi><mo id="S4.E9.m1.4.4.2.2.1.1.3" xref="S4.E9.m1.4.4.2.2.1.2.cmml">,</mo><mrow id="S4.E9.m1.4.4.2.2.1.1.1" xref="S4.E9.m1.4.4.2.2.1.1.1.cmml"><mi id="S4.E9.m1.4.4.2.2.1.1.1.2" xref="S4.E9.m1.4.4.2.2.1.1.1.2.cmml">K</mi><mo id="S4.E9.m1.4.4.2.2.1.1.1.1" xref="S4.E9.m1.4.4.2.2.1.1.1.1.cmml">−</mo><mn id="S4.E9.m1.4.4.2.2.1.1.1.3" xref="S4.E9.m1.4.4.2.2.1.1.1.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.4b"><apply id="S4.E9.m1.4.4.3.cmml" xref="S4.E9.m1.4.4.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.3a.cmml" xref="S4.E9.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S4.E9.m1.3.3.1.1.cmml" xref="S4.E9.m1.3.3.1.1"><eq id="S4.E9.m1.3.3.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.3"></eq><apply id="S4.E9.m1.3.3.1.1.4.cmml" xref="S4.E9.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.4.1.cmml" xref="S4.E9.m1.3.3.1.1.4">subscript</csymbol><ci id="S4.E9.m1.3.3.1.1.4.2.cmml" xref="S4.E9.m1.3.3.1.1.4.2">𝑙</ci><apply id="S4.E9.m1.3.3.1.1.4.3.cmml" xref="S4.E9.m1.3.3.1.1.4.3"><plus id="S4.E9.m1.3.3.1.1.4.3.1.cmml" xref="S4.E9.m1.3.3.1.1.4.3.1"></plus><ci id="S4.E9.m1.3.3.1.1.4.3.2.cmml" xref="S4.E9.m1.3.3.1.1.4.3.2">𝑘</ci><cn id="S4.E9.m1.3.3.1.1.4.3.3.cmml" type="integer" xref="S4.E9.m1.3.3.1.1.4.3.3">1</cn></apply></apply><apply id="S4.E9.m1.3.3.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.2"><times id="S4.E9.m1.3.3.1.1.2.3.cmml" xref="S4.E9.m1.3.3.1.1.2.3"></times><ci id="S4.E9.m1.3.3.1.1.2.4a.cmml" xref="S4.E9.m1.3.3.1.1.2.4"><mtext id="S4.E9.m1.3.3.1.1.2.4.cmml" xref="S4.E9.m1.3.3.1.1.2.4">SRE</mtext></ci><interval closure="open" id="S4.E9.m1.3.3.1.1.2.2.3.cmml" xref="S4.E9.m1.3.3.1.1.2.2.2"><apply id="S4.E9.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.2">𝑙</ci><ci id="S4.E9.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E9.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S4.E9.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.2.2.2">𝑒</ci><ci id="S4.E9.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S4.E9.m1.3.3.1.1.2.2.2.2.3">𝑘</ci></apply></interval></apply></apply><apply id="S4.E9.m1.4.4.2.2.cmml" xref="S4.E9.m1.4.4.2.2"><eq id="S4.E9.m1.4.4.2.2.2.cmml" xref="S4.E9.m1.4.4.2.2.2"></eq><ci id="S4.E9.m1.4.4.2.2.3.cmml" xref="S4.E9.m1.4.4.2.2.3">𝑘</ci><list id="S4.E9.m1.4.4.2.2.1.2.cmml" xref="S4.E9.m1.4.4.2.2.1.1"><cn id="S4.E9.m1.1.1.cmml" type="integer" xref="S4.E9.m1.1.1">0</cn><ci id="S4.E9.m1.2.2.cmml" xref="S4.E9.m1.2.2">⋯</ci><apply id="S4.E9.m1.4.4.2.2.1.1.1.cmml" xref="S4.E9.m1.4.4.2.2.1.1.1"><minus id="S4.E9.m1.4.4.2.2.1.1.1.1.cmml" xref="S4.E9.m1.4.4.2.2.1.1.1.1"></minus><ci id="S4.E9.m1.4.4.2.2.1.1.1.2.cmml" xref="S4.E9.m1.4.4.2.2.1.1.1.2">𝐾</ci><cn id="S4.E9.m1.4.4.2.2.1.1.1.3.cmml" type="integer" xref="S4.E9.m1.4.4.2.2.1.1.1.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.4c">l_{k+1}=\text{SRE}(l_{k},e_{k}),\quad k=0,\cdots,K-1</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.4d">italic_l start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT = SRE ( italic_l start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) , italic_k = 0 , ⋯ , italic_K - 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.3">the encoded session embedding <math alttext="l_{k}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m1.1"><semantics id="S4.SS1.p1.2.m1.1a"><msub id="S4.SS1.p1.2.m1.1.1" xref="S4.SS1.p1.2.m1.1.1.cmml"><mi id="S4.SS1.p1.2.m1.1.1.2" xref="S4.SS1.p1.2.m1.1.1.2.cmml">l</mi><mi id="S4.SS1.p1.2.m1.1.1.3" xref="S4.SS1.p1.2.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m1.1b"><apply id="S4.SS1.p1.2.m1.1.1.cmml" xref="S4.SS1.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m1.1.1.1.cmml" xref="S4.SS1.p1.2.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m1.1.1.2.cmml" xref="S4.SS1.p1.2.m1.1.1.2">𝑙</ci><ci id="S4.SS1.p1.2.m1.1.1.3.cmml" xref="S4.SS1.p1.2.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m1.1c">l_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m1.1d">italic_l start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the latent state of GRU which has the same dimension of <math alttext="e_{k}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m2.1"><semantics id="S4.SS1.p1.3.m2.1a"><msub id="S4.SS1.p1.3.m2.1.1" xref="S4.SS1.p1.3.m2.1.1.cmml"><mi id="S4.SS1.p1.3.m2.1.1.2" xref="S4.SS1.p1.3.m2.1.1.2.cmml">e</mi><mi id="S4.SS1.p1.3.m2.1.1.3" xref="S4.SS1.p1.3.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m2.1b"><apply id="S4.SS1.p1.3.m2.1.1.cmml" xref="S4.SS1.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m2.1.1.1.cmml" xref="S4.SS1.p1.3.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m2.1.1.2.cmml" xref="S4.SS1.p1.3.m2.1.1.2">𝑒</ci><ci id="S4.SS1.p1.3.m2.1.1.3.cmml" xref="S4.SS1.p1.3.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m2.1c">e_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m2.1d">italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>High-Level Agent</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.9">The HRA performs as the critic in our mccHRL. It is modeled with a parametric value function <math alttext="Q_{w}(s^{\text{h}},a^{\text{h}})" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.2"><semantics id="S4.SS2.p1.1.m1.2a"><mrow id="S4.SS2.p1.1.m1.2.2" xref="S4.SS2.p1.1.m1.2.2.cmml"><msub id="S4.SS2.p1.1.m1.2.2.4" xref="S4.SS2.p1.1.m1.2.2.4.cmml"><mi id="S4.SS2.p1.1.m1.2.2.4.2" xref="S4.SS2.p1.1.m1.2.2.4.2.cmml">Q</mi><mi id="S4.SS2.p1.1.m1.2.2.4.3" xref="S4.SS2.p1.1.m1.2.2.4.3.cmml">w</mi></msub><mo id="S4.SS2.p1.1.m1.2.2.3" xref="S4.SS2.p1.1.m1.2.2.3.cmml">⁢</mo><mrow id="S4.SS2.p1.1.m1.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.3.cmml"><mo id="S4.SS2.p1.1.m1.2.2.2.2.3" stretchy="false" xref="S4.SS2.p1.1.m1.2.2.2.3.cmml">(</mo><msup id="S4.SS2.p1.1.m1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml">s</mi><mtext id="S4.SS2.p1.1.m1.1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3a.cmml">h</mtext></msup><mo id="S4.SS2.p1.1.m1.2.2.2.2.4" xref="S4.SS2.p1.1.m1.2.2.2.3.cmml">,</mo><msup id="S4.SS2.p1.1.m1.2.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.2.cmml"><mi id="S4.SS2.p1.1.m1.2.2.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.cmml">a</mi><mtext id="S4.SS2.p1.1.m1.2.2.2.2.2.3" xref="S4.SS2.p1.1.m1.2.2.2.2.2.3a.cmml">h</mtext></msup><mo id="S4.SS2.p1.1.m1.2.2.2.2.5" stretchy="false" xref="S4.SS2.p1.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.2b"><apply id="S4.SS2.p1.1.m1.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2"><times id="S4.SS2.p1.1.m1.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.3"></times><apply id="S4.SS2.p1.1.m1.2.2.4.cmml" xref="S4.SS2.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.4.1.cmml" xref="S4.SS2.p1.1.m1.2.2.4">subscript</csymbol><ci id="S4.SS2.p1.1.m1.2.2.4.2.cmml" xref="S4.SS2.p1.1.m1.2.2.4.2">𝑄</ci><ci id="S4.SS2.p1.1.m1.2.2.4.3.cmml" xref="S4.SS2.p1.1.m1.2.2.4.3">𝑤</ci></apply><interval closure="open" id="S4.SS2.p1.1.m1.2.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2"><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.3a.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3"><mtext id="S4.SS2.p1.1.m1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3">h</mtext></ci></apply><apply id="S4.SS2.p1.1.m1.2.2.2.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2">superscript</csymbol><ci id="S4.SS2.p1.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2">𝑎</ci><ci id="S4.SS2.p1.1.m1.2.2.2.2.2.3a.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.3"><mtext id="S4.SS2.p1.1.m1.2.2.2.2.2.3.cmml" mathsize="70%" xref="S4.SS2.p1.1.m1.2.2.2.2.2.3">h</mtext></ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.2c">Q_{w}(s^{\text{h}},a^{\text{h}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.2d">italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT , italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT )</annotation></semantics></math>. The left part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.F3" title="Figure 3 ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> shows the critic network structure. Historical click sequences <math alttext="\{e\}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.2.2" xref="S4.SS2.p1.2.m2.1.2.1.cmml"><mo id="S4.SS2.p1.2.m2.1.2.2.1" stretchy="false" xref="S4.SS2.p1.2.m2.1.2.1.cmml">{</mo><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">e</mi><mo id="S4.SS2.p1.2.m2.1.2.2.2" stretchy="false" xref="S4.SS2.p1.2.m2.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><set id="S4.SS2.p1.2.m2.1.2.1.cmml" xref="S4.SS2.p1.2.m2.1.2.2"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑒</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\{e\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">{ italic_e }</annotation></semantics></math> are extracted from the cloud database, each encoded by SRE and then processed by a DIN structure <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib37" title="">2018</a>)</cite> with the last <math alttext="l" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_l</annotation></semantics></math> as the target tensor. The DIN output concatenates with <math alttext="u" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_u</annotation></semantics></math> and <math alttext="c^{o}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><msup id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">c</mi><mi id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">o</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">superscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">𝑐</ci><ci id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">c^{o}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT</annotation></semantics></math> and goes into first an FM layer first then an MLP. The last activation function of MLP is tanh which generates the Q-value. At the beginning of a session service, HRA also transmits <math alttext="u" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.1"><semantics id="S4.SS2.p1.6.m6.1a"><mi id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.1d">italic_u</annotation></semantics></math>, <math alttext="c^{o}" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m7.1"><semantics id="S4.SS2.p1.7.m7.1a"><msup id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">c</mi><mi id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml">o</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">superscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">𝑐</ci><ci id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">c^{o}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m7.1d">italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT</annotation></semantics></math>, and SRE to LRA, as indicated by Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.F3" title="Figure 3 ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. The output of <math alttext="Q_{w}" class="ltx_Math" display="inline" id="S4.SS2.p1.8.m8.1"><semantics id="S4.SS2.p1.8.m8.1a"><msub id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml"><mi id="S4.SS2.p1.8.m8.1.1.2" xref="S4.SS2.p1.8.m8.1.1.2.cmml">Q</mi><mi id="S4.SS2.p1.8.m8.1.1.3" xref="S4.SS2.p1.8.m8.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><apply id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p1.8.m8.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.2">𝑄</ci><ci id="S4.SS2.p1.8.m8.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">Q_{w}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.8.m8.1d">italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> then provides an implicit function of LRA goals <math alttext="g" class="ltx_Math" display="inline" id="S4.SS2.p1.9.m9.1"><semantics id="S4.SS2.p1.9.m9.1a"><mi id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><ci id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">g</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.9.m9.1d">italic_g</annotation></semantics></math>, as indicated by Arrow III.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Low-Level Agent</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.9">Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.F3" title="Figure 3 ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> shows the actor-network structure on the right, which implements our LRA policy function <math alttext="\pi_{\theta}(a^{\text{l}})|s^{\text{l}}))" class="ltx_math_unparsed" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1b"><mrow id="S4.SS3.p1.1.m1.1.1"><msub id="S4.SS3.p1.1.m1.1.1.1"><mi id="S4.SS3.p1.1.m1.1.1.1.2">π</mi><mi id="S4.SS3.p1.1.m1.1.1.1.3">θ</mi></msub><mrow id="S4.SS3.p1.1.m1.1.1.2"><mo id="S4.SS3.p1.1.m1.1.1.2.1" stretchy="false">(</mo><msup id="S4.SS3.p1.1.m1.1.1.2.2"><mi id="S4.SS3.p1.1.m1.1.1.2.2.2">a</mi><mtext id="S4.SS3.p1.1.m1.1.1.2.2.3">l</mtext></msup><mo id="S4.SS3.p1.1.m1.1.1.2.3" stretchy="false">)</mo></mrow><mo fence="false" id="S4.SS3.p1.1.m1.1.1.3" rspace="0.167em" stretchy="false">|</mo><msup id="S4.SS3.p1.1.m1.1.1.4"><mi id="S4.SS3.p1.1.m1.1.1.4.2">s</mi><mtext id="S4.SS3.p1.1.m1.1.1.4.3">l</mtext></msup><mo id="S4.SS3.p1.1.m1.1.1.5" stretchy="false">)</mo></mrow><mo id="S4.SS3.p1.1.m1.1.2" stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\pi_{\theta}(a^{\text{l}})|s^{\text{l}}))</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT ) | italic_s start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT ) )</annotation></semantics></math>. Since the size of the edge model is significantly limited by the on-device hardware, we design a relatively simple network structure. The local intra-session exposed item sequence <math alttext="\{e_{0},e_{1},\cdots,e_{k}\}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.4"><semantics id="S4.SS3.p1.2.m2.4a"><mrow id="S4.SS3.p1.2.m2.4.4.3" xref="S4.SS3.p1.2.m2.4.4.4.cmml"><mo id="S4.SS3.p1.2.m2.4.4.3.4" stretchy="false" xref="S4.SS3.p1.2.m2.4.4.4.cmml">{</mo><msub id="S4.SS3.p1.2.m2.2.2.1.1" xref="S4.SS3.p1.2.m2.2.2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.2.2.1.1.2" xref="S4.SS3.p1.2.m2.2.2.1.1.2.cmml">e</mi><mn id="S4.SS3.p1.2.m2.2.2.1.1.3" xref="S4.SS3.p1.2.m2.2.2.1.1.3.cmml">0</mn></msub><mo id="S4.SS3.p1.2.m2.4.4.3.5" xref="S4.SS3.p1.2.m2.4.4.4.cmml">,</mo><msub id="S4.SS3.p1.2.m2.3.3.2.2" xref="S4.SS3.p1.2.m2.3.3.2.2.cmml"><mi id="S4.SS3.p1.2.m2.3.3.2.2.2" xref="S4.SS3.p1.2.m2.3.3.2.2.2.cmml">e</mi><mn id="S4.SS3.p1.2.m2.3.3.2.2.3" xref="S4.SS3.p1.2.m2.3.3.2.2.3.cmml">1</mn></msub><mo id="S4.SS3.p1.2.m2.4.4.3.6" xref="S4.SS3.p1.2.m2.4.4.4.cmml">,</mo><mi id="S4.SS3.p1.2.m2.1.1" mathvariant="normal" xref="S4.SS3.p1.2.m2.1.1.cmml">⋯</mi><mo id="S4.SS3.p1.2.m2.4.4.3.7" xref="S4.SS3.p1.2.m2.4.4.4.cmml">,</mo><msub id="S4.SS3.p1.2.m2.4.4.3.3" xref="S4.SS3.p1.2.m2.4.4.3.3.cmml"><mi id="S4.SS3.p1.2.m2.4.4.3.3.2" xref="S4.SS3.p1.2.m2.4.4.3.3.2.cmml">e</mi><mi id="S4.SS3.p1.2.m2.4.4.3.3.3" xref="S4.SS3.p1.2.m2.4.4.3.3.3.cmml">k</mi></msub><mo id="S4.SS3.p1.2.m2.4.4.3.8" stretchy="false" xref="S4.SS3.p1.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.4b"><set id="S4.SS3.p1.2.m2.4.4.4.cmml" xref="S4.SS3.p1.2.m2.4.4.3"><apply id="S4.SS3.p1.2.m2.2.2.1.1.cmml" xref="S4.SS3.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.2.2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.2.2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.2.2.1.1.2">𝑒</ci><cn id="S4.SS3.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S4.SS3.p1.2.m2.2.2.1.1.3">0</cn></apply><apply id="S4.SS3.p1.2.m2.3.3.2.2.cmml" xref="S4.SS3.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.3.3.2.2.1.cmml" xref="S4.SS3.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p1.2.m2.3.3.2.2.2.cmml" xref="S4.SS3.p1.2.m2.3.3.2.2.2">𝑒</ci><cn id="S4.SS3.p1.2.m2.3.3.2.2.3.cmml" type="integer" xref="S4.SS3.p1.2.m2.3.3.2.2.3">1</cn></apply><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">⋯</ci><apply id="S4.SS3.p1.2.m2.4.4.3.3.cmml" xref="S4.SS3.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.4.4.3.3.1.cmml" xref="S4.SS3.p1.2.m2.4.4.3.3">subscript</csymbol><ci id="S4.SS3.p1.2.m2.4.4.3.3.2.cmml" xref="S4.SS3.p1.2.m2.4.4.3.3.2">𝑒</ci><ci id="S4.SS3.p1.2.m2.4.4.3.3.3.cmml" xref="S4.SS3.p1.2.m2.4.4.3.3.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.4c">\{e_{0},e_{1},\cdots,e_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.4d">{ italic_e start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math> is again encoded by SRE, while the on-device user profile sequence <math alttext="\{m_{0},m_{1},\cdots,m_{k}\}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.4"><semantics id="S4.SS3.p1.3.m3.4a"><mrow id="S4.SS3.p1.3.m3.4.4.3" xref="S4.SS3.p1.3.m3.4.4.4.cmml"><mo id="S4.SS3.p1.3.m3.4.4.3.4" stretchy="false" xref="S4.SS3.p1.3.m3.4.4.4.cmml">{</mo><msub id="S4.SS3.p1.3.m3.2.2.1.1" xref="S4.SS3.p1.3.m3.2.2.1.1.cmml"><mi id="S4.SS3.p1.3.m3.2.2.1.1.2" xref="S4.SS3.p1.3.m3.2.2.1.1.2.cmml">m</mi><mn id="S4.SS3.p1.3.m3.2.2.1.1.3" xref="S4.SS3.p1.3.m3.2.2.1.1.3.cmml">0</mn></msub><mo id="S4.SS3.p1.3.m3.4.4.3.5" xref="S4.SS3.p1.3.m3.4.4.4.cmml">,</mo><msub id="S4.SS3.p1.3.m3.3.3.2.2" xref="S4.SS3.p1.3.m3.3.3.2.2.cmml"><mi id="S4.SS3.p1.3.m3.3.3.2.2.2" xref="S4.SS3.p1.3.m3.3.3.2.2.2.cmml">m</mi><mn id="S4.SS3.p1.3.m3.3.3.2.2.3" xref="S4.SS3.p1.3.m3.3.3.2.2.3.cmml">1</mn></msub><mo id="S4.SS3.p1.3.m3.4.4.3.6" xref="S4.SS3.p1.3.m3.4.4.4.cmml">,</mo><mi id="S4.SS3.p1.3.m3.1.1" mathvariant="normal" xref="S4.SS3.p1.3.m3.1.1.cmml">⋯</mi><mo id="S4.SS3.p1.3.m3.4.4.3.7" xref="S4.SS3.p1.3.m3.4.4.4.cmml">,</mo><msub id="S4.SS3.p1.3.m3.4.4.3.3" xref="S4.SS3.p1.3.m3.4.4.3.3.cmml"><mi id="S4.SS3.p1.3.m3.4.4.3.3.2" xref="S4.SS3.p1.3.m3.4.4.3.3.2.cmml">m</mi><mi id="S4.SS3.p1.3.m3.4.4.3.3.3" xref="S4.SS3.p1.3.m3.4.4.3.3.3.cmml">k</mi></msub><mo id="S4.SS3.p1.3.m3.4.4.3.8" stretchy="false" xref="S4.SS3.p1.3.m3.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.4b"><set id="S4.SS3.p1.3.m3.4.4.4.cmml" xref="S4.SS3.p1.3.m3.4.4.3"><apply id="S4.SS3.p1.3.m3.2.2.1.1.cmml" xref="S4.SS3.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.2.2.1.1.1.cmml" xref="S4.SS3.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S4.SS3.p1.3.m3.2.2.1.1.2.cmml" xref="S4.SS3.p1.3.m3.2.2.1.1.2">𝑚</ci><cn id="S4.SS3.p1.3.m3.2.2.1.1.3.cmml" type="integer" xref="S4.SS3.p1.3.m3.2.2.1.1.3">0</cn></apply><apply id="S4.SS3.p1.3.m3.3.3.2.2.cmml" xref="S4.SS3.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.3.3.2.2.1.cmml" xref="S4.SS3.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p1.3.m3.3.3.2.2.2.cmml" xref="S4.SS3.p1.3.m3.3.3.2.2.2">𝑚</ci><cn id="S4.SS3.p1.3.m3.3.3.2.2.3.cmml" type="integer" xref="S4.SS3.p1.3.m3.3.3.2.2.3">1</cn></apply><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">⋯</ci><apply id="S4.SS3.p1.3.m3.4.4.3.3.cmml" xref="S4.SS3.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.4.4.3.3.1.cmml" xref="S4.SS3.p1.3.m3.4.4.3.3">subscript</csymbol><ci id="S4.SS3.p1.3.m3.4.4.3.3.2.cmml" xref="S4.SS3.p1.3.m3.4.4.3.3.2">𝑚</ci><ci id="S4.SS3.p1.3.m3.4.4.3.3.3.cmml" xref="S4.SS3.p1.3.m3.4.4.3.3.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.4c">\{m_{0},m_{1},\cdots,m_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.4d">{ italic_m start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math> is encoded by another GRU unit. Concatenation of the last latent states of SRE and GRU forms the intra-session context <math alttext="c^{i}" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><msup id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">c</mi><mi id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">𝑐</ci><ci id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">c^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">italic_c start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>. We further concatenate <math alttext="u" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m5.1"><semantics id="S4.SS3.p1.5.m5.1a"><mi id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><ci id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">u</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m5.1d">italic_u</annotation></semantics></math>, <math alttext="c^{o}" class="ltx_Math" display="inline" id="S4.SS3.p1.6.m6.1"><semantics id="S4.SS3.p1.6.m6.1a"><msup id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mi id="S4.SS3.p1.6.m6.1.1.2" xref="S4.SS3.p1.6.m6.1.1.2.cmml">c</mi><mi id="S4.SS3.p1.6.m6.1.1.3" xref="S4.SS3.p1.6.m6.1.1.3.cmml">o</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2">𝑐</ci><ci id="S4.SS3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">c^{o}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.6.m6.1d">italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="c^{i}" class="ltx_Math" display="inline" id="S4.SS3.p1.7.m7.1"><semantics id="S4.SS3.p1.7.m7.1a"><msup id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml"><mi id="S4.SS3.p1.7.m7.1.1.2" xref="S4.SS3.p1.7.m7.1.1.2.cmml">c</mi><mi id="S4.SS3.p1.7.m7.1.1.3" xref="S4.SS3.p1.7.m7.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b"><apply id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m7.1.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1">superscript</csymbol><ci id="S4.SS3.p1.7.m7.1.1.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2">𝑐</ci><ci id="S4.SS3.p1.7.m7.1.1.3.cmml" xref="S4.SS3.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">c^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.7.m7.1d">italic_c start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> together and feed into a MLP which generates <math alttext="\hat{e}_{k}\in R^{L}" class="ltx_Math" display="inline" id="S4.SS3.p1.8.m8.1"><semantics id="S4.SS3.p1.8.m8.1a"><mrow id="S4.SS3.p1.8.m8.1.1" xref="S4.SS3.p1.8.m8.1.1.cmml"><msub id="S4.SS3.p1.8.m8.1.1.2" xref="S4.SS3.p1.8.m8.1.1.2.cmml"><mover accent="true" id="S4.SS3.p1.8.m8.1.1.2.2" xref="S4.SS3.p1.8.m8.1.1.2.2.cmml"><mi id="S4.SS3.p1.8.m8.1.1.2.2.2" xref="S4.SS3.p1.8.m8.1.1.2.2.2.cmml">e</mi><mo id="S4.SS3.p1.8.m8.1.1.2.2.1" xref="S4.SS3.p1.8.m8.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS3.p1.8.m8.1.1.2.3" xref="S4.SS3.p1.8.m8.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS3.p1.8.m8.1.1.1" xref="S4.SS3.p1.8.m8.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.8.m8.1.1.3" xref="S4.SS3.p1.8.m8.1.1.3.cmml"><mi id="S4.SS3.p1.8.m8.1.1.3.2" xref="S4.SS3.p1.8.m8.1.1.3.2.cmml">R</mi><mi id="S4.SS3.p1.8.m8.1.1.3.3" xref="S4.SS3.p1.8.m8.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m8.1b"><apply id="S4.SS3.p1.8.m8.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1"><in id="S4.SS3.p1.8.m8.1.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1.1"></in><apply id="S4.SS3.p1.8.m8.1.1.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.1.2.1.cmml" xref="S4.SS3.p1.8.m8.1.1.2">subscript</csymbol><apply id="S4.SS3.p1.8.m8.1.1.2.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2"><ci id="S4.SS3.p1.8.m8.1.1.2.2.1.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.1">^</ci><ci id="S4.SS3.p1.8.m8.1.1.2.2.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.2">𝑒</ci></apply><ci id="S4.SS3.p1.8.m8.1.1.2.3.cmml" xref="S4.SS3.p1.8.m8.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p1.8.m8.1.1.3.cmml" xref="S4.SS3.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.1.3.1.cmml" xref="S4.SS3.p1.8.m8.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.8.m8.1.1.3.2.cmml" xref="S4.SS3.p1.8.m8.1.1.3.2">𝑅</ci><ci id="S4.SS3.p1.8.m8.1.1.3.3.cmml" xref="S4.SS3.p1.8.m8.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m8.1c">\hat{e}_{k}\in R^{L}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.8.m8.1d">over^ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ italic_R start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math>, as <math alttext="a^{\text{l}}_{k}" class="ltx_Math" display="inline" id="S4.SS3.p1.9.m9.1"><semantics id="S4.SS3.p1.9.m9.1a"><msubsup id="S4.SS3.p1.9.m9.1.1" xref="S4.SS3.p1.9.m9.1.1.cmml"><mi id="S4.SS3.p1.9.m9.1.1.2.2" xref="S4.SS3.p1.9.m9.1.1.2.2.cmml">a</mi><mi id="S4.SS3.p1.9.m9.1.1.3" xref="S4.SS3.p1.9.m9.1.1.3.cmml">k</mi><mtext id="S4.SS3.p1.9.m9.1.1.2.3" xref="S4.SS3.p1.9.m9.1.1.2.3a.cmml">l</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m9.1b"><apply id="S4.SS3.p1.9.m9.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1">subscript</csymbol><apply id="S4.SS3.p1.9.m9.1.1.2.cmml" xref="S4.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.2.1.cmml" xref="S4.SS3.p1.9.m9.1.1">superscript</csymbol><ci id="S4.SS3.p1.9.m9.1.1.2.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2">𝑎</ci><ci id="S4.SS3.p1.9.m9.1.1.2.3a.cmml" xref="S4.SS3.p1.9.m9.1.1.2.3"><mtext id="S4.SS3.p1.9.m9.1.1.2.3.cmml" mathsize="70%" xref="S4.SS3.p1.9.m9.1.1.2.3">l</mtext></ci></apply><ci id="S4.SS3.p1.9.m9.1.1.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m9.1c">a^{\text{l}}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.9.m9.1d">italic_a start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. During the training stage, gradient back-propagation of SRE in the actor is blocked to reduce the computational complexity.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">During the service stage, <math alttext="\hat{e}_{k}" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><msub id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mover accent="true" id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2.2" xref="S4.SS3.p2.1.m1.1.1.2.2.cmml">e</mi><mo id="S4.SS3.p2.1.m1.1.1.2.1" xref="S4.SS3.p2.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2"><ci id="S4.SS3.p2.1.m1.1.1.2.1.cmml" xref="S4.SS3.p2.1.m1.1.1.2.1">^</ci><ci id="S4.SS3.p2.1.m1.1.1.2.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2.2">𝑒</ci></apply><ci id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\hat{e}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">over^ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is dot multiplied with the embeddings of unselected items and generates scalar scores, then greedily selects the optimal item:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{k}=\arg\max\{\hat{e}_{k}e_{k^{\prime}}^{T}\},\quad k^{\prime}=k+1,\cdots,%
K^{\prime}" class="ltx_Math" display="block" id="S4.E10.m1.4"><semantics id="S4.E10.m1.4a"><mrow id="S4.E10.m1.4.4.2" xref="S4.E10.m1.4.4.3.cmml"><mrow id="S4.E10.m1.3.3.1.1" xref="S4.E10.m1.3.3.1.1.cmml"><mover accent="true" id="S4.E10.m1.3.3.1.1.3" xref="S4.E10.m1.3.3.1.1.3.cmml"><mi id="S4.E10.m1.3.3.1.1.3.2" xref="S4.E10.m1.3.3.1.1.3.2.cmml">k</mi><mo id="S4.E10.m1.3.3.1.1.3.1" xref="S4.E10.m1.3.3.1.1.3.1.cmml">^</mo></mover><mo id="S4.E10.m1.3.3.1.1.2" xref="S4.E10.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E10.m1.3.3.1.1.1" xref="S4.E10.m1.3.3.1.1.1.cmml"><mi id="S4.E10.m1.3.3.1.1.1.2" xref="S4.E10.m1.3.3.1.1.1.2.cmml">arg</mi><mo id="S4.E10.m1.3.3.1.1.1a" lspace="0.167em" xref="S4.E10.m1.3.3.1.1.1.cmml">⁡</mo><mrow id="S4.E10.m1.3.3.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.2.cmml"><mi id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml">max</mi><mo id="S4.E10.m1.3.3.1.1.1.1.1a" xref="S4.E10.m1.3.3.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E10.m1.3.3.1.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.2.cmml"><mo id="S4.E10.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.3.3.1.1.1.1.2.cmml">{</mo><mrow id="S4.E10.m1.3.3.1.1.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="S4.E10.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">e</mi><mo id="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="S4.E10.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml">e</mi><msup id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3.2.cmml">k</mi><mo id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3.3.cmml">′</mo></msup><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">T</mi></msubsup></mrow><mo id="S4.E10.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S4.E10.m1.3.3.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow></mrow><mo id="S4.E10.m1.4.4.2.3" rspace="1.167em" xref="S4.E10.m1.4.4.3a.cmml">,</mo><mrow id="S4.E10.m1.4.4.2.2" xref="S4.E10.m1.4.4.2.2.cmml"><msup id="S4.E10.m1.4.4.2.2.4" xref="S4.E10.m1.4.4.2.2.4.cmml"><mi id="S4.E10.m1.4.4.2.2.4.2" xref="S4.E10.m1.4.4.2.2.4.2.cmml">k</mi><mo id="S4.E10.m1.4.4.2.2.4.3" xref="S4.E10.m1.4.4.2.2.4.3.cmml">′</mo></msup><mo id="S4.E10.m1.4.4.2.2.3" xref="S4.E10.m1.4.4.2.2.3.cmml">=</mo><mrow id="S4.E10.m1.4.4.2.2.2.2" xref="S4.E10.m1.4.4.2.2.2.3.cmml"><mrow id="S4.E10.m1.4.4.2.2.1.1.1" xref="S4.E10.m1.4.4.2.2.1.1.1.cmml"><mi id="S4.E10.m1.4.4.2.2.1.1.1.2" xref="S4.E10.m1.4.4.2.2.1.1.1.2.cmml">k</mi><mo id="S4.E10.m1.4.4.2.2.1.1.1.1" xref="S4.E10.m1.4.4.2.2.1.1.1.1.cmml">+</mo><mn id="S4.E10.m1.4.4.2.2.1.1.1.3" xref="S4.E10.m1.4.4.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E10.m1.4.4.2.2.2.2.3" xref="S4.E10.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S4.E10.m1.2.2" mathvariant="normal" xref="S4.E10.m1.2.2.cmml">⋯</mi><mo id="S4.E10.m1.4.4.2.2.2.2.4" xref="S4.E10.m1.4.4.2.2.2.3.cmml">,</mo><msup id="S4.E10.m1.4.4.2.2.2.2.2" xref="S4.E10.m1.4.4.2.2.2.2.2.cmml"><mi id="S4.E10.m1.4.4.2.2.2.2.2.2" xref="S4.E10.m1.4.4.2.2.2.2.2.2.cmml">K</mi><mo id="S4.E10.m1.4.4.2.2.2.2.2.3" xref="S4.E10.m1.4.4.2.2.2.2.2.3.cmml">′</mo></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.4b"><apply id="S4.E10.m1.4.4.3.cmml" xref="S4.E10.m1.4.4.2"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.3a.cmml" xref="S4.E10.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S4.E10.m1.3.3.1.1.cmml" xref="S4.E10.m1.3.3.1.1"><eq id="S4.E10.m1.3.3.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.2"></eq><apply id="S4.E10.m1.3.3.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.3"><ci id="S4.E10.m1.3.3.1.1.3.1.cmml" xref="S4.E10.m1.3.3.1.1.3.1">^</ci><ci id="S4.E10.m1.3.3.1.1.3.2.cmml" xref="S4.E10.m1.3.3.1.1.3.2">𝑘</ci></apply><apply id="S4.E10.m1.3.3.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1"><arg id="S4.E10.m1.3.3.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.1.2"></arg><apply id="S4.E10.m1.3.3.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1"><max id="S4.E10.m1.1.1.cmml" xref="S4.E10.m1.1.1"></max><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1"><times id="S4.E10.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.1"></times><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2"><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.2.2">𝑒</ci></apply><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.2">𝑒</ci><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3">superscript</csymbol><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3.2">𝑘</ci><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.2.3.3">′</ci></apply></apply><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></apply></apply><apply id="S4.E10.m1.4.4.2.2.cmml" xref="S4.E10.m1.4.4.2.2"><eq id="S4.E10.m1.4.4.2.2.3.cmml" xref="S4.E10.m1.4.4.2.2.3"></eq><apply id="S4.E10.m1.4.4.2.2.4.cmml" xref="S4.E10.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.2.2.4.1.cmml" xref="S4.E10.m1.4.4.2.2.4">superscript</csymbol><ci id="S4.E10.m1.4.4.2.2.4.2.cmml" xref="S4.E10.m1.4.4.2.2.4.2">𝑘</ci><ci id="S4.E10.m1.4.4.2.2.4.3.cmml" xref="S4.E10.m1.4.4.2.2.4.3">′</ci></apply><list id="S4.E10.m1.4.4.2.2.2.3.cmml" xref="S4.E10.m1.4.4.2.2.2.2"><apply id="S4.E10.m1.4.4.2.2.1.1.1.cmml" xref="S4.E10.m1.4.4.2.2.1.1.1"><plus id="S4.E10.m1.4.4.2.2.1.1.1.1.cmml" xref="S4.E10.m1.4.4.2.2.1.1.1.1"></plus><ci id="S4.E10.m1.4.4.2.2.1.1.1.2.cmml" xref="S4.E10.m1.4.4.2.2.1.1.1.2">𝑘</ci><cn id="S4.E10.m1.4.4.2.2.1.1.1.3.cmml" type="integer" xref="S4.E10.m1.4.4.2.2.1.1.1.3">1</cn></apply><ci id="S4.E10.m1.2.2.cmml" xref="S4.E10.m1.2.2">⋯</ci><apply id="S4.E10.m1.4.4.2.2.2.2.2.cmml" xref="S4.E10.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.2.2.2.2.2.1.cmml" xref="S4.E10.m1.4.4.2.2.2.2.2">superscript</csymbol><ci id="S4.E10.m1.4.4.2.2.2.2.2.2.cmml" xref="S4.E10.m1.4.4.2.2.2.2.2.2">𝐾</ci><ci id="S4.E10.m1.4.4.2.2.2.2.2.3.cmml" xref="S4.E10.m1.4.4.2.2.2.2.2.3">′</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.4c">\hat{k}=\arg\max\{\hat{e}_{k}e_{k^{\prime}}^{T}\},\quad k^{\prime}=k+1,\cdots,%
K^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.4d">over^ start_ARG italic_k end_ARG = roman_arg roman_max { over^ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_e start_POSTSUBSCRIPT italic_k start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT } , italic_k start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_k + 1 , ⋯ , italic_K start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p2.7">in which <math alttext="K^{\prime}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m1.1"><semantics id="S4.SS3.p2.2.m1.1a"><msup id="S4.SS3.p2.2.m1.1.1" xref="S4.SS3.p2.2.m1.1.1.cmml"><mi id="S4.SS3.p2.2.m1.1.1.2" xref="S4.SS3.p2.2.m1.1.1.2.cmml">K</mi><mo id="S4.SS3.p2.2.m1.1.1.3" xref="S4.SS3.p2.2.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m1.1b"><apply id="S4.SS3.p2.2.m1.1.1.cmml" xref="S4.SS3.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m1.1.1.1.cmml" xref="S4.SS3.p2.2.m1.1.1">superscript</csymbol><ci id="S4.SS3.p2.2.m1.1.1.2.cmml" xref="S4.SS3.p2.2.m1.1.1.2">𝐾</ci><ci id="S4.SS3.p2.2.m1.1.1.3.cmml" xref="S4.SS3.p2.2.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m1.1c">K^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m1.1d">italic_K start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the remained item candidate set size (and can be assumed to be larger than <math alttext="K" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m2.1"><semantics id="S4.SS3.p2.3.m2.1a"><mi id="S4.SS3.p2.3.m2.1.1" xref="S4.SS3.p2.3.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m2.1b"><ci id="S4.SS3.p2.3.m2.1.1.cmml" xref="S4.SS3.p2.3.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m2.1d">italic_K</annotation></semantics></math>). The <math alttext="\hat{k}" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m3.1"><semantics id="S4.SS3.p2.4.m3.1a"><mover accent="true" id="S4.SS3.p2.4.m3.1.1" xref="S4.SS3.p2.4.m3.1.1.cmml"><mi id="S4.SS3.p2.4.m3.1.1.2" xref="S4.SS3.p2.4.m3.1.1.2.cmml">k</mi><mo id="S4.SS3.p2.4.m3.1.1.1" xref="S4.SS3.p2.4.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m3.1b"><apply id="S4.SS3.p2.4.m3.1.1.cmml" xref="S4.SS3.p2.4.m3.1.1"><ci id="S4.SS3.p2.4.m3.1.1.1.cmml" xref="S4.SS3.p2.4.m3.1.1.1">^</ci><ci id="S4.SS3.p2.4.m3.1.1.2.cmml" xref="S4.SS3.p2.4.m3.1.1.2">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m3.1c">\hat{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m3.1d">over^ start_ARG italic_k end_ARG</annotation></semantics></math>th item is appended to the end of recommendation, then the step moves forward from <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m4.1"><semantics id="S4.SS3.p2.5.m4.1a"><mi id="S4.SS3.p2.5.m4.1.1" xref="S4.SS3.p2.5.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m4.1b"><ci id="S4.SS3.p2.5.m4.1.1.cmml" xref="S4.SS3.p2.5.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m4.1d">italic_k</annotation></semantics></math> to <math alttext="k+1" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m5.1"><semantics id="S4.SS3.p2.6.m5.1a"><mrow id="S4.SS3.p2.6.m5.1.1" xref="S4.SS3.p2.6.m5.1.1.cmml"><mi id="S4.SS3.p2.6.m5.1.1.2" xref="S4.SS3.p2.6.m5.1.1.2.cmml">k</mi><mo id="S4.SS3.p2.6.m5.1.1.1" xref="S4.SS3.p2.6.m5.1.1.1.cmml">+</mo><mn id="S4.SS3.p2.6.m5.1.1.3" xref="S4.SS3.p2.6.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m5.1b"><apply id="S4.SS3.p2.6.m5.1.1.cmml" xref="S4.SS3.p2.6.m5.1.1"><plus id="S4.SS3.p2.6.m5.1.1.1.cmml" xref="S4.SS3.p2.6.m5.1.1.1"></plus><ci id="S4.SS3.p2.6.m5.1.1.2.cmml" xref="S4.SS3.p2.6.m5.1.1.2">𝑘</ci><cn id="S4.SS3.p2.6.m5.1.1.3.cmml" type="integer" xref="S4.SS3.p2.6.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m5.1c">k+1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m5.1d">italic_k + 1</annotation></semantics></math> until all <math alttext="K" class="ltx_Math" display="inline" id="S4.SS3.p2.7.m6.1"><semantics id="S4.SS3.p2.7.m6.1a"><mi id="S4.SS3.p2.7.m6.1.1" xref="S4.SS3.p2.7.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m6.1b"><ci id="S4.SS3.p2.7.m6.1.1.cmml" xref="S4.SS3.p2.7.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.7.m6.1d">italic_K</annotation></semantics></math> items are determined.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Mechanism</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.6">Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S3.F2" title="Figure 2 ‣ 3.2 Reinforcement Learning ‣ 3 Preliminary and Problem Formulation ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> reviews the aforementioned interactive pattern of HRA and LRA. HRA operates at the real world time <math alttext="t" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">italic_t</annotation></semantics></math>, observes the current user state <math alttext="s^{\text{h}}_{t}" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><msubsup id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2.2" xref="S4.SS4.p1.2.m2.1.1.2.2.cmml">s</mi><mi id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml">t</mi><mtext id="S4.SS4.p1.2.m2.1.1.2.3" xref="S4.SS4.p1.2.m2.1.1.2.3a.cmml">h</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">subscript</csymbol><apply id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.2.1.cmml" xref="S4.SS4.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS4.p1.2.m2.1.1.2.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2.2">𝑠</ci><ci id="S4.SS4.p1.2.m2.1.1.2.3a.cmml" xref="S4.SS4.p1.2.m2.1.1.2.3"><mtext id="S4.SS4.p1.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S4.SS4.p1.2.m2.1.1.2.3">h</mtext></ci></apply><ci id="S4.SS4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">s^{\text{h}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and provides the user favorable preference by the High-Level action <math alttext="a^{\text{h}}_{t}" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><msubsup id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2.2" xref="S4.SS4.p1.3.m3.1.1.2.2.cmml">a</mi><mi id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml">t</mi><mtext id="S4.SS4.p1.3.m3.1.1.2.3" xref="S4.SS4.p1.3.m3.1.1.2.3a.cmml">h</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">subscript</csymbol><apply id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.2.1.cmml" xref="S4.SS4.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS4.p1.3.m3.1.1.2.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2.2">𝑎</ci><ci id="S4.SS4.p1.3.m3.1.1.2.3a.cmml" xref="S4.SS4.p1.3.m3.1.1.2.3"><mtext id="S4.SS4.p1.3.m3.1.1.2.3.cmml" mathsize="70%" xref="S4.SS4.p1.3.m3.1.1.2.3">h</mtext></ci></apply><ci id="S4.SS4.p1.3.m3.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">a^{\text{h}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> once a session service is requested. The HRA training is executed on the cloud side based on all users’ logs, and policy updates once the session ends with the real, non-delayed session-wise user response <math alttext="r^{\text{h}}_{t}" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m4.1"><semantics id="S4.SS4.p1.4.m4.1a"><msubsup id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi id="S4.SS4.p1.4.m4.1.1.2.2" xref="S4.SS4.p1.4.m4.1.1.2.2.cmml">r</mi><mi id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml">t</mi><mtext id="S4.SS4.p1.4.m4.1.1.2.3" xref="S4.SS4.p1.4.m4.1.1.2.3a.cmml">h</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">subscript</csymbol><apply id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.2.1.cmml" xref="S4.SS4.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS4.p1.4.m4.1.1.2.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2.2">𝑟</ci><ci id="S4.SS4.p1.4.m4.1.1.2.3a.cmml" xref="S4.SS4.p1.4.m4.1.1.2.3"><mtext id="S4.SS4.p1.4.m4.1.1.2.3.cmml" mathsize="70%" xref="S4.SS4.p1.4.m4.1.1.2.3">h</mtext></ci></apply><ci id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">r^{\text{h}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m4.1d">italic_r start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Within each session’s servicing, LRA aims to determine the ranked list of <math alttext="K" class="ltx_Math" display="inline" id="S4.SS4.p1.5.m5.1"><semantics id="S4.SS4.p1.5.m5.1a"><mi id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><ci id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.5.m5.1d">italic_K</annotation></semantics></math> items, therefore operating at the virtual time steps <math alttext="k=0,1,\cdots,K" class="ltx_Math" display="inline" id="S4.SS4.p1.6.m6.4"><semantics id="S4.SS4.p1.6.m6.4a"><mrow id="S4.SS4.p1.6.m6.4.5" xref="S4.SS4.p1.6.m6.4.5.cmml"><mi id="S4.SS4.p1.6.m6.4.5.2" xref="S4.SS4.p1.6.m6.4.5.2.cmml">k</mi><mo id="S4.SS4.p1.6.m6.4.5.1" xref="S4.SS4.p1.6.m6.4.5.1.cmml">=</mo><mrow id="S4.SS4.p1.6.m6.4.5.3.2" xref="S4.SS4.p1.6.m6.4.5.3.1.cmml"><mn id="S4.SS4.p1.6.m6.1.1" xref="S4.SS4.p1.6.m6.1.1.cmml">0</mn><mo id="S4.SS4.p1.6.m6.4.5.3.2.1" xref="S4.SS4.p1.6.m6.4.5.3.1.cmml">,</mo><mn id="S4.SS4.p1.6.m6.2.2" xref="S4.SS4.p1.6.m6.2.2.cmml">1</mn><mo id="S4.SS4.p1.6.m6.4.5.3.2.2" xref="S4.SS4.p1.6.m6.4.5.3.1.cmml">,</mo><mi id="S4.SS4.p1.6.m6.3.3" mathvariant="normal" xref="S4.SS4.p1.6.m6.3.3.cmml">⋯</mi><mo id="S4.SS4.p1.6.m6.4.5.3.2.3" xref="S4.SS4.p1.6.m6.4.5.3.1.cmml">,</mo><mi id="S4.SS4.p1.6.m6.4.4" xref="S4.SS4.p1.6.m6.4.4.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m6.4b"><apply id="S4.SS4.p1.6.m6.4.5.cmml" xref="S4.SS4.p1.6.m6.4.5"><eq id="S4.SS4.p1.6.m6.4.5.1.cmml" xref="S4.SS4.p1.6.m6.4.5.1"></eq><ci id="S4.SS4.p1.6.m6.4.5.2.cmml" xref="S4.SS4.p1.6.m6.4.5.2">𝑘</ci><list id="S4.SS4.p1.6.m6.4.5.3.1.cmml" xref="S4.SS4.p1.6.m6.4.5.3.2"><cn id="S4.SS4.p1.6.m6.1.1.cmml" type="integer" xref="S4.SS4.p1.6.m6.1.1">0</cn><cn id="S4.SS4.p1.6.m6.2.2.cmml" type="integer" xref="S4.SS4.p1.6.m6.2.2">1</cn><ci id="S4.SS4.p1.6.m6.3.3.cmml" xref="S4.SS4.p1.6.m6.3.3">⋯</ci><ci id="S4.SS4.p1.6.m6.4.4.cmml" xref="S4.SS4.p1.6.m6.4.4">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m6.4c">k=0,1,\cdots,K</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.6.m6.4d">italic_k = 0 , 1 , ⋯ , italic_K</annotation></semantics></math> on the device side.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.1 </span>Training with Generic Environment</h4>
<div class="ltx_para" id="S4.SS4.SSS1.p1">
<p class="ltx_p" id="S4.SS4.SSS1.p1.1">Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#alg1" title="Algorithm 1 ‣ 4.4.2 Training with Offline Data ‣ 4.4 Mechanism ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> shows the training mechanism of our mccHRL. Considering the listwise mechanism, We assign the Low-Level actor an on-policy strategy and the High-Level critic an off-policy strategy. Similar to DDPG, we also have a target critic and a target actor.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.2 </span>Training with Offline Data</h4>
<div class="ltx_para" id="S4.SS4.SSS2.p1">
<p class="ltx_p" id="S4.SS4.SSS2.p1.1">Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#alg1" title="Algorithm 1 ‣ 4.4.2 Training with Offline Data ‣ 4.4 Mechanism ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> is an interactive learning method with both cloud and edge environments. Unfortunately, it is often not practical for direct online deployment and learning on large-scale industrial systems, especially for online learning on users’ mobile devices. Therefore, it is of great importance to develop an algorithm that can learn from the offline data, or at least use the offline training as a warmup start. In this paper, we assume offline data can be retrieved and reformulated in the temporal order, with each line in the form of <math alttext="[s^{\text{h}}_{t},a^{\text{h}}_{t},r^{\text{h}}_{t},\{e_{k}\},\{m_{k}\},s^{%
\text{h}}_{t+1},a^{\text{h}}_{t+1}]" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p1.1.m1.7"><semantics id="S4.SS4.SSS2.p1.1.m1.7a"><mrow id="S4.SS4.SSS2.p1.1.m1.7.7.7" xref="S4.SS4.SSS2.p1.1.m1.7.7.8.cmml"><mo id="S4.SS4.SSS2.p1.1.m1.7.7.7.8" stretchy="false" xref="S4.SS4.SSS2.p1.1.m1.7.7.8.cmml">[</mo><msubsup id="S4.SS4.SSS2.p1.1.m1.1.1.1.1" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1.cmml"><mi id="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.2" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.2.cmml">s</mi><mi id="S4.SS4.SSS2.p1.1.m1.1.1.1.1.3" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1.3.cmml">t</mi><mtext id="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.3" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.3a.cmml">h</mtext></msubsup><mo id="S4.SS4.SSS2.p1.1.m1.7.7.7.9" xref="S4.SS4.SSS2.p1.1.m1.7.7.8.cmml">,</mo><msubsup id="S4.SS4.SSS2.p1.1.m1.2.2.2.2" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2.cmml"><mi id="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.2" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.2.cmml">a</mi><mi id="S4.SS4.SSS2.p1.1.m1.2.2.2.2.3" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2.3.cmml">t</mi><mtext id="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.3" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.3a.cmml">h</mtext></msubsup><mo id="S4.SS4.SSS2.p1.1.m1.7.7.7.10" xref="S4.SS4.SSS2.p1.1.m1.7.7.8.cmml">,</mo><msubsup id="S4.SS4.SSS2.p1.1.m1.3.3.3.3" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3.cmml"><mi id="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.2" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.2.cmml">r</mi><mi id="S4.SS4.SSS2.p1.1.m1.3.3.3.3.3" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3.3.cmml">t</mi><mtext id="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.3" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.3a.cmml">h</mtext></msubsup><mo id="S4.SS4.SSS2.p1.1.m1.7.7.7.11" xref="S4.SS4.SSS2.p1.1.m1.7.7.8.cmml">,</mo><mrow id="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1" xref="S4.SS4.SSS2.p1.1.m1.4.4.4.4.2.cmml"><mo id="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.2" stretchy="false" xref="S4.SS4.SSS2.p1.1.m1.4.4.4.4.2.cmml">{</mo><msub id="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1" xref="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1.cmml"><mi id="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1.2" xref="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1.2.cmml">e</mi><mi id="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1.3" xref="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1.3.cmml">k</mi></msub><mo id="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.3" stretchy="false" xref="S4.SS4.SSS2.p1.1.m1.4.4.4.4.2.cmml">}</mo></mrow><mo id="S4.SS4.SSS2.p1.1.m1.7.7.7.12" xref="S4.SS4.SSS2.p1.1.m1.7.7.8.cmml">,</mo><mrow id="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1" xref="S4.SS4.SSS2.p1.1.m1.5.5.5.5.2.cmml"><mo id="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.2" stretchy="false" xref="S4.SS4.SSS2.p1.1.m1.5.5.5.5.2.cmml">{</mo><msub id="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1" xref="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1.cmml"><mi id="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1.2" xref="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1.2.cmml">m</mi><mi id="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1.3" xref="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1.3.cmml">k</mi></msub><mo id="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.3" stretchy="false" xref="S4.SS4.SSS2.p1.1.m1.5.5.5.5.2.cmml">}</mo></mrow><mo id="S4.SS4.SSS2.p1.1.m1.7.7.7.13" xref="S4.SS4.SSS2.p1.1.m1.7.7.8.cmml">,</mo><msubsup id="S4.SS4.SSS2.p1.1.m1.6.6.6.6" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.cmml"><mi id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.2" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.2.cmml">s</mi><mrow id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.cmml"><mi id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.2" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.2.cmml">t</mi><mo id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.1" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.1.cmml">+</mo><mn id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.3" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.3.cmml">1</mn></mrow><mtext id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.3" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.3a.cmml">h</mtext></msubsup><mo id="S4.SS4.SSS2.p1.1.m1.7.7.7.14" xref="S4.SS4.SSS2.p1.1.m1.7.7.8.cmml">,</mo><msubsup id="S4.SS4.SSS2.p1.1.m1.7.7.7.7" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.cmml"><mi id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.2" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.2.cmml">a</mi><mrow id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.cmml"><mi id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.2" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.2.cmml">t</mi><mo id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.1" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.1.cmml">+</mo><mn id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.3" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.3.cmml">1</mn></mrow><mtext id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.3" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.3a.cmml">h</mtext></msubsup><mo id="S4.SS4.SSS2.p1.1.m1.7.7.7.15" stretchy="false" xref="S4.SS4.SSS2.p1.1.m1.7.7.8.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p1.1.m1.7b"><list id="S4.SS4.SSS2.p1.1.m1.7.7.8.cmml" xref="S4.SS4.SSS2.p1.1.m1.7.7.7"><apply id="S4.SS4.SSS2.p1.1.m1.1.1.1.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1">subscript</csymbol><apply id="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1">superscript</csymbol><ci id="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.2">𝑠</ci><ci id="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.3a.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.3"><mtext id="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1.2.3">h</mtext></ci></apply><ci id="S4.SS4.SSS2.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS4.SSS2.p1.1.m1.2.2.2.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.2.2.2.2.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2">subscript</csymbol><apply id="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2">superscript</csymbol><ci id="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.2">𝑎</ci><ci id="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.3a.cmml" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.3"><mtext id="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.3.cmml" mathsize="70%" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2.2.3">h</mtext></ci></apply><ci id="S4.SS4.SSS2.p1.1.m1.2.2.2.2.3.cmml" xref="S4.SS4.SSS2.p1.1.m1.2.2.2.2.3">𝑡</ci></apply><apply id="S4.SS4.SSS2.p1.1.m1.3.3.3.3.cmml" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.3.3.3.3.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3">subscript</csymbol><apply id="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3">superscript</csymbol><ci id="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.2">𝑟</ci><ci id="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.3a.cmml" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.3"><mtext id="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.3.cmml" mathsize="70%" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3.2.3">h</mtext></ci></apply><ci id="S4.SS4.SSS2.p1.1.m1.3.3.3.3.3.cmml" xref="S4.SS4.SSS2.p1.1.m1.3.3.3.3.3">𝑡</ci></apply><set id="S4.SS4.SSS2.p1.1.m1.4.4.4.4.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1"><apply id="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1.2">𝑒</ci><ci id="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1.3.cmml" xref="S4.SS4.SSS2.p1.1.m1.4.4.4.4.1.1.3">𝑘</ci></apply></set><set id="S4.SS4.SSS2.p1.1.m1.5.5.5.5.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1"><apply id="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1.2">𝑚</ci><ci id="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1.3.cmml" xref="S4.SS4.SSS2.p1.1.m1.5.5.5.5.1.1.3">𝑘</ci></apply></set><apply id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.cmml" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6">subscript</csymbol><apply id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6">superscript</csymbol><ci id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.2">𝑠</ci><ci id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.3a.cmml" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.3"><mtext id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.3.cmml" mathsize="70%" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.2.3">h</mtext></ci></apply><apply id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.cmml" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3"><plus id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.1"></plus><ci id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.2">𝑡</ci><cn id="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.3.cmml" type="integer" xref="S4.SS4.SSS2.p1.1.m1.6.6.6.6.3.3">1</cn></apply></apply><apply id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.cmml" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7">subscript</csymbol><apply id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7">superscript</csymbol><ci id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.2">𝑎</ci><ci id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.3a.cmml" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.3"><mtext id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.3.cmml" mathsize="70%" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.2.3">h</mtext></ci></apply><apply id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.cmml" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3"><plus id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.1"></plus><ci id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.2.cmml" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.2">𝑡</ci><cn id="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.3.cmml" type="integer" xref="S4.SS4.SSS2.p1.1.m1.7.7.7.7.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p1.1.m1.7c">[s^{\text{h}}_{t},a^{\text{h}}_{t},r^{\text{h}}_{t},\{e_{k}\},\{m_{k}\},s^{%
\text{h}}_{t+1},a^{\text{h}}_{t+1}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p1.1.m1.7d">[ italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , { italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } , { italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } , italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ]</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS4.SSS2.p2">
<p class="ltx_p" id="S4.SS4.SSS2.p2.6">RL study on such data calls for a special research direction called offline RL, or batch-constrained RL, which learns an optimal policy from a fixed dataset by implementing the out-of-distribution corrections for off-policy RL <cite class="ltx_cite ltx_citemacro_cite">Levine et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib14" title="">2020</a>)</cite>. Since our HRA has an off-policy strategy, we could employ similar ideas to train the HRA critic offline. Here we refer to the conservative Q-learning (CQL) <cite class="ltx_cite ltx_citemacro_cite">Kumar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib13" title="">2020</a>)</cite>, to have a regularizer in the TD loss of the Q-function:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S7.EGx3">
<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{\text{off}}(s,a,\pi_{\theta})=" class="ltx_Math" display="inline" id="S4.Ex2.m1.3"><semantics id="S4.Ex2.m1.3a"><mrow id="S4.Ex2.m1.3.3" xref="S4.Ex2.m1.3.3.cmml"><mrow id="S4.Ex2.m1.3.3.1" xref="S4.Ex2.m1.3.3.1.cmml"><msub id="S4.Ex2.m1.3.3.1.3" xref="S4.Ex2.m1.3.3.1.3.cmml"><mi id="S4.Ex2.m1.3.3.1.3.2" xref="S4.Ex2.m1.3.3.1.3.2.cmml">L</mi><mtext id="S4.Ex2.m1.3.3.1.3.3" xref="S4.Ex2.m1.3.3.1.3.3a.cmml">off</mtext></msub><mo id="S4.Ex2.m1.3.3.1.2" xref="S4.Ex2.m1.3.3.1.2.cmml">⁢</mo><mrow id="S4.Ex2.m1.3.3.1.1.1" xref="S4.Ex2.m1.3.3.1.1.2.cmml"><mo id="S4.Ex2.m1.3.3.1.1.1.2" stretchy="false" xref="S4.Ex2.m1.3.3.1.1.2.cmml">(</mo><mi id="S4.Ex2.m1.1.1" xref="S4.Ex2.m1.1.1.cmml">s</mi><mo id="S4.Ex2.m1.3.3.1.1.1.3" xref="S4.Ex2.m1.3.3.1.1.2.cmml">,</mo><mi id="S4.Ex2.m1.2.2" xref="S4.Ex2.m1.2.2.cmml">a</mi><mo id="S4.Ex2.m1.3.3.1.1.1.4" xref="S4.Ex2.m1.3.3.1.1.2.cmml">,</mo><msub id="S4.Ex2.m1.3.3.1.1.1.1" xref="S4.Ex2.m1.3.3.1.1.1.1.cmml"><mi id="S4.Ex2.m1.3.3.1.1.1.1.2" xref="S4.Ex2.m1.3.3.1.1.1.1.2.cmml">π</mi><mi id="S4.Ex2.m1.3.3.1.1.1.1.3" xref="S4.Ex2.m1.3.3.1.1.1.1.3.cmml">θ</mi></msub><mo id="S4.Ex2.m1.3.3.1.1.1.5" stretchy="false" xref="S4.Ex2.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.3.3.2" xref="S4.Ex2.m1.3.3.2.cmml">=</mo><mi id="S4.Ex2.m1.3.3.3" xref="S4.Ex2.m1.3.3.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.3b"><apply id="S4.Ex2.m1.3.3.cmml" xref="S4.Ex2.m1.3.3"><eq id="S4.Ex2.m1.3.3.2.cmml" xref="S4.Ex2.m1.3.3.2"></eq><apply id="S4.Ex2.m1.3.3.1.cmml" xref="S4.Ex2.m1.3.3.1"><times id="S4.Ex2.m1.3.3.1.2.cmml" xref="S4.Ex2.m1.3.3.1.2"></times><apply id="S4.Ex2.m1.3.3.1.3.cmml" xref="S4.Ex2.m1.3.3.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.3.1.cmml" xref="S4.Ex2.m1.3.3.1.3">subscript</csymbol><ci id="S4.Ex2.m1.3.3.1.3.2.cmml" xref="S4.Ex2.m1.3.3.1.3.2">𝐿</ci><ci id="S4.Ex2.m1.3.3.1.3.3a.cmml" xref="S4.Ex2.m1.3.3.1.3.3"><mtext id="S4.Ex2.m1.3.3.1.3.3.cmml" mathsize="70%" xref="S4.Ex2.m1.3.3.1.3.3">off</mtext></ci></apply><vector id="S4.Ex2.m1.3.3.1.1.2.cmml" xref="S4.Ex2.m1.3.3.1.1.1"><ci id="S4.Ex2.m1.1.1.cmml" xref="S4.Ex2.m1.1.1">𝑠</ci><ci id="S4.Ex2.m1.2.2.cmml" xref="S4.Ex2.m1.2.2">𝑎</ci><apply id="S4.Ex2.m1.3.3.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S4.Ex2.m1.3.3.1.1.1.1.2.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.2">𝜋</ci><ci id="S4.Ex2.m1.3.3.1.1.1.1.3.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.3">𝜃</ci></apply></vector></apply><csymbol cd="latexml" id="S4.Ex2.m1.3.3.3.cmml" xref="S4.Ex2.m1.3.3.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.3c">\displaystyle L_{\text{off}}(s,a,\pi_{\theta})=</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m1.3d">italic_L start_POSTSUBSCRIPT off end_POSTSUBSCRIPT ( italic_s , italic_a , italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathrm{E}_{a\sim\pi_{\theta}}[Q_{w}(s,a)\frac{\exp{Q_{w}(s,a)}}{%
Z}]" class="ltx_Math" display="inline" id="S4.Ex2.m2.5"><semantics id="S4.Ex2.m2.5a"><mrow id="S4.Ex2.m2.5.5" xref="S4.Ex2.m2.5.5.cmml"><msub id="S4.Ex2.m2.5.5.3" xref="S4.Ex2.m2.5.5.3.cmml"><mi id="S4.Ex2.m2.5.5.3.2" mathvariant="normal" xref="S4.Ex2.m2.5.5.3.2.cmml">E</mi><mrow id="S4.Ex2.m2.5.5.3.3" xref="S4.Ex2.m2.5.5.3.3.cmml"><mi id="S4.Ex2.m2.5.5.3.3.2" xref="S4.Ex2.m2.5.5.3.3.2.cmml">a</mi><mo id="S4.Ex2.m2.5.5.3.3.1" xref="S4.Ex2.m2.5.5.3.3.1.cmml">∼</mo><msub id="S4.Ex2.m2.5.5.3.3.3" xref="S4.Ex2.m2.5.5.3.3.3.cmml"><mi id="S4.Ex2.m2.5.5.3.3.3.2" xref="S4.Ex2.m2.5.5.3.3.3.2.cmml">π</mi><mi id="S4.Ex2.m2.5.5.3.3.3.3" xref="S4.Ex2.m2.5.5.3.3.3.3.cmml">θ</mi></msub></mrow></msub><mo id="S4.Ex2.m2.5.5.2" xref="S4.Ex2.m2.5.5.2.cmml">⁢</mo><mrow id="S4.Ex2.m2.5.5.1.1" xref="S4.Ex2.m2.5.5.1.2.cmml"><mo id="S4.Ex2.m2.5.5.1.1.2" stretchy="false" xref="S4.Ex2.m2.5.5.1.2.1.cmml">[</mo><mrow id="S4.Ex2.m2.5.5.1.1.1" xref="S4.Ex2.m2.5.5.1.1.1.cmml"><msub id="S4.Ex2.m2.5.5.1.1.1.2" xref="S4.Ex2.m2.5.5.1.1.1.2.cmml"><mi id="S4.Ex2.m2.5.5.1.1.1.2.2" xref="S4.Ex2.m2.5.5.1.1.1.2.2.cmml">Q</mi><mi id="S4.Ex2.m2.5.5.1.1.1.2.3" xref="S4.Ex2.m2.5.5.1.1.1.2.3.cmml">w</mi></msub><mo id="S4.Ex2.m2.5.5.1.1.1.1" xref="S4.Ex2.m2.5.5.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex2.m2.5.5.1.1.1.3.2" xref="S4.Ex2.m2.5.5.1.1.1.3.1.cmml"><mo id="S4.Ex2.m2.5.5.1.1.1.3.2.1" stretchy="false" xref="S4.Ex2.m2.5.5.1.1.1.3.1.cmml">(</mo><mi id="S4.Ex2.m2.3.3" xref="S4.Ex2.m2.3.3.cmml">s</mi><mo id="S4.Ex2.m2.5.5.1.1.1.3.2.2" xref="S4.Ex2.m2.5.5.1.1.1.3.1.cmml">,</mo><mi id="S4.Ex2.m2.4.4" xref="S4.Ex2.m2.4.4.cmml">a</mi><mo id="S4.Ex2.m2.5.5.1.1.1.3.2.3" stretchy="false" xref="S4.Ex2.m2.5.5.1.1.1.3.1.cmml">)</mo></mrow><mo id="S4.Ex2.m2.5.5.1.1.1.1a" xref="S4.Ex2.m2.5.5.1.1.1.1.cmml">⁢</mo><mstyle displaystyle="true" id="S4.Ex2.m2.2.2" xref="S4.Ex2.m2.2.2.cmml"><mfrac id="S4.Ex2.m2.2.2a" xref="S4.Ex2.m2.2.2.cmml"><mrow id="S4.Ex2.m2.2.2.2" xref="S4.Ex2.m2.2.2.2.cmml"><mrow id="S4.Ex2.m2.2.2.2.4" xref="S4.Ex2.m2.2.2.2.4.cmml"><mi id="S4.Ex2.m2.2.2.2.4.1" xref="S4.Ex2.m2.2.2.2.4.1.cmml">exp</mi><mo id="S4.Ex2.m2.2.2.2.4a" lspace="0.167em" xref="S4.Ex2.m2.2.2.2.4.cmml">⁡</mo><msub id="S4.Ex2.m2.2.2.2.4.2" xref="S4.Ex2.m2.2.2.2.4.2.cmml"><mi id="S4.Ex2.m2.2.2.2.4.2.2" xref="S4.Ex2.m2.2.2.2.4.2.2.cmml">Q</mi><mi id="S4.Ex2.m2.2.2.2.4.2.3" xref="S4.Ex2.m2.2.2.2.4.2.3.cmml">w</mi></msub></mrow><mo id="S4.Ex2.m2.2.2.2.3" xref="S4.Ex2.m2.2.2.2.3.cmml">⁢</mo><mrow id="S4.Ex2.m2.2.2.2.5.2" xref="S4.Ex2.m2.2.2.2.5.1.cmml"><mo id="S4.Ex2.m2.2.2.2.5.2.1" stretchy="false" xref="S4.Ex2.m2.2.2.2.5.1.cmml">(</mo><mi id="S4.Ex2.m2.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.cmml">s</mi><mo id="S4.Ex2.m2.2.2.2.5.2.2" xref="S4.Ex2.m2.2.2.2.5.1.cmml">,</mo><mi id="S4.Ex2.m2.2.2.2.2" xref="S4.Ex2.m2.2.2.2.2.cmml">a</mi><mo id="S4.Ex2.m2.2.2.2.5.2.3" stretchy="false" xref="S4.Ex2.m2.2.2.2.5.1.cmml">)</mo></mrow></mrow><mi id="S4.Ex2.m2.2.2.4" xref="S4.Ex2.m2.2.2.4.cmml">Z</mi></mfrac></mstyle></mrow><mo id="S4.Ex2.m2.5.5.1.1.3" stretchy="false" xref="S4.Ex2.m2.5.5.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m2.5b"><apply id="S4.Ex2.m2.5.5.cmml" xref="S4.Ex2.m2.5.5"><times id="S4.Ex2.m2.5.5.2.cmml" xref="S4.Ex2.m2.5.5.2"></times><apply id="S4.Ex2.m2.5.5.3.cmml" xref="S4.Ex2.m2.5.5.3"><csymbol cd="ambiguous" id="S4.Ex2.m2.5.5.3.1.cmml" xref="S4.Ex2.m2.5.5.3">subscript</csymbol><ci id="S4.Ex2.m2.5.5.3.2.cmml" xref="S4.Ex2.m2.5.5.3.2">E</ci><apply id="S4.Ex2.m2.5.5.3.3.cmml" xref="S4.Ex2.m2.5.5.3.3"><csymbol cd="latexml" id="S4.Ex2.m2.5.5.3.3.1.cmml" xref="S4.Ex2.m2.5.5.3.3.1">similar-to</csymbol><ci id="S4.Ex2.m2.5.5.3.3.2.cmml" xref="S4.Ex2.m2.5.5.3.3.2">𝑎</ci><apply id="S4.Ex2.m2.5.5.3.3.3.cmml" xref="S4.Ex2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S4.Ex2.m2.5.5.3.3.3.1.cmml" xref="S4.Ex2.m2.5.5.3.3.3">subscript</csymbol><ci id="S4.Ex2.m2.5.5.3.3.3.2.cmml" xref="S4.Ex2.m2.5.5.3.3.3.2">𝜋</ci><ci id="S4.Ex2.m2.5.5.3.3.3.3.cmml" xref="S4.Ex2.m2.5.5.3.3.3.3">𝜃</ci></apply></apply></apply><apply id="S4.Ex2.m2.5.5.1.2.cmml" xref="S4.Ex2.m2.5.5.1.1"><csymbol cd="latexml" id="S4.Ex2.m2.5.5.1.2.1.cmml" xref="S4.Ex2.m2.5.5.1.1.2">delimited-[]</csymbol><apply id="S4.Ex2.m2.5.5.1.1.1.cmml" xref="S4.Ex2.m2.5.5.1.1.1"><times id="S4.Ex2.m2.5.5.1.1.1.1.cmml" xref="S4.Ex2.m2.5.5.1.1.1.1"></times><apply id="S4.Ex2.m2.5.5.1.1.1.2.cmml" xref="S4.Ex2.m2.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m2.5.5.1.1.1.2.1.cmml" xref="S4.Ex2.m2.5.5.1.1.1.2">subscript</csymbol><ci id="S4.Ex2.m2.5.5.1.1.1.2.2.cmml" xref="S4.Ex2.m2.5.5.1.1.1.2.2">𝑄</ci><ci id="S4.Ex2.m2.5.5.1.1.1.2.3.cmml" xref="S4.Ex2.m2.5.5.1.1.1.2.3">𝑤</ci></apply><interval closure="open" id="S4.Ex2.m2.5.5.1.1.1.3.1.cmml" xref="S4.Ex2.m2.5.5.1.1.1.3.2"><ci id="S4.Ex2.m2.3.3.cmml" xref="S4.Ex2.m2.3.3">𝑠</ci><ci id="S4.Ex2.m2.4.4.cmml" xref="S4.Ex2.m2.4.4">𝑎</ci></interval><apply id="S4.Ex2.m2.2.2.cmml" xref="S4.Ex2.m2.2.2"><divide id="S4.Ex2.m2.2.2.3.cmml" xref="S4.Ex2.m2.2.2"></divide><apply id="S4.Ex2.m2.2.2.2.cmml" xref="S4.Ex2.m2.2.2.2"><times id="S4.Ex2.m2.2.2.2.3.cmml" xref="S4.Ex2.m2.2.2.2.3"></times><apply id="S4.Ex2.m2.2.2.2.4.cmml" xref="S4.Ex2.m2.2.2.2.4"><exp id="S4.Ex2.m2.2.2.2.4.1.cmml" xref="S4.Ex2.m2.2.2.2.4.1"></exp><apply id="S4.Ex2.m2.2.2.2.4.2.cmml" xref="S4.Ex2.m2.2.2.2.4.2"><csymbol cd="ambiguous" id="S4.Ex2.m2.2.2.2.4.2.1.cmml" xref="S4.Ex2.m2.2.2.2.4.2">subscript</csymbol><ci id="S4.Ex2.m2.2.2.2.4.2.2.cmml" xref="S4.Ex2.m2.2.2.2.4.2.2">𝑄</ci><ci id="S4.Ex2.m2.2.2.2.4.2.3.cmml" xref="S4.Ex2.m2.2.2.2.4.2.3">𝑤</ci></apply></apply><interval closure="open" id="S4.Ex2.m2.2.2.2.5.1.cmml" xref="S4.Ex2.m2.2.2.2.5.2"><ci id="S4.Ex2.m2.1.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1.1">𝑠</ci><ci id="S4.Ex2.m2.2.2.2.2.cmml" xref="S4.Ex2.m2.2.2.2.2">𝑎</ci></interval></apply><ci id="S4.Ex2.m2.2.2.4.cmml" xref="S4.Ex2.m2.2.2.4">𝑍</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m2.5c">\displaystyle\mathrm{E}_{a\sim\pi_{\theta}}[Q_{w}(s,a)\frac{\exp{Q_{w}(s,a)}}{%
Z}]</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m2.5d">roman_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_s , italic_a ) divide start_ARG roman_exp italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_s , italic_a ) end_ARG start_ARG italic_Z end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle-\mathrm{E}_{a\sim\pi_{\beta}}Q_{w}(s,a)" class="ltx_Math" display="inline" id="S4.E11.m1.2"><semantics id="S4.E11.m1.2a"><mrow id="S4.E11.m1.2.3" xref="S4.E11.m1.2.3.cmml"><mo id="S4.E11.m1.2.3a" xref="S4.E11.m1.2.3.cmml">−</mo><mrow id="S4.E11.m1.2.3.2" xref="S4.E11.m1.2.3.2.cmml"><msub id="S4.E11.m1.2.3.2.2" xref="S4.E11.m1.2.3.2.2.cmml"><mi id="S4.E11.m1.2.3.2.2.2" mathvariant="normal" xref="S4.E11.m1.2.3.2.2.2.cmml">E</mi><mrow id="S4.E11.m1.2.3.2.2.3" xref="S4.E11.m1.2.3.2.2.3.cmml"><mi id="S4.E11.m1.2.3.2.2.3.2" xref="S4.E11.m1.2.3.2.2.3.2.cmml">a</mi><mo id="S4.E11.m1.2.3.2.2.3.1" xref="S4.E11.m1.2.3.2.2.3.1.cmml">∼</mo><msub id="S4.E11.m1.2.3.2.2.3.3" xref="S4.E11.m1.2.3.2.2.3.3.cmml"><mi id="S4.E11.m1.2.3.2.2.3.3.2" xref="S4.E11.m1.2.3.2.2.3.3.2.cmml">π</mi><mi id="S4.E11.m1.2.3.2.2.3.3.3" xref="S4.E11.m1.2.3.2.2.3.3.3.cmml">β</mi></msub></mrow></msub><mo id="S4.E11.m1.2.3.2.1" xref="S4.E11.m1.2.3.2.1.cmml">⁢</mo><msub id="S4.E11.m1.2.3.2.3" xref="S4.E11.m1.2.3.2.3.cmml"><mi id="S4.E11.m1.2.3.2.3.2" xref="S4.E11.m1.2.3.2.3.2.cmml">Q</mi><mi id="S4.E11.m1.2.3.2.3.3" xref="S4.E11.m1.2.3.2.3.3.cmml">w</mi></msub><mo id="S4.E11.m1.2.3.2.1a" xref="S4.E11.m1.2.3.2.1.cmml">⁢</mo><mrow id="S4.E11.m1.2.3.2.4.2" xref="S4.E11.m1.2.3.2.4.1.cmml"><mo id="S4.E11.m1.2.3.2.4.2.1" stretchy="false" xref="S4.E11.m1.2.3.2.4.1.cmml">(</mo><mi id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml">s</mi><mo id="S4.E11.m1.2.3.2.4.2.2" xref="S4.E11.m1.2.3.2.4.1.cmml">,</mo><mi id="S4.E11.m1.2.2" xref="S4.E11.m1.2.2.cmml">a</mi><mo id="S4.E11.m1.2.3.2.4.2.3" stretchy="false" xref="S4.E11.m1.2.3.2.4.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.2b"><apply id="S4.E11.m1.2.3.cmml" xref="S4.E11.m1.2.3"><minus id="S4.E11.m1.2.3.1.cmml" xref="S4.E11.m1.2.3"></minus><apply id="S4.E11.m1.2.3.2.cmml" xref="S4.E11.m1.2.3.2"><times id="S4.E11.m1.2.3.2.1.cmml" xref="S4.E11.m1.2.3.2.1"></times><apply id="S4.E11.m1.2.3.2.2.cmml" xref="S4.E11.m1.2.3.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.3.2.2.1.cmml" xref="S4.E11.m1.2.3.2.2">subscript</csymbol><ci id="S4.E11.m1.2.3.2.2.2.cmml" xref="S4.E11.m1.2.3.2.2.2">E</ci><apply id="S4.E11.m1.2.3.2.2.3.cmml" xref="S4.E11.m1.2.3.2.2.3"><csymbol cd="latexml" id="S4.E11.m1.2.3.2.2.3.1.cmml" xref="S4.E11.m1.2.3.2.2.3.1">similar-to</csymbol><ci id="S4.E11.m1.2.3.2.2.3.2.cmml" xref="S4.E11.m1.2.3.2.2.3.2">𝑎</ci><apply id="S4.E11.m1.2.3.2.2.3.3.cmml" xref="S4.E11.m1.2.3.2.2.3.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.3.2.2.3.3.1.cmml" xref="S4.E11.m1.2.3.2.2.3.3">subscript</csymbol><ci id="S4.E11.m1.2.3.2.2.3.3.2.cmml" xref="S4.E11.m1.2.3.2.2.3.3.2">𝜋</ci><ci id="S4.E11.m1.2.3.2.2.3.3.3.cmml" xref="S4.E11.m1.2.3.2.2.3.3.3">𝛽</ci></apply></apply></apply><apply id="S4.E11.m1.2.3.2.3.cmml" xref="S4.E11.m1.2.3.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.3.2.3.1.cmml" xref="S4.E11.m1.2.3.2.3">subscript</csymbol><ci id="S4.E11.m1.2.3.2.3.2.cmml" xref="S4.E11.m1.2.3.2.3.2">𝑄</ci><ci id="S4.E11.m1.2.3.2.3.3.cmml" xref="S4.E11.m1.2.3.2.3.3">𝑤</ci></apply><interval closure="open" id="S4.E11.m1.2.3.2.4.1.cmml" xref="S4.E11.m1.2.3.2.4.2"><ci id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.1">𝑠</ci><ci id="S4.E11.m1.2.2.cmml" xref="S4.E11.m1.2.2">𝑎</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.2c">\displaystyle-\mathrm{E}_{a\sim\pi_{\beta}}Q_{w}(s,a)</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.2d">- roman_E start_POSTSUBSCRIPT italic_a ∼ italic_π start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_s , italic_a )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.SSS2.p2.5">in which <math alttext="Z" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p2.1.m1.1"><semantics id="S4.SS4.SSS2.p2.1.m1.1a"><mi id="S4.SS4.SSS2.p2.1.m1.1.1" xref="S4.SS4.SSS2.p2.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.1.m1.1b"><ci id="S4.SS4.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p2.1.m1.1d">italic_Z</annotation></semantics></math> is the normalizing factor of <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p2.2.m2.1"><semantics id="S4.SS4.SSS2.p2.2.m2.1a"><mi id="S4.SS4.SSS2.p2.2.m2.1.1" xref="S4.SS4.SSS2.p2.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.2.m2.1b"><ci id="S4.SS4.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p2.2.m2.1d">italic_Q</annotation></semantics></math> and <math alttext="\pi_{\beta}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p2.3.m3.1"><semantics id="S4.SS4.SSS2.p2.3.m3.1a"><msub id="S4.SS4.SSS2.p2.3.m3.1.1" xref="S4.SS4.SSS2.p2.3.m3.1.1.cmml"><mi id="S4.SS4.SSS2.p2.3.m3.1.1.2" xref="S4.SS4.SSS2.p2.3.m3.1.1.2.cmml">π</mi><mi id="S4.SS4.SSS2.p2.3.m3.1.1.3" xref="S4.SS4.SSS2.p2.3.m3.1.1.3.cmml">β</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.3.m3.1b"><apply id="S4.SS4.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p2.3.m3.1.1.1.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p2.3.m3.1.1.2.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1.2">𝜋</ci><ci id="S4.SS4.SSS2.p2.3.m3.1.1.3.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.3.m3.1c">\pi_{\beta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p2.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT</annotation></semantics></math> is the sampling policy in data. This formulation indicates that we also minimize the soft-maximum of Q at the current solved policy (<math alttext="\pi_{\theta}(a|s)" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p2.4.m4.1"><semantics id="S4.SS4.SSS2.p2.4.m4.1a"><mrow id="S4.SS4.SSS2.p2.4.m4.1.1" xref="S4.SS4.SSS2.p2.4.m4.1.1.cmml"><msub id="S4.SS4.SSS2.p2.4.m4.1.1.3" xref="S4.SS4.SSS2.p2.4.m4.1.1.3.cmml"><mi id="S4.SS4.SSS2.p2.4.m4.1.1.3.2" xref="S4.SS4.SSS2.p2.4.m4.1.1.3.2.cmml">π</mi><mi id="S4.SS4.SSS2.p2.4.m4.1.1.3.3" xref="S4.SS4.SSS2.p2.4.m4.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS4.SSS2.p2.4.m4.1.1.2" xref="S4.SS4.SSS2.p2.4.m4.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.SSS2.p2.4.m4.1.1.1.1" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.cmml"><mo id="S4.SS4.SSS2.p2.4.m4.1.1.1.1.2" stretchy="false" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.2" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.1" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.3" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S4.SS4.SSS2.p2.4.m4.1.1.1.1.3" stretchy="false" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.4.m4.1b"><apply id="S4.SS4.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1"><times id="S4.SS4.SSS2.p2.4.m4.1.1.2.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.2"></times><apply id="S4.SS4.SSS2.p2.4.m4.1.1.3.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p2.4.m4.1.1.3.1.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS4.SSS2.p2.4.m4.1.1.3.2.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.3.2">𝜋</ci><ci id="S4.SS4.SSS2.p2.4.m4.1.1.3.3.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.3.3">𝜃</ci></apply><apply id="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.1"><csymbol cd="latexml" id="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.2">𝑎</ci><ci id="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.4.m4.1c">\pi_{\theta}(a|s)</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p2.4.m4.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_s )</annotation></semantics></math>) w.r.t the sampling policy <math alttext="a^{\text{h}}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p2.5.m5.1"><semantics id="S4.SS4.SSS2.p2.5.m5.1a"><msup id="S4.SS4.SSS2.p2.5.m5.1.1" xref="S4.SS4.SSS2.p2.5.m5.1.1.cmml"><mi id="S4.SS4.SSS2.p2.5.m5.1.1.2" xref="S4.SS4.SSS2.p2.5.m5.1.1.2.cmml">a</mi><mtext id="S4.SS4.SSS2.p2.5.m5.1.1.3" xref="S4.SS4.SSS2.p2.5.m5.1.1.3a.cmml">h</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.5.m5.1b"><apply id="S4.SS4.SSS2.p2.5.m5.1.1.cmml" xref="S4.SS4.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p2.5.m5.1.1.1.cmml" xref="S4.SS4.SSS2.p2.5.m5.1.1">superscript</csymbol><ci id="S4.SS4.SSS2.p2.5.m5.1.1.2.cmml" xref="S4.SS4.SSS2.p2.5.m5.1.1.2">𝑎</ci><ci id="S4.SS4.SSS2.p2.5.m5.1.1.3a.cmml" xref="S4.SS4.SSS2.p2.5.m5.1.1.3"><mtext id="S4.SS4.SSS2.p2.5.m5.1.1.3.cmml" mathsize="70%" xref="S4.SS4.SSS2.p2.5.m5.1.1.3">h</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.5.m5.1c">a^{\text{h}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p2.5.m5.1d">italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT</annotation></semantics></math>, therefore the learning becomes ’conservative’. According to Algorithm 1 in <cite class="ltx_cite ltx_citemacro_cite">Kumar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib13" title="">2020</a>)</cite>, such a trick can be also applied in the actor-critic framework. Here we present our offline version of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#alg1" title="Algorithm 1 ‣ 4.4.2 Training with Offline Data ‣ 4.4 Mechanism ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> which is specified in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#alg2" title="Algorithm 2 ‣ 4.4.2 Training with Offline Data ‣ 4.4 Mechanism ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> The mccHRL Algorithm.</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l1.2">Initialize</span> the clock <math alttext="t\leftarrow 0" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">t</mi><mo id="alg1.l1.m1.1.1.1" stretchy="false" xref="alg1.l1.m1.1.1.1.cmml">←</mo><mn id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">←</ci><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑡</ci><cn id="alg1.l1.m1.1.1.3.cmml" type="integer" xref="alg1.l1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">t\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_t ← 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l2.2">Initialize</span> parameters <math alttext="w\leftarrow 0" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">w</mi><mo id="alg1.l2.m1.1.1.1" stretchy="false" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑤</ci><cn id="alg1.l2.m1.1.1.3.cmml" type="integer" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">w\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_w ← 0</annotation></semantics></math>,<math alttext="\theta\leftarrow 0" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><mrow id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">θ</mi><mo id="alg1.l2.m2.1.1.1" stretchy="false" xref="alg1.l2.m2.1.1.1.cmml">←</mo><mn id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><ci id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1.1">←</ci><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝜃</ci><cn id="alg1.l2.m2.1.1.3.cmml" type="integer" xref="alg1.l2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\theta\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">italic_θ ← 0</annotation></semantics></math>, and <math alttext="w^{\prime}\leftarrow w" class="ltx_Math" display="inline" id="alg1.l2.m3.1"><semantics id="alg1.l2.m3.1a"><mrow id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><msup id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml"><mi id="alg1.l2.m3.1.1.2.2" xref="alg1.l2.m3.1.1.2.2.cmml">w</mi><mo id="alg1.l2.m3.1.1.2.3" xref="alg1.l2.m3.1.1.2.3.cmml">′</mo></msup><mo id="alg1.l2.m3.1.1.1" stretchy="false" xref="alg1.l2.m3.1.1.1.cmml">←</mo><mi id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><ci id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1.1">←</ci><apply id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.2.1.cmml" xref="alg1.l2.m3.1.1.2">superscript</csymbol><ci id="alg1.l2.m3.1.1.2.2.cmml" xref="alg1.l2.m3.1.1.2.2">𝑤</ci><ci id="alg1.l2.m3.1.1.2.3.cmml" xref="alg1.l2.m3.1.1.2.3">′</ci></apply><ci id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">w^{\prime}\leftarrow w</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m3.1d">italic_w start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_w</annotation></semantics></math>, <math alttext="\theta^{\prime}\leftarrow\theta" class="ltx_Math" display="inline" id="alg1.l2.m4.1"><semantics id="alg1.l2.m4.1a"><mrow id="alg1.l2.m4.1.1" xref="alg1.l2.m4.1.1.cmml"><msup id="alg1.l2.m4.1.1.2" xref="alg1.l2.m4.1.1.2.cmml"><mi id="alg1.l2.m4.1.1.2.2" xref="alg1.l2.m4.1.1.2.2.cmml">θ</mi><mo id="alg1.l2.m4.1.1.2.3" xref="alg1.l2.m4.1.1.2.3.cmml">′</mo></msup><mo id="alg1.l2.m4.1.1.1" stretchy="false" xref="alg1.l2.m4.1.1.1.cmml">←</mo><mi id="alg1.l2.m4.1.1.3" xref="alg1.l2.m4.1.1.3.cmml">θ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m4.1b"><apply id="alg1.l2.m4.1.1.cmml" xref="alg1.l2.m4.1.1"><ci id="alg1.l2.m4.1.1.1.cmml" xref="alg1.l2.m4.1.1.1">←</ci><apply id="alg1.l2.m4.1.1.2.cmml" xref="alg1.l2.m4.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m4.1.1.2.1.cmml" xref="alg1.l2.m4.1.1.2">superscript</csymbol><ci id="alg1.l2.m4.1.1.2.2.cmml" xref="alg1.l2.m4.1.1.2.2">𝜃</ci><ci id="alg1.l2.m4.1.1.2.3.cmml" xref="alg1.l2.m4.1.1.2.3">′</ci></apply><ci id="alg1.l2.m4.1.1.3.cmml" xref="alg1.l2.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m4.1c">\theta^{\prime}\leftarrow\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m4.1d">italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_θ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l3.2">Initialize</span> all users’ histories <math alttext="\mathbf{l}=\{\}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">𝐥</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mrow id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.cmml"><mo id="alg1.l3.m1.1.1.3.2.1" stretchy="false" xref="alg1.l3.m1.1.1.3.1.cmml">{</mo><mo id="alg1.l3.m1.1.1.3.2.2" stretchy="false" xref="alg1.l3.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝐥</ci><list id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathbf{l}=\{\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">bold_l = { }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l4.2">Initialize</span> the on-cloud replay memory buffer <math alttext="\mathscr{R}=\{\}" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi class="ltx_font_mathscript" id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">ℛ</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mrow id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.cmml"><mo id="alg1.l4.m1.1.1.3.2.1" stretchy="false" xref="alg1.l4.m1.1.1.3.1.cmml">{</mo><mo id="alg1.l4.m1.1.1.3.2.2" stretchy="false" xref="alg1.l4.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">ℛ</ci><list id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\mathscr{R}=\{\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">script_R = { }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l5.2">foreach</span> <span class="ltx_text ltx_font_italic" id="alg1.l5.3">session</span> <span class="ltx_text ltx_font_bold" id="alg1.l5.4">do</span>   // Data Transmission Stage 1, High-Level to Low-Level:

</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>    Observe <math alttext="u_{t}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">u</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑢</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">u_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="c^{o}_{t}" class="ltx_Math" display="inline" id="alg1.l6.m2.1"><semantics id="alg1.l6.m2.1a"><msubsup id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2.2" xref="alg1.l6.m2.1.1.2.2.cmml">c</mi><mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">t</mi><mi id="alg1.l6.m2.1.1.2.3" xref="alg1.l6.m2.1.1.2.3.cmml">o</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">subscript</csymbol><apply id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.2.1.cmml" xref="alg1.l6.m2.1.1">superscript</csymbol><ci id="alg1.l6.m2.1.1.2.2.cmml" xref="alg1.l6.m2.1.1.2.2">𝑐</ci><ci id="alg1.l6.m2.1.1.2.3.cmml" xref="alg1.l6.m2.1.1.2.3">𝑜</ci></apply><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">c^{o}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="s^{\text{h}}_{t}=[u_{t},c^{o}_{t},\mathbf{l}]" class="ltx_Math" display="inline" id="alg1.l6.m3.3"><semantics id="alg1.l6.m3.3a"><mrow id="alg1.l6.m3.3.3" xref="alg1.l6.m3.3.3.cmml"><msubsup id="alg1.l6.m3.3.3.4" xref="alg1.l6.m3.3.3.4.cmml"><mi id="alg1.l6.m3.3.3.4.2.2" xref="alg1.l6.m3.3.3.4.2.2.cmml">s</mi><mi id="alg1.l6.m3.3.3.4.3" xref="alg1.l6.m3.3.3.4.3.cmml">t</mi><mtext id="alg1.l6.m3.3.3.4.2.3" xref="alg1.l6.m3.3.3.4.2.3a.cmml">h</mtext></msubsup><mo id="alg1.l6.m3.3.3.3" xref="alg1.l6.m3.3.3.3.cmml">=</mo><mrow id="alg1.l6.m3.3.3.2.2" xref="alg1.l6.m3.3.3.2.3.cmml"><mo id="alg1.l6.m3.3.3.2.2.3" stretchy="false" xref="alg1.l6.m3.3.3.2.3.cmml">[</mo><msub id="alg1.l6.m3.2.2.1.1.1" xref="alg1.l6.m3.2.2.1.1.1.cmml"><mi id="alg1.l6.m3.2.2.1.1.1.2" xref="alg1.l6.m3.2.2.1.1.1.2.cmml">u</mi><mi id="alg1.l6.m3.2.2.1.1.1.3" xref="alg1.l6.m3.2.2.1.1.1.3.cmml">t</mi></msub><mo id="alg1.l6.m3.3.3.2.2.4" xref="alg1.l6.m3.3.3.2.3.cmml">,</mo><msubsup id="alg1.l6.m3.3.3.2.2.2" xref="alg1.l6.m3.3.3.2.2.2.cmml"><mi id="alg1.l6.m3.3.3.2.2.2.2.2" xref="alg1.l6.m3.3.3.2.2.2.2.2.cmml">c</mi><mi id="alg1.l6.m3.3.3.2.2.2.3" xref="alg1.l6.m3.3.3.2.2.2.3.cmml">t</mi><mi id="alg1.l6.m3.3.3.2.2.2.2.3" xref="alg1.l6.m3.3.3.2.2.2.2.3.cmml">o</mi></msubsup><mo id="alg1.l6.m3.3.3.2.2.5" xref="alg1.l6.m3.3.3.2.3.cmml">,</mo><mi id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml">𝐥</mi><mo id="alg1.l6.m3.3.3.2.2.6" stretchy="false" xref="alg1.l6.m3.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.3b"><apply id="alg1.l6.m3.3.3.cmml" xref="alg1.l6.m3.3.3"><eq id="alg1.l6.m3.3.3.3.cmml" xref="alg1.l6.m3.3.3.3"></eq><apply id="alg1.l6.m3.3.3.4.cmml" xref="alg1.l6.m3.3.3.4"><csymbol cd="ambiguous" id="alg1.l6.m3.3.3.4.1.cmml" xref="alg1.l6.m3.3.3.4">subscript</csymbol><apply id="alg1.l6.m3.3.3.4.2.cmml" xref="alg1.l6.m3.3.3.4"><csymbol cd="ambiguous" id="alg1.l6.m3.3.3.4.2.1.cmml" xref="alg1.l6.m3.3.3.4">superscript</csymbol><ci id="alg1.l6.m3.3.3.4.2.2.cmml" xref="alg1.l6.m3.3.3.4.2.2">𝑠</ci><ci id="alg1.l6.m3.3.3.4.2.3a.cmml" xref="alg1.l6.m3.3.3.4.2.3"><mtext id="alg1.l6.m3.3.3.4.2.3.cmml" mathsize="70%" xref="alg1.l6.m3.3.3.4.2.3">h</mtext></ci></apply><ci id="alg1.l6.m3.3.3.4.3.cmml" xref="alg1.l6.m3.3.3.4.3">𝑡</ci></apply><list id="alg1.l6.m3.3.3.2.3.cmml" xref="alg1.l6.m3.3.3.2.2"><apply id="alg1.l6.m3.2.2.1.1.1.cmml" xref="alg1.l6.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m3.2.2.1.1.1.1.cmml" xref="alg1.l6.m3.2.2.1.1.1">subscript</csymbol><ci id="alg1.l6.m3.2.2.1.1.1.2.cmml" xref="alg1.l6.m3.2.2.1.1.1.2">𝑢</ci><ci id="alg1.l6.m3.2.2.1.1.1.3.cmml" xref="alg1.l6.m3.2.2.1.1.1.3">𝑡</ci></apply><apply id="alg1.l6.m3.3.3.2.2.2.cmml" xref="alg1.l6.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m3.3.3.2.2.2.1.cmml" xref="alg1.l6.m3.3.3.2.2.2">subscript</csymbol><apply id="alg1.l6.m3.3.3.2.2.2.2.cmml" xref="alg1.l6.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m3.3.3.2.2.2.2.1.cmml" xref="alg1.l6.m3.3.3.2.2.2">superscript</csymbol><ci id="alg1.l6.m3.3.3.2.2.2.2.2.cmml" xref="alg1.l6.m3.3.3.2.2.2.2.2">𝑐</ci><ci id="alg1.l6.m3.3.3.2.2.2.2.3.cmml" xref="alg1.l6.m3.3.3.2.2.2.2.3">𝑜</ci></apply><ci id="alg1.l6.m3.3.3.2.2.2.3.cmml" xref="alg1.l6.m3.3.3.2.2.2.3">𝑡</ci></apply><ci id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1">𝐥</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.3c">s^{\text{h}}_{t}=[u_{t},c^{o}_{t},\mathbf{l}]</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m3.3d">italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = [ italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_l ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>    <span class="ltx_text ltx_font_bold" id="alg1.l7.2">Initialize</span> <math alttext="k\leftarrow 0" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">k</mi><mo id="alg1.l7.m1.1.1.1" stretchy="false" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mn id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑘</ci><cn id="alg1.l7.m1.1.1.3.cmml" type="integer" xref="alg1.l7.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">k\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_k ← 0</annotation></semantics></math>, locate the mobile device

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>    Synchronize <math alttext="u_{t}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><msub id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">u</mi><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑢</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">u_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="c^{o}_{t}" class="ltx_Math" display="inline" id="alg1.l8.m2.1"><semantics id="alg1.l8.m2.1a"><msubsup id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mi id="alg1.l8.m2.1.1.2.2" xref="alg1.l8.m2.1.1.2.2.cmml">c</mi><mi id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">t</mi><mi id="alg1.l8.m2.1.1.2.3" xref="alg1.l8.m2.1.1.2.3.cmml">o</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.1.1.1.cmml" xref="alg1.l8.m2.1.1">subscript</csymbol><apply id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.1.1.2.1.cmml" xref="alg1.l8.m2.1.1">superscript</csymbol><ci id="alg1.l8.m2.1.1.2.2.cmml" xref="alg1.l8.m2.1.1.2.2">𝑐</ci><ci id="alg1.l8.m2.1.1.2.3.cmml" xref="alg1.l8.m2.1.1.2.3">𝑜</ci></apply><ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">c^{o}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and candidates <math alttext="e" class="ltx_Math" display="inline" id="alg1.l8.m3.1"><semantics id="alg1.l8.m3.1a"><mi id="alg1.l8.m3.1.1" xref="alg1.l8.m3.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m3.1b"><ci id="alg1.l8.m3.1.1.cmml" xref="alg1.l8.m3.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m3.1c">e</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m3.1d">italic_e</annotation></semantics></math> from cloud 
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>    Synchronize <math alttext="\theta\leftarrow\theta^{\prime}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">θ</mi><mo id="alg1.l9.m1.1.1.1" stretchy="false" xref="alg1.l9.m1.1.1.1.cmml">←</mo><msup id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">θ</mi><mo id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝜃</ci><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">superscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝜃</ci><ci id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\theta\leftarrow\theta^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_θ ← italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> from cloud
  // The Low-Level Training Stage:

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>    <span class="ltx_text ltx_font_bold" id="alg1.l10.2">while</span> <math alttext="k&lt;K" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">k</mi><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">&lt;</mo><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><lt id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></lt><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑘</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">k&lt;K</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_k &lt; italic_K</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l10.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>      <span class="ltx_text ltx_font_bold" id="alg1.l11.2">Initialize</span> the ranked item list <math alttext="\mathbf{e}=\{\}" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">𝐞</mi><mo id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">=</mo><mrow id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.cmml"><mo id="alg1.l11.m1.1.1.3.2.1" stretchy="false" xref="alg1.l11.m1.1.1.3.1.cmml">{</mo><mo id="alg1.l11.m1.1.1.3.2.2" stretchy="false" xref="alg1.l11.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><eq id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"></eq><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝐞</ci><list id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\mathbf{e}=\{\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">bold_e = { }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>      Collect the instant <math alttext="m_{k}" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><msub id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">m</mi><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑚</ci><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">m_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and record <math alttext="s^{\text{l}}_{k}=[u,c^{o},m_{k},\mathbf{e}]" class="ltx_Math" display="inline" id="alg1.l12.m2.4"><semantics id="alg1.l12.m2.4a"><mrow id="alg1.l12.m2.4.4" xref="alg1.l12.m2.4.4.cmml"><msubsup id="alg1.l12.m2.4.4.4" xref="alg1.l12.m2.4.4.4.cmml"><mi id="alg1.l12.m2.4.4.4.2.2" xref="alg1.l12.m2.4.4.4.2.2.cmml">s</mi><mi id="alg1.l12.m2.4.4.4.3" xref="alg1.l12.m2.4.4.4.3.cmml">k</mi><mtext id="alg1.l12.m2.4.4.4.2.3" xref="alg1.l12.m2.4.4.4.2.3a.cmml">l</mtext></msubsup><mo id="alg1.l12.m2.4.4.3" xref="alg1.l12.m2.4.4.3.cmml">=</mo><mrow id="alg1.l12.m2.4.4.2.2" xref="alg1.l12.m2.4.4.2.3.cmml"><mo id="alg1.l12.m2.4.4.2.2.3" stretchy="false" xref="alg1.l12.m2.4.4.2.3.cmml">[</mo><mi id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml">u</mi><mo id="alg1.l12.m2.4.4.2.2.4" xref="alg1.l12.m2.4.4.2.3.cmml">,</mo><msup id="alg1.l12.m2.3.3.1.1.1" xref="alg1.l12.m2.3.3.1.1.1.cmml"><mi id="alg1.l12.m2.3.3.1.1.1.2" xref="alg1.l12.m2.3.3.1.1.1.2.cmml">c</mi><mi id="alg1.l12.m2.3.3.1.1.1.3" xref="alg1.l12.m2.3.3.1.1.1.3.cmml">o</mi></msup><mo id="alg1.l12.m2.4.4.2.2.5" xref="alg1.l12.m2.4.4.2.3.cmml">,</mo><msub id="alg1.l12.m2.4.4.2.2.2" xref="alg1.l12.m2.4.4.2.2.2.cmml"><mi id="alg1.l12.m2.4.4.2.2.2.2" xref="alg1.l12.m2.4.4.2.2.2.2.cmml">m</mi><mi id="alg1.l12.m2.4.4.2.2.2.3" xref="alg1.l12.m2.4.4.2.2.2.3.cmml">k</mi></msub><mo id="alg1.l12.m2.4.4.2.2.6" xref="alg1.l12.m2.4.4.2.3.cmml">,</mo><mi id="alg1.l12.m2.2.2" xref="alg1.l12.m2.2.2.cmml">𝐞</mi><mo id="alg1.l12.m2.4.4.2.2.7" stretchy="false" xref="alg1.l12.m2.4.4.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.4b"><apply id="alg1.l12.m2.4.4.cmml" xref="alg1.l12.m2.4.4"><eq id="alg1.l12.m2.4.4.3.cmml" xref="alg1.l12.m2.4.4.3"></eq><apply id="alg1.l12.m2.4.4.4.cmml" xref="alg1.l12.m2.4.4.4"><csymbol cd="ambiguous" id="alg1.l12.m2.4.4.4.1.cmml" xref="alg1.l12.m2.4.4.4">subscript</csymbol><apply id="alg1.l12.m2.4.4.4.2.cmml" xref="alg1.l12.m2.4.4.4"><csymbol cd="ambiguous" id="alg1.l12.m2.4.4.4.2.1.cmml" xref="alg1.l12.m2.4.4.4">superscript</csymbol><ci id="alg1.l12.m2.4.4.4.2.2.cmml" xref="alg1.l12.m2.4.4.4.2.2">𝑠</ci><ci id="alg1.l12.m2.4.4.4.2.3a.cmml" xref="alg1.l12.m2.4.4.4.2.3"><mtext id="alg1.l12.m2.4.4.4.2.3.cmml" mathsize="70%" xref="alg1.l12.m2.4.4.4.2.3">l</mtext></ci></apply><ci id="alg1.l12.m2.4.4.4.3.cmml" xref="alg1.l12.m2.4.4.4.3">𝑘</ci></apply><list id="alg1.l12.m2.4.4.2.3.cmml" xref="alg1.l12.m2.4.4.2.2"><ci id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1">𝑢</ci><apply id="alg1.l12.m2.3.3.1.1.1.cmml" xref="alg1.l12.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.3.3.1.1.1.1.cmml" xref="alg1.l12.m2.3.3.1.1.1">superscript</csymbol><ci id="alg1.l12.m2.3.3.1.1.1.2.cmml" xref="alg1.l12.m2.3.3.1.1.1.2">𝑐</ci><ci id="alg1.l12.m2.3.3.1.1.1.3.cmml" xref="alg1.l12.m2.3.3.1.1.1.3">𝑜</ci></apply><apply id="alg1.l12.m2.4.4.2.2.2.cmml" xref="alg1.l12.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m2.4.4.2.2.2.1.cmml" xref="alg1.l12.m2.4.4.2.2.2">subscript</csymbol><ci id="alg1.l12.m2.4.4.2.2.2.2.cmml" xref="alg1.l12.m2.4.4.2.2.2.2">𝑚</ci><ci id="alg1.l12.m2.4.4.2.2.2.3.cmml" xref="alg1.l12.m2.4.4.2.2.2.3">𝑘</ci></apply><ci id="alg1.l12.m2.2.2.cmml" xref="alg1.l12.m2.2.2">𝐞</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.4c">s^{\text{l}}_{k}=[u,c^{o},m_{k},\mathbf{e}]</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m2.4d">italic_s start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = [ italic_u , italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT , italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , bold_e ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span>      Get <math alttext="a^{\text{l}}_{k}" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><msubsup id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2.2" xref="alg1.l13.m1.1.1.2.2.cmml">a</mi><mi id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">k</mi><mtext id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3a.cmml">l</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1">subscript</csymbol><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1">superscript</csymbol><ci id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2.2">𝑎</ci><ci id="alg1.l13.m1.1.1.2.3a.cmml" xref="alg1.l13.m1.1.1.2.3"><mtext id="alg1.l13.m1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l13.m1.1.1.2.3">l</mtext></ci></apply><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">a^{\text{l}}_{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_a start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> based on the current policy <math alttext="\pi_{\theta}(a^{\text{l}}_{k}|s^{\text{l}}_{k})" class="ltx_Math" display="inline" id="alg1.l13.m2.1"><semantics id="alg1.l13.m2.1a"><mrow id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml"><msub id="alg1.l13.m2.1.1.3" xref="alg1.l13.m2.1.1.3.cmml"><mi id="alg1.l13.m2.1.1.3.2" xref="alg1.l13.m2.1.1.3.2.cmml">π</mi><mi id="alg1.l13.m2.1.1.3.3" xref="alg1.l13.m2.1.1.3.3.cmml">θ</mi></msub><mo id="alg1.l13.m2.1.1.2" xref="alg1.l13.m2.1.1.2.cmml">⁢</mo><mrow id="alg1.l13.m2.1.1.1.1" xref="alg1.l13.m2.1.1.1.1.1.cmml"><mo id="alg1.l13.m2.1.1.1.1.2" stretchy="false" xref="alg1.l13.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l13.m2.1.1.1.1.1" xref="alg1.l13.m2.1.1.1.1.1.cmml"><msubsup id="alg1.l13.m2.1.1.1.1.1.2" xref="alg1.l13.m2.1.1.1.1.1.2.cmml"><mi id="alg1.l13.m2.1.1.1.1.1.2.2.2" xref="alg1.l13.m2.1.1.1.1.1.2.2.2.cmml">a</mi><mi id="alg1.l13.m2.1.1.1.1.1.2.3" xref="alg1.l13.m2.1.1.1.1.1.2.3.cmml">k</mi><mtext id="alg1.l13.m2.1.1.1.1.1.2.2.3" xref="alg1.l13.m2.1.1.1.1.1.2.2.3a.cmml">l</mtext></msubsup><mo fence="false" id="alg1.l13.m2.1.1.1.1.1.1" xref="alg1.l13.m2.1.1.1.1.1.1.cmml">|</mo><msubsup id="alg1.l13.m2.1.1.1.1.1.3" xref="alg1.l13.m2.1.1.1.1.1.3.cmml"><mi id="alg1.l13.m2.1.1.1.1.1.3.2.2" xref="alg1.l13.m2.1.1.1.1.1.3.2.2.cmml">s</mi><mi id="alg1.l13.m2.1.1.1.1.1.3.3" xref="alg1.l13.m2.1.1.1.1.1.3.3.cmml">k</mi><mtext id="alg1.l13.m2.1.1.1.1.1.3.2.3" xref="alg1.l13.m2.1.1.1.1.1.3.2.3a.cmml">l</mtext></msubsup></mrow><mo id="alg1.l13.m2.1.1.1.1.3" stretchy="false" xref="alg1.l13.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><apply id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1"><times id="alg1.l13.m2.1.1.2.cmml" xref="alg1.l13.m2.1.1.2"></times><apply id="alg1.l13.m2.1.1.3.cmml" xref="alg1.l13.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.3.1.cmml" xref="alg1.l13.m2.1.1.3">subscript</csymbol><ci id="alg1.l13.m2.1.1.3.2.cmml" xref="alg1.l13.m2.1.1.3.2">𝜋</ci><ci id="alg1.l13.m2.1.1.3.3.cmml" xref="alg1.l13.m2.1.1.3.3">𝜃</ci></apply><apply id="alg1.l13.m2.1.1.1.1.1.cmml" xref="alg1.l13.m2.1.1.1.1"><csymbol cd="latexml" id="alg1.l13.m2.1.1.1.1.1.1.cmml" xref="alg1.l13.m2.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l13.m2.1.1.1.1.1.2.cmml" xref="alg1.l13.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.1.1.2.1.cmml" xref="alg1.l13.m2.1.1.1.1.1.2">subscript</csymbol><apply id="alg1.l13.m2.1.1.1.1.1.2.2.cmml" xref="alg1.l13.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.1.1.2.2.1.cmml" xref="alg1.l13.m2.1.1.1.1.1.2">superscript</csymbol><ci id="alg1.l13.m2.1.1.1.1.1.2.2.2.cmml" xref="alg1.l13.m2.1.1.1.1.1.2.2.2">𝑎</ci><ci id="alg1.l13.m2.1.1.1.1.1.2.2.3a.cmml" xref="alg1.l13.m2.1.1.1.1.1.2.2.3"><mtext id="alg1.l13.m2.1.1.1.1.1.2.2.3.cmml" mathsize="70%" xref="alg1.l13.m2.1.1.1.1.1.2.2.3">l</mtext></ci></apply><ci id="alg1.l13.m2.1.1.1.1.1.2.3.cmml" xref="alg1.l13.m2.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l13.m2.1.1.1.1.1.3.cmml" xref="alg1.l13.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.1.1.3.1.cmml" xref="alg1.l13.m2.1.1.1.1.1.3">subscript</csymbol><apply id="alg1.l13.m2.1.1.1.1.1.3.2.cmml" xref="alg1.l13.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.1.1.3.2.1.cmml" xref="alg1.l13.m2.1.1.1.1.1.3">superscript</csymbol><ci id="alg1.l13.m2.1.1.1.1.1.3.2.2.cmml" xref="alg1.l13.m2.1.1.1.1.1.3.2.2">𝑠</ci><ci id="alg1.l13.m2.1.1.1.1.1.3.2.3a.cmml" xref="alg1.l13.m2.1.1.1.1.1.3.2.3"><mtext id="alg1.l13.m2.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="alg1.l13.m2.1.1.1.1.1.3.2.3">l</mtext></ci></apply><ci id="alg1.l13.m2.1.1.1.1.1.3.3.cmml" xref="alg1.l13.m2.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">\pi_{\theta}(a^{\text{l}}_{k}|s^{\text{l}}_{k})</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | italic_s start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span>      Select item <math alttext="\hat{k}" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mover accent="true" id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">k</mi><mo id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">^</ci><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\hat{k}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">over^ start_ARG italic_k end_ARG</annotation></semantics></math> from Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.E10" title="In 4.3 Low-Level Agent ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">10</span></a>) and append <math alttext="\mathbf{e}" class="ltx_Math" display="inline" id="alg1.l14.m2.1"><semantics id="alg1.l14.m2.1a"><mi id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml">𝐞</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><ci id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1">𝐞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">\mathbf{e}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m2.1d">bold_e</annotation></semantics></math> with <math alttext="e_{\hat{k}}" class="ltx_Math" display="inline" id="alg1.l14.m3.1"><semantics id="alg1.l14.m3.1a"><msub id="alg1.l14.m3.1.1" xref="alg1.l14.m3.1.1.cmml"><mi id="alg1.l14.m3.1.1.2" xref="alg1.l14.m3.1.1.2.cmml">e</mi><mover accent="true" id="alg1.l14.m3.1.1.3" xref="alg1.l14.m3.1.1.3.cmml"><mi id="alg1.l14.m3.1.1.3.2" xref="alg1.l14.m3.1.1.3.2.cmml">k</mi><mo id="alg1.l14.m3.1.1.3.1" xref="alg1.l14.m3.1.1.3.1.cmml">^</mo></mover></msub><annotation-xml encoding="MathML-Content" id="alg1.l14.m3.1b"><apply id="alg1.l14.m3.1.1.cmml" xref="alg1.l14.m3.1.1"><csymbol cd="ambiguous" id="alg1.l14.m3.1.1.1.cmml" xref="alg1.l14.m3.1.1">subscript</csymbol><ci id="alg1.l14.m3.1.1.2.cmml" xref="alg1.l14.m3.1.1.2">𝑒</ci><apply id="alg1.l14.m3.1.1.3.cmml" xref="alg1.l14.m3.1.1.3"><ci id="alg1.l14.m3.1.1.3.1.cmml" xref="alg1.l14.m3.1.1.3.1">^</ci><ci id="alg1.l14.m3.1.1.3.2.cmml" xref="alg1.l14.m3.1.1.3.2">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m3.1c">e_{\hat{k}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m3.1d">italic_e start_POSTSUBSCRIPT over^ start_ARG italic_k end_ARG end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span>      Update <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mi id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_θ</annotation></semantics></math> based on DDPG 
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span>    <span class="ltx_text ltx_font_bold" id="alg1.l16.2">end while</span>
  // Data Transmission Stage 2, Low-Level to High-Level:

</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span>    <span class="ltx_text ltx_font_bold" id="alg1.l17.2">With some latency</span>:

</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span>      Update the target actor <math alttext="\theta^{\prime}\leftarrow\tau\theta+(1-\tau)\theta^{\prime}" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><msup id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml"><mi id="alg1.l18.m1.1.1.3.2" xref="alg1.l18.m1.1.1.3.2.cmml">θ</mi><mo id="alg1.l18.m1.1.1.3.3" xref="alg1.l18.m1.1.1.3.3.cmml">′</mo></msup><mo id="alg1.l18.m1.1.1.2" stretchy="false" xref="alg1.l18.m1.1.1.2.cmml">←</mo><mrow id="alg1.l18.m1.1.1.1" xref="alg1.l18.m1.1.1.1.cmml"><mrow id="alg1.l18.m1.1.1.1.3" xref="alg1.l18.m1.1.1.1.3.cmml"><mi id="alg1.l18.m1.1.1.1.3.2" xref="alg1.l18.m1.1.1.1.3.2.cmml">τ</mi><mo id="alg1.l18.m1.1.1.1.3.1" xref="alg1.l18.m1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.1.3.3" xref="alg1.l18.m1.1.1.1.3.3.cmml">θ</mi></mrow><mo id="alg1.l18.m1.1.1.1.2" xref="alg1.l18.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l18.m1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.cmml"><mrow id="alg1.l18.m1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l18.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l18.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.cmml"><mn id="alg1.l18.m1.1.1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l18.m1.1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l18.m1.1.1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="alg1.l18.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l18.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l18.m1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.2.cmml">⁢</mo><msup id="alg1.l18.m1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.3.cmml"><mi id="alg1.l18.m1.1.1.1.1.3.2" xref="alg1.l18.m1.1.1.1.1.3.2.cmml">θ</mi><mo id="alg1.l18.m1.1.1.1.1.3.3" xref="alg1.l18.m1.1.1.1.1.3.3.cmml">′</mo></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><ci id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2">←</ci><apply id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.3">superscript</csymbol><ci id="alg1.l18.m1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.3.2">𝜃</ci><ci id="alg1.l18.m1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.3.3">′</ci></apply><apply id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1"><plus id="alg1.l18.m1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.2"></plus><apply id="alg1.l18.m1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.3"><times id="alg1.l18.m1.1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.1.3.1"></times><ci id="alg1.l18.m1.1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.1.3.2">𝜏</ci><ci id="alg1.l18.m1.1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.1.3.3">𝜃</ci></apply><apply id="alg1.l18.m1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1"><times id="alg1.l18.m1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.2"></times><apply id="alg1.l18.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1"><minus id="alg1.l18.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.1"></minus><cn id="alg1.l18.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg1.l18.m1.1.1.1.1.1.1.1.2">1</cn><ci id="alg1.l18.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1.3">𝜏</ci></apply><apply id="alg1.l18.m1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.1.1.3">superscript</csymbol><ci id="alg1.l18.m1.1.1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.1.1.3.2">𝜃</ci><ci id="alg1.l18.m1.1.1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.1.1.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">\theta^{\prime}\leftarrow\tau\theta+(1-\tau)\theta^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_τ italic_θ + ( 1 - italic_τ ) italic_θ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span>      Collect <math alttext="\mathbf{c}" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><mi id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">𝐜</mi><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><ci id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">𝐜</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\mathbf{c}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">bold_c</annotation></semantics></math>, calculate <math alttext="r^{\text{h}}_{t}" class="ltx_Math" display="inline" id="alg1.l19.m2.1"><semantics id="alg1.l19.m2.1a"><msubsup id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml"><mi id="alg1.l19.m2.1.1.2.2" xref="alg1.l19.m2.1.1.2.2.cmml">r</mi><mi id="alg1.l19.m2.1.1.3" xref="alg1.l19.m2.1.1.3.cmml">t</mi><mtext id="alg1.l19.m2.1.1.2.3" xref="alg1.l19.m2.1.1.2.3a.cmml">h</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><apply id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.cmml" xref="alg1.l19.m2.1.1">subscript</csymbol><apply id="alg1.l19.m2.1.1.2.cmml" xref="alg1.l19.m2.1.1"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.2.1.cmml" xref="alg1.l19.m2.1.1">superscript</csymbol><ci id="alg1.l19.m2.1.1.2.2.cmml" xref="alg1.l19.m2.1.1.2.2">𝑟</ci><ci id="alg1.l19.m2.1.1.2.3a.cmml" xref="alg1.l19.m2.1.1.2.3"><mtext id="alg1.l19.m2.1.1.2.3.cmml" mathsize="70%" xref="alg1.l19.m2.1.1.2.3">h</mtext></ci></apply><ci id="alg1.l19.m2.1.1.3.cmml" xref="alg1.l19.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">r^{\text{h}}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m2.1d">italic_r start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and append <math alttext="\mathbf{l}" class="ltx_Math" display="inline" id="alg1.l19.m3.1"><semantics id="alg1.l19.m3.1a"><mi id="alg1.l19.m3.1.1" xref="alg1.l19.m3.1.1.cmml">𝐥</mi><annotation-xml encoding="MathML-Content" id="alg1.l19.m3.1b"><ci id="alg1.l19.m3.1.1.cmml" xref="alg1.l19.m3.1.1">𝐥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m3.1c">\mathbf{l}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m3.1d">bold_l</annotation></semantics></math> with <math alttext="\mathbf{e}" class="ltx_Math" display="inline" id="alg1.l19.m4.1"><semantics id="alg1.l19.m4.1a"><mi id="alg1.l19.m4.1.1" xref="alg1.l19.m4.1.1.cmml">𝐞</mi><annotation-xml encoding="MathML-Content" id="alg1.l19.m4.1b"><ci id="alg1.l19.m4.1.1.cmml" xref="alg1.l19.m4.1.1">𝐞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m4.1c">\mathbf{e}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m4.1d">bold_e</annotation></semantics></math>. 
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">20:</span></span>      Observe the next HRA state <math alttext="s^{\text{h}}_{t+1}" class="ltx_Math" display="inline" id="alg1.l20.m1.1"><semantics id="alg1.l20.m1.1a"><msubsup id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><mi id="alg1.l20.m1.1.1.2.2" xref="alg1.l20.m1.1.1.2.2.cmml">s</mi><mrow id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml"><mi id="alg1.l20.m1.1.1.3.2" xref="alg1.l20.m1.1.1.3.2.cmml">t</mi><mo id="alg1.l20.m1.1.1.3.1" xref="alg1.l20.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l20.m1.1.1.3.3" xref="alg1.l20.m1.1.1.3.3.cmml">1</mn></mrow><mtext id="alg1.l20.m1.1.1.2.3" xref="alg1.l20.m1.1.1.2.3a.cmml">h</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1">subscript</csymbol><apply id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.2.1.cmml" xref="alg1.l20.m1.1.1">superscript</csymbol><ci id="alg1.l20.m1.1.1.2.2.cmml" xref="alg1.l20.m1.1.1.2.2">𝑠</ci><ci id="alg1.l20.m1.1.1.2.3a.cmml" xref="alg1.l20.m1.1.1.2.3"><mtext id="alg1.l20.m1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l20.m1.1.1.2.3">h</mtext></ci></apply><apply id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3"><plus id="alg1.l20.m1.1.1.3.1.cmml" xref="alg1.l20.m1.1.1.3.1"></plus><ci id="alg1.l20.m1.1.1.3.2.cmml" xref="alg1.l20.m1.1.1.3.2">𝑡</ci><cn id="alg1.l20.m1.1.1.3.3.cmml" type="integer" xref="alg1.l20.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">s^{\text{h}}_{t+1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l20.m1.1d">italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l21.1.1.1" style="font-size:80%;">21:</span></span>      Store transition <math alttext="\mathcal{T}_{t}=(s^{\text{h}}_{t},a^{\text{h}}_{t},r^{\text{h}}_{t},s^{\text{h%
}}_{t+1})" class="ltx_Math" display="inline" id="alg1.l21.m1.4"><semantics id="alg1.l21.m1.4a"><mrow id="alg1.l21.m1.4.4" xref="alg1.l21.m1.4.4.cmml"><msub id="alg1.l21.m1.4.4.6" xref="alg1.l21.m1.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l21.m1.4.4.6.2" xref="alg1.l21.m1.4.4.6.2.cmml">𝒯</mi><mi id="alg1.l21.m1.4.4.6.3" xref="alg1.l21.m1.4.4.6.3.cmml">t</mi></msub><mo id="alg1.l21.m1.4.4.5" xref="alg1.l21.m1.4.4.5.cmml">=</mo><mrow id="alg1.l21.m1.4.4.4.4" xref="alg1.l21.m1.4.4.4.5.cmml"><mo id="alg1.l21.m1.4.4.4.4.5" stretchy="false" xref="alg1.l21.m1.4.4.4.5.cmml">(</mo><msubsup id="alg1.l21.m1.1.1.1.1.1" xref="alg1.l21.m1.1.1.1.1.1.cmml"><mi id="alg1.l21.m1.1.1.1.1.1.2.2" xref="alg1.l21.m1.1.1.1.1.1.2.2.cmml">s</mi><mi id="alg1.l21.m1.1.1.1.1.1.3" xref="alg1.l21.m1.1.1.1.1.1.3.cmml">t</mi><mtext id="alg1.l21.m1.1.1.1.1.1.2.3" xref="alg1.l21.m1.1.1.1.1.1.2.3a.cmml">h</mtext></msubsup><mo id="alg1.l21.m1.4.4.4.4.6" xref="alg1.l21.m1.4.4.4.5.cmml">,</mo><msubsup id="alg1.l21.m1.2.2.2.2.2" xref="alg1.l21.m1.2.2.2.2.2.cmml"><mi id="alg1.l21.m1.2.2.2.2.2.2.2" xref="alg1.l21.m1.2.2.2.2.2.2.2.cmml">a</mi><mi id="alg1.l21.m1.2.2.2.2.2.3" xref="alg1.l21.m1.2.2.2.2.2.3.cmml">t</mi><mtext id="alg1.l21.m1.2.2.2.2.2.2.3" xref="alg1.l21.m1.2.2.2.2.2.2.3a.cmml">h</mtext></msubsup><mo id="alg1.l21.m1.4.4.4.4.7" xref="alg1.l21.m1.4.4.4.5.cmml">,</mo><msubsup id="alg1.l21.m1.3.3.3.3.3" xref="alg1.l21.m1.3.3.3.3.3.cmml"><mi id="alg1.l21.m1.3.3.3.3.3.2.2" xref="alg1.l21.m1.3.3.3.3.3.2.2.cmml">r</mi><mi id="alg1.l21.m1.3.3.3.3.3.3" xref="alg1.l21.m1.3.3.3.3.3.3.cmml">t</mi><mtext id="alg1.l21.m1.3.3.3.3.3.2.3" xref="alg1.l21.m1.3.3.3.3.3.2.3a.cmml">h</mtext></msubsup><mo id="alg1.l21.m1.4.4.4.4.8" xref="alg1.l21.m1.4.4.4.5.cmml">,</mo><msubsup id="alg1.l21.m1.4.4.4.4.4" xref="alg1.l21.m1.4.4.4.4.4.cmml"><mi id="alg1.l21.m1.4.4.4.4.4.2.2" xref="alg1.l21.m1.4.4.4.4.4.2.2.cmml">s</mi><mrow id="alg1.l21.m1.4.4.4.4.4.3" xref="alg1.l21.m1.4.4.4.4.4.3.cmml"><mi id="alg1.l21.m1.4.4.4.4.4.3.2" xref="alg1.l21.m1.4.4.4.4.4.3.2.cmml">t</mi><mo id="alg1.l21.m1.4.4.4.4.4.3.1" xref="alg1.l21.m1.4.4.4.4.4.3.1.cmml">+</mo><mn id="alg1.l21.m1.4.4.4.4.4.3.3" xref="alg1.l21.m1.4.4.4.4.4.3.3.cmml">1</mn></mrow><mtext id="alg1.l21.m1.4.4.4.4.4.2.3" xref="alg1.l21.m1.4.4.4.4.4.2.3a.cmml">h</mtext></msubsup><mo id="alg1.l21.m1.4.4.4.4.9" stretchy="false" xref="alg1.l21.m1.4.4.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.4b"><apply id="alg1.l21.m1.4.4.cmml" xref="alg1.l21.m1.4.4"><eq id="alg1.l21.m1.4.4.5.cmml" xref="alg1.l21.m1.4.4.5"></eq><apply id="alg1.l21.m1.4.4.6.cmml" xref="alg1.l21.m1.4.4.6"><csymbol cd="ambiguous" id="alg1.l21.m1.4.4.6.1.cmml" xref="alg1.l21.m1.4.4.6">subscript</csymbol><ci id="alg1.l21.m1.4.4.6.2.cmml" xref="alg1.l21.m1.4.4.6.2">𝒯</ci><ci id="alg1.l21.m1.4.4.6.3.cmml" xref="alg1.l21.m1.4.4.6.3">𝑡</ci></apply><vector id="alg1.l21.m1.4.4.4.5.cmml" xref="alg1.l21.m1.4.4.4.4"><apply id="alg1.l21.m1.1.1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l21.m1.1.1.1.1.1.2.cmml" xref="alg1.l21.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l21.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l21.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l21.m1.1.1.1.1.1.2.2">𝑠</ci><ci id="alg1.l21.m1.1.1.1.1.1.2.3a.cmml" xref="alg1.l21.m1.1.1.1.1.1.2.3"><mtext id="alg1.l21.m1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="alg1.l21.m1.1.1.1.1.1.2.3">h</mtext></ci></apply><ci id="alg1.l21.m1.1.1.1.1.1.3.cmml" xref="alg1.l21.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l21.m1.2.2.2.2.2.cmml" xref="alg1.l21.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.2.2.2.1.cmml" xref="alg1.l21.m1.2.2.2.2.2">subscript</csymbol><apply id="alg1.l21.m1.2.2.2.2.2.2.cmml" xref="alg1.l21.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l21.m1.2.2.2.2.2">superscript</csymbol><ci id="alg1.l21.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l21.m1.2.2.2.2.2.2.2">𝑎</ci><ci id="alg1.l21.m1.2.2.2.2.2.2.3a.cmml" xref="alg1.l21.m1.2.2.2.2.2.2.3"><mtext id="alg1.l21.m1.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg1.l21.m1.2.2.2.2.2.2.3">h</mtext></ci></apply><ci id="alg1.l21.m1.2.2.2.2.2.3.cmml" xref="alg1.l21.m1.2.2.2.2.2.3">𝑡</ci></apply><apply id="alg1.l21.m1.3.3.3.3.3.cmml" xref="alg1.l21.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l21.m1.3.3.3.3.3.1.cmml" xref="alg1.l21.m1.3.3.3.3.3">subscript</csymbol><apply id="alg1.l21.m1.3.3.3.3.3.2.cmml" xref="alg1.l21.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l21.m1.3.3.3.3.3.2.1.cmml" xref="alg1.l21.m1.3.3.3.3.3">superscript</csymbol><ci id="alg1.l21.m1.3.3.3.3.3.2.2.cmml" xref="alg1.l21.m1.3.3.3.3.3.2.2">𝑟</ci><ci id="alg1.l21.m1.3.3.3.3.3.2.3a.cmml" xref="alg1.l21.m1.3.3.3.3.3.2.3"><mtext id="alg1.l21.m1.3.3.3.3.3.2.3.cmml" mathsize="70%" xref="alg1.l21.m1.3.3.3.3.3.2.3">h</mtext></ci></apply><ci id="alg1.l21.m1.3.3.3.3.3.3.cmml" xref="alg1.l21.m1.3.3.3.3.3.3">𝑡</ci></apply><apply id="alg1.l21.m1.4.4.4.4.4.cmml" xref="alg1.l21.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l21.m1.4.4.4.4.4.1.cmml" xref="alg1.l21.m1.4.4.4.4.4">subscript</csymbol><apply id="alg1.l21.m1.4.4.4.4.4.2.cmml" xref="alg1.l21.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l21.m1.4.4.4.4.4.2.1.cmml" xref="alg1.l21.m1.4.4.4.4.4">superscript</csymbol><ci id="alg1.l21.m1.4.4.4.4.4.2.2.cmml" xref="alg1.l21.m1.4.4.4.4.4.2.2">𝑠</ci><ci id="alg1.l21.m1.4.4.4.4.4.2.3a.cmml" xref="alg1.l21.m1.4.4.4.4.4.2.3"><mtext id="alg1.l21.m1.4.4.4.4.4.2.3.cmml" mathsize="70%" xref="alg1.l21.m1.4.4.4.4.4.2.3">h</mtext></ci></apply><apply id="alg1.l21.m1.4.4.4.4.4.3.cmml" xref="alg1.l21.m1.4.4.4.4.4.3"><plus id="alg1.l21.m1.4.4.4.4.4.3.1.cmml" xref="alg1.l21.m1.4.4.4.4.4.3.1"></plus><ci id="alg1.l21.m1.4.4.4.4.4.3.2.cmml" xref="alg1.l21.m1.4.4.4.4.4.3.2">𝑡</ci><cn id="alg1.l21.m1.4.4.4.4.4.3.3.cmml" type="integer" xref="alg1.l21.m1.4.4.4.4.4.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.4c">\mathcal{T}_{t}=(s^{\text{h}}_{t},a^{\text{h}}_{t},r^{\text{h}}_{t},s^{\text{h%
}}_{t+1})</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.4d">caligraphic_T start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math> in <math alttext="\mathscr{R}" class="ltx_Math" display="inline" id="alg1.l21.m2.1"><semantics id="alg1.l21.m2.1a"><mi class="ltx_font_mathscript" id="alg1.l21.m2.1.1" xref="alg1.l21.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.1b"><ci id="alg1.l21.m2.1.1.cmml" xref="alg1.l21.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.1c">\mathscr{R}</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m2.1d">script_R</annotation></semantics></math>
  // The High-Level Training Stage:

</div>
<div class="ltx_listingline" id="alg1.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l22.1.1.1" style="font-size:80%;">22:</span></span>    <span class="ltx_text ltx_font_bold" id="alg1.l22.2">if</span> <math alttext="\text{size}(\mathscr{R})&gt;N" class="ltx_Math" display="inline" id="alg1.l22.m1.1"><semantics id="alg1.l22.m1.1a"><mrow id="alg1.l22.m1.1.2" xref="alg1.l22.m1.1.2.cmml"><mrow id="alg1.l22.m1.1.2.2" xref="alg1.l22.m1.1.2.2.cmml"><mtext id="alg1.l22.m1.1.2.2.2" xref="alg1.l22.m1.1.2.2.2a.cmml">size</mtext><mo id="alg1.l22.m1.1.2.2.1" xref="alg1.l22.m1.1.2.2.1.cmml">⁢</mo><mrow id="alg1.l22.m1.1.2.2.3.2" xref="alg1.l22.m1.1.2.2.cmml"><mo id="alg1.l22.m1.1.2.2.3.2.1" stretchy="false" xref="alg1.l22.m1.1.2.2.cmml">(</mo><mi class="ltx_font_mathscript" id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml">ℛ</mi><mo id="alg1.l22.m1.1.2.2.3.2.2" stretchy="false" xref="alg1.l22.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="alg1.l22.m1.1.2.1" xref="alg1.l22.m1.1.2.1.cmml">&gt;</mo><mi id="alg1.l22.m1.1.2.3" xref="alg1.l22.m1.1.2.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.2.cmml" xref="alg1.l22.m1.1.2"><gt id="alg1.l22.m1.1.2.1.cmml" xref="alg1.l22.m1.1.2.1"></gt><apply id="alg1.l22.m1.1.2.2.cmml" xref="alg1.l22.m1.1.2.2"><times id="alg1.l22.m1.1.2.2.1.cmml" xref="alg1.l22.m1.1.2.2.1"></times><ci id="alg1.l22.m1.1.2.2.2a.cmml" xref="alg1.l22.m1.1.2.2.2"><mtext id="alg1.l22.m1.1.2.2.2.cmml" xref="alg1.l22.m1.1.2.2.2">size</mtext></ci><ci id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1">ℛ</ci></apply><ci id="alg1.l22.m1.1.2.3.cmml" xref="alg1.l22.m1.1.2.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">\text{size}(\mathscr{R})&gt;N</annotation><annotation encoding="application/x-llamapun" id="alg1.l22.m1.1d">size ( script_R ) &gt; italic_N</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l22.3">then</span>
</div>
<div class="ltx_listingline" id="alg1.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l23.1.1.1" style="font-size:80%;">23:</span></span>      Sample <math alttext="N" class="ltx_Math" display="inline" id="alg1.l23.m1.1"><semantics id="alg1.l23.m1.1a"><mi id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><ci id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m1.1d">italic_N</annotation></semantics></math> transitions <math alttext="\mathcal{T}_{i}" class="ltx_Math" display="inline" id="alg1.l23.m2.1"><semantics id="alg1.l23.m2.1a"><msub id="alg1.l23.m2.1.1" xref="alg1.l23.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l23.m2.1.1.2" xref="alg1.l23.m2.1.1.2.cmml">𝒯</mi><mi id="alg1.l23.m2.1.1.3" xref="alg1.l23.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l23.m2.1b"><apply id="alg1.l23.m2.1.1.cmml" xref="alg1.l23.m2.1.1"><csymbol cd="ambiguous" id="alg1.l23.m2.1.1.1.cmml" xref="alg1.l23.m2.1.1">subscript</csymbol><ci id="alg1.l23.m2.1.1.2.cmml" xref="alg1.l23.m2.1.1.2">𝒯</ci><ci id="alg1.l23.m2.1.1.3.cmml" xref="alg1.l23.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m2.1c">\mathcal{T}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m2.1d">caligraphic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from <math alttext="\mathscr{R}" class="ltx_Math" display="inline" id="alg1.l23.m3.1"><semantics id="alg1.l23.m3.1a"><mi class="ltx_font_mathscript" id="alg1.l23.m3.1.1" xref="alg1.l23.m3.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="alg1.l23.m3.1b"><ci id="alg1.l23.m3.1.1.cmml" xref="alg1.l23.m3.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m3.1c">\mathscr{R}</annotation><annotation encoding="application/x-llamapun" id="alg1.l23.m3.1d">script_R</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l24.1.1.1" style="font-size:80%;">24:</span></span>      <span class="ltx_text ltx_font_bold" id="alg1.l24.2">for</span> <math alttext="i=1,\cdots,N" class="ltx_Math" display="inline" id="alg1.l24.m1.3"><semantics id="alg1.l24.m1.3a"><mrow id="alg1.l24.m1.3.4" xref="alg1.l24.m1.3.4.cmml"><mi id="alg1.l24.m1.3.4.2" xref="alg1.l24.m1.3.4.2.cmml">i</mi><mo id="alg1.l24.m1.3.4.1" xref="alg1.l24.m1.3.4.1.cmml">=</mo><mrow id="alg1.l24.m1.3.4.3.2" xref="alg1.l24.m1.3.4.3.1.cmml"><mn id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml">1</mn><mo id="alg1.l24.m1.3.4.3.2.1" xref="alg1.l24.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l24.m1.2.2" mathvariant="normal" xref="alg1.l24.m1.2.2.cmml">⋯</mi><mo id="alg1.l24.m1.3.4.3.2.2" xref="alg1.l24.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l24.m1.3.3" xref="alg1.l24.m1.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.3b"><apply id="alg1.l24.m1.3.4.cmml" xref="alg1.l24.m1.3.4"><eq id="alg1.l24.m1.3.4.1.cmml" xref="alg1.l24.m1.3.4.1"></eq><ci id="alg1.l24.m1.3.4.2.cmml" xref="alg1.l24.m1.3.4.2">𝑖</ci><list id="alg1.l24.m1.3.4.3.1.cmml" xref="alg1.l24.m1.3.4.3.2"><cn id="alg1.l24.m1.1.1.cmml" type="integer" xref="alg1.l24.m1.1.1">1</cn><ci id="alg1.l24.m1.2.2.cmml" xref="alg1.l24.m1.2.2">⋯</ci><ci id="alg1.l24.m1.3.3.cmml" xref="alg1.l24.m1.3.3">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.3c">i=1,\cdots,N</annotation><annotation encoding="application/x-llamapun" id="alg1.l24.m1.3d">italic_i = 1 , ⋯ , italic_N</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l24.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l25.1.1.1" style="font-size:80%;">25:</span></span>        Update <math alttext="w" class="ltx_Math" display="inline" id="alg1.l25.m1.1"><semantics id="alg1.l25.m1.1a"><mi id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b"><ci id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="alg1.l25.m1.1d">italic_w</annotation></semantics></math> based on DDPG 
</div>
<div class="ltx_listingline" id="alg1.l26">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l26.1.1.1" style="font-size:80%;">26:</span></span>      Update the target critic <math alttext="w^{\prime}\leftarrow\tau w+(1-\tau)w^{\prime}" class="ltx_Math" display="inline" id="alg1.l26.m1.1"><semantics id="alg1.l26.m1.1a"><mrow id="alg1.l26.m1.1.1" xref="alg1.l26.m1.1.1.cmml"><msup id="alg1.l26.m1.1.1.3" xref="alg1.l26.m1.1.1.3.cmml"><mi id="alg1.l26.m1.1.1.3.2" xref="alg1.l26.m1.1.1.3.2.cmml">w</mi><mo id="alg1.l26.m1.1.1.3.3" xref="alg1.l26.m1.1.1.3.3.cmml">′</mo></msup><mo id="alg1.l26.m1.1.1.2" stretchy="false" xref="alg1.l26.m1.1.1.2.cmml">←</mo><mrow id="alg1.l26.m1.1.1.1" xref="alg1.l26.m1.1.1.1.cmml"><mrow id="alg1.l26.m1.1.1.1.3" xref="alg1.l26.m1.1.1.1.3.cmml"><mi id="alg1.l26.m1.1.1.1.3.2" xref="alg1.l26.m1.1.1.1.3.2.cmml">τ</mi><mo id="alg1.l26.m1.1.1.1.3.1" xref="alg1.l26.m1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l26.m1.1.1.1.3.3" xref="alg1.l26.m1.1.1.1.3.3.cmml">w</mi></mrow><mo id="alg1.l26.m1.1.1.1.2" xref="alg1.l26.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l26.m1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.cmml"><mrow id="alg1.l26.m1.1.1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l26.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l26.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l26.m1.1.1.1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.1.1.1.cmml"><mn id="alg1.l26.m1.1.1.1.1.1.1.1.2" xref="alg1.l26.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l26.m1.1.1.1.1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l26.m1.1.1.1.1.1.1.1.3" xref="alg1.l26.m1.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="alg1.l26.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l26.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l26.m1.1.1.1.1.2" xref="alg1.l26.m1.1.1.1.1.2.cmml">⁢</mo><msup id="alg1.l26.m1.1.1.1.1.3" xref="alg1.l26.m1.1.1.1.1.3.cmml"><mi id="alg1.l26.m1.1.1.1.1.3.2" xref="alg1.l26.m1.1.1.1.1.3.2.cmml">w</mi><mo id="alg1.l26.m1.1.1.1.1.3.3" xref="alg1.l26.m1.1.1.1.1.3.3.cmml">′</mo></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.1b"><apply id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1"><ci id="alg1.l26.m1.1.1.2.cmml" xref="alg1.l26.m1.1.1.2">←</ci><apply id="alg1.l26.m1.1.1.3.cmml" xref="alg1.l26.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.3.1.cmml" xref="alg1.l26.m1.1.1.3">superscript</csymbol><ci id="alg1.l26.m1.1.1.3.2.cmml" xref="alg1.l26.m1.1.1.3.2">𝑤</ci><ci id="alg1.l26.m1.1.1.3.3.cmml" xref="alg1.l26.m1.1.1.3.3">′</ci></apply><apply id="alg1.l26.m1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1"><plus id="alg1.l26.m1.1.1.1.2.cmml" xref="alg1.l26.m1.1.1.1.2"></plus><apply id="alg1.l26.m1.1.1.1.3.cmml" xref="alg1.l26.m1.1.1.1.3"><times id="alg1.l26.m1.1.1.1.3.1.cmml" xref="alg1.l26.m1.1.1.1.3.1"></times><ci id="alg1.l26.m1.1.1.1.3.2.cmml" xref="alg1.l26.m1.1.1.1.3.2">𝜏</ci><ci id="alg1.l26.m1.1.1.1.3.3.cmml" xref="alg1.l26.m1.1.1.1.3.3">𝑤</ci></apply><apply id="alg1.l26.m1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1"><times id="alg1.l26.m1.1.1.1.1.2.cmml" xref="alg1.l26.m1.1.1.1.1.2"></times><apply id="alg1.l26.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1.1.1"><minus id="alg1.l26.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.1"></minus><cn id="alg1.l26.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg1.l26.m1.1.1.1.1.1.1.1.2">1</cn><ci id="alg1.l26.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.3">𝜏</ci></apply><apply id="alg1.l26.m1.1.1.1.1.3.cmml" xref="alg1.l26.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.1.3.1.cmml" xref="alg1.l26.m1.1.1.1.1.3">superscript</csymbol><ci id="alg1.l26.m1.1.1.1.1.3.2.cmml" xref="alg1.l26.m1.1.1.1.1.3.2">𝑤</ci><ci id="alg1.l26.m1.1.1.1.1.3.3.cmml" xref="alg1.l26.m1.1.1.1.1.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.1c">w^{\prime}\leftarrow\tau w+(1-\tau)w^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l26.m1.1d">italic_w start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_τ italic_w + ( 1 - italic_τ ) italic_w start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l27">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l27.1.1.1" style="font-size:80%;">27:</span></span>    <span class="ltx_text ltx_font_bold" id="alg1.l27.2">end if</span>
</div>
<div class="ltx_listingline" id="alg1.l28">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l28.1.1.1" style="font-size:80%;">28:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l28.2">end for</span>
</div>
</div>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> The offline mccHRL Algorithm.</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span>  <span class="ltx_text ltx_font_bold" id="alg2.l1.2">Initialize</span> parameters <math alttext="w\leftarrow 0" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mrow id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mi id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml">w</mi><mo id="alg2.l1.m1.1.1.1" stretchy="false" xref="alg2.l1.m1.1.1.1.cmml">←</mo><mn id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><ci id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1">←</ci><ci id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2">𝑤</ci><cn id="alg2.l1.m1.1.1.3.cmml" type="integer" xref="alg2.l1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">w\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">italic_w ← 0</annotation></semantics></math>,<math alttext="\theta\leftarrow 0" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mrow id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml"><mi id="alg2.l1.m2.1.1.2" xref="alg2.l1.m2.1.1.2.cmml">θ</mi><mo id="alg2.l1.m2.1.1.1" stretchy="false" xref="alg2.l1.m2.1.1.1.cmml">←</mo><mn id="alg2.l1.m2.1.1.3" xref="alg2.l1.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><apply id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1"><ci id="alg2.l1.m2.1.1.1.cmml" xref="alg2.l1.m2.1.1.1">←</ci><ci id="alg2.l1.m2.1.1.2.cmml" xref="alg2.l1.m2.1.1.2">𝜃</ci><cn id="alg2.l1.m2.1.1.3.cmml" type="integer" xref="alg2.l1.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">\theta\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">italic_θ ← 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span>  <span class="ltx_text ltx_font_bold" id="alg2.l2.2">Initialize</span> the replay memory buffer <math alttext="\mathscr{R}=\{\}" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi class="ltx_font_mathscript" id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">ℛ</mi><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">=</mo><mrow id="alg2.l2.m1.1.1.3.2" xref="alg2.l2.m1.1.1.cmml"><mo id="alg2.l2.m1.1.1.3.2.1" stretchy="false" xref="alg2.l2.m1.1.1.3.1.cmml">{</mo><mo id="alg2.l2.m1.1.1.3.2.2" stretchy="false" xref="alg2.l2.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><eq id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></eq><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">ℛ</ci><list id="alg2.l2.m1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\mathscr{R}=\{\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">script_R = { }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span>  <span class="ltx_text ltx_font_bold" id="alg2.l3.2">foreach</span> <span class="ltx_text ltx_font_italic" id="alg2.l3.3">line of data</span> <span class="ltx_text ltx_font_bold" id="alg2.l3.4">do</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.1.1.1" style="font-size:80%;">4:</span></span>    Retrieve <math alttext="s^{\text{h}}_{t},a^{\text{h}}_{t},r^{\text{h}}_{t},\{e_{k}\},\{m_{k}\},s^{%
\text{h}}_{t+1},a^{\text{h}}_{t+1}" class="ltx_Math" display="inline" id="alg2.l4.m1.7"><semantics id="alg2.l4.m1.7a"><mrow id="alg2.l4.m1.7.7.7" xref="alg2.l4.m1.7.7.8.cmml"><msubsup id="alg2.l4.m1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.cmml"><mi id="alg2.l4.m1.1.1.1.1.2.2" xref="alg2.l4.m1.1.1.1.1.2.2.cmml">s</mi><mi id="alg2.l4.m1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.3.cmml">t</mi><mtext id="alg2.l4.m1.1.1.1.1.2.3" xref="alg2.l4.m1.1.1.1.1.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l4.m1.7.7.7.8" xref="alg2.l4.m1.7.7.8.cmml">,</mo><msubsup id="alg2.l4.m1.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.cmml"><mi id="alg2.l4.m1.2.2.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.2.2.cmml">a</mi><mi id="alg2.l4.m1.2.2.2.2.3" xref="alg2.l4.m1.2.2.2.2.3.cmml">t</mi><mtext id="alg2.l4.m1.2.2.2.2.2.3" xref="alg2.l4.m1.2.2.2.2.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l4.m1.7.7.7.9" xref="alg2.l4.m1.7.7.8.cmml">,</mo><msubsup id="alg2.l4.m1.3.3.3.3" xref="alg2.l4.m1.3.3.3.3.cmml"><mi id="alg2.l4.m1.3.3.3.3.2.2" xref="alg2.l4.m1.3.3.3.3.2.2.cmml">r</mi><mi id="alg2.l4.m1.3.3.3.3.3" xref="alg2.l4.m1.3.3.3.3.3.cmml">t</mi><mtext id="alg2.l4.m1.3.3.3.3.2.3" xref="alg2.l4.m1.3.3.3.3.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l4.m1.7.7.7.10" xref="alg2.l4.m1.7.7.8.cmml">,</mo><mrow id="alg2.l4.m1.4.4.4.4.1" xref="alg2.l4.m1.4.4.4.4.2.cmml"><mo id="alg2.l4.m1.4.4.4.4.1.2" stretchy="false" xref="alg2.l4.m1.4.4.4.4.2.cmml">{</mo><msub id="alg2.l4.m1.4.4.4.4.1.1" xref="alg2.l4.m1.4.4.4.4.1.1.cmml"><mi id="alg2.l4.m1.4.4.4.4.1.1.2" xref="alg2.l4.m1.4.4.4.4.1.1.2.cmml">e</mi><mi id="alg2.l4.m1.4.4.4.4.1.1.3" xref="alg2.l4.m1.4.4.4.4.1.1.3.cmml">k</mi></msub><mo id="alg2.l4.m1.4.4.4.4.1.3" stretchy="false" xref="alg2.l4.m1.4.4.4.4.2.cmml">}</mo></mrow><mo id="alg2.l4.m1.7.7.7.11" xref="alg2.l4.m1.7.7.8.cmml">,</mo><mrow id="alg2.l4.m1.5.5.5.5.1" xref="alg2.l4.m1.5.5.5.5.2.cmml"><mo id="alg2.l4.m1.5.5.5.5.1.2" stretchy="false" xref="alg2.l4.m1.5.5.5.5.2.cmml">{</mo><msub id="alg2.l4.m1.5.5.5.5.1.1" xref="alg2.l4.m1.5.5.5.5.1.1.cmml"><mi id="alg2.l4.m1.5.5.5.5.1.1.2" xref="alg2.l4.m1.5.5.5.5.1.1.2.cmml">m</mi><mi id="alg2.l4.m1.5.5.5.5.1.1.3" xref="alg2.l4.m1.5.5.5.5.1.1.3.cmml">k</mi></msub><mo id="alg2.l4.m1.5.5.5.5.1.3" stretchy="false" xref="alg2.l4.m1.5.5.5.5.2.cmml">}</mo></mrow><mo id="alg2.l4.m1.7.7.7.12" xref="alg2.l4.m1.7.7.8.cmml">,</mo><msubsup id="alg2.l4.m1.6.6.6.6" xref="alg2.l4.m1.6.6.6.6.cmml"><mi id="alg2.l4.m1.6.6.6.6.2.2" xref="alg2.l4.m1.6.6.6.6.2.2.cmml">s</mi><mrow id="alg2.l4.m1.6.6.6.6.3" xref="alg2.l4.m1.6.6.6.6.3.cmml"><mi id="alg2.l4.m1.6.6.6.6.3.2" xref="alg2.l4.m1.6.6.6.6.3.2.cmml">t</mi><mo id="alg2.l4.m1.6.6.6.6.3.1" xref="alg2.l4.m1.6.6.6.6.3.1.cmml">+</mo><mn id="alg2.l4.m1.6.6.6.6.3.3" xref="alg2.l4.m1.6.6.6.6.3.3.cmml">1</mn></mrow><mtext id="alg2.l4.m1.6.6.6.6.2.3" xref="alg2.l4.m1.6.6.6.6.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l4.m1.7.7.7.13" xref="alg2.l4.m1.7.7.8.cmml">,</mo><msubsup id="alg2.l4.m1.7.7.7.7" xref="alg2.l4.m1.7.7.7.7.cmml"><mi id="alg2.l4.m1.7.7.7.7.2.2" xref="alg2.l4.m1.7.7.7.7.2.2.cmml">a</mi><mrow id="alg2.l4.m1.7.7.7.7.3" xref="alg2.l4.m1.7.7.7.7.3.cmml"><mi id="alg2.l4.m1.7.7.7.7.3.2" xref="alg2.l4.m1.7.7.7.7.3.2.cmml">t</mi><mo id="alg2.l4.m1.7.7.7.7.3.1" xref="alg2.l4.m1.7.7.7.7.3.1.cmml">+</mo><mn id="alg2.l4.m1.7.7.7.7.3.3" xref="alg2.l4.m1.7.7.7.7.3.3.cmml">1</mn></mrow><mtext id="alg2.l4.m1.7.7.7.7.2.3" xref="alg2.l4.m1.7.7.7.7.2.3a.cmml">h</mtext></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.7b"><list id="alg2.l4.m1.7.7.8.cmml" xref="alg2.l4.m1.7.7.7"><apply id="alg2.l4.m1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1">subscript</csymbol><apply id="alg2.l4.m1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.1.2.1.cmml" xref="alg2.l4.m1.1.1.1.1">superscript</csymbol><ci id="alg2.l4.m1.1.1.1.1.2.2.cmml" xref="alg2.l4.m1.1.1.1.1.2.2">𝑠</ci><ci id="alg2.l4.m1.1.1.1.1.2.3a.cmml" xref="alg2.l4.m1.1.1.1.1.2.3"><mtext id="alg2.l4.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="alg2.l4.m1.1.1.1.1.2.3">h</mtext></ci></apply><ci id="alg2.l4.m1.1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.1.3">𝑡</ci></apply><apply id="alg2.l4.m1.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l4.m1.2.2.2.2.1.cmml" xref="alg2.l4.m1.2.2.2.2">subscript</csymbol><apply id="alg2.l4.m1.2.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l4.m1.2.2.2.2.2.1.cmml" xref="alg2.l4.m1.2.2.2.2">superscript</csymbol><ci id="alg2.l4.m1.2.2.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2.2.2">𝑎</ci><ci id="alg2.l4.m1.2.2.2.2.2.3a.cmml" xref="alg2.l4.m1.2.2.2.2.2.3"><mtext id="alg2.l4.m1.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg2.l4.m1.2.2.2.2.2.3">h</mtext></ci></apply><ci id="alg2.l4.m1.2.2.2.2.3.cmml" xref="alg2.l4.m1.2.2.2.2.3">𝑡</ci></apply><apply id="alg2.l4.m1.3.3.3.3.cmml" xref="alg2.l4.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg2.l4.m1.3.3.3.3.1.cmml" xref="alg2.l4.m1.3.3.3.3">subscript</csymbol><apply id="alg2.l4.m1.3.3.3.3.2.cmml" xref="alg2.l4.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg2.l4.m1.3.3.3.3.2.1.cmml" xref="alg2.l4.m1.3.3.3.3">superscript</csymbol><ci id="alg2.l4.m1.3.3.3.3.2.2.cmml" xref="alg2.l4.m1.3.3.3.3.2.2">𝑟</ci><ci id="alg2.l4.m1.3.3.3.3.2.3a.cmml" xref="alg2.l4.m1.3.3.3.3.2.3"><mtext id="alg2.l4.m1.3.3.3.3.2.3.cmml" mathsize="70%" xref="alg2.l4.m1.3.3.3.3.2.3">h</mtext></ci></apply><ci id="alg2.l4.m1.3.3.3.3.3.cmml" xref="alg2.l4.m1.3.3.3.3.3">𝑡</ci></apply><set id="alg2.l4.m1.4.4.4.4.2.cmml" xref="alg2.l4.m1.4.4.4.4.1"><apply id="alg2.l4.m1.4.4.4.4.1.1.cmml" xref="alg2.l4.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.4.4.4.4.1.1.1.cmml" xref="alg2.l4.m1.4.4.4.4.1.1">subscript</csymbol><ci id="alg2.l4.m1.4.4.4.4.1.1.2.cmml" xref="alg2.l4.m1.4.4.4.4.1.1.2">𝑒</ci><ci id="alg2.l4.m1.4.4.4.4.1.1.3.cmml" xref="alg2.l4.m1.4.4.4.4.1.1.3">𝑘</ci></apply></set><set id="alg2.l4.m1.5.5.5.5.2.cmml" xref="alg2.l4.m1.5.5.5.5.1"><apply id="alg2.l4.m1.5.5.5.5.1.1.cmml" xref="alg2.l4.m1.5.5.5.5.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.5.5.5.5.1.1.1.cmml" xref="alg2.l4.m1.5.5.5.5.1.1">subscript</csymbol><ci id="alg2.l4.m1.5.5.5.5.1.1.2.cmml" xref="alg2.l4.m1.5.5.5.5.1.1.2">𝑚</ci><ci id="alg2.l4.m1.5.5.5.5.1.1.3.cmml" xref="alg2.l4.m1.5.5.5.5.1.1.3">𝑘</ci></apply></set><apply id="alg2.l4.m1.6.6.6.6.cmml" xref="alg2.l4.m1.6.6.6.6"><csymbol cd="ambiguous" id="alg2.l4.m1.6.6.6.6.1.cmml" xref="alg2.l4.m1.6.6.6.6">subscript</csymbol><apply id="alg2.l4.m1.6.6.6.6.2.cmml" xref="alg2.l4.m1.6.6.6.6"><csymbol cd="ambiguous" id="alg2.l4.m1.6.6.6.6.2.1.cmml" xref="alg2.l4.m1.6.6.6.6">superscript</csymbol><ci id="alg2.l4.m1.6.6.6.6.2.2.cmml" xref="alg2.l4.m1.6.6.6.6.2.2">𝑠</ci><ci id="alg2.l4.m1.6.6.6.6.2.3a.cmml" xref="alg2.l4.m1.6.6.6.6.2.3"><mtext id="alg2.l4.m1.6.6.6.6.2.3.cmml" mathsize="70%" xref="alg2.l4.m1.6.6.6.6.2.3">h</mtext></ci></apply><apply id="alg2.l4.m1.6.6.6.6.3.cmml" xref="alg2.l4.m1.6.6.6.6.3"><plus id="alg2.l4.m1.6.6.6.6.3.1.cmml" xref="alg2.l4.m1.6.6.6.6.3.1"></plus><ci id="alg2.l4.m1.6.6.6.6.3.2.cmml" xref="alg2.l4.m1.6.6.6.6.3.2">𝑡</ci><cn id="alg2.l4.m1.6.6.6.6.3.3.cmml" type="integer" xref="alg2.l4.m1.6.6.6.6.3.3">1</cn></apply></apply><apply id="alg2.l4.m1.7.7.7.7.cmml" xref="alg2.l4.m1.7.7.7.7"><csymbol cd="ambiguous" id="alg2.l4.m1.7.7.7.7.1.cmml" xref="alg2.l4.m1.7.7.7.7">subscript</csymbol><apply id="alg2.l4.m1.7.7.7.7.2.cmml" xref="alg2.l4.m1.7.7.7.7"><csymbol cd="ambiguous" id="alg2.l4.m1.7.7.7.7.2.1.cmml" xref="alg2.l4.m1.7.7.7.7">superscript</csymbol><ci id="alg2.l4.m1.7.7.7.7.2.2.cmml" xref="alg2.l4.m1.7.7.7.7.2.2">𝑎</ci><ci id="alg2.l4.m1.7.7.7.7.2.3a.cmml" xref="alg2.l4.m1.7.7.7.7.2.3"><mtext id="alg2.l4.m1.7.7.7.7.2.3.cmml" mathsize="70%" xref="alg2.l4.m1.7.7.7.7.2.3">h</mtext></ci></apply><apply id="alg2.l4.m1.7.7.7.7.3.cmml" xref="alg2.l4.m1.7.7.7.7.3"><plus id="alg2.l4.m1.7.7.7.7.3.1.cmml" xref="alg2.l4.m1.7.7.7.7.3.1"></plus><ci id="alg2.l4.m1.7.7.7.7.3.2.cmml" xref="alg2.l4.m1.7.7.7.7.3.2">𝑡</ci><cn id="alg2.l4.m1.7.7.7.7.3.3.cmml" type="integer" xref="alg2.l4.m1.7.7.7.7.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.7c">s^{\text{h}}_{t},a^{\text{h}}_{t},r^{\text{h}}_{t},\{e_{k}\},\{m_{k}\},s^{%
\text{h}}_{t+1},a^{\text{h}}_{t+1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.7d">italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , { italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } , { italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } , italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> from data

</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l5.1.1.1" style="font-size:80%;">5:</span></span>    Store transition <math alttext="\mathcal{T}_{t}=(s^{\text{h}}_{t},a^{\text{h}}_{t},r^{\text{h}}_{t},s^{\text{h%
}}_{t+1},a^{\text{h}}_{t+1})" class="ltx_Math" display="inline" id="alg2.l5.m1.5"><semantics id="alg2.l5.m1.5a"><mrow id="alg2.l5.m1.5.5" xref="alg2.l5.m1.5.5.cmml"><msub id="alg2.l5.m1.5.5.7" xref="alg2.l5.m1.5.5.7.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m1.5.5.7.2" xref="alg2.l5.m1.5.5.7.2.cmml">𝒯</mi><mi id="alg2.l5.m1.5.5.7.3" xref="alg2.l5.m1.5.5.7.3.cmml">t</mi></msub><mo id="alg2.l5.m1.5.5.6" xref="alg2.l5.m1.5.5.6.cmml">=</mo><mrow id="alg2.l5.m1.5.5.5.5" xref="alg2.l5.m1.5.5.5.6.cmml"><mo id="alg2.l5.m1.5.5.5.5.6" stretchy="false" xref="alg2.l5.m1.5.5.5.6.cmml">(</mo><msubsup id="alg2.l5.m1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.cmml"><mi id="alg2.l5.m1.1.1.1.1.1.2.2" xref="alg2.l5.m1.1.1.1.1.1.2.2.cmml">s</mi><mi id="alg2.l5.m1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.3.cmml">t</mi><mtext id="alg2.l5.m1.1.1.1.1.1.2.3" xref="alg2.l5.m1.1.1.1.1.1.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l5.m1.5.5.5.5.7" xref="alg2.l5.m1.5.5.5.6.cmml">,</mo><msubsup id="alg2.l5.m1.2.2.2.2.2" xref="alg2.l5.m1.2.2.2.2.2.cmml"><mi id="alg2.l5.m1.2.2.2.2.2.2.2" xref="alg2.l5.m1.2.2.2.2.2.2.2.cmml">a</mi><mi id="alg2.l5.m1.2.2.2.2.2.3" xref="alg2.l5.m1.2.2.2.2.2.3.cmml">t</mi><mtext id="alg2.l5.m1.2.2.2.2.2.2.3" xref="alg2.l5.m1.2.2.2.2.2.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l5.m1.5.5.5.5.8" xref="alg2.l5.m1.5.5.5.6.cmml">,</mo><msubsup id="alg2.l5.m1.3.3.3.3.3" xref="alg2.l5.m1.3.3.3.3.3.cmml"><mi id="alg2.l5.m1.3.3.3.3.3.2.2" xref="alg2.l5.m1.3.3.3.3.3.2.2.cmml">r</mi><mi id="alg2.l5.m1.3.3.3.3.3.3" xref="alg2.l5.m1.3.3.3.3.3.3.cmml">t</mi><mtext id="alg2.l5.m1.3.3.3.3.3.2.3" xref="alg2.l5.m1.3.3.3.3.3.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l5.m1.5.5.5.5.9" xref="alg2.l5.m1.5.5.5.6.cmml">,</mo><msubsup id="alg2.l5.m1.4.4.4.4.4" xref="alg2.l5.m1.4.4.4.4.4.cmml"><mi id="alg2.l5.m1.4.4.4.4.4.2.2" xref="alg2.l5.m1.4.4.4.4.4.2.2.cmml">s</mi><mrow id="alg2.l5.m1.4.4.4.4.4.3" xref="alg2.l5.m1.4.4.4.4.4.3.cmml"><mi id="alg2.l5.m1.4.4.4.4.4.3.2" xref="alg2.l5.m1.4.4.4.4.4.3.2.cmml">t</mi><mo id="alg2.l5.m1.4.4.4.4.4.3.1" xref="alg2.l5.m1.4.4.4.4.4.3.1.cmml">+</mo><mn id="alg2.l5.m1.4.4.4.4.4.3.3" xref="alg2.l5.m1.4.4.4.4.4.3.3.cmml">1</mn></mrow><mtext id="alg2.l5.m1.4.4.4.4.4.2.3" xref="alg2.l5.m1.4.4.4.4.4.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l5.m1.5.5.5.5.10" xref="alg2.l5.m1.5.5.5.6.cmml">,</mo><msubsup id="alg2.l5.m1.5.5.5.5.5" xref="alg2.l5.m1.5.5.5.5.5.cmml"><mi id="alg2.l5.m1.5.5.5.5.5.2.2" xref="alg2.l5.m1.5.5.5.5.5.2.2.cmml">a</mi><mrow id="alg2.l5.m1.5.5.5.5.5.3" xref="alg2.l5.m1.5.5.5.5.5.3.cmml"><mi id="alg2.l5.m1.5.5.5.5.5.3.2" xref="alg2.l5.m1.5.5.5.5.5.3.2.cmml">t</mi><mo id="alg2.l5.m1.5.5.5.5.5.3.1" xref="alg2.l5.m1.5.5.5.5.5.3.1.cmml">+</mo><mn id="alg2.l5.m1.5.5.5.5.5.3.3" xref="alg2.l5.m1.5.5.5.5.5.3.3.cmml">1</mn></mrow><mtext id="alg2.l5.m1.5.5.5.5.5.2.3" xref="alg2.l5.m1.5.5.5.5.5.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l5.m1.5.5.5.5.11" stretchy="false" xref="alg2.l5.m1.5.5.5.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.5b"><apply id="alg2.l5.m1.5.5.cmml" xref="alg2.l5.m1.5.5"><eq id="alg2.l5.m1.5.5.6.cmml" xref="alg2.l5.m1.5.5.6"></eq><apply id="alg2.l5.m1.5.5.7.cmml" xref="alg2.l5.m1.5.5.7"><csymbol cd="ambiguous" id="alg2.l5.m1.5.5.7.1.cmml" xref="alg2.l5.m1.5.5.7">subscript</csymbol><ci id="alg2.l5.m1.5.5.7.2.cmml" xref="alg2.l5.m1.5.5.7.2">𝒯</ci><ci id="alg2.l5.m1.5.5.7.3.cmml" xref="alg2.l5.m1.5.5.7.3">𝑡</ci></apply><vector id="alg2.l5.m1.5.5.5.6.cmml" xref="alg2.l5.m1.5.5.5.5"><apply id="alg2.l5.m1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l5.m1.1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.2.2">𝑠</ci><ci id="alg2.l5.m1.1.1.1.1.1.2.3a.cmml" xref="alg2.l5.m1.1.1.1.1.1.2.3"><mtext id="alg2.l5.m1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="alg2.l5.m1.1.1.1.1.1.2.3">h</mtext></ci></apply><ci id="alg2.l5.m1.1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg2.l5.m1.2.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.2.2.2.1.cmml" xref="alg2.l5.m1.2.2.2.2.2">subscript</csymbol><apply id="alg2.l5.m1.2.2.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l5.m1.2.2.2.2.2">superscript</csymbol><ci id="alg2.l5.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2.2.2.2">𝑎</ci><ci id="alg2.l5.m1.2.2.2.2.2.2.3a.cmml" xref="alg2.l5.m1.2.2.2.2.2.2.3"><mtext id="alg2.l5.m1.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg2.l5.m1.2.2.2.2.2.2.3">h</mtext></ci></apply><ci id="alg2.l5.m1.2.2.2.2.2.3.cmml" xref="alg2.l5.m1.2.2.2.2.2.3">𝑡</ci></apply><apply id="alg2.l5.m1.3.3.3.3.3.cmml" xref="alg2.l5.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg2.l5.m1.3.3.3.3.3.1.cmml" xref="alg2.l5.m1.3.3.3.3.3">subscript</csymbol><apply id="alg2.l5.m1.3.3.3.3.3.2.cmml" xref="alg2.l5.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg2.l5.m1.3.3.3.3.3.2.1.cmml" xref="alg2.l5.m1.3.3.3.3.3">superscript</csymbol><ci id="alg2.l5.m1.3.3.3.3.3.2.2.cmml" xref="alg2.l5.m1.3.3.3.3.3.2.2">𝑟</ci><ci id="alg2.l5.m1.3.3.3.3.3.2.3a.cmml" xref="alg2.l5.m1.3.3.3.3.3.2.3"><mtext id="alg2.l5.m1.3.3.3.3.3.2.3.cmml" mathsize="70%" xref="alg2.l5.m1.3.3.3.3.3.2.3">h</mtext></ci></apply><ci id="alg2.l5.m1.3.3.3.3.3.3.cmml" xref="alg2.l5.m1.3.3.3.3.3.3">𝑡</ci></apply><apply id="alg2.l5.m1.4.4.4.4.4.cmml" xref="alg2.l5.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="alg2.l5.m1.4.4.4.4.4.1.cmml" xref="alg2.l5.m1.4.4.4.4.4">subscript</csymbol><apply id="alg2.l5.m1.4.4.4.4.4.2.cmml" xref="alg2.l5.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="alg2.l5.m1.4.4.4.4.4.2.1.cmml" xref="alg2.l5.m1.4.4.4.4.4">superscript</csymbol><ci id="alg2.l5.m1.4.4.4.4.4.2.2.cmml" xref="alg2.l5.m1.4.4.4.4.4.2.2">𝑠</ci><ci id="alg2.l5.m1.4.4.4.4.4.2.3a.cmml" xref="alg2.l5.m1.4.4.4.4.4.2.3"><mtext id="alg2.l5.m1.4.4.4.4.4.2.3.cmml" mathsize="70%" xref="alg2.l5.m1.4.4.4.4.4.2.3">h</mtext></ci></apply><apply id="alg2.l5.m1.4.4.4.4.4.3.cmml" xref="alg2.l5.m1.4.4.4.4.4.3"><plus id="alg2.l5.m1.4.4.4.4.4.3.1.cmml" xref="alg2.l5.m1.4.4.4.4.4.3.1"></plus><ci id="alg2.l5.m1.4.4.4.4.4.3.2.cmml" xref="alg2.l5.m1.4.4.4.4.4.3.2">𝑡</ci><cn id="alg2.l5.m1.4.4.4.4.4.3.3.cmml" type="integer" xref="alg2.l5.m1.4.4.4.4.4.3.3">1</cn></apply></apply><apply id="alg2.l5.m1.5.5.5.5.5.cmml" xref="alg2.l5.m1.5.5.5.5.5"><csymbol cd="ambiguous" id="alg2.l5.m1.5.5.5.5.5.1.cmml" xref="alg2.l5.m1.5.5.5.5.5">subscript</csymbol><apply id="alg2.l5.m1.5.5.5.5.5.2.cmml" xref="alg2.l5.m1.5.5.5.5.5"><csymbol cd="ambiguous" id="alg2.l5.m1.5.5.5.5.5.2.1.cmml" xref="alg2.l5.m1.5.5.5.5.5">superscript</csymbol><ci id="alg2.l5.m1.5.5.5.5.5.2.2.cmml" xref="alg2.l5.m1.5.5.5.5.5.2.2">𝑎</ci><ci id="alg2.l5.m1.5.5.5.5.5.2.3a.cmml" xref="alg2.l5.m1.5.5.5.5.5.2.3"><mtext id="alg2.l5.m1.5.5.5.5.5.2.3.cmml" mathsize="70%" xref="alg2.l5.m1.5.5.5.5.5.2.3">h</mtext></ci></apply><apply id="alg2.l5.m1.5.5.5.5.5.3.cmml" xref="alg2.l5.m1.5.5.5.5.5.3"><plus id="alg2.l5.m1.5.5.5.5.5.3.1.cmml" xref="alg2.l5.m1.5.5.5.5.5.3.1"></plus><ci id="alg2.l5.m1.5.5.5.5.5.3.2.cmml" xref="alg2.l5.m1.5.5.5.5.5.3.2">𝑡</ci><cn id="alg2.l5.m1.5.5.5.5.5.3.3.cmml" type="integer" xref="alg2.l5.m1.5.5.5.5.5.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.5c">\mathcal{T}_{t}=(s^{\text{h}}_{t},a^{\text{h}}_{t},r^{\text{h}}_{t},s^{\text{h%
}}_{t+1},a^{\text{h}}_{t+1})</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.5d">caligraphic_T start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_r start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT , italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math> in <math alttext="\mathscr{R}" class="ltx_Math" display="inline" id="alg2.l5.m2.1"><semantics id="alg2.l5.m2.1a"><mi class="ltx_font_mathscript" id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><ci id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">\mathscr{R}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m2.1d">script_R</annotation></semantics></math>
  // The Cloud Training Stage:

</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l6.1.1.1" style="font-size:80%;">6:</span></span>    <span class="ltx_text ltx_font_bold" id="alg2.l6.2">if</span> <math alttext="\text{size}(\mathcal{R})&gt;N" class="ltx_Math" display="inline" id="alg2.l6.m1.1"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.2" xref="alg2.l6.m1.1.2.cmml"><mrow id="alg2.l6.m1.1.2.2" xref="alg2.l6.m1.1.2.2.cmml"><mtext id="alg2.l6.m1.1.2.2.2" xref="alg2.l6.m1.1.2.2.2a.cmml">size</mtext><mo id="alg2.l6.m1.1.2.2.1" xref="alg2.l6.m1.1.2.2.1.cmml">⁢</mo><mrow id="alg2.l6.m1.1.2.2.3.2" xref="alg2.l6.m1.1.2.2.cmml"><mo id="alg2.l6.m1.1.2.2.3.2.1" stretchy="false" xref="alg2.l6.m1.1.2.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">ℛ</mi><mo id="alg2.l6.m1.1.2.2.3.2.2" stretchy="false" xref="alg2.l6.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="alg2.l6.m1.1.2.1" xref="alg2.l6.m1.1.2.1.cmml">&gt;</mo><mi id="alg2.l6.m1.1.2.3" xref="alg2.l6.m1.1.2.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.2.cmml" xref="alg2.l6.m1.1.2"><gt id="alg2.l6.m1.1.2.1.cmml" xref="alg2.l6.m1.1.2.1"></gt><apply id="alg2.l6.m1.1.2.2.cmml" xref="alg2.l6.m1.1.2.2"><times id="alg2.l6.m1.1.2.2.1.cmml" xref="alg2.l6.m1.1.2.2.1"></times><ci id="alg2.l6.m1.1.2.2.2a.cmml" xref="alg2.l6.m1.1.2.2.2"><mtext id="alg2.l6.m1.1.2.2.2.cmml" xref="alg2.l6.m1.1.2.2.2">size</mtext></ci><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">ℛ</ci></apply><ci id="alg2.l6.m1.1.2.3.cmml" xref="alg2.l6.m1.1.2.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\text{size}(\mathcal{R})&gt;N</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">size ( caligraphic_R ) &gt; italic_N</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l6.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">7:</span></span>      Sample <math alttext="N" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">italic_N</annotation></semantics></math> transitions <math alttext="\mathcal{T}_{i}" class="ltx_Math" display="inline" id="alg2.l7.m2.1"><semantics id="alg2.l7.m2.1a"><msub id="alg2.l7.m2.1.1" xref="alg2.l7.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m2.1.1.2" xref="alg2.l7.m2.1.1.2.cmml">𝒯</mi><mi id="alg2.l7.m2.1.1.3" xref="alg2.l7.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.1b"><apply id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1"><csymbol cd="ambiguous" id="alg2.l7.m2.1.1.1.cmml" xref="alg2.l7.m2.1.1">subscript</csymbol><ci id="alg2.l7.m2.1.1.2.cmml" xref="alg2.l7.m2.1.1.2">𝒯</ci><ci id="alg2.l7.m2.1.1.3.cmml" xref="alg2.l7.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.1c">\mathcal{T}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m2.1d">caligraphic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> from <math alttext="\mathscr{R}" class="ltx_Math" display="inline" id="alg2.l7.m3.1"><semantics id="alg2.l7.m3.1a"><mi class="ltx_font_mathscript" id="alg2.l7.m3.1.1" xref="alg2.l7.m3.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m3.1b"><ci id="alg2.l7.m3.1.1.cmml" xref="alg2.l7.m3.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m3.1c">\mathscr{R}</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m3.1d">script_R</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l8.1.1.1" style="font-size:80%;">8:</span></span>      <span class="ltx_text ltx_font_bold" id="alg2.l8.2">for</span> <math alttext="i=1,\cdots,N" class="ltx_Math" display="inline" id="alg2.l8.m1.3"><semantics id="alg2.l8.m1.3a"><mrow id="alg2.l8.m1.3.4" xref="alg2.l8.m1.3.4.cmml"><mi id="alg2.l8.m1.3.4.2" xref="alg2.l8.m1.3.4.2.cmml">i</mi><mo id="alg2.l8.m1.3.4.1" xref="alg2.l8.m1.3.4.1.cmml">=</mo><mrow id="alg2.l8.m1.3.4.3.2" xref="alg2.l8.m1.3.4.3.1.cmml"><mn id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">1</mn><mo id="alg2.l8.m1.3.4.3.2.1" xref="alg2.l8.m1.3.4.3.1.cmml">,</mo><mi id="alg2.l8.m1.2.2" mathvariant="normal" xref="alg2.l8.m1.2.2.cmml">⋯</mi><mo id="alg2.l8.m1.3.4.3.2.2" xref="alg2.l8.m1.3.4.3.1.cmml">,</mo><mi id="alg2.l8.m1.3.3" xref="alg2.l8.m1.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.3b"><apply id="alg2.l8.m1.3.4.cmml" xref="alg2.l8.m1.3.4"><eq id="alg2.l8.m1.3.4.1.cmml" xref="alg2.l8.m1.3.4.1"></eq><ci id="alg2.l8.m1.3.4.2.cmml" xref="alg2.l8.m1.3.4.2">𝑖</ci><list id="alg2.l8.m1.3.4.3.1.cmml" xref="alg2.l8.m1.3.4.3.2"><cn id="alg2.l8.m1.1.1.cmml" type="integer" xref="alg2.l8.m1.1.1">1</cn><ci id="alg2.l8.m1.2.2.cmml" xref="alg2.l8.m1.2.2">⋯</ci><ci id="alg2.l8.m1.3.3.cmml" xref="alg2.l8.m1.3.3">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.3c">i=1,\cdots,N</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.3d">italic_i = 1 , ⋯ , italic_N</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l8.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l9.1.1.1" style="font-size:80%;">9:</span></span>        Set <math alttext="y_{i}=r^{\text{h}}_{i}+\gamma Q_{w}(s^{\text{h}}_{i+1},a^{\text{h}}_{i+1})" class="ltx_Math" display="inline" id="alg2.l9.m1.2"><semantics id="alg2.l9.m1.2a"><mrow id="alg2.l9.m1.2.2" xref="alg2.l9.m1.2.2.cmml"><msub id="alg2.l9.m1.2.2.4" xref="alg2.l9.m1.2.2.4.cmml"><mi id="alg2.l9.m1.2.2.4.2" xref="alg2.l9.m1.2.2.4.2.cmml">y</mi><mi id="alg2.l9.m1.2.2.4.3" xref="alg2.l9.m1.2.2.4.3.cmml">i</mi></msub><mo id="alg2.l9.m1.2.2.3" xref="alg2.l9.m1.2.2.3.cmml">=</mo><mrow id="alg2.l9.m1.2.2.2" xref="alg2.l9.m1.2.2.2.cmml"><msubsup id="alg2.l9.m1.2.2.2.4" xref="alg2.l9.m1.2.2.2.4.cmml"><mi id="alg2.l9.m1.2.2.2.4.2.2" xref="alg2.l9.m1.2.2.2.4.2.2.cmml">r</mi><mi id="alg2.l9.m1.2.2.2.4.3" xref="alg2.l9.m1.2.2.2.4.3.cmml">i</mi><mtext id="alg2.l9.m1.2.2.2.4.2.3" xref="alg2.l9.m1.2.2.2.4.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l9.m1.2.2.2.3" xref="alg2.l9.m1.2.2.2.3.cmml">+</mo><mrow id="alg2.l9.m1.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.cmml"><mi id="alg2.l9.m1.2.2.2.2.4" xref="alg2.l9.m1.2.2.2.2.4.cmml">γ</mi><mo id="alg2.l9.m1.2.2.2.2.3" xref="alg2.l9.m1.2.2.2.2.3.cmml">⁢</mo><msub id="alg2.l9.m1.2.2.2.2.5" xref="alg2.l9.m1.2.2.2.2.5.cmml"><mi id="alg2.l9.m1.2.2.2.2.5.2" xref="alg2.l9.m1.2.2.2.2.5.2.cmml">Q</mi><mi id="alg2.l9.m1.2.2.2.2.5.3" xref="alg2.l9.m1.2.2.2.2.5.3.cmml">w</mi></msub><mo id="alg2.l9.m1.2.2.2.2.3a" xref="alg2.l9.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="alg2.l9.m1.2.2.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.2.3.cmml"><mo id="alg2.l9.m1.2.2.2.2.2.2.3" stretchy="false" xref="alg2.l9.m1.2.2.2.2.2.3.cmml">(</mo><msubsup id="alg2.l9.m1.1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l9.m1.1.1.1.1.1.1.1.2.2" xref="alg2.l9.m1.1.1.1.1.1.1.1.2.2.cmml">s</mi><mrow id="alg2.l9.m1.1.1.1.1.1.1.1.3" xref="alg2.l9.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l9.m1.1.1.1.1.1.1.1.3.2" xref="alg2.l9.m1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="alg2.l9.m1.1.1.1.1.1.1.1.3.1" xref="alg2.l9.m1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg2.l9.m1.1.1.1.1.1.1.1.3.3" xref="alg2.l9.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mtext id="alg2.l9.m1.1.1.1.1.1.1.1.2.3" xref="alg2.l9.m1.1.1.1.1.1.1.1.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l9.m1.2.2.2.2.2.2.4" xref="alg2.l9.m1.2.2.2.2.2.3.cmml">,</mo><msubsup id="alg2.l9.m1.2.2.2.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.2.2.2.cmml"><mi id="alg2.l9.m1.2.2.2.2.2.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.2.2.2.2.2.cmml">a</mi><mrow id="alg2.l9.m1.2.2.2.2.2.2.2.3" xref="alg2.l9.m1.2.2.2.2.2.2.2.3.cmml"><mi id="alg2.l9.m1.2.2.2.2.2.2.2.3.2" xref="alg2.l9.m1.2.2.2.2.2.2.2.3.2.cmml">i</mi><mo id="alg2.l9.m1.2.2.2.2.2.2.2.3.1" xref="alg2.l9.m1.2.2.2.2.2.2.2.3.1.cmml">+</mo><mn id="alg2.l9.m1.2.2.2.2.2.2.2.3.3" xref="alg2.l9.m1.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mtext id="alg2.l9.m1.2.2.2.2.2.2.2.2.3" xref="alg2.l9.m1.2.2.2.2.2.2.2.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l9.m1.2.2.2.2.2.2.5" stretchy="false" xref="alg2.l9.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.2b"><apply id="alg2.l9.m1.2.2.cmml" xref="alg2.l9.m1.2.2"><eq id="alg2.l9.m1.2.2.3.cmml" xref="alg2.l9.m1.2.2.3"></eq><apply id="alg2.l9.m1.2.2.4.cmml" xref="alg2.l9.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.4.1.cmml" xref="alg2.l9.m1.2.2.4">subscript</csymbol><ci id="alg2.l9.m1.2.2.4.2.cmml" xref="alg2.l9.m1.2.2.4.2">𝑦</ci><ci id="alg2.l9.m1.2.2.4.3.cmml" xref="alg2.l9.m1.2.2.4.3">𝑖</ci></apply><apply id="alg2.l9.m1.2.2.2.cmml" xref="alg2.l9.m1.2.2.2"><plus id="alg2.l9.m1.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.3"></plus><apply id="alg2.l9.m1.2.2.2.4.cmml" xref="alg2.l9.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.4.1.cmml" xref="alg2.l9.m1.2.2.2.4">subscript</csymbol><apply id="alg2.l9.m1.2.2.2.4.2.cmml" xref="alg2.l9.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.4.2.1.cmml" xref="alg2.l9.m1.2.2.2.4">superscript</csymbol><ci id="alg2.l9.m1.2.2.2.4.2.2.cmml" xref="alg2.l9.m1.2.2.2.4.2.2">𝑟</ci><ci id="alg2.l9.m1.2.2.2.4.2.3a.cmml" xref="alg2.l9.m1.2.2.2.4.2.3"><mtext id="alg2.l9.m1.2.2.2.4.2.3.cmml" mathsize="70%" xref="alg2.l9.m1.2.2.2.4.2.3">h</mtext></ci></apply><ci id="alg2.l9.m1.2.2.2.4.3.cmml" xref="alg2.l9.m1.2.2.2.4.3">𝑖</ci></apply><apply id="alg2.l9.m1.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2"><times id="alg2.l9.m1.2.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.3"></times><ci id="alg2.l9.m1.2.2.2.2.4.cmml" xref="alg2.l9.m1.2.2.2.2.4">𝛾</ci><apply id="alg2.l9.m1.2.2.2.2.5.cmml" xref="alg2.l9.m1.2.2.2.2.5"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.5.1.cmml" xref="alg2.l9.m1.2.2.2.2.5">subscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.5.2.cmml" xref="alg2.l9.m1.2.2.2.2.5.2">𝑄</ci><ci id="alg2.l9.m1.2.2.2.2.5.3.cmml" xref="alg2.l9.m1.2.2.2.2.5.3">𝑤</ci></apply><interval closure="open" id="alg2.l9.m1.2.2.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.2.2"><apply id="alg2.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l9.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l9.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.2.2">𝑠</ci><ci id="alg2.l9.m1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.2.3"><mtext id="alg2.l9.m1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="alg2.l9.m1.1.1.1.1.1.1.1.2.3">h</mtext></ci></apply><apply id="alg2.l9.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.3"><plus id="alg2.l9.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.3.1"></plus><ci id="alg2.l9.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="alg2.l9.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg2.l9.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg2.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.2.2.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2">subscript</csymbol><apply id="alg2.l9.m1.2.2.2.2.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2.2.2">𝑎</ci><ci id="alg2.l9.m1.2.2.2.2.2.2.2.2.3a.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2.2.3"><mtext id="alg2.l9.m1.2.2.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg2.l9.m1.2.2.2.2.2.2.2.2.3">h</mtext></ci></apply><apply id="alg2.l9.m1.2.2.2.2.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2.3"><plus id="alg2.l9.m1.2.2.2.2.2.2.2.3.1.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2.3.1"></plus><ci id="alg2.l9.m1.2.2.2.2.2.2.2.3.2.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2.3.2">𝑖</ci><cn id="alg2.l9.m1.2.2.2.2.2.2.2.3.3.cmml" type="integer" xref="alg2.l9.m1.2.2.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.2c">y_{i}=r^{\text{h}}_{i}+\gamma Q_{w}(s^{\text{h}}_{i+1},a^{\text{h}}_{i+1})</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.2d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_r start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_γ italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , italic_a start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l10.1.1.1" style="font-size:80%;">10:</span></span>        Calculate <math alttext="L" class="ltx_Math" display="inline" id="alg2.l10.m1.1"><semantics id="alg2.l10.m1.1a"><mi id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><ci id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.1d">italic_L</annotation></semantics></math> based on in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S3.E3" title="In 3.3 Deep Deterministic Policy Gradient ‣ 3 Preliminary and Problem Formulation ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>)

</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l11.1.1.1" style="font-size:80%;">11:</span></span>        Calculate <math alttext="L_{\text{off}}" class="ltx_Math" display="inline" id="alg2.l11.m1.1"><semantics id="alg2.l11.m1.1a"><msub id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><mi id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2.cmml">L</mi><mtext id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3a.cmml">off</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1">subscript</csymbol><ci id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2">𝐿</ci><ci id="alg2.l11.m1.1.1.3a.cmml" xref="alg2.l11.m1.1.1.3"><mtext id="alg2.l11.m1.1.1.3.cmml" mathsize="70%" xref="alg2.l11.m1.1.1.3">off</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">L_{\text{off}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.1d">italic_L start_POSTSUBSCRIPT off end_POSTSUBSCRIPT</annotation></semantics></math> based on in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S4.E11" title="In 4.4.2 Training with Offline Data ‣ 4.4 Mechanism ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">11</span></a>)

</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l12.1.1.1" style="font-size:80%;">12:</span></span>        Update <math alttext="w" class="ltx_Math" display="inline" id="alg2.l12.m1.1"><semantics id="alg2.l12.m1.1a"><mi id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><ci id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m1.1d">italic_w</annotation></semantics></math> by <math alttext="\min L+L_{\text{off}}" class="ltx_Math" display="inline" id="alg2.l12.m2.1"><semantics id="alg2.l12.m2.1a"><mrow id="alg2.l12.m2.1.1" xref="alg2.l12.m2.1.1.cmml"><mrow id="alg2.l12.m2.1.1.2" xref="alg2.l12.m2.1.1.2.cmml"><mi id="alg2.l12.m2.1.1.2.1" xref="alg2.l12.m2.1.1.2.1.cmml">min</mi><mo id="alg2.l12.m2.1.1.2a" lspace="0.167em" xref="alg2.l12.m2.1.1.2.cmml">⁡</mo><mi id="alg2.l12.m2.1.1.2.2" xref="alg2.l12.m2.1.1.2.2.cmml">L</mi></mrow><mo id="alg2.l12.m2.1.1.1" xref="alg2.l12.m2.1.1.1.cmml">+</mo><msub id="alg2.l12.m2.1.1.3" xref="alg2.l12.m2.1.1.3.cmml"><mi id="alg2.l12.m2.1.1.3.2" xref="alg2.l12.m2.1.1.3.2.cmml">L</mi><mtext id="alg2.l12.m2.1.1.3.3" xref="alg2.l12.m2.1.1.3.3a.cmml">off</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m2.1b"><apply id="alg2.l12.m2.1.1.cmml" xref="alg2.l12.m2.1.1"><plus id="alg2.l12.m2.1.1.1.cmml" xref="alg2.l12.m2.1.1.1"></plus><apply id="alg2.l12.m2.1.1.2.cmml" xref="alg2.l12.m2.1.1.2"><min id="alg2.l12.m2.1.1.2.1.cmml" xref="alg2.l12.m2.1.1.2.1"></min><ci id="alg2.l12.m2.1.1.2.2.cmml" xref="alg2.l12.m2.1.1.2.2">𝐿</ci></apply><apply id="alg2.l12.m2.1.1.3.cmml" xref="alg2.l12.m2.1.1.3"><csymbol cd="ambiguous" id="alg2.l12.m2.1.1.3.1.cmml" xref="alg2.l12.m2.1.1.3">subscript</csymbol><ci id="alg2.l12.m2.1.1.3.2.cmml" xref="alg2.l12.m2.1.1.3.2">𝐿</ci><ci id="alg2.l12.m2.1.1.3.3a.cmml" xref="alg2.l12.m2.1.1.3.3"><mtext id="alg2.l12.m2.1.1.3.3.cmml" mathsize="70%" xref="alg2.l12.m2.1.1.3.3">off</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m2.1c">\min L+L_{\text{off}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m2.1d">roman_min italic_L + italic_L start_POSTSUBSCRIPT off end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l13.1.1.1" style="font-size:80%;">13:</span></span>    <span class="ltx_text ltx_font_bold" id="alg2.l13.2">end if</span>
  // The Edge Training Stage:

</div>
<div class="ltx_listingline" id="alg2.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l14.1.1.1" style="font-size:80%;">14:</span></span>    <span class="ltx_text ltx_font_bold" id="alg2.l14.2">for</span> <math alttext="k=0,\cdots,K" class="ltx_Math" display="inline" id="alg2.l14.m1.3"><semantics id="alg2.l14.m1.3a"><mrow id="alg2.l14.m1.3.4" xref="alg2.l14.m1.3.4.cmml"><mi id="alg2.l14.m1.3.4.2" xref="alg2.l14.m1.3.4.2.cmml">k</mi><mo id="alg2.l14.m1.3.4.1" xref="alg2.l14.m1.3.4.1.cmml">=</mo><mrow id="alg2.l14.m1.3.4.3.2" xref="alg2.l14.m1.3.4.3.1.cmml"><mn id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml">0</mn><mo id="alg2.l14.m1.3.4.3.2.1" xref="alg2.l14.m1.3.4.3.1.cmml">,</mo><mi id="alg2.l14.m1.2.2" mathvariant="normal" xref="alg2.l14.m1.2.2.cmml">⋯</mi><mo id="alg2.l14.m1.3.4.3.2.2" xref="alg2.l14.m1.3.4.3.1.cmml">,</mo><mi id="alg2.l14.m1.3.3" xref="alg2.l14.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.3b"><apply id="alg2.l14.m1.3.4.cmml" xref="alg2.l14.m1.3.4"><eq id="alg2.l14.m1.3.4.1.cmml" xref="alg2.l14.m1.3.4.1"></eq><ci id="alg2.l14.m1.3.4.2.cmml" xref="alg2.l14.m1.3.4.2">𝑘</ci><list id="alg2.l14.m1.3.4.3.1.cmml" xref="alg2.l14.m1.3.4.3.2"><cn id="alg2.l14.m1.1.1.cmml" type="integer" xref="alg2.l14.m1.1.1">0</cn><ci id="alg2.l14.m1.2.2.cmml" xref="alg2.l14.m1.2.2">⋯</ci><ci id="alg2.l14.m1.3.3.cmml" xref="alg2.l14.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.3c">k=0,\cdots,K</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m1.3d">italic_k = 0 , ⋯ , italic_K</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l14.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l15.1.1.1" style="font-size:80%;">15:</span></span>      <span class="ltx_text ltx_font_bold" id="alg2.l15.2">Initialize</span> the ranked item list <math alttext="\mathbf{e}=\{\}" class="ltx_Math" display="inline" id="alg2.l15.m1.1"><semantics id="alg2.l15.m1.1a"><mrow id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mi id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">𝐞</mi><mo id="alg2.l15.m1.1.1.1" xref="alg2.l15.m1.1.1.1.cmml">=</mo><mrow id="alg2.l15.m1.1.1.3.2" xref="alg2.l15.m1.1.1.cmml"><mo id="alg2.l15.m1.1.1.3.2.1" stretchy="false" xref="alg2.l15.m1.1.1.3.1.cmml">{</mo><mo id="alg2.l15.m1.1.1.3.2.2" stretchy="false" xref="alg2.l15.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><eq id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1"></eq><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">𝐞</ci><list id="alg2.l15.m1.1.1.3.1.cmml" xref="alg2.l15.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">\mathbf{e}=\{\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m1.1d">bold_e = { }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l16.1.1.1" style="font-size:80%;">16:</span></span>      Observe <math alttext="m_{k}" class="ltx_Math" display="inline" id="alg2.l16.m1.1"><semantics id="alg2.l16.m1.1a"><msub id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><mi id="alg2.l16.m1.1.1.2" xref="alg2.l16.m1.1.1.2.cmml">m</mi><mi id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.1.cmml" xref="alg2.l16.m1.1.1">subscript</csymbol><ci id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1.2">𝑚</ci><ci id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">m_{k}</annotation><annotation encoding="application/x-llamapun" id="alg2.l16.m1.1d">italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="s^{\text{l}}_{k}=[u_{t},c^{o}_{t},m_{k},\mathbf{e}]" class="ltx_Math" display="inline" id="alg2.l16.m2.4"><semantics id="alg2.l16.m2.4a"><mrow id="alg2.l16.m2.4.4" xref="alg2.l16.m2.4.4.cmml"><msubsup id="alg2.l16.m2.4.4.5" xref="alg2.l16.m2.4.4.5.cmml"><mi id="alg2.l16.m2.4.4.5.2.2" xref="alg2.l16.m2.4.4.5.2.2.cmml">s</mi><mi id="alg2.l16.m2.4.4.5.3" xref="alg2.l16.m2.4.4.5.3.cmml">k</mi><mtext id="alg2.l16.m2.4.4.5.2.3" xref="alg2.l16.m2.4.4.5.2.3a.cmml">l</mtext></msubsup><mo id="alg2.l16.m2.4.4.4" xref="alg2.l16.m2.4.4.4.cmml">=</mo><mrow id="alg2.l16.m2.4.4.3.3" xref="alg2.l16.m2.4.4.3.4.cmml"><mo id="alg2.l16.m2.4.4.3.3.4" stretchy="false" xref="alg2.l16.m2.4.4.3.4.cmml">[</mo><msub id="alg2.l16.m2.2.2.1.1.1" xref="alg2.l16.m2.2.2.1.1.1.cmml"><mi id="alg2.l16.m2.2.2.1.1.1.2" xref="alg2.l16.m2.2.2.1.1.1.2.cmml">u</mi><mi id="alg2.l16.m2.2.2.1.1.1.3" xref="alg2.l16.m2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="alg2.l16.m2.4.4.3.3.5" xref="alg2.l16.m2.4.4.3.4.cmml">,</mo><msubsup id="alg2.l16.m2.3.3.2.2.2" xref="alg2.l16.m2.3.3.2.2.2.cmml"><mi id="alg2.l16.m2.3.3.2.2.2.2.2" xref="alg2.l16.m2.3.3.2.2.2.2.2.cmml">c</mi><mi id="alg2.l16.m2.3.3.2.2.2.3" xref="alg2.l16.m2.3.3.2.2.2.3.cmml">t</mi><mi id="alg2.l16.m2.3.3.2.2.2.2.3" xref="alg2.l16.m2.3.3.2.2.2.2.3.cmml">o</mi></msubsup><mo id="alg2.l16.m2.4.4.3.3.6" xref="alg2.l16.m2.4.4.3.4.cmml">,</mo><msub id="alg2.l16.m2.4.4.3.3.3" xref="alg2.l16.m2.4.4.3.3.3.cmml"><mi id="alg2.l16.m2.4.4.3.3.3.2" xref="alg2.l16.m2.4.4.3.3.3.2.cmml">m</mi><mi id="alg2.l16.m2.4.4.3.3.3.3" xref="alg2.l16.m2.4.4.3.3.3.3.cmml">k</mi></msub><mo id="alg2.l16.m2.4.4.3.3.7" xref="alg2.l16.m2.4.4.3.4.cmml">,</mo><mi id="alg2.l16.m2.1.1" xref="alg2.l16.m2.1.1.cmml">𝐞</mi><mo id="alg2.l16.m2.4.4.3.3.8" stretchy="false" xref="alg2.l16.m2.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m2.4b"><apply id="alg2.l16.m2.4.4.cmml" xref="alg2.l16.m2.4.4"><eq id="alg2.l16.m2.4.4.4.cmml" xref="alg2.l16.m2.4.4.4"></eq><apply id="alg2.l16.m2.4.4.5.cmml" xref="alg2.l16.m2.4.4.5"><csymbol cd="ambiguous" id="alg2.l16.m2.4.4.5.1.cmml" xref="alg2.l16.m2.4.4.5">subscript</csymbol><apply id="alg2.l16.m2.4.4.5.2.cmml" xref="alg2.l16.m2.4.4.5"><csymbol cd="ambiguous" id="alg2.l16.m2.4.4.5.2.1.cmml" xref="alg2.l16.m2.4.4.5">superscript</csymbol><ci id="alg2.l16.m2.4.4.5.2.2.cmml" xref="alg2.l16.m2.4.4.5.2.2">𝑠</ci><ci id="alg2.l16.m2.4.4.5.2.3a.cmml" xref="alg2.l16.m2.4.4.5.2.3"><mtext id="alg2.l16.m2.4.4.5.2.3.cmml" mathsize="70%" xref="alg2.l16.m2.4.4.5.2.3">l</mtext></ci></apply><ci id="alg2.l16.m2.4.4.5.3.cmml" xref="alg2.l16.m2.4.4.5.3">𝑘</ci></apply><list id="alg2.l16.m2.4.4.3.4.cmml" xref="alg2.l16.m2.4.4.3.3"><apply id="alg2.l16.m2.2.2.1.1.1.cmml" xref="alg2.l16.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m2.2.2.1.1.1.1.cmml" xref="alg2.l16.m2.2.2.1.1.1">subscript</csymbol><ci id="alg2.l16.m2.2.2.1.1.1.2.cmml" xref="alg2.l16.m2.2.2.1.1.1.2">𝑢</ci><ci id="alg2.l16.m2.2.2.1.1.1.3.cmml" xref="alg2.l16.m2.2.2.1.1.1.3">𝑡</ci></apply><apply id="alg2.l16.m2.3.3.2.2.2.cmml" xref="alg2.l16.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l16.m2.3.3.2.2.2.1.cmml" xref="alg2.l16.m2.3.3.2.2.2">subscript</csymbol><apply id="alg2.l16.m2.3.3.2.2.2.2.cmml" xref="alg2.l16.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l16.m2.3.3.2.2.2.2.1.cmml" xref="alg2.l16.m2.3.3.2.2.2">superscript</csymbol><ci id="alg2.l16.m2.3.3.2.2.2.2.2.cmml" xref="alg2.l16.m2.3.3.2.2.2.2.2">𝑐</ci><ci id="alg2.l16.m2.3.3.2.2.2.2.3.cmml" xref="alg2.l16.m2.3.3.2.2.2.2.3">𝑜</ci></apply><ci id="alg2.l16.m2.3.3.2.2.2.3.cmml" xref="alg2.l16.m2.3.3.2.2.2.3">𝑡</ci></apply><apply id="alg2.l16.m2.4.4.3.3.3.cmml" xref="alg2.l16.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="alg2.l16.m2.4.4.3.3.3.1.cmml" xref="alg2.l16.m2.4.4.3.3.3">subscript</csymbol><ci id="alg2.l16.m2.4.4.3.3.3.2.cmml" xref="alg2.l16.m2.4.4.3.3.3.2">𝑚</ci><ci id="alg2.l16.m2.4.4.3.3.3.3.cmml" xref="alg2.l16.m2.4.4.3.3.3.3">𝑘</ci></apply><ci id="alg2.l16.m2.1.1.cmml" xref="alg2.l16.m2.1.1">𝐞</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m2.4c">s^{\text{l}}_{k}=[u_{t},c^{o}_{t},m_{k},\mathbf{e}]</annotation><annotation encoding="application/x-llamapun" id="alg2.l16.m2.4d">italic_s start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = [ italic_u start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_m start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , bold_e ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l17.1.1.1" style="font-size:80%;">17:</span></span>      Get <math alttext="a^{\text{l}}_{k}" class="ltx_Math" display="inline" id="alg2.l17.m1.1"><semantics id="alg2.l17.m1.1a"><msubsup id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml"><mi id="alg2.l17.m1.1.1.2.2" xref="alg2.l17.m1.1.1.2.2.cmml">a</mi><mi id="alg2.l17.m1.1.1.3" xref="alg2.l17.m1.1.1.3.cmml">k</mi><mtext id="alg2.l17.m1.1.1.2.3" xref="alg2.l17.m1.1.1.2.3a.cmml">l</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.1b"><apply id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.1.cmml" xref="alg2.l17.m1.1.1">subscript</csymbol><apply id="alg2.l17.m1.1.1.2.cmml" xref="alg2.l17.m1.1.1"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.2.1.cmml" xref="alg2.l17.m1.1.1">superscript</csymbol><ci id="alg2.l17.m1.1.1.2.2.cmml" xref="alg2.l17.m1.1.1.2.2">𝑎</ci><ci id="alg2.l17.m1.1.1.2.3a.cmml" xref="alg2.l17.m1.1.1.2.3"><mtext id="alg2.l17.m1.1.1.2.3.cmml" mathsize="70%" xref="alg2.l17.m1.1.1.2.3">l</mtext></ci></apply><ci id="alg2.l17.m1.1.1.3.cmml" xref="alg2.l17.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.1c">a^{\text{l}}_{k}</annotation><annotation encoding="application/x-llamapun" id="alg2.l17.m1.1d">italic_a start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> based on the current policy <math alttext="\pi_{\theta}(a^{\text{l}}_{k}|s^{\text{l}}_{k})" class="ltx_Math" display="inline" id="alg2.l17.m2.1"><semantics id="alg2.l17.m2.1a"><mrow id="alg2.l17.m2.1.1" xref="alg2.l17.m2.1.1.cmml"><msub id="alg2.l17.m2.1.1.3" xref="alg2.l17.m2.1.1.3.cmml"><mi id="alg2.l17.m2.1.1.3.2" xref="alg2.l17.m2.1.1.3.2.cmml">π</mi><mi id="alg2.l17.m2.1.1.3.3" xref="alg2.l17.m2.1.1.3.3.cmml">θ</mi></msub><mo id="alg2.l17.m2.1.1.2" xref="alg2.l17.m2.1.1.2.cmml">⁢</mo><mrow id="alg2.l17.m2.1.1.1.1" xref="alg2.l17.m2.1.1.1.1.1.cmml"><mo id="alg2.l17.m2.1.1.1.1.2" stretchy="false" xref="alg2.l17.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l17.m2.1.1.1.1.1" xref="alg2.l17.m2.1.1.1.1.1.cmml"><msubsup id="alg2.l17.m2.1.1.1.1.1.2" xref="alg2.l17.m2.1.1.1.1.1.2.cmml"><mi id="alg2.l17.m2.1.1.1.1.1.2.2.2" xref="alg2.l17.m2.1.1.1.1.1.2.2.2.cmml">a</mi><mi id="alg2.l17.m2.1.1.1.1.1.2.3" xref="alg2.l17.m2.1.1.1.1.1.2.3.cmml">k</mi><mtext id="alg2.l17.m2.1.1.1.1.1.2.2.3" xref="alg2.l17.m2.1.1.1.1.1.2.2.3a.cmml">l</mtext></msubsup><mo fence="false" id="alg2.l17.m2.1.1.1.1.1.1" xref="alg2.l17.m2.1.1.1.1.1.1.cmml">|</mo><msubsup id="alg2.l17.m2.1.1.1.1.1.3" xref="alg2.l17.m2.1.1.1.1.1.3.cmml"><mi id="alg2.l17.m2.1.1.1.1.1.3.2.2" xref="alg2.l17.m2.1.1.1.1.1.3.2.2.cmml">s</mi><mi id="alg2.l17.m2.1.1.1.1.1.3.3" xref="alg2.l17.m2.1.1.1.1.1.3.3.cmml">k</mi><mtext id="alg2.l17.m2.1.1.1.1.1.3.2.3" xref="alg2.l17.m2.1.1.1.1.1.3.2.3a.cmml">l</mtext></msubsup></mrow><mo id="alg2.l17.m2.1.1.1.1.3" stretchy="false" xref="alg2.l17.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m2.1b"><apply id="alg2.l17.m2.1.1.cmml" xref="alg2.l17.m2.1.1"><times id="alg2.l17.m2.1.1.2.cmml" xref="alg2.l17.m2.1.1.2"></times><apply id="alg2.l17.m2.1.1.3.cmml" xref="alg2.l17.m2.1.1.3"><csymbol cd="ambiguous" id="alg2.l17.m2.1.1.3.1.cmml" xref="alg2.l17.m2.1.1.3">subscript</csymbol><ci id="alg2.l17.m2.1.1.3.2.cmml" xref="alg2.l17.m2.1.1.3.2">𝜋</ci><ci id="alg2.l17.m2.1.1.3.3.cmml" xref="alg2.l17.m2.1.1.3.3">𝜃</ci></apply><apply id="alg2.l17.m2.1.1.1.1.1.cmml" xref="alg2.l17.m2.1.1.1.1"><csymbol cd="latexml" id="alg2.l17.m2.1.1.1.1.1.1.cmml" xref="alg2.l17.m2.1.1.1.1.1.1">conditional</csymbol><apply id="alg2.l17.m2.1.1.1.1.1.2.cmml" xref="alg2.l17.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l17.m2.1.1.1.1.1.2.1.cmml" xref="alg2.l17.m2.1.1.1.1.1.2">subscript</csymbol><apply id="alg2.l17.m2.1.1.1.1.1.2.2.cmml" xref="alg2.l17.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l17.m2.1.1.1.1.1.2.2.1.cmml" xref="alg2.l17.m2.1.1.1.1.1.2">superscript</csymbol><ci id="alg2.l17.m2.1.1.1.1.1.2.2.2.cmml" xref="alg2.l17.m2.1.1.1.1.1.2.2.2">𝑎</ci><ci id="alg2.l17.m2.1.1.1.1.1.2.2.3a.cmml" xref="alg2.l17.m2.1.1.1.1.1.2.2.3"><mtext id="alg2.l17.m2.1.1.1.1.1.2.2.3.cmml" mathsize="70%" xref="alg2.l17.m2.1.1.1.1.1.2.2.3">l</mtext></ci></apply><ci id="alg2.l17.m2.1.1.1.1.1.2.3.cmml" xref="alg2.l17.m2.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="alg2.l17.m2.1.1.1.1.1.3.cmml" xref="alg2.l17.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l17.m2.1.1.1.1.1.3.1.cmml" xref="alg2.l17.m2.1.1.1.1.1.3">subscript</csymbol><apply id="alg2.l17.m2.1.1.1.1.1.3.2.cmml" xref="alg2.l17.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l17.m2.1.1.1.1.1.3.2.1.cmml" xref="alg2.l17.m2.1.1.1.1.1.3">superscript</csymbol><ci id="alg2.l17.m2.1.1.1.1.1.3.2.2.cmml" xref="alg2.l17.m2.1.1.1.1.1.3.2.2">𝑠</ci><ci id="alg2.l17.m2.1.1.1.1.1.3.2.3a.cmml" xref="alg2.l17.m2.1.1.1.1.1.3.2.3"><mtext id="alg2.l17.m2.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="alg2.l17.m2.1.1.1.1.1.3.2.3">l</mtext></ci></apply><ci id="alg2.l17.m2.1.1.1.1.1.3.3.cmml" xref="alg2.l17.m2.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m2.1c">\pi_{\theta}(a^{\text{l}}_{k}|s^{\text{l}}_{k})</annotation><annotation encoding="application/x-llamapun" id="alg2.l17.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | italic_s start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l18.1.1.1" style="font-size:80%;">18:</span></span>      Observe the sampled item <math alttext="e_{k}" class="ltx_Math" display="inline" id="alg2.l18.m1.1"><semantics id="alg2.l18.m1.1a"><msub id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml"><mi id="alg2.l18.m1.1.1.2" xref="alg2.l18.m1.1.1.2.cmml">e</mi><mi id="alg2.l18.m1.1.1.3" xref="alg2.l18.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><apply id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.1.cmml" xref="alg2.l18.m1.1.1">subscript</csymbol><ci id="alg2.l18.m1.1.1.2.cmml" xref="alg2.l18.m1.1.1.2">𝑒</ci><ci id="alg2.l18.m1.1.1.3.cmml" xref="alg2.l18.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">e_{k}</annotation><annotation encoding="application/x-llamapun" id="alg2.l18.m1.1d">italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and append it to <math alttext="\mathbf{e}" class="ltx_Math" display="inline" id="alg2.l18.m2.1"><semantics id="alg2.l18.m2.1a"><mi id="alg2.l18.m2.1.1" xref="alg2.l18.m2.1.1.cmml">𝐞</mi><annotation-xml encoding="MathML-Content" id="alg2.l18.m2.1b"><ci id="alg2.l18.m2.1.1.cmml" xref="alg2.l18.m2.1.1">𝐞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m2.1c">\mathbf{e}</annotation><annotation encoding="application/x-llamapun" id="alg2.l18.m2.1d">bold_e</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l19.1.1.1" style="font-size:80%;">19:</span></span>      Update <math alttext="\theta" class="ltx_Math" display="inline" id="alg2.l19.m1.1"><semantics id="alg2.l19.m1.1a"><mi id="alg2.l19.m1.1.1" xref="alg2.l19.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg2.l19.m1.1b"><ci id="alg2.l19.m1.1.1.cmml" xref="alg2.l19.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l19.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg2.l19.m1.1d">italic_θ</annotation></semantics></math> by <math alttext="\triangledown_{a}Q_{w}(s^{\text{h}}_{t},a^{\text{l}}_{k})\triangledown_{\theta%
}\pi_{\theta}(s^{\text{l}}_{k})" class="ltx_Math" display="inline" id="alg2.l19.m2.3"><semantics id="alg2.l19.m2.3a"><mrow id="alg2.l19.m2.3.3" xref="alg2.l19.m2.3.3.cmml"><msub id="alg2.l19.m2.3.3.5" xref="alg2.l19.m2.3.3.5.cmml"><mi id="alg2.l19.m2.3.3.5.2" mathvariant="normal" xref="alg2.l19.m2.3.3.5.2.cmml">▽</mi><mi id="alg2.l19.m2.3.3.5.3" xref="alg2.l19.m2.3.3.5.3.cmml">a</mi></msub><mo id="alg2.l19.m2.3.3.4" xref="alg2.l19.m2.3.3.4.cmml">⁢</mo><msub id="alg2.l19.m2.3.3.6" xref="alg2.l19.m2.3.3.6.cmml"><mi id="alg2.l19.m2.3.3.6.2" xref="alg2.l19.m2.3.3.6.2.cmml">Q</mi><mi id="alg2.l19.m2.3.3.6.3" xref="alg2.l19.m2.3.3.6.3.cmml">w</mi></msub><mo id="alg2.l19.m2.3.3.4a" xref="alg2.l19.m2.3.3.4.cmml">⁢</mo><mrow id="alg2.l19.m2.2.2.2.2" xref="alg2.l19.m2.2.2.2.3.cmml"><mo id="alg2.l19.m2.2.2.2.2.3" stretchy="false" xref="alg2.l19.m2.2.2.2.3.cmml">(</mo><msubsup id="alg2.l19.m2.1.1.1.1.1" xref="alg2.l19.m2.1.1.1.1.1.cmml"><mi id="alg2.l19.m2.1.1.1.1.1.2.2" xref="alg2.l19.m2.1.1.1.1.1.2.2.cmml">s</mi><mi id="alg2.l19.m2.1.1.1.1.1.3" xref="alg2.l19.m2.1.1.1.1.1.3.cmml">t</mi><mtext id="alg2.l19.m2.1.1.1.1.1.2.3" xref="alg2.l19.m2.1.1.1.1.1.2.3a.cmml">h</mtext></msubsup><mo id="alg2.l19.m2.2.2.2.2.4" xref="alg2.l19.m2.2.2.2.3.cmml">,</mo><msubsup id="alg2.l19.m2.2.2.2.2.2" xref="alg2.l19.m2.2.2.2.2.2.cmml"><mi id="alg2.l19.m2.2.2.2.2.2.2.2" xref="alg2.l19.m2.2.2.2.2.2.2.2.cmml">a</mi><mi id="alg2.l19.m2.2.2.2.2.2.3" xref="alg2.l19.m2.2.2.2.2.2.3.cmml">k</mi><mtext id="alg2.l19.m2.2.2.2.2.2.2.3" xref="alg2.l19.m2.2.2.2.2.2.2.3a.cmml">l</mtext></msubsup><mo id="alg2.l19.m2.2.2.2.2.5" stretchy="false" xref="alg2.l19.m2.2.2.2.3.cmml">)</mo></mrow><mo id="alg2.l19.m2.3.3.4b" xref="alg2.l19.m2.3.3.4.cmml">⁢</mo><msub id="alg2.l19.m2.3.3.7" xref="alg2.l19.m2.3.3.7.cmml"><mi id="alg2.l19.m2.3.3.7.2" mathvariant="normal" xref="alg2.l19.m2.3.3.7.2.cmml">▽</mi><mi id="alg2.l19.m2.3.3.7.3" xref="alg2.l19.m2.3.3.7.3.cmml">θ</mi></msub><mo id="alg2.l19.m2.3.3.4c" xref="alg2.l19.m2.3.3.4.cmml">⁢</mo><msub id="alg2.l19.m2.3.3.8" xref="alg2.l19.m2.3.3.8.cmml"><mi id="alg2.l19.m2.3.3.8.2" xref="alg2.l19.m2.3.3.8.2.cmml">π</mi><mi id="alg2.l19.m2.3.3.8.3" xref="alg2.l19.m2.3.3.8.3.cmml">θ</mi></msub><mo id="alg2.l19.m2.3.3.4d" xref="alg2.l19.m2.3.3.4.cmml">⁢</mo><mrow id="alg2.l19.m2.3.3.3.1" xref="alg2.l19.m2.3.3.3.1.1.cmml"><mo id="alg2.l19.m2.3.3.3.1.2" stretchy="false" xref="alg2.l19.m2.3.3.3.1.1.cmml">(</mo><msubsup id="alg2.l19.m2.3.3.3.1.1" xref="alg2.l19.m2.3.3.3.1.1.cmml"><mi id="alg2.l19.m2.3.3.3.1.1.2.2" xref="alg2.l19.m2.3.3.3.1.1.2.2.cmml">s</mi><mi id="alg2.l19.m2.3.3.3.1.1.3" xref="alg2.l19.m2.3.3.3.1.1.3.cmml">k</mi><mtext id="alg2.l19.m2.3.3.3.1.1.2.3" xref="alg2.l19.m2.3.3.3.1.1.2.3a.cmml">l</mtext></msubsup><mo id="alg2.l19.m2.3.3.3.1.3" stretchy="false" xref="alg2.l19.m2.3.3.3.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l19.m2.3b"><apply id="alg2.l19.m2.3.3.cmml" xref="alg2.l19.m2.3.3"><times id="alg2.l19.m2.3.3.4.cmml" xref="alg2.l19.m2.3.3.4"></times><apply id="alg2.l19.m2.3.3.5.cmml" xref="alg2.l19.m2.3.3.5"><csymbol cd="ambiguous" id="alg2.l19.m2.3.3.5.1.cmml" xref="alg2.l19.m2.3.3.5">subscript</csymbol><ci id="alg2.l19.m2.3.3.5.2.cmml" xref="alg2.l19.m2.3.3.5.2">▽</ci><ci id="alg2.l19.m2.3.3.5.3.cmml" xref="alg2.l19.m2.3.3.5.3">𝑎</ci></apply><apply id="alg2.l19.m2.3.3.6.cmml" xref="alg2.l19.m2.3.3.6"><csymbol cd="ambiguous" id="alg2.l19.m2.3.3.6.1.cmml" xref="alg2.l19.m2.3.3.6">subscript</csymbol><ci id="alg2.l19.m2.3.3.6.2.cmml" xref="alg2.l19.m2.3.3.6.2">𝑄</ci><ci id="alg2.l19.m2.3.3.6.3.cmml" xref="alg2.l19.m2.3.3.6.3">𝑤</ci></apply><interval closure="open" id="alg2.l19.m2.2.2.2.3.cmml" xref="alg2.l19.m2.2.2.2.2"><apply id="alg2.l19.m2.1.1.1.1.1.cmml" xref="alg2.l19.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l19.m2.1.1.1.1.1.1.cmml" xref="alg2.l19.m2.1.1.1.1.1">subscript</csymbol><apply id="alg2.l19.m2.1.1.1.1.1.2.cmml" xref="alg2.l19.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l19.m2.1.1.1.1.1.2.1.cmml" xref="alg2.l19.m2.1.1.1.1.1">superscript</csymbol><ci id="alg2.l19.m2.1.1.1.1.1.2.2.cmml" xref="alg2.l19.m2.1.1.1.1.1.2.2">𝑠</ci><ci id="alg2.l19.m2.1.1.1.1.1.2.3a.cmml" xref="alg2.l19.m2.1.1.1.1.1.2.3"><mtext id="alg2.l19.m2.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="alg2.l19.m2.1.1.1.1.1.2.3">h</mtext></ci></apply><ci id="alg2.l19.m2.1.1.1.1.1.3.cmml" xref="alg2.l19.m2.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg2.l19.m2.2.2.2.2.2.cmml" xref="alg2.l19.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l19.m2.2.2.2.2.2.1.cmml" xref="alg2.l19.m2.2.2.2.2.2">subscript</csymbol><apply id="alg2.l19.m2.2.2.2.2.2.2.cmml" xref="alg2.l19.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l19.m2.2.2.2.2.2.2.1.cmml" xref="alg2.l19.m2.2.2.2.2.2">superscript</csymbol><ci id="alg2.l19.m2.2.2.2.2.2.2.2.cmml" xref="alg2.l19.m2.2.2.2.2.2.2.2">𝑎</ci><ci id="alg2.l19.m2.2.2.2.2.2.2.3a.cmml" xref="alg2.l19.m2.2.2.2.2.2.2.3"><mtext id="alg2.l19.m2.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="alg2.l19.m2.2.2.2.2.2.2.3">l</mtext></ci></apply><ci id="alg2.l19.m2.2.2.2.2.2.3.cmml" xref="alg2.l19.m2.2.2.2.2.2.3">𝑘</ci></apply></interval><apply id="alg2.l19.m2.3.3.7.cmml" xref="alg2.l19.m2.3.3.7"><csymbol cd="ambiguous" id="alg2.l19.m2.3.3.7.1.cmml" xref="alg2.l19.m2.3.3.7">subscript</csymbol><ci id="alg2.l19.m2.3.3.7.2.cmml" xref="alg2.l19.m2.3.3.7.2">▽</ci><ci id="alg2.l19.m2.3.3.7.3.cmml" xref="alg2.l19.m2.3.3.7.3">𝜃</ci></apply><apply id="alg2.l19.m2.3.3.8.cmml" xref="alg2.l19.m2.3.3.8"><csymbol cd="ambiguous" id="alg2.l19.m2.3.3.8.1.cmml" xref="alg2.l19.m2.3.3.8">subscript</csymbol><ci id="alg2.l19.m2.3.3.8.2.cmml" xref="alg2.l19.m2.3.3.8.2">𝜋</ci><ci id="alg2.l19.m2.3.3.8.3.cmml" xref="alg2.l19.m2.3.3.8.3">𝜃</ci></apply><apply id="alg2.l19.m2.3.3.3.1.1.cmml" xref="alg2.l19.m2.3.3.3.1"><csymbol cd="ambiguous" id="alg2.l19.m2.3.3.3.1.1.1.cmml" xref="alg2.l19.m2.3.3.3.1">subscript</csymbol><apply id="alg2.l19.m2.3.3.3.1.1.2.cmml" xref="alg2.l19.m2.3.3.3.1"><csymbol cd="ambiguous" id="alg2.l19.m2.3.3.3.1.1.2.1.cmml" xref="alg2.l19.m2.3.3.3.1">superscript</csymbol><ci id="alg2.l19.m2.3.3.3.1.1.2.2.cmml" xref="alg2.l19.m2.3.3.3.1.1.2.2">𝑠</ci><ci id="alg2.l19.m2.3.3.3.1.1.2.3a.cmml" xref="alg2.l19.m2.3.3.3.1.1.2.3"><mtext id="alg2.l19.m2.3.3.3.1.1.2.3.cmml" mathsize="70%" xref="alg2.l19.m2.3.3.3.1.1.2.3">l</mtext></ci></apply><ci id="alg2.l19.m2.3.3.3.1.1.3.cmml" xref="alg2.l19.m2.3.3.3.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l19.m2.3c">\triangledown_{a}Q_{w}(s^{\text{h}}_{t},a^{\text{l}}_{k})\triangledown_{\theta%
}\pi_{\theta}(s^{\text{l}}_{k})</annotation><annotation encoding="application/x-llamapun" id="alg2.l19.m2.3d">▽ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_s start_POSTSUPERSCRIPT h end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ▽ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_s start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l20.1.1.1" style="font-size:80%;">20:</span></span>    <span class="ltx_text ltx_font_bold" id="alg2.l20.2">end for</span>
</div>
<div class="ltx_listingline" id="alg2.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l21.1.1.1" style="font-size:80%;">21:</span></span>  <span class="ltx_text ltx_font_bold" id="alg2.l21.2">end for</span>
</div>
</div>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">As an on-policy RL-based methodology, our mccHRL should be evaluated by online experiments and business performance indicators such as CTR. However, the industrial recommendation system is complex and connected with enormous impressions and incomes, which makes thrugh online experiment difficult. As a remedy, we design two offline evaluation strategies. We demonstrate the effectiveness of mccHRL by both offline and live experiments, as well as ablation and sensitivity studies.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Environments</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">In order to evaluate our RL-based method, ideally we need a simulator with both cloud and edge environments, which are interactively learnable by RL agents. Unfortunately, to the best of our knowledge, there is no such test-purpose cloud-edge request simulator. Instead, we provide two remedy solutions for offline experiments, before the online deployment:</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<ol class="ltx_enumerate" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1">An RS simulator that is generated by a small-scale public dataset. We arbitrarily define some spatial and temporal related features as ‘edge features’ which is not observable by the cloud. Other features are manually implemented with some transmission latency between the edge and the cloud. The average reward during the test stage can be used as a metric for such a simulation-based system.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1">Experiment based on a large-scale industrial dataset. The offline version of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#alg1" title="Algorithm 1 ‣ 4.4.2 Training with Offline Data ‣ 4.4 Mechanism ‣ 4 Method ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> can be employed on such an offline RL (or dataset-based RL) problem, with some offline accuracy metrics to be evaluated.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">We employ both two solutions to evaluate our methodology. Implementation details are introduced in the subsequent subsections. Table <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.T2" title="Table 2 ‣ 5.1.2 Dataset-based Experiment. ‣ 5.1 Experimental Environments ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> exhibits the statistics of two experimental environments.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Simulator-based Experiment.</h4>
<div class="ltx_para" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1">Movielens <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://grouplens.org/datasets/movielens/</span></span></span> is a user-movie rating dataset including the behavior data, the user feature, and item feature data. Samples are labeled with users’ ratings on movies from 1 to 5.</p>
</div>
<div class="ltx_para" id="S5.SS1.SSS1.p2">
<p class="ltx_p" id="S5.SS1.SSS1.p2.1">Based on the MovieLens-100k dataset, We build a simulator based on the methodology introduced in <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib34" title="">2019</a>)</cite>, with the averaged ratings behaving as the RL rewards. The average rating is 3.53 over all samples. Among the user features, the spatial features including ‘occupation’ and ‘zip code’ are set as edge features, which can not be accessed by the cloud. We further assume the user cloud sequence has a fixed latency with edge sequence, <span class="ltx_text ltx_font_italic" id="S5.SS1.SSS1.p2.1.1">i.e.</span>, the cloud sequence is delayed by 6 items the edge sequence. By these configurations, we build an approximated mobile-cloud simulator, with an explicit transmission latency.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Dataset-based Experiment. </h4>
<div class="ltx_para" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.2">Because of the industrial limitations, interactive training of on-device RL is temporarily impractical. Instead, we conduct an industrial-scale experiment based on the offline dataset with realistic on-device features. Here we employ a content-based feed recommendation dataset <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://tianchi.aliyun.com/dataset/dataDetail?dataId=109858</span></span></span>, sampling from the Taobao front-page content-base recommendation and has been declared open-sourced in Tianchi. On-device features are aligned with the recommended item and corresponding click labels, and the data is reorganized into a session-wise form. The recommendation objective is to maximize the click-through rate (CTR). We denote user app-related behaviors sampled on the device as <math alttext="m" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.1.m1.1"><semantics id="S5.SS1.SSS2.p1.1.m1.1a"><mi id="S5.SS1.SSS2.p1.1.m1.1.1" xref="S5.SS1.SSS2.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.1.m1.1b"><ci id="S5.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.1.m1.1d">italic_m</annotation></semantics></math>, including app IDs, stay-times, and LBS information in the granularity of districts. The spatiotemporal information in <math alttext="c^{o}" class="ltx_Math" display="inline" id="S5.SS1.SSS2.p1.2.m2.1"><semantics id="S5.SS1.SSS2.p1.2.m2.1a"><msup id="S5.SS1.SSS2.p1.2.m2.1.1" xref="S5.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="S5.SS1.SSS2.p1.2.m2.1.1.2" xref="S5.SS1.SSS2.p1.2.m2.1.1.2.cmml">c</mi><mi id="S5.SS1.SSS2.p1.2.m2.1.1.3" xref="S5.SS1.SSS2.p1.2.m2.1.1.3.cmml">o</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.2.m2.1b"><apply id="S5.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1">superscript</csymbol><ci id="S5.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1.2">𝑐</ci><ci id="S5.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.2.m2.1c">c^{o}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS2.p1.2.m2.1d">italic_c start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT</annotation></semantics></math> including POI, province, city, day, hour, and workday/weekend labels. We further assume the user cloud sequence has a fixed latency with edge sequence, <span class="ltx_text ltx_font_italic" id="S5.SS1.SSS2.p1.2.1">i.e.</span>, the cloud sequence is delayed by 10 items the edge sequence.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Statistics of datasets.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T2.1">
<tr class="ltx_tr" id="S5.T2.1.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.1.2.1">Dataset</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.1.2.2">set</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.1.2.3">#impression</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.1.2.4">#user</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.1.2.5">#item</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.1.2.6">CTR</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.3.1" rowspan="6"><span class="ltx_text" id="S5.T2.1.3.1.1">Movielens</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.3.2">All</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.3.3">100000</td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T2.1.3.4"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T2.1.3.5"></td>
<td class="ltx_td ltx_border_t" id="S5.T2.1.3.6"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.1">rate=1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.2">6110</td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.4.3"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.4.4"></td>
<td class="ltx_td" id="S5.T2.1.4.5"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.5.1">rate=2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.5.2">11370</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.5.3">943</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.5.4">1602</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.5.5">-</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.6.1">rate=3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.6.2">27145</td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.6.3"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.6.4"></td>
<td class="ltx_td" id="S5.T2.1.6.5"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.7.1">rate=4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.7.2">34174</td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.7.3"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.7.4"></td>
<td class="ltx_td" id="S5.T2.1.7.5"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.8.1">rate=5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.8.2">21201</td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.8.3"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.8.4"></td>
<td class="ltx_td" id="S5.T2.1.8.5"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.9">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.1.9.1" rowspan="3"><span class="ltx_text" id="S5.T2.1.9.1.1">Alibaba</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.9.2">All</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.9.3">265003</td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T2.1.9.4"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S5.T2.1.9.5"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.9.6">4.92%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.1">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.1.1">day=3<math alttext="\sim" class="ltx_Math" display="inline" id="S5.T2.1.1.1.m1.1"><semantics id="S5.T2.1.1.1.m1.1a"><mo id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S5.T2.1.1.1.m1.1d">∼</annotation></semantics></math>9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.1.2">226508</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.1.3">34708</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.1.4">8</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.1.5">4.85%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.10">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.1.10.1">day=10</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T2.1.10.2">38495</td>
<td class="ltx_td ltx_border_bb ltx_border_r" id="S5.T2.1.10.3"></td>
<td class="ltx_td ltx_border_bb ltx_border_r" id="S5.T2.1.10.4"></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.10.5">5.37%</td>
</tr>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We define different evaluation metrics according to the characteristics of two experimental environments:</p>
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.2">Simulator-based Experiment.: the expected reward indicates the policy performance in an interactive environment. The rating employed for evaluation is retrieved from the most similar occurrence (with a cos similarity by user and item embeddings) in the dataset. Such test stage is repeated for 50 rounds and the final averaged metric is reported. We evaluate it by the average rating during the test stage of the experiment, which is denoted by <span class="ltx_text ltx_font_italic" id="S5.I2.i1.p1.2.2">S-<math alttext="&lt;" class="ltx_Math" display="inline" id="S5.I2.i1.p1.1.1.m1.1"><semantics id="S5.I2.i1.p1.1.1.m1.1a"><mo id="S5.I2.i1.p1.1.1.m1.1.1" xref="S5.I2.i1.p1.1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S5.I2.i1.p1.1.1.m1.1b"><lt id="S5.I2.i1.p1.1.1.m1.1.1.cmml" xref="S5.I2.i1.p1.1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S5.I2.i1.p1.1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S5.I2.i1.p1.1.1.m1.1d">&lt;</annotation></semantics></math>rating<math alttext="&gt;" class="ltx_Math" display="inline" id="S5.I2.i1.p1.2.2.m2.1"><semantics id="S5.I2.i1.p1.2.2.m2.1a"><mo id="S5.I2.i1.p1.2.2.m2.1.1" xref="S5.I2.i1.p1.2.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S5.I2.i1.p1.2.2.m2.1b"><gt id="S5.I2.i1.p1.2.2.m2.1.1.cmml" xref="S5.I2.i1.p1.2.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S5.I2.i1.p1.2.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.I2.i1.p1.2.2.m2.1d">&gt;</annotation></semantics></math></span>.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1">Dataset-based Experiment.: the general solution is to convert the online CTR maximization into an offline binary classification problem, <span class="ltx_text ltx_font_italic" id="S5.I2.i2.p1.1.1">i.e.</span> predict if the user clicks or not. We use Area Under the ROC Curve (AUC) to evaluate this classification performance, in which we employ the actor’s servicing score as the prediction and the ground-truth click record as the label. We name it as <span class="ltx_text ltx_font_italic" id="S5.I2.i2.p1.1.2">D-AUC</span>.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Implementation Details</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.T3" title="Table 3 ‣ 5.3 Implementation Details ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> shows some hyper-parameters of two experiments. Further implementation details are listed below.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Parameter Settings.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T3.8.8">
<tr class="ltx_tr" id="S5.T3.8.8.9">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.8.8.9.1">Hyper-parameter</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.8.8.9.2">Simulator-based Experiment</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.8.8.9.3">Dataset-based Experiment</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.1"><math alttext="K" class="ltx_Math" display="inline" id="S5.T3.1.1.1.1.m1.1"><semantics id="S5.T3.1.1.1.1.m1.1a"><mi id="S5.T3.1.1.1.1.m1.1.1" xref="S5.T3.1.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.T3.1.1.1.1.m1.1d">italic_K</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.2">4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.1.1.3">6</td>
</tr>
<tr class="ltx_tr" id="S5.T3.2.2.2">
<td class="ltx_td ltx_align_center" id="S5.T3.2.2.2.1"><math alttext="\gamma" class="ltx_Math" display="inline" id="S5.T3.2.2.2.1.m1.1"><semantics id="S5.T3.2.2.2.1.m1.1a"><mi id="S5.T3.2.2.2.1.m1.1.1" xref="S5.T3.2.2.2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.1.m1.1b"><ci id="S5.T3.2.2.2.1.m1.1.1.cmml" xref="S5.T3.2.2.2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.T3.2.2.2.1.m1.1d">italic_γ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T3.2.2.2.2">0.99</td>
<td class="ltx_td ltx_align_center" id="S5.T3.2.2.2.3">0.9</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.3.3">
<td class="ltx_td ltx_align_center" id="S5.T3.3.3.3.1"><math alttext="L" class="ltx_Math" display="inline" id="S5.T3.3.3.3.1.m1.1"><semantics id="S5.T3.3.3.3.1.m1.1a"><mi id="S5.T3.3.3.3.1.m1.1.1" xref="S5.T3.3.3.3.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.1.m1.1b"><ci id="S5.T3.3.3.3.1.m1.1.1.cmml" xref="S5.T3.3.3.3.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S5.T3.3.3.3.1.m1.1d">italic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.3.3.2">128</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.3.3.3">16</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.4.4">
<td class="ltx_td ltx_align_center" id="S5.T3.4.4.4.1"><math alttext="N" class="ltx_Math" display="inline" id="S5.T3.4.4.4.1.m1.1"><semantics id="S5.T3.4.4.4.1.m1.1a"><mi id="S5.T3.4.4.4.1.m1.1.1" xref="S5.T3.4.4.4.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.4.1.m1.1b"><ci id="S5.T3.4.4.4.1.m1.1.1.cmml" xref="S5.T3.4.4.4.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.4.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S5.T3.4.4.4.1.m1.1d">italic_N</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T3.4.4.4.2">64</td>
<td class="ltx_td ltx_align_center" id="S5.T3.4.4.4.3">512</td>
</tr>
<tr class="ltx_tr" id="S5.T3.5.5.5">
<td class="ltx_td ltx_align_center" id="S5.T3.5.5.5.1"><math alttext="\eta" class="ltx_Math" display="inline" id="S5.T3.5.5.5.1.m1.1"><semantics id="S5.T3.5.5.5.1.m1.1a"><mi id="S5.T3.5.5.5.1.m1.1.1" xref="S5.T3.5.5.5.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S5.T3.5.5.5.1.m1.1b"><ci id="S5.T3.5.5.5.1.m1.1.1.cmml" xref="S5.T3.5.5.5.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.5.5.1.m1.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S5.T3.5.5.5.1.m1.1d">italic_η</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.5.5.2">0.001 (HRA), 0.0001 (LRA)</td>
<td class="ltx_td ltx_align_center" id="S5.T3.5.5.5.3">0.0001</td>
</tr>
<tr class="ltx_tr" id="S5.T3.6.6.6">
<td class="ltx_td ltx_align_center" id="S5.T3.6.6.6.1"><math alttext="\tau" class="ltx_Math" display="inline" id="S5.T3.6.6.6.1.m1.1"><semantics id="S5.T3.6.6.6.1.m1.1a"><mi id="S5.T3.6.6.6.1.m1.1.1" xref="S5.T3.6.6.6.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.T3.6.6.6.1.m1.1b"><ci id="S5.T3.6.6.6.1.m1.1.1.cmml" xref="S5.T3.6.6.6.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.6.6.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S5.T3.6.6.6.1.m1.1d">italic_τ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.6.6.2">0.001</td>
<td class="ltx_td ltx_align_center" id="S5.T3.6.6.6.3">0.001</td>
</tr>
<tr class="ltx_tr" id="S5.T3.7.7.7">
<td class="ltx_td ltx_align_center" id="S5.T3.7.7.7.1"><math alttext="N^{l}" class="ltx_Math" display="inline" id="S5.T3.7.7.7.1.m1.1"><semantics id="S5.T3.7.7.7.1.m1.1a"><msup id="S5.T3.7.7.7.1.m1.1.1" xref="S5.T3.7.7.7.1.m1.1.1.cmml"><mi id="S5.T3.7.7.7.1.m1.1.1.2" xref="S5.T3.7.7.7.1.m1.1.1.2.cmml">N</mi><mi id="S5.T3.7.7.7.1.m1.1.1.3" xref="S5.T3.7.7.7.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S5.T3.7.7.7.1.m1.1b"><apply id="S5.T3.7.7.7.1.m1.1.1.cmml" xref="S5.T3.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.7.7.7.1.m1.1.1.1.cmml" xref="S5.T3.7.7.7.1.m1.1.1">superscript</csymbol><ci id="S5.T3.7.7.7.1.m1.1.1.2.cmml" xref="S5.T3.7.7.7.1.m1.1.1.2">𝑁</ci><ci id="S5.T3.7.7.7.1.m1.1.1.3.cmml" xref="S5.T3.7.7.7.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.7.7.1.m1.1c">N^{l}</annotation><annotation encoding="application/x-llamapun" id="S5.T3.7.7.7.1.m1.1d">italic_N start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S5.T3.7.7.7.2">12</td>
<td class="ltx_td ltx_align_center" id="S5.T3.7.7.7.3">50</td>
</tr>
<tr class="ltx_tr" id="S5.T3.8.8.8">
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.8.8.8.1"><math alttext="\alpha" class="ltx_Math" display="inline" id="S5.T3.8.8.8.1.m1.1"><semantics id="S5.T3.8.8.8.1.m1.1a"><mi id="S5.T3.8.8.8.1.m1.1.1" xref="S5.T3.8.8.8.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T3.8.8.8.1.m1.1b"><ci id="S5.T3.8.8.8.1.m1.1.1.cmml" xref="S5.T3.8.8.8.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.8.8.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S5.T3.8.8.8.1.m1.1d">italic_α</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.8.8.8.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.8.8.8.3">0.1</td>
</tr>
</table>
</figure>
<section class="ltx_subsubsection" id="S5.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.1 </span>Simulator-based Experiment.</h4>
<div class="ltx_para" id="S5.SS3.SSS1.p1">
<p class="ltx_p" id="S5.SS3.SSS1.p1.1">MLP in critic has hidden units of [32, 16, 1] with the last activation as tanh; while MLP in actor has hidden units of [128, K]. The latent state dimension is 16 for both GRU and SRE components. We use an Adam optimizer to interactively train the critic and actor, with a learning rate of 0.0001. Performance is evaluated by iterating all users among the training set, while for each ground truth item, the policy selects top-<math alttext="K" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p1.1.m1.1"><semantics id="S5.SS3.SSS1.p1.1.m1.1a"><mi id="S5.SS3.SSS1.p1.1.m1.1.1" xref="S5.SS3.SSS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p1.1.m1.1b"><ci id="S5.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS3.SSS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p1.1.m1.1d">italic_K</annotation></semantics></math> items based on scores. Because the size of MovieLens-100k is relatively small, we omit the DIN structure here to avoid overfitting</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.2 </span>Dataset-based Experiment.</h4>
<div class="ltx_para" id="S5.SS3.SSS2.p1">
<p class="ltx_p" id="S5.SS3.SSS2.p1.1">The DIN layer of critic uses a multi-head target attention structure, with the last session embedding vector as the target. The attention mode is cosine. The deepFM layer of critic is composed of linear terms and 2nd-order cross terms. MLP in critic has hidden units of [128, 64, 32, 1] with the last activation as tanh; while MLP in actor has hidden units of [64, 32, K] with all activation as relu. The latent state dimension is 16 for both GRU and SRE components. We use the Adam optimizer with a learning rate of 0.0001, 1st-regularization weight of 0.0001 and 2nd-regularization weight of 0.00001. Data on the last day (day = 10) is classified into the test set while the other consists of the training set. To help the training converge, we first conduct 3 epochs of supervised learning, with the binary cross-entropy loss of the click label. RL then conducts 2 more epochs. The training ends with convergence, costing about 17000 steps. Training is ruuning on an industrial-scale, parallel training platform, with each experiment allocated with 8 GPUs and 20000M RAM.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Baselines</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">The following experimental baselines are employed to compare with our mccHRL:</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<ul class="ltx_itemize" id="S5.I3">
<li class="ltx_item" id="S5.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i1.p1">
<p class="ltx_p" id="S5.I3.i1.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I3.i1.p1.1.1">Random</span>: the policy picks the recommended item from the candidates set randomly. Only implemented in the simulator experiment.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i2.p1">
<p class="ltx_p" id="S5.I3.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I3.i2.p1.1.1">DIN</span>: the Deep Interest Network <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib37" title="">2018</a>)</cite>, as a standardized solution of industrial pointwise CTR model.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i3.p1">
<p class="ltx_p" id="S5.I3.i3.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I3.i3.p1.1.1">DIN</span>(ideal): the DIN model (which is deployed on the cloud) can have full access to edge features with exact zero latency. Therefore, it indicates an unrealistic performance upper bound for a generic supervised model. Only implemented in the industrial experiment.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i4.p1">
<p class="ltx_p" id="S5.I3.i4.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I3.i4.p1.1.1">GRU4rec</span>: a session-based method with a latent state calculated by GRU <cite class="ltx_cite ltx_citemacro_cite">Hidasi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib10" title="">2016</a>)</cite>, therefore considers the intra-session context.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i5.p1">
<p class="ltx_p" id="S5.I3.i5.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I3.i5.p1.1.1">LIRD</span>: a DDPG-based RL listwise ranking framework <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib34" title="">2019</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i6.p1">
<p class="ltx_p" id="S5.I3.i6.p1.1"><span class="ltx_text ltx_font_italic" id="S5.I3.i6.p1.1.1">MC<sup class="ltx_sup" id="S5.I3.i6.p1.1.1.1"><span class="ltx_text ltx_font_upright" id="S5.I3.i6.p1.1.1.1.1">2</span></sup>-SF</span>: a slow-fast training framework based on moble-cloud collaboration <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#bib.bib5" title="">2021</a>)</cite>, with mobile features incorporated and considered.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Offline Experiment Results</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T4.21.21">
<tr class="ltx_tr" id="S5.T4.2.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.2.2.3">Experiment</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.2.2.2">S-<math alttext="&lt;" class="ltx_Math" display="inline" id="S5.T4.1.1.1.1.m1.1"><semantics id="S5.T4.1.1.1.1.m1.1a"><mo id="S5.T4.1.1.1.1.m1.1.1" xref="S5.T4.1.1.1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.1.m1.1b"><lt id="S5.T4.1.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S5.T4.1.1.1.1.m1.1d">&lt;</annotation></semantics></math>rating<math alttext="&gt;" class="ltx_Math" display="inline" id="S5.T4.2.2.2.2.m2.1"><semantics id="S5.T4.2.2.2.2.m2.1a"><mo id="S5.T4.2.2.2.2.m2.1.1" xref="S5.T4.2.2.2.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.2.2.m2.1b"><gt id="S5.T4.2.2.2.2.m2.1.1.cmml" xref="S5.T4.2.2.2.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.2.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T4.2.2.2.2.m2.1d">&gt;</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.2.2.4">D-AUC</td>
</tr>
<tr class="ltx_tr" id="S5.T4.3.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.3.3.2">random</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.3.3.1">3.583 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.3.3.3.1.m1.1"><semantics id="S5.T4.3.3.3.1.m1.1a"><mo id="S5.T4.3.3.3.1.m1.1.1" xref="S5.T4.3.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.3.3.3.1.m1.1b"><csymbol cd="latexml" id="S5.T4.3.3.3.1.m1.1.1.cmml" xref="S5.T4.3.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.3.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.3.3.3.1.m1.1d">±</annotation></semantics></math> 0.034</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.3.3.3.3">-</td>
</tr>
<tr class="ltx_tr" id="S5.T4.5.5.5">
<td class="ltx_td ltx_align_center" id="S5.T4.5.5.5.3">DIN</td>
<td class="ltx_td ltx_align_center" id="S5.T4.4.4.4.1">3.767 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.4.4.4.1.m1.1"><semantics id="S5.T4.4.4.4.1.m1.1a"><mo id="S5.T4.4.4.4.1.m1.1.1" xref="S5.T4.4.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.4.4.4.1.m1.1b"><csymbol cd="latexml" id="S5.T4.4.4.4.1.m1.1.1.cmml" xref="S5.T4.4.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.4.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.4.4.4.1.m1.1d">±</annotation></semantics></math> 0.045</td>
<td class="ltx_td ltx_align_center" id="S5.T4.5.5.5.2">0.781 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.5.5.5.2.m1.1"><semantics id="S5.T4.5.5.5.2.m1.1a"><mo id="S5.T4.5.5.5.2.m1.1.1" xref="S5.T4.5.5.5.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.5.5.5.2.m1.1b"><csymbol cd="latexml" id="S5.T4.5.5.5.2.m1.1.1.cmml" xref="S5.T4.5.5.5.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.5.5.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.5.5.5.2.m1.1d">±</annotation></semantics></math> 0.006</td>
</tr>
<tr class="ltx_tr" id="S5.T4.6.6.6">
<td class="ltx_td ltx_align_center" id="S5.T4.6.6.6.2">DIN(ideal)</td>
<td class="ltx_td ltx_align_center" id="S5.T4.6.6.6.3">-</td>
<td class="ltx_td ltx_align_center" id="S5.T4.6.6.6.1">0.832 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.6.6.6.1.m1.1"><semantics id="S5.T4.6.6.6.1.m1.1a"><mo id="S5.T4.6.6.6.1.m1.1.1" xref="S5.T4.6.6.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.6.6.6.1.m1.1b"><csymbol cd="latexml" id="S5.T4.6.6.6.1.m1.1.1.cmml" xref="S5.T4.6.6.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.6.6.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.6.6.6.1.m1.1d">±</annotation></semantics></math> 0.008</td>
</tr>
<tr class="ltx_tr" id="S5.T4.8.8.8">
<td class="ltx_td ltx_align_center" id="S5.T4.8.8.8.3">GRU4rec</td>
<td class="ltx_td ltx_align_center" id="S5.T4.7.7.7.1">3.624 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.7.7.7.1.m1.1"><semantics id="S5.T4.7.7.7.1.m1.1a"><mo id="S5.T4.7.7.7.1.m1.1.1" xref="S5.T4.7.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.7.7.7.1.m1.1b"><csymbol cd="latexml" id="S5.T4.7.7.7.1.m1.1.1.cmml" xref="S5.T4.7.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.7.7.7.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.7.7.7.1.m1.1d">±</annotation></semantics></math> 0.038</td>
<td class="ltx_td ltx_align_center" id="S5.T4.8.8.8.2">0.731 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.8.8.8.2.m1.1"><semantics id="S5.T4.8.8.8.2.m1.1a"><mo id="S5.T4.8.8.8.2.m1.1.1" xref="S5.T4.8.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.8.8.8.2.m1.1b"><csymbol cd="latexml" id="S5.T4.8.8.8.2.m1.1.1.cmml" xref="S5.T4.8.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.8.8.8.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.8.8.8.2.m1.1d">±</annotation></semantics></math> 0.007</td>
</tr>
<tr class="ltx_tr" id="S5.T4.10.10.10">
<td class="ltx_td ltx_align_center" id="S5.T4.10.10.10.3">LIRD</td>
<td class="ltx_td ltx_align_center" id="S5.T4.9.9.9.1">3.786 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.9.9.9.1.m1.1"><semantics id="S5.T4.9.9.9.1.m1.1a"><mo id="S5.T4.9.9.9.1.m1.1.1" xref="S5.T4.9.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.9.9.9.1.m1.1b"><csymbol cd="latexml" id="S5.T4.9.9.9.1.m1.1.1.cmml" xref="S5.T4.9.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.9.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.9.9.9.1.m1.1d">±</annotation></semantics></math> 0.051</td>
<td class="ltx_td ltx_align_center" id="S5.T4.10.10.10.2">0.631 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.10.10.10.2.m1.1"><semantics id="S5.T4.10.10.10.2.m1.1a"><mo id="S5.T4.10.10.10.2.m1.1.1" xref="S5.T4.10.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.10.10.10.2.m1.1b"><csymbol cd="latexml" id="S5.T4.10.10.10.2.m1.1.1.cmml" xref="S5.T4.10.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.10.10.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.10.10.10.2.m1.1d">±</annotation></semantics></math> 0.007</td>
</tr>
<tr class="ltx_tr" id="S5.T4.13.13.13">
<td class="ltx_td ltx_align_center" id="S5.T4.11.11.11.1">MC<sup class="ltx_sup" id="S5.T4.11.11.11.1.1">2</sup>-SF</td>
<td class="ltx_td ltx_align_center" id="S5.T4.12.12.12.2">3.733 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.12.12.12.2.m1.1"><semantics id="S5.T4.12.12.12.2.m1.1a"><mo id="S5.T4.12.12.12.2.m1.1.1" xref="S5.T4.12.12.12.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.12.12.12.2.m1.1b"><csymbol cd="latexml" id="S5.T4.12.12.12.2.m1.1.1.cmml" xref="S5.T4.12.12.12.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.12.12.12.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.12.12.12.2.m1.1d">±</annotation></semantics></math> 0.050</td>
<td class="ltx_td ltx_align_center" id="S5.T4.13.13.13.3">0.769 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.13.13.13.3.m1.1"><semantics id="S5.T4.13.13.13.3.m1.1a"><mo id="S5.T4.13.13.13.3.m1.1.1" xref="S5.T4.13.13.13.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.13.13.13.3.m1.1b"><csymbol cd="latexml" id="S5.T4.13.13.13.3.m1.1.1.cmml" xref="S5.T4.13.13.13.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.13.13.13.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.13.13.13.3.m1.1d">±</annotation></semantics></math> 0.010</td>
</tr>
<tr class="ltx_tr" id="S5.T4.15.15.15">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.15.15.15.3">mccHRL</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.14.14.14.1">
<span class="ltx_text ltx_font_bold" id="S5.T4.14.14.14.1.1">3.824</span> <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.14.14.14.1.m1.1"><semantics id="S5.T4.14.14.14.1.m1.1a"><mo id="S5.T4.14.14.14.1.m1.1.1" xref="S5.T4.14.14.14.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.14.14.14.1.m1.1b"><csymbol cd="latexml" id="S5.T4.14.14.14.1.m1.1.1.cmml" xref="S5.T4.14.14.14.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.14.14.14.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.14.14.14.1.m1.1d">±</annotation></semantics></math> 0.049</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.15.15.15.2">
<span class="ltx_text ltx_font_bold" id="S5.T4.15.15.15.2.1">0.853</span> <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.15.15.15.2.m1.1"><semantics id="S5.T4.15.15.15.2.m1.1a"><mo id="S5.T4.15.15.15.2.m1.1.1" xref="S5.T4.15.15.15.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.15.15.15.2.m1.1b"><csymbol cd="latexml" id="S5.T4.15.15.15.2.m1.1.1.cmml" xref="S5.T4.15.15.15.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.15.15.15.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.15.15.15.2.m1.1d">±</annotation></semantics></math> 0.009</td>
</tr>
<tr class="ltx_tr" id="S5.T4.17.17.17">
<td class="ltx_td ltx_align_center" id="S5.T4.17.17.17.3">mccHRL(wo edge)</td>
<td class="ltx_td ltx_align_center" id="S5.T4.16.16.16.1">3.746 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.16.16.16.1.m1.1"><semantics id="S5.T4.16.16.16.1.m1.1a"><mo id="S5.T4.16.16.16.1.m1.1.1" xref="S5.T4.16.16.16.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.16.16.16.1.m1.1b"><csymbol cd="latexml" id="S5.T4.16.16.16.1.m1.1.1.cmml" xref="S5.T4.16.16.16.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.16.16.16.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.16.16.16.1.m1.1d">±</annotation></semantics></math> 0.046</td>
<td class="ltx_td ltx_align_center" id="S5.T4.17.17.17.2">0.787 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.17.17.17.2.m1.1"><semantics id="S5.T4.17.17.17.2.m1.1a"><mo id="S5.T4.17.17.17.2.m1.1.1" xref="S5.T4.17.17.17.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.17.17.17.2.m1.1b"><csymbol cd="latexml" id="S5.T4.17.17.17.2.m1.1.1.cmml" xref="S5.T4.17.17.17.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.17.17.17.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.17.17.17.2.m1.1d">±</annotation></semantics></math> 0.009</td>
</tr>
<tr class="ltx_tr" id="S5.T4.19.19.19">
<td class="ltx_td ltx_align_center" id="S5.T4.19.19.19.3">mccHRL(wo actor)</td>
<td class="ltx_td ltx_align_center" id="S5.T4.18.18.18.1">3.770 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.18.18.18.1.m1.1"><semantics id="S5.T4.18.18.18.1.m1.1a"><mo id="S5.T4.18.18.18.1.m1.1.1" xref="S5.T4.18.18.18.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.18.18.18.1.m1.1b"><csymbol cd="latexml" id="S5.T4.18.18.18.1.m1.1.1.cmml" xref="S5.T4.18.18.18.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.18.18.18.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.18.18.18.1.m1.1d">±</annotation></semantics></math> 0.045</td>
<td class="ltx_td ltx_align_center" id="S5.T4.19.19.19.2">0.707 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.19.19.19.2.m1.1"><semantics id="S5.T4.19.19.19.2.m1.1a"><mo id="S5.T4.19.19.19.2.m1.1.1" xref="S5.T4.19.19.19.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.19.19.19.2.m1.1b"><csymbol cd="latexml" id="S5.T4.19.19.19.2.m1.1.1.cmml" xref="S5.T4.19.19.19.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.19.19.19.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.19.19.19.2.m1.1d">±</annotation></semantics></math> 0.008</td>
</tr>
<tr class="ltx_tr" id="S5.T4.21.21.21">
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.21.21.21.3">mccHRL(wo critic)</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.20.20.20.1">3.587 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.20.20.20.1.m1.1"><semantics id="S5.T4.20.20.20.1.m1.1a"><mo id="S5.T4.20.20.20.1.m1.1.1" xref="S5.T4.20.20.20.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.20.20.20.1.m1.1b"><csymbol cd="latexml" id="S5.T4.20.20.20.1.m1.1.1.cmml" xref="S5.T4.20.20.20.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.20.20.20.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.20.20.20.1.m1.1d">±</annotation></semantics></math> 0.048</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.21.21.21.2">0.676 <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T4.21.21.21.2.m1.1"><semantics id="S5.T4.21.21.21.2.m1.1a"><mo id="S5.T4.21.21.21.2.m1.1.1" xref="S5.T4.21.21.21.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.21.21.21.2.m1.1b"><csymbol cd="latexml" id="S5.T4.21.21.21.2.m1.1.1.cmml" xref="S5.T4.21.21.21.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.21.21.21.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S5.T4.21.21.21.2.m1.1d">±</annotation></semantics></math> 0.008</td>
</tr>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Offline Results</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">We compare the offline experimental performance of mccHRL and baselines in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.T4" title="Table 4 ‣ 5.4 Baselines ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. mccHRL outperforms other baselines in both experiments. Specifically, the improvement of mccHRL on the industrial experiment is more evident, since this experiment has substantial on-edge features, and user behaviors are more responsible for session-wise exhibition and industrial computational latency.</p>
</div>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.1">Comparison with baselines could highlight more information. For example, LIRD is the second-best method in the simulator experiment since its RL nature fits the interactive environment. However, it does not perform well in the industrial experiment, probably because that it does not have the offline training correction. GRU4rec studies the intra-session context by a GRU unit but is not enough for our industrial experiment in which the outra-session context is also important. MC<sup class="ltx_sup" id="S5.SS5.p2.1.1">2</sup>-SF could provide reasonable performance with consideration of mobile features but lack the RL logic compared with our mccHRL. Finally, DIN(ideal) has a similar performance with mccHRL, indicating that a SOTA, supervised learned model could also perform well with immediate access to edge features, as well as no edge-cloud transmission latency. However, this assumption is obviously impractical in the real world.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6 </span>Ablation Study</h3>
<div class="ltx_para" id="S5.SS6.p1">
<p class="ltx_p" id="S5.SS6.p1.1">Compared with previously published works, our mccHRL has several novel components therefore their ablation studies are necessary. Table <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.T4" title="Table 4 ‣ 5.4 Baselines ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> also illustrates the results of the following attempts:</p>
<ul class="ltx_itemize" id="S5.I4">
<li class="ltx_item" id="S5.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i1.p1">
<p class="ltx_p" id="S5.I4.i1.p1.1">mccHRL(wo edge): the mccHRL approach with only cloud-based features.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i2.p1">
<p class="ltx_p" id="S5.I4.i2.p1.1">mccHRL(wo actor): the mccHRL but without the actor. We simply use <math alttext="\arg\max Q" class="ltx_Math" display="inline" id="S5.I4.i2.p1.1.m1.1"><semantics id="S5.I4.i2.p1.1.m1.1a"><mrow id="S5.I4.i2.p1.1.m1.1.1" xref="S5.I4.i2.p1.1.m1.1.1.cmml"><mi id="S5.I4.i2.p1.1.m1.1.1.1" xref="S5.I4.i2.p1.1.m1.1.1.1.cmml">arg</mi><mo id="S5.I4.i2.p1.1.m1.1.1a" lspace="0.167em" xref="S5.I4.i2.p1.1.m1.1.1.cmml">⁡</mo><mrow id="S5.I4.i2.p1.1.m1.1.1.2" xref="S5.I4.i2.p1.1.m1.1.1.2.cmml"><mi id="S5.I4.i2.p1.1.m1.1.1.2.1" xref="S5.I4.i2.p1.1.m1.1.1.2.1.cmml">max</mi><mo id="S5.I4.i2.p1.1.m1.1.1.2a" lspace="0.167em" xref="S5.I4.i2.p1.1.m1.1.1.2.cmml">⁡</mo><mi id="S5.I4.i2.p1.1.m1.1.1.2.2" xref="S5.I4.i2.p1.1.m1.1.1.2.2.cmml">Q</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.I4.i2.p1.1.m1.1b"><apply id="S5.I4.i2.p1.1.m1.1.1.cmml" xref="S5.I4.i2.p1.1.m1.1.1"><arg id="S5.I4.i2.p1.1.m1.1.1.1.cmml" xref="S5.I4.i2.p1.1.m1.1.1.1"></arg><apply id="S5.I4.i2.p1.1.m1.1.1.2.cmml" xref="S5.I4.i2.p1.1.m1.1.1.2"><max id="S5.I4.i2.p1.1.m1.1.1.2.1.cmml" xref="S5.I4.i2.p1.1.m1.1.1.2.1"></max><ci id="S5.I4.i2.p1.1.m1.1.1.2.2.cmml" xref="S5.I4.i2.p1.1.m1.1.1.2.2">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I4.i2.p1.1.m1.1c">\arg\max Q</annotation><annotation encoding="application/x-llamapun" id="S5.I4.i2.p1.1.m1.1d">roman_arg roman_max italic_Q</annotation></semantics></math> to determine the favorable item selection.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i3.p1">
<p class="ltx_p" id="S5.I4.i3.p1.1">mccHRL(wo critic): the mccHRL but without the critic. An item selection policy is trained offline and is deployed on the device for service.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S5.SS6.p1.2">Not surprisingly, mccHRL still has the best performance, suggesting that the critic, the actor, and edge-based features are all crucial. Note that mccHRL(wo critic) has the worst performance since it suffers from the sparse reward problem.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.7 </span>Sensitivity Study</h3>
<div class="ltx_para" id="S5.SS7.p1">
<p class="ltx_p" id="S5.SS7.p1.1">There is always a trade-off between performance and speed for the edge-based model, due to limited resources on the edge side. To have a clear picture, we choose an important factor, the user behavior sequence length kept by the edge model, to have sensitivity analysis. We inspect its impact from the following two aspects:</p>
<ol class="ltx_enumerate" id="S5.I5">
<li class="ltx_item" id="S5.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S5.I5.i1.p1">
<p class="ltx_p" id="S5.I5.i1.p1.1">The latency between cloud and edge sequence update. Since the detailed value of time latency is highly subject to the cloud and edge real-time conditions, here we pick an approximate number, the number of items such that cloud is behind the edge sequence. With this number larger, LRA could maintain more information but with a more computational cost.</p>
</div>
</li>
<li class="ltx_item" id="S5.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S5.I5.i2.p1">
<p class="ltx_p" id="S5.I5.i2.p1.1">The length of behavior sequence studied by <math alttext="s^{\text{l}}" class="ltx_Math" display="inline" id="S5.I5.i2.p1.1.m1.1"><semantics id="S5.I5.i2.p1.1.m1.1a"><msup id="S5.I5.i2.p1.1.m1.1.1" xref="S5.I5.i2.p1.1.m1.1.1.cmml"><mi id="S5.I5.i2.p1.1.m1.1.1.2" xref="S5.I5.i2.p1.1.m1.1.1.2.cmml">s</mi><mtext id="S5.I5.i2.p1.1.m1.1.1.3" xref="S5.I5.i2.p1.1.m1.1.1.3a.cmml">l</mtext></msup><annotation-xml encoding="MathML-Content" id="S5.I5.i2.p1.1.m1.1b"><apply id="S5.I5.i2.p1.1.m1.1.1.cmml" xref="S5.I5.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.I5.i2.p1.1.m1.1.1.1.cmml" xref="S5.I5.i2.p1.1.m1.1.1">superscript</csymbol><ci id="S5.I5.i2.p1.1.m1.1.1.2.cmml" xref="S5.I5.i2.p1.1.m1.1.1.2">𝑠</ci><ci id="S5.I5.i2.p1.1.m1.1.1.3a.cmml" xref="S5.I5.i2.p1.1.m1.1.1.3"><mtext id="S5.I5.i2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.I5.i2.p1.1.m1.1.1.3">l</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I5.i2.p1.1.m1.1c">s^{\text{l}}</annotation><annotation encoding="application/x-llamapun" id="S5.I5.i2.p1.1.m1.1d">italic_s start_POSTSUPERSCRIPT l end_POSTSUPERSCRIPT</annotation></semantics></math> in LRA. If this number is larger, LRA could provide more historical information to policy but the model size is expected to increase.
</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S5.SS7.p2">
<p class="ltx_p" id="S5.SS7.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.F4" title="Figure 4 ‣ 5.7 Sensitivity Study ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> shows the sensitivity results of the above two factors. Not surprisingly, the model performance deteriorates as latency becomes larger according to Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.F4" title="Figure 4 ‣ 5.7 Sensitivity Study ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> (Left), indicating that the edge model memory is a positive factor. However, improving the model memory will challenge the deployment ability on the device, as indicated by Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.F4" title="Figure 4 ‣ 5.7 Sensitivity Study ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> (Right). Based on our practical experience, the edge model should generally be no bigger than 3.5MB to avoid unreasonable mobile overhead, which indicates our current choice of <math alttext="N^{l}=50" class="ltx_Math" display="inline" id="S5.SS7.p2.1.m1.1"><semantics id="S5.SS7.p2.1.m1.1a"><mrow id="S5.SS7.p2.1.m1.1.1" xref="S5.SS7.p2.1.m1.1.1.cmml"><msup id="S5.SS7.p2.1.m1.1.1.2" xref="S5.SS7.p2.1.m1.1.1.2.cmml"><mi id="S5.SS7.p2.1.m1.1.1.2.2" xref="S5.SS7.p2.1.m1.1.1.2.2.cmml">N</mi><mi id="S5.SS7.p2.1.m1.1.1.2.3" xref="S5.SS7.p2.1.m1.1.1.2.3.cmml">l</mi></msup><mo id="S5.SS7.p2.1.m1.1.1.1" xref="S5.SS7.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS7.p2.1.m1.1.1.3" xref="S5.SS7.p2.1.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p2.1.m1.1b"><apply id="S5.SS7.p2.1.m1.1.1.cmml" xref="S5.SS7.p2.1.m1.1.1"><eq id="S5.SS7.p2.1.m1.1.1.1.cmml" xref="S5.SS7.p2.1.m1.1.1.1"></eq><apply id="S5.SS7.p2.1.m1.1.1.2.cmml" xref="S5.SS7.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS7.p2.1.m1.1.1.2.1.cmml" xref="S5.SS7.p2.1.m1.1.1.2">superscript</csymbol><ci id="S5.SS7.p2.1.m1.1.1.2.2.cmml" xref="S5.SS7.p2.1.m1.1.1.2.2">𝑁</ci><ci id="S5.SS7.p2.1.m1.1.1.2.3.cmml" xref="S5.SS7.p2.1.m1.1.1.2.3">𝑙</ci></apply><cn id="S5.SS7.p2.1.m1.1.1.3.cmml" type="integer" xref="S5.SS7.p2.1.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p2.1.m1.1c">N^{l}=50</annotation><annotation encoding="application/x-llamapun" id="S5.SS7.p2.1.m1.1d">italic_N start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = 50</annotation></semantics></math> is almost optimal.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="471" id="S5.F4.g1" src="extracted/5848733/sensitivity.png" width="628"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Sensitivity plots of the Simulator experiment (blue) and the Industry experiment (red). Left: Plot of performance metrics with different cloud sequence latency. Right: the edge model size as a function of sequence length.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.8 </span>Live Experiment</h3>
<div class="ltx_para" id="S5.SS8.p1">
<p class="ltx_p" id="S5.SS8.p1.2">We deploy our algorithm on a world-leading mobile application and execute an A/B live test. The experiment lasts a week. We randomly select a pool of users from different geological areas to conduct our mobile-based deployment. Compared with the live baseline, we observe the global CTR increased by <math alttext="1.2\%" class="ltx_Math" display="inline" id="S5.SS8.p1.1.m1.1"><semantics id="S5.SS8.p1.1.m1.1a"><mrow id="S5.SS8.p1.1.m1.1.1" xref="S5.SS8.p1.1.m1.1.1.cmml"><mn id="S5.SS8.p1.1.m1.1.1.2" xref="S5.SS8.p1.1.m1.1.1.2.cmml">1.2</mn><mo id="S5.SS8.p1.1.m1.1.1.1" xref="S5.SS8.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS8.p1.1.m1.1b"><apply id="S5.SS8.p1.1.m1.1.1.cmml" xref="S5.SS8.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS8.p1.1.m1.1.1.1.cmml" xref="S5.SS8.p1.1.m1.1.1.1">percent</csymbol><cn id="S5.SS8.p1.1.m1.1.1.2.cmml" type="float" xref="S5.SS8.p1.1.m1.1.1.2">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS8.p1.1.m1.1c">1.2\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS8.p1.1.m1.1d">1.2 %</annotation></semantics></math> and the total views increased by <math alttext="1.5\%" class="ltx_Math" display="inline" id="S5.SS8.p1.2.m2.1"><semantics id="S5.SS8.p1.2.m2.1a"><mrow id="S5.SS8.p1.2.m2.1.1" xref="S5.SS8.p1.2.m2.1.1.cmml"><mn id="S5.SS8.p1.2.m2.1.1.2" xref="S5.SS8.p1.2.m2.1.1.2.cmml">1.5</mn><mo id="S5.SS8.p1.2.m2.1.1.1" xref="S5.SS8.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS8.p1.2.m2.1b"><apply id="S5.SS8.p1.2.m2.1.1.cmml" xref="S5.SS8.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS8.p1.2.m2.1.1.1.cmml" xref="S5.SS8.p1.2.m2.1.1.1">percent</csymbol><cn id="S5.SS8.p1.2.m2.1.1.2.cmml" type="float" xref="S5.SS8.p1.2.m2.1.1.2">1.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS8.p1.2.m2.1c">1.5\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS8.p1.2.m2.1d">1.5 %</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussion and Limitations</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">This work is motivated by decoupling the two time scales of the listwise recommendation: the physical time step (for user preference update) and the virtual step (for the ranked item selection). Our methodology adopts the fast-slow system by learning the above two mechanisms simultaneously by the HRL framework. We also take advantage of the edge computing technique by implement the low-level agent on the mobile device side, in which the localized and STA user information can be consider and feedback before uploading to the cloud. Therefore, our method provides the theoretical optimal solution for such recommending scenarios.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.6">However, one potential drawback is the extra computational burden brought by the mccHRL framework. Here we perform a simple time complexity analysis for a brief discussion. Given the physical time steps as <math alttext="T" class="ltx_Math" display="inline" id="S6.p2.1.m1.1"><semantics id="S6.p2.1.m1.1a"><mi id="S6.p2.1.m1.1.1" xref="S6.p2.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.1b"><ci id="S6.p2.1.m1.1.1.cmml" xref="S6.p2.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S6.p2.1.m1.1d">italic_T</annotation></semantics></math> and the virtual time steps as <math alttext="K" class="ltx_Math" display="inline" id="S6.p2.2.m2.1"><semantics id="S6.p2.2.m2.1a"><mi id="S6.p2.2.m2.1.1" xref="S6.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.p2.2.m2.1b"><ci id="S6.p2.2.m2.1.1.cmml" xref="S6.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S6.p2.2.m2.1d">italic_K</annotation></semantics></math> (the session length), inference of a generic pointwise recommendation model requires <math alttext="O(K*T)" class="ltx_Math" display="inline" id="S6.p2.3.m3.1"><semantics id="S6.p2.3.m3.1a"><mrow id="S6.p2.3.m3.1.1" xref="S6.p2.3.m3.1.1.cmml"><mi id="S6.p2.3.m3.1.1.3" xref="S6.p2.3.m3.1.1.3.cmml">O</mi><mo id="S6.p2.3.m3.1.1.2" xref="S6.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S6.p2.3.m3.1.1.1.1" xref="S6.p2.3.m3.1.1.1.1.1.cmml"><mo id="S6.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S6.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S6.p2.3.m3.1.1.1.1.1" xref="S6.p2.3.m3.1.1.1.1.1.cmml"><mi id="S6.p2.3.m3.1.1.1.1.1.2" xref="S6.p2.3.m3.1.1.1.1.1.2.cmml">K</mi><mo id="S6.p2.3.m3.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.p2.3.m3.1.1.1.1.1.1.cmml">∗</mo><mi id="S6.p2.3.m3.1.1.1.1.1.3" xref="S6.p2.3.m3.1.1.1.1.1.3.cmml">T</mi></mrow><mo id="S6.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S6.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.3.m3.1b"><apply id="S6.p2.3.m3.1.1.cmml" xref="S6.p2.3.m3.1.1"><times id="S6.p2.3.m3.1.1.2.cmml" xref="S6.p2.3.m3.1.1.2"></times><ci id="S6.p2.3.m3.1.1.3.cmml" xref="S6.p2.3.m3.1.1.3">𝑂</ci><apply id="S6.p2.3.m3.1.1.1.1.1.cmml" xref="S6.p2.3.m3.1.1.1.1"><times id="S6.p2.3.m3.1.1.1.1.1.1.cmml" xref="S6.p2.3.m3.1.1.1.1.1.1"></times><ci id="S6.p2.3.m3.1.1.1.1.1.2.cmml" xref="S6.p2.3.m3.1.1.1.1.1.2">𝐾</ci><ci id="S6.p2.3.m3.1.1.1.1.1.3.cmml" xref="S6.p2.3.m3.1.1.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.3.m3.1c">O(K*T)</annotation><annotation encoding="application/x-llamapun" id="S6.p2.3.m3.1d">italic_O ( italic_K ∗ italic_T )</annotation></semantics></math>, in which the model is called with the user and item pair independently. In our mccHRL, the time complexity would be <math alttext="O(K^{2}*T)" class="ltx_Math" display="inline" id="S6.p2.4.m4.1"><semantics id="S6.p2.4.m4.1a"><mrow id="S6.p2.4.m4.1.1" xref="S6.p2.4.m4.1.1.cmml"><mi id="S6.p2.4.m4.1.1.3" xref="S6.p2.4.m4.1.1.3.cmml">O</mi><mo id="S6.p2.4.m4.1.1.2" xref="S6.p2.4.m4.1.1.2.cmml">⁢</mo><mrow id="S6.p2.4.m4.1.1.1.1" xref="S6.p2.4.m4.1.1.1.1.1.cmml"><mo id="S6.p2.4.m4.1.1.1.1.2" stretchy="false" xref="S6.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S6.p2.4.m4.1.1.1.1.1" xref="S6.p2.4.m4.1.1.1.1.1.cmml"><msup id="S6.p2.4.m4.1.1.1.1.1.2" xref="S6.p2.4.m4.1.1.1.1.1.2.cmml"><mi id="S6.p2.4.m4.1.1.1.1.1.2.2" xref="S6.p2.4.m4.1.1.1.1.1.2.2.cmml">K</mi><mn id="S6.p2.4.m4.1.1.1.1.1.2.3" xref="S6.p2.4.m4.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S6.p2.4.m4.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.p2.4.m4.1.1.1.1.1.1.cmml">∗</mo><mi id="S6.p2.4.m4.1.1.1.1.1.3" xref="S6.p2.4.m4.1.1.1.1.1.3.cmml">T</mi></mrow><mo id="S6.p2.4.m4.1.1.1.1.3" stretchy="false" xref="S6.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.4.m4.1b"><apply id="S6.p2.4.m4.1.1.cmml" xref="S6.p2.4.m4.1.1"><times id="S6.p2.4.m4.1.1.2.cmml" xref="S6.p2.4.m4.1.1.2"></times><ci id="S6.p2.4.m4.1.1.3.cmml" xref="S6.p2.4.m4.1.1.3">𝑂</ci><apply id="S6.p2.4.m4.1.1.1.1.1.cmml" xref="S6.p2.4.m4.1.1.1.1"><times id="S6.p2.4.m4.1.1.1.1.1.1.cmml" xref="S6.p2.4.m4.1.1.1.1.1.1"></times><apply id="S6.p2.4.m4.1.1.1.1.1.2.cmml" xref="S6.p2.4.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S6.p2.4.m4.1.1.1.1.1.2.1.cmml" xref="S6.p2.4.m4.1.1.1.1.1.2">superscript</csymbol><ci id="S6.p2.4.m4.1.1.1.1.1.2.2.cmml" xref="S6.p2.4.m4.1.1.1.1.1.2.2">𝐾</ci><cn id="S6.p2.4.m4.1.1.1.1.1.2.3.cmml" type="integer" xref="S6.p2.4.m4.1.1.1.1.1.2.3">2</cn></apply><ci id="S6.p2.4.m4.1.1.1.1.1.3.cmml" xref="S6.p2.4.m4.1.1.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.4.m4.1c">O(K^{2}*T)</annotation><annotation encoding="application/x-llamapun" id="S6.p2.4.m4.1d">italic_O ( italic_K start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∗ italic_T )</annotation></semantics></math> since we need to calculate the session contextual information recurrently. When <math alttext="K" class="ltx_Math" display="inline" id="S6.p2.5.m5.1"><semantics id="S6.p2.5.m5.1a"><mi id="S6.p2.5.m5.1.1" xref="S6.p2.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.p2.5.m5.1b"><ci id="S6.p2.5.m5.1.1.cmml" xref="S6.p2.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S6.p2.5.m5.1d">italic_K</annotation></semantics></math> is too large (<span class="ltx_text ltx_font_italic" id="S6.p2.6.1">e.g. </span> larger than 100), mccHRL might be inefficient and impractical. Fortunately, in the industrial implementation, the user request is usually divided into sequential page requests. This solution reduces the actual <math alttext="K" class="ltx_Math" display="inline" id="S6.p2.6.m6.1"><semantics id="S6.p2.6.m6.1a"><mi id="S6.p2.6.m6.1.1" xref="S6.p2.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S6.p2.6.m6.1b"><ci id="S6.p2.6.m6.1.1.cmml" xref="S6.p2.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S6.p2.6.m6.1d">italic_K</annotation></semantics></math> therefore could alleviate the efficiency issue. The mobile-device transmission could also be a problem which is already discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.07416v1#S5.SS7" title="5.7 Sensitivity Study ‣ 5 Experiments ‣ Hierarchical Reinforcement Learning for Temporal Abstraction of Listwise Recommendation"><span class="ltx_text ltx_ref_tag">5.7</span></a>.</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">Another important potential improvement is to consider the user’s instant response within a session and make immediate adjustments for ranking results. Such considerations will add some user-interactive rewards for Low-Level RL, and our method then becomes a unified framework of cloud-based ranking and mobile-based reranking, which is a promising future direction.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this paper, we build a unified framework to deal with the user preference mode and the listwise item ranking simultaneously, by a novel hierarchical RL methodology. We reinforce the state Markovness by edge features consideration and design a mobile-cloud collaboration mechanism. The goal-conditional mechanism is utilized to synchronize the user preference solved by high-level RL to the low-level RL. The outra- and intra-session contexts are decoupled and studied in two time scales. We implement both a simulator and an offline industrial dataset to verify our methodology, before the formal live experiment. Our study shed some lights on the applications of HRL on listwise recommendation, and future studies can be developed to further implement RL interactively in large industrial environments.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anidorifón et al. [2015]</span>
<span class="ltx_bibblock">
Luis Anidorifón, Juan Santosgago, Manuel Caeirorodríguez, Manuel Fernándeziglesias, Rubén Míguezpérez, Agustin Cañasrodríguez, Victor Alonsororís, Javier Garcíaalonso, Roberto Pérezrodríguez, and Miguel Gómezcarballa.

</span>
<span class="ltx_bibblock">Recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Communications of the Acm</em>, 40(3):56–58, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bacon et al. [2017]</span>
<span class="ltx_bibblock">
Pierre-Luc Bacon, Jean Harb, and Doina Precup.

</span>
<span class="ltx_bibblock">The option-critic architecture.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the thirtieth AAAI Conference on Artificial Intelligence</em>, AAAI ’17, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2018]</span>
<span class="ltx_bibblock">
Hi-Yong Chen, Yang Yu, Qing Da, J. Tan, Hai-Kuan Huang, and Hai-Hong Tang.

</span>
<span class="ltx_bibblock">Stabilizing reinforcement learning in dynamic environment with application to online recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">The 24th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (KDD ’18)</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2019]</span>
<span class="ltx_bibblock">
Minmin Chen, Alex Beutel, Paul Covington, Sagar Jain, Francois Belletti, and Ed H. Chi.

</span>
<span class="ltx_bibblock">Top-k off-policy correction for a reinforce recommender system.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the Twelfth ACM International Conference on Web Search and Data Mining</em>, WSDM ’19, page 456–464, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2021]</span>
<span class="ltx_bibblock">
Zeyuan Chen, Jiangchao Yao, Feng Wang, Kunyang Jia, Bo Han, Wei Zhang, and Hongxia Yang.

</span>
<span class="ltx_bibblock">Mc<sup class="ltx_sup" id="bib.bib5.2.1">2</sup>-sf: Slow-fast learning for mobile-cloud collaborative recommendation, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Florensa et al. [2017]</span>
<span class="ltx_bibblock">
Carlos Florensa, Yan Duan, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Stochastic neural networks for hierarchical reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 5th. International Conference on Learning Representation</em>, ICLR ’17, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge et al. [2021]</span>
<span class="ltx_bibblock">
Yingqiang Ge, Shuchang Liu, Ruoyuan Gao, Yikun Xian, Yunqi Li, and Xiangyu Zhao.

</span>
<span class="ltx_bibblock">Towards long-term fairness in recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 14th ACM International Conference on Web Search and Data Mining</em>, WSDM ’21, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. [2019]</span>
<span class="ltx_bibblock">
Yu Gong, Yu Zhu, Lu Duan, Qingwen Liu, Ziyu Guan, Fei Sun, Wenwu Ou, and Kenny Q. Zhu.

</span>
<span class="ltx_bibblock">Exact-k recommendation via maximal clique optimization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">The 25th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (KDD ’19)</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. [2020]</span>
<span class="ltx_bibblock">
Yu Gong, Ziwen Jiang, Yufei Feng, Binbin Hu, Kaiqi Zhao, Qingwen Liu, and Wenwu Ou.

</span>
<span class="ltx_bibblock">Edgerec: Recommendation system on edge in mobile taobao.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 2020 ACM on Conference on Information and Knowledge Management</em>, CIKM ’20, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al. [2016]</span>
<span class="ltx_bibblock">
B. Hidasi, A. Karatzoglou, L. Baltrunas, and D. Tikk.

</span>
<span class="ltx_bibblock">Session-based recommendation with recurrent neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the 4th. International Conference on Learning Representation</em>, ICLR ’16, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ie et al. [2019]</span>
<span class="ltx_bibblock">
Eugene Ie, Vihan Jain, Jing Wang, Sanmit Narvekar, Ritesh Agarwal, Rui Wu, Heng-Tze Cheng, Tushar Chandra, and Craig Boutilier.

</span>
<span class="ltx_bibblock">Slateq: A tractable decomposition for reinforcement learning with recommendation sets.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the Twenty-Eighth International Joint Conference on Artificial Intelligence</em>, IJCAI ’19, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kulkarni et al. [2016]</span>
<span class="ltx_bibblock">
Tejas D Kulkarni, Karthik Narasimhan, Ardavan Saeedi, and Josh Tenenbaum.

</span>
<span class="ltx_bibblock">Hierarchical deep reinforcement learning: Integrating temporal abstraction and intrinsic motivation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 29th International Conference on Neural Information Processing Systems</em>, NIPS ’16, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. [2020]</span>
<span class="ltx_bibblock">
Aviral Kumar, Aurick Zhou, George Tucker, and Sergey Levine.

</span>
<span class="ltx_bibblock">Conservative q-learning for offline reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the 33th International Conference on Neural Information Processing Systems</em>, NIPS ’20, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levine et al. [2020]</span>
<span class="ltx_bibblock">
Sergey Levine, Aviral Kumar, George Tucker, and Justin Fu.

</span>
<span class="ltx_bibblock">Offline reinforcement learning: Tutorial, review, and perspectives on open problems, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levy et al. [2019]</span>
<span class="ltx_bibblock">
Andrew Levy, George Konidaris, Robert Platt, and Kate Saenko.

</span>
<span class="ltx_bibblock">Learning multi-level hierarchies with hindsight.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 7th. International Conference on Learning Representation</em>, ICLR ’19, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et al. [2020]</span>
<span class="ltx_bibblock">
Defu Lian, Yongji Wu, Yong Ge, Xing Xie, and Enhong Chen.

</span>
<span class="ltx_bibblock">Geography-aware sequential location recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lillicrap et al. [2016]</span>
<span class="ltx_bibblock">
Timothy P. Lillicrap, Jonathan J. Hunt, Alexander Pritzel, Nicolas Heess, Tom Erez, Yuval Tassa, David Silver, and Daan Wierstra.

</span>
<span class="ltx_bibblock">Continuous control with deep reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">CoRR</em>, abs/1509.02971, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. [2019]</span>
<span class="ltx_bibblock">
Yan Lu, Yuanchao Shu, Xu Tan, Yunxin Liu, Mengyu Zhou, Qi Chen, and Dan Pei.

</span>
<span class="ltx_bibblock">Collaborative learning between cloud and end devices: an empirical study on location prediction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">SEC</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. [2021]</span>
<span class="ltx_bibblock">
Yingtao Luo, Qiang Liu, and Zhaocheng Liu.

</span>
<span class="ltx_bibblock">Stan: Spatio-temporal attention network for next location recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">In Proceedings of the International World Wide Web Conference</em>, WWW ’21, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Madan et al. [2021]</span>
<span class="ltx_bibblock">
Kanika Madan, Rosemary Nan Ke, Anirudh Goyal, Bernhard Scholkopf, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Fast and slow learning of recurrent independent mechanisms.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 9th. International Conference on Learning Representation</em>, ICLR ’21, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nachum et al. [2018]</span>
<span class="ltx_bibblock">
Ofir Nachum, Shixiang Gu, Honglak Lee, and Sergey Levine.

</span>
<span class="ltx_bibblock">Data-efficient hierarchical reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 31th International Conference on Neural Information Processing Systems</em>, NIPS ’18, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nasiriany et al. [2019]</span>
<span class="ltx_bibblock">
Soroush Nasiriany, Vitchyr H. Pong, Steven Lin, and Sergey Levine.

</span>
<span class="ltx_bibblock">Planning with goal-conditioned policies.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 32th International Conference on Neural Information Processing Systems</em>, NIPS ’19, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Takanobu et al. [2019]</span>
<span class="ltx_bibblock">
Ryuichi Takanobu, Tao Zhuang, Minlie Huang, Jun Feng, Haihong Tang, and Bo Zheng.

</span>
<span class="ltx_bibblock">Aggregating e-commerce search results from heterogeneous sources via hierarchical reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">In Proceedings of the International World Wide Web Conference</em>, WWW ’19, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vezhnevets et al. [2017]</span>
<span class="ltx_bibblock">
Alexander Sahsa Vezhnevets, Simon Osindero, Tom Schaul, Nicolas Heess, Max Jaderberg, David Silver, and Koray Kavukcuogglu.

</span>
<span class="ltx_bibblock">Feual networks for hierarchical reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the Workshop on Negative Dependence in Machine Learning at the 34th International Conference on Machine Learning</em>, ICML ’17, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2020]</span>
<span class="ltx_bibblock">
Yanan Wang, Yong Ge, Li Li, Rui Chen, and Tong Xu.

</span>
<span class="ltx_bibblock">M<sup class="ltx_sup" id="bib.bib25.2.1">3</sup>rec: An offline meta-level model-based reinforcement learning approach for cold-start recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the 33th International Conference on Neural Information Processing Systems</em>, NIPS ’20, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. [2017]</span>
<span class="ltx_bibblock">
Zeng Wei, Jun Xu, Yanyan Lan, Jiafeng Guo, and Xueqi Cheng.

</span>
<span class="ltx_bibblock">Reinforcement learning to rank with markov decision process.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 51th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, SIGIR ’17, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. [2021]</span>
<span class="ltx_bibblock">
Chuhan Wu, Fangzhao Wu, Tao Qi, and Yongfeng Huang.

</span>
<span class="ltx_bibblock">Feedrec: News feed recommendation with various user feedbacks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">The 27th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, KDD ’21, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al. [2017]</span>
<span class="ltx_bibblock">
Long Xia, Jun Xu, Yanyan Lan, Jiafeng Guo, Wei Zeng, and Xueqi Cheng.

</span>
<span class="ltx_bibblock">Adapting markov decision process for search result diversification.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 51th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, SIGIR ’17, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. [2021]</span>
<span class="ltx_bibblock">
Ruobing Xie, Shaoliang Zhang, Rui Wang, Feng Xia, and Leyu Lin.

</span>
<span class="ltx_bibblock">Hierarchical reinforcement learning for integrated recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the thirty-fifth AAAI Conference on Artificial Intelligence</em>, AAAI ’21, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. [2021]</span>
<span class="ltx_bibblock">
Jiangchao Yao, Feng Wang, Kunyang Jia, Bo Han, Jingren Zhou, and Hongxia Yang.

</span>
<span class="ltx_bibblock">Device-cloud collaborative learning for recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">The 27th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, KDD ’21, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. [2022]</span>
<span class="ltx_bibblock">
Jiangchao Yao, Shengyu Zhang, Yang Yao, Feng Wang, Jianxin Ma, Jianwei Zhang, Yunfei Chu, Luo Ji, Kunyang Jia, Tao Shen, Anpeng Wu, Fengda Zhang, Ziqi Tan, Kun Kuang, Chao Wu, Fei Wu, Jingren Zhou, and Hongxia Yang.

</span>
<span class="ltx_bibblock">Edge-cloud polarization and collaboration: A comprehensive survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, 35(7):6866–6886, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. [2020]</span>
<span class="ltx_bibblock">
Dongyang Zhao, Liang Zhang, Bo Zhang, Lizhou Zheng, and Yongjun Bao an Weipeng Yan.

</span>
<span class="ltx_bibblock">Mahrl: Multi-goals abstraction based deep hierarchical reinforcement learning for recommendations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 54th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, SIGIR ’20, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. [2018]</span>
<span class="ltx_bibblock">
Xiangyu Zhao, Long Xia, L. Zhang, Zhuoye Ding, Dawei Yin, and Jiliang Tang.

</span>
<span class="ltx_bibblock">Deep reinforcement learning for page-wise recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 12th ACM Conference on Recommender Systems (RecSys ’18)</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. [2019]</span>
<span class="ltx_bibblock">
Xiangyu Zhao, Liang Zhang, Long Xia, Zhuoye Ding, Dawei Yin, and Jiliang Tang.

</span>
<span class="ltx_bibblock">Deep reinforcement learning for list-wise recommendations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">DRL4KDD</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2018]</span>
<span class="ltx_bibblock">
Guanjie Zheng, Fuzheng Zhang, Zihan Zheng, Yang Xiang, Nicholas Jing Yuan, Xing Xie, and Zhenhui Li.

</span>
<span class="ltx_bibblock">Drn: A deep reinforcement learning framework for news recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the 2018 World Wide Web Conference</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2019a]</span>
<span class="ltx_bibblock">
Fan Zhou, Ruiyang Yin, Kunpeng Zhang, Goce Trajcevski, Ting Zhong, and Jin Wu.

</span>
<span class="ltx_bibblock">Adversarial point-of-interest recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">In Proceedings of the International World Wide Web Conference</em>, WWW ’19, 2019a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2018]</span>
<span class="ltx_bibblock">
Guorui Zhou, Chengru Song, Xiaoqiang Zhu, Ying Fan, Han Zhu, Xiao Ma, Yanghui Yan, Junqi Jin, Han Li, and Kun Gai.

</span>
<span class="ltx_bibblock">Deep interest network for click-through rate prediction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">The 24th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, KDD ’18, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2019b]</span>
<span class="ltx_bibblock">
Zhi Zhou, Xu Chen, En Li, Liekang Zeng, Ke Luo, and Junshan Zhang.

</span>
<span class="ltx_bibblock">Edge intelligence: Paving the last mile of artificial intelligence with edge computing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the IEEE</em>, 2019b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zou et al. [2019]</span>
<span class="ltx_bibblock">
Lixin Zou, Long Xia, Zhuoye Ding, Jiaxing Song, Weidong Liu, and Dawei Yin.

</span>
<span class="ltx_bibblock">Reinforcement learning to optimize long-term user engagement in recommender systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">The 25th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (KDD ’19)</em>, 2019.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 11 16:56:14 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
