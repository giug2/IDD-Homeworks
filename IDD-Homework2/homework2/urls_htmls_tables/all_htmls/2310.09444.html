<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2310.09444] Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers</title><meta property="og:description" content="Optimization-based regularization methods have been effective in addressing the challenges posed by data heterogeneity in medical federated learning, particularly in improving the performance of underrepresented client…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2310.09444">

<!--Generated on Wed Feb 28 00:50:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Erfan Darzi<sup id="id11.11.id1" class="ltx_sup"><span id="id11.11.id1.1" class="ltx_text ltx_font_italic">1,2,∗</span></sup>,
Yiqing Shen<sup id="id12.12.id2" class="ltx_sup"><span id="id12.12.id2.1" class="ltx_text ltx_font_italic">3</span></sup>,
Yangming Ou<sup id="id13.13.id3" class="ltx_sup"><span id="id13.13.id3.1" class="ltx_text ltx_font_italic">1,2</span></sup>,
Nanna M. Sijtsema<sup id="id14.14.id4" class="ltx_sup"><span id="id14.14.id4.1" class="ltx_text ltx_font_italic">4</span></sup>,
P.M.A van Ooijen<sup id="id15.15.id5" class="ltx_sup"><span id="id15.15.id5.1" class="ltx_text ltx_font_italic">4</span></sup>
<br class="ltx_break">
<br class="ltx_break"><sup id="id16.16.id6" class="ltx_sup"><span id="id16.16.id6.1" class="ltx_text ltx_font_italic">1</span></sup><span id="id9.9.3" class="ltx_text ltx_font_italic"> Boston Children’s hospital, Boston, MA, United States
<br class="ltx_break"><sup id="id9.9.3.1" class="ltx_sup">2</sup> Harvard Medical school, Boston, MA, USA
<br class="ltx_break"><sup id="id9.9.3.2" class="ltx_sup">3</sup>Johns Hopkins University, Baltimore, MD, United States
<br class="ltx_break"><sup id="id9.9.3.3" class="ltx_sup">4</sup> University Medical Center Groningen</span>, <span id="id10.10.4" class="ltx_text ltx_font_italic">University of Groningen, The Netherlands
<br class="ltx_break">
<br class="ltx_break"><sup id="id10.10.4.1" class="ltx_sup">∗</sup></span>Erfan.Darzi@childrens.harvard.edu
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id17.id1" class="ltx_p">Optimization-based regularization methods have been effective in addressing the challenges posed by data heterogeneity in medical federated learning, particularly in improving the performance of underrepresented clients. However, these methods often lead to lower overall model accuracy and slower convergence rates. In this paper, we demonstrate that using Vision Transformers can substantially improve the performance of underrepresented clients without a significant trade-off in overall accuracy. This improvement is attributed to the Vision transformer’s ability to capture long-range dependencies within the input data.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Optimization-based methods have emerged as potent solutions to tackle data heterogeneity in federated setting. These methods are effective at mitigating discrepancies arising from variations in data sizes, sample numbers, or distributions across different client nodes. Despite the general effectiveness of these optimization methods, challenges specific to medical imaging in federated learning settings remain formidable.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In the realm of medical imaging, heterogeneity can manifest in a myriad of ways. These include variations in imaging modalities, different prevalence rates of specific diseases, and distinct patterns in medical datasets among hospitals. Such variations culminate in a setting of non-identical and independently distributed (non-i.i.d.) data across client nodes. This statistical heterogeneity has proven to significantly impede federated learning process. For example, heterogeneous data environments are especially challenging in specialized applications like diabetic retinopathy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx18" title="" class="ltx_ref">18</a>]</cite>, pancreas segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx28" title="" class="ltx_ref">28</a>]</cite>, and prostate cancer classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx8" title="" class="ltx_ref">8</a>]</cite>, as well as in broader contexts like bone age prediction and real-world federated brain tumor segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx35" title="" class="ltx_ref">35</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx33" title="" class="ltx_ref">33</a>]</cite>. Such heterogeneous distributions often result in reduced diagnostic accuracy and introduce fairness concerns, particularly disadvantaging underrepresented hospitals. Addressing the complexities introduced by data heterogeneity is thus critical for the successful deployment of federated learning models in healthcare applications.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Existing federated learning methods, most notably Federated Averaging (FedAvg), face significant limitations in effectively handling heterogeneous settings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx35" title="" class="ltx_ref">35</a>]</cite>. This has prompted various studies to explore alternative solutions that typically employ optimization techniques, such as modified training heuristics or objective functions. Techniques like SplitAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx35" title="" class="ltx_ref">35</a>]</cite>, adaptive learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx32" title="" class="ltx_ref">32</a>]</cite>, hierarchical clustering <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx5" title="" class="ltx_ref">5</a>]</cite>, and proximal learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx11" title="" class="ltx_ref">11</a>]</cite> offer promising avenues but come with their own sets of challenges. These challenges include substantial computational complexity, the potential for overfitting due to multi-layer optimization, and constraints to specific data types. Such limitations restrict their effectiveness across a broad range of medical imaging applications. For instance, a recently proposed top-performing algorithm employs general clustering optimization in every federated round. However, it only achieves a marginal 3% improvement over the baseline performances of FedAvg and FedAP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx32" title="" class="ltx_ref">32</a>]</cite>, while demanding an order of magnitude more computational resources. This significantly complicates its practical applicability. These challenges are commonly attributed to the inherent difficulties associated with the heterogeneity problem, casting doubts on the practical utility of these models. This raises a fundamental question: do we really need to pay such a high price to mitigate the issues arising from heterogeneity?</p>
</div>
<section id="S1.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Our Contributions</h3>

<div id="S1.SSx1.p1" class="ltx_para">
<p id="S1.SSx1.p1.1" class="ltx_p">We introduce the Federated Multi-Head Alignment (FedMHA) approach. This method suggests that focusing on the multi-head attention mechanism in Vision Transformers as the alignment objective can lead to improved accuracy and fairness in heterogeneous settings. The attention model’s ability to handle long-range, high-dimensional distributions across diverse clients underpins this improvement. The multi-head attention mechanism’s intrinsic capabilities mean that aligning it can directly affect the representation of data across clients, perhaps more than other components.</p>
</div>
<div id="S1.SSx1.p2" class="ltx_para">
<p id="S1.SSx1.p2.1" class="ltx_p">This study is driven by two main objectives. First, we address the challenges of fairness in the context of data heterogeneity in federated learning applied to medical imaging. Second, we aim to design a federated learning algorithm that achieves high accuracy levels without resorting to overly intricate optimization design to address the issue. Instead, we consider harnessing model architecture components to address heterogeneity.</p>
</div>
<div id="S1.SSx1.p3" class="ltx_para">
<p id="S1.SSx1.p3.1" class="ltx_p">Based on these objectives, our key contributions are:</p>
</div>
<div id="S1.SSx1.p4" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Improved Fairness:</span> Aligning the multi-head attention mechanism in Vision Transformers between global and local models offers potential solutions to challenges posed by data heterogeneity, especially for underrepresented datasets.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Enhanced Accuracy:</span> Our approach has consistently demonstrated superior accuracy compared to other contemporary methods. We have evaluated our model against various federated learning techniques across different levels of heterogeneity. This evaluation provides a reference for future research in federated learning for medical imaging.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Problem setting and background</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.7" class="ltx_p"><span id="S2.p1.7.1" class="ltx_text ltx_font_bold">Federated learning and heterogeneity</span>
Federated learning has emerged as a decentralized approach for preserving data privacy and confidentiality while enabling models to learn from multiple data sources <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx34" title="" class="ltx_ref">34</a>]</cite>.
In federated learning, each client owns a local private dataset <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="{D}_{i}" display="inline"><semantics id="S2.p1.1.m1.1a"><msub id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><mi id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml">D</mi><mi id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2">𝐷</ci><ci id="S2.p1.1.m1.1.1.3.cmml" xref="S2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">{D}_{i}</annotation></semantics></math> drawn from distribution <math id="S2.p1.2.m2.2" class="ltx_Math" alttext="\mathbb{P}_{i}(x,y)" display="inline"><semantics id="S2.p1.2.m2.2a"><mrow id="S2.p1.2.m2.2.3" xref="S2.p1.2.m2.2.3.cmml"><msub id="S2.p1.2.m2.2.3.2" xref="S2.p1.2.m2.2.3.2.cmml"><mi id="S2.p1.2.m2.2.3.2.2" xref="S2.p1.2.m2.2.3.2.2.cmml">ℙ</mi><mi id="S2.p1.2.m2.2.3.2.3" xref="S2.p1.2.m2.2.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.p1.2.m2.2.3.1" xref="S2.p1.2.m2.2.3.1.cmml">​</mo><mrow id="S2.p1.2.m2.2.3.3.2" xref="S2.p1.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S2.p1.2.m2.2.3.3.2.1" xref="S2.p1.2.m2.2.3.3.1.cmml">(</mo><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">x</mi><mo id="S2.p1.2.m2.2.3.3.2.2" xref="S2.p1.2.m2.2.3.3.1.cmml">,</mo><mi id="S2.p1.2.m2.2.2" xref="S2.p1.2.m2.2.2.cmml">y</mi><mo stretchy="false" id="S2.p1.2.m2.2.3.3.2.3" xref="S2.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.2b"><apply id="S2.p1.2.m2.2.3.cmml" xref="S2.p1.2.m2.2.3"><times id="S2.p1.2.m2.2.3.1.cmml" xref="S2.p1.2.m2.2.3.1"></times><apply id="S2.p1.2.m2.2.3.2.cmml" xref="S2.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.3.2.1.cmml" xref="S2.p1.2.m2.2.3.2">subscript</csymbol><ci id="S2.p1.2.m2.2.3.2.2.cmml" xref="S2.p1.2.m2.2.3.2.2">ℙ</ci><ci id="S2.p1.2.m2.2.3.2.3.cmml" xref="S2.p1.2.m2.2.3.2.3">𝑖</ci></apply><interval closure="open" id="S2.p1.2.m2.2.3.3.1.cmml" xref="S2.p1.2.m2.2.3.3.2"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝑥</ci><ci id="S2.p1.2.m2.2.2.cmml" xref="S2.p1.2.m2.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.2c">\mathbb{P}_{i}(x,y)</annotation></semantics></math>, where <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">x</annotation></semantics></math> and <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.p1.4.m4.1a"><mi id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">y</annotation></semantics></math> denote the input features and corresponding class labels, respectively. Usually, clients share a model <math id="S2.p1.5.m5.2" class="ltx_Math" alttext="\mathcal{F}(\omega;x)" display="inline"><semantics id="S2.p1.5.m5.2a"><mrow id="S2.p1.5.m5.2.3" xref="S2.p1.5.m5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m5.2.3.2" xref="S2.p1.5.m5.2.3.2.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S2.p1.5.m5.2.3.1" xref="S2.p1.5.m5.2.3.1.cmml">​</mo><mrow id="S2.p1.5.m5.2.3.3.2" xref="S2.p1.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="S2.p1.5.m5.2.3.3.2.1" xref="S2.p1.5.m5.2.3.3.1.cmml">(</mo><mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">ω</mi><mo id="S2.p1.5.m5.2.3.3.2.2" xref="S2.p1.5.m5.2.3.3.1.cmml">;</mo><mi id="S2.p1.5.m5.2.2" xref="S2.p1.5.m5.2.2.cmml">x</mi><mo stretchy="false" id="S2.p1.5.m5.2.3.3.2.3" xref="S2.p1.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.2b"><apply id="S2.p1.5.m5.2.3.cmml" xref="S2.p1.5.m5.2.3"><times id="S2.p1.5.m5.2.3.1.cmml" xref="S2.p1.5.m5.2.3.1"></times><ci id="S2.p1.5.m5.2.3.2.cmml" xref="S2.p1.5.m5.2.3.2">ℱ</ci><list id="S2.p1.5.m5.2.3.3.1.cmml" xref="S2.p1.5.m5.2.3.3.2"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝜔</ci><ci id="S2.p1.5.m5.2.2.cmml" xref="S2.p1.5.m5.2.2">𝑥</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.2c">\mathcal{F}(\omega;x)</annotation></semantics></math> with the same architecture and hyperparameters. This model is parameterized by learnable weights <math id="S2.p1.6.m6.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S2.p1.6.m6.1a"><mi id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><ci id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">\omega</annotation></semantics></math> and input features <math id="S2.p1.7.m7.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.p1.7.m7.1a"><mi id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><ci id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">x</annotation></semantics></math>. The objective function of FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx17" title="" class="ltx_ref">17</a>]</cite> is:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.5" class="ltx_Math" alttext="\arg\min_{\omega}\sum_{i=1}^{m}\frac{|D_{i}|}{N}\mathcal{L}_{S}(\mathcal{F}(\omega;x),y)," display="block"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1.3" xref="S2.E1.m1.5.5.1.1.3.cmml"><mi id="S2.E1.m1.5.5.1.1.3.1" xref="S2.E1.m1.5.5.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E1.m1.5.5.1.1.3a" xref="S2.E1.m1.5.5.1.1.3.cmml">⁡</mo><munder id="S2.E1.m1.5.5.1.1.3.2" xref="S2.E1.m1.5.5.1.1.3.2.cmml"><mi id="S2.E1.m1.5.5.1.1.3.2.2" xref="S2.E1.m1.5.5.1.1.3.2.2.cmml">min</mi><mi id="S2.E1.m1.5.5.1.1.3.2.3" xref="S2.E1.m1.5.5.1.1.3.2.3.cmml">ω</mi></munder></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.2" xref="S2.E1.m1.5.5.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.1" xref="S2.E1.m1.5.5.1.1.1.cmml"><munderover id="S2.E1.m1.5.5.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E1.m1.5.5.1.1.1.2.2.2" xref="S2.E1.m1.5.5.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.5.5.1.1.1.2.2.3" xref="S2.E1.m1.5.5.1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.5.5.1.1.1.2.2.3.2" xref="S2.E1.m1.5.5.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E1.m1.5.5.1.1.1.2.2.3.1" xref="S2.E1.m1.5.5.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E1.m1.5.5.1.1.1.2.2.3.3" xref="S2.E1.m1.5.5.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.5.5.1.1.1.2.3" xref="S2.E1.m1.5.5.1.1.1.2.3.cmml">m</mi></munderover><mrow id="S2.E1.m1.5.5.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.cmml"><mfrac id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.1.cmml">|</mo><msub id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml">D</mi><mi id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.2.1.cmml">|</mo></mrow><mi id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.2.cmml">​</mo><msub id="S2.E1.m1.5.5.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.1.1.3.2" xref="S2.E1.m1.5.5.1.1.1.1.3.2.cmml">ℒ</mi><mi id="S2.E1.m1.5.5.1.1.1.1.3.3" xref="S2.E1.m1.5.5.1.1.1.1.3.3.cmml">S</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.1.1.2a" xref="S2.E1.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.2.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">ω</mi><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.1.cmml">;</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">x</mi><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.2.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">y</mi><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.4" xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.5.5.1.2" xref="S2.E1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.1.1.cmml" xref="S2.E1.m1.5.5.1"><times id="S2.E1.m1.5.5.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.2"></times><apply id="S2.E1.m1.5.5.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.3"><arg id="S2.E1.m1.5.5.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.3.1"></arg><apply id="S2.E1.m1.5.5.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.3.2.1.cmml" xref="S2.E1.m1.5.5.1.1.3.2">subscript</csymbol><min id="S2.E1.m1.5.5.1.1.3.2.2.cmml" xref="S2.E1.m1.5.5.1.1.3.2.2"></min><ci id="S2.E1.m1.5.5.1.1.3.2.3.cmml" xref="S2.E1.m1.5.5.1.1.3.2.3">𝜔</ci></apply></apply><apply id="S2.E1.m1.5.5.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1"><apply id="S2.E1.m1.5.5.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.2">superscript</csymbol><apply id="S2.E1.m1.5.5.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.2.2.1.cmml" xref="S2.E1.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.5.5.1.1.1.2.2.2.cmml" xref="S2.E1.m1.5.5.1.1.1.2.2.2"></sum><apply id="S2.E1.m1.5.5.1.1.1.2.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.2.2.3"><eq id="S2.E1.m1.5.5.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.2.2.3.1"></eq><ci id="S2.E1.m1.5.5.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E1.m1.5.5.1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.5.5.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.1.1.1.2.3">𝑚</ci></apply><apply id="S2.E1.m1.5.5.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1"><times id="S2.E1.m1.5.5.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2"></times><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><divide id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1"></divide><apply id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1"><abs id="S2.E1.m1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2"></abs><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2">𝐷</ci><ci id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3">𝑁</ci></apply><apply id="S2.E1.m1.5.5.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3.2">ℒ</ci><ci id="S2.E1.m1.5.5.1.1.1.1.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3.3">𝑆</ci></apply><interval closure="open" id="S2.E1.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1"><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1"><times id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.1"></times><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2">ℱ</ci><list id="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.2"><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝜔</ci><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑥</ci></list></apply><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">\arg\min_{\omega}\sum_{i=1}^{m}\frac{|D_{i}|}{N}\mathcal{L}_{S}(\mathcal{F}(\omega;x),y),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p1.12" class="ltx_p">where <math id="S2.p1.8.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S2.p1.8.m1.1a"><mi id="S2.p1.8.m1.1.1" xref="S2.p1.8.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.p1.8.m1.1b"><ci id="S2.p1.8.m1.1.1.cmml" xref="S2.p1.8.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m1.1c">\omega</annotation></semantics></math> is the global model’s parameters, <math id="S2.p1.9.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.p1.9.m2.1a"><mi id="S2.p1.9.m2.1.1" xref="S2.p1.9.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m2.1b"><ci id="S2.p1.9.m2.1.1.cmml" xref="S2.p1.9.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m2.1c">m</annotation></semantics></math> denotes the number of clients, <math id="S2.p1.10.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p1.10.m3.1a"><mi id="S2.p1.10.m3.1.1" xref="S2.p1.10.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.10.m3.1b"><ci id="S2.p1.10.m3.1.1.cmml" xref="S2.p1.10.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m3.1c">N</annotation></semantics></math> is the total number of instances over all clients, <math id="S2.p1.11.m4.1" class="ltx_Math" alttext="\mathcal{F}" display="inline"><semantics id="S2.p1.11.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.11.m4.1.1" xref="S2.p1.11.m4.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.11.m4.1b"><ci id="S2.p1.11.m4.1.1.cmml" xref="S2.p1.11.m4.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.11.m4.1c">\mathcal{F}</annotation></semantics></math> is the shared model, and <math id="S2.p1.12.m5.1" class="ltx_Math" alttext="\mathcal{L}_{S}" display="inline"><semantics id="S2.p1.12.m5.1a"><msub id="S2.p1.12.m5.1.1" xref="S2.p1.12.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.12.m5.1.1.2" xref="S2.p1.12.m5.1.1.2.cmml">ℒ</mi><mi id="S2.p1.12.m5.1.1.3" xref="S2.p1.12.m5.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.12.m5.1b"><apply id="S2.p1.12.m5.1.1.cmml" xref="S2.p1.12.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.12.m5.1.1.1.cmml" xref="S2.p1.12.m5.1.1">subscript</csymbol><ci id="S2.p1.12.m5.1.1.2.cmml" xref="S2.p1.12.m5.1.1.2">ℒ</ci><ci id="S2.p1.12.m5.1.1.3.cmml" xref="S2.p1.12.m5.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.12.m5.1c">\mathcal{L}_{S}</annotation></semantics></math> is a general definition of any supervised learning task (e.g., a cross-entropy loss).</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.6" class="ltx_p">In a real-world FL environment, each client may represent a mobile phone with a specific user behavior pattern or a sensor deployed in a particular location, leading to statistical and/or model heterogeneous environment. In the statistical heterogeneity setting, <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="\mathbb{P}_{i}" display="inline"><semantics id="S2.p2.1.m1.1a"><msub id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">ℙ</mi><mi id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">ℙ</ci><ci id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathbb{P}_{i}</annotation></semantics></math> varies across clients, indicating heterogeneous input/output space for <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">x</annotation></semantics></math> and <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">y</annotation></semantics></math>. For example, <math id="S2.p2.4.m4.1" class="ltx_Math" alttext="\mathbb{P}_{i}" display="inline"><semantics id="S2.p2.4.m4.1a"><msub id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><mi id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml">ℙ</mi><mi id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">ℙ</ci><ci id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">\mathbb{P}_{i}</annotation></semantics></math> on different clients can be the data distributions over different subsets of classes. In the model heterogeneity setting, <math id="S2.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{F}_{i}" display="inline"><semantics id="S2.p2.5.m5.1a"><msub id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">ℱ</mi><mi id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">ℱ</ci><ci id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">\mathcal{F}_{i}</annotation></semantics></math> varies across clients, indicating different model architectures and hyperparameters. For the <math id="S2.p2.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p2.6.m6.1a"><mi id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><ci id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">i</annotation></semantics></math>-th client, the training procedure is to minimize the loss as defined below:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.8" class="ltx_Math" alttext="\small\arg\min_{\omega_{1},\omega_{2},\dots,\omega_{m}}\sum_{i=1}^{m}\frac{|D_{i}|}{N}\mathcal{L}_{S}(\mathcal{F}_{i}(\omega_{i};x),y)." display="block"><semantics id="S2.E2.m1.8a"><mrow id="S2.E2.m1.8.8.1" xref="S2.E2.m1.8.8.1.1.cmml"><mrow id="S2.E2.m1.8.8.1.1" xref="S2.E2.m1.8.8.1.1.cmml"><mrow id="S2.E2.m1.8.8.1.1.3" xref="S2.E2.m1.8.8.1.1.3.cmml"><mi mathsize="90%" id="S2.E2.m1.8.8.1.1.3.1" xref="S2.E2.m1.8.8.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E2.m1.8.8.1.1.3a" xref="S2.E2.m1.8.8.1.1.3.cmml">⁡</mo><munder id="S2.E2.m1.8.8.1.1.3.2" xref="S2.E2.m1.8.8.1.1.3.2.cmml"><mi mathsize="90%" id="S2.E2.m1.8.8.1.1.3.2.2" xref="S2.E2.m1.8.8.1.1.3.2.2.cmml">min</mi><mrow id="S2.E2.m1.4.4.4.4" xref="S2.E2.m1.4.4.4.5.cmml"><msub id="S2.E2.m1.2.2.2.2.1" xref="S2.E2.m1.2.2.2.2.1.cmml"><mi mathsize="90%" id="S2.E2.m1.2.2.2.2.1.2" xref="S2.E2.m1.2.2.2.2.1.2.cmml">ω</mi><mn mathsize="90%" id="S2.E2.m1.2.2.2.2.1.3" xref="S2.E2.m1.2.2.2.2.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S2.E2.m1.4.4.4.4.4" xref="S2.E2.m1.4.4.4.5.cmml">,</mo><msub id="S2.E2.m1.3.3.3.3.2" xref="S2.E2.m1.3.3.3.3.2.cmml"><mi mathsize="90%" id="S2.E2.m1.3.3.3.3.2.2" xref="S2.E2.m1.3.3.3.3.2.2.cmml">ω</mi><mn mathsize="90%" id="S2.E2.m1.3.3.3.3.2.3" xref="S2.E2.m1.3.3.3.3.2.3.cmml">2</mn></msub><mo mathsize="90%" id="S2.E2.m1.4.4.4.4.5" xref="S2.E2.m1.4.4.4.5.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">…</mi><mo mathsize="90%" id="S2.E2.m1.4.4.4.4.6" xref="S2.E2.m1.4.4.4.5.cmml">,</mo><msub id="S2.E2.m1.4.4.4.4.3" xref="S2.E2.m1.4.4.4.4.3.cmml"><mi mathsize="90%" id="S2.E2.m1.4.4.4.4.3.2" xref="S2.E2.m1.4.4.4.4.3.2.cmml">ω</mi><mi mathsize="90%" id="S2.E2.m1.4.4.4.4.3.3" xref="S2.E2.m1.4.4.4.4.3.3.cmml">m</mi></msub></mrow></munder></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.8.8.1.1.2" xref="S2.E2.m1.8.8.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.8.8.1.1.1" xref="S2.E2.m1.8.8.1.1.1.cmml"><munderover id="S2.E2.m1.8.8.1.1.1.2" xref="S2.E2.m1.8.8.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E2.m1.8.8.1.1.1.2.2.2" xref="S2.E2.m1.8.8.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.8.8.1.1.1.2.2.3" xref="S2.E2.m1.8.8.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S2.E2.m1.8.8.1.1.1.2.2.3.2" xref="S2.E2.m1.8.8.1.1.1.2.2.3.2.cmml">i</mi><mo mathsize="90%" id="S2.E2.m1.8.8.1.1.1.2.2.3.1" xref="S2.E2.m1.8.8.1.1.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E2.m1.8.8.1.1.1.2.2.3.3" xref="S2.E2.m1.8.8.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E2.m1.8.8.1.1.1.2.3" xref="S2.E2.m1.8.8.1.1.1.2.3.cmml">m</mi></munderover><mrow id="S2.E2.m1.8.8.1.1.1.1" xref="S2.E2.m1.8.8.1.1.1.1.cmml"><mfrac id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml"><mrow id="S2.E2.m1.5.5.1.1" xref="S2.E2.m1.5.5.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E2.m1.5.5.1.1.2" xref="S2.E2.m1.5.5.1.2.1.cmml">|</mo><msub id="S2.E2.m1.5.5.1.1.1" xref="S2.E2.m1.5.5.1.1.1.cmml"><mi mathsize="90%" id="S2.E2.m1.5.5.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.2.cmml">D</mi><mi mathsize="90%" id="S2.E2.m1.5.5.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S2.E2.m1.5.5.1.1.3" xref="S2.E2.m1.5.5.1.2.1.cmml">|</mo></mrow><mi mathsize="90%" id="S2.E2.m1.5.5.3" xref="S2.E2.m1.5.5.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E2.m1.8.8.1.1.1.1.2" xref="S2.E2.m1.8.8.1.1.1.1.2.cmml">​</mo><msub id="S2.E2.m1.8.8.1.1.1.1.3" xref="S2.E2.m1.8.8.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2.m1.8.8.1.1.1.1.3.2" xref="S2.E2.m1.8.8.1.1.1.1.3.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.E2.m1.8.8.1.1.1.1.3.3" xref="S2.E2.m1.8.8.1.1.1.1.3.3.cmml">S</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.8.8.1.1.1.1.2a" xref="S2.E2.m1.8.8.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.8.8.1.1.1.1.1.1" xref="S2.E2.m1.8.8.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E2.m1.8.8.1.1.1.1.1.1.2" xref="S2.E2.m1.8.8.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.E2.m1.8.8.1.1.1.1.1.1.1" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.8.8.1.1.1.1.1.1.1.3" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.3.2.cmml">ℱ</mi><mi mathsize="90%" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.2" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml">ω</mi><mi mathsize="90%" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi mathsize="90%" id="S2.E2.m1.6.6" xref="S2.E2.m1.6.6.cmml">x</mi><mo maxsize="90%" minsize="90%" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.4" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.E2.m1.8.8.1.1.1.1.1.1.3" xref="S2.E2.m1.8.8.1.1.1.1.1.2.cmml">,</mo><mi mathsize="90%" id="S2.E2.m1.7.7" xref="S2.E2.m1.7.7.cmml">y</mi><mo maxsize="90%" minsize="90%" id="S2.E2.m1.8.8.1.1.1.1.1.1.4" xref="S2.E2.m1.8.8.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.E2.m1.8.8.1.2" xref="S2.E2.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.8b"><apply id="S2.E2.m1.8.8.1.1.cmml" xref="S2.E2.m1.8.8.1"><times id="S2.E2.m1.8.8.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.2"></times><apply id="S2.E2.m1.8.8.1.1.3.cmml" xref="S2.E2.m1.8.8.1.1.3"><arg id="S2.E2.m1.8.8.1.1.3.1.cmml" xref="S2.E2.m1.8.8.1.1.3.1"></arg><apply id="S2.E2.m1.8.8.1.1.3.2.cmml" xref="S2.E2.m1.8.8.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.3.2.1.cmml" xref="S2.E2.m1.8.8.1.1.3.2">subscript</csymbol><min id="S2.E2.m1.8.8.1.1.3.2.2.cmml" xref="S2.E2.m1.8.8.1.1.3.2.2"></min><list id="S2.E2.m1.4.4.4.5.cmml" xref="S2.E2.m1.4.4.4.4"><apply id="S2.E2.m1.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.2">𝜔</ci><cn type="integer" id="S2.E2.m1.2.2.2.2.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.3">1</cn></apply><apply id="S2.E2.m1.3.3.3.3.2.cmml" xref="S2.E2.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.3.3.2.1.cmml" xref="S2.E2.m1.3.3.3.3.2">subscript</csymbol><ci id="S2.E2.m1.3.3.3.3.2.2.cmml" xref="S2.E2.m1.3.3.3.3.2.2">𝜔</ci><cn type="integer" id="S2.E2.m1.3.3.3.3.2.3.cmml" xref="S2.E2.m1.3.3.3.3.2.3">2</cn></apply><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">…</ci><apply id="S2.E2.m1.4.4.4.4.3.cmml" xref="S2.E2.m1.4.4.4.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.4.3.1.cmml" xref="S2.E2.m1.4.4.4.4.3">subscript</csymbol><ci id="S2.E2.m1.4.4.4.4.3.2.cmml" xref="S2.E2.m1.4.4.4.4.3.2">𝜔</ci><ci id="S2.E2.m1.4.4.4.4.3.3.cmml" xref="S2.E2.m1.4.4.4.4.3.3">𝑚</ci></apply></list></apply></apply><apply id="S2.E2.m1.8.8.1.1.1.cmml" xref="S2.E2.m1.8.8.1.1.1"><apply id="S2.E2.m1.8.8.1.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.1.2.1.cmml" xref="S2.E2.m1.8.8.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.8.8.1.1.1.2.2.cmml" xref="S2.E2.m1.8.8.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.1.2.2.1.cmml" xref="S2.E2.m1.8.8.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.8.8.1.1.1.2.2.2.cmml" xref="S2.E2.m1.8.8.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.8.8.1.1.1.2.2.3.cmml" xref="S2.E2.m1.8.8.1.1.1.2.2.3"><eq id="S2.E2.m1.8.8.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.8.8.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.8.8.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.8.8.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E2.m1.8.8.1.1.1.2.2.3.3.cmml" xref="S2.E2.m1.8.8.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.8.8.1.1.1.2.3.cmml" xref="S2.E2.m1.8.8.1.1.1.2.3">𝑚</ci></apply><apply id="S2.E2.m1.8.8.1.1.1.1.cmml" xref="S2.E2.m1.8.8.1.1.1.1"><times id="S2.E2.m1.8.8.1.1.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.1.1.2"></times><apply id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5"><divide id="S2.E2.m1.5.5.2.cmml" xref="S2.E2.m1.5.5"></divide><apply id="S2.E2.m1.5.5.1.2.cmml" xref="S2.E2.m1.5.5.1.1"><abs id="S2.E2.m1.5.5.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.2"></abs><apply id="S2.E2.m1.5.5.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.2">𝐷</ci><ci id="S2.E2.m1.5.5.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.3">𝑖</ci></apply></apply><ci id="S2.E2.m1.5.5.3.cmml" xref="S2.E2.m1.5.5.3">𝑁</ci></apply><apply id="S2.E2.m1.8.8.1.1.1.1.3.cmml" xref="S2.E2.m1.8.8.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.1.1.3.1.cmml" xref="S2.E2.m1.8.8.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.8.8.1.1.1.1.3.2.cmml" xref="S2.E2.m1.8.8.1.1.1.1.3.2">ℒ</ci><ci id="S2.E2.m1.8.8.1.1.1.1.3.3.cmml" xref="S2.E2.m1.8.8.1.1.1.1.3.3">𝑆</ci></apply><interval closure="open" id="S2.E2.m1.8.8.1.1.1.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1"><apply id="S2.E2.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1"><times id="S2.E2.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.8.8.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.3.2">ℱ</ci><ci id="S2.E2.m1.8.8.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><list id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1"><apply id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.2">𝜔</ci><ci id="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.8.8.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S2.E2.m1.6.6.cmml" xref="S2.E2.m1.6.6">𝑥</ci></list></apply><ci id="S2.E2.m1.7.7.cmml" xref="S2.E2.m1.7.7">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.8c">\small\arg\min_{\omega_{1},\omega_{2},\dots,\omega_{m}}\sum_{i=1}^{m}\frac{|D_{i}|}{N}\mathcal{L}_{S}(\mathcal{F}_{i}(\omega_{i};x),y).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.4" class="ltx_p">Most existing methods cannot handle the heterogeneous settings above well. In particular, the fact that <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{F}_{i}" display="inline"><semantics id="S2.p3.1.m1.1a"><msub id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p3.1.m1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">ℱ</mi><mi id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.1.cmml" xref="S2.p3.1.m1.1.1">subscript</csymbol><ci id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.2">ℱ</ci><ci id="S2.p3.1.m1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\mathcal{F}_{i}</annotation></semantics></math> has a different model architecture would cause <math id="S2.p3.2.m2.1" class="ltx_Math" alttext="\omega_{i}" display="inline"><semantics id="S2.p3.2.m2.1a"><msub id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml"><mi id="S2.p3.2.m2.1.1.2" xref="S2.p3.2.m2.1.1.2.cmml">ω</mi><mi id="S2.p3.2.m2.1.1.3" xref="S2.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><apply id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.1.cmml" xref="S2.p3.2.m2.1.1">subscript</csymbol><ci id="S2.p3.2.m2.1.1.2.cmml" xref="S2.p3.2.m2.1.1.2">𝜔</ci><ci id="S2.p3.2.m2.1.1.3.cmml" xref="S2.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\omega_{i}</annotation></semantics></math> to have a different format and size. Thus, the global model’s parameter <math id="S2.p3.3.m3.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S2.p3.3.m3.1a"><mi id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><ci id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">\omega</annotation></semantics></math> cannot be optimized by averaging <math id="S2.p3.4.m4.1" class="ltx_Math" alttext="\omega_{i}" display="inline"><semantics id="S2.p3.4.m4.1a"><msub id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml"><mi id="S2.p3.4.m4.1.1.2" xref="S2.p3.4.m4.1.1.2.cmml">ω</mi><mi id="S2.p3.4.m4.1.1.3" xref="S2.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.1b"><apply id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p3.4.m4.1.1.1.cmml" xref="S2.p3.4.m4.1.1">subscript</csymbol><ci id="S2.p3.4.m4.1.1.2.cmml" xref="S2.p3.4.m4.1.1.2">𝜔</ci><ci id="S2.p3.4.m4.1.1.3.cmml" xref="S2.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.1c">\omega_{i}</annotation></semantics></math>.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Regularization in federated learning</span> Regularization is often employed in optimization tasks to mitigate the risk of overfitting by incorporating a penalty term to the loss function. In the context of federated learning, this is particularly useful for controlling the complexity of the global model. One popular approach is FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx11" title="" class="ltx_ref">11</a>]</cite>, which extends the FedAvg algorithm by appending a proximal term to the local optimization objective. Specifically, each client <math id="S2.p4.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p4.1.m1.1a"><mi id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">i</annotation></semantics></math> aims to minimize:</p>
</div>
<div id="S2.p5" class="ltx_para">
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.4" class="ltx_Math" alttext="\arg\min_{\omega_{i}}\mathcal{L}_{S}(\mathcal{F}_{i}(\omega_{i};x),y)+\frac{\mu}{2}\left\|\omega_{i}-\omega\right\|^{2}" display="block"><semantics id="S2.E3.m1.4a"><mrow id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml"><mrow id="S2.E3.m1.3.3.1" xref="S2.E3.m1.3.3.1.cmml"><mrow id="S2.E3.m1.3.3.1.3" xref="S2.E3.m1.3.3.1.3.cmml"><mi id="S2.E3.m1.3.3.1.3.1" xref="S2.E3.m1.3.3.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E3.m1.3.3.1.3a" xref="S2.E3.m1.3.3.1.3.cmml">⁡</mo><mrow id="S2.E3.m1.3.3.1.3.2" xref="S2.E3.m1.3.3.1.3.2.cmml"><munder id="S2.E3.m1.3.3.1.3.2.1" xref="S2.E3.m1.3.3.1.3.2.1.cmml"><mi id="S2.E3.m1.3.3.1.3.2.1.2" xref="S2.E3.m1.3.3.1.3.2.1.2.cmml">min</mi><msub id="S2.E3.m1.3.3.1.3.2.1.3" xref="S2.E3.m1.3.3.1.3.2.1.3.cmml"><mi id="S2.E3.m1.3.3.1.3.2.1.3.2" xref="S2.E3.m1.3.3.1.3.2.1.3.2.cmml">ω</mi><mi id="S2.E3.m1.3.3.1.3.2.1.3.3" xref="S2.E3.m1.3.3.1.3.2.1.3.3.cmml">i</mi></msub></munder><mo lspace="0.167em" id="S2.E3.m1.3.3.1.3.2a" xref="S2.E3.m1.3.3.1.3.2.cmml">⁡</mo><msub id="S2.E3.m1.3.3.1.3.2.2" xref="S2.E3.m1.3.3.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.3.3.1.3.2.2.2" xref="S2.E3.m1.3.3.1.3.2.2.2.cmml">ℒ</mi><mi id="S2.E3.m1.3.3.1.3.2.2.3" xref="S2.E3.m1.3.3.1.3.2.2.3.cmml">S</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.2" xref="S2.E3.m1.3.3.1.2.cmml">​</mo><mrow id="S2.E3.m1.3.3.1.1.1" xref="S2.E3.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.3.3.1.1.1.2" xref="S2.E3.m1.3.3.1.1.2.cmml">(</mo><mrow id="S2.E3.m1.3.3.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.cmml"><msub id="S2.E3.m1.3.3.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.3.3.1.1.1.1.3.2" xref="S2.E3.m1.3.3.1.1.1.1.3.2.cmml">ℱ</mi><mi id="S2.E3.m1.3.3.1.1.1.1.3.3" xref="S2.E3.m1.3.3.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.3.3.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.3.3.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.2.cmml">(</mo><msub id="S2.E3.m1.3.3.1.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E3.m1.3.3.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.2.cmml">;</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">x</mi><mo stretchy="false" id="S2.E3.m1.3.3.1.1.1.1.1.1.4" xref="S2.E3.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.3.3.1.1.1.3" xref="S2.E3.m1.3.3.1.1.2.cmml">,</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">y</mi><mo stretchy="false" id="S2.E3.m1.3.3.1.1.1.4" xref="S2.E3.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.4.4.3" xref="S2.E3.m1.4.4.3.cmml">+</mo><mrow id="S2.E3.m1.4.4.2" xref="S2.E3.m1.4.4.2.cmml"><mfrac id="S2.E3.m1.4.4.2.3" xref="S2.E3.m1.4.4.2.3.cmml"><mi id="S2.E3.m1.4.4.2.3.2" xref="S2.E3.m1.4.4.2.3.2.cmml">μ</mi><mn id="S2.E3.m1.4.4.2.3.3" xref="S2.E3.m1.4.4.2.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S2.E3.m1.4.4.2.2" xref="S2.E3.m1.4.4.2.2.cmml">​</mo><msup id="S2.E3.m1.4.4.2.1" xref="S2.E3.m1.4.4.2.1.cmml"><mrow id="S2.E3.m1.4.4.2.1.1.1" xref="S2.E3.m1.4.4.2.1.1.2.cmml"><mo id="S2.E3.m1.4.4.2.1.1.1.2" xref="S2.E3.m1.4.4.2.1.1.2.1.cmml">‖</mo><mrow id="S2.E3.m1.4.4.2.1.1.1.1" xref="S2.E3.m1.4.4.2.1.1.1.1.cmml"><msub id="S2.E3.m1.4.4.2.1.1.1.1.2" xref="S2.E3.m1.4.4.2.1.1.1.1.2.cmml"><mi id="S2.E3.m1.4.4.2.1.1.1.1.2.2" xref="S2.E3.m1.4.4.2.1.1.1.1.2.2.cmml">ω</mi><mi id="S2.E3.m1.4.4.2.1.1.1.1.2.3" xref="S2.E3.m1.4.4.2.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S2.E3.m1.4.4.2.1.1.1.1.1" xref="S2.E3.m1.4.4.2.1.1.1.1.1.cmml">−</mo><mi id="S2.E3.m1.4.4.2.1.1.1.1.3" xref="S2.E3.m1.4.4.2.1.1.1.1.3.cmml">ω</mi></mrow><mo id="S2.E3.m1.4.4.2.1.1.1.3" xref="S2.E3.m1.4.4.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E3.m1.4.4.2.1.3" xref="S2.E3.m1.4.4.2.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.4b"><apply id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4"><plus id="S2.E3.m1.4.4.3.cmml" xref="S2.E3.m1.4.4.3"></plus><apply id="S2.E3.m1.3.3.1.cmml" xref="S2.E3.m1.3.3.1"><times id="S2.E3.m1.3.3.1.2.cmml" xref="S2.E3.m1.3.3.1.2"></times><apply id="S2.E3.m1.3.3.1.3.cmml" xref="S2.E3.m1.3.3.1.3"><arg id="S2.E3.m1.3.3.1.3.1.cmml" xref="S2.E3.m1.3.3.1.3.1"></arg><apply id="S2.E3.m1.3.3.1.3.2.cmml" xref="S2.E3.m1.3.3.1.3.2"><apply id="S2.E3.m1.3.3.1.3.2.1.cmml" xref="S2.E3.m1.3.3.1.3.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.3.2.1.1.cmml" xref="S2.E3.m1.3.3.1.3.2.1">subscript</csymbol><min id="S2.E3.m1.3.3.1.3.2.1.2.cmml" xref="S2.E3.m1.3.3.1.3.2.1.2"></min><apply id="S2.E3.m1.3.3.1.3.2.1.3.cmml" xref="S2.E3.m1.3.3.1.3.2.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.3.2.1.3.1.cmml" xref="S2.E3.m1.3.3.1.3.2.1.3">subscript</csymbol><ci id="S2.E3.m1.3.3.1.3.2.1.3.2.cmml" xref="S2.E3.m1.3.3.1.3.2.1.3.2">𝜔</ci><ci id="S2.E3.m1.3.3.1.3.2.1.3.3.cmml" xref="S2.E3.m1.3.3.1.3.2.1.3.3">𝑖</ci></apply></apply><apply id="S2.E3.m1.3.3.1.3.2.2.cmml" xref="S2.E3.m1.3.3.1.3.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.3.2.2.1.cmml" xref="S2.E3.m1.3.3.1.3.2.2">subscript</csymbol><ci id="S2.E3.m1.3.3.1.3.2.2.2.cmml" xref="S2.E3.m1.3.3.1.3.2.2.2">ℒ</ci><ci id="S2.E3.m1.3.3.1.3.2.2.3.cmml" xref="S2.E3.m1.3.3.1.3.2.2.3">𝑆</ci></apply></apply></apply><interval closure="open" id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1"><apply id="S2.E3.m1.3.3.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1"><times id="S2.E3.m1.3.3.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.2"></times><apply id="S2.E3.m1.3.3.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3.2">ℱ</ci><ci id="S2.E3.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.3.3">𝑖</ci></apply><list id="S2.E3.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1"><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.2">𝜔</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝑥</ci></list></apply><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝑦</ci></interval></apply><apply id="S2.E3.m1.4.4.2.cmml" xref="S2.E3.m1.4.4.2"><times id="S2.E3.m1.4.4.2.2.cmml" xref="S2.E3.m1.4.4.2.2"></times><apply id="S2.E3.m1.4.4.2.3.cmml" xref="S2.E3.m1.4.4.2.3"><divide id="S2.E3.m1.4.4.2.3.1.cmml" xref="S2.E3.m1.4.4.2.3"></divide><ci id="S2.E3.m1.4.4.2.3.2.cmml" xref="S2.E3.m1.4.4.2.3.2">𝜇</ci><cn type="integer" id="S2.E3.m1.4.4.2.3.3.cmml" xref="S2.E3.m1.4.4.2.3.3">2</cn></apply><apply id="S2.E3.m1.4.4.2.1.cmml" xref="S2.E3.m1.4.4.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.2.1.2.cmml" xref="S2.E3.m1.4.4.2.1">superscript</csymbol><apply id="S2.E3.m1.4.4.2.1.1.2.cmml" xref="S2.E3.m1.4.4.2.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.4.4.2.1.1.2.1.cmml" xref="S2.E3.m1.4.4.2.1.1.1.2">norm</csymbol><apply id="S2.E3.m1.4.4.2.1.1.1.1.cmml" xref="S2.E3.m1.4.4.2.1.1.1.1"><minus id="S2.E3.m1.4.4.2.1.1.1.1.1.cmml" xref="S2.E3.m1.4.4.2.1.1.1.1.1"></minus><apply id="S2.E3.m1.4.4.2.1.1.1.1.2.cmml" xref="S2.E3.m1.4.4.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.4.4.2.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.4.4.2.1.1.1.1.2.2.cmml" xref="S2.E3.m1.4.4.2.1.1.1.1.2.2">𝜔</ci><ci id="S2.E3.m1.4.4.2.1.1.1.1.2.3.cmml" xref="S2.E3.m1.4.4.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E3.m1.4.4.2.1.1.1.1.3.cmml" xref="S2.E3.m1.4.4.2.1.1.1.1.3">𝜔</ci></apply></apply><cn type="integer" id="S2.E3.m1.4.4.2.1.3.cmml" xref="S2.E3.m1.4.4.2.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.4c">\arg\min_{\omega_{i}}\mathcal{L}_{S}(\mathcal{F}_{i}(\omega_{i};x),y)+\frac{\mu}{2}\left\|\omega_{i}-\omega\right\|^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.7" class="ltx_p">Here, <math id="S2.p6.1.m1.3" class="ltx_Math" alttext="\mathcal{L}_{S}(\mathcal{F}_{i}(\omega_{i};x),y)" display="inline"><semantics id="S2.p6.1.m1.3a"><mrow id="S2.p6.1.m1.3.3" xref="S2.p6.1.m1.3.3.cmml"><msub id="S2.p6.1.m1.3.3.3" xref="S2.p6.1.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p6.1.m1.3.3.3.2" xref="S2.p6.1.m1.3.3.3.2.cmml">ℒ</mi><mi id="S2.p6.1.m1.3.3.3.3" xref="S2.p6.1.m1.3.3.3.3.cmml">S</mi></msub><mo lspace="0em" rspace="0em" id="S2.p6.1.m1.3.3.2" xref="S2.p6.1.m1.3.3.2.cmml">​</mo><mrow id="S2.p6.1.m1.3.3.1.1" xref="S2.p6.1.m1.3.3.1.2.cmml"><mo stretchy="false" id="S2.p6.1.m1.3.3.1.1.2" xref="S2.p6.1.m1.3.3.1.2.cmml">(</mo><mrow id="S2.p6.1.m1.3.3.1.1.1" xref="S2.p6.1.m1.3.3.1.1.1.cmml"><msub id="S2.p6.1.m1.3.3.1.1.1.3" xref="S2.p6.1.m1.3.3.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p6.1.m1.3.3.1.1.1.3.2" xref="S2.p6.1.m1.3.3.1.1.1.3.2.cmml">ℱ</mi><mi id="S2.p6.1.m1.3.3.1.1.1.3.3" xref="S2.p6.1.m1.3.3.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.p6.1.m1.3.3.1.1.1.2" xref="S2.p6.1.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.p6.1.m1.3.3.1.1.1.1.1" xref="S2.p6.1.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.p6.1.m1.3.3.1.1.1.1.1.2" xref="S2.p6.1.m1.3.3.1.1.1.1.2.cmml">(</mo><msub id="S2.p6.1.m1.3.3.1.1.1.1.1.1" xref="S2.p6.1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.p6.1.m1.3.3.1.1.1.1.1.1.2" xref="S2.p6.1.m1.3.3.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S2.p6.1.m1.3.3.1.1.1.1.1.1.3" xref="S2.p6.1.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p6.1.m1.3.3.1.1.1.1.1.3" xref="S2.p6.1.m1.3.3.1.1.1.1.2.cmml">;</mo><mi id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S2.p6.1.m1.3.3.1.1.1.1.1.4" xref="S2.p6.1.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.p6.1.m1.3.3.1.1.3" xref="S2.p6.1.m1.3.3.1.2.cmml">,</mo><mi id="S2.p6.1.m1.2.2" xref="S2.p6.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S2.p6.1.m1.3.3.1.1.4" xref="S2.p6.1.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.3b"><apply id="S2.p6.1.m1.3.3.cmml" xref="S2.p6.1.m1.3.3"><times id="S2.p6.1.m1.3.3.2.cmml" xref="S2.p6.1.m1.3.3.2"></times><apply id="S2.p6.1.m1.3.3.3.cmml" xref="S2.p6.1.m1.3.3.3"><csymbol cd="ambiguous" id="S2.p6.1.m1.3.3.3.1.cmml" xref="S2.p6.1.m1.3.3.3">subscript</csymbol><ci id="S2.p6.1.m1.3.3.3.2.cmml" xref="S2.p6.1.m1.3.3.3.2">ℒ</ci><ci id="S2.p6.1.m1.3.3.3.3.cmml" xref="S2.p6.1.m1.3.3.3.3">𝑆</ci></apply><interval closure="open" id="S2.p6.1.m1.3.3.1.2.cmml" xref="S2.p6.1.m1.3.3.1.1"><apply id="S2.p6.1.m1.3.3.1.1.1.cmml" xref="S2.p6.1.m1.3.3.1.1.1"><times id="S2.p6.1.m1.3.3.1.1.1.2.cmml" xref="S2.p6.1.m1.3.3.1.1.1.2"></times><apply id="S2.p6.1.m1.3.3.1.1.1.3.cmml" xref="S2.p6.1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.p6.1.m1.3.3.1.1.1.3.1.cmml" xref="S2.p6.1.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S2.p6.1.m1.3.3.1.1.1.3.2.cmml" xref="S2.p6.1.m1.3.3.1.1.1.3.2">ℱ</ci><ci id="S2.p6.1.m1.3.3.1.1.1.3.3.cmml" xref="S2.p6.1.m1.3.3.1.1.1.3.3">𝑖</ci></apply><list id="S2.p6.1.m1.3.3.1.1.1.1.2.cmml" xref="S2.p6.1.m1.3.3.1.1.1.1.1"><apply id="S2.p6.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.p6.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p6.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.p6.1.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p6.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.p6.1.m1.3.3.1.1.1.1.1.1.2">𝜔</ci><ci id="S2.p6.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.p6.1.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1">𝑥</ci></list></apply><ci id="S2.p6.1.m1.2.2.cmml" xref="S2.p6.1.m1.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.3c">\mathcal{L}_{S}(\mathcal{F}_{i}(\omega_{i};x),y)</annotation></semantics></math> represents the local loss for client <math id="S2.p6.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p6.2.m2.1a"><mi id="S2.p6.2.m2.1.1" xref="S2.p6.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p6.2.m2.1b"><ci id="S2.p6.2.m2.1.1.cmml" xref="S2.p6.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.2.m2.1c">i</annotation></semantics></math> (as defined in Eq. <a href="#S2.E2" title="In 2 Problem setting and background ‣ Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), <math id="S2.p6.3.m3.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S2.p6.3.m3.1a"><mi id="S2.p6.3.m3.1.1" xref="S2.p6.3.m3.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.p6.3.m3.1b"><ci id="S2.p6.3.m3.1.1.cmml" xref="S2.p6.3.m3.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.3.m3.1c">\omega</annotation></semantics></math> are the global model parameters, <math id="S2.p6.4.m4.1" class="ltx_Math" alttext="\omega_{i}" display="inline"><semantics id="S2.p6.4.m4.1a"><msub id="S2.p6.4.m4.1.1" xref="S2.p6.4.m4.1.1.cmml"><mi id="S2.p6.4.m4.1.1.2" xref="S2.p6.4.m4.1.1.2.cmml">ω</mi><mi id="S2.p6.4.m4.1.1.3" xref="S2.p6.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.4.m4.1b"><apply id="S2.p6.4.m4.1.1.cmml" xref="S2.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p6.4.m4.1.1.1.cmml" xref="S2.p6.4.m4.1.1">subscript</csymbol><ci id="S2.p6.4.m4.1.1.2.cmml" xref="S2.p6.4.m4.1.1.2">𝜔</ci><ci id="S2.p6.4.m4.1.1.3.cmml" xref="S2.p6.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.4.m4.1c">\omega_{i}</annotation></semantics></math> are the local model parameters for client <math id="S2.p6.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p6.5.m5.1a"><mi id="S2.p6.5.m5.1.1" xref="S2.p6.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p6.5.m5.1b"><ci id="S2.p6.5.m5.1.1.cmml" xref="S2.p6.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.5.m5.1c">i</annotation></semantics></math>, and <math id="S2.p6.6.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S2.p6.6.m6.1a"><mi id="S2.p6.6.m6.1.1" xref="S2.p6.6.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S2.p6.6.m6.1b"><ci id="S2.p6.6.m6.1.1.cmml" xref="S2.p6.6.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.6.m6.1c">\mu</annotation></semantics></math> is the regularization parameter. The server updates the global model <math id="S2.p6.7.m7.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S2.p6.7.m7.1a"><mi id="S2.p6.7.m7.1.1" xref="S2.p6.7.m7.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.p6.7.m7.1b"><ci id="S2.p6.7.m7.1.1.cmml" xref="S2.p6.7.m7.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.7.m7.1c">\omega</annotation></semantics></math> in a manner similar to FedAvg:</p>
</div>
<div id="S2.p7" class="ltx_para">
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.1" class="ltx_Math" alttext="\omega=\sum_{i=1}^{m}\frac{|D_{i}|}{N}\omega_{i}" display="block"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.2" xref="S2.E4.m1.1.2.cmml"><mi id="S2.E4.m1.1.2.2" xref="S2.E4.m1.1.2.2.cmml">ω</mi><mo rspace="0.111em" id="S2.E4.m1.1.2.1" xref="S2.E4.m1.1.2.1.cmml">=</mo><mrow id="S2.E4.m1.1.2.3" xref="S2.E4.m1.1.2.3.cmml"><munderover id="S2.E4.m1.1.2.3.1" xref="S2.E4.m1.1.2.3.1.cmml"><mo movablelimits="false" id="S2.E4.m1.1.2.3.1.2.2" xref="S2.E4.m1.1.2.3.1.2.2.cmml">∑</mo><mrow id="S2.E4.m1.1.2.3.1.2.3" xref="S2.E4.m1.1.2.3.1.2.3.cmml"><mi id="S2.E4.m1.1.2.3.1.2.3.2" xref="S2.E4.m1.1.2.3.1.2.3.2.cmml">i</mi><mo id="S2.E4.m1.1.2.3.1.2.3.1" xref="S2.E4.m1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S2.E4.m1.1.2.3.1.2.3.3" xref="S2.E4.m1.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E4.m1.1.2.3.1.3" xref="S2.E4.m1.1.2.3.1.3.cmml">m</mi></munderover><mrow id="S2.E4.m1.1.2.3.2" xref="S2.E4.m1.1.2.3.2.cmml"><mfrac id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.2.1.cmml">|</mo><msub id="S2.E4.m1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.2.cmml">D</mi><mi id="S2.E4.m1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E4.m1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.2.1.cmml">|</mo></mrow><mi id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.2.3.2.1" xref="S2.E4.m1.1.2.3.2.1.cmml">​</mo><msub id="S2.E4.m1.1.2.3.2.2" xref="S2.E4.m1.1.2.3.2.2.cmml"><mi id="S2.E4.m1.1.2.3.2.2.2" xref="S2.E4.m1.1.2.3.2.2.2.cmml">ω</mi><mi id="S2.E4.m1.1.2.3.2.2.3" xref="S2.E4.m1.1.2.3.2.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.2.cmml" xref="S2.E4.m1.1.2"><eq id="S2.E4.m1.1.2.1.cmml" xref="S2.E4.m1.1.2.1"></eq><ci id="S2.E4.m1.1.2.2.cmml" xref="S2.E4.m1.1.2.2">𝜔</ci><apply id="S2.E4.m1.1.2.3.cmml" xref="S2.E4.m1.1.2.3"><apply id="S2.E4.m1.1.2.3.1.cmml" xref="S2.E4.m1.1.2.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.3.1.1.cmml" xref="S2.E4.m1.1.2.3.1">superscript</csymbol><apply id="S2.E4.m1.1.2.3.1.2.cmml" xref="S2.E4.m1.1.2.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.3.1.2.1.cmml" xref="S2.E4.m1.1.2.3.1">subscript</csymbol><sum id="S2.E4.m1.1.2.3.1.2.2.cmml" xref="S2.E4.m1.1.2.3.1.2.2"></sum><apply id="S2.E4.m1.1.2.3.1.2.3.cmml" xref="S2.E4.m1.1.2.3.1.2.3"><eq id="S2.E4.m1.1.2.3.1.2.3.1.cmml" xref="S2.E4.m1.1.2.3.1.2.3.1"></eq><ci id="S2.E4.m1.1.2.3.1.2.3.2.cmml" xref="S2.E4.m1.1.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S2.E4.m1.1.2.3.1.2.3.3.cmml" xref="S2.E4.m1.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E4.m1.1.2.3.1.3.cmml" xref="S2.E4.m1.1.2.3.1.3">𝑚</ci></apply><apply id="S2.E4.m1.1.2.3.2.cmml" xref="S2.E4.m1.1.2.3.2"><times id="S2.E4.m1.1.2.3.2.1.cmml" xref="S2.E4.m1.1.2.3.2.1"></times><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><divide id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1"></divide><apply id="S2.E4.m1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1"><abs id="S2.E4.m1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2"></abs><apply id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.2">𝐷</ci><ci id="S2.E4.m1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3">𝑁</ci></apply><apply id="S2.E4.m1.1.2.3.2.2.cmml" xref="S2.E4.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.3.2.2.1.cmml" xref="S2.E4.m1.1.2.3.2.2">subscript</csymbol><ci id="S2.E4.m1.1.2.3.2.2.2.cmml" xref="S2.E4.m1.1.2.3.2.2.2">𝜔</ci><ci id="S2.E4.m1.1.2.3.2.2.3.cmml" xref="S2.E4.m1.1.2.3.2.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\omega=\sum_{i=1}^{m}\frac{|D_{i}|}{N}\omega_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.p8" class="ltx_para">
<p id="S2.p8.1" class="ltx_p">Various other techniques like FOLB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx19" title="" class="ltx_ref">19</a>]</cite>, MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx10" title="" class="ltx_ref">10</a>]</cite>, and FedSplit <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx21" title="" class="ltx_ref">21</a>]</cite> also leverage regularization to ensure that local models do not deviate significantly from the global model. However, regularization based methods like FedProx limit the global representation of models, a crucial aspect in federated learning, particularly when dealing with non-i.i.d data. This limitation stems from the predominant evaluation of these models in environments emphasizing localized structures and spatial hierarchies, primarily due to the reliance on convolution-based models. Such constraints in addressing non-i.i.d data distributions lead to the exploration of more personalized FL solutions, such as FedBN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx14" title="" class="ltx_ref">14</a>]</cite>, FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx2" title="" class="ltx_ref">2</a>]</cite>, and pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx3" title="" class="ltx_ref">3</a>]</cite>.

<br class="ltx_break">FL, with its privacy-preserving capabilities, has found utility in numerous medical tasks<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx9" title="" class="ltx_ref">9</a>, <a href="#bib.bibx30" title="" class="ltx_ref">30</a>, <a href="#bib.bibx20" title="" class="ltx_ref">20</a>, <a href="#bib.bibx6" title="" class="ltx_ref">6</a>, <a href="#bib.bibx23" title="" class="ltx_ref">23</a>]</cite>. Notable applications of FL in medical imaging are seen in multi-institutional brain tumor segmentation<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx12" title="" class="ltx_ref">12</a>, <a href="#bib.bibx27" title="" class="ltx_ref">27</a>]</cite>, breast density classification<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx24" title="" class="ltx_ref">24</a>]</cite>,MRI reconstruction<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx6" title="" class="ltx_ref">6</a>]</cite> and fMRI analysis<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx15" title="" class="ltx_ref">15</a>]</cite>. Challenges presented by non-i.i.d. data in medical imaging, however, remain unresolved<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx23" title="" class="ltx_ref">23</a>]</cite>, as Non-i.i.d. data largely impacts FedAvg algorithm’s convergence speed<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx13" title="" class="ltx_ref">13</a>, <a href="#bib.bibx25" title="" class="ltx_ref">25</a>]</cite>.</p>
</div>
<div id="S2.p9" class="ltx_para">
<p id="S2.p9.1" class="ltx_p"><span id="S2.p9.1.1" class="ltx_text ltx_font_bold">Vision Transformers</span>
Dosovitskiy et al.’s Vision Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx4" title="" class="ltx_ref">4</a>]</cite> have set benchmarks in computer vision and medical image analysis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx16" title="" class="ltx_ref">16</a>, <a href="#bib.bibx7" title="" class="ltx_ref">7</a>, <a href="#bib.bibx26" title="" class="ltx_ref">26</a>]</cite>. Swin Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx16" title="" class="ltx_ref">16</a>]</cite> enhance Vision transformers by adopting hierarchical architecture with patch merging and relative position embedding. In the medical field, Vision transformers have been intergrated in the U-shaped CNN architectures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx7" title="" class="ltx_ref">7</a>, <a href="#bib.bibx36" title="" class="ltx_ref">36</a>]</cite>. Yet, both UNETR and nnFormer, despite their respective merits, have computational limitations due to the constraints of fixed token size and limited receptive field of CNN layers, respectively.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Global-Local Encoder Alignment</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Image representation in Vision Transformers</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.8" class="ltx_p">The Vision Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx29" title="" class="ltx_ref">29</a>, <a href="#bib.bibx4" title="" class="ltx_ref">4</a>]</cite> is a prominent architecture for vision tasks that primarily relies on Multi-Head Self-Attention (MHSA) to model long-range dependencies among input features. Given an input tensor <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{X}\in\mathbb{R}^{H\times W\times C}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝐗</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.3.2" xref="S3.SS1.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.1.m1.1.1.3.3.1" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.1.m1.1.1.3.3.1a" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.4" xref="S3.SS1.p1.1.m1.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐗</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3"><times id="S3.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.3">𝑊</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.4.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathbf{X}\in\mathbb{R}^{H\times W\times C}</annotation></semantics></math> where <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">H</annotation></semantics></math>, <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">W</annotation></semantics></math>, and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">C</annotation></semantics></math> are the height, width, and the feature dimension,
we first reshape <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{X}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathbf{X}</annotation></semantics></math> and define the query <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{Q}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathbf{Q}</annotation></semantics></math>, key <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathbf{K}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathbf{K}</annotation></semantics></math>, and value <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="\mathbf{V}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\mathbf{V}</annotation></semantics></math> as follows:</p>
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{X}\in\mathbb{R}^{H\times W\times C}" display="inline"><semantics id="S3.E5X.2.1.1.m1.1a"><mrow id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.2.cmml">𝐗</mi><mo id="S3.E5X.2.1.1.m1.1.1.1" xref="S3.E5X.2.1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.E5X.2.1.1.m1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.3.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.3.2" xref="S3.E5X.2.1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.E5X.2.1.1.m1.1.1.3.3" xref="S3.E5X.2.1.1.m1.1.1.3.3.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.3.3.2" xref="S3.E5X.2.1.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E5X.2.1.1.m1.1.1.3.3.1" xref="S3.E5X.2.1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.E5X.2.1.1.m1.1.1.3.3.3" xref="S3.E5X.2.1.1.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E5X.2.1.1.m1.1.1.3.3.1a" xref="S3.E5X.2.1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.E5X.2.1.1.m1.1.1.3.3.4" xref="S3.E5X.2.1.1.m1.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><apply id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1"><in id="S3.E5X.2.1.1.m1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.1"></in><ci id="S3.E5X.2.1.1.m1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2">𝐗</ci><apply id="S3.E5X.2.1.1.m1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.3">superscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.E5X.2.1.1.m1.1.1.3.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.3"><times id="S3.E5X.2.1.1.m1.1.1.3.3.1.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.3.1"></times><ci id="S3.E5X.2.1.1.m1.1.1.3.3.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.E5X.2.1.1.m1.1.1.3.3.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.3.3">𝑊</ci><ci id="S3.E5X.2.1.1.m1.1.1.3.3.4.cmml" xref="S3.E5X.2.1.1.m1.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\mathbf{X}\in\mathbb{R}^{H\times W\times C}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle\to\mathbf{X}\in\mathbb{R}^{(H\times W)\times C}," display="inline"><semantics id="S3.E5X.3.2.2.m1.2a"><mrow id="S3.E5X.3.2.2.m1.2.2.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.2.2.1.1" xref="S3.E5X.3.2.2.m1.2.2.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.2.cmml"></mi><mo stretchy="false" id="S3.E5X.3.2.2.m1.2.2.1.1.3" xref="S3.E5X.3.2.2.m1.2.2.1.1.3.cmml">→</mo><mi id="S3.E5X.3.2.2.m1.2.2.1.1.4" xref="S3.E5X.3.2.2.m1.2.2.1.1.4.cmml">𝐗</mi><mo id="S3.E5X.3.2.2.m1.2.2.1.1.5" xref="S3.E5X.3.2.2.m1.2.2.1.1.5.cmml">∈</mo><msup id="S3.E5X.3.2.2.m1.2.2.1.1.6" xref="S3.E5X.3.2.2.m1.2.2.1.1.6.cmml"><mi id="S3.E5X.3.2.2.m1.2.2.1.1.6.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.6.2.cmml">ℝ</mi><mrow id="S3.E5X.3.2.2.m1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.cmml">×</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.cmml">W</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E5X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E5X.3.2.2.m1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.2.cmml">×</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.3.cmml">C</mi></mrow></msup></mrow><mo id="S3.E5X.3.2.2.m1.2.2.1.2" xref="S3.E5X.3.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.2b"><apply id="S3.E5X.3.2.2.m1.2.2.1.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1"><and id="S3.E5X.3.2.2.m1.2.2.1.1a.cmml" xref="S3.E5X.3.2.2.m1.2.2.1"></and><apply id="S3.E5X.3.2.2.m1.2.2.1.1b.cmml" xref="S3.E5X.3.2.2.m1.2.2.1"><ci id="S3.E5X.3.2.2.m1.2.2.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.3">→</ci><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.2.2.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.2">absent</csymbol><ci id="S3.E5X.3.2.2.m1.2.2.1.1.4.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.4">𝐗</ci></apply><apply id="S3.E5X.3.2.2.m1.2.2.1.1c.cmml" xref="S3.E5X.3.2.2.m1.2.2.1"><in id="S3.E5X.3.2.2.m1.2.2.1.1.5.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.5"></in><share href="#S3.E5X.3.2.2.m1.2.2.1.1.4.cmml" id="S3.E5X.3.2.2.m1.2.2.1.1d.cmml" xref="S3.E5X.3.2.2.m1.2.2.1"></share><apply id="S3.E5X.3.2.2.m1.2.2.1.1.6.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.2.2.1.1.6.1.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.6">superscript</csymbol><ci id="S3.E5X.3.2.2.m1.2.2.1.1.6.2.cmml" xref="S3.E5X.3.2.2.m1.2.2.1.1.6.2">ℝ</ci><apply id="S3.E5X.3.2.2.m1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1"><times id="S3.E5X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.2"></times><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1"><times id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1"></times><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.2">𝐻</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3">𝑊</ci></apply><ci id="S3.E5X.3.2.2.m1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.2c">\displaystyle\to\mathbf{X}\in\mathbb{R}^{(H\times W)\times C},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S3.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5Xa.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{Q}=\mathbf{X}\mathbf{W}^{q},\qquad\mathbf{K}" display="inline"><semantics id="S3.E5Xa.2.1.1.m1.2a"><mrow id="S3.E5Xa.2.1.1.m1.2.2" xref="S3.E5Xa.2.1.1.m1.2.2.cmml"><mi id="S3.E5Xa.2.1.1.m1.2.2.3" xref="S3.E5Xa.2.1.1.m1.2.2.3.cmml">𝐐</mi><mo id="S3.E5Xa.2.1.1.m1.2.2.2" xref="S3.E5Xa.2.1.1.m1.2.2.2.cmml">=</mo><mrow id="S3.E5Xa.2.1.1.m1.2.2.1.1" xref="S3.E5Xa.2.1.1.m1.2.2.1.2.cmml"><msup id="S3.E5Xa.2.1.1.m1.2.2.1.1.1" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.2.cmml">𝐗𝐖</mi><mi id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.3" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.3.cmml">q</mi></msup><mo rspace="2.167em" id="S3.E5Xa.2.1.1.m1.2.2.1.1.2" xref="S3.E5Xa.2.1.1.m1.2.2.1.2.cmml">,</mo><mi id="S3.E5Xa.2.1.1.m1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.cmml">𝐊</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.2b"><apply id="S3.E5Xa.2.1.1.m1.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2"><eq id="S3.E5Xa.2.1.1.m1.2.2.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.2"></eq><ci id="S3.E5Xa.2.1.1.m1.2.2.3.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.3">𝐐</ci><list id="S3.E5Xa.2.1.1.m1.2.2.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1"><apply id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1">superscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.2">𝐗𝐖</ci><ci id="S3.E5Xa.2.1.1.m1.2.2.1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.2.2.1.1.1.3">𝑞</ci></apply><ci id="S3.E5Xa.2.1.1.m1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1">𝐊</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.2c">\displaystyle\mathbf{Q}=\mathbf{X}\mathbf{W}^{q},\qquad\mathbf{K}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\mathbf{X}\mathbf{W}^{k},\qquad\mathbf{V}=\mathbf{X}\mathbf{W}^{v}," display="inline"><semantics id="S3.E5Xa.3.2.2.m1.1a"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml"></mi><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">=</mo><msup id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">𝐗𝐖</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">k</mi></msup></mrow><mo rspace="2.167em" id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.cmml">𝐕</mi><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.1.cmml">=</mo><msup id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.2.cmml">𝐗𝐖</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.cmml">v</mi></msup></mrow></mrow><mo id="S3.E5Xa.3.2.2.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.3.2.2.m1.1b"><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.3a.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1"><eq id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.2">absent</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.2">𝐗𝐖</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2"><eq id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.1"></eq><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.2">𝐕</ci><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.2">𝐗𝐖</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.2.3.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.3.2.2.m1.1c">\displaystyle=\mathbf{X}\mathbf{W}^{k},\qquad\mathbf{V}=\mathbf{X}\mathbf{W}^{v},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p1.11" class="ltx_p">where <math id="S3.SS1.p1.9.m1.1" class="ltx_Math" alttext="\mathbf{W}^{q}\in\mathbb{R}^{C\times C}" display="inline"><semantics id="S3.SS1.p1.9.m1.1a"><mrow id="S3.SS1.p1.9.m1.1.1" xref="S3.SS1.p1.9.m1.1.1.cmml"><msup id="S3.SS1.p1.9.m1.1.1.2" xref="S3.SS1.p1.9.m1.1.1.2.cmml"><mi id="S3.SS1.p1.9.m1.1.1.2.2" xref="S3.SS1.p1.9.m1.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS1.p1.9.m1.1.1.2.3" xref="S3.SS1.p1.9.m1.1.1.2.3.cmml">q</mi></msup><mo id="S3.SS1.p1.9.m1.1.1.1" xref="S3.SS1.p1.9.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.9.m1.1.1.3" xref="S3.SS1.p1.9.m1.1.1.3.cmml"><mi id="S3.SS1.p1.9.m1.1.1.3.2" xref="S3.SS1.p1.9.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.9.m1.1.1.3.3" xref="S3.SS1.p1.9.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.9.m1.1.1.3.3.2" xref="S3.SS1.p1.9.m1.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.9.m1.1.1.3.3.1" xref="S3.SS1.p1.9.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.9.m1.1.1.3.3.3" xref="S3.SS1.p1.9.m1.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m1.1b"><apply id="S3.SS1.p1.9.m1.1.1.cmml" xref="S3.SS1.p1.9.m1.1.1"><in id="S3.SS1.p1.9.m1.1.1.1.cmml" xref="S3.SS1.p1.9.m1.1.1.1"></in><apply id="S3.SS1.p1.9.m1.1.1.2.cmml" xref="S3.SS1.p1.9.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m1.1.1.2.1.cmml" xref="S3.SS1.p1.9.m1.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.9.m1.1.1.2.2.cmml" xref="S3.SS1.p1.9.m1.1.1.2.2">𝐖</ci><ci id="S3.SS1.p1.9.m1.1.1.2.3.cmml" xref="S3.SS1.p1.9.m1.1.1.2.3">𝑞</ci></apply><apply id="S3.SS1.p1.9.m1.1.1.3.cmml" xref="S3.SS1.p1.9.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m1.1.1.3.1.cmml" xref="S3.SS1.p1.9.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.9.m1.1.1.3.2.cmml" xref="S3.SS1.p1.9.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.9.m1.1.1.3.3.cmml" xref="S3.SS1.p1.9.m1.1.1.3.3"><times id="S3.SS1.p1.9.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.9.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.9.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.9.m1.1.1.3.3.2">𝐶</ci><ci id="S3.SS1.p1.9.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.9.m1.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m1.1c">\mathbf{W}^{q}\in\mathbb{R}^{C\times C}</annotation></semantics></math>, <math id="S3.SS1.p1.10.m2.1" class="ltx_Math" alttext="\mathbf{W}^{k}\in\mathbb{R}^{C\times C}" display="inline"><semantics id="S3.SS1.p1.10.m2.1a"><mrow id="S3.SS1.p1.10.m2.1.1" xref="S3.SS1.p1.10.m2.1.1.cmml"><msup id="S3.SS1.p1.10.m2.1.1.2" xref="S3.SS1.p1.10.m2.1.1.2.cmml"><mi id="S3.SS1.p1.10.m2.1.1.2.2" xref="S3.SS1.p1.10.m2.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS1.p1.10.m2.1.1.2.3" xref="S3.SS1.p1.10.m2.1.1.2.3.cmml">k</mi></msup><mo id="S3.SS1.p1.10.m2.1.1.1" xref="S3.SS1.p1.10.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.10.m2.1.1.3" xref="S3.SS1.p1.10.m2.1.1.3.cmml"><mi id="S3.SS1.p1.10.m2.1.1.3.2" xref="S3.SS1.p1.10.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.10.m2.1.1.3.3" xref="S3.SS1.p1.10.m2.1.1.3.3.cmml"><mi id="S3.SS1.p1.10.m2.1.1.3.3.2" xref="S3.SS1.p1.10.m2.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.10.m2.1.1.3.3.1" xref="S3.SS1.p1.10.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.10.m2.1.1.3.3.3" xref="S3.SS1.p1.10.m2.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m2.1b"><apply id="S3.SS1.p1.10.m2.1.1.cmml" xref="S3.SS1.p1.10.m2.1.1"><in id="S3.SS1.p1.10.m2.1.1.1.cmml" xref="S3.SS1.p1.10.m2.1.1.1"></in><apply id="S3.SS1.p1.10.m2.1.1.2.cmml" xref="S3.SS1.p1.10.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m2.1.1.2.1.cmml" xref="S3.SS1.p1.10.m2.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.10.m2.1.1.2.2.cmml" xref="S3.SS1.p1.10.m2.1.1.2.2">𝐖</ci><ci id="S3.SS1.p1.10.m2.1.1.2.3.cmml" xref="S3.SS1.p1.10.m2.1.1.2.3">𝑘</ci></apply><apply id="S3.SS1.p1.10.m2.1.1.3.cmml" xref="S3.SS1.p1.10.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m2.1.1.3.1.cmml" xref="S3.SS1.p1.10.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.10.m2.1.1.3.2.cmml" xref="S3.SS1.p1.10.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.10.m2.1.1.3.3.cmml" xref="S3.SS1.p1.10.m2.1.1.3.3"><times id="S3.SS1.p1.10.m2.1.1.3.3.1.cmml" xref="S3.SS1.p1.10.m2.1.1.3.3.1"></times><ci id="S3.SS1.p1.10.m2.1.1.3.3.2.cmml" xref="S3.SS1.p1.10.m2.1.1.3.3.2">𝐶</ci><ci id="S3.SS1.p1.10.m2.1.1.3.3.3.cmml" xref="S3.SS1.p1.10.m2.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m2.1c">\mathbf{W}^{k}\in\mathbb{R}^{C\times C}</annotation></semantics></math>, and <math id="S3.SS1.p1.11.m3.1" class="ltx_Math" alttext="\mathbf{W}^{v}\in\mathbb{R}^{C\times C}" display="inline"><semantics id="S3.SS1.p1.11.m3.1a"><mrow id="S3.SS1.p1.11.m3.1.1" xref="S3.SS1.p1.11.m3.1.1.cmml"><msup id="S3.SS1.p1.11.m3.1.1.2" xref="S3.SS1.p1.11.m3.1.1.2.cmml"><mi id="S3.SS1.p1.11.m3.1.1.2.2" xref="S3.SS1.p1.11.m3.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS1.p1.11.m3.1.1.2.3" xref="S3.SS1.p1.11.m3.1.1.2.3.cmml">v</mi></msup><mo id="S3.SS1.p1.11.m3.1.1.1" xref="S3.SS1.p1.11.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.11.m3.1.1.3" xref="S3.SS1.p1.11.m3.1.1.3.cmml"><mi id="S3.SS1.p1.11.m3.1.1.3.2" xref="S3.SS1.p1.11.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.11.m3.1.1.3.3" xref="S3.SS1.p1.11.m3.1.1.3.3.cmml"><mi id="S3.SS1.p1.11.m3.1.1.3.3.2" xref="S3.SS1.p1.11.m3.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.11.m3.1.1.3.3.1" xref="S3.SS1.p1.11.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.11.m3.1.1.3.3.3" xref="S3.SS1.p1.11.m3.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m3.1b"><apply id="S3.SS1.p1.11.m3.1.1.cmml" xref="S3.SS1.p1.11.m3.1.1"><in id="S3.SS1.p1.11.m3.1.1.1.cmml" xref="S3.SS1.p1.11.m3.1.1.1"></in><apply id="S3.SS1.p1.11.m3.1.1.2.cmml" xref="S3.SS1.p1.11.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m3.1.1.2.1.cmml" xref="S3.SS1.p1.11.m3.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.11.m3.1.1.2.2.cmml" xref="S3.SS1.p1.11.m3.1.1.2.2">𝐖</ci><ci id="S3.SS1.p1.11.m3.1.1.2.3.cmml" xref="S3.SS1.p1.11.m3.1.1.2.3">𝑣</ci></apply><apply id="S3.SS1.p1.11.m3.1.1.3.cmml" xref="S3.SS1.p1.11.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m3.1.1.3.1.cmml" xref="S3.SS1.p1.11.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.11.m3.1.1.3.2.cmml" xref="S3.SS1.p1.11.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.11.m3.1.1.3.3.cmml" xref="S3.SS1.p1.11.m3.1.1.3.3"><times id="S3.SS1.p1.11.m3.1.1.3.3.1.cmml" xref="S3.SS1.p1.11.m3.1.1.3.3.1"></times><ci id="S3.SS1.p1.11.m3.1.1.3.3.2.cmml" xref="S3.SS1.p1.11.m3.1.1.3.3.2">𝐶</ci><ci id="S3.SS1.p1.11.m3.1.1.3.3.3.cmml" xref="S3.SS1.p1.11.m3.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m3.1c">\mathbf{W}^{v}\in\mathbb{R}^{C\times C}</annotation></semantics></math> represent the linear transformation weight matrices, which are trainable. Assuming the input and output share the same dimensions, the traditional MHSA can be expressed as:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\mathbf{A}={\rm Softmax}(\mathbf{Q}\mathbf{K}^{\rm T}/\sqrt{d})\mathbf{V}," display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml">𝐀</mi><mo id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml">Softmax</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E6.m1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐐𝐊</mi><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">/</mo><msqrt id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml">d</mi></msqrt></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.1.2a" xref="S3.E6.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E6.m1.1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.1.4.cmml">𝐕</mi></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></eq><ci id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3">𝐀</ci><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"></times><ci id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3">Softmax</ci><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"><divide id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"></divide><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2">𝐐𝐊</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3">T</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3"><root id="S3.E6.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3"></root><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2">𝑑</ci></apply></apply><ci id="S3.E6.m1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.1.4">𝐕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathbf{A}={\rm Softmax}(\mathbf{Q}\mathbf{K}^{\rm T}/\sqrt{d})\mathbf{V},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.14" class="ltx_p">in which <math id="S3.SS1.p1.12.m1.1" class="ltx_Math" alttext="\sqrt{d}" display="inline"><semantics id="S3.SS1.p1.12.m1.1a"><msqrt id="S3.SS1.p1.12.m1.1.1" xref="S3.SS1.p1.12.m1.1.1.cmml"><mi id="S3.SS1.p1.12.m1.1.1.2" xref="S3.SS1.p1.12.m1.1.1.2.cmml">d</mi></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m1.1b"><apply id="S3.SS1.p1.12.m1.1.1.cmml" xref="S3.SS1.p1.12.m1.1.1"><root id="S3.SS1.p1.12.m1.1.1a.cmml" xref="S3.SS1.p1.12.m1.1.1"></root><ci id="S3.SS1.p1.12.m1.1.1.2.cmml" xref="S3.SS1.p1.12.m1.1.1.2">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m1.1c">\sqrt{d}</annotation></semantics></math> means an approximate normalization, and the <math id="S3.SS1.p1.13.m2.1" class="ltx_Math" alttext="{\rm Softmax}" display="inline"><semantics id="S3.SS1.p1.13.m2.1a"><mi id="S3.SS1.p1.13.m2.1.1" xref="S3.SS1.p1.13.m2.1.1.cmml">Softmax</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m2.1b"><ci id="S3.SS1.p1.13.m2.1.1.cmml" xref="S3.SS1.p1.13.m2.1.1">Softmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m2.1c">{\rm Softmax}</annotation></semantics></math> function is applied to the rows of the matrix.
We simplify the discussion by omitting the concept of multiple heads. In <a href="#S3.E6" title="In 3.1 Image representation in Vision Transformers ‣ 3 Global-Local Encoder Alignment ‣ Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, the matrix product of <math id="S3.SS1.p1.14.m3.1" class="ltx_Math" alttext="\mathbf{Q}\mathbf{K}^{\rm T}" display="inline"><semantics id="S3.SS1.p1.14.m3.1a"><msup id="S3.SS1.p1.14.m3.1.1" xref="S3.SS1.p1.14.m3.1.1.cmml"><mi id="S3.SS1.p1.14.m3.1.1.2" xref="S3.SS1.p1.14.m3.1.1.2.cmml">𝐐𝐊</mi><mi mathvariant="normal" id="S3.SS1.p1.14.m3.1.1.3" xref="S3.SS1.p1.14.m3.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m3.1b"><apply id="S3.SS1.p1.14.m3.1.1.cmml" xref="S3.SS1.p1.14.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m3.1.1.1.cmml" xref="S3.SS1.p1.14.m3.1.1">superscript</csymbol><ci id="S3.SS1.p1.14.m3.1.1.2.cmml" xref="S3.SS1.p1.14.m3.1.1.2">𝐐𝐊</ci><ci id="S3.SS1.p1.14.m3.1.1.3.cmml" xref="S3.SS1.p1.14.m3.1.1.3">T</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m3.1c">\mathbf{Q}\mathbf{K}^{\rm T}</annotation></semantics></math> computes the pairwise similarity between tokens. Then, each new token is derived from a combination of all tokens based on their similarity.
Following the computation of MHSA, a residual connection is added to facilitate optimization, as shown below:</p>
<table id="S3.E7" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E7X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{X}\in\mathbb{R}^{(H\times W)\times C}" display="inline"><semantics id="S3.E7X.2.1.1.m1.1a"><mrow id="S3.E7X.2.1.1.m1.1.2" xref="S3.E7X.2.1.1.m1.1.2.cmml"><mi id="S3.E7X.2.1.1.m1.1.2.2" xref="S3.E7X.2.1.1.m1.1.2.2.cmml">𝐗</mi><mo id="S3.E7X.2.1.1.m1.1.2.1" xref="S3.E7X.2.1.1.m1.1.2.1.cmml">∈</mo><msup id="S3.E7X.2.1.1.m1.1.2.3" xref="S3.E7X.2.1.1.m1.1.2.3.cmml"><mi id="S3.E7X.2.1.1.m1.1.2.3.2" xref="S3.E7X.2.1.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.E7X.2.1.1.m1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.cmml"><mrow id="S3.E7X.2.1.1.m1.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7X.2.1.1.m1.1.1.1.1.1.2" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E7X.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E7X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1.1.cmml">×</mo><mi id="S3.E7X.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1.3.cmml">W</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E7X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E7X.2.1.1.m1.1.1.1.2" xref="S3.E7X.2.1.1.m1.1.1.1.2.cmml">×</mo><mi id="S3.E7X.2.1.1.m1.1.1.1.3" xref="S3.E7X.2.1.1.m1.1.1.1.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.2.1.1.m1.1b"><apply id="S3.E7X.2.1.1.m1.1.2.cmml" xref="S3.E7X.2.1.1.m1.1.2"><in id="S3.E7X.2.1.1.m1.1.2.1.cmml" xref="S3.E7X.2.1.1.m1.1.2.1"></in><ci id="S3.E7X.2.1.1.m1.1.2.2.cmml" xref="S3.E7X.2.1.1.m1.1.2.2">𝐗</ci><apply id="S3.E7X.2.1.1.m1.1.2.3.cmml" xref="S3.E7X.2.1.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.1.2.3.1.cmml" xref="S3.E7X.2.1.1.m1.1.2.3">superscript</csymbol><ci id="S3.E7X.2.1.1.m1.1.2.3.2.cmml" xref="S3.E7X.2.1.1.m1.1.2.3.2">ℝ</ci><apply id="S3.E7X.2.1.1.m1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1"><times id="S3.E7X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.2"></times><apply id="S3.E7X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.1"><times id="S3.E7X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1.1"></times><ci id="S3.E7X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1.2">𝐻</ci><ci id="S3.E7X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.1.1.1.3">𝑊</ci></apply><ci id="S3.E7X.2.1.1.m1.1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.1.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.2.1.1.m1.1c">\displaystyle\mathbf{X}\in\mathbb{R}^{(H\times W)\times C}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\to\mathbf{X}\in\mathbb{R}^{H\times W\times C}," display="inline"><semantics id="S3.E7X.3.2.2.m1.1a"><mrow id="S3.E7X.3.2.2.m1.1.1.1" xref="S3.E7X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E7X.3.2.2.m1.1.1.1.1" xref="S3.E7X.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E7X.3.2.2.m1.1.1.1.1.2" xref="S3.E7X.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo stretchy="false" id="S3.E7X.3.2.2.m1.1.1.1.1.3" xref="S3.E7X.3.2.2.m1.1.1.1.1.3.cmml">→</mo><mi id="S3.E7X.3.2.2.m1.1.1.1.1.4" xref="S3.E7X.3.2.2.m1.1.1.1.1.4.cmml">𝐗</mi><mo id="S3.E7X.3.2.2.m1.1.1.1.1.5" xref="S3.E7X.3.2.2.m1.1.1.1.1.5.cmml">∈</mo><msup id="S3.E7X.3.2.2.m1.1.1.1.1.6" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.cmml"><mi id="S3.E7X.3.2.2.m1.1.1.1.1.6.2" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.2.cmml">ℝ</mi><mrow id="S3.E7X.3.2.2.m1.1.1.1.1.6.3" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.3.cmml"><mi id="S3.E7X.3.2.2.m1.1.1.1.1.6.3.2" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E7X.3.2.2.m1.1.1.1.1.6.3.1" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.3.1.cmml">×</mo><mi id="S3.E7X.3.2.2.m1.1.1.1.1.6.3.3" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E7X.3.2.2.m1.1.1.1.1.6.3.1a" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.3.1.cmml">×</mo><mi id="S3.E7X.3.2.2.m1.1.1.1.1.6.3.4" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.3.4.cmml">C</mi></mrow></msup></mrow><mo id="S3.E7X.3.2.2.m1.1.1.1.2" xref="S3.E7X.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.3.2.2.m1.1b"><apply id="S3.E7X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.1.1.1"><and id="S3.E7X.3.2.2.m1.1.1.1.1a.cmml" xref="S3.E7X.3.2.2.m1.1.1.1"></and><apply id="S3.E7X.3.2.2.m1.1.1.1.1b.cmml" xref="S3.E7X.3.2.2.m1.1.1.1"><ci id="S3.E7X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.3">→</ci><csymbol cd="latexml" id="S3.E7X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.2">absent</csymbol><ci id="S3.E7X.3.2.2.m1.1.1.1.1.4.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.4">𝐗</ci></apply><apply id="S3.E7X.3.2.2.m1.1.1.1.1c.cmml" xref="S3.E7X.3.2.2.m1.1.1.1"><in id="S3.E7X.3.2.2.m1.1.1.1.1.5.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.5"></in><share href="#S3.E7X.3.2.2.m1.1.1.1.1.4.cmml" id="S3.E7X.3.2.2.m1.1.1.1.1d.cmml" xref="S3.E7X.3.2.2.m1.1.1.1"></share><apply id="S3.E7X.3.2.2.m1.1.1.1.1.6.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.1.1.1.1.6.1.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.6">superscript</csymbol><ci id="S3.E7X.3.2.2.m1.1.1.1.1.6.2.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.2">ℝ</ci><apply id="S3.E7X.3.2.2.m1.1.1.1.1.6.3.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.3"><times id="S3.E7X.3.2.2.m1.1.1.1.1.6.3.1.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.3.1"></times><ci id="S3.E7X.3.2.2.m1.1.1.1.1.6.3.2.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.3.2">𝐻</ci><ci id="S3.E7X.3.2.2.m1.1.1.1.1.6.3.3.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.3.3">𝑊</ci><ci id="S3.E7X.3.2.2.m1.1.1.1.1.6.3.4.cmml" xref="S3.E7X.3.2.2.m1.1.1.1.1.6.3.4">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.3.2.2.m1.1c">\displaystyle\to\mathbf{X}\in\mathbb{R}^{H\times W\times C},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr id="S3.E7Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{A^{\prime}}" display="inline"><semantics id="S3.E7Xa.2.1.1.m1.1a"><msup id="S3.E7Xa.2.1.1.m1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.2.cmml">𝐀</mi><mo id="S3.E7Xa.2.1.1.m1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.E7Xa.2.1.1.m1.1b"><apply id="S3.E7Xa.2.1.1.m1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.2">𝐀</ci><ci id="S3.E7Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.2.1.1.m1.1c">\displaystyle\mathbf{A^{\prime}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\mathbf{A}\mathbf{W}^{p}+\mathbf{X}," display="inline"><semantics id="S3.E7Xa.3.2.2.m1.1a"><mrow id="S3.E7Xa.3.2.2.m1.1.1.1" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E7Xa.3.2.2.m1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E7Xa.3.2.2.m1.1.1.1.1.2" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="S3.E7Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7Xa.3.2.2.m1.1.1.1.1.3" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.cmml"><msup id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2.2" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml">𝐀𝐖</mi><mi id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2.3" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml">p</mi></msup><mo id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.1" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.1.cmml">+</mo><mi id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.3" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.3.cmml">𝐗</mi></mrow></mrow><mo id="S3.E7Xa.3.2.2.m1.1.1.1.2" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xa.3.2.2.m1.1b"><apply id="S3.E7Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.1.1.1"><eq id="S3.E7Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E7Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.2">absent</csymbol><apply id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3"><plus id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.1"></plus><apply id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2.2">𝐀𝐖</ci><ci id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.2.3">𝑝</ci></apply><ci id="S3.E7Xa.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E7Xa.3.2.2.m1.1.1.1.1.3.3">𝐗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.3.2.2.m1.1c">\displaystyle=\mathbf{A}\mathbf{W}^{p}+\mathbf{X},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS1.p1.15" class="ltx_p">in which <math id="S3.SS1.p1.15.m1.1" class="ltx_Math" alttext="\mathbf{W}^{p}\in\mathbb{R}^{C\times C}" display="inline"><semantics id="S3.SS1.p1.15.m1.1a"><mrow id="S3.SS1.p1.15.m1.1.1" xref="S3.SS1.p1.15.m1.1.1.cmml"><msup id="S3.SS1.p1.15.m1.1.1.2" xref="S3.SS1.p1.15.m1.1.1.2.cmml"><mi id="S3.SS1.p1.15.m1.1.1.2.2" xref="S3.SS1.p1.15.m1.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS1.p1.15.m1.1.1.2.3" xref="S3.SS1.p1.15.m1.1.1.2.3.cmml">p</mi></msup><mo id="S3.SS1.p1.15.m1.1.1.1" xref="S3.SS1.p1.15.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.15.m1.1.1.3" xref="S3.SS1.p1.15.m1.1.1.3.cmml"><mi id="S3.SS1.p1.15.m1.1.1.3.2" xref="S3.SS1.p1.15.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.15.m1.1.1.3.3" xref="S3.SS1.p1.15.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.15.m1.1.1.3.3.2" xref="S3.SS1.p1.15.m1.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.15.m1.1.1.3.3.1" xref="S3.SS1.p1.15.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.15.m1.1.1.3.3.3" xref="S3.SS1.p1.15.m1.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m1.1b"><apply id="S3.SS1.p1.15.m1.1.1.cmml" xref="S3.SS1.p1.15.m1.1.1"><in id="S3.SS1.p1.15.m1.1.1.1.cmml" xref="S3.SS1.p1.15.m1.1.1.1"></in><apply id="S3.SS1.p1.15.m1.1.1.2.cmml" xref="S3.SS1.p1.15.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m1.1.1.2.1.cmml" xref="S3.SS1.p1.15.m1.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.15.m1.1.1.2.2.cmml" xref="S3.SS1.p1.15.m1.1.1.2.2">𝐖</ci><ci id="S3.SS1.p1.15.m1.1.1.2.3.cmml" xref="S3.SS1.p1.15.m1.1.1.2.3">𝑝</ci></apply><apply id="S3.SS1.p1.15.m1.1.1.3.cmml" xref="S3.SS1.p1.15.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m1.1.1.3.1.cmml" xref="S3.SS1.p1.15.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.15.m1.1.1.3.2.cmml" xref="S3.SS1.p1.15.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.15.m1.1.1.3.3.cmml" xref="S3.SS1.p1.15.m1.1.1.3.3"><times id="S3.SS1.p1.15.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.15.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.15.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.15.m1.1.1.3.3.2">𝐶</ci><ci id="S3.SS1.p1.15.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.15.m1.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m1.1c">\mathbf{W}^{p}\in\mathbb{R}^{C\times C}</annotation></semantics></math> is a trainable weight matrix for feature projection.
Lastly, a multilayer perceptron (MLP) is employed to enhance the representation:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\mathbf{Y}={\rm MLP}(\mathbf{A^{\prime}})+\mathbf{A^{\prime}}," display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml">𝐘</mi><mo id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.3.cmml">MLP</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E8.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐀</mi><mo id="S3.E8.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.2.cmml">+</mo><msup id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.3.2.cmml">𝐀</mi><mo id="S3.E8.m1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"></eq><ci id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3">𝐘</ci><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><plus id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.2"></plus><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2"></times><ci id="S3.E8.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3">MLP</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.2">𝐀</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.3.2">𝐀</ci><ci id="S3.E8.m1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\mathbf{Y}={\rm MLP}(\mathbf{A^{\prime}})+\mathbf{A^{\prime}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.16" class="ltx_p">where <math id="S3.SS1.p1.16.m1.1" class="ltx_Math" alttext="\mathbf{Y}" display="inline"><semantics id="S3.SS1.p1.16.m1.1a"><mi id="S3.SS1.p1.16.m1.1.1" xref="S3.SS1.p1.16.m1.1.1.cmml">𝐘</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m1.1b"><ci id="S3.SS1.p1.16.m1.1.1.cmml" xref="S3.SS1.p1.16.m1.1.1">𝐘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m1.1c">\mathbf{Y}</annotation></semantics></math> denotes the output of a transformer block.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.3" class="ltx_p">It is evident that the computational complexity of MHSA (<a href="#S3.E6" title="In 3.1 Image representation in Vision Transformers ‣ 3 Global-Local Encoder Alignment ‣ Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) is</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.2" class="ltx_Math" alttext="\Omega({\rm MHSA})=3HWC^{2}+2H^{2}W^{2}C." display="block"><semantics id="S3.E9.m1.2a"><mrow id="S3.E9.m1.2.2.1" xref="S3.E9.m1.2.2.1.1.cmml"><mrow id="S3.E9.m1.2.2.1.1" xref="S3.E9.m1.2.2.1.1.cmml"><mrow id="S3.E9.m1.2.2.1.1.2" xref="S3.E9.m1.2.2.1.1.2.cmml"><mi mathvariant="normal" id="S3.E9.m1.2.2.1.1.2.2" xref="S3.E9.m1.2.2.1.1.2.2.cmml">Ω</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.1.1.2.1" xref="S3.E9.m1.2.2.1.1.2.1.cmml">​</mo><mrow id="S3.E9.m1.2.2.1.1.2.3.2" xref="S3.E9.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.1.1.2.3.2.1" xref="S3.E9.m1.2.2.1.1.2.cmml">(</mo><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">MHSA</mi><mo stretchy="false" id="S3.E9.m1.2.2.1.1.2.3.2.2" xref="S3.E9.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.2.2.1.1.1" xref="S3.E9.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.2.2.1.1.3" xref="S3.E9.m1.2.2.1.1.3.cmml"><mrow id="S3.E9.m1.2.2.1.1.3.2" xref="S3.E9.m1.2.2.1.1.3.2.cmml"><mn id="S3.E9.m1.2.2.1.1.3.2.2" xref="S3.E9.m1.2.2.1.1.3.2.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.1.1.3.2.1" xref="S3.E9.m1.2.2.1.1.3.2.1.cmml">​</mo><mi id="S3.E9.m1.2.2.1.1.3.2.3" xref="S3.E9.m1.2.2.1.1.3.2.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.1.1.3.2.1a" xref="S3.E9.m1.2.2.1.1.3.2.1.cmml">​</mo><mi id="S3.E9.m1.2.2.1.1.3.2.4" xref="S3.E9.m1.2.2.1.1.3.2.4.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.1.1.3.2.1b" xref="S3.E9.m1.2.2.1.1.3.2.1.cmml">​</mo><msup id="S3.E9.m1.2.2.1.1.3.2.5" xref="S3.E9.m1.2.2.1.1.3.2.5.cmml"><mi id="S3.E9.m1.2.2.1.1.3.2.5.2" xref="S3.E9.m1.2.2.1.1.3.2.5.2.cmml">C</mi><mn id="S3.E9.m1.2.2.1.1.3.2.5.3" xref="S3.E9.m1.2.2.1.1.3.2.5.3.cmml">2</mn></msup></mrow><mo id="S3.E9.m1.2.2.1.1.3.1" xref="S3.E9.m1.2.2.1.1.3.1.cmml">+</mo><mrow id="S3.E9.m1.2.2.1.1.3.3" xref="S3.E9.m1.2.2.1.1.3.3.cmml"><mn id="S3.E9.m1.2.2.1.1.3.3.2" xref="S3.E9.m1.2.2.1.1.3.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.1.1.3.3.1" xref="S3.E9.m1.2.2.1.1.3.3.1.cmml">​</mo><msup id="S3.E9.m1.2.2.1.1.3.3.3" xref="S3.E9.m1.2.2.1.1.3.3.3.cmml"><mi id="S3.E9.m1.2.2.1.1.3.3.3.2" xref="S3.E9.m1.2.2.1.1.3.3.3.2.cmml">H</mi><mn id="S3.E9.m1.2.2.1.1.3.3.3.3" xref="S3.E9.m1.2.2.1.1.3.3.3.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.1.1.3.3.1a" xref="S3.E9.m1.2.2.1.1.3.3.1.cmml">​</mo><msup id="S3.E9.m1.2.2.1.1.3.3.4" xref="S3.E9.m1.2.2.1.1.3.3.4.cmml"><mi id="S3.E9.m1.2.2.1.1.3.3.4.2" xref="S3.E9.m1.2.2.1.1.3.3.4.2.cmml">W</mi><mn id="S3.E9.m1.2.2.1.1.3.3.4.3" xref="S3.E9.m1.2.2.1.1.3.3.4.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.1.1.3.3.1b" xref="S3.E9.m1.2.2.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.2.2.1.1.3.3.5" xref="S3.E9.m1.2.2.1.1.3.3.5.cmml">C</mi></mrow></mrow></mrow><mo lspace="0em" id="S3.E9.m1.2.2.1.2" xref="S3.E9.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.2b"><apply id="S3.E9.m1.2.2.1.1.cmml" xref="S3.E9.m1.2.2.1"><eq id="S3.E9.m1.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1"></eq><apply id="S3.E9.m1.2.2.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.2"><times id="S3.E9.m1.2.2.1.1.2.1.cmml" xref="S3.E9.m1.2.2.1.1.2.1"></times><ci id="S3.E9.m1.2.2.1.1.2.2.cmml" xref="S3.E9.m1.2.2.1.1.2.2">Ω</ci><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">MHSA</ci></apply><apply id="S3.E9.m1.2.2.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.3"><plus id="S3.E9.m1.2.2.1.1.3.1.cmml" xref="S3.E9.m1.2.2.1.1.3.1"></plus><apply id="S3.E9.m1.2.2.1.1.3.2.cmml" xref="S3.E9.m1.2.2.1.1.3.2"><times id="S3.E9.m1.2.2.1.1.3.2.1.cmml" xref="S3.E9.m1.2.2.1.1.3.2.1"></times><cn type="integer" id="S3.E9.m1.2.2.1.1.3.2.2.cmml" xref="S3.E9.m1.2.2.1.1.3.2.2">3</cn><ci id="S3.E9.m1.2.2.1.1.3.2.3.cmml" xref="S3.E9.m1.2.2.1.1.3.2.3">𝐻</ci><ci id="S3.E9.m1.2.2.1.1.3.2.4.cmml" xref="S3.E9.m1.2.2.1.1.3.2.4">𝑊</ci><apply id="S3.E9.m1.2.2.1.1.3.2.5.cmml" xref="S3.E9.m1.2.2.1.1.3.2.5"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.3.2.5.1.cmml" xref="S3.E9.m1.2.2.1.1.3.2.5">superscript</csymbol><ci id="S3.E9.m1.2.2.1.1.3.2.5.2.cmml" xref="S3.E9.m1.2.2.1.1.3.2.5.2">𝐶</ci><cn type="integer" id="S3.E9.m1.2.2.1.1.3.2.5.3.cmml" xref="S3.E9.m1.2.2.1.1.3.2.5.3">2</cn></apply></apply><apply id="S3.E9.m1.2.2.1.1.3.3.cmml" xref="S3.E9.m1.2.2.1.1.3.3"><times id="S3.E9.m1.2.2.1.1.3.3.1.cmml" xref="S3.E9.m1.2.2.1.1.3.3.1"></times><cn type="integer" id="S3.E9.m1.2.2.1.1.3.3.2.cmml" xref="S3.E9.m1.2.2.1.1.3.3.2">2</cn><apply id="S3.E9.m1.2.2.1.1.3.3.3.cmml" xref="S3.E9.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.3.3.3.1.cmml" xref="S3.E9.m1.2.2.1.1.3.3.3">superscript</csymbol><ci id="S3.E9.m1.2.2.1.1.3.3.3.2.cmml" xref="S3.E9.m1.2.2.1.1.3.3.3.2">𝐻</ci><cn type="integer" id="S3.E9.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.E9.m1.2.2.1.1.3.3.3.3">2</cn></apply><apply id="S3.E9.m1.2.2.1.1.3.3.4.cmml" xref="S3.E9.m1.2.2.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.3.3.4.1.cmml" xref="S3.E9.m1.2.2.1.1.3.3.4">superscript</csymbol><ci id="S3.E9.m1.2.2.1.1.3.3.4.2.cmml" xref="S3.E9.m1.2.2.1.1.3.3.4.2">𝑊</ci><cn type="integer" id="S3.E9.m1.2.2.1.1.3.3.4.3.cmml" xref="S3.E9.m1.2.2.1.1.3.3.4.3">2</cn></apply><ci id="S3.E9.m1.2.2.1.1.3.3.5.cmml" xref="S3.E9.m1.2.2.1.1.3.3.5">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.2c">\Omega({\rm MHSA})=3HWC^{2}+2H^{2}W^{2}C.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.2" class="ltx_p">Similarly, the space complexity (memory consumption) also includes the term of <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="O(H^{2}W^{2})" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><msup id="S3.SS1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.2.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.2.cmml">H</mi><mn id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.cmml">​</mo><msup id="S3.SS1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.2.cmml">W</mi><mn id="S3.SS1.p2.1.m1.1.1.1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><times id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2"></times><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑂</ci><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1"><times id="S3.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1"></times><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.2">𝐻</ci><cn type="integer" id="S3.SS1.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.3">2</cn></apply><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="S3.SS1.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">O(H^{2}W^{2})</annotation></semantics></math>.
As commonly known, <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="O(H^{2}W^{2})" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">O</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><msup id="S3.SS1.p2.2.m2.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.2.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.2.cmml">H</mi><mn id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p2.2.m2.1.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml">​</mo><msup id="S3.SS1.p2.2.m2.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.2.cmml">W</mi><mn id="S3.SS1.p2.2.m2.1.1.1.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><times id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2"></times><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑂</ci><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><times id="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1"></times><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.2">𝐻</ci><cn type="integer" id="S3.SS1.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.3">2</cn></apply><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.2">𝑊</ci><cn type="integer" id="S3.SS1.p2.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">O(H^{2}W^{2})</annotation></semantics></math> could become very large for high-resolution inputs.This limits the applicability of transformers for vision tasks.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p"><span id="S3.SS1.p3.1.1" class="ltx_text ltx_font_bold">Alignment via regularization</span>
The high computational complexity of MHSA as shown in equation (<a href="#S3.E9" title="In 3.1 Image representation in Vision Transformers ‣ 3 Global-Local Encoder Alignment ‣ Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) becomes a severe challenge in large-scale vision tasks. Moreover, in a federated learning scenario, we confront another pivotal issue: the statistical heterogeneity among different local models. Specifically, each local model may learn distinct features due to varying data distribution across clients. If not handled appropriately, this heterogeneity can hinder the global model’s performance. A surrogate function could be devised that approximates the local behavior of the objective function, yet is simpler to minimize.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.2" class="ltx_p">Let <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="f(x)" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.2" xref="S3.SS1.p4.1.m1.1.2.cmml"><mi id="S3.SS1.p4.1.m1.1.2.2" xref="S3.SS1.p4.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.2.1" xref="S3.SS1.p4.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS1.p4.1.m1.1.2.3.2" xref="S3.SS1.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p4.1.m1.1.2.3.2.1" xref="S3.SS1.p4.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.p4.1.m1.1.2.3.2.2" xref="S3.SS1.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.2"><times id="S3.SS1.p4.1.m1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.2.1"></times><ci id="S3.SS1.p4.1.m1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.2.2">𝑓</ci><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">f(x)</annotation></semantics></math> represent a function. At a given point <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="x=y" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">x</mi><mo id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">=</mo><mi id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml">y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><eq id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1"></eq><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">𝑥</ci><ci id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">x=y</annotation></semantics></math>, we can express its quadratic approximation as:</p>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.3" class="ltx_Math" alttext="f(y)+\nabla f(y)^{T}(x-y)+\frac{1}{2\mu}|x-y|^{2}," display="block"><semantics id="S3.E10.m1.3a"><mrow id="S3.E10.m1.3.3.1" xref="S3.E10.m1.3.3.1.1.cmml"><mrow id="S3.E10.m1.3.3.1.1" xref="S3.E10.m1.3.3.1.1.cmml"><mrow id="S3.E10.m1.3.3.1.1.4" xref="S3.E10.m1.3.3.1.1.4.cmml"><mi id="S3.E10.m1.3.3.1.1.4.2" xref="S3.E10.m1.3.3.1.1.4.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.4.1" xref="S3.E10.m1.3.3.1.1.4.1.cmml">​</mo><mrow id="S3.E10.m1.3.3.1.1.4.3.2" xref="S3.E10.m1.3.3.1.1.4.cmml"><mo stretchy="false" id="S3.E10.m1.3.3.1.1.4.3.2.1" xref="S3.E10.m1.3.3.1.1.4.cmml">(</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">y</mi><mo stretchy="false" id="S3.E10.m1.3.3.1.1.4.3.2.2" xref="S3.E10.m1.3.3.1.1.4.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.3.3.1.1.3" xref="S3.E10.m1.3.3.1.1.3.cmml">+</mo><mrow id="S3.E10.m1.3.3.1.1.1" xref="S3.E10.m1.3.3.1.1.1.cmml"><mrow id="S3.E10.m1.3.3.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.3.cmml"><mo rspace="0.167em" id="S3.E10.m1.3.3.1.1.1.3.1" xref="S3.E10.m1.3.3.1.1.1.3.1.cmml">∇</mo><mi id="S3.E10.m1.3.3.1.1.1.3.2" xref="S3.E10.m1.3.3.1.1.1.3.2.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.2.cmml">​</mo><msup id="S3.E10.m1.3.3.1.1.1.4" xref="S3.E10.m1.3.3.1.1.1.4.cmml"><mrow id="S3.E10.m1.3.3.1.1.1.4.2.2" xref="S3.E10.m1.3.3.1.1.1.4.cmml"><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.4.2.2.1" xref="S3.E10.m1.3.3.1.1.1.4.cmml">(</mo><mi id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.4.2.2.2" xref="S3.E10.m1.3.3.1.1.1.4.cmml">)</mo></mrow><mi id="S3.E10.m1.3.3.1.1.1.4.3" xref="S3.E10.m1.3.3.1.1.1.4.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.1.2a" xref="S3.E10.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.2.cmml">x</mi><mo id="S3.E10.m1.3.3.1.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.3.3.1.1.3a" xref="S3.E10.m1.3.3.1.1.3.cmml">+</mo><mrow id="S3.E10.m1.3.3.1.1.2" xref="S3.E10.m1.3.3.1.1.2.cmml"><mfrac id="S3.E10.m1.3.3.1.1.2.3" xref="S3.E10.m1.3.3.1.1.2.3.cmml"><mn id="S3.E10.m1.3.3.1.1.2.3.2" xref="S3.E10.m1.3.3.1.1.2.3.2.cmml">1</mn><mrow id="S3.E10.m1.3.3.1.1.2.3.3" xref="S3.E10.m1.3.3.1.1.2.3.3.cmml"><mn id="S3.E10.m1.3.3.1.1.2.3.3.2" xref="S3.E10.m1.3.3.1.1.2.3.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.2.3.3.1" xref="S3.E10.m1.3.3.1.1.2.3.3.1.cmml">​</mo><mi id="S3.E10.m1.3.3.1.1.2.3.3.3" xref="S3.E10.m1.3.3.1.1.2.3.3.3.cmml">μ</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.2.2" xref="S3.E10.m1.3.3.1.1.2.2.cmml">​</mo><msup id="S3.E10.m1.3.3.1.1.2.1" xref="S3.E10.m1.3.3.1.1.2.1.cmml"><mrow id="S3.E10.m1.3.3.1.1.2.1.1.1" xref="S3.E10.m1.3.3.1.1.2.1.1.2.cmml"><mo stretchy="false" id="S3.E10.m1.3.3.1.1.2.1.1.1.2" xref="S3.E10.m1.3.3.1.1.2.1.1.2.1.cmml">|</mo><mrow id="S3.E10.m1.3.3.1.1.2.1.1.1.1" xref="S3.E10.m1.3.3.1.1.2.1.1.1.1.cmml"><mi id="S3.E10.m1.3.3.1.1.2.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.2.1.1.1.1.2.cmml">x</mi><mo id="S3.E10.m1.3.3.1.1.2.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.2.1.1.1.1.1.cmml">−</mo><mi id="S3.E10.m1.3.3.1.1.2.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.2.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S3.E10.m1.3.3.1.1.2.1.1.1.3" xref="S3.E10.m1.3.3.1.1.2.1.1.2.1.cmml">|</mo></mrow><mn id="S3.E10.m1.3.3.1.1.2.1.3" xref="S3.E10.m1.3.3.1.1.2.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S3.E10.m1.3.3.1.2" xref="S3.E10.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.3b"><apply id="S3.E10.m1.3.3.1.1.cmml" xref="S3.E10.m1.3.3.1"><plus id="S3.E10.m1.3.3.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.3"></plus><apply id="S3.E10.m1.3.3.1.1.4.cmml" xref="S3.E10.m1.3.3.1.1.4"><times id="S3.E10.m1.3.3.1.1.4.1.cmml" xref="S3.E10.m1.3.3.1.1.4.1"></times><ci id="S3.E10.m1.3.3.1.1.4.2.cmml" xref="S3.E10.m1.3.3.1.1.4.2">𝑓</ci><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝑦</ci></apply><apply id="S3.E10.m1.3.3.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1"><times id="S3.E10.m1.3.3.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.2"></times><apply id="S3.E10.m1.3.3.1.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.1.3"><ci id="S3.E10.m1.3.3.1.1.1.3.1.cmml" xref="S3.E10.m1.3.3.1.1.1.3.1">∇</ci><ci id="S3.E10.m1.3.3.1.1.1.3.2.cmml" xref="S3.E10.m1.3.3.1.1.1.3.2">𝑓</ci></apply><apply id="S3.E10.m1.3.3.1.1.1.4.cmml" xref="S3.E10.m1.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.4.1.cmml" xref="S3.E10.m1.3.3.1.1.1.4">superscript</csymbol><ci id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2">𝑦</ci><ci id="S3.E10.m1.3.3.1.1.1.4.3.cmml" xref="S3.E10.m1.3.3.1.1.1.4.3">𝑇</ci></apply><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1"><minus id="S3.E10.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1"></minus><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3">𝑦</ci></apply></apply><apply id="S3.E10.m1.3.3.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.2"><times id="S3.E10.m1.3.3.1.1.2.2.cmml" xref="S3.E10.m1.3.3.1.1.2.2"></times><apply id="S3.E10.m1.3.3.1.1.2.3.cmml" xref="S3.E10.m1.3.3.1.1.2.3"><divide id="S3.E10.m1.3.3.1.1.2.3.1.cmml" xref="S3.E10.m1.3.3.1.1.2.3"></divide><cn type="integer" id="S3.E10.m1.3.3.1.1.2.3.2.cmml" xref="S3.E10.m1.3.3.1.1.2.3.2">1</cn><apply id="S3.E10.m1.3.3.1.1.2.3.3.cmml" xref="S3.E10.m1.3.3.1.1.2.3.3"><times id="S3.E10.m1.3.3.1.1.2.3.3.1.cmml" xref="S3.E10.m1.3.3.1.1.2.3.3.1"></times><cn type="integer" id="S3.E10.m1.3.3.1.1.2.3.3.2.cmml" xref="S3.E10.m1.3.3.1.1.2.3.3.2">2</cn><ci id="S3.E10.m1.3.3.1.1.2.3.3.3.cmml" xref="S3.E10.m1.3.3.1.1.2.3.3.3">𝜇</ci></apply></apply><apply id="S3.E10.m1.3.3.1.1.2.1.cmml" xref="S3.E10.m1.3.3.1.1.2.1"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.2.1.2.cmml" xref="S3.E10.m1.3.3.1.1.2.1">superscript</csymbol><apply id="S3.E10.m1.3.3.1.1.2.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.2.1.1.1"><abs id="S3.E10.m1.3.3.1.1.2.1.1.2.1.cmml" xref="S3.E10.m1.3.3.1.1.2.1.1.1.2"></abs><apply id="S3.E10.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.2.1.1.1.1"><minus id="S3.E10.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.2.1.1.1.1.1"></minus><ci id="S3.E10.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.2.1.1.1.1.2">𝑥</ci><ci id="S3.E10.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.2.1.1.1.1.3">𝑦</ci></apply></apply><cn type="integer" id="S3.E10.m1.3.3.1.1.2.1.3.cmml" xref="S3.E10.m1.3.3.1.1.2.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.3c">f(y)+\nabla f(y)^{T}(x-y)+\frac{1}{2\mu}|x-y|^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p6" class="ltx_para">
<p id="S3.SS1.p6.6" class="ltx_p">where <math id="S3.SS1.p6.1.m1.1" class="ltx_Math" alttext="\nabla f(y)" display="inline"><semantics id="S3.SS1.p6.1.m1.1a"><mrow id="S3.SS1.p6.1.m1.1.2" xref="S3.SS1.p6.1.m1.1.2.cmml"><mrow id="S3.SS1.p6.1.m1.1.2.2" xref="S3.SS1.p6.1.m1.1.2.2.cmml"><mo rspace="0.167em" id="S3.SS1.p6.1.m1.1.2.2.1" xref="S3.SS1.p6.1.m1.1.2.2.1.cmml">∇</mo><mi id="S3.SS1.p6.1.m1.1.2.2.2" xref="S3.SS1.p6.1.m1.1.2.2.2.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p6.1.m1.1.2.1" xref="S3.SS1.p6.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS1.p6.1.m1.1.2.3.2" xref="S3.SS1.p6.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p6.1.m1.1.2.3.2.1" xref="S3.SS1.p6.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml">y</mi><mo stretchy="false" id="S3.SS1.p6.1.m1.1.2.3.2.2" xref="S3.SS1.p6.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><apply id="S3.SS1.p6.1.m1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.2"><times id="S3.SS1.p6.1.m1.1.2.1.cmml" xref="S3.SS1.p6.1.m1.1.2.1"></times><apply id="S3.SS1.p6.1.m1.1.2.2.cmml" xref="S3.SS1.p6.1.m1.1.2.2"><ci id="S3.SS1.p6.1.m1.1.2.2.1.cmml" xref="S3.SS1.p6.1.m1.1.2.2.1">∇</ci><ci id="S3.SS1.p6.1.m1.1.2.2.2.cmml" xref="S3.SS1.p6.1.m1.1.2.2.2">𝑓</ci></apply><ci id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\nabla f(y)</annotation></semantics></math> is the gradient of the function <math id="S3.SS1.p6.2.m2.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS1.p6.2.m2.1a"><mi id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><ci id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">f</annotation></semantics></math> at <math id="S3.SS1.p6.3.m3.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS1.p6.3.m3.1a"><mi id="S3.SS1.p6.3.m3.1.1" xref="S3.SS1.p6.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m3.1b"><ci id="S3.SS1.p6.3.m3.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m3.1c">y</annotation></semantics></math> and <math id="S3.SS1.p6.4.m4.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS1.p6.4.m4.1a"><mi id="S3.SS1.p6.4.m4.1.1" xref="S3.SS1.p6.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.4.m4.1b"><ci id="S3.SS1.p6.4.m4.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.4.m4.1c">\mu</annotation></semantics></math> is a positive scalar, representing the step size. In the context of our federated learning setting, this translates into a quadratic upper-bound for the local loss function <math id="S3.SS1.p6.5.m5.1" class="ltx_Math" alttext="F_{k}(w)" display="inline"><semantics id="S3.SS1.p6.5.m5.1a"><mrow id="S3.SS1.p6.5.m5.1.2" xref="S3.SS1.p6.5.m5.1.2.cmml"><msub id="S3.SS1.p6.5.m5.1.2.2" xref="S3.SS1.p6.5.m5.1.2.2.cmml"><mi id="S3.SS1.p6.5.m5.1.2.2.2" xref="S3.SS1.p6.5.m5.1.2.2.2.cmml">F</mi><mi id="S3.SS1.p6.5.m5.1.2.2.3" xref="S3.SS1.p6.5.m5.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p6.5.m5.1.2.1" xref="S3.SS1.p6.5.m5.1.2.1.cmml">​</mo><mrow id="S3.SS1.p6.5.m5.1.2.3.2" xref="S3.SS1.p6.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS1.p6.5.m5.1.2.3.2.1" xref="S3.SS1.p6.5.m5.1.2.cmml">(</mo><mi id="S3.SS1.p6.5.m5.1.1" xref="S3.SS1.p6.5.m5.1.1.cmml">w</mi><mo stretchy="false" id="S3.SS1.p6.5.m5.1.2.3.2.2" xref="S3.SS1.p6.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.5.m5.1b"><apply id="S3.SS1.p6.5.m5.1.2.cmml" xref="S3.SS1.p6.5.m5.1.2"><times id="S3.SS1.p6.5.m5.1.2.1.cmml" xref="S3.SS1.p6.5.m5.1.2.1"></times><apply id="S3.SS1.p6.5.m5.1.2.2.cmml" xref="S3.SS1.p6.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.5.m5.1.2.2.1.cmml" xref="S3.SS1.p6.5.m5.1.2.2">subscript</csymbol><ci id="S3.SS1.p6.5.m5.1.2.2.2.cmml" xref="S3.SS1.p6.5.m5.1.2.2.2">𝐹</ci><ci id="S3.SS1.p6.5.m5.1.2.2.3.cmml" xref="S3.SS1.p6.5.m5.1.2.2.3">𝑘</ci></apply><ci id="S3.SS1.p6.5.m5.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.5.m5.1c">F_{k}(w)</annotation></semantics></math> around the global weights <math id="S3.SS1.p6.6.m6.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="S3.SS1.p6.6.m6.1a"><msup id="S3.SS1.p6.6.m6.1.1" xref="S3.SS1.p6.6.m6.1.1.cmml"><mi id="S3.SS1.p6.6.m6.1.1.2" xref="S3.SS1.p6.6.m6.1.1.2.cmml">w</mi><mi id="S3.SS1.p6.6.m6.1.1.3" xref="S3.SS1.p6.6.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.6.m6.1b"><apply id="S3.SS1.p6.6.m6.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.6.m6.1.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p6.6.m6.1.1.2.cmml" xref="S3.SS1.p6.6.m6.1.1.2">𝑤</ci><ci id="S3.SS1.p6.6.m6.1.1.3.cmml" xref="S3.SS1.p6.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.6.m6.1c">w^{t}</annotation></semantics></math>:</p>
</div>
<div id="S3.SS1.p7" class="ltx_para">
<table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E11.m1.6" class="ltx_Math" alttext="\displaystyle F_{k}(w)\leq F_{k}(w^{t})+\nabla F_{k}(w^{t})^{T}(w-w^{t})+\frac{1}{2\mu}||\mathbf{W}^{q,k}-\mathbf{W}^{q,G}||^{2}_{2}," display="inline"><semantics id="S3.E11.m1.6a"><mrow id="S3.E11.m1.6.6.1" xref="S3.E11.m1.6.6.1.1.cmml"><mrow id="S3.E11.m1.6.6.1.1" xref="S3.E11.m1.6.6.1.1.cmml"><mrow id="S3.E11.m1.6.6.1.1.6" xref="S3.E11.m1.6.6.1.1.6.cmml"><msub id="S3.E11.m1.6.6.1.1.6.2" xref="S3.E11.m1.6.6.1.1.6.2.cmml"><mi id="S3.E11.m1.6.6.1.1.6.2.2" xref="S3.E11.m1.6.6.1.1.6.2.2.cmml">F</mi><mi id="S3.E11.m1.6.6.1.1.6.2.3" xref="S3.E11.m1.6.6.1.1.6.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E11.m1.6.6.1.1.6.1" xref="S3.E11.m1.6.6.1.1.6.1.cmml">​</mo><mrow id="S3.E11.m1.6.6.1.1.6.3.2" xref="S3.E11.m1.6.6.1.1.6.cmml"><mo stretchy="false" id="S3.E11.m1.6.6.1.1.6.3.2.1" xref="S3.E11.m1.6.6.1.1.6.cmml">(</mo><mi id="S3.E11.m1.5.5" xref="S3.E11.m1.5.5.cmml">w</mi><mo stretchy="false" id="S3.E11.m1.6.6.1.1.6.3.2.2" xref="S3.E11.m1.6.6.1.1.6.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.6.6.1.1.5" xref="S3.E11.m1.6.6.1.1.5.cmml">≤</mo><mrow id="S3.E11.m1.6.6.1.1.4" xref="S3.E11.m1.6.6.1.1.4.cmml"><mrow id="S3.E11.m1.6.6.1.1.1.1" xref="S3.E11.m1.6.6.1.1.1.1.cmml"><msub id="S3.E11.m1.6.6.1.1.1.1.3" xref="S3.E11.m1.6.6.1.1.1.1.3.cmml"><mi id="S3.E11.m1.6.6.1.1.1.1.3.2" xref="S3.E11.m1.6.6.1.1.1.1.3.2.cmml">F</mi><mi id="S3.E11.m1.6.6.1.1.1.1.3.3" xref="S3.E11.m1.6.6.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E11.m1.6.6.1.1.1.1.2" xref="S3.E11.m1.6.6.1.1.1.1.2.cmml">​</mo><mrow id="S3.E11.m1.6.6.1.1.1.1.1.1" xref="S3.E11.m1.6.6.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.6.6.1.1.1.1.1.1.2" xref="S3.E11.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E11.m1.6.6.1.1.1.1.1.1.1" xref="S3.E11.m1.6.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.6.6.1.1.1.1.1.1.1.2" xref="S3.E11.m1.6.6.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E11.m1.6.6.1.1.1.1.1.1.1.3" xref="S3.E11.m1.6.6.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.E11.m1.6.6.1.1.1.1.1.1.3" xref="S3.E11.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.6.6.1.1.4.5" xref="S3.E11.m1.6.6.1.1.4.5.cmml">+</mo><mrow id="S3.E11.m1.6.6.1.1.3.3" xref="S3.E11.m1.6.6.1.1.3.3.cmml"><mrow id="S3.E11.m1.6.6.1.1.3.3.4" xref="S3.E11.m1.6.6.1.1.3.3.4.cmml"><mo rspace="0.167em" id="S3.E11.m1.6.6.1.1.3.3.4.1" xref="S3.E11.m1.6.6.1.1.3.3.4.1.cmml">∇</mo><msub id="S3.E11.m1.6.6.1.1.3.3.4.2" xref="S3.E11.m1.6.6.1.1.3.3.4.2.cmml"><mi id="S3.E11.m1.6.6.1.1.3.3.4.2.2" xref="S3.E11.m1.6.6.1.1.3.3.4.2.2.cmml">F</mi><mi id="S3.E11.m1.6.6.1.1.3.3.4.2.3" xref="S3.E11.m1.6.6.1.1.3.3.4.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E11.m1.6.6.1.1.3.3.3" xref="S3.E11.m1.6.6.1.1.3.3.3.cmml">​</mo><msup id="S3.E11.m1.6.6.1.1.2.2.1" xref="S3.E11.m1.6.6.1.1.2.2.1.cmml"><mrow id="S3.E11.m1.6.6.1.1.2.2.1.1.1" xref="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.6.6.1.1.2.2.1.1.1.2" xref="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.cmml">(</mo><msup id="S3.E11.m1.6.6.1.1.2.2.1.1.1.1" xref="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.2" xref="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.2.cmml">w</mi><mi id="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.3" xref="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.E11.m1.6.6.1.1.2.2.1.1.1.3" xref="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E11.m1.6.6.1.1.2.2.1.3" xref="S3.E11.m1.6.6.1.1.2.2.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E11.m1.6.6.1.1.3.3.3a" xref="S3.E11.m1.6.6.1.1.3.3.3.cmml">​</mo><mrow id="S3.E11.m1.6.6.1.1.3.3.2.1" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.6.6.1.1.3.3.2.1.2" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.cmml">(</mo><mrow id="S3.E11.m1.6.6.1.1.3.3.2.1.1" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.cmml"><mi id="S3.E11.m1.6.6.1.1.3.3.2.1.1.2" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.2.cmml">w</mi><mo id="S3.E11.m1.6.6.1.1.3.3.2.1.1.1" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.1.cmml">−</mo><msup id="S3.E11.m1.6.6.1.1.3.3.2.1.1.3" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.3.cmml"><mi id="S3.E11.m1.6.6.1.1.3.3.2.1.1.3.2" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.3.2.cmml">w</mi><mi id="S3.E11.m1.6.6.1.1.3.3.2.1.1.3.3" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="S3.E11.m1.6.6.1.1.3.3.2.1.3" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.6.6.1.1.4.5a" xref="S3.E11.m1.6.6.1.1.4.5.cmml">+</mo><mrow id="S3.E11.m1.6.6.1.1.4.4" xref="S3.E11.m1.6.6.1.1.4.4.cmml"><mstyle displaystyle="true" id="S3.E11.m1.6.6.1.1.4.4.3" xref="S3.E11.m1.6.6.1.1.4.4.3.cmml"><mfrac id="S3.E11.m1.6.6.1.1.4.4.3a" xref="S3.E11.m1.6.6.1.1.4.4.3.cmml"><mn id="S3.E11.m1.6.6.1.1.4.4.3.2" xref="S3.E11.m1.6.6.1.1.4.4.3.2.cmml">1</mn><mrow id="S3.E11.m1.6.6.1.1.4.4.3.3" xref="S3.E11.m1.6.6.1.1.4.4.3.3.cmml"><mn id="S3.E11.m1.6.6.1.1.4.4.3.3.2" xref="S3.E11.m1.6.6.1.1.4.4.3.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E11.m1.6.6.1.1.4.4.3.3.1" xref="S3.E11.m1.6.6.1.1.4.4.3.3.1.cmml">​</mo><mi id="S3.E11.m1.6.6.1.1.4.4.3.3.3" xref="S3.E11.m1.6.6.1.1.4.4.3.3.3.cmml">μ</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E11.m1.6.6.1.1.4.4.2" xref="S3.E11.m1.6.6.1.1.4.4.2.cmml">​</mo><msubsup id="S3.E11.m1.6.6.1.1.4.4.1" xref="S3.E11.m1.6.6.1.1.4.4.1.cmml"><mrow id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.2" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.cmml"><msup id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.2" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.2.cmml"><mi id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.2.2" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.2.2.cmml">𝐖</mi><mrow id="S3.E11.m1.2.2.2.4" xref="S3.E11.m1.2.2.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml">q</mi><mo id="S3.E11.m1.2.2.2.4.1" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><mi id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.2.cmml">k</mi></mrow></msup><mo id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.1" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.1.cmml">−</mo><msup id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.3" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.3.cmml"><mi id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.3.2" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.3.2.cmml">𝐖</mi><mrow id="S3.E11.m1.4.4.2.4" xref="S3.E11.m1.4.4.2.3.cmml"><mi id="S3.E11.m1.3.3.1.1" xref="S3.E11.m1.3.3.1.1.cmml">q</mi><mo id="S3.E11.m1.4.4.2.4.1" xref="S3.E11.m1.4.4.2.3.cmml">,</mo><mi id="S3.E11.m1.4.4.2.2" xref="S3.E11.m1.4.4.2.2.cmml">G</mi></mrow></msup></mrow><mo stretchy="false" id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.3" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E11.m1.6.6.1.1.4.4.1.3" xref="S3.E11.m1.6.6.1.1.4.4.1.3.cmml">2</mn><mn id="S3.E11.m1.6.6.1.1.4.4.1.1.3" xref="S3.E11.m1.6.6.1.1.4.4.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><mo id="S3.E11.m1.6.6.1.2" xref="S3.E11.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.6b"><apply id="S3.E11.m1.6.6.1.1.cmml" xref="S3.E11.m1.6.6.1"><leq id="S3.E11.m1.6.6.1.1.5.cmml" xref="S3.E11.m1.6.6.1.1.5"></leq><apply id="S3.E11.m1.6.6.1.1.6.cmml" xref="S3.E11.m1.6.6.1.1.6"><times id="S3.E11.m1.6.6.1.1.6.1.cmml" xref="S3.E11.m1.6.6.1.1.6.1"></times><apply id="S3.E11.m1.6.6.1.1.6.2.cmml" xref="S3.E11.m1.6.6.1.1.6.2"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.1.1.6.2.1.cmml" xref="S3.E11.m1.6.6.1.1.6.2">subscript</csymbol><ci id="S3.E11.m1.6.6.1.1.6.2.2.cmml" xref="S3.E11.m1.6.6.1.1.6.2.2">𝐹</ci><ci id="S3.E11.m1.6.6.1.1.6.2.3.cmml" xref="S3.E11.m1.6.6.1.1.6.2.3">𝑘</ci></apply><ci id="S3.E11.m1.5.5.cmml" xref="S3.E11.m1.5.5">𝑤</ci></apply><apply id="S3.E11.m1.6.6.1.1.4.cmml" xref="S3.E11.m1.6.6.1.1.4"><plus id="S3.E11.m1.6.6.1.1.4.5.cmml" xref="S3.E11.m1.6.6.1.1.4.5"></plus><apply id="S3.E11.m1.6.6.1.1.1.1.cmml" xref="S3.E11.m1.6.6.1.1.1.1"><times id="S3.E11.m1.6.6.1.1.1.1.2.cmml" xref="S3.E11.m1.6.6.1.1.1.1.2"></times><apply id="S3.E11.m1.6.6.1.1.1.1.3.cmml" xref="S3.E11.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.1.1.1.1.3.1.cmml" xref="S3.E11.m1.6.6.1.1.1.1.3">subscript</csymbol><ci id="S3.E11.m1.6.6.1.1.1.1.3.2.cmml" xref="S3.E11.m1.6.6.1.1.1.1.3.2">𝐹</ci><ci id="S3.E11.m1.6.6.1.1.1.1.3.3.cmml" xref="S3.E11.m1.6.6.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E11.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.6.6.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E11.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.6.6.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E11.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.6.6.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E11.m1.6.6.1.1.3.3.cmml" xref="S3.E11.m1.6.6.1.1.3.3"><times id="S3.E11.m1.6.6.1.1.3.3.3.cmml" xref="S3.E11.m1.6.6.1.1.3.3.3"></times><apply id="S3.E11.m1.6.6.1.1.3.3.4.cmml" xref="S3.E11.m1.6.6.1.1.3.3.4"><ci id="S3.E11.m1.6.6.1.1.3.3.4.1.cmml" xref="S3.E11.m1.6.6.1.1.3.3.4.1">∇</ci><apply id="S3.E11.m1.6.6.1.1.3.3.4.2.cmml" xref="S3.E11.m1.6.6.1.1.3.3.4.2"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.1.1.3.3.4.2.1.cmml" xref="S3.E11.m1.6.6.1.1.3.3.4.2">subscript</csymbol><ci id="S3.E11.m1.6.6.1.1.3.3.4.2.2.cmml" xref="S3.E11.m1.6.6.1.1.3.3.4.2.2">𝐹</ci><ci id="S3.E11.m1.6.6.1.1.3.3.4.2.3.cmml" xref="S3.E11.m1.6.6.1.1.3.3.4.2.3">𝑘</ci></apply></apply><apply id="S3.E11.m1.6.6.1.1.2.2.1.cmml" xref="S3.E11.m1.6.6.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.1.1.2.2.1.2.cmml" xref="S3.E11.m1.6.6.1.1.2.2.1">superscript</csymbol><apply id="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.cmml" xref="S3.E11.m1.6.6.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E11.m1.6.6.1.1.2.2.1.1.1">superscript</csymbol><ci id="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.2">𝑤</ci><ci id="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E11.m1.6.6.1.1.2.2.1.1.1.1.3">𝑡</ci></apply><ci id="S3.E11.m1.6.6.1.1.2.2.1.3.cmml" xref="S3.E11.m1.6.6.1.1.2.2.1.3">𝑇</ci></apply><apply id="S3.E11.m1.6.6.1.1.3.3.2.1.1.cmml" xref="S3.E11.m1.6.6.1.1.3.3.2.1"><minus id="S3.E11.m1.6.6.1.1.3.3.2.1.1.1.cmml" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.1"></minus><ci id="S3.E11.m1.6.6.1.1.3.3.2.1.1.2.cmml" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.2">𝑤</ci><apply id="S3.E11.m1.6.6.1.1.3.3.2.1.1.3.cmml" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.1.1.3.3.2.1.1.3.1.cmml" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.3">superscript</csymbol><ci id="S3.E11.m1.6.6.1.1.3.3.2.1.1.3.2.cmml" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.3.2">𝑤</ci><ci id="S3.E11.m1.6.6.1.1.3.3.2.1.1.3.3.cmml" xref="S3.E11.m1.6.6.1.1.3.3.2.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E11.m1.6.6.1.1.4.4.cmml" xref="S3.E11.m1.6.6.1.1.4.4"><times id="S3.E11.m1.6.6.1.1.4.4.2.cmml" xref="S3.E11.m1.6.6.1.1.4.4.2"></times><apply id="S3.E11.m1.6.6.1.1.4.4.3.cmml" xref="S3.E11.m1.6.6.1.1.4.4.3"><divide id="S3.E11.m1.6.6.1.1.4.4.3.1.cmml" xref="S3.E11.m1.6.6.1.1.4.4.3"></divide><cn type="integer" id="S3.E11.m1.6.6.1.1.4.4.3.2.cmml" xref="S3.E11.m1.6.6.1.1.4.4.3.2">1</cn><apply id="S3.E11.m1.6.6.1.1.4.4.3.3.cmml" xref="S3.E11.m1.6.6.1.1.4.4.3.3"><times id="S3.E11.m1.6.6.1.1.4.4.3.3.1.cmml" xref="S3.E11.m1.6.6.1.1.4.4.3.3.1"></times><cn type="integer" id="S3.E11.m1.6.6.1.1.4.4.3.3.2.cmml" xref="S3.E11.m1.6.6.1.1.4.4.3.3.2">2</cn><ci id="S3.E11.m1.6.6.1.1.4.4.3.3.3.cmml" xref="S3.E11.m1.6.6.1.1.4.4.3.3.3">𝜇</ci></apply></apply><apply id="S3.E11.m1.6.6.1.1.4.4.1.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.1.1.4.4.1.2.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1">subscript</csymbol><apply id="S3.E11.m1.6.6.1.1.4.4.1.1.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.1.1.4.4.1.1.2.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1">superscript</csymbol><apply id="S3.E11.m1.6.6.1.1.4.4.1.1.1.2.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1"><csymbol cd="latexml" id="S3.E11.m1.6.6.1.1.4.4.1.1.1.2.1.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.2">norm</csymbol><apply id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1"><minus id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.1.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.1"></minus><apply id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.2.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.2.2">𝐖</ci><list id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.4"><ci id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1">𝑞</ci><ci id="S3.E11.m1.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.3.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.1.1.1.1.3.2">𝐖</ci><list id="S3.E11.m1.4.4.2.3.cmml" xref="S3.E11.m1.4.4.2.4"><ci id="S3.E11.m1.3.3.1.1.cmml" xref="S3.E11.m1.3.3.1.1">𝑞</ci><ci id="S3.E11.m1.4.4.2.2.cmml" xref="S3.E11.m1.4.4.2.2">𝐺</ci></list></apply></apply></apply><cn type="integer" id="S3.E11.m1.6.6.1.1.4.4.1.1.3.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.1.3">2</cn></apply><cn type="integer" id="S3.E11.m1.6.6.1.1.4.4.1.3.cmml" xref="S3.E11.m1.6.6.1.1.4.4.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.6c">\displaystyle F_{k}(w)\leq F_{k}(w^{t})+\nabla F_{k}(w^{t})^{T}(w-w^{t})+\frac{1}{2\mu}||\mathbf{W}^{q,k}-\mathbf{W}^{q,G}||^{2}_{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p8" class="ltx_para">
<p id="S3.SS1.p8.4" class="ltx_p">where <math id="S3.SS1.p8.1.m1.1" class="ltx_Math" alttext="\nabla F_{k}(w^{t})" display="inline"><semantics id="S3.SS1.p8.1.m1.1a"><mrow id="S3.SS1.p8.1.m1.1.1" xref="S3.SS1.p8.1.m1.1.1.cmml"><mrow id="S3.SS1.p8.1.m1.1.1.3" xref="S3.SS1.p8.1.m1.1.1.3.cmml"><mo rspace="0.167em" id="S3.SS1.p8.1.m1.1.1.3.1" xref="S3.SS1.p8.1.m1.1.1.3.1.cmml">∇</mo><msub id="S3.SS1.p8.1.m1.1.1.3.2" xref="S3.SS1.p8.1.m1.1.1.3.2.cmml"><mi id="S3.SS1.p8.1.m1.1.1.3.2.2" xref="S3.SS1.p8.1.m1.1.1.3.2.2.cmml">F</mi><mi id="S3.SS1.p8.1.m1.1.1.3.2.3" xref="S3.SS1.p8.1.m1.1.1.3.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p8.1.m1.1.1.2" xref="S3.SS1.p8.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p8.1.m1.1.1.1.1" xref="S3.SS1.p8.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p8.1.m1.1.1.1.1.2" xref="S3.SS1.p8.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS1.p8.1.m1.1.1.1.1.1" xref="S3.SS1.p8.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p8.1.m1.1.1.1.1.1.2" xref="S3.SS1.p8.1.m1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.SS1.p8.1.m1.1.1.1.1.1.3" xref="S3.SS1.p8.1.m1.1.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.SS1.p8.1.m1.1.1.1.1.3" xref="S3.SS1.p8.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.1.m1.1b"><apply id="S3.SS1.p8.1.m1.1.1.cmml" xref="S3.SS1.p8.1.m1.1.1"><times id="S3.SS1.p8.1.m1.1.1.2.cmml" xref="S3.SS1.p8.1.m1.1.1.2"></times><apply id="S3.SS1.p8.1.m1.1.1.3.cmml" xref="S3.SS1.p8.1.m1.1.1.3"><ci id="S3.SS1.p8.1.m1.1.1.3.1.cmml" xref="S3.SS1.p8.1.m1.1.1.3.1">∇</ci><apply id="S3.SS1.p8.1.m1.1.1.3.2.cmml" xref="S3.SS1.p8.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p8.1.m1.1.1.3.2.1.cmml" xref="S3.SS1.p8.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p8.1.m1.1.1.3.2.2.cmml" xref="S3.SS1.p8.1.m1.1.1.3.2.2">𝐹</ci><ci id="S3.SS1.p8.1.m1.1.1.3.2.3.cmml" xref="S3.SS1.p8.1.m1.1.1.3.2.3">𝑘</ci></apply></apply><apply id="S3.SS1.p8.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p8.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p8.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p8.1.m1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p8.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p8.1.m1.1.1.1.1.1.2">𝑤</ci><ci id="S3.SS1.p8.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p8.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.1.m1.1c">\nabla F_{k}(w^{t})</annotation></semantics></math> is the gradient of the local loss function at <math id="S3.SS1.p8.2.m2.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="S3.SS1.p8.2.m2.1a"><msup id="S3.SS1.p8.2.m2.1.1" xref="S3.SS1.p8.2.m2.1.1.cmml"><mi id="S3.SS1.p8.2.m2.1.1.2" xref="S3.SS1.p8.2.m2.1.1.2.cmml">w</mi><mi id="S3.SS1.p8.2.m2.1.1.3" xref="S3.SS1.p8.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.2.m2.1b"><apply id="S3.SS1.p8.2.m2.1.1.cmml" xref="S3.SS1.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p8.2.m2.1.1.1.cmml" xref="S3.SS1.p8.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p8.2.m2.1.1.2.cmml" xref="S3.SS1.p8.2.m2.1.1.2">𝑤</ci><ci id="S3.SS1.p8.2.m2.1.1.3.cmml" xref="S3.SS1.p8.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.2.m2.1c">w^{t}</annotation></semantics></math> and <math id="S3.SS1.p8.3.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS1.p8.3.m3.1a"><mi id="S3.SS1.p8.3.m3.1.1" xref="S3.SS1.p8.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.3.m3.1b"><ci id="S3.SS1.p8.3.m3.1.1.cmml" xref="S3.SS1.p8.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.3.m3.1c">\mu</annotation></semantics></math> is a positive scalar representing the step size. This regularization term is analogous to the attention score in MHSA, controlling the contribution of each feature to the final representation. The norm <math id="S3.SS1.p8.4.m4.5" class="ltx_Math" alttext="||\mathbf{W}^{q,k}-\mathbf{W}^{q,G}||^{2}_{2}" display="inline"><semantics id="S3.SS1.p8.4.m4.5a"><msubsup id="S3.SS1.p8.4.m4.5.5" xref="S3.SS1.p8.4.m4.5.5.cmml"><mrow id="S3.SS1.p8.4.m4.5.5.1.1.1" xref="S3.SS1.p8.4.m4.5.5.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p8.4.m4.5.5.1.1.1.2" xref="S3.SS1.p8.4.m4.5.5.1.1.2.1.cmml">‖</mo><mrow id="S3.SS1.p8.4.m4.5.5.1.1.1.1" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.cmml"><msup id="S3.SS1.p8.4.m4.5.5.1.1.1.1.2" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.2.cmml"><mi id="S3.SS1.p8.4.m4.5.5.1.1.1.1.2.2" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.2.2.cmml">𝐖</mi><mrow id="S3.SS1.p8.4.m4.2.2.2.4" xref="S3.SS1.p8.4.m4.2.2.2.3.cmml"><mi id="S3.SS1.p8.4.m4.1.1.1.1" xref="S3.SS1.p8.4.m4.1.1.1.1.cmml">q</mi><mo id="S3.SS1.p8.4.m4.2.2.2.4.1" xref="S3.SS1.p8.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p8.4.m4.2.2.2.2" xref="S3.SS1.p8.4.m4.2.2.2.2.cmml">k</mi></mrow></msup><mo id="S3.SS1.p8.4.m4.5.5.1.1.1.1.1" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.1.cmml">−</mo><msup id="S3.SS1.p8.4.m4.5.5.1.1.1.1.3" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.3.cmml"><mi id="S3.SS1.p8.4.m4.5.5.1.1.1.1.3.2" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.3.2.cmml">𝐖</mi><mrow id="S3.SS1.p8.4.m4.4.4.2.4" xref="S3.SS1.p8.4.m4.4.4.2.3.cmml"><mi id="S3.SS1.p8.4.m4.3.3.1.1" xref="S3.SS1.p8.4.m4.3.3.1.1.cmml">q</mi><mo id="S3.SS1.p8.4.m4.4.4.2.4.1" xref="S3.SS1.p8.4.m4.4.4.2.3.cmml">,</mo><mi id="S3.SS1.p8.4.m4.4.4.2.2" xref="S3.SS1.p8.4.m4.4.4.2.2.cmml">G</mi></mrow></msup></mrow><mo stretchy="false" id="S3.SS1.p8.4.m4.5.5.1.1.1.3" xref="S3.SS1.p8.4.m4.5.5.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS1.p8.4.m4.5.5.3" xref="S3.SS1.p8.4.m4.5.5.3.cmml">2</mn><mn id="S3.SS1.p8.4.m4.5.5.1.3" xref="S3.SS1.p8.4.m4.5.5.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.4.m4.5b"><apply id="S3.SS1.p8.4.m4.5.5.cmml" xref="S3.SS1.p8.4.m4.5.5"><csymbol cd="ambiguous" id="S3.SS1.p8.4.m4.5.5.2.cmml" xref="S3.SS1.p8.4.m4.5.5">subscript</csymbol><apply id="S3.SS1.p8.4.m4.5.5.1.cmml" xref="S3.SS1.p8.4.m4.5.5"><csymbol cd="ambiguous" id="S3.SS1.p8.4.m4.5.5.1.2.cmml" xref="S3.SS1.p8.4.m4.5.5">superscript</csymbol><apply id="S3.SS1.p8.4.m4.5.5.1.1.2.cmml" xref="S3.SS1.p8.4.m4.5.5.1.1.1"><csymbol cd="latexml" id="S3.SS1.p8.4.m4.5.5.1.1.2.1.cmml" xref="S3.SS1.p8.4.m4.5.5.1.1.1.2">norm</csymbol><apply id="S3.SS1.p8.4.m4.5.5.1.1.1.1.cmml" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1"><minus id="S3.SS1.p8.4.m4.5.5.1.1.1.1.1.cmml" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.1"></minus><apply id="S3.SS1.p8.4.m4.5.5.1.1.1.1.2.cmml" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p8.4.m4.5.5.1.1.1.1.2.1.cmml" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p8.4.m4.5.5.1.1.1.1.2.2.cmml" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.2.2">𝐖</ci><list id="S3.SS1.p8.4.m4.2.2.2.3.cmml" xref="S3.SS1.p8.4.m4.2.2.2.4"><ci id="S3.SS1.p8.4.m4.1.1.1.1.cmml" xref="S3.SS1.p8.4.m4.1.1.1.1">𝑞</ci><ci id="S3.SS1.p8.4.m4.2.2.2.2.cmml" xref="S3.SS1.p8.4.m4.2.2.2.2">𝑘</ci></list></apply><apply id="S3.SS1.p8.4.m4.5.5.1.1.1.1.3.cmml" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p8.4.m4.5.5.1.1.1.1.3.1.cmml" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p8.4.m4.5.5.1.1.1.1.3.2.cmml" xref="S3.SS1.p8.4.m4.5.5.1.1.1.1.3.2">𝐖</ci><list id="S3.SS1.p8.4.m4.4.4.2.3.cmml" xref="S3.SS1.p8.4.m4.4.4.2.4"><ci id="S3.SS1.p8.4.m4.3.3.1.1.cmml" xref="S3.SS1.p8.4.m4.3.3.1.1">𝑞</ci><ci id="S3.SS1.p8.4.m4.4.4.2.2.cmml" xref="S3.SS1.p8.4.m4.4.4.2.2">𝐺</ci></list></apply></apply></apply><cn type="integer" id="S3.SS1.p8.4.m4.5.5.1.3.cmml" xref="S3.SS1.p8.4.m4.5.5.1.3">2</cn></apply><cn type="integer" id="S3.SS1.p8.4.m4.5.5.3.cmml" xref="S3.SS1.p8.4.m4.5.5.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.4.m4.5c">||\mathbf{W}^{q,k}-\mathbf{W}^{q,G}||^{2}_{2}</annotation></semantics></math> represents the Euclidean distance between the local and global model’s query matrices. This regularization term aligns the local model to the global model in the query space.</p>
</div>
<div id="S3.SS1.p9" class="ltx_para">
<p id="S3.SS1.p9.1" class="ltx_p">The resulting objective function becomes:</p>
</div>
<div id="S3.SS1.p10" class="ltx_para">
<table id="Sx1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E12.m1.7" class="ltx_Math" alttext="\displaystyle\min_{w}h_{k}(w;~{}w^{t})=F_{k}(w)+\frac{\mu}{2}||\mathbf{W}^{q,k}-\mathbf{W}^{q,G}||^{2}_{2}," display="inline"><semantics id="S3.E12.m1.7a"><mrow id="S3.E12.m1.7.7.1" xref="S3.E12.m1.7.7.1.1.cmml"><mrow id="S3.E12.m1.7.7.1.1" xref="S3.E12.m1.7.7.1.1.cmml"><mrow id="S3.E12.m1.7.7.1.1.1" xref="S3.E12.m1.7.7.1.1.1.cmml"><mrow id="S3.E12.m1.7.7.1.1.1.3" xref="S3.E12.m1.7.7.1.1.1.3.cmml"><munder id="S3.E12.m1.7.7.1.1.1.3.1" xref="S3.E12.m1.7.7.1.1.1.3.1.cmml"><mi id="S3.E12.m1.7.7.1.1.1.3.1.2" xref="S3.E12.m1.7.7.1.1.1.3.1.2.cmml">min</mi><mi id="S3.E12.m1.7.7.1.1.1.3.1.3" xref="S3.E12.m1.7.7.1.1.1.3.1.3.cmml">w</mi></munder><mo lspace="0.167em" id="S3.E12.m1.7.7.1.1.1.3a" xref="S3.E12.m1.7.7.1.1.1.3.cmml">⁡</mo><msub id="S3.E12.m1.7.7.1.1.1.3.2" xref="S3.E12.m1.7.7.1.1.1.3.2.cmml"><mi id="S3.E12.m1.7.7.1.1.1.3.2.2" xref="S3.E12.m1.7.7.1.1.1.3.2.2.cmml">h</mi><mi id="S3.E12.m1.7.7.1.1.1.3.2.3" xref="S3.E12.m1.7.7.1.1.1.3.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E12.m1.7.7.1.1.1.2" xref="S3.E12.m1.7.7.1.1.1.2.cmml">​</mo><mrow id="S3.E12.m1.7.7.1.1.1.1.1" xref="S3.E12.m1.7.7.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.m1.7.7.1.1.1.1.1.2" xref="S3.E12.m1.7.7.1.1.1.1.2.cmml">(</mo><mi id="S3.E12.m1.5.5" xref="S3.E12.m1.5.5.cmml">w</mi><mo rspace="0.497em" id="S3.E12.m1.7.7.1.1.1.1.1.3" xref="S3.E12.m1.7.7.1.1.1.1.2.cmml">;</mo><msup id="S3.E12.m1.7.7.1.1.1.1.1.1" xref="S3.E12.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.7.7.1.1.1.1.1.1.2" xref="S3.E12.m1.7.7.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E12.m1.7.7.1.1.1.1.1.1.3" xref="S3.E12.m1.7.7.1.1.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.E12.m1.7.7.1.1.1.1.1.4" xref="S3.E12.m1.7.7.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.7.7.1.1.3" xref="S3.E12.m1.7.7.1.1.3.cmml">=</mo><mrow id="S3.E12.m1.7.7.1.1.2" xref="S3.E12.m1.7.7.1.1.2.cmml"><mrow id="S3.E12.m1.7.7.1.1.2.3" xref="S3.E12.m1.7.7.1.1.2.3.cmml"><msub id="S3.E12.m1.7.7.1.1.2.3.2" xref="S3.E12.m1.7.7.1.1.2.3.2.cmml"><mi id="S3.E12.m1.7.7.1.1.2.3.2.2" xref="S3.E12.m1.7.7.1.1.2.3.2.2.cmml">F</mi><mi id="S3.E12.m1.7.7.1.1.2.3.2.3" xref="S3.E12.m1.7.7.1.1.2.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12.m1.7.7.1.1.2.3.1" xref="S3.E12.m1.7.7.1.1.2.3.1.cmml">​</mo><mrow id="S3.E12.m1.7.7.1.1.2.3.3.2" xref="S3.E12.m1.7.7.1.1.2.3.cmml"><mo stretchy="false" id="S3.E12.m1.7.7.1.1.2.3.3.2.1" xref="S3.E12.m1.7.7.1.1.2.3.cmml">(</mo><mi id="S3.E12.m1.6.6" xref="S3.E12.m1.6.6.cmml">w</mi><mo stretchy="false" id="S3.E12.m1.7.7.1.1.2.3.3.2.2" xref="S3.E12.m1.7.7.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.7.7.1.1.2.2" xref="S3.E12.m1.7.7.1.1.2.2.cmml">+</mo><mrow id="S3.E12.m1.7.7.1.1.2.1" xref="S3.E12.m1.7.7.1.1.2.1.cmml"><mstyle displaystyle="true" id="S3.E12.m1.7.7.1.1.2.1.3" xref="S3.E12.m1.7.7.1.1.2.1.3.cmml"><mfrac id="S3.E12.m1.7.7.1.1.2.1.3a" xref="S3.E12.m1.7.7.1.1.2.1.3.cmml"><mi id="S3.E12.m1.7.7.1.1.2.1.3.2" xref="S3.E12.m1.7.7.1.1.2.1.3.2.cmml">μ</mi><mn id="S3.E12.m1.7.7.1.1.2.1.3.3" xref="S3.E12.m1.7.7.1.1.2.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E12.m1.7.7.1.1.2.1.2" xref="S3.E12.m1.7.7.1.1.2.1.2.cmml">​</mo><msubsup id="S3.E12.m1.7.7.1.1.2.1.1" xref="S3.E12.m1.7.7.1.1.2.1.1.cmml"><mrow id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.2" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.cmml"><msup id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.2" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.2.2" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.2.2.cmml">𝐖</mi><mrow id="S3.E12.m1.2.2.2.4" xref="S3.E12.m1.2.2.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml">q</mi><mo id="S3.E12.m1.2.2.2.4.1" xref="S3.E12.m1.2.2.2.3.cmml">,</mo><mi id="S3.E12.m1.2.2.2.2" xref="S3.E12.m1.2.2.2.2.cmml">k</mi></mrow></msup><mo id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.1" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml">−</mo><msup id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.3" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.3.2" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.3.2.cmml">𝐖</mi><mrow id="S3.E12.m1.4.4.2.4" xref="S3.E12.m1.4.4.2.3.cmml"><mi id="S3.E12.m1.3.3.1.1" xref="S3.E12.m1.3.3.1.1.cmml">q</mi><mo id="S3.E12.m1.4.4.2.4.1" xref="S3.E12.m1.4.4.2.3.cmml">,</mo><mi id="S3.E12.m1.4.4.2.2" xref="S3.E12.m1.4.4.2.2.cmml">G</mi></mrow></msup></mrow><mo stretchy="false" id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.3" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E12.m1.7.7.1.1.2.1.1.3" xref="S3.E12.m1.7.7.1.1.2.1.1.3.cmml">2</mn><mn id="S3.E12.m1.7.7.1.1.2.1.1.1.3" xref="S3.E12.m1.7.7.1.1.2.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><mo id="S3.E12.m1.7.7.1.2" xref="S3.E12.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.7b"><apply id="S3.E12.m1.7.7.1.1.cmml" xref="S3.E12.m1.7.7.1"><eq id="S3.E12.m1.7.7.1.1.3.cmml" xref="S3.E12.m1.7.7.1.1.3"></eq><apply id="S3.E12.m1.7.7.1.1.1.cmml" xref="S3.E12.m1.7.7.1.1.1"><times id="S3.E12.m1.7.7.1.1.1.2.cmml" xref="S3.E12.m1.7.7.1.1.1.2"></times><apply id="S3.E12.m1.7.7.1.1.1.3.cmml" xref="S3.E12.m1.7.7.1.1.1.3"><apply id="S3.E12.m1.7.7.1.1.1.3.1.cmml" xref="S3.E12.m1.7.7.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E12.m1.7.7.1.1.1.3.1.1.cmml" xref="S3.E12.m1.7.7.1.1.1.3.1">subscript</csymbol><min id="S3.E12.m1.7.7.1.1.1.3.1.2.cmml" xref="S3.E12.m1.7.7.1.1.1.3.1.2"></min><ci id="S3.E12.m1.7.7.1.1.1.3.1.3.cmml" xref="S3.E12.m1.7.7.1.1.1.3.1.3">𝑤</ci></apply><apply id="S3.E12.m1.7.7.1.1.1.3.2.cmml" xref="S3.E12.m1.7.7.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.7.7.1.1.1.3.2.1.cmml" xref="S3.E12.m1.7.7.1.1.1.3.2">subscript</csymbol><ci id="S3.E12.m1.7.7.1.1.1.3.2.2.cmml" xref="S3.E12.m1.7.7.1.1.1.3.2.2">ℎ</ci><ci id="S3.E12.m1.7.7.1.1.1.3.2.3.cmml" xref="S3.E12.m1.7.7.1.1.1.3.2.3">𝑘</ci></apply></apply><list id="S3.E12.m1.7.7.1.1.1.1.2.cmml" xref="S3.E12.m1.7.7.1.1.1.1.1"><ci id="S3.E12.m1.5.5.cmml" xref="S3.E12.m1.5.5">𝑤</ci><apply id="S3.E12.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E12.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.7.7.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E12.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.7.7.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E12.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.7.7.1.1.1.1.1.1.3">𝑡</ci></apply></list></apply><apply id="S3.E12.m1.7.7.1.1.2.cmml" xref="S3.E12.m1.7.7.1.1.2"><plus id="S3.E12.m1.7.7.1.1.2.2.cmml" xref="S3.E12.m1.7.7.1.1.2.2"></plus><apply id="S3.E12.m1.7.7.1.1.2.3.cmml" xref="S3.E12.m1.7.7.1.1.2.3"><times id="S3.E12.m1.7.7.1.1.2.3.1.cmml" xref="S3.E12.m1.7.7.1.1.2.3.1"></times><apply id="S3.E12.m1.7.7.1.1.2.3.2.cmml" xref="S3.E12.m1.7.7.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.7.7.1.1.2.3.2.1.cmml" xref="S3.E12.m1.7.7.1.1.2.3.2">subscript</csymbol><ci id="S3.E12.m1.7.7.1.1.2.3.2.2.cmml" xref="S3.E12.m1.7.7.1.1.2.3.2.2">𝐹</ci><ci id="S3.E12.m1.7.7.1.1.2.3.2.3.cmml" xref="S3.E12.m1.7.7.1.1.2.3.2.3">𝑘</ci></apply><ci id="S3.E12.m1.6.6.cmml" xref="S3.E12.m1.6.6">𝑤</ci></apply><apply id="S3.E12.m1.7.7.1.1.2.1.cmml" xref="S3.E12.m1.7.7.1.1.2.1"><times id="S3.E12.m1.7.7.1.1.2.1.2.cmml" xref="S3.E12.m1.7.7.1.1.2.1.2"></times><apply id="S3.E12.m1.7.7.1.1.2.1.3.cmml" xref="S3.E12.m1.7.7.1.1.2.1.3"><divide id="S3.E12.m1.7.7.1.1.2.1.3.1.cmml" xref="S3.E12.m1.7.7.1.1.2.1.3"></divide><ci id="S3.E12.m1.7.7.1.1.2.1.3.2.cmml" xref="S3.E12.m1.7.7.1.1.2.1.3.2">𝜇</ci><cn type="integer" id="S3.E12.m1.7.7.1.1.2.1.3.3.cmml" xref="S3.E12.m1.7.7.1.1.2.1.3.3">2</cn></apply><apply id="S3.E12.m1.7.7.1.1.2.1.1.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.7.7.1.1.2.1.1.2.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1">subscript</csymbol><apply id="S3.E12.m1.7.7.1.1.2.1.1.1.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.7.7.1.1.2.1.1.1.2.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1">superscript</csymbol><apply id="S3.E12.m1.7.7.1.1.2.1.1.1.1.2.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E12.m1.7.7.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.2">norm</csymbol><apply id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1"><minus id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.1"></minus><apply id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.2.2">𝐖</ci><list id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.4"><ci id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1">𝑞</ci><ci id="S3.E12.m1.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.1.1.1.1.3.2">𝐖</ci><list id="S3.E12.m1.4.4.2.3.cmml" xref="S3.E12.m1.4.4.2.4"><ci id="S3.E12.m1.3.3.1.1.cmml" xref="S3.E12.m1.3.3.1.1">𝑞</ci><ci id="S3.E12.m1.4.4.2.2.cmml" xref="S3.E12.m1.4.4.2.2">𝐺</ci></list></apply></apply></apply><cn type="integer" id="S3.E12.m1.7.7.1.1.2.1.1.1.3.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.1.3">2</cn></apply><cn type="integer" id="S3.E12.m1.7.7.1.1.2.1.1.3.cmml" xref="S3.E12.m1.7.7.1.1.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.7c">\displaystyle\min_{w}h_{k}(w;~{}w^{t})=F_{k}(w)+\frac{\mu}{2}||\mathbf{W}^{q,k}-\mathbf{W}^{q,G}||^{2}_{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p11" class="ltx_para">
<p id="S3.SS1.p11.3" class="ltx_p">where the term <math id="S3.SS1.p11.1.m1.5" class="ltx_Math" alttext="||\mathbf{W}^{q,k}-\mathbf{W}^{q,G}||^{2}_{2}" display="inline"><semantics id="S3.SS1.p11.1.m1.5a"><msubsup id="S3.SS1.p11.1.m1.5.5" xref="S3.SS1.p11.1.m1.5.5.cmml"><mrow id="S3.SS1.p11.1.m1.5.5.1.1.1" xref="S3.SS1.p11.1.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p11.1.m1.5.5.1.1.1.2" xref="S3.SS1.p11.1.m1.5.5.1.1.2.1.cmml">‖</mo><mrow id="S3.SS1.p11.1.m1.5.5.1.1.1.1" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.cmml"><msup id="S3.SS1.p11.1.m1.5.5.1.1.1.1.2" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.2.cmml"><mi id="S3.SS1.p11.1.m1.5.5.1.1.1.1.2.2" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.2.2.cmml">𝐖</mi><mrow id="S3.SS1.p11.1.m1.2.2.2.4" xref="S3.SS1.p11.1.m1.2.2.2.3.cmml"><mi id="S3.SS1.p11.1.m1.1.1.1.1" xref="S3.SS1.p11.1.m1.1.1.1.1.cmml">q</mi><mo id="S3.SS1.p11.1.m1.2.2.2.4.1" xref="S3.SS1.p11.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p11.1.m1.2.2.2.2" xref="S3.SS1.p11.1.m1.2.2.2.2.cmml">k</mi></mrow></msup><mo id="S3.SS1.p11.1.m1.5.5.1.1.1.1.1" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.1.cmml">−</mo><msup id="S3.SS1.p11.1.m1.5.5.1.1.1.1.3" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.3.cmml"><mi id="S3.SS1.p11.1.m1.5.5.1.1.1.1.3.2" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.3.2.cmml">𝐖</mi><mrow id="S3.SS1.p11.1.m1.4.4.2.4" xref="S3.SS1.p11.1.m1.4.4.2.3.cmml"><mi id="S3.SS1.p11.1.m1.3.3.1.1" xref="S3.SS1.p11.1.m1.3.3.1.1.cmml">q</mi><mo id="S3.SS1.p11.1.m1.4.4.2.4.1" xref="S3.SS1.p11.1.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS1.p11.1.m1.4.4.2.2" xref="S3.SS1.p11.1.m1.4.4.2.2.cmml">G</mi></mrow></msup></mrow><mo stretchy="false" id="S3.SS1.p11.1.m1.5.5.1.1.1.3" xref="S3.SS1.p11.1.m1.5.5.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS1.p11.1.m1.5.5.3" xref="S3.SS1.p11.1.m1.5.5.3.cmml">2</mn><mn id="S3.SS1.p11.1.m1.5.5.1.3" xref="S3.SS1.p11.1.m1.5.5.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p11.1.m1.5b"><apply id="S3.SS1.p11.1.m1.5.5.cmml" xref="S3.SS1.p11.1.m1.5.5"><csymbol cd="ambiguous" id="S3.SS1.p11.1.m1.5.5.2.cmml" xref="S3.SS1.p11.1.m1.5.5">subscript</csymbol><apply id="S3.SS1.p11.1.m1.5.5.1.cmml" xref="S3.SS1.p11.1.m1.5.5"><csymbol cd="ambiguous" id="S3.SS1.p11.1.m1.5.5.1.2.cmml" xref="S3.SS1.p11.1.m1.5.5">superscript</csymbol><apply id="S3.SS1.p11.1.m1.5.5.1.1.2.cmml" xref="S3.SS1.p11.1.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.SS1.p11.1.m1.5.5.1.1.2.1.cmml" xref="S3.SS1.p11.1.m1.5.5.1.1.1.2">norm</csymbol><apply id="S3.SS1.p11.1.m1.5.5.1.1.1.1.cmml" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1"><minus id="S3.SS1.p11.1.m1.5.5.1.1.1.1.1.cmml" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.1"></minus><apply id="S3.SS1.p11.1.m1.5.5.1.1.1.1.2.cmml" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p11.1.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p11.1.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.2.2">𝐖</ci><list id="S3.SS1.p11.1.m1.2.2.2.3.cmml" xref="S3.SS1.p11.1.m1.2.2.2.4"><ci id="S3.SS1.p11.1.m1.1.1.1.1.cmml" xref="S3.SS1.p11.1.m1.1.1.1.1">𝑞</ci><ci id="S3.SS1.p11.1.m1.2.2.2.2.cmml" xref="S3.SS1.p11.1.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S3.SS1.p11.1.m1.5.5.1.1.1.1.3.cmml" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p11.1.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.3">superscript</csymbol><ci id="S3.SS1.p11.1.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.SS1.p11.1.m1.5.5.1.1.1.1.3.2">𝐖</ci><list id="S3.SS1.p11.1.m1.4.4.2.3.cmml" xref="S3.SS1.p11.1.m1.4.4.2.4"><ci id="S3.SS1.p11.1.m1.3.3.1.1.cmml" xref="S3.SS1.p11.1.m1.3.3.1.1">𝑞</ci><ci id="S3.SS1.p11.1.m1.4.4.2.2.cmml" xref="S3.SS1.p11.1.m1.4.4.2.2">𝐺</ci></list></apply></apply></apply><cn type="integer" id="S3.SS1.p11.1.m1.5.5.1.3.cmml" xref="S3.SS1.p11.1.m1.5.5.1.3">2</cn></apply><cn type="integer" id="S3.SS1.p11.1.m1.5.5.3.cmml" xref="S3.SS1.p11.1.m1.5.5.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p11.1.m1.5c">||\mathbf{W}^{q,k}-\mathbf{W}^{q,G}||^{2}_{2}</annotation></semantics></math> represents the squared Euclidean norm, aligning the local query matrix <math id="S3.SS1.p11.2.m2.2" class="ltx_Math" alttext="\mathbf{W}^{q,k}" display="inline"><semantics id="S3.SS1.p11.2.m2.2a"><msup id="S3.SS1.p11.2.m2.2.3" xref="S3.SS1.p11.2.m2.2.3.cmml"><mi id="S3.SS1.p11.2.m2.2.3.2" xref="S3.SS1.p11.2.m2.2.3.2.cmml">𝐖</mi><mrow id="S3.SS1.p11.2.m2.2.2.2.4" xref="S3.SS1.p11.2.m2.2.2.2.3.cmml"><mi id="S3.SS1.p11.2.m2.1.1.1.1" xref="S3.SS1.p11.2.m2.1.1.1.1.cmml">q</mi><mo id="S3.SS1.p11.2.m2.2.2.2.4.1" xref="S3.SS1.p11.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p11.2.m2.2.2.2.2" xref="S3.SS1.p11.2.m2.2.2.2.2.cmml">k</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p11.2.m2.2b"><apply id="S3.SS1.p11.2.m2.2.3.cmml" xref="S3.SS1.p11.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p11.2.m2.2.3.1.cmml" xref="S3.SS1.p11.2.m2.2.3">superscript</csymbol><ci id="S3.SS1.p11.2.m2.2.3.2.cmml" xref="S3.SS1.p11.2.m2.2.3.2">𝐖</ci><list id="S3.SS1.p11.2.m2.2.2.2.3.cmml" xref="S3.SS1.p11.2.m2.2.2.2.4"><ci id="S3.SS1.p11.2.m2.1.1.1.1.cmml" xref="S3.SS1.p11.2.m2.1.1.1.1">𝑞</ci><ci id="S3.SS1.p11.2.m2.2.2.2.2.cmml" xref="S3.SS1.p11.2.m2.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p11.2.m2.2c">\mathbf{W}^{q,k}</annotation></semantics></math> to the global one <math id="S3.SS1.p11.3.m3.2" class="ltx_Math" alttext="\mathbf{W}^{q,G}" display="inline"><semantics id="S3.SS1.p11.3.m3.2a"><msup id="S3.SS1.p11.3.m3.2.3" xref="S3.SS1.p11.3.m3.2.3.cmml"><mi id="S3.SS1.p11.3.m3.2.3.2" xref="S3.SS1.p11.3.m3.2.3.2.cmml">𝐖</mi><mrow id="S3.SS1.p11.3.m3.2.2.2.4" xref="S3.SS1.p11.3.m3.2.2.2.3.cmml"><mi id="S3.SS1.p11.3.m3.1.1.1.1" xref="S3.SS1.p11.3.m3.1.1.1.1.cmml">q</mi><mo id="S3.SS1.p11.3.m3.2.2.2.4.1" xref="S3.SS1.p11.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p11.3.m3.2.2.2.2" xref="S3.SS1.p11.3.m3.2.2.2.2.cmml">G</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p11.3.m3.2b"><apply id="S3.SS1.p11.3.m3.2.3.cmml" xref="S3.SS1.p11.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p11.3.m3.2.3.1.cmml" xref="S3.SS1.p11.3.m3.2.3">superscript</csymbol><ci id="S3.SS1.p11.3.m3.2.3.2.cmml" xref="S3.SS1.p11.3.m3.2.3.2">𝐖</ci><list id="S3.SS1.p11.3.m3.2.2.2.3.cmml" xref="S3.SS1.p11.3.m3.2.2.2.4"><ci id="S3.SS1.p11.3.m3.1.1.1.1.cmml" xref="S3.SS1.p11.3.m3.1.1.1.1">𝑞</ci><ci id="S3.SS1.p11.3.m3.2.2.2.2.cmml" xref="S3.SS1.p11.3.m3.2.2.2.2">𝐺</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p11.3.m3.2c">\mathbf{W}^{q,G}</annotation></semantics></math>. This term constrains the update of the local models, mitigating the issue of statistical heterogeneity. Here, the regularization term is analogous to the MHSA operation, where the contribution of each query (feature) to the final output depends on the similarity between the query and key. As in MHSA, where the attention weights are computed considering all tokens, here, the regularization term takes into account the whole model parameters. However, unlike MHSA, which calculates the similarity between tokens, here we calculate the distance between the local and global model’s query matrices. This regularization strategy mirrors the attention mechanism in the Vision transformers. In the next section, we extend the alignment to more matrices of the vision transformers, resulting in more added terms.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Multi-Head Encoder Alignment Mechanism (FedMHA)</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.11" class="ltx_p">First, let’s define the weight matrices of the local model <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="M_{i}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">M</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑀</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">M_{i}</annotation></semantics></math> and the global model <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="M_{G}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">M</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑀</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">M_{G}</annotation></semantics></math> as <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{W}^{q}{i}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><msup id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.p1.3.m3.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.2.3.cmml">q</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><times id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></times><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">𝐖</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3">𝑞</ci></apply><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathbf{W}^{q}{i}</annotation></semantics></math>, <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{W}^{k}{i}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><msup id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.p1.4.m4.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><times id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></times><apply id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2.2">𝐖</ci><ci id="S3.SS2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\mathbf{W}^{k}{i}</annotation></semantics></math>, <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{W}^{v}{i}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><msup id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2.2" xref="S3.SS2.p1.5.m5.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.p1.5.m5.1.1.2.3" xref="S3.SS2.p1.5.m5.1.1.2.3.cmml">v</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><times id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1"></times><apply id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2">𝐖</ci><ci id="S3.SS2.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3">𝑣</ci></apply><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\mathbf{W}^{v}{i}</annotation></semantics></math>, and <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{W}^{p}{i}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mrow id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><msup id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2.2" xref="S3.SS2.p1.6.m6.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.p1.6.m6.1.1.2.3" xref="S3.SS2.p1.6.m6.1.1.2.3.cmml">p</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><times id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1"></times><apply id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2.2">𝐖</ci><ci id="S3.SS2.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.p1.6.m6.1.1.2.3">𝑝</ci></apply><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathbf{W}^{p}{i}</annotation></semantics></math> for client <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">i</annotation></semantics></math>, and <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="\mathbf{W}^{q}{G}" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mrow id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><msup id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml"><mi id="S3.SS2.p1.8.m8.1.1.2.2" xref="S3.SS2.p1.8.m8.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.p1.8.m8.1.1.2.3" xref="S3.SS2.p1.8.m8.1.1.2.3.cmml">q</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.8.m8.1.1.1" xref="S3.SS2.p1.8.m8.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">G</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><times id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1.1"></times><apply id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2">𝐖</ci><ci id="S3.SS2.p1.8.m8.1.1.2.3.cmml" xref="S3.SS2.p1.8.m8.1.1.2.3">𝑞</ci></apply><ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\mathbf{W}^{q}{G}</annotation></semantics></math>, <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{W}^{k}{G}" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><mrow id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><msup id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2.2" xref="S3.SS2.p1.9.m9.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.p1.9.m9.1.1.2.3" xref="S3.SS2.p1.9.m9.1.1.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m9.1.1.1" xref="S3.SS2.p1.9.m9.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml">G</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><times id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1.1"></times><apply id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2.2">𝐖</ci><ci id="S3.SS2.p1.9.m9.1.1.2.3.cmml" xref="S3.SS2.p1.9.m9.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\mathbf{W}^{k}{G}</annotation></semantics></math>, <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="\mathbf{W}^{v}{G}" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><mrow id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><msup id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2.cmml"><mi id="S3.SS2.p1.10.m10.1.1.2.2" xref="S3.SS2.p1.10.m10.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.p1.10.m10.1.1.2.3" xref="S3.SS2.p1.10.m10.1.1.2.3.cmml">v</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.10.m10.1.1.1" xref="S3.SS2.p1.10.m10.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml">G</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><times id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1.1"></times><apply id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.2.1.cmml" xref="S3.SS2.p1.10.m10.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.2.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2.2">𝐖</ci><ci id="S3.SS2.p1.10.m10.1.1.2.3.cmml" xref="S3.SS2.p1.10.m10.1.1.2.3">𝑣</ci></apply><ci id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">\mathbf{W}^{v}{G}</annotation></semantics></math>, and <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="\mathbf{W}^{p}{G}" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><mrow id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml"><msup id="S3.SS2.p1.11.m11.1.1.2" xref="S3.SS2.p1.11.m11.1.1.2.cmml"><mi id="S3.SS2.p1.11.m11.1.1.2.2" xref="S3.SS2.p1.11.m11.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.p1.11.m11.1.1.2.3" xref="S3.SS2.p1.11.m11.1.1.2.3.cmml">p</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.11.m11.1.1.1" xref="S3.SS2.p1.11.m11.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.11.m11.1.1.3" xref="S3.SS2.p1.11.m11.1.1.3.cmml">G</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><apply id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1"><times id="S3.SS2.p1.11.m11.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1.1"></times><apply id="S3.SS2.p1.11.m11.1.1.2.cmml" xref="S3.SS2.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.2.1.cmml" xref="S3.SS2.p1.11.m11.1.1.2">superscript</csymbol><ci id="S3.SS2.p1.11.m11.1.1.2.2.cmml" xref="S3.SS2.p1.11.m11.1.1.2.2">𝐖</ci><ci id="S3.SS2.p1.11.m11.1.1.2.3.cmml" xref="S3.SS2.p1.11.m11.1.1.2.3">𝑝</ci></apply><ci id="S3.SS2.p1.11.m11.1.1.3.cmml" xref="S3.SS2.p1.11.m11.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">\mathbf{W}^{p}{G}</annotation></semantics></math> for the global model, respectively.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Now, we can reformulate the equations (6)-(8) for each client <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">i</annotation></semantics></math> as:</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<table id="S3.E13" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E13X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E13X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{Q}_{i}=\mathbf{X}\mathbf{W}^{q}_{i},\qquad\mathbf{K}_{i}" display="inline"><semantics id="S3.E13X.2.1.1.m1.2a"><mrow id="S3.E13X.2.1.1.m1.2.2" xref="S3.E13X.2.1.1.m1.2.2.cmml"><msub id="S3.E13X.2.1.1.m1.2.2.4" xref="S3.E13X.2.1.1.m1.2.2.4.cmml"><mi id="S3.E13X.2.1.1.m1.2.2.4.2" xref="S3.E13X.2.1.1.m1.2.2.4.2.cmml">𝐐</mi><mi id="S3.E13X.2.1.1.m1.2.2.4.3" xref="S3.E13X.2.1.1.m1.2.2.4.3.cmml">i</mi></msub><mo id="S3.E13X.2.1.1.m1.2.2.3" xref="S3.E13X.2.1.1.m1.2.2.3.cmml">=</mo><mrow id="S3.E13X.2.1.1.m1.2.2.2.2" xref="S3.E13X.2.1.1.m1.2.2.2.3.cmml"><msubsup id="S3.E13X.2.1.1.m1.1.1.1.1.1" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.2" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.2.cmml">𝐗𝐖</mi><mi id="S3.E13X.2.1.1.m1.1.1.1.1.1.3" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.cmml">q</mi></msubsup><mo rspace="2.167em" id="S3.E13X.2.1.1.m1.2.2.2.2.3" xref="S3.E13X.2.1.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.E13X.2.1.1.m1.2.2.2.2.2" xref="S3.E13X.2.1.1.m1.2.2.2.2.2.cmml"><mi id="S3.E13X.2.1.1.m1.2.2.2.2.2.2" xref="S3.E13X.2.1.1.m1.2.2.2.2.2.2.cmml">𝐊</mi><mi id="S3.E13X.2.1.1.m1.2.2.2.2.2.3" xref="S3.E13X.2.1.1.m1.2.2.2.2.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13X.2.1.1.m1.2b"><apply id="S3.E13X.2.1.1.m1.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2"><eq id="S3.E13X.2.1.1.m1.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.3"></eq><apply id="S3.E13X.2.1.1.m1.2.2.4.cmml" xref="S3.E13X.2.1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.2.2.4.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.4">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.2.2.4.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.4.2">𝐐</ci><ci id="S3.E13X.2.1.1.m1.2.2.4.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.4.3">𝑖</ci></apply><list id="S3.E13X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2"><apply id="S3.E13X.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.2">𝐗𝐖</ci><ci id="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.2.3">𝑞</ci></apply><ci id="S3.E13X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E13X.2.1.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E13X.2.1.1.m1.2.2.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13X.2.1.1.m1.2.2.2.2.2.1.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E13X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.2.2">𝐊</ci><ci id="S3.E13X.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S3.E13X.2.1.1.m1.2.2.2.2.2.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13X.2.1.1.m1.2c">\displaystyle\mathbf{Q}_{i}=\mathbf{X}\mathbf{W}^{q}_{i},\qquad\mathbf{K}_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E13X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\mathbf{X}\mathbf{W}^{k}_{i},\qquad\mathbf{V}_{i}=\mathbf{X}\mathbf{W}^{v}_{i}" display="inline"><semantics id="S3.E13X.3.2.2.m1.2a"><mrow id="S3.E13X.3.2.2.m1.2.2.2" xref="S3.E13X.3.2.2.m1.2.2.3.cmml"><mrow id="S3.E13X.3.2.2.m1.1.1.1.1" xref="S3.E13X.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E13X.3.2.2.m1.1.1.1.1.2" xref="S3.E13X.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="S3.E13X.3.2.2.m1.1.1.1.1.1" xref="S3.E13X.3.2.2.m1.1.1.1.1.1.cmml">=</mo><msubsup id="S3.E13X.3.2.2.m1.1.1.1.1.3" xref="S3.E13X.3.2.2.m1.1.1.1.1.3.cmml"><mi id="S3.E13X.3.2.2.m1.1.1.1.1.3.2.2" xref="S3.E13X.3.2.2.m1.1.1.1.1.3.2.2.cmml">𝐗𝐖</mi><mi id="S3.E13X.3.2.2.m1.1.1.1.1.3.3" xref="S3.E13X.3.2.2.m1.1.1.1.1.3.3.cmml">i</mi><mi id="S3.E13X.3.2.2.m1.1.1.1.1.3.2.3" xref="S3.E13X.3.2.2.m1.1.1.1.1.3.2.3.cmml">k</mi></msubsup></mrow><mo rspace="2.167em" id="S3.E13X.3.2.2.m1.2.2.2.3" xref="S3.E13X.3.2.2.m1.2.2.3a.cmml">,</mo><mrow id="S3.E13X.3.2.2.m1.2.2.2.2" xref="S3.E13X.3.2.2.m1.2.2.2.2.cmml"><msub id="S3.E13X.3.2.2.m1.2.2.2.2.2" xref="S3.E13X.3.2.2.m1.2.2.2.2.2.cmml"><mi id="S3.E13X.3.2.2.m1.2.2.2.2.2.2" xref="S3.E13X.3.2.2.m1.2.2.2.2.2.2.cmml">𝐕</mi><mi id="S3.E13X.3.2.2.m1.2.2.2.2.2.3" xref="S3.E13X.3.2.2.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E13X.3.2.2.m1.2.2.2.2.1" xref="S3.E13X.3.2.2.m1.2.2.2.2.1.cmml">=</mo><msubsup id="S3.E13X.3.2.2.m1.2.2.2.2.3" xref="S3.E13X.3.2.2.m1.2.2.2.2.3.cmml"><mi id="S3.E13X.3.2.2.m1.2.2.2.2.3.2.2" xref="S3.E13X.3.2.2.m1.2.2.2.2.3.2.2.cmml">𝐗𝐖</mi><mi id="S3.E13X.3.2.2.m1.2.2.2.2.3.3" xref="S3.E13X.3.2.2.m1.2.2.2.2.3.3.cmml">i</mi><mi id="S3.E13X.3.2.2.m1.2.2.2.2.3.2.3" xref="S3.E13X.3.2.2.m1.2.2.2.2.3.2.3.cmml">v</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13X.3.2.2.m1.2b"><apply id="S3.E13X.3.2.2.m1.2.2.3.cmml" xref="S3.E13X.3.2.2.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E13X.3.2.2.m1.2.2.3a.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E13X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E13X.3.2.2.m1.1.1.1.1"><eq id="S3.E13X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E13X.3.2.2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E13X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E13X.3.2.2.m1.1.1.1.1.2">absent</csymbol><apply id="S3.E13X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E13X.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13X.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E13X.3.2.2.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.E13X.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E13X.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13X.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E13X.3.2.2.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E13X.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E13X.3.2.2.m1.1.1.1.1.3.2.2">𝐗𝐖</ci><ci id="S3.E13X.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E13X.3.2.2.m1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E13X.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E13X.3.2.2.m1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E13X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2"><eq id="S3.E13X.3.2.2.m1.2.2.2.2.1.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.1"></eq><apply id="S3.E13X.3.2.2.m1.2.2.2.2.2.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13X.3.2.2.m1.2.2.2.2.2.1.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E13X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.2.2">𝐕</ci><ci id="S3.E13X.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.E13X.3.2.2.m1.2.2.2.2.3.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E13X.3.2.2.m1.2.2.2.2.3.1.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.3">subscript</csymbol><apply id="S3.E13X.3.2.2.m1.2.2.2.2.3.2.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E13X.3.2.2.m1.2.2.2.2.3.2.1.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.3">superscript</csymbol><ci id="S3.E13X.3.2.2.m1.2.2.2.2.3.2.2.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.3.2.2">𝐗𝐖</ci><ci id="S3.E13X.3.2.2.m1.2.2.2.2.3.2.3.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.3.2.3">𝑣</ci></apply><ci id="S3.E13X.3.2.2.m1.2.2.2.2.3.3.cmml" xref="S3.E13X.3.2.2.m1.2.2.2.2.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13X.3.2.2.m1.2c">\displaystyle=\mathbf{X}\mathbf{W}^{k}_{i},\qquad\mathbf{V}_{i}=\mathbf{X}\mathbf{W}^{v}_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(13)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<table id="S3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E14.m1.1" class="ltx_Math" alttext="\mathbf{A}_{i}={\rm Softmax}(\mathbf{Q}_{i}\mathbf{K}_{i}^{\rm T}/\sqrt{d})\mathbf{V}_{i}," display="block"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><msub id="S3.E14.m1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.3.cmml"><mi id="S3.E14.m1.1.1.1.1.3.2" xref="S3.E14.m1.1.1.1.1.3.2.cmml">𝐀</mi><mi id="S3.E14.m1.1.1.1.1.3.3" xref="S3.E14.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E14.m1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E14.m1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.cmml"><mi id="S3.E14.m1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.3.cmml">Softmax</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐐</mi><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.2.cmml">𝐊</mi><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">i</mi><mi mathvariant="normal" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><mo id="S3.E14.m1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml">/</mo><msqrt id="S3.E14.m1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.2.cmml">d</mi></msqrt></mrow><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.2a" xref="S3.E14.m1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E14.m1.1.1.1.1.1.4" xref="S3.E14.m1.1.1.1.1.1.4.cmml"><mi id="S3.E14.m1.1.1.1.1.1.4.2" xref="S3.E14.m1.1.1.1.1.1.4.2.cmml">𝐕</mi><mi id="S3.E14.m1.1.1.1.1.1.4.3" xref="S3.E14.m1.1.1.1.1.1.4.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E14.m1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1"><eq id="S3.E14.m1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.2"></eq><apply id="S3.E14.m1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.1.1.3.2">𝐀</ci><ci id="S3.E14.m1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E14.m1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1"><times id="S3.E14.m1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.2"></times><ci id="S3.E14.m1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.3">Softmax</ci><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1"><divide id="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1"></divide><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2"><times id="S3.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.2">𝐐</ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.2">𝐊</ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3">T</ci></apply></apply><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3"><root id="S3.E14.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3"></root><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.2">𝑑</ci></apply></apply><apply id="S3.E14.m1.1.1.1.1.1.4.cmml" xref="S3.E14.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.4.1.cmml" xref="S3.E14.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.4.2.cmml" xref="S3.E14.m1.1.1.1.1.1.4.2">𝐕</ci><ci id="S3.E14.m1.1.1.1.1.1.4.3.cmml" xref="S3.E14.m1.1.1.1.1.1.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">\mathbf{A}_{i}={\rm Softmax}(\mathbf{Q}_{i}\mathbf{K}_{i}^{\rm T}/\sqrt{d})\mathbf{V}_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<table id="S3.E15" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E15X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E15X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{A^{\prime}}_{i}" display="inline"><semantics id="S3.E15X.2.1.1.m1.1a"><mmultiscripts id="S3.E15X.2.1.1.m1.1.1" xref="S3.E15X.2.1.1.m1.1.1.cmml"><mi id="S3.E15X.2.1.1.m1.1.1.2.2" xref="S3.E15X.2.1.1.m1.1.1.2.2.cmml">𝐀</mi><mrow id="S3.E15X.2.1.1.m1.1.1a" xref="S3.E15X.2.1.1.m1.1.1.cmml"></mrow><mo id="S3.E15X.2.1.1.m1.1.1.2.3" xref="S3.E15X.2.1.1.m1.1.1.2.3.cmml">′</mo><mi id="S3.E15X.2.1.1.m1.1.1.3" xref="S3.E15X.2.1.1.m1.1.1.3.cmml">i</mi><mrow id="S3.E15X.2.1.1.m1.1.1b" xref="S3.E15X.2.1.1.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.E15X.2.1.1.m1.1b"><apply id="S3.E15X.2.1.1.m1.1.1.cmml" xref="S3.E15X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E15X.2.1.1.m1.1.1.1.cmml" xref="S3.E15X.2.1.1.m1.1.1">subscript</csymbol><apply id="S3.E15X.2.1.1.m1.1.1.2.cmml" xref="S3.E15X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E15X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E15X.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E15X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E15X.2.1.1.m1.1.1.2.2">𝐀</ci><ci id="S3.E15X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E15X.2.1.1.m1.1.1.2.3">′</ci></apply><ci id="S3.E15X.2.1.1.m1.1.1.3.cmml" xref="S3.E15X.2.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15X.2.1.1.m1.1c">\displaystyle\mathbf{A^{\prime}}_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E15X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\mathbf{A}_{i}\mathbf{W}^{p}_{i}+\mathbf{X}_{i}," display="inline"><semantics id="S3.E15X.3.2.2.m1.1a"><mrow id="S3.E15X.3.2.2.m1.1.1.1" xref="S3.E15X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E15X.3.2.2.m1.1.1.1.1" xref="S3.E15X.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E15X.3.2.2.m1.1.1.1.1.2" xref="S3.E15X.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="S3.E15X.3.2.2.m1.1.1.1.1.1" xref="S3.E15X.3.2.2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E15X.3.2.2.m1.1.1.1.1.3" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.cmml"><mrow id="S3.E15X.3.2.2.m1.1.1.1.1.3.2" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.cmml"><msub id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2.2" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2.2.cmml">𝐀</mi><mi id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2.3" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.1" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.2.2" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.2.2.cmml">𝐖</mi><mi id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.3" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.3.cmml">i</mi><mi id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.2.3" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.2.3.cmml">p</mi></msubsup></mrow><mo id="S3.E15X.3.2.2.m1.1.1.1.1.3.1" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E15X.3.2.2.m1.1.1.1.1.3.3" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.3.cmml"><mi id="S3.E15X.3.2.2.m1.1.1.1.1.3.3.2" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.3.2.cmml">𝐗</mi><mi id="S3.E15X.3.2.2.m1.1.1.1.1.3.3.3" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E15X.3.2.2.m1.1.1.1.2" xref="S3.E15X.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15X.3.2.2.m1.1b"><apply id="S3.E15X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1"><eq id="S3.E15X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E15X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.2">absent</csymbol><apply id="S3.E15X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3"><plus id="S3.E15X.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.1"></plus><apply id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2"><times id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.1"></times><apply id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2.2">𝐀</ci><ci id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3">subscript</csymbol><apply id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3">superscript</csymbol><ci id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.2.2">𝐖</ci><ci id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.2.3">𝑝</ci></apply><ci id="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.E15X.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E15X.3.2.2.m1.1.1.1.1.3.3.1.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E15X.3.2.2.m1.1.1.1.1.3.3.2.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.3.2">𝐗</ci><ci id="S3.E15X.3.2.2.m1.1.1.1.1.3.3.3.cmml" xref="S3.E15X.3.2.2.m1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15X.3.2.2.m1.1c">\displaystyle=\mathbf{A}_{i}\mathbf{W}^{p}_{i}+\mathbf{X}_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(15)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<table id="S3.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E16.m1.1" class="ltx_Math" alttext="\mathbf{Y}_{i}={\rm MLP}(\mathbf{A^{\prime}}_{i})+\mathbf{A^{\prime}}_{i}," display="block"><semantics id="S3.E16.m1.1a"><mrow id="S3.E16.m1.1.1.1" xref="S3.E16.m1.1.1.1.1.cmml"><mrow id="S3.E16.m1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.cmml"><msub id="S3.E16.m1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.3.cmml"><mi id="S3.E16.m1.1.1.1.1.3.2" xref="S3.E16.m1.1.1.1.1.3.2.cmml">𝐘</mi><mi id="S3.E16.m1.1.1.1.1.3.3" xref="S3.E16.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E16.m1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E16.m1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.cmml"><mrow id="S3.E16.m1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.cmml"><mi id="S3.E16.m1.1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.3.cmml">MLP</mi><mo lspace="0em" rspace="0em" id="S3.E16.m1.1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E16.m1.1.1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E16.m1.1.1.1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mmultiscripts id="S3.E16.m1.1.1.1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐀</mi><mrow id="S3.E16.m1.1.1.1.1.1.1.1.1.1a" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml"></mrow><mo id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo><mi id="S3.E16.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mrow id="S3.E16.m1.1.1.1.1.1.1.1.1.1b" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml"></mrow></mmultiscripts><mo stretchy="false" id="S3.E16.m1.1.1.1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E16.m1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.2.cmml">+</mo><mmultiscripts id="S3.E16.m1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.3.cmml"><mi id="S3.E16.m1.1.1.1.1.1.3.2.2" xref="S3.E16.m1.1.1.1.1.1.3.2.2.cmml">𝐀</mi><mrow id="S3.E16.m1.1.1.1.1.1.3a" xref="S3.E16.m1.1.1.1.1.1.3.cmml"></mrow><mo id="S3.E16.m1.1.1.1.1.1.3.2.3" xref="S3.E16.m1.1.1.1.1.1.3.2.3.cmml">′</mo><mi id="S3.E16.m1.1.1.1.1.1.3.3" xref="S3.E16.m1.1.1.1.1.1.3.3.cmml">i</mi><mrow id="S3.E16.m1.1.1.1.1.1.3b" xref="S3.E16.m1.1.1.1.1.1.3.cmml"></mrow></mmultiscripts></mrow></mrow><mo id="S3.E16.m1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.1b"><apply id="S3.E16.m1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1"><eq id="S3.E16.m1.1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.1.2"></eq><apply id="S3.E16.m1.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.3.1.cmml" xref="S3.E16.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E16.m1.1.1.1.1.3.2.cmml" xref="S3.E16.m1.1.1.1.1.3.2">𝐘</ci><ci id="S3.E16.m1.1.1.1.1.3.3.cmml" xref="S3.E16.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E16.m1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1"><plus id="S3.E16.m1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.1.1.2"></plus><apply id="S3.E16.m1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1"><times id="S3.E16.m1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.2"></times><ci id="S3.E16.m1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.3">MLP</ci><apply id="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2">𝐀</ci><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E16.m1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.1.3.1.cmml" xref="S3.E16.m1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E16.m1.1.1.1.1.1.3.2.cmml" xref="S3.E16.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E16.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E16.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E16.m1.1.1.1.1.1.3.2.2">𝐀</ci><ci id="S3.E16.m1.1.1.1.1.1.3.2.3.cmml" xref="S3.E16.m1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E16.m1.1.1.1.1.1.3.3.cmml" xref="S3.E16.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.1c">\mathbf{Y}_{i}={\rm MLP}(\mathbf{A^{\prime}}_{i})+\mathbf{A^{\prime}}_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<p id="S3.SS2.p7.2" class="ltx_p">where <math id="S3.SS2.p7.1.m1.1" class="ltx_Math" alttext="\mathbf{Y}_{i}" display="inline"><semantics id="S3.SS2.p7.1.m1.1a"><msub id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml"><mi id="S3.SS2.p7.1.m1.1.1.2" xref="S3.SS2.p7.1.m1.1.1.2.cmml">𝐘</mi><mi id="S3.SS2.p7.1.m1.1.1.3" xref="S3.SS2.p7.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><apply id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p7.1.m1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.1.1.2">𝐘</ci><ci id="S3.SS2.p7.1.m1.1.1.3.cmml" xref="S3.SS2.p7.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">\mathbf{Y}_{i}</annotation></semantics></math> denotes the output of a transformer block for the local model <math id="S3.SS2.p7.2.m2.1" class="ltx_Math" alttext="M_{i}" display="inline"><semantics id="S3.SS2.p7.2.m2.1a"><msub id="S3.SS2.p7.2.m2.1.1" xref="S3.SS2.p7.2.m2.1.1.cmml"><mi id="S3.SS2.p7.2.m2.1.1.2" xref="S3.SS2.p7.2.m2.1.1.2.cmml">M</mi><mi id="S3.SS2.p7.2.m2.1.1.3" xref="S3.SS2.p7.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b"><apply id="S3.SS2.p7.2.m2.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.2.m2.1.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p7.2.m2.1.1.2.cmml" xref="S3.SS2.p7.2.m2.1.1.2">𝑀</ci><ci id="S3.SS2.p7.2.m2.1.1.3.cmml" xref="S3.SS2.p7.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">M_{i}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p8" class="ltx_para">
<p id="S3.SS2.p8.1" class="ltx_p">With the MHEA method, we aim to minimize the difference between each local model encoder’s weights and the global model encoder’s weights. To do this, we calculate the L2 difference between each local layer’s weights and the corresponding global layer’s weights.</p>
</div>
<div id="S3.SS2.p9" class="ltx_para">
<p id="S3.SS2.p9.6" class="ltx_p">Let’s denote the L2 difference between the local and global layers as <math id="S3.SS2.p9.1.m1.1" class="ltx_Math" alttext="L_{i}^{k}" display="inline"><semantics id="S3.SS2.p9.1.m1.1a"><msubsup id="S3.SS2.p9.1.m1.1.1" xref="S3.SS2.p9.1.m1.1.1.cmml"><mi id="S3.SS2.p9.1.m1.1.1.2.2" xref="S3.SS2.p9.1.m1.1.1.2.2.cmml">L</mi><mi id="S3.SS2.p9.1.m1.1.1.2.3" xref="S3.SS2.p9.1.m1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p9.1.m1.1.1.3" xref="S3.SS2.p9.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.1.m1.1b"><apply id="S3.SS2.p9.1.m1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.1.m1.1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1">superscript</csymbol><apply id="S3.SS2.p9.1.m1.1.1.2.cmml" xref="S3.SS2.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.1.m1.1.1.2.1.cmml" xref="S3.SS2.p9.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p9.1.m1.1.1.2.2.cmml" xref="S3.SS2.p9.1.m1.1.1.2.2">𝐿</ci><ci id="S3.SS2.p9.1.m1.1.1.2.3.cmml" xref="S3.SS2.p9.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p9.1.m1.1.1.3.cmml" xref="S3.SS2.p9.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.1.m1.1c">L_{i}^{k}</annotation></semantics></math> for client <math id="S3.SS2.p9.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p9.2.m2.1a"><mi id="S3.SS2.p9.2.m2.1.1" xref="S3.SS2.p9.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.2.m2.1b"><ci id="S3.SS2.p9.2.m2.1.1.cmml" xref="S3.SS2.p9.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.2.m2.1c">k</annotation></semantics></math> and layer <math id="S3.SS2.p9.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p9.3.m3.1a"><mi id="S3.SS2.p9.3.m3.1.1" xref="S3.SS2.p9.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.3.m3.1b"><ci id="S3.SS2.p9.3.m3.1.1.cmml" xref="S3.SS2.p9.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.3.m3.1c">i</annotation></semantics></math>. For the <math id="S3.SS2.p9.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS2.p9.4.m4.1a"><mi id="S3.SS2.p9.4.m4.1.1" xref="S3.SS2.p9.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.4.m4.1b"><ci id="S3.SS2.p9.4.m4.1.1.cmml" xref="S3.SS2.p9.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.4.m4.1c">Q</annotation></semantics></math>, <math id="S3.SS2.p9.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p9.5.m5.1a"><mi id="S3.SS2.p9.5.m5.1.1" xref="S3.SS2.p9.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.5.m5.1b"><ci id="S3.SS2.p9.5.m5.1.1.cmml" xref="S3.SS2.p9.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.5.m5.1c">K</annotation></semantics></math>, and <math id="S3.SS2.p9.6.m6.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS2.p9.6.m6.1a"><mi id="S3.SS2.p9.6.m6.1.1" xref="S3.SS2.p9.6.m6.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.6.m6.1b"><ci id="S3.SS2.p9.6.m6.1.1.cmml" xref="S3.SS2.p9.6.m6.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.6.m6.1c">V</annotation></semantics></math> weight matrices, we compute the L2 difference as follows:</p>
</div>
<div id="S3.SS2.p10" class="ltx_para">
<table id="S3.E17" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E17X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E17X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle L_{i,Q}^{k}" display="inline"><semantics id="S3.E17X.2.1.1.m1.2a"><msubsup id="S3.E17X.2.1.1.m1.2.3" xref="S3.E17X.2.1.1.m1.2.3.cmml"><mi id="S3.E17X.2.1.1.m1.2.3.2.2" xref="S3.E17X.2.1.1.m1.2.3.2.2.cmml">L</mi><mrow id="S3.E17X.2.1.1.m1.2.2.2.4" xref="S3.E17X.2.1.1.m1.2.2.2.3.cmml"><mi id="S3.E17X.2.1.1.m1.1.1.1.1" xref="S3.E17X.2.1.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.E17X.2.1.1.m1.2.2.2.4.1" xref="S3.E17X.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E17X.2.1.1.m1.2.2.2.2" xref="S3.E17X.2.1.1.m1.2.2.2.2.cmml">Q</mi></mrow><mi id="S3.E17X.2.1.1.m1.2.3.3" xref="S3.E17X.2.1.1.m1.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E17X.2.1.1.m1.2b"><apply id="S3.E17X.2.1.1.m1.2.3.cmml" xref="S3.E17X.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="S3.E17X.2.1.1.m1.2.3.1.cmml" xref="S3.E17X.2.1.1.m1.2.3">superscript</csymbol><apply id="S3.E17X.2.1.1.m1.2.3.2.cmml" xref="S3.E17X.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="S3.E17X.2.1.1.m1.2.3.2.1.cmml" xref="S3.E17X.2.1.1.m1.2.3">subscript</csymbol><ci id="S3.E17X.2.1.1.m1.2.3.2.2.cmml" xref="S3.E17X.2.1.1.m1.2.3.2.2">𝐿</ci><list id="S3.E17X.2.1.1.m1.2.2.2.3.cmml" xref="S3.E17X.2.1.1.m1.2.2.2.4"><ci id="S3.E17X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E17X.2.1.1.m1.1.1.1.1">𝑖</ci><ci id="S3.E17X.2.1.1.m1.2.2.2.2.cmml" xref="S3.E17X.2.1.1.m1.2.2.2.2">𝑄</ci></list></apply><ci id="S3.E17X.2.1.1.m1.2.3.3.cmml" xref="S3.E17X.2.1.1.m1.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17X.2.1.1.m1.2c">\displaystyle L_{i,Q}^{k}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E17X.3.2.2.m1.7" class="ltx_Math" alttext="\displaystyle=|\mathbf{W}^{q,k}_{i}-\mathbf{W}^{q,G}_{i}|^{2},L{i,K}^{k}" display="inline"><semantics id="S3.E17X.3.2.2.m1.7a"><mrow id="S3.E17X.3.2.2.m1.7.7" xref="S3.E17X.3.2.2.m1.7.7.cmml"><mi id="S3.E17X.3.2.2.m1.7.7.5" xref="S3.E17X.3.2.2.m1.7.7.5.cmml"></mi><mo id="S3.E17X.3.2.2.m1.7.7.4" xref="S3.E17X.3.2.2.m1.7.7.4.cmml">=</mo><mrow id="S3.E17X.3.2.2.m1.7.7.3.3" xref="S3.E17X.3.2.2.m1.7.7.3.4.cmml"><msup id="S3.E17X.3.2.2.m1.5.5.1.1.1" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.cmml"><mrow id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.2" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml"><msubsup id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E17X.3.2.2.m1.2.2.2.4" xref="S3.E17X.3.2.2.m1.2.2.2.3.cmml"><mi id="S3.E17X.3.2.2.m1.1.1.1.1" xref="S3.E17X.3.2.2.m1.1.1.1.1.cmml">q</mi><mo id="S3.E17X.3.2.2.m1.2.2.2.4.1" xref="S3.E17X.3.2.2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E17X.3.2.2.m1.2.2.2.2" xref="S3.E17X.3.2.2.m1.2.2.2.2.cmml">k</mi></mrow></msubsup><mo id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.1" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.3.cmml">i</mi><mrow id="S3.E17X.3.2.2.m1.4.4.2.4" xref="S3.E17X.3.2.2.m1.4.4.2.3.cmml"><mi id="S3.E17X.3.2.2.m1.3.3.1.1" xref="S3.E17X.3.2.2.m1.3.3.1.1.cmml">q</mi><mo id="S3.E17X.3.2.2.m1.4.4.2.4.1" xref="S3.E17X.3.2.2.m1.4.4.2.3.cmml">,</mo><mi id="S3.E17X.3.2.2.m1.4.4.2.2" xref="S3.E17X.3.2.2.m1.4.4.2.2.cmml">G</mi></mrow></msubsup></mrow><mo stretchy="false" id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.3" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S3.E17X.3.2.2.m1.5.5.1.1.1.3" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.3.cmml">2</mn></msup><mo id="S3.E17X.3.2.2.m1.7.7.3.3.4" xref="S3.E17X.3.2.2.m1.7.7.3.4.cmml">,</mo><mrow id="S3.E17X.3.2.2.m1.6.6.2.2.2" xref="S3.E17X.3.2.2.m1.6.6.2.2.2.cmml"><mi id="S3.E17X.3.2.2.m1.6.6.2.2.2.2" xref="S3.E17X.3.2.2.m1.6.6.2.2.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E17X.3.2.2.m1.6.6.2.2.2.1" xref="S3.E17X.3.2.2.m1.6.6.2.2.2.1.cmml">​</mo><mi id="S3.E17X.3.2.2.m1.6.6.2.2.2.3" xref="S3.E17X.3.2.2.m1.6.6.2.2.2.3.cmml">i</mi></mrow><mo id="S3.E17X.3.2.2.m1.7.7.3.3.5" xref="S3.E17X.3.2.2.m1.7.7.3.4.cmml">,</mo><msup id="S3.E17X.3.2.2.m1.7.7.3.3.3" xref="S3.E17X.3.2.2.m1.7.7.3.3.3.cmml"><mi id="S3.E17X.3.2.2.m1.7.7.3.3.3.2" xref="S3.E17X.3.2.2.m1.7.7.3.3.3.2.cmml">K</mi><mi id="S3.E17X.3.2.2.m1.7.7.3.3.3.3" xref="S3.E17X.3.2.2.m1.7.7.3.3.3.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E17X.3.2.2.m1.7b"><apply id="S3.E17X.3.2.2.m1.7.7.cmml" xref="S3.E17X.3.2.2.m1.7.7"><eq id="S3.E17X.3.2.2.m1.7.7.4.cmml" xref="S3.E17X.3.2.2.m1.7.7.4"></eq><csymbol cd="latexml" id="S3.E17X.3.2.2.m1.7.7.5.cmml" xref="S3.E17X.3.2.2.m1.7.7.5">absent</csymbol><list id="S3.E17X.3.2.2.m1.7.7.3.4.cmml" xref="S3.E17X.3.2.2.m1.7.7.3.3"><apply id="S3.E17X.3.2.2.m1.5.5.1.1.1.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E17X.3.2.2.m1.5.5.1.1.1.2.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1">superscript</csymbol><apply id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1"><abs id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.2"></abs><apply id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1"><minus id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.1"></minus><apply id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.2.2">𝐖</ci><list id="S3.E17X.3.2.2.m1.2.2.2.3.cmml" xref="S3.E17X.3.2.2.m1.2.2.2.4"><ci id="S3.E17X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E17X.3.2.2.m1.1.1.1.1">𝑞</ci><ci id="S3.E17X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E17X.3.2.2.m1.2.2.2.2">𝑘</ci></list></apply><ci id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.2.2">𝐖</ci><list id="S3.E17X.3.2.2.m1.4.4.2.3.cmml" xref="S3.E17X.3.2.2.m1.4.4.2.4"><ci id="S3.E17X.3.2.2.m1.3.3.1.1.cmml" xref="S3.E17X.3.2.2.m1.3.3.1.1">𝑞</ci><ci id="S3.E17X.3.2.2.m1.4.4.2.2.cmml" xref="S3.E17X.3.2.2.m1.4.4.2.2">𝐺</ci></list></apply><ci id="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.E17X.3.2.2.m1.5.5.1.1.1.3.cmml" xref="S3.E17X.3.2.2.m1.5.5.1.1.1.3">2</cn></apply><apply id="S3.E17X.3.2.2.m1.6.6.2.2.2.cmml" xref="S3.E17X.3.2.2.m1.6.6.2.2.2"><times id="S3.E17X.3.2.2.m1.6.6.2.2.2.1.cmml" xref="S3.E17X.3.2.2.m1.6.6.2.2.2.1"></times><ci id="S3.E17X.3.2.2.m1.6.6.2.2.2.2.cmml" xref="S3.E17X.3.2.2.m1.6.6.2.2.2.2">𝐿</ci><ci id="S3.E17X.3.2.2.m1.6.6.2.2.2.3.cmml" xref="S3.E17X.3.2.2.m1.6.6.2.2.2.3">𝑖</ci></apply><apply id="S3.E17X.3.2.2.m1.7.7.3.3.3.cmml" xref="S3.E17X.3.2.2.m1.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.E17X.3.2.2.m1.7.7.3.3.3.1.cmml" xref="S3.E17X.3.2.2.m1.7.7.3.3.3">superscript</csymbol><ci id="S3.E17X.3.2.2.m1.7.7.3.3.3.2.cmml" xref="S3.E17X.3.2.2.m1.7.7.3.3.3.2">𝐾</ci><ci id="S3.E17X.3.2.2.m1.7.7.3.3.3.3.cmml" xref="S3.E17X.3.2.2.m1.7.7.3.3.3.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17X.3.2.2.m1.7c">\displaystyle=|\mathbf{W}^{q,k}_{i}-\mathbf{W}^{q,G}_{i}|^{2},L{i,K}^{k}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E17X.5.1.1.m1.7" class="ltx_Math" alttext="\displaystyle=|\mathbf{W}^{k,k}_{i}-\mathbf{W}^{k,G}_{i}|^{2},L{i,V}^{k}" display="inline"><semantics id="S3.E17X.5.1.1.m1.7a"><mrow id="S3.E17X.5.1.1.m1.7.7" xref="S3.E17X.5.1.1.m1.7.7.cmml"><mi id="S3.E17X.5.1.1.m1.7.7.5" xref="S3.E17X.5.1.1.m1.7.7.5.cmml"></mi><mo id="S3.E17X.5.1.1.m1.7.7.4" xref="S3.E17X.5.1.1.m1.7.7.4.cmml">=</mo><mrow id="S3.E17X.5.1.1.m1.7.7.3.3" xref="S3.E17X.5.1.1.m1.7.7.3.4.cmml"><msup id="S3.E17X.5.1.1.m1.5.5.1.1.1" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.cmml"><mrow id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.2" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.cmml"><msubsup id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E17X.5.1.1.m1.2.2.2.4" xref="S3.E17X.5.1.1.m1.2.2.2.3.cmml"><mi id="S3.E17X.5.1.1.m1.1.1.1.1" xref="S3.E17X.5.1.1.m1.1.1.1.1.cmml">k</mi><mo id="S3.E17X.5.1.1.m1.2.2.2.4.1" xref="S3.E17X.5.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E17X.5.1.1.m1.2.2.2.2" xref="S3.E17X.5.1.1.m1.2.2.2.2.cmml">k</mi></mrow></msubsup><mo id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.1" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.3.cmml">i</mi><mrow id="S3.E17X.5.1.1.m1.4.4.2.4" xref="S3.E17X.5.1.1.m1.4.4.2.3.cmml"><mi id="S3.E17X.5.1.1.m1.3.3.1.1" xref="S3.E17X.5.1.1.m1.3.3.1.1.cmml">k</mi><mo id="S3.E17X.5.1.1.m1.4.4.2.4.1" xref="S3.E17X.5.1.1.m1.4.4.2.3.cmml">,</mo><mi id="S3.E17X.5.1.1.m1.4.4.2.2" xref="S3.E17X.5.1.1.m1.4.4.2.2.cmml">G</mi></mrow></msubsup></mrow><mo stretchy="false" id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.3" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S3.E17X.5.1.1.m1.5.5.1.1.1.3" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.3.cmml">2</mn></msup><mo id="S3.E17X.5.1.1.m1.7.7.3.3.4" xref="S3.E17X.5.1.1.m1.7.7.3.4.cmml">,</mo><mrow id="S3.E17X.5.1.1.m1.6.6.2.2.2" xref="S3.E17X.5.1.1.m1.6.6.2.2.2.cmml"><mi id="S3.E17X.5.1.1.m1.6.6.2.2.2.2" xref="S3.E17X.5.1.1.m1.6.6.2.2.2.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E17X.5.1.1.m1.6.6.2.2.2.1" xref="S3.E17X.5.1.1.m1.6.6.2.2.2.1.cmml">​</mo><mi id="S3.E17X.5.1.1.m1.6.6.2.2.2.3" xref="S3.E17X.5.1.1.m1.6.6.2.2.2.3.cmml">i</mi></mrow><mo id="S3.E17X.5.1.1.m1.7.7.3.3.5" xref="S3.E17X.5.1.1.m1.7.7.3.4.cmml">,</mo><msup id="S3.E17X.5.1.1.m1.7.7.3.3.3" xref="S3.E17X.5.1.1.m1.7.7.3.3.3.cmml"><mi id="S3.E17X.5.1.1.m1.7.7.3.3.3.2" xref="S3.E17X.5.1.1.m1.7.7.3.3.3.2.cmml">V</mi><mi id="S3.E17X.5.1.1.m1.7.7.3.3.3.3" xref="S3.E17X.5.1.1.m1.7.7.3.3.3.3.cmml">k</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E17X.5.1.1.m1.7b"><apply id="S3.E17X.5.1.1.m1.7.7.cmml" xref="S3.E17X.5.1.1.m1.7.7"><eq id="S3.E17X.5.1.1.m1.7.7.4.cmml" xref="S3.E17X.5.1.1.m1.7.7.4"></eq><csymbol cd="latexml" id="S3.E17X.5.1.1.m1.7.7.5.cmml" xref="S3.E17X.5.1.1.m1.7.7.5">absent</csymbol><list id="S3.E17X.5.1.1.m1.7.7.3.4.cmml" xref="S3.E17X.5.1.1.m1.7.7.3.3"><apply id="S3.E17X.5.1.1.m1.5.5.1.1.1.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E17X.5.1.1.m1.5.5.1.1.1.2.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1">superscript</csymbol><apply id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.2.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1"><abs id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.2"></abs><apply id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1"><minus id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.1"></minus><apply id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.2.2">𝐖</ci><list id="S3.E17X.5.1.1.m1.2.2.2.3.cmml" xref="S3.E17X.5.1.1.m1.2.2.2.4"><ci id="S3.E17X.5.1.1.m1.1.1.1.1.cmml" xref="S3.E17X.5.1.1.m1.1.1.1.1">𝑘</ci><ci id="S3.E17X.5.1.1.m1.2.2.2.2.cmml" xref="S3.E17X.5.1.1.m1.2.2.2.2">𝑘</ci></list></apply><ci id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.2.2">𝐖</ci><list id="S3.E17X.5.1.1.m1.4.4.2.3.cmml" xref="S3.E17X.5.1.1.m1.4.4.2.4"><ci id="S3.E17X.5.1.1.m1.3.3.1.1.cmml" xref="S3.E17X.5.1.1.m1.3.3.1.1">𝑘</ci><ci id="S3.E17X.5.1.1.m1.4.4.2.2.cmml" xref="S3.E17X.5.1.1.m1.4.4.2.2">𝐺</ci></list></apply><ci id="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.E17X.5.1.1.m1.5.5.1.1.1.3.cmml" xref="S3.E17X.5.1.1.m1.5.5.1.1.1.3">2</cn></apply><apply id="S3.E17X.5.1.1.m1.6.6.2.2.2.cmml" xref="S3.E17X.5.1.1.m1.6.6.2.2.2"><times id="S3.E17X.5.1.1.m1.6.6.2.2.2.1.cmml" xref="S3.E17X.5.1.1.m1.6.6.2.2.2.1"></times><ci id="S3.E17X.5.1.1.m1.6.6.2.2.2.2.cmml" xref="S3.E17X.5.1.1.m1.6.6.2.2.2.2">𝐿</ci><ci id="S3.E17X.5.1.1.m1.6.6.2.2.2.3.cmml" xref="S3.E17X.5.1.1.m1.6.6.2.2.2.3">𝑖</ci></apply><apply id="S3.E17X.5.1.1.m1.7.7.3.3.3.cmml" xref="S3.E17X.5.1.1.m1.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.E17X.5.1.1.m1.7.7.3.3.3.1.cmml" xref="S3.E17X.5.1.1.m1.7.7.3.3.3">superscript</csymbol><ci id="S3.E17X.5.1.1.m1.7.7.3.3.3.2.cmml" xref="S3.E17X.5.1.1.m1.7.7.3.3.3.2">𝑉</ci><ci id="S3.E17X.5.1.1.m1.7.7.3.3.3.3.cmml" xref="S3.E17X.5.1.1.m1.7.7.3.3.3.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17X.5.1.1.m1.7c">\displaystyle=|\mathbf{W}^{k,k}_{i}-\mathbf{W}^{k,G}_{i}|^{2},L{i,V}^{k}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E17X.6.2.2.m1.5" class="ltx_Math" alttext="\displaystyle=|\mathbf{W}^{v,k}_{i}-\mathbf{W}^{v,G}_{i}|^{2}," display="inline"><semantics id="S3.E17X.6.2.2.m1.5a"><mrow id="S3.E17X.6.2.2.m1.5.5.1" xref="S3.E17X.6.2.2.m1.5.5.1.1.cmml"><mrow id="S3.E17X.6.2.2.m1.5.5.1.1" xref="S3.E17X.6.2.2.m1.5.5.1.1.cmml"><mi id="S3.E17X.6.2.2.m1.5.5.1.1.3" xref="S3.E17X.6.2.2.m1.5.5.1.1.3.cmml"></mi><mo id="S3.E17X.6.2.2.m1.5.5.1.1.2" xref="S3.E17X.6.2.2.m1.5.5.1.1.2.cmml">=</mo><msup id="S3.E17X.6.2.2.m1.5.5.1.1.1" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.cmml"><mrow id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.2" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.cmml"><msubsup id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E17X.6.2.2.m1.2.2.2.4" xref="S3.E17X.6.2.2.m1.2.2.2.3.cmml"><mi id="S3.E17X.6.2.2.m1.1.1.1.1" xref="S3.E17X.6.2.2.m1.1.1.1.1.cmml">v</mi><mo id="S3.E17X.6.2.2.m1.2.2.2.4.1" xref="S3.E17X.6.2.2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E17X.6.2.2.m1.2.2.2.2" xref="S3.E17X.6.2.2.m1.2.2.2.2.cmml">k</mi></mrow></msubsup><mo id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.1" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.3.cmml">i</mi><mrow id="S3.E17X.6.2.2.m1.4.4.2.4" xref="S3.E17X.6.2.2.m1.4.4.2.3.cmml"><mi id="S3.E17X.6.2.2.m1.3.3.1.1" xref="S3.E17X.6.2.2.m1.3.3.1.1.cmml">v</mi><mo id="S3.E17X.6.2.2.m1.4.4.2.4.1" xref="S3.E17X.6.2.2.m1.4.4.2.3.cmml">,</mo><mi id="S3.E17X.6.2.2.m1.4.4.2.2" xref="S3.E17X.6.2.2.m1.4.4.2.2.cmml">G</mi></mrow></msubsup></mrow><mo stretchy="false" id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.3" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S3.E17X.6.2.2.m1.5.5.1.1.1.3" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.3.cmml">2</mn></msup></mrow><mo id="S3.E17X.6.2.2.m1.5.5.1.2" xref="S3.E17X.6.2.2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E17X.6.2.2.m1.5b"><apply id="S3.E17X.6.2.2.m1.5.5.1.1.cmml" xref="S3.E17X.6.2.2.m1.5.5.1"><eq id="S3.E17X.6.2.2.m1.5.5.1.1.2.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.2"></eq><csymbol cd="latexml" id="S3.E17X.6.2.2.m1.5.5.1.1.3.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.3">absent</csymbol><apply id="S3.E17X.6.2.2.m1.5.5.1.1.1.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E17X.6.2.2.m1.5.5.1.1.1.2.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1">superscript</csymbol><apply id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1"><abs id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.2"></abs><apply id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1"><minus id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.1"></minus><apply id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.2.2">𝐖</ci><list id="S3.E17X.6.2.2.m1.2.2.2.3.cmml" xref="S3.E17X.6.2.2.m1.2.2.2.4"><ci id="S3.E17X.6.2.2.m1.1.1.1.1.cmml" xref="S3.E17X.6.2.2.m1.1.1.1.1">𝑣</ci><ci id="S3.E17X.6.2.2.m1.2.2.2.2.cmml" xref="S3.E17X.6.2.2.m1.2.2.2.2">𝑘</ci></list></apply><ci id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.2.2">𝐖</ci><list id="S3.E17X.6.2.2.m1.4.4.2.3.cmml" xref="S3.E17X.6.2.2.m1.4.4.2.4"><ci id="S3.E17X.6.2.2.m1.3.3.1.1.cmml" xref="S3.E17X.6.2.2.m1.3.3.1.1">𝑣</ci><ci id="S3.E17X.6.2.2.m1.4.4.2.2.cmml" xref="S3.E17X.6.2.2.m1.4.4.2.2">𝐺</ci></list></apply><ci id="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.E17X.6.2.2.m1.5.5.1.1.1.3.cmml" xref="S3.E17X.6.2.2.m1.5.5.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17X.6.2.2.m1.5c">\displaystyle=|\mathbf{W}^{v,k}_{i}-\mathbf{W}^{v,G}_{i}|^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(17)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.p11" class="ltx_para">
<p id="S3.SS2.p11.3" class="ltx_p">For the MLP layers, let’s denote the weight matrices as <math id="S3.SS2.p11.1.m1.2" class="ltx_Math" alttext="\mathbf{W}^{MLP,k}_{i}" display="inline"><semantics id="S3.SS2.p11.1.m1.2a"><msubsup id="S3.SS2.p11.1.m1.2.3" xref="S3.SS2.p11.1.m1.2.3.cmml"><mi id="S3.SS2.p11.1.m1.2.3.2.2" xref="S3.SS2.p11.1.m1.2.3.2.2.cmml">𝐖</mi><mi id="S3.SS2.p11.1.m1.2.3.3" xref="S3.SS2.p11.1.m1.2.3.3.cmml">i</mi><mrow id="S3.SS2.p11.1.m1.2.2.2.2" xref="S3.SS2.p11.1.m1.2.2.2.3.cmml"><mrow id="S3.SS2.p11.1.m1.2.2.2.2.1" xref="S3.SS2.p11.1.m1.2.2.2.2.1.cmml"><mi id="S3.SS2.p11.1.m1.2.2.2.2.1.2" xref="S3.SS2.p11.1.m1.2.2.2.2.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p11.1.m1.2.2.2.2.1.1" xref="S3.SS2.p11.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS2.p11.1.m1.2.2.2.2.1.3" xref="S3.SS2.p11.1.m1.2.2.2.2.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p11.1.m1.2.2.2.2.1.1a" xref="S3.SS2.p11.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS2.p11.1.m1.2.2.2.2.1.4" xref="S3.SS2.p11.1.m1.2.2.2.2.1.4.cmml">P</mi></mrow><mo id="S3.SS2.p11.1.m1.2.2.2.2.2" xref="S3.SS2.p11.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p11.1.m1.1.1.1.1" xref="S3.SS2.p11.1.m1.1.1.1.1.cmml">k</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.1.m1.2b"><apply id="S3.SS2.p11.1.m1.2.3.cmml" xref="S3.SS2.p11.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p11.1.m1.2.3.1.cmml" xref="S3.SS2.p11.1.m1.2.3">subscript</csymbol><apply id="S3.SS2.p11.1.m1.2.3.2.cmml" xref="S3.SS2.p11.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p11.1.m1.2.3.2.1.cmml" xref="S3.SS2.p11.1.m1.2.3">superscript</csymbol><ci id="S3.SS2.p11.1.m1.2.3.2.2.cmml" xref="S3.SS2.p11.1.m1.2.3.2.2">𝐖</ci><list id="S3.SS2.p11.1.m1.2.2.2.3.cmml" xref="S3.SS2.p11.1.m1.2.2.2.2"><apply id="S3.SS2.p11.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.p11.1.m1.2.2.2.2.1"><times id="S3.SS2.p11.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS2.p11.1.m1.2.2.2.2.1.1"></times><ci id="S3.SS2.p11.1.m1.2.2.2.2.1.2.cmml" xref="S3.SS2.p11.1.m1.2.2.2.2.1.2">𝑀</ci><ci id="S3.SS2.p11.1.m1.2.2.2.2.1.3.cmml" xref="S3.SS2.p11.1.m1.2.2.2.2.1.3">𝐿</ci><ci id="S3.SS2.p11.1.m1.2.2.2.2.1.4.cmml" xref="S3.SS2.p11.1.m1.2.2.2.2.1.4">𝑃</ci></apply><ci id="S3.SS2.p11.1.m1.1.1.1.1.cmml" xref="S3.SS2.p11.1.m1.1.1.1.1">𝑘</ci></list></apply><ci id="S3.SS2.p11.1.m1.2.3.3.cmml" xref="S3.SS2.p11.1.m1.2.3.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.1.m1.2c">\mathbf{W}^{MLP,k}_{i}</annotation></semantics></math> for client <math id="S3.SS2.p11.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p11.2.m2.1a"><mi id="S3.SS2.p11.2.m2.1.1" xref="S3.SS2.p11.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.2.m2.1b"><ci id="S3.SS2.p11.2.m2.1.1.cmml" xref="S3.SS2.p11.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.2.m2.1c">k</annotation></semantics></math> and <math id="S3.SS2.p11.3.m3.2" class="ltx_Math" alttext="\mathbf{W}^{MLP,G}_{i}" display="inline"><semantics id="S3.SS2.p11.3.m3.2a"><msubsup id="S3.SS2.p11.3.m3.2.3" xref="S3.SS2.p11.3.m3.2.3.cmml"><mi id="S3.SS2.p11.3.m3.2.3.2.2" xref="S3.SS2.p11.3.m3.2.3.2.2.cmml">𝐖</mi><mi id="S3.SS2.p11.3.m3.2.3.3" xref="S3.SS2.p11.3.m3.2.3.3.cmml">i</mi><mrow id="S3.SS2.p11.3.m3.2.2.2.2" xref="S3.SS2.p11.3.m3.2.2.2.3.cmml"><mrow id="S3.SS2.p11.3.m3.2.2.2.2.1" xref="S3.SS2.p11.3.m3.2.2.2.2.1.cmml"><mi id="S3.SS2.p11.3.m3.2.2.2.2.1.2" xref="S3.SS2.p11.3.m3.2.2.2.2.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p11.3.m3.2.2.2.2.1.1" xref="S3.SS2.p11.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS2.p11.3.m3.2.2.2.2.1.3" xref="S3.SS2.p11.3.m3.2.2.2.2.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p11.3.m3.2.2.2.2.1.1a" xref="S3.SS2.p11.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS2.p11.3.m3.2.2.2.2.1.4" xref="S3.SS2.p11.3.m3.2.2.2.2.1.4.cmml">P</mi></mrow><mo id="S3.SS2.p11.3.m3.2.2.2.2.2" xref="S3.SS2.p11.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p11.3.m3.1.1.1.1" xref="S3.SS2.p11.3.m3.1.1.1.1.cmml">G</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p11.3.m3.2b"><apply id="S3.SS2.p11.3.m3.2.3.cmml" xref="S3.SS2.p11.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p11.3.m3.2.3.1.cmml" xref="S3.SS2.p11.3.m3.2.3">subscript</csymbol><apply id="S3.SS2.p11.3.m3.2.3.2.cmml" xref="S3.SS2.p11.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p11.3.m3.2.3.2.1.cmml" xref="S3.SS2.p11.3.m3.2.3">superscript</csymbol><ci id="S3.SS2.p11.3.m3.2.3.2.2.cmml" xref="S3.SS2.p11.3.m3.2.3.2.2">𝐖</ci><list id="S3.SS2.p11.3.m3.2.2.2.3.cmml" xref="S3.SS2.p11.3.m3.2.2.2.2"><apply id="S3.SS2.p11.3.m3.2.2.2.2.1.cmml" xref="S3.SS2.p11.3.m3.2.2.2.2.1"><times id="S3.SS2.p11.3.m3.2.2.2.2.1.1.cmml" xref="S3.SS2.p11.3.m3.2.2.2.2.1.1"></times><ci id="S3.SS2.p11.3.m3.2.2.2.2.1.2.cmml" xref="S3.SS2.p11.3.m3.2.2.2.2.1.2">𝑀</ci><ci id="S3.SS2.p11.3.m3.2.2.2.2.1.3.cmml" xref="S3.SS2.p11.3.m3.2.2.2.2.1.3">𝐿</ci><ci id="S3.SS2.p11.3.m3.2.2.2.2.1.4.cmml" xref="S3.SS2.p11.3.m3.2.2.2.2.1.4">𝑃</ci></apply><ci id="S3.SS2.p11.3.m3.1.1.1.1.cmml" xref="S3.SS2.p11.3.m3.1.1.1.1">𝐺</ci></list></apply><ci id="S3.SS2.p11.3.m3.2.3.3.cmml" xref="S3.SS2.p11.3.m3.2.3.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p11.3.m3.2c">\mathbf{W}^{MLP,G}_{i}</annotation></semantics></math> for the global model. We compute the L2 difference for the MLP layers as follows:</p>
</div>
<div id="S3.SS2.p12" class="ltx_para">
<table id="S3.E18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E18.m1.7" class="ltx_Math" alttext="L_{i,MLP}^{k}=|\mathbf{W}^{MLP,k}_{i}-\mathbf{W}^{MLP,G}_{i}|^{2}" display="block"><semantics id="S3.E18.m1.7a"><mrow id="S3.E18.m1.7.7" xref="S3.E18.m1.7.7.cmml"><msubsup id="S3.E18.m1.7.7.3" xref="S3.E18.m1.7.7.3.cmml"><mi id="S3.E18.m1.7.7.3.2.2" xref="S3.E18.m1.7.7.3.2.2.cmml">L</mi><mrow id="S3.E18.m1.2.2.2.2" xref="S3.E18.m1.2.2.2.3.cmml"><mi id="S3.E18.m1.1.1.1.1" xref="S3.E18.m1.1.1.1.1.cmml">i</mi><mo id="S3.E18.m1.2.2.2.2.2" xref="S3.E18.m1.2.2.2.3.cmml">,</mo><mrow id="S3.E18.m1.2.2.2.2.1" xref="S3.E18.m1.2.2.2.2.1.cmml"><mi id="S3.E18.m1.2.2.2.2.1.2" xref="S3.E18.m1.2.2.2.2.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.2.2.2.2.1.1" xref="S3.E18.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E18.m1.2.2.2.2.1.3" xref="S3.E18.m1.2.2.2.2.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.2.2.2.2.1.1a" xref="S3.E18.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E18.m1.2.2.2.2.1.4" xref="S3.E18.m1.2.2.2.2.1.4.cmml">P</mi></mrow></mrow><mi id="S3.E18.m1.7.7.3.3" xref="S3.E18.m1.7.7.3.3.cmml">k</mi></msubsup><mo id="S3.E18.m1.7.7.2" xref="S3.E18.m1.7.7.2.cmml">=</mo><msup id="S3.E18.m1.7.7.1" xref="S3.E18.m1.7.7.1.cmml"><mrow id="S3.E18.m1.7.7.1.1.1" xref="S3.E18.m1.7.7.1.1.2.cmml"><mo stretchy="false" id="S3.E18.m1.7.7.1.1.1.2" xref="S3.E18.m1.7.7.1.1.2.1.cmml">|</mo><mrow id="S3.E18.m1.7.7.1.1.1.1" xref="S3.E18.m1.7.7.1.1.1.1.cmml"><msubsup id="S3.E18.m1.7.7.1.1.1.1.2" xref="S3.E18.m1.7.7.1.1.1.1.2.cmml"><mi id="S3.E18.m1.7.7.1.1.1.1.2.2.2" xref="S3.E18.m1.7.7.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.E18.m1.7.7.1.1.1.1.2.3" xref="S3.E18.m1.7.7.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E18.m1.4.4.2.2" xref="S3.E18.m1.4.4.2.3.cmml"><mrow id="S3.E18.m1.4.4.2.2.1" xref="S3.E18.m1.4.4.2.2.1.cmml"><mi id="S3.E18.m1.4.4.2.2.1.2" xref="S3.E18.m1.4.4.2.2.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.4.4.2.2.1.1" xref="S3.E18.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E18.m1.4.4.2.2.1.3" xref="S3.E18.m1.4.4.2.2.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.4.4.2.2.1.1a" xref="S3.E18.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.E18.m1.4.4.2.2.1.4" xref="S3.E18.m1.4.4.2.2.1.4.cmml">P</mi></mrow><mo id="S3.E18.m1.4.4.2.2.2" xref="S3.E18.m1.4.4.2.3.cmml">,</mo><mi id="S3.E18.m1.3.3.1.1" xref="S3.E18.m1.3.3.1.1.cmml">k</mi></mrow></msubsup><mo id="S3.E18.m1.7.7.1.1.1.1.1" xref="S3.E18.m1.7.7.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E18.m1.7.7.1.1.1.1.3" xref="S3.E18.m1.7.7.1.1.1.1.3.cmml"><mi id="S3.E18.m1.7.7.1.1.1.1.3.2.2" xref="S3.E18.m1.7.7.1.1.1.1.3.2.2.cmml">𝐖</mi><mi id="S3.E18.m1.7.7.1.1.1.1.3.3" xref="S3.E18.m1.7.7.1.1.1.1.3.3.cmml">i</mi><mrow id="S3.E18.m1.6.6.2.2" xref="S3.E18.m1.6.6.2.3.cmml"><mrow id="S3.E18.m1.6.6.2.2.1" xref="S3.E18.m1.6.6.2.2.1.cmml"><mi id="S3.E18.m1.6.6.2.2.1.2" xref="S3.E18.m1.6.6.2.2.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.6.6.2.2.1.1" xref="S3.E18.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S3.E18.m1.6.6.2.2.1.3" xref="S3.E18.m1.6.6.2.2.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E18.m1.6.6.2.2.1.1a" xref="S3.E18.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S3.E18.m1.6.6.2.2.1.4" xref="S3.E18.m1.6.6.2.2.1.4.cmml">P</mi></mrow><mo id="S3.E18.m1.6.6.2.2.2" xref="S3.E18.m1.6.6.2.3.cmml">,</mo><mi id="S3.E18.m1.5.5.1.1" xref="S3.E18.m1.5.5.1.1.cmml">G</mi></mrow></msubsup></mrow><mo stretchy="false" id="S3.E18.m1.7.7.1.1.1.3" xref="S3.E18.m1.7.7.1.1.2.1.cmml">|</mo></mrow><mn id="S3.E18.m1.7.7.1.3" xref="S3.E18.m1.7.7.1.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E18.m1.7b"><apply id="S3.E18.m1.7.7.cmml" xref="S3.E18.m1.7.7"><eq id="S3.E18.m1.7.7.2.cmml" xref="S3.E18.m1.7.7.2"></eq><apply id="S3.E18.m1.7.7.3.cmml" xref="S3.E18.m1.7.7.3"><csymbol cd="ambiguous" id="S3.E18.m1.7.7.3.1.cmml" xref="S3.E18.m1.7.7.3">superscript</csymbol><apply id="S3.E18.m1.7.7.3.2.cmml" xref="S3.E18.m1.7.7.3"><csymbol cd="ambiguous" id="S3.E18.m1.7.7.3.2.1.cmml" xref="S3.E18.m1.7.7.3">subscript</csymbol><ci id="S3.E18.m1.7.7.3.2.2.cmml" xref="S3.E18.m1.7.7.3.2.2">𝐿</ci><list id="S3.E18.m1.2.2.2.3.cmml" xref="S3.E18.m1.2.2.2.2"><ci id="S3.E18.m1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1.1">𝑖</ci><apply id="S3.E18.m1.2.2.2.2.1.cmml" xref="S3.E18.m1.2.2.2.2.1"><times id="S3.E18.m1.2.2.2.2.1.1.cmml" xref="S3.E18.m1.2.2.2.2.1.1"></times><ci id="S3.E18.m1.2.2.2.2.1.2.cmml" xref="S3.E18.m1.2.2.2.2.1.2">𝑀</ci><ci id="S3.E18.m1.2.2.2.2.1.3.cmml" xref="S3.E18.m1.2.2.2.2.1.3">𝐿</ci><ci id="S3.E18.m1.2.2.2.2.1.4.cmml" xref="S3.E18.m1.2.2.2.2.1.4">𝑃</ci></apply></list></apply><ci id="S3.E18.m1.7.7.3.3.cmml" xref="S3.E18.m1.7.7.3.3">𝑘</ci></apply><apply id="S3.E18.m1.7.7.1.cmml" xref="S3.E18.m1.7.7.1"><csymbol cd="ambiguous" id="S3.E18.m1.7.7.1.2.cmml" xref="S3.E18.m1.7.7.1">superscript</csymbol><apply id="S3.E18.m1.7.7.1.1.2.cmml" xref="S3.E18.m1.7.7.1.1.1"><abs id="S3.E18.m1.7.7.1.1.2.1.cmml" xref="S3.E18.m1.7.7.1.1.1.2"></abs><apply id="S3.E18.m1.7.7.1.1.1.1.cmml" xref="S3.E18.m1.7.7.1.1.1.1"><minus id="S3.E18.m1.7.7.1.1.1.1.1.cmml" xref="S3.E18.m1.7.7.1.1.1.1.1"></minus><apply id="S3.E18.m1.7.7.1.1.1.1.2.cmml" xref="S3.E18.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E18.m1.7.7.1.1.1.1.2.1.cmml" xref="S3.E18.m1.7.7.1.1.1.1.2">subscript</csymbol><apply id="S3.E18.m1.7.7.1.1.1.1.2.2.cmml" xref="S3.E18.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E18.m1.7.7.1.1.1.1.2.2.1.cmml" xref="S3.E18.m1.7.7.1.1.1.1.2">superscript</csymbol><ci id="S3.E18.m1.7.7.1.1.1.1.2.2.2.cmml" xref="S3.E18.m1.7.7.1.1.1.1.2.2.2">𝐖</ci><list id="S3.E18.m1.4.4.2.3.cmml" xref="S3.E18.m1.4.4.2.2"><apply id="S3.E18.m1.4.4.2.2.1.cmml" xref="S3.E18.m1.4.4.2.2.1"><times id="S3.E18.m1.4.4.2.2.1.1.cmml" xref="S3.E18.m1.4.4.2.2.1.1"></times><ci id="S3.E18.m1.4.4.2.2.1.2.cmml" xref="S3.E18.m1.4.4.2.2.1.2">𝑀</ci><ci id="S3.E18.m1.4.4.2.2.1.3.cmml" xref="S3.E18.m1.4.4.2.2.1.3">𝐿</ci><ci id="S3.E18.m1.4.4.2.2.1.4.cmml" xref="S3.E18.m1.4.4.2.2.1.4">𝑃</ci></apply><ci id="S3.E18.m1.3.3.1.1.cmml" xref="S3.E18.m1.3.3.1.1">𝑘</ci></list></apply><ci id="S3.E18.m1.7.7.1.1.1.1.2.3.cmml" xref="S3.E18.m1.7.7.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E18.m1.7.7.1.1.1.1.3.cmml" xref="S3.E18.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E18.m1.7.7.1.1.1.1.3.1.cmml" xref="S3.E18.m1.7.7.1.1.1.1.3">subscript</csymbol><apply id="S3.E18.m1.7.7.1.1.1.1.3.2.cmml" xref="S3.E18.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E18.m1.7.7.1.1.1.1.3.2.1.cmml" xref="S3.E18.m1.7.7.1.1.1.1.3">superscript</csymbol><ci id="S3.E18.m1.7.7.1.1.1.1.3.2.2.cmml" xref="S3.E18.m1.7.7.1.1.1.1.3.2.2">𝐖</ci><list id="S3.E18.m1.6.6.2.3.cmml" xref="S3.E18.m1.6.6.2.2"><apply id="S3.E18.m1.6.6.2.2.1.cmml" xref="S3.E18.m1.6.6.2.2.1"><times id="S3.E18.m1.6.6.2.2.1.1.cmml" xref="S3.E18.m1.6.6.2.2.1.1"></times><ci id="S3.E18.m1.6.6.2.2.1.2.cmml" xref="S3.E18.m1.6.6.2.2.1.2">𝑀</ci><ci id="S3.E18.m1.6.6.2.2.1.3.cmml" xref="S3.E18.m1.6.6.2.2.1.3">𝐿</ci><ci id="S3.E18.m1.6.6.2.2.1.4.cmml" xref="S3.E18.m1.6.6.2.2.1.4">𝑃</ci></apply><ci id="S3.E18.m1.5.5.1.1.cmml" xref="S3.E18.m1.5.5.1.1">𝐺</ci></list></apply><ci id="S3.E18.m1.7.7.1.1.1.1.3.3.cmml" xref="S3.E18.m1.7.7.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.E18.m1.7.7.1.3.cmml" xref="S3.E18.m1.7.7.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m1.7c">L_{i,MLP}^{k}=|\mathbf{W}^{MLP,k}_{i}-\mathbf{W}^{MLP,G}_{i}|^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p13" class="ltx_para">
<p id="S3.SS2.p13.4" class="ltx_p">Next, we incorporate these L2 differences into the local objective function for each client <math id="S3.SS2.p13.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p13.1.m1.1a"><mi id="S3.SS2.p13.1.m1.1.1" xref="S3.SS2.p13.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p13.1.m1.1b"><ci id="S3.SS2.p13.1.m1.1.1.cmml" xref="S3.SS2.p13.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p13.1.m1.1c">k</annotation></semantics></math> and layer <math id="S3.SS2.p13.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p13.2.m2.1a"><mi id="S3.SS2.p13.2.m2.1.1" xref="S3.SS2.p13.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p13.2.m2.1b"><ci id="S3.SS2.p13.2.m2.1.1.cmml" xref="S3.SS2.p13.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p13.2.m2.1c">i</annotation></semantics></math>. The modified local objective function for client <math id="S3.SS2.p13.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p13.3.m3.1a"><mi id="S3.SS2.p13.3.m3.1.1" xref="S3.SS2.p13.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p13.3.m3.1b"><ci id="S3.SS2.p13.3.m3.1.1.cmml" xref="S3.SS2.p13.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p13.3.m3.1c">k</annotation></semantics></math> and layer <math id="S3.SS2.p13.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p13.4.m4.1a"><mi id="S3.SS2.p13.4.m4.1.1" xref="S3.SS2.p13.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p13.4.m4.1b"><ci id="S3.SS2.p13.4.m4.1.1.cmml" xref="S3.SS2.p13.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p13.4.m4.1c">i</annotation></semantics></math> would be:</p>
</div>
<div id="S3.SS2.p14" class="ltx_para">
<table id="Sx1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E19.m1.11" class="ltx_Math" alttext="\displaystyle\min_{w}h_{k}^{i}(w;~{}w^{t})=F_{k}^{i}(w)+\frac{\mu}{2}\left(L_{i,Q}^{k}+L_{i,K}^{k}+L_{i,V}^{k}+L_{i,MLP}^{k}\right)," display="inline"><semantics id="S3.E19.m1.11a"><mrow id="S3.E19.m1.11.11.1" xref="S3.E19.m1.11.11.1.1.cmml"><mrow id="S3.E19.m1.11.11.1.1" xref="S3.E19.m1.11.11.1.1.cmml"><mrow id="S3.E19.m1.11.11.1.1.1" xref="S3.E19.m1.11.11.1.1.1.cmml"><mrow id="S3.E19.m1.11.11.1.1.1.3" xref="S3.E19.m1.11.11.1.1.1.3.cmml"><munder id="S3.E19.m1.11.11.1.1.1.3.1" xref="S3.E19.m1.11.11.1.1.1.3.1.cmml"><mi id="S3.E19.m1.11.11.1.1.1.3.1.2" xref="S3.E19.m1.11.11.1.1.1.3.1.2.cmml">min</mi><mi id="S3.E19.m1.11.11.1.1.1.3.1.3" xref="S3.E19.m1.11.11.1.1.1.3.1.3.cmml">w</mi></munder><mo lspace="0.167em" id="S3.E19.m1.11.11.1.1.1.3a" xref="S3.E19.m1.11.11.1.1.1.3.cmml">⁡</mo><msubsup id="S3.E19.m1.11.11.1.1.1.3.2" xref="S3.E19.m1.11.11.1.1.1.3.2.cmml"><mi id="S3.E19.m1.11.11.1.1.1.3.2.2.2" xref="S3.E19.m1.11.11.1.1.1.3.2.2.2.cmml">h</mi><mi id="S3.E19.m1.11.11.1.1.1.3.2.2.3" xref="S3.E19.m1.11.11.1.1.1.3.2.2.3.cmml">k</mi><mi id="S3.E19.m1.11.11.1.1.1.3.2.3" xref="S3.E19.m1.11.11.1.1.1.3.2.3.cmml">i</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.E19.m1.11.11.1.1.1.2" xref="S3.E19.m1.11.11.1.1.1.2.cmml">​</mo><mrow id="S3.E19.m1.11.11.1.1.1.1.1" xref="S3.E19.m1.11.11.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E19.m1.11.11.1.1.1.1.1.2" xref="S3.E19.m1.11.11.1.1.1.1.2.cmml">(</mo><mi id="S3.E19.m1.9.9" xref="S3.E19.m1.9.9.cmml">w</mi><mo rspace="0.497em" id="S3.E19.m1.11.11.1.1.1.1.1.3" xref="S3.E19.m1.11.11.1.1.1.1.2.cmml">;</mo><msup id="S3.E19.m1.11.11.1.1.1.1.1.1" xref="S3.E19.m1.11.11.1.1.1.1.1.1.cmml"><mi id="S3.E19.m1.11.11.1.1.1.1.1.1.2" xref="S3.E19.m1.11.11.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E19.m1.11.11.1.1.1.1.1.1.3" xref="S3.E19.m1.11.11.1.1.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="S3.E19.m1.11.11.1.1.1.1.1.4" xref="S3.E19.m1.11.11.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E19.m1.11.11.1.1.3" xref="S3.E19.m1.11.11.1.1.3.cmml">=</mo><mrow id="S3.E19.m1.11.11.1.1.2" xref="S3.E19.m1.11.11.1.1.2.cmml"><mrow id="S3.E19.m1.11.11.1.1.2.3" xref="S3.E19.m1.11.11.1.1.2.3.cmml"><msubsup id="S3.E19.m1.11.11.1.1.2.3.2" xref="S3.E19.m1.11.11.1.1.2.3.2.cmml"><mi id="S3.E19.m1.11.11.1.1.2.3.2.2.2" xref="S3.E19.m1.11.11.1.1.2.3.2.2.2.cmml">F</mi><mi id="S3.E19.m1.11.11.1.1.2.3.2.2.3" xref="S3.E19.m1.11.11.1.1.2.3.2.2.3.cmml">k</mi><mi id="S3.E19.m1.11.11.1.1.2.3.2.3" xref="S3.E19.m1.11.11.1.1.2.3.2.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E19.m1.11.11.1.1.2.3.1" xref="S3.E19.m1.11.11.1.1.2.3.1.cmml">​</mo><mrow id="S3.E19.m1.11.11.1.1.2.3.3.2" xref="S3.E19.m1.11.11.1.1.2.3.cmml"><mo stretchy="false" id="S3.E19.m1.11.11.1.1.2.3.3.2.1" xref="S3.E19.m1.11.11.1.1.2.3.cmml">(</mo><mi id="S3.E19.m1.10.10" xref="S3.E19.m1.10.10.cmml">w</mi><mo stretchy="false" id="S3.E19.m1.11.11.1.1.2.3.3.2.2" xref="S3.E19.m1.11.11.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E19.m1.11.11.1.1.2.2" xref="S3.E19.m1.11.11.1.1.2.2.cmml">+</mo><mrow id="S3.E19.m1.11.11.1.1.2.1" xref="S3.E19.m1.11.11.1.1.2.1.cmml"><mstyle displaystyle="true" id="S3.E19.m1.11.11.1.1.2.1.3" xref="S3.E19.m1.11.11.1.1.2.1.3.cmml"><mfrac id="S3.E19.m1.11.11.1.1.2.1.3a" xref="S3.E19.m1.11.11.1.1.2.1.3.cmml"><mi id="S3.E19.m1.11.11.1.1.2.1.3.2" xref="S3.E19.m1.11.11.1.1.2.1.3.2.cmml">μ</mi><mn id="S3.E19.m1.11.11.1.1.2.1.3.3" xref="S3.E19.m1.11.11.1.1.2.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E19.m1.11.11.1.1.2.1.2" xref="S3.E19.m1.11.11.1.1.2.1.2.cmml">​</mo><mrow id="S3.E19.m1.11.11.1.1.2.1.1.1" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.cmml"><mo id="S3.E19.m1.11.11.1.1.2.1.1.1.2" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E19.m1.11.11.1.1.2.1.1.1.1" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.cmml"><msubsup id="S3.E19.m1.11.11.1.1.2.1.1.1.1.2" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.cmml"><mi id="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.2.2" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.2.2.cmml">L</mi><mrow id="S3.E19.m1.2.2.2.4" xref="S3.E19.m1.2.2.2.3.cmml"><mi id="S3.E19.m1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.cmml">i</mi><mo id="S3.E19.m1.2.2.2.4.1" xref="S3.E19.m1.2.2.2.3.cmml">,</mo><mi id="S3.E19.m1.2.2.2.2" xref="S3.E19.m1.2.2.2.2.cmml">Q</mi></mrow><mi id="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.3" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.E19.m1.11.11.1.1.2.1.1.1.1.1" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.1.cmml">+</mo><msubsup id="S3.E19.m1.11.11.1.1.2.1.1.1.1.3" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.2.2" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.2.2.cmml">L</mi><mrow id="S3.E19.m1.4.4.2.4" xref="S3.E19.m1.4.4.2.3.cmml"><mi id="S3.E19.m1.3.3.1.1" xref="S3.E19.m1.3.3.1.1.cmml">i</mi><mo id="S3.E19.m1.4.4.2.4.1" xref="S3.E19.m1.4.4.2.3.cmml">,</mo><mi id="S3.E19.m1.4.4.2.2" xref="S3.E19.m1.4.4.2.2.cmml">K</mi></mrow><mi id="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.3" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.3.cmml">k</mi></msubsup><mo id="S3.E19.m1.11.11.1.1.2.1.1.1.1.1a" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.1.cmml">+</mo><msubsup id="S3.E19.m1.11.11.1.1.2.1.1.1.1.4" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.cmml"><mi id="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.2.2" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.2.2.cmml">L</mi><mrow id="S3.E19.m1.6.6.2.4" xref="S3.E19.m1.6.6.2.3.cmml"><mi id="S3.E19.m1.5.5.1.1" xref="S3.E19.m1.5.5.1.1.cmml">i</mi><mo id="S3.E19.m1.6.6.2.4.1" xref="S3.E19.m1.6.6.2.3.cmml">,</mo><mi id="S3.E19.m1.6.6.2.2" xref="S3.E19.m1.6.6.2.2.cmml">V</mi></mrow><mi id="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.3" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.3.cmml">k</mi></msubsup><mo id="S3.E19.m1.11.11.1.1.2.1.1.1.1.1b" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.1.cmml">+</mo><msubsup id="S3.E19.m1.11.11.1.1.2.1.1.1.1.5" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.cmml"><mi id="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.2.2" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.2.2.cmml">L</mi><mrow id="S3.E19.m1.8.8.2.2" xref="S3.E19.m1.8.8.2.3.cmml"><mi id="S3.E19.m1.7.7.1.1" xref="S3.E19.m1.7.7.1.1.cmml">i</mi><mo id="S3.E19.m1.8.8.2.2.2" xref="S3.E19.m1.8.8.2.3.cmml">,</mo><mrow id="S3.E19.m1.8.8.2.2.1" xref="S3.E19.m1.8.8.2.2.1.cmml"><mi id="S3.E19.m1.8.8.2.2.1.2" xref="S3.E19.m1.8.8.2.2.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.8.8.2.2.1.1" xref="S3.E19.m1.8.8.2.2.1.1.cmml">​</mo><mi id="S3.E19.m1.8.8.2.2.1.3" xref="S3.E19.m1.8.8.2.2.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.8.8.2.2.1.1a" xref="S3.E19.m1.8.8.2.2.1.1.cmml">​</mo><mi id="S3.E19.m1.8.8.2.2.1.4" xref="S3.E19.m1.8.8.2.2.1.4.cmml">P</mi></mrow></mrow><mi id="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.3" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.3.cmml">k</mi></msubsup></mrow><mo id="S3.E19.m1.11.11.1.1.2.1.1.1.3" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E19.m1.11.11.1.2" xref="S3.E19.m1.11.11.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E19.m1.11b"><apply id="S3.E19.m1.11.11.1.1.cmml" xref="S3.E19.m1.11.11.1"><eq id="S3.E19.m1.11.11.1.1.3.cmml" xref="S3.E19.m1.11.11.1.1.3"></eq><apply id="S3.E19.m1.11.11.1.1.1.cmml" xref="S3.E19.m1.11.11.1.1.1"><times id="S3.E19.m1.11.11.1.1.1.2.cmml" xref="S3.E19.m1.11.11.1.1.1.2"></times><apply id="S3.E19.m1.11.11.1.1.1.3.cmml" xref="S3.E19.m1.11.11.1.1.1.3"><apply id="S3.E19.m1.11.11.1.1.1.3.1.cmml" xref="S3.E19.m1.11.11.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.1.3.1.1.cmml" xref="S3.E19.m1.11.11.1.1.1.3.1">subscript</csymbol><min id="S3.E19.m1.11.11.1.1.1.3.1.2.cmml" xref="S3.E19.m1.11.11.1.1.1.3.1.2"></min><ci id="S3.E19.m1.11.11.1.1.1.3.1.3.cmml" xref="S3.E19.m1.11.11.1.1.1.3.1.3">𝑤</ci></apply><apply id="S3.E19.m1.11.11.1.1.1.3.2.cmml" xref="S3.E19.m1.11.11.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.1.3.2.1.cmml" xref="S3.E19.m1.11.11.1.1.1.3.2">superscript</csymbol><apply id="S3.E19.m1.11.11.1.1.1.3.2.2.cmml" xref="S3.E19.m1.11.11.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.1.3.2.2.1.cmml" xref="S3.E19.m1.11.11.1.1.1.3.2">subscript</csymbol><ci id="S3.E19.m1.11.11.1.1.1.3.2.2.2.cmml" xref="S3.E19.m1.11.11.1.1.1.3.2.2.2">ℎ</ci><ci id="S3.E19.m1.11.11.1.1.1.3.2.2.3.cmml" xref="S3.E19.m1.11.11.1.1.1.3.2.2.3">𝑘</ci></apply><ci id="S3.E19.m1.11.11.1.1.1.3.2.3.cmml" xref="S3.E19.m1.11.11.1.1.1.3.2.3">𝑖</ci></apply></apply><list id="S3.E19.m1.11.11.1.1.1.1.2.cmml" xref="S3.E19.m1.11.11.1.1.1.1.1"><ci id="S3.E19.m1.9.9.cmml" xref="S3.E19.m1.9.9">𝑤</ci><apply id="S3.E19.m1.11.11.1.1.1.1.1.1.cmml" xref="S3.E19.m1.11.11.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.11.11.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E19.m1.11.11.1.1.1.1.1.1.2.cmml" xref="S3.E19.m1.11.11.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E19.m1.11.11.1.1.1.1.1.1.3.cmml" xref="S3.E19.m1.11.11.1.1.1.1.1.1.3">𝑡</ci></apply></list></apply><apply id="S3.E19.m1.11.11.1.1.2.cmml" xref="S3.E19.m1.11.11.1.1.2"><plus id="S3.E19.m1.11.11.1.1.2.2.cmml" xref="S3.E19.m1.11.11.1.1.2.2"></plus><apply id="S3.E19.m1.11.11.1.1.2.3.cmml" xref="S3.E19.m1.11.11.1.1.2.3"><times id="S3.E19.m1.11.11.1.1.2.3.1.cmml" xref="S3.E19.m1.11.11.1.1.2.3.1"></times><apply id="S3.E19.m1.11.11.1.1.2.3.2.cmml" xref="S3.E19.m1.11.11.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.2.3.2.1.cmml" xref="S3.E19.m1.11.11.1.1.2.3.2">superscript</csymbol><apply id="S3.E19.m1.11.11.1.1.2.3.2.2.cmml" xref="S3.E19.m1.11.11.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.2.3.2.2.1.cmml" xref="S3.E19.m1.11.11.1.1.2.3.2">subscript</csymbol><ci id="S3.E19.m1.11.11.1.1.2.3.2.2.2.cmml" xref="S3.E19.m1.11.11.1.1.2.3.2.2.2">𝐹</ci><ci id="S3.E19.m1.11.11.1.1.2.3.2.2.3.cmml" xref="S3.E19.m1.11.11.1.1.2.3.2.2.3">𝑘</ci></apply><ci id="S3.E19.m1.11.11.1.1.2.3.2.3.cmml" xref="S3.E19.m1.11.11.1.1.2.3.2.3">𝑖</ci></apply><ci id="S3.E19.m1.10.10.cmml" xref="S3.E19.m1.10.10">𝑤</ci></apply><apply id="S3.E19.m1.11.11.1.1.2.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1"><times id="S3.E19.m1.11.11.1.1.2.1.2.cmml" xref="S3.E19.m1.11.11.1.1.2.1.2"></times><apply id="S3.E19.m1.11.11.1.1.2.1.3.cmml" xref="S3.E19.m1.11.11.1.1.2.1.3"><divide id="S3.E19.m1.11.11.1.1.2.1.3.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1.3"></divide><ci id="S3.E19.m1.11.11.1.1.2.1.3.2.cmml" xref="S3.E19.m1.11.11.1.1.2.1.3.2">𝜇</ci><cn type="integer" id="S3.E19.m1.11.11.1.1.2.1.3.3.cmml" xref="S3.E19.m1.11.11.1.1.2.1.3.3">2</cn></apply><apply id="S3.E19.m1.11.11.1.1.2.1.1.1.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1"><plus id="S3.E19.m1.11.11.1.1.2.1.1.1.1.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.1"></plus><apply id="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.2">superscript</csymbol><apply id="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.2.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.2.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.2.2.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.2.2">𝐿</ci><list id="S3.E19.m1.2.2.2.3.cmml" xref="S3.E19.m1.2.2.2.4"><ci id="S3.E19.m1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1">𝑖</ci><ci id="S3.E19.m1.2.2.2.2.cmml" xref="S3.E19.m1.2.2.2.2">𝑄</ci></list></apply><ci id="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.3">superscript</csymbol><apply id="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.2.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.2.2.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.2.2">𝐿</ci><list id="S3.E19.m1.4.4.2.3.cmml" xref="S3.E19.m1.4.4.2.4"><ci id="S3.E19.m1.3.3.1.1.cmml" xref="S3.E19.m1.3.3.1.1">𝑖</ci><ci id="S3.E19.m1.4.4.2.2.cmml" xref="S3.E19.m1.4.4.2.2">𝐾</ci></list></apply><ci id="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.4">superscript</csymbol><apply id="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.2.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.2.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.2.2.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.2.2">𝐿</ci><list id="S3.E19.m1.6.6.2.3.cmml" xref="S3.E19.m1.6.6.2.4"><ci id="S3.E19.m1.5.5.1.1.cmml" xref="S3.E19.m1.5.5.1.1">𝑖</ci><ci id="S3.E19.m1.6.6.2.2.cmml" xref="S3.E19.m1.6.6.2.2">𝑉</ci></list></apply><ci id="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.3.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.4.3">𝑘</ci></apply><apply id="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.5">superscript</csymbol><apply id="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.2.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.2.1.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.5">subscript</csymbol><ci id="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.2.2.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.2.2">𝐿</ci><list id="S3.E19.m1.8.8.2.3.cmml" xref="S3.E19.m1.8.8.2.2"><ci id="S3.E19.m1.7.7.1.1.cmml" xref="S3.E19.m1.7.7.1.1">𝑖</ci><apply id="S3.E19.m1.8.8.2.2.1.cmml" xref="S3.E19.m1.8.8.2.2.1"><times id="S3.E19.m1.8.8.2.2.1.1.cmml" xref="S3.E19.m1.8.8.2.2.1.1"></times><ci id="S3.E19.m1.8.8.2.2.1.2.cmml" xref="S3.E19.m1.8.8.2.2.1.2">𝑀</ci><ci id="S3.E19.m1.8.8.2.2.1.3.cmml" xref="S3.E19.m1.8.8.2.2.1.3">𝐿</ci><ci id="S3.E19.m1.8.8.2.2.1.4.cmml" xref="S3.E19.m1.8.8.2.2.1.4">𝑃</ci></apply></list></apply><ci id="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.3.cmml" xref="S3.E19.m1.11.11.1.1.2.1.1.1.1.5.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E19.m1.11c">\displaystyle\min_{w}h_{k}^{i}(w;~{}w^{t})=F_{k}^{i}(w)+\frac{\mu}{2}\left(L_{i,Q}^{k}+L_{i,K}^{k}+L_{i,V}^{k}+L_{i,MLP}^{k}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p15" class="ltx_para">
<p id="S3.SS2.p15.1" class="ltx_p">This local objective function includes both the local loss function <math id="S3.SS2.p15.1.m1.1" class="ltx_Math" alttext="F_{k}^{i}(w)" display="inline"><semantics id="S3.SS2.p15.1.m1.1a"><mrow id="S3.SS2.p15.1.m1.1.2" xref="S3.SS2.p15.1.m1.1.2.cmml"><msubsup id="S3.SS2.p15.1.m1.1.2.2" xref="S3.SS2.p15.1.m1.1.2.2.cmml"><mi id="S3.SS2.p15.1.m1.1.2.2.2.2" xref="S3.SS2.p15.1.m1.1.2.2.2.2.cmml">F</mi><mi id="S3.SS2.p15.1.m1.1.2.2.2.3" xref="S3.SS2.p15.1.m1.1.2.2.2.3.cmml">k</mi><mi id="S3.SS2.p15.1.m1.1.2.2.3" xref="S3.SS2.p15.1.m1.1.2.2.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p15.1.m1.1.2.1" xref="S3.SS2.p15.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS2.p15.1.m1.1.2.3.2" xref="S3.SS2.p15.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p15.1.m1.1.2.3.2.1" xref="S3.SS2.p15.1.m1.1.2.cmml">(</mo><mi id="S3.SS2.p15.1.m1.1.1" xref="S3.SS2.p15.1.m1.1.1.cmml">w</mi><mo stretchy="false" id="S3.SS2.p15.1.m1.1.2.3.2.2" xref="S3.SS2.p15.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p15.1.m1.1b"><apply id="S3.SS2.p15.1.m1.1.2.cmml" xref="S3.SS2.p15.1.m1.1.2"><times id="S3.SS2.p15.1.m1.1.2.1.cmml" xref="S3.SS2.p15.1.m1.1.2.1"></times><apply id="S3.SS2.p15.1.m1.1.2.2.cmml" xref="S3.SS2.p15.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p15.1.m1.1.2.2.1.cmml" xref="S3.SS2.p15.1.m1.1.2.2">superscript</csymbol><apply id="S3.SS2.p15.1.m1.1.2.2.2.cmml" xref="S3.SS2.p15.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p15.1.m1.1.2.2.2.1.cmml" xref="S3.SS2.p15.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.p15.1.m1.1.2.2.2.2.cmml" xref="S3.SS2.p15.1.m1.1.2.2.2.2">𝐹</ci><ci id="S3.SS2.p15.1.m1.1.2.2.2.3.cmml" xref="S3.SS2.p15.1.m1.1.2.2.2.3">𝑘</ci></apply><ci id="S3.SS2.p15.1.m1.1.2.2.3.cmml" xref="S3.SS2.p15.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p15.1.m1.1.1.cmml" xref="S3.SS2.p15.1.m1.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p15.1.m1.1c">F_{k}^{i}(w)</annotation></semantics></math> and the L2 difference between the local and global layers. The MHEA term encourages the local updates to stay close to the initial global model, addressing the issue of statistical heterogeneity and safely incorporating variable amounts of local work. The federated learning process continues for multiple rounds, with the global model sending its updated parameters to the local clients and receiving their updated parameters until a specified convergence criterion is met.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Data and experimental setup</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Dataset and Pre-processing</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We utilized the IQ-OTH/NCCD Lung Cancer dataset from the Iraq-Oncology Teaching Hospital/National Center for Cancer Diseases. Collected in 2019, this dataset comprises 1190 CT scan slice images from 110 distinct instances. Each instance contains multiple slices. The CT scan images cover a window width ranging from 350 to 1200 HU and are categorized into three types: benign, malignant, and normal<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx31" title="" class="ltx_ref">31</a>]</cite>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">The images are representative of a diverse patient demographic, capturing a broad spectrum of pathological conditions. For the purpose of our experiment, the dataset was partitioned across ten clients. Each client received a different number of samples, simulating a genuine federated learning environment.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">For pre-processing, we standardized the images to a consistent size of 224 x 224 pixels and applied common data augmentation techniques like random rotations and horizontal flipping, as advocated in works like <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx1" title="" class="ltx_ref">1</a>]</cite>. These steps align with standard practices, especially for this dataset. The choice of this dataset was influenced by its heterogeneity, with variations across gender, age, and health conditions, as noted by the original authors.</p>
</div>
<figure id="S4.F1" class="ltx_figure"><img src="/html/2310.09444/assets/x1.png" id="S4.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="322" height="170" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F1.8.4.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S4.F1.6.3" class="ltx_text" style="font-size:90%;">Client Data Distribution Variability at Different Heterogeneity Levels. The plot illustrates the variance in data distribution among clients as the heterogeneity levels, denoted by <math id="S4.F1.4.1.m1.1" class="ltx_Math" alttext="\alpha_{\mathrm{LDA}}" display="inline"><semantics id="S4.F1.4.1.m1.1b"><msub id="S4.F1.4.1.m1.1.1" xref="S4.F1.4.1.m1.1.1.cmml"><mi id="S4.F1.4.1.m1.1.1.2" xref="S4.F1.4.1.m1.1.1.2.cmml">α</mi><mi id="S4.F1.4.1.m1.1.1.3" xref="S4.F1.4.1.m1.1.1.3.cmml">LDA</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F1.4.1.m1.1c"><apply id="S4.F1.4.1.m1.1.1.cmml" xref="S4.F1.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F1.4.1.m1.1.1.1.cmml" xref="S4.F1.4.1.m1.1.1">subscript</csymbol><ci id="S4.F1.4.1.m1.1.1.2.cmml" xref="S4.F1.4.1.m1.1.1.2">𝛼</ci><ci id="S4.F1.4.1.m1.1.1.3.cmml" xref="S4.F1.4.1.m1.1.1.3">LDA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.4.1.m1.1d">\alpha_{\mathrm{LDA}}</annotation></semantics></math> values, alter. A longer vertical axis at lower <math id="S4.F1.5.2.m2.1" class="ltx_Math" alttext="\alpha_{\mathrm{LDA}}" display="inline"><semantics id="S4.F1.5.2.m2.1b"><msub id="S4.F1.5.2.m2.1.1" xref="S4.F1.5.2.m2.1.1.cmml"><mi id="S4.F1.5.2.m2.1.1.2" xref="S4.F1.5.2.m2.1.1.2.cmml">α</mi><mi id="S4.F1.5.2.m2.1.1.3" xref="S4.F1.5.2.m2.1.1.3.cmml">LDA</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F1.5.2.m2.1c"><apply id="S4.F1.5.2.m2.1.1.cmml" xref="S4.F1.5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.F1.5.2.m2.1.1.1.cmml" xref="S4.F1.5.2.m2.1.1">subscript</csymbol><ci id="S4.F1.5.2.m2.1.1.2.cmml" xref="S4.F1.5.2.m2.1.1.2">𝛼</ci><ci id="S4.F1.5.2.m2.1.1.3.cmml" xref="S4.F1.5.2.m2.1.1.3">LDA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.5.2.m2.1d">\alpha_{\mathrm{LDA}}</annotation></semantics></math> values signifies increased variability, while a wider and shorter plot at higher <math id="S4.F1.6.3.m3.1" class="ltx_Math" alttext="\alpha_{\mathrm{LDA}}" display="inline"><semantics id="S4.F1.6.3.m3.1b"><msub id="S4.F1.6.3.m3.1.1" xref="S4.F1.6.3.m3.1.1.cmml"><mi id="S4.F1.6.3.m3.1.1.2" xref="S4.F1.6.3.m3.1.1.2.cmml">α</mi><mi id="S4.F1.6.3.m3.1.1.3" xref="S4.F1.6.3.m3.1.1.3.cmml">LDA</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F1.6.3.m3.1c"><apply id="S4.F1.6.3.m3.1.1.cmml" xref="S4.F1.6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.F1.6.3.m3.1.1.1.cmml" xref="S4.F1.6.3.m3.1.1">subscript</csymbol><ci id="S4.F1.6.3.m3.1.1.2.cmml" xref="S4.F1.6.3.m3.1.1.2">𝛼</ci><ci id="S4.F1.6.3.m3.1.1.3.cmml" xref="S4.F1.6.3.m3.1.1.3">LDA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.6.3.m3.1d">\alpha_{\mathrm{LDA}}</annotation></semantics></math> values suggests diminished variability.</span></figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Model Architectures and Training</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Our study compared the convolutional neural network (ConvNet5) and a pre-trained vision transformer in a federated learning setting. The ConvNet5 architecture consists of five convolutional layers, each followed by batch normalization and ReLU activation function. These are succeeded by max-pooling layers and two fully connected layers with dropout to prevent overfitting.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">The dataset allocation across clients was accomplished using a Latent Dirichlet Allocation (LDA) based data splitter, which is graphically represented in Figure <a href="#S4.F1" title="Figure 1 ‣ 4.1 Dataset and Pre-processing ‣ 4 Data and experimental setup ‣ Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We used one A100 GPU in combination with the PyTorch framework for our experiments. We utilized the Stochastic Gradient Descent (SGD) optimizer with a learning rate of 0.01 and implemented gradient clipping with a max value of 5.0 to avoid exploding gradients. For FedProx method, the proximity coefficient, <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\mu</annotation></semantics></math>, was set at 0.5.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Evaluation metrics</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.2" class="ltx_p">The performance of the models was evaluated using metrics such as accuracy, number of correct predictions, and loss.
For each client <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">i</annotation></semantics></math> with local dataset <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="{D}_{i}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">D</mi><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝐷</ci><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">{D}_{i}</annotation></semantics></math>, we define the accuracy as:</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<table id="S4.E20" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E20.m1.4" class="ltx_Math" alttext="\text{Acc}_{i}=\frac{1}{|{D}_{i}|}\sum_{x\in{D}_{i}}\mathbb{I}\left(y(x)=\mathcal{F}(\omega_{i};x)\right)" display="block"><semantics id="S4.E20.m1.4a"><mrow id="S4.E20.m1.4.4" xref="S4.E20.m1.4.4.cmml"><msub id="S4.E20.m1.4.4.3" xref="S4.E20.m1.4.4.3.cmml"><mtext id="S4.E20.m1.4.4.3.2" xref="S4.E20.m1.4.4.3.2a.cmml">Acc</mtext><mi id="S4.E20.m1.4.4.3.3" xref="S4.E20.m1.4.4.3.3.cmml">i</mi></msub><mo id="S4.E20.m1.4.4.2" xref="S4.E20.m1.4.4.2.cmml">=</mo><mrow id="S4.E20.m1.4.4.1" xref="S4.E20.m1.4.4.1.cmml"><mfrac id="S4.E20.m1.1.1" xref="S4.E20.m1.1.1.cmml"><mn id="S4.E20.m1.1.1.3" xref="S4.E20.m1.1.1.3.cmml">1</mn><mrow id="S4.E20.m1.1.1.1.1" xref="S4.E20.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E20.m1.1.1.1.1.2" xref="S4.E20.m1.1.1.1.2.1.cmml">|</mo><msub id="S4.E20.m1.1.1.1.1.1" xref="S4.E20.m1.1.1.1.1.1.cmml"><mi id="S4.E20.m1.1.1.1.1.1.2" xref="S4.E20.m1.1.1.1.1.1.2.cmml">D</mi><mi id="S4.E20.m1.1.1.1.1.1.3" xref="S4.E20.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E20.m1.1.1.1.1.3" xref="S4.E20.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E20.m1.4.4.1.2" xref="S4.E20.m1.4.4.1.2.cmml">​</mo><mrow id="S4.E20.m1.4.4.1.1" xref="S4.E20.m1.4.4.1.1.cmml"><munder id="S4.E20.m1.4.4.1.1.2" xref="S4.E20.m1.4.4.1.1.2.cmml"><mo movablelimits="false" id="S4.E20.m1.4.4.1.1.2.2" xref="S4.E20.m1.4.4.1.1.2.2.cmml">∑</mo><mrow id="S4.E20.m1.4.4.1.1.2.3" xref="S4.E20.m1.4.4.1.1.2.3.cmml"><mi id="S4.E20.m1.4.4.1.1.2.3.2" xref="S4.E20.m1.4.4.1.1.2.3.2.cmml">x</mi><mo id="S4.E20.m1.4.4.1.1.2.3.1" xref="S4.E20.m1.4.4.1.1.2.3.1.cmml">∈</mo><msub id="S4.E20.m1.4.4.1.1.2.3.3" xref="S4.E20.m1.4.4.1.1.2.3.3.cmml"><mi id="S4.E20.m1.4.4.1.1.2.3.3.2" xref="S4.E20.m1.4.4.1.1.2.3.3.2.cmml">D</mi><mi id="S4.E20.m1.4.4.1.1.2.3.3.3" xref="S4.E20.m1.4.4.1.1.2.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="S4.E20.m1.4.4.1.1.1" xref="S4.E20.m1.4.4.1.1.1.cmml"><mi id="S4.E20.m1.4.4.1.1.1.3" xref="S4.E20.m1.4.4.1.1.1.3.cmml">𝕀</mi><mo lspace="0em" rspace="0em" id="S4.E20.m1.4.4.1.1.1.2" xref="S4.E20.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S4.E20.m1.4.4.1.1.1.1.1" xref="S4.E20.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S4.E20.m1.4.4.1.1.1.1.1.2" xref="S4.E20.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E20.m1.4.4.1.1.1.1.1.1" xref="S4.E20.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="S4.E20.m1.4.4.1.1.1.1.1.1.3" xref="S4.E20.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S4.E20.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.E20.m1.4.4.1.1.1.1.1.1.3.2.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E20.m1.4.4.1.1.1.1.1.1.3.1" xref="S4.E20.m1.4.4.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.E20.m1.4.4.1.1.1.1.1.1.3.3.2" xref="S4.E20.m1.4.4.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E20.m1.4.4.1.1.1.1.1.1.3.3.2.1" xref="S4.E20.m1.4.4.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E20.m1.2.2" xref="S4.E20.m1.2.2.cmml">x</mi><mo stretchy="false" id="S4.E20.m1.4.4.1.1.1.1.1.1.3.3.2.2" xref="S4.E20.m1.4.4.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E20.m1.4.4.1.1.1.1.1.1.2" xref="S4.E20.m1.4.4.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E20.m1.4.4.1.1.1.1.1.1.1" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E20.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S4.E20.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S4.E20.m1.3.3" xref="S4.E20.m1.3.3.cmml">x</mi><mo stretchy="false" id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.4" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E20.m1.4.4.1.1.1.1.1.3" xref="S4.E20.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E20.m1.4b"><apply id="S4.E20.m1.4.4.cmml" xref="S4.E20.m1.4.4"><eq id="S4.E20.m1.4.4.2.cmml" xref="S4.E20.m1.4.4.2"></eq><apply id="S4.E20.m1.4.4.3.cmml" xref="S4.E20.m1.4.4.3"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.3.1.cmml" xref="S4.E20.m1.4.4.3">subscript</csymbol><ci id="S4.E20.m1.4.4.3.2a.cmml" xref="S4.E20.m1.4.4.3.2"><mtext id="S4.E20.m1.4.4.3.2.cmml" xref="S4.E20.m1.4.4.3.2">Acc</mtext></ci><ci id="S4.E20.m1.4.4.3.3.cmml" xref="S4.E20.m1.4.4.3.3">𝑖</ci></apply><apply id="S4.E20.m1.4.4.1.cmml" xref="S4.E20.m1.4.4.1"><times id="S4.E20.m1.4.4.1.2.cmml" xref="S4.E20.m1.4.4.1.2"></times><apply id="S4.E20.m1.1.1.cmml" xref="S4.E20.m1.1.1"><divide id="S4.E20.m1.1.1.2.cmml" xref="S4.E20.m1.1.1"></divide><cn type="integer" id="S4.E20.m1.1.1.3.cmml" xref="S4.E20.m1.1.1.3">1</cn><apply id="S4.E20.m1.1.1.1.2.cmml" xref="S4.E20.m1.1.1.1.1"><abs id="S4.E20.m1.1.1.1.2.1.cmml" xref="S4.E20.m1.1.1.1.1.2"></abs><apply id="S4.E20.m1.1.1.1.1.1.cmml" xref="S4.E20.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E20.m1.1.1.1.1.1.1.cmml" xref="S4.E20.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E20.m1.1.1.1.1.1.2.cmml" xref="S4.E20.m1.1.1.1.1.1.2">𝐷</ci><ci id="S4.E20.m1.1.1.1.1.1.3.cmml" xref="S4.E20.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E20.m1.4.4.1.1.cmml" xref="S4.E20.m1.4.4.1.1"><apply id="S4.E20.m1.4.4.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.2.1.cmml" xref="S4.E20.m1.4.4.1.1.2">subscript</csymbol><sum id="S4.E20.m1.4.4.1.1.2.2.cmml" xref="S4.E20.m1.4.4.1.1.2.2"></sum><apply id="S4.E20.m1.4.4.1.1.2.3.cmml" xref="S4.E20.m1.4.4.1.1.2.3"><in id="S4.E20.m1.4.4.1.1.2.3.1.cmml" xref="S4.E20.m1.4.4.1.1.2.3.1"></in><ci id="S4.E20.m1.4.4.1.1.2.3.2.cmml" xref="S4.E20.m1.4.4.1.1.2.3.2">𝑥</ci><apply id="S4.E20.m1.4.4.1.1.2.3.3.cmml" xref="S4.E20.m1.4.4.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.2.3.3.1.cmml" xref="S4.E20.m1.4.4.1.1.2.3.3">subscript</csymbol><ci id="S4.E20.m1.4.4.1.1.2.3.3.2.cmml" xref="S4.E20.m1.4.4.1.1.2.3.3.2">𝐷</ci><ci id="S4.E20.m1.4.4.1.1.2.3.3.3.cmml" xref="S4.E20.m1.4.4.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S4.E20.m1.4.4.1.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1"><times id="S4.E20.m1.4.4.1.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.1.2"></times><ci id="S4.E20.m1.4.4.1.1.1.3.cmml" xref="S4.E20.m1.4.4.1.1.1.3">𝕀</ci><apply id="S4.E20.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1"><eq id="S4.E20.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.2"></eq><apply id="S4.E20.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.3"><times id="S4.E20.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.3.1"></times><ci id="S4.E20.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S4.E20.m1.2.2.cmml" xref="S4.E20.m1.2.2">𝑥</ci></apply><apply id="S4.E20.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1"><times id="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.2"></times><ci id="S4.E20.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.3">ℱ</ci><list id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1"><apply id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">𝜔</ci><ci id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S4.E20.m1.3.3.cmml" xref="S4.E20.m1.3.3">𝑥</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E20.m1.4c">\text{Acc}_{i}=\frac{1}{|{D}_{i}|}\sum_{x\in{D}_{i}}\mathbb{I}\left(y(x)=\mathcal{F}(\omega_{i};x)\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.5" class="ltx_p">Where <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="y(x)" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mrow id="S4.SS3.p3.1.m1.1.2" xref="S4.SS3.p3.1.m1.1.2.cmml"><mi id="S4.SS3.p3.1.m1.1.2.2" xref="S4.SS3.p3.1.m1.1.2.2.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.1.m1.1.2.1" xref="S4.SS3.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS3.p3.1.m1.1.2.3.2" xref="S4.SS3.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.1.m1.1.2.3.2.1" xref="S4.SS3.p3.1.m1.1.2.cmml">(</mo><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS3.p3.1.m1.1.2.3.2.2" xref="S4.SS3.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.2"><times id="S4.SS3.p3.1.m1.1.2.1.cmml" xref="S4.SS3.p3.1.m1.1.2.1"></times><ci id="S4.SS3.p3.1.m1.1.2.2.cmml" xref="S4.SS3.p3.1.m1.1.2.2">𝑦</ci><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">y(x)</annotation></semantics></math> is the true label of instance <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><ci id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">x</annotation></semantics></math> and <math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="\mathbb{I}(\cdot)" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><mrow id="S4.SS3.p3.3.m3.1.2" xref="S4.SS3.p3.3.m3.1.2.cmml"><mi id="S4.SS3.p3.3.m3.1.2.2" xref="S4.SS3.p3.3.m3.1.2.2.cmml">𝕀</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m3.1.2.1" xref="S4.SS3.p3.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS3.p3.3.m3.1.2.3.2" xref="S4.SS3.p3.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.3.m3.1.2.3.2.1" xref="S4.SS3.p3.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS3.p3.3.m3.1.2.3.2.2" xref="S4.SS3.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.2.cmml" xref="S4.SS3.p3.3.m3.1.2"><times id="S4.SS3.p3.3.m3.1.2.1.cmml" xref="S4.SS3.p3.3.m3.1.2.1"></times><ci id="S4.SS3.p3.3.m3.1.2.2.cmml" xref="S4.SS3.p3.3.m3.1.2.2">𝕀</ci><ci id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">\mathbb{I}(\cdot)</annotation></semantics></math> is the indicator function, returning 1 if the model’s prediction matches the true label, and 0 otherwise. Given the globally trained model, denoted by <math id="S4.SS3.p3.4.m4.2" class="ltx_Math" alttext="\mathcal{F}(\omega_{\text{global}};x)" display="inline"><semantics id="S4.SS3.p3.4.m4.2a"><mrow id="S4.SS3.p3.4.m4.2.2" xref="S4.SS3.p3.4.m4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.4.m4.2.2.3" xref="S4.SS3.p3.4.m4.2.2.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.4.m4.2.2.2" xref="S4.SS3.p3.4.m4.2.2.2.cmml">​</mo><mrow id="S4.SS3.p3.4.m4.2.2.1.1" xref="S4.SS3.p3.4.m4.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.4.m4.2.2.1.1.2" xref="S4.SS3.p3.4.m4.2.2.1.2.cmml">(</mo><msub id="S4.SS3.p3.4.m4.2.2.1.1.1" xref="S4.SS3.p3.4.m4.2.2.1.1.1.cmml"><mi id="S4.SS3.p3.4.m4.2.2.1.1.1.2" xref="S4.SS3.p3.4.m4.2.2.1.1.1.2.cmml">ω</mi><mtext id="S4.SS3.p3.4.m4.2.2.1.1.1.3" xref="S4.SS3.p3.4.m4.2.2.1.1.1.3a.cmml">global</mtext></msub><mo id="S4.SS3.p3.4.m4.2.2.1.1.3" xref="S4.SS3.p3.4.m4.2.2.1.2.cmml">;</mo><mi id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS3.p3.4.m4.2.2.1.1.4" xref="S4.SS3.p3.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.2b"><apply id="S4.SS3.p3.4.m4.2.2.cmml" xref="S4.SS3.p3.4.m4.2.2"><times id="S4.SS3.p3.4.m4.2.2.2.cmml" xref="S4.SS3.p3.4.m4.2.2.2"></times><ci id="S4.SS3.p3.4.m4.2.2.3.cmml" xref="S4.SS3.p3.4.m4.2.2.3">ℱ</ci><list id="S4.SS3.p3.4.m4.2.2.1.2.cmml" xref="S4.SS3.p3.4.m4.2.2.1.1"><apply id="S4.SS3.p3.4.m4.2.2.1.1.1.cmml" xref="S4.SS3.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.2.2.1.1.1.1.cmml" xref="S4.SS3.p3.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.4.m4.2.2.1.1.1.2.cmml" xref="S4.SS3.p3.4.m4.2.2.1.1.1.2">𝜔</ci><ci id="S4.SS3.p3.4.m4.2.2.1.1.1.3a.cmml" xref="S4.SS3.p3.4.m4.2.2.1.1.1.3"><mtext mathsize="70%" id="S4.SS3.p3.4.m4.2.2.1.1.1.3.cmml" xref="S4.SS3.p3.4.m4.2.2.1.1.1.3">global</mtext></ci></apply><ci id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">𝑥</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.2c">\mathcal{F}(\omega_{\text{global}};x)</annotation></semantics></math>, the accuracy of this model on each client’s test dataset <math id="S4.SS3.p3.5.m5.1" class="ltx_Math" alttext="D_{i}^{\text{test}}" display="inline"><semantics id="S4.SS3.p3.5.m5.1a"><msubsup id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml"><mi id="S4.SS3.p3.5.m5.1.1.2.2" xref="S4.SS3.p3.5.m5.1.1.2.2.cmml">D</mi><mi id="S4.SS3.p3.5.m5.1.1.2.3" xref="S4.SS3.p3.5.m5.1.1.2.3.cmml">i</mi><mtext id="S4.SS3.p3.5.m5.1.1.3" xref="S4.SS3.p3.5.m5.1.1.3a.cmml">test</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><apply id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">superscript</csymbol><apply id="S4.SS3.p3.5.m5.1.1.2.cmml" xref="S4.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.2.1.cmml" xref="S4.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p3.5.m5.1.1.2.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2.2">𝐷</ci><ci id="S4.SS3.p3.5.m5.1.1.2.3.cmml" xref="S4.SS3.p3.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S4.SS3.p3.5.m5.1.1.3a.cmml" xref="S4.SS3.p3.5.m5.1.1.3"><mtext mathsize="70%" id="S4.SS3.p3.5.m5.1.1.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3">test</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">D_{i}^{\text{test}}</annotation></semantics></math> can be calculated. The worst accuracy of the global model, when evaluated across all clients, is then:</p>
<table id="S4.E21" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E21.m1.5" class="ltx_Math" alttext="\text{Lowest Acc}_{\text{global}}=\min_{i}\left(\frac{1}{|D_{i}^{\text{test}}|}\sum_{x\in D_{i}^{\text{test}}}\mathbb{I}\left(y(x)=\mathcal{F}(\omega_{\text{global}};x)\right)\right)" display="block"><semantics id="S4.E21.m1.5a"><mrow id="S4.E21.m1.5.5" xref="S4.E21.m1.5.5.cmml"><msub id="S4.E21.m1.5.5.4" xref="S4.E21.m1.5.5.4.cmml"><mtext id="S4.E21.m1.5.5.4.2" xref="S4.E21.m1.5.5.4.2a.cmml">Lowest Acc</mtext><mtext id="S4.E21.m1.5.5.4.3" xref="S4.E21.m1.5.5.4.3a.cmml">global</mtext></msub><mo id="S4.E21.m1.5.5.3" xref="S4.E21.m1.5.5.3.cmml">=</mo><mrow id="S4.E21.m1.5.5.2.2" xref="S4.E21.m1.5.5.2.3.cmml"><munder id="S4.E21.m1.4.4.1.1.1" xref="S4.E21.m1.4.4.1.1.1.cmml"><mi id="S4.E21.m1.4.4.1.1.1.2" xref="S4.E21.m1.4.4.1.1.1.2.cmml">min</mi><mi id="S4.E21.m1.4.4.1.1.1.3" xref="S4.E21.m1.4.4.1.1.1.3.cmml">i</mi></munder><mo id="S4.E21.m1.5.5.2.2a" xref="S4.E21.m1.5.5.2.3.cmml">⁡</mo><mrow id="S4.E21.m1.5.5.2.2.2" xref="S4.E21.m1.5.5.2.3.cmml"><mo id="S4.E21.m1.5.5.2.2.2.2" xref="S4.E21.m1.5.5.2.3.cmml">(</mo><mrow id="S4.E21.m1.5.5.2.2.2.1" xref="S4.E21.m1.5.5.2.2.2.1.cmml"><mfrac id="S4.E21.m1.1.1" xref="S4.E21.m1.1.1.cmml"><mn id="S4.E21.m1.1.1.3" xref="S4.E21.m1.1.1.3.cmml">1</mn><mrow id="S4.E21.m1.1.1.1.1" xref="S4.E21.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E21.m1.1.1.1.1.2" xref="S4.E21.m1.1.1.1.2.1.cmml">|</mo><msubsup id="S4.E21.m1.1.1.1.1.1" xref="S4.E21.m1.1.1.1.1.1.cmml"><mi id="S4.E21.m1.1.1.1.1.1.2.2" xref="S4.E21.m1.1.1.1.1.1.2.2.cmml">D</mi><mi id="S4.E21.m1.1.1.1.1.1.2.3" xref="S4.E21.m1.1.1.1.1.1.2.3.cmml">i</mi><mtext id="S4.E21.m1.1.1.1.1.1.3" xref="S4.E21.m1.1.1.1.1.1.3a.cmml">test</mtext></msubsup><mo stretchy="false" id="S4.E21.m1.1.1.1.1.3" xref="S4.E21.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E21.m1.5.5.2.2.2.1.2" xref="S4.E21.m1.5.5.2.2.2.1.2.cmml">​</mo><mrow id="S4.E21.m1.5.5.2.2.2.1.1" xref="S4.E21.m1.5.5.2.2.2.1.1.cmml"><munder id="S4.E21.m1.5.5.2.2.2.1.1.2" xref="S4.E21.m1.5.5.2.2.2.1.1.2.cmml"><mo movablelimits="false" id="S4.E21.m1.5.5.2.2.2.1.1.2.2" xref="S4.E21.m1.5.5.2.2.2.1.1.2.2.cmml">∑</mo><mrow id="S4.E21.m1.5.5.2.2.2.1.1.2.3" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.cmml"><mi id="S4.E21.m1.5.5.2.2.2.1.1.2.3.2" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.2.cmml">x</mi><mo id="S4.E21.m1.5.5.2.2.2.1.1.2.3.1" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.1.cmml">∈</mo><msubsup id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.cmml"><mi id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.2.2" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.2.2.cmml">D</mi><mi id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.2.3" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.2.3.cmml">i</mi><mtext id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.3" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.3a.cmml">test</mtext></msubsup></mrow></munder><mrow id="S4.E21.m1.5.5.2.2.2.1.1.1" xref="S4.E21.m1.5.5.2.2.2.1.1.1.cmml"><mi id="S4.E21.m1.5.5.2.2.2.1.1.1.3" xref="S4.E21.m1.5.5.2.2.2.1.1.1.3.cmml">𝕀</mi><mo lspace="0em" rspace="0em" id="S4.E21.m1.5.5.2.2.2.1.1.1.2" xref="S4.E21.m1.5.5.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.2" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.cmml"><mrow id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.2" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.2.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.1" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.3.2" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.3.2.1" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E21.m1.2.2" xref="S4.E21.m1.2.2.cmml">x</mi><mo stretchy="false" id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.3.2.2" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.2" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.3" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.2" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">ω</mi><mtext id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.3a.cmml">global</mtext></msub><mo id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S4.E21.m1.3.3" xref="S4.E21.m1.3.3.cmml">x</mi><mo stretchy="false" id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.4" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.3" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E21.m1.5.5.2.2.2.3" xref="S4.E21.m1.5.5.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E21.m1.5b"><apply id="S4.E21.m1.5.5.cmml" xref="S4.E21.m1.5.5"><eq id="S4.E21.m1.5.5.3.cmml" xref="S4.E21.m1.5.5.3"></eq><apply id="S4.E21.m1.5.5.4.cmml" xref="S4.E21.m1.5.5.4"><csymbol cd="ambiguous" id="S4.E21.m1.5.5.4.1.cmml" xref="S4.E21.m1.5.5.4">subscript</csymbol><ci id="S4.E21.m1.5.5.4.2a.cmml" xref="S4.E21.m1.5.5.4.2"><mtext id="S4.E21.m1.5.5.4.2.cmml" xref="S4.E21.m1.5.5.4.2">Lowest Acc</mtext></ci><ci id="S4.E21.m1.5.5.4.3a.cmml" xref="S4.E21.m1.5.5.4.3"><mtext mathsize="70%" id="S4.E21.m1.5.5.4.3.cmml" xref="S4.E21.m1.5.5.4.3">global</mtext></ci></apply><apply id="S4.E21.m1.5.5.2.3.cmml" xref="S4.E21.m1.5.5.2.2"><apply id="S4.E21.m1.4.4.1.1.1.cmml" xref="S4.E21.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.E21.m1.4.4.1.1.1.1.cmml" xref="S4.E21.m1.4.4.1.1.1">subscript</csymbol><min id="S4.E21.m1.4.4.1.1.1.2.cmml" xref="S4.E21.m1.4.4.1.1.1.2"></min><ci id="S4.E21.m1.4.4.1.1.1.3.cmml" xref="S4.E21.m1.4.4.1.1.1.3">𝑖</ci></apply><apply id="S4.E21.m1.5.5.2.2.2.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1"><times id="S4.E21.m1.5.5.2.2.2.1.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.2"></times><apply id="S4.E21.m1.1.1.cmml" xref="S4.E21.m1.1.1"><divide id="S4.E21.m1.1.1.2.cmml" xref="S4.E21.m1.1.1"></divide><cn type="integer" id="S4.E21.m1.1.1.3.cmml" xref="S4.E21.m1.1.1.3">1</cn><apply id="S4.E21.m1.1.1.1.2.cmml" xref="S4.E21.m1.1.1.1.1"><abs id="S4.E21.m1.1.1.1.2.1.cmml" xref="S4.E21.m1.1.1.1.1.2"></abs><apply id="S4.E21.m1.1.1.1.1.1.cmml" xref="S4.E21.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E21.m1.1.1.1.1.1.1.cmml" xref="S4.E21.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.E21.m1.1.1.1.1.1.2.cmml" xref="S4.E21.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E21.m1.1.1.1.1.1.2.1.cmml" xref="S4.E21.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E21.m1.1.1.1.1.1.2.2.cmml" xref="S4.E21.m1.1.1.1.1.1.2.2">𝐷</ci><ci id="S4.E21.m1.1.1.1.1.1.2.3.cmml" xref="S4.E21.m1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E21.m1.1.1.1.1.1.3a.cmml" xref="S4.E21.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.E21.m1.1.1.1.1.1.3.cmml" xref="S4.E21.m1.1.1.1.1.1.3">test</mtext></ci></apply></apply></apply><apply id="S4.E21.m1.5.5.2.2.2.1.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1"><apply id="S4.E21.m1.5.5.2.2.2.1.1.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E21.m1.5.5.2.2.2.1.1.2.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2">subscript</csymbol><sum id="S4.E21.m1.5.5.2.2.2.1.1.2.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.2"></sum><apply id="S4.E21.m1.5.5.2.2.2.1.1.2.3.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3"><in id="S4.E21.m1.5.5.2.2.2.1.1.2.3.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.1"></in><ci id="S4.E21.m1.5.5.2.2.2.1.1.2.3.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.2">𝑥</ci><apply id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3">superscript</csymbol><apply id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.2.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3">subscript</csymbol><ci id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.2.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.2.2">𝐷</ci><ci id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.2.3.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.2.3">𝑖</ci></apply><ci id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.3a.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.3"><mtext mathsize="50%" id="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.3.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.2.3.3.3">test</mtext></ci></apply></apply></apply><apply id="S4.E21.m1.5.5.2.2.2.1.1.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1"><times id="S4.E21.m1.5.5.2.2.2.1.1.1.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.2"></times><ci id="S4.E21.m1.5.5.2.2.2.1.1.1.3.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.3">𝕀</ci><apply id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1"><eq id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.2"></eq><apply id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3"><times id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.1"></times><ci id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S4.E21.m1.2.2.cmml" xref="S4.E21.m1.2.2">𝑥</ci></apply><apply id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1"><times id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.2"></times><ci id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.3">ℱ</ci><list id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1"><apply id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝜔</ci><ci id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E21.m1.5.5.2.2.2.1.1.1.1.1.1.1.1.1.1.3">global</mtext></ci></apply><ci id="S4.E21.m1.3.3.cmml" xref="S4.E21.m1.3.3">𝑥</ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E21.m1.5c">\text{Lowest Acc}_{\text{global}}=\min_{i}\left(\frac{1}{|D_{i}^{\text{test}}|}\sum_{x\in D_{i}^{\text{test}}}\mathbb{I}\left(y(x)=\mathcal{F}(\omega_{\text{global}};x)\right)\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p">This metric captures the scenario where the globally trained model has its poorest accuracy across client test datasets.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Fairness in heterogenous settings</h3>

<figure id="S5.F2" class="ltx_figure"><img src="/html/2310.09444/assets/x2.png" id="S5.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="332" height="208" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F2.4.2.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S5.F2.2.1" class="ltx_text" style="font-size:90%;">Accuracy analysis of Multi-head encoder alignment mechanism (solid blue curves) vs. Local Stochastic Gradient Descent (SGD) (dashed orange curves) training across various heterogeneity levels. The graph shows higher accuracy improvement in higher heterogeneity levels (i.e. lower <math id="S5.F2.2.1.m1.1" class="ltx_Math" alttext="\alpha_{\mathrm{LDA}}" display="inline"><semantics id="S5.F2.2.1.m1.1b"><msub id="S5.F2.2.1.m1.1.1" xref="S5.F2.2.1.m1.1.1.cmml"><mi id="S5.F2.2.1.m1.1.1.2" xref="S5.F2.2.1.m1.1.1.2.cmml">α</mi><mi id="S5.F2.2.1.m1.1.1.3" xref="S5.F2.2.1.m1.1.1.3.cmml">LDA</mi></msub><annotation-xml encoding="MathML-Content" id="S5.F2.2.1.m1.1c"><apply id="S5.F2.2.1.m1.1.1.cmml" xref="S5.F2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.F2.2.1.m1.1.1.1.cmml" xref="S5.F2.2.1.m1.1.1">subscript</csymbol><ci id="S5.F2.2.1.m1.1.1.2.cmml" xref="S5.F2.2.1.m1.1.1.2">𝛼</ci><ci id="S5.F2.2.1.m1.1.1.3.cmml" xref="S5.F2.2.1.m1.1.1.3">LDA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.2.1.m1.1d">\alpha_{\mathrm{LDA}}</annotation></semantics></math>)</span></figcaption>
</figure>
<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We evaluate the impact of our proposed model on enhancing local models for underrepresented clients as well as for all clients in terms of test accuracy improvement over different rounds. Figure <a href="#S5.F2" title="Figure 2 ‣ 5.1 Fairness in heterogenous settings ‣ 5 Results ‣ Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> demonstrates the difference between using a Multi-head encoder alignment mechanism (solid blue curve) and local SGD training (dashed orange curve). We observed that in highly heterogeneous settings (i.e. lower <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="\alpha_{\mathrm{LDA}}" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><msub id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">α</mi><mi id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">LDA</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">𝛼</ci><ci id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3">LDA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\alpha_{\mathrm{LDA}}</annotation></semantics></math> values), the improvement brought about by our model was more noticeable.The local model typically outperformed traditional settings after the first round, indicating both higher accuracy and rapid convergence rates for our approach, as depicted in the provided figures.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">To compare our proposed method with other federated learning algorithms , we trained the models for 10 rounds with LDA value of 0.2. Each method was evaluated using a cross-entropy loss function for each round. The results were then averaged based on the number of samples per client using a weighted averaging approach. Figure <a href="#S5.F3" title="Figure 3 ‣ 5.1 Fairness in heterogenous settings ‣ 5 Results ‣ Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> provides a comparative analysis of the average loss across various federated learning settings over the initial 10 rounds. As expected, the global model with a centralized data delivers the best performance. Following the global model, FedMHA method outperforms the other federated learning algorithms. FedProx and FedAvg methods exhibit lower performance, with the FedBN approach was the least satisfactory among the considered federated learning algorithms.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2310.09444/assets/x3.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="300" height="204" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.3.2" class="ltx_text" style="font-size:90%;">Comparative analysis of the average loss across various federated learning settings over the initial 10 rounds. This showcases the trajectory of client loss, with the global setting employed as thebenchmark.</span></figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Evaluation for minority clients</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">In this section, we analyze the performance of minority clients in our proposed FedMHA as shown in Figure <a href="#S5.F4" title="Figure 4 ‣ 5.2 Evaluation for minority clients ‣ 5 Results ‣ Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. The purpose of this
study is to highlight the potential struggles of minority clients in heterogeneous data environments. We trained the models independently, and then evaluated them on a benchmark global dataset. Each client was trained on their own local dataset, and subsequently tested against a global dataset.</p>
</div>
<figure id="S5.F4" class="ltx_figure">
<p id="S5.F4.1" class="ltx_p ltx_align_center"><span id="S5.F4.1.1" class="ltx_text ltx_inline-block" style="width:433.6pt;">
<span id="S5.F4.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:982.9pt;height:501.1pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S5.F4.1.1.1.1.1" class="ltx_p"><span id="S5.F4.1.1.1.1.1.1" class="ltx_text ltx_inline-block" style="width:982.9pt;"><img src="/html/2310.09444/assets/x4.png" id="S5.F4.1.1.1.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="1049" height="533" alt="Refer to caption"></span></span>
</span></span></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.3.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.4.2" class="ltx_text" style="font-size:90%;">Comparative loss analysis of our proposed Multi-head encoder alignment mechanism against Local SGD Training in a range of heterogeneity settings. Improved loss reduction is observed in highly heterogeneous environments when incorporating MHA, reflecting the effectiveness of our proposed FedMHA method.</span></figcaption>
</figure>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.46.2.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S5.T1.2.1" class="ltx_text" style="font-size:90%;">Comparison of federated learning methods (Local, FedMHA, FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx17" title="" class="ltx_ref">17</a>]</cite>, FedAvg ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx22" title="" class="ltx_ref">22</a>]</cite>, FedBN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx14" title="" class="ltx_ref">14</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx11" title="" class="ltx_ref">11</a>]</cite>) under different levels of data heterogeneity represented by varying <math id="S5.T1.2.1.m1.1" class="ltx_Math" alttext="\alpha_{\text{LDA}}" display="inline"><semantics id="S5.T1.2.1.m1.1b"><msub id="S5.T1.2.1.m1.1.1" xref="S5.T1.2.1.m1.1.1.cmml"><mi id="S5.T1.2.1.m1.1.1.2" xref="S5.T1.2.1.m1.1.1.2.cmml">α</mi><mtext id="S5.T1.2.1.m1.1.1.3" xref="S5.T1.2.1.m1.1.1.3a.cmml">LDA</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T1.2.1.m1.1c"><apply id="S5.T1.2.1.m1.1.1.cmml" xref="S5.T1.2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.2.1.m1.1.1.1.cmml" xref="S5.T1.2.1.m1.1.1">subscript</csymbol><ci id="S5.T1.2.1.m1.1.1.2.cmml" xref="S5.T1.2.1.m1.1.1.2">𝛼</ci><ci id="S5.T1.2.1.m1.1.1.3a.cmml" xref="S5.T1.2.1.m1.1.1.3"><mtext mathsize="70%" id="S5.T1.2.1.m1.1.1.3.cmml" xref="S5.T1.2.1.m1.1.1.3">LDA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.1.m1.1d">\alpha_{\text{LDA}}</annotation></semantics></math> values. The average accuracies were calculated after 5 rounds of federated learning.</span></figcaption>
<table id="S5.T1.44" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T1.9.7" class="ltx_tr" style="background-color:#D9D9D9;">
<td id="S5.T1.9.7.8" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T1.9.7.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#D9D9D9;">Method</span></td>
<td id="S5.T1.3.1.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.3.1.1.m1.1" class="ltx_Math" style="background-color:#D9D9D9;" alttext="\alpha_{\text{LDA}}" display="inline"><semantics id="S5.T1.3.1.1.m1.1a"><msub id="S5.T1.3.1.1.m1.1.1" xref="S5.T1.3.1.1.m1.1.1.cmml"><mi mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.3.1.1.m1.1.1.2" xref="S5.T1.3.1.1.m1.1.1.2.cmml">α</mi><mtext mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.3.1.1.m1.1.1.3" xref="S5.T1.3.1.1.m1.1.1.3a.cmml">LDA</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T1.3.1.1.m1.1b"><apply id="S5.T1.3.1.1.m1.1.1.cmml" xref="S5.T1.3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.3.1.1.m1.1.1.1.cmml" xref="S5.T1.3.1.1.m1.1.1">subscript</csymbol><ci id="S5.T1.3.1.1.m1.1.1.2.cmml" xref="S5.T1.3.1.1.m1.1.1.2">𝛼</ci><ci id="S5.T1.3.1.1.m1.1.1.3a.cmml" xref="S5.T1.3.1.1.m1.1.1.3"><mtext mathbackground="#D9D9D9" mathsize="63%" id="S5.T1.3.1.1.m1.1.1.3.cmml" xref="S5.T1.3.1.1.m1.1.1.3">LDA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.1.1.m1.1c">\alpha_{\text{LDA}}</annotation></semantics></math><span id="S5.T1.3.1.1.1" class="ltx_text" style="font-size:90%;background-color:#D9D9D9;"> = 0.1</span>
</td>
<td id="S5.T1.4.2.2" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.4.2.2.m1.1" class="ltx_Math" style="background-color:#D9D9D9;" alttext="\alpha_{\text{LDA}}" display="inline"><semantics id="S5.T1.4.2.2.m1.1a"><msub id="S5.T1.4.2.2.m1.1.1" xref="S5.T1.4.2.2.m1.1.1.cmml"><mi mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.4.2.2.m1.1.1.2" xref="S5.T1.4.2.2.m1.1.1.2.cmml">α</mi><mtext mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.4.2.2.m1.1.1.3" xref="S5.T1.4.2.2.m1.1.1.3a.cmml">LDA</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T1.4.2.2.m1.1b"><apply id="S5.T1.4.2.2.m1.1.1.cmml" xref="S5.T1.4.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.4.2.2.m1.1.1.1.cmml" xref="S5.T1.4.2.2.m1.1.1">subscript</csymbol><ci id="S5.T1.4.2.2.m1.1.1.2.cmml" xref="S5.T1.4.2.2.m1.1.1.2">𝛼</ci><ci id="S5.T1.4.2.2.m1.1.1.3a.cmml" xref="S5.T1.4.2.2.m1.1.1.3"><mtext mathbackground="#D9D9D9" mathsize="63%" id="S5.T1.4.2.2.m1.1.1.3.cmml" xref="S5.T1.4.2.2.m1.1.1.3">LDA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.2.2.m1.1c">\alpha_{\text{LDA}}</annotation></semantics></math><span id="S5.T1.4.2.2.1" class="ltx_text" style="font-size:90%;background-color:#D9D9D9;"> = 0.2</span>
</td>
<td id="S5.T1.5.3.3" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.5.3.3.m1.1" class="ltx_Math" style="background-color:#D9D9D9;" alttext="\alpha_{\text{LDA}}" display="inline"><semantics id="S5.T1.5.3.3.m1.1a"><msub id="S5.T1.5.3.3.m1.1.1" xref="S5.T1.5.3.3.m1.1.1.cmml"><mi mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.5.3.3.m1.1.1.2" xref="S5.T1.5.3.3.m1.1.1.2.cmml">α</mi><mtext mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.5.3.3.m1.1.1.3" xref="S5.T1.5.3.3.m1.1.1.3a.cmml">LDA</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T1.5.3.3.m1.1b"><apply id="S5.T1.5.3.3.m1.1.1.cmml" xref="S5.T1.5.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.5.3.3.m1.1.1.1.cmml" xref="S5.T1.5.3.3.m1.1.1">subscript</csymbol><ci id="S5.T1.5.3.3.m1.1.1.2.cmml" xref="S5.T1.5.3.3.m1.1.1.2">𝛼</ci><ci id="S5.T1.5.3.3.m1.1.1.3a.cmml" xref="S5.T1.5.3.3.m1.1.1.3"><mtext mathbackground="#D9D9D9" mathsize="63%" id="S5.T1.5.3.3.m1.1.1.3.cmml" xref="S5.T1.5.3.3.m1.1.1.3">LDA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.3.3.m1.1c">\alpha_{\text{LDA}}</annotation></semantics></math><span id="S5.T1.5.3.3.1" class="ltx_text" style="font-size:90%;background-color:#D9D9D9;"> = 0.3</span>
</td>
<td id="S5.T1.6.4.4" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.6.4.4.m1.1" class="ltx_Math" style="background-color:#D9D9D9;" alttext="\alpha_{\text{LDA}}" display="inline"><semantics id="S5.T1.6.4.4.m1.1a"><msub id="S5.T1.6.4.4.m1.1.1" xref="S5.T1.6.4.4.m1.1.1.cmml"><mi mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.6.4.4.m1.1.1.2" xref="S5.T1.6.4.4.m1.1.1.2.cmml">α</mi><mtext mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.6.4.4.m1.1.1.3" xref="S5.T1.6.4.4.m1.1.1.3a.cmml">LDA</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T1.6.4.4.m1.1b"><apply id="S5.T1.6.4.4.m1.1.1.cmml" xref="S5.T1.6.4.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.6.4.4.m1.1.1.1.cmml" xref="S5.T1.6.4.4.m1.1.1">subscript</csymbol><ci id="S5.T1.6.4.4.m1.1.1.2.cmml" xref="S5.T1.6.4.4.m1.1.1.2">𝛼</ci><ci id="S5.T1.6.4.4.m1.1.1.3a.cmml" xref="S5.T1.6.4.4.m1.1.1.3"><mtext mathbackground="#D9D9D9" mathsize="63%" id="S5.T1.6.4.4.m1.1.1.3.cmml" xref="S5.T1.6.4.4.m1.1.1.3">LDA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.4.4.m1.1c">\alpha_{\text{LDA}}</annotation></semantics></math><span id="S5.T1.6.4.4.1" class="ltx_text" style="font-size:90%;background-color:#D9D9D9;"> = 0.5</span>
</td>
<td id="S5.T1.7.5.5" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.7.5.5.m1.1" class="ltx_Math" style="background-color:#D9D9D9;" alttext="\alpha_{\text{LDA}}" display="inline"><semantics id="S5.T1.7.5.5.m1.1a"><msub id="S5.T1.7.5.5.m1.1.1" xref="S5.T1.7.5.5.m1.1.1.cmml"><mi mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.7.5.5.m1.1.1.2" xref="S5.T1.7.5.5.m1.1.1.2.cmml">α</mi><mtext mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.7.5.5.m1.1.1.3" xref="S5.T1.7.5.5.m1.1.1.3a.cmml">LDA</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T1.7.5.5.m1.1b"><apply id="S5.T1.7.5.5.m1.1.1.cmml" xref="S5.T1.7.5.5.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.7.5.5.m1.1.1.1.cmml" xref="S5.T1.7.5.5.m1.1.1">subscript</csymbol><ci id="S5.T1.7.5.5.m1.1.1.2.cmml" xref="S5.T1.7.5.5.m1.1.1.2">𝛼</ci><ci id="S5.T1.7.5.5.m1.1.1.3a.cmml" xref="S5.T1.7.5.5.m1.1.1.3"><mtext mathbackground="#D9D9D9" mathsize="63%" id="S5.T1.7.5.5.m1.1.1.3.cmml" xref="S5.T1.7.5.5.m1.1.1.3">LDA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.5.5.m1.1c">\alpha_{\text{LDA}}</annotation></semantics></math><span id="S5.T1.7.5.5.1" class="ltx_text" style="font-size:90%;background-color:#D9D9D9;"> = 0.7</span>
</td>
<td id="S5.T1.8.6.6" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.8.6.6.m1.1" class="ltx_Math" style="background-color:#D9D9D9;" alttext="\alpha_{\text{LDA}}" display="inline"><semantics id="S5.T1.8.6.6.m1.1a"><msub id="S5.T1.8.6.6.m1.1.1" xref="S5.T1.8.6.6.m1.1.1.cmml"><mi mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.8.6.6.m1.1.1.2" xref="S5.T1.8.6.6.m1.1.1.2.cmml">α</mi><mtext mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.8.6.6.m1.1.1.3" xref="S5.T1.8.6.6.m1.1.1.3a.cmml">LDA</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T1.8.6.6.m1.1b"><apply id="S5.T1.8.6.6.m1.1.1.cmml" xref="S5.T1.8.6.6.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.8.6.6.m1.1.1.1.cmml" xref="S5.T1.8.6.6.m1.1.1">subscript</csymbol><ci id="S5.T1.8.6.6.m1.1.1.2.cmml" xref="S5.T1.8.6.6.m1.1.1.2">𝛼</ci><ci id="S5.T1.8.6.6.m1.1.1.3a.cmml" xref="S5.T1.8.6.6.m1.1.1.3"><mtext mathbackground="#D9D9D9" mathsize="63%" id="S5.T1.8.6.6.m1.1.1.3.cmml" xref="S5.T1.8.6.6.m1.1.1.3">LDA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.6.6.m1.1c">\alpha_{\text{LDA}}</annotation></semantics></math><span id="S5.T1.8.6.6.1" class="ltx_text" style="font-size:90%;background-color:#D9D9D9;"> = 0.8</span>
</td>
<td id="S5.T1.9.7.7" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.9.7.7.m1.1" class="ltx_Math" style="background-color:#D9D9D9;" alttext="\alpha_{\text{LDA}}" display="inline"><semantics id="S5.T1.9.7.7.m1.1a"><msub id="S5.T1.9.7.7.m1.1.1" xref="S5.T1.9.7.7.m1.1.1.cmml"><mi mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.9.7.7.m1.1.1.2" xref="S5.T1.9.7.7.m1.1.1.2.cmml">α</mi><mtext mathbackground="#D9D9D9" mathsize="90%" id="S5.T1.9.7.7.m1.1.1.3" xref="S5.T1.9.7.7.m1.1.1.3a.cmml">LDA</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T1.9.7.7.m1.1b"><apply id="S5.T1.9.7.7.m1.1.1.cmml" xref="S5.T1.9.7.7.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.9.7.7.m1.1.1.1.cmml" xref="S5.T1.9.7.7.m1.1.1">subscript</csymbol><ci id="S5.T1.9.7.7.m1.1.1.2.cmml" xref="S5.T1.9.7.7.m1.1.1.2">𝛼</ci><ci id="S5.T1.9.7.7.m1.1.1.3a.cmml" xref="S5.T1.9.7.7.m1.1.1.3"><mtext mathbackground="#D9D9D9" mathsize="63%" id="S5.T1.9.7.7.m1.1.1.3.cmml" xref="S5.T1.9.7.7.m1.1.1.3">LDA</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.9.7.7.m1.1c">\alpha_{\text{LDA}}</annotation></semantics></math><span id="S5.T1.9.7.7.1" class="ltx_text" style="font-size:90%;background-color:#D9D9D9;"> = 0.9</span>
</td>
</tr>
<tr id="S5.T1.14.12" class="ltx_tr">
<td id="S5.T1.14.12.6" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S5.T1.14.12.6.1" class="ltx_text" style="font-size:90%;">FedAvg </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T1.14.12.6.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bibx17" title="" class="ltx_ref">17</a><span id="S5.T1.14.12.6.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T1.10.8.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.10.8.1.m1.1" class="ltx_Math" alttext="62.03" display="inline"><semantics id="S5.T1.10.8.1.m1.1a"><mn mathsize="90%" id="S5.T1.10.8.1.m1.1.1" xref="S5.T1.10.8.1.m1.1.1.cmml">62.03</mn><annotation-xml encoding="MathML-Content" id="S5.T1.10.8.1.m1.1b"><cn type="float" id="S5.T1.10.8.1.m1.1.1.cmml" xref="S5.T1.10.8.1.m1.1.1">62.03</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.10.8.1.m1.1c">62.03</annotation></semantics></math><span id="S5.T1.10.8.1.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.11.9.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.11.9.2.m1.1" class="ltx_Math" alttext="65.55" display="inline"><semantics id="S5.T1.11.9.2.m1.1a"><mn mathsize="90%" id="S5.T1.11.9.2.m1.1.1" xref="S5.T1.11.9.2.m1.1.1.cmml">65.55</mn><annotation-xml encoding="MathML-Content" id="S5.T1.11.9.2.m1.1b"><cn type="float" id="S5.T1.11.9.2.m1.1.1.cmml" xref="S5.T1.11.9.2.m1.1.1">65.55</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.11.9.2.m1.1c">65.55</annotation></semantics></math><span id="S5.T1.11.9.2.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.14.12.7" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T1.14.12.7.1" class="ltx_text" style="font-size:90%;color:#0000FF;">80.24%</span></td>
<td id="S5.T1.12.10.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.12.10.3.m1.1" class="ltx_Math" alttext="80.03" display="inline"><semantics id="S5.T1.12.10.3.m1.1a"><mn mathsize="90%" id="S5.T1.12.10.3.m1.1.1" xref="S5.T1.12.10.3.m1.1.1.cmml">80.03</mn><annotation-xml encoding="MathML-Content" id="S5.T1.12.10.3.m1.1b"><cn type="float" id="S5.T1.12.10.3.m1.1.1.cmml" xref="S5.T1.12.10.3.m1.1.1">80.03</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.12.10.3.m1.1c">80.03</annotation></semantics></math><span id="S5.T1.12.10.3.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.13.11.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.13.11.4.m1.1" class="ltx_Math" alttext="72.19" display="inline"><semantics id="S5.T1.13.11.4.m1.1a"><mn mathsize="90%" id="S5.T1.13.11.4.m1.1.1" xref="S5.T1.13.11.4.m1.1.1.cmml">72.19</mn><annotation-xml encoding="MathML-Content" id="S5.T1.13.11.4.m1.1b"><cn type="float" id="S5.T1.13.11.4.m1.1.1.cmml" xref="S5.T1.13.11.4.m1.1.1">72.19</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.13.11.4.m1.1c">72.19</annotation></semantics></math><span id="S5.T1.13.11.4.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.14.12.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.14.12.5.m1.1" class="ltx_Math" alttext="85.79" display="inline"><semantics id="S5.T1.14.12.5.m1.1a"><mn mathsize="90%" id="S5.T1.14.12.5.m1.1.1" xref="S5.T1.14.12.5.m1.1.1.cmml">85.79</mn><annotation-xml encoding="MathML-Content" id="S5.T1.14.12.5.m1.1b"><cn type="float" id="S5.T1.14.12.5.m1.1.1.cmml" xref="S5.T1.14.12.5.m1.1.1">85.79</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.14.12.5.m1.1c">85.79</annotation></semantics></math><span id="S5.T1.14.12.5.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.14.12.8" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T1.14.12.8.1" class="ltx_text" style="font-size:90%;color:#0000FF;">84.94%</span></td>
</tr>
<tr id="S5.T1.21.19" class="ltx_tr">
<td id="S5.T1.21.19.8" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S5.T1.21.19.8.1" class="ltx_text" style="font-size:90%;">FedAvg (ResNet50) </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T1.21.19.8.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bibx22" title="" class="ltx_ref">22</a><span id="S5.T1.21.19.8.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T1.15.13.1" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.15.13.1.m1.1" class="ltx_Math" alttext="52.73" display="inline"><semantics id="S5.T1.15.13.1.m1.1a"><mn mathsize="90%" id="S5.T1.15.13.1.m1.1.1" xref="S5.T1.15.13.1.m1.1.1.cmml">52.73</mn><annotation-xml encoding="MathML-Content" id="S5.T1.15.13.1.m1.1b"><cn type="float" id="S5.T1.15.13.1.m1.1.1.cmml" xref="S5.T1.15.13.1.m1.1.1">52.73</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.15.13.1.m1.1c">52.73</annotation></semantics></math><span id="S5.T1.15.13.1.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.16.14.2" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.16.14.2.m1.1" class="ltx_Math" alttext="61.90" display="inline"><semantics id="S5.T1.16.14.2.m1.1a"><mn mathsize="90%" id="S5.T1.16.14.2.m1.1.1" xref="S5.T1.16.14.2.m1.1.1.cmml">61.90</mn><annotation-xml encoding="MathML-Content" id="S5.T1.16.14.2.m1.1b"><cn type="float" id="S5.T1.16.14.2.m1.1.1.cmml" xref="S5.T1.16.14.2.m1.1.1">61.90</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.16.14.2.m1.1c">61.90</annotation></semantics></math><span id="S5.T1.16.14.2.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.17.15.3" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.17.15.3.m1.1" class="ltx_Math" alttext="69.25" display="inline"><semantics id="S5.T1.17.15.3.m1.1a"><mn mathsize="90%" id="S5.T1.17.15.3.m1.1.1" xref="S5.T1.17.15.3.m1.1.1.cmml">69.25</mn><annotation-xml encoding="MathML-Content" id="S5.T1.17.15.3.m1.1b"><cn type="float" id="S5.T1.17.15.3.m1.1.1.cmml" xref="S5.T1.17.15.3.m1.1.1">69.25</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.17.15.3.m1.1c">69.25</annotation></semantics></math><span id="S5.T1.17.15.3.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.18.16.4" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.18.16.4.m1.1" class="ltx_Math" alttext="76.88" display="inline"><semantics id="S5.T1.18.16.4.m1.1a"><mn mathsize="90%" id="S5.T1.18.16.4.m1.1.1" xref="S5.T1.18.16.4.m1.1.1.cmml">76.88</mn><annotation-xml encoding="MathML-Content" id="S5.T1.18.16.4.m1.1b"><cn type="float" id="S5.T1.18.16.4.m1.1.1.cmml" xref="S5.T1.18.16.4.m1.1.1">76.88</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.18.16.4.m1.1c">76.88</annotation></semantics></math><span id="S5.T1.18.16.4.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.19.17.5" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.19.17.5.m1.1" class="ltx_Math" alttext="76.06" display="inline"><semantics id="S5.T1.19.17.5.m1.1a"><mn mathsize="90%" id="S5.T1.19.17.5.m1.1.1" xref="S5.T1.19.17.5.m1.1.1.cmml">76.06</mn><annotation-xml encoding="MathML-Content" id="S5.T1.19.17.5.m1.1b"><cn type="float" id="S5.T1.19.17.5.m1.1.1.cmml" xref="S5.T1.19.17.5.m1.1.1">76.06</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.19.17.5.m1.1c">76.06</annotation></semantics></math><span id="S5.T1.19.17.5.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.20.18.6" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.20.18.6.m1.1" class="ltx_Math" alttext="85.20" display="inline"><semantics id="S5.T1.20.18.6.m1.1a"><mn mathsize="90%" id="S5.T1.20.18.6.m1.1.1" xref="S5.T1.20.18.6.m1.1.1.cmml">85.20</mn><annotation-xml encoding="MathML-Content" id="S5.T1.20.18.6.m1.1b"><cn type="float" id="S5.T1.20.18.6.m1.1.1.cmml" xref="S5.T1.20.18.6.m1.1.1">85.20</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.20.18.6.m1.1c">85.20</annotation></semantics></math><span id="S5.T1.20.18.6.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.21.19.7" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.21.19.7.m1.1" class="ltx_Math" alttext="84.05" display="inline"><semantics id="S5.T1.21.19.7.m1.1a"><mn mathsize="90%" id="S5.T1.21.19.7.m1.1.1" xref="S5.T1.21.19.7.m1.1.1.cmml">84.05</mn><annotation-xml encoding="MathML-Content" id="S5.T1.21.19.7.m1.1b"><cn type="float" id="S5.T1.21.19.7.m1.1.1.cmml" xref="S5.T1.21.19.7.m1.1.1">84.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.21.19.7.m1.1c">84.05</annotation></semantics></math><span id="S5.T1.21.19.7.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
</tr>
<tr id="S5.T1.28.26" class="ltx_tr">
<td id="S5.T1.28.26.8" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S5.T1.28.26.8.1" class="ltx_text" style="font-size:90%;">FedBN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T1.28.26.8.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bibx14" title="" class="ltx_ref">14</a><span id="S5.T1.28.26.8.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T1.22.20.1" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.22.20.1.m1.1" class="ltx_Math" alttext="47.89" display="inline"><semantics id="S5.T1.22.20.1.m1.1a"><mn mathsize="90%" id="S5.T1.22.20.1.m1.1.1" xref="S5.T1.22.20.1.m1.1.1.cmml">47.89</mn><annotation-xml encoding="MathML-Content" id="S5.T1.22.20.1.m1.1b"><cn type="float" id="S5.T1.22.20.1.m1.1.1.cmml" xref="S5.T1.22.20.1.m1.1.1">47.89</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.22.20.1.m1.1c">47.89</annotation></semantics></math><span id="S5.T1.22.20.1.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.23.21.2" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.23.21.2.m1.1" class="ltx_Math" alttext="65.97" display="inline"><semantics id="S5.T1.23.21.2.m1.1a"><mn mathsize="90%" id="S5.T1.23.21.2.m1.1.1" xref="S5.T1.23.21.2.m1.1.1.cmml">65.97</mn><annotation-xml encoding="MathML-Content" id="S5.T1.23.21.2.m1.1b"><cn type="float" id="S5.T1.23.21.2.m1.1.1.cmml" xref="S5.T1.23.21.2.m1.1.1">65.97</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.23.21.2.m1.1c">65.97</annotation></semantics></math><span id="S5.T1.23.21.2.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.24.22.3" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.24.22.3.m1.1" class="ltx_Math" alttext="60.93" display="inline"><semantics id="S5.T1.24.22.3.m1.1a"><mn mathsize="90%" id="S5.T1.24.22.3.m1.1.1" xref="S5.T1.24.22.3.m1.1.1.cmml">60.93</mn><annotation-xml encoding="MathML-Content" id="S5.T1.24.22.3.m1.1b"><cn type="float" id="S5.T1.24.22.3.m1.1.1.cmml" xref="S5.T1.24.22.3.m1.1.1">60.93</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.24.22.3.m1.1c">60.93</annotation></semantics></math><span id="S5.T1.24.22.3.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.25.23.4" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.25.23.4.m1.1" class="ltx_Math" alttext="63.45" display="inline"><semantics id="S5.T1.25.23.4.m1.1a"><mn mathsize="90%" id="S5.T1.25.23.4.m1.1.1" xref="S5.T1.25.23.4.m1.1.1.cmml">63.45</mn><annotation-xml encoding="MathML-Content" id="S5.T1.25.23.4.m1.1b"><cn type="float" id="S5.T1.25.23.4.m1.1.1.cmml" xref="S5.T1.25.23.4.m1.1.1">63.45</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.25.23.4.m1.1c">63.45</annotation></semantics></math><span id="S5.T1.25.23.4.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.26.24.5" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.26.24.5.m1.1" class="ltx_Math" alttext="61.15" display="inline"><semantics id="S5.T1.26.24.5.m1.1a"><mn mathsize="90%" id="S5.T1.26.24.5.m1.1.1" xref="S5.T1.26.24.5.m1.1.1.cmml">61.15</mn><annotation-xml encoding="MathML-Content" id="S5.T1.26.24.5.m1.1b"><cn type="float" id="S5.T1.26.24.5.m1.1.1.cmml" xref="S5.T1.26.24.5.m1.1.1">61.15</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.26.24.5.m1.1c">61.15</annotation></semantics></math><span id="S5.T1.26.24.5.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.27.25.6" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.27.25.6.m1.1" class="ltx_Math" alttext="74.05" display="inline"><semantics id="S5.T1.27.25.6.m1.1a"><mn mathsize="90%" id="S5.T1.27.25.6.m1.1.1" xref="S5.T1.27.25.6.m1.1.1.cmml">74.05</mn><annotation-xml encoding="MathML-Content" id="S5.T1.27.25.6.m1.1b"><cn type="float" id="S5.T1.27.25.6.m1.1.1.cmml" xref="S5.T1.27.25.6.m1.1.1">74.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.27.25.6.m1.1c">74.05</annotation></semantics></math><span id="S5.T1.27.25.6.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.28.26.7" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.28.26.7.m1.1" class="ltx_Math" alttext="74.10" display="inline"><semantics id="S5.T1.28.26.7.m1.1a"><mn mathsize="90%" id="S5.T1.28.26.7.m1.1.1" xref="S5.T1.28.26.7.m1.1.1.cmml">74.10</mn><annotation-xml encoding="MathML-Content" id="S5.T1.28.26.7.m1.1b"><cn type="float" id="S5.T1.28.26.7.m1.1.1.cmml" xref="S5.T1.28.26.7.m1.1.1">74.10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.28.26.7.m1.1c">74.10</annotation></semantics></math><span id="S5.T1.28.26.7.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
</tr>
<tr id="S5.T1.35.33" class="ltx_tr">
<td id="S5.T1.35.33.8" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S5.T1.35.33.8.1" class="ltx_text" style="font-size:90%;">FedProx </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T1.35.33.8.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bibx11" title="" class="ltx_ref">11</a><span id="S5.T1.35.33.8.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T1.29.27.1" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.29.27.1.m1.1" class="ltx_Math" alttext="47.18" display="inline"><semantics id="S5.T1.29.27.1.m1.1a"><mn mathsize="90%" id="S5.T1.29.27.1.m1.1.1" xref="S5.T1.29.27.1.m1.1.1.cmml">47.18</mn><annotation-xml encoding="MathML-Content" id="S5.T1.29.27.1.m1.1b"><cn type="float" id="S5.T1.29.27.1.m1.1.1.cmml" xref="S5.T1.29.27.1.m1.1.1">47.18</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.29.27.1.m1.1c">47.18</annotation></semantics></math><span id="S5.T1.29.27.1.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.30.28.2" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.30.28.2.m1.1" class="ltx_Math" alttext="67.42" display="inline"><semantics id="S5.T1.30.28.2.m1.1a"><mn mathsize="90%" id="S5.T1.30.28.2.m1.1.1" xref="S5.T1.30.28.2.m1.1.1.cmml">67.42</mn><annotation-xml encoding="MathML-Content" id="S5.T1.30.28.2.m1.1b"><cn type="float" id="S5.T1.30.28.2.m1.1.1.cmml" xref="S5.T1.30.28.2.m1.1.1">67.42</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.30.28.2.m1.1c">67.42</annotation></semantics></math><span id="S5.T1.30.28.2.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.31.29.3" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.31.29.3.m1.1" class="ltx_Math" alttext="62.99" display="inline"><semantics id="S5.T1.31.29.3.m1.1a"><mn mathsize="90%" id="S5.T1.31.29.3.m1.1.1" xref="S5.T1.31.29.3.m1.1.1.cmml">62.99</mn><annotation-xml encoding="MathML-Content" id="S5.T1.31.29.3.m1.1b"><cn type="float" id="S5.T1.31.29.3.m1.1.1.cmml" xref="S5.T1.31.29.3.m1.1.1">62.99</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.31.29.3.m1.1c">62.99</annotation></semantics></math><span id="S5.T1.31.29.3.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.32.30.4" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.32.30.4.m1.1" class="ltx_Math" alttext="72.72" display="inline"><semantics id="S5.T1.32.30.4.m1.1a"><mn mathsize="90%" id="S5.T1.32.30.4.m1.1.1" xref="S5.T1.32.30.4.m1.1.1.cmml">72.72</mn><annotation-xml encoding="MathML-Content" id="S5.T1.32.30.4.m1.1b"><cn type="float" id="S5.T1.32.30.4.m1.1.1.cmml" xref="S5.T1.32.30.4.m1.1.1">72.72</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.32.30.4.m1.1c">72.72</annotation></semantics></math><span id="S5.T1.32.30.4.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.33.31.5" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.33.31.5.m1.1" class="ltx_Math" alttext="71.00" display="inline"><semantics id="S5.T1.33.31.5.m1.1a"><mn mathsize="90%" id="S5.T1.33.31.5.m1.1.1" xref="S5.T1.33.31.5.m1.1.1.cmml">71.00</mn><annotation-xml encoding="MathML-Content" id="S5.T1.33.31.5.m1.1b"><cn type="float" id="S5.T1.33.31.5.m1.1.1.cmml" xref="S5.T1.33.31.5.m1.1.1">71.00</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.33.31.5.m1.1c">71.00</annotation></semantics></math><span id="S5.T1.33.31.5.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.34.32.6" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.34.32.6.m1.1" class="ltx_Math" alttext="83.89" display="inline"><semantics id="S5.T1.34.32.6.m1.1a"><mn mathsize="90%" id="S5.T1.34.32.6.m1.1.1" xref="S5.T1.34.32.6.m1.1.1.cmml">83.89</mn><annotation-xml encoding="MathML-Content" id="S5.T1.34.32.6.m1.1b"><cn type="float" id="S5.T1.34.32.6.m1.1.1.cmml" xref="S5.T1.34.32.6.m1.1.1">83.89</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.34.32.6.m1.1c">83.89</annotation></semantics></math><span id="S5.T1.34.32.6.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.35.33.7" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.35.33.7.m1.1" class="ltx_Math" alttext="80.43" display="inline"><semantics id="S5.T1.35.33.7.m1.1a"><mn mathsize="90%" id="S5.T1.35.33.7.m1.1.1" xref="S5.T1.35.33.7.m1.1.1.cmml">80.43</mn><annotation-xml encoding="MathML-Content" id="S5.T1.35.33.7.m1.1b"><cn type="float" id="S5.T1.35.33.7.m1.1.1.cmml" xref="S5.T1.35.33.7.m1.1.1">80.43</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.35.33.7.m1.1c">80.43</annotation></semantics></math><span id="S5.T1.35.33.7.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
</tr>
<tr id="S5.T1.37.35" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S5.T1.37.35.3" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T1.37.35.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#E6E6E6;">FedMHA (ours)</span></td>
<td id="S5.T1.37.35.4" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T1.37.35.4.1" class="ltx_text" style="font-size:90%;color:#0000FF;background-color:#E6E6E6;">67.09%</span></td>
<td id="S5.T1.37.35.5" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T1.37.35.5.1" class="ltx_text" style="font-size:90%;color:#0000FF;background-color:#E6E6E6;">74.23%</span></td>
<td id="S5.T1.36.34.1" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.36.34.1.m1.1" class="ltx_Math" style="background-color:#E6E6E6;" alttext="70.12" display="inline"><semantics id="S5.T1.36.34.1.m1.1a"><mn mathbackground="#E6E6E6" mathsize="90%" id="S5.T1.36.34.1.m1.1.1" xref="S5.T1.36.34.1.m1.1.1.cmml">70.12</mn><annotation-xml encoding="MathML-Content" id="S5.T1.36.34.1.m1.1b"><cn type="float" id="S5.T1.36.34.1.m1.1.1.cmml" xref="S5.T1.36.34.1.m1.1.1">70.12</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.36.34.1.m1.1c">70.12</annotation></semantics></math><span id="S5.T1.36.34.1.1" class="ltx_text" style="font-size:90%;background-color:#E6E6E6;">%</span>
</td>
<td id="S5.T1.37.35.6" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T1.37.35.6.1" class="ltx_text" style="font-size:90%;color:#0000FF;background-color:#E6E6E6;">81.84%</span></td>
<td id="S5.T1.37.35.7" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T1.37.35.7.1" class="ltx_text" style="font-size:90%;color:#0000FF;background-color:#E6E6E6;">77.96%</span></td>
<td id="S5.T1.37.35.8" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T1.37.35.8.1" class="ltx_text" style="font-size:90%;color:#0000FF;background-color:#E6E6E6;">87.76%</span></td>
<td id="S5.T1.37.35.2" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.37.35.2.m1.1" class="ltx_Math" style="background-color:#E6E6E6;" alttext="83.99" display="inline"><semantics id="S5.T1.37.35.2.m1.1a"><mn mathbackground="#E6E6E6" mathsize="90%" id="S5.T1.37.35.2.m1.1.1" xref="S5.T1.37.35.2.m1.1.1.cmml">83.99</mn><annotation-xml encoding="MathML-Content" id="S5.T1.37.35.2.m1.1b"><cn type="float" id="S5.T1.37.35.2.m1.1.1.cmml" xref="S5.T1.37.35.2.m1.1.1">83.99</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.37.35.2.m1.1c">83.99</annotation></semantics></math><span id="S5.T1.37.35.2.1" class="ltx_text" style="font-size:90%;background-color:#E6E6E6;">%</span>
</td>
</tr>
<tr id="S5.T1.44.42" class="ltx_tr">
<td id="S5.T1.44.42.8" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T1.44.42.8.1" class="ltx_text" style="font-size:90%;">Local</span></td>
<td id="S5.T1.38.36.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.38.36.1.m1.1" class="ltx_Math" alttext="18.08" display="inline"><semantics id="S5.T1.38.36.1.m1.1a"><mn mathsize="90%" id="S5.T1.38.36.1.m1.1.1" xref="S5.T1.38.36.1.m1.1.1.cmml">18.08</mn><annotation-xml encoding="MathML-Content" id="S5.T1.38.36.1.m1.1b"><cn type="float" id="S5.T1.38.36.1.m1.1.1.cmml" xref="S5.T1.38.36.1.m1.1.1">18.08</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.38.36.1.m1.1c">18.08</annotation></semantics></math><span id="S5.T1.38.36.1.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.39.37.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.39.37.2.m1.1" class="ltx_Math" alttext="17.85" display="inline"><semantics id="S5.T1.39.37.2.m1.1a"><mn mathsize="90%" id="S5.T1.39.37.2.m1.1.1" xref="S5.T1.39.37.2.m1.1.1.cmml">17.85</mn><annotation-xml encoding="MathML-Content" id="S5.T1.39.37.2.m1.1b"><cn type="float" id="S5.T1.39.37.2.m1.1.1.cmml" xref="S5.T1.39.37.2.m1.1.1">17.85</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.39.37.2.m1.1c">17.85</annotation></semantics></math><span id="S5.T1.39.37.2.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.40.38.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.40.38.3.m1.1" class="ltx_Math" alttext="28.60" display="inline"><semantics id="S5.T1.40.38.3.m1.1a"><mn mathsize="90%" id="S5.T1.40.38.3.m1.1.1" xref="S5.T1.40.38.3.m1.1.1.cmml">28.60</mn><annotation-xml encoding="MathML-Content" id="S5.T1.40.38.3.m1.1b"><cn type="float" id="S5.T1.40.38.3.m1.1.1.cmml" xref="S5.T1.40.38.3.m1.1.1">28.60</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.40.38.3.m1.1c">28.60</annotation></semantics></math><span id="S5.T1.40.38.3.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.41.39.4" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.41.39.4.m1.1" class="ltx_Math" alttext="46.54" display="inline"><semantics id="S5.T1.41.39.4.m1.1a"><mn mathsize="90%" id="S5.T1.41.39.4.m1.1.1" xref="S5.T1.41.39.4.m1.1.1.cmml">46.54</mn><annotation-xml encoding="MathML-Content" id="S5.T1.41.39.4.m1.1b"><cn type="float" id="S5.T1.41.39.4.m1.1.1.cmml" xref="S5.T1.41.39.4.m1.1.1">46.54</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.41.39.4.m1.1c">46.54</annotation></semantics></math><span id="S5.T1.41.39.4.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.42.40.5" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.42.40.5.m1.1" class="ltx_Math" alttext="50.77" display="inline"><semantics id="S5.T1.42.40.5.m1.1a"><mn mathsize="90%" id="S5.T1.42.40.5.m1.1.1" xref="S5.T1.42.40.5.m1.1.1.cmml">50.77</mn><annotation-xml encoding="MathML-Content" id="S5.T1.42.40.5.m1.1b"><cn type="float" id="S5.T1.42.40.5.m1.1.1.cmml" xref="S5.T1.42.40.5.m1.1.1">50.77</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.42.40.5.m1.1c">50.77</annotation></semantics></math><span id="S5.T1.42.40.5.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.43.41.6" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.43.41.6.m1.1" class="ltx_Math" alttext="36.67" display="inline"><semantics id="S5.T1.43.41.6.m1.1a"><mn mathsize="90%" id="S5.T1.43.41.6.m1.1.1" xref="S5.T1.43.41.6.m1.1.1.cmml">36.67</mn><annotation-xml encoding="MathML-Content" id="S5.T1.43.41.6.m1.1b"><cn type="float" id="S5.T1.43.41.6.m1.1.1.cmml" xref="S5.T1.43.41.6.m1.1.1">36.67</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.43.41.6.m1.1c">36.67</annotation></semantics></math><span id="S5.T1.43.41.6.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T1.44.42.7" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T1.44.42.7.m1.1" class="ltx_Math" alttext="54.74" display="inline"><semantics id="S5.T1.44.42.7.m1.1a"><mn mathsize="90%" id="S5.T1.44.42.7.m1.1.1" xref="S5.T1.44.42.7.m1.1.1.cmml">54.74</mn><annotation-xml encoding="MathML-Content" id="S5.T1.44.42.7.m1.1b"><cn type="float" id="S5.T1.44.42.7.m1.1.1.cmml" xref="S5.T1.44.42.7.m1.1.1">54.74</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.44.42.7.m1.1c">54.74</annotation></semantics></math><span id="S5.T1.44.42.7.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
</tr>
</table>
</figure>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.3" class="ltx_p">Table <a href="#S5.T1" title="Table 1 ‣ 5.2 Evaluation for minority clients ‣ 5 Results ‣ Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> provides a comparison of various federated learning methods, including our proposed FedMHA method, under different heterogeneity levels, represented by varying <math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="\alpha_{\mathrm{LDA}}" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><msub id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml"><mi id="S5.SS2.p2.1.m1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.2.cmml">α</mi><mi id="S5.SS2.p2.1.m1.1.1.3" xref="S5.SS2.p2.1.m1.1.1.3.cmml">LDA</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><apply id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.1.m1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p2.1.m1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2">𝛼</ci><ci id="S5.SS2.p2.1.m1.1.1.3.cmml" xref="S5.SS2.p2.1.m1.1.1.3">LDA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\alpha_{\mathrm{LDA}}</annotation></semantics></math> values. The table highlights the average accuracies achieved after 5 rounds of federated learning.A detailed analysis of these results reveals that while all models generally improve their performance as the <math id="S5.SS2.p2.2.m2.1" class="ltx_Math" alttext="\alpha_{\mathrm{LDA}}" display="inline"><semantics id="S5.SS2.p2.2.m2.1a"><msub id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml"><mi id="S5.SS2.p2.2.m2.1.1.2" xref="S5.SS2.p2.2.m2.1.1.2.cmml">α</mi><mi id="S5.SS2.p2.2.m2.1.1.3" xref="S5.SS2.p2.2.m2.1.1.3.cmml">LDA</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><apply id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.2.m2.1.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p2.2.m2.1.1.2.cmml" xref="S5.SS2.p2.2.m2.1.1.2">𝛼</ci><ci id="S5.SS2.p2.2.m2.1.1.3.cmml" xref="S5.SS2.p2.2.m2.1.1.3">LDA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">\alpha_{\mathrm{LDA}}</annotation></semantics></math> value increases (corresponding to a more homogeneous data distribution), the FedMHA outperforms all other models, particularly in low <math id="S5.SS2.p2.3.m3.1" class="ltx_Math" alttext="\alpha_{\mathrm{LDA}}" display="inline"><semantics id="S5.SS2.p2.3.m3.1a"><msub id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml"><mi id="S5.SS2.p2.3.m3.1.1.2" xref="S5.SS2.p2.3.m3.1.1.2.cmml">α</mi><mi id="S5.SS2.p2.3.m3.1.1.3" xref="S5.SS2.p2.3.m3.1.1.3.cmml">LDA</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.1b"><apply id="S5.SS2.p2.3.m3.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.3.m3.1.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS2.p2.3.m3.1.1.2.cmml" xref="S5.SS2.p2.3.m3.1.1.2">𝛼</ci><ci id="S5.SS2.p2.3.m3.1.1.3.cmml" xref="S5.SS2.p2.3.m3.1.1.3">LDA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.1c">\alpha_{\mathrm{LDA}}</annotation></semantics></math> values.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p">We conduct a side-by-side comparison with other models to analyze their personlization for various models, as shown in Figure <a href="#S5.F5" title="Figure 5 ‣ 5.2 Evaluation for minority clients ‣ 5 Results ‣ Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. The experiments are carried out at different alpha levels and measured the average test accuracy for all clients. Our model is represented by the blue area, while the other models are depicted with a yellow area, and the overlapping area in green. Each dot in the figure represents the mean accuracy across all clients for each level of heterogeneity. The area stretching from bottom to top illustrates the range of accuracy for the ten clients involved, with a narrower area signifying a fairer model.</p>
</div>
<figure id="S5.F5" class="ltx_figure">
<p id="S5.F5.1" class="ltx_p ltx_align_center"><span id="S5.F5.1.1" class="ltx_text ltx_inline-block" style="width:433.6pt;">
<span id="S5.F5.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:1233.6pt;height:325.5pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S5.F5.1.1.1.1.1" class="ltx_p"><span id="S5.F5.1.1.1.1.1.1" class="ltx_text ltx_inline-block" style="width:1233.6pt;"><img src="/html/2310.09444/assets/x5.png" id="S5.F5.1.1.1.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="1316" height="347" alt="Refer to caption"></span></span>
</span></span></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.3.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S5.F5.4.2" class="ltx_text" style="font-size:90%;">Comparison of fairness in Federated Learning strategies across heterogeneity levels. Dots represent the mean accuracy for each level. The vertical stretch signifies the accuracy range for the 10 clients, with a narrower area indicating a fairer model. Our method (blue) generally outperforms other models (green), particularly in the 0.1 setting.</span></figcaption>
</figure>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p">The top line of our model is also higher, indicating that the performance of our method is better in Vision Transformers for various clients, particularly in the 0.1 setting. The maximum accuracy achieved for these clients is around 0.4%, while the minimum is close to zero. As the alpha value increases, the area becomes narrower, signifying that the personalization benefits are more pronounced for better-performing clients. To get a better understanding of the fairness, we explore the effect of three components of our training process.</p>
</div>
<div id="S5.SS2.p5" class="ltx_para">
<p id="S5.SS2.p5.1" class="ltx_p"><span id="S5.SS2.p5.1.1" class="ltx_text ltx_font_bold">Weighted averaging boosts the effect of alignment</span> The first component of our investigation targets the effect of the averaging paradigm. A comparison has been made between using weighted averaging, where updates from each client are weighted by the size of their respective training sample, and a more straightforward scenario where all updates are given equal weight. The results are shown in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:table:weighted_averaging</span>. FedMHA shows the most noticeable enhancements when weighted averaging is employed.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S5.T2.60.3.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S5.T2.4.2" class="ltx_text" style="font-size:90%;">Analysis of various federated learning models (FedMHA, FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx17" title="" class="ltx_ref">17</a>]</cite>, FedAvg ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx22" title="" class="ltx_ref">22</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx11" title="" class="ltx_ref">11</a>]</cite>, FedBN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx14" title="" class="ltx_ref">14</a>]</cite>, Local) with and without weighted averaging across different numbers of clients (2, 5, 8). Evaluations are made with FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx17" title="" class="ltx_ref">17</a>]</cite> as baseline, with improvements and declines represented by 
<span id="S5.T2.3.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<span id="S5.T2.3.1.1.1" class="ltx_p"><math id="S5.T2.3.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.3.1.1.1.m1.1b"><mo mathcolor="#00FF00" stretchy="false" id="S5.T2.3.1.1.1.m1.1.1" xref="S5.T2.3.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.1.1.1.m1.1c"><ci id="S5.T2.3.1.1.1.m1.1.1.cmml" xref="S5.T2.3.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.1.1.1.m1.1d">\uparrow</annotation></semantics></math></span>
</span></span> and 
<span id="S5.T2.4.2.2" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<span id="S5.T2.4.2.2.1" class="ltx_p"><math id="S5.T2.4.2.2.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.4.2.2.1.m1.1b"><mo mathcolor="#FF0000" stretchy="false" id="S5.T2.4.2.2.1.m1.1.1" xref="S5.T2.4.2.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.2.2.1.m1.1c"><ci id="S5.T2.4.2.2.1.m1.1.1.cmml" xref="S5.T2.4.2.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.2.2.1.m1.1d">\downarrow</annotation></semantics></math></span>
</span></span> respectively.</span></figcaption>
<table id="S5.T2.58" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T2.58.55" class="ltx_tr" style="background-color:#D9D9D9;">
<td id="S5.T2.58.55.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.58.55.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#D9D9D9;">Method</span></td>
<td id="S5.T2.58.55.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;" colspan="3"><span id="S5.T2.58.55.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#D9D9D9;">W/O Weighted Averaging</span></td>
<td id="S5.T2.58.55.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:4.0pt;padding-right:4.0pt;" colspan="3"><span id="S5.T2.58.55.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#D9D9D9;">With Weighted Averaging</span></td>
</tr>
<tr id="S5.T2.58.56" class="ltx_tr">
<td id="S5.T2.58.56.1" class="ltx_td" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td id="S5.T2.58.56.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.58.56.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#D9D9D9;">2 Clients</span></td>
<td id="S5.T2.58.56.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.58.56.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#D9D9D9;">5 Clients</span></td>
<td id="S5.T2.58.56.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.58.56.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#D9D9D9;">8 Clients</span></td>
<td id="S5.T2.58.56.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.58.56.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#D9D9D9;">2 Clients</span></td>
<td id="S5.T2.58.56.6" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.58.56.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#D9D9D9;">5 Clients</span></td>
<td id="S5.T2.58.56.7" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.58.56.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#D9D9D9;">8 Clients</span></td>
</tr>
<tr id="S5.T2.10.6" class="ltx_tr">
<td id="S5.T2.10.6.7" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S5.T2.10.6.7.1" class="ltx_text" style="font-size:90%;">FedAvg </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.10.6.7.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bibx17" title="" class="ltx_ref">17</a><span id="S5.T2.10.6.7.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T2.5.1.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.5.1.1.m1.1" class="ltx_Math" alttext="63.67" display="inline"><semantics id="S5.T2.5.1.1.m1.1a"><mn mathsize="90%" id="S5.T2.5.1.1.m1.1.1" xref="S5.T2.5.1.1.m1.1.1.cmml">63.67</mn><annotation-xml encoding="MathML-Content" id="S5.T2.5.1.1.m1.1b"><cn type="float" id="S5.T2.5.1.1.m1.1.1.cmml" xref="S5.T2.5.1.1.m1.1.1">63.67</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.1.1.m1.1c">63.67</annotation></semantics></math><span id="S5.T2.5.1.1.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T2.6.2.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.6.2.2.m1.1" class="ltx_Math" alttext="61.51" display="inline"><semantics id="S5.T2.6.2.2.m1.1a"><mn mathsize="90%" id="S5.T2.6.2.2.m1.1.1" xref="S5.T2.6.2.2.m1.1.1.cmml">61.51</mn><annotation-xml encoding="MathML-Content" id="S5.T2.6.2.2.m1.1b"><cn type="float" id="S5.T2.6.2.2.m1.1.1.cmml" xref="S5.T2.6.2.2.m1.1.1">61.51</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.2.2.m1.1c">61.51</annotation></semantics></math><span id="S5.T2.6.2.2.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T2.7.3.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.7.3.3.m1.1" class="ltx_Math" alttext="61.70" display="inline"><semantics id="S5.T2.7.3.3.m1.1a"><mn mathsize="90%" id="S5.T2.7.3.3.m1.1.1" xref="S5.T2.7.3.3.m1.1.1.cmml">61.70</mn><annotation-xml encoding="MathML-Content" id="S5.T2.7.3.3.m1.1b"><cn type="float" id="S5.T2.7.3.3.m1.1.1.cmml" xref="S5.T2.7.3.3.m1.1.1">61.70</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.3.3.m1.1c">61.70</annotation></semantics></math><span id="S5.T2.7.3.3.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T2.8.4.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.8.4.4.m1.1" class="ltx_Math" alttext="79.55" display="inline"><semantics id="S5.T2.8.4.4.m1.1a"><mn mathsize="90%" id="S5.T2.8.4.4.m1.1.1" xref="S5.T2.8.4.4.m1.1.1.cmml">79.55</mn><annotation-xml encoding="MathML-Content" id="S5.T2.8.4.4.m1.1b"><cn type="float" id="S5.T2.8.4.4.m1.1.1.cmml" xref="S5.T2.8.4.4.m1.1.1">79.55</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.4.4.m1.1c">79.55</annotation></semantics></math><span id="S5.T2.8.4.4.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T2.9.5.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.9.5.5.m1.1" class="ltx_Math" alttext="76.36" display="inline"><semantics id="S5.T2.9.5.5.m1.1a"><mn mathsize="90%" id="S5.T2.9.5.5.m1.1.1" xref="S5.T2.9.5.5.m1.1.1.cmml">76.36</mn><annotation-xml encoding="MathML-Content" id="S5.T2.9.5.5.m1.1b"><cn type="float" id="S5.T2.9.5.5.m1.1.1.cmml" xref="S5.T2.9.5.5.m1.1.1">76.36</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.5.5.m1.1c">76.36</annotation></semantics></math><span id="S5.T2.9.5.5.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T2.10.6.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.10.6.6.m1.1" class="ltx_Math" alttext="76.36" display="inline"><semantics id="S5.T2.10.6.6.m1.1a"><mn mathsize="90%" id="S5.T2.10.6.6.m1.1.1" xref="S5.T2.10.6.6.m1.1.1.cmml">76.36</mn><annotation-xml encoding="MathML-Content" id="S5.T2.10.6.6.m1.1b"><cn type="float" id="S5.T2.10.6.6.m1.1.1.cmml" xref="S5.T2.10.6.6.m1.1.1">76.36</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.6.6.m1.1c">76.36</annotation></semantics></math><span id="S5.T2.10.6.6.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
</tr>
<tr id="S5.T2.22.18" class="ltx_tr">
<td id="S5.T2.22.18.13" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S5.T2.22.18.13.1" class="ltx_text" style="font-size:90%;">FedAvg (ResNet50) </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.22.18.13.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bibx22" title="" class="ltx_ref">22</a><span id="S5.T2.22.18.13.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T2.12.8.2" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.11.7.1.m1.1" class="ltx_Math" alttext="60.72" display="inline"><semantics id="S5.T2.11.7.1.m1.1a"><mn mathsize="90%" id="S5.T2.11.7.1.m1.1.1" xref="S5.T2.11.7.1.m1.1.1.cmml">60.72</mn><annotation-xml encoding="MathML-Content" id="S5.T2.11.7.1.m1.1b"><cn type="float" id="S5.T2.11.7.1.m1.1.1.cmml" xref="S5.T2.11.7.1.m1.1.1">60.72</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.7.1.m1.1c">60.72</annotation></semantics></math><span id="S5.T2.12.8.2.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.12.8.2.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.12.8.2.1.1" class="ltx_p"><math id="S5.T2.12.8.2.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.12.8.2.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.12.8.2.1.1.m1.1.1" xref="S5.T2.12.8.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.12.8.2.1.1.m1.1b"><ci id="S5.T2.12.8.2.1.1.m1.1.1.cmml" xref="S5.T2.12.8.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.8.2.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.14.10.4" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.13.9.3.m1.1" class="ltx_Math" alttext="64.96" display="inline"><semantics id="S5.T2.13.9.3.m1.1a"><mn mathsize="90%" id="S5.T2.13.9.3.m1.1.1" xref="S5.T2.13.9.3.m1.1.1.cmml">64.96</mn><annotation-xml encoding="MathML-Content" id="S5.T2.13.9.3.m1.1b"><cn type="float" id="S5.T2.13.9.3.m1.1.1.cmml" xref="S5.T2.13.9.3.m1.1.1">64.96</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.9.3.m1.1c">64.96</annotation></semantics></math><span id="S5.T2.14.10.4.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.14.10.4.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.14.10.4.1.1" class="ltx_p"><math id="S5.T2.14.10.4.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.14.10.4.1.1.m1.1a"><mo mathcolor="#00FF00" mathsize="90%" stretchy="false" id="S5.T2.14.10.4.1.1.m1.1.1" xref="S5.T2.14.10.4.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.14.10.4.1.1.m1.1b"><ci id="S5.T2.14.10.4.1.1.m1.1.1.cmml" xref="S5.T2.14.10.4.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.10.4.1.1.m1.1c">\uparrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.16.12.6" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.15.11.5.m1.1" class="ltx_Math" alttext="64.26" display="inline"><semantics id="S5.T2.15.11.5.m1.1a"><mn mathsize="90%" id="S5.T2.15.11.5.m1.1.1" xref="S5.T2.15.11.5.m1.1.1.cmml">64.26</mn><annotation-xml encoding="MathML-Content" id="S5.T2.15.11.5.m1.1b"><cn type="float" id="S5.T2.15.11.5.m1.1.1.cmml" xref="S5.T2.15.11.5.m1.1.1">64.26</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.11.5.m1.1c">64.26</annotation></semantics></math><span id="S5.T2.16.12.6.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.16.12.6.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.16.12.6.1.1" class="ltx_p"><math id="S5.T2.16.12.6.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.16.12.6.1.1.m1.1a"><mo mathcolor="#00FF00" mathsize="90%" stretchy="false" id="S5.T2.16.12.6.1.1.m1.1.1" xref="S5.T2.16.12.6.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.16.12.6.1.1.m1.1b"><ci id="S5.T2.16.12.6.1.1.m1.1.1.cmml" xref="S5.T2.16.12.6.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.12.6.1.1.m1.1c">\uparrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.18.14.8" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.17.13.7.m1.1" class="ltx_Math" alttext="76.36" display="inline"><semantics id="S5.T2.17.13.7.m1.1a"><mn mathsize="90%" id="S5.T2.17.13.7.m1.1.1" xref="S5.T2.17.13.7.m1.1.1.cmml">76.36</mn><annotation-xml encoding="MathML-Content" id="S5.T2.17.13.7.m1.1b"><cn type="float" id="S5.T2.17.13.7.m1.1.1.cmml" xref="S5.T2.17.13.7.m1.1.1">76.36</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.13.7.m1.1c">76.36</annotation></semantics></math><span id="S5.T2.18.14.8.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.18.14.8.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.18.14.8.1.1" class="ltx_p"><math id="S5.T2.18.14.8.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.18.14.8.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.18.14.8.1.1.m1.1.1" xref="S5.T2.18.14.8.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.18.14.8.1.1.m1.1b"><ci id="S5.T2.18.14.8.1.1.m1.1.1.cmml" xref="S5.T2.18.14.8.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.14.8.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.20.16.10" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.19.15.9.m1.1" class="ltx_Math" alttext="80.91" display="inline"><semantics id="S5.T2.19.15.9.m1.1a"><mn mathsize="90%" id="S5.T2.19.15.9.m1.1.1" xref="S5.T2.19.15.9.m1.1.1.cmml">80.91</mn><annotation-xml encoding="MathML-Content" id="S5.T2.19.15.9.m1.1b"><cn type="float" id="S5.T2.19.15.9.m1.1.1.cmml" xref="S5.T2.19.15.9.m1.1.1">80.91</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.19.15.9.m1.1c">80.91</annotation></semantics></math><span id="S5.T2.20.16.10.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.20.16.10.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.20.16.10.1.1" class="ltx_p"><math id="S5.T2.20.16.10.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.20.16.10.1.1.m1.1a"><mo mathcolor="#00FF00" mathsize="90%" stretchy="false" id="S5.T2.20.16.10.1.1.m1.1.1" xref="S5.T2.20.16.10.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.20.16.10.1.1.m1.1b"><ci id="S5.T2.20.16.10.1.1.m1.1.1.cmml" xref="S5.T2.20.16.10.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.20.16.10.1.1.m1.1c">\uparrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.22.18.12" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.21.17.11.m1.1" class="ltx_Math" alttext="80.00" display="inline"><semantics id="S5.T2.21.17.11.m1.1a"><mn mathsize="90%" id="S5.T2.21.17.11.m1.1.1" xref="S5.T2.21.17.11.m1.1.1.cmml">80.00</mn><annotation-xml encoding="MathML-Content" id="S5.T2.21.17.11.m1.1b"><cn type="float" id="S5.T2.21.17.11.m1.1.1.cmml" xref="S5.T2.21.17.11.m1.1.1">80.00</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.21.17.11.m1.1c">80.00</annotation></semantics></math><span id="S5.T2.22.18.12.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.22.18.12.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.22.18.12.1.1" class="ltx_p"><math id="S5.T2.22.18.12.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.22.18.12.1.1.m1.1a"><mo mathcolor="#00FF00" mathsize="90%" stretchy="false" id="S5.T2.22.18.12.1.1.m1.1.1" xref="S5.T2.22.18.12.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.22.18.12.1.1.m1.1b"><ci id="S5.T2.22.18.12.1.1.m1.1.1.cmml" xref="S5.T2.22.18.12.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.22.18.12.1.1.m1.1c">\uparrow</annotation></semantics></math></p>
</span></div>
</td>
</tr>
<tr id="S5.T2.34.30" class="ltx_tr">
<td id="S5.T2.34.30.13" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S5.T2.34.30.13.1" class="ltx_text" style="font-size:90%;">FedProx</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.34.30.13.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bibx11" title="" class="ltx_ref">11</a><span id="S5.T2.34.30.13.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T2.24.20.2" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.23.19.1.m1.1" class="ltx_Math" alttext="45.73" display="inline"><semantics id="S5.T2.23.19.1.m1.1a"><mn mathsize="90%" id="S5.T2.23.19.1.m1.1.1" xref="S5.T2.23.19.1.m1.1.1.cmml">45.73</mn><annotation-xml encoding="MathML-Content" id="S5.T2.23.19.1.m1.1b"><cn type="float" id="S5.T2.23.19.1.m1.1.1.cmml" xref="S5.T2.23.19.1.m1.1.1">45.73</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.23.19.1.m1.1c">45.73</annotation></semantics></math><span id="S5.T2.24.20.2.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.24.20.2.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.24.20.2.1.1" class="ltx_p"><math id="S5.T2.24.20.2.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.24.20.2.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.24.20.2.1.1.m1.1.1" xref="S5.T2.24.20.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.24.20.2.1.1.m1.1b"><ci id="S5.T2.24.20.2.1.1.m1.1.1.cmml" xref="S5.T2.24.20.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.24.20.2.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.26.22.4" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.25.21.3.m1.1" class="ltx_Math" alttext="59.69" display="inline"><semantics id="S5.T2.25.21.3.m1.1a"><mn mathsize="90%" id="S5.T2.25.21.3.m1.1.1" xref="S5.T2.25.21.3.m1.1.1.cmml">59.69</mn><annotation-xml encoding="MathML-Content" id="S5.T2.25.21.3.m1.1b"><cn type="float" id="S5.T2.25.21.3.m1.1.1.cmml" xref="S5.T2.25.21.3.m1.1.1">59.69</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.25.21.3.m1.1c">59.69</annotation></semantics></math><span id="S5.T2.26.22.4.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.26.22.4.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.26.22.4.1.1" class="ltx_p"><math id="S5.T2.26.22.4.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.26.22.4.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.26.22.4.1.1.m1.1.1" xref="S5.T2.26.22.4.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.26.22.4.1.1.m1.1b"><ci id="S5.T2.26.22.4.1.1.m1.1.1.cmml" xref="S5.T2.26.22.4.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.26.22.4.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.28.24.6" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.27.23.5.m1.1" class="ltx_Math" alttext="60.58" display="inline"><semantics id="S5.T2.27.23.5.m1.1a"><mn mathsize="90%" id="S5.T2.27.23.5.m1.1.1" xref="S5.T2.27.23.5.m1.1.1.cmml">60.58</mn><annotation-xml encoding="MathML-Content" id="S5.T2.27.23.5.m1.1b"><cn type="float" id="S5.T2.27.23.5.m1.1.1.cmml" xref="S5.T2.27.23.5.m1.1.1">60.58</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.27.23.5.m1.1c">60.58</annotation></semantics></math><span id="S5.T2.28.24.6.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.28.24.6.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.28.24.6.1.1" class="ltx_p"><math id="S5.T2.28.24.6.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.28.24.6.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.28.24.6.1.1.m1.1.1" xref="S5.T2.28.24.6.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.28.24.6.1.1.m1.1b"><ci id="S5.T2.28.24.6.1.1.m1.1.1.cmml" xref="S5.T2.28.24.6.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.28.24.6.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.30.26.8" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.29.25.7.m1.1" class="ltx_Math" alttext="58.18" display="inline"><semantics id="S5.T2.29.25.7.m1.1a"><mn mathsize="90%" id="S5.T2.29.25.7.m1.1.1" xref="S5.T2.29.25.7.m1.1.1.cmml">58.18</mn><annotation-xml encoding="MathML-Content" id="S5.T2.29.25.7.m1.1b"><cn type="float" id="S5.T2.29.25.7.m1.1.1.cmml" xref="S5.T2.29.25.7.m1.1.1">58.18</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.29.25.7.m1.1c">58.18</annotation></semantics></math><span id="S5.T2.30.26.8.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.30.26.8.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.30.26.8.1.1" class="ltx_p"><math id="S5.T2.30.26.8.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.30.26.8.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.30.26.8.1.1.m1.1.1" xref="S5.T2.30.26.8.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.30.26.8.1.1.m1.1b"><ci id="S5.T2.30.26.8.1.1.m1.1.1.cmml" xref="S5.T2.30.26.8.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.30.26.8.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.32.28.10" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.31.27.9.m1.1" class="ltx_Math" alttext="74.55" display="inline"><semantics id="S5.T2.31.27.9.m1.1a"><mn mathsize="90%" id="S5.T2.31.27.9.m1.1.1" xref="S5.T2.31.27.9.m1.1.1.cmml">74.55</mn><annotation-xml encoding="MathML-Content" id="S5.T2.31.27.9.m1.1b"><cn type="float" id="S5.T2.31.27.9.m1.1.1.cmml" xref="S5.T2.31.27.9.m1.1.1">74.55</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.31.27.9.m1.1c">74.55</annotation></semantics></math><span id="S5.T2.32.28.10.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.32.28.10.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.32.28.10.1.1" class="ltx_p"><math id="S5.T2.32.28.10.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.32.28.10.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.32.28.10.1.1.m1.1.1" xref="S5.T2.32.28.10.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.32.28.10.1.1.m1.1b"><ci id="S5.T2.32.28.10.1.1.m1.1.1.cmml" xref="S5.T2.32.28.10.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.32.28.10.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.34.30.12" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.33.29.11.m1.1" class="ltx_Math" alttext="75.91" display="inline"><semantics id="S5.T2.33.29.11.m1.1a"><mn mathsize="90%" id="S5.T2.33.29.11.m1.1.1" xref="S5.T2.33.29.11.m1.1.1.cmml">75.91</mn><annotation-xml encoding="MathML-Content" id="S5.T2.33.29.11.m1.1b"><cn type="float" id="S5.T2.33.29.11.m1.1.1.cmml" xref="S5.T2.33.29.11.m1.1.1">75.91</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.33.29.11.m1.1c">75.91</annotation></semantics></math><span id="S5.T2.34.30.12.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.34.30.12.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.34.30.12.1.1" class="ltx_p"><math id="S5.T2.34.30.12.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.34.30.12.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.34.30.12.1.1.m1.1.1" xref="S5.T2.34.30.12.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.34.30.12.1.1.m1.1b"><ci id="S5.T2.34.30.12.1.1.m1.1.1.cmml" xref="S5.T2.34.30.12.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.34.30.12.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
</tr>
<tr id="S5.T2.46.42" class="ltx_tr">
<td id="S5.T2.46.42.13" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<span id="S5.T2.46.42.13.1" class="ltx_text" style="font-size:90%;">FedBN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.46.42.13.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bibx14" title="" class="ltx_ref">14</a><span id="S5.T2.46.42.13.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S5.T2.36.32.2" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.35.31.1.m1.1" class="ltx_Math" alttext="31.12" display="inline"><semantics id="S5.T2.35.31.1.m1.1a"><mn mathsize="90%" id="S5.T2.35.31.1.m1.1.1" xref="S5.T2.35.31.1.m1.1.1.cmml">31.12</mn><annotation-xml encoding="MathML-Content" id="S5.T2.35.31.1.m1.1b"><cn type="float" id="S5.T2.35.31.1.m1.1.1.cmml" xref="S5.T2.35.31.1.m1.1.1">31.12</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.35.31.1.m1.1c">31.12</annotation></semantics></math><span id="S5.T2.36.32.2.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.36.32.2.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.36.32.2.1.1" class="ltx_p"><math id="S5.T2.36.32.2.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.36.32.2.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.36.32.2.1.1.m1.1.1" xref="S5.T2.36.32.2.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.36.32.2.1.1.m1.1b"><ci id="S5.T2.36.32.2.1.1.m1.1.1.cmml" xref="S5.T2.36.32.2.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.36.32.2.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.38.34.4" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.37.33.3.m1.1" class="ltx_Math" alttext="54.05" display="inline"><semantics id="S5.T2.37.33.3.m1.1a"><mn mathsize="90%" id="S5.T2.37.33.3.m1.1.1" xref="S5.T2.37.33.3.m1.1.1.cmml">54.05</mn><annotation-xml encoding="MathML-Content" id="S5.T2.37.33.3.m1.1b"><cn type="float" id="S5.T2.37.33.3.m1.1.1.cmml" xref="S5.T2.37.33.3.m1.1.1">54.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.37.33.3.m1.1c">54.05</annotation></semantics></math><span id="S5.T2.38.34.4.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.38.34.4.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.38.34.4.1.1" class="ltx_p"><math id="S5.T2.38.34.4.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.38.34.4.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.38.34.4.1.1.m1.1.1" xref="S5.T2.38.34.4.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.38.34.4.1.1.m1.1b"><ci id="S5.T2.38.34.4.1.1.m1.1.1.cmml" xref="S5.T2.38.34.4.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.38.34.4.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.40.36.6" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.39.35.5.m1.1" class="ltx_Math" alttext="61.35" display="inline"><semantics id="S5.T2.39.35.5.m1.1a"><mn mathsize="90%" id="S5.T2.39.35.5.m1.1.1" xref="S5.T2.39.35.5.m1.1.1.cmml">61.35</mn><annotation-xml encoding="MathML-Content" id="S5.T2.39.35.5.m1.1b"><cn type="float" id="S5.T2.39.35.5.m1.1.1.cmml" xref="S5.T2.39.35.5.m1.1.1">61.35</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.39.35.5.m1.1c">61.35</annotation></semantics></math><span id="S5.T2.40.36.6.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.40.36.6.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.40.36.6.1.1" class="ltx_p"><math id="S5.T2.40.36.6.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.40.36.6.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.40.36.6.1.1.m1.1.1" xref="S5.T2.40.36.6.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.40.36.6.1.1.m1.1b"><ci id="S5.T2.40.36.6.1.1.m1.1.1.cmml" xref="S5.T2.40.36.6.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.40.36.6.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.42.38.8" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.41.37.7.m1.1" class="ltx_Math" alttext="38.64" display="inline"><semantics id="S5.T2.41.37.7.m1.1a"><mn mathsize="90%" id="S5.T2.41.37.7.m1.1.1" xref="S5.T2.41.37.7.m1.1.1.cmml">38.64</mn><annotation-xml encoding="MathML-Content" id="S5.T2.41.37.7.m1.1b"><cn type="float" id="S5.T2.41.37.7.m1.1.1.cmml" xref="S5.T2.41.37.7.m1.1.1">38.64</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.41.37.7.m1.1c">38.64</annotation></semantics></math><span id="S5.T2.42.38.8.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.42.38.8.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.42.38.8.1.1" class="ltx_p"><math id="S5.T2.42.38.8.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.42.38.8.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.42.38.8.1.1.m1.1.1" xref="S5.T2.42.38.8.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.42.38.8.1.1.m1.1b"><ci id="S5.T2.42.38.8.1.1.m1.1.1.cmml" xref="S5.T2.42.38.8.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.42.38.8.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.44.40.10" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.43.39.9.m1.1" class="ltx_Math" alttext="65.45" display="inline"><semantics id="S5.T2.43.39.9.m1.1a"><mn mathsize="90%" id="S5.T2.43.39.9.m1.1.1" xref="S5.T2.43.39.9.m1.1.1.cmml">65.45</mn><annotation-xml encoding="MathML-Content" id="S5.T2.43.39.9.m1.1b"><cn type="float" id="S5.T2.43.39.9.m1.1.1.cmml" xref="S5.T2.43.39.9.m1.1.1">65.45</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.43.39.9.m1.1c">65.45</annotation></semantics></math><span id="S5.T2.44.40.10.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.44.40.10.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.44.40.10.1.1" class="ltx_p"><math id="S5.T2.44.40.10.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.44.40.10.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.44.40.10.1.1.m1.1.1" xref="S5.T2.44.40.10.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.44.40.10.1.1.m1.1b"><ci id="S5.T2.44.40.10.1.1.m1.1.1.cmml" xref="S5.T2.44.40.10.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.44.40.10.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
<td id="S5.T2.46.42.12" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.45.41.11.m1.1" class="ltx_Math" alttext="74.55" display="inline"><semantics id="S5.T2.45.41.11.m1.1a"><mn mathsize="90%" id="S5.T2.45.41.11.m1.1.1" xref="S5.T2.45.41.11.m1.1.1.cmml">74.55</mn><annotation-xml encoding="MathML-Content" id="S5.T2.45.41.11.m1.1b"><cn type="float" id="S5.T2.45.41.11.m1.1.1.cmml" xref="S5.T2.45.41.11.m1.1.1">74.55</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.45.41.11.m1.1c">74.55</annotation></semantics></math><span id="S5.T2.46.42.12.2" class="ltx_text" style="font-size:90%;">% </span>
<div id="S5.T2.46.42.12.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<p id="S5.T2.46.42.12.1.1" class="ltx_p"><math id="S5.T2.46.42.12.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T2.46.42.12.1.1.m1.1a"><mo mathcolor="#FF0000" mathsize="90%" stretchy="false" id="S5.T2.46.42.12.1.1.m1.1.1" xref="S5.T2.46.42.12.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.46.42.12.1.1.m1.1b"><ci id="S5.T2.46.42.12.1.1.m1.1.1.cmml" xref="S5.T2.46.42.12.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.46.42.12.1.1.m1.1c">\downarrow</annotation></semantics></math></p>
</span></div>
</td>
</tr>
<tr id="S5.T2.52.48" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S5.T2.52.48.7" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.52.48.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;background-color:#E6E6E6;">FedMHA (ours)</span></td>
<td id="S5.T2.47.43.1" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.47.43.1.1" class="ltx_text" style="font-size:90%;color:#0000FF;background-color:#E6E6E6;">67.70%<span id="S5.T2.47.43.1.1.1" class="ltx_text" style="color:#000000;"> 
<span id="S5.T2.47.43.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<span id="S5.T2.47.43.1.1.1.1.1" class="ltx_p"><math id="S5.T2.47.43.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.47.43.1.1.1.1.1.m1.1a"><mo mathbackground="#E6E6E6" mathcolor="#00FF00" stretchy="false" id="S5.T2.47.43.1.1.1.1.1.m1.1.1" xref="S5.T2.47.43.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.47.43.1.1.1.1.1.m1.1b"><ci id="S5.T2.47.43.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.47.43.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.47.43.1.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math></span>
</span></span></span></span></td>
<td id="S5.T2.48.44.2" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.48.44.2.1" class="ltx_text" style="font-size:90%;color:#0000FF;background-color:#E6E6E6;">67.67%<span id="S5.T2.48.44.2.1.1" class="ltx_text" style="color:#000000;"> 
<span id="S5.T2.48.44.2.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<span id="S5.T2.48.44.2.1.1.1.1" class="ltx_p"><math id="S5.T2.48.44.2.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.48.44.2.1.1.1.1.m1.1a"><mo mathbackground="#E6E6E6" mathcolor="#00FF00" stretchy="false" id="S5.T2.48.44.2.1.1.1.1.m1.1.1" xref="S5.T2.48.44.2.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.48.44.2.1.1.1.1.m1.1b"><ci id="S5.T2.48.44.2.1.1.1.1.m1.1.1.cmml" xref="S5.T2.48.44.2.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.48.44.2.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math></span>
</span></span></span></span></td>
<td id="S5.T2.49.45.3" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.49.45.3.1" class="ltx_text" style="font-size:90%;color:#0000FF;background-color:#E6E6E6;">69.38%<span id="S5.T2.49.45.3.1.1" class="ltx_text" style="color:#000000;"> 
<span id="S5.T2.49.45.3.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<span id="S5.T2.49.45.3.1.1.1.1" class="ltx_p"><math id="S5.T2.49.45.3.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.49.45.3.1.1.1.1.m1.1a"><mo mathbackground="#E6E6E6" mathcolor="#00FF00" stretchy="false" id="S5.T2.49.45.3.1.1.1.1.m1.1.1" xref="S5.T2.49.45.3.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.49.45.3.1.1.1.1.m1.1b"><ci id="S5.T2.49.45.3.1.1.1.1.m1.1.1.cmml" xref="S5.T2.49.45.3.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.49.45.3.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math></span>
</span></span></span></span></td>
<td id="S5.T2.50.46.4" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.50.46.4.1" class="ltx_text" style="font-size:90%;background-color:#E6E6E6;">     <span id="S5.T2.50.46.4.1.2" class="ltx_text" style="color:#0000FF;">83.64%</span> 
<span id="S5.T2.50.46.4.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<span id="S5.T2.50.46.4.1.1.1" class="ltx_p"><math id="S5.T2.50.46.4.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.50.46.4.1.1.1.m1.1a"><mo mathbackground="#E6E6E6" mathcolor="#00FF00" stretchy="false" id="S5.T2.50.46.4.1.1.1.m1.1.1" xref="S5.T2.50.46.4.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.50.46.4.1.1.1.m1.1b"><ci id="S5.T2.50.46.4.1.1.1.m1.1.1.cmml" xref="S5.T2.50.46.4.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.50.46.4.1.1.1.m1.1c">\uparrow</annotation></semantics></math></span>
</span></span></span></td>
<td id="S5.T2.51.47.5" class="ltx_td ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.51.47.5.1" class="ltx_text" style="font-size:90%;background-color:#E6E6E6;">     <span id="S5.T2.51.47.5.1.2" class="ltx_text" style="color:#0000FF;">83.64%</span> 
<span id="S5.T2.51.47.5.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<span id="S5.T2.51.47.5.1.1.1" class="ltx_p"><math id="S5.T2.51.47.5.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.51.47.5.1.1.1.m1.1a"><mo mathbackground="#E6E6E6" mathcolor="#00FF00" stretchy="false" id="S5.T2.51.47.5.1.1.1.m1.1.1" xref="S5.T2.51.47.5.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.51.47.5.1.1.1.m1.1b"><ci id="S5.T2.51.47.5.1.1.1.m1.1.1.cmml" xref="S5.T2.51.47.5.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.51.47.5.1.1.1.m1.1c">\uparrow</annotation></semantics></math></span>
</span></span></span></td>
<td id="S5.T2.52.48.6" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.52.48.6.1" class="ltx_text" style="font-size:90%;color:#0000FF;background-color:#E6E6E6;">84.09%<span id="S5.T2.52.48.6.1.1" class="ltx_text" style="color:#000000;"> 
<span id="S5.T2.52.48.6.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.5pt;height:8pt;vertical-align:-1.7pt;"><span class="ltx_transformed_inner" style="width:4.5pt;transform:translate(0pt,2.62pt) rotate(-0deg) ;">
<span id="S5.T2.52.48.6.1.1.1.1" class="ltx_p"><math id="S5.T2.52.48.6.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T2.52.48.6.1.1.1.1.m1.1a"><mo mathbackground="#E6E6E6" mathcolor="#00FF00" stretchy="false" id="S5.T2.52.48.6.1.1.1.1.m1.1.1" xref="S5.T2.52.48.6.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T2.52.48.6.1.1.1.1.m1.1b"><ci id="S5.T2.52.48.6.1.1.1.1.m1.1.1.cmml" xref="S5.T2.52.48.6.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.52.48.6.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math></span>
</span></span></span></span></td>
</tr>
<tr id="S5.T2.58.54" class="ltx_tr">
<td id="S5.T2.58.54.7" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;"><span id="S5.T2.58.54.7.1" class="ltx_text" style="font-size:90%;">Local</span></td>
<td id="S5.T2.53.49.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.53.49.1.m1.1" class="ltx_Math" alttext="26.20" display="inline"><semantics id="S5.T2.53.49.1.m1.1a"><mn mathsize="90%" id="S5.T2.53.49.1.m1.1.1" xref="S5.T2.53.49.1.m1.1.1.cmml">26.20</mn><annotation-xml encoding="MathML-Content" id="S5.T2.53.49.1.m1.1b"><cn type="float" id="S5.T2.53.49.1.m1.1.1.cmml" xref="S5.T2.53.49.1.m1.1.1">26.20</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.53.49.1.m1.1c">26.20</annotation></semantics></math><span id="S5.T2.53.49.1.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T2.54.50.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.54.50.2.m1.1" class="ltx_Math" alttext="26.20" display="inline"><semantics id="S5.T2.54.50.2.m1.1a"><mn mathsize="90%" id="S5.T2.54.50.2.m1.1.1" xref="S5.T2.54.50.2.m1.1.1.cmml">26.20</mn><annotation-xml encoding="MathML-Content" id="S5.T2.54.50.2.m1.1b"><cn type="float" id="S5.T2.54.50.2.m1.1.1.cmml" xref="S5.T2.54.50.2.m1.1.1">26.20</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.54.50.2.m1.1c">26.20</annotation></semantics></math><span id="S5.T2.54.50.2.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T2.55.51.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.55.51.3.m1.1" class="ltx_Math" alttext="26.20" display="inline"><semantics id="S5.T2.55.51.3.m1.1a"><mn mathsize="90%" id="S5.T2.55.51.3.m1.1.1" xref="S5.T2.55.51.3.m1.1.1.cmml">26.20</mn><annotation-xml encoding="MathML-Content" id="S5.T2.55.51.3.m1.1b"><cn type="float" id="S5.T2.55.51.3.m1.1.1.cmml" xref="S5.T2.55.51.3.m1.1.1">26.20</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.55.51.3.m1.1c">26.20</annotation></semantics></math><span id="S5.T2.55.51.3.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T2.56.52.4" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.56.52.4.m1.1" class="ltx_Math" alttext="21.36" display="inline"><semantics id="S5.T2.56.52.4.m1.1a"><mn mathsize="90%" id="S5.T2.56.52.4.m1.1.1" xref="S5.T2.56.52.4.m1.1.1.cmml">21.36</mn><annotation-xml encoding="MathML-Content" id="S5.T2.56.52.4.m1.1b"><cn type="float" id="S5.T2.56.52.4.m1.1.1.cmml" xref="S5.T2.56.52.4.m1.1.1">21.36</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.56.52.4.m1.1c">21.36</annotation></semantics></math><span id="S5.T2.56.52.4.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T2.57.53.5" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.57.53.5.m1.1" class="ltx_Math" alttext="21.36" display="inline"><semantics id="S5.T2.57.53.5.m1.1a"><mn mathsize="90%" id="S5.T2.57.53.5.m1.1.1" xref="S5.T2.57.53.5.m1.1.1.cmml">21.36</mn><annotation-xml encoding="MathML-Content" id="S5.T2.57.53.5.m1.1b"><cn type="float" id="S5.T2.57.53.5.m1.1.1.cmml" xref="S5.T2.57.53.5.m1.1.1">21.36</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.57.53.5.m1.1c">21.36</annotation></semantics></math><span id="S5.T2.57.53.5.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S5.T2.58.54.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t" style="padding-left:4.0pt;padding-right:4.0pt;">
<math id="S5.T2.58.54.6.m1.1" class="ltx_Math" alttext="21.36" display="inline"><semantics id="S5.T2.58.54.6.m1.1a"><mn mathsize="90%" id="S5.T2.58.54.6.m1.1.1" xref="S5.T2.58.54.6.m1.1.1.cmml">21.36</mn><annotation-xml encoding="MathML-Content" id="S5.T2.58.54.6.m1.1b"><cn type="float" id="S5.T2.58.54.6.m1.1.1.cmml" xref="S5.T2.58.54.6.m1.1.1">21.36</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.58.54.6.m1.1c">21.36</annotation></semantics></math><span id="S5.T2.58.54.6.1" class="ltx_text" style="font-size:90%;">%</span>
</td>
</tr>
</table>
</figure>
<div id="S5.SS2.p6" class="ltx_para">
<p id="S5.SS2.p6.1" class="ltx_p"><span id="S5.SS2.p6.1.1" class="ltx_text ltx_font_bold">Effect of Number of Clients</span> As the second component, we investigate the impact of the number of clients on the performance of federated learning systems. A clear correlation emerges between the number of clients and the efficacy of federated learning models. As shown in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:table:weighted_averaging</span>, the performance improvements associated with FedMHA, both with and without weighted averaging, span an accuracy range of 67.67% to 84.09%. This range contrasts the range of 21.36% to 80.91% for the other models.</p>
</div>
<figure id="S5.F6" class="ltx_figure">
<p id="S5.F6.1" class="ltx_p ltx_align_center"><span id="S5.F6.1.1" class="ltx_text ltx_inline-block" style="width:433.6pt;">
<span id="S5.F6.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:1300.1pt;height:601.6pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span id="S5.F6.1.1.1.1.1" class="ltx_p"><span id="S5.F6.1.1.1.1.1.1" class="ltx_text ltx_inline-block" style="width:1300.1pt;"><img src="/html/2310.09444/assets/x6.png" id="S5.F6.1.1.1.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="999" height="449" alt="Refer to caption"></span></span>
</span></span></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.3.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S5.F6.4.2" class="ltx_text" style="font-size:90%;">Impact of alignment loss on model performance. We compare the scenarios where the alignment term is retained in the local objective functions versus its removal. Models with the alignment term exhibit lower loss.</span></figcaption>
</figure>
<div id="S5.SS2.p7" class="ltx_para">
<p id="S5.SS2.p7.1" class="ltx_p"><span id="S5.SS2.p7.1.1" class="ltx_text ltx_font_bold">Heterogeneity intensifies minority clients’ underperformance</span> The third part of our investigation looks into the influence of alignment loss on the performance of federated learning models. Here, <math id="S5.SS2.p7.1.m1.1" class="ltx_Math" alttext="\alpha_{\mathrm{LDA}}" display="inline"><semantics id="S5.SS2.p7.1.m1.1a"><msub id="S5.SS2.p7.1.m1.1.1" xref="S5.SS2.p7.1.m1.1.1.cmml"><mi id="S5.SS2.p7.1.m1.1.1.2" xref="S5.SS2.p7.1.m1.1.1.2.cmml">α</mi><mi id="S5.SS2.p7.1.m1.1.1.3" xref="S5.SS2.p7.1.m1.1.1.3.cmml">LDA</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p7.1.m1.1b"><apply id="S5.SS2.p7.1.m1.1.1.cmml" xref="S5.SS2.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p7.1.m1.1.1.1.cmml" xref="S5.SS2.p7.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p7.1.m1.1.1.2.cmml" xref="S5.SS2.p7.1.m1.1.1.2">𝛼</ci><ci id="S5.SS2.p7.1.m1.1.1.3.cmml" xref="S5.SS2.p7.1.m1.1.1.3">LDA</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p7.1.m1.1c">\alpha_{\mathrm{LDA}}</annotation></semantics></math> values ranging from 0.1 to 0.9 were implemented to evaluate improvements in fairness. This analysis aims to alleviate the loss experienced by worst-performing, typically underrepresented, clients. Our approach resulted in marked enhancements, especially in settings of high heterogeneity, as shown in Figure <a href="#S5.F6" title="Figure 6 ‣ 5.2 Evaluation for minority clients ‣ 5 Results ‣ Tackling Heterogeneity in Medical Federated learning via Aligning Vision Transformers" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. Incorporating alignment loss in the local objective functions led to a boost in local training generalization and fairness for Federated Averaging.Despite achieving satisfactory performance on training data in ideal conditions, it was observed that minority clients generally underperform in settings with high levels of data heterogeneity.</p>
</div>
<div id="S5.SS2.p8" class="ltx_para">
<p id="S5.SS2.p8.1" class="ltx_p">Using attention layers to gather global representations from all clients and then aligning them shows great promise for improving model fairness. This likely improvement is due to the ability of attention mechanisms to effectively capture information, posing a key point of reconsideration for using convolutional layers as the main architecture in current FL algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx11" title="" class="ltx_ref">11</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx10" title="" class="ltx_ref">10</a>]</cite>. This suggests a need for more focus on Vision Transformers in future updates and improvements.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we have presented and evaluated a federated learning approach that leverages Vision Transformers and multi-head attention mechanisms to effectively handle data heterogeneity in distributed settings. Our experiments, conducted on lung cancer CT scans, demonstrate that combining optimization based approaches with vision transformer modules, outperforms existing federated learning models, particularly in scenarios with high data heterogeneity. The success of our approach in medical imaging underscores its potential in facilitating collaboration among healthcare institutions while preserving data privacy.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">Our analysis also highlights the importance of considering client data distribution and sample size during model aggregation, as a means to improve the overall accuracy. It encourages further research on employing vision transformers in heterogenous environments.The results have implications for the medical domain, where accurate diagnosis and treatment planning are paramount. Future work could focus on further enhancing fairness among clients and addressing potential scalability issues in large-scale federated learning scenarios. Additionally, exploring the use of alignment methods and vision transformers in other medical application domains could provide valuable insights into its generalizability and adaptability in the broader healthcare context.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">There are a few limitations to consider for our work. While our approach showcases the benefits of data heterogeneity handling, it doesn’t address potential trade-offs related to computational overhead or communication costs. Our focus on accuracy and fairness as the primary metrics might also overlook other important aspects such as latency, or model compactness. Lastly, the real-world deployment of such algorithms may encounter challenges that are not captured in the controlled environment of our experiments.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This research is supported by KWF Kankerbestrijding and the Netherlands
Organisation for Scientific Research (NWO) Domain AES, as part of their joint strategic research programme: Technology for Oncology IL. The collaboration project is co-funded by the PPP allowance made available by Health Holland, Top Sector Life Sciences &amp; Health, to stimulate public-private partnerships.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bibx1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">Saleh Abunajm, Nelly Elsayed, Zag ElSayed and Murat Ozer
</span>
<span class="ltx_bibblock">“Deep Learning Approach for Early Stage Lung Cancer Detection”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.02456</em>, 2023
</span>
</li>
<li id="bib.bibx2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">Manoj Ghuhan Arivazhagan, Vinay Aggarwal and Aaditya Kumar Singh
</span>
<span class="ltx_bibblock">“Federated learning with personalization layers”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.00818</em>, 2019
</span>
</li>
<li id="bib.bibx3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">Canh T. Dinh, Nguyen H. Tran and Tuan Dung Nguyen
</span>
<span class="ltx_bibblock">“Personalized Federated Learning with Moreau Envelopes”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx3.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2020
</span>
</li>
<li id="bib.bibx4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">Alexey Dosovitskiy et al.
</span>
<span class="ltx_bibblock">“An image is worth 16x16 words: Transformers for image recognition at scale”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.11929</em>, 2020
</span>
</li>
<li id="bib.bibx5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">Dashan Gao et al.
</span>
<span class="ltx_bibblock">“Hhhfl: Hierarchical heterogeneous horizontal federated learning for electroencephalography”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.05784</em>, 2019
</span>
</li>
<li id="bib.bibx6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">Pengfei Guo, Puyang Wang and Jinyuan Zhou
</span>
<span class="ltx_bibblock">“Multi-institutional collaborations for improving deep learning-based magnetic resonance image reconstruction using federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx6.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conf. Comput. Vis. Pattern Recognit.</em>, 2021, pp. 2423–2432
</span>
</li>
<li id="bib.bibx7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">Ali Hatamizadeh et al.
</span>
<span class="ltx_bibblock">“Unetr: Transformers for 3d medical image segmentation”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF winter conference on applications of computer vision</em>, 2022, pp. 574–584
</span>
</li>
<li id="bib.bibx8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">Meirui Jiang, Zirui Wang and Qi Dou
</span>
<span class="ltx_bibblock">“Harmofl: Harmonizing local and global drifts in federated learning on heterogeneous medical images”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em> <span id="bib.bibx8.2.2" class="ltx_text ltx_font_bold">36</span>, 2022, pp. 1087–1095
</span>
</li>
<li id="bib.bibx9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">Georgios Kaissis, Alexander Ziller and Jonathan Passerat-Palmbach
</span>
<span class="ltx_bibblock">“End-to-end privacy preserving deep learning on multi-institutional medical imaging”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx9.1.1" class="ltx_emph ltx_font_italic">Nat. Mach. Intell.</em> <span id="bib.bibx9.2.2" class="ltx_text ltx_font_bold">3.6</span>
</span>
<span class="ltx_bibblock">Nature Publishing Group, 2021, pp. 473–484
</span>
</li>
<li id="bib.bibx10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">Qinbin Li, Bingsheng He and Dawn Song
</span>
<span class="ltx_bibblock">“Model-contrastive federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx10.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conf. Comput. Vis. Pattern Recognit. (CVPR)</em>, 2021, pp. 10713–10722
</span>
</li>
<li id="bib.bibx11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">Tian Li, Anit Kumar Sahu and Manzil Zaheer
</span>
<span class="ltx_bibblock">“Federated optimization in heterogeneous networks”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx11.1.1" class="ltx_emph ltx_font_italic">Proc. Mach. Learn. Syst. (MLSys)</em> <span id="bib.bibx11.2.2" class="ltx_text ltx_font_bold">2</span>, 2020, pp. 429–450
</span>
</li>
<li id="bib.bibx12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">Wenqi Li et al.
</span>
<span class="ltx_bibblock">“Privacy-preserving federated brain tumour segmentation”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx12.1.1" class="ltx_emph ltx_font_italic">International Workshop on Machine Learning in Medical Imaging</em>, 2019, pp. 133–141
</span>
<span class="ltx_bibblock">Springer
</span>
</li>
<li id="bib.bibx13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">Xiang Li et al.
</span>
<span class="ltx_bibblock">“On the Convergence of FedAvg on Non-IID Data” arXiv: 1907.02189
</span>
<span class="ltx_bibblock">In <em id="bib.bibx13.1.1" class="ltx_emph ltx_font_italic">arXiv:1907.02189 [cs, math, stat]</em>, 2020
</span>
<span class="ltx_bibblock">URL: <a target="_blank" href="http://arxiv.org/abs/1907.02189" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1907.02189</a>
</span>
</li>
<li id="bib.bibx14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">Xiaoxiao Li, Meirui Jiang and Xiaofei Zhang
</span>
<span class="ltx_bibblock">“Fedbn: Federated learning on non-iid features via local batch normalization”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.07623</em>, 2021
</span>
</li>
<li id="bib.bibx15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">Xiaoxiao Li et al.
</span>
<span class="ltx_bibblock">“Multi-site fmri analysis using privacy-preserving federated learning and domain adaptation: Abide results”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2001.05647</em>, 2020
</span>
</li>
<li id="bib.bibx16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">Ze Liu et al.
</span>
<span class="ltx_bibblock">“Swin transformer: Hierarchical vision transformer using shifted windows”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF international conference on computer vision</em>, 2021, pp. 10012–10022
</span>
</li>
<li id="bib.bibx17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">Brendan McMahan, Eider Moore and Daniel Ramage
</span>
<span class="ltx_bibblock">“Communication-efficient learning of deep networks from decentralized data”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx17.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>, 2017, pp. 1273–1282
</span>
<span class="ltx_bibblock">PMLR
</span>
</li>
<li id="bib.bibx18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">Mohammad Nasajpour, Mahmut Karakaya, Seyedamin Pouriyeh and Reza M Parizi
</span>
<span class="ltx_bibblock">“Federated transfer learning for diabetic retinopathy detection using CNN architectures”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx18.1.1" class="ltx_emph ltx_font_italic">SoutheastCon 2022</em>, 2022, pp. 655–660
</span>
<span class="ltx_bibblock">IEEE
</span>
</li>
<li id="bib.bibx19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">Hung T Nguyen et al.
</span>
<span class="ltx_bibblock">“Fast-convergent federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx19.1.1" class="ltx_emph ltx_font_italic">IEEE Journal on Selected Areas in Communications</em> <span id="bib.bibx19.2.2" class="ltx_text ltx_font_bold">39.1</span>
</span>
<span class="ltx_bibblock">IEEE, 2020, pp. 201–218
</span>
</li>
<li id="bib.bibx20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">Sangjoon Park, Gwanghyun Kim and Jeongsol Kim
</span>
<span class="ltx_bibblock">“Federated Split Task-Agnostic Vision Transformer for COVID-19 CXR Diagnosis”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx20.1.1" class="ltx_emph ltx_font_italic">Proc. Adv. Neural Inf. Process. Syst. (NIPS)</em> <span id="bib.bibx20.2.2" class="ltx_text ltx_font_bold">34</span>, 2021
</span>
</li>
<li id="bib.bibx21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">Reese Pathak and Martin J Wainwright
</span>
<span class="ltx_bibblock">“FedSplit: An algorithmic framework for fast federated optimization”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx21.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em> <span id="bib.bibx21.2.2" class="ltx_text ltx_font_bold">33</span>, 2020, pp. 7057–7066
</span>
</li>
<li id="bib.bibx22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">Liangqiong Qu et al.
</span>
<span class="ltx_bibblock">“Rethinking architecture design for tackling data heterogeneity in federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2022, pp. 10061–10071
</span>
</li>
<li id="bib.bibx23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">Nicola Rieke et al.
</span>
<span class="ltx_bibblock">“The future of digital health with federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx23.1.1" class="ltx_emph ltx_font_italic">npj Digit. Med.</em> <span id="bib.bibx23.2.2" class="ltx_text ltx_font_bold">3</span>, 2020, pp. 119
</span>
</li>
<li id="bib.bibx24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">Holger R Roth et al.
</span>
<span class="ltx_bibblock">“Federated Learning for Breast Density Classification: A Real-World Implementation”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx24.1.1" class="ltx_emph ltx_font_italic">Domain Adaptation and Representation Transfer, and Distributed and Collaborative Learning</em>
</span>
<span class="ltx_bibblock">Springer, 2020, pp. 181–191
</span>
</li>
<li id="bib.bibx25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">Felix Sattler, Simon Wiedemann, Klaus-Robert Müller and Wojciech Samek
</span>
<span class="ltx_bibblock">“Robust and Communication-Efficient Federated Learning from Non-IID Data” arXiv: 1903.02891
</span>
<span class="ltx_bibblock">In <em id="bib.bibx25.1.1" class="ltx_emph ltx_font_italic">arXiv:1903.02891 [cs, stat]</em>, 2019
</span>
<span class="ltx_bibblock">URL: <a target="_blank" href="http://arxiv.org/abs/1903.02891" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1903.02891</a>
</span>
</li>
<li id="bib.bibx26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">Fahad Shamshad et al.
</span>
<span class="ltx_bibblock">“Transformers in medical imaging: A survey”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx26.1.1" class="ltx_emph ltx_font_italic">Medical Image Analysis</em>
</span>
<span class="ltx_bibblock">Elsevier, 2023, pp. 102802
</span>
</li>
<li id="bib.bibx27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">Micah J Sheller et al.
</span>
<span class="ltx_bibblock">“Federated learning in medicine: facilitating multi-institutional collaborations without sharing patient data”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx27.1.1" class="ltx_emph ltx_font_italic">Scientific reports</em> <span id="bib.bibx27.2.2" class="ltx_text ltx_font_bold">10.1</span>
</span>
<span class="ltx_bibblock">Nature Publishing Group, 2020, pp. 1–12
</span>
</li>
<li id="bib.bibx28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">Chen Shen et al.
</span>
<span class="ltx_bibblock">“Multi-task federated learning for heterogeneous pancreas segmentation”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx28.1.1" class="ltx_emph ltx_font_italic">Clinical Image-Based Procedures, Distributed and Collaborative Learning, Artificial Intelligence for Combating COVID-19 and Secure and Privacy-Preserving Machine Learning: 10th Workshop, CLIP 2021, Second Workshop, DCL 2021, First Workshop, LL-COVID19 2021, and First Workshop and Tutorial, PPML 2021, Held in Conjunction with MICCAI 2021, Strasbourg, France, September 27 and October 1, 2021, Proceedings 2</em>, 2021, pp. 101–110
</span>
<span class="ltx_bibblock">Springer
</span>
</li>
<li id="bib.bibx29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">Ashish Vaswani et al.
</span>
<span class="ltx_bibblock">“Attention is all you need”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx29.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em> <span id="bib.bibx29.2.2" class="ltx_text ltx_font_bold">30</span>, 2017
</span>
</li>
<li id="bib.bibx30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">Yawen Wu, Dewen Zeng and Zhepeng Wang
</span>
<span class="ltx_bibblock">“Federated Contrastive Learning for Volumetric Medical Image Segmentation”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx30.1.1" class="ltx_emph ltx_font_italic">Proc. Int. Conf. Med. Image Comput. Comput. Assist. Interv. (MICCAI)</em>, 2021, pp. 367–377
</span>
<span class="ltx_bibblock">Springer
</span>
</li>
<li id="bib.bibx31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">Hamdalla F Al-Yasriy et al.
</span>
<span class="ltx_bibblock">“Diagnosis of lung cancer based on CT scans using CNN”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx31.1.1" class="ltx_emph ltx_font_italic">IOP Conference Series: Materials Science and Engineering</em> <span id="bib.bibx31.2.2" class="ltx_text ltx_font_bold">928</span>, 2020, pp. 022035
</span>
<span class="ltx_bibblock">IOP Publishing
</span>
</li>
<li id="bib.bibx32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">Yousef Yeganeh et al.
</span>
<span class="ltx_bibblock">“Adaptive Personlization in Federated Learning for Highly Non-iid Data”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2207.03448</em>, 2022
</span>
</li>
<li id="bib.bibx33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">Lin Yue et al.
</span>
<span class="ltx_bibblock">“Deep learning for heterogeneous medical data analysis”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx33.1.1" class="ltx_emph ltx_font_italic">World Wide Web</em> <span id="bib.bibx33.2.2" class="ltx_text ltx_font_bold">23</span>
</span>
<span class="ltx_bibblock">Springer, 2020, pp. 2715–2737
</span>
</li>
<li id="bib.bibx34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">Ke Zhang, Carl Yang and Xiaoxiao Li
</span>
<span class="ltx_bibblock">“Subgraph federated learning with missing neighbor generation”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx34.1.1" class="ltx_emph ltx_font_italic">Proc. Adv. Neural Inf. Process. Syst. (NIPS)</em> <span id="bib.bibx34.2.2" class="ltx_text ltx_font_bold">34</span>, 2021
</span>
</li>
<li id="bib.bibx35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">Miao Zhang et al.
</span>
<span class="ltx_bibblock">“Splitavg: A heterogeneity-aware federated deep learning method for medical imaging”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx35.1.1" class="ltx_emph ltx_font_italic">IEEE Journal of Biomedical and Health Informatics</em> <span id="bib.bibx35.2.2" class="ltx_text ltx_font_bold">26.9</span>
</span>
<span class="ltx_bibblock">IEEE, 2022, pp. 4635–4644
</span>
</li>
<li id="bib.bibx36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">Hong-Yu Zhou et al.
</span>
<span class="ltx_bibblock">“nnformer: Interleaved transformer for volumetric segmentation”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.03201</em>, 2021
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2310.09443" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2310.09444" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2310.09444">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2310.09444" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2310.09445" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 00:50:40 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
