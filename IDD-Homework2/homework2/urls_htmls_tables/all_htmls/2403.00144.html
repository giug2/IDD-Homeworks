<!DOCTYPE html>

<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation</title>
<!--Generated on Thu Feb 29 21:39:18 2024 by LaTeXML (version 0.8.7) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv_0.7.4.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2403.00144v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S1" title="1 Introduction ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S2" title="2 Related Work ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S3" title="3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Approach</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S3.SS1" title="3.1 Ensemble Components ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Ensemble Components</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S3.SS2" title="3.2 Our Proposed EBBS Algorithm ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Our Proposed EBBS Algorithm</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S3.SS3" title="3.3 EBBS-Based Distillation ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>EBBS-Based Distillation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4" title="4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.SS1" title="4.1 Settings ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.SS2" title="4.2 Competing Methods ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Competing Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.SS3" title="4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Results and Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S5" title="5 Conclusion ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S6" title="6 Limitations ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A1" title="Appendix A Beam Search ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Beam Search</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A2" title="Appendix B Details of Our Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Details of Our Experiments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A3" title="Appendix C Analysis of Beam Size ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Analysis of Beam Size</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A4" title="Appendix D Analysis of Inference Efficiency ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Analysis of Inference Efficiency</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A5" title="Appendix E Entropy of Distilled Models ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Entropy of Distilled Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A6" title="Appendix F Case Study ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Case Study</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<div aria-label="Conversion errors have been found" class="package-alerts ltx_document" role="status">
<button aria-label="Dismiss alert" onclick="closePopup()">
<span aria-hidden="true"><svg aria-hidden="true" focusable="false" height="20" role="presentation" viewbox="0 0 44 44" width="20">
<path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
<path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
</svg></span>
</button>
<p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
<ul arial-label="Unsupported packages used in this paper">
<li>failed: seqsplit</li>
</ul>
<p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p>
</div><div class="section" id="target-section"><div id="license-tr">License: CC Zero</div><div id="watermark-tr">arXiv:2403.00144v1 [cs.CL] 29 Feb 2024</div></div>
<script>
            function closePopup() {
                document.querySelector('.package-alerts').style.display = 'none';
            }
        </script>
<article class="ltx_document ltx_authors_1line"><span class="ltx_ERROR undefined" id="id1">\useunder</span>
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1"><span class="ltx_text ltx_ulem_uline" id="p1.1.1"></span><span class="ltx_ERROR undefined" id="p1.1.2">\ul</span>
</p>
</div>
<h1 class="ltx_title ltx_title_document">
<span class="ltx_tabular ltx_align_middle" id="id1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="id1.1.1">
<span class="ltx_td ltx_align_left ltx_rowspan ltx_rowspan_2" id="id1.1.1.1"><span class="ltx_text" id="id1.1.1.1.1"><img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_landscape" height="40" id="id1.1.1.1.1.g1" src="extracted/5441316/assets/wave.jpg" width="57"/></span></span>
<span class="ltx_td ltx_align_left" id="id1.1.1.2">EBBS: An Ensemble with Bi-Level Beam Search</span></span>
<span class="ltx_tr" id="id1.1.2.1">
<span class="ltx_td ltx_align_left" id="id1.1.2.1.1">for Zero-Shot Machine Translation</span></span>
</span>
</span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Yuqiao Wen<math alttext="{}^{1,}" class="ltx_Math" display="inline" id="id2.1.m1.1"><semantics id="id2.1.m1.1a"><msup id="id2.1.m1.1.1" xref="id2.1.m1.1.1.cmml"><mi id="id2.1.m1.1.1a" xref="id2.1.m1.1.1.cmml"></mi><mrow id="id2.1.m1.1.1.1.3" xref="id2.1.m1.1.1.1.2.cmml"><mn id="id2.1.m1.1.1.1.1" xref="id2.1.m1.1.1.1.1.cmml">1</mn><mo id="id2.1.m1.1.1.1.3.1" xref="id2.1.m1.1.1.1.2.cmml">,</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id2.1.m1.1b"><apply id="id2.1.m1.1.1.cmml" xref="id2.1.m1.1.1"><list id="id2.1.m1.1.1.1.2.cmml" xref="id2.1.m1.1.1.1.3"><cn id="id2.1.m1.1.1.1.1.cmml" type="integer" xref="id2.1.m1.1.1.1.1">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.1.m1.1c">{}^{1,}</annotation><annotation encoding="application/x-llamapun" id="id2.1.m1.1d">start_FLOATSUPERSCRIPT 1 , end_FLOATSUPERSCRIPT</annotation></semantics></math>  , Behzad Shayegh<math alttext="{}^{1,*}" class="ltx_Math" display="inline" id="id3.2.m2.2"><semantics id="id3.2.m2.2a"><msup id="id3.2.m2.2.2" xref="id3.2.m2.2.2.cmml"><mi id="id3.2.m2.2.2a" xref="id3.2.m2.2.2.cmml"></mi><mrow id="id3.2.m2.2.2.2.4" xref="id3.2.m2.2.2.2.3.cmml"><mn id="id3.2.m2.1.1.1.1" xref="id3.2.m2.1.1.1.1.cmml">1</mn><mo id="id3.2.m2.2.2.2.4.1" rspace="0em" xref="id3.2.m2.2.2.2.3.cmml">,</mo><mo id="id3.2.m2.2.2.2.2" lspace="0em" xref="id3.2.m2.2.2.2.2.cmml">*</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="id3.2.m2.2b"><apply id="id3.2.m2.2.2.cmml" xref="id3.2.m2.2.2"><list id="id3.2.m2.2.2.2.3.cmml" xref="id3.2.m2.2.2.2.4"><cn id="id3.2.m2.1.1.1.1.cmml" type="integer" xref="id3.2.m2.1.1.1.1">1</cn><times id="id3.2.m2.2.2.2.2.cmml" xref="id3.2.m2.2.2.2.2"></times></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.2.m2.2c">{}^{1,*}</annotation><annotation encoding="application/x-llamapun" id="id3.2.m2.2d">start_FLOATSUPERSCRIPT 1 , * end_FLOATSUPERSCRIPT</annotation></semantics></math>, Chenyang Huang<math alttext="{}^{1}" class="ltx_Math" display="inline" id="id4.3.m3.1"><semantics id="id4.3.m3.1a"><msup id="id4.3.m3.1.1" xref="id4.3.m3.1.1.cmml"><mi id="id4.3.m3.1.1a" xref="id4.3.m3.1.1.cmml"></mi><mn id="id4.3.m3.1.1.1" xref="id4.3.m3.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id4.3.m3.1b"><apply id="id4.3.m3.1.1.cmml" xref="id4.3.m3.1.1"><cn id="id4.3.m3.1.1.1.cmml" type="integer" xref="id4.3.m3.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.3.m3.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id4.3.m3.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>, Yanshuai Cao<math alttext="{}^{2}" class="ltx_Math" display="inline" id="id5.4.m4.1"><semantics id="id5.4.m4.1a"><msup id="id5.4.m4.1.1" xref="id5.4.m4.1.1.cmml"><mi id="id5.4.m4.1.1a" xref="id5.4.m4.1.1.cmml"></mi><mn id="id5.4.m4.1.1.1" xref="id5.4.m4.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id5.4.m4.1b"><apply id="id5.4.m4.1.1.cmml" xref="id5.4.m4.1.1"><cn id="id5.4.m4.1.1.1.cmml" type="integer" xref="id5.4.m4.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.4.m4.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id5.4.m4.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>, Lili Mou<math alttext="{}^{1,3}" class="ltx_Math" display="inline" id="id6.5.m5.2"><semantics id="id6.5.m5.2a"><msup id="id6.5.m5.2.2" xref="id6.5.m5.2.2.cmml"><mi id="id6.5.m5.2.2a" xref="id6.5.m5.2.2.cmml"></mi><mrow id="id6.5.m5.2.2.2.4" xref="id6.5.m5.2.2.2.3.cmml"><mn id="id6.5.m5.1.1.1.1" xref="id6.5.m5.1.1.1.1.cmml">1</mn><mo id="id6.5.m5.2.2.2.4.1" xref="id6.5.m5.2.2.2.3.cmml">,</mo><mn id="id6.5.m5.2.2.2.2" xref="id6.5.m5.2.2.2.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id6.5.m5.2b"><apply id="id6.5.m5.2.2.cmml" xref="id6.5.m5.2.2"><list id="id6.5.m5.2.2.2.3.cmml" xref="id6.5.m5.2.2.2.4"><cn id="id6.5.m5.1.1.1.1.cmml" type="integer" xref="id6.5.m5.1.1.1.1">1</cn><cn id="id6.5.m5.2.2.2.2.cmml" type="integer" xref="id6.5.m5.2.2.2.2">3</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id6.5.m5.2c">{}^{1,3}</annotation><annotation encoding="application/x-llamapun" id="id6.5.m5.2d">start_FLOATSUPERSCRIPT 1 , 3 end_FLOATSUPERSCRIPT</annotation></semantics></math>
<br class="ltx_break"/><math alttext="{}^{1}" class="ltx_Math" display="inline" id="id7.6.m6.1"><semantics id="id7.6.m6.1a"><msup id="id7.6.m6.1.1" xref="id7.6.m6.1.1.cmml"><mi id="id7.6.m6.1.1a" xref="id7.6.m6.1.1.cmml"></mi><mn id="id7.6.m6.1.1.1" xref="id7.6.m6.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id7.6.m6.1b"><apply id="id7.6.m6.1.1.cmml" xref="id7.6.m6.1.1"><cn id="id7.6.m6.1.1.1.cmml" type="integer" xref="id7.6.m6.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id7.6.m6.1c">{}^{1}</annotation><annotation encoding="application/x-llamapun" id="id7.6.m6.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math>Dept. Computing Science, Alberta Machine Intelligence Institute (Amii), University of Alberta 
<br class="ltx_break"/><math alttext="{}^{2}" class="ltx_Math" display="inline" id="id8.7.m7.1"><semantics id="id8.7.m7.1a"><msup id="id8.7.m7.1.1" xref="id8.7.m7.1.1.cmml"><mi id="id8.7.m7.1.1a" xref="id8.7.m7.1.1.cmml"></mi><mn id="id8.7.m7.1.1.1" xref="id8.7.m7.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id8.7.m7.1b"><apply id="id8.7.m7.1.1.cmml" xref="id8.7.m7.1.1"><cn id="id8.7.m7.1.1.1.cmml" type="integer" xref="id8.7.m7.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id8.7.m7.1c">{}^{2}</annotation><annotation encoding="application/x-llamapun" id="id8.7.m7.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>Borealis AI  <math alttext="{}^{3}" class="ltx_Math" display="inline" id="id9.8.m8.1"><semantics id="id9.8.m8.1a"><msup id="id9.8.m8.1.1" xref="id9.8.m8.1.1.cmml"><mi id="id9.8.m8.1.1a" xref="id9.8.m8.1.1.cmml"></mi><mn id="id9.8.m8.1.1.1" xref="id9.8.m8.1.1.1.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="id9.8.m8.1b"><apply id="id9.8.m8.1.1.cmml" xref="id9.8.m8.1.1"><cn id="id9.8.m8.1.1.1.cmml" type="integer" xref="id9.8.m8.1.1.1">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id9.8.m8.1c">{}^{3}</annotation><annotation encoding="application/x-llamapun" id="id9.8.m8.1d">start_FLOATSUPERSCRIPT 3 end_FLOATSUPERSCRIPT</annotation></semantics></math>Canada CIFAR AI Chair, Amii
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id10.9.id1">yq.when@gmail.com  the.shayegh@gmail.com  chenyangh@ualberta.ca</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id11.10.id2">yanshuai.cao@borealisai.com  doublepower.mou@gmail.com</span>
<br class="ltx_break"/>
</span><span class="ltx_author_notes">Work partially done during Mitacs internship at Borealis AI.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id12.id1">The ability of zero-shot translation emerges when we train a multilingual model with certain translation directions; the model can then directly translate in unseen directions. Alternatively, zero-shot translation can be accomplished by pivoting through a third language (e.g., English). In our work, we observe that both direct and pivot translations are noisy and achieve less satisfactory performance. We propose EBBS, an ensemble method with a novel bi-level beam search algorithm, where each ensemble component explores its own prediction step by step at the lower level but they are synchronized by a “soft voting” mechanism at the upper level. Results on two popular multilingual translation datasets show that EBBS consistently outperforms direct and pivot translations as well as existing ensemble techniques. Further, we can distill the ensemble’s knowledge back to the multilingual model to improve inference efficiency; profoundly, our EBBS-based distillation does not sacrifice, or even improves, the translation quality.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Machine translation is a widely applicable NLP task that translates a text from a source language to a target language <cite class="ltx_cite ltx_citemacro_cite">Brown et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib6" title="">1990</a>); Bahdanau et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib2" title="">2015</a>)</cite>.
The Transformer architecture <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib49" title="">2017</a>)</cite> and pretrained large language models <cite class="ltx_cite ltx_citemacro_cite">Radford et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib38" title="">2019</a>); Raffel et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib39" title="">2020</a>); Lewis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib29" title="">2020</a>)</cite> have largely improved translation performance, especially in the supervised setting, where a model can learn from large volumes of parallel corpora.
However, machine translation remains challenging for low-resource languages, because there are not enough data for large neural networks to learn these languages.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">We specifically focus on multilingual translation in the <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">zero-shot</span> setting, where the system is required to translate between unseen language pairs.
Since collecting parallel data and training individual models for every translation pair are prohibitively expensive, it is common to build a single multilingual system <cite class="ltx_cite ltx_citemacro_cite">Johnson et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib23" title="">2017</a>); Fan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib14" title="">2021</a>)</cite> that can perform translation for all language pairs, most of which are zero-shot translation directions with few exceptions (e.g., English).
These models work by prepending a language-indicator token, and zero-shot ability emerges as the model generalizes from trained language pairs to unseen ones <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>; Wicks and Duh, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib55" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The main drawback of such a multilingual model is that they are noisy in the zero-shot setting due to the lack of supervision, and as a result, they tend to generate less satisfactory outputs <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib63" title="">2020</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite>.
Alternatively, zero-shot translation can be performed by <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">pivoting</span> <cite class="ltx_cite ltx_citemacro_citep">(Wu and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib59" title="">2007</a>, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib60" title="">2009</a>)</cite>, where the model first translates the input into a high-resource language such as English, which is then translated to the target language.
However, pivoting requires two translation steps, often leading to an accumulation of errors <cite class="ltx_cite ltx_citemacro_cite">Babych et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib1" title="">2007</a>); Gu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib17" title="">2019</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we propose a multi-pivot ensemble approach, where we design a novel ensemble method to aggregate direct translation and the predictions made by pivoting through different languages.
Our ensemble approach overcomes the drawback of direct and pivot translations as it can utilize these multiple weak models, yielding high-quality output text despite lacking parallel data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Building an ensemble for text generation is nuanced as it involves a sequence of word predictions.
Word-level ensembles aggregate predictions at each generation step, which is usually achieved by averaging the predicted probabilities <cite class="ltx_cite ltx_citemacro_cite">Sennrich et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib43" title="">2016a</a>); Freitag et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib15" title="">2017</a>); Shanbhogue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib45" title="">2023</a>)</cite>.
This may not be ideal for zero-shot translation as the predictions are too noisy, making the averaged probabilities overly smooth.
On the other hand, minimum Bayes risk decoding <cite class="ltx_cite ltx_citemacro_cite">(Bickel and Doksum, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib4" title="">2015</a>, MBR)</cite> can be considered a sequence-level voting ensemble, but it is only able to <span class="ltx_text ltx_font_italic" id="S1.p5.1.1">select</span> from weak and noisy candidates given by the direct and pivot translations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">To this end, we propose an ensemble decoding algorithm with bi-level beam search (EBBS). Our EBBS performs two levels of beam search at each generation step: at the lower level, beam search is applied individually to each ensemble component; at the upper level, the ensemble maintains a shared beam by voting and synchronizing the candidates (sub-sequences) in individual beams.
Unlike word-level ensembles <cite class="ltx_cite ltx_citemacro_cite">Freitag et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib15" title="">2017</a>); Shanbhogue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib45" title="">2023</a>)</cite>, EBBS does not average the predicted distributions, encouraging individual predictors to explore their own preferences;
unlike sequence-level ensembles <cite class="ltx_cite ltx_citemacro_cite">Kobayashi (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib25" title="">2018</a>); Eikema and Aziz (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib13" title="">2020</a>)</cite>, EBBS does not select from a candidate set, and thus is more flexible since voting is performed throughout the generation process.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">We conducted experiments on IWSLT <cite class="ltx_cite ltx_citemacro_citep">(Cettolo et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib8" title="">2017</a>)</cite> and Europarl <cite class="ltx_cite ltx_citemacro_citep">(Koehn, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib26" title="">2005</a>)</cite>, two popular multilingual datasets for zero-shot machine translation.
Results show that EBBS can generate high-quality translations and outperform existing ensemble techniques.
In addition, we used EBBS-generated outputs as the distillation signal to further finetune our multilingual translation model, which largely improves the efficiency while retaining the performance or even surpassing EBBS on Europarl.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Zero-shot machine translation.</span> With monolingual data, it is possible to accomplish
zero-shot machine translation by training language-specific autoencoders that share the same latent space <cite class="ltx_cite ltx_citemacro_citep">(Lample et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib27" title="">2018a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib28" title="">b</a>; Mohiuddin and Joty, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib32" title="">2020</a>)</cite>.
In a multilingual setting, zero-shot ability emerges when a single model is trained with multiple translation directions, allowing it to generalize to unseen directions <cite class="ltx_cite ltx_citemacro_citep">(Dabre et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib11" title="">2020</a>; Ranathunga et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib40" title="">2023</a>; Johnson et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib23" title="">2017</a>; Fan et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib14" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">A key research direction for multilingual translation is to alleviate task interference among different translation directions <cite class="ltx_cite ltx_citemacro_citep">(Zaremoodi et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib62" title="">2018</a>; Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib51" title="">2020</a>)</cite>. Researchers have developed various parameter-sharing schemes <cite class="ltx_cite ltx_citemacro_cite">Baziotis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib3" title="">2022</a>); Chronopoulou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib9" title="">2023</a>)</cite> and applied optimization-based methods to locate language-specific neurons <cite class="ltx_cite ltx_citemacro_cite">Wang and Zhang (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib50" title="">2022</a>); He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib20" title="">2023</a>)</cite>; such a model is able to better learn individual translation directions while pooling the knowledge of all languages together.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">In our work, we use a standard Transformer model following <cite class="ltx_cite ltx_citemacro_citet">Johnson et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib23" title="">2017</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite>. Our proposed ensemble algorithm EBBS is compatible with the above methods, as it is agnostic to model architectures.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.1"><span class="ltx_text ltx_font_bold" id="S2.p4.1.1">Ensemble learning.</span> Ensemble methods integrate multiple machine learning systems to form a stronger one <cite class="ltx_cite ltx_citemacro_citep">(Dong et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib12" title="">2020</a>; Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib61" title="">2023</a>)</cite>.
<span class="ltx_text ltx_font_italic" id="S2.p4.1.2">Bagging</span>, a classic ensemble technique, works by training multiple models with different portions of data and combining their predictions by averaging or voting <cite class="ltx_cite ltx_citemacro_citep">(Breiman, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib5" title="">1996</a>; Bühlmann and Yu, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib7" title="">2002</a>)</cite>.
Another popular ensemble approach is <span class="ltx_text ltx_font_italic" id="S2.p4.1.3">boosting</span>, where multiple models are trained sequentially, with each subsequent model focusing on the mistakes of the previous ones <cite class="ltx_cite ltx_citemacro_citep">(Schapire, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib42" title="">2003</a>; Hastie et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib19" title="">2009</a>; Natekin and Knoll, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib34" title="">2013</a>)</cite>.
Unfortunately, bagging and boosting are not compatible with our setting, because we build a self-ensemble with only a single model.
Alternatively, <span class="ltx_text ltx_font_italic" id="S2.p4.1.4">stacking</span> combines the outputs by training a meta-model <cite class="ltx_cite ltx_citemacro_citep">(Wolpert, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib57" title="">1992</a>; Ganaie et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib16" title="">2022</a>)</cite>, but this does not apply in our zero-shot setting either because we do not have groundtruth signal to train the meta-model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p5">
<p class="ltx_p" id="S2.p5.1">These ensemble techniques nevertheless may be applied to supervised text generation <cite class="ltx_cite ltx_citemacro_citep">(Freitag et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib15" title="">2017</a>; Kobayashi, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib25" title="">2018</a>; Hendy et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib21" title="">2021</a>)</cite>. That being said, they are not ideal as they do not take advantage of the sequential nature of sentences.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p6">
<p class="ltx_p" id="S2.p6.1">Unlike previous work, our EBBS performs bi-level beam search, allowing each component to explore its own predictions at every step but synchronizing all individuals by a “soft voting” mechanism. Our approach is specifically suited to the sequence generation process.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Approach</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we first explain our ensemble components in §<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S3.SS1" title="3.1 Ensemble Components ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">3.1</span></a>.
We then propose EBBS, a novel ensemble decoding algorithm in §<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S3.SS2" title="3.2 Our Proposed EBBS Algorithm ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">3.2</span></a>.
Finally, we describe in §<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S3.SS3" title="3.3 EBBS-Based Distillation ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">3.3</span></a> knowledge distillation with EBBS-decoded outputs to improve efficiency.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Ensemble Components</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">In this work, we focus on zero-shot multilingual machine translation, which requires a system to perform translations for multiple languages, where some translation directions are unseen.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">Specifically, our multilingual model is an encoder–decoder Transformer with a byte pair encoding tokenizer <cite class="ltx_cite ltx_citemacro_citep">(Sennrich et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib44" title="">2016b</a>)</cite> shared among all languages. The encoder can capture the semantics of tokens in any language, whereas the decoder translates the encoded text into the desired language based on a target-language indicator <cite class="ltx_cite ltx_citemacro_cite">Johnson et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib23" title="">2017</a>); Fan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib14" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">We follow the standard English-centric training <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib23" title="">2017</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite>, where the multilingual model is trained with parallel data with English on one of the sides (e.g., German-to-English and English-to-Romanian). The zero-shot ability emerges during such training, and the model is able to translate directly between unseen language pairs (e.g., German-to-Romanian), known as <span class="ltx_text ltx_font_italic" id="S3.SS1.p3.1.1">direct translation</span> <cite class="ltx_cite ltx_citemacro_cite">Dabre et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib11" title="">2020</a>); Ranathunga et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib40" title="">2023</a>)</cite>. An alternative approach is <span class="ltx_text ltx_font_italic" id="S3.SS1.p3.1.2">pivot translation</span>, where the multilingual model performs two translations using a high-resource language as a pivot (e.g., first translating German to English, and then English to Romanian).</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">However, both direct and pivot translations have major weaknesses: the quality of direct translation tends to be low due to the lack of parallel data, whereas pivot translation suffers from an error accumulation as it requires two translation steps <cite class="ltx_cite ltx_citemacro_citep">(Babych et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib1" title="">2007</a>; Gu et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib17" title="">2019</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1">In this paper, we would like to build a self-ensemble of the multilingual model to boost translation quality, where direct and pivot translations are our ensemble components.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.1">However, standard ensemble methods such as averaging and voting may not work well for text generation. Voting, for example, chooses the most voted prediction, but in text generation, the components’ votes often do not share anything in common, because there could be tens of thousands of tokens in the vocabulary.
An averaging ensemble, on the other hand, averages the predicted distributions of all components, potentially leading to an overly smooth distribution. As reported in a pilot study in the appendix of <cite class="ltx_cite ltx_citemacro_citet">Fan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib14" title="">2021</a>)</cite>, a multilingual averaging ensemble only achieves a small improvement over direct translation. Overall, ensemble methods have not been widely explored for zero-shot multilingual translation in previous literature.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Our Proposed EBBS Algorithm</h3>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="355" id="S3.F1.g1" src="x1.png" width="415"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Overview of our EBBS algorithm.</figcaption>
</figure>
<figure class="ltx_figure" id="S3.SS2.fig1">
<br class="ltx_break ltx_centering"/>
<figure class="ltx_float ltx_minipage ltx_align_center ltx_align_middle" id="alg1" style="width:260.2pt;">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg1.32">
<div class="ltx_listingline" id="alg1.2.2"> <span class="ltx_text" id="alg1.2.2.1" style="color:#000000;"><span class="ltx_text ltx_font_bold" id="alg1.2.2.1.1">Input:</span> </span> <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="alg1.1.1.m1.1"><semantics id="alg1.1.1.m1.1a"><mi id="alg1.1.1.m1.1.1" xref="alg1.1.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="alg1.1.1.m1.1b"><ci id="alg1.1.1.m1.1.1.cmml" xref="alg1.1.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="alg1.1.1.m1.1d">bold_x</annotation></semantics></math>: input sentence;   <math alttext="Z" class="ltx_Math" display="inline" id="alg1.2.2.m2.1"><semantics id="alg1.2.2.m2.1a"><mi id="alg1.2.2.m2.1.1" xref="alg1.2.2.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="alg1.2.2.m2.1b"><ci id="alg1.2.2.m2.1.1.cmml" xref="alg1.2.2.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.m2.1c">Z</annotation><annotation encoding="application/x-llamapun" id="alg1.2.2.m2.1d">italic_Z</annotation></semantics></math>: beam size 
</div>
<div class="ltx_listingline" id="alg1.4.4"> <math alttext="K" class="ltx_Math" display="inline" id="alg1.3.3.m1.1"><semantics id="alg1.3.3.m1.1a"><mi id="alg1.3.3.m1.1.1" xref="alg1.3.3.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.3.3.m1.1b"><ci id="alg1.3.3.m1.1.1.cmml" xref="alg1.3.3.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg1.3.3.m1.1d">italic_K</annotation></semantics></math>: number of scorers;   <math alttext="p_{1},\cdots,p_{K}" class="ltx_Math" display="inline" id="alg1.4.4.m2.3"><semantics id="alg1.4.4.m2.3a"><mrow id="alg1.4.4.m2.3.3.2" xref="alg1.4.4.m2.3.3.3.cmml"><msub id="alg1.4.4.m2.2.2.1.1" xref="alg1.4.4.m2.2.2.1.1.cmml"><mi id="alg1.4.4.m2.2.2.1.1.2" xref="alg1.4.4.m2.2.2.1.1.2.cmml">p</mi><mn id="alg1.4.4.m2.2.2.1.1.3" xref="alg1.4.4.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.4.4.m2.3.3.2.3" xref="alg1.4.4.m2.3.3.3.cmml">,</mo><mi id="alg1.4.4.m2.1.1" mathvariant="normal" xref="alg1.4.4.m2.1.1.cmml">⋯</mi><mo id="alg1.4.4.m2.3.3.2.4" xref="alg1.4.4.m2.3.3.3.cmml">,</mo><msub id="alg1.4.4.m2.3.3.2.2" xref="alg1.4.4.m2.3.3.2.2.cmml"><mi id="alg1.4.4.m2.3.3.2.2.2" xref="alg1.4.4.m2.3.3.2.2.2.cmml">p</mi><mi id="alg1.4.4.m2.3.3.2.2.3" xref="alg1.4.4.m2.3.3.2.2.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.4.m2.3b"><list id="alg1.4.4.m2.3.3.3.cmml" xref="alg1.4.4.m2.3.3.2"><apply id="alg1.4.4.m2.2.2.1.1.cmml" xref="alg1.4.4.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.4.4.m2.2.2.1.1.1.cmml" xref="alg1.4.4.m2.2.2.1.1">subscript</csymbol><ci id="alg1.4.4.m2.2.2.1.1.2.cmml" xref="alg1.4.4.m2.2.2.1.1.2">𝑝</ci><cn id="alg1.4.4.m2.2.2.1.1.3.cmml" type="integer" xref="alg1.4.4.m2.2.2.1.1.3">1</cn></apply><ci id="alg1.4.4.m2.1.1.cmml" xref="alg1.4.4.m2.1.1">⋯</ci><apply id="alg1.4.4.m2.3.3.2.2.cmml" xref="alg1.4.4.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.4.4.m2.3.3.2.2.1.cmml" xref="alg1.4.4.m2.3.3.2.2">subscript</csymbol><ci id="alg1.4.4.m2.3.3.2.2.2.cmml" xref="alg1.4.4.m2.3.3.2.2.2">𝑝</ci><ci id="alg1.4.4.m2.3.3.2.2.3.cmml" xref="alg1.4.4.m2.3.3.2.2.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m2.3c">p_{1},\cdots,p_{K}</annotation><annotation encoding="application/x-llamapun" id="alg1.4.4.m2.3d">italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , italic_p start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>: scorers 
</div>
<div class="ltx_listingline" id="alg1.6.6">
<span class="ltx_tag ltx_tag_listingline">1</span> <math alttext="H\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.5.5.m1.1"><semantics id="alg1.5.5.m1.1a"><mrow id="alg1.5.5.m1.1.1" xref="alg1.5.5.m1.1.1.cmml"><mi id="alg1.5.5.m1.1.1.2" xref="alg1.5.5.m1.1.1.2.cmml">H</mi><mo id="alg1.5.5.m1.1.1.1" stretchy="false" xref="alg1.5.5.m1.1.1.1.cmml">←</mo><mi id="alg1.5.5.m1.1.1.3" mathvariant="normal" xref="alg1.5.5.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.5.m1.1b"><apply id="alg1.5.5.m1.1.1.cmml" xref="alg1.5.5.m1.1.1"><ci id="alg1.5.5.m1.1.1.1.cmml" xref="alg1.5.5.m1.1.1.1">←</ci><ci id="alg1.5.5.m1.1.1.2.cmml" xref="alg1.5.5.m1.1.1.2">𝐻</ci><emptyset id="alg1.5.5.m1.1.1.3.cmml" xref="alg1.5.5.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m1.1c">H\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.5.5.m1.1d">italic_H ← ∅</annotation></semantics></math> <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.6.6.m2.1"><semantics id="alg1.6.6.m2.1a"><mo id="alg1.6.6.m2.1.1" xref="alg1.6.6.m2.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.6.6.m2.1b"><ci id="alg1.6.6.m2.1.1.cmml" xref="alg1.6.6.m2.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.m2.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.6.6.m2.1d">▷</annotation></semantics></math> candidate outputs 
</div>
<div class="ltx_listingline" id="alg1.8.8">
<span class="ltx_tag ltx_tag_listingline">2</span> <math alttext="B_{0}\leftarrow\{\langle\textsc{bos},1\rangle\}" class="ltx_Math" display="inline" id="alg1.7.7.m1.3"><semantics id="alg1.7.7.m1.3a"><mrow id="alg1.7.7.m1.3.3" xref="alg1.7.7.m1.3.3.cmml"><msub id="alg1.7.7.m1.3.3.3" xref="alg1.7.7.m1.3.3.3.cmml"><mi id="alg1.7.7.m1.3.3.3.2" xref="alg1.7.7.m1.3.3.3.2.cmml">B</mi><mn id="alg1.7.7.m1.3.3.3.3" xref="alg1.7.7.m1.3.3.3.3.cmml">0</mn></msub><mo id="alg1.7.7.m1.3.3.2" stretchy="false" xref="alg1.7.7.m1.3.3.2.cmml">←</mo><mrow id="alg1.7.7.m1.3.3.1.1" xref="alg1.7.7.m1.3.3.1.2.cmml"><mo id="alg1.7.7.m1.3.3.1.1.2" stretchy="false" xref="alg1.7.7.m1.3.3.1.2.cmml">{</mo><mrow id="alg1.7.7.m1.3.3.1.1.1.2" xref="alg1.7.7.m1.3.3.1.1.1.1.cmml"><mo id="alg1.7.7.m1.3.3.1.1.1.2.1" stretchy="false" xref="alg1.7.7.m1.3.3.1.1.1.1.cmml">⟨</mo><mtext class="ltx_font_smallcaps" id="alg1.7.7.m1.1.1" mathvariant="normal" xref="alg1.7.7.m1.1.1a.cmml">bos</mtext><mo id="alg1.7.7.m1.3.3.1.1.1.2.2" xref="alg1.7.7.m1.3.3.1.1.1.1.cmml">,</mo><mn id="alg1.7.7.m1.2.2" xref="alg1.7.7.m1.2.2.cmml">1</mn><mo id="alg1.7.7.m1.3.3.1.1.1.2.3" stretchy="false" xref="alg1.7.7.m1.3.3.1.1.1.1.cmml">⟩</mo></mrow><mo id="alg1.7.7.m1.3.3.1.1.3" stretchy="false" xref="alg1.7.7.m1.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.7.m1.3b"><apply id="alg1.7.7.m1.3.3.cmml" xref="alg1.7.7.m1.3.3"><ci id="alg1.7.7.m1.3.3.2.cmml" xref="alg1.7.7.m1.3.3.2">←</ci><apply id="alg1.7.7.m1.3.3.3.cmml" xref="alg1.7.7.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.7.7.m1.3.3.3.1.cmml" xref="alg1.7.7.m1.3.3.3">subscript</csymbol><ci id="alg1.7.7.m1.3.3.3.2.cmml" xref="alg1.7.7.m1.3.3.3.2">𝐵</ci><cn id="alg1.7.7.m1.3.3.3.3.cmml" type="integer" xref="alg1.7.7.m1.3.3.3.3">0</cn></apply><set id="alg1.7.7.m1.3.3.1.2.cmml" xref="alg1.7.7.m1.3.3.1.1"><list id="alg1.7.7.m1.3.3.1.1.1.1.cmml" xref="alg1.7.7.m1.3.3.1.1.1.2"><ci id="alg1.7.7.m1.1.1a.cmml" xref="alg1.7.7.m1.1.1"><mtext class="ltx_font_smallcaps" id="alg1.7.7.m1.1.1.cmml" mathvariant="normal" xref="alg1.7.7.m1.1.1">bos</mtext></ci><cn id="alg1.7.7.m1.2.2.cmml" type="integer" xref="alg1.7.7.m1.2.2">1</cn></list></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.m1.3c">B_{0}\leftarrow\{\langle\textsc{bos},1\rangle\}</annotation><annotation encoding="application/x-llamapun" id="alg1.7.7.m1.3d">italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ← { ⟨ bos , 1 ⟩ }</annotation></semantics></math> <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.8.8.m2.1"><semantics id="alg1.8.8.m2.1a"><mo id="alg1.8.8.m2.1.1" xref="alg1.8.8.m2.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.8.8.m2.1b"><ci id="alg1.8.8.m2.1.1.cmml" xref="alg1.8.8.m2.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.m2.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.8.8.m2.1d">▷</annotation></semantics></math> upper-level beam 
</div>
<div class="ltx_listingline" id="alg1.9.9">
<span class="ltx_tag ltx_tag_listingline">3</span> <span class="ltx_text ltx_font_bold" id="alg1.9.9.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg1.9.9.1"><math alttext="t=1,2,\cdots" class="ltx_Math" display="inline" id="alg1.9.9.1.m1.3"><semantics id="alg1.9.9.1.m1.3a"><mrow id="alg1.9.9.1.m1.3.4" xref="alg1.9.9.1.m1.3.4.cmml"><mi id="alg1.9.9.1.m1.3.4.2" xref="alg1.9.9.1.m1.3.4.2.cmml">t</mi><mo id="alg1.9.9.1.m1.3.4.1" mathvariant="normal" xref="alg1.9.9.1.m1.3.4.1.cmml">=</mo><mrow id="alg1.9.9.1.m1.3.4.3.2" xref="alg1.9.9.1.m1.3.4.3.1.cmml"><mn id="alg1.9.9.1.m1.1.1" mathvariant="normal" xref="alg1.9.9.1.m1.1.1.cmml">1</mn><mo id="alg1.9.9.1.m1.3.4.3.2.1" mathvariant="normal" xref="alg1.9.9.1.m1.3.4.3.1.cmml">,</mo><mn id="alg1.9.9.1.m1.2.2" mathvariant="normal" xref="alg1.9.9.1.m1.2.2.cmml">2</mn><mo id="alg1.9.9.1.m1.3.4.3.2.2" mathvariant="normal" xref="alg1.9.9.1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.9.9.1.m1.3.3" mathvariant="normal" xref="alg1.9.9.1.m1.3.3.cmml">⋯</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.9.1.m1.3b"><apply id="alg1.9.9.1.m1.3.4.cmml" xref="alg1.9.9.1.m1.3.4"><eq id="alg1.9.9.1.m1.3.4.1.cmml" xref="alg1.9.9.1.m1.3.4.1"></eq><ci id="alg1.9.9.1.m1.3.4.2.cmml" xref="alg1.9.9.1.m1.3.4.2">𝑡</ci><list id="alg1.9.9.1.m1.3.4.3.1.cmml" xref="alg1.9.9.1.m1.3.4.3.2"><cn id="alg1.9.9.1.m1.1.1.cmml" type="integer" xref="alg1.9.9.1.m1.1.1">1</cn><cn id="alg1.9.9.1.m1.2.2.cmml" type="integer" xref="alg1.9.9.1.m1.2.2">2</cn><ci id="alg1.9.9.1.m1.3.3.cmml" xref="alg1.9.9.1.m1.3.3">normal-⋯</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.1.m1.3c">t=1,2,\cdots</annotation><annotation encoding="application/x-llamapun" id="alg1.9.9.1.m1.3d">italic_t = 1 , 2 , ⋯</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.9.9.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.10.10">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.10.10.m1.1"><semantics id="alg1.10.10.m1.1a"><mo id="alg1.10.10.m1.1.1" xref="alg1.10.10.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.10.10.m1.1b"><ci id="alg1.10.10.m1.1.1.cmml" xref="alg1.10.10.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.10.10.m1.1d">▷</annotation></semantics></math> lower level: individual beam search 
</div>
<div class="ltx_listingline" id="alg1.11.11">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg1.11.11.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg1.11.11.1"><math alttext="\langle\mathbf{y}_{1:t-1},p\rangle\in B_{t-1}" class="ltx_Math" display="inline" id="alg1.11.11.1.m1.2"><semantics id="alg1.11.11.1.m1.2a"><mrow id="alg1.11.11.1.m1.2.2" xref="alg1.11.11.1.m1.2.2.cmml"><mrow id="alg1.11.11.1.m1.2.2.1.1" xref="alg1.11.11.1.m1.2.2.1.2.cmml"><mo id="alg1.11.11.1.m1.2.2.1.1.2" mathvariant="normal" stretchy="false" xref="alg1.11.11.1.m1.2.2.1.2.cmml">⟨</mo><msub id="alg1.11.11.1.m1.2.2.1.1.1" xref="alg1.11.11.1.m1.2.2.1.1.1.cmml"><mi id="alg1.11.11.1.m1.2.2.1.1.1.2" xref="alg1.11.11.1.m1.2.2.1.1.1.2.cmml">𝐲</mi><mrow id="alg1.11.11.1.m1.2.2.1.1.1.3" xref="alg1.11.11.1.m1.2.2.1.1.1.3.cmml"><mn id="alg1.11.11.1.m1.2.2.1.1.1.3.2" mathvariant="normal" xref="alg1.11.11.1.m1.2.2.1.1.1.3.2.cmml">1</mn><mo id="alg1.11.11.1.m1.2.2.1.1.1.3.1" lspace="0.278em" mathvariant="normal" rspace="0.278em" xref="alg1.11.11.1.m1.2.2.1.1.1.3.1.cmml">:</mo><mrow id="alg1.11.11.1.m1.2.2.1.1.1.3.3" xref="alg1.11.11.1.m1.2.2.1.1.1.3.3.cmml"><mi id="alg1.11.11.1.m1.2.2.1.1.1.3.3.2" xref="alg1.11.11.1.m1.2.2.1.1.1.3.3.2.cmml">t</mi><mo id="alg1.11.11.1.m1.2.2.1.1.1.3.3.1" mathvariant="normal" xref="alg1.11.11.1.m1.2.2.1.1.1.3.3.1.cmml">−</mo><mn id="alg1.11.11.1.m1.2.2.1.1.1.3.3.3" mathvariant="normal" xref="alg1.11.11.1.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="alg1.11.11.1.m1.2.2.1.1.3" mathvariant="normal" xref="alg1.11.11.1.m1.2.2.1.2.cmml">,</mo><mi id="alg1.11.11.1.m1.1.1" xref="alg1.11.11.1.m1.1.1.cmml">p</mi><mo id="alg1.11.11.1.m1.2.2.1.1.4" mathvariant="normal" stretchy="false" xref="alg1.11.11.1.m1.2.2.1.2.cmml">⟩</mo></mrow><mo id="alg1.11.11.1.m1.2.2.2" mathvariant="normal" xref="alg1.11.11.1.m1.2.2.2.cmml">∈</mo><msub id="alg1.11.11.1.m1.2.2.3" xref="alg1.11.11.1.m1.2.2.3.cmml"><mi id="alg1.11.11.1.m1.2.2.3.2" xref="alg1.11.11.1.m1.2.2.3.2.cmml">B</mi><mrow id="alg1.11.11.1.m1.2.2.3.3" xref="alg1.11.11.1.m1.2.2.3.3.cmml"><mi id="alg1.11.11.1.m1.2.2.3.3.2" xref="alg1.11.11.1.m1.2.2.3.3.2.cmml">t</mi><mo id="alg1.11.11.1.m1.2.2.3.3.1" mathvariant="normal" xref="alg1.11.11.1.m1.2.2.3.3.1.cmml">−</mo><mn id="alg1.11.11.1.m1.2.2.3.3.3" mathvariant="normal" xref="alg1.11.11.1.m1.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.11.11.1.m1.2b"><apply id="alg1.11.11.1.m1.2.2.cmml" xref="alg1.11.11.1.m1.2.2"><in id="alg1.11.11.1.m1.2.2.2.cmml" xref="alg1.11.11.1.m1.2.2.2"></in><list id="alg1.11.11.1.m1.2.2.1.2.cmml" xref="alg1.11.11.1.m1.2.2.1.1"><apply id="alg1.11.11.1.m1.2.2.1.1.1.cmml" xref="alg1.11.11.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.11.11.1.m1.2.2.1.1.1.1.cmml" xref="alg1.11.11.1.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.11.11.1.m1.2.2.1.1.1.2.cmml" xref="alg1.11.11.1.m1.2.2.1.1.1.2">𝐲</ci><apply id="alg1.11.11.1.m1.2.2.1.1.1.3.cmml" xref="alg1.11.11.1.m1.2.2.1.1.1.3"><ci id="alg1.11.11.1.m1.2.2.1.1.1.3.1.cmml" xref="alg1.11.11.1.m1.2.2.1.1.1.3.1">normal-:</ci><cn id="alg1.11.11.1.m1.2.2.1.1.1.3.2.cmml" type="integer" xref="alg1.11.11.1.m1.2.2.1.1.1.3.2">1</cn><apply id="alg1.11.11.1.m1.2.2.1.1.1.3.3.cmml" xref="alg1.11.11.1.m1.2.2.1.1.1.3.3"><minus id="alg1.11.11.1.m1.2.2.1.1.1.3.3.1.cmml" xref="alg1.11.11.1.m1.2.2.1.1.1.3.3.1"></minus><ci id="alg1.11.11.1.m1.2.2.1.1.1.3.3.2.cmml" xref="alg1.11.11.1.m1.2.2.1.1.1.3.3.2">𝑡</ci><cn id="alg1.11.11.1.m1.2.2.1.1.1.3.3.3.cmml" type="integer" xref="alg1.11.11.1.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="alg1.11.11.1.m1.1.1.cmml" xref="alg1.11.11.1.m1.1.1">𝑝</ci></list><apply id="alg1.11.11.1.m1.2.2.3.cmml" xref="alg1.11.11.1.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.11.11.1.m1.2.2.3.1.cmml" xref="alg1.11.11.1.m1.2.2.3">subscript</csymbol><ci id="alg1.11.11.1.m1.2.2.3.2.cmml" xref="alg1.11.11.1.m1.2.2.3.2">𝐵</ci><apply id="alg1.11.11.1.m1.2.2.3.3.cmml" xref="alg1.11.11.1.m1.2.2.3.3"><minus id="alg1.11.11.1.m1.2.2.3.3.1.cmml" xref="alg1.11.11.1.m1.2.2.3.3.1"></minus><ci id="alg1.11.11.1.m1.2.2.3.3.2.cmml" xref="alg1.11.11.1.m1.2.2.3.3.2">𝑡</ci><cn id="alg1.11.11.1.m1.2.2.3.3.3.cmml" type="integer" xref="alg1.11.11.1.m1.2.2.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.1.m1.2c">\langle\mathbf{y}_{1:t-1},p\rangle\in B_{t-1}</annotation><annotation encoding="application/x-llamapun" id="alg1.11.11.1.m1.2d">⟨ bold_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , italic_p ⟩ ∈ italic_B start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.11.11.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.12.12">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg1.12.12.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg1.12.12.1"><math alttext="k=1,\cdots,K" class="ltx_Math" display="inline" id="alg1.12.12.1.m1.3"><semantics id="alg1.12.12.1.m1.3a"><mrow id="alg1.12.12.1.m1.3.4" xref="alg1.12.12.1.m1.3.4.cmml"><mi id="alg1.12.12.1.m1.3.4.2" xref="alg1.12.12.1.m1.3.4.2.cmml">k</mi><mo id="alg1.12.12.1.m1.3.4.1" mathvariant="normal" xref="alg1.12.12.1.m1.3.4.1.cmml">=</mo><mrow id="alg1.12.12.1.m1.3.4.3.2" xref="alg1.12.12.1.m1.3.4.3.1.cmml"><mn id="alg1.12.12.1.m1.1.1" mathvariant="normal" xref="alg1.12.12.1.m1.1.1.cmml">1</mn><mo id="alg1.12.12.1.m1.3.4.3.2.1" mathvariant="normal" xref="alg1.12.12.1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.12.12.1.m1.2.2" mathvariant="normal" xref="alg1.12.12.1.m1.2.2.cmml">⋯</mi><mo id="alg1.12.12.1.m1.3.4.3.2.2" mathvariant="normal" xref="alg1.12.12.1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.12.12.1.m1.3.3" xref="alg1.12.12.1.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.12.12.1.m1.3b"><apply id="alg1.12.12.1.m1.3.4.cmml" xref="alg1.12.12.1.m1.3.4"><eq id="alg1.12.12.1.m1.3.4.1.cmml" xref="alg1.12.12.1.m1.3.4.1"></eq><ci id="alg1.12.12.1.m1.3.4.2.cmml" xref="alg1.12.12.1.m1.3.4.2">𝑘</ci><list id="alg1.12.12.1.m1.3.4.3.1.cmml" xref="alg1.12.12.1.m1.3.4.3.2"><cn id="alg1.12.12.1.m1.1.1.cmml" type="integer" xref="alg1.12.12.1.m1.1.1">1</cn><ci id="alg1.12.12.1.m1.2.2.cmml" xref="alg1.12.12.1.m1.2.2">normal-⋯</ci><ci id="alg1.12.12.1.m1.3.3.cmml" xref="alg1.12.12.1.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.1.m1.3c">k=1,\cdots,K</annotation><annotation encoding="application/x-llamapun" id="alg1.12.12.1.m1.3d">italic_k = 1 , ⋯ , italic_K</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.12.12.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.14.14">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="B^{\prime}_{t,k}\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.13.13.m1.2"><semantics id="alg1.13.13.m1.2a"><mrow id="alg1.13.13.m1.2.3" xref="alg1.13.13.m1.2.3.cmml"><msubsup id="alg1.13.13.m1.2.3.2" xref="alg1.13.13.m1.2.3.2.cmml"><mi id="alg1.13.13.m1.2.3.2.2.2" xref="alg1.13.13.m1.2.3.2.2.2.cmml">B</mi><mrow id="alg1.13.13.m1.2.2.2.4" xref="alg1.13.13.m1.2.2.2.3.cmml"><mi id="alg1.13.13.m1.1.1.1.1" xref="alg1.13.13.m1.1.1.1.1.cmml">t</mi><mo id="alg1.13.13.m1.2.2.2.4.1" xref="alg1.13.13.m1.2.2.2.3.cmml">,</mo><mi id="alg1.13.13.m1.2.2.2.2" xref="alg1.13.13.m1.2.2.2.2.cmml">k</mi></mrow><mo id="alg1.13.13.m1.2.3.2.2.3" xref="alg1.13.13.m1.2.3.2.2.3.cmml">′</mo></msubsup><mo id="alg1.13.13.m1.2.3.1" stretchy="false" xref="alg1.13.13.m1.2.3.1.cmml">←</mo><mi id="alg1.13.13.m1.2.3.3" mathvariant="normal" xref="alg1.13.13.m1.2.3.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.13.13.m1.2b"><apply id="alg1.13.13.m1.2.3.cmml" xref="alg1.13.13.m1.2.3"><ci id="alg1.13.13.m1.2.3.1.cmml" xref="alg1.13.13.m1.2.3.1">←</ci><apply id="alg1.13.13.m1.2.3.2.cmml" xref="alg1.13.13.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.13.13.m1.2.3.2.1.cmml" xref="alg1.13.13.m1.2.3.2">subscript</csymbol><apply id="alg1.13.13.m1.2.3.2.2.cmml" xref="alg1.13.13.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.13.13.m1.2.3.2.2.1.cmml" xref="alg1.13.13.m1.2.3.2">superscript</csymbol><ci id="alg1.13.13.m1.2.3.2.2.2.cmml" xref="alg1.13.13.m1.2.3.2.2.2">𝐵</ci><ci id="alg1.13.13.m1.2.3.2.2.3.cmml" xref="alg1.13.13.m1.2.3.2.2.3">′</ci></apply><list id="alg1.13.13.m1.2.2.2.3.cmml" xref="alg1.13.13.m1.2.2.2.4"><ci id="alg1.13.13.m1.1.1.1.1.cmml" xref="alg1.13.13.m1.1.1.1.1">𝑡</ci><ci id="alg1.13.13.m1.2.2.2.2.cmml" xref="alg1.13.13.m1.2.2.2.2">𝑘</ci></list></apply><emptyset id="alg1.13.13.m1.2.3.3.cmml" xref="alg1.13.13.m1.2.3.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.m1.2c">B^{\prime}_{t,k}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.13.13.m1.2d">italic_B start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t , italic_k end_POSTSUBSCRIPT ← ∅</annotation></semantics></math> <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.14.14.m2.1"><semantics id="alg1.14.14.m2.1a"><mo id="alg1.14.14.m2.1.1" xref="alg1.14.14.m2.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.14.14.m2.1b"><ci id="alg1.14.14.m2.1.1.cmml" xref="alg1.14.14.m2.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.m2.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.14.14.m2.1d">▷</annotation></semantics></math> lower-level beam 
</div>
<div class="ltx_listingline" id="alg1.15.15">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg1.15.15.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg1.15.15.1"><math alttext="\mathrm{y}\in V" class="ltx_Math" display="inline" id="alg1.15.15.1.m1.1"><semantics id="alg1.15.15.1.m1.1a"><mrow id="alg1.15.15.1.m1.1.1" xref="alg1.15.15.1.m1.1.1.cmml"><mi id="alg1.15.15.1.m1.1.1.2" mathvariant="normal" xref="alg1.15.15.1.m1.1.1.2.cmml">y</mi><mo id="alg1.15.15.1.m1.1.1.1" mathvariant="normal" xref="alg1.15.15.1.m1.1.1.1.cmml">∈</mo><mi id="alg1.15.15.1.m1.1.1.3" xref="alg1.15.15.1.m1.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.15.15.1.m1.1b"><apply id="alg1.15.15.1.m1.1.1.cmml" xref="alg1.15.15.1.m1.1.1"><in id="alg1.15.15.1.m1.1.1.1.cmml" xref="alg1.15.15.1.m1.1.1.1"></in><ci id="alg1.15.15.1.m1.1.1.2.cmml" xref="alg1.15.15.1.m1.1.1.2">normal-y</ci><ci id="alg1.15.15.1.m1.1.1.3.cmml" xref="alg1.15.15.1.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.1.m1.1c">\mathrm{y}\in V</annotation><annotation encoding="application/x-llamapun" id="alg1.15.15.1.m1.1d">roman_y ∈ italic_V</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.15.15.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.16.16">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="p^{\prime}\leftarrow p_{k}(\mathrm{y}|\mathbf{y}_{1:t-1},\mathbf{x})" class="ltx_Math" display="inline" id="alg1.16.16.m1.2"><semantics id="alg1.16.16.m1.2a"><mrow id="alg1.16.16.m1.2.2" xref="alg1.16.16.m1.2.2.cmml"><msup id="alg1.16.16.m1.2.2.3" xref="alg1.16.16.m1.2.2.3.cmml"><mi id="alg1.16.16.m1.2.2.3.2" xref="alg1.16.16.m1.2.2.3.2.cmml">p</mi><mo id="alg1.16.16.m1.2.2.3.3" xref="alg1.16.16.m1.2.2.3.3.cmml">′</mo></msup><mo id="alg1.16.16.m1.2.2.2" stretchy="false" xref="alg1.16.16.m1.2.2.2.cmml">←</mo><mrow id="alg1.16.16.m1.2.2.1" xref="alg1.16.16.m1.2.2.1.cmml"><msub id="alg1.16.16.m1.2.2.1.3" xref="alg1.16.16.m1.2.2.1.3.cmml"><mi id="alg1.16.16.m1.2.2.1.3.2" xref="alg1.16.16.m1.2.2.1.3.2.cmml">p</mi><mi id="alg1.16.16.m1.2.2.1.3.3" xref="alg1.16.16.m1.2.2.1.3.3.cmml">k</mi></msub><mo id="alg1.16.16.m1.2.2.1.2" xref="alg1.16.16.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.16.16.m1.2.2.1.1.1" xref="alg1.16.16.m1.2.2.1.1.1.1.cmml"><mo id="alg1.16.16.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.16.16.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg1.16.16.m1.2.2.1.1.1.1" xref="alg1.16.16.m1.2.2.1.1.1.1.cmml"><mi id="alg1.16.16.m1.2.2.1.1.1.1.3" mathvariant="normal" xref="alg1.16.16.m1.2.2.1.1.1.1.3.cmml">y</mi><mo fence="false" id="alg1.16.16.m1.2.2.1.1.1.1.2" xref="alg1.16.16.m1.2.2.1.1.1.1.2.cmml">|</mo><mrow id="alg1.16.16.m1.2.2.1.1.1.1.1.1" xref="alg1.16.16.m1.2.2.1.1.1.1.1.2.cmml"><msub id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.2" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝐲</mi><mrow id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mn id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.2" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.2" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.1" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.3" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="alg1.16.16.m1.2.2.1.1.1.1.1.1.2" xref="alg1.16.16.m1.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="alg1.16.16.m1.1.1" xref="alg1.16.16.m1.1.1.cmml">𝐱</mi></mrow></mrow><mo id="alg1.16.16.m1.2.2.1.1.1.3" stretchy="false" xref="alg1.16.16.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.16.16.m1.2b"><apply id="alg1.16.16.m1.2.2.cmml" xref="alg1.16.16.m1.2.2"><ci id="alg1.16.16.m1.2.2.2.cmml" xref="alg1.16.16.m1.2.2.2">←</ci><apply id="alg1.16.16.m1.2.2.3.cmml" xref="alg1.16.16.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.16.16.m1.2.2.3.1.cmml" xref="alg1.16.16.m1.2.2.3">superscript</csymbol><ci id="alg1.16.16.m1.2.2.3.2.cmml" xref="alg1.16.16.m1.2.2.3.2">𝑝</ci><ci id="alg1.16.16.m1.2.2.3.3.cmml" xref="alg1.16.16.m1.2.2.3.3">′</ci></apply><apply id="alg1.16.16.m1.2.2.1.cmml" xref="alg1.16.16.m1.2.2.1"><times id="alg1.16.16.m1.2.2.1.2.cmml" xref="alg1.16.16.m1.2.2.1.2"></times><apply id="alg1.16.16.m1.2.2.1.3.cmml" xref="alg1.16.16.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.16.16.m1.2.2.1.3.1.cmml" xref="alg1.16.16.m1.2.2.1.3">subscript</csymbol><ci id="alg1.16.16.m1.2.2.1.3.2.cmml" xref="alg1.16.16.m1.2.2.1.3.2">𝑝</ci><ci id="alg1.16.16.m1.2.2.1.3.3.cmml" xref="alg1.16.16.m1.2.2.1.3.3">𝑘</ci></apply><apply id="alg1.16.16.m1.2.2.1.1.1.1.cmml" xref="alg1.16.16.m1.2.2.1.1.1"><csymbol cd="latexml" id="alg1.16.16.m1.2.2.1.1.1.1.2.cmml" xref="alg1.16.16.m1.2.2.1.1.1.1.2">conditional</csymbol><ci id="alg1.16.16.m1.2.2.1.1.1.1.3.cmml" xref="alg1.16.16.m1.2.2.1.1.1.1.3">y</ci><list id="alg1.16.16.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1"><apply id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.2">𝐲</ci><apply id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3"><ci id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.1">:</ci><cn id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.2">1</cn><apply id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3"><minus id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.1"></minus><ci id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="alg1.16.16.m1.2.2.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="alg1.16.16.m1.1.1.cmml" xref="alg1.16.16.m1.1.1">𝐱</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m1.2c">p^{\prime}\leftarrow p_{k}(\mathrm{y}|\mathbf{y}_{1:t-1},\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="alg1.16.16.m1.2d">italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( roman_y | bold_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_x )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.17.17">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="B^{\prime}_{k}.\operatorname{add}(\langle\mathbf{y}_{1:t-1}\oplus\mathrm{y},p%
\cdot p^{\prime}\rangle)" class="ltx_Math" display="inline" id="alg1.17.17.m1.3"><semantics id="alg1.17.17.m1.3a"><mrow id="alg1.17.17.m1.3.3.2" xref="alg1.17.17.m1.3.3.3.cmml"><msubsup id="alg1.17.17.m1.2.2.1.1" xref="alg1.17.17.m1.2.2.1.1.cmml"><mi id="alg1.17.17.m1.2.2.1.1.2.2" xref="alg1.17.17.m1.2.2.1.1.2.2.cmml">B</mi><mi id="alg1.17.17.m1.2.2.1.1.3" xref="alg1.17.17.m1.2.2.1.1.3.cmml">k</mi><mo id="alg1.17.17.m1.2.2.1.1.2.3" xref="alg1.17.17.m1.2.2.1.1.2.3.cmml">′</mo></msubsup><mo id="alg1.17.17.m1.3.3.2.3" lspace="0em" rspace="0.167em" xref="alg1.17.17.m1.3.3.3a.cmml">.</mo><mrow id="alg1.17.17.m1.3.3.2.2.1" xref="alg1.17.17.m1.3.3.2.2.2.cmml"><mi id="alg1.17.17.m1.1.1" xref="alg1.17.17.m1.1.1.cmml">add</mi><mo id="alg1.17.17.m1.3.3.2.2.1a" xref="alg1.17.17.m1.3.3.2.2.2.cmml">⁡</mo><mrow id="alg1.17.17.m1.3.3.2.2.1.1" xref="alg1.17.17.m1.3.3.2.2.2.cmml"><mo id="alg1.17.17.m1.3.3.2.2.1.1.2" stretchy="false" xref="alg1.17.17.m1.3.3.2.2.2.cmml">(</mo><mrow id="alg1.17.17.m1.3.3.2.2.1.1.1.2" xref="alg1.17.17.m1.3.3.2.2.1.1.1.3.cmml"><mo id="alg1.17.17.m1.3.3.2.2.1.1.1.2.3" stretchy="false" xref="alg1.17.17.m1.3.3.2.2.1.1.1.3.cmml">⟨</mo><mrow id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.cmml"><msub id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.cmml"><mi id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.2" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.2.cmml">𝐲</mi><mrow id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.cmml"><mn id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.2" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.1.cmml">:</mo><mrow id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.cmml"><mi id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.2" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.2.cmml">t</mi><mo id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.1" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.3" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.1" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.1.cmml">⊕</mo><mi id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.3" mathvariant="normal" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.3.cmml">y</mi></mrow><mo id="alg1.17.17.m1.3.3.2.2.1.1.1.2.4" xref="alg1.17.17.m1.3.3.2.2.1.1.1.3.cmml">,</mo><mrow id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.cmml"><mi id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.2" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.2.cmml">p</mi><mo id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.1.cmml">⋅</mo><msup id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3.cmml"><mi id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3.2" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3.2.cmml">p</mi><mo id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3.3" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3.3.cmml">′</mo></msup></mrow><mo id="alg1.17.17.m1.3.3.2.2.1.1.1.2.5" stretchy="false" xref="alg1.17.17.m1.3.3.2.2.1.1.1.3.cmml">⟩</mo></mrow><mo id="alg1.17.17.m1.3.3.2.2.1.1.3" stretchy="false" xref="alg1.17.17.m1.3.3.2.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.17.17.m1.3b"><apply id="alg1.17.17.m1.3.3.3.cmml" xref="alg1.17.17.m1.3.3.2"><csymbol cd="ambiguous" id="alg1.17.17.m1.3.3.3a.cmml" xref="alg1.17.17.m1.3.3.2.3">formulae-sequence</csymbol><apply id="alg1.17.17.m1.2.2.1.1.cmml" xref="alg1.17.17.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.17.17.m1.2.2.1.1.1.cmml" xref="alg1.17.17.m1.2.2.1.1">subscript</csymbol><apply id="alg1.17.17.m1.2.2.1.1.2.cmml" xref="alg1.17.17.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.17.17.m1.2.2.1.1.2.1.cmml" xref="alg1.17.17.m1.2.2.1.1">superscript</csymbol><ci id="alg1.17.17.m1.2.2.1.1.2.2.cmml" xref="alg1.17.17.m1.2.2.1.1.2.2">𝐵</ci><ci id="alg1.17.17.m1.2.2.1.1.2.3.cmml" xref="alg1.17.17.m1.2.2.1.1.2.3">′</ci></apply><ci id="alg1.17.17.m1.2.2.1.1.3.cmml" xref="alg1.17.17.m1.2.2.1.1.3">𝑘</ci></apply><apply id="alg1.17.17.m1.3.3.2.2.2.cmml" xref="alg1.17.17.m1.3.3.2.2.1"><ci id="alg1.17.17.m1.1.1.cmml" xref="alg1.17.17.m1.1.1">add</ci><list id="alg1.17.17.m1.3.3.2.2.1.1.1.3.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2"><apply id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1"><csymbol cd="latexml" id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.1.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.1">direct-sum</csymbol><apply id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.1.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.2.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.2">𝐲</ci><apply id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3"><ci id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.1.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.1">:</ci><cn id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.2.cmml" type="integer" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.2">1</cn><apply id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3"><minus id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.1.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.1"></minus><ci id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.2.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.2">𝑡</ci><cn id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><ci id="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.3.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.1.1.3">y</ci></apply><apply id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2"><ci id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.1.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.1">⋅</ci><ci id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.2.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.2">𝑝</ci><apply id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3"><csymbol cd="ambiguous" id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3.1.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3">superscript</csymbol><ci id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3.2.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3.2">𝑝</ci><ci id="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3.3.cmml" xref="alg1.17.17.m1.3.3.2.2.1.1.1.2.2.3.3">′</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.m1.3c">B^{\prime}_{k}.\operatorname{add}(\langle\mathbf{y}_{1:t-1}\oplus\mathrm{y},p%
\cdot p^{\prime}\rangle)</annotation><annotation encoding="application/x-llamapun" id="alg1.17.17.m1.3d">italic_B start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT . roman_add ( ⟨ bold_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT ⊕ roman_y , italic_p ⋅ italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ⟩ )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.18.18">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="B^{\prime}_{t,k}\leftarrow B^{\prime}_{t,k}.\operatorname{top}(Z)" class="ltx_Math" display="inline" id="alg1.18.18.m1.8"><semantics id="alg1.18.18.m1.8a"><mrow id="alg1.18.18.m1.8.8.2" xref="alg1.18.18.m1.8.8.3.cmml"><mrow id="alg1.18.18.m1.7.7.1.1" xref="alg1.18.18.m1.7.7.1.1.cmml"><msubsup id="alg1.18.18.m1.7.7.1.1.2" xref="alg1.18.18.m1.7.7.1.1.2.cmml"><mi id="alg1.18.18.m1.7.7.1.1.2.2.2" xref="alg1.18.18.m1.7.7.1.1.2.2.2.cmml">B</mi><mrow id="alg1.18.18.m1.2.2.2.4" xref="alg1.18.18.m1.2.2.2.3.cmml"><mi id="alg1.18.18.m1.1.1.1.1" xref="alg1.18.18.m1.1.1.1.1.cmml">t</mi><mo id="alg1.18.18.m1.2.2.2.4.1" xref="alg1.18.18.m1.2.2.2.3.cmml">,</mo><mi id="alg1.18.18.m1.2.2.2.2" xref="alg1.18.18.m1.2.2.2.2.cmml">k</mi></mrow><mo id="alg1.18.18.m1.7.7.1.1.2.2.3" xref="alg1.18.18.m1.7.7.1.1.2.2.3.cmml">′</mo></msubsup><mo id="alg1.18.18.m1.7.7.1.1.1" stretchy="false" xref="alg1.18.18.m1.7.7.1.1.1.cmml">←</mo><msubsup id="alg1.18.18.m1.7.7.1.1.3" xref="alg1.18.18.m1.7.7.1.1.3.cmml"><mi id="alg1.18.18.m1.7.7.1.1.3.2.2" xref="alg1.18.18.m1.7.7.1.1.3.2.2.cmml">B</mi><mrow id="alg1.18.18.m1.4.4.2.4" xref="alg1.18.18.m1.4.4.2.3.cmml"><mi id="alg1.18.18.m1.3.3.1.1" xref="alg1.18.18.m1.3.3.1.1.cmml">t</mi><mo id="alg1.18.18.m1.4.4.2.4.1" xref="alg1.18.18.m1.4.4.2.3.cmml">,</mo><mi id="alg1.18.18.m1.4.4.2.2" xref="alg1.18.18.m1.4.4.2.2.cmml">k</mi></mrow><mo id="alg1.18.18.m1.7.7.1.1.3.2.3" xref="alg1.18.18.m1.7.7.1.1.3.2.3.cmml">′</mo></msubsup></mrow><mo id="alg1.18.18.m1.8.8.2.3" lspace="0em" rspace="0.167em" xref="alg1.18.18.m1.8.8.3a.cmml">.</mo><mrow id="alg1.18.18.m1.8.8.2.2.2" xref="alg1.18.18.m1.8.8.2.2.1.cmml"><mi id="alg1.18.18.m1.5.5" xref="alg1.18.18.m1.5.5.cmml">top</mi><mo id="alg1.18.18.m1.8.8.2.2.2a" xref="alg1.18.18.m1.8.8.2.2.1.cmml">⁡</mo><mrow id="alg1.18.18.m1.8.8.2.2.2.1" xref="alg1.18.18.m1.8.8.2.2.1.cmml"><mo id="alg1.18.18.m1.8.8.2.2.2.1.1" stretchy="false" xref="alg1.18.18.m1.8.8.2.2.1.cmml">(</mo><mi id="alg1.18.18.m1.6.6" xref="alg1.18.18.m1.6.6.cmml">Z</mi><mo id="alg1.18.18.m1.8.8.2.2.2.1.2" stretchy="false" xref="alg1.18.18.m1.8.8.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.18.18.m1.8b"><apply id="alg1.18.18.m1.8.8.3.cmml" xref="alg1.18.18.m1.8.8.2"><csymbol cd="ambiguous" id="alg1.18.18.m1.8.8.3a.cmml" xref="alg1.18.18.m1.8.8.2.3">formulae-sequence</csymbol><apply id="alg1.18.18.m1.7.7.1.1.cmml" xref="alg1.18.18.m1.7.7.1.1"><ci id="alg1.18.18.m1.7.7.1.1.1.cmml" xref="alg1.18.18.m1.7.7.1.1.1">←</ci><apply id="alg1.18.18.m1.7.7.1.1.2.cmml" xref="alg1.18.18.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="alg1.18.18.m1.7.7.1.1.2.1.cmml" xref="alg1.18.18.m1.7.7.1.1.2">subscript</csymbol><apply id="alg1.18.18.m1.7.7.1.1.2.2.cmml" xref="alg1.18.18.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="alg1.18.18.m1.7.7.1.1.2.2.1.cmml" xref="alg1.18.18.m1.7.7.1.1.2">superscript</csymbol><ci id="alg1.18.18.m1.7.7.1.1.2.2.2.cmml" xref="alg1.18.18.m1.7.7.1.1.2.2.2">𝐵</ci><ci id="alg1.18.18.m1.7.7.1.1.2.2.3.cmml" xref="alg1.18.18.m1.7.7.1.1.2.2.3">′</ci></apply><list id="alg1.18.18.m1.2.2.2.3.cmml" xref="alg1.18.18.m1.2.2.2.4"><ci id="alg1.18.18.m1.1.1.1.1.cmml" xref="alg1.18.18.m1.1.1.1.1">𝑡</ci><ci id="alg1.18.18.m1.2.2.2.2.cmml" xref="alg1.18.18.m1.2.2.2.2">𝑘</ci></list></apply><apply id="alg1.18.18.m1.7.7.1.1.3.cmml" xref="alg1.18.18.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="alg1.18.18.m1.7.7.1.1.3.1.cmml" xref="alg1.18.18.m1.7.7.1.1.3">subscript</csymbol><apply id="alg1.18.18.m1.7.7.1.1.3.2.cmml" xref="alg1.18.18.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="alg1.18.18.m1.7.7.1.1.3.2.1.cmml" xref="alg1.18.18.m1.7.7.1.1.3">superscript</csymbol><ci id="alg1.18.18.m1.7.7.1.1.3.2.2.cmml" xref="alg1.18.18.m1.7.7.1.1.3.2.2">𝐵</ci><ci id="alg1.18.18.m1.7.7.1.1.3.2.3.cmml" xref="alg1.18.18.m1.7.7.1.1.3.2.3">′</ci></apply><list id="alg1.18.18.m1.4.4.2.3.cmml" xref="alg1.18.18.m1.4.4.2.4"><ci id="alg1.18.18.m1.3.3.1.1.cmml" xref="alg1.18.18.m1.3.3.1.1">𝑡</ci><ci id="alg1.18.18.m1.4.4.2.2.cmml" xref="alg1.18.18.m1.4.4.2.2">𝑘</ci></list></apply></apply><apply id="alg1.18.18.m1.8.8.2.2.1.cmml" xref="alg1.18.18.m1.8.8.2.2.2"><ci id="alg1.18.18.m1.5.5.cmml" xref="alg1.18.18.m1.5.5">top</ci><ci id="alg1.18.18.m1.6.6.cmml" xref="alg1.18.18.m1.6.6">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.m1.8c">B^{\prime}_{t,k}\leftarrow B^{\prime}_{t,k}.\operatorname{top}(Z)</annotation><annotation encoding="application/x-llamapun" id="alg1.18.18.m1.8d">italic_B start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t , italic_k end_POSTSUBSCRIPT ← italic_B start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t , italic_k end_POSTSUBSCRIPT . roman_top ( italic_Z )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.32.33">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg1.19.19">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.19.19.m1.1"><semantics id="alg1.19.19.m1.1a"><mo id="alg1.19.19.m1.1.1" xref="alg1.19.19.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.19.19.m1.1b"><ci id="alg1.19.19.m1.1.1.cmml" xref="alg1.19.19.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.19.19.m1.1d">▷</annotation></semantics></math> upper level: beam synchronization 
</div>
<div class="ltx_listingline" id="alg1.20.20">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="D\leftarrow\text{empty dictionary}" class="ltx_Math" display="inline" id="alg1.20.20.m1.1"><semantics id="alg1.20.20.m1.1a"><mrow id="alg1.20.20.m1.1.1" xref="alg1.20.20.m1.1.1.cmml"><mi id="alg1.20.20.m1.1.1.2" xref="alg1.20.20.m1.1.1.2.cmml">D</mi><mo id="alg1.20.20.m1.1.1.1" stretchy="false" xref="alg1.20.20.m1.1.1.1.cmml">←</mo><mtext id="alg1.20.20.m1.1.1.3" xref="alg1.20.20.m1.1.1.3a.cmml">empty dictionary</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.20.20.m1.1b"><apply id="alg1.20.20.m1.1.1.cmml" xref="alg1.20.20.m1.1.1"><ci id="alg1.20.20.m1.1.1.1.cmml" xref="alg1.20.20.m1.1.1.1">←</ci><ci id="alg1.20.20.m1.1.1.2.cmml" xref="alg1.20.20.m1.1.1.2">𝐷</ci><ci id="alg1.20.20.m1.1.1.3a.cmml" xref="alg1.20.20.m1.1.1.3"><mtext id="alg1.20.20.m1.1.1.3.cmml" xref="alg1.20.20.m1.1.1.3">empty dictionary</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.20.m1.1c">D\leftarrow\text{empty dictionary}</annotation><annotation encoding="application/x-llamapun" id="alg1.20.20.m1.1d">italic_D ← empty dictionary</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.21.21">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg1.21.21.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg1.21.21.1"><math alttext="k=1,\cdots,K" class="ltx_Math" display="inline" id="alg1.21.21.1.m1.3"><semantics id="alg1.21.21.1.m1.3a"><mrow id="alg1.21.21.1.m1.3.4" xref="alg1.21.21.1.m1.3.4.cmml"><mi id="alg1.21.21.1.m1.3.4.2" xref="alg1.21.21.1.m1.3.4.2.cmml">k</mi><mo id="alg1.21.21.1.m1.3.4.1" mathvariant="normal" xref="alg1.21.21.1.m1.3.4.1.cmml">=</mo><mrow id="alg1.21.21.1.m1.3.4.3.2" xref="alg1.21.21.1.m1.3.4.3.1.cmml"><mn id="alg1.21.21.1.m1.1.1" mathvariant="normal" xref="alg1.21.21.1.m1.1.1.cmml">1</mn><mo id="alg1.21.21.1.m1.3.4.3.2.1" mathvariant="normal" xref="alg1.21.21.1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.21.21.1.m1.2.2" mathvariant="normal" xref="alg1.21.21.1.m1.2.2.cmml">⋯</mi><mo id="alg1.21.21.1.m1.3.4.3.2.2" mathvariant="normal" xref="alg1.21.21.1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.21.21.1.m1.3.3" xref="alg1.21.21.1.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.21.21.1.m1.3b"><apply id="alg1.21.21.1.m1.3.4.cmml" xref="alg1.21.21.1.m1.3.4"><eq id="alg1.21.21.1.m1.3.4.1.cmml" xref="alg1.21.21.1.m1.3.4.1"></eq><ci id="alg1.21.21.1.m1.3.4.2.cmml" xref="alg1.21.21.1.m1.3.4.2">𝑘</ci><list id="alg1.21.21.1.m1.3.4.3.1.cmml" xref="alg1.21.21.1.m1.3.4.3.2"><cn id="alg1.21.21.1.m1.1.1.cmml" type="integer" xref="alg1.21.21.1.m1.1.1">1</cn><ci id="alg1.21.21.1.m1.2.2.cmml" xref="alg1.21.21.1.m1.2.2">normal-⋯</ci><ci id="alg1.21.21.1.m1.3.3.cmml" xref="alg1.21.21.1.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.21.1.m1.3c">k=1,\cdots,K</annotation><annotation encoding="application/x-llamapun" id="alg1.21.21.1.m1.3d">italic_k = 1 , ⋯ , italic_K</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.21.21.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.22.22">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg1.22.22.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg1.22.22.1"><math alttext="\langle\mathbf{y},p\rangle\in B^{\prime}_{t,k}.\operatorname{top}(Z)" class="ltx_Math" display="inline" id="alg1.22.22.1.m1.8"><semantics id="alg1.22.22.1.m1.8a"><mrow id="alg1.22.22.1.m1.8.8.2" xref="alg1.22.22.1.m1.8.8.3.cmml"><mrow id="alg1.22.22.1.m1.7.7.1.1" xref="alg1.22.22.1.m1.7.7.1.1.cmml"><mrow id="alg1.22.22.1.m1.7.7.1.1.2.2" xref="alg1.22.22.1.m1.7.7.1.1.2.1.cmml"><mo id="alg1.22.22.1.m1.7.7.1.1.2.2.1" mathvariant="normal" stretchy="false" xref="alg1.22.22.1.m1.7.7.1.1.2.1.cmml">⟨</mo><mi id="alg1.22.22.1.m1.3.3" xref="alg1.22.22.1.m1.3.3.cmml">𝐲</mi><mo id="alg1.22.22.1.m1.7.7.1.1.2.2.2" mathvariant="normal" xref="alg1.22.22.1.m1.7.7.1.1.2.1.cmml">,</mo><mi id="alg1.22.22.1.m1.4.4" xref="alg1.22.22.1.m1.4.4.cmml">p</mi><mo id="alg1.22.22.1.m1.7.7.1.1.2.2.3" mathvariant="normal" stretchy="false" xref="alg1.22.22.1.m1.7.7.1.1.2.1.cmml">⟩</mo></mrow><mo id="alg1.22.22.1.m1.7.7.1.1.1" mathvariant="normal" xref="alg1.22.22.1.m1.7.7.1.1.1.cmml">∈</mo><msubsup id="alg1.22.22.1.m1.7.7.1.1.3" xref="alg1.22.22.1.m1.7.7.1.1.3.cmml"><mi id="alg1.22.22.1.m1.7.7.1.1.3.2.2" xref="alg1.22.22.1.m1.7.7.1.1.3.2.2.cmml">B</mi><mrow id="alg1.22.22.1.m1.2.2.2.4" xref="alg1.22.22.1.m1.2.2.2.3.cmml"><mi id="alg1.22.22.1.m1.1.1.1.1" xref="alg1.22.22.1.m1.1.1.1.1.cmml">t</mi><mo id="alg1.22.22.1.m1.2.2.2.4.1" mathvariant="normal" xref="alg1.22.22.1.m1.2.2.2.3.cmml">,</mo><mi id="alg1.22.22.1.m1.2.2.2.2" xref="alg1.22.22.1.m1.2.2.2.2.cmml">k</mi></mrow><mo id="alg1.22.22.1.m1.7.7.1.1.3.2.3" mathvariant="normal" xref="alg1.22.22.1.m1.7.7.1.1.3.2.3.cmml">′</mo></msubsup></mrow><mo id="alg1.22.22.1.m1.8.8.2.3" lspace="0em" mathvariant="normal" rspace="0.167em" xref="alg1.22.22.1.m1.8.8.3a.cmml">.</mo><mrow id="alg1.22.22.1.m1.8.8.2.2.2" xref="alg1.22.22.1.m1.8.8.2.2.1.cmml"><mi id="alg1.22.22.1.m1.5.5" mathvariant="normal" xref="alg1.22.22.1.m1.5.5.cmml">top</mi><mo id="alg1.22.22.1.m1.8.8.2.2.2a" mathvariant="italic" xref="alg1.22.22.1.m1.8.8.2.2.1.cmml">⁡</mo><mrow id="alg1.22.22.1.m1.8.8.2.2.2.1" xref="alg1.22.22.1.m1.8.8.2.2.1.cmml"><mo id="alg1.22.22.1.m1.8.8.2.2.2.1.1" mathvariant="normal" stretchy="false" xref="alg1.22.22.1.m1.8.8.2.2.1.cmml">(</mo><mi id="alg1.22.22.1.m1.6.6" xref="alg1.22.22.1.m1.6.6.cmml">Z</mi><mo id="alg1.22.22.1.m1.8.8.2.2.2.1.2" mathvariant="normal" stretchy="false" xref="alg1.22.22.1.m1.8.8.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.22.22.1.m1.8b"><apply id="alg1.22.22.1.m1.8.8.3.cmml" xref="alg1.22.22.1.m1.8.8.2"><csymbol cd="ambiguous" id="alg1.22.22.1.m1.8.8.3a.cmml" xref="alg1.22.22.1.m1.8.8.2.3">formulae-sequence</csymbol><apply id="alg1.22.22.1.m1.7.7.1.1.cmml" xref="alg1.22.22.1.m1.7.7.1.1"><in id="alg1.22.22.1.m1.7.7.1.1.1.cmml" xref="alg1.22.22.1.m1.7.7.1.1.1"></in><list id="alg1.22.22.1.m1.7.7.1.1.2.1.cmml" xref="alg1.22.22.1.m1.7.7.1.1.2.2"><ci id="alg1.22.22.1.m1.3.3.cmml" xref="alg1.22.22.1.m1.3.3">𝐲</ci><ci id="alg1.22.22.1.m1.4.4.cmml" xref="alg1.22.22.1.m1.4.4">𝑝</ci></list><apply id="alg1.22.22.1.m1.7.7.1.1.3.cmml" xref="alg1.22.22.1.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="alg1.22.22.1.m1.7.7.1.1.3.1.cmml" xref="alg1.22.22.1.m1.7.7.1.1.3">subscript</csymbol><apply id="alg1.22.22.1.m1.7.7.1.1.3.2.cmml" xref="alg1.22.22.1.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="alg1.22.22.1.m1.7.7.1.1.3.2.1.cmml" xref="alg1.22.22.1.m1.7.7.1.1.3">superscript</csymbol><ci id="alg1.22.22.1.m1.7.7.1.1.3.2.2.cmml" xref="alg1.22.22.1.m1.7.7.1.1.3.2.2">𝐵</ci><ci id="alg1.22.22.1.m1.7.7.1.1.3.2.3.cmml" xref="alg1.22.22.1.m1.7.7.1.1.3.2.3">normal-′</ci></apply><list id="alg1.22.22.1.m1.2.2.2.3.cmml" xref="alg1.22.22.1.m1.2.2.2.4"><ci id="alg1.22.22.1.m1.1.1.1.1.cmml" xref="alg1.22.22.1.m1.1.1.1.1">𝑡</ci><ci id="alg1.22.22.1.m1.2.2.2.2.cmml" xref="alg1.22.22.1.m1.2.2.2.2">𝑘</ci></list></apply></apply><apply id="alg1.22.22.1.m1.8.8.2.2.1.cmml" xref="alg1.22.22.1.m1.8.8.2.2.2"><ci id="alg1.22.22.1.m1.5.5.cmml" xref="alg1.22.22.1.m1.5.5">normal-top</ci><ci id="alg1.22.22.1.m1.6.6.cmml" xref="alg1.22.22.1.m1.6.6">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.22.1.m1.8c">\langle\mathbf{y},p\rangle\in B^{\prime}_{t,k}.\operatorname{top}(Z)</annotation><annotation encoding="application/x-llamapun" id="alg1.22.22.1.m1.8d">⟨ bold_y , italic_p ⟩ ∈ italic_B start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t , italic_k end_POSTSUBSCRIPT . roman_top ( italic_Z )</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.22.22.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.23.23">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg1.23.23.2">if</span> <em class="ltx_emph ltx_font_italic" id="alg1.23.23.1"><math alttext="\mathbf{y}\in D" class="ltx_Math" display="inline" id="alg1.23.23.1.m1.1"><semantics id="alg1.23.23.1.m1.1a"><mrow id="alg1.23.23.1.m1.1.1" xref="alg1.23.23.1.m1.1.1.cmml"><mi id="alg1.23.23.1.m1.1.1.2" xref="alg1.23.23.1.m1.1.1.2.cmml">𝐲</mi><mo id="alg1.23.23.1.m1.1.1.1" mathvariant="normal" xref="alg1.23.23.1.m1.1.1.1.cmml">∈</mo><mi id="alg1.23.23.1.m1.1.1.3" xref="alg1.23.23.1.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.23.23.1.m1.1b"><apply id="alg1.23.23.1.m1.1.1.cmml" xref="alg1.23.23.1.m1.1.1"><in id="alg1.23.23.1.m1.1.1.1.cmml" xref="alg1.23.23.1.m1.1.1.1"></in><ci id="alg1.23.23.1.m1.1.1.2.cmml" xref="alg1.23.23.1.m1.1.1.2">𝐲</ci><ci id="alg1.23.23.1.m1.1.1.3.cmml" xref="alg1.23.23.1.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.23.1.m1.1c">\mathbf{y}\in D</annotation><annotation encoding="application/x-llamapun" id="alg1.23.23.1.m1.1d">bold_y ∈ italic_D</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.23.23.3">then</span>
</div>
<div class="ltx_listingline" id="alg1.24.24">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="D[\mathbf{y}]\leftarrow p+D[\mathbf{y}]" class="ltx_Math" display="inline" id="alg1.24.24.m1.2"><semantics id="alg1.24.24.m1.2a"><mrow id="alg1.24.24.m1.2.3" xref="alg1.24.24.m1.2.3.cmml"><mrow id="alg1.24.24.m1.2.3.2" xref="alg1.24.24.m1.2.3.2.cmml"><mi id="alg1.24.24.m1.2.3.2.2" xref="alg1.24.24.m1.2.3.2.2.cmml">D</mi><mo id="alg1.24.24.m1.2.3.2.1" xref="alg1.24.24.m1.2.3.2.1.cmml">⁢</mo><mrow id="alg1.24.24.m1.2.3.2.3.2" xref="alg1.24.24.m1.2.3.2.3.1.cmml"><mo id="alg1.24.24.m1.2.3.2.3.2.1" stretchy="false" xref="alg1.24.24.m1.2.3.2.3.1.1.cmml">[</mo><mi id="alg1.24.24.m1.1.1" xref="alg1.24.24.m1.1.1.cmml">𝐲</mi><mo id="alg1.24.24.m1.2.3.2.3.2.2" stretchy="false" xref="alg1.24.24.m1.2.3.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.24.24.m1.2.3.1" stretchy="false" xref="alg1.24.24.m1.2.3.1.cmml">←</mo><mrow id="alg1.24.24.m1.2.3.3" xref="alg1.24.24.m1.2.3.3.cmml"><mi id="alg1.24.24.m1.2.3.3.2" xref="alg1.24.24.m1.2.3.3.2.cmml">p</mi><mo id="alg1.24.24.m1.2.3.3.1" xref="alg1.24.24.m1.2.3.3.1.cmml">+</mo><mrow id="alg1.24.24.m1.2.3.3.3" xref="alg1.24.24.m1.2.3.3.3.cmml"><mi id="alg1.24.24.m1.2.3.3.3.2" xref="alg1.24.24.m1.2.3.3.3.2.cmml">D</mi><mo id="alg1.24.24.m1.2.3.3.3.1" xref="alg1.24.24.m1.2.3.3.3.1.cmml">⁢</mo><mrow id="alg1.24.24.m1.2.3.3.3.3.2" xref="alg1.24.24.m1.2.3.3.3.3.1.cmml"><mo id="alg1.24.24.m1.2.3.3.3.3.2.1" stretchy="false" xref="alg1.24.24.m1.2.3.3.3.3.1.1.cmml">[</mo><mi id="alg1.24.24.m1.2.2" xref="alg1.24.24.m1.2.2.cmml">𝐲</mi><mo id="alg1.24.24.m1.2.3.3.3.3.2.2" stretchy="false" xref="alg1.24.24.m1.2.3.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.24.24.m1.2b"><apply id="alg1.24.24.m1.2.3.cmml" xref="alg1.24.24.m1.2.3"><ci id="alg1.24.24.m1.2.3.1.cmml" xref="alg1.24.24.m1.2.3.1">←</ci><apply id="alg1.24.24.m1.2.3.2.cmml" xref="alg1.24.24.m1.2.3.2"><times id="alg1.24.24.m1.2.3.2.1.cmml" xref="alg1.24.24.m1.2.3.2.1"></times><ci id="alg1.24.24.m1.2.3.2.2.cmml" xref="alg1.24.24.m1.2.3.2.2">𝐷</ci><apply id="alg1.24.24.m1.2.3.2.3.1.cmml" xref="alg1.24.24.m1.2.3.2.3.2"><csymbol cd="latexml" id="alg1.24.24.m1.2.3.2.3.1.1.cmml" xref="alg1.24.24.m1.2.3.2.3.2.1">delimited-[]</csymbol><ci id="alg1.24.24.m1.1.1.cmml" xref="alg1.24.24.m1.1.1">𝐲</ci></apply></apply><apply id="alg1.24.24.m1.2.3.3.cmml" xref="alg1.24.24.m1.2.3.3"><plus id="alg1.24.24.m1.2.3.3.1.cmml" xref="alg1.24.24.m1.2.3.3.1"></plus><ci id="alg1.24.24.m1.2.3.3.2.cmml" xref="alg1.24.24.m1.2.3.3.2">𝑝</ci><apply id="alg1.24.24.m1.2.3.3.3.cmml" xref="alg1.24.24.m1.2.3.3.3"><times id="alg1.24.24.m1.2.3.3.3.1.cmml" xref="alg1.24.24.m1.2.3.3.3.1"></times><ci id="alg1.24.24.m1.2.3.3.3.2.cmml" xref="alg1.24.24.m1.2.3.3.3.2">𝐷</ci><apply id="alg1.24.24.m1.2.3.3.3.3.1.cmml" xref="alg1.24.24.m1.2.3.3.3.3.2"><csymbol cd="latexml" id="alg1.24.24.m1.2.3.3.3.3.1.1.cmml" xref="alg1.24.24.m1.2.3.3.3.3.2.1">delimited-[]</csymbol><ci id="alg1.24.24.m1.2.2.cmml" xref="alg1.24.24.m1.2.2">𝐲</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.24.m1.2c">D[\mathbf{y}]\leftarrow p+D[\mathbf{y}]</annotation><annotation encoding="application/x-llamapun" id="alg1.24.24.m1.2d">italic_D [ bold_y ] ← italic_p + italic_D [ bold_y ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.32.34">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="alg1.32.34.1">else</span>
</div>
<div class="ltx_listingline" id="alg1.25.25">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="D[\mathbf{y}]\leftarrow p" class="ltx_Math" display="inline" id="alg1.25.25.m1.1"><semantics id="alg1.25.25.m1.1a"><mrow id="alg1.25.25.m1.1.2" xref="alg1.25.25.m1.1.2.cmml"><mrow id="alg1.25.25.m1.1.2.2" xref="alg1.25.25.m1.1.2.2.cmml"><mi id="alg1.25.25.m1.1.2.2.2" xref="alg1.25.25.m1.1.2.2.2.cmml">D</mi><mo id="alg1.25.25.m1.1.2.2.1" xref="alg1.25.25.m1.1.2.2.1.cmml">⁢</mo><mrow id="alg1.25.25.m1.1.2.2.3.2" xref="alg1.25.25.m1.1.2.2.3.1.cmml"><mo id="alg1.25.25.m1.1.2.2.3.2.1" stretchy="false" xref="alg1.25.25.m1.1.2.2.3.1.1.cmml">[</mo><mi id="alg1.25.25.m1.1.1" xref="alg1.25.25.m1.1.1.cmml">𝐲</mi><mo id="alg1.25.25.m1.1.2.2.3.2.2" stretchy="false" xref="alg1.25.25.m1.1.2.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.25.25.m1.1.2.1" stretchy="false" xref="alg1.25.25.m1.1.2.1.cmml">←</mo><mi id="alg1.25.25.m1.1.2.3" xref="alg1.25.25.m1.1.2.3.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.25.25.m1.1b"><apply id="alg1.25.25.m1.1.2.cmml" xref="alg1.25.25.m1.1.2"><ci id="alg1.25.25.m1.1.2.1.cmml" xref="alg1.25.25.m1.1.2.1">←</ci><apply id="alg1.25.25.m1.1.2.2.cmml" xref="alg1.25.25.m1.1.2.2"><times id="alg1.25.25.m1.1.2.2.1.cmml" xref="alg1.25.25.m1.1.2.2.1"></times><ci id="alg1.25.25.m1.1.2.2.2.cmml" xref="alg1.25.25.m1.1.2.2.2">𝐷</ci><apply id="alg1.25.25.m1.1.2.2.3.1.cmml" xref="alg1.25.25.m1.1.2.2.3.2"><csymbol cd="latexml" id="alg1.25.25.m1.1.2.2.3.1.1.cmml" xref="alg1.25.25.m1.1.2.2.3.2.1">delimited-[]</csymbol><ci id="alg1.25.25.m1.1.1.cmml" xref="alg1.25.25.m1.1.1">𝐲</ci></apply></apply><ci id="alg1.25.25.m1.1.2.3.cmml" xref="alg1.25.25.m1.1.2.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.25.m1.1c">D[\mathbf{y}]\leftarrow p</annotation><annotation encoding="application/x-llamapun" id="alg1.25.25.m1.1d">italic_D [ bold_y ] ← italic_p</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.32.35">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg1.32.36">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg1.26.26">
<span class="ltx_tag ltx_tag_listingline">23</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="B_{t}\leftarrow D.\operatorname{top}(Z)" class="ltx_Math" display="inline" id="alg1.26.26.m1.4"><semantics id="alg1.26.26.m1.4a"><mrow id="alg1.26.26.m1.4.4.2" xref="alg1.26.26.m1.4.4.3.cmml"><mrow id="alg1.26.26.m1.3.3.1.1" xref="alg1.26.26.m1.3.3.1.1.cmml"><msub id="alg1.26.26.m1.3.3.1.1.2" xref="alg1.26.26.m1.3.3.1.1.2.cmml"><mi id="alg1.26.26.m1.3.3.1.1.2.2" xref="alg1.26.26.m1.3.3.1.1.2.2.cmml">B</mi><mi id="alg1.26.26.m1.3.3.1.1.2.3" xref="alg1.26.26.m1.3.3.1.1.2.3.cmml">t</mi></msub><mo id="alg1.26.26.m1.3.3.1.1.1" stretchy="false" xref="alg1.26.26.m1.3.3.1.1.1.cmml">←</mo><mi id="alg1.26.26.m1.3.3.1.1.3" xref="alg1.26.26.m1.3.3.1.1.3.cmml">D</mi></mrow><mo id="alg1.26.26.m1.4.4.2.3" lspace="0em" rspace="0.167em" xref="alg1.26.26.m1.4.4.3a.cmml">.</mo><mrow id="alg1.26.26.m1.4.4.2.2.2" xref="alg1.26.26.m1.4.4.2.2.1.cmml"><mi id="alg1.26.26.m1.1.1" xref="alg1.26.26.m1.1.1.cmml">top</mi><mo id="alg1.26.26.m1.4.4.2.2.2a" xref="alg1.26.26.m1.4.4.2.2.1.cmml">⁡</mo><mrow id="alg1.26.26.m1.4.4.2.2.2.1" xref="alg1.26.26.m1.4.4.2.2.1.cmml"><mo id="alg1.26.26.m1.4.4.2.2.2.1.1" stretchy="false" xref="alg1.26.26.m1.4.4.2.2.1.cmml">(</mo><mi id="alg1.26.26.m1.2.2" xref="alg1.26.26.m1.2.2.cmml">Z</mi><mo id="alg1.26.26.m1.4.4.2.2.2.1.2" stretchy="false" xref="alg1.26.26.m1.4.4.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.26.26.m1.4b"><apply id="alg1.26.26.m1.4.4.3.cmml" xref="alg1.26.26.m1.4.4.2"><csymbol cd="ambiguous" id="alg1.26.26.m1.4.4.3a.cmml" xref="alg1.26.26.m1.4.4.2.3">formulae-sequence</csymbol><apply id="alg1.26.26.m1.3.3.1.1.cmml" xref="alg1.26.26.m1.3.3.1.1"><ci id="alg1.26.26.m1.3.3.1.1.1.cmml" xref="alg1.26.26.m1.3.3.1.1.1">←</ci><apply id="alg1.26.26.m1.3.3.1.1.2.cmml" xref="alg1.26.26.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="alg1.26.26.m1.3.3.1.1.2.1.cmml" xref="alg1.26.26.m1.3.3.1.1.2">subscript</csymbol><ci id="alg1.26.26.m1.3.3.1.1.2.2.cmml" xref="alg1.26.26.m1.3.3.1.1.2.2">𝐵</ci><ci id="alg1.26.26.m1.3.3.1.1.2.3.cmml" xref="alg1.26.26.m1.3.3.1.1.2.3">𝑡</ci></apply><ci id="alg1.26.26.m1.3.3.1.1.3.cmml" xref="alg1.26.26.m1.3.3.1.1.3">𝐷</ci></apply><apply id="alg1.26.26.m1.4.4.2.2.1.cmml" xref="alg1.26.26.m1.4.4.2.2.2"><ci id="alg1.26.26.m1.1.1.cmml" xref="alg1.26.26.m1.1.1">top</ci><ci id="alg1.26.26.m1.2.2.cmml" xref="alg1.26.26.m1.2.2">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.26.m1.4c">B_{t}\leftarrow D.\operatorname{top}(Z)</annotation><annotation encoding="application/x-llamapun" id="alg1.26.26.m1.4d">italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← italic_D . roman_top ( italic_Z )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.27.27">
<span class="ltx_tag ltx_tag_listingline">24</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.27.27.m1.1"><semantics id="alg1.27.27.m1.1a"><mo id="alg1.27.27.m1.1.1" xref="alg1.27.27.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.27.27.m1.1b"><ci id="alg1.27.27.m1.1.1.cmml" xref="alg1.27.27.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.27.27.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.27.27.m1.1d">▷</annotation></semantics></math> check for termination 
</div>
<div class="ltx_listingline" id="alg1.28.28">
<span class="ltx_tag ltx_tag_listingline">25</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg1.28.28.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg1.28.28.1"><math alttext="\langle\mathbf{y},p\rangle\in B_{t}" class="ltx_Math" display="inline" id="alg1.28.28.1.m1.2"><semantics id="alg1.28.28.1.m1.2a"><mrow id="alg1.28.28.1.m1.2.3" xref="alg1.28.28.1.m1.2.3.cmml"><mrow id="alg1.28.28.1.m1.2.3.2.2" xref="alg1.28.28.1.m1.2.3.2.1.cmml"><mo id="alg1.28.28.1.m1.2.3.2.2.1" mathvariant="normal" stretchy="false" xref="alg1.28.28.1.m1.2.3.2.1.cmml">⟨</mo><mi id="alg1.28.28.1.m1.1.1" xref="alg1.28.28.1.m1.1.1.cmml">𝐲</mi><mo id="alg1.28.28.1.m1.2.3.2.2.2" mathvariant="normal" xref="alg1.28.28.1.m1.2.3.2.1.cmml">,</mo><mi id="alg1.28.28.1.m1.2.2" xref="alg1.28.28.1.m1.2.2.cmml">p</mi><mo id="alg1.28.28.1.m1.2.3.2.2.3" mathvariant="normal" stretchy="false" xref="alg1.28.28.1.m1.2.3.2.1.cmml">⟩</mo></mrow><mo id="alg1.28.28.1.m1.2.3.1" mathvariant="normal" xref="alg1.28.28.1.m1.2.3.1.cmml">∈</mo><msub id="alg1.28.28.1.m1.2.3.3" xref="alg1.28.28.1.m1.2.3.3.cmml"><mi id="alg1.28.28.1.m1.2.3.3.2" xref="alg1.28.28.1.m1.2.3.3.2.cmml">B</mi><mi id="alg1.28.28.1.m1.2.3.3.3" xref="alg1.28.28.1.m1.2.3.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.28.28.1.m1.2b"><apply id="alg1.28.28.1.m1.2.3.cmml" xref="alg1.28.28.1.m1.2.3"><in id="alg1.28.28.1.m1.2.3.1.cmml" xref="alg1.28.28.1.m1.2.3.1"></in><list id="alg1.28.28.1.m1.2.3.2.1.cmml" xref="alg1.28.28.1.m1.2.3.2.2"><ci id="alg1.28.28.1.m1.1.1.cmml" xref="alg1.28.28.1.m1.1.1">𝐲</ci><ci id="alg1.28.28.1.m1.2.2.cmml" xref="alg1.28.28.1.m1.2.2">𝑝</ci></list><apply id="alg1.28.28.1.m1.2.3.3.cmml" xref="alg1.28.28.1.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.28.28.1.m1.2.3.3.1.cmml" xref="alg1.28.28.1.m1.2.3.3">subscript</csymbol><ci id="alg1.28.28.1.m1.2.3.3.2.cmml" xref="alg1.28.28.1.m1.2.3.3.2">𝐵</ci><ci id="alg1.28.28.1.m1.2.3.3.3.cmml" xref="alg1.28.28.1.m1.2.3.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.28.28.1.m1.2c">\langle\mathbf{y},p\rangle\in B_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.28.28.1.m1.2d">⟨ bold_y , italic_p ⟩ ∈ italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.28.28.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.29.29">
<span class="ltx_tag ltx_tag_listingline">26</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg1.29.29.2">if</span> <em class="ltx_emph ltx_font_italic" id="alg1.29.29.1"><math alttext="\mathrm{y}_{t}=\textsc{eos}" class="ltx_Math" display="inline" id="alg1.29.29.1.m1.1"><semantics id="alg1.29.29.1.m1.1a"><mrow id="alg1.29.29.1.m1.1.1" xref="alg1.29.29.1.m1.1.1.cmml"><msub id="alg1.29.29.1.m1.1.1.2" xref="alg1.29.29.1.m1.1.1.2.cmml"><mi id="alg1.29.29.1.m1.1.1.2.2" mathvariant="normal" xref="alg1.29.29.1.m1.1.1.2.2.cmml">y</mi><mi id="alg1.29.29.1.m1.1.1.2.3" xref="alg1.29.29.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg1.29.29.1.m1.1.1.1" mathvariant="normal" xref="alg1.29.29.1.m1.1.1.1.cmml">=</mo><mtext class="ltx_font_smallcaps" id="alg1.29.29.1.m1.1.1.3" mathvariant="normal" xref="alg1.29.29.1.m1.1.1.3b.cmml"><em class="ltx_emph ltx_font_smallcaps" id="alg1.29.29.1.m1.1.1.3.1nest">eos</em></mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.29.29.1.m1.1b"><apply id="alg1.29.29.1.m1.1.1.cmml" xref="alg1.29.29.1.m1.1.1"><eq id="alg1.29.29.1.m1.1.1.1.cmml" xref="alg1.29.29.1.m1.1.1.1"></eq><apply id="alg1.29.29.1.m1.1.1.2.cmml" xref="alg1.29.29.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.29.29.1.m1.1.1.2.1.cmml" xref="alg1.29.29.1.m1.1.1.2">subscript</csymbol><ci id="alg1.29.29.1.m1.1.1.2.2.cmml" xref="alg1.29.29.1.m1.1.1.2.2">normal-y</ci><ci id="alg1.29.29.1.m1.1.1.2.3.cmml" xref="alg1.29.29.1.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.29.29.1.m1.1.1.3b.cmml" xref="alg1.29.29.1.m1.1.1.3"><mtext class="ltx_font_smallcaps" id="alg1.29.29.1.m1.1.1.3.cmml" mathvariant="normal" xref="alg1.29.29.1.m1.1.1.3"><em class="ltx_emph ltx_font_smallcaps" id="alg1.29.29.1.m1.1.1.3.1anest">eos</em></mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.29.29.1.m1.1c">\mathrm{y}_{t}=\textsc{eos}</annotation><annotation encoding="application/x-llamapun" id="alg1.29.29.1.m1.1d">roman_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = eos</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.29.29.3">then</span>
</div>
<div class="ltx_listingline" id="alg1.30.30">
<span class="ltx_tag ltx_tag_listingline">27</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="H.\operatorname{add}(\langle\mathbf{y},p\rangle)" class="ltx_Math" display="inline" id="alg1.30.30.m1.5"><semantics id="alg1.30.30.m1.5a"><mrow id="alg1.30.30.m1.5.5.1" xref="alg1.30.30.m1.5.5.2.cmml"><mi id="alg1.30.30.m1.4.4" xref="alg1.30.30.m1.4.4.cmml">H</mi><mo id="alg1.30.30.m1.5.5.1.2" lspace="0em" rspace="0.167em" xref="alg1.30.30.m1.5.5.2a.cmml">.</mo><mrow id="alg1.30.30.m1.5.5.1.1.1" xref="alg1.30.30.m1.5.5.1.1.2.cmml"><mi id="alg1.30.30.m1.3.3" xref="alg1.30.30.m1.3.3.cmml">add</mi><mo id="alg1.30.30.m1.5.5.1.1.1a" xref="alg1.30.30.m1.5.5.1.1.2.cmml">⁡</mo><mrow id="alg1.30.30.m1.5.5.1.1.1.1" xref="alg1.30.30.m1.5.5.1.1.2.cmml"><mo id="alg1.30.30.m1.5.5.1.1.1.1.2" stretchy="false" xref="alg1.30.30.m1.5.5.1.1.2.cmml">(</mo><mrow id="alg1.30.30.m1.5.5.1.1.1.1.1.2" xref="alg1.30.30.m1.5.5.1.1.1.1.1.1.cmml"><mo id="alg1.30.30.m1.5.5.1.1.1.1.1.2.1" stretchy="false" xref="alg1.30.30.m1.5.5.1.1.1.1.1.1.cmml">⟨</mo><mi id="alg1.30.30.m1.1.1" xref="alg1.30.30.m1.1.1.cmml">𝐲</mi><mo id="alg1.30.30.m1.5.5.1.1.1.1.1.2.2" xref="alg1.30.30.m1.5.5.1.1.1.1.1.1.cmml">,</mo><mi id="alg1.30.30.m1.2.2" xref="alg1.30.30.m1.2.2.cmml">p</mi><mo id="alg1.30.30.m1.5.5.1.1.1.1.1.2.3" stretchy="false" xref="alg1.30.30.m1.5.5.1.1.1.1.1.1.cmml">⟩</mo></mrow><mo id="alg1.30.30.m1.5.5.1.1.1.1.3" stretchy="false" xref="alg1.30.30.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.30.30.m1.5b"><apply id="alg1.30.30.m1.5.5.2.cmml" xref="alg1.30.30.m1.5.5.1"><csymbol cd="ambiguous" id="alg1.30.30.m1.5.5.2a.cmml" xref="alg1.30.30.m1.5.5.1.2">formulae-sequence</csymbol><ci id="alg1.30.30.m1.4.4.cmml" xref="alg1.30.30.m1.4.4">𝐻</ci><apply id="alg1.30.30.m1.5.5.1.1.2.cmml" xref="alg1.30.30.m1.5.5.1.1.1"><ci id="alg1.30.30.m1.3.3.cmml" xref="alg1.30.30.m1.3.3">add</ci><list id="alg1.30.30.m1.5.5.1.1.1.1.1.1.cmml" xref="alg1.30.30.m1.5.5.1.1.1.1.1.2"><ci id="alg1.30.30.m1.1.1.cmml" xref="alg1.30.30.m1.1.1">𝐲</ci><ci id="alg1.30.30.m1.2.2.cmml" xref="alg1.30.30.m1.2.2">𝑝</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.30.30.m1.5c">H.\operatorname{add}(\langle\mathbf{y},p\rangle)</annotation><annotation encoding="application/x-llamapun" id="alg1.30.30.m1.5d">italic_H . roman_add ( ⟨ bold_y , italic_p ⟩ )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.31.31">
<span class="ltx_tag ltx_tag_listingline">28</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg1.31.31.2">if</span> <em class="ltx_emph ltx_font_italic" id="alg1.31.31.1"><math alttext="|H|=Z" class="ltx_Math" display="inline" id="alg1.31.31.1.m1.1"><semantics id="alg1.31.31.1.m1.1a"><mrow id="alg1.31.31.1.m1.1.2" xref="alg1.31.31.1.m1.1.2.cmml"><mrow id="alg1.31.31.1.m1.1.2.2.2" xref="alg1.31.31.1.m1.1.2.2.1.cmml"><mo id="alg1.31.31.1.m1.1.2.2.2.1" mathvariant="normal" stretchy="false" xref="alg1.31.31.1.m1.1.2.2.1.1.cmml">|</mo><mi id="alg1.31.31.1.m1.1.1" xref="alg1.31.31.1.m1.1.1.cmml">H</mi><mo id="alg1.31.31.1.m1.1.2.2.2.2" mathvariant="normal" stretchy="false" xref="alg1.31.31.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="alg1.31.31.1.m1.1.2.1" mathvariant="normal" xref="alg1.31.31.1.m1.1.2.1.cmml">=</mo><mi id="alg1.31.31.1.m1.1.2.3" xref="alg1.31.31.1.m1.1.2.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.31.31.1.m1.1b"><apply id="alg1.31.31.1.m1.1.2.cmml" xref="alg1.31.31.1.m1.1.2"><eq id="alg1.31.31.1.m1.1.2.1.cmml" xref="alg1.31.31.1.m1.1.2.1"></eq><apply id="alg1.31.31.1.m1.1.2.2.1.cmml" xref="alg1.31.31.1.m1.1.2.2.2"><abs id="alg1.31.31.1.m1.1.2.2.1.1.cmml" xref="alg1.31.31.1.m1.1.2.2.2.1"></abs><ci id="alg1.31.31.1.m1.1.1.cmml" xref="alg1.31.31.1.m1.1.1">𝐻</ci></apply><ci id="alg1.31.31.1.m1.1.2.3.cmml" xref="alg1.31.31.1.m1.1.2.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.31.31.1.m1.1c">|H|=Z</annotation><annotation encoding="application/x-llamapun" id="alg1.31.31.1.m1.1d">| italic_H | = italic_Z</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.31.31.3">then</span>
</div>
<div class="ltx_listingline" id="alg1.32.32">
<span class="ltx_tag ltx_tag_listingline">29</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg1.32.32.1">return</span> <math alttext="H.\operatorname{top}(1)" class="ltx_Math" display="inline" id="alg1.32.32.m1.4"><semantics id="alg1.32.32.m1.4a"><mrow id="alg1.32.32.m1.4.4.1" xref="alg1.32.32.m1.4.4.2.cmml"><mi id="alg1.32.32.m1.3.3" xref="alg1.32.32.m1.3.3.cmml">H</mi><mo id="alg1.32.32.m1.4.4.1.2" lspace="0em" rspace="0.167em" xref="alg1.32.32.m1.4.4.2a.cmml">.</mo><mrow id="alg1.32.32.m1.4.4.1.1.2" xref="alg1.32.32.m1.4.4.1.1.1.cmml"><mi id="alg1.32.32.m1.1.1" xref="alg1.32.32.m1.1.1.cmml">top</mi><mo id="alg1.32.32.m1.4.4.1.1.2a" xref="alg1.32.32.m1.4.4.1.1.1.cmml">⁡</mo><mrow id="alg1.32.32.m1.4.4.1.1.2.1" xref="alg1.32.32.m1.4.4.1.1.1.cmml"><mo id="alg1.32.32.m1.4.4.1.1.2.1.1" stretchy="false" xref="alg1.32.32.m1.4.4.1.1.1.cmml">(</mo><mn id="alg1.32.32.m1.2.2" xref="alg1.32.32.m1.2.2.cmml">1</mn><mo id="alg1.32.32.m1.4.4.1.1.2.1.2" stretchy="false" xref="alg1.32.32.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.32.32.m1.4b"><apply id="alg1.32.32.m1.4.4.2.cmml" xref="alg1.32.32.m1.4.4.1"><csymbol cd="ambiguous" id="alg1.32.32.m1.4.4.2a.cmml" xref="alg1.32.32.m1.4.4.1.2">formulae-sequence</csymbol><ci id="alg1.32.32.m1.3.3.cmml" xref="alg1.32.32.m1.3.3">𝐻</ci><apply id="alg1.32.32.m1.4.4.1.1.1.cmml" xref="alg1.32.32.m1.4.4.1.1.2"><ci id="alg1.32.32.m1.1.1.cmml" xref="alg1.32.32.m1.1.1">top</ci><cn id="alg1.32.32.m1.2.2.cmml" type="integer" xref="alg1.32.32.m1.2.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.32.32.m1.4c">H.\operatorname{top}(1)</annotation><annotation encoding="application/x-llamapun" id="alg1.32.32.m1.4d">italic_H . roman_top ( 1 )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.32.37">
<span class="ltx_tag ltx_tag_listingline">30</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg1.32.38">
<span class="ltx_tag ltx_tag_listingline">31</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg1.32.39">
<span class="ltx_tag ltx_tag_listingline">32</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg1.32.40">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.34.1.1">Algorithm 1</span> </span>Our EBBS Algorithm</figcaption>
</figure>
<br class="ltx_break ltx_centering"/>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">To this end, we propose an ensemble with bi-level beam search (EBBS), a novel decoding framework that enables different ensemble components to collaborate and vote on each other’s partial generations with two levels of beam search.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">At the lower level, each ensemble component performs beam search individually, exploring its own preferred regions of the sentence space.
At the upper level, EBBS synchronizes the lower-level beam candidates through a voting mechanism, only keeping the most promising partial generations in a shared, upper-level beam.
This allows the ensemble components to vote out spurious partial candidates and improve zero-shot translation performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.2">Concretely, we assume there are <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_K</annotation></semantics></math> ensemble components <math alttext="p_{1},\cdots,p_{K}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.3"><semantics id="S3.SS2.p3.2.m2.3a"><mrow id="S3.SS2.p3.2.m2.3.3.2" xref="S3.SS2.p3.2.m2.3.3.3.cmml"><msub id="S3.SS2.p3.2.m2.2.2.1.1" xref="S3.SS2.p3.2.m2.2.2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.2.2.1.1.2" xref="S3.SS2.p3.2.m2.2.2.1.1.2.cmml">p</mi><mn id="S3.SS2.p3.2.m2.2.2.1.1.3" xref="S3.SS2.p3.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p3.2.m2.3.3.2.3" xref="S3.SS2.p3.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS2.p3.2.m2.1.1" mathvariant="normal" xref="S3.SS2.p3.2.m2.1.1.cmml">⋯</mi><mo id="S3.SS2.p3.2.m2.3.3.2.4" xref="S3.SS2.p3.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS2.p3.2.m2.3.3.2.2" xref="S3.SS2.p3.2.m2.3.3.2.2.cmml"><mi id="S3.SS2.p3.2.m2.3.3.2.2.2" xref="S3.SS2.p3.2.m2.3.3.2.2.2.cmml">p</mi><mi id="S3.SS2.p3.2.m2.3.3.2.2.3" xref="S3.SS2.p3.2.m2.3.3.2.2.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.3b"><list id="S3.SS2.p3.2.m2.3.3.3.cmml" xref="S3.SS2.p3.2.m2.3.3.2"><apply id="S3.SS2.p3.2.m2.2.2.1.1.cmml" xref="S3.SS2.p3.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.2.2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.2.2.1.1.2">𝑝</ci><cn id="S3.SS2.p3.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p3.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">⋯</ci><apply id="S3.SS2.p3.2.m2.3.3.2.2.cmml" xref="S3.SS2.p3.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.3.3.2.2.1.cmml" xref="S3.SS2.p3.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p3.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.p3.2.m2.3.3.2.2.2">𝑝</ci><ci id="S3.SS2.p3.2.m2.3.3.2.2.3.cmml" xref="S3.SS2.p3.2.m2.3.3.2.2.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.3c">p_{1},\cdots,p_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.3d">italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , italic_p start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>, each predicting the probability of the next word given some prefix.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.3">For the <math alttext="0" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mn id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><cn id="S3.SS2.p4.1.m1.1.1.cmml" type="integer" xref="S3.SS2.p4.1.m1.1.1">0</cn></annotation-xml></semantics></math>th decoding step, EBBS initializes a shared, upper-level beam <math alttext="B_{0}=\langle\textsc{bos},1\rangle" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.2"><semantics id="S3.SS2.p4.2.m2.2a"><mrow id="S3.SS2.p4.2.m2.2.3" xref="S3.SS2.p4.2.m2.2.3.cmml"><msub id="S3.SS2.p4.2.m2.2.3.2" xref="S3.SS2.p4.2.m2.2.3.2.cmml"><mi id="S3.SS2.p4.2.m2.2.3.2.2" xref="S3.SS2.p4.2.m2.2.3.2.2.cmml">B</mi><mn id="S3.SS2.p4.2.m2.2.3.2.3" xref="S3.SS2.p4.2.m2.2.3.2.3.cmml">0</mn></msub><mo id="S3.SS2.p4.2.m2.2.3.1" xref="S3.SS2.p4.2.m2.2.3.1.cmml">=</mo><mrow id="S3.SS2.p4.2.m2.2.3.3.2" xref="S3.SS2.p4.2.m2.2.3.3.1.cmml"><mo id="S3.SS2.p4.2.m2.2.3.3.2.1" stretchy="false" xref="S3.SS2.p4.2.m2.2.3.3.1.cmml">⟨</mo><mtext class="ltx_font_smallcaps" id="S3.SS2.p4.2.m2.1.1" mathvariant="normal" xref="S3.SS2.p4.2.m2.1.1a.cmml">bos</mtext><mo id="S3.SS2.p4.2.m2.2.3.3.2.2" xref="S3.SS2.p4.2.m2.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p4.2.m2.2.2" xref="S3.SS2.p4.2.m2.2.2.cmml">1</mn><mo id="S3.SS2.p4.2.m2.2.3.3.2.3" stretchy="false" xref="S3.SS2.p4.2.m2.2.3.3.1.cmml">⟩</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.2b"><apply id="S3.SS2.p4.2.m2.2.3.cmml" xref="S3.SS2.p4.2.m2.2.3"><eq id="S3.SS2.p4.2.m2.2.3.1.cmml" xref="S3.SS2.p4.2.m2.2.3.1"></eq><apply id="S3.SS2.p4.2.m2.2.3.2.cmml" xref="S3.SS2.p4.2.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.2.3.2.1.cmml" xref="S3.SS2.p4.2.m2.2.3.2">subscript</csymbol><ci id="S3.SS2.p4.2.m2.2.3.2.2.cmml" xref="S3.SS2.p4.2.m2.2.3.2.2">𝐵</ci><cn id="S3.SS2.p4.2.m2.2.3.2.3.cmml" type="integer" xref="S3.SS2.p4.2.m2.2.3.2.3">0</cn></apply><list id="S3.SS2.p4.2.m2.2.3.3.1.cmml" xref="S3.SS2.p4.2.m2.2.3.3.2"><ci id="S3.SS2.p4.2.m2.1.1a.cmml" xref="S3.SS2.p4.2.m2.1.1"><mtext class="ltx_font_smallcaps" id="S3.SS2.p4.2.m2.1.1.cmml" mathvariant="normal" xref="S3.SS2.p4.2.m2.1.1">bos</mtext></ci><cn id="S3.SS2.p4.2.m2.2.2.cmml" type="integer" xref="S3.SS2.p4.2.m2.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.2c">B_{0}=\langle\textsc{bos},1\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.2d">italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = ⟨ bos , 1 ⟩</annotation></semantics></math>, suggesting that a sequence is forced to start with a special token <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p4.3.1">bos</span> with probability <math alttext="1" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><mn id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><cn id="S3.SS2.p4.3.m3.1.1.cmml" type="integer" xref="S3.SS2.p4.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">1</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.2">For step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><mi id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">italic_t</annotation></semantics></math>, each ensemble component performs a lower-level beam search individually, based on the prefixes in the last step’s shared beam <math alttext="B_{t-1}" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1"><semantics id="S3.SS2.p5.2.m2.1a"><msub id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">B</mi><mrow id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p5.2.m2.1.1.3.1" xref="S3.SS2.p5.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p5.2.m2.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">𝐵</ci><apply id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3"><minus id="S3.SS2.p5.2.m2.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3.1"></minus><ci id="S3.SS2.p5.2.m2.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2">𝑡</ci><cn id="S3.SS2.p5.2.m2.1.1.3.3.cmml" type="integer" xref="S3.SS2.p5.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">B_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.1d">italic_B start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A6.EGx1">
<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle B_{t,k}^{\prime}=" class="ltx_Math" display="inline" id="S3.Ex1.m1.2"><semantics id="S3.Ex1.m1.2a"><mrow id="S3.Ex1.m1.2.3" xref="S3.Ex1.m1.2.3.cmml"><msubsup id="S3.Ex1.m1.2.3.2" xref="S3.Ex1.m1.2.3.2.cmml"><mi id="S3.Ex1.m1.2.3.2.2.2" xref="S3.Ex1.m1.2.3.2.2.2.cmml">B</mi><mrow id="S3.Ex1.m1.2.2.2.4" xref="S3.Ex1.m1.2.2.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml">t</mi><mo id="S3.Ex1.m1.2.2.2.4.1" xref="S3.Ex1.m1.2.2.2.3.cmml">,</mo><mi id="S3.Ex1.m1.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.cmml">k</mi></mrow><mo id="S3.Ex1.m1.2.3.2.3" xref="S3.Ex1.m1.2.3.2.3.cmml">′</mo></msubsup><mo id="S3.Ex1.m1.2.3.1" xref="S3.Ex1.m1.2.3.1.cmml">=</mo><mi id="S3.Ex1.m1.2.3.3" xref="S3.Ex1.m1.2.3.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.2b"><apply id="S3.Ex1.m1.2.3.cmml" xref="S3.Ex1.m1.2.3"><eq id="S3.Ex1.m1.2.3.1.cmml" xref="S3.Ex1.m1.2.3.1"></eq><apply id="S3.Ex1.m1.2.3.2.cmml" xref="S3.Ex1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.2.1.cmml" xref="S3.Ex1.m1.2.3.2">superscript</csymbol><apply id="S3.Ex1.m1.2.3.2.2.cmml" xref="S3.Ex1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.2.2.1.cmml" xref="S3.Ex1.m1.2.3.2">subscript</csymbol><ci id="S3.Ex1.m1.2.3.2.2.2.cmml" xref="S3.Ex1.m1.2.3.2.2.2">𝐵</ci><list id="S3.Ex1.m1.2.2.2.3.cmml" xref="S3.Ex1.m1.2.2.2.4"><ci id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1">𝑡</ci><ci id="S3.Ex1.m1.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2">𝑘</ci></list></apply><ci id="S3.Ex1.m1.2.3.2.3.cmml" xref="S3.Ex1.m1.2.3.2.3">′</ci></apply><csymbol cd="latexml" id="S3.Ex1.m1.2.3.3.cmml" xref="S3.Ex1.m1.2.3.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.2c">\displaystyle B_{t,k}^{\prime}=</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.2d">italic_B start_POSTSUBSCRIPT italic_t , italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\operatorname{top-}\!Z\{\ \langle\mathbf{y}_{1:t-1}\oplus\mathrm{%
y},\ \ p\cdot p_{k}(\mathrm{y}|\mathbf{y}_{1:t-1},\mathbf{x})\rangle:" class="ltx_math_unparsed" display="inline" id="S3.Ex1.m2.1"><semantics id="S3.Ex1.m2.1a"><mrow id="S3.Ex1.m2.1b"><mrow id="S3.Ex1.m2.1.2"><mi id="S3.Ex1.m2.1.2.2">top</mi><mo id="S3.Ex1.m2.1.2.3">−</mo></mrow><mi id="S3.Ex1.m2.1.3">Z</mi><mrow id="S3.Ex1.m2.1.4"><mo id="S3.Ex1.m2.1.4.1" rspace="0.500em" stretchy="false">{</mo><mrow id="S3.Ex1.m2.1.4.2"><mo id="S3.Ex1.m2.1.4.2.1" stretchy="false">⟨</mo><msub id="S3.Ex1.m2.1.4.2.2"><mi id="S3.Ex1.m2.1.4.2.2.2">𝐲</mi><mrow id="S3.Ex1.m2.1.4.2.2.3"><mn id="S3.Ex1.m2.1.4.2.2.3.2">1</mn><mo id="S3.Ex1.m2.1.4.2.2.3.1" lspace="0.278em" rspace="0.278em">:</mo><mrow id="S3.Ex1.m2.1.4.2.2.3.3"><mi id="S3.Ex1.m2.1.4.2.2.3.3.2">t</mi><mo id="S3.Ex1.m2.1.4.2.2.3.3.1">−</mo><mn id="S3.Ex1.m2.1.4.2.2.3.3.3">1</mn></mrow></mrow></msub><mo id="S3.Ex1.m2.1.4.2.3">⊕</mo><mi id="S3.Ex1.m2.1.4.2.4" mathvariant="normal">y</mi><mo id="S3.Ex1.m2.1.4.2.5" rspace="1.167em">,</mo><mi id="S3.Ex1.m2.1.4.2.6">p</mi><mo id="S3.Ex1.m2.1.4.2.7" lspace="0.222em" rspace="0.222em">⋅</mo><msub id="S3.Ex1.m2.1.4.2.8"><mi id="S3.Ex1.m2.1.4.2.8.2">p</mi><mi id="S3.Ex1.m2.1.4.2.8.3">k</mi></msub><mrow id="S3.Ex1.m2.1.4.2.9"><mo id="S3.Ex1.m2.1.4.2.9.1" stretchy="false">(</mo><mi id="S3.Ex1.m2.1.4.2.9.2" mathvariant="normal">y</mi><mo fence="false" id="S3.Ex1.m2.1.4.2.9.3" rspace="0.167em" stretchy="false">|</mo><msub id="S3.Ex1.m2.1.4.2.9.4"><mi id="S3.Ex1.m2.1.4.2.9.4.2">𝐲</mi><mrow id="S3.Ex1.m2.1.4.2.9.4.3"><mn id="S3.Ex1.m2.1.4.2.9.4.3.2">1</mn><mo id="S3.Ex1.m2.1.4.2.9.4.3.1" lspace="0.278em" rspace="0.278em">:</mo><mrow id="S3.Ex1.m2.1.4.2.9.4.3.3"><mi id="S3.Ex1.m2.1.4.2.9.4.3.3.2">t</mi><mo id="S3.Ex1.m2.1.4.2.9.4.3.3.1">−</mo><mn id="S3.Ex1.m2.1.4.2.9.4.3.3.3">1</mn></mrow></mrow></msub><mo id="S3.Ex1.m2.1.4.2.9.5">,</mo><mi id="S3.Ex1.m2.1.1">𝐱</mi><mo id="S3.Ex1.m2.1.4.2.9.6" stretchy="false">)</mo></mrow><mo id="S3.Ex1.m2.1.4.2.10" rspace="0.278em" stretchy="false">⟩</mo></mrow><mo id="S3.Ex1.m2.1.4.3">:</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex1.m2.1c">\displaystyle\operatorname{top-}\!Z\{\ \langle\mathbf{y}_{1:t-1}\oplus\mathrm{%
y},\ \ p\cdot p_{k}(\mathrm{y}|\mathbf{y}_{1:t-1},\mathbf{x})\rangle:</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m2.1d">start_OPFUNCTION roman_top - end_OPFUNCTION italic_Z { ⟨ bold_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT ⊕ roman_y , italic_p ⋅ italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( roman_y | bold_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_x ) ⟩ :</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\hskip 37.5807pt\langle\mathbf{y}_{1:t-1},p\rangle\in B_{t-1},\ %
\ \mathrm{y}\in V\}" class="ltx_math_unparsed" display="inline" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1b"><mrow id="S3.E1.m1.1.2"><mo id="S3.E1.m1.1.2.1" stretchy="false">⟨</mo><msub id="S3.E1.m1.1.2.2"><mi id="S3.E1.m1.1.2.2.2">𝐲</mi><mrow id="S3.E1.m1.1.2.2.3"><mn id="S3.E1.m1.1.2.2.3.2">1</mn><mo id="S3.E1.m1.1.2.2.3.1" lspace="0.278em" rspace="0.278em">:</mo><mrow id="S3.E1.m1.1.2.2.3.3"><mi id="S3.E1.m1.1.2.2.3.3.2">t</mi><mo id="S3.E1.m1.1.2.2.3.3.1">−</mo><mn id="S3.E1.m1.1.2.2.3.3.3">1</mn></mrow></mrow></msub><mo id="S3.E1.m1.1.2.3">,</mo><mi id="S3.E1.m1.1.1">p</mi><mo id="S3.E1.m1.1.2.4" stretchy="false">⟩</mo></mrow><mo id="S3.E1.m1.1.3">∈</mo><msub id="S3.E1.m1.1.4"><mi id="S3.E1.m1.1.4.2">B</mi><mrow id="S3.E1.m1.1.4.3"><mi id="S3.E1.m1.1.4.3.2">t</mi><mo id="S3.E1.m1.1.4.3.1">−</mo><mn id="S3.E1.m1.1.4.3.3">1</mn></mrow></msub><mo id="S3.E1.m1.1.5" rspace="1.167em">,</mo><mi id="S3.E1.m1.1.6" mathvariant="normal">y</mi><mo id="S3.E1.m1.1.7">∈</mo><mi id="S3.E1.m1.1.8">V</mi><mo id="S3.E1.m1.1.9" stretchy="false">}</mo></mrow><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle\hskip 37.5807pt\langle\mathbf{y}_{1:t-1},p\rangle\in B_{t-1},\ %
\ \mathrm{y}\in V\}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">⟨ bold_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , italic_p ⟩ ∈ italic_B start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , roman_y ∈ italic_V }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p5.12">for <math alttext="k=1,\cdots,K" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m1.3"><semantics id="S3.SS2.p5.3.m1.3a"><mrow id="S3.SS2.p5.3.m1.3.4" xref="S3.SS2.p5.3.m1.3.4.cmml"><mi id="S3.SS2.p5.3.m1.3.4.2" xref="S3.SS2.p5.3.m1.3.4.2.cmml">k</mi><mo id="S3.SS2.p5.3.m1.3.4.1" xref="S3.SS2.p5.3.m1.3.4.1.cmml">=</mo><mrow id="S3.SS2.p5.3.m1.3.4.3.2" xref="S3.SS2.p5.3.m1.3.4.3.1.cmml"><mn id="S3.SS2.p5.3.m1.1.1" xref="S3.SS2.p5.3.m1.1.1.cmml">1</mn><mo id="S3.SS2.p5.3.m1.3.4.3.2.1" xref="S3.SS2.p5.3.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p5.3.m1.2.2" mathvariant="normal" xref="S3.SS2.p5.3.m1.2.2.cmml">⋯</mi><mo id="S3.SS2.p5.3.m1.3.4.3.2.2" xref="S3.SS2.p5.3.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p5.3.m1.3.3" xref="S3.SS2.p5.3.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m1.3b"><apply id="S3.SS2.p5.3.m1.3.4.cmml" xref="S3.SS2.p5.3.m1.3.4"><eq id="S3.SS2.p5.3.m1.3.4.1.cmml" xref="S3.SS2.p5.3.m1.3.4.1"></eq><ci id="S3.SS2.p5.3.m1.3.4.2.cmml" xref="S3.SS2.p5.3.m1.3.4.2">𝑘</ci><list id="S3.SS2.p5.3.m1.3.4.3.1.cmml" xref="S3.SS2.p5.3.m1.3.4.3.2"><cn id="S3.SS2.p5.3.m1.1.1.cmml" type="integer" xref="S3.SS2.p5.3.m1.1.1">1</cn><ci id="S3.SS2.p5.3.m1.2.2.cmml" xref="S3.SS2.p5.3.m1.2.2">⋯</ci><ci id="S3.SS2.p5.3.m1.3.3.cmml" xref="S3.SS2.p5.3.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m1.3c">k=1,\cdots,K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m1.3d">italic_k = 1 , ⋯ , italic_K</annotation></semantics></math>. Here, <math alttext="\operatorname{top-}\!Z" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m2.1"><semantics id="S3.SS2.p5.4.m2.1a"><mrow id="S3.SS2.p5.4.m2.1.1" xref="S3.SS2.p5.4.m2.1.1.cmml"><mrow id="S3.SS2.p5.4.m2.1.1.1" xref="S3.SS2.p5.4.m2.1.1.1.cmml"><mi id="S3.SS2.p5.4.m2.1.1.1.2" xref="S3.SS2.p5.4.m2.1.1.1.2.cmml">top</mi><mo id="S3.SS2.p5.4.m2.1.1.1.3" xref="S3.SS2.p5.4.m2.1.1.1.3.cmml">−</mo></mrow><mo id="S3.SS2.p5.4.m2.1.1a" xref="S3.SS2.p5.4.m2.1.1.cmml">⁡</mo><mi id="S3.SS2.p5.4.m2.1.1.2" xref="S3.SS2.p5.4.m2.1.1.2.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m2.1b"><apply id="S3.SS2.p5.4.m2.1.1.cmml" xref="S3.SS2.p5.4.m2.1.1"><apply id="S3.SS2.p5.4.m2.1.1.1.cmml" xref="S3.SS2.p5.4.m2.1.1.1"><csymbol cd="latexml" id="S3.SS2.p5.4.m2.1.1.1.1.cmml" xref="S3.SS2.p5.4.m2.1.1.1">limit-from</csymbol><ci id="S3.SS2.p5.4.m2.1.1.1.2.cmml" xref="S3.SS2.p5.4.m2.1.1.1.2">top</ci><minus id="S3.SS2.p5.4.m2.1.1.1.3.cmml" xref="S3.SS2.p5.4.m2.1.1.1.3"></minus></apply><ci id="S3.SS2.p5.4.m2.1.1.2.cmml" xref="S3.SS2.p5.4.m2.1.1.2">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m2.1c">\operatorname{top-}\!Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m2.1d">start_OPFUNCTION roman_top - end_OPFUNCTION italic_Z</annotation></semantics></math> selects <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.p5.5.m3.1"><semantics id="S3.SS2.p5.5.m3.1a"><mi id="S3.SS2.p5.5.m3.1.1" xref="S3.SS2.p5.5.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m3.1b"><ci id="S3.SS2.p5.5.m3.1.1.cmml" xref="S3.SS2.p5.5.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m3.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.5.m3.1d">italic_Z</annotation></semantics></math>-many sequences with the highest probabilities, <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS2.p5.6.m4.1"><semantics id="S3.SS2.p5.6.m4.1a"><mo id="S3.SS2.p5.6.m4.1.1" xref="S3.SS2.p5.6.m4.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m4.1b"><csymbol cd="latexml" id="S3.SS2.p5.6.m4.1.1.cmml" xref="S3.SS2.p5.6.m4.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.6.m4.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.6.m4.1d">⊕</annotation></semantics></math> represents string concatenation, <math alttext="V" class="ltx_Math" display="inline" id="S3.SS2.p5.7.m5.1"><semantics id="S3.SS2.p5.7.m5.1a"><mi id="S3.SS2.p5.7.m5.1.1" xref="S3.SS2.p5.7.m5.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.7.m5.1b"><ci id="S3.SS2.p5.7.m5.1.1.cmml" xref="S3.SS2.p5.7.m5.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.7.m5.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.7.m5.1d">italic_V</annotation></semantics></math> is the vocabulary, and <math alttext="p_{k}(\mathrm{y}|\mathbf{y}_{1:t-1},\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS2.p5.8.m6.2"><semantics id="S3.SS2.p5.8.m6.2a"><mrow id="S3.SS2.p5.8.m6.2.2" xref="S3.SS2.p5.8.m6.2.2.cmml"><msub id="S3.SS2.p5.8.m6.2.2.3" xref="S3.SS2.p5.8.m6.2.2.3.cmml"><mi id="S3.SS2.p5.8.m6.2.2.3.2" xref="S3.SS2.p5.8.m6.2.2.3.2.cmml">p</mi><mi id="S3.SS2.p5.8.m6.2.2.3.3" xref="S3.SS2.p5.8.m6.2.2.3.3.cmml">k</mi></msub><mo id="S3.SS2.p5.8.m6.2.2.2" xref="S3.SS2.p5.8.m6.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p5.8.m6.2.2.1.1" xref="S3.SS2.p5.8.m6.2.2.1.1.1.cmml"><mo id="S3.SS2.p5.8.m6.2.2.1.1.2" stretchy="false" xref="S3.SS2.p5.8.m6.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.p5.8.m6.2.2.1.1.1" xref="S3.SS2.p5.8.m6.2.2.1.1.1.cmml"><mi id="S3.SS2.p5.8.m6.2.2.1.1.1.3" mathvariant="normal" xref="S3.SS2.p5.8.m6.2.2.1.1.1.3.cmml">y</mi><mo fence="false" id="S3.SS2.p5.8.m6.2.2.1.1.1.2" xref="S3.SS2.p5.8.m6.2.2.1.1.1.2.cmml">|</mo><mrow id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.2.cmml"><msub id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.2" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.2.cmml">𝐲</mi><mrow id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.cmml"><mn id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.2" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.2" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.1" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.3" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.2" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.2.cmml">,</mo><mi id="S3.SS2.p5.8.m6.1.1" xref="S3.SS2.p5.8.m6.1.1.cmml">𝐱</mi></mrow></mrow><mo id="S3.SS2.p5.8.m6.2.2.1.1.3" stretchy="false" xref="S3.SS2.p5.8.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.8.m6.2b"><apply id="S3.SS2.p5.8.m6.2.2.cmml" xref="S3.SS2.p5.8.m6.2.2"><times id="S3.SS2.p5.8.m6.2.2.2.cmml" xref="S3.SS2.p5.8.m6.2.2.2"></times><apply id="S3.SS2.p5.8.m6.2.2.3.cmml" xref="S3.SS2.p5.8.m6.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p5.8.m6.2.2.3.1.cmml" xref="S3.SS2.p5.8.m6.2.2.3">subscript</csymbol><ci id="S3.SS2.p5.8.m6.2.2.3.2.cmml" xref="S3.SS2.p5.8.m6.2.2.3.2">𝑝</ci><ci id="S3.SS2.p5.8.m6.2.2.3.3.cmml" xref="S3.SS2.p5.8.m6.2.2.3.3">𝑘</ci></apply><apply id="S3.SS2.p5.8.m6.2.2.1.1.1.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.p5.8.m6.2.2.1.1.1.2.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1.1.2">conditional</csymbol><ci id="S3.SS2.p5.8.m6.2.2.1.1.1.3.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1.1.3">y</ci><list id="S3.SS2.p5.8.m6.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1"><apply id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.2">𝐲</ci><apply id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3"><ci id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.1">:</ci><cn id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.2">1</cn><apply id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3"><minus id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.p5.8.m6.2.2.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S3.SS2.p5.8.m6.1.1.cmml" xref="S3.SS2.p5.8.m6.1.1">𝐱</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.8.m6.2c">p_{k}(\mathrm{y}|\mathbf{y}_{1:t-1},\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.8.m6.2d">italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( roman_y | bold_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_x )</annotation></semantics></math> is the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p5.9.m7.1"><semantics id="S3.SS2.p5.9.m7.1a"><mi id="S3.SS2.p5.9.m7.1.1" xref="S3.SS2.p5.9.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.9.m7.1b"><ci id="S3.SS2.p5.9.m7.1.1.cmml" xref="S3.SS2.p5.9.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.9.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.9.m7.1d">italic_k</annotation></semantics></math>th ensemble component’s predicted probability at step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p5.10.m8.1"><semantics id="S3.SS2.p5.10.m8.1a"><mi id="S3.SS2.p5.10.m8.1.1" xref="S3.SS2.p5.10.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.10.m8.1b"><ci id="S3.SS2.p5.10.m8.1.1.cmml" xref="S3.SS2.p5.10.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.10.m8.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.10.m8.1d">italic_t</annotation></semantics></math> given the prefix <math alttext="\mathbf{y}_{1:t-1}" class="ltx_Math" display="inline" id="S3.SS2.p5.11.m9.1"><semantics id="S3.SS2.p5.11.m9.1a"><msub id="S3.SS2.p5.11.m9.1.1" xref="S3.SS2.p5.11.m9.1.1.cmml"><mi id="S3.SS2.p5.11.m9.1.1.2" xref="S3.SS2.p5.11.m9.1.1.2.cmml">𝐲</mi><mrow id="S3.SS2.p5.11.m9.1.1.3" xref="S3.SS2.p5.11.m9.1.1.3.cmml"><mn id="S3.SS2.p5.11.m9.1.1.3.2" xref="S3.SS2.p5.11.m9.1.1.3.2.cmml">1</mn><mo id="S3.SS2.p5.11.m9.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p5.11.m9.1.1.3.1.cmml">:</mo><mrow id="S3.SS2.p5.11.m9.1.1.3.3" xref="S3.SS2.p5.11.m9.1.1.3.3.cmml"><mi id="S3.SS2.p5.11.m9.1.1.3.3.2" xref="S3.SS2.p5.11.m9.1.1.3.3.2.cmml">t</mi><mo id="S3.SS2.p5.11.m9.1.1.3.3.1" xref="S3.SS2.p5.11.m9.1.1.3.3.1.cmml">−</mo><mn id="S3.SS2.p5.11.m9.1.1.3.3.3" xref="S3.SS2.p5.11.m9.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.11.m9.1b"><apply id="S3.SS2.p5.11.m9.1.1.cmml" xref="S3.SS2.p5.11.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.11.m9.1.1.1.cmml" xref="S3.SS2.p5.11.m9.1.1">subscript</csymbol><ci id="S3.SS2.p5.11.m9.1.1.2.cmml" xref="S3.SS2.p5.11.m9.1.1.2">𝐲</ci><apply id="S3.SS2.p5.11.m9.1.1.3.cmml" xref="S3.SS2.p5.11.m9.1.1.3"><ci id="S3.SS2.p5.11.m9.1.1.3.1.cmml" xref="S3.SS2.p5.11.m9.1.1.3.1">:</ci><cn id="S3.SS2.p5.11.m9.1.1.3.2.cmml" type="integer" xref="S3.SS2.p5.11.m9.1.1.3.2">1</cn><apply id="S3.SS2.p5.11.m9.1.1.3.3.cmml" xref="S3.SS2.p5.11.m9.1.1.3.3"><minus id="S3.SS2.p5.11.m9.1.1.3.3.1.cmml" xref="S3.SS2.p5.11.m9.1.1.3.3.1"></minus><ci id="S3.SS2.p5.11.m9.1.1.3.3.2.cmml" xref="S3.SS2.p5.11.m9.1.1.3.3.2">𝑡</ci><cn id="S3.SS2.p5.11.m9.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.p5.11.m9.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.11.m9.1c">\mathbf{y}_{1:t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.11.m9.1d">bold_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math> and input <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS2.p5.12.m10.1"><semantics id="S3.SS2.p5.12.m10.1a"><mi id="S3.SS2.p5.12.m10.1.1" xref="S3.SS2.p5.12.m10.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.12.m10.1b"><ci id="S3.SS2.p5.12.m10.1.1.cmml" xref="S3.SS2.p5.12.m10.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.12.m10.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.12.m10.1d">bold_x</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.3">At the upper level, EBBS synchronizes the individual beams <math alttext="B_{t,k}^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.p6.1.m1.2"><semantics id="S3.SS2.p6.1.m1.2a"><msubsup id="S3.SS2.p6.1.m1.2.3" xref="S3.SS2.p6.1.m1.2.3.cmml"><mi id="S3.SS2.p6.1.m1.2.3.2.2" xref="S3.SS2.p6.1.m1.2.3.2.2.cmml">B</mi><mrow id="S3.SS2.p6.1.m1.2.2.2.4" xref="S3.SS2.p6.1.m1.2.2.2.3.cmml"><mi id="S3.SS2.p6.1.m1.1.1.1.1" xref="S3.SS2.p6.1.m1.1.1.1.1.cmml">t</mi><mo id="S3.SS2.p6.1.m1.2.2.2.4.1" xref="S3.SS2.p6.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p6.1.m1.2.2.2.2" xref="S3.SS2.p6.1.m1.2.2.2.2.cmml">k</mi></mrow><mo id="S3.SS2.p6.1.m1.2.3.3" xref="S3.SS2.p6.1.m1.2.3.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.2b"><apply id="S3.SS2.p6.1.m1.2.3.cmml" xref="S3.SS2.p6.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.2.3.1.cmml" xref="S3.SS2.p6.1.m1.2.3">superscript</csymbol><apply id="S3.SS2.p6.1.m1.2.3.2.cmml" xref="S3.SS2.p6.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.2.3.2.1.cmml" xref="S3.SS2.p6.1.m1.2.3">subscript</csymbol><ci id="S3.SS2.p6.1.m1.2.3.2.2.cmml" xref="S3.SS2.p6.1.m1.2.3.2.2">𝐵</ci><list id="S3.SS2.p6.1.m1.2.2.2.3.cmml" xref="S3.SS2.p6.1.m1.2.2.2.4"><ci id="S3.SS2.p6.1.m1.1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1.1.1">𝑡</ci><ci id="S3.SS2.p6.1.m1.2.2.2.2.cmml" xref="S3.SS2.p6.1.m1.2.2.2.2">𝑘</ci></list></apply><ci id="S3.SS2.p6.1.m1.2.3.3.cmml" xref="S3.SS2.p6.1.m1.2.3.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.2c">B_{t,k}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.1.m1.2d">italic_B start_POSTSUBSCRIPT italic_t , italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, for <math alttext="k=1,\cdots,K" class="ltx_Math" display="inline" id="S3.SS2.p6.2.m2.3"><semantics id="S3.SS2.p6.2.m2.3a"><mrow id="S3.SS2.p6.2.m2.3.4" xref="S3.SS2.p6.2.m2.3.4.cmml"><mi id="S3.SS2.p6.2.m2.3.4.2" xref="S3.SS2.p6.2.m2.3.4.2.cmml">k</mi><mo id="S3.SS2.p6.2.m2.3.4.1" xref="S3.SS2.p6.2.m2.3.4.1.cmml">=</mo><mrow id="S3.SS2.p6.2.m2.3.4.3.2" xref="S3.SS2.p6.2.m2.3.4.3.1.cmml"><mn id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml">1</mn><mo id="S3.SS2.p6.2.m2.3.4.3.2.1" xref="S3.SS2.p6.2.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p6.2.m2.2.2" mathvariant="normal" xref="S3.SS2.p6.2.m2.2.2.cmml">⋯</mi><mo id="S3.SS2.p6.2.m2.3.4.3.2.2" xref="S3.SS2.p6.2.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p6.2.m2.3.3" xref="S3.SS2.p6.2.m2.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.3b"><apply id="S3.SS2.p6.2.m2.3.4.cmml" xref="S3.SS2.p6.2.m2.3.4"><eq id="S3.SS2.p6.2.m2.3.4.1.cmml" xref="S3.SS2.p6.2.m2.3.4.1"></eq><ci id="S3.SS2.p6.2.m2.3.4.2.cmml" xref="S3.SS2.p6.2.m2.3.4.2">𝑘</ci><list id="S3.SS2.p6.2.m2.3.4.3.1.cmml" xref="S3.SS2.p6.2.m2.3.4.3.2"><cn id="S3.SS2.p6.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p6.2.m2.1.1">1</cn><ci id="S3.SS2.p6.2.m2.2.2.cmml" xref="S3.SS2.p6.2.m2.2.2">⋯</ci><ci id="S3.SS2.p6.2.m2.3.3.cmml" xref="S3.SS2.p6.2.m2.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.3c">k=1,\cdots,K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.2.m2.3d">italic_k = 1 , ⋯ , italic_K</annotation></semantics></math>, into a single, shared,
upper-level beam through a soft voting mechanism, where the candidate set <math alttext="C_{t}" class="ltx_Math" display="inline" id="S3.SS2.p6.3.m3.1"><semantics id="S3.SS2.p6.3.m3.1a"><msub id="S3.SS2.p6.3.m3.1.1" xref="S3.SS2.p6.3.m3.1.1.cmml"><mi id="S3.SS2.p6.3.m3.1.1.2" xref="S3.SS2.p6.3.m3.1.1.2.cmml">C</mi><mi id="S3.SS2.p6.3.m3.1.1.3" xref="S3.SS2.p6.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.1b"><apply id="S3.SS2.p6.3.m3.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.3.m3.1.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p6.3.m3.1.1.2.cmml" xref="S3.SS2.p6.3.m3.1.1.2">𝐶</ci><ci id="S3.SS2.p6.3.m3.1.1.3.cmml" xref="S3.SS2.p6.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.1c">C_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.3.m3.1d">italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the union of the sequences in individual beams:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A6.EGx2">
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle C_{t}=\bigcup\nolimits_{k}\{\mathbf{y}:\langle\mathbf{y},p%
\rangle\in B_{t,k}^{\prime}\}" class="ltx_Math" display="inline" id="S3.E2.m1.6"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml"><msub id="S3.E2.m1.6.6.3" xref="S3.E2.m1.6.6.3.cmml"><mi id="S3.E2.m1.6.6.3.2" xref="S3.E2.m1.6.6.3.2.cmml">C</mi><mi id="S3.E2.m1.6.6.3.3" xref="S3.E2.m1.6.6.3.3.cmml">t</mi></msub><mo id="S3.E2.m1.6.6.2" xref="S3.E2.m1.6.6.2.cmml">=</mo><mrow id="S3.E2.m1.6.6.1" xref="S3.E2.m1.6.6.1.cmml"><mstyle displaystyle="true" id="S3.E2.m1.6.6.1.2" xref="S3.E2.m1.6.6.1.2.cmml"><msub id="S3.E2.m1.6.6.1.2a" xref="S3.E2.m1.6.6.1.2.cmml"><mo id="S3.E2.m1.6.6.1.2.2" xref="S3.E2.m1.6.6.1.2.2.cmml">⋃</mo><mi id="S3.E2.m1.6.6.1.2.3" xref="S3.E2.m1.6.6.1.2.3.cmml">k</mi></msub></mstyle><mrow id="S3.E2.m1.6.6.1.1.1" xref="S3.E2.m1.6.6.1.1.2.cmml"><mo id="S3.E2.m1.6.6.1.1.1.2" stretchy="false" xref="S3.E2.m1.6.6.1.1.2.1.cmml">{</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">𝐲</mi><mo id="S3.E2.m1.6.6.1.1.1.3" lspace="0.278em" rspace="0.278em" xref="S3.E2.m1.6.6.1.1.2.1.cmml">:</mo><mrow id="S3.E2.m1.6.6.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.1.1.2.2" xref="S3.E2.m1.6.6.1.1.1.1.2.1.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.2.2.1" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.2.1.cmml">⟨</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">𝐲</mi><mo id="S3.E2.m1.6.6.1.1.1.1.2.2.2" xref="S3.E2.m1.6.6.1.1.1.1.2.1.cmml">,</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">p</mi><mo id="S3.E2.m1.6.6.1.1.1.1.2.2.3" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.2.1.cmml">⟩</mo></mrow><mo id="S3.E2.m1.6.6.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.cmml">∈</mo><msubsup id="S3.E2.m1.6.6.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.3.2.2" xref="S3.E2.m1.6.6.1.1.1.1.3.2.2.cmml">B</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">t</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">k</mi></mrow><mo id="S3.E2.m1.6.6.1.1.1.1.3.3" xref="S3.E2.m1.6.6.1.1.1.1.3.3.cmml">′</mo></msubsup></mrow><mo id="S3.E2.m1.6.6.1.1.1.4" stretchy="false" xref="S3.E2.m1.6.6.1.1.2.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6"><eq id="S3.E2.m1.6.6.2.cmml" xref="S3.E2.m1.6.6.2"></eq><apply id="S3.E2.m1.6.6.3.cmml" xref="S3.E2.m1.6.6.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.3.1.cmml" xref="S3.E2.m1.6.6.3">subscript</csymbol><ci id="S3.E2.m1.6.6.3.2.cmml" xref="S3.E2.m1.6.6.3.2">𝐶</ci><ci id="S3.E2.m1.6.6.3.3.cmml" xref="S3.E2.m1.6.6.3.3">𝑡</ci></apply><apply id="S3.E2.m1.6.6.1.cmml" xref="S3.E2.m1.6.6.1"><apply id="S3.E2.m1.6.6.1.2.cmml" xref="S3.E2.m1.6.6.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.2.1.cmml" xref="S3.E2.m1.6.6.1.2">subscript</csymbol><union id="S3.E2.m1.6.6.1.2.2.cmml" xref="S3.E2.m1.6.6.1.2.2"></union><ci id="S3.E2.m1.6.6.1.2.3.cmml" xref="S3.E2.m1.6.6.1.2.3">𝑘</ci></apply><apply id="S3.E2.m1.6.6.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.6.6.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.2">conditional-set</csymbol><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝐲</ci><apply id="S3.E2.m1.6.6.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1"><in id="S3.E2.m1.6.6.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1"></in><list id="S3.E2.m1.6.6.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.2"><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝐲</ci><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝑝</ci></list><apply id="S3.E2.m1.6.6.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.2.2">𝐵</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑡</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑘</ci></list></apply><ci id="S3.E2.m1.6.6.1.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">\displaystyle C_{t}=\bigcup\nolimits_{k}\{\mathbf{y}:\langle\mathbf{y},p%
\rangle\in B_{t,k}^{\prime}\}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.6d">italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ⋃ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT { bold_y : ⟨ bold_y , italic_p ⟩ ∈ italic_B start_POSTSUBSCRIPT italic_t , italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p6.4">Then, we evaluate each candidate in <math alttext="C_{t}" class="ltx_Math" display="inline" id="S3.SS2.p6.4.m1.1"><semantics id="S3.SS2.p6.4.m1.1a"><msub id="S3.SS2.p6.4.m1.1.1" xref="S3.SS2.p6.4.m1.1.1.cmml"><mi id="S3.SS2.p6.4.m1.1.1.2" xref="S3.SS2.p6.4.m1.1.1.2.cmml">C</mi><mi id="S3.SS2.p6.4.m1.1.1.3" xref="S3.SS2.p6.4.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.4.m1.1b"><apply id="S3.SS2.p6.4.m1.1.1.cmml" xref="S3.SS2.p6.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.4.m1.1.1.1.cmml" xref="S3.SS2.p6.4.m1.1.1">subscript</csymbol><ci id="S3.SS2.p6.4.m1.1.1.2.cmml" xref="S3.SS2.p6.4.m1.1.1.2">𝐶</ci><ci id="S3.SS2.p6.4.m1.1.1.3.cmml" xref="S3.SS2.p6.4.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.4.m1.1c">C_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.4.m1.1d">italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and compute its overall vote as the sum of the probabilities.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A6.EGx3">
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle B_{t}=\operatorname{top-}\!\!Z\!\scalebox{1.2}{$\Bigg{\{}$}\left%
\langle\mathbf{y},\!\!\sum_{k:\ k=1,\cdots,K\atop\langle\mathbf{y}^{\prime},p%
\rangle\in B_{t,k}^{\prime}:\ \mathbf{y}^{\prime}=\mathbf{y}}p\right\rangle:\ %
\mathbf{y}\in C_{t}\scalebox{1.2}{$\Bigg{\}}$}" class="ltx_Math" display="inline" id="S3.E3.m1.12"><semantics id="S3.E3.m1.12a"><mrow id="S3.E3.m1.12.12" xref="S3.E3.m1.12.12.cmml"><msub id="S3.E3.m1.12.12.4" xref="S3.E3.m1.12.12.4.cmml"><mi id="S3.E3.m1.12.12.4.2" xref="S3.E3.m1.12.12.4.2.cmml">B</mi><mi id="S3.E3.m1.12.12.4.3" xref="S3.E3.m1.12.12.4.3.cmml">t</mi></msub><mo id="S3.E3.m1.12.12.3" xref="S3.E3.m1.12.12.3.cmml">=</mo><mrow id="S3.E3.m1.12.12.2" xref="S3.E3.m1.12.12.2.cmml"><mrow id="S3.E3.m1.12.12.2.4" xref="S3.E3.m1.12.12.2.4.cmml"><mrow id="S3.E3.m1.12.12.2.4.1" xref="S3.E3.m1.12.12.2.4.1.cmml"><mi id="S3.E3.m1.12.12.2.4.1.2" xref="S3.E3.m1.12.12.2.4.1.2.cmml">top</mi><mo id="S3.E3.m1.12.12.2.4.1.3" xref="S3.E3.m1.12.12.2.4.1.3.cmml">−</mo></mrow><mo id="S3.E3.m1.12.12.2.4a" xref="S3.E3.m1.12.12.2.4.cmml">⁡</mo><mpadded width="0.584em"><mi id="S3.E3.m1.12.12.2.4.2" xref="S3.E3.m1.12.12.2.4.2.cmml">Z</mi></mpadded></mrow><mo id="S3.E3.m1.12.12.2.3" xref="S3.E3.m1.12.12.2.3.cmml">⁢</mo><mrow id="S3.E3.m1.12.12.2.2.2" xref="S3.E3.m1.12.12.2.2.3.cmml"><mpadded depth="3.0pt" height="9.0pt" id="S3.E3.m1.12.12.2.2.2.3" width="6.0pt" xref="S3.E3.m1.12.12.2.2.3.cmml"><mo id="S3.E3.m1.12.12.2.2.2.3a" maxsize="260%" minsize="260%" xref="S3.E3.m1.12.12.2.2.3.1.cmml">{</mo></mpadded><mrow id="S3.E3.m1.11.11.1.1.1.1.1" xref="S3.E3.m1.11.11.1.1.1.1.2.cmml"><mo id="S3.E3.m1.11.11.1.1.1.1.1.2" xref="S3.E3.m1.11.11.1.1.1.1.2.cmml">⟨</mo><mi id="S3.E3.m1.10.10" xref="S3.E3.m1.10.10.cmml">𝐲</mi><mpadded width="0.115em"><mo id="S3.E3.m1.11.11.1.1.1.1.1.3" xref="S3.E3.m1.11.11.1.1.1.1.2.cmml">,</mo></mpadded><mrow id="S3.E3.m1.11.11.1.1.1.1.1.1" xref="S3.E3.m1.11.11.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E3.m1.11.11.1.1.1.1.1.1.1" xref="S3.E3.m1.11.11.1.1.1.1.1.1.1.cmml"><munder id="S3.E3.m1.11.11.1.1.1.1.1.1.1a" xref="S3.E3.m1.11.11.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.11.11.1.1.1.1.1.1.1.2" movablelimits="false" xref="S3.E3.m1.11.11.1.1.1.1.1.1.1.2.cmml">∑</mo><mfrac id="S3.E3.m1.9.9.7" linethickness="0pt" xref="S3.E3.m1.9.9.7.cmml"><mrow id="S3.E3.m1.5.5.3.3.3" xref="S3.E3.m1.5.5.3.3.3.cmml"><mi id="S3.E3.m1.5.5.3.3.3.5" xref="S3.E3.m1.5.5.3.3.3.5.cmml">k</mi><mo id="S3.E3.m1.5.5.3.3.3.4" lspace="0.278em" rspace="0.628em" xref="S3.E3.m1.5.5.3.3.3.4.cmml">:</mo><mrow id="S3.E3.m1.5.5.3.3.3.6" xref="S3.E3.m1.5.5.3.3.3.6.cmml"><mi id="S3.E3.m1.5.5.3.3.3.6.2" xref="S3.E3.m1.5.5.3.3.3.6.2.cmml">k</mi><mo id="S3.E3.m1.5.5.3.3.3.6.1" xref="S3.E3.m1.5.5.3.3.3.6.1.cmml">=</mo><mrow id="S3.E3.m1.5.5.3.3.3.6.3.2" xref="S3.E3.m1.5.5.3.3.3.6.3.1.cmml"><mn id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.cmml">1</mn><mo id="S3.E3.m1.5.5.3.3.3.6.3.2.1" xref="S3.E3.m1.5.5.3.3.3.6.3.1.cmml">,</mo><mi id="S3.E3.m1.4.4.2.2.2.2" mathvariant="normal" xref="S3.E3.m1.4.4.2.2.2.2.cmml">⋯</mi><mo id="S3.E3.m1.5.5.3.3.3.6.3.2.2" xref="S3.E3.m1.5.5.3.3.3.6.3.1.cmml">,</mo><mi id="S3.E3.m1.5.5.3.3.3.3" xref="S3.E3.m1.5.5.3.3.3.3.cmml">K</mi></mrow></mrow></mrow><mrow id="S3.E3.m1.9.9.7.7.7" xref="S3.E3.m1.9.9.7.7.7.cmml"><mrow id="S3.E3.m1.9.9.7.7.7.4" xref="S3.E3.m1.9.9.7.7.7.4.cmml"><mrow id="S3.E3.m1.9.9.7.7.7.4.1.1" xref="S3.E3.m1.9.9.7.7.7.4.1.2.cmml"><mo id="S3.E3.m1.9.9.7.7.7.4.1.1.2" stretchy="false" xref="S3.E3.m1.9.9.7.7.7.4.1.2.cmml">⟨</mo><msup id="S3.E3.m1.9.9.7.7.7.4.1.1.1" xref="S3.E3.m1.9.9.7.7.7.4.1.1.1.cmml"><mi id="S3.E3.m1.9.9.7.7.7.4.1.1.1.2" xref="S3.E3.m1.9.9.7.7.7.4.1.1.1.2.cmml">𝐲</mi><mo id="S3.E3.m1.9.9.7.7.7.4.1.1.1.3" xref="S3.E3.m1.9.9.7.7.7.4.1.1.1.3.cmml">′</mo></msup><mo id="S3.E3.m1.9.9.7.7.7.4.1.1.3" xref="S3.E3.m1.9.9.7.7.7.4.1.2.cmml">,</mo><mi id="S3.E3.m1.8.8.6.6.6.3" xref="S3.E3.m1.8.8.6.6.6.3.cmml">p</mi><mo id="S3.E3.m1.9.9.7.7.7.4.1.1.4" stretchy="false" xref="S3.E3.m1.9.9.7.7.7.4.1.2.cmml">⟩</mo></mrow><mo id="S3.E3.m1.9.9.7.7.7.4.2" xref="S3.E3.m1.9.9.7.7.7.4.2.cmml">∈</mo><msubsup id="S3.E3.m1.9.9.7.7.7.4.3" xref="S3.E3.m1.9.9.7.7.7.4.3.cmml"><mi id="S3.E3.m1.9.9.7.7.7.4.3.2.2" xref="S3.E3.m1.9.9.7.7.7.4.3.2.2.cmml">B</mi><mrow id="S3.E3.m1.7.7.5.5.5.2.2.4" xref="S3.E3.m1.7.7.5.5.5.2.2.3.cmml"><mi id="S3.E3.m1.6.6.4.4.4.1.1.1" xref="S3.E3.m1.6.6.4.4.4.1.1.1.cmml">t</mi><mo id="S3.E3.m1.7.7.5.5.5.2.2.4.1" xref="S3.E3.m1.7.7.5.5.5.2.2.3.cmml">,</mo><mi id="S3.E3.m1.7.7.5.5.5.2.2.2" xref="S3.E3.m1.7.7.5.5.5.2.2.2.cmml">k</mi></mrow><mo id="S3.E3.m1.9.9.7.7.7.4.3.3" xref="S3.E3.m1.9.9.7.7.7.4.3.3.cmml">′</mo></msubsup></mrow><mo id="S3.E3.m1.9.9.7.7.7.5" lspace="0.278em" rspace="0.528em" xref="S3.E3.m1.9.9.7.7.7.5.cmml">:</mo><mrow id="S3.E3.m1.9.9.7.7.7.6" xref="S3.E3.m1.9.9.7.7.7.6.cmml"><msup id="S3.E3.m1.9.9.7.7.7.6.2" xref="S3.E3.m1.9.9.7.7.7.6.2.cmml"><mi id="S3.E3.m1.9.9.7.7.7.6.2.2" xref="S3.E3.m1.9.9.7.7.7.6.2.2.cmml">𝐲</mi><mo id="S3.E3.m1.9.9.7.7.7.6.2.3" xref="S3.E3.m1.9.9.7.7.7.6.2.3.cmml">′</mo></msup><mo id="S3.E3.m1.9.9.7.7.7.6.1" xref="S3.E3.m1.9.9.7.7.7.6.1.cmml">=</mo><mi id="S3.E3.m1.9.9.7.7.7.6.3" xref="S3.E3.m1.9.9.7.7.7.6.3.cmml">𝐲</mi></mrow></mrow></mfrac></munder></mstyle><mi id="S3.E3.m1.11.11.1.1.1.1.1.1.2" xref="S3.E3.m1.11.11.1.1.1.1.1.1.2.cmml">p</mi></mrow><mo id="S3.E3.m1.11.11.1.1.1.1.1.4" rspace="0.278em" xref="S3.E3.m1.11.11.1.1.1.1.2.cmml">⟩</mo></mrow><mo id="S3.E3.m1.12.12.2.2.2.4" rspace="0.778em" xref="S3.E3.m1.12.12.2.2.3.1.cmml">:</mo><mrow id="S3.E3.m1.12.12.2.2.2.2" xref="S3.E3.m1.12.12.2.2.2.2.cmml"><mi id="S3.E3.m1.12.12.2.2.2.2.2" xref="S3.E3.m1.12.12.2.2.2.2.2.cmml">𝐲</mi><mo id="S3.E3.m1.12.12.2.2.2.2.1" xref="S3.E3.m1.12.12.2.2.2.2.1.cmml">∈</mo><msub id="S3.E3.m1.12.12.2.2.2.2.3" xref="S3.E3.m1.12.12.2.2.2.2.3.cmml"><mi id="S3.E3.m1.12.12.2.2.2.2.3.2" xref="S3.E3.m1.12.12.2.2.2.2.3.2.cmml">C</mi><mi id="S3.E3.m1.12.12.2.2.2.2.3.3" xref="S3.E3.m1.12.12.2.2.2.2.3.3.cmml">t</mi></msub></mrow><mpadded depth="3.0pt" height="9.0pt" id="S3.E3.m1.12.12.2.2.2.5" width="6.0pt" xref="S3.E3.m1.12.12.2.2.3.cmml"><mo id="S3.E3.m1.12.12.2.2.2.5a" maxsize="260%" minsize="260%" xref="S3.E3.m1.12.12.2.2.3.1.cmml">}</mo></mpadded></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.12b"><apply id="S3.E3.m1.12.12.cmml" xref="S3.E3.m1.12.12"><eq id="S3.E3.m1.12.12.3.cmml" xref="S3.E3.m1.12.12.3"></eq><apply id="S3.E3.m1.12.12.4.cmml" xref="S3.E3.m1.12.12.4"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.4.1.cmml" xref="S3.E3.m1.12.12.4">subscript</csymbol><ci id="S3.E3.m1.12.12.4.2.cmml" xref="S3.E3.m1.12.12.4.2">𝐵</ci><ci id="S3.E3.m1.12.12.4.3.cmml" xref="S3.E3.m1.12.12.4.3">𝑡</ci></apply><apply id="S3.E3.m1.12.12.2.cmml" xref="S3.E3.m1.12.12.2"><times id="S3.E3.m1.12.12.2.3.cmml" xref="S3.E3.m1.12.12.2.3"></times><apply id="S3.E3.m1.12.12.2.4.cmml" xref="S3.E3.m1.12.12.2.4"><apply id="S3.E3.m1.12.12.2.4.1.cmml" xref="S3.E3.m1.12.12.2.4.1"><csymbol cd="latexml" id="S3.E3.m1.12.12.2.4.1.1.cmml" xref="S3.E3.m1.12.12.2.4.1">limit-from</csymbol><ci id="S3.E3.m1.12.12.2.4.1.2.cmml" xref="S3.E3.m1.12.12.2.4.1.2">top</ci><minus id="S3.E3.m1.12.12.2.4.1.3.cmml" xref="S3.E3.m1.12.12.2.4.1.3"></minus></apply><ci id="S3.E3.m1.12.12.2.4.2.cmml" xref="S3.E3.m1.12.12.2.4.2">𝑍</ci></apply><apply id="S3.E3.m1.12.12.2.2.3.cmml" xref="S3.E3.m1.12.12.2.2.2"><csymbol cd="latexml" id="S3.E3.m1.12.12.2.2.3.1.cmml" xref="S3.E3.m1.12.12.2.2.2.3a">conditional-set</csymbol><list id="S3.E3.m1.11.11.1.1.1.1.2.cmml" xref="S3.E3.m1.11.11.1.1.1.1.1"><ci id="S3.E3.m1.10.10.cmml" xref="S3.E3.m1.10.10">𝐲</ci><apply id="S3.E3.m1.11.11.1.1.1.1.1.1.cmml" xref="S3.E3.m1.11.11.1.1.1.1.1.1"><apply id="S3.E3.m1.11.11.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.11.11.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.11.11.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E3.m1.11.11.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.11.11.1.1.1.1.1.1.1.2"></sum><apply id="S3.E3.m1.9.9.7.cmml" xref="S3.E3.m1.9.9.7"><ci id="S3.E3.m1.9.9.7.8.cmml" xref="S3.E3.m1.9.9.7">FRACOP</ci><apply id="S3.E3.m1.5.5.3.3.3.cmml" xref="S3.E3.m1.5.5.3.3.3"><ci id="S3.E3.m1.5.5.3.3.3.4.cmml" xref="S3.E3.m1.5.5.3.3.3.4">:</ci><ci id="S3.E3.m1.5.5.3.3.3.5.cmml" xref="S3.E3.m1.5.5.3.3.3.5">𝑘</ci><apply id="S3.E3.m1.5.5.3.3.3.6.cmml" xref="S3.E3.m1.5.5.3.3.3.6"><eq id="S3.E3.m1.5.5.3.3.3.6.1.cmml" xref="S3.E3.m1.5.5.3.3.3.6.1"></eq><ci id="S3.E3.m1.5.5.3.3.3.6.2.cmml" xref="S3.E3.m1.5.5.3.3.3.6.2">𝑘</ci><list id="S3.E3.m1.5.5.3.3.3.6.3.1.cmml" xref="S3.E3.m1.5.5.3.3.3.6.3.2"><cn id="S3.E3.m1.3.3.1.1.1.1.cmml" type="integer" xref="S3.E3.m1.3.3.1.1.1.1">1</cn><ci id="S3.E3.m1.4.4.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2.2">⋯</ci><ci id="S3.E3.m1.5.5.3.3.3.3.cmml" xref="S3.E3.m1.5.5.3.3.3.3">𝐾</ci></list></apply></apply><apply id="S3.E3.m1.9.9.7.7.7.cmml" xref="S3.E3.m1.9.9.7.7.7"><ci id="S3.E3.m1.9.9.7.7.7.5.cmml" xref="S3.E3.m1.9.9.7.7.7.5">:</ci><apply id="S3.E3.m1.9.9.7.7.7.4.cmml" xref="S3.E3.m1.9.9.7.7.7.4"><in id="S3.E3.m1.9.9.7.7.7.4.2.cmml" xref="S3.E3.m1.9.9.7.7.7.4.2"></in><list id="S3.E3.m1.9.9.7.7.7.4.1.2.cmml" xref="S3.E3.m1.9.9.7.7.7.4.1.1"><apply id="S3.E3.m1.9.9.7.7.7.4.1.1.1.cmml" xref="S3.E3.m1.9.9.7.7.7.4.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.7.7.7.4.1.1.1.1.cmml" xref="S3.E3.m1.9.9.7.7.7.4.1.1.1">superscript</csymbol><ci id="S3.E3.m1.9.9.7.7.7.4.1.1.1.2.cmml" xref="S3.E3.m1.9.9.7.7.7.4.1.1.1.2">𝐲</ci><ci id="S3.E3.m1.9.9.7.7.7.4.1.1.1.3.cmml" xref="S3.E3.m1.9.9.7.7.7.4.1.1.1.3">′</ci></apply><ci id="S3.E3.m1.8.8.6.6.6.3.cmml" xref="S3.E3.m1.8.8.6.6.6.3">𝑝</ci></list><apply id="S3.E3.m1.9.9.7.7.7.4.3.cmml" xref="S3.E3.m1.9.9.7.7.7.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.7.7.7.4.3.1.cmml" xref="S3.E3.m1.9.9.7.7.7.4.3">superscript</csymbol><apply id="S3.E3.m1.9.9.7.7.7.4.3.2.cmml" xref="S3.E3.m1.9.9.7.7.7.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.7.7.7.4.3.2.1.cmml" xref="S3.E3.m1.9.9.7.7.7.4.3">subscript</csymbol><ci id="S3.E3.m1.9.9.7.7.7.4.3.2.2.cmml" xref="S3.E3.m1.9.9.7.7.7.4.3.2.2">𝐵</ci><list id="S3.E3.m1.7.7.5.5.5.2.2.3.cmml" xref="S3.E3.m1.7.7.5.5.5.2.2.4"><ci id="S3.E3.m1.6.6.4.4.4.1.1.1.cmml" xref="S3.E3.m1.6.6.4.4.4.1.1.1">𝑡</ci><ci id="S3.E3.m1.7.7.5.5.5.2.2.2.cmml" xref="S3.E3.m1.7.7.5.5.5.2.2.2">𝑘</ci></list></apply><ci id="S3.E3.m1.9.9.7.7.7.4.3.3.cmml" xref="S3.E3.m1.9.9.7.7.7.4.3.3">′</ci></apply></apply><apply id="S3.E3.m1.9.9.7.7.7.6.cmml" xref="S3.E3.m1.9.9.7.7.7.6"><eq id="S3.E3.m1.9.9.7.7.7.6.1.cmml" xref="S3.E3.m1.9.9.7.7.7.6.1"></eq><apply id="S3.E3.m1.9.9.7.7.7.6.2.cmml" xref="S3.E3.m1.9.9.7.7.7.6.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.7.7.7.6.2.1.cmml" xref="S3.E3.m1.9.9.7.7.7.6.2">superscript</csymbol><ci id="S3.E3.m1.9.9.7.7.7.6.2.2.cmml" xref="S3.E3.m1.9.9.7.7.7.6.2.2">𝐲</ci><ci id="S3.E3.m1.9.9.7.7.7.6.2.3.cmml" xref="S3.E3.m1.9.9.7.7.7.6.2.3">′</ci></apply><ci id="S3.E3.m1.9.9.7.7.7.6.3.cmml" xref="S3.E3.m1.9.9.7.7.7.6.3">𝐲</ci></apply></apply></apply></apply><ci id="S3.E3.m1.11.11.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.11.11.1.1.1.1.1.1.2">𝑝</ci></apply></list><apply id="S3.E3.m1.12.12.2.2.2.2.cmml" xref="S3.E3.m1.12.12.2.2.2.2"><in id="S3.E3.m1.12.12.2.2.2.2.1.cmml" xref="S3.E3.m1.12.12.2.2.2.2.1"></in><ci id="S3.E3.m1.12.12.2.2.2.2.2.cmml" xref="S3.E3.m1.12.12.2.2.2.2.2">𝐲</ci><apply id="S3.E3.m1.12.12.2.2.2.2.3.cmml" xref="S3.E3.m1.12.12.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.2.2.2.2.3.1.cmml" xref="S3.E3.m1.12.12.2.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.12.12.2.2.2.2.3.2.cmml" xref="S3.E3.m1.12.12.2.2.2.2.3.2">𝐶</ci><ci id="S3.E3.m1.12.12.2.2.2.2.3.3.cmml" xref="S3.E3.m1.12.12.2.2.2.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.12c">\displaystyle B_{t}=\operatorname{top-}\!\!Z\!\scalebox{1.2}{$\Bigg{\{}$}\left%
\langle\mathbf{y},\!\!\sum_{k:\ k=1,\cdots,K\atop\langle\mathbf{y}^{\prime},p%
\rangle\in B_{t,k}^{\prime}:\ \mathbf{y}^{\prime}=\mathbf{y}}p\right\rangle:\ %
\mathbf{y}\in C_{t}\scalebox{1.2}{$\Bigg{\}}$}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.12d">italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = start_OPFUNCTION roman_top - end_OPFUNCTION italic_Z { ⟨ bold_y , ∑ start_POSTSUBSCRIPT FRACOP start_ARG italic_k : italic_k = 1 , ⋯ , italic_K end_ARG start_ARG ⟨ bold_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_p ⟩ ∈ italic_B start_POSTSUBSCRIPT italic_t , italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT : bold_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = bold_y end_ARG end_POSTSUBSCRIPT italic_p ⟩ : bold_y ∈ italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p6.5">In this way, the upper level synchronizes every ensemble component with the shared beam <math alttext="B_{t}" class="ltx_Math" display="inline" id="S3.SS2.p6.5.m1.1"><semantics id="S3.SS2.p6.5.m1.1a"><msub id="S3.SS2.p6.5.m1.1.1" xref="S3.SS2.p6.5.m1.1.1.cmml"><mi id="S3.SS2.p6.5.m1.1.1.2" xref="S3.SS2.p6.5.m1.1.1.2.cmml">B</mi><mi id="S3.SS2.p6.5.m1.1.1.3" xref="S3.SS2.p6.5.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.5.m1.1b"><apply id="S3.SS2.p6.5.m1.1.1.cmml" xref="S3.SS2.p6.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.5.m1.1.1.1.cmml" xref="S3.SS2.p6.5.m1.1.1">subscript</csymbol><ci id="S3.SS2.p6.5.m1.1.1.2.cmml" xref="S3.SS2.p6.5.m1.1.1.2">𝐵</ci><ci id="S3.SS2.p6.5.m1.1.1.3.cmml" xref="S3.SS2.p6.5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.5.m1.1c">B_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.5.m1.1d">italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> for the next step of generation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p7">
<p class="ltx_p" id="S3.SS2.p7.2">Intuitively, our voting scheme gives an ensemble component <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.p7.1.m1.1"><semantics id="S3.SS2.p7.1.m1.1a"><mi id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><ci id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.1.m1.1d">italic_Z</annotation></semantics></math>-many votes, each weighted by the predicted probability. The votes (probabilities) are then tallied (summed) for each candidate to form the upper-level beam.
Our bi-level beam search terminates when we have <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.p7.2.m2.1"><semantics id="S3.SS2.p7.2.m2.1a"><mi id="S3.SS2.p7.2.m2.1.1" xref="S3.SS2.p7.2.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b"><ci id="S3.SS2.p7.2.m2.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.2.m2.1d">italic_Z</annotation></semantics></math>-many terminated sequences in the shared beam, and returns the sequence with the highest score<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>For selecting the final output, we follow standard implementations and normalize the joint probabilities by length, i.e., taking the geometric mean of step-wise probabilities <cite class="ltx_cite ltx_citemacro_citep">(Wolf et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib56" title="">2019</a>; Ott et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib35" title="">2019</a>)</cite>. Otherwise, beam search algorithms are often biased towards short sequences.
</span></span></span> as the ensemble output. We provide the detailed pseudocode for EBBS in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#alg1" title="1 ‣ 3.2 Our Proposed EBBS Algorithm ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a> and an illustration in Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S3.F1" title="Figure 1 ‣ 3.2 Our Proposed EBBS Algorithm ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p8">
<p class="ltx_p" id="S3.SS2.p8.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p8.1.1">Discussion.</span> As shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#alg2" title="2 ‣ Appendix A Beam Search ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a> (Appendix <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A1" title="Appendix A Beam Search ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">A</span></a>), traditional beam search keeps a fixed-size beam of high-likelihood partial sequences. It is tempting to combine such vanilla beam search with multiple predictors by directly averaging their probabilities
<math alttext="p(\mathbf{y}|\mathbf{x})=\frac{1}{K}\sum_{k=1}^{K}p_{k}(\mathbf{y}|\mathbf{x})" class="ltx_Math" display="inline" id="S3.SS2.p8.1.m1.2"><semantics id="S3.SS2.p8.1.m1.2a"><mrow id="S3.SS2.p8.1.m1.2.2" xref="S3.SS2.p8.1.m1.2.2.cmml"><mrow id="S3.SS2.p8.1.m1.1.1.1" xref="S3.SS2.p8.1.m1.1.1.1.cmml"><mi id="S3.SS2.p8.1.m1.1.1.1.3" xref="S3.SS2.p8.1.m1.1.1.1.3.cmml">p</mi><mo id="S3.SS2.p8.1.m1.1.1.1.2" xref="S3.SS2.p8.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p8.1.m1.1.1.1.1.1" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p8.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p8.1.m1.1.1.1.1.1.1" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p8.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1.2.cmml">𝐲</mi><mo fence="false" id="S3.SS2.p8.1.m1.1.1.1.1.1.1.1" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p8.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S3.SS2.p8.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p8.1.m1.2.2.3" xref="S3.SS2.p8.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS2.p8.1.m1.2.2.2" xref="S3.SS2.p8.1.m1.2.2.2.cmml"><mfrac id="S3.SS2.p8.1.m1.2.2.2.3" xref="S3.SS2.p8.1.m1.2.2.2.3.cmml"><mn id="S3.SS2.p8.1.m1.2.2.2.3.2" xref="S3.SS2.p8.1.m1.2.2.2.3.2.cmml">1</mn><mi id="S3.SS2.p8.1.m1.2.2.2.3.3" xref="S3.SS2.p8.1.m1.2.2.2.3.3.cmml">K</mi></mfrac><mo id="S3.SS2.p8.1.m1.2.2.2.2" xref="S3.SS2.p8.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p8.1.m1.2.2.2.1" xref="S3.SS2.p8.1.m1.2.2.2.1.cmml"><msubsup id="S3.SS2.p8.1.m1.2.2.2.1.2" xref="S3.SS2.p8.1.m1.2.2.2.1.2.cmml"><mo id="S3.SS2.p8.1.m1.2.2.2.1.2.2.2" xref="S3.SS2.p8.1.m1.2.2.2.1.2.2.2.cmml">∑</mo><mrow id="S3.SS2.p8.1.m1.2.2.2.1.2.2.3" xref="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.cmml"><mi id="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.2" xref="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.2.cmml">k</mi><mo id="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.1" xref="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.1.cmml">=</mo><mn id="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.3" xref="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p8.1.m1.2.2.2.1.2.3" xref="S3.SS2.p8.1.m1.2.2.2.1.2.3.cmml">K</mi></msubsup><mrow id="S3.SS2.p8.1.m1.2.2.2.1.1" xref="S3.SS2.p8.1.m1.2.2.2.1.1.cmml"><msub id="S3.SS2.p8.1.m1.2.2.2.1.1.3" xref="S3.SS2.p8.1.m1.2.2.2.1.1.3.cmml"><mi id="S3.SS2.p8.1.m1.2.2.2.1.1.3.2" xref="S3.SS2.p8.1.m1.2.2.2.1.1.3.2.cmml">p</mi><mi id="S3.SS2.p8.1.m1.2.2.2.1.1.3.3" xref="S3.SS2.p8.1.m1.2.2.2.1.1.3.3.cmml">k</mi></msub><mo id="S3.SS2.p8.1.m1.2.2.2.1.1.2" xref="S3.SS2.p8.1.m1.2.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p8.1.m1.2.2.2.1.1.1.1" xref="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.cmml"><mo id="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1" xref="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.cmml"><mi id="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.2" xref="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.2.cmml">𝐲</mi><mo fence="false" id="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.1" xref="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.3" xref="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.3" stretchy="false" xref="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.1.m1.2b"><apply id="S3.SS2.p8.1.m1.2.2.cmml" xref="S3.SS2.p8.1.m1.2.2"><eq id="S3.SS2.p8.1.m1.2.2.3.cmml" xref="S3.SS2.p8.1.m1.2.2.3"></eq><apply id="S3.SS2.p8.1.m1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1.1"><times id="S3.SS2.p8.1.m1.1.1.1.2.cmml" xref="S3.SS2.p8.1.m1.1.1.1.2"></times><ci id="S3.SS2.p8.1.m1.1.1.1.3.cmml" xref="S3.SS2.p8.1.m1.1.1.1.3">𝑝</ci><apply id="S3.SS2.p8.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p8.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p8.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1.2">𝐲</ci><ci id="S3.SS2.p8.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p8.1.m1.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S3.SS2.p8.1.m1.2.2.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2"><times id="S3.SS2.p8.1.m1.2.2.2.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2.2"></times><apply id="S3.SS2.p8.1.m1.2.2.2.3.cmml" xref="S3.SS2.p8.1.m1.2.2.2.3"><divide id="S3.SS2.p8.1.m1.2.2.2.3.1.cmml" xref="S3.SS2.p8.1.m1.2.2.2.3"></divide><cn id="S3.SS2.p8.1.m1.2.2.2.3.2.cmml" type="integer" xref="S3.SS2.p8.1.m1.2.2.2.3.2">1</cn><ci id="S3.SS2.p8.1.m1.2.2.2.3.3.cmml" xref="S3.SS2.p8.1.m1.2.2.2.3.3">𝐾</ci></apply><apply id="S3.SS2.p8.1.m1.2.2.2.1.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1"><apply id="S3.SS2.p8.1.m1.2.2.2.1.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.2.2.2.1.2.1.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.2">superscript</csymbol><apply id="S3.SS2.p8.1.m1.2.2.2.1.2.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.2.2.2.1.2.2.1.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.2">subscript</csymbol><sum id="S3.SS2.p8.1.m1.2.2.2.1.2.2.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.2.2.2"></sum><apply id="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.2.2.3"><eq id="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.1.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.1"></eq><ci id="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.2">𝑘</ci><cn id="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.3.cmml" type="integer" xref="S3.SS2.p8.1.m1.2.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p8.1.m1.2.2.2.1.2.3.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.2.3">𝐾</ci></apply><apply id="S3.SS2.p8.1.m1.2.2.2.1.1.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.1"><times id="S3.SS2.p8.1.m1.2.2.2.1.1.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.1.2"></times><apply id="S3.SS2.p8.1.m1.2.2.2.1.1.3.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.2.2.2.1.1.3.1.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.1.3">subscript</csymbol><ci id="S3.SS2.p8.1.m1.2.2.2.1.1.3.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.1.3.2">𝑝</ci><ci id="S3.SS2.p8.1.m1.2.2.2.1.1.3.3.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.1.3.3">𝑘</ci></apply><apply id="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.2">𝐲</ci><ci id="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S3.SS2.p8.1.m1.2.2.2.1.1.1.1.1.3">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.1.m1.2c">p(\mathbf{y}|\mathbf{x})=\frac{1}{K}\sum_{k=1}^{K}p_{k}(\mathbf{y}|\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.1.m1.2d">italic_p ( bold_y | bold_x ) = divide start_ARG 1 end_ARG start_ARG italic_K end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( bold_y | bold_x )</annotation></semantics></math> as the score for beam search (Line 8, Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#alg2" title="2 ‣ Appendix A Beam Search ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a>), which has been experimented in previous work <cite class="ltx_cite ltx_citemacro_cite">Sennrich et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib43" title="">2016a</a>); Shanbhogue et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib45" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p9">
<p class="ltx_p" id="S3.SS2.p9.1">However, our intuition suggests that such an approach may suffer from the <span class="ltx_text ltx_font_italic" id="S3.SS2.p9.1.1">over-smoothing problem</span> <cite class="ltx_cite ltx_citemacro_cite">Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib52" title="">2019</a>); Wen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib54" title="">2023b</a>)</cite>: when multiple translations (known as <span class="ltx_text ltx_font_italic" id="S3.SS2.p9.1.2">modes</span>) are plausible given an input, the ensemble process will overly smooth out the modes by probability averaging.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p10">
<p class="ltx_p" id="S3.SS2.p10.1">By contrast, EBBS allows each ensemble component to explore its own mode (Lines 4–11, Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#alg1" title="1 ‣ 3.2 Our Proposed EBBS Algorithm ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a>). In Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S3.F1" title="Figure 1 ‣ 3.2 Our Proposed EBBS Algorithm ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a>, for example, the top sequence yields two plausible next tokens, suggested by each component in the lower level. Their probabilities are not smoothed out in our approach, unlike averaging ensembles. The upper level performs soft voting (Lines 12–19, Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#alg1" title="1 ‣ 3.2 Our Proposed EBBS Algorithm ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a>) so as to maintain tractable inference.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>EBBS-Based Distillation</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">To improve inference efficiency, we may perform knowledge distillation based on the outputs of our EBBS algorithm.
In particular, we follow <cite class="ltx_cite ltx_citemacro_citet">Kim and Rush (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib24" title="">2016</a>)</cite> and apply a sequence-level knowledge distillation loss, treating the output <math alttext="\hat{\mathbf{y}}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mover accent="true" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">𝐲</mi><mo id="S3.SS3.p1.1.m1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><ci id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1">^</ci><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝐲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\hat{\mathbf{y}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">over^ start_ARG bold_y end_ARG</annotation></semantics></math> of our ensemble (called a <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.1">teacher</span>) as the pseudo-groundtruth for finetuning the multilingual translation model (called a <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.2">student</span>):</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A6.EGx4">
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{KD}}=-\sum_{t=1}^{|\hat{\mathbf{y}}|}\log p(%
\hat{\mathrm{y}}_{t}|\hat{\mathbf{y}}_{1:t-1},\mathbf{x})" class="ltx_Math" display="inline" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml"><msub id="S3.E4.m1.3.3.3" xref="S3.E4.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.3.2" xref="S3.E4.m1.3.3.3.2.cmml">ℒ</mi><mtext id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.3a.cmml">KD</mtext></msub><mo id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.2.cmml">=</mo><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.cmml"><mo id="S3.E4.m1.3.3.1a" xref="S3.E4.m1.3.3.1.cmml">−</mo><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><mstyle displaystyle="true" id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml"><munderover id="S3.E4.m1.3.3.1.1.2a" xref="S3.E4.m1.3.3.1.1.2.cmml"><mo id="S3.E4.m1.3.3.1.1.2.2.2" movablelimits="false" xref="S3.E4.m1.3.3.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.3.3.1.1.2.2.3" xref="S3.E4.m1.3.3.1.1.2.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.2.2.3.2" xref="S3.E4.m1.3.3.1.1.2.2.3.2.cmml">t</mi><mo id="S3.E4.m1.3.3.1.1.2.2.3.1" xref="S3.E4.m1.3.3.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.3.3.1.1.2.2.3.3" xref="S3.E4.m1.3.3.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo><mover accent="true" id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml">𝐲</mi><mo id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml">^</mo></mover><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.3.1" xref="S3.E4.m1.3.3.1.1.1.3.1.cmml">log</mi><mo id="S3.E4.m1.3.3.1.1.1.3a" lspace="0.167em" xref="S3.E4.m1.3.3.1.1.1.3.cmml">⁡</mo><mi id="S3.E4.m1.3.3.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.1.3.2.cmml">p</mi></mrow><mo id="S3.E4.m1.3.3.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.2" mathvariant="normal" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S3.E4.m1.3.3.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐲</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">𝐱</mi></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"><eq id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.2"></eq><apply id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.1.cmml" xref="S3.E4.m1.3.3.3">subscript</csymbol><ci id="S3.E4.m1.3.3.3.2.cmml" xref="S3.E4.m1.3.3.3.2">ℒ</ci><ci id="S3.E4.m1.3.3.3.3a.cmml" xref="S3.E4.m1.3.3.3.3"><mtext id="S3.E4.m1.3.3.3.3.cmml" mathsize="70%" xref="S3.E4.m1.3.3.3.3">KD</mtext></ci></apply><apply id="S3.E4.m1.3.3.1.cmml" xref="S3.E4.m1.3.3.1"><minus id="S3.E4.m1.3.3.1.2.cmml" xref="S3.E4.m1.3.3.1"></minus><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1"><apply id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2">subscript</csymbol><sum id="S3.E4.m1.3.3.1.1.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.2"></sum><apply id="S3.E4.m1.3.3.1.1.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.2.3"><eq id="S3.E4.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2.3.2">𝑡</ci><cn id="S3.E4.m1.3.3.1.1.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.3.3.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.3"><abs id="S3.E4.m1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.3.1"></abs><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"><ci id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1">^</ci><ci id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2">𝐲</ci></apply></apply></apply><apply id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"><times id="S3.E4.m1.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.2"></times><apply id="S3.E4.m1.3.3.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.3"><log id="S3.E4.m1.3.3.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.3.1"></log><ci id="S3.E4.m1.3.3.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.3.2">𝑝</ci></apply><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.2">conditional</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.2"><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.1">^</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.2.2">y</ci></apply><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.3.3">𝑡</ci></apply><list id="S3.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1"><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝐲</ci></apply><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3"><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">1</cn><apply id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3"><minus id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝐱</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\displaystyle\mathcal{L}_{\text{KD}}=-\sum_{t=1}^{|\hat{\mathbf{y}}|}\log p(%
\hat{\mathrm{y}}_{t}|\hat{\mathbf{y}}_{1:t-1},\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">caligraphic_L start_POSTSUBSCRIPT KD end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | over^ start_ARG bold_y end_ARG | end_POSTSUPERSCRIPT roman_log italic_p ( over^ start_ARG roman_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">Our self-distillation is an ensemble-then-distill process. This differs from a straightforward practice of multi-teacher distillation, where the student learns from the union of teachers’ outputs <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib58" title="">2021</a>)</cite>. The commonly applied cross-entropy loss is known to yield overly smooth distributions <cite class="ltx_cite ltx_citemacro_cite">Wen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib53" title="">2023a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib54" title="">b</a>)</cite>, and the problem becomes more severe with multiple teachers, leading to unsatisfactory performance of union distillation <cite class="ltx_cite ltx_citemacro_cite">Shayegh et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib46" title="">2024</a>)</cite>. By contrast, our approach provides the student with a consolidated pseudo-groundtruth translation for an input, causing less confusion during the distillation process especially when teachers disagree with each other.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Settings</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Datasets.</span> We evaluated EBBS on two popular benchmark datasets for zero-shot machine translation: IWSLT <cite class="ltx_cite ltx_citemacro_citep">(Cettolo et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib8" title="">2017</a>)</cite>, which contains 4 languages (with English) and 6 zero-shot directions; and Europarl v7 <cite class="ltx_cite ltx_citemacro_citep">(Koehn, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib26" title="">2005</a>)</cite>, which contains 9 languages and 56 zero-shot directions.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.5"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.5.1">Metrics.</span> We evaluated translation quality with BLEU scores <cite class="ltx_cite ltx_citemacro_citep">(Papineni et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib36" title="">2002</a>)</cite>, which measure the <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_n</annotation></semantics></math>-gram overlap between generated and reference translations.
In particular, BLEU<math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_n</annotation></semantics></math> denotes the <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_n</annotation></semantics></math>-gram overlap, and BLEU denotes the geometric mean of BLEU<math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">italic_n</annotation></semantics></math> for <math alttext="n=1,\cdots,4" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.3"><semantics id="S4.SS1.p2.5.m5.3a"><mrow id="S4.SS1.p2.5.m5.3.4" xref="S4.SS1.p2.5.m5.3.4.cmml"><mi id="S4.SS1.p2.5.m5.3.4.2" xref="S4.SS1.p2.5.m5.3.4.2.cmml">n</mi><mo id="S4.SS1.p2.5.m5.3.4.1" xref="S4.SS1.p2.5.m5.3.4.1.cmml">=</mo><mrow id="S4.SS1.p2.5.m5.3.4.3.2" xref="S4.SS1.p2.5.m5.3.4.3.1.cmml"><mn id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">1</mn><mo id="S4.SS1.p2.5.m5.3.4.3.2.1" xref="S4.SS1.p2.5.m5.3.4.3.1.cmml">,</mo><mi id="S4.SS1.p2.5.m5.2.2" mathvariant="normal" xref="S4.SS1.p2.5.m5.2.2.cmml">⋯</mi><mo id="S4.SS1.p2.5.m5.3.4.3.2.2" xref="S4.SS1.p2.5.m5.3.4.3.1.cmml">,</mo><mn id="S4.SS1.p2.5.m5.3.3" xref="S4.SS1.p2.5.m5.3.3.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.3b"><apply id="S4.SS1.p2.5.m5.3.4.cmml" xref="S4.SS1.p2.5.m5.3.4"><eq id="S4.SS1.p2.5.m5.3.4.1.cmml" xref="S4.SS1.p2.5.m5.3.4.1"></eq><ci id="S4.SS1.p2.5.m5.3.4.2.cmml" xref="S4.SS1.p2.5.m5.3.4.2">𝑛</ci><list id="S4.SS1.p2.5.m5.3.4.3.1.cmml" xref="S4.SS1.p2.5.m5.3.4.3.2"><cn id="S4.SS1.p2.5.m5.1.1.cmml" type="integer" xref="S4.SS1.p2.5.m5.1.1">1</cn><ci id="S4.SS1.p2.5.m5.2.2.cmml" xref="S4.SS1.p2.5.m5.2.2">⋯</ci><cn id="S4.SS1.p2.5.m5.3.3.cmml" type="integer" xref="S4.SS1.p2.5.m5.3.3">4</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.3c">n=1,\cdots,4</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.3d">italic_n = 1 , ⋯ , 4</annotation></semantics></math> with a brevity penalty.
We used the standard SacreBLEU <cite class="ltx_cite ltx_citemacro_cite">Post (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib37" title="">2018</a>)</cite>, following recent translation studies <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>); Scao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib41" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Model architecture.</span>
We replicated <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite> and trained a multilingual system as our base model.
Specifically, we had a 5-layer encoder–decoder Transformer for IWSLT, but used an 8-layer Transformer for Europarl to accommodate more training data and languages.
We also followed <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite> and removed residual connections in certain middle layers of the encoder (2nd layer for IWSLT; 2nd and 4th layers for Europarl). <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite> show weakening positional correspondence between layers can significantly improve zero-shot performance, which was also observed in our replication experiments.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">More details about our experimental setup can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A2" title="Appendix B Details of Our Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Competing Methods</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We compare our EBBS against the following methods, including pivoting and different ensembles.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">English pivoting.</span> Pivoting is commonly applied for translation <cite class="ltx_cite ltx_citemacro_citep">(Wu and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib59" title="">2007</a>, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib60" title="">2009</a>; Vamvas and Sennrich, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib47" title="">2022</a>)</cite>, and we used English as the pivot in our setting because we have parallel data for translations both from and to English.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">Word-level averaging ensemble.</span> Averaging is one of the most widely used ensemble techniques in text generation <cite class="ltx_cite ltx_citemacro_citep">(Sennrich et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib43" title="">2016a</a>; Freitag et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib15" title="">2017</a>; Shanbhogue et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib45" title="">2023</a>)</cite>. Essentially, the ensemble components’ probabilities are first averaged before being fed to the standard beam search (Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#alg2" title="2 ‣ Appendix A Beam Search ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.p4.2.1">Word-level voting ensemble.</span> The voting ensemble, common in classification tasks, picks the output class based on the number of votes from ensemble components (given by <math alttext="\operatorname{argmax}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">argmax</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">argmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\operatorname{argmax}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">roman_argmax</annotation></semantics></math>).
However, voting is not common in text generation, because <math alttext="\operatorname{argmax}" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mi id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">argmax</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">argmax</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\operatorname{argmax}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">roman_argmax</annotation></semantics></math> may select completely different words by the ensemble components due to the large vocabulary size, making voting ineffective.
As a remedy, we pick the word by the highest probability when there is a tie for votes.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.p5.2.1">Sequence-level voting ensemble.</span> Minimum Bayes risk decoding is originally designed as a single-model decoding algorithm, where it selects a sequence from a set of beam search results based on similarity <cite class="ltx_cite ltx_citemacro_citep">(Eikema and Aziz, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib13" title="">2020</a>; Müller and Sennrich, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib33" title="">2021</a>)</cite>. Here, we use it as a sequence-level ensemble technique, where the candidates are the output sequences from different ensemble components.
Let <math alttext="C=\{\mathbf{y}_{1},\cdots,\mathbf{y}_{K}\}" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.3"><semantics id="S4.SS2.p5.1.m1.3a"><mrow id="S4.SS2.p5.1.m1.3.3" xref="S4.SS2.p5.1.m1.3.3.cmml"><mi id="S4.SS2.p5.1.m1.3.3.4" xref="S4.SS2.p5.1.m1.3.3.4.cmml">C</mi><mo id="S4.SS2.p5.1.m1.3.3.3" xref="S4.SS2.p5.1.m1.3.3.3.cmml">=</mo><mrow id="S4.SS2.p5.1.m1.3.3.2.2" xref="S4.SS2.p5.1.m1.3.3.2.3.cmml"><mo id="S4.SS2.p5.1.m1.3.3.2.2.3" stretchy="false" xref="S4.SS2.p5.1.m1.3.3.2.3.cmml">{</mo><msub id="S4.SS2.p5.1.m1.2.2.1.1.1" xref="S4.SS2.p5.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS2.p5.1.m1.2.2.1.1.1.2" xref="S4.SS2.p5.1.m1.2.2.1.1.1.2.cmml">𝐲</mi><mn id="S4.SS2.p5.1.m1.2.2.1.1.1.3" xref="S4.SS2.p5.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.p5.1.m1.3.3.2.2.4" xref="S4.SS2.p5.1.m1.3.3.2.3.cmml">,</mo><mi id="S4.SS2.p5.1.m1.1.1" mathvariant="normal" xref="S4.SS2.p5.1.m1.1.1.cmml">⋯</mi><mo id="S4.SS2.p5.1.m1.3.3.2.2.5" xref="S4.SS2.p5.1.m1.3.3.2.3.cmml">,</mo><msub id="S4.SS2.p5.1.m1.3.3.2.2.2" xref="S4.SS2.p5.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS2.p5.1.m1.3.3.2.2.2.2" xref="S4.SS2.p5.1.m1.3.3.2.2.2.2.cmml">𝐲</mi><mi id="S4.SS2.p5.1.m1.3.3.2.2.2.3" xref="S4.SS2.p5.1.m1.3.3.2.2.2.3.cmml">K</mi></msub><mo id="S4.SS2.p5.1.m1.3.3.2.2.6" stretchy="false" xref="S4.SS2.p5.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.3b"><apply id="S4.SS2.p5.1.m1.3.3.cmml" xref="S4.SS2.p5.1.m1.3.3"><eq id="S4.SS2.p5.1.m1.3.3.3.cmml" xref="S4.SS2.p5.1.m1.3.3.3"></eq><ci id="S4.SS2.p5.1.m1.3.3.4.cmml" xref="S4.SS2.p5.1.m1.3.3.4">𝐶</ci><set id="S4.SS2.p5.1.m1.3.3.2.3.cmml" xref="S4.SS2.p5.1.m1.3.3.2.2"><apply id="S4.SS2.p5.1.m1.2.2.1.1.1.cmml" xref="S4.SS2.p5.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p5.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.2.2.1.1.1.2">𝐲</ci><cn id="S4.SS2.p5.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS2.p5.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">⋯</ci><apply id="S4.SS2.p5.1.m1.3.3.2.2.2.cmml" xref="S4.SS2.p5.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS2.p5.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS2.p5.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS2.p5.1.m1.3.3.2.2.2.2">𝐲</ci><ci id="S4.SS2.p5.1.m1.3.3.2.2.2.3.cmml" xref="S4.SS2.p5.1.m1.3.3.2.2.2.3">𝐾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.3c">C=\{\mathbf{y}_{1},\cdots,\mathbf{y}_{K}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.3d">italic_C = { bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , bold_y start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT }</annotation></semantics></math> be the set of candidate outputs given by <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><mi id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><ci id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">italic_K</annotation></semantics></math> ensemble components. The best output is selected as
</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A6.EGx5">
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{y}^{*}=\operatorname*{argmax}\limits_{\mathbf{y}\in C}%
\sum_{\mathbf{y}^{\prime}\in C\setminus\{\mathbf{y}\}}\text{BLEU}(\mathbf{y},%
\mathbf{y}^{\prime})" class="ltx_Math" display="inline" id="S4.E5.m1.3"><semantics id="S4.E5.m1.3a"><mrow id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml"><msup id="S4.E5.m1.3.3.3" xref="S4.E5.m1.3.3.3.cmml"><mi id="S4.E5.m1.3.3.3.2" xref="S4.E5.m1.3.3.3.2.cmml">𝐲</mi><mo id="S4.E5.m1.3.3.3.3" xref="S4.E5.m1.3.3.3.3.cmml">*</mo></msup><mo id="S4.E5.m1.3.3.2" rspace="0.1389em" xref="S4.E5.m1.3.3.2.cmml">=</mo><mrow id="S4.E5.m1.3.3.1" xref="S4.E5.m1.3.3.1.cmml"><munder id="S4.E5.m1.3.3.1.3" xref="S4.E5.m1.3.3.1.3.cmml"><mo id="S4.E5.m1.3.3.1.3.2" lspace="0.1389em" xref="S4.E5.m1.3.3.1.3.2.cmml">argmax</mo><mrow id="S4.E5.m1.3.3.1.3.3" xref="S4.E5.m1.3.3.1.3.3.cmml"><mi id="S4.E5.m1.3.3.1.3.3.2" xref="S4.E5.m1.3.3.1.3.3.2.cmml">𝐲</mi><mo id="S4.E5.m1.3.3.1.3.3.1" xref="S4.E5.m1.3.3.1.3.3.1.cmml">∈</mo><mi id="S4.E5.m1.3.3.1.3.3.3" xref="S4.E5.m1.3.3.1.3.3.3.cmml">C</mi></mrow></munder><mo id="S4.E5.m1.3.3.1.2" lspace="0.167em" xref="S4.E5.m1.3.3.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.3.3.1.1" xref="S4.E5.m1.3.3.1.1.cmml"><mstyle displaystyle="true" id="S4.E5.m1.3.3.1.1.2" xref="S4.E5.m1.3.3.1.1.2.cmml"><munder id="S4.E5.m1.3.3.1.1.2a" xref="S4.E5.m1.3.3.1.1.2.cmml"><mo id="S4.E5.m1.3.3.1.1.2.2" movablelimits="false" xref="S4.E5.m1.3.3.1.1.2.2.cmml">∑</mo><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.cmml"><msup id="S4.E5.m1.1.1.1.3" xref="S4.E5.m1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.3.2.cmml">𝐲</mi><mo id="S4.E5.m1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.3.3.cmml">′</mo></msup><mo id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.2.cmml">∈</mo><mrow id="S4.E5.m1.1.1.1.4" xref="S4.E5.m1.1.1.1.4.cmml"><mi id="S4.E5.m1.1.1.1.4.2" xref="S4.E5.m1.1.1.1.4.2.cmml">C</mi><mo id="S4.E5.m1.1.1.1.4.1" xref="S4.E5.m1.1.1.1.4.1.cmml">∖</mo><mrow id="S4.E5.m1.1.1.1.4.3.2" xref="S4.E5.m1.1.1.1.4.3.1.cmml"><mo id="S4.E5.m1.1.1.1.4.3.2.1" stretchy="false" xref="S4.E5.m1.1.1.1.4.3.1.cmml">{</mo><mi id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">𝐲</mi><mo id="S4.E5.m1.1.1.1.4.3.2.2" stretchy="false" xref="S4.E5.m1.1.1.1.4.3.1.cmml">}</mo></mrow></mrow></mrow></munder></mstyle><mrow id="S4.E5.m1.3.3.1.1.1" xref="S4.E5.m1.3.3.1.1.1.cmml"><mtext id="S4.E5.m1.3.3.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.3a.cmml">BLEU</mtext><mo id="S4.E5.m1.3.3.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.2.cmml"><mo id="S4.E5.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.3.3.1.1.1.1.2.cmml">(</mo><mi id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">𝐲</mi><mo id="S4.E5.m1.3.3.1.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.2.cmml">,</mo><msup id="S4.E5.m1.3.3.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.cmml">𝐲</mi><mo id="S4.E5.m1.3.3.1.1.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S4.E5.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S4.E5.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.3b"><apply id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3"><eq id="S4.E5.m1.3.3.2.cmml" xref="S4.E5.m1.3.3.2"></eq><apply id="S4.E5.m1.3.3.3.cmml" xref="S4.E5.m1.3.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.3.1.cmml" xref="S4.E5.m1.3.3.3">superscript</csymbol><ci id="S4.E5.m1.3.3.3.2.cmml" xref="S4.E5.m1.3.3.3.2">𝐲</ci><times id="S4.E5.m1.3.3.3.3.cmml" xref="S4.E5.m1.3.3.3.3"></times></apply><apply id="S4.E5.m1.3.3.1.cmml" xref="S4.E5.m1.3.3.1"><times id="S4.E5.m1.3.3.1.2.cmml" xref="S4.E5.m1.3.3.1.2"></times><apply id="S4.E5.m1.3.3.1.3.cmml" xref="S4.E5.m1.3.3.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.3.1.cmml" xref="S4.E5.m1.3.3.1.3">subscript</csymbol><ci id="S4.E5.m1.3.3.1.3.2.cmml" xref="S4.E5.m1.3.3.1.3.2">argmax</ci><apply id="S4.E5.m1.3.3.1.3.3.cmml" xref="S4.E5.m1.3.3.1.3.3"><in id="S4.E5.m1.3.3.1.3.3.1.cmml" xref="S4.E5.m1.3.3.1.3.3.1"></in><ci id="S4.E5.m1.3.3.1.3.3.2.cmml" xref="S4.E5.m1.3.3.1.3.3.2">𝐲</ci><ci id="S4.E5.m1.3.3.1.3.3.3.cmml" xref="S4.E5.m1.3.3.1.3.3.3">𝐶</ci></apply></apply><apply id="S4.E5.m1.3.3.1.1.cmml" xref="S4.E5.m1.3.3.1.1"><apply id="S4.E5.m1.3.3.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.2.1.cmml" xref="S4.E5.m1.3.3.1.1.2">subscript</csymbol><sum id="S4.E5.m1.3.3.1.1.2.2.cmml" xref="S4.E5.m1.3.3.1.1.2.2"></sum><apply id="S4.E5.m1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><in id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.2"></in><apply id="S4.E5.m1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.3">superscript</csymbol><ci id="S4.E5.m1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.3.2">𝐲</ci><ci id="S4.E5.m1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.3.3">′</ci></apply><apply id="S4.E5.m1.1.1.1.4.cmml" xref="S4.E5.m1.1.1.1.4"><setdiff id="S4.E5.m1.1.1.1.4.1.cmml" xref="S4.E5.m1.1.1.1.4.1"></setdiff><ci id="S4.E5.m1.1.1.1.4.2.cmml" xref="S4.E5.m1.1.1.1.4.2">𝐶</ci><set id="S4.E5.m1.1.1.1.4.3.1.cmml" xref="S4.E5.m1.1.1.1.4.3.2"><ci id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1">𝐲</ci></set></apply></apply></apply><apply id="S4.E5.m1.3.3.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1"><times id="S4.E5.m1.3.3.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.2"></times><ci id="S4.E5.m1.3.3.1.1.1.3a.cmml" xref="S4.E5.m1.3.3.1.1.1.3"><mtext id="S4.E5.m1.3.3.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.3">BLEU</mtext></ci><interval closure="open" id="S4.E5.m1.3.3.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1"><ci id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">𝐲</ci><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2">𝐲</ci><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3">′</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.3c">\displaystyle\mathbf{y}^{*}=\operatorname*{argmax}\limits_{\mathbf{y}\in C}%
\sum_{\mathbf{y}^{\prime}\in C\setminus\{\mathbf{y}\}}\text{BLEU}(\mathbf{y},%
\mathbf{y}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.3d">bold_y start_POSTSUPERSCRIPT * end_POSTSUPERSCRIPT = roman_argmax start_POSTSUBSCRIPT bold_y ∈ italic_C end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT bold_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_C ∖ { bold_y } end_POSTSUBSCRIPT BLEU ( bold_y , bold_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p5.5">where <math alttext="\text{BLEU}(\mathbf{h},\mathbf{r})" class="ltx_Math" display="inline" id="S4.SS2.p5.3.m1.2"><semantics id="S4.SS2.p5.3.m1.2a"><mrow id="S4.SS2.p5.3.m1.2.3" xref="S4.SS2.p5.3.m1.2.3.cmml"><mtext id="S4.SS2.p5.3.m1.2.3.2" xref="S4.SS2.p5.3.m1.2.3.2a.cmml">BLEU</mtext><mo id="S4.SS2.p5.3.m1.2.3.1" xref="S4.SS2.p5.3.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS2.p5.3.m1.2.3.3.2" xref="S4.SS2.p5.3.m1.2.3.3.1.cmml"><mo id="S4.SS2.p5.3.m1.2.3.3.2.1" stretchy="false" xref="S4.SS2.p5.3.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS2.p5.3.m1.1.1" xref="S4.SS2.p5.3.m1.1.1.cmml">𝐡</mi><mo id="S4.SS2.p5.3.m1.2.3.3.2.2" xref="S4.SS2.p5.3.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS2.p5.3.m1.2.2" xref="S4.SS2.p5.3.m1.2.2.cmml">𝐫</mi><mo id="S4.SS2.p5.3.m1.2.3.3.2.3" stretchy="false" xref="S4.SS2.p5.3.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m1.2b"><apply id="S4.SS2.p5.3.m1.2.3.cmml" xref="S4.SS2.p5.3.m1.2.3"><times id="S4.SS2.p5.3.m1.2.3.1.cmml" xref="S4.SS2.p5.3.m1.2.3.1"></times><ci id="S4.SS2.p5.3.m1.2.3.2a.cmml" xref="S4.SS2.p5.3.m1.2.3.2"><mtext id="S4.SS2.p5.3.m1.2.3.2.cmml" xref="S4.SS2.p5.3.m1.2.3.2">BLEU</mtext></ci><interval closure="open" id="S4.SS2.p5.3.m1.2.3.3.1.cmml" xref="S4.SS2.p5.3.m1.2.3.3.2"><ci id="S4.SS2.p5.3.m1.1.1.cmml" xref="S4.SS2.p5.3.m1.1.1">𝐡</ci><ci id="S4.SS2.p5.3.m1.2.2.cmml" xref="S4.SS2.p5.3.m1.2.2">𝐫</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m1.2c">\text{BLEU}(\mathbf{h},\mathbf{r})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.3.m1.2d">BLEU ( bold_h , bold_r )</annotation></semantics></math> computes the BLEU score between a hypothesis <math alttext="\mathbf{h}" class="ltx_Math" display="inline" id="S4.SS2.p5.4.m2.1"><semantics id="S4.SS2.p5.4.m2.1a"><mi id="S4.SS2.p5.4.m2.1.1" xref="S4.SS2.p5.4.m2.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m2.1b"><ci id="S4.SS2.p5.4.m2.1.1.cmml" xref="S4.SS2.p5.4.m2.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m2.1c">\mathbf{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.4.m2.1d">bold_h</annotation></semantics></math> and a reference <math alttext="\mathbf{r}" class="ltx_Math" display="inline" id="S4.SS2.p5.5.m3.1"><semantics id="S4.SS2.p5.5.m3.1a"><mi id="S4.SS2.p5.5.m3.1.1" xref="S4.SS2.p5.5.m3.1.1.cmml">𝐫</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m3.1b"><ci id="S4.SS2.p5.5.m3.1.1.cmml" xref="S4.SS2.p5.5.m3.1.1">𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m3.1c">\mathbf{r}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.5.m3.1d">bold_r</annotation></semantics></math>.
In essence, MBR selects an output that resembles others most, using BLEU as the similarity metric.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results and Analysis</h3>
<figure class="ltx_table" id="S4.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.2" style="width:390.3pt;height:175.8pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-125.7pt,56.4pt) scale(0.608176252443124,0.608176252443124) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.2.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.2.2.3.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.2.2.3.1.1" rowspan="8"><span class="ltx_text" id="S4.T1.2.2.3.1.1.1">IWSLT</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.2.3.1.2">#</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.2.3.1.3">Model</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.3.1.4">Average</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.3.1.5">it-nl</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.3.1.6">it-ro</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.3.1.7">nl-it</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.3.1.8">nl-ro</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.3.1.9">ro-it</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.2.2.3.1.10">ro-nl</td>
<td class="ltx_td" id="S4.T1.2.2.3.1.11"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.2">1</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1">Direct translation <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite><math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.m1.1a"><msup id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml"><mi id="S4.T1.1.1.1.1.m1.1.1a" xref="S4.T1.1.1.1.1.m1.1.1.cmml"></mi><mo id="S4.T1.1.1.1.1.m1.1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1"><ci id="S4.T1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.1.1.1.3">17.7</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.1.1.1.4">18.5</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.1.1.1.5">17.8</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.1.1.1.6">17.9</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.1.1.1.7">15.5</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.1.1.1.8">19.6</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T1.1.1.1.9">16.8</td>
<td class="ltx_td" id="S4.T1.1.1.1.10"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.4.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.4.2.1">2</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.2.4.2.2">Direct translation (our replication)</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.4.2.3">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.4.2.3.1">\ul</span>17.29</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.4.2.4">17.46</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.4.2.5"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.4.2.5.1">17.48</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.4.2.6">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.4.2.6.1">\ul</span>18.23</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.4.2.7"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.4.2.7.1">14.63</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.4.2.8">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.4.2.8.1">\ul</span>19.65</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.2.2.4.2.9">16.26</td>
<td class="ltx_td" id="S4.T1.2.2.4.2.10"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.5.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.5.3.1">3</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.2.5.3.2">Pivoting (en)</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.5.3.3">16.19</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.5.3.4">17.49</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.5.3.5">15.09</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.5.3.6">16.79</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.5.3.7">13.05</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.5.3.8">18.34</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.2.2.5.3.9">16.37</td>
<td class="ltx_td" id="S4.T1.2.2.5.3.10"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.6.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.6.4.1">4</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.2.6.4.2">Word-level averaging ensemble</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.6.4.3">16.52</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.6.4.4">16.48</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.6.4.5">16.49</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.6.4.6">17.53</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.6.4.7">13.80</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.6.4.8">19.07</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T1.2.2.6.4.9">15.77</td>
<td class="ltx_td" id="S4.T1.2.2.6.4.10"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.7.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.7.5.1">5</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.2.7.5.2">Word-level voting ensemble</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.7.5.3">16.99</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.7.5.4">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.7.5.4.1">\ul</span>17.58</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.7.5.5">16.38</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.7.5.6">17.78</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.7.5.7">14.13</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.7.5.8">19.21</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.2.2.7.5.9">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.7.5.9.1">\ul</span>16.84</td>
<td class="ltx_td" id="S4.T1.2.2.7.5.10"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.8.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.8.6.1">6</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.2.8.6.2">Sequence-level voting ensemble (MBR)</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.8.6.3">16.66</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.8.6.4">16.54</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.8.6.5">16.51</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.8.6.6">17.72</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.8.6.7">13.64</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.8.6.8">19.58</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.2.2.8.6.9">15.98</td>
<td class="ltx_td" id="S4.T1.2.2.8.6.10"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.9.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.9.7.1">7</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.2.9.7.2">EBBS (ours)</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.9.7.3"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.9.7.3.1">18.24</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.9.7.4"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.9.7.4.1">19.52</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.9.7.5">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.9.7.5.1">\ul</span>17.09</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.9.7.6"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.9.7.6.1">19.06</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.9.7.7">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.9.7.7.1">\ul</span>14.58</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.9.7.8"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.9.7.8.1">20.75</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.2.2.9.7.9">
<span class="ltx_text ltx_font_bold" id="S4.T1.2.2.9.7.9.1">18.45</span></td>
<td class="ltx_td" id="S4.T1.2.2.9.7.10"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.10.8">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_tt" id="S4.T1.2.2.10.8.1" rowspan="8"><span class="ltx_text" id="S4.T1.2.2.10.8.1.1">Europarl</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T1.2.2.10.8.2">#</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T1.2.2.10.8.3">Model</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.2.2.10.8.4">Average</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.2.2.10.8.5">da-de</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.2.2.10.8.6">da-es</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.2.2.10.8.7">da-fi</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.2.2.10.8.8">da-fr</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.2.2.10.8.9">da-it</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.2.2.10.8.10">da-nl</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.2.2.10.8.11">da-pt</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.2.2.2.2">1</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.2.2.1">Direct translation <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite><math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="S4.T1.2.2.2.1.m1.1"><semantics id="S4.T1.2.2.2.1.m1.1a"><msup id="S4.T1.2.2.2.1.m1.1.1" xref="S4.T1.2.2.2.1.m1.1.1.cmml"><mi id="S4.T1.2.2.2.1.m1.1.1a" xref="S4.T1.2.2.2.1.m1.1.1.cmml"></mi><mo id="S4.T1.2.2.2.1.m1.1.1.1" xref="S4.T1.2.2.2.1.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.1.m1.1b"><apply id="S4.T1.2.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.2.1.m1.1.1"><ci id="S4.T1.2.2.2.1.m1.1.1.1.cmml" xref="S4.T1.2.2.2.1.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.1.m1.1c">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.1.m1.1d">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.2.3">26.9</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.2.4">24.2</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.2.5">33.1</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.2.6">18.1</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.2.7">30.6</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.2.8">26.1</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.2.9">26.3</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T1.2.2.2.10">29.9</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.11.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.11.9.1">2</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.2.11.9.2">Direct translation (our replication)</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.11.9.3">27.74</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.11.9.4">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.11.9.4.1">\ul</span>26.24</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.11.9.5">33.64</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.11.9.6">18.95</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.11.9.7">31.01</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.11.9.8">26.58</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.11.9.9">27.36</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.2.2.11.9.10">30.38</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.12.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.12.10.1">3</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.2.12.10.2">Pivoting (en)</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.12.10.3">27.67</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.12.10.4">25.15</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.12.10.5">33.79</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.12.10.6">18.63</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.12.10.7">31.45</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.12.10.8">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.12.10.8.1">\ul</span>27.12</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.12.10.9">26.71</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.2.2.12.10.10">30.82</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.13.11">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.13.11.1">4</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.2.13.11.2">Word-level averaging ensemble</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.13.11.3">27.76</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.13.11.4">26.21</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.13.11.5">33.64</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.13.11.6">18.88</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.13.11.7">31.09</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.13.11.8">26.71</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.2.13.11.9">27.40</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T1.2.2.13.11.10">30.37</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.14.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.14.12.1">5</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.2.14.12.2">Word-level voting ensemble</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.14.12.3">27.75</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.14.12.4">25.93</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.14.12.5">33.90</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.14.12.6">18.47</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.14.12.7">31.29</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.14.12.8">27.08</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.14.12.9">26.74</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.2.2.14.12.10">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.14.12.10.1">\ul</span>30.84</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.15.13">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.15.13.1">6</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.2.15.13.2">Sequence-level voting ensemble (MBR)</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.15.13.3">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.15.13.3.1">\ul</span>27.85</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.15.13.4">25.88</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.15.13.5">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.15.13.5.1">\ul</span>33.93</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.15.13.6">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.15.13.6.1">\ul</span>19.10</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.15.13.7">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.15.13.7.1">\ul</span>31.47</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.15.13.8">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.15.13.8.1">\ul</span>27.12</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.2.15.13.9">
<span class="ltx_ERROR undefined" id="S4.T1.2.2.15.13.9.1">\ul</span>26.98</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.2.2.15.13.10">30.49</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.16.14">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T1.2.2.16.14.1">7</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S4.T1.2.2.16.14.2">EBBS (ours)</td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T1.2.2.16.14.3"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.16.14.3.1">28.36</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T1.2.2.16.14.4"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.16.14.4.1">26.32</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T1.2.2.16.14.5"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.16.14.5.1">34.28</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T1.2.2.16.14.6"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.16.14.6.1">19.43</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T1.2.2.16.14.7"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.16.14.7.1">31.97</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T1.2.2.16.14.8"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.16.14.8.1">27.67</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T1.2.2.16.14.9"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.16.14.9.1">27.78</span></td>
<td class="ltx_td ltx_align_right ltx_border_b ltx_border_r" id="S4.T1.2.2.16.14.10">
<span class="ltx_text ltx_font_bold" id="S4.T1.2.2.16.14.10.1">31.08</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Main results on the IWSLT and Europarl datasets.
The best results are in <span class="ltx_text ltx_font_bold" id="S4.T1.7.1">bold</span>, and the second best results are <span class="ltx_text ltx_ulem_uline" id="S4.T1.8.2">underlined</span>. <math alttext="{}^{\dagger}" class="ltx_Math" display="inline" id="S4.T1.4.m1.1"><semantics id="S4.T1.4.m1.1b"><msup id="S4.T1.4.m1.1.1" xref="S4.T1.4.m1.1.1.cmml"><mi id="S4.T1.4.m1.1.1b" xref="S4.T1.4.m1.1.1.cmml"></mi><mo id="S4.T1.4.m1.1.1.1" xref="S4.T1.4.m1.1.1.1.cmml">†</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.4.m1.1c"><apply id="S4.T1.4.m1.1.1.cmml" xref="S4.T1.4.m1.1.1"><ci id="S4.T1.4.m1.1.1.1.cmml" xref="S4.T1.4.m1.1.1.1">†</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.m1.1d">{}^{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.m1.1e">start_FLOATSUPERSCRIPT † end_FLOATSUPERSCRIPT</annotation></semantics></math> indicates cited results; others were obtained by our experimentation.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.1">Main results.</span>
We first replicated the base multilingual model <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite>. As shown in <span class="ltx_text" id="S4.SS3.p1.1.2">Rows 1–2</span>, Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.T1" title="Table 1 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a>, the results are generally close, indicating that the replication is successful and ready for our ensemble research. Further, we tried English pivoting (Row 3), a common zero-shot translation method.
In our experiments, we find that it does not outperform direct translation, as pivoting methods may suffer from the error accumulation problem since it requires two steps of translation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">We then compare different ensemble techniques, including the proposed EBBS and alternative ensemble methods.
Specifically, we notice that IWSLT contains four languages (with English); thus we have two available pivoting directions (excluding source and target), which, along with direct translation, are our three ensemble components. For Europarl, it contains nine languages; for performance and efficiency concerns (to be shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.F2" title="Figure 2 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a>), we also consider three translation paths as our ensemble components: direction translation, English pivoting, and a second pivot.<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>We use the first available language in the order of Spanish, German, and French. For example, Spanish-to-German translation will have to use French as the pivot. These languages are chosen because they have the most content on the Internet according to the Web Technology Surveys (<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://w3techs.com/technologies/overview/content_language" title="">https://w3techs.com/technologies/overview/content_language</a>), allowing us to better simulate real-world applications.</span></span></span></p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1">We start by studying the standard ensemble technique of word-level averaging (Row 4), which has been used in previous translation research <cite class="ltx_cite ltx_citemacro_citep">(Freitag et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib15" title="">2017</a>)</cite>.
In particular, our averaging ensemble performs worse than direct translation on IWSLT, but is slightly better on Europarl. Our results are not consistent to <cite class="ltx_cite ltx_citemacro_citet">Freitag et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib15" title="">2017</a>)</cite>, who show a word-level averaging ensemble of random seeds can improve performance. This is understandable because models trained with random seeds exhibit similar behavior, and averaging their probabilities achieves a denoising effect. However, our ensemble components are drastically different in terms of their strengths and expertise, because they learn diverse translation patterns from different languages.
Thus, word averaging fails to improve translation quality in our setting.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1">Alternatively, voting ensembles can also be applied, at either the word level or the sequence level.
As seen, word-level voting is not effective, as it does not achieve significant improvements (Row 5).
This is expected because the voted words (top predictions) by the ensemble components may not overlap due to the large vocabulary size.
In such cases, the algorithm defaults to choosing the word with the highest probability, causing the ensemble to follow the most peaked distributions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.1">Sequence-level voting should also be done in a soft manner, and minimum Bayes risk (MBR) decoding can be thought of as using a Bayes risk to softly “vote” the candidate outputs. As seen from Row 6, such a method works relatively well on Europarl, achieving the second-highest performance across all competing methods; however, it works poorly on the IWSLT dataset.
The main drawback of sequence-level voting is that it can only <span class="ltx_text ltx_font_italic" id="S4.SS3.p5.1.1">select</span> one of the ensemble components’ outputs.
This may not work well when the individual ensemble components are weak, as in our zero-shot setting, and especially with the IWSLT dataset due to a relatively small training set.
Such a selective sequence-level ensemble cannot integrate different expertise of its components during generation.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.1" style="width:173.4pt;height:130.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-9.1pt,6.9pt) scale(0.904668313233288,0.904668313233288) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.1.2.1.1">Dataset</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.1.1.2.1.2">Method</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.2.1.3">Avg. BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.2.1.4">Wins</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.2.1.5">Losses</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.3.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_tt" id="S4.T2.1.1.3.2.1" rowspan="2"><span class="ltx_text" id="S4.T2.1.1.3.2.1.1">IWSLT</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T2.1.1.3.2.2">Direct</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.3.2.3">17.28</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.3.2.4">2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.1.1.3.2.5">4</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.4.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.1.1.4.3.1">Ensemble</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.3.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.4.3.2.1">18.23</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.3.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.4.3.3.1">4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.4.3.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.4.3.4.1">2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.5.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.1.5.4.1" rowspan="2"><span class="ltx_text" id="S4.T2.1.1.5.4.1.1">Europarl</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.1.1.5.4.2">Direct</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5.4.3">27.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5.4.4">4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.1.1.5.4.5">52</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.6.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.1.1.6.5.1">Ensemble</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.5.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.6.5.2.1">28.44</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.5.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.6.5.3.1">52</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.6.5.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.6.5.4.1">4</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.7.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_tt" id="S4.T2.1.1.7.6.1" rowspan="2"><span class="ltx_text" id="S4.T2.1.1.7.6.1.1">Overall</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T2.1.1.7.6.2">Direct</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.7.6.3">26.83</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.7.6.4">6</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T2.1.1.7.6.5">56</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.8.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.1.1.8.7.1">Ensemble</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.8.7.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.7.2.1">27.45</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.8.7.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.7.3.1">56</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.1.1.8.7.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.7.4.1">6</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T2.1.1.1.1">
<math alttext="p" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.m1.1d">italic_p</annotation></semantics></math>-value</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" colspan="4" id="S4.T2.1.1.1.2">3e-11</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance statistics on all 66 zero-shot directions in both datasets. <math alttext="p" class="ltx_Math" display="inline" id="S4.T2.3.m1.1"><semantics id="S4.T2.3.m1.1b"><mi id="S4.T2.3.m1.1.1" xref="S4.T2.3.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T2.3.m1.1c"><ci id="S4.T2.3.m1.1.1.cmml" xref="S4.T2.3.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.m1.1d">p</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.m1.1e">italic_p</annotation></semantics></math>-value is given by a two-sided binomial test.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p6">
<p class="ltx_p" id="S4.SS3.p6.1">Unlike existing ensemble methods, our EBBS algorithm achieves the highest performance in most directions on both datasets. Notice that Europarl contains 56 zero-shot directions; due to the space limit, we can only present in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.T1" title="Table 1 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a> the first seven directions based on the order provided by the dataset. Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.T2" title="Table 2 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a> further shows a pairwise comparison against direct translation (a strong baseline in our experiment) in all zero-shot directions.
As seen, EBBS achieves higher performance in 56 out of 62 cases across two datasets, showing strong statistical evidence for its effectiveness, with a <math alttext="p" class="ltx_Math" display="inline" id="S4.SS3.p6.1.m1.1"><semantics id="S4.SS3.p6.1.m1.1a"><mi id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.1b"><ci id="S4.SS3.p6.1.m1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.1.m1.1d">italic_p</annotation></semantics></math>-value of 3e-11 in a two-sided binomial test.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.1" style="width:216.8pt;height:91.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-19.1pt,8.1pt) scale(0.849955605548041,0.849955605548041) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.1.1.2.1.1">Voting scheme</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.1.2">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.1.3">BLEU1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.1.4">BLEU2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2.1.5">BLEU3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.2.1.6">BLEU4</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.1.1.3.2.1">None (beam search)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.2">25.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.3">56.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.4">30.08</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.5">19.01</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.3.2.6">12.78</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T3.1.1.4.3.1">Total-sum</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.4.3.2">25.27</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.4.3.3">56.67</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.4.3.4">30.27</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.4.3.5">19.07</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.4.3.6">12.65</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T3.1.1.5.4.1">Max</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.2">25.81</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.3">56.89</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.4">30.76</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.5">
<span class="ltx_ERROR undefined" id="S4.T3.1.1.5.4.5.1">\ul</span>19.51</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.5.4.6">
<span class="ltx_ERROR undefined" id="S4.T3.1.1.5.4.6.1">\ul</span>13.09</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T3.1.1.6.5.1">0/1</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.2">
<span class="ltx_ERROR undefined" id="S4.T3.1.1.6.5.2.1">\ul</span>25.84</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.3">
<span class="ltx_ERROR undefined" id="S4.T3.1.1.6.5.3.1">\ul</span>56.99</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.4">
<span class="ltx_ERROR undefined" id="S4.T3.1.1.6.5.4.1">\ul</span>30.78</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.5">19.49</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.6.5.6">13.05</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="S4.T3.1.1.1.1">Top-<math alttext="Z" class="ltx_Math" display="inline" id="S4.T3.1.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.1.m1.1a"><mi id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.1.m1.1d">italic_Z</annotation></semantics></math> sum (ours)</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.2.1">26.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.3.1">57.07</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.4.1">31.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.5.1">19.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.6.1">13.28</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Comparison of different ensemble variants. We used Italian-to-Dutch translation in the Europarl dataset as a testbed due to the limit of time and resources.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p7">
<p class="ltx_p" id="S4.SS3.p7.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p7.1.1">Analysis of voting methods in EBBS.</span> In our EBBS algorithm, the lower-level beams are synchronized into a shared upper-level beam by voting.
Specifically, EBBS uses a sum-voting mechanism, where we add the ensemble components’ probabilities for each appearance of a candidate in the lower-level beam, shown in Eqn. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S3.E3" title="3 ‣ 3.2 Our Proposed EBBS Algorithm ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">3</span></a>).
Here, we analyze a few alternative voting methods for EBBS.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p8">
<p class="ltx_p" id="S4.SS3.p8.2">If EBBS adopts total-sum voting, it still uses lower-level beams to find candidates, but adds all components’ probabilities together. This is equivalent to applying the common averaging ensemble to the top-<math alttext="Z" class="ltx_Math" display="inline" id="S4.SS3.p8.1.m1.1"><semantics id="S4.SS3.p8.1.m1.1a"><mi id="S4.SS3.p8.1.m1.1.1" xref="S4.SS3.p8.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.1.m1.1b"><ci id="S4.SS3.p8.1.m1.1.1.cmml" xref="S4.SS3.p8.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p8.1.m1.1d">italic_Z</annotation></semantics></math> candidates. However, it
differs from our approach, because in total-sum voting, a component will vote even if the candidate does not appear in its own lower-level beam; the probability after voting in Eqn. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S3.E3" title="3 ‣ 3.2 Our Proposed EBBS Algorithm ‣ 3 Approach ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">3</span></a>) is substituted with <math alttext="\frac{1}{K}\sum_{k}p_{k}(\mathbf{y}|\mathbf{x})" class="ltx_Math" display="inline" id="S4.SS3.p8.2.m2.1"><semantics id="S4.SS3.p8.2.m2.1a"><mrow id="S4.SS3.p8.2.m2.1.1" xref="S4.SS3.p8.2.m2.1.1.cmml"><mfrac id="S4.SS3.p8.2.m2.1.1.3" xref="S4.SS3.p8.2.m2.1.1.3.cmml"><mn id="S4.SS3.p8.2.m2.1.1.3.2" xref="S4.SS3.p8.2.m2.1.1.3.2.cmml">1</mn><mi id="S4.SS3.p8.2.m2.1.1.3.3" xref="S4.SS3.p8.2.m2.1.1.3.3.cmml">K</mi></mfrac><mo id="S4.SS3.p8.2.m2.1.1.2" xref="S4.SS3.p8.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p8.2.m2.1.1.1" xref="S4.SS3.p8.2.m2.1.1.1.cmml"><msub id="S4.SS3.p8.2.m2.1.1.1.2" xref="S4.SS3.p8.2.m2.1.1.1.2.cmml"><mo id="S4.SS3.p8.2.m2.1.1.1.2.2" xref="S4.SS3.p8.2.m2.1.1.1.2.2.cmml">∑</mo><mi id="S4.SS3.p8.2.m2.1.1.1.2.3" xref="S4.SS3.p8.2.m2.1.1.1.2.3.cmml">k</mi></msub><mrow id="S4.SS3.p8.2.m2.1.1.1.1" xref="S4.SS3.p8.2.m2.1.1.1.1.cmml"><msub id="S4.SS3.p8.2.m2.1.1.1.1.3" xref="S4.SS3.p8.2.m2.1.1.1.1.3.cmml"><mi id="S4.SS3.p8.2.m2.1.1.1.1.3.2" xref="S4.SS3.p8.2.m2.1.1.1.1.3.2.cmml">p</mi><mi id="S4.SS3.p8.2.m2.1.1.1.1.3.3" xref="S4.SS3.p8.2.m2.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S4.SS3.p8.2.m2.1.1.1.1.2" xref="S4.SS3.p8.2.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p8.2.m2.1.1.1.1.1.1" xref="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.cmml"><mo id="S4.SS3.p8.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p8.2.m2.1.1.1.1.1.1.1" xref="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.2" xref="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.2.cmml">𝐲</mi><mo fence="false" id="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.1" xref="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.3" xref="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S4.SS3.p8.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.2.m2.1b"><apply id="S4.SS3.p8.2.m2.1.1.cmml" xref="S4.SS3.p8.2.m2.1.1"><times id="S4.SS3.p8.2.m2.1.1.2.cmml" xref="S4.SS3.p8.2.m2.1.1.2"></times><apply id="S4.SS3.p8.2.m2.1.1.3.cmml" xref="S4.SS3.p8.2.m2.1.1.3"><divide id="S4.SS3.p8.2.m2.1.1.3.1.cmml" xref="S4.SS3.p8.2.m2.1.1.3"></divide><cn id="S4.SS3.p8.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS3.p8.2.m2.1.1.3.2">1</cn><ci id="S4.SS3.p8.2.m2.1.1.3.3.cmml" xref="S4.SS3.p8.2.m2.1.1.3.3">𝐾</ci></apply><apply id="S4.SS3.p8.2.m2.1.1.1.cmml" xref="S4.SS3.p8.2.m2.1.1.1"><apply id="S4.SS3.p8.2.m2.1.1.1.2.cmml" xref="S4.SS3.p8.2.m2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p8.2.m2.1.1.1.2.1.cmml" xref="S4.SS3.p8.2.m2.1.1.1.2">subscript</csymbol><sum id="S4.SS3.p8.2.m2.1.1.1.2.2.cmml" xref="S4.SS3.p8.2.m2.1.1.1.2.2"></sum><ci id="S4.SS3.p8.2.m2.1.1.1.2.3.cmml" xref="S4.SS3.p8.2.m2.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS3.p8.2.m2.1.1.1.1.cmml" xref="S4.SS3.p8.2.m2.1.1.1.1"><times id="S4.SS3.p8.2.m2.1.1.1.1.2.cmml" xref="S4.SS3.p8.2.m2.1.1.1.1.2"></times><apply id="S4.SS3.p8.2.m2.1.1.1.1.3.cmml" xref="S4.SS3.p8.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p8.2.m2.1.1.1.1.3.1.cmml" xref="S4.SS3.p8.2.m2.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p8.2.m2.1.1.1.1.3.2.cmml" xref="S4.SS3.p8.2.m2.1.1.1.1.3.2">𝑝</ci><ci id="S4.SS3.p8.2.m2.1.1.1.1.3.3.cmml" xref="S4.SS3.p8.2.m2.1.1.1.1.3.3">𝑘</ci></apply><apply id="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p8.2.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.2">𝐲</ci><ci id="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p8.2.m2.1.1.1.1.1.1.1.3">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.2.m2.1c">\frac{1}{K}\sum_{k}p_{k}(\mathbf{y}|\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p8.2.m2.1d">divide start_ARG 1 end_ARG start_ARG italic_K end_ARG ∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( bold_y | bold_x )</annotation></semantics></math>.
As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.T3" title="Table 3 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">3</span></a>, EBBS with total-sum voting performs worse than direct translation, suggesting the importance of ignoring the components whose lower-level beam does not contain the candidate. This is analogous to nucleus sampling <cite class="ltx_cite ltx_citemacro_cite">Holtzman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib22" title="">2019</a>)</cite>, where the long tail of a distribution is mainly noise and should be ignored.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p9">
<p class="ltx_p" id="S4.SS3.p9.1">Other voting schemes that EBBS may use include 0/1 voting and max voting.
The former selects the candidates that appear most in the lower-level beams, disregarding the probability values (unless for ties);
the latter chooses the maximum probability across the lower-level beams, which gives preference to sequences through a maximization bias <cite class="ltx_cite ltx_citemacro_citep">(Hasselt, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib18" title="">2010</a>; van Hasselt et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib48" title="">2016</a>)</cite>.
As seen in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.T3" title="Table 3 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">3</span></a>, EBBS performs relatively well with both of these voting schemes, achieving a decent improvement over the baseline approach;
however, their performance is consistently worse than our sum voting scheme.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p10">
<p class="ltx_p" id="S4.SS3.p10.1">Overall, our bi-level beam search ensemble is effective with different voting schemes (except for the total-sum voting), and our sum voting works the best among these variants.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.1" style="width:216.8pt;height:172.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-16.3pt,12.9pt) scale(0.869460287412418,0.869460287412418) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.1.1.1.1.1">Method</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1.2">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1.3">BLEU1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1.4">BLEU2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1.5">BLEU3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.1.1.1.6">BLEU4</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.1.1.2.2.1">Direct</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.1.1.2.2.2">25.33</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.1.1.2.2.3">56.32</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.1.1.2.2.4">30.08</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.1.1.2.2.5">19.01</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T4.1.1.2.2.6">12.78</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T4.1.1.3.3.1">Pivoting (en)</th>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.3.3.2">25.08</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.3.3.3">56.76</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.3.3.4">30.29</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.3.3.5">19.06</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T4.1.1.3.3.6">12.66</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T4.1.1.4.4.1">Pivoting (es)</th>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.4.4.2">24.40</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.4.4.3">55.38</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.4.4.4">29.08</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.4.4.5">18.22</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T4.1.1.4.4.6">12.09</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T4.1.1.5.5.1">Pivoting (pt)</th>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.5.5.2">24.34</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.5.5.3">55.46</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.5.5.4">29.02</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.5.5.5">18.13</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T4.1.1.5.5.6">12.02</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T4.1.1.6.6.1">Pivoting (fr)</th>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.6.6.2">24.20</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.6.6.3">55.41</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.6.6.4">29.02</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.6.6.5">18.00</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T4.1.1.6.6.6">11.84</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T4.1.1.7.7.1">Pivoting (de)</th>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.7.7.2">23.65</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.7.7.3">55.33</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.7.7.4">28.69</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.7.7.5">17.67</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T4.1.1.7.7.6">11.54</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T4.1.1.8.8.1">Pivoting (da)</th>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.8.8.2">23.12</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.8.8.3">54.81</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.8.8.4">27.96</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.8.8.5">17.12</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T4.1.1.8.8.6">11.12</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S4.T4.1.1.9.9.1">Pivoting (fi)</th>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.9.9.2">20.74</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.9.9.3">53.54</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.9.9.4">26.10</td>
<td class="ltx_td ltx_align_right" id="S4.T4.1.1.9.9.5">15.43</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T4.1.1.9.9.6">9.79</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S4.T4.1.1.10.10.1">All ensemble</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.1.1.10.10.2">
<span class="ltx_ERROR undefined" id="S4.T4.1.1.10.10.2.1">\ul</span>25.94</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.1.1.10.10.3">
<span class="ltx_ERROR undefined" id="S4.T4.1.1.10.10.3.1">\ul</span>57.04</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.1.1.10.10.4">
<span class="ltx_ERROR undefined" id="S4.T4.1.1.10.10.4.1">\ul</span>30.85</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.1.1.10.10.5">
<span class="ltx_ERROR undefined" id="S4.T4.1.1.10.10.5.1">\ul</span>19.61</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T4.1.1.10.10.6">
<span class="ltx_ERROR undefined" id="S4.T4.1.1.10.10.6.1">\ul</span>13.18</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="S4.T4.1.1.11.11.1">Top-3 ensemble</th>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T4.1.1.11.11.2"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.11.11.2.1">26.10</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T4.1.1.11.11.3"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.11.11.3.1">57.07</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T4.1.1.11.11.4"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.11.11.4.1">31.00</span></td>
<td class="ltx_td ltx_align_right ltx_border_b" id="S4.T4.1.1.11.11.5"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.11.11.5.1">19.76</span></td>
<td class="ltx_td ltx_align_right ltx_border_b ltx_border_r" id="S4.T4.1.1.11.11.6"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.11.11.6.1">13.28</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>The performance of individuals and their ensembles for Italian-to-Dutch translation on Europarl.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p11">
<p class="ltx_p" id="S4.SS3.p11.2"><span class="ltx_text ltx_font_bold" id="S4.SS3.p11.2.1">Analysis of ensemble components.</span> In Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.T4" title="Table 4 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">4</span></a>, we analyze our ensemble components to better understand our ensemble technique for zero-shot machine translation. As seen, direct translation is an effective approach, which is consistent with previous literature <cite class="ltx_cite ltx_citemacro_cite">Fan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib14" title="">2021</a>); Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite>. English pivoting achieves higher BLEU<math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p11.1.m1.1"><semantics id="S4.SS3.p11.1.m1.1a"><mi id="S4.SS3.p11.1.m1.1.1" xref="S4.SS3.p11.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p11.1.m1.1b"><ci id="S4.SS3.p11.1.m1.1.1.cmml" xref="S4.SS3.p11.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p11.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p11.1.m1.1d">italic_n</annotation></semantics></math> scores for some <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p11.2.m2.1"><semantics id="S4.SS3.p11.2.m2.1a"><mi id="S4.SS3.p11.2.m2.1.1" xref="S4.SS3.p11.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p11.2.m2.1b"><ci id="S4.SS3.p11.2.m2.1.1.cmml" xref="S4.SS3.p11.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p11.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p11.2.m2.1d">italic_n</annotation></semantics></math> but lower for others; its overall BLEU is slightly worse than direct translation in our experiment, as it has the error accumulation problem. Pivoting through non-English languages degrades the performance to a large extent because lacking supervision along the pivoting path leads to two steps of zero-shot translation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p12">
<p class="ltx_p" id="S4.SS3.p12.1">Notably, EBBS can achieve a solid improvement (~0.6 BLEU points) over the baseline despite including weak ensemble components (e.g., Finnish pivoting, which is almost 5 BLEU points lower than direct translation).
If we limit the ensemble components to the strong ones (top-3), EBBS can achieve an even higher improvement of ~0.8 BLEU points.
This analysis highlights the robustness of our EBBS algorithm.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="139" id="S4.F2.g1" src="extracted/5441316/assets/ensemble-scaling.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Analysis of the number of ensemble components for Italian-to-Dutch translation on Europarl.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p13">
<p class="ltx_p" id="S4.SS3.p13.1">We further study how EBBS performs with different numbers of ensemble components.
Specifically, we analyze two incremental ensemble settings: best-to-worst and worst-to-best. In both cases, we start with direct translation; then we incrementally add the next “best” or “worst” pivot translation according to Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.T4" title="Table 4 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p14">
<p class="ltx_p" id="S4.SS3.p14.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.F2" title="Figure 2 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a> shows the trends of incremental ensembles. If we add best pivot directions, the performance peaks at three ensemble components; interestingly, the inclusion of weaker components does not affect EBBS much.
On the other hand, adding the worst pivot translation leads to an immediate drop of 1.6 BLEU points, which then largely recovers with the second pivot.
This is reasonable because the worst pivot (Finnish) is 4.6 BLEU points lower than direct translation, and EBBS cannot decide on which of the two ensemble components to trust; despite this, the performance of EBBS is still much better than the average performance of the components.
With a second pivot, it gives a third “opinion” when the first two components “disagree.”
The performance continues to rise if more and stronger components are added.
In fact, our ensemble even surpasses the baseline with 4 weakest pivot translations, each of which is at least 1 BLEU point lower than the baseline. This demonstrates that EBBS is flexible and works well with both strong and weak ensemble components.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p15">
<p class="ltx_p" id="S4.SS3.p15.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p15.1.1">Distillation results.</span> We apply distillation techniques to our ensemble outputs to speed up inference. We follow the same ensemble setting (three components) as in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.T1" title="Table 1 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a>, but only focus on Italian-to-Dutch translation because generating the training samples for all 66 zero-shot directions (each containing more than 100K samples) requires significant computing resources.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p16">
<p class="ltx_p" id="S4.SS3.p16.1">We compare our EBBS-based distillation with two alternatives. A straightforward way to distill from multiple teachers (here, translation paths) is to take the union of teachers’ outputs for training. We also include self-distillation, which does not utilize different translation paths but generates samples by standard beam search for self-training.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p17">
<p class="ltx_p" id="S4.SS3.p17.1">As seen in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.T5" title="Table 5 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">5</span></a>, self-distillation improves zero-shot translation on both IWSLT and Europarl.
This is because the base model has never learned from parallel data between Italian and Dutch, and the self-distillation process enables the multilingual model to further refine its translation capabilities in this zero-shot direction. Similarly, we observe that union distillation also improves performance to some degree, but it is not better than self-distillation.
This is consistent with the challenges of one-to-many learning seen in previous work <cite class="ltx_cite ltx_citemacro_citep">(Wen et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib53" title="">2023a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib54" title="">b</a>)</cite>. In our case, learning from the outputs of multiple teachers in a straightforward manner may confuse the student, failing to consolidate and transfer the teachers’ knowledge.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p18">
<p class="ltx_p" id="S4.SS3.p18.1">In comparison, EBBS-based distillation consistently outperforms both self-distillation and union distillation, achieving near-EBBS performance on Europarl. For IWSLT, our model even outperforms EBBS, as IWSLT is a small dataset and the high-quality outputs generated by EBBS can largely improve the base model (no distillation) by 2.7 points.</p>
</div>
<figure class="ltx_table" id="S4.T5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T5.1" style="width:216.8pt;height:163.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-23.2pt,17.4pt) scale(0.823935596815561,0.823935596815561) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T5.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.1.1.1.1">
<td class="ltx_td ltx_border_l ltx_border_r ltx_border_t" id="S4.T5.1.1.1.1.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T5.1.1.1.1.2">Method</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.1.3">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.1.4">BLEU1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.1.5">BLEU2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.1.1.6">BLEU3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.1.1.1.7">BLEU4</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T5.1.1.2.2.1" rowspan="5"><span class="ltx_text" id="S4.T5.1.1.2.2.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T5.1.1.2.2.1.1.1" style="width:6.8pt;height:32.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:32.1pt;transform:translate(-12.63pt,-12.63pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T5.1.1.2.2.1.1.1.1">IWSLT</span>
</span></span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" colspan="2" id="S4.T5.1.1.2.2.2">EBBS</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.2.2.3">19.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.2.2.4">51.87</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.2.2.5">25.12</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.2.2.6">13.88</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.1.2.2.7">8.02</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T5.1.1.3.3.1" rowspan="4">
<span class="ltx_text" id="S4.T5.1.1.3.3.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T5.1.1.3.3.1.1.1">
<span class="ltx_tr" id="S4.T5.1.1.3.3.1.1.1.1">
<span class="ltx_td ltx_align_left" id="S4.T5.1.1.3.3.1.1.1.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T5.1.1.3.3.1.1.1.1.1.1" style="width:6.8pt;height:27.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:27.1pt;transform:translate(-10.14pt,-10.14pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T5.1.1.3.3.1.1.1.1.1.1.1">Direct</span>
</span></span></span></span>
</span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T5.1.1.3.3.2">No distillation</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.3.3.3">17.46</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.3.3.4">
<span class="ltx_ERROR undefined" id="S4.T5.1.1.3.3.4.1">\ul</span>50.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.3.3.5">23.01</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.3.3.6">12.01</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.1.3.3.7">6.66</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.1.1.4.4.1">Self-distillation</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.4.4.2">
<span class="ltx_ERROR undefined" id="S4.T5.1.1.4.4.2.1">\ul</span>18.10</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.4.4.3">50.37</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.4.4.4">
<span class="ltx_ERROR undefined" id="S4.T5.1.1.4.4.4.1">\ul</span>23.53</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.4.4.5">
<span class="ltx_ERROR undefined" id="S4.T5.1.1.4.4.5.1">\ul</span>12.63</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.1.4.4.6">
<span class="ltx_ERROR undefined" id="S4.T5.1.1.4.4.6.1">\ul</span>7.17</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.1.1.5.5.1">Union distillation</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.2">17.80</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.3">49.21</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.4">23.01</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.5.5.5">12.51</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.1.5.5.6">7.10</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.1.1.6.6.1">EBBS distillation</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.6.6.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.6.6.2.1">20.13</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.6.6.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.6.6.3.1">53.20</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.6.6.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.6.6.4.1">26.06</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.6.6.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.6.6.5.1">14.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.1.6.6.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.6.6.6.1">8.26</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_tt" id="S4.T5.1.1.7.7.1" rowspan="5"><span class="ltx_text" id="S4.T5.1.1.7.7.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T5.1.1.7.7.1.1.1" style="width:8.9pt;height:38.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:38.5pt;transform:translate(-14.82pt,-13.85pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T5.1.1.7.7.1.1.1.1">Europarl</span>
</span></span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" colspan="2" id="S4.T5.1.1.7.7.2">EBBS</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.1.7.7.3">26.10</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.1.7.7.4">57.07</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.1.7.7.5">31.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.1.7.7.6">19.76</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T5.1.1.7.7.7">13.28</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.8.8">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="S4.T5.1.1.8.8.1" rowspan="4">
<span class="ltx_text" id="S4.T5.1.1.8.8.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T5.1.1.8.8.1.1.1">
<span class="ltx_tr" id="S4.T5.1.1.8.8.1.1.1.1">
<span class="ltx_td ltx_align_left" id="S4.T5.1.1.8.8.1.1.1.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="S4.T5.1.1.8.8.1.1.1.1.1.1" style="width:6.8pt;height:27.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:27.1pt;transform:translate(-10.14pt,-10.14pt) rotate(-90deg) ;">
<span class="ltx_p" id="S4.T5.1.1.8.8.1.1.1.1.1.1.1">Direct</span>
</span></span></span></span>
</span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T5.1.1.8.8.2">No distillation</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.8.8.3">25.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.8.8.4">56.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.8.8.5">30.08</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.1.8.8.6">19.01</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.1.1.8.8.7">12.78</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.9.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.1.1.9.9.1">Self-distillation</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.9.9.2">25.44</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.9.9.3">56.54</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.9.9.4">30.28</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.9.9.5">19.13</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.1.9.9.6">12.79</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.10.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T5.1.1.10.10.1">Union distillation</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.10.10.2">
<span class="ltx_ERROR undefined" id="S4.T5.1.1.10.10.2.1">\ul</span>25.53</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.10.10.3">
<span class="ltx_ERROR undefined" id="S4.T5.1.1.10.10.3.1">\ul</span>56.58</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.10.10.4">
<span class="ltx_ERROR undefined" id="S4.T5.1.1.10.10.4.1">\ul</span>30.34</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.1.10.10.5">
<span class="ltx_ERROR undefined" id="S4.T5.1.1.10.10.5.1">\ul</span>19.18</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.1.1.10.10.6">
<span class="ltx_ERROR undefined" id="S4.T5.1.1.10.10.6.1">\ul</span>12.91</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.1.11.11">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S4.T5.1.1.11.11.1">EBBS distillation</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.1.1.11.11.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.11.11.2.1">25.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.1.1.11.11.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.11.11.3.1">56.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.1.1.11.11.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.11.11.4.1">30.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T5.1.1.11.11.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.11.11.5.1">19.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T5.1.1.11.11.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.11.11.6.1">13.24</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Comparison of various distillation methods for Italian-to-Dutch translation.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p19">
<p class="ltx_p" id="S4.SS3.p19.1">We provide an efficiency analysis in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A4" title="Appendix D Analysis of Inference Efficiency ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">D</span></a>, showing that the inference time of EBBS is linear to the number of ensemble components. Overall, our EBBS-based distillation achieves a significant speed up while maintaining, or even improving, translation quality.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p20">
<p class="ltx_p" id="S4.SS3.p20.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p20.1.1">Additional results.</span> We show additional results in the appendices.
<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A3" title="Appendix C Analysis of Beam Size ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">C</span></a>: Analysis of beam size, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A4" title="Appendix D Analysis of Inference Efficiency ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">D</span></a>: Analysis of inference efficiency, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A5" title="Appendix E Entropy of Distilled Models ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">E</span></a>: Entropy of distilled models, and <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A6" title="Appendix F Case Study ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">F</span></a>: Case study.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this work, we address ensemble-based zero-shot machine translation by directly translating and pivoting through different languages. We further design a novel bi-level beam search algorithm (called EBBS) for decoding. We evaluated EBBS on two popular zero-shot translation datasets, IWSLT and Europarl.
Results show that EBBS outperforms existing ensemble techniques, and that the high-quality translations produced by EBBS can be used for distillation to improve translation efficiency (and sometimes also quality over EBBS).</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Limitations</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">Our work features both algorithmic design and empirical effectiveness, but may also have limitations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">First, our work focuses on zero-shot translation, due to the background of our project. Nevertheless, the EBBS algorithm that we have developed is a general decoding method and is potentially applicable to various text generation tasks. We are happy to explore this direction as future work, such as building ensembles of large language models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">Second, our distillation experiments were conducted on Italian-to-Dutch translation because it appears in both IWSLT and Europarl datasets. We are unable to perform all-direction distillation in this project, because Europarl, say, has 56 zero-shot directions, and distillation techniques require extensive computing resources to generate pseudo-groundtruth sentences. Nevertheless, our distillation results are consistent on both datasets, and therefore, not including all-direction distillation does not hurt the validity of our method. Moreover, our work points to interesting future work, such as iteratively applying our ensemble-then-distill procedure to build a self-improving multilingual machine translation system.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p4">
<p class="ltx_p" id="S6.p4.1">Third, we have mainly used BLEU (in particular, SacreBLEU) scores to evaluate translation quality, which is standard in multilingual translation research <cite class="ltx_cite ltx_citemacro_cite">Johnson et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib23" title="">2017</a>); Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>); Fan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib14" title="">2021</a>)</cite>. We are aware of language model-based scores, such as BERTScore <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib64" title="">2019</a>)</cite>, for evaluating the translation in certain languages, but they may not be appropriate for low-resource languages and are not commonly used in our setting. We have not performed human evaluation either, due to both practical and ethical concerns.
Practically, it is difficult to find qualified annotators because our multilingual setting requires an annotator to know a large number of languages in addition to English. Ethically, it is inappropriate to ask annotators to study these languages before or during annotation, which is exhausting and may last for extended periods of time. That being said, our work uses the most standard metrics and results are consistent in most BLEU variants on both datasets, with a strong statistical confidence level based on 62 translation directions.
In addition, we have provided case studies to further illustrate how our EBBS works.
Therefore, we deem our evaluation ethical, appropriate, and adequate.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgment</h2>
<div class="ltx_para ltx_noindent" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">The research is supported in part by the Natural Sciences and Engineering Research Council of Canada (NSERC), a Mitacs Accelerate project, the Amii Fellow Program, the Canada CIFAR AI Chair Program, an Alberta Innovates Program, and the Digital Research Alliance of Canada (alliancecan.ca).
In the title, we used the open-domain artwork “The Great Wave off Kanagawa” by Katsushika Hokusai.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Babych et al. (2007)</span>
<span class="ltx_bibblock">
Bogdan Babych, Anthony Hartley, and Serge Sharoff.

</span>
<span class="ltx_bibblock">Translating from under-resourced languages: comparing direct transfer against pivot translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of Machine Translation Summit</em>, 2007.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2007.mtsummit-papers.5" title="">https://aclanthology.org/2007.mtsummit-papers.5</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bahdanau et al. (2015)</span>
<span class="ltx_bibblock">
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Neural machine translation by jointly learning to align and translate.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">International Conference on Learning Representations</em>, 2015.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1409.0473" title="">https://arxiv.org/abs/1409.0473</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Baziotis et al. (2022)</span>
<span class="ltx_bibblock">
Christos Baziotis, Mikel Artetxe, James Cross, and Shruti Bhosale.

</span>
<span class="ltx_bibblock">Multilingual machine translation with hyper-adapters.

</span>
<span class="ltx_bibblock">In Yoav Goldberg, Zornitsa Kozareva, and Yue Zhang, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the Conference on Empirical Methods in Natural Language Processing</em>, pages 1170–1185, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2022.emnlp-main.77" title="">https://aclanthology.org/2022.emnlp-main.77</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bickel and Doksum (2015)</span>
<span class="ltx_bibblock">
Peter J Bickel and Kjell A Doksum.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Mathematical Statistics: Basic Ideas and Selected Topics</em>.

</span>
<span class="ltx_bibblock">CRC Press, 2015.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://bickel.stat.berkeley.edu/teaching" title="">https://bickel.stat.berkeley.edu/teaching</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Breiman (1996)</span>
<span class="ltx_bibblock">
Leo Breiman.

</span>
<span class="ltx_bibblock">Bagging predictors.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Machine Learning</em>, 24:123–140, 1996.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://link.springer.com/article/10.1007/BF00058655" title="">https://link.springer.com/article/10.1007/BF00058655</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (1990)</span>
<span class="ltx_bibblock">
Peter F. Brown, John Cocke, Stephen A. Della Pietra, Vincent J. Della Pietra, Fredrick Jelinek, John D. Lafferty, Robert L. Mercer, and Paul S. Roossin.

</span>
<span class="ltx_bibblock">A statistical approach to machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Computational Linguistics</em>, 16(2):79–85, 1990.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/J90-2002" title="">https://aclanthology.org/J90-2002</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bühlmann and Yu (2002)</span>
<span class="ltx_bibblock">
Peter Bühlmann and Bin Yu.

</span>
<span class="ltx_bibblock">Analyzing bagging.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">The Annals of Statistics</em>, 30(4):927–961, 2002.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.jstor.org/stable/1558692?seq=1&amp;cid=pdf-reference" title="">https://www.jstor.org/stable/1558692?seq=1&amp;cid=pdf-reference</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cettolo et al. (2017)</span>
<span class="ltx_bibblock">
Mauro Cettolo, Marcello Federico, Luisa Bentivogli, Jan Niehues, Sebastian Stüker, Katsuhito Sudoh, Koichiro Yoshino, and Christian Federmann.

</span>
<span class="ltx_bibblock">Overview of the IWSLT 2017 evaluation campaign.

</span>
<span class="ltx_bibblock">In Sakriani Sakti and Masao Utiyama, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the International Conference on Spoken Language Translation</em>, page 2–14, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2017.iwslt-1.1" title="">https://aclanthology.org/2017.iwslt-1.1</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chronopoulou et al. (2023)</span>
<span class="ltx_bibblock">
Alexandra Chronopoulou, Dario Stojanovski, and Alexander Fraser.

</span>
<span class="ltx_bibblock">Language-family adapters for low-resource multilingual neural machine translation.

</span>
<span class="ltx_bibblock">In Atul Kr. Ojha, Chao-hong Liu, Ekaterina Vylomova, Flammie Pirinen, Jade Abbott, Jonathan Washington, Nathaniel Oco, Valentin Malykh, Varvara Logacheva, and Xiaobing Zhao, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the the Workshop on Technologies for Machine Translation of Low-Resource Languages</em>, pages 59–72, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.loresmt-1.5" title="">https://aclanthology.org/2023.loresmt-1.5</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dabre and Kurohashi (2017)</span>
<span class="ltx_bibblock">
Raj Dabre and Sadao Kurohashi.

</span>
<span class="ltx_bibblock">MMCR4NLP: Multilingual multiway corpora repository for natural language processing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:1710.01025</em>, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1710.01025" title="">http://arxiv.org/abs/1710.01025</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dabre et al. (2020)</span>
<span class="ltx_bibblock">
Raj Dabre, Chenhui Chu, and Anoop Kunchukuttan.

</span>
<span class="ltx_bibblock">A survey of multilingual neural machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">ACM Computing Surveys</em>, 53(5), 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3406095" title="">https://doi.org/10.1145/3406095</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al. (2020)</span>
<span class="ltx_bibblock">
Xibin Dong, Zhiwen Yu, Wenming Cao, Yifan Shi, and Qianli Ma.

</span>
<span class="ltx_bibblock">A survey on ensemble learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Frontiers of Computer Science</em>, 14:241–258, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://link.springer.com/article/10.1007/s11704-019-8208-z" title="">https://link.springer.com/article/10.1007/s11704-019-8208-z</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Eikema and Aziz (2020)</span>
<span class="ltx_bibblock">
Bryan Eikema and Wilker Aziz.

</span>
<span class="ltx_bibblock">Is MAP decoding all you need? The inadequacy of the mode in neural machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the International Conference on Computational Linguistics</em>, pages 4506–4520, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2020.coling-main.398" title="">https://aclanthology.org/2020.coling-main.398</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al. (2021)</span>
<span class="ltx_bibblock">
Angela Fan, Shruti Bhosale, Holger Schwenk, Zhiyi Ma, Ahmed El-Kishky, Siddharth Goyal, Mandeep Baines, Onur Celebi, Guillaume Wenzek, Vishrav Chaudhary, Naman Goyal, Tom Birch, Vitaliy Liptchinsky, Sergey Edunov, Michael Auli, and Armand Joulin.

</span>
<span class="ltx_bibblock">Beyond English-centric multilingual machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Journal of Machine Learning Research</em>, 22(107):1–48, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://jmlr.org/papers/v22/20-1307.html" title="">http://jmlr.org/papers/v22/20-1307.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Freitag et al. (2017)</span>
<span class="ltx_bibblock">
Markus Freitag, Yaser Al-Onaizan, and Baskaran Sankaran.

</span>
<span class="ltx_bibblock">Ensemble distillation for neural machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:1702.01802</em>, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1702.01802" title="">http://arxiv.org/abs/1702.01802</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ganaie et al. (2022)</span>
<span class="ltx_bibblock">
M.A. Ganaie, Minghui Hu, A.K. Malik, M. Tanveer, and P.N. Suganthan.

</span>
<span class="ltx_bibblock">Ensemble deep learning: A review.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Engineering Applications of Artificial Intelligence</em>, 115:105151, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S095219762200269X" title="">https://www.sciencedirect.com/science/article/pii/S095219762200269X</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2019)</span>
<span class="ltx_bibblock">
Jiatao Gu, Yong Wang, Kyunghyun Cho, and Victor O.K. Li.

</span>
<span class="ltx_bibblock">Improved zero-shot neural machine translation via ignoring spurious correlations.

</span>
<span class="ltx_bibblock">In Anna Korhonen, David Traum, and Lluís Màrquez, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics</em>, pages 1258–1268, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/P19-1121" title="">https://aclanthology.org/P19-1121</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hasselt (2010)</span>
<span class="ltx_bibblock">
Hado Hasselt.

</span>
<span class="ltx_bibblock">Double q-learning.

</span>
<span class="ltx_bibblock">In J. Lafferty, C. Williams, J. Shawe-Taylor, R. Zemel, and A. Culotta, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Advances in Neural Information Processing Systems</em>, 2010.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2010/file/091d584fced301b442654dd8c23b3fc9-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2010/file/091d584fced301b442654dd8c23b3fc9-Paper.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hastie et al. (2009)</span>
<span class="ltx_bibblock">
Trevor Hastie, Saharon Rosset, Ji Zhu, and Hui Zou.

</span>
<span class="ltx_bibblock">Multi-class AdaBoost.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Statistics and its Interface</em>, 2(3):349–360, 2009.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.intlpress.com/site/pub/pages/journals/items/sii/content/vols/0002/0003/a008/" title="">https://www.intlpress.com/site/pub/pages/journals/items/sii/content/vols/0002/0003/a008/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2023)</span>
<span class="ltx_bibblock">
Dan He, Minh-Quang Pham, Thanh-Le Ha, and Marco Turchi.

</span>
<span class="ltx_bibblock">Gradient-based gradual pruning for language-specific multilingual neural machine translation.

</span>
<span class="ltx_bibblock">In Houda Bouamor, Juan Pino, and Kalika Bali, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the Conference on Empirical Methods in Natural Language Processing</em>, pages 654–670, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.emnlp-main.43" title="">https://aclanthology.org/2023.emnlp-main.43</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendy et al. (2021)</span>
<span class="ltx_bibblock">
Amr Hendy, Esraa A. Gad, Mohamed Abdelghaffar, Jailan S. ElMosalami, Mohamed Afify, Ahmed Y. Tawfik, and Hany Hassan Awadalla.

</span>
<span class="ltx_bibblock">Ensembling of distilled models from multi-task teachers for constrained resource language pairs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the Conference on Machine Translation</em>, pages 130–135, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.wmt-1.8" title="">https://aclanthology.org/2021.wmt-1.8</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Holtzman et al. (2019)</span>
<span class="ltx_bibblock">
Ari Holtzman, Jan Buys, Li Du, Maxwell Forbes, and Yejin Choi.

</span>
<span class="ltx_bibblock">The curious case of neural text degeneration.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">International Conference on Learning Representations</em>, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=rygGQyrFvH" title="">https://openreview.net/forum?id=rygGQyrFvH</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. (2017)</span>
<span class="ltx_bibblock">
Melvin Johnson, Mike Schuster, Quoc V. Le, Maxim Krikun, Yonghui Wu, Zhifeng Chen, Nikhil Thorat, Fernanda Viégas, Martin Wattenberg, Greg Corrado, Macduff Hughes, and Jeffrey Dean.

</span>
<span class="ltx_bibblock">Google’s multilingual neural machine translation system: Enabling zero-shot translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Transactions of the Association for Computational Linguistics</em>, 5:339–351, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/Q17-1024" title="">https://aclanthology.org/Q17-1024</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim and Rush (2016)</span>
<span class="ltx_bibblock">
Yoon Kim and Alexander M. Rush.

</span>
<span class="ltx_bibblock">Sequence-level knowledge distillation.

</span>
<span class="ltx_bibblock">In Jian Su, Kevin Duh, and Xavier Carreras, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the Conference on Empirical Methods in Natural Language Processing</em>, pages 1317–1327, 2016.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/D16-1139" title="">https://aclanthology.org/D16-1139</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kobayashi (2018)</span>
<span class="ltx_bibblock">
Hayato Kobayashi.

</span>
<span class="ltx_bibblock">Frustratingly easy model ensemble for abstractive summarization.

</span>
<span class="ltx_bibblock">In Ellen Riloff, David Chiang, Julia Hockenmaier, and Jun’ichi Tsujii, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the Conference on Empirical Methods in Natural Language Processing</em>, pages 4165–4176, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/D18-1449" title="">https://aclanthology.org/D18-1449</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koehn (2005)</span>
<span class="ltx_bibblock">
Philipp Koehn.

</span>
<span class="ltx_bibblock">Europarl: A parallel corpus for statistical machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of Machine Translation Summit</em>, pages 79–86, 2005.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2005.mtsummit-papers.11" title="">https://aclanthology.org/2005.mtsummit-papers.11</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lample et al. (2018a)</span>
<span class="ltx_bibblock">
Guillaume Lample, Alexis Conneau, Ludovic Denoyer, and Marc’Aurelio Ranzato.

</span>
<span class="ltx_bibblock">Unsupervised machine translation using monolingual corpora only.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">International Conference on Learning Representations</em>, 2018a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=rkYTTf-AZ" title="">https://openreview.net/forum?id=rkYTTf-AZ</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lample et al. (2018b)</span>
<span class="ltx_bibblock">
Guillaume Lample, Myle Ott, Alexis Conneau, Ludovic Denoyer, and Marc’Aurelio Ranzato.

</span>
<span class="ltx_bibblock">Phrase-based &amp; neural unsupervised machine translation.

</span>
<span class="ltx_bibblock">In Ellen Riloff, David Chiang, Julia Hockenmaier, and Jun’ichi Tsujii, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the Conference on Empirical Methods in Natural Language Processing</em>, pages 5039–5049, 2018b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/D18-1549" title="">https://aclanthology.org/D18-1549</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2020)</span>
<span class="ltx_bibblock">
Mike Lewis, Yinhan Liu, Naman Goyal, Marjan Ghazvininejad, Abdelrahman Mohamed, Omer Levy, Veselin Stoyanov, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">BART: Denoising sequence-to-sequence pre-training for natural language generation, translation, and comprehension.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics</em>, pages 7871–7880, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2020.acl-main.703" title="">https://aclanthology.org/2020.acl-main.703</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Danni Liu, Jan Niehues, James Cross, Francisco Guzmán, and Xian Li.

</span>
<span class="ltx_bibblock">Improving zero-shot translation by disentangling positional information.

</span>
<span class="ltx_bibblock">In Chengqing Zong, Fei Xia, Wenjie Li, and Roberto Navigli, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics and the International Joint Conference on Natural Language Processing</em>, pages 1259–1273, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.acl-long.101" title="">https://aclanthology.org/2021.acl-long.101</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meister et al. (2020)</span>
<span class="ltx_bibblock">
Clara Meister, Ryan Cotterell, and Tim Vieira.

</span>
<span class="ltx_bibblock">If beam search is the answer, what was the question?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the Conference on Empirical Methods in Natural Language Processing</em>, pages 2173–2185, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2020.emnlp-main.170" title="">https://aclanthology.org/2020.emnlp-main.170</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohiuddin and Joty (2020)</span>
<span class="ltx_bibblock">
Tasnim Mohiuddin and Shafiq Joty.

</span>
<span class="ltx_bibblock">Unsupervised word translation with adversarial autoencoder.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Computational Linguistics</em>, 46(2):257–288, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2020.cl-2.2" title="">https://aclanthology.org/2020.cl-2.2</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Müller and Sennrich (2021)</span>
<span class="ltx_bibblock">
Mathias Müller and Rico Sennrich.

</span>
<span class="ltx_bibblock">Understanding the properties of minimum Bayes risk decoding in neural machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics and the International Joint Conference on Natural Language Processing</em>, pages 259–272, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.acl-long.22" title="">https://aclanthology.org/2021.acl-long.22</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Natekin and Knoll (2013)</span>
<span class="ltx_bibblock">
Alexey Natekin and Alois Knoll.

</span>
<span class="ltx_bibblock">Gradient boosting machines, a tutorial.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Frontiers in Neurorobotics</em>, 7:21, 2013.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.frontiersin.org/articles/10.3389/fnbot.2013.00021/full" title="">https://www.frontiersin.org/articles/10.3389/fnbot.2013.00021/full</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ott et al. (2019)</span>
<span class="ltx_bibblock">
Myle Ott, Sergey Edunov, Alexei Baevski, Angela Fan, Sam Gross, Nathan Ng, David Grangier, and Michael Auli.

</span>
<span class="ltx_bibblock">fairseq: A fast, extensible toolkit for sequence modeling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the Conference of the North American Chapter of the Association for Computational Linguistics</em>, pages 48–53, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/N19-4009" title="">https://aclanthology.org/N19-4009</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Papineni et al. (2002)</span>
<span class="ltx_bibblock">
Kishore Papineni, Salim Roukos, Todd Ward, and Wei-Jing Zhu.

</span>
<span class="ltx_bibblock">BLEU: A method for automatic evaluation of machine translation.

</span>
<span class="ltx_bibblock">In Pierre Isabelle, Eugene Charniak, and Dekang Lin, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics</em>, pages 311–318, 2002.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/P02-1040" title="">https://aclanthology.org/P02-1040</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Post (2018)</span>
<span class="ltx_bibblock">
Matt Post.

</span>
<span class="ltx_bibblock">A call for clarity in reporting BLEU scores.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the Conference on Machine Translation</em>, pages 186–191, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/W18-6319" title="">https://aclanthology.org/W18-6319</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2019)</span>
<span class="ltx_bibblock">
Alec Radford, Jeff Wu, Rewon Child, David Luan, Dario Amodei, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">OpenAI Blog</em>, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://cdn.openai.com/better-language-models/language_models_are_unsupervised_multitask_learners.pdf" title="">https://cdn.openai.com/better-language-models/language_models_are_unsupervised_multitask_learners.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al. (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text Transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Journal of Machine Learning Research</em>, 21(140):1–67, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://jmlr.org/papers/v21/20-074.html" title="">https://jmlr.org/papers/v21/20-074.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ranathunga et al. (2023)</span>
<span class="ltx_bibblock">
Surangika Ranathunga, En-Shiun Annie Lee, Marjana Prifti Skenduli, Ravi Shekhar, Mehreen Alam, and Rishemjit Kaur.

</span>
<span class="ltx_bibblock">Neural machine translation for low-resource languages: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">ACM Computing Survey</em>, 55(11), 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3567592" title="">https://doi.org/10.1145/3567592</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Scao et al. (2022)</span>
<span class="ltx_bibblock">
Teven Le Scao, Angela Fan, Christopher Akiki, Ellie Pavlick, Suzana Ilić, Daniel Hesslow, Roman Castagné, Alexandra Sasha Luccioni, François Yvon, et al.

</span>
<span class="ltx_bibblock">BLOOM: A 176B-parameter open-access multilingual language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2211.05100</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2211.05100" title="">https://arxiv.org/abs/2211.05100</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schapire (2003)</span>
<span class="ltx_bibblock">
Robert E Schapire.

</span>
<span class="ltx_bibblock">The boosting approach to machine learning: An overview.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Nonlinear Estimation and Classification</em>, pages 149–171, 2003.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://link.springer.com/chapter/10.1007/978-0-387-21579-2_9" title="">https://link.springer.com/chapter/10.1007/978-0-387-21579-2_9</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sennrich et al. (2016a)</span>
<span class="ltx_bibblock">
Rico Sennrich, Barry Haddow, and Alexandra Birch.

</span>
<span class="ltx_bibblock">Edinburgh neural machine translation systems for WMT 16.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the Conference on Machine Translation</em>, pages 371–376, 2016a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/W16-2323" title="">https://aclanthology.org/W16-2323</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sennrich et al. (2016b)</span>
<span class="ltx_bibblock">
Rico Sennrich, Barry Haddow, and Alexandra Birch.

</span>
<span class="ltx_bibblock">Neural machine translation of rare words with subword units.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics</em>, pages 1715–1725, 2016b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/P16-1162" title="">https://aclanthology.org/P16-1162</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shanbhogue et al. (2023)</span>
<span class="ltx_bibblock">
Akshaya Vishnu Kudlu Shanbhogue, Ran Xue, Soumya Saha, Daniel Zhang, and Ashwinkumar Ganesan.

</span>
<span class="ltx_bibblock">Improving low resource speech translation with data augmentation and ensemble strategies.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Proceedings of the International Conference on Spoken Language Translation</em>, pages 241–250, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.iwslt-1.21" title="">https://aclanthology.org/2023.iwslt-1.21</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shayegh et al. (2024)</span>
<span class="ltx_bibblock">
Behzad Shayegh, Yanshuai Cao, Xiaodan Zhu, Jackie CK Cheung, and Lili Mou.

</span>
<span class="ltx_bibblock">Ensemble distillation for unsupervised constituency parsing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">International Conference on Learning Representations</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=RR8y0WKrFv" title="">https://openreview.net/forum?id=RR8y0WKrFv</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vamvas and Sennrich (2022)</span>
<span class="ltx_bibblock">
Jannis Vamvas and Rico Sennrich.

</span>
<span class="ltx_bibblock">NMTScore: A multilingual analysis of translation-based text similarity measures.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Findings of the Association for Computational Linguistics: EMNLP</em>, pages 198–213, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2022.findings-emnlp.15" title="">https://aclanthology.org/2022.findings-emnlp.15</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van Hasselt et al. (2016)</span>
<span class="ltx_bibblock">
Hado van Hasselt, Arthur Guez, and David Silver.

</span>
<span class="ltx_bibblock">Deep reinforcement learning with double q-learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, pages 2094–2100, 2016.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://ojs.aaai.org/index.php/AAAI/article/view/10295" title="">https://ojs.aaai.org/index.php/AAAI/article/view/10295</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In I. Guyon, U. Von Luxburg, S. Bengio, H. Wallach, R. Fergus, S. Vishwanathan, and R. Garnett, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Advances in Neural Information Processing Systems</em>, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Zhang (2022)</span>
<span class="ltx_bibblock">
Qian Wang and Jiajun Zhang.

</span>
<span class="ltx_bibblock">Parameter differentiation based multilingual neural machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, pages 11440–11448, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://ojs.aaai.org/index.php/AAAI/article/view/21396" title="">https://ojs.aaai.org/index.php/AAAI/article/view/21396</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Zirui Wang, Zachary C. Lipton, and Yulia Tsvetkov.

</span>
<span class="ltx_bibblock">On negative interference in multilingual models: Findings and a meta-learning treatment.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Proceedings of the Conference on Empirical Methods in Natural Language Processing</em>, pages 4438–4450, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2020.emnlp-main.359" title="">https://aclanthology.org/2020.emnlp-main.359</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2019)</span>
<span class="ltx_bibblock">
Bolin Wei, Shuai Lu, Lili Mou, Hao Zhou, Pascal Poupart, Ge Li, and Zhi Jin.

</span>
<span class="ltx_bibblock">Why do neural dialog systems generate short and meaningless replies? A comparison between dialog and translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Proceedings of the International Conference on Acoustics, Speech and Signal Processing</em>, pages 7290–7294, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://ieeexplore.ieee.org/document/8682634" title="">https://ieeexplore.ieee.org/document/8682634</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wen et al. (2023a)</span>
<span class="ltx_bibblock">
Yuqiao Wen, Yongchang Hao, Yanshuai Cao, and Lili Mou.

</span>
<span class="ltx_bibblock">An equal-size hard EM algorithm for diverse dialogue generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">International Conference on Learning Representations</em>, 2023a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=k5PEHHY4spM" title="">https://openreview.net/forum?id=k5PEHHY4spM</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wen et al. (2023b)</span>
<span class="ltx_bibblock">
Yuqiao Wen, Zichao Li, Wenyu Du, and Lili Mou.

</span>
<span class="ltx_bibblock"><math alttext="f" class="ltx_Math" display="inline" id="bib.bib54.1.m1.1"><semantics id="bib.bib54.1.m1.1a"><mi id="bib.bib54.1.m1.1.1" xref="bib.bib54.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="bib.bib54.1.m1.1b"><ci id="bib.bib54.1.m1.1.1.cmml" xref="bib.bib54.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib54.1.m1.1c">f</annotation><annotation encoding="application/x-llamapun" id="bib.bib54.1.m1.1d">italic_f</annotation></semantics></math>-divergence minimization for sequence-level knowledge distillation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib54.2.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics</em>, pages 10817–10834, 2023b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.acl-long.605" title="">https://aclanthology.org/2023.acl-long.605</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wicks and Duh (2022)</span>
<span class="ltx_bibblock">
Rachel Wicks and Kevin Duh.

</span>
<span class="ltx_bibblock">The effects of language token prefixing for multilingual machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">Proceedings of the Conference of the Asia-Pacific Chapter of the Association for Computational Linguistics and the International Joint Conference on Natural Language Processing</em>, pages 148–153, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2022.aacl-short.19" title="">https://aclanthology.org/2022.aacl-short.19</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolf et al. (2019)</span>
<span class="ltx_bibblock">
Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric Cistac, Tim Rault, Rémi Louf, Morgan Funtowicz, et al.

</span>
<span class="ltx_bibblock">Huggingface’s Transformers: State-of-the-art natural language processing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">arXiv preprint arXiv:1910.03771</em>, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1910.03771" title="">https://arxiv.org/abs/1910.03771</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolpert (1992)</span>
<span class="ltx_bibblock">
David H. Wolpert.

</span>
<span class="ltx_bibblock">Stacked generalization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">Neural Networks</em>, 5(2):241–259, 1992.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S0893608005800231" title="">https://www.sciencedirect.com/science/article/pii/S0893608005800231</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2021)</span>
<span class="ltx_bibblock">
Chuhan Wu, Fangzhao Wu, and Yongfeng Huang.

</span>
<span class="ltx_bibblock">One teacher is enough? Pre-trained language model distillation from multiple teachers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">Findings of the Association for Computational Linguistics: ACL-IJCNLP</em>, pages 4408–4413, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.findings-acl.387" title="">https://aclanthology.org/2021.findings-acl.387</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu and Wang (2007)</span>
<span class="ltx_bibblock">
Hua Wu and Haifeng Wang.

</span>
<span class="ltx_bibblock">Pivot language approach for phrase-based statistical machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">Proceedings of the Annual Meeting of the Association of Computational Linguistics</em>, pages 856–863, 2007.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/P07-1108" title="">https://aclanthology.org/P07-1108</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu and Wang (2009)</span>
<span class="ltx_bibblock">
Hua Wu and Haifeng Wang.

</span>
<span class="ltx_bibblock">Revisiting pivot language approach for machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">Proceedings of the Joint Conference of the Annual Meeting of the ACL and the International Joint Conference on Natural Language Processing of the AFNLP</em>, pages 154–162, 2009.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/P09-1018" title="">https://aclanthology.org/P09-1018</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023)</span>
<span class="ltx_bibblock">
Yongquan Yang, Haijun Lv, and Ning Chen.

</span>
<span class="ltx_bibblock">A survey on ensemble learning under the era of deep learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">Artificial Intelligence Review</em>, 56(6):5545–5589, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://link.springer.com/article/10.1007/s10462-022-10283-5" title="">https://link.springer.com/article/10.1007/s10462-022-10283-5</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zaremoodi et al. (2018)</span>
<span class="ltx_bibblock">
Poorya Zaremoodi, Wray Buntine, and Gholamreza Haffari.

</span>
<span class="ltx_bibblock">Adaptive knowledge sharing in multi-task learning: Improving low-resource neural machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics</em>, pages 656–661, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/P18-2104" title="">https://aclanthology.org/P18-2104</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2020)</span>
<span class="ltx_bibblock">
Biao Zhang, Philip Williams, Ivan Titov, and Rico Sennrich.

</span>
<span class="ltx_bibblock">Improving massively multilingual neural machine translation and zero-shot translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">Proceedings of the Annual Meeting of the Association for Computational Linguistics</em>, pages 1628–1639, 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2020.acl-main.148" title="">https://aclanthology.org/2020.acl-main.148</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2019)</span>
<span class="ltx_bibblock">
Tianyi Zhang, Varsha Kishore, Felix Wu, Kilian Q Weinberger, and Yoav Artzi.

</span>
<span class="ltx_bibblock">BERTScore: Evaluating text generation with BERT.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">International Conference on Learning Representations</em>, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=SkeHuCVFDr" title="">https://openreview.net/forum?id=SkeHuCVFDr</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Beam Search</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.2">We show the standard beam search in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#alg2" title="2 ‣ Appendix A Beam Search ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a> for a comparison with our proposed EBBS.
In general, beam search takes a scorer <math alttext="p" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><mi id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">italic_p</annotation></semantics></math> as the input and approximately finds the highest-scored sequence, by expanding its search tree with all the vocabulary (Lines 6–9) but only keeping the top-<math alttext="Z" class="ltx_Math" display="inline" id="A1.p1.2.m2.1"><semantics id="A1.p1.2.m2.1a"><mi id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><ci id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">Z</annotation><annotation encoding="application/x-llamapun" id="A1.p1.2.m2.1d">italic_Z</annotation></semantics></math> partial candidates (Line 10) at each generation step.
Unlike EBBS, beam search is not specifically designed to work with multiple scorers, and we show in our main analysis that applying beam search with averaged probabilities of the ensemble components is not an ideal approach for ensemble decoding.</p>
</div>
<figure class="ltx_figure" id="A1.fig1">
<figure class="ltx_float ltx_minipage ltx_align_center ltx_align_middle" id="alg2" style="width:238.5pt;">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg2.21">
<div class="ltx_listingline" id="alg2.1.1"> <span class="ltx_text" id="alg2.1.1.1" style="color:#000000;"><span class="ltx_text ltx_font_bold" id="alg2.1.1.1.1">Input:</span> </span> <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="alg2.1.1.m1.1"><semantics id="alg2.1.1.m1.1a"><mi id="alg2.1.1.m1.1.1" xref="alg2.1.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="alg2.1.1.m1.1b"><ci id="alg2.1.1.m1.1.1.cmml" xref="alg2.1.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="alg2.1.1.m1.1d">bold_x</annotation></semantics></math>: input sentence  
</div>
<div class="ltx_listingline" id="alg2.2.2">        <math alttext="Z" class="ltx_Math" display="inline" id="alg2.2.2.m1.1"><semantics id="alg2.2.2.m1.1a"><mi id="alg2.2.2.m1.1.1" xref="alg2.2.2.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="alg2.2.2.m1.1b"><ci id="alg2.2.2.m1.1.1.cmml" xref="alg2.2.2.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="alg2.2.2.m1.1d">italic_Z</annotation></semantics></math>: beam size 
</div>
<div class="ltx_listingline" id="alg2.3.3">      <math alttext="p" class="ltx_Math" display="inline" id="alg2.3.3.m1.1"><semantics id="alg2.3.3.m1.1a"><mi id="alg2.3.3.m1.1.1" xref="alg2.3.3.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="alg2.3.3.m1.1b"><ci id="alg2.3.3.m1.1.1.cmml" xref="alg2.3.3.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.3.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="alg2.3.3.m1.1d">italic_p</annotation></semantics></math>: scorer 
</div>
<div class="ltx_listingline" id="alg2.5.5">
<span class="ltx_tag ltx_tag_listingline">1</span> <math alttext="H\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg2.4.4.m1.1"><semantics id="alg2.4.4.m1.1a"><mrow id="alg2.4.4.m1.1.1" xref="alg2.4.4.m1.1.1.cmml"><mi id="alg2.4.4.m1.1.1.2" xref="alg2.4.4.m1.1.1.2.cmml">H</mi><mo id="alg2.4.4.m1.1.1.1" stretchy="false" xref="alg2.4.4.m1.1.1.1.cmml">←</mo><mi id="alg2.4.4.m1.1.1.3" mathvariant="normal" xref="alg2.4.4.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.4.4.m1.1b"><apply id="alg2.4.4.m1.1.1.cmml" xref="alg2.4.4.m1.1.1"><ci id="alg2.4.4.m1.1.1.1.cmml" xref="alg2.4.4.m1.1.1.1">←</ci><ci id="alg2.4.4.m1.1.1.2.cmml" xref="alg2.4.4.m1.1.1.2">𝐻</ci><emptyset id="alg2.4.4.m1.1.1.3.cmml" xref="alg2.4.4.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.4.m1.1c">H\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg2.4.4.m1.1d">italic_H ← ∅</annotation></semantics></math> <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.5.5.m2.1"><semantics id="alg2.5.5.m2.1a"><mo id="alg2.5.5.m2.1.1" xref="alg2.5.5.m2.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.5.5.m2.1b"><ci id="alg2.5.5.m2.1.1.cmml" xref="alg2.5.5.m2.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.5.m2.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.5.5.m2.1d">▷</annotation></semantics></math> candidate outputs 
</div>
<div class="ltx_listingline" id="alg2.7.7">
<span class="ltx_tag ltx_tag_listingline">2</span> <math alttext="B_{0}\leftarrow\{\langle\textsc{bos},1\rangle\}" class="ltx_Math" display="inline" id="alg2.6.6.m1.3"><semantics id="alg2.6.6.m1.3a"><mrow id="alg2.6.6.m1.3.3" xref="alg2.6.6.m1.3.3.cmml"><msub id="alg2.6.6.m1.3.3.3" xref="alg2.6.6.m1.3.3.3.cmml"><mi id="alg2.6.6.m1.3.3.3.2" xref="alg2.6.6.m1.3.3.3.2.cmml">B</mi><mn id="alg2.6.6.m1.3.3.3.3" xref="alg2.6.6.m1.3.3.3.3.cmml">0</mn></msub><mo id="alg2.6.6.m1.3.3.2" stretchy="false" xref="alg2.6.6.m1.3.3.2.cmml">←</mo><mrow id="alg2.6.6.m1.3.3.1.1" xref="alg2.6.6.m1.3.3.1.2.cmml"><mo id="alg2.6.6.m1.3.3.1.1.2" stretchy="false" xref="alg2.6.6.m1.3.3.1.2.cmml">{</mo><mrow id="alg2.6.6.m1.3.3.1.1.1.2" xref="alg2.6.6.m1.3.3.1.1.1.1.cmml"><mo id="alg2.6.6.m1.3.3.1.1.1.2.1" stretchy="false" xref="alg2.6.6.m1.3.3.1.1.1.1.cmml">⟨</mo><mtext class="ltx_font_smallcaps" id="alg2.6.6.m1.1.1" mathvariant="normal" xref="alg2.6.6.m1.1.1a.cmml">bos</mtext><mo id="alg2.6.6.m1.3.3.1.1.1.2.2" xref="alg2.6.6.m1.3.3.1.1.1.1.cmml">,</mo><mn id="alg2.6.6.m1.2.2" xref="alg2.6.6.m1.2.2.cmml">1</mn><mo id="alg2.6.6.m1.3.3.1.1.1.2.3" stretchy="false" xref="alg2.6.6.m1.3.3.1.1.1.1.cmml">⟩</mo></mrow><mo id="alg2.6.6.m1.3.3.1.1.3" stretchy="false" xref="alg2.6.6.m1.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.6.6.m1.3b"><apply id="alg2.6.6.m1.3.3.cmml" xref="alg2.6.6.m1.3.3"><ci id="alg2.6.6.m1.3.3.2.cmml" xref="alg2.6.6.m1.3.3.2">←</ci><apply id="alg2.6.6.m1.3.3.3.cmml" xref="alg2.6.6.m1.3.3.3"><csymbol cd="ambiguous" id="alg2.6.6.m1.3.3.3.1.cmml" xref="alg2.6.6.m1.3.3.3">subscript</csymbol><ci id="alg2.6.6.m1.3.3.3.2.cmml" xref="alg2.6.6.m1.3.3.3.2">𝐵</ci><cn id="alg2.6.6.m1.3.3.3.3.cmml" type="integer" xref="alg2.6.6.m1.3.3.3.3">0</cn></apply><set id="alg2.6.6.m1.3.3.1.2.cmml" xref="alg2.6.6.m1.3.3.1.1"><list id="alg2.6.6.m1.3.3.1.1.1.1.cmml" xref="alg2.6.6.m1.3.3.1.1.1.2"><ci id="alg2.6.6.m1.1.1a.cmml" xref="alg2.6.6.m1.1.1"><mtext class="ltx_font_smallcaps" id="alg2.6.6.m1.1.1.cmml" mathvariant="normal" xref="alg2.6.6.m1.1.1">bos</mtext></ci><cn id="alg2.6.6.m1.2.2.cmml" type="integer" xref="alg2.6.6.m1.2.2">1</cn></list></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.6.m1.3c">B_{0}\leftarrow\{\langle\textsc{bos},1\rangle\}</annotation><annotation encoding="application/x-llamapun" id="alg2.6.6.m1.3d">italic_B start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ← { ⟨ bos , 1 ⟩ }</annotation></semantics></math> <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.7.7.m2.1"><semantics id="alg2.7.7.m2.1a"><mo id="alg2.7.7.m2.1.1" xref="alg2.7.7.m2.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.7.7.m2.1b"><ci id="alg2.7.7.m2.1.1.cmml" xref="alg2.7.7.m2.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.7.m2.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.7.7.m2.1d">▷</annotation></semantics></math> beam candidates 
</div>
<div class="ltx_listingline" id="alg2.8.8">
<span class="ltx_tag ltx_tag_listingline">3</span> <span class="ltx_text ltx_font_bold" id="alg2.8.8.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg2.8.8.1"><math alttext="t=1,2,\cdots" class="ltx_Math" display="inline" id="alg2.8.8.1.m1.3"><semantics id="alg2.8.8.1.m1.3a"><mrow id="alg2.8.8.1.m1.3.4" xref="alg2.8.8.1.m1.3.4.cmml"><mi id="alg2.8.8.1.m1.3.4.2" xref="alg2.8.8.1.m1.3.4.2.cmml">t</mi><mo id="alg2.8.8.1.m1.3.4.1" mathvariant="normal" xref="alg2.8.8.1.m1.3.4.1.cmml">=</mo><mrow id="alg2.8.8.1.m1.3.4.3.2" xref="alg2.8.8.1.m1.3.4.3.1.cmml"><mn id="alg2.8.8.1.m1.1.1" mathvariant="normal" xref="alg2.8.8.1.m1.1.1.cmml">1</mn><mo id="alg2.8.8.1.m1.3.4.3.2.1" mathvariant="normal" xref="alg2.8.8.1.m1.3.4.3.1.cmml">,</mo><mn id="alg2.8.8.1.m1.2.2" mathvariant="normal" xref="alg2.8.8.1.m1.2.2.cmml">2</mn><mo id="alg2.8.8.1.m1.3.4.3.2.2" mathvariant="normal" xref="alg2.8.8.1.m1.3.4.3.1.cmml">,</mo><mi id="alg2.8.8.1.m1.3.3" mathvariant="normal" xref="alg2.8.8.1.m1.3.3.cmml">⋯</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.8.8.1.m1.3b"><apply id="alg2.8.8.1.m1.3.4.cmml" xref="alg2.8.8.1.m1.3.4"><eq id="alg2.8.8.1.m1.3.4.1.cmml" xref="alg2.8.8.1.m1.3.4.1"></eq><ci id="alg2.8.8.1.m1.3.4.2.cmml" xref="alg2.8.8.1.m1.3.4.2">𝑡</ci><list id="alg2.8.8.1.m1.3.4.3.1.cmml" xref="alg2.8.8.1.m1.3.4.3.2"><cn id="alg2.8.8.1.m1.1.1.cmml" type="integer" xref="alg2.8.8.1.m1.1.1">1</cn><cn id="alg2.8.8.1.m1.2.2.cmml" type="integer" xref="alg2.8.8.1.m1.2.2">2</cn><ci id="alg2.8.8.1.m1.3.3.cmml" xref="alg2.8.8.1.m1.3.3">normal-⋯</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.8.1.m1.3c">t=1,2,\cdots</annotation><annotation encoding="application/x-llamapun" id="alg2.8.8.1.m1.3d">italic_t = 1 , 2 , ⋯</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.8.8.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.9.9">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.9.9.m1.1"><semantics id="alg2.9.9.m1.1a"><mo id="alg2.9.9.m1.1.1" xref="alg2.9.9.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.9.9.m1.1b"><ci id="alg2.9.9.m1.1.1.cmml" xref="alg2.9.9.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.9.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.9.9.m1.1d">▷</annotation></semantics></math> core of beam search 
</div>
<div class="ltx_listingline" id="alg2.10.10">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="B\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg2.10.10.m1.1"><semantics id="alg2.10.10.m1.1a"><mrow id="alg2.10.10.m1.1.1" xref="alg2.10.10.m1.1.1.cmml"><mi id="alg2.10.10.m1.1.1.2" xref="alg2.10.10.m1.1.1.2.cmml">B</mi><mo id="alg2.10.10.m1.1.1.1" stretchy="false" xref="alg2.10.10.m1.1.1.1.cmml">←</mo><mi id="alg2.10.10.m1.1.1.3" mathvariant="normal" xref="alg2.10.10.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.10.10.m1.1b"><apply id="alg2.10.10.m1.1.1.cmml" xref="alg2.10.10.m1.1.1"><ci id="alg2.10.10.m1.1.1.1.cmml" xref="alg2.10.10.m1.1.1.1">←</ci><ci id="alg2.10.10.m1.1.1.2.cmml" xref="alg2.10.10.m1.1.1.2">𝐵</ci><emptyset id="alg2.10.10.m1.1.1.3.cmml" xref="alg2.10.10.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.10.m1.1c">B\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg2.10.10.m1.1d">italic_B ← ∅</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.11.11">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg2.11.11.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg2.11.11.1"><math alttext="\langle\mathbf{y}_{1:t-1},p^{\prime}\rangle\in B_{t-1}" class="ltx_Math" display="inline" id="alg2.11.11.1.m1.2"><semantics id="alg2.11.11.1.m1.2a"><mrow id="alg2.11.11.1.m1.2.2" xref="alg2.11.11.1.m1.2.2.cmml"><mrow id="alg2.11.11.1.m1.2.2.2.2" xref="alg2.11.11.1.m1.2.2.2.3.cmml"><mo id="alg2.11.11.1.m1.2.2.2.2.3" mathvariant="normal" stretchy="false" xref="alg2.11.11.1.m1.2.2.2.3.cmml">⟨</mo><msub id="alg2.11.11.1.m1.1.1.1.1.1" xref="alg2.11.11.1.m1.1.1.1.1.1.cmml"><mi id="alg2.11.11.1.m1.1.1.1.1.1.2" xref="alg2.11.11.1.m1.1.1.1.1.1.2.cmml">𝐲</mi><mrow id="alg2.11.11.1.m1.1.1.1.1.1.3" xref="alg2.11.11.1.m1.1.1.1.1.1.3.cmml"><mn id="alg2.11.11.1.m1.1.1.1.1.1.3.2" mathvariant="normal" xref="alg2.11.11.1.m1.1.1.1.1.1.3.2.cmml">1</mn><mo id="alg2.11.11.1.m1.1.1.1.1.1.3.1" lspace="0.278em" mathvariant="normal" rspace="0.278em" xref="alg2.11.11.1.m1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="alg2.11.11.1.m1.1.1.1.1.1.3.3" xref="alg2.11.11.1.m1.1.1.1.1.1.3.3.cmml"><mi id="alg2.11.11.1.m1.1.1.1.1.1.3.3.2" xref="alg2.11.11.1.m1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg2.11.11.1.m1.1.1.1.1.1.3.3.1" mathvariant="normal" xref="alg2.11.11.1.m1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="alg2.11.11.1.m1.1.1.1.1.1.3.3.3" mathvariant="normal" xref="alg2.11.11.1.m1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="alg2.11.11.1.m1.2.2.2.2.4" mathvariant="normal" xref="alg2.11.11.1.m1.2.2.2.3.cmml">,</mo><msup id="alg2.11.11.1.m1.2.2.2.2.2" xref="alg2.11.11.1.m1.2.2.2.2.2.cmml"><mi id="alg2.11.11.1.m1.2.2.2.2.2.2" xref="alg2.11.11.1.m1.2.2.2.2.2.2.cmml">p</mi><mo id="alg2.11.11.1.m1.2.2.2.2.2.3" mathvariant="normal" xref="alg2.11.11.1.m1.2.2.2.2.2.3.cmml">′</mo></msup><mo id="alg2.11.11.1.m1.2.2.2.2.5" mathvariant="normal" stretchy="false" xref="alg2.11.11.1.m1.2.2.2.3.cmml">⟩</mo></mrow><mo id="alg2.11.11.1.m1.2.2.3" mathvariant="normal" xref="alg2.11.11.1.m1.2.2.3.cmml">∈</mo><msub id="alg2.11.11.1.m1.2.2.4" xref="alg2.11.11.1.m1.2.2.4.cmml"><mi id="alg2.11.11.1.m1.2.2.4.2" xref="alg2.11.11.1.m1.2.2.4.2.cmml">B</mi><mrow id="alg2.11.11.1.m1.2.2.4.3" xref="alg2.11.11.1.m1.2.2.4.3.cmml"><mi id="alg2.11.11.1.m1.2.2.4.3.2" xref="alg2.11.11.1.m1.2.2.4.3.2.cmml">t</mi><mo id="alg2.11.11.1.m1.2.2.4.3.1" mathvariant="normal" xref="alg2.11.11.1.m1.2.2.4.3.1.cmml">−</mo><mn id="alg2.11.11.1.m1.2.2.4.3.3" mathvariant="normal" xref="alg2.11.11.1.m1.2.2.4.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.11.11.1.m1.2b"><apply id="alg2.11.11.1.m1.2.2.cmml" xref="alg2.11.11.1.m1.2.2"><in id="alg2.11.11.1.m1.2.2.3.cmml" xref="alg2.11.11.1.m1.2.2.3"></in><list id="alg2.11.11.1.m1.2.2.2.3.cmml" xref="alg2.11.11.1.m1.2.2.2.2"><apply id="alg2.11.11.1.m1.1.1.1.1.1.cmml" xref="alg2.11.11.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.11.11.1.m1.1.1.1.1.1.1.cmml" xref="alg2.11.11.1.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.11.11.1.m1.1.1.1.1.1.2.cmml" xref="alg2.11.11.1.m1.1.1.1.1.1.2">𝐲</ci><apply id="alg2.11.11.1.m1.1.1.1.1.1.3.cmml" xref="alg2.11.11.1.m1.1.1.1.1.1.3"><ci id="alg2.11.11.1.m1.1.1.1.1.1.3.1.cmml" xref="alg2.11.11.1.m1.1.1.1.1.1.3.1">normal-:</ci><cn id="alg2.11.11.1.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="alg2.11.11.1.m1.1.1.1.1.1.3.2">1</cn><apply id="alg2.11.11.1.m1.1.1.1.1.1.3.3.cmml" xref="alg2.11.11.1.m1.1.1.1.1.1.3.3"><minus id="alg2.11.11.1.m1.1.1.1.1.1.3.3.1.cmml" xref="alg2.11.11.1.m1.1.1.1.1.1.3.3.1"></minus><ci id="alg2.11.11.1.m1.1.1.1.1.1.3.3.2.cmml" xref="alg2.11.11.1.m1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="alg2.11.11.1.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="alg2.11.11.1.m1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="alg2.11.11.1.m1.2.2.2.2.2.cmml" xref="alg2.11.11.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.11.11.1.m1.2.2.2.2.2.1.cmml" xref="alg2.11.11.1.m1.2.2.2.2.2">superscript</csymbol><ci id="alg2.11.11.1.m1.2.2.2.2.2.2.cmml" xref="alg2.11.11.1.m1.2.2.2.2.2.2">𝑝</ci><ci id="alg2.11.11.1.m1.2.2.2.2.2.3.cmml" xref="alg2.11.11.1.m1.2.2.2.2.2.3">normal-′</ci></apply></list><apply id="alg2.11.11.1.m1.2.2.4.cmml" xref="alg2.11.11.1.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.11.11.1.m1.2.2.4.1.cmml" xref="alg2.11.11.1.m1.2.2.4">subscript</csymbol><ci id="alg2.11.11.1.m1.2.2.4.2.cmml" xref="alg2.11.11.1.m1.2.2.4.2">𝐵</ci><apply id="alg2.11.11.1.m1.2.2.4.3.cmml" xref="alg2.11.11.1.m1.2.2.4.3"><minus id="alg2.11.11.1.m1.2.2.4.3.1.cmml" xref="alg2.11.11.1.m1.2.2.4.3.1"></minus><ci id="alg2.11.11.1.m1.2.2.4.3.2.cmml" xref="alg2.11.11.1.m1.2.2.4.3.2">𝑡</ci><cn id="alg2.11.11.1.m1.2.2.4.3.3.cmml" type="integer" xref="alg2.11.11.1.m1.2.2.4.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.11.1.m1.2c">\langle\mathbf{y}_{1:t-1},p^{\prime}\rangle\in B_{t-1}</annotation><annotation encoding="application/x-llamapun" id="alg2.11.11.1.m1.2d">⟨ bold_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ⟩ ∈ italic_B start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.11.11.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.12.12">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg2.12.12.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg2.12.12.1"><math alttext="\mathrm{y}\in V" class="ltx_Math" display="inline" id="alg2.12.12.1.m1.1"><semantics id="alg2.12.12.1.m1.1a"><mrow id="alg2.12.12.1.m1.1.1" xref="alg2.12.12.1.m1.1.1.cmml"><mi id="alg2.12.12.1.m1.1.1.2" mathvariant="normal" xref="alg2.12.12.1.m1.1.1.2.cmml">y</mi><mo id="alg2.12.12.1.m1.1.1.1" mathvariant="normal" xref="alg2.12.12.1.m1.1.1.1.cmml">∈</mo><mi id="alg2.12.12.1.m1.1.1.3" xref="alg2.12.12.1.m1.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.12.12.1.m1.1b"><apply id="alg2.12.12.1.m1.1.1.cmml" xref="alg2.12.12.1.m1.1.1"><in id="alg2.12.12.1.m1.1.1.1.cmml" xref="alg2.12.12.1.m1.1.1.1"></in><ci id="alg2.12.12.1.m1.1.1.2.cmml" xref="alg2.12.12.1.m1.1.1.2">normal-y</ci><ci id="alg2.12.12.1.m1.1.1.3.cmml" xref="alg2.12.12.1.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.12.1.m1.1c">\mathrm{y}\in V</annotation><annotation encoding="application/x-llamapun" id="alg2.12.12.1.m1.1d">roman_y ∈ italic_V</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.12.12.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.13.13">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="p^{\prime}\leftarrow p^{\prime}\cdot p(\mathrm{y}|\mathbf{y}_{1:t-1},\mathbf{x})" class="ltx_Math" display="inline" id="alg2.13.13.m1.2"><semantics id="alg2.13.13.m1.2a"><mrow id="alg2.13.13.m1.2.2" xref="alg2.13.13.m1.2.2.cmml"><msup id="alg2.13.13.m1.2.2.3" xref="alg2.13.13.m1.2.2.3.cmml"><mi id="alg2.13.13.m1.2.2.3.2" xref="alg2.13.13.m1.2.2.3.2.cmml">p</mi><mo id="alg2.13.13.m1.2.2.3.3" xref="alg2.13.13.m1.2.2.3.3.cmml">′</mo></msup><mo id="alg2.13.13.m1.2.2.2" stretchy="false" xref="alg2.13.13.m1.2.2.2.cmml">←</mo><mrow id="alg2.13.13.m1.2.2.1" xref="alg2.13.13.m1.2.2.1.cmml"><mrow id="alg2.13.13.m1.2.2.1.3" xref="alg2.13.13.m1.2.2.1.3.cmml"><msup id="alg2.13.13.m1.2.2.1.3.2" xref="alg2.13.13.m1.2.2.1.3.2.cmml"><mi id="alg2.13.13.m1.2.2.1.3.2.2" xref="alg2.13.13.m1.2.2.1.3.2.2.cmml">p</mi><mo id="alg2.13.13.m1.2.2.1.3.2.3" xref="alg2.13.13.m1.2.2.1.3.2.3.cmml">′</mo></msup><mo id="alg2.13.13.m1.2.2.1.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.13.13.m1.2.2.1.3.1.cmml">⋅</mo><mi id="alg2.13.13.m1.2.2.1.3.3" xref="alg2.13.13.m1.2.2.1.3.3.cmml">p</mi></mrow><mo id="alg2.13.13.m1.2.2.1.2" xref="alg2.13.13.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg2.13.13.m1.2.2.1.1.1" xref="alg2.13.13.m1.2.2.1.1.1.1.cmml"><mo id="alg2.13.13.m1.2.2.1.1.1.2" stretchy="false" xref="alg2.13.13.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg2.13.13.m1.2.2.1.1.1.1" xref="alg2.13.13.m1.2.2.1.1.1.1.cmml"><mi id="alg2.13.13.m1.2.2.1.1.1.1.3" mathvariant="normal" xref="alg2.13.13.m1.2.2.1.1.1.1.3.cmml">y</mi><mo fence="false" id="alg2.13.13.m1.2.2.1.1.1.1.2" xref="alg2.13.13.m1.2.2.1.1.1.1.2.cmml">|</mo><mrow id="alg2.13.13.m1.2.2.1.1.1.1.1.1" xref="alg2.13.13.m1.2.2.1.1.1.1.1.2.cmml"><msub id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.2" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝐲</mi><mrow id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mn id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.2" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.2" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.1" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.3" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="alg2.13.13.m1.2.2.1.1.1.1.1.1.2" xref="alg2.13.13.m1.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="alg2.13.13.m1.1.1" xref="alg2.13.13.m1.1.1.cmml">𝐱</mi></mrow></mrow><mo id="alg2.13.13.m1.2.2.1.1.1.3" stretchy="false" xref="alg2.13.13.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.13.13.m1.2b"><apply id="alg2.13.13.m1.2.2.cmml" xref="alg2.13.13.m1.2.2"><ci id="alg2.13.13.m1.2.2.2.cmml" xref="alg2.13.13.m1.2.2.2">←</ci><apply id="alg2.13.13.m1.2.2.3.cmml" xref="alg2.13.13.m1.2.2.3"><csymbol cd="ambiguous" id="alg2.13.13.m1.2.2.3.1.cmml" xref="alg2.13.13.m1.2.2.3">superscript</csymbol><ci id="alg2.13.13.m1.2.2.3.2.cmml" xref="alg2.13.13.m1.2.2.3.2">𝑝</ci><ci id="alg2.13.13.m1.2.2.3.3.cmml" xref="alg2.13.13.m1.2.2.3.3">′</ci></apply><apply id="alg2.13.13.m1.2.2.1.cmml" xref="alg2.13.13.m1.2.2.1"><times id="alg2.13.13.m1.2.2.1.2.cmml" xref="alg2.13.13.m1.2.2.1.2"></times><apply id="alg2.13.13.m1.2.2.1.3.cmml" xref="alg2.13.13.m1.2.2.1.3"><ci id="alg2.13.13.m1.2.2.1.3.1.cmml" xref="alg2.13.13.m1.2.2.1.3.1">⋅</ci><apply id="alg2.13.13.m1.2.2.1.3.2.cmml" xref="alg2.13.13.m1.2.2.1.3.2"><csymbol cd="ambiguous" id="alg2.13.13.m1.2.2.1.3.2.1.cmml" xref="alg2.13.13.m1.2.2.1.3.2">superscript</csymbol><ci id="alg2.13.13.m1.2.2.1.3.2.2.cmml" xref="alg2.13.13.m1.2.2.1.3.2.2">𝑝</ci><ci id="alg2.13.13.m1.2.2.1.3.2.3.cmml" xref="alg2.13.13.m1.2.2.1.3.2.3">′</ci></apply><ci id="alg2.13.13.m1.2.2.1.3.3.cmml" xref="alg2.13.13.m1.2.2.1.3.3">𝑝</ci></apply><apply id="alg2.13.13.m1.2.2.1.1.1.1.cmml" xref="alg2.13.13.m1.2.2.1.1.1"><csymbol cd="latexml" id="alg2.13.13.m1.2.2.1.1.1.1.2.cmml" xref="alg2.13.13.m1.2.2.1.1.1.1.2">conditional</csymbol><ci id="alg2.13.13.m1.2.2.1.1.1.1.3.cmml" xref="alg2.13.13.m1.2.2.1.1.1.1.3">y</ci><list id="alg2.13.13.m1.2.2.1.1.1.1.1.2.cmml" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1"><apply id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.2">𝐲</ci><apply id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3"><ci id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.1">:</ci><cn id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.2">1</cn><apply id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3"><minus id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.1"></minus><ci id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="alg2.13.13.m1.2.2.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="alg2.13.13.m1.1.1.cmml" xref="alg2.13.13.m1.1.1">𝐱</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.13.m1.2c">p^{\prime}\leftarrow p^{\prime}\cdot p(\mathrm{y}|\mathbf{y}_{1:t-1},\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="alg2.13.13.m1.2d">italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ⋅ italic_p ( roman_y | bold_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_x )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.14.14">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="B.\operatorname{add}(\langle\mathbf{y}_{1:t-1}\oplus\mathrm{y},p^{\prime}\rangle)" class="ltx_Math" display="inline" id="alg2.14.14.m1.3"><semantics id="alg2.14.14.m1.3a"><mrow id="alg2.14.14.m1.3.3.1" xref="alg2.14.14.m1.3.3.2.cmml"><mi id="alg2.14.14.m1.2.2" xref="alg2.14.14.m1.2.2.cmml">B</mi><mo id="alg2.14.14.m1.3.3.1.2" lspace="0em" rspace="0.167em" xref="alg2.14.14.m1.3.3.2a.cmml">.</mo><mrow id="alg2.14.14.m1.3.3.1.1.1" xref="alg2.14.14.m1.3.3.1.1.2.cmml"><mi id="alg2.14.14.m1.1.1" xref="alg2.14.14.m1.1.1.cmml">add</mi><mo id="alg2.14.14.m1.3.3.1.1.1a" xref="alg2.14.14.m1.3.3.1.1.2.cmml">⁡</mo><mrow id="alg2.14.14.m1.3.3.1.1.1.1" xref="alg2.14.14.m1.3.3.1.1.2.cmml"><mo id="alg2.14.14.m1.3.3.1.1.1.1.2" stretchy="false" xref="alg2.14.14.m1.3.3.1.1.2.cmml">(</mo><mrow id="alg2.14.14.m1.3.3.1.1.1.1.1.2" xref="alg2.14.14.m1.3.3.1.1.1.1.1.3.cmml"><mo id="alg2.14.14.m1.3.3.1.1.1.1.1.2.3" stretchy="false" xref="alg2.14.14.m1.3.3.1.1.1.1.1.3.cmml">⟨</mo><mrow id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.2" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">𝐲</mi><mrow id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.cmml"><mn id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mrow id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.2" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.2.cmml">t</mi><mo id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.1" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.3" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.1" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.1.cmml">⊕</mo><mi id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.3" mathvariant="normal" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo id="alg2.14.14.m1.3.3.1.1.1.1.1.2.4" xref="alg2.14.14.m1.3.3.1.1.1.1.1.3.cmml">,</mo><msup id="alg2.14.14.m1.3.3.1.1.1.1.1.2.2" xref="alg2.14.14.m1.3.3.1.1.1.1.1.2.2.cmml"><mi id="alg2.14.14.m1.3.3.1.1.1.1.1.2.2.2" xref="alg2.14.14.m1.3.3.1.1.1.1.1.2.2.2.cmml">p</mi><mo id="alg2.14.14.m1.3.3.1.1.1.1.1.2.2.3" xref="alg2.14.14.m1.3.3.1.1.1.1.1.2.2.3.cmml">′</mo></msup><mo id="alg2.14.14.m1.3.3.1.1.1.1.1.2.5" stretchy="false" xref="alg2.14.14.m1.3.3.1.1.1.1.1.3.cmml">⟩</mo></mrow><mo id="alg2.14.14.m1.3.3.1.1.1.1.3" stretchy="false" xref="alg2.14.14.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.14.14.m1.3b"><apply id="alg2.14.14.m1.3.3.2.cmml" xref="alg2.14.14.m1.3.3.1"><csymbol cd="ambiguous" id="alg2.14.14.m1.3.3.2a.cmml" xref="alg2.14.14.m1.3.3.1.2">formulae-sequence</csymbol><ci id="alg2.14.14.m1.2.2.cmml" xref="alg2.14.14.m1.2.2">𝐵</ci><apply id="alg2.14.14.m1.3.3.1.1.2.cmml" xref="alg2.14.14.m1.3.3.1.1.1"><ci id="alg2.14.14.m1.1.1.cmml" xref="alg2.14.14.m1.1.1">add</ci><list id="alg2.14.14.m1.3.3.1.1.1.1.1.3.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.2"><apply id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.1">direct-sum</csymbol><apply id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.2">𝐲</ci><apply id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3"><ci id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.1">:</ci><cn id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.2">1</cn><apply id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3"><minus id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.1"></minus><ci id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.2">𝑡</ci><cn id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.3.cmml" type="integer" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><ci id="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.1.1.3">y</ci></apply><apply id="alg2.14.14.m1.3.3.1.1.1.1.1.2.2.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.14.14.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.2.2">superscript</csymbol><ci id="alg2.14.14.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.2.2.2">𝑝</ci><ci id="alg2.14.14.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="alg2.14.14.m1.3.3.1.1.1.1.1.2.2.3">′</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.14.m1.3c">B.\operatorname{add}(\langle\mathbf{y}_{1:t-1}\oplus\mathrm{y},p^{\prime}\rangle)</annotation><annotation encoding="application/x-llamapun" id="alg2.14.14.m1.3d">italic_B . roman_add ( ⟨ bold_y start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT ⊕ roman_y , italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ⟩ )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.21.22">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg2.15.15">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="B_{t}\leftarrow B.\operatorname{top}(Z)" class="ltx_Math" display="inline" id="alg2.15.15.m1.4"><semantics id="alg2.15.15.m1.4a"><mrow id="alg2.15.15.m1.4.4.2" xref="alg2.15.15.m1.4.4.3.cmml"><mrow id="alg2.15.15.m1.3.3.1.1" xref="alg2.15.15.m1.3.3.1.1.cmml"><msub id="alg2.15.15.m1.3.3.1.1.2" xref="alg2.15.15.m1.3.3.1.1.2.cmml"><mi id="alg2.15.15.m1.3.3.1.1.2.2" xref="alg2.15.15.m1.3.3.1.1.2.2.cmml">B</mi><mi id="alg2.15.15.m1.3.3.1.1.2.3" xref="alg2.15.15.m1.3.3.1.1.2.3.cmml">t</mi></msub><mo id="alg2.15.15.m1.3.3.1.1.1" stretchy="false" xref="alg2.15.15.m1.3.3.1.1.1.cmml">←</mo><mi id="alg2.15.15.m1.3.3.1.1.3" xref="alg2.15.15.m1.3.3.1.1.3.cmml">B</mi></mrow><mo id="alg2.15.15.m1.4.4.2.3" lspace="0em" rspace="0.167em" xref="alg2.15.15.m1.4.4.3a.cmml">.</mo><mrow id="alg2.15.15.m1.4.4.2.2.2" xref="alg2.15.15.m1.4.4.2.2.1.cmml"><mi id="alg2.15.15.m1.1.1" xref="alg2.15.15.m1.1.1.cmml">top</mi><mo id="alg2.15.15.m1.4.4.2.2.2a" xref="alg2.15.15.m1.4.4.2.2.1.cmml">⁡</mo><mrow id="alg2.15.15.m1.4.4.2.2.2.1" xref="alg2.15.15.m1.4.4.2.2.1.cmml"><mo id="alg2.15.15.m1.4.4.2.2.2.1.1" stretchy="false" xref="alg2.15.15.m1.4.4.2.2.1.cmml">(</mo><mi id="alg2.15.15.m1.2.2" xref="alg2.15.15.m1.2.2.cmml">Z</mi><mo id="alg2.15.15.m1.4.4.2.2.2.1.2" stretchy="false" xref="alg2.15.15.m1.4.4.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.15.15.m1.4b"><apply id="alg2.15.15.m1.4.4.3.cmml" xref="alg2.15.15.m1.4.4.2"><csymbol cd="ambiguous" id="alg2.15.15.m1.4.4.3a.cmml" xref="alg2.15.15.m1.4.4.2.3">formulae-sequence</csymbol><apply id="alg2.15.15.m1.3.3.1.1.cmml" xref="alg2.15.15.m1.3.3.1.1"><ci id="alg2.15.15.m1.3.3.1.1.1.cmml" xref="alg2.15.15.m1.3.3.1.1.1">←</ci><apply id="alg2.15.15.m1.3.3.1.1.2.cmml" xref="alg2.15.15.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="alg2.15.15.m1.3.3.1.1.2.1.cmml" xref="alg2.15.15.m1.3.3.1.1.2">subscript</csymbol><ci id="alg2.15.15.m1.3.3.1.1.2.2.cmml" xref="alg2.15.15.m1.3.3.1.1.2.2">𝐵</ci><ci id="alg2.15.15.m1.3.3.1.1.2.3.cmml" xref="alg2.15.15.m1.3.3.1.1.2.3">𝑡</ci></apply><ci id="alg2.15.15.m1.3.3.1.1.3.cmml" xref="alg2.15.15.m1.3.3.1.1.3">𝐵</ci></apply><apply id="alg2.15.15.m1.4.4.2.2.1.cmml" xref="alg2.15.15.m1.4.4.2.2.2"><ci id="alg2.15.15.m1.1.1.cmml" xref="alg2.15.15.m1.1.1">top</ci><ci id="alg2.15.15.m1.2.2.cmml" xref="alg2.15.15.m1.2.2">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.15.m1.4c">B_{t}\leftarrow B.\operatorname{top}(Z)</annotation><annotation encoding="application/x-llamapun" id="alg2.15.15.m1.4d">italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ← italic_B . roman_top ( italic_Z )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.16.16">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.16.16.m1.1"><semantics id="alg2.16.16.m1.1a"><mo id="alg2.16.16.m1.1.1" xref="alg2.16.16.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.16.16.m1.1b"><ci id="alg2.16.16.m1.1.1.cmml" xref="alg2.16.16.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.16.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.16.16.m1.1d">▷</annotation></semantics></math> check for termination 
</div>
<div class="ltx_listingline" id="alg2.17.17">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg2.17.17.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg2.17.17.1"><math alttext="\langle\mathbf{y}_{1:t},p^{\prime}\rangle\in B_{t}" class="ltx_Math" display="inline" id="alg2.17.17.1.m1.2"><semantics id="alg2.17.17.1.m1.2a"><mrow id="alg2.17.17.1.m1.2.2" xref="alg2.17.17.1.m1.2.2.cmml"><mrow id="alg2.17.17.1.m1.2.2.2.2" xref="alg2.17.17.1.m1.2.2.2.3.cmml"><mo id="alg2.17.17.1.m1.2.2.2.2.3" mathvariant="normal" stretchy="false" xref="alg2.17.17.1.m1.2.2.2.3.cmml">⟨</mo><msub id="alg2.17.17.1.m1.1.1.1.1.1" xref="alg2.17.17.1.m1.1.1.1.1.1.cmml"><mi id="alg2.17.17.1.m1.1.1.1.1.1.2" xref="alg2.17.17.1.m1.1.1.1.1.1.2.cmml">𝐲</mi><mrow id="alg2.17.17.1.m1.1.1.1.1.1.3" xref="alg2.17.17.1.m1.1.1.1.1.1.3.cmml"><mn id="alg2.17.17.1.m1.1.1.1.1.1.3.2" mathvariant="normal" xref="alg2.17.17.1.m1.1.1.1.1.1.3.2.cmml">1</mn><mo id="alg2.17.17.1.m1.1.1.1.1.1.3.1" lspace="0.278em" mathvariant="normal" rspace="0.278em" xref="alg2.17.17.1.m1.1.1.1.1.1.3.1.cmml">:</mo><mi id="alg2.17.17.1.m1.1.1.1.1.1.3.3" xref="alg2.17.17.1.m1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="alg2.17.17.1.m1.2.2.2.2.4" mathvariant="normal" xref="alg2.17.17.1.m1.2.2.2.3.cmml">,</mo><msup id="alg2.17.17.1.m1.2.2.2.2.2" xref="alg2.17.17.1.m1.2.2.2.2.2.cmml"><mi id="alg2.17.17.1.m1.2.2.2.2.2.2" xref="alg2.17.17.1.m1.2.2.2.2.2.2.cmml">p</mi><mo id="alg2.17.17.1.m1.2.2.2.2.2.3" mathvariant="normal" xref="alg2.17.17.1.m1.2.2.2.2.2.3.cmml">′</mo></msup><mo id="alg2.17.17.1.m1.2.2.2.2.5" mathvariant="normal" stretchy="false" xref="alg2.17.17.1.m1.2.2.2.3.cmml">⟩</mo></mrow><mo id="alg2.17.17.1.m1.2.2.3" mathvariant="normal" xref="alg2.17.17.1.m1.2.2.3.cmml">∈</mo><msub id="alg2.17.17.1.m1.2.2.4" xref="alg2.17.17.1.m1.2.2.4.cmml"><mi id="alg2.17.17.1.m1.2.2.4.2" xref="alg2.17.17.1.m1.2.2.4.2.cmml">B</mi><mi id="alg2.17.17.1.m1.2.2.4.3" xref="alg2.17.17.1.m1.2.2.4.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.17.17.1.m1.2b"><apply id="alg2.17.17.1.m1.2.2.cmml" xref="alg2.17.17.1.m1.2.2"><in id="alg2.17.17.1.m1.2.2.3.cmml" xref="alg2.17.17.1.m1.2.2.3"></in><list id="alg2.17.17.1.m1.2.2.2.3.cmml" xref="alg2.17.17.1.m1.2.2.2.2"><apply id="alg2.17.17.1.m1.1.1.1.1.1.cmml" xref="alg2.17.17.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.17.17.1.m1.1.1.1.1.1.1.cmml" xref="alg2.17.17.1.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.17.17.1.m1.1.1.1.1.1.2.cmml" xref="alg2.17.17.1.m1.1.1.1.1.1.2">𝐲</ci><apply id="alg2.17.17.1.m1.1.1.1.1.1.3.cmml" xref="alg2.17.17.1.m1.1.1.1.1.1.3"><ci id="alg2.17.17.1.m1.1.1.1.1.1.3.1.cmml" xref="alg2.17.17.1.m1.1.1.1.1.1.3.1">normal-:</ci><cn id="alg2.17.17.1.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="alg2.17.17.1.m1.1.1.1.1.1.3.2">1</cn><ci id="alg2.17.17.1.m1.1.1.1.1.1.3.3.cmml" xref="alg2.17.17.1.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="alg2.17.17.1.m1.2.2.2.2.2.cmml" xref="alg2.17.17.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.17.17.1.m1.2.2.2.2.2.1.cmml" xref="alg2.17.17.1.m1.2.2.2.2.2">superscript</csymbol><ci id="alg2.17.17.1.m1.2.2.2.2.2.2.cmml" xref="alg2.17.17.1.m1.2.2.2.2.2.2">𝑝</ci><ci id="alg2.17.17.1.m1.2.2.2.2.2.3.cmml" xref="alg2.17.17.1.m1.2.2.2.2.2.3">normal-′</ci></apply></list><apply id="alg2.17.17.1.m1.2.2.4.cmml" xref="alg2.17.17.1.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.17.17.1.m1.2.2.4.1.cmml" xref="alg2.17.17.1.m1.2.2.4">subscript</csymbol><ci id="alg2.17.17.1.m1.2.2.4.2.cmml" xref="alg2.17.17.1.m1.2.2.4.2">𝐵</ci><ci id="alg2.17.17.1.m1.2.2.4.3.cmml" xref="alg2.17.17.1.m1.2.2.4.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.17.17.1.m1.2c">\langle\mathbf{y}_{1:t},p^{\prime}\rangle\in B_{t}</annotation><annotation encoding="application/x-llamapun" id="alg2.17.17.1.m1.2d">⟨ bold_y start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT , italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ⟩ ∈ italic_B start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.17.17.3">do</span>
</div>
<div class="ltx_listingline" id="alg2.18.18">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg2.18.18.2">if</span> <em class="ltx_emph ltx_font_italic" id="alg2.18.18.1"><math alttext="\mathrm{y}_{t}=\textsc{eos}" class="ltx_Math" display="inline" id="alg2.18.18.1.m1.1"><semantics id="alg2.18.18.1.m1.1a"><mrow id="alg2.18.18.1.m1.1.1" xref="alg2.18.18.1.m1.1.1.cmml"><msub id="alg2.18.18.1.m1.1.1.2" xref="alg2.18.18.1.m1.1.1.2.cmml"><mi id="alg2.18.18.1.m1.1.1.2.2" mathvariant="normal" xref="alg2.18.18.1.m1.1.1.2.2.cmml">y</mi><mi id="alg2.18.18.1.m1.1.1.2.3" xref="alg2.18.18.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="alg2.18.18.1.m1.1.1.1" mathvariant="normal" xref="alg2.18.18.1.m1.1.1.1.cmml">=</mo><mtext class="ltx_font_smallcaps" id="alg2.18.18.1.m1.1.1.3" mathvariant="normal" xref="alg2.18.18.1.m1.1.1.3b.cmml"><em class="ltx_emph ltx_font_smallcaps" id="alg2.18.18.1.m1.1.1.3.1nest">eos</em></mtext></mrow><annotation-xml encoding="MathML-Content" id="alg2.18.18.1.m1.1b"><apply id="alg2.18.18.1.m1.1.1.cmml" xref="alg2.18.18.1.m1.1.1"><eq id="alg2.18.18.1.m1.1.1.1.cmml" xref="alg2.18.18.1.m1.1.1.1"></eq><apply id="alg2.18.18.1.m1.1.1.2.cmml" xref="alg2.18.18.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.18.18.1.m1.1.1.2.1.cmml" xref="alg2.18.18.1.m1.1.1.2">subscript</csymbol><ci id="alg2.18.18.1.m1.1.1.2.2.cmml" xref="alg2.18.18.1.m1.1.1.2.2">normal-y</ci><ci id="alg2.18.18.1.m1.1.1.2.3.cmml" xref="alg2.18.18.1.m1.1.1.2.3">𝑡</ci></apply><ci id="alg2.18.18.1.m1.1.1.3b.cmml" xref="alg2.18.18.1.m1.1.1.3"><mtext class="ltx_font_smallcaps" id="alg2.18.18.1.m1.1.1.3.cmml" mathvariant="normal" xref="alg2.18.18.1.m1.1.1.3"><em class="ltx_emph ltx_font_smallcaps" id="alg2.18.18.1.m1.1.1.3.1anest">eos</em></mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.18.18.1.m1.1c">\mathrm{y}_{t}=\textsc{eos}</annotation><annotation encoding="application/x-llamapun" id="alg2.18.18.1.m1.1d">roman_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = eos</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.18.18.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.19.19">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <math alttext="H.\operatorname{add}(\langle\mathbf{y},p^{\prime}\rangle)" class="ltx_Math" display="inline" id="alg2.19.19.m1.4"><semantics id="alg2.19.19.m1.4a"><mrow id="alg2.19.19.m1.4.4.1" xref="alg2.19.19.m1.4.4.2.cmml"><mi id="alg2.19.19.m1.3.3" xref="alg2.19.19.m1.3.3.cmml">H</mi><mo id="alg2.19.19.m1.4.4.1.2" lspace="0em" rspace="0.167em" xref="alg2.19.19.m1.4.4.2a.cmml">.</mo><mrow id="alg2.19.19.m1.4.4.1.1.1" xref="alg2.19.19.m1.4.4.1.1.2.cmml"><mi id="alg2.19.19.m1.2.2" xref="alg2.19.19.m1.2.2.cmml">add</mi><mo id="alg2.19.19.m1.4.4.1.1.1a" xref="alg2.19.19.m1.4.4.1.1.2.cmml">⁡</mo><mrow id="alg2.19.19.m1.4.4.1.1.1.1" xref="alg2.19.19.m1.4.4.1.1.2.cmml"><mo id="alg2.19.19.m1.4.4.1.1.1.1.2" stretchy="false" xref="alg2.19.19.m1.4.4.1.1.2.cmml">(</mo><mrow id="alg2.19.19.m1.4.4.1.1.1.1.1.1" xref="alg2.19.19.m1.4.4.1.1.1.1.1.2.cmml"><mo id="alg2.19.19.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="alg2.19.19.m1.4.4.1.1.1.1.1.2.cmml">⟨</mo><mi id="alg2.19.19.m1.1.1" xref="alg2.19.19.m1.1.1.cmml">𝐲</mi><mo id="alg2.19.19.m1.4.4.1.1.1.1.1.1.3" xref="alg2.19.19.m1.4.4.1.1.1.1.1.2.cmml">,</mo><msup id="alg2.19.19.m1.4.4.1.1.1.1.1.1.1" xref="alg2.19.19.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="alg2.19.19.m1.4.4.1.1.1.1.1.1.1.2" xref="alg2.19.19.m1.4.4.1.1.1.1.1.1.1.2.cmml">p</mi><mo id="alg2.19.19.m1.4.4.1.1.1.1.1.1.1.3" xref="alg2.19.19.m1.4.4.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg2.19.19.m1.4.4.1.1.1.1.1.1.4" stretchy="false" xref="alg2.19.19.m1.4.4.1.1.1.1.1.2.cmml">⟩</mo></mrow><mo id="alg2.19.19.m1.4.4.1.1.1.1.3" stretchy="false" xref="alg2.19.19.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.19.19.m1.4b"><apply id="alg2.19.19.m1.4.4.2.cmml" xref="alg2.19.19.m1.4.4.1"><csymbol cd="ambiguous" id="alg2.19.19.m1.4.4.2a.cmml" xref="alg2.19.19.m1.4.4.1.2">formulae-sequence</csymbol><ci id="alg2.19.19.m1.3.3.cmml" xref="alg2.19.19.m1.3.3">𝐻</ci><apply id="alg2.19.19.m1.4.4.1.1.2.cmml" xref="alg2.19.19.m1.4.4.1.1.1"><ci id="alg2.19.19.m1.2.2.cmml" xref="alg2.19.19.m1.2.2">add</ci><list id="alg2.19.19.m1.4.4.1.1.1.1.1.2.cmml" xref="alg2.19.19.m1.4.4.1.1.1.1.1.1"><ci id="alg2.19.19.m1.1.1.cmml" xref="alg2.19.19.m1.1.1">𝐲</ci><apply id="alg2.19.19.m1.4.4.1.1.1.1.1.1.1.cmml" xref="alg2.19.19.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.19.19.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="alg2.19.19.m1.4.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.19.19.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="alg2.19.19.m1.4.4.1.1.1.1.1.1.1.2">𝑝</ci><ci id="alg2.19.19.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="alg2.19.19.m1.4.4.1.1.1.1.1.1.1.3">′</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.19.19.m1.4c">H.\operatorname{add}(\langle\mathbf{y},p^{\prime}\rangle)</annotation><annotation encoding="application/x-llamapun" id="alg2.19.19.m1.4d">italic_H . roman_add ( ⟨ bold_y , italic_p start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ⟩ )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.20.20">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg2.20.20.2">if</span> <em class="ltx_emph ltx_font_italic" id="alg2.20.20.1"><math alttext="|H|=Z" class="ltx_Math" display="inline" id="alg2.20.20.1.m1.1"><semantics id="alg2.20.20.1.m1.1a"><mrow id="alg2.20.20.1.m1.1.2" xref="alg2.20.20.1.m1.1.2.cmml"><mrow id="alg2.20.20.1.m1.1.2.2.2" xref="alg2.20.20.1.m1.1.2.2.1.cmml"><mo id="alg2.20.20.1.m1.1.2.2.2.1" mathvariant="normal" stretchy="false" xref="alg2.20.20.1.m1.1.2.2.1.1.cmml">|</mo><mi id="alg2.20.20.1.m1.1.1" xref="alg2.20.20.1.m1.1.1.cmml">H</mi><mo id="alg2.20.20.1.m1.1.2.2.2.2" mathvariant="normal" stretchy="false" xref="alg2.20.20.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="alg2.20.20.1.m1.1.2.1" mathvariant="normal" xref="alg2.20.20.1.m1.1.2.1.cmml">=</mo><mi id="alg2.20.20.1.m1.1.2.3" xref="alg2.20.20.1.m1.1.2.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.20.20.1.m1.1b"><apply id="alg2.20.20.1.m1.1.2.cmml" xref="alg2.20.20.1.m1.1.2"><eq id="alg2.20.20.1.m1.1.2.1.cmml" xref="alg2.20.20.1.m1.1.2.1"></eq><apply id="alg2.20.20.1.m1.1.2.2.1.cmml" xref="alg2.20.20.1.m1.1.2.2.2"><abs id="alg2.20.20.1.m1.1.2.2.1.1.cmml" xref="alg2.20.20.1.m1.1.2.2.2.1"></abs><ci id="alg2.20.20.1.m1.1.1.cmml" xref="alg2.20.20.1.m1.1.1">𝐻</ci></apply><ci id="alg2.20.20.1.m1.1.2.3.cmml" xref="alg2.20.20.1.m1.1.2.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.20.20.1.m1.1c">|H|=Z</annotation><annotation encoding="application/x-llamapun" id="alg2.20.20.1.m1.1d">| italic_H | = italic_Z</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg2.20.20.3">then</span>
</div>
<div class="ltx_listingline" id="alg2.21.21">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_bold" id="alg2.21.21.1">return</span> <math alttext="H.\operatorname{top}(1)" class="ltx_Math" display="inline" id="alg2.21.21.m1.4"><semantics id="alg2.21.21.m1.4a"><mrow id="alg2.21.21.m1.4.4.1" xref="alg2.21.21.m1.4.4.2.cmml"><mi id="alg2.21.21.m1.3.3" xref="alg2.21.21.m1.3.3.cmml">H</mi><mo id="alg2.21.21.m1.4.4.1.2" lspace="0em" rspace="0.167em" xref="alg2.21.21.m1.4.4.2a.cmml">.</mo><mrow id="alg2.21.21.m1.4.4.1.1.2" xref="alg2.21.21.m1.4.4.1.1.1.cmml"><mi id="alg2.21.21.m1.1.1" xref="alg2.21.21.m1.1.1.cmml">top</mi><mo id="alg2.21.21.m1.4.4.1.1.2a" xref="alg2.21.21.m1.4.4.1.1.1.cmml">⁡</mo><mrow id="alg2.21.21.m1.4.4.1.1.2.1" xref="alg2.21.21.m1.4.4.1.1.1.cmml"><mo id="alg2.21.21.m1.4.4.1.1.2.1.1" stretchy="false" xref="alg2.21.21.m1.4.4.1.1.1.cmml">(</mo><mn id="alg2.21.21.m1.2.2" xref="alg2.21.21.m1.2.2.cmml">1</mn><mo id="alg2.21.21.m1.4.4.1.1.2.1.2" stretchy="false" xref="alg2.21.21.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.21.21.m1.4b"><apply id="alg2.21.21.m1.4.4.2.cmml" xref="alg2.21.21.m1.4.4.1"><csymbol cd="ambiguous" id="alg2.21.21.m1.4.4.2a.cmml" xref="alg2.21.21.m1.4.4.1.2">formulae-sequence</csymbol><ci id="alg2.21.21.m1.3.3.cmml" xref="alg2.21.21.m1.3.3">𝐻</ci><apply id="alg2.21.21.m1.4.4.1.1.1.cmml" xref="alg2.21.21.m1.4.4.1.1.2"><ci id="alg2.21.21.m1.1.1.cmml" xref="alg2.21.21.m1.1.1">top</ci><cn id="alg2.21.21.m1.2.2.cmml" type="integer" xref="alg2.21.21.m1.2.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.21.21.m1.4c">H.\operatorname{top}(1)</annotation><annotation encoding="application/x-llamapun" id="alg2.21.21.m1.4d">italic_H . roman_top ( 1 )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.21.23">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg2.21.24">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg2.21.25">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="alg2.21.26">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.23.1.1">Algorithm 2</span> </span>Beam Search</figcaption>
</figure>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Details of Our Experiments</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.p1.1.1">Dataset details.</span> We evaluated our methods using IWSLT 2017 <cite class="ltx_cite ltx_citemacro_cite">Cettolo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib8" title="">2017</a>)</cite> and Europarl v7 <cite class="ltx_cite ltx_citemacro_cite">Koehn (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib26" title="">2005</a>)</cite>. Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A2.T6" title="Table 6 ‣ Appendix B Details of Our Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">6</span></a> provides a summary of the languages.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.p2">
<p class="ltx_p" id="A2.p2.1">The IWSLT 2017 translation dataset features multilingual data derived from TED talks.
We followed previous work and used a standard split for zero-shot evaluation <cite class="ltx_cite ltx_citemacro_citep">(Dabre and Kurohashi, <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib10" title="">2017</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite>.
In particular, IWSLT contains English-centric training data for Italian, Dutch, and Romanian, while evaluation is performed in six zero-shot directions.
IWSLT is a relatively small dataset, which tests our method’s ability to generalize from few languages.</p>
</div>
<figure class="ltx_table" id="A2.T6">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A2.T6.13" style="width:151.8pt;height:207.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(3.4pt,-4.7pt) scale(1.04728691736727,1.04728691736727) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A2.T6.13.13">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T6.13.13.14.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_t" id="A2.T6.13.13.14.1.1">Code</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A2.T6.13.13.14.1.2">Language</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T6.13.13.14.1.3">IWSLT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A2.T6.13.13.14.1.4">Europarl</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T6.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" id="A2.T6.1.1.1.2">da</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A2.T6.1.1.1.3">Danish</td>
<td class="ltx_td ltx_border_t" id="A2.T6.1.1.1.4"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A2.T6.1.1.1.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.1.1.1.1.m1.1"><semantics id="A2.T6.1.1.1.1.m1.1a"><mi id="A2.T6.1.1.1.1.m1.1.1" mathvariant="normal" xref="A2.T6.1.1.1.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.1.1.1.1.m1.1b"><ci id="A2.T6.1.1.1.1.m1.1.1.cmml" xref="A2.T6.1.1.1.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.1.1.1.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.1.1.1.1.m1.1d">✓</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T6.2.2.2">
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T6.2.2.2.2">de</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T6.2.2.2.3">German</td>
<td class="ltx_td" id="A2.T6.2.2.2.4"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.2.2.2.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.2.2.2.1.m1.1"><semantics id="A2.T6.2.2.2.1.m1.1a"><mi id="A2.T6.2.2.2.1.m1.1.1" mathvariant="normal" xref="A2.T6.2.2.2.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.2.2.2.1.m1.1b"><ci id="A2.T6.2.2.2.1.m1.1.1.cmml" xref="A2.T6.2.2.2.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.2.2.2.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.2.2.2.1.m1.1d">✓</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T6.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T6.4.4.4.3">en</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T6.4.4.4.4">English</td>
<td class="ltx_td ltx_align_center" id="A2.T6.3.3.3.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.3.3.3.1.m1.1"><semantics id="A2.T6.3.3.3.1.m1.1a"><mi id="A2.T6.3.3.3.1.m1.1.1" mathvariant="normal" xref="A2.T6.3.3.3.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.3.3.3.1.m1.1b"><ci id="A2.T6.3.3.3.1.m1.1.1.cmml" xref="A2.T6.3.3.3.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.3.3.3.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.3.3.3.1.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.4.4.4.2"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.4.4.4.2.m1.1"><semantics id="A2.T6.4.4.4.2.m1.1a"><mi id="A2.T6.4.4.4.2.m1.1.1" mathvariant="normal" xref="A2.T6.4.4.4.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.4.4.4.2.m1.1b"><ci id="A2.T6.4.4.4.2.m1.1.1.cmml" xref="A2.T6.4.4.4.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.4.4.4.2.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.4.4.4.2.m1.1d">✓</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T6.5.5.5">
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T6.5.5.5.2">es</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T6.5.5.5.3">Spanish</td>
<td class="ltx_td" id="A2.T6.5.5.5.4"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.5.5.5.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.5.5.5.1.m1.1"><semantics id="A2.T6.5.5.5.1.m1.1a"><mi id="A2.T6.5.5.5.1.m1.1.1" mathvariant="normal" xref="A2.T6.5.5.5.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.5.5.5.1.m1.1b"><ci id="A2.T6.5.5.5.1.m1.1.1.cmml" xref="A2.T6.5.5.5.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.5.5.5.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.5.5.5.1.m1.1d">✓</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T6.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T6.6.6.6.2">fi</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T6.6.6.6.3">Finnish</td>
<td class="ltx_td" id="A2.T6.6.6.6.4"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.6.6.6.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.6.6.6.1.m1.1"><semantics id="A2.T6.6.6.6.1.m1.1a"><mi id="A2.T6.6.6.6.1.m1.1.1" mathvariant="normal" xref="A2.T6.6.6.6.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.6.6.6.1.m1.1b"><ci id="A2.T6.6.6.6.1.m1.1.1.cmml" xref="A2.T6.6.6.6.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.6.6.6.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.6.6.6.1.m1.1d">✓</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T6.7.7.7">
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T6.7.7.7.2">fr</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T6.7.7.7.3">French</td>
<td class="ltx_td" id="A2.T6.7.7.7.4"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.7.7.7.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.7.7.7.1.m1.1"><semantics id="A2.T6.7.7.7.1.m1.1a"><mi id="A2.T6.7.7.7.1.m1.1.1" mathvariant="normal" xref="A2.T6.7.7.7.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.7.7.7.1.m1.1b"><ci id="A2.T6.7.7.7.1.m1.1.1.cmml" xref="A2.T6.7.7.7.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.7.7.7.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.7.7.7.1.m1.1d">✓</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T6.9.9.9">
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T6.9.9.9.3">it</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T6.9.9.9.4">Italian</td>
<td class="ltx_td ltx_align_center" id="A2.T6.8.8.8.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.8.8.8.1.m1.1"><semantics id="A2.T6.8.8.8.1.m1.1a"><mi id="A2.T6.8.8.8.1.m1.1.1" mathvariant="normal" xref="A2.T6.8.8.8.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.8.8.8.1.m1.1b"><ci id="A2.T6.8.8.8.1.m1.1.1.cmml" xref="A2.T6.8.8.8.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.8.8.8.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.8.8.8.1.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.9.9.9.2"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.9.9.9.2.m1.1"><semantics id="A2.T6.9.9.9.2.m1.1a"><mi id="A2.T6.9.9.9.2.m1.1.1" mathvariant="normal" xref="A2.T6.9.9.9.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.9.9.9.2.m1.1b"><ci id="A2.T6.9.9.9.2.m1.1.1.cmml" xref="A2.T6.9.9.9.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.9.9.9.2.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.9.9.9.2.m1.1d">✓</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T6.11.11.11">
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T6.11.11.11.3">nl</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T6.11.11.11.4">Dutch</td>
<td class="ltx_td ltx_align_center" id="A2.T6.10.10.10.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.10.10.10.1.m1.1"><semantics id="A2.T6.10.10.10.1.m1.1a"><mi id="A2.T6.10.10.10.1.m1.1.1" mathvariant="normal" xref="A2.T6.10.10.10.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.10.10.10.1.m1.1b"><ci id="A2.T6.10.10.10.1.m1.1.1.cmml" xref="A2.T6.10.10.10.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.10.10.10.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.10.10.10.1.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.11.11.11.2"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.11.11.11.2.m1.1"><semantics id="A2.T6.11.11.11.2.m1.1a"><mi id="A2.T6.11.11.11.2.m1.1.1" mathvariant="normal" xref="A2.T6.11.11.11.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.11.11.11.2.m1.1b"><ci id="A2.T6.11.11.11.2.m1.1.1.cmml" xref="A2.T6.11.11.11.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.11.11.11.2.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.11.11.11.2.m1.1d">✓</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T6.12.12.12">
<td class="ltx_td ltx_align_center ltx_border_l" id="A2.T6.12.12.12.2">pt</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A2.T6.12.12.12.3">Portugese</td>
<td class="ltx_td" id="A2.T6.12.12.12.4"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A2.T6.12.12.12.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.12.12.12.1.m1.1"><semantics id="A2.T6.12.12.12.1.m1.1a"><mi id="A2.T6.12.12.12.1.m1.1.1" mathvariant="normal" xref="A2.T6.12.12.12.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.12.12.12.1.m1.1b"><ci id="A2.T6.12.12.12.1.m1.1.1.cmml" xref="A2.T6.12.12.12.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.12.12.12.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.12.12.12.1.m1.1d">✓</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T6.13.13.13">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l" id="A2.T6.13.13.13.2">ro</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A2.T6.13.13.13.3">Romanian</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A2.T6.13.13.13.1"><math alttext="\checkmark" class="ltx_Math" display="inline" id="A2.T6.13.13.13.1.m1.1"><semantics id="A2.T6.13.13.13.1.m1.1a"><mi id="A2.T6.13.13.13.1.m1.1.1" mathvariant="normal" xref="A2.T6.13.13.13.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="A2.T6.13.13.13.1.m1.1b"><ci id="A2.T6.13.13.13.1.m1.1.1.cmml" xref="A2.T6.13.13.13.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.13.13.13.1.m1.1c">\checkmark</annotation><annotation encoding="application/x-llamapun" id="A2.T6.13.13.13.1.m1.1d">✓</annotation></semantics></math></td>
<td class="ltx_td ltx_border_b ltx_border_r" id="A2.T6.13.13.13.4"></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Summary of the language codes.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A2.p3">
<p class="ltx_p" id="A2.p3.1">Europarl is a multilingual dataset crawled from the proceedings of the European Parliament.
We again followed previous work <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite> and evaluated our methods with a standard split for the zero-shot setting, containing English-centric data for eight languages with a total of 56 zero-shot evaluation directions. We specifically adopted the non-overlapping setting: in the original corpus, a sentence may be translated into multiple languages, and the non-overlapping setup chooses only one target translation for each input. This prevents potential data leaking problems.
Europarl contains more data and languages than IWSLT, which further tests our method’s ability to generalize across multiple languages.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.p4">
<p class="ltx_p" id="A2.p4.1"><span class="ltx_text ltx_font_bold" id="A2.p4.1.1">Implementation details.</span> We directly adopt the neural architecture and hyperparameters in <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib30" title="">2021</a>)</cite>. In particular, we used 5- and 8-layer encoder–decoder models for IWSLT and Europarl, respectively. For both datasets, we had 512 hidden units and 8 attention heads. Our BLEU scores are based on SacreBLEU <cite class="ltx_cite ltx_citemacro_cite">Post (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib37" title="">2018</a>)</cite> with the following specifications: <span class="ltx_ERROR undefined" id="A2.p4.1.2">\seqsplit</span><span class="ltx_text ltx_font_typewriter" id="A2.p4.1.3">BLEU+case.mixed+numrefs.1+smooth.exp+tok.13a+version.1.5.1</span>. These setups establish a controlled comparison against previous work.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.p5">
<p class="ltx_p" id="A2.p5.1">In our presentation of beam search and the proposed EBBS, we describe the scorer as the multiplication of step-wise probabilities. In implementation, we used the sum of log-probabilities for numerical stability.
Moreover, our EBBS is built on top of the popular fairseq framework <cite class="ltx_cite ltx_citemacro_citep">(Ott et al., <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib35" title="">2019</a>)</cite>, using their beam search implementation as the backbone.
Consequently, we inherit standard beam search implementation techniques such as length normalization and max length constraints, which are not detailed in our pseudocode.</p>
</div>
<figure class="ltx_table" id="A2.T7">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A2.T7.1" style="width:216.8pt;height:110pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(1.9pt,-1.0pt) scale(1.01828327029169,1.01828327029169) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A2.T7.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T7.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A2.T7.1.1.1.1.1">Beam Size</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.1.1.1.1.2">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.1.1.1.1.3">BLEU1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.1.1.1.1.4">BLEU2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.1.1.1.1.5">BLEU3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A2.T7.1.1.1.1.6">BLEU4</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A2.T7.1.1.2.2.1">1</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.1.1.2.2.2">24.98</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.1.1.2.2.3">56.75</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.1.1.2.2.4">30.08</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.1.1.2.2.5">18.84</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A2.T7.1.1.2.2.6">12.46</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A2.T7.1.1.3.3.1">3</th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.3.3.2">25.99</td>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.3.3.3">57.04</td>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.3.3.4">30.92</td>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.3.3.5">19.65</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A2.T7.1.1.3.3.6">13.17</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A2.T7.1.1.4.4.1">5</th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.4.4.2">
<span class="ltx_ERROR undefined" id="A2.T7.1.1.4.4.2.1">\ul</span>26.10</td>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.4.4.3"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.4.4.3.1">57.07</span></td>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.4.4.4"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.4.4.4.1">31.00</span></td>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.4.4.5">
<span class="ltx_ERROR undefined" id="A2.T7.1.1.4.4.5.1">\ul</span>19.76</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A2.T7.1.1.4.4.6">13.28</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A2.T7.1.1.5.5.1">7</th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.5.5.2">
<span class="ltx_ERROR undefined" id="A2.T7.1.1.5.5.2.1">\ul</span>26.10</td>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.5.5.3">
<span class="ltx_ERROR undefined" id="A2.T7.1.1.5.5.3.1">\ul</span>57.06</td>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.5.5.4">30.98</td>
<td class="ltx_td ltx_align_center" id="A2.T7.1.1.5.5.5">19.74</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A2.T7.1.1.5.5.6">
<span class="ltx_ERROR undefined" id="A2.T7.1.1.5.5.6.1">\ul</span>13.30</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="A2.T7.1.1.6.6.1">9</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="A2.T7.1.1.6.6.2"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.6.6.2.1">26.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A2.T7.1.1.6.6.3">57.02</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A2.T7.1.1.6.6.4">
<span class="ltx_ERROR undefined" id="A2.T7.1.1.6.6.4.1">\ul</span>30.99</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A2.T7.1.1.6.6.5"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.6.6.5.1">19.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A2.T7.1.1.6.6.6"><span class="ltx_text ltx_font_bold" id="A2.T7.1.1.6.6.6.1">13.31</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Beam size analysis for Italian-to-Dutch translation on the Europarl dataset.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Analysis of Beam Size</h2>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">We analyze the effect of the beam size and show the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A2.T7" title="Table 7 ‣ Appendix B Details of Our Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">7</span></a>. As seen, performance rises with a larger beam size and eventually plateaus at around five, which is consistent with the practice of standard beam search <cite class="ltx_cite ltx_citemacro_cite">Meister et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib31" title="">2020</a>)</cite>. This analysis also shows the robustness of our EBBS algorithm. Based on this experiment and efficiency considerations, we used a beam size of five in our main experiments.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.p2">
<p class="ltx_p" id="A3.p2.1">It should be mentioned that in principle our lower-level and upper-level beams need not have the same size. In our experiments, we simply set them to be the same. We have not tried full-grid hyperparameter tuning because the focus of our paper is algorithmic design, and as shown, our proposed EBBS is mostly robust to the beam size.</p>
</div>
<figure class="ltx_figure" id="A3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="145" id="A3.F3.g1" src="extracted/5441316/assets/inference.png" width="240"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Inference time analysis on the test set of Italian to Dutch translation from the Europarl dataset. Experiments were conducted on an AMD EPYC 7313 CPU and an NVIDIA RTX A6000 GPU, with an inference batch size of 300 samples.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Analysis of Inference Efficiency</h2>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">We analyze the efficiency of our ensemble approach. As seen in Figure <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A3.F3" title="Figure 3 ‣ Appendix C Analysis of Beam Size ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">3</span></a>, the inference scales almost linearly, which is reasonable as we need to perform inference for all the components. The trend shows that it is computationally feasible to build an ensemble of even more components.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.p2">
<p class="ltx_p" id="A4.p2.1">Further, the analysis suggests that our EBB-distilled models achieves a speedup of multiple times depending on the number of ensemble components. Recall from §<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.SS3" title="4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">4.3</span></a> that our our EBBS-based distillation is able to transfer the ensemble’s knowledge to a single multilingual model, without hurting, if not improving, the translation quality.</p>
</div>
<figure class="ltx_table" id="A4.T8">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A4.T8.1" style="width:216.8pt;height:180.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-10.7pt,8.9pt) scale(0.910432814503045,0.910432814503045) ;">
<table class="ltx_tabular ltx_align_middle" id="A4.T8.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T8.1.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A4.T8.1.1.1.1.1">Dataset</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="A4.T8.1.1.1.1.2">Method</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T8.1.1.1.1.3">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T8.1.1.1.1.4">Entropy</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A4.T8.1.1.2.2.1" rowspan="5"><span class="ltx_text" id="A4.T8.1.1.2.2.1.1">IWSLT</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" colspan="2" id="A4.T8.1.1.2.2.2">EBBS</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T8.1.1.2.2.3">
<span class="ltx_ERROR undefined" id="A4.T8.1.1.2.2.3.1">\ul</span>19.52</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T8.1.1.2.2.4">-</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T8.1.1.3.3.1" rowspan="4">
<span class="ltx_text" id="A4.T8.1.1.3.3.1.1">
<span class="ltx_tabular ltx_align_middle" id="A4.T8.1.1.3.3.1.1.1">
<span class="ltx_tr" id="A4.T8.1.1.3.3.1.1.1.1">
<span class="ltx_td ltx_align_left" id="A4.T8.1.1.3.3.1.1.1.1.1">Direct</span></span>
<span class="ltx_tr" id="A4.T8.1.1.3.3.1.1.1.2">
<span class="ltx_td ltx_align_left" id="A4.T8.1.1.3.3.1.1.1.2.1">translation</span></span>
</span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T8.1.1.3.3.2">No distillation</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T8.1.1.3.3.3">17.46</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T8.1.1.3.3.4">2.46</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.1.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="A4.T8.1.1.4.4.1">Self-distillation</td>
<td class="ltx_td ltx_align_center" id="A4.T8.1.1.4.4.2">18.10</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A4.T8.1.1.4.4.3">1.62</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.1.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="A4.T8.1.1.5.5.1">Union distillation</td>
<td class="ltx_td ltx_align_center" id="A4.T8.1.1.5.5.2">17.80</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A4.T8.1.1.5.5.3">1.80</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="A4.T8.1.1.6.6.1">EBBS distillation</td>
<td class="ltx_td ltx_align_center" id="A4.T8.1.1.6.6.2"><span class="ltx_text ltx_font_bold" id="A4.T8.1.1.6.6.2.1">20.13</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A4.T8.1.1.6.6.3">1.70</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.1.7.7">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_tt" id="A4.T8.1.1.7.7.1" rowspan="5"><span class="ltx_text" id="A4.T8.1.1.7.7.1.1">Europarl</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" colspan="2" id="A4.T8.1.1.7.7.2">EBBS</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T8.1.1.7.7.3"><span class="ltx_text ltx_font_bold" id="A4.T8.1.1.7.7.3.1">26.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A4.T8.1.1.7.7.4">-</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.1.8.8">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A4.T8.1.1.8.8.1" rowspan="4">
<span class="ltx_text" id="A4.T8.1.1.8.8.1.1">
<span class="ltx_tabular ltx_align_middle" id="A4.T8.1.1.8.8.1.1.1">
<span class="ltx_tr" id="A4.T8.1.1.8.8.1.1.1.1">
<span class="ltx_td ltx_align_left" id="A4.T8.1.1.8.8.1.1.1.1.1">Direct</span></span>
<span class="ltx_tr" id="A4.T8.1.1.8.8.1.1.1.2">
<span class="ltx_td ltx_align_left" id="A4.T8.1.1.8.8.1.1.1.2.1">translation</span></span>
</span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T8.1.1.8.8.2">No distillation</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T8.1.1.8.8.3">25.33</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A4.T8.1.1.8.8.4">2.06</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.1.9.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="A4.T8.1.1.9.9.1">Self-distillation</td>
<td class="ltx_td ltx_align_center" id="A4.T8.1.1.9.9.2">25.44</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A4.T8.1.1.9.9.3">1.44</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.1.10.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="A4.T8.1.1.10.10.1">Union distillation</td>
<td class="ltx_td ltx_align_center" id="A4.T8.1.1.10.10.2">25.53</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A4.T8.1.1.10.10.3">1.59</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.1.11.11">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="A4.T8.1.1.11.11.1">EBBS distillation</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A4.T8.1.1.11.11.2">
<span class="ltx_ERROR undefined" id="A4.T8.1.1.11.11.2.1">\ul</span>25.92</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A4.T8.1.1.11.11.3">1.51</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Entropy of various distillation techniques on Italian-to-Dutch translation.</figcaption>
</figure>
<figure class="ltx_table" id="A4.T9">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A4.T9.1" style="width:433.6pt;height:446.9pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-45.2pt,46.5pt) scale(0.827517484238196,0.827517484238196) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A4.T9.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T9.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="2" id="A4.T9.1.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="A4.T9.1.1.1.1.1.1">IWSLT</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T9.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.2.1.1" style="padding-bottom:10.0pt;">Input</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T9.1.1.2.1.2" style="padding-bottom:10.0pt;">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.2.1.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.2.1.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.2.1.2.1.1.1">ho sempre creduto che trasformare la paura in divertimento sia il dono della creatività.</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.2.1.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.2.1.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.2.1.2.1.2.1.1">I have always believed that turning fear into fun is the gift of creativity.</span>)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.3.2.1">Reference</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T9.1.1.3.2.2">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.3.2.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.3.2.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.3.2.2.1.1.1">Ik heb altijd geloofd dat het omzetten van angst in plezier de gift is van creativiteit.</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.3.2.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.3.2.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.3.2.2.1.2.1.1">I have always believed that turning fear into joy is the gift of creativity.</span>)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.4.3.1" style="padding-bottom:10.0pt;">Direct translation</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T9.1.1.4.3.2" style="padding-bottom:10.0pt;">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.4.3.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.4.3.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.4.3.2.1.1.1">Ik geloofde altijd dat het transformeren van angst in ontspanning de gift van creativiteit is</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.4.3.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.4.3.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.4.3.2.1.2.1.1">I always believed that transforming anxiety into relaxation is the gift of creativity.</span>)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.5.4.1" style="padding-bottom:10.0pt;">English-pivoting</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T9.1.1.5.4.2" style="padding-bottom:10.0pt;">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.5.4.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.5.4.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.5.4.2.1.1.1">Omdat ik altijd geloofde om angst in plezier te transformeren, is het geschenk van creativiteit.</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.5.4.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.5.4.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.5.4.2.1.2.1.1">Because I always believed to transform fear into pleasure is the gift of creativity.</span>)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.6.5.1" style="padding-bottom:10.0pt;">Romanian-pivoting</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T9.1.1.6.5.2" style="padding-bottom:10.0pt;">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.6.5.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.6.5.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.6.5.2.1.1.1">In feite hebben we altijd gedacht dat het transformeren van angst in divergentie de gift van creativiteit is.</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.6.5.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.6.5.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.6.5.2.1.2.1.1">In fact, we have always thought that transforming fear into divergence is the gift of creativity</span>)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.7.6.1">EBBS</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T9.1.1.7.6.2">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.7.6.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.7.6.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.7.6.2.1.1.1">Ik geloofde altijd dat het transformeren van angst in plezier de gift van creativiteit is.</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.7.6.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.7.6.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.7.6.2.1.2.1.1">I always believed that transforming fear into pleasure is the gift of creativity.</span>)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_tt" colspan="2" id="A4.T9.1.1.8.7.1">
<span class="ltx_text ltx_font_bold" id="A4.T9.1.1.8.7.1.1">Europarl</span></th>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.9.8.1" style="padding-bottom:10.0pt;">Input</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T9.1.1.9.8.2" style="padding-bottom:10.0pt;">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.9.8.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.9.8.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.9.8.2.1.1.1">si poteva avvertire una forte tensione.</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.9.8.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.9.8.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.9.8.2.1.2.1.1">a strong tension could be felt.</span>)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.10.9.1">Reference</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T9.1.1.10.9.2">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.10.9.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.10.9.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.10.9.2.1.1.1">Er was veel spanning zichtbaar.</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.10.9.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.10.9.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.10.9.2.1.2.1.1"> There was a lot of tension visible.</span>)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.11.10.1" style="padding-bottom:10.0pt;">Direct translation</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T9.1.1.11.10.2" style="padding-bottom:10.0pt;">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.11.10.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.11.10.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.11.10.2.1.1.1">Er was grote spanning te ontgaan.</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.11.10.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.11.10.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.11.10.2.1.2.1.1">There was great tension to be escaped.</span>)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.12.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.12.11.1" style="padding-bottom:10.0pt;">English-pivoting</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T9.1.1.12.11.2" style="padding-bottom:10.0pt;">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.12.11.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.12.11.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.12.11.2.1.1.1">Er zou veel spanningen kunnen zijn ontstaan.</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.12.11.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.12.11.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.12.11.2.1.2.1.1">A lot of tensions could have arisen.</span>)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.13.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.13.12.1" style="padding-bottom:10.0pt;">Spanish-pivoting</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T9.1.1.13.12.2" style="padding-bottom:10.0pt;">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.13.12.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.13.12.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.13.12.2.1.1.1">Mocht een sterke spanning kunnen worden aangekondigd.</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.13.12.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.13.12.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.13.12.2.1.2.1.1">Should a strong tension can be announced.</span>)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.14.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A4.T9.1.1.14.13.1">EBBS</th>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A4.T9.1.1.14.13.2">
<table class="ltx_tabular ltx_align_middle" id="A4.T9.1.1.14.13.2.1">
<tr class="ltx_tr" id="A4.T9.1.1.14.13.2.1.1">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.14.13.2.1.1.1">Er was veel spanning geweest.</td>
</tr>
<tr class="ltx_tr" id="A4.T9.1.1.14.13.2.1.2">
<td class="ltx_td ltx_align_left" id="A4.T9.1.1.14.13.2.1.2.1">(<span class="ltx_text ltx_font_italic" id="A4.T9.1.1.14.13.2.1.2.1.1">There had been a lot of tension.</span>)</td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Case studies, where the source language is Italian and the target is Dutch. We provide English interpretations in (<span class="ltx_text ltx_font_italic" id="A4.T9.3.1">italic</span>) for non-English text using Google Translate.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Entropy of Distilled Models</h2>
<div class="ltx_para ltx_noindent" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">We would like to understand why EBBS-based distillation largely outperforms other methods, such as union distillation (§<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.SS3" title="4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">4.3</span></a>). The hypothesis is that cross-entropy distillation loss with diverse samples may lead to an overly smooth distribution, which in turn would affect the model performance <cite class="ltx_cite ltx_citemacro_cite">Wen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib54" title="">2023b</a>); Shayegh et al. (<a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#bib.bib46" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.p2">
<p class="ltx_p" id="A5.p2.2">We show the average prediction entropy of our distilled models in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A4.T8" title="Table 8 ‣ Appendix D Analysis of Inference Efficiency ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">8</span></a>.
For some input <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="A5.p2.1.m1.1"><semantics id="A5.p2.1.m1.1a"><mi id="A5.p2.1.m1.1.1" xref="A5.p2.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="A5.p2.1.m1.1b"><ci id="A5.p2.1.m1.1.1.cmml" xref="A5.p2.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="A5.p2.1.m1.1d">bold_x</annotation></semantics></math> and generation step <math alttext="t" class="ltx_Math" display="inline" id="A5.p2.2.m2.1"><semantics id="A5.p2.2.m2.1a"><mi id="A5.p2.2.m2.1.1" xref="A5.p2.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A5.p2.2.m2.1b"><ci id="A5.p2.2.m2.1.1.cmml" xref="A5.p2.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="A5.p2.2.m2.1d">italic_t</annotation></semantics></math>, the prediction entropy is</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A6.EGx6">
<tbody id="A5.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle H=-\sum_{\mathrm{y}\in V}" class="ltx_Math" display="inline" id="A5.Ex2.m1.1"><semantics id="A5.Ex2.m1.1a"><mrow id="A5.Ex2.m1.1.1" xref="A5.Ex2.m1.1.1.cmml"><mi id="A5.Ex2.m1.1.1.2" xref="A5.Ex2.m1.1.1.2.cmml">H</mi><mo id="A5.Ex2.m1.1.1.1" xref="A5.Ex2.m1.1.1.1.cmml">=</mo><mrow id="A5.Ex2.m1.1.1.3" xref="A5.Ex2.m1.1.1.3.cmml"><mo id="A5.Ex2.m1.1.1.3a" xref="A5.Ex2.m1.1.1.3.cmml">−</mo><mstyle displaystyle="true" id="A5.Ex2.m1.1.1.3.2" xref="A5.Ex2.m1.1.1.3.2.cmml"><munder id="A5.Ex2.m1.1.1.3.2a" xref="A5.Ex2.m1.1.1.3.2.cmml"><mo id="A5.Ex2.m1.1.1.3.2.2" movablelimits="false" xref="A5.Ex2.m1.1.1.3.2.2.cmml">∑</mo><mrow id="A5.Ex2.m1.1.1.3.2.3" xref="A5.Ex2.m1.1.1.3.2.3.cmml"><mi id="A5.Ex2.m1.1.1.3.2.3.2" mathvariant="normal" xref="A5.Ex2.m1.1.1.3.2.3.2.cmml">y</mi><mo id="A5.Ex2.m1.1.1.3.2.3.1" xref="A5.Ex2.m1.1.1.3.2.3.1.cmml">∈</mo><mi id="A5.Ex2.m1.1.1.3.2.3.3" xref="A5.Ex2.m1.1.1.3.2.3.3.cmml">V</mi></mrow></munder></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex2.m1.1b"><apply id="A5.Ex2.m1.1.1.cmml" xref="A5.Ex2.m1.1.1"><eq id="A5.Ex2.m1.1.1.1.cmml" xref="A5.Ex2.m1.1.1.1"></eq><ci id="A5.Ex2.m1.1.1.2.cmml" xref="A5.Ex2.m1.1.1.2">𝐻</ci><apply id="A5.Ex2.m1.1.1.3.cmml" xref="A5.Ex2.m1.1.1.3"><minus id="A5.Ex2.m1.1.1.3.1.cmml" xref="A5.Ex2.m1.1.1.3"></minus><apply id="A5.Ex2.m1.1.1.3.2.cmml" xref="A5.Ex2.m1.1.1.3.2"><csymbol cd="ambiguous" id="A5.Ex2.m1.1.1.3.2.1.cmml" xref="A5.Ex2.m1.1.1.3.2">subscript</csymbol><sum id="A5.Ex2.m1.1.1.3.2.2.cmml" xref="A5.Ex2.m1.1.1.3.2.2"></sum><apply id="A5.Ex2.m1.1.1.3.2.3.cmml" xref="A5.Ex2.m1.1.1.3.2.3"><in id="A5.Ex2.m1.1.1.3.2.3.1.cmml" xref="A5.Ex2.m1.1.1.3.2.3.1"></in><ci id="A5.Ex2.m1.1.1.3.2.3.2.cmml" xref="A5.Ex2.m1.1.1.3.2.3.2">y</ci><ci id="A5.Ex2.m1.1.1.3.2.3.3.cmml" xref="A5.Ex2.m1.1.1.3.2.3.3">𝑉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex2.m1.1c">\displaystyle H=-\sum_{\mathrm{y}\in V}</annotation><annotation encoding="application/x-llamapun" id="A5.Ex2.m1.1d">italic_H = - ∑ start_POSTSUBSCRIPT roman_y ∈ italic_V end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\;p(\mathrm{y}|\hat{\mathbf{y}}_{1:t-1},\mathbf{x})\log p(\mathrm%
{y}|\hat{\mathbf{y}}_{1:t-1},\mathbf{x})" class="ltx_Math" display="inline" id="A5.Ex2.m2.4"><semantics id="A5.Ex2.m2.4a"><mrow id="A5.Ex2.m2.4.4" xref="A5.Ex2.m2.4.4.cmml"><mi id="A5.Ex2.m2.4.4.4" xref="A5.Ex2.m2.4.4.4.cmml">p</mi><mo id="A5.Ex2.m2.4.4.3" xref="A5.Ex2.m2.4.4.3.cmml">⁢</mo><mrow id="A5.Ex2.m2.3.3.1.1" xref="A5.Ex2.m2.3.3.1.1.1.cmml"><mo id="A5.Ex2.m2.3.3.1.1.2" stretchy="false" xref="A5.Ex2.m2.3.3.1.1.1.cmml">(</mo><mrow id="A5.Ex2.m2.3.3.1.1.1" xref="A5.Ex2.m2.3.3.1.1.1.cmml"><mi id="A5.Ex2.m2.3.3.1.1.1.3" mathvariant="normal" xref="A5.Ex2.m2.3.3.1.1.1.3.cmml">y</mi><mo fence="false" id="A5.Ex2.m2.3.3.1.1.1.2" xref="A5.Ex2.m2.3.3.1.1.1.2.cmml">|</mo><mrow id="A5.Ex2.m2.3.3.1.1.1.1.1" xref="A5.Ex2.m2.3.3.1.1.1.1.2.cmml"><msub id="A5.Ex2.m2.3.3.1.1.1.1.1.1" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="A5.Ex2.m2.3.3.1.1.1.1.1.1.2" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.2.cmml"><mi id="A5.Ex2.m2.3.3.1.1.1.1.1.1.2.2" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.2.2.cmml">𝐲</mi><mo id="A5.Ex2.m2.3.3.1.1.1.1.1.1.2.1" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.cmml"><mn id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.2" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.2" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.1" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.3" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="A5.Ex2.m2.3.3.1.1.1.1.1.2" xref="A5.Ex2.m2.3.3.1.1.1.1.2.cmml">,</mo><mi id="A5.Ex2.m2.1.1" xref="A5.Ex2.m2.1.1.cmml">𝐱</mi></mrow></mrow><mo id="A5.Ex2.m2.3.3.1.1.3" stretchy="false" xref="A5.Ex2.m2.3.3.1.1.1.cmml">)</mo></mrow><mo id="A5.Ex2.m2.4.4.3a" lspace="0.167em" xref="A5.Ex2.m2.4.4.3.cmml">⁢</mo><mrow id="A5.Ex2.m2.4.4.5" xref="A5.Ex2.m2.4.4.5.cmml"><mi id="A5.Ex2.m2.4.4.5.1" xref="A5.Ex2.m2.4.4.5.1.cmml">log</mi><mo id="A5.Ex2.m2.4.4.5a" lspace="0.167em" xref="A5.Ex2.m2.4.4.5.cmml">⁡</mo><mi id="A5.Ex2.m2.4.4.5.2" xref="A5.Ex2.m2.4.4.5.2.cmml">p</mi></mrow><mo id="A5.Ex2.m2.4.4.3b" xref="A5.Ex2.m2.4.4.3.cmml">⁢</mo><mrow id="A5.Ex2.m2.4.4.2.1" xref="A5.Ex2.m2.4.4.2.1.1.cmml"><mo id="A5.Ex2.m2.4.4.2.1.2" stretchy="false" xref="A5.Ex2.m2.4.4.2.1.1.cmml">(</mo><mrow id="A5.Ex2.m2.4.4.2.1.1" xref="A5.Ex2.m2.4.4.2.1.1.cmml"><mi id="A5.Ex2.m2.4.4.2.1.1.3" mathvariant="normal" xref="A5.Ex2.m2.4.4.2.1.1.3.cmml">y</mi><mo fence="false" id="A5.Ex2.m2.4.4.2.1.1.2" xref="A5.Ex2.m2.4.4.2.1.1.2.cmml">|</mo><mrow id="A5.Ex2.m2.4.4.2.1.1.1.1" xref="A5.Ex2.m2.4.4.2.1.1.1.2.cmml"><msub id="A5.Ex2.m2.4.4.2.1.1.1.1.1" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.cmml"><mover accent="true" id="A5.Ex2.m2.4.4.2.1.1.1.1.1.2" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.2.cmml"><mi id="A5.Ex2.m2.4.4.2.1.1.1.1.1.2.2" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.2.2.cmml">𝐲</mi><mo id="A5.Ex2.m2.4.4.2.1.1.1.1.1.2.1" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.cmml"><mn id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.2" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.2.cmml">1</mn><mo id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.1.cmml">:</mo><mrow id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.cmml"><mi id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.2" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.1" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.3" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="A5.Ex2.m2.4.4.2.1.1.1.1.2" xref="A5.Ex2.m2.4.4.2.1.1.1.2.cmml">,</mo><mi id="A5.Ex2.m2.2.2" xref="A5.Ex2.m2.2.2.cmml">𝐱</mi></mrow></mrow><mo id="A5.Ex2.m2.4.4.2.1.3" stretchy="false" xref="A5.Ex2.m2.4.4.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.Ex2.m2.4b"><apply id="A5.Ex2.m2.4.4.cmml" xref="A5.Ex2.m2.4.4"><times id="A5.Ex2.m2.4.4.3.cmml" xref="A5.Ex2.m2.4.4.3"></times><ci id="A5.Ex2.m2.4.4.4.cmml" xref="A5.Ex2.m2.4.4.4">𝑝</ci><apply id="A5.Ex2.m2.3.3.1.1.1.cmml" xref="A5.Ex2.m2.3.3.1.1"><csymbol cd="latexml" id="A5.Ex2.m2.3.3.1.1.1.2.cmml" xref="A5.Ex2.m2.3.3.1.1.1.2">conditional</csymbol><ci id="A5.Ex2.m2.3.3.1.1.1.3.cmml" xref="A5.Ex2.m2.3.3.1.1.1.3">y</ci><list id="A5.Ex2.m2.3.3.1.1.1.1.2.cmml" xref="A5.Ex2.m2.3.3.1.1.1.1.1"><apply id="A5.Ex2.m2.3.3.1.1.1.1.1.1.cmml" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex2.m2.3.3.1.1.1.1.1.1.1.cmml" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="A5.Ex2.m2.3.3.1.1.1.1.1.1.2.cmml" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.2"><ci id="A5.Ex2.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.2.1">^</ci><ci id="A5.Ex2.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.2.2">𝐲</ci></apply><apply id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.cmml" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3"><ci id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.1.cmml" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.1">:</ci><cn id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.2">1</cn><apply id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.cmml" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3"><minus id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.1"></minus><ci id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A5.Ex2.m2.3.3.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="A5.Ex2.m2.1.1.cmml" xref="A5.Ex2.m2.1.1">𝐱</ci></list></apply><apply id="A5.Ex2.m2.4.4.5.cmml" xref="A5.Ex2.m2.4.4.5"><log id="A5.Ex2.m2.4.4.5.1.cmml" xref="A5.Ex2.m2.4.4.5.1"></log><ci id="A5.Ex2.m2.4.4.5.2.cmml" xref="A5.Ex2.m2.4.4.5.2">𝑝</ci></apply><apply id="A5.Ex2.m2.4.4.2.1.1.cmml" xref="A5.Ex2.m2.4.4.2.1"><csymbol cd="latexml" id="A5.Ex2.m2.4.4.2.1.1.2.cmml" xref="A5.Ex2.m2.4.4.2.1.1.2">conditional</csymbol><ci id="A5.Ex2.m2.4.4.2.1.1.3.cmml" xref="A5.Ex2.m2.4.4.2.1.1.3">y</ci><list id="A5.Ex2.m2.4.4.2.1.1.1.2.cmml" xref="A5.Ex2.m2.4.4.2.1.1.1.1"><apply id="A5.Ex2.m2.4.4.2.1.1.1.1.1.cmml" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.Ex2.m2.4.4.2.1.1.1.1.1.1.cmml" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1">subscript</csymbol><apply id="A5.Ex2.m2.4.4.2.1.1.1.1.1.2.cmml" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.2"><ci id="A5.Ex2.m2.4.4.2.1.1.1.1.1.2.1.cmml" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.2.1">^</ci><ci id="A5.Ex2.m2.4.4.2.1.1.1.1.1.2.2.cmml" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.2.2">𝐲</ci></apply><apply id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.cmml" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3"><ci id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.1.cmml" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.1">:</ci><cn id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.2.cmml" type="integer" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.2">1</cn><apply id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.cmml" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3"><minus id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.1.cmml" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.1"></minus><ci id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.2.cmml" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.2">𝑡</ci><cn id="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A5.Ex2.m2.4.4.2.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="A5.Ex2.m2.2.2.cmml" xref="A5.Ex2.m2.2.2">𝐱</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.Ex2.m2.4c">\displaystyle\;p(\mathrm{y}|\hat{\mathbf{y}}_{1:t-1},\mathbf{x})\log p(\mathrm%
{y}|\hat{\mathbf{y}}_{1:t-1},\mathbf{x})</annotation><annotation encoding="application/x-llamapun" id="A5.Ex2.m2.4d">italic_p ( roman_y | over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_x ) roman_log italic_p ( roman_y | over^ start_ARG bold_y end_ARG start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_x )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A5.p2.3">Here, a large entropy generally indicates that the model is less certain, producing a more uniform prediction, whereas a low entropy indicates that the model is confident, producing a more peaked distribution.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.p3">
<p class="ltx_p" id="A5.p3.1">As seen in Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A4.T8" title="Table 8 ‣ Appendix D Analysis of Inference Efficiency ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">8</span></a>, the model without distillation yields the highest entropy, suggesting that it is uncertain about zero-shot translation probably due to a lack of training signals.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.p4">
<p class="ltx_p" id="A5.p4.1">Union distillation trains the model from the union of ensemble components’ outputs. It reduces prediction entropy compared with no distillation, but due to the nature of cross-entropy loss, it remains the highest among all distillation variants.
Self-distillation is based on direction translation only, reinforcing the model’s current belief and thus producing the lowest entropy. On the contrary, our EBBS-based distillation achieves a moderate entropy on both datasets.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.p5">
<p class="ltx_p" id="A5.p5.1">It should be emphasized that the entropy analysis only merely light on how different distillation methods behave, but the entropy itself does not indicate the quality of a model.
We quote BLEU scores from Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#S4.T5" title="Table 5 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">5</span></a>, which has suggested that our EBBS-based distillation achieves similar or higher performance compared with EBBS, consistently outperforming other distillation methods.</p>
</div>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Case Study</h2>
<div class="ltx_para ltx_noindent" id="A6.p1">
<p class="ltx_p" id="A6.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2403.00144v1#A4.T9" title="Table 9 ‣ Appendix D Analysis of Inference Efficiency ‣ EBBS: An Ensemble with Bi-Level Beam Searchfor Zero-Shot Machine Translation"><span class="ltx_text ltx_ref_tag">9</span></a> shows examples of direct, pivot, and EBBS translations.
As seen, pivot and direction translations are prone to low-quality output, but EBBS enables them to correct each other’s mistakes.
In the first example, say, our EBBS generally follows the sentence structure of direct translation, where the Italian word “divertimento” (<span class="ltx_text ltx_font_italic" id="A6.p1.1.1">fun</span>) is mistranslated to the Dutch word “ontspanning” (<span class="ltx_text ltx_font_italic" id="A6.p1.1.2">relaxation</span>), but our EBBS corrects it to “plezier” (<span class="ltx_text ltx_font_italic" id="A6.p1.1.3">pleasure</span>), advocated by English pivoting and voted by all ensemble components.</p>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Feb 29 21:39:18 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
