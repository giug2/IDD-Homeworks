<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Retrieval-Augmented Decision Transformer: External Memory for In-context RL</title>
<!--Generated on Tue Oct  8 21:55:47 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.07071v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S1" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S2" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS1" title="In 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Background</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2" title="In 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Retrieval-augmented Decision Transformer (RA-DT)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS1" title="In 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Vector Index for Retrieval Augmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS2" title="In 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Searching for Similar Experiences</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS3" title="In 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Reweighting Retrieved Experiences</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS4" title="In 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.4 </span>Incorporating Retrieved <span class="ltx_text"> </span>Experiences</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS1" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Dark-Room</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS2" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Dark Key-Door</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS3" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Maze-Runner</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS4" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Meta-World &amp; DMControl</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS5" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Procgen</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS6" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Ablations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S5" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S6" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A1" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Ethics Statement &amp; Reproducibility</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Environments &amp; Datasets</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS1" title="In Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Dark-Room and Dark Key-Door</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS2" title="In Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>MazeRunner</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS3" title="In Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Meta-World</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS4" title="In Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4 </span>DMControl</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS5" title="In Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.5 </span>Procgen</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Experimental &amp; Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS1" title="In Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>General</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS2" title="In Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Decision Transformer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS3" title="In Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>Algorithm Distillation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS4" title="In Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.4 </span>Retrieval-Augmented Decision Transformer</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Additional Results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS1" title="In Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Dark-Room</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS1.SSS1" title="In D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1.1 </span>Attention Map Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS1.SSS2" title="In D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1.2 </span>Exploration Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS2" title="In Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Maze-Runner</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS3" title="In Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3 </span>Meta-World</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS4" title="In Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.4 </span>DMControl</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS5" title="In Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.5 </span>Procgen</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Ablation Studies</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS1" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.1 </span>Retrieval outperforms sampling of experiences</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS2" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.2 </span>Reweighting Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS3" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.3 </span>Retrieval Regularization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS4" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.4 </span>Query Construction &amp; Sequence Aggregation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS5" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.5 </span>Placement of Cross-Attention Layers</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS6" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.6 </span>Interaction steps between context retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS7" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.7 </span>Pre-trained Language Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS8" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.8 </span>Effect of <math alttext="K" class="ltx_Math" display="inline"><semantics><mi>K</mi><annotation-xml encoding="MathML-Content"><ci>𝐾</ci></annotation-xml><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math> on Algorithm Distillation</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Retrieval-Augmented Decision Transformer: External Memory for In-context RL</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span class="ltx_text ltx_font_bold" id="id1.1.1">Thomas Schmied<sup class="ltx_sup" id="id1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id1.1.1.1.1">1</span></sup></span>  <span class="ltx_text ltx_font_bold" id="id2.2.2">Fabian Paischer<sup class="ltx_sup" id="id2.2.2.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id2.2.2.1.1">1</span></sup></span>  <span class="ltx_text ltx_font_bold" id="id3.3.3">Vihang Patil<sup class="ltx_sup" id="id3.3.3.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id3.3.3.1.1">1</span></sup></span>  
<br class="ltx_break"/> <span class="ltx_text ltx_font_bold" id="id4.4.4">Markus Hofmarcher<sup class="ltx_sup" id="id4.4.4.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id4.4.4.1.1">2</span></sup></span>  <span class="ltx_text ltx_font_bold" id="id5.5.5">Razvan Pascanu<sup class="ltx_sup" id="id5.5.5.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id5.5.5.1.1">3,4</span></sup></span>  <span class="ltx_text ltx_font_bold" id="id6.6.6">Sepp Hochreiter<sup class="ltx_sup" id="id6.6.6.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id6.6.6.1.1">1,5</span></sup></span>
<br class="ltx_break"/><sup class="ltx_sup" id="id12.12.id1"><span class="ltx_text ltx_font_italic" id="id12.12.id1.1">1</span></sup> ELLIS Unit, LIT AI Lab, Institute for Machine Learning, JKU Linz, Austria
<br class="ltx_break"/><sup class="ltx_sup" id="id13.13.id2"><span class="ltx_text ltx_font_italic" id="id13.13.id2.1">2</span></sup> Extensity AI  <sup class="ltx_sup" id="id14.14.id3"><span class="ltx_text ltx_font_italic" id="id14.14.id3.1">3</span></sup> Google DeepMind  <sup class="ltx_sup" id="id15.15.id4"><span class="ltx_text ltx_font_italic" id="id15.15.id4.1">4</span></sup> UCL  <sup class="ltx_sup" id="id16.16.id5"><span class="ltx_text ltx_font_italic" id="id16.16.id5.1">5</span></sup> NXAI GmbH
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id17.id1">In-context learning (ICL) is the ability of a model to learn a new task by observing a few exemplars in its context.
While prevalent in NLP, this capability has recently also been observed in Reinforcement Learning (RL) settings.
Prior in-context RL methods, however, require entire episodes in the agent’s context.
Given that complex environments typically lead to
long episodes with sparse rewards, these methods are constrained to simple environments with short episodes.
To address these challenges, we introduce Retrieval-Augmented Decision Transformer (RA-DT).
RA-DT employs an external memory mechanism to store past experiences from which it retrieves only sub-trajectories relevant for the current situation.
The retrieval component in RA-DT does not require training and can be entirely domain-agnostic.
We evaluate the capabilities of RA-DT on grid-world environments, robotics simulations, and procedurally-generated video games.
On grid-worlds, RA-DT outperforms baselines, while using only a fraction of their context length.
Furthermore, we illuminate the limitations of current in-context RL methods on complex environments and discuss future directions. To facilitate future research, we release datasets for four of the considered environments.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In-context Learning (ICL) is the ability of a model to learn new tasks by leveraging a few exemplars in its context <cite class="ltx_cite ltx_citemacro_citep">[Brown et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib9" title="">2020</a>]</cite>.
Large Language Models (LLMs) exhibit this capability after pre-training on large amounts of data crawled from the web.
A similar trend has emerged in the field of RL, where agents are pre-trained on datasets with an increasing number of tasks <cite class="ltx_cite ltx_citemacro_citep">[Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib13" title="">2021</a>; Janner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib36" title="">2021</a>; Reed et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib74" title="">2022</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib47" title="">2022</a>; Brohan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib7" title="">2022</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib8" title="">2023</a>]</cite>.
After training, such an agent is capable of learning new tasks by observing previous trials in its context <cite class="ltx_cite ltx_citemacro_citep">[Laskin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib45" title="">2022</a>; Liu &amp; Abbeel, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib51" title="">2023</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib46" title="">2023</a>; Raparthy et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib73" title="">2023</a>]</cite>.
Consequently, ICL is a promising direction for generalist agents to acquire new tasks without the need for re-training, fine-tuning, or providing expert-demonstrations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Existing methods for in-context RL rely on keeping entire episodes in their context <cite class="ltx_cite ltx_citemacro_citep">[Laskin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib45" title="">2022</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib46" title="">2023</a>; Kirsch et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib42" title="">2023</a>; Raparthy et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib73" title="">2023</a>]</cite>.
Consequently, these methods face challenges in complex environments, as complex environments are usually characterized by long episodes and sparse rewards.
Episodes in RL may consist of thousands of interaction steps, and processing them is computationally expensive, especially for network architectures such as the Transformer <cite class="ltx_cite ltx_citemacro_citep">[Vaswani et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib91" title="">2017</a>]</cite>.
Furthermore, not all information an agent encountered in the past may be necessary to solve the new task.
Therefore, we address the question of how to facilitate ICL for environments with long episodes and sparse rewards.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="255" id="S1.F1.g1" src="extracted/5911726/figures/radt_new_v1.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of <span class="ltx_text ltx_font_bold" id="S1.F1.4.1">Retrieval-augmented Decision Transformer (RA-DT)</span>. <span class="ltx_text ltx_font_bold" id="S1.F1.5.2">Left:</span> Prior to training, we encode pre-collected trajectories via an embedding model. During training, we retrieve sub-trajectories using the current context as query, and fuse them into layers via cross-attention. <span class="ltx_text ltx_font_bold" id="S1.F1.6.3">Right:</span> During inference, the collected experience is stored and retrieved during environment interaction.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">We introduce Retrieval-Augmented Decision Transformer (RA-DT), which incorporates an external memory into the Decision Transformer <cite class="ltx_cite ltx_citemacro_citep">[Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib13" title="">2021</a>, DT]</cite> architecture (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">1</span></a>).
Our external memory enables efficient storage and retrieval of past experiences, that are relevant for the current situation.
We achieve this by leveraging a vector index populated with sub-trajectories, in combination with maximum inner product search; akin to Retrieval-augmented Generation (RAG) in LLMs <cite class="ltx_cite ltx_citemacro_citep">[Khandelwal et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib39" title="">2019</a>; Lewis et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib49" title="">2020</a>; Borgeaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib6" title="">2022</a>]</cite>.
To encode retrieved sub-trajectories, RA-DT relies on a pre-trained embedding model, which can either be domain-specific, such as a DT trained on the same domain, or a domain-agnostic language model (LM) (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3" title="3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3</span></a>).
Subsequently, RA-DT uses cross-attention to leverage the retrieved sub-trajectories and predict the next action.
This way, RA-DT does not rely on a long context and can deal with sparse reward settings.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">We evaluate the effectiveness of RA-DT on grid-world environments used in prior work with sparse rewards and increasing grid-sizes (Dark-Room, Dark Key-Door, Maze-Runner), robotics environments (Meta-World, DMControl) and procedurally-generated video games (Procgen).
On grid-worlds, RA-DT considerably outperforms previous in-context RL methods, while only using a fraction of their context length.
Further, we show that our domain-agnostic trajectory embedding model reaches performance close to a domain-specific one.
On the remaining more complex environments, we observe consistent improvements for RA-DT on hold-out tasks, but no in-context improvement for any method.
Therefore, we discuss the current limitations of RA-DT and other in-context RL methods and elaborate on potential remedies and future directions for in-context RL.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We make the following <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">contributions</span>:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce Retrieval-augmented Decision Transformers (RA-DT) and evaluate its effectiveness on a number of diverse domains.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We show that a domain-agnostic embedding model can be utilized for retrieval in RL without requiring any pre-training, and reaches performance close to a domain-specific model.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We release datasets for Dark-Room, Dark Key-Door, Maze-Runner, and Procgen to foster future research on in-context decision-making that leverages offline pre-training<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>GitHub: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ml-jku/RA-DT" title="">https://github.com/ml-jku/RA-DT</a></span></span></span>.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">In-context Learning.</span>
ICL is a form of Meta-learning, also referred to as learning-to-learn <cite class="ltx_cite ltx_citemacro_citep">[Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib79" title="">1987</a>]</cite>.
Typically, meta-learning is <em class="ltx_emph ltx_font_italic" id="S2.p1.1.2">targeted</em> and learned through a meta-training phase, for example in supervised-learning <cite class="ltx_cite ltx_citemacro_citep">[Santoro et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib77" title="">2016</a>; Mishra et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib57" title="">2018</a>; Finn et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib21" title="">2017</a>]</cite> or in RL <cite class="ltx_cite ltx_citemacro_citep">[Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib92" title="">2016</a>; Duan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib18" title="">2016</a>; Kirsch et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib40" title="">2019</a>; Flennerhag et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib22" title="">2019</a>]</cite>.
In contrast, ICL <em class="ltx_emph ltx_font_italic" id="S2.p1.1.3">emerges</em> as a result of pre-training on a certain data distribution <cite class="ltx_cite ltx_citemacro_citep">[Chan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib12" title="">2022</a>]</cite>.
This ability was first observed in <cite class="ltx_cite ltx_citemacro_citet">Hochreiter et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib31" title="">2001</a>]</cite> via LSTMs <cite class="ltx_cite ltx_citemacro_citep">[Hochreiter &amp; Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib30" title="">1997</a>]</cite> and later re-discovered in LLMs <cite class="ltx_cite ltx_citemacro_citep">[Brown et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib9" title="">2020</a>]</cite>.
<cite class="ltx_cite ltx_citemacro_citet">Ortega et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib59" title="">2019</a>]</cite> found that every memory-based architecture may exhibit such capabilities.
Another crucial factor is a training distribution comprising a vast amount of tasks <cite class="ltx_cite ltx_citemacro_citep">[Chan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib12" title="">2022</a>; Kirsch et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib41" title="">2022</a>]</cite>.
Recent works combined these properties to induce ICL in RL <cite class="ltx_cite ltx_citemacro_citep">[Laskin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib45" title="">2022</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib47" title="">2022</a>; Kirsch et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib42" title="">2023</a>]</cite>.
While promising, they require keeping entire episodes in context, which is difficult in environments with long episodes.
<cite class="ltx_cite ltx_citemacro_citet">Raparthy et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib73" title="">2023</a>]</cite> consider an in-context imitation learning setting given expert demonstrations.
In contrast, RA-DT can handle long episodes and does not rely on expert demonstrations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Retrieval-augmented Generation.</span>
The aim of retrieval-augmentation is to provide a model access to an external memory.
This alleviates the need to store the training data in the parameters of a model and allows to condition on new data without re-training.
RAG is successfully applied in the realm of LLMs <cite class="ltx_cite ltx_citemacro_citep">[Khandelwal et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib39" title="">2019</a>; Guu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib27" title="">2020</a>; Lewis et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib49" title="">2020</a>; Borgeaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib6" title="">2022</a>; Izacard et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib35" title="">2022</a>; Ram et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib71" title="">2023</a>]</cite>, multi-modal language generation <cite class="ltx_cite ltx_citemacro_citep">[Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib32" title="">2023</a>; Yasunaga et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib102" title="">2023</a>; Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib100" title="">2023b</a>; Ramos et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib72" title="">2022</a>]</cite>, and for chemical reaction prediction <cite class="ltx_cite ltx_citemacro_citep">[Seidl et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib85" title="">2022</a>]</cite>.
In RL, the access to an external memory is often referred to as episodic memory <cite class="ltx_cite ltx_citemacro_citep">[Sprechmann et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib87" title="">2018</a>; Blundell et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib5" title="">2016</a>; Pritzel et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib67" title="">2017</a>]</cite>.
<cite class="ltx_cite ltx_citemacro_citet">Goyal et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib23" title="">2022</a>]</cite> investigate the effect of different data sources in the external memory of an online RL agent. <cite class="ltx_cite ltx_citemacro_citep">[Humphreys et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib34" title="">2022</a>]</cite> provide access to millions of expert demonstrations via RAG in the game of Go.
In contrast, RA-DT does not rely on expert demonstrations, but leverages RAG to learn new tasks entirely in-context without the need for weight updates.
Further, RA-DT does <em class="ltx_emph ltx_font_italic" id="S2.p2.1.2">not</em> rely on a pre-trained domain-specific embedding model, as we demonstrate that the embedding model can be entirely domain-agnostic.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">External memory in RL.</span>
Most prior works have explored the utility of an external memory to cope with partially observable environments <cite class="ltx_cite ltx_citemacro_citep">[Åström, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib106" title="">1965</a>; Kaelbling et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib38" title="">1998</a>]</cite>, in which the agent must remember past events to approximate the true state of the environment.
This is difficult, especially for complex tasks with sparse rewards <cite class="ltx_cite ltx_citemacro_citep">[Arjona-Medina et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib3" title="">2019</a>; Patil et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib66" title="">2022</a>; Widrich et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib96" title="">2021</a>]</cite> and long episodes.
To cope with this problem, Neural Turing Machines <cite class="ltx_cite ltx_citemacro_citep">[Graves et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib24" title="">2014</a>]</cite>, which rely on a neural controller to read from and write to an external memory, were applied to RL <cite class="ltx_cite ltx_citemacro_citep">[Zaremba &amp; Sutskever, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib105" title="">2015</a>]</cite>.
Memory networks <cite class="ltx_cite ltx_citemacro_citep">[Weston et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib95" title="">2015</a>]</cite> leverage an external memory for reasoning.
<cite class="ltx_cite ltx_citemacro_citet">Wayne et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib93" title="">2018</a>]</cite> propose a memory architecture with read/write access to learn what information to store based on a world model.
In contrast, RA-DT only retrieves pieces of past information similar to the current encountered situation.
<cite class="ltx_cite ltx_citemacro_citet">Hill et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib29" title="">2021</a>]</cite> propose an attention-based external memory, where queries, keys, and values are represented by different modalities.
Similarly, our domain-agnostic embedding model extends the idea of history compression via LLMs <cite class="ltx_cite ltx_citemacro_citep">[Paischer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib61" title="">2022</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib62" title="">2023</a>]</cite> to retrieval, where queries and keys are encoded in the language space, while values comprise raw sub-trajectories.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Background</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.16"><span class="ltx_text ltx_font_bold" id="S3.SS1.p1.16.1">Reinforcement Learning.</span>
We formulate our problem setting as a Markov Decision Process (MDP) that is represented by a 4-tuple of<math alttext="(\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R})" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.4"><semantics id="S3.SS1.p1.1.m1.4a"><mrow id="S3.SS1.p1.1.m1.4.5.2" xref="S3.SS1.p1.1.m1.4.5.1.cmml"><mo id="S3.SS1.p1.1.m1.4.5.2.1" stretchy="false" xref="S3.SS1.p1.1.m1.4.5.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒮</mi><mo id="S3.SS1.p1.1.m1.4.5.2.2" xref="S3.SS1.p1.1.m1.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml">𝒜</mi><mo id="S3.SS1.p1.1.m1.4.5.2.3" xref="S3.SS1.p1.1.m1.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml">𝒫</mi><mo id="S3.SS1.p1.1.m1.4.5.2.4" xref="S3.SS1.p1.1.m1.4.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml">ℛ</mi><mo id="S3.SS1.p1.1.m1.4.5.2.5" stretchy="false" xref="S3.SS1.p1.1.m1.4.5.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.4b"><vector id="S3.SS1.p1.1.m1.4.5.1.cmml" xref="S3.SS1.p1.1.m1.4.5.2"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒮</ci><ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">𝒜</ci><ci id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3">𝒫</ci><ci id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4">ℛ</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.4c">(\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.4d">( caligraphic_S , caligraphic_A , caligraphic_P , caligraphic_R )</annotation></semantics></math>.
<math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">caligraphic_S</annotation></semantics></math> and <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">caligraphic_A</annotation></semantics></math> denote state and action spaces, respectively.
At timestep <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_t</annotation></semantics></math> the agent observes state <math alttext="s_{t}\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><msub id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.2" xref="S3.SS1.p1.5.m5.1.1.2.2.cmml">s</mi><mi id="S3.SS1.p1.5.m5.1.1.2.3" xref="S3.SS1.p1.5.m5.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><in id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></in><apply id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2">𝑠</ci><ci id="S3.SS1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">s_{t}\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_S</annotation></semantics></math> and issues action <math alttext="a_{t}\in\mathcal{A}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><msub id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2.2" xref="S3.SS1.p1.6.m6.1.1.2.2.cmml">a</mi><mi id="S3.SS1.p1.6.m6.1.1.2.3" xref="S3.SS1.p1.6.m6.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><in id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></in><apply id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2.2">𝑎</ci><ci id="S3.SS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">a_{t}\in\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ caligraphic_A</annotation></semantics></math>.
For each executed action, the agent receives a scalar reward <math alttext="r_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">r</mi><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑟</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">r_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, which is given by the reward function <math alttext="\mathcal{R}(r_{t}\mid s_{t},a_{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">ℛ</mi><mo id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.8.m8.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.8.m8.1.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.8.m8.1.1.1.1.1.4" xref="S3.SS1.p1.8.m8.1.1.1.1.1.4.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.4.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.4.2.cmml">r</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.4.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S3.SS1.p1.8.m8.1.1.1.1.1.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.3.cmml"><msub id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.SS1.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><times id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2"></times><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">ℛ</ci><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.3">conditional</csymbol><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.4.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.4.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.4.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.4.2">𝑟</ci><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.4.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S3.SS1.p1.8.m8.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2"><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\mathcal{R}(r_{t}\mid s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">caligraphic_R ( italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.
<math alttext="\mathcal{P}(s_{t+1}\mid s_{t},a_{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">𝒫</mi><mo id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.9.m9.1.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.9.m9.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.9.m9.1.1.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.9.m9.1.1.1.1.1.4" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4.cmml"><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.4.2" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4.2.cmml">s</mi><mrow id="S3.SS1.p1.9.m9.1.1.1.1.1.4.3" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.cmml"><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.2" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.1" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.1.cmml">+</mo><mn id="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.3" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p1.9.m9.1.1.1.1.1.3" xref="S3.SS1.p1.9.m9.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.3.cmml"><msub id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="S3.SS1.p1.9.m9.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><times id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2"></times><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝒫</ci><apply id="S3.SS1.p1.9.m9.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.3">conditional</csymbol><apply id="S3.SS1.p1.9.m9.1.1.1.1.1.4.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.1.1.4.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.4.2.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4.2">𝑠</ci><apply id="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4.3"><plus id="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.1"></plus><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.2">𝑡</ci><cn id="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.3.cmml" type="integer" xref="S3.SS1.p1.9.m9.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S3.SS1.p1.9.m9.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2"><apply id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.2">𝑎</ci><ci id="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\mathcal{P}(s_{t+1}\mid s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">caligraphic_P ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> constitutes a probability distribution over next states <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">s</mi><mrow id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.p1.10.m10.1.1.3.2" xref="S3.SS1.p1.10.m10.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p1.10.m10.1.1.3.1" xref="S3.SS1.p1.10.m10.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p1.10.m10.1.1.3.3" xref="S3.SS1.p1.10.m10.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝑠</ci><apply id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3"><plus id="S3.SS1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.p1.10.m10.1.1.3.1"></plus><ci id="S3.SS1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.p1.10.m10.1.1.3.2">𝑡</ci><cn id="S3.SS1.p1.10.m10.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.10.m10.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">s_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> when issuing action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><msub id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">a</mi><mi id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2">𝑎</ci><ci id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><msub id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">𝑠</ci><ci id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
RL aims at learning a policy <math alttext="\pi(a_{t}\mid s_{t})" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><mrow id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">π</mi><mo id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.13.m13.1.1.1.1" xref="S3.SS1.p1.13.m13.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.13.m13.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.13.m13.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.13.m13.1.1.1.1.1" xref="S3.SS1.p1.13.m13.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.13.m13.1.1.1.1.1.2" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.13.m13.1.1.1.1.1.2.2" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.SS1.p1.13.m13.1.1.1.1.1.2.3" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p1.13.m13.1.1.1.1.1.1" xref="S3.SS1.p1.13.m13.1.1.1.1.1.1.cmml">∣</mo><msub id="S3.SS1.p1.13.m13.1.1.1.1.1.3" xref="S3.SS1.p1.13.m13.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.13.m13.1.1.1.1.1.3.2" xref="S3.SS1.p1.13.m13.1.1.1.1.1.3.2.cmml">s</mi><mi id="S3.SS1.p1.13.m13.1.1.1.1.1.3.3" xref="S3.SS1.p1.13.m13.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS1.p1.13.m13.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.13.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><times id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2"></times><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝜋</ci><apply id="S3.SS1.p1.13.m13.1.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.13.m13.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS1.p1.13.m13.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.SS1.p1.13.m13.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.13.m13.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.SS1.p1.13.m13.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.13.m13.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">\pi(a_{t}\mid s_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_π ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> that predicts action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><msub id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">a</mi><mi id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2">𝑎</ci><ci id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><msub id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml"><mi id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">s</mi><mi id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2">𝑠</ci><ci id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> that maximizes <math alttext="r_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m16.1"><semantics id="S3.SS1.p1.16.m16.1a"><msub id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml"><mi id="S3.SS1.p1.16.m16.1.1.2" xref="S3.SS1.p1.16.m16.1.1.2.cmml">r</mi><mi id="S3.SS1.p1.16.m16.1.1.3" xref="S3.SS1.p1.16.m16.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><apply id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.1.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">subscript</csymbol><ci id="S3.SS1.p1.16.m16.1.1.2.cmml" xref="S3.SS1.p1.16.m16.1.1.2">𝑟</ci><ci id="S3.SS1.p1.16.m16.1.1.3.cmml" xref="S3.SS1.p1.16.m16.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">r_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.16.m16.1d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.11"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.11.1">Decision Transformer.</span>
Decision Transformer <cite class="ltx_cite ltx_citemacro_citep">[Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib13" title="">2021</a>, DT]</cite> learns a policy from offline data by conditioning on future rewards.
This allows rephrasing RL as a sequence modelling problem, where the agent is trained in a supervised manner to map future rewards to actions, often referred to as upside-down RL <cite class="ltx_cite ltx_citemacro_citep">[Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib78" title="">2019</a>]</cite>.
To train the DT, we assume access to a pre-collected dataset <math alttext="\mathcal{D}=\{\tau_{i}\mid 1\leq i\leq N\}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.2"><semantics id="S3.SS1.p2.1.m1.2a"><mrow id="S3.SS1.p2.1.m1.2.2" xref="S3.SS1.p2.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.2.2.4" xref="S3.SS1.p2.1.m1.2.2.4.cmml">𝒟</mi><mo id="S3.SS1.p2.1.m1.2.2.3" xref="S3.SS1.p2.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.3.cmml"><mo id="S3.SS1.p2.1.m1.2.2.2.2.3" stretchy="false" xref="S3.SS1.p2.1.m1.2.2.2.3.1.cmml">{</mo><msub id="S3.SS1.p2.1.m1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml">τ</mi><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo fence="true" id="S3.SS1.p2.1.m1.2.2.2.2.4" lspace="0em" rspace="0em" xref="S3.SS1.p2.1.m1.2.2.2.3.1.cmml">∣</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.2.cmml"><mn id="S3.SS1.p2.1.m1.2.2.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2.cmml">1</mn><mo id="S3.SS1.p2.1.m1.2.2.2.2.2.3" xref="S3.SS1.p2.1.m1.2.2.2.2.2.3.cmml">≤</mo><mi id="S3.SS1.p2.1.m1.2.2.2.2.2.4" xref="S3.SS1.p2.1.m1.2.2.2.2.2.4.cmml">i</mi><mo id="S3.SS1.p2.1.m1.2.2.2.2.2.5" xref="S3.SS1.p2.1.m1.2.2.2.2.2.5.cmml">≤</mo><mi id="S3.SS1.p2.1.m1.2.2.2.2.2.6" xref="S3.SS1.p2.1.m1.2.2.2.2.2.6.cmml">N</mi></mrow><mo id="S3.SS1.p2.1.m1.2.2.2.2.5" stretchy="false" xref="S3.SS1.p2.1.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.2b"><apply id="S3.SS1.p2.1.m1.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2"><eq id="S3.SS1.p2.1.m1.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.3"></eq><ci id="S3.SS1.p2.1.m1.2.2.4.cmml" xref="S3.SS1.p2.1.m1.2.2.4">𝒟</ci><apply id="S3.SS1.p2.1.m1.2.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2"><csymbol cd="latexml" id="S3.SS1.p2.1.m1.2.2.2.3.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.3">conditional-set</csymbol><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2">𝜏</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2"><and id="S3.SS1.p2.1.m1.2.2.2.2.2a.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2"></and><apply id="S3.SS1.p2.1.m1.2.2.2.2.2b.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2"><leq id="S3.SS1.p2.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2.3"></leq><cn id="S3.SS1.p2.1.m1.2.2.2.2.2.2.cmml" type="integer" xref="S3.SS1.p2.1.m1.2.2.2.2.2.2">1</cn><ci id="S3.SS1.p2.1.m1.2.2.2.2.2.4.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2.4">𝑖</ci></apply><apply id="S3.SS1.p2.1.m1.2.2.2.2.2c.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2"><leq id="S3.SS1.p2.1.m1.2.2.2.2.2.5.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2410.07071v1#S3.SS1.p2.1.m1.2.2.2.2.2.4.cmml" id="S3.SS1.p2.1.m1.2.2.2.2.2d.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2"></share><ci id="S3.SS1.p2.1.m1.2.2.2.2.2.6.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2.6">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.2c">\mathcal{D}=\{\tau_{i}\mid 1\leq i\leq N\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.2d">caligraphic_D = { italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∣ 1 ≤ italic_i ≤ italic_N }</annotation></semantics></math> of <math alttext="N" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_N</annotation></semantics></math> trajectories <math alttext="\tau_{i}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">τ</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝜏</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\tau_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> that are sampled from the environment via a behavioural policy <math alttext="\pi_{\beta}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">π</mi><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">β</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝜋</ci><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\pi_{\beta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_π start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT</annotation></semantics></math>.
Each trajectory <math alttext="\tau\in\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">τ</mi><mo id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><in id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1"></in><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝜏</ci><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\tau\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_τ ∈ caligraphic_D</annotation></semantics></math> consists of state, action, reward, and return-to-go (RTG) quadruplets <math alttext="\tau_{i}=(s_{0},a_{0},r_{0},\hat{R}_{0},\ldots,s_{T},a_{T},r_{T},\hat{R}_{T})" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.9"><semantics id="S3.SS1.p2.6.m6.9a"><mrow id="S3.SS1.p2.6.m6.9.9" xref="S3.SS1.p2.6.m6.9.9.cmml"><msub id="S3.SS1.p2.6.m6.9.9.10" xref="S3.SS1.p2.6.m6.9.9.10.cmml"><mi id="S3.SS1.p2.6.m6.9.9.10.2" xref="S3.SS1.p2.6.m6.9.9.10.2.cmml">τ</mi><mi id="S3.SS1.p2.6.m6.9.9.10.3" xref="S3.SS1.p2.6.m6.9.9.10.3.cmml">i</mi></msub><mo id="S3.SS1.p2.6.m6.9.9.9" xref="S3.SS1.p2.6.m6.9.9.9.cmml">=</mo><mrow id="S3.SS1.p2.6.m6.9.9.8.8" xref="S3.SS1.p2.6.m6.9.9.8.9.cmml"><mo id="S3.SS1.p2.6.m6.9.9.8.8.9" stretchy="false" xref="S3.SS1.p2.6.m6.9.9.8.9.cmml">(</mo><msub id="S3.SS1.p2.6.m6.2.2.1.1.1" xref="S3.SS1.p2.6.m6.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.6.m6.2.2.1.1.1.2" xref="S3.SS1.p2.6.m6.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS1.p2.6.m6.2.2.1.1.1.3" xref="S3.SS1.p2.6.m6.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS1.p2.6.m6.9.9.8.8.10" xref="S3.SS1.p2.6.m6.9.9.8.9.cmml">,</mo><msub id="S3.SS1.p2.6.m6.3.3.2.2.2" xref="S3.SS1.p2.6.m6.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.6.m6.3.3.2.2.2.2" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2.cmml">a</mi><mn id="S3.SS1.p2.6.m6.3.3.2.2.2.3" xref="S3.SS1.p2.6.m6.3.3.2.2.2.3.cmml">0</mn></msub><mo id="S3.SS1.p2.6.m6.9.9.8.8.11" xref="S3.SS1.p2.6.m6.9.9.8.9.cmml">,</mo><msub id="S3.SS1.p2.6.m6.4.4.3.3.3" xref="S3.SS1.p2.6.m6.4.4.3.3.3.cmml"><mi id="S3.SS1.p2.6.m6.4.4.3.3.3.2" xref="S3.SS1.p2.6.m6.4.4.3.3.3.2.cmml">r</mi><mn id="S3.SS1.p2.6.m6.4.4.3.3.3.3" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3.cmml">0</mn></msub><mo id="S3.SS1.p2.6.m6.9.9.8.8.12" xref="S3.SS1.p2.6.m6.9.9.8.9.cmml">,</mo><msub id="S3.SS1.p2.6.m6.5.5.4.4.4" xref="S3.SS1.p2.6.m6.5.5.4.4.4.cmml"><mover accent="true" id="S3.SS1.p2.6.m6.5.5.4.4.4.2" xref="S3.SS1.p2.6.m6.5.5.4.4.4.2.cmml"><mi id="S3.SS1.p2.6.m6.5.5.4.4.4.2.2" xref="S3.SS1.p2.6.m6.5.5.4.4.4.2.2.cmml">R</mi><mo id="S3.SS1.p2.6.m6.5.5.4.4.4.2.1" xref="S3.SS1.p2.6.m6.5.5.4.4.4.2.1.cmml">^</mo></mover><mn id="S3.SS1.p2.6.m6.5.5.4.4.4.3" xref="S3.SS1.p2.6.m6.5.5.4.4.4.3.cmml">0</mn></msub><mo id="S3.SS1.p2.6.m6.9.9.8.8.13" xref="S3.SS1.p2.6.m6.9.9.8.9.cmml">,</mo><mi id="S3.SS1.p2.6.m6.1.1" mathvariant="normal" xref="S3.SS1.p2.6.m6.1.1.cmml">…</mi><mo id="S3.SS1.p2.6.m6.9.9.8.8.14" xref="S3.SS1.p2.6.m6.9.9.8.9.cmml">,</mo><msub id="S3.SS1.p2.6.m6.6.6.5.5.5" xref="S3.SS1.p2.6.m6.6.6.5.5.5.cmml"><mi id="S3.SS1.p2.6.m6.6.6.5.5.5.2" xref="S3.SS1.p2.6.m6.6.6.5.5.5.2.cmml">s</mi><mi id="S3.SS1.p2.6.m6.6.6.5.5.5.3" xref="S3.SS1.p2.6.m6.6.6.5.5.5.3.cmml">T</mi></msub><mo id="S3.SS1.p2.6.m6.9.9.8.8.15" xref="S3.SS1.p2.6.m6.9.9.8.9.cmml">,</mo><msub id="S3.SS1.p2.6.m6.7.7.6.6.6" xref="S3.SS1.p2.6.m6.7.7.6.6.6.cmml"><mi id="S3.SS1.p2.6.m6.7.7.6.6.6.2" xref="S3.SS1.p2.6.m6.7.7.6.6.6.2.cmml">a</mi><mi id="S3.SS1.p2.6.m6.7.7.6.6.6.3" xref="S3.SS1.p2.6.m6.7.7.6.6.6.3.cmml">T</mi></msub><mo id="S3.SS1.p2.6.m6.9.9.8.8.16" xref="S3.SS1.p2.6.m6.9.9.8.9.cmml">,</mo><msub id="S3.SS1.p2.6.m6.8.8.7.7.7" xref="S3.SS1.p2.6.m6.8.8.7.7.7.cmml"><mi id="S3.SS1.p2.6.m6.8.8.7.7.7.2" xref="S3.SS1.p2.6.m6.8.8.7.7.7.2.cmml">r</mi><mi id="S3.SS1.p2.6.m6.8.8.7.7.7.3" xref="S3.SS1.p2.6.m6.8.8.7.7.7.3.cmml">T</mi></msub><mo id="S3.SS1.p2.6.m6.9.9.8.8.17" xref="S3.SS1.p2.6.m6.9.9.8.9.cmml">,</mo><msub id="S3.SS1.p2.6.m6.9.9.8.8.8" xref="S3.SS1.p2.6.m6.9.9.8.8.8.cmml"><mover accent="true" id="S3.SS1.p2.6.m6.9.9.8.8.8.2" xref="S3.SS1.p2.6.m6.9.9.8.8.8.2.cmml"><mi id="S3.SS1.p2.6.m6.9.9.8.8.8.2.2" xref="S3.SS1.p2.6.m6.9.9.8.8.8.2.2.cmml">R</mi><mo id="S3.SS1.p2.6.m6.9.9.8.8.8.2.1" xref="S3.SS1.p2.6.m6.9.9.8.8.8.2.1.cmml">^</mo></mover><mi id="S3.SS1.p2.6.m6.9.9.8.8.8.3" xref="S3.SS1.p2.6.m6.9.9.8.8.8.3.cmml">T</mi></msub><mo id="S3.SS1.p2.6.m6.9.9.8.8.18" stretchy="false" xref="S3.SS1.p2.6.m6.9.9.8.9.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.9b"><apply id="S3.SS1.p2.6.m6.9.9.cmml" xref="S3.SS1.p2.6.m6.9.9"><eq id="S3.SS1.p2.6.m6.9.9.9.cmml" xref="S3.SS1.p2.6.m6.9.9.9"></eq><apply id="S3.SS1.p2.6.m6.9.9.10.cmml" xref="S3.SS1.p2.6.m6.9.9.10"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.9.9.10.1.cmml" xref="S3.SS1.p2.6.m6.9.9.10">subscript</csymbol><ci id="S3.SS1.p2.6.m6.9.9.10.2.cmml" xref="S3.SS1.p2.6.m6.9.9.10.2">𝜏</ci><ci id="S3.SS1.p2.6.m6.9.9.10.3.cmml" xref="S3.SS1.p2.6.m6.9.9.10.3">𝑖</ci></apply><vector id="S3.SS1.p2.6.m6.9.9.8.9.cmml" xref="S3.SS1.p2.6.m6.9.9.8.8"><apply id="S3.SS1.p2.6.m6.2.2.1.1.1.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.6.m6.2.2.1.1.1.2">𝑠</ci><cn id="S3.SS1.p2.6.m6.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.6.m6.2.2.1.1.1.3">0</cn></apply><apply id="S3.SS1.p2.6.m6.3.3.2.2.2.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.6.m6.3.3.2.2.2.2">𝑎</ci><cn id="S3.SS1.p2.6.m6.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p2.6.m6.3.3.2.2.2.3">0</cn></apply><apply id="S3.SS1.p2.6.m6.4.4.3.3.3.cmml" xref="S3.SS1.p2.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.4.4.3.3.3.1.cmml" xref="S3.SS1.p2.6.m6.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.6.m6.4.4.3.3.3.2.cmml" xref="S3.SS1.p2.6.m6.4.4.3.3.3.2">𝑟</ci><cn id="S3.SS1.p2.6.m6.4.4.3.3.3.3.cmml" type="integer" xref="S3.SS1.p2.6.m6.4.4.3.3.3.3">0</cn></apply><apply id="S3.SS1.p2.6.m6.5.5.4.4.4.cmml" xref="S3.SS1.p2.6.m6.5.5.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.5.5.4.4.4.1.cmml" xref="S3.SS1.p2.6.m6.5.5.4.4.4">subscript</csymbol><apply id="S3.SS1.p2.6.m6.5.5.4.4.4.2.cmml" xref="S3.SS1.p2.6.m6.5.5.4.4.4.2"><ci id="S3.SS1.p2.6.m6.5.5.4.4.4.2.1.cmml" xref="S3.SS1.p2.6.m6.5.5.4.4.4.2.1">^</ci><ci id="S3.SS1.p2.6.m6.5.5.4.4.4.2.2.cmml" xref="S3.SS1.p2.6.m6.5.5.4.4.4.2.2">𝑅</ci></apply><cn id="S3.SS1.p2.6.m6.5.5.4.4.4.3.cmml" type="integer" xref="S3.SS1.p2.6.m6.5.5.4.4.4.3">0</cn></apply><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">…</ci><apply id="S3.SS1.p2.6.m6.6.6.5.5.5.cmml" xref="S3.SS1.p2.6.m6.6.6.5.5.5"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.6.6.5.5.5.1.cmml" xref="S3.SS1.p2.6.m6.6.6.5.5.5">subscript</csymbol><ci id="S3.SS1.p2.6.m6.6.6.5.5.5.2.cmml" xref="S3.SS1.p2.6.m6.6.6.5.5.5.2">𝑠</ci><ci id="S3.SS1.p2.6.m6.6.6.5.5.5.3.cmml" xref="S3.SS1.p2.6.m6.6.6.5.5.5.3">𝑇</ci></apply><apply id="S3.SS1.p2.6.m6.7.7.6.6.6.cmml" xref="S3.SS1.p2.6.m6.7.7.6.6.6"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.7.7.6.6.6.1.cmml" xref="S3.SS1.p2.6.m6.7.7.6.6.6">subscript</csymbol><ci id="S3.SS1.p2.6.m6.7.7.6.6.6.2.cmml" xref="S3.SS1.p2.6.m6.7.7.6.6.6.2">𝑎</ci><ci id="S3.SS1.p2.6.m6.7.7.6.6.6.3.cmml" xref="S3.SS1.p2.6.m6.7.7.6.6.6.3">𝑇</ci></apply><apply id="S3.SS1.p2.6.m6.8.8.7.7.7.cmml" xref="S3.SS1.p2.6.m6.8.8.7.7.7"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.8.8.7.7.7.1.cmml" xref="S3.SS1.p2.6.m6.8.8.7.7.7">subscript</csymbol><ci id="S3.SS1.p2.6.m6.8.8.7.7.7.2.cmml" xref="S3.SS1.p2.6.m6.8.8.7.7.7.2">𝑟</ci><ci id="S3.SS1.p2.6.m6.8.8.7.7.7.3.cmml" xref="S3.SS1.p2.6.m6.8.8.7.7.7.3">𝑇</ci></apply><apply id="S3.SS1.p2.6.m6.9.9.8.8.8.cmml" xref="S3.SS1.p2.6.m6.9.9.8.8.8"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.9.9.8.8.8.1.cmml" xref="S3.SS1.p2.6.m6.9.9.8.8.8">subscript</csymbol><apply id="S3.SS1.p2.6.m6.9.9.8.8.8.2.cmml" xref="S3.SS1.p2.6.m6.9.9.8.8.8.2"><ci id="S3.SS1.p2.6.m6.9.9.8.8.8.2.1.cmml" xref="S3.SS1.p2.6.m6.9.9.8.8.8.2.1">^</ci><ci id="S3.SS1.p2.6.m6.9.9.8.8.8.2.2.cmml" xref="S3.SS1.p2.6.m6.9.9.8.8.8.2.2">𝑅</ci></apply><ci id="S3.SS1.p2.6.m6.9.9.8.8.8.3.cmml" xref="S3.SS1.p2.6.m6.9.9.8.8.8.3">𝑇</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.9c">\tau_{i}=(s_{0},a_{0},r_{0},\hat{R}_{0},\ldots,s_{T},a_{T},r_{T},\hat{R}_{T})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.9d">italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ( italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="T" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">italic_T</annotation></semantics></math> represents the length of trajectory <math alttext="\tau_{i}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><msub id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">τ</mi><mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">𝜏</ci><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\tau_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\hat{R}_{t}=\sum_{t^{\prime}=t}^{T}r_{t^{\prime}}" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1"><semantics id="S3.SS1.p2.9.m9.1a"><mrow id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml"><msub id="S3.SS1.p2.9.m9.1.1.2" xref="S3.SS1.p2.9.m9.1.1.2.cmml"><mover accent="true" id="S3.SS1.p2.9.m9.1.1.2.2" xref="S3.SS1.p2.9.m9.1.1.2.2.cmml"><mi id="S3.SS1.p2.9.m9.1.1.2.2.2" xref="S3.SS1.p2.9.m9.1.1.2.2.2.cmml">R</mi><mo id="S3.SS1.p2.9.m9.1.1.2.2.1" xref="S3.SS1.p2.9.m9.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p2.9.m9.1.1.2.3" xref="S3.SS1.p2.9.m9.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p2.9.m9.1.1.1" rspace="0.111em" xref="S3.SS1.p2.9.m9.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.9.m9.1.1.3" xref="S3.SS1.p2.9.m9.1.1.3.cmml"><msubsup id="S3.SS1.p2.9.m9.1.1.3.1" xref="S3.SS1.p2.9.m9.1.1.3.1.cmml"><mo id="S3.SS1.p2.9.m9.1.1.3.1.2.2" xref="S3.SS1.p2.9.m9.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p2.9.m9.1.1.3.1.2.3" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.cmml"><msup id="S3.SS1.p2.9.m9.1.1.3.1.2.3.2" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.2.cmml"><mi id="S3.SS1.p2.9.m9.1.1.3.1.2.3.2.2" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.2.2.cmml">t</mi><mo id="S3.SS1.p2.9.m9.1.1.3.1.2.3.2.3" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.2.3.cmml">′</mo></msup><mo id="S3.SS1.p2.9.m9.1.1.3.1.2.3.1" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.1.cmml">=</mo><mi id="S3.SS1.p2.9.m9.1.1.3.1.2.3.3" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.3.cmml">t</mi></mrow><mi id="S3.SS1.p2.9.m9.1.1.3.1.3" xref="S3.SS1.p2.9.m9.1.1.3.1.3.cmml">T</mi></msubsup><msub id="S3.SS1.p2.9.m9.1.1.3.2" xref="S3.SS1.p2.9.m9.1.1.3.2.cmml"><mi id="S3.SS1.p2.9.m9.1.1.3.2.2" xref="S3.SS1.p2.9.m9.1.1.3.2.2.cmml">r</mi><msup id="S3.SS1.p2.9.m9.1.1.3.2.3" xref="S3.SS1.p2.9.m9.1.1.3.2.3.cmml"><mi id="S3.SS1.p2.9.m9.1.1.3.2.3.2" xref="S3.SS1.p2.9.m9.1.1.3.2.3.2.cmml">t</mi><mo id="S3.SS1.p2.9.m9.1.1.3.2.3.3" xref="S3.SS1.p2.9.m9.1.1.3.2.3.3.cmml">′</mo></msup></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1"><eq id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1.1"></eq><apply id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.2.1.cmml" xref="S3.SS1.p2.9.m9.1.1.2">subscript</csymbol><apply id="S3.SS1.p2.9.m9.1.1.2.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2.2"><ci id="S3.SS1.p2.9.m9.1.1.2.2.1.cmml" xref="S3.SS1.p2.9.m9.1.1.2.2.1">^</ci><ci id="S3.SS1.p2.9.m9.1.1.2.2.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2.2.2">𝑅</ci></apply><ci id="S3.SS1.p2.9.m9.1.1.2.3.cmml" xref="S3.SS1.p2.9.m9.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3"><apply id="S3.SS1.p2.9.m9.1.1.3.1.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.3.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1">superscript</csymbol><apply id="S3.SS1.p2.9.m9.1.1.3.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.3.1.2.1.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1">subscript</csymbol><sum id="S3.SS1.p2.9.m9.1.1.3.1.2.2.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1.2.2"></sum><apply id="S3.SS1.p2.9.m9.1.1.3.1.2.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3"><eq id="S3.SS1.p2.9.m9.1.1.3.1.2.3.1.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.1"></eq><apply id="S3.SS1.p2.9.m9.1.1.3.1.2.3.2.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.3.1.2.3.2.1.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.2">superscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.3.1.2.3.2.2.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.2.2">𝑡</ci><ci id="S3.SS1.p2.9.m9.1.1.3.1.2.3.2.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.2.3">′</ci></apply><ci id="S3.SS1.p2.9.m9.1.1.3.1.2.3.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1.2.3.3">𝑡</ci></apply></apply><ci id="S3.SS1.p2.9.m9.1.1.3.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1.3">𝑇</ci></apply><apply id="S3.SS1.p2.9.m9.1.1.3.2.cmml" xref="S3.SS1.p2.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.3.2.1.cmml" xref="S3.SS1.p2.9.m9.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.3.2.2.cmml" xref="S3.SS1.p2.9.m9.1.1.3.2.2">𝑟</ci><apply id="S3.SS1.p2.9.m9.1.1.3.2.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.3.2.3.1.cmml" xref="S3.SS1.p2.9.m9.1.1.3.2.3">superscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.3.2.3.2.cmml" xref="S3.SS1.p2.9.m9.1.1.3.2.3.2">𝑡</ci><ci id="S3.SS1.p2.9.m9.1.1.3.2.3.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3.2.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">\hat{R}_{t}=\sum_{t^{\prime}=t}^{T}r_{t^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.1d">over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.
The DT <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1"><semantics id="S3.SS1.p2.10.m10.1a"><msub id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2" xref="S3.SS1.p2.10.m10.1.1.2.cmml">π</mi><mi id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2">𝜋</ci><ci id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m10.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is trained to predict the ground truth action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m11.1"><semantics id="S3.SS1.p2.11.m11.1a"><msub id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><mi id="S3.SS1.p2.11.m11.1.1.2" xref="S3.SS1.p2.11.m11.1.1.2.cmml">a</mi><mi id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2">𝑎</ci><ci id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m11.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> conditioned on sub-trajectories via cross-entropy or mean-squared error loss, depending on the domain:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="a_{t}\sim\pi_{\theta}(a_{t}\mid s_{t-C:t},\hat{R}_{t-C:t},a_{t-C:t-1},r_{t-C:t%
-1})," class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">a</mi><mi id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">∼</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.3.2.cmml">π</mi><mi id="S3.E1.m1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.6" xref="S3.E1.m1.1.1.1.1.1.1.1.1.6.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.6.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.6.2.cmml">a</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.6.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.6.3.cmml">t</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.5" xref="S3.E1.m1.1.1.1.1.1.1.1.1.5.cmml">∣</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.5.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">−</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">C</mi></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.5" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">R</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.1.cmml">−</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.3.cmml">C</mi></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml">:</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">t</mi></mrow></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.6" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">a</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.1.cmml">−</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.3.cmml">C</mi></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml">:</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.1.cmml">−</mo><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.7" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.2.cmml">r</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.1.cmml">−</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.3.cmml">C</mi></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.1.cmml">:</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.1.cmml">−</mo><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2">similar-to</csymbol><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2">𝑎</ci><ci id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.3.2">𝜋</ci><ci id="S3.E1.m1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.5">conditional</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.6.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.6.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.6.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.6.2">𝑎</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.6.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.6.3">𝑡</ci></apply><list id="S3.E1.m1.1.1.1.1.1.1.1.1.4.5.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1">:</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑡</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝐶</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2"><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝑅</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3"><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.1">:</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.2">𝑡</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.2.3">𝐶</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.3.3">𝑡</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.2">𝑎</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3"><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.1">:</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.2">𝑡</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.2.3">𝐶</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.2">𝑡</ci><cn id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.2">𝑟</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3"><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.1">:</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.2">𝑡</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.2.3">𝐶</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.2">𝑡</ci><cn id="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.1.1.4.4.4.3.3.3">1</cn></apply></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">a_{t}\sim\pi_{\theta}(a_{t}\mid s_{t-C:t},\hat{R}_{t-C:t},a_{t-C:t-1},r_{t-C:t%
-1}),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_s start_POSTSUBSCRIPT italic_t - italic_C : italic_t end_POSTSUBSCRIPT , over^ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_t - italic_C : italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t - italic_C : italic_t - 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_t - italic_C : italic_t - 1 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.12">where <math alttext="C\leq T" class="ltx_Math" display="inline" id="S3.SS1.p2.12.m1.1"><semantics id="S3.SS1.p2.12.m1.1a"><mrow id="S3.SS1.p2.12.m1.1.1" xref="S3.SS1.p2.12.m1.1.1.cmml"><mi id="S3.SS1.p2.12.m1.1.1.2" xref="S3.SS1.p2.12.m1.1.1.2.cmml">C</mi><mo id="S3.SS1.p2.12.m1.1.1.1" xref="S3.SS1.p2.12.m1.1.1.1.cmml">≤</mo><mi id="S3.SS1.p2.12.m1.1.1.3" xref="S3.SS1.p2.12.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m1.1b"><apply id="S3.SS1.p2.12.m1.1.1.cmml" xref="S3.SS1.p2.12.m1.1.1"><leq id="S3.SS1.p2.12.m1.1.1.1.cmml" xref="S3.SS1.p2.12.m1.1.1.1"></leq><ci id="S3.SS1.p2.12.m1.1.1.2.cmml" xref="S3.SS1.p2.12.m1.1.1.2">𝐶</ci><ci id="S3.SS1.p2.12.m1.1.1.3.cmml" xref="S3.SS1.p2.12.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m1.1c">C\leq T</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.12.m1.1d">italic_C ≤ italic_T</annotation></semantics></math> is the context length.
During inference, the DT is conditioned on a high RTG to produce a likely sequence of actions that yields high reward behaviour.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Retrieval-augmented Decision Transformer (RA-DT)</h3>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="201" id="S3.F2.g1" src="extracted/5911726/figures/reweighting.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Illustration of <span class="ltx_text ltx_font_bold" id="S3.F2.14.1">experience reweighting</span>. Given a query trajectory, we retrieve the top <math alttext="l&gt;k" class="ltx_Math" display="inline" id="S3.F2.6.m1.1"><semantics id="S3.F2.6.m1.1b"><mrow id="S3.F2.6.m1.1.1" xref="S3.F2.6.m1.1.1.cmml"><mi id="S3.F2.6.m1.1.1.2" xref="S3.F2.6.m1.1.1.2.cmml">l</mi><mo id="S3.F2.6.m1.1.1.1" xref="S3.F2.6.m1.1.1.1.cmml">&gt;</mo><mi id="S3.F2.6.m1.1.1.3" xref="S3.F2.6.m1.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.6.m1.1c"><apply id="S3.F2.6.m1.1.1.cmml" xref="S3.F2.6.m1.1.1"><gt id="S3.F2.6.m1.1.1.1.cmml" xref="S3.F2.6.m1.1.1.1"></gt><ci id="S3.F2.6.m1.1.1.2.cmml" xref="S3.F2.6.m1.1.1.2">𝑙</ci><ci id="S3.F2.6.m1.1.1.3.cmml" xref="S3.F2.6.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.m1.1d">l&gt;k</annotation><annotation encoding="application/x-llamapun" id="S3.F2.6.m1.1e">italic_l &gt; italic_k</annotation></semantics></math> most <span class="ltx_text ltx_font_italic" id="S3.F2.15.2">relevant</span> experiences by maximum inner product search. Each experience has an associated task ID, and return, based on which we compute their <span class="ltx_text ltx_font_italic" id="S3.F2.16.3">utility</span>. We reweight by <math alttext="s_{rel}" class="ltx_Math" display="inline" id="S3.F2.7.m2.1"><semantics id="S3.F2.7.m2.1b"><msub id="S3.F2.7.m2.1.1" xref="S3.F2.7.m2.1.1.cmml"><mi id="S3.F2.7.m2.1.1.2" xref="S3.F2.7.m2.1.1.2.cmml">s</mi><mrow id="S3.F2.7.m2.1.1.3" xref="S3.F2.7.m2.1.1.3.cmml"><mi id="S3.F2.7.m2.1.1.3.2" xref="S3.F2.7.m2.1.1.3.2.cmml">r</mi><mo id="S3.F2.7.m2.1.1.3.1" xref="S3.F2.7.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.F2.7.m2.1.1.3.3" xref="S3.F2.7.m2.1.1.3.3.cmml">e</mi><mo id="S3.F2.7.m2.1.1.3.1b" xref="S3.F2.7.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.F2.7.m2.1.1.3.4" xref="S3.F2.7.m2.1.1.3.4.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F2.7.m2.1c"><apply id="S3.F2.7.m2.1.1.cmml" xref="S3.F2.7.m2.1.1"><csymbol cd="ambiguous" id="S3.F2.7.m2.1.1.1.cmml" xref="S3.F2.7.m2.1.1">subscript</csymbol><ci id="S3.F2.7.m2.1.1.2.cmml" xref="S3.F2.7.m2.1.1.2">𝑠</ci><apply id="S3.F2.7.m2.1.1.3.cmml" xref="S3.F2.7.m2.1.1.3"><times id="S3.F2.7.m2.1.1.3.1.cmml" xref="S3.F2.7.m2.1.1.3.1"></times><ci id="S3.F2.7.m2.1.1.3.2.cmml" xref="S3.F2.7.m2.1.1.3.2">𝑟</ci><ci id="S3.F2.7.m2.1.1.3.3.cmml" xref="S3.F2.7.m2.1.1.3.3">𝑒</ci><ci id="S3.F2.7.m2.1.1.3.4.cmml" xref="S3.F2.7.m2.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.7.m2.1d">s_{rel}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.7.m2.1e">italic_s start_POSTSUBSCRIPT italic_r italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="s_{u}" class="ltx_Math" display="inline" id="S3.F2.8.m3.1"><semantics id="S3.F2.8.m3.1b"><msub id="S3.F2.8.m3.1.1" xref="S3.F2.8.m3.1.1.cmml"><mi id="S3.F2.8.m3.1.1.2" xref="S3.F2.8.m3.1.1.2.cmml">s</mi><mi id="S3.F2.8.m3.1.1.3" xref="S3.F2.8.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.8.m3.1c"><apply id="S3.F2.8.m3.1.1.cmml" xref="S3.F2.8.m3.1.1"><csymbol cd="ambiguous" id="S3.F2.8.m3.1.1.1.cmml" xref="S3.F2.8.m3.1.1">subscript</csymbol><ci id="S3.F2.8.m3.1.1.2.cmml" xref="S3.F2.8.m3.1.1.2">𝑠</ci><ci id="S3.F2.8.m3.1.1.3.cmml" xref="S3.F2.8.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.8.m3.1d">s_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.8.m3.1e">italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, to obtain the final retrieval score <math alttext="s_{ret}" class="ltx_Math" display="inline" id="S3.F2.9.m4.1"><semantics id="S3.F2.9.m4.1b"><msub id="S3.F2.9.m4.1.1" xref="S3.F2.9.m4.1.1.cmml"><mi id="S3.F2.9.m4.1.1.2" xref="S3.F2.9.m4.1.1.2.cmml">s</mi><mrow id="S3.F2.9.m4.1.1.3" xref="S3.F2.9.m4.1.1.3.cmml"><mi id="S3.F2.9.m4.1.1.3.2" xref="S3.F2.9.m4.1.1.3.2.cmml">r</mi><mo id="S3.F2.9.m4.1.1.3.1" xref="S3.F2.9.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.F2.9.m4.1.1.3.3" xref="S3.F2.9.m4.1.1.3.3.cmml">e</mi><mo id="S3.F2.9.m4.1.1.3.1b" xref="S3.F2.9.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.F2.9.m4.1.1.3.4" xref="S3.F2.9.m4.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F2.9.m4.1c"><apply id="S3.F2.9.m4.1.1.cmml" xref="S3.F2.9.m4.1.1"><csymbol cd="ambiguous" id="S3.F2.9.m4.1.1.1.cmml" xref="S3.F2.9.m4.1.1">subscript</csymbol><ci id="S3.F2.9.m4.1.1.2.cmml" xref="S3.F2.9.m4.1.1.2">𝑠</ci><apply id="S3.F2.9.m4.1.1.3.cmml" xref="S3.F2.9.m4.1.1.3"><times id="S3.F2.9.m4.1.1.3.1.cmml" xref="S3.F2.9.m4.1.1.3.1"></times><ci id="S3.F2.9.m4.1.1.3.2.cmml" xref="S3.F2.9.m4.1.1.3.2">𝑟</ci><ci id="S3.F2.9.m4.1.1.3.3.cmml" xref="S3.F2.9.m4.1.1.3.3">𝑒</ci><ci id="S3.F2.9.m4.1.1.3.4.cmml" xref="S3.F2.9.m4.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.9.m4.1d">s_{ret}</annotation><annotation encoding="application/x-llamapun" id="S3.F2.9.m4.1e">italic_s start_POSTSUBSCRIPT italic_r italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and return the top-<math alttext="k" class="ltx_Math" display="inline" id="S3.F2.10.m5.1"><semantics id="S3.F2.10.m5.1b"><mi id="S3.F2.10.m5.1.1" xref="S3.F2.10.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.F2.10.m5.1c"><ci id="S3.F2.10.m5.1.1.cmml" xref="S3.F2.10.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.10.m5.1d">k</annotation><annotation encoding="application/x-llamapun" id="S3.F2.10.m5.1e">italic_k</annotation></semantics></math> experiences.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Processing long sequences with DTs is computationally expensive due to the quadratic complexity of the Transformer architecture.
To address this challenge, we introduce RA-DT, which equips the DT with an external memory that relies on a vector index for retrieval.
Consequently, RA-DT consists of a parametric and a non-parametric component, reminiscent of complementary learning systems <cite class="ltx_cite ltx_citemacro_citep">[Mcclelland et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib55" title="">1995</a>; Kumaran et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib43" title="">2016</a>]</cite>.
The former is represented by the DT and learns to predict actions conditioned on the future return.
The latter is the retrieval component that searches for relevant experiences, similar to <cite class="ltx_cite ltx_citemacro_citet">Borgeaud et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib6" title="">2022</a>]</cite> (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Vector Index for Retrieval Augmentation</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.13">We aim at augmenting the DT with a vector index (external memory) that allows for retrieval of relevant experiences.
To this end, we build our vector index by leveraging an embedding model <math alttext="g:\tau\mapsto\mathbb{R}^{d_{r}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.1"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><mrow id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml">g</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml">τ</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml">↦</mo><msup id="S3.SS2.SSS1.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.cmml">ℝ</mi><msub id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.3.cmml">r</mi></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1">:</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2">𝑔</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.1">maps-to</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2">𝜏</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2">ℝ</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">g:\tau\mapsto\mathbb{R}^{d_{r}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">italic_g : italic_τ ↦ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> that takes a trajectory <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><mi id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><ci id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">italic_τ</annotation></semantics></math> and returns a vector of size <math alttext="d_{r}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><msub id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml">d</mi><mi id="S3.SS2.SSS1.p1.3.m3.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.2">𝑑</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">d_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">italic_d start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>.
Given a dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m4.1"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><ci id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m4.1d">caligraphic_D</annotation></semantics></math> of trajectories, we obtain a set of key-value pairs of our vector index by embedding all sub-trajectories <math alttext="\tau_{t-C:t}\in\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.5.m5.1"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><mrow id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml"><msub id="S3.SS2.SSS1.p1.5.m5.1.1.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.5.m5.1.1.2.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.2.cmml">τ</mi><mrow id="S3.SS2.SSS1.p1.5.m5.1.1.2.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.cmml"><mrow id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.cmml"><mi id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.2" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.2.cmml">t</mi><mo id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.1.cmml">−</mo><mi id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.3.cmml">C</mi></mrow><mo id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.1.cmml">:</mo><mi id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.3.cmml">t</mi></mrow></msub><mo id="S3.SS2.SSS1.p1.5.m5.1.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.5.m5.1.1.3" xref="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><apply id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1"><in id="S3.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.1"></in><apply id="S3.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.2">𝜏</ci><apply id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3"><ci id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.1">:</ci><apply id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2"><minus id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.1"></minus><ci id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.2.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.2">𝑡</ci><ci id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.2.3">𝐶</ci></apply><ci id="S3.SS2.SSS1.p1.5.m5.1.1.2.3.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.2.3.3">𝑡</ci></apply></apply><ci id="S3.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">\tau_{t-C:t}\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m5.1d">italic_τ start_POSTSUBSCRIPT italic_t - italic_C : italic_t end_POSTSUBSCRIPT ∈ caligraphic_D</annotation></semantics></math> via <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.6.m6.1"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><mrow id="S3.SS2.SSS1.p1.6.m6.1.2" xref="S3.SS2.SSS1.p1.6.m6.1.2.cmml"><mi id="S3.SS2.SSS1.p1.6.m6.1.2.2" xref="S3.SS2.SSS1.p1.6.m6.1.2.2.cmml">g</mi><mo id="S3.SS2.SSS1.p1.6.m6.1.2.1" xref="S3.SS2.SSS1.p1.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.6.m6.1.2.3.2" xref="S3.SS2.SSS1.p1.6.m6.1.2.cmml"><mo id="S3.SS2.SSS1.p1.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p1.6.m6.1.2.cmml">(</mo><mo id="S3.SS2.SSS1.p1.6.m6.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS1.p1.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><apply id="S3.SS2.SSS1.p1.6.m6.1.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.2"><times id="S3.SS2.SSS1.p1.6.m6.1.2.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.2.1"></times><ci id="S3.SS2.SSS1.p1.6.m6.1.2.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.2.2">𝑔</ci><ci id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.6.m6.1d">italic_g ( ⋅ )</annotation></semantics></math> to obtain <math alttext="\mathcal{K}\times\mathcal{V}=\{(g(\tau_{i,t-C:t}),\tau_{i,t-C:t+C})\mid 1\leq i%
\leq|\mathcal{D}|\}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.7.m7.7"><semantics id="S3.SS2.SSS1.p1.7.m7.7a"><mrow id="S3.SS2.SSS1.p1.7.m7.7.7" xref="S3.SS2.SSS1.p1.7.m7.7.7.cmml"><mrow id="S3.SS2.SSS1.p1.7.m7.7.7.4" xref="S3.SS2.SSS1.p1.7.m7.7.7.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.7.m7.7.7.4.2" xref="S3.SS2.SSS1.p1.7.m7.7.7.4.2.cmml">𝒦</mi><mo id="S3.SS2.SSS1.p1.7.m7.7.7.4.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS1.p1.7.m7.7.7.4.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.7.m7.7.7.4.3" xref="S3.SS2.SSS1.p1.7.m7.7.7.4.3.cmml">𝒱</mi></mrow><mo id="S3.SS2.SSS1.p1.7.m7.7.7.3" xref="S3.SS2.SSS1.p1.7.m7.7.7.3.cmml">=</mo><mrow id="S3.SS2.SSS1.p1.7.m7.7.7.2.2" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.3.cmml"><mo id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.3" stretchy="false" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.3.1.cmml">{</mo><mrow id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.3.cmml"><mo id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.3" stretchy="false" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.3.cmml">(</mo><mrow id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.3.cmml">g</mi><mo id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.1.2.cmml">τ</mi><mrow id="S3.SS2.SSS1.p1.7.m7.2.2.2" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.cmml"><mrow id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.1.1.1.1" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.cmml">i</mi><mo id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.2" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.cmml">,</mo><mrow id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.2" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.2.cmml">t</mi><mo id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.1" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.1.cmml">−</mo><mi id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.3" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.3.cmml">C</mi></mrow></mrow><mo id="S3.SS2.SSS1.p1.7.m7.2.2.2.3" lspace="0.278em" rspace="0.278em" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.3.cmml">:</mo><mi id="S3.SS2.SSS1.p1.7.m7.2.2.2.4" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.4.cmml">t</mi></mrow></msub><mo id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.4" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.3.cmml">,</mo><msub id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.2" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.2.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.2.2" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.2.2.cmml">τ</mi><mrow id="S3.SS2.SSS1.p1.7.m7.4.4.2" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.cmml"><mrow id="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.2.2.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.3.3.1.1" xref="S3.SS2.SSS1.p1.7.m7.3.3.1.1.cmml">i</mi><mo id="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.2" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.2.2.cmml">,</mo><mrow id="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.2" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.2.cmml">t</mi><mo id="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.1" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.1.cmml">−</mo><mi id="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.3" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.3.cmml">C</mi></mrow></mrow><mo id="S3.SS2.SSS1.p1.7.m7.4.4.2.3" lspace="0.278em" rspace="0.278em" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.3.cmml">:</mo><mrow id="S3.SS2.SSS1.p1.7.m7.4.4.2.4" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.4.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.4.4.2.4.2" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.4.2.cmml">t</mi><mo id="S3.SS2.SSS1.p1.7.m7.4.4.2.4.1" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.4.1.cmml">+</mo><mi id="S3.SS2.SSS1.p1.7.m7.4.4.2.4.3" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.4.3.cmml">C</mi></mrow></mrow></msub><mo id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.5" stretchy="false" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.3.cmml">)</mo></mrow><mo fence="true" id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.4" lspace="0em" rspace="0em" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.3.1.cmml">∣</mo><mrow id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.cmml"><mn id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.2" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.2.cmml">1</mn><mo id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.3" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.3.cmml">≤</mo><mi id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.4" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.4.cmml">i</mi><mo id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.5" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.5.cmml">≤</mo><mrow id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.6.2" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.6.1.cmml"><mo id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.6.2.1" stretchy="false" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.6.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.7.m7.5.5" xref="S3.SS2.SSS1.p1.7.m7.5.5.cmml">𝒟</mi><mo id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.6.2.2" stretchy="false" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.6.1.1.cmml">|</mo></mrow></mrow><mo id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.5" stretchy="false" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.7.m7.7b"><apply id="S3.SS2.SSS1.p1.7.m7.7.7.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7"><eq id="S3.SS2.SSS1.p1.7.m7.7.7.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.3"></eq><apply id="S3.SS2.SSS1.p1.7.m7.7.7.4.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.4"><times id="S3.SS2.SSS1.p1.7.m7.7.7.4.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.4.1"></times><ci id="S3.SS2.SSS1.p1.7.m7.7.7.4.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.4.2">𝒦</ci><ci id="S3.SS2.SSS1.p1.7.m7.7.7.4.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.4.3">𝒱</ci></apply><apply id="S3.SS2.SSS1.p1.7.m7.7.7.2.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2"><csymbol cd="latexml" id="S3.SS2.SSS1.p1.7.m7.7.7.2.3.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2"><apply id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1"><times id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.2"></times><ci id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.3">𝑔</ci><apply id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.1.1.1.1.1.2">𝜏</ci><apply id="S3.SS2.SSS1.p1.7.m7.2.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2"><ci id="S3.SS2.SSS1.p1.7.m7.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.3">:</ci><list id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1"><ci id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1">𝑖</ci><apply id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1"><minus id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.1"></minus><ci id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.2">𝑡</ci><ci id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.1.1.3">𝐶</ci></apply></list><ci id="S3.SS2.SSS1.p1.7.m7.2.2.2.4.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.4">𝑡</ci></apply></apply></apply><apply id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.6.6.1.1.1.2.2.2">𝜏</ci><apply id="S3.SS2.SSS1.p1.7.m7.4.4.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.2"><ci id="S3.SS2.SSS1.p1.7.m7.4.4.2.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.3">:</ci><list id="S3.SS2.SSS1.p1.7.m7.4.4.2.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1"><ci id="S3.SS2.SSS1.p1.7.m7.3.3.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.3.3.1.1">𝑖</ci><apply id="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1"><minus id="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.1"></minus><ci id="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.2">𝑡</ci><ci id="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.2.1.1.3">𝐶</ci></apply></list><apply id="S3.SS2.SSS1.p1.7.m7.4.4.2.4.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.4"><plus id="S3.SS2.SSS1.p1.7.m7.4.4.2.4.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.4.1"></plus><ci id="S3.SS2.SSS1.p1.7.m7.4.4.2.4.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.4.2">𝑡</ci><ci id="S3.SS2.SSS1.p1.7.m7.4.4.2.4.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.4.4.2.4.3">𝐶</ci></apply></apply></apply></interval><apply id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2"><and id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2a.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2"></and><apply id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2b.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2"><leq id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.3"></leq><cn id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.2.cmml" type="integer" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.2">1</cn><ci id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.4.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.4">𝑖</ci></apply><apply id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2c.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2"><leq id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.5.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.5"></leq><share href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.4.cmml" id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2d.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2"></share><apply id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.6.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.6.2"><abs id="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.6.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.7.7.2.2.2.6.2.1"></abs><ci id="S3.SS2.SSS1.p1.7.m7.5.5.cmml" xref="S3.SS2.SSS1.p1.7.m7.5.5">𝒟</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.7.m7.7c">\mathcal{K}\times\mathcal{V}=\{(g(\tau_{i,t-C:t}),\tau_{i,t-C:t+C})\mid 1\leq i%
\leq|\mathcal{D}|\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.7.m7.7d">caligraphic_K × caligraphic_V = { ( italic_g ( italic_τ start_POSTSUBSCRIPT italic_i , italic_t - italic_C : italic_t end_POSTSUBSCRIPT ) , italic_τ start_POSTSUBSCRIPT italic_i , italic_t - italic_C : italic_t + italic_C end_POSTSUBSCRIPT ) ∣ 1 ≤ italic_i ≤ | caligraphic_D | }</annotation></semantics></math>.
Note that values contain sub-trajectories ranging from <math alttext="t-C" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.8.m8.1"><semantics id="S3.SS2.SSS1.p1.8.m8.1a"><mrow id="S3.SS2.SSS1.p1.8.m8.1.1" xref="S3.SS2.SSS1.p1.8.m8.1.1.cmml"><mi id="S3.SS2.SSS1.p1.8.m8.1.1.2" xref="S3.SS2.SSS1.p1.8.m8.1.1.2.cmml">t</mi><mo id="S3.SS2.SSS1.p1.8.m8.1.1.1" xref="S3.SS2.SSS1.p1.8.m8.1.1.1.cmml">−</mo><mi id="S3.SS2.SSS1.p1.8.m8.1.1.3" xref="S3.SS2.SSS1.p1.8.m8.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.8.m8.1b"><apply id="S3.SS2.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1"><minus id="S3.SS2.SSS1.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.1"></minus><ci id="S3.SS2.SSS1.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.2">𝑡</ci><ci id="S3.SS2.SSS1.p1.8.m8.1.1.3.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.8.m8.1c">t-C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.8.m8.1d">italic_t - italic_C</annotation></semantics></math> to <math alttext="t+C" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.9.m9.1"><semantics id="S3.SS2.SSS1.p1.9.m9.1a"><mrow id="S3.SS2.SSS1.p1.9.m9.1.1" xref="S3.SS2.SSS1.p1.9.m9.1.1.cmml"><mi id="S3.SS2.SSS1.p1.9.m9.1.1.2" xref="S3.SS2.SSS1.p1.9.m9.1.1.2.cmml">t</mi><mo id="S3.SS2.SSS1.p1.9.m9.1.1.1" xref="S3.SS2.SSS1.p1.9.m9.1.1.1.cmml">+</mo><mi id="S3.SS2.SSS1.p1.9.m9.1.1.3" xref="S3.SS2.SSS1.p1.9.m9.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.9.m9.1b"><apply id="S3.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1"><plus id="S3.SS2.SSS1.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.1"></plus><ci id="S3.SS2.SSS1.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.2">𝑡</ci><ci id="S3.SS2.SSS1.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.9.m9.1c">t+C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.9.m9.1d">italic_t + italic_C</annotation></semantics></math>, while keys use sub-trajectories <math alttext="t-C:t" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.10.m10.1"><semantics id="S3.SS2.SSS1.p1.10.m10.1a"><mrow id="S3.SS2.SSS1.p1.10.m10.1.1" xref="S3.SS2.SSS1.p1.10.m10.1.1.cmml"><mrow id="S3.SS2.SSS1.p1.10.m10.1.1.2" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.10.m10.1.1.2.2" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.2.cmml">t</mi><mo id="S3.SS2.SSS1.p1.10.m10.1.1.2.1" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.1.cmml">−</mo><mi id="S3.SS2.SSS1.p1.10.m10.1.1.2.3" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.3.cmml">C</mi></mrow><mo id="S3.SS2.SSS1.p1.10.m10.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.SSS1.p1.10.m10.1.1.1.cmml">:</mo><mi id="S3.SS2.SSS1.p1.10.m10.1.1.3" xref="S3.SS2.SSS1.p1.10.m10.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.10.m10.1b"><apply id="S3.SS2.SSS1.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1"><ci id="S3.SS2.SSS1.p1.10.m10.1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.1">:</ci><apply id="S3.SS2.SSS1.p1.10.m10.1.1.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.2"><minus id="S3.SS2.SSS1.p1.10.m10.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.1"></minus><ci id="S3.SS2.SSS1.p1.10.m10.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.2">𝑡</ci><ci id="S3.SS2.SSS1.p1.10.m10.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.2.3">𝐶</ci></apply><ci id="S3.SS2.SSS1.p1.10.m10.1.1.3.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.10.m10.1c">t-C:t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.10.m10.1d">italic_t - italic_C : italic_t</annotation></semantics></math> for a fixed <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.11.m11.1"><semantics id="S3.SS2.SSS1.p1.11.m11.1a"><mi id="S3.SS2.SSS1.p1.11.m11.1.1" xref="S3.SS2.SSS1.p1.11.m11.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.11.m11.1b"><ci id="S3.SS2.SSS1.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.11.m11.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.11.m11.1d">italic_C</annotation></semantics></math>, where <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.12.m12.1"><semantics id="S3.SS2.SSS1.p1.12.m12.1a"><mi id="S3.SS2.SSS1.p1.12.m12.1.1" xref="S3.SS2.SSS1.p1.12.m12.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.12.m12.1b"><ci id="S3.SS2.SSS1.p1.12.m12.1.1.cmml" xref="S3.SS2.SSS1.p1.12.m12.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.12.m12.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.12.m12.1d">italic_t</annotation></semantics></math> goes over trajectory length in increments of <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.13.m13.1"><semantics id="S3.SS2.SSS1.p1.13.m13.1a"><mi id="S3.SS2.SSS1.p1.13.m13.1.1" xref="S3.SS2.SSS1.p1.13.m13.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.13.m13.1b"><ci id="S3.SS2.SSS1.p1.13.m13.1.1.cmml" xref="S3.SS2.SSS1.p1.13.m13.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.13.m13.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.13.m13.1d">italic_C</annotation></semantics></math> (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS4" title="C.4 Retrieval-Augmented Decision Transformer ‣ Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">C.4</span></a> for more details).
The reason for this choice is that during inference, the model does not have access to future states.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.10">In RAG applications for Natural Language Processing (NLP), a common choice for <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.1.m1.1"><semantics id="S3.SS2.SSS1.p2.1.m1.1a"><mrow id="S3.SS2.SSS1.p2.1.m1.1.2" xref="S3.SS2.SSS1.p2.1.m1.1.2.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.2.2" xref="S3.SS2.SSS1.p2.1.m1.1.2.2.cmml">g</mi><mo id="S3.SS2.SSS1.p2.1.m1.1.2.1" xref="S3.SS2.SSS1.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p2.1.m1.1.2.3.2" xref="S3.SS2.SSS1.p2.1.m1.1.2.cmml"><mo id="S3.SS2.SSS1.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p2.1.m1.1.2.cmml">(</mo><mo id="S3.SS2.SSS1.p2.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS1.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b"><apply id="S3.SS2.SSS1.p2.1.m1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.2"><times id="S3.SS2.SSS1.p2.1.m1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.2.1"></times><ci id="S3.SS2.SSS1.p2.1.m1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.2.2">𝑔</ci><ci id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.1.m1.1d">italic_g ( ⋅ )</annotation></semantics></math> is a pre-trained LM.
While pre-trained models in NLP are ubiquitous, they are rarely available in RL.
A natural choice to instantiate <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.2.m2.1"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><mrow id="S3.SS2.SSS1.p2.2.m2.1.2" xref="S3.SS2.SSS1.p2.2.m2.1.2.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.2.2" xref="S3.SS2.SSS1.p2.2.m2.1.2.2.cmml">g</mi><mo id="S3.SS2.SSS1.p2.2.m2.1.2.1" xref="S3.SS2.SSS1.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p2.2.m2.1.2.3.2" xref="S3.SS2.SSS1.p2.2.m2.1.2.cmml"><mo id="S3.SS2.SSS1.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p2.2.m2.1.2.cmml">(</mo><mo id="S3.SS2.SSS1.p2.2.m2.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS1.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><apply id="S3.SS2.SSS1.p2.2.m2.1.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.2"><times id="S3.SS2.SSS1.p2.2.m2.1.2.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.2.1"></times><ci id="S3.SS2.SSS1.p2.2.m2.1.2.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.2.2">𝑔</ci><ci id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.2.m2.1d">italic_g ( ⋅ )</annotation></semantics></math> is to train a DT on the pre-collected dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.3.m3.1"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><ci id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.3.m3.1d">caligraphic_D</annotation></semantics></math>, as they exhibit a well-separated embedding space after pre-training <cite class="ltx_cite ltx_citemacro_citep">[Schmied et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib81" title="">2023</a>]</cite>.
Therefore, they are well suited for retrieval since a new task can be matched to similar tasks in the vector index.
As a domain-agnostic alternative, we propose to utilize the FrozenHopfield (FH) mechanism <cite class="ltx_cite ltx_citemacro_citet">Paischer et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib61" title="">2022</a>]</cite> to map trajectories to the embedding space of a pre-trained LM.
This enables instantiating <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.4.m4.1"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><mrow id="S3.SS2.SSS1.p2.4.m4.1.2" xref="S3.SS2.SSS1.p2.4.m4.1.2.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.2.2" xref="S3.SS2.SSS1.p2.4.m4.1.2.2.cmml">g</mi><mo id="S3.SS2.SSS1.p2.4.m4.1.2.1" xref="S3.SS2.SSS1.p2.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p2.4.m4.1.2.3.2" xref="S3.SS2.SSS1.p2.4.m4.1.2.cmml"><mo id="S3.SS2.SSS1.p2.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p2.4.m4.1.2.cmml">(</mo><mo id="S3.SS2.SSS1.p2.4.m4.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS1.p2.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><apply id="S3.SS2.SSS1.p2.4.m4.1.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.2"><times id="S3.SS2.SSS1.p2.4.m4.1.2.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.2.1"></times><ci id="S3.SS2.SSS1.p2.4.m4.1.2.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.2.2">𝑔</ci><ci id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.4.m4.1d">italic_g ( ⋅ )</annotation></semantics></math> with a pre-trained language encoder.
The FH mechanism is parameterized by an embedding matrix <math alttext="\bm{E}\in\mathbb{R}^{v\times d_{\text{LM}}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.5.m5.1"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><mrow id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p2.5.m5.1.1.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.2.cmml">𝑬</mi><mo id="S3.SS2.SSS1.p2.5.m5.1.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p2.5.m5.1.1.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.5.m5.1.1.3.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS1.p2.5.m5.1.1.3.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.2.cmml">v</mi><mo id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.2.cmml">d</mi><mtext id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.3a.cmml">LM</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><apply id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1"><in id="S3.SS2.SSS1.p2.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1"></in><ci id="S3.SS2.SSS1.p2.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.2">𝑬</ci><apply id="S3.SS2.SSS1.p2.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3"><times id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.1"></times><ci id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.2">𝑣</ci><apply id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.3a.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.3"><mtext id="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.3.cmml" mathsize="50%" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.3.3.3">LM</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">\bm{E}\in\mathbb{R}^{v\times d_{\text{LM}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.5.m5.1d">bold_italic_E ∈ blackboard_R start_POSTSUPERSCRIPT italic_v × italic_d start_POSTSUBSCRIPT LM end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> of a pretrained LM with vocabulary size <math alttext="v" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.6.m6.1"><semantics id="S3.SS2.SSS1.p2.6.m6.1a"><mi id="S3.SS2.SSS1.p2.6.m6.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m6.1b"><ci id="S3.SS2.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m6.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.6.m6.1d">italic_v</annotation></semantics></math> and hidden dimension <math alttext="d_{\text{LM}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.7.m7.1"><semantics id="S3.SS2.SSS1.p2.7.m7.1a"><msub id="S3.SS2.SSS1.p2.7.m7.1.1" xref="S3.SS2.SSS1.p2.7.m7.1.1.cmml"><mi id="S3.SS2.SSS1.p2.7.m7.1.1.2" xref="S3.SS2.SSS1.p2.7.m7.1.1.2.cmml">d</mi><mtext id="S3.SS2.SSS1.p2.7.m7.1.1.3" xref="S3.SS2.SSS1.p2.7.m7.1.1.3a.cmml">LM</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.7.m7.1b"><apply id="S3.SS2.SSS1.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.7.m7.1.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.7.m7.1.1.2.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1.2">𝑑</ci><ci id="S3.SS2.SSS1.p2.7.m7.1.1.3a.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1.3"><mtext id="S3.SS2.SSS1.p2.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS1.p2.7.m7.1.1.3">LM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.7.m7.1c">d_{\text{LM}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.7.m7.1d">italic_d start_POSTSUBSCRIPT LM end_POSTSUBSCRIPT</annotation></semantics></math>, a random matrix <math alttext="\bm{P}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.8.m8.1"><semantics id="S3.SS2.SSS1.p2.8.m8.1a"><mi id="S3.SS2.SSS1.p2.8.m8.1.1" xref="S3.SS2.SSS1.p2.8.m8.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.8.m8.1b"><ci id="S3.SS2.SSS1.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m8.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.8.m8.1c">\bm{P}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.8.m8.1d">bold_italic_P</annotation></semantics></math> with entries sampled from <math alttext="\mathcal{N}(0,d_{\text{in}}/d_{\text{LM}})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.9.m9.2"><semantics id="S3.SS2.SSS1.p2.9.m9.2a"><mrow id="S3.SS2.SSS1.p2.9.m9.2.2" xref="S3.SS2.SSS1.p2.9.m9.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.9.m9.2.2.3" xref="S3.SS2.SSS1.p2.9.m9.2.2.3.cmml">𝒩</mi><mo id="S3.SS2.SSS1.p2.9.m9.2.2.2" xref="S3.SS2.SSS1.p2.9.m9.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p2.9.m9.2.2.1.1" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.2.cmml"><mo id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.2.cmml">(</mo><mn id="S3.SS2.SSS1.p2.9.m9.1.1" xref="S3.SS2.SSS1.p2.9.m9.1.1.cmml">0</mn><mo id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.3" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.2.cmml">,</mo><mrow id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.cmml"><msub id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.2" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.2.cmml">d</mi><mtext id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.3" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.3a.cmml">in</mtext></msub><mo id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.1" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.1.cmml">/</mo><msub id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.2" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.2.cmml">d</mi><mtext id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.3" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.3a.cmml">LM</mtext></msub></mrow><mo id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.4" stretchy="false" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.9.m9.2b"><apply id="S3.SS2.SSS1.p2.9.m9.2.2.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2"><times id="S3.SS2.SSS1.p2.9.m9.2.2.2.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.2"></times><ci id="S3.SS2.SSS1.p2.9.m9.2.2.3.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.3">𝒩</ci><interval closure="open" id="S3.SS2.SSS1.p2.9.m9.2.2.1.2.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1"><cn id="S3.SS2.SSS1.p2.9.m9.1.1.cmml" type="integer" xref="S3.SS2.SSS1.p2.9.m9.1.1">0</cn><apply id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1"><divide id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.1"></divide><apply id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.2">𝑑</ci><ci id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.3a.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.3"><mtext id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.2.3">in</mtext></ci></apply><apply id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.2">𝑑</ci><ci id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.3a.cmml" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.3"><mtext id="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.3.cmml" mathsize="70%" xref="S3.SS2.SSS1.p2.9.m9.2.2.1.1.1.3.3">LM</mtext></ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.9.m9.2c">\mathcal{N}(0,d_{\text{in}}/d_{\text{LM}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.9.m9.2d">caligraphic_N ( 0 , italic_d start_POSTSUBSCRIPT in end_POSTSUBSCRIPT / italic_d start_POSTSUBSCRIPT LM end_POSTSUBSCRIPT )</annotation></semantics></math>, and a scaling factor <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.10.m10.1"><semantics id="S3.SS2.SSS1.p2.10.m10.1a"><mi id="S3.SS2.SSS1.p2.10.m10.1.1" xref="S3.SS2.SSS1.p2.10.m10.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.10.m10.1b"><ci id="S3.SS2.SSS1.p2.10.m10.1.1.cmml" xref="S3.SS2.SSS1.p2.10.m10.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.10.m10.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.10.m10.1d">italic_β</annotation></semantics></math> and performs:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{FH}(\bm{x}_{t})=\bm{E}^{\top}\operatorname{softmax}(\beta\bm{E}%
\bm{P}\bm{x}_{t})." class="ltx_Math" display="block" id="S3.E2.m1.3"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">FH</mi><mo id="S3.E2.m1.3.3.1.1.1.1a" xref="S3.E2.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.2.cmml"><mo id="S3.E2.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.2.cmml">(</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E2.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><msup id="S3.E2.m1.3.3.1.1.2.3" xref="S3.E2.m1.3.3.1.1.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.2.3.2" xref="S3.E2.m1.3.3.1.1.2.3.2.cmml">𝑬</mi><mo id="S3.E2.m1.3.3.1.1.2.3.3" xref="S3.E2.m1.3.3.1.1.2.3.3.cmml">⊤</mo></msup><mo id="S3.E2.m1.3.3.1.1.2.2" lspace="0.167em" xref="S3.E2.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.2.1.1" xref="S3.E2.m1.3.3.1.1.2.1.2.cmml"><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">softmax</mi><mo id="S3.E2.m1.3.3.1.1.2.1.1a" xref="S3.E2.m1.3.3.1.1.2.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.3.3.1.1.2.1.1.1" xref="S3.E2.m1.3.3.1.1.2.1.2.cmml"><mo id="S3.E2.m1.3.3.1.1.2.1.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.2.1.2.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.2.1.1.1.1" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.2.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.2.cmml">β</mi><mo id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.1.1.2.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.cmml">𝑬</mi><mo id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1a" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.1.1.2.1.1.1.1.4" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.4.cmml">𝑷</mi><mo id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1b" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E2.m1.3.3.1.1.2.1.1.1.1.5" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.5.cmml"><mi id="S3.E2.m1.3.3.1.1.2.1.1.1.1.5.2" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.5.2.cmml">𝒙</mi><mi id="S3.E2.m1.3.3.1.1.2.1.1.1.1.5.3" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.5.3.cmml">t</mi></msub></mrow><mo id="S3.E2.m1.3.3.1.1.2.1.1.1.3" stretchy="false" xref="S3.E2.m1.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" lspace="0em" xref="S3.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"></eq><apply id="S3.E2.m1.3.3.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">FH</ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><times id="S3.E2.m1.3.3.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2"></times><apply id="S3.E2.m1.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.2.3">superscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.2.3.2">𝑬</ci><csymbol cd="latexml" id="S3.E2.m1.3.3.1.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3.3">top</csymbol></apply><apply id="S3.E2.m1.3.3.1.1.2.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1"><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">softmax</ci><apply id="S3.E2.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1"><times id="S3.E2.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.1"></times><ci id="S3.E2.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.2">𝛽</ci><ci id="S3.E2.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.3">𝑬</ci><ci id="S3.E2.m1.3.3.1.1.2.1.1.1.1.4.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.4">𝑷</ci><apply id="S3.E2.m1.3.3.1.1.2.1.1.1.1.5.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.1.1.1.1.5.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.5">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.1.1.1.1.5.2.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.5.2">𝒙</ci><ci id="S3.E2.m1.3.3.1.1.2.1.1.1.1.5.3.cmml" xref="S3.E2.m1.3.3.1.1.2.1.1.1.1.5.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\operatorname{FH}(\bm{x}_{t})=\bm{E}^{\top}\operatorname{softmax}(\beta\bm{E}%
\bm{P}\bm{x}_{t}).</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">roman_FH ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = bold_italic_E start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT roman_softmax ( italic_β bold_italic_E bold_italic_P bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS1.p2.13">We denote <math alttext="\bm{x}_{t}\in\mathbb{R}^{d_{\text{in}}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.11.m1.1"><semantics id="S3.SS2.SSS1.p2.11.m1.1a"><mrow id="S3.SS2.SSS1.p2.11.m1.1.1" xref="S3.SS2.SSS1.p2.11.m1.1.1.cmml"><msub id="S3.SS2.SSS1.p2.11.m1.1.1.2" xref="S3.SS2.SSS1.p2.11.m1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p2.11.m1.1.1.2.2" xref="S3.SS2.SSS1.p2.11.m1.1.1.2.2.cmml">𝒙</mi><mi id="S3.SS2.SSS1.p2.11.m1.1.1.2.3" xref="S3.SS2.SSS1.p2.11.m1.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.p2.11.m1.1.1.1" xref="S3.SS2.SSS1.p2.11.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p2.11.m1.1.1.3" xref="S3.SS2.SSS1.p2.11.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.11.m1.1.1.3.2" xref="S3.SS2.SSS1.p2.11.m1.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS2.SSS1.p2.11.m1.1.1.3.3" xref="S3.SS2.SSS1.p2.11.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p2.11.m1.1.1.3.3.2" xref="S3.SS2.SSS1.p2.11.m1.1.1.3.3.2.cmml">d</mi><mtext id="S3.SS2.SSS1.p2.11.m1.1.1.3.3.3" xref="S3.SS2.SSS1.p2.11.m1.1.1.3.3.3a.cmml">in</mtext></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.11.m1.1b"><apply id="S3.SS2.SSS1.p2.11.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1"><in id="S3.SS2.SSS1.p2.11.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.1"></in><apply id="S3.SS2.SSS1.p2.11.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.11.m1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p2.11.m1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.2.2">𝒙</ci><ci id="S3.SS2.SSS1.p2.11.m1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS1.p2.11.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.11.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p2.11.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS1.p2.11.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.11.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.11.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.3.3.2">𝑑</ci><ci id="S3.SS2.SSS1.p2.11.m1.1.1.3.3.3a.cmml" xref="S3.SS2.SSS1.p2.11.m1.1.1.3.3.3"><mtext id="S3.SS2.SSS1.p2.11.m1.1.1.3.3.3.cmml" mathsize="50%" xref="S3.SS2.SSS1.p2.11.m1.1.1.3.3.3">in</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.11.m1.1c">\bm{x}_{t}\in\mathbb{R}^{d_{\text{in}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.11.m1.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as the input token and apply the FH position-wise to every state/action/reward token in a sub-trajectory <math alttext="\tau_{t-C:t}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.12.m2.1"><semantics id="S3.SS2.SSS1.p2.12.m2.1a"><msub id="S3.SS2.SSS1.p2.12.m2.1.1" xref="S3.SS2.SSS1.p2.12.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p2.12.m2.1.1.2" xref="S3.SS2.SSS1.p2.12.m2.1.1.2.cmml">τ</mi><mrow id="S3.SS2.SSS1.p2.12.m2.1.1.3" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.cmml"><mrow id="S3.SS2.SSS1.p2.12.m2.1.1.3.2" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.2.cmml"><mi id="S3.SS2.SSS1.p2.12.m2.1.1.3.2.2" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.2.2.cmml">t</mi><mo id="S3.SS2.SSS1.p2.12.m2.1.1.3.2.1" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.2.1.cmml">−</mo><mi id="S3.SS2.SSS1.p2.12.m2.1.1.3.2.3" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.2.3.cmml">C</mi></mrow><mo id="S3.SS2.SSS1.p2.12.m2.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.1.cmml">:</mo><mi id="S3.SS2.SSS1.p2.12.m2.1.1.3.3" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.12.m2.1b"><apply id="S3.SS2.SSS1.p2.12.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.12.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.12.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.12.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.12.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p2.12.m2.1.1.2">𝜏</ci><apply id="S3.SS2.SSS1.p2.12.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p2.12.m2.1.1.3"><ci id="S3.SS2.SSS1.p2.12.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.1">:</ci><apply id="S3.SS2.SSS1.p2.12.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.2"><minus id="S3.SS2.SSS1.p2.12.m2.1.1.3.2.1.cmml" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.2.1"></minus><ci id="S3.SS2.SSS1.p2.12.m2.1.1.3.2.2.cmml" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.2.2">𝑡</ci><ci id="S3.SS2.SSS1.p2.12.m2.1.1.3.2.3.cmml" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.2.3">𝐶</ci></apply><ci id="S3.SS2.SSS1.p2.12.m2.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.12.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.12.m2.1c">\tau_{t-C:t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.12.m2.1d">italic_τ start_POSTSUBSCRIPT italic_t - italic_C : italic_t end_POSTSUBSCRIPT</annotation></semantics></math> separately.
Finally, we apply a LM on top of the FH to obtain the keys of our vector index by setting <math alttext="g(\cdot)=\operatorname{LM}(\operatorname{FH}(\cdot))" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.13.m3.5"><semantics id="S3.SS2.SSS1.p2.13.m3.5a"><mrow id="S3.SS2.SSS1.p2.13.m3.5.5" xref="S3.SS2.SSS1.p2.13.m3.5.5.cmml"><mrow id="S3.SS2.SSS1.p2.13.m3.5.5.3" xref="S3.SS2.SSS1.p2.13.m3.5.5.3.cmml"><mi id="S3.SS2.SSS1.p2.13.m3.5.5.3.2" xref="S3.SS2.SSS1.p2.13.m3.5.5.3.2.cmml">g</mi><mo id="S3.SS2.SSS1.p2.13.m3.5.5.3.1" xref="S3.SS2.SSS1.p2.13.m3.5.5.3.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p2.13.m3.5.5.3.3.2" xref="S3.SS2.SSS1.p2.13.m3.5.5.3.cmml"><mo id="S3.SS2.SSS1.p2.13.m3.5.5.3.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p2.13.m3.5.5.3.cmml">(</mo><mo id="S3.SS2.SSS1.p2.13.m3.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS1.p2.13.m3.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS1.p2.13.m3.5.5.3.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p2.13.m3.5.5.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS1.p2.13.m3.5.5.2" xref="S3.SS2.SSS1.p2.13.m3.5.5.2.cmml">=</mo><mrow id="S3.SS2.SSS1.p2.13.m3.5.5.1.1" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.2.cmml"><mi id="S3.SS2.SSS1.p2.13.m3.4.4" xref="S3.SS2.SSS1.p2.13.m3.4.4.cmml">LM</mi><mo id="S3.SS2.SSS1.p2.13.m3.5.5.1.1a" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.2.cmml">⁡</mo><mrow id="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.2.cmml"><mo id="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.2.cmml">(</mo><mrow id="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.2" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.13.m3.2.2" xref="S3.SS2.SSS1.p2.13.m3.2.2.cmml">FH</mi><mo id="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.2a" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.1.cmml">⁡</mo><mrow id="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.2.1" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.2.1.1" stretchy="false" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.1.cmml">(</mo><mo id="S3.SS2.SSS1.p2.13.m3.3.3" lspace="0em" rspace="0em" xref="S3.SS2.SSS1.p2.13.m3.3.3.cmml">⋅</mo><mo id="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.2.1.2" stretchy="false" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.13.m3.5b"><apply id="S3.SS2.SSS1.p2.13.m3.5.5.cmml" xref="S3.SS2.SSS1.p2.13.m3.5.5"><eq id="S3.SS2.SSS1.p2.13.m3.5.5.2.cmml" xref="S3.SS2.SSS1.p2.13.m3.5.5.2"></eq><apply id="S3.SS2.SSS1.p2.13.m3.5.5.3.cmml" xref="S3.SS2.SSS1.p2.13.m3.5.5.3"><times id="S3.SS2.SSS1.p2.13.m3.5.5.3.1.cmml" xref="S3.SS2.SSS1.p2.13.m3.5.5.3.1"></times><ci id="S3.SS2.SSS1.p2.13.m3.5.5.3.2.cmml" xref="S3.SS2.SSS1.p2.13.m3.5.5.3.2">𝑔</ci><ci id="S3.SS2.SSS1.p2.13.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.13.m3.1.1">⋅</ci></apply><apply id="S3.SS2.SSS1.p2.13.m3.5.5.1.2.cmml" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.1"><ci id="S3.SS2.SSS1.p2.13.m3.4.4.cmml" xref="S3.SS2.SSS1.p2.13.m3.4.4">LM</ci><apply id="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.13.m3.5.5.1.1.1.1.2"><ci id="S3.SS2.SSS1.p2.13.m3.2.2.cmml" xref="S3.SS2.SSS1.p2.13.m3.2.2">FH</ci><ci id="S3.SS2.SSS1.p2.13.m3.3.3.cmml" xref="S3.SS2.SSS1.p2.13.m3.3.3">⋅</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.13.m3.5c">g(\cdot)=\operatorname{LM}(\operatorname{FH}(\cdot))</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.13.m3.5d">italic_g ( ⋅ ) = roman_LM ( roman_FH ( ⋅ ) )</annotation></semantics></math>.
Utilizing the FH enables leveraging the expressive power of pre-trained LMs as trajectory encoders for RL.
This sidesteps the need for pre-training a domain-specific model and can be incorporated in any existing retrieval-augmentation pipeline.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Searching for Similar Experiences</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.7">Given an input sub-trajectory <math alttext="\tau_{\text{in}}\in\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><mrow id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><msub id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.2.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.2.cmml">τ</mi><mtext id="S3.SS2.SSS2.p1.1.m1.1.1.2.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.3a.cmml">in</mtext></msub><mo id="S3.SS2.SSS2.p1.1.m1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><in id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1"></in><apply id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.2">𝜏</ci><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.3a.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.3"><mtext id="S3.SS2.SSS2.p1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.3">in</mtext></ci></apply><ci id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">\tau_{\text{in}}\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">italic_τ start_POSTSUBSCRIPT in end_POSTSUBSCRIPT ∈ caligraphic_D</annotation></semantics></math>, we first construct a query <math alttext="\bm{q}=g(\tau_{\text{in}})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mrow id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml">𝒒</mi><mo id="S3.SS2.SSS2.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.2.m2.1.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.3.cmml">g</mi><mo id="S3.SS2.SSS2.p1.2.m2.1.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.cmml">τ</mi><mtext id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.3a.cmml">in</mtext></msub><mo id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><apply id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1"><eq id="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.2"></eq><ci id="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.3">𝒒</ci><apply id="S3.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1"><times id="S3.SS2.SSS2.p1.2.m2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.2"></times><ci id="S3.SS2.SSS2.p1.2.m2.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.3">𝑔</ci><apply id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2">𝜏</ci><ci id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.3"><mtext id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.3">in</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">\bm{q}=g(\tau_{\text{in}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">bold_italic_q = italic_g ( italic_τ start_POSTSUBSCRIPT in end_POSTSUBSCRIPT )</annotation></semantics></math>, using our embedding model <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.3.m3.1"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><mrow id="S3.SS2.SSS2.p1.3.m3.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.2.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.2.2" xref="S3.SS2.SSS2.p1.3.m3.1.2.2.cmml">g</mi><mo id="S3.SS2.SSS2.p1.3.m3.1.2.1" xref="S3.SS2.SSS2.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.3.m3.1.2.3.2" xref="S3.SS2.SSS2.p1.3.m3.1.2.cmml"><mo id="S3.SS2.SSS2.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS2.p1.3.m3.1.2.cmml">(</mo><mo id="S3.SS2.SSS2.p1.3.m3.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS2.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS2.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><apply id="S3.SS2.SSS2.p1.3.m3.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.2"><times id="S3.SS2.SSS2.p1.3.m3.1.2.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.2.1"></times><ci id="S3.SS2.SSS2.p1.3.m3.1.2.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.2.2">𝑔</ci><ci id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.1d">italic_g ( ⋅ )</annotation></semantics></math> (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS4" title="C.4 Retrieval-Augmented Decision Transformer ‣ Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">C.4</span></a> for details).
Then, we use maximum inner product search (MIPS) between <math alttext="\bm{q}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.4.m4.1"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><mi id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><ci id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">\bm{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.4.m4.1d">bold_italic_q</annotation></semantics></math> and all keys <math alttext="\bm{k}\in\mathcal{K}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.5.m5.1"><semantics id="S3.SS2.SSS2.p1.5.m5.1a"><mrow id="S3.SS2.SSS2.p1.5.m5.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS2.p1.5.m5.1.1.2" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml">𝒌</mi><mo id="S3.SS2.SSS2.p1.5.m5.1.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.5.m5.1.1.3" xref="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml">𝒦</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.5.m5.1b"><apply id="S3.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1"><in id="S3.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.1"></in><ci id="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.2">𝒌</ci><ci id="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.3">𝒦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.5.m5.1c">\bm{k}\in\mathcal{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.5.m5.1d">bold_italic_k ∈ caligraphic_K</annotation></semantics></math> and select the corresponding top-<math alttext="l" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.6.m6.1"><semantics id="S3.SS2.SSS2.p1.6.m6.1a"><mi id="S3.SS2.SSS2.p1.6.m6.1.1" xref="S3.SS2.SSS2.p1.6.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.6.m6.1b"><ci id="S3.SS2.SSS2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.6.m6.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.6.m6.1d">italic_l</annotation></semantics></math> sub-trajectories <math alttext="\tau_{\text{ret}}\in\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.7.m7.1"><semantics id="S3.SS2.SSS2.p1.7.m7.1a"><mrow id="S3.SS2.SSS2.p1.7.m7.1.1" xref="S3.SS2.SSS2.p1.7.m7.1.1.cmml"><msub id="S3.SS2.SSS2.p1.7.m7.1.1.2" xref="S3.SS2.SSS2.p1.7.m7.1.1.2.cmml"><mi id="S3.SS2.SSS2.p1.7.m7.1.1.2.2" xref="S3.SS2.SSS2.p1.7.m7.1.1.2.2.cmml">τ</mi><mtext id="S3.SS2.SSS2.p1.7.m7.1.1.2.3" xref="S3.SS2.SSS2.p1.7.m7.1.1.2.3a.cmml">ret</mtext></msub><mo id="S3.SS2.SSS2.p1.7.m7.1.1.1" xref="S3.SS2.SSS2.p1.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.7.m7.1.1.3" xref="S3.SS2.SSS2.p1.7.m7.1.1.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.7.m7.1b"><apply id="S3.SS2.SSS2.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1"><in id="S3.SS2.SSS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1.1"></in><apply id="S3.SS2.SSS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.7.m7.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.7.m7.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1.2.2">𝜏</ci><ci id="S3.SS2.SSS2.p1.7.m7.1.1.2.3a.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1.2.3"><mtext id="S3.SS2.SSS2.p1.7.m7.1.1.2.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p1.7.m7.1.1.2.3">ret</mtext></ci></apply><ci id="S3.SS2.SSS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.7.m7.1c">\tau_{\text{ret}}\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.7.m7.1d">italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ∈ caligraphic_V</annotation></semantics></math> by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{R}=\operatorname*{arg\,max}^{l}_{\bm{k}\in\mathcal{K}}\operatorname{%
cossim}(\bm{q},\bm{k})," class="ltx_Math" display="block" id="S3.E3.m1.3"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml">ℛ</mi><mo id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.2.cmml"><mrow id="S3.E3.m1.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.cmml"><munderover id="S3.E3.m1.3.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.cmml">arg</mi><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.1" lspace="0.170em" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.3.cmml">max</mi></mrow><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml">𝒌</mi><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.3.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.cmml">𝒦</mi></mrow><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml">l</mi></munderover><mo id="S3.E3.m1.3.3.1.1.1.1.1a" lspace="0.167em" xref="S3.E3.m1.3.3.1.1.1.1.1.cmml">⁡</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.2.cmml">cossim</mi></mrow><mo id="S3.E3.m1.3.3.1.1.1.1a" xref="S3.E3.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.2.cmml"><mo id="S3.E3.m1.3.3.1.1.1.1.2.1" stretchy="false" xref="S3.E3.m1.3.3.1.1.1.2.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">𝒒</mi><mo id="S3.E3.m1.3.3.1.1.1.1.2.2" xref="S3.E3.m1.3.3.1.1.1.2.cmml">,</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">𝒌</mi><mo id="S3.E3.m1.3.3.1.1.1.1.2.3" stretchy="false" xref="S3.E3.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1"><eq id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"></eq><ci id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3">ℛ</ci><apply id="S3.E3.m1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1"><apply id="S3.E3.m1.3.3.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1"><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2"><times id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.1"></times><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2">arg</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.3">max</ci></apply><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3"><in id="S3.E3.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.1"></in><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.2">𝒌</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3">𝒦</ci></apply></apply><ci id="S3.E3.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.2">cossim</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝒒</ci><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝒌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\mathcal{R}=\operatorname*{arg\,max}^{l}_{\bm{k}\in\mathcal{K}}\operatorname{%
cossim}(\bm{q},\bm{k}),</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.3d">caligraphic_R = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_italic_k ∈ caligraphic_K end_POSTSUBSCRIPT roman_cossim ( bold_italic_q , bold_italic_k ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.p1.9">where <math alttext="\operatorname{cossim}(\bm{q},\bm{k})=\frac{\mathbf{q}\cdot\mathbf{k}}{\|%
\mathbf{q}\|\|\mathbf{k}\|}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.8.m1.5"><semantics id="S3.SS2.SSS2.p1.8.m1.5a"><mrow id="S3.SS2.SSS2.p1.8.m1.5.6" xref="S3.SS2.SSS2.p1.8.m1.5.6.cmml"><mrow id="S3.SS2.SSS2.p1.8.m1.5.6.2.2" xref="S3.SS2.SSS2.p1.8.m1.5.6.2.1.cmml"><mi id="S3.SS2.SSS2.p1.8.m1.3.3" xref="S3.SS2.SSS2.p1.8.m1.3.3.cmml">cossim</mi><mo id="S3.SS2.SSS2.p1.8.m1.5.6.2.2a" xref="S3.SS2.SSS2.p1.8.m1.5.6.2.1.cmml">⁡</mo><mrow id="S3.SS2.SSS2.p1.8.m1.5.6.2.2.1" xref="S3.SS2.SSS2.p1.8.m1.5.6.2.1.cmml"><mo id="S3.SS2.SSS2.p1.8.m1.5.6.2.2.1.1" stretchy="false" xref="S3.SS2.SSS2.p1.8.m1.5.6.2.1.cmml">(</mo><mi id="S3.SS2.SSS2.p1.8.m1.4.4" xref="S3.SS2.SSS2.p1.8.m1.4.4.cmml">𝒒</mi><mo id="S3.SS2.SSS2.p1.8.m1.5.6.2.2.1.2" xref="S3.SS2.SSS2.p1.8.m1.5.6.2.1.cmml">,</mo><mi id="S3.SS2.SSS2.p1.8.m1.5.5" xref="S3.SS2.SSS2.p1.8.m1.5.5.cmml">𝒌</mi><mo id="S3.SS2.SSS2.p1.8.m1.5.6.2.2.1.3" stretchy="false" xref="S3.SS2.SSS2.p1.8.m1.5.6.2.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p1.8.m1.5.6.1" xref="S3.SS2.SSS2.p1.8.m1.5.6.1.cmml">=</mo><mfrac id="S3.SS2.SSS2.p1.8.m1.2.2" xref="S3.SS2.SSS2.p1.8.m1.2.2.cmml"><mrow id="S3.SS2.SSS2.p1.8.m1.2.2.4" xref="S3.SS2.SSS2.p1.8.m1.2.2.4.cmml"><mi id="S3.SS2.SSS2.p1.8.m1.2.2.4.2" xref="S3.SS2.SSS2.p1.8.m1.2.2.4.2.cmml">𝐪</mi><mo id="S3.SS2.SSS2.p1.8.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS2.p1.8.m1.2.2.4.1.cmml">⋅</mo><mi id="S3.SS2.SSS2.p1.8.m1.2.2.4.3" xref="S3.SS2.SSS2.p1.8.m1.2.2.4.3.cmml">𝐤</mi></mrow><mrow id="S3.SS2.SSS2.p1.8.m1.2.2.2" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.cmml"><mrow id="S3.SS2.SSS2.p1.8.m1.2.2.2.4.2" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.4.1.cmml"><mo id="S3.SS2.SSS2.p1.8.m1.2.2.2.4.2.1" stretchy="false" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.4.1.1.cmml">‖</mo><mi id="S3.SS2.SSS2.p1.8.m1.1.1.1.1" xref="S3.SS2.SSS2.p1.8.m1.1.1.1.1.cmml">𝐪</mi><mo id="S3.SS2.SSS2.p1.8.m1.2.2.2.4.2.2" stretchy="false" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.4.1.1.cmml">‖</mo></mrow><mo id="S3.SS2.SSS2.p1.8.m1.2.2.2.3" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.8.m1.2.2.2.5.2" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.5.1.cmml"><mo id="S3.SS2.SSS2.p1.8.m1.2.2.2.5.2.1" stretchy="false" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.5.1.1.cmml">‖</mo><mi id="S3.SS2.SSS2.p1.8.m1.2.2.2.2" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.2.cmml">𝐤</mi><mo id="S3.SS2.SSS2.p1.8.m1.2.2.2.5.2.2" stretchy="false" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.5.1.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.8.m1.5b"><apply id="S3.SS2.SSS2.p1.8.m1.5.6.cmml" xref="S3.SS2.SSS2.p1.8.m1.5.6"><eq id="S3.SS2.SSS2.p1.8.m1.5.6.1.cmml" xref="S3.SS2.SSS2.p1.8.m1.5.6.1"></eq><apply id="S3.SS2.SSS2.p1.8.m1.5.6.2.1.cmml" xref="S3.SS2.SSS2.p1.8.m1.5.6.2.2"><ci id="S3.SS2.SSS2.p1.8.m1.3.3.cmml" xref="S3.SS2.SSS2.p1.8.m1.3.3">cossim</ci><ci id="S3.SS2.SSS2.p1.8.m1.4.4.cmml" xref="S3.SS2.SSS2.p1.8.m1.4.4">𝒒</ci><ci id="S3.SS2.SSS2.p1.8.m1.5.5.cmml" xref="S3.SS2.SSS2.p1.8.m1.5.5">𝒌</ci></apply><apply id="S3.SS2.SSS2.p1.8.m1.2.2.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2"><divide id="S3.SS2.SSS2.p1.8.m1.2.2.3.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2"></divide><apply id="S3.SS2.SSS2.p1.8.m1.2.2.4.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2.4"><ci id="S3.SS2.SSS2.p1.8.m1.2.2.4.1.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2.4.1">⋅</ci><ci id="S3.SS2.SSS2.p1.8.m1.2.2.4.2.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2.4.2">𝐪</ci><ci id="S3.SS2.SSS2.p1.8.m1.2.2.4.3.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2.4.3">𝐤</ci></apply><apply id="S3.SS2.SSS2.p1.8.m1.2.2.2.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2.2"><times id="S3.SS2.SSS2.p1.8.m1.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.3"></times><apply id="S3.SS2.SSS2.p1.8.m1.2.2.2.4.1.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.4.2"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.8.m1.2.2.2.4.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.4.2.1">norm</csymbol><ci id="S3.SS2.SSS2.p1.8.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m1.1.1.1.1">𝐪</ci></apply><apply id="S3.SS2.SSS2.p1.8.m1.2.2.2.5.1.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.5.2"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.8.m1.2.2.2.5.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.5.2.1">norm</csymbol><ci id="S3.SS2.SSS2.p1.8.m1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.8.m1.2.2.2.2">𝐤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.8.m1.5c">\operatorname{cossim}(\bm{q},\bm{k})=\frac{\mathbf{q}\cdot\mathbf{k}}{\|%
\mathbf{q}\|\|\mathbf{k}\|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.8.m1.5d">roman_cossim ( bold_italic_q , bold_italic_k ) = divide start_ARG bold_q ⋅ bold_k end_ARG start_ARG ∥ bold_q ∥ ∥ bold_k ∥ end_ARG</annotation></semantics></math>
is the cosine similarity.
Consequently, <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.9.m2.1"><semantics id="S3.SS2.SSS2.p1.9.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.9.m2.1.1" xref="S3.SS2.SSS2.p1.9.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.9.m2.1b"><ci id="S3.SS2.SSS2.p1.9.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.9.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.9.m2.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.9.m2.1d">caligraphic_R</annotation></semantics></math> contains the set of retrieved sub-trajectories and their keys.
Providing too similar experiences to the model may hinder learning <cite class="ltx_cite ltx_citemacro_citep">[Yasunaga et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib102" title="">2023</a>]</cite> and we apply retrieval regularization during training (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS4" title="C.4 Retrieval-Augmented Decision Transformer ‣ Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">C.4</span></a>).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Reweighting Retrieved Experiences</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.3">Following <cite class="ltx_cite ltx_citemacro_citet">Park et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib63" title="">2023</a>]</cite>, we characterize the usefulness of retrieved sub-trajectories in <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.1.m1.1"><semantics id="S3.SS2.SSS3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.p1.1.m1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.1.m1.1b"><ci id="S3.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.1.m1.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.1.m1.1d">caligraphic_R</annotation></semantics></math> along two dimensions: <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS3.p1.3.1">relevance</span> and <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS3.p1.3.2">utility</span>.
The relevance of a key <math alttext="\bm{k}\in\mathcal{K}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.2.m2.1"><semantics id="S3.SS2.SSS3.p1.2.m2.1a"><mrow id="S3.SS2.SSS3.p1.2.m2.1.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p1.2.m2.1.1.2" xref="S3.SS2.SSS3.p1.2.m2.1.1.2.cmml">𝒌</mi><mo id="S3.SS2.SSS3.p1.2.m2.1.1.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.p1.2.m2.1.1.3" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.cmml">𝒦</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.2.m2.1b"><apply id="S3.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1"><in id="S3.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.1"></in><ci id="S3.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.2">𝒌</ci><ci id="S3.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.3">𝒦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.2.m2.1c">\bm{k}\in\mathcal{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.2.m2.1d">bold_italic_k ∈ caligraphic_K</annotation></semantics></math> is defined by its cosine similarity to the query <math alttext="\bm{q}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.3.m3.1"><semantics id="S3.SS2.SSS3.p1.3.m3.1a"><mi id="S3.SS2.SSS3.p1.3.m3.1.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.3.m3.1b"><ci id="S3.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.3.m3.1c">\bm{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.3.m3.1d">bold_italic_q</annotation></semantics></math>.
While a retrieved experience may be relevant, it might not be important.
Determining the utility of a sequence in general is hard.
Thus, we experiment with two heuristics that follow different definitions of utility.
The first assigns more utility to sub-trajectories with high return, and is utilized <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS3.p1.3.3">at inference</em> only.
The second assigns utility to sub-trajectories that originate from the same task as the query and is used <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS3.p1.3.4">at training</em> only.
Then, we reweight a retrieved experience according to:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="s_{\text{ret}}(\bm{k},\bm{q},\tau_{\text{ret}})=s_{\text{rel}}(\bm{k},\bm{q})+%
\alpha\,s_{\text{u}}(\tau_{\text{ret}},\tau_{\text{in}})," class="ltx_Math" display="block" id="S3.E4.m1.5"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.cmml"><msub id="S3.E4.m1.5.5.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.3.cmml"><mi id="S3.E4.m1.5.5.1.1.1.3.2" xref="S3.E4.m1.5.5.1.1.1.3.2.cmml">s</mi><mtext id="S3.E4.m1.5.5.1.1.1.3.3" xref="S3.E4.m1.5.5.1.1.1.3.3a.cmml">ret</mtext></msub><mo id="S3.E4.m1.5.5.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E4.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">𝒌</mi><mo id="S3.E4.m1.5.5.1.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">𝒒</mi><mo id="S3.E4.m1.5.5.1.1.1.1.1.4" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">,</mo><msub id="S3.E4.m1.5.5.1.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.1.1.2.cmml">τ</mi><mtext id="S3.E4.m1.5.5.1.1.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.1.1.3a.cmml">ret</mtext></msub><mo id="S3.E4.m1.5.5.1.1.1.1.1.5" stretchy="false" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.4" xref="S3.E4.m1.5.5.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.5.5.1.1.3" xref="S3.E4.m1.5.5.1.1.3.cmml"><mrow id="S3.E4.m1.5.5.1.1.3.4" xref="S3.E4.m1.5.5.1.1.3.4.cmml"><msub id="S3.E4.m1.5.5.1.1.3.4.2" xref="S3.E4.m1.5.5.1.1.3.4.2.cmml"><mi id="S3.E4.m1.5.5.1.1.3.4.2.2" xref="S3.E4.m1.5.5.1.1.3.4.2.2.cmml">s</mi><mtext id="S3.E4.m1.5.5.1.1.3.4.2.3" xref="S3.E4.m1.5.5.1.1.3.4.2.3a.cmml">rel</mtext></msub><mo id="S3.E4.m1.5.5.1.1.3.4.1" xref="S3.E4.m1.5.5.1.1.3.4.1.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.3.4.3.2" xref="S3.E4.m1.5.5.1.1.3.4.3.1.cmml"><mo id="S3.E4.m1.5.5.1.1.3.4.3.2.1" stretchy="false" xref="S3.E4.m1.5.5.1.1.3.4.3.1.cmml">(</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">𝒌</mi><mo id="S3.E4.m1.5.5.1.1.3.4.3.2.2" xref="S3.E4.m1.5.5.1.1.3.4.3.1.cmml">,</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">𝒒</mi><mo id="S3.E4.m1.5.5.1.1.3.4.3.2.3" stretchy="false" xref="S3.E4.m1.5.5.1.1.3.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.5.5.1.1.3.3" xref="S3.E4.m1.5.5.1.1.3.3.cmml">+</mo><mrow id="S3.E4.m1.5.5.1.1.3.2" xref="S3.E4.m1.5.5.1.1.3.2.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.4" xref="S3.E4.m1.5.5.1.1.3.2.4.cmml">α</mi><mo id="S3.E4.m1.5.5.1.1.3.2.3" lspace="0.170em" xref="S3.E4.m1.5.5.1.1.3.2.3.cmml">⁢</mo><msub id="S3.E4.m1.5.5.1.1.3.2.5" xref="S3.E4.m1.5.5.1.1.3.2.5.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.5.2" xref="S3.E4.m1.5.5.1.1.3.2.5.2.cmml">s</mi><mtext id="S3.E4.m1.5.5.1.1.3.2.5.3" xref="S3.E4.m1.5.5.1.1.3.2.5.3a.cmml">u</mtext></msub><mo id="S3.E4.m1.5.5.1.1.3.2.3a" xref="S3.E4.m1.5.5.1.1.3.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.1.1.3.2.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.3.cmml"><mo id="S3.E4.m1.5.5.1.1.3.2.2.2.3" stretchy="false" xref="S3.E4.m1.5.5.1.1.3.2.2.3.cmml">(</mo><msub id="S3.E4.m1.5.5.1.1.2.1.1.1.1" xref="S3.E4.m1.5.5.1.1.2.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.2.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.2.1.1.1.1.2.cmml">τ</mi><mtext id="S3.E4.m1.5.5.1.1.2.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.2.1.1.1.1.3a.cmml">ret</mtext></msub><mo id="S3.E4.m1.5.5.1.1.3.2.2.2.4" xref="S3.E4.m1.5.5.1.1.3.2.2.3.cmml">,</mo><msub id="S3.E4.m1.5.5.1.1.3.2.2.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.2.2.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2.2.cmml">τ</mi><mtext id="S3.E4.m1.5.5.1.1.3.2.2.2.2.3" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2.3a.cmml">in</mtext></msub><mo id="S3.E4.m1.5.5.1.1.3.2.2.2.5" stretchy="false" xref="S3.E4.m1.5.5.1.1.3.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1"><eq id="S3.E4.m1.5.5.1.1.4.cmml" xref="S3.E4.m1.5.5.1.1.4"></eq><apply id="S3.E4.m1.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"><times id="S3.E4.m1.5.5.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.2"></times><apply id="S3.E4.m1.5.5.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.1.3.2">𝑠</ci><ci id="S3.E4.m1.5.5.1.1.1.3.3a.cmml" xref="S3.E4.m1.5.5.1.1.1.3.3"><mtext id="S3.E4.m1.5.5.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E4.m1.5.5.1.1.1.3.3">ret</mtext></ci></apply><vector id="S3.E4.m1.5.5.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1"><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝒌</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝒒</ci><apply id="S3.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.2">𝜏</ci><ci id="S3.E4.m1.5.5.1.1.1.1.1.1.3a.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1.3"><mtext id="S3.E4.m1.5.5.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E4.m1.5.5.1.1.1.1.1.1.3">ret</mtext></ci></apply></vector></apply><apply id="S3.E4.m1.5.5.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3"><plus id="S3.E4.m1.5.5.1.1.3.3.cmml" xref="S3.E4.m1.5.5.1.1.3.3"></plus><apply id="S3.E4.m1.5.5.1.1.3.4.cmml" xref="S3.E4.m1.5.5.1.1.3.4"><times id="S3.E4.m1.5.5.1.1.3.4.1.cmml" xref="S3.E4.m1.5.5.1.1.3.4.1"></times><apply id="S3.E4.m1.5.5.1.1.3.4.2.cmml" xref="S3.E4.m1.5.5.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.4.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.4.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.4.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.4.2.2">𝑠</ci><ci id="S3.E4.m1.5.5.1.1.3.4.2.3a.cmml" xref="S3.E4.m1.5.5.1.1.3.4.2.3"><mtext id="S3.E4.m1.5.5.1.1.3.4.2.3.cmml" mathsize="70%" xref="S3.E4.m1.5.5.1.1.3.4.2.3">rel</mtext></ci></apply><interval closure="open" id="S3.E4.m1.5.5.1.1.3.4.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.4.3.2"><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝒌</ci><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝒒</ci></interval></apply><apply id="S3.E4.m1.5.5.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2"><times id="S3.E4.m1.5.5.1.1.3.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3"></times><ci id="S3.E4.m1.5.5.1.1.3.2.4.cmml" xref="S3.E4.m1.5.5.1.1.3.2.4">𝛼</ci><apply id="S3.E4.m1.5.5.1.1.3.2.5.cmml" xref="S3.E4.m1.5.5.1.1.3.2.5"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.5.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.5">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.5.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.5.2">𝑠</ci><ci id="S3.E4.m1.5.5.1.1.3.2.5.3a.cmml" xref="S3.E4.m1.5.5.1.1.3.2.5.3"><mtext id="S3.E4.m1.5.5.1.1.3.2.5.3.cmml" mathsize="70%" xref="S3.E4.m1.5.5.1.1.3.2.5.3">u</mtext></ci></apply><interval closure="open" id="S3.E4.m1.5.5.1.1.3.2.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2"><apply id="S3.E4.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.2.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2.1.1.1.1.2">𝜏</ci><ci id="S3.E4.m1.5.5.1.1.2.1.1.1.1.3a.cmml" xref="S3.E4.m1.5.5.1.1.2.1.1.1.1.3"><mtext id="S3.E4.m1.5.5.1.1.2.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E4.m1.5.5.1.1.2.1.1.1.1.3">ret</mtext></ci></apply><apply id="S3.E4.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.2.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.2.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2.2">𝜏</ci><ci id="S3.E4.m1.5.5.1.1.3.2.2.2.2.3a.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2.3"><mtext id="S3.E4.m1.5.5.1.1.3.2.2.2.2.3.cmml" mathsize="70%" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2.3">in</mtext></ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">s_{\text{ret}}(\bm{k},\bm{q},\tau_{\text{ret}})=s_{\text{rel}}(\bm{k},\bm{q})+%
\alpha\,s_{\text{u}}(\tau_{\text{ret}},\tau_{\text{in}}),</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.5d">italic_s start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ( bold_italic_k , bold_italic_q , italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ) = italic_s start_POSTSUBSCRIPT rel end_POSTSUBSCRIPT ( bold_italic_k , bold_italic_q ) + italic_α italic_s start_POSTSUBSCRIPT u end_POSTSUBSCRIPT ( italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT , italic_τ start_POSTSUBSCRIPT in end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS3.p1.9">where <math alttext="s_{rel}=\operatorname{cossim}(\bm{k},\bm{q})" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.4.m1.3"><semantics id="S3.SS2.SSS3.p1.4.m1.3a"><mrow id="S3.SS2.SSS3.p1.4.m1.3.4" xref="S3.SS2.SSS3.p1.4.m1.3.4.cmml"><msub id="S3.SS2.SSS3.p1.4.m1.3.4.2" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.cmml"><mi id="S3.SS2.SSS3.p1.4.m1.3.4.2.2" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.2.cmml">s</mi><mrow id="S3.SS2.SSS3.p1.4.m1.3.4.2.3" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.3.cmml"><mi id="S3.SS2.SSS3.p1.4.m1.3.4.2.3.2" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.3.2.cmml">r</mi><mo id="S3.SS2.SSS3.p1.4.m1.3.4.2.3.1" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS3.p1.4.m1.3.4.2.3.3" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.3.3.cmml">e</mi><mo id="S3.SS2.SSS3.p1.4.m1.3.4.2.3.1a" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS3.p1.4.m1.3.4.2.3.4" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.3.4.cmml">l</mi></mrow></msub><mo id="S3.SS2.SSS3.p1.4.m1.3.4.1" xref="S3.SS2.SSS3.p1.4.m1.3.4.1.cmml">=</mo><mrow id="S3.SS2.SSS3.p1.4.m1.3.4.3.2" xref="S3.SS2.SSS3.p1.4.m1.3.4.3.1.cmml"><mi id="S3.SS2.SSS3.p1.4.m1.1.1" xref="S3.SS2.SSS3.p1.4.m1.1.1.cmml">cossim</mi><mo id="S3.SS2.SSS3.p1.4.m1.3.4.3.2a" xref="S3.SS2.SSS3.p1.4.m1.3.4.3.1.cmml">⁡</mo><mrow id="S3.SS2.SSS3.p1.4.m1.3.4.3.2.1" xref="S3.SS2.SSS3.p1.4.m1.3.4.3.1.cmml"><mo id="S3.SS2.SSS3.p1.4.m1.3.4.3.2.1.1" stretchy="false" xref="S3.SS2.SSS3.p1.4.m1.3.4.3.1.cmml">(</mo><mi id="S3.SS2.SSS3.p1.4.m1.2.2" xref="S3.SS2.SSS3.p1.4.m1.2.2.cmml">𝒌</mi><mo id="S3.SS2.SSS3.p1.4.m1.3.4.3.2.1.2" xref="S3.SS2.SSS3.p1.4.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS2.SSS3.p1.4.m1.3.3" xref="S3.SS2.SSS3.p1.4.m1.3.3.cmml">𝒒</mi><mo id="S3.SS2.SSS3.p1.4.m1.3.4.3.2.1.3" stretchy="false" xref="S3.SS2.SSS3.p1.4.m1.3.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.4.m1.3b"><apply id="S3.SS2.SSS3.p1.4.m1.3.4.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.4"><eq id="S3.SS2.SSS3.p1.4.m1.3.4.1.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.4.1"></eq><apply id="S3.SS2.SSS3.p1.4.m1.3.4.2.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.4.m1.3.4.2.1.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.4.2">subscript</csymbol><ci id="S3.SS2.SSS3.p1.4.m1.3.4.2.2.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.2">𝑠</ci><apply id="S3.SS2.SSS3.p1.4.m1.3.4.2.3.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.3"><times id="S3.SS2.SSS3.p1.4.m1.3.4.2.3.1.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.3.1"></times><ci id="S3.SS2.SSS3.p1.4.m1.3.4.2.3.2.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.3.2">𝑟</ci><ci id="S3.SS2.SSS3.p1.4.m1.3.4.2.3.3.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.3.3">𝑒</ci><ci id="S3.SS2.SSS3.p1.4.m1.3.4.2.3.4.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.4.2.3.4">𝑙</ci></apply></apply><apply id="S3.SS2.SSS3.p1.4.m1.3.4.3.1.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.4.3.2"><ci id="S3.SS2.SSS3.p1.4.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.4.m1.1.1">cossim</ci><ci id="S3.SS2.SSS3.p1.4.m1.2.2.cmml" xref="S3.SS2.SSS3.p1.4.m1.2.2">𝒌</ci><ci id="S3.SS2.SSS3.p1.4.m1.3.3.cmml" xref="S3.SS2.SSS3.p1.4.m1.3.3">𝒒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.4.m1.3c">s_{rel}=\operatorname{cossim}(\bm{k},\bm{q})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.4.m1.3d">italic_s start_POSTSUBSCRIPT italic_r italic_e italic_l end_POSTSUBSCRIPT = roman_cossim ( bold_italic_k , bold_italic_q )</annotation></semantics></math> and <math alttext="s_{\text{u}}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.5.m2.1"><semantics id="S3.SS2.SSS3.p1.5.m2.1a"><msub id="S3.SS2.SSS3.p1.5.m2.1.1" xref="S3.SS2.SSS3.p1.5.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p1.5.m2.1.1.2" xref="S3.SS2.SSS3.p1.5.m2.1.1.2.cmml">s</mi><mtext id="S3.SS2.SSS3.p1.5.m2.1.1.3" xref="S3.SS2.SSS3.p1.5.m2.1.1.3a.cmml">u</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.5.m2.1b"><apply id="S3.SS2.SSS3.p1.5.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.5.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p1.5.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.5.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p1.5.m2.1.1.2">𝑠</ci><ci id="S3.SS2.SSS3.p1.5.m2.1.1.3a.cmml" xref="S3.SS2.SSS3.p1.5.m2.1.1.3"><mtext id="S3.SS2.SSS3.p1.5.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p1.5.m2.1.1.3">u</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.5.m2.1c">s_{\text{u}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.5.m2.1d">italic_s start_POSTSUBSCRIPT u end_POSTSUBSCRIPT</annotation></semantics></math> measures the utility of a retrieved sub-trajectory weighted by <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.6.m3.1"><semantics id="S3.SS2.SSS3.p1.6.m3.1a"><mi id="S3.SS2.SSS3.p1.6.m3.1.1" xref="S3.SS2.SSS3.p1.6.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.6.m3.1b"><ci id="S3.SS2.SSS3.p1.6.m3.1.1.cmml" xref="S3.SS2.SSS3.p1.6.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.6.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.6.m3.1d">italic_α</annotation></semantics></math>.
Note that we instantiate <math alttext="s_{\text{u}}(\cdot,\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.7.m4.2"><semantics id="S3.SS2.SSS3.p1.7.m4.2a"><mrow id="S3.SS2.SSS3.p1.7.m4.2.3" xref="S3.SS2.SSS3.p1.7.m4.2.3.cmml"><msub id="S3.SS2.SSS3.p1.7.m4.2.3.2" xref="S3.SS2.SSS3.p1.7.m4.2.3.2.cmml"><mi id="S3.SS2.SSS3.p1.7.m4.2.3.2.2" xref="S3.SS2.SSS3.p1.7.m4.2.3.2.2.cmml">s</mi><mtext id="S3.SS2.SSS3.p1.7.m4.2.3.2.3" xref="S3.SS2.SSS3.p1.7.m4.2.3.2.3a.cmml">u</mtext></msub><mo id="S3.SS2.SSS3.p1.7.m4.2.3.1" xref="S3.SS2.SSS3.p1.7.m4.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p1.7.m4.2.3.3.2" xref="S3.SS2.SSS3.p1.7.m4.2.3.3.1.cmml"><mo id="S3.SS2.SSS3.p1.7.m4.2.3.3.2.1" stretchy="false" xref="S3.SS2.SSS3.p1.7.m4.2.3.3.1.cmml">(</mo><mo id="S3.SS2.SSS3.p1.7.m4.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS3.p1.7.m4.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS3.p1.7.m4.2.3.3.2.2" rspace="0em" xref="S3.SS2.SSS3.p1.7.m4.2.3.3.1.cmml">,</mo><mo id="S3.SS2.SSS3.p1.7.m4.2.2" lspace="0em" rspace="0em" xref="S3.SS2.SSS3.p1.7.m4.2.2.cmml">⋅</mo><mo id="S3.SS2.SSS3.p1.7.m4.2.3.3.2.3" stretchy="false" xref="S3.SS2.SSS3.p1.7.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.7.m4.2b"><apply id="S3.SS2.SSS3.p1.7.m4.2.3.cmml" xref="S3.SS2.SSS3.p1.7.m4.2.3"><times id="S3.SS2.SSS3.p1.7.m4.2.3.1.cmml" xref="S3.SS2.SSS3.p1.7.m4.2.3.1"></times><apply id="S3.SS2.SSS3.p1.7.m4.2.3.2.cmml" xref="S3.SS2.SSS3.p1.7.m4.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.7.m4.2.3.2.1.cmml" xref="S3.SS2.SSS3.p1.7.m4.2.3.2">subscript</csymbol><ci id="S3.SS2.SSS3.p1.7.m4.2.3.2.2.cmml" xref="S3.SS2.SSS3.p1.7.m4.2.3.2.2">𝑠</ci><ci id="S3.SS2.SSS3.p1.7.m4.2.3.2.3a.cmml" xref="S3.SS2.SSS3.p1.7.m4.2.3.2.3"><mtext id="S3.SS2.SSS3.p1.7.m4.2.3.2.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p1.7.m4.2.3.2.3">u</mtext></ci></apply><interval closure="open" id="S3.SS2.SSS3.p1.7.m4.2.3.3.1.cmml" xref="S3.SS2.SSS3.p1.7.m4.2.3.3.2"><ci id="S3.SS2.SSS3.p1.7.m4.1.1.cmml" xref="S3.SS2.SSS3.p1.7.m4.1.1">⋅</ci><ci id="S3.SS2.SSS3.p1.7.m4.2.2.cmml" xref="S3.SS2.SSS3.p1.7.m4.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.7.m4.2c">s_{\text{u}}(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.7.m4.2d">italic_s start_POSTSUBSCRIPT u end_POSTSUBSCRIPT ( ⋅ , ⋅ )</annotation></semantics></math> differently depending on whether the agent is in training or inference mode.
At <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS3.p1.9.1">training</em> time, a pre-collected set of trajectories that contains multiple tasks is stored in the vector index (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">1</span></a>, left). Trajectories can be obtained from human demonstrations or RL agents.
Therefore, we encourage the agent to retrieve sub-trajectories of the same task. During training, we use:
<math alttext="s_{\text{u}}(\tau_{\text{ret}},\tau_{\text{in}})=\mathds{1}(\mathrm{t}(\tau_{%
\text{ret}})=\mathrm{t}(\tau_{\text{in}}))," class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.8.m5.1"><semantics id="S3.SS2.SSS3.p1.8.m5.1a"><mrow id="S3.SS2.SSS3.p1.8.m5.1.1.1" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.cmml"><mrow id="S3.SS2.SSS3.p1.8.m5.1.1.1.1" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.cmml"><mrow id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.cmml"><msub id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.cmml"><mi id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.2.cmml">s</mi><mtext id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.3" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.3a.cmml">u</mtext></msub><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.3" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.3.cmml"><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.3" stretchy="false" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.2.cmml">τ</mi><mtext id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.3a.cmml">ret</mtext></msub><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.4" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.cmml"><mi id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.2.cmml">τ</mi><mtext id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.3" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.3a.cmml">in</mtext></msub><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.5" stretchy="false" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.4" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.4.cmml">=</mo><mrow id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.cmml"><mn id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.3" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.3.cmml">𝟙</mn><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.2.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.cmml"><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.2" stretchy="false" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.cmml"><mrow id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.3" mathvariant="normal" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.3.cmml">t</mi><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.2.cmml">τ</mi><mtext id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.3a.cmml">ret</mtext></msub><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.3" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.3.cmml">=</mo><mrow id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.cmml"><mi id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.3" mathvariant="normal" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.3.cmml">t</mi><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.cmml"><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.2" stretchy="false" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.2.cmml">τ</mi><mtext id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.3" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.3a.cmml">in</mtext></msub><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.3" stretchy="false" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.3" stretchy="false" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS2.SSS3.p1.8.m5.1.1.1.2" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.8.m5.1b"><apply id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1"><eq id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.4.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.4"></eq><apply id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2"><times id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.3"></times><apply id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.1.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4">subscript</csymbol><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.2.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.2">𝑠</ci><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.3a.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.3"><mtext id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.4.3">u</mtext></ci></apply><interval closure="open" id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.3.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2"><apply id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.2">𝜏</ci><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.3"><mtext id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.1.1.1.1.3">ret</mtext></ci></apply><apply id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.1.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.2.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.2">𝜏</ci><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.3a.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.3"><mtext id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.2.2.2.2.3">in</mtext></ci></apply></interval></apply><apply id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3"><times id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.2"></times><cn id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.3">1</cn><apply id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1"><eq id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.3"></eq><apply id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1"><times id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.2"></times><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.3">t</ci><apply id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.2">𝜏</ci><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.3"><mtext id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.1.1.1.1.3">ret</mtext></ci></apply></apply><apply id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2"><times id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.2.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.2"></times><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.3.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.3">t</ci><apply id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.2">𝜏</ci><ci id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.3a.cmml" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.3"><mtext id="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p1.8.m5.1.1.1.1.3.1.1.1.2.1.1.1.3">in</mtext></ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.8.m5.1c">s_{\text{u}}(\tau_{\text{ret}},\tau_{\text{in}})=\mathds{1}(\mathrm{t}(\tau_{%
\text{ret}})=\mathrm{t}(\tau_{\text{in}})),</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.8.m5.1d">italic_s start_POSTSUBSCRIPT u end_POSTSUBSCRIPT ( italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT , italic_τ start_POSTSUBSCRIPT in end_POSTSUBSCRIPT ) = blackboard_1 ( roman_t ( italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ) = roman_t ( italic_τ start_POSTSUBSCRIPT in end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math>
where <math alttext="\mathrm{t}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.9.m6.1"><semantics id="S3.SS2.SSS3.p1.9.m6.1a"><mrow id="S3.SS2.SSS3.p1.9.m6.1.2" xref="S3.SS2.SSS3.p1.9.m6.1.2.cmml"><mi id="S3.SS2.SSS3.p1.9.m6.1.2.2" mathvariant="normal" xref="S3.SS2.SSS3.p1.9.m6.1.2.2.cmml">t</mi><mo id="S3.SS2.SSS3.p1.9.m6.1.2.1" xref="S3.SS2.SSS3.p1.9.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p1.9.m6.1.2.3.2" xref="S3.SS2.SSS3.p1.9.m6.1.2.cmml"><mo id="S3.SS2.SSS3.p1.9.m6.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS3.p1.9.m6.1.2.cmml">(</mo><mo id="S3.SS2.SSS3.p1.9.m6.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS3.p1.9.m6.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS3.p1.9.m6.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS3.p1.9.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.9.m6.1b"><apply id="S3.SS2.SSS3.p1.9.m6.1.2.cmml" xref="S3.SS2.SSS3.p1.9.m6.1.2"><times id="S3.SS2.SSS3.p1.9.m6.1.2.1.cmml" xref="S3.SS2.SSS3.p1.9.m6.1.2.1"></times><ci id="S3.SS2.SSS3.p1.9.m6.1.2.2.cmml" xref="S3.SS2.SSS3.p1.9.m6.1.2.2">t</ci><ci id="S3.SS2.SSS3.p1.9.m6.1.1.cmml" xref="S3.SS2.SSS3.p1.9.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.9.m6.1c">\mathrm{t}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.9.m6.1d">roman_t ( ⋅ )</annotation></semantics></math> takes a sub-trajectory and returns its task index.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS3.p2">
<p class="ltx_p" id="S3.SS2.SSS3.p2.3">During <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS3.p2.3.1">inference</em>, we evaluate the ICL capabilities of the agent.
Starting from an <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS3.p2.3.2">empty</em> vector index, we store experiences of the agent while it interacts with the environment (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">1</span></a>, right).
Thus, during inference, the agent can only retrieve experiences from the same task.
Therefore, we steer the agent to produce high reward behaviour on the new task by reweighting a retrieved sub-trajectory by the total return achieved over the episode it appears in, i.e., <math alttext="s_{\text{u}}(\tau_{\text{ret}},\tau_{\text{in}})=\sum_{i=0}^{T}r_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p2.1.m1.2"><semantics id="S3.SS2.SSS3.p2.1.m1.2a"><mrow id="S3.SS2.SSS3.p2.1.m1.2.2" xref="S3.SS2.SSS3.p2.1.m1.2.2.cmml"><mrow id="S3.SS2.SSS3.p2.1.m1.2.2.2" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.cmml"><msub id="S3.SS2.SSS3.p2.1.m1.2.2.2.4" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.4.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.2.2.2.4.2" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.4.2.cmml">s</mi><mtext id="S3.SS2.SSS3.p2.1.m1.2.2.2.4.3" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.4.3a.cmml">u</mtext></msub><mo id="S3.SS2.SSS3.p2.1.m1.2.2.2.3" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.3.cmml"><mo id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.2.cmml">τ</mi><mtext id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.3a.cmml">ret</mtext></msub><mo id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.4" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.2" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.2.cmml">τ</mi><mtext id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.3" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.3a.cmml">in</mtext></msub><mo id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS3.p2.1.m1.2.2.3" rspace="0.111em" xref="S3.SS2.SSS3.p2.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS2.SSS3.p2.1.m1.2.2.4" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.cmml"><msubsup id="S3.SS2.SSS3.p2.1.m1.2.2.4.1" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.cmml"><mo id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.2" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.2.cmml">∑</mo><mrow id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.2" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.2.cmml">i</mi><mo id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.1" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.1.cmml">=</mo><mn id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.3" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.3.cmml">0</mn></mrow><mi id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.3" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.3.cmml">T</mi></msubsup><msub id="S3.SS2.SSS3.p2.1.m1.2.2.4.2" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.2.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.2.2.4.2.2" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.2.2.cmml">r</mi><mi id="S3.SS2.SSS3.p2.1.m1.2.2.4.2.3" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.1.m1.2b"><apply id="S3.SS2.SSS3.p2.1.m1.2.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2"><eq id="S3.SS2.SSS3.p2.1.m1.2.2.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.3"></eq><apply id="S3.SS2.SSS3.p2.1.m1.2.2.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.2"><times id="S3.SS2.SSS3.p2.1.m1.2.2.2.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.3"></times><apply id="S3.SS2.SSS3.p2.1.m1.2.2.2.4.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.1.m1.2.2.2.4.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS3.p2.1.m1.2.2.2.4.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.4.2">𝑠</ci><ci id="S3.SS2.SSS3.p2.1.m1.2.2.2.4.3a.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.4.3"><mtext id="S3.SS2.SSS3.p2.1.m1.2.2.2.4.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.4.3">u</mtext></ci></apply><interval closure="open" id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2"><apply id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.2">𝜏</ci><ci id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.3a.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.3"><mtext id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.3">ret</mtext></ci></apply><apply id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.2">𝜏</ci><ci id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.3a.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.3"><mtext id="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p2.1.m1.2.2.2.2.2.2.3">in</mtext></ci></apply></interval></apply><apply id="S3.SS2.SSS3.p2.1.m1.2.2.4.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4"><apply id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1">superscript</csymbol><apply id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1">subscript</csymbol><sum id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.2"></sum><apply id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3"><eq id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.1"></eq><ci id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.2">𝑖</ci><cn id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.3.cmml" type="integer" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.2.3.3">0</cn></apply></apply><ci id="S3.SS2.SSS3.p2.1.m1.2.2.4.1.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.1.3">𝑇</ci></apply><apply id="S3.SS2.SSS3.p2.1.m1.2.2.4.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.1.m1.2.2.4.2.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.2">subscript</csymbol><ci id="S3.SS2.SSS3.p2.1.m1.2.2.4.2.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.2.2">𝑟</ci><ci id="S3.SS2.SSS3.p2.1.m1.2.2.4.2.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.2.2.4.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.1.m1.2c">s_{\text{u}}(\tau_{\text{ret}},\tau_{\text{in}})=\sum_{i=0}^{T}r_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p2.1.m1.2d">italic_s start_POSTSUBSCRIPT u end_POSTSUBSCRIPT ( italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT , italic_τ start_POSTSUBSCRIPT in end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
We apply this reweighting to the retrieved experiences in <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p2.2.m2.1"><semantics id="S3.SS2.SSS3.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.p2.2.m2.1.1" xref="S3.SS2.SSS3.p2.2.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.2.m2.1b"><ci id="S3.SS2.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p2.2.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.2.m2.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p2.2.m2.1d">caligraphic_R</annotation></semantics></math> and select the top-<math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p2.3.m3.1"><semantics id="S3.SS2.SSS3.p2.3.m3.1a"><mi id="S3.SS2.SSS3.p2.3.m3.1.1" xref="S3.SS2.SSS3.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.3.m3.1b"><ci id="S3.SS2.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p2.3.m3.1d">italic_k</annotation></semantics></math> elements by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{S}=\operatorname*{arg\,max}^{k}_{\bm{k},\tau_{\text{ret}}\in\mathcal{%
R}}s_{\text{ret}}(\bm{k},\bm{q},\tau_{\text{ret}})," class="ltx_Math" display="block" id="S3.E5.m1.5"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5.1.1.3" xref="S3.E5.m1.5.5.1.1.3.cmml">𝒮</mi><mo id="S3.E5.m1.5.5.1.1.2" xref="S3.E5.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.5.5.1.1.1" xref="S3.E5.m1.5.5.1.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.3.cmml"><munderover id="S3.E5.m1.5.5.1.1.1.3.1" xref="S3.E5.m1.5.5.1.1.1.3.1.cmml"><mrow id="S3.E5.m1.5.5.1.1.1.3.1.2.2" xref="S3.E5.m1.5.5.1.1.1.3.1.2.2.cmml"><mi id="S3.E5.m1.5.5.1.1.1.3.1.2.2.2" xref="S3.E5.m1.5.5.1.1.1.3.1.2.2.2.cmml">arg</mi><mo id="S3.E5.m1.5.5.1.1.1.3.1.2.2.1" lspace="0.170em" xref="S3.E5.m1.5.5.1.1.1.3.1.2.2.1.cmml">⁢</mo><mi id="S3.E5.m1.5.5.1.1.1.3.1.2.2.3" xref="S3.E5.m1.5.5.1.1.1.3.1.2.2.3.cmml">max</mi></mrow><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml"><mrow id="S3.E5.m1.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">𝒌</mi><mo id="S3.E5.m1.2.2.2.2.1.2" xref="S3.E5.m1.2.2.2.2.2.cmml">,</mo><msub id="S3.E5.m1.2.2.2.2.1.1" xref="S3.E5.m1.2.2.2.2.1.1.cmml"><mi id="S3.E5.m1.2.2.2.2.1.1.2" xref="S3.E5.m1.2.2.2.2.1.1.2.cmml">τ</mi><mtext id="S3.E5.m1.2.2.2.2.1.1.3" xref="S3.E5.m1.2.2.2.2.1.1.3a.cmml">ret</mtext></msub></mrow><mo id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.4.cmml">ℛ</mi></mrow><mi id="S3.E5.m1.5.5.1.1.1.3.1.2.3" xref="S3.E5.m1.5.5.1.1.1.3.1.2.3.cmml">k</mi></munderover><mo id="S3.E5.m1.5.5.1.1.1.3a" xref="S3.E5.m1.5.5.1.1.1.3.cmml">⁡</mo><msub id="S3.E5.m1.5.5.1.1.1.3.2" xref="S3.E5.m1.5.5.1.1.1.3.2.cmml"><mi id="S3.E5.m1.5.5.1.1.1.3.2.2" xref="S3.E5.m1.5.5.1.1.1.3.2.2.cmml">s</mi><mtext id="S3.E5.m1.5.5.1.1.1.3.2.3" xref="S3.E5.m1.5.5.1.1.1.3.2.3a.cmml">ret</mtext></msub></mrow><mo id="S3.E5.m1.5.5.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E5.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">𝒌</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">,</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">𝒒</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.4" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">,</mo><msub id="S3.E5.m1.5.5.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.cmml">τ</mi><mtext id="S3.E5.m1.5.5.1.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.3a.cmml">ret</mtext></msub><mo id="S3.E5.m1.5.5.1.1.1.1.1.5" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1"><eq id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.2"></eq><ci id="S3.E5.m1.5.5.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.3">𝒮</ci><apply id="S3.E5.m1.5.5.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1"><times id="S3.E5.m1.5.5.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.2"></times><apply id="S3.E5.m1.5.5.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.3"><apply id="S3.E5.m1.5.5.1.1.1.3.1.cmml" xref="S3.E5.m1.5.5.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.3.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.3.1">subscript</csymbol><apply id="S3.E5.m1.5.5.1.1.1.3.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.3.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.3.1">superscript</csymbol><apply id="S3.E5.m1.5.5.1.1.1.3.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.3.1.2.2"><times id="S3.E5.m1.5.5.1.1.1.3.1.2.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.3.1.2.2.1"></times><ci id="S3.E5.m1.5.5.1.1.1.3.1.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.3.1.2.2.2">arg</ci><ci id="S3.E5.m1.5.5.1.1.1.3.1.2.2.3.cmml" xref="S3.E5.m1.5.5.1.1.1.3.1.2.2.3">max</ci></apply><ci id="S3.E5.m1.5.5.1.1.1.3.1.2.3.cmml" xref="S3.E5.m1.5.5.1.1.1.3.1.2.3">𝑘</ci></apply><apply id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"><in id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.3"></in><list id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.1"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝒌</ci><apply id="S3.E5.m1.2.2.2.2.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.2">𝜏</ci><ci id="S3.E5.m1.2.2.2.2.1.1.3a.cmml" xref="S3.E5.m1.2.2.2.2.1.1.3"><mtext id="S3.E5.m1.2.2.2.2.1.1.3.cmml" mathsize="50%" xref="S3.E5.m1.2.2.2.2.1.1.3">ret</mtext></ci></apply></list><ci id="S3.E5.m1.2.2.2.4.cmml" xref="S3.E5.m1.2.2.2.4">ℛ</ci></apply></apply><apply id="S3.E5.m1.5.5.1.1.1.3.2.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.3.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.3.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2.2">𝑠</ci><ci id="S3.E5.m1.5.5.1.1.1.3.2.3a.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2.3"><mtext id="S3.E5.m1.5.5.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E5.m1.5.5.1.1.1.3.2.3">ret</mtext></ci></apply></apply><vector id="S3.E5.m1.5.5.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1"><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝒌</ci><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝒒</ci><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2">𝜏</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.3a.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.3"><mtext id="S3.E5.m1.5.5.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E5.m1.5.5.1.1.1.1.1.1.3">ret</mtext></ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">\mathcal{S}=\operatorname*{arg\,max}^{k}_{\bm{k},\tau_{\text{ret}}\in\mathcal{%
R}}s_{\text{ret}}(\bm{k},\bm{q},\tau_{\text{ret}}),</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.5d">caligraphic_S = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT bold_italic_k , italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ∈ caligraphic_R end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ( bold_italic_k , bold_italic_q , italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S3.SS2.SSS3.fig1">
<figure class="ltx_float ltx_minipage ltx_align_middle ltx_framed ltx_framed_top" id="alg1" style="width:210.7pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> In-context Learning with RA-DT</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline">0:</span>  DT <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg1.l0.m1.1"><semantics id="alg1.l0.m1.1a"><msub id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml"><mi id="alg1.l0.m1.1.1.2" xref="alg1.l0.m1.1.1.2.cmml">π</mi><mi id="alg1.l0.m1.1.1.3" xref="alg1.l0.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><apply id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m1.1.1.1.cmml" xref="alg1.l0.m1.1.1">subscript</csymbol><ci id="alg1.l0.m1.1.1.2.cmml" xref="alg1.l0.m1.1.1.2">𝜋</ci><ci id="alg1.l0.m1.1.1.3.cmml" xref="alg1.l0.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, embed model <math alttext="g" class="ltx_Math" display="inline" id="alg1.l0.m2.1"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">g</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">italic_g</annotation></semantics></math>, episodes <math alttext="N" class="ltx_Math" display="inline" id="alg1.l0.m3.1"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.1d">italic_N</annotation></semantics></math>, episode len <math alttext="T" class="ltx_Math" display="inline" id="alg1.l0.m4.1"><semantics id="alg1.l0.m4.1a"><mi id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><ci id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m4.1d">italic_T</annotation></semantics></math>, context len <math alttext="C" class="ltx_Math" display="inline" id="alg1.l0.m5.1"><semantics id="alg1.l0.m5.1a"><mi id="alg1.l0.m5.1.1" xref="alg1.l0.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><ci id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m5.1d">italic_C</annotation></semantics></math>, <span class="ltx_text ltx_font_typewriter" id="alg1.l0.1">retrieve</span>, <span class="ltx_text ltx_font_typewriter" id="alg1.l0.2">reweight</span>.

</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math alttext="\mathcal{I}\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">ℐ</mi><mo id="alg1.l1.m1.1.1.1" stretchy="false" xref="alg1.l1.m1.1.1.1.cmml">←</mo><mi id="alg1.l1.m1.1.1.3" mathvariant="normal" xref="alg1.l1.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">←</ci><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">ℐ</ci><emptyset id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{I}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">caligraphic_I ← ∅</annotation></semantics></math> <span class="ltx_text" id="alg1.l1.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l1.1.m1.1"><semantics id="alg1.l1.1.m1.1a"><mo id="alg1.l1.1.m1.1.1" xref="alg1.l1.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l1.1.m1.1b"><ci id="alg1.l1.1.m1.1.1.cmml" xref="alg1.l1.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.1.m1.1d">▷</annotation></semantics></math> Inititalize index
</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l2.1">for</span> <math alttext="1\dots N" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mn id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">1</mn><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3" mathvariant="normal" xref="alg1.l2.m1.1.1.3.cmml">…</mi><mo id="alg1.l2.m1.1.1.1a" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.4" xref="alg1.l2.m1.1.1.4.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><times id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></times><cn id="alg1.l2.m1.1.1.2.cmml" type="integer" xref="alg1.l2.m1.1.1.2">1</cn><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">…</ci><ci id="alg1.l2.m1.1.1.4.cmml" xref="alg1.l2.m1.1.1.4">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">1\dots N</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">1 … italic_N</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l2.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <math alttext="s,\tau\leftarrow\texttt{env.reset()},\emptyset" class="ltx_Math" display="inline" id="alg1.l3.m1.4"><semantics id="alg1.l3.m1.4a"><mrow id="alg1.l3.m1.4.4.1" xref="alg1.l3.m1.4.4.2.cmml"><mrow id="alg1.l3.m1.4.4.1.1" xref="alg1.l3.m1.4.4.1.1.cmml"><mrow id="alg1.l3.m1.4.4.1.1.2.2" xref="alg1.l3.m1.4.4.1.1.2.1.cmml"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">s</mi><mo id="alg1.l3.m1.4.4.1.1.2.2.1" xref="alg1.l3.m1.4.4.1.1.2.1.cmml">,</mo><mi id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">τ</mi></mrow><mo id="alg1.l3.m1.4.4.1.1.1" stretchy="false" xref="alg1.l3.m1.4.4.1.1.1.cmml">←</mo><mtext class="ltx_mathvariant_monospace" id="alg1.l3.m1.4.4.1.1.3" xref="alg1.l3.m1.4.4.1.1.3a.cmml">env.reset()</mtext></mrow><mo id="alg1.l3.m1.4.4.1.2" xref="alg1.l3.m1.4.4.2a.cmml">,</mo><mi id="alg1.l3.m1.3.3" mathvariant="normal" xref="alg1.l3.m1.3.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.4b"><apply id="alg1.l3.m1.4.4.2.cmml" xref="alg1.l3.m1.4.4.1"><csymbol cd="ambiguous" id="alg1.l3.m1.4.4.2a.cmml" xref="alg1.l3.m1.4.4.1.2">formulae-sequence</csymbol><apply id="alg1.l3.m1.4.4.1.1.cmml" xref="alg1.l3.m1.4.4.1.1"><ci id="alg1.l3.m1.4.4.1.1.1.cmml" xref="alg1.l3.m1.4.4.1.1.1">←</ci><list id="alg1.l3.m1.4.4.1.1.2.1.cmml" xref="alg1.l3.m1.4.4.1.1.2.2"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑠</ci><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">𝜏</ci></list><ci id="alg1.l3.m1.4.4.1.1.3a.cmml" xref="alg1.l3.m1.4.4.1.1.3"><mtext class="ltx_mathvariant_monospace" id="alg1.l3.m1.4.4.1.1.3.cmml" xref="alg1.l3.m1.4.4.1.1.3">env.reset()</mtext></ci></apply><emptyset id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.4c">s,\tau\leftarrow\texttt{env.reset()},\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.4d">italic_s , italic_τ ← env.reset() , ∅</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l4.1">for</span> <math alttext="t=1\dots T" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">t</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mn id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">1</mn><mo id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.3.3" mathvariant="normal" xref="alg1.l4.m1.1.1.3.3.cmml">…</mi><mo id="alg1.l4.m1.1.1.3.1a" xref="alg1.l4.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.3.4" xref="alg1.l4.m1.1.1.3.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑡</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><times id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></times><cn id="alg1.l4.m1.1.1.3.2.cmml" type="integer" xref="alg1.l4.m1.1.1.3.2">1</cn><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">…</ci><ci id="alg1.l4.m1.1.1.3.4.cmml" xref="alg1.l4.m1.1.1.3.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">t=1\dots T</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_t = 1 … italic_T</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>        <math alttext="\bm{q}=g(\tau_{t-C:t})" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">𝒒</mi><mo id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">=</mo><mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.1.1.3.cmml">g</mi><mo id="alg1.l5.m1.1.1.1.2" xref="alg1.l5.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l5.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.cmml">τ</mi><mrow id="alg1.l5.m1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml"><mrow id="alg1.l5.m1.1.1.1.1.1.1.3.2" xref="alg1.l5.m1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.3.2.2" xref="alg1.l5.m1.1.1.1.1.1.1.3.2.2.cmml">t</mi><mo id="alg1.l5.m1.1.1.1.1.1.1.3.2.1" xref="alg1.l5.m1.1.1.1.1.1.1.3.2.1.cmml">−</mo><mi id="alg1.l5.m1.1.1.1.1.1.1.3.2.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.2.3.cmml">C</mi></mrow><mo id="alg1.l5.m1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l5.m1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="alg1.l5.m1.1.1.1.1.1.1.3.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="alg1.l5.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><eq id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"></eq><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝒒</ci><apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"><times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2"></times><ci id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3">𝑔</ci><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2">𝜏</ci><apply id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3"><ci id="alg1.l5.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3.1">:</ci><apply id="alg1.l5.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3.2"><minus id="alg1.l5.m1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3.2.1"></minus><ci id="alg1.l5.m1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3.2.2">𝑡</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.3.2.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3.2.3">𝐶</ci></apply><ci id="alg1.l5.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\bm{q}=g(\tau_{t-C:t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">bold_italic_q = italic_g ( italic_τ start_POSTSUBSCRIPT italic_t - italic_C : italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l5.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l5.1.m1.1"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.1.m1.1d">▷</annotation></semantics></math> Construct query
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>        <math alttext="\mathcal{R}\leftarrow\text{{retrieve}}(\bm{q},\mathcal{I})" class="ltx_Math" display="inline" id="alg1.l6.m1.2"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.3" xref="alg1.l6.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.2.3.2" xref="alg1.l6.m1.2.3.2.cmml">ℛ</mi><mo id="alg1.l6.m1.2.3.1" stretchy="false" xref="alg1.l6.m1.2.3.1.cmml">←</mo><mrow id="alg1.l6.m1.2.3.3" xref="alg1.l6.m1.2.3.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l6.m1.2.3.3.2" xref="alg1.l6.m1.2.3.3.2a.cmml">retrieve</mtext><mo id="alg1.l6.m1.2.3.3.1" xref="alg1.l6.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l6.m1.2.3.3.3.2" xref="alg1.l6.m1.2.3.3.3.1.cmml"><mo id="alg1.l6.m1.2.3.3.3.2.1" stretchy="false" xref="alg1.l6.m1.2.3.3.3.1.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">𝒒</mi><mo id="alg1.l6.m1.2.3.3.3.2.2" xref="alg1.l6.m1.2.3.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">ℐ</mi><mo id="alg1.l6.m1.2.3.3.3.2.3" stretchy="false" xref="alg1.l6.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.3.cmml" xref="alg1.l6.m1.2.3"><ci id="alg1.l6.m1.2.3.1.cmml" xref="alg1.l6.m1.2.3.1">←</ci><ci id="alg1.l6.m1.2.3.2.cmml" xref="alg1.l6.m1.2.3.2">ℛ</ci><apply id="alg1.l6.m1.2.3.3.cmml" xref="alg1.l6.m1.2.3.3"><times id="alg1.l6.m1.2.3.3.1.cmml" xref="alg1.l6.m1.2.3.3.1"></times><ci id="alg1.l6.m1.2.3.3.2a.cmml" xref="alg1.l6.m1.2.3.3.2"><mtext class="ltx_mathvariant_monospace" id="alg1.l6.m1.2.3.3.2.cmml" xref="alg1.l6.m1.2.3.3.2">retrieve</mtext></ci><interval closure="open" id="alg1.l6.m1.2.3.3.3.1.cmml" xref="alg1.l6.m1.2.3.3.3.2"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝒒</ci><ci id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">ℐ</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">\mathcal{R}\leftarrow\text{{retrieve}}(\bm{q},\mathcal{I})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.2d">caligraphic_R ← retrieve ( bold_italic_q , caligraphic_I )</annotation></semantics></math> <span class="ltx_text" id="alg1.l6.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.m1.1d">▷</annotation></semantics></math> Top-<math alttext="l" class="ltx_Math" display="inline" id="alg1.l6.2.m2.1"><semantics id="alg1.l6.2.m2.1a"><mi id="alg1.l6.2.m2.1.1" xref="alg1.l6.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.2.m2.1b"><ci id="alg1.l6.2.m2.1.1.cmml" xref="alg1.l6.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.2.m2.1d">italic_l</annotation></semantics></math> trjs, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.E3" title="In 3.2.2 Searching for Similar Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3</span></a>
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>        <math alttext="\mathcal{S}\leftarrow\text{{reweight}}(\mathcal{R})" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.2" xref="alg1.l7.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.2.2" xref="alg1.l7.m1.1.2.2.cmml">𝒮</mi><mo id="alg1.l7.m1.1.2.1" stretchy="false" xref="alg1.l7.m1.1.2.1.cmml">←</mo><mrow id="alg1.l7.m1.1.2.3" xref="alg1.l7.m1.1.2.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l7.m1.1.2.3.2" xref="alg1.l7.m1.1.2.3.2a.cmml">reweight</mtext><mo id="alg1.l7.m1.1.2.3.1" xref="alg1.l7.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l7.m1.1.2.3.3.2" xref="alg1.l7.m1.1.2.3.cmml"><mo id="alg1.l7.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l7.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">ℛ</mi><mo id="alg1.l7.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l7.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.2.cmml" xref="alg1.l7.m1.1.2"><ci id="alg1.l7.m1.1.2.1.cmml" xref="alg1.l7.m1.1.2.1">←</ci><ci id="alg1.l7.m1.1.2.2.cmml" xref="alg1.l7.m1.1.2.2">𝒮</ci><apply id="alg1.l7.m1.1.2.3.cmml" xref="alg1.l7.m1.1.2.3"><times id="alg1.l7.m1.1.2.3.1.cmml" xref="alg1.l7.m1.1.2.3.1"></times><ci id="alg1.l7.m1.1.2.3.2a.cmml" xref="alg1.l7.m1.1.2.3.2"><mtext class="ltx_mathvariant_monospace" id="alg1.l7.m1.1.2.3.2.cmml" xref="alg1.l7.m1.1.2.3.2">reweight</mtext></ci><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">ℛ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\mathcal{S}\leftarrow\text{{reweight}}(\mathcal{R})</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">caligraphic_S ← reweight ( caligraphic_R )</annotation></semantics></math> <span class="ltx_text" id="alg1.l7.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l7.1.m1.1"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.1.m1.1d">▷</annotation></semantics></math> Top-<math alttext="k" class="ltx_Math" display="inline" id="alg1.l7.2.m2.1"><semantics id="alg1.l7.2.m2.1a"><mi id="alg1.l7.2.m2.1.1" xref="alg1.l7.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.2.m2.1b"><ci id="alg1.l7.2.m2.1.1.cmml" xref="alg1.l7.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.2.m2.1d">italic_k</annotation></semantics></math>, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.E4" title="In 3.2.3 Reweighting Retrieved Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.E5" title="In 3.2.3 Reweighting Retrieved Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">5</span></a>
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>        <math alttext="a\sim\pi_{\theta}(a\mid\tau_{t-C:t},\{\tau_{\text{ret}}\in\mathcal{S}\})" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">a</mi><mo id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml"><msub id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.3.2.cmml">π</mi><mi id="alg1.l8.m1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="alg1.l8.m1.1.1.1.2" xref="alg1.l8.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l8.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.4" xref="alg1.l8.m1.1.1.1.1.1.1.4.cmml">a</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.3.cmml"><msub id="alg1.l8.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml">τ</mi><mrow id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">t</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">−</mo><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">C</mi></mrow><mo id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="alg1.l8.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mo id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.2" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.cmml">{</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.cmml"><msub id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.2.cmml">τ</mi><mtext id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.3a.cmml">ret</mtext></msub><mo id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.3.cmml">𝒮</mi></mrow><mo id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.3" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.cmml">}</mo></mrow></mrow></mrow><mo id="alg1.l8.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="latexml" id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">similar-to</csymbol><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑎</ci><apply id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"><times id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.2"></times><apply id="alg1.l8.m1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.3.2">𝜋</ci><ci id="alg1.l8.m1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.3.3">𝜃</ci></apply><apply id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l8.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3">conditional</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.4">𝑎</ci><list id="alg1.l8.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2"><apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2">𝜏</ci><apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3"><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.1">:</ci><apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2"><minus id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.1"></minus><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝑡</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝐶</ci></apply><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><set id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1"><apply id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1"><in id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.1"></in><apply id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.2">𝜏</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.3a.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.3"><mtext id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.3.cmml" mathsize="70%" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.2.3">ret</mtext></ci></apply><ci id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.1.3">𝒮</ci></apply></set></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">a\sim\pi_{\theta}(a\mid\tau_{t-C:t},\{\tau_{\text{ret}}\in\mathcal{S}\})</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_a ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a ∣ italic_τ start_POSTSUBSCRIPT italic_t - italic_C : italic_t end_POSTSUBSCRIPT , { italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ∈ caligraphic_S } )</annotation></semantics></math> <span class="ltx_text" id="alg1.l8.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l8.1.m1.1"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.1.m1.1d">▷</annotation></semantics></math> Predict
</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>        <math alttext="s^{\prime},r\leftarrow\texttt{env.step}(a)" class="ltx_Math" display="inline" id="alg1.l9.m1.3"><semantics id="alg1.l9.m1.3a"><mrow id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml"><mrow id="alg1.l9.m1.3.3.1.1" xref="alg1.l9.m1.3.3.1.2.cmml"><msup id="alg1.l9.m1.3.3.1.1.1" xref="alg1.l9.m1.3.3.1.1.1.cmml"><mi id="alg1.l9.m1.3.3.1.1.1.2" xref="alg1.l9.m1.3.3.1.1.1.2.cmml">s</mi><mo id="alg1.l9.m1.3.3.1.1.1.3" xref="alg1.l9.m1.3.3.1.1.1.3.cmml">′</mo></msup><mo id="alg1.l9.m1.3.3.1.1.2" xref="alg1.l9.m1.3.3.1.2.cmml">,</mo><mi id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml">r</mi></mrow><mo id="alg1.l9.m1.3.3.2" stretchy="false" xref="alg1.l9.m1.3.3.2.cmml">←</mo><mrow id="alg1.l9.m1.3.3.3" xref="alg1.l9.m1.3.3.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.l9.m1.3.3.3.2" xref="alg1.l9.m1.3.3.3.2a.cmml">env.step</mtext><mo id="alg1.l9.m1.3.3.3.1" xref="alg1.l9.m1.3.3.3.1.cmml">⁢</mo><mrow id="alg1.l9.m1.3.3.3.3.2" xref="alg1.l9.m1.3.3.3.cmml"><mo id="alg1.l9.m1.3.3.3.3.2.1" stretchy="false" xref="alg1.l9.m1.3.3.3.cmml">(</mo><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">a</mi><mo id="alg1.l9.m1.3.3.3.3.2.2" stretchy="false" xref="alg1.l9.m1.3.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.3b"><apply id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3"><ci id="alg1.l9.m1.3.3.2.cmml" xref="alg1.l9.m1.3.3.2">←</ci><list id="alg1.l9.m1.3.3.1.2.cmml" xref="alg1.l9.m1.3.3.1.1"><apply id="alg1.l9.m1.3.3.1.1.1.cmml" xref="alg1.l9.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.1.1.1.1.cmml" xref="alg1.l9.m1.3.3.1.1.1">superscript</csymbol><ci id="alg1.l9.m1.3.3.1.1.1.2.cmml" xref="alg1.l9.m1.3.3.1.1.1.2">𝑠</ci><ci id="alg1.l9.m1.3.3.1.1.1.3.cmml" xref="alg1.l9.m1.3.3.1.1.1.3">′</ci></apply><ci id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2">𝑟</ci></list><apply id="alg1.l9.m1.3.3.3.cmml" xref="alg1.l9.m1.3.3.3"><times id="alg1.l9.m1.3.3.3.1.cmml" xref="alg1.l9.m1.3.3.3.1"></times><ci id="alg1.l9.m1.3.3.3.2a.cmml" xref="alg1.l9.m1.3.3.3.2"><mtext class="ltx_mathvariant_monospace" id="alg1.l9.m1.3.3.3.2.cmml" xref="alg1.l9.m1.3.3.3.2">env.step</mtext></ci><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.3c">s^{\prime},r\leftarrow\texttt{env.step}(a)</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.3d">italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_r ← env.step ( italic_a )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>        <math alttext="\tau\leftarrow\tau\cup(s,a,r)" class="ltx_Math" display="inline" id="alg1.l10.m1.3"><semantics id="alg1.l10.m1.3a"><mrow id="alg1.l10.m1.3.4" xref="alg1.l10.m1.3.4.cmml"><mi id="alg1.l10.m1.3.4.2" xref="alg1.l10.m1.3.4.2.cmml">τ</mi><mo id="alg1.l10.m1.3.4.1" stretchy="false" xref="alg1.l10.m1.3.4.1.cmml">←</mo><mrow id="alg1.l10.m1.3.4.3" xref="alg1.l10.m1.3.4.3.cmml"><mi id="alg1.l10.m1.3.4.3.2" xref="alg1.l10.m1.3.4.3.2.cmml">τ</mi><mo id="alg1.l10.m1.3.4.3.1" xref="alg1.l10.m1.3.4.3.1.cmml">∪</mo><mrow id="alg1.l10.m1.3.4.3.3.2" xref="alg1.l10.m1.3.4.3.3.1.cmml"><mo id="alg1.l10.m1.3.4.3.3.2.1" stretchy="false" xref="alg1.l10.m1.3.4.3.3.1.cmml">(</mo><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">s</mi><mo id="alg1.l10.m1.3.4.3.3.2.2" xref="alg1.l10.m1.3.4.3.3.1.cmml">,</mo><mi id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml">a</mi><mo id="alg1.l10.m1.3.4.3.3.2.3" xref="alg1.l10.m1.3.4.3.3.1.cmml">,</mo><mi id="alg1.l10.m1.3.3" xref="alg1.l10.m1.3.3.cmml">r</mi><mo id="alg1.l10.m1.3.4.3.3.2.4" stretchy="false" xref="alg1.l10.m1.3.4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.3b"><apply id="alg1.l10.m1.3.4.cmml" xref="alg1.l10.m1.3.4"><ci id="alg1.l10.m1.3.4.1.cmml" xref="alg1.l10.m1.3.4.1">←</ci><ci id="alg1.l10.m1.3.4.2.cmml" xref="alg1.l10.m1.3.4.2">𝜏</ci><apply id="alg1.l10.m1.3.4.3.cmml" xref="alg1.l10.m1.3.4.3"><union id="alg1.l10.m1.3.4.3.1.cmml" xref="alg1.l10.m1.3.4.3.1"></union><ci id="alg1.l10.m1.3.4.3.2.cmml" xref="alg1.l10.m1.3.4.3.2">𝜏</ci><vector id="alg1.l10.m1.3.4.3.3.1.cmml" xref="alg1.l10.m1.3.4.3.3.2"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝑠</ci><ci id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2">𝑎</ci><ci id="alg1.l10.m1.3.3.cmml" xref="alg1.l10.m1.3.3">𝑟</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.3c">\tau\leftarrow\tau\cup(s,a,r)</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.3d">italic_τ ← italic_τ ∪ ( italic_s , italic_a , italic_r )</annotation></semantics></math> <span class="ltx_text" id="alg1.l10.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l10.1.m1.1"><semantics id="alg1.l10.1.m1.1a"><mo id="alg1.l10.1.m1.1.1" xref="alg1.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.1.m1.1b"><ci id="alg1.l10.1.m1.1.1.cmml" xref="alg1.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.1.m1.1d">▷</annotation></semantics></math> Append transition to <math alttext="\tau" class="ltx_Math" display="inline" id="alg1.l10.2.m2.1"><semantics id="alg1.l10.2.m2.1a"><mi id="alg1.l10.2.m2.1.1" xref="alg1.l10.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.2.m2.1b"><ci id="alg1.l10.2.m2.1.1.cmml" xref="alg1.l10.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.2.m2.1d">italic_τ</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>        <math alttext="s\leftarrow s^{\prime}" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">s</mi><mo id="alg1.l11.m1.1.1.1" stretchy="false" xref="alg1.l11.m1.1.1.1.cmml">←</mo><msup id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝑠</ci><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3">superscript</csymbol><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝑠</ci><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">s\leftarrow s^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">italic_s ← italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l12.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l12.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <math alttext="\mathcal{I}\leftarrow\mathcal{I}\cup\tau" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">ℐ</mi><mo id="alg1.l13.m1.1.1.1" stretchy="false" xref="alg1.l13.m1.1.1.1.cmml">←</mo><mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">ℐ</mi><mo id="alg1.l13.m1.1.1.3.1" xref="alg1.l13.m1.1.1.3.1.cmml">∪</mo><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">τ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><ci id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1">←</ci><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">ℐ</ci><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><union id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1"></union><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">ℐ</ci><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\mathcal{I}\leftarrow\mathcal{I}\cup\tau</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">caligraphic_I ← caligraphic_I ∪ italic_τ</annotation></semantics></math><span class="ltx_text" id="alg1.l13.3" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l13.1.m1.1"><semantics id="alg1.l13.1.m1.1a"><mo id="alg1.l13.1.m1.1.1" xref="alg1.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l13.1.m1.1b"><ci id="alg1.l13.1.m1.1.1.cmml" xref="alg1.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.1.m1.1d">▷</annotation></semantics></math> Add trajectory <math alttext="\tau" class="ltx_Math" display="inline" id="alg1.l13.2.m2.1"><semantics id="alg1.l13.2.m2.1a"><mi id="alg1.l13.2.m2.1.1" xref="alg1.l13.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.2.m2.1b"><ci id="alg1.l13.2.m2.1.1.cmml" xref="alg1.l13.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.2.m2.1d">italic_τ</annotation></semantics></math> to index <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="alg1.l13.3.m3.1"><semantics id="alg1.l13.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.3.m3.1.1" xref="alg1.l13.3.m3.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.3.m3.1b"><ci id="alg1.l13.3.m3.1.1.cmml" xref="alg1.l13.3.m3.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.3.m3.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.3.m3.1d">caligraphic_I</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l14.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l14.2">for</span>
</div>
</div>
</figure>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS3.p3">
<p class="ltx_p" id="S3.SS2.SSS3.p3.1">where we normalize both scores to be in the range <math alttext="[0,1]" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p3.1.m1.2"><semantics id="S3.SS2.SSS3.p3.1.m1.2a"><mrow id="S3.SS2.SSS3.p3.1.m1.2.3.2" xref="S3.SS2.SSS3.p3.1.m1.2.3.1.cmml"><mo id="S3.SS2.SSS3.p3.1.m1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS3.p3.1.m1.2.3.1.cmml">[</mo><mn id="S3.SS2.SSS3.p3.1.m1.1.1" xref="S3.SS2.SSS3.p3.1.m1.1.1.cmml">0</mn><mo id="S3.SS2.SSS3.p3.1.m1.2.3.2.2" xref="S3.SS2.SSS3.p3.1.m1.2.3.1.cmml">,</mo><mn id="S3.SS2.SSS3.p3.1.m1.2.2" xref="S3.SS2.SSS3.p3.1.m1.2.2.cmml">1</mn><mo id="S3.SS2.SSS3.p3.1.m1.2.3.2.3" stretchy="false" xref="S3.SS2.SSS3.p3.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p3.1.m1.2b"><interval closure="closed" id="S3.SS2.SSS3.p3.1.m1.2.3.1.cmml" xref="S3.SS2.SSS3.p3.1.m1.2.3.2"><cn id="S3.SS2.SSS3.p3.1.m1.1.1.cmml" type="integer" xref="S3.SS2.SSS3.p3.1.m1.1.1">0</cn><cn id="S3.SS2.SSS3.p3.1.m1.2.2.cmml" type="integer" xref="S3.SS2.SSS3.p3.1.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p3.1.m1.2c">[0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p3.1.m1.2d">[ 0 , 1 ]</annotation></semantics></math>, such that they contribute equally to the final weight.
Our reweighting mechanism is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.F2" title="Figure 2 ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.4 </span>Incorporating Retrieved 
<br class="ltx_break"/>Experiences</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS4.p1">
<p class="ltx_p" id="S3.SS2.SSS4.p1.4">After reweighting, the set <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p1.1.m1.1"><semantics id="S3.SS2.SSS4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS4.p1.1.m1.1.1" xref="S3.SS2.SSS4.p1.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p1.1.m1.1b"><ci id="S3.SS2.SSS4.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS4.p1.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p1.1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p1.1.m1.1d">caligraphic_S</annotation></semantics></math> contains sub-trajectories that are both important and relevant for the current input <math alttext="\tau_{\text{in}}" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p1.2.m2.1"><semantics id="S3.SS2.SSS4.p1.2.m2.1a"><msub id="S3.SS2.SSS4.p1.2.m2.1.1" xref="S3.SS2.SSS4.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS4.p1.2.m2.1.1.2" xref="S3.SS2.SSS4.p1.2.m2.1.1.2.cmml">τ</mi><mtext id="S3.SS2.SSS4.p1.2.m2.1.1.3" xref="S3.SS2.SSS4.p1.2.m2.1.1.3a.cmml">in</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p1.2.m2.1b"><apply id="S3.SS2.SSS4.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS4.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS4.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS4.p1.2.m2.1.1.2">𝜏</ci><ci id="S3.SS2.SSS4.p1.2.m2.1.1.3a.cmml" xref="S3.SS2.SSS4.p1.2.m2.1.1.3"><mtext id="S3.SS2.SSS4.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS4.p1.2.m2.1.1.3">in</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p1.2.m2.1c">\tau_{\text{in}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p1.2.m2.1d">italic_τ start_POSTSUBSCRIPT in end_POSTSUBSCRIPT</annotation></semantics></math> to the DT <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p1.3.m3.1"><semantics id="S3.SS2.SSS4.p1.3.m3.1a"><msub id="S3.SS2.SSS4.p1.3.m3.1.1" xref="S3.SS2.SSS4.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS4.p1.3.m3.1.1.2" xref="S3.SS2.SSS4.p1.3.m3.1.1.2.cmml">π</mi><mi id="S3.SS2.SSS4.p1.3.m3.1.1.3" xref="S3.SS2.SSS4.p1.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p1.3.m3.1b"><apply id="S3.SS2.SSS4.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS4.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS4.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS4.p1.3.m3.1.1.2">𝜋</ci><ci id="S3.SS2.SSS4.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS4.p1.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p1.3.m3.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p1.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>.
To incorporate the retrieved experiences in the DT, we interleave it with cross-attention layers (CA) after every self-attention (SA) layer.
The retrieved sub-trajectories are encoded by separate embedding layers for each token type (state/action/reward/RTG) and then passed to the CA layers.
Thus, our RA-DT predicts actions <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS2.SSS4.p1.4.m4.1"><semantics id="S3.SS2.SSS4.p1.4.m4.1a"><msub id="S3.SS2.SSS4.p1.4.m4.1.1" xref="S3.SS2.SSS4.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS4.p1.4.m4.1.1.2" xref="S3.SS2.SSS4.p1.4.m4.1.1.2.cmml">a</mi><mi id="S3.SS2.SSS4.p1.4.m4.1.1.3" xref="S3.SS2.SSS4.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS4.p1.4.m4.1b"><apply id="S3.SS2.SSS4.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS4.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS4.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS4.p1.4.m4.1.1.2">𝑎</ci><ci id="S3.SS2.SSS4.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS4.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS4.p1.4.m4.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS4.p1.4.m4.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> given input trajectory and retrieved trajectory by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="a_{t}\sim\pi_{\theta}(a_{t}\mid\tau_{\text{in}},\{\tau_{\text{ret}}\in\mathcal%
{S}\})." class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml">a</mi><mi id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml">∼</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.3.2.cmml">π</mi><mi id="S3.E6.m1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.4.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.4.2.cmml">a</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.4.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">τ</mi><mtext id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">in</mtext></msub><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">{</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.2.cmml">τ</mi><mtext id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.3a.cmml">ret</mtext></msub><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.3.cmml">𝒮</mi></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">}</mo></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" lspace="0em" xref="S3.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2">similar-to</csymbol><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2">𝑎</ci><ci id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.3.2">𝜋</ci><ci id="S3.E6.m1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.4.2">𝑎</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="S3.E6.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝜏</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3">in</mtext></ci></apply><set id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1"><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1"><in id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.1"></in><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.2">𝜏</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.3"><mtext id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.2.3">ret</mtext></ci></apply><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.2.2.1.1.3">𝒮</ci></apply></set></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">a_{t}\sim\pi_{\theta}(a_{t}\mid\tau_{\text{in}},\{\tau_{\text{ret}}\in\mathcal%
{S}\}).</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_τ start_POSTSUBSCRIPT in end_POSTSUBSCRIPT , { italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ∈ caligraphic_S } ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS4.p2">
<p class="ltx_p" id="S3.SS2.SSS4.p2.1">In Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#alg1" title="Algorithm 1 ‣ 3.2.3 Reweighting Retrieved Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">1</span></a>, we show the pseudocode for in-context RL with RA-DT at <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS4.p2.1.1">inference</em> time.
In addition, we show RA-DT at <em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS4.p2.1.2">training</em> time in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#alg2" title="Algorithm 2 ‣ C.4 Retrieval-Augmented Decision Transformer ‣ Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">2</span></a> of Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS4" title="C.4 Retrieval-Augmented Decision Transformer ‣ Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">C.4</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="26" id="S3.F3.g1" src="extracted/5911726/figures/dark_keydoor/20x20/legend.png" width="449"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="S3.F3.sf1.g1" src="extracted/5911726/figures/darkroom/10x10/eval_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="S3.F3.sf1.2.m1.1"><semantics id="S3.F3.sf1.2.m1.1b"><mo id="S3.F3.sf1.2.m1.1.1" xref="S3.F3.sf1.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.F3.sf1.2.m1.1c"><times id="S3.F3.sf1.2.m1.1.1.cmml" xref="S3.F3.sf1.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf1.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S3.F3.sf1.2.m1.1e">×</annotation></semantics></math>10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="S3.F3.sf2.g1" src="extracted/5911726/figures/darkroom/20x20/eval_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Dark-Room 20<math alttext="\times" class="ltx_Math" display="inline" id="S3.F3.sf2.2.m1.1"><semantics id="S3.F3.sf2.2.m1.1b"><mo id="S3.F3.sf2.2.m1.1.1" xref="S3.F3.sf2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.F3.sf2.2.m1.1c"><times id="S3.F3.sf2.2.m1.1.1.cmml" xref="S3.F3.sf2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf2.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S3.F3.sf2.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="S3.F3.sf3.g1" src="extracted/5911726/figures/darkroom/40x20/eval_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Dark-Room 40<math alttext="\times" class="ltx_Math" display="inline" id="S3.F3.sf3.2.m1.1"><semantics id="S3.F3.sf3.2.m1.1b"><mo id="S3.F3.sf3.2.m1.1.1" xref="S3.F3.sf3.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.F3.sf3.2.m1.1c"><times id="S3.F3.sf3.2.m1.1.1.cmml" xref="S3.F3.sf3.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.sf3.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S3.F3.sf3.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>ICL performance on <span class="ltx_text ltx_font_bold" id="S3.F3.12.1">Dark-Room</span> <span class="ltx_text ltx_font_bold" id="S3.F3.13.2">(a)</span> 10<math alttext="\times" class="ltx_Math" display="inline" id="S3.F3.4.m1.1"><semantics id="S3.F3.4.m1.1b"><mo id="S3.F3.4.m1.1.1" xref="S3.F3.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.F3.4.m1.1c"><times id="S3.F3.4.m1.1.1.cmml" xref="S3.F3.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S3.F3.4.m1.1e">×</annotation></semantics></math>10, <span class="ltx_text ltx_font_bold" id="S3.F3.14.3">(b)</span> 20<math alttext="\times" class="ltx_Math" display="inline" id="S3.F3.5.m2.1"><semantics id="S3.F3.5.m2.1b"><mo id="S3.F3.5.m2.1.1" xref="S3.F3.5.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.F3.5.m2.1c"><times id="S3.F3.5.m2.1.1.cmml" xref="S3.F3.5.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.5.m2.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S3.F3.5.m2.1e">×</annotation></semantics></math>20, <span class="ltx_text ltx_font_bold" id="S3.F3.15.4">(c)</span> 40<math alttext="\times" class="ltx_Math" display="inline" id="S3.F3.6.m3.1"><semantics id="S3.F3.6.m3.1b"><mo id="S3.F3.6.m3.1.1" xref="S3.F3.6.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.F3.6.m3.1c"><times id="S3.F3.6.m3.1.1.cmml" xref="S3.F3.6.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.6.m3.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S3.F3.6.m3.1e">×</annotation></semantics></math>20 at end of training (100K steps). We evaluate each agent for 40 episodes on each of the 20 <span class="ltx_text ltx_font_bold" id="S3.F3.16.5">evaluation tasks</span> and report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We evaluate the ICL abilities of RA-DT on grid-world environments used in prior works, namely Dark-Room (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS1" title="4.1 Dark-Room ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4.1</span></a>), Dark Key-Door (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS2" title="4.2 Dark Key-Door ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4.2</span></a>), and MazeRunner (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS3" title="4.3 Maze-Runner ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4.3</span></a>) <cite class="ltx_cite ltx_citemacro_citep">[Laskin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib45" title="">2022</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib47" title="">2022</a>; Grigsby et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib25" title="">2023</a>]</cite>, with increasingly larger grid-sizes, resulting in longer episodes.
Moreover, we evaluate RA-DT on two robotic benchmarks (Meta-World and DMControl, Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS4" title="4.4 Meta-World &amp; DMControl ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4.4</span></a>) and procedurally-generated video games (Procgen, Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS5" title="4.5 Procgen ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4.5</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">Across experiments, we report performances for two variants of <span class="ltx_text ltx_font_bold" id="S4.p2.1.1">RA-DT</span>.
The first variant leverages a domain-specific embedding model for retrieval, specifically a DT trained on the same domain.
The second variant (<span class="ltx_text ltx_font_bold" id="S4.p2.1.2">RA-DT + Domain-agnostic</span>) makes use of the FH mechanism in combination with BERT <cite class="ltx_cite ltx_citemacro_citep">[Devlin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib16" title="">2019</a>]</cite> as the pre-trained LM.
Consequently, this variant of RA-DT does not require any domain-specific pre-training of the embedding model.
We compare RA-DT against the vanilla <span class="ltx_text ltx_font_bold" id="S4.p2.1.3">DT</span> and two established in-context RL methods, namely Algorithm Distillation <cite class="ltx_cite ltx_citemacro_citep">[Laskin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib45" title="">2022</a>, <span class="ltx_text ltx_font_bold" id="S4.p2.1.4.1">AD</span>]</cite> and Decision Pre-trained Transformer <cite class="ltx_cite ltx_citemacro_citep">[Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib46" title="">2023</a>, <span class="ltx_text ltx_font_bold" id="S4.p2.1.5.1">DPT</span>]</cite>.
Following, <cite class="ltx_cite ltx_citemacro_citet">Agarwal et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib1" title="">2021</a>]</cite> we report the mean across tasks and 95% confidence intervals over 3 seeds.
We use a context length equivalent to two episodes (from 200 up to 2000 timesteps) for AD, DPT and DT.
For RA-DT, we use a considerably shorter context length of 50 transitions, unless mentioned otherwise.
On grid-worlds, we train all methods for 100K steps and evaluate after every 25K steps.
Similarly, we train for 200K steps and evaluate after every 50K steps for Meta-World, DMControl and Procgen.
All grid-worlds and Procgen exhibit discrete actions and consequently, we train all methods via the cross-entropy loss to predict the next actions.
On Meta-World and DMControl, we train all method using the mean-squared error loss to predict continuous actions.
Following <cite class="ltx_cite ltx_citemacro_citet">Laskin et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib45" title="">2022</a>]</cite> and <cite class="ltx_cite ltx_citemacro_citet">Lee et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib46" title="">2023</a>]</cite>, our primary evaluation criterion is performance improvement during ICL trials.
After training, the agent interacts with the environment for a fixed amount of episodes, each of which is considered a single trial.
Upon completion of an ICL trial, the respective episode is stored in the vector index.
We provide further training and implementation details in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3" title="Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Dark-Room</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.8"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.8.1">Experiment Setup.</span> Dark-Room is commonly used in prior work on in-context RL <cite class="ltx_cite ltx_citemacro_citep">[Laskin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib45" title="">2022</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib46" title="">2023</a>]</cite>.
The agent is located in an empty room, observes only its x-y coordinates, and has to navigate to an invisible goal state (<math alttext="|\mathcal{S}|=2" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.2" xref="S4.SS1.p1.1.m1.1.2.cmml"><mrow id="S4.SS1.p1.1.m1.1.2.2.2" xref="S4.SS1.p1.1.m1.1.2.2.1.cmml"><mo id="S4.SS1.p1.1.m1.1.2.2.2.1" stretchy="false" xref="S4.SS1.p1.1.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">𝒮</mi><mo id="S4.SS1.p1.1.m1.1.2.2.2.2" stretchy="false" xref="S4.SS1.p1.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS1.p1.1.m1.1.2.1" xref="S4.SS1.p1.1.m1.1.2.1.cmml">=</mo><mn id="S4.SS1.p1.1.m1.1.2.3" xref="S4.SS1.p1.1.m1.1.2.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.2"><eq id="S4.SS1.p1.1.m1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.1"></eq><apply id="S4.SS1.p1.1.m1.1.2.2.1.cmml" xref="S4.SS1.p1.1.m1.1.2.2.2"><abs id="S4.SS1.p1.1.m1.1.2.2.1.1.cmml" xref="S4.SS1.p1.1.m1.1.2.2.2.1"></abs><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝒮</ci></apply><cn id="S4.SS1.p1.1.m1.1.2.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.2.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">|\mathcal{S}|=2</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">| caligraphic_S | = 2</annotation></semantics></math>, <math alttext="|\mathcal{A}|=5" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.2" xref="S4.SS1.p1.2.m2.1.2.cmml"><mrow id="S4.SS1.p1.2.m2.1.2.2.2" xref="S4.SS1.p1.2.m2.1.2.2.1.cmml"><mo id="S4.SS1.p1.2.m2.1.2.2.2.1" stretchy="false" xref="S4.SS1.p1.2.m2.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">𝒜</mi><mo id="S4.SS1.p1.2.m2.1.2.2.2.2" stretchy="false" xref="S4.SS1.p1.2.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS1.p1.2.m2.1.2.1" xref="S4.SS1.p1.2.m2.1.2.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.1.2.3" xref="S4.SS1.p1.2.m2.1.2.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.2.cmml" xref="S4.SS1.p1.2.m2.1.2"><eq id="S4.SS1.p1.2.m2.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.2.1"></eq><apply id="S4.SS1.p1.2.m2.1.2.2.1.cmml" xref="S4.SS1.p1.2.m2.1.2.2.2"><abs id="S4.SS1.p1.2.m2.1.2.2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.2.2.2.1"></abs><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝒜</ci></apply><cn id="S4.SS1.p1.2.m2.1.2.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.2.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">|\mathcal{A}|=5</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">| caligraphic_A | = 5</annotation></semantics></math>, see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F9" title="Figure 9 ‣ B.1 Dark-Room and Dark Key-Door ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">9</span></a>).
A reward of +1 is obtained in every step the agent is located in the goal state.
Because of partial observability, it must leverage memory of previous episodes to find the goal.
We conduct experiments on three different grid sizes, namely 10<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mo id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><times id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">×</annotation></semantics></math>10, 20<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mo id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><times id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">×</annotation></semantics></math>20, and 40<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mo id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><times id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">×</annotation></semantics></math>20, and corresponding episode lengths of 100, 200 and 800, respectively.
We designate 80 and 20 randomly assigned goals as train and evaluation locations, respectively, as in <cite class="ltx_cite ltx_citemacro_citet">Lee et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib46" title="">2023</a>]</cite>.
We use Proximal Policy Optimization (PPO) <cite class="ltx_cite ltx_citemacro_citep">[Schulman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib82" title="">2017</a>]</cite> to generate 100K transitions per goal for 10<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mo id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><times id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">×</annotation></semantics></math>10 and 20<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1"><semantics id="S4.SS1.p1.7.m7.1a"><mo id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><times id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">×</annotation></semantics></math>20 grids and 200K for 40<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m8.1"><semantics id="S4.SS1.p1.8.m8.1a"><mo id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><times id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m8.1d">×</annotation></semantics></math>20 (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F7" title="Figure 7 ‣ B.1 Dark-Room and Dark Key-Door ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">7</span></a> for single task expert scores).
During evaluation, the agent interacts with the environment for 40 ICL trials, and we report the scores at the last evaluation step (100K).
We provide additional details on the environment, the generated data, and the training procedure in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS1" title="B.1 Dark-Room and Dark Key-Door ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">B.1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3" title="Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.8"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.8.1">Results.</span>
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.F3" title="Figure 3 ‣ 3.2.4 Incorporating Retrieved Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3</span></a>, we show the ICL performances on the 20 hold-out tasks for all considered methods on Dark-Room <span class="ltx_text ltx_font_bold" id="S4.SS1.p2.8.2">(a)</span>10<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mo id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><times id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">×</annotation></semantics></math>10, <span class="ltx_text ltx_font_bold" id="S4.SS1.p2.8.3">(b)</span> 20<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mo id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><times id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">×</annotation></semantics></math>20, and <span class="ltx_text ltx_font_bold" id="S4.SS1.p2.8.4">(c)</span> 40<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mo id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><times id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">×</annotation></semantics></math>20.
In addition, we present the ICL curves on the training tasks and the learning curves across the entire training period in Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.F14" title="Figure 14 ‣ C.4 Retrieval-Augmented Decision Transformer ‣ Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">14</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F15" title="Figure 15 ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">15</span></a> in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS1" title="D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D.1</span></a>.
Overall, we observe that RA-DT attains the highest average rewards on all 3 grid-sizes at the end of the 40 ICL-trials.
On 10<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><mo id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><times id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">×</annotation></semantics></math>10, RA-DT obtains near-optimal performance scores both with the domain-specific and domain-agnostic embedding model.
The vanilla DT does not exhibit any performance improvement across trials.
This indicates the improvement in performance for RA-DT can be attributed to the retrieval component.
Furthermore, RA-DT outperforms AD and DPT without keeping entire episodes in its context window.
Similarly, RA-DT outperforms all baselines on the 20<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><mo id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><times id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">×</annotation></semantics></math>20 and 40<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m6.1"><semantics id="S4.SS1.p2.6.m6.1a"><mo id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><times id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m6.1d">×</annotation></semantics></math>20 grids.
While RA-DT successfully improves in-context, the baselines exhibit only little learning progress over the ICL trials, especially for larger grid sizes.
However, the final performance scores for 20<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m7.1"><semantics id="S4.SS1.p2.7.m7.1a"><mo id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.1b"><times id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m7.1d">×</annotation></semantics></math>20 and 40<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p2.8.m8.1"><semantics id="S4.SS1.p2.8.m8.1a"><mo id="S4.SS1.p2.8.m8.1.1" xref="S4.SS1.p2.8.m8.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m8.1b"><times id="S4.SS1.p2.8.m8.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m8.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.8.m8.1d">×</annotation></semantics></math>20 are not optimal.
With increasing grid size, discovering the goal requires systematic exploration in combination with targeted exploitation.
Therefore, we conduct a qualitative analysis on the exploration behaviour of RA-DT.
We find that RA-DT develops strategies to imitate a given successful context (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F16" title="Figure 16 ‣ D.1.1 Attention Map Analysis ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">16</span></a>), and avoids low-reward routes given an unsuccessful context (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F17" title="Figure 17 ‣ D.1.1 Attention Map Analysis ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">17</span></a>).</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="26" id="S4.F4.g1" src="extracted/5911726/figures/dark_keydoor/20x20/legend.png" width="449"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="S4.F4.sf1.g1" src="extracted/5911726/figures/dark_keydoor/eval_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Dark Key-Door 10<math alttext="\times" class="ltx_Math" display="inline" id="S4.F4.sf1.2.m1.1"><semantics id="S4.F4.sf1.2.m1.1b"><mo id="S4.F4.sf1.2.m1.1.1" xref="S4.F4.sf1.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.F4.sf1.2.m1.1c"><times id="S4.F4.sf1.2.m1.1.1.cmml" xref="S4.F4.sf1.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.sf1.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.F4.sf1.2.m1.1e">×</annotation></semantics></math>10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="S4.F4.sf2.g1" src="extracted/5911726/figures/dark_keydoor/20x20/eval.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Dark Key-Door 20<math alttext="\times" class="ltx_Math" display="inline" id="S4.F4.sf2.2.m1.1"><semantics id="S4.F4.sf2.2.m1.1b"><mo id="S4.F4.sf2.2.m1.1.1" xref="S4.F4.sf2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.F4.sf2.2.m1.1c"><times id="S4.F4.sf2.2.m1.1.1.cmml" xref="S4.F4.sf2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.sf2.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.F4.sf2.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="142" id="S4.F4.sf3.g1" src="extracted/5911726/figures/dark_keydoor/40x20/eval.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Dark Key-Door 40<math alttext="\times" class="ltx_Math" display="inline" id="S4.F4.sf3.2.m1.1"><semantics id="S4.F4.sf3.2.m1.1b"><mo id="S4.F4.sf3.2.m1.1.1" xref="S4.F4.sf3.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.F4.sf3.2.m1.1c"><times id="S4.F4.sf3.2.m1.1.1.cmml" xref="S4.F4.sf3.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.sf3.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.F4.sf3.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>ICL performance on <span class="ltx_text ltx_font_bold" id="S4.F4.12.1">Dark Key-Door</span> <span class="ltx_text ltx_font_bold" id="S4.F4.13.2">(a)</span> 10<math alttext="\times" class="ltx_Math" display="inline" id="S4.F4.4.m1.1"><semantics id="S4.F4.4.m1.1b"><mo id="S4.F4.4.m1.1.1" xref="S4.F4.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.F4.4.m1.1c"><times id="S4.F4.4.m1.1.1.cmml" xref="S4.F4.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.F4.4.m1.1e">×</annotation></semantics></math>10, <span class="ltx_text ltx_font_bold" id="S4.F4.14.3">(b)</span> 20<math alttext="\times" class="ltx_Math" display="inline" id="S4.F4.5.m2.1"><semantics id="S4.F4.5.m2.1b"><mo id="S4.F4.5.m2.1.1" xref="S4.F4.5.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.F4.5.m2.1c"><times id="S4.F4.5.m2.1.1.cmml" xref="S4.F4.5.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.5.m2.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.F4.5.m2.1e">×</annotation></semantics></math>20, <span class="ltx_text ltx_font_bold" id="S4.F4.15.4">(c)</span> 40<math alttext="\times" class="ltx_Math" display="inline" id="S4.F4.6.m3.1"><semantics id="S4.F4.6.m3.1b"><mo id="S4.F4.6.m3.1.1" xref="S4.F4.6.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.F4.6.m3.1c"><times id="S4.F4.6.m3.1.1.cmml" xref="S4.F4.6.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.6.m3.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.F4.6.m3.1e">×</annotation></semantics></math>20 at end of training (100K steps). We evaluate each agent for 40 episodes on each of the 20 <span class="ltx_text ltx_font_bold" id="S4.F4.16.5">evaluation tasks</span> and report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Dark Key-Door</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.2.1">Experiment Setup.</span>
In Dark Key-Door, the agent is located in a room with two invisible objects: a key and a door.
The agent has to pick up the invisible key, then navigate to the door.
Because of the presence of two key events, the task-space is combinatorial in the number of grid-cells (<math alttext="100^{2}=10000" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><msup id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml"><mn id="S4.SS2.p1.1.m1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.2.2.cmml">100</mn><mn id="S4.SS2.p1.1.m1.1.1.2.3" xref="S4.SS2.p1.1.m1.1.1.2.3.cmml">2</mn></msup><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">10000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><eq id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></eq><apply id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.2">superscript</csymbol><cn id="S4.SS2.p1.1.m1.1.1.2.2.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.2.2">100</cn><cn id="S4.SS2.p1.1.m1.1.1.2.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.2.3">2</cn></apply><cn id="S4.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.3">10000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">100^{2}=10000</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">100 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = 10000</annotation></semantics></math> possible tasks for <math alttext="10\times 10" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">10</mn><mo id="S4.SS2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><times id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></times><cn id="S4.SS2.p1.2.m2.1.1.2.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1.2">10</cn><cn id="S4.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">10 × 10</annotation></semantics></math>) and is therefore considered more difficult.
A reward of +1 is obtained once for picking up the key and for every step the agent stands on the door grid-cell after it collected the key.
We retain the same experiment setup as in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS1" title="4.1 Dark-Room ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4.1</span></a> and provide further details in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS1" title="B.1 Dark-Room and Dark Key-Door ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">B.1</span></a> (also see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F8" title="Figure 8 ‣ B.1 Dark-Room and Dark Key-Door ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">8</span></a> for single-task expert scores).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.3"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.3.1">Results.</span>
On <math alttext="10\times 10" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">10</mn><mo id="S4.SS2.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p2.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><times id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></times><cn id="S4.SS2.p2.1.m1.1.1.2.cmml" type="integer" xref="S4.SS2.p2.1.m1.1.1.2">10</cn><cn id="S4.SS2.p2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p2.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">10 × 10</annotation></semantics></math> and <math alttext="20\times 20" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">20</mn><mo id="S4.SS2.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p2.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><times id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></times><cn id="S4.SS2.p2.2.m2.1.1.2.cmml" type="integer" xref="S4.SS2.p2.2.m2.1.1.2">20</cn><cn id="S4.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p2.2.m2.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">20\times 20</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">20 × 20</annotation></semantics></math>, RA-DT outperforms baselines, with the performance ranking remaining the same as on Dark-Room (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.F4" title="Figure 4 ‣ 4.1 Dark-Room ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4</span></a>).
Surprisingly, domain-agnostic RA-DT outperforms its domain-specific counterpart on <math alttext="40\times 20" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mn id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">40</mn><mo id="S4.SS2.p2.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p2.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><times id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></times><cn id="S4.SS2.p2.3.m3.1.1.2.cmml" type="integer" xref="S4.SS2.p2.3.m3.1.1.2">40</cn><cn id="S4.SS2.p2.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p2.3.m3.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">40\times 20</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">40 × 20</annotation></semantics></math>, which demonstrates that the domain-agnostic embedding model is a promising alternative.
This result indicates that RA-DT can successfully handle environments with more than one key event, even with shorter observed context.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Maze-Runner</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.3"><span class="ltx_text ltx_font_bold" id="S4.SS3.p1.3.1">Experiment Setup.</span>
Maze-Runner was introduced by <cite class="ltx_cite ltx_citemacro_citet">Grigsby et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib25" title="">2023</a>]</cite> and inspired by <cite class="ltx_cite ltx_citemacro_citet">Pasukonis et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib64" title="">2022</a>]</cite>.
The agent is located in a procedurally-generated <math alttext="15\times 15" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mn id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">15</mn><mo id="S4.SS3.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><times id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></times><cn id="S4.SS3.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1.2">15</cn><cn id="S4.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">15\times 15</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">15 × 15</annotation></semantics></math> maze (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F10" title="Figure 10 ‣ B.2 MazeRunner ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">10</span></a>), observes continuous Lidar-like depth representations of states, and has to navigate to one, two, or three goal locations in the correct order (<math alttext="|\mathcal{S}|=6" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.2" xref="S4.SS3.p1.2.m2.1.2.cmml"><mrow id="S4.SS3.p1.2.m2.1.2.2.2" xref="S4.SS3.p1.2.m2.1.2.2.1.cmml"><mo id="S4.SS3.p1.2.m2.1.2.2.2.1" stretchy="false" xref="S4.SS3.p1.2.m2.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">𝒮</mi><mo id="S4.SS3.p1.2.m2.1.2.2.2.2" stretchy="false" xref="S4.SS3.p1.2.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS3.p1.2.m2.1.2.1" xref="S4.SS3.p1.2.m2.1.2.1.cmml">=</mo><mn id="S4.SS3.p1.2.m2.1.2.3" xref="S4.SS3.p1.2.m2.1.2.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.2.cmml" xref="S4.SS3.p1.2.m2.1.2"><eq id="S4.SS3.p1.2.m2.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.2.1"></eq><apply id="S4.SS3.p1.2.m2.1.2.2.1.cmml" xref="S4.SS3.p1.2.m2.1.2.2.2"><abs id="S4.SS3.p1.2.m2.1.2.2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.2.2.2.1"></abs><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝒮</ci></apply><cn id="S4.SS3.p1.2.m2.1.2.3.cmml" type="integer" xref="S4.SS3.p1.2.m2.1.2.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">|\mathcal{S}|=6</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">| caligraphic_S | = 6</annotation></semantics></math>,<math alttext="|\mathcal{A}|=4" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.2" xref="S4.SS3.p1.3.m3.1.2.cmml"><mrow id="S4.SS3.p1.3.m3.1.2.2.2" xref="S4.SS3.p1.3.m3.1.2.2.1.cmml"><mo id="S4.SS3.p1.3.m3.1.2.2.2.1" stretchy="false" xref="S4.SS3.p1.3.m3.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">𝒜</mi><mo id="S4.SS3.p1.3.m3.1.2.2.2.2" stretchy="false" xref="S4.SS3.p1.3.m3.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS3.p1.3.m3.1.2.1" xref="S4.SS3.p1.3.m3.1.2.1.cmml">=</mo><mn id="S4.SS3.p1.3.m3.1.2.3" xref="S4.SS3.p1.3.m3.1.2.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.2.cmml" xref="S4.SS3.p1.3.m3.1.2"><eq id="S4.SS3.p1.3.m3.1.2.1.cmml" xref="S4.SS3.p1.3.m3.1.2.1"></eq><apply id="S4.SS3.p1.3.m3.1.2.2.1.cmml" xref="S4.SS3.p1.3.m3.1.2.2.2"><abs id="S4.SS3.p1.3.m3.1.2.2.1.1.cmml" xref="S4.SS3.p1.3.m3.1.2.2.2.1"></abs><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝒜</ci></apply><cn id="S4.SS3.p1.3.m3.1.2.3.cmml" type="integer" xref="S4.SS3.p1.3.m3.1.2.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">|\mathcal{A}|=4</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">| caligraphic_A | = 4</annotation></semantics></math>).
A reward of +1 is obtained when reaching a goal location.
Episodes last for a maximum of 400 steps, or terminate early if all goal locations have been visited.
Similar to Dark-Room, we use PPO to generate 100K environment interactions for 100 procedurally-generated mazes.
We train all methods on a multi-task dataset that comprises trajectories from 100 mazes, evaluate on 20 unseen mazes, and report performance over 30 ICL trials.
We give further details on the environment, the dataset, and the experiment setup in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS2" title="B.2 MazeRunner ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">B.2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS2" title="D.2 Maze-Runner ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D.2</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.1">Results.</span>
We find that RA-DT considerably outperforms all baselines in terms of final performance (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.F5" title="Figure 5 ‣ 4.4 Meta-World &amp; DMControl ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">5</span></a>).
Surprisingly, RA-DT is the only method to improve over the course of the 30 ICL trials.
However, we observe a considerable performance gap between train mazes and test mazes (0.65 vs. 0.4 reward, see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F20" title="Figure 20 ‣ D.2 Maze-Runner ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">20</span></a>), indicating that solving unseen mazes requires an enhanced ability to generalize and learn from previous trials.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Meta-World &amp; DMControl</h3>
<figure class="ltx_figure ltx_align_floatright" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="99" id="S4.F5.g1" src="extracted/5911726/figures/mazerunner/15x15/legend_twocol_short.png" width="568"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="430" id="S4.F5.g2" src="extracted/5911726/figures/mazerunner/15x15/eval_icl.png" width="568"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>ICL on <span class="ltx_text ltx_font_bold" id="S4.F5.2.1">MazeRunner</span>. We evaluate over 30 ICL trials and report the mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.4"><span class="ltx_text ltx_font_bold" id="S4.SS4.p1.4.1">Experiment Setup.</span>
Next, we evaluate RA-DT on two multi-task robotics benchmarks, Meta-World <cite class="ltx_cite ltx_citemacro_citep">[Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib104" title="">2020b</a>]</cite> and DMControl <cite class="ltx_cite ltx_citemacro_citep">[Tassa et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib88" title="">2018</a>]</cite>.
States and actions in both benchmarks are multidimensional continuous vectors.
While the state and action space in Meta-World remain constant across all tasks (<math alttext="|\mathcal{S}|=39" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mrow id="S4.SS4.p1.1.m1.1.2" xref="S4.SS4.p1.1.m1.1.2.cmml"><mrow id="S4.SS4.p1.1.m1.1.2.2.2" xref="S4.SS4.p1.1.m1.1.2.2.1.cmml"><mo id="S4.SS4.p1.1.m1.1.2.2.2.1" stretchy="false" xref="S4.SS4.p1.1.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">𝒮</mi><mo id="S4.SS4.p1.1.m1.1.2.2.2.2" stretchy="false" xref="S4.SS4.p1.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS4.p1.1.m1.1.2.1" xref="S4.SS4.p1.1.m1.1.2.1.cmml">=</mo><mn id="S4.SS4.p1.1.m1.1.2.3" xref="S4.SS4.p1.1.m1.1.2.3.cmml">39</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.2"><eq id="S4.SS4.p1.1.m1.1.2.1.cmml" xref="S4.SS4.p1.1.m1.1.2.1"></eq><apply id="S4.SS4.p1.1.m1.1.2.2.1.cmml" xref="S4.SS4.p1.1.m1.1.2.2.2"><abs id="S4.SS4.p1.1.m1.1.2.2.1.1.cmml" xref="S4.SS4.p1.1.m1.1.2.2.2.1"></abs><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝒮</ci></apply><cn id="S4.SS4.p1.1.m1.1.2.3.cmml" type="integer" xref="S4.SS4.p1.1.m1.1.2.3">39</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">|\mathcal{S}|=39</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">| caligraphic_S | = 39</annotation></semantics></math>, <math alttext="|\mathcal{A}|=6" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><mrow id="S4.SS4.p1.2.m2.1.2" xref="S4.SS4.p1.2.m2.1.2.cmml"><mrow id="S4.SS4.p1.2.m2.1.2.2.2" xref="S4.SS4.p1.2.m2.1.2.2.1.cmml"><mo id="S4.SS4.p1.2.m2.1.2.2.2.1" stretchy="false" xref="S4.SS4.p1.2.m2.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">𝒜</mi><mo id="S4.SS4.p1.2.m2.1.2.2.2.2" stretchy="false" xref="S4.SS4.p1.2.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS4.p1.2.m2.1.2.1" xref="S4.SS4.p1.2.m2.1.2.1.cmml">=</mo><mn id="S4.SS4.p1.2.m2.1.2.3" xref="S4.SS4.p1.2.m2.1.2.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.2.cmml" xref="S4.SS4.p1.2.m2.1.2"><eq id="S4.SS4.p1.2.m2.1.2.1.cmml" xref="S4.SS4.p1.2.m2.1.2.1"></eq><apply id="S4.SS4.p1.2.m2.1.2.2.1.cmml" xref="S4.SS4.p1.2.m2.1.2.2.2"><abs id="S4.SS4.p1.2.m2.1.2.2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.2.2.2.1"></abs><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝒜</ci></apply><cn id="S4.SS4.p1.2.m2.1.2.3.cmml" type="integer" xref="S4.SS4.p1.2.m2.1.2.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">|\mathcal{A}|=6</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">| caligraphic_A | = 6</annotation></semantics></math>), they vary considerably in DMControl (<math alttext="3\leq|\mathcal{S}|\leq 24" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><mrow id="S4.SS4.p1.3.m3.1.2" xref="S4.SS4.p1.3.m3.1.2.cmml"><mn id="S4.SS4.p1.3.m3.1.2.2" xref="S4.SS4.p1.3.m3.1.2.2.cmml">3</mn><mo id="S4.SS4.p1.3.m3.1.2.3" xref="S4.SS4.p1.3.m3.1.2.3.cmml">≤</mo><mrow id="S4.SS4.p1.3.m3.1.2.4.2" xref="S4.SS4.p1.3.m3.1.2.4.1.cmml"><mo id="S4.SS4.p1.3.m3.1.2.4.2.1" stretchy="false" xref="S4.SS4.p1.3.m3.1.2.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">𝒮</mi><mo id="S4.SS4.p1.3.m3.1.2.4.2.2" stretchy="false" xref="S4.SS4.p1.3.m3.1.2.4.1.1.cmml">|</mo></mrow><mo id="S4.SS4.p1.3.m3.1.2.5" xref="S4.SS4.p1.3.m3.1.2.5.cmml">≤</mo><mn id="S4.SS4.p1.3.m3.1.2.6" xref="S4.SS4.p1.3.m3.1.2.6.cmml">24</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.2.cmml" xref="S4.SS4.p1.3.m3.1.2"><and id="S4.SS4.p1.3.m3.1.2a.cmml" xref="S4.SS4.p1.3.m3.1.2"></and><apply id="S4.SS4.p1.3.m3.1.2b.cmml" xref="S4.SS4.p1.3.m3.1.2"><leq id="S4.SS4.p1.3.m3.1.2.3.cmml" xref="S4.SS4.p1.3.m3.1.2.3"></leq><cn id="S4.SS4.p1.3.m3.1.2.2.cmml" type="integer" xref="S4.SS4.p1.3.m3.1.2.2">3</cn><apply id="S4.SS4.p1.3.m3.1.2.4.1.cmml" xref="S4.SS4.p1.3.m3.1.2.4.2"><abs id="S4.SS4.p1.3.m3.1.2.4.1.1.cmml" xref="S4.SS4.p1.3.m3.1.2.4.2.1"></abs><ci id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">𝒮</ci></apply></apply><apply id="S4.SS4.p1.3.m3.1.2c.cmml" xref="S4.SS4.p1.3.m3.1.2"><leq id="S4.SS4.p1.3.m3.1.2.5.cmml" xref="S4.SS4.p1.3.m3.1.2.5"></leq><share href="https://arxiv.org/html/2410.07071v1#S4.SS4.p1.3.m3.1.2.4.cmml" id="S4.SS4.p1.3.m3.1.2d.cmml" xref="S4.SS4.p1.3.m3.1.2"></share><cn id="S4.SS4.p1.3.m3.1.2.6.cmml" type="integer" xref="S4.SS4.p1.3.m3.1.2.6">24</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">3\leq|\mathcal{S}|\leq 24</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">3 ≤ | caligraphic_S | ≤ 24</annotation></semantics></math>, <math alttext="1\leq|\mathcal{A}|\leq 6" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m4.1"><semantics id="S4.SS4.p1.4.m4.1a"><mrow id="S4.SS4.p1.4.m4.1.2" xref="S4.SS4.p1.4.m4.1.2.cmml"><mn id="S4.SS4.p1.4.m4.1.2.2" xref="S4.SS4.p1.4.m4.1.2.2.cmml">1</mn><mo id="S4.SS4.p1.4.m4.1.2.3" xref="S4.SS4.p1.4.m4.1.2.3.cmml">≤</mo><mrow id="S4.SS4.p1.4.m4.1.2.4.2" xref="S4.SS4.p1.4.m4.1.2.4.1.cmml"><mo id="S4.SS4.p1.4.m4.1.2.4.2.1" stretchy="false" xref="S4.SS4.p1.4.m4.1.2.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml">𝒜</mi><mo id="S4.SS4.p1.4.m4.1.2.4.2.2" stretchy="false" xref="S4.SS4.p1.4.m4.1.2.4.1.1.cmml">|</mo></mrow><mo id="S4.SS4.p1.4.m4.1.2.5" xref="S4.SS4.p1.4.m4.1.2.5.cmml">≤</mo><mn id="S4.SS4.p1.4.m4.1.2.6" xref="S4.SS4.p1.4.m4.1.2.6.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.2.cmml" xref="S4.SS4.p1.4.m4.1.2"><and id="S4.SS4.p1.4.m4.1.2a.cmml" xref="S4.SS4.p1.4.m4.1.2"></and><apply id="S4.SS4.p1.4.m4.1.2b.cmml" xref="S4.SS4.p1.4.m4.1.2"><leq id="S4.SS4.p1.4.m4.1.2.3.cmml" xref="S4.SS4.p1.4.m4.1.2.3"></leq><cn id="S4.SS4.p1.4.m4.1.2.2.cmml" type="integer" xref="S4.SS4.p1.4.m4.1.2.2">1</cn><apply id="S4.SS4.p1.4.m4.1.2.4.1.cmml" xref="S4.SS4.p1.4.m4.1.2.4.2"><abs id="S4.SS4.p1.4.m4.1.2.4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.2.4.2.1"></abs><ci id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">𝒜</ci></apply></apply><apply id="S4.SS4.p1.4.m4.1.2c.cmml" xref="S4.SS4.p1.4.m4.1.2"><leq id="S4.SS4.p1.4.m4.1.2.5.cmml" xref="S4.SS4.p1.4.m4.1.2.5"></leq><share href="https://arxiv.org/html/2410.07071v1#S4.SS4.p1.4.m4.1.2.4.cmml" id="S4.SS4.p1.4.m4.1.2d.cmml" xref="S4.SS4.p1.4.m4.1.2"></share><cn id="S4.SS4.p1.4.m4.1.2.6.cmml" type="integer" xref="S4.SS4.p1.4.m4.1.2.6">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">1\leq|\mathcal{A}|\leq 6</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m4.1d">1 ≤ | caligraphic_A | ≤ 6</annotation></semantics></math>).
Episodes last for 200 and 1000 steps in Meta-World and DMControl, respectively.
<br class="ltx_break"/>We leverage the datasets released by <cite class="ltx_cite ltx_citemacro_citet">Schmied et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib81" title="">2023</a>]</cite>.
For Meta-World, we pre-train a multi-task policy on 45 of the 50 tasks (ML45, 90M transitions in total) and evaluate on the 5 remaining tasks (ML5).
Similarly, on DMControl, we pre-train on 11 tasks (DMC11, 11M transitions in total) and evaluate on 5 unseen tasks (DMC5).
We provide further details on the environments, datasets, and experiment setup in Appendices <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS3" title="B.3 Meta-World ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">B.3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS3" title="D.3 Meta-World ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D.3</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS4" title="B.4 DMControl ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">B.4</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS4" title="D.4 DMControl ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D.4</span></a> for Meta-World and DMControl, respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p2.1.1">Results.</span>
We present the learning curves and corresponding ICL curves for Meta-World and DMControl in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F22" title="Figure 22 ‣ D.3 Meta-World ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">22</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F23" title="Figure 23 ‣ D.3 Meta-World ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">23</span></a>, and Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F24" title="Figure 24 ‣ D.4 DMControl ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">24</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F25" title="Figure 25 ‣ D.4 DMControl ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">25</span></a> in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4" title="Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D</span></a>, respectively.
In addition, we provide the raw and data-normalized scores in Tables <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.T3" title="Table 3 ‣ D.3 Meta-World ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.T4" title="Table 4 ‣ D.4 DMControl ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4</span></a>, respectively.
On both benchmarks, we find that RA-DT attains considerably higher scores on unseen evaluation tasks, but slightly lower average scores across training tasks compared to DT.
However, these performance gains on evaluation tasks are not reflected in improved ICL performance.
In fact, we only observe slight in-context improvement on training tasks, but not on holdout tasks for any of the considered methods.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Procgen</h3>
<div class="ltx_para ltx_noindent" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.4"><span class="ltx_text ltx_font_bold" id="S4.SS5.p1.4.1">Experiment Setup.</span>
Finally, we conduct experiments on Procgen <cite class="ltx_cite ltx_citemacro_citep">[Cobbe et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib14" title="">2020</a>]</cite>, a benchmark consisting
of 16 procedurally-generated video games, designed to test the generalization abilities of RL agents.
The procedural generation in Procgen is controlled by setting an environment seed, which results in visually diverse observations for the same underlying task (see <span class="ltx_text ltx_font_typewriter" id="S4.SS5.p1.4.2">starpilot</span>-example in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F12" title="Figure 12 ‣ B.5 Procgen ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">12</span></a>).
In Procgen, the agent receives image-based inputs (<math alttext="|\mathcal{S}|=" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><mrow id="S4.SS5.p1.1.m1.1.2" xref="S4.SS5.p1.1.m1.1.2.cmml"><mrow id="S4.SS5.p1.1.m1.1.2.2.2" xref="S4.SS5.p1.1.m1.1.2.2.1.cmml"><mo id="S4.SS5.p1.1.m1.1.2.2.2.1" stretchy="false" xref="S4.SS5.p1.1.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">𝒮</mi><mo id="S4.SS5.p1.1.m1.1.2.2.2.2" stretchy="false" xref="S4.SS5.p1.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS5.p1.1.m1.1.2.1" xref="S4.SS5.p1.1.m1.1.2.1.cmml">=</mo><mi id="S4.SS5.p1.1.m1.1.2.3" xref="S4.SS5.p1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><apply id="S4.SS5.p1.1.m1.1.2.cmml" xref="S4.SS5.p1.1.m1.1.2"><eq id="S4.SS5.p1.1.m1.1.2.1.cmml" xref="S4.SS5.p1.1.m1.1.2.1"></eq><apply id="S4.SS5.p1.1.m1.1.2.2.1.cmml" xref="S4.SS5.p1.1.m1.1.2.2.2"><abs id="S4.SS5.p1.1.m1.1.2.2.1.1.cmml" xref="S4.SS5.p1.1.m1.1.2.2.2.1"></abs><ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">𝒮</ci></apply><csymbol cd="latexml" id="S4.SS5.p1.1.m1.1.2.3.cmml" xref="S4.SS5.p1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">|\mathcal{S}|=</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">| caligraphic_S | =</annotation></semantics></math>3<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS5.p1.2.m2.1"><semantics id="S4.SS5.p1.2.m2.1a"><mo id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><times id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.2.m2.1d">×</annotation></semantics></math>64<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS5.p1.3.m3.1"><semantics id="S4.SS5.p1.3.m3.1a"><mo id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><times id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.3.m3.1d">×</annotation></semantics></math>64).
All 16 tasks share a discrete action space (<math alttext="|\mathcal{A}|=15" class="ltx_Math" display="inline" id="S4.SS5.p1.4.m4.1"><semantics id="S4.SS5.p1.4.m4.1a"><mrow id="S4.SS5.p1.4.m4.1.2" xref="S4.SS5.p1.4.m4.1.2.cmml"><mrow id="S4.SS5.p1.4.m4.1.2.2.2" xref="S4.SS5.p1.4.m4.1.2.2.1.cmml"><mo id="S4.SS5.p1.4.m4.1.2.2.2.1" stretchy="false" xref="S4.SS5.p1.4.m4.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS5.p1.4.m4.1.1" xref="S4.SS5.p1.4.m4.1.1.cmml">𝒜</mi><mo id="S4.SS5.p1.4.m4.1.2.2.2.2" stretchy="false" xref="S4.SS5.p1.4.m4.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS5.p1.4.m4.1.2.1" xref="S4.SS5.p1.4.m4.1.2.1.cmml">=</mo><mn id="S4.SS5.p1.4.m4.1.2.3" xref="S4.SS5.p1.4.m4.1.2.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.4.m4.1b"><apply id="S4.SS5.p1.4.m4.1.2.cmml" xref="S4.SS5.p1.4.m4.1.2"><eq id="S4.SS5.p1.4.m4.1.2.1.cmml" xref="S4.SS5.p1.4.m4.1.2.1"></eq><apply id="S4.SS5.p1.4.m4.1.2.2.1.cmml" xref="S4.SS5.p1.4.m4.1.2.2.2"><abs id="S4.SS5.p1.4.m4.1.2.2.1.1.cmml" xref="S4.SS5.p1.4.m4.1.2.2.2.1"></abs><ci id="S4.SS5.p1.4.m4.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1">𝒜</ci></apply><cn id="S4.SS5.p1.4.m4.1.2.3.cmml" type="integer" xref="S4.SS5.p1.4.m4.1.2.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.4.m4.1c">|\mathcal{A}|=15</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.4.m4.1d">| caligraphic_A | = 15</annotation></semantics></math>).
Rewards are either dense or sparse depending on the environment.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1">We follow <cite class="ltx_cite ltx_citemacro_citet">Raparthy et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib73" title="">2023</a>]</cite> and use 12 tasks for training (PG12) and 4 tasks for evaluation (PG4). First, we generate datasets by training task-specific PPO agents for 25M timesteps on 200 environment seeds per task in <span class="ltx_text ltx_font_typewriter" id="S4.SS5.p2.1.1">easy</span> difficulty.
Then, we pre-train a multi-task policy on the PG12 datasets (24M transitions in total, 2M per task).
We leverage the procedural generation of Procgen and evaluate all models in three settings: <em class="ltx_emph ltx_font_italic" id="S4.SS5.p2.1.2">training tasks - seen</em> (PG12-Seen), <em class="ltx_emph ltx_font_italic" id="S4.SS5.p2.1.3">training tasks - unseen</em> (PG12-Unseen), and <em class="ltx_emph ltx_font_italic" id="S4.SS5.p2.1.4">evaluation tasks - unseen</em> (PG4).
Additional details on the generated datasets and our environment setup are available in Appendices <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS5" title="B.5 Procgen ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">B.5</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS5" title="D.5 Procgen ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D.5</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p3.1.1">Results.</span>
Similar to our results on Meta-World and DMControl, we find that RA-DT improves average performance scores across all three settings compared to the baselines (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F26" title="Figure 26 ‣ D.5 Procgen ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">26</span></a> and Tables <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.T5" title="Table 5 ‣ D.5 Procgen ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">5</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.T6" title="Table 6 ‣ D.5 Procgen ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">6</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.T7" title="Table 7 ‣ D.5 Procgen ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">7</span></a> in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS5" title="D.5 Procgen ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D.5</span></a>), but no method exhibits in-context improvement during evaluation (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F27" title="Figure 27 ‣ D.5 Procgen ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">27</span></a>).
We further discuss our negative results on Procgen, Meta-World, and DMControl in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S5" title="5 Discussion ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Ablations</h3>
<div class="ltx_para ltx_noindent" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">To better understand the effect of learning with retrieval, we present a number of ablation studies on essential components in RA-DT conducted on Dark-Room <math alttext="10\times 10" class="ltx_Math" display="inline" id="S4.SS6.p1.1.m1.1"><semantics id="S4.SS6.p1.1.m1.1a"><mrow id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml"><mn id="S4.SS6.p1.1.m1.1.1.2" xref="S4.SS6.p1.1.m1.1.1.2.cmml">10</mn><mo id="S4.SS6.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS6.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS6.p1.1.m1.1.1.3" xref="S4.SS6.p1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><apply id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1"><times id="S4.SS6.p1.1.m1.1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1.1"></times><cn id="S4.SS6.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS6.p1.1.m1.1.1.2">10</cn><cn id="S4.SS6.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS6.p1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.1.m1.1d">10 × 10</annotation></semantics></math> (more details in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5" title="Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">E</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS6.p2">
<p class="ltx_p" id="S4.SS6.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS6.p2.1.1">Retrieval outperforms sampling of experiences.</span>
To investigate the effect of learning with retrieved context, we substitute retrieval with random sampling, either over all tasks, or from the same task (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.F6" title="Figure 6 ‣ 4.6 Ablations ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">6</span></a>a).
We find that training with retrieval outperforms both sampling variants, highlighting the benefit of training with retrieval to improve ICL abilities.
We hypothesise this is because retrieval constructs bursty sequences, which was found to be important for ICL <cite class="ltx_cite ltx_citemacro_citep">[Chan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib12" title="">2022</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S4.F6.2" style="width:138.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="61" id="S4.F6.1.g1" src="extracted/5911726/figures/ablations/sampling/legend.png" width="598"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="460" id="S4.F6.2.g2" src="extracted/5911726/figures/ablations/sampling/eval_icl.png" width="598"/>
<p class="ltx_p ltx_align_center" id="S4.F6.2.1">(a)</p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S4.F6.4" style="width:138.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="91" id="S4.F6.3.g1" src="extracted/5911726/figures/ablations/sensitivity_task/3col.png" width="538"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="460" id="S4.F6.4.g2" src="extracted/5911726/figures/ablations/sensitivity_task/darkroom10x10.png" width="598"/>
<p class="ltx_p ltx_align_center" id="S4.F6.4.1">(b)</p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S4.F6.6" style="width:138.8pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="82" id="S4.F6.5.g1" src="extracted/5911726/figures/ablations/pretrained_lm/3col.png" width="598"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="460" id="S4.F6.6.g2" src="extracted/5911726/figures/ablations/pretrained_lm/eval_icl.png" width="598"/>
<p class="ltx_p ltx_align_center" id="S4.F6.6.1">(c)</p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Ablations on important components in RA-DT conducted on Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="S4.F6.9.m1.1"><semantics id="S4.F6.9.m1.1b"><mo id="S4.F6.9.m1.1.1" xref="S4.F6.9.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.F6.9.m1.1c"><times id="S4.F6.9.m1.1.1.cmml" xref="S4.F6.9.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.9.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.F6.9.m1.1e">×</annotation></semantics></math>10. We show <span class="ltx_text ltx_font_bold" id="S4.F6.14.1">(a)</span> the effect of training with retrieval vs. sampling, <span class="ltx_text ltx_font_bold" id="S4.F6.15.2">(b)</span> a sensitivity analysis on <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.F6.10.m2.1"><semantics id="S4.F6.10.m2.1b"><mi id="S4.F6.10.m2.1.1" xref="S4.F6.10.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.F6.10.m2.1c"><ci id="S4.F6.10.m2.1.1.cmml" xref="S4.F6.10.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.10.m2.1d">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.F6.10.m2.1e">italic_α</annotation></semantics></math> as used in the re-weighting mechanism during training, and <span class="ltx_text ltx_font_bold" id="S4.F6.16.3">(c)</span> the effect of leveraging different LMs as pre-trained embedding models for domain-agnostic retrieval.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS6.p3">
<p class="ltx_p" id="S4.SS6.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS6.p3.1.1">Reweighting Experiences.</span>
RA-DT reweights a sub-trajectory by its <span class="ltx_text ltx_font_italic" id="S4.SS6.p3.1.2">relevance</span> and <span class="ltx_text ltx_font_italic" id="S4.SS6.p3.1.3">utility</span> score.
By default, we use task-based reweighting during training.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F28" title="Figure 28 ‣ E.2 Reweighting Mechanism ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">28</span></a>, we compare against alternatives, such as reweighting by return.
Indeed, we find that task-based reweighting is critical for high performance, because it ensures that retrieved experiences are useful for predicting the next action.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS6.p4">
<p class="ltx_p" id="S4.SS6.p4.4"><span class="ltx_text ltx_font_bold" id="S4.SS6.p4.4.1">Sensitivity of Reweighting.</span> In addition, we conduct a sensitivity analysis on <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS6.p4.1.m1.1"><semantics id="S4.SS6.p4.1.m1.1a"><mi id="S4.SS6.p4.1.m1.1.1" xref="S4.SS6.p4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.1.m1.1b"><ci id="S4.SS6.p4.1.m1.1.1.cmml" xref="S4.SS6.p4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p4.1.m1.1d">italic_α</annotation></semantics></math> used in the reweighting mechanism (see Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.E4" title="In 3.2.3 Reweighting Retrieved Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4</span></a>) that determines the influence of utility on the retrieval score.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.F6" title="Figure 6 ‣ 4.6 Ablations ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">6</span></a>b, we find that RA-DT performs well for a range of values for <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS6.p4.2.m2.1"><semantics id="S4.SS6.p4.2.m2.1a"><mi id="S4.SS6.p4.2.m2.1.1" xref="S4.SS6.p4.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.2.m2.1b"><ci id="S4.SS6.p4.2.m2.1.1.cmml" xref="S4.SS6.p4.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p4.2.m2.1d">italic_α</annotation></semantics></math> used during training, but performance declines if no re-weighting is employed (<math alttext="\alpha=0" class="ltx_Math" display="inline" id="S4.SS6.p4.3.m3.1"><semantics id="S4.SS6.p4.3.m3.1a"><mrow id="S4.SS6.p4.3.m3.1.1" xref="S4.SS6.p4.3.m3.1.1.cmml"><mi id="S4.SS6.p4.3.m3.1.1.2" xref="S4.SS6.p4.3.m3.1.1.2.cmml">α</mi><mo id="S4.SS6.p4.3.m3.1.1.1" xref="S4.SS6.p4.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS6.p4.3.m3.1.1.3" xref="S4.SS6.p4.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.3.m3.1b"><apply id="S4.SS6.p4.3.m3.1.1.cmml" xref="S4.SS6.p4.3.m3.1.1"><eq id="S4.SS6.p4.3.m3.1.1.1.cmml" xref="S4.SS6.p4.3.m3.1.1.1"></eq><ci id="S4.SS6.p4.3.m3.1.1.2.cmml" xref="S4.SS6.p4.3.m3.1.1.2">𝛼</ci><cn id="S4.SS6.p4.3.m3.1.1.3.cmml" type="integer" xref="S4.SS6.p4.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.3.m3.1c">\alpha=0</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p4.3.m3.1d">italic_α = 0</annotation></semantics></math>).
We perform the same analysis for <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS6.p4.4.m4.1"><semantics id="S4.SS6.p4.4.m4.1a"><mi id="S4.SS6.p4.4.m4.1.1" xref="S4.SS6.p4.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p4.4.m4.1b"><ci id="S4.SS6.p4.4.m4.1.1.cmml" xref="S4.SS6.p4.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p4.4.m4.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p4.4.m4.1d">italic_α</annotation></semantics></math> during evaluation in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F29" title="Figure 29 ‣ E.2 Reweighting Mechanism ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">29</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS6.p5">
<p class="ltx_p" id="S4.SS6.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS6.p5.1.1">Effect of Retrieval Regularization.</span>
We evaluate with three retrieval regularization strategies to mitigate the effect of copying the context: deduplication, similarity cut-off, and query dropout.
To evaluate their impact on ICL performance, we systematically removed each one from RA-DT (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F30" title="Figure 30 ‣ E.3 Retrieval Regularization ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">30</span></a>).
We found the combination of all three to be effective and add them to our pipeline.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS6.p6">
<p class="ltx_p" id="S4.SS6.p6.1"><span class="ltx_text ltx_font_bold" id="S4.SS6.p6.1.1">Different LMs for domain-agnostic RA-DT.</span>
Finally, we investigate how strongly domain-agnostic RA-DT is influenced by the choice of pre-trained LM for the embedding model.
We compare our default choice BERT against other smaller/larger LMs (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F32" title="Figure 32 ‣ E.7 Pre-trained Language Model ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">32</span></a>).
We found that BERT performs best and performance decreases with smaller models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS6.p7">
<p class="ltx_p" id="S4.SS6.p7.1">For additional ablations on RA-DT (query construction, placement of cross-attention layers, retrieval steps) and on our baselines (effect of <math alttext="K" class="ltx_Math" display="inline" id="S4.SS6.p7.1.m1.1"><semantics id="S4.SS6.p7.1.m1.1a"><mi id="S4.SS6.p7.1.m1.1.1" xref="S4.SS6.p7.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p7.1.m1.1b"><ci id="S4.SS6.p7.1.m1.1.1.cmml" xref="S4.SS6.p7.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p7.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p7.1.m1.1d">italic_K</annotation></semantics></math> in AD), we refer to Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5" title="Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we highlight current challenges of RA-DT and other offline in-context RL methods.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Memory-Exploitation vs. Meta-learning Abilities.</span>
Current <em class="ltx_emph ltx_font_italic" id="S5.p2.1.2">offline</em> in-context RL methods are predominantly evaluated on contextual bandits or grid-worlds, such as Dark-Room <cite class="ltx_cite ltx_citemacro_citep">[Laskin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib45" title="">2022</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib46" title="">2023</a>; Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib50" title="">2023</a>; Sinii et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib86" title="">2023</a>; Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib33" title="">2024</a>]</cite>, which can only be solved by leveraging the context.
However, it remains unclear to what extent the agent learns to learn in-context or simply copies from its context.
Further, in our experiments on fully-observable environments (MetaWorld, DMControl, and Procgen), we did not observe ICL behaviour (see Appendices <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS3" title="D.3 Meta-World ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D.3</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS4" title="D.4 DMControl ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D.4</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS5" title="D.5 Procgen ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D.5</span></a>).
Therefore, it is necessary that future research on in-context RL disentangles the effects of memory and meta-learning abilities, similar to memory and credit-assignment <cite class="ltx_cite ltx_citemacro_citep">[Ni et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib58" title="">2024</a>]</cite>. We believe our datasets facilitate future work in this direction.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p3">
<p class="ltx_p" id="S5.p3.1"><span class="ltx_text ltx_font_bold" id="S5.p3.1.1">Challenges of Next-Action Prediction.</span>
Most in-context RL methods learn from offline datasets via next-action prediction and causal sequence modelling objectives.
As such, they cannot learn to infer the utility of an action, and thus, distinguish between positive and negative examples. This can induce delusions, which lead to repetitions of suboptimal actions and copying behaviour <cite class="ltx_cite ltx_citemacro_citep">[Ortega et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib60" title="">2021</a>]</cite> (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F19" title="Figure 19 ‣ D.1.2 Exploration Analysis ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">19</span></a> for examples on Dark-Room).
In contrast, <em class="ltx_emph ltx_font_italic" id="S5.p3.1.2">online</em> in-context RL methods have shown promising adaptation abilities <cite class="ltx_cite ltx_citemacro_citep">[Team et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib89" title="">2023</a>; Grigsby et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib25" title="">2023</a>; Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib54" title="">2024</a>]</cite>.
Consequently, a potential remedy to this problem is to train a value function to learn the utility of an action, as is commonly done in offline RL <cite class="ltx_cite ltx_citemacro_citep">[Levine et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib48" title="">2020</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p4">
<p class="ltx_p" id="S5.p4.1"><span class="ltx_text ltx_font_bold" id="S5.p4.1.1">Conditioning Strategies in RL.</span>
In LLMs, applying sophisticated conditioning strategies is important to improve ICL abilities <cite class="ltx_cite ltx_citemacro_citep">[Wei et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib94" title="">2022</a>; Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib101" title="">2024</a>; Agarwal et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib2" title="">2024</a>]</cite>.
Even though RTG-conditioning <cite class="ltx_cite ltx_citemacro_citep">[Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib13" title="">2021</a>]</cite>, and chain-of-hindsight <cite class="ltx_cite ltx_citemacro_citep">[Liu &amp; Abbeel, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib51" title="">2023</a>]</cite> have shown promise for generating high reward behaviour in DTs, the broader landscape for conditioning strategies for in-context RL remains under-explored.
Therefore, we believe that systematically investigating conditioning methods for in-context RL is a fruitful direction for future research.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p5">
<p class="ltx_p" id="S5.p5.1"><span class="ltx_text ltx_font_bold" id="S5.p5.1.1">Diversity of the Pre-training Distribution.</span>
Finally, the diversity and scale of the pre-training dataset may significantly affect the emergence of in-context learning.
In our experiments, we pre-train on a relatively small set of tasks.
Our results on gridworlds suggest that this is sufficient for ICL to emerge on simple environments.
However, on more complex environments, the unseen tasks can be considered out-of-distribution.
Therefore, higher pre-training diversity may be necessary for ICL to emerge.
It remains unclear how much diversity is required in the pre-training distribution to elicit in-context RL, and if existing large-scale agents exhibit ICL <cite class="ltx_cite ltx_citemacro_citep">[Reed et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib74" title="">2022</a>; Raad et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib68" title="">2024</a>]</cite>.
One promising approach is to expand the pre-training diversity through learned interactive simulations <cite class="ltx_cite ltx_citemacro_citep">[Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib99" title="">2023a</a>; Bruce et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib10" title="">2024</a>]</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">ICL is a promising avenue towards more general agents. Existing in-context RL methods keep entire episodes in their context window, which is challenging as RL environments are typically characterized by long episodes and sparse rewards.
To address this challenge, we introduce RA-DT, which employs an external memory mechanism to store past experiences.
This enables the retrieval of sub-trajectories that are relevant for the current situation.
Our RA-DT outperforms baselines on grid-worlds, while using only a fraction of their context length.
Furthermore, we found that RA-DT improves average performance on holdout tasks on complex environments (e.g., robotics and video games).
However, RA-DT along with other established in-context RL methods struggles to exhibit in-context improvement.
Consequently, we illuminate the current limitations of in-context RL methods and discuss future directions.
Finally, we release our datasets for Dark-Room, Dark Key-Door, MazeRunner, and Procgen, to facilitate future research on in-context RL.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1"><span class="ltx_text ltx_font_bold" id="S6.p2.1.1">Future Work.</span>
Besides the general directions discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S5" title="5 Discussion ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">5</span></a>, we highlight a number of concrete approaches to extend RA-DT.
While we focus on in-context improvement without relying on expert demonstrations, pre-filling the external memory with demonstrations may enable RA-DT to perform more complex tasks.
This may be particularly powerful for robotics applications, where expert demonstrations are easy to obtain.
Furthermore, end-to-end training of the retrieval component in RA-DT, similar to <cite class="ltx_cite ltx_citemacro_citep">[Izacard et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib35" title="">2022</a>]</cite>, may result in more precise context retrieval and enhanced down-stream performance.
Finally, we envision that modern recurrent architectures <cite class="ltx_cite ltx_citemacro_citep">[Bulatov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib11" title="">2022</a>; Gu &amp; Dao, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib26" title="">2023</a>; Beck et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib4" title="">2024</a>]</cite> as policy backbones may benefit RA-DT by maintaining hidden states across many episodes.</p>
</div>
<section class="ltx_subsubsection" id="S6.SS0.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Acknowledgments</h4>
<div class="ltx_para ltx_noindent" id="S6.SS0.SSSx1.p1">
<p class="ltx_p" id="S6.SS0.SSSx1.p1.1">We acknowledge EuroHPC Joint Undertaking for awarding us access to Karolina at IT4Innovations, Czech Republic, MeluXina at LuxProvide, Luxembourg, and Leonardo at CINECA, Italy.
The ELLIS Unit Linz, the LIT AI Lab, the Institute for Machine Learning, are supported by the Federal State Upper Austria. We thank the projects Medical Cognitive Computing Center (MC3), INCONTROL-RL (FFG-881064), PRIMAL (FFG-873979), S3AI (FFG-872172), DL for GranularFlow (FFG-871302), EPILEPSIA (FFG-892171), AIRI FG 9-N (FWF-36284, FWF-36235), AI4GreenHeatingGrids (FFG- 899943), INTEGRATE (FFG-892418), ELISE (H2020-ICT-2019-3 ID: 951847), Stars4Waters (HORIZON-CL6-2021-CLIMATE-01-01). We thank NXAI GmbH, Audi.JKU Deep Learning Center, TGW LOGISTICS GROUP GMBH, Silicon Austria Labs (SAL), FILL Gesellschaft mbH, Anyline GmbH, Google, ZF Friedrichshafen AG, Robert Bosch GmbH, UCB Biopharma SRL, Merck Healthcare KGaA, Verbund AG, GLS (Univ. Waterloo), Software Competence Center Hagenberg GmbH, Borealis AG, TÜV Austria, Frauscher Sensonic, TRUMPF and the NVIDIA Corporation.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agarwal et al. [2021]</span>
<span class="ltx_bibblock">
Rishabh Agarwal, Max Schwarzer, Pablo Samuel Castro, Aaron C Courville, and
Marc Bellemare.

</span>
<span class="ltx_bibblock">Deep reinforcement learning at the edge of the statistical precipice.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Advances in neural information processing systems</em>,
34:29304–29320, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agarwal et al. [2024]</span>
<span class="ltx_bibblock">
Rishabh Agarwal, Avi Singh, Lei M Zhang, Bernd Bohnet, Stephanie Chan, Ankesh
Anand, Zaheer Abbas, Azade Nova, John D Co-Reyes, Eric Chu, et al.

</span>
<span class="ltx_bibblock">Many-shot in-context learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2404.11018</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arjona-Medina et al. [2019]</span>
<span class="ltx_bibblock">
Jose A. Arjona-Medina, Michael Gillhofer, Michael Widrich, Thomas
Unterthiner, Johannes Brandstetter, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">RUDDER: return decomposition for delayed rewards.

</span>
<span class="ltx_bibblock">In Hanna M. Wallach, Hugo Larochelle, Alina Beygelzimer, Florence
d’Alché-Buc, Emily B. Fox, and Roman Garnett (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Advances
in Neural Information Processing Systems 32: Annual Conference on Neural
Information Processing Systems 2019, NeurIPS 2019, December 8-14, 2019,
Vancouver, BC, Canada</em>, pp.  13544–13555, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beck et al. [2024]</span>
<span class="ltx_bibblock">
Maximilian Beck, Korbinian Pöppel, Markus Spanring, Andreas Auer,
Oleksandra Prudnikova, Michael Kopp, Günter Klambauer, Johannes
Brandstetter, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">xlstm: Extended long short-term memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2405.04517</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blundell et al. [2016]</span>
<span class="ltx_bibblock">
Charles Blundell, Benigno Uria, Alexander Pritzel, Yazhe Li, Avraham Ruderman,
Joel Z. Leibo, Jack W. Rae, Daan Wierstra, and Demis Hassabis.

</span>
<span class="ltx_bibblock">Model-free episodic control.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">CoRR</em>, abs/1606.04460, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borgeaud et al. [2022]</span>
<span class="ltx_bibblock">
Sebastian Borgeaud, Arthur Mensch, Jordan Hoffmann, Trevor Cai, Eliza
Rutherford, Katie Millican, George Bm Van Den Driessche, Jean-Baptiste
Lespiau, Bogdan Damoc, Aidan Clark, et al.

</span>
<span class="ltx_bibblock">Improving language models by retrieving from trillions of tokens.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">International conference on machine learning</em>, pp. 2206–2240. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brohan et al. [2022]</span>
<span class="ltx_bibblock">
Anthony Brohan, Noah Brown, Justice Carbajal, Yevgen Chebotar, Joseph Dabis,
Chelsea Finn, Keerthana Gopalakrishnan, Karol Hausman, Alex Herzog, Jasmine
Hsu, et al.

</span>
<span class="ltx_bibblock">Rt-1: Robotics transformer for real-world control at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2212.06817</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brohan et al. [2023]</span>
<span class="ltx_bibblock">
Anthony Brohan, Noah Brown, Justice Carbajal, Yevgen Chebotar, Xi Chen,
Krzysztof Choromanski, Tianli Ding, Danny Driess, Avinava Dubey, Chelsea
Finn, et al.

</span>
<span class="ltx_bibblock">Rt-2: Vision-language-action models transfer web knowledge to robotic
control.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2307.15818</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. [2020]</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Advances in neural information processing systems</em>,
33:1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bruce et al. [2024]</span>
<span class="ltx_bibblock">
Jake Bruce, Michael Dennis, Ashley Edwards, Jack Parker-Holder, Yuge Shi,
Edward Hughes, Matthew Lai, Aditi Mavalankar, Richie Steigerwald, Chris Apps,
et al.

</span>
<span class="ltx_bibblock">Genie: Generative interactive environments.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2402.15391</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bulatov et al. [2022]</span>
<span class="ltx_bibblock">
Aydar Bulatov, Yury Kuratov, and Mikhail Burtsev.

</span>
<span class="ltx_bibblock">Recurrent memory transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Advances in Neural Information Processing Systems</em>,
35:11079–11091, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chan et al. [2022]</span>
<span class="ltx_bibblock">
Stephanie Chan, Adam Santoro, Andrew K. Lampinen, Jane Wang, Aaditya Singh,
Pierre H. Richemond, James L. McClelland, and Felix Hill.

</span>
<span class="ltx_bibblock">Data distributional properties drive emergent in-context learning in
transformers.

</span>
<span class="ltx_bibblock">In Sanmi Koyejo, S. Mohamed, A. Agarwal, Danielle Belgrave, K. Cho,
and A. Oh (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Advances in Neural Information Processing Systems 35:
Annual Conference on Neural Information Processing Systems 2022, NeurIPS
2022, New Orleans, LA, USA, November 28 - December 9, 2022</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2021]</span>
<span class="ltx_bibblock">
L. Chen, K. Lu, A. Rajeswaran, K. Lee, A. Grover, M. Laskin, P. Abbeel,
A. Srinivas, and I. Mordatch.

</span>
<span class="ltx_bibblock">Decision transformer: Reinforcement learning via sequence modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Advances in neural information processing systems</em>,
34:15084–15097, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cobbe et al. [2020]</span>
<span class="ltx_bibblock">
Karl Cobbe, Chris Hesse, Jacob Hilton, and John Schulman.

</span>
<span class="ltx_bibblock">Leveraging procedural generation to benchmark reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">International conference on machine learning</em>, pp. 2048–2056. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao [2023]</span>
<span class="ltx_bibblock">
Tri Dao.

</span>
<span class="ltx_bibblock">Flashattention-2: Faster attention with better parallelism and work
partitioning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2307.08691</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. [2019]</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">BERT: pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock">In Jill Burstein, Christy Doran, and Thamar Solorio (eds.),
<em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 2019 Conference of the North American Chapter of the
Association for Computational Linguistics: Human Language Technologies,
NAACL-HLT 2019, Minneapolis, MN, USA, June 2-7, 2019, Volume 1 (Long and
Short Papers)</em>, pp.  4171–4186. Association for Computational Linguistics,
2019.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/n19-1423</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Douze et al. [2024]</span>
<span class="ltx_bibblock">
Matthijs Douze, Alexandr Guzhva, Chengqi Deng, Jeff Johnson, Gergely Szilvasy,
Pierre-Emmanuel Mazaré, Maria Lomeli, Lucas Hosseini, and Hervé Jégou.

</span>
<span class="ltx_bibblock">The faiss library.

</span>
<span class="ltx_bibblock">2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duan et al. [2016]</span>
<span class="ltx_bibblock">
Yan Duan, John Schulman, Xi Chen, Peter L Bartlett, Ilya Sutskever, and Pieter
Abbeel.

</span>
<span class="ltx_bibblock"><math alttext="\text{Rl}^{2}" class="ltx_Math" display="inline" id="bib.bib18.1.m1.1"><semantics id="bib.bib18.1.m1.1a"><msup id="bib.bib18.1.m1.1.1" xref="bib.bib18.1.m1.1.1.cmml"><mtext id="bib.bib18.1.m1.1.1.2" xref="bib.bib18.1.m1.1.1.2a.cmml">Rl</mtext><mn id="bib.bib18.1.m1.1.1.3" xref="bib.bib18.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="bib.bib18.1.m1.1b"><apply id="bib.bib18.1.m1.1.1.cmml" xref="bib.bib18.1.m1.1.1"><csymbol cd="ambiguous" id="bib.bib18.1.m1.1.1.1.cmml" xref="bib.bib18.1.m1.1.1">superscript</csymbol><ci id="bib.bib18.1.m1.1.1.2a.cmml" xref="bib.bib18.1.m1.1.1.2"><mtext id="bib.bib18.1.m1.1.1.2.cmml" xref="bib.bib18.1.m1.1.1.2">Rl</mtext></ci><cn id="bib.bib18.1.m1.1.1.3.cmml" type="integer" xref="bib.bib18.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib18.1.m1.1c">\text{Rl}^{2}</annotation><annotation encoding="application/x-llamapun" id="bib.bib18.1.m1.1d">Rl start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>: Fast reinforcement learning via slow reinforcement
learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.2.1">arXiv preprint arXiv:1611.02779</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">D’Hooge &amp; De Deyn [2001]</span>
<span class="ltx_bibblock">
Rudi D’Hooge and Peter P De Deyn.

</span>
<span class="ltx_bibblock">Applications of the morris water maze in the study of learning and
memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Brain research reviews</em>, 36(1):60–90,
2001.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Espeholt et al. [2018]</span>
<span class="ltx_bibblock">
Lasse Espeholt, Hubert Soyer, Remi Munos, Karen Simonyan, Vlad Mnih, Tom Ward,
Yotam Doron, Vlad Firoiu, Tim Harley, Iain Dunning, et al.

</span>
<span class="ltx_bibblock">Impala: Scalable distributed deep-rl with importance weighted
actor-learner architectures.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">International conference on machine learning</em>, pp. 1407–1416. PMLR, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Finn et al. [2017]</span>
<span class="ltx_bibblock">
Chelsea Finn, Pieter Abbeel, and Sergey Levine.

</span>
<span class="ltx_bibblock">Model-agnostic meta-learning for fast adaptation of deep networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">International conference on machine learning</em>, pp. 1126–1135. PMLR, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Flennerhag et al. [2019]</span>
<span class="ltx_bibblock">
Sebastian Flennerhag, Andrei A Rusu, Razvan Pascanu, Francesco Visin, Hujun
Yin, and Raia Hadsell.

</span>
<span class="ltx_bibblock">Meta-learning with warped gradient descent.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:1909.00025</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal et al. [2022]</span>
<span class="ltx_bibblock">
Anirudh Goyal, Abram Friesen, Andrea Banino, Theophane Weber, Nan Rosemary Ke,
Adria Puigdomenech Badia, Arthur Guez, Mehdi Mirza, Peter C Humphreys, Ksenia
Konyushova, et al.

</span>
<span class="ltx_bibblock">Retrieval-augmented reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">International Conference on Machine Learning</em>, pp. 7740–7765. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graves et al. [2014]</span>
<span class="ltx_bibblock">
Alex Graves, Greg Wayne, and Ivo Danihelka.

</span>
<span class="ltx_bibblock">Neural turing machines.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">CoRR</em>, abs/1410.5401, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grigsby et al. [2023]</span>
<span class="ltx_bibblock">
Jake Grigsby, Linxi Fan, and Yuke Zhu.

</span>
<span class="ltx_bibblock">Amago: Scalable in-context reinforcement learning for adaptive
agents.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2310.09971</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu &amp; Dao [2023]</span>
<span class="ltx_bibblock">
Albert Gu and Tri Dao.

</span>
<span class="ltx_bibblock">Mamba: Linear-time sequence modeling with selective state spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2312.00752</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guu et al. [2020]</span>
<span class="ltx_bibblock">
Kelvin Guu, Kenton Lee, Zora Tung, Panupong Pasupat, and Mingwei Chang.

</span>
<span class="ltx_bibblock">Retrieval augmented language model pre-training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">International conference on machine learning</em>, pp. 3929–3938. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hafner et al. [2019]</span>
<span class="ltx_bibblock">
Danijar Hafner, Timothy Lillicrap, Ian Fischer, Ruben Villegas, David Ha,
Honglak Lee, and James Davidson.

</span>
<span class="ltx_bibblock">Learning latent dynamics for planning from pixels.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">International conference on machine learning</em>, pp. 2555–2565. PMLR, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hill et al. [2021]</span>
<span class="ltx_bibblock">
Felix Hill, Olivier Tieleman, Tamara von Glehn, Nathaniel Wong, Hamza Merzic,
and Stephen Clark.

</span>
<span class="ltx_bibblock">Grounded language learning fast and slow.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">9th International Conference on Learning Representations,
ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>. OpenReview.net, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter &amp; Schmidhuber [1997]</span>
<span class="ltx_bibblock">
Sepp Hochreiter and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Neural computation</em>, 9(8):1735–1780, 1997.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter et al. [2001]</span>
<span class="ltx_bibblock">
Sepp Hochreiter, A Steven Younger, and Peter R Conwell.

</span>
<span class="ltx_bibblock">Learning to learn using gradient descent.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Artificial Neural Networks—ICANN 2001: International
Conference Vienna, Austria, August 21–25, 2001 Proceedings 11</em>, pp. 87–94. Springer, 2001.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. [2023]</span>
<span class="ltx_bibblock">
Ziniu Hu, Ahmet Iscen, Chen Sun, Zirui Wang, Kai-Wei Chang, Yizhou Sun,
Cordelia Schmid, David A. Ross, and Alireza Fathi.

</span>
<span class="ltx_bibblock">Reveal: Retrieval-augmented visual-language pre-training with
multi-source multimodal knowledge memory.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">IEEE/CVF Conference on Computer Vision and Pattern
Recognition, CVPR 2023, Vancouver, BC, Canada, June 17-24, 2023</em>, pp. 23369–23379. IEEE, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/CVPR52729.2023.02238</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. [2024]</span>
<span class="ltx_bibblock">
Sili Huang, Jifeng Hu, Hechang Chen, Lichao Sun, and Bo Yang.

</span>
<span class="ltx_bibblock">In-context decision transformer: Reinforcement learning via
hierarchical chain-of-thought.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2405.20692</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Humphreys et al. [2022]</span>
<span class="ltx_bibblock">
Peter Humphreys, Arthur Guez, Olivier Tieleman, Laurent Sifre, Théophane
Weber, and Timothy Lillicrap.

</span>
<span class="ltx_bibblock">Large-scale retrieval for reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Advances in Neural Information Processing Systems</em>,
35:20092–20104, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard et al. [2022]</span>
<span class="ltx_bibblock">
Gautier Izacard, Patrick Lewis, Maria Lomeli, Lucas Hosseini, Fabio Petroni,
Timo Schick, Jane Dwivedi-Yu, Armand Joulin, Sebastian Riedel, and Edouard
Grave.

</span>
<span class="ltx_bibblock">Few-shot learning with retrieval augmented language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2208.03299</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Janner et al. [2021]</span>
<span class="ltx_bibblock">
Michael Janner, Qiyang Li, and Sergey Levine.

</span>
<span class="ltx_bibblock">Offline reinforcement learning as one big sequence modeling problem.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Advances in neural information processing systems</em>,
34:1273–1286, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. [2019]</span>
<span class="ltx_bibblock">
Jeff Johnson, Matthijs Douze, and Hervé Jégou.

</span>
<span class="ltx_bibblock">Billion-scale similarity search with GPUs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">IEEE Transactions on Big Data</em>, 7(3):535–547, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaelbling et al. [1998]</span>
<span class="ltx_bibblock">
Leslie Pack Kaelbling, Michael L. Littman, and Anthony R. Cassandra.

</span>
<span class="ltx_bibblock">Planning and acting in partially observable stochastic domains.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Artif. Intell.</em>, 101(1-2):99–134, 1998.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1016/S0004-3702(98)00023-X</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khandelwal et al. [2019]</span>
<span class="ltx_bibblock">
Urvashi Khandelwal, Omer Levy, Dan Jurafsky, Luke Zettlemoyer, and Mike Lewis.

</span>
<span class="ltx_bibblock">Generalization through memorization: Nearest neighbor language
models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:1911.00172</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirsch et al. [2019]</span>
<span class="ltx_bibblock">
Louis Kirsch, Sjoerd van Steenkiste, and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Improving generalization in meta reinforcement learning using learned
objectives.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:1910.04098</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirsch et al. [2022]</span>
<span class="ltx_bibblock">
Louis Kirsch, James Harrison, Jascha Sohl-Dickstein, and Luke Metz.

</span>
<span class="ltx_bibblock">General-purpose in-context learning by meta-learning transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2212.04458</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirsch et al. [2023]</span>
<span class="ltx_bibblock">
Louis Kirsch, James Harrison, C Freeman, Jascha Sohl-Dickstein, and Jürgen
Schmidhuber.

</span>
<span class="ltx_bibblock">Towards general-purpose in-context learning agents.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">NeurIPS 2023 Workshop on Generalization in Planning</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumaran et al. [2016]</span>
<span class="ltx_bibblock">
Dharshan Kumaran, Demis Hassabis, and James L. McClelland.

</span>
<span class="ltx_bibblock">What learning systems do intelligent agents need? complementary
learning systems theory updated.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Trends in Cognitive Sciences</em>, 20:512–534, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Küttler et al. [2020]</span>
<span class="ltx_bibblock">
Heinrich Küttler, Nantas Nardelli, Alexander Miller, Roberta Raileanu,
Marco Selvatici, Edward Grefenstette, and Tim Rocktäschel.

</span>
<span class="ltx_bibblock">The nethack learning environment.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Advances in Neural Information Processing Systems</em>,
33:7671–7684, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Laskin et al. [2022]</span>
<span class="ltx_bibblock">
Michael Laskin, Luyu Wang, Junhyuk Oh, Emilio Parisotto, Stephen Spencer,
Richie Steigerwald, DJ Strouse, Steven Hansen, Angelos Filos, Ethan Brooks,
et al.

</span>
<span class="ltx_bibblock">In-context reinforcement learning with algorithm distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2210.14215</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. [2023]</span>
<span class="ltx_bibblock">
Jonathan N Lee, Annie Xie, Aldo Pacchiano, Yash Chandak, Chelsea Finn, Ofir
Nachum, and Emma Brunskill.

</span>
<span class="ltx_bibblock">Supervised pretraining can learn in-context reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:2306.14892</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. [2022]</span>
<span class="ltx_bibblock">
Kuang-Huei Lee, Ofir Nachum, Mengjiao Yang, Lisa Lee, Daniel Freeman, Winnie
Xu, Sergio Guadarrama, Ian Fischer, Eric Jang, Henryk Michalewski, et al.

</span>
<span class="ltx_bibblock">Multi-game decision transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2205.15241</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levine et al. [2020]</span>
<span class="ltx_bibblock">
Sergey Levine, Aviral Kumar, George Tucker, and Justin Fu.

</span>
<span class="ltx_bibblock">Offline reinforcement learning: Tutorial, review, and perspectives on
open problems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2005.01643</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. [2020]</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir
Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim
Rocktäschel, et al.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for knowledge-intensive nlp tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Advances in Neural Information Processing Systems</em>,
33:9459–9474, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. [2023]</span>
<span class="ltx_bibblock">
Licong Lin, Yu Bai, and Song Mei.

</span>
<span class="ltx_bibblock">Transformers as decision makers: Provable in-context reinforcement
learning via supervised pretraining.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">arXiv preprint arXiv:2310.08566</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu &amp; Abbeel [2023]</span>
<span class="ltx_bibblock">
Hao Liu and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Emergent agentic transformer from chain of hindsight experience.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">arXiv preprint arXiv:2305.16554</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2019]</span>
<span class="ltx_bibblock">
Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer
Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov.

</span>
<span class="ltx_bibblock">Roberta: A robustly optimized bert pretraining approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">arXiv preprint arXiv:1907.11692</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov &amp; Hutter [2018]</span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">International Conference on Learning Representations</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. [2024]</span>
<span class="ltx_bibblock">
Chris Lu, Yannick Schroecker, Albert Gu, Emilio Parisotto, Jakob Foerster,
Satinder Singh, and Feryal Behbahani.

</span>
<span class="ltx_bibblock">Structured state space models for in-context reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mcclelland et al. [1995]</span>
<span class="ltx_bibblock">
James L. Mcclelland, Bruce L. Mcnaughton, and Randall C. O’Reilly.

</span>
<span class="ltx_bibblock">Why there are complementary learning systems in the hippocampus and
neocortex: Insights from the successes and failures of connectionist models
of learning and memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">Psychological Review</em>, 102:419–457, 1995.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Micikevicius et al. [2017]</span>
<span class="ltx_bibblock">
Paulius Micikevicius, Sharan Narang, Jonah Alben, Gregory Diamos, Erich Elsen,
David Garcia, Boris Ginsburg, Michael Houston, Oleksii Kuchaiev, Ganesh
Venkatesh, et al.

</span>
<span class="ltx_bibblock">Mixed precision training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">arXiv preprint arXiv:1710.03740</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mishra et al. [2018]</span>
<span class="ltx_bibblock">
Nikhil Mishra, Mostafa Rohaninejad, Xi Chen, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">A simple neural attentive meta-learner.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">6th International Conference on Learning Representations,
ICLR 2018, Vancouver, BC, Canada, April 30 - May 3, 2018, Conference Track
Proceedings</em>. OpenReview.net, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=B1DmUzWAW" title="">https://openreview.net/forum?id=B1DmUzWAW</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al. [2024]</span>
<span class="ltx_bibblock">
Tianwei Ni, Michel Ma, Benjamin Eysenbach, and Pierre-Luc Bacon.

</span>
<span class="ltx_bibblock">When do transformers shine in rl? decoupling memory from credit
assignment.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ortega et al. [2019]</span>
<span class="ltx_bibblock">
Pedro A. Ortega, Jane X. Wang, Mark Rowland, Tim Genewein, Zeb Kurth-Nelson,
Razvan Pascanu, Nicolas Heess, Joel Veness, Alexander Pritzel, Pablo
Sprechmann, Siddhant M. Jayakumar, Tom McGrath, Kevin J. Miller,
Mohammad Gheshlaghi Azar, Ian Osband, Neil C. Rabinowitz, András
György, Silvia Chiappa, Simon Osindero, Yee Whye Teh, Hado van Hasselt,
Nando de Freitas, Matthew M. Botvinick, and Shane Legg.

</span>
<span class="ltx_bibblock">Meta-learning of sequential strategies.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">CoRR</em>, abs/1905.03030, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ortega et al. [2021]</span>
<span class="ltx_bibblock">
Pedro A Ortega, Markus Kunesch, Grégoire Delétang, Tim Genewein, Jordi
Grau-Moya, Joel Veness, Jonas Buchli, Jonas Degrave, Bilal Piot, Julien
Perolat, et al.

</span>
<span class="ltx_bibblock">Shaking the foundations: delusions in sequence models for interaction
and control.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">arXiv preprint arXiv:2110.10819</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paischer et al. [2022]</span>
<span class="ltx_bibblock">
Fabian Paischer, Thomas Adler, Vihang Patil, Angela Bitto-Nemling, Markus
Holzleitner, Sebastian Lehner, Hamid Eghbal-Zadeh, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">History compression via language models in reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">International Conference on Machine Learning</em>, pp. 17156–17185. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paischer et al. [2023]</span>
<span class="ltx_bibblock">
Fabian Paischer, Thomas Adler, Markus Hofmarcher, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">Semantic HELM: an interpretable memory for reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">CoRR</em>, abs/2306.09312, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/arXiv.2306.09312</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al. [2023]</span>
<span class="ltx_bibblock">
Joon Sung Park, Joseph O’Brien, Carrie Jun Cai, Meredith Ringel Morris, Percy
Liang, and Michael S Bernstein.

</span>
<span class="ltx_bibblock">Generative agents: Interactive simulacra of human behavior.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">Proceedings of the 36th Annual ACM Symposium on User
Interface Software and Technology</em>, pp.  1–22, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pasukonis et al. [2022]</span>
<span class="ltx_bibblock">
Jurgis Pasukonis, Timothy Lillicrap, and Danijar Hafner.

</span>
<span class="ltx_bibblock">Evaluating long-term memory in 3d mazes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">arXiv preprint arXiv:2210.13383</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. [2019]</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory
Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et al.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep learning library.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">Advances in neural information processing systems</em>, 32, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Patil et al. [2022]</span>
<span class="ltx_bibblock">
Vihang Patil, Markus Hofmarcher, Marius-Constantin Dinu, Matthias Dorfer,
Patrick M. Blies, Johannes Brandstetter, José Antonio Arjona-Medina,
and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">Align-rudder: Learning from few demonstrations by reward
redistribution.

</span>
<span class="ltx_bibblock">In Kamalika Chaudhuri, Stefanie Jegelka, Le Song, Csaba
Szepesvári, Gang Niu, and Sivan Sabato (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">International
Conference on Machine Learning, ICML 2022, 17-23 July 2022, Baltimore,
Maryland, USA</em>, volume 162 of <em class="ltx_emph ltx_font_italic" id="bib.bib66.2.2">Proceedings of Machine Learning
Research</em>, pp.  17531–17572. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pritzel et al. [2017]</span>
<span class="ltx_bibblock">
Alexander Pritzel, Benigno Uria, Sriram Srinivasan,
Adrià Puigdomènech Badia, Oriol Vinyals, Demis Hassabis, Daan
Wierstra, and Charles Blundell.

</span>
<span class="ltx_bibblock">Neural episodic control.

</span>
<span class="ltx_bibblock">In Doina Precup and Yee Whye Teh (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">Proceedings of the
34th International Conference on Machine Learning, ICML 2017, Sydney, NSW,
Australia, 6-11 August 2017</em>, volume 70 of <em class="ltx_emph ltx_font_italic" id="bib.bib67.2.2">Proceedings of Machine
Learning Research</em>, pp.  2827–2836. PMLR, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raad et al. [2024]</span>
<span class="ltx_bibblock">
Maria Abi Raad, Arun Ahuja, Catarina Barros, Frederic Besse, Andrew Bolt,
Adrian Bolton, Bethanie Brownfield, Gavin Buttimore, Max Cant, Sarah Chakera,
et al.

</span>
<span class="ltx_bibblock">Scaling instructable agents across many simulated worlds.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">arXiv preprint arXiv:2404.10179</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. [2019]</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya
Sutskever, et al.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib69.1.1">OpenAI blog</em>, 1(8):9, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffin et al. [2021]</span>
<span class="ltx_bibblock">
Antonin Raffin, Ashley Hill, Adam Gleave, Anssi Kanervisto, Maximilian
Ernestus, and Noah Dormann.

</span>
<span class="ltx_bibblock">Stable-baselines3: Reliable reinforcement learning implementations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib70.1.1">Journal of Machine Learning Research</em>, 22(268):1–8, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ram et al. [2023]</span>
<span class="ltx_bibblock">
Ori Ram, Yoav Levine, Itay Dalmedigos, Dor Muhlgay, Amnon Shashua, Kevin
Leyton-Brown, and Yoav Shoham.

</span>
<span class="ltx_bibblock">In-context retrieval-augmented language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib71.1.1">arXiv preprint arXiv:2302.00083</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramos et al. [2022]</span>
<span class="ltx_bibblock">
Rita Ramos, Bruno Martins, Desmond Elliott, and Yova Kementchedjhieva.

</span>
<span class="ltx_bibblock">Smallcap: Lightweight image captioning prompted with retrieval
augmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib72.1.1">CoRR</em>, abs/2209.15323, 2022.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/arXiv.2209.15323</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raparthy et al. [2023]</span>
<span class="ltx_bibblock">
Sharath Chandra Raparthy, Eric Hambro, Robert Kirk, Mikael Henaff, and Roberta
Raileanu.

</span>
<span class="ltx_bibblock">Generalization to new sequential decision making tasks with
in-context learning, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reed et al. [2022]</span>
<span class="ltx_bibblock">
Scott E. Reed, Konrad Zolna, Emilio Parisotto, Sergio Gomez Colmenarejo,
Alexander Novikov, Gabriel Barth-Maron, Mai Gimenez, Yury Sulsky, Jackie
Kay, Jost Tobias Springenberg, Tom Eccles, Jake Bruce, Ali Razavi, Ashley
Edwards, Nicolas Heess, Yutian Chen, Raia Hadsell, Oriol Vinyals, Mahyar
Bordbar, and Nando de Freitas.

</span>
<span class="ltx_bibblock">A generalist agent.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib74.1.1">CoRR</em>, abs/2205.06175, 2022.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/arXiv.2205.06175</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Samvelyan et al. [2021]</span>
<span class="ltx_bibblock">
Mikayel Samvelyan, Robert Kirk, Vitaly Kurin, Jack Parker-Holder, Minqi Jiang,
Eric Hambro, Fabio Petroni, Heinrich Kuttler, Edward Grefenstette, and Tim
Rocktäschel.

</span>
<span class="ltx_bibblock">Minihack the planet: A sandbox for open-ended reinforcement learning
research.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib75.1.1">Thirty-fifth Conference on Neural Information Processing
Systems Datasets and Benchmarks Track (Round 1)</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanh et al. [2019]</span>
<span class="ltx_bibblock">
Victor Sanh, Lysandre Debut, Julien Chaumond, and Thomas Wolf.

</span>
<span class="ltx_bibblock">Distilbert, a distilled version of bert: smaller, faster, cheaper and
lighter.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib76.1.1">arXiv preprint arXiv:1910.01108</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Santoro et al. [2016]</span>
<span class="ltx_bibblock">
Adam Santoro, Sergey Bartunov, Matthew Botvinick, Daan Wierstra, and Timothy
Lillicrap.

</span>
<span class="ltx_bibblock">Meta-learning with memory-augmented neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib77.1.1">International conference on machine learning</em>, pp. 1842–1850. PMLR, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schmidhuber [2019]</span>
<span class="ltx_bibblock">
Juergen Schmidhuber.

</span>
<span class="ltx_bibblock">Reinforcement learning upside down: Don’t predict rewards–just map
them to actions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib78.1.1">arXiv preprint arXiv:1912.02875</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schmidhuber [1987]</span>
<span class="ltx_bibblock">
Jurgen Schmidhuber.

</span>
<span class="ltx_bibblock">Evolutionary principles in self-referential learning. on learning now
to learn: The meta-meta-meta…-hook.

</span>
<span class="ltx_bibblock">Diploma thesis, Technische Universitat Munchen, Germany, 14 May 1987.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schmidt &amp; Schmied [2021]</span>
<span class="ltx_bibblock">
Dominik Schmidt and Thomas Schmied.

</span>
<span class="ltx_bibblock">Fast and data-efficient training of rainbow: an experimental study on
atari.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib80.1.1">arXiv preprint arXiv:2111.10247</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schmied et al. [2023]</span>
<span class="ltx_bibblock">
Thomas Schmied, Markus Hofmarcher, Fabian Paischer, Razvan Pascanu, and Sepp
Hochreiter.

</span>
<span class="ltx_bibblock">Learning to modulate pre-trained models in RL.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib81.1.1">CoRR</em>, abs/2306.14884, 2023.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/ARXIV.2306.14884</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et al. [2017]</span>
<span class="ltx_bibblock">
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib82.1.1">arXiv preprint arXiv:1707.06347</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schwarzer et al. [2023]</span>
<span class="ltx_bibblock">
Max Schwarzer, Johan Samir Obando Ceron, Aaron Courville, Marc G Bellemare,
Rishabh Agarwal, and Pablo Samuel Castro.

</span>
<span class="ltx_bibblock">Bigger, better, faster: Human-level atari with human-level
efficiency.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib83.1.1">International Conference on Machine Learning</em>, pp. 30365–30380. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schweighofer et al. [2022]</span>
<span class="ltx_bibblock">
Kajetan Schweighofer, Marius-constantin Dinu, Andreas Radler, Markus
Hofmarcher, Vihang Prakash Patil, Angela Bitto-Nemling, Hamid Eghbal-zadeh,
and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">A dataset perspective on offline reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib84.1.1">Conference on Lifelong Learning Agents</em>, pp.  470–517.
PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib85">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seidl et al. [2022]</span>
<span class="ltx_bibblock">
Philipp Seidl, Philipp Renz, Natalia Dyubankova, Paulo Neves, Jonas Verhoeven,
Jorg K Wegner, Marwin Segler, Sepp Hochreiter, and Gunter Klambauer.

</span>
<span class="ltx_bibblock">Improving few-and zero-shot reaction template prediction using modern
hopfield networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib85.1.1">Journal of chemical information and modeling</em>, 62(9):2111–2120, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib86">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sinii et al. [2023]</span>
<span class="ltx_bibblock">
Viacheslav Sinii, Alexander Nikulin, Vladislav Kurenkov, Ilya Zisman, and
Sergey Kolesnikov.

</span>
<span class="ltx_bibblock">In-context reinforcement learning for variable action spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib86.1.1">arXiv preprint arXiv:2312.13327</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib87">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sprechmann et al. [2018]</span>
<span class="ltx_bibblock">
Pablo Sprechmann, Siddhant M. Jayakumar, Jack W. Rae, Alexander Pritzel,
Adrià Puigdomènech Badia, Benigno Uria, Oriol Vinyals, Demis
Hassabis, Razvan Pascanu, and Charles Blundell.

</span>
<span class="ltx_bibblock">Memory-based parameter adaptation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib87.1.1">6th International Conference on Learning Representations,
ICLR 2018, Vancouver, BC, Canada, April 30 - May 3, 2018, Conference Track
Proceedings</em>. OpenReview.net, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib88">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tassa et al. [2018]</span>
<span class="ltx_bibblock">
Yuval Tassa, Yotam Doron, Alistair Muldal, Tom Erez, Yazhe Li, Diego
de Las Casas, David Budden, Abbas Abdolmaleki, Josh Merel, Andrew Lefrancq,
Timothy P. Lillicrap, and Martin A. Riedmiller.

</span>
<span class="ltx_bibblock">Deepmind control suite.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib88.1.1">CoRR</em>, abs/1801.00690, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib89">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Team et al. [2023]</span>
<span class="ltx_bibblock">
Adaptive Agent Team, Jakob Bauer, Kate Baumli, Satinder Baveja, Feryal
Behbahani, Avishkar Bhoopchand, Nathalie Bradley-Schmieg, Michael Chang,
Natalie Clay, Adrian Collister, et al.

</span>
<span class="ltx_bibblock">Human-timescale adaptation in an open-ended task space.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib89.1.1">arXiv preprint arXiv:2301.07608</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib90">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Todorov et al. [2012]</span>
<span class="ltx_bibblock">
Emanuel Todorov, Tom Erez, and Yuval Tassa.

</span>
<span class="ltx_bibblock">MuJoCo: A physics engine for model-based control.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib90.1.1">2012 IEEE/RSJ International Conference on
Intelligent Robots and Systems</em>, pp.  5026–5033, October 2012.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/IROS.2012.6386109</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib91">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. [2017]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, lukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib91.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib92">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2016]</span>
<span class="ltx_bibblock">
Jane X Wang, Zeb Kurth-Nelson, Dhruva Tirumala, Hubert Soyer, Joel Z Leibo,
Remi Munos, Charles Blundell, Dharshan Kumaran, and Matt Botvinick.

</span>
<span class="ltx_bibblock">Learning to reinforcement learn.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib92.1.1">arXiv preprint arXiv:1611.05763</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib93">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wayne et al. [2018]</span>
<span class="ltx_bibblock">
Greg Wayne, Chia-Chun Hung, David Amos, Mehdi Mirza, Arun Ahuja, Agnieszka
Grabska-Barwinska, Jack W. Rae, Piotr Mirowski, Joel Z. Leibo, Adam
Santoro, Mevlana Gemici, Malcolm Reynolds, Tim Harley, Josh Abramson, Shakir
Mohamed, Danilo Jimenez Rezende, David Saxton, Adam Cain, Chloe Hillier,
David Silver, Koray Kavukcuoglu, Matthew M. Botvinick, Demis Hassabis, and
Timothy P. Lillicrap.

</span>
<span class="ltx_bibblock">Unsupervised predictive memory in a goal-directed agent.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib93.1.1">CoRR</em>, abs/1803.10760, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib94">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. [2022]</span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Fei Xia, Ed Chi, Quoc V
Le, Denny Zhou, et al.

</span>
<span class="ltx_bibblock">Chain-of-thought prompting elicits reasoning in large language
models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib94.1.1">Advances in Neural Information Processing Systems</em>,
35:24824–24837, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib95">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weston et al. [2015]</span>
<span class="ltx_bibblock">
Jason Weston, Sumit Chopra, and Antoine Bordes.

</span>
<span class="ltx_bibblock">Memory networks, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib96">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Widrich et al. [2021]</span>
<span class="ltx_bibblock">
Michael Widrich, Markus Hofmarcher, Vihang Prakash Patil, Angela Bitto-Nemling,
and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">Modern hopfield networks for return decomposition for delayed
rewards.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib96.1.1">Deep RL Workshop NeurIPS 2021</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib97">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolczyk et al. [2021]</span>
<span class="ltx_bibblock">
Maciej Wolczyk, Michal Zajkac, Razvan Pascanu, Lukasz Kuciński,
and Piotr Miloś.

</span>
<span class="ltx_bibblock">Continual world: A robotic benchmark for continual reinforcement
learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib97.1.1">Advances in Neural Information Processing Systems</em>,
34:28496–28510, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib98">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolf et al. [2020]</span>
<span class="ltx_bibblock">
Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue,
Anthony Moi, Pierric Cistac, Tim Rault, Rémi Louf, Morgan Funtowicz, Joe
Davison, Sam Shleifer, Patrick von Platen, Clara Ma, Yacine Jernite, Julien
Plu, Canwen Xu, Teven Le Scao, Sylvain Gugger, Mariama Drame, Quentin Lhoest,
and Alexander M. Rush.

</span>
<span class="ltx_bibblock">Transformers: State-of-the-art natural language processing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib98.1.1">Proceedings of the 2020 Conference on Empirical Methods in
Natural Language Processing: System Demonstrations</em>, pp.  38–45, Online,
October 2020. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib99">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2023a]</span>
<span class="ltx_bibblock">
Mengjiao Yang, Yilun Du, Kamyar Ghasemipour, Jonathan Tompson, Dale Schuurmans,
and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Learning interactive real-world simulators.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib99.1.1">arXiv preprint arXiv:2310.06114</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib100">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2023b]</span>
<span class="ltx_bibblock">
Zhuolin Yang, Wei Ping, Zihan Liu, Vijay Korthikanti, Weili Nie, De-An Huang,
Linxi Fan, Zhiding Yu, Shiyi Lan, Bo Li, Ming-Yu Liu, Yuke Zhu, Mohammad
Shoeybi, Bryan Catanzaro, Chaowei Xiao, and Anima Anandkumar.

</span>
<span class="ltx_bibblock">Re-vilm: Retrieval-augmented visual language model for zero and
few-shot image captioning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib100.1.1">CoRR</em>, abs/2302.04858, 2023b.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/arXiv.2302.04858</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib101">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. [2024]</span>
<span class="ltx_bibblock">
Shunyu Yao, Dian Yu, Jeffrey Zhao, Izhak Shafran, Tom Griffiths, Yuan Cao, and
Karthik Narasimhan.

</span>
<span class="ltx_bibblock">Tree of thoughts: Deliberate problem solving with large language
models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib101.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib102">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yasunaga et al. [2023]</span>
<span class="ltx_bibblock">
Michihiro Yasunaga, Armen Aghajanyan, Weijia Shi, Richard James, Jure Leskovec,
Percy Liang, Mike Lewis, Luke Zettlemoyer, and Wen-Tau Yih.

</span>
<span class="ltx_bibblock">Retrieval-augmented multimodal language modeling.

</span>
<span class="ltx_bibblock">In Andreas Krause, Emma Brunskill, Kyunghyun Cho, Barbara Engelhardt,
Sivan Sabato, and Jonathan Scarlett (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib102.1.1">International Conference on
Machine Learning, ICML 2023, 23-29 July 2023, Honolulu, Hawaii, USA</em>,
volume 202 of <em class="ltx_emph ltx_font_italic" id="bib.bib102.2.2">Proceedings of Machine Learning Research</em>, pp. 39755–39769. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib103">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. [2020a]</span>
<span class="ltx_bibblock">
Tianhe Yu, Saurabh Kumar, Abhishek Gupta, Sergey Levine, Karol Hausman, and
Chelsea Finn.

</span>
<span class="ltx_bibblock">Gradient surgery for multi-task learning.

</span>
<span class="ltx_bibblock">In Hugo Larochelle, Marc’Aurelio Ranzato, Raia Hadsell,
Maria-Florina Balcan, and Hsuan-Tien Lin (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib103.1.1">Advances in Neural
Information Processing Systems 33: Annual Conference on Neural Information
Processing Systems 2020, NeurIPS 2020, December 6-12, 2020, virtual</em>,
2020a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib104">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. [2020b]</span>
<span class="ltx_bibblock">
Tianhe Yu, Deirdre Quillen, Zhanpeng He, Ryan Julian, Karol Hausman, Chelsea
Finn, and Sergey Levine.

</span>
<span class="ltx_bibblock">Meta-world: A benchmark and evaluation for multi-task and meta
reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib104.1.1">Conference on robot learning</em>, pp.  1094–1100. PMLR,
2020b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib105">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zaremba &amp; Sutskever [2015]</span>
<span class="ltx_bibblock">
Wojciech Zaremba and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Reinforcement learning neural turing machines.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib105.1.1">CoRR</em>, abs/1505.00521, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib106">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Åström [1965]</span>
<span class="ltx_bibblock">
K.J Åström.

</span>
<span class="ltx_bibblock">Optimal control of markov processes with incomplete state
information.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib106.1.1">Journal of Mathematical Analysis and Applications</em>, 10(1):174–205, 1965.

</span>
<span class="ltx_bibblock">ISSN 0022-247X.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">https://doi.org/10.1016/0022-247X(65)90154-X</span>.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>
<nav class="ltx_TOC ltx_list_toc ltx_toc_toc"><h6 class="ltx_title ltx_title_contents">Contents</h6>
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S1" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S2" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS1" title="In 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Background</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2" title="In 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Retrieval-augmented Decision Transformer (RA-DT)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS1" title="In 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Vector Index for Retrieval Augmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS2" title="In 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Searching for Similar Experiences</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS3" title="In 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Reweighting Retrieved Experiences</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS4" title="In 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.4 </span>Incorporating Retrieved <span class="ltx_text"> </span>Experiences</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS1" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Dark-Room</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS2" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Dark Key-Door</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS3" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Maze-Runner</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS4" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Meta-World &amp; DMControl</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS5" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Procgen</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS6" title="In 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Ablations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S5" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S6" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A1" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Ethics Statement &amp; Reproducibility</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Environments &amp; Datasets</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS1" title="In Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Dark-Room and Dark Key-Door</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS2" title="In Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>MazeRunner</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS3" title="In Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Meta-World</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS4" title="In Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4 </span>DMControl</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.SS5" title="In Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.5 </span>Procgen</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Experimental &amp; Implementation Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS1" title="In Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>General</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS2" title="In Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Decision Transformer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS3" title="In Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>Algorithm Distillation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS4" title="In Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.4 </span>Retrieval-Augmented Decision Transformer</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Additional Results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS1" title="In Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1 </span>Dark-Room</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS1.SSS1" title="In D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1.1 </span>Attention Map Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS1.SSS2" title="In D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.1.2 </span>Exploration Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS2" title="In Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.2 </span>Maze-Runner</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS3" title="In Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.3 </span>Meta-World</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS4" title="In Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.4 </span>DMControl</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS5" title="In Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D.5 </span>Procgen</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5" title="In Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Ablation Studies</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS1" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.1 </span>Retrieval outperforms sampling of experiences</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS2" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.2 </span>Reweighting Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS3" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.3 </span>Retrieval Regularization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS4" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.4 </span>Query Construction &amp; Sequence Aggregation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS5" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.5 </span>Placement of Cross-Attention Layers</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS6" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.6 </span>Interaction steps between context retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS7" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.7 </span>Pre-trained Language Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS8" title="In Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E.8 </span>Effect of <math alttext="K" class="ltx_Math" display="inline"><semantics><mi>K</mi><annotation-xml encoding="MathML-Content"><ci>𝐾</ci></annotation-xml><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math> on Algorithm Distillation</span></a></li>
</ol>
</li>
</ol></nav>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Ethics Statement &amp; Reproducibility</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In recent years, there has been a trend in RL towards large-scale multi-task models that leverage offline pre-training.
In this work, we broadly aim at building agents that can learn new tasks via ICL without the need for re-training or fine-tuning.
Our goal is to reduce the need to provide entire past episodes in the agent’s context, by augmenting the agent with an external memory in combination with a retrieval component, similar to RAG in LLMs.
We believe that multi-task agents of the near future will be able to perform a broad range of tasks, and that these agents will greatly benefit from RAG as used in RA-DT.
The external memory component can enable agents to leverage information from in its own distant past or experiences from other agents.
Such agents could have an immense impact on the global economy (e.g., as a source of inexpensive labour).
As such, they do not come without risks and the potential for misuse.
While we believe that our work can significantly impact the positive use of future agents, it is essential to ensure responsible deployment of future technologies.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p2">
<p class="ltx_p" id="A1.p2.1">We open-source the code-base used for our experiments, and release the datasets we generated. Both are available at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ml-jku/RA-DT" title="">https://github.com/ml-jku/RA-DT</a>.
In addition, we provide further information on the environments/datasets, implementation including hyperparameter tables, and on our experiments in Appendices <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2" title="Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">B</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3" title="Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">C</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4" title="Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D</span></a>, respectively.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Environments &amp; Datasets</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Dark-Room and Dark Key-Door</h3>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.3">The Dark-Room environment is modelled after Morris-Watermaze, a classic experiment in behavioural neuroscience for studying spatial memory and learning in animals <cite class="ltx_cite ltx_citemacro_citep">[D’Hooge &amp; De Deyn, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib19" title="">2001</a>]</cite>.
We design our Dark-Room and Dark Key-Door environments in Minihack <cite class="ltx_cite ltx_citemacro_citep">[Samvelyan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib75" title="">2021</a>]</cite>, which is based on the NetHack Learning Environment <cite class="ltx_cite ltx_citemacro_citep">[Küttler et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib44" title="">2020</a>]</cite>.
We construct grids of dimensions <math alttext="10\times 10" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.1"><semantics id="A2.SS1.p1.1.m1.1a"><mrow id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml"><mn id="A2.SS1.p1.1.m1.1.1.2" xref="A2.SS1.p1.1.m1.1.1.2.cmml">10</mn><mo id="A2.SS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="A2.SS1.p1.1.m1.1.1.3" xref="A2.SS1.p1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><apply id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1"><times id="A2.SS1.p1.1.m1.1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1.1"></times><cn id="A2.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="A2.SS1.p1.1.m1.1.1.2">10</cn><cn id="A2.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="A2.SS1.p1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.1d">10 × 10</annotation></semantics></math>, <math alttext="20\times 20" class="ltx_Math" display="inline" id="A2.SS1.p1.2.m2.1"><semantics id="A2.SS1.p1.2.m2.1a"><mrow id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml"><mn id="A2.SS1.p1.2.m2.1.1.2" xref="A2.SS1.p1.2.m2.1.1.2.cmml">20</mn><mo id="A2.SS1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="A2.SS1.p1.2.m2.1.1.3" xref="A2.SS1.p1.2.m2.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1"><times id="A2.SS1.p1.2.m2.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1.1"></times><cn id="A2.SS1.p1.2.m2.1.1.2.cmml" type="integer" xref="A2.SS1.p1.2.m2.1.1.2">20</cn><cn id="A2.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="A2.SS1.p1.2.m2.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">20\times 20</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.2.m2.1d">20 × 20</annotation></semantics></math> and <math alttext="40\times 20" class="ltx_Math" display="inline" id="A2.SS1.p1.3.m3.1"><semantics id="A2.SS1.p1.3.m3.1a"><mrow id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml"><mn id="A2.SS1.p1.3.m3.1.1.2" xref="A2.SS1.p1.3.m3.1.1.2.cmml">40</mn><mo id="A2.SS1.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p1.3.m3.1.1.1.cmml">×</mo><mn id="A2.SS1.p1.3.m3.1.1.3" xref="A2.SS1.p1.3.m3.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><apply id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1"><times id="A2.SS1.p1.3.m3.1.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1.1"></times><cn id="A2.SS1.p1.3.m3.1.1.2.cmml" type="integer" xref="A2.SS1.p1.3.m3.1.1.2">40</cn><cn id="A2.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="A2.SS1.p1.3.m3.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">40\times 20</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.3.m3.1d">40 × 20</annotation></semantics></math>, as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F9" title="Figure 9 ‣ B.1 Dark-Room and Dark Key-Door ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">9</span></a>.
With increasing grid sizes, the task of locating the goal becomes harder as the number of possible positions in the grid grows (100, 400, 800).
Therefore, we set the number of interaction steps per environment equal to the number of grid cells.
Consequently, larger grids results in longer episodes and thus context lengths (e.g., 2400 for AD).
The agent observes its own x-y position on the grid and can perform one of 5 actions at every interaction step (up, down, left, right, stay).
Episodes start in the top left corner (0,0) and the agent is reset to the start position after every episode.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.2">In <span class="ltx_text ltx_font_bold" id="A2.SS1.p2.2.1">Dark-Room</span>, the agent has to navigate to a randomly placed and invisible goal position.
Therefore, the task space in Dark-Room environments is equal to the number of grid-cells (i.e., <math alttext="100" class="ltx_Math" display="inline" id="A2.SS1.p2.1.m1.1"><semantics id="A2.SS1.p2.1.m1.1a"><mn id="A2.SS1.p2.1.m1.1.1" xref="A2.SS1.p2.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.1.m1.1b"><cn id="A2.SS1.p2.1.m1.1.1.cmml" type="integer" xref="A2.SS1.p2.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.1.m1.1c">100</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.1.m1.1d">100</annotation></semantics></math> for <math alttext="10\times 10" class="ltx_Math" display="inline" id="A2.SS1.p2.2.m2.1"><semantics id="A2.SS1.p2.2.m2.1a"><mrow id="A2.SS1.p2.2.m2.1.1" xref="A2.SS1.p2.2.m2.1.1.cmml"><mn id="A2.SS1.p2.2.m2.1.1.2" xref="A2.SS1.p2.2.m2.1.1.2.cmml">10</mn><mo id="A2.SS1.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p2.2.m2.1.1.1.cmml">×</mo><mn id="A2.SS1.p2.2.m2.1.1.3" xref="A2.SS1.p2.2.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.2.m2.1b"><apply id="A2.SS1.p2.2.m2.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1"><times id="A2.SS1.p2.2.m2.1.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1.1"></times><cn id="A2.SS1.p2.2.m2.1.1.2.cmml" type="integer" xref="A2.SS1.p2.2.m2.1.1.2">10</cn><cn id="A2.SS1.p2.2.m2.1.1.3.cmml" type="integer" xref="A2.SS1.p2.2.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.2.m2.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p2.2.m2.1d">10 × 10</annotation></semantics></math>).
The agent receives a reward for +1 for every step in the episode it is located in the goal position and 0 otherwise.
As there are as many grid-cells as episode steps, the optimal strategy for solving the Dark-Room task is to use the first episode to visit every cell to find the hidden goal location.
Once found, this knowledge can be exploited in upcoming trials.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p3">
<p class="ltx_p" id="A2.SS1.p3.2">In contrast, in <span class="ltx_text ltx_font_bold" id="A2.SS1.p3.2.1">Dark Key-Door</span>, there are two objects: a key and a goal state.
Similar to Dark-Room, the key and goal position are randomly placed on the grid.
The agent has to first pick up the invisible key and then find the invisible goal.
Due to the presence of the two key events (picking up the key, finding the goal), the task space is combinatorial in the number of grid-cells (i.e., <math alttext="100^{2}=10000" class="ltx_Math" display="inline" id="A2.SS1.p3.1.m1.1"><semantics id="A2.SS1.p3.1.m1.1a"><mrow id="A2.SS1.p3.1.m1.1.1" xref="A2.SS1.p3.1.m1.1.1.cmml"><msup id="A2.SS1.p3.1.m1.1.1.2" xref="A2.SS1.p3.1.m1.1.1.2.cmml"><mn id="A2.SS1.p3.1.m1.1.1.2.2" xref="A2.SS1.p3.1.m1.1.1.2.2.cmml">100</mn><mn id="A2.SS1.p3.1.m1.1.1.2.3" xref="A2.SS1.p3.1.m1.1.1.2.3.cmml">2</mn></msup><mo id="A2.SS1.p3.1.m1.1.1.1" xref="A2.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS1.p3.1.m1.1.1.3" xref="A2.SS1.p3.1.m1.1.1.3.cmml">10000</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.1.m1.1b"><apply id="A2.SS1.p3.1.m1.1.1.cmml" xref="A2.SS1.p3.1.m1.1.1"><eq id="A2.SS1.p3.1.m1.1.1.1.cmml" xref="A2.SS1.p3.1.m1.1.1.1"></eq><apply id="A2.SS1.p3.1.m1.1.1.2.cmml" xref="A2.SS1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p3.1.m1.1.1.2.1.cmml" xref="A2.SS1.p3.1.m1.1.1.2">superscript</csymbol><cn id="A2.SS1.p3.1.m1.1.1.2.2.cmml" type="integer" xref="A2.SS1.p3.1.m1.1.1.2.2">100</cn><cn id="A2.SS1.p3.1.m1.1.1.2.3.cmml" type="integer" xref="A2.SS1.p3.1.m1.1.1.2.3">2</cn></apply><cn id="A2.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="A2.SS1.p3.1.m1.1.1.3">10000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.1.m1.1c">100^{2}=10000</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.1.m1.1d">100 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = 10000</annotation></semantics></math> for <math alttext="10\times 10" class="ltx_Math" display="inline" id="A2.SS1.p3.2.m2.1"><semantics id="A2.SS1.p3.2.m2.1a"><mrow id="A2.SS1.p3.2.m2.1.1" xref="A2.SS1.p3.2.m2.1.1.cmml"><mn id="A2.SS1.p3.2.m2.1.1.2" xref="A2.SS1.p3.2.m2.1.1.2.cmml">10</mn><mo id="A2.SS1.p3.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p3.2.m2.1.1.1.cmml">×</mo><mn id="A2.SS1.p3.2.m2.1.1.3" xref="A2.SS1.p3.2.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.2.m2.1b"><apply id="A2.SS1.p3.2.m2.1.1.cmml" xref="A2.SS1.p3.2.m2.1.1"><times id="A2.SS1.p3.2.m2.1.1.1.cmml" xref="A2.SS1.p3.2.m2.1.1.1"></times><cn id="A2.SS1.p3.2.m2.1.1.2.cmml" type="integer" xref="A2.SS1.p3.2.m2.1.1.2">10</cn><cn id="A2.SS1.p3.2.m2.1.1.3.cmml" type="integer" xref="A2.SS1.p3.2.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.2.m2.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p3.2.m2.1d">10 × 10</annotation></semantics></math>).
This makes the Dark Key-Door more challenging than the Dark-Room task, especially as the grid-size becomes larger.</p>
</div>
<figure class="ltx_figure" id="A2.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A2.F7.sf1.g1" src="extracted/5911726/figures/data/darkroom10x10.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="A2.F7.sf1.2.m1.1"><semantics id="A2.F7.sf1.2.m1.1b"><mo id="A2.F7.sf1.2.m1.1.1" xref="A2.F7.sf1.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F7.sf1.2.m1.1c"><times id="A2.F7.sf1.2.m1.1.1.cmml" xref="A2.F7.sf1.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F7.sf1.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F7.sf1.2.m1.1e">×</annotation></semantics></math>10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="A2.F7.sf2.g1" src="extracted/5911726/figures/data/darkroom20x20.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Dark-Room 20<math alttext="\times" class="ltx_Math" display="inline" id="A2.F7.sf2.2.m1.1"><semantics id="A2.F7.sf2.2.m1.1b"><mo id="A2.F7.sf2.2.m1.1.1" xref="A2.F7.sf2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F7.sf2.2.m1.1c"><times id="A2.F7.sf2.2.m1.1.1.cmml" xref="A2.F7.sf2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F7.sf2.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F7.sf2.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F7.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="A2.F7.sf3.g1" src="extracted/5911726/figures/data/darkroom40x20.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Dark-Room 40<math alttext="\times" class="ltx_Math" display="inline" id="A2.F7.sf3.2.m1.1"><semantics id="A2.F7.sf3.2.m1.1b"><mo id="A2.F7.sf3.2.m1.1.1" xref="A2.F7.sf3.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F7.sf3.2.m1.1c"><times id="A2.F7.sf3.2.m1.1.1.cmml" xref="A2.F7.sf3.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F7.sf3.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F7.sf3.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Average performances of the <span class="ltx_text ltx_font_bold" id="A2.F7.11.1">source algorithm</span>, PPO, on 80 train tasks for Dark-Room <span class="ltx_text ltx_font_bold" id="A2.F7.12.2">(a)</span> 10<math alttext="\times" class="ltx_Math" display="inline" id="A2.F7.4.m1.1"><semantics id="A2.F7.4.m1.1b"><mo id="A2.F7.4.m1.1.1" xref="A2.F7.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F7.4.m1.1c"><times id="A2.F7.4.m1.1.1.cmml" xref="A2.F7.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F7.4.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F7.4.m1.1e">×</annotation></semantics></math>10, <span class="ltx_text ltx_font_bold" id="A2.F7.13.3">(b)</span> 20<math alttext="\times" class="ltx_Math" display="inline" id="A2.F7.5.m2.1"><semantics id="A2.F7.5.m2.1b"><mo id="A2.F7.5.m2.1.1" xref="A2.F7.5.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F7.5.m2.1c"><times id="A2.F7.5.m2.1.1.cmml" xref="A2.F7.5.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F7.5.m2.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F7.5.m2.1e">×</annotation></semantics></math>20, and <span class="ltx_text ltx_font_bold" id="A2.F7.14.4">(c)</span> 40<math alttext="\times" class="ltx_Math" display="inline" id="A2.F7.6.m3.1"><semantics id="A2.F7.6.m3.1b"><mo id="A2.F7.6.m3.1.1" xref="A2.F7.6.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F7.6.m3.1c"><times id="A2.F7.6.m3.1.1.cmml" xref="A2.F7.6.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F7.6.m3.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F7.6.m3.1e">×</annotation></semantics></math>20.
For (a), (b) we train PPO on individual tasks for 100K environment steps.
For (c), we train for 200K environment steps to take the longer episode lengths into account. We evaluate the agents after every 10K steps.
Curves show the mean reward achieved (+ 95% CI) across the 80 train tasks.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS1.p4">
<p class="ltx_p" id="A2.SS1.p4.5"><span class="ltx_text ltx_font_bold" id="A2.SS1.p4.5.1">Training Dataset.</span> For both Dark-Room and Dark Key-Door, we generate training datasets for 80 randomly assigned goals or key-goal combinations.
We use PPO <cite class="ltx_cite ltx_citemacro_citep">[Schulman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib82" title="">2017</a>]</cite> to generate 100K environment transitions per goal location for <math alttext="10\times 10" class="ltx_Math" display="inline" id="A2.SS1.p4.1.m1.1"><semantics id="A2.SS1.p4.1.m1.1a"><mrow id="A2.SS1.p4.1.m1.1.1" xref="A2.SS1.p4.1.m1.1.1.cmml"><mn id="A2.SS1.p4.1.m1.1.1.2" xref="A2.SS1.p4.1.m1.1.1.2.cmml">10</mn><mo id="A2.SS1.p4.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p4.1.m1.1.1.1.cmml">×</mo><mn id="A2.SS1.p4.1.m1.1.1.3" xref="A2.SS1.p4.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.1.m1.1b"><apply id="A2.SS1.p4.1.m1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1"><times id="A2.SS1.p4.1.m1.1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1.1"></times><cn id="A2.SS1.p4.1.m1.1.1.2.cmml" type="integer" xref="A2.SS1.p4.1.m1.1.1.2">10</cn><cn id="A2.SS1.p4.1.m1.1.1.3.cmml" type="integer" xref="A2.SS1.p4.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.1.m1.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.1.m1.1d">10 × 10</annotation></semantics></math> and <math alttext="20\times 20" class="ltx_Math" display="inline" id="A2.SS1.p4.2.m2.1"><semantics id="A2.SS1.p4.2.m2.1a"><mrow id="A2.SS1.p4.2.m2.1.1" xref="A2.SS1.p4.2.m2.1.1.cmml"><mn id="A2.SS1.p4.2.m2.1.1.2" xref="A2.SS1.p4.2.m2.1.1.2.cmml">20</mn><mo id="A2.SS1.p4.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p4.2.m2.1.1.1.cmml">×</mo><mn id="A2.SS1.p4.2.m2.1.1.3" xref="A2.SS1.p4.2.m2.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.2.m2.1b"><apply id="A2.SS1.p4.2.m2.1.1.cmml" xref="A2.SS1.p4.2.m2.1.1"><times id="A2.SS1.p4.2.m2.1.1.1.cmml" xref="A2.SS1.p4.2.m2.1.1.1"></times><cn id="A2.SS1.p4.2.m2.1.1.2.cmml" type="integer" xref="A2.SS1.p4.2.m2.1.1.2">20</cn><cn id="A2.SS1.p4.2.m2.1.1.3.cmml" type="integer" xref="A2.SS1.p4.2.m2.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.2.m2.1c">20\times 20</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.2.m2.1d">20 × 20</annotation></semantics></math> grids and 200K environment transitions for the largest grid.
Therefore, the total number of transitions across datasets is 8M for <math alttext="10\times 10" class="ltx_Math" display="inline" id="A2.SS1.p4.3.m3.1"><semantics id="A2.SS1.p4.3.m3.1a"><mrow id="A2.SS1.p4.3.m3.1.1" xref="A2.SS1.p4.3.m3.1.1.cmml"><mn id="A2.SS1.p4.3.m3.1.1.2" xref="A2.SS1.p4.3.m3.1.1.2.cmml">10</mn><mo id="A2.SS1.p4.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p4.3.m3.1.1.1.cmml">×</mo><mn id="A2.SS1.p4.3.m3.1.1.3" xref="A2.SS1.p4.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.3.m3.1b"><apply id="A2.SS1.p4.3.m3.1.1.cmml" xref="A2.SS1.p4.3.m3.1.1"><times id="A2.SS1.p4.3.m3.1.1.1.cmml" xref="A2.SS1.p4.3.m3.1.1.1"></times><cn id="A2.SS1.p4.3.m3.1.1.2.cmml" type="integer" xref="A2.SS1.p4.3.m3.1.1.2">10</cn><cn id="A2.SS1.p4.3.m3.1.1.3.cmml" type="integer" xref="A2.SS1.p4.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.3.m3.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.3.m3.1d">10 × 10</annotation></semantics></math> and <math alttext="20\times 20" class="ltx_Math" display="inline" id="A2.SS1.p4.4.m4.1"><semantics id="A2.SS1.p4.4.m4.1a"><mrow id="A2.SS1.p4.4.m4.1.1" xref="A2.SS1.p4.4.m4.1.1.cmml"><mn id="A2.SS1.p4.4.m4.1.1.2" xref="A2.SS1.p4.4.m4.1.1.2.cmml">20</mn><mo id="A2.SS1.p4.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p4.4.m4.1.1.1.cmml">×</mo><mn id="A2.SS1.p4.4.m4.1.1.3" xref="A2.SS1.p4.4.m4.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.4.m4.1b"><apply id="A2.SS1.p4.4.m4.1.1.cmml" xref="A2.SS1.p4.4.m4.1.1"><times id="A2.SS1.p4.4.m4.1.1.1.cmml" xref="A2.SS1.p4.4.m4.1.1.1"></times><cn id="A2.SS1.p4.4.m4.1.1.2.cmml" type="integer" xref="A2.SS1.p4.4.m4.1.1.2">20</cn><cn id="A2.SS1.p4.4.m4.1.1.3.cmml" type="integer" xref="A2.SS1.p4.4.m4.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.4.m4.1c">20\times 20</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.4.m4.1d">20 × 20</annotation></semantics></math> grids and 16M for <math alttext="40\times 20" class="ltx_Math" display="inline" id="A2.SS1.p4.5.m5.1"><semantics id="A2.SS1.p4.5.m5.1a"><mrow id="A2.SS1.p4.5.m5.1.1" xref="A2.SS1.p4.5.m5.1.1.cmml"><mn id="A2.SS1.p4.5.m5.1.1.2" xref="A2.SS1.p4.5.m5.1.1.2.cmml">40</mn><mo id="A2.SS1.p4.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p4.5.m5.1.1.1.cmml">×</mo><mn id="A2.SS1.p4.5.m5.1.1.3" xref="A2.SS1.p4.5.m5.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.5.m5.1b"><apply id="A2.SS1.p4.5.m5.1.1.cmml" xref="A2.SS1.p4.5.m5.1.1"><times id="A2.SS1.p4.5.m5.1.1.1.cmml" xref="A2.SS1.p4.5.m5.1.1.1"></times><cn id="A2.SS1.p4.5.m5.1.1.2.cmml" type="integer" xref="A2.SS1.p4.5.m5.1.1.2">40</cn><cn id="A2.SS1.p4.5.m5.1.1.3.cmml" type="integer" xref="A2.SS1.p4.5.m5.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.5.m5.1c">40\times 20</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.5.m5.1d">40 × 20</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p5">
<p class="ltx_p" id="A2.SS1.p5.10">We train PPO with standard hyperparameter settings in <span class="ltx_text ltx_font_typewriter" id="A2.SS1.p5.10.1">stable-baselines3</span> <cite class="ltx_cite ltx_citemacro_citep">[Raffin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib70" title="">2021</a>]</cite> using a learning rate of <math alttext="3e^{-4}" class="ltx_Math" display="inline" id="A2.SS1.p5.1.m1.1"><semantics id="A2.SS1.p5.1.m1.1a"><mrow id="A2.SS1.p5.1.m1.1.1" xref="A2.SS1.p5.1.m1.1.1.cmml"><mn id="A2.SS1.p5.1.m1.1.1.2" xref="A2.SS1.p5.1.m1.1.1.2.cmml">3</mn><mo id="A2.SS1.p5.1.m1.1.1.1" xref="A2.SS1.p5.1.m1.1.1.1.cmml">⁢</mo><msup id="A2.SS1.p5.1.m1.1.1.3" xref="A2.SS1.p5.1.m1.1.1.3.cmml"><mi id="A2.SS1.p5.1.m1.1.1.3.2" xref="A2.SS1.p5.1.m1.1.1.3.2.cmml">e</mi><mrow id="A2.SS1.p5.1.m1.1.1.3.3" xref="A2.SS1.p5.1.m1.1.1.3.3.cmml"><mo id="A2.SS1.p5.1.m1.1.1.3.3a" xref="A2.SS1.p5.1.m1.1.1.3.3.cmml">−</mo><mn id="A2.SS1.p5.1.m1.1.1.3.3.2" xref="A2.SS1.p5.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.1.m1.1b"><apply id="A2.SS1.p5.1.m1.1.1.cmml" xref="A2.SS1.p5.1.m1.1.1"><times id="A2.SS1.p5.1.m1.1.1.1.cmml" xref="A2.SS1.p5.1.m1.1.1.1"></times><cn id="A2.SS1.p5.1.m1.1.1.2.cmml" type="integer" xref="A2.SS1.p5.1.m1.1.1.2">3</cn><apply id="A2.SS1.p5.1.m1.1.1.3.cmml" xref="A2.SS1.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p5.1.m1.1.1.3.1.cmml" xref="A2.SS1.p5.1.m1.1.1.3">superscript</csymbol><ci id="A2.SS1.p5.1.m1.1.1.3.2.cmml" xref="A2.SS1.p5.1.m1.1.1.3.2">𝑒</ci><apply id="A2.SS1.p5.1.m1.1.1.3.3.cmml" xref="A2.SS1.p5.1.m1.1.1.3.3"><minus id="A2.SS1.p5.1.m1.1.1.3.3.1.cmml" xref="A2.SS1.p5.1.m1.1.1.3.3"></minus><cn id="A2.SS1.p5.1.m1.1.1.3.3.2.cmml" type="integer" xref="A2.SS1.p5.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.1.m1.1c">3e^{-4}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.1.m1.1d">3 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, batch size of <math alttext="64" class="ltx_Math" display="inline" id="A2.SS1.p5.2.m2.1"><semantics id="A2.SS1.p5.2.m2.1a"><mn id="A2.SS1.p5.2.m2.1.1" xref="A2.SS1.p5.2.m2.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.2.m2.1b"><cn id="A2.SS1.p5.2.m2.1.1.cmml" type="integer" xref="A2.SS1.p5.2.m2.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.2.m2.1c">64</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.2.m2.1d">64</annotation></semantics></math>, number of steps between updates of <math alttext="2048" class="ltx_Math" display="inline" id="A2.SS1.p5.3.m3.1"><semantics id="A2.SS1.p5.3.m3.1a"><mn id="A2.SS1.p5.3.m3.1.1" xref="A2.SS1.p5.3.m3.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.3.m3.1b"><cn id="A2.SS1.p5.3.m3.1.1.cmml" type="integer" xref="A2.SS1.p5.3.m3.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.3.m3.1c">2048</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.3.m3.1d">2048</annotation></semantics></math>, number of update epochs <math alttext="10" class="ltx_Math" display="inline" id="A2.SS1.p5.4.m4.1"><semantics id="A2.SS1.p5.4.m4.1a"><mn id="A2.SS1.p5.4.m4.1.1" xref="A2.SS1.p5.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.4.m4.1b"><cn id="A2.SS1.p5.4.m4.1.1.cmml" type="integer" xref="A2.SS1.p5.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.4.m4.1c">10</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.4.m4.1d">10</annotation></semantics></math> and entropy coefficient of <math alttext="0.01" class="ltx_Math" display="inline" id="A2.SS1.p5.5.m5.1"><semantics id="A2.SS1.p5.5.m5.1a"><mn id="A2.SS1.p5.5.m5.1.1" xref="A2.SS1.p5.5.m5.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.5.m5.1b"><cn id="A2.SS1.p5.5.m5.1.1.cmml" type="float" xref="A2.SS1.p5.5.m5.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.5.m5.1c">0.01</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.5.m5.1d">0.01</annotation></semantics></math>.
For <math alttext="20\times 20" class="ltx_Math" display="inline" id="A2.SS1.p5.6.m6.1"><semantics id="A2.SS1.p5.6.m6.1a"><mrow id="A2.SS1.p5.6.m6.1.1" xref="A2.SS1.p5.6.m6.1.1.cmml"><mn id="A2.SS1.p5.6.m6.1.1.2" xref="A2.SS1.p5.6.m6.1.1.2.cmml">20</mn><mo id="A2.SS1.p5.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p5.6.m6.1.1.1.cmml">×</mo><mn id="A2.SS1.p5.6.m6.1.1.3" xref="A2.SS1.p5.6.m6.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.6.m6.1b"><apply id="A2.SS1.p5.6.m6.1.1.cmml" xref="A2.SS1.p5.6.m6.1.1"><times id="A2.SS1.p5.6.m6.1.1.1.cmml" xref="A2.SS1.p5.6.m6.1.1.1"></times><cn id="A2.SS1.p5.6.m6.1.1.2.cmml" type="integer" xref="A2.SS1.p5.6.m6.1.1.2">20</cn><cn id="A2.SS1.p5.6.m6.1.1.3.cmml" type="integer" xref="A2.SS1.p5.6.m6.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.6.m6.1c">20\times 20</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.6.m6.1d">20 × 20</annotation></semantics></math> and <math alttext="40\times 20" class="ltx_Math" display="inline" id="A2.SS1.p5.7.m7.1"><semantics id="A2.SS1.p5.7.m7.1a"><mrow id="A2.SS1.p5.7.m7.1.1" xref="A2.SS1.p5.7.m7.1.1.cmml"><mn id="A2.SS1.p5.7.m7.1.1.2" xref="A2.SS1.p5.7.m7.1.1.2.cmml">40</mn><mo id="A2.SS1.p5.7.m7.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p5.7.m7.1.1.1.cmml">×</mo><mn id="A2.SS1.p5.7.m7.1.1.3" xref="A2.SS1.p5.7.m7.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.7.m7.1b"><apply id="A2.SS1.p5.7.m7.1.1.cmml" xref="A2.SS1.p5.7.m7.1.1"><times id="A2.SS1.p5.7.m7.1.1.1.cmml" xref="A2.SS1.p5.7.m7.1.1.1"></times><cn id="A2.SS1.p5.7.m7.1.1.2.cmml" type="integer" xref="A2.SS1.p5.7.m7.1.1.2">40</cn><cn id="A2.SS1.p5.7.m7.1.1.3.cmml" type="integer" xref="A2.SS1.p5.7.m7.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.7.m7.1c">40\times 20</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.7.m7.1d">40 × 20</annotation></semantics></math> grids, we increase the number of update epochs to <math alttext="30" class="ltx_Math" display="inline" id="A2.SS1.p5.8.m8.1"><semantics id="A2.SS1.p5.8.m8.1a"><mn id="A2.SS1.p5.8.m8.1.1" xref="A2.SS1.p5.8.m8.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.8.m8.1b"><cn id="A2.SS1.p5.8.m8.1.1.cmml" type="integer" xref="A2.SS1.p5.8.m8.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.8.m8.1c">30</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.8.m8.1d">30</annotation></semantics></math> and the entropy coefficient of to <math alttext="0.1" class="ltx_Math" display="inline" id="A2.SS1.p5.9.m9.1"><semantics id="A2.SS1.p5.9.m9.1a"><mn id="A2.SS1.p5.9.m9.1.1" xref="A2.SS1.p5.9.m9.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.9.m9.1b"><cn id="A2.SS1.p5.9.m9.1.1.cmml" type="float" xref="A2.SS1.p5.9.m9.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.9.m9.1c">0.1</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.9.m9.1d">0.1</annotation></semantics></math> for <math alttext="40\times 20" class="ltx_Math" display="inline" id="A2.SS1.p5.10.m10.1"><semantics id="A2.SS1.p5.10.m10.1a"><mrow id="A2.SS1.p5.10.m10.1.1" xref="A2.SS1.p5.10.m10.1.1.cmml"><mn id="A2.SS1.p5.10.m10.1.1.2" xref="A2.SS1.p5.10.m10.1.1.2.cmml">40</mn><mo id="A2.SS1.p5.10.m10.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p5.10.m10.1.1.1.cmml">×</mo><mn id="A2.SS1.p5.10.m10.1.1.3" xref="A2.SS1.p5.10.m10.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p5.10.m10.1b"><apply id="A2.SS1.p5.10.m10.1.1.cmml" xref="A2.SS1.p5.10.m10.1.1"><times id="A2.SS1.p5.10.m10.1.1.1.cmml" xref="A2.SS1.p5.10.m10.1.1.1"></times><cn id="A2.SS1.p5.10.m10.1.1.2.cmml" type="integer" xref="A2.SS1.p5.10.m10.1.1.2">40</cn><cn id="A2.SS1.p5.10.m10.1.1.3.cmml" type="integer" xref="A2.SS1.p5.10.m10.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p5.10.m10.1c">40\times 20</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p5.10.m10.1d">40 × 20</annotation></semantics></math>. We store all generated transitions of PPO for our datasets. Consequently, the final datasets contain a mixture of suboptimal or exploratory, and optimal or exploitative behaviour.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p6">
<p class="ltx_p" id="A2.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="A2.SS1.p6.1.1">Source Algorithm Performance.</span> We show average learning curves across all task-specific PPO agents on the 80 training tasks for all grid-sizes in Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F7" title="Figure 7 ‣ B.1 Dark-Room and Dark Key-Door ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">7</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F8" title="Figure 8 ‣ B.1 Dark-Room and Dark Key-Door ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">8</span></a> for Dark-Room and Dark Key-Door, respectively.
For the <math alttext="10\times 10" class="ltx_Math" display="inline" id="A2.SS1.p6.1.m1.1"><semantics id="A2.SS1.p6.1.m1.1a"><mrow id="A2.SS1.p6.1.m1.1.1" xref="A2.SS1.p6.1.m1.1.1.cmml"><mn id="A2.SS1.p6.1.m1.1.1.2" xref="A2.SS1.p6.1.m1.1.1.2.cmml">10</mn><mo id="A2.SS1.p6.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS1.p6.1.m1.1.1.1.cmml">×</mo><mn id="A2.SS1.p6.1.m1.1.1.3" xref="A2.SS1.p6.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p6.1.m1.1b"><apply id="A2.SS1.p6.1.m1.1.1.cmml" xref="A2.SS1.p6.1.m1.1.1"><times id="A2.SS1.p6.1.m1.1.1.1.cmml" xref="A2.SS1.p6.1.m1.1.1.1"></times><cn id="A2.SS1.p6.1.m1.1.1.2.cmml" type="integer" xref="A2.SS1.p6.1.m1.1.1.2">10</cn><cn id="A2.SS1.p6.1.m1.1.1.3.cmml" type="integer" xref="A2.SS1.p6.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p6.1.m1.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p6.1.m1.1d">10 × 10</annotation></semantics></math> grids, the average performance converges towards optimal performance.
However, on the larger grid sizes, the performances are below the optimum.
This is because it takes the agent longer to discover and collect successful episodes by initially random environment interaction as the grids become larger.</p>
</div>
<figure class="ltx_figure" id="A2.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A2.F8.sf1.g1" src="extracted/5911726/figures/data/keydoor.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Dark Key-Door 10<math alttext="\times" class="ltx_Math" display="inline" id="A2.F8.sf1.2.m1.1"><semantics id="A2.F8.sf1.2.m1.1b"><mo id="A2.F8.sf1.2.m1.1.1" xref="A2.F8.sf1.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F8.sf1.2.m1.1c"><times id="A2.F8.sf1.2.m1.1.1.cmml" xref="A2.F8.sf1.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F8.sf1.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F8.sf1.2.m1.1e">×</annotation></semantics></math>10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="A2.F8.sf2.g1" src="extracted/5911726/figures/data/keydoor20x20.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Dark Key-Door 20<math alttext="\times" class="ltx_Math" display="inline" id="A2.F8.sf2.2.m1.1"><semantics id="A2.F8.sf2.2.m1.1b"><mo id="A2.F8.sf2.2.m1.1.1" xref="A2.F8.sf2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F8.sf2.2.m1.1c"><times id="A2.F8.sf2.2.m1.1.1.cmml" xref="A2.F8.sf2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F8.sf2.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F8.sf2.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F8.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="A2.F8.sf3.g1" src="extracted/5911726/figures/data/keydoor40x20.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Dark Key-Door 40<math alttext="\times" class="ltx_Math" display="inline" id="A2.F8.sf3.2.m1.1"><semantics id="A2.F8.sf3.2.m1.1b"><mo id="A2.F8.sf3.2.m1.1.1" xref="A2.F8.sf3.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F8.sf3.2.m1.1c"><times id="A2.F8.sf3.2.m1.1.1.cmml" xref="A2.F8.sf3.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F8.sf3.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F8.sf3.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Average performances of the <span class="ltx_text ltx_font_bold" id="A2.F8.12.1">source algorithm</span>, PPO, on 80 train tasks for <span class="ltx_text ltx_font_bold" id="A2.F8.13.2">Dark Key-Door</span> <span class="ltx_text ltx_font_bold" id="A2.F8.14.3">(a)</span> 10<math alttext="\times" class="ltx_Math" display="inline" id="A2.F8.4.m1.1"><semantics id="A2.F8.4.m1.1b"><mo id="A2.F8.4.m1.1.1" xref="A2.F8.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F8.4.m1.1c"><times id="A2.F8.4.m1.1.1.cmml" xref="A2.F8.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F8.4.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F8.4.m1.1e">×</annotation></semantics></math>10, <span class="ltx_text ltx_font_bold" id="A2.F8.15.4">(b)</span> 20<math alttext="\times" class="ltx_Math" display="inline" id="A2.F8.5.m2.1"><semantics id="A2.F8.5.m2.1b"><mo id="A2.F8.5.m2.1.1" xref="A2.F8.5.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F8.5.m2.1c"><times id="A2.F8.5.m2.1.1.cmml" xref="A2.F8.5.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F8.5.m2.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F8.5.m2.1e">×</annotation></semantics></math>20, and <span class="ltx_text ltx_font_bold" id="A2.F8.16.5">(c)</span> 40<math alttext="\times" class="ltx_Math" display="inline" id="A2.F8.6.m3.1"><semantics id="A2.F8.6.m3.1b"><mo id="A2.F8.6.m3.1.1" xref="A2.F8.6.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F8.6.m3.1c"><times id="A2.F8.6.m3.1.1.cmml" xref="A2.F8.6.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F8.6.m3.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F8.6.m3.1e">×</annotation></semantics></math>20.
For (a), (b) we train PPO on individual tasks for 100K environment steps.
For (c), we train for 200K environment steps. We evaluate the agents after every 10K steps.
Curves show the mean reward achieved (+ 95% CI) across the 80 train tasks.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F9.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="92" id="A2.F9.sf1.g1" src="extracted/5911726/figures/envs/darkroom10x10.png" width="90"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Room 10<math alttext="\times" class="ltx_Math" display="inline" id="A2.F9.sf1.2.m1.1"><semantics id="A2.F9.sf1.2.m1.1b"><mo id="A2.F9.sf1.2.m1.1.1" xref="A2.F9.sf1.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F9.sf1.2.m1.1c"><times id="A2.F9.sf1.2.m1.1.1.cmml" xref="A2.F9.sf1.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.sf1.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F9.sf1.2.m1.1e">×</annotation></semantics></math>10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F9.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="90" id="A2.F9.sf2.g1" src="extracted/5911726/figures/envs/keydoor10x10.png" width="90"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Key-Door 10<math alttext="\times" class="ltx_Math" display="inline" id="A2.F9.sf2.2.m1.1"><semantics id="A2.F9.sf2.2.m1.1b"><mo id="A2.F9.sf2.2.m1.1.1" xref="A2.F9.sf2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F9.sf2.2.m1.1c"><times id="A2.F9.sf2.2.m1.1.1.cmml" xref="A2.F9.sf2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.sf2.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F9.sf2.2.m1.1e">×</annotation></semantics></math>10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F9.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="90" id="A2.F9.sf3.g1" src="extracted/5911726/figures/envs/darkroom20x20.png" width="90"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Room 20<math alttext="\times" class="ltx_Math" display="inline" id="A2.F9.sf3.2.m1.1"><semantics id="A2.F9.sf3.2.m1.1b"><mo id="A2.F9.sf3.2.m1.1.1" xref="A2.F9.sf3.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F9.sf3.2.m1.1c"><times id="A2.F9.sf3.2.m1.1.1.cmml" xref="A2.F9.sf3.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.sf3.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F9.sf3.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F9.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="151" id="A2.F9.sf4.g1" src="extracted/5911726/figures/envs/darkroom40x20.png" width="299"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Room 40<math alttext="\times" class="ltx_Math" display="inline" id="A2.F9.sf4.2.m1.1"><semantics id="A2.F9.sf4.2.m1.1b"><mo id="A2.F9.sf4.2.m1.1.1" xref="A2.F9.sf4.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F9.sf4.2.m1.1c"><times id="A2.F9.sf4.2.m1.1.1.cmml" xref="A2.F9.sf4.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.sf4.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F9.sf4.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Mini-grid environments. In <span class="ltx_text ltx_font_bold" id="A2.F9.12.1">Dark-Room</span>, the agent is located in a room and has to navigate to an invisible goal location. We use grid-sizes <span class="ltx_text ltx_font_bold" id="A2.F9.13.2">(a)</span> 10<math alttext="\times" class="ltx_Math" display="inline" id="A2.F9.4.m1.1"><semantics id="A2.F9.4.m1.1b"><mo id="A2.F9.4.m1.1.1" xref="A2.F9.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F9.4.m1.1c"><times id="A2.F9.4.m1.1.1.cmml" xref="A2.F9.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.4.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F9.4.m1.1e">×</annotation></semantics></math>10, <span class="ltx_text ltx_font_bold" id="A2.F9.14.3">(b)</span> 20<math alttext="\times" class="ltx_Math" display="inline" id="A2.F9.5.m2.1"><semantics id="A2.F9.5.m2.1b"><mo id="A2.F9.5.m2.1.1" xref="A2.F9.5.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F9.5.m2.1c"><times id="A2.F9.5.m2.1.1.cmml" xref="A2.F9.5.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.5.m2.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F9.5.m2.1e">×</annotation></semantics></math>20 and <span class="ltx_text ltx_font_bold" id="A2.F9.15.4">(c)</span> 40<math alttext="\times" class="ltx_Math" display="inline" id="A2.F9.6.m3.1"><semantics id="A2.F9.6.m3.1b"><mo id="A2.F9.6.m3.1.1" xref="A2.F9.6.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F9.6.m3.1c"><times id="A2.F9.6.m3.1.1.cmml" xref="A2.F9.6.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F9.6.m3.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F9.6.m3.1e">×</annotation></semantics></math>20 for our experiments. In <span class="ltx_text ltx_font_bold" id="A2.F9.16.5">(b) Dark-KeyDoor</span>, the agent has to pick up an invisible key, then navigate to the invisible goal location. Agents only observe their current x-y coordinate on the grid. Reward of +1 is obtained in every step the agent is situated in the goal state, +1 for picking up the key.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>MazeRunner</h3>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">MazeRunner was introduced by <cite class="ltx_cite ltx_citemacro_citep">[Grigsby et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib25" title="">2023</a>]</cite> and inspired by the Memory Maze environment <cite class="ltx_cite ltx_citemacro_citep">[Pasukonis et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib64" title="">2022</a>]</cite>.
The agent is located in a 15<math alttext="\times" class="ltx_Math" display="inline" id="A2.SS2.p1.1.m1.1"><semantics id="A2.SS2.p1.1.m1.1a"><mo id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><times id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.1.m1.1d">×</annotation></semantics></math>15 procedurally-generated maze and has to navigate to a sequence of one, two, or three goal locations in the right order (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F10" title="Figure 10 ‣ B.2 MazeRunner ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">10</span></a>).
Similar to Dark-Room environments, MazeRunner is partially observable and exhibits sparse rewards.
The agent observes a Lidar-like 6-dimensional representation of the state that contains 4 continuous values that measure the distance from the agent’s location to the nearest wall, and the x-y coordinates of the agent’s position in the grid.
The action-space is 4-dimensional (up, down, left, right).
A reward of +1 is obtained when reaching the currently active goal state in the goal sequence.
Therefore, the total achievable reward is equal to the number of goal states.
Episodes last for a maximum of 400 steps or terminate early, if all goal locations have been reached.
After every episode, the agent (gray box in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F10" title="Figure 10 ‣ B.2 MazeRunner ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">10</span></a>) is reset to the origin location.
During evaluation, we allow for 30 ICL trials, which amounts to 12K environment steps in total.</p>
</div>
<figure class="ltx_figure" id="A2.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F10.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="149" id="A2.F10.sf1.g1" src="extracted/5911726/figures/envs/mazerunner3.png" width="150"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>One goal</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F10.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="151" id="A2.F10.sf2.g1" src="extracted/5911726/figures/envs/mazerunner4.png" width="150"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Two goals</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F10.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="151" id="A2.F10.sf3.g1" src="extracted/5911726/figures/envs/mazerunner1.png" width="150"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Three goals</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Maze-Runner environments introduced by <cite class="ltx_cite ltx_citemacro_citet">Grigsby et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib25" title="">2023</a>]</cite>. In <span class="ltx_text ltx_font_bold" id="A2.F10.7.1">Maze-Runner</span>, the agent is located in a procedurally generated <math alttext="15\times 15" class="ltx_Math" display="inline" id="A2.F10.2.m1.1"><semantics id="A2.F10.2.m1.1b"><mrow id="A2.F10.2.m1.1.1" xref="A2.F10.2.m1.1.1.cmml"><mn id="A2.F10.2.m1.1.1.2" xref="A2.F10.2.m1.1.1.2.cmml">15</mn><mo id="A2.F10.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.F10.2.m1.1.1.1.cmml">×</mo><mn id="A2.F10.2.m1.1.1.3" xref="A2.F10.2.m1.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F10.2.m1.1c"><apply id="A2.F10.2.m1.1.1.cmml" xref="A2.F10.2.m1.1.1"><times id="A2.F10.2.m1.1.1.1.cmml" xref="A2.F10.2.m1.1.1.1"></times><cn id="A2.F10.2.m1.1.1.2.cmml" type="integer" xref="A2.F10.2.m1.1.1.2">15</cn><cn id="A2.F10.2.m1.1.1.3.cmml" type="integer" xref="A2.F10.2.m1.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F10.2.m1.1d">15\times 15</annotation><annotation encoding="application/x-llamapun" id="A2.F10.2.m1.1e">15 × 15</annotation></semantics></math> maze and has to navigate to <span class="ltx_text ltx_font_bold" id="A2.F10.8.2">(a)</span> one, <span class="ltx_text ltx_font_bold" id="A2.F10.9.3">(b)</span> two or <span class="ltx_text ltx_font_bold" id="A2.F10.10.4">(c)</span> goal locations in pre-specified order. The agent receives a reward of +1 for reaching a goal. Episodes last for a maximum of 400 steps, or terminate early if all goal locations have been visited.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS2.p2">
<p class="ltx_p" id="A2.SS2.p2.2"><span class="ltx_text ltx_font_bold" id="A2.SS2.p2.2.1">Training Dataset.</span>
The procedural-generation of the maze and selection of the number of goals is controlled by setting the environment seed.
We use PPO to generate 100K environment interactions for 100 procedurally-generated mazes, and record the entire replay buffer, which amounts to 10M transitions in total.
We found it necessary, to equip the task-specific PPO agents with an LSTM <cite class="ltx_cite ltx_citemacro_citep">[Hochreiter &amp; Schmidhuber, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib30" title="">1997</a>]</cite> policy.
Without the LSTM, agents hardly make progress for some mazes, especially if the maze contains two or three goal locations.
For this reason, we first generate data for more than 100 mazes and select the first 100 seeds, where the average reward at the end of training is <math alttext="&gt;0.25" class="ltx_Math" display="inline" id="A2.SS2.p2.1.m1.1"><semantics id="A2.SS2.p2.1.m1.1a"><mrow id="A2.SS2.p2.1.m1.1.1" xref="A2.SS2.p2.1.m1.1.1.cmml"><mi id="A2.SS2.p2.1.m1.1.1.2" xref="A2.SS2.p2.1.m1.1.1.2.cmml"></mi><mo id="A2.SS2.p2.1.m1.1.1.1" xref="A2.SS2.p2.1.m1.1.1.1.cmml">&gt;</mo><mn id="A2.SS2.p2.1.m1.1.1.3" xref="A2.SS2.p2.1.m1.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.1.m1.1b"><apply id="A2.SS2.p2.1.m1.1.1.cmml" xref="A2.SS2.p2.1.m1.1.1"><gt id="A2.SS2.p2.1.m1.1.1.1.cmml" xref="A2.SS2.p2.1.m1.1.1.1"></gt><csymbol cd="latexml" id="A2.SS2.p2.1.m1.1.1.2.cmml" xref="A2.SS2.p2.1.m1.1.1.2">absent</csymbol><cn id="A2.SS2.p2.1.m1.1.1.3.cmml" type="float" xref="A2.SS2.p2.1.m1.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.1.m1.1c">&gt;0.25</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p2.1.m1.1d">&gt; 0.25</annotation></semantics></math>.
This results in a set of seeds in <math alttext="[0,120]" class="ltx_Math" display="inline" id="A2.SS2.p2.2.m2.2"><semantics id="A2.SS2.p2.2.m2.2a"><mrow id="A2.SS2.p2.2.m2.2.3.2" xref="A2.SS2.p2.2.m2.2.3.1.cmml"><mo id="A2.SS2.p2.2.m2.2.3.2.1" stretchy="false" xref="A2.SS2.p2.2.m2.2.3.1.cmml">[</mo><mn id="A2.SS2.p2.2.m2.1.1" xref="A2.SS2.p2.2.m2.1.1.cmml">0</mn><mo id="A2.SS2.p2.2.m2.2.3.2.2" xref="A2.SS2.p2.2.m2.2.3.1.cmml">,</mo><mn id="A2.SS2.p2.2.m2.2.2" xref="A2.SS2.p2.2.m2.2.2.cmml">120</mn><mo id="A2.SS2.p2.2.m2.2.3.2.3" stretchy="false" xref="A2.SS2.p2.2.m2.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.2.m2.2b"><interval closure="closed" id="A2.SS2.p2.2.m2.2.3.1.cmml" xref="A2.SS2.p2.2.m2.2.3.2"><cn id="A2.SS2.p2.2.m2.1.1.cmml" type="integer" xref="A2.SS2.p2.2.m2.1.1">0</cn><cn id="A2.SS2.p2.2.m2.2.2.cmml" type="integer" xref="A2.SS2.p2.2.m2.2.2">120</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.2.m2.2c">[0,120]</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p2.2.m2.2d">[ 0 , 120 ]</annotation></semantics></math>
Otherwise, we use standard hyperparameter settings as provided in <span class="ltx_text ltx_font_typewriter" id="A2.SS2.p2.2.2">stable-baselines3</span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS2.p3">
<p class="ltx_p" id="A2.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="A2.SS2.p3.1.1">Source Algorithm performance.</span>
We show the average learning curves over all 100 task-specific PPO agents in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F11" title="Figure 11 ‣ B.2 MazeRunner ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">11</span></a>.
On average, the agents receive a reward of <math alttext="\approx 1" class="ltx_Math" display="inline" id="A2.SS2.p3.1.m1.1"><semantics id="A2.SS2.p3.1.m1.1a"><mrow id="A2.SS2.p3.1.m1.1.1" xref="A2.SS2.p3.1.m1.1.1.cmml"><mi id="A2.SS2.p3.1.m1.1.1.2" xref="A2.SS2.p3.1.m1.1.1.2.cmml"></mi><mo id="A2.SS2.p3.1.m1.1.1.1" xref="A2.SS2.p3.1.m1.1.1.1.cmml">≈</mo><mn id="A2.SS2.p3.1.m1.1.1.3" xref="A2.SS2.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.1.m1.1b"><apply id="A2.SS2.p3.1.m1.1.1.cmml" xref="A2.SS2.p3.1.m1.1.1"><approx id="A2.SS2.p3.1.m1.1.1.1.cmml" xref="A2.SS2.p3.1.m1.1.1.1"></approx><csymbol cd="latexml" id="A2.SS2.p3.1.m1.1.1.2.cmml" xref="A2.SS2.p3.1.m1.1.1.2">absent</csymbol><cn id="A2.SS2.p3.1.m1.1.1.3.cmml" type="integer" xref="A2.SS2.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.1.m1.1c">\approx 1</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p3.1.m1.1d">≈ 1</annotation></semantics></math> over all mazes.
This average include environments with one, two or three goals.
We provide further dataset statistics for MazeRunner with the corresponding dataset release.</p>
</div>
<figure class="ltx_figure" id="A2.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="160" id="A2.F11.g1" src="extracted/5911726/figures/mazerunner/datagen.png" width="210"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Learning curves for data-collection runs on all 100 mazes on Maze-Runner 15<math alttext="\times" class="ltx_Math" display="inline" id="A2.F11.2.m1.1"><semantics id="A2.F11.2.m1.1b"><mo id="A2.F11.2.m1.1.1" xref="A2.F11.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F11.2.m1.1c"><times id="A2.F11.2.m1.1.1.cmml" xref="A2.F11.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F11.2.m1.1e">×</annotation></semantics></math>15 environments with PPO-LSTM as source algorithm. We train for 100K environment steps on each maze and report the mean reward achieved (+ 95% CI).</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Meta-World</h3>
<div class="ltx_para ltx_noindent" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">The Meta-World benchmark <cite class="ltx_cite ltx_citemacro_citep">[Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib103" title="">2020a</a>]</cite> consists of 50 challenging robotics tasks, such as opening/closing a window, using a hammer, or pressing buttons.
All tasks in Meta-World use a Sawyer robotic arm simulated using the MuJoCo physics engine <cite class="ltx_cite ltx_citemacro_citep">[Todorov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib90" title="">2012</a>]</cite>.
The observations and actions are 39-dimensional and 6-dimensional continuous vectors, respectively.
As all tasks share the robotic arm, the state, and action spaces remain constant across tasks.
All actions are in range <math alttext="[-1,1]" class="ltx_Math" display="inline" id="A2.SS3.p1.1.m1.2"><semantics id="A2.SS3.p1.1.m1.2a"><mrow id="A2.SS3.p1.1.m1.2.2.1" xref="A2.SS3.p1.1.m1.2.2.2.cmml"><mo id="A2.SS3.p1.1.m1.2.2.1.2" stretchy="false" xref="A2.SS3.p1.1.m1.2.2.2.cmml">[</mo><mrow id="A2.SS3.p1.1.m1.2.2.1.1" xref="A2.SS3.p1.1.m1.2.2.1.1.cmml"><mo id="A2.SS3.p1.1.m1.2.2.1.1a" xref="A2.SS3.p1.1.m1.2.2.1.1.cmml">−</mo><mn id="A2.SS3.p1.1.m1.2.2.1.1.2" xref="A2.SS3.p1.1.m1.2.2.1.1.2.cmml">1</mn></mrow><mo id="A2.SS3.p1.1.m1.2.2.1.3" xref="A2.SS3.p1.1.m1.2.2.2.cmml">,</mo><mn id="A2.SS3.p1.1.m1.1.1" xref="A2.SS3.p1.1.m1.1.1.cmml">1</mn><mo id="A2.SS3.p1.1.m1.2.2.1.4" stretchy="false" xref="A2.SS3.p1.1.m1.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.1.m1.2b"><interval closure="closed" id="A2.SS3.p1.1.m1.2.2.2.cmml" xref="A2.SS3.p1.1.m1.2.2.1"><apply id="A2.SS3.p1.1.m1.2.2.1.1.cmml" xref="A2.SS3.p1.1.m1.2.2.1.1"><minus id="A2.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="A2.SS3.p1.1.m1.2.2.1.1"></minus><cn id="A2.SS3.p1.1.m1.2.2.1.1.2.cmml" type="integer" xref="A2.SS3.p1.1.m1.2.2.1.1.2">1</cn></apply><cn id="A2.SS3.p1.1.m1.1.1.cmml" type="integer" xref="A2.SS3.p1.1.m1.1.1">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.1.m1.2c">[-1,1]</annotation><annotation encoding="application/x-llamapun" id="A2.SS3.p1.1.m1.2d">[ - 1 , 1 ]</annotation></semantics></math>.
The reward functions are dense and based on distances to the goal locations (exact reward-definitions are provided in <cite class="ltx_cite ltx_citemacro_citet">Yu et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib103" title="">2020a</a>]</cite>).
Similar to <cite class="ltx_cite ltx_citemacro_citet">Wolczyk et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib97" title="">2021</a>]</cite> and <cite class="ltx_cite ltx_citemacro_citet">Schmied et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib81" title="">2023</a>]</cite>, we limit the episode lengths to 200 interactions.
We follow <cite class="ltx_cite ltx_citemacro_citet">Yu et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib103" title="">2020a</a>]</cite> and split the 50 Meta-World tasks into 45 training tasks (ML45) and 5 evaluation tasks (ML5).
During evaluation, we use deterministic environment resets after episodes, i.e., objects and goal positions are reset to their original state.
Furthermore, we mask-out the goal positions in the state vector, which forces agents to adapt during environment interaction.
Agents are given 30 ICL trials during evaluation.
The 5 evaluation tasks are:</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS3.p2">
<p class="ltx_p" id="A2.SS3.p2.1"><span class="ltx_text ltx_font_typewriter" id="A2.SS3.p2.1.1">bin-picking</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS3.p2.1.2">box-close</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS3.p2.1.3">door-lock</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS3.p2.1.4">door-unlock</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS3.p2.1.5">hand-insert</span></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS3.p3">
<p class="ltx_p" id="A2.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="A2.SS3.p3.1.1">Training Dataset</span>.
For our Meta-World experiments, we leverage the datasets released by <cite class="ltx_cite ltx_citemacro_citet">Schmied et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib81" title="">2023</a>]</cite>.
The datasets contain 2M transitions per task, which amounts to 90M transitions across all ML45 training tasks.
The data was generated with randomized object and goal positions after every episode.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>DMControl</h3>
<div class="ltx_para ltx_noindent" id="A2.SS4.p1">
<p class="ltx_p" id="A2.SS4.p1.1">DMControl contains 30 different robotic tasks with different robot morphologies <cite class="ltx_cite ltx_citemacro_citep">[Tassa et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib88" title="">2018</a>]</cite>.
Similar to prior work <cite class="ltx_cite ltx_citemacro_citep">[Hafner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib28" title="">2019</a>; Schmied et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib81" title="">2023</a>]</cite>, we select 16 of these 30 tasks and split them into 11 training (DMC11) and 5 evaluation tasks (DMC5).
The DMC11 training tasks are:</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS4.p2">
<p class="ltx_p" id="A2.SS4.p2.1"><span class="ltx_text ltx_font_typewriter" id="A2.SS4.p2.1.1">finger-turn_easy</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS4.p2.1.2">fish-upright</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS4.p2.1.3">hopper-stand</span>,
<span class="ltx_text ltx_font_typewriter" id="A2.SS4.p2.1.4">point_mass-easy</span>,<span class="ltx_text ltx_font_typewriter" id="A2.SS4.p2.1.5"> walker-stand</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS4.p2.1.6">walker-run</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS4.p2.1.7">ball_in_cup-catch</span>,
<span class="ltx_text ltx_font_typewriter" id="A2.SS4.p2.1.8">cartpole-swingup</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS4.p2.1.9">cheetah-run</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS4.p2.1.10">finger-spin</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS4.p2.1.11">reacher-easy</span></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS4.p3">
<p class="ltx_p" id="A2.SS4.p3.1">The DMC5 evaluation tasks are:</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS4.p4">
<p class="ltx_p" id="A2.SS4.p4.1"><span class="ltx_text ltx_font_typewriter" id="A2.SS4.p4.1.1">cartpole-balance</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS4.p4.1.2">finger-turn_hard</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS4.p4.1.3">pendulum-swingup</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS4.p4.1.4">reacher-hard</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS4.p4.1.5">walker-walk</span></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS4.p5">
<p class="ltx_p" id="A2.SS4.p5.3">States and actions in DMControl are continuous vectors.
As DMControl contains different robot morphologies, the state, and action spaces vary considerably across tasks (<math alttext="3\leq|\mathcal{S}|\leq 24" class="ltx_Math" display="inline" id="A2.SS4.p5.1.m1.1"><semantics id="A2.SS4.p5.1.m1.1a"><mrow id="A2.SS4.p5.1.m1.1.2" xref="A2.SS4.p5.1.m1.1.2.cmml"><mn id="A2.SS4.p5.1.m1.1.2.2" xref="A2.SS4.p5.1.m1.1.2.2.cmml">3</mn><mo id="A2.SS4.p5.1.m1.1.2.3" xref="A2.SS4.p5.1.m1.1.2.3.cmml">≤</mo><mrow id="A2.SS4.p5.1.m1.1.2.4.2" xref="A2.SS4.p5.1.m1.1.2.4.1.cmml"><mo id="A2.SS4.p5.1.m1.1.2.4.2.1" stretchy="false" xref="A2.SS4.p5.1.m1.1.2.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A2.SS4.p5.1.m1.1.1" xref="A2.SS4.p5.1.m1.1.1.cmml">𝒮</mi><mo id="A2.SS4.p5.1.m1.1.2.4.2.2" stretchy="false" xref="A2.SS4.p5.1.m1.1.2.4.1.1.cmml">|</mo></mrow><mo id="A2.SS4.p5.1.m1.1.2.5" xref="A2.SS4.p5.1.m1.1.2.5.cmml">≤</mo><mn id="A2.SS4.p5.1.m1.1.2.6" xref="A2.SS4.p5.1.m1.1.2.6.cmml">24</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS4.p5.1.m1.1b"><apply id="A2.SS4.p5.1.m1.1.2.cmml" xref="A2.SS4.p5.1.m1.1.2"><and id="A2.SS4.p5.1.m1.1.2a.cmml" xref="A2.SS4.p5.1.m1.1.2"></and><apply id="A2.SS4.p5.1.m1.1.2b.cmml" xref="A2.SS4.p5.1.m1.1.2"><leq id="A2.SS4.p5.1.m1.1.2.3.cmml" xref="A2.SS4.p5.1.m1.1.2.3"></leq><cn id="A2.SS4.p5.1.m1.1.2.2.cmml" type="integer" xref="A2.SS4.p5.1.m1.1.2.2">3</cn><apply id="A2.SS4.p5.1.m1.1.2.4.1.cmml" xref="A2.SS4.p5.1.m1.1.2.4.2"><abs id="A2.SS4.p5.1.m1.1.2.4.1.1.cmml" xref="A2.SS4.p5.1.m1.1.2.4.2.1"></abs><ci id="A2.SS4.p5.1.m1.1.1.cmml" xref="A2.SS4.p5.1.m1.1.1">𝒮</ci></apply></apply><apply id="A2.SS4.p5.1.m1.1.2c.cmml" xref="A2.SS4.p5.1.m1.1.2"><leq id="A2.SS4.p5.1.m1.1.2.5.cmml" xref="A2.SS4.p5.1.m1.1.2.5"></leq><share href="https://arxiv.org/html/2410.07071v1#A2.SS4.p5.1.m1.1.2.4.cmml" id="A2.SS4.p5.1.m1.1.2d.cmml" xref="A2.SS4.p5.1.m1.1.2"></share><cn id="A2.SS4.p5.1.m1.1.2.6.cmml" type="integer" xref="A2.SS4.p5.1.m1.1.2.6">24</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS4.p5.1.m1.1c">3\leq|\mathcal{S}|\leq 24</annotation><annotation encoding="application/x-llamapun" id="A2.SS4.p5.1.m1.1d">3 ≤ | caligraphic_S | ≤ 24</annotation></semantics></math>, <math alttext="1\leq|\mathcal{A}|\leq 6" class="ltx_Math" display="inline" id="A2.SS4.p5.2.m2.1"><semantics id="A2.SS4.p5.2.m2.1a"><mrow id="A2.SS4.p5.2.m2.1.2" xref="A2.SS4.p5.2.m2.1.2.cmml"><mn id="A2.SS4.p5.2.m2.1.2.2" xref="A2.SS4.p5.2.m2.1.2.2.cmml">1</mn><mo id="A2.SS4.p5.2.m2.1.2.3" xref="A2.SS4.p5.2.m2.1.2.3.cmml">≤</mo><mrow id="A2.SS4.p5.2.m2.1.2.4.2" xref="A2.SS4.p5.2.m2.1.2.4.1.cmml"><mo id="A2.SS4.p5.2.m2.1.2.4.2.1" stretchy="false" xref="A2.SS4.p5.2.m2.1.2.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A2.SS4.p5.2.m2.1.1" xref="A2.SS4.p5.2.m2.1.1.cmml">𝒜</mi><mo id="A2.SS4.p5.2.m2.1.2.4.2.2" stretchy="false" xref="A2.SS4.p5.2.m2.1.2.4.1.1.cmml">|</mo></mrow><mo id="A2.SS4.p5.2.m2.1.2.5" xref="A2.SS4.p5.2.m2.1.2.5.cmml">≤</mo><mn id="A2.SS4.p5.2.m2.1.2.6" xref="A2.SS4.p5.2.m2.1.2.6.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS4.p5.2.m2.1b"><apply id="A2.SS4.p5.2.m2.1.2.cmml" xref="A2.SS4.p5.2.m2.1.2"><and id="A2.SS4.p5.2.m2.1.2a.cmml" xref="A2.SS4.p5.2.m2.1.2"></and><apply id="A2.SS4.p5.2.m2.1.2b.cmml" xref="A2.SS4.p5.2.m2.1.2"><leq id="A2.SS4.p5.2.m2.1.2.3.cmml" xref="A2.SS4.p5.2.m2.1.2.3"></leq><cn id="A2.SS4.p5.2.m2.1.2.2.cmml" type="integer" xref="A2.SS4.p5.2.m2.1.2.2">1</cn><apply id="A2.SS4.p5.2.m2.1.2.4.1.cmml" xref="A2.SS4.p5.2.m2.1.2.4.2"><abs id="A2.SS4.p5.2.m2.1.2.4.1.1.cmml" xref="A2.SS4.p5.2.m2.1.2.4.2.1"></abs><ci id="A2.SS4.p5.2.m2.1.1.cmml" xref="A2.SS4.p5.2.m2.1.1">𝒜</ci></apply></apply><apply id="A2.SS4.p5.2.m2.1.2c.cmml" xref="A2.SS4.p5.2.m2.1.2"><leq id="A2.SS4.p5.2.m2.1.2.5.cmml" xref="A2.SS4.p5.2.m2.1.2.5"></leq><share href="https://arxiv.org/html/2410.07071v1#A2.SS4.p5.2.m2.1.2.4.cmml" id="A2.SS4.p5.2.m2.1.2d.cmml" xref="A2.SS4.p5.2.m2.1.2"></share><cn id="A2.SS4.p5.2.m2.1.2.6.cmml" type="integer" xref="A2.SS4.p5.2.m2.1.2.6">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS4.p5.2.m2.1c">1\leq|\mathcal{A}|\leq 6</annotation><annotation encoding="application/x-llamapun" id="A2.SS4.p5.2.m2.1d">1 ≤ | caligraphic_A | ≤ 6</annotation></semantics></math>).
All actions in DMControl are bounded by <math alttext="[-1,1]" class="ltx_Math" display="inline" id="A2.SS4.p5.3.m3.2"><semantics id="A2.SS4.p5.3.m3.2a"><mrow id="A2.SS4.p5.3.m3.2.2.1" xref="A2.SS4.p5.3.m3.2.2.2.cmml"><mo id="A2.SS4.p5.3.m3.2.2.1.2" stretchy="false" xref="A2.SS4.p5.3.m3.2.2.2.cmml">[</mo><mrow id="A2.SS4.p5.3.m3.2.2.1.1" xref="A2.SS4.p5.3.m3.2.2.1.1.cmml"><mo id="A2.SS4.p5.3.m3.2.2.1.1a" xref="A2.SS4.p5.3.m3.2.2.1.1.cmml">−</mo><mn id="A2.SS4.p5.3.m3.2.2.1.1.2" xref="A2.SS4.p5.3.m3.2.2.1.1.2.cmml">1</mn></mrow><mo id="A2.SS4.p5.3.m3.2.2.1.3" xref="A2.SS4.p5.3.m3.2.2.2.cmml">,</mo><mn id="A2.SS4.p5.3.m3.1.1" xref="A2.SS4.p5.3.m3.1.1.cmml">1</mn><mo id="A2.SS4.p5.3.m3.2.2.1.4" stretchy="false" xref="A2.SS4.p5.3.m3.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS4.p5.3.m3.2b"><interval closure="closed" id="A2.SS4.p5.3.m3.2.2.2.cmml" xref="A2.SS4.p5.3.m3.2.2.1"><apply id="A2.SS4.p5.3.m3.2.2.1.1.cmml" xref="A2.SS4.p5.3.m3.2.2.1.1"><minus id="A2.SS4.p5.3.m3.2.2.1.1.1.cmml" xref="A2.SS4.p5.3.m3.2.2.1.1"></minus><cn id="A2.SS4.p5.3.m3.2.2.1.1.2.cmml" type="integer" xref="A2.SS4.p5.3.m3.2.2.1.1.2">1</cn></apply><cn id="A2.SS4.p5.3.m3.1.1.cmml" type="integer" xref="A2.SS4.p5.3.m3.1.1">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.SS4.p5.3.m3.2c">[-1,1]</annotation><annotation encoding="application/x-llamapun" id="A2.SS4.p5.3.m3.2d">[ - 1 , 1 ]</annotation></semantics></math>.
Episodes last for 1000 environment steps and per time-step a maximum reward of +1 can be achieved, which results in a maximum reward of 1000 per episode.
Agents are given 30 ICL trials per task during evaluation, which results in 30K steps for a single evaluation run.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS4.p6">
<p class="ltx_p" id="A2.SS4.p6.1"><span class="ltx_text ltx_font_bold" id="A2.SS4.p6.1.1">Training Dataset</span>.
As for Meta-World, we leverage the datasets released by <cite class="ltx_cite ltx_citemacro_citet">Schmied et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib81" title="">2023</a>]</cite>.
The datasets contain 1M transitions per task, which amounts to 11M transitions used for training across all DMC11 tasks. We refer to <cite class="ltx_cite ltx_citemacro_citet">Schmied et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib81" title="">2023</a>]</cite> for further dataset statistics on DMControl and Meta-World.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.5 </span>Procgen</h3>
<div class="ltx_para ltx_noindent" id="A2.SS5.p1">
<p class="ltx_p" id="A2.SS5.p1.1">The Procgen benchmark consists of 16 procedurally-generated video games and was designed to test the generalization abilities of RL agents <cite class="ltx_cite ltx_citemacro_citep">[Cobbe et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib14" title="">2020</a>]</cite>.
Unlike other environments considered in this work, Procgen environments emits <math alttext="3\times 64\times 64" class="ltx_Math" display="inline" id="A2.SS5.p1.1.m1.1"><semantics id="A2.SS5.p1.1.m1.1a"><mrow id="A2.SS5.p1.1.m1.1.1" xref="A2.SS5.p1.1.m1.1.1.cmml"><mn id="A2.SS5.p1.1.m1.1.1.2" xref="A2.SS5.p1.1.m1.1.1.2.cmml">3</mn><mo id="A2.SS5.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.SS5.p1.1.m1.1.1.1.cmml">×</mo><mn id="A2.SS5.p1.1.m1.1.1.3" xref="A2.SS5.p1.1.m1.1.1.3.cmml">64</mn><mo id="A2.SS5.p1.1.m1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="A2.SS5.p1.1.m1.1.1.1.cmml">×</mo><mn id="A2.SS5.p1.1.m1.1.1.4" xref="A2.SS5.p1.1.m1.1.1.4.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS5.p1.1.m1.1b"><apply id="A2.SS5.p1.1.m1.1.1.cmml" xref="A2.SS5.p1.1.m1.1.1"><times id="A2.SS5.p1.1.m1.1.1.1.cmml" xref="A2.SS5.p1.1.m1.1.1.1"></times><cn id="A2.SS5.p1.1.m1.1.1.2.cmml" type="integer" xref="A2.SS5.p1.1.m1.1.1.2">3</cn><cn id="A2.SS5.p1.1.m1.1.1.3.cmml" type="integer" xref="A2.SS5.p1.1.m1.1.1.3">64</cn><cn id="A2.SS5.p1.1.m1.1.1.4.cmml" type="integer" xref="A2.SS5.p1.1.m1.1.1.4">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS5.p1.1.m1.1c">3\times 64\times 64</annotation><annotation encoding="application/x-llamapun" id="A2.SS5.p1.1.m1.1d">3 × 64 × 64</annotation></semantics></math> images as observations.
All 16 environments share a common action space of 15 discrete actions.
The procedural generation in Procgen is controlled by setting an environment seed.
The environments seed randomizes the background and colour of the environment, but retains the same game dynamics.
This results in visually diverse observations for the same underlying task, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F12" title="Figure 12 ‣ B.5 Procgen ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">12</span></a> for three seeds on the game <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p1.1.1">starpilot</span>.
The rewards in Procgen can be dense or sparse depending on the environment.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS5.p2">
<p class="ltx_p" id="A2.SS5.p2.1">We follow <cite class="ltx_cite ltx_citemacro_citet">Raparthy et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib73" title="">2023</a>]</cite> and use 12 tasks for training and 4 tasks for evaluation, which we refer to as PG12 and PG4, respectively.
The PG12 tasks are:</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS5.p3">
<p class="ltx_p" id="A2.SS5.p3.1"><span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.1">bigfish</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.2">bossfight</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.3">caveflyer</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.4">chaser</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.5">coinrun</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.6">dodgeball</span>,
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.7">fruitbot</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.8">heist</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.9">leaper</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.10">maze</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.11">miner</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p3.1.12">starpilot</span></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS5.p4">
<p class="ltx_p" id="A2.SS5.p4.1">The PG4 tasks are: <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p4.1.1">climber</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p4.1.2">ninja</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p4.1.3">plunder</span>, <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p4.1.4">jumper</span></p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS5.p5">
<p class="ltx_p" id="A2.SS5.p5.1">We exploit the procedural generation of Procgen and evaluate all models in three settings: (1) training tasks - seen seed (PG12-Seen), (2) training tasks - unseen seed (PG12-Unseen), and (3) evaluation tasks - unseen seed (PG4).
In particular, the agents observe data from 200 different training seeds.
To enable ICL to the same environment, we always keep the same seed during evaluation (seed=1 for PG12-seen, seed=200 for PG12-Unseen and PG4).
During evaluation, we limit the episode lengths to 400 steps.</p>
</div>
<figure class="ltx_figure" id="A2.F12">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F12.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="148" id="A2.F12.sf1.g1" src="extracted/5911726/figures/envs/procgen-starpilot2.png" width="150"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span><span class="ltx_text ltx_font_typewriter" id="A2.F12.sf1.2.1">starpilot</span>, seed=1</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F12.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="148" id="A2.F12.sf2.g1" src="extracted/5911726/figures/envs/procgen-starpilot1.png" width="150"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text ltx_font_typewriter" id="A2.F12.sf2.2.1">starpilot</span>, seed=2</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F12.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="149" id="A2.F12.sf3.g1" src="extracted/5911726/figures/envs/procgen-starpilot3.png" width="150"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span><span class="ltx_text ltx_font_typewriter" id="A2.F12.sf3.2.1">starpilot</span>, seed=3</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Illustration of procedural generation in Procgen <span class="ltx_text ltx_font_typewriter" id="A2.F12.2.1">starpilot</span>. For different seeds, the same environment looks visually considerably different. We train on multi-task dataset of 12 Procgen tasks, with each dataset containing trajectories from 200 environment seeds. To test for ICL, we evaluate on single hold-out seeds.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A2.SS5.p6">
<p class="ltx_p" id="A2.SS5.p6.3"><span class="ltx_text ltx_font_bold" id="A2.SS5.p6.3.1">Training Dataset.</span>
We generate datasets by training task-specific PPO agents for 25M timesteps on 200 environment seeds per task in <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p6.3.2">easy</span> difficulty, as proposed in by <cite class="ltx_cite ltx_citemacro_citet">Cobbe et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib14" title="">2020</a>]</cite>.
We train PPO using the same hyperparameter settings as <cite class="ltx_cite ltx_citemacro_citet">Cobbe et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib14" title="">2020</a>]</cite>, using a learning rate of <math alttext="5e^{-4}" class="ltx_Math" display="inline" id="A2.SS5.p6.1.m1.1"><semantics id="A2.SS5.p6.1.m1.1a"><mrow id="A2.SS5.p6.1.m1.1.1" xref="A2.SS5.p6.1.m1.1.1.cmml"><mn id="A2.SS5.p6.1.m1.1.1.2" xref="A2.SS5.p6.1.m1.1.1.2.cmml">5</mn><mo id="A2.SS5.p6.1.m1.1.1.1" xref="A2.SS5.p6.1.m1.1.1.1.cmml">⁢</mo><msup id="A2.SS5.p6.1.m1.1.1.3" xref="A2.SS5.p6.1.m1.1.1.3.cmml"><mi id="A2.SS5.p6.1.m1.1.1.3.2" xref="A2.SS5.p6.1.m1.1.1.3.2.cmml">e</mi><mrow id="A2.SS5.p6.1.m1.1.1.3.3" xref="A2.SS5.p6.1.m1.1.1.3.3.cmml"><mo id="A2.SS5.p6.1.m1.1.1.3.3a" xref="A2.SS5.p6.1.m1.1.1.3.3.cmml">−</mo><mn id="A2.SS5.p6.1.m1.1.1.3.3.2" xref="A2.SS5.p6.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS5.p6.1.m1.1b"><apply id="A2.SS5.p6.1.m1.1.1.cmml" xref="A2.SS5.p6.1.m1.1.1"><times id="A2.SS5.p6.1.m1.1.1.1.cmml" xref="A2.SS5.p6.1.m1.1.1.1"></times><cn id="A2.SS5.p6.1.m1.1.1.2.cmml" type="integer" xref="A2.SS5.p6.1.m1.1.1.2">5</cn><apply id="A2.SS5.p6.1.m1.1.1.3.cmml" xref="A2.SS5.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.SS5.p6.1.m1.1.1.3.1.cmml" xref="A2.SS5.p6.1.m1.1.1.3">superscript</csymbol><ci id="A2.SS5.p6.1.m1.1.1.3.2.cmml" xref="A2.SS5.p6.1.m1.1.1.3.2">𝑒</ci><apply id="A2.SS5.p6.1.m1.1.1.3.3.cmml" xref="A2.SS5.p6.1.m1.1.1.3.3"><minus id="A2.SS5.p6.1.m1.1.1.3.3.1.cmml" xref="A2.SS5.p6.1.m1.1.1.3.3"></minus><cn id="A2.SS5.p6.1.m1.1.1.3.3.2.cmml" type="integer" xref="A2.SS5.p6.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS5.p6.1.m1.1c">5e^{-4}</annotation><annotation encoding="application/x-llamapun" id="A2.SS5.p6.1.m1.1d">5 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>, batch size 2048, number of update epochs of 3, entropy coefficient of <math alttext="0.01" class="ltx_Math" display="inline" id="A2.SS5.p6.2.m2.1"><semantics id="A2.SS5.p6.2.m2.1a"><mn id="A2.SS5.p6.2.m2.1.1" xref="A2.SS5.p6.2.m2.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="A2.SS5.p6.2.m2.1b"><cn id="A2.SS5.p6.2.m2.1.1.cmml" type="float" xref="A2.SS5.p6.2.m2.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS5.p6.2.m2.1c">0.01</annotation><annotation encoding="application/x-llamapun" id="A2.SS5.p6.2.m2.1d">0.01</annotation></semantics></math>, GAE <math alttext="\lambda=0.95" class="ltx_Math" display="inline" id="A2.SS5.p6.3.m3.1"><semantics id="A2.SS5.p6.3.m3.1a"><mrow id="A2.SS5.p6.3.m3.1.1" xref="A2.SS5.p6.3.m3.1.1.cmml"><mi id="A2.SS5.p6.3.m3.1.1.2" xref="A2.SS5.p6.3.m3.1.1.2.cmml">λ</mi><mo id="A2.SS5.p6.3.m3.1.1.1" xref="A2.SS5.p6.3.m3.1.1.1.cmml">=</mo><mn id="A2.SS5.p6.3.m3.1.1.3" xref="A2.SS5.p6.3.m3.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS5.p6.3.m3.1b"><apply id="A2.SS5.p6.3.m3.1.1.cmml" xref="A2.SS5.p6.3.m3.1.1"><eq id="A2.SS5.p6.3.m3.1.1.1.cmml" xref="A2.SS5.p6.3.m3.1.1.1"></eq><ci id="A2.SS5.p6.3.m3.1.1.2.cmml" xref="A2.SS5.p6.3.m3.1.1.2">𝜆</ci><cn id="A2.SS5.p6.3.m3.1.1.3.cmml" type="float" xref="A2.SS5.p6.3.m3.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS5.p6.3.m3.1c">\lambda=0.95</annotation><annotation encoding="application/x-llamapun" id="A2.SS5.p6.3.m3.1d">italic_λ = 0.95</annotation></semantics></math>, and with reward normalization.
We use 256 timesteps per rollout over 64 parallel environments, which results in 16384 environment steps per rollout in total.
Furthermore, we found it useful to decrease the discount factor to 0.99.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS5.p7">
<p class="ltx_p" id="A2.SS5.p7.1">As in previous experiments, we record the entire replay buffer and consequently, the datasets contain mixed-quality behaviour.
We subsample the 25M transitions per task, by storing only the observations of the first 5 parallel environments, which results in approximately 2M transitions per task.
To ensure disk-space efficiency, all trajectories are stored in separate <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p7.1.1">hdf5</span> files in the lowest compression level files, with all image-observations encoded in <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p7.1.2">unit8</span>.
Consequently, the datasets for all 16 tasks (32M transitions) take up only 70GB of disk space, and their <span class="ltx_text ltx_font_typewriter" id="A2.SS5.p7.1.3">hdf5</span> format enables targeted reading from disk, without loading an entire trajectory into RAM.
We release two versions of our datasets: a smaller one containing 2M transitions per task as used in our experiments, and a larger one containing 20M transitions per task.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS5.p8">
<p class="ltx_p" id="A2.SS5.p8.1"><span class="ltx_text ltx_font_bold" id="A2.SS5.p8.1.1">Source Algorithm performance.</span>
We show the individual learning curves for all tasks in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.F13" title="Figure 13 ‣ B.5 Procgen ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">13</span></a>, and the aggregate statistics over all 16 datasets in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A2.T1" title="Table 1 ‣ B.5 Procgen ‣ Appendix B Environments &amp; Datasets ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="A2.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Dataset Statistics for all 16 Procgen tasks.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T1.32">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T1.32.33.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T1.32.33.1.1"><span class="ltx_text ltx_font_bold" id="A2.T1.32.33.1.1.1">Task</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T1.32.33.1.2"><span class="ltx_text ltx_font_bold" id="A2.T1.32.33.1.2.1"># of Trajectories</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T1.32.33.1.3"><span class="ltx_text ltx_font_bold" id="A2.T1.32.33.1.3.1">Mean Length</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T1.32.33.1.4"><span class="ltx_text ltx_font_bold" id="A2.T1.32.33.1.4.1">Mean Return</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T1.2.2.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.2.2.3.1">bigfish</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T1.2.2.4">8834</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T1.1.1.1"><math alttext="221\pm 184" class="ltx_Math" display="inline" id="A2.T1.1.1.1.m1.1"><semantics id="A2.T1.1.1.1.m1.1a"><mrow id="A2.T1.1.1.1.m1.1.1" xref="A2.T1.1.1.1.m1.1.1.cmml"><mn id="A2.T1.1.1.1.m1.1.1.2" xref="A2.T1.1.1.1.m1.1.1.2.cmml">221</mn><mo id="A2.T1.1.1.1.m1.1.1.1" xref="A2.T1.1.1.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.1.1.1.m1.1.1.3" xref="A2.T1.1.1.1.m1.1.1.3.cmml">184</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.1.1.1.m1.1b"><apply id="A2.T1.1.1.1.m1.1.1.cmml" xref="A2.T1.1.1.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.1.1.1.m1.1.1.1.cmml" xref="A2.T1.1.1.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.1.1.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.1.1.1.m1.1.1.2">221</cn><cn id="A2.T1.1.1.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.1.1.1.m1.1.1.3">184</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.1.1.1.m1.1c">221\pm 184</annotation><annotation encoding="application/x-llamapun" id="A2.T1.1.1.1.m1.1d">221 ± 184</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T1.2.2.2"><math alttext="5.9\pm 9.1" class="ltx_Math" display="inline" id="A2.T1.2.2.2.m1.1"><semantics id="A2.T1.2.2.2.m1.1a"><mrow id="A2.T1.2.2.2.m1.1.1" xref="A2.T1.2.2.2.m1.1.1.cmml"><mn id="A2.T1.2.2.2.m1.1.1.2" xref="A2.T1.2.2.2.m1.1.1.2.cmml">5.9</mn><mo id="A2.T1.2.2.2.m1.1.1.1" xref="A2.T1.2.2.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.2.2.2.m1.1.1.3" xref="A2.T1.2.2.2.m1.1.1.3.cmml">9.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.2.2.2.m1.1b"><apply id="A2.T1.2.2.2.m1.1.1.cmml" xref="A2.T1.2.2.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.2.2.2.m1.1.1.1.cmml" xref="A2.T1.2.2.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.2.2.2.m1.1.1.2.cmml" type="float" xref="A2.T1.2.2.2.m1.1.1.2">5.9</cn><cn id="A2.T1.2.2.2.m1.1.1.3.cmml" type="float" xref="A2.T1.2.2.2.m1.1.1.3">9.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.2.2.2.m1.1c">5.9\pm 9.1</annotation><annotation encoding="application/x-llamapun" id="A2.T1.2.2.2.m1.1d">5.9 ± 9.1</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.4.4.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.4.4.3.1">bossfight</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.4.4.4">12103</td>
<td class="ltx_td ltx_align_center" id="A2.T1.3.3.1"><math alttext="161\pm 200" class="ltx_Math" display="inline" id="A2.T1.3.3.1.m1.1"><semantics id="A2.T1.3.3.1.m1.1a"><mrow id="A2.T1.3.3.1.m1.1.1" xref="A2.T1.3.3.1.m1.1.1.cmml"><mn id="A2.T1.3.3.1.m1.1.1.2" xref="A2.T1.3.3.1.m1.1.1.2.cmml">161</mn><mo id="A2.T1.3.3.1.m1.1.1.1" xref="A2.T1.3.3.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.3.3.1.m1.1.1.3" xref="A2.T1.3.3.1.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.3.3.1.m1.1b"><apply id="A2.T1.3.3.1.m1.1.1.cmml" xref="A2.T1.3.3.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.3.3.1.m1.1.1.1.cmml" xref="A2.T1.3.3.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.3.3.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.3.3.1.m1.1.1.2">161</cn><cn id="A2.T1.3.3.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.3.3.1.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.3.3.1.m1.1c">161\pm 200</annotation><annotation encoding="application/x-llamapun" id="A2.T1.3.3.1.m1.1d">161 ± 200</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.4.4.2"><math alttext="2.2\pm 4.3" class="ltx_Math" display="inline" id="A2.T1.4.4.2.m1.1"><semantics id="A2.T1.4.4.2.m1.1a"><mrow id="A2.T1.4.4.2.m1.1.1" xref="A2.T1.4.4.2.m1.1.1.cmml"><mn id="A2.T1.4.4.2.m1.1.1.2" xref="A2.T1.4.4.2.m1.1.1.2.cmml">2.2</mn><mo id="A2.T1.4.4.2.m1.1.1.1" xref="A2.T1.4.4.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.4.4.2.m1.1.1.3" xref="A2.T1.4.4.2.m1.1.1.3.cmml">4.3</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.4.4.2.m1.1b"><apply id="A2.T1.4.4.2.m1.1.1.cmml" xref="A2.T1.4.4.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.4.4.2.m1.1.1.1.cmml" xref="A2.T1.4.4.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.4.4.2.m1.1.1.2.cmml" type="float" xref="A2.T1.4.4.2.m1.1.1.2">2.2</cn><cn id="A2.T1.4.4.2.m1.1.1.3.cmml" type="float" xref="A2.T1.4.4.2.m1.1.1.3">4.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.4.4.2.m1.1c">2.2\pm 4.3</annotation><annotation encoding="application/x-llamapun" id="A2.T1.4.4.2.m1.1d">2.2 ± 4.3</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.6.6.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.6.6.3.1">caveflyer</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.6.6.4">16466</td>
<td class="ltx_td ltx_align_center" id="A2.T1.5.5.1"><math alttext="119\pm 202" class="ltx_Math" display="inline" id="A2.T1.5.5.1.m1.1"><semantics id="A2.T1.5.5.1.m1.1a"><mrow id="A2.T1.5.5.1.m1.1.1" xref="A2.T1.5.5.1.m1.1.1.cmml"><mn id="A2.T1.5.5.1.m1.1.1.2" xref="A2.T1.5.5.1.m1.1.1.2.cmml">119</mn><mo id="A2.T1.5.5.1.m1.1.1.1" xref="A2.T1.5.5.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.5.5.1.m1.1.1.3" xref="A2.T1.5.5.1.m1.1.1.3.cmml">202</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.5.5.1.m1.1b"><apply id="A2.T1.5.5.1.m1.1.1.cmml" xref="A2.T1.5.5.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.5.5.1.m1.1.1.1.cmml" xref="A2.T1.5.5.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.5.5.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.5.5.1.m1.1.1.2">119</cn><cn id="A2.T1.5.5.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.5.5.1.m1.1.1.3">202</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.5.5.1.m1.1c">119\pm 202</annotation><annotation encoding="application/x-llamapun" id="A2.T1.5.5.1.m1.1d">119 ± 202</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.6.6.2"><math alttext="7.6\pm 4.4" class="ltx_Math" display="inline" id="A2.T1.6.6.2.m1.1"><semantics id="A2.T1.6.6.2.m1.1a"><mrow id="A2.T1.6.6.2.m1.1.1" xref="A2.T1.6.6.2.m1.1.1.cmml"><mn id="A2.T1.6.6.2.m1.1.1.2" xref="A2.T1.6.6.2.m1.1.1.2.cmml">7.6</mn><mo id="A2.T1.6.6.2.m1.1.1.1" xref="A2.T1.6.6.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.6.6.2.m1.1.1.3" xref="A2.T1.6.6.2.m1.1.1.3.cmml">4.4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.6.6.2.m1.1b"><apply id="A2.T1.6.6.2.m1.1.1.cmml" xref="A2.T1.6.6.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.6.6.2.m1.1.1.1.cmml" xref="A2.T1.6.6.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.6.6.2.m1.1.1.2.cmml" type="float" xref="A2.T1.6.6.2.m1.1.1.2">7.6</cn><cn id="A2.T1.6.6.2.m1.1.1.3.cmml" type="float" xref="A2.T1.6.6.2.m1.1.1.3">4.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.6.6.2.m1.1c">7.6\pm 4.4</annotation><annotation encoding="application/x-llamapun" id="A2.T1.6.6.2.m1.1d">7.6 ± 4.4</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.8.8.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.8.8.3.1">chaser</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.8.8.4">9182</td>
<td class="ltx_td ltx_align_center" id="A2.T1.7.7.1"><math alttext="213\pm 72" class="ltx_Math" display="inline" id="A2.T1.7.7.1.m1.1"><semantics id="A2.T1.7.7.1.m1.1a"><mrow id="A2.T1.7.7.1.m1.1.1" xref="A2.T1.7.7.1.m1.1.1.cmml"><mn id="A2.T1.7.7.1.m1.1.1.2" xref="A2.T1.7.7.1.m1.1.1.2.cmml">213</mn><mo id="A2.T1.7.7.1.m1.1.1.1" xref="A2.T1.7.7.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.7.7.1.m1.1.1.3" xref="A2.T1.7.7.1.m1.1.1.3.cmml">72</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.7.7.1.m1.1b"><apply id="A2.T1.7.7.1.m1.1.1.cmml" xref="A2.T1.7.7.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.7.7.1.m1.1.1.1.cmml" xref="A2.T1.7.7.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.7.7.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.7.7.1.m1.1.1.2">213</cn><cn id="A2.T1.7.7.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.7.7.1.m1.1.1.3">72</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.7.7.1.m1.1c">213\pm 72</annotation><annotation encoding="application/x-llamapun" id="A2.T1.7.7.1.m1.1d">213 ± 72</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.8.8.2"><math alttext="3.4\pm 3.2" class="ltx_Math" display="inline" id="A2.T1.8.8.2.m1.1"><semantics id="A2.T1.8.8.2.m1.1a"><mrow id="A2.T1.8.8.2.m1.1.1" xref="A2.T1.8.8.2.m1.1.1.cmml"><mn id="A2.T1.8.8.2.m1.1.1.2" xref="A2.T1.8.8.2.m1.1.1.2.cmml">3.4</mn><mo id="A2.T1.8.8.2.m1.1.1.1" xref="A2.T1.8.8.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.8.8.2.m1.1.1.3" xref="A2.T1.8.8.2.m1.1.1.3.cmml">3.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.8.8.2.m1.1b"><apply id="A2.T1.8.8.2.m1.1.1.cmml" xref="A2.T1.8.8.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.8.8.2.m1.1.1.1.cmml" xref="A2.T1.8.8.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.8.8.2.m1.1.1.2.cmml" type="float" xref="A2.T1.8.8.2.m1.1.1.2">3.4</cn><cn id="A2.T1.8.8.2.m1.1.1.3.cmml" type="float" xref="A2.T1.8.8.2.m1.1.1.3">3.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.8.8.2.m1.1c">3.4\pm 3.2</annotation><annotation encoding="application/x-llamapun" id="A2.T1.8.8.2.m1.1d">3.4 ± 3.2</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.10.10.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.10.10.3.1">climber</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.10.10.4">11392</td>
<td class="ltx_td ltx_align_center" id="A2.T1.9.9.1"><math alttext="171\pm 248" class="ltx_Math" display="inline" id="A2.T1.9.9.1.m1.1"><semantics id="A2.T1.9.9.1.m1.1a"><mrow id="A2.T1.9.9.1.m1.1.1" xref="A2.T1.9.9.1.m1.1.1.cmml"><mn id="A2.T1.9.9.1.m1.1.1.2" xref="A2.T1.9.9.1.m1.1.1.2.cmml">171</mn><mo id="A2.T1.9.9.1.m1.1.1.1" xref="A2.T1.9.9.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.9.9.1.m1.1.1.3" xref="A2.T1.9.9.1.m1.1.1.3.cmml">248</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.9.9.1.m1.1b"><apply id="A2.T1.9.9.1.m1.1.1.cmml" xref="A2.T1.9.9.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.9.9.1.m1.1.1.1.cmml" xref="A2.T1.9.9.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.9.9.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.9.9.1.m1.1.1.2">171</cn><cn id="A2.T1.9.9.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.9.9.1.m1.1.1.3">248</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.9.9.1.m1.1c">171\pm 248</annotation><annotation encoding="application/x-llamapun" id="A2.T1.9.9.1.m1.1d">171 ± 248</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.10.10.2"><math alttext="9.2\pm 5.2" class="ltx_Math" display="inline" id="A2.T1.10.10.2.m1.1"><semantics id="A2.T1.10.10.2.m1.1a"><mrow id="A2.T1.10.10.2.m1.1.1" xref="A2.T1.10.10.2.m1.1.1.cmml"><mn id="A2.T1.10.10.2.m1.1.1.2" xref="A2.T1.10.10.2.m1.1.1.2.cmml">9.2</mn><mo id="A2.T1.10.10.2.m1.1.1.1" xref="A2.T1.10.10.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.10.10.2.m1.1.1.3" xref="A2.T1.10.10.2.m1.1.1.3.cmml">5.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.10.10.2.m1.1b"><apply id="A2.T1.10.10.2.m1.1.1.cmml" xref="A2.T1.10.10.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.10.10.2.m1.1.1.1.cmml" xref="A2.T1.10.10.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.10.10.2.m1.1.1.2.cmml" type="float" xref="A2.T1.10.10.2.m1.1.1.2">9.2</cn><cn id="A2.T1.10.10.2.m1.1.1.3.cmml" type="float" xref="A2.T1.10.10.2.m1.1.1.3">5.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.10.10.2.m1.1c">9.2\pm 5.2</annotation><annotation encoding="application/x-llamapun" id="A2.T1.10.10.2.m1.1d">9.2 ± 5.2</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.12.12.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.12.12.3.1">coinrun</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.12.12.4">38236</td>
<td class="ltx_td ltx_align_center" id="A2.T1.11.11.1"><math alttext="51\pm 49" class="ltx_Math" display="inline" id="A2.T1.11.11.1.m1.1"><semantics id="A2.T1.11.11.1.m1.1a"><mrow id="A2.T1.11.11.1.m1.1.1" xref="A2.T1.11.11.1.m1.1.1.cmml"><mn id="A2.T1.11.11.1.m1.1.1.2" xref="A2.T1.11.11.1.m1.1.1.2.cmml">51</mn><mo id="A2.T1.11.11.1.m1.1.1.1" xref="A2.T1.11.11.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.11.11.1.m1.1.1.3" xref="A2.T1.11.11.1.m1.1.1.3.cmml">49</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.11.11.1.m1.1b"><apply id="A2.T1.11.11.1.m1.1.1.cmml" xref="A2.T1.11.11.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.11.11.1.m1.1.1.1.cmml" xref="A2.T1.11.11.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.11.11.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.11.11.1.m1.1.1.2">51</cn><cn id="A2.T1.11.11.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.11.11.1.m1.1.1.3">49</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.11.11.1.m1.1c">51\pm 49</annotation><annotation encoding="application/x-llamapun" id="A2.T1.11.11.1.m1.1d">51 ± 49</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.12.12.2"><math alttext="9.7\pm 1.8" class="ltx_Math" display="inline" id="A2.T1.12.12.2.m1.1"><semantics id="A2.T1.12.12.2.m1.1a"><mrow id="A2.T1.12.12.2.m1.1.1" xref="A2.T1.12.12.2.m1.1.1.cmml"><mn id="A2.T1.12.12.2.m1.1.1.2" xref="A2.T1.12.12.2.m1.1.1.2.cmml">9.7</mn><mo id="A2.T1.12.12.2.m1.1.1.1" xref="A2.T1.12.12.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.12.12.2.m1.1.1.3" xref="A2.T1.12.12.2.m1.1.1.3.cmml">1.8</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.12.12.2.m1.1b"><apply id="A2.T1.12.12.2.m1.1.1.cmml" xref="A2.T1.12.12.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.12.12.2.m1.1.1.1.cmml" xref="A2.T1.12.12.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.12.12.2.m1.1.1.2.cmml" type="float" xref="A2.T1.12.12.2.m1.1.1.2">9.7</cn><cn id="A2.T1.12.12.2.m1.1.1.3.cmml" type="float" xref="A2.T1.12.12.2.m1.1.1.3">1.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.12.12.2.m1.1c">9.7\pm 1.8</annotation><annotation encoding="application/x-llamapun" id="A2.T1.12.12.2.m1.1d">9.7 ± 1.8</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.14.14.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.14.14.3.1">dodgeball</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.14.14.4">13089</td>
<td class="ltx_td ltx_align_center" id="A2.T1.13.13.1"><math alttext="149\pm 214" class="ltx_Math" display="inline" id="A2.T1.13.13.1.m1.1"><semantics id="A2.T1.13.13.1.m1.1a"><mrow id="A2.T1.13.13.1.m1.1.1" xref="A2.T1.13.13.1.m1.1.1.cmml"><mn id="A2.T1.13.13.1.m1.1.1.2" xref="A2.T1.13.13.1.m1.1.1.2.cmml">149</mn><mo id="A2.T1.13.13.1.m1.1.1.1" xref="A2.T1.13.13.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.13.13.1.m1.1.1.3" xref="A2.T1.13.13.1.m1.1.1.3.cmml">214</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.13.13.1.m1.1b"><apply id="A2.T1.13.13.1.m1.1.1.cmml" xref="A2.T1.13.13.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.13.13.1.m1.1.1.1.cmml" xref="A2.T1.13.13.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.13.13.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.13.13.1.m1.1.1.2">149</cn><cn id="A2.T1.13.13.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.13.13.1.m1.1.1.3">214</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.13.13.1.m1.1c">149\pm 214</annotation><annotation encoding="application/x-llamapun" id="A2.T1.13.13.1.m1.1d">149 ± 214</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.14.14.2"><math alttext="3.2\pm 4.2" class="ltx_Math" display="inline" id="A2.T1.14.14.2.m1.1"><semantics id="A2.T1.14.14.2.m1.1a"><mrow id="A2.T1.14.14.2.m1.1.1" xref="A2.T1.14.14.2.m1.1.1.cmml"><mn id="A2.T1.14.14.2.m1.1.1.2" xref="A2.T1.14.14.2.m1.1.1.2.cmml">3.2</mn><mo id="A2.T1.14.14.2.m1.1.1.1" xref="A2.T1.14.14.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.14.14.2.m1.1.1.3" xref="A2.T1.14.14.2.m1.1.1.3.cmml">4.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.14.14.2.m1.1b"><apply id="A2.T1.14.14.2.m1.1.1.cmml" xref="A2.T1.14.14.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.14.14.2.m1.1.1.1.cmml" xref="A2.T1.14.14.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.14.14.2.m1.1.1.2.cmml" type="float" xref="A2.T1.14.14.2.m1.1.1.2">3.2</cn><cn id="A2.T1.14.14.2.m1.1.1.3.cmml" type="float" xref="A2.T1.14.14.2.m1.1.1.3">4.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.14.14.2.m1.1c">3.2\pm 4.2</annotation><annotation encoding="application/x-llamapun" id="A2.T1.14.14.2.m1.1d">3.2 ± 4.2</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.16.16.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.16.16.3.1">fruitbot</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.16.16.4">6966</td>
<td class="ltx_td ltx_align_center" id="A2.T1.15.15.1"><math alttext="280\pm 152" class="ltx_Math" display="inline" id="A2.T1.15.15.1.m1.1"><semantics id="A2.T1.15.15.1.m1.1a"><mrow id="A2.T1.15.15.1.m1.1.1" xref="A2.T1.15.15.1.m1.1.1.cmml"><mn id="A2.T1.15.15.1.m1.1.1.2" xref="A2.T1.15.15.1.m1.1.1.2.cmml">280</mn><mo id="A2.T1.15.15.1.m1.1.1.1" xref="A2.T1.15.15.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.15.15.1.m1.1.1.3" xref="A2.T1.15.15.1.m1.1.1.3.cmml">152</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.15.15.1.m1.1b"><apply id="A2.T1.15.15.1.m1.1.1.cmml" xref="A2.T1.15.15.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.15.15.1.m1.1.1.1.cmml" xref="A2.T1.15.15.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.15.15.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.15.15.1.m1.1.1.2">280</cn><cn id="A2.T1.15.15.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.15.15.1.m1.1.1.3">152</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.15.15.1.m1.1c">280\pm 152</annotation><annotation encoding="application/x-llamapun" id="A2.T1.15.15.1.m1.1d">280 ± 152</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.16.16.2"><math alttext="17.0\pm 14.3" class="ltx_Math" display="inline" id="A2.T1.16.16.2.m1.1"><semantics id="A2.T1.16.16.2.m1.1a"><mrow id="A2.T1.16.16.2.m1.1.1" xref="A2.T1.16.16.2.m1.1.1.cmml"><mn id="A2.T1.16.16.2.m1.1.1.2" xref="A2.T1.16.16.2.m1.1.1.2.cmml">17.0</mn><mo id="A2.T1.16.16.2.m1.1.1.1" xref="A2.T1.16.16.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.16.16.2.m1.1.1.3" xref="A2.T1.16.16.2.m1.1.1.3.cmml">14.3</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.16.16.2.m1.1b"><apply id="A2.T1.16.16.2.m1.1.1.cmml" xref="A2.T1.16.16.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.16.16.2.m1.1.1.1.cmml" xref="A2.T1.16.16.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.16.16.2.m1.1.1.2.cmml" type="float" xref="A2.T1.16.16.2.m1.1.1.2">17.0</cn><cn id="A2.T1.16.16.2.m1.1.1.3.cmml" type="float" xref="A2.T1.16.16.2.m1.1.1.3">14.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.16.16.2.m1.1c">17.0\pm 14.3</annotation><annotation encoding="application/x-llamapun" id="A2.T1.16.16.2.m1.1d">17.0 ± 14.3</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.18.18.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.18.18.3.1">heist</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.18.18.4">8090</td>
<td class="ltx_td ltx_align_center" id="A2.T1.17.17.1"><math alttext="241\pm 395" class="ltx_Math" display="inline" id="A2.T1.17.17.1.m1.1"><semantics id="A2.T1.17.17.1.m1.1a"><mrow id="A2.T1.17.17.1.m1.1.1" xref="A2.T1.17.17.1.m1.1.1.cmml"><mn id="A2.T1.17.17.1.m1.1.1.2" xref="A2.T1.17.17.1.m1.1.1.2.cmml">241</mn><mo id="A2.T1.17.17.1.m1.1.1.1" xref="A2.T1.17.17.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.17.17.1.m1.1.1.3" xref="A2.T1.17.17.1.m1.1.1.3.cmml">395</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.17.17.1.m1.1b"><apply id="A2.T1.17.17.1.m1.1.1.cmml" xref="A2.T1.17.17.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.17.17.1.m1.1.1.1.cmml" xref="A2.T1.17.17.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.17.17.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.17.17.1.m1.1.1.2">241</cn><cn id="A2.T1.17.17.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.17.17.1.m1.1.1.3">395</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.17.17.1.m1.1c">241\pm 395</annotation><annotation encoding="application/x-llamapun" id="A2.T1.17.17.1.m1.1d">241 ± 395</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.18.18.2"><math alttext="8.0\pm 4.0" class="ltx_Math" display="inline" id="A2.T1.18.18.2.m1.1"><semantics id="A2.T1.18.18.2.m1.1a"><mrow id="A2.T1.18.18.2.m1.1.1" xref="A2.T1.18.18.2.m1.1.1.cmml"><mn id="A2.T1.18.18.2.m1.1.1.2" xref="A2.T1.18.18.2.m1.1.1.2.cmml">8.0</mn><mo id="A2.T1.18.18.2.m1.1.1.1" xref="A2.T1.18.18.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.18.18.2.m1.1.1.3" xref="A2.T1.18.18.2.m1.1.1.3.cmml">4.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.18.18.2.m1.1b"><apply id="A2.T1.18.18.2.m1.1.1.cmml" xref="A2.T1.18.18.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.18.18.2.m1.1.1.1.cmml" xref="A2.T1.18.18.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.18.18.2.m1.1.1.2.cmml" type="float" xref="A2.T1.18.18.2.m1.1.1.2">8.0</cn><cn id="A2.T1.18.18.2.m1.1.1.3.cmml" type="float" xref="A2.T1.18.18.2.m1.1.1.3">4.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.18.18.2.m1.1c">8.0\pm 4.0</annotation><annotation encoding="application/x-llamapun" id="A2.T1.18.18.2.m1.1d">8.0 ± 4.0</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.20.20.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.20.20.3.1">jumper</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.20.20.4">45621</td>
<td class="ltx_td ltx_align_center" id="A2.T1.19.19.1"><math alttext="43\pm 143" class="ltx_Math" display="inline" id="A2.T1.19.19.1.m1.1"><semantics id="A2.T1.19.19.1.m1.1a"><mrow id="A2.T1.19.19.1.m1.1.1" xref="A2.T1.19.19.1.m1.1.1.cmml"><mn id="A2.T1.19.19.1.m1.1.1.2" xref="A2.T1.19.19.1.m1.1.1.2.cmml">43</mn><mo id="A2.T1.19.19.1.m1.1.1.1" xref="A2.T1.19.19.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.19.19.1.m1.1.1.3" xref="A2.T1.19.19.1.m1.1.1.3.cmml">143</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.19.19.1.m1.1b"><apply id="A2.T1.19.19.1.m1.1.1.cmml" xref="A2.T1.19.19.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.19.19.1.m1.1.1.1.cmml" xref="A2.T1.19.19.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.19.19.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.19.19.1.m1.1.1.2">43</cn><cn id="A2.T1.19.19.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.19.19.1.m1.1.1.3">143</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.19.19.1.m1.1c">43\pm 143</annotation><annotation encoding="application/x-llamapun" id="A2.T1.19.19.1.m1.1d">43 ± 143</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.20.20.2"><math alttext="8.7\pm 3.3" class="ltx_Math" display="inline" id="A2.T1.20.20.2.m1.1"><semantics id="A2.T1.20.20.2.m1.1a"><mrow id="A2.T1.20.20.2.m1.1.1" xref="A2.T1.20.20.2.m1.1.1.cmml"><mn id="A2.T1.20.20.2.m1.1.1.2" xref="A2.T1.20.20.2.m1.1.1.2.cmml">8.7</mn><mo id="A2.T1.20.20.2.m1.1.1.1" xref="A2.T1.20.20.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.20.20.2.m1.1.1.3" xref="A2.T1.20.20.2.m1.1.1.3.cmml">3.3</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.20.20.2.m1.1b"><apply id="A2.T1.20.20.2.m1.1.1.cmml" xref="A2.T1.20.20.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.20.20.2.m1.1.1.1.cmml" xref="A2.T1.20.20.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.20.20.2.m1.1.1.2.cmml" type="float" xref="A2.T1.20.20.2.m1.1.1.2">8.7</cn><cn id="A2.T1.20.20.2.m1.1.1.3.cmml" type="float" xref="A2.T1.20.20.2.m1.1.1.3">3.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.20.20.2.m1.1c">8.7\pm 3.3</annotation><annotation encoding="application/x-llamapun" id="A2.T1.20.20.2.m1.1d">8.7 ± 3.3</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.22.22.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.22.22.3.1">leaper</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.22.22.4">28383</td>
<td class="ltx_td ltx_align_center" id="A2.T1.21.21.1"><math alttext="69\pm 84" class="ltx_Math" display="inline" id="A2.T1.21.21.1.m1.1"><semantics id="A2.T1.21.21.1.m1.1a"><mrow id="A2.T1.21.21.1.m1.1.1" xref="A2.T1.21.21.1.m1.1.1.cmml"><mn id="A2.T1.21.21.1.m1.1.1.2" xref="A2.T1.21.21.1.m1.1.1.2.cmml">69</mn><mo id="A2.T1.21.21.1.m1.1.1.1" xref="A2.T1.21.21.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.21.21.1.m1.1.1.3" xref="A2.T1.21.21.1.m1.1.1.3.cmml">84</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.21.21.1.m1.1b"><apply id="A2.T1.21.21.1.m1.1.1.cmml" xref="A2.T1.21.21.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.21.21.1.m1.1.1.1.cmml" xref="A2.T1.21.21.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.21.21.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.21.21.1.m1.1.1.2">69</cn><cn id="A2.T1.21.21.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.21.21.1.m1.1.1.3">84</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.21.21.1.m1.1c">69\pm 84</annotation><annotation encoding="application/x-llamapun" id="A2.T1.21.21.1.m1.1d">69 ± 84</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.22.22.2"><math alttext="4.9\pm 5.0" class="ltx_Math" display="inline" id="A2.T1.22.22.2.m1.1"><semantics id="A2.T1.22.22.2.m1.1a"><mrow id="A2.T1.22.22.2.m1.1.1" xref="A2.T1.22.22.2.m1.1.1.cmml"><mn id="A2.T1.22.22.2.m1.1.1.2" xref="A2.T1.22.22.2.m1.1.1.2.cmml">4.9</mn><mo id="A2.T1.22.22.2.m1.1.1.1" xref="A2.T1.22.22.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.22.22.2.m1.1.1.3" xref="A2.T1.22.22.2.m1.1.1.3.cmml">5.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.22.22.2.m1.1b"><apply id="A2.T1.22.22.2.m1.1.1.cmml" xref="A2.T1.22.22.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.22.22.2.m1.1.1.1.cmml" xref="A2.T1.22.22.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.22.22.2.m1.1.1.2.cmml" type="float" xref="A2.T1.22.22.2.m1.1.1.2">4.9</cn><cn id="A2.T1.22.22.2.m1.1.1.3.cmml" type="float" xref="A2.T1.22.22.2.m1.1.1.3">5.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.22.22.2.m1.1c">4.9\pm 5.0</annotation><annotation encoding="application/x-llamapun" id="A2.T1.22.22.2.m1.1d">4.9 ± 5.0</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.24.24.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.24.24.3.1">maze</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.24.24.4">48867</td>
<td class="ltx_td ltx_align_center" id="A2.T1.23.23.1"><math alttext="40\pm 112" class="ltx_Math" display="inline" id="A2.T1.23.23.1.m1.1"><semantics id="A2.T1.23.23.1.m1.1a"><mrow id="A2.T1.23.23.1.m1.1.1" xref="A2.T1.23.23.1.m1.1.1.cmml"><mn id="A2.T1.23.23.1.m1.1.1.2" xref="A2.T1.23.23.1.m1.1.1.2.cmml">40</mn><mo id="A2.T1.23.23.1.m1.1.1.1" xref="A2.T1.23.23.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.23.23.1.m1.1.1.3" xref="A2.T1.23.23.1.m1.1.1.3.cmml">112</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.23.23.1.m1.1b"><apply id="A2.T1.23.23.1.m1.1.1.cmml" xref="A2.T1.23.23.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.23.23.1.m1.1.1.1.cmml" xref="A2.T1.23.23.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.23.23.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.23.23.1.m1.1.1.2">40</cn><cn id="A2.T1.23.23.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.23.23.1.m1.1.1.3">112</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.23.23.1.m1.1c">40\pm 112</annotation><annotation encoding="application/x-llamapun" id="A2.T1.23.23.1.m1.1d">40 ± 112</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.24.24.2"><math alttext="9.5\pm 2.3" class="ltx_Math" display="inline" id="A2.T1.24.24.2.m1.1"><semantics id="A2.T1.24.24.2.m1.1a"><mrow id="A2.T1.24.24.2.m1.1.1" xref="A2.T1.24.24.2.m1.1.1.cmml"><mn id="A2.T1.24.24.2.m1.1.1.2" xref="A2.T1.24.24.2.m1.1.1.2.cmml">9.5</mn><mo id="A2.T1.24.24.2.m1.1.1.1" xref="A2.T1.24.24.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.24.24.2.m1.1.1.3" xref="A2.T1.24.24.2.m1.1.1.3.cmml">2.3</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.24.24.2.m1.1b"><apply id="A2.T1.24.24.2.m1.1.1.cmml" xref="A2.T1.24.24.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.24.24.2.m1.1.1.1.cmml" xref="A2.T1.24.24.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.24.24.2.m1.1.1.2.cmml" type="float" xref="A2.T1.24.24.2.m1.1.1.2">9.5</cn><cn id="A2.T1.24.24.2.m1.1.1.3.cmml" type="float" xref="A2.T1.24.24.2.m1.1.1.3">2.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.24.24.2.m1.1c">9.5\pm 2.3</annotation><annotation encoding="application/x-llamapun" id="A2.T1.24.24.2.m1.1d">9.5 ± 2.3</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.26.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.26.26.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.26.26.3.1">miner</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.26.26.4">26897</td>
<td class="ltx_td ltx_align_center" id="A2.T1.25.25.1"><math alttext="73\pm 182" class="ltx_Math" display="inline" id="A2.T1.25.25.1.m1.1"><semantics id="A2.T1.25.25.1.m1.1a"><mrow id="A2.T1.25.25.1.m1.1.1" xref="A2.T1.25.25.1.m1.1.1.cmml"><mn id="A2.T1.25.25.1.m1.1.1.2" xref="A2.T1.25.25.1.m1.1.1.2.cmml">73</mn><mo id="A2.T1.25.25.1.m1.1.1.1" xref="A2.T1.25.25.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.25.25.1.m1.1.1.3" xref="A2.T1.25.25.1.m1.1.1.3.cmml">182</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.25.25.1.m1.1b"><apply id="A2.T1.25.25.1.m1.1.1.cmml" xref="A2.T1.25.25.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.25.25.1.m1.1.1.1.cmml" xref="A2.T1.25.25.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.25.25.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.25.25.1.m1.1.1.2">73</cn><cn id="A2.T1.25.25.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.25.25.1.m1.1.1.3">182</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.25.25.1.m1.1c">73\pm 182</annotation><annotation encoding="application/x-llamapun" id="A2.T1.25.25.1.m1.1d">73 ± 182</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.26.26.2"><math alttext="11.7\pm 3.5" class="ltx_Math" display="inline" id="A2.T1.26.26.2.m1.1"><semantics id="A2.T1.26.26.2.m1.1a"><mrow id="A2.T1.26.26.2.m1.1.1" xref="A2.T1.26.26.2.m1.1.1.cmml"><mn id="A2.T1.26.26.2.m1.1.1.2" xref="A2.T1.26.26.2.m1.1.1.2.cmml">11.7</mn><mo id="A2.T1.26.26.2.m1.1.1.1" xref="A2.T1.26.26.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.26.26.2.m1.1.1.3" xref="A2.T1.26.26.2.m1.1.1.3.cmml">3.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.26.26.2.m1.1b"><apply id="A2.T1.26.26.2.m1.1.1.cmml" xref="A2.T1.26.26.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.26.26.2.m1.1.1.1.cmml" xref="A2.T1.26.26.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.26.26.2.m1.1.1.2.cmml" type="float" xref="A2.T1.26.26.2.m1.1.1.2">11.7</cn><cn id="A2.T1.26.26.2.m1.1.1.3.cmml" type="float" xref="A2.T1.26.26.2.m1.1.1.3">3.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.26.26.2.m1.1c">11.7\pm 3.5</annotation><annotation encoding="application/x-llamapun" id="A2.T1.26.26.2.m1.1d">11.7 ± 3.5</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.28.28.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.28.28.3.1">ninja</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.28.28.4">24268</td>
<td class="ltx_td ltx_align_center" id="A2.T1.27.27.1"><math alttext="80\pm 136" class="ltx_Math" display="inline" id="A2.T1.27.27.1.m1.1"><semantics id="A2.T1.27.27.1.m1.1a"><mrow id="A2.T1.27.27.1.m1.1.1" xref="A2.T1.27.27.1.m1.1.1.cmml"><mn id="A2.T1.27.27.1.m1.1.1.2" xref="A2.T1.27.27.1.m1.1.1.2.cmml">80</mn><mo id="A2.T1.27.27.1.m1.1.1.1" xref="A2.T1.27.27.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.27.27.1.m1.1.1.3" xref="A2.T1.27.27.1.m1.1.1.3.cmml">136</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.27.27.1.m1.1b"><apply id="A2.T1.27.27.1.m1.1.1.cmml" xref="A2.T1.27.27.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.27.27.1.m1.1.1.1.cmml" xref="A2.T1.27.27.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.27.27.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.27.27.1.m1.1.1.2">80</cn><cn id="A2.T1.27.27.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.27.27.1.m1.1.1.3">136</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.27.27.1.m1.1c">80\pm 136</annotation><annotation encoding="application/x-llamapun" id="A2.T1.27.27.1.m1.1d">80 ± 136</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.28.28.2"><math alttext="7.8\pm 4.2" class="ltx_Math" display="inline" id="A2.T1.28.28.2.m1.1"><semantics id="A2.T1.28.28.2.m1.1a"><mrow id="A2.T1.28.28.2.m1.1.1" xref="A2.T1.28.28.2.m1.1.1.cmml"><mn id="A2.T1.28.28.2.m1.1.1.2" xref="A2.T1.28.28.2.m1.1.1.2.cmml">7.8</mn><mo id="A2.T1.28.28.2.m1.1.1.1" xref="A2.T1.28.28.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.28.28.2.m1.1.1.3" xref="A2.T1.28.28.2.m1.1.1.3.cmml">4.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.28.28.2.m1.1b"><apply id="A2.T1.28.28.2.m1.1.1.cmml" xref="A2.T1.28.28.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.28.28.2.m1.1.1.1.cmml" xref="A2.T1.28.28.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.28.28.2.m1.1.1.2.cmml" type="float" xref="A2.T1.28.28.2.m1.1.1.2">7.8</cn><cn id="A2.T1.28.28.2.m1.1.1.3.cmml" type="float" xref="A2.T1.28.28.2.m1.1.1.3">4.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.28.28.2.m1.1c">7.8\pm 4.2</annotation><annotation encoding="application/x-llamapun" id="A2.T1.28.28.2.m1.1d">7.8 ± 4.2</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.30.30">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.30.30.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.30.30.3.1">plunder</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.30.30.4">6179</td>
<td class="ltx_td ltx_align_center" id="A2.T1.29.29.1"><math alttext="316\pm 106" class="ltx_Math" display="inline" id="A2.T1.29.29.1.m1.1"><semantics id="A2.T1.29.29.1.m1.1a"><mrow id="A2.T1.29.29.1.m1.1.1" xref="A2.T1.29.29.1.m1.1.1.cmml"><mn id="A2.T1.29.29.1.m1.1.1.2" xref="A2.T1.29.29.1.m1.1.1.2.cmml">316</mn><mo id="A2.T1.29.29.1.m1.1.1.1" xref="A2.T1.29.29.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.29.29.1.m1.1.1.3" xref="A2.T1.29.29.1.m1.1.1.3.cmml">106</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.29.29.1.m1.1b"><apply id="A2.T1.29.29.1.m1.1.1.cmml" xref="A2.T1.29.29.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.29.29.1.m1.1.1.1.cmml" xref="A2.T1.29.29.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.29.29.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.29.29.1.m1.1.1.2">316</cn><cn id="A2.T1.29.29.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.29.29.1.m1.1.1.3">106</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.29.29.1.m1.1c">316\pm 106</annotation><annotation encoding="application/x-llamapun" id="A2.T1.29.29.1.m1.1d">316 ± 106</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.30.30.2"><math alttext="4.9\pm 3.2" class="ltx_Math" display="inline" id="A2.T1.30.30.2.m1.1"><semantics id="A2.T1.30.30.2.m1.1a"><mrow id="A2.T1.30.30.2.m1.1.1" xref="A2.T1.30.30.2.m1.1.1.cmml"><mn id="A2.T1.30.30.2.m1.1.1.2" xref="A2.T1.30.30.2.m1.1.1.2.cmml">4.9</mn><mo id="A2.T1.30.30.2.m1.1.1.1" xref="A2.T1.30.30.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.30.30.2.m1.1.1.3" xref="A2.T1.30.30.2.m1.1.1.3.cmml">3.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.30.30.2.m1.1b"><apply id="A2.T1.30.30.2.m1.1.1.cmml" xref="A2.T1.30.30.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.30.30.2.m1.1.1.1.cmml" xref="A2.T1.30.30.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.30.30.2.m1.1.1.2.cmml" type="float" xref="A2.T1.30.30.2.m1.1.1.2">4.9</cn><cn id="A2.T1.30.30.2.m1.1.1.3.cmml" type="float" xref="A2.T1.30.30.2.m1.1.1.3">3.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.30.30.2.m1.1c">4.9\pm 3.2</annotation><annotation encoding="application/x-llamapun" id="A2.T1.30.30.2.m1.1d">4.9 ± 3.2</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.32.32">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.32.32.3"><span class="ltx_text ltx_font_typewriter" id="A2.T1.32.32.3.1">starpilot</span></th>
<td class="ltx_td ltx_align_center" id="A2.T1.32.32.4">9490</td>
<td class="ltx_td ltx_align_center" id="A2.T1.31.31.1"><math alttext="206\pm 137" class="ltx_Math" display="inline" id="A2.T1.31.31.1.m1.1"><semantics id="A2.T1.31.31.1.m1.1a"><mrow id="A2.T1.31.31.1.m1.1.1" xref="A2.T1.31.31.1.m1.1.1.cmml"><mn id="A2.T1.31.31.1.m1.1.1.2" xref="A2.T1.31.31.1.m1.1.1.2.cmml">206</mn><mo id="A2.T1.31.31.1.m1.1.1.1" xref="A2.T1.31.31.1.m1.1.1.1.cmml">±</mo><mn id="A2.T1.31.31.1.m1.1.1.3" xref="A2.T1.31.31.1.m1.1.1.3.cmml">137</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.31.31.1.m1.1b"><apply id="A2.T1.31.31.1.m1.1.1.cmml" xref="A2.T1.31.31.1.m1.1.1"><csymbol cd="latexml" id="A2.T1.31.31.1.m1.1.1.1.cmml" xref="A2.T1.31.31.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.31.31.1.m1.1.1.2.cmml" type="integer" xref="A2.T1.31.31.1.m1.1.1.2">206</cn><cn id="A2.T1.31.31.1.m1.1.1.3.cmml" type="integer" xref="A2.T1.31.31.1.m1.1.1.3">137</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.31.31.1.m1.1c">206\pm 137</annotation><annotation encoding="application/x-llamapun" id="A2.T1.31.31.1.m1.1d">206 ± 137</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A2.T1.32.32.2"><math alttext="17.3\pm 16.4" class="ltx_Math" display="inline" id="A2.T1.32.32.2.m1.1"><semantics id="A2.T1.32.32.2.m1.1a"><mrow id="A2.T1.32.32.2.m1.1.1" xref="A2.T1.32.32.2.m1.1.1.cmml"><mn id="A2.T1.32.32.2.m1.1.1.2" xref="A2.T1.32.32.2.m1.1.1.2.cmml">17.3</mn><mo id="A2.T1.32.32.2.m1.1.1.1" xref="A2.T1.32.32.2.m1.1.1.1.cmml">±</mo><mn id="A2.T1.32.32.2.m1.1.1.3" xref="A2.T1.32.32.2.m1.1.1.3.cmml">16.4</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.32.32.2.m1.1b"><apply id="A2.T1.32.32.2.m1.1.1.cmml" xref="A2.T1.32.32.2.m1.1.1"><csymbol cd="latexml" id="A2.T1.32.32.2.m1.1.1.1.cmml" xref="A2.T1.32.32.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A2.T1.32.32.2.m1.1.1.2.cmml" type="float" xref="A2.T1.32.32.2.m1.1.1.2">17.3</cn><cn id="A2.T1.32.32.2.m1.1.1.3.cmml" type="float" xref="A2.T1.32.32.2.m1.1.1.3">16.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.32.32.2.m1.1c">17.3\pm 16.4</annotation><annotation encoding="application/x-llamapun" id="A2.T1.32.32.2.m1.1d">17.3 ± 16.4</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A2.T1.32.34.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A2.T1.32.34.1.1">Average</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A2.T1.32.34.1.2">19628</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A2.T1.32.34.1.3">152</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A2.T1.32.34.1.4">8.2</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="A2.F13">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="113" id="A2.F13.1.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_bigfish_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="122" id="A2.F13.2.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_bossfight_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="118" id="A2.F13.3.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_caveflyer_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="122" id="A2.F13.4.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_chaser_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="118" id="A2.F13.5.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_climber_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="118" id="A2.F13.6.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_coinrun_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="122" id="A2.F13.7.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_dodgeball_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.8"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="118" id="A2.F13.8.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_fruitbot_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.9"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="122" id="A2.F13.9.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_heist_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.10"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="122" id="A2.F13.10.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_jumper_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.11"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="122" id="A2.F13.11.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_leaper_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.12"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="118" id="A2.F13.12.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_maze_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.13"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="113" id="A2.F13.13.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_miner_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.14"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="118" id="A2.F13.14.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_ninja_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.15"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="122" id="A2.F13.15.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_plunder_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.16"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="122" id="A2.F13.16.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_leaper_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.17"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="118" id="A2.F13.17.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_maze_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.18"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="113" id="A2.F13.18.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_miner_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.19"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="118" id="A2.F13.19.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_ninja_nolegend.png" width="132"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.20"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="122" id="A2.F13.20.g1" src="extracted/5911726/figures/procgen/datagen/lc_rliable_plunder_nolegend.png" width="132"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Learning curves for data-collection runs on all 16 Procgen environments with PPO as source algorithm. We train for 25M environment steps on each task in <span class="ltx_text ltx_font_typewriter" id="A2.F13.22.1">easy</span> mode.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Experimental &amp; Implementation Details</h2>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>General</h3>
<div class="ltx_para ltx_noindent" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="A3.SS1.p1.1.1">Training &amp; Evaluation.</span> We compare RA-DT against DT, AD, and DPT on all environments.
On grid-world environments, we train all methods for 100K steps and evaluate after every 25K steps.
For Meta-World, DMControl and Procgen, we train for 200K steps and evaluate after every 50K steps.
During evaluation, the agent is given 40 interaction episodes for ICL on Dark-Room and Dark Key-Door, and 30 episodes on MazeRunner, Meta-World, DMControl, and Procgen.
We use the ICL curves as the primary evaluation mechanism, and report the scores at the last evaluation step (100K or 200K).
Following, <cite class="ltx_cite ltx_citemacro_citet">Agarwal et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib1" title="">2021</a>]</cite> we report the mean and 95% confidence intervals across tasks and over 3 seeds in all experiments.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS1.p2">
<p class="ltx_p" id="A3.SS1.p2.3">Across experiments, we keep most parameters fixed, unless mentioned otherwise.
We train with a batch size of 128 on all environments, except for <math alttext="40" class="ltx_Math" display="inline" id="A3.SS1.p2.1.m1.1"><semantics id="A3.SS1.p2.1.m1.1a"><mn id="A3.SS1.p2.1.m1.1.1" xref="A3.SS1.p2.1.m1.1.1.cmml">40</mn><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.1.m1.1b"><cn id="A3.SS1.p2.1.m1.1.1.cmml" type="integer" xref="A3.SS1.p2.1.m1.1.1">40</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.1.m1.1c">40</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.1.m1.1d">40</annotation></semantics></math> grids, where we use a batch size of 32.
We use a constant learning rate of <math alttext="1e^{-4}" class="ltx_Math" display="inline" id="A3.SS1.p2.2.m2.1"><semantics id="A3.SS1.p2.2.m2.1a"><mrow id="A3.SS1.p2.2.m2.1.1" xref="A3.SS1.p2.2.m2.1.1.cmml"><mn id="A3.SS1.p2.2.m2.1.1.2" xref="A3.SS1.p2.2.m2.1.1.2.cmml">1</mn><mo id="A3.SS1.p2.2.m2.1.1.1" xref="A3.SS1.p2.2.m2.1.1.1.cmml">⁢</mo><msup id="A3.SS1.p2.2.m2.1.1.3" xref="A3.SS1.p2.2.m2.1.1.3.cmml"><mi id="A3.SS1.p2.2.m2.1.1.3.2" xref="A3.SS1.p2.2.m2.1.1.3.2.cmml">e</mi><mrow id="A3.SS1.p2.2.m2.1.1.3.3" xref="A3.SS1.p2.2.m2.1.1.3.3.cmml"><mo id="A3.SS1.p2.2.m2.1.1.3.3a" xref="A3.SS1.p2.2.m2.1.1.3.3.cmml">−</mo><mn id="A3.SS1.p2.2.m2.1.1.3.3.2" xref="A3.SS1.p2.2.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.2.m2.1b"><apply id="A3.SS1.p2.2.m2.1.1.cmml" xref="A3.SS1.p2.2.m2.1.1"><times id="A3.SS1.p2.2.m2.1.1.1.cmml" xref="A3.SS1.p2.2.m2.1.1.1"></times><cn id="A3.SS1.p2.2.m2.1.1.2.cmml" type="integer" xref="A3.SS1.p2.2.m2.1.1.2">1</cn><apply id="A3.SS1.p2.2.m2.1.1.3.cmml" xref="A3.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p2.2.m2.1.1.3.1.cmml" xref="A3.SS1.p2.2.m2.1.1.3">superscript</csymbol><ci id="A3.SS1.p2.2.m2.1.1.3.2.cmml" xref="A3.SS1.p2.2.m2.1.1.3.2">𝑒</ci><apply id="A3.SS1.p2.2.m2.1.1.3.3.cmml" xref="A3.SS1.p2.2.m2.1.1.3.3"><minus id="A3.SS1.p2.2.m2.1.1.3.3.1.cmml" xref="A3.SS1.p2.2.m2.1.1.3.3"></minus><cn id="A3.SS1.p2.2.m2.1.1.3.3.2.cmml" type="integer" xref="A3.SS1.p2.2.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.2.m2.1c">1e^{-4}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.2.m2.1d">1 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> and 4000 linear warm-up steps followed by a cosine decay to <math alttext="1e^{-6}" class="ltx_Math" display="inline" id="A3.SS1.p2.3.m3.1"><semantics id="A3.SS1.p2.3.m3.1a"><mrow id="A3.SS1.p2.3.m3.1.1" xref="A3.SS1.p2.3.m3.1.1.cmml"><mn id="A3.SS1.p2.3.m3.1.1.2" xref="A3.SS1.p2.3.m3.1.1.2.cmml">1</mn><mo id="A3.SS1.p2.3.m3.1.1.1" xref="A3.SS1.p2.3.m3.1.1.1.cmml">⁢</mo><msup id="A3.SS1.p2.3.m3.1.1.3" xref="A3.SS1.p2.3.m3.1.1.3.cmml"><mi id="A3.SS1.p2.3.m3.1.1.3.2" xref="A3.SS1.p2.3.m3.1.1.3.2.cmml">e</mi><mrow id="A3.SS1.p2.3.m3.1.1.3.3" xref="A3.SS1.p2.3.m3.1.1.3.3.cmml"><mo id="A3.SS1.p2.3.m3.1.1.3.3a" xref="A3.SS1.p2.3.m3.1.1.3.3.cmml">−</mo><mn id="A3.SS1.p2.3.m3.1.1.3.3.2" xref="A3.SS1.p2.3.m3.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p2.3.m3.1b"><apply id="A3.SS1.p2.3.m3.1.1.cmml" xref="A3.SS1.p2.3.m3.1.1"><times id="A3.SS1.p2.3.m3.1.1.1.cmml" xref="A3.SS1.p2.3.m3.1.1.1"></times><cn id="A3.SS1.p2.3.m3.1.1.2.cmml" type="integer" xref="A3.SS1.p2.3.m3.1.1.2">1</cn><apply id="A3.SS1.p2.3.m3.1.1.3.cmml" xref="A3.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="A3.SS1.p2.3.m3.1.1.3.1.cmml" xref="A3.SS1.p2.3.m3.1.1.3">superscript</csymbol><ci id="A3.SS1.p2.3.m3.1.1.3.2.cmml" xref="A3.SS1.p2.3.m3.1.1.3.2">𝑒</ci><apply id="A3.SS1.p2.3.m3.1.1.3.3.cmml" xref="A3.SS1.p2.3.m3.1.1.3.3"><minus id="A3.SS1.p2.3.m3.1.1.3.3.1.cmml" xref="A3.SS1.p2.3.m3.1.1.3.3"></minus><cn id="A3.SS1.p2.3.m3.1.1.3.3.2.cmml" type="integer" xref="A3.SS1.p2.3.m3.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p2.3.m3.1c">1e^{-6}</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p2.3.m3.1d">1 italic_e start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math> and train using the AdamW optimizer <cite class="ltx_cite ltx_citemacro_citep">[Loshchilov &amp; Hutter, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib53" title="">2018</a>]</cite>.
Furthermore, we employ gradient clipping of 0.25, weight decay of 0.01, and a dropout rate of 0.2 for all methods.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS1.p3">
<p class="ltx_p" id="A3.SS1.p3.7"><span class="ltx_text ltx_font_bold" id="A3.SS1.p3.7.1">Context Length.</span>
On grid-worlds, we use a context length <math alttext="C" class="ltx_Math" display="inline" id="A3.SS1.p3.1.m1.1"><semantics id="A3.SS1.p3.1.m1.1a"><mi id="A3.SS1.p3.1.m1.1.1" xref="A3.SS1.p3.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.1.m1.1b"><ci id="A3.SS1.p3.1.m1.1.1.cmml" xref="A3.SS1.p3.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.1.m1.1d">italic_C</annotation></semantics></math> equivalent to two 2 episodes for AD, DPT and DT.
For example, on <math alttext="40\times 20" class="ltx_Math" display="inline" id="A3.SS1.p3.2.m2.1"><semantics id="A3.SS1.p3.2.m2.1a"><mrow id="A3.SS1.p3.2.m2.1.1" xref="A3.SS1.p3.2.m2.1.1.cmml"><mn id="A3.SS1.p3.2.m2.1.1.2" xref="A3.SS1.p3.2.m2.1.1.2.cmml">40</mn><mo id="A3.SS1.p3.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.SS1.p3.2.m2.1.1.1.cmml">×</mo><mn id="A3.SS1.p3.2.m2.1.1.3" xref="A3.SS1.p3.2.m2.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.2.m2.1b"><apply id="A3.SS1.p3.2.m2.1.1.cmml" xref="A3.SS1.p3.2.m2.1.1"><times id="A3.SS1.p3.2.m2.1.1.1.cmml" xref="A3.SS1.p3.2.m2.1.1.1"></times><cn id="A3.SS1.p3.2.m2.1.1.2.cmml" type="integer" xref="A3.SS1.p3.2.m2.1.1.2">40</cn><cn id="A3.SS1.p3.2.m2.1.1.3.cmml" type="integer" xref="A3.SS1.p3.2.m2.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.2.m2.1c">40\times 20</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.2.m2.1d">40 × 20</annotation></semantics></math> grids, this results in a sequence length of 6400 (<math alttext="=1600*4" class="ltx_Math" display="inline" id="A3.SS1.p3.3.m3.1"><semantics id="A3.SS1.p3.3.m3.1a"><mrow id="A3.SS1.p3.3.m3.1.1" xref="A3.SS1.p3.3.m3.1.1.cmml"><mi id="A3.SS1.p3.3.m3.1.1.2" xref="A3.SS1.p3.3.m3.1.1.2.cmml"></mi><mo id="A3.SS1.p3.3.m3.1.1.1" xref="A3.SS1.p3.3.m3.1.1.1.cmml">=</mo><mrow id="A3.SS1.p3.3.m3.1.1.3" xref="A3.SS1.p3.3.m3.1.1.3.cmml"><mn id="A3.SS1.p3.3.m3.1.1.3.2" xref="A3.SS1.p3.3.m3.1.1.3.2.cmml">1600</mn><mo id="A3.SS1.p3.3.m3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A3.SS1.p3.3.m3.1.1.3.1.cmml">∗</mo><mn id="A3.SS1.p3.3.m3.1.1.3.3" xref="A3.SS1.p3.3.m3.1.1.3.3.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.3.m3.1b"><apply id="A3.SS1.p3.3.m3.1.1.cmml" xref="A3.SS1.p3.3.m3.1.1"><eq id="A3.SS1.p3.3.m3.1.1.1.cmml" xref="A3.SS1.p3.3.m3.1.1.1"></eq><csymbol cd="latexml" id="A3.SS1.p3.3.m3.1.1.2.cmml" xref="A3.SS1.p3.3.m3.1.1.2">absent</csymbol><apply id="A3.SS1.p3.3.m3.1.1.3.cmml" xref="A3.SS1.p3.3.m3.1.1.3"><times id="A3.SS1.p3.3.m3.1.1.3.1.cmml" xref="A3.SS1.p3.3.m3.1.1.3.1"></times><cn id="A3.SS1.p3.3.m3.1.1.3.2.cmml" type="integer" xref="A3.SS1.p3.3.m3.1.1.3.2">1600</cn><cn id="A3.SS1.p3.3.m3.1.1.3.3.cmml" type="integer" xref="A3.SS1.p3.3.m3.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.3.m3.1c">=1600*4</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.3.m3.1d">= 1600 ∗ 4</annotation></semantics></math> for state/action/reward/RTG) for the DT and a sequence length of 4800 for AD.
On Meta-World, DMControl and Procgen, we reduce the sequence context length to 50 steps for DT.
For RA-DT, we use a shorter context length of <math alttext="C=50" class="ltx_Math" display="inline" id="A3.SS1.p3.4.m4.1"><semantics id="A3.SS1.p3.4.m4.1a"><mrow id="A3.SS1.p3.4.m4.1.1" xref="A3.SS1.p3.4.m4.1.1.cmml"><mi id="A3.SS1.p3.4.m4.1.1.2" xref="A3.SS1.p3.4.m4.1.1.2.cmml">C</mi><mo id="A3.SS1.p3.4.m4.1.1.1" xref="A3.SS1.p3.4.m4.1.1.1.cmml">=</mo><mn id="A3.SS1.p3.4.m4.1.1.3" xref="A3.SS1.p3.4.m4.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.4.m4.1b"><apply id="A3.SS1.p3.4.m4.1.1.cmml" xref="A3.SS1.p3.4.m4.1.1"><eq id="A3.SS1.p3.4.m4.1.1.1.cmml" xref="A3.SS1.p3.4.m4.1.1.1"></eq><ci id="A3.SS1.p3.4.m4.1.1.2.cmml" xref="A3.SS1.p3.4.m4.1.1.2">𝐶</ci><cn id="A3.SS1.p3.4.m4.1.1.3.cmml" type="integer" xref="A3.SS1.p3.4.m4.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.4.m4.1c">C=50</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.4.m4.1d">italic_C = 50</annotation></semantics></math> transitions across environments, except for <math alttext="20\times 20" class="ltx_Math" display="inline" id="A3.SS1.p3.5.m5.1"><semantics id="A3.SS1.p3.5.m5.1a"><mrow id="A3.SS1.p3.5.m5.1.1" xref="A3.SS1.p3.5.m5.1.1.cmml"><mn id="A3.SS1.p3.5.m5.1.1.2" xref="A3.SS1.p3.5.m5.1.1.2.cmml">20</mn><mo id="A3.SS1.p3.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.SS1.p3.5.m5.1.1.1.cmml">×</mo><mn id="A3.SS1.p3.5.m5.1.1.3" xref="A3.SS1.p3.5.m5.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.5.m5.1b"><apply id="A3.SS1.p3.5.m5.1.1.cmml" xref="A3.SS1.p3.5.m5.1.1"><times id="A3.SS1.p3.5.m5.1.1.1.cmml" xref="A3.SS1.p3.5.m5.1.1.1"></times><cn id="A3.SS1.p3.5.m5.1.1.2.cmml" type="integer" xref="A3.SS1.p3.5.m5.1.1.2">20</cn><cn id="A3.SS1.p3.5.m5.1.1.3.cmml" type="integer" xref="A3.SS1.p3.5.m5.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.5.m5.1c">20\times 20</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.5.m5.1d">20 × 20</annotation></semantics></math> and <math alttext="40\times 20" class="ltx_Math" display="inline" id="A3.SS1.p3.6.m6.1"><semantics id="A3.SS1.p3.6.m6.1a"><mrow id="A3.SS1.p3.6.m6.1.1" xref="A3.SS1.p3.6.m6.1.1.cmml"><mn id="A3.SS1.p3.6.m6.1.1.2" xref="A3.SS1.p3.6.m6.1.1.2.cmml">40</mn><mo id="A3.SS1.p3.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.SS1.p3.6.m6.1.1.1.cmml">×</mo><mn id="A3.SS1.p3.6.m6.1.1.3" xref="A3.SS1.p3.6.m6.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.6.m6.1b"><apply id="A3.SS1.p3.6.m6.1.1.cmml" xref="A3.SS1.p3.6.m6.1.1"><times id="A3.SS1.p3.6.m6.1.1.1.cmml" xref="A3.SS1.p3.6.m6.1.1.1"></times><cn id="A3.SS1.p3.6.m6.1.1.2.cmml" type="integer" xref="A3.SS1.p3.6.m6.1.1.2">40</cn><cn id="A3.SS1.p3.6.m6.1.1.3.cmml" type="integer" xref="A3.SS1.p3.6.m6.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.6.m6.1c">40\times 20</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.6.m6.1d">40 × 20</annotation></semantics></math> grids, where we increase the context length to 100.
We want to highlight, that the context length for RA-DT applies to both the input context and the retrieved context.
The retrieved context contains the past, and future context, as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS1" title="3.2.1 Vector Index for Retrieval Augmentation ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>.
Consequently, the effective context length of RA-DT is <math alttext="C+2*C" class="ltx_Math" display="inline" id="A3.SS1.p3.7.m7.1"><semantics id="A3.SS1.p3.7.m7.1a"><mrow id="A3.SS1.p3.7.m7.1.1" xref="A3.SS1.p3.7.m7.1.1.cmml"><mi id="A3.SS1.p3.7.m7.1.1.2" xref="A3.SS1.p3.7.m7.1.1.2.cmml">C</mi><mo id="A3.SS1.p3.7.m7.1.1.1" xref="A3.SS1.p3.7.m7.1.1.1.cmml">+</mo><mrow id="A3.SS1.p3.7.m7.1.1.3" xref="A3.SS1.p3.7.m7.1.1.3.cmml"><mn id="A3.SS1.p3.7.m7.1.1.3.2" xref="A3.SS1.p3.7.m7.1.1.3.2.cmml">2</mn><mo id="A3.SS1.p3.7.m7.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A3.SS1.p3.7.m7.1.1.3.1.cmml">∗</mo><mi id="A3.SS1.p3.7.m7.1.1.3.3" xref="A3.SS1.p3.7.m7.1.1.3.3.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p3.7.m7.1b"><apply id="A3.SS1.p3.7.m7.1.1.cmml" xref="A3.SS1.p3.7.m7.1.1"><plus id="A3.SS1.p3.7.m7.1.1.1.cmml" xref="A3.SS1.p3.7.m7.1.1.1"></plus><ci id="A3.SS1.p3.7.m7.1.1.2.cmml" xref="A3.SS1.p3.7.m7.1.1.2">𝐶</ci><apply id="A3.SS1.p3.7.m7.1.1.3.cmml" xref="A3.SS1.p3.7.m7.1.1.3"><times id="A3.SS1.p3.7.m7.1.1.3.1.cmml" xref="A3.SS1.p3.7.m7.1.1.3.1"></times><cn id="A3.SS1.p3.7.m7.1.1.3.2.cmml" type="integer" xref="A3.SS1.p3.7.m7.1.1.3.2">2</cn><ci id="A3.SS1.p3.7.m7.1.1.3.3.cmml" xref="A3.SS1.p3.7.m7.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p3.7.m7.1c">C+2*C</annotation><annotation encoding="application/x-llamapun" id="A3.SS1.p3.7.m7.1d">italic_C + 2 ∗ italic_C</annotation></semantics></math> and is independent of the episode length.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS1.p4">
<p class="ltx_p" id="A3.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="A3.SS1.p4.1.1">Network Architecture.</span>
For all environments, except for Procgen, we use a GPT2-like network architecture <cite class="ltx_cite ltx_citemacro_citep">[Radford et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib69" title="">2019</a>]</cite> with 4 Transformer layers, 8 head and hidden dimension of 512, which results in 16M parameters.
On Procgen, we use a larger model with 6 Transformer blocks, 12 heads and hidden dimension of 768.
States, actions, rewards and RTGs are embedded using separate embedding layers per modality, as proposed by <cite class="ltx_cite ltx_citemacro_citet">Chen et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib13" title="">2021</a>]</cite>.
For all modalities and environments, we use standard linear layers to embed the inputs.
Procgen is again an exception, where we use the convolutional architecture proposed by <cite class="ltx_cite ltx_citemacro_citet">Espeholt et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib20" title="">2018</a>]</cite> and adopted in prior works <cite class="ltx_cite ltx_citemacro_citep">[Cobbe et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib14" title="">2020</a>; Schmidt &amp; Schmied, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib80" title="">2021</a>; Schwarzer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib83" title="">2023</a>]</cite>.
Processing image-sequences is computationally demanding.
Therefore, we first pre-train the vision-encoder using a separate DT and embed all images in the dataset using the learned vision encoder.
Therefore, the data-loading is not bottlenecked by loading entire images into memory, but only their compact representations.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS1.p5">
<p class="ltx_p" id="A3.SS1.p5.1">Furthermore, we use global positional embeddings.
We also experimented with the Transformer++ recipe (RoPE, SwiGLU, RMSNorm), but only observed minimal performance gains for our problem setting.
To speed-up training, we use mixed-precision <cite class="ltx_cite ltx_citemacro_cite">Micikevicius et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib56" title="">2017</a>]</cite>, model compilation as supported in PyTorch <cite class="ltx_cite ltx_citemacro_citep">[Paszke et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib65" title="">2019</a>]</cite>, and FlashAttention <cite class="ltx_cite ltx_citemacro_citep">[Dao, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib15" title="">2023</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS1.p6">
<p class="ltx_p" id="A3.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="A3.SS1.p6.1.1">Implementation</span>.
Our implementation of the DT is based on the <span class="ltx_text ltx_font_typewriter" id="A3.SS1.p6.1.2">transformers</span> library <cite class="ltx_cite ltx_citemacro_citep">[Wolf et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib98" title="">2020</a>]</cite> and <span class="ltx_text ltx_font_typewriter" id="A3.SS1.p6.1.3">stable-baselines3</span> <cite class="ltx_cite ltx_citemacro_citep">[Raffin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib70" title="">2021</a>]</cite>.
We integrated AD, DPT, and RA-DT on top of this implementation.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS1.p7">
<p class="ltx_p" id="A3.SS1.p7.1"><span class="ltx_text ltx_font_bold" id="A3.SS1.p7.1.1">Hardware &amp; Training Times</span>.
We run all our experiments on a server equipped with 4 A100 GPUs.
For most of our experiments, we only use a single A100.
Depending on the environment and method used, training times range from one hour (Dark-Room, DT) to 20 hours (DMControl, AD) for a single training run.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Decision Transformer</h3>
<div class="ltx_para ltx_noindent" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.6">For Dark-Room and Dark Key-Door, we sample the target return for RTG conditioning before every episode <math alttext="\mathcal{N}(90,5)" class="ltx_Math" display="inline" id="A3.SS2.p1.1.m1.2"><semantics id="A3.SS2.p1.1.m1.2a"><mrow id="A3.SS2.p1.1.m1.2.3" xref="A3.SS2.p1.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p1.1.m1.2.3.2" xref="A3.SS2.p1.1.m1.2.3.2.cmml">𝒩</mi><mo id="A3.SS2.p1.1.m1.2.3.1" xref="A3.SS2.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="A3.SS2.p1.1.m1.2.3.3.2" xref="A3.SS2.p1.1.m1.2.3.3.1.cmml"><mo id="A3.SS2.p1.1.m1.2.3.3.2.1" stretchy="false" xref="A3.SS2.p1.1.m1.2.3.3.1.cmml">(</mo><mn id="A3.SS2.p1.1.m1.1.1" xref="A3.SS2.p1.1.m1.1.1.cmml">90</mn><mo id="A3.SS2.p1.1.m1.2.3.3.2.2" xref="A3.SS2.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="A3.SS2.p1.1.m1.2.2" xref="A3.SS2.p1.1.m1.2.2.cmml">5</mn><mo id="A3.SS2.p1.1.m1.2.3.3.2.3" stretchy="false" xref="A3.SS2.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.1.m1.2b"><apply id="A3.SS2.p1.1.m1.2.3.cmml" xref="A3.SS2.p1.1.m1.2.3"><times id="A3.SS2.p1.1.m1.2.3.1.cmml" xref="A3.SS2.p1.1.m1.2.3.1"></times><ci id="A3.SS2.p1.1.m1.2.3.2.cmml" xref="A3.SS2.p1.1.m1.2.3.2">𝒩</ci><interval closure="open" id="A3.SS2.p1.1.m1.2.3.3.1.cmml" xref="A3.SS2.p1.1.m1.2.3.3.2"><cn id="A3.SS2.p1.1.m1.1.1.cmml" type="integer" xref="A3.SS2.p1.1.m1.1.1">90</cn><cn id="A3.SS2.p1.1.m1.2.2.cmml" type="integer" xref="A3.SS2.p1.1.m1.2.2">5</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.1.m1.2c">\mathcal{N}(90,5)</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.1.m1.2d">caligraphic_N ( 90 , 5 )</annotation></semantics></math>, <math alttext="\mathcal{N}(370,10)" class="ltx_Math" display="inline" id="A3.SS2.p1.2.m2.2"><semantics id="A3.SS2.p1.2.m2.2a"><mrow id="A3.SS2.p1.2.m2.2.3" xref="A3.SS2.p1.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p1.2.m2.2.3.2" xref="A3.SS2.p1.2.m2.2.3.2.cmml">𝒩</mi><mo id="A3.SS2.p1.2.m2.2.3.1" xref="A3.SS2.p1.2.m2.2.3.1.cmml">⁢</mo><mrow id="A3.SS2.p1.2.m2.2.3.3.2" xref="A3.SS2.p1.2.m2.2.3.3.1.cmml"><mo id="A3.SS2.p1.2.m2.2.3.3.2.1" stretchy="false" xref="A3.SS2.p1.2.m2.2.3.3.1.cmml">(</mo><mn id="A3.SS2.p1.2.m2.1.1" xref="A3.SS2.p1.2.m2.1.1.cmml">370</mn><mo id="A3.SS2.p1.2.m2.2.3.3.2.2" xref="A3.SS2.p1.2.m2.2.3.3.1.cmml">,</mo><mn id="A3.SS2.p1.2.m2.2.2" xref="A3.SS2.p1.2.m2.2.2.cmml">10</mn><mo id="A3.SS2.p1.2.m2.2.3.3.2.3" stretchy="false" xref="A3.SS2.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.2.m2.2b"><apply id="A3.SS2.p1.2.m2.2.3.cmml" xref="A3.SS2.p1.2.m2.2.3"><times id="A3.SS2.p1.2.m2.2.3.1.cmml" xref="A3.SS2.p1.2.m2.2.3.1"></times><ci id="A3.SS2.p1.2.m2.2.3.2.cmml" xref="A3.SS2.p1.2.m2.2.3.2">𝒩</ci><interval closure="open" id="A3.SS2.p1.2.m2.2.3.3.1.cmml" xref="A3.SS2.p1.2.m2.2.3.3.2"><cn id="A3.SS2.p1.2.m2.1.1.cmml" type="integer" xref="A3.SS2.p1.2.m2.1.1">370</cn><cn id="A3.SS2.p1.2.m2.2.2.cmml" type="integer" xref="A3.SS2.p1.2.m2.2.2">10</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.2.m2.2c">\mathcal{N}(370,10)</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.2.m2.2d">caligraphic_N ( 370 , 10 )</annotation></semantics></math>, and <math alttext="\mathcal{N}(500,10)" class="ltx_Math" display="inline" id="A3.SS2.p1.3.m3.2"><semantics id="A3.SS2.p1.3.m3.2a"><mrow id="A3.SS2.p1.3.m3.2.3" xref="A3.SS2.p1.3.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS2.p1.3.m3.2.3.2" xref="A3.SS2.p1.3.m3.2.3.2.cmml">𝒩</mi><mo id="A3.SS2.p1.3.m3.2.3.1" xref="A3.SS2.p1.3.m3.2.3.1.cmml">⁢</mo><mrow id="A3.SS2.p1.3.m3.2.3.3.2" xref="A3.SS2.p1.3.m3.2.3.3.1.cmml"><mo id="A3.SS2.p1.3.m3.2.3.3.2.1" stretchy="false" xref="A3.SS2.p1.3.m3.2.3.3.1.cmml">(</mo><mn id="A3.SS2.p1.3.m3.1.1" xref="A3.SS2.p1.3.m3.1.1.cmml">500</mn><mo id="A3.SS2.p1.3.m3.2.3.3.2.2" xref="A3.SS2.p1.3.m3.2.3.3.1.cmml">,</mo><mn id="A3.SS2.p1.3.m3.2.2" xref="A3.SS2.p1.3.m3.2.2.cmml">10</mn><mo id="A3.SS2.p1.3.m3.2.3.3.2.3" stretchy="false" xref="A3.SS2.p1.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.3.m3.2b"><apply id="A3.SS2.p1.3.m3.2.3.cmml" xref="A3.SS2.p1.3.m3.2.3"><times id="A3.SS2.p1.3.m3.2.3.1.cmml" xref="A3.SS2.p1.3.m3.2.3.1"></times><ci id="A3.SS2.p1.3.m3.2.3.2.cmml" xref="A3.SS2.p1.3.m3.2.3.2">𝒩</ci><interval closure="open" id="A3.SS2.p1.3.m3.2.3.3.1.cmml" xref="A3.SS2.p1.3.m3.2.3.3.2"><cn id="A3.SS2.p1.3.m3.1.1.cmml" type="integer" xref="A3.SS2.p1.3.m3.1.1">500</cn><cn id="A3.SS2.p1.3.m3.2.2.cmml" type="integer" xref="A3.SS2.p1.3.m3.2.2">10</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.3.m3.2c">\mathcal{N}(500,10)</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.3.m3.2d">caligraphic_N ( 500 , 10 )</annotation></semantics></math> for grid sizes <math alttext="10\times 10" class="ltx_Math" display="inline" id="A3.SS2.p1.4.m4.1"><semantics id="A3.SS2.p1.4.m4.1a"><mrow id="A3.SS2.p1.4.m4.1.1" xref="A3.SS2.p1.4.m4.1.1.cmml"><mn id="A3.SS2.p1.4.m4.1.1.2" xref="A3.SS2.p1.4.m4.1.1.2.cmml">10</mn><mo id="A3.SS2.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.SS2.p1.4.m4.1.1.1.cmml">×</mo><mn id="A3.SS2.p1.4.m4.1.1.3" xref="A3.SS2.p1.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.4.m4.1b"><apply id="A3.SS2.p1.4.m4.1.1.cmml" xref="A3.SS2.p1.4.m4.1.1"><times id="A3.SS2.p1.4.m4.1.1.1.cmml" xref="A3.SS2.p1.4.m4.1.1.1"></times><cn id="A3.SS2.p1.4.m4.1.1.2.cmml" type="integer" xref="A3.SS2.p1.4.m4.1.1.2">10</cn><cn id="A3.SS2.p1.4.m4.1.1.3.cmml" type="integer" xref="A3.SS2.p1.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.4.m4.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.4.m4.1d">10 × 10</annotation></semantics></math>, <math alttext="20\times 20" class="ltx_Math" display="inline" id="A3.SS2.p1.5.m5.1"><semantics id="A3.SS2.p1.5.m5.1a"><mrow id="A3.SS2.p1.5.m5.1.1" xref="A3.SS2.p1.5.m5.1.1.cmml"><mn id="A3.SS2.p1.5.m5.1.1.2" xref="A3.SS2.p1.5.m5.1.1.2.cmml">20</mn><mo id="A3.SS2.p1.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.SS2.p1.5.m5.1.1.1.cmml">×</mo><mn id="A3.SS2.p1.5.m5.1.1.3" xref="A3.SS2.p1.5.m5.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.5.m5.1b"><apply id="A3.SS2.p1.5.m5.1.1.cmml" xref="A3.SS2.p1.5.m5.1.1"><times id="A3.SS2.p1.5.m5.1.1.1.cmml" xref="A3.SS2.p1.5.m5.1.1.1"></times><cn id="A3.SS2.p1.5.m5.1.1.2.cmml" type="integer" xref="A3.SS2.p1.5.m5.1.1.2">20</cn><cn id="A3.SS2.p1.5.m5.1.1.3.cmml" type="integer" xref="A3.SS2.p1.5.m5.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.5.m5.1c">20\times 20</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.5.m5.1d">20 × 20</annotation></semantics></math>, and <math alttext="40\times 20" class="ltx_Math" display="inline" id="A3.SS2.p1.6.m6.1"><semantics id="A3.SS2.p1.6.m6.1a"><mrow id="A3.SS2.p1.6.m6.1.1" xref="A3.SS2.p1.6.m6.1.1.cmml"><mn id="A3.SS2.p1.6.m6.1.1.2" xref="A3.SS2.p1.6.m6.1.1.2.cmml">40</mn><mo id="A3.SS2.p1.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.SS2.p1.6.m6.1.1.1.cmml">×</mo><mn id="A3.SS2.p1.6.m6.1.1.3" xref="A3.SS2.p1.6.m6.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS2.p1.6.m6.1b"><apply id="A3.SS2.p1.6.m6.1.1.cmml" xref="A3.SS2.p1.6.m6.1.1"><times id="A3.SS2.p1.6.m6.1.1.1.cmml" xref="A3.SS2.p1.6.m6.1.1.1"></times><cn id="A3.SS2.p1.6.m6.1.1.2.cmml" type="integer" xref="A3.SS2.p1.6.m6.1.1.2">40</cn><cn id="A3.SS2.p1.6.m6.1.1.3.cmml" type="integer" xref="A3.SS2.p1.6.m6.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p1.6.m6.1c">40\times 20</annotation><annotation encoding="application/x-llamapun" id="A3.SS2.p1.6.m6.1d">40 × 20</annotation></semantics></math>, respectively.
On grid-worlds, we found that sampling the target return performs better than using a fixed target return per grid size.
We assume this is, because specifying a particular target return biases the DT towards particular goal locations.
For MazeRunner, we use a constant target return of 3.
For Meta-World, DMControl, and Procgen, we set the target return the maximum return achieved for a particular task in the training datasets.
However, we also found that constant target returns per domain work decently.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Algorithm Distillation</h3>
<div class="ltx_para ltx_noindent" id="A3.SS3.p1">
<p class="ltx_p" id="A3.SS3.p1.5">AD obtains a context trajectory and learns to predict actions of an input trajectory taken <math alttext="K" class="ltx_Math" display="inline" id="A3.SS3.p1.1.m1.1"><semantics id="A3.SS3.p1.1.m1.1a"><mi id="A3.SS3.p1.1.m1.1.1" xref="A3.SS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.1.m1.1b"><ci id="A3.SS3.p1.1.m1.1.1.cmml" xref="A3.SS3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.1.m1.1d">italic_K</annotation></semantics></math> episodes later.
Therefore, we tune <math alttext="K" class="ltx_Math" display="inline" id="A3.SS3.p1.2.m2.1"><semantics id="A3.SS3.p1.2.m2.1a"><mi id="A3.SS3.p1.2.m2.1.1" xref="A3.SS3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.2.m2.1b"><ci id="A3.SS3.p1.2.m2.1.1.cmml" xref="A3.SS3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.2.m2.1d">italic_K</annotation></semantics></math> per domain.
On grid-worlds, we found <math alttext="K=100" class="ltx_Math" display="inline" id="A3.SS3.p1.3.m3.1"><semantics id="A3.SS3.p1.3.m3.1a"><mrow id="A3.SS3.p1.3.m3.1.1" xref="A3.SS3.p1.3.m3.1.1.cmml"><mi id="A3.SS3.p1.3.m3.1.1.2" xref="A3.SS3.p1.3.m3.1.1.2.cmml">K</mi><mo id="A3.SS3.p1.3.m3.1.1.1" xref="A3.SS3.p1.3.m3.1.1.1.cmml">=</mo><mn id="A3.SS3.p1.3.m3.1.1.3" xref="A3.SS3.p1.3.m3.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.3.m3.1b"><apply id="A3.SS3.p1.3.m3.1.1.cmml" xref="A3.SS3.p1.3.m3.1.1"><eq id="A3.SS3.p1.3.m3.1.1.1.cmml" xref="A3.SS3.p1.3.m3.1.1.1"></eq><ci id="A3.SS3.p1.3.m3.1.1.2.cmml" xref="A3.SS3.p1.3.m3.1.1.2">𝐾</ci><cn id="A3.SS3.p1.3.m3.1.1.3.cmml" type="integer" xref="A3.SS3.p1.3.m3.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.3.m3.1c">K=100</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.3.m3.1d">italic_K = 100</annotation></semantics></math> to perform the best, similar to <cite class="ltx_cite ltx_citemacro_citet">Lee et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib46" title="">2023</a>]</cite>.
For MazeRunner and Meta-World, we set <math alttext="K=1000" class="ltx_Math" display="inline" id="A3.SS3.p1.4.m4.1"><semantics id="A3.SS3.p1.4.m4.1a"><mrow id="A3.SS3.p1.4.m4.1.1" xref="A3.SS3.p1.4.m4.1.1.cmml"><mi id="A3.SS3.p1.4.m4.1.1.2" xref="A3.SS3.p1.4.m4.1.1.2.cmml">K</mi><mo id="A3.SS3.p1.4.m4.1.1.1" xref="A3.SS3.p1.4.m4.1.1.1.cmml">=</mo><mn id="A3.SS3.p1.4.m4.1.1.3" xref="A3.SS3.p1.4.m4.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.4.m4.1b"><apply id="A3.SS3.p1.4.m4.1.1.cmml" xref="A3.SS3.p1.4.m4.1.1"><eq id="A3.SS3.p1.4.m4.1.1.1.cmml" xref="A3.SS3.p1.4.m4.1.1.1"></eq><ci id="A3.SS3.p1.4.m4.1.1.2.cmml" xref="A3.SS3.p1.4.m4.1.1.2">𝐾</ci><cn id="A3.SS3.p1.4.m4.1.1.3.cmml" type="integer" xref="A3.SS3.p1.4.m4.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.4.m4.1c">K=1000</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.4.m4.1d">italic_K = 1000</annotation></semantics></math>, and for DMControl and Procgen, we set <math alttext="K=250" class="ltx_Math" display="inline" id="A3.SS3.p1.5.m5.1"><semantics id="A3.SS3.p1.5.m5.1a"><mrow id="A3.SS3.p1.5.m5.1.1" xref="A3.SS3.p1.5.m5.1.1.cmml"><mi id="A3.SS3.p1.5.m5.1.1.2" xref="A3.SS3.p1.5.m5.1.1.2.cmml">K</mi><mo id="A3.SS3.p1.5.m5.1.1.1" xref="A3.SS3.p1.5.m5.1.1.1.cmml">=</mo><mn id="A3.SS3.p1.5.m5.1.1.3" xref="A3.SS3.p1.5.m5.1.1.3.cmml">250</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS3.p1.5.m5.1b"><apply id="A3.SS3.p1.5.m5.1.1.cmml" xref="A3.SS3.p1.5.m5.1.1"><eq id="A3.SS3.p1.5.m5.1.1.1.cmml" xref="A3.SS3.p1.5.m5.1.1.1"></eq><ci id="A3.SS3.p1.5.m5.1.1.2.cmml" xref="A3.SS3.p1.5.m5.1.1.2">𝐾</ci><cn id="A3.SS3.p1.5.m5.1.1.3.cmml" type="integer" xref="A3.SS3.p1.5.m5.1.1.3">250</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS3.p1.5.m5.1c">K=250</annotation><annotation encoding="application/x-llamapun" id="A3.SS3.p1.5.m5.1d">italic_K = 250</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.4 </span>Retrieval-Augmented Decision Transformer</h3>
<div class="ltx_para ltx_noindent" id="A3.SS4.p1">
<p class="ltx_p" id="A3.SS4.p1.4"><span class="ltx_text ltx_font_bold" id="A3.SS4.p1.4.1">Embedding Model.</span>
For the embedding model <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="A3.SS4.p1.1.m1.1"><semantics id="A3.SS4.p1.1.m1.1a"><mrow id="A3.SS4.p1.1.m1.1.2" xref="A3.SS4.p1.1.m1.1.2.cmml"><mi id="A3.SS4.p1.1.m1.1.2.2" xref="A3.SS4.p1.1.m1.1.2.2.cmml">g</mi><mo id="A3.SS4.p1.1.m1.1.2.1" xref="A3.SS4.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="A3.SS4.p1.1.m1.1.2.3.2" xref="A3.SS4.p1.1.m1.1.2.cmml"><mo id="A3.SS4.p1.1.m1.1.2.3.2.1" stretchy="false" xref="A3.SS4.p1.1.m1.1.2.cmml">(</mo><mo id="A3.SS4.p1.1.m1.1.1" lspace="0em" rspace="0em" xref="A3.SS4.p1.1.m1.1.1.cmml">⋅</mo><mo id="A3.SS4.p1.1.m1.1.2.3.2.2" stretchy="false" xref="A3.SS4.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.1.m1.1b"><apply id="A3.SS4.p1.1.m1.1.2.cmml" xref="A3.SS4.p1.1.m1.1.2"><times id="A3.SS4.p1.1.m1.1.2.1.cmml" xref="A3.SS4.p1.1.m1.1.2.1"></times><ci id="A3.SS4.p1.1.m1.1.2.2.cmml" xref="A3.SS4.p1.1.m1.1.2.2">𝑔</ci><ci id="A3.SS4.p1.1.m1.1.1.cmml" xref="A3.SS4.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.1.m1.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.1.m1.1d">italic_g ( ⋅ )</annotation></semantics></math>, we either use a DT pre-trained on the same environment with the same hyperparameters as listed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3" title="Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">C</span></a>, or a pre-trained and frozen LM.
For the pre-trained LM, we use <span class="ltx_text ltx_font_typewriter" id="A3.SS4.p1.4.2">bert-base-uncased</span> from the <span class="ltx_text ltx_font_typewriter" id="A3.SS4.p1.4.3">transformers</span> library by default.
BERT is an encoder-only LM with 110M parameters, vocabulary size <math alttext="v=30522" class="ltx_Math" display="inline" id="A3.SS4.p1.2.m2.1"><semantics id="A3.SS4.p1.2.m2.1a"><mrow id="A3.SS4.p1.2.m2.1.1" xref="A3.SS4.p1.2.m2.1.1.cmml"><mi id="A3.SS4.p1.2.m2.1.1.2" xref="A3.SS4.p1.2.m2.1.1.2.cmml">v</mi><mo id="A3.SS4.p1.2.m2.1.1.1" xref="A3.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="A3.SS4.p1.2.m2.1.1.3" xref="A3.SS4.p1.2.m2.1.1.3.cmml">30522</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.2.m2.1b"><apply id="A3.SS4.p1.2.m2.1.1.cmml" xref="A3.SS4.p1.2.m2.1.1"><eq id="A3.SS4.p1.2.m2.1.1.1.cmml" xref="A3.SS4.p1.2.m2.1.1.1"></eq><ci id="A3.SS4.p1.2.m2.1.1.2.cmml" xref="A3.SS4.p1.2.m2.1.1.2">𝑣</ci><cn id="A3.SS4.p1.2.m2.1.1.3.cmml" type="integer" xref="A3.SS4.p1.2.m2.1.1.3">30522</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.2.m2.1c">v=30522</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.2.m2.1d">italic_v = 30522</annotation></semantics></math>, and embedding dimension of <math alttext="d_{\text{LM}}=768" class="ltx_Math" display="inline" id="A3.SS4.p1.3.m3.1"><semantics id="A3.SS4.p1.3.m3.1a"><mrow id="A3.SS4.p1.3.m3.1.1" xref="A3.SS4.p1.3.m3.1.1.cmml"><msub id="A3.SS4.p1.3.m3.1.1.2" xref="A3.SS4.p1.3.m3.1.1.2.cmml"><mi id="A3.SS4.p1.3.m3.1.1.2.2" xref="A3.SS4.p1.3.m3.1.1.2.2.cmml">d</mi><mtext id="A3.SS4.p1.3.m3.1.1.2.3" xref="A3.SS4.p1.3.m3.1.1.2.3a.cmml">LM</mtext></msub><mo id="A3.SS4.p1.3.m3.1.1.1" xref="A3.SS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="A3.SS4.p1.3.m3.1.1.3" xref="A3.SS4.p1.3.m3.1.1.3.cmml">768</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.3.m3.1b"><apply id="A3.SS4.p1.3.m3.1.1.cmml" xref="A3.SS4.p1.3.m3.1.1"><eq id="A3.SS4.p1.3.m3.1.1.1.cmml" xref="A3.SS4.p1.3.m3.1.1.1"></eq><apply id="A3.SS4.p1.3.m3.1.1.2.cmml" xref="A3.SS4.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A3.SS4.p1.3.m3.1.1.2.1.cmml" xref="A3.SS4.p1.3.m3.1.1.2">subscript</csymbol><ci id="A3.SS4.p1.3.m3.1.1.2.2.cmml" xref="A3.SS4.p1.3.m3.1.1.2.2">𝑑</ci><ci id="A3.SS4.p1.3.m3.1.1.2.3a.cmml" xref="A3.SS4.p1.3.m3.1.1.2.3"><mtext id="A3.SS4.p1.3.m3.1.1.2.3.cmml" mathsize="70%" xref="A3.SS4.p1.3.m3.1.1.2.3">LM</mtext></ci></apply><cn id="A3.SS4.p1.3.m3.1.1.3.cmml" type="integer" xref="A3.SS4.p1.3.m3.1.1.3">768</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.3.m3.1c">d_{\text{LM}}=768</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.3.m3.1d">italic_d start_POSTSUBSCRIPT LM end_POSTSUBSCRIPT = 768</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">[Devlin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib16" title="">2019</a>]</cite>.
We apply FrozenHopfield with <math alttext="\beta=10" class="ltx_Math" display="inline" id="A3.SS4.p1.4.m4.1"><semantics id="A3.SS4.p1.4.m4.1a"><mrow id="A3.SS4.p1.4.m4.1.1" xref="A3.SS4.p1.4.m4.1.1.cmml"><mi id="A3.SS4.p1.4.m4.1.1.2" xref="A3.SS4.p1.4.m4.1.1.2.cmml">β</mi><mo id="A3.SS4.p1.4.m4.1.1.1" xref="A3.SS4.p1.4.m4.1.1.1.cmml">=</mo><mn id="A3.SS4.p1.4.m4.1.1.3" xref="A3.SS4.p1.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.4.m4.1b"><apply id="A3.SS4.p1.4.m4.1.1.cmml" xref="A3.SS4.p1.4.m4.1.1"><eq id="A3.SS4.p1.4.m4.1.1.1.cmml" xref="A3.SS4.p1.4.m4.1.1.1"></eq><ci id="A3.SS4.p1.4.m4.1.1.2.cmml" xref="A3.SS4.p1.4.m4.1.1.2">𝛽</ci><cn id="A3.SS4.p1.4.m4.1.1.3.cmml" type="integer" xref="A3.SS4.p1.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.4.m4.1c">\beta=10</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p1.4.m4.1d">italic_β = 10</annotation></semantics></math> to state, action, reward and RTG tokens (see Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.E2" title="In 3.2.1 Vector Index for Retrieval Augmentation ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">2</span></a>).
To achieve this, we one-hot encode all discrete input tokens, such as actions in Dark-Room/MazeRunner/Procgen or states in Dark-Room, and rewards/RTGs in the sequence before applying the FH.
For other tokens, such as continuous states/actions as in Meta-World/DMControl, we directly apply the FH.
We evaluate other alternatives for the LM in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5" title="Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS4.p2">
<p class="ltx_p" id="A3.SS4.p2.17"><span class="ltx_text ltx_font_bold" id="A3.SS4.p2.17.1">Constructing queries/keys/values.</span>
Regardless of whether <math alttext="g" class="ltx_Math" display="inline" id="A3.SS4.p2.1.m1.1"><semantics id="A3.SS4.p2.1.m1.1a"><mi id="A3.SS4.p2.1.m1.1.1" xref="A3.SS4.p2.1.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.1.m1.1b"><ci id="A3.SS4.p2.1.m1.1.1.cmml" xref="A3.SS4.p2.1.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.1.m1.1c">g</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.1.m1.1d">italic_g</annotation></semantics></math> is domain-specific or domain-agnostic, we obtain <math alttext="C" class="ltx_Math" display="inline" id="A3.SS4.p2.2.m2.1"><semantics id="A3.SS4.p2.2.m2.1a"><mi id="A3.SS4.p2.2.m2.1.1" xref="A3.SS4.p2.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.2.m2.1b"><ci id="A3.SS4.p2.2.m2.1.1.cmml" xref="A3.SS4.p2.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.2.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.2.m2.1d">italic_C</annotation></semantics></math> embedded tokens after applying <math alttext="g" class="ltx_Math" display="inline" id="A3.SS4.p2.3.m3.1"><semantics id="A3.SS4.p2.3.m3.1a"><mi id="A3.SS4.p2.3.m3.1.1" xref="A3.SS4.p2.3.m3.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.3.m3.1b"><ci id="A3.SS4.p2.3.m3.1.1.cmml" xref="A3.SS4.p2.3.m3.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.3.m3.1c">g</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.3.m3.1d">italic_g</annotation></semantics></math> to the input trajectory <math alttext="\tau_{in}" class="ltx_Math" display="inline" id="A3.SS4.p2.4.m4.1"><semantics id="A3.SS4.p2.4.m4.1a"><msub id="A3.SS4.p2.4.m4.1.1" xref="A3.SS4.p2.4.m4.1.1.cmml"><mi id="A3.SS4.p2.4.m4.1.1.2" xref="A3.SS4.p2.4.m4.1.1.2.cmml">τ</mi><mrow id="A3.SS4.p2.4.m4.1.1.3" xref="A3.SS4.p2.4.m4.1.1.3.cmml"><mi id="A3.SS4.p2.4.m4.1.1.3.2" xref="A3.SS4.p2.4.m4.1.1.3.2.cmml">i</mi><mo id="A3.SS4.p2.4.m4.1.1.3.1" xref="A3.SS4.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A3.SS4.p2.4.m4.1.1.3.3" xref="A3.SS4.p2.4.m4.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.4.m4.1b"><apply id="A3.SS4.p2.4.m4.1.1.cmml" xref="A3.SS4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A3.SS4.p2.4.m4.1.1.1.cmml" xref="A3.SS4.p2.4.m4.1.1">subscript</csymbol><ci id="A3.SS4.p2.4.m4.1.1.2.cmml" xref="A3.SS4.p2.4.m4.1.1.2">𝜏</ci><apply id="A3.SS4.p2.4.m4.1.1.3.cmml" xref="A3.SS4.p2.4.m4.1.1.3"><times id="A3.SS4.p2.4.m4.1.1.3.1.cmml" xref="A3.SS4.p2.4.m4.1.1.3.1"></times><ci id="A3.SS4.p2.4.m4.1.1.3.2.cmml" xref="A3.SS4.p2.4.m4.1.1.3.2">𝑖</ci><ci id="A3.SS4.p2.4.m4.1.1.3.3.cmml" xref="A3.SS4.p2.4.m4.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.4.m4.1c">\tau_{in}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.4.m4.1d">italic_τ start_POSTSUBSCRIPT italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math>.
Subsequently, we apply mean aggregation over the context length <math alttext="C" class="ltx_Math" display="inline" id="A3.SS4.p2.5.m5.1"><semantics id="A3.SS4.p2.5.m5.1a"><mi id="A3.SS4.p2.5.m5.1.1" xref="A3.SS4.p2.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.5.m5.1b"><ci id="A3.SS4.p2.5.m5.1.1.cmml" xref="A3.SS4.p2.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.5.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.5.m5.1d">italic_C</annotation></semantics></math> to obtain the <math alttext="d_{r}" class="ltx_Math" display="inline" id="A3.SS4.p2.6.m6.1"><semantics id="A3.SS4.p2.6.m6.1a"><msub id="A3.SS4.p2.6.m6.1.1" xref="A3.SS4.p2.6.m6.1.1.cmml"><mi id="A3.SS4.p2.6.m6.1.1.2" xref="A3.SS4.p2.6.m6.1.1.2.cmml">d</mi><mi id="A3.SS4.p2.6.m6.1.1.3" xref="A3.SS4.p2.6.m6.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.6.m6.1b"><apply id="A3.SS4.p2.6.m6.1.1.cmml" xref="A3.SS4.p2.6.m6.1.1"><csymbol cd="ambiguous" id="A3.SS4.p2.6.m6.1.1.1.cmml" xref="A3.SS4.p2.6.m6.1.1">subscript</csymbol><ci id="A3.SS4.p2.6.m6.1.1.2.cmml" xref="A3.SS4.p2.6.m6.1.1.2">𝑑</ci><ci id="A3.SS4.p2.6.m6.1.1.3.cmml" xref="A3.SS4.p2.6.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.6.m6.1c">d_{r}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.6.m6.1d">italic_d start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>-dimensional query representation.
We experimented with aggregating over all tokens or only tokens of a particular modality (state/action/reward/RTG), and found aggregation over states-only to be most effective (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS4" title="E.4 Query Construction &amp; Sequence Aggregation ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">E.4</span></a>).
As described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS1" title="3.2.1 Vector Index for Retrieval Augmentation ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>, we construct the key-value pairs in our retrieval index by embedding all sub-trajectories in the dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="A3.SS4.p2.7.m7.1"><semantics id="A3.SS4.p2.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="A3.SS4.p2.7.m7.1.1" xref="A3.SS4.p2.7.m7.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.7.m7.1b"><ci id="A3.SS4.p2.7.m7.1.1.cmml" xref="A3.SS4.p2.7.m7.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.7.m7.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.7.m7.1d">caligraphic_D</annotation></semantics></math> using our embedding model <math alttext="g" class="ltx_Math" display="inline" id="A3.SS4.p2.8.m8.1"><semantics id="A3.SS4.p2.8.m8.1a"><mi id="A3.SS4.p2.8.m8.1.1" xref="A3.SS4.p2.8.m8.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.8.m8.1b"><ci id="A3.SS4.p2.8.m8.1.1.cmml" xref="A3.SS4.p2.8.m8.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.8.m8.1c">g</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.8.m8.1d">italic_g</annotation></semantics></math>, <math alttext="\mathcal{K}\times\mathcal{V}=\{(g(\tau_{i,t-C:t}),\tau_{i,t-C:t+C})\mid 1\leq i%
\leq|\mathcal{D}|\}" class="ltx_Math" display="inline" id="A3.SS4.p2.9.m9.7"><semantics id="A3.SS4.p2.9.m9.7a"><mrow id="A3.SS4.p2.9.m9.7.7" xref="A3.SS4.p2.9.m9.7.7.cmml"><mrow id="A3.SS4.p2.9.m9.7.7.4" xref="A3.SS4.p2.9.m9.7.7.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS4.p2.9.m9.7.7.4.2" xref="A3.SS4.p2.9.m9.7.7.4.2.cmml">𝒦</mi><mo id="A3.SS4.p2.9.m9.7.7.4.1" lspace="0.222em" rspace="0.222em" xref="A3.SS4.p2.9.m9.7.7.4.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="A3.SS4.p2.9.m9.7.7.4.3" xref="A3.SS4.p2.9.m9.7.7.4.3.cmml">𝒱</mi></mrow><mo id="A3.SS4.p2.9.m9.7.7.3" xref="A3.SS4.p2.9.m9.7.7.3.cmml">=</mo><mrow id="A3.SS4.p2.9.m9.7.7.2.2" xref="A3.SS4.p2.9.m9.7.7.2.3.cmml"><mo id="A3.SS4.p2.9.m9.7.7.2.2.3" stretchy="false" xref="A3.SS4.p2.9.m9.7.7.2.3.1.cmml">{</mo><mrow id="A3.SS4.p2.9.m9.6.6.1.1.1.2" xref="A3.SS4.p2.9.m9.6.6.1.1.1.3.cmml"><mo id="A3.SS4.p2.9.m9.6.6.1.1.1.2.3" stretchy="false" xref="A3.SS4.p2.9.m9.6.6.1.1.1.3.cmml">(</mo><mrow id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.cmml"><mi id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.3" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.3.cmml">g</mi><mo id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.2" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.1" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.1.2" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.1.2.cmml">τ</mi><mrow id="A3.SS4.p2.9.m9.2.2.2" xref="A3.SS4.p2.9.m9.2.2.2.cmml"><mrow id="A3.SS4.p2.9.m9.2.2.2.2.1" xref="A3.SS4.p2.9.m9.2.2.2.2.2.cmml"><mi id="A3.SS4.p2.9.m9.1.1.1.1" xref="A3.SS4.p2.9.m9.1.1.1.1.cmml">i</mi><mo id="A3.SS4.p2.9.m9.2.2.2.2.1.2" xref="A3.SS4.p2.9.m9.2.2.2.2.2.cmml">,</mo><mrow id="A3.SS4.p2.9.m9.2.2.2.2.1.1" xref="A3.SS4.p2.9.m9.2.2.2.2.1.1.cmml"><mi id="A3.SS4.p2.9.m9.2.2.2.2.1.1.2" xref="A3.SS4.p2.9.m9.2.2.2.2.1.1.2.cmml">t</mi><mo id="A3.SS4.p2.9.m9.2.2.2.2.1.1.1" xref="A3.SS4.p2.9.m9.2.2.2.2.1.1.1.cmml">−</mo><mi id="A3.SS4.p2.9.m9.2.2.2.2.1.1.3" xref="A3.SS4.p2.9.m9.2.2.2.2.1.1.3.cmml">C</mi></mrow></mrow><mo id="A3.SS4.p2.9.m9.2.2.2.3" lspace="0.278em" rspace="0.278em" xref="A3.SS4.p2.9.m9.2.2.2.3.cmml">:</mo><mi id="A3.SS4.p2.9.m9.2.2.2.4" xref="A3.SS4.p2.9.m9.2.2.2.4.cmml">t</mi></mrow></msub><mo id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.SS4.p2.9.m9.6.6.1.1.1.2.4" xref="A3.SS4.p2.9.m9.6.6.1.1.1.3.cmml">,</mo><msub id="A3.SS4.p2.9.m9.6.6.1.1.1.2.2" xref="A3.SS4.p2.9.m9.6.6.1.1.1.2.2.cmml"><mi id="A3.SS4.p2.9.m9.6.6.1.1.1.2.2.2" xref="A3.SS4.p2.9.m9.6.6.1.1.1.2.2.2.cmml">τ</mi><mrow id="A3.SS4.p2.9.m9.4.4.2" xref="A3.SS4.p2.9.m9.4.4.2.cmml"><mrow id="A3.SS4.p2.9.m9.4.4.2.2.1" xref="A3.SS4.p2.9.m9.4.4.2.2.2.cmml"><mi id="A3.SS4.p2.9.m9.3.3.1.1" xref="A3.SS4.p2.9.m9.3.3.1.1.cmml">i</mi><mo id="A3.SS4.p2.9.m9.4.4.2.2.1.2" xref="A3.SS4.p2.9.m9.4.4.2.2.2.cmml">,</mo><mrow id="A3.SS4.p2.9.m9.4.4.2.2.1.1" xref="A3.SS4.p2.9.m9.4.4.2.2.1.1.cmml"><mi id="A3.SS4.p2.9.m9.4.4.2.2.1.1.2" xref="A3.SS4.p2.9.m9.4.4.2.2.1.1.2.cmml">t</mi><mo id="A3.SS4.p2.9.m9.4.4.2.2.1.1.1" xref="A3.SS4.p2.9.m9.4.4.2.2.1.1.1.cmml">−</mo><mi id="A3.SS4.p2.9.m9.4.4.2.2.1.1.3" xref="A3.SS4.p2.9.m9.4.4.2.2.1.1.3.cmml">C</mi></mrow></mrow><mo id="A3.SS4.p2.9.m9.4.4.2.3" lspace="0.278em" rspace="0.278em" xref="A3.SS4.p2.9.m9.4.4.2.3.cmml">:</mo><mrow id="A3.SS4.p2.9.m9.4.4.2.4" xref="A3.SS4.p2.9.m9.4.4.2.4.cmml"><mi id="A3.SS4.p2.9.m9.4.4.2.4.2" xref="A3.SS4.p2.9.m9.4.4.2.4.2.cmml">t</mi><mo id="A3.SS4.p2.9.m9.4.4.2.4.1" xref="A3.SS4.p2.9.m9.4.4.2.4.1.cmml">+</mo><mi id="A3.SS4.p2.9.m9.4.4.2.4.3" xref="A3.SS4.p2.9.m9.4.4.2.4.3.cmml">C</mi></mrow></mrow></msub><mo id="A3.SS4.p2.9.m9.6.6.1.1.1.2.5" stretchy="false" xref="A3.SS4.p2.9.m9.6.6.1.1.1.3.cmml">)</mo></mrow><mo fence="true" id="A3.SS4.p2.9.m9.7.7.2.2.4" lspace="0em" rspace="0em" xref="A3.SS4.p2.9.m9.7.7.2.3.1.cmml">∣</mo><mrow id="A3.SS4.p2.9.m9.7.7.2.2.2" xref="A3.SS4.p2.9.m9.7.7.2.2.2.cmml"><mn id="A3.SS4.p2.9.m9.7.7.2.2.2.2" xref="A3.SS4.p2.9.m9.7.7.2.2.2.2.cmml">1</mn><mo id="A3.SS4.p2.9.m9.7.7.2.2.2.3" xref="A3.SS4.p2.9.m9.7.7.2.2.2.3.cmml">≤</mo><mi id="A3.SS4.p2.9.m9.7.7.2.2.2.4" xref="A3.SS4.p2.9.m9.7.7.2.2.2.4.cmml">i</mi><mo id="A3.SS4.p2.9.m9.7.7.2.2.2.5" xref="A3.SS4.p2.9.m9.7.7.2.2.2.5.cmml">≤</mo><mrow id="A3.SS4.p2.9.m9.7.7.2.2.2.6.2" xref="A3.SS4.p2.9.m9.7.7.2.2.2.6.1.cmml"><mo id="A3.SS4.p2.9.m9.7.7.2.2.2.6.2.1" stretchy="false" xref="A3.SS4.p2.9.m9.7.7.2.2.2.6.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A3.SS4.p2.9.m9.5.5" xref="A3.SS4.p2.9.m9.5.5.cmml">𝒟</mi><mo id="A3.SS4.p2.9.m9.7.7.2.2.2.6.2.2" stretchy="false" xref="A3.SS4.p2.9.m9.7.7.2.2.2.6.1.1.cmml">|</mo></mrow></mrow><mo id="A3.SS4.p2.9.m9.7.7.2.2.5" stretchy="false" xref="A3.SS4.p2.9.m9.7.7.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.9.m9.7b"><apply id="A3.SS4.p2.9.m9.7.7.cmml" xref="A3.SS4.p2.9.m9.7.7"><eq id="A3.SS4.p2.9.m9.7.7.3.cmml" xref="A3.SS4.p2.9.m9.7.7.3"></eq><apply id="A3.SS4.p2.9.m9.7.7.4.cmml" xref="A3.SS4.p2.9.m9.7.7.4"><times id="A3.SS4.p2.9.m9.7.7.4.1.cmml" xref="A3.SS4.p2.9.m9.7.7.4.1"></times><ci id="A3.SS4.p2.9.m9.7.7.4.2.cmml" xref="A3.SS4.p2.9.m9.7.7.4.2">𝒦</ci><ci id="A3.SS4.p2.9.m9.7.7.4.3.cmml" xref="A3.SS4.p2.9.m9.7.7.4.3">𝒱</ci></apply><apply id="A3.SS4.p2.9.m9.7.7.2.3.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2"><csymbol cd="latexml" id="A3.SS4.p2.9.m9.7.7.2.3.1.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2.3">conditional-set</csymbol><interval closure="open" id="A3.SS4.p2.9.m9.6.6.1.1.1.3.cmml" xref="A3.SS4.p2.9.m9.6.6.1.1.1.2"><apply id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.cmml" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1"><times id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.2.cmml" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.2"></times><ci id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.3.cmml" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.3">𝑔</ci><apply id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.1.cmml" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="A3.SS4.p2.9.m9.6.6.1.1.1.1.1.1.1.1.2">𝜏</ci><apply id="A3.SS4.p2.9.m9.2.2.2.cmml" xref="A3.SS4.p2.9.m9.2.2.2"><ci id="A3.SS4.p2.9.m9.2.2.2.3.cmml" xref="A3.SS4.p2.9.m9.2.2.2.3">:</ci><list id="A3.SS4.p2.9.m9.2.2.2.2.2.cmml" xref="A3.SS4.p2.9.m9.2.2.2.2.1"><ci id="A3.SS4.p2.9.m9.1.1.1.1.cmml" xref="A3.SS4.p2.9.m9.1.1.1.1">𝑖</ci><apply id="A3.SS4.p2.9.m9.2.2.2.2.1.1.cmml" xref="A3.SS4.p2.9.m9.2.2.2.2.1.1"><minus id="A3.SS4.p2.9.m9.2.2.2.2.1.1.1.cmml" xref="A3.SS4.p2.9.m9.2.2.2.2.1.1.1"></minus><ci id="A3.SS4.p2.9.m9.2.2.2.2.1.1.2.cmml" xref="A3.SS4.p2.9.m9.2.2.2.2.1.1.2">𝑡</ci><ci id="A3.SS4.p2.9.m9.2.2.2.2.1.1.3.cmml" xref="A3.SS4.p2.9.m9.2.2.2.2.1.1.3">𝐶</ci></apply></list><ci id="A3.SS4.p2.9.m9.2.2.2.4.cmml" xref="A3.SS4.p2.9.m9.2.2.2.4">𝑡</ci></apply></apply></apply><apply id="A3.SS4.p2.9.m9.6.6.1.1.1.2.2.cmml" xref="A3.SS4.p2.9.m9.6.6.1.1.1.2.2"><csymbol cd="ambiguous" id="A3.SS4.p2.9.m9.6.6.1.1.1.2.2.1.cmml" xref="A3.SS4.p2.9.m9.6.6.1.1.1.2.2">subscript</csymbol><ci id="A3.SS4.p2.9.m9.6.6.1.1.1.2.2.2.cmml" xref="A3.SS4.p2.9.m9.6.6.1.1.1.2.2.2">𝜏</ci><apply id="A3.SS4.p2.9.m9.4.4.2.cmml" xref="A3.SS4.p2.9.m9.4.4.2"><ci id="A3.SS4.p2.9.m9.4.4.2.3.cmml" xref="A3.SS4.p2.9.m9.4.4.2.3">:</ci><list id="A3.SS4.p2.9.m9.4.4.2.2.2.cmml" xref="A3.SS4.p2.9.m9.4.4.2.2.1"><ci id="A3.SS4.p2.9.m9.3.3.1.1.cmml" xref="A3.SS4.p2.9.m9.3.3.1.1">𝑖</ci><apply id="A3.SS4.p2.9.m9.4.4.2.2.1.1.cmml" xref="A3.SS4.p2.9.m9.4.4.2.2.1.1"><minus id="A3.SS4.p2.9.m9.4.4.2.2.1.1.1.cmml" xref="A3.SS4.p2.9.m9.4.4.2.2.1.1.1"></minus><ci id="A3.SS4.p2.9.m9.4.4.2.2.1.1.2.cmml" xref="A3.SS4.p2.9.m9.4.4.2.2.1.1.2">𝑡</ci><ci id="A3.SS4.p2.9.m9.4.4.2.2.1.1.3.cmml" xref="A3.SS4.p2.9.m9.4.4.2.2.1.1.3">𝐶</ci></apply></list><apply id="A3.SS4.p2.9.m9.4.4.2.4.cmml" xref="A3.SS4.p2.9.m9.4.4.2.4"><plus id="A3.SS4.p2.9.m9.4.4.2.4.1.cmml" xref="A3.SS4.p2.9.m9.4.4.2.4.1"></plus><ci id="A3.SS4.p2.9.m9.4.4.2.4.2.cmml" xref="A3.SS4.p2.9.m9.4.4.2.4.2">𝑡</ci><ci id="A3.SS4.p2.9.m9.4.4.2.4.3.cmml" xref="A3.SS4.p2.9.m9.4.4.2.4.3">𝐶</ci></apply></apply></apply></interval><apply id="A3.SS4.p2.9.m9.7.7.2.2.2.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2.2"><and id="A3.SS4.p2.9.m9.7.7.2.2.2a.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2.2"></and><apply id="A3.SS4.p2.9.m9.7.7.2.2.2b.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2.2"><leq id="A3.SS4.p2.9.m9.7.7.2.2.2.3.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2.2.3"></leq><cn id="A3.SS4.p2.9.m9.7.7.2.2.2.2.cmml" type="integer" xref="A3.SS4.p2.9.m9.7.7.2.2.2.2">1</cn><ci id="A3.SS4.p2.9.m9.7.7.2.2.2.4.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2.2.4">𝑖</ci></apply><apply id="A3.SS4.p2.9.m9.7.7.2.2.2c.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2.2"><leq id="A3.SS4.p2.9.m9.7.7.2.2.2.5.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2.2.5"></leq><share href="https://arxiv.org/html/2410.07071v1#A3.SS4.p2.9.m9.7.7.2.2.2.4.cmml" id="A3.SS4.p2.9.m9.7.7.2.2.2d.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2.2"></share><apply id="A3.SS4.p2.9.m9.7.7.2.2.2.6.1.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2.2.6.2"><abs id="A3.SS4.p2.9.m9.7.7.2.2.2.6.1.1.cmml" xref="A3.SS4.p2.9.m9.7.7.2.2.2.6.2.1"></abs><ci id="A3.SS4.p2.9.m9.5.5.cmml" xref="A3.SS4.p2.9.m9.5.5">𝒟</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.9.m9.7c">\mathcal{K}\times\mathcal{V}=\{(g(\tau_{i,t-C:t}),\tau_{i,t-C:t+C})\mid 1\leq i%
\leq|\mathcal{D}|\}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.9.m9.7d">caligraphic_K × caligraphic_V = { ( italic_g ( italic_τ start_POSTSUBSCRIPT italic_i , italic_t - italic_C : italic_t end_POSTSUBSCRIPT ) , italic_τ start_POSTSUBSCRIPT italic_i , italic_t - italic_C : italic_t + italic_C end_POSTSUBSCRIPT ) ∣ 1 ≤ italic_i ≤ | caligraphic_D | }</annotation></semantics></math>.
To avoid redundancy, in practice we construct <math alttext="H/C" class="ltx_Math" display="inline" id="A3.SS4.p2.10.m10.1"><semantics id="A3.SS4.p2.10.m10.1a"><mrow id="A3.SS4.p2.10.m10.1.1" xref="A3.SS4.p2.10.m10.1.1.cmml"><mi id="A3.SS4.p2.10.m10.1.1.2" xref="A3.SS4.p2.10.m10.1.1.2.cmml">H</mi><mo id="A3.SS4.p2.10.m10.1.1.1" xref="A3.SS4.p2.10.m10.1.1.1.cmml">/</mo><mi id="A3.SS4.p2.10.m10.1.1.3" xref="A3.SS4.p2.10.m10.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.10.m10.1b"><apply id="A3.SS4.p2.10.m10.1.1.cmml" xref="A3.SS4.p2.10.m10.1.1"><divide id="A3.SS4.p2.10.m10.1.1.1.cmml" xref="A3.SS4.p2.10.m10.1.1.1"></divide><ci id="A3.SS4.p2.10.m10.1.1.2.cmml" xref="A3.SS4.p2.10.m10.1.1.2">𝐻</ci><ci id="A3.SS4.p2.10.m10.1.1.3.cmml" xref="A3.SS4.p2.10.m10.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.10.m10.1c">H/C</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.10.m10.1d">italic_H / italic_C</annotation></semantics></math> key-value pairs for a given trajectory <math alttext="\tau" class="ltx_Math" display="inline" id="A3.SS4.p2.11.m11.1"><semantics id="A3.SS4.p2.11.m11.1a"><mi id="A3.SS4.p2.11.m11.1.1" xref="A3.SS4.p2.11.m11.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.11.m11.1b"><ci id="A3.SS4.p2.11.m11.1.1.cmml" xref="A3.SS4.p2.11.m11.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.11.m11.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.11.m11.1d">italic_τ</annotation></semantics></math> with episode length <math alttext="H" class="ltx_Math" display="inline" id="A3.SS4.p2.12.m12.1"><semantics id="A3.SS4.p2.12.m12.1a"><mi id="A3.SS4.p2.12.m12.1.1" xref="A3.SS4.p2.12.m12.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.12.m12.1b"><ci id="A3.SS4.p2.12.m12.1.1.cmml" xref="A3.SS4.p2.12.m12.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.12.m12.1c">H</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.12.m12.1d">italic_H</annotation></semantics></math> and sub-sequence length <math alttext="C" class="ltx_Math" display="inline" id="A3.SS4.p2.13.m13.1"><semantics id="A3.SS4.p2.13.m13.1a"><mi id="A3.SS4.p2.13.m13.1.1" xref="A3.SS4.p2.13.m13.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.13.m13.1b"><ci id="A3.SS4.p2.13.m13.1.1.cmml" xref="A3.SS4.p2.13.m13.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.13.m13.1c">C</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.13.m13.1d">italic_C</annotation></semantics></math>, instead of constructing the key and values for every step <math alttext="t\in[1,H]" class="ltx_Math" display="inline" id="A3.SS4.p2.14.m14.2"><semantics id="A3.SS4.p2.14.m14.2a"><mrow id="A3.SS4.p2.14.m14.2.3" xref="A3.SS4.p2.14.m14.2.3.cmml"><mi id="A3.SS4.p2.14.m14.2.3.2" xref="A3.SS4.p2.14.m14.2.3.2.cmml">t</mi><mo id="A3.SS4.p2.14.m14.2.3.1" xref="A3.SS4.p2.14.m14.2.3.1.cmml">∈</mo><mrow id="A3.SS4.p2.14.m14.2.3.3.2" xref="A3.SS4.p2.14.m14.2.3.3.1.cmml"><mo id="A3.SS4.p2.14.m14.2.3.3.2.1" stretchy="false" xref="A3.SS4.p2.14.m14.2.3.3.1.cmml">[</mo><mn id="A3.SS4.p2.14.m14.1.1" xref="A3.SS4.p2.14.m14.1.1.cmml">1</mn><mo id="A3.SS4.p2.14.m14.2.3.3.2.2" xref="A3.SS4.p2.14.m14.2.3.3.1.cmml">,</mo><mi id="A3.SS4.p2.14.m14.2.2" xref="A3.SS4.p2.14.m14.2.2.cmml">H</mi><mo id="A3.SS4.p2.14.m14.2.3.3.2.3" stretchy="false" xref="A3.SS4.p2.14.m14.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.14.m14.2b"><apply id="A3.SS4.p2.14.m14.2.3.cmml" xref="A3.SS4.p2.14.m14.2.3"><in id="A3.SS4.p2.14.m14.2.3.1.cmml" xref="A3.SS4.p2.14.m14.2.3.1"></in><ci id="A3.SS4.p2.14.m14.2.3.2.cmml" xref="A3.SS4.p2.14.m14.2.3.2">𝑡</ci><interval closure="closed" id="A3.SS4.p2.14.m14.2.3.3.1.cmml" xref="A3.SS4.p2.14.m14.2.3.3.2"><cn id="A3.SS4.p2.14.m14.1.1.cmml" type="integer" xref="A3.SS4.p2.14.m14.1.1">1</cn><ci id="A3.SS4.p2.14.m14.2.2.cmml" xref="A3.SS4.p2.14.m14.2.2">𝐻</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.14.m14.2c">t\in[1,H]</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.14.m14.2d">italic_t ∈ [ 1 , italic_H ]</annotation></semantics></math>.
Note that the values, we store <math alttext="\tau_{i,t-C:t+C}" class="ltx_Math" display="inline" id="A3.SS4.p2.15.m15.2"><semantics id="A3.SS4.p2.15.m15.2a"><msub id="A3.SS4.p2.15.m15.2.3" xref="A3.SS4.p2.15.m15.2.3.cmml"><mi id="A3.SS4.p2.15.m15.2.3.2" xref="A3.SS4.p2.15.m15.2.3.2.cmml">τ</mi><mrow id="A3.SS4.p2.15.m15.2.2.2" xref="A3.SS4.p2.15.m15.2.2.2.cmml"><mrow id="A3.SS4.p2.15.m15.2.2.2.2.1" xref="A3.SS4.p2.15.m15.2.2.2.2.2.cmml"><mi id="A3.SS4.p2.15.m15.1.1.1.1" xref="A3.SS4.p2.15.m15.1.1.1.1.cmml">i</mi><mo id="A3.SS4.p2.15.m15.2.2.2.2.1.2" xref="A3.SS4.p2.15.m15.2.2.2.2.2.cmml">,</mo><mrow id="A3.SS4.p2.15.m15.2.2.2.2.1.1" xref="A3.SS4.p2.15.m15.2.2.2.2.1.1.cmml"><mi id="A3.SS4.p2.15.m15.2.2.2.2.1.1.2" xref="A3.SS4.p2.15.m15.2.2.2.2.1.1.2.cmml">t</mi><mo id="A3.SS4.p2.15.m15.2.2.2.2.1.1.1" xref="A3.SS4.p2.15.m15.2.2.2.2.1.1.1.cmml">−</mo><mi id="A3.SS4.p2.15.m15.2.2.2.2.1.1.3" xref="A3.SS4.p2.15.m15.2.2.2.2.1.1.3.cmml">C</mi></mrow></mrow><mo id="A3.SS4.p2.15.m15.2.2.2.3" lspace="0.278em" rspace="0.278em" xref="A3.SS4.p2.15.m15.2.2.2.3.cmml">:</mo><mrow id="A3.SS4.p2.15.m15.2.2.2.4" xref="A3.SS4.p2.15.m15.2.2.2.4.cmml"><mi id="A3.SS4.p2.15.m15.2.2.2.4.2" xref="A3.SS4.p2.15.m15.2.2.2.4.2.cmml">t</mi><mo id="A3.SS4.p2.15.m15.2.2.2.4.1" xref="A3.SS4.p2.15.m15.2.2.2.4.1.cmml">+</mo><mi id="A3.SS4.p2.15.m15.2.2.2.4.3" xref="A3.SS4.p2.15.m15.2.2.2.4.3.cmml">C</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.15.m15.2b"><apply id="A3.SS4.p2.15.m15.2.3.cmml" xref="A3.SS4.p2.15.m15.2.3"><csymbol cd="ambiguous" id="A3.SS4.p2.15.m15.2.3.1.cmml" xref="A3.SS4.p2.15.m15.2.3">subscript</csymbol><ci id="A3.SS4.p2.15.m15.2.3.2.cmml" xref="A3.SS4.p2.15.m15.2.3.2">𝜏</ci><apply id="A3.SS4.p2.15.m15.2.2.2.cmml" xref="A3.SS4.p2.15.m15.2.2.2"><ci id="A3.SS4.p2.15.m15.2.2.2.3.cmml" xref="A3.SS4.p2.15.m15.2.2.2.3">:</ci><list id="A3.SS4.p2.15.m15.2.2.2.2.2.cmml" xref="A3.SS4.p2.15.m15.2.2.2.2.1"><ci id="A3.SS4.p2.15.m15.1.1.1.1.cmml" xref="A3.SS4.p2.15.m15.1.1.1.1">𝑖</ci><apply id="A3.SS4.p2.15.m15.2.2.2.2.1.1.cmml" xref="A3.SS4.p2.15.m15.2.2.2.2.1.1"><minus id="A3.SS4.p2.15.m15.2.2.2.2.1.1.1.cmml" xref="A3.SS4.p2.15.m15.2.2.2.2.1.1.1"></minus><ci id="A3.SS4.p2.15.m15.2.2.2.2.1.1.2.cmml" xref="A3.SS4.p2.15.m15.2.2.2.2.1.1.2">𝑡</ci><ci id="A3.SS4.p2.15.m15.2.2.2.2.1.1.3.cmml" xref="A3.SS4.p2.15.m15.2.2.2.2.1.1.3">𝐶</ci></apply></list><apply id="A3.SS4.p2.15.m15.2.2.2.4.cmml" xref="A3.SS4.p2.15.m15.2.2.2.4"><plus id="A3.SS4.p2.15.m15.2.2.2.4.1.cmml" xref="A3.SS4.p2.15.m15.2.2.2.4.1"></plus><ci id="A3.SS4.p2.15.m15.2.2.2.4.2.cmml" xref="A3.SS4.p2.15.m15.2.2.2.4.2">𝑡</ci><ci id="A3.SS4.p2.15.m15.2.2.2.4.3.cmml" xref="A3.SS4.p2.15.m15.2.2.2.4.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.15.m15.2c">\tau_{i,t-C:t+C}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.15.m15.2d">italic_τ start_POSTSUBSCRIPT italic_i , italic_t - italic_C : italic_t + italic_C end_POSTSUBSCRIPT</annotation></semantics></math>, contain both the sub-trajectory itself (<math alttext="\tau_{i,t-C:t}" class="ltx_Math" display="inline" id="A3.SS4.p2.16.m16.2"><semantics id="A3.SS4.p2.16.m16.2a"><msub id="A3.SS4.p2.16.m16.2.3" xref="A3.SS4.p2.16.m16.2.3.cmml"><mi id="A3.SS4.p2.16.m16.2.3.2" xref="A3.SS4.p2.16.m16.2.3.2.cmml">τ</mi><mrow id="A3.SS4.p2.16.m16.2.2.2" xref="A3.SS4.p2.16.m16.2.2.2.cmml"><mrow id="A3.SS4.p2.16.m16.2.2.2.2.1" xref="A3.SS4.p2.16.m16.2.2.2.2.2.cmml"><mi id="A3.SS4.p2.16.m16.1.1.1.1" xref="A3.SS4.p2.16.m16.1.1.1.1.cmml">i</mi><mo id="A3.SS4.p2.16.m16.2.2.2.2.1.2" xref="A3.SS4.p2.16.m16.2.2.2.2.2.cmml">,</mo><mrow id="A3.SS4.p2.16.m16.2.2.2.2.1.1" xref="A3.SS4.p2.16.m16.2.2.2.2.1.1.cmml"><mi id="A3.SS4.p2.16.m16.2.2.2.2.1.1.2" xref="A3.SS4.p2.16.m16.2.2.2.2.1.1.2.cmml">t</mi><mo id="A3.SS4.p2.16.m16.2.2.2.2.1.1.1" xref="A3.SS4.p2.16.m16.2.2.2.2.1.1.1.cmml">−</mo><mi id="A3.SS4.p2.16.m16.2.2.2.2.1.1.3" xref="A3.SS4.p2.16.m16.2.2.2.2.1.1.3.cmml">C</mi></mrow></mrow><mo id="A3.SS4.p2.16.m16.2.2.2.3" lspace="0.278em" rspace="0.278em" xref="A3.SS4.p2.16.m16.2.2.2.3.cmml">:</mo><mi id="A3.SS4.p2.16.m16.2.2.2.4" xref="A3.SS4.p2.16.m16.2.2.2.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.16.m16.2b"><apply id="A3.SS4.p2.16.m16.2.3.cmml" xref="A3.SS4.p2.16.m16.2.3"><csymbol cd="ambiguous" id="A3.SS4.p2.16.m16.2.3.1.cmml" xref="A3.SS4.p2.16.m16.2.3">subscript</csymbol><ci id="A3.SS4.p2.16.m16.2.3.2.cmml" xref="A3.SS4.p2.16.m16.2.3.2">𝜏</ci><apply id="A3.SS4.p2.16.m16.2.2.2.cmml" xref="A3.SS4.p2.16.m16.2.2.2"><ci id="A3.SS4.p2.16.m16.2.2.2.3.cmml" xref="A3.SS4.p2.16.m16.2.2.2.3">:</ci><list id="A3.SS4.p2.16.m16.2.2.2.2.2.cmml" xref="A3.SS4.p2.16.m16.2.2.2.2.1"><ci id="A3.SS4.p2.16.m16.1.1.1.1.cmml" xref="A3.SS4.p2.16.m16.1.1.1.1">𝑖</ci><apply id="A3.SS4.p2.16.m16.2.2.2.2.1.1.cmml" xref="A3.SS4.p2.16.m16.2.2.2.2.1.1"><minus id="A3.SS4.p2.16.m16.2.2.2.2.1.1.1.cmml" xref="A3.SS4.p2.16.m16.2.2.2.2.1.1.1"></minus><ci id="A3.SS4.p2.16.m16.2.2.2.2.1.1.2.cmml" xref="A3.SS4.p2.16.m16.2.2.2.2.1.1.2">𝑡</ci><ci id="A3.SS4.p2.16.m16.2.2.2.2.1.1.3.cmml" xref="A3.SS4.p2.16.m16.2.2.2.2.1.1.3">𝐶</ci></apply></list><ci id="A3.SS4.p2.16.m16.2.2.2.4.cmml" xref="A3.SS4.p2.16.m16.2.2.2.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.16.m16.2c">\tau_{i,t-C:t}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.16.m16.2d">italic_τ start_POSTSUBSCRIPT italic_i , italic_t - italic_C : italic_t end_POSTSUBSCRIPT</annotation></semantics></math>) and its continuation (<math alttext="\tau_{i,t:t+C}" class="ltx_Math" display="inline" id="A3.SS4.p2.17.m17.2"><semantics id="A3.SS4.p2.17.m17.2a"><msub id="A3.SS4.p2.17.m17.2.3" xref="A3.SS4.p2.17.m17.2.3.cmml"><mi id="A3.SS4.p2.17.m17.2.3.2" xref="A3.SS4.p2.17.m17.2.3.2.cmml">τ</mi><mrow id="A3.SS4.p2.17.m17.2.2.2" xref="A3.SS4.p2.17.m17.2.2.2.cmml"><mrow id="A3.SS4.p2.17.m17.2.2.2.4.2" xref="A3.SS4.p2.17.m17.2.2.2.4.1.cmml"><mi id="A3.SS4.p2.17.m17.1.1.1.1" xref="A3.SS4.p2.17.m17.1.1.1.1.cmml">i</mi><mo id="A3.SS4.p2.17.m17.2.2.2.4.2.1" xref="A3.SS4.p2.17.m17.2.2.2.4.1.cmml">,</mo><mi id="A3.SS4.p2.17.m17.2.2.2.2" xref="A3.SS4.p2.17.m17.2.2.2.2.cmml">t</mi></mrow><mo id="A3.SS4.p2.17.m17.2.2.2.3" lspace="0.278em" rspace="0.278em" xref="A3.SS4.p2.17.m17.2.2.2.3.cmml">:</mo><mrow id="A3.SS4.p2.17.m17.2.2.2.5" xref="A3.SS4.p2.17.m17.2.2.2.5.cmml"><mi id="A3.SS4.p2.17.m17.2.2.2.5.2" xref="A3.SS4.p2.17.m17.2.2.2.5.2.cmml">t</mi><mo id="A3.SS4.p2.17.m17.2.2.2.5.1" xref="A3.SS4.p2.17.m17.2.2.2.5.1.cmml">+</mo><mi id="A3.SS4.p2.17.m17.2.2.2.5.3" xref="A3.SS4.p2.17.m17.2.2.2.5.3.cmml">C</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.SS4.p2.17.m17.2b"><apply id="A3.SS4.p2.17.m17.2.3.cmml" xref="A3.SS4.p2.17.m17.2.3"><csymbol cd="ambiguous" id="A3.SS4.p2.17.m17.2.3.1.cmml" xref="A3.SS4.p2.17.m17.2.3">subscript</csymbol><ci id="A3.SS4.p2.17.m17.2.3.2.cmml" xref="A3.SS4.p2.17.m17.2.3.2">𝜏</ci><apply id="A3.SS4.p2.17.m17.2.2.2.cmml" xref="A3.SS4.p2.17.m17.2.2.2"><ci id="A3.SS4.p2.17.m17.2.2.2.3.cmml" xref="A3.SS4.p2.17.m17.2.2.2.3">:</ci><list id="A3.SS4.p2.17.m17.2.2.2.4.1.cmml" xref="A3.SS4.p2.17.m17.2.2.2.4.2"><ci id="A3.SS4.p2.17.m17.1.1.1.1.cmml" xref="A3.SS4.p2.17.m17.1.1.1.1">𝑖</ci><ci id="A3.SS4.p2.17.m17.2.2.2.2.cmml" xref="A3.SS4.p2.17.m17.2.2.2.2">𝑡</ci></list><apply id="A3.SS4.p2.17.m17.2.2.2.5.cmml" xref="A3.SS4.p2.17.m17.2.2.2.5"><plus id="A3.SS4.p2.17.m17.2.2.2.5.1.cmml" xref="A3.SS4.p2.17.m17.2.2.2.5.1"></plus><ci id="A3.SS4.p2.17.m17.2.2.2.5.2.cmml" xref="A3.SS4.p2.17.m17.2.2.2.5.2">𝑡</ci><ci id="A3.SS4.p2.17.m17.2.2.2.5.3.cmml" xref="A3.SS4.p2.17.m17.2.2.2.5.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p2.17.m17.2c">\tau_{i,t:t+C}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p2.17.m17.2d">italic_τ start_POSTSUBSCRIPT italic_i , italic_t : italic_t + italic_C end_POSTSUBSCRIPT</annotation></semantics></math>).
Similar to <cite class="ltx_cite ltx_citemacro_citet">Borgeaud et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib6" title="">2022</a>]</cite>, we found this choice important for high performance in RA-DT, because it allows the model to observe how the trajectory may evolve if it predicts a certain action (given that the retrieved context is similar enough).</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS4.p3">
<p class="ltx_p" id="A3.SS4.p3.7"><span class="ltx_text ltx_font_bold" id="A3.SS4.p3.7.1">Vector Index.</span> We use Faiss <cite class="ltx_cite ltx_citemacro_citep">[Johnson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib37" title="">2019</a>; Douze et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib17" title="">2024</a>]</cite> to instantiate our vector index <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="A3.SS4.p3.1.m1.1"><semantics id="A3.SS4.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A3.SS4.p3.1.m1.1.1" xref="A3.SS4.p3.1.m1.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p3.1.m1.1b"><ci id="A3.SS4.p3.1.m1.1.1.cmml" xref="A3.SS4.p3.1.m1.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p3.1.m1.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p3.1.m1.1d">caligraphic_I</annotation></semantics></math>.
This allows us to search our vector index in <math alttext="\mathcal{O}(\log M)" class="ltx_Math" display="inline" id="A3.SS4.p3.2.m2.1"><semantics id="A3.SS4.p3.2.m2.1a"><mrow id="A3.SS4.p3.2.m2.1.1" xref="A3.SS4.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS4.p3.2.m2.1.1.3" xref="A3.SS4.p3.2.m2.1.1.3.cmml">𝒪</mi><mo id="A3.SS4.p3.2.m2.1.1.2" xref="A3.SS4.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="A3.SS4.p3.2.m2.1.1.1.1" xref="A3.SS4.p3.2.m2.1.1.1.1.1.cmml"><mo id="A3.SS4.p3.2.m2.1.1.1.1.2" stretchy="false" xref="A3.SS4.p3.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A3.SS4.p3.2.m2.1.1.1.1.1" xref="A3.SS4.p3.2.m2.1.1.1.1.1.cmml"><mi id="A3.SS4.p3.2.m2.1.1.1.1.1.1" xref="A3.SS4.p3.2.m2.1.1.1.1.1.1.cmml">log</mi><mo id="A3.SS4.p3.2.m2.1.1.1.1.1a" lspace="0.167em" xref="A3.SS4.p3.2.m2.1.1.1.1.1.cmml">⁡</mo><mi id="A3.SS4.p3.2.m2.1.1.1.1.1.2" xref="A3.SS4.p3.2.m2.1.1.1.1.1.2.cmml">M</mi></mrow><mo id="A3.SS4.p3.2.m2.1.1.1.1.3" stretchy="false" xref="A3.SS4.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p3.2.m2.1b"><apply id="A3.SS4.p3.2.m2.1.1.cmml" xref="A3.SS4.p3.2.m2.1.1"><times id="A3.SS4.p3.2.m2.1.1.2.cmml" xref="A3.SS4.p3.2.m2.1.1.2"></times><ci id="A3.SS4.p3.2.m2.1.1.3.cmml" xref="A3.SS4.p3.2.m2.1.1.3">𝒪</ci><apply id="A3.SS4.p3.2.m2.1.1.1.1.1.cmml" xref="A3.SS4.p3.2.m2.1.1.1.1"><log id="A3.SS4.p3.2.m2.1.1.1.1.1.1.cmml" xref="A3.SS4.p3.2.m2.1.1.1.1.1.1"></log><ci id="A3.SS4.p3.2.m2.1.1.1.1.1.2.cmml" xref="A3.SS4.p3.2.m2.1.1.1.1.1.2">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p3.2.m2.1c">\mathcal{O}(\log M)</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p3.2.m2.1d">caligraphic_O ( roman_log italic_M )</annotation></semantics></math> time using Hierarchical Navigable Small World (HNSW) graphs.
However, in practice we found it faster to use a Flat index on the GPU as provided by Faiss instead of using HNSW, because our retrieval datasets are small enough.
We use retrieval both during training and during inference.
It is, however, possible to pre-compute the retrieved trajectories for <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="A3.SS4.p3.3.m3.1"><semantics id="A3.SS4.p3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="A3.SS4.p3.3.m3.1.1" xref="A3.SS4.p3.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p3.3.m3.1b"><ci id="A3.SS4.p3.3.m3.1.1.cmml" xref="A3.SS4.p3.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p3.3.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p3.3.m3.1d">caligraphic_D</annotation></semantics></math> prior to the training phase to limit the computational demand of retrieval, as suggested by <cite class="ltx_cite ltx_citemacro_citet">Borgeaud et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib6" title="">2022</a>]</cite>.
During evaluation, we can retrieve after every environment step or only after every <math alttext="t" class="ltx_Math" display="inline" id="A3.SS4.p3.4.m4.1"><semantics id="A3.SS4.p3.4.m4.1a"><mi id="A3.SS4.p3.4.m4.1.1" xref="A3.SS4.p3.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p3.4.m4.1b"><ci id="A3.SS4.p3.4.m4.1.1.cmml" xref="A3.SS4.p3.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p3.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p3.4.m4.1d">italic_t</annotation></semantics></math> environment steps.
Here, <math alttext="t" class="ltx_Math" display="inline" id="A3.SS4.p3.5.m5.1"><semantics id="A3.SS4.p3.5.m5.1a"><mi id="A3.SS4.p3.5.m5.1.1" xref="A3.SS4.p3.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p3.5.m5.1b"><ci id="A3.SS4.p3.5.m5.1.1.cmml" xref="A3.SS4.p3.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p3.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p3.5.m5.1d">italic_t</annotation></semantics></math> represents a trade-off between inference time and final performance.
We use <math alttext="t=1" class="ltx_Math" display="inline" id="A3.SS4.p3.6.m6.1"><semantics id="A3.SS4.p3.6.m6.1a"><mrow id="A3.SS4.p3.6.m6.1.1" xref="A3.SS4.p3.6.m6.1.1.cmml"><mi id="A3.SS4.p3.6.m6.1.1.2" xref="A3.SS4.p3.6.m6.1.1.2.cmml">t</mi><mo id="A3.SS4.p3.6.m6.1.1.1" xref="A3.SS4.p3.6.m6.1.1.1.cmml">=</mo><mn id="A3.SS4.p3.6.m6.1.1.3" xref="A3.SS4.p3.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p3.6.m6.1b"><apply id="A3.SS4.p3.6.m6.1.1.cmml" xref="A3.SS4.p3.6.m6.1.1"><eq id="A3.SS4.p3.6.m6.1.1.1.cmml" xref="A3.SS4.p3.6.m6.1.1.1"></eq><ci id="A3.SS4.p3.6.m6.1.1.2.cmml" xref="A3.SS4.p3.6.m6.1.1.2">𝑡</ci><cn id="A3.SS4.p3.6.m6.1.1.3.cmml" type="integer" xref="A3.SS4.p3.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p3.6.m6.1c">t=1</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p3.6.m6.1d">italic_t = 1</annotation></semantics></math> for Dark-Room and Dark Key-Door, and <math alttext="t=25" class="ltx_Math" display="inline" id="A3.SS4.p3.7.m7.1"><semantics id="A3.SS4.p3.7.m7.1a"><mrow id="A3.SS4.p3.7.m7.1.1" xref="A3.SS4.p3.7.m7.1.1.cmml"><mi id="A3.SS4.p3.7.m7.1.1.2" xref="A3.SS4.p3.7.m7.1.1.2.cmml">t</mi><mo id="A3.SS4.p3.7.m7.1.1.1" xref="A3.SS4.p3.7.m7.1.1.1.cmml">=</mo><mn id="A3.SS4.p3.7.m7.1.1.3" xref="A3.SS4.p3.7.m7.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p3.7.m7.1b"><apply id="A3.SS4.p3.7.m7.1.1.cmml" xref="A3.SS4.p3.7.m7.1.1"><eq id="A3.SS4.p3.7.m7.1.1.1.cmml" xref="A3.SS4.p3.7.m7.1.1.1"></eq><ci id="A3.SS4.p3.7.m7.1.1.2.cmml" xref="A3.SS4.p3.7.m7.1.1.2">𝑡</ci><cn id="A3.SS4.p3.7.m7.1.1.3.cmml" type="integer" xref="A3.SS4.p3.7.m7.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p3.7.m7.1c">t=25</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p3.7.m7.1d">italic_t = 25</annotation></semantics></math> for all other environments (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.SS6" title="E.6 Interaction steps between context retrieval ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">E.6</span></a> for an ablation on this design choice).
For all environments, except for Meta-World and DMControl, we provide a single retrieved sub-trajectory in the agent’s context.
For Meta-World and DMControl, we found that providing more than one retrieved sub-trajectory benefits the agent’s performance.
Therefore, for these two environments, we retrieve the top-4 sub-trajectories, order them by return achieved in that trajectory, and provide their concatenation as retrieved context for RA-DT.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS4.p4">
<p class="ltx_p" id="A3.SS4.p4.3"><span class="ltx_text ltx_font_bold" id="A3.SS4.p4.3.1">Reweighting.</span>
To implement the reweighting mechanism, as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS3" title="3.2.3 Reweighting Retrieved Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3.2.3</span></a>, we first retrieve the top <math alttext="l\gg k" class="ltx_Math" display="inline" id="A3.SS4.p4.1.m1.1"><semantics id="A3.SS4.p4.1.m1.1a"><mrow id="A3.SS4.p4.1.m1.1.1" xref="A3.SS4.p4.1.m1.1.1.cmml"><mi id="A3.SS4.p4.1.m1.1.1.2" xref="A3.SS4.p4.1.m1.1.1.2.cmml">l</mi><mo id="A3.SS4.p4.1.m1.1.1.1" xref="A3.SS4.p4.1.m1.1.1.1.cmml">≫</mo><mi id="A3.SS4.p4.1.m1.1.1.3" xref="A3.SS4.p4.1.m1.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p4.1.m1.1b"><apply id="A3.SS4.p4.1.m1.1.1.cmml" xref="A3.SS4.p4.1.m1.1.1"><csymbol cd="latexml" id="A3.SS4.p4.1.m1.1.1.1.cmml" xref="A3.SS4.p4.1.m1.1.1.1">much-greater-than</csymbol><ci id="A3.SS4.p4.1.m1.1.1.2.cmml" xref="A3.SS4.p4.1.m1.1.1.2">𝑙</ci><ci id="A3.SS4.p4.1.m1.1.1.3.cmml" xref="A3.SS4.p4.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p4.1.m1.1c">l\gg k</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p4.1.m1.1d">italic_l ≫ italic_k</annotation></semantics></math> experiences and the select the top-<math alttext="k" class="ltx_Math" display="inline" id="A3.SS4.p4.2.m2.1"><semantics id="A3.SS4.p4.2.m2.1a"><mi id="A3.SS4.p4.2.m2.1.1" xref="A3.SS4.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p4.2.m2.1b"><ci id="A3.SS4.p4.2.m2.1.1.cmml" xref="A3.SS4.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p4.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p4.2.m2.1d">italic_k</annotation></semantics></math> experiences according to their reweighted scores.
We set <math alttext="l=50" class="ltx_Math" display="inline" id="A3.SS4.p4.3.m3.1"><semantics id="A3.SS4.p4.3.m3.1a"><mrow id="A3.SS4.p4.3.m3.1.1" xref="A3.SS4.p4.3.m3.1.1.cmml"><mi id="A3.SS4.p4.3.m3.1.1.2" xref="A3.SS4.p4.3.m3.1.1.2.cmml">l</mi><mo id="A3.SS4.p4.3.m3.1.1.1" xref="A3.SS4.p4.3.m3.1.1.1.cmml">=</mo><mn id="A3.SS4.p4.3.m3.1.1.3" xref="A3.SS4.p4.3.m3.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p4.3.m3.1b"><apply id="A3.SS4.p4.3.m3.1.1.cmml" xref="A3.SS4.p4.3.m3.1.1"><eq id="A3.SS4.p4.3.m3.1.1.1.cmml" xref="A3.SS4.p4.3.m3.1.1.1"></eq><ci id="A3.SS4.p4.3.m3.1.1.2.cmml" xref="A3.SS4.p4.3.m3.1.1.2">𝑙</ci><cn id="A3.SS4.p4.3.m3.1.1.3.cmml" type="integer" xref="A3.SS4.p4.3.m3.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p4.3.m3.1c">l=50</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p4.3.m3.1d">italic_l = 50</annotation></semantics></math> in all our experiments.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS4.p5">
<p class="ltx_p" id="A3.SS4.p5.1"><span class="ltx_text ltx_font_bold" id="A3.SS4.p5.1.1">Embedding Retrieved Context.</span>
After the most similar trajectories have been retrieved, we embed the state/action/reward/RTG tokens with a separate embedding layers (as is done for the regular input sequence) before incorporating them via the CA layers.
We also experimented with sharing/detaching the regular embedding layers, but found it most effective to maintain separate ones.
Furthermore, we experimented with an additional Transformer-based encoder for the retrieved sequences, as proposed by <cite class="ltx_cite ltx_citemacro_citet">Borgeaud et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib6" title="">2022</a>]</cite>, but did not observe substantial performance gains despite increased computational cost.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS4.p6">
<p class="ltx_p" id="A3.SS4.p6.3"><span class="ltx_text ltx_font_bold" id="A3.SS4.p6.3.1">Retrieval Dataset.</span>
For all our experiments, we use the same dataset for retrieval <math alttext="\mathcal{D}^{\prime}" class="ltx_Math" display="inline" id="A3.SS4.p6.1.m1.1"><semantics id="A3.SS4.p6.1.m1.1a"><msup id="A3.SS4.p6.1.m1.1.1" xref="A3.SS4.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS4.p6.1.m1.1.1.2" xref="A3.SS4.p6.1.m1.1.1.2.cmml">𝒟</mi><mo id="A3.SS4.p6.1.m1.1.1.3" xref="A3.SS4.p6.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A3.SS4.p6.1.m1.1b"><apply id="A3.SS4.p6.1.m1.1.1.cmml" xref="A3.SS4.p6.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS4.p6.1.m1.1.1.1.cmml" xref="A3.SS4.p6.1.m1.1.1">superscript</csymbol><ci id="A3.SS4.p6.1.m1.1.1.2.cmml" xref="A3.SS4.p6.1.m1.1.1.2">𝒟</ci><ci id="A3.SS4.p6.1.m1.1.1.3.cmml" xref="A3.SS4.p6.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p6.1.m1.1c">\mathcal{D}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p6.1.m1.1d">caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> as is used for training <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="A3.SS4.p6.2.m2.1"><semantics id="A3.SS4.p6.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="A3.SS4.p6.2.m2.1.1" xref="A3.SS4.p6.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p6.2.m2.1b"><ci id="A3.SS4.p6.2.m2.1.1.cmml" xref="A3.SS4.p6.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p6.2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p6.2.m2.1d">caligraphic_D</annotation></semantics></math>, that is <math alttext="\mathcal{D}^{\prime}=\mathcal{D}" class="ltx_Math" display="inline" id="A3.SS4.p6.3.m3.1"><semantics id="A3.SS4.p6.3.m3.1a"><mrow id="A3.SS4.p6.3.m3.1.1" xref="A3.SS4.p6.3.m3.1.1.cmml"><msup id="A3.SS4.p6.3.m3.1.1.2" xref="A3.SS4.p6.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.SS4.p6.3.m3.1.1.2.2" xref="A3.SS4.p6.3.m3.1.1.2.2.cmml">𝒟</mi><mo id="A3.SS4.p6.3.m3.1.1.2.3" xref="A3.SS4.p6.3.m3.1.1.2.3.cmml">′</mo></msup><mo id="A3.SS4.p6.3.m3.1.1.1" xref="A3.SS4.p6.3.m3.1.1.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="A3.SS4.p6.3.m3.1.1.3" xref="A3.SS4.p6.3.m3.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p6.3.m3.1b"><apply id="A3.SS4.p6.3.m3.1.1.cmml" xref="A3.SS4.p6.3.m3.1.1"><eq id="A3.SS4.p6.3.m3.1.1.1.cmml" xref="A3.SS4.p6.3.m3.1.1.1"></eq><apply id="A3.SS4.p6.3.m3.1.1.2.cmml" xref="A3.SS4.p6.3.m3.1.1.2"><csymbol cd="ambiguous" id="A3.SS4.p6.3.m3.1.1.2.1.cmml" xref="A3.SS4.p6.3.m3.1.1.2">superscript</csymbol><ci id="A3.SS4.p6.3.m3.1.1.2.2.cmml" xref="A3.SS4.p6.3.m3.1.1.2.2">𝒟</ci><ci id="A3.SS4.p6.3.m3.1.1.2.3.cmml" xref="A3.SS4.p6.3.m3.1.1.2.3">′</ci></apply><ci id="A3.SS4.p6.3.m3.1.1.3.cmml" xref="A3.SS4.p6.3.m3.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p6.3.m3.1c">\mathcal{D}^{\prime}=\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p6.3.m3.1d">caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = caligraphic_D</annotation></semantics></math>.
Therefore, we prevent retrieving sub-sequences from the same trajectory as the query.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS4.p7">
<p class="ltx_p" id="A3.SS4.p7.1"><span class="ltx_text ltx_font_bold" id="A3.SS4.p7.1.1">Retrieval Regularization.</span> We found it advantageous to regularize the k-NN retrieval in RA-DT throughout the training phase.
In RL datasets, there is often a substantial overlap between trajectories, leading to many similar sub-trajectories.
This poses a significant challenge, as retrieving only similar sub-trajectories encourages the agent to adopt copying behaviour, which renders the DT unable to produce high-reward actions during inference.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS4.p8">
<p class="ltx_p" id="A3.SS4.p8.4">One simple strategy to mitigate this issue is <span class="ltx_text ltx_font_bold" id="A3.SS4.p8.4.1">deduplication</span>, i.e., to discard duplicate experiences before the training phase of RA-DT.
To achieve this, we first construct our index as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2" title="3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3.2</span></a>.
For every key <math alttext="\mathbf{k}\in\mathbf{K}" class="ltx_Math" display="inline" id="A3.SS4.p8.1.m1.1"><semantics id="A3.SS4.p8.1.m1.1a"><mrow id="A3.SS4.p8.1.m1.1.1" xref="A3.SS4.p8.1.m1.1.1.cmml"><mi id="A3.SS4.p8.1.m1.1.1.2" xref="A3.SS4.p8.1.m1.1.1.2.cmml">𝐤</mi><mo id="A3.SS4.p8.1.m1.1.1.1" xref="A3.SS4.p8.1.m1.1.1.1.cmml">∈</mo><mi id="A3.SS4.p8.1.m1.1.1.3" xref="A3.SS4.p8.1.m1.1.1.3.cmml">𝐊</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p8.1.m1.1b"><apply id="A3.SS4.p8.1.m1.1.1.cmml" xref="A3.SS4.p8.1.m1.1.1"><in id="A3.SS4.p8.1.m1.1.1.1.cmml" xref="A3.SS4.p8.1.m1.1.1.1"></in><ci id="A3.SS4.p8.1.m1.1.1.2.cmml" xref="A3.SS4.p8.1.m1.1.1.2">𝐤</ci><ci id="A3.SS4.p8.1.m1.1.1.3.cmml" xref="A3.SS4.p8.1.m1.1.1.3">𝐊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p8.1.m1.1c">\mathbf{k}\in\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p8.1.m1.1d">bold_k ∈ bold_K</annotation></semantics></math>, we retrieve the top-<math alttext="k" class="ltx_Math" display="inline" id="A3.SS4.p8.2.m2.1"><semantics id="A3.SS4.p8.2.m2.1a"><mi id="A3.SS4.p8.2.m2.1.1" xref="A3.SS4.p8.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p8.2.m2.1b"><ci id="A3.SS4.p8.2.m2.1.1.cmml" xref="A3.SS4.p8.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p8.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p8.2.m2.1d">italic_k</annotation></semantics></math> neighbours (excluding experiences from the same episode as <math alttext="\mathbf{k}" class="ltx_Math" display="inline" id="A3.SS4.p8.3.m3.1"><semantics id="A3.SS4.p8.3.m3.1a"><mi id="A3.SS4.p8.3.m3.1.1" xref="A3.SS4.p8.3.m3.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p8.3.m3.1b"><ci id="A3.SS4.p8.3.m3.1.1.cmml" xref="A3.SS4.p8.3.m3.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p8.3.m3.1c">\mathbf{k}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p8.3.m3.1d">bold_k</annotation></semantics></math>).
If the similarity score is above a cosine similarity of <math alttext="0.98" class="ltx_Math" display="inline" id="A3.SS4.p8.4.m4.1"><semantics id="A3.SS4.p8.4.m4.1a"><mn id="A3.SS4.p8.4.m4.1.1" xref="A3.SS4.p8.4.m4.1.1.cmml">0.98</mn><annotation-xml encoding="MathML-Content" id="A3.SS4.p8.4.m4.1b"><cn id="A3.SS4.p8.4.m4.1.1.cmml" type="float" xref="A3.SS4.p8.4.m4.1.1">0.98</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p8.4.m4.1c">0.98</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p8.4.m4.1d">0.98</annotation></semantics></math>, we discard the experience.
This substantially reduces the number of experiences in the index and speeds-up retrieval.</p>
</div>
<figure class="ltx_figure" id="A3.F14">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="26" id="A3.F14.g1" src="extracted/5911726/figures/dark_keydoor/20x20/legend.png" width="449"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A3.F14.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A3.F14.sf1.g1" src="extracted/5911726/figures/darkroom/10x10/train_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="A3.F14.sf1.2.m1.1"><semantics id="A3.F14.sf1.2.m1.1b"><mo id="A3.F14.sf1.2.m1.1.1" xref="A3.F14.sf1.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A3.F14.sf1.2.m1.1c"><times id="A3.F14.sf1.2.m1.1.1.cmml" xref="A3.F14.sf1.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A3.F14.sf1.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A3.F14.sf1.2.m1.1e">×</annotation></semantics></math>10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A3.F14.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="A3.F14.sf2.g1" src="extracted/5911726/figures/darkroom/20x20/train_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Dark-Room 20<math alttext="\times" class="ltx_Math" display="inline" id="A3.F14.sf2.2.m1.1"><semantics id="A3.F14.sf2.2.m1.1b"><mo id="A3.F14.sf2.2.m1.1.1" xref="A3.F14.sf2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A3.F14.sf2.2.m1.1c"><times id="A3.F14.sf2.2.m1.1.1.cmml" xref="A3.F14.sf2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A3.F14.sf2.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A3.F14.sf2.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A3.F14.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="134" id="A3.F14.sf3.g1" src="extracted/5911726/figures/darkroom/40x20/train_icl.png" width="198"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Dark-Room 40<math alttext="\times" class="ltx_Math" display="inline" id="A3.F14.sf3.2.m1.1"><semantics id="A3.F14.sf3.2.m1.1b"><mo id="A3.F14.sf3.2.m1.1.1" xref="A3.F14.sf3.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A3.F14.sf3.2.m1.1c"><times id="A3.F14.sf3.2.m1.1.1.cmml" xref="A3.F14.sf3.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A3.F14.sf3.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A3.F14.sf3.2.m1.1e">×</annotation></semantics></math>20</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>In-context learning performance on <span class="ltx_text ltx_font_bold" id="A3.F14.4.1">(a) Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="A3.F14.4.1.m1.1"><semantics id="A3.F14.4.1.m1.1b"><mo id="A3.F14.4.1.m1.1.1" xref="A3.F14.4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A3.F14.4.1.m1.1c"><times id="A3.F14.4.1.m1.1.1.cmml" xref="A3.F14.4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A3.F14.4.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A3.F14.4.1.m1.1e">×</annotation></semantics></math>10</span>, <span class="ltx_text ltx_font_bold" id="A3.F14.5.2">(b) Dark-Room 20<math alttext="\times" class="ltx_Math" display="inline" id="A3.F14.5.2.m1.1"><semantics id="A3.F14.5.2.m1.1b"><mo id="A3.F14.5.2.m1.1.1" xref="A3.F14.5.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A3.F14.5.2.m1.1c"><times id="A3.F14.5.2.m1.1.1.cmml" xref="A3.F14.5.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A3.F14.5.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A3.F14.5.2.m1.1e">×</annotation></semantics></math>20</span>, <span class="ltx_text ltx_font_bold" id="A3.F14.6.3">(c) Dark-Room 40<math alttext="\times" class="ltx_Math" display="inline" id="A3.F14.6.3.m1.1"><semantics id="A3.F14.6.3.m1.1b"><mo id="A3.F14.6.3.m1.1.1" xref="A3.F14.6.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A3.F14.6.3.m1.1c"><times id="A3.F14.6.3.m1.1.1.cmml" xref="A3.F14.6.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A3.F14.6.3.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A3.F14.6.3.m1.1e">×</annotation></semantics></math>20</span> at end of training (100K steps). We evaluate each agent for 40 episodes on each of the 80 <span class="ltx_text ltx_font_bold" id="A3.F14.8.4">training tasks</span> and report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A3.SS4.p9">
<p class="ltx_p" id="A3.SS4.p9.7">Two other strategies for regularizing retrieval during the training phase, are <span class="ltx_text ltx_font_bold" id="A3.SS4.p9.7.1">similarity cut-off</span> and <span class="ltx_text ltx_font_bold" id="A3.SS4.p9.7.2">query dropout</span> <cite class="ltx_cite ltx_citemacro_citep">[Yasunaga et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib102" title="">2023</a>]</cite>.
Similarity cut-off first retrieves the top <math alttext="m&gt;l" class="ltx_Math" display="inline" id="A3.SS4.p9.1.m1.1"><semantics id="A3.SS4.p9.1.m1.1a"><mrow id="A3.SS4.p9.1.m1.1.1" xref="A3.SS4.p9.1.m1.1.1.cmml"><mi id="A3.SS4.p9.1.m1.1.1.2" xref="A3.SS4.p9.1.m1.1.1.2.cmml">m</mi><mo id="A3.SS4.p9.1.m1.1.1.1" xref="A3.SS4.p9.1.m1.1.1.1.cmml">&gt;</mo><mi id="A3.SS4.p9.1.m1.1.1.3" xref="A3.SS4.p9.1.m1.1.1.3.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p9.1.m1.1b"><apply id="A3.SS4.p9.1.m1.1.1.cmml" xref="A3.SS4.p9.1.m1.1.1"><gt id="A3.SS4.p9.1.m1.1.1.1.cmml" xref="A3.SS4.p9.1.m1.1.1.1"></gt><ci id="A3.SS4.p9.1.m1.1.1.2.cmml" xref="A3.SS4.p9.1.m1.1.1.2">𝑚</ci><ci id="A3.SS4.p9.1.m1.1.1.3.cmml" xref="A3.SS4.p9.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p9.1.m1.1c">m&gt;l</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p9.1.m1.1d">italic_m &gt; italic_l</annotation></semantics></math> experiences, discards the experiences with a similarity score above a threshold (e.g., <math alttext="0.98" class="ltx_Math" display="inline" id="A3.SS4.p9.2.m2.1"><semantics id="A3.SS4.p9.2.m2.1a"><mn id="A3.SS4.p9.2.m2.1.1" xref="A3.SS4.p9.2.m2.1.1.cmml">0.98</mn><annotation-xml encoding="MathML-Content" id="A3.SS4.p9.2.m2.1b"><cn id="A3.SS4.p9.2.m2.1.1.cmml" type="float" xref="A3.SS4.p9.2.m2.1.1">0.98</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p9.2.m2.1c">0.98</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p9.2.m2.1d">0.98</annotation></semantics></math>), and retains only the remaining experiences <math alttext="l" class="ltx_Math" display="inline" id="A3.SS4.p9.3.m3.1"><semantics id="A3.SS4.p9.3.m3.1a"><mi id="A3.SS4.p9.3.m3.1.1" xref="A3.SS4.p9.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A3.SS4.p9.3.m3.1b"><ci id="A3.SS4.p9.3.m3.1.1.cmml" xref="A3.SS4.p9.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p9.3.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p9.3.m3.1d">italic_l</annotation></semantics></math>.
If used in combination with reweighting, we set <math alttext="m=2*l" class="ltx_Math" display="inline" id="A3.SS4.p9.4.m4.1"><semantics id="A3.SS4.p9.4.m4.1a"><mrow id="A3.SS4.p9.4.m4.1.1" xref="A3.SS4.p9.4.m4.1.1.cmml"><mi id="A3.SS4.p9.4.m4.1.1.2" xref="A3.SS4.p9.4.m4.1.1.2.cmml">m</mi><mo id="A3.SS4.p9.4.m4.1.1.1" xref="A3.SS4.p9.4.m4.1.1.1.cmml">=</mo><mrow id="A3.SS4.p9.4.m4.1.1.3" xref="A3.SS4.p9.4.m4.1.1.3.cmml"><mn id="A3.SS4.p9.4.m4.1.1.3.2" xref="A3.SS4.p9.4.m4.1.1.3.2.cmml">2</mn><mo id="A3.SS4.p9.4.m4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A3.SS4.p9.4.m4.1.1.3.1.cmml">∗</mo><mi id="A3.SS4.p9.4.m4.1.1.3.3" xref="A3.SS4.p9.4.m4.1.1.3.3.cmml">l</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p9.4.m4.1b"><apply id="A3.SS4.p9.4.m4.1.1.cmml" xref="A3.SS4.p9.4.m4.1.1"><eq id="A3.SS4.p9.4.m4.1.1.1.cmml" xref="A3.SS4.p9.4.m4.1.1.1"></eq><ci id="A3.SS4.p9.4.m4.1.1.2.cmml" xref="A3.SS4.p9.4.m4.1.1.2">𝑚</ci><apply id="A3.SS4.p9.4.m4.1.1.3.cmml" xref="A3.SS4.p9.4.m4.1.1.3"><times id="A3.SS4.p9.4.m4.1.1.3.1.cmml" xref="A3.SS4.p9.4.m4.1.1.3.1"></times><cn id="A3.SS4.p9.4.m4.1.1.3.2.cmml" type="integer" xref="A3.SS4.p9.4.m4.1.1.3.2">2</cn><ci id="A3.SS4.p9.4.m4.1.1.3.3.cmml" xref="A3.SS4.p9.4.m4.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p9.4.m4.1c">m=2*l</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p9.4.m4.1d">italic_m = 2 ∗ italic_l</annotation></semantics></math>.
Query dropout randomly drops-out tokens (e.g., 20%) of the embedded sub-trajectory <math alttext="\tau_{\text{in}}" class="ltx_Math" display="inline" id="A3.SS4.p9.5.m5.1"><semantics id="A3.SS4.p9.5.m5.1a"><msub id="A3.SS4.p9.5.m5.1.1" xref="A3.SS4.p9.5.m5.1.1.cmml"><mi id="A3.SS4.p9.5.m5.1.1.2" xref="A3.SS4.p9.5.m5.1.1.2.cmml">τ</mi><mtext id="A3.SS4.p9.5.m5.1.1.3" xref="A3.SS4.p9.5.m5.1.1.3a.cmml">in</mtext></msub><annotation-xml encoding="MathML-Content" id="A3.SS4.p9.5.m5.1b"><apply id="A3.SS4.p9.5.m5.1.1.cmml" xref="A3.SS4.p9.5.m5.1.1"><csymbol cd="ambiguous" id="A3.SS4.p9.5.m5.1.1.1.cmml" xref="A3.SS4.p9.5.m5.1.1">subscript</csymbol><ci id="A3.SS4.p9.5.m5.1.1.2.cmml" xref="A3.SS4.p9.5.m5.1.1.2">𝜏</ci><ci id="A3.SS4.p9.5.m5.1.1.3a.cmml" xref="A3.SS4.p9.5.m5.1.1.3"><mtext id="A3.SS4.p9.5.m5.1.1.3.cmml" mathsize="70%" xref="A3.SS4.p9.5.m5.1.1.3">in</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p9.5.m5.1c">\tau_{\text{in}}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p9.5.m5.1d">italic_τ start_POSTSUBSCRIPT in end_POSTSUBSCRIPT</annotation></semantics></math>, which leads to more diverse retrieved experiences.
We found both strategies effective for RA-DT.
We use query dropout of 0.2, similarity cut-off of 0.98, and deduplication by default.
Furthermore, for Meta-World and DMControl, we found <span class="ltx_text ltx_font_bold" id="A3.SS4.p9.7.3">query-blending</span> useful.
Query-blending interpolates between then actual query and a randomly selected key from the retrieval index, <math alttext="\bm{q}^{\prime}=\bm{q}*\alpha_{\text{blend}}+(1-\alpha)\bm{q}_{\text{rand}}" class="ltx_Math" display="inline" id="A3.SS4.p9.6.m6.1"><semantics id="A3.SS4.p9.6.m6.1a"><mrow id="A3.SS4.p9.6.m6.1.1" xref="A3.SS4.p9.6.m6.1.1.cmml"><msup id="A3.SS4.p9.6.m6.1.1.3" xref="A3.SS4.p9.6.m6.1.1.3.cmml"><mi id="A3.SS4.p9.6.m6.1.1.3.2" xref="A3.SS4.p9.6.m6.1.1.3.2.cmml">𝒒</mi><mo id="A3.SS4.p9.6.m6.1.1.3.3" xref="A3.SS4.p9.6.m6.1.1.3.3.cmml">′</mo></msup><mo id="A3.SS4.p9.6.m6.1.1.2" xref="A3.SS4.p9.6.m6.1.1.2.cmml">=</mo><mrow id="A3.SS4.p9.6.m6.1.1.1" xref="A3.SS4.p9.6.m6.1.1.1.cmml"><mrow id="A3.SS4.p9.6.m6.1.1.1.3" xref="A3.SS4.p9.6.m6.1.1.1.3.cmml"><mi id="A3.SS4.p9.6.m6.1.1.1.3.2" xref="A3.SS4.p9.6.m6.1.1.1.3.2.cmml">𝒒</mi><mo id="A3.SS4.p9.6.m6.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A3.SS4.p9.6.m6.1.1.1.3.1.cmml">∗</mo><msub id="A3.SS4.p9.6.m6.1.1.1.3.3" xref="A3.SS4.p9.6.m6.1.1.1.3.3.cmml"><mi id="A3.SS4.p9.6.m6.1.1.1.3.3.2" xref="A3.SS4.p9.6.m6.1.1.1.3.3.2.cmml">α</mi><mtext id="A3.SS4.p9.6.m6.1.1.1.3.3.3" xref="A3.SS4.p9.6.m6.1.1.1.3.3.3a.cmml">blend</mtext></msub></mrow><mo id="A3.SS4.p9.6.m6.1.1.1.2" xref="A3.SS4.p9.6.m6.1.1.1.2.cmml">+</mo><mrow id="A3.SS4.p9.6.m6.1.1.1.1" xref="A3.SS4.p9.6.m6.1.1.1.1.cmml"><mrow id="A3.SS4.p9.6.m6.1.1.1.1.1.1" xref="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.cmml"><mo id="A3.SS4.p9.6.m6.1.1.1.1.1.1.2" stretchy="false" xref="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.SS4.p9.6.m6.1.1.1.1.1.1.1" xref="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.cmml"><mn id="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.2" xref="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.1" xref="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.3" xref="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo id="A3.SS4.p9.6.m6.1.1.1.1.1.1.3" stretchy="false" xref="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.SS4.p9.6.m6.1.1.1.1.2" xref="A3.SS4.p9.6.m6.1.1.1.1.2.cmml">⁢</mo><msub id="A3.SS4.p9.6.m6.1.1.1.1.3" xref="A3.SS4.p9.6.m6.1.1.1.1.3.cmml"><mi id="A3.SS4.p9.6.m6.1.1.1.1.3.2" xref="A3.SS4.p9.6.m6.1.1.1.1.3.2.cmml">𝒒</mi><mtext id="A3.SS4.p9.6.m6.1.1.1.1.3.3" xref="A3.SS4.p9.6.m6.1.1.1.1.3.3a.cmml">rand</mtext></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p9.6.m6.1b"><apply id="A3.SS4.p9.6.m6.1.1.cmml" xref="A3.SS4.p9.6.m6.1.1"><eq id="A3.SS4.p9.6.m6.1.1.2.cmml" xref="A3.SS4.p9.6.m6.1.1.2"></eq><apply id="A3.SS4.p9.6.m6.1.1.3.cmml" xref="A3.SS4.p9.6.m6.1.1.3"><csymbol cd="ambiguous" id="A3.SS4.p9.6.m6.1.1.3.1.cmml" xref="A3.SS4.p9.6.m6.1.1.3">superscript</csymbol><ci id="A3.SS4.p9.6.m6.1.1.3.2.cmml" xref="A3.SS4.p9.6.m6.1.1.3.2">𝒒</ci><ci id="A3.SS4.p9.6.m6.1.1.3.3.cmml" xref="A3.SS4.p9.6.m6.1.1.3.3">′</ci></apply><apply id="A3.SS4.p9.6.m6.1.1.1.cmml" xref="A3.SS4.p9.6.m6.1.1.1"><plus id="A3.SS4.p9.6.m6.1.1.1.2.cmml" xref="A3.SS4.p9.6.m6.1.1.1.2"></plus><apply id="A3.SS4.p9.6.m6.1.1.1.3.cmml" xref="A3.SS4.p9.6.m6.1.1.1.3"><times id="A3.SS4.p9.6.m6.1.1.1.3.1.cmml" xref="A3.SS4.p9.6.m6.1.1.1.3.1"></times><ci id="A3.SS4.p9.6.m6.1.1.1.3.2.cmml" xref="A3.SS4.p9.6.m6.1.1.1.3.2">𝒒</ci><apply id="A3.SS4.p9.6.m6.1.1.1.3.3.cmml" xref="A3.SS4.p9.6.m6.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.SS4.p9.6.m6.1.1.1.3.3.1.cmml" xref="A3.SS4.p9.6.m6.1.1.1.3.3">subscript</csymbol><ci id="A3.SS4.p9.6.m6.1.1.1.3.3.2.cmml" xref="A3.SS4.p9.6.m6.1.1.1.3.3.2">𝛼</ci><ci id="A3.SS4.p9.6.m6.1.1.1.3.3.3a.cmml" xref="A3.SS4.p9.6.m6.1.1.1.3.3.3"><mtext id="A3.SS4.p9.6.m6.1.1.1.3.3.3.cmml" mathsize="70%" xref="A3.SS4.p9.6.m6.1.1.1.3.3.3">blend</mtext></ci></apply></apply><apply id="A3.SS4.p9.6.m6.1.1.1.1.cmml" xref="A3.SS4.p9.6.m6.1.1.1.1"><times id="A3.SS4.p9.6.m6.1.1.1.1.2.cmml" xref="A3.SS4.p9.6.m6.1.1.1.1.2"></times><apply id="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.cmml" xref="A3.SS4.p9.6.m6.1.1.1.1.1.1"><minus id="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.1.cmml" xref="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.1"></minus><cn id="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.2.cmml" type="integer" xref="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.2">1</cn><ci id="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.3.cmml" xref="A3.SS4.p9.6.m6.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="A3.SS4.p9.6.m6.1.1.1.1.3.cmml" xref="A3.SS4.p9.6.m6.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.SS4.p9.6.m6.1.1.1.1.3.1.cmml" xref="A3.SS4.p9.6.m6.1.1.1.1.3">subscript</csymbol><ci id="A3.SS4.p9.6.m6.1.1.1.1.3.2.cmml" xref="A3.SS4.p9.6.m6.1.1.1.1.3.2">𝒒</ci><ci id="A3.SS4.p9.6.m6.1.1.1.1.3.3a.cmml" xref="A3.SS4.p9.6.m6.1.1.1.1.3.3"><mtext id="A3.SS4.p9.6.m6.1.1.1.1.3.3.cmml" mathsize="70%" xref="A3.SS4.p9.6.m6.1.1.1.1.3.3">rand</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p9.6.m6.1c">\bm{q}^{\prime}=\bm{q}*\alpha_{\text{blend}}+(1-\alpha)\bm{q}_{\text{rand}}</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p9.6.m6.1d">bold_italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = bold_italic_q ∗ italic_α start_POSTSUBSCRIPT blend end_POSTSUBSCRIPT + ( 1 - italic_α ) bold_italic_q start_POSTSUBSCRIPT rand end_POSTSUBSCRIPT</annotation></semantics></math>.
For Meta-World and DMControl we additionally set <math alttext="\alpha_{\text{blend}}=0.5" class="ltx_Math" display="inline" id="A3.SS4.p9.7.m7.1"><semantics id="A3.SS4.p9.7.m7.1a"><mrow id="A3.SS4.p9.7.m7.1.1" xref="A3.SS4.p9.7.m7.1.1.cmml"><msub id="A3.SS4.p9.7.m7.1.1.2" xref="A3.SS4.p9.7.m7.1.1.2.cmml"><mi id="A3.SS4.p9.7.m7.1.1.2.2" xref="A3.SS4.p9.7.m7.1.1.2.2.cmml">α</mi><mtext id="A3.SS4.p9.7.m7.1.1.2.3" xref="A3.SS4.p9.7.m7.1.1.2.3a.cmml">blend</mtext></msub><mo id="A3.SS4.p9.7.m7.1.1.1" xref="A3.SS4.p9.7.m7.1.1.1.cmml">=</mo><mn id="A3.SS4.p9.7.m7.1.1.3" xref="A3.SS4.p9.7.m7.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p9.7.m7.1b"><apply id="A3.SS4.p9.7.m7.1.1.cmml" xref="A3.SS4.p9.7.m7.1.1"><eq id="A3.SS4.p9.7.m7.1.1.1.cmml" xref="A3.SS4.p9.7.m7.1.1.1"></eq><apply id="A3.SS4.p9.7.m7.1.1.2.cmml" xref="A3.SS4.p9.7.m7.1.1.2"><csymbol cd="ambiguous" id="A3.SS4.p9.7.m7.1.1.2.1.cmml" xref="A3.SS4.p9.7.m7.1.1.2">subscript</csymbol><ci id="A3.SS4.p9.7.m7.1.1.2.2.cmml" xref="A3.SS4.p9.7.m7.1.1.2.2">𝛼</ci><ci id="A3.SS4.p9.7.m7.1.1.2.3a.cmml" xref="A3.SS4.p9.7.m7.1.1.2.3"><mtext id="A3.SS4.p9.7.m7.1.1.2.3.cmml" mathsize="70%" xref="A3.SS4.p9.7.m7.1.1.2.3">blend</mtext></ci></apply><cn id="A3.SS4.p9.7.m7.1.1.3.cmml" type="float" xref="A3.SS4.p9.7.m7.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p9.7.m7.1c">\alpha_{\text{blend}}=0.5</annotation><annotation encoding="application/x-llamapun" id="A3.SS4.p9.7.m7.1d">italic_α start_POSTSUBSCRIPT blend end_POSTSUBSCRIPT = 0.5</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS4.p10">
<p class="ltx_p" id="A3.SS4.p10.1">On Dark-Room and Dark Key-Door environments, we found it useful to replace retrieved experiences with experiences randomly sampled from the same task, if the query sub-sequence is from the beginning of the episode (i.e., smaller than timestep 10).
This is because on these two environments, retrieving appropriate experience can be difficult if the given query sub-sequence is too short.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.SS4.p11">
<p class="ltx_p" id="A3.SS4.p11.1">Finally, we use the same RTG-conditioning strategy as the vanilla DT, as described in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS2" title="C.2 Decision Transformer ‣ Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">C.2</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> RA-DT at training time</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l0">
<span class="ltx_tag ltx_tag_listingline">0:</span>  DT <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg2.l0.m1.1"><semantics id="alg2.l0.m1.1a"><msub id="alg2.l0.m1.1.1" xref="alg2.l0.m1.1.1.cmml"><mi id="alg2.l0.m1.1.1.2" xref="alg2.l0.m1.1.1.2.cmml">π</mi><mi id="alg2.l0.m1.1.1.3" xref="alg2.l0.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m1.1b"><apply id="alg2.l0.m1.1.1.cmml" xref="alg2.l0.m1.1.1"><csymbol cd="ambiguous" id="alg2.l0.m1.1.1.1.cmml" xref="alg2.l0.m1.1.1">subscript</csymbol><ci id="alg2.l0.m1.1.1.2.cmml" xref="alg2.l0.m1.1.1.2">𝜋</ci><ci id="alg2.l0.m1.1.1.3.cmml" xref="alg2.l0.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, embed model <math alttext="g" class="ltx_Math" display="inline" id="alg2.l0.m2.1"><semantics id="alg2.l0.m2.1a"><mi id="alg2.l0.m2.1.1" xref="alg2.l0.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m2.1b"><ci id="alg2.l0.m2.1.1.cmml" xref="alg2.l0.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m2.1c">g</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m2.1d">italic_g</annotation></semantics></math>, dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg2.l0.m3.1"><semantics id="alg2.l0.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l0.m3.1.1" xref="alg2.l0.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m3.1b"><ci id="alg2.l0.m3.1.1.cmml" xref="alg2.l0.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m3.1d">caligraphic_D</annotation></semantics></math>, gradient steps <math alttext="N" class="ltx_Math" display="inline" id="alg2.l0.m4.1"><semantics id="alg2.l0.m4.1a"><mi id="alg2.l0.m4.1.1" xref="alg2.l0.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m4.1b"><ci id="alg2.l0.m4.1.1.cmml" xref="alg2.l0.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m4.1d">italic_N</annotation></semantics></math>, context len <math alttext="C" class="ltx_Math" display="inline" id="alg2.l0.m5.1"><semantics id="alg2.l0.m5.1a"><mi id="alg2.l0.m5.1.1" xref="alg2.l0.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m5.1b"><ci id="alg2.l0.m5.1.1.cmml" xref="alg2.l0.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m5.1d">italic_C</annotation></semantics></math>, batch size <math alttext="B" class="ltx_Math" display="inline" id="alg2.l0.m6.1"><semantics id="alg2.l0.m6.1a"><mi id="alg2.l0.m6.1.1" xref="alg2.l0.m6.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m6.1b"><ci id="alg2.l0.m6.1.1.cmml" xref="alg2.l0.m6.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m6.1c">B</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m6.1d">italic_B</annotation></semantics></math>, eval frequency <math alttext="E" class="ltx_Math" display="inline" id="alg2.l0.m7.1"><semantics id="alg2.l0.m7.1a"><mi id="alg2.l0.m7.1.1" xref="alg2.l0.m7.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m7.1b"><ci id="alg2.l0.m7.1.1.cmml" xref="alg2.l0.m7.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m7.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m7.1d">italic_E</annotation></semantics></math>, loss function <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="alg2.l0.m8.1"><semantics id="alg2.l0.m8.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l0.m8.1.1" xref="alg2.l0.m8.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m8.1b"><ci id="alg2.l0.m8.1.1.cmml" xref="alg2.l0.m8.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m8.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="alg2.l0.m8.1d">caligraphic_L</annotation></semantics></math> (cross-entropy or MSE), <span class="ltx_text ltx_font_typewriter" id="alg2.l0.1">evaluate</span>, batch-wise procedures <span class="ltx_text ltx_font_typewriter" id="alg2.l0.2">retrieve</span>, <span class="ltx_text ltx_font_typewriter" id="alg2.l0.3">reweight</span>, and <span class="ltx_text ltx_font_typewriter" id="alg2.l0.4">update</span>
</div>
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math alttext="\mathcal{I}\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mrow id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml">ℐ</mi><mo id="alg2.l1.m1.1.1.1" stretchy="false" xref="alg2.l1.m1.1.1.1.cmml">←</mo><mi id="alg2.l1.m1.1.1.3" mathvariant="normal" xref="alg2.l1.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><ci id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1">←</ci><ci id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2">ℐ</ci><emptyset id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\mathcal{I}\leftarrow\emptyset</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">caligraphic_I ← ∅</annotation></semantics></math> <span class="ltx_text" id="alg2.l1.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l1.1.m1.1"><semantics id="alg2.l1.1.m1.1a"><mo id="alg2.l1.1.m1.1.1" xref="alg2.l1.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l1.1.m1.1b"><ci id="alg2.l1.1.m1.1.1.cmml" xref="alg2.l1.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.1.m1.1d">▷</annotation></semantics></math> Initialize retrieval index <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="alg2.l1.2.m2.1"><semantics id="alg2.l1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.2.m2.1.1" xref="alg2.l1.2.m2.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.2.m2.1b"><ci id="alg2.l1.2.m2.1.1.cmml" xref="alg2.l1.2.m2.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.2.m2.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.2.m2.1d">caligraphic_I</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span class="ltx_text ltx_font_bold" id="alg2.l2.1">for</span> <math alttext="\tau\in\mathcal{D}" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">τ</mi><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><in id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></in><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝜏</ci><ci id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\tau\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_τ ∈ caligraphic_D</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l2.2">do</span>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <math alttext="\mathcal{I}\leftarrow\mathcal{I}\cup\{(g(\tau_{t-C:t}),\tau_{t-C:t+C})\mid t%
\in\text{range}(0,|\tau|,C)\}" class="ltx_Math" display="inline" id="alg2.l3.m1.5"><semantics id="alg2.l3.m1.5a"><mrow id="alg2.l3.m1.5.5" xref="alg2.l3.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.5.5.4" xref="alg2.l3.m1.5.5.4.cmml">ℐ</mi><mo id="alg2.l3.m1.5.5.3" stretchy="false" xref="alg2.l3.m1.5.5.3.cmml">←</mo><mrow id="alg2.l3.m1.5.5.2" xref="alg2.l3.m1.5.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.5.5.2.4" xref="alg2.l3.m1.5.5.2.4.cmml">ℐ</mi><mo id="alg2.l3.m1.5.5.2.3" xref="alg2.l3.m1.5.5.2.3.cmml">∪</mo><mrow id="alg2.l3.m1.5.5.2.2.2" xref="alg2.l3.m1.5.5.2.2.3.cmml"><mo id="alg2.l3.m1.5.5.2.2.2.3" stretchy="false" xref="alg2.l3.m1.5.5.2.2.3.1.cmml">{</mo><mrow id="alg2.l3.m1.4.4.1.1.1.1.2" xref="alg2.l3.m1.4.4.1.1.1.1.3.cmml"><mo id="alg2.l3.m1.4.4.1.1.1.1.2.3" stretchy="false" xref="alg2.l3.m1.4.4.1.1.1.1.3.cmml">(</mo><mrow id="alg2.l3.m1.4.4.1.1.1.1.1.1" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.cmml"><mi id="alg2.l3.m1.4.4.1.1.1.1.1.1.3" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.3.cmml">g</mi><mo id="alg2.l3.m1.4.4.1.1.1.1.1.1.2" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">τ</mi><mrow id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2.cmml">t</mi><mo id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.1" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.1.cmml">−</mo><mi id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.3" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.3.cmml">C</mi></mrow><mo id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.3" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l3.m1.4.4.1.1.1.1.2.4" xref="alg2.l3.m1.4.4.1.1.1.1.3.cmml">,</mo><msub id="alg2.l3.m1.4.4.1.1.1.1.2.2" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.cmml"><mi id="alg2.l3.m1.4.4.1.1.1.1.2.2.2" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.2.cmml">τ</mi><mrow id="alg2.l3.m1.4.4.1.1.1.1.2.2.3" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.cmml"><mrow id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.cmml"><mi id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.2" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.2.cmml">t</mi><mo id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.1" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.1.cmml">−</mo><mi id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.3" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.3.cmml">C</mi></mrow><mo id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.1.cmml">:</mo><mrow id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.cmml"><mi id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.2" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.2.cmml">t</mi><mo id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.1" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.1.cmml">+</mo><mi id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.3" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.3.cmml">C</mi></mrow></mrow></msub><mo id="alg2.l3.m1.4.4.1.1.1.1.2.5" stretchy="false" xref="alg2.l3.m1.4.4.1.1.1.1.3.cmml">)</mo></mrow><mo fence="true" id="alg2.l3.m1.5.5.2.2.2.4" lspace="0em" rspace="0em" xref="alg2.l3.m1.5.5.2.2.3.1.cmml">∣</mo><mrow id="alg2.l3.m1.5.5.2.2.2.2" xref="alg2.l3.m1.5.5.2.2.2.2.cmml"><mi id="alg2.l3.m1.5.5.2.2.2.2.3" xref="alg2.l3.m1.5.5.2.2.2.2.3.cmml">t</mi><mo id="alg2.l3.m1.5.5.2.2.2.2.2" xref="alg2.l3.m1.5.5.2.2.2.2.2.cmml">∈</mo><mrow id="alg2.l3.m1.5.5.2.2.2.2.1" xref="alg2.l3.m1.5.5.2.2.2.2.1.cmml"><mtext id="alg2.l3.m1.5.5.2.2.2.2.1.3" xref="alg2.l3.m1.5.5.2.2.2.2.1.3a.cmml">range</mtext><mo id="alg2.l3.m1.5.5.2.2.2.2.1.2" xref="alg2.l3.m1.5.5.2.2.2.2.1.2.cmml">⁢</mo><mrow id="alg2.l3.m1.5.5.2.2.2.2.1.1.1" xref="alg2.l3.m1.5.5.2.2.2.2.1.1.2.cmml"><mo id="alg2.l3.m1.5.5.2.2.2.2.1.1.1.2" stretchy="false" xref="alg2.l3.m1.5.5.2.2.2.2.1.1.2.cmml">(</mo><mn id="alg2.l3.m1.2.2" xref="alg2.l3.m1.2.2.cmml">0</mn><mo id="alg2.l3.m1.5.5.2.2.2.2.1.1.1.3" xref="alg2.l3.m1.5.5.2.2.2.2.1.1.2.cmml">,</mo><mrow id="alg2.l3.m1.5.5.2.2.2.2.1.1.1.1.2" xref="alg2.l3.m1.5.5.2.2.2.2.1.1.1.1.1.cmml"><mo id="alg2.l3.m1.5.5.2.2.2.2.1.1.1.1.2.1" stretchy="false" xref="alg2.l3.m1.5.5.2.2.2.2.1.1.1.1.1.1.cmml">|</mo><mi id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">τ</mi><mo id="alg2.l3.m1.5.5.2.2.2.2.1.1.1.1.2.2" stretchy="false" xref="alg2.l3.m1.5.5.2.2.2.2.1.1.1.1.1.1.cmml">|</mo></mrow><mo id="alg2.l3.m1.5.5.2.2.2.2.1.1.1.4" xref="alg2.l3.m1.5.5.2.2.2.2.1.1.2.cmml">,</mo><mi id="alg2.l3.m1.3.3" xref="alg2.l3.m1.3.3.cmml">C</mi><mo id="alg2.l3.m1.5.5.2.2.2.2.1.1.1.5" stretchy="false" xref="alg2.l3.m1.5.5.2.2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="alg2.l3.m1.5.5.2.2.2.5" stretchy="false" xref="alg2.l3.m1.5.5.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.5b"><apply id="alg2.l3.m1.5.5.cmml" xref="alg2.l3.m1.5.5"><ci id="alg2.l3.m1.5.5.3.cmml" xref="alg2.l3.m1.5.5.3">←</ci><ci id="alg2.l3.m1.5.5.4.cmml" xref="alg2.l3.m1.5.5.4">ℐ</ci><apply id="alg2.l3.m1.5.5.2.cmml" xref="alg2.l3.m1.5.5.2"><union id="alg2.l3.m1.5.5.2.3.cmml" xref="alg2.l3.m1.5.5.2.3"></union><ci id="alg2.l3.m1.5.5.2.4.cmml" xref="alg2.l3.m1.5.5.2.4">ℐ</ci><apply id="alg2.l3.m1.5.5.2.2.3.cmml" xref="alg2.l3.m1.5.5.2.2.2"><csymbol cd="latexml" id="alg2.l3.m1.5.5.2.2.3.1.cmml" xref="alg2.l3.m1.5.5.2.2.2.3">conditional-set</csymbol><interval closure="open" id="alg2.l3.m1.4.4.1.1.1.1.3.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2"><apply id="alg2.l3.m1.4.4.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1"><times id="alg2.l3.m1.4.4.1.1.1.1.1.1.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.2"></times><ci id="alg2.l3.m1.4.4.1.1.1.1.1.1.3.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.3">𝑔</ci><apply id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝜏</ci><apply id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3"><ci id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.1">:</ci><apply id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2"><minus id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.1"></minus><ci id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2">𝑡</ci><ci id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.3">𝐶</ci></apply><ci id="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="alg2.l3.m1.4.4.1.1.1.1.2.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l3.m1.4.4.1.1.1.1.2.2.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2">subscript</csymbol><ci id="alg2.l3.m1.4.4.1.1.1.1.2.2.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.2">𝜏</ci><apply id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3"><ci id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.1">:</ci><apply id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2"><minus id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.1"></minus><ci id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.2">𝑡</ci><ci id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.3.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.2.3">𝐶</ci></apply><apply id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3"><plus id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.1.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.1"></plus><ci id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.2.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.2">𝑡</ci><ci id="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.3.cmml" xref="alg2.l3.m1.4.4.1.1.1.1.2.2.3.3.3">𝐶</ci></apply></apply></apply></interval><apply id="alg2.l3.m1.5.5.2.2.2.2.cmml" xref="alg2.l3.m1.5.5.2.2.2.2"><in id="alg2.l3.m1.5.5.2.2.2.2.2.cmml" xref="alg2.l3.m1.5.5.2.2.2.2.2"></in><ci id="alg2.l3.m1.5.5.2.2.2.2.3.cmml" xref="alg2.l3.m1.5.5.2.2.2.2.3">𝑡</ci><apply id="alg2.l3.m1.5.5.2.2.2.2.1.cmml" xref="alg2.l3.m1.5.5.2.2.2.2.1"><times id="alg2.l3.m1.5.5.2.2.2.2.1.2.cmml" xref="alg2.l3.m1.5.5.2.2.2.2.1.2"></times><ci id="alg2.l3.m1.5.5.2.2.2.2.1.3a.cmml" xref="alg2.l3.m1.5.5.2.2.2.2.1.3"><mtext id="alg2.l3.m1.5.5.2.2.2.2.1.3.cmml" xref="alg2.l3.m1.5.5.2.2.2.2.1.3">range</mtext></ci><vector id="alg2.l3.m1.5.5.2.2.2.2.1.1.2.cmml" xref="alg2.l3.m1.5.5.2.2.2.2.1.1.1"><cn id="alg2.l3.m1.2.2.cmml" type="integer" xref="alg2.l3.m1.2.2">0</cn><apply id="alg2.l3.m1.5.5.2.2.2.2.1.1.1.1.1.cmml" xref="alg2.l3.m1.5.5.2.2.2.2.1.1.1.1.2"><abs id="alg2.l3.m1.5.5.2.2.2.2.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.5.5.2.2.2.2.1.1.1.1.2.1"></abs><ci id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">𝜏</ci></apply><ci id="alg2.l3.m1.3.3.cmml" xref="alg2.l3.m1.3.3">𝐶</ci></vector></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.5c">\mathcal{I}\leftarrow\mathcal{I}\cup\{(g(\tau_{t-C:t}),\tau_{t-C:t+C})\mid t%
\in\text{range}(0,|\tau|,C)\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.5d">caligraphic_I ← caligraphic_I ∪ { ( italic_g ( italic_τ start_POSTSUBSCRIPT italic_t - italic_C : italic_t end_POSTSUBSCRIPT ) , italic_τ start_POSTSUBSCRIPT italic_t - italic_C : italic_t + italic_C end_POSTSUBSCRIPT ) ∣ italic_t ∈ range ( 0 , | italic_τ | , italic_C ) }</annotation></semantics></math> <span class="ltx_text" id="alg2.l3.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l3.1.m1.1"><semantics id="alg2.l3.1.m1.1a"><mo id="alg2.l3.1.m1.1.1" xref="alg2.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l3.1.m1.1b"><ci id="alg2.l3.1.m1.1.1.cmml" xref="alg2.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.1.m1.1d">▷</annotation></semantics></math> Add k-v pairs of sub-trjs to <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="alg2.l3.2.m2.1"><semantics id="alg2.l3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.2.m2.1.1" xref="alg2.l3.2.m2.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.2.m2.1b"><ci id="alg2.l3.2.m2.1.1.cmml" xref="alg2.l3.2.m2.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.2.m2.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.2.m2.1d">caligraphic_I</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>  <span class="ltx_text ltx_font_bold" id="alg2.l4.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l4.2">for</span>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>  <span class="ltx_text ltx_font_bold" id="alg2.l5.1">for</span> <math alttext="i=1\ldots N" class="ltx_Math" display="inline" id="alg2.l5.m1.1"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mi id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">i</mi><mo id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">=</mo><mrow id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml"><mn id="alg2.l5.m1.1.1.3.2" xref="alg2.l5.m1.1.1.3.2.cmml">1</mn><mo id="alg2.l5.m1.1.1.3.1" xref="alg2.l5.m1.1.1.3.1.cmml">⁢</mo><mi id="alg2.l5.m1.1.1.3.3" mathvariant="normal" xref="alg2.l5.m1.1.1.3.3.cmml">…</mi><mo id="alg2.l5.m1.1.1.3.1a" xref="alg2.l5.m1.1.1.3.1.cmml">⁢</mo><mi id="alg2.l5.m1.1.1.3.4" xref="alg2.l5.m1.1.1.3.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><eq id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1"></eq><ci id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">𝑖</ci><apply id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3"><times id="alg2.l5.m1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.3.1"></times><cn id="alg2.l5.m1.1.1.3.2.cmml" type="integer" xref="alg2.l5.m1.1.1.3.2">1</cn><ci id="alg2.l5.m1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.3.3">…</ci><ci id="alg2.l5.m1.1.1.3.4.cmml" xref="alg2.l5.m1.1.1.3.4">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">i=1\ldots N</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">italic_i = 1 … italic_N</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l5.2">do</span>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math alttext="\mathbf{b}\sim\mathcal{D}" class="ltx_Math" display="inline" id="alg2.l6.m1.1"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mi id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml">𝐛</mi><mo id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><csymbol cd="latexml" id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1">similar-to</csymbol><ci id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">𝐛</ci><ci id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\mathbf{b}\sim\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">bold_b ∼ caligraphic_D</annotation></semantics></math> where <math alttext="\mathbf{b}=\{\tau_{j}\ \mid 1\leq j\leq B\}" class="ltx_Math" display="inline" id="alg2.l6.m2.2"><semantics id="alg2.l6.m2.2a"><mrow id="alg2.l6.m2.2.2" xref="alg2.l6.m2.2.2.cmml"><mi id="alg2.l6.m2.2.2.4" xref="alg2.l6.m2.2.2.4.cmml">𝐛</mi><mo id="alg2.l6.m2.2.2.3" xref="alg2.l6.m2.2.2.3.cmml">=</mo><mrow id="alg2.l6.m2.2.2.2.2" xref="alg2.l6.m2.2.2.2.3.cmml"><mo id="alg2.l6.m2.2.2.2.2.3" stretchy="false" xref="alg2.l6.m2.2.2.2.3.1.cmml">{</mo><msub id="alg2.l6.m2.1.1.1.1.1" xref="alg2.l6.m2.1.1.1.1.1.cmml"><mi id="alg2.l6.m2.1.1.1.1.1.2" xref="alg2.l6.m2.1.1.1.1.1.2.cmml">τ</mi><mi id="alg2.l6.m2.1.1.1.1.1.3" xref="alg2.l6.m2.1.1.1.1.1.3.cmml">j</mi></msub><mo fence="true" id="alg2.l6.m2.2.2.2.2.4" lspace="0em" rspace="0em" xref="alg2.l6.m2.2.2.2.3.1.cmml">∣</mo><mrow id="alg2.l6.m2.2.2.2.2.2" xref="alg2.l6.m2.2.2.2.2.2.cmml"><mn id="alg2.l6.m2.2.2.2.2.2.2" xref="alg2.l6.m2.2.2.2.2.2.2.cmml">1</mn><mo id="alg2.l6.m2.2.2.2.2.2.3" xref="alg2.l6.m2.2.2.2.2.2.3.cmml">≤</mo><mi id="alg2.l6.m2.2.2.2.2.2.4" xref="alg2.l6.m2.2.2.2.2.2.4.cmml">j</mi><mo id="alg2.l6.m2.2.2.2.2.2.5" xref="alg2.l6.m2.2.2.2.2.2.5.cmml">≤</mo><mi id="alg2.l6.m2.2.2.2.2.2.6" xref="alg2.l6.m2.2.2.2.2.2.6.cmml">B</mi></mrow><mo id="alg2.l6.m2.2.2.2.2.5" stretchy="false" xref="alg2.l6.m2.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.2b"><apply id="alg2.l6.m2.2.2.cmml" xref="alg2.l6.m2.2.2"><eq id="alg2.l6.m2.2.2.3.cmml" xref="alg2.l6.m2.2.2.3"></eq><ci id="alg2.l6.m2.2.2.4.cmml" xref="alg2.l6.m2.2.2.4">𝐛</ci><apply id="alg2.l6.m2.2.2.2.3.cmml" xref="alg2.l6.m2.2.2.2.2"><csymbol cd="latexml" id="alg2.l6.m2.2.2.2.3.1.cmml" xref="alg2.l6.m2.2.2.2.2.3">conditional-set</csymbol><apply id="alg2.l6.m2.1.1.1.1.1.cmml" xref="alg2.l6.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m2.1.1.1.1.1.1.cmml" xref="alg2.l6.m2.1.1.1.1.1">subscript</csymbol><ci id="alg2.l6.m2.1.1.1.1.1.2.cmml" xref="alg2.l6.m2.1.1.1.1.1.2">𝜏</ci><ci id="alg2.l6.m2.1.1.1.1.1.3.cmml" xref="alg2.l6.m2.1.1.1.1.1.3">𝑗</ci></apply><apply id="alg2.l6.m2.2.2.2.2.2.cmml" xref="alg2.l6.m2.2.2.2.2.2"><and id="alg2.l6.m2.2.2.2.2.2a.cmml" xref="alg2.l6.m2.2.2.2.2.2"></and><apply id="alg2.l6.m2.2.2.2.2.2b.cmml" xref="alg2.l6.m2.2.2.2.2.2"><leq id="alg2.l6.m2.2.2.2.2.2.3.cmml" xref="alg2.l6.m2.2.2.2.2.2.3"></leq><cn id="alg2.l6.m2.2.2.2.2.2.2.cmml" type="integer" xref="alg2.l6.m2.2.2.2.2.2.2">1</cn><ci id="alg2.l6.m2.2.2.2.2.2.4.cmml" xref="alg2.l6.m2.2.2.2.2.2.4">𝑗</ci></apply><apply id="alg2.l6.m2.2.2.2.2.2c.cmml" xref="alg2.l6.m2.2.2.2.2.2"><leq id="alg2.l6.m2.2.2.2.2.2.5.cmml" xref="alg2.l6.m2.2.2.2.2.2.5"></leq><share href="https://arxiv.org/html/2410.07071v1#alg2.l6.m2.2.2.2.2.2.4.cmml" id="alg2.l6.m2.2.2.2.2.2d.cmml" xref="alg2.l6.m2.2.2.2.2.2"></share><ci id="alg2.l6.m2.2.2.2.2.2.6.cmml" xref="alg2.l6.m2.2.2.2.2.2.6">𝐵</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.2c">\mathbf{b}=\{\tau_{j}\ \mid 1\leq j\leq B\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m2.2d">bold_b = { italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∣ 1 ≤ italic_j ≤ italic_B }</annotation></semantics></math> <span class="ltx_text" id="alg2.l6.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l6.1.m1.1"><semantics id="alg2.l6.1.m1.1a"><mo id="alg2.l6.1.m1.1.1" xref="alg2.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l6.1.m1.1b"><ci id="alg2.l6.1.m1.1.1.cmml" xref="alg2.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.1.m1.1d">▷</annotation></semantics></math> Sample batch of sub-trjs each of length <math alttext="C" class="ltx_Math" display="inline" id="alg2.l6.2.m2.1"><semantics id="alg2.l6.2.m2.1a"><mi id="alg2.l6.2.m2.1.1" xref="alg2.l6.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.2.m2.1b"><ci id="alg2.l6.2.m2.1.1.cmml" xref="alg2.l6.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.2.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.2.m2.1d">italic_C</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math alttext="\mathbf{q}=g(\mathbf{b})" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.2" xref="alg2.l7.m1.1.2.cmml"><mi id="alg2.l7.m1.1.2.2" xref="alg2.l7.m1.1.2.2.cmml">𝐪</mi><mo id="alg2.l7.m1.1.2.1" xref="alg2.l7.m1.1.2.1.cmml">=</mo><mrow id="alg2.l7.m1.1.2.3" xref="alg2.l7.m1.1.2.3.cmml"><mi id="alg2.l7.m1.1.2.3.2" xref="alg2.l7.m1.1.2.3.2.cmml">g</mi><mo id="alg2.l7.m1.1.2.3.1" xref="alg2.l7.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l7.m1.1.2.3.3.2" xref="alg2.l7.m1.1.2.3.cmml"><mo id="alg2.l7.m1.1.2.3.3.2.1" stretchy="false" xref="alg2.l7.m1.1.2.3.cmml">(</mo><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">𝐛</mi><mo id="alg2.l7.m1.1.2.3.3.2.2" stretchy="false" xref="alg2.l7.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.2.cmml" xref="alg2.l7.m1.1.2"><eq id="alg2.l7.m1.1.2.1.cmml" xref="alg2.l7.m1.1.2.1"></eq><ci id="alg2.l7.m1.1.2.2.cmml" xref="alg2.l7.m1.1.2.2">𝐪</ci><apply id="alg2.l7.m1.1.2.3.cmml" xref="alg2.l7.m1.1.2.3"><times id="alg2.l7.m1.1.2.3.1.cmml" xref="alg2.l7.m1.1.2.3.1"></times><ci id="alg2.l7.m1.1.2.3.2.cmml" xref="alg2.l7.m1.1.2.3.2">𝑔</ci><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝐛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">\mathbf{q}=g(\mathbf{b})</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">bold_q = italic_g ( bold_b )</annotation></semantics></math> <span class="ltx_text" id="alg2.l7.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l7.1.m1.1"><semantics id="alg2.l7.1.m1.1a"><mo id="alg2.l7.1.m1.1.1" xref="alg2.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l7.1.m1.1b"><ci id="alg2.l7.1.m1.1.1.cmml" xref="alg2.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.1.m1.1d">▷</annotation></semantics></math> Construct queries for all sub-trjs
</span>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math alttext="\mathcal{R}\leftarrow\text{{retrieve}}(\mathbf{q},\mathcal{I})" class="ltx_Math" display="inline" id="alg2.l8.m1.2"><semantics id="alg2.l8.m1.2a"><mrow id="alg2.l8.m1.2.3" xref="alg2.l8.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.2.3.2" xref="alg2.l8.m1.2.3.2.cmml">ℛ</mi><mo id="alg2.l8.m1.2.3.1" stretchy="false" xref="alg2.l8.m1.2.3.1.cmml">←</mo><mrow id="alg2.l8.m1.2.3.3" xref="alg2.l8.m1.2.3.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l8.m1.2.3.3.2" xref="alg2.l8.m1.2.3.3.2a.cmml">retrieve</mtext><mo id="alg2.l8.m1.2.3.3.1" xref="alg2.l8.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg2.l8.m1.2.3.3.3.2" xref="alg2.l8.m1.2.3.3.3.1.cmml"><mo id="alg2.l8.m1.2.3.3.3.2.1" stretchy="false" xref="alg2.l8.m1.2.3.3.3.1.cmml">(</mo><mi id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">𝐪</mi><mo id="alg2.l8.m1.2.3.3.3.2.2" xref="alg2.l8.m1.2.3.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.2.2" xref="alg2.l8.m1.2.2.cmml">ℐ</mi><mo id="alg2.l8.m1.2.3.3.3.2.3" stretchy="false" xref="alg2.l8.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.2b"><apply id="alg2.l8.m1.2.3.cmml" xref="alg2.l8.m1.2.3"><ci id="alg2.l8.m1.2.3.1.cmml" xref="alg2.l8.m1.2.3.1">←</ci><ci id="alg2.l8.m1.2.3.2.cmml" xref="alg2.l8.m1.2.3.2">ℛ</ci><apply id="alg2.l8.m1.2.3.3.cmml" xref="alg2.l8.m1.2.3.3"><times id="alg2.l8.m1.2.3.3.1.cmml" xref="alg2.l8.m1.2.3.3.1"></times><ci id="alg2.l8.m1.2.3.3.2a.cmml" xref="alg2.l8.m1.2.3.3.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l8.m1.2.3.3.2.cmml" xref="alg2.l8.m1.2.3.3.2">retrieve</mtext></ci><interval closure="open" id="alg2.l8.m1.2.3.3.3.1.cmml" xref="alg2.l8.m1.2.3.3.3.2"><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">𝐪</ci><ci id="alg2.l8.m1.2.2.cmml" xref="alg2.l8.m1.2.2">ℐ</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.2c">\mathcal{R}\leftarrow\text{{retrieve}}(\mathbf{q},\mathcal{I})</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.2d">caligraphic_R ← retrieve ( bold_q , caligraphic_I )</annotation></semantics></math> <span class="ltx_text" id="alg2.l8.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l8.1.m1.1"><semantics id="alg2.l8.1.m1.1a"><mo id="alg2.l8.1.m1.1.1" xref="alg2.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l8.1.m1.1b"><ci id="alg2.l8.1.m1.1.1.cmml" xref="alg2.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.1.m1.1d">▷</annotation></semantics></math> Retrieve top-<math alttext="l" class="ltx_Math" display="inline" id="alg2.l8.2.m2.1"><semantics id="alg2.l8.2.m2.1a"><mi id="alg2.l8.2.m2.1.1" xref="alg2.l8.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg2.l8.2.m2.1b"><ci id="alg2.l8.2.m2.1.1.cmml" xref="alg2.l8.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.2.m2.1d">italic_l</annotation></semantics></math> sub-trjs, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.E3" title="In 3.2.2 Searching for Similar Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3</span></a>
</span>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math alttext="\mathcal{S}\leftarrow\text{{reweight}}(\mathcal{R})" class="ltx_Math" display="inline" id="alg2.l9.m1.1"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.2" xref="alg2.l9.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.1.2.2" xref="alg2.l9.m1.1.2.2.cmml">𝒮</mi><mo id="alg2.l9.m1.1.2.1" stretchy="false" xref="alg2.l9.m1.1.2.1.cmml">←</mo><mrow id="alg2.l9.m1.1.2.3" xref="alg2.l9.m1.1.2.3.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l9.m1.1.2.3.2" xref="alg2.l9.m1.1.2.3.2a.cmml">reweight</mtext><mo id="alg2.l9.m1.1.2.3.1" xref="alg2.l9.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l9.m1.1.2.3.3.2" xref="alg2.l9.m1.1.2.3.cmml"><mo id="alg2.l9.m1.1.2.3.3.2.1" stretchy="false" xref="alg2.l9.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">ℛ</mi><mo id="alg2.l9.m1.1.2.3.3.2.2" stretchy="false" xref="alg2.l9.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.2.cmml" xref="alg2.l9.m1.1.2"><ci id="alg2.l9.m1.1.2.1.cmml" xref="alg2.l9.m1.1.2.1">←</ci><ci id="alg2.l9.m1.1.2.2.cmml" xref="alg2.l9.m1.1.2.2">𝒮</ci><apply id="alg2.l9.m1.1.2.3.cmml" xref="alg2.l9.m1.1.2.3"><times id="alg2.l9.m1.1.2.3.1.cmml" xref="alg2.l9.m1.1.2.3.1"></times><ci id="alg2.l9.m1.1.2.3.2a.cmml" xref="alg2.l9.m1.1.2.3.2"><mtext class="ltx_mathvariant_monospace" id="alg2.l9.m1.1.2.3.2.cmml" xref="alg2.l9.m1.1.2.3.2">reweight</mtext></ci><ci id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">ℛ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">\mathcal{S}\leftarrow\text{{reweight}}(\mathcal{R})</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">caligraphic_S ← reweight ( caligraphic_R )</annotation></semantics></math> <span class="ltx_text" id="alg2.l9.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l9.1.m1.1"><semantics id="alg2.l9.1.m1.1a"><mo id="alg2.l9.1.m1.1.1" xref="alg2.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l9.1.m1.1b"><ci id="alg2.l9.1.m1.1.1.cmml" xref="alg2.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.1.m1.1d">▷</annotation></semantics></math> Re-weight top-<math alttext="k" class="ltx_Math" display="inline" id="alg2.l9.2.m2.1"><semantics id="alg2.l9.2.m2.1a"><mi id="alg2.l9.2.m2.1.1" xref="alg2.l9.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.l9.2.m2.1b"><ci id="alg2.l9.2.m2.1.1.cmml" xref="alg2.l9.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.2.m2.1d">italic_k</annotation></semantics></math> sub-trjs, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.E4" title="In 3.2.3 Reweighting Retrieved Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.E5" title="In 3.2.3 Reweighting Retrieved Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">5</span></a>
</span>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <math alttext="\mathbf{a}=\pi_{\theta}(\cdot\mid\mathbf{b},\{\tau_{\text{ret}}\in\mathcal{S}\})" class="ltx_math_unparsed" display="inline" id="alg2.l10.m1.1"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1b"><mi id="alg2.l10.m1.1.1">𝐚</mi><mo id="alg2.l10.m1.1.2">=</mo><msub id="alg2.l10.m1.1.3"><mi id="alg2.l10.m1.1.3.2">π</mi><mi id="alg2.l10.m1.1.3.3">θ</mi></msub><mrow id="alg2.l10.m1.1.4"><mo id="alg2.l10.m1.1.4.1" stretchy="false">(</mo><mo id="alg2.l10.m1.1.4.2" lspace="0em" rspace="0em">⋅</mo><mo id="alg2.l10.m1.1.4.3" lspace="0em" rspace="0.167em">∣</mo><mi id="alg2.l10.m1.1.4.4">𝐛</mi><mo id="alg2.l10.m1.1.4.5">,</mo><mrow id="alg2.l10.m1.1.4.6"><mo id="alg2.l10.m1.1.4.6.1" stretchy="false">{</mo><msub id="alg2.l10.m1.1.4.6.2"><mi id="alg2.l10.m1.1.4.6.2.2">τ</mi><mtext id="alg2.l10.m1.1.4.6.2.3">ret</mtext></msub><mo id="alg2.l10.m1.1.4.6.3">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l10.m1.1.4.6.4">𝒮</mi><mo id="alg2.l10.m1.1.4.6.5" stretchy="false">}</mo></mrow><mo id="alg2.l10.m1.1.4.7" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">\mathbf{a}=\pi_{\theta}(\cdot\mid\mathbf{b},\{\tau_{\text{ret}}\in\mathcal{S}\})</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.1d">bold_a = italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( ⋅ ∣ bold_b , { italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ∈ caligraphic_S } )</annotation></semantics></math> <span class="ltx_text" id="alg2.l10.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l10.1.m1.1"><semantics id="alg2.l10.1.m1.1a"><mo id="alg2.l10.1.m1.1.1" xref="alg2.l10.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l10.1.m1.1b"><ci id="alg2.l10.1.m1.1.1.cmml" xref="alg2.l10.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.1.m1.1d">▷</annotation></semantics></math> Predict actions for batch
</span>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <math alttext="\pi_{\theta}\leftarrow\texttt{update}(\pi_{\theta},\mathcal{L},\mathbf{a},%
\mathbf{b})" class="ltx_Math" display="inline" id="alg2.l11.m1.4"><semantics id="alg2.l11.m1.4a"><mrow id="alg2.l11.m1.4.4" xref="alg2.l11.m1.4.4.cmml"><msub id="alg2.l11.m1.4.4.3" xref="alg2.l11.m1.4.4.3.cmml"><mi id="alg2.l11.m1.4.4.3.2" xref="alg2.l11.m1.4.4.3.2.cmml">π</mi><mi id="alg2.l11.m1.4.4.3.3" xref="alg2.l11.m1.4.4.3.3.cmml">θ</mi></msub><mo id="alg2.l11.m1.4.4.2" stretchy="false" xref="alg2.l11.m1.4.4.2.cmml">←</mo><mrow id="alg2.l11.m1.4.4.1" xref="alg2.l11.m1.4.4.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l11.m1.4.4.1.3" xref="alg2.l11.m1.4.4.1.3a.cmml">update</mtext><mo id="alg2.l11.m1.4.4.1.2" xref="alg2.l11.m1.4.4.1.2.cmml">⁢</mo><mrow id="alg2.l11.m1.4.4.1.1.1" xref="alg2.l11.m1.4.4.1.1.2.cmml"><mo id="alg2.l11.m1.4.4.1.1.1.2" stretchy="false" xref="alg2.l11.m1.4.4.1.1.2.cmml">(</mo><msub id="alg2.l11.m1.4.4.1.1.1.1" xref="alg2.l11.m1.4.4.1.1.1.1.cmml"><mi id="alg2.l11.m1.4.4.1.1.1.1.2" xref="alg2.l11.m1.4.4.1.1.1.1.2.cmml">π</mi><mi id="alg2.l11.m1.4.4.1.1.1.1.3" xref="alg2.l11.m1.4.4.1.1.1.1.3.cmml">θ</mi></msub><mo id="alg2.l11.m1.4.4.1.1.1.3" xref="alg2.l11.m1.4.4.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml">ℒ</mi><mo id="alg2.l11.m1.4.4.1.1.1.4" xref="alg2.l11.m1.4.4.1.1.2.cmml">,</mo><mi id="alg2.l11.m1.2.2" xref="alg2.l11.m1.2.2.cmml">𝐚</mi><mo id="alg2.l11.m1.4.4.1.1.1.5" xref="alg2.l11.m1.4.4.1.1.2.cmml">,</mo><mi id="alg2.l11.m1.3.3" xref="alg2.l11.m1.3.3.cmml">𝐛</mi><mo id="alg2.l11.m1.4.4.1.1.1.6" stretchy="false" xref="alg2.l11.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.4b"><apply id="alg2.l11.m1.4.4.cmml" xref="alg2.l11.m1.4.4"><ci id="alg2.l11.m1.4.4.2.cmml" xref="alg2.l11.m1.4.4.2">←</ci><apply id="alg2.l11.m1.4.4.3.cmml" xref="alg2.l11.m1.4.4.3"><csymbol cd="ambiguous" id="alg2.l11.m1.4.4.3.1.cmml" xref="alg2.l11.m1.4.4.3">subscript</csymbol><ci id="alg2.l11.m1.4.4.3.2.cmml" xref="alg2.l11.m1.4.4.3.2">𝜋</ci><ci id="alg2.l11.m1.4.4.3.3.cmml" xref="alg2.l11.m1.4.4.3.3">𝜃</ci></apply><apply id="alg2.l11.m1.4.4.1.cmml" xref="alg2.l11.m1.4.4.1"><times id="alg2.l11.m1.4.4.1.2.cmml" xref="alg2.l11.m1.4.4.1.2"></times><ci id="alg2.l11.m1.4.4.1.3a.cmml" xref="alg2.l11.m1.4.4.1.3"><mtext class="ltx_mathvariant_monospace" id="alg2.l11.m1.4.4.1.3.cmml" xref="alg2.l11.m1.4.4.1.3">update</mtext></ci><vector id="alg2.l11.m1.4.4.1.1.2.cmml" xref="alg2.l11.m1.4.4.1.1.1"><apply id="alg2.l11.m1.4.4.1.1.1.1.cmml" xref="alg2.l11.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l11.m1.4.4.1.1.1.1.1.cmml" xref="alg2.l11.m1.4.4.1.1.1.1">subscript</csymbol><ci id="alg2.l11.m1.4.4.1.1.1.1.2.cmml" xref="alg2.l11.m1.4.4.1.1.1.1.2">𝜋</ci><ci id="alg2.l11.m1.4.4.1.1.1.1.3.cmml" xref="alg2.l11.m1.4.4.1.1.1.1.3">𝜃</ci></apply><ci id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1">ℒ</ci><ci id="alg2.l11.m1.2.2.cmml" xref="alg2.l11.m1.2.2">𝐚</ci><ci id="alg2.l11.m1.3.3.cmml" xref="alg2.l11.m1.3.3">𝐛</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.4c">\pi_{\theta}\leftarrow\texttt{update}(\pi_{\theta},\mathcal{L},\mathbf{a},%
\mathbf{b})</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.4d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ← update ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , caligraphic_L , bold_a , bold_b )</annotation></semantics></math> <span class="ltx_text" id="alg2.l11.2" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l11.1.m1.1"><semantics id="alg2.l11.1.m1.1a"><mo id="alg2.l11.1.m1.1.1" xref="alg2.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l11.1.m1.1b"><ci id="alg2.l11.1.m1.1.1.cmml" xref="alg2.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.1.m1.1d">▷</annotation></semantics></math> Perform gradient step, see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS1" title="C.1 General ‣ Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">C.1</span></a> for <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="alg2.l11.2.m2.1"><semantics id="alg2.l11.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l11.2.m2.1.1" xref="alg2.l11.2.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="alg2.l11.2.m2.1b"><ci id="alg2.l11.2.m2.1.1.cmml" xref="alg2.l11.2.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.2.m2.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.2.m2.1d">caligraphic_L</annotation></semantics></math>
</span>
</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>     <span class="ltx_text ltx_font_bold" id="alg2.l12.1">if</span> <math alttext="i\;\%\;E==0" class="ltx_math_unparsed" display="inline" id="alg2.l12.m1.1"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1b"><mi id="alg2.l12.m1.1.1">i</mi><mo id="alg2.l12.m1.1.2" lspace="0.280em" rspace="0.280em">%</mo><mi id="alg2.l12.m1.1.3">E</mi><mo id="alg2.l12.m1.1.4" rspace="0em">=</mo><mo id="alg2.l12.m1.1.5" lspace="0em">=</mo><mn id="alg2.l12.m1.1.6">0</mn></mrow><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">i\;\%\;E==0</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m1.1d">italic_i % italic_E = = 0</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l12.2">then</span>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>        <span class="ltx_text ltx_font_typewriter" id="alg2.l13.2">evaluate</span>(<math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg2.l13.m1.1"><semantics id="alg2.l13.m1.1a"><msub id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><mi id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml">π</mi><mi id="alg2.l13.m1.1.1.3" xref="alg2.l13.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1">subscript</csymbol><ci id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2">𝜋</ci><ci id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="g" class="ltx_Math" display="inline" id="alg2.l13.m2.1"><semantics id="alg2.l13.m2.1a"><mi id="alg2.l13.m2.1.1" xref="alg2.l13.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="alg2.l13.m2.1b"><ci id="alg2.l13.m2.1.1.cmml" xref="alg2.l13.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m2.1c">g</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m2.1d">italic_g</annotation></semantics></math>) <span class="ltx_text" id="alg2.l13.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l13.1.m1.1"><semantics id="alg2.l13.1.m1.1a"><mo id="alg2.l13.1.m1.1.1" xref="alg2.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l13.1.m1.1b"><ci id="alg2.l13.1.m1.1.1.cmml" xref="alg2.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.1.m1.1d">▷</annotation></semantics></math> Evaluation with ICL, see Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#alg1" title="Algorithm 1 ‣ 3.2.3 Reweighting Retrieved Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">1</span></a>
</span>
</div>
<div class="ltx_listingline" id="alg2.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>     <span class="ltx_text ltx_font_bold" id="alg2.l14.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l14.2">if</span>
</div>
<div class="ltx_listingline" id="alg2.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>  <span class="ltx_text ltx_font_bold" id="alg2.l15.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l15.2">for</span>
</div>
</div>
</figure>
<figure class="ltx_table" id="A3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Hyperparameters for RA-DT.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T2.8">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T2.8.9.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A3.T2.8.9.1.1"><span class="ltx_text ltx_font_bold" id="A3.T2.8.9.1.1.1">Environment</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T2.8.9.1.2"><span class="ltx_text ltx_font_bold" id="A3.T2.8.9.1.2.1">Parameter</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A3.T2.8.9.1.3"><span class="ltx_text ltx_font_bold" id="A3.T2.8.9.1.3.1">Value</span></td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.10.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T2.8.10.2.1">Default</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.8.10.2.2">Gradient steps</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.8.10.2.3">100K</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.11.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.11.3.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.11.3.2">Optimizer</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.11.3.3">AdamW</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.12.4">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.12.4.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.12.4.2">Batch size</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.12.4.3">128</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.13.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.13.5.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.13.5.2">Lr schedule</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.13.5.3">Linear warm-up + Cosine</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.14.6">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.14.6.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.14.6.2">Warm-up steps</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.14.6.3">4000</td>
</tr>
<tr class="ltx_tr" id="A3.T2.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.1.1.2"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.1.1.3">Learning rate</td>
<td class="ltx_td ltx_align_center" id="A3.T2.1.1.1">1e-4 <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A3.T2.1.1.1.m1.1"><semantics id="A3.T2.1.1.1.m1.1a"><mo id="A3.T2.1.1.1.m1.1.1" stretchy="false" xref="A3.T2.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A3.T2.1.1.1.m1.1b"><ci id="A3.T2.1.1.1.m1.1.1.cmml" xref="A3.T2.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A3.T2.1.1.1.m1.1d">→</annotation></semantics></math> 1e-6</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.15.7">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.15.7.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.15.7.2">Weight decay</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.15.7.3">0.01</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.16.8">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.16.8.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.16.8.2">Gradient clipping</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.16.8.3">0.25</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.17.9">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.17.9.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.17.9.2">Dropout</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.17.9.3">0.2</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.18.10">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.18.10.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.18.10.2">Context Length</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.18.10.3">50 timesteps</td>
</tr>
<tr class="ltx_tr" id="A3.T2.2.2">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.2.2.2"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.2.2.1">Top-<math alttext="k" class="ltx_Math" display="inline" id="A3.T2.2.2.1.m1.1"><semantics id="A3.T2.2.2.1.m1.1a"><mi id="A3.T2.2.2.1.m1.1.1" xref="A3.T2.2.2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.T2.2.2.1.m1.1b"><ci id="A3.T2.2.2.1.m1.1.1.cmml" xref="A3.T2.2.2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.2.2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A3.T2.2.2.1.m1.1d">italic_k</annotation></semantics></math> before re-weighting</td>
<td class="ltx_td ltx_align_center" id="A3.T2.2.2.3">50</td>
</tr>
<tr class="ltx_tr" id="A3.T2.3.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.3.3.2"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.3.3.1">Top-<math alttext="k" class="ltx_Math" display="inline" id="A3.T2.3.3.1.m1.1"><semantics id="A3.T2.3.3.1.m1.1a"><mi id="A3.T2.3.3.1.m1.1.1" xref="A3.T2.3.3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.T2.3.3.1.m1.1b"><ci id="A3.T2.3.3.1.m1.1.1.cmml" xref="A3.T2.3.3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.3.3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A3.T2.3.3.1.m1.1d">italic_k</annotation></semantics></math> after re-weighting</td>
<td class="ltx_td ltx_align_center" id="A3.T2.3.3.3">1</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.19.11">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.19.11.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.19.11.2">Eval steps between retrievals</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.19.11.3">1</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.20.12">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.20.12.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.20.12.2">Query sequence aggregation</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.20.12.3">mean</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.21.13">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.21.13.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.21.13.2">Query sequence tokens</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.21.13.3">state</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.22.14">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.22.14.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.22.14.2">Query dropout</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.22.14.3">0.2</td>
</tr>
<tr class="ltx_tr" id="A3.T2.4.4">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.4.4.2"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.4.4.1">Re-weight <math alttext="\alpha" class="ltx_Math" display="inline" id="A3.T2.4.4.1.m1.1"><semantics id="A3.T2.4.4.1.m1.1a"><mi id="A3.T2.4.4.1.m1.1.1" xref="A3.T2.4.4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A3.T2.4.4.1.m1.1b"><ci id="A3.T2.4.4.1.m1.1.1.cmml" xref="A3.T2.4.4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.4.4.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A3.T2.4.4.1.m1.1d">italic_α</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="A3.T2.4.4.3">1</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.23.15">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.23.15.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.23.15.2">Train re-weighting</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.23.15.3">task</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.24.16">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.24.16.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.24.16.2">Eval re-weighting</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.24.16.3">return</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.25.17">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.25.17.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.25.17.2">Similarity cut-off</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.25.17.3">0.98</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.26.18">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.26.18.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.26.18.2">Deduplicate</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.26.18.3">True</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.27.19">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.27.19.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.27.19.2">Min len for retrieval (only for Dark)</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.27.19.3">10</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.28.20">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.28.20.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.28.20.2">Domain-agnostic LM</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.28.20.3"><span class="ltx_text ltx_font_typewriter" id="A3.T2.8.28.20.3.1">bert-base-uncased</span></td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.29.21">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.29.21.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.29.21.2">Domain-agnostic LM hidden dim</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.29.21.3">768</td>
</tr>
<tr class="ltx_tr" id="A3.T2.5.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.5.5.2"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.5.5.1">FrozenHopfield <math alttext="\beta" class="ltx_Math" display="inline" id="A3.T2.5.5.1.m1.1"><semantics id="A3.T2.5.5.1.m1.1a"><mi id="A3.T2.5.5.1.m1.1.1" xref="A3.T2.5.5.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A3.T2.5.5.1.m1.1b"><ci id="A3.T2.5.5.1.m1.1.1.cmml" xref="A3.T2.5.5.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.5.5.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A3.T2.5.5.1.m1.1d">italic_β</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="A3.T2.5.5.3">10</td>
</tr>
<tr class="ltx_tr" id="A3.T2.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T2.6.6.1">Dark Room/Key-Door <math alttext="20\times 20" class="ltx_Math" display="inline" id="A3.T2.6.6.1.m1.1"><semantics id="A3.T2.6.6.1.m1.1a"><mrow id="A3.T2.6.6.1.m1.1.1" xref="A3.T2.6.6.1.m1.1.1.cmml"><mn id="A3.T2.6.6.1.m1.1.1.2" xref="A3.T2.6.6.1.m1.1.1.2.cmml">20</mn><mo id="A3.T2.6.6.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T2.6.6.1.m1.1.1.1.cmml">×</mo><mn id="A3.T2.6.6.1.m1.1.1.3" xref="A3.T2.6.6.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.6.6.1.m1.1b"><apply id="A3.T2.6.6.1.m1.1.1.cmml" xref="A3.T2.6.6.1.m1.1.1"><times id="A3.T2.6.6.1.m1.1.1.1.cmml" xref="A3.T2.6.6.1.m1.1.1.1"></times><cn id="A3.T2.6.6.1.m1.1.1.2.cmml" type="integer" xref="A3.T2.6.6.1.m1.1.1.2">20</cn><cn id="A3.T2.6.6.1.m1.1.1.3.cmml" type="integer" xref="A3.T2.6.6.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.6.6.1.m1.1c">20\times 20</annotation><annotation encoding="application/x-llamapun" id="A3.T2.6.6.1.m1.1d">20 × 20</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.6.6.2">Context length</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.6.6.3">100</td>
</tr>
<tr class="ltx_tr" id="A3.T2.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T2.7.7.1">Dark Room/Key-Door <math alttext="40\times 20" class="ltx_Math" display="inline" id="A3.T2.7.7.1.m1.1"><semantics id="A3.T2.7.7.1.m1.1a"><mrow id="A3.T2.7.7.1.m1.1.1" xref="A3.T2.7.7.1.m1.1.1.cmml"><mn id="A3.T2.7.7.1.m1.1.1.2" xref="A3.T2.7.7.1.m1.1.1.2.cmml">40</mn><mo id="A3.T2.7.7.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A3.T2.7.7.1.m1.1.1.1.cmml">×</mo><mn id="A3.T2.7.7.1.m1.1.1.3" xref="A3.T2.7.7.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.T2.7.7.1.m1.1b"><apply id="A3.T2.7.7.1.m1.1.1.cmml" xref="A3.T2.7.7.1.m1.1.1"><times id="A3.T2.7.7.1.m1.1.1.1.cmml" xref="A3.T2.7.7.1.m1.1.1.1"></times><cn id="A3.T2.7.7.1.m1.1.1.2.cmml" type="integer" xref="A3.T2.7.7.1.m1.1.1.2">40</cn><cn id="A3.T2.7.7.1.m1.1.1.3.cmml" type="integer" xref="A3.T2.7.7.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.7.7.1.m1.1c">40\times 20</annotation><annotation encoding="application/x-llamapun" id="A3.T2.7.7.1.m1.1d">40 × 20</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.7.7.2">Context length</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.7.7.3">100</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.30.22">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.30.22.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.30.22.2">Batch size</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.30.22.3">32</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.31.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T2.8.31.23.1">MazeRunner</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.8.31.23.2">Eval steps between retrievals</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.8.31.23.3">25</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.32.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T2.8.32.24.1">Meta-World/DMControl</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.8.32.24.2">Gradient steps</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.8.32.24.3">200K</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.33.25">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.33.25.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.33.25.2">Eval steps between retrievals</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.33.25.3">25</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.8">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.8.2"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.8.1">Top-<math alttext="k" class="ltx_Math" display="inline" id="A3.T2.8.8.1.m1.1"><semantics id="A3.T2.8.8.1.m1.1a"><mi id="A3.T2.8.8.1.m1.1.1" xref="A3.T2.8.8.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A3.T2.8.8.1.m1.1b"><ci id="A3.T2.8.8.1.m1.1.1.cmml" xref="A3.T2.8.8.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T2.8.8.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A3.T2.8.8.1.m1.1d">italic_k</annotation></semantics></math> after re-weighting</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.8.3">4</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.34.26">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="A3.T2.8.34.26.1"></th>
<td class="ltx_td ltx_align_center" id="A3.T2.8.34.26.2">Query blending</td>
<td class="ltx_td ltx_align_center" id="A3.T2.8.34.26.3">0.5</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.35.27">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T2.8.35.27.1">Procgen</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.8.35.27.2">Gradient steps</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T2.8.35.27.3">200K</td>
</tr>
<tr class="ltx_tr" id="A3.T2.8.36.28">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A3.T2.8.36.28.1"></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T2.8.36.28.2">Eval steps between retrievals</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T2.8.36.28.3">25</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Additional Results</h2>
<section class="ltx_subsection" id="A4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Dark-Room</h3>
<div class="ltx_para ltx_noindent" id="A4.SS1.p1">
<p class="ltx_p" id="A4.SS1.p1.1">Analogous to the ICL curves on the 20 evaluation tasks in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.F3" title="Figure 3 ‣ 3.2.4 Incorporating Retrieved Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3</span></a>, we present ICL curves on the 80 train tasks in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.F14" title="Figure 14 ‣ C.4 Retrieval-Augmented Decision Transformer ‣ Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">14</span></a>.
In general, we observe a similar learning behaviour on the train tasks as on the evaluation tasks, with slightly higher scores on average.
Interestingly, the domain-agnostic variant of RA-DT slightly outperforms its domain-specific counterpart on the training tasks.</p>
</div>
<div class="ltx_para" id="A4.SS1.p2">
<p class="ltx_p" id="A4.SS1.p2.1">In addition, we also show the learning curves on Dark-Room <math alttext="10\times 10" class="ltx_Math" display="inline" id="A4.SS1.p2.1.m1.1"><semantics id="A4.SS1.p2.1.m1.1a"><mrow id="A4.SS1.p2.1.m1.1.1" xref="A4.SS1.p2.1.m1.1.1.cmml"><mn id="A4.SS1.p2.1.m1.1.1.2" xref="A4.SS1.p2.1.m1.1.1.2.cmml">10</mn><mo id="A4.SS1.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.SS1.p2.1.m1.1.1.1.cmml">×</mo><mn id="A4.SS1.p2.1.m1.1.1.3" xref="A4.SS1.p2.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.p2.1.m1.1b"><apply id="A4.SS1.p2.1.m1.1.1.cmml" xref="A4.SS1.p2.1.m1.1.1"><times id="A4.SS1.p2.1.m1.1.1.1.cmml" xref="A4.SS1.p2.1.m1.1.1.1"></times><cn id="A4.SS1.p2.1.m1.1.1.2.cmml" type="integer" xref="A4.SS1.p2.1.m1.1.1.2">10</cn><cn id="A4.SS1.p2.1.m1.1.1.3.cmml" type="integer" xref="A4.SS1.p2.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.p2.1.m1.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.p2.1.m1.1d">10 × 10</annotation></semantics></math> over the entire training phase in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F15" title="Figure 15 ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">15</span></a>.
We evaluate after every 25K updates and observe a steady improvement in the average performances with every evaluation.</p>
</div>
<figure class="ltx_figure" id="A4.F15">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="26" id="A4.F15.g1" src="extracted/5911726/figures/dark_keydoor/20x20/legend.png" width="449"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F15.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="A4.F15.sf1.g1" src="extracted/5911726/figures/darkroom/10x10/train.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>80 Train Goals</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F15.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="A4.F15.sf2.g1" src="extracted/5911726/figures/darkroom/10x10/eval.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>20 Eval Goals</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Average performances on <span class="ltx_text ltx_font_bold" id="A4.F15.2.1">Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="A4.F15.2.1.m1.1"><semantics id="A4.F15.2.1.m1.1b"><mo id="A4.F15.2.1.m1.1.1" xref="A4.F15.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A4.F15.2.1.m1.1c"><times id="A4.F15.2.1.m1.1.1.cmml" xref="A4.F15.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A4.F15.2.1.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A4.F15.2.1.m1.1e">×</annotation></semantics></math>10</span> over the course of training for <span class="ltx_text ltx_font_bold" id="A4.F15.5.2">(a)</span> train and <span class="ltx_text ltx_font_bold" id="A4.F15.6.3">(b)</span> test tasks.
We train each agent for 100K steps and evaluate every 25K steps. Curves are averaged across the 80 train and 20 evaluation tasks, respectively. We report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
<section class="ltx_subsubsection" id="A4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.1.1 </span>Attention Map Analysis</h4>
<div class="ltx_para ltx_noindent" id="A4.SS1.SSS1.p1">
<p class="ltx_p" id="A4.SS1.SSS1.p1.2">We conduct a qualitative analysis on Dark-Room <math alttext="10\times 10" class="ltx_Math" display="inline" id="A4.SS1.SSS1.p1.1.m1.1"><semantics id="A4.SS1.SSS1.p1.1.m1.1a"><mrow id="A4.SS1.SSS1.p1.1.m1.1.1" xref="A4.SS1.SSS1.p1.1.m1.1.1.cmml"><mn id="A4.SS1.SSS1.p1.1.m1.1.1.2" xref="A4.SS1.SSS1.p1.1.m1.1.1.2.cmml">10</mn><mo id="A4.SS1.SSS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.SS1.SSS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="A4.SS1.SSS1.p1.1.m1.1.1.3" xref="A4.SS1.SSS1.p1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS1.p1.1.m1.1b"><apply id="A4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="A4.SS1.SSS1.p1.1.m1.1.1"><times id="A4.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="A4.SS1.SSS1.p1.1.m1.1.1.1"></times><cn id="A4.SS1.SSS1.p1.1.m1.1.1.2.cmml" type="integer" xref="A4.SS1.SSS1.p1.1.m1.1.1.2">10</cn><cn id="A4.SS1.SSS1.p1.1.m1.1.1.3.cmml" type="integer" xref="A4.SS1.SSS1.p1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS1.p1.1.m1.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS1.p1.1.m1.1d">10 × 10</annotation></semantics></math> to better understand how RA-DT leverages the retrieved context sub-sequences.
First, we analyse the attention maps for different Dark-Room <math alttext="10\times 10" class="ltx_Math" display="inline" id="A4.SS1.SSS1.p1.2.m2.1"><semantics id="A4.SS1.SSS1.p1.2.m2.1a"><mrow id="A4.SS1.SSS1.p1.2.m2.1.1" xref="A4.SS1.SSS1.p1.2.m2.1.1.cmml"><mn id="A4.SS1.SSS1.p1.2.m2.1.1.2" xref="A4.SS1.SSS1.p1.2.m2.1.1.2.cmml">10</mn><mo id="A4.SS1.SSS1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.SS1.SSS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="A4.SS1.SSS1.p1.2.m2.1.1.3" xref="A4.SS1.SSS1.p1.2.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS1.p1.2.m2.1b"><apply id="A4.SS1.SSS1.p1.2.m2.1.1.cmml" xref="A4.SS1.SSS1.p1.2.m2.1.1"><times id="A4.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="A4.SS1.SSS1.p1.2.m2.1.1.1"></times><cn id="A4.SS1.SSS1.p1.2.m2.1.1.2.cmml" type="integer" xref="A4.SS1.SSS1.p1.2.m2.1.1.2">10</cn><cn id="A4.SS1.SSS1.p1.2.m2.1.1.3.cmml" type="integer" xref="A4.SS1.SSS1.p1.2.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS1.p1.2.m2.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS1.p1.2.m2.1d">10 × 10</annotation></semantics></math> goal locations.</p>
</div>
<div class="ltx_para" id="A4.SS1.SSS1.p2">
<p class="ltx_p" id="A4.SS1.SSS1.p2.1"><span class="ltx_text ltx_font_bold" id="A4.SS1.SSS1.p2.1.1">What happens if an optimal trajectory is retrieved in context? </span>
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F16" title="Figure 16 ‣ D.1.1 Attention Map Analysis ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">16</span></a>, we showcase this example.
The goal location is located at grid cell (4,6).
The attention maps exhibit high attention scores for the state and the RTG at the end of the retrieved trajectory.
We also observe high attention scores for the state similar to the current state and the action selected in that state.
The agent initially imitates the actions in the context trajectory, but deviates further into the episode.
Once the agent reaches the goal state, the attention scores for states and RTGs at the end of the trajectory reduce considerably, because the agent need not pay attention to the retrieved context any more.</p>
</div>
<figure class="ltx_figure" id="A4.F16"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="629" id="A4.F16.g1" src="extracted/5911726/figures/visualisation/positive.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>Attention map analysis for an <span class="ltx_text ltx_font_bold" id="A4.F16.4.1">optimal context-trajectory</span> on Dark-Room <math alttext="10\times 10" class="ltx_Math" display="inline" id="A4.F16.2.m1.1"><semantics id="A4.F16.2.m1.1b"><mrow id="A4.F16.2.m1.1.1" xref="A4.F16.2.m1.1.1.cmml"><mn id="A4.F16.2.m1.1.1.2" xref="A4.F16.2.m1.1.1.2.cmml">10</mn><mo id="A4.F16.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.F16.2.m1.1.1.1.cmml">×</mo><mn id="A4.F16.2.m1.1.1.3" xref="A4.F16.2.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.F16.2.m1.1c"><apply id="A4.F16.2.m1.1.1.cmml" xref="A4.F16.2.m1.1.1"><times id="A4.F16.2.m1.1.1.1.cmml" xref="A4.F16.2.m1.1.1.1"></times><cn id="A4.F16.2.m1.1.1.2.cmml" type="integer" xref="A4.F16.2.m1.1.1.2">10</cn><cn id="A4.F16.2.m1.1.1.3.cmml" type="integer" xref="A4.F16.2.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F16.2.m1.1d">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A4.F16.2.m1.1e">10 × 10</annotation></semantics></math>. We plot the retrieved context trajectory (left), the corresponding attention map, and actual agent state (right), across timesteps (1, 5, 10).
Queries (input trajectory) are on the y-axis and keys (context trajectory) on the x-axis.
We highlight the sub-sequence in the context trajectory with the highest attention score (left).
To improve readability, we mask-out attention scores below a certain threshold, and only provide labels for token that exhibit the highest attention scores.
The agent imitates the context trajectory and successfully finds the goal.</figcaption>
</figure>
<div class="ltx_para" id="A4.SS1.SSS1.p3">
<p class="ltx_p" id="A4.SS1.SSS1.p3.1"><span class="ltx_text ltx_font_bold" id="A4.SS1.SSS1.p3.1.1">What happens if a suboptimal trajectory is retrieved in Context?</span>
Similarly, we show the corresponding example in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F17" title="Figure 17 ‣ D.1.1 Attention Map Analysis ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">17</span></a>.
The goal location is again in grid cell (4,6).
The retrieved context trajectory reaches the final state (9,5).
Similar to Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F16" title="Figure 16 ‣ D.1.1 Attention Map Analysis ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">16</span></a>, the attention maps exhibit high attention scores for the last state and RTG for that state, as well as for a state at a similar timestep.
Previously, RA-DT imitated the action, but in this situation the agent
picks a different route, as the context trajectory does not lead to a successful outcome.</p>
</div>
<figure class="ltx_figure" id="A4.F17"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="604" id="A4.F17.g1" src="extracted/5911726/figures/visualisation/negative.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>
Attention map analysis for a <span class="ltx_text ltx_font_bold" id="A4.F17.4.1">suboptimal context-trajectory</span> on Dark-Room <math alttext="10\times 10" class="ltx_Math" display="inline" id="A4.F17.2.m1.1"><semantics id="A4.F17.2.m1.1b"><mrow id="A4.F17.2.m1.1.1" xref="A4.F17.2.m1.1.1.cmml"><mn id="A4.F17.2.m1.1.1.2" xref="A4.F17.2.m1.1.1.2.cmml">10</mn><mo id="A4.F17.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.F17.2.m1.1.1.1.cmml">×</mo><mn id="A4.F17.2.m1.1.1.3" xref="A4.F17.2.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.F17.2.m1.1c"><apply id="A4.F17.2.m1.1.1.cmml" xref="A4.F17.2.m1.1.1"><times id="A4.F17.2.m1.1.1.1.cmml" xref="A4.F17.2.m1.1.1.1"></times><cn id="A4.F17.2.m1.1.1.2.cmml" type="integer" xref="A4.F17.2.m1.1.1.2">10</cn><cn id="A4.F17.2.m1.1.1.3.cmml" type="integer" xref="A4.F17.2.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F17.2.m1.1d">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A4.F17.2.m1.1e">10 × 10</annotation></semantics></math>.
The agent selects a different route than present in the suboptimal context trajectory and explores the environment.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A4.SS1.SSS1.p4">
<p class="ltx_p" id="A4.SS1.SSS1.p4.1">This analysis suggests, that RA-DT can develop capabilities to either imitate a given positive experience or to behave differently than a given negative experience.</p>
</div>
</section>
<section class="ltx_subsubsection" id="A4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.1.2 </span>Exploration Analysis</h4>
<div class="ltx_para ltx_noindent" id="A4.SS1.SSS2.p1">
<p class="ltx_p" id="A4.SS1.SSS2.p1.4"><span class="ltx_text ltx_font_bold" id="A4.SS1.SSS2.p1.4.1">State Visitations.</span> In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.SS1.SSS1" title="D.1.1 Attention Map Analysis ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">D.1.1</span></a>, we found that RA-DT learned to either copy or avoid behaviours given positive or negative context trajectories.
Therefore, we further analyse the exploration behaviour of RA-DT by visualizing the state-visitation frequencies on Dark-Room <math alttext="10\times 10" class="ltx_Math" display="inline" id="A4.SS1.SSS2.p1.1.m1.1"><semantics id="A4.SS1.SSS2.p1.1.m1.1a"><mrow id="A4.SS1.SSS2.p1.1.m1.1.1" xref="A4.SS1.SSS2.p1.1.m1.1.1.cmml"><mn id="A4.SS1.SSS2.p1.1.m1.1.1.2" xref="A4.SS1.SSS2.p1.1.m1.1.1.2.cmml">10</mn><mo id="A4.SS1.SSS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.SS1.SSS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="A4.SS1.SSS2.p1.1.m1.1.1.3" xref="A4.SS1.SSS2.p1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS2.p1.1.m1.1b"><apply id="A4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="A4.SS1.SSS2.p1.1.m1.1.1"><times id="A4.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="A4.SS1.SSS2.p1.1.m1.1.1.1"></times><cn id="A4.SS1.SSS2.p1.1.m1.1.1.2.cmml" type="integer" xref="A4.SS1.SSS2.p1.1.m1.1.1.2">10</cn><cn id="A4.SS1.SSS2.p1.1.m1.1.1.3.cmml" type="integer" xref="A4.SS1.SSS2.p1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS2.p1.1.m1.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS2.p1.1.m1.1d">10 × 10</annotation></semantics></math> across the 40 ICL trials for three different goal locations: <math alttext="(5,8)" class="ltx_Math" display="inline" id="A4.SS1.SSS2.p1.2.m2.2"><semantics id="A4.SS1.SSS2.p1.2.m2.2a"><mrow id="A4.SS1.SSS2.p1.2.m2.2.3.2" xref="A4.SS1.SSS2.p1.2.m2.2.3.1.cmml"><mo id="A4.SS1.SSS2.p1.2.m2.2.3.2.1" stretchy="false" xref="A4.SS1.SSS2.p1.2.m2.2.3.1.cmml">(</mo><mn id="A4.SS1.SSS2.p1.2.m2.1.1" xref="A4.SS1.SSS2.p1.2.m2.1.1.cmml">5</mn><mo id="A4.SS1.SSS2.p1.2.m2.2.3.2.2" xref="A4.SS1.SSS2.p1.2.m2.2.3.1.cmml">,</mo><mn id="A4.SS1.SSS2.p1.2.m2.2.2" xref="A4.SS1.SSS2.p1.2.m2.2.2.cmml">8</mn><mo id="A4.SS1.SSS2.p1.2.m2.2.3.2.3" stretchy="false" xref="A4.SS1.SSS2.p1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS2.p1.2.m2.2b"><interval closure="open" id="A4.SS1.SSS2.p1.2.m2.2.3.1.cmml" xref="A4.SS1.SSS2.p1.2.m2.2.3.2"><cn id="A4.SS1.SSS2.p1.2.m2.1.1.cmml" type="integer" xref="A4.SS1.SSS2.p1.2.m2.1.1">5</cn><cn id="A4.SS1.SSS2.p1.2.m2.2.2.cmml" type="integer" xref="A4.SS1.SSS2.p1.2.m2.2.2">8</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS2.p1.2.m2.2c">(5,8)</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS2.p1.2.m2.2d">( 5 , 8 )</annotation></semantics></math>, <math alttext="(5,1)" class="ltx_Math" display="inline" id="A4.SS1.SSS2.p1.3.m3.2"><semantics id="A4.SS1.SSS2.p1.3.m3.2a"><mrow id="A4.SS1.SSS2.p1.3.m3.2.3.2" xref="A4.SS1.SSS2.p1.3.m3.2.3.1.cmml"><mo id="A4.SS1.SSS2.p1.3.m3.2.3.2.1" stretchy="false" xref="A4.SS1.SSS2.p1.3.m3.2.3.1.cmml">(</mo><mn id="A4.SS1.SSS2.p1.3.m3.1.1" xref="A4.SS1.SSS2.p1.3.m3.1.1.cmml">5</mn><mo id="A4.SS1.SSS2.p1.3.m3.2.3.2.2" xref="A4.SS1.SSS2.p1.3.m3.2.3.1.cmml">,</mo><mn id="A4.SS1.SSS2.p1.3.m3.2.2" xref="A4.SS1.SSS2.p1.3.m3.2.2.cmml">1</mn><mo id="A4.SS1.SSS2.p1.3.m3.2.3.2.3" stretchy="false" xref="A4.SS1.SSS2.p1.3.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS2.p1.3.m3.2b"><interval closure="open" id="A4.SS1.SSS2.p1.3.m3.2.3.1.cmml" xref="A4.SS1.SSS2.p1.3.m3.2.3.2"><cn id="A4.SS1.SSS2.p1.3.m3.1.1.cmml" type="integer" xref="A4.SS1.SSS2.p1.3.m3.1.1">5</cn><cn id="A4.SS1.SSS2.p1.3.m3.2.2.cmml" type="integer" xref="A4.SS1.SSS2.p1.3.m3.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS2.p1.3.m3.2c">(5,1)</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS2.p1.3.m3.2d">( 5 , 1 )</annotation></semantics></math>, and <math alttext="(4,6)" class="ltx_Math" display="inline" id="A4.SS1.SSS2.p1.4.m4.2"><semantics id="A4.SS1.SSS2.p1.4.m4.2a"><mrow id="A4.SS1.SSS2.p1.4.m4.2.3.2" xref="A4.SS1.SSS2.p1.4.m4.2.3.1.cmml"><mo id="A4.SS1.SSS2.p1.4.m4.2.3.2.1" stretchy="false" xref="A4.SS1.SSS2.p1.4.m4.2.3.1.cmml">(</mo><mn id="A4.SS1.SSS2.p1.4.m4.1.1" xref="A4.SS1.SSS2.p1.4.m4.1.1.cmml">4</mn><mo id="A4.SS1.SSS2.p1.4.m4.2.3.2.2" xref="A4.SS1.SSS2.p1.4.m4.2.3.1.cmml">,</mo><mn id="A4.SS1.SSS2.p1.4.m4.2.2" xref="A4.SS1.SSS2.p1.4.m4.2.2.cmml">6</mn><mo id="A4.SS1.SSS2.p1.4.m4.2.3.2.3" stretchy="false" xref="A4.SS1.SSS2.p1.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.SS1.SSS2.p1.4.m4.2b"><interval closure="open" id="A4.SS1.SSS2.p1.4.m4.2.3.1.cmml" xref="A4.SS1.SSS2.p1.4.m4.2.3.2"><cn id="A4.SS1.SSS2.p1.4.m4.1.1.cmml" type="integer" xref="A4.SS1.SSS2.p1.4.m4.1.1">4</cn><cn id="A4.SS1.SSS2.p1.4.m4.2.2.cmml" type="integer" xref="A4.SS1.SSS2.p1.4.m4.2.2">6</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.SS1.SSS2.p1.4.m4.2c">(4,6)</annotation><annotation encoding="application/x-llamapun" id="A4.SS1.SSS2.p1.4.m4.2d">( 4 , 6 )</annotation></semantics></math> (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F18" title="Figure 18 ‣ D.1.2 Exploration Analysis ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">18</span></a>).
The agent visits nearly all states at least once at test time, as visualized in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F18" title="Figure 18 ‣ D.1.2 Exploration Analysis ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">18</span></a> (a) and (b).
Once the agent finds the goal location, it starts to imitate and stops exploring, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F18" title="Figure 18 ‣ D.1.2 Exploration Analysis ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">18</span></a> (c).</p>
</div>
<figure class="ltx_figure" id="A4.F18">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F18.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="151" id="A4.F18.sf1.g1" src="extracted/5911726/figures/visualisation/state_action_coverage_RTG_84_5_8.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Goal Location: (5,8)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F18.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="151" id="A4.F18.sf2.g1" src="extracted/5911726/figures/visualisation/state_action_coverage_RTG_7_5_1.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Goal Location: (5,1)</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F18.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="151" id="A4.F18.sf3.g1" src="extracted/5911726/figures/visualisation/state_action_coverage_RTG_0_6_4.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Goal Location (4,6)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 18: </span>We count the state visitations on Dark-Room <math alttext="10\times 10" class="ltx_Math" display="inline" id="A4.F18.6.m1.1"><semantics id="A4.F18.6.m1.1b"><mrow id="A4.F18.6.m1.1.1" xref="A4.F18.6.m1.1.1.cmml"><mn id="A4.F18.6.m1.1.1.2" xref="A4.F18.6.m1.1.1.2.cmml">10</mn><mo id="A4.F18.6.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.F18.6.m1.1.1.1.cmml">×</mo><mn id="A4.F18.6.m1.1.1.3" xref="A4.F18.6.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.F18.6.m1.1c"><apply id="A4.F18.6.m1.1.1.cmml" xref="A4.F18.6.m1.1.1"><times id="A4.F18.6.m1.1.1.1.cmml" xref="A4.F18.6.m1.1.1.1"></times><cn id="A4.F18.6.m1.1.1.2.cmml" type="integer" xref="A4.F18.6.m1.1.1.2">10</cn><cn id="A4.F18.6.m1.1.1.3.cmml" type="integer" xref="A4.F18.6.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F18.6.m1.1d">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A4.F18.6.m1.1e">10 × 10</annotation></semantics></math> over all ICL trials for three different goal locations: <math alttext="(5,8)" class="ltx_Math" display="inline" id="A4.F18.7.m2.2"><semantics id="A4.F18.7.m2.2b"><mrow id="A4.F18.7.m2.2.3.2" xref="A4.F18.7.m2.2.3.1.cmml"><mo id="A4.F18.7.m2.2.3.2.1" stretchy="false" xref="A4.F18.7.m2.2.3.1.cmml">(</mo><mn id="A4.F18.7.m2.1.1" xref="A4.F18.7.m2.1.1.cmml">5</mn><mo id="A4.F18.7.m2.2.3.2.2" xref="A4.F18.7.m2.2.3.1.cmml">,</mo><mn id="A4.F18.7.m2.2.2" xref="A4.F18.7.m2.2.2.cmml">8</mn><mo id="A4.F18.7.m2.2.3.2.3" stretchy="false" xref="A4.F18.7.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.F18.7.m2.2c"><interval closure="open" id="A4.F18.7.m2.2.3.1.cmml" xref="A4.F18.7.m2.2.3.2"><cn id="A4.F18.7.m2.1.1.cmml" type="integer" xref="A4.F18.7.m2.1.1">5</cn><cn id="A4.F18.7.m2.2.2.cmml" type="integer" xref="A4.F18.7.m2.2.2">8</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.F18.7.m2.2d">(5,8)</annotation><annotation encoding="application/x-llamapun" id="A4.F18.7.m2.2e">( 5 , 8 )</annotation></semantics></math>, <math alttext="(5,1)" class="ltx_Math" display="inline" id="A4.F18.8.m3.2"><semantics id="A4.F18.8.m3.2b"><mrow id="A4.F18.8.m3.2.3.2" xref="A4.F18.8.m3.2.3.1.cmml"><mo id="A4.F18.8.m3.2.3.2.1" stretchy="false" xref="A4.F18.8.m3.2.3.1.cmml">(</mo><mn id="A4.F18.8.m3.1.1" xref="A4.F18.8.m3.1.1.cmml">5</mn><mo id="A4.F18.8.m3.2.3.2.2" xref="A4.F18.8.m3.2.3.1.cmml">,</mo><mn id="A4.F18.8.m3.2.2" xref="A4.F18.8.m3.2.2.cmml">1</mn><mo id="A4.F18.8.m3.2.3.2.3" stretchy="false" xref="A4.F18.8.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.F18.8.m3.2c"><interval closure="open" id="A4.F18.8.m3.2.3.1.cmml" xref="A4.F18.8.m3.2.3.2"><cn id="A4.F18.8.m3.1.1.cmml" type="integer" xref="A4.F18.8.m3.1.1">5</cn><cn id="A4.F18.8.m3.2.2.cmml" type="integer" xref="A4.F18.8.m3.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.F18.8.m3.2d">(5,1)</annotation><annotation encoding="application/x-llamapun" id="A4.F18.8.m3.2e">( 5 , 1 )</annotation></semantics></math>, and <math alttext="(4,6)" class="ltx_Math" display="inline" id="A4.F18.9.m4.2"><semantics id="A4.F18.9.m4.2b"><mrow id="A4.F18.9.m4.2.3.2" xref="A4.F18.9.m4.2.3.1.cmml"><mo id="A4.F18.9.m4.2.3.2.1" stretchy="false" xref="A4.F18.9.m4.2.3.1.cmml">(</mo><mn id="A4.F18.9.m4.1.1" xref="A4.F18.9.m4.1.1.cmml">4</mn><mo id="A4.F18.9.m4.2.3.2.2" xref="A4.F18.9.m4.2.3.1.cmml">,</mo><mn id="A4.F18.9.m4.2.2" xref="A4.F18.9.m4.2.2.cmml">6</mn><mo id="A4.F18.9.m4.2.3.2.3" stretchy="false" xref="A4.F18.9.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.F18.9.m4.2c"><interval closure="open" id="A4.F18.9.m4.2.3.1.cmml" xref="A4.F18.9.m4.2.3.2"><cn id="A4.F18.9.m4.1.1.cmml" type="integer" xref="A4.F18.9.m4.1.1">4</cn><cn id="A4.F18.9.m4.2.2.cmml" type="integer" xref="A4.F18.9.m4.2.2">6</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.F18.9.m4.2d">(4,6)</annotation><annotation encoding="application/x-llamapun" id="A4.F18.9.m4.2e">( 4 , 6 )</annotation></semantics></math>. The total number of states is 100. The agent attempts to visit all states at least once. Once the agent finds the goal, it starts exploiting (e.g., goal location <math alttext="(5,1)" class="ltx_Math" display="inline" id="A4.F18.10.m5.2"><semantics id="A4.F18.10.m5.2b"><mrow id="A4.F18.10.m5.2.3.2" xref="A4.F18.10.m5.2.3.1.cmml"><mo id="A4.F18.10.m5.2.3.2.1" stretchy="false" xref="A4.F18.10.m5.2.3.1.cmml">(</mo><mn id="A4.F18.10.m5.1.1" xref="A4.F18.10.m5.1.1.cmml">5</mn><mo id="A4.F18.10.m5.2.3.2.2" xref="A4.F18.10.m5.2.3.1.cmml">,</mo><mn id="A4.F18.10.m5.2.2" xref="A4.F18.10.m5.2.2.cmml">1</mn><mo id="A4.F18.10.m5.2.3.2.3" stretchy="false" xref="A4.F18.10.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.F18.10.m5.2c"><interval closure="open" id="A4.F18.10.m5.2.3.1.cmml" xref="A4.F18.10.m5.2.3.2"><cn id="A4.F18.10.m5.1.1.cmml" type="integer" xref="A4.F18.10.m5.1.1">5</cn><cn id="A4.F18.10.m5.2.2.cmml" type="integer" xref="A4.F18.10.m5.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.F18.10.m5.2d">(5,1)</annotation><annotation encoding="application/x-llamapun" id="A4.F18.10.m5.2e">( 5 , 1 )</annotation></semantics></math>).</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A4.SS1.SSS2.p2">
<p class="ltx_p" id="A4.SS1.SSS2.p2.1"><span class="ltx_text ltx_font_bold" id="A4.SS1.SSS2.p2.1.1">Delusions in RA-DT.</span>
Furthermore, we find that in some unsuccessful trials, the agent repeatedly performs the same suboptimal action sequences.
<cite class="ltx_cite ltx_citemacro_citet">Ortega et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib60" title="">2021</a>]</cite> refer to such behaviour as delusions.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F19" title="Figure 19 ‣ D.1.2 Exploration Analysis ‣ D.1 Dark-Room ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">19</span></a>, we illustrate two examples in which the agent suffers from delusions and does not recover until the end of the episode.</p>
</div>
<figure class="ltx_figure" id="A4.F19">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F19.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A4.F19.sf1.g1" src="extracted/5911726/figures/visualisation/delusions_1.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span><math alttext="(0,2)\rightarrow(0,4)" class="ltx_Math" display="inline" id="A4.F19.sf1.2.m1.4"><semantics id="A4.F19.sf1.2.m1.4b"><mrow id="A4.F19.sf1.2.m1.4.5" xref="A4.F19.sf1.2.m1.4.5.cmml"><mrow id="A4.F19.sf1.2.m1.4.5.2.2" xref="A4.F19.sf1.2.m1.4.5.2.1.cmml"><mo id="A4.F19.sf1.2.m1.4.5.2.2.1" stretchy="false" xref="A4.F19.sf1.2.m1.4.5.2.1.cmml">(</mo><mn id="A4.F19.sf1.2.m1.1.1" xref="A4.F19.sf1.2.m1.1.1.cmml">0</mn><mo id="A4.F19.sf1.2.m1.4.5.2.2.2" xref="A4.F19.sf1.2.m1.4.5.2.1.cmml">,</mo><mn id="A4.F19.sf1.2.m1.2.2" xref="A4.F19.sf1.2.m1.2.2.cmml">2</mn><mo id="A4.F19.sf1.2.m1.4.5.2.2.3" stretchy="false" xref="A4.F19.sf1.2.m1.4.5.2.1.cmml">)</mo></mrow><mo id="A4.F19.sf1.2.m1.4.5.1" stretchy="false" xref="A4.F19.sf1.2.m1.4.5.1.cmml">→</mo><mrow id="A4.F19.sf1.2.m1.4.5.3.2" xref="A4.F19.sf1.2.m1.4.5.3.1.cmml"><mo id="A4.F19.sf1.2.m1.4.5.3.2.1" stretchy="false" xref="A4.F19.sf1.2.m1.4.5.3.1.cmml">(</mo><mn id="A4.F19.sf1.2.m1.3.3" xref="A4.F19.sf1.2.m1.3.3.cmml">0</mn><mo id="A4.F19.sf1.2.m1.4.5.3.2.2" xref="A4.F19.sf1.2.m1.4.5.3.1.cmml">,</mo><mn id="A4.F19.sf1.2.m1.4.4" xref="A4.F19.sf1.2.m1.4.4.cmml">4</mn><mo id="A4.F19.sf1.2.m1.4.5.3.2.3" stretchy="false" xref="A4.F19.sf1.2.m1.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.F19.sf1.2.m1.4c"><apply id="A4.F19.sf1.2.m1.4.5.cmml" xref="A4.F19.sf1.2.m1.4.5"><ci id="A4.F19.sf1.2.m1.4.5.1.cmml" xref="A4.F19.sf1.2.m1.4.5.1">→</ci><interval closure="open" id="A4.F19.sf1.2.m1.4.5.2.1.cmml" xref="A4.F19.sf1.2.m1.4.5.2.2"><cn id="A4.F19.sf1.2.m1.1.1.cmml" type="integer" xref="A4.F19.sf1.2.m1.1.1">0</cn><cn id="A4.F19.sf1.2.m1.2.2.cmml" type="integer" xref="A4.F19.sf1.2.m1.2.2">2</cn></interval><interval closure="open" id="A4.F19.sf1.2.m1.4.5.3.1.cmml" xref="A4.F19.sf1.2.m1.4.5.3.2"><cn id="A4.F19.sf1.2.m1.3.3.cmml" type="integer" xref="A4.F19.sf1.2.m1.3.3">0</cn><cn id="A4.F19.sf1.2.m1.4.4.cmml" type="integer" xref="A4.F19.sf1.2.m1.4.4">4</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F19.sf1.2.m1.4d">(0,2)\rightarrow(0,4)</annotation><annotation encoding="application/x-llamapun" id="A4.F19.sf1.2.m1.4e">( 0 , 2 ) → ( 0 , 4 )</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F19.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A4.F19.sf2.g1" src="extracted/5911726/figures/visualisation/delusions_2.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span><math alttext="(3,9)\rightarrow(4,9)" class="ltx_Math" display="inline" id="A4.F19.sf2.2.m1.4"><semantics id="A4.F19.sf2.2.m1.4b"><mrow id="A4.F19.sf2.2.m1.4.5" xref="A4.F19.sf2.2.m1.4.5.cmml"><mrow id="A4.F19.sf2.2.m1.4.5.2.2" xref="A4.F19.sf2.2.m1.4.5.2.1.cmml"><mo id="A4.F19.sf2.2.m1.4.5.2.2.1" stretchy="false" xref="A4.F19.sf2.2.m1.4.5.2.1.cmml">(</mo><mn id="A4.F19.sf2.2.m1.1.1" xref="A4.F19.sf2.2.m1.1.1.cmml">3</mn><mo id="A4.F19.sf2.2.m1.4.5.2.2.2" xref="A4.F19.sf2.2.m1.4.5.2.1.cmml">,</mo><mn id="A4.F19.sf2.2.m1.2.2" xref="A4.F19.sf2.2.m1.2.2.cmml">9</mn><mo id="A4.F19.sf2.2.m1.4.5.2.2.3" stretchy="false" xref="A4.F19.sf2.2.m1.4.5.2.1.cmml">)</mo></mrow><mo id="A4.F19.sf2.2.m1.4.5.1" stretchy="false" xref="A4.F19.sf2.2.m1.4.5.1.cmml">→</mo><mrow id="A4.F19.sf2.2.m1.4.5.3.2" xref="A4.F19.sf2.2.m1.4.5.3.1.cmml"><mo id="A4.F19.sf2.2.m1.4.5.3.2.1" stretchy="false" xref="A4.F19.sf2.2.m1.4.5.3.1.cmml">(</mo><mn id="A4.F19.sf2.2.m1.3.3" xref="A4.F19.sf2.2.m1.3.3.cmml">4</mn><mo id="A4.F19.sf2.2.m1.4.5.3.2.2" xref="A4.F19.sf2.2.m1.4.5.3.1.cmml">,</mo><mn id="A4.F19.sf2.2.m1.4.4" xref="A4.F19.sf2.2.m1.4.4.cmml">9</mn><mo id="A4.F19.sf2.2.m1.4.5.3.2.3" stretchy="false" xref="A4.F19.sf2.2.m1.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.F19.sf2.2.m1.4c"><apply id="A4.F19.sf2.2.m1.4.5.cmml" xref="A4.F19.sf2.2.m1.4.5"><ci id="A4.F19.sf2.2.m1.4.5.1.cmml" xref="A4.F19.sf2.2.m1.4.5.1">→</ci><interval closure="open" id="A4.F19.sf2.2.m1.4.5.2.1.cmml" xref="A4.F19.sf2.2.m1.4.5.2.2"><cn id="A4.F19.sf2.2.m1.1.1.cmml" type="integer" xref="A4.F19.sf2.2.m1.1.1">3</cn><cn id="A4.F19.sf2.2.m1.2.2.cmml" type="integer" xref="A4.F19.sf2.2.m1.2.2">9</cn></interval><interval closure="open" id="A4.F19.sf2.2.m1.4.5.3.1.cmml" xref="A4.F19.sf2.2.m1.4.5.3.2"><cn id="A4.F19.sf2.2.m1.3.3.cmml" type="integer" xref="A4.F19.sf2.2.m1.3.3">4</cn><cn id="A4.F19.sf2.2.m1.4.4.cmml" type="integer" xref="A4.F19.sf2.2.m1.4.4">9</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F19.sf2.2.m1.4d">(3,9)\rightarrow(4,9)</annotation><annotation encoding="application/x-llamapun" id="A4.F19.sf2.2.m1.4e">( 3 , 9 ) → ( 4 , 9 )</annotation></semantics></math></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 19: </span>Illustrations of delusions in RA-DT on Dark-Room <math alttext="10\times 10" class="ltx_Math" display="inline" id="A4.F19.2.m1.1"><semantics id="A4.F19.2.m1.1b"><mrow id="A4.F19.2.m1.1.1" xref="A4.F19.2.m1.1.1.cmml"><mn id="A4.F19.2.m1.1.1.2" xref="A4.F19.2.m1.1.1.2.cmml">10</mn><mo id="A4.F19.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A4.F19.2.m1.1.1.1.cmml">×</mo><mn id="A4.F19.2.m1.1.1.3" xref="A4.F19.2.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.F19.2.m1.1c"><apply id="A4.F19.2.m1.1.1.cmml" xref="A4.F19.2.m1.1.1"><times id="A4.F19.2.m1.1.1.1.cmml" xref="A4.F19.2.m1.1.1.1"></times><cn id="A4.F19.2.m1.1.1.2.cmml" type="integer" xref="A4.F19.2.m1.1.1.2">10</cn><cn id="A4.F19.2.m1.1.1.3.cmml" type="integer" xref="A4.F19.2.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F19.2.m1.1d">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A4.F19.2.m1.1e">10 × 10</annotation></semantics></math>. In <span class="ltx_text ltx_font_bold" id="A4.F19.5.1">(a)</span>, the agent navigates from state (0, 2) to (0, 4) and returns to (0, 2). In <span class="ltx_text ltx_font_bold" id="A4.F19.6.2">(b)</span>, the agent
The agent goes from state (3, 9) and (4, 9) and back. In both examples, the agent repeats the unsuccessful action sequence.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="A4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Maze-Runner</h3>
<div class="ltx_para ltx_noindent" id="A4.SS2.p1">
<p class="ltx_p" id="A4.SS2.p1.1">In Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F20" title="Figure 20 ‣ D.2 Maze-Runner ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">20</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F21" title="Figure 21 ‣ D.2 Maze-Runner ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">21</span></a>, we report the average performances at the end of the training (100K) for both the 100 train and 20 evaluation mazes, as well as the corresponding ICL curves, respectively.</p>
</div>
<div class="ltx_para" id="A4.SS2.p2">
<p class="ltx_p" id="A4.SS2.p2.1">While RA-DT outperforms competitors, we observe a considerable performance gap between train mazes and test mazes (0.65 vs. 0.4 reward, see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F20" title="Figure 20 ‣ D.2 Maze-Runner ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">20</span></a>).
This indicates that RA-DT struggles to solve difficult, unseen mazes.
We believe that this gap is an artifact of the small pre-training distribution of 100 mazes, and be closed by increasing the number of pre-training mazes.
Furthermore, increasing the number of ICL trials may also enhance the performance.</p>
</div>
<figure class="ltx_figure" id="A4.F20">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="26" id="A4.F20.g1" src="extracted/5911726/figures/mazerunner/15x15/bar_legend.png" width="449"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F20.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="137" id="A4.F20.sf1.g1" src="extracted/5911726/figures/mazerunner/15x15/bar_train.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>100 Train Mazes</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F20.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="137" id="A4.F20.sf2.g1" src="extracted/5911726/figures/mazerunner/15x15/bar_eval.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>20 Test Mazes</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 20: </span>Average performance on <span class="ltx_text ltx_font_bold" id="A4.F20.3.1">(a)</span> 100 train and <span class="ltx_text ltx_font_bold" id="A4.F20.4.2">(b)</span> 20 test mazes at end of training (100K steps). We evaluate each agent for 30 episodes and report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
<figure class="ltx_figure" id="A4.F21">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="26" id="A4.F21.g1" src="extracted/5911726/figures/mazerunner/15x15/legend.png" width="449"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F21.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="141" id="A4.F21.sf1.g1" src="extracted/5911726/figures/mazerunner/15x15/train_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>100 Train Mazes</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F21.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="141" id="A4.F21.sf2.g1" src="extracted/5911726/figures/mazerunner/15x15/eval_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>20 Test Mazes</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 21: </span>ICL on <span class="ltx_text ltx_font_bold" id="A4.F21.3.1">(a)</span> 100 train and <span class="ltx_text ltx_font_bold" id="A4.F21.4.2">(b)</span> 20 test mazes at end of training (100K steps). We evaluate each agent for 30 episodes and report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Meta-World</h3>
<div class="ltx_para ltx_noindent" id="A4.SS3.p1">
<p class="ltx_p" id="A4.SS3.p1.1">In Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F22" title="Figure 22 ‣ D.3 Meta-World ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">22</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F23" title="Figure 23 ‣ D.3 Meta-World ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">23</span></a>, we show the training curves across the entire training period (200K steps), and the corresponding ICL curves at the end of training for both ML45 and ML5.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS3.p2">
<p class="ltx_p" id="A4.SS3.p2.1">Generally, we observe that RA-DT outperforms competitors on the evaluation tasks in terms of average performance.
However, on training task, the average performance of RA-DT is lower than of the vanilla DT.
AD and DPT lack behind both methods.
One potential reason is the RTG conditioning, which biases DT and RA-DT towards higher quality behaviour.</p>
</div>
<figure class="ltx_figure" id="A4.F22">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="29" id="A4.F22.g1" src="extracted/5911726/figures/metaworld/legend.png" width="299"/></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F22.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="138" id="A4.F22.sf1.g1" src="extracted/5911726/figures/metaworld/train.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>ML45</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F22.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="A4.F22.sf2.g1" src="extracted/5911726/figures/metaworld/eval.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MT5</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 22: </span>Learning curves on <span class="ltx_text ltx_font_bold" id="A4.F22.3.1">(a)</span> ML45 and <span class="ltx_text ltx_font_bold" id="A4.F22.4.2">(b)</span> MT5 over the full training period (200K). We evaluate each agent for 30 episodes and report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A4.SS3.p3">
<p class="ltx_p" id="A4.SS3.p3.1">Nevertheless, we do not observe improved ICL performance of RA-DT on evaluation tasks.
While all in-context RL methods exhibit in-context improvement on the training tasks (ML45), neither RA-DT nor other methods show signs of improvement on the evaluation tasks (MT5).</p>
</div>
<figure class="ltx_figure" id="A4.F23">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="29" id="A4.F23.g1" src="extracted/5911726/figures/metaworld/legend.png" width="299"/></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F23.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="138" id="A4.F23.sf1.g1" src="extracted/5911726/figures/metaworld/train_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>ML45</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F23.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="139" id="A4.F23.sf2.g1" src="extracted/5911726/figures/metaworld/eval_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>MT5</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 23: </span>ICL performance on <span class="ltx_text ltx_font_bold" id="A4.F23.3.1">(a)</span> ML45 and <span class="ltx_text ltx_font_bold" id="A4.F23.4.2">(b)</span> MT5 at end of training (200K steps). We evaluate each agent for 30 episodes and report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A4.SS3.p4">
<p class="ltx_p" id="A4.SS3.p4.1">In addition, we provide the average rewards and data-normalized scores in for the MT5 evaluation tasks in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.T3" title="Table 3 ‣ D.3 Meta-World ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_table" id="A4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Meta-World Evaluation Tasks.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T3.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A4.T3.1.1.1.1.1">Environment</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T3.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A4.T3.1.1.1.2.1">DT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A4.T3.1.1.1.3.1">AD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T3.1.1.1.4"><span class="ltx_text ltx_font_bold" id="A4.T3.1.1.1.4.1">DPT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T3.1.1.1.5"><span class="ltx_text ltx_font_bold" id="A4.T3.1.1.1.5.1">RA-DT</span></th>
</tr>
<tr class="ltx_tr" id="A4.T3.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T3.1.2.2.1"><span class="ltx_text ltx_font_bold" id="A4.T3.1.2.2.1.1">Reward</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T3.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T3.1.3.1.1">bin-picking</th>
<td class="ltx_td ltx_align_center" id="A4.T3.1.3.1.2">62.28 ± 34.37</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.3.1.3">42.63 ± 17.47</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.3.1.4">27.52 ± 14.07</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.3.1.5">14.47 ± 1.79</td>
</tr>
<tr class="ltx_tr" id="A4.T3.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T3.1.4.2.1">box-close</th>
<td class="ltx_td ltx_align_center" id="A4.T3.1.4.2.2">70.34 ± 6.72</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.4.2.3">85.4 ± 14.96</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.4.2.4">106.79 ± 23.7</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.4.2.5">110.09 ± 46.69</td>
</tr>
<tr class="ltx_tr" id="A4.T3.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T3.1.5.3.1">hand-insert</th>
<td class="ltx_td ltx_align_center" id="A4.T3.1.5.3.2">27.38 ± 3.1</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.5.3.3">51.82 ± 59.93</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.5.3.4">13.06 ± 0.15</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.5.3.5">182.25 ± 99.63</td>
</tr>
<tr class="ltx_tr" id="A4.T3.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T3.1.6.4.1">door-lock</th>
<td class="ltx_td ltx_align_center" id="A4.T3.1.6.4.2">229.76 ± 11.4</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.6.4.3">333.89 ± 161.77</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.6.4.4">239.2 ± 20.19</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.6.4.5">219.44 ± 2.51</td>
</tr>
<tr class="ltx_tr" id="A4.T3.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T3.1.7.5.1">door-unlock</th>
<td class="ltx_td ltx_align_center" id="A4.T3.1.7.5.2">588.66 ± 454.89</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.7.5.3">450.71 ± 8.37</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.7.5.4">249.17 ± 63.38</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.7.5.5">1163.02 ± 36.42</td>
</tr>
<tr class="ltx_tr" id="A4.T3.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T3.1.8.6.1"><span class="ltx_text ltx_font_bold" id="A4.T3.1.8.6.1.1">Average</span></th>
<td class="ltx_td ltx_align_center" id="A4.T3.1.8.6.2">195.68 ± 97.31</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.8.6.3">192.89 ± 23.48</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.8.6.4">127.15 ± 16.97</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.8.6.5">337.85 ± 34.94</td>
</tr>
<tr class="ltx_tr" id="A4.T3.1.9.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T3.1.9.7.1"><span class="ltx_text ltx_font_bold" id="A4.T3.1.9.7.1.1">Data-normalized Scores</span></th>
</tr>
<tr class="ltx_tr" id="A4.T3.1.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T3.1.10.8.1">bin-picking</th>
<td class="ltx_td ltx_align_center" id="A4.T3.1.10.8.2">0.24 ± 0.14</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.10.8.3">0.16 ± 0.07</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.10.8.4">0.09 ± 0.06</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.10.8.5">0.04 ± 0.01</td>
</tr>
<tr class="ltx_tr" id="A4.T3.1.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T3.1.11.9.1">box-close</th>
<td class="ltx_td ltx_align_center" id="A4.T3.1.11.9.2">-0.07 ± 0.01</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.11.9.3">-0.03 ± 0.03</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.11.9.4">0.01 ± 0.05</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.11.9.5">0.02 ± 0.1</td>
</tr>
<tr class="ltx_tr" id="A4.T3.1.12.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T3.1.12.10.1">hand-insert</th>
<td class="ltx_td ltx_align_center" id="A4.T3.1.12.10.2">0.02 ± 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.12.10.3">0.04 ± 0.05</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.12.10.4">0.01 ± 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.12.10.5">0.15 ± 0.08</td>
</tr>
<tr class="ltx_tr" id="A4.T3.1.13.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T3.1.13.11.1">door-lock</th>
<td class="ltx_td ltx_align_center" id="A4.T3.1.13.11.2">0.0 ± 0.01</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.13.11.3">0.08 ± 0.12</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.13.11.4">0.01 ± 0.01</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.13.11.5">-0.0 ± 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T3.1.14.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T3.1.14.12.1">door-unlock</th>
<td class="ltx_td ltx_align_center" id="A4.T3.1.14.12.2">0.27 ± 0.31</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.14.12.3">0.18 ± 0.01</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.14.12.4">0.04 ± 0.04</td>
<td class="ltx_td ltx_align_center" id="A4.T3.1.14.12.5">0.66 ± 0.02</td>
</tr>
<tr class="ltx_tr" id="A4.T3.1.15.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T3.1.15.13.1"><span class="ltx_text ltx_font_bold" id="A4.T3.1.15.13.1.1">Average</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T3.1.15.13.2">0.09 ± 0.08</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T3.1.15.13.3">0.08 ± 0.01</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T3.1.15.13.4">0.03 ± 0.03</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T3.1.15.13.5">0.17 ± 0.04</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="A4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.4 </span>DMControl</h3>
<div class="ltx_para ltx_noindent" id="A4.SS4.p1">
<p class="ltx_p" id="A4.SS4.p1.1">In Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F24" title="Figure 24 ‣ D.4 DMControl ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">24</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F25" title="Figure 25 ‣ D.4 DMControl ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">25</span></a>, we show the training curves across the entire training period (200K steps), and the corresponding ICL curves at the end of training for both DMC11 and DMC5.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS4.p2">
<p class="ltx_p" id="A4.SS4.p2.1">Similar to our results on Meta-World, we observe that RA-DT outperforms competitors on average.
However, we do not observe in-context improvement on the evaluation tasks.</p>
</div>
<figure class="ltx_figure" id="A4.F24">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="29" id="A4.F24.g1" src="extracted/5911726/figures/dmcontrol/legend.png" width="299"/></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F24.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="A4.F24.sf1.g1" src="extracted/5911726/figures/dmcontrol/train.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>DMC11</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F24.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="140" id="A4.F24.sf2.g1" src="extracted/5911726/figures/dmcontrol/eval.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>DMC5</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 24: </span>Average performance on <span class="ltx_text ltx_font_bold" id="A4.F24.3.1">(a)</span> DMC11 and <span class="ltx_text ltx_font_bold" id="A4.F24.4.2">(b)</span> DMC5 at end of training (200K steps). We evaluate each agent for 30 episodes and report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
<figure class="ltx_figure" id="A4.F25">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="29" id="A4.F25.g1" src="extracted/5911726/figures/dmcontrol/legend.png" width="299"/></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F25.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="139" id="A4.F25.sf1.g1" src="extracted/5911726/figures/dmcontrol/train_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>DMC11</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F25.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="139" id="A4.F25.sf2.g1" src="extracted/5911726/figures/dmcontrol/eval_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>DMC5</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 25: </span>ICL performance on <span class="ltx_text ltx_font_bold" id="A4.F25.3.1">(a)</span> DMC11 and <span class="ltx_text ltx_font_bold" id="A4.F25.4.2">(b)</span> DMC5 at end of training (200K steps). We evaluate each agent for 30 episodes and report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A4.SS4.p3">
<p class="ltx_p" id="A4.SS4.p3.1">In addition, we show the average rewards obtained and corresponding data-normalized scores for all DMC5 evaluation tasks in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.T4" title="Table 4 ‣ D.4 DMControl ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure class="ltx_table" id="A4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>DMControl Eval Tasks.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T4.48">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T4.48.49.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T4.48.49.1.1"><span class="ltx_text ltx_font_bold" id="A4.T4.48.49.1.1.1">Environment</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T4.48.49.1.2"><span class="ltx_text ltx_font_bold" id="A4.T4.48.49.1.2.1">AD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T4.48.49.1.3"><span class="ltx_text ltx_font_bold" id="A4.T4.48.49.1.3.1">DT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T4.48.49.1.4"><span class="ltx_text ltx_font_bold" id="A4.T4.48.49.1.4.1">DPT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T4.48.49.1.5"><span class="ltx_text ltx_font_bold" id="A4.T4.48.49.1.5.1">RA-DT</span></th>
</tr>
<tr class="ltx_tr" id="A4.T4.48.50.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T4.48.50.2.1"><span class="ltx_text ltx_font_bold" id="A4.T4.48.50.2.1.1">Reward</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T4.4.4.5">cartpole-balance</th>
<td class="ltx_td ltx_align_center" id="A4.T4.1.1.1">211.96 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.1.1.1.m1.1"><semantics id="A4.T4.1.1.1.m1.1a"><mo id="A4.T4.1.1.1.m1.1.1" xref="A4.T4.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.1.1.1.m1.1b"><csymbol cd="latexml" id="A4.T4.1.1.1.m1.1.1.cmml" xref="A4.T4.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.1.1.1.m1.1d">±</annotation></semantics></math> 62.8</td>
<td class="ltx_td ltx_align_center" id="A4.T4.2.2.2">946.49 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.2.2.2.m1.1"><semantics id="A4.T4.2.2.2.m1.1a"><mo id="A4.T4.2.2.2.m1.1.1" xref="A4.T4.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.2.2.2.m1.1b"><csymbol cd="latexml" id="A4.T4.2.2.2.m1.1.1.cmml" xref="A4.T4.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.2.2.2.m1.1d">±</annotation></semantics></math> 44.91</td>
<td class="ltx_td ltx_align_center" id="A4.T4.3.3.3">703.89 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.3.3.3.m1.1"><semantics id="A4.T4.3.3.3.m1.1a"><mo id="A4.T4.3.3.3.m1.1.1" xref="A4.T4.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.3.3.3.m1.1b"><csymbol cd="latexml" id="A4.T4.3.3.3.m1.1.1.cmml" xref="A4.T4.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.3.3.3.m1.1d">±</annotation></semantics></math> 263.11</td>
<td class="ltx_td ltx_align_center" id="A4.T4.4.4.4">910.1 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.4.4.4.m1.1"><semantics id="A4.T4.4.4.4.m1.1a"><mo id="A4.T4.4.4.4.m1.1.1" xref="A4.T4.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.4.4.4.m1.1b"><csymbol cd="latexml" id="A4.T4.4.4.4.m1.1.1.cmml" xref="A4.T4.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.4.4.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.4.4.4.m1.1d">±</annotation></semantics></math> 106.0</td>
</tr>
<tr class="ltx_tr" id="A4.T4.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T4.8.8.5">finger-turn_hard</th>
<td class="ltx_td ltx_align_center" id="A4.T4.5.5.1">199.34 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.5.5.1.m1.1"><semantics id="A4.T4.5.5.1.m1.1a"><mo id="A4.T4.5.5.1.m1.1.1" xref="A4.T4.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.5.5.1.m1.1b"><csymbol cd="latexml" id="A4.T4.5.5.1.m1.1.1.cmml" xref="A4.T4.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.5.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.5.5.1.m1.1d">±</annotation></semantics></math> 46.0</td>
<td class="ltx_td ltx_align_center" id="A4.T4.6.6.2">253.13 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.6.6.2.m1.1"><semantics id="A4.T4.6.6.2.m1.1a"><mo id="A4.T4.6.6.2.m1.1.1" xref="A4.T4.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.6.6.2.m1.1b"><csymbol cd="latexml" id="A4.T4.6.6.2.m1.1.1.cmml" xref="A4.T4.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.6.6.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.6.6.2.m1.1d">±</annotation></semantics></math> 43.0</td>
<td class="ltx_td ltx_align_center" id="A4.T4.7.7.3">295.2 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.7.7.3.m1.1"><semantics id="A4.T4.7.7.3.m1.1a"><mo id="A4.T4.7.7.3.m1.1.1" xref="A4.T4.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.7.7.3.m1.1b"><csymbol cd="latexml" id="A4.T4.7.7.3.m1.1.1.cmml" xref="A4.T4.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.7.7.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.7.7.3.m1.1d">±</annotation></semantics></math> 51.88</td>
<td class="ltx_td ltx_align_center" id="A4.T4.8.8.4">336.37 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.8.8.4.m1.1"><semantics id="A4.T4.8.8.4.m1.1a"><mo id="A4.T4.8.8.4.m1.1.1" xref="A4.T4.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.8.8.4.m1.1b"><csymbol cd="latexml" id="A4.T4.8.8.4.m1.1.1.cmml" xref="A4.T4.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.8.8.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.8.8.4.m1.1d">±</annotation></semantics></math> 16.51</td>
</tr>
<tr class="ltx_tr" id="A4.T4.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T4.12.12.5">pendulum-swingup</th>
<td class="ltx_td ltx_align_center" id="A4.T4.9.9.1">1.18 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.9.9.1.m1.1"><semantics id="A4.T4.9.9.1.m1.1a"><mo id="A4.T4.9.9.1.m1.1.1" xref="A4.T4.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.9.9.1.m1.1b"><csymbol cd="latexml" id="A4.T4.9.9.1.m1.1.1.cmml" xref="A4.T4.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.9.9.1.m1.1d">±</annotation></semantics></math> 2.04</td>
<td class="ltx_td ltx_align_center" id="A4.T4.10.10.2">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.10.10.2.m1.1"><semantics id="A4.T4.10.10.2.m1.1a"><mo id="A4.T4.10.10.2.m1.1.1" xref="A4.T4.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.10.10.2.m1.1b"><csymbol cd="latexml" id="A4.T4.10.10.2.m1.1.1.cmml" xref="A4.T4.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.10.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.10.10.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T4.11.11.3">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.11.11.3.m1.1"><semantics id="A4.T4.11.11.3.m1.1a"><mo id="A4.T4.11.11.3.m1.1.1" xref="A4.T4.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.11.11.3.m1.1b"><csymbol cd="latexml" id="A4.T4.11.11.3.m1.1.1.cmml" xref="A4.T4.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.11.11.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.11.11.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T4.12.12.4">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.12.12.4.m1.1"><semantics id="A4.T4.12.12.4.m1.1a"><mo id="A4.T4.12.12.4.m1.1.1" xref="A4.T4.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.12.12.4.m1.1b"><csymbol cd="latexml" id="A4.T4.12.12.4.m1.1.1.cmml" xref="A4.T4.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.12.12.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.12.12.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T4.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T4.16.16.5">reacher-hard</th>
<td class="ltx_td ltx_align_center" id="A4.T4.13.13.1">34.22 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.13.13.1.m1.1"><semantics id="A4.T4.13.13.1.m1.1a"><mo id="A4.T4.13.13.1.m1.1.1" xref="A4.T4.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.13.13.1.m1.1b"><csymbol cd="latexml" id="A4.T4.13.13.1.m1.1.1.cmml" xref="A4.T4.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.13.13.1.m1.1d">±</annotation></semantics></math> 17.25</td>
<td class="ltx_td ltx_align_center" id="A4.T4.14.14.2">167.7 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.14.14.2.m1.1"><semantics id="A4.T4.14.14.2.m1.1a"><mo id="A4.T4.14.14.2.m1.1.1" xref="A4.T4.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.14.14.2.m1.1b"><csymbol cd="latexml" id="A4.T4.14.14.2.m1.1.1.cmml" xref="A4.T4.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.14.14.2.m1.1d">±</annotation></semantics></math> 42.86</td>
<td class="ltx_td ltx_align_center" id="A4.T4.15.15.3">157.29 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.15.15.3.m1.1"><semantics id="A4.T4.15.15.3.m1.1a"><mo id="A4.T4.15.15.3.m1.1.1" xref="A4.T4.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.15.15.3.m1.1b"><csymbol cd="latexml" id="A4.T4.15.15.3.m1.1.1.cmml" xref="A4.T4.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.15.15.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.15.15.3.m1.1d">±</annotation></semantics></math> 94.79</td>
<td class="ltx_td ltx_align_center" id="A4.T4.16.16.4">95.4 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.16.16.4.m1.1"><semantics id="A4.T4.16.16.4.m1.1a"><mo id="A4.T4.16.16.4.m1.1.1" xref="A4.T4.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.16.16.4.m1.1b"><csymbol cd="latexml" id="A4.T4.16.16.4.m1.1.1.cmml" xref="A4.T4.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.16.16.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.16.16.4.m1.1d">±</annotation></semantics></math> 15.4</td>
</tr>
<tr class="ltx_tr" id="A4.T4.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T4.20.20.5">walker-walk</th>
<td class="ltx_td ltx_align_center" id="A4.T4.17.17.1">326.42 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.17.17.1.m1.1"><semantics id="A4.T4.17.17.1.m1.1a"><mo id="A4.T4.17.17.1.m1.1.1" xref="A4.T4.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.17.17.1.m1.1b"><csymbol cd="latexml" id="A4.T4.17.17.1.m1.1.1.cmml" xref="A4.T4.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.17.17.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.17.17.1.m1.1d">±</annotation></semantics></math> 102.52</td>
<td class="ltx_td ltx_align_center" id="A4.T4.18.18.2">189.46 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.18.18.2.m1.1"><semantics id="A4.T4.18.18.2.m1.1a"><mo id="A4.T4.18.18.2.m1.1.1" xref="A4.T4.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.18.18.2.m1.1b"><csymbol cd="latexml" id="A4.T4.18.18.2.m1.1.1.cmml" xref="A4.T4.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.18.18.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.18.18.2.m1.1d">±</annotation></semantics></math> 10.22</td>
<td class="ltx_td ltx_align_center" id="A4.T4.19.19.3">257.11 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.19.19.3.m1.1"><semantics id="A4.T4.19.19.3.m1.1a"><mo id="A4.T4.19.19.3.m1.1.1" xref="A4.T4.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.19.19.3.m1.1b"><csymbol cd="latexml" id="A4.T4.19.19.3.m1.1.1.cmml" xref="A4.T4.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.19.19.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.19.19.3.m1.1d">±</annotation></semantics></math> 57.21</td>
<td class="ltx_td ltx_align_center" id="A4.T4.20.20.4">877.9 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.20.20.4.m1.1"><semantics id="A4.T4.20.20.4.m1.1a"><mo id="A4.T4.20.20.4.m1.1.1" xref="A4.T4.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.20.20.4.m1.1b"><csymbol cd="latexml" id="A4.T4.20.20.4.m1.1.1.cmml" xref="A4.T4.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.20.20.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.20.20.4.m1.1d">±</annotation></semantics></math> 15.2</td>
</tr>
<tr class="ltx_tr" id="A4.T4.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T4.24.24.5"><span class="ltx_text ltx_font_bold" id="A4.T4.24.24.5.1">Average</span></th>
<td class="ltx_td ltx_align_center" id="A4.T4.21.21.1">154.63 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.21.21.1.m1.1"><semantics id="A4.T4.21.21.1.m1.1a"><mo id="A4.T4.21.21.1.m1.1.1" xref="A4.T4.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.21.21.1.m1.1b"><csymbol cd="latexml" id="A4.T4.21.21.1.m1.1.1.cmml" xref="A4.T4.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.21.21.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.21.21.1.m1.1d">±</annotation></semantics></math> 12.17</td>
<td class="ltx_td ltx_align_center" id="A4.T4.22.22.2">311.36 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.22.22.2.m1.1"><semantics id="A4.T4.22.22.2.m1.1a"><mo id="A4.T4.22.22.2.m1.1.1" xref="A4.T4.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.22.22.2.m1.1b"><csymbol cd="latexml" id="A4.T4.22.22.2.m1.1.1.cmml" xref="A4.T4.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.22.22.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.22.22.2.m1.1d">±</annotation></semantics></math> 12.49</td>
<td class="ltx_td ltx_align_center" id="A4.T4.23.23.3">282.7 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.23.23.3.m1.1"><semantics id="A4.T4.23.23.3.m1.1a"><mo id="A4.T4.23.23.3.m1.1.1" xref="A4.T4.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.23.23.3.m1.1b"><csymbol cd="latexml" id="A4.T4.23.23.3.m1.1.1.cmml" xref="A4.T4.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.23.23.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.23.23.3.m1.1d">±</annotation></semantics></math> 54.62</td>
<td class="ltx_td ltx_align_center" id="A4.T4.24.24.4">443.95 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.24.24.4.m1.1"><semantics id="A4.T4.24.24.4.m1.1a"><mo id="A4.T4.24.24.4.m1.1.1" xref="A4.T4.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.24.24.4.m1.1b"><csymbol cd="latexml" id="A4.T4.24.24.4.m1.1.1.cmml" xref="A4.T4.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.24.24.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.24.24.4.m1.1d">±</annotation></semantics></math> 25.7</td>
</tr>
<tr class="ltx_tr" id="A4.T4.48.51.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T4.48.51.1.1"><span class="ltx_text ltx_font_bold" id="A4.T4.48.51.1.1.1">Data-normalized Score</span></th>
</tr>
<tr class="ltx_tr" id="A4.T4.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T4.28.28.5">cartpole-balance</th>
<td class="ltx_td ltx_align_center" id="A4.T4.25.25.1">-0.24 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.25.25.1.m1.1"><semantics id="A4.T4.25.25.1.m1.1a"><mo id="A4.T4.25.25.1.m1.1.1" xref="A4.T4.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.25.25.1.m1.1b"><csymbol cd="latexml" id="A4.T4.25.25.1.m1.1.1.cmml" xref="A4.T4.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.25.25.1.m1.1d">±</annotation></semantics></math> 0.11</td>
<td class="ltx_td ltx_align_center" id="A4.T4.26.26.2">1.01 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.26.26.2.m1.1"><semantics id="A4.T4.26.26.2.m1.1a"><mo id="A4.T4.26.26.2.m1.1.1" xref="A4.T4.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.26.26.2.m1.1b"><csymbol cd="latexml" id="A4.T4.26.26.2.m1.1.1.cmml" xref="A4.T4.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.26.26.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.26.26.2.m1.1d">±</annotation></semantics></math> 0.08</td>
<td class="ltx_td ltx_align_center" id="A4.T4.27.27.3">0.6 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.27.27.3.m1.1"><semantics id="A4.T4.27.27.3.m1.1a"><mo id="A4.T4.27.27.3.m1.1.1" xref="A4.T4.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.27.27.3.m1.1b"><csymbol cd="latexml" id="A4.T4.27.27.3.m1.1.1.cmml" xref="A4.T4.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.27.27.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.27.27.3.m1.1d">±</annotation></semantics></math> 0.45</td>
<td class="ltx_td ltx_align_center" id="A4.T4.28.28.4">0.95 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.28.28.4.m1.1"><semantics id="A4.T4.28.28.4.m1.1a"><mo id="A4.T4.28.28.4.m1.1.1" xref="A4.T4.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.28.28.4.m1.1b"><csymbol cd="latexml" id="A4.T4.28.28.4.m1.1.1.cmml" xref="A4.T4.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.28.28.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.28.28.4.m1.1d">±</annotation></semantics></math> 0.18</td>
</tr>
<tr class="ltx_tr" id="A4.T4.32.32">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T4.32.32.5">finger-turn_hard</th>
<td class="ltx_td ltx_align_center" id="A4.T4.29.29.1">0.25 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.29.29.1.m1.1"><semantics id="A4.T4.29.29.1.m1.1a"><mo id="A4.T4.29.29.1.m1.1.1" xref="A4.T4.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.29.29.1.m1.1b"><csymbol cd="latexml" id="A4.T4.29.29.1.m1.1.1.cmml" xref="A4.T4.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.29.29.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.29.29.1.m1.1d">±</annotation></semantics></math> 0.07</td>
<td class="ltx_td ltx_align_center" id="A4.T4.30.30.2">0.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.30.30.2.m1.1"><semantics id="A4.T4.30.30.2.m1.1a"><mo id="A4.T4.30.30.2.m1.1.1" xref="A4.T4.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.30.30.2.m1.1b"><csymbol cd="latexml" id="A4.T4.30.30.2.m1.1.1.cmml" xref="A4.T4.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.30.30.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.30.30.2.m1.1d">±</annotation></semantics></math> 0.07</td>
<td class="ltx_td ltx_align_center" id="A4.T4.31.31.3">0.4 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.31.31.3.m1.1"><semantics id="A4.T4.31.31.3.m1.1a"><mo id="A4.T4.31.31.3.m1.1.1" xref="A4.T4.31.31.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.31.31.3.m1.1b"><csymbol cd="latexml" id="A4.T4.31.31.3.m1.1.1.cmml" xref="A4.T4.31.31.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.31.31.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.31.31.3.m1.1d">±</annotation></semantics></math> 0.08</td>
<td class="ltx_td ltx_align_center" id="A4.T4.32.32.4">0.47 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.32.32.4.m1.1"><semantics id="A4.T4.32.32.4.m1.1a"><mo id="A4.T4.32.32.4.m1.1.1" xref="A4.T4.32.32.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.32.32.4.m1.1b"><csymbol cd="latexml" id="A4.T4.32.32.4.m1.1.1.cmml" xref="A4.T4.32.32.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.32.32.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.32.32.4.m1.1d">±</annotation></semantics></math> 0.03</td>
</tr>
<tr class="ltx_tr" id="A4.T4.36.36">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T4.36.36.5">pendulum-swingup</th>
<td class="ltx_td ltx_align_center" id="A4.T4.33.33.1">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.33.33.1.m1.1"><semantics id="A4.T4.33.33.1.m1.1a"><mo id="A4.T4.33.33.1.m1.1.1" xref="A4.T4.33.33.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.33.33.1.m1.1b"><csymbol cd="latexml" id="A4.T4.33.33.1.m1.1.1.cmml" xref="A4.T4.33.33.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.33.33.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.33.33.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T4.34.34.2">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.34.34.2.m1.1"><semantics id="A4.T4.34.34.2.m1.1a"><mo id="A4.T4.34.34.2.m1.1.1" xref="A4.T4.34.34.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.34.34.2.m1.1b"><csymbol cd="latexml" id="A4.T4.34.34.2.m1.1.1.cmml" xref="A4.T4.34.34.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.34.34.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.34.34.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T4.35.35.3">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.35.35.3.m1.1"><semantics id="A4.T4.35.35.3.m1.1a"><mo id="A4.T4.35.35.3.m1.1.1" xref="A4.T4.35.35.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.35.35.3.m1.1b"><csymbol cd="latexml" id="A4.T4.35.35.3.m1.1.1.cmml" xref="A4.T4.35.35.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.35.35.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.35.35.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T4.36.36.4">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.36.36.4.m1.1"><semantics id="A4.T4.36.36.4.m1.1a"><mo id="A4.T4.36.36.4.m1.1.1" xref="A4.T4.36.36.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.36.36.4.m1.1b"><csymbol cd="latexml" id="A4.T4.36.36.4.m1.1.1.cmml" xref="A4.T4.36.36.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.36.36.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.36.36.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T4.40.40">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T4.40.40.5">reacher-hard</th>
<td class="ltx_td ltx_align_center" id="A4.T4.37.37.1">0.03 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.37.37.1.m1.1"><semantics id="A4.T4.37.37.1.m1.1a"><mo id="A4.T4.37.37.1.m1.1.1" xref="A4.T4.37.37.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.37.37.1.m1.1b"><csymbol cd="latexml" id="A4.T4.37.37.1.m1.1.1.cmml" xref="A4.T4.37.37.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.37.37.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.37.37.1.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_align_center" id="A4.T4.38.38.2">0.21 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.38.38.2.m1.1"><semantics id="A4.T4.38.38.2.m1.1a"><mo id="A4.T4.38.38.2.m1.1.1" xref="A4.T4.38.38.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.38.38.2.m1.1b"><csymbol cd="latexml" id="A4.T4.38.38.2.m1.1.1.cmml" xref="A4.T4.38.38.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.38.38.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.38.38.2.m1.1d">±</annotation></semantics></math> 0.06</td>
<td class="ltx_td ltx_align_center" id="A4.T4.39.39.3">0.19 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.39.39.3.m1.1"><semantics id="A4.T4.39.39.3.m1.1a"><mo id="A4.T4.39.39.3.m1.1.1" xref="A4.T4.39.39.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.39.39.3.m1.1b"><csymbol cd="latexml" id="A4.T4.39.39.3.m1.1.1.cmml" xref="A4.T4.39.39.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.39.39.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.39.39.3.m1.1d">±</annotation></semantics></math> 0.12</td>
<td class="ltx_td ltx_align_center" id="A4.T4.40.40.4">0.11 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.40.40.4.m1.1"><semantics id="A4.T4.40.40.4.m1.1a"><mo id="A4.T4.40.40.4.m1.1.1" xref="A4.T4.40.40.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.40.40.4.m1.1b"><csymbol cd="latexml" id="A4.T4.40.40.4.m1.1.1.cmml" xref="A4.T4.40.40.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.40.40.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.40.40.4.m1.1d">±</annotation></semantics></math> 0.02</td>
</tr>
<tr class="ltx_tr" id="A4.T4.44.44">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T4.44.44.5">walker-walk</th>
<td class="ltx_td ltx_align_center" id="A4.T4.41.41.1">0.4 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.41.41.1.m1.1"><semantics id="A4.T4.41.41.1.m1.1a"><mo id="A4.T4.41.41.1.m1.1.1" xref="A4.T4.41.41.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.41.41.1.m1.1b"><csymbol cd="latexml" id="A4.T4.41.41.1.m1.1.1.cmml" xref="A4.T4.41.41.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.41.41.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.41.41.1.m1.1d">±</annotation></semantics></math> 0.14</td>
<td class="ltx_td ltx_align_center" id="A4.T4.42.42.2">0.21 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.42.42.2.m1.1"><semantics id="A4.T4.42.42.2.m1.1a"><mo id="A4.T4.42.42.2.m1.1.1" xref="A4.T4.42.42.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.42.42.2.m1.1b"><csymbol cd="latexml" id="A4.T4.42.42.2.m1.1.1.cmml" xref="A4.T4.42.42.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.42.42.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.42.42.2.m1.1d">±</annotation></semantics></math> 0.01</td>
<td class="ltx_td ltx_align_center" id="A4.T4.43.43.3">0.31 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.43.43.3.m1.1"><semantics id="A4.T4.43.43.3.m1.1a"><mo id="A4.T4.43.43.3.m1.1.1" xref="A4.T4.43.43.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.43.43.3.m1.1b"><csymbol cd="latexml" id="A4.T4.43.43.3.m1.1.1.cmml" xref="A4.T4.43.43.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.43.43.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.43.43.3.m1.1d">±</annotation></semantics></math> 0.08</td>
<td class="ltx_td ltx_align_center" id="A4.T4.44.44.4">1.14 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.44.44.4.m1.1"><semantics id="A4.T4.44.44.4.m1.1a"><mo id="A4.T4.44.44.4.m1.1.1" xref="A4.T4.44.44.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.44.44.4.m1.1b"><csymbol cd="latexml" id="A4.T4.44.44.4.m1.1.1.cmml" xref="A4.T4.44.44.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.44.44.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.44.44.4.m1.1d">±</annotation></semantics></math> 0.02</td>
</tr>
<tr class="ltx_tr" id="A4.T4.48.48">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T4.48.48.5"><span class="ltx_text ltx_font_bold" id="A4.T4.48.48.5.1">Average</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T4.45.45.1">0.09 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.45.45.1.m1.1"><semantics id="A4.T4.45.45.1.m1.1a"><mo id="A4.T4.45.45.1.m1.1.1" xref="A4.T4.45.45.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.45.45.1.m1.1b"><csymbol cd="latexml" id="A4.T4.45.45.1.m1.1.1.cmml" xref="A4.T4.45.45.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.45.45.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.45.45.1.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T4.46.46.2">0.35 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.46.46.2.m1.1"><semantics id="A4.T4.46.46.2.m1.1a"><mo id="A4.T4.46.46.2.m1.1.1" xref="A4.T4.46.46.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.46.46.2.m1.1b"><csymbol cd="latexml" id="A4.T4.46.46.2.m1.1.1.cmml" xref="A4.T4.46.46.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.46.46.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.46.46.2.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T4.47.47.3">0.3 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.47.47.3.m1.1"><semantics id="A4.T4.47.47.3.m1.1a"><mo id="A4.T4.47.47.3.m1.1.1" xref="A4.T4.47.47.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.47.47.3.m1.1b"><csymbol cd="latexml" id="A4.T4.47.47.3.m1.1.1.cmml" xref="A4.T4.47.47.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.47.47.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.47.47.3.m1.1d">±</annotation></semantics></math> 0.09</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T4.48.48.4">0.53 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T4.48.48.4.m1.1"><semantics id="A4.T4.48.48.4.m1.1a"><mo id="A4.T4.48.48.4.m1.1.1" xref="A4.T4.48.48.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T4.48.48.4.m1.1b"><csymbol cd="latexml" id="A4.T4.48.48.4.m1.1.1.cmml" xref="A4.T4.48.48.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T4.48.48.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T4.48.48.4.m1.1d">±</annotation></semantics></math> 0.04</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="A4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.5 </span>Procgen</h3>
<div class="ltx_para ltx_noindent" id="A4.SS5.p1">
<p class="ltx_p" id="A4.SS5.p1.1">In Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F26" title="Figure 26 ‣ D.5 Procgen ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">26</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A4.F27" title="Figure 27 ‣ D.5 Procgen ‣ Appendix D Additional Results ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">27</span></a>, we show the training curves across the entire training period (200K steps), and the corresponding ICL curves at the end of training for PG12-Seen, PG12-Unseen, and PG4.
While we observe slightly better average performance of RA-DT compared to competitors, we do not find any in-context improvement.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.SS5.p2">
<p class="ltx_p" id="A4.SS5.p2.1"><span class="ltx_text ltx_font_bold" id="A4.SS5.p2.1.1">RA-DT constructs bursty sequences.</span>.
Building on work by <cite class="ltx_cite ltx_citemacro_citet">Chan et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib12" title="">2022</a>]</cite>, <cite class="ltx_cite ltx_citemacro_citet">Raparthy et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib73" title="">2023</a>]</cite> identified trajectory burstiness as one important property for ICL to emerge on the Procgen benchmark.
A given sequence is considered bursty, if it contains at least two trajectories from the same seed (or level).
Consequently, the agent obtains relevant information that it can leverage to predict the next action.
Therefore, we follow <cite class="ltx_cite ltx_citemacro_citet">Raparthy et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib73" title="">2023</a>]</cite> and always provide a trajectory from the same seed in the context of AD and DPT.
Indeed, we observed that this improves performance, compared to not taking trajectory burstiness into account.
Interestingly, we found that RA-DT retrieves trajectories from the same or similar seeds (seed accuracy of <math alttext="~{}80" class="ltx_Math" display="inline" id="A4.SS5.p2.1.m1.1"><semantics id="A4.SS5.p2.1.m1.1a"><mn id="A4.SS5.p2.1.m1.1.1" xref="A4.SS5.p2.1.m1.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="A4.SS5.p2.1.m1.1b"><cn id="A4.SS5.p2.1.m1.1.1.cmml" type="integer" xref="A4.SS5.p2.1.m1.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="A4.SS5.p2.1.m1.1c">~{}80</annotation><annotation encoding="application/x-llamapun" id="A4.SS5.p2.1.m1.1d">80</annotation></semantics></math>%), that is, RA-DT automatically constructs bursty sequences.
This intuitively makes sense, as retrieval directly searches for the most relevant experiences (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2.SSS3" title="3.2.3 Reweighting Retrieved Experiences ‣ 3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3.2.3</span></a>).
Therefore, for RA-DT, we do not provide additional information that indicates with which environment seed the trajectory was generated.</p>
</div>
<figure class="ltx_figure" id="A4.F26">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="29" id="A4.F26.g1" src="extracted/5911726/figures/procgen/legend.png" width="299"/></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F26.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="146" id="A4.F26.sf1.g1" src="extracted/5911726/figures/procgen/train_seeds.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>PG12-Seen</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F26.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="146" id="A4.F26.sf2.g1" src="extracted/5911726/figures/procgen/train_eval_seeds.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>PG12-Unseen</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F26.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="142" id="A4.F26.sf3.g1" src="extracted/5911726/figures/procgen/eval.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>PG4</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 26: </span>Learning curves on Procgen across <span class="ltx_text ltx_font_bold" id="A4.F26.4.1">(a)</span> PG12-Seen, <span class="ltx_text ltx_font_bold" id="A4.F26.5.2">(b)</span> PG12-Unseen, and <span class="ltx_text ltx_font_bold" id="A4.F26.6.3">(c)</span> PG4 seed over the full training period. We train for 200K steps, evaluate every 50K steps for 30 episodes, and report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
<figure class="ltx_figure" id="A4.F27">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="29" id="A4.F27.g1" src="extracted/5911726/figures/procgen/legend.png" width="299"/></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F27.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="145" id="A4.F27.sf1.g1" src="extracted/5911726/figures/procgen/train_seeds_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>PG12-Seen</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F27.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="145" id="A4.F27.sf2.g1" src="extracted/5911726/figures/procgen/train_eval_seeds_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>PG12-Unseen</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A4.F27.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="145" id="A4.F27.sf3.g1" src="extracted/5911726/figures/procgen/eval_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>PG4</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 27: </span>ICL performances on Procgen across <span class="ltx_text ltx_font_bold" id="A4.F27.4.1">(a)</span> PG12-Seen, <span class="ltx_text ltx_font_bold" id="A4.F27.5.2">(b)</span> PG12-Unseen, and <span class="ltx_text ltx_font_bold" id="A4.F27.6.3">(c)</span> PG4. We evaluate for 30 episodes, and report mean reward (+ 95% CI) over 3 seeds.</figcaption>
</figure>
<figure class="ltx_table" id="A4.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Procgen Train Tasks, Train Seeds.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T5.104">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T5.104.105.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T5.104.105.1.1"><span class="ltx_text ltx_font_bold" id="A4.T5.104.105.1.1.1">Environment</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T5.104.105.1.2"><span class="ltx_text ltx_font_bold" id="A4.T5.104.105.1.2.1">DT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T5.104.105.1.3"><span class="ltx_text ltx_font_bold" id="A4.T5.104.105.1.3.1">AD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T5.104.105.1.4"><span class="ltx_text ltx_font_bold" id="A4.T5.104.105.1.4.1">DPT</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T5.104.105.1.5"><span class="ltx_text ltx_font_bold" id="A4.T5.104.105.1.5.1">RA-DT</span></th>
</tr>
<tr class="ltx_tr" id="A4.T5.104.106.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T5.104.106.2.1"><span class="ltx_text ltx_font_bold" id="A4.T5.104.106.2.1.1">Rewards</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T5.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.4.4.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.4.4.5.1">bigfish</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.1.1.1">4.67 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.1.1.1.m1.1"><semantics id="A4.T5.1.1.1.m1.1a"><mo id="A4.T5.1.1.1.m1.1.1" xref="A4.T5.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.1.1.1.m1.1b"><csymbol cd="latexml" id="A4.T5.1.1.1.m1.1.1.cmml" xref="A4.T5.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.1.1.1.m1.1d">±</annotation></semantics></math> 3.51</td>
<td class="ltx_td ltx_align_center" id="A4.T5.2.2.2">2.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.2.2.2.m1.1"><semantics id="A4.T5.2.2.2.m1.1a"><mo id="A4.T5.2.2.2.m1.1.1" xref="A4.T5.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.2.2.2.m1.1b"><csymbol cd="latexml" id="A4.T5.2.2.2.m1.1.1.cmml" xref="A4.T5.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.2.2.2.m1.1d">±</annotation></semantics></math> 0.76</td>
<td class="ltx_td ltx_align_center" id="A4.T5.3.3.3">2.41 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.3.3.3.m1.1"><semantics id="A4.T5.3.3.3.m1.1a"><mo id="A4.T5.3.3.3.m1.1.1" xref="A4.T5.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.3.3.3.m1.1b"><csymbol cd="latexml" id="A4.T5.3.3.3.m1.1.1.cmml" xref="A4.T5.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.3.3.3.m1.1d">±</annotation></semantics></math> 0.1</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.4.4.4">5.21 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.4.4.4.m1.1"><semantics id="A4.T5.4.4.4.m1.1a"><mo id="A4.T5.4.4.4.m1.1.1" xref="A4.T5.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.4.4.4.m1.1b"><csymbol cd="latexml" id="A4.T5.4.4.4.m1.1.1.cmml" xref="A4.T5.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.4.4.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.4.4.4.m1.1d">±</annotation></semantics></math> 0.25</td>
</tr>
<tr class="ltx_tr" id="A4.T5.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.8.8.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.8.8.5.1">bossfight</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.5.5.1">1.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.5.5.1.m1.1"><semantics id="A4.T5.5.5.1.m1.1a"><mo id="A4.T5.5.5.1.m1.1.1" xref="A4.T5.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.5.5.1.m1.1b"><csymbol cd="latexml" id="A4.T5.5.5.1.m1.1.1.cmml" xref="A4.T5.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.5.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.5.5.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.6.6.2">0.46 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.6.6.2.m1.1"><semantics id="A4.T5.6.6.2.m1.1a"><mo id="A4.T5.6.6.2.m1.1.1" xref="A4.T5.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.6.6.2.m1.1b"><csymbol cd="latexml" id="A4.T5.6.6.2.m1.1.1.cmml" xref="A4.T5.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.6.6.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.6.6.2.m1.1d">±</annotation></semantics></math> 0.55</td>
<td class="ltx_td ltx_align_center" id="A4.T5.7.7.3">0.9 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.7.7.3.m1.1"><semantics id="A4.T5.7.7.3.m1.1a"><mo id="A4.T5.7.7.3.m1.1.1" xref="A4.T5.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.7.7.3.m1.1b"><csymbol cd="latexml" id="A4.T5.7.7.3.m1.1.1.cmml" xref="A4.T5.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.7.7.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.7.7.3.m1.1d">±</annotation></semantics></math> 0.26</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.8.8.4">1.31 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.8.8.4.m1.1"><semantics id="A4.T5.8.8.4.m1.1a"><mo id="A4.T5.8.8.4.m1.1.1" xref="A4.T5.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.8.8.4.m1.1b"><csymbol cd="latexml" id="A4.T5.8.8.4.m1.1.1.cmml" xref="A4.T5.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.8.8.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.8.8.4.m1.1d">±</annotation></semantics></math> 0.08</td>
</tr>
<tr class="ltx_tr" id="A4.T5.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.12.12.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.12.12.5.1">caveflyer</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.9.9.1">3.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.9.9.1.m1.1"><semantics id="A4.T5.9.9.1.m1.1a"><mo id="A4.T5.9.9.1.m1.1.1" xref="A4.T5.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.9.9.1.m1.1b"><csymbol cd="latexml" id="A4.T5.9.9.1.m1.1.1.cmml" xref="A4.T5.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.9.9.1.m1.1d">±</annotation></semantics></math> 5.77</td>
<td class="ltx_td ltx_align_center" id="A4.T5.10.10.2">0.22 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.10.10.2.m1.1"><semantics id="A4.T5.10.10.2.m1.1a"><mo id="A4.T5.10.10.2.m1.1.1" xref="A4.T5.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.10.10.2.m1.1b"><csymbol cd="latexml" id="A4.T5.10.10.2.m1.1.1.cmml" xref="A4.T5.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.10.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.10.10.2.m1.1d">±</annotation></semantics></math> 0.19</td>
<td class="ltx_td ltx_align_center" id="A4.T5.11.11.3">3.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.11.11.3.m1.1"><semantics id="A4.T5.11.11.3.m1.1a"><mo id="A4.T5.11.11.3.m1.1.1" xref="A4.T5.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.11.11.3.m1.1b"><csymbol cd="latexml" id="A4.T5.11.11.3.m1.1.1.cmml" xref="A4.T5.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.11.11.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.11.11.3.m1.1d">±</annotation></semantics></math> 3.28</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.12.12.4">9.67 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.12.12.4.m1.1"><semantics id="A4.T5.12.12.4.m1.1a"><mo id="A4.T5.12.12.4.m1.1.1" xref="A4.T5.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.12.12.4.m1.1b"><csymbol cd="latexml" id="A4.T5.12.12.4.m1.1.1.cmml" xref="A4.T5.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.12.12.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.12.12.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T5.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.16.16.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.16.16.5.1">chaser</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.13.13.1">1.49 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.13.13.1.m1.1"><semantics id="A4.T5.13.13.1.m1.1a"><mo id="A4.T5.13.13.1.m1.1.1" xref="A4.T5.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.13.13.1.m1.1b"><csymbol cd="latexml" id="A4.T5.13.13.1.m1.1.1.cmml" xref="A4.T5.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.13.13.1.m1.1d">±</annotation></semantics></math> 1.05</td>
<td class="ltx_td ltx_align_center" id="A4.T5.14.14.2">1.7 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.14.14.2.m1.1"><semantics id="A4.T5.14.14.2.m1.1a"><mo id="A4.T5.14.14.2.m1.1.1" xref="A4.T5.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.14.14.2.m1.1b"><csymbol cd="latexml" id="A4.T5.14.14.2.m1.1.1.cmml" xref="A4.T5.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.14.14.2.m1.1d">±</annotation></semantics></math> 0.49</td>
<td class="ltx_td ltx_align_center" id="A4.T5.15.15.3">1.64 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.15.15.3.m1.1"><semantics id="A4.T5.15.15.3.m1.1a"><mo id="A4.T5.15.15.3.m1.1.1" xref="A4.T5.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.15.15.3.m1.1b"><csymbol cd="latexml" id="A4.T5.15.15.3.m1.1.1.cmml" xref="A4.T5.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.15.15.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.15.15.3.m1.1d">±</annotation></semantics></math> 0.59</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.16.16.4">2.78 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.16.16.4.m1.1"><semantics id="A4.T5.16.16.4.m1.1a"><mo id="A4.T5.16.16.4.m1.1.1" xref="A4.T5.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.16.16.4.m1.1b"><csymbol cd="latexml" id="A4.T5.16.16.4.m1.1.1.cmml" xref="A4.T5.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.16.16.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.16.16.4.m1.1d">±</annotation></semantics></math> 0.46</td>
</tr>
<tr class="ltx_tr" id="A4.T5.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.20.20.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.20.20.5.1">coinrun</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.17.17.1">6.67 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.17.17.1.m1.1"><semantics id="A4.T5.17.17.1.m1.1a"><mo id="A4.T5.17.17.1.m1.1.1" xref="A4.T5.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.17.17.1.m1.1b"><csymbol cd="latexml" id="A4.T5.17.17.1.m1.1.1.cmml" xref="A4.T5.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.17.17.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.17.17.1.m1.1d">±</annotation></semantics></math> 5.77</td>
<td class="ltx_td ltx_align_center" id="A4.T5.18.18.2">5.89 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.18.18.2.m1.1"><semantics id="A4.T5.18.18.2.m1.1a"><mo id="A4.T5.18.18.2.m1.1.1" xref="A4.T5.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.18.18.2.m1.1b"><csymbol cd="latexml" id="A4.T5.18.18.2.m1.1.1.cmml" xref="A4.T5.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.18.18.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.18.18.2.m1.1d">±</annotation></semantics></math> 0.69</td>
<td class="ltx_td ltx_align_center" id="A4.T5.19.19.3">7.78 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.19.19.3.m1.1"><semantics id="A4.T5.19.19.3.m1.1a"><mo id="A4.T5.19.19.3.m1.1.1" xref="A4.T5.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.19.19.3.m1.1b"><csymbol cd="latexml" id="A4.T5.19.19.3.m1.1.1.cmml" xref="A4.T5.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.19.19.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.19.19.3.m1.1d">±</annotation></semantics></math> 1.17</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.20.20.4">8.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.20.20.4.m1.1"><semantics id="A4.T5.20.20.4.m1.1a"><mo id="A4.T5.20.20.4.m1.1.1" xref="A4.T5.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.20.20.4.m1.1b"><csymbol cd="latexml" id="A4.T5.20.20.4.m1.1.1.cmml" xref="A4.T5.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.20.20.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.20.20.4.m1.1d">±</annotation></semantics></math> 0.33</td>
</tr>
<tr class="ltx_tr" id="A4.T5.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.24.24.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.24.24.5.1">dodgeball</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.21.21.1">7.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.21.21.1.m1.1"><semantics id="A4.T5.21.21.1.m1.1a"><mo id="A4.T5.21.21.1.m1.1.1" xref="A4.T5.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.21.21.1.m1.1b"><csymbol cd="latexml" id="A4.T5.21.21.1.m1.1.1.cmml" xref="A4.T5.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.21.21.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.21.21.1.m1.1d">±</annotation></semantics></math> 7.57</td>
<td class="ltx_td ltx_align_center" id="A4.T5.22.22.2">2.47 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.22.22.2.m1.1"><semantics id="A4.T5.22.22.2.m1.1a"><mo id="A4.T5.22.22.2.m1.1.1" xref="A4.T5.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.22.22.2.m1.1b"><csymbol cd="latexml" id="A4.T5.22.22.2.m1.1.1.cmml" xref="A4.T5.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.22.22.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.22.22.2.m1.1d">±</annotation></semantics></math> 0.79</td>
<td class="ltx_td ltx_align_center" id="A4.T5.23.23.3">2.8 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.23.23.3.m1.1"><semantics id="A4.T5.23.23.3.m1.1a"><mo id="A4.T5.23.23.3.m1.1.1" xref="A4.T5.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.23.23.3.m1.1b"><csymbol cd="latexml" id="A4.T5.23.23.3.m1.1.1.cmml" xref="A4.T5.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.23.23.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.23.23.3.m1.1d">±</annotation></semantics></math> 1.44</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.24.24.4">8.98 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.24.24.4.m1.1"><semantics id="A4.T5.24.24.4.m1.1a"><mo id="A4.T5.24.24.4.m1.1.1" xref="A4.T5.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.24.24.4.m1.1b"><csymbol cd="latexml" id="A4.T5.24.24.4.m1.1.1.cmml" xref="A4.T5.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.24.24.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.24.24.4.m1.1d">±</annotation></semantics></math> 0.87</td>
</tr>
<tr class="ltx_tr" id="A4.T5.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.28.28.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.28.28.5.1">fruitbot</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.25.25.1">8.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.25.25.1.m1.1"><semantics id="A4.T5.25.25.1.m1.1a"><mo id="A4.T5.25.25.1.m1.1.1" xref="A4.T5.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.25.25.1.m1.1b"><csymbol cd="latexml" id="A4.T5.25.25.1.m1.1.1.cmml" xref="A4.T5.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.25.25.1.m1.1d">±</annotation></semantics></math> 2.65</td>
<td class="ltx_td ltx_align_center" id="A4.T5.26.26.2">7.66 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.26.26.2.m1.1"><semantics id="A4.T5.26.26.2.m1.1a"><mo id="A4.T5.26.26.2.m1.1.1" xref="A4.T5.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.26.26.2.m1.1b"><csymbol cd="latexml" id="A4.T5.26.26.2.m1.1.1.cmml" xref="A4.T5.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.26.26.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.26.26.2.m1.1d">±</annotation></semantics></math> 0.62</td>
<td class="ltx_td ltx_align_center" id="A4.T5.27.27.3">7.19 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.27.27.3.m1.1"><semantics id="A4.T5.27.27.3.m1.1a"><mo id="A4.T5.27.27.3.m1.1.1" xref="A4.T5.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.27.27.3.m1.1b"><csymbol cd="latexml" id="A4.T5.27.27.3.m1.1.1.cmml" xref="A4.T5.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.27.27.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.27.27.3.m1.1d">±</annotation></semantics></math> 1.09</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.28.28.4">8.6 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.28.28.4.m1.1"><semantics id="A4.T5.28.28.4.m1.1a"><mo id="A4.T5.28.28.4.m1.1.1" xref="A4.T5.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.28.28.4.m1.1b"><csymbol cd="latexml" id="A4.T5.28.28.4.m1.1.1.cmml" xref="A4.T5.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.28.28.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.28.28.4.m1.1d">±</annotation></semantics></math> 0.23</td>
</tr>
<tr class="ltx_tr" id="A4.T5.32.32">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.32.32.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.32.32.5.1">heist</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.29.29.1">10.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.29.29.1.m1.1"><semantics id="A4.T5.29.29.1.m1.1a"><mo id="A4.T5.29.29.1.m1.1.1" xref="A4.T5.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.29.29.1.m1.1b"><csymbol cd="latexml" id="A4.T5.29.29.1.m1.1.1.cmml" xref="A4.T5.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.29.29.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.29.29.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.30.30.2">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.30.30.2.m1.1"><semantics id="A4.T5.30.30.2.m1.1a"><mo id="A4.T5.30.30.2.m1.1.1" xref="A4.T5.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.30.30.2.m1.1b"><csymbol cd="latexml" id="A4.T5.30.30.2.m1.1.1.cmml" xref="A4.T5.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.30.30.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.30.30.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.31.31.3">0.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.31.31.3.m1.1"><semantics id="A4.T5.31.31.3.m1.1a"><mo id="A4.T5.31.31.3.m1.1.1" xref="A4.T5.31.31.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.31.31.3.m1.1b"><csymbol cd="latexml" id="A4.T5.31.31.3.m1.1.1.cmml" xref="A4.T5.31.31.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.31.31.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.31.31.3.m1.1d">±</annotation></semantics></math> 0.58</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.32.32.4">9.11 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.32.32.4.m1.1"><semantics id="A4.T5.32.32.4.m1.1a"><mo id="A4.T5.32.32.4.m1.1.1" xref="A4.T5.32.32.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.32.32.4.m1.1b"><csymbol cd="latexml" id="A4.T5.32.32.4.m1.1.1.cmml" xref="A4.T5.32.32.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.32.32.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.32.32.4.m1.1d">±</annotation></semantics></math> 1.02</td>
</tr>
<tr class="ltx_tr" id="A4.T5.36.36">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.36.36.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.36.36.5.1">leaper</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.33.33.1">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.33.33.1.m1.1"><semantics id="A4.T5.33.33.1.m1.1a"><mo id="A4.T5.33.33.1.m1.1.1" xref="A4.T5.33.33.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.33.33.1.m1.1b"><csymbol cd="latexml" id="A4.T5.33.33.1.m1.1.1.cmml" xref="A4.T5.33.33.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.33.33.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.33.33.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.34.34.2">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.34.34.2.m1.1"><semantics id="A4.T5.34.34.2.m1.1a"><mo id="A4.T5.34.34.2.m1.1.1" xref="A4.T5.34.34.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.34.34.2.m1.1b"><csymbol cd="latexml" id="A4.T5.34.34.2.m1.1.1.cmml" xref="A4.T5.34.34.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.34.34.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.34.34.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.35.35.3">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.35.35.3.m1.1"><semantics id="A4.T5.35.35.3.m1.1a"><mo id="A4.T5.35.35.3.m1.1.1" xref="A4.T5.35.35.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.35.35.3.m1.1b"><csymbol cd="latexml" id="A4.T5.35.35.3.m1.1.1.cmml" xref="A4.T5.35.35.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.35.35.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.35.35.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.36.36.4">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.36.36.4.m1.1"><semantics id="A4.T5.36.36.4.m1.1a"><mo id="A4.T5.36.36.4.m1.1.1" xref="A4.T5.36.36.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.36.36.4.m1.1b"><csymbol cd="latexml" id="A4.T5.36.36.4.m1.1.1.cmml" xref="A4.T5.36.36.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.36.36.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.36.36.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T5.40.40">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.40.40.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.40.40.5.1">maze</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.37.37.1">10.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.37.37.1.m1.1"><semantics id="A4.T5.37.37.1.m1.1a"><mo id="A4.T5.37.37.1.m1.1.1" xref="A4.T5.37.37.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.37.37.1.m1.1b"><csymbol cd="latexml" id="A4.T5.37.37.1.m1.1.1.cmml" xref="A4.T5.37.37.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.37.37.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.37.37.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.38.38.2">0.11 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.38.38.2.m1.1"><semantics id="A4.T5.38.38.2.m1.1a"><mo id="A4.T5.38.38.2.m1.1.1" xref="A4.T5.38.38.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.38.38.2.m1.1b"><csymbol cd="latexml" id="A4.T5.38.38.2.m1.1.1.cmml" xref="A4.T5.38.38.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.38.38.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.38.38.2.m1.1d">±</annotation></semantics></math> 0.19</td>
<td class="ltx_td ltx_align_center" id="A4.T5.39.39.3">5.56 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.39.39.3.m1.1"><semantics id="A4.T5.39.39.3.m1.1a"><mo id="A4.T5.39.39.3.m1.1.1" xref="A4.T5.39.39.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.39.39.3.m1.1b"><csymbol cd="latexml" id="A4.T5.39.39.3.m1.1.1.cmml" xref="A4.T5.39.39.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.39.39.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.39.39.3.m1.1d">±</annotation></semantics></math> 5.09</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.40.40.4">8.56 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.40.40.4.m1.1"><semantics id="A4.T5.40.40.4.m1.1a"><mo id="A4.T5.40.40.4.m1.1.1" xref="A4.T5.40.40.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.40.40.4.m1.1b"><csymbol cd="latexml" id="A4.T5.40.40.4.m1.1.1.cmml" xref="A4.T5.40.40.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.40.40.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.40.40.4.m1.1d">±</annotation></semantics></math> 0.69</td>
</tr>
<tr class="ltx_tr" id="A4.T5.44.44">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.44.44.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.44.44.5.1">miner</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.41.41.1">13.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.41.41.1.m1.1"><semantics id="A4.T5.41.41.1.m1.1a"><mo id="A4.T5.41.41.1.m1.1.1" xref="A4.T5.41.41.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.41.41.1.m1.1b"><csymbol cd="latexml" id="A4.T5.41.41.1.m1.1.1.cmml" xref="A4.T5.41.41.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.41.41.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.41.41.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.42.42.2">0.94 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.42.42.2.m1.1"><semantics id="A4.T5.42.42.2.m1.1a"><mo id="A4.T5.42.42.2.m1.1.1" xref="A4.T5.42.42.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.42.42.2.m1.1b"><csymbol cd="latexml" id="A4.T5.42.42.2.m1.1.1.cmml" xref="A4.T5.42.42.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.42.42.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.42.42.2.m1.1d">±</annotation></semantics></math> 0.48</td>
<td class="ltx_td ltx_align_center" id="A4.T5.43.43.3">1.23 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.43.43.3.m1.1"><semantics id="A4.T5.43.43.3.m1.1a"><mo id="A4.T5.43.43.3.m1.1.1" xref="A4.T5.43.43.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.43.43.3.m1.1b"><csymbol cd="latexml" id="A4.T5.43.43.3.m1.1.1.cmml" xref="A4.T5.43.43.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.43.43.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.43.43.3.m1.1d">±</annotation></semantics></math> 1.15</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.44.44.4">11.37 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.44.44.4.m1.1"><semantics id="A4.T5.44.44.4.m1.1a"><mo id="A4.T5.44.44.4.m1.1.1" xref="A4.T5.44.44.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.44.44.4.m1.1b"><csymbol cd="latexml" id="A4.T5.44.44.4.m1.1.1.cmml" xref="A4.T5.44.44.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.44.44.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.44.44.4.m1.1d">±</annotation></semantics></math> 0.23</td>
</tr>
<tr class="ltx_tr" id="A4.T5.48.48">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.48.48.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.48.48.5.1">starpilot</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.45.45.1">18.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.45.45.1.m1.1"><semantics id="A4.T5.45.45.1.m1.1a"><mo id="A4.T5.45.45.1.m1.1.1" xref="A4.T5.45.45.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.45.45.1.m1.1b"><csymbol cd="latexml" id="A4.T5.45.45.1.m1.1.1.cmml" xref="A4.T5.45.45.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.45.45.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.45.45.1.m1.1d">±</annotation></semantics></math> 10.54</td>
<td class="ltx_td ltx_align_center" id="A4.T5.46.46.2">9.72 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.46.46.2.m1.1"><semantics id="A4.T5.46.46.2.m1.1a"><mo id="A4.T5.46.46.2.m1.1.1" xref="A4.T5.46.46.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.46.46.2.m1.1b"><csymbol cd="latexml" id="A4.T5.46.46.2.m1.1.1.cmml" xref="A4.T5.46.46.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.46.46.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.46.46.2.m1.1d">±</annotation></semantics></math> 4.78</td>
<td class="ltx_td ltx_align_center" id="A4.T5.47.47.3">12.9 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.47.47.3.m1.1"><semantics id="A4.T5.47.47.3.m1.1a"><mo id="A4.T5.47.47.3.m1.1.1" xref="A4.T5.47.47.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.47.47.3.m1.1b"><csymbol cd="latexml" id="A4.T5.47.47.3.m1.1.1.cmml" xref="A4.T5.47.47.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.47.47.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.47.47.3.m1.1d">±</annotation></semantics></math> 4.69</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.48.48.4">17.82 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.48.48.4.m1.1"><semantics id="A4.T5.48.48.4.m1.1a"><mo id="A4.T5.48.48.4.m1.1.1" xref="A4.T5.48.48.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.48.48.4.m1.1b"><csymbol cd="latexml" id="A4.T5.48.48.4.m1.1.1.cmml" xref="A4.T5.48.48.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.48.48.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.48.48.4.m1.1d">±</annotation></semantics></math> 0.72</td>
</tr>
<tr class="ltx_tr" id="A4.T5.52.52">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.52.52.5"><span class="ltx_text ltx_font_bold" id="A4.T5.52.52.5.1">Avgerage</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.49.49.1">6.96 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.49.49.1.m1.1"><semantics id="A4.T5.49.49.1.m1.1a"><mo id="A4.T5.49.49.1.m1.1.1" xref="A4.T5.49.49.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.49.49.1.m1.1b"><csymbol cd="latexml" id="A4.T5.49.49.1.m1.1.1.cmml" xref="A4.T5.49.49.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.49.49.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.49.49.1.m1.1d">±</annotation></semantics></math> 1.25</td>
<td class="ltx_td ltx_align_center" id="A4.T5.50.50.2">2.6 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.50.50.2.m1.1"><semantics id="A4.T5.50.50.2.m1.1a"><mo id="A4.T5.50.50.2.m1.1.1" xref="A4.T5.50.50.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.50.50.2.m1.1b"><csymbol cd="latexml" id="A4.T5.50.50.2.m1.1.1.cmml" xref="A4.T5.50.50.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.50.50.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.50.50.2.m1.1d">±</annotation></semantics></math> 0.62</td>
<td class="ltx_td ltx_align_center" id="A4.T5.51.51.3">3.81 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.51.51.3.m1.1"><semantics id="A4.T5.51.51.3.m1.1a"><mo id="A4.T5.51.51.3.m1.1.1" xref="A4.T5.51.51.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.51.51.3.m1.1b"><csymbol cd="latexml" id="A4.T5.51.51.3.m1.1.1.cmml" xref="A4.T5.51.51.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.51.51.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.51.51.3.m1.1d">±</annotation></semantics></math> 0.68</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.52.52.4">7.64 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.52.52.4.m1.1"><semantics id="A4.T5.52.52.4.m1.1a"><mo id="A4.T5.52.52.4.m1.1.1" xref="A4.T5.52.52.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.52.52.4.m1.1b"><csymbol cd="latexml" id="A4.T5.52.52.4.m1.1.1.cmml" xref="A4.T5.52.52.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.52.52.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.52.52.4.m1.1d">±</annotation></semantics></math> 0.07</td>
</tr>
<tr class="ltx_tr" id="A4.T5.104.107.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T5.104.107.1.1"><span class="ltx_text ltx_font_bold" id="A4.T5.104.107.1.1.1">Human-normalized scores</span></th>
</tr>
<tr class="ltx_tr" id="A4.T5.56.56">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.56.56.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.56.56.5.1">bigfish</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.53.53.1">0.09 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.53.53.1.m1.1"><semantics id="A4.T5.53.53.1.m1.1a"><mo id="A4.T5.53.53.1.m1.1.1" xref="A4.T5.53.53.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.53.53.1.m1.1b"><csymbol cd="latexml" id="A4.T5.53.53.1.m1.1.1.cmml" xref="A4.T5.53.53.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.53.53.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.53.53.1.m1.1d">±</annotation></semantics></math> 0.09</td>
<td class="ltx_td ltx_align_center" id="A4.T5.54.54.2">0.03 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.54.54.2.m1.1"><semantics id="A4.T5.54.54.2.m1.1a"><mo id="A4.T5.54.54.2.m1.1.1" xref="A4.T5.54.54.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.54.54.2.m1.1b"><csymbol cd="latexml" id="A4.T5.54.54.2.m1.1.1.cmml" xref="A4.T5.54.54.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.54.54.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.54.54.2.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_align_center" id="A4.T5.55.55.3">0.04 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.55.55.3.m1.1"><semantics id="A4.T5.55.55.3.m1.1a"><mo id="A4.T5.55.55.3.m1.1.1" xref="A4.T5.55.55.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.55.55.3.m1.1b"><csymbol cd="latexml" id="A4.T5.55.55.3.m1.1.1.cmml" xref="A4.T5.55.55.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.55.55.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.55.55.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.56.56.4">0.11 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.56.56.4.m1.1"><semantics id="A4.T5.56.56.4.m1.1a"><mo id="A4.T5.56.56.4.m1.1.1" xref="A4.T5.56.56.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.56.56.4.m1.1b"><csymbol cd="latexml" id="A4.T5.56.56.4.m1.1.1.cmml" xref="A4.T5.56.56.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.56.56.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.56.56.4.m1.1d">±</annotation></semantics></math> 0.01</td>
</tr>
<tr class="ltx_tr" id="A4.T5.60.60">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.60.60.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.60.60.5.1">bossfight</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.57.57.1">0.04 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.57.57.1.m1.1"><semantics id="A4.T5.57.57.1.m1.1a"><mo id="A4.T5.57.57.1.m1.1.1" xref="A4.T5.57.57.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.57.57.1.m1.1b"><csymbol cd="latexml" id="A4.T5.57.57.1.m1.1.1.cmml" xref="A4.T5.57.57.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.57.57.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.57.57.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.58.58.2">-0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.58.58.2.m1.1"><semantics id="A4.T5.58.58.2.m1.1a"><mo id="A4.T5.58.58.2.m1.1.1" xref="A4.T5.58.58.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.58.58.2.m1.1b"><csymbol cd="latexml" id="A4.T5.58.58.2.m1.1.1.cmml" xref="A4.T5.58.58.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.58.58.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.58.58.2.m1.1d">±</annotation></semantics></math> 0.04</td>
<td class="ltx_td ltx_align_center" id="A4.T5.59.59.3">0.03 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.59.59.3.m1.1"><semantics id="A4.T5.59.59.3.m1.1a"><mo id="A4.T5.59.59.3.m1.1.1" xref="A4.T5.59.59.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.59.59.3.m1.1b"><csymbol cd="latexml" id="A4.T5.59.59.3.m1.1.1.cmml" xref="A4.T5.59.59.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.59.59.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.59.59.3.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.60.60.4">0.06 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.60.60.4.m1.1"><semantics id="A4.T5.60.60.4.m1.1a"><mo id="A4.T5.60.60.4.m1.1.1" xref="A4.T5.60.60.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.60.60.4.m1.1b"><csymbol cd="latexml" id="A4.T5.60.60.4.m1.1.1.cmml" xref="A4.T5.60.60.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.60.60.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.60.60.4.m1.1d">±</annotation></semantics></math> 0.01</td>
</tr>
<tr class="ltx_tr" id="A4.T5.64.64">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.64.64.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.64.64.5.1">caveflyer</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.61.61.1">-0.02 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.61.61.1.m1.1"><semantics id="A4.T5.61.61.1.m1.1a"><mo id="A4.T5.61.61.1.m1.1.1" xref="A4.T5.61.61.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.61.61.1.m1.1b"><csymbol cd="latexml" id="A4.T5.61.61.1.m1.1.1.cmml" xref="A4.T5.61.61.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.61.61.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.61.61.1.m1.1d">±</annotation></semantics></math> 0.68</td>
<td class="ltx_td ltx_align_center" id="A4.T5.62.62.2">-0.39 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.62.62.2.m1.1"><semantics id="A4.T5.62.62.2.m1.1a"><mo id="A4.T5.62.62.2.m1.1.1" xref="A4.T5.62.62.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.62.62.2.m1.1b"><csymbol cd="latexml" id="A4.T5.62.62.2.m1.1.1.cmml" xref="A4.T5.62.62.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.62.62.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.62.62.2.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_align_center" id="A4.T5.63.63.3">-0.06 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.63.63.3.m1.1"><semantics id="A4.T5.63.63.3.m1.1a"><mo id="A4.T5.63.63.3.m1.1.1" xref="A4.T5.63.63.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.63.63.3.m1.1b"><csymbol cd="latexml" id="A4.T5.63.63.3.m1.1.1.cmml" xref="A4.T5.63.63.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.63.63.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.63.63.3.m1.1d">±</annotation></semantics></math> 0.39</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.64.64.4">0.73 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.64.64.4.m1.1"><semantics id="A4.T5.64.64.4.m1.1a"><mo id="A4.T5.64.64.4.m1.1.1" xref="A4.T5.64.64.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.64.64.4.m1.1b"><csymbol cd="latexml" id="A4.T5.64.64.4.m1.1.1.cmml" xref="A4.T5.64.64.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.64.64.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.64.64.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T5.68.68">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.68.68.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.68.68.5.1">chaser</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.65.65.1">0.08 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.65.65.1.m1.1"><semantics id="A4.T5.65.65.1.m1.1a"><mo id="A4.T5.65.65.1.m1.1.1" xref="A4.T5.65.65.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.65.65.1.m1.1b"><csymbol cd="latexml" id="A4.T5.65.65.1.m1.1.1.cmml" xref="A4.T5.65.65.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.65.65.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.65.65.1.m1.1d">±</annotation></semantics></math> 0.08</td>
<td class="ltx_td ltx_align_center" id="A4.T5.66.66.2">0.1 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.66.66.2.m1.1"><semantics id="A4.T5.66.66.2.m1.1a"><mo id="A4.T5.66.66.2.m1.1.1" xref="A4.T5.66.66.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.66.66.2.m1.1b"><csymbol cd="latexml" id="A4.T5.66.66.2.m1.1.1.cmml" xref="A4.T5.66.66.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.66.66.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.66.66.2.m1.1d">±</annotation></semantics></math> 0.04</td>
<td class="ltx_td ltx_align_center" id="A4.T5.67.67.3">0.09 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.67.67.3.m1.1"><semantics id="A4.T5.67.67.3.m1.1a"><mo id="A4.T5.67.67.3.m1.1.1" xref="A4.T5.67.67.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.67.67.3.m1.1b"><csymbol cd="latexml" id="A4.T5.67.67.3.m1.1.1.cmml" xref="A4.T5.67.67.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.67.67.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.67.67.3.m1.1d">±</annotation></semantics></math> 0.05</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.68.68.4">0.18 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.68.68.4.m1.1"><semantics id="A4.T5.68.68.4.m1.1a"><mo id="A4.T5.68.68.4.m1.1.1" xref="A4.T5.68.68.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.68.68.4.m1.1b"><csymbol cd="latexml" id="A4.T5.68.68.4.m1.1.1.cmml" xref="A4.T5.68.68.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.68.68.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.68.68.4.m1.1d">±</annotation></semantics></math> 0.04</td>
</tr>
<tr class="ltx_tr" id="A4.T5.72.72">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.72.72.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.72.72.5.1">coinrun</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.69.69.1">0.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.69.69.1.m1.1"><semantics id="A4.T5.69.69.1.m1.1a"><mo id="A4.T5.69.69.1.m1.1.1" xref="A4.T5.69.69.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.69.69.1.m1.1b"><csymbol cd="latexml" id="A4.T5.69.69.1.m1.1.1.cmml" xref="A4.T5.69.69.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.69.69.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.69.69.1.m1.1d">±</annotation></semantics></math> 1.15</td>
<td class="ltx_td ltx_align_center" id="A4.T5.70.70.2">0.18 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.70.70.2.m1.1"><semantics id="A4.T5.70.70.2.m1.1a"><mo id="A4.T5.70.70.2.m1.1.1" xref="A4.T5.70.70.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.70.70.2.m1.1b"><csymbol cd="latexml" id="A4.T5.70.70.2.m1.1.1.cmml" xref="A4.T5.70.70.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.70.70.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.70.70.2.m1.1d">±</annotation></semantics></math> 0.14</td>
<td class="ltx_td ltx_align_center" id="A4.T5.71.71.3">0.56 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.71.71.3.m1.1"><semantics id="A4.T5.71.71.3.m1.1a"><mo id="A4.T5.71.71.3.m1.1.1" xref="A4.T5.71.71.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.71.71.3.m1.1b"><csymbol cd="latexml" id="A4.T5.71.71.3.m1.1.1.cmml" xref="A4.T5.71.71.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.71.71.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.71.71.3.m1.1d">±</annotation></semantics></math> 0.23</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.72.72.4">0.67 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.72.72.4.m1.1"><semantics id="A4.T5.72.72.4.m1.1a"><mo id="A4.T5.72.72.4.m1.1.1" xref="A4.T5.72.72.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.72.72.4.m1.1b"><csymbol cd="latexml" id="A4.T5.72.72.4.m1.1.1.cmml" xref="A4.T5.72.72.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.72.72.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.72.72.4.m1.1d">±</annotation></semantics></math> 0.07</td>
</tr>
<tr class="ltx_tr" id="A4.T5.76.76">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.76.76.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.76.76.5.1">dodgeball</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.73.73.1">0.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.73.73.1.m1.1"><semantics id="A4.T5.73.73.1.m1.1a"><mo id="A4.T5.73.73.1.m1.1.1" xref="A4.T5.73.73.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.73.73.1.m1.1b"><csymbol cd="latexml" id="A4.T5.73.73.1.m1.1.1.cmml" xref="A4.T5.73.73.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.73.73.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.73.73.1.m1.1d">±</annotation></semantics></math> 0.43</td>
<td class="ltx_td ltx_align_center" id="A4.T5.74.74.2">0.06 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.74.74.2.m1.1"><semantics id="A4.T5.74.74.2.m1.1a"><mo id="A4.T5.74.74.2.m1.1.1" xref="A4.T5.74.74.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.74.74.2.m1.1b"><csymbol cd="latexml" id="A4.T5.74.74.2.m1.1.1.cmml" xref="A4.T5.74.74.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.74.74.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.74.74.2.m1.1d">±</annotation></semantics></math> 0.04</td>
<td class="ltx_td ltx_align_center" id="A4.T5.75.75.3">0.07 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.75.75.3.m1.1"><semantics id="A4.T5.75.75.3.m1.1a"><mo id="A4.T5.75.75.3.m1.1.1" xref="A4.T5.75.75.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.75.75.3.m1.1b"><csymbol cd="latexml" id="A4.T5.75.75.3.m1.1.1.cmml" xref="A4.T5.75.75.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.75.75.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.75.75.3.m1.1d">±</annotation></semantics></math> 0.08</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.76.76.4">0.43 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.76.76.4.m1.1"><semantics id="A4.T5.76.76.4.m1.1a"><mo id="A4.T5.76.76.4.m1.1.1" xref="A4.T5.76.76.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.76.76.4.m1.1b"><csymbol cd="latexml" id="A4.T5.76.76.4.m1.1.1.cmml" xref="A4.T5.76.76.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.76.76.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.76.76.4.m1.1d">±</annotation></semantics></math> 0.05</td>
</tr>
<tr class="ltx_tr" id="A4.T5.80.80">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.80.80.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.80.80.5.1">fruitbot</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.77.77.1">0.28 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.77.77.1.m1.1"><semantics id="A4.T5.77.77.1.m1.1a"><mo id="A4.T5.77.77.1.m1.1.1" xref="A4.T5.77.77.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.77.77.1.m1.1b"><csymbol cd="latexml" id="A4.T5.77.77.1.m1.1.1.cmml" xref="A4.T5.77.77.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.77.77.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.77.77.1.m1.1d">±</annotation></semantics></math> 0.08</td>
<td class="ltx_td ltx_align_center" id="A4.T5.78.78.2">0.27 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.78.78.2.m1.1"><semantics id="A4.T5.78.78.2.m1.1a"><mo id="A4.T5.78.78.2.m1.1.1" xref="A4.T5.78.78.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.78.78.2.m1.1b"><csymbol cd="latexml" id="A4.T5.78.78.2.m1.1.1.cmml" xref="A4.T5.78.78.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.78.78.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.78.78.2.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_align_center" id="A4.T5.79.79.3">0.26 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.79.79.3.m1.1"><semantics id="A4.T5.79.79.3.m1.1a"><mo id="A4.T5.79.79.3.m1.1.1" xref="A4.T5.79.79.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.79.79.3.m1.1b"><csymbol cd="latexml" id="A4.T5.79.79.3.m1.1.1.cmml" xref="A4.T5.79.79.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.79.79.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.79.79.3.m1.1d">±</annotation></semantics></math> 0.03</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.80.80.4">0.3 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.80.80.4.m1.1"><semantics id="A4.T5.80.80.4.m1.1a"><mo id="A4.T5.80.80.4.m1.1.1" xref="A4.T5.80.80.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.80.80.4.m1.1b"><csymbol cd="latexml" id="A4.T5.80.80.4.m1.1.1.cmml" xref="A4.T5.80.80.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.80.80.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.80.80.4.m1.1d">±</annotation></semantics></math> 0.01</td>
</tr>
<tr class="ltx_tr" id="A4.T5.84.84">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.84.84.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.84.84.5.1">heist</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.81.81.1">1.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.81.81.1.m1.1"><semantics id="A4.T5.81.81.1.m1.1a"><mo id="A4.T5.81.81.1.m1.1.1" xref="A4.T5.81.81.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.81.81.1.m1.1b"><csymbol cd="latexml" id="A4.T5.81.81.1.m1.1.1.cmml" xref="A4.T5.81.81.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.81.81.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.81.81.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.82.82.2">-0.54 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.82.82.2.m1.1"><semantics id="A4.T5.82.82.2.m1.1a"><mo id="A4.T5.82.82.2.m1.1.1" xref="A4.T5.82.82.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.82.82.2.m1.1b"><csymbol cd="latexml" id="A4.T5.82.82.2.m1.1.1.cmml" xref="A4.T5.82.82.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.82.82.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.82.82.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.83.83.3">-0.49 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.83.83.3.m1.1"><semantics id="A4.T5.83.83.3.m1.1a"><mo id="A4.T5.83.83.3.m1.1.1" xref="A4.T5.83.83.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.83.83.3.m1.1b"><csymbol cd="latexml" id="A4.T5.83.83.3.m1.1.1.cmml" xref="A4.T5.83.83.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.83.83.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.83.83.3.m1.1d">±</annotation></semantics></math> 0.09</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.84.84.4">0.86 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.84.84.4.m1.1"><semantics id="A4.T5.84.84.4.m1.1a"><mo id="A4.T5.84.84.4.m1.1.1" xref="A4.T5.84.84.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.84.84.4.m1.1b"><csymbol cd="latexml" id="A4.T5.84.84.4.m1.1.1.cmml" xref="A4.T5.84.84.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.84.84.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.84.84.4.m1.1d">±</annotation></semantics></math> 0.16</td>
</tr>
<tr class="ltx_tr" id="A4.T5.88.88">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.88.88.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.88.88.5.1">leaper</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.85.85.1">-0.43 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.85.85.1.m1.1"><semantics id="A4.T5.85.85.1.m1.1a"><mo id="A4.T5.85.85.1.m1.1.1" xref="A4.T5.85.85.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.85.85.1.m1.1b"><csymbol cd="latexml" id="A4.T5.85.85.1.m1.1.1.cmml" xref="A4.T5.85.85.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.85.85.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.85.85.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.86.86.2">-0.43 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.86.86.2.m1.1"><semantics id="A4.T5.86.86.2.m1.1a"><mo id="A4.T5.86.86.2.m1.1.1" xref="A4.T5.86.86.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.86.86.2.m1.1b"><csymbol cd="latexml" id="A4.T5.86.86.2.m1.1.1.cmml" xref="A4.T5.86.86.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.86.86.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.86.86.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.87.87.3">-0.43 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.87.87.3.m1.1"><semantics id="A4.T5.87.87.3.m1.1a"><mo id="A4.T5.87.87.3.m1.1.1" xref="A4.T5.87.87.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.87.87.3.m1.1b"><csymbol cd="latexml" id="A4.T5.87.87.3.m1.1.1.cmml" xref="A4.T5.87.87.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.87.87.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.87.87.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.88.88.4">-0.43 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.88.88.4.m1.1"><semantics id="A4.T5.88.88.4.m1.1a"><mo id="A4.T5.88.88.4.m1.1.1" xref="A4.T5.88.88.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.88.88.4.m1.1b"><csymbol cd="latexml" id="A4.T5.88.88.4.m1.1.1.cmml" xref="A4.T5.88.88.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.88.88.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.88.88.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T5.92.92">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.92.92.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.92.92.5.1">maze</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.89.89.1">1.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.89.89.1.m1.1"><semantics id="A4.T5.89.89.1.m1.1a"><mo id="A4.T5.89.89.1.m1.1.1" xref="A4.T5.89.89.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.89.89.1.m1.1b"><csymbol cd="latexml" id="A4.T5.89.89.1.m1.1.1.cmml" xref="A4.T5.89.89.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.89.89.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.89.89.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.90.90.2">-0.98 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.90.90.2.m1.1"><semantics id="A4.T5.90.90.2.m1.1a"><mo id="A4.T5.90.90.2.m1.1.1" xref="A4.T5.90.90.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.90.90.2.m1.1b"><csymbol cd="latexml" id="A4.T5.90.90.2.m1.1.1.cmml" xref="A4.T5.90.90.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.90.90.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.90.90.2.m1.1d">±</annotation></semantics></math> 0.04</td>
<td class="ltx_td ltx_align_center" id="A4.T5.91.91.3">0.11 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.91.91.3.m1.1"><semantics id="A4.T5.91.91.3.m1.1a"><mo id="A4.T5.91.91.3.m1.1.1" xref="A4.T5.91.91.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.91.91.3.m1.1b"><csymbol cd="latexml" id="A4.T5.91.91.3.m1.1.1.cmml" xref="A4.T5.91.91.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.91.91.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.91.91.3.m1.1d">±</annotation></semantics></math> 1.02</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.92.92.4">0.71 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.92.92.4.m1.1"><semantics id="A4.T5.92.92.4.m1.1a"><mo id="A4.T5.92.92.4.m1.1.1" xref="A4.T5.92.92.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.92.92.4.m1.1b"><csymbol cd="latexml" id="A4.T5.92.92.4.m1.1.1.cmml" xref="A4.T5.92.92.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.92.92.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.92.92.4.m1.1d">±</annotation></semantics></math> 0.14</td>
</tr>
<tr class="ltx_tr" id="A4.T5.96.96">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.96.96.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.96.96.5.1">miner</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.93.93.1">1.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.93.93.1.m1.1"><semantics id="A4.T5.93.93.1.m1.1a"><mo id="A4.T5.93.93.1.m1.1.1" xref="A4.T5.93.93.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.93.93.1.m1.1b"><csymbol cd="latexml" id="A4.T5.93.93.1.m1.1.1.cmml" xref="A4.T5.93.93.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.93.93.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.93.93.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T5.94.94.2">-0.05 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.94.94.2.m1.1"><semantics id="A4.T5.94.94.2.m1.1a"><mo id="A4.T5.94.94.2.m1.1.1" xref="A4.T5.94.94.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.94.94.2.m1.1b"><csymbol cd="latexml" id="A4.T5.94.94.2.m1.1.1.cmml" xref="A4.T5.94.94.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.94.94.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.94.94.2.m1.1d">±</annotation></semantics></math> 0.04</td>
<td class="ltx_td ltx_align_center" id="A4.T5.95.95.3">-0.02 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.95.95.3.m1.1"><semantics id="A4.T5.95.95.3.m1.1a"><mo id="A4.T5.95.95.3.m1.1.1" xref="A4.T5.95.95.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.95.95.3.m1.1b"><csymbol cd="latexml" id="A4.T5.95.95.3.m1.1.1.cmml" xref="A4.T5.95.95.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.95.95.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.95.95.3.m1.1d">±</annotation></semantics></math> 0.1</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.96.96.4">0.86 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.96.96.4.m1.1"><semantics id="A4.T5.96.96.4.m1.1a"><mo id="A4.T5.96.96.4.m1.1.1" xref="A4.T5.96.96.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.96.96.4.m1.1b"><csymbol cd="latexml" id="A4.T5.96.96.4.m1.1.1.cmml" xref="A4.T5.96.96.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.96.96.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.96.96.4.m1.1d">±</annotation></semantics></math> 0.02</td>
</tr>
<tr class="ltx_tr" id="A4.T5.100.100">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T5.100.100.5"><span class="ltx_text ltx_font_typewriter" id="A4.T5.100.100.5.1">starpilot</span></th>
<td class="ltx_td ltx_align_center" id="A4.T5.97.97.1">0.25 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.97.97.1.m1.1"><semantics id="A4.T5.97.97.1.m1.1a"><mo id="A4.T5.97.97.1.m1.1.1" xref="A4.T5.97.97.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.97.97.1.m1.1b"><csymbol cd="latexml" id="A4.T5.97.97.1.m1.1.1.cmml" xref="A4.T5.97.97.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.97.97.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.97.97.1.m1.1d">±</annotation></semantics></math> 0.17</td>
<td class="ltx_td ltx_align_center" id="A4.T5.98.98.2">0.12 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.98.98.2.m1.1"><semantics id="A4.T5.98.98.2.m1.1a"><mo id="A4.T5.98.98.2.m1.1.1" xref="A4.T5.98.98.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.98.98.2.m1.1b"><csymbol cd="latexml" id="A4.T5.98.98.2.m1.1.1.cmml" xref="A4.T5.98.98.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.98.98.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.98.98.2.m1.1d">±</annotation></semantics></math> 0.08</td>
<td class="ltx_td ltx_align_center" id="A4.T5.99.99.3">0.17 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.99.99.3.m1.1"><semantics id="A4.T5.99.99.3.m1.1a"><mo id="A4.T5.99.99.3.m1.1.1" xref="A4.T5.99.99.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.99.99.3.m1.1b"><csymbol cd="latexml" id="A4.T5.99.99.3.m1.1.1.cmml" xref="A4.T5.99.99.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.99.99.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.99.99.3.m1.1d">±</annotation></semantics></math> 0.08</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.100.100.4">0.25 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.100.100.4.m1.1"><semantics id="A4.T5.100.100.4.m1.1a"><mo id="A4.T5.100.100.4.m1.1.1" xref="A4.T5.100.100.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.100.100.4.m1.1b"><csymbol cd="latexml" id="A4.T5.100.100.4.m1.1.1.cmml" xref="A4.T5.100.100.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.100.100.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.100.100.4.m1.1d">±</annotation></semantics></math> 0.01</td>
</tr>
<tr class="ltx_tr" id="A4.T5.104.104">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T5.104.104.5"><span class="ltx_text ltx_font_bold" id="A4.T5.104.104.5.1">Average</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T5.101.101.1">0.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.101.101.1.m1.1"><semantics id="A4.T5.101.101.1.m1.1a"><mo id="A4.T5.101.101.1.m1.1.1" xref="A4.T5.101.101.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.101.101.1.m1.1b"><csymbol cd="latexml" id="A4.T5.101.101.1.m1.1.1.cmml" xref="A4.T5.101.101.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.101.101.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.101.101.1.m1.1d">±</annotation></semantics></math> 0.14</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T5.102.102.2">-0.14 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.102.102.2.m1.1"><semantics id="A4.T5.102.102.2.m1.1a"><mo id="A4.T5.102.102.2.m1.1.1" xref="A4.T5.102.102.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.102.102.2.m1.1b"><csymbol cd="latexml" id="A4.T5.102.102.2.m1.1.1.cmml" xref="A4.T5.102.102.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.102.102.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.102.102.2.m1.1d">±</annotation></semantics></math> 0.03</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T5.103.103.3">0.03 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.103.103.3.m1.1"><semantics id="A4.T5.103.103.3.m1.1a"><mo id="A4.T5.103.103.3.m1.1.1" xref="A4.T5.103.103.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.103.103.3.m1.1b"><csymbol cd="latexml" id="A4.T5.103.103.3.m1.1.1.cmml" xref="A4.T5.103.103.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.103.103.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.103.103.3.m1.1d">±</annotation></semantics></math> 0.05</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="A4.T5.104.104.4">0.39 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T5.104.104.4.m1.1"><semantics id="A4.T5.104.104.4.m1.1a"><mo id="A4.T5.104.104.4.m1.1.1" xref="A4.T5.104.104.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T5.104.104.4.m1.1b"><csymbol cd="latexml" id="A4.T5.104.104.4.m1.1.1.cmml" xref="A4.T5.104.104.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.104.104.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T5.104.104.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A4.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Procgen Train Tasks, Evaluation Seeds.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T6.104">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T6.104.105.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T6.104.105.1.1"><span class="ltx_text ltx_font_bold" id="A4.T6.104.105.1.1.1">Environment</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T6.104.105.1.2"><span class="ltx_text ltx_font_bold" id="A4.T6.104.105.1.2.1">DT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T6.104.105.1.3"><span class="ltx_text ltx_font_bold" id="A4.T6.104.105.1.3.1">AD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T6.104.105.1.4"><span class="ltx_text ltx_font_bold" id="A4.T6.104.105.1.4.1">DPT</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T6.104.105.1.5"><span class="ltx_text ltx_font_bold" id="A4.T6.104.105.1.5.1">RA-DT</span></th>
</tr>
<tr class="ltx_tr" id="A4.T6.104.106.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T6.104.106.2.1"><span class="ltx_text ltx_font_bold" id="A4.T6.104.106.2.1.1">Rewards</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T6.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.4.4.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.4.4.5.1">bigfish</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.1.1.1">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.1.1.1.m1.1"><semantics id="A4.T6.1.1.1.m1.1a"><mo id="A4.T6.1.1.1.m1.1.1" xref="A4.T6.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.1.1.1.m1.1b"><csymbol cd="latexml" id="A4.T6.1.1.1.m1.1.1.cmml" xref="A4.T6.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.1.1.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.2.2.2">0.37 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.2.2.2.m1.1"><semantics id="A4.T6.2.2.2.m1.1a"><mo id="A4.T6.2.2.2.m1.1.1" xref="A4.T6.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.2.2.2.m1.1b"><csymbol cd="latexml" id="A4.T6.2.2.2.m1.1.1.cmml" xref="A4.T6.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.2.2.2.m1.1d">±</annotation></semantics></math> 0.64</td>
<td class="ltx_td ltx_align_center" id="A4.T6.3.3.3">0.04 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.3.3.3.m1.1"><semantics id="A4.T6.3.3.3.m1.1a"><mo id="A4.T6.3.3.3.m1.1.1" xref="A4.T6.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.3.3.3.m1.1b"><csymbol cd="latexml" id="A4.T6.3.3.3.m1.1.1.cmml" xref="A4.T6.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.3.3.3.m1.1d">±</annotation></semantics></math> 0.08</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.4.4.4">0.38 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.4.4.4.m1.1"><semantics id="A4.T6.4.4.4.m1.1a"><mo id="A4.T6.4.4.4.m1.1.1" xref="A4.T6.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.4.4.4.m1.1b"><csymbol cd="latexml" id="A4.T6.4.4.4.m1.1.1.cmml" xref="A4.T6.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.4.4.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.4.4.4.m1.1d">±</annotation></semantics></math> 0.3</td>
</tr>
<tr class="ltx_tr" id="A4.T6.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.8.8.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.8.8.5.1">bossfight</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.5.5.1">0.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.5.5.1.m1.1"><semantics id="A4.T6.5.5.1.m1.1a"><mo id="A4.T6.5.5.1.m1.1.1" xref="A4.T6.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.5.5.1.m1.1b"><csymbol cd="latexml" id="A4.T6.5.5.1.m1.1.1.cmml" xref="A4.T6.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.5.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.5.5.1.m1.1d">±</annotation></semantics></math> 0.58</td>
<td class="ltx_td ltx_align_center" id="A4.T6.6.6.2">0.02 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.6.6.2.m1.1"><semantics id="A4.T6.6.6.2.m1.1a"><mo id="A4.T6.6.6.2.m1.1.1" xref="A4.T6.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.6.6.2.m1.1b"><csymbol cd="latexml" id="A4.T6.6.6.2.m1.1.1.cmml" xref="A4.T6.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.6.6.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.6.6.2.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_align_center" id="A4.T6.7.7.3">0.01 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.7.7.3.m1.1"><semantics id="A4.T6.7.7.3.m1.1a"><mo id="A4.T6.7.7.3.m1.1.1" xref="A4.T6.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.7.7.3.m1.1b"><csymbol cd="latexml" id="A4.T6.7.7.3.m1.1.1.cmml" xref="A4.T6.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.7.7.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.7.7.3.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.8.8.4">0.02 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.8.8.4.m1.1"><semantics id="A4.T6.8.8.4.m1.1a"><mo id="A4.T6.8.8.4.m1.1.1" xref="A4.T6.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.8.8.4.m1.1b"><csymbol cd="latexml" id="A4.T6.8.8.4.m1.1.1.cmml" xref="A4.T6.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.8.8.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.8.8.4.m1.1d">±</annotation></semantics></math> 0.04</td>
</tr>
<tr class="ltx_tr" id="A4.T6.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.12.12.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.12.12.5.1">caveflyer</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.9.9.1">6.67 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.9.9.1.m1.1"><semantics id="A4.T6.9.9.1.m1.1a"><mo id="A4.T6.9.9.1.m1.1.1" xref="A4.T6.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.9.9.1.m1.1b"><csymbol cd="latexml" id="A4.T6.9.9.1.m1.1.1.cmml" xref="A4.T6.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.9.9.1.m1.1d">±</annotation></semantics></math> 5.77</td>
<td class="ltx_td ltx_align_center" id="A4.T6.10.10.2">3.67 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.10.10.2.m1.1"><semantics id="A4.T6.10.10.2.m1.1a"><mo id="A4.T6.10.10.2.m1.1.1" xref="A4.T6.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.10.10.2.m1.1b"><csymbol cd="latexml" id="A4.T6.10.10.2.m1.1.1.cmml" xref="A4.T6.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.10.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.10.10.2.m1.1d">±</annotation></semantics></math> 2.08</td>
<td class="ltx_td ltx_align_center" id="A4.T6.11.11.3">7.67 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.11.11.3.m1.1"><semantics id="A4.T6.11.11.3.m1.1a"><mo id="A4.T6.11.11.3.m1.1.1" xref="A4.T6.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.11.11.3.m1.1b"><csymbol cd="latexml" id="A4.T6.11.11.3.m1.1.1.cmml" xref="A4.T6.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.11.11.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.11.11.3.m1.1d">±</annotation></semantics></math> 1.33</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.12.12.4">9.89 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.12.12.4.m1.1"><semantics id="A4.T6.12.12.4.m1.1a"><mo id="A4.T6.12.12.4.m1.1.1" xref="A4.T6.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.12.12.4.m1.1b"><csymbol cd="latexml" id="A4.T6.12.12.4.m1.1.1.cmml" xref="A4.T6.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.12.12.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.12.12.4.m1.1d">±</annotation></semantics></math> 0.19</td>
</tr>
<tr class="ltx_tr" id="A4.T6.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.16.16.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.16.16.5.1">chaser</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.13.13.1">2.79 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.13.13.1.m1.1"><semantics id="A4.T6.13.13.1.m1.1a"><mo id="A4.T6.13.13.1.m1.1.1" xref="A4.T6.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.13.13.1.m1.1b"><csymbol cd="latexml" id="A4.T6.13.13.1.m1.1.1.cmml" xref="A4.T6.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.13.13.1.m1.1d">±</annotation></semantics></math> 0.65</td>
<td class="ltx_td ltx_align_center" id="A4.T6.14.14.2">2.1 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.14.14.2.m1.1"><semantics id="A4.T6.14.14.2.m1.1a"><mo id="A4.T6.14.14.2.m1.1.1" xref="A4.T6.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.14.14.2.m1.1b"><csymbol cd="latexml" id="A4.T6.14.14.2.m1.1.1.cmml" xref="A4.T6.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.14.14.2.m1.1d">±</annotation></semantics></math> 0.67</td>
<td class="ltx_td ltx_align_center" id="A4.T6.15.15.3">2.75 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.15.15.3.m1.1"><semantics id="A4.T6.15.15.3.m1.1a"><mo id="A4.T6.15.15.3.m1.1.1" xref="A4.T6.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.15.15.3.m1.1b"><csymbol cd="latexml" id="A4.T6.15.15.3.m1.1.1.cmml" xref="A4.T6.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.15.15.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.15.15.3.m1.1d">±</annotation></semantics></math> 0.93</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.16.16.4">5.17 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.16.16.4.m1.1"><semantics id="A4.T6.16.16.4.m1.1a"><mo id="A4.T6.16.16.4.m1.1.1" xref="A4.T6.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.16.16.4.m1.1b"><csymbol cd="latexml" id="A4.T6.16.16.4.m1.1.1.cmml" xref="A4.T6.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.16.16.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.16.16.4.m1.1d">±</annotation></semantics></math> 0.58</td>
</tr>
<tr class="ltx_tr" id="A4.T6.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.20.20.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.20.20.5.1">coinrun</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.17.17.1">10.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.17.17.1.m1.1"><semantics id="A4.T6.17.17.1.m1.1a"><mo id="A4.T6.17.17.1.m1.1.1" xref="A4.T6.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.17.17.1.m1.1b"><csymbol cd="latexml" id="A4.T6.17.17.1.m1.1.1.cmml" xref="A4.T6.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.17.17.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.17.17.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.18.18.2">9.11 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.18.18.2.m1.1"><semantics id="A4.T6.18.18.2.m1.1a"><mo id="A4.T6.18.18.2.m1.1.1" xref="A4.T6.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.18.18.2.m1.1b"><csymbol cd="latexml" id="A4.T6.18.18.2.m1.1.1.cmml" xref="A4.T6.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.18.18.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.18.18.2.m1.1d">±</annotation></semantics></math> 0.84</td>
<td class="ltx_td ltx_align_center" id="A4.T6.19.19.3">9.89 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.19.19.3.m1.1"><semantics id="A4.T6.19.19.3.m1.1a"><mo id="A4.T6.19.19.3.m1.1.1" xref="A4.T6.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.19.19.3.m1.1b"><csymbol cd="latexml" id="A4.T6.19.19.3.m1.1.1.cmml" xref="A4.T6.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.19.19.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.19.19.3.m1.1d">±</annotation></semantics></math> 0.19</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.20.20.4">10.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.20.20.4.m1.1"><semantics id="A4.T6.20.20.4.m1.1a"><mo id="A4.T6.20.20.4.m1.1.1" xref="A4.T6.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.20.20.4.m1.1b"><csymbol cd="latexml" id="A4.T6.20.20.4.m1.1.1.cmml" xref="A4.T6.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.20.20.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.20.20.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T6.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.24.24.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.24.24.5.1">dodgeball</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.21.21.1">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.21.21.1.m1.1"><semantics id="A4.T6.21.21.1.m1.1a"><mo id="A4.T6.21.21.1.m1.1.1" xref="A4.T6.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.21.21.1.m1.1b"><csymbol cd="latexml" id="A4.T6.21.21.1.m1.1.1.cmml" xref="A4.T6.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.21.21.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.21.21.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.22.22.2">0.29 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.22.22.2.m1.1"><semantics id="A4.T6.22.22.2.m1.1a"><mo id="A4.T6.22.22.2.m1.1.1" xref="A4.T6.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.22.22.2.m1.1b"><csymbol cd="latexml" id="A4.T6.22.22.2.m1.1.1.cmml" xref="A4.T6.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.22.22.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.22.22.2.m1.1d">±</annotation></semantics></math> 0.3</td>
<td class="ltx_td ltx_align_center" id="A4.T6.23.23.3">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.23.23.3.m1.1"><semantics id="A4.T6.23.23.3.m1.1a"><mo id="A4.T6.23.23.3.m1.1.1" xref="A4.T6.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.23.23.3.m1.1b"><csymbol cd="latexml" id="A4.T6.23.23.3.m1.1.1.cmml" xref="A4.T6.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.23.23.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.23.23.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.24.24.4">0.47 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.24.24.4.m1.1"><semantics id="A4.T6.24.24.4.m1.1a"><mo id="A4.T6.24.24.4.m1.1.1" xref="A4.T6.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.24.24.4.m1.1b"><csymbol cd="latexml" id="A4.T6.24.24.4.m1.1.1.cmml" xref="A4.T6.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.24.24.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.24.24.4.m1.1d">±</annotation></semantics></math> 0.41</td>
</tr>
<tr class="ltx_tr" id="A4.T6.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.28.28.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.28.28.5.1">fruitbot</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.25.25.1">5.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.25.25.1.m1.1"><semantics id="A4.T6.25.25.1.m1.1a"><mo id="A4.T6.25.25.1.m1.1.1" xref="A4.T6.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.25.25.1.m1.1b"><csymbol cd="latexml" id="A4.T6.25.25.1.m1.1.1.cmml" xref="A4.T6.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.25.25.1.m1.1d">±</annotation></semantics></math> 4.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.26.26.2">0.63 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.26.26.2.m1.1"><semantics id="A4.T6.26.26.2.m1.1a"><mo id="A4.T6.26.26.2.m1.1.1" xref="A4.T6.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.26.26.2.m1.1b"><csymbol cd="latexml" id="A4.T6.26.26.2.m1.1.1.cmml" xref="A4.T6.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.26.26.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.26.26.2.m1.1d">±</annotation></semantics></math> 1.65</td>
<td class="ltx_td ltx_align_center" id="A4.T6.27.27.3">1.04 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.27.27.3.m1.1"><semantics id="A4.T6.27.27.3.m1.1a"><mo id="A4.T6.27.27.3.m1.1.1" xref="A4.T6.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.27.27.3.m1.1b"><csymbol cd="latexml" id="A4.T6.27.27.3.m1.1.1.cmml" xref="A4.T6.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.27.27.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.27.27.3.m1.1d">±</annotation></semantics></math> 0.83</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.28.28.4">4.01 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.28.28.4.m1.1"><semantics id="A4.T6.28.28.4.m1.1a"><mo id="A4.T6.28.28.4.m1.1.1" xref="A4.T6.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.28.28.4.m1.1b"><csymbol cd="latexml" id="A4.T6.28.28.4.m1.1.1.cmml" xref="A4.T6.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.28.28.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.28.28.4.m1.1d">±</annotation></semantics></math> 1.83</td>
</tr>
<tr class="ltx_tr" id="A4.T6.32.32">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.32.32.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.32.32.5.1">heist</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.29.29.1">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.29.29.1.m1.1"><semantics id="A4.T6.29.29.1.m1.1a"><mo id="A4.T6.29.29.1.m1.1.1" xref="A4.T6.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.29.29.1.m1.1b"><csymbol cd="latexml" id="A4.T6.29.29.1.m1.1.1.cmml" xref="A4.T6.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.29.29.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.29.29.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.30.30.2">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.30.30.2.m1.1"><semantics id="A4.T6.30.30.2.m1.1a"><mo id="A4.T6.30.30.2.m1.1.1" xref="A4.T6.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.30.30.2.m1.1b"><csymbol cd="latexml" id="A4.T6.30.30.2.m1.1.1.cmml" xref="A4.T6.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.30.30.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.30.30.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.31.31.3">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.31.31.3.m1.1"><semantics id="A4.T6.31.31.3.m1.1a"><mo id="A4.T6.31.31.3.m1.1.1" xref="A4.T6.31.31.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.31.31.3.m1.1b"><csymbol cd="latexml" id="A4.T6.31.31.3.m1.1.1.cmml" xref="A4.T6.31.31.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.31.31.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.31.31.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.32.32.4">0.11 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.32.32.4.m1.1"><semantics id="A4.T6.32.32.4.m1.1a"><mo id="A4.T6.32.32.4.m1.1.1" xref="A4.T6.32.32.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.32.32.4.m1.1b"><csymbol cd="latexml" id="A4.T6.32.32.4.m1.1.1.cmml" xref="A4.T6.32.32.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.32.32.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.32.32.4.m1.1d">±</annotation></semantics></math> 0.19</td>
</tr>
<tr class="ltx_tr" id="A4.T6.36.36">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.36.36.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.36.36.5.1">leaper</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.33.33.1">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.33.33.1.m1.1"><semantics id="A4.T6.33.33.1.m1.1a"><mo id="A4.T6.33.33.1.m1.1.1" xref="A4.T6.33.33.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.33.33.1.m1.1b"><csymbol cd="latexml" id="A4.T6.33.33.1.m1.1.1.cmml" xref="A4.T6.33.33.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.33.33.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.33.33.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.34.34.2">0.11 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.34.34.2.m1.1"><semantics id="A4.T6.34.34.2.m1.1a"><mo id="A4.T6.34.34.2.m1.1.1" xref="A4.T6.34.34.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.34.34.2.m1.1b"><csymbol cd="latexml" id="A4.T6.34.34.2.m1.1.1.cmml" xref="A4.T6.34.34.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.34.34.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.34.34.2.m1.1d">±</annotation></semantics></math> 0.19</td>
<td class="ltx_td ltx_align_center" id="A4.T6.35.35.3">0.11 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.35.35.3.m1.1"><semantics id="A4.T6.35.35.3.m1.1a"><mo id="A4.T6.35.35.3.m1.1.1" xref="A4.T6.35.35.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.35.35.3.m1.1b"><csymbol cd="latexml" id="A4.T6.35.35.3.m1.1.1.cmml" xref="A4.T6.35.35.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.35.35.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.35.35.3.m1.1d">±</annotation></semantics></math> 0.19</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.36.36.4">0.22 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.36.36.4.m1.1"><semantics id="A4.T6.36.36.4.m1.1a"><mo id="A4.T6.36.36.4.m1.1.1" xref="A4.T6.36.36.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.36.36.4.m1.1b"><csymbol cd="latexml" id="A4.T6.36.36.4.m1.1.1.cmml" xref="A4.T6.36.36.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.36.36.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.36.36.4.m1.1d">±</annotation></semantics></math> 0.38</td>
</tr>
<tr class="ltx_tr" id="A4.T6.40.40">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.40.40.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.40.40.5.1">maze</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.37.37.1">6.67 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.37.37.1.m1.1"><semantics id="A4.T6.37.37.1.m1.1a"><mo id="A4.T6.37.37.1.m1.1.1" xref="A4.T6.37.37.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.37.37.1.m1.1b"><csymbol cd="latexml" id="A4.T6.37.37.1.m1.1.1.cmml" xref="A4.T6.37.37.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.37.37.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.37.37.1.m1.1d">±</annotation></semantics></math> 5.77</td>
<td class="ltx_td ltx_align_center" id="A4.T6.38.38.2">2.78 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.38.38.2.m1.1"><semantics id="A4.T6.38.38.2.m1.1a"><mo id="A4.T6.38.38.2.m1.1.1" xref="A4.T6.38.38.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.38.38.2.m1.1b"><csymbol cd="latexml" id="A4.T6.38.38.2.m1.1.1.cmml" xref="A4.T6.38.38.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.38.38.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.38.38.2.m1.1d">±</annotation></semantics></math> 4.23</td>
<td class="ltx_td ltx_align_center" id="A4.T6.39.39.3">1.67 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.39.39.3.m1.1"><semantics id="A4.T6.39.39.3.m1.1a"><mo id="A4.T6.39.39.3.m1.1.1" xref="A4.T6.39.39.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.39.39.3.m1.1b"><csymbol cd="latexml" id="A4.T6.39.39.3.m1.1.1.cmml" xref="A4.T6.39.39.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.39.39.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.39.39.3.m1.1d">±</annotation></semantics></math> 2.89</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.40.40.4">8.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.40.40.4.m1.1"><semantics id="A4.T6.40.40.4.m1.1a"><mo id="A4.T6.40.40.4.m1.1.1" xref="A4.T6.40.40.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.40.40.4.m1.1b"><csymbol cd="latexml" id="A4.T6.40.40.4.m1.1.1.cmml" xref="A4.T6.40.40.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.40.40.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.40.40.4.m1.1d">±</annotation></semantics></math> 3.46</td>
</tr>
<tr class="ltx_tr" id="A4.T6.44.44">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.44.44.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.44.44.5.1">miner</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.41.41.1">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.41.41.1.m1.1"><semantics id="A4.T6.41.41.1.m1.1a"><mo id="A4.T6.41.41.1.m1.1.1" xref="A4.T6.41.41.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.41.41.1.m1.1b"><csymbol cd="latexml" id="A4.T6.41.41.1.m1.1.1.cmml" xref="A4.T6.41.41.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.41.41.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.41.41.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.42.42.2">0.58 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.42.42.2.m1.1"><semantics id="A4.T6.42.42.2.m1.1a"><mo id="A4.T6.42.42.2.m1.1.1" xref="A4.T6.42.42.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.42.42.2.m1.1b"><csymbol cd="latexml" id="A4.T6.42.42.2.m1.1.1.cmml" xref="A4.T6.42.42.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.42.42.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.42.42.2.m1.1d">±</annotation></semantics></math> 0.31</td>
<td class="ltx_td ltx_align_center" id="A4.T6.43.43.3">0.41 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.43.43.3.m1.1"><semantics id="A4.T6.43.43.3.m1.1a"><mo id="A4.T6.43.43.3.m1.1.1" xref="A4.T6.43.43.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.43.43.3.m1.1b"><csymbol cd="latexml" id="A4.T6.43.43.3.m1.1.1.cmml" xref="A4.T6.43.43.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.43.43.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.43.43.3.m1.1d">±</annotation></semantics></math> 0.07</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.44.44.4">0.77 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.44.44.4.m1.1"><semantics id="A4.T6.44.44.4.m1.1a"><mo id="A4.T6.44.44.4.m1.1.1" xref="A4.T6.44.44.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.44.44.4.m1.1b"><csymbol cd="latexml" id="A4.T6.44.44.4.m1.1.1.cmml" xref="A4.T6.44.44.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.44.44.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.44.44.4.m1.1d">±</annotation></semantics></math> 0.09</td>
</tr>
<tr class="ltx_tr" id="A4.T6.48.48">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.48.48.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.48.48.5.1">starpilot</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.45.45.1">16.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.45.45.1.m1.1"><semantics id="A4.T6.45.45.1.m1.1a"><mo id="A4.T6.45.45.1.m1.1.1" xref="A4.T6.45.45.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.45.45.1.m1.1b"><csymbol cd="latexml" id="A4.T6.45.45.1.m1.1.1.cmml" xref="A4.T6.45.45.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.45.45.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.45.45.1.m1.1d">±</annotation></semantics></math> 1.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.46.46.2">16.26 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.46.46.2.m1.1"><semantics id="A4.T6.46.46.2.m1.1a"><mo id="A4.T6.46.46.2.m1.1.1" xref="A4.T6.46.46.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.46.46.2.m1.1b"><csymbol cd="latexml" id="A4.T6.46.46.2.m1.1.1.cmml" xref="A4.T6.46.46.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.46.46.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.46.46.2.m1.1d">±</annotation></semantics></math> 5.4</td>
<td class="ltx_td ltx_align_center" id="A4.T6.47.47.3">15.81 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.47.47.3.m1.1"><semantics id="A4.T6.47.47.3.m1.1a"><mo id="A4.T6.47.47.3.m1.1.1" xref="A4.T6.47.47.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.47.47.3.m1.1b"><csymbol cd="latexml" id="A4.T6.47.47.3.m1.1.1.cmml" xref="A4.T6.47.47.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.47.47.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.47.47.3.m1.1d">±</annotation></semantics></math> 3.27</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.48.48.4">17.12 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.48.48.4.m1.1"><semantics id="A4.T6.48.48.4.m1.1a"><mo id="A4.T6.48.48.4.m1.1.1" xref="A4.T6.48.48.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.48.48.4.m1.1b"><csymbol cd="latexml" id="A4.T6.48.48.4.m1.1.1.cmml" xref="A4.T6.48.48.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.48.48.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.48.48.4.m1.1d">±</annotation></semantics></math> 1.58</td>
</tr>
<tr class="ltx_tr" id="A4.T6.52.52">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.52.52.5"><span class="ltx_text ltx_font_bold" id="A4.T6.52.52.5.1">Average</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.49.49.1">3.95 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.49.49.1.m1.1"><semantics id="A4.T6.49.49.1.m1.1a"><mo id="A4.T6.49.49.1.m1.1.1" xref="A4.T6.49.49.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.49.49.1.m1.1b"><csymbol cd="latexml" id="A4.T6.49.49.1.m1.1.1.cmml" xref="A4.T6.49.49.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.49.49.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.49.49.1.m1.1d">±</annotation></semantics></math> 0.78</td>
<td class="ltx_td ltx_align_center" id="A4.T6.50.50.2">2.99 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.50.50.2.m1.1"><semantics id="A4.T6.50.50.2.m1.1a"><mo id="A4.T6.50.50.2.m1.1.1" xref="A4.T6.50.50.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.50.50.2.m1.1b"><csymbol cd="latexml" id="A4.T6.50.50.2.m1.1.1.cmml" xref="A4.T6.50.50.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.50.50.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.50.50.2.m1.1d">±</annotation></semantics></math> 0.92</td>
<td class="ltx_td ltx_align_center" id="A4.T6.51.51.3">3.28 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.51.51.3.m1.1"><semantics id="A4.T6.51.51.3.m1.1a"><mo id="A4.T6.51.51.3.m1.1.1" xref="A4.T6.51.51.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.51.51.3.m1.1b"><csymbol cd="latexml" id="A4.T6.51.51.3.m1.1.1.cmml" xref="A4.T6.51.51.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.51.51.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.51.51.3.m1.1d">±</annotation></semantics></math> 0.26</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.52.52.4">4.68 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.52.52.4.m1.1"><semantics id="A4.T6.52.52.4.m1.1a"><mo id="A4.T6.52.52.4.m1.1.1" xref="A4.T6.52.52.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.52.52.4.m1.1b"><csymbol cd="latexml" id="A4.T6.52.52.4.m1.1.1.cmml" xref="A4.T6.52.52.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.52.52.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.52.52.4.m1.1d">±</annotation></semantics></math> 0.33</td>
</tr>
<tr class="ltx_tr" id="A4.T6.104.107.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T6.104.107.1.1"><span class="ltx_text ltx_font_bold" id="A4.T6.104.107.1.1.1">Human-normalized scores</span></th>
</tr>
<tr class="ltx_tr" id="A4.T6.56.56">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.56.56.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.56.56.5.1">bigfish</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.53.53.1">-0.03 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.53.53.1.m1.1"><semantics id="A4.T6.53.53.1.m1.1a"><mo id="A4.T6.53.53.1.m1.1.1" xref="A4.T6.53.53.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.53.53.1.m1.1b"><csymbol cd="latexml" id="A4.T6.53.53.1.m1.1.1.cmml" xref="A4.T6.53.53.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.53.53.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.53.53.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.54.54.2">-0.02 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.54.54.2.m1.1"><semantics id="A4.T6.54.54.2.m1.1a"><mo id="A4.T6.54.54.2.m1.1.1" xref="A4.T6.54.54.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.54.54.2.m1.1b"><csymbol cd="latexml" id="A4.T6.54.54.2.m1.1.1.cmml" xref="A4.T6.54.54.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.54.54.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.54.54.2.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_align_center" id="A4.T6.55.55.3">-0.02 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.55.55.3.m1.1"><semantics id="A4.T6.55.55.3.m1.1a"><mo id="A4.T6.55.55.3.m1.1.1" xref="A4.T6.55.55.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.55.55.3.m1.1b"><csymbol cd="latexml" id="A4.T6.55.55.3.m1.1.1.cmml" xref="A4.T6.55.55.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.55.55.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.55.55.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.56.56.4">-0.02 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.56.56.4.m1.1"><semantics id="A4.T6.56.56.4.m1.1a"><mo id="A4.T6.56.56.4.m1.1.1" xref="A4.T6.56.56.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.56.56.4.m1.1b"><csymbol cd="latexml" id="A4.T6.56.56.4.m1.1.1.cmml" xref="A4.T6.56.56.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.56.56.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.56.56.4.m1.1d">±</annotation></semantics></math> 0.01</td>
</tr>
<tr class="ltx_tr" id="A4.T6.60.60">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.60.60.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.60.60.5.1">bossfight</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.57.57.1">-0.01 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.57.57.1.m1.1"><semantics id="A4.T6.57.57.1.m1.1a"><mo id="A4.T6.57.57.1.m1.1.1" xref="A4.T6.57.57.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.57.57.1.m1.1b"><csymbol cd="latexml" id="A4.T6.57.57.1.m1.1.1.cmml" xref="A4.T6.57.57.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.57.57.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.57.57.1.m1.1d">±</annotation></semantics></math> 0.05</td>
<td class="ltx_td ltx_align_center" id="A4.T6.58.58.2">-0.04 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.58.58.2.m1.1"><semantics id="A4.T6.58.58.2.m1.1a"><mo id="A4.T6.58.58.2.m1.1.1" xref="A4.T6.58.58.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.58.58.2.m1.1b"><csymbol cd="latexml" id="A4.T6.58.58.2.m1.1.1.cmml" xref="A4.T6.58.58.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.58.58.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.58.58.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.59.59.3">-0.04 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.59.59.3.m1.1"><semantics id="A4.T6.59.59.3.m1.1a"><mo id="A4.T6.59.59.3.m1.1.1" xref="A4.T6.59.59.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.59.59.3.m1.1b"><csymbol cd="latexml" id="A4.T6.59.59.3.m1.1.1.cmml" xref="A4.T6.59.59.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.59.59.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.59.59.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.60.60.4">-0.04 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.60.60.4.m1.1"><semantics id="A4.T6.60.60.4.m1.1a"><mo id="A4.T6.60.60.4.m1.1.1" xref="A4.T6.60.60.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.60.60.4.m1.1b"><csymbol cd="latexml" id="A4.T6.60.60.4.m1.1.1.cmml" xref="A4.T6.60.60.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.60.60.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.60.60.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T6.64.64">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.64.64.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.64.64.5.1">caveflyer</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.61.61.1">0.37 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.61.61.1.m1.1"><semantics id="A4.T6.61.61.1.m1.1a"><mo id="A4.T6.61.61.1.m1.1.1" xref="A4.T6.61.61.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.61.61.1.m1.1b"><csymbol cd="latexml" id="A4.T6.61.61.1.m1.1.1.cmml" xref="A4.T6.61.61.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.61.61.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.61.61.1.m1.1d">±</annotation></semantics></math> 0.68</td>
<td class="ltx_td ltx_align_center" id="A4.T6.62.62.2">0.02 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.62.62.2.m1.1"><semantics id="A4.T6.62.62.2.m1.1a"><mo id="A4.T6.62.62.2.m1.1.1" xref="A4.T6.62.62.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.62.62.2.m1.1b"><csymbol cd="latexml" id="A4.T6.62.62.2.m1.1.1.cmml" xref="A4.T6.62.62.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.62.62.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.62.62.2.m1.1d">±</annotation></semantics></math> 0.24</td>
<td class="ltx_td ltx_align_center" id="A4.T6.63.63.3">0.49 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.63.63.3.m1.1"><semantics id="A4.T6.63.63.3.m1.1a"><mo id="A4.T6.63.63.3.m1.1.1" xref="A4.T6.63.63.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.63.63.3.m1.1b"><csymbol cd="latexml" id="A4.T6.63.63.3.m1.1.1.cmml" xref="A4.T6.63.63.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.63.63.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.63.63.3.m1.1d">±</annotation></semantics></math> 0.16</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.64.64.4">0.75 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.64.64.4.m1.1"><semantics id="A4.T6.64.64.4.m1.1a"><mo id="A4.T6.64.64.4.m1.1.1" xref="A4.T6.64.64.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.64.64.4.m1.1b"><csymbol cd="latexml" id="A4.T6.64.64.4.m1.1.1.cmml" xref="A4.T6.64.64.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.64.64.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.64.64.4.m1.1d">±</annotation></semantics></math> 0.02</td>
</tr>
<tr class="ltx_tr" id="A4.T6.68.68">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.68.68.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.68.68.5.1">chaser</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.65.65.1">0.18 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.65.65.1.m1.1"><semantics id="A4.T6.65.65.1.m1.1a"><mo id="A4.T6.65.65.1.m1.1.1" xref="A4.T6.65.65.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.65.65.1.m1.1b"><csymbol cd="latexml" id="A4.T6.65.65.1.m1.1.1.cmml" xref="A4.T6.65.65.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.65.65.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.65.65.1.m1.1d">±</annotation></semantics></math> 0.05</td>
<td class="ltx_td ltx_align_center" id="A4.T6.66.66.2">0.13 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.66.66.2.m1.1"><semantics id="A4.T6.66.66.2.m1.1a"><mo id="A4.T6.66.66.2.m1.1.1" xref="A4.T6.66.66.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.66.66.2.m1.1b"><csymbol cd="latexml" id="A4.T6.66.66.2.m1.1.1.cmml" xref="A4.T6.66.66.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.66.66.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.66.66.2.m1.1d">±</annotation></semantics></math> 0.05</td>
<td class="ltx_td ltx_align_center" id="A4.T6.67.67.3">0.18 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.67.67.3.m1.1"><semantics id="A4.T6.67.67.3.m1.1a"><mo id="A4.T6.67.67.3.m1.1.1" xref="A4.T6.67.67.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.67.67.3.m1.1b"><csymbol cd="latexml" id="A4.T6.67.67.3.m1.1.1.cmml" xref="A4.T6.67.67.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.67.67.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.67.67.3.m1.1d">±</annotation></semantics></math> 0.07</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.68.68.4">0.37 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.68.68.4.m1.1"><semantics id="A4.T6.68.68.4.m1.1a"><mo id="A4.T6.68.68.4.m1.1.1" xref="A4.T6.68.68.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.68.68.4.m1.1b"><csymbol cd="latexml" id="A4.T6.68.68.4.m1.1.1.cmml" xref="A4.T6.68.68.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.68.68.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.68.68.4.m1.1d">±</annotation></semantics></math> 0.05</td>
</tr>
<tr class="ltx_tr" id="A4.T6.72.72">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.72.72.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.72.72.5.1">coinrun</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.69.69.1">1.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.69.69.1.m1.1"><semantics id="A4.T6.69.69.1.m1.1a"><mo id="A4.T6.69.69.1.m1.1.1" xref="A4.T6.69.69.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.69.69.1.m1.1b"><csymbol cd="latexml" id="A4.T6.69.69.1.m1.1.1.cmml" xref="A4.T6.69.69.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.69.69.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.69.69.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.70.70.2">0.82 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.70.70.2.m1.1"><semantics id="A4.T6.70.70.2.m1.1a"><mo id="A4.T6.70.70.2.m1.1.1" xref="A4.T6.70.70.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.70.70.2.m1.1b"><csymbol cd="latexml" id="A4.T6.70.70.2.m1.1.1.cmml" xref="A4.T6.70.70.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.70.70.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.70.70.2.m1.1d">±</annotation></semantics></math> 0.17</td>
<td class="ltx_td ltx_align_center" id="A4.T6.71.71.3">0.98 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.71.71.3.m1.1"><semantics id="A4.T6.71.71.3.m1.1a"><mo id="A4.T6.71.71.3.m1.1.1" xref="A4.T6.71.71.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.71.71.3.m1.1b"><csymbol cd="latexml" id="A4.T6.71.71.3.m1.1.1.cmml" xref="A4.T6.71.71.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.71.71.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.71.71.3.m1.1d">±</annotation></semantics></math> 0.04</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.72.72.4">1.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.72.72.4.m1.1"><semantics id="A4.T6.72.72.4.m1.1a"><mo id="A4.T6.72.72.4.m1.1.1" xref="A4.T6.72.72.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.72.72.4.m1.1b"><csymbol cd="latexml" id="A4.T6.72.72.4.m1.1.1.cmml" xref="A4.T6.72.72.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.72.72.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.72.72.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T6.76.76">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.76.76.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.76.76.5.1">dodgeball</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.73.73.1">-0.09 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.73.73.1.m1.1"><semantics id="A4.T6.73.73.1.m1.1a"><mo id="A4.T6.73.73.1.m1.1.1" xref="A4.T6.73.73.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.73.73.1.m1.1b"><csymbol cd="latexml" id="A4.T6.73.73.1.m1.1.1.cmml" xref="A4.T6.73.73.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.73.73.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.73.73.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.74.74.2">-0.07 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.74.74.2.m1.1"><semantics id="A4.T6.74.74.2.m1.1a"><mo id="A4.T6.74.74.2.m1.1.1" xref="A4.T6.74.74.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.74.74.2.m1.1b"><csymbol cd="latexml" id="A4.T6.74.74.2.m1.1.1.cmml" xref="A4.T6.74.74.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.74.74.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.74.74.2.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_align_center" id="A4.T6.75.75.3">-0.09 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.75.75.3.m1.1"><semantics id="A4.T6.75.75.3.m1.1a"><mo id="A4.T6.75.75.3.m1.1.1" xref="A4.T6.75.75.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.75.75.3.m1.1b"><csymbol cd="latexml" id="A4.T6.75.75.3.m1.1.1.cmml" xref="A4.T6.75.75.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.75.75.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.75.75.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.76.76.4">-0.06 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.76.76.4.m1.1"><semantics id="A4.T6.76.76.4.m1.1a"><mo id="A4.T6.76.76.4.m1.1.1" xref="A4.T6.76.76.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.76.76.4.m1.1b"><csymbol cd="latexml" id="A4.T6.76.76.4.m1.1.1.cmml" xref="A4.T6.76.76.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.76.76.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.76.76.4.m1.1d">±</annotation></semantics></math> 0.02</td>
</tr>
<tr class="ltx_tr" id="A4.T6.80.80">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.80.80.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.80.80.5.1">fruitbot</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.77.77.1">0.19 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.77.77.1.m1.1"><semantics id="A4.T6.77.77.1.m1.1a"><mo id="A4.T6.77.77.1.m1.1.1" xref="A4.T6.77.77.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.77.77.1.m1.1b"><csymbol cd="latexml" id="A4.T6.77.77.1.m1.1.1.cmml" xref="A4.T6.77.77.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.77.77.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.77.77.1.m1.1d">±</annotation></semantics></math> 0.12</td>
<td class="ltx_td ltx_align_center" id="A4.T6.78.78.2">0.06 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.78.78.2.m1.1"><semantics id="A4.T6.78.78.2.m1.1a"><mo id="A4.T6.78.78.2.m1.1.1" xref="A4.T6.78.78.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.78.78.2.m1.1b"><csymbol cd="latexml" id="A4.T6.78.78.2.m1.1.1.cmml" xref="A4.T6.78.78.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.78.78.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.78.78.2.m1.1d">±</annotation></semantics></math> 0.05</td>
<td class="ltx_td ltx_align_center" id="A4.T6.79.79.3">0.08 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.79.79.3.m1.1"><semantics id="A4.T6.79.79.3.m1.1a"><mo id="A4.T6.79.79.3.m1.1.1" xref="A4.T6.79.79.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.79.79.3.m1.1b"><csymbol cd="latexml" id="A4.T6.79.79.3.m1.1.1.cmml" xref="A4.T6.79.79.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.79.79.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.79.79.3.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.80.80.4">0.16 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.80.80.4.m1.1"><semantics id="A4.T6.80.80.4.m1.1a"><mo id="A4.T6.80.80.4.m1.1.1" xref="A4.T6.80.80.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.80.80.4.m1.1b"><csymbol cd="latexml" id="A4.T6.80.80.4.m1.1.1.cmml" xref="A4.T6.80.80.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.80.80.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.80.80.4.m1.1d">±</annotation></semantics></math> 0.05</td>
</tr>
<tr class="ltx_tr" id="A4.T6.84.84">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.84.84.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.84.84.5.1">heist</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.81.81.1">-0.54 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.81.81.1.m1.1"><semantics id="A4.T6.81.81.1.m1.1a"><mo id="A4.T6.81.81.1.m1.1.1" xref="A4.T6.81.81.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.81.81.1.m1.1b"><csymbol cd="latexml" id="A4.T6.81.81.1.m1.1.1.cmml" xref="A4.T6.81.81.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.81.81.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.81.81.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.82.82.2">-0.54 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.82.82.2.m1.1"><semantics id="A4.T6.82.82.2.m1.1a"><mo id="A4.T6.82.82.2.m1.1.1" xref="A4.T6.82.82.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.82.82.2.m1.1b"><csymbol cd="latexml" id="A4.T6.82.82.2.m1.1.1.cmml" xref="A4.T6.82.82.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.82.82.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.82.82.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.83.83.3">-0.54 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.83.83.3.m1.1"><semantics id="A4.T6.83.83.3.m1.1a"><mo id="A4.T6.83.83.3.m1.1.1" xref="A4.T6.83.83.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.83.83.3.m1.1b"><csymbol cd="latexml" id="A4.T6.83.83.3.m1.1.1.cmml" xref="A4.T6.83.83.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.83.83.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.83.83.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.84.84.4">-0.52 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.84.84.4.m1.1"><semantics id="A4.T6.84.84.4.m1.1a"><mo id="A4.T6.84.84.4.m1.1.1" xref="A4.T6.84.84.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.84.84.4.m1.1b"><csymbol cd="latexml" id="A4.T6.84.84.4.m1.1.1.cmml" xref="A4.T6.84.84.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.84.84.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.84.84.4.m1.1d">±</annotation></semantics></math> 0.03</td>
</tr>
<tr class="ltx_tr" id="A4.T6.88.88">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.88.88.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.88.88.5.1">leaper</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.85.85.1">-0.43 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.85.85.1.m1.1"><semantics id="A4.T6.85.85.1.m1.1a"><mo id="A4.T6.85.85.1.m1.1.1" xref="A4.T6.85.85.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.85.85.1.m1.1b"><csymbol cd="latexml" id="A4.T6.85.85.1.m1.1.1.cmml" xref="A4.T6.85.85.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.85.85.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.85.85.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.86.86.2">-0.41 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.86.86.2.m1.1"><semantics id="A4.T6.86.86.2.m1.1a"><mo id="A4.T6.86.86.2.m1.1.1" xref="A4.T6.86.86.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.86.86.2.m1.1b"><csymbol cd="latexml" id="A4.T6.86.86.2.m1.1.1.cmml" xref="A4.T6.86.86.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.86.86.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.86.86.2.m1.1d">±</annotation></semantics></math> 0.03</td>
<td class="ltx_td ltx_align_center" id="A4.T6.87.87.3">-0.41 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.87.87.3.m1.1"><semantics id="A4.T6.87.87.3.m1.1a"><mo id="A4.T6.87.87.3.m1.1.1" xref="A4.T6.87.87.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.87.87.3.m1.1b"><csymbol cd="latexml" id="A4.T6.87.87.3.m1.1.1.cmml" xref="A4.T6.87.87.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.87.87.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.87.87.3.m1.1d">±</annotation></semantics></math> 0.03</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.88.88.4">-0.4 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.88.88.4.m1.1"><semantics id="A4.T6.88.88.4.m1.1a"><mo id="A4.T6.88.88.4.m1.1.1" xref="A4.T6.88.88.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.88.88.4.m1.1b"><csymbol cd="latexml" id="A4.T6.88.88.4.m1.1.1.cmml" xref="A4.T6.88.88.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.88.88.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.88.88.4.m1.1d">±</annotation></semantics></math> 0.05</td>
</tr>
<tr class="ltx_tr" id="A4.T6.92.92">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.92.92.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.92.92.5.1">maze</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.89.89.1">0.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.89.89.1.m1.1"><semantics id="A4.T6.89.89.1.m1.1a"><mo id="A4.T6.89.89.1.m1.1.1" xref="A4.T6.89.89.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.89.89.1.m1.1b"><csymbol cd="latexml" id="A4.T6.89.89.1.m1.1.1.cmml" xref="A4.T6.89.89.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.89.89.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.89.89.1.m1.1d">±</annotation></semantics></math> 1.15</td>
<td class="ltx_td ltx_align_center" id="A4.T6.90.90.2">-0.44 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.90.90.2.m1.1"><semantics id="A4.T6.90.90.2.m1.1a"><mo id="A4.T6.90.90.2.m1.1.1" xref="A4.T6.90.90.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.90.90.2.m1.1b"><csymbol cd="latexml" id="A4.T6.90.90.2.m1.1.1.cmml" xref="A4.T6.90.90.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.90.90.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.90.90.2.m1.1d">±</annotation></semantics></math> 0.85</td>
<td class="ltx_td ltx_align_center" id="A4.T6.91.91.3">-0.67 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.91.91.3.m1.1"><semantics id="A4.T6.91.91.3.m1.1a"><mo id="A4.T6.91.91.3.m1.1.1" xref="A4.T6.91.91.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.91.91.3.m1.1b"><csymbol cd="latexml" id="A4.T6.91.91.3.m1.1.1.cmml" xref="A4.T6.91.91.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.91.91.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.91.91.3.m1.1d">±</annotation></semantics></math> 0.58</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.92.92.4">0.6 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.92.92.4.m1.1"><semantics id="A4.T6.92.92.4.m1.1a"><mo id="A4.T6.92.92.4.m1.1.1" xref="A4.T6.92.92.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.92.92.4.m1.1b"><csymbol cd="latexml" id="A4.T6.92.92.4.m1.1.1.cmml" xref="A4.T6.92.92.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.92.92.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.92.92.4.m1.1d">±</annotation></semantics></math> 0.69</td>
</tr>
<tr class="ltx_tr" id="A4.T6.96.96">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.96.96.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.96.96.5.1">miner</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.93.93.1">-0.13 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.93.93.1.m1.1"><semantics id="A4.T6.93.93.1.m1.1a"><mo id="A4.T6.93.93.1.m1.1.1" xref="A4.T6.93.93.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.93.93.1.m1.1b"><csymbol cd="latexml" id="A4.T6.93.93.1.m1.1.1.cmml" xref="A4.T6.93.93.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.93.93.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.93.93.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T6.94.94.2">-0.08 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.94.94.2.m1.1"><semantics id="A4.T6.94.94.2.m1.1a"><mo id="A4.T6.94.94.2.m1.1.1" xref="A4.T6.94.94.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.94.94.2.m1.1b"><csymbol cd="latexml" id="A4.T6.94.94.2.m1.1.1.cmml" xref="A4.T6.94.94.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.94.94.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.94.94.2.m1.1d">±</annotation></semantics></math> 0.03</td>
<td class="ltx_td ltx_align_center" id="A4.T6.95.95.3">-0.09 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.95.95.3.m1.1"><semantics id="A4.T6.95.95.3.m1.1a"><mo id="A4.T6.95.95.3.m1.1.1" xref="A4.T6.95.95.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.95.95.3.m1.1b"><csymbol cd="latexml" id="A4.T6.95.95.3.m1.1.1.cmml" xref="A4.T6.95.95.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.95.95.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.95.95.3.m1.1d">±</annotation></semantics></math> 0.01</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.96.96.4">-0.06 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.96.96.4.m1.1"><semantics id="A4.T6.96.96.4.m1.1a"><mo id="A4.T6.96.96.4.m1.1.1" xref="A4.T6.96.96.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.96.96.4.m1.1b"><csymbol cd="latexml" id="A4.T6.96.96.4.m1.1.1.cmml" xref="A4.T6.96.96.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.96.96.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.96.96.4.m1.1d">±</annotation></semantics></math> 0.01</td>
</tr>
<tr class="ltx_tr" id="A4.T6.100.100">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T6.100.100.5"><span class="ltx_text ltx_font_typewriter" id="A4.T6.100.100.5.1">starpilot</span></th>
<td class="ltx_td ltx_align_center" id="A4.T6.97.97.1">0.22 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.97.97.1.m1.1"><semantics id="A4.T6.97.97.1.m1.1a"><mo id="A4.T6.97.97.1.m1.1.1" xref="A4.T6.97.97.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.97.97.1.m1.1b"><csymbol cd="latexml" id="A4.T6.97.97.1.m1.1.1.cmml" xref="A4.T6.97.97.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.97.97.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.97.97.1.m1.1d">±</annotation></semantics></math> 0.02</td>
<td class="ltx_td ltx_align_center" id="A4.T6.98.98.2">0.22 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.98.98.2.m1.1"><semantics id="A4.T6.98.98.2.m1.1a"><mo id="A4.T6.98.98.2.m1.1.1" xref="A4.T6.98.98.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.98.98.2.m1.1b"><csymbol cd="latexml" id="A4.T6.98.98.2.m1.1.1.cmml" xref="A4.T6.98.98.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.98.98.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.98.98.2.m1.1d">±</annotation></semantics></math> 0.09</td>
<td class="ltx_td ltx_align_center" id="A4.T6.99.99.3">0.22 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.99.99.3.m1.1"><semantics id="A4.T6.99.99.3.m1.1a"><mo id="A4.T6.99.99.3.m1.1.1" xref="A4.T6.99.99.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.99.99.3.m1.1b"><csymbol cd="latexml" id="A4.T6.99.99.3.m1.1.1.cmml" xref="A4.T6.99.99.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.99.99.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.99.99.3.m1.1d">±</annotation></semantics></math> 0.05</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T6.100.100.4">0.24 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.100.100.4.m1.1"><semantics id="A4.T6.100.100.4.m1.1a"><mo id="A4.T6.100.100.4.m1.1.1" xref="A4.T6.100.100.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.100.100.4.m1.1b"><csymbol cd="latexml" id="A4.T6.100.100.4.m1.1.1.cmml" xref="A4.T6.100.100.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.100.100.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.100.100.4.m1.1d">±</annotation></semantics></math> 0.03</td>
</tr>
<tr class="ltx_tr" id="A4.T6.104.104">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T6.104.104.5"><span class="ltx_text ltx_font_bold" id="A4.T6.104.104.5.1">Average</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T6.101.101.1">0.09 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.101.101.1.m1.1"><semantics id="A4.T6.101.101.1.m1.1a"><mo id="A4.T6.101.101.1.m1.1.1" xref="A4.T6.101.101.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.101.101.1.m1.1b"><csymbol cd="latexml" id="A4.T6.101.101.1.m1.1.1.cmml" xref="A4.T6.101.101.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.101.101.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.101.101.1.m1.1d">±</annotation></semantics></math> 0.1</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T6.102.102.2">-0.03 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.102.102.2.m1.1"><semantics id="A4.T6.102.102.2.m1.1a"><mo id="A4.T6.102.102.2.m1.1.1" xref="A4.T6.102.102.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.102.102.2.m1.1b"><csymbol cd="latexml" id="A4.T6.102.102.2.m1.1.1.cmml" xref="A4.T6.102.102.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.102.102.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.102.102.2.m1.1d">±</annotation></semantics></math> 0.1</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T6.103.103.3">0.01 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.103.103.3.m1.1"><semantics id="A4.T6.103.103.3.m1.1a"><mo id="A4.T6.103.103.3.m1.1.1" xref="A4.T6.103.103.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.103.103.3.m1.1b"><csymbol cd="latexml" id="A4.T6.103.103.3.m1.1.1.cmml" xref="A4.T6.103.103.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.103.103.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.103.103.3.m1.1d">±</annotation></semantics></math> 0.04</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="A4.T6.104.104.4">0.17 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T6.104.104.4.m1.1"><semantics id="A4.T6.104.104.4.m1.1a"><mo id="A4.T6.104.104.4.m1.1.1" xref="A4.T6.104.104.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T6.104.104.4.m1.1b"><csymbol cd="latexml" id="A4.T6.104.104.4.m1.1.1.cmml" xref="A4.T6.104.104.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T6.104.104.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T6.104.104.4.m1.1d">±</annotation></semantics></math> 0.05</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A4.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Procgen Eval Envs.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T7.40">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T7.40.41.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A4.T7.40.41.1.1"><span class="ltx_text ltx_font_bold" id="A4.T7.40.41.1.1.1">Environment</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T7.40.41.1.2"><span class="ltx_text ltx_font_bold" id="A4.T7.40.41.1.2.1">DT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T7.40.41.1.3"><span class="ltx_text ltx_font_bold" id="A4.T7.40.41.1.3.1">AD</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T7.40.41.1.4"><span class="ltx_text ltx_font_bold" id="A4.T7.40.41.1.4.1">DPT</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T7.40.41.1.5"><span class="ltx_text ltx_font_bold" id="A4.T7.40.41.1.5.1">RA-DT</span></th>
</tr>
<tr class="ltx_tr" id="A4.T7.40.42.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T7.40.42.2.1"><span class="ltx_text ltx_font_bold" id="A4.T7.40.42.2.1.1">Reward</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T7.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T7.4.4.5"><span class="ltx_text ltx_font_typewriter" id="A4.T7.4.4.5.1">climber</span></th>
<td class="ltx_td ltx_align_center" id="A4.T7.1.1.1">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.1.1.1.m1.1"><semantics id="A4.T7.1.1.1.m1.1a"><mo id="A4.T7.1.1.1.m1.1.1" xref="A4.T7.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.1.1.1.m1.1b"><csymbol cd="latexml" id="A4.T7.1.1.1.m1.1.1.cmml" xref="A4.T7.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.1.1.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.2.2.2">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.2.2.2.m1.1"><semantics id="A4.T7.2.2.2.m1.1a"><mo id="A4.T7.2.2.2.m1.1.1" xref="A4.T7.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.2.2.2.m1.1b"><csymbol cd="latexml" id="A4.T7.2.2.2.m1.1.1.cmml" xref="A4.T7.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.2.2.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.3.3.3">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.3.3.3.m1.1"><semantics id="A4.T7.3.3.3.m1.1a"><mo id="A4.T7.3.3.3.m1.1.1" xref="A4.T7.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.3.3.3.m1.1b"><csymbol cd="latexml" id="A4.T7.3.3.3.m1.1.1.cmml" xref="A4.T7.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.3.3.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T7.4.4.4">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.4.4.4.m1.1"><semantics id="A4.T7.4.4.4.m1.1a"><mo id="A4.T7.4.4.4.m1.1.1" xref="A4.T7.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.4.4.4.m1.1b"><csymbol cd="latexml" id="A4.T7.4.4.4.m1.1.1.cmml" xref="A4.T7.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.4.4.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.4.4.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T7.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T7.8.8.5"><span class="ltx_text ltx_font_typewriter" id="A4.T7.8.8.5.1">ninja</span></th>
<td class="ltx_td ltx_align_center" id="A4.T7.5.5.1">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.5.5.1.m1.1"><semantics id="A4.T7.5.5.1.m1.1a"><mo id="A4.T7.5.5.1.m1.1.1" xref="A4.T7.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.5.5.1.m1.1b"><csymbol cd="latexml" id="A4.T7.5.5.1.m1.1.1.cmml" xref="A4.T7.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.5.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.5.5.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.6.6.2">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.6.6.2.m1.1"><semantics id="A4.T7.6.6.2.m1.1a"><mo id="A4.T7.6.6.2.m1.1.1" xref="A4.T7.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.6.6.2.m1.1b"><csymbol cd="latexml" id="A4.T7.6.6.2.m1.1.1.cmml" xref="A4.T7.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.6.6.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.6.6.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.7.7.3">0.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.7.7.3.m1.1"><semantics id="A4.T7.7.7.3.m1.1a"><mo id="A4.T7.7.7.3.m1.1.1" xref="A4.T7.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.7.7.3.m1.1b"><csymbol cd="latexml" id="A4.T7.7.7.3.m1.1.1.cmml" xref="A4.T7.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.7.7.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.7.7.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T7.8.8.4">1.89 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.8.8.4.m1.1"><semantics id="A4.T7.8.8.4.m1.1a"><mo id="A4.T7.8.8.4.m1.1.1" xref="A4.T7.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.8.8.4.m1.1b"><csymbol cd="latexml" id="A4.T7.8.8.4.m1.1.1.cmml" xref="A4.T7.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.8.8.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.8.8.4.m1.1d">±</annotation></semantics></math> 2.71</td>
</tr>
<tr class="ltx_tr" id="A4.T7.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T7.12.12.5"><span class="ltx_text ltx_font_typewriter" id="A4.T7.12.12.5.1">plunder</span></th>
<td class="ltx_td ltx_align_center" id="A4.T7.9.9.1">2.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.9.9.1.m1.1"><semantics id="A4.T7.9.9.1.m1.1a"><mo id="A4.T7.9.9.1.m1.1.1" xref="A4.T7.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.9.9.1.m1.1b"><csymbol cd="latexml" id="A4.T7.9.9.1.m1.1.1.cmml" xref="A4.T7.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.9.9.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.9.9.1.m1.1d">±</annotation></semantics></math> 1.73</td>
<td class="ltx_td ltx_align_center" id="A4.T7.10.10.2">0.27 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.10.10.2.m1.1"><semantics id="A4.T7.10.10.2.m1.1a"><mo id="A4.T7.10.10.2.m1.1.1" xref="A4.T7.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.10.10.2.m1.1b"><csymbol cd="latexml" id="A4.T7.10.10.2.m1.1.1.cmml" xref="A4.T7.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.10.10.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.10.10.2.m1.1d">±</annotation></semantics></math> 0.13</td>
<td class="ltx_td ltx_align_center" id="A4.T7.11.11.3">0.48 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.11.11.3.m1.1"><semantics id="A4.T7.11.11.3.m1.1a"><mo id="A4.T7.11.11.3.m1.1.1" xref="A4.T7.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.11.11.3.m1.1b"><csymbol cd="latexml" id="A4.T7.11.11.3.m1.1.1.cmml" xref="A4.T7.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.11.11.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.11.11.3.m1.1d">±</annotation></semantics></math> 0.32</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T7.12.12.4">2.39 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.12.12.4.m1.1"><semantics id="A4.T7.12.12.4.m1.1a"><mo id="A4.T7.12.12.4.m1.1.1" xref="A4.T7.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.12.12.4.m1.1b"><csymbol cd="latexml" id="A4.T7.12.12.4.m1.1.1.cmml" xref="A4.T7.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.12.12.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.12.12.4.m1.1d">±</annotation></semantics></math> 0.67</td>
</tr>
<tr class="ltx_tr" id="A4.T7.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T7.16.16.5"><span class="ltx_text ltx_font_typewriter" id="A4.T7.16.16.5.1">jumper</span></th>
<td class="ltx_td ltx_align_center" id="A4.T7.13.13.1">3.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.13.13.1.m1.1"><semantics id="A4.T7.13.13.1.m1.1a"><mo id="A4.T7.13.13.1.m1.1.1" xref="A4.T7.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.13.13.1.m1.1b"><csymbol cd="latexml" id="A4.T7.13.13.1.m1.1.1.cmml" xref="A4.T7.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.13.13.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.13.13.1.m1.1d">±</annotation></semantics></math> 5.77</td>
<td class="ltx_td ltx_align_center" id="A4.T7.14.14.2">2.78 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.14.14.2.m1.1"><semantics id="A4.T7.14.14.2.m1.1a"><mo id="A4.T7.14.14.2.m1.1.1" xref="A4.T7.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.14.14.2.m1.1b"><csymbol cd="latexml" id="A4.T7.14.14.2.m1.1.1.cmml" xref="A4.T7.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.14.14.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.14.14.2.m1.1d">±</annotation></semantics></math> 2.83</td>
<td class="ltx_td ltx_align_center" id="A4.T7.15.15.3">2.0 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.15.15.3.m1.1"><semantics id="A4.T7.15.15.3.m1.1a"><mo id="A4.T7.15.15.3.m1.1.1" xref="A4.T7.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.15.15.3.m1.1b"><csymbol cd="latexml" id="A4.T7.15.15.3.m1.1.1.cmml" xref="A4.T7.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.15.15.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.15.15.3.m1.1d">±</annotation></semantics></math> 1.45</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T7.16.16.4">4.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.16.16.4.m1.1"><semantics id="A4.T7.16.16.4.m1.1a"><mo id="A4.T7.16.16.4.m1.1.1" xref="A4.T7.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.16.16.4.m1.1b"><csymbol cd="latexml" id="A4.T7.16.16.4.m1.1.1.cmml" xref="A4.T7.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.16.16.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.16.16.4.m1.1d">±</annotation></semantics></math> 2.33</td>
</tr>
<tr class="ltx_tr" id="A4.T7.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T7.20.20.5"><span class="ltx_text ltx_font_bold" id="A4.T7.20.20.5.1">Avgerage</span></th>
<td class="ltx_td ltx_align_center" id="A4.T7.17.17.1">1.33 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.17.17.1.m1.1"><semantics id="A4.T7.17.17.1.m1.1a"><mo id="A4.T7.17.17.1.m1.1.1" xref="A4.T7.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.17.17.1.m1.1b"><csymbol cd="latexml" id="A4.T7.17.17.1.m1.1.1.cmml" xref="A4.T7.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.17.17.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.17.17.1.m1.1d">±</annotation></semantics></math> 1.01</td>
<td class="ltx_td ltx_align_center" id="A4.T7.18.18.2">0.76 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.18.18.2.m1.1"><semantics id="A4.T7.18.18.2.m1.1a"><mo id="A4.T7.18.18.2.m1.1.1" xref="A4.T7.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.18.18.2.m1.1b"><csymbol cd="latexml" id="A4.T7.18.18.2.m1.1.1.cmml" xref="A4.T7.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.18.18.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.18.18.2.m1.1d">±</annotation></semantics></math> 0.68</td>
<td class="ltx_td ltx_align_center" id="A4.T7.19.19.3">0.62 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.19.19.3.m1.1"><semantics id="A4.T7.19.19.3.m1.1a"><mo id="A4.T7.19.19.3.m1.1.1" xref="A4.T7.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.19.19.3.m1.1b"><csymbol cd="latexml" id="A4.T7.19.19.3.m1.1.1.cmml" xref="A4.T7.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.19.19.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.19.19.3.m1.1d">±</annotation></semantics></math> 0.37</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T7.20.20.4">2.15 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.20.20.4.m1.1"><semantics id="A4.T7.20.20.4.m1.1a"><mo id="A4.T7.20.20.4.m1.1.1" xref="A4.T7.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.20.20.4.m1.1b"><csymbol cd="latexml" id="A4.T7.20.20.4.m1.1.1.cmml" xref="A4.T7.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.20.20.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.20.20.4.m1.1d">±</annotation></semantics></math> 0.85</td>
</tr>
<tr class="ltx_tr" id="A4.T7.40.43.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A4.T7.40.43.1.1"><span class="ltx_text ltx_font_bold" id="A4.T7.40.43.1.1.1">Human-normalized Score</span></th>
</tr>
<tr class="ltx_tr" id="A4.T7.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T7.24.24.5"><span class="ltx_text ltx_font_typewriter" id="A4.T7.24.24.5.1">climber</span></th>
<td class="ltx_td ltx_align_center" id="A4.T7.21.21.1">-0.19 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.21.21.1.m1.1"><semantics id="A4.T7.21.21.1.m1.1a"><mo id="A4.T7.21.21.1.m1.1.1" xref="A4.T7.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.21.21.1.m1.1b"><csymbol cd="latexml" id="A4.T7.21.21.1.m1.1.1.cmml" xref="A4.T7.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.21.21.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.21.21.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.22.22.2">-0.19 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.22.22.2.m1.1"><semantics id="A4.T7.22.22.2.m1.1a"><mo id="A4.T7.22.22.2.m1.1.1" xref="A4.T7.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.22.22.2.m1.1b"><csymbol cd="latexml" id="A4.T7.22.22.2.m1.1.1.cmml" xref="A4.T7.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.22.22.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.22.22.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.23.23.3">-0.19 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.23.23.3.m1.1"><semantics id="A4.T7.23.23.3.m1.1a"><mo id="A4.T7.23.23.3.m1.1.1" xref="A4.T7.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.23.23.3.m1.1b"><csymbol cd="latexml" id="A4.T7.23.23.3.m1.1.1.cmml" xref="A4.T7.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.23.23.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.23.23.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T7.24.24.4">-0.19 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.24.24.4.m1.1"><semantics id="A4.T7.24.24.4.m1.1a"><mo id="A4.T7.24.24.4.m1.1.1" xref="A4.T7.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.24.24.4.m1.1b"><csymbol cd="latexml" id="A4.T7.24.24.4.m1.1.1.cmml" xref="A4.T7.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.24.24.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.24.24.4.m1.1d">±</annotation></semantics></math> 0.0</td>
</tr>
<tr class="ltx_tr" id="A4.T7.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T7.28.28.5"><span class="ltx_text ltx_font_typewriter" id="A4.T7.28.28.5.1">ninja</span></th>
<td class="ltx_td ltx_align_center" id="A4.T7.25.25.1">-0.54 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.25.25.1.m1.1"><semantics id="A4.T7.25.25.1.m1.1a"><mo id="A4.T7.25.25.1.m1.1.1" xref="A4.T7.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.25.25.1.m1.1b"><csymbol cd="latexml" id="A4.T7.25.25.1.m1.1.1.cmml" xref="A4.T7.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.25.25.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.25.25.1.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.26.26.2">-0.54 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.26.26.2.m1.1"><semantics id="A4.T7.26.26.2.m1.1a"><mo id="A4.T7.26.26.2.m1.1.1" xref="A4.T7.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.26.26.2.m1.1b"><csymbol cd="latexml" id="A4.T7.26.26.2.m1.1.1.cmml" xref="A4.T7.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.26.26.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.26.26.2.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_align_center" id="A4.T7.27.27.3">-0.54 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.27.27.3.m1.1"><semantics id="A4.T7.27.27.3.m1.1a"><mo id="A4.T7.27.27.3.m1.1.1" xref="A4.T7.27.27.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.27.27.3.m1.1b"><csymbol cd="latexml" id="A4.T7.27.27.3.m1.1.1.cmml" xref="A4.T7.27.27.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.27.27.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.27.27.3.m1.1d">±</annotation></semantics></math> 0.0</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T7.28.28.4">-0.25 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.28.28.4.m1.1"><semantics id="A4.T7.28.28.4.m1.1a"><mo id="A4.T7.28.28.4.m1.1.1" xref="A4.T7.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.28.28.4.m1.1b"><csymbol cd="latexml" id="A4.T7.28.28.4.m1.1.1.cmml" xref="A4.T7.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.28.28.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.28.28.4.m1.1d">±</annotation></semantics></math> 0.42</td>
</tr>
<tr class="ltx_tr" id="A4.T7.32.32">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T7.32.32.5"><span class="ltx_text ltx_font_typewriter" id="A4.T7.32.32.5.1">plunder</span></th>
<td class="ltx_td ltx_align_center" id="A4.T7.29.29.1">-0.1 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.29.29.1.m1.1"><semantics id="A4.T7.29.29.1.m1.1a"><mo id="A4.T7.29.29.1.m1.1.1" xref="A4.T7.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.29.29.1.m1.1b"><csymbol cd="latexml" id="A4.T7.29.29.1.m1.1.1.cmml" xref="A4.T7.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.29.29.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.29.29.1.m1.1d">±</annotation></semantics></math> 0.07</td>
<td class="ltx_td ltx_align_center" id="A4.T7.30.30.2">-0.17 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.30.30.2.m1.1"><semantics id="A4.T7.30.30.2.m1.1a"><mo id="A4.T7.30.30.2.m1.1.1" xref="A4.T7.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.30.30.2.m1.1b"><csymbol cd="latexml" id="A4.T7.30.30.2.m1.1.1.cmml" xref="A4.T7.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.30.30.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.30.30.2.m1.1d">±</annotation></semantics></math> 0.01</td>
<td class="ltx_td ltx_align_center" id="A4.T7.31.31.3">-0.16 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.31.31.3.m1.1"><semantics id="A4.T7.31.31.3.m1.1a"><mo id="A4.T7.31.31.3.m1.1.1" xref="A4.T7.31.31.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.31.31.3.m1.1b"><csymbol cd="latexml" id="A4.T7.31.31.3.m1.1.1.cmml" xref="A4.T7.31.31.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.31.31.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.31.31.3.m1.1d">±</annotation></semantics></math> 0.01</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T7.32.32.4">-0.08 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.32.32.4.m1.1"><semantics id="A4.T7.32.32.4.m1.1a"><mo id="A4.T7.32.32.4.m1.1.1" xref="A4.T7.32.32.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.32.32.4.m1.1b"><csymbol cd="latexml" id="A4.T7.32.32.4.m1.1.1.cmml" xref="A4.T7.32.32.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.32.32.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.32.32.4.m1.1d">±</annotation></semantics></math> 0.03</td>
</tr>
<tr class="ltx_tr" id="A4.T7.36.36">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A4.T7.36.36.5"><span class="ltx_text ltx_font_typewriter" id="A4.T7.36.36.5.1">jumper</span></th>
<td class="ltx_td ltx_align_center" id="A4.T7.33.33.1">0.05 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.33.33.1.m1.1"><semantics id="A4.T7.33.33.1.m1.1a"><mo id="A4.T7.33.33.1.m1.1.1" xref="A4.T7.33.33.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.33.33.1.m1.1b"><csymbol cd="latexml" id="A4.T7.33.33.1.m1.1.1.cmml" xref="A4.T7.33.33.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.33.33.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.33.33.1.m1.1d">±</annotation></semantics></math> 0.82</td>
<td class="ltx_td ltx_align_center" id="A4.T7.34.34.2">-0.03 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.34.34.2.m1.1"><semantics id="A4.T7.34.34.2.m1.1a"><mo id="A4.T7.34.34.2.m1.1.1" xref="A4.T7.34.34.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.34.34.2.m1.1b"><csymbol cd="latexml" id="A4.T7.34.34.2.m1.1.1.cmml" xref="A4.T7.34.34.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.34.34.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.34.34.2.m1.1d">±</annotation></semantics></math> 0.4</td>
<td class="ltx_td ltx_align_center" id="A4.T7.35.35.3">-0.14 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.35.35.3.m1.1"><semantics id="A4.T7.35.35.3.m1.1a"><mo id="A4.T7.35.35.3.m1.1.1" xref="A4.T7.35.35.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.35.35.3.m1.1b"><csymbol cd="latexml" id="A4.T7.35.35.3.m1.1.1.cmml" xref="A4.T7.35.35.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.35.35.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.35.35.3.m1.1d">±</annotation></semantics></math> 0.21</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T7.36.36.4">0.19 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.36.36.4.m1.1"><semantics id="A4.T7.36.36.4.m1.1a"><mo id="A4.T7.36.36.4.m1.1.1" xref="A4.T7.36.36.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.36.36.4.m1.1b"><csymbol cd="latexml" id="A4.T7.36.36.4.m1.1.1.cmml" xref="A4.T7.36.36.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.36.36.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.36.36.4.m1.1d">±</annotation></semantics></math> 0.33</td>
</tr>
<tr class="ltx_tr" id="A4.T7.40.40">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T7.40.40.5"><span class="ltx_text ltx_font_bold" id="A4.T7.40.40.5.1">Average</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.37.37.1">-0.19 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.37.37.1.m1.1"><semantics id="A4.T7.37.37.1.m1.1a"><mo id="A4.T7.37.37.1.m1.1.1" xref="A4.T7.37.37.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.37.37.1.m1.1b"><csymbol cd="latexml" id="A4.T7.37.37.1.m1.1.1.cmml" xref="A4.T7.37.37.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.37.37.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.37.37.1.m1.1d">±</annotation></semantics></math> 0.19</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.38.38.2">-0.23 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.38.38.2.m1.1"><semantics id="A4.T7.38.38.2.m1.1a"><mo id="A4.T7.38.38.2.m1.1.1" xref="A4.T7.38.38.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.38.38.2.m1.1b"><csymbol cd="latexml" id="A4.T7.38.38.2.m1.1.1.cmml" xref="A4.T7.38.38.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.38.38.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.38.38.2.m1.1d">±</annotation></semantics></math> 0.1</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T7.39.39.3">-0.26 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.39.39.3.m1.1"><semantics id="A4.T7.39.39.3.m1.1a"><mo id="A4.T7.39.39.3.m1.1.1" xref="A4.T7.39.39.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.39.39.3.m1.1b"><csymbol cd="latexml" id="A4.T7.39.39.3.m1.1.1.cmml" xref="A4.T7.39.39.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.39.39.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.39.39.3.m1.1d">±</annotation></semantics></math> 0.05</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="A4.T7.40.40.4">-0.08 <math alttext="\pm" class="ltx_Math" display="inline" id="A4.T7.40.40.4.m1.1"><semantics id="A4.T7.40.40.4.m1.1a"><mo id="A4.T7.40.40.4.m1.1.1" xref="A4.T7.40.40.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A4.T7.40.40.4.m1.1b"><csymbol cd="latexml" id="A4.T7.40.40.4.m1.1.1.cmml" xref="A4.T7.40.40.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A4.T7.40.40.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="A4.T7.40.40.4.m1.1d">±</annotation></semantics></math> 0.12</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Ablation Studies</h2>
<div class="ltx_para ltx_noindent" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">To better understand the effect of learning with retrieval, we presented a number of ablation studies on critical components in RA-DT (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS6" title="4.6 Ablations ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4.6</span></a>).
We conduct all ablations on Dark-Room <math alttext="10\times 10" class="ltx_Math" display="inline" id="A5.p1.1.m1.1"><semantics id="A5.p1.1.m1.1a"><mrow id="A5.p1.1.m1.1.1" xref="A5.p1.1.m1.1.1.cmml"><mn id="A5.p1.1.m1.1.1.2" xref="A5.p1.1.m1.1.1.2.cmml">10</mn><mo id="A5.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A5.p1.1.m1.1.1.1.cmml">×</mo><mn id="A5.p1.1.m1.1.1.3" xref="A5.p1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.1b"><apply id="A5.p1.1.m1.1.1.cmml" xref="A5.p1.1.m1.1.1"><times id="A5.p1.1.m1.1.1.1.cmml" xref="A5.p1.1.m1.1.1.1"></times><cn id="A5.p1.1.m1.1.1.2.cmml" type="integer" xref="A5.p1.1.m1.1.1.2">10</cn><cn id="A5.p1.1.m1.1.1.3.cmml" type="integer" xref="A5.p1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A5.p1.1.m1.1d">10 × 10</annotation></semantics></math> and otherwise retain the same experiment design choices, as reported in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.SS1" title="4.1 Dark-Room ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</p>
</div>
<section class="ltx_subsection" id="A5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.1 </span>Retrieval outperforms sampling of experiences</h3>
<div class="ltx_para ltx_noindent" id="A5.SS1.p1">
<p class="ltx_p" id="A5.SS1.p1.1">RA-DT is conditioned on sub-trajectories via cross-attention.
By default, RA-DT leverages retrieval to search for relevant sub-trajectories for a given input sequence.
Instead of retrieval, sub-trajectories can be sampled at random from the external memory. Therefore, we conduct an ablation in which we swap the retrieval mechanism with random sampling of sub-trajectories during training.
This is to investigate the effect of relevance of retrieved sub-trajectories on learning performance.
We apply random sampling only during training and use our regular retrieval during inference.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.SS1.p2">
<p class="ltx_p" id="A5.SS1.p2.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S4.F6" title="Figure 6 ‣ 4.6 Ablations ‣ 4 Experiments ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">6</span></a>a,
we show the ICL curves for training RA-DT with retrieved sub-trajectories, sub-trajectories sampled from the same task as the input sequence, and sub-trajectories sampled uniformly across all tasks.
We find that training with retrieval outperforms both sampling variants.
Uniform sampling results in poor ICL performance.
A reason for this, is that context trajectories from a different goal location, are not relevant for predicting actions in the current sequences.
As a result, the model ignores the given context during the training phase, and subsequently is unable to leverage it during inference.
In contrast, sampling sub-trajectories from the same task as the input sequence results in better ICL performance, as the model learns to make use of the context trajectories.
Nevertheless, using retrieval results in even better ICL performance, as sub-trajectories are not only relevant for the current task, but also similar to the current situation.</p>
</div>
</section>
<section class="ltx_subsection" id="A5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.2 </span>Reweighting Mechanism</h3>
<div class="ltx_para ltx_noindent" id="A5.SS2.p1">
<p class="ltx_p" id="A5.SS2.p1.7">Next, we evaluate how our reweighting mechanism affects the ICL abilities of RA-DT.
RA-DT reweights a sub-trajectory by its <span class="ltx_text ltx_font_italic" id="A5.SS2.p1.7.1">relevance</span> and <span class="ltx_text ltx_font_italic" id="A5.SS2.p1.7.2">utility</span> score (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3.SS2" title="3.2 Retrieval-augmented Decision Transformer (RA-DT) ‣ 3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3.2</span></a>).
During training, we set <math alttext="s_{u}(\tau_{\text{ret}})=1" class="ltx_Math" display="inline" id="A5.SS2.p1.1.m1.1"><semantics id="A5.SS2.p1.1.m1.1a"><mrow id="A5.SS2.p1.1.m1.1.1" xref="A5.SS2.p1.1.m1.1.1.cmml"><mrow id="A5.SS2.p1.1.m1.1.1.1" xref="A5.SS2.p1.1.m1.1.1.1.cmml"><msub id="A5.SS2.p1.1.m1.1.1.1.3" xref="A5.SS2.p1.1.m1.1.1.1.3.cmml"><mi id="A5.SS2.p1.1.m1.1.1.1.3.2" xref="A5.SS2.p1.1.m1.1.1.1.3.2.cmml">s</mi><mi id="A5.SS2.p1.1.m1.1.1.1.3.3" xref="A5.SS2.p1.1.m1.1.1.1.3.3.cmml">u</mi></msub><mo id="A5.SS2.p1.1.m1.1.1.1.2" xref="A5.SS2.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="A5.SS2.p1.1.m1.1.1.1.1.1" xref="A5.SS2.p1.1.m1.1.1.1.1.1.1.cmml"><mo id="A5.SS2.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="A5.SS2.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A5.SS2.p1.1.m1.1.1.1.1.1.1" xref="A5.SS2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="A5.SS2.p1.1.m1.1.1.1.1.1.1.2" xref="A5.SS2.p1.1.m1.1.1.1.1.1.1.2.cmml">τ</mi><mtext id="A5.SS2.p1.1.m1.1.1.1.1.1.1.3" xref="A5.SS2.p1.1.m1.1.1.1.1.1.1.3a.cmml">ret</mtext></msub><mo id="A5.SS2.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="A5.SS2.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A5.SS2.p1.1.m1.1.1.2" xref="A5.SS2.p1.1.m1.1.1.2.cmml">=</mo><mn id="A5.SS2.p1.1.m1.1.1.3" xref="A5.SS2.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.1.m1.1b"><apply id="A5.SS2.p1.1.m1.1.1.cmml" xref="A5.SS2.p1.1.m1.1.1"><eq id="A5.SS2.p1.1.m1.1.1.2.cmml" xref="A5.SS2.p1.1.m1.1.1.2"></eq><apply id="A5.SS2.p1.1.m1.1.1.1.cmml" xref="A5.SS2.p1.1.m1.1.1.1"><times id="A5.SS2.p1.1.m1.1.1.1.2.cmml" xref="A5.SS2.p1.1.m1.1.1.1.2"></times><apply id="A5.SS2.p1.1.m1.1.1.1.3.cmml" xref="A5.SS2.p1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="A5.SS2.p1.1.m1.1.1.1.3.1.cmml" xref="A5.SS2.p1.1.m1.1.1.1.3">subscript</csymbol><ci id="A5.SS2.p1.1.m1.1.1.1.3.2.cmml" xref="A5.SS2.p1.1.m1.1.1.1.3.2">𝑠</ci><ci id="A5.SS2.p1.1.m1.1.1.1.3.3.cmml" xref="A5.SS2.p1.1.m1.1.1.1.3.3">𝑢</ci></apply><apply id="A5.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="A5.SS2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.SS2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="A5.SS2.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="A5.SS2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="A5.SS2.p1.1.m1.1.1.1.1.1.1.2">𝜏</ci><ci id="A5.SS2.p1.1.m1.1.1.1.1.1.1.3a.cmml" xref="A5.SS2.p1.1.m1.1.1.1.1.1.1.3"><mtext id="A5.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="A5.SS2.p1.1.m1.1.1.1.1.1.1.3">ret</mtext></ci></apply></apply><cn id="A5.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="A5.SS2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.1.m1.1c">s_{u}(\tau_{\text{ret}})=1</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ( italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ) = 1</annotation></semantics></math>, if the <math alttext="\tau_{\text{ret}}" class="ltx_Math" display="inline" id="A5.SS2.p1.2.m2.1"><semantics id="A5.SS2.p1.2.m2.1a"><msub id="A5.SS2.p1.2.m2.1.1" xref="A5.SS2.p1.2.m2.1.1.cmml"><mi id="A5.SS2.p1.2.m2.1.1.2" xref="A5.SS2.p1.2.m2.1.1.2.cmml">τ</mi><mtext id="A5.SS2.p1.2.m2.1.1.3" xref="A5.SS2.p1.2.m2.1.1.3a.cmml">ret</mtext></msub><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.2.m2.1b"><apply id="A5.SS2.p1.2.m2.1.1.cmml" xref="A5.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A5.SS2.p1.2.m2.1.1.1.cmml" xref="A5.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="A5.SS2.p1.2.m2.1.1.2.cmml" xref="A5.SS2.p1.2.m2.1.1.2">𝜏</ci><ci id="A5.SS2.p1.2.m2.1.1.3a.cmml" xref="A5.SS2.p1.2.m2.1.1.3"><mtext id="A5.SS2.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="A5.SS2.p1.2.m2.1.1.3">ret</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.2.m2.1c">\tau_{\text{ret}}</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.2.m2.1d">italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT</annotation></semantics></math> is from the same task as <math alttext="\tau_{\text{in}}" class="ltx_Math" display="inline" id="A5.SS2.p1.3.m3.1"><semantics id="A5.SS2.p1.3.m3.1a"><msub id="A5.SS2.p1.3.m3.1.1" xref="A5.SS2.p1.3.m3.1.1.cmml"><mi id="A5.SS2.p1.3.m3.1.1.2" xref="A5.SS2.p1.3.m3.1.1.2.cmml">τ</mi><mtext id="A5.SS2.p1.3.m3.1.1.3" xref="A5.SS2.p1.3.m3.1.1.3a.cmml">in</mtext></msub><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.3.m3.1b"><apply id="A5.SS2.p1.3.m3.1.1.cmml" xref="A5.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A5.SS2.p1.3.m3.1.1.1.cmml" xref="A5.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="A5.SS2.p1.3.m3.1.1.2.cmml" xref="A5.SS2.p1.3.m3.1.1.2">𝜏</ci><ci id="A5.SS2.p1.3.m3.1.1.3a.cmml" xref="A5.SS2.p1.3.m3.1.1.3"><mtext id="A5.SS2.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="A5.SS2.p1.3.m3.1.1.3">in</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.3.m3.1c">\tau_{\text{in}}</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.3.m3.1d">italic_τ start_POSTSUBSCRIPT in end_POSTSUBSCRIPT</annotation></semantics></math>, and 0 otherwise.
Instead of reweighting by task ID, alternatives are to reweight a <math alttext="\tau_{\text{ret}}" class="ltx_Math" display="inline" id="A5.SS2.p1.4.m4.1"><semantics id="A5.SS2.p1.4.m4.1a"><msub id="A5.SS2.p1.4.m4.1.1" xref="A5.SS2.p1.4.m4.1.1.cmml"><mi id="A5.SS2.p1.4.m4.1.1.2" xref="A5.SS2.p1.4.m4.1.1.2.cmml">τ</mi><mtext id="A5.SS2.p1.4.m4.1.1.3" xref="A5.SS2.p1.4.m4.1.1.3a.cmml">ret</mtext></msub><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.4.m4.1b"><apply id="A5.SS2.p1.4.m4.1.1.cmml" xref="A5.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A5.SS2.p1.4.m4.1.1.1.cmml" xref="A5.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="A5.SS2.p1.4.m4.1.1.2.cmml" xref="A5.SS2.p1.4.m4.1.1.2">𝜏</ci><ci id="A5.SS2.p1.4.m4.1.1.3a.cmml" xref="A5.SS2.p1.4.m4.1.1.3"><mtext id="A5.SS2.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="A5.SS2.p1.4.m4.1.1.3">ret</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.4.m4.1c">\tau_{\text{ret}}</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.4.m4.1d">italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT</annotation></semantics></math> by its return achieved or by its position in the training dataset.
When reweighting by position, we assign <math alttext="s_{u}(\tau_{\text{ret}})=1" class="ltx_Math" display="inline" id="A5.SS2.p1.5.m5.1"><semantics id="A5.SS2.p1.5.m5.1a"><mrow id="A5.SS2.p1.5.m5.1.1" xref="A5.SS2.p1.5.m5.1.1.cmml"><mrow id="A5.SS2.p1.5.m5.1.1.1" xref="A5.SS2.p1.5.m5.1.1.1.cmml"><msub id="A5.SS2.p1.5.m5.1.1.1.3" xref="A5.SS2.p1.5.m5.1.1.1.3.cmml"><mi id="A5.SS2.p1.5.m5.1.1.1.3.2" xref="A5.SS2.p1.5.m5.1.1.1.3.2.cmml">s</mi><mi id="A5.SS2.p1.5.m5.1.1.1.3.3" xref="A5.SS2.p1.5.m5.1.1.1.3.3.cmml">u</mi></msub><mo id="A5.SS2.p1.5.m5.1.1.1.2" xref="A5.SS2.p1.5.m5.1.1.1.2.cmml">⁢</mo><mrow id="A5.SS2.p1.5.m5.1.1.1.1.1" xref="A5.SS2.p1.5.m5.1.1.1.1.1.1.cmml"><mo id="A5.SS2.p1.5.m5.1.1.1.1.1.2" stretchy="false" xref="A5.SS2.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><msub id="A5.SS2.p1.5.m5.1.1.1.1.1.1" xref="A5.SS2.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="A5.SS2.p1.5.m5.1.1.1.1.1.1.2" xref="A5.SS2.p1.5.m5.1.1.1.1.1.1.2.cmml">τ</mi><mtext id="A5.SS2.p1.5.m5.1.1.1.1.1.1.3" xref="A5.SS2.p1.5.m5.1.1.1.1.1.1.3a.cmml">ret</mtext></msub><mo id="A5.SS2.p1.5.m5.1.1.1.1.1.3" stretchy="false" xref="A5.SS2.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A5.SS2.p1.5.m5.1.1.2" xref="A5.SS2.p1.5.m5.1.1.2.cmml">=</mo><mn id="A5.SS2.p1.5.m5.1.1.3" xref="A5.SS2.p1.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.5.m5.1b"><apply id="A5.SS2.p1.5.m5.1.1.cmml" xref="A5.SS2.p1.5.m5.1.1"><eq id="A5.SS2.p1.5.m5.1.1.2.cmml" xref="A5.SS2.p1.5.m5.1.1.2"></eq><apply id="A5.SS2.p1.5.m5.1.1.1.cmml" xref="A5.SS2.p1.5.m5.1.1.1"><times id="A5.SS2.p1.5.m5.1.1.1.2.cmml" xref="A5.SS2.p1.5.m5.1.1.1.2"></times><apply id="A5.SS2.p1.5.m5.1.1.1.3.cmml" xref="A5.SS2.p1.5.m5.1.1.1.3"><csymbol cd="ambiguous" id="A5.SS2.p1.5.m5.1.1.1.3.1.cmml" xref="A5.SS2.p1.5.m5.1.1.1.3">subscript</csymbol><ci id="A5.SS2.p1.5.m5.1.1.1.3.2.cmml" xref="A5.SS2.p1.5.m5.1.1.1.3.2">𝑠</ci><ci id="A5.SS2.p1.5.m5.1.1.1.3.3.cmml" xref="A5.SS2.p1.5.m5.1.1.1.3.3">𝑢</ci></apply><apply id="A5.SS2.p1.5.m5.1.1.1.1.1.1.cmml" xref="A5.SS2.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="A5.SS2.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="A5.SS2.p1.5.m5.1.1.1.1.1">subscript</csymbol><ci id="A5.SS2.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="A5.SS2.p1.5.m5.1.1.1.1.1.1.2">𝜏</ci><ci id="A5.SS2.p1.5.m5.1.1.1.1.1.1.3a.cmml" xref="A5.SS2.p1.5.m5.1.1.1.1.1.1.3"><mtext id="A5.SS2.p1.5.m5.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="A5.SS2.p1.5.m5.1.1.1.1.1.1.3">ret</mtext></ci></apply></apply><cn id="A5.SS2.p1.5.m5.1.1.3.cmml" type="integer" xref="A5.SS2.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.5.m5.1c">s_{u}(\tau_{\text{ret}})=1</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.5.m5.1d">italic_s start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ( italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT ) = 1</annotation></semantics></math> if <math alttext="\tau_{\text{ret}}" class="ltx_Math" display="inline" id="A5.SS2.p1.6.m6.1"><semantics id="A5.SS2.p1.6.m6.1a"><msub id="A5.SS2.p1.6.m6.1.1" xref="A5.SS2.p1.6.m6.1.1.cmml"><mi id="A5.SS2.p1.6.m6.1.1.2" xref="A5.SS2.p1.6.m6.1.1.2.cmml">τ</mi><mtext id="A5.SS2.p1.6.m6.1.1.3" xref="A5.SS2.p1.6.m6.1.1.3a.cmml">ret</mtext></msub><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.6.m6.1b"><apply id="A5.SS2.p1.6.m6.1.1.cmml" xref="A5.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A5.SS2.p1.6.m6.1.1.1.cmml" xref="A5.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="A5.SS2.p1.6.m6.1.1.2.cmml" xref="A5.SS2.p1.6.m6.1.1.2">𝜏</ci><ci id="A5.SS2.p1.6.m6.1.1.3a.cmml" xref="A5.SS2.p1.6.m6.1.1.3"><mtext id="A5.SS2.p1.6.m6.1.1.3.cmml" mathsize="70%" xref="A5.SS2.p1.6.m6.1.1.3">ret</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.6.m6.1c">\tau_{\text{ret}}</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.6.m6.1d">italic_τ start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT</annotation></semantics></math> was generated before <math alttext="\tau_{\text{in}}" class="ltx_Math" display="inline" id="A5.SS2.p1.7.m7.1"><semantics id="A5.SS2.p1.7.m7.1a"><msub id="A5.SS2.p1.7.m7.1.1" xref="A5.SS2.p1.7.m7.1.1.cmml"><mi id="A5.SS2.p1.7.m7.1.1.2" xref="A5.SS2.p1.7.m7.1.1.2.cmml">τ</mi><mtext id="A5.SS2.p1.7.m7.1.1.3" xref="A5.SS2.p1.7.m7.1.1.3a.cmml">in</mtext></msub><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.7.m7.1b"><apply id="A5.SS2.p1.7.m7.1.1.cmml" xref="A5.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A5.SS2.p1.7.m7.1.1.1.cmml" xref="A5.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="A5.SS2.p1.7.m7.1.1.2.cmml" xref="A5.SS2.p1.7.m7.1.1.2">𝜏</ci><ci id="A5.SS2.p1.7.m7.1.1.3a.cmml" xref="A5.SS2.p1.7.m7.1.1.3"><mtext id="A5.SS2.p1.7.m7.1.1.3.cmml" mathsize="70%" xref="A5.SS2.p1.7.m7.1.1.3">in</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.7.m7.1c">\tau_{\text{in}}</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p1.7.m7.1d">italic_τ start_POSTSUBSCRIPT in end_POSTSUBSCRIPT</annotation></semantics></math> by the PPO agent that generated the data.
Reweighting by position makes it likely that RA-DT observes the improvement steps in its context.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.SS2.p2">
<p class="ltx_p" id="A5.SS2.p2.1">We find that task-based reweighting is essential for achieving the highest performance scores (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F28" title="Figure 28 ‣ E.2 Reweighting Mechanism ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">28</span></a>).
Using no reweighting at all results in a considerable drop in ICL performance.
However, using retrieval with no task reweighting still compares favourably to uniform sampling across all tasks.
This result suggests that retrieval can play an important role in environments without a clear task separation or in scenarios where no task IDs are available.</p>
</div>
<figure class="ltx_figure" id="A5.F28">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="25" id="A5.F28.g1" src="extracted/5911726/figures/ablations/reweighting/legend.png" width="568"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F28.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A5.F28.sf1.g1" src="extracted/5911726/figures/ablations/reweighting/train_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>80 Train Goals</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F28.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A5.F28.sf2.g1" src="extracted/5911726/figures/ablations/reweighting/eval_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>20 Eval Goals</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 28: </span>Effect of the <span class="ltx_text ltx_font_bold" id="A5.F28.6.1">Reweighting Mechanism</span>. Average performances on Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="A5.F28.2.m1.1"><semantics id="A5.F28.2.m1.1b"><mo id="A5.F28.2.m1.1.1" xref="A5.F28.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A5.F28.2.m1.1c"><times id="A5.F28.2.m1.1.1.cmml" xref="A5.F28.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A5.F28.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A5.F28.2.m1.1e">×</annotation></semantics></math>10 over the course of training for <span class="ltx_text ltx_font_bold" id="A5.F28.7.2">(a)</span> train and <span class="ltx_text ltx_font_bold" id="A5.F28.8.3">(b)</span> test tasks.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A5.SS2.p3">
<p class="ltx_p" id="A5.SS2.p3.4">In addition, we conduct a sensitivity analysis on the <math alttext="\alpha" class="ltx_Math" display="inline" id="A5.SS2.p3.1.m1.1"><semantics id="A5.SS2.p3.1.m1.1a"><mi id="A5.SS2.p3.1.m1.1.1" xref="A5.SS2.p3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.SS2.p3.1.m1.1b"><ci id="A5.SS2.p3.1.m1.1.1.cmml" xref="A5.SS2.p3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p3.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p3.1.m1.1d">italic_α</annotation></semantics></math> parameter used in the re-weighting mechanism that determines how strongly the utility scores influences the final retrieval score.
<math alttext="\alpha=1" class="ltx_Math" display="inline" id="A5.SS2.p3.2.m2.1"><semantics id="A5.SS2.p3.2.m2.1a"><mrow id="A5.SS2.p3.2.m2.1.1" xref="A5.SS2.p3.2.m2.1.1.cmml"><mi id="A5.SS2.p3.2.m2.1.1.2" xref="A5.SS2.p3.2.m2.1.1.2.cmml">α</mi><mo id="A5.SS2.p3.2.m2.1.1.1" xref="A5.SS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="A5.SS2.p3.2.m2.1.1.3" xref="A5.SS2.p3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS2.p3.2.m2.1b"><apply id="A5.SS2.p3.2.m2.1.1.cmml" xref="A5.SS2.p3.2.m2.1.1"><eq id="A5.SS2.p3.2.m2.1.1.1.cmml" xref="A5.SS2.p3.2.m2.1.1.1"></eq><ci id="A5.SS2.p3.2.m2.1.1.2.cmml" xref="A5.SS2.p3.2.m2.1.1.2">𝛼</ci><cn id="A5.SS2.p3.2.m2.1.1.3.cmml" type="integer" xref="A5.SS2.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p3.2.m2.1c">\alpha=1</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p3.2.m2.1d">italic_α = 1</annotation></semantics></math> is used both during training for task-based reweighing and during evaluation for return-based reweighting (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#S3" title="3 Method ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">3</span></a>).
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F29" title="Figure 29 ‣ E.2 Reweighting Mechanism ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">29</span></a>, we vary <math alttext="\alpha" class="ltx_Math" display="inline" id="A5.SS2.p3.3.m3.1"><semantics id="A5.SS2.p3.3.m3.1a"><mi id="A5.SS2.p3.3.m3.1.1" xref="A5.SS2.p3.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.SS2.p3.3.m3.1b"><ci id="A5.SS2.p3.3.m3.1.1.cmml" xref="A5.SS2.p3.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p3.3.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p3.3.m3.1d">italic_α</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="A5.SS2.p3.4.1">(a)</span> during training, or <span class="ltx_text ltx_font_bold" id="A5.SS2.p3.4.2">(b)</span> during evaluation, while keeping the other fixed.
We find that RA-DT perform well for a range of values, but performance declines if no re-weighting is employed (<math alttext="\alpha=0" class="ltx_Math" display="inline" id="A5.SS2.p3.4.m4.1"><semantics id="A5.SS2.p3.4.m4.1a"><mrow id="A5.SS2.p3.4.m4.1.1" xref="A5.SS2.p3.4.m4.1.1.cmml"><mi id="A5.SS2.p3.4.m4.1.1.2" xref="A5.SS2.p3.4.m4.1.1.2.cmml">α</mi><mo id="A5.SS2.p3.4.m4.1.1.1" xref="A5.SS2.p3.4.m4.1.1.1.cmml">=</mo><mn id="A5.SS2.p3.4.m4.1.1.3" xref="A5.SS2.p3.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS2.p3.4.m4.1b"><apply id="A5.SS2.p3.4.m4.1.1.cmml" xref="A5.SS2.p3.4.m4.1.1"><eq id="A5.SS2.p3.4.m4.1.1.1.cmml" xref="A5.SS2.p3.4.m4.1.1.1"></eq><ci id="A5.SS2.p3.4.m4.1.1.2.cmml" xref="A5.SS2.p3.4.m4.1.1.2">𝛼</ci><cn id="A5.SS2.p3.4.m4.1.1.3.cmml" type="integer" xref="A5.SS2.p3.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p3.4.m4.1c">\alpha=0</annotation><annotation encoding="application/x-llamapun" id="A5.SS2.p3.4.m4.1d">italic_α = 0</annotation></semantics></math>).</p>
</div>
<figure class="ltx_figure" id="A5.F29">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="25" id="A5.F29.g1" src="extracted/5911726/figures/ablations/sensitivity_return/legend.png" width="449"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F29.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A5.F29.sf1.g1" src="extracted/5911726/figures/ablations/sensitivity_task/darkroom10x10.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Train - Task reweighting</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F29.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A5.F29.sf2.g1" src="extracted/5911726/figures/ablations/sensitivity_return/darkroom10x10.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Eval - Return reweighting</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 29: </span><span class="ltx_text ltx_font_bold" id="A5.F29.6.1">Sensitivity analysis</span> on <math alttext="\alpha" class="ltx_Math" display="inline" id="A5.F29.3.m1.1"><semantics id="A5.F29.3.m1.1b"><mi id="A5.F29.3.m1.1.1" xref="A5.F29.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.F29.3.m1.1c"><ci id="A5.F29.3.m1.1.1.cmml" xref="A5.F29.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.F29.3.m1.1d">\alpha</annotation><annotation encoding="application/x-llamapun" id="A5.F29.3.m1.1e">italic_α</annotation></semantics></math> parameter used in re-weighting mechanism of RA-DT on Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="A5.F29.4.m2.1"><semantics id="A5.F29.4.m2.1b"><mo id="A5.F29.4.m2.1.1" xref="A5.F29.4.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A5.F29.4.m2.1c"><times id="A5.F29.4.m2.1.1.cmml" xref="A5.F29.4.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A5.F29.4.m2.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A5.F29.4.m2.1e">×</annotation></semantics></math>10.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.3 </span>Retrieval Regularization</h3>
<div class="ltx_para ltx_noindent" id="A5.SS3.p1">
<p class="ltx_p" id="A5.SS3.p1.1">Providing the agent with too similar trajectories, can encourage it to adopt copying behaviour instead of generating high-reward actions.
To mitigate this, we found it useful to regularize the retrieval using three strategies: deduplication, similarity cut-off, and query dropout.
To evaluate their individual impact on ICL performance, we systematically removed each one from RA-DT in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F30" title="Figure 30 ‣ E.3 Retrieval Regularization ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">30</span></a>.</p>
</div>
<div class="ltx_para" id="A5.SS3.p2">
<p class="ltx_p" id="A5.SS3.p2.1">We find that deduplication plays the most significant role in enhancing performance.
One reason, why deduplication is effective, is because RL datasets contain many very similar trajectories.
Removing overlapping trajectories altogether is therefore beneficial for learning.
Notably, deduplication also reduces the index size, thereby speeding-up the search process.
The effect of deduplication may vary depending on dataset characteristics, such as state-action coverage <cite class="ltx_cite ltx_citemacro_citep">[Schweighofer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib84" title="">2022</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="A5.F30">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="26" id="A5.F30.g1" src="extracted/5911726/figures/ablations/regularization/legend.png" width="509"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F30.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A5.F30.sf1.g1" src="extracted/5911726/figures/ablations/regularization/train_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>80 Train Goals</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F30.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A5.F30.sf2.g1" src="extracted/5911726/figures/ablations/regularization/eval_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>20 Eval Goals</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 30: </span>Effect of <span class="ltx_text ltx_font_bold" id="A5.F30.6.1">Retrieval Regularization</span>. Average performances on Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="A5.F30.2.m1.1"><semantics id="A5.F30.2.m1.1b"><mo id="A5.F30.2.m1.1.1" xref="A5.F30.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A5.F30.2.m1.1c"><times id="A5.F30.2.m1.1.1.cmml" xref="A5.F30.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A5.F30.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A5.F30.2.m1.1e">×</annotation></semantics></math>10 over the course of training for <span class="ltx_text ltx_font_bold" id="A5.F30.7.2">(a)</span> train and <span class="ltx_text ltx_font_bold" id="A5.F30.8.3">(b)</span> test tasks.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.4 </span>Query Construction &amp; Sequence Aggregation</h3>
<div class="ltx_para" id="A5.SS4.p1">
<p class="ltx_p" id="A5.SS4.p1.2">In RA-DT, we aggregate the hidden states of an input trajectory using mean aggregation of state tokens over the context length <math alttext="C" class="ltx_Math" display="inline" id="A5.SS4.p1.1.m1.1"><semantics id="A5.SS4.p1.1.m1.1a"><mi id="A5.SS4.p1.1.m1.1.1" xref="A5.SS4.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A5.SS4.p1.1.m1.1b"><ci id="A5.SS4.p1.1.m1.1.1.cmml" xref="A5.SS4.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS4.p1.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="A5.SS4.p1.1.m1.1d">italic_C</annotation></semantics></math> to obtain the <math alttext="d_{r}" class="ltx_Math" display="inline" id="A5.SS4.p1.2.m2.1"><semantics id="A5.SS4.p1.2.m2.1a"><msub id="A5.SS4.p1.2.m2.1.1" xref="A5.SS4.p1.2.m2.1.1.cmml"><mi id="A5.SS4.p1.2.m2.1.1.2" xref="A5.SS4.p1.2.m2.1.1.2.cmml">d</mi><mi id="A5.SS4.p1.2.m2.1.1.3" xref="A5.SS4.p1.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A5.SS4.p1.2.m2.1b"><apply id="A5.SS4.p1.2.m2.1.1.cmml" xref="A5.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A5.SS4.p1.2.m2.1.1.1.cmml" xref="A5.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="A5.SS4.p1.2.m2.1.1.2.cmml" xref="A5.SS4.p1.2.m2.1.1.2">𝑑</ci><ci id="A5.SS4.p1.2.m2.1.1.3.cmml" xref="A5.SS4.p1.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS4.p1.2.m2.1c">d_{r}</annotation><annotation encoding="application/x-llamapun" id="A5.SS4.p1.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>-dimensional query representation.
It is, however, possible to use the hidden states of other tokens to construct the query.
Therefore, we provide empirical evidence for this design choice in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F31" title="Figure 31 ‣ E.4 Query Construction &amp; Sequence Aggregation ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">31</span></a>a.
We compare aggregating states, rewards, actions, returns-to-gos, all tokens, or only using the very last hidden state.
Indeed, we find that aggregating state tokens gives the best results.</p>
</div>
<figure class="ltx_figure" id="A5.F31">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A5.F31.2" style="width:130.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="88" id="A5.F31.1.g1" src="extracted/5911726/figures/ablations/seq_aggregation/legend.png" width="598"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="460" id="A5.F31.2.g2" src="extracted/5911726/figures/ablations/seq_aggregation/darkroom10x10.png" width="598"/>
<p class="ltx_p ltx_align_center" id="A5.F31.2.1">(a)</p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A5.F31.4" style="width:130.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="94" id="A5.F31.3.g1" src="extracted/5911726/figures/ablations/ca_placement/legend.png" width="538"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="460" id="A5.F31.4.g2" src="extracted/5911726/figures/ablations/ca_placement/darkroom10x10.png" width="598"/>
<p class="ltx_p ltx_align_center" id="A5.F31.4.1">(b)</p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A5.F31.6" style="width:130.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="57" id="A5.F31.5.g1" src="extracted/5911726/figures/ablations/evalretsteps/legend.png" width="509"/><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="460" id="A5.F31.6.g2" src="extracted/5911726/figures/ablations/evalretsteps/darkroom10x10.png" width="598"/>
<p class="ltx_p ltx_align_center" id="A5.F31.6.1">(c)</p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 31: </span>Ablations on important components of RA-DT conducted on Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="A5.F31.8.m1.1"><semantics id="A5.F31.8.m1.1b"><mo id="A5.F31.8.m1.1.1" xref="A5.F31.8.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A5.F31.8.m1.1c"><times id="A5.F31.8.m1.1.1.cmml" xref="A5.F31.8.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A5.F31.8.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A5.F31.8.m1.1e">×</annotation></semantics></math>10. In <span class="ltx_text ltx_font_bold" id="A5.F31.15.1">(a)</span> we investigate <span class="ltx_text ltx_font_bold" id="A5.F31.16.2">sequence aggregations</span> to construct the query for retrieval. By default, we average state-tokens in the sequence (”mean, s”). In <span class="ltx_text ltx_font_bold" id="A5.F31.17.3">(b)</span> we vary the <span class="ltx_text ltx_font_bold" id="A5.F31.18.4">placement of cross-attention layers</span> in the DT. In <span class="ltx_text ltx_font_bold" id="A5.F31.19.5">(c)</span> we vary the number of <span class="ltx_text ltx_font_bold" id="A5.F31.20.6">steps in-between retrievals </span>during evaluation. We find that RA-DT delivers robust performance across settings.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.5 </span>Placement of Cross-Attention Layers</h3>
<div class="ltx_para ltx_noindent" id="A5.SS5.p1">
<p class="ltx_p" id="A5.SS5.p1.1">Next, we investigate the effect of the placement of the cross-attention layers in RA-DT.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F31" title="Figure 31 ‣ E.4 Query Construction &amp; Sequence Aggregation ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">31</span></a>b, we therefore vary the placement of cross-attention layers in RA-DT.
By default, we use cross-attention after every self-attention layer.
We find that other choice also provide good results.
While placing the cross-attention at bottom layers tends to be beneficial, placing them only upper level layers tends to hurt performance.</p>
</div>
</section>
<section class="ltx_subsection" id="A5.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.6 </span>Interaction steps between context retrieval</h3>
<div class="ltx_para ltx_noindent" id="A5.SS6.p1">
<p class="ltx_p" id="A5.SS6.p1.5">As mentioned in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A3.SS4" title="C.4 Retrieval-Augmented Decision Transformer ‣ Appendix C Experimental &amp; Implementation Details ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">C.4</span></a>, we perform context retrieval after every <math alttext="t" class="ltx_Math" display="inline" id="A5.SS6.p1.1.m1.1"><semantics id="A5.SS6.p1.1.m1.1a"><mi id="A5.SS6.p1.1.m1.1.1" xref="A5.SS6.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A5.SS6.p1.1.m1.1b"><ci id="A5.SS6.p1.1.m1.1.1.cmml" xref="A5.SS6.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS6.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="A5.SS6.p1.1.m1.1d">italic_t</annotation></semantics></math> environment steps.
Here, <math alttext="t" class="ltx_Math" display="inline" id="A5.SS6.p1.2.m2.1"><semantics id="A5.SS6.p1.2.m2.1a"><mi id="A5.SS6.p1.2.m2.1.1" xref="A5.SS6.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A5.SS6.p1.2.m2.1b"><ci id="A5.SS6.p1.2.m2.1.1.cmml" xref="A5.SS6.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS6.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="A5.SS6.p1.2.m2.1d">italic_t</annotation></semantics></math> represents a trade-off between inference time and final performance.
For grid-worlds, we use <math alttext="t=1" class="ltx_Math" display="inline" id="A5.SS6.p1.3.m3.1"><semantics id="A5.SS6.p1.3.m3.1a"><mrow id="A5.SS6.p1.3.m3.1.1" xref="A5.SS6.p1.3.m3.1.1.cmml"><mi id="A5.SS6.p1.3.m3.1.1.2" xref="A5.SS6.p1.3.m3.1.1.2.cmml">t</mi><mo id="A5.SS6.p1.3.m3.1.1.1" xref="A5.SS6.p1.3.m3.1.1.1.cmml">=</mo><mn id="A5.SS6.p1.3.m3.1.1.3" xref="A5.SS6.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS6.p1.3.m3.1b"><apply id="A5.SS6.p1.3.m3.1.1.cmml" xref="A5.SS6.p1.3.m3.1.1"><eq id="A5.SS6.p1.3.m3.1.1.1.cmml" xref="A5.SS6.p1.3.m3.1.1.1"></eq><ci id="A5.SS6.p1.3.m3.1.1.2.cmml" xref="A5.SS6.p1.3.m3.1.1.2">𝑡</ci><cn id="A5.SS6.p1.3.m3.1.1.3.cmml" type="integer" xref="A5.SS6.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS6.p1.3.m3.1c">t=1</annotation><annotation encoding="application/x-llamapun" id="A5.SS6.p1.3.m3.1d">italic_t = 1</annotation></semantics></math> by default.
To better understand the effect of this design choice, we conduct an ablation in which we vary <math alttext="t" class="ltx_Math" display="inline" id="A5.SS6.p1.4.m4.1"><semantics id="A5.SS6.p1.4.m4.1a"><mi id="A5.SS6.p1.4.m4.1.1" xref="A5.SS6.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A5.SS6.p1.4.m4.1b"><ci id="A5.SS6.p1.4.m4.1.1.cmml" xref="A5.SS6.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS6.p1.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="A5.SS6.p1.4.m4.1d">italic_t</annotation></semantics></math> (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F31" title="Figure 31 ‣ E.4 Query Construction &amp; Sequence Aggregation ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">31</span></a>c).
Indeed, we find that higher values for <math alttext="t" class="ltx_Math" display="inline" id="A5.SS6.p1.5.m5.1"><semantics id="A5.SS6.p1.5.m5.1a"><mi id="A5.SS6.p1.5.m5.1.1" xref="A5.SS6.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A5.SS6.p1.5.m5.1b"><ci id="A5.SS6.p1.5.m5.1.1.cmml" xref="A5.SS6.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS6.p1.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="A5.SS6.p1.5.m5.1d">italic_t</annotation></semantics></math> result in a slight decrease in performance, but faster inference.</p>
</div>
</section>
<section class="ltx_subsection" id="A5.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.7 </span>Pre-trained Language Model</h3>
<div class="ltx_para" id="A5.SS7.p1">
<p class="ltx_p" id="A5.SS7.p1.1">We investigate how strongly the ICL performance of RA-DT is influenced by the pre-trained LM used in our domain-agnostic embedding model.
In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F32" title="Figure 32 ‣ E.7 Pre-trained Language Model ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">32</span></a>, we compare our default choice BERT <cite class="ltx_cite ltx_citemacro_citep">[Devlin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib16" title="">2019</a>]</cite> against four alternative encoder and decoder backbones, namely RoBERTa <cite class="ltx_cite ltx_citemacro_citep">[Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib52" title="">2019</a>]</cite>, DistilRoBERTa, DistilBERT <cite class="ltx_cite ltx_citemacro_citep">[Sanh et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#bib.bib76" title="">2019</a>]</cite> and DistilGPT2.
We find that RA-DT maintains decent performance across all pre-trained LMs, indicating robust retrieval performance across different LMs.
Generally, the non-distilled variants outperform their distilled counterparts.
Moreover, this experiment suggests a clear advantage of encoder-only models over the decoder-only LM, DistilGPT2.
This suggests that the encoder-only LMs are better able to capture the relations between tokens within the token sequence, which leads to more precise retrieval of sub-trajectories and higher down-stream performance.</p>
</div>
<figure class="ltx_figure" id="A5.F32">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="24" id="A5.F32.g1" src="extracted/5911726/figures/ablations/pretrained_lm/legend.png" width="509"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F32.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A5.F32.sf1.g1" src="extracted/5911726/figures/ablations/pretrained_lm/train_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>80 Train Goals</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F32.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="143" id="A5.F32.sf2.g1" src="extracted/5911726/figures/ablations/pretrained_lm/eval_icl.png" width="186"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>20 Eval Goals</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 32: </span>Effect of the <span class="ltx_text ltx_font_bold" id="A5.F32.6.1">Pre-trained LM</span>. Average performances on Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="A5.F32.2.m1.1"><semantics id="A5.F32.2.m1.1b"><mo id="A5.F32.2.m1.1.1" xref="A5.F32.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A5.F32.2.m1.1c"><times id="A5.F32.2.m1.1.1.cmml" xref="A5.F32.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A5.F32.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A5.F32.2.m1.1e">×</annotation></semantics></math>10 over the course of training for <span class="ltx_text ltx_font_bold" id="A5.F32.7.2">(a)</span> train and <span class="ltx_text ltx_font_bold" id="A5.F32.8.3">(b)</span> test tasks.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A5.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.8 </span>Effect of <math alttext="K" class="ltx_Math" display="inline" id="A5.SS8.1.m1.1"><semantics id="A5.SS8.1.m1.1b"><mi id="A5.SS8.1.m1.1.1" xref="A5.SS8.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.SS8.1.m1.1c"><ci id="A5.SS8.1.m1.1.1.cmml" xref="A5.SS8.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS8.1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="A5.SS8.1.m1.1e">italic_K</annotation></semantics></math> on Algorithm Distillation</h3>
<div class="ltx_para ltx_noindent" id="A5.SS8.p1">
<p class="ltx_p" id="A5.SS8.p1.10">Finally, we investigate the effect of <math alttext="K" class="ltx_Math" display="inline" id="A5.SS8.p1.1.m1.1"><semantics id="A5.SS8.p1.1.m1.1a"><mi id="A5.SS8.p1.1.m1.1.1" xref="A5.SS8.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.SS8.p1.1.m1.1b"><ci id="A5.SS8.p1.1.m1.1.1.cmml" xref="A5.SS8.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS8.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A5.SS8.p1.1.m1.1d">italic_K</annotation></semantics></math> on the performance of AD.
<math alttext="K" class="ltx_Math" display="inline" id="A5.SS8.p1.2.m2.1"><semantics id="A5.SS8.p1.2.m2.1a"><mi id="A5.SS8.p1.2.m2.1.1" xref="A5.SS8.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.SS8.p1.2.m2.1b"><ci id="A5.SS8.p1.2.m2.1.1.cmml" xref="A5.SS8.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS8.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="A5.SS8.p1.2.m2.1d">italic_K</annotation></semantics></math> determines the number of episodes that have passed between the current and the context trajectory, which are provided to AD as the context.
Consequently, <math alttext="K" class="ltx_Math" display="inline" id="A5.SS8.p1.3.m3.1"><semantics id="A5.SS8.p1.3.m3.1a"><mi id="A5.SS8.p1.3.m3.1.1" xref="A5.SS8.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.SS8.p1.3.m3.1b"><ci id="A5.SS8.p1.3.m3.1.1.cmml" xref="A5.SS8.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS8.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="A5.SS8.p1.3.m3.1d">italic_K</annotation></semantics></math> specifies the extent of improvement observed between subsequent episodes.
By default, we use <math alttext="K=100" class="ltx_Math" display="inline" id="A5.SS8.p1.4.m4.1"><semantics id="A5.SS8.p1.4.m4.1a"><mrow id="A5.SS8.p1.4.m4.1.1" xref="A5.SS8.p1.4.m4.1.1.cmml"><mi id="A5.SS8.p1.4.m4.1.1.2" xref="A5.SS8.p1.4.m4.1.1.2.cmml">K</mi><mo id="A5.SS8.p1.4.m4.1.1.1" xref="A5.SS8.p1.4.m4.1.1.1.cmml">=</mo><mn id="A5.SS8.p1.4.m4.1.1.3" xref="A5.SS8.p1.4.m4.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS8.p1.4.m4.1b"><apply id="A5.SS8.p1.4.m4.1.1.cmml" xref="A5.SS8.p1.4.m4.1.1"><eq id="A5.SS8.p1.4.m4.1.1.1.cmml" xref="A5.SS8.p1.4.m4.1.1.1"></eq><ci id="A5.SS8.p1.4.m4.1.1.2.cmml" xref="A5.SS8.p1.4.m4.1.1.2">𝐾</ci><cn id="A5.SS8.p1.4.m4.1.1.3.cmml" type="integer" xref="A5.SS8.p1.4.m4.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS8.p1.4.m4.1c">K=100</annotation><annotation encoding="application/x-llamapun" id="A5.SS8.p1.4.m4.1d">italic_K = 100</annotation></semantics></math> for our experiments on Dark-Room <math alttext="10\times 10" class="ltx_Math" display="inline" id="A5.SS8.p1.5.m5.1"><semantics id="A5.SS8.p1.5.m5.1a"><mrow id="A5.SS8.p1.5.m5.1.1" xref="A5.SS8.p1.5.m5.1.1.cmml"><mn id="A5.SS8.p1.5.m5.1.1.2" xref="A5.SS8.p1.5.m5.1.1.2.cmml">10</mn><mo id="A5.SS8.p1.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="A5.SS8.p1.5.m5.1.1.1.cmml">×</mo><mn id="A5.SS8.p1.5.m5.1.1.3" xref="A5.SS8.p1.5.m5.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS8.p1.5.m5.1b"><apply id="A5.SS8.p1.5.m5.1.1.cmml" xref="A5.SS8.p1.5.m5.1.1"><times id="A5.SS8.p1.5.m5.1.1.1.cmml" xref="A5.SS8.p1.5.m5.1.1.1"></times><cn id="A5.SS8.p1.5.m5.1.1.2.cmml" type="integer" xref="A5.SS8.p1.5.m5.1.1.2">10</cn><cn id="A5.SS8.p1.5.m5.1.1.3.cmml" type="integer" xref="A5.SS8.p1.5.m5.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS8.p1.5.m5.1c">10\times 10</annotation><annotation encoding="application/x-llamapun" id="A5.SS8.p1.5.m5.1d">10 × 10</annotation></semantics></math>.
Therefore, we conduct an ablation study, in which we very <math alttext="K" class="ltx_Math" display="inline" id="A5.SS8.p1.6.m6.1"><semantics id="A5.SS8.p1.6.m6.1a"><mi id="A5.SS8.p1.6.m6.1.1" xref="A5.SS8.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.SS8.p1.6.m6.1b"><ci id="A5.SS8.p1.6.m6.1.1.cmml" xref="A5.SS8.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS8.p1.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="A5.SS8.p1.6.m6.1d">italic_K</annotation></semantics></math> (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07071v1#A5.F33" title="Figure 33 ‣ E.8 Effect of 𝐾 on Algorithm Distillation ‣ Appendix E Ablation Studies ‣ Retrieval-Augmented Decision Transformer: External Memory for In-context RL"><span class="ltx_text ltx_ref_tag">33</span></a>.
We find that too small values for <math alttext="K" class="ltx_Math" display="inline" id="A5.SS8.p1.7.m7.1"><semantics id="A5.SS8.p1.7.m7.1a"><mi id="A5.SS8.p1.7.m7.1.1" xref="A5.SS8.p1.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.SS8.p1.7.m7.1b"><ci id="A5.SS8.p1.7.m7.1.1.cmml" xref="A5.SS8.p1.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS8.p1.7.m7.1c">K</annotation><annotation encoding="application/x-llamapun" id="A5.SS8.p1.7.m7.1d">italic_K</annotation></semantics></math> (e.g., 1 and 10) result in slow ICL behavior.
In contrast, too high values for <math alttext="K" class="ltx_Math" display="inline" id="A5.SS8.p1.8.m8.1"><semantics id="A5.SS8.p1.8.m8.1a"><mi id="A5.SS8.p1.8.m8.1.1" xref="A5.SS8.p1.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.SS8.p1.8.m8.1b"><ci id="A5.SS8.p1.8.m8.1.1.cmml" xref="A5.SS8.p1.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS8.p1.8.m8.1c">K</annotation><annotation encoding="application/x-llamapun" id="A5.SS8.p1.8.m8.1d">italic_K</annotation></semantics></math> (e.g., 500) lead to fast initial progress but suboptimal performance in the long term.
Only <math alttext="K=100" class="ltx_Math" display="inline" id="A5.SS8.p1.9.m9.1"><semantics id="A5.SS8.p1.9.m9.1a"><mrow id="A5.SS8.p1.9.m9.1.1" xref="A5.SS8.p1.9.m9.1.1.cmml"><mi id="A5.SS8.p1.9.m9.1.1.2" xref="A5.SS8.p1.9.m9.1.1.2.cmml">K</mi><mo id="A5.SS8.p1.9.m9.1.1.1" xref="A5.SS8.p1.9.m9.1.1.1.cmml">=</mo><mn id="A5.SS8.p1.9.m9.1.1.3" xref="A5.SS8.p1.9.m9.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS8.p1.9.m9.1b"><apply id="A5.SS8.p1.9.m9.1.1.cmml" xref="A5.SS8.p1.9.m9.1.1"><eq id="A5.SS8.p1.9.m9.1.1.1.cmml" xref="A5.SS8.p1.9.m9.1.1.1"></eq><ci id="A5.SS8.p1.9.m9.1.1.2.cmml" xref="A5.SS8.p1.9.m9.1.1.2">𝐾</ci><cn id="A5.SS8.p1.9.m9.1.1.3.cmml" type="integer" xref="A5.SS8.p1.9.m9.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS8.p1.9.m9.1c">K=100</annotation><annotation encoding="application/x-llamapun" id="A5.SS8.p1.9.m9.1d">italic_K = 100</annotation></semantics></math> leads to steady improvement across all interaction episodes.
Consequently, AD requires careful tuning of <math alttext="K" class="ltx_Math" display="inline" id="A5.SS8.p1.10.m10.1"><semantics id="A5.SS8.p1.10.m10.1a"><mi id="A5.SS8.p1.10.m10.1.1" xref="A5.SS8.p1.10.m10.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.SS8.p1.10.m10.1b"><ci id="A5.SS8.p1.10.m10.1.1.cmml" xref="A5.SS8.p1.10.m10.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS8.p1.10.m10.1c">K</annotation><annotation encoding="application/x-llamapun" id="A5.SS8.p1.10.m10.1d">italic_K</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="A5.F33">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="21" id="A5.F33.g1" src="extracted/5911726/figures/ablations/ad_k/legend.png" width="329"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="131" id="A5.F33.g2" src="extracted/5911726/figures/ablations/ad_k/darkroom10x10.png" width="170"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 33: </span>Ablation on the number of episodes <math alttext="K" class="ltx_Math" display="inline" id="A5.F33.7.m1.1"><semantics id="A5.F33.7.m1.1b"><mi id="A5.F33.7.m1.1.1" xref="A5.F33.7.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.F33.7.m1.1c"><ci id="A5.F33.7.m1.1.1.cmml" xref="A5.F33.7.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.F33.7.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="A5.F33.7.m1.1e">italic_K</annotation></semantics></math> in AD that have passed between “current” trajectory and “context” trajectory on Dark-Room 10<math alttext="\times" class="ltx_Math" display="inline" id="A5.F33.8.m2.1"><semantics id="A5.F33.8.m2.1b"><mo id="A5.F33.8.m2.1.1" xref="A5.F33.8.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A5.F33.8.m2.1c"><times id="A5.F33.8.m2.1.1.cmml" xref="A5.F33.8.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A5.F33.8.m2.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A5.F33.8.m2.1e">×</annotation></semantics></math>10. <math alttext="K" class="ltx_Math" display="inline" id="A5.F33.9.m3.1"><semantics id="A5.F33.9.m3.1b"><mi id="A5.F33.9.m3.1.1" xref="A5.F33.9.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.F33.9.m3.1c"><ci id="A5.F33.9.m3.1.1.cmml" xref="A5.F33.9.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.F33.9.m3.1d">K</annotation><annotation encoding="application/x-llamapun" id="A5.F33.9.m3.1e">italic_K</annotation></semantics></math> determines how much improvement is observed between episodes. We find that performance increases as <math alttext="K" class="ltx_Math" display="inline" id="A5.F33.10.m4.1"><semantics id="A5.F33.10.m4.1b"><mi id="A5.F33.10.m4.1.1" xref="A5.F33.10.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.F33.10.m4.1c"><ci id="A5.F33.10.m4.1.1.cmml" xref="A5.F33.10.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.F33.10.m4.1d">K</annotation><annotation encoding="application/x-llamapun" id="A5.F33.10.m4.1e">italic_K</annotation></semantics></math> increases, but only up to a certain point (<math alttext="K=100" class="ltx_Math" display="inline" id="A5.F33.11.m5.1"><semantics id="A5.F33.11.m5.1b"><mrow id="A5.F33.11.m5.1.1" xref="A5.F33.11.m5.1.1.cmml"><mi id="A5.F33.11.m5.1.1.2" xref="A5.F33.11.m5.1.1.2.cmml">K</mi><mo id="A5.F33.11.m5.1.1.1" xref="A5.F33.11.m5.1.1.1.cmml">=</mo><mn id="A5.F33.11.m5.1.1.3" xref="A5.F33.11.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.F33.11.m5.1c"><apply id="A5.F33.11.m5.1.1.cmml" xref="A5.F33.11.m5.1.1"><eq id="A5.F33.11.m5.1.1.1.cmml" xref="A5.F33.11.m5.1.1.1"></eq><ci id="A5.F33.11.m5.1.1.2.cmml" xref="A5.F33.11.m5.1.1.2">𝐾</ci><cn id="A5.F33.11.m5.1.1.3.cmml" type="integer" xref="A5.F33.11.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.F33.11.m5.1d">K=100</annotation><annotation encoding="application/x-llamapun" id="A5.F33.11.m5.1e">italic_K = 100</annotation></semantics></math>). With <math alttext="K=500" class="ltx_Math" display="inline" id="A5.F33.12.m6.1"><semantics id="A5.F33.12.m6.1b"><mrow id="A5.F33.12.m6.1.1" xref="A5.F33.12.m6.1.1.cmml"><mi id="A5.F33.12.m6.1.1.2" xref="A5.F33.12.m6.1.1.2.cmml">K</mi><mo id="A5.F33.12.m6.1.1.1" xref="A5.F33.12.m6.1.1.1.cmml">=</mo><mn id="A5.F33.12.m6.1.1.3" xref="A5.F33.12.m6.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.F33.12.m6.1c"><apply id="A5.F33.12.m6.1.1.cmml" xref="A5.F33.12.m6.1.1"><eq id="A5.F33.12.m6.1.1.1.cmml" xref="A5.F33.12.m6.1.1.1"></eq><ci id="A5.F33.12.m6.1.1.2.cmml" xref="A5.F33.12.m6.1.1.2">𝐾</ci><cn id="A5.F33.12.m6.1.1.3.cmml" type="integer" xref="A5.F33.12.m6.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.F33.12.m6.1d">K=500</annotation><annotation encoding="application/x-llamapun" id="A5.F33.12.m6.1e">italic_K = 500</annotation></semantics></math>, AD improves rapidly in the first few episodes, but then flattens out.</figcaption>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Oct  8 21:55:47 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
