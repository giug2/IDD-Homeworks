<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2201.12675] Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models</title><meta property="og:description" content="Privacy is a central tenet of Federated learning (FL), in which a central server trains models without centralizing user data. However, gradient updates used in FL can leak user information. While the most industrial u…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2201.12675">

<!--Generated on Mon Feb 26 18:50:33 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Decepticons:​ Corrupted ​ Transformers Breach 
<br class="ltx_break">Privacy in Federated Learning for Language Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Liam Fowl<math id="id1.1.m1.1" class="ltx_Math" alttext="\ \ ,\ \ " display="inline"><semantics id="id1.1.m1.1a"><mrow id="id1.1.m1.1.1.1"><mi id="id1.1.m1.1.1.1.1" xref="id1.1.m1.1.1.1.1.cmml"></mi><mo lspace="1.000em" id="id1.1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><csymbol cd="latexml" id="id1.1.m1.1.1.1.1.cmml" xref="id1.1.m1.1.1.1.1">absent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\ \ ,\ \ </annotation></semantics></math> Jonas Geiping<sup id="id3.3.id1" class="ltx_sup">∗</sup> 
<br class="ltx_break">University of Maryland 
<br class="ltx_break"><span id="id4.4.id2" class="ltx_text ltx_font_typewriter">{lfowl, jgeiping}@umd.edu</span> 
<br class="ltx_break">&amp;Steven Reich 
<br class="ltx_break">University of Maryland 
<br class="ltx_break">&amp;Yuxin Wen 
<br class="ltx_break">University of Maryland
<span id="id5.5.id3" class="ltx_ERROR undefined">\AND</span>Wojtek Czaja 
<br class="ltx_break">University of Maryland
&amp;Micah Goldblum 
<br class="ltx_break">New York University
&amp;Tom Goldstein 
<br class="ltx_break">University of Maryland 
<br class="ltx_break"><span id="id6.6.id4" class="ltx_text ltx_font_typewriter">tomg@umd.edu</span>
</span><span class="ltx_author_notes">Authors contributed equally. Order chosen randomly.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id7.id1" class="ltx_p">Privacy is a central tenet of Federated learning (FL), in which a central server trains models without centralizing user data. However, gradient updates used in FL can leak user information. While the most industrial uses of FL are for text applications (e.g. keystroke prediction), the majority of attacks on user privacy in FL have focused on simple image classifiers and threat models that assume honest execution of the FL protocol from the server.
We propose a novel attack that reveals private user text by deploying malicious parameter vectors, and which succeeds even with mini-batches, multiple users, and long sequences. Unlike previous attacks on FL, the attack exploits characteristics of both the Transformer architecture and the token embedding, separately extracting tokens and positional embeddings to retrieve high-fidelity text. We argue that the threat model of malicious server states is highly relevant from a user-centric perspective, and show that in this scenario, text applications using transformer models are much more vulnerable than previously thought.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) has recently emerged as a central paradigm for decentralized training.
Where previously, training data had to be collected and accumulated on a central server, the data can now be kept locally and only model updates, such as parameter gradients, are shared and aggregated by a central party. The central tenet of federated learning is that these protocols enable privacy for users
<cite class="ltx_cite ltx_citemacro_citep">(McMahan &amp; Ramage, <a href="#bib.bib36" title="" class="ltx_ref">2017</a>; Google Research, <a href="#bib.bib21" title="" class="ltx_ref">2019</a>)</cite>. This is appealing to industrial interests, as user data can be leveraged to train machine learning models without user concerns for privacy, app permissions or privacy regulations, such as GDPR <cite class="ltx_cite ltx_citemacro_citep">(Veale et al., <a href="#bib.bib53" title="" class="ltx_ref">2018</a>; Truong et al., <a href="#bib.bib51" title="" class="ltx_ref">2021</a>)</cite>. However, in reality, these federated learning protocols walk a tightrope between actual privacy and the appearance of privacy. Attacks that invert model updates sent by users can recover private information in several scenarios <cite class="ltx_cite ltx_citemacro_cite">Phong et al. (<a href="#bib.bib46" title="" class="ltx_ref">2017</a>); Wang et al. (<a href="#bib.bib56" title="" class="ltx_ref">2018</a>)</cite> if no measures are taken to safe-guard user privacy. Optimization-based inversion attacks have demonstrated the vulnerability of image data when only a few datapoints are used to calculate updates <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib60" title="" class="ltx_ref">2019</a>; Geiping et al., <a href="#bib.bib20" title="" class="ltx_ref">2020</a>; Yin et al., <a href="#bib.bib58" title="" class="ltx_ref">2021</a>)</cite>. To stymie these attacks, user data can be aggregated securely before being sent to the server as in <cite class="ltx_cite ltx_citemacro_citet">Bonawitz et al. (<a href="#bib.bib4" title="" class="ltx_ref">2017</a>)</cite>, but this incurs additional communication overhead, and as such requires an estimation of the threat posed by inversion attacks against specific levels of aggregation, model architecture, and setting.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Most of the work on gradient inversion attacks so far has focused on image classification problems. Conversely, the most successful industrial applications of federated learning have been in language tasks. There, federated learning is not just a promising idea, it has been deployed to consumers in production, for example to improve keystroke prediction <cite class="ltx_cite ltx_citemacro_citep">(Hard et al., <a href="#bib.bib23" title="" class="ltx_ref">2019</a>; Ramaswamy et al., <a href="#bib.bib48" title="" class="ltx_ref">2019</a>)</cite> and settings search on the Google Pixel <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al., <a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite>. However, attacks in this area have so far succeeded only on limited examples of sequences with <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">few</span> (<math id="S1.p2.1.m1.1" class="ltx_Math" alttext="&lt;25" display="inline"><semantics id="S1.p2.1.m1.1a"><mrow id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml"><mi id="S1.p2.1.m1.1.1.2" xref="S1.p2.1.m1.1.1.2.cmml"></mi><mo id="S1.p2.1.m1.1.1.1" xref="S1.p2.1.m1.1.1.1.cmml">&lt;</mo><mn id="S1.p2.1.m1.1.1.3" xref="S1.p2.1.m1.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><apply id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"><lt id="S1.p2.1.m1.1.1.1.cmml" xref="S1.p2.1.m1.1.1.1"></lt><csymbol cd="latexml" id="S1.p2.1.m1.1.1.2.cmml" xref="S1.p2.1.m1.1.1.2">absent</csymbol><cn type="integer" id="S1.p2.1.m1.1.1.3.cmml" xref="S1.p2.1.m1.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">&lt;25</annotation></semantics></math>) tokens <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a href="#bib.bib12" title="" class="ltx_ref">2021</a>; Zhu et al., <a href="#bib.bib60" title="" class="ltx_ref">2019</a>; Dimitrov et al., <a href="#bib.bib16" title="" class="ltx_ref">2022</a>)</cite>, even for massive models such as BERT (with worse recovery for smaller models). This leaves the impression that these models are already hard to invert, and limited aggregation is already sufficient to protect user privacy, without the necessity to employ stronger defenses such as local or distributed differential privacy <cite class="ltx_cite ltx_citemacro_citep">(Dwork &amp; Roth, <a href="#bib.bib17" title="" class="ltx_ref">2013</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">In this work, we revisit the privacy of transformer models. We focus on the realistic threat model where the server-side behavior is untrusted by the user, and show that a malicious update sent by the server can completely corrupt the behavior of user-side models, coercing them to spill significant amounts of user data. The server can then collect the original words and sentences entered by the user with straightforward statistical evaluations and assignment problems.
We show for the first time that recovery of all tokens and most of their absolute positions is feasible even on the order of <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">several thousand</span> tokens and even when applied to small models only 10% the size of BERT discussed for FL use in <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a href="#bib.bib55" title="" class="ltx_ref">2021</a>)</cite>. Furthermore, instead of previous work which only discuss attacks for updates aggregated over few users, this attack breaks privacy even when updates are aggregated over more than 100 users. We hope that these observations can contribute to re-evaluation of privacy risks in FL applications for language.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2201.12675/assets/assets/text_examples2.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="384" height="250" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An example reconstruction from a small GPT-2 model using a <span id="S1.F1.6.1" class="ltx_text ltx_font_italic">Decepticon</span> attack, showing the first <math id="S1.F1.2.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S1.F1.2.m1.1b"><mn id="S1.F1.2.m1.1.1" xref="S1.F1.2.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S1.F1.2.m1.1c"><cn type="integer" id="S1.F1.2.m1.1.1.cmml" xref="S1.F1.2.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.m1.1d">20</annotation></semantics></math> tokens reconstructed from a randomly selected user for different combinations of sequence length and batch size on a <span id="S1.F1.7.2" class="ltx_text ltx_font_italic">challenging</span> text fragment. Highlighted text represents <em id="S1.F1.8.3" class="ltx_emph ltx_font_italic">exact</em> matches for position and token.</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Motivation and Threat Model</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">At first glance, gradients from Transformer architectures might not appear to leak significant amounts of user data. Both the attention mechanisms and the linear components learn operations that act individually on tokens, so that their gradients are naturally averaged over the entire length of the sequence (e.g. 512 tokens). Despite most architectures featuring large linear layers, the mixing of information reduces the utility of their content to an attacker. In fact, the only operation that “sees" the entire sequence, the scaled dot product attention, is non-learned and does not leak separate gradients for each entry in the sequence. If one were to draw intuition from vision-based attacks, gradients whose components are averaged over 512 images are impossible to invert even for state-of-the-art attacks <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a href="#bib.bib58" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p">On the other hand, recovering text appears much more constrained than recovering images. The attacker knows from the beginning that only tokens that exist in the vocabulary are possible solutions and it is only necessary to find their location from a limited list of known positions and identify such tokens to reconstruct the input sequence perfectly.</p>
</div>
<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Previous Attacks</h5>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">Previous gradient inversion attacks in FL have been described for text in <cite class="ltx_cite ltx_citemacro_citet">Deng et al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>); Zhu et al. (<a href="#bib.bib60" title="" class="ltx_ref">2019</a>); Dimitrov et al. (<a href="#bib.bib16" title="" class="ltx_ref">2022</a>)</cite> and have focused on optimization-based reconstruction in the <span id="S2.SS0.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_italic">honest-but-curious</span> server model. Recently, <cite class="ltx_cite ltx_citemacro_citet">Gupta et al. (<a href="#bib.bib22" title="" class="ltx_ref">2022</a>)</cite> use a language model prior to improve attack success via beam-search that is guided by the user gradient. Our work is further related to investigations about the unintended memorization abilities of fully trained, but benign, models as described in <cite class="ltx_cite ltx_citemacro_citet">Carlini et al. (<a href="#bib.bib9" title="" class="ltx_ref">2021</a>); Inan et al. (<a href="#bib.bib26" title="" class="ltx_ref">2021</a>); Brown et al. (<a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite>, which can extract up to <math id="S2.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mn id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">1</mn><mo id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="latexml" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">1\%</annotation></semantics></math> of training data in some cases <cite class="ltx_cite ltx_citemacro_citep">(Carlini et al., <a href="#bib.bib10" title="" class="ltx_ref">2022</a>)</cite>. In contrast, we investigate attacks which <span id="S2.SS0.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_italic">directly</span> attempt to retrieve a large fraction of the training data utilized in a single model update. This is the worst-case for a privacy leak from successive benign model snapshots discussed in <cite class="ltx_cite ltx_citemacro_citet">Zanella-Béguelin et al. (<a href="#bib.bib59" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Threat Model</h5>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">We consider the threat model of an untrusted server that is interested in recovering private user data from user updates in FL. Both user and server are bound by secure implementations to follow a known federated learning protocol, and the model architecture is compiled into a fixed state and verified by the same implementation to be a standard Transformer architecture. The user downloads a single malicious server state and returns their model updates according to protocol. The server then recovers user data from this update.</p>
</div>
<div id="S2.SS0.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p2.1" class="ltx_p">This threat model is the most natural setting from a user-centric perspective. Stronger threat models would, for example, allow the server to execute arbitrary code on user devices, but such threats are solvable by software solutions such as secure sandboxing <cite class="ltx_cite ltx_citemacro_citep">(Frey, <a href="#bib.bib19" title="" class="ltx_ref">2021</a>)</cite>. Still other work investigates malicious model architectures <cite class="ltx_cite ltx_citemacro_citep">(Fowl et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>; Boenisch et al., <a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite>, but such malicious modifications have to be present at the conception of the machine learning application, before the architecture is fixed and compiled for production <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al., <a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite>, making those attacks most feasible for actors in the “analyst" role <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib30" title="" class="ltx_ref">2021b</a>)</cite>. Ideally, user and server communicate through a verified protocol implementation that only allows pre-defined and vetted model architectures.</p>
</div>
<div id="S2.SS0.SSS0.Px2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS0.SSS0.Px2.p3.1" class="ltx_p">However, none of these precautions stop an <span id="S2.SS0.SSS0.Px2.p3.1.1" class="ltx_text ltx_font_italic">adversarial server</span> from sending malicious updates <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib55" title="" class="ltx_ref">2021</a>)</cite>. Such attacks are naturally ephemeral - the server can send benign server states nearly all of the time to all users, then switch to a malicious update for single round and group of users (or single secure aggregator), collect user information, and return to benign updates immediately after. The malicious update is quickly overwritten and not detectable after the fact. Such an attack can be launched by any actor with temporary access to the server states sent to users, including, aside from the server owner, temporary breaches of server infrastructure, MITM attacks or single disgruntled employees. Overall we argue that server states sent to users, especially for very expressive models such as transformers, should be treated by user applications as analogue to <span id="S2.SS0.SSS0.Px2.p3.1.2" class="ltx_text ltx_font_italic">untrusted code</span> that operates on user data and should be handled with the appropriate care.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Malicious Parameters for Data Extraction</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">Our attack leverages several interacting strategies that we present in the sub-sections below.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p">For simplicity, we assume in this section that the FL protocol is fedSGD, i.e. model update returned by the users is the average gradient of the model parameters sent by the server computed over all local user data. If the server is malicious, then this protocol can either be selected directly or another protocol such as federated averaging (fedAVG), which includes multiple local update steps <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib37" title="" class="ltx_ref">2017</a>)</cite>, could be modified maliciously to run with either only a single local step or a large enough batch size. Both variants effectively convert the protocol to fedSGD. The local user data is tokenized text fed into the transformer model, although the attack we describe does not make use of text priors and can read out an arbitrary stream of tokens.</p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.1" class="ltx_p">We separate the exposition into two parts. First, we discuss how the server constructs a malicious parameter vector for the target architecture that is sent to users. Second, we then discuss how the server can reconstruct private information from this update.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2201.12675/assets/assets/pos_diagram.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="264" height="148" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Recovering each token and its positions from the inputs to the first transformer layer. We find the correlation matrix between recovered input embeddings to known positions and tokens, and solve a sum assignment problem to determine which position is most likely for each input.
</figcaption>
</figure>
<div id="S3.p4" class="ltx_para ltx_noindent">
<p id="S3.p4.1" class="ltx_p">We first discuss parameter modifications for a single sequence of tokens, and then move to modifications that allow recovery of multiple sequences. For the following segment, we assume that the targeted model is based on a standard transformer architecture, containing first an embedding component that, for each token, adds token embedding and positional embedding, and second, a series of transformer layers, each containing an attention block and a feed-forward block.</p>
</div>
<section id="S3.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Modifications to Recover Token Ids and Positions:</h5>

<div id="S3.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px1.p1.1" class="ltx_p">In principle, the goal of the attacker is simple: If the attacker can reconstruct the inputs to the first transformer layer, which are token embeddings plus positional embeddings, then a simple matching problem can identify the token id and position id by correlating each input to the known token and position embedding matrices, see <a href="#S3.F2" title="In 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a>.
However, what the user returns is not a token but a gradient, representing changes to the model relative to the user’s data. This gradient is also an average over all tokens in the sequence. As a first step to improve attack success, the attacker can <span id="S3.SS0.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_italic">disable all attention layers</span> (setting their output transformation to 0) and mostly <span id="S3.SS0.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_italic">disable outputs of each feed-forward block</span>. The outputs of each feed-forward layer cannot be entirely disabled (otherwise all gradients would be zero), so we set all outputs except the last entry to zero. A transformer modified in this way does not mix token information and the inputs to each layer are the same (except for the last entry in the hidden dimension) and equal to token embeddings plus positional embeddings.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Unmixing Gradient Signals:</h5>

<div id="S3.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px2.p1.4" class="ltx_p">Let’s investigate the resulting gradient of the first linear layer in each feed-forward block. We define the input embeddings that the attacker intends to recover as <math id="S3.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\{u_{k}\}_{k=1}^{S}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.1.m1.1a"><msubsup id="S3.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.2.cmml">k</mi><mo id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.3" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml">S</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><set id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1"><apply id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2">𝑢</ci><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3"><eq id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.1"></eq><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.1.m1.1c">\{u_{k}\}_{k=1}^{S}</annotation></semantics></math> coming from a sequence of text containing <math id="S3.SS0.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.2.m2.1c">S</annotation></semantics></math> elements. The operation of the first linear layer in each (<math id="S3.SS0.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.3.m3.1a"><msup id="S3.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml">i</mi><mrow id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2">𝑖</ci><apply id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3"><times id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.1"></times><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.3.m3.1c">i^{th}</annotation></semantics></math>) feed-forward block is <math id="S3.SS0.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="y_{k}=W_{i}u_{k}+b_{i}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.4.m4.1a"><mrow id="S3.SS0.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.cmml"><msub id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.2" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.3" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml"><mrow id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.cmml"><msub id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2.cmml"><mi id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2.2" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2.3" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.1" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.1.cmml">​</mo><msub id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3.2" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3.3" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3.3.cmml">k</mi></msub></mrow><mo id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.1" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.1.cmml">+</mo><msub id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3.cmml"><mi id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3.2" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3.2.cmml">b</mi><mi id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3.3" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1"><eq id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1"></eq><apply id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.3">𝑘</ci></apply><apply id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3"><plus id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.1"></plus><apply id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2"><times id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.1"></times><apply id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2.2">𝑊</ci><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3.2">𝑢</ci><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.2.3.3">𝑘</ci></apply></apply><apply id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3.2">𝑏</ci><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.4.m4.1c">y_{k}=W_{i}u_{k}+b_{i}</annotation></semantics></math>. The gradient averaged over all tokens in this sequence is:</p>
</div>
<div id="S3.SS0.SSS0.Px2.p2" class="ltx_para ltx_minipage ltx_align_middle" style="width:186.8pt;">
<table id="A8.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\displaystyle\sum_{k=1}^{S}\nabla_{W_{i}^{(j)}}\mathcal{L}_{k}" display="inline"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.2" xref="S3.E1.m1.1.2.cmml"><mstyle displaystyle="true" id="S3.E1.m1.1.2.1" xref="S3.E1.m1.1.2.1.cmml"><munderover id="S3.E1.m1.1.2.1a" xref="S3.E1.m1.1.2.1.cmml"><mo movablelimits="false" id="S3.E1.m1.1.2.1.2.2" xref="S3.E1.m1.1.2.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.2.1.2.3" xref="S3.E1.m1.1.2.1.2.3.cmml"><mi id="S3.E1.m1.1.2.1.2.3.2" xref="S3.E1.m1.1.2.1.2.3.2.cmml">k</mi><mo id="S3.E1.m1.1.2.1.2.3.1" xref="S3.E1.m1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.2.1.2.3.3" xref="S3.E1.m1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.2.1.3" xref="S3.E1.m1.1.2.1.3.cmml">S</mi></munderover></mstyle><mrow id="S3.E1.m1.1.2.2" xref="S3.E1.m1.1.2.2.cmml"><msub id="S3.E1.m1.1.2.2.1" xref="S3.E1.m1.1.2.2.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="S3.E1.m1.1.2.2.1.2" xref="S3.E1.m1.1.2.2.1.2.cmml">∇</mo><msubsup id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.3.2.cmml">W</mi><mi id="S3.E1.m1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.3.3.cmml">i</mi><mrow id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msub id="S3.E1.m1.1.2.2.2" xref="S3.E1.m1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.2.2.2.2" xref="S3.E1.m1.1.2.2.2.2.cmml">ℒ</mi><mi id="S3.E1.m1.1.2.2.2.3" xref="S3.E1.m1.1.2.2.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.2.cmml" xref="S3.E1.m1.1.2"><apply id="S3.E1.m1.1.2.1.cmml" xref="S3.E1.m1.1.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.1.1.cmml" xref="S3.E1.m1.1.2.1">superscript</csymbol><apply id="S3.E1.m1.1.2.1.2.cmml" xref="S3.E1.m1.1.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.1.2.1.cmml" xref="S3.E1.m1.1.2.1">subscript</csymbol><sum id="S3.E1.m1.1.2.1.2.2.cmml" xref="S3.E1.m1.1.2.1.2.2"></sum><apply id="S3.E1.m1.1.2.1.2.3.cmml" xref="S3.E1.m1.1.2.1.2.3"><eq id="S3.E1.m1.1.2.1.2.3.1.cmml" xref="S3.E1.m1.1.2.1.2.3.1"></eq><ci id="S3.E1.m1.1.2.1.2.3.2.cmml" xref="S3.E1.m1.1.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E1.m1.1.2.1.2.3.3.cmml" xref="S3.E1.m1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.2.1.3.cmml" xref="S3.E1.m1.1.2.1.3">𝑆</ci></apply><apply id="S3.E1.m1.1.2.2.cmml" xref="S3.E1.m1.1.2.2"><apply id="S3.E1.m1.1.2.2.1.cmml" xref="S3.E1.m1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.2.1.1.cmml" xref="S3.E1.m1.1.2.2.1">subscript</csymbol><ci id="S3.E1.m1.1.2.2.1.2.cmml" xref="S3.E1.m1.1.2.2.1.2">∇</ci><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.3.2">𝑊</ci><ci id="S3.E1.m1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.3.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">𝑗</ci></apply></apply><apply id="S3.E1.m1.1.2.2.2.cmml" xref="S3.E1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.2.2.2.1.cmml" xref="S3.E1.m1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.2.2.2.2">ℒ</ci><ci id="S3.E1.m1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.2.2.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle\sum_{k=1}^{S}\nabla_{W_{i}^{(j)}}\mathcal{L}_{k}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E1.m2.4" class="ltx_Math" alttext="\displaystyle=\sum_{k=1}^{S}\bigg{(}\frac{\partial\mathcal{L}_{k}}{\partial y_{k}^{(j)}}\cdot\nabla_{W_{i}^{(j)}}y_{k}^{(j)}\bigg{)},\qquad" display="inline"><semantics id="S3.E1.m2.4a"><mrow id="S3.E1.m2.4.4.1" xref="S3.E1.m2.4.4.1.1.cmml"><mrow id="S3.E1.m2.4.4.1.1" xref="S3.E1.m2.4.4.1.1.cmml"><mi id="S3.E1.m2.4.4.1.1.3" xref="S3.E1.m2.4.4.1.1.3.cmml"></mi><mo id="S3.E1.m2.4.4.1.1.2" xref="S3.E1.m2.4.4.1.1.2.cmml">=</mo><mrow id="S3.E1.m2.4.4.1.1.1" xref="S3.E1.m2.4.4.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m2.4.4.1.1.1.2" xref="S3.E1.m2.4.4.1.1.1.2.cmml"><munderover id="S3.E1.m2.4.4.1.1.1.2a" xref="S3.E1.m2.4.4.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m2.4.4.1.1.1.2.2.2" xref="S3.E1.m2.4.4.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m2.4.4.1.1.1.2.2.3" xref="S3.E1.m2.4.4.1.1.1.2.2.3.cmml"><mi id="S3.E1.m2.4.4.1.1.1.2.2.3.2" xref="S3.E1.m2.4.4.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E1.m2.4.4.1.1.1.2.2.3.1" xref="S3.E1.m2.4.4.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m2.4.4.1.1.1.2.2.3.3" xref="S3.E1.m2.4.4.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m2.4.4.1.1.1.2.3" xref="S3.E1.m2.4.4.1.1.1.2.3.cmml">S</mi></munderover></mstyle><mrow id="S3.E1.m2.4.4.1.1.1.1.1" xref="S3.E1.m2.4.4.1.1.1.1.1.1.cmml"><mo maxsize="210%" minsize="210%" id="S3.E1.m2.4.4.1.1.1.1.1.2" xref="S3.E1.m2.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m2.4.4.1.1.1.1.1.1" xref="S3.E1.m2.4.4.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m2.1.1" xref="S3.E1.m2.1.1.cmml"><mfrac id="S3.E1.m2.1.1a" xref="S3.E1.m2.1.1.cmml"><mrow id="S3.E1.m2.1.1.3" xref="S3.E1.m2.1.1.3.cmml"><mo rspace="0em" id="S3.E1.m2.1.1.3.1" xref="S3.E1.m2.1.1.3.1.cmml">∂</mo><msub id="S3.E1.m2.1.1.3.2" xref="S3.E1.m2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m2.1.1.3.2.2" xref="S3.E1.m2.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E1.m2.1.1.3.2.3" xref="S3.E1.m2.1.1.3.2.3.cmml">k</mi></msub></mrow><mrow id="S3.E1.m2.1.1.1" xref="S3.E1.m2.1.1.1.cmml"><mo rspace="0em" id="S3.E1.m2.1.1.1.2" xref="S3.E1.m2.1.1.1.2.cmml">∂</mo><msubsup id="S3.E1.m2.1.1.1.3" xref="S3.E1.m2.1.1.1.3.cmml"><mi id="S3.E1.m2.1.1.1.3.2.2" xref="S3.E1.m2.1.1.1.3.2.2.cmml">y</mi><mi id="S3.E1.m2.1.1.1.3.2.3" xref="S3.E1.m2.1.1.1.3.2.3.cmml">k</mi><mrow id="S3.E1.m2.1.1.1.1.1.3" xref="S3.E1.m2.1.1.1.3.cmml"><mo stretchy="false" id="S3.E1.m2.1.1.1.1.1.3.1" xref="S3.E1.m2.1.1.1.3.cmml">(</mo><mi id="S3.E1.m2.1.1.1.1.1.1" xref="S3.E1.m2.1.1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E1.m2.1.1.1.1.1.3.2" xref="S3.E1.m2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m2.4.4.1.1.1.1.1.1.1" xref="S3.E1.m2.4.4.1.1.1.1.1.1.1.cmml">⋅</mo><mrow id="S3.E1.m2.4.4.1.1.1.1.1.1.2" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m2.4.4.1.1.1.1.1.1.2.1" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.1.cmml"><mo rspace="0.167em" id="S3.E1.m2.4.4.1.1.1.1.1.1.2.1.2" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.1.2.cmml">∇</mo><msubsup id="S3.E1.m2.2.2.1" xref="S3.E1.m2.2.2.1.cmml"><mi id="S3.E1.m2.2.2.1.3.2" xref="S3.E1.m2.2.2.1.3.2.cmml">W</mi><mi id="S3.E1.m2.2.2.1.3.3" xref="S3.E1.m2.2.2.1.3.3.cmml">i</mi><mrow id="S3.E1.m2.2.2.1.1.1.3" xref="S3.E1.m2.2.2.1.cmml"><mo stretchy="false" id="S3.E1.m2.2.2.1.1.1.3.1" xref="S3.E1.m2.2.2.1.cmml">(</mo><mi id="S3.E1.m2.2.2.1.1.1.1" xref="S3.E1.m2.2.2.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E1.m2.2.2.1.1.1.3.2" xref="S3.E1.m2.2.2.1.cmml">)</mo></mrow></msubsup></msub><msubsup id="S3.E1.m2.4.4.1.1.1.1.1.1.2.2" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.2.2" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.2.3.cmml">k</mi><mrow id="S3.E1.m2.3.3.1.3" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.E1.m2.3.3.1.3.1" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.cmml">(</mo><mi id="S3.E1.m2.3.3.1.1" xref="S3.E1.m2.3.3.1.1.cmml">j</mi><mo stretchy="false" id="S3.E1.m2.3.3.1.3.2" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup></mrow></mrow><mo maxsize="210%" minsize="210%" id="S3.E1.m2.4.4.1.1.1.1.1.3" xref="S3.E1.m2.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m2.4.4.1.2" xref="S3.E1.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m2.4b"><apply id="S3.E1.m2.4.4.1.1.cmml" xref="S3.E1.m2.4.4.1"><eq id="S3.E1.m2.4.4.1.1.2.cmml" xref="S3.E1.m2.4.4.1.1.2"></eq><csymbol cd="latexml" id="S3.E1.m2.4.4.1.1.3.cmml" xref="S3.E1.m2.4.4.1.1.3">absent</csymbol><apply id="S3.E1.m2.4.4.1.1.1.cmml" xref="S3.E1.m2.4.4.1.1.1"><apply id="S3.E1.m2.4.4.1.1.1.2.cmml" xref="S3.E1.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.1.2.1.cmml" xref="S3.E1.m2.4.4.1.1.1.2">superscript</csymbol><apply id="S3.E1.m2.4.4.1.1.1.2.2.cmml" xref="S3.E1.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.1.2.2.1.cmml" xref="S3.E1.m2.4.4.1.1.1.2">subscript</csymbol><sum id="S3.E1.m2.4.4.1.1.1.2.2.2.cmml" xref="S3.E1.m2.4.4.1.1.1.2.2.2"></sum><apply id="S3.E1.m2.4.4.1.1.1.2.2.3.cmml" xref="S3.E1.m2.4.4.1.1.1.2.2.3"><eq id="S3.E1.m2.4.4.1.1.1.2.2.3.1.cmml" xref="S3.E1.m2.4.4.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m2.4.4.1.1.1.2.2.3.2.cmml" xref="S3.E1.m2.4.4.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E1.m2.4.4.1.1.1.2.2.3.3.cmml" xref="S3.E1.m2.4.4.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m2.4.4.1.1.1.2.3.cmml" xref="S3.E1.m2.4.4.1.1.1.2.3">𝑆</ci></apply><apply id="S3.E1.m2.4.4.1.1.1.1.1.1.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1"><ci id="S3.E1.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.1">⋅</ci><apply id="S3.E1.m2.1.1.cmml" xref="S3.E1.m2.1.1"><divide id="S3.E1.m2.1.1.2.cmml" xref="S3.E1.m2.1.1"></divide><apply id="S3.E1.m2.1.1.3.cmml" xref="S3.E1.m2.1.1.3"><partialdiff id="S3.E1.m2.1.1.3.1.cmml" xref="S3.E1.m2.1.1.3.1"></partialdiff><apply id="S3.E1.m2.1.1.3.2.cmml" xref="S3.E1.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m2.1.1.3.2.1.cmml" xref="S3.E1.m2.1.1.3.2">subscript</csymbol><ci id="S3.E1.m2.1.1.3.2.2.cmml" xref="S3.E1.m2.1.1.3.2.2">ℒ</ci><ci id="S3.E1.m2.1.1.3.2.3.cmml" xref="S3.E1.m2.1.1.3.2.3">𝑘</ci></apply></apply><apply id="S3.E1.m2.1.1.1.cmml" xref="S3.E1.m2.1.1.1"><partialdiff id="S3.E1.m2.1.1.1.2.cmml" xref="S3.E1.m2.1.1.1.2"></partialdiff><apply id="S3.E1.m2.1.1.1.3.cmml" xref="S3.E1.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m2.1.1.1.3.1.cmml" xref="S3.E1.m2.1.1.1.3">superscript</csymbol><apply id="S3.E1.m2.1.1.1.3.2.cmml" xref="S3.E1.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m2.1.1.1.3.2.1.cmml" xref="S3.E1.m2.1.1.1.3">subscript</csymbol><ci id="S3.E1.m2.1.1.1.3.2.2.cmml" xref="S3.E1.m2.1.1.1.3.2.2">𝑦</ci><ci id="S3.E1.m2.1.1.1.3.2.3.cmml" xref="S3.E1.m2.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E1.m2.1.1.1.1.1.1.cmml" xref="S3.E1.m2.1.1.1.1.1.1">𝑗</ci></apply></apply></apply><apply id="S3.E1.m2.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2"><apply id="S3.E1.m2.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.E1.m2.4.4.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.1.2">∇</ci><apply id="S3.E1.m2.2.2.1.cmml" xref="S3.E1.m2.2.2.1"><csymbol cd="ambiguous" id="S3.E1.m2.2.2.1.2.cmml" xref="S3.E1.m2.2.2.1">superscript</csymbol><apply id="S3.E1.m2.2.2.1.3.cmml" xref="S3.E1.m2.2.2.1"><csymbol cd="ambiguous" id="S3.E1.m2.2.2.1.3.1.cmml" xref="S3.E1.m2.2.2.1">subscript</csymbol><ci id="S3.E1.m2.2.2.1.3.2.cmml" xref="S3.E1.m2.2.2.1.3.2">𝑊</ci><ci id="S3.E1.m2.2.2.1.3.3.cmml" xref="S3.E1.m2.2.2.1.3.3">𝑖</ci></apply><ci id="S3.E1.m2.2.2.1.1.1.1.cmml" xref="S3.E1.m2.2.2.1.1.1.1">𝑗</ci></apply></apply><apply id="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m2.4.4.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply><ci id="S3.E1.m2.3.3.1.1.cmml" xref="S3.E1.m2.3.3.1.1">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m2.4c">\displaystyle=\sum_{k=1}^{S}\bigg{(}\frac{\partial\mathcal{L}_{k}}{\partial y_{k}^{(j)}}\cdot\nabla_{W_{i}^{(j)}}y_{k}^{(j)}\bigg{)},\qquad</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial b_{i}^{(j)}}" display="inline"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.2" xref="S3.E2.m1.1.2.cmml"><mstyle displaystyle="true" id="S3.E2.m1.1.2.1" xref="S3.E2.m1.1.2.1.cmml"><munderover id="S3.E2.m1.1.2.1a" xref="S3.E2.m1.1.2.1.cmml"><mo movablelimits="false" id="S3.E2.m1.1.2.1.2.2" xref="S3.E2.m1.1.2.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.1.2.1.2.3" xref="S3.E2.m1.1.2.1.2.3.cmml"><mi id="S3.E2.m1.1.2.1.2.3.2" xref="S3.E2.m1.1.2.1.2.3.2.cmml">k</mi><mo id="S3.E2.m1.1.2.1.2.3.1" xref="S3.E2.m1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.1.2.1.2.3.3" xref="S3.E2.m1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.1.2.1.3" xref="S3.E2.m1.1.2.1.3.cmml">S</mi></munderover></mstyle><mstyle displaystyle="true" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mfrac id="S3.E2.m1.1.1a" xref="S3.E2.m1.1.1.cmml"><mrow id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><mo rspace="0em" id="S3.E2.m1.1.1.3.1" xref="S3.E2.m1.1.1.3.1.cmml">∂</mo><msub id="S3.E2.m1.1.1.3.2" xref="S3.E2.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.3.2.2" xref="S3.E2.m1.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E2.m1.1.1.3.2.3" xref="S3.E2.m1.1.1.3.2.3.cmml">k</mi></msub></mrow><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mo rspace="0em" id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">∂</mo><msubsup id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.3.2.2.cmml">b</mi><mi id="S3.E2.m1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.3.2.3.cmml">i</mi><mrow id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.3.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.2.cmml" xref="S3.E2.m1.1.2"><apply id="S3.E2.m1.1.2.1.cmml" xref="S3.E2.m1.1.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.2.1.1.cmml" xref="S3.E2.m1.1.2.1">superscript</csymbol><apply id="S3.E2.m1.1.2.1.2.cmml" xref="S3.E2.m1.1.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.2.1.2.1.cmml" xref="S3.E2.m1.1.2.1">subscript</csymbol><sum id="S3.E2.m1.1.2.1.2.2.cmml" xref="S3.E2.m1.1.2.1.2.2"></sum><apply id="S3.E2.m1.1.2.1.2.3.cmml" xref="S3.E2.m1.1.2.1.2.3"><eq id="S3.E2.m1.1.2.1.2.3.1.cmml" xref="S3.E2.m1.1.2.1.2.3.1"></eq><ci id="S3.E2.m1.1.2.1.2.3.2.cmml" xref="S3.E2.m1.1.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.1.2.1.2.3.3.cmml" xref="S3.E2.m1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.2.1.3.cmml" xref="S3.E2.m1.1.2.1.3">𝑆</ci></apply><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><divide id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1"></divide><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><partialdiff id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3.1"></partialdiff><apply id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.3.2.2">ℒ</ci><ci id="S3.E2.m1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.3.2.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><partialdiff id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></partialdiff><apply id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.3.2.2">𝑏</ci><ci id="S3.E2.m1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial b_{i}^{(j)}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial y_{k}^{(j)}}\cdot\frac{\partial y_{k}^{(j)}}{\partial b_{i}}," display="inline"><semantics id="S3.E2.m2.3a"><mrow id="S3.E2.m2.3.3.1" xref="S3.E2.m2.3.3.1.1.cmml"><mrow id="S3.E2.m2.3.3.1.1" xref="S3.E2.m2.3.3.1.1.cmml"><mi id="S3.E2.m2.3.3.1.1.2" xref="S3.E2.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E2.m2.3.3.1.1.1" xref="S3.E2.m2.3.3.1.1.1.cmml">=</mo><mrow id="S3.E2.m2.3.3.1.1.3" xref="S3.E2.m2.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E2.m2.3.3.1.1.3.1" xref="S3.E2.m2.3.3.1.1.3.1.cmml"><munderover id="S3.E2.m2.3.3.1.1.3.1a" xref="S3.E2.m2.3.3.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E2.m2.3.3.1.1.3.1.2.2" xref="S3.E2.m2.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m2.3.3.1.1.3.1.2.3" xref="S3.E2.m2.3.3.1.1.3.1.2.3.cmml"><mi id="S3.E2.m2.3.3.1.1.3.1.2.3.2" xref="S3.E2.m2.3.3.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E2.m2.3.3.1.1.3.1.2.3.1" xref="S3.E2.m2.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E2.m2.3.3.1.1.3.1.2.3.3" xref="S3.E2.m2.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m2.3.3.1.1.3.1.3" xref="S3.E2.m2.3.3.1.1.3.1.3.cmml">S</mi></munderover></mstyle><mrow id="S3.E2.m2.3.3.1.1.3.2" xref="S3.E2.m2.3.3.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E2.m2.1.1" xref="S3.E2.m2.1.1.cmml"><mfrac id="S3.E2.m2.1.1a" xref="S3.E2.m2.1.1.cmml"><mrow id="S3.E2.m2.1.1.3" xref="S3.E2.m2.1.1.3.cmml"><mo rspace="0em" id="S3.E2.m2.1.1.3.1" xref="S3.E2.m2.1.1.3.1.cmml">∂</mo><msub id="S3.E2.m2.1.1.3.2" xref="S3.E2.m2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m2.1.1.3.2.2" xref="S3.E2.m2.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E2.m2.1.1.3.2.3" xref="S3.E2.m2.1.1.3.2.3.cmml">k</mi></msub></mrow><mrow id="S3.E2.m2.1.1.1" xref="S3.E2.m2.1.1.1.cmml"><mo rspace="0em" id="S3.E2.m2.1.1.1.2" xref="S3.E2.m2.1.1.1.2.cmml">∂</mo><msubsup id="S3.E2.m2.1.1.1.3" xref="S3.E2.m2.1.1.1.3.cmml"><mi id="S3.E2.m2.1.1.1.3.2.2" xref="S3.E2.m2.1.1.1.3.2.2.cmml">y</mi><mi id="S3.E2.m2.1.1.1.3.2.3" xref="S3.E2.m2.1.1.1.3.2.3.cmml">k</mi><mrow id="S3.E2.m2.1.1.1.1.1.3" xref="S3.E2.m2.1.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m2.1.1.1.1.1.3.1" xref="S3.E2.m2.1.1.1.3.cmml">(</mo><mi id="S3.E2.m2.1.1.1.1.1.1" xref="S3.E2.m2.1.1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E2.m2.1.1.1.1.1.3.2" xref="S3.E2.m2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mstyle><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m2.3.3.1.1.3.2.1" xref="S3.E2.m2.3.3.1.1.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S3.E2.m2.2.2" xref="S3.E2.m2.2.2.cmml"><mfrac id="S3.E2.m2.2.2a" xref="S3.E2.m2.2.2.cmml"><mrow id="S3.E2.m2.2.2.1" xref="S3.E2.m2.2.2.1.cmml"><mo rspace="0em" id="S3.E2.m2.2.2.1.2" xref="S3.E2.m2.2.2.1.2.cmml">∂</mo><msubsup id="S3.E2.m2.2.2.1.3" xref="S3.E2.m2.2.2.1.3.cmml"><mi id="S3.E2.m2.2.2.1.3.2.2" xref="S3.E2.m2.2.2.1.3.2.2.cmml">y</mi><mi id="S3.E2.m2.2.2.1.3.2.3" xref="S3.E2.m2.2.2.1.3.2.3.cmml">k</mi><mrow id="S3.E2.m2.2.2.1.1.1.3" xref="S3.E2.m2.2.2.1.3.cmml"><mo stretchy="false" id="S3.E2.m2.2.2.1.1.1.3.1" xref="S3.E2.m2.2.2.1.3.cmml">(</mo><mi id="S3.E2.m2.2.2.1.1.1.1" xref="S3.E2.m2.2.2.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E2.m2.2.2.1.1.1.3.2" xref="S3.E2.m2.2.2.1.3.cmml">)</mo></mrow></msubsup></mrow><mrow id="S3.E2.m2.2.2.3" xref="S3.E2.m2.2.2.3.cmml"><mo rspace="0em" id="S3.E2.m2.2.2.3.1" xref="S3.E2.m2.2.2.3.1.cmml">∂</mo><msub id="S3.E2.m2.2.2.3.2" xref="S3.E2.m2.2.2.3.2.cmml"><mi id="S3.E2.m2.2.2.3.2.2" xref="S3.E2.m2.2.2.3.2.2.cmml">b</mi><mi id="S3.E2.m2.2.2.3.2.3" xref="S3.E2.m2.2.2.3.2.3.cmml">i</mi></msub></mrow></mfrac></mstyle></mrow></mrow></mrow><mo id="S3.E2.m2.3.3.1.2" xref="S3.E2.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m2.3b"><apply id="S3.E2.m2.3.3.1.1.cmml" xref="S3.E2.m2.3.3.1"><eq id="S3.E2.m2.3.3.1.1.1.cmml" xref="S3.E2.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E2.m2.3.3.1.1.2.cmml" xref="S3.E2.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E2.m2.3.3.1.1.3.cmml" xref="S3.E2.m2.3.3.1.1.3"><apply id="S3.E2.m2.3.3.1.1.3.1.cmml" xref="S3.E2.m2.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m2.3.3.1.1.3.1.1.cmml" xref="S3.E2.m2.3.3.1.1.3.1">superscript</csymbol><apply id="S3.E2.m2.3.3.1.1.3.1.2.cmml" xref="S3.E2.m2.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m2.3.3.1.1.3.1.2.1.cmml" xref="S3.E2.m2.3.3.1.1.3.1">subscript</csymbol><sum id="S3.E2.m2.3.3.1.1.3.1.2.2.cmml" xref="S3.E2.m2.3.3.1.1.3.1.2.2"></sum><apply id="S3.E2.m2.3.3.1.1.3.1.2.3.cmml" xref="S3.E2.m2.3.3.1.1.3.1.2.3"><eq id="S3.E2.m2.3.3.1.1.3.1.2.3.1.cmml" xref="S3.E2.m2.3.3.1.1.3.1.2.3.1"></eq><ci id="S3.E2.m2.3.3.1.1.3.1.2.3.2.cmml" xref="S3.E2.m2.3.3.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m2.3.3.1.1.3.1.2.3.3.cmml" xref="S3.E2.m2.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m2.3.3.1.1.3.1.3.cmml" xref="S3.E2.m2.3.3.1.1.3.1.3">𝑆</ci></apply><apply id="S3.E2.m2.3.3.1.1.3.2.cmml" xref="S3.E2.m2.3.3.1.1.3.2"><ci id="S3.E2.m2.3.3.1.1.3.2.1.cmml" xref="S3.E2.m2.3.3.1.1.3.2.1">⋅</ci><apply id="S3.E2.m2.1.1.cmml" xref="S3.E2.m2.1.1"><divide id="S3.E2.m2.1.1.2.cmml" xref="S3.E2.m2.1.1"></divide><apply id="S3.E2.m2.1.1.3.cmml" xref="S3.E2.m2.1.1.3"><partialdiff id="S3.E2.m2.1.1.3.1.cmml" xref="S3.E2.m2.1.1.3.1"></partialdiff><apply id="S3.E2.m2.1.1.3.2.cmml" xref="S3.E2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.3.2.1.cmml" xref="S3.E2.m2.1.1.3.2">subscript</csymbol><ci id="S3.E2.m2.1.1.3.2.2.cmml" xref="S3.E2.m2.1.1.3.2.2">ℒ</ci><ci id="S3.E2.m2.1.1.3.2.3.cmml" xref="S3.E2.m2.1.1.3.2.3">𝑘</ci></apply></apply><apply id="S3.E2.m2.1.1.1.cmml" xref="S3.E2.m2.1.1.1"><partialdiff id="S3.E2.m2.1.1.1.2.cmml" xref="S3.E2.m2.1.1.1.2"></partialdiff><apply id="S3.E2.m2.1.1.1.3.cmml" xref="S3.E2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.3.1.cmml" xref="S3.E2.m2.1.1.1.3">superscript</csymbol><apply id="S3.E2.m2.1.1.1.3.2.cmml" xref="S3.E2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.3.2.1.cmml" xref="S3.E2.m2.1.1.1.3">subscript</csymbol><ci id="S3.E2.m2.1.1.1.3.2.2.cmml" xref="S3.E2.m2.1.1.1.3.2.2">𝑦</ci><ci id="S3.E2.m2.1.1.1.3.2.3.cmml" xref="S3.E2.m2.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E2.m2.1.1.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1.1.1.1">𝑗</ci></apply></apply></apply><apply id="S3.E2.m2.2.2.cmml" xref="S3.E2.m2.2.2"><divide id="S3.E2.m2.2.2.2.cmml" xref="S3.E2.m2.2.2"></divide><apply id="S3.E2.m2.2.2.1.cmml" xref="S3.E2.m2.2.2.1"><partialdiff id="S3.E2.m2.2.2.1.2.cmml" xref="S3.E2.m2.2.2.1.2"></partialdiff><apply id="S3.E2.m2.2.2.1.3.cmml" xref="S3.E2.m2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.1.3.1.cmml" xref="S3.E2.m2.2.2.1.3">superscript</csymbol><apply id="S3.E2.m2.2.2.1.3.2.cmml" xref="S3.E2.m2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.1.3.2.1.cmml" xref="S3.E2.m2.2.2.1.3">subscript</csymbol><ci id="S3.E2.m2.2.2.1.3.2.2.cmml" xref="S3.E2.m2.2.2.1.3.2.2">𝑦</ci><ci id="S3.E2.m2.2.2.1.3.2.3.cmml" xref="S3.E2.m2.2.2.1.3.2.3">𝑘</ci></apply><ci id="S3.E2.m2.2.2.1.1.1.1.cmml" xref="S3.E2.m2.2.2.1.1.1.1">𝑗</ci></apply></apply><apply id="S3.E2.m2.2.2.3.cmml" xref="S3.E2.m2.2.2.3"><partialdiff id="S3.E2.m2.2.2.3.1.cmml" xref="S3.E2.m2.2.2.3.1"></partialdiff><apply id="S3.E2.m2.2.2.3.2.cmml" xref="S3.E2.m2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m2.2.2.3.2.1.cmml" xref="S3.E2.m2.2.2.3.2">subscript</csymbol><ci id="S3.E2.m2.2.2.3.2.2.cmml" xref="S3.E2.m2.2.2.3.2.2">𝑏</ci><ci id="S3.E2.m2.2.2.3.2.3.cmml" xref="S3.E2.m2.2.2.3.2.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.3c">\displaystyle=\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial y_{k}^{(j)}}\cdot\frac{\partial y_{k}^{(j)}}{\partial b_{i}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS0.SSS0.Px2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px2.p3.5" class="ltx_p">For each of the <math id="S3.SS0.SSS0.Px2.p3.1.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS0.SSS0.Px2.p3.1.m1.1a"><mi id="S3.SS0.SSS0.Px2.p3.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p3.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p3.1.m1.1b"><ci id="S3.SS0.SSS0.Px2.p3.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p3.1.m1.1c">j</annotation></semantics></math> entries, rows of the bias and weight, respectively. This can be simplified further to: <math id="S3.SS0.SSS0.Px2.p3.2.m2.1" class="ltx_Math" alttext="\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial y_{k}^{(j)}}\cdot u_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p3.2.m2.1a"><mrow id="S3.SS0.SSS0.Px2.p3.2.m2.1.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.cmml"><msubsup id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.cmml"><mo id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.2.cmml">∑</mo><mrow id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.2.cmml">k</mi><mo id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.1" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.3" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.3" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.3.cmml">S</mi></msubsup><mrow id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.cmml"><mfrac id="S3.SS0.SSS0.Px2.p3.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.cmml"><mo rspace="0em" id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.1" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.1.cmml">∂</mo><msub id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2.3" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2.3.cmml">k</mi></msub></mrow><mrow id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.cmml"><mo rspace="0em" id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.2.cmml">∂</mo><msubsup id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.2.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.2.3" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.1" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.1.cmml">⋅</mo><msub id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2.2" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2.3" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p3.2.m2.1b"><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2"><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1">subscript</csymbol><sum id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.2"></sum><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3"><eq id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.1"></eq><ci id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.3.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.3.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.1.3">𝑆</ci></apply><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2"><ci id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.1">⋅</ci><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1"><divide id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1"></divide><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3"><partialdiff id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.1"></partialdiff><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2.2">ℒ</ci><ci id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2.3.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.3.2.3">𝑘</ci></apply></apply><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1"><partialdiff id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.2"></partialdiff><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.2.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.2.3.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.1.1.1.1.1">𝑗</ci></apply></apply></apply><apply id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2.2">𝑢</ci><ci id="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p3.2.m2.1.2.2.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p3.2.m2.1c">\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial y_{k}^{(j)}}\cdot u_{k}</annotation></semantics></math> for weight and <math id="S3.SS0.SSS0.Px2.p3.3.m3.1" class="ltx_Math" alttext="\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial y_{k}^{(j)}}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p3.3.m3.1a"><mrow id="S3.SS0.SSS0.Px2.p3.3.m3.1.2" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.cmml"><msubsup id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.cmml"><mo id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.2" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.2.cmml">∑</mo><mrow id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.2" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.2.cmml">k</mi><mo id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.1" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.3" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.3" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.3.cmml">S</mi></msubsup><mfrac id="S3.SS0.SSS0.Px2.p3.3.m3.1.1" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.cmml"><mo rspace="0em" id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.1" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.1.cmml">∂</mo><msub id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2.2" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2.3" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2.3.cmml">k</mi></msub></mrow><mrow id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.cmml"><mo rspace="0em" id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.2" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.2.cmml">∂</mo><msubsup id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.2.2" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.2.3" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p3.3.m3.1b"><apply id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2"><apply id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1">subscript</csymbol><sum id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.2"></sum><apply id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3"><eq id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.1"></eq><ci id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.3.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.3.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.2.1.3">𝑆</ci></apply><apply id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1"><divide id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1"></divide><apply id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3"><partialdiff id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.1"></partialdiff><apply id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2.2">ℒ</ci><ci id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2.3.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.3.2.3">𝑘</ci></apply></apply><apply id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1"><partialdiff id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.2"></partialdiff><apply id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.2.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.2.3.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.3.m3.1.1.1.1.1.1">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p3.3.m3.1c">\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial y_{k}^{(j)}}</annotation></semantics></math> for bias <cite class="ltx_cite ltx_citemacro_citep">(Geiping et al., <a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite>. Even after this reduction, it seems quite difficult to recover <math id="S3.SS0.SSS0.Px2.p3.4.m4.1" class="ltx_Math" alttext="u_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p3.4.m4.1a"><msub id="S3.SS0.SSS0.Px2.p3.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p3.4.m4.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p3.4.m4.1.1.2" xref="S3.SS0.SSS0.Px2.p3.4.m4.1.1.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px2.p3.4.m4.1.1.3" xref="S3.SS0.SSS0.Px2.p3.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p3.4.m4.1b"><apply id="S3.SS0.SSS0.Px2.p3.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p3.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.4.m4.1.1.2">𝑢</ci><ci id="S3.SS0.SSS0.Px2.p3.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p3.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p3.4.m4.1c">u_{k}</annotation></semantics></math> from these sums. Yet, a malicious attacker can modify the weights of <math id="S3.SS0.SSS0.Px2.p3.5.m5.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p3.5.m5.1a"><msub id="S3.SS0.SSS0.Px2.p3.5.m5.1.1" xref="S3.SS0.SSS0.Px2.p3.5.m5.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p3.5.m5.1.1.2" xref="S3.SS0.SSS0.Px2.p3.5.m5.1.1.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px2.p3.5.m5.1.1.3" xref="S3.SS0.SSS0.Px2.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p3.5.m5.1b"><apply id="S3.SS0.SSS0.Px2.p3.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p3.5.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p3.5.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p3.5.m5.1.1.2">𝑊</ci><ci id="S3.SS0.SSS0.Px2.p3.5.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p3.5.m5.1c">W_{i}</annotation></semantics></math> and of the subsequent matrix to allow for a closed-form solution.</p>
</div>
<div id="S3.SS0.SSS0.Px2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px2.p4.4" class="ltx_p">To this end, we leverage recent strategies for separating gradient signals <cite class="ltx_cite ltx_citemacro_citep">(Fowl et al., <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>. In essence, this strategy encodes a measurement function into each weight row <math id="S3.SS0.SSS0.Px2.p4.1.m1.1" class="ltx_Math" alttext="W_{i}^{(j)}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p4.1.m1.1a"><msubsup id="S3.SS0.SSS0.Px2.p4.1.m1.1.2" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.2" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.3" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.3.cmml">i</mi><mrow id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p4.1.m1.1b"><apply id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.2">𝑊</ci><ci id="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p4.1.m1.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p4.1.m1.1c">W_{i}^{(j)}</annotation></semantics></math> of a linear layer <math id="S3.SS0.SSS0.Px2.p4.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS0.SSS0.Px2.p4.2.m2.1a"><mi id="S3.SS0.SSS0.Px2.p4.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p4.2.m2.1b"><ci id="S3.SS0.SSS0.Px2.p4.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p4.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p4.2.m2.1c">i</annotation></semantics></math> and an increasing offset into each entry of the bias vectors <math id="S3.SS0.SSS0.Px2.p4.3.m3.1" class="ltx_Math" alttext="b_{i}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p4.3.m3.1a"><msub id="S3.SS0.SSS0.Px2.p4.3.m3.1.1" xref="S3.SS0.SSS0.Px2.p4.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p4.3.m3.1.1.2" xref="S3.SS0.SSS0.Px2.p4.3.m3.1.1.2.cmml">b</mi><mi id="S3.SS0.SSS0.Px2.p4.3.m3.1.1.3" xref="S3.SS0.SSS0.Px2.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p4.3.m3.1b"><apply id="S3.SS0.SSS0.Px2.p4.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p4.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p4.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p4.3.m3.1.1.2">𝑏</ci><ci id="S3.SS0.SSS0.Px2.p4.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p4.3.m3.1c">b_{i}</annotation></semantics></math>. For linear layers that are followed by activations which cut off smaller input values (such as ReLU or GELU), the gradient of the weights in this linear layer will then encode a cumulative sum of the values of all inputs up to some offset value. This structures the gradients observed in <a href="#S3.E1" title="In Unmixing Gradient Signals: ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">1</span></a> and original inputs <math id="S3.SS0.SSS0.Px2.p4.4.m4.1" class="ltx_Math" alttext="u_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p4.4.m4.1a"><msub id="S3.SS0.SSS0.Px2.p4.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p4.4.m4.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p4.4.m4.1.1.2" xref="S3.SS0.SSS0.Px2.p4.4.m4.1.1.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px2.p4.4.m4.1.1.3" xref="S3.SS0.SSS0.Px2.p4.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p4.4.m4.1b"><apply id="S3.SS0.SSS0.Px2.p4.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p4.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p4.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p4.4.m4.1.1.2">𝑢</ci><ci id="S3.SS0.SSS0.Px2.p4.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p4.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p4.4.m4.1c">u_{k}</annotation></semantics></math> can then be recovered by subtraction of adjacent rows. This is visualized in <a href="#S3.F3" title="In Unmixing Gradient Signals: ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2201.12675/assets/x1.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="263" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>How embeddings are extracted from linear layers in the transformer blocks. We initialize the rows of the first linear layer in each Transformer block to a randomly sampled Gaussian vector (all rows being the same).
The bottom portion of the figure depicts the internals of a forward pass through this FC layer.
When an incoming embedding vector <math id="S3.F3.4.m1.1" class="ltx_Math" alttext="u_{k}" display="inline"><semantics id="S3.F3.4.m1.1b"><msub id="S3.F3.4.m1.1.1" xref="S3.F3.4.m1.1.1.cmml"><mi id="S3.F3.4.m1.1.1.2" xref="S3.F3.4.m1.1.1.2.cmml">u</mi><mi id="S3.F3.4.m1.1.1.3" xref="S3.F3.4.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.4.m1.1c"><apply id="S3.F3.4.m1.1.1.cmml" xref="S3.F3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.4.m1.1.1.1.cmml" xref="S3.F3.4.m1.1.1">subscript</csymbol><ci id="S3.F3.4.m1.1.1.2.cmml" xref="S3.F3.4.m1.1.1.2">𝑢</ci><ci id="S3.F3.4.m1.1.1.3.cmml" xref="S3.F3.4.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m1.1d">u_{k}</annotation></semantics></math> enters the FC layer, the inner products <math id="S3.F3.5.m2.2" class="ltx_Math" alttext="\langle m,u_{k}\rangle" display="inline"><semantics id="S3.F3.5.m2.2b"><mrow id="S3.F3.5.m2.2.2.1" xref="S3.F3.5.m2.2.2.2.cmml"><mo stretchy="false" id="S3.F3.5.m2.2.2.1.2" xref="S3.F3.5.m2.2.2.2.cmml">⟨</mo><mi id="S3.F3.5.m2.1.1" xref="S3.F3.5.m2.1.1.cmml">m</mi><mo id="S3.F3.5.m2.2.2.1.3" xref="S3.F3.5.m2.2.2.2.cmml">,</mo><msub id="S3.F3.5.m2.2.2.1.1" xref="S3.F3.5.m2.2.2.1.1.cmml"><mi id="S3.F3.5.m2.2.2.1.1.2" xref="S3.F3.5.m2.2.2.1.1.2.cmml">u</mi><mi id="S3.F3.5.m2.2.2.1.1.3" xref="S3.F3.5.m2.2.2.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.F3.5.m2.2.2.1.4" xref="S3.F3.5.m2.2.2.2.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.5.m2.2c"><list id="S3.F3.5.m2.2.2.2.cmml" xref="S3.F3.5.m2.2.2.1"><ci id="S3.F3.5.m2.1.1.cmml" xref="S3.F3.5.m2.1.1">𝑚</ci><apply id="S3.F3.5.m2.2.2.1.1.cmml" xref="S3.F3.5.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.F3.5.m2.2.2.1.1.1.cmml" xref="S3.F3.5.m2.2.2.1.1">subscript</csymbol><ci id="S3.F3.5.m2.2.2.1.1.2.cmml" xref="S3.F3.5.m2.2.2.1.1.2">𝑢</ci><ci id="S3.F3.5.m2.2.2.1.1.3.cmml" xref="S3.F3.5.m2.2.2.1.1.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.5.m2.2d">\langle m,u_{k}\rangle</annotation></semantics></math> fall into a distribution which the attacker partitions into bins. If <math id="S3.F3.6.m3.1" class="ltx_Math" alttext="u_{k}" display="inline"><semantics id="S3.F3.6.m3.1b"><msub id="S3.F3.6.m3.1.1" xref="S3.F3.6.m3.1.1.cmml"><mi id="S3.F3.6.m3.1.1.2" xref="S3.F3.6.m3.1.1.2.cmml">u</mi><mi id="S3.F3.6.m3.1.1.3" xref="S3.F3.6.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.6.m3.1c"><apply id="S3.F3.6.m3.1.1.cmml" xref="S3.F3.6.m3.1.1"><csymbol cd="ambiguous" id="S3.F3.6.m3.1.1.1.cmml" xref="S3.F3.6.m3.1.1">subscript</csymbol><ci id="S3.F3.6.m3.1.1.2.cmml" xref="S3.F3.6.m3.1.1.2">𝑢</ci><ci id="S3.F3.6.m3.1.1.3.cmml" xref="S3.F3.6.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.6.m3.1d">u_{k}</annotation></semantics></math> is the only token whose inner product lies in a given bin, the ReLU activation will encode information about this single token, and (<a href="#S3.E3" title="Equation 3 ‣ Unmixing Gradient Signals: ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) can be used to directly recover the token.</figcaption>
</figure>
<div id="S3.SS0.SSS0.Px2.p5" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px2.p5.10" class="ltx_p">To go further into detail into this modification, the rows of all weight matrices <math id="S3.SS0.SSS0.Px2.p5.1.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.1.m1.1a"><msub id="S3.SS0.SSS0.Px2.p5.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p5.1.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p5.1.m1.1.1.2" xref="S3.SS0.SSS0.Px2.p5.1.m1.1.1.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px2.p5.1.m1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.1.m1.1b"><apply id="S3.SS0.SSS0.Px2.p5.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.1.m1.1.1.2">𝑊</ci><ci id="S3.SS0.SSS0.Px2.p5.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.1.m1.1c">W_{i}</annotation></semantics></math> are replaced by a measurement vector <math id="S3.SS0.SSS0.Px2.p5.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.2.m2.1a"><mi id="S3.SS0.SSS0.Px2.p5.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p5.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.2.m2.1b"><ci id="S3.SS0.SSS0.Px2.p5.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.2.m2.1c">m</annotation></semantics></math> and the biases over all layers are modified to be sequentially ascending. As a result, all linear layers now compute <math id="S3.SS0.SSS0.Px2.p5.3.m3.4" class="ltx_Math" alttext="y_{k}^{(j)}=\langle m,u_{k}\rangle+b^{(j)}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.3.m3.4a"><mrow id="S3.SS0.SSS0.Px2.p5.3.m3.4.4" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.cmml"><msubsup id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.cmml"><mi id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.2.2" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.2.3" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p5.3.m3.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.3.m3.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p5.3.m3.1.1.1.1" xref="S3.SS0.SSS0.Px2.p5.3.m3.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.3.m3.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.2" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.2.cmml">=</mo><mrow id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.2" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.2.cmml">⟨</mo><mi id="S3.SS0.SSS0.Px2.p5.3.m3.3.3" xref="S3.SS0.SSS0.Px2.p5.3.m3.3.3.cmml">m</mi><mo id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.2.cmml">,</mo><msub id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.4" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.2.cmml">⟩</mo></mrow><mo id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.2" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.2.cmml">+</mo><msup id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3.2" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3.2.cmml">b</mi><mrow id="S3.SS0.SSS0.Px2.p5.3.m3.2.2.1.3" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.3.m3.2.2.1.3.1" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p5.3.m3.2.2.1.1" xref="S3.SS0.SSS0.Px2.p5.3.m3.2.2.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.3.m3.2.2.1.3.2" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.3.m3.4b"><apply id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4"><eq id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.2.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.2"></eq><apply id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.1.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.2.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.2.3.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.3.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p5.3.m3.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.1.1.1.1">𝑗</ci></apply><apply id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1"><plus id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.2"></plus><list id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1"><ci id="S3.SS0.SSS0.Px2.p5.3.m3.3.3.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.3.3">𝑚</ci><apply id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1.2">𝑢</ci><ci id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.1.1.1.3">𝑘</ci></apply></list><apply id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.4.4.1.3.2">𝑏</ci><ci id="S3.SS0.SSS0.Px2.p5.3.m3.2.2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.3.m3.2.2.1.1">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.3.m3.4c">y_{k}^{(j)}=\langle m,u_{k}\rangle+b^{(j)}</annotation></semantics></math>. And <math id="S3.SS0.SSS0.Px2.p5.4.m4.1" class="ltx_Math" alttext="y_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.4.m4.1a"><msub id="S3.SS0.SSS0.Px2.p5.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p5.4.m4.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p5.4.m4.1.1.2" xref="S3.SS0.SSS0.Px2.p5.4.m4.1.1.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p5.4.m4.1.1.3" xref="S3.SS0.SSS0.Px2.p5.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.4.m4.1b"><apply id="S3.SS0.SSS0.Px2.p5.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.4.m4.1.1.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p5.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p5.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.4.m4.1c">y_{k}</annotation></semantics></math> is ordered so that <math id="S3.SS0.SSS0.Px2.p5.5.m5.4" class="ltx_Math" alttext="y_{k}^{(j)}\geq y_{k}^{(j^{\prime})},\forall j&lt;j^{\prime}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.5.m5.4a"><mrow id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.3.cmml"><mrow id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.cmml"><msubsup id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.2.2" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.2.3" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p5.5.m5.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.5.m5.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p5.5.m5.1.1.1.1" xref="S3.SS0.SSS0.Px2.p5.5.m5.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.5.m5.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.1" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.1.cmml">≥</mo><msubsup id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.2.2" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.2.3" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1" xref="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.2" xref="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.cmml">(</mo><msup id="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1" xref="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.2" xref="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.2.cmml">j</mi><mo id="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.3" xref="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.3" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.3a.cmml">,</mo><mrow id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.cmml"><mrow id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2.cmml"><mo rspace="0.167em" id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2.1" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2.1.cmml">∀</mo><mi id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2.2" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2.2.cmml">j</mi></mrow><mo id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.1" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.1.cmml">&lt;</mo><msup id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3.cmml"><mi id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3.2" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3.2.cmml">j</mi><mo id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3.3" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3.3.cmml">′</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.5.m5.4b"><apply id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.3.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.3a.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.3">formulae-sequence</csymbol><apply id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1"><geq id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.1"></geq><apply id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.2.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p5.5.m5.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.1.1.1.1">𝑗</ci></apply><apply id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.2.3.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.3.3.1.1.3.2.3">𝑘</ci></apply><apply id="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.2">𝑗</ci><ci id="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.2.2.1.1.1.3">′</ci></apply></apply></apply><apply id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2"><lt id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.1"></lt><apply id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2"><csymbol cd="latexml" id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2.1">for-all</csymbol><ci id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.2.2">𝑗</ci></apply><apply id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3.2">𝑗</ci><ci id="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3.3.cmml" xref="S3.SS0.SSS0.Px2.p5.5.m5.4.4.2.2.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.5.m5.4c">y_{k}^{(j)}\geq y_{k}^{(j^{\prime})},\forall j&lt;j^{\prime}</annotation></semantics></math>. The subsequent ReLU unit will threshold <math id="S3.SS0.SSS0.Px2.p5.6.m6.1" class="ltx_Math" alttext="y_{k}^{(j)}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.6.m6.1a"><msubsup id="S3.SS0.SSS0.Px2.p5.6.m6.1.2" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p5.6.m6.1.2.2.2" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p5.6.m6.1.2.2.3" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p5.6.m6.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.6.m6.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p5.6.m6.1.1.1.1" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.6.m6.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.6.m6.1b"><apply id="S3.SS0.SSS0.Px2.p5.6.m6.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.6.m6.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p5.6.m6.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.6.m6.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.6.m6.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p5.6.m6.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.2.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p5.6.m6.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.6.m6.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.6.m6.1c">y_{k}^{(j)}</annotation></semantics></math>, so that <math id="S3.SS0.SSS0.Px2.p5.7.m7.1" class="ltx_Math" alttext="y_{k}^{(j)}=0" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.7.m7.1a"><mrow id="S3.SS0.SSS0.Px2.p5.7.m7.1.2" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.cmml"><msubsup id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.cmml"><mi id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.2.2" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.2.3" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.2.3.cmml">k</mi><mrow id="S3.SS0.SSS0.Px2.p5.7.m7.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.7.m7.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p5.7.m7.1.1.1.1" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.7.m7.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.1" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.3" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.7.m7.1b"><apply id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2"><eq id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.1"></eq><apply id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.2.2.3">𝑘</ci></apply><ci id="S3.SS0.SSS0.Px2.p5.7.m7.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.1.1.1">𝑗</ci></apply><cn type="integer" id="S3.SS0.SSS0.Px2.p5.7.m7.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p5.7.m7.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.7.m7.1c">y_{k}^{(j)}=0</annotation></semantics></math> directly implies <math id="S3.SS0.SSS0.Px2.p5.8.m8.3" class="ltx_Math" alttext="\langle m,u_{k}\rangle&lt;-b^{(j)}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.8.m8.3a"><mrow id="S3.SS0.SSS0.Px2.p5.8.m8.3.3" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.cmml"><mrow id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.2" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.2.cmml">⟨</mo><mi id="S3.SS0.SSS0.Px2.p5.8.m8.2.2" xref="S3.SS0.SSS0.Px2.p5.8.m8.2.2.cmml">m</mi><mo id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.3" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.2.cmml">,</mo><msub id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1.2" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.4" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.2.cmml">⟩</mo></mrow><mo id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.2" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.2.cmml">&lt;</mo><mrow id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.cmml"><mo id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3a" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.cmml">−</mo><msup id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2.cmml"><mi id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2.2" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2.2.cmml">b</mi><mrow id="S3.SS0.SSS0.Px2.p5.8.m8.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.8.m8.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p5.8.m8.1.1.1.1" xref="S3.SS0.SSS0.Px2.p5.8.m8.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.8.m8.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.8.m8.3b"><apply id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3"><lt id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.2.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.2"></lt><list id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1"><ci id="S3.SS0.SSS0.Px2.p5.8.m8.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.2.2">𝑚</ci><apply id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1.2">𝑢</ci><ci id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.1.1.1.3">𝑘</ci></apply></list><apply id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3"><minus id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.1.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3"></minus><apply id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2">superscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.3.3.3.2.2">𝑏</ci><ci id="S3.SS0.SSS0.Px2.p5.8.m8.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.8.m8.1.1.1.1">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.8.m8.3c">\langle m,u_{k}\rangle&lt;-b^{(j)}</annotation></semantics></math>.
This ordering can now be exploited by subtracting the <math id="S3.SS0.SSS0.Px2.p5.9.m9.1" class="ltx_Math" alttext="(j+1)^{th}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.9.m9.1a"><msup id="S3.SS0.SSS0.Px2.p5.9.m9.1.1" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.2.cmml">j</mi><mo id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.2" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.1" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.3" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.9.m9.1b"><apply id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1"><plus id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.1"></plus><ci id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.2">𝑗</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3"><times id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.1"></times><ci id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.2">𝑡</ci><ci id="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p5.9.m9.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.9.m9.1c">(j+1)^{th}</annotation></semantics></math> entry in the gradient from the <math id="S3.SS0.SSS0.Px2.p5.10.m10.1" class="ltx_Math" alttext="j^{th}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.10.m10.1a"><msup id="S3.SS0.SSS0.Px2.p5.10.m10.1.1" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.2" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1.2.cmml">j</mi><mrow id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.2" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.1" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.3" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.10.m10.1b"><apply id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1.2">𝑗</ci><apply id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3"><times id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.1"></times><ci id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.2">𝑡</ci><ci id="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p5.10.m10.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.10.m10.1c">j^{th}</annotation></semantics></math> entry to recover:</p>
<table id="A8.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.2" class="ltx_Math" alttext="\displaystyle\sum_{k=1}^{S}\nabla_{W_{i}^{(j)}}\mathcal{L}_{k}-\sum_{k=1}^{S}\nabla_{W_{i}^{(j+1)}}\mathcal{L}_{k}" display="inline"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.3" xref="S3.E3.m1.2.3.cmml"><mrow id="S3.E3.m1.2.3.2" xref="S3.E3.m1.2.3.2.cmml"><mstyle displaystyle="true" id="S3.E3.m1.2.3.2.1" xref="S3.E3.m1.2.3.2.1.cmml"><munderover id="S3.E3.m1.2.3.2.1a" xref="S3.E3.m1.2.3.2.1.cmml"><mo movablelimits="false" id="S3.E3.m1.2.3.2.1.2.2" xref="S3.E3.m1.2.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.3.2.1.2.3" xref="S3.E3.m1.2.3.2.1.2.3.cmml"><mi id="S3.E3.m1.2.3.2.1.2.3.2" xref="S3.E3.m1.2.3.2.1.2.3.2.cmml">k</mi><mo id="S3.E3.m1.2.3.2.1.2.3.1" xref="S3.E3.m1.2.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.3.2.1.2.3.3" xref="S3.E3.m1.2.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.2.3.2.1.3" xref="S3.E3.m1.2.3.2.1.3.cmml">S</mi></munderover></mstyle><mrow id="S3.E3.m1.2.3.2.2" xref="S3.E3.m1.2.3.2.2.cmml"><msub id="S3.E3.m1.2.3.2.2.1" xref="S3.E3.m1.2.3.2.2.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="S3.E3.m1.2.3.2.2.1.2" xref="S3.E3.m1.2.3.2.2.1.2.cmml">∇</mo><msubsup id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.3.2.cmml">W</mi><mi id="S3.E3.m1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.3.3.cmml">i</mi><mrow id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msub id="S3.E3.m1.2.3.2.2.2" xref="S3.E3.m1.2.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.3.2.2.2.2" xref="S3.E3.m1.2.3.2.2.2.2.cmml">ℒ</mi><mi id="S3.E3.m1.2.3.2.2.2.3" xref="S3.E3.m1.2.3.2.2.2.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E3.m1.2.3.1" xref="S3.E3.m1.2.3.1.cmml">−</mo><mrow id="S3.E3.m1.2.3.3" xref="S3.E3.m1.2.3.3.cmml"><mstyle displaystyle="true" id="S3.E3.m1.2.3.3.1" xref="S3.E3.m1.2.3.3.1.cmml"><munderover id="S3.E3.m1.2.3.3.1a" xref="S3.E3.m1.2.3.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.2.3.3.1.2.2" xref="S3.E3.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.3.3.1.2.3" xref="S3.E3.m1.2.3.3.1.2.3.cmml"><mi id="S3.E3.m1.2.3.3.1.2.3.2" xref="S3.E3.m1.2.3.3.1.2.3.2.cmml">k</mi><mo id="S3.E3.m1.2.3.3.1.2.3.1" xref="S3.E3.m1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.3.3.1.2.3.3" xref="S3.E3.m1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.2.3.3.1.3" xref="S3.E3.m1.2.3.3.1.3.cmml">S</mi></munderover></mstyle><mrow id="S3.E3.m1.2.3.3.2" xref="S3.E3.m1.2.3.3.2.cmml"><msub id="S3.E3.m1.2.3.3.2.1" xref="S3.E3.m1.2.3.3.2.1.cmml"><mo lspace="0.167em" rspace="0.167em" id="S3.E3.m1.2.3.3.2.1.2" xref="S3.E3.m1.2.3.3.2.1.2.cmml">∇</mo><msubsup id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.cmml"><mi id="S3.E3.m1.2.2.1.3.2" xref="S3.E3.m1.2.2.1.3.2.cmml">W</mi><mi id="S3.E3.m1.2.2.1.3.3" xref="S3.E3.m1.2.2.1.3.3.cmml">i</mi><mrow id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml">j</mi><mo id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E3.m1.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></msubsup></msub><msub id="S3.E3.m1.2.3.3.2.2" xref="S3.E3.m1.2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.3.3.2.2.2" xref="S3.E3.m1.2.3.3.2.2.2.cmml">ℒ</mi><mi id="S3.E3.m1.2.3.3.2.2.3" xref="S3.E3.m1.2.3.3.2.2.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.3.cmml" xref="S3.E3.m1.2.3"><minus id="S3.E3.m1.2.3.1.cmml" xref="S3.E3.m1.2.3.1"></minus><apply id="S3.E3.m1.2.3.2.cmml" xref="S3.E3.m1.2.3.2"><apply id="S3.E3.m1.2.3.2.1.cmml" xref="S3.E3.m1.2.3.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.2.1.1.cmml" xref="S3.E3.m1.2.3.2.1">superscript</csymbol><apply id="S3.E3.m1.2.3.2.1.2.cmml" xref="S3.E3.m1.2.3.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.2.1.2.1.cmml" xref="S3.E3.m1.2.3.2.1">subscript</csymbol><sum id="S3.E3.m1.2.3.2.1.2.2.cmml" xref="S3.E3.m1.2.3.2.1.2.2"></sum><apply id="S3.E3.m1.2.3.2.1.2.3.cmml" xref="S3.E3.m1.2.3.2.1.2.3"><eq id="S3.E3.m1.2.3.2.1.2.3.1.cmml" xref="S3.E3.m1.2.3.2.1.2.3.1"></eq><ci id="S3.E3.m1.2.3.2.1.2.3.2.cmml" xref="S3.E3.m1.2.3.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E3.m1.2.3.2.1.2.3.3.cmml" xref="S3.E3.m1.2.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.2.3.2.1.3.cmml" xref="S3.E3.m1.2.3.2.1.3">𝑆</ci></apply><apply id="S3.E3.m1.2.3.2.2.cmml" xref="S3.E3.m1.2.3.2.2"><apply id="S3.E3.m1.2.3.2.2.1.cmml" xref="S3.E3.m1.2.3.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.2.2.1.1.cmml" xref="S3.E3.m1.2.3.2.2.1">subscript</csymbol><ci id="S3.E3.m1.2.3.2.2.1.2.cmml" xref="S3.E3.m1.2.3.2.2.1.2">∇</ci><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.3.2">𝑊</ci><ci id="S3.E3.m1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">𝑗</ci></apply></apply><apply id="S3.E3.m1.2.3.2.2.2.cmml" xref="S3.E3.m1.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.2.2.2.1.cmml" xref="S3.E3.m1.2.3.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.3.2.2.2.2.cmml" xref="S3.E3.m1.2.3.2.2.2.2">ℒ</ci><ci id="S3.E3.m1.2.3.2.2.2.3.cmml" xref="S3.E3.m1.2.3.2.2.2.3">𝑘</ci></apply></apply></apply><apply id="S3.E3.m1.2.3.3.cmml" xref="S3.E3.m1.2.3.3"><apply id="S3.E3.m1.2.3.3.1.cmml" xref="S3.E3.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.1.1.cmml" xref="S3.E3.m1.2.3.3.1">superscript</csymbol><apply id="S3.E3.m1.2.3.3.1.2.cmml" xref="S3.E3.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.1.2.1.cmml" xref="S3.E3.m1.2.3.3.1">subscript</csymbol><sum id="S3.E3.m1.2.3.3.1.2.2.cmml" xref="S3.E3.m1.2.3.3.1.2.2"></sum><apply id="S3.E3.m1.2.3.3.1.2.3.cmml" xref="S3.E3.m1.2.3.3.1.2.3"><eq id="S3.E3.m1.2.3.3.1.2.3.1.cmml" xref="S3.E3.m1.2.3.3.1.2.3.1"></eq><ci id="S3.E3.m1.2.3.3.1.2.3.2.cmml" xref="S3.E3.m1.2.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E3.m1.2.3.3.1.2.3.3.cmml" xref="S3.E3.m1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.2.3.3.1.3.cmml" xref="S3.E3.m1.2.3.3.1.3">𝑆</ci></apply><apply id="S3.E3.m1.2.3.3.2.cmml" xref="S3.E3.m1.2.3.3.2"><apply id="S3.E3.m1.2.3.3.2.1.cmml" xref="S3.E3.m1.2.3.3.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.2.1.1.cmml" xref="S3.E3.m1.2.3.3.2.1">subscript</csymbol><ci id="S3.E3.m1.2.3.3.2.1.2.cmml" xref="S3.E3.m1.2.3.3.2.1.2">∇</ci><apply id="S3.E3.m1.2.2.1.cmml" xref="S3.E3.m1.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1">superscript</csymbol><apply id="S3.E3.m1.2.2.1.3.cmml" xref="S3.E3.m1.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.3.1.cmml" xref="S3.E3.m1.2.2.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.3.2.cmml" xref="S3.E3.m1.2.2.1.3.2">𝑊</ci><ci id="S3.E3.m1.2.2.1.3.3.cmml" xref="S3.E3.m1.2.2.1.3.3">𝑖</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><plus id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1"></plus><ci id="S3.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2">𝑗</ci><cn type="integer" id="S3.E3.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.2.3.3.2.2.cmml" xref="S3.E3.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.2.2.1.cmml" xref="S3.E3.m1.2.3.3.2.2">subscript</csymbol><ci id="S3.E3.m1.2.3.3.2.2.2.cmml" xref="S3.E3.m1.2.3.3.2.2.2">ℒ</ci><ci id="S3.E3.m1.2.3.3.2.2.3.cmml" xref="S3.E3.m1.2.3.3.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\displaystyle\sum_{k=1}^{S}\nabla_{W_{i}^{(j)}}\mathcal{L}_{k}-\sum_{k=1}^{S}\nabla_{W_{i}^{(j+1)}}\mathcal{L}_{k}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3.m2.5" class="ltx_Math" alttext="\displaystyle=\lambda_{i}^{(j)}\cdot u_{k},\qquad\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial b^{(j)}}-\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial b^{(j+1)}}" display="inline"><semantics id="S3.E3.m2.5a"><mrow id="S3.E3.m2.5.5" xref="S3.E3.m2.5.5.cmml"><mi id="S3.E3.m2.5.5.4" xref="S3.E3.m2.5.5.4.cmml"></mi><mo id="S3.E3.m2.5.5.3" xref="S3.E3.m2.5.5.3.cmml">=</mo><mrow id="S3.E3.m2.5.5.2.2" xref="S3.E3.m2.5.5.2.3.cmml"><mrow id="S3.E3.m2.4.4.1.1.1" xref="S3.E3.m2.4.4.1.1.1.cmml"><msubsup id="S3.E3.m2.4.4.1.1.1.2" xref="S3.E3.m2.4.4.1.1.1.2.cmml"><mi id="S3.E3.m2.4.4.1.1.1.2.2.2" xref="S3.E3.m2.4.4.1.1.1.2.2.2.cmml">λ</mi><mi id="S3.E3.m2.4.4.1.1.1.2.2.3" xref="S3.E3.m2.4.4.1.1.1.2.2.3.cmml">i</mi><mrow id="S3.E3.m2.1.1.1.3" xref="S3.E3.m2.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m2.1.1.1.3.1" xref="S3.E3.m2.4.4.1.1.1.2.cmml">(</mo><mi id="S3.E3.m2.1.1.1.1" xref="S3.E3.m2.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E3.m2.1.1.1.3.2" xref="S3.E3.m2.4.4.1.1.1.2.cmml">)</mo></mrow></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m2.4.4.1.1.1.1" xref="S3.E3.m2.4.4.1.1.1.1.cmml">⋅</mo><msub id="S3.E3.m2.4.4.1.1.1.3" xref="S3.E3.m2.4.4.1.1.1.3.cmml"><mi id="S3.E3.m2.4.4.1.1.1.3.2" xref="S3.E3.m2.4.4.1.1.1.3.2.cmml">u</mi><mi id="S3.E3.m2.4.4.1.1.1.3.3" xref="S3.E3.m2.4.4.1.1.1.3.3.cmml">k</mi></msub></mrow><mo rspace="2.167em" id="S3.E3.m2.5.5.2.2.3" xref="S3.E3.m2.5.5.2.3.cmml">,</mo><mrow id="S3.E3.m2.5.5.2.2.2" xref="S3.E3.m2.5.5.2.2.2.cmml"><mrow id="S3.E3.m2.5.5.2.2.2.2" xref="S3.E3.m2.5.5.2.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E3.m2.5.5.2.2.2.2.1" xref="S3.E3.m2.5.5.2.2.2.2.1.cmml"><munderover id="S3.E3.m2.5.5.2.2.2.2.1a" xref="S3.E3.m2.5.5.2.2.2.2.1.cmml"><mo movablelimits="false" id="S3.E3.m2.5.5.2.2.2.2.1.2.2" xref="S3.E3.m2.5.5.2.2.2.2.1.2.2.cmml">∑</mo><mrow id="S3.E3.m2.5.5.2.2.2.2.1.2.3" xref="S3.E3.m2.5.5.2.2.2.2.1.2.3.cmml"><mi id="S3.E3.m2.5.5.2.2.2.2.1.2.3.2" xref="S3.E3.m2.5.5.2.2.2.2.1.2.3.2.cmml">k</mi><mo id="S3.E3.m2.5.5.2.2.2.2.1.2.3.1" xref="S3.E3.m2.5.5.2.2.2.2.1.2.3.1.cmml">=</mo><mn id="S3.E3.m2.5.5.2.2.2.2.1.2.3.3" xref="S3.E3.m2.5.5.2.2.2.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m2.5.5.2.2.2.2.1.3" xref="S3.E3.m2.5.5.2.2.2.2.1.3.cmml">S</mi></munderover></mstyle><mstyle displaystyle="true" id="S3.E3.m2.2.2" xref="S3.E3.m2.2.2.cmml"><mfrac id="S3.E3.m2.2.2a" xref="S3.E3.m2.2.2.cmml"><mrow id="S3.E3.m2.2.2.3" xref="S3.E3.m2.2.2.3.cmml"><mo rspace="0em" id="S3.E3.m2.2.2.3.1" xref="S3.E3.m2.2.2.3.1.cmml">∂</mo><msub id="S3.E3.m2.2.2.3.2" xref="S3.E3.m2.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m2.2.2.3.2.2" xref="S3.E3.m2.2.2.3.2.2.cmml">ℒ</mi><mi id="S3.E3.m2.2.2.3.2.3" xref="S3.E3.m2.2.2.3.2.3.cmml">k</mi></msub></mrow><mrow id="S3.E3.m2.2.2.1" xref="S3.E3.m2.2.2.1.cmml"><mo rspace="0em" id="S3.E3.m2.2.2.1.2" xref="S3.E3.m2.2.2.1.2.cmml">∂</mo><msup id="S3.E3.m2.2.2.1.3" xref="S3.E3.m2.2.2.1.3.cmml"><mi id="S3.E3.m2.2.2.1.3.2" xref="S3.E3.m2.2.2.1.3.2.cmml">b</mi><mrow id="S3.E3.m2.2.2.1.1.1.3" xref="S3.E3.m2.2.2.1.3.cmml"><mo stretchy="false" id="S3.E3.m2.2.2.1.1.1.3.1" xref="S3.E3.m2.2.2.1.3.cmml">(</mo><mi id="S3.E3.m2.2.2.1.1.1.1" xref="S3.E3.m2.2.2.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E3.m2.2.2.1.1.1.3.2" xref="S3.E3.m2.2.2.1.3.cmml">)</mo></mrow></msup></mrow></mfrac></mstyle></mrow><mo id="S3.E3.m2.5.5.2.2.2.1" xref="S3.E3.m2.5.5.2.2.2.1.cmml">−</mo><mrow id="S3.E3.m2.5.5.2.2.2.3" xref="S3.E3.m2.5.5.2.2.2.3.cmml"><mstyle displaystyle="true" id="S3.E3.m2.5.5.2.2.2.3.1" xref="S3.E3.m2.5.5.2.2.2.3.1.cmml"><munderover id="S3.E3.m2.5.5.2.2.2.3.1a" xref="S3.E3.m2.5.5.2.2.2.3.1.cmml"><mo movablelimits="false" id="S3.E3.m2.5.5.2.2.2.3.1.2.2" xref="S3.E3.m2.5.5.2.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m2.5.5.2.2.2.3.1.2.3" xref="S3.E3.m2.5.5.2.2.2.3.1.2.3.cmml"><mi id="S3.E3.m2.5.5.2.2.2.3.1.2.3.2" xref="S3.E3.m2.5.5.2.2.2.3.1.2.3.2.cmml">k</mi><mo id="S3.E3.m2.5.5.2.2.2.3.1.2.3.1" xref="S3.E3.m2.5.5.2.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m2.5.5.2.2.2.3.1.2.3.3" xref="S3.E3.m2.5.5.2.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m2.5.5.2.2.2.3.1.3" xref="S3.E3.m2.5.5.2.2.2.3.1.3.cmml">S</mi></munderover></mstyle><mstyle displaystyle="true" id="S3.E3.m2.3.3" xref="S3.E3.m2.3.3.cmml"><mfrac id="S3.E3.m2.3.3a" xref="S3.E3.m2.3.3.cmml"><mrow id="S3.E3.m2.3.3.3" xref="S3.E3.m2.3.3.3.cmml"><mo rspace="0em" id="S3.E3.m2.3.3.3.1" xref="S3.E3.m2.3.3.3.1.cmml">∂</mo><msub id="S3.E3.m2.3.3.3.2" xref="S3.E3.m2.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m2.3.3.3.2.2" xref="S3.E3.m2.3.3.3.2.2.cmml">ℒ</mi><mi id="S3.E3.m2.3.3.3.2.3" xref="S3.E3.m2.3.3.3.2.3.cmml">k</mi></msub></mrow><mrow id="S3.E3.m2.3.3.1" xref="S3.E3.m2.3.3.1.cmml"><mo rspace="0em" id="S3.E3.m2.3.3.1.2" xref="S3.E3.m2.3.3.1.2.cmml">∂</mo><msup id="S3.E3.m2.3.3.1.3" xref="S3.E3.m2.3.3.1.3.cmml"><mi id="S3.E3.m2.3.3.1.3.2" xref="S3.E3.m2.3.3.1.3.2.cmml">b</mi><mrow id="S3.E3.m2.3.3.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m2.3.3.1.1.1.1.2" xref="S3.E3.m2.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m2.3.3.1.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.cmml"><mi id="S3.E3.m2.3.3.1.1.1.1.1.2" xref="S3.E3.m2.3.3.1.1.1.1.1.2.cmml">j</mi><mo id="S3.E3.m2.3.3.1.1.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E3.m2.3.3.1.1.1.1.1.3" xref="S3.E3.m2.3.3.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E3.m2.3.3.1.1.1.1.3" xref="S3.E3.m2.3.3.1.1.1.1.1.cmml">)</mo></mrow></msup></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.5b"><apply id="S3.E3.m2.5.5.cmml" xref="S3.E3.m2.5.5"><eq id="S3.E3.m2.5.5.3.cmml" xref="S3.E3.m2.5.5.3"></eq><csymbol cd="latexml" id="S3.E3.m2.5.5.4.cmml" xref="S3.E3.m2.5.5.4">absent</csymbol><list id="S3.E3.m2.5.5.2.3.cmml" xref="S3.E3.m2.5.5.2.2"><apply id="S3.E3.m2.4.4.1.1.1.cmml" xref="S3.E3.m2.4.4.1.1.1"><ci id="S3.E3.m2.4.4.1.1.1.1.cmml" xref="S3.E3.m2.4.4.1.1.1.1">⋅</ci><apply id="S3.E3.m2.4.4.1.1.1.2.cmml" xref="S3.E3.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m2.4.4.1.1.1.2.1.cmml" xref="S3.E3.m2.4.4.1.1.1.2">superscript</csymbol><apply id="S3.E3.m2.4.4.1.1.1.2.2.cmml" xref="S3.E3.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m2.4.4.1.1.1.2.2.1.cmml" xref="S3.E3.m2.4.4.1.1.1.2">subscript</csymbol><ci id="S3.E3.m2.4.4.1.1.1.2.2.2.cmml" xref="S3.E3.m2.4.4.1.1.1.2.2.2">𝜆</ci><ci id="S3.E3.m2.4.4.1.1.1.2.2.3.cmml" xref="S3.E3.m2.4.4.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E3.m2.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1">𝑗</ci></apply><apply id="S3.E3.m2.4.4.1.1.1.3.cmml" xref="S3.E3.m2.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.4.4.1.1.1.3.1.cmml" xref="S3.E3.m2.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E3.m2.4.4.1.1.1.3.2.cmml" xref="S3.E3.m2.4.4.1.1.1.3.2">𝑢</ci><ci id="S3.E3.m2.4.4.1.1.1.3.3.cmml" xref="S3.E3.m2.4.4.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.E3.m2.5.5.2.2.2.cmml" xref="S3.E3.m2.5.5.2.2.2"><minus id="S3.E3.m2.5.5.2.2.2.1.cmml" xref="S3.E3.m2.5.5.2.2.2.1"></minus><apply id="S3.E3.m2.5.5.2.2.2.2.cmml" xref="S3.E3.m2.5.5.2.2.2.2"><apply id="S3.E3.m2.5.5.2.2.2.2.1.cmml" xref="S3.E3.m2.5.5.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m2.5.5.2.2.2.2.1.1.cmml" xref="S3.E3.m2.5.5.2.2.2.2.1">superscript</csymbol><apply id="S3.E3.m2.5.5.2.2.2.2.1.2.cmml" xref="S3.E3.m2.5.5.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m2.5.5.2.2.2.2.1.2.1.cmml" xref="S3.E3.m2.5.5.2.2.2.2.1">subscript</csymbol><sum id="S3.E3.m2.5.5.2.2.2.2.1.2.2.cmml" xref="S3.E3.m2.5.5.2.2.2.2.1.2.2"></sum><apply id="S3.E3.m2.5.5.2.2.2.2.1.2.3.cmml" xref="S3.E3.m2.5.5.2.2.2.2.1.2.3"><eq id="S3.E3.m2.5.5.2.2.2.2.1.2.3.1.cmml" xref="S3.E3.m2.5.5.2.2.2.2.1.2.3.1"></eq><ci id="S3.E3.m2.5.5.2.2.2.2.1.2.3.2.cmml" xref="S3.E3.m2.5.5.2.2.2.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E3.m2.5.5.2.2.2.2.1.2.3.3.cmml" xref="S3.E3.m2.5.5.2.2.2.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m2.5.5.2.2.2.2.1.3.cmml" xref="S3.E3.m2.5.5.2.2.2.2.1.3">𝑆</ci></apply><apply id="S3.E3.m2.2.2.cmml" xref="S3.E3.m2.2.2"><divide id="S3.E3.m2.2.2.2.cmml" xref="S3.E3.m2.2.2"></divide><apply id="S3.E3.m2.2.2.3.cmml" xref="S3.E3.m2.2.2.3"><partialdiff id="S3.E3.m2.2.2.3.1.cmml" xref="S3.E3.m2.2.2.3.1"></partialdiff><apply id="S3.E3.m2.2.2.3.2.cmml" xref="S3.E3.m2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.3.2.1.cmml" xref="S3.E3.m2.2.2.3.2">subscript</csymbol><ci id="S3.E3.m2.2.2.3.2.2.cmml" xref="S3.E3.m2.2.2.3.2.2">ℒ</ci><ci id="S3.E3.m2.2.2.3.2.3.cmml" xref="S3.E3.m2.2.2.3.2.3">𝑘</ci></apply></apply><apply id="S3.E3.m2.2.2.1.cmml" xref="S3.E3.m2.2.2.1"><partialdiff id="S3.E3.m2.2.2.1.2.cmml" xref="S3.E3.m2.2.2.1.2"></partialdiff><apply id="S3.E3.m2.2.2.1.3.cmml" xref="S3.E3.m2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.2.2.1.3.1.cmml" xref="S3.E3.m2.2.2.1.3">superscript</csymbol><ci id="S3.E3.m2.2.2.1.3.2.cmml" xref="S3.E3.m2.2.2.1.3.2">𝑏</ci><ci id="S3.E3.m2.2.2.1.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1.1.1">𝑗</ci></apply></apply></apply></apply><apply id="S3.E3.m2.5.5.2.2.2.3.cmml" xref="S3.E3.m2.5.5.2.2.2.3"><apply id="S3.E3.m2.5.5.2.2.2.3.1.cmml" xref="S3.E3.m2.5.5.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m2.5.5.2.2.2.3.1.1.cmml" xref="S3.E3.m2.5.5.2.2.2.3.1">superscript</csymbol><apply id="S3.E3.m2.5.5.2.2.2.3.1.2.cmml" xref="S3.E3.m2.5.5.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m2.5.5.2.2.2.3.1.2.1.cmml" xref="S3.E3.m2.5.5.2.2.2.3.1">subscript</csymbol><sum id="S3.E3.m2.5.5.2.2.2.3.1.2.2.cmml" xref="S3.E3.m2.5.5.2.2.2.3.1.2.2"></sum><apply id="S3.E3.m2.5.5.2.2.2.3.1.2.3.cmml" xref="S3.E3.m2.5.5.2.2.2.3.1.2.3"><eq id="S3.E3.m2.5.5.2.2.2.3.1.2.3.1.cmml" xref="S3.E3.m2.5.5.2.2.2.3.1.2.3.1"></eq><ci id="S3.E3.m2.5.5.2.2.2.3.1.2.3.2.cmml" xref="S3.E3.m2.5.5.2.2.2.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E3.m2.5.5.2.2.2.3.1.2.3.3.cmml" xref="S3.E3.m2.5.5.2.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m2.5.5.2.2.2.3.1.3.cmml" xref="S3.E3.m2.5.5.2.2.2.3.1.3">𝑆</ci></apply><apply id="S3.E3.m2.3.3.cmml" xref="S3.E3.m2.3.3"><divide id="S3.E3.m2.3.3.2.cmml" xref="S3.E3.m2.3.3"></divide><apply id="S3.E3.m2.3.3.3.cmml" xref="S3.E3.m2.3.3.3"><partialdiff id="S3.E3.m2.3.3.3.1.cmml" xref="S3.E3.m2.3.3.3.1"></partialdiff><apply id="S3.E3.m2.3.3.3.2.cmml" xref="S3.E3.m2.3.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.3.2.1.cmml" xref="S3.E3.m2.3.3.3.2">subscript</csymbol><ci id="S3.E3.m2.3.3.3.2.2.cmml" xref="S3.E3.m2.3.3.3.2.2">ℒ</ci><ci id="S3.E3.m2.3.3.3.2.3.cmml" xref="S3.E3.m2.3.3.3.2.3">𝑘</ci></apply></apply><apply id="S3.E3.m2.3.3.1.cmml" xref="S3.E3.m2.3.3.1"><partialdiff id="S3.E3.m2.3.3.1.2.cmml" xref="S3.E3.m2.3.3.1.2"></partialdiff><apply id="S3.E3.m2.3.3.1.3.cmml" xref="S3.E3.m2.3.3.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.3.1.cmml" xref="S3.E3.m2.3.3.1.3">superscript</csymbol><ci id="S3.E3.m2.3.3.1.3.2.cmml" xref="S3.E3.m2.3.3.1.3.2">𝑏</ci><apply id="S3.E3.m2.3.3.1.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1"><plus id="S3.E3.m2.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1"></plus><ci id="S3.E3.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.2">𝑗</ci><cn type="integer" id="S3.E3.m2.3.3.1.1.1.1.1.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.5c">\displaystyle=\lambda_{i}^{(j)}\cdot u_{k},\qquad\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial b^{(j)}}-\sum_{k=1}^{S}\frac{\partial\mathcal{L}_{k}}{\partial b^{(j+1)}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m3.1" class="ltx_Math" alttext="\displaystyle=\lambda_{i}^{(j)}" display="inline"><semantics id="S3.E3.m3.1a"><mrow id="S3.E3.m3.1.2" xref="S3.E3.m3.1.2.cmml"><mi id="S3.E3.m3.1.2.2" xref="S3.E3.m3.1.2.2.cmml"></mi><mo id="S3.E3.m3.1.2.1" xref="S3.E3.m3.1.2.1.cmml">=</mo><msubsup id="S3.E3.m3.1.2.3" xref="S3.E3.m3.1.2.3.cmml"><mi id="S3.E3.m3.1.2.3.2.2" xref="S3.E3.m3.1.2.3.2.2.cmml">λ</mi><mi id="S3.E3.m3.1.2.3.2.3" xref="S3.E3.m3.1.2.3.2.3.cmml">i</mi><mrow id="S3.E3.m3.1.1.1.3" xref="S3.E3.m3.1.2.3.cmml"><mo stretchy="false" id="S3.E3.m3.1.1.1.3.1" xref="S3.E3.m3.1.2.3.cmml">(</mo><mi id="S3.E3.m3.1.1.1.1" xref="S3.E3.m3.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E3.m3.1.1.1.3.2" xref="S3.E3.m3.1.2.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m3.1b"><apply id="S3.E3.m3.1.2.cmml" xref="S3.E3.m3.1.2"><eq id="S3.E3.m3.1.2.1.cmml" xref="S3.E3.m3.1.2.1"></eq><csymbol cd="latexml" id="S3.E3.m3.1.2.2.cmml" xref="S3.E3.m3.1.2.2">absent</csymbol><apply id="S3.E3.m3.1.2.3.cmml" xref="S3.E3.m3.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m3.1.2.3.1.cmml" xref="S3.E3.m3.1.2.3">superscript</csymbol><apply id="S3.E3.m3.1.2.3.2.cmml" xref="S3.E3.m3.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m3.1.2.3.2.1.cmml" xref="S3.E3.m3.1.2.3">subscript</csymbol><ci id="S3.E3.m3.1.2.3.2.2.cmml" xref="S3.E3.m3.1.2.3.2.2">𝜆</ci><ci id="S3.E3.m3.1.2.3.2.3.cmml" xref="S3.E3.m3.1.2.3.2.3">𝑖</ci></apply><ci id="S3.E3.m3.1.1.1.1.cmml" xref="S3.E3.m3.1.1.1.1">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m3.1c">\displaystyle=\lambda_{i}^{(j)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSS0.Px2.p5.12" class="ltx_p">for scalars <math id="S3.SS0.SSS0.Px2.p5.11.m1.1" class="ltx_Math" alttext="\lambda_{i}^{(j)}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.11.m1.1a"><msubsup id="S3.SS0.SSS0.Px2.p5.11.m1.1.2" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p5.11.m1.1.2.2.2" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2.2.2.cmml">λ</mi><mi id="S3.SS0.SSS0.Px2.p5.11.m1.1.2.2.3" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2.2.3.cmml">i</mi><mrow id="S3.SS0.SSS0.Px2.p5.11.m1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.11.m1.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px2.p5.11.m1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p5.11.m1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.11.m1.1b"><apply id="S3.SS0.SSS0.Px2.p5.11.m1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.11.m1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p5.11.m1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.11.m1.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.11.m1.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2.2.2">𝜆</ci><ci id="S3.SS0.SSS0.Px2.p5.11.m1.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS0.SSS0.Px2.p5.11.m1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.11.m1.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.11.m1.1c">\lambda_{i}^{(j)}</annotation></semantics></math>. Assuming the number of embeddings that fulfill this condition is either one or zero, we recover the input vector <math id="S3.SS0.SSS0.Px2.p5.12.m2.1" class="ltx_Math" alttext="u_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p5.12.m2.1a"><msub id="S3.SS0.SSS0.Px2.p5.12.m2.1.1" xref="S3.SS0.SSS0.Px2.p5.12.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p5.12.m2.1.1.2" xref="S3.SS0.SSS0.Px2.p5.12.m2.1.1.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px2.p5.12.m2.1.1.3" xref="S3.SS0.SSS0.Px2.p5.12.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p5.12.m2.1b"><apply id="S3.SS0.SSS0.Px2.p5.12.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.12.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p5.12.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p5.12.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p5.12.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p5.12.m2.1.1.2">𝑢</ci><ci id="S3.SS0.SSS0.Px2.p5.12.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p5.12.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p5.12.m2.1c">u_{k}</annotation></semantics></math> simply by dividing the term of the left of <a href="#S3.E3" title="In Unmixing Gradient Signals: ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">3</span></a> by the term on the right. All embeddings that <span id="S3.SS0.SSS0.Px2.p5.12.1" class="ltx_text ltx_font_italic">collide</span> and fall into the same interval are not easily recoverable.</p>
</div>
<div id="S3.SS0.SSS0.Px2.p6" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px2.p6.9" class="ltx_p">We minimize the probability of a collision by first sampling a Gaussian vector <math id="S3.SS0.SSS0.Px2.p6.1.m1.2" class="ltx_Math" alttext="m\sim\mathcal{N}(\vec{0},\mathbb{1}_{d})" display="inline"><semantics id="S3.SS0.SSS0.Px2.p6.1.m1.2a"><mrow id="S3.SS0.SSS0.Px2.p6.1.m1.2.2" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.cmml"><mi id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.3" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.3.cmml">m</mi><mo id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.2" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.2.cmml">∼</mo><mrow id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.3" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.2" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.2.cmml">​</mo><mrow id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.2" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.2.cmml">(</mo><mover accent="true" id="S3.SS0.SSS0.Px2.p6.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p6.1.m1.1.1.cmml"><mn id="S3.SS0.SSS0.Px2.p6.1.m1.1.1.2" xref="S3.SS0.SSS0.Px2.p6.1.m1.1.1.2.cmml">0</mn><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.1.m1.1.1.1" xref="S3.SS0.SSS0.Px2.p6.1.m1.1.1.1.cmml">→</mo></mover><mo id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.3" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.2.cmml">,</mo><msub id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1.cmml"><mi class="ltx_mathvariant_double-struck" mathvariant="double-struck" id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1.2.cmml">𝟙</mi><mi id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1.3.cmml">d</mi></msub><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.4" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p6.1.m1.2b"><apply id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2"><csymbol cd="latexml" id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.2">similar-to</csymbol><ci id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.3">𝑚</ci><apply id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1"><times id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.2"></times><ci id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.3">𝒩</ci><interval closure="open" id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1"><apply id="S3.SS0.SSS0.Px2.p6.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.1.1"><ci id="S3.SS0.SSS0.Px2.p6.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.1.1.1">→</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p6.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.1.1.2">0</cn></apply><apply id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1.2">double-struck-𝟙</ci><ci id="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.1.m1.2.2.1.1.1.1.3">𝑑</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p6.1.m1.2c">m\sim\mathcal{N}(\vec{0},\mathbb{1}_{d})</annotation></semantics></math> where <math id="S3.SS0.SSS0.Px2.p6.2.m2.1" class="ltx_Math" alttext="d=d_{model}." display="inline"><semantics id="S3.SS0.SSS0.Px2.p6.2.m2.1a"><mrow id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.2.cmml">d</mi><mo id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.1.cmml">=</mo><msub id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.2.cmml">d</mi><mrow id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.cmml"><mi id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.2" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.1" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.3" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.1a" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.4" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.1b" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.5" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.1c" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.6" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.6.cmml">l</mi></mrow></msub></mrow><mo lspace="0em" id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.2" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p6.2.m2.1b"><apply id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1"><eq id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.1"></eq><ci id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.2">𝑑</ci><apply id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.2">𝑑</ci><apply id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3"><times id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.1"></times><ci id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.2.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.2">𝑚</ci><ci id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.3.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.3">𝑜</ci><ci id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.4.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.4">𝑑</ci><ci id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.5.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.5">𝑒</ci><ci id="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.6.cmml" xref="S3.SS0.SSS0.Px2.p6.2.m2.1.1.1.1.3.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p6.2.m2.1c">d=d_{model}.</annotation></semantics></math> We then set the biases to <math id="S3.SS0.SSS0.Px2.p6.3.m3.4" class="ltx_Math" alttext="b_{i}=[c_{i\cdot k},\dots,c_{(i+1)\cdot k-1}]" display="inline"><semantics id="S3.SS0.SSS0.Px2.p6.3.m3.4a"><mrow id="S3.SS0.SSS0.Px2.p6.3.m3.4.4" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.cmml"><msub id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4.cmml"><mi id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4.2" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4.2.cmml">b</mi><mi id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4.3" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4.3.cmml">i</mi></msub><mo id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.3" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.3.cmml">=</mo><mrow id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.3.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.3" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.3.cmml">[</mo><msub id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.2" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.2.cmml">c</mi><mrow id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.2.cmml">i</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.1.cmml">⋅</mo><mi id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.3" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.4" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS0.SSS0.Px2.p6.3.m3.2.2" xref="S3.SS0.SSS0.Px2.p6.3.m3.2.2.cmml">…</mi><mo id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.5" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.3.cmml">,</mo><msub id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.2" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.2.2" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.2.2.cmml">c</mi><mrow id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.055em" stretchy="false" id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.2.cmml">⋅</mo><mi id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.3.cmml">k</mi></mrow><mo id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.2" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.2.cmml">−</mo><mn id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.3" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.6" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p6.3.m3.4b"><apply id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4"><eq id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.3.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.3"></eq><apply id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4.1.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4.2.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4.2">𝑏</ci><ci id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4.3.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.4.3">𝑖</ci></apply><list id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.3.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2"><apply id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.2">𝑐</ci><apply id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3"><ci id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.1">⋅</ci><ci id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.2">𝑖</ci><ci id="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.3.3.1.1.1.3.3">𝑘</ci></apply></apply><ci id="S3.SS0.SSS0.Px2.p6.3.m3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.2.2">…</ci><apply id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.4.4.2.2.2.2">𝑐</ci><apply id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1"><minus id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.2"></minus><apply id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1"><ci id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.2">⋅</ci><apply id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1"><plus id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.1"></plus><ci id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.1.3">𝑘</ci></apply><cn type="integer" id="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.3.m3.1.1.1.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p6.3.m3.4c">b_{i}=[c_{i\cdot k},\dots,c_{(i+1)\cdot k-1}]</annotation></semantics></math>, where <math id="S3.SS0.SSS0.Px2.p6.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS0.SSS0.Px2.p6.4.m4.1a"><mi id="S3.SS0.SSS0.Px2.p6.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p6.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p6.4.m4.1b"><ci id="S3.SS0.SSS0.Px2.p6.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p6.4.m4.1c">k</annotation></semantics></math> is the width of each linear layer and <math id="S3.SS0.SSS0.Px2.p6.5.m5.2" class="ltx_Math" alttext="c_{l}=-\Phi^{-1}(\frac{l}{M})," display="inline"><semantics id="S3.SS0.SSS0.Px2.p6.5.m5.2a"><mrow id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.cmml"><msub id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2.2" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2.2.cmml">c</mi><mi id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2.3" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.1" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.1.cmml">=</mo><mrow id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.cmml"><mo id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3a" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.cmml">−</mo><mrow id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.cmml"><msup id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.cmml"><mi mathvariant="normal" id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.2" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.2.cmml">Φ</mi><mrow id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3.cmml"><mo id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3a" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3.cmml">−</mo><mn id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3.2" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.1" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.1.cmml">​</mo><mrow id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.3.2" xref="S3.SS0.SSS0.Px2.p6.5.m5.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.3.2.1" xref="S3.SS0.SSS0.Px2.p6.5.m5.1.1.cmml">(</mo><mfrac id="S3.SS0.SSS0.Px2.p6.5.m5.1.1" xref="S3.SS0.SSS0.Px2.p6.5.m5.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p6.5.m5.1.1.2" xref="S3.SS0.SSS0.Px2.p6.5.m5.1.1.2.cmml">l</mi><mi id="S3.SS0.SSS0.Px2.p6.5.m5.1.1.3" xref="S3.SS0.SSS0.Px2.p6.5.m5.1.1.3.cmml">M</mi></mfrac><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.3.2.2" xref="S3.SS0.SSS0.Px2.p6.5.m5.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.2" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p6.5.m5.2b"><apply id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1"><eq id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.1"></eq><apply id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2.2">𝑐</ci><ci id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.2.3">𝑙</ci></apply><apply id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3"><minus id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3"></minus><apply id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2"><times id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.1.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.1"></times><apply id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2">superscript</csymbol><ci id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.2">Φ</ci><apply id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3"><minus id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3.1.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3"></minus><cn type="integer" id="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3.2.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.2.3.2">1</cn></apply></apply><apply id="S3.SS0.SSS0.Px2.p6.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.3.2"><divide id="S3.SS0.SSS0.Px2.p6.5.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.2.2.1.1.3.2.3.2"></divide><ci id="S3.SS0.SSS0.Px2.p6.5.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.1.1.2">𝑙</ci><ci id="S3.SS0.SSS0.Px2.p6.5.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.5.m5.1.1.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p6.5.m5.2c">c_{l}=-\Phi^{-1}(\frac{l}{M}),</annotation></semantics></math> where <math id="S3.SS0.SSS0.Px2.p6.6.m6.1" class="ltx_Math" alttext="\Phi^{-1}" display="inline"><semantics id="S3.SS0.SSS0.Px2.p6.6.m6.1a"><msup id="S3.SS0.SSS0.Px2.p6.6.m6.1.1" xref="S3.SS0.SSS0.Px2.p6.6.m6.1.1.cmml"><mi mathvariant="normal" id="S3.SS0.SSS0.Px2.p6.6.m6.1.1.2" xref="S3.SS0.SSS0.Px2.p6.6.m6.1.1.2.cmml">Φ</mi><mrow id="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3" xref="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3.cmml"><mo id="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3a" xref="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3.cmml">−</mo><mn id="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3.2" xref="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p6.6.m6.1b"><apply id="S3.SS0.SSS0.Px2.p6.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p6.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.6.m6.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px2.p6.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.6.m6.1.1.2">Φ</ci><apply id="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3"><minus id="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3"></minus><cn type="integer" id="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p6.6.m6.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p6.6.m6.1c">\Phi^{-1}</annotation></semantics></math> is the inverse of a Gaussian CDF and <math id="S3.SS0.SSS0.Px2.p6.7.m7.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS0.SSS0.Px2.p6.7.m7.1a"><mi id="S3.SS0.SSS0.Px2.p6.7.m7.1.1" xref="S3.SS0.SSS0.Px2.p6.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p6.7.m7.1b"><ci id="S3.SS0.SSS0.Px2.p6.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p6.7.m7.1c">M</annotation></semantics></math> is the sum over the widths of all included Transformer blocks. This uniformly distributes the values of <math id="S3.SS0.SSS0.Px2.p6.8.m8.2" class="ltx_Math" alttext="\langle m,u_{k}\rangle" display="inline"><semantics id="S3.SS0.SSS0.Px2.p6.8.m8.2a"><mrow id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.2" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.2.cmml">⟨</mo><mi id="S3.SS0.SSS0.Px2.p6.8.m8.1.1" xref="S3.SS0.SSS0.Px2.p6.8.m8.1.1.cmml">m</mi><mo id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.3" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.2.cmml">,</mo><msub id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1.2" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1.3" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.4" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.2.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p6.8.m8.2b"><list id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1"><ci id="S3.SS0.SSS0.Px2.p6.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.8.m8.1.1">𝑚</ci><apply id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1.2">𝑢</ci><ci id="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.8.m8.2.2.1.1.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p6.8.m8.2c">\langle m,u_{k}\rangle</annotation></semantics></math> over the bins created by the bias vector. If the width of the first linear layer in each block is larger than the number of tokens, collisions will be unlikely.
We can estimate the rough mean and variance of {<math id="S3.SS0.SSS0.Px2.p6.9.m9.2" class="ltx_Math" alttext="\langle m,u_{k}\rangle" display="inline"><semantics id="S3.SS0.SSS0.Px2.p6.9.m9.2a"><mrow id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.2" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.2.cmml">⟨</mo><mi id="S3.SS0.SSS0.Px2.p6.9.m9.1.1" xref="S3.SS0.SSS0.Px2.p6.9.m9.1.1.cmml">m</mi><mo id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.3" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.2.cmml">,</mo><msub id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1.2" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1.3" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.4" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.2.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p6.9.m9.2b"><list id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1"><ci id="S3.SS0.SSS0.Px2.p6.9.m9.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.9.m9.1.1">𝑚</ci><apply id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1.2">𝑢</ci><ci id="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p6.9.m9.2.2.1.1.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p6.9.m9.2c">\langle m,u_{k}\rangle</annotation></semantics></math>} from either a small volume of public text or a random stream of tokens, see <a href="#A4" title="Appendix D Measurement Normalization ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Disambiguating Multiple Sequences</h5>

<div id="S3.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px3.p1.3" class="ltx_p">Recovering multiple sequences – either from user data comprising multiple separate sentences of tokens, or aggregates of multiple users – presents the most difficult task for the attacker. Naively using the strategy described so far can only recover a partially ordered set of tokens. For example, if a model update consists of five user sequences, then the attacker recovers five tokens at position 0, five tokens at position 1, and so on, because positional embeddings repeat in each sequence. Re-grouping these tokens into salient sequences quickly becomes intractable as the number of possible groupings grows as <math id="S3.SS0.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="n^{l}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.1.m1.1a"><msup id="S3.SS0.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.2" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml">n</mi><mi id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.3" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.1.m1.1b"><apply id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.2">𝑛</ci><ci id="S3.SS0.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.1.m1.1c">n^{l}</annotation></semantics></math> for <math id="S3.SS0.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.2.m2.1a"><mi id="S3.SS0.SSS0.Px3.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.2.m2.1b"><ci id="S3.SS0.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.2.m2.1c">n</annotation></semantics></math> sequences of length <math id="S3.SS0.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS0.SSS0.Px3.p1.3.m3.1a"><mi id="S3.SS0.SSS0.Px3.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p1.3.m3.1b"><ci id="S3.SS0.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px3.p1.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p1.3.m3.1c">l</annotation></semantics></math>. Further complicating matters for the attacker is that no learned parameters (and thus no parameters returning gradients) operate on the entire length of a sequence in the Transformer model. In fact, the only interaction between embeddings from the same sequence comes in the scaled dot product attention mechanism.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2201.12675/assets/assets/mha_diagram.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="264" height="91" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>A high-level schematic of MHA manipulation. The MHA block attends to the first word identically for every input sequence, encoding a part of the first token for each embedding in the entire sequence.
</figcaption>
</figure>
<div id="S3.SS0.SSS0.Px3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px3.p2.1" class="ltx_p">Thus, if any malicious modification can be made to encode sequence information into embeddings, it must utilize the attention mechanism of Transformers. We describe a mechanism by which an attacker can disambiguate user sequences, even when model updates are aggregated over a large number of separate sequences. At a high level, we introduce a strategy that encodes unique information about each sequence into a predefined location in the embedding of each token in the sequence. Then, we can read out a unique quantity for each sequence and thus assign tokens to separate sequences. This behavior is illustrated in <a href="#S3.F4" title="In Disambiguating Multiple Sequences ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS0.SSS0.Px3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px3.p3.12" class="ltx_p">Let <math id="S3.SS0.SSS0.Px3.p3.1.m1.3" class="ltx_Math" alttext="W_{Q},W_{K},W_{V}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.1.m1.3a"><mrow id="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3" xref="S3.SS0.SSS0.Px3.p3.1.m1.3.3.4.cmml"><msub id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.3.cmml">Q</mi></msub><mo id="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.4" xref="S3.SS0.SSS0.Px3.p3.1.m1.3.3.4.cmml">,</mo><msub id="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2" xref="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2.2" xref="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2.3" xref="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2.3.cmml">K</mi></msub><mo id="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.5" xref="S3.SS0.SSS0.Px3.p3.1.m1.3.3.4.cmml">,</mo><msub id="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3" xref="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3.cmml"><mi id="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3.2" xref="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3.3" xref="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3.3.cmml">V</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.1.m1.3b"><list id="S3.SS0.SSS0.Px3.p3.1.m1.3.3.4.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3"><apply id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.2">𝑊</ci><ci id="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2.2">𝑊</ci><ci id="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.2.2.2.2.3">𝐾</ci></apply><apply id="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3.1.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3.2.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3.2">𝑊</ci><ci id="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3.3.cmml" xref="S3.SS0.SSS0.Px3.p3.1.m1.3.3.3.3.3">𝑉</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.1.m1.3c">W_{Q},W_{K},W_{V}</annotation></semantics></math> represent the query, key, and value weight matrices respectively, and let <math id="S3.SS0.SSS0.Px3.p3.2.m2.3" class="ltx_Math" alttext="b_{Q},b_{K},b_{V}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.2.m2.3a"><mrow id="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3" xref="S3.SS0.SSS0.Px3.p3.2.m2.3.3.4.cmml"><msub id="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1" xref="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1.2.cmml">b</mi><mi id="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1.3.cmml">Q</mi></msub><mo id="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.4" xref="S3.SS0.SSS0.Px3.p3.2.m2.3.3.4.cmml">,</mo><msub id="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2" xref="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2.2" xref="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2.2.cmml">b</mi><mi id="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2.3" xref="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2.3.cmml">K</mi></msub><mo id="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.5" xref="S3.SS0.SSS0.Px3.p3.2.m2.3.3.4.cmml">,</mo><msub id="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3" xref="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3.cmml"><mi id="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3.2" xref="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3.2.cmml">b</mi><mi id="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3.3" xref="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3.3.cmml">V</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.2.m2.3b"><list id="S3.SS0.SSS0.Px3.p3.2.m2.3.3.4.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3"><apply id="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1.2">𝑏</ci><ci id="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2.2">𝑏</ci><ci id="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.2.2.2.2.3">𝐾</ci></apply><apply id="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3.1.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3.2.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3.2">𝑏</ci><ci id="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3.3.cmml" xref="S3.SS0.SSS0.Px3.p3.2.m2.3.3.3.3.3">𝑉</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.2.m2.3c">b_{Q},b_{K},b_{V}</annotation></semantics></math> represent their biases. For simplicity of presentation, we explain this attack on a single head, but it is easily adapted to multi-head attention. We first set the <math id="S3.SS0.SSS0.Px3.p3.3.m3.1" class="ltx_Math" alttext="W_{K}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.3.m3.1a"><msub id="S3.SS0.SSS0.Px3.p3.3.m3.1.1" xref="S3.SS0.SSS0.Px3.p3.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p3.3.m3.1.1.2" xref="S3.SS0.SSS0.Px3.p3.3.m3.1.1.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px3.p3.3.m3.1.1.3" xref="S3.SS0.SSS0.Px3.p3.3.m3.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.3.m3.1b"><apply id="S3.SS0.SSS0.Px3.p3.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.3.m3.1.1.2">𝑊</ci><ci id="S3.SS0.SSS0.Px3.p3.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.3.m3.1c">W_{K}</annotation></semantics></math> matrix to the identity (<math id="S3.SS0.SSS0.Px3.p3.4.m4.1" class="ltx_Math" alttext="\mathbb{1}_{d_{model}}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.4.m4.1a"><msub id="S3.SS0.SSS0.Px3.p3.4.m4.1.1" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.cmml"><mi class="ltx_mathvariant_double-struck" mathvariant="double-struck" id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.2" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.2.cmml">𝟙</mi><msub id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.2" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.2.cmml">d</mi><mrow id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.cmml"><mi id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.2" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.1" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.3" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.1a" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.4" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.1b" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.5" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.1c" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.6" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.6.cmml">l</mi></mrow></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.4.m4.1b"><apply id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.2">double-struck-𝟙</ci><apply id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.2">𝑑</ci><apply id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3"><times id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.1"></times><ci id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.2">𝑚</ci><ci id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.3">𝑜</ci><ci id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.4.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.4">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.5.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.5">𝑒</ci><ci id="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.6.cmml" xref="S3.SS0.SSS0.Px3.p3.4.m4.1.1.3.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.4.m4.1c">\mathbb{1}_{d_{model}}</annotation></semantics></math>), and <math id="S3.SS0.SSS0.Px3.p3.5.m5.1" class="ltx_Math" alttext="b_{K}=\vec{0}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.5.m5.1a"><mrow id="S3.SS0.SSS0.Px3.p3.5.m5.1.1" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.cmml"><msub id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2.2" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2.2.cmml">b</mi><mi id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2.3" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2.3.cmml">K</mi></msub><mo id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.1" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.1.cmml">=</mo><mover accent="true" id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3.cmml"><mn id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3.2" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3.2.cmml">0</mn><mo stretchy="false" id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3.1" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3.1.cmml">→</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.5.m5.1b"><apply id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1"><eq id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.1"></eq><apply id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2.2">𝑏</ci><ci id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.2.3">𝐾</ci></apply><apply id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3"><ci id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3.1">→</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p3.5.m5.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.5.m5.1c">b_{K}=\vec{0}</annotation></semantics></math>. This leaves incoming embeddings unaltered. Then, we set <math id="S3.SS0.SSS0.Px3.p3.6.m6.1" class="ltx_Math" alttext="W_{Q}=\vec{0}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.6.m6.1a"><mrow id="S3.SS0.SSS0.Px3.p3.6.m6.1.1" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.cmml"><msub id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2.2" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2.3" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2.3.cmml">Q</mi></msub><mo id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.1" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.1.cmml">=</mo><mover accent="true" id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3.cmml"><mn id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3.2" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3.2.cmml">0</mn><mo stretchy="false" id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3.1" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3.1.cmml">→</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.6.m6.1b"><apply id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1"><eq id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.1"></eq><apply id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2.2">𝑊</ci><ci id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.2.3">𝑄</ci></apply><apply id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3"><ci id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3.1">→</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p3.6.m6.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.6.m6.1c">W_{Q}=\vec{0}</annotation></semantics></math>, and <math id="S3.SS0.SSS0.Px3.p3.7.m7.1" class="ltx_Math" alttext="b_{Q}=\gamma\cdot\vec{p}_{0}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.7.m7.1a"><mrow id="S3.SS0.SSS0.Px3.p3.7.m7.1.1" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.cmml"><msub id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2.2" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2.2.cmml">b</mi><mi id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2.3" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2.3.cmml">Q</mi></msub><mo id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.1" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.1.cmml">=</mo><mrow id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.2" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.2.cmml">γ</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.1" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.1.cmml">⋅</mo><msub id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.cmml"><mover accent="true" id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2.cmml"><mi id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2.2" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2.2.cmml">p</mi><mo stretchy="false" id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2.1" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2.1.cmml">→</mo></mover><mn id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.3" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.3.cmml">0</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.7.m7.1b"><apply id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1"><eq id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.1"></eq><apply id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2.2">𝑏</ci><ci id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.2.3">𝑄</ci></apply><apply id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3"><ci id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.1">⋅</ci><ci id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.2">𝛾</ci><apply id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3">subscript</csymbol><apply id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2"><ci id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2.1.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2.1">→</ci><ci id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.2.2">𝑝</ci></apply><cn type="integer" id="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.3.cmml" xref="S3.SS0.SSS0.Px3.p3.7.m7.1.1.3.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.7.m7.1c">b_{Q}=\gamma\cdot\vec{p}_{0}</annotation></semantics></math> where <math id="S3.SS0.SSS0.Px3.p3.8.m8.1" class="ltx_Math" alttext="\vec{p}_{0}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.8.m8.1a"><msub id="S3.SS0.SSS0.Px3.p3.8.m8.1.1" xref="S3.SS0.SSS0.Px3.p3.8.m8.1.1.cmml"><mover accent="true" id="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2" xref="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2.2" xref="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2.2.cmml">p</mi><mo stretchy="false" id="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2.1" xref="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2.1.cmml">→</mo></mover><mn id="S3.SS0.SSS0.Px3.p3.8.m8.1.1.3" xref="S3.SS0.SSS0.Px3.p3.8.m8.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.8.m8.1b"><apply id="S3.SS0.SSS0.Px3.p3.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.8.m8.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.8.m8.1.1">subscript</csymbol><apply id="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2"><ci id="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2.1">→</ci><ci id="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.8.m8.1.1.2.2">𝑝</ci></apply><cn type="integer" id="S3.SS0.SSS0.Px3.p3.8.m8.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.8.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.8.m8.1c">\vec{p}_{0}</annotation></semantics></math> is the first positional encoding. Here we choose the first position vector for simplicity, but there are many potential choices for the identifying vector. This query matrix then transforms each embedding identically to be a scaled version of the first positional encoding. We then set <math id="S3.SS0.SSS0.Px3.p3.9.m9.1" class="ltx_Math" alttext="W_{V}=\mathbb{1}_{d^{\prime}}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.9.m9.1a"><mrow id="S3.SS0.SSS0.Px3.p3.9.m9.1.1" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.cmml"><msub id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2.2" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2.3" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2.3.cmml">V</mi></msub><mo id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.1" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.1.cmml">=</mo><msub id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.cmml"><mi class="ltx_mathvariant_double-struck" mathvariant="double-struck" id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.2" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.2.cmml">𝟙</mi><msup id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3.cmml"><mi id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3.2" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3.2.cmml">d</mi><mo id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3.3" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3.3.cmml">′</mo></msup></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.9.m9.1b"><apply id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1"><eq id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.1"></eq><apply id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2.2">𝑊</ci><ci id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.2.3">𝑉</ci></apply><apply id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.2">double-struck-𝟙</ci><apply id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3.2.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3.2">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3.3.cmml" xref="S3.SS0.SSS0.Px3.p3.9.m9.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.9.m9.1c">W_{V}=\mathbb{1}_{d^{\prime}}</annotation></semantics></math> to be a partial identity (identity in the first <math id="S3.SS0.SSS0.Px3.p3.10.m10.1" class="ltx_Math" alttext="d^{\prime}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.10.m10.1a"><msup id="S3.SS0.SSS0.Px3.p3.10.m10.1.1" xref="S3.SS0.SSS0.Px3.p3.10.m10.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p3.10.m10.1.1.2" xref="S3.SS0.SSS0.Px3.p3.10.m10.1.1.2.cmml">d</mi><mo id="S3.SS0.SSS0.Px3.p3.10.m10.1.1.3" xref="S3.SS0.SSS0.Px3.p3.10.m10.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.10.m10.1b"><apply id="S3.SS0.SSS0.Px3.p3.10.m10.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.10.m10.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.10.m10.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.10.m10.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.10.m10.1.1.2">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p3.10.m10.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.10.m10.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.10.m10.1c">d^{\prime}</annotation></semantics></math> entries where <math id="S3.SS0.SSS0.Px3.p3.11.m11.1" class="ltx_Math" alttext="d^{\prime}\leq d" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.11.m11.1a"><mrow id="S3.SS0.SSS0.Px3.p3.11.m11.1.1" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.cmml"><msup id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2.2" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2.2.cmml">d</mi><mo id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2.3" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.1" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.1.cmml">≤</mo><mi id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.3" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.11.m11.1b"><apply id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1"><leq id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.1"></leq><apply id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2.2">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.2.3">′</ci></apply><ci id="S3.SS0.SSS0.Px3.p3.11.m11.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.11.m11.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.11.m11.1c">d^{\prime}\leq d</annotation></semantics></math> is a hyperparameter that the server controls). Finally, we set <math id="S3.SS0.SSS0.Px3.p3.12.m12.1" class="ltx_Math" alttext="b_{v}=\vec{0}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p3.12.m12.1a"><mrow id="S3.SS0.SSS0.Px3.p3.12.m12.1.1" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.cmml"><msub id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2.2" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2.2.cmml">b</mi><mi id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2.3" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2.3.cmml">v</mi></msub><mo id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.1" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.1.cmml">=</mo><mover accent="true" id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3.cmml"><mn id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3.2" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3.2.cmml">0</mn><mo stretchy="false" id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3.1" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3.1.cmml">→</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p3.12.m12.1b"><apply id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1"><eq id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.1"></eq><apply id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2.2">𝑏</ci><ci id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.2.3">𝑣</ci></apply><apply id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3"><ci id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3.1">→</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p3.12.m12.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p3.12.m12.1c">b_{v}=\vec{0}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS0.SSS0.Px3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px3.p4.9" class="ltx_p">Now, we investigate how these changes transform an incoming sequence of embeddings. Let <math id="S3.SS0.SSS0.Px3.p4.1.m1.1" class="ltx_Math" alttext="\{u_{k}\}_{i=0}^{l-1}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.1.m1.1a"><msubsup id="S3.SS0.SSS0.Px3.p4.1.m1.1.1" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.2" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.1" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.3" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.3.cmml">0</mn></mrow><mrow id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.2" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.2.cmml">l</mi><mo id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.1" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.1.cmml">−</mo><mn id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.3" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.1.m1.1b"><apply id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1">subscript</csymbol><set id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1"><apply id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.2">𝑢</ci><ci id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3"><eq id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.1"></eq><ci id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.1.3.3">0</cn></apply></apply><apply id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3"><minus id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.1"></minus><ci id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p4.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.1.m1.1c">\{u_{k}\}_{i=0}^{l-1}</annotation></semantics></math> be embeddings for a sequence of length <math id="S3.SS0.SSS0.Px3.p4.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.2.m2.1a"><mi id="S3.SS0.SSS0.Px3.p4.2.m2.1.1" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.2.m2.1b"><ci id="S3.SS0.SSS0.Px3.p4.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.2.m2.1c">l</annotation></semantics></math> that enters the attention mechanism. <math id="S3.SS0.SSS0.Px3.p4.3.m3.1" class="ltx_Math" alttext="u_{0}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.3.m3.1a"><msub id="S3.SS0.SSS0.Px3.p4.3.m3.1.1" xref="S3.SS0.SSS0.Px3.p4.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.3.m3.1.1.2" xref="S3.SS0.SSS0.Px3.p4.3.m3.1.1.2.cmml">u</mi><mn id="S3.SS0.SSS0.Px3.p4.3.m3.1.1.3" xref="S3.SS0.SSS0.Px3.p4.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.3.m3.1b"><apply id="S3.SS0.SSS0.Px3.p4.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.3.m3.1.1.2">𝑢</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p4.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.3.m3.1c">u_{0}</annotation></semantics></math> is the embedding corresponding to the first token in the sequence, so <math id="S3.SS0.SSS0.Px3.p4.4.m4.1" class="ltx_Math" alttext="u_{0}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.4.m4.1a"><msub id="S3.SS0.SSS0.Px3.p4.4.m4.1.1" xref="S3.SS0.SSS0.Px3.p4.4.m4.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.4.m4.1.1.2" xref="S3.SS0.SSS0.Px3.p4.4.m4.1.1.2.cmml">u</mi><mn id="S3.SS0.SSS0.Px3.p4.4.m4.1.1.3" xref="S3.SS0.SSS0.Px3.p4.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.4.m4.1b"><apply id="S3.SS0.SSS0.Px3.p4.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.4.m4.1.1.2">𝑢</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p4.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.4.m4.1c">u_{0}</annotation></semantics></math> is made up of the token embedding for the first token in the sequence, and the first positional encoding. <math id="S3.SS0.SSS0.Px3.p4.5.m5.1" class="ltx_Math" alttext="W_{K}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.5.m5.1a"><msub id="S3.SS0.SSS0.Px3.p4.5.m5.1.1" xref="S3.SS0.SSS0.Px3.p4.5.m5.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.5.m5.1.1.2" xref="S3.SS0.SSS0.Px3.p4.5.m5.1.1.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px3.p4.5.m5.1.1.3" xref="S3.SS0.SSS0.Px3.p4.5.m5.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.5.m5.1b"><apply id="S3.SS0.SSS0.Px3.p4.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.5.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.5.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.5.m5.1.1.2">𝑊</ci><ci id="S3.SS0.SSS0.Px3.p4.5.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.5.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.5.m5.1c">W_{K}</annotation></semantics></math> produces keys <math id="S3.SS0.SSS0.Px3.p4.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.6.m6.1a"><mi id="S3.SS0.SSS0.Px3.p4.6.m6.1.1" xref="S3.SS0.SSS0.Px3.p4.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.6.m6.1b"><ci id="S3.SS0.SSS0.Px3.p4.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.6.m6.1c">K</annotation></semantics></math> that exactly correspond to the incoming embeddings, however, <math id="S3.SS0.SSS0.Px3.p4.7.m7.2" class="ltx_Math" alttext="W_{Q},b_{Q}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.7.m7.2a"><mrow id="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2" xref="S3.SS0.SSS0.Px3.p4.7.m7.2.2.3.cmml"><msub id="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1.2.cmml">W</mi><mi id="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1.3.cmml">Q</mi></msub><mo id="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.3" xref="S3.SS0.SSS0.Px3.p4.7.m7.2.2.3.cmml">,</mo><msub id="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2" xref="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2.2" xref="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2.2.cmml">b</mi><mi id="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2.3" xref="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2.3.cmml">Q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.7.m7.2b"><list id="S3.SS0.SSS0.Px3.p4.7.m7.2.2.3.cmml" xref="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2"><apply id="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1.2">𝑊</ci><ci id="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.7.m7.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2.2">𝑏</ci><ci id="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px3.p4.7.m7.2.2.2.2.3">𝑄</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.7.m7.2c">W_{Q},b_{Q}</annotation></semantics></math> collapses the embeddings to produce <math id="S3.SS0.SSS0.Px3.p4.8.m8.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.8.m8.1a"><mi id="S3.SS0.SSS0.Px3.p4.8.m8.1.1" xref="S3.SS0.SSS0.Px3.p4.8.m8.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.8.m8.1b"><ci id="S3.SS0.SSS0.Px3.p4.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.8.m8.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.8.m8.1c">Q</annotation></semantics></math>, consisting of <math id="S3.SS0.SSS0.Px3.p4.9.m9.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.9.m9.1a"><mi id="S3.SS0.SSS0.Px3.p4.9.m9.1.1" xref="S3.SS0.SSS0.Px3.p4.9.m9.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.9.m9.1b"><ci id="S3.SS0.SSS0.Px3.p4.9.m9.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.9.m9.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.9.m9.1c">l</annotation></semantics></math> identical copies of a single vector, the first positional encoding. Then, when the attention weights are calculated as:</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.3" class="ltx_Math" alttext="\operatorname*{softmax}\bigg{(}\frac{QK^{T}}{\sqrt{d_{k}}}\bigg{)}," display="block"><semantics id="S3.Ex1.m1.3a"><mrow id="S3.Ex1.m1.3.3.1"><mrow id="S3.Ex1.m1.3.3.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.cmml"><mo rspace="0em" id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">softmax</mo><mrow id="S3.Ex1.m1.3.3.1.1.2.1" xref="S3.Ex1.m1.3.3.1.1.1.cmml"><mo maxsize="210%" minsize="210%" id="S3.Ex1.m1.3.3.1.1.2.1.1" xref="S3.Ex1.m1.3.3.1.1.1.cmml">(</mo><mfrac id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml"><mrow id="S3.Ex1.m1.2.2.2" xref="S3.Ex1.m1.2.2.2.cmml"><mi id="S3.Ex1.m1.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.cmml">Q</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.2.2.2.1" xref="S3.Ex1.m1.2.2.2.1.cmml">​</mo><msup id="S3.Ex1.m1.2.2.2.3" xref="S3.Ex1.m1.2.2.2.3.cmml"><mi id="S3.Ex1.m1.2.2.2.3.2" xref="S3.Ex1.m1.2.2.2.3.2.cmml">K</mi><mi id="S3.Ex1.m1.2.2.2.3.3" xref="S3.Ex1.m1.2.2.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S3.Ex1.m1.2.2.3" xref="S3.Ex1.m1.2.2.3.cmml"><msub id="S3.Ex1.m1.2.2.3.2" xref="S3.Ex1.m1.2.2.3.2.cmml"><mi id="S3.Ex1.m1.2.2.3.2.2" xref="S3.Ex1.m1.2.2.3.2.2.cmml">d</mi><mi id="S3.Ex1.m1.2.2.3.2.3" xref="S3.Ex1.m1.2.2.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo maxsize="210%" minsize="210%" id="S3.Ex1.m1.3.3.1.1.2.1.2" xref="S3.Ex1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b"><apply id="S3.Ex1.m1.3.3.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.2"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">softmax</ci><apply id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2"><divide id="S3.Ex1.m1.2.2.1.cmml" xref="S3.Ex1.m1.2.2"></divide><apply id="S3.Ex1.m1.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2"><times id="S3.Ex1.m1.2.2.2.1.cmml" xref="S3.Ex1.m1.2.2.2.1"></times><ci id="S3.Ex1.m1.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2">𝑄</ci><apply id="S3.Ex1.m1.2.2.2.3.cmml" xref="S3.Ex1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.3.1.cmml" xref="S3.Ex1.m1.2.2.2.3">superscript</csymbol><ci id="S3.Ex1.m1.2.2.2.3.2.cmml" xref="S3.Ex1.m1.2.2.2.3.2">𝐾</ci><ci id="S3.Ex1.m1.2.2.2.3.3.cmml" xref="S3.Ex1.m1.2.2.2.3.3">𝑇</ci></apply></apply><apply id="S3.Ex1.m1.2.2.3.cmml" xref="S3.Ex1.m1.2.2.3"><root id="S3.Ex1.m1.2.2.3a.cmml" xref="S3.Ex1.m1.2.2.3"></root><apply id="S3.Ex1.m1.2.2.3.2.cmml" xref="S3.Ex1.m1.2.2.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.3.2.1.cmml" xref="S3.Ex1.m1.2.2.3.2">subscript</csymbol><ci id="S3.Ex1.m1.2.2.3.2.2.cmml" xref="S3.Ex1.m1.2.2.3.2.2">𝑑</ci><ci id="S3.Ex1.m1.2.2.3.2.3.cmml" xref="S3.Ex1.m1.2.2.3.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">\operatorname*{softmax}\bigg{(}\frac{QK^{T}}{\sqrt{d_{k}}}\bigg{)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSS0.Px3.p4.18" class="ltx_p">the attacker finds that the first embedding dominates the attention weights for all the embeddings, as the query vectors all correlate with the first embedding the most. In fact, the <math id="S3.SS0.SSS0.Px3.p4.10.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.10.m1.1a"><mi id="S3.SS0.SSS0.Px3.p4.10.m1.1.1" xref="S3.SS0.SSS0.Px3.p4.10.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.10.m1.1b"><ci id="S3.SS0.SSS0.Px3.p4.10.m1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.10.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.10.m1.1c">\gamma</annotation></semantics></math> parameter can effectively turn the attention weights to a delta function on the first position. Finally, when the attention weights are used to combine the values <math id="S3.SS0.SSS0.Px3.p4.11.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.11.m2.1a"><mi id="S3.SS0.SSS0.Px3.p4.11.m2.1.1" xref="S3.SS0.SSS0.Px3.p4.11.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.11.m2.1b"><ci id="S3.SS0.SSS0.Px3.p4.11.m2.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.11.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.11.m2.1c">V</annotation></semantics></math> with the embeddings, by construction, a part of the embedding for the first word in the sequence is identically added to each other word in that sequence. So the embeddings are transformed as <math id="S3.SS0.SSS0.Px3.p4.12.m3.4" class="ltx_Math" alttext="\{x_{i}\}_{i=0}^{l-1}\rightarrow\{x_{i}+x_{0,d^{\prime}}\}_{i=0}^{l-1}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.12.m3.4a"><mrow id="S3.SS0.SSS0.Px3.p4.12.m3.4.4" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.cmml"><msubsup id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.cmml"><mrow id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.2.cmml">{</mo><msub id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.3.cmml">0</mn></mrow><mrow id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.2.cmml">l</mi><mo id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.1.cmml">−</mo><mn id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.3.cmml">→</mo><msubsup id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.cmml"><mrow id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.2.cmml">{</mo><mrow id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.cmml"><msub id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.1.cmml">+</mo><msub id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.3.cmml"><mn id="S3.SS0.SSS0.Px3.p4.12.m3.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.1.1.1.1.cmml">0</mn><mo id="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.3.cmml">,</mo><msup id="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1.2.cmml">d</mi><mo id="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1.3.cmml">′</mo></msup></mrow></msub></mrow><mo stretchy="false" id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.3.cmml">0</mn></mrow><mrow id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.cmml"><mi id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.2" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.2.cmml">l</mi><mo id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.1" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.1.cmml">−</mo><mn id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.3" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.12.m3.4b"><apply id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4"><ci id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.3">→</ci><apply id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1">subscript</csymbol><set id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1"><apply id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3"><eq id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.1"></eq><ci id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.1.3.3">0</cn></apply></apply><apply id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3"><minus id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.1"></minus><ci id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.2">𝑙</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.3.3.1.3.3">1</cn></apply></apply><apply id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2">subscript</csymbol><set id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1"><apply id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1"><plus id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.1"></plus><apply id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.1.1.1.3.2">𝑥</ci><list id="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2"><cn type="integer" id="S3.SS0.SSS0.Px3.p4.12.m3.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.1.1.1.1">0</cn><apply id="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1.2">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.2.2.2.2.1.3">′</ci></apply></list></apply></apply></set><apply id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3"><eq id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.1"></eq><ci id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.2">𝑖</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.1.3.3">0</cn></apply></apply><apply id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3"><minus id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.1.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.1"></minus><ci id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.2.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.2">𝑙</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.3.cmml" xref="S3.SS0.SSS0.Px3.p4.12.m3.4.4.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.12.m3.4c">\{x_{i}\}_{i=0}^{l-1}\rightarrow\{x_{i}+x_{0,d^{\prime}}\}_{i=0}^{l-1}</annotation></semantics></math> where <math id="S3.SS0.SSS0.Px3.p4.13.m4.2" class="ltx_Math" alttext="x_{0,d^{\prime}}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.13.m4.2a"><msub id="S3.SS0.SSS0.Px3.p4.13.m4.2.3" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.3.cmml"><mi id="S3.SS0.SSS0.Px3.p4.13.m4.2.3.2" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.3.2.cmml">x</mi><mrow id="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.3.cmml"><mn id="S3.SS0.SSS0.Px3.p4.13.m4.1.1.1.1" xref="S3.SS0.SSS0.Px3.p4.13.m4.1.1.1.1.cmml">0</mn><mo id="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.2" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.3.cmml">,</mo><msup id="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1.2" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1.2.cmml">d</mi><mo id="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1.3" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1.3.cmml">′</mo></msup></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.13.m4.2b"><apply id="S3.SS0.SSS0.Px3.p4.13.m4.2.3.cmml" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.13.m4.2.3.1.cmml" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.13.m4.2.3.2.cmml" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.3.2">𝑥</ci><list id="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2"><cn type="integer" id="S3.SS0.SSS0.Px3.p4.13.m4.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.13.m4.1.1.1.1">0</cn><apply id="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1.2">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.13.m4.2.2.2.2.1.3">′</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.13.m4.2c">x_{0,d^{\prime}}</annotation></semantics></math> is a vector where the first <math id="S3.SS0.SSS0.Px3.p4.14.m5.1" class="ltx_Math" alttext="d^{\prime}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.14.m5.1a"><msup id="S3.SS0.SSS0.Px3.p4.14.m5.1.1" xref="S3.SS0.SSS0.Px3.p4.14.m5.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.14.m5.1.1.2" xref="S3.SS0.SSS0.Px3.p4.14.m5.1.1.2.cmml">d</mi><mo id="S3.SS0.SSS0.Px3.p4.14.m5.1.1.3" xref="S3.SS0.SSS0.Px3.p4.14.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.14.m5.1b"><apply id="S3.SS0.SSS0.Px3.p4.14.m5.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.14.m5.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.14.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.14.m5.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.14.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.14.m5.1.1.2">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p4.14.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.14.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.14.m5.1c">d^{\prime}</annotation></semantics></math> entries are the first <math id="S3.SS0.SSS0.Px3.p4.15.m6.1" class="ltx_Math" alttext="d^{\prime}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.15.m6.1a"><msup id="S3.SS0.SSS0.Px3.p4.15.m6.1.1" xref="S3.SS0.SSS0.Px3.p4.15.m6.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.15.m6.1.1.2" xref="S3.SS0.SSS0.Px3.p4.15.m6.1.1.2.cmml">d</mi><mo id="S3.SS0.SSS0.Px3.p4.15.m6.1.1.3" xref="S3.SS0.SSS0.Px3.p4.15.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.15.m6.1b"><apply id="S3.SS0.SSS0.Px3.p4.15.m6.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.15.m6.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.15.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.15.m6.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.15.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.15.m6.1.1.2">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p4.15.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.15.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.15.m6.1c">d^{\prime}</annotation></semantics></math> entries of <math id="S3.SS0.SSS0.Px3.p4.16.m7.1" class="ltx_Math" alttext="x_{0}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.16.m7.1a"><msub id="S3.SS0.SSS0.Px3.p4.16.m7.1.1" xref="S3.SS0.SSS0.Px3.p4.16.m7.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p4.16.m7.1.1.2" xref="S3.SS0.SSS0.Px3.p4.16.m7.1.1.2.cmml">x</mi><mn id="S3.SS0.SSS0.Px3.p4.16.m7.1.1.3" xref="S3.SS0.SSS0.Px3.p4.16.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.16.m7.1b"><apply id="S3.SS0.SSS0.Px3.p4.16.m7.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.16.m7.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.16.m7.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.16.m7.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.16.m7.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.16.m7.1.1.2">𝑥</ci><cn type="integer" id="S3.SS0.SSS0.Px3.p4.16.m7.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.16.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.16.m7.1c">x_{0}</annotation></semantics></math>, and the other <math id="S3.SS0.SSS0.Px3.p4.17.m8.1" class="ltx_Math" alttext="d_{model}-d^{\prime}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.17.m8.1a"><mrow id="S3.SS0.SSS0.Px3.p4.17.m8.1.1" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.cmml"><msub id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.2" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.2.cmml">d</mi><mrow id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.cmml"><mi id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.2" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.1" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.3" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.1a" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.4" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.1b" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.5" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.1c" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.6" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.1" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.1.cmml">−</mo><msup id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3.2" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3.2.cmml">d</mi><mo id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3.3" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.17.m8.1b"><apply id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1"><minus id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.1"></minus><apply id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.2">𝑑</ci><apply id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3"><times id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.1.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.1"></times><ci id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.2.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.2">𝑚</ci><ci id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.3.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.3">𝑜</ci><ci id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.4.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.4">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.5.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.5">𝑒</ci><ci id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.6.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3">superscript</csymbol><ci id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3.2">𝑑</ci><ci id="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px3.p4.17.m8.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p4.17.m8.1c">d_{model}-d^{\prime}</annotation></semantics></math> entries are identically <math id="S3.SS0.SSS0.Px3.p4.18.m9.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS0.SSS0.Px3.p4.18.m9.1a"><mn id="S3.SS0.SSS0.Px3.p4.18.m9.1.1" xref="S3.SS0.SSS0.Px3.p4.18.m9.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p4.18.m9.1b"><cn type="integer" id="S3.SS0.SSS0.Px3.p4.18.m9.1.1.cmml" xref="S3.SS0.SSS0.Px3.p4.18.m9.1.1">0</cn></annotation-xml></semantics></math>.</p>
</div>
<div id="S3.SS0.SSS0.Px3.p5" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px3.p5.1" class="ltx_p">If the attacker chooses to perform this modification on the first Transformer block, this means that embeddings <math id="S3.SS0.SSS0.Px3.p5.1.m1.1" class="ltx_Math" alttext="u_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px3.p5.1.m1.1a"><msub id="S3.SS0.SSS0.Px3.p5.1.m1.1.1" xref="S3.SS0.SSS0.Px3.p5.1.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px3.p5.1.m1.1.1.2" xref="S3.SS0.SSS0.Px3.p5.1.m1.1.1.2.cmml">u</mi><mi id="S3.SS0.SSS0.Px3.p5.1.m1.1.1.3" xref="S3.SS0.SSS0.Px3.p5.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px3.p5.1.m1.1b"><apply id="S3.SS0.SSS0.Px3.p5.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px3.p5.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px3.p5.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px3.p5.1.m1.1.1.2">𝑢</ci><ci id="S3.SS0.SSS0.Px3.p5.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px3.p5.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px3.p5.1.m1.1c">u_{k}</annotation></semantics></math> that the attacker recovers from each of the linear layers <span id="S3.SS0.SSS0.Px3.p5.1.1" class="ltx_text ltx_font_italic">now also contain unique information about the first token of the sequence from which they came</span>. The attacker can then calculate correlations between first-position embeddings and later-position embeddings and group each embedding into a sequence with other embeddings.</p>
</div>
</section>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Extracting User Data</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">Now that we have introduced the main mechanisms by which an attacker prepares a malicious parameter vector, we summarize how to extract user data. The attack begins after a user or aggregate group of users has computed their gradient using the corrupted parameters. Then, the server retrieves their update and begins the inversion procedure. We summarize the entire attack in <a href="#alg1" title="In Getting a Bag-of-Words Containing All Tokens ‣ 3.1 Extracting User Data ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section id="S3.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Getting a Bag-of-Words Containing All Tokens</h5>

<figure id="S3.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/assets/embedding_inversion.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="269" height="103" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x2.png" id="S3.F5.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="152" height="100" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span id="S3.F5.5.1" class="ltx_text ltx_font_bold">Left:</span> A high-level schematic of token leaking. The token embedding layer leaks tokens and frequencies solely through its sparse gradient entries. <span id="S3.F5.6.2" class="ltx_text ltx_font_bold">Right:</span> Distribution and Histogram of log of norms of all token embedding gradients for GPT-2 for <math id="S3.F5.2.m1.1" class="ltx_Math" alttext="13824" display="inline"><semantics id="S3.F5.2.m1.1b"><mn id="S3.F5.2.m1.1.1" xref="S3.F5.2.m1.1.1.cmml">13824</mn><annotation-xml encoding="MathML-Content" id="S3.F5.2.m1.1c"><cn type="integer" id="S3.F5.2.m1.1.1.cmml" xref="S3.F5.2.m1.1.1">13824</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.2.m1.1d">13824</annotation></semantics></math> tokens. In this case, gradient entries are non-sparse due to the tied encoder-decoder structure of GPT, but the embeddings of true user data (red) are clearly separable from the mass of all embeddings (blue) by a cutoff at 1.5 standard deviations (marked in black).</figcaption>
</figure>
<div id="S3.SS1.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS0.Px1.p1.1" class="ltx_p">Even without malicious parameters, an attacker can retrieve the bag-of-words (unordered list of tokens) of the user from the gradient of the token embedding. <cite class="ltx_cite ltx_citemacro_citet">Melis et al. (<a href="#bib.bib39" title="" class="ltx_ref">2019</a>)</cite> identified that the embedding layer gradient is only non-zero at locations corresponding to tokens that were used for training, as visualized in the left plot of <a href="#S3.F5" title="In Getting a Bag-of-Words Containing All Tokens ‣ 3.1 Extracting User Data ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a>. Furthermore, the frequency of all words can be extracted by analyzing the bias gradient of the embedding or decoding (last linear) layer, as the magnitude of the update of each row of a random embedding matrix is proportional to the frequency of word usage, allowing for a greedy estimation by adapting the strategy of <cite class="ltx_cite ltx_citemacro_citet">Wainakh et al. (<a href="#bib.bib54" title="" class="ltx_ref">2021</a>)</cite> which was proposed for simpler classification tasks. We use this finding as a first step to restrict the number of possible tokens that should be matched. More details can be found in <a href="#A3" title="Appendix C Token Bag-of-Words Recovery ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Decepticon Data Readout Overview</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> Sequence Length <math id="alg1.l1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">S</annotation></semantics></math>, number of expected sequences <math id="alg1.l1.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">N</annotation></semantics></math>. Gradients <math id="alg1.l1.m3.2" class="ltx_Math" alttext="\nabla W_{i},\nabla b_{i}" display="inline"><semantics id="alg1.l1.m3.2a"><mrow id="alg1.l1.m3.2.2.2" xref="alg1.l1.m3.2.2.3.cmml"><mrow id="alg1.l1.m3.1.1.1.1" xref="alg1.l1.m3.1.1.1.1.cmml"><mo rspace="0.167em" id="alg1.l1.m3.1.1.1.1.1" xref="alg1.l1.m3.1.1.1.1.1.cmml">∇</mo><msub id="alg1.l1.m3.1.1.1.1.2" xref="alg1.l1.m3.1.1.1.1.2.cmml"><mi id="alg1.l1.m3.1.1.1.1.2.2" xref="alg1.l1.m3.1.1.1.1.2.2.cmml">W</mi><mi id="alg1.l1.m3.1.1.1.1.2.3" xref="alg1.l1.m3.1.1.1.1.2.3.cmml">i</mi></msub></mrow><mo id="alg1.l1.m3.2.2.2.3" xref="alg1.l1.m3.2.2.3.cmml">,</mo><mrow id="alg1.l1.m3.2.2.2.2" xref="alg1.l1.m3.2.2.2.2.cmml"><mo rspace="0.167em" id="alg1.l1.m3.2.2.2.2.1" xref="alg1.l1.m3.2.2.2.2.1.cmml">∇</mo><msub id="alg1.l1.m3.2.2.2.2.2" xref="alg1.l1.m3.2.2.2.2.2.cmml"><mi id="alg1.l1.m3.2.2.2.2.2.2" xref="alg1.l1.m3.2.2.2.2.2.2.cmml">b</mi><mi id="alg1.l1.m3.2.2.2.2.2.3" xref="alg1.l1.m3.2.2.2.2.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.2b"><list id="alg1.l1.m3.2.2.3.cmml" xref="alg1.l1.m3.2.2.2"><apply id="alg1.l1.m3.1.1.1.1.cmml" xref="alg1.l1.m3.1.1.1.1"><ci id="alg1.l1.m3.1.1.1.1.1.cmml" xref="alg1.l1.m3.1.1.1.1.1">∇</ci><apply id="alg1.l1.m3.1.1.1.1.2.cmml" xref="alg1.l1.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.1.2.1.cmml" xref="alg1.l1.m3.1.1.1.1.2">subscript</csymbol><ci id="alg1.l1.m3.1.1.1.1.2.2.cmml" xref="alg1.l1.m3.1.1.1.1.2.2">𝑊</ci><ci id="alg1.l1.m3.1.1.1.1.2.3.cmml" xref="alg1.l1.m3.1.1.1.1.2.3">𝑖</ci></apply></apply><apply id="alg1.l1.m3.2.2.2.2.cmml" xref="alg1.l1.m3.2.2.2.2"><ci id="alg1.l1.m3.2.2.2.2.1.cmml" xref="alg1.l1.m3.2.2.2.2.1">∇</ci><apply id="alg1.l1.m3.2.2.2.2.2.cmml" xref="alg1.l1.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m3.2.2.2.2.2.1.cmml" xref="alg1.l1.m3.2.2.2.2.2">subscript</csymbol><ci id="alg1.l1.m3.2.2.2.2.2.2.cmml" xref="alg1.l1.m3.2.2.2.2.2.2">𝑏</ci><ci id="alg1.l1.m3.2.2.2.2.2.3.cmml" xref="alg1.l1.m3.2.2.2.2.2.3">𝑖</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.2c">\nabla W_{i},\nabla b_{i}</annotation></semantics></math> of the weight and bias of the first linear layer in each FFN block. Positional embeddings <math id="alg1.l1.m4.1" class="ltx_Math" alttext="P" display="inline"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">P</annotation></semantics></math>, token embeddings <math id="alg1.l1.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">T</annotation></semantics></math>.

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <math id="alg1.l2.m1.1" class="ltx_Math" alttext="t_{v}" display="inline"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">t</mi><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑡</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">t_{v}</annotation></semantics></math> <math id="alg1.l2.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l2.m2.1a"><mo stretchy="false" id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\leftarrow</annotation></semantics></math> Token Embeddings of estimated bag-of-words of leaked tokens or all tokens

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <math id="alg1.l3.m1.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">p</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑝</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">p_{k}</annotation></semantics></math> <math id="alg1.l3.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l3.m2.1a"><mo stretchy="false" id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\leftarrow</annotation></semantics></math> Known positional embeddings

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>  <math id="alg1.l4.m1.1" class="ltx_Math" alttext="u_{h}" display="inline"><semantics id="alg1.l4.m1.1a"><msub id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">u</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑢</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">u_{h}</annotation></semantics></math> <math id="alg1.l4.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l4.m2.1a"><mo stretchy="false" id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\leftarrow</annotation></semantics></math> <math id="alg1.l4.m3.2" class="ltx_Math" alttext="\frac{\nabla_{W_{ij}}-\nabla_{W_{i,j+1}}}{\nabla_{b^{i}_{j}}-\nabla_{b^{i}_{j+1}}}" display="inline"><semantics id="alg1.l4.m3.2a"><mfrac id="alg1.l4.m3.2.2" xref="alg1.l4.m3.2.2.cmml"><mrow id="alg1.l4.m3.2.2.2" xref="alg1.l4.m3.2.2.2.cmml"><msub id="alg1.l4.m3.2.2.2.4" xref="alg1.l4.m3.2.2.2.4.cmml"><mo id="alg1.l4.m3.2.2.2.4.2" xref="alg1.l4.m3.2.2.2.4.2.cmml">∇</mo><msub id="alg1.l4.m3.2.2.2.4.3" xref="alg1.l4.m3.2.2.2.4.3.cmml"><mi id="alg1.l4.m3.2.2.2.4.3.2" xref="alg1.l4.m3.2.2.2.4.3.2.cmml">W</mi><mrow id="alg1.l4.m3.2.2.2.4.3.3" xref="alg1.l4.m3.2.2.2.4.3.3.cmml"><mi id="alg1.l4.m3.2.2.2.4.3.3.2" xref="alg1.l4.m3.2.2.2.4.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m3.2.2.2.4.3.3.1" xref="alg1.l4.m3.2.2.2.4.3.3.1.cmml">​</mo><mi id="alg1.l4.m3.2.2.2.4.3.3.3" xref="alg1.l4.m3.2.2.2.4.3.3.3.cmml">j</mi></mrow></msub></msub><mo lspace="0em" id="alg1.l4.m3.2.2.2.3" xref="alg1.l4.m3.2.2.2.3.cmml">−</mo><msub id="alg1.l4.m3.2.2.2.5" xref="alg1.l4.m3.2.2.2.5.cmml"><mo id="alg1.l4.m3.2.2.2.5.2" xref="alg1.l4.m3.2.2.2.5.2.cmml">∇</mo><msub id="alg1.l4.m3.2.2.2.2.2" xref="alg1.l4.m3.2.2.2.2.2.cmml"><mi id="alg1.l4.m3.2.2.2.2.2.4" xref="alg1.l4.m3.2.2.2.2.2.4.cmml">W</mi><mrow id="alg1.l4.m3.2.2.2.2.2.2.2.2" xref="alg1.l4.m3.2.2.2.2.2.2.2.3.cmml"><mi id="alg1.l4.m3.1.1.1.1.1.1.1.1" xref="alg1.l4.m3.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="alg1.l4.m3.2.2.2.2.2.2.2.2.2" xref="alg1.l4.m3.2.2.2.2.2.2.2.3.cmml">,</mo><mrow id="alg1.l4.m3.2.2.2.2.2.2.2.2.1" xref="alg1.l4.m3.2.2.2.2.2.2.2.2.1.cmml"><mi id="alg1.l4.m3.2.2.2.2.2.2.2.2.1.2" xref="alg1.l4.m3.2.2.2.2.2.2.2.2.1.2.cmml">j</mi><mo id="alg1.l4.m3.2.2.2.2.2.2.2.2.1.1" xref="alg1.l4.m3.2.2.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l4.m3.2.2.2.2.2.2.2.2.1.3" xref="alg1.l4.m3.2.2.2.2.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub></msub></mrow><mrow id="alg1.l4.m3.2.2.4" xref="alg1.l4.m3.2.2.4.cmml"><msub id="alg1.l4.m3.2.2.4.2" xref="alg1.l4.m3.2.2.4.2.cmml"><mo id="alg1.l4.m3.2.2.4.2.2" xref="alg1.l4.m3.2.2.4.2.2.cmml">∇</mo><msubsup id="alg1.l4.m3.2.2.4.2.3" xref="alg1.l4.m3.2.2.4.2.3.cmml"><mi id="alg1.l4.m3.2.2.4.2.3.2.2" xref="alg1.l4.m3.2.2.4.2.3.2.2.cmml">b</mi><mi id="alg1.l4.m3.2.2.4.2.3.3" xref="alg1.l4.m3.2.2.4.2.3.3.cmml">j</mi><mi id="alg1.l4.m3.2.2.4.2.3.2.3" xref="alg1.l4.m3.2.2.4.2.3.2.3.cmml">i</mi></msubsup></msub><mo lspace="0em" id="alg1.l4.m3.2.2.4.1" xref="alg1.l4.m3.2.2.4.1.cmml">−</mo><msub id="alg1.l4.m3.2.2.4.3" xref="alg1.l4.m3.2.2.4.3.cmml"><mo id="alg1.l4.m3.2.2.4.3.2" xref="alg1.l4.m3.2.2.4.3.2.cmml">∇</mo><msubsup id="alg1.l4.m3.2.2.4.3.3" xref="alg1.l4.m3.2.2.4.3.3.cmml"><mi id="alg1.l4.m3.2.2.4.3.3.2.2" xref="alg1.l4.m3.2.2.4.3.3.2.2.cmml">b</mi><mrow id="alg1.l4.m3.2.2.4.3.3.3" xref="alg1.l4.m3.2.2.4.3.3.3.cmml"><mi id="alg1.l4.m3.2.2.4.3.3.3.2" xref="alg1.l4.m3.2.2.4.3.3.3.2.cmml">j</mi><mo id="alg1.l4.m3.2.2.4.3.3.3.1" xref="alg1.l4.m3.2.2.4.3.3.3.1.cmml">+</mo><mn id="alg1.l4.m3.2.2.4.3.3.3.3" xref="alg1.l4.m3.2.2.4.3.3.3.3.cmml">1</mn></mrow><mi id="alg1.l4.m3.2.2.4.3.3.2.3" xref="alg1.l4.m3.2.2.4.3.3.2.3.cmml">i</mi></msubsup></msub></mrow></mfrac><annotation-xml encoding="MathML-Content" id="alg1.l4.m3.2b"><apply id="alg1.l4.m3.2.2.cmml" xref="alg1.l4.m3.2.2"><divide id="alg1.l4.m3.2.2.3.cmml" xref="alg1.l4.m3.2.2"></divide><apply id="alg1.l4.m3.2.2.2.cmml" xref="alg1.l4.m3.2.2.2"><minus id="alg1.l4.m3.2.2.2.3.cmml" xref="alg1.l4.m3.2.2.2.3"></minus><apply id="alg1.l4.m3.2.2.2.4.cmml" xref="alg1.l4.m3.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l4.m3.2.2.2.4.1.cmml" xref="alg1.l4.m3.2.2.2.4">subscript</csymbol><ci id="alg1.l4.m3.2.2.2.4.2.cmml" xref="alg1.l4.m3.2.2.2.4.2">∇</ci><apply id="alg1.l4.m3.2.2.2.4.3.cmml" xref="alg1.l4.m3.2.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l4.m3.2.2.2.4.3.1.cmml" xref="alg1.l4.m3.2.2.2.4.3">subscript</csymbol><ci id="alg1.l4.m3.2.2.2.4.3.2.cmml" xref="alg1.l4.m3.2.2.2.4.3.2">𝑊</ci><apply id="alg1.l4.m3.2.2.2.4.3.3.cmml" xref="alg1.l4.m3.2.2.2.4.3.3"><times id="alg1.l4.m3.2.2.2.4.3.3.1.cmml" xref="alg1.l4.m3.2.2.2.4.3.3.1"></times><ci id="alg1.l4.m3.2.2.2.4.3.3.2.cmml" xref="alg1.l4.m3.2.2.2.4.3.3.2">𝑖</ci><ci id="alg1.l4.m3.2.2.2.4.3.3.3.cmml" xref="alg1.l4.m3.2.2.2.4.3.3.3">𝑗</ci></apply></apply></apply><apply id="alg1.l4.m3.2.2.2.5.cmml" xref="alg1.l4.m3.2.2.2.5"><csymbol cd="ambiguous" id="alg1.l4.m3.2.2.2.5.1.cmml" xref="alg1.l4.m3.2.2.2.5">subscript</csymbol><ci id="alg1.l4.m3.2.2.2.5.2.cmml" xref="alg1.l4.m3.2.2.2.5.2">∇</ci><apply id="alg1.l4.m3.2.2.2.2.2.cmml" xref="alg1.l4.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m3.2.2.2.2.2.3.cmml" xref="alg1.l4.m3.2.2.2.2.2">subscript</csymbol><ci id="alg1.l4.m3.2.2.2.2.2.4.cmml" xref="alg1.l4.m3.2.2.2.2.2.4">𝑊</ci><list id="alg1.l4.m3.2.2.2.2.2.2.2.3.cmml" xref="alg1.l4.m3.2.2.2.2.2.2.2.2"><ci id="alg1.l4.m3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m3.1.1.1.1.1.1.1.1">𝑖</ci><apply id="alg1.l4.m3.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l4.m3.2.2.2.2.2.2.2.2.1"><plus id="alg1.l4.m3.2.2.2.2.2.2.2.2.1.1.cmml" xref="alg1.l4.m3.2.2.2.2.2.2.2.2.1.1"></plus><ci id="alg1.l4.m3.2.2.2.2.2.2.2.2.1.2.cmml" xref="alg1.l4.m3.2.2.2.2.2.2.2.2.1.2">𝑗</ci><cn type="integer" id="alg1.l4.m3.2.2.2.2.2.2.2.2.1.3.cmml" xref="alg1.l4.m3.2.2.2.2.2.2.2.2.1.3">1</cn></apply></list></apply></apply></apply><apply id="alg1.l4.m3.2.2.4.cmml" xref="alg1.l4.m3.2.2.4"><minus id="alg1.l4.m3.2.2.4.1.cmml" xref="alg1.l4.m3.2.2.4.1"></minus><apply id="alg1.l4.m3.2.2.4.2.cmml" xref="alg1.l4.m3.2.2.4.2"><csymbol cd="ambiguous" id="alg1.l4.m3.2.2.4.2.1.cmml" xref="alg1.l4.m3.2.2.4.2">subscript</csymbol><ci id="alg1.l4.m3.2.2.4.2.2.cmml" xref="alg1.l4.m3.2.2.4.2.2">∇</ci><apply id="alg1.l4.m3.2.2.4.2.3.cmml" xref="alg1.l4.m3.2.2.4.2.3"><csymbol cd="ambiguous" id="alg1.l4.m3.2.2.4.2.3.1.cmml" xref="alg1.l4.m3.2.2.4.2.3">subscript</csymbol><apply id="alg1.l4.m3.2.2.4.2.3.2.cmml" xref="alg1.l4.m3.2.2.4.2.3"><csymbol cd="ambiguous" id="alg1.l4.m3.2.2.4.2.3.2.1.cmml" xref="alg1.l4.m3.2.2.4.2.3">superscript</csymbol><ci id="alg1.l4.m3.2.2.4.2.3.2.2.cmml" xref="alg1.l4.m3.2.2.4.2.3.2.2">𝑏</ci><ci id="alg1.l4.m3.2.2.4.2.3.2.3.cmml" xref="alg1.l4.m3.2.2.4.2.3.2.3">𝑖</ci></apply><ci id="alg1.l4.m3.2.2.4.2.3.3.cmml" xref="alg1.l4.m3.2.2.4.2.3.3">𝑗</ci></apply></apply><apply id="alg1.l4.m3.2.2.4.3.cmml" xref="alg1.l4.m3.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l4.m3.2.2.4.3.1.cmml" xref="alg1.l4.m3.2.2.4.3">subscript</csymbol><ci id="alg1.l4.m3.2.2.4.3.2.cmml" xref="alg1.l4.m3.2.2.4.3.2">∇</ci><apply id="alg1.l4.m3.2.2.4.3.3.cmml" xref="alg1.l4.m3.2.2.4.3.3"><csymbol cd="ambiguous" id="alg1.l4.m3.2.2.4.3.3.1.cmml" xref="alg1.l4.m3.2.2.4.3.3">subscript</csymbol><apply id="alg1.l4.m3.2.2.4.3.3.2.cmml" xref="alg1.l4.m3.2.2.4.3.3"><csymbol cd="ambiguous" id="alg1.l4.m3.2.2.4.3.3.2.1.cmml" xref="alg1.l4.m3.2.2.4.3.3">superscript</csymbol><ci id="alg1.l4.m3.2.2.4.3.3.2.2.cmml" xref="alg1.l4.m3.2.2.4.3.3.2.2">𝑏</ci><ci id="alg1.l4.m3.2.2.4.3.3.2.3.cmml" xref="alg1.l4.m3.2.2.4.3.3.2.3">𝑖</ci></apply><apply id="alg1.l4.m3.2.2.4.3.3.3.cmml" xref="alg1.l4.m3.2.2.4.3.3.3"><plus id="alg1.l4.m3.2.2.4.3.3.3.1.cmml" xref="alg1.l4.m3.2.2.4.3.3.3.1"></plus><ci id="alg1.l4.m3.2.2.4.3.3.3.2.cmml" xref="alg1.l4.m3.2.2.4.3.3.3.2">𝑗</ci><cn type="integer" id="alg1.l4.m3.2.2.4.3.3.3.3.cmml" xref="alg1.l4.m3.2.2.4.3.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m3.2c">\frac{\nabla_{W_{ij}}-\nabla_{W_{i,j+1}}}{\nabla_{b^{i}_{j}}-\nabla_{b^{i}_{j+1}}}</annotation></semantics></math> for linear layers <math id="alg1.l4.m4.1" class="ltx_math_unparsed" alttext="i=1,..L" display="inline"><semantics id="alg1.l4.m4.1a"><mrow id="alg1.l4.m4.1b"><mi id="alg1.l4.m4.1.1">i</mi><mo id="alg1.l4.m4.1.2">=</mo><mn id="alg1.l4.m4.1.3">1</mn><mo id="alg1.l4.m4.1.4">,</mo><mo lspace="0em" rspace="0.0835em" id="alg1.l4.m4.1.5">.</mo><mo lspace="0.0835em" rspace="0.167em" id="alg1.l4.m4.1.6">.</mo><mi id="alg1.l4.m4.1.7">L</mi></mrow><annotation encoding="application/x-tex" id="alg1.l4.m4.1c">i=1,..L</annotation></semantics></math> and rows <math id="alg1.l4.m5.3" class="ltx_Math" alttext="j=1,...,r" display="inline"><semantics id="alg1.l4.m5.3a"><mrow id="alg1.l4.m5.3.4" xref="alg1.l4.m5.3.4.cmml"><mi id="alg1.l4.m5.3.4.2" xref="alg1.l4.m5.3.4.2.cmml">j</mi><mo id="alg1.l4.m5.3.4.1" xref="alg1.l4.m5.3.4.1.cmml">=</mo><mrow id="alg1.l4.m5.3.4.3.2" xref="alg1.l4.m5.3.4.3.1.cmml"><mn id="alg1.l4.m5.1.1" xref="alg1.l4.m5.1.1.cmml">1</mn><mo id="alg1.l4.m5.3.4.3.2.1" xref="alg1.l4.m5.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.m5.2.2" xref="alg1.l4.m5.2.2.cmml">…</mi><mo id="alg1.l4.m5.3.4.3.2.2" xref="alg1.l4.m5.3.4.3.1.cmml">,</mo><mi id="alg1.l4.m5.3.3" xref="alg1.l4.m5.3.3.cmml">r</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m5.3b"><apply id="alg1.l4.m5.3.4.cmml" xref="alg1.l4.m5.3.4"><eq id="alg1.l4.m5.3.4.1.cmml" xref="alg1.l4.m5.3.4.1"></eq><ci id="alg1.l4.m5.3.4.2.cmml" xref="alg1.l4.m5.3.4.2">𝑗</ci><list id="alg1.l4.m5.3.4.3.1.cmml" xref="alg1.l4.m5.3.4.3.2"><cn type="integer" id="alg1.l4.m5.1.1.cmml" xref="alg1.l4.m5.1.1">1</cn><ci id="alg1.l4.m5.2.2.cmml" xref="alg1.l4.m5.2.2">…</ci><ci id="alg1.l4.m5.3.3.cmml" xref="alg1.l4.m5.3.3">𝑟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m5.3c">j=1,...,r</annotation></semantics></math>.

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>  <math id="alg1.l5.m1.1" class="ltx_Math" alttext="L_{\text{batch}}" display="inline"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">L</mi><mtext id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3a.cmml">batch</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝐿</ci><ci id="alg1.l5.m1.1.1.3a.cmml" xref="alg1.l5.m1.1.1.3"><mtext mathsize="70%" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">batch</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">L_{\text{batch}}</annotation></semantics></math> <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l5.m2.1a"><mo stretchy="false" id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\leftarrow</annotation></semantics></math> Cluster index for each <math id="alg1.l5.m3.1" class="ltx_Math" alttext="u_{h}" display="inline"><semantics id="alg1.l5.m3.1a"><msub id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><mi id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2.cmml">u</mi><mi id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1">subscript</csymbol><ci id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2">𝑢</ci><ci id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">u_{h}</annotation></semantics></math> clustering the first <math id="alg1.l5.m4.1" class="ltx_Math" alttext="d^{\prime}" display="inline"><semantics id="alg1.l5.m4.1a"><msup id="alg1.l5.m4.1.1" xref="alg1.l5.m4.1.1.cmml"><mi id="alg1.l5.m4.1.1.2" xref="alg1.l5.m4.1.1.2.cmml">d</mi><mo id="alg1.l5.m4.1.1.3" xref="alg1.l5.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.l5.m4.1b"><apply id="alg1.l5.m4.1.1.cmml" xref="alg1.l5.m4.1.1"><csymbol cd="ambiguous" id="alg1.l5.m4.1.1.1.cmml" xref="alg1.l5.m4.1.1">superscript</csymbol><ci id="alg1.l5.m4.1.1.2.cmml" xref="alg1.l5.m4.1.1.2">𝑑</ci><ci id="alg1.l5.m4.1.1.3.cmml" xref="alg1.l5.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m4.1c">d^{\prime}</annotation></semantics></math> entries of each embedding.

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>  <span id="alg1.l6.1" class="ltx_text ltx_font_bold">for</span> n in <math id="alg1.l6.m1.1" class="ltx_Math" alttext="0...N" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mn id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">0</mn><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1a" xref="alg1.l6.m1.1.1.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.4" xref="alg1.l6.m1.1.1.4.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><times id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></times><cn type="integer" id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">0</cn><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">…</ci><ci id="alg1.l6.m1.1.1.4.cmml" xref="alg1.l6.m1.1.1.4">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">0...N</annotation></semantics></math> <span id="alg1.l6.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math id="alg1.l7.m1.1" class="ltx_Math" alttext="u_{hn}" display="inline"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">u</mi><mrow id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.3.1" xref="alg1.l7.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑢</ci><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><times id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3.1"></times><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">ℎ</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">u_{hn}</annotation></semantics></math> <math id="alg1.l7.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l7.m2.1a"><mo stretchy="false" id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">\leftarrow</annotation></semantics></math> Entries of cluster <math id="alg1.l7.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.l7.m3.1a"><mi id="alg1.l7.m3.1.1" xref="alg1.l7.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.1b"><ci id="alg1.l7.m3.1.1.cmml" xref="alg1.l7.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.1c">n</annotation></semantics></math> in <math id="alg1.l7.m4.1" class="ltx_Math" alttext="L_{\text{batch}}" display="inline"><semantics id="alg1.l7.m4.1a"><msub id="alg1.l7.m4.1.1" xref="alg1.l7.m4.1.1.cmml"><mi id="alg1.l7.m4.1.1.2" xref="alg1.l7.m4.1.1.2.cmml">L</mi><mtext id="alg1.l7.m4.1.1.3" xref="alg1.l7.m4.1.1.3a.cmml">batch</mtext></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m4.1b"><apply id="alg1.l7.m4.1.1.cmml" xref="alg1.l7.m4.1.1"><csymbol cd="ambiguous" id="alg1.l7.m4.1.1.1.cmml" xref="alg1.l7.m4.1.1">subscript</csymbol><ci id="alg1.l7.m4.1.1.2.cmml" xref="alg1.l7.m4.1.1.2">𝐿</ci><ci id="alg1.l7.m4.1.1.3a.cmml" xref="alg1.l7.m4.1.1.3"><mtext mathsize="70%" id="alg1.l7.m4.1.1.3.cmml" xref="alg1.l7.m4.1.1.3">batch</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m4.1c">L_{\text{batch}}</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math id="alg1.l8.m1.1" class="ltx_Math" alttext="u^{n}_{k}" display="inline"><semantics id="alg1.l8.m1.1a"><msubsup id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">u</mi><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">k</mi><mi id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1">superscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝑢</ci><ci id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3">𝑛</ci></apply><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">u^{n}_{k}</annotation></semantics></math> <math id="alg1.l8.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l8.m2.1a"><mo stretchy="false" id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\leftarrow</annotation></semantics></math> Match(<math id="alg1.l8.m3.1" class="ltx_Math" alttext="P_{k}" display="inline"><semantics id="alg1.l8.m3.1a"><msub id="alg1.l8.m3.1.1" xref="alg1.l8.m3.1.1.cmml"><mi id="alg1.l8.m3.1.1.2" xref="alg1.l8.m3.1.1.2.cmml">P</mi><mi id="alg1.l8.m3.1.1.3" xref="alg1.l8.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m3.1b"><apply id="alg1.l8.m3.1.1.cmml" xref="alg1.l8.m3.1.1"><csymbol cd="ambiguous" id="alg1.l8.m3.1.1.1.cmml" xref="alg1.l8.m3.1.1">subscript</csymbol><ci id="alg1.l8.m3.1.1.2.cmml" xref="alg1.l8.m3.1.1.2">𝑃</ci><ci id="alg1.l8.m3.1.1.3.cmml" xref="alg1.l8.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m3.1c">P_{k}</annotation></semantics></math>, <math id="alg1.l8.m4.1" class="ltx_Math" alttext="u_{hn}" display="inline"><semantics id="alg1.l8.m4.1a"><msub id="alg1.l8.m4.1.1" xref="alg1.l8.m4.1.1.cmml"><mi id="alg1.l8.m4.1.1.2" xref="alg1.l8.m4.1.1.2.cmml">u</mi><mrow id="alg1.l8.m4.1.1.3" xref="alg1.l8.m4.1.1.3.cmml"><mi id="alg1.l8.m4.1.1.3.2" xref="alg1.l8.m4.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m4.1.1.3.1" xref="alg1.l8.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l8.m4.1.1.3.3" xref="alg1.l8.m4.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m4.1b"><apply id="alg1.l8.m4.1.1.cmml" xref="alg1.l8.m4.1.1"><csymbol cd="ambiguous" id="alg1.l8.m4.1.1.1.cmml" xref="alg1.l8.m4.1.1">subscript</csymbol><ci id="alg1.l8.m4.1.1.2.cmml" xref="alg1.l8.m4.1.1.2">𝑢</ci><apply id="alg1.l8.m4.1.1.3.cmml" xref="alg1.l8.m4.1.1.3"><times id="alg1.l8.m4.1.1.3.1.cmml" xref="alg1.l8.m4.1.1.3.1"></times><ci id="alg1.l8.m4.1.1.3.2.cmml" xref="alg1.l8.m4.1.1.3.2">ℎ</ci><ci id="alg1.l8.m4.1.1.3.3.cmml" xref="alg1.l8.m4.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m4.1c">u_{hn}</annotation></semantics></math>) on all entries <math id="alg1.l8.m5.1" class="ltx_Math" alttext="d&gt;d^{\prime}" display="inline"><semantics id="alg1.l8.m5.1a"><mrow id="alg1.l8.m5.1.1" xref="alg1.l8.m5.1.1.cmml"><mi id="alg1.l8.m5.1.1.2" xref="alg1.l8.m5.1.1.2.cmml">d</mi><mo id="alg1.l8.m5.1.1.1" xref="alg1.l8.m5.1.1.1.cmml">&gt;</mo><msup id="alg1.l8.m5.1.1.3" xref="alg1.l8.m5.1.1.3.cmml"><mi id="alg1.l8.m5.1.1.3.2" xref="alg1.l8.m5.1.1.3.2.cmml">d</mi><mo id="alg1.l8.m5.1.1.3.3" xref="alg1.l8.m5.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m5.1b"><apply id="alg1.l8.m5.1.1.cmml" xref="alg1.l8.m5.1.1"><gt id="alg1.l8.m5.1.1.1.cmml" xref="alg1.l8.m5.1.1.1"></gt><ci id="alg1.l8.m5.1.1.2.cmml" xref="alg1.l8.m5.1.1.2">𝑑</ci><apply id="alg1.l8.m5.1.1.3.cmml" xref="alg1.l8.m5.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m5.1.1.3.1.cmml" xref="alg1.l8.m5.1.1.3">superscript</csymbol><ci id="alg1.l8.m5.1.1.3.2.cmml" xref="alg1.l8.m5.1.1.3.2">𝑑</ci><ci id="alg1.l8.m5.1.1.3.3.cmml" xref="alg1.l8.m5.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m5.1c">d&gt;d^{\prime}</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>  <span id="alg1.l9.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>  <math id="alg1.l10.m1.1" class="ltx_Math" alttext="u_{nk}" display="inline"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">u</mi><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑢</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><times id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></times><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑛</ci><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">u_{nk}</annotation></semantics></math> <math id="alg1.l10.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l10.m2.1a"><mo stretchy="false" id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\leftarrow</annotation></semantics></math> concatenate <math id="alg1.l10.m3.1" class="ltx_Math" alttext="\{u^{n}_{k}\}_{n=1}^{N}" display="inline"><semantics id="alg1.l10.m3.1a"><msubsup id="alg1.l10.m3.1.1" xref="alg1.l10.m3.1.1.cmml"><mrow id="alg1.l10.m3.1.1.1.1.1" xref="alg1.l10.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l10.m3.1.1.1.1.1.2" xref="alg1.l10.m3.1.1.1.1.2.cmml">{</mo><msubsup id="alg1.l10.m3.1.1.1.1.1.1" xref="alg1.l10.m3.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m3.1.1.1.1.1.1.2.2" xref="alg1.l10.m3.1.1.1.1.1.1.2.2.cmml">u</mi><mi id="alg1.l10.m3.1.1.1.1.1.1.3" xref="alg1.l10.m3.1.1.1.1.1.1.3.cmml">k</mi><mi id="alg1.l10.m3.1.1.1.1.1.1.2.3" xref="alg1.l10.m3.1.1.1.1.1.1.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="alg1.l10.m3.1.1.1.1.1.3" xref="alg1.l10.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l10.m3.1.1.1.3" xref="alg1.l10.m3.1.1.1.3.cmml"><mi id="alg1.l10.m3.1.1.1.3.2" xref="alg1.l10.m3.1.1.1.3.2.cmml">n</mi><mo id="alg1.l10.m3.1.1.1.3.1" xref="alg1.l10.m3.1.1.1.3.1.cmml">=</mo><mn id="alg1.l10.m3.1.1.1.3.3" xref="alg1.l10.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg1.l10.m3.1.1.3" xref="alg1.l10.m3.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10.m3.1b"><apply id="alg1.l10.m3.1.1.cmml" xref="alg1.l10.m3.1.1"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.2.cmml" xref="alg1.l10.m3.1.1">superscript</csymbol><apply id="alg1.l10.m3.1.1.1.cmml" xref="alg1.l10.m3.1.1"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.1.2.cmml" xref="alg1.l10.m3.1.1">subscript</csymbol><set id="alg1.l10.m3.1.1.1.1.2.cmml" xref="alg1.l10.m3.1.1.1.1.1"><apply id="alg1.l10.m3.1.1.1.1.1.1.cmml" xref="alg1.l10.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m3.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l10.m3.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.1.1.1.1.2.1.cmml" xref="alg1.l10.m3.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l10.m3.1.1.1.1.1.1.2.2.cmml" xref="alg1.l10.m3.1.1.1.1.1.1.2.2">𝑢</ci><ci id="alg1.l10.m3.1.1.1.1.1.1.2.3.cmml" xref="alg1.l10.m3.1.1.1.1.1.1.2.3">𝑛</ci></apply><ci id="alg1.l10.m3.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m3.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="alg1.l10.m3.1.1.1.3.cmml" xref="alg1.l10.m3.1.1.1.3"><eq id="alg1.l10.m3.1.1.1.3.1.cmml" xref="alg1.l10.m3.1.1.1.3.1"></eq><ci id="alg1.l10.m3.1.1.1.3.2.cmml" xref="alg1.l10.m3.1.1.1.3.2">𝑛</ci><cn type="integer" id="alg1.l10.m3.1.1.1.3.3.cmml" xref="alg1.l10.m3.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l10.m3.1.1.3.cmml" xref="alg1.l10.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m3.1c">\{u^{n}_{k}\}_{n=1}^{N}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>  <math id="alg1.l11.m1.1" class="ltx_Math" alttext="t^{\text{final tokens}}_{nk}" display="inline"><semantics id="alg1.l11.m1.1a"><msubsup id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2.2" xref="alg1.l11.m1.1.1.2.2.cmml">t</mi><mrow id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.3.1" xref="alg1.l11.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">k</mi></mrow><mtext id="alg1.l11.m1.1.1.2.3" xref="alg1.l11.m1.1.1.2.3a.cmml">final tokens</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><apply id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1">superscript</csymbol><ci id="alg1.l11.m1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.2.2">𝑡</ci><ci id="alg1.l11.m1.1.1.2.3a.cmml" xref="alg1.l11.m1.1.1.2.3"><mtext mathsize="70%" id="alg1.l11.m1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.2.3">final tokens</mtext></ci></apply><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><times id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3.1"></times><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝑛</ci><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">t^{\text{final tokens}}_{nk}</annotation></semantics></math> <math id="alg1.l11.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l11.m2.1a"><mo stretchy="false" id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><ci id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">\leftarrow</annotation></semantics></math> Indices of Match(<math id="alg1.l11.m3.1" class="ltx_Math" alttext="u_{nk}-p_{k}" display="inline"><semantics id="alg1.l11.m3.1a"><mrow id="alg1.l11.m3.1.1" xref="alg1.l11.m3.1.1.cmml"><msub id="alg1.l11.m3.1.1.2" xref="alg1.l11.m3.1.1.2.cmml"><mi id="alg1.l11.m3.1.1.2.2" xref="alg1.l11.m3.1.1.2.2.cmml">u</mi><mrow id="alg1.l11.m3.1.1.2.3" xref="alg1.l11.m3.1.1.2.3.cmml"><mi id="alg1.l11.m3.1.1.2.3.2" xref="alg1.l11.m3.1.1.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m3.1.1.2.3.1" xref="alg1.l11.m3.1.1.2.3.1.cmml">​</mo><mi id="alg1.l11.m3.1.1.2.3.3" xref="alg1.l11.m3.1.1.2.3.3.cmml">k</mi></mrow></msub><mo id="alg1.l11.m3.1.1.1" xref="alg1.l11.m3.1.1.1.cmml">−</mo><msub id="alg1.l11.m3.1.1.3" xref="alg1.l11.m3.1.1.3.cmml"><mi id="alg1.l11.m3.1.1.3.2" xref="alg1.l11.m3.1.1.3.2.cmml">p</mi><mi id="alg1.l11.m3.1.1.3.3" xref="alg1.l11.m3.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m3.1b"><apply id="alg1.l11.m3.1.1.cmml" xref="alg1.l11.m3.1.1"><minus id="alg1.l11.m3.1.1.1.cmml" xref="alg1.l11.m3.1.1.1"></minus><apply id="alg1.l11.m3.1.1.2.cmml" xref="alg1.l11.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l11.m3.1.1.2.1.cmml" xref="alg1.l11.m3.1.1.2">subscript</csymbol><ci id="alg1.l11.m3.1.1.2.2.cmml" xref="alg1.l11.m3.1.1.2.2">𝑢</ci><apply id="alg1.l11.m3.1.1.2.3.cmml" xref="alg1.l11.m3.1.1.2.3"><times id="alg1.l11.m3.1.1.2.3.1.cmml" xref="alg1.l11.m3.1.1.2.3.1"></times><ci id="alg1.l11.m3.1.1.2.3.2.cmml" xref="alg1.l11.m3.1.1.2.3.2">𝑛</ci><ci id="alg1.l11.m3.1.1.2.3.3.cmml" xref="alg1.l11.m3.1.1.2.3.3">𝑘</ci></apply></apply><apply id="alg1.l11.m3.1.1.3.cmml" xref="alg1.l11.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m3.1.1.3.1.cmml" xref="alg1.l11.m3.1.1.3">subscript</csymbol><ci id="alg1.l11.m3.1.1.3.2.cmml" xref="alg1.l11.m3.1.1.3.2">𝑝</ci><ci id="alg1.l11.m3.1.1.3.3.cmml" xref="alg1.l11.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m3.1c">u_{nk}-p_{k}</annotation></semantics></math>, <math id="alg1.l11.m4.1" class="ltx_Math" alttext="t_{v}" display="inline"><semantics id="alg1.l11.m4.1a"><msub id="alg1.l11.m4.1.1" xref="alg1.l11.m4.1.1.cmml"><mi id="alg1.l11.m4.1.1.2" xref="alg1.l11.m4.1.1.2.cmml">t</mi><mi id="alg1.l11.m4.1.1.3" xref="alg1.l11.m4.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m4.1b"><apply id="alg1.l11.m4.1.1.cmml" xref="alg1.l11.m4.1.1"><csymbol cd="ambiguous" id="alg1.l11.m4.1.1.1.cmml" xref="alg1.l11.m4.1.1">subscript</csymbol><ci id="alg1.l11.m4.1.1.2.cmml" xref="alg1.l11.m4.1.1.2">𝑡</ci><ci id="alg1.l11.m4.1.1.3.cmml" xref="alg1.l11.m4.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m4.1c">t_{v}</annotation></semantics></math>) on all entries <math id="alg1.l11.m5.1" class="ltx_Math" alttext="d&gt;d^{\prime}" display="inline"><semantics id="alg1.l11.m5.1a"><mrow id="alg1.l11.m5.1.1" xref="alg1.l11.m5.1.1.cmml"><mi id="alg1.l11.m5.1.1.2" xref="alg1.l11.m5.1.1.2.cmml">d</mi><mo id="alg1.l11.m5.1.1.1" xref="alg1.l11.m5.1.1.1.cmml">&gt;</mo><msup id="alg1.l11.m5.1.1.3" xref="alg1.l11.m5.1.1.3.cmml"><mi id="alg1.l11.m5.1.1.3.2" xref="alg1.l11.m5.1.1.3.2.cmml">d</mi><mo id="alg1.l11.m5.1.1.3.3" xref="alg1.l11.m5.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m5.1b"><apply id="alg1.l11.m5.1.1.cmml" xref="alg1.l11.m5.1.1"><gt id="alg1.l11.m5.1.1.1.cmml" xref="alg1.l11.m5.1.1.1"></gt><ci id="alg1.l11.m5.1.1.2.cmml" xref="alg1.l11.m5.1.1.2">𝑑</ci><apply id="alg1.l11.m5.1.1.3.cmml" xref="alg1.l11.m5.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m5.1.1.3.1.cmml" xref="alg1.l11.m5.1.1.3">superscript</csymbol><ci id="alg1.l11.m5.1.1.3.2.cmml" xref="alg1.l11.m5.1.1.3.2">𝑑</ci><ci id="alg1.l11.m5.1.1.3.3.cmml" xref="alg1.l11.m5.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m5.1c">d&gt;d^{\prime}</annotation></semantics></math>

</div>
</div>
</figure>
<div id="S3.SS1.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS0.Px1.p2.27" class="ltx_p"><span id="S3.SS1.SSS0.Px1.p2.27.1" class="ltx_text ltx_font_bold">Recovering Input Embeddings:</span>
As a first step, we recover all input embeddings <math id="S3.SS1.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="u_{h}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.1.m1.1a"><msub id="S3.SS1.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS1.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.1.m1.1.1.2" xref="S3.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml">u</mi><mi id="S3.SS1.SSS0.Px1.p2.1.m1.1.1.3" xref="S3.SS1.SSS0.Px1.p2.1.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.1.m1.1b"><apply id="S3.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.1.1.2">𝑢</ci><ci id="S3.SS1.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.1.m1.1c">u_{h}</annotation></semantics></math> using the divided difference method described in <a href="#S3.E3" title="In Unmixing Gradient Signals: ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">3</span></a> for all rows where <math id="S3.SS1.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="\nabla_{b^{i}_{j}}-\nabla_{b^{i}_{j+1}}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.2.m2.1a"><mrow id="S3.SS1.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml"><mo id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.2" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.2.cmml">∇</mo><msubsup id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.2.2" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.2.2.cmml">b</mi><mi id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.3" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.3.cmml">j</mi><mi id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.2.3" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.2.3.cmml">i</mi></msubsup></msub><mo lspace="0em" id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.1" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml">−</mo><msub id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.cmml"><mo id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.2.cmml">∇</mo><msubsup id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.2.2" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.cmml">b</mi><mrow id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.2" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.2.cmml">j</mi><mo id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.1" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.3" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.3.cmml">1</mn></mrow><mi id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.2.3" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.2.3.cmml">i</mi></msubsup></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.2.m2.1b"><apply id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1"><minus id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.1"></minus><apply id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.2">∇</ci><apply id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.2.2">𝑏</ci><ci id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.2">∇</ci><apply id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.2.2">𝑏</ci><ci id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3"><plus id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.2">𝑗</ci><cn type="integer" id="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.2.m2.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.2.m2.1c">\nabla_{b^{i}_{j}}-\nabla_{b^{i}_{j+1}}</annotation></semantics></math> is non-zero, i.e. at least one embedding exist with
<math id="S3.SS1.SSS0.Px1.p2.3.m3.2" class="ltx_Math" alttext="-b_{j}&lt;\langle m,u_{k}\rangle&lt;-b_{j+1}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.3.m3.2a"><mrow id="S3.SS1.SSS0.Px1.p2.3.m3.2.2" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.cmml"><mrow id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.cmml"><mo id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3a" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.cmml">−</mo><msub id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2.cmml"><mi id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2.2" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2.2.cmml">b</mi><mi id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2.3" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2.3.cmml">j</mi></msub></mrow><mo id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.4" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.4.cmml">&lt;</mo><mrow id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.2" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.2.cmml">⟨</mo><mi id="S3.SS1.SSS0.Px1.p2.3.m3.1.1" xref="S3.SS1.SSS0.Px1.p2.3.m3.1.1.cmml">m</mi><mo id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.3" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.2.cmml">,</mo><msub id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1.2" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1.2.cmml">u</mi><mi id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1.3" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.4" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.2.cmml">⟩</mo></mrow><mo id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.5" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.5.cmml">&lt;</mo><mrow id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.cmml"><mo id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6a" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.cmml">−</mo><msub id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.cmml"><mi id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.2" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.2.cmml">b</mi><mrow id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.2" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.2.cmml">j</mi><mo id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.1" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.3" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.3.m3.2b"><apply id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2"><and id="S3.SS1.SSS0.Px1.p2.3.m3.2.2a.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2"></and><apply id="S3.SS1.SSS0.Px1.p2.3.m3.2.2b.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2"><lt id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.4.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.4"></lt><apply id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3"><minus id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3"></minus><apply id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2.2">𝑏</ci><ci id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.3.2.3">𝑗</ci></apply></apply><list id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1"><ci id="S3.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.1.1">𝑚</ci><apply id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1.2">𝑢</ci><ci id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.1.1.3">𝑘</ci></apply></list></apply><apply id="S3.SS1.SSS0.Px1.p2.3.m3.2.2c.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2"><lt id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.5.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.5"></lt><share href="#S3.SS1.SSS0.Px1.p2.3.m3.2.2.1.cmml" id="S3.SS1.SSS0.Px1.p2.3.m3.2.2d.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2"></share><apply id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6"><minus id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.1.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6"></minus><apply id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.1.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.2.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.2">𝑏</ci><apply id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3"><plus id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.1"></plus><ci id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.2">𝑗</ci><cn type="integer" id="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.3.m3.2.2.6.2.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.3.m3.2c">-b_{j}&lt;\langle m,u_{k}\rangle&lt;-b_{j+1}</annotation></semantics></math>. This results in a list of vectors <math id="S3.SS1.SSS0.Px1.p2.4.m4.1" class="ltx_Math" alttext="u_{h}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.4.m4.1a"><msub id="S3.SS1.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.2" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml">u</mi><mi id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.4.m4.1b"><apply id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.2">𝑢</ci><ci id="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.4.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.4.m4.1c">u_{h}</annotation></semantics></math> with <math id="S3.SS1.SSS0.Px1.p2.5.m5.1" class="ltx_Math" alttext="h&lt;SN" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.5.m5.1a"><mrow id="S3.SS1.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.2" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml">h</mi><mo id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.1" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.1.cmml">&lt;</mo><mrow id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.5.m5.1b"><apply id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1"><lt id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.1"></lt><ci id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.2">ℎ</ci><apply id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3"><times id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.2">𝑆</ci><ci id="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.5.m5.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.5.m5.1c">h&lt;SN</annotation></semantics></math>, for maximal sequence length <math id="S3.SS1.SSS0.Px1.p2.6.m6.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.6.m6.1a"><mi id="S3.SS1.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS1.SSS0.Px1.p2.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.6.m6.1b"><ci id="S3.SS1.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.6.m6.1c">S</annotation></semantics></math> and maximal number of expected sequences <math id="S3.SS1.SSS0.Px1.p2.7.m7.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.7.m7.1a"><mi id="S3.SS1.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.7.m7.1b"><ci id="S3.SS1.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.7.m7.1c">N</annotation></semantics></math>, that have to be matched to separate sequences, positions and tokens.
<br class="ltx_break"><span id="S3.SS1.SSS0.Px1.p2.27.2" class="ltx_text ltx_font_bold">Recovering Sequence Clusters:</span>
The first <math id="S3.SS1.SSS0.Px1.p2.8.m8.1" class="ltx_Math" alttext="d^{\prime}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.8.m8.1a"><msup id="S3.SS1.SSS0.Px1.p2.8.m8.1.1" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.2" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.2.cmml">d</mi><mo id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.8.m8.1b"><apply id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.2">𝑑</ci><ci id="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.8.m8.1c">d^{\prime}</annotation></semantics></math> entries of each embedding encode the sequence identity as described in <a href="#S3.SS0.SSS0.Px3" title="Disambiguating Multiple Sequences ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3</span></a>. The server can hence group the embeddings <math id="S3.SS1.SSS0.Px1.p2.9.m9.1" class="ltx_Math" alttext="u_{h}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.9.m9.1a"><msub id="S3.SS1.SSS0.Px1.p2.9.m9.1.1" xref="S3.SS1.SSS0.Px1.p2.9.m9.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.9.m9.1.1.2" xref="S3.SS1.SSS0.Px1.p2.9.m9.1.1.2.cmml">u</mi><mi id="S3.SS1.SSS0.Px1.p2.9.m9.1.1.3" xref="S3.SS1.SSS0.Px1.p2.9.m9.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.9.m9.1b"><apply id="S3.SS1.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.9.m9.1.1.2">𝑢</ci><ci id="S3.SS1.SSS0.Px1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.9.m9.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.9.m9.1c">u_{h}</annotation></semantics></math> uniquely into their sequences by a clustering algorithm. We utilize constrained K-Means as described in <cite class="ltx_cite ltx_citemacro_citep">(Bradley et al., <a href="#bib.bib6" title="" class="ltx_ref">2000</a>)</cite>, as the maximal sequence length <math id="S3.SS1.SSS0.Px1.p2.10.m10.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.10.m10.1a"><mi id="S3.SS1.SSS0.Px1.p2.10.m10.1.1" xref="S3.SS1.SSS0.Px1.p2.10.m10.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.10.m10.1b"><ci id="S3.SS1.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.10.m10.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.10.m10.1c">S</annotation></semantics></math> and hence cluster size is known. This results in a label for each vector <math id="S3.SS1.SSS0.Px1.p2.11.m11.1" class="ltx_Math" alttext="u_{h}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.11.m11.1a"><msub id="S3.SS1.SSS0.Px1.p2.11.m11.1.1" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.2" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.2.cmml">u</mi><mi id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.11.m11.1b"><apply id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.2">𝑢</ci><ci id="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.11.m11.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.11.m11.1c">u_{h}</annotation></semantics></math>, sorting them into separate sequences.
<br class="ltx_break"><span id="S3.SS1.SSS0.Px1.p2.27.3" class="ltx_text ltx_font_bold">Assigning Positions in each Sequence:</span>
Now, the matching problem has been reduced to separately matching each sequence, based on all entries <math id="S3.SS1.SSS0.Px1.p2.12.m12.1" class="ltx_Math" alttext="d&gt;d^{\prime}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.12.m12.1a"><mrow id="S3.SS1.SSS0.Px1.p2.12.m12.1.1" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.2" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.2.cmml">d</mi><mo id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.1" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.1.cmml">&gt;</mo><msup id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3.2.cmml">d</mi><mo id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.12.m12.1b"><apply id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1"><gt id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.1"></gt><ci id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.2">𝑑</ci><apply id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3.2">𝑑</ci><ci id="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.12.m12.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.12.m12.1c">d&gt;d^{\prime}</annotation></semantics></math>. For a given sequence with index <math id="S3.SS1.SSS0.Px1.p2.13.m13.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.13.m13.1a"><mi id="S3.SS1.SSS0.Px1.p2.13.m13.1.1" xref="S3.SS1.SSS0.Px1.p2.13.m13.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.13.m13.1b"><ci id="S3.SS1.SSS0.Px1.p2.13.m13.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.13.m13.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.13.m13.1c">n</annotation></semantics></math> first match the embedding <math id="S3.SS1.SSS0.Px1.p2.14.m14.1" class="ltx_Math" alttext="u_{hn}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.14.m14.1a"><msub id="S3.SS1.SSS0.Px1.p2.14.m14.1.1" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.2" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1.2.cmml">u</mi><mrow id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.14.m14.1b"><apply id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1.2">𝑢</ci><apply id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3"><times id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.2">ℎ</ci><ci id="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.14.m14.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.14.m14.1c">u_{hn}</annotation></semantics></math> to the available positional embeddings <math id="S3.SS1.SSS0.Px1.p2.15.m15.1" class="ltx_Math" alttext="P_{k}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.15.m15.1a"><msub id="S3.SS1.SSS0.Px1.p2.15.m15.1.1" xref="S3.SS1.SSS0.Px1.p2.15.m15.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.15.m15.1.1.2" xref="S3.SS1.SSS0.Px1.p2.15.m15.1.1.2.cmml">P</mi><mi id="S3.SS1.SSS0.Px1.p2.15.m15.1.1.3" xref="S3.SS1.SSS0.Px1.p2.15.m15.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.15.m15.1b"><apply id="S3.SS1.SSS0.Px1.p2.15.m15.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.15.m15.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.15.m15.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.15.m15.1.1.2">𝑃</ci><ci id="S3.SS1.SSS0.Px1.p2.15.m15.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.15.m15.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.15.m15.1c">P_{k}</annotation></semantics></math>. To do so, we construct the matrix of correlations between all <math id="S3.SS1.SSS0.Px1.p2.16.m16.1" class="ltx_Math" alttext="u_{hn}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.16.m16.1a"><msub id="S3.SS1.SSS0.Px1.p2.16.m16.1.1" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.2" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1.2.cmml">u</mi><mrow id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.16.m16.1b"><apply id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1.2">𝑢</ci><apply id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3"><times id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.2">ℎ</ci><ci id="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.16.m16.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.16.m16.1c">u_{hn}</annotation></semantics></math> and <math id="S3.SS1.SSS0.Px1.p2.17.m17.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.17.m17.1a"><msub id="S3.SS1.SSS0.Px1.p2.17.m17.1.1" xref="S3.SS1.SSS0.Px1.p2.17.m17.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.17.m17.1.1.2" xref="S3.SS1.SSS0.Px1.p2.17.m17.1.1.2.cmml">p</mi><mi id="S3.SS1.SSS0.Px1.p2.17.m17.1.1.3" xref="S3.SS1.SSS0.Px1.p2.17.m17.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.17.m17.1b"><apply id="S3.SS1.SSS0.Px1.p2.17.m17.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.17.m17.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.17.m17.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.17.m17.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.17.m17.1.1.2">𝑝</ci><ci id="S3.SS1.SSS0.Px1.p2.17.m17.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.17.m17.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.17.m17.1c">p_{k}</annotation></semantics></math> and solve a rectangular linear sum assignment to find the optimal position <math id="S3.SS1.SSS0.Px1.p2.18.m18.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.18.m18.1a"><msub id="S3.SS1.SSS0.Px1.p2.18.m18.1.1" xref="S3.SS1.SSS0.Px1.p2.18.m18.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.18.m18.1.1.2" xref="S3.SS1.SSS0.Px1.p2.18.m18.1.1.2.cmml">p</mi><mi id="S3.SS1.SSS0.Px1.p2.18.m18.1.1.3" xref="S3.SS1.SSS0.Px1.p2.18.m18.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.18.m18.1b"><apply id="S3.SS1.SSS0.Px1.p2.18.m18.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.18.m18.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.18.m18.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.18.m18.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.18.m18.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.18.m18.1.1.2">𝑝</ci><ci id="S3.SS1.SSS0.Px1.p2.18.m18.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.18.m18.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.18.m18.1c">p_{k}</annotation></semantics></math> for each <math id="S3.SS1.SSS0.Px1.p2.19.m19.1" class="ltx_Math" alttext="u_{hn}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.19.m19.1a"><msub id="S3.SS1.SSS0.Px1.p2.19.m19.1.1" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.2" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1.2.cmml">u</mi><mrow id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.19.m19.1b"><apply id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1.2">𝑢</ci><apply id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3"><times id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.2">ℎ</ci><ci id="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.19.m19.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.19.m19.1c">u_{hn}</annotation></semantics></math>. For the assignment problem, we use the solver proposed in <cite class="ltx_cite ltx_citemacro_citet">Crouse (<a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite> which is a modification of the shortest augmenting path strategy originally proposed in <cite class="ltx_cite ltx_citemacro_citet">Jonker &amp; Volgenant (<a href="#bib.bib28" title="" class="ltx_ref">1987</a>)</cite>. Due to collisions, some positions will possibly not be filled after this initial matching step. We thus iteratively fill up un-matched positions with the best-matching embeddings from <math id="S3.SS1.SSS0.Px1.p2.20.m20.1" class="ltx_Math" alttext="u_{hn}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.20.m20.1a"><msub id="S3.SS1.SSS0.Px1.p2.20.m20.1.1" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.2" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1.2.cmml">u</mi><mrow id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.20.m20.1b"><apply id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1.2">𝑢</ci><apply id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3"><times id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.2">ℎ</ci><ci id="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.20.m20.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.20.m20.1c">u_{hn}</annotation></semantics></math>, even if they have been used before in other positions, until each position is assigned a match.
<br class="ltx_break"><span id="S3.SS1.SSS0.Px1.p2.27.4" class="ltx_text ltx_font_bold">Converting Embeddings to Tokens:</span>
Finally, we match all <math id="S3.SS1.SSS0.Px1.p2.21.m21.1" class="ltx_Math" alttext="u_{nk}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.21.m21.1a"><msub id="S3.SS1.SSS0.Px1.p2.21.m21.1.1" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.2" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1.2.cmml">u</mi><mrow id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.21.m21.1b"><apply id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1.2">𝑢</ci><apply id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3"><times id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.2">𝑛</ci><ci id="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.21.m21.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.21.m21.1c">u_{nk}</annotation></semantics></math> to all token embeddings <math id="S3.SS1.SSS0.Px1.p2.22.m22.1" class="ltx_Math" alttext="t_{v}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.22.m22.1a"><msub id="S3.SS1.SSS0.Px1.p2.22.m22.1.1" xref="S3.SS1.SSS0.Px1.p2.22.m22.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.22.m22.1.1.2" xref="S3.SS1.SSS0.Px1.p2.22.m22.1.1.2.cmml">t</mi><mi id="S3.SS1.SSS0.Px1.p2.22.m22.1.1.3" xref="S3.SS1.SSS0.Px1.p2.22.m22.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.22.m22.1b"><apply id="S3.SS1.SSS0.Px1.p2.22.m22.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.22.m22.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.22.m22.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.22.m22.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.22.m22.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.22.m22.1.1.2">𝑡</ci><ci id="S3.SS1.SSS0.Px1.p2.22.m22.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.22.m22.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.22.m22.1c">t_{v}</annotation></semantics></math> in either our bag of possible tokens or all tokens in the vocabulary. For this, we first subtract or decorrelate the positional encoding <math id="S3.SS1.SSS0.Px1.p2.23.m23.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.23.m23.1a"><msub id="S3.SS1.SSS0.Px1.p2.23.m23.1.1" xref="S3.SS1.SSS0.Px1.p2.23.m23.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.23.m23.1.1.2" xref="S3.SS1.SSS0.Px1.p2.23.m23.1.1.2.cmml">p</mi><mi id="S3.SS1.SSS0.Px1.p2.23.m23.1.1.3" xref="S3.SS1.SSS0.Px1.p2.23.m23.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.23.m23.1b"><apply id="S3.SS1.SSS0.Px1.p2.23.m23.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.23.m23.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.23.m23.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.23.m23.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.23.m23.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.23.m23.1.1.2">𝑝</ci><ci id="S3.SS1.SSS0.Px1.p2.23.m23.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.23.m23.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.23.m23.1c">p_{k}</annotation></semantics></math> from <math id="S3.SS1.SSS0.Px1.p2.24.m24.1" class="ltx_Math" alttext="u_{nk}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.24.m24.1a"><msub id="S3.SS1.SSS0.Px1.p2.24.m24.1.1" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.2" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1.2.cmml">u</mi><mrow id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.24.m24.1b"><apply id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1.2">𝑢</ci><apply id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3"><times id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.2">𝑛</ci><ci id="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.24.m24.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.24.m24.1c">u_{nk}</annotation></semantics></math> to remove interference, and then again solve a linear sum assignment problem as described. The indices of the solution to this assignment problem will finally be the token ids <math id="S3.SS1.SSS0.Px1.p2.25.m25.1" class="ltx_Math" alttext="t_{nk}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.25.m25.1a"><msub id="S3.SS1.SSS0.Px1.p2.25.m25.1.1" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.2" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1.2.cmml">t</mi><mrow id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.2" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.1" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.1.cmml">​</mo><mi id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.3" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.25.m25.1b"><apply id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1.2">𝑡</ci><apply id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3"><times id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.2">𝑛</ci><ci id="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p2.25.m25.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.25.m25.1c">t_{nk}</annotation></semantics></math> for each position <math id="S3.SS1.SSS0.Px1.p2.26.m26.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.26.m26.1a"><mi id="S3.SS1.SSS0.Px1.p2.26.m26.1.1" xref="S3.SS1.SSS0.Px1.p2.26.m26.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.26.m26.1b"><ci id="S3.SS1.SSS0.Px1.p2.26.m26.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.26.m26.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.26.m26.1c">k</annotation></semantics></math> in sequence <math id="S3.SS1.SSS0.Px1.p2.27.m27.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.SSS0.Px1.p2.27.m27.1a"><mi id="S3.SS1.SSS0.Px1.p2.27.m27.1.1" xref="S3.SS1.SSS0.Px1.p2.27.m27.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p2.27.m27.1b"><ci id="S3.SS1.SSS0.Px1.p2.27.m27.1.1.cmml" xref="S3.SS1.SSS0.Px1.p2.27.m27.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p2.27.m27.1c">n</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.SSS0.Px1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS0.Px1.p3.1" class="ltx_p">In general, this process works very well to recover batches containing multiple long sequences. In the limit of many tokens, the quality of recovery eventually degrades as collisions become more common, making the identification of positions and token id less certain. In the regime of a massive number of tokens, only a subset of positions are accurately recovered, and the remaining tokens are inaccurate, appearing in wrong positions. This process is random, and even for a massive number of tokens there are often some sequences that can be recovered very well.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Empirical Evaluation of the Attack</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">We evaluate the proposed attack using a range of Transformers. Our main focus is the application to next-word prediction as emphasized in practical use-cases <cite class="ltx_cite ltx_citemacro_citep">(Hard et al., <a href="#bib.bib23" title="" class="ltx_ref">2019</a>; Ramaswamy et al., <a href="#bib.bib48" title="" class="ltx_ref">2019</a>)</cite>. We consider three architectures of differing sizes: the small 3-layer Transformer discussed as a template for federated learning scenarios in <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a href="#bib.bib55" title="" class="ltx_ref">2021</a>)</cite> (11M parameters), the BERT-Base model <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite> attacked in previous work <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a href="#bib.bib12" title="" class="ltx_ref">2021</a>; Zhu et al., <a href="#bib.bib60" title="" class="ltx_ref">2019</a>)</cite> (110M parameters), and the smallest GPT-2 variation <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib47" title="" class="ltx_ref">2019</a>)</cite> (124M parameters). We train the small Transformer and GPT-2 as causal language models and BERT as a masked language model. Predictably, the attack performance degrades most quickly for the 3-layer Transformer as this has the fewest parameters and thus the least capacity to uniquely capture a large number of user embeddings.</p>
</div>
<figure id="S4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x3.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="186" height="123" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x4.png" id="S4.F6.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="186" height="123" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span id="S4.F6.4.1" class="ltx_text ltx_font_bold">Total Average Accuracy</span>. Total accuracy (i.e. percentage of tokens recovered correctly in their correct position) for all considered and varying batch sizes for sequence length 32 from <span id="S4.F6.5.2" class="ltx_text ltx_font_typewriter">wikitext</span>(left) and sequence length 512 from <span id="S4.F6.6.3" class="ltx_text ltx_font_typewriter">stackoverflow</span> (right).</figcaption>
</figure>
<figure id="S4.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x5.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="186" height="123" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x6.png" id="S4.F7.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="186" height="123" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span id="S4.F7.4.1" class="ltx_text ltx_font_bold">Most-vulnerable Accuracy</span>. Accuracy on the most-leaked sentence for sequence length 32 from <span id="S4.F7.5.2" class="ltx_text ltx_font_typewriter">wikitext</span>(left) and sequence length 512 from <span id="S4.F7.6.3" class="ltx_text ltx_font_typewriter">stackoverflow</span> (right). Note the size difference between BERT/GPT and the small transformer depicted here.</figcaption>
</figure>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.1" class="ltx_p">We test this attack on several datasets, <span id="S4.p2.1.1" class="ltx_text ltx_font_typewriter">wikitext</span> <cite class="ltx_cite ltx_citemacro_citep">(Merity et al., <a href="#bib.bib40" title="" class="ltx_ref">2016</a>)</cite>
<span id="S4.p2.1.2" class="ltx_text ltx_font_typewriter">shakespeare</span> <cite class="ltx_cite ltx_citemacro_citep">(Caldas et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite> and <span id="S4.p2.1.3" class="ltx_text ltx_font_typewriter">stackoverflow</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib55" title="" class="ltx_ref">2021</a>)</cite>.
For <span id="S4.p2.1.4" class="ltx_text ltx_font_typewriter">wikitext</span>, We partition into separate “users” by article, while for the other datasets user partitions are given. We tokenize using the GPT-2 (BPE) tokenizer for the small Transformer and GPT-2, and the original BERT (WordPiece) tokenizer for BERT.
We always report average scores over the first 100 users, which are have enough data to fill batch size <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.p2.1.m1.1a"><mo id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><times id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\times</annotation></semantics></math> sequence length tokens, skipping users with less data who would be more vulnerable. We focus on fedSGD, i.e. single gradient updates from all users, but note the option of a malicious server to convert another protocol to fedSGD discussed in <a href="#S3" title="3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.1" class="ltx_p">We evaluate using <em id="S4.p3.1.1" class="ltx_emph ltx_font_italic">total</em> average accuracy, BLEU <cite class="ltx_cite ltx_citemacro_citep">(Papineni et al., <a href="#bib.bib43" title="" class="ltx_ref">2002</a>)</cite> and ROUGE-L <cite class="ltx_cite ltx_citemacro_citep">(Lin, <a href="#bib.bib34" title="" class="ltx_ref">2004</a>)</cite>. Our total accuracy is stricter than the token (i.e., bag-of-words) accuracy described previously <cite class="ltx_cite ltx_citemacro_citet">Deng et al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite>; we only count success if both token id <em id="S4.p3.1.2" class="ltx_emph ltx_font_italic">and</em> position are correct. <a href="#S1.F1" title="In 1 Introduction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a> shows partial reconstructions for a randomly selected, challenging sequence as batch size and sequence length increase. We find that even for more difficult scenarios with more tokens, a vast majority of tokens are recovered, with a majority in their <em id="S4.p3.1.3" class="ltx_emph ltx_font_italic">exact</em> correct position.</p>
</div>
<div id="S4.p4" class="ltx_para ltx_noindent">
<p id="S4.p4.4" class="ltx_p"><span id="S4.p4.4.1" class="ltx_text ltx_font_bold">Average Accuracy:</span>
Our multi-head attention strategy allows an attacker to reconstruct larger batches of sequences, as seen in <a href="#S4.F6" title="In 4 Empirical Evaluation of the Attack ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">6</span></a> (We include single sequences in <a href="#A5.F16" title="In E.2 GELU ‣ Appendix E Variants and Details ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">16</span></a>). This applies to an update from a single user with more than one sequence, and also multiple users aggregating model updates. To the best of our knowledge, this is the first approach to explicitly attack multi-user updates with <span id="S4.p4.4.2" class="ltx_text ltx_font_italic">strong average</span> accuracy. We find that for a sequence length of <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S4.p4.1.m1.1a"><mn id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><cn type="integer" id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">32</annotation></semantics></math>, the proposed attack can recover almost all tokens used in the user updates, and <math id="S4.p4.2.m2.1" class="ltx_Math" alttext="&gt;50\%" display="inline"><semantics id="S4.p4.2.m2.1a"><mrow id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml"><mi id="S4.p4.2.m2.1.1.2" xref="S4.p4.2.m2.1.1.2.cmml"></mi><mo id="S4.p4.2.m2.1.1.1" xref="S4.p4.2.m2.1.1.1.cmml">&gt;</mo><mrow id="S4.p4.2.m2.1.1.3" xref="S4.p4.2.m2.1.1.3.cmml"><mn id="S4.p4.2.m2.1.1.3.2" xref="S4.p4.2.m2.1.1.3.2.cmml">50</mn><mo id="S4.p4.2.m2.1.1.3.1" xref="S4.p4.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><apply id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1"><gt id="S4.p4.2.m2.1.1.1.cmml" xref="S4.p4.2.m2.1.1.1"></gt><csymbol cd="latexml" id="S4.p4.2.m2.1.1.2.cmml" xref="S4.p4.2.m2.1.1.2">absent</csymbol><apply id="S4.p4.2.m2.1.1.3.cmml" xref="S4.p4.2.m2.1.1.3"><csymbol cd="latexml" id="S4.p4.2.m2.1.1.3.1.cmml" xref="S4.p4.2.m2.1.1.3.1">percent</csymbol><cn type="integer" id="S4.p4.2.m2.1.1.3.2.cmml" xref="S4.p4.2.m2.1.1.3.2">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">&gt;50\%</annotation></semantics></math> of tokens at their <em id="S4.p4.4.3" class="ltx_emph ltx_font_italic">exact</em> position for <math id="S4.p4.3.m3.1" class="ltx_Math" alttext="&gt;100" display="inline"><semantics id="S4.p4.3.m3.1a"><mrow id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml"><mi id="S4.p4.3.m3.1.1.2" xref="S4.p4.3.m3.1.1.2.cmml"></mi><mo id="S4.p4.3.m3.1.1.1" xref="S4.p4.3.m3.1.1.1.cmml">&gt;</mo><mn id="S4.p4.3.m3.1.1.3" xref="S4.p4.3.m3.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><apply id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1"><gt id="S4.p4.3.m3.1.1.1.cmml" xref="S4.p4.3.m3.1.1.1"></gt><csymbol cd="latexml" id="S4.p4.3.m3.1.1.2.cmml" xref="S4.p4.3.m3.1.1.2">absent</csymbol><cn type="integer" id="S4.p4.3.m3.1.1.3.cmml" xref="S4.p4.3.m3.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">&gt;100</annotation></semantics></math> users. Even for a sequence length of <math id="S4.p4.4.m4.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.p4.4.m4.1a"><mn id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><cn type="integer" id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">512</annotation></semantics></math>, the attack remains effective for large batches.</p>
</div>
<div id="S4.p5" class="ltx_para ltx_noindent">
<p id="S4.p5.1" class="ltx_p"><span id="S4.p5.1.1" class="ltx_text ltx_font_bold">Most-vulnerable Accuracy:</span>
We further chart the accuracy on the most-recovered sequence in <a href="#S4.F7" title="In 4 Empirical Evaluation of the Attack ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">7</span></a>, finding that even at larger aggregation rates, some sequences remain vulnerable to attack and are almost perfectly recovered by an attacker.</p>
</div>
<figure id="S4.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x7.png" id="S4.F8.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="138" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x8.png" id="S4.F8.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="138" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span id="S4.F8.4.1" class="ltx_text ltx_font_bold">Comparing attacks on several data sources</span>. <span id="S4.F8.5.2" class="ltx_text ltx_font_bold">Left:</span> Total accuracy (i.e. percentage of tokens recovered correctly in their correct position) for GPT-2 and varying batch sizes with sequence length 32. <span id="S4.F8.6.3" class="ltx_text ltx_font_bold">Right:</span> Accuracy on the most-leaked sentence for all data sources.</figcaption>
</figure>
<div id="S4.p6" class="ltx_para">
<p id="S4.p6.1" class="ltx_p"><span id="S4.p6.1.1" class="ltx_text ltx_font_bold">Comparison to other threat models.</span></p>
</div>
<figure id="S4.F9" class="ltx_figure"><img src="/html/2201.12675/assets/assets/tag_decepticon_trafo3_bs1.png" id="S4.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="494" height="142" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Comparison between the malicious server threat model with our attack and TAG (honest-but-curious) for the 3-layer transformer described in <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a href="#bib.bib55" title="" class="ltx_ref">2021</a>)</cite>, variable seq. length (batch size <math id="S4.F9.2.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.F9.2.m1.1b"><mn id="S4.F9.2.m1.1.1" xref="S4.F9.2.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.F9.2.m1.1c"><cn type="integer" id="S4.F9.2.m1.1.1.cmml" xref="S4.F9.2.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F9.2.m1.1d">1</annotation></semantics></math>) on <span id="S4.F9.4.1" class="ltx_text ltx_font_typewriter">wikitext</span>.</figcaption>
</figure>
<div id="S4.p7" class="ltx_para ltx_noindent">
<p id="S4.p7.3" class="ltx_p">Several works approached the topic of reconstructing text from FL updates, under a “honest-but-curious" threat model where benign parameters are sent to the user, and the FL protocol is performed normally. We compare by fixing an architecture – in this case the Transformer-3 model described earlier. We then consider the setting with batch size <math id="S4.p7.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.p7.1.m1.1a"><mn id="S4.p7.1.m1.1.1" xref="S4.p7.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.p7.1.m1.1b"><cn type="integer" id="S4.p7.1.m1.1.1.cmml" xref="S4.p7.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.1.m1.1c">1</annotation></semantics></math> and evaluate our proposed method against the TAG attack <cite class="ltx_cite ltx_citemacro_citet">Deng et al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite> which improves upon previous results in <cite class="ltx_cite ltx_citemacro_citet">Zhu et al. (<a href="#bib.bib60" title="" class="ltx_ref">2019</a>)</cite>. We experiment for varying sequence lengths in <a href="#S4.F9" title="In 4 Empirical Evaluation of the Attack ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">9</span></a>. The performance of TAG very quickly degrades for sequences of even moderate length. For a single sequence, our proposed attack maintains high total accuracy for sequences exceeding <math id="S4.p7.2.m2.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S4.p7.2.m2.1a"><mn id="S4.p7.2.m2.1.1" xref="S4.p7.2.m2.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S4.p7.2.m2.1b"><cn type="integer" id="S4.p7.2.m2.1.1.cmml" xref="S4.p7.2.m2.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.2.m2.1c">1000</annotation></semantics></math> tokens, whereas the total accuracy for TAG soon approaches <math id="S4.p7.3.m3.1" class="ltx_Math" alttext="0\%" display="inline"><semantics id="S4.p7.3.m3.1a"><mrow id="S4.p7.3.m3.1.1" xref="S4.p7.3.m3.1.1.cmml"><mn id="S4.p7.3.m3.1.1.2" xref="S4.p7.3.m3.1.1.2.cmml">0</mn><mo id="S4.p7.3.m3.1.1.1" xref="S4.p7.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p7.3.m3.1b"><apply id="S4.p7.3.m3.1.1.cmml" xref="S4.p7.3.m3.1.1"><csymbol cd="latexml" id="S4.p7.3.m3.1.1.1.cmml" xref="S4.p7.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S4.p7.3.m3.1.1.2.cmml" xref="S4.p7.3.m3.1.1.2">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.3.m3.1c">0\%</annotation></semantics></math>. Overall, we find that the severity of the threat posed by our attack is orders of magnitude greater than in the “honest-but-curious" threat model, and argue for the re-evaluation of the amount of privacy leaked by FL applications using transformers.</p>
</div>
<section id="S4.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Accuracy on other Datasets:</h5>

<div id="S4.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS0.SSS0.Px1.p1.1" class="ltx_p">The attack is largely invariant to the source of user text, as detailed in <a href="#S4.F8" title="In 4 Empirical Evaluation of the Attack ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">8</span></a>, where diverse sources of data are almost equally vulnerable. Shakespeare data is most vulnerable due to the use of short and simple sentences which are consistently well-recovered. Random text is noticeably more vulnerable, which is relevant from a security perspective, as an attacker often be interested in text fragments that are not usual text, e.g. passwords or social security numbers.</p>
</div>
</section>
<section id="S4.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Attack Confidence</h5>

<div id="S4.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS0.SSS0.Px2.p1.4" class="ltx_p">In contrast to existing attacks, the attacker can verify recovered tokens. After recovering positions and tokens for each breach <math id="S4.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="u_{h}" display="inline"><semantics id="S4.SS0.SSS0.Px2.p1.1.m1.1a"><msub id="S4.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS0.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml">u</mi><mi id="S4.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1.2">𝑢</ci><ci id="S4.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S4.SS0.SSS0.Px2.p1.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p1.1.m1.1c">u_{h}</annotation></semantics></math>, one can cross-check whether the assigned position <math id="S4.SS0.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S4.SS0.SSS0.Px2.p1.2.m2.1a"><msub id="S4.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S4.SS0.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml">p</mi><mi id="S4.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS0.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS0.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS0.SSS0.Px2.p1.2.m2.1.1.2">𝑝</ci><ci id="S4.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S4.SS0.SSS0.Px2.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p1.2.m2.1c">p_{k}</annotation></semantics></math> and token embedding <math id="S4.SS0.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="t_{v}" display="inline"><semantics id="S4.SS0.SSS0.Px2.p1.3.m3.1a"><msub id="S4.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S4.SS0.SSS0.Px2.p1.3.m3.1.1.2" xref="S4.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml">t</mi><mi id="S4.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="S4.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="S4.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS0.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S4.SS0.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S4.SS0.SSS0.Px2.p1.3.m3.1.1.2">𝑡</ci><ci id="S4.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S4.SS0.SSS0.Px2.p1.3.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p1.3.m3.1c">t_{v}</annotation></semantics></math> perfectly explain <math id="S4.SS0.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="u_{h}" display="inline"><semantics id="S4.SS0.SSS0.Px2.p1.4.m4.1a"><msub id="S4.SS0.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS0.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S4.SS0.SSS0.Px2.p1.4.m4.1.1.2" xref="S4.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml">u</mi><mi id="S4.SS0.SSS0.Px2.p1.4.m4.1.1.3" xref="S4.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px2.p1.4.m4.1b"><apply id="S4.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS0.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S4.SS0.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S4.SS0.SSS0.Px2.p1.4.m4.1.1.2">𝑢</ci><ci id="S4.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S4.SS0.SSS0.Px2.p1.4.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px2.p1.4.m4.1c">u_{h}</annotation></semantics></math>. Tokens that fulfill this condition are perfectly recovered and allow the attacker to certify which parts of their recovered text accurately reflect user data.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">In this work we re-evaluate the threat posed by attacks against privacy for FL for Transformer-based language models. We argue that from a user-perspective, the most natural threat model is not to trust the server state. We show that a malicious server can send updates that encode large amounts of private user data into the update sent by users. This attack and threat model significantly lower the bar for possible attacks, recovering up to several thousand tokens of user data. Our results underline the necessity of adoption of strong privacy guarantees for users in federated learning.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="S5.SS0.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Ethics Statement and Mitigations</h4>

<div id="S5.SS0.SSSx1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS0.SSSx1.p1.2" class="ltx_p">Several known case studies of FL models deployed in production in <cite class="ltx_cite ltx_citemacro_citet">Hard et al. (<a href="#bib.bib23" title="" class="ltx_ref">2019</a>); Hartmann (<a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite> rely only on aggregation to preserve privacy in FL for text. However, the attack we describe in this work shows that aggregation levels considered safe based on previous work may not be enough to protect user privacy in several use cases:
The setting deployed to production in <cite class="ltx_cite ltx_citemacro_citet">Hard et al. (<a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite> runs FL on users updates with <math id="S5.SS0.SSSx1.p1.1.m1.1" class="ltx_Math" alttext="400" display="inline"><semantics id="S5.SS0.SSSx1.p1.1.m1.1a"><mn id="S5.SS0.SSSx1.p1.1.m1.1.1" xref="S5.SS0.SSSx1.p1.1.m1.1.1.cmml">400</mn><annotation-xml encoding="MathML-Content" id="S5.SS0.SSSx1.p1.1.m1.1b"><cn type="integer" id="S5.SS0.SSSx1.p1.1.m1.1.1.cmml" xref="S5.SS0.SSSx1.p1.1.m1.1.1">400</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSSx1.p1.1.m1.1c">400</annotation></semantics></math> sentences with <math id="S5.SS0.SSSx1.p1.2.m2.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S5.SS0.SSSx1.p1.2.m2.1a"><mn id="S5.SS0.SSSx1.p1.2.m2.1.1" xref="S5.SS0.SSSx1.p1.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S5.SS0.SSSx1.p1.2.m2.1b"><cn type="integer" id="S5.SS0.SSSx1.p1.2.m2.1.1.cmml" xref="S5.SS0.SSSx1.p1.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS0.SSSx1.p1.2.m2.1c">4</annotation></semantics></math> words per average message sent to the server without further aggregation, well within the range of the investigated attack if trained with a transformer model.
We thus briefly discuss other mitigation strategies for attacks like this. We roughly group them into two categories: parameter inspection and differential privacy based defenses.</p>
</div>
<div id="S5.SS0.SSSx1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS0.SSSx1.p2.1" class="ltx_p">Parameter inspection and verification of the server state is currently not implemented in any major industrial FL framework <cite class="ltx_cite ltx_citemacro_citep">(Paulik et al., <a href="#bib.bib45" title="" class="ltx_ref">2021</a>; Dimitriadis et al., <a href="#bib.bib15" title="" class="ltx_ref">2022</a>; Li et al., <a href="#bib.bib32" title="" class="ltx_ref">2019</a>; Bonawitz et al., <a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite>, but after the publication of this attack, a rule could be designed to mitigate it (which we would encourage!). However, we caution that the design space for attacks as described here seems too large to be defended by inspecting parameters for a list of known attacks.</p>
</div>
<div id="S5.SS0.SSSx1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS0.SSSx1.p3.1" class="ltx_p">Based on these concerns, general differential privacy (DP) based defenses continue to be the more promising route.
Local or distributed differential privacy, controlled directly by the user and added directly on-device (instead of at the server level as in <cite class="ltx_cite ltx_citemacro_citet">McMahan et al. (<a href="#bib.bib38" title="" class="ltx_ref">2018</a>)</cite>) allows for general protection for users without the need to trust the update sent by the server <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib29" title="" class="ltx_ref">2021a</a>; Bhowmick et al., <a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite>. Local DP does come at a cost in utility, observed in theoretical <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib30" title="" class="ltx_ref">2021b</a>; Kasiviswanathan et al., <a href="#bib.bib31" title="" class="ltx_ref">2011</a>; Ullman, <a href="#bib.bib52" title="" class="ltx_ref">2021</a>)</cite> as well as practical investigations <cite class="ltx_cite ltx_citemacro_citep">(Jayaraman &amp; Evans, <a href="#bib.bib27" title="" class="ltx_ref">2019</a>)</cite> when a model is pretrained from scratch <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib33" title="" class="ltx_ref">2022</a>; Noble et al., <a href="#bib.bib41" title="" class="ltx_ref">2022</a>)</cite>. DP currently also comes at some cost in fairness, as model utility is reduced most for underrepresented groups <cite class="ltx_cite ltx_citemacro_citep">(Bagdasaryan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite>. Yet, as any attack on privacy will break down when faced with sufficient differential privacy, with this work we advocate for strong differential privacy on the user side, as incorporated for example into recent system designs in <cite class="ltx_cite ltx_citemacro_citet">Paulik et al. (<a href="#bib.bib45" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S5.SS0.SSSx1.p4" class="ltx_para ltx_noindent">
<p id="S5.SS0.SSSx1.p4.1" class="ltx_p">We include further discussion about mitigations in practice in <a href="#A7" title="Appendix G Mitigation Strategies ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">G</span></a>, including limited experimentation with gradient clipping/noising, as well as parameter inspection adaptations.</p>
</div>
<div id="S5.SS0.SSSx1.p5" class="ltx_para ltx_noindent">
<p id="S5.SS0.SSSx1.p5.1" class="ltx_p">Attacks like the one presented in this paper present a privacy risk to users and their data. As such, the publication of the possibility of attacks like the one described in this work has potential negative consequences for the privacy of deployed user systems that do not apply mitigation strategies as described above. As FL becomes more integrated into privacy-critical applications, it is of paramount importance that the community is aware of worst-case threats to user privacy, so that mitigating measures can be taken. If left undefended, an attack like this could compromise large amounts of user data, including sensitive text messages and emails. Because previous research on privacy attacks against language models in FL has been relatively scarce, some might believe that simple defenses such as aggregation are sufficient to ensure user privacy. This work shows that this belief is unfounded and further measures must be taken. We hope that this attack raises awareness of the vulnerability of FL models.</p>
</div>
</section>
<section id="S5.SS0.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Reproducibility Statement</h4>

<div id="S5.SS0.SSSx2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS0.SSSx2.p1.1" class="ltx_p">We provide technical details in <a href="#A1" title="Appendix A Technical Details ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">A</span></a>, and additional pseudocode for mentioned algorithms in <a href="#A2" title="Appendix B Algorithm Details ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">B</span></a> and provide code in conjunction with this submission to reproduce all attacks and settings discussed in this work, which can be found at <a href="github.com/JonasGeiping/breaching" title="" class="ltx_ref ltx_url ltx_font_typewriter">github.com/JonasGeiping/breaching</a>. We provide command-line interfaces and jupyter notebooks to evaluate the attacks and interactively vary parameters. All attacks discussed in this work can be cheaply reproduced using Laptop CPUs, as no extensive computations on GPUs are necessary to run the attack.</p>
</div>
</section>
<section id="S5.SS0.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Acknowledgements</h4>

<div id="S5.SS0.SSSx3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS0.SSSx3.p1.1" class="ltx_p">This work was supported by the Office of Naval Research (#N000142112557), the AFOSR MURI program, DARPA GARD (HR00112020007), the National Science Foundation (IIS-2212182), and Capital One Bank.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bagdasaryan et al. (2019)</span>
<span class="ltx_bibblock">
Eugene Bagdasaryan, Omid Poursaeed, and Vitaly Shmatikov.

</span>
<span class="ltx_bibblock">Differential Privacy Has Disparate Impact on Model Accuracy.

</span>
<span class="ltx_bibblock">In H. Wallach, H. Larochelle, A. Beygelzimer,
F. d\textquotesingle Alché-Buc, E. Fox, and R. Garnett
(eds.), <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 32</em>, pp. 15479–15488. Curran Associates, Inc., 2019.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="http://papers.nips.cc/paper/9681-differential-privacy-has-disparate-impact-on-model-accuracy.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://papers.nips.cc/paper/9681-differential-privacy-has-disparate-impact-on-model-accuracy.pdf</a>.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhowmick et al. (2019)</span>
<span class="ltx_bibblock">
Abhishek Bhowmick, John Duchi, Julien Freudiger, Gaurav Kapoor, and Ryan
Rogers.

</span>
<span class="ltx_bibblock">Protection Against Reconstruction and Its Applications in
Private Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv:1812.00984 [cs, stat]</em>, June 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1812.00984" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1812.00984</a>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Boenisch et al. (2021)</span>
<span class="ltx_bibblock">
Franziska Boenisch, Adam Dziedzic, Roei Schuster, Ali Shahin Shamsabadi, Ilia
Shumailov, and Nicolas Papernot.

</span>
<span class="ltx_bibblock">When the Curious Abandon Honesty: Federated Learning Is Not
Private.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv:2112.02918 [cs]</em>, December 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2112.02918" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2112.02918</a>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al. (2017)</span>
<span class="ltx_bibblock">
Kallista Bonawitz, Vladimir Ivanov, Ben Kreuter, Antonio Marcedone, H. Brendan
McMahan, Sarvar Patel, Daniel Ramage, Aaron Segal, and Karn Seth.

</span>
<span class="ltx_bibblock">Practical Secure Aggregation for Privacy Preserving Machine
Learning.

</span>
<span class="ltx_bibblock">Technical Report 281, 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://eprint.iacr.org/2017/281" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://eprint.iacr.org/2017/281</a>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al. (2019)</span>
<span class="ltx_bibblock">
Kallista Bonawitz, Hubert Eichner, Wolfgang Grieskamp, Dzmitry Huba, Alex
Ingerman, Vladimir Ivanov, Chloe Kiddon, Jakub Konečný, Stefano
Mazzocchi, H. Brendan McMahan, Timon Van Overveldt, David Petrou, Daniel
Ramage, and Jason Roselander.

</span>
<span class="ltx_bibblock">Towards Federated Learning at Scale: System Design.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv:1902.01046 [cs, stat]</em>, March 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1902.01046" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1902.01046</a>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bradley et al. (2000)</span>
<span class="ltx_bibblock">
Paul S. Bradley, Kristin P. Bennett, and Ayhan Demiriz.

</span>
<span class="ltx_bibblock">Constrained k-means clustering.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Microsoft Research, Redmond</em>, 20(0):0,
2000.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2021)</span>
<span class="ltx_bibblock">
Gavin Brown, Mark Bun, Vitaly Feldman, Adam Smith, and Kunal Talwar.

</span>
<span class="ltx_bibblock">When is Memorization of Irrelevant Training Data Necessary
for High-Accuracy Learning?

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 53rd Annual ACM SIGACT Symposium on
Theory of Computing</em>, pp.  123–132, June 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/3406325.3451131</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2012.06421" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2012.06421</a>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldas et al. (2019)</span>
<span class="ltx_bibblock">
Sebastian Caldas, Sai Meher Karthik Duddu, Peter Wu, Tian Li, Jakub Konečný, H. Brendan McMahan, Virginia Smith, and Ameet Talwalkar.

</span>
<span class="ltx_bibblock">LEAF: A Benchmark for Federated Settings.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arxiv:1812.01097[cs, stat]</em>, December 2019.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/arXiv.1812.01097</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1812.01097" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1812.01097</a>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini et al. (2021)</span>
<span class="ltx_bibblock">
Nicholas Carlini, Florian Tramèr, Eric Wallace, Matthew Jagielski, Ariel
Herbert-Voss, Katherine Lee, Adam Roberts, Tom Brown, Dawn Song, Úlfar
Erlingsson, Alina Oprea, and Colin Raffel.

</span>
<span class="ltx_bibblock">Extracting Training Data from Large Language Models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">30th USENIX Security Symposium (USENIX Security
21)</em>, pp.  2633–2650, 2021.

</span>
<span class="ltx_bibblock">ISBN 978-1-939133-24-3.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://www.usenix.org/conference/usenixsecurity21/presentation/carlini-extracting" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.usenix.org/conference/usenixsecurity21/presentation/carlini-extracting</a>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini et al. (2022)</span>
<span class="ltx_bibblock">
Nicholas Carlini, Daphne Ippolito, Matthew Jagielski, Katherine Lee, Florian
Tramer, and Chiyuan Zhang.

</span>
<span class="ltx_bibblock">Quantifying Memorization Across Neural Language Models.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arxiv:2202.07646[cs]</em>, February 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2202.07646" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2202.07646</a>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Crouse (2016)</span>
<span class="ltx_bibblock">
David F. Crouse.

</span>
<span class="ltx_bibblock">On implementing 2D rectangular assignment algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Aerospace and Electronic Systems</em>,
52(4):1679–1696, August 2016.

</span>
<span class="ltx_bibblock">ISSN 1557-9603.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/TAES.2016.140952</span>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2021)</span>
<span class="ltx_bibblock">
Jieren Deng, Yijue Wang, Ji Li, Chao Shang, Hang Liu, Sanguthevar Rajasekaran,
and Caiwen Ding.

</span>
<span class="ltx_bibblock">TAG: Gradient Attack on Transformer-based Language
Models.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv:2103.06819 [cs]</em>, September 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2103.06819" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2103.06819</a>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2020)</span>
<span class="ltx_bibblock">
Yuntian Deng, Anton Bakhtin, Myle Ott, Arthur Szlam, and Marc’Aurelio Ranzato.

</span>
<span class="ltx_bibblock">Residual Energy-Based Models for Text Generation.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv:2004.11714 [cs]</em>, April 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2004.11714" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2004.11714</a>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">BERT: Pre-training of Deep Bidirectional Transformers for
Language Understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv:1810.04805 [cs]</em>, May 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1810.04805" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1810.04805</a>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dimitriadis et al. (2022)</span>
<span class="ltx_bibblock">
Dimitrios Dimitriadis, Mirian Hipolito Garcia, Daniel Madrigal Diaz, Andre
Manoel, and Robert Sim.

</span>
<span class="ltx_bibblock">FLUTE: A Scalable, Extensible Framework for
High-Performance Federated Learning Simulations.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arxiv:2203.13789[cs]</em>, March 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2203.13789" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2203.13789</a>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dimitrov et al. (2022)</span>
<span class="ltx_bibblock">
Dimitar I. Dimitrov, Mislav Balunović, Nikola Jovanović, and Martin
Vechev.

</span>
<span class="ltx_bibblock">LAMP: Extracting Text from Gradients with Language
Model Priors.

</span>
<span class="ltx_bibblock">February 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2202.08827v1" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2202.08827v1</a>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dwork &amp; Roth (2013)</span>
<span class="ltx_bibblock">
Cynthia Dwork and Aaron Roth.

</span>
<span class="ltx_bibblock">The Algorithmic Foundations of Differential Privacy.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Theoretical Computer
Science</em>, 9(3-4):211–407, 2013.

</span>
<span class="ltx_bibblock">ISSN 1551-305X, 1551-3068.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1561/0400000042</span>.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="http://www.nowpublishers.com/articles/foundations-and-trends-in-theoretical-computer-science/TCS-042" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://www.nowpublishers.com/articles/foundations-and-trends-in-theoretical-computer-science/TCS-042</a>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fowl et al. (2021)</span>
<span class="ltx_bibblock">
Liam H. Fowl, Jonas Geiping, Wojciech Czaja, Micah Goldblum, and Tom Goldstein.

</span>
<span class="ltx_bibblock">Robbing the Fed: Directly Obtaining Private Data in
Federated Learning with Modified Models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>, September 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=fwzUgo0FM9v" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=fwzUgo0FM9v</a>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frey (2021)</span>
<span class="ltx_bibblock">
Suzanne Frey.

</span>
<span class="ltx_bibblock">Introducing Android’s Private Compute Services, September
2021.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://security.googleblog.com/2021/09/introducing-androids-private-compute.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://security.googleblog.com/2021/09/introducing-androids-private-compute.html</a>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geiping et al. (2020)</span>
<span class="ltx_bibblock">
Jonas Geiping, Hartmut Bauermeister, Hannah Dröge, and Michael Moeller.

</span>
<span class="ltx_bibblock">Inverting Gradients - How easy is it to break privacy in
federated learning?

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume 33, December 2020.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://proceedings.neurips.cc//paper_files/paper/2020/hash/c4ede56bbd98819ae6112b20ac6bf145-Abstract.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.neurips.cc//paper_files/paper/2020/hash/c4ede56bbd98819ae6112b20ac6bf145-Abstract.html</a>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Google Research (2019)</span>
<span class="ltx_bibblock">
Team Google Research.

</span>
<span class="ltx_bibblock">Federated Learning, May 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://federated.withgoogle.com" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://federated.withgoogle.com</a>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al. (2022)</span>
<span class="ltx_bibblock">
Samyak Gupta, Yangsibo Huang, Zexuan Zhong, Tianyu Gao, Kai Li, and Danqi Chen.

</span>
<span class="ltx_bibblock">Recovering Private Text in Federated Learning of Language
Models.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arxiv:2205.08514[cs]</em>, May 2022.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/arXiv.2205.08514</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2205.08514" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2205.08514</a>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hard et al. (2019)</span>
<span class="ltx_bibblock">
Andrew Hard, Kanishka Rao, Rajiv Mathews, Swaroop Ramaswamy, Françoise
Beaufays, Sean Augenstein, Hubert Eichner, Chloé Kiddon, and Daniel
Ramage.

</span>
<span class="ltx_bibblock">Federated Learning for Mobile Keyboard Prediction.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv:1811.03604 [cs]</em>, February 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1811.03604" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1811.03604</a>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hartmann (2021)</span>
<span class="ltx_bibblock">
Florian Hartmann.

</span>
<span class="ltx_bibblock">Predicting Text Selections with Federated Learning, November
2021.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="http://ai.googleblog.com/2021/11/predicting-text-selections-with.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://ai.googleblog.com/2021/11/predicting-text-selections-with.html</a>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks &amp; Gimpel (2016)</span>
<span class="ltx_bibblock">
Dan Hendrycks and Kevin Gimpel.

</span>
<span class="ltx_bibblock">Gaussian error linear units (gelus).

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.08415</em>, 2016.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Inan et al. (2021)</span>
<span class="ltx_bibblock">
Huseyin A. Inan, Osman Ramadan, Lukas Wutschitz, Daniel Jones, Victor
Rühle, James Withers, and Robert Sim.

</span>
<span class="ltx_bibblock">Training Data Leakage Analysis in Language Models.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arxiv:2101.05405[cs]</em>, February 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/arXiv.2101.05405</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2101.05405" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2101.05405</a>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jayaraman &amp; Evans (2019)</span>
<span class="ltx_bibblock">
Bargav Jayaraman and David Evans.

</span>
<span class="ltx_bibblock">Evaluating Differentially Private Machine Learning in
Practice.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">28th <span id="bib.bib27.1.1.1" class="ltx_text ltx_font_upright">{<span id="bib.bib27.1.1.1.1" class="ltx_text ltx_phantom"><span style="visibility:hidden"></span></span>}</span>USENIX<span id="bib.bib27.1.1.2" class="ltx_text ltx_phantom ltx_font_upright"><span style="visibility:hidden">{</span></span><span id="bib.bib27.1.1.3" class="ltx_text ltx_font_upright">}</span> Security
Symposium (<span id="bib.bib27.1.1.4" class="ltx_text ltx_font_upright">{<span id="bib.bib27.1.1.4.1" class="ltx_text ltx_phantom"><span style="visibility:hidden"></span></span>}</span>USENIX<span id="bib.bib27.1.1.5" class="ltx_text ltx_phantom ltx_font_upright"><span style="visibility:hidden">{</span></span><span id="bib.bib27.1.1.6" class="ltx_text ltx_font_upright">}</span> Security 19)</em>, pp. 1895–1912, 2019.

</span>
<span class="ltx_bibblock">ISBN 978-1-939133-06-9.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://www.usenix.org/conference/usenixsecurity19/presentation/jayaraman" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.usenix.org/conference/usenixsecurity19/presentation/jayaraman</a>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jonker &amp; Volgenant (1987)</span>
<span class="ltx_bibblock">
R. Jonker and A. Volgenant.

</span>
<span class="ltx_bibblock">A shortest augmenting path algorithm for dense and sparse linear
assignment problems.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Computing</em>, 38(4):325–340, December 1987.

</span>
<span class="ltx_bibblock">ISSN 1436-5057.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1007/BF02278710</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1007/BF02278710" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1007/BF02278710</a>.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021a)</span>
<span class="ltx_bibblock">
Peter Kairouz, Ziyu Liu, and Thomas Steinke.

</span>
<span class="ltx_bibblock">The Distributed Discrete Gaussian Mechanism for Federated
Learning with Secure Aggregation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th International Conference on
Machine Learning</em>, pp.  5201–5212. PMLR, July 2021a.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v139/kairouz21a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v139/kairouz21a.html</a>.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021b)</span>
<span class="ltx_bibblock">
Peter Kairouz, H. Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi
Bennis, Arjun Nitin Bhagoji, Kallista Bonawitz, Zachary Charles, Graham
Cormode, Rachel Cummings, Rafael G. L. D’Oliveira, Hubert Eichner, Salim El
Rouayheb, David Evans, Josh Gardner, Zachary Garrett, Adrià Gascón,
Badih Ghazi, Phillip B. Gibbons, Marco Gruteser, Zaid Harchaoui, Chaoyang He,
Lie He, Zhouyuan Huo, Ben Hutchinson, Justin Hsu, Martin Jaggi, Tara Javidi,
Gauri Joshi, Mikhail Khodak, Jakub Konečný, Aleksandra Korolova,
Farinaz Koushanfar, Sanmi Koyejo, Tancrède Lepoint, Yang Liu, Prateek
Mittal, Mehryar Mohri, Richard Nock, Ayfer Özgür, Rasmus Pagh,
Mariana Raykova, Hang Qi, Daniel Ramage, Ramesh Raskar, Dawn Song, Weikang
Song, Sebastian U. Stich, Ziteng Sun, Ananda Theertha Suresh, Florian
Tramèr, Praneeth Vepakomma, Jianyu Wang, Li Xiong, Zheng Xu, Qiang Yang,
Felix X. Yu, Han Yu, and Sen Zhao.

</span>
<span class="ltx_bibblock">Advances and Open Problems in Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv:1912.04977 [cs, stat]</em>, March 2021b.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1912.04977" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1912.04977</a>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kasiviswanathan et al. (2011)</span>
<span class="ltx_bibblock">
Shiva Prasad Kasiviswanathan, Homin K. Lee, Kobbi Nissim, Sofya Raskhodnikova,
and Adam Smith.

</span>
<span class="ltx_bibblock">What Can We Learn Privately?

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">SIAM Journal on Computing</em>, 40(3):793–826,
January 2011.

</span>
<span class="ltx_bibblock">ISSN 0097-5397.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1137/090756090</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://epubs.siam.org/doi/10.1137/090756090" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://epubs.siam.org/doi/10.1137/090756090</a>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Wenqi Li, Fausto Milletarì, Daguang Xu, Nicola Rieke, Jonny Hancox, Wentao
Zhu, Maximilian Baust, Yan Cheng, Sébastien Ourselin, M. Jorge Cardoso,
and Andrew Feng.

</span>
<span class="ltx_bibblock">Privacy-Preserving Federated Brain Tumour Segmentation.

</span>
<span class="ltx_bibblock">In Heung-Il Suk, Mingxia Liu, Pingkun Yan, and Chunfeng Lian (eds.),
<em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Machine Learning in Medical Imaging</em>, Lecture Notes in
Computer Science, pp.  133–141, Cham, 2019. Springer International
Publishing.

</span>
<span class="ltx_bibblock">ISBN 978-3-030-32692-0.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1007/978-3-030-32692-0_16</span>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Xuechen Li, Florian Tramer, Percy Liang, and Tatsunori Hashimoto.

</span>
<span class="ltx_bibblock">Large Language Models Can Be Strong Differentially Private
Learners.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>, March 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=bVuP3ltATMz" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=bVuP3ltATMz</a>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin (2004)</span>
<span class="ltx_bibblock">
Chin-Yew Lin.

</span>
<span class="ltx_bibblock">ROUGE: A Package for Automatic Evaluation of
Summaries.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Text Summarization Branches Out</em>, pp.  74–81,
Barcelona, Spain, July 2004. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aclanthology.org/W04-1013" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/W04-1013</a>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mallat &amp; Zhang (1993)</span>
<span class="ltx_bibblock">
S.G. Mallat and Zhifeng Zhang.

</span>
<span class="ltx_bibblock">Matching pursuits with time-frequency dictionaries.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Signal Processing</em>, 41(12):3397–3415, December 1993.

</span>
<span class="ltx_bibblock">ISSN 1941-0476.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/78.258082</span>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan &amp; Ramage (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan and Daniel Ramage.

</span>
<span class="ltx_bibblock">Federated Learning: Collaborative Machine Learning without
Centralized Training Data, April 2017.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="http://ai.googleblog.com/2017/04/federated-learning-collaborative.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://ai.googleblog.com/2017/04/federated-learning-collaborative.html</a>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and
Blaise Agüera y Arcas.

</span>
<span class="ltx_bibblock">Communication-Efficient Learning of Deep Networks from
Decentralized Data.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv:1602.05629 [cs]</em>, February 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1602.05629" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1602.05629</a>.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2018)</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Daniel Ramage, Kunal Talwar, and Li Zhang.

</span>
<span class="ltx_bibblock">Learning Differentially Private Recurrent Language Models.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">arXiv:1710.06963 [cs]</em>, February 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1710.06963" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1710.06963</a>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Melis et al. (2019)</span>
<span class="ltx_bibblock">
Luca Melis, Congzheng Song, Emiliano De Cristofaro, and Vitaly Shmatikov.

</span>
<span class="ltx_bibblock">Exploiting Unintended Feature Leakage in Collaborative
Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">2019 IEEE Symposium on Security and Privacy
(SP)</em>, pp.  691–706, May 2019.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/SP.2019.00029</span>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Merity et al. (2016)</span>
<span class="ltx_bibblock">
Stephen Merity, Caiming Xiong, James Bradbury, and Richard Socher.

</span>
<span class="ltx_bibblock">Pointer Sentinel Mixture Models.

</span>
<span class="ltx_bibblock">November 2016.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=Byj72udxe" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=Byj72udxe</a>.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Noble et al. (2022)</span>
<span class="ltx_bibblock">
Maxence Noble, Aurélien Bellet, and Aymeric Dieuleveut.

</span>
<span class="ltx_bibblock">Differentially Private Federated Learning on Heterogeneous
Data.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">arxiv:2111.09278[cs, math, stat]</em>, February 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2111.09278" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2111.09278</a>.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">ONNX (2022)</span>
<span class="ltx_bibblock">
Documentation ONNX.

</span>
<span class="ltx_bibblock">ONNX Operator Schemas.

</span>
<span class="ltx_bibblock">Open Neural Network Exchange, January 2022.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://github.com/onnx/onnx/blob/50a1981dc3d50af13075cec33b08b4c87fb0e41f/docs/Operators.md" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/onnx/onnx/blob/50a1981dc3d50af13075cec33b08b4c87fb0e41f/docs/Operators.md</a>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Papineni et al. (2002)</span>
<span class="ltx_bibblock">
Kishore Papineni, Salim Roukos, Todd Ward, and Wei-Jing Zhu.

</span>
<span class="ltx_bibblock">Bleu: A Method for Automatic Evaluation of Machine
Translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 40th Annual Meeting of the
Association for Computational Linguistics</em>, pp.  311–318,
Philadelphia, Pennsylvania, USA, July 2002. Association for Computational
Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.3115/1073083.1073135</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://aclanthology.org/P02-1040" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aclanthology.org/P02-1040</a>.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. (2017)</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Soumith Chintala, Gregory Chanan, Edward Yang, Zachary
DeVito, Zeming Lin, Alban Desmaison, Luca Antiga, and Adam Lerer.

</span>
<span class="ltx_bibblock">Automatic differentiation in PyTorch.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">NIPS 2017 Autodiff Workshop</em>, Long Beach, CA,
2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=BJJsrmfCZ" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=BJJsrmfCZ</a>.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paulik et al. (2021)</span>
<span class="ltx_bibblock">
Matthias Paulik, Matt Seigel, Henry Mason, Dominic Telaar, Joris Kluivers,
Rogier van Dalen, Chi Wai Lau, Luke Carlson, Filip Granqvist, Chris
Vandevelde, Sudeep Agarwal, Julien Freudiger, Andrew Byde, Abhishek Bhowmick,
Gaurav Kapoor, Si Beaumont, Áine Cahill, Dominic Hughes, Omid Javidbakht,
Fei Dong, Rehan Rishi, and Stanley Hung.

</span>
<span class="ltx_bibblock">Federated Evaluation and Tuning for On-Device
Personalization: System Design &amp; Applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv.2102.08503</em>, February 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.48550/arXiv.2102.08503</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2102.08503v1" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2102.08503v1</a>.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Phong et al. (2017)</span>
<span class="ltx_bibblock">
Le Trieu Phong, Yoshinori Aono, Takuya Hayashi, Lihua Wang, and Shiho Moriai.

</span>
<span class="ltx_bibblock">Privacy-Preserving Deep Learning via Additively Homomorphic
Encryption.

</span>
<span class="ltx_bibblock">Technical Report 715, 2017.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://eprint.iacr.org/2017/715" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://eprint.iacr.org/2017/715</a>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2019)</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, and Ilya
Sutskever.

</span>
<span class="ltx_bibblock">Language Models are Unsupervised Multitask Learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">OpenAI</em>, pp.  24, 2019.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramaswamy et al. (2019)</span>
<span class="ltx_bibblock">
Swaroop Ramaswamy, Rajiv Mathews, Kanishka Rao, and Françoise Beaufays.

</span>
<span class="ltx_bibblock">Federated Learning for Emoji Prediction in a Mobile
Keyboard.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">arXiv:1906.04329 [cs]</em>, June 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1906.04329" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1906.04329</a>.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rubinstein et al. (2008)</span>
<span class="ltx_bibblock">
Ron Rubinstein, Michael Zibulevsky, and Michael Elad.

</span>
<span class="ltx_bibblock">Efficient implementation of the K-SVD algorithm using batch
orthogonal matching pursuit.

</span>
<span class="ltx_bibblock">Technical report, Computer Science Department, Technion, 2008.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Somepalli et al. (2021)</span>
<span class="ltx_bibblock">
Gowthami Somepalli, Micah Goldblum, Avi Schwarzschild, C Bayan Bruss, and Tom
Goldstein.

</span>
<span class="ltx_bibblock">Saint: Improved neural networks for tabular data via row attention
and contrastive pre-training.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.01342</em>, 2021.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Truong et al. (2021)</span>
<span class="ltx_bibblock">
Nguyen Truong, Kai Sun, Siyao Wang, Florian Guitton, and YiKe Guo.

</span>
<span class="ltx_bibblock">Privacy preservation in federated learning: An insightful survey
from the GDPR perspective.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Computers &amp; Security</em>, 110:102402, November 2021.

</span>
<span class="ltx_bibblock">ISSN 0167-4048.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1016/j.cose.2021.102402</span>.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S0167404821002261" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S0167404821002261</a>.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ullman (2021)</span>
<span class="ltx_bibblock">
Jonathan Ullman.

</span>
<span class="ltx_bibblock">Tight Lower Bounds for Locally Differentially Private
Selection.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">arXiv:1802.02638 [cs]</em>, May 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1802.02638" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1802.02638</a>.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Veale et al. (2018)</span>
<span class="ltx_bibblock">
Michael Veale, Reuben Binns, and Lilian Edwards.

</span>
<span class="ltx_bibblock">Algorithms that remember: Model inversion attacks and data protection
law.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">Philosophical Transactions of the Royal Society A:
Mathematical, Physical and Engineering Sciences</em>, 376(2133):20180083, November 2018.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1098/rsta.2018.0083</span>.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://royalsocietypublishing.org/doi/full/10.1098/rsta.2018.0083" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://royalsocietypublishing.org/doi/full/10.1098/rsta.2018.0083</a>.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wainakh et al. (2021)</span>
<span class="ltx_bibblock">
Aidmar Wainakh, Fabrizio Ventola, Till Müßig, Jens Keim, Carlos Garcia
Cordero, Ephraim Zimmer, Tim Grube, Kristian Kersting, and Max
Mühlhäuser.

</span>
<span class="ltx_bibblock">User Label Leakage from Gradients in Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">arXiv:2105.09369 [cs]</em>, June 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2105.09369" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2105.09369</a>.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Jianyu Wang, Zachary Charles, Zheng Xu, Gauri Joshi, H. Brendan McMahan,
Blaise Aguera y Arcas, Maruan Al-Shedivat, Galen Andrew, Salman Avestimehr,
Katharine Daly, Deepesh Data, Suhas Diggavi, Hubert Eichner, Advait Gadhikar,
Zachary Garrett, Antonious M. Girgis, Filip Hanzely, Andrew Hard, Chaoyang
He, Samuel Horvath, Zhouyuan Huo, Alex Ingerman, Martin Jaggi, Tara Javidi,
Peter Kairouz, Satyen Kale, Sai Praneeth Karimireddy, Jakub Konecny, Sanmi
Koyejo, Tian Li, Luyang Liu, Mehryar Mohri, Hang Qi, Sashank J. Reddi, Peter
Richtarik, Karan Singhal, Virginia Smith, Mahdi Soltanolkotabi, Weikang Song,
Ananda Theertha Suresh, Sebastian U. Stich, Ameet Talwalkar, Hongyi Wang,
Blake Woodworth, Shanshan Wu, Felix X. Yu, Honglin Yuan, Manzil Zaheer,
Mi Zhang, Tong Zhang, Chunxiang Zheng, Chen Zhu, and Wennan Zhu.

</span>
<span class="ltx_bibblock">A Field Guide to Federated Optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">arXiv:2107.06917 [cs]</em>, July 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2107.06917" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2107.06917</a>.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2018)</span>
<span class="ltx_bibblock">
Zhibo Wang, Mengkai Song, Zhifei Zhang, Yang Song, Qian Wang, and Hairong Qi.

</span>
<span class="ltx_bibblock">Beyond Inferring Class Representatives: User-Level Privacy
Leakage From Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">arXiv:1812.00535 [cs]</em>, December 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1812.00535" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1812.00535</a>.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolf et al. (2020)</span>
<span class="ltx_bibblock">
Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue,
Anthony Moi, Pierric Cistac, Tim Rault, Rémi Louf, Morgan Funtowicz, Joe
Davison, Sam Shleifer, Patrick von Platen, Clara Ma, Yacine Jernite, Julien
Plu, Canwen Xu, Teven Le Scao, Sylvain Gugger, Mariama Drame, Quentin Lhoest,
and Alexander M. Rush.

</span>
<span class="ltx_bibblock">HuggingFace’s Transformers: State-of-the-art Natural
Language Processing.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv:1910.03771 [cs]</em>, July 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1910.03771" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1910.03771</a>.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2021)</span>
<span class="ltx_bibblock">
Hongxu Yin, Arun Mallya, Arash Vahdat, Jose M. Alvarez, Jan Kautz, and Pavlo
Molchanov.

</span>
<span class="ltx_bibblock">See Through Gradients: Image Batch Recovery via
GradInversion.

</span>
<span class="ltx_bibblock">In <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer
Vision and Pattern Recognition</em>, pp.  16337–16346, 2021.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://openaccess.thecvf.com/content/CVPR2021/html/Yin_See_Through_Gradients_Image_Batch_Recovery_via_GradInversion_CVPR_2021_paper.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openaccess.thecvf.com/content/CVPR2021/html/Yin_See_Through_Gradients_Image_Batch_Recovery_via_GradInversion_CVPR_2021_paper.html</a>.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zanella-Béguelin et al. (2020)</span>
<span class="ltx_bibblock">
Santiago Zanella-Béguelin, Lukas Wutschitz, Shruti Tople, Victor
Rühle, Andrew Paverd, Olga Ohrimenko, Boris Köpf, and Marc
Brockschmidt.

</span>
<span class="ltx_bibblock">Analyzing Information Leakage of Updates to Natural
Language Models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2020 ACM SIGSAC Conference on
Computer and Communications Security</em>, pp.  363–375. Association
for Computing Machinery, New York, NY, USA, October 2020.

</span>
<span class="ltx_bibblock">ISBN 978-1-4503-7089-9.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1145/3372297.3417880" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/3372297.3417880</a>.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2019)</span>
<span class="ltx_bibblock">
Ligeng Zhu, Zhijian Liu, and Song Han.

</span>
<span class="ltx_bibblock">Deep Leakage from Gradients.

</span>
<span class="ltx_bibblock">In H. Wallach, H. Larochelle, A. Beygelzimer,
F. d\textquotesingle Alché-Buc, E. Fox, and R. Garnett
(eds.), <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 32</em>, pp. 14774–14784. Curran Associates, Inc., 2019.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="http://papers.nips.cc/paper/9617-deep-leakage-from-gradients.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://papers.nips.cc/paper/9617-deep-leakage-from-gradients.pdf</a>.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Technical Details</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.1" class="ltx_p">We implement all attacks in an extensible <span id="A1.p1.1.1" class="ltx_text ltx_font_typewriter">PyTorch</span> framework <cite class="ltx_cite ltx_citemacro_citep">(Paszke et al., <a href="#bib.bib44" title="" class="ltx_ref">2017</a>)</cite> for this type of attack which allows for a full reproduction of the attack and which we attach to this submission. We utilize <span id="A1.p1.1.2" class="ltx_text ltx_font_typewriter">huggingface</span> models and data extensions for the text data <cite class="ltx_cite ltx_citemacro_citep">(Wolf et al., <a href="#bib.bib57" title="" class="ltx_ref">2020</a>)</cite>.The attack is separated into two parts. The first part is the malicious modification of the server parameters, which is triggered immediately before the server sends out their model update payload to users.</p>
</div>
<div id="A1.p2" class="ltx_para ltx_noindent">
<p id="A1.p2.6" class="ltx_p">We implement the malicious parameter modifications as described in Sec. 3. We initialize from a random model initialization and reserve the first <math id="A1.p2.1.m1.1" class="ltx_Math" alttext="6" display="inline"><semantics id="A1.p2.1.m1.1a"><mn id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><cn type="integer" id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">6</annotation></semantics></math> entries of the embedding layer for the sentence encoding for the Transformer-3 model and the first <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="32" display="inline"><semantics id="A1.p2.2.m2.1a"><mn id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><cn type="integer" id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">32</annotation></semantics></math> entries for the larger BERT and GPT-2 models. The corresponding entries in the positional and token embeddings are reset to <math id="A1.p2.3.m3.1" class="ltx_Math" alttext="0" display="inline"><semantics id="A1.p2.3.m3.1a"><mn id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><cn type="integer" id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1">0</cn></annotation-xml></semantics></math>. In the MHA modification, we choose a softmax skewing of <math id="A1.p2.4.m4.1" class="ltx_Math" alttext="1e8" display="inline"><semantics id="A1.p2.4.m4.1a"><mrow id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml"><mn id="A1.p2.4.m4.1.1.2" xref="A1.p2.4.m4.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p2.4.m4.1.1.1" xref="A1.p2.4.m4.1.1.1.cmml">​</mo><mi id="A1.p2.4.m4.1.1.3" xref="A1.p2.4.m4.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.p2.4.m4.1.1.1a" xref="A1.p2.4.m4.1.1.1.cmml">​</mo><mn id="A1.p2.4.m4.1.1.4" xref="A1.p2.4.m4.1.1.4.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><apply id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1"><times id="A1.p2.4.m4.1.1.1.cmml" xref="A1.p2.4.m4.1.1.1"></times><cn type="integer" id="A1.p2.4.m4.1.1.2.cmml" xref="A1.p2.4.m4.1.1.2">1</cn><ci id="A1.p2.4.m4.1.1.3.cmml" xref="A1.p2.4.m4.1.1.3">𝑒</ci><cn type="integer" id="A1.p2.4.m4.1.1.4.cmml" xref="A1.p2.4.m4.1.1.4">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">1e8</annotation></semantics></math>, although this value can be significantly lower in practice as well. We reserve the last entry of the embedding layer for gradient flow to each linear layer, so that the attack is able to utilize all layers as described. This entry is scaled by <math id="A1.p2.5.m5.1" class="ltx_Math" alttext="\varepsilon=1e-6" display="inline"><semantics id="A1.p2.5.m5.1a"><mrow id="A1.p2.5.m5.1.1" xref="A1.p2.5.m5.1.1.cmml"><mi id="A1.p2.5.m5.1.1.2" xref="A1.p2.5.m5.1.1.2.cmml">ε</mi><mo id="A1.p2.5.m5.1.1.1" xref="A1.p2.5.m5.1.1.1.cmml">=</mo><mrow id="A1.p2.5.m5.1.1.3" xref="A1.p2.5.m5.1.1.3.cmml"><mrow id="A1.p2.5.m5.1.1.3.2" xref="A1.p2.5.m5.1.1.3.2.cmml"><mn id="A1.p2.5.m5.1.1.3.2.2" xref="A1.p2.5.m5.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p2.5.m5.1.1.3.2.1" xref="A1.p2.5.m5.1.1.3.2.1.cmml">​</mo><mi id="A1.p2.5.m5.1.1.3.2.3" xref="A1.p2.5.m5.1.1.3.2.3.cmml">e</mi></mrow><mo id="A1.p2.5.m5.1.1.3.1" xref="A1.p2.5.m5.1.1.3.1.cmml">−</mo><mn id="A1.p2.5.m5.1.1.3.3" xref="A1.p2.5.m5.1.1.3.3.cmml">6</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.5.m5.1b"><apply id="A1.p2.5.m5.1.1.cmml" xref="A1.p2.5.m5.1.1"><eq id="A1.p2.5.m5.1.1.1.cmml" xref="A1.p2.5.m5.1.1.1"></eq><ci id="A1.p2.5.m5.1.1.2.cmml" xref="A1.p2.5.m5.1.1.2">𝜀</ci><apply id="A1.p2.5.m5.1.1.3.cmml" xref="A1.p2.5.m5.1.1.3"><minus id="A1.p2.5.m5.1.1.3.1.cmml" xref="A1.p2.5.m5.1.1.3.1"></minus><apply id="A1.p2.5.m5.1.1.3.2.cmml" xref="A1.p2.5.m5.1.1.3.2"><times id="A1.p2.5.m5.1.1.3.2.1.cmml" xref="A1.p2.5.m5.1.1.3.2.1"></times><cn type="integer" id="A1.p2.5.m5.1.1.3.2.2.cmml" xref="A1.p2.5.m5.1.1.3.2.2">1</cn><ci id="A1.p2.5.m5.1.1.3.2.3.cmml" xref="A1.p2.5.m5.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="A1.p2.5.m5.1.1.3.3.cmml" xref="A1.p2.5.m5.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.5.m5.1c">\varepsilon=1e-6</annotation></semantics></math> for the smaller Transformer-3 model and <math id="A1.p2.6.m6.1" class="ltx_Math" alttext="\varepsilon=1e-8" display="inline"><semantics id="A1.p2.6.m6.1a"><mrow id="A1.p2.6.m6.1.1" xref="A1.p2.6.m6.1.1.cmml"><mi id="A1.p2.6.m6.1.1.2" xref="A1.p2.6.m6.1.1.2.cmml">ε</mi><mo id="A1.p2.6.m6.1.1.1" xref="A1.p2.6.m6.1.1.1.cmml">=</mo><mrow id="A1.p2.6.m6.1.1.3" xref="A1.p2.6.m6.1.1.3.cmml"><mrow id="A1.p2.6.m6.1.1.3.2" xref="A1.p2.6.m6.1.1.3.2.cmml"><mn id="A1.p2.6.m6.1.1.3.2.2" xref="A1.p2.6.m6.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p2.6.m6.1.1.3.2.1" xref="A1.p2.6.m6.1.1.3.2.1.cmml">​</mo><mi id="A1.p2.6.m6.1.1.3.2.3" xref="A1.p2.6.m6.1.1.3.2.3.cmml">e</mi></mrow><mo id="A1.p2.6.m6.1.1.3.1" xref="A1.p2.6.m6.1.1.3.1.cmml">−</mo><mn id="A1.p2.6.m6.1.1.3.3" xref="A1.p2.6.m6.1.1.3.3.cmml">8</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.6.m6.1b"><apply id="A1.p2.6.m6.1.1.cmml" xref="A1.p2.6.m6.1.1"><eq id="A1.p2.6.m6.1.1.1.cmml" xref="A1.p2.6.m6.1.1.1"></eq><ci id="A1.p2.6.m6.1.1.2.cmml" xref="A1.p2.6.m6.1.1.2">𝜀</ci><apply id="A1.p2.6.m6.1.1.3.cmml" xref="A1.p2.6.m6.1.1.3"><minus id="A1.p2.6.m6.1.1.3.1.cmml" xref="A1.p2.6.m6.1.1.3.1"></minus><apply id="A1.p2.6.m6.1.1.3.2.cmml" xref="A1.p2.6.m6.1.1.3.2"><times id="A1.p2.6.m6.1.1.3.2.1.cmml" xref="A1.p2.6.m6.1.1.3.2.1"></times><cn type="integer" id="A1.p2.6.m6.1.1.3.2.2.cmml" xref="A1.p2.6.m6.1.1.3.2.2">1</cn><ci id="A1.p2.6.m6.1.1.3.2.3.cmml" xref="A1.p2.6.m6.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="A1.p2.6.m6.1.1.3.3.cmml" xref="A1.p2.6.m6.1.1.3.3">8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.6.m6.1c">\varepsilon=1e-8</annotation></semantics></math> for the larger models, so that the layer normalization is not skewed by large values arising from the last embedding entry.</p>
</div>
<div id="A1.p3" class="ltx_para ltx_noindent">
<p id="A1.p3.1" class="ltx_p">For the attack part, we retrieve the gradient update on the server and run all recovery computations in single float precision. We first run a token recovery as discussed in Sec 3.1, which we additionally summarize in Sec. 3.4 and then proceed with the attack following <a href="#alg1" title="In Getting a Bag-of-Words Containing All Tokens ‣ 3.1 Extracting User Data ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>. For the sentence labeling we cluster using constrained K-means as described in <cite class="ltx_cite ltx_citemacro_citet">Bradley et al. (<a href="#bib.bib6" title="" class="ltx_ref">2000</a>)</cite>.
For all assignment problems we utilize the linear sum assignment solver proposed in <cite class="ltx_cite ltx_citemacro_citet">Crouse (<a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite> which is a modification of the shortest augmenting path strategy originally proposed in <cite class="ltx_cite ltx_citemacro_citet">Jonker &amp; Volgenant (<a href="#bib.bib28" title="" class="ltx_ref">1987</a>)</cite>.</p>
</div>
<div id="A1.p4" class="ltx_para ltx_noindent">
<p id="A1.p4.1" class="ltx_p">During the quantitative evaluation, we trial 100 users each with a request for updates of size sequence length <math id="A1.p4.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.p4.1.m1.1a"><mo id="A1.p4.1.m1.1.1" xref="A1.p4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.p4.1.m1.1b"><times id="A1.p4.1.m1.1.1.cmml" xref="A1.p4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.1.m1.1c">\times</annotation></semantics></math> batches. We skip all users which do <span id="A1.p4.1.1" class="ltx_text ltx_font_italic">not</span> own enough data and do not pad user data with [PAD] tokens, which we think would skew results as it would include a large number of easy tokens to recover. All measurements are hence done on non-trivial sentences, which are concatenated to reach the desired sequence length. Each user’s data is completely separated, representing different wikipedia articles as described in the main body. Overall, the attack is highly successful over a range of users even with very different article content.</p>
</div>
<div id="A1.p5" class="ltx_para ltx_noindent">
<p id="A1.p5.1" class="ltx_p">To compute metrics, we first resort the recovered batches toward the ground truth order by assigning to ground truth batches based on total token accuracy per sentence. This leads to a potential underestimation of the true accuracy and ROUGE metrics of the recovery as sentence are potentially mismatched. We compute Rouge <cite class="ltx_cite ltx_citemacro_citep">(Lin, <a href="#bib.bib34" title="" class="ltx_ref">2004</a>)</cite> scores based on the sorted batches and BLEU scores <cite class="ltx_cite ltx_citemacro_citep">(Papineni et al., <a href="#bib.bib43" title="" class="ltx_ref">2002</a>)</cite> (with the default <span id="A1.p5.1.1" class="ltx_text ltx_font_typewriter">huggingface</span> implementation) by giving all batches as references. We measure total accuracy as the number of tokens that are perfectly identified and in the correct position, assigning no partial credit for either token identity or position. This is notably in contrast to the naming of metrics in <cite class="ltx_cite ltx_citemacro_citet">Deng et al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite> where accuracy refers to only overall token accuracy. We refer to that metric as "token accuracy", measuring only the overlap between reference and reconstruction sentence bag-of-words, but report only the total accuracy, given that token accuracy is already near-perfect after the attack on the bag-of-words described in Sec 3.1.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Algorithm Details</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.1" class="ltx_p">We detail sub-algorithms as additional material in this section. <a href="#alg2" title="In Appendix B Algorithm Details ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">2</span></a> and <a href="#alg3" title="In Appendix B Algorithm Details ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">3</span></a> detail the token recovery for transformers with decoder bias and for transformer with a tied embedding. These roughly follow the principles of greedy label recovery strategy proposed in <cite class="ltx_cite ltx_citemacro_citet">Wainakh et al. (<a href="#bib.bib54" title="" class="ltx_ref">2021</a>)</cite> and we reproduce them here for completeness, incorporating additional considerations necessary for token retrieval.</p>
</div>
<figure id="alg2" class="ltx_float ltx_minipage ltx_align_middle ltx_framed ltx_framed_top" style="width:194.8pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Token Recovery 
<br class="ltx_break">(Decoder Bias)</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span id="alg2.l1.1" class="ltx_text ltx_font_bold">Input:</span> Decoder bias gradient <math id="alg2.l1.m1.1" class="ltx_Math" alttext="g_{b}" display="inline"><semantics id="alg2.l1.m1.1a"><msub id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mi id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml">g</mi><mi id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1">subscript</csymbol><ci id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2">𝑔</ci><ci id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">g_{b}</annotation></semantics></math>, embedding gradient <math id="alg2.l1.m2.1" class="ltx_Math" alttext="g_{e}" display="inline"><semantics id="alg2.l1.m2.1a"><msub id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml"><mi id="alg2.l1.m2.1.1.2" xref="alg2.l1.m2.1.1.2.cmml">g</mi><mi id="alg2.l1.m2.1.1.3" xref="alg2.l1.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><apply id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.cmml" xref="alg2.l1.m2.1.1">subscript</csymbol><ci id="alg2.l1.m2.1.1.2.cmml" xref="alg2.l1.m2.1.1.2">𝑔</ci><ci id="alg2.l1.m2.1.1.3.cmml" xref="alg2.l1.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">g_{e}</annotation></semantics></math>, sequence length <math id="alg2.l1.m3.1" class="ltx_Math" alttext="s" display="inline"><semantics id="alg2.l1.m3.1a"><mi id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><ci id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">s</annotation></semantics></math>, number of sequences <math id="alg2.l1.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg2.l1.m4.1a"><mi id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><ci id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">n</annotation></semantics></math>.

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <math id="alg2.l2.m1.1" class="ltx_Math" alttext="v_{\text{tokens}}" display="inline"><semantics id="alg2.l2.m1.1a"><msub id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">v</mi><mtext id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3a.cmml">tokens</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1">subscript</csymbol><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝑣</ci><ci id="alg2.l2.m1.1.1.3a.cmml" xref="alg2.l2.m1.1.1.3"><mtext mathsize="70%" id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">tokens</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">v_{\text{tokens}}</annotation></semantics></math> <math id="alg2.l2.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l2.m2.1a"><mo stretchy="false" id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><ci id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.1c">\leftarrow</annotation></semantics></math> all indices where <math id="alg2.l2.m3.1" class="ltx_Math" alttext="g_{b}&lt;0" display="inline"><semantics id="alg2.l2.m3.1a"><mrow id="alg2.l2.m3.1.1" xref="alg2.l2.m3.1.1.cmml"><msub id="alg2.l2.m3.1.1.2" xref="alg2.l2.m3.1.1.2.cmml"><mi id="alg2.l2.m3.1.1.2.2" xref="alg2.l2.m3.1.1.2.2.cmml">g</mi><mi id="alg2.l2.m3.1.1.2.3" xref="alg2.l2.m3.1.1.2.3.cmml">b</mi></msub><mo id="alg2.l2.m3.1.1.1" xref="alg2.l2.m3.1.1.1.cmml">&lt;</mo><mn id="alg2.l2.m3.1.1.3" xref="alg2.l2.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m3.1b"><apply id="alg2.l2.m3.1.1.cmml" xref="alg2.l2.m3.1.1"><lt id="alg2.l2.m3.1.1.1.cmml" xref="alg2.l2.m3.1.1.1"></lt><apply id="alg2.l2.m3.1.1.2.cmml" xref="alg2.l2.m3.1.1.2"><csymbol cd="ambiguous" id="alg2.l2.m3.1.1.2.1.cmml" xref="alg2.l2.m3.1.1.2">subscript</csymbol><ci id="alg2.l2.m3.1.1.2.2.cmml" xref="alg2.l2.m3.1.1.2.2">𝑔</ci><ci id="alg2.l2.m3.1.1.2.3.cmml" xref="alg2.l2.m3.1.1.2.3">𝑏</ci></apply><cn type="integer" id="alg2.l2.m3.1.1.3.cmml" xref="alg2.l2.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m3.1c">g_{b}&lt;0</annotation></semantics></math>

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <math id="alg2.l3.m1.1" class="ltx_Math" alttext="v_{e}" display="inline"><semantics id="alg2.l3.m1.1a"><msub id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">v</mi><mi id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1">subscript</csymbol><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝑣</ci><ci id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">v_{e}</annotation></semantics></math> <math id="alg2.l3.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l3.m2.1a"><mo stretchy="false" id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><ci id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">\leftarrow</annotation></semantics></math> all indices where <math id="alg2.l3.m3.1" class="ltx_Math" alttext="g_{e}&lt;0" display="inline"><semantics id="alg2.l3.m3.1a"><mrow id="alg2.l3.m3.1.1" xref="alg2.l3.m3.1.1.cmml"><msub id="alg2.l3.m3.1.1.2" xref="alg2.l3.m3.1.1.2.cmml"><mi id="alg2.l3.m3.1.1.2.2" xref="alg2.l3.m3.1.1.2.2.cmml">g</mi><mi id="alg2.l3.m3.1.1.2.3" xref="alg2.l3.m3.1.1.2.3.cmml">e</mi></msub><mo id="alg2.l3.m3.1.1.1" xref="alg2.l3.m3.1.1.1.cmml">&lt;</mo><mn id="alg2.l3.m3.1.1.3" xref="alg2.l3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m3.1b"><apply id="alg2.l3.m3.1.1.cmml" xref="alg2.l3.m3.1.1"><lt id="alg2.l3.m3.1.1.1.cmml" xref="alg2.l3.m3.1.1.1"></lt><apply id="alg2.l3.m3.1.1.2.cmml" xref="alg2.l3.m3.1.1.2"><csymbol cd="ambiguous" id="alg2.l3.m3.1.1.2.1.cmml" xref="alg2.l3.m3.1.1.2">subscript</csymbol><ci id="alg2.l3.m3.1.1.2.2.cmml" xref="alg2.l3.m3.1.1.2.2">𝑔</ci><ci id="alg2.l3.m3.1.1.2.3.cmml" xref="alg2.l3.m3.1.1.2.3">𝑒</ci></apply><cn type="integer" id="alg2.l3.m3.1.1.3.cmml" xref="alg2.l3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m3.1c">g_{e}&lt;0</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>  <math id="alg2.l4.m1.1" class="ltx_Math" alttext="v_{\text{tokens}}" display="inline"><semantics id="alg2.l4.m1.1a"><msub id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">v</mi><mtext id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3a.cmml">tokens</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1">subscript</csymbol><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝑣</ci><ci id="alg2.l4.m1.1.1.3a.cmml" xref="alg2.l4.m1.1.1.3"><mtext mathsize="70%" id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">tokens</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">v_{\text{tokens}}</annotation></semantics></math> append <math id="alg2.l4.m2.1" class="ltx_Math" alttext="v_{\text{tokens}}\setminus v_{e}" display="inline"><semantics id="alg2.l4.m2.1a"><mrow id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml"><msub id="alg2.l4.m2.1.1.2" xref="alg2.l4.m2.1.1.2.cmml"><mi id="alg2.l4.m2.1.1.2.2" xref="alg2.l4.m2.1.1.2.2.cmml">v</mi><mtext id="alg2.l4.m2.1.1.2.3" xref="alg2.l4.m2.1.1.2.3a.cmml">tokens</mtext></msub><mo id="alg2.l4.m2.1.1.1" xref="alg2.l4.m2.1.1.1.cmml">∖</mo><msub id="alg2.l4.m2.1.1.3" xref="alg2.l4.m2.1.1.3.cmml"><mi id="alg2.l4.m2.1.1.3.2" xref="alg2.l4.m2.1.1.3.2.cmml">v</mi><mi id="alg2.l4.m2.1.1.3.3" xref="alg2.l4.m2.1.1.3.3.cmml">e</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><apply id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1"><setdiff id="alg2.l4.m2.1.1.1.cmml" xref="alg2.l4.m2.1.1.1"></setdiff><apply id="alg2.l4.m2.1.1.2.cmml" xref="alg2.l4.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.2.1.cmml" xref="alg2.l4.m2.1.1.2">subscript</csymbol><ci id="alg2.l4.m2.1.1.2.2.cmml" xref="alg2.l4.m2.1.1.2.2">𝑣</ci><ci id="alg2.l4.m2.1.1.2.3a.cmml" xref="alg2.l4.m2.1.1.2.3"><mtext mathsize="70%" id="alg2.l4.m2.1.1.2.3.cmml" xref="alg2.l4.m2.1.1.2.3">tokens</mtext></ci></apply><apply id="alg2.l4.m2.1.1.3.cmml" xref="alg2.l4.m2.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.3.1.cmml" xref="alg2.l4.m2.1.1.3">subscript</csymbol><ci id="alg2.l4.m2.1.1.3.2.cmml" xref="alg2.l4.m2.1.1.3.2">𝑣</ci><ci id="alg2.l4.m2.1.1.3.3.cmml" xref="alg2.l4.m2.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">v_{\text{tokens}}\setminus v_{e}</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>  <math id="alg2.l5.m1.1" class="ltx_Math" alttext="m_{\text{impact}}=\frac{1}{sn}\sum_{i\in v_{\text{tokens}}}{g_{b}}_{i}" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><msub id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml"><mi id="alg2.l5.m1.1.1.2.2" xref="alg2.l5.m1.1.1.2.2.cmml">m</mi><mtext id="alg2.l5.m1.1.1.2.3" xref="alg2.l5.m1.1.1.2.3a.cmml">impact</mtext></msub><mo id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">=</mo><mrow id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml"><mfrac id="alg2.l5.m1.1.1.3.2" xref="alg2.l5.m1.1.1.3.2.cmml"><mn id="alg2.l5.m1.1.1.3.2.2" xref="alg2.l5.m1.1.1.3.2.2.cmml">1</mn><mrow id="alg2.l5.m1.1.1.3.2.3" xref="alg2.l5.m1.1.1.3.2.3.cmml"><mi id="alg2.l5.m1.1.1.3.2.3.2" xref="alg2.l5.m1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m1.1.1.3.2.3.1" xref="alg2.l5.m1.1.1.3.2.3.1.cmml">​</mo><mi id="alg2.l5.m1.1.1.3.2.3.3" xref="alg2.l5.m1.1.1.3.2.3.3.cmml">n</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg2.l5.m1.1.1.3.1" xref="alg2.l5.m1.1.1.3.1.cmml">​</mo><mrow id="alg2.l5.m1.1.1.3.3" xref="alg2.l5.m1.1.1.3.3.cmml"><msub id="alg2.l5.m1.1.1.3.3.1" xref="alg2.l5.m1.1.1.3.3.1.cmml"><mo id="alg2.l5.m1.1.1.3.3.1.2" xref="alg2.l5.m1.1.1.3.3.1.2.cmml">∑</mo><mrow id="alg2.l5.m1.1.1.3.3.1.3" xref="alg2.l5.m1.1.1.3.3.1.3.cmml"><mi id="alg2.l5.m1.1.1.3.3.1.3.2" xref="alg2.l5.m1.1.1.3.3.1.3.2.cmml">i</mi><mo id="alg2.l5.m1.1.1.3.3.1.3.1" xref="alg2.l5.m1.1.1.3.3.1.3.1.cmml">∈</mo><msub id="alg2.l5.m1.1.1.3.3.1.3.3" xref="alg2.l5.m1.1.1.3.3.1.3.3.cmml"><mi id="alg2.l5.m1.1.1.3.3.1.3.3.2" xref="alg2.l5.m1.1.1.3.3.1.3.3.2.cmml">v</mi><mtext id="alg2.l5.m1.1.1.3.3.1.3.3.3" xref="alg2.l5.m1.1.1.3.3.1.3.3.3a.cmml">tokens</mtext></msub></mrow></msub><mmultiscripts id="alg2.l5.m1.1.1.3.3.2" xref="alg2.l5.m1.1.1.3.3.2.cmml"><mi id="alg2.l5.m1.1.1.3.3.2.2.2" xref="alg2.l5.m1.1.1.3.3.2.2.2.cmml">g</mi><mi id="alg2.l5.m1.1.1.3.3.2.2.3" xref="alg2.l5.m1.1.1.3.3.2.2.3.cmml">b</mi><mrow id="alg2.l5.m1.1.1.3.3.2a" xref="alg2.l5.m1.1.1.3.3.2.cmml"></mrow><mi id="alg2.l5.m1.1.1.3.3.2.3" xref="alg2.l5.m1.1.1.3.3.2.3.cmml">i</mi><mrow id="alg2.l5.m1.1.1.3.3.2b" xref="alg2.l5.m1.1.1.3.3.2.cmml"></mrow></mmultiscripts></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><eq id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1"></eq><apply id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.2">subscript</csymbol><ci id="alg2.l5.m1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.2.2">𝑚</ci><ci id="alg2.l5.m1.1.1.2.3a.cmml" xref="alg2.l5.m1.1.1.2.3"><mtext mathsize="70%" id="alg2.l5.m1.1.1.2.3.cmml" xref="alg2.l5.m1.1.1.2.3">impact</mtext></ci></apply><apply id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3"><times id="alg2.l5.m1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.3.1"></times><apply id="alg2.l5.m1.1.1.3.2.cmml" xref="alg2.l5.m1.1.1.3.2"><divide id="alg2.l5.m1.1.1.3.2.1.cmml" xref="alg2.l5.m1.1.1.3.2"></divide><cn type="integer" id="alg2.l5.m1.1.1.3.2.2.cmml" xref="alg2.l5.m1.1.1.3.2.2">1</cn><apply id="alg2.l5.m1.1.1.3.2.3.cmml" xref="alg2.l5.m1.1.1.3.2.3"><times id="alg2.l5.m1.1.1.3.2.3.1.cmml" xref="alg2.l5.m1.1.1.3.2.3.1"></times><ci id="alg2.l5.m1.1.1.3.2.3.2.cmml" xref="alg2.l5.m1.1.1.3.2.3.2">𝑠</ci><ci id="alg2.l5.m1.1.1.3.2.3.3.cmml" xref="alg2.l5.m1.1.1.3.2.3.3">𝑛</ci></apply></apply><apply id="alg2.l5.m1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.3.3"><apply id="alg2.l5.m1.1.1.3.3.1.cmml" xref="alg2.l5.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.3.3.1.1.cmml" xref="alg2.l5.m1.1.1.3.3.1">subscript</csymbol><sum id="alg2.l5.m1.1.1.3.3.1.2.cmml" xref="alg2.l5.m1.1.1.3.3.1.2"></sum><apply id="alg2.l5.m1.1.1.3.3.1.3.cmml" xref="alg2.l5.m1.1.1.3.3.1.3"><in id="alg2.l5.m1.1.1.3.3.1.3.1.cmml" xref="alg2.l5.m1.1.1.3.3.1.3.1"></in><ci id="alg2.l5.m1.1.1.3.3.1.3.2.cmml" xref="alg2.l5.m1.1.1.3.3.1.3.2">𝑖</ci><apply id="alg2.l5.m1.1.1.3.3.1.3.3.cmml" xref="alg2.l5.m1.1.1.3.3.1.3.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.3.3.1.3.3.1.cmml" xref="alg2.l5.m1.1.1.3.3.1.3.3">subscript</csymbol><ci id="alg2.l5.m1.1.1.3.3.1.3.3.2.cmml" xref="alg2.l5.m1.1.1.3.3.1.3.3.2">𝑣</ci><ci id="alg2.l5.m1.1.1.3.3.1.3.3.3a.cmml" xref="alg2.l5.m1.1.1.3.3.1.3.3.3"><mtext mathsize="50%" id="alg2.l5.m1.1.1.3.3.1.3.3.3.cmml" xref="alg2.l5.m1.1.1.3.3.1.3.3.3">tokens</mtext></ci></apply></apply></apply><apply id="alg2.l5.m1.1.1.3.3.2.cmml" xref="alg2.l5.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.3.3.2.1.cmml" xref="alg2.l5.m1.1.1.3.3.2">subscript</csymbol><apply id="alg2.l5.m1.1.1.3.3.2.2.cmml" xref="alg2.l5.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.3.3.2.2.1.cmml" xref="alg2.l5.m1.1.1.3.3.2">subscript</csymbol><ci id="alg2.l5.m1.1.1.3.3.2.2.2.cmml" xref="alg2.l5.m1.1.1.3.3.2.2.2">𝑔</ci><ci id="alg2.l5.m1.1.1.3.3.2.2.3.cmml" xref="alg2.l5.m1.1.1.3.3.2.2.3">𝑏</ci></apply><ci id="alg2.l5.m1.1.1.3.3.2.3.cmml" xref="alg2.l5.m1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">m_{\text{impact}}=\frac{1}{sn}\sum_{i\in v_{\text{tokens}}}{g_{b}}_{i}</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>  <math id="alg2.l6.m1.1" class="ltx_Math" alttext="g_{b}[v_{\text{tokens}}]" display="inline"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><msub id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml"><mi id="alg2.l6.m1.1.1.3.2" xref="alg2.l6.m1.1.1.3.2.cmml">g</mi><mi id="alg2.l6.m1.1.1.3.3" xref="alg2.l6.m1.1.1.3.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml">​</mo><mrow id="alg2.l6.m1.1.1.1.1" xref="alg2.l6.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l6.m1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.2.1.cmml">[</mo><msub id="alg2.l6.m1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.cmml"><mi id="alg2.l6.m1.1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.1.2.cmml">v</mi><mtext id="alg2.l6.m1.1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.1.3a.cmml">tokens</mtext></msub><mo stretchy="false" id="alg2.l6.m1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><times id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2"></times><apply id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.3">subscript</csymbol><ci id="alg2.l6.m1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.3.2">𝑔</ci><ci id="alg2.l6.m1.1.1.3.3.cmml" xref="alg2.l6.m1.1.1.3.3">𝑏</ci></apply><apply id="alg2.l6.m1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1"><csymbol cd="latexml" id="alg2.l6.m1.1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg2.l6.m1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.2">𝑣</ci><ci id="alg2.l6.m1.1.1.1.1.1.3a.cmml" xref="alg2.l6.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="alg2.l6.m1.1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.3">tokens</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">g_{b}[v_{\text{tokens}}]</annotation></semantics></math> <math id="alg2.l6.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l6.m2.1a"><mo stretchy="false" id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><ci id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">\leftarrow</annotation></semantics></math> <math id="alg2.l6.m3.1" class="ltx_Math" alttext="g_{b}[v_{\text{tokens}}]-m_{\text{impact}}" display="inline"><semantics id="alg2.l6.m3.1a"><mrow id="alg2.l6.m3.1.1" xref="alg2.l6.m3.1.1.cmml"><mrow id="alg2.l6.m3.1.1.1" xref="alg2.l6.m3.1.1.1.cmml"><msub id="alg2.l6.m3.1.1.1.3" xref="alg2.l6.m3.1.1.1.3.cmml"><mi id="alg2.l6.m3.1.1.1.3.2" xref="alg2.l6.m3.1.1.1.3.2.cmml">g</mi><mi id="alg2.l6.m3.1.1.1.3.3" xref="alg2.l6.m3.1.1.1.3.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l6.m3.1.1.1.2" xref="alg2.l6.m3.1.1.1.2.cmml">​</mo><mrow id="alg2.l6.m3.1.1.1.1.1" xref="alg2.l6.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l6.m3.1.1.1.1.1.2" xref="alg2.l6.m3.1.1.1.1.2.1.cmml">[</mo><msub id="alg2.l6.m3.1.1.1.1.1.1" xref="alg2.l6.m3.1.1.1.1.1.1.cmml"><mi id="alg2.l6.m3.1.1.1.1.1.1.2" xref="alg2.l6.m3.1.1.1.1.1.1.2.cmml">v</mi><mtext id="alg2.l6.m3.1.1.1.1.1.1.3" xref="alg2.l6.m3.1.1.1.1.1.1.3a.cmml">tokens</mtext></msub><mo stretchy="false" id="alg2.l6.m3.1.1.1.1.1.3" xref="alg2.l6.m3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg2.l6.m3.1.1.2" xref="alg2.l6.m3.1.1.2.cmml">−</mo><msub id="alg2.l6.m3.1.1.3" xref="alg2.l6.m3.1.1.3.cmml"><mi id="alg2.l6.m3.1.1.3.2" xref="alg2.l6.m3.1.1.3.2.cmml">m</mi><mtext id="alg2.l6.m3.1.1.3.3" xref="alg2.l6.m3.1.1.3.3a.cmml">impact</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m3.1b"><apply id="alg2.l6.m3.1.1.cmml" xref="alg2.l6.m3.1.1"><minus id="alg2.l6.m3.1.1.2.cmml" xref="alg2.l6.m3.1.1.2"></minus><apply id="alg2.l6.m3.1.1.1.cmml" xref="alg2.l6.m3.1.1.1"><times id="alg2.l6.m3.1.1.1.2.cmml" xref="alg2.l6.m3.1.1.1.2"></times><apply id="alg2.l6.m3.1.1.1.3.cmml" xref="alg2.l6.m3.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m3.1.1.1.3.1.cmml" xref="alg2.l6.m3.1.1.1.3">subscript</csymbol><ci id="alg2.l6.m3.1.1.1.3.2.cmml" xref="alg2.l6.m3.1.1.1.3.2">𝑔</ci><ci id="alg2.l6.m3.1.1.1.3.3.cmml" xref="alg2.l6.m3.1.1.1.3.3">𝑏</ci></apply><apply id="alg2.l6.m3.1.1.1.1.2.cmml" xref="alg2.l6.m3.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l6.m3.1.1.1.1.2.1.cmml" xref="alg2.l6.m3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg2.l6.m3.1.1.1.1.1.1.cmml" xref="alg2.l6.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m3.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m3.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l6.m3.1.1.1.1.1.1.2.cmml" xref="alg2.l6.m3.1.1.1.1.1.1.2">𝑣</ci><ci id="alg2.l6.m3.1.1.1.1.1.1.3a.cmml" xref="alg2.l6.m3.1.1.1.1.1.1.3"><mtext mathsize="70%" id="alg2.l6.m3.1.1.1.1.1.1.3.cmml" xref="alg2.l6.m3.1.1.1.1.1.1.3">tokens</mtext></ci></apply></apply></apply><apply id="alg2.l6.m3.1.1.3.cmml" xref="alg2.l6.m3.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m3.1.1.3.1.cmml" xref="alg2.l6.m3.1.1.3">subscript</csymbol><ci id="alg2.l6.m3.1.1.3.2.cmml" xref="alg2.l6.m3.1.1.3.2">𝑚</ci><ci id="alg2.l6.m3.1.1.3.3a.cmml" xref="alg2.l6.m3.1.1.3.3"><mtext mathsize="70%" id="alg2.l6.m3.1.1.3.3.cmml" xref="alg2.l6.m3.1.1.3.3">impact</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m3.1c">g_{b}[v_{\text{tokens}}]-m_{\text{impact}}</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>  <span id="alg2.l7.1" class="ltx_text ltx_font_bold">while</span> Length of <math id="alg2.l7.m1.1" class="ltx_Math" alttext="v_{\text{tokens}}&lt;sn" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><msub id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml"><mi id="alg2.l7.m1.1.1.2.2" xref="alg2.l7.m1.1.1.2.2.cmml">v</mi><mtext id="alg2.l7.m1.1.1.2.3" xref="alg2.l7.m1.1.1.2.3a.cmml">tokens</mtext></msub><mo id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml">&lt;</mo><mrow id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml"><mi id="alg2.l7.m1.1.1.3.2" xref="alg2.l7.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.3.1" xref="alg2.l7.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.1.1.3.3" xref="alg2.l7.m1.1.1.3.3.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><lt id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1"></lt><apply id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.2.1.cmml" xref="alg2.l7.m1.1.1.2">subscript</csymbol><ci id="alg2.l7.m1.1.1.2.2.cmml" xref="alg2.l7.m1.1.1.2.2">𝑣</ci><ci id="alg2.l7.m1.1.1.2.3a.cmml" xref="alg2.l7.m1.1.1.2.3"><mtext mathsize="70%" id="alg2.l7.m1.1.1.2.3.cmml" xref="alg2.l7.m1.1.1.2.3">tokens</mtext></ci></apply><apply id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3"><times id="alg2.l7.m1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.3.1"></times><ci id="alg2.l7.m1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.3.2">𝑠</ci><ci id="alg2.l7.m1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">v_{\text{tokens}}&lt;sn</annotation></semantics></math> <span id="alg2.l7.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math id="alg2.l8.m1.1" class="ltx_Math" alttext="j=\operatorname*{arg\,min}_{i}{g_{b}}_{i}" display="inline"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">j</mi><mo id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml">=</mo><mrow id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml"><msub id="alg2.l8.m1.1.1.3.1" xref="alg2.l8.m1.1.1.3.1.cmml"><mrow id="alg2.l8.m1.1.1.3.1.2" xref="alg2.l8.m1.1.1.3.1.2.cmml"><mi id="alg2.l8.m1.1.1.3.1.2.2" xref="alg2.l8.m1.1.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="alg2.l8.m1.1.1.3.1.2.1" xref="alg2.l8.m1.1.1.3.1.2.1.cmml">​</mo><mi id="alg2.l8.m1.1.1.3.1.2.3" xref="alg2.l8.m1.1.1.3.1.2.3.cmml">min</mi></mrow><mi id="alg2.l8.m1.1.1.3.1.3" xref="alg2.l8.m1.1.1.3.1.3.cmml">i</mi></msub><mo id="alg2.l8.m1.1.1.3a" xref="alg2.l8.m1.1.1.3.cmml">⁡</mo><mmultiscripts id="alg2.l8.m1.1.1.3.2" xref="alg2.l8.m1.1.1.3.2.cmml"><mi id="alg2.l8.m1.1.1.3.2.2.2" xref="alg2.l8.m1.1.1.3.2.2.2.cmml">g</mi><mi id="alg2.l8.m1.1.1.3.2.2.3" xref="alg2.l8.m1.1.1.3.2.2.3.cmml">b</mi><mrow id="alg2.l8.m1.1.1.3.2a" xref="alg2.l8.m1.1.1.3.2.cmml"></mrow><mi id="alg2.l8.m1.1.1.3.2.3" xref="alg2.l8.m1.1.1.3.2.3.cmml">i</mi><mrow id="alg2.l8.m1.1.1.3.2b" xref="alg2.l8.m1.1.1.3.2.cmml"></mrow></mmultiscripts></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><eq id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1"></eq><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝑗</ci><apply id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"><apply id="alg2.l8.m1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.3.1.1.cmml" xref="alg2.l8.m1.1.1.3.1">subscript</csymbol><apply id="alg2.l8.m1.1.1.3.1.2.cmml" xref="alg2.l8.m1.1.1.3.1.2"><times id="alg2.l8.m1.1.1.3.1.2.1.cmml" xref="alg2.l8.m1.1.1.3.1.2.1"></times><ci id="alg2.l8.m1.1.1.3.1.2.2.cmml" xref="alg2.l8.m1.1.1.3.1.2.2">arg</ci><ci id="alg2.l8.m1.1.1.3.1.2.3.cmml" xref="alg2.l8.m1.1.1.3.1.2.3">min</ci></apply><ci id="alg2.l8.m1.1.1.3.1.3.cmml" xref="alg2.l8.m1.1.1.3.1.3">𝑖</ci></apply><apply id="alg2.l8.m1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.3.2.1.cmml" xref="alg2.l8.m1.1.1.3.2">subscript</csymbol><apply id="alg2.l8.m1.1.1.3.2.2.cmml" xref="alg2.l8.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.3.2.2.1.cmml" xref="alg2.l8.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l8.m1.1.1.3.2.2.2.cmml" xref="alg2.l8.m1.1.1.3.2.2.2">𝑔</ci><ci id="alg2.l8.m1.1.1.3.2.2.3.cmml" xref="alg2.l8.m1.1.1.3.2.2.3">𝑏</ci></apply><ci id="alg2.l8.m1.1.1.3.2.3.cmml" xref="alg2.l8.m1.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">j=\operatorname*{arg\,min}_{i}{g_{b}}_{i}</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math id="alg2.l9.m1.1" class="ltx_Math" alttext="{g_{b}}_{j}" display="inline"><semantics id="alg2.l9.m1.1a"><mmultiscripts id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><mi id="alg2.l9.m1.1.1.2.2" xref="alg2.l9.m1.1.1.2.2.cmml">g</mi><mi id="alg2.l9.m1.1.1.2.3" xref="alg2.l9.m1.1.1.2.3.cmml">b</mi><mrow id="alg2.l9.m1.1.1a" xref="alg2.l9.m1.1.1.cmml"></mrow><mi id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml">j</mi><mrow id="alg2.l9.m1.1.1b" xref="alg2.l9.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1">subscript</csymbol><apply id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1">subscript</csymbol><ci id="alg2.l9.m1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.2.2">𝑔</ci><ci id="alg2.l9.m1.1.1.2.3.cmml" xref="alg2.l9.m1.1.1.2.3">𝑏</ci></apply><ci id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">{g_{b}}_{j}</annotation></semantics></math> <math id="alg2.l9.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l9.m2.1a"><mo stretchy="false" id="alg2.l9.m2.1.1" xref="alg2.l9.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.1b"><ci id="alg2.l9.m2.1.1.cmml" xref="alg2.l9.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.1c">\leftarrow</annotation></semantics></math> <math id="alg2.l9.m3.1" class="ltx_Math" alttext="{g_{b}}_{j}-m_{\text{impact}}" display="inline"><semantics id="alg2.l9.m3.1a"><mrow id="alg2.l9.m3.1.1" xref="alg2.l9.m3.1.1.cmml"><mmultiscripts id="alg2.l9.m3.1.1.2" xref="alg2.l9.m3.1.1.2.cmml"><mi id="alg2.l9.m3.1.1.2.2.2" xref="alg2.l9.m3.1.1.2.2.2.cmml">g</mi><mi id="alg2.l9.m3.1.1.2.2.3" xref="alg2.l9.m3.1.1.2.2.3.cmml">b</mi><mrow id="alg2.l9.m3.1.1.2a" xref="alg2.l9.m3.1.1.2.cmml"></mrow><mi id="alg2.l9.m3.1.1.2.3" xref="alg2.l9.m3.1.1.2.3.cmml">j</mi><mrow id="alg2.l9.m3.1.1.2b" xref="alg2.l9.m3.1.1.2.cmml"></mrow></mmultiscripts><mo id="alg2.l9.m3.1.1.1" xref="alg2.l9.m3.1.1.1.cmml">−</mo><msub id="alg2.l9.m3.1.1.3" xref="alg2.l9.m3.1.1.3.cmml"><mi id="alg2.l9.m3.1.1.3.2" xref="alg2.l9.m3.1.1.3.2.cmml">m</mi><mtext id="alg2.l9.m3.1.1.3.3" xref="alg2.l9.m3.1.1.3.3a.cmml">impact</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m3.1b"><apply id="alg2.l9.m3.1.1.cmml" xref="alg2.l9.m3.1.1"><minus id="alg2.l9.m3.1.1.1.cmml" xref="alg2.l9.m3.1.1.1"></minus><apply id="alg2.l9.m3.1.1.2.cmml" xref="alg2.l9.m3.1.1.2"><csymbol cd="ambiguous" id="alg2.l9.m3.1.1.2.1.cmml" xref="alg2.l9.m3.1.1.2">subscript</csymbol><apply id="alg2.l9.m3.1.1.2.2.cmml" xref="alg2.l9.m3.1.1.2"><csymbol cd="ambiguous" id="alg2.l9.m3.1.1.2.2.1.cmml" xref="alg2.l9.m3.1.1.2">subscript</csymbol><ci id="alg2.l9.m3.1.1.2.2.2.cmml" xref="alg2.l9.m3.1.1.2.2.2">𝑔</ci><ci id="alg2.l9.m3.1.1.2.2.3.cmml" xref="alg2.l9.m3.1.1.2.2.3">𝑏</ci></apply><ci id="alg2.l9.m3.1.1.2.3.cmml" xref="alg2.l9.m3.1.1.2.3">𝑗</ci></apply><apply id="alg2.l9.m3.1.1.3.cmml" xref="alg2.l9.m3.1.1.3"><csymbol cd="ambiguous" id="alg2.l9.m3.1.1.3.1.cmml" xref="alg2.l9.m3.1.1.3">subscript</csymbol><ci id="alg2.l9.m3.1.1.3.2.cmml" xref="alg2.l9.m3.1.1.3.2">𝑚</ci><ci id="alg2.l9.m3.1.1.3.3a.cmml" xref="alg2.l9.m3.1.1.3.3"><mtext mathsize="70%" id="alg2.l9.m3.1.1.3.3.cmml" xref="alg2.l9.m3.1.1.3.3">impact</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m3.1c">{g_{b}}_{j}-m_{\text{impact}}</annotation></semantics></math>

</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <math id="alg2.l10.m1.1" class="ltx_Math" alttext="v_{\text{tokens}}" display="inline"><semantics id="alg2.l10.m1.1a"><msub id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mi id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml">v</mi><mtext id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3a.cmml">tokens</mtext></msub><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1">subscript</csymbol><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">𝑣</ci><ci id="alg2.l10.m1.1.1.3a.cmml" xref="alg2.l10.m1.1.1.3"><mtext mathsize="70%" id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3">tokens</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">v_{\text{tokens}}</annotation></semantics></math> append <math id="alg2.l10.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg2.l10.m2.1a"><mi id="alg2.l10.m2.1.1" xref="alg2.l10.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg2.l10.m2.1b"><ci id="alg2.l10.m2.1.1.cmml" xref="alg2.l10.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m2.1c">j</annotation></semantics></math>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>  <span id="alg2.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l11.2" class="ltx_text ltx_font_bold">while</span>
</div>
</div>
</figure>
<figure id="alg3" class="ltx_float ltx_minipage ltx_align_middle ltx_framed ltx_framed_top" style="width:194.8pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg3.2.1.1" class="ltx_text ltx_font_bold">Algorithm 3</span> </span> Token Recovery 
<br class="ltx_break">(Tied encoder Embedding)</figcaption>
<div id="alg3.3" class="ltx_listing ltx_listing">
<div id="alg3.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span id="alg3.l1.1" class="ltx_text ltx_font_bold">Input:</span> Embedding weight gradient <math id="alg3.l1.m1.1" class="ltx_Math" alttext="g_{e}" display="inline"><semantics id="alg3.l1.m1.1a"><msub id="alg3.l1.m1.1.1" xref="alg3.l1.m1.1.1.cmml"><mi id="alg3.l1.m1.1.1.2" xref="alg3.l1.m1.1.1.2.cmml">g</mi><mi id="alg3.l1.m1.1.1.3" xref="alg3.l1.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.1b"><apply id="alg3.l1.m1.1.1.cmml" xref="alg3.l1.m1.1.1"><csymbol cd="ambiguous" id="alg3.l1.m1.1.1.1.cmml" xref="alg3.l1.m1.1.1">subscript</csymbol><ci id="alg3.l1.m1.1.1.2.cmml" xref="alg3.l1.m1.1.1.2">𝑔</ci><ci id="alg3.l1.m1.1.1.3.cmml" xref="alg3.l1.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.1c">g_{e}</annotation></semantics></math>, sequence length <math id="alg3.l1.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="alg3.l1.m2.1a"><mi id="alg3.l1.m2.1.1" xref="alg3.l1.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m2.1b"><ci id="alg3.l1.m2.1.1.cmml" xref="alg3.l1.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m2.1c">s</annotation></semantics></math>, number of expected sequences <math id="alg3.l1.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg3.l1.m3.1a"><mi id="alg3.l1.m3.1.1" xref="alg3.l1.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m3.1b"><ci id="alg3.l1.m3.1.1.cmml" xref="alg3.l1.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m3.1c">n</annotation></semantics></math>, cutoff factor <math id="alg3.l1.m4.1" class="ltx_Math" alttext="f" display="inline"><semantics id="alg3.l1.m4.1a"><mi id="alg3.l1.m4.1.1" xref="alg3.l1.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m4.1b"><ci id="alg3.l1.m4.1.1.cmml" xref="alg3.l1.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m4.1c">f</annotation></semantics></math>

</div>
<div id="alg3.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <math id="alg3.l2.m1.1" class="ltx_Math" alttext="{n_{e}}_{j}=||{g_{e}}_{j}||_{2}" display="inline"><semantics id="alg3.l2.m1.1a"><mrow id="alg3.l2.m1.1.1" xref="alg3.l2.m1.1.1.cmml"><mmultiscripts id="alg3.l2.m1.1.1.3" xref="alg3.l2.m1.1.1.3.cmml"><mi id="alg3.l2.m1.1.1.3.2.2" xref="alg3.l2.m1.1.1.3.2.2.cmml">n</mi><mi id="alg3.l2.m1.1.1.3.2.3" xref="alg3.l2.m1.1.1.3.2.3.cmml">e</mi><mrow id="alg3.l2.m1.1.1.3a" xref="alg3.l2.m1.1.1.3.cmml"></mrow><mi id="alg3.l2.m1.1.1.3.3" xref="alg3.l2.m1.1.1.3.3.cmml">j</mi><mrow id="alg3.l2.m1.1.1.3b" xref="alg3.l2.m1.1.1.3.cmml"></mrow></mmultiscripts><mo id="alg3.l2.m1.1.1.2" xref="alg3.l2.m1.1.1.2.cmml">=</mo><msub id="alg3.l2.m1.1.1.1" xref="alg3.l2.m1.1.1.1.cmml"><mrow id="alg3.l2.m1.1.1.1.1.1" xref="alg3.l2.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg3.l2.m1.1.1.1.1.1.2" xref="alg3.l2.m1.1.1.1.1.2.1.cmml">‖</mo><mmultiscripts id="alg3.l2.m1.1.1.1.1.1.1" xref="alg3.l2.m1.1.1.1.1.1.1.cmml"><mi id="alg3.l2.m1.1.1.1.1.1.1.2.2" xref="alg3.l2.m1.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="alg3.l2.m1.1.1.1.1.1.1.2.3" xref="alg3.l2.m1.1.1.1.1.1.1.2.3.cmml">e</mi><mrow id="alg3.l2.m1.1.1.1.1.1.1a" xref="alg3.l2.m1.1.1.1.1.1.1.cmml"></mrow><mi id="alg3.l2.m1.1.1.1.1.1.1.3" xref="alg3.l2.m1.1.1.1.1.1.1.3.cmml">j</mi><mrow id="alg3.l2.m1.1.1.1.1.1.1b" xref="alg3.l2.m1.1.1.1.1.1.1.cmml"></mrow></mmultiscripts><mo stretchy="false" id="alg3.l2.m1.1.1.1.1.1.3" xref="alg3.l2.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="alg3.l2.m1.1.1.1.3" xref="alg3.l2.m1.1.1.1.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.1b"><apply id="alg3.l2.m1.1.1.cmml" xref="alg3.l2.m1.1.1"><eq id="alg3.l2.m1.1.1.2.cmml" xref="alg3.l2.m1.1.1.2"></eq><apply id="alg3.l2.m1.1.1.3.cmml" xref="alg3.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l2.m1.1.1.3.1.cmml" xref="alg3.l2.m1.1.1.3">subscript</csymbol><apply id="alg3.l2.m1.1.1.3.2.cmml" xref="alg3.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l2.m1.1.1.3.2.1.cmml" xref="alg3.l2.m1.1.1.3">subscript</csymbol><ci id="alg3.l2.m1.1.1.3.2.2.cmml" xref="alg3.l2.m1.1.1.3.2.2">𝑛</ci><ci id="alg3.l2.m1.1.1.3.2.3.cmml" xref="alg3.l2.m1.1.1.3.2.3">𝑒</ci></apply><ci id="alg3.l2.m1.1.1.3.3.cmml" xref="alg3.l2.m1.1.1.3.3">𝑗</ci></apply><apply id="alg3.l2.m1.1.1.1.cmml" xref="alg3.l2.m1.1.1.1"><csymbol cd="ambiguous" id="alg3.l2.m1.1.1.1.2.cmml" xref="alg3.l2.m1.1.1.1">subscript</csymbol><apply id="alg3.l2.m1.1.1.1.1.2.cmml" xref="alg3.l2.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg3.l2.m1.1.1.1.1.2.1.cmml" xref="alg3.l2.m1.1.1.1.1.1.2">norm</csymbol><apply id="alg3.l2.m1.1.1.1.1.1.1.cmml" xref="alg3.l2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l2.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l2.m1.1.1.1.1.1.1">subscript</csymbol><apply id="alg3.l2.m1.1.1.1.1.1.1.2.cmml" xref="alg3.l2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l2.m1.1.1.1.1.1.1.2.1.cmml" xref="alg3.l2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l2.m1.1.1.1.1.1.1.2.2.cmml" xref="alg3.l2.m1.1.1.1.1.1.1.2.2">𝑔</ci><ci id="alg3.l2.m1.1.1.1.1.1.1.2.3.cmml" xref="alg3.l2.m1.1.1.1.1.1.1.2.3">𝑒</ci></apply><ci id="alg3.l2.m1.1.1.1.1.1.1.3.cmml" xref="alg3.l2.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><cn type="integer" id="alg3.l2.m1.1.1.1.3.cmml" xref="alg3.l2.m1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.1c">{n_{e}}_{j}=||{g_{e}}_{j}||_{2}</annotation></semantics></math> for all <math id="alg3.l2.m2.2" class="ltx_Math" alttext="j=1,...N" display="inline"><semantics id="alg3.l2.m2.2a"><mrow id="alg3.l2.m2.2.2" xref="alg3.l2.m2.2.2.cmml"><mi id="alg3.l2.m2.2.2.3" xref="alg3.l2.m2.2.2.3.cmml">j</mi><mo id="alg3.l2.m2.2.2.2" xref="alg3.l2.m2.2.2.2.cmml">=</mo><mrow id="alg3.l2.m2.2.2.1.1" xref="alg3.l2.m2.2.2.1.2.cmml"><mn id="alg3.l2.m2.1.1" xref="alg3.l2.m2.1.1.cmml">1</mn><mo id="alg3.l2.m2.2.2.1.1.2" xref="alg3.l2.m2.2.2.1.2.cmml">,</mo><mrow id="alg3.l2.m2.2.2.1.1.1" xref="alg3.l2.m2.2.2.1.1.1.cmml"><mi mathvariant="normal" id="alg3.l2.m2.2.2.1.1.1.2" xref="alg3.l2.m2.2.2.1.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg3.l2.m2.2.2.1.1.1.1" xref="alg3.l2.m2.2.2.1.1.1.1.cmml">​</mo><mi id="alg3.l2.m2.2.2.1.1.1.3" xref="alg3.l2.m2.2.2.1.1.1.3.cmml">N</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m2.2b"><apply id="alg3.l2.m2.2.2.cmml" xref="alg3.l2.m2.2.2"><eq id="alg3.l2.m2.2.2.2.cmml" xref="alg3.l2.m2.2.2.2"></eq><ci id="alg3.l2.m2.2.2.3.cmml" xref="alg3.l2.m2.2.2.3">𝑗</ci><list id="alg3.l2.m2.2.2.1.2.cmml" xref="alg3.l2.m2.2.2.1.1"><cn type="integer" id="alg3.l2.m2.1.1.cmml" xref="alg3.l2.m2.1.1">1</cn><apply id="alg3.l2.m2.2.2.1.1.1.cmml" xref="alg3.l2.m2.2.2.1.1.1"><times id="alg3.l2.m2.2.2.1.1.1.1.cmml" xref="alg3.l2.m2.2.2.1.1.1.1"></times><ci id="alg3.l2.m2.2.2.1.1.1.2.cmml" xref="alg3.l2.m2.2.2.1.1.1.2">…</ci><ci id="alg3.l2.m2.2.2.1.1.1.3.cmml" xref="alg3.l2.m2.2.2.1.1.1.3">𝑁</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m2.2c">j=1,...N</annotation></semantics></math> embedding rows

</div>
<div id="alg3.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <math id="alg3.l3.m1.4" class="ltx_Math" alttext="\mu,\sigma=\text{Mean}(\log{n_{e}}),\text{Std}(\log{n_{e}})" display="inline"><semantics id="alg3.l3.m1.4a"><mrow id="alg3.l3.m1.4.4.2" xref="alg3.l3.m1.4.4.3.cmml"><mrow id="alg3.l3.m1.3.3.1.1" xref="alg3.l3.m1.3.3.1.1.cmml"><mrow id="alg3.l3.m1.3.3.1.1.3.2" xref="alg3.l3.m1.3.3.1.1.3.1.cmml"><mi id="alg3.l3.m1.1.1" xref="alg3.l3.m1.1.1.cmml">μ</mi><mo id="alg3.l3.m1.3.3.1.1.3.2.1" xref="alg3.l3.m1.3.3.1.1.3.1.cmml">,</mo><mi id="alg3.l3.m1.2.2" xref="alg3.l3.m1.2.2.cmml">σ</mi></mrow><mo id="alg3.l3.m1.3.3.1.1.2" xref="alg3.l3.m1.3.3.1.1.2.cmml">=</mo><mrow id="alg3.l3.m1.3.3.1.1.1" xref="alg3.l3.m1.3.3.1.1.1.cmml"><mtext id="alg3.l3.m1.3.3.1.1.1.3" xref="alg3.l3.m1.3.3.1.1.1.3a.cmml">Mean</mtext><mo lspace="0em" rspace="0em" id="alg3.l3.m1.3.3.1.1.1.2" xref="alg3.l3.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="alg3.l3.m1.3.3.1.1.1.1.1" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l3.m1.3.3.1.1.1.1.1.2" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l3.m1.3.3.1.1.1.1.1.1" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.cmml"><mi id="alg3.l3.m1.3.3.1.1.1.1.1.1.1" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.1.cmml">log</mi><mo lspace="0.167em" id="alg3.l3.m1.3.3.1.1.1.1.1.1a" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.cmml">⁡</mo><msub id="alg3.l3.m1.3.3.1.1.1.1.1.1.2" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="alg3.l3.m1.3.3.1.1.1.1.1.1.2.2" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.2.2.cmml">n</mi><mi id="alg3.l3.m1.3.3.1.1.1.1.1.1.2.3" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.2.3.cmml">e</mi></msub></mrow><mo stretchy="false" id="alg3.l3.m1.3.3.1.1.1.1.1.3" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg3.l3.m1.4.4.2.3" xref="alg3.l3.m1.4.4.3a.cmml">,</mo><mrow id="alg3.l3.m1.4.4.2.2" xref="alg3.l3.m1.4.4.2.2.cmml"><mtext id="alg3.l3.m1.4.4.2.2.3" xref="alg3.l3.m1.4.4.2.2.3a.cmml">Std</mtext><mo lspace="0em" rspace="0em" id="alg3.l3.m1.4.4.2.2.2" xref="alg3.l3.m1.4.4.2.2.2.cmml">​</mo><mrow id="alg3.l3.m1.4.4.2.2.1.1" xref="alg3.l3.m1.4.4.2.2.1.1.1.cmml"><mo stretchy="false" id="alg3.l3.m1.4.4.2.2.1.1.2" xref="alg3.l3.m1.4.4.2.2.1.1.1.cmml">(</mo><mrow id="alg3.l3.m1.4.4.2.2.1.1.1" xref="alg3.l3.m1.4.4.2.2.1.1.1.cmml"><mi id="alg3.l3.m1.4.4.2.2.1.1.1.1" xref="alg3.l3.m1.4.4.2.2.1.1.1.1.cmml">log</mi><mo lspace="0.167em" id="alg3.l3.m1.4.4.2.2.1.1.1a" xref="alg3.l3.m1.4.4.2.2.1.1.1.cmml">⁡</mo><msub id="alg3.l3.m1.4.4.2.2.1.1.1.2" xref="alg3.l3.m1.4.4.2.2.1.1.1.2.cmml"><mi id="alg3.l3.m1.4.4.2.2.1.1.1.2.2" xref="alg3.l3.m1.4.4.2.2.1.1.1.2.2.cmml">n</mi><mi id="alg3.l3.m1.4.4.2.2.1.1.1.2.3" xref="alg3.l3.m1.4.4.2.2.1.1.1.2.3.cmml">e</mi></msub></mrow><mo stretchy="false" id="alg3.l3.m1.4.4.2.2.1.1.3" xref="alg3.l3.m1.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.4b"><apply id="alg3.l3.m1.4.4.3.cmml" xref="alg3.l3.m1.4.4.2"><csymbol cd="ambiguous" id="alg3.l3.m1.4.4.3a.cmml" xref="alg3.l3.m1.4.4.2.3">formulae-sequence</csymbol><apply id="alg3.l3.m1.3.3.1.1.cmml" xref="alg3.l3.m1.3.3.1.1"><eq id="alg3.l3.m1.3.3.1.1.2.cmml" xref="alg3.l3.m1.3.3.1.1.2"></eq><list id="alg3.l3.m1.3.3.1.1.3.1.cmml" xref="alg3.l3.m1.3.3.1.1.3.2"><ci id="alg3.l3.m1.1.1.cmml" xref="alg3.l3.m1.1.1">𝜇</ci><ci id="alg3.l3.m1.2.2.cmml" xref="alg3.l3.m1.2.2">𝜎</ci></list><apply id="alg3.l3.m1.3.3.1.1.1.cmml" xref="alg3.l3.m1.3.3.1.1.1"><times id="alg3.l3.m1.3.3.1.1.1.2.cmml" xref="alg3.l3.m1.3.3.1.1.1.2"></times><ci id="alg3.l3.m1.3.3.1.1.1.3a.cmml" xref="alg3.l3.m1.3.3.1.1.1.3"><mtext id="alg3.l3.m1.3.3.1.1.1.3.cmml" xref="alg3.l3.m1.3.3.1.1.1.3">Mean</mtext></ci><apply id="alg3.l3.m1.3.3.1.1.1.1.1.1.cmml" xref="alg3.l3.m1.3.3.1.1.1.1.1"><log id="alg3.l3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.1"></log><apply id="alg3.l3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l3.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg3.l3.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.2.2">𝑛</ci><ci id="alg3.l3.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="alg3.l3.m1.3.3.1.1.1.1.1.1.2.3">𝑒</ci></apply></apply></apply></apply><apply id="alg3.l3.m1.4.4.2.2.cmml" xref="alg3.l3.m1.4.4.2.2"><times id="alg3.l3.m1.4.4.2.2.2.cmml" xref="alg3.l3.m1.4.4.2.2.2"></times><ci id="alg3.l3.m1.4.4.2.2.3a.cmml" xref="alg3.l3.m1.4.4.2.2.3"><mtext id="alg3.l3.m1.4.4.2.2.3.cmml" xref="alg3.l3.m1.4.4.2.2.3">Std</mtext></ci><apply id="alg3.l3.m1.4.4.2.2.1.1.1.cmml" xref="alg3.l3.m1.4.4.2.2.1.1"><log id="alg3.l3.m1.4.4.2.2.1.1.1.1.cmml" xref="alg3.l3.m1.4.4.2.2.1.1.1.1"></log><apply id="alg3.l3.m1.4.4.2.2.1.1.1.2.cmml" xref="alg3.l3.m1.4.4.2.2.1.1.1.2"><csymbol cd="ambiguous" id="alg3.l3.m1.4.4.2.2.1.1.1.2.1.cmml" xref="alg3.l3.m1.4.4.2.2.1.1.1.2">subscript</csymbol><ci id="alg3.l3.m1.4.4.2.2.1.1.1.2.2.cmml" xref="alg3.l3.m1.4.4.2.2.1.1.1.2.2">𝑛</ci><ci id="alg3.l3.m1.4.4.2.2.1.1.1.2.3.cmml" xref="alg3.l3.m1.4.4.2.2.1.1.1.2.3">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.4c">\mu,\sigma=\text{Mean}(\log{n_{e}}),\text{Std}(\log{n_{e}})</annotation></semantics></math>

</div>
<div id="alg3.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>  <math id="alg3.l4.m1.1" class="ltx_Math" alttext="c=\mu+f\sigma" display="inline"><semantics id="alg3.l4.m1.1a"><mrow id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml"><mi id="alg3.l4.m1.1.1.2" xref="alg3.l4.m1.1.1.2.cmml">c</mi><mo id="alg3.l4.m1.1.1.1" xref="alg3.l4.m1.1.1.1.cmml">=</mo><mrow id="alg3.l4.m1.1.1.3" xref="alg3.l4.m1.1.1.3.cmml"><mi id="alg3.l4.m1.1.1.3.2" xref="alg3.l4.m1.1.1.3.2.cmml">μ</mi><mo id="alg3.l4.m1.1.1.3.1" xref="alg3.l4.m1.1.1.3.1.cmml">+</mo><mrow id="alg3.l4.m1.1.1.3.3" xref="alg3.l4.m1.1.1.3.3.cmml"><mi id="alg3.l4.m1.1.1.3.3.2" xref="alg3.l4.m1.1.1.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg3.l4.m1.1.1.3.3.1" xref="alg3.l4.m1.1.1.3.3.1.cmml">​</mo><mi id="alg3.l4.m1.1.1.3.3.3" xref="alg3.l4.m1.1.1.3.3.3.cmml">σ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><apply id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1"><eq id="alg3.l4.m1.1.1.1.cmml" xref="alg3.l4.m1.1.1.1"></eq><ci id="alg3.l4.m1.1.1.2.cmml" xref="alg3.l4.m1.1.1.2">𝑐</ci><apply id="alg3.l4.m1.1.1.3.cmml" xref="alg3.l4.m1.1.1.3"><plus id="alg3.l4.m1.1.1.3.1.cmml" xref="alg3.l4.m1.1.1.3.1"></plus><ci id="alg3.l4.m1.1.1.3.2.cmml" xref="alg3.l4.m1.1.1.3.2">𝜇</ci><apply id="alg3.l4.m1.1.1.3.3.cmml" xref="alg3.l4.m1.1.1.3.3"><times id="alg3.l4.m1.1.1.3.3.1.cmml" xref="alg3.l4.m1.1.1.3.3.1"></times><ci id="alg3.l4.m1.1.1.3.3.2.cmml" xref="alg3.l4.m1.1.1.3.3.2">𝑓</ci><ci id="alg3.l4.m1.1.1.3.3.3.cmml" xref="alg3.l4.m1.1.1.3.3.3">𝜎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">c=\mu+f\sigma</annotation></semantics></math>

</div>
<div id="alg3.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>  <math id="alg3.l5.m1.1" class="ltx_Math" alttext="v_{\text{tokens}}" display="inline"><semantics id="alg3.l5.m1.1a"><msub id="alg3.l5.m1.1.1" xref="alg3.l5.m1.1.1.cmml"><mi id="alg3.l5.m1.1.1.2" xref="alg3.l5.m1.1.1.2.cmml">v</mi><mtext id="alg3.l5.m1.1.1.3" xref="alg3.l5.m1.1.1.3a.cmml">tokens</mtext></msub><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.1b"><apply id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.1.cmml" xref="alg3.l5.m1.1.1">subscript</csymbol><ci id="alg3.l5.m1.1.1.2.cmml" xref="alg3.l5.m1.1.1.2">𝑣</ci><ci id="alg3.l5.m1.1.1.3a.cmml" xref="alg3.l5.m1.1.1.3"><mtext mathsize="70%" id="alg3.l5.m1.1.1.3.cmml" xref="alg3.l5.m1.1.1.3">tokens</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.1c">v_{\text{tokens}}</annotation></semantics></math> <math id="alg3.l5.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg3.l5.m2.1a"><mo stretchy="false" id="alg3.l5.m2.1.1" xref="alg3.l5.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg3.l5.m2.1b"><ci id="alg3.l5.m2.1.1.cmml" xref="alg3.l5.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m2.1c">\leftarrow</annotation></semantics></math> all indices where <math id="alg3.l5.m3.1" class="ltx_Math" alttext="n_{e}&gt;c" display="inline"><semantics id="alg3.l5.m3.1a"><mrow id="alg3.l5.m3.1.1" xref="alg3.l5.m3.1.1.cmml"><msub id="alg3.l5.m3.1.1.2" xref="alg3.l5.m3.1.1.2.cmml"><mi id="alg3.l5.m3.1.1.2.2" xref="alg3.l5.m3.1.1.2.2.cmml">n</mi><mi id="alg3.l5.m3.1.1.2.3" xref="alg3.l5.m3.1.1.2.3.cmml">e</mi></msub><mo id="alg3.l5.m3.1.1.1" xref="alg3.l5.m3.1.1.1.cmml">&gt;</mo><mi id="alg3.l5.m3.1.1.3" xref="alg3.l5.m3.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m3.1b"><apply id="alg3.l5.m3.1.1.cmml" xref="alg3.l5.m3.1.1"><gt id="alg3.l5.m3.1.1.1.cmml" xref="alg3.l5.m3.1.1.1"></gt><apply id="alg3.l5.m3.1.1.2.cmml" xref="alg3.l5.m3.1.1.2"><csymbol cd="ambiguous" id="alg3.l5.m3.1.1.2.1.cmml" xref="alg3.l5.m3.1.1.2">subscript</csymbol><ci id="alg3.l5.m3.1.1.2.2.cmml" xref="alg3.l5.m3.1.1.2.2">𝑛</ci><ci id="alg3.l5.m3.1.1.2.3.cmml" xref="alg3.l5.m3.1.1.2.3">𝑒</ci></apply><ci id="alg3.l5.m3.1.1.3.cmml" xref="alg3.l5.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m3.1c">n_{e}&gt;c</annotation></semantics></math>

</div>
<div id="alg3.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>  <math id="alg3.l6.m1.1" class="ltx_Math" alttext="m_{\text{impact}}=\frac{1}{sn}\sum_{i\in v_{\text{tokens}}}{n_{e}}_{i}" display="inline"><semantics id="alg3.l6.m1.1a"><mrow id="alg3.l6.m1.1.1" xref="alg3.l6.m1.1.1.cmml"><msub id="alg3.l6.m1.1.1.2" xref="alg3.l6.m1.1.1.2.cmml"><mi id="alg3.l6.m1.1.1.2.2" xref="alg3.l6.m1.1.1.2.2.cmml">m</mi><mtext id="alg3.l6.m1.1.1.2.3" xref="alg3.l6.m1.1.1.2.3a.cmml">impact</mtext></msub><mo id="alg3.l6.m1.1.1.1" xref="alg3.l6.m1.1.1.1.cmml">=</mo><mrow id="alg3.l6.m1.1.1.3" xref="alg3.l6.m1.1.1.3.cmml"><mfrac id="alg3.l6.m1.1.1.3.2" xref="alg3.l6.m1.1.1.3.2.cmml"><mn id="alg3.l6.m1.1.1.3.2.2" xref="alg3.l6.m1.1.1.3.2.2.cmml">1</mn><mrow id="alg3.l6.m1.1.1.3.2.3" xref="alg3.l6.m1.1.1.3.2.3.cmml"><mi id="alg3.l6.m1.1.1.3.2.3.2" xref="alg3.l6.m1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l6.m1.1.1.3.2.3.1" xref="alg3.l6.m1.1.1.3.2.3.1.cmml">​</mo><mi id="alg3.l6.m1.1.1.3.2.3.3" xref="alg3.l6.m1.1.1.3.2.3.3.cmml">n</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg3.l6.m1.1.1.3.1" xref="alg3.l6.m1.1.1.3.1.cmml">​</mo><mrow id="alg3.l6.m1.1.1.3.3" xref="alg3.l6.m1.1.1.3.3.cmml"><msub id="alg3.l6.m1.1.1.3.3.1" xref="alg3.l6.m1.1.1.3.3.1.cmml"><mo id="alg3.l6.m1.1.1.3.3.1.2" xref="alg3.l6.m1.1.1.3.3.1.2.cmml">∑</mo><mrow id="alg3.l6.m1.1.1.3.3.1.3" xref="alg3.l6.m1.1.1.3.3.1.3.cmml"><mi id="alg3.l6.m1.1.1.3.3.1.3.2" xref="alg3.l6.m1.1.1.3.3.1.3.2.cmml">i</mi><mo id="alg3.l6.m1.1.1.3.3.1.3.1" xref="alg3.l6.m1.1.1.3.3.1.3.1.cmml">∈</mo><msub id="alg3.l6.m1.1.1.3.3.1.3.3" xref="alg3.l6.m1.1.1.3.3.1.3.3.cmml"><mi id="alg3.l6.m1.1.1.3.3.1.3.3.2" xref="alg3.l6.m1.1.1.3.3.1.3.3.2.cmml">v</mi><mtext id="alg3.l6.m1.1.1.3.3.1.3.3.3" xref="alg3.l6.m1.1.1.3.3.1.3.3.3a.cmml">tokens</mtext></msub></mrow></msub><mmultiscripts id="alg3.l6.m1.1.1.3.3.2" xref="alg3.l6.m1.1.1.3.3.2.cmml"><mi id="alg3.l6.m1.1.1.3.3.2.2.2" xref="alg3.l6.m1.1.1.3.3.2.2.2.cmml">n</mi><mi id="alg3.l6.m1.1.1.3.3.2.2.3" xref="alg3.l6.m1.1.1.3.3.2.2.3.cmml">e</mi><mrow id="alg3.l6.m1.1.1.3.3.2a" xref="alg3.l6.m1.1.1.3.3.2.cmml"></mrow><mi id="alg3.l6.m1.1.1.3.3.2.3" xref="alg3.l6.m1.1.1.3.3.2.3.cmml">i</mi><mrow id="alg3.l6.m1.1.1.3.3.2b" xref="alg3.l6.m1.1.1.3.3.2.cmml"></mrow></mmultiscripts></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.1b"><apply id="alg3.l6.m1.1.1.cmml" xref="alg3.l6.m1.1.1"><eq id="alg3.l6.m1.1.1.1.cmml" xref="alg3.l6.m1.1.1.1"></eq><apply id="alg3.l6.m1.1.1.2.cmml" xref="alg3.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l6.m1.1.1.2.1.cmml" xref="alg3.l6.m1.1.1.2">subscript</csymbol><ci id="alg3.l6.m1.1.1.2.2.cmml" xref="alg3.l6.m1.1.1.2.2">𝑚</ci><ci id="alg3.l6.m1.1.1.2.3a.cmml" xref="alg3.l6.m1.1.1.2.3"><mtext mathsize="70%" id="alg3.l6.m1.1.1.2.3.cmml" xref="alg3.l6.m1.1.1.2.3">impact</mtext></ci></apply><apply id="alg3.l6.m1.1.1.3.cmml" xref="alg3.l6.m1.1.1.3"><times id="alg3.l6.m1.1.1.3.1.cmml" xref="alg3.l6.m1.1.1.3.1"></times><apply id="alg3.l6.m1.1.1.3.2.cmml" xref="alg3.l6.m1.1.1.3.2"><divide id="alg3.l6.m1.1.1.3.2.1.cmml" xref="alg3.l6.m1.1.1.3.2"></divide><cn type="integer" id="alg3.l6.m1.1.1.3.2.2.cmml" xref="alg3.l6.m1.1.1.3.2.2">1</cn><apply id="alg3.l6.m1.1.1.3.2.3.cmml" xref="alg3.l6.m1.1.1.3.2.3"><times id="alg3.l6.m1.1.1.3.2.3.1.cmml" xref="alg3.l6.m1.1.1.3.2.3.1"></times><ci id="alg3.l6.m1.1.1.3.2.3.2.cmml" xref="alg3.l6.m1.1.1.3.2.3.2">𝑠</ci><ci id="alg3.l6.m1.1.1.3.2.3.3.cmml" xref="alg3.l6.m1.1.1.3.2.3.3">𝑛</ci></apply></apply><apply id="alg3.l6.m1.1.1.3.3.cmml" xref="alg3.l6.m1.1.1.3.3"><apply id="alg3.l6.m1.1.1.3.3.1.cmml" xref="alg3.l6.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg3.l6.m1.1.1.3.3.1.1.cmml" xref="alg3.l6.m1.1.1.3.3.1">subscript</csymbol><sum id="alg3.l6.m1.1.1.3.3.1.2.cmml" xref="alg3.l6.m1.1.1.3.3.1.2"></sum><apply id="alg3.l6.m1.1.1.3.3.1.3.cmml" xref="alg3.l6.m1.1.1.3.3.1.3"><in id="alg3.l6.m1.1.1.3.3.1.3.1.cmml" xref="alg3.l6.m1.1.1.3.3.1.3.1"></in><ci id="alg3.l6.m1.1.1.3.3.1.3.2.cmml" xref="alg3.l6.m1.1.1.3.3.1.3.2">𝑖</ci><apply id="alg3.l6.m1.1.1.3.3.1.3.3.cmml" xref="alg3.l6.m1.1.1.3.3.1.3.3"><csymbol cd="ambiguous" id="alg3.l6.m1.1.1.3.3.1.3.3.1.cmml" xref="alg3.l6.m1.1.1.3.3.1.3.3">subscript</csymbol><ci id="alg3.l6.m1.1.1.3.3.1.3.3.2.cmml" xref="alg3.l6.m1.1.1.3.3.1.3.3.2">𝑣</ci><ci id="alg3.l6.m1.1.1.3.3.1.3.3.3a.cmml" xref="alg3.l6.m1.1.1.3.3.1.3.3.3"><mtext mathsize="50%" id="alg3.l6.m1.1.1.3.3.1.3.3.3.cmml" xref="alg3.l6.m1.1.1.3.3.1.3.3.3">tokens</mtext></ci></apply></apply></apply><apply id="alg3.l6.m1.1.1.3.3.2.cmml" xref="alg3.l6.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg3.l6.m1.1.1.3.3.2.1.cmml" xref="alg3.l6.m1.1.1.3.3.2">subscript</csymbol><apply id="alg3.l6.m1.1.1.3.3.2.2.cmml" xref="alg3.l6.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg3.l6.m1.1.1.3.3.2.2.1.cmml" xref="alg3.l6.m1.1.1.3.3.2">subscript</csymbol><ci id="alg3.l6.m1.1.1.3.3.2.2.2.cmml" xref="alg3.l6.m1.1.1.3.3.2.2.2">𝑛</ci><ci id="alg3.l6.m1.1.1.3.3.2.2.3.cmml" xref="alg3.l6.m1.1.1.3.3.2.2.3">𝑒</ci></apply><ci id="alg3.l6.m1.1.1.3.3.2.3.cmml" xref="alg3.l6.m1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.1c">m_{\text{impact}}=\frac{1}{sn}\sum_{i\in v_{\text{tokens}}}{n_{e}}_{i}</annotation></semantics></math>

</div>
<div id="alg3.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>  <math id="alg3.l7.m1.1" class="ltx_Math" alttext="n_{e}[v_{\text{tokens}}]" display="inline"><semantics id="alg3.l7.m1.1a"><mrow id="alg3.l7.m1.1.1" xref="alg3.l7.m1.1.1.cmml"><msub id="alg3.l7.m1.1.1.3" xref="alg3.l7.m1.1.1.3.cmml"><mi id="alg3.l7.m1.1.1.3.2" xref="alg3.l7.m1.1.1.3.2.cmml">n</mi><mi id="alg3.l7.m1.1.1.3.3" xref="alg3.l7.m1.1.1.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="alg3.l7.m1.1.1.2" xref="alg3.l7.m1.1.1.2.cmml">​</mo><mrow id="alg3.l7.m1.1.1.1.1" xref="alg3.l7.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg3.l7.m1.1.1.1.1.2" xref="alg3.l7.m1.1.1.1.2.1.cmml">[</mo><msub id="alg3.l7.m1.1.1.1.1.1" xref="alg3.l7.m1.1.1.1.1.1.cmml"><mi id="alg3.l7.m1.1.1.1.1.1.2" xref="alg3.l7.m1.1.1.1.1.1.2.cmml">v</mi><mtext id="alg3.l7.m1.1.1.1.1.1.3" xref="alg3.l7.m1.1.1.1.1.1.3a.cmml">tokens</mtext></msub><mo stretchy="false" id="alg3.l7.m1.1.1.1.1.3" xref="alg3.l7.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l7.m1.1b"><apply id="alg3.l7.m1.1.1.cmml" xref="alg3.l7.m1.1.1"><times id="alg3.l7.m1.1.1.2.cmml" xref="alg3.l7.m1.1.1.2"></times><apply id="alg3.l7.m1.1.1.3.cmml" xref="alg3.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l7.m1.1.1.3.1.cmml" xref="alg3.l7.m1.1.1.3">subscript</csymbol><ci id="alg3.l7.m1.1.1.3.2.cmml" xref="alg3.l7.m1.1.1.3.2">𝑛</ci><ci id="alg3.l7.m1.1.1.3.3.cmml" xref="alg3.l7.m1.1.1.3.3">𝑒</ci></apply><apply id="alg3.l7.m1.1.1.1.2.cmml" xref="alg3.l7.m1.1.1.1.1"><csymbol cd="latexml" id="alg3.l7.m1.1.1.1.2.1.cmml" xref="alg3.l7.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg3.l7.m1.1.1.1.1.1.cmml" xref="alg3.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l7.m1.1.1.1.1.1.1.cmml" xref="alg3.l7.m1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l7.m1.1.1.1.1.1.2.cmml" xref="alg3.l7.m1.1.1.1.1.1.2">𝑣</ci><ci id="alg3.l7.m1.1.1.1.1.1.3a.cmml" xref="alg3.l7.m1.1.1.1.1.1.3"><mtext mathsize="70%" id="alg3.l7.m1.1.1.1.1.1.3.cmml" xref="alg3.l7.m1.1.1.1.1.1.3">tokens</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m1.1c">n_{e}[v_{\text{tokens}}]</annotation></semantics></math> <math id="alg3.l7.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg3.l7.m2.1a"><mo stretchy="false" id="alg3.l7.m2.1.1" xref="alg3.l7.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg3.l7.m2.1b"><ci id="alg3.l7.m2.1.1.cmml" xref="alg3.l7.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m2.1c">\leftarrow</annotation></semantics></math> <math id="alg3.l7.m3.1" class="ltx_Math" alttext="n_{e}[v_{\text{tokens}}]-m_{\text{impact}}" display="inline"><semantics id="alg3.l7.m3.1a"><mrow id="alg3.l7.m3.1.1" xref="alg3.l7.m3.1.1.cmml"><mrow id="alg3.l7.m3.1.1.1" xref="alg3.l7.m3.1.1.1.cmml"><msub id="alg3.l7.m3.1.1.1.3" xref="alg3.l7.m3.1.1.1.3.cmml"><mi id="alg3.l7.m3.1.1.1.3.2" xref="alg3.l7.m3.1.1.1.3.2.cmml">n</mi><mi id="alg3.l7.m3.1.1.1.3.3" xref="alg3.l7.m3.1.1.1.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="alg3.l7.m3.1.1.1.2" xref="alg3.l7.m3.1.1.1.2.cmml">​</mo><mrow id="alg3.l7.m3.1.1.1.1.1" xref="alg3.l7.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="alg3.l7.m3.1.1.1.1.1.2" xref="alg3.l7.m3.1.1.1.1.2.1.cmml">[</mo><msub id="alg3.l7.m3.1.1.1.1.1.1" xref="alg3.l7.m3.1.1.1.1.1.1.cmml"><mi id="alg3.l7.m3.1.1.1.1.1.1.2" xref="alg3.l7.m3.1.1.1.1.1.1.2.cmml">v</mi><mtext id="alg3.l7.m3.1.1.1.1.1.1.3" xref="alg3.l7.m3.1.1.1.1.1.1.3a.cmml">tokens</mtext></msub><mo stretchy="false" id="alg3.l7.m3.1.1.1.1.1.3" xref="alg3.l7.m3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg3.l7.m3.1.1.2" xref="alg3.l7.m3.1.1.2.cmml">−</mo><msub id="alg3.l7.m3.1.1.3" xref="alg3.l7.m3.1.1.3.cmml"><mi id="alg3.l7.m3.1.1.3.2" xref="alg3.l7.m3.1.1.3.2.cmml">m</mi><mtext id="alg3.l7.m3.1.1.3.3" xref="alg3.l7.m3.1.1.3.3a.cmml">impact</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg3.l7.m3.1b"><apply id="alg3.l7.m3.1.1.cmml" xref="alg3.l7.m3.1.1"><minus id="alg3.l7.m3.1.1.2.cmml" xref="alg3.l7.m3.1.1.2"></minus><apply id="alg3.l7.m3.1.1.1.cmml" xref="alg3.l7.m3.1.1.1"><times id="alg3.l7.m3.1.1.1.2.cmml" xref="alg3.l7.m3.1.1.1.2"></times><apply id="alg3.l7.m3.1.1.1.3.cmml" xref="alg3.l7.m3.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l7.m3.1.1.1.3.1.cmml" xref="alg3.l7.m3.1.1.1.3">subscript</csymbol><ci id="alg3.l7.m3.1.1.1.3.2.cmml" xref="alg3.l7.m3.1.1.1.3.2">𝑛</ci><ci id="alg3.l7.m3.1.1.1.3.3.cmml" xref="alg3.l7.m3.1.1.1.3.3">𝑒</ci></apply><apply id="alg3.l7.m3.1.1.1.1.2.cmml" xref="alg3.l7.m3.1.1.1.1.1"><csymbol cd="latexml" id="alg3.l7.m3.1.1.1.1.2.1.cmml" xref="alg3.l7.m3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg3.l7.m3.1.1.1.1.1.1.cmml" xref="alg3.l7.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l7.m3.1.1.1.1.1.1.1.cmml" xref="alg3.l7.m3.1.1.1.1.1.1">subscript</csymbol><ci id="alg3.l7.m3.1.1.1.1.1.1.2.cmml" xref="alg3.l7.m3.1.1.1.1.1.1.2">𝑣</ci><ci id="alg3.l7.m3.1.1.1.1.1.1.3a.cmml" xref="alg3.l7.m3.1.1.1.1.1.1.3"><mtext mathsize="70%" id="alg3.l7.m3.1.1.1.1.1.1.3.cmml" xref="alg3.l7.m3.1.1.1.1.1.1.3">tokens</mtext></ci></apply></apply></apply><apply id="alg3.l7.m3.1.1.3.cmml" xref="alg3.l7.m3.1.1.3"><csymbol cd="ambiguous" id="alg3.l7.m3.1.1.3.1.cmml" xref="alg3.l7.m3.1.1.3">subscript</csymbol><ci id="alg3.l7.m3.1.1.3.2.cmml" xref="alg3.l7.m3.1.1.3.2">𝑚</ci><ci id="alg3.l7.m3.1.1.3.3a.cmml" xref="alg3.l7.m3.1.1.3.3"><mtext mathsize="70%" id="alg3.l7.m3.1.1.3.3.cmml" xref="alg3.l7.m3.1.1.3.3">impact</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m3.1c">n_{e}[v_{\text{tokens}}]-m_{\text{impact}}</annotation></semantics></math>

</div>
<div id="alg3.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>  <span id="alg3.l8.1" class="ltx_text ltx_font_bold">while</span> Length of <math id="alg3.l8.m1.1" class="ltx_Math" alttext="v_{\text{tokens}}&lt;sn" display="inline"><semantics id="alg3.l8.m1.1a"><mrow id="alg3.l8.m1.1.1" xref="alg3.l8.m1.1.1.cmml"><msub id="alg3.l8.m1.1.1.2" xref="alg3.l8.m1.1.1.2.cmml"><mi id="alg3.l8.m1.1.1.2.2" xref="alg3.l8.m1.1.1.2.2.cmml">v</mi><mtext id="alg3.l8.m1.1.1.2.3" xref="alg3.l8.m1.1.1.2.3a.cmml">tokens</mtext></msub><mo id="alg3.l8.m1.1.1.1" xref="alg3.l8.m1.1.1.1.cmml">&lt;</mo><mrow id="alg3.l8.m1.1.1.3" xref="alg3.l8.m1.1.1.3.cmml"><mi id="alg3.l8.m1.1.1.3.2" xref="alg3.l8.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l8.m1.1.1.3.1" xref="alg3.l8.m1.1.1.3.1.cmml">​</mo><mi id="alg3.l8.m1.1.1.3.3" xref="alg3.l8.m1.1.1.3.3.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l8.m1.1b"><apply id="alg3.l8.m1.1.1.cmml" xref="alg3.l8.m1.1.1"><lt id="alg3.l8.m1.1.1.1.cmml" xref="alg3.l8.m1.1.1.1"></lt><apply id="alg3.l8.m1.1.1.2.cmml" xref="alg3.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l8.m1.1.1.2.1.cmml" xref="alg3.l8.m1.1.1.2">subscript</csymbol><ci id="alg3.l8.m1.1.1.2.2.cmml" xref="alg3.l8.m1.1.1.2.2">𝑣</ci><ci id="alg3.l8.m1.1.1.2.3a.cmml" xref="alg3.l8.m1.1.1.2.3"><mtext mathsize="70%" id="alg3.l8.m1.1.1.2.3.cmml" xref="alg3.l8.m1.1.1.2.3">tokens</mtext></ci></apply><apply id="alg3.l8.m1.1.1.3.cmml" xref="alg3.l8.m1.1.1.3"><times id="alg3.l8.m1.1.1.3.1.cmml" xref="alg3.l8.m1.1.1.3.1"></times><ci id="alg3.l8.m1.1.1.3.2.cmml" xref="alg3.l8.m1.1.1.3.2">𝑠</ci><ci id="alg3.l8.m1.1.1.3.3.cmml" xref="alg3.l8.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l8.m1.1c">v_{\text{tokens}}&lt;sn</annotation></semantics></math> <span id="alg3.l8.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg3.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math id="alg3.l9.m1.1" class="ltx_Math" alttext="j=\operatorname*{arg\,min}_{i\in v_{\text{tokens}}}{n_{e}}_{i}" display="inline"><semantics id="alg3.l9.m1.1a"><mrow id="alg3.l9.m1.1.1" xref="alg3.l9.m1.1.1.cmml"><mi id="alg3.l9.m1.1.1.2" xref="alg3.l9.m1.1.1.2.cmml">j</mi><mo id="alg3.l9.m1.1.1.1" xref="alg3.l9.m1.1.1.1.cmml">=</mo><mrow id="alg3.l9.m1.1.1.3" xref="alg3.l9.m1.1.1.3.cmml"><msub id="alg3.l9.m1.1.1.3.1" xref="alg3.l9.m1.1.1.3.1.cmml"><mrow id="alg3.l9.m1.1.1.3.1.2" xref="alg3.l9.m1.1.1.3.1.2.cmml"><mi id="alg3.l9.m1.1.1.3.1.2.2" xref="alg3.l9.m1.1.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="alg3.l9.m1.1.1.3.1.2.1" xref="alg3.l9.m1.1.1.3.1.2.1.cmml">​</mo><mi id="alg3.l9.m1.1.1.3.1.2.3" xref="alg3.l9.m1.1.1.3.1.2.3.cmml">min</mi></mrow><mrow id="alg3.l9.m1.1.1.3.1.3" xref="alg3.l9.m1.1.1.3.1.3.cmml"><mi id="alg3.l9.m1.1.1.3.1.3.2" xref="alg3.l9.m1.1.1.3.1.3.2.cmml">i</mi><mo id="alg3.l9.m1.1.1.3.1.3.1" xref="alg3.l9.m1.1.1.3.1.3.1.cmml">∈</mo><msub id="alg3.l9.m1.1.1.3.1.3.3" xref="alg3.l9.m1.1.1.3.1.3.3.cmml"><mi id="alg3.l9.m1.1.1.3.1.3.3.2" xref="alg3.l9.m1.1.1.3.1.3.3.2.cmml">v</mi><mtext id="alg3.l9.m1.1.1.3.1.3.3.3" xref="alg3.l9.m1.1.1.3.1.3.3.3a.cmml">tokens</mtext></msub></mrow></msub><mo id="alg3.l9.m1.1.1.3a" xref="alg3.l9.m1.1.1.3.cmml">⁡</mo><mmultiscripts id="alg3.l9.m1.1.1.3.2" xref="alg3.l9.m1.1.1.3.2.cmml"><mi id="alg3.l9.m1.1.1.3.2.2.2" xref="alg3.l9.m1.1.1.3.2.2.2.cmml">n</mi><mi id="alg3.l9.m1.1.1.3.2.2.3" xref="alg3.l9.m1.1.1.3.2.2.3.cmml">e</mi><mrow id="alg3.l9.m1.1.1.3.2a" xref="alg3.l9.m1.1.1.3.2.cmml"></mrow><mi id="alg3.l9.m1.1.1.3.2.3" xref="alg3.l9.m1.1.1.3.2.3.cmml">i</mi><mrow id="alg3.l9.m1.1.1.3.2b" xref="alg3.l9.m1.1.1.3.2.cmml"></mrow></mmultiscripts></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l9.m1.1b"><apply id="alg3.l9.m1.1.1.cmml" xref="alg3.l9.m1.1.1"><eq id="alg3.l9.m1.1.1.1.cmml" xref="alg3.l9.m1.1.1.1"></eq><ci id="alg3.l9.m1.1.1.2.cmml" xref="alg3.l9.m1.1.1.2">𝑗</ci><apply id="alg3.l9.m1.1.1.3.cmml" xref="alg3.l9.m1.1.1.3"><apply id="alg3.l9.m1.1.1.3.1.cmml" xref="alg3.l9.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg3.l9.m1.1.1.3.1.1.cmml" xref="alg3.l9.m1.1.1.3.1">subscript</csymbol><apply id="alg3.l9.m1.1.1.3.1.2.cmml" xref="alg3.l9.m1.1.1.3.1.2"><times id="alg3.l9.m1.1.1.3.1.2.1.cmml" xref="alg3.l9.m1.1.1.3.1.2.1"></times><ci id="alg3.l9.m1.1.1.3.1.2.2.cmml" xref="alg3.l9.m1.1.1.3.1.2.2">arg</ci><ci id="alg3.l9.m1.1.1.3.1.2.3.cmml" xref="alg3.l9.m1.1.1.3.1.2.3">min</ci></apply><apply id="alg3.l9.m1.1.1.3.1.3.cmml" xref="alg3.l9.m1.1.1.3.1.3"><in id="alg3.l9.m1.1.1.3.1.3.1.cmml" xref="alg3.l9.m1.1.1.3.1.3.1"></in><ci id="alg3.l9.m1.1.1.3.1.3.2.cmml" xref="alg3.l9.m1.1.1.3.1.3.2">𝑖</ci><apply id="alg3.l9.m1.1.1.3.1.3.3.cmml" xref="alg3.l9.m1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="alg3.l9.m1.1.1.3.1.3.3.1.cmml" xref="alg3.l9.m1.1.1.3.1.3.3">subscript</csymbol><ci id="alg3.l9.m1.1.1.3.1.3.3.2.cmml" xref="alg3.l9.m1.1.1.3.1.3.3.2">𝑣</ci><ci id="alg3.l9.m1.1.1.3.1.3.3.3a.cmml" xref="alg3.l9.m1.1.1.3.1.3.3.3"><mtext mathsize="50%" id="alg3.l9.m1.1.1.3.1.3.3.3.cmml" xref="alg3.l9.m1.1.1.3.1.3.3.3">tokens</mtext></ci></apply></apply></apply><apply id="alg3.l9.m1.1.1.3.2.cmml" xref="alg3.l9.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l9.m1.1.1.3.2.1.cmml" xref="alg3.l9.m1.1.1.3.2">subscript</csymbol><apply id="alg3.l9.m1.1.1.3.2.2.cmml" xref="alg3.l9.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l9.m1.1.1.3.2.2.1.cmml" xref="alg3.l9.m1.1.1.3.2">subscript</csymbol><ci id="alg3.l9.m1.1.1.3.2.2.2.cmml" xref="alg3.l9.m1.1.1.3.2.2.2">𝑛</ci><ci id="alg3.l9.m1.1.1.3.2.2.3.cmml" xref="alg3.l9.m1.1.1.3.2.2.3">𝑒</ci></apply><ci id="alg3.l9.m1.1.1.3.2.3.cmml" xref="alg3.l9.m1.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.m1.1c">j=\operatorname*{arg\,min}_{i\in v_{\text{tokens}}}{n_{e}}_{i}</annotation></semantics></math>

</div>
<div id="alg3.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <math id="alg3.l10.m1.1" class="ltx_Math" alttext="{n_{e}}_{j}" display="inline"><semantics id="alg3.l10.m1.1a"><mmultiscripts id="alg3.l10.m1.1.1" xref="alg3.l10.m1.1.1.cmml"><mi id="alg3.l10.m1.1.1.2.2" xref="alg3.l10.m1.1.1.2.2.cmml">n</mi><mi id="alg3.l10.m1.1.1.2.3" xref="alg3.l10.m1.1.1.2.3.cmml">e</mi><mrow id="alg3.l10.m1.1.1a" xref="alg3.l10.m1.1.1.cmml"></mrow><mi id="alg3.l10.m1.1.1.3" xref="alg3.l10.m1.1.1.3.cmml">j</mi><mrow id="alg3.l10.m1.1.1b" xref="alg3.l10.m1.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="alg3.l10.m1.1b"><apply id="alg3.l10.m1.1.1.cmml" xref="alg3.l10.m1.1.1"><csymbol cd="ambiguous" id="alg3.l10.m1.1.1.1.cmml" xref="alg3.l10.m1.1.1">subscript</csymbol><apply id="alg3.l10.m1.1.1.2.cmml" xref="alg3.l10.m1.1.1"><csymbol cd="ambiguous" id="alg3.l10.m1.1.1.2.1.cmml" xref="alg3.l10.m1.1.1">subscript</csymbol><ci id="alg3.l10.m1.1.1.2.2.cmml" xref="alg3.l10.m1.1.1.2.2">𝑛</ci><ci id="alg3.l10.m1.1.1.2.3.cmml" xref="alg3.l10.m1.1.1.2.3">𝑒</ci></apply><ci id="alg3.l10.m1.1.1.3.cmml" xref="alg3.l10.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.m1.1c">{n_{e}}_{j}</annotation></semantics></math> <math id="alg3.l10.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg3.l10.m2.1a"><mo stretchy="false" id="alg3.l10.m2.1.1" xref="alg3.l10.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg3.l10.m2.1b"><ci id="alg3.l10.m2.1.1.cmml" xref="alg3.l10.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.m2.1c">\leftarrow</annotation></semantics></math> <math id="alg3.l10.m3.1" class="ltx_Math" alttext="{n_{e}}_{j}-m_{\text{impact}}" display="inline"><semantics id="alg3.l10.m3.1a"><mrow id="alg3.l10.m3.1.1" xref="alg3.l10.m3.1.1.cmml"><mmultiscripts id="alg3.l10.m3.1.1.2" xref="alg3.l10.m3.1.1.2.cmml"><mi id="alg3.l10.m3.1.1.2.2.2" xref="alg3.l10.m3.1.1.2.2.2.cmml">n</mi><mi id="alg3.l10.m3.1.1.2.2.3" xref="alg3.l10.m3.1.1.2.2.3.cmml">e</mi><mrow id="alg3.l10.m3.1.1.2a" xref="alg3.l10.m3.1.1.2.cmml"></mrow><mi id="alg3.l10.m3.1.1.2.3" xref="alg3.l10.m3.1.1.2.3.cmml">j</mi><mrow id="alg3.l10.m3.1.1.2b" xref="alg3.l10.m3.1.1.2.cmml"></mrow></mmultiscripts><mo id="alg3.l10.m3.1.1.1" xref="alg3.l10.m3.1.1.1.cmml">−</mo><msub id="alg3.l10.m3.1.1.3" xref="alg3.l10.m3.1.1.3.cmml"><mi id="alg3.l10.m3.1.1.3.2" xref="alg3.l10.m3.1.1.3.2.cmml">m</mi><mtext id="alg3.l10.m3.1.1.3.3" xref="alg3.l10.m3.1.1.3.3a.cmml">impact</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="alg3.l10.m3.1b"><apply id="alg3.l10.m3.1.1.cmml" xref="alg3.l10.m3.1.1"><minus id="alg3.l10.m3.1.1.1.cmml" xref="alg3.l10.m3.1.1.1"></minus><apply id="alg3.l10.m3.1.1.2.cmml" xref="alg3.l10.m3.1.1.2"><csymbol cd="ambiguous" id="alg3.l10.m3.1.1.2.1.cmml" xref="alg3.l10.m3.1.1.2">subscript</csymbol><apply id="alg3.l10.m3.1.1.2.2.cmml" xref="alg3.l10.m3.1.1.2"><csymbol cd="ambiguous" id="alg3.l10.m3.1.1.2.2.1.cmml" xref="alg3.l10.m3.1.1.2">subscript</csymbol><ci id="alg3.l10.m3.1.1.2.2.2.cmml" xref="alg3.l10.m3.1.1.2.2.2">𝑛</ci><ci id="alg3.l10.m3.1.1.2.2.3.cmml" xref="alg3.l10.m3.1.1.2.2.3">𝑒</ci></apply><ci id="alg3.l10.m3.1.1.2.3.cmml" xref="alg3.l10.m3.1.1.2.3">𝑗</ci></apply><apply id="alg3.l10.m3.1.1.3.cmml" xref="alg3.l10.m3.1.1.3"><csymbol cd="ambiguous" id="alg3.l10.m3.1.1.3.1.cmml" xref="alg3.l10.m3.1.1.3">subscript</csymbol><ci id="alg3.l10.m3.1.1.3.2.cmml" xref="alg3.l10.m3.1.1.3.2">𝑚</ci><ci id="alg3.l10.m3.1.1.3.3a.cmml" xref="alg3.l10.m3.1.1.3.3"><mtext mathsize="70%" id="alg3.l10.m3.1.1.3.3.cmml" xref="alg3.l10.m3.1.1.3.3">impact</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.m3.1c">{n_{e}}_{j}-m_{\text{impact}}</annotation></semantics></math>

</div>
<div id="alg3.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <math id="alg3.l11.m1.1" class="ltx_Math" alttext="v_{\text{tokens}}" display="inline"><semantics id="alg3.l11.m1.1a"><msub id="alg3.l11.m1.1.1" xref="alg3.l11.m1.1.1.cmml"><mi id="alg3.l11.m1.1.1.2" xref="alg3.l11.m1.1.1.2.cmml">v</mi><mtext id="alg3.l11.m1.1.1.3" xref="alg3.l11.m1.1.1.3a.cmml">tokens</mtext></msub><annotation-xml encoding="MathML-Content" id="alg3.l11.m1.1b"><apply id="alg3.l11.m1.1.1.cmml" xref="alg3.l11.m1.1.1"><csymbol cd="ambiguous" id="alg3.l11.m1.1.1.1.cmml" xref="alg3.l11.m1.1.1">subscript</csymbol><ci id="alg3.l11.m1.1.1.2.cmml" xref="alg3.l11.m1.1.1.2">𝑣</ci><ci id="alg3.l11.m1.1.1.3a.cmml" xref="alg3.l11.m1.1.1.3"><mtext mathsize="70%" id="alg3.l11.m1.1.1.3.cmml" xref="alg3.l11.m1.1.1.3">tokens</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m1.1c">v_{\text{tokens}}</annotation></semantics></math> append <math id="alg3.l11.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg3.l11.m2.1a"><mi id="alg3.l11.m2.1.1" xref="alg3.l11.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg3.l11.m2.1b"><ci id="alg3.l11.m2.1.1.cmml" xref="alg3.l11.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m2.1c">j</annotation></semantics></math>

</div>
<div id="alg3.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>  <span id="alg3.l12.1" class="ltx_text ltx_font_bold">end</span> <span id="alg3.l12.2" class="ltx_text ltx_font_bold">while</span>
</div>
</div>
</figure>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Token Bag-of-Words Recovery</h2>

<div id="A3.p1" class="ltx_para ltx_noindent">
<p id="A3.p1.1" class="ltx_p">Even without any malicious parameter modifications, an attacker can immediately retrieve the bag-of-words (the unordered list of all tokens and their assorted frequencies) of the user data from the gradient of the token embedding. <cite class="ltx_cite ltx_citemacro_citet">Melis et al. (<a href="#bib.bib39" title="" class="ltx_ref">2019</a>)</cite> previously identified that unique tokens can be recovered due to the sparsity of rows in the token embedding gradient, as visualized in the left plot of <a href="#S3.F5" title="In Getting a Bag-of-Words Containing All Tokens ‣ 3.1 Extracting User Data ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a>. But, perhaps surprisingly, we find that even the frequency of all words can be extracted. Depending on the model architecture, this frequency estimation can either be triggered by analyzing either the bias gradient of the decoding (last linear) layer, or the norm of the embedding matrix. In both cases, the magnitude of the update of each row of a random embedding matrix is proportional to the frequency of word usage, allowing for a greedy estimation by adapting the strategy of <cite class="ltx_cite ltx_citemacro_citet">Wainakh et al. (<a href="#bib.bib54" title="" class="ltx_ref">2021</a>)</cite> which was originally proposed to extract label information in classification tasks.</p>
</div>
<div id="A3.p2" class="ltx_para ltx_noindent">
<p id="A3.p2.2" class="ltx_p">For models which contain a decoder bias parameter, this estimation directly leads to a <math id="A3.p2.1.m1.1" class="ltx_Math" alttext="&gt;99\%" display="inline"><semantics id="A3.p2.1.m1.1a"><mrow id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml"><mi id="A3.p2.1.m1.1.1.2" xref="A3.p2.1.m1.1.1.2.cmml"></mi><mo id="A3.p2.1.m1.1.1.1" xref="A3.p2.1.m1.1.1.1.cmml">&gt;</mo><mrow id="A3.p2.1.m1.1.1.3" xref="A3.p2.1.m1.1.1.3.cmml"><mn id="A3.p2.1.m1.1.1.3.2" xref="A3.p2.1.m1.1.1.3.2.cmml">99</mn><mo id="A3.p2.1.m1.1.1.3.1" xref="A3.p2.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><apply id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1"><gt id="A3.p2.1.m1.1.1.1.cmml" xref="A3.p2.1.m1.1.1.1"></gt><csymbol cd="latexml" id="A3.p2.1.m1.1.1.2.cmml" xref="A3.p2.1.m1.1.1.2">absent</csymbol><apply id="A3.p2.1.m1.1.1.3.cmml" xref="A3.p2.1.m1.1.1.3"><csymbol cd="latexml" id="A3.p2.1.m1.1.1.3.1.cmml" xref="A3.p2.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="A3.p2.1.m1.1.1.3.2.cmml" xref="A3.p2.1.m1.1.1.3.2">99</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">&gt;99\%</annotation></semantics></math> accurate estimate of word frequencies. For models without decoder bias, such as GPT <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib47" title="" class="ltx_ref">2019</a>)</cite>, the same strategy can again be employed based on the magnitude of embedding rows. We can further accurately predict token frequency even for models which tie their embedding and decoding weights, and as such do not feature naturally sparse embedding gradients. However, examining the distributions of embedding row norms in log-space for tokens contained in the other updates and all tokens, as visualized in the right plot of <a href="#S3.F5" title="In Getting a Bag-of-Words Containing All Tokens ‣ 3.1 Extracting User Data ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a>, we find that unused tokens can be removed by a simple thresholding. The resulting token frequency estimation is inexact due to the cut-off, but still reaches a bag-of-words accuracy of <math id="A3.p2.2.m2.1" class="ltx_Math" alttext="93.1\%" display="inline"><semantics id="A3.p2.2.m2.1a"><mrow id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml"><mn id="A3.p2.2.m2.1.1.2" xref="A3.p2.2.m2.1.1.2.cmml">93.1</mn><mo id="A3.p2.2.m2.1.1.1" xref="A3.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><apply id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1"><csymbol cd="latexml" id="A3.p2.2.m2.1.1.1.cmml" xref="A3.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="A3.p2.2.m2.1.1.2.cmml" xref="A3.p2.2.m2.1.1.2">93.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">93.1\%</annotation></semantics></math> accuracy for GPT-2, even for an update containing 13824 tokens.</p>
</div>
<div id="A3.p3" class="ltx_para ltx_noindent">
<p id="A3.p3.1" class="ltx_p">This first insight already appears to have been overlooked in optimization-based attacks <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a href="#bib.bib12" title="" class="ltx_ref">2021</a>; Dimitrov et al., <a href="#bib.bib16" title="" class="ltx_ref">2022</a>)</cite> and does not require any malicious modifications of the embedding sent by the server. However, for a model update averaged over multiple users and thousands of tokens, this recovery alone is less of a threat to privacy. Naively, the ways to order recovered tokens scale as <math id="A3.p3.1.m1.1" class="ltx_Math" alttext="n!" display="inline"><semantics id="A3.p3.1.m1.1a"><mrow id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml"><mi id="A3.p3.1.m1.1.1.2" xref="A3.p3.1.m1.1.1.2.cmml">n</mi><mo id="A3.p3.1.m1.1.1.1" xref="A3.p3.1.m1.1.1.1.cmml">!</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><apply id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1"><factorial id="A3.p3.1.m1.1.1.1.cmml" xref="A3.p3.1.m1.1.1.1"></factorial><ci id="A3.p3.1.m1.1.1.2.cmml" xref="A3.p3.1.m1.1.1.2">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">n!</annotation></semantics></math>, and any given ordering of a large amount of tokens may not reveal sensitive information about any constituent user involved in the model update.</p>
</div>
<figure id="A3.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/assets/embedding_inversion.png" id="A3.F10.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="269" height="103" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x9.png" id="A3.F10.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="152" height="100" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span><span id="A3.F10.5.1" class="ltx_text ltx_font_bold">Left:</span> A high-level schematic of a simple case of token leaking. The token embedding layer can leak tokens and frequency solely through its sparse gradient entries. <span id="A3.F10.6.2" class="ltx_text ltx_font_bold">Right:</span> Distribution and Histogram of log of norms of all token embedding gradients for GPT-2 for <math id="A3.F10.2.m1.1" class="ltx_Math" alttext="13824" display="inline"><semantics id="A3.F10.2.m1.1b"><mn id="A3.F10.2.m1.1.1" xref="A3.F10.2.m1.1.1.cmml">13824</mn><annotation-xml encoding="MathML-Content" id="A3.F10.2.m1.1c"><cn type="integer" id="A3.F10.2.m1.1.1.cmml" xref="A3.F10.2.m1.1.1">13824</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.F10.2.m1.1d">13824</annotation></semantics></math> tokens. In this case, gradient entries are non-sparse due to the tied encoder-decoder structure of GPT, but the embeddings of true user data (red) are clearly separable from the mass of all embeddings (blue) by a simple cutoff at 1.5 standard deviations (marked in black).</figcaption>
</figure>
<figure id="A3.F11" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x10.png" id="A3.F11.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="122" height="80" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x11.png" id="A3.F11.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="122" height="80" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Bag-of-words Accuracy for from embedding gradients out of 13824 tokens from <span id="A3.F11.14.1" class="ltx_text ltx_font_italic">wikitext</span>. <span id="A3.F11.15.2" class="ltx_text ltx_font_bold">Left:</span> The small transformer model where tokens frequency can be estimated directly from the decoder bias. Token frequency estimation is <math id="A3.F11.6.m1.1" class="ltx_Math" alttext="96.7\%" display="inline"><semantics id="A3.F11.6.m1.1b"><mrow id="A3.F11.6.m1.1.1" xref="A3.F11.6.m1.1.1.cmml"><mn id="A3.F11.6.m1.1.1.2" xref="A3.F11.6.m1.1.1.2.cmml">96.7</mn><mo id="A3.F11.6.m1.1.1.1" xref="A3.F11.6.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.F11.6.m1.1c"><apply id="A3.F11.6.m1.1.1.cmml" xref="A3.F11.6.m1.1.1"><csymbol cd="latexml" id="A3.F11.6.m1.1.1.1.cmml" xref="A3.F11.6.m1.1.1.1">percent</csymbol><cn type="float" id="A3.F11.6.m1.1.1.2.cmml" xref="A3.F11.6.m1.1.1.2">96.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F11.6.m1.1d">96.7\%</annotation></semantics></math> accurate, unique token recovery are <math id="A3.F11.7.m2.1" class="ltx_Math" alttext="99.8\%" display="inline"><semantics id="A3.F11.7.m2.1b"><mrow id="A3.F11.7.m2.1.1" xref="A3.F11.7.m2.1.1.cmml"><mn id="A3.F11.7.m2.1.1.2" xref="A3.F11.7.m2.1.1.2.cmml">99.8</mn><mo id="A3.F11.7.m2.1.1.1" xref="A3.F11.7.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.F11.7.m2.1c"><apply id="A3.F11.7.m2.1.1.cmml" xref="A3.F11.7.m2.1.1"><csymbol cd="latexml" id="A3.F11.7.m2.1.1.1.cmml" xref="A3.F11.7.m2.1.1.1">percent</csymbol><cn type="float" id="A3.F11.7.m2.1.1.2.cmml" xref="A3.F11.7.m2.1.1.2">99.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F11.7.m2.1d">99.8\%</annotation></semantics></math> accurate. <span id="A3.F11.16.3" class="ltx_text ltx_font_bold">Right:</span> The (small) GPT-2 variant where tokens are estimated from the norms of the embedding rows. Token frequency estimation is <math id="A3.F11.8.m3.1" class="ltx_Math" alttext="93.1\%" display="inline"><semantics id="A3.F11.8.m3.1b"><mrow id="A3.F11.8.m3.1.1" xref="A3.F11.8.m3.1.1.cmml"><mn id="A3.F11.8.m3.1.1.2" xref="A3.F11.8.m3.1.1.2.cmml">93.1</mn><mo id="A3.F11.8.m3.1.1.1" xref="A3.F11.8.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.F11.8.m3.1c"><apply id="A3.F11.8.m3.1.1.cmml" xref="A3.F11.8.m3.1.1"><csymbol cd="latexml" id="A3.F11.8.m3.1.1.1.cmml" xref="A3.F11.8.m3.1.1.1">percent</csymbol><cn type="float" id="A3.F11.8.m3.1.1.2.cmml" xref="A3.F11.8.m3.1.1.2">93.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F11.8.m3.1d">93.1\%</annotation></semantics></math> accurate, unique tokens are <math id="A3.F11.9.m4.1" class="ltx_Math" alttext="97.1\%" display="inline"><semantics id="A3.F11.9.m4.1b"><mrow id="A3.F11.9.m4.1.1" xref="A3.F11.9.m4.1.1.cmml"><mn id="A3.F11.9.m4.1.1.2" xref="A3.F11.9.m4.1.1.2.cmml">97.1</mn><mo id="A3.F11.9.m4.1.1.1" xref="A3.F11.9.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.F11.9.m4.1c"><apply id="A3.F11.9.m4.1.1.cmml" xref="A3.F11.9.m4.1.1"><csymbol cd="latexml" id="A3.F11.9.m4.1.1.1.cmml" xref="A3.F11.9.m4.1.1.1">percent</csymbol><cn type="float" id="A3.F11.9.m4.1.1.2.cmml" xref="A3.F11.9.m4.1.1.2">97.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F11.9.m4.1d">97.1\%</annotation></semantics></math> accurate due to the cutoff at <math id="A3.F11.10.m5.1" class="ltx_Math" alttext="\frac{3\sigma}{2}" display="inline"><semantics id="A3.F11.10.m5.1b"><mfrac id="A3.F11.10.m5.1.1" xref="A3.F11.10.m5.1.1.cmml"><mrow id="A3.F11.10.m5.1.1.2" xref="A3.F11.10.m5.1.1.2.cmml"><mn id="A3.F11.10.m5.1.1.2.2" xref="A3.F11.10.m5.1.1.2.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="A3.F11.10.m5.1.1.2.1" xref="A3.F11.10.m5.1.1.2.1.cmml">​</mo><mi id="A3.F11.10.m5.1.1.2.3" xref="A3.F11.10.m5.1.1.2.3.cmml">σ</mi></mrow><mn id="A3.F11.10.m5.1.1.3" xref="A3.F11.10.m5.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="A3.F11.10.m5.1c"><apply id="A3.F11.10.m5.1.1.cmml" xref="A3.F11.10.m5.1.1"><divide id="A3.F11.10.m5.1.1.1.cmml" xref="A3.F11.10.m5.1.1"></divide><apply id="A3.F11.10.m5.1.1.2.cmml" xref="A3.F11.10.m5.1.1.2"><times id="A3.F11.10.m5.1.1.2.1.cmml" xref="A3.F11.10.m5.1.1.2.1"></times><cn type="integer" id="A3.F11.10.m5.1.1.2.2.cmml" xref="A3.F11.10.m5.1.1.2.2">3</cn><ci id="A3.F11.10.m5.1.1.2.3.cmml" xref="A3.F11.10.m5.1.1.2.3">𝜎</ci></apply><cn type="integer" id="A3.F11.10.m5.1.1.3.cmml" xref="A3.F11.10.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.F11.10.m5.1d">\frac{3\sigma}{2}</annotation></semantics></math>.</figcaption>
</figure>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Measurement Normalization</h2>

<div id="A4.p1" class="ltx_para ltx_noindent">
<p id="A4.p1.1" class="ltx_p">In order to retrieve positionally encoded features from the first linear layer in the feed-forward part of each Transformer block, we create “bins" which partition the possible outcomes of taking the scalar product of an embedding with a random Gaussian vector. To do this, we estimate the mean and variance of such a measurement, and create bins according to partitions of equal mass for a Gaussian with this mean and variance. A natural question arises: how well can we estimate this quantity? If the server does not have much data from the user distribution, will this present a problem for recovering user data? To this end, we demonstrate that the server can estimate these measurement quantities well using a surrogate corpus of data. In <a href="#A4.F12" title="In Appendix D Measurement Normalization ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">12</span></a>, we see that the Gaussian fit using the Wikitext dataset is strikingly similar to the one the server would have found, even on a very different dataset (Shakespeare).
We further note that an ambitious server could also directly use model updates retrieved from users in a first round of federated learning, to directly glean the distribution of these linear layers, given that the lowest bin records the average of all activations of this layer. However, given the ubiquity of public text data, this step appears almost unnecessary - but possibly relevant in specialized text domains or when using Transformers for other data modalities such as tabular data <cite class="ltx_cite ltx_citemacro_citep">(Somepalli et al., <a href="#bib.bib50" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="A4.p2" class="ltx_para ltx_noindent">
<p id="A4.p2.1" class="ltx_p">However, for language data, these quantities can also simply be estimated using a small number of batches (100) filled with random token ids. We show in <a href="#A4.F13" title="In Appendix D Measurement Normalization ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">13</span></a> that this leads to essentially the same performance in average total accuracy and to only minor differences in peak accuracy.</p>
</div>
<figure id="A4.F12" class="ltx_figure"><img src="/html/2201.12675/assets/assets/estimated_measurement.png" id="A4.F12.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="411" height="274" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Comparison of Gaussian fit to the measurements of Shakespeare dataset, and a Gaussian fit to the measurements (against the same vector) for the Wikitext dataset.</figcaption>
</figure>
<figure id="A4.F13" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x12.png" id="A4.F13.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="138" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x13.png" id="A4.F13.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="138" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span><span id="A4.F13.4.1" class="ltx_text ltx_font_bold">Using random data to estimate the measurement distribution</span>. <span id="A4.F13.5.2" class="ltx_text ltx_font_bold">Left:</span> Total accuracy (i.e. percentage of tokens recovered correctly in their correct position) for GPT-2 and varying batch sizes with sequence length 32. <span id="A4.F13.6.3" class="ltx_text ltx_font_bold">Right:</span> Average token accuracy on the most-leaked sentence. Random tokens can be an effective substitute for public data to estimate the measurement mean and standard deviation.</figcaption>
</figure>
<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Random token vulnerability</h3>

<div id="A4.SS1.p1" class="ltx_para ltx_noindent">
<p id="A4.SS1.p1.1" class="ltx_p">Note that in Figure <a href="#S4.F8" title="Figure 8 ‣ 4 Empirical Evaluation of the Attack ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, we see that sequences generated randomly from the vocabulary are more vulnerable than other datasets. This is because randomly generated sequences on average result in fewer collisions as all possible tokens from the vocabulary are used with equal probability. Zipf’s law for the distribution of words in English lends credence to this interpretation. More common words, and associated positions for that matter, will result in more collisions and degrade the attacker’s ability to reconstruct sequences.</p>
</div>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Variants and Details</h2>

<section id="A5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.1 </span>Masked Language Modelling</h3>

<div id="A5.SS1.p1" class="ltx_para ltx_noindent">
<p id="A5.SS1.p1.1" class="ltx_p">For problems with masked language modelling, the loss is sparse over the sequence length, as only masked tokens compute loss. This impacts the strategy proposed in Sec 3.2, as with disabled attention mechanisms in all but the first layer, no gradient information flows to unmasked entries in the sequence. However, this can be quickly solved by reactivating the last attention layer, so that it equally attends to all elements in the sequence with a minor weight increment which we set to <math id="A5.SS1.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="A5.SS1.p1.1.m1.1a"><mn id="A5.SS1.p1.1.m1.1.1" xref="A5.SS1.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="A5.SS1.p1.1.m1.1b"><cn type="integer" id="A5.SS1.p1.1.m1.1.1.cmml" xref="A5.SS1.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.SS1.p1.1.m1.1c">10</annotation></semantics></math>. This way, gradient flow is re-enabled and all computations can proceed as designed. For BERT, we further disable the default <span id="A5.SS1.p1.1.1" class="ltx_text ltx_font_typewriter">huggingface</span> initialiazation of the token embedding, which we reset to a random normal initialization.</p>
</div>
<div id="A5.SS1.p2" class="ltx_para ltx_noindent">
<p id="A5.SS1.p2.1" class="ltx_p">Masked language modelling further inhibits the decoder bias strategy discussed in Sec 3.1, as only masked tokens lead to a non-positive decoder bias gradient. However, we can proceed for masked language models by recovering tokens from the embedding layer as discussed for models without decoder bias. The mask tokens extracted from the bias can later be used to fill masked positions in the input.</p>
</div>
</section>
<section id="A5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.2 </span>GELU</h3>

<div id="A5.SS2.p1" class="ltx_para ltx_noindent">
<p id="A5.SS2.p1.1" class="ltx_p">A minor stumbling for the attacker occurs if the pre-defined model uses GELU <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks &amp; Gimpel, <a href="#bib.bib25" title="" class="ltx_ref">2016</a>)</cite> activation instead of ReLU. This is because GELU does not threshold activations in the same was as ReLU, and transmits gradient signal when the activation <math id="A5.SS2.p1.1.m1.1" class="ltx_Math" alttext="&lt;0" display="inline"><semantics id="A5.SS2.p1.1.m1.1a"><mrow id="A5.SS2.p1.1.m1.1.1" xref="A5.SS2.p1.1.m1.1.1.cmml"><mi id="A5.SS2.p1.1.m1.1.1.2" xref="A5.SS2.p1.1.m1.1.1.2.cmml"></mi><mo id="A5.SS2.p1.1.m1.1.1.1" xref="A5.SS2.p1.1.m1.1.1.1.cmml">&lt;</mo><mn id="A5.SS2.p1.1.m1.1.1.3" xref="A5.SS2.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.1.m1.1b"><apply id="A5.SS2.p1.1.m1.1.1.cmml" xref="A5.SS2.p1.1.m1.1.1"><lt id="A5.SS2.p1.1.m1.1.1.1.cmml" xref="A5.SS2.p1.1.m1.1.1.1"></lt><csymbol cd="latexml" id="A5.SS2.p1.1.m1.1.1.2.cmml" xref="A5.SS2.p1.1.m1.1.1.2">absent</csymbol><cn type="integer" id="A5.SS2.p1.1.m1.1.1.3.cmml" xref="A5.SS2.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.1.m1.1c">&lt;0</annotation></semantics></math>. However, a simple workaround for the attacker is to increase the size of the measurement vector and, by doing so, push activations away from 0, and thus more toward standard ReLU behavior. For the main-body experiments, we use ReLU activation for simplicity of presentation, but using the workaround described above, we find in <a href="#A5.F14" title="In E.2 GELU ‣ Appendix E Variants and Details ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">14</span></a>, <a href="#A5.F15" title="In E.2 GELU ‣ Appendix E Variants and Details ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">15</span></a> that the performance of the attack against a GELU network is comparable to its level against a ReLU network.</p>
</div>
<figure id="A5.F14" class="ltx_figure"><img src="/html/2201.12675/assets/assets/gelu_relu_seq_len_128.png" id="A5.F14.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="494" height="144" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>Comparison of GELU and ReLU activation with magnified measurement vector (sequence length <math id="A5.F14.2.m1.1" class="ltx_Math" alttext="256" display="inline"><semantics id="A5.F14.2.m1.1b"><mn id="A5.F14.2.m1.1.1" xref="A5.F14.2.m1.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="A5.F14.2.m1.1c"><cn type="integer" id="A5.F14.2.m1.1.1.cmml" xref="A5.F14.2.m1.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.F14.2.m1.1d">256</annotation></semantics></math>).</figcaption>
</figure>
<figure id="A5.F15" class="ltx_figure"><img src="/html/2201.12675/assets/assets/gelu_relu_bs_1.png" id="A5.F15.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="494" height="144" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Comparison of GELU and ReLU activation with magnified measurement vector (batch size <math id="A5.F15.2.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A5.F15.2.m1.1b"><mn id="A5.F15.2.m1.1.1" xref="A5.F15.2.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A5.F15.2.m1.1c"><cn type="integer" id="A5.F15.2.m1.1.1.cmml" xref="A5.F15.2.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.F15.2.m1.1d">1</annotation></semantics></math>).</figcaption>
</figure>
<figure id="A5.F16" class="ltx_figure"><img src="/html/2201.12675/assets/assets/decepticon_bs_1_y_0_1.png" id="A5.F16.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="466" height="136" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>Baseline results for our method for different popular architectures and metrics for variable length sequence input (batch size <math id="A5.F16.3.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A5.F16.3.m1.1b"><mn id="A5.F16.3.m1.1.1" xref="A5.F16.3.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A5.F16.3.m1.1c"><cn type="integer" id="A5.F16.3.m1.1.1.cmml" xref="A5.F16.3.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.F16.3.m1.1d">1</annotation></semantics></math>). Note BERT’s positional encoding caps out at sequence length <math id="A5.F16.4.m2.1" class="ltx_Math" alttext="512" display="inline"><semantics id="A5.F16.4.m2.1b"><mn id="A5.F16.4.m2.1.1" xref="A5.F16.4.m2.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A5.F16.4.m2.1c"><cn type="integer" id="A5.F16.4.m2.1.1.cmml" xref="A5.F16.4.m2.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.F16.4.m2.1d">512</annotation></semantics></math>, so we end our experiments for BERT there.</figcaption>
</figure>
<figure id="A5.F17" class="ltx_figure"><img src="/html/2201.12675/assets/assets/decepticon_seq_len_32_y_0_1.png" id="A5.F17.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="466" height="136" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>Results for our method for different popular architectures and metrics for variable length batch size (sequence length <math id="A5.F17.2.m1.1" class="ltx_Math" alttext="32" display="inline"><semantics id="A5.F17.2.m1.1b"><mn id="A5.F17.2.m1.1.1" xref="A5.F17.2.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A5.F17.2.m1.1c"><cn type="integer" id="A5.F17.2.m1.1.1.cmml" xref="A5.F17.2.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A5.F17.2.m1.1d">32</annotation></semantics></math>).</figcaption>
</figure>
</section>
<section id="A5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.3 </span>Dropout</h3>

<div id="A5.SS3.p1" class="ltx_para ltx_noindent">
<p id="A5.SS3.p1.2" class="ltx_p">All experiments in the main body, including comparisons, have assumed that dropout has been turned off for all models under consideration. In standard applications, dropout can be modified from the server-side, even for compiled and otherwise fixed models <cite class="ltx_cite ltx_citemacro_citep">(ONNX, <a href="#bib.bib42" title="" class="ltx_ref">2022</a>)</cite>. In our threat model, dropout hence falls into the category of a server-side parameter that a malicious update could turn off.
We also investigated the performance of the attack if the attacker cannot alter standard dropout parameters, finding that dropout decreased total accuracy of the attack by about 10%, e.g. from <math id="A5.SS3.p1.1.m1.1" class="ltx_Math" alttext="93.36\%" display="inline"><semantics id="A5.SS3.p1.1.m1.1a"><mrow id="A5.SS3.p1.1.m1.1.1" xref="A5.SS3.p1.1.m1.1.1.cmml"><mn id="A5.SS3.p1.1.m1.1.1.2" xref="A5.SS3.p1.1.m1.1.1.2.cmml">93.36</mn><mo id="A5.SS3.p1.1.m1.1.1.1" xref="A5.SS3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.1.m1.1b"><apply id="A5.SS3.p1.1.m1.1.1.cmml" xref="A5.SS3.p1.1.m1.1.1"><csymbol cd="latexml" id="A5.SS3.p1.1.m1.1.1.1.cmml" xref="A5.SS3.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="A5.SS3.p1.1.m1.1.1.2.cmml" xref="A5.SS3.p1.1.m1.1.1.2">93.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.1.m1.1c">93.36\%</annotation></semantics></math> for a sequence of length 512 on GPT-2 to <math id="A5.SS3.p1.2.m2.1" class="ltx_Math" alttext="81.25\%" display="inline"><semantics id="A5.SS3.p1.2.m2.1a"><mrow id="A5.SS3.p1.2.m2.1.1" xref="A5.SS3.p1.2.m2.1.1.cmml"><mn id="A5.SS3.p1.2.m2.1.1.2" xref="A5.SS3.p1.2.m2.1.1.2.cmml">81.25</mn><mo id="A5.SS3.p1.2.m2.1.1.1" xref="A5.SS3.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.2.m2.1b"><apply id="A5.SS3.p1.2.m2.1.1.cmml" xref="A5.SS3.p1.2.m2.1.1"><csymbol cd="latexml" id="A5.SS3.p1.2.m2.1.1.1.cmml" xref="A5.SS3.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="A5.SS3.p1.2.m2.1.1.2.cmml" xref="A5.SS3.p1.2.m2.1.1.2">81.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.2.m2.1c">81.25\%</annotation></semantics></math> with dropout.</p>
</div>
</section>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Additional Background Material</h2>

<div id="A6.p1" class="ltx_para ltx_noindent">
<p id="A6.p1.2" class="ltx_p">The attack TAG in <cite class="ltx_cite ltx_citemacro_citet">Deng et al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite> approaches gradient inversion attacks against transformer models from the direct optimization-based angle. This was first suggested in <cite class="ltx_cite ltx_citemacro_citet">Zhu et al. (<a href="#bib.bib60" title="" class="ltx_ref">2019</a>)</cite>, who provide some preliminary experiments on recovery of short sequences from BERT. Basically, the attack works to recover user data <math id="A6.p1.1.m1.2" class="ltx_Math" alttext="(x^{*},y^{*})" display="inline"><semantics id="A6.p1.1.m1.2a"><mrow id="A6.p1.1.m1.2.2.2" xref="A6.p1.1.m1.2.2.3.cmml"><mo stretchy="false" id="A6.p1.1.m1.2.2.2.3" xref="A6.p1.1.m1.2.2.3.cmml">(</mo><msup id="A6.p1.1.m1.1.1.1.1" xref="A6.p1.1.m1.1.1.1.1.cmml"><mi id="A6.p1.1.m1.1.1.1.1.2" xref="A6.p1.1.m1.1.1.1.1.2.cmml">x</mi><mo id="A6.p1.1.m1.1.1.1.1.3" xref="A6.p1.1.m1.1.1.1.1.3.cmml">∗</mo></msup><mo id="A6.p1.1.m1.2.2.2.4" xref="A6.p1.1.m1.2.2.3.cmml">,</mo><msup id="A6.p1.1.m1.2.2.2.2" xref="A6.p1.1.m1.2.2.2.2.cmml"><mi id="A6.p1.1.m1.2.2.2.2.2" xref="A6.p1.1.m1.2.2.2.2.2.cmml">y</mi><mo id="A6.p1.1.m1.2.2.2.2.3" xref="A6.p1.1.m1.2.2.2.2.3.cmml">∗</mo></msup><mo stretchy="false" id="A6.p1.1.m1.2.2.2.5" xref="A6.p1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.1.m1.2b"><interval closure="open" id="A6.p1.1.m1.2.2.3.cmml" xref="A6.p1.1.m1.2.2.2"><apply id="A6.p1.1.m1.1.1.1.1.cmml" xref="A6.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A6.p1.1.m1.1.1.1.1.1.cmml" xref="A6.p1.1.m1.1.1.1.1">superscript</csymbol><ci id="A6.p1.1.m1.1.1.1.1.2.cmml" xref="A6.p1.1.m1.1.1.1.1.2">𝑥</ci><times id="A6.p1.1.m1.1.1.1.1.3.cmml" xref="A6.p1.1.m1.1.1.1.1.3"></times></apply><apply id="A6.p1.1.m1.2.2.2.2.cmml" xref="A6.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A6.p1.1.m1.2.2.2.2.1.cmml" xref="A6.p1.1.m1.2.2.2.2">superscript</csymbol><ci id="A6.p1.1.m1.2.2.2.2.2.cmml" xref="A6.p1.1.m1.2.2.2.2.2">𝑦</ci><times id="A6.p1.1.m1.2.2.2.2.3.cmml" xref="A6.p1.1.m1.2.2.2.2.3"></times></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.1.m1.2c">(x^{*},y^{*})</annotation></semantics></math> from the measurement of the gradient on this data <math id="A6.p1.2.m2.1" class="ltx_Math" alttext="g" display="inline"><semantics id="A6.p1.2.m2.1a"><mi id="A6.p1.2.m2.1.1" xref="A6.p1.2.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A6.p1.2.m2.1b"><ci id="A6.p1.2.m2.1.1.cmml" xref="A6.p1.2.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.2.m2.1c">g</annotation></semantics></math> by solving the optimization problem of</p>
<table id="A6.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A6.E4.m1.6" class="ltx_Math" alttext="\min_{x,y}||\mathcal{L}(n(x,\theta),y)-g||^{2}," display="block"><semantics id="A6.E4.m1.6a"><mrow id="A6.E4.m1.6.6.1" xref="A6.E4.m1.6.6.1.1.cmml"><mrow id="A6.E4.m1.6.6.1.1" xref="A6.E4.m1.6.6.1.1.cmml"><munder id="A6.E4.m1.6.6.1.1.3" xref="A6.E4.m1.6.6.1.1.3.cmml"><mi id="A6.E4.m1.6.6.1.1.3.2" xref="A6.E4.m1.6.6.1.1.3.2.cmml">min</mi><mrow id="A6.E4.m1.2.2.2.4" xref="A6.E4.m1.2.2.2.3.cmml"><mi id="A6.E4.m1.1.1.1.1" xref="A6.E4.m1.1.1.1.1.cmml">x</mi><mo id="A6.E4.m1.2.2.2.4.1" xref="A6.E4.m1.2.2.2.3.cmml">,</mo><mi id="A6.E4.m1.2.2.2.2" xref="A6.E4.m1.2.2.2.2.cmml">y</mi></mrow></munder><mo lspace="0em" rspace="0em" id="A6.E4.m1.6.6.1.1.2" xref="A6.E4.m1.6.6.1.1.2.cmml">​</mo><msup id="A6.E4.m1.6.6.1.1.1" xref="A6.E4.m1.6.6.1.1.1.cmml"><mrow id="A6.E4.m1.6.6.1.1.1.1.1" xref="A6.E4.m1.6.6.1.1.1.1.2.cmml"><mo stretchy="false" id="A6.E4.m1.6.6.1.1.1.1.1.2" xref="A6.E4.m1.6.6.1.1.1.1.2.1.cmml">‖</mo><mrow id="A6.E4.m1.6.6.1.1.1.1.1.1" xref="A6.E4.m1.6.6.1.1.1.1.1.1.cmml"><mrow id="A6.E4.m1.6.6.1.1.1.1.1.1.1" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.E4.m1.6.6.1.1.1.1.1.1.1.3" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="A6.E4.m1.6.6.1.1.1.1.1.1.1.2" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="A6.E4.m1.3.3" xref="A6.E4.m1.3.3.cmml">x</mi><mo id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="A6.E4.m1.4.4" xref="A6.E4.m1.4.4.cmml">θ</mi><mo stretchy="false" id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="A6.E4.m1.5.5" xref="A6.E4.m1.5.5.cmml">y</mi><mo stretchy="false" id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.4" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A6.E4.m1.6.6.1.1.1.1.1.1.2" xref="A6.E4.m1.6.6.1.1.1.1.1.1.2.cmml">−</mo><mi id="A6.E4.m1.6.6.1.1.1.1.1.1.3" xref="A6.E4.m1.6.6.1.1.1.1.1.1.3.cmml">g</mi></mrow><mo stretchy="false" id="A6.E4.m1.6.6.1.1.1.1.1.3" xref="A6.E4.m1.6.6.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A6.E4.m1.6.6.1.1.1.3" xref="A6.E4.m1.6.6.1.1.1.3.cmml">2</mn></msup></mrow><mo id="A6.E4.m1.6.6.1.2" xref="A6.E4.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.E4.m1.6b"><apply id="A6.E4.m1.6.6.1.1.cmml" xref="A6.E4.m1.6.6.1"><times id="A6.E4.m1.6.6.1.1.2.cmml" xref="A6.E4.m1.6.6.1.1.2"></times><apply id="A6.E4.m1.6.6.1.1.3.cmml" xref="A6.E4.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="A6.E4.m1.6.6.1.1.3.1.cmml" xref="A6.E4.m1.6.6.1.1.3">subscript</csymbol><min id="A6.E4.m1.6.6.1.1.3.2.cmml" xref="A6.E4.m1.6.6.1.1.3.2"></min><list id="A6.E4.m1.2.2.2.3.cmml" xref="A6.E4.m1.2.2.2.4"><ci id="A6.E4.m1.1.1.1.1.cmml" xref="A6.E4.m1.1.1.1.1">𝑥</ci><ci id="A6.E4.m1.2.2.2.2.cmml" xref="A6.E4.m1.2.2.2.2">𝑦</ci></list></apply><apply id="A6.E4.m1.6.6.1.1.1.cmml" xref="A6.E4.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="A6.E4.m1.6.6.1.1.1.2.cmml" xref="A6.E4.m1.6.6.1.1.1">superscript</csymbol><apply id="A6.E4.m1.6.6.1.1.1.1.2.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1"><csymbol cd="latexml" id="A6.E4.m1.6.6.1.1.1.1.2.1.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.2">norm</csymbol><apply id="A6.E4.m1.6.6.1.1.1.1.1.1.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.1"><minus id="A6.E4.m1.6.6.1.1.1.1.1.1.2.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.1.2"></minus><apply id="A6.E4.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1"><times id="A6.E4.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.2"></times><ci id="A6.E4.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.3">ℒ</ci><interval closure="open" id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1"><apply id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1"><times id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.2">𝑛</ci><interval closure="open" id="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="A6.E4.m1.3.3.cmml" xref="A6.E4.m1.3.3">𝑥</ci><ci id="A6.E4.m1.4.4.cmml" xref="A6.E4.m1.4.4">𝜃</ci></interval></apply><ci id="A6.E4.m1.5.5.cmml" xref="A6.E4.m1.5.5">𝑦</ci></interval></apply><ci id="A6.E4.m1.6.6.1.1.1.1.1.1.3.cmml" xref="A6.E4.m1.6.6.1.1.1.1.1.1.3">𝑔</ci></apply></apply><cn type="integer" id="A6.E4.m1.6.6.1.1.1.3.cmml" xref="A6.E4.m1.6.6.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E4.m1.6c">\min_{x,y}||\mathcal{L}(n(x,\theta),y)-g||^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="A6.p1.8" class="ltx_p">where <math id="A6.p1.3.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A6.p1.3.m1.1a"><mi id="A6.p1.3.m1.1.1" xref="A6.p1.3.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A6.p1.3.m1.1b"><ci id="A6.p1.3.m1.1.1.cmml" xref="A6.p1.3.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.3.m1.1c">x</annotation></semantics></math> and <math id="A6.p1.4.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="A6.p1.4.m2.1a"><mi id="A6.p1.4.m2.1.1" xref="A6.p1.4.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A6.p1.4.m2.1b"><ci id="A6.p1.4.m2.1.1.cmml" xref="A6.p1.4.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.4.m2.1c">y</annotation></semantics></math> are the inputs and labels to be recovered, <math id="A6.p1.5.m3.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="A6.p1.5.m3.1a"><mi class="ltx_font_mathcaligraphic" id="A6.p1.5.m3.1.1" xref="A6.p1.5.m3.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="A6.p1.5.m3.1b"><ci id="A6.p1.5.m3.1.1.cmml" xref="A6.p1.5.m3.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.5.m3.1c">\mathcal{L}</annotation></semantics></math> is the loss and <math id="A6.p1.6.m4.2" class="ltx_Math" alttext="n(\cdot,\theta)" display="inline"><semantics id="A6.p1.6.m4.2a"><mrow id="A6.p1.6.m4.2.3" xref="A6.p1.6.m4.2.3.cmml"><mi id="A6.p1.6.m4.2.3.2" xref="A6.p1.6.m4.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="A6.p1.6.m4.2.3.1" xref="A6.p1.6.m4.2.3.1.cmml">​</mo><mrow id="A6.p1.6.m4.2.3.3.2" xref="A6.p1.6.m4.2.3.3.1.cmml"><mo stretchy="false" id="A6.p1.6.m4.2.3.3.2.1" xref="A6.p1.6.m4.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="A6.p1.6.m4.1.1" xref="A6.p1.6.m4.1.1.cmml">⋅</mo><mo id="A6.p1.6.m4.2.3.3.2.2" xref="A6.p1.6.m4.2.3.3.1.cmml">,</mo><mi id="A6.p1.6.m4.2.2" xref="A6.p1.6.m4.2.2.cmml">θ</mi><mo stretchy="false" id="A6.p1.6.m4.2.3.3.2.3" xref="A6.p1.6.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.6.m4.2b"><apply id="A6.p1.6.m4.2.3.cmml" xref="A6.p1.6.m4.2.3"><times id="A6.p1.6.m4.2.3.1.cmml" xref="A6.p1.6.m4.2.3.1"></times><ci id="A6.p1.6.m4.2.3.2.cmml" xref="A6.p1.6.m4.2.3.2">𝑛</ci><interval closure="open" id="A6.p1.6.m4.2.3.3.1.cmml" xref="A6.p1.6.m4.2.3.3.2"><ci id="A6.p1.6.m4.1.1.cmml" xref="A6.p1.6.m4.1.1">⋅</ci><ci id="A6.p1.6.m4.2.2.cmml" xref="A6.p1.6.m4.2.2">𝜃</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.6.m4.2c">n(\cdot,\theta)</annotation></semantics></math> is the language model with parameters <math id="A6.p1.7.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A6.p1.7.m5.1a"><mi id="A6.p1.7.m5.1.1" xref="A6.p1.7.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A6.p1.7.m5.1b"><ci id="A6.p1.7.m5.1.1.cmml" xref="A6.p1.7.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.7.m5.1c">\theta</annotation></semantics></math>. This optimization approach does succeed for short sequences, but the optimization becomes quickly stuck in local minima and cannot recover the original input data. <cite class="ltx_cite ltx_citemacro_citet">Zhu et al. (<a href="#bib.bib60" title="" class="ltx_ref">2019</a>)</cite> originally propose the usage of an L-BFGS solver to optimize this problem, but this optimizer can often get stuck in local minima. <cite class="ltx_cite ltx_citemacro_citet">Deng et al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite> instead utilize the "BERT" Adam optimizer with hyperparameters as in BERT training <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite>. They further improve the objective by adding an additional term that especially penalizes gradients of the first layers, which we also implement when running their attack. A major problem for the attacks of <cite class="ltx_cite ltx_citemacro_citet">Zhu et al. (<a href="#bib.bib60" title="" class="ltx_ref">2019</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Deng et al. (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite>, however, is the large label space for next-word prediction. In comparison to binary classification tasks as mainly investigated in <cite class="ltx_cite ltx_citemacro_citet">Deng et al. (<a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite>, the large label space leads to significant uncertainty in the optimization of labels <math id="A6.p1.8.m6.1" class="ltx_Math" alttext="y" display="inline"><semantics id="A6.p1.8.m6.1a"><mi id="A6.p1.8.m6.1.1" xref="A6.p1.8.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="A6.p1.8.m6.1b"><ci id="A6.p1.8.m6.1.1.cmml" xref="A6.p1.8.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.8.m6.1c">y</annotation></semantics></math>, which leads their attack to reduce in performance as vocabulary size increases.</p>
</div>
<div id="A6.p2" class="ltx_para ltx_noindent">
<p id="A6.p2.1" class="ltx_p">We further note that <cite class="ltx_cite ltx_citemacro_citet">Boenisch et al. (<a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite> also propose malicious model modifications (as opposed to our more realistic malicious parameter modifications) to breach privacy in FL for text, however the proposed model in their work is a toy two-layer fully connected model that is not a Transformer-based model. In fact, the strategy employed in their attack cannot be deployed against modern language models that do not construct a linear layer of the length of the sequence, aside from handling of facets of modern language models like positional encodings, or attention mechanisms.</p>
</div>
</section>
<section id="A7" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Mitigation Strategies</h2>

<div id="A7.p1" class="ltx_para ltx_noindent">
<p id="A7.p1.3" class="ltx_p">As stated in the main body, a central message of our paper is that aggregation alone may not be sufficient to defend against malicious parameter attacks in FL. Further defenses may be needed. Such defenses could include parameter inspection wherein a defender could look for identifiable signatures in the shared parameter vector. For example, the given attack duplicates a measurement vector, leading to low rank linear layers. To the best of our knowledge, there do not exist systematic parameter inspection based defenses to malicious models in FL. The attacker could, however, easily adapt to some obvious parameter inspection defenses. For example, simply adding a small amount of noise to the measurement vector, and other conspicuous parts of the attack, does not affect the success of the attack significantly, but does immediately make a strategy like rank inspection null and void. We confirm this adaptation by adding a small amount of Gaussian noise to each row of the measurement vector in the linear layers (for the Transformer-3 model, <math id="A7.p1.1.m1.1" class="ltx_Math" alttext="8" display="inline"><semantics id="A7.p1.1.m1.1a"><mn id="A7.p1.1.m1.1.1" xref="A7.p1.1.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="A7.p1.1.m1.1b"><cn type="integer" id="A7.p1.1.m1.1.1.cmml" xref="A7.p1.1.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.1.m1.1c">8</annotation></semantics></math> users, <math id="A7.p1.2.m2.1" class="ltx_Math" alttext="32" display="inline"><semantics id="A7.p1.2.m2.1a"><mn id="A7.p1.2.m2.1.1" xref="A7.p1.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A7.p1.2.m2.1b"><cn type="integer" id="A7.p1.2.m2.1.1.cmml" xref="A7.p1.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.2.m2.1c">32</annotation></semantics></math> sequence length) and find that numerically, these layers do indeed become full rank, and the success of the attack remains largely unchanged (accuracy <math id="A7.p1.3.m3.1" class="ltx_Math" alttext="90.62\%" display="inline"><semantics id="A7.p1.3.m3.1a"><mrow id="A7.p1.3.m3.1.1" xref="A7.p1.3.m3.1.1.cmml"><mn id="A7.p1.3.m3.1.1.2" xref="A7.p1.3.m3.1.1.2.cmml">90.62</mn><mo id="A7.p1.3.m3.1.1.1" xref="A7.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.3.m3.1b"><apply id="A7.p1.3.m3.1.1.cmml" xref="A7.p1.3.m3.1.1"><csymbol cd="latexml" id="A7.p1.3.m3.1.1.1.cmml" xref="A7.p1.3.m3.1.1.1">percent</csymbol><cn type="float" id="A7.p1.3.m3.1.1.2.cmml" xref="A7.p1.3.m3.1.1.2">90.62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.3.m3.1c">90.62\%</annotation></semantics></math>). Because such simple adaptations are easily made, we do not recommend this line of defense.</p>
</div>
<div id="A7.p2" class="ltx_para ltx_noindent">
<p id="A7.p2.1" class="ltx_p">Instead, we advocate for strong differential privacy on the user side. Such measures could include gradient clipping/noising (c.f. .</p>
</div>
<div id="A7.p3" class="ltx_para ltx_noindent">
<p id="A7.p3.1" class="ltx_p">The immediate impact of differential privacy mechanisms on the attack described in this work is that the measured weight and bias become noisy, so that the estimation in <a href="#S3.E3" title="In Unmixing Gradient Signals: ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">3</span></a> becomes subsequently noisy. However, an attacker can counteract this simply by noticing that the number of jumps in the cumulative sum is sparse, i.e only number-of-tokens many jumps exist, independent from the number of bins. As such, as long as the number of tokens is smaller than the number of bins, the attacker can denoise this measurement, for example using tools from sparse signal recovery such orthogonal matching pursuit <cite class="ltx_cite ltx_citemacro_citep">(Mallat &amp; Zhang, <a href="#bib.bib35" title="" class="ltx_ref">1993</a>)</cite>. We use the implementation via K-SVD from <cite class="ltx_cite ltx_citemacro_citet">Rubinstein et al. (<a href="#bib.bib49" title="" class="ltx_ref">2008</a>)</cite> to do so. This way, the attacker reduces the immediate effect of gradient noise, utilizing the redundancy of the measurements of the cumulative sum of embeddings in every bin. Overall, with the above strategy, we find the attack can still succeed in the presence of gradient clipping and noising, although the success does predictably degrade at higher noise levels. (see Figure <a href="#A7.F18" title="Figure 18 ‣ Mitigations through local loss audits ‣ Appendix G Mitigation Strategies ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">18</span></a>).</p>
</div>
<div id="A7.p4" class="ltx_para ltx_noindent">
<p id="A7.p4.1" class="ltx_p">Furthermore, the imprint strategy, as found in <cite class="ltx_cite ltx_citemacro_citet">Fowl et al. (<a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>, has been shown to be robust to certain amounts of gradient noise, and an attacker could further attempt to implement strategies found in that attack to resist this defense.</p>
</div>
<section id="A7.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Mitigations through local loss audits</h5>

<div id="A7.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="A7.SS0.SSS0.Px1.p1.1" class="ltx_p">Moreover, federated learning often takes place in the background, for example, at night when the device is charging (see <cite class="ltx_cite ltx_citemacro_citet">Hard et al. (<a href="#bib.bib23" title="" class="ltx_ref">2019</a>)</cite>) and can be a regular occurrence on participating devices. Even if user applications were modified to make loss values on local data observable to the user, a user could not know whether a model was malicious, or whether a new model was simply in an early round of its training run. As such, auditing and exposition of local model loss values to the user is not a strong defense against the proposed attack.</p>
</div>
<figure id="A7.F18" class="ltx_figure"><img src="/html/2201.12675/assets/assets/dp_plot.png" id="A7.F18.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="274" height="183" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 18: </span>Attack success rate against different levels of added Laplacian noise. In each experiment, the gradient was also clipped to a value of <math id="A7.F18.3.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="A7.F18.3.m1.1b"><mn id="A7.F18.3.m1.1.1" xref="A7.F18.3.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="A7.F18.3.m1.1c"><cn type="integer" id="A7.F18.3.m1.1.1.cmml" xref="A7.F18.3.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="A7.F18.3.m1.1d">1</annotation></semantics></math>. We see that the attack can remain successful even in the presence of added noise. In this experiment, a single sequence of length <math id="A7.F18.4.m2.1" class="ltx_Math" alttext="32" display="inline"><semantics id="A7.F18.4.m2.1b"><mn id="A7.F18.4.m2.1.1" xref="A7.F18.4.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A7.F18.4.m2.1c"><cn type="integer" id="A7.F18.4.m2.1.1.cmml" xref="A7.F18.4.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A7.F18.4.m2.1d">32</annotation></semantics></math> was considered.</figcaption>
</figure>
</section>
</section>
<section id="A8" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix H </span>Further Results</h2>

<figure id="A8.F19" class="ltx_figure"><img src="/html/2201.12675/assets/assets/decepticon_seq_len_512_y_0_1.png" id="A8.F19.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="160" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 19: </span>Baseline results for our method for different popular architectures and metrics for variable batch size (sequence length <math id="A8.F19.2.m1.1" class="ltx_Math" alttext="512" display="inline"><semantics id="A8.F19.2.m1.1b"><mn id="A8.F19.2.m1.1.1" xref="A8.F19.2.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="A8.F19.2.m1.1c"><cn type="integer" id="A8.F19.2.m1.1.1.cmml" xref="A8.F19.2.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="A8.F19.2.m1.1d">512</annotation></semantics></math>).</figcaption>
</figure>
<figure id="A8.F20" class="ltx_figure"><img src="/html/2201.12675/assets/assets/tag_vs_us_large_batch.png" id="A8.F20.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="160" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 20: </span>Comparison to TAG attack for variable batch size (sequence length <math id="A8.F20.2.m1.1" class="ltx_Math" alttext="32" display="inline"><semantics id="A8.F20.2.m1.1b"><mn id="A8.F20.2.m1.1.1" xref="A8.F20.2.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="A8.F20.2.m1.1c"><cn type="integer" id="A8.F20.2.m1.1.1.cmml" xref="A8.F20.2.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="A8.F20.2.m1.1d">32</annotation></semantics></math>).</figcaption>
</figure>
<div id="A8.p1" class="ltx_para ltx_noindent">
<p id="A8.p1.2" class="ltx_p">In Figure <a href="#S3.F3" title="Figure 3 ‣ Unmixing Gradient Signals: ‣ 3 Malicious Parameters for Data Extraction ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we illustrate the embedding recovery process that we adapt from <cite class="ltx_cite ltx_citemacro_citet">Fowl et al. (<a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>. We opt to initialize the rows of the first linear layer in each Transformer block to a randomly sampled Gaussian vector (all rows being the same vector). Then, following the calculation of <cite class="ltx_cite ltx_citemacro_citet">Fowl et al. (<a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>, when an incoming embedding vector, for example, corresponding to the word "pepper", is propagated through this layer, the ascending biases threshold values of the inner product between the Gaussian vector, <math id="A8.p1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="A8.p1.1.m1.1a"><mi id="A8.p1.1.m1.1.1" xref="A8.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A8.p1.1.m1.1b"><ci id="A8.p1.1.m1.1.1.cmml" xref="A8.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A8.p1.1.m1.1c">m</annotation></semantics></math>, and the embedding vector, <math id="A8.p1.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A8.p1.2.m2.1a"><mi id="A8.p1.2.m2.1.1" xref="A8.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A8.p1.2.m2.1b"><ci id="A8.p1.2.m2.1.1.cmml" xref="A8.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A8.p1.2.m2.1c">x</annotation></semantics></math>. Because of the ReLU activation, this means that individual embedding vectors can be directly encoded into gradient entries for rows of this linear layer.</p>
</div>
<section id="A8.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">H.1 </span>Sensitivity to threshold in token estimation</h3>

<div id="A8.SS1.p1" class="ltx_para ltx_noindent">
<p id="A8.SS1.p1.1" class="ltx_p">We include an evaluation of the threshold parameter for the embedding-norm token estimation in <a href="#A8.F21" title="In H.1 Sensitivity to threshold in token estimation ‣ Appendix H Further Results ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">21</span></a>. This value is set to 1.5 standard deviations in all other experiments.</p>
</div>
<figure id="A8.F21" class="ltx_figure"><img src="/html/2201.12675/assets/x14.png" id="A8.F21.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="211" height="141" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 21: </span><span id="A8.F21.2.1" class="ltx_text ltx_font_bold">Sensitivity to token estimation threshold.</span> Total accuracy (i.e. percentage of tokens recovered correctly in their correct position) for GPT-2 and varying batch sizes with sequence length 32. We evaluate the threshold parameter for the token estimation. The default value in the remainder of all experiments is 1.5, although we find the estimation to be robust to a range of similar cutoffs.</figcaption>
</figure>
</section>
<section id="A8.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">H.2 </span>Total Amount of Token Leaked</h3>

<div id="A8.SS2.p1" class="ltx_para ltx_noindent">
<p id="A8.SS2.p1.1" class="ltx_p">Finally, in <a href="#A8.F22" title="In H.2 Total Amount of Token Leaked ‣ Appendix H Further Results ‣ Decepticons:​ Corrupted ​ Transformers Breach Privacy in Federated Learning for Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">22</span></a> we include the total amount of tokens leaked correctly through the attack for a variety of sequence lengths, batch sizes and models. We see that the total amount of tokens leaked with GPT-2 has not yet reached a peak, and larger sequences could leak more tokens. For the smaller 3-layer transformer we see that the number of leaked tokens peaks around a batch size of 128 for a sequence length of 32, and 8 for a sequence length of 512, i.e. around 4096 tokens. This is related to the number of bins in this architecture, which in turn is given by the width of all linear layers, leading to a bin size of <math id="A8.SS2.p1.1.m1.1" class="ltx_Math" alttext="4608" display="inline"><semantics id="A8.SS2.p1.1.m1.1a"><mn id="A8.SS2.p1.1.m1.1.1" xref="A8.SS2.p1.1.m1.1.1.cmml">4608</mn><annotation-xml encoding="MathML-Content" id="A8.SS2.p1.1.m1.1b"><cn type="integer" id="A8.SS2.p1.1.m1.1.1.cmml" xref="A8.SS2.p1.1.m1.1.1">4608</cn></annotation-xml><annotation encoding="application/x-tex" id="A8.SS2.p1.1.m1.1c">4608</annotation></semantics></math> for the 3-layer transformer. For the small GPT-2 the number of bins is 36864.</p>
</div>
<figure id="A8.F22" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x15.png" id="A8.F22.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="138" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x16.png" id="A8.F22.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="138" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x17.png" id="A8.F22.g3" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="138" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2201.12675/assets/x18.png" id="A8.F22.g4" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="138" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 22: </span><span id="A8.F22.2.1" class="ltx_text ltx_font_bold">Total number of tokens leaked in their exact location for various settings (instead of percentages as shown elsewhere).</span> Top row: Total number of token for GPT-2 (left) and the 3-layer transformer (right) for a sequence length of 32 and various batch sizes. Bottom row: total number of token for GPT-2 (left) and the 3-layer transformer (right) for a sequence length of 512 and various batch sizes.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2201.12674" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2201.12675" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2201.12675">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2201.12675" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2201.12676" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Feb 26 18:50:33 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
