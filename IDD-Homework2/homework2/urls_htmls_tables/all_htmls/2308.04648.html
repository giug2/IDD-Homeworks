<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2308.04648] Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning</title><meta property="og:description" content="Homomorphic encryption (HE) has found extensive utilization in federated learning (FL) systems, capitalizing on its dual advantages: (i) ensuring the confidentiality of shared models contributed by participating entiti…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2308.04648">

<!--Generated on Wed Feb 28 13:15:27 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Dongfang Zhao
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_italic">University of Washington
<br class="ltx_break"></span>dzhao@uw.edu
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">Homomorphic encryption (HE) has found extensive utilization in federated learning (FL) systems, capitalizing on its dual advantages: (i) ensuring the confidentiality of shared models contributed by participating entities, and (ii) enabling algebraic operations directly on ciphertexts representing encrypted models. Particularly, the approximate fully homomorphic encryption (FHE) scheme, known as CKKS, has emerged as the de facto encryption scheme, notably supporting decimal numbers. While recent research predominantly focuses on enhancing CKKS’s encryption rate and evaluation speed in the context of FL, the search operation has been relatively disregarded due to the tendency of some applications to discard intermediate encrypted models. Yet, emerging studies emphasize the importance of managing and searching intermediate models for specific applications like large-scale scientific computing, necessitating robust data provenance and auditing support. To address this, our paper introduces an innovative approach that efficiently searches for a target encrypted value, incurring only a logarithmic number of network interactions. The proposed method capitalizes on CKKS’s additive and multiplicative properties on encrypted models, propagating equality comparisons between values through a balanced binary tree structure to ultimately reach a single aggregate. A comprehensive analysis of the proposed algorithm underscores its potential to significantly broaden FL’s applicability and impact.</p>
</div>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Introduction</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Homomorphic encryption (HE) has been widely employed in federated learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(Aharoni et al. <a href="#bib.bib1" title="" class="ltx_ref">2023</a>)</cite>, offering a groundbreaking solution to the critical challenge of preserving data privacy while enabling collaborative machine learning. By allowing computations to be performed on encrypted data without the need for decryption, HE maintains the confidentiality of individual data contributions throughout the federated learning process. This cryptographic technique has gained prominence due to its ability to facilitate the secure aggregation of model updates from decentralized devices or servers, thereby ensuring that sensitive information remains protected. As federated learning continues to emerge as a powerful paradigm for training machine learning models across distributed environments, the integration of HE not only safeguards the privacy of participants but also paves the way for efficient and privacy-preserving collaborative AI advancements.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">Due to the nature of Federated Learning (FL) applications, the data types primarily consist of decimal values. This prevalence of decimal data is a result of the diverse range of domains that utilize FL, spanning areas such as healthcare, finance, and IoT. The use of decimal values is often driven by the need to capture and process nuanced information with high precision, as is the case with medical measurements, financial transactions, and sensor readings. In FL, where machine learning models are collaboratively trained across decentralized devices or servers while keeping data localized, the representation of decimal values becomes essential for maintaining the integrity and accuracy of the information being shared. Consequently, addressing the challenges and intricacies associated with handling decimal data within the FL framework becomes a crucial endeavor, influencing the design of secure and efficient protocols for privacy-preserving federated learning.</p>
</div>
<div id="Sx1.p3" class="ltx_para">
<p id="Sx1.p3.1" class="ltx_p">Because CKKS <cite class="ltx_cite ltx_citemacro_citep">(Cheon et al. <a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite> (Cheon-Kim-Kim-Song) remains the only Homomorphic Encryption (HE) scheme supporting decimal values, recent research efforts have been concentrated on optimizing CKKS for various applications. Specifically, these endeavors revolve around enhancing two pivotal aspects: the encryption of model updates and the aggregation of local models. CKKS’s unique capability to operate on real numbers directly makes it a vital candidate for preserving the precision and accuracy required by decimal-based datasets, commonly encountered in domains like finance, scientific computing, and cryptography. As a result, refining the encryption techniques for model updates ensures that the privacy of sensitive data is upheld during collaborative training in Federated Learning (FL). Additionally, focusing on the aggregation of local models under the constraints of CKKS aims to guarantee efficient and accurate fusion of contributions from various devices or servers in the FL paradigm. This concerted research in CKKS optimization not only advances the capabilities of HE for real-world applications but also contributes to the continued evolution of privacy-preserving technologies in the era of decentralized and collaborative computing.</p>
</div>
<div id="Sx1.p4" class="ltx_para">
<p id="Sx1.p4.1" class="ltx_p">Although encryption and evaluation operations have been extensively studied in the realm of Homomorphic Encryption (HE), there remains a notable gap in research pertaining to other equally crucial operations, particularly the search operation on CKKS ciphertexts. While much attention has been directed toward enabling computations on encrypted data, the unique challenges and intricacies associated with searching encrypted data have received relatively limited exploration. This discrepancy in focus is particularly significant considering the pivotal role that search operations play in various applications, such as scientific computing, where data provenance and auditing are of paramount importance. In fields like scientific research, where maintaining the integrity and origin of data is critical, the ability to search encrypted data in a privacy-preserving manner offers a compelling avenue for advancing security and accountability. As CKKS is a promising HE scheme known for its support of real number arithmetic and precision, exploring search operations within this framework has the potential to reshape the landscape of secure data management and utilization, leading to novel solutions that align with the demands of modern decentralized and privacy-conscious computing paradigms.</p>
</div>
<div id="Sx1.p5" class="ltx_para">
<p id="Sx1.p5.1" class="ltx_p">This paper proposes a worst-case optimal algorithm for searching in the CKKS ciphertexts.
Specifically, the proposed algorithm incurs only a logarithmic number of interactions between the client and the server.
Our algorithm does not require the expensive preprocessing, e.g., sorting, over the ciphertext on the server,
which takes <math id="Sx1.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{O}(n\log n)" display="inline"><semantics id="Sx1.p5.1.m1.1a"><mrow id="Sx1.p5.1.m1.1.1" xref="Sx1.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx1.p5.1.m1.1.1.3" xref="Sx1.p5.1.m1.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Sx1.p5.1.m1.1.1.2" xref="Sx1.p5.1.m1.1.1.2.cmml">​</mo><mrow id="Sx1.p5.1.m1.1.1.1.1" xref="Sx1.p5.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx1.p5.1.m1.1.1.1.1.2" xref="Sx1.p5.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx1.p5.1.m1.1.1.1.1.1" xref="Sx1.p5.1.m1.1.1.1.1.1.cmml"><mi id="Sx1.p5.1.m1.1.1.1.1.1.2" xref="Sx1.p5.1.m1.1.1.1.1.1.2.cmml">n</mi><mo lspace="0.167em" rspace="0em" id="Sx1.p5.1.m1.1.1.1.1.1.1" xref="Sx1.p5.1.m1.1.1.1.1.1.1.cmml">​</mo><mrow id="Sx1.p5.1.m1.1.1.1.1.1.3" xref="Sx1.p5.1.m1.1.1.1.1.1.3.cmml"><mi id="Sx1.p5.1.m1.1.1.1.1.1.3.1" xref="Sx1.p5.1.m1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="Sx1.p5.1.m1.1.1.1.1.1.3a" xref="Sx1.p5.1.m1.1.1.1.1.1.3.cmml">⁡</mo><mi id="Sx1.p5.1.m1.1.1.1.1.1.3.2" xref="Sx1.p5.1.m1.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo stretchy="false" id="Sx1.p5.1.m1.1.1.1.1.3" xref="Sx1.p5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx1.p5.1.m1.1b"><apply id="Sx1.p5.1.m1.1.1.cmml" xref="Sx1.p5.1.m1.1.1"><times id="Sx1.p5.1.m1.1.1.2.cmml" xref="Sx1.p5.1.m1.1.1.2"></times><ci id="Sx1.p5.1.m1.1.1.3.cmml" xref="Sx1.p5.1.m1.1.1.3">𝒪</ci><apply id="Sx1.p5.1.m1.1.1.1.1.1.cmml" xref="Sx1.p5.1.m1.1.1.1.1"><times id="Sx1.p5.1.m1.1.1.1.1.1.1.cmml" xref="Sx1.p5.1.m1.1.1.1.1.1.1"></times><ci id="Sx1.p5.1.m1.1.1.1.1.1.2.cmml" xref="Sx1.p5.1.m1.1.1.1.1.1.2">𝑛</ci><apply id="Sx1.p5.1.m1.1.1.1.1.1.3.cmml" xref="Sx1.p5.1.m1.1.1.1.1.1.3"><log id="Sx1.p5.1.m1.1.1.1.1.1.3.1.cmml" xref="Sx1.p5.1.m1.1.1.1.1.1.3.1"></log><ci id="Sx1.p5.1.m1.1.1.1.1.1.3.2.cmml" xref="Sx1.p5.1.m1.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p5.1.m1.1c">\mathcal{O}(n\log n)</annotation></semantics></math>;
rather, the server only applies a linear number of algebraic operations over the ciphertexts.
The key idea is to leverage the additive and multiplicative homomorphism in CKKS and construct a balanced binary tree where each intermediate node stores some compaction information in a fashion similar to a Merkle tree <cite class="ltx_cite ltx_citemacro_citep">(Merkle <a href="#bib.bib14" title="" class="ltx_ref">1988</a>)</cite>.</p>
</div>
<div id="Sx1.p6" class="ltx_para">
<p id="Sx1.p6.1" class="ltx_p">We start with some preliminaries and related work.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Preliminaries and Related Work</h2>

<section id="Sx2.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Federated Learning</h3>

<div id="Sx2.SSx1.p1" class="ltx_para">
<p id="Sx2.SSx1.p1.1" class="ltx_p">The term federated learning (FL) was initially coined in the work by McMahan et al. <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib13" title="" class="ltx_ref">2017</a>)</cite>, aiming to facilitate distributed machine learning where clients can contribute without compromising their private data. While FL has gained substantial preference over conventional machine learning approaches, there remain several areas for improvement that researchers consistently strive to address. For instance, Cui et al. <cite class="ltx_cite ltx_citemacro_citep">(Cui et al. <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite> introduced Fair and Consistent Federated Learning (FCFL), a method designed to mitigate disparities and performance inconsistencies in FL. In a similar vein, Gong et al. <cite class="ltx_cite ltx_citemacro_citep">(Gong et al. <a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite> proposed the application of ensemble cross-domain knowledge distillation to safeguard privacy within the FL framework. Hamer et al. <cite class="ltx_cite ltx_citemacro_citep">(Hamer, Mohri, and Suresh <a href="#bib.bib10" title="" class="ltx_ref">2020</a>)</cite> leveraged ensemble algorithms to alleviate communication costs in both server-to-client and client-to-server interactions in FL. Furthermore, Reisizadeh et al. <cite class="ltx_cite ltx_citemacro_citep">(Reisizadeh et al. <a href="#bib.bib16" title="" class="ltx_ref">2020</a>)</cite> presented FedPAQ, a method addressing communication and scalability challenges within the FL paradigm. As FL remains a dynamic field, these innovative approaches collectively contribute to its ongoing refinement and optimization.</p>
</div>
</section>
<section id="Sx2.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Attacks on Federated Learning</h3>

<div id="Sx2.SSx2.p1" class="ltx_para">
<p id="Sx2.SSx2.p1.1" class="ltx_p">The threat of a poisoning attack looms large as one of the primary risks in the realm of machine learning models. For instance, when adversaries or malicious clients deliberately inject compromised samples into the model’s training dataset <cite class="ltx_cite ltx_citemacro_citep">(Alfeld, Zhu, and Barford <a href="#bib.bib2" title="" class="ltx_ref">2016</a>)</cite>, this form of attack is referred to as a <span id="Sx2.SSx2.p1.1.1" class="ltx_text ltx_font_italic">data poisoning</span> attack. In parallel, a malicious client could also upload a tampered model to the aggregator, constituting a <span id="Sx2.SSx2.p1.1.2" class="ltx_text ltx_font_italic">model poisoning</span> attack (also known as an adversarial attack) <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>. This category encompasses numerous well-documented attacks, including the likes of backdoor attacks <cite class="ltx_cite ltx_citemacro_citep">(Yang et al. <a href="#bib.bib22" title="" class="ltx_ref">2019</a>; Bhagoji et al. <a href="#bib.bib4" title="" class="ltx_ref">2019</a>; Bagdasaryan et al. <a href="#bib.bib3" title="" class="ltx_ref">2020</a>; Xie et al. <a href="#bib.bib21" title="" class="ltx_ref">2020</a>)</cite>. To counteract these threats, various defense strategies have emerged within the realm of Federated Learning (FL), broadly categorized as either server-based or client-based approaches. Sun et al. <cite class="ltx_cite ltx_citemacro_citep">(Sun et al. <a href="#bib.bib19" title="" class="ltx_ref">2021</a>)</cite> introduced a client-based defense coined as White Blood Cell for Federated Learning (FL-WBC), aimed at mitigating model poisoning attacks that have infiltrated the global model. In a server-based defense, Yin et al. <cite class="ltx_cite ltx_citemacro_citep">(Yin et al. <a href="#bib.bib23" title="" class="ltx_ref">2018</a>)</cite> proposed robust aggregation to bolster FL’s resilience against model poisoning attacks, while Sun et al. <cite class="ltx_cite ltx_citemacro_citep">(Sun et al. <a href="#bib.bib20" title="" class="ltx_ref">2019</a>)</cite> employed local update clipping for similar purposes. Krum <cite class="ltx_cite ltx_citemacro_citep">(Blanchard et al. <a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite> harnessed the similarity among benign clients’ local updates to fend off poisoning attacks in FL. Additionally, Shejwalkar and Houmansadr <cite class="ltx_cite ltx_citemacro_citep">(Shejwalkar and Houmansadr <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite> devised a defense strategy named divide-and-conquer to counter FL poisoning threats effectively. These pioneering endeavors collectively contribute to the development of a fortified FL landscape, with strategies aimed at safeguarding against the ever-evolving spectrum of poisoning attacks.</p>
</div>
</section>
<section id="Sx2.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Homomorphic Encryption</h3>

<div id="Sx2.SSx3.p1" class="ltx_para">
<p id="Sx2.SSx3.p1.5" class="ltx_p">Homomorphic encryption, a groundbreaking cryptographic technique, empowers computations on encrypted data while upholding the privacy of the underlying information. An encryption function <math id="Sx2.SSx3.p1.1.m1.1" class="ltx_Math" alttext="f()" display="inline"><semantics id="Sx2.SSx3.p1.1.m1.1a"><mrow id="Sx2.SSx3.p1.1.m1.1.1" xref="Sx2.SSx3.p1.1.m1.1.1.cmml"><mi id="Sx2.SSx3.p1.1.m1.1.1.2" xref="Sx2.SSx3.p1.1.m1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx2.SSx3.p1.1.m1.1.1.1" xref="Sx2.SSx3.p1.1.m1.1.1.1.cmml">​</mo><mrow id="Sx2.SSx3.p1.1.m1.1.1.3.2" xref="Sx2.SSx3.p1.1.m1.1.1.cmml"><mo stretchy="false" id="Sx2.SSx3.p1.1.m1.1.1.3.2.1" xref="Sx2.SSx3.p1.1.m1.1.1.3.1.cmml">(</mo><mo stretchy="false" id="Sx2.SSx3.p1.1.m1.1.1.3.2.2" xref="Sx2.SSx3.p1.1.m1.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p1.1.m1.1b"><apply id="Sx2.SSx3.p1.1.m1.1.1.cmml" xref="Sx2.SSx3.p1.1.m1.1.1"><times id="Sx2.SSx3.p1.1.m1.1.1.1.cmml" xref="Sx2.SSx3.p1.1.m1.1.1.1"></times><ci id="Sx2.SSx3.p1.1.m1.1.1.2.cmml" xref="Sx2.SSx3.p1.1.m1.1.1.2">𝑓</ci><list id="Sx2.SSx3.p1.1.m1.1.1.3.1.cmml" xref="Sx2.SSx3.p1.1.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p1.1.m1.1c">f()</annotation></semantics></math> exhibits the trait of being <span id="Sx2.SSx3.p1.5.1" class="ltx_text ltx_font_italic">additive homomorphic</span> when it satisfies the equation <math id="Sx2.SSx3.p1.2.m2.3" class="ltx_Math" alttext="f^{-1}\left(f(a)\oplus f(b)\right)=a+b" display="inline"><semantics id="Sx2.SSx3.p1.2.m2.3a"><mrow id="Sx2.SSx3.p1.2.m2.3.3" xref="Sx2.SSx3.p1.2.m2.3.3.cmml"><mrow id="Sx2.SSx3.p1.2.m2.3.3.1" xref="Sx2.SSx3.p1.2.m2.3.3.1.cmml"><msup id="Sx2.SSx3.p1.2.m2.3.3.1.3" xref="Sx2.SSx3.p1.2.m2.3.3.1.3.cmml"><mi id="Sx2.SSx3.p1.2.m2.3.3.1.3.2" xref="Sx2.SSx3.p1.2.m2.3.3.1.3.2.cmml">f</mi><mrow id="Sx2.SSx3.p1.2.m2.3.3.1.3.3" xref="Sx2.SSx3.p1.2.m2.3.3.1.3.3.cmml"><mo id="Sx2.SSx3.p1.2.m2.3.3.1.3.3a" xref="Sx2.SSx3.p1.2.m2.3.3.1.3.3.cmml">−</mo><mn id="Sx2.SSx3.p1.2.m2.3.3.1.3.3.2" xref="Sx2.SSx3.p1.2.m2.3.3.1.3.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="Sx2.SSx3.p1.2.m2.3.3.1.2" xref="Sx2.SSx3.p1.2.m2.3.3.1.2.cmml">​</mo><mrow id="Sx2.SSx3.p1.2.m2.3.3.1.1.1" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.cmml"><mo id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.2" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.cmml"><mrow id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.cmml"><mi id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.2" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.1" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.1.cmml">​</mo><mrow id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.3.2" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.3.2.1" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.cmml">(</mo><mi id="Sx2.SSx3.p1.2.m2.1.1" xref="Sx2.SSx3.p1.2.m2.1.1.cmml">a</mi><mo stretchy="false" id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.3.2.2" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.1" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.1.cmml">⊕</mo><mrow id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.cmml"><mi id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.2" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.1" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.1.cmml">​</mo><mrow id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.3.2" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.cmml"><mo stretchy="false" id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.3.2.1" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.cmml">(</mo><mi id="Sx2.SSx3.p1.2.m2.2.2" xref="Sx2.SSx3.p1.2.m2.2.2.cmml">b</mi><mo stretchy="false" id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.3.2.2" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.3" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx3.p1.2.m2.3.3.2" xref="Sx2.SSx3.p1.2.m2.3.3.2.cmml">=</mo><mrow id="Sx2.SSx3.p1.2.m2.3.3.3" xref="Sx2.SSx3.p1.2.m2.3.3.3.cmml"><mi id="Sx2.SSx3.p1.2.m2.3.3.3.2" xref="Sx2.SSx3.p1.2.m2.3.3.3.2.cmml">a</mi><mo id="Sx2.SSx3.p1.2.m2.3.3.3.1" xref="Sx2.SSx3.p1.2.m2.3.3.3.1.cmml">+</mo><mi id="Sx2.SSx3.p1.2.m2.3.3.3.3" xref="Sx2.SSx3.p1.2.m2.3.3.3.3.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p1.2.m2.3b"><apply id="Sx2.SSx3.p1.2.m2.3.3.cmml" xref="Sx2.SSx3.p1.2.m2.3.3"><eq id="Sx2.SSx3.p1.2.m2.3.3.2.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.2"></eq><apply id="Sx2.SSx3.p1.2.m2.3.3.1.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1"><times id="Sx2.SSx3.p1.2.m2.3.3.1.2.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.2"></times><apply id="Sx2.SSx3.p1.2.m2.3.3.1.3.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.3"><csymbol cd="ambiguous" id="Sx2.SSx3.p1.2.m2.3.3.1.3.1.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.3">superscript</csymbol><ci id="Sx2.SSx3.p1.2.m2.3.3.1.3.2.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.3.2">𝑓</ci><apply id="Sx2.SSx3.p1.2.m2.3.3.1.3.3.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.3.3"><minus id="Sx2.SSx3.p1.2.m2.3.3.1.3.3.1.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.3.3"></minus><cn type="integer" id="Sx2.SSx3.p1.2.m2.3.3.1.3.3.2.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.3.3.2">1</cn></apply></apply><apply id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1"><csymbol cd="latexml" id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.1.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.1">direct-sum</csymbol><apply id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2"><times id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.1.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.1"></times><ci id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.2.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.2.2">𝑓</ci><ci id="Sx2.SSx3.p1.2.m2.1.1.cmml" xref="Sx2.SSx3.p1.2.m2.1.1">𝑎</ci></apply><apply id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3"><times id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.1.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.1"></times><ci id="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.2.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.1.1.1.1.3.2">𝑓</ci><ci id="Sx2.SSx3.p1.2.m2.2.2.cmml" xref="Sx2.SSx3.p1.2.m2.2.2">𝑏</ci></apply></apply></apply><apply id="Sx2.SSx3.p1.2.m2.3.3.3.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.3"><plus id="Sx2.SSx3.p1.2.m2.3.3.3.1.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.3.1"></plus><ci id="Sx2.SSx3.p1.2.m2.3.3.3.2.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.3.2">𝑎</ci><ci id="Sx2.SSx3.p1.2.m2.3.3.3.3.cmml" xref="Sx2.SSx3.p1.2.m2.3.3.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p1.2.m2.3c">f^{-1}\left(f(a)\oplus f(b)\right)=a+b</annotation></semantics></math>, with <math id="Sx2.SSx3.p1.3.m3.1" class="ltx_Math" alttext="f^{-1}()" display="inline"><semantics id="Sx2.SSx3.p1.3.m3.1a"><mrow id="Sx2.SSx3.p1.3.m3.1.1" xref="Sx2.SSx3.p1.3.m3.1.1.cmml"><msup id="Sx2.SSx3.p1.3.m3.1.1.2" xref="Sx2.SSx3.p1.3.m3.1.1.2.cmml"><mi id="Sx2.SSx3.p1.3.m3.1.1.2.2" xref="Sx2.SSx3.p1.3.m3.1.1.2.2.cmml">f</mi><mrow id="Sx2.SSx3.p1.3.m3.1.1.2.3" xref="Sx2.SSx3.p1.3.m3.1.1.2.3.cmml"><mo id="Sx2.SSx3.p1.3.m3.1.1.2.3a" xref="Sx2.SSx3.p1.3.m3.1.1.2.3.cmml">−</mo><mn id="Sx2.SSx3.p1.3.m3.1.1.2.3.2" xref="Sx2.SSx3.p1.3.m3.1.1.2.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="Sx2.SSx3.p1.3.m3.1.1.1" xref="Sx2.SSx3.p1.3.m3.1.1.1.cmml">​</mo><mrow id="Sx2.SSx3.p1.3.m3.1.1.3.2" xref="Sx2.SSx3.p1.3.m3.1.1.cmml"><mo stretchy="false" id="Sx2.SSx3.p1.3.m3.1.1.3.2.1" xref="Sx2.SSx3.p1.3.m3.1.1.3.1.cmml">(</mo><mo stretchy="false" id="Sx2.SSx3.p1.3.m3.1.1.3.2.2" xref="Sx2.SSx3.p1.3.m3.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p1.3.m3.1b"><apply id="Sx2.SSx3.p1.3.m3.1.1.cmml" xref="Sx2.SSx3.p1.3.m3.1.1"><times id="Sx2.SSx3.p1.3.m3.1.1.1.cmml" xref="Sx2.SSx3.p1.3.m3.1.1.1"></times><apply id="Sx2.SSx3.p1.3.m3.1.1.2.cmml" xref="Sx2.SSx3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx3.p1.3.m3.1.1.2.1.cmml" xref="Sx2.SSx3.p1.3.m3.1.1.2">superscript</csymbol><ci id="Sx2.SSx3.p1.3.m3.1.1.2.2.cmml" xref="Sx2.SSx3.p1.3.m3.1.1.2.2">𝑓</ci><apply id="Sx2.SSx3.p1.3.m3.1.1.2.3.cmml" xref="Sx2.SSx3.p1.3.m3.1.1.2.3"><minus id="Sx2.SSx3.p1.3.m3.1.1.2.3.1.cmml" xref="Sx2.SSx3.p1.3.m3.1.1.2.3"></minus><cn type="integer" id="Sx2.SSx3.p1.3.m3.1.1.2.3.2.cmml" xref="Sx2.SSx3.p1.3.m3.1.1.2.3.2">1</cn></apply></apply><list id="Sx2.SSx3.p1.3.m3.1.1.3.1.cmml" xref="Sx2.SSx3.p1.3.m3.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p1.3.m3.1c">f^{-1}()</annotation></semantics></math> signifying the decryption function and <math id="Sx2.SSx3.p1.4.m4.1" class="ltx_Math" alttext="\oplus" display="inline"><semantics id="Sx2.SSx3.p1.4.m4.1a"><mo id="Sx2.SSx3.p1.4.m4.1.1" xref="Sx2.SSx3.p1.4.m4.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p1.4.m4.1b"><csymbol cd="latexml" id="Sx2.SSx3.p1.4.m4.1.1.cmml" xref="Sx2.SSx3.p1.4.m4.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p1.4.m4.1c">\oplus</annotation></semantics></math> representing the binary operation within the scope of <math id="Sx2.SSx3.p1.5.m5.1" class="ltx_Math" alttext="f()" display="inline"><semantics id="Sx2.SSx3.p1.5.m5.1a"><mrow id="Sx2.SSx3.p1.5.m5.1.1" xref="Sx2.SSx3.p1.5.m5.1.1.cmml"><mi id="Sx2.SSx3.p1.5.m5.1.1.2" xref="Sx2.SSx3.p1.5.m5.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx2.SSx3.p1.5.m5.1.1.1" xref="Sx2.SSx3.p1.5.m5.1.1.1.cmml">​</mo><mrow id="Sx2.SSx3.p1.5.m5.1.1.3.2" xref="Sx2.SSx3.p1.5.m5.1.1.cmml"><mo stretchy="false" id="Sx2.SSx3.p1.5.m5.1.1.3.2.1" xref="Sx2.SSx3.p1.5.m5.1.1.3.1.cmml">(</mo><mo stretchy="false" id="Sx2.SSx3.p1.5.m5.1.1.3.2.2" xref="Sx2.SSx3.p1.5.m5.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p1.5.m5.1b"><apply id="Sx2.SSx3.p1.5.m5.1.1.cmml" xref="Sx2.SSx3.p1.5.m5.1.1"><times id="Sx2.SSx3.p1.5.m5.1.1.1.cmml" xref="Sx2.SSx3.p1.5.m5.1.1.1"></times><ci id="Sx2.SSx3.p1.5.m5.1.1.2.cmml" xref="Sx2.SSx3.p1.5.m5.1.1.2">𝑓</ci><list id="Sx2.SSx3.p1.5.m5.1.1.3.1.cmml" xref="Sx2.SSx3.p1.5.m5.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p1.5.m5.1c">f()</annotation></semantics></math>. The concept of fully homomorphic encryption (FHE) broadens this attribute to encompass both additive and multiplicative operations.
Although diverse FHE schemes, including BFV <cite class="ltx_cite ltx_citemacro_citep">(Fan and Vercauteren <a href="#bib.bib8" title="" class="ltx_ref">2012</a>)</cite> and CKKS <cite class="ltx_cite ltx_citemacro_citep">(Cheon et al. <a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite>, have been conceived, their integration into Homomorphic Encryption for Federated Learning remains limited due to their pronounced computational overhead. Instead, HE schemes that exclusively support additive or multiplicative homomorphism exhibit greater efficiency and have thus found their way into the fold of Privacy-Preserving Machine Learning (PPML) systems <cite class="ltx_cite ltx_citemacro_citep">(Savvides, Khandelwal, and Eugster <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>. A pertinent example is the Paillier <cite class="ltx_cite ltx_citemacro_citep">(Paillier <a href="#bib.bib15" title="" class="ltx_ref">1999</a>)</cite> encryption scheme, which has been harnessed in endeavors like <cite class="ltx_cite ltx_citemacro_citep">(Hardy et al. <a href="#bib.bib11" title="" class="ltx_ref">2017</a>; Zhang et al. <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite> to ensure privacy preservation within the context of federated learning.</p>
</div>
</section>
<section id="Sx2.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">CKKS Scheme</h3>

<div id="Sx2.SSx4.p1" class="ltx_para">
<p id="Sx2.SSx4.p1.1" class="ltx_p">The CKKS <cite class="ltx_cite ltx_citemacro_citep">(Cheon et al. <a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite> homomorphic encryption scheme represents a transformative advancement in the field of cryptography, offering a potent solution for secure computation on encrypted data while accommodating real-number arithmetic. At its heart, CKKS employs a unique representation of ciphertext as a pair of polynomials, strategically leveraging mathematical operations on these polynomials to facilitate computations on encrypted values. This distinctive approach not only preserves the precision of real-number data but also ensures the confidentiality of sensitive information. CKKS’s dual capability to perform both additive and multiplicative operations on encrypted data renders it highly adept for applications requiring precise computations on private data.
However, the realization of these benefits comes with certain challenges. The arithmetic operations in CKKS tend to enlarge ciphertext and introduce noise, necessitating countermeasures such as <span id="Sx2.SSx4.p1.1.1" class="ltx_text ltx_font_italic">relinearization</span> to manage the growth in ciphertext size. This process optimizes the performance of multiplication operations while maintaining manageable ciphertext dimensions. Additionally, the increased noise due to homomorphic operations necessitates ”modulo switching” to manage noise accumulation. This procedure strategically refreshes the ciphertext noise levels, allowing secure and accurate computations while safeguarding data privacy.</p>
</div>
</section>
<section id="Sx2.SSx5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Security Proof</h3>

<div id="Sx2.SSx5.p1" class="ltx_para">
<p id="Sx2.SSx5.p1.1" class="ltx_p">The security of cryptographic schemes, including homomorphic encryption, is often assessed through formal proofs based on established security notions. The Indistinguishability under Chosen Plaintext Attack (IND-CPA) security is a fundamental concept that assures the confidentiality of encrypted data even when adversaries have access to chosen plaintext-ciphertext pairs. The proof of IND-CPA involves the application of reduction techniques, analysis of probabilities, and the concept of negligible functions.</p>
</div>
<section id="Sx2.SSx5.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Reduction Techniques</h5>

<div id="Sx2.SSx5.SSS0.Px1.p1" class="ltx_para">
<p id="Sx2.SSx5.SSS0.Px1.p1.1" class="ltx_p">The proof template for IND-CPA employs reduction, where the security of the cryptographic scheme is reduced to the assumed infeasibility of a particular computational problem. This is usually the hardness of breaking the underlying cryptographic primitive. In the context of homomorphic encryption, this reduction demonstrates that if an adversary can distinguish between two ciphertexts encrypted from distinct plaintexts, then the adversary could also solve the assumed computational problem, which is considered hard.</p>
</div>
</section>
<section id="Sx2.SSx5.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Probabilistic Analysis</h5>

<div id="Sx2.SSx5.SSS0.Px2.p1" class="ltx_para">
<p id="Sx2.SSx5.SSS0.Px2.p1.1" class="ltx_p">IND-CPA security hinges on the concept that an adversary should not be able to distinguish between two ciphertexts that correspond to different plaintexts. The proof template involves a probabilistic analysis, where the probability that an adversary can distinguish between these ciphertexts is shown to be negligibly close to 0. This probabilistic approach ensures that, even with an unbounded adversary, the probability of successful distinguishing remains negligible.</p>
</div>
</section>
<section id="Sx2.SSx5.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Negligible Functions</h5>

<div id="Sx2.SSx5.SSS0.Px3.p1" class="ltx_para">
<p id="Sx2.SSx5.SSS0.Px3.p1.1" class="ltx_p">Central to the proof template are negligible functions, which are functions that decrease faster than the reciprocal of any polynomial. In the context of security proofs, if the advantage of an adversary (the probability that they can distinguish between ciphertexts) is bounded by a negligible function, then the scheme is considered IND-CPA secure. This notion encapsulates the concept that as the input size grows, the negligible function diminishes more rapidly than any polynomial increase.</p>
</div>
</section>
</section>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Search over CKKS Ciphertexts</h2>

<section id="Sx3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Notations</h3>

<div id="Sx3.SSx1.p1" class="ltx_para">
<p id="Sx3.SSx1.p1.13" class="ltx_p">Fully Homomorphic Encryption (FHE) introduces a set of notations that are commonly used to describe its operations and properties. Let <math id="Sx3.SSx1.p1.1.m1.1" class="ltx_Math" alttext="Enc" display="inline"><semantics id="Sx3.SSx1.p1.1.m1.1a"><mrow id="Sx3.SSx1.p1.1.m1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx1.p1.1.m1.1.1.2" xref="Sx3.SSx1.p1.1.m1.1.1.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.1.m1.1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx1.p1.1.m1.1.1.3" xref="Sx3.SSx1.p1.1.m1.1.1.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.1.m1.1.1.1a" xref="Sx3.SSx1.p1.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx1.p1.1.m1.1.1.4" xref="Sx3.SSx1.p1.1.m1.1.1.4.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.1.m1.1b"><apply id="Sx3.SSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1"><times id="Sx3.SSx1.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.1"></times><ci id="Sx3.SSx1.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.2">𝐸</ci><ci id="Sx3.SSx1.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.3">𝑛</ci><ci id="Sx3.SSx1.p1.1.m1.1.1.4.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.4">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.1.m1.1c">Enc</annotation></semantics></math> denote the encryption function that takes a plaintext <math id="Sx3.SSx1.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="Sx3.SSx1.p1.2.m2.1a"><mi id="Sx3.SSx1.p1.2.m2.1.1" xref="Sx3.SSx1.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.2.m2.1b"><ci id="Sx3.SSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.2.m2.1c">m</annotation></semantics></math> and transforms it into a ciphertext <math id="Sx3.SSx1.p1.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="Sx3.SSx1.p1.3.m3.1a"><mi id="Sx3.SSx1.p1.3.m3.1.1" xref="Sx3.SSx1.p1.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.3.m3.1b"><ci id="Sx3.SSx1.p1.3.m3.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.3.m3.1c">c</annotation></semantics></math> using the public key, i.e., <math id="Sx3.SSx1.p1.4.m4.1" class="ltx_Math" alttext="c=Enc(m)" display="inline"><semantics id="Sx3.SSx1.p1.4.m4.1a"><mrow id="Sx3.SSx1.p1.4.m4.1.2" xref="Sx3.SSx1.p1.4.m4.1.2.cmml"><mi id="Sx3.SSx1.p1.4.m4.1.2.2" xref="Sx3.SSx1.p1.4.m4.1.2.2.cmml">c</mi><mo id="Sx3.SSx1.p1.4.m4.1.2.1" xref="Sx3.SSx1.p1.4.m4.1.2.1.cmml">=</mo><mrow id="Sx3.SSx1.p1.4.m4.1.2.3" xref="Sx3.SSx1.p1.4.m4.1.2.3.cmml"><mi id="Sx3.SSx1.p1.4.m4.1.2.3.2" xref="Sx3.SSx1.p1.4.m4.1.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.4.m4.1.2.3.1" xref="Sx3.SSx1.p1.4.m4.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.4.m4.1.2.3.3" xref="Sx3.SSx1.p1.4.m4.1.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.4.m4.1.2.3.1a" xref="Sx3.SSx1.p1.4.m4.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.4.m4.1.2.3.4" xref="Sx3.SSx1.p1.4.m4.1.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.4.m4.1.2.3.1b" xref="Sx3.SSx1.p1.4.m4.1.2.3.1.cmml">​</mo><mrow id="Sx3.SSx1.p1.4.m4.1.2.3.5.2" xref="Sx3.SSx1.p1.4.m4.1.2.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.4.m4.1.2.3.5.2.1" xref="Sx3.SSx1.p1.4.m4.1.2.3.cmml">(</mo><mi id="Sx3.SSx1.p1.4.m4.1.1" xref="Sx3.SSx1.p1.4.m4.1.1.cmml">m</mi><mo stretchy="false" id="Sx3.SSx1.p1.4.m4.1.2.3.5.2.2" xref="Sx3.SSx1.p1.4.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.4.m4.1b"><apply id="Sx3.SSx1.p1.4.m4.1.2.cmml" xref="Sx3.SSx1.p1.4.m4.1.2"><eq id="Sx3.SSx1.p1.4.m4.1.2.1.cmml" xref="Sx3.SSx1.p1.4.m4.1.2.1"></eq><ci id="Sx3.SSx1.p1.4.m4.1.2.2.cmml" xref="Sx3.SSx1.p1.4.m4.1.2.2">𝑐</ci><apply id="Sx3.SSx1.p1.4.m4.1.2.3.cmml" xref="Sx3.SSx1.p1.4.m4.1.2.3"><times id="Sx3.SSx1.p1.4.m4.1.2.3.1.cmml" xref="Sx3.SSx1.p1.4.m4.1.2.3.1"></times><ci id="Sx3.SSx1.p1.4.m4.1.2.3.2.cmml" xref="Sx3.SSx1.p1.4.m4.1.2.3.2">𝐸</ci><ci id="Sx3.SSx1.p1.4.m4.1.2.3.3.cmml" xref="Sx3.SSx1.p1.4.m4.1.2.3.3">𝑛</ci><ci id="Sx3.SSx1.p1.4.m4.1.2.3.4.cmml" xref="Sx3.SSx1.p1.4.m4.1.2.3.4">𝑐</ci><ci id="Sx3.SSx1.p1.4.m4.1.1.cmml" xref="Sx3.SSx1.p1.4.m4.1.1">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.4.m4.1c">c=Enc(m)</annotation></semantics></math>. The decryption function, <math id="Sx3.SSx1.p1.5.m5.1" class="ltx_Math" alttext="Dec" display="inline"><semantics id="Sx3.SSx1.p1.5.m5.1a"><mrow id="Sx3.SSx1.p1.5.m5.1.1" xref="Sx3.SSx1.p1.5.m5.1.1.cmml"><mi id="Sx3.SSx1.p1.5.m5.1.1.2" xref="Sx3.SSx1.p1.5.m5.1.1.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.5.m5.1.1.1" xref="Sx3.SSx1.p1.5.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx1.p1.5.m5.1.1.3" xref="Sx3.SSx1.p1.5.m5.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.5.m5.1.1.1a" xref="Sx3.SSx1.p1.5.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx1.p1.5.m5.1.1.4" xref="Sx3.SSx1.p1.5.m5.1.1.4.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.5.m5.1b"><apply id="Sx3.SSx1.p1.5.m5.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.1"><times id="Sx3.SSx1.p1.5.m5.1.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.1.1"></times><ci id="Sx3.SSx1.p1.5.m5.1.1.2.cmml" xref="Sx3.SSx1.p1.5.m5.1.1.2">𝐷</ci><ci id="Sx3.SSx1.p1.5.m5.1.1.3.cmml" xref="Sx3.SSx1.p1.5.m5.1.1.3">𝑒</ci><ci id="Sx3.SSx1.p1.5.m5.1.1.4.cmml" xref="Sx3.SSx1.p1.5.m5.1.1.4">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.5.m5.1c">Dec</annotation></semantics></math>, inversely converts the ciphertext back to the plaintext using the secret key, yielding <math id="Sx3.SSx1.p1.6.m6.1" class="ltx_Math" alttext="m=Dec(c)" display="inline"><semantics id="Sx3.SSx1.p1.6.m6.1a"><mrow id="Sx3.SSx1.p1.6.m6.1.2" xref="Sx3.SSx1.p1.6.m6.1.2.cmml"><mi id="Sx3.SSx1.p1.6.m6.1.2.2" xref="Sx3.SSx1.p1.6.m6.1.2.2.cmml">m</mi><mo id="Sx3.SSx1.p1.6.m6.1.2.1" xref="Sx3.SSx1.p1.6.m6.1.2.1.cmml">=</mo><mrow id="Sx3.SSx1.p1.6.m6.1.2.3" xref="Sx3.SSx1.p1.6.m6.1.2.3.cmml"><mi id="Sx3.SSx1.p1.6.m6.1.2.3.2" xref="Sx3.SSx1.p1.6.m6.1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.6.m6.1.2.3.1" xref="Sx3.SSx1.p1.6.m6.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.6.m6.1.2.3.3" xref="Sx3.SSx1.p1.6.m6.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.6.m6.1.2.3.1a" xref="Sx3.SSx1.p1.6.m6.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.6.m6.1.2.3.4" xref="Sx3.SSx1.p1.6.m6.1.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.6.m6.1.2.3.1b" xref="Sx3.SSx1.p1.6.m6.1.2.3.1.cmml">​</mo><mrow id="Sx3.SSx1.p1.6.m6.1.2.3.5.2" xref="Sx3.SSx1.p1.6.m6.1.2.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.6.m6.1.2.3.5.2.1" xref="Sx3.SSx1.p1.6.m6.1.2.3.cmml">(</mo><mi id="Sx3.SSx1.p1.6.m6.1.1" xref="Sx3.SSx1.p1.6.m6.1.1.cmml">c</mi><mo stretchy="false" id="Sx3.SSx1.p1.6.m6.1.2.3.5.2.2" xref="Sx3.SSx1.p1.6.m6.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.6.m6.1b"><apply id="Sx3.SSx1.p1.6.m6.1.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.2"><eq id="Sx3.SSx1.p1.6.m6.1.2.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.1"></eq><ci id="Sx3.SSx1.p1.6.m6.1.2.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.2">𝑚</ci><apply id="Sx3.SSx1.p1.6.m6.1.2.3.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.3"><times id="Sx3.SSx1.p1.6.m6.1.2.3.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.3.1"></times><ci id="Sx3.SSx1.p1.6.m6.1.2.3.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.3.2">𝐷</ci><ci id="Sx3.SSx1.p1.6.m6.1.2.3.3.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.3.3">𝑒</ci><ci id="Sx3.SSx1.p1.6.m6.1.2.3.4.cmml" xref="Sx3.SSx1.p1.6.m6.1.2.3.4">𝑐</ci><ci id="Sx3.SSx1.p1.6.m6.1.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.6.m6.1c">m=Dec(c)</annotation></semantics></math>. For additive homomorphic encryption, the notation <math id="Sx3.SSx1.p1.7.m7.1" class="ltx_Math" alttext="\oplus" display="inline"><semantics id="Sx3.SSx1.p1.7.m7.1a"><mo id="Sx3.SSx1.p1.7.m7.1.1" xref="Sx3.SSx1.p1.7.m7.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.7.m7.1b"><csymbol cd="latexml" id="Sx3.SSx1.p1.7.m7.1.1.cmml" xref="Sx3.SSx1.p1.7.m7.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.7.m7.1c">\oplus</annotation></semantics></math> signifies the addition operation performed on ciphertexts and <math id="Sx3.SSx1.p1.8.m8.1" class="ltx_Math" alttext="\ominus" display="inline"><semantics id="Sx3.SSx1.p1.8.m8.1a"><mo id="Sx3.SSx1.p1.8.m8.1.1" xref="Sx3.SSx1.p1.8.m8.1.1.cmml">⊖</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.8.m8.1b"><csymbol cd="latexml" id="Sx3.SSx1.p1.8.m8.1.1.cmml" xref="Sx3.SSx1.p1.8.m8.1.1">symmetric-difference</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.8.m8.1c">\ominus</annotation></semantics></math> represents subtraction, allowing computations on encrypted data without decryption. Similarly, <math id="Sx3.SSx1.p1.9.m9.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="Sx3.SSx1.p1.9.m9.1a"><mo id="Sx3.SSx1.p1.9.m9.1.1" xref="Sx3.SSx1.p1.9.m9.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.9.m9.1b"><csymbol cd="latexml" id="Sx3.SSx1.p1.9.m9.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.9.m9.1c">\odot</annotation></semantics></math> represents the multiplication operation used in multiplicative homomorphic encryption. The notation <math id="Sx3.SSx1.p1.10.m10.1" class="ltx_Math" alttext="Enc_{pk}(m)" display="inline"><semantics id="Sx3.SSx1.p1.10.m10.1a"><mrow id="Sx3.SSx1.p1.10.m10.1.2" xref="Sx3.SSx1.p1.10.m10.1.2.cmml"><mi id="Sx3.SSx1.p1.10.m10.1.2.2" xref="Sx3.SSx1.p1.10.m10.1.2.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.10.m10.1.2.1" xref="Sx3.SSx1.p1.10.m10.1.2.1.cmml">​</mo><mi id="Sx3.SSx1.p1.10.m10.1.2.3" xref="Sx3.SSx1.p1.10.m10.1.2.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.10.m10.1.2.1a" xref="Sx3.SSx1.p1.10.m10.1.2.1.cmml">​</mo><msub id="Sx3.SSx1.p1.10.m10.1.2.4" xref="Sx3.SSx1.p1.10.m10.1.2.4.cmml"><mi id="Sx3.SSx1.p1.10.m10.1.2.4.2" xref="Sx3.SSx1.p1.10.m10.1.2.4.2.cmml">c</mi><mrow id="Sx3.SSx1.p1.10.m10.1.2.4.3" xref="Sx3.SSx1.p1.10.m10.1.2.4.3.cmml"><mi id="Sx3.SSx1.p1.10.m10.1.2.4.3.2" xref="Sx3.SSx1.p1.10.m10.1.2.4.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.10.m10.1.2.4.3.1" xref="Sx3.SSx1.p1.10.m10.1.2.4.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.10.m10.1.2.4.3.3" xref="Sx3.SSx1.p1.10.m10.1.2.4.3.3.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.10.m10.1.2.1b" xref="Sx3.SSx1.p1.10.m10.1.2.1.cmml">​</mo><mrow id="Sx3.SSx1.p1.10.m10.1.2.5.2" xref="Sx3.SSx1.p1.10.m10.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.10.m10.1.2.5.2.1" xref="Sx3.SSx1.p1.10.m10.1.2.cmml">(</mo><mi id="Sx3.SSx1.p1.10.m10.1.1" xref="Sx3.SSx1.p1.10.m10.1.1.cmml">m</mi><mo stretchy="false" id="Sx3.SSx1.p1.10.m10.1.2.5.2.2" xref="Sx3.SSx1.p1.10.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.10.m10.1b"><apply id="Sx3.SSx1.p1.10.m10.1.2.cmml" xref="Sx3.SSx1.p1.10.m10.1.2"><times id="Sx3.SSx1.p1.10.m10.1.2.1.cmml" xref="Sx3.SSx1.p1.10.m10.1.2.1"></times><ci id="Sx3.SSx1.p1.10.m10.1.2.2.cmml" xref="Sx3.SSx1.p1.10.m10.1.2.2">𝐸</ci><ci id="Sx3.SSx1.p1.10.m10.1.2.3.cmml" xref="Sx3.SSx1.p1.10.m10.1.2.3">𝑛</ci><apply id="Sx3.SSx1.p1.10.m10.1.2.4.cmml" xref="Sx3.SSx1.p1.10.m10.1.2.4"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.10.m10.1.2.4.1.cmml" xref="Sx3.SSx1.p1.10.m10.1.2.4">subscript</csymbol><ci id="Sx3.SSx1.p1.10.m10.1.2.4.2.cmml" xref="Sx3.SSx1.p1.10.m10.1.2.4.2">𝑐</ci><apply id="Sx3.SSx1.p1.10.m10.1.2.4.3.cmml" xref="Sx3.SSx1.p1.10.m10.1.2.4.3"><times id="Sx3.SSx1.p1.10.m10.1.2.4.3.1.cmml" xref="Sx3.SSx1.p1.10.m10.1.2.4.3.1"></times><ci id="Sx3.SSx1.p1.10.m10.1.2.4.3.2.cmml" xref="Sx3.SSx1.p1.10.m10.1.2.4.3.2">𝑝</ci><ci id="Sx3.SSx1.p1.10.m10.1.2.4.3.3.cmml" xref="Sx3.SSx1.p1.10.m10.1.2.4.3.3">𝑘</ci></apply></apply><ci id="Sx3.SSx1.p1.10.m10.1.1.cmml" xref="Sx3.SSx1.p1.10.m10.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.10.m10.1c">Enc_{pk}(m)</annotation></semantics></math> denotes encryption under the public key <math id="Sx3.SSx1.p1.11.m11.1" class="ltx_Math" alttext="pk" display="inline"><semantics id="Sx3.SSx1.p1.11.m11.1a"><mrow id="Sx3.SSx1.p1.11.m11.1.1" xref="Sx3.SSx1.p1.11.m11.1.1.cmml"><mi id="Sx3.SSx1.p1.11.m11.1.1.2" xref="Sx3.SSx1.p1.11.m11.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.11.m11.1.1.1" xref="Sx3.SSx1.p1.11.m11.1.1.1.cmml">​</mo><mi id="Sx3.SSx1.p1.11.m11.1.1.3" xref="Sx3.SSx1.p1.11.m11.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.11.m11.1b"><apply id="Sx3.SSx1.p1.11.m11.1.1.cmml" xref="Sx3.SSx1.p1.11.m11.1.1"><times id="Sx3.SSx1.p1.11.m11.1.1.1.cmml" xref="Sx3.SSx1.p1.11.m11.1.1.1"></times><ci id="Sx3.SSx1.p1.11.m11.1.1.2.cmml" xref="Sx3.SSx1.p1.11.m11.1.1.2">𝑝</ci><ci id="Sx3.SSx1.p1.11.m11.1.1.3.cmml" xref="Sx3.SSx1.p1.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.11.m11.1c">pk</annotation></semantics></math>, and <math id="Sx3.SSx1.p1.12.m12.1" class="ltx_Math" alttext="Enc_{sk}(m)" display="inline"><semantics id="Sx3.SSx1.p1.12.m12.1a"><mrow id="Sx3.SSx1.p1.12.m12.1.2" xref="Sx3.SSx1.p1.12.m12.1.2.cmml"><mi id="Sx3.SSx1.p1.12.m12.1.2.2" xref="Sx3.SSx1.p1.12.m12.1.2.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.12.m12.1.2.1" xref="Sx3.SSx1.p1.12.m12.1.2.1.cmml">​</mo><mi id="Sx3.SSx1.p1.12.m12.1.2.3" xref="Sx3.SSx1.p1.12.m12.1.2.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.12.m12.1.2.1a" xref="Sx3.SSx1.p1.12.m12.1.2.1.cmml">​</mo><msub id="Sx3.SSx1.p1.12.m12.1.2.4" xref="Sx3.SSx1.p1.12.m12.1.2.4.cmml"><mi id="Sx3.SSx1.p1.12.m12.1.2.4.2" xref="Sx3.SSx1.p1.12.m12.1.2.4.2.cmml">c</mi><mrow id="Sx3.SSx1.p1.12.m12.1.2.4.3" xref="Sx3.SSx1.p1.12.m12.1.2.4.3.cmml"><mi id="Sx3.SSx1.p1.12.m12.1.2.4.3.2" xref="Sx3.SSx1.p1.12.m12.1.2.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.12.m12.1.2.4.3.1" xref="Sx3.SSx1.p1.12.m12.1.2.4.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.12.m12.1.2.4.3.3" xref="Sx3.SSx1.p1.12.m12.1.2.4.3.3.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.12.m12.1.2.1b" xref="Sx3.SSx1.p1.12.m12.1.2.1.cmml">​</mo><mrow id="Sx3.SSx1.p1.12.m12.1.2.5.2" xref="Sx3.SSx1.p1.12.m12.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.12.m12.1.2.5.2.1" xref="Sx3.SSx1.p1.12.m12.1.2.cmml">(</mo><mi id="Sx3.SSx1.p1.12.m12.1.1" xref="Sx3.SSx1.p1.12.m12.1.1.cmml">m</mi><mo stretchy="false" id="Sx3.SSx1.p1.12.m12.1.2.5.2.2" xref="Sx3.SSx1.p1.12.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.12.m12.1b"><apply id="Sx3.SSx1.p1.12.m12.1.2.cmml" xref="Sx3.SSx1.p1.12.m12.1.2"><times id="Sx3.SSx1.p1.12.m12.1.2.1.cmml" xref="Sx3.SSx1.p1.12.m12.1.2.1"></times><ci id="Sx3.SSx1.p1.12.m12.1.2.2.cmml" xref="Sx3.SSx1.p1.12.m12.1.2.2">𝐸</ci><ci id="Sx3.SSx1.p1.12.m12.1.2.3.cmml" xref="Sx3.SSx1.p1.12.m12.1.2.3">𝑛</ci><apply id="Sx3.SSx1.p1.12.m12.1.2.4.cmml" xref="Sx3.SSx1.p1.12.m12.1.2.4"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.12.m12.1.2.4.1.cmml" xref="Sx3.SSx1.p1.12.m12.1.2.4">subscript</csymbol><ci id="Sx3.SSx1.p1.12.m12.1.2.4.2.cmml" xref="Sx3.SSx1.p1.12.m12.1.2.4.2">𝑐</ci><apply id="Sx3.SSx1.p1.12.m12.1.2.4.3.cmml" xref="Sx3.SSx1.p1.12.m12.1.2.4.3"><times id="Sx3.SSx1.p1.12.m12.1.2.4.3.1.cmml" xref="Sx3.SSx1.p1.12.m12.1.2.4.3.1"></times><ci id="Sx3.SSx1.p1.12.m12.1.2.4.3.2.cmml" xref="Sx3.SSx1.p1.12.m12.1.2.4.3.2">𝑠</ci><ci id="Sx3.SSx1.p1.12.m12.1.2.4.3.3.cmml" xref="Sx3.SSx1.p1.12.m12.1.2.4.3.3">𝑘</ci></apply></apply><ci id="Sx3.SSx1.p1.12.m12.1.1.cmml" xref="Sx3.SSx1.p1.12.m12.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.12.m12.1c">Enc_{sk}(m)</annotation></semantics></math> denotes encryption under the secret key <math id="Sx3.SSx1.p1.13.m13.1" class="ltx_Math" alttext="sk" display="inline"><semantics id="Sx3.SSx1.p1.13.m13.1a"><mrow id="Sx3.SSx1.p1.13.m13.1.1" xref="Sx3.SSx1.p1.13.m13.1.1.cmml"><mi id="Sx3.SSx1.p1.13.m13.1.1.2" xref="Sx3.SSx1.p1.13.m13.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.13.m13.1.1.1" xref="Sx3.SSx1.p1.13.m13.1.1.1.cmml">​</mo><mi id="Sx3.SSx1.p1.13.m13.1.1.3" xref="Sx3.SSx1.p1.13.m13.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.13.m13.1b"><apply id="Sx3.SSx1.p1.13.m13.1.1.cmml" xref="Sx3.SSx1.p1.13.m13.1.1"><times id="Sx3.SSx1.p1.13.m13.1.1.1.cmml" xref="Sx3.SSx1.p1.13.m13.1.1.1"></times><ci id="Sx3.SSx1.p1.13.m13.1.1.2.cmml" xref="Sx3.SSx1.p1.13.m13.1.1.2">𝑠</ci><ci id="Sx3.SSx1.p1.13.m13.1.1.3.cmml" xref="Sx3.SSx1.p1.13.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.13.m13.1c">sk</annotation></semantics></math>. Fully homomorphic encryption supports both additive and multiplicative operations on ciphertexts, enabling a wide range of computations while maintaining data privacy.</p>
</div>
<div id="Sx3.SSx1.p2" class="ltx_para">
<p id="Sx3.SSx1.p2.8" class="ltx_p">To work with vectors, <math id="Sx3.SSx1.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{v}" display="inline"><semantics id="Sx3.SSx1.p2.1.m1.1a"><mi id="Sx3.SSx1.p2.1.m1.1.1" xref="Sx3.SSx1.p2.1.m1.1.1.cmml">𝐯</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.1.m1.1b"><ci id="Sx3.SSx1.p2.1.m1.1.1.cmml" xref="Sx3.SSx1.p2.1.m1.1.1">𝐯</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.1.m1.1c">\mathbf{v}</annotation></semantics></math> usually denotes a vector of plaintext values, and <math id="Sx3.SSx1.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{c}" display="inline"><semantics id="Sx3.SSx1.p2.2.m2.1a"><mi id="Sx3.SSx1.p2.2.m2.1.1" xref="Sx3.SSx1.p2.2.m2.1.1.cmml">𝐜</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.2.m2.1b"><ci id="Sx3.SSx1.p2.2.m2.1.1.cmml" xref="Sx3.SSx1.p2.2.m2.1.1">𝐜</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.2.m2.1c">\mathbf{c}</annotation></semantics></math> represents the corresponding vector of ciphertexts obtained through encryption, i.e., <math id="Sx3.SSx1.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{c}=Enc(\mathbf{v})" display="inline"><semantics id="Sx3.SSx1.p2.3.m3.1a"><mrow id="Sx3.SSx1.p2.3.m3.1.2" xref="Sx3.SSx1.p2.3.m3.1.2.cmml"><mi id="Sx3.SSx1.p2.3.m3.1.2.2" xref="Sx3.SSx1.p2.3.m3.1.2.2.cmml">𝐜</mi><mo id="Sx3.SSx1.p2.3.m3.1.2.1" xref="Sx3.SSx1.p2.3.m3.1.2.1.cmml">=</mo><mrow id="Sx3.SSx1.p2.3.m3.1.2.3" xref="Sx3.SSx1.p2.3.m3.1.2.3.cmml"><mi id="Sx3.SSx1.p2.3.m3.1.2.3.2" xref="Sx3.SSx1.p2.3.m3.1.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p2.3.m3.1.2.3.1" xref="Sx3.SSx1.p2.3.m3.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx1.p2.3.m3.1.2.3.3" xref="Sx3.SSx1.p2.3.m3.1.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p2.3.m3.1.2.3.1a" xref="Sx3.SSx1.p2.3.m3.1.2.3.1.cmml">​</mo><mi id="Sx3.SSx1.p2.3.m3.1.2.3.4" xref="Sx3.SSx1.p2.3.m3.1.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p2.3.m3.1.2.3.1b" xref="Sx3.SSx1.p2.3.m3.1.2.3.1.cmml">​</mo><mrow id="Sx3.SSx1.p2.3.m3.1.2.3.5.2" xref="Sx3.SSx1.p2.3.m3.1.2.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p2.3.m3.1.2.3.5.2.1" xref="Sx3.SSx1.p2.3.m3.1.2.3.cmml">(</mo><mi id="Sx3.SSx1.p2.3.m3.1.1" xref="Sx3.SSx1.p2.3.m3.1.1.cmml">𝐯</mi><mo stretchy="false" id="Sx3.SSx1.p2.3.m3.1.2.3.5.2.2" xref="Sx3.SSx1.p2.3.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.3.m3.1b"><apply id="Sx3.SSx1.p2.3.m3.1.2.cmml" xref="Sx3.SSx1.p2.3.m3.1.2"><eq id="Sx3.SSx1.p2.3.m3.1.2.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.1"></eq><ci id="Sx3.SSx1.p2.3.m3.1.2.2.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.2">𝐜</ci><apply id="Sx3.SSx1.p2.3.m3.1.2.3.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.3"><times id="Sx3.SSx1.p2.3.m3.1.2.3.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.3.1"></times><ci id="Sx3.SSx1.p2.3.m3.1.2.3.2.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.3.2">𝐸</ci><ci id="Sx3.SSx1.p2.3.m3.1.2.3.3.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.3.3">𝑛</ci><ci id="Sx3.SSx1.p2.3.m3.1.2.3.4.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.3.4">𝑐</ci><ci id="Sx3.SSx1.p2.3.m3.1.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.1">𝐯</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.3.m3.1c">\mathbf{c}=Enc(\mathbf{v})</annotation></semantics></math>. The subscript notation <math id="Sx3.SSx1.p2.4.m4.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="Sx3.SSx1.p2.4.m4.1a"><msub id="Sx3.SSx1.p2.4.m4.1.1" xref="Sx3.SSx1.p2.4.m4.1.1.cmml"><mi id="Sx3.SSx1.p2.4.m4.1.1.2" xref="Sx3.SSx1.p2.4.m4.1.1.2.cmml">c</mi><mi id="Sx3.SSx1.p2.4.m4.1.1.3" xref="Sx3.SSx1.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.4.m4.1b"><apply id="Sx3.SSx1.p2.4.m4.1.1.cmml" xref="Sx3.SSx1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.4.m4.1.1.1.cmml" xref="Sx3.SSx1.p2.4.m4.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.4.m4.1.1.2.cmml" xref="Sx3.SSx1.p2.4.m4.1.1.2">𝑐</ci><ci id="Sx3.SSx1.p2.4.m4.1.1.3.cmml" xref="Sx3.SSx1.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.4.m4.1c">c_{i}</annotation></semantics></math> and <math id="Sx3.SSx1.p2.5.m5.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="Sx3.SSx1.p2.5.m5.1a"><msub id="Sx3.SSx1.p2.5.m5.1.1" xref="Sx3.SSx1.p2.5.m5.1.1.cmml"><mi id="Sx3.SSx1.p2.5.m5.1.1.2" xref="Sx3.SSx1.p2.5.m5.1.1.2.cmml">v</mi><mi id="Sx3.SSx1.p2.5.m5.1.1.3" xref="Sx3.SSx1.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.5.m5.1b"><apply id="Sx3.SSx1.p2.5.m5.1.1.cmml" xref="Sx3.SSx1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.5.m5.1.1.1.cmml" xref="Sx3.SSx1.p2.5.m5.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.5.m5.1.1.2.cmml" xref="Sx3.SSx1.p2.5.m5.1.1.2">𝑣</ci><ci id="Sx3.SSx1.p2.5.m5.1.1.3.cmml" xref="Sx3.SSx1.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.5.m5.1c">v_{i}</annotation></semantics></math> refer to the <math id="Sx3.SSx1.p2.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.SSx1.p2.6.m6.1a"><mi id="Sx3.SSx1.p2.6.m6.1.1" xref="Sx3.SSx1.p2.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.6.m6.1b"><ci id="Sx3.SSx1.p2.6.m6.1.1.cmml" xref="Sx3.SSx1.p2.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.6.m6.1c">i</annotation></semantics></math>-th components of ciphertext and plaintext vectors, respectively. Additionally, <math id="Sx3.SSx1.p2.7.m7.1" class="ltx_Math" alttext="\mathbf{0}" display="inline"><semantics id="Sx3.SSx1.p2.7.m7.1a"><mn id="Sx3.SSx1.p2.7.m7.1.1" xref="Sx3.SSx1.p2.7.m7.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.7.m7.1b"><cn type="integer" id="Sx3.SSx1.p2.7.m7.1.1.cmml" xref="Sx3.SSx1.p2.7.m7.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.7.m7.1c">\mathbf{0}</annotation></semantics></math> stands for the vector of all zeros, and <math id="Sx3.SSx1.p2.8.m8.1" class="ltx_Math" alttext="\mathbf{1}" display="inline"><semantics id="Sx3.SSx1.p2.8.m8.1a"><mn id="Sx3.SSx1.p2.8.m8.1.1" xref="Sx3.SSx1.p2.8.m8.1.1.cmml">𝟏</mn><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.8.m8.1b"><cn type="integer" id="Sx3.SSx1.p2.8.m8.1.1.cmml" xref="Sx3.SSx1.p2.8.m8.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.8.m8.1c">\mathbf{1}</annotation></semantics></math> represents the vector of all ones.</p>
</div>
</section>
<section id="Sx3.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Threat Model</h3>

<div id="Sx3.SSx2.p1" class="ltx_para">
<p id="Sx3.SSx2.p1.1" class="ltx_p">Incorporating the chosen-plaintext attack (IND-CPA) security model within the framework of Fully Homomorphic Encryption (FHE) for Federated Learning (FL) establishes a robust foundation for privacy preservation and security assessment.</p>
</div>
<div id="Sx3.SSx2.p2" class="ltx_para">
<p id="Sx3.SSx2.p2.1" class="ltx_p">IND-CPA security is a fundamental cryptographic property that ensures the confidentiality of encrypted data, even when adversaries possess the ability to influence the plaintexts being encrypted. Specifically, in the context of FHE for FL, IND-CPA security implies that an attacker, despite being able to choose plaintexts for encryption and receiving the corresponding ciphertexts, cannot gain any meaningful insight into the plaintexts’ content. This property is vital for protecting sensitive information during the federated learning process.</p>
</div>
<div id="Sx3.SSx2.p3" class="ltx_para">
<p id="Sx3.SSx2.p3.1" class="ltx_p">In the FL setting, where client devices collaboratively contribute encrypted data and model updates to a central aggregator for training, IND-CPA security guarantees that an adversary cannot exploit the encrypted information to deduce the clients’ individual contributions. This resilience is critical for maintaining the privacy of participants’ data.</p>
</div>
<div id="Sx3.SSx2.p4" class="ltx_para">
<p id="Sx3.SSx2.p4.1" class="ltx_p">By embracing the IND-CPA security model, FHE-enabled FL systems can effectively thwart various adversarial strategies, including those attempting to infer sensitive information from encrypted data or exploit patterns within the encrypted model updates. This model forms the cornerstone for designing cryptographic protocols and encryption schemes that maintain data privacy while enabling collaborative and secure federated learning across distributed environments.</p>
</div>
</section>
<section id="Sx3.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Security Assumptions</h3>

<div id="Sx3.SSx3.p1" class="ltx_para">
<p id="Sx3.SSx3.p1.1" class="ltx_p">The security of a Federated Learning (FL) system augmented by Fully Homomorphic Encryption (FHE) hinges on a set of foundational security assumptions that underpin the confidentiality and integrity of the data being processed. These assumptions form the bedrock upon which cryptographic protocols and techniques are designed to safeguard sensitive information within a distributed learning paradigm. The integration of FHE into FL introduces several key security considerations:</p>
</div>
<section id="Sx3.SSx3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">FHE Scheme Security</h5>

<div id="Sx3.SSx3.SSS0.Px1.p1" class="ltx_para">
<p id="Sx3.SSx3.SSS0.Px1.p1.1" class="ltx_p">The security of FHE-based FL heavily relies on the chosen FHE scheme’s cryptographic robustness. It is assumed that the underlying FHE scheme exhibits the prescribed security properties, such as IND-CPA or IND-CCA security, ensuring that encrypted data remains confidential against various types of adversaries.</p>
</div>
</section>
<section id="Sx3.SSx3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Key Management</h5>

<div id="Sx3.SSx3.SSS0.Px2.p1" class="ltx_para">
<p id="Sx3.SSx3.SSS0.Px2.p1.1" class="ltx_p">A critical assumption is that the secret keys used for encryption and decryption are securely managed. Adversarial access to secret keys can compromise the confidentiality of data and undermine the integrity of the federated learning process.</p>
</div>
</section>
<section id="Sx3.SSx3.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Secure Communication</h5>

<div id="Sx3.SSx3.SSS0.Px3.p1" class="ltx_para">
<p id="Sx3.SSx3.SSS0.Px3.p1.1" class="ltx_p">It is assumed that the communication channels between clients and the central aggregator are secure, preventing eavesdropping and tampering. This includes safeguarding against potential man-in-the-middle attacks and ensuring that encrypted data remains confidential during transmission.</p>
</div>
</section>
<section id="Sx3.SSx3.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Malicious Clients</h5>

<div id="Sx3.SSx3.SSS0.Px4.p1" class="ltx_para">
<p id="Sx3.SSx3.SSS0.Px4.p1.1" class="ltx_p">Security assumptions encompass the behavior of clients in the FL system. While benign clients are assumed to follow the protocol and contribute valid data, malicious clients may deviate from the prescribed behavior, attempting to inject poisoned data or manipulate the learning process. FHE and FL protocols should be designed to detect and mitigate the impact of such adversarial behavior.</p>
</div>
</section>
<section id="Sx3.SSx3.SSS0.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Aggregator Integrity</h5>

<div id="Sx3.SSx3.SSS0.Px5.p1" class="ltx_para">
<p id="Sx3.SSx3.SSS0.Px5.p1.1" class="ltx_p">The central aggregator, responsible for aggregating model updates and facilitating federated learning, is assumed to be honest and immune to attacks. Ensuring the integrity of the aggregator’s operations is crucial for preventing attacks that could compromise the accuracy and privacy of the aggregated model.</p>
</div>
</section>
<section id="Sx3.SSx3.SSS0.Px6" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Cryptanalysis and Exploits</h5>

<div id="Sx3.SSx3.SSS0.Px6.p1" class="ltx_para">
<p id="Sx3.SSx3.SSS0.Px6.p1.1" class="ltx_p">It is assumed that the FHE scheme used in FL is resistant to known cryptanalytic attacks and vulnerabilities. This assumption acknowledges that adversaries may attempt to exploit weaknesses in cryptographic primitives to break the security guarantees of the FHE-based FL system.</p>
</div>
</section>
<section id="Sx3.SSx3.SSS0.Px7" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Implementation and Side Channels</h5>

<div id="Sx3.SSx3.SSS0.Px7.p1" class="ltx_para">
<p id="Sx3.SSx3.SSS0.Px7.p1.1" class="ltx_p">Security assumptions extend to the correct implementation of FHE and FL protocols, accounting for potential side-channel attacks that exploit implementation-specific vulnerabilities, such as timing information, power consumption, or electromagnetic radiation.</p>
</div>
<div id="Sx3.SSx3.SSS0.Px7.p2" class="ltx_para">
<p id="Sx3.SSx3.SSS0.Px7.p2.1" class="ltx_p">By explicitly addressing these security assumptions, FHE-based FL systems can be designed with a heightened awareness of potential vulnerabilities and mitigation strategies. These assumptions serve as a guide for formulating security requirements, designing cryptographic protocols, and implementing countermeasures that collectively contribute to robust and privacy-preserving federated learning.</p>
</div>
</section>
</section>
<section id="Sx3.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Server Processing</h3>

<section id="Sx3.SSx4.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Description</h4>

<div id="Sx3.SSx4.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx1.p1.1" class="ltx_p">The <span id="Sx3.SSx4.SSSx1.p1.1.1" class="ltx_text ltx_font_italic">Server Processing</span> algorithm <a href="#alg1" title="In Description ‣ Server Processing ‣ Search over CKKS Ciphertexts ‣ Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> is devised to facilitate the search for a target encrypted value within a collection of encrypted ciphertexts, utilizing the capabilities of a homomorphic encryption scheme. The algorithm employs a binary tree structure, implemented as a vector, to streamline the search process efficiently. Each step is carefully designed to maintain the confidentiality of the data while enabling meaningful computations.</p>
</div>
<figure id="alg1" class="ltx_float ltx_algorithm">
<div id="alg1.24" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg1.6.6" class="ltx_listingline">


<span id="alg1.6.6.1" class="ltx_text"><span id="alg1.6.6.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>
A set of <math id="alg1.1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.1.1.m1.1a"><mi id="alg1.1.1.m1.1.1" xref="alg1.1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.1.1.m1.1b"><ci id="alg1.1.1.m1.1.1.cmml" xref="alg1.1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.m1.1c">n</annotation></semantics></math> ciphertexts <math id="alg1.2.2.m2.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="alg1.2.2.m2.1a"><msub id="alg1.2.2.m2.1.1" xref="alg1.2.2.m2.1.1.cmml"><mi id="alg1.2.2.m2.1.1.2" xref="alg1.2.2.m2.1.1.2.cmml">c</mi><mi id="alg1.2.2.m2.1.1.3" xref="alg1.2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.2.2.m2.1b"><apply id="alg1.2.2.m2.1.1.cmml" xref="alg1.2.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.2.2.m2.1.1.1.cmml" xref="alg1.2.2.m2.1.1">subscript</csymbol><ci id="alg1.2.2.m2.1.1.2.cmml" xref="alg1.2.2.m2.1.1.2">𝑐</ci><ci id="alg1.2.2.m2.1.1.3.cmml" xref="alg1.2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.m2.1c">c_{i}</annotation></semantics></math> encrypted by a homomorphic encryption scheme;
A target (encrypted) value <math id="alg1.3.3.m3.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="alg1.3.3.m3.1a"><msub id="alg1.3.3.m3.1.1" xref="alg1.3.3.m3.1.1.cmml"><mi id="alg1.3.3.m3.1.1.2" xref="alg1.3.3.m3.1.1.2.cmml">c</mi><mi id="alg1.3.3.m3.1.1.3" xref="alg1.3.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.3.3.m3.1b"><apply id="alg1.3.3.m3.1.1.cmml" xref="alg1.3.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.3.3.m3.1.1.1.cmml" xref="alg1.3.3.m3.1.1">subscript</csymbol><ci id="alg1.3.3.m3.1.1.2.cmml" xref="alg1.3.3.m3.1.1.2">𝑐</ci><ci id="alg1.3.3.m3.1.1.3.cmml" xref="alg1.3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m3.1c">c_{t}</annotation></semantics></math> to be searched in <math id="alg1.4.4.m4.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="alg1.4.4.m4.1a"><msub id="alg1.4.4.m4.1.1" xref="alg1.4.4.m4.1.1.cmml"><mi id="alg1.4.4.m4.1.1.2" xref="alg1.4.4.m4.1.1.2.cmml">c</mi><mi id="alg1.4.4.m4.1.1.3" xref="alg1.4.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.4.4.m4.1b"><apply id="alg1.4.4.m4.1.1.cmml" xref="alg1.4.4.m4.1.1"><csymbol cd="ambiguous" id="alg1.4.4.m4.1.1.1.cmml" xref="alg1.4.4.m4.1.1">subscript</csymbol><ci id="alg1.4.4.m4.1.1.2.cmml" xref="alg1.4.4.m4.1.1.2">𝑐</ci><ci id="alg1.4.4.m4.1.1.3.cmml" xref="alg1.4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m4.1c">c_{i}</annotation></semantics></math>;
We use <math id="alg1.5.5.m5.1" class="ltx_Math" alttext="\ominus" display="inline"><semantics id="alg1.5.5.m5.1a"><mo id="alg1.5.5.m5.1.1" xref="alg1.5.5.m5.1.1.cmml">⊖</mo><annotation-xml encoding="MathML-Content" id="alg1.5.5.m5.1b"><csymbol cd="latexml" id="alg1.5.5.m5.1.1.cmml" xref="alg1.5.5.m5.1.1">symmetric-difference</csymbol></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m5.1c">\ominus</annotation></semantics></math> and <math id="alg1.6.6.m6.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="alg1.6.6.m6.1a"><mo id="alg1.6.6.m6.1.1" xref="alg1.6.6.m6.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="alg1.6.6.m6.1b"><csymbol cd="latexml" id="alg1.6.6.m6.1.1.cmml" xref="alg1.6.6.m6.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.m6.1c">\odot</annotation></semantics></math> to denote homomorphic subtraction and homomorphic multiplication, respectively;

</div>
<div id="alg1.7.7" class="ltx_listingline">
<span id="alg1.7.7.1" class="ltx_text"><span id="alg1.7.7.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>
A binary tree <span id="alg1.7.7.2" class="ltx_text ltx_markedasmath ltx_font_bold">t</span>, implemented as a vector,
where an intermediate node with a value of zero implies that the descendant subtree has a zero-leaf node.

</div>
<div id="alg1.24.25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>

</div>
<div id="alg1.24.26" class="ltx_listingline">
</div>
<div id="alg1.24.27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>

</div>
<div id="alg1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>

<span id="alg1.8.8.2" class="ltx_text ltx_font_bold">Function</span> <em id="alg1.8.8.1" class="ltx_emph ltx_font_typewriter">PairwiseMul(<em id="alg1.8.8.1.1.1" class="ltx_emph ltx_markedasmath ltx_font_serif ltx_font_bold ltx_font_italic">c</em>)</em><span id="alg1.8.8.3" class="ltx_text ltx_font_bold">:</span> 
</div>
<div id="alg1.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.9.9.m1.1" class="ltx_Math" alttext="\textbf{v}\coloneqq[\;]" display="inline"><semantics id="alg1.9.9.m1.1a"><mrow id="alg1.9.9.m1.1.1" xref="alg1.9.9.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.9.9.m1.1.1.2" xref="alg1.9.9.m1.1.1.2a.cmml">v</mtext><mo id="alg1.9.9.m1.1.1.1" xref="alg1.9.9.m1.1.1.1.cmml">≔</mo><mrow id="alg1.9.9.m1.1.1.3.2" xref="alg1.9.9.m1.1.1.cmml"><mo rspace="0.280em" stretchy="false" id="alg1.9.9.m1.1.1.3.2.1" xref="alg1.9.9.m1.1.1.3.1.cmml">[</mo><mo stretchy="false" id="alg1.9.9.m1.1.1.3.2.2" xref="alg1.9.9.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.9.m1.1b"><apply id="alg1.9.9.m1.1.1.cmml" xref="alg1.9.9.m1.1.1"><ci id="alg1.9.9.m1.1.1.1.cmml" xref="alg1.9.9.m1.1.1.1">≔</ci><ci id="alg1.9.9.m1.1.1.2a.cmml" xref="alg1.9.9.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="alg1.9.9.m1.1.1.2.cmml" xref="alg1.9.9.m1.1.1.2">v</mtext></ci><list id="alg1.9.9.m1.1.1.3.1.cmml" xref="alg1.9.9.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.m1.1c">\textbf{v}\coloneqq[\;]</annotation></semantics></math>
</div>
<div id="alg1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.10.10.m1.1" class="ltx_Math" alttext="m\coloneqq|\textbf{c}|" display="inline"><semantics id="alg1.10.10.m1.1a"><mrow id="alg1.10.10.m1.1.2" xref="alg1.10.10.m1.1.2.cmml"><mi id="alg1.10.10.m1.1.2.2" xref="alg1.10.10.m1.1.2.2.cmml">m</mi><mo id="alg1.10.10.m1.1.2.1" xref="alg1.10.10.m1.1.2.1.cmml">≔</mo><mrow id="alg1.10.10.m1.1.2.3.2" xref="alg1.10.10.m1.1.2.3.1.cmml"><mo stretchy="false" id="alg1.10.10.m1.1.2.3.2.1" xref="alg1.10.10.m1.1.2.3.1.1.cmml">|</mo><mtext class="ltx_mathvariant_bold" id="alg1.10.10.m1.1.1" xref="alg1.10.10.m1.1.1a.cmml">c</mtext><mo stretchy="false" id="alg1.10.10.m1.1.2.3.2.2" xref="alg1.10.10.m1.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.10.10.m1.1b"><apply id="alg1.10.10.m1.1.2.cmml" xref="alg1.10.10.m1.1.2"><ci id="alg1.10.10.m1.1.2.1.cmml" xref="alg1.10.10.m1.1.2.1">≔</ci><ci id="alg1.10.10.m1.1.2.2.cmml" xref="alg1.10.10.m1.1.2.2">𝑚</ci><apply id="alg1.10.10.m1.1.2.3.1.cmml" xref="alg1.10.10.m1.1.2.3.2"><abs id="alg1.10.10.m1.1.2.3.1.1.cmml" xref="alg1.10.10.m1.1.2.3.2.1"></abs><ci id="alg1.10.10.m1.1.1a.cmml" xref="alg1.10.10.m1.1.1"><mtext class="ltx_mathvariant_bold" id="alg1.10.10.m1.1.1.cmml" xref="alg1.10.10.m1.1.1">c</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m1.1c">m\coloneqq|\textbf{c}|</annotation></semantics></math>
</div>
<div id="alg1.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.11.11.2" class="ltx_text ltx_font_bold">for</span> <em id="alg1.11.11.1" class="ltx_emph ltx_font_italic"><math id="alg1.11.11.1.m1.4" class="ltx_Math" alttext="i\coloneqq 0;i&lt;m;i\coloneqq i+2" display="inline"><semantics id="alg1.11.11.1.m1.4a"><mrow id="alg1.11.11.1.m1.4.4.2" xref="alg1.11.11.1.m1.4.4.3.cmml"><mrow id="alg1.11.11.1.m1.3.3.1.1" xref="alg1.11.11.1.m1.3.3.1.1.cmml"><mi id="alg1.11.11.1.m1.3.3.1.1.2" xref="alg1.11.11.1.m1.3.3.1.1.2.cmml">i</mi><mo id="alg1.11.11.1.m1.3.3.1.1.1" xref="alg1.11.11.1.m1.3.3.1.1.1.cmml">≔</mo><mn id="alg1.11.11.1.m1.3.3.1.1.3" xref="alg1.11.11.1.m1.3.3.1.1.3.cmml">0</mn></mrow><mo id="alg1.11.11.1.m1.4.4.2.3" xref="alg1.11.11.1.m1.4.4.3a.cmml">;</mo><mrow id="alg1.11.11.1.m1.4.4.2.2.2" xref="alg1.11.11.1.m1.4.4.2.2.3.cmml"><mrow id="alg1.11.11.1.m1.4.4.2.2.1.1" xref="alg1.11.11.1.m1.4.4.2.2.1.1.cmml"><mi id="alg1.11.11.1.m1.4.4.2.2.1.1.2" xref="alg1.11.11.1.m1.4.4.2.2.1.1.2.cmml">i</mi><mo id="alg1.11.11.1.m1.4.4.2.2.1.1.1" xref="alg1.11.11.1.m1.4.4.2.2.1.1.1.cmml">&lt;</mo><mi id="alg1.11.11.1.m1.1.1" xref="alg1.11.11.1.m1.1.1.cmml">m</mi></mrow><mo id="alg1.11.11.1.m1.4.4.2.2.2.3" xref="alg1.11.11.1.m1.4.4.2.2.3a.cmml">;</mo><mrow id="alg1.11.11.1.m1.4.4.2.2.2.2" xref="alg1.11.11.1.m1.4.4.2.2.2.2.cmml"><mi id="alg1.11.11.1.m1.2.2" xref="alg1.11.11.1.m1.2.2.cmml">i</mi><mo id="alg1.11.11.1.m1.4.4.2.2.2.2.1" xref="alg1.11.11.1.m1.4.4.2.2.2.2.1.cmml">≔</mo><mrow id="alg1.11.11.1.m1.4.4.2.2.2.2.2" xref="alg1.11.11.1.m1.4.4.2.2.2.2.2.cmml"><mi id="alg1.11.11.1.m1.4.4.2.2.2.2.2.2" xref="alg1.11.11.1.m1.4.4.2.2.2.2.2.2.cmml">i</mi><mo id="alg1.11.11.1.m1.4.4.2.2.2.2.2.1" xref="alg1.11.11.1.m1.4.4.2.2.2.2.2.1.cmml">+</mo><mn id="alg1.11.11.1.m1.4.4.2.2.2.2.2.3" xref="alg1.11.11.1.m1.4.4.2.2.2.2.2.3.cmml">2</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.11.11.1.m1.4b"><apply id="alg1.11.11.1.m1.4.4.3.cmml" xref="alg1.11.11.1.m1.4.4.2"><csymbol cd="ambiguous" id="alg1.11.11.1.m1.4.4.3a.cmml" xref="alg1.11.11.1.m1.4.4.2.3">formulae-sequence</csymbol><apply id="alg1.11.11.1.m1.3.3.1.1.cmml" xref="alg1.11.11.1.m1.3.3.1.1"><ci id="alg1.11.11.1.m1.3.3.1.1.1.cmml" xref="alg1.11.11.1.m1.3.3.1.1.1">≔</ci><ci id="alg1.11.11.1.m1.3.3.1.1.2.cmml" xref="alg1.11.11.1.m1.3.3.1.1.2">𝑖</ci><cn type="integer" id="alg1.11.11.1.m1.3.3.1.1.3.cmml" xref="alg1.11.11.1.m1.3.3.1.1.3">0</cn></apply><apply id="alg1.11.11.1.m1.4.4.2.2.3.cmml" xref="alg1.11.11.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.11.11.1.m1.4.4.2.2.3a.cmml" xref="alg1.11.11.1.m1.4.4.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.11.11.1.m1.4.4.2.2.1.1.cmml" xref="alg1.11.11.1.m1.4.4.2.2.1.1"><lt id="alg1.11.11.1.m1.4.4.2.2.1.1.1.cmml" xref="alg1.11.11.1.m1.4.4.2.2.1.1.1"></lt><ci id="alg1.11.11.1.m1.4.4.2.2.1.1.2.cmml" xref="alg1.11.11.1.m1.4.4.2.2.1.1.2">𝑖</ci><ci id="alg1.11.11.1.m1.1.1.cmml" xref="alg1.11.11.1.m1.1.1">𝑚</ci></apply><apply id="alg1.11.11.1.m1.4.4.2.2.2.2.cmml" xref="alg1.11.11.1.m1.4.4.2.2.2.2"><ci id="alg1.11.11.1.m1.4.4.2.2.2.2.1.cmml" xref="alg1.11.11.1.m1.4.4.2.2.2.2.1">≔</ci><ci id="alg1.11.11.1.m1.2.2.cmml" xref="alg1.11.11.1.m1.2.2">𝑖</ci><apply id="alg1.11.11.1.m1.4.4.2.2.2.2.2.cmml" xref="alg1.11.11.1.m1.4.4.2.2.2.2.2"><plus id="alg1.11.11.1.m1.4.4.2.2.2.2.2.1.cmml" xref="alg1.11.11.1.m1.4.4.2.2.2.2.2.1"></plus><ci id="alg1.11.11.1.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.11.11.1.m1.4.4.2.2.2.2.2.2">𝑖</ci><cn type="integer" id="alg1.11.11.1.m1.4.4.2.2.2.2.2.3.cmml" xref="alg1.11.11.1.m1.4.4.2.2.2.2.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.1.m1.4c">i\coloneqq 0;i&lt;m;i\coloneqq i+2</annotation></semantics></math></em> <span id="alg1.11.11.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.12.12.2" class="ltx_text ltx_font_bold">if</span> <em id="alg1.12.12.1" class="ltx_emph ltx_font_italic"><math id="alg1.12.12.1.m1.1" class="ltx_Math" alttext="i\geq m" display="inline"><semantics id="alg1.12.12.1.m1.1a"><mrow id="alg1.12.12.1.m1.1.1" xref="alg1.12.12.1.m1.1.1.cmml"><mi id="alg1.12.12.1.m1.1.1.2" xref="alg1.12.12.1.m1.1.1.2.cmml">i</mi><mo id="alg1.12.12.1.m1.1.1.1" xref="alg1.12.12.1.m1.1.1.1.cmml">≥</mo><mi id="alg1.12.12.1.m1.1.1.3" xref="alg1.12.12.1.m1.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.12.12.1.m1.1b"><apply id="alg1.12.12.1.m1.1.1.cmml" xref="alg1.12.12.1.m1.1.1"><geq id="alg1.12.12.1.m1.1.1.1.cmml" xref="alg1.12.12.1.m1.1.1.1"></geq><ci id="alg1.12.12.1.m1.1.1.2.cmml" xref="alg1.12.12.1.m1.1.1.2">𝑖</ci><ci id="alg1.12.12.1.m1.1.1.3.cmml" xref="alg1.12.12.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.1.m1.1c">i\geq m</annotation></semantics></math></em> <span id="alg1.12.12.3" class="ltx_text ltx_font_bold">then</span> 
</div>
<div id="alg1.24.28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.24.28.1" class="ltx_text ltx_font_bold">break</span> 
</div>
<div id="alg1.24.29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.24.30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end if
</div>
<div id="alg1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg1.13.13.2" class="ltx_text ltx_font_bold">if</span> <em id="alg1.13.13.1" class="ltx_emph ltx_font_italic"><math id="alg1.13.13.1.m1.1" class="ltx_Math" alttext="i+1=m" display="inline"><semantics id="alg1.13.13.1.m1.1a"><mrow id="alg1.13.13.1.m1.1.1" xref="alg1.13.13.1.m1.1.1.cmml"><mrow id="alg1.13.13.1.m1.1.1.2" xref="alg1.13.13.1.m1.1.1.2.cmml"><mi id="alg1.13.13.1.m1.1.1.2.2" xref="alg1.13.13.1.m1.1.1.2.2.cmml">i</mi><mo id="alg1.13.13.1.m1.1.1.2.1" xref="alg1.13.13.1.m1.1.1.2.1.cmml">+</mo><mn id="alg1.13.13.1.m1.1.1.2.3" xref="alg1.13.13.1.m1.1.1.2.3.cmml">1</mn></mrow><mo id="alg1.13.13.1.m1.1.1.1" xref="alg1.13.13.1.m1.1.1.1.cmml">=</mo><mi id="alg1.13.13.1.m1.1.1.3" xref="alg1.13.13.1.m1.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.13.13.1.m1.1b"><apply id="alg1.13.13.1.m1.1.1.cmml" xref="alg1.13.13.1.m1.1.1"><eq id="alg1.13.13.1.m1.1.1.1.cmml" xref="alg1.13.13.1.m1.1.1.1"></eq><apply id="alg1.13.13.1.m1.1.1.2.cmml" xref="alg1.13.13.1.m1.1.1.2"><plus id="alg1.13.13.1.m1.1.1.2.1.cmml" xref="alg1.13.13.1.m1.1.1.2.1"></plus><ci id="alg1.13.13.1.m1.1.1.2.2.cmml" xref="alg1.13.13.1.m1.1.1.2.2">𝑖</ci><cn type="integer" id="alg1.13.13.1.m1.1.1.2.3.cmml" xref="alg1.13.13.1.m1.1.1.2.3">1</cn></apply><ci id="alg1.13.13.1.m1.1.1.3.cmml" xref="alg1.13.13.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.1.m1.1c">i+1=m</annotation></semantics></math></em> <span id="alg1.13.13.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="alg1.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.14.14.m1.2" class="ltx_Math" alttext="\textbf{v}.append(c_{i})" display="inline"><semantics id="alg1.14.14.m1.2a"><mrow id="alg1.14.14.m1.2.2.1" xref="alg1.14.14.m1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.14.14.m1.1.1" xref="alg1.14.14.m1.1.1a.cmml">v</mtext><mo lspace="0em" rspace="0.167em" id="alg1.14.14.m1.2.2.1.2" xref="alg1.14.14.m1.2.2.2a.cmml">.</mo><mrow id="alg1.14.14.m1.2.2.1.1" xref="alg1.14.14.m1.2.2.1.1.cmml"><mi id="alg1.14.14.m1.2.2.1.1.3" xref="alg1.14.14.m1.2.2.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.14.14.m1.2.2.1.1.2" xref="alg1.14.14.m1.2.2.1.1.2.cmml">​</mo><mi id="alg1.14.14.m1.2.2.1.1.4" xref="alg1.14.14.m1.2.2.1.1.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.14.14.m1.2.2.1.1.2a" xref="alg1.14.14.m1.2.2.1.1.2.cmml">​</mo><mi id="alg1.14.14.m1.2.2.1.1.5" xref="alg1.14.14.m1.2.2.1.1.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.14.14.m1.2.2.1.1.2b" xref="alg1.14.14.m1.2.2.1.1.2.cmml">​</mo><mi id="alg1.14.14.m1.2.2.1.1.6" xref="alg1.14.14.m1.2.2.1.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.14.14.m1.2.2.1.1.2c" xref="alg1.14.14.m1.2.2.1.1.2.cmml">​</mo><mi id="alg1.14.14.m1.2.2.1.1.7" xref="alg1.14.14.m1.2.2.1.1.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.14.14.m1.2.2.1.1.2d" xref="alg1.14.14.m1.2.2.1.1.2.cmml">​</mo><mi id="alg1.14.14.m1.2.2.1.1.8" xref="alg1.14.14.m1.2.2.1.1.8.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.14.14.m1.2.2.1.1.2e" xref="alg1.14.14.m1.2.2.1.1.2.cmml">​</mo><mrow id="alg1.14.14.m1.2.2.1.1.1.1" xref="alg1.14.14.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.14.14.m1.2.2.1.1.1.1.2" xref="alg1.14.14.m1.2.2.1.1.1.1.1.cmml">(</mo><msub id="alg1.14.14.m1.2.2.1.1.1.1.1" xref="alg1.14.14.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.14.14.m1.2.2.1.1.1.1.1.2" xref="alg1.14.14.m1.2.2.1.1.1.1.1.2.cmml">c</mi><mi id="alg1.14.14.m1.2.2.1.1.1.1.1.3" xref="alg1.14.14.m1.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.14.14.m1.2.2.1.1.1.1.3" xref="alg1.14.14.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.14.14.m1.2b"><apply id="alg1.14.14.m1.2.2.2.cmml" xref="alg1.14.14.m1.2.2.1"><csymbol cd="ambiguous" id="alg1.14.14.m1.2.2.2a.cmml" xref="alg1.14.14.m1.2.2.1.2">formulae-sequence</csymbol><ci id="alg1.14.14.m1.1.1a.cmml" xref="alg1.14.14.m1.1.1"><mtext class="ltx_mathvariant_bold" id="alg1.14.14.m1.1.1.cmml" xref="alg1.14.14.m1.1.1">v</mtext></ci><apply id="alg1.14.14.m1.2.2.1.1.cmml" xref="alg1.14.14.m1.2.2.1.1"><times id="alg1.14.14.m1.2.2.1.1.2.cmml" xref="alg1.14.14.m1.2.2.1.1.2"></times><ci id="alg1.14.14.m1.2.2.1.1.3.cmml" xref="alg1.14.14.m1.2.2.1.1.3">𝑎</ci><ci id="alg1.14.14.m1.2.2.1.1.4.cmml" xref="alg1.14.14.m1.2.2.1.1.4">𝑝</ci><ci id="alg1.14.14.m1.2.2.1.1.5.cmml" xref="alg1.14.14.m1.2.2.1.1.5">𝑝</ci><ci id="alg1.14.14.m1.2.2.1.1.6.cmml" xref="alg1.14.14.m1.2.2.1.1.6">𝑒</ci><ci id="alg1.14.14.m1.2.2.1.1.7.cmml" xref="alg1.14.14.m1.2.2.1.1.7">𝑛</ci><ci id="alg1.14.14.m1.2.2.1.1.8.cmml" xref="alg1.14.14.m1.2.2.1.1.8">𝑑</ci><apply id="alg1.14.14.m1.2.2.1.1.1.1.1.cmml" xref="alg1.14.14.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.14.14.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.14.14.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.14.14.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.14.14.m1.2.2.1.1.1.1.1.2">𝑐</ci><ci id="alg1.14.14.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.14.14.m1.2.2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.m1.2c">\textbf{v}.append(c_{i})</annotation></semantics></math>
</div>
<div id="alg1.24.31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.24.32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg1.24.32.1" class="ltx_text ltx_font_bold">else</span> 
</div>
<div id="alg1.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.15.15.m1.1" class="ltx_Math" alttext="c\coloneqq v_{i}\odot v_{i+1}" display="inline"><semantics id="alg1.15.15.m1.1a"><mrow id="alg1.15.15.m1.1.1" xref="alg1.15.15.m1.1.1.cmml"><mi id="alg1.15.15.m1.1.1.2" xref="alg1.15.15.m1.1.1.2.cmml">c</mi><mo id="alg1.15.15.m1.1.1.1" xref="alg1.15.15.m1.1.1.1.cmml">≔</mo><mrow id="alg1.15.15.m1.1.1.3" xref="alg1.15.15.m1.1.1.3.cmml"><msub id="alg1.15.15.m1.1.1.3.2" xref="alg1.15.15.m1.1.1.3.2.cmml"><mi id="alg1.15.15.m1.1.1.3.2.2" xref="alg1.15.15.m1.1.1.3.2.2.cmml">v</mi><mi id="alg1.15.15.m1.1.1.3.2.3" xref="alg1.15.15.m1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.15.15.m1.1.1.3.1" xref="alg1.15.15.m1.1.1.3.1.cmml">⊙</mo><msub id="alg1.15.15.m1.1.1.3.3" xref="alg1.15.15.m1.1.1.3.3.cmml"><mi id="alg1.15.15.m1.1.1.3.3.2" xref="alg1.15.15.m1.1.1.3.3.2.cmml">v</mi><mrow id="alg1.15.15.m1.1.1.3.3.3" xref="alg1.15.15.m1.1.1.3.3.3.cmml"><mi id="alg1.15.15.m1.1.1.3.3.3.2" xref="alg1.15.15.m1.1.1.3.3.3.2.cmml">i</mi><mo id="alg1.15.15.m1.1.1.3.3.3.1" xref="alg1.15.15.m1.1.1.3.3.3.1.cmml">+</mo><mn id="alg1.15.15.m1.1.1.3.3.3.3" xref="alg1.15.15.m1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.15.15.m1.1b"><apply id="alg1.15.15.m1.1.1.cmml" xref="alg1.15.15.m1.1.1"><ci id="alg1.15.15.m1.1.1.1.cmml" xref="alg1.15.15.m1.1.1.1">≔</ci><ci id="alg1.15.15.m1.1.1.2.cmml" xref="alg1.15.15.m1.1.1.2">𝑐</ci><apply id="alg1.15.15.m1.1.1.3.cmml" xref="alg1.15.15.m1.1.1.3"><csymbol cd="latexml" id="alg1.15.15.m1.1.1.3.1.cmml" xref="alg1.15.15.m1.1.1.3.1">direct-product</csymbol><apply id="alg1.15.15.m1.1.1.3.2.cmml" xref="alg1.15.15.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.15.15.m1.1.1.3.2.1.cmml" xref="alg1.15.15.m1.1.1.3.2">subscript</csymbol><ci id="alg1.15.15.m1.1.1.3.2.2.cmml" xref="alg1.15.15.m1.1.1.3.2.2">𝑣</ci><ci id="alg1.15.15.m1.1.1.3.2.3.cmml" xref="alg1.15.15.m1.1.1.3.2.3">𝑖</ci></apply><apply id="alg1.15.15.m1.1.1.3.3.cmml" xref="alg1.15.15.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.15.15.m1.1.1.3.3.1.cmml" xref="alg1.15.15.m1.1.1.3.3">subscript</csymbol><ci id="alg1.15.15.m1.1.1.3.3.2.cmml" xref="alg1.15.15.m1.1.1.3.3.2">𝑣</ci><apply id="alg1.15.15.m1.1.1.3.3.3.cmml" xref="alg1.15.15.m1.1.1.3.3.3"><plus id="alg1.15.15.m1.1.1.3.3.3.1.cmml" xref="alg1.15.15.m1.1.1.3.3.3.1"></plus><ci id="alg1.15.15.m1.1.1.3.3.3.2.cmml" xref="alg1.15.15.m1.1.1.3.3.3.2">𝑖</ci><cn type="integer" id="alg1.15.15.m1.1.1.3.3.3.3.cmml" xref="alg1.15.15.m1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.m1.1c">c\coloneqq v_{i}\odot v_{i+1}</annotation></semantics></math>
</div>
<div id="alg1.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.16.16.m1.3" class="ltx_Math" alttext="\textbf{v}.append(c)" display="inline"><semantics id="alg1.16.16.m1.3a"><mrow id="alg1.16.16.m1.3.3.1" xref="alg1.16.16.m1.3.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.16.16.m1.2.2" xref="alg1.16.16.m1.2.2a.cmml">v</mtext><mo lspace="0em" rspace="0.167em" id="alg1.16.16.m1.3.3.1.2" xref="alg1.16.16.m1.3.3.2a.cmml">.</mo><mrow id="alg1.16.16.m1.3.3.1.1" xref="alg1.16.16.m1.3.3.1.1.cmml"><mi id="alg1.16.16.m1.3.3.1.1.2" xref="alg1.16.16.m1.3.3.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.16.16.m1.3.3.1.1.1" xref="alg1.16.16.m1.3.3.1.1.1.cmml">​</mo><mi id="alg1.16.16.m1.3.3.1.1.3" xref="alg1.16.16.m1.3.3.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.16.16.m1.3.3.1.1.1a" xref="alg1.16.16.m1.3.3.1.1.1.cmml">​</mo><mi id="alg1.16.16.m1.3.3.1.1.4" xref="alg1.16.16.m1.3.3.1.1.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.16.16.m1.3.3.1.1.1b" xref="alg1.16.16.m1.3.3.1.1.1.cmml">​</mo><mi id="alg1.16.16.m1.3.3.1.1.5" xref="alg1.16.16.m1.3.3.1.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.16.16.m1.3.3.1.1.1c" xref="alg1.16.16.m1.3.3.1.1.1.cmml">​</mo><mi id="alg1.16.16.m1.3.3.1.1.6" xref="alg1.16.16.m1.3.3.1.1.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.16.16.m1.3.3.1.1.1d" xref="alg1.16.16.m1.3.3.1.1.1.cmml">​</mo><mi id="alg1.16.16.m1.3.3.1.1.7" xref="alg1.16.16.m1.3.3.1.1.7.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.16.16.m1.3.3.1.1.1e" xref="alg1.16.16.m1.3.3.1.1.1.cmml">​</mo><mrow id="alg1.16.16.m1.3.3.1.1.8.2" xref="alg1.16.16.m1.3.3.1.1.cmml"><mo stretchy="false" id="alg1.16.16.m1.3.3.1.1.8.2.1" xref="alg1.16.16.m1.3.3.1.1.cmml">(</mo><mi id="alg1.16.16.m1.1.1" xref="alg1.16.16.m1.1.1.cmml">c</mi><mo stretchy="false" id="alg1.16.16.m1.3.3.1.1.8.2.2" xref="alg1.16.16.m1.3.3.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.16.16.m1.3b"><apply id="alg1.16.16.m1.3.3.2.cmml" xref="alg1.16.16.m1.3.3.1"><csymbol cd="ambiguous" id="alg1.16.16.m1.3.3.2a.cmml" xref="alg1.16.16.m1.3.3.1.2">formulae-sequence</csymbol><ci id="alg1.16.16.m1.2.2a.cmml" xref="alg1.16.16.m1.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.16.16.m1.2.2.cmml" xref="alg1.16.16.m1.2.2">v</mtext></ci><apply id="alg1.16.16.m1.3.3.1.1.cmml" xref="alg1.16.16.m1.3.3.1.1"><times id="alg1.16.16.m1.3.3.1.1.1.cmml" xref="alg1.16.16.m1.3.3.1.1.1"></times><ci id="alg1.16.16.m1.3.3.1.1.2.cmml" xref="alg1.16.16.m1.3.3.1.1.2">𝑎</ci><ci id="alg1.16.16.m1.3.3.1.1.3.cmml" xref="alg1.16.16.m1.3.3.1.1.3">𝑝</ci><ci id="alg1.16.16.m1.3.3.1.1.4.cmml" xref="alg1.16.16.m1.3.3.1.1.4">𝑝</ci><ci id="alg1.16.16.m1.3.3.1.1.5.cmml" xref="alg1.16.16.m1.3.3.1.1.5">𝑒</ci><ci id="alg1.16.16.m1.3.3.1.1.6.cmml" xref="alg1.16.16.m1.3.3.1.1.6">𝑛</ci><ci id="alg1.16.16.m1.3.3.1.1.7.cmml" xref="alg1.16.16.m1.3.3.1.1.7">𝑑</ci><ci id="alg1.16.16.m1.1.1.cmml" xref="alg1.16.16.m1.1.1">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m1.3c">\textbf{v}.append(c)</annotation></semantics></math>
</div>
<div id="alg1.24.33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.24.34" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end if
</div>
<div id="alg1.24.35" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg1.24.36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="alg1.17.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg1.17.17.1" class="ltx_text ltx_font_bold">return</span> <span id="alg1.17.17.2" class="ltx_text ltx_markedasmath ltx_font_bold">v</span>
</div>
<div id="alg1.24.37" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.24.38" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span> 
</div>
<div id="alg1.24.39" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span><span id="alg1.24.39.1" class="ltx_text ltx_font_bold">End Function</span>

</div>
<div id="alg1.24.40" class="ltx_listingline">
</div>
<div id="alg1.24.41" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25</span>

</div>
<div id="alg1.18.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26</span><span id="alg1.18.18.2" class="ltx_text ltx_font_bold">for</span> <em id="alg1.18.18.1" class="ltx_emph ltx_font_italic"><math id="alg1.18.18.1.m1.4" class="ltx_Math" alttext="i\coloneqq 0;i&lt;n;i\coloneqq i+1" display="inline"><semantics id="alg1.18.18.1.m1.4a"><mrow id="alg1.18.18.1.m1.4.4.2" xref="alg1.18.18.1.m1.4.4.3.cmml"><mrow id="alg1.18.18.1.m1.3.3.1.1" xref="alg1.18.18.1.m1.3.3.1.1.cmml"><mi id="alg1.18.18.1.m1.3.3.1.1.2" xref="alg1.18.18.1.m1.3.3.1.1.2.cmml">i</mi><mo id="alg1.18.18.1.m1.3.3.1.1.1" xref="alg1.18.18.1.m1.3.3.1.1.1.cmml">≔</mo><mn id="alg1.18.18.1.m1.3.3.1.1.3" xref="alg1.18.18.1.m1.3.3.1.1.3.cmml">0</mn></mrow><mo id="alg1.18.18.1.m1.4.4.2.3" xref="alg1.18.18.1.m1.4.4.3a.cmml">;</mo><mrow id="alg1.18.18.1.m1.4.4.2.2.2" xref="alg1.18.18.1.m1.4.4.2.2.3.cmml"><mrow id="alg1.18.18.1.m1.4.4.2.2.1.1" xref="alg1.18.18.1.m1.4.4.2.2.1.1.cmml"><mi id="alg1.18.18.1.m1.4.4.2.2.1.1.2" xref="alg1.18.18.1.m1.4.4.2.2.1.1.2.cmml">i</mi><mo id="alg1.18.18.1.m1.4.4.2.2.1.1.1" xref="alg1.18.18.1.m1.4.4.2.2.1.1.1.cmml">&lt;</mo><mi id="alg1.18.18.1.m1.1.1" xref="alg1.18.18.1.m1.1.1.cmml">n</mi></mrow><mo id="alg1.18.18.1.m1.4.4.2.2.2.3" xref="alg1.18.18.1.m1.4.4.2.2.3a.cmml">;</mo><mrow id="alg1.18.18.1.m1.4.4.2.2.2.2" xref="alg1.18.18.1.m1.4.4.2.2.2.2.cmml"><mi id="alg1.18.18.1.m1.2.2" xref="alg1.18.18.1.m1.2.2.cmml">i</mi><mo id="alg1.18.18.1.m1.4.4.2.2.2.2.1" xref="alg1.18.18.1.m1.4.4.2.2.2.2.1.cmml">≔</mo><mrow id="alg1.18.18.1.m1.4.4.2.2.2.2.2" xref="alg1.18.18.1.m1.4.4.2.2.2.2.2.cmml"><mi id="alg1.18.18.1.m1.4.4.2.2.2.2.2.2" xref="alg1.18.18.1.m1.4.4.2.2.2.2.2.2.cmml">i</mi><mo id="alg1.18.18.1.m1.4.4.2.2.2.2.2.1" xref="alg1.18.18.1.m1.4.4.2.2.2.2.2.1.cmml">+</mo><mn id="alg1.18.18.1.m1.4.4.2.2.2.2.2.3" xref="alg1.18.18.1.m1.4.4.2.2.2.2.2.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.18.18.1.m1.4b"><apply id="alg1.18.18.1.m1.4.4.3.cmml" xref="alg1.18.18.1.m1.4.4.2"><csymbol cd="ambiguous" id="alg1.18.18.1.m1.4.4.3a.cmml" xref="alg1.18.18.1.m1.4.4.2.3">formulae-sequence</csymbol><apply id="alg1.18.18.1.m1.3.3.1.1.cmml" xref="alg1.18.18.1.m1.3.3.1.1"><ci id="alg1.18.18.1.m1.3.3.1.1.1.cmml" xref="alg1.18.18.1.m1.3.3.1.1.1">≔</ci><ci id="alg1.18.18.1.m1.3.3.1.1.2.cmml" xref="alg1.18.18.1.m1.3.3.1.1.2">𝑖</ci><cn type="integer" id="alg1.18.18.1.m1.3.3.1.1.3.cmml" xref="alg1.18.18.1.m1.3.3.1.1.3">0</cn></apply><apply id="alg1.18.18.1.m1.4.4.2.2.3.cmml" xref="alg1.18.18.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.18.18.1.m1.4.4.2.2.3a.cmml" xref="alg1.18.18.1.m1.4.4.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.18.18.1.m1.4.4.2.2.1.1.cmml" xref="alg1.18.18.1.m1.4.4.2.2.1.1"><lt id="alg1.18.18.1.m1.4.4.2.2.1.1.1.cmml" xref="alg1.18.18.1.m1.4.4.2.2.1.1.1"></lt><ci id="alg1.18.18.1.m1.4.4.2.2.1.1.2.cmml" xref="alg1.18.18.1.m1.4.4.2.2.1.1.2">𝑖</ci><ci id="alg1.18.18.1.m1.1.1.cmml" xref="alg1.18.18.1.m1.1.1">𝑛</ci></apply><apply id="alg1.18.18.1.m1.4.4.2.2.2.2.cmml" xref="alg1.18.18.1.m1.4.4.2.2.2.2"><ci id="alg1.18.18.1.m1.4.4.2.2.2.2.1.cmml" xref="alg1.18.18.1.m1.4.4.2.2.2.2.1">≔</ci><ci id="alg1.18.18.1.m1.2.2.cmml" xref="alg1.18.18.1.m1.2.2">𝑖</ci><apply id="alg1.18.18.1.m1.4.4.2.2.2.2.2.cmml" xref="alg1.18.18.1.m1.4.4.2.2.2.2.2"><plus id="alg1.18.18.1.m1.4.4.2.2.2.2.2.1.cmml" xref="alg1.18.18.1.m1.4.4.2.2.2.2.2.1"></plus><ci id="alg1.18.18.1.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.18.18.1.m1.4.4.2.2.2.2.2.2">𝑖</ci><cn type="integer" id="alg1.18.18.1.m1.4.4.2.2.2.2.2.3.cmml" xref="alg1.18.18.1.m1.4.4.2.2.2.2.2.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.1.m1.4c">i\coloneqq 0;i&lt;n;i\coloneqq i+1</annotation></semantics></math></em> <span id="alg1.18.18.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.19.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.19.19.m1.1" class="ltx_Math" alttext="r_{i}\coloneqq c_{i}\ominus c_{t}" display="inline"><semantics id="alg1.19.19.m1.1a"><mrow id="alg1.19.19.m1.1.1" xref="alg1.19.19.m1.1.1.cmml"><msub id="alg1.19.19.m1.1.1.2" xref="alg1.19.19.m1.1.1.2.cmml"><mi id="alg1.19.19.m1.1.1.2.2" xref="alg1.19.19.m1.1.1.2.2.cmml">r</mi><mi id="alg1.19.19.m1.1.1.2.3" xref="alg1.19.19.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.19.19.m1.1.1.1" xref="alg1.19.19.m1.1.1.1.cmml">≔</mo><mrow id="alg1.19.19.m1.1.1.3" xref="alg1.19.19.m1.1.1.3.cmml"><msub id="alg1.19.19.m1.1.1.3.2" xref="alg1.19.19.m1.1.1.3.2.cmml"><mi id="alg1.19.19.m1.1.1.3.2.2" xref="alg1.19.19.m1.1.1.3.2.2.cmml">c</mi><mi id="alg1.19.19.m1.1.1.3.2.3" xref="alg1.19.19.m1.1.1.3.2.3.cmml">i</mi></msub><mo id="alg1.19.19.m1.1.1.3.1" xref="alg1.19.19.m1.1.1.3.1.cmml">⊖</mo><msub id="alg1.19.19.m1.1.1.3.3" xref="alg1.19.19.m1.1.1.3.3.cmml"><mi id="alg1.19.19.m1.1.1.3.3.2" xref="alg1.19.19.m1.1.1.3.3.2.cmml">c</mi><mi id="alg1.19.19.m1.1.1.3.3.3" xref="alg1.19.19.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.19.19.m1.1b"><apply id="alg1.19.19.m1.1.1.cmml" xref="alg1.19.19.m1.1.1"><ci id="alg1.19.19.m1.1.1.1.cmml" xref="alg1.19.19.m1.1.1.1">≔</ci><apply id="alg1.19.19.m1.1.1.2.cmml" xref="alg1.19.19.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.2.1.cmml" xref="alg1.19.19.m1.1.1.2">subscript</csymbol><ci id="alg1.19.19.m1.1.1.2.2.cmml" xref="alg1.19.19.m1.1.1.2.2">𝑟</ci><ci id="alg1.19.19.m1.1.1.2.3.cmml" xref="alg1.19.19.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.19.19.m1.1.1.3.cmml" xref="alg1.19.19.m1.1.1.3"><csymbol cd="latexml" id="alg1.19.19.m1.1.1.3.1.cmml" xref="alg1.19.19.m1.1.1.3.1">symmetric-difference</csymbol><apply id="alg1.19.19.m1.1.1.3.2.cmml" xref="alg1.19.19.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.3.2.1.cmml" xref="alg1.19.19.m1.1.1.3.2">subscript</csymbol><ci id="alg1.19.19.m1.1.1.3.2.2.cmml" xref="alg1.19.19.m1.1.1.3.2.2">𝑐</ci><ci id="alg1.19.19.m1.1.1.3.2.3.cmml" xref="alg1.19.19.m1.1.1.3.2.3">𝑖</ci></apply><apply id="alg1.19.19.m1.1.1.3.3.cmml" xref="alg1.19.19.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.19.19.m1.1.1.3.3.1.cmml" xref="alg1.19.19.m1.1.1.3.3">subscript</csymbol><ci id="alg1.19.19.m1.1.1.3.3.2.cmml" xref="alg1.19.19.m1.1.1.3.3.2">𝑐</ci><ci id="alg1.19.19.m1.1.1.3.3.3.cmml" xref="alg1.19.19.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.m1.1c">r_{i}\coloneqq c_{i}\ominus c_{t}</annotation></semantics></math>
</div>
<div id="alg1.24.42" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.24.43" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29</span> end for
</div>
<div id="alg1.20.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30</span><math id="alg1.20.20.m1.2" class="ltx_Math" alttext="\textbf{t}[2^{\log n-1},2^{\log n-1}+n]\coloneqq\textbf{r}" display="inline"><semantics id="alg1.20.20.m1.2a"><mrow id="alg1.20.20.m1.2.2" xref="alg1.20.20.m1.2.2.cmml"><mrow id="alg1.20.20.m1.2.2.2" xref="alg1.20.20.m1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.20.20.m1.2.2.2.4" xref="alg1.20.20.m1.2.2.2.4a.cmml">t</mtext><mo lspace="0em" rspace="0em" id="alg1.20.20.m1.2.2.2.3" xref="alg1.20.20.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.20.20.m1.2.2.2.2.2" xref="alg1.20.20.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.20.20.m1.2.2.2.2.2.3" xref="alg1.20.20.m1.2.2.2.2.3.cmml">[</mo><msup id="alg1.20.20.m1.1.1.1.1.1.1" xref="alg1.20.20.m1.1.1.1.1.1.1.cmml"><mn id="alg1.20.20.m1.1.1.1.1.1.1.2" xref="alg1.20.20.m1.1.1.1.1.1.1.2.cmml">2</mn><mrow id="alg1.20.20.m1.1.1.1.1.1.1.3" xref="alg1.20.20.m1.1.1.1.1.1.1.3.cmml"><mrow id="alg1.20.20.m1.1.1.1.1.1.1.3.2" xref="alg1.20.20.m1.1.1.1.1.1.1.3.2.cmml"><mi id="alg1.20.20.m1.1.1.1.1.1.1.3.2.1" xref="alg1.20.20.m1.1.1.1.1.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="alg1.20.20.m1.1.1.1.1.1.1.3.2a" xref="alg1.20.20.m1.1.1.1.1.1.1.3.2.cmml">⁡</mo><mi id="alg1.20.20.m1.1.1.1.1.1.1.3.2.2" xref="alg1.20.20.m1.1.1.1.1.1.1.3.2.2.cmml">n</mi></mrow><mo id="alg1.20.20.m1.1.1.1.1.1.1.3.1" xref="alg1.20.20.m1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="alg1.20.20.m1.1.1.1.1.1.1.3.3" xref="alg1.20.20.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="alg1.20.20.m1.2.2.2.2.2.4" xref="alg1.20.20.m1.2.2.2.2.3.cmml">,</mo><mrow id="alg1.20.20.m1.2.2.2.2.2.2" xref="alg1.20.20.m1.2.2.2.2.2.2.cmml"><msup id="alg1.20.20.m1.2.2.2.2.2.2.2" xref="alg1.20.20.m1.2.2.2.2.2.2.2.cmml"><mn id="alg1.20.20.m1.2.2.2.2.2.2.2.2" xref="alg1.20.20.m1.2.2.2.2.2.2.2.2.cmml">2</mn><mrow id="alg1.20.20.m1.2.2.2.2.2.2.2.3" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.cmml"><mrow id="alg1.20.20.m1.2.2.2.2.2.2.2.3.2" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.2.cmml"><mi id="alg1.20.20.m1.2.2.2.2.2.2.2.3.2.1" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.2.1.cmml">log</mi><mo lspace="0.167em" id="alg1.20.20.m1.2.2.2.2.2.2.2.3.2a" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.2.cmml">⁡</mo><mi id="alg1.20.20.m1.2.2.2.2.2.2.2.3.2.2" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.2.2.cmml">n</mi></mrow><mo id="alg1.20.20.m1.2.2.2.2.2.2.2.3.1" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="alg1.20.20.m1.2.2.2.2.2.2.2.3.3" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msup><mo id="alg1.20.20.m1.2.2.2.2.2.2.1" xref="alg1.20.20.m1.2.2.2.2.2.2.1.cmml">+</mo><mi id="alg1.20.20.m1.2.2.2.2.2.2.3" xref="alg1.20.20.m1.2.2.2.2.2.2.3.cmml">n</mi></mrow><mo stretchy="false" id="alg1.20.20.m1.2.2.2.2.2.5" xref="alg1.20.20.m1.2.2.2.2.3.cmml">]</mo></mrow></mrow><mo id="alg1.20.20.m1.2.2.3" xref="alg1.20.20.m1.2.2.3.cmml">≔</mo><mtext class="ltx_mathvariant_bold" id="alg1.20.20.m1.2.2.4" xref="alg1.20.20.m1.2.2.4a.cmml">r</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.20.20.m1.2b"><apply id="alg1.20.20.m1.2.2.cmml" xref="alg1.20.20.m1.2.2"><ci id="alg1.20.20.m1.2.2.3.cmml" xref="alg1.20.20.m1.2.2.3">≔</ci><apply id="alg1.20.20.m1.2.2.2.cmml" xref="alg1.20.20.m1.2.2.2"><times id="alg1.20.20.m1.2.2.2.3.cmml" xref="alg1.20.20.m1.2.2.2.3"></times><ci id="alg1.20.20.m1.2.2.2.4a.cmml" xref="alg1.20.20.m1.2.2.2.4"><mtext class="ltx_mathvariant_bold" id="alg1.20.20.m1.2.2.2.4.cmml" xref="alg1.20.20.m1.2.2.2.4">t</mtext></ci><interval closure="closed" id="alg1.20.20.m1.2.2.2.2.3.cmml" xref="alg1.20.20.m1.2.2.2.2.2"><apply id="alg1.20.20.m1.1.1.1.1.1.1.cmml" xref="alg1.20.20.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.20.20.m1.1.1.1.1.1.1.1.cmml" xref="alg1.20.20.m1.1.1.1.1.1.1">superscript</csymbol><cn type="integer" id="alg1.20.20.m1.1.1.1.1.1.1.2.cmml" xref="alg1.20.20.m1.1.1.1.1.1.1.2">2</cn><apply id="alg1.20.20.m1.1.1.1.1.1.1.3.cmml" xref="alg1.20.20.m1.1.1.1.1.1.1.3"><minus id="alg1.20.20.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.20.20.m1.1.1.1.1.1.1.3.1"></minus><apply id="alg1.20.20.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.20.20.m1.1.1.1.1.1.1.3.2"><log id="alg1.20.20.m1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.20.20.m1.1.1.1.1.1.1.3.2.1"></log><ci id="alg1.20.20.m1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.20.20.m1.1.1.1.1.1.1.3.2.2">𝑛</ci></apply><cn type="integer" id="alg1.20.20.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.20.20.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.20.20.m1.2.2.2.2.2.2.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2"><plus id="alg1.20.20.m1.2.2.2.2.2.2.1.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2.1"></plus><apply id="alg1.20.20.m1.2.2.2.2.2.2.2.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.20.20.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2.2">superscript</csymbol><cn type="integer" id="alg1.20.20.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2.2.2">2</cn><apply id="alg1.20.20.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3"><minus id="alg1.20.20.m1.2.2.2.2.2.2.2.3.1.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.1"></minus><apply id="alg1.20.20.m1.2.2.2.2.2.2.2.3.2.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.2"><log id="alg1.20.20.m1.2.2.2.2.2.2.2.3.2.1.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.2.1"></log><ci id="alg1.20.20.m1.2.2.2.2.2.2.2.3.2.2.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.2.2">𝑛</ci></apply><cn type="integer" id="alg1.20.20.m1.2.2.2.2.2.2.2.3.3.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="alg1.20.20.m1.2.2.2.2.2.2.3.cmml" xref="alg1.20.20.m1.2.2.2.2.2.2.3">𝑛</ci></apply></interval></apply><ci id="alg1.20.20.m1.2.2.4a.cmml" xref="alg1.20.20.m1.2.2.4"><mtext class="ltx_mathvariant_bold" id="alg1.20.20.m1.2.2.4.cmml" xref="alg1.20.20.m1.2.2.4">r</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.20.m1.2c">\textbf{t}[2^{\log n-1},2^{\log n-1}+n]\coloneqq\textbf{r}</annotation></semantics></math>
</div>
<div id="alg1.21.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31</span>
<math id="alg1.21.21.m1.1" class="ltx_Math" alttext="\textbf{c}\coloneqq\textbf{r}" display="inline"><semantics id="alg1.21.21.m1.1a"><mrow id="alg1.21.21.m1.1.1" xref="alg1.21.21.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.21.21.m1.1.1.2" xref="alg1.21.21.m1.1.1.2a.cmml">c</mtext><mo id="alg1.21.21.m1.1.1.1" xref="alg1.21.21.m1.1.1.1.cmml">≔</mo><mtext class="ltx_mathvariant_bold" id="alg1.21.21.m1.1.1.3" xref="alg1.21.21.m1.1.1.3a.cmml">r</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.21.21.m1.1b"><apply id="alg1.21.21.m1.1.1.cmml" xref="alg1.21.21.m1.1.1"><ci id="alg1.21.21.m1.1.1.1.cmml" xref="alg1.21.21.m1.1.1.1">≔</ci><ci id="alg1.21.21.m1.1.1.2a.cmml" xref="alg1.21.21.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="alg1.21.21.m1.1.1.2.cmml" xref="alg1.21.21.m1.1.1.2">c</mtext></ci><ci id="alg1.21.21.m1.1.1.3a.cmml" xref="alg1.21.21.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="alg1.21.21.m1.1.1.3.cmml" xref="alg1.21.21.m1.1.1.3">r</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.21.m1.1c">\textbf{c}\coloneqq\textbf{r}</annotation></semantics></math>
</div>
<div id="alg1.22.22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">32</span>
<span id="alg1.22.22.2" class="ltx_text ltx_font_bold">for</span> <em id="alg1.22.22.1" class="ltx_emph ltx_font_italic"><math id="alg1.22.22.1.m1.4" class="ltx_Math" alttext="l\coloneqq\log|\textbf{c}|-1;l&gt;=0;l\coloneqq l-1" display="inline"><semantics id="alg1.22.22.1.m1.4a"><mrow id="alg1.22.22.1.m1.4.4.2" xref="alg1.22.22.1.m1.4.4.3.cmml"><mrow id="alg1.22.22.1.m1.3.3.1.1" xref="alg1.22.22.1.m1.3.3.1.1.cmml"><mi id="alg1.22.22.1.m1.3.3.1.1.2" xref="alg1.22.22.1.m1.3.3.1.1.2.cmml">l</mi><mo id="alg1.22.22.1.m1.3.3.1.1.1" xref="alg1.22.22.1.m1.3.3.1.1.1.cmml">≔</mo><mrow id="alg1.22.22.1.m1.3.3.1.1.3" xref="alg1.22.22.1.m1.3.3.1.1.3.cmml"><mrow id="alg1.22.22.1.m1.3.3.1.1.3.2" xref="alg1.22.22.1.m1.3.3.1.1.3.2.cmml"><mi id="alg1.22.22.1.m1.3.3.1.1.3.2.1" xref="alg1.22.22.1.m1.3.3.1.1.3.2.1.cmml">log</mi><mo id="alg1.22.22.1.m1.3.3.1.1.3.2a" xref="alg1.22.22.1.m1.3.3.1.1.3.2.cmml">⁡</mo><mrow id="alg1.22.22.1.m1.3.3.1.1.3.2.2.2" xref="alg1.22.22.1.m1.3.3.1.1.3.2.2.1.cmml"><mo stretchy="false" id="alg1.22.22.1.m1.3.3.1.1.3.2.2.2.1" xref="alg1.22.22.1.m1.3.3.1.1.3.2.2.1.1.cmml">|</mo><mtext class="ltx_mathvariant_bold" id="alg1.22.22.1.m1.2.2" xref="alg1.22.22.1.m1.2.2b.cmml"><em id="alg1.22.22.1.m1.2.2.1nest" class="ltx_emph ltx_font_bold">c</em></mtext><mo stretchy="false" id="alg1.22.22.1.m1.3.3.1.1.3.2.2.2.2" xref="alg1.22.22.1.m1.3.3.1.1.3.2.2.1.1.cmml">|</mo></mrow></mrow><mo id="alg1.22.22.1.m1.3.3.1.1.3.1" xref="alg1.22.22.1.m1.3.3.1.1.3.1.cmml">−</mo><mn id="alg1.22.22.1.m1.3.3.1.1.3.3" xref="alg1.22.22.1.m1.3.3.1.1.3.3.cmml">1</mn></mrow></mrow><mo id="alg1.22.22.1.m1.4.4.2.3" xref="alg1.22.22.1.m1.4.4.3a.cmml">;</mo><mrow id="alg1.22.22.1.m1.4.4.2.2.2" xref="alg1.22.22.1.m1.4.4.2.2.3.cmml"><mrow id="alg1.22.22.1.m1.4.4.2.2.1.1" xref="alg1.22.22.1.m1.4.4.2.2.1.1.cmml"><mi id="alg1.22.22.1.m1.1.1" xref="alg1.22.22.1.m1.1.1.cmml">l</mi><mo lspace="0.278em" rspace="0.278em" id="alg1.22.22.1.m1.4.4.2.2.1.1.1" xref="alg1.22.22.1.m1.4.4.2.2.1.1.1.cmml">&gt;=</mo><mn id="alg1.22.22.1.m1.4.4.2.2.1.1.2" xref="alg1.22.22.1.m1.4.4.2.2.1.1.2.cmml">0</mn></mrow><mo id="alg1.22.22.1.m1.4.4.2.2.2.3" xref="alg1.22.22.1.m1.4.4.2.2.3a.cmml">;</mo><mrow id="alg1.22.22.1.m1.4.4.2.2.2.2" xref="alg1.22.22.1.m1.4.4.2.2.2.2.cmml"><mi id="alg1.22.22.1.m1.4.4.2.2.2.2.2" xref="alg1.22.22.1.m1.4.4.2.2.2.2.2.cmml">l</mi><mo id="alg1.22.22.1.m1.4.4.2.2.2.2.1" xref="alg1.22.22.1.m1.4.4.2.2.2.2.1.cmml">≔</mo><mrow id="alg1.22.22.1.m1.4.4.2.2.2.2.3" xref="alg1.22.22.1.m1.4.4.2.2.2.2.3.cmml"><mi id="alg1.22.22.1.m1.4.4.2.2.2.2.3.2" xref="alg1.22.22.1.m1.4.4.2.2.2.2.3.2.cmml">l</mi><mo id="alg1.22.22.1.m1.4.4.2.2.2.2.3.1" xref="alg1.22.22.1.m1.4.4.2.2.2.2.3.1.cmml">−</mo><mn id="alg1.22.22.1.m1.4.4.2.2.2.2.3.3" xref="alg1.22.22.1.m1.4.4.2.2.2.2.3.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.22.22.1.m1.4b"><apply id="alg1.22.22.1.m1.4.4.3.cmml" xref="alg1.22.22.1.m1.4.4.2"><csymbol cd="ambiguous" id="alg1.22.22.1.m1.4.4.3a.cmml" xref="alg1.22.22.1.m1.4.4.2.3">formulae-sequence</csymbol><apply id="alg1.22.22.1.m1.3.3.1.1.cmml" xref="alg1.22.22.1.m1.3.3.1.1"><ci id="alg1.22.22.1.m1.3.3.1.1.1.cmml" xref="alg1.22.22.1.m1.3.3.1.1.1">≔</ci><ci id="alg1.22.22.1.m1.3.3.1.1.2.cmml" xref="alg1.22.22.1.m1.3.3.1.1.2">𝑙</ci><apply id="alg1.22.22.1.m1.3.3.1.1.3.cmml" xref="alg1.22.22.1.m1.3.3.1.1.3"><minus id="alg1.22.22.1.m1.3.3.1.1.3.1.cmml" xref="alg1.22.22.1.m1.3.3.1.1.3.1"></minus><apply id="alg1.22.22.1.m1.3.3.1.1.3.2.cmml" xref="alg1.22.22.1.m1.3.3.1.1.3.2"><log id="alg1.22.22.1.m1.3.3.1.1.3.2.1.cmml" xref="alg1.22.22.1.m1.3.3.1.1.3.2.1"></log><apply id="alg1.22.22.1.m1.3.3.1.1.3.2.2.1.cmml" xref="alg1.22.22.1.m1.3.3.1.1.3.2.2.2"><abs id="alg1.22.22.1.m1.3.3.1.1.3.2.2.1.1.cmml" xref="alg1.22.22.1.m1.3.3.1.1.3.2.2.2.1"></abs><ci id="alg1.22.22.1.m1.2.2b.cmml" xref="alg1.22.22.1.m1.2.2"><mtext class="ltx_mathvariant_bold" id="alg1.22.22.1.m1.2.2.cmml" xref="alg1.22.22.1.m1.2.2"><em id="alg1.22.22.1.m1.2.2.1anest" class="ltx_emph ltx_font_bold">c</em></mtext></ci></apply></apply><cn type="integer" id="alg1.22.22.1.m1.3.3.1.1.3.3.cmml" xref="alg1.22.22.1.m1.3.3.1.1.3.3">1</cn></apply></apply><apply id="alg1.22.22.1.m1.4.4.2.2.3.cmml" xref="alg1.22.22.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.22.22.1.m1.4.4.2.2.3a.cmml" xref="alg1.22.22.1.m1.4.4.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.22.22.1.m1.4.4.2.2.1.1.cmml" xref="alg1.22.22.1.m1.4.4.2.2.1.1"><geq id="alg1.22.22.1.m1.4.4.2.2.1.1.1.cmml" xref="alg1.22.22.1.m1.4.4.2.2.1.1.1"></geq><ci id="alg1.22.22.1.m1.1.1.cmml" xref="alg1.22.22.1.m1.1.1">𝑙</ci><cn type="integer" id="alg1.22.22.1.m1.4.4.2.2.1.1.2.cmml" xref="alg1.22.22.1.m1.4.4.2.2.1.1.2">0</cn></apply><apply id="alg1.22.22.1.m1.4.4.2.2.2.2.cmml" xref="alg1.22.22.1.m1.4.4.2.2.2.2"><ci id="alg1.22.22.1.m1.4.4.2.2.2.2.1.cmml" xref="alg1.22.22.1.m1.4.4.2.2.2.2.1">≔</ci><ci id="alg1.22.22.1.m1.4.4.2.2.2.2.2.cmml" xref="alg1.22.22.1.m1.4.4.2.2.2.2.2">𝑙</ci><apply id="alg1.22.22.1.m1.4.4.2.2.2.2.3.cmml" xref="alg1.22.22.1.m1.4.4.2.2.2.2.3"><minus id="alg1.22.22.1.m1.4.4.2.2.2.2.3.1.cmml" xref="alg1.22.22.1.m1.4.4.2.2.2.2.3.1"></minus><ci id="alg1.22.22.1.m1.4.4.2.2.2.2.3.2.cmml" xref="alg1.22.22.1.m1.4.4.2.2.2.2.3.2">𝑙</ci><cn type="integer" id="alg1.22.22.1.m1.4.4.2.2.2.2.3.3.cmml" xref="alg1.22.22.1.m1.4.4.2.2.2.2.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.22.1.m1.4c">l\coloneqq\log|\textbf{c}|-1;l&gt;=0;l\coloneqq l-1</annotation></semantics></math></em> <span id="alg1.22.22.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg1.23.23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">33</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.23.23.m1.3" class="ltx_Math" alttext="\textbf{t}[2^{l},2^{l}+n]\coloneqq\texttt{PairwiseMul}(\textbf{c})" display="inline"><semantics id="alg1.23.23.m1.3a"><mrow id="alg1.23.23.m1.3.3" xref="alg1.23.23.m1.3.3.cmml"><mrow id="alg1.23.23.m1.3.3.2" xref="alg1.23.23.m1.3.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.23.23.m1.3.3.2.4" xref="alg1.23.23.m1.3.3.2.4a.cmml">t</mtext><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.3.3.2.3" xref="alg1.23.23.m1.3.3.2.3.cmml">​</mo><mrow id="alg1.23.23.m1.3.3.2.2.2" xref="alg1.23.23.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="alg1.23.23.m1.3.3.2.2.2.3" xref="alg1.23.23.m1.3.3.2.2.3.cmml">[</mo><msup id="alg1.23.23.m1.2.2.1.1.1.1" xref="alg1.23.23.m1.2.2.1.1.1.1.cmml"><mn id="alg1.23.23.m1.2.2.1.1.1.1.2" xref="alg1.23.23.m1.2.2.1.1.1.1.2.cmml">2</mn><mi id="alg1.23.23.m1.2.2.1.1.1.1.3" xref="alg1.23.23.m1.2.2.1.1.1.1.3.cmml">l</mi></msup><mo id="alg1.23.23.m1.3.3.2.2.2.4" xref="alg1.23.23.m1.3.3.2.2.3.cmml">,</mo><mrow id="alg1.23.23.m1.3.3.2.2.2.2" xref="alg1.23.23.m1.3.3.2.2.2.2.cmml"><msup id="alg1.23.23.m1.3.3.2.2.2.2.2" xref="alg1.23.23.m1.3.3.2.2.2.2.2.cmml"><mn id="alg1.23.23.m1.3.3.2.2.2.2.2.2" xref="alg1.23.23.m1.3.3.2.2.2.2.2.2.cmml">2</mn><mi id="alg1.23.23.m1.3.3.2.2.2.2.2.3" xref="alg1.23.23.m1.3.3.2.2.2.2.2.3.cmml">l</mi></msup><mo id="alg1.23.23.m1.3.3.2.2.2.2.1" xref="alg1.23.23.m1.3.3.2.2.2.2.1.cmml">+</mo><mi id="alg1.23.23.m1.3.3.2.2.2.2.3" xref="alg1.23.23.m1.3.3.2.2.2.2.3.cmml">n</mi></mrow><mo stretchy="false" id="alg1.23.23.m1.3.3.2.2.2.5" xref="alg1.23.23.m1.3.3.2.2.3.cmml">]</mo></mrow></mrow><mo id="alg1.23.23.m1.3.3.3" xref="alg1.23.23.m1.3.3.3.cmml">≔</mo><mrow id="alg1.23.23.m1.3.3.4" xref="alg1.23.23.m1.3.3.4.cmml"><mtext class="ltx_mathvariant_monospace" id="alg1.23.23.m1.3.3.4.2" xref="alg1.23.23.m1.3.3.4.2a.cmml">PairwiseMul</mtext><mo lspace="0em" rspace="0em" id="alg1.23.23.m1.3.3.4.1" xref="alg1.23.23.m1.3.3.4.1.cmml">​</mo><mrow id="alg1.23.23.m1.3.3.4.3.2" xref="alg1.23.23.m1.1.1a.cmml"><mo stretchy="false" id="alg1.23.23.m1.3.3.4.3.2.1" xref="alg1.23.23.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="alg1.23.23.m1.1.1" xref="alg1.23.23.m1.1.1.cmml">c</mtext><mo stretchy="false" id="alg1.23.23.m1.3.3.4.3.2.2" xref="alg1.23.23.m1.1.1a.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.23.23.m1.3b"><apply id="alg1.23.23.m1.3.3.cmml" xref="alg1.23.23.m1.3.3"><ci id="alg1.23.23.m1.3.3.3.cmml" xref="alg1.23.23.m1.3.3.3">≔</ci><apply id="alg1.23.23.m1.3.3.2.cmml" xref="alg1.23.23.m1.3.3.2"><times id="alg1.23.23.m1.3.3.2.3.cmml" xref="alg1.23.23.m1.3.3.2.3"></times><ci id="alg1.23.23.m1.3.3.2.4a.cmml" xref="alg1.23.23.m1.3.3.2.4"><mtext class="ltx_mathvariant_bold" id="alg1.23.23.m1.3.3.2.4.cmml" xref="alg1.23.23.m1.3.3.2.4">t</mtext></ci><interval closure="closed" id="alg1.23.23.m1.3.3.2.2.3.cmml" xref="alg1.23.23.m1.3.3.2.2.2"><apply id="alg1.23.23.m1.2.2.1.1.1.1.cmml" xref="alg1.23.23.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.23.23.m1.2.2.1.1.1.1.1.cmml" xref="alg1.23.23.m1.2.2.1.1.1.1">superscript</csymbol><cn type="integer" id="alg1.23.23.m1.2.2.1.1.1.1.2.cmml" xref="alg1.23.23.m1.2.2.1.1.1.1.2">2</cn><ci id="alg1.23.23.m1.2.2.1.1.1.1.3.cmml" xref="alg1.23.23.m1.2.2.1.1.1.1.3">𝑙</ci></apply><apply id="alg1.23.23.m1.3.3.2.2.2.2.cmml" xref="alg1.23.23.m1.3.3.2.2.2.2"><plus id="alg1.23.23.m1.3.3.2.2.2.2.1.cmml" xref="alg1.23.23.m1.3.3.2.2.2.2.1"></plus><apply id="alg1.23.23.m1.3.3.2.2.2.2.2.cmml" xref="alg1.23.23.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.23.23.m1.3.3.2.2.2.2.2.1.cmml" xref="alg1.23.23.m1.3.3.2.2.2.2.2">superscript</csymbol><cn type="integer" id="alg1.23.23.m1.3.3.2.2.2.2.2.2.cmml" xref="alg1.23.23.m1.3.3.2.2.2.2.2.2">2</cn><ci id="alg1.23.23.m1.3.3.2.2.2.2.2.3.cmml" xref="alg1.23.23.m1.3.3.2.2.2.2.2.3">𝑙</ci></apply><ci id="alg1.23.23.m1.3.3.2.2.2.2.3.cmml" xref="alg1.23.23.m1.3.3.2.2.2.2.3">𝑛</ci></apply></interval></apply><apply id="alg1.23.23.m1.3.3.4.cmml" xref="alg1.23.23.m1.3.3.4"><times id="alg1.23.23.m1.3.3.4.1.cmml" xref="alg1.23.23.m1.3.3.4.1"></times><ci id="alg1.23.23.m1.3.3.4.2a.cmml" xref="alg1.23.23.m1.3.3.4.2"><mtext class="ltx_mathvariant_monospace" id="alg1.23.23.m1.3.3.4.2.cmml" xref="alg1.23.23.m1.3.3.4.2">PairwiseMul</mtext></ci><ci id="alg1.23.23.m1.1.1a.cmml" xref="alg1.23.23.m1.3.3.4.3.2"><mtext class="ltx_mathvariant_bold" id="alg1.23.23.m1.1.1.cmml" xref="alg1.23.23.m1.1.1">c</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.23.m1.3c">\textbf{t}[2^{l},2^{l}+n]\coloneqq\texttt{PairwiseMul}(\textbf{c})</annotation></semantics></math>
</div>
<div id="alg1.24.24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">34</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg1.24.24.m1.2" class="ltx_Math" alttext="\textbf{c}\coloneqq\textbf{t}[2^{l},2^{l}+n]" display="inline"><semantics id="alg1.24.24.m1.2a"><mrow id="alg1.24.24.m1.2.2" xref="alg1.24.24.m1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.24.24.m1.2.2.4" xref="alg1.24.24.m1.2.2.4a.cmml">c</mtext><mo id="alg1.24.24.m1.2.2.3" xref="alg1.24.24.m1.2.2.3.cmml">≔</mo><mrow id="alg1.24.24.m1.2.2.2" xref="alg1.24.24.m1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.24.24.m1.2.2.2.4" xref="alg1.24.24.m1.2.2.2.4a.cmml">t</mtext><mo lspace="0em" rspace="0em" id="alg1.24.24.m1.2.2.2.3" xref="alg1.24.24.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.24.24.m1.2.2.2.2.2" xref="alg1.24.24.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.24.24.m1.2.2.2.2.2.3" xref="alg1.24.24.m1.2.2.2.2.3.cmml">[</mo><msup id="alg1.24.24.m1.1.1.1.1.1.1" xref="alg1.24.24.m1.1.1.1.1.1.1.cmml"><mn id="alg1.24.24.m1.1.1.1.1.1.1.2" xref="alg1.24.24.m1.1.1.1.1.1.1.2.cmml">2</mn><mi id="alg1.24.24.m1.1.1.1.1.1.1.3" xref="alg1.24.24.m1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="alg1.24.24.m1.2.2.2.2.2.4" xref="alg1.24.24.m1.2.2.2.2.3.cmml">,</mo><mrow id="alg1.24.24.m1.2.2.2.2.2.2" xref="alg1.24.24.m1.2.2.2.2.2.2.cmml"><msup id="alg1.24.24.m1.2.2.2.2.2.2.2" xref="alg1.24.24.m1.2.2.2.2.2.2.2.cmml"><mn id="alg1.24.24.m1.2.2.2.2.2.2.2.2" xref="alg1.24.24.m1.2.2.2.2.2.2.2.2.cmml">2</mn><mi id="alg1.24.24.m1.2.2.2.2.2.2.2.3" xref="alg1.24.24.m1.2.2.2.2.2.2.2.3.cmml">l</mi></msup><mo id="alg1.24.24.m1.2.2.2.2.2.2.1" xref="alg1.24.24.m1.2.2.2.2.2.2.1.cmml">+</mo><mi id="alg1.24.24.m1.2.2.2.2.2.2.3" xref="alg1.24.24.m1.2.2.2.2.2.2.3.cmml">n</mi></mrow><mo stretchy="false" id="alg1.24.24.m1.2.2.2.2.2.5" xref="alg1.24.24.m1.2.2.2.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.24.24.m1.2b"><apply id="alg1.24.24.m1.2.2.cmml" xref="alg1.24.24.m1.2.2"><ci id="alg1.24.24.m1.2.2.3.cmml" xref="alg1.24.24.m1.2.2.3">≔</ci><ci id="alg1.24.24.m1.2.2.4a.cmml" xref="alg1.24.24.m1.2.2.4"><mtext class="ltx_mathvariant_bold" id="alg1.24.24.m1.2.2.4.cmml" xref="alg1.24.24.m1.2.2.4">c</mtext></ci><apply id="alg1.24.24.m1.2.2.2.cmml" xref="alg1.24.24.m1.2.2.2"><times id="alg1.24.24.m1.2.2.2.3.cmml" xref="alg1.24.24.m1.2.2.2.3"></times><ci id="alg1.24.24.m1.2.2.2.4a.cmml" xref="alg1.24.24.m1.2.2.2.4"><mtext class="ltx_mathvariant_bold" id="alg1.24.24.m1.2.2.2.4.cmml" xref="alg1.24.24.m1.2.2.2.4">t</mtext></ci><interval closure="closed" id="alg1.24.24.m1.2.2.2.2.3.cmml" xref="alg1.24.24.m1.2.2.2.2.2"><apply id="alg1.24.24.m1.1.1.1.1.1.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.24.24.m1.1.1.1.1.1.1.1.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1">superscript</csymbol><cn type="integer" id="alg1.24.24.m1.1.1.1.1.1.1.2.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.2">2</cn><ci id="alg1.24.24.m1.1.1.1.1.1.1.3.cmml" xref="alg1.24.24.m1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="alg1.24.24.m1.2.2.2.2.2.2.cmml" xref="alg1.24.24.m1.2.2.2.2.2.2"><plus id="alg1.24.24.m1.2.2.2.2.2.2.1.cmml" xref="alg1.24.24.m1.2.2.2.2.2.2.1"></plus><apply id="alg1.24.24.m1.2.2.2.2.2.2.2.cmml" xref="alg1.24.24.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.24.24.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.24.24.m1.2.2.2.2.2.2.2">superscript</csymbol><cn type="integer" id="alg1.24.24.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.24.24.m1.2.2.2.2.2.2.2.2">2</cn><ci id="alg1.24.24.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.24.24.m1.2.2.2.2.2.2.2.3">𝑙</ci></apply><ci id="alg1.24.24.m1.2.2.2.2.2.2.3.cmml" xref="alg1.24.24.m1.2.2.2.2.2.2.3">𝑛</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.24.m1.2c">\textbf{c}\coloneqq\textbf{t}[2^{l},2^{l}+n]</annotation></semantics></math>
</div>
<div id="alg1.24.44" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">35</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg1.24.45" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">36</span> end for
</div>
<div id="alg1.24.46" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">37</span><span id="alg1.24.46.1" class="ltx_text ltx_font_bold">return</span> <span id="alg1.24.46.2" class="ltx_text ltx_font_bold">t</span>
</div>
<div id="alg1.24.47" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">38</span>

</div>
<div id="alg1.24.48" class="ltx_listingline">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.26.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Server Processing</figcaption>
</figure>
<div id="Sx3.SSx4.SSSx1.p2" class="ltx_para">
<p id="Sx3.SSx4.SSSx1.p2.1" class="ltx_p">The algorithm commences with a function called <span id="Sx3.SSx4.SSSx1.p2.1.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">PairwiseMul</span>, which operates on an array of ciphertexts. This function performs pairwise multiplication of consecutive ciphertexts, optimizing the process for computational efficiency. The main loop then iterates through the ciphertexts, calculating the differences between each ciphertext and the target ciphertext using homomorphic subtraction. These differences are recorded in an array. The subsequent steps focus on constructing the binary tree, which serves as the foundation for the search operation. The tree initialization phase assigns the calculated differences to a specific interval within the tree.</p>
</div>
<div id="Sx3.SSx4.SSSx1.p3" class="ltx_para">
<p id="Sx3.SSx4.SSSx1.p3.1" class="ltx_p">As the binary tree is constructed, the algorithm capitalizes on the <span id="Sx3.SSx4.SSSx1.p3.1.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">PairwiseMul</span> function to generate intermediate nodes. Starting from the highest level of the tree and working downwards, the algorithm computes pairwise multiplications of ciphertexts within specified intervals, filling in the tree with computed values. This process iterates for each level of the tree, ultimately resulting in a fully constructed binary tree.</p>
</div>
<div id="Sx3.SSx4.SSSx1.p4" class="ltx_para">
<p id="Sx3.SSx4.SSSx1.p4.1" class="ltx_p">Once the binary tree construction concludes, the algorithm returns the complete tree structure. This tree is now equipped for subsequent search operations, enabling secure and efficient querying of the encrypted values. Overall, the Server Processing algorithm showcases the orchestration of homomorphic encryption techniques and binary tree structures to enable privacy-preserving and secure search operations within a federated learning context.</p>
</div>
</section>
<section id="Sx3.SSx4.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Correctness</h4>

<div id="Sx3.SSx4.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx2.p1.1" class="ltx_p">The correctness of the Alg. <a href="#alg1" title="In Description ‣ Server Processing ‣ Search over CKKS Ciphertexts ‣ Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> is grounded in its meticulous design and the mathematical properties of homomorphic encryption. The algorithm meticulously constructs a binary tree where each node encapsulates relevant information derived from the encrypted ciphertexts. The <span id="Sx3.SSx4.SSSx2.p1.1.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">PairwiseMul</span> function ensures that the multiplicative operations on ciphertexts are executed accurately, maintaining the integrity of the computations.</p>
</div>
<div id="Sx3.SSx4.SSSx2.p2" class="ltx_para">
<p id="Sx3.SSx4.SSSx2.p2.1" class="ltx_p">The algorithm’s fidelity is bolstered by the fundamental property of homomorphic encryption, which guarantees that operations on encrypted data yield results that correspond to those obtained from the same operations on the underlying plaintexts. As the algorithm progresses, it appropriately applies homomorphic subtraction and multiplication operations to derive the differences between ciphertexts and the target ciphertext. These operations, executed within the homomorphic encryption framework, maintain the confidentiality of the data and uphold the mathematical consistency between ciphertexts and plaintexts.</p>
</div>
<div id="Sx3.SSx4.SSSx2.p3" class="ltx_para">
<p id="Sx3.SSx4.SSSx2.p3.1" class="ltx_p">Additionally, the binary tree structure is adeptly utilized to aggregate the intermediate results of these operations. The algorithm’s approach of gradually constructing the tree, starting from individual ciphertext differences and culminating in a fully formed binary tree, adheres to sound principles of encryption and secure computation. By leveraging the power of homomorphic encryption and employing a systematic tree-building process, the algorithm ensures the accuracy and privacy-preserving nature of its operations, thus justifying its correctness within the context of secure and efficient federated learning scenarios.</p>
</div>
</section>
<section id="Sx3.SSx4.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Complexity</h4>

<div id="Sx3.SSx4.SSSx3.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx3.p1.3" class="ltx_p">The time complexity of Alg. <a href="#alg1" title="In Description ‣ Server Processing ‣ Search over CKKS Ciphertexts ‣ Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> is driven by the operations performed within its iterative loops and function calls. The initial loop, traversing through the set of ciphertexts, incurs a linear time complexity of <math id="Sx3.SSx4.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{O}(n)" display="inline"><semantics id="Sx3.SSx4.SSSx3.p1.1.m1.1a"><mrow id="Sx3.SSx4.SSSx3.p1.1.m1.1.2" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx3.p1.1.m1.1.2.2" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.2.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx3.p1.1.m1.1.2.1" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.2.1.cmml">​</mo><mrow id="Sx3.SSx4.SSSx3.p1.1.m1.1.2.3.2" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx3.p1.1.m1.1.2.3.2.1" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.2.cmml">(</mo><mi id="Sx3.SSx4.SSSx3.p1.1.m1.1.1" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.1.cmml">n</mi><mo stretchy="false" id="Sx3.SSx4.SSSx3.p1.1.m1.1.2.3.2.2" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx3.p1.1.m1.1b"><apply id="Sx3.SSx4.SSSx3.p1.1.m1.1.2.cmml" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.2"><times id="Sx3.SSx4.SSSx3.p1.1.m1.1.2.1.cmml" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.2.1"></times><ci id="Sx3.SSx4.SSSx3.p1.1.m1.1.2.2.cmml" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.2.2">𝒪</ci><ci id="Sx3.SSx4.SSSx3.p1.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx3.p1.1.m1.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx3.p1.1.m1.1c">\mathcal{O}(n)</annotation></semantics></math>, where <math id="Sx3.SSx4.SSSx3.p1.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="Sx3.SSx4.SSSx3.p1.2.m2.1a"><mi id="Sx3.SSx4.SSSx3.p1.2.m2.1.1" xref="Sx3.SSx4.SSSx3.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx3.p1.2.m2.1b"><ci id="Sx3.SSx4.SSSx3.p1.2.m2.1.1.cmml" xref="Sx3.SSx4.SSSx3.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx3.p1.2.m2.1c">n</annotation></semantics></math> represents the number of ciphertexts. Within this loop, the homomorphic subtraction operation and subsequent operations involving the <span id="Sx3.SSx4.SSSx3.p1.3.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">PairwiseMul</span> function contribute constant time overhead. As a result, the time complexity of this segment remains linear.</p>
</div>
<div id="Sx3.SSx4.SSSx3.p2" class="ltx_para">
<p id="Sx3.SSx4.SSSx3.p2.3" class="ltx_p">The subsequent steps of initializing and constructing the binary tree encompass additional iterations and function calls. The binary tree construction loop iterates logarithmically, with the number of iterations determined by the logarithm of the length of the array containing ciphertext differences. This results in a time complexity of <math id="Sx3.SSx4.SSSx3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{O}(\log n)" display="inline"><semantics id="Sx3.SSx4.SSSx3.p2.1.m1.1a"><mrow id="Sx3.SSx4.SSSx3.p2.1.m1.1.1" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.3" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.2" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.2.cmml">​</mo><mrow id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.2" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.cmml"><mi id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.1" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.1.cmml">log</mi><mo lspace="0.167em" id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1a" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.cmml">⁡</mo><mi id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.2" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.2.cmml">n</mi></mrow><mo stretchy="false" id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.3" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx3.p2.1.m1.1b"><apply id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1"><times id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.2.cmml" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.2"></times><ci id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.3.cmml" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.3">𝒪</ci><apply id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1"><log id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.1"></log><ci id="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.2.cmml" xref="Sx3.SSx4.SSSx3.p2.1.m1.1.1.1.1.1.2">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx3.p2.1.m1.1c">\mathcal{O}(\log n)</annotation></semantics></math>. The <span id="Sx3.SSx4.SSSx3.p2.3.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">PairwiseMul</span> function’s execution also adds a constant factor to the time complexity within this loop. Overall, due to its dependence on the logarithmic and linear components, Alg. <a href="#alg1" title="In Description ‣ Server Processing ‣ Search over CKKS Ciphertexts ‣ Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> exhibits a time complexity of <math id="Sx3.SSx4.SSSx3.p2.3.m3.2" class="ltx_Math" alttext="\mathcal{O}(n+\log n)=\mathcal{O}(n)" display="inline"><semantics id="Sx3.SSx4.SSSx3.p2.3.m3.2a"><mrow id="Sx3.SSx4.SSSx3.p2.3.m3.2.2" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.cmml"><mrow id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.3" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.2" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.2.cmml">​</mo><mrow id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.2" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.cmml"><mi id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.2" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.2.cmml">n</mi><mo id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.1" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.1.cmml">+</mo><mrow id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3.cmml"><mi id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3.1" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3a" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3.cmml">⁡</mo><mi id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3.2" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo stretchy="false" id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.3" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.2" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.2.cmml">=</mo><mrow id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.2" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.1" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.1.cmml">​</mo><mrow id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.3.2" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.3.2.1" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.cmml">(</mo><mi id="Sx3.SSx4.SSSx3.p2.3.m3.1.1" xref="Sx3.SSx4.SSSx3.p2.3.m3.1.1.cmml">n</mi><mo stretchy="false" id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.3.2.2" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx3.p2.3.m3.2b"><apply id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2"><eq id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.2.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.2"></eq><apply id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1"><times id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.2.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.2"></times><ci id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.3.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.3">𝒪</ci><apply id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1"><plus id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.1.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.1"></plus><ci id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.2.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.2">𝑛</ci><apply id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3"><log id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3.1.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3.1"></log><ci id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3.2.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.1.1.1.1.3.2">𝑛</ci></apply></apply></apply><apply id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3"><times id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.1.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.1"></times><ci id="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.2.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.2.2.3.2">𝒪</ci><ci id="Sx3.SSx4.SSSx3.p2.3.m3.1.1.cmml" xref="Sx3.SSx4.SSSx3.p2.3.m3.1.1">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx3.p2.3.m3.2c">\mathcal{O}(n+\log n)=\mathcal{O}(n)</annotation></semantics></math>, aptly capturing its efficient execution in federated learning scenarios.</p>
</div>
<div id="Sx3.SSx4.SSSx3.p3" class="ltx_para">
<p id="Sx3.SSx4.SSSx3.p3.2" class="ltx_p">Regarding space complexity, Alg. <a href="#alg1" title="In Description ‣ Server Processing ‣ Search over CKKS Ciphertexts ‣ Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> primary memory usage is allocated to data structures storing ciphertexts, ciphertext differences, and the binary tree vector. These structures collectively occupy <math id="Sx3.SSx4.SSSx3.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{O}(n)" display="inline"><semantics id="Sx3.SSx4.SSSx3.p3.1.m1.1a"><mrow id="Sx3.SSx4.SSSx3.p3.1.m1.1.2" xref="Sx3.SSx4.SSSx3.p3.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx3.p3.1.m1.1.2.2" xref="Sx3.SSx4.SSSx3.p3.1.m1.1.2.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx3.p3.1.m1.1.2.1" xref="Sx3.SSx4.SSSx3.p3.1.m1.1.2.1.cmml">​</mo><mrow id="Sx3.SSx4.SSSx3.p3.1.m1.1.2.3.2" xref="Sx3.SSx4.SSSx3.p3.1.m1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx3.p3.1.m1.1.2.3.2.1" xref="Sx3.SSx4.SSSx3.p3.1.m1.1.2.cmml">(</mo><mi id="Sx3.SSx4.SSSx3.p3.1.m1.1.1" xref="Sx3.SSx4.SSSx3.p3.1.m1.1.1.cmml">n</mi><mo stretchy="false" id="Sx3.SSx4.SSSx3.p3.1.m1.1.2.3.2.2" xref="Sx3.SSx4.SSSx3.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx3.p3.1.m1.1b"><apply id="Sx3.SSx4.SSSx3.p3.1.m1.1.2.cmml" xref="Sx3.SSx4.SSSx3.p3.1.m1.1.2"><times id="Sx3.SSx4.SSSx3.p3.1.m1.1.2.1.cmml" xref="Sx3.SSx4.SSSx3.p3.1.m1.1.2.1"></times><ci id="Sx3.SSx4.SSSx3.p3.1.m1.1.2.2.cmml" xref="Sx3.SSx4.SSSx3.p3.1.m1.1.2.2">𝒪</ci><ci id="Sx3.SSx4.SSSx3.p3.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx3.p3.1.m1.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx3.p3.1.m1.1c">\mathcal{O}(n)</annotation></semantics></math> space, accommodating the input ciphertexts and their differences. The binary tree, implemented as a vector, consumes additional space proportional to the number of nodes in the tree, which is related to the number of ciphertext differences. This results in a space complexity of <math id="Sx3.SSx4.SSSx3.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{O}(n)" display="inline"><semantics id="Sx3.SSx4.SSSx3.p3.2.m2.1a"><mrow id="Sx3.SSx4.SSSx3.p3.2.m2.1.2" xref="Sx3.SSx4.SSSx3.p3.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx3.p3.2.m2.1.2.2" xref="Sx3.SSx4.SSSx3.p3.2.m2.1.2.2.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx4.SSSx3.p3.2.m2.1.2.1" xref="Sx3.SSx4.SSSx3.p3.2.m2.1.2.1.cmml">​</mo><mrow id="Sx3.SSx4.SSSx3.p3.2.m2.1.2.3.2" xref="Sx3.SSx4.SSSx3.p3.2.m2.1.2.cmml"><mo stretchy="false" id="Sx3.SSx4.SSSx3.p3.2.m2.1.2.3.2.1" xref="Sx3.SSx4.SSSx3.p3.2.m2.1.2.cmml">(</mo><mi id="Sx3.SSx4.SSSx3.p3.2.m2.1.1" xref="Sx3.SSx4.SSSx3.p3.2.m2.1.1.cmml">n</mi><mo stretchy="false" id="Sx3.SSx4.SSSx3.p3.2.m2.1.2.3.2.2" xref="Sx3.SSx4.SSSx3.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx3.p3.2.m2.1b"><apply id="Sx3.SSx4.SSSx3.p3.2.m2.1.2.cmml" xref="Sx3.SSx4.SSSx3.p3.2.m2.1.2"><times id="Sx3.SSx4.SSSx3.p3.2.m2.1.2.1.cmml" xref="Sx3.SSx4.SSSx3.p3.2.m2.1.2.1"></times><ci id="Sx3.SSx4.SSSx3.p3.2.m2.1.2.2.cmml" xref="Sx3.SSx4.SSSx3.p3.2.m2.1.2.2">𝒪</ci><ci id="Sx3.SSx4.SSSx3.p3.2.m2.1.1.cmml" xref="Sx3.SSx4.SSSx3.p3.2.m2.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx3.p3.2.m2.1c">\mathcal{O}(n)</annotation></semantics></math>, ensuring the algorithm’s memory consumption remains linear in relation to the size of the input. The algorithm’s space complexity aligns well with the federated learning context, where secure and efficient storage of cryptographic data is pivotal for maintaining privacy and scalability.</p>
</div>
</section>
<section id="Sx3.SSx4.SSSx4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Security Proof</h4>

<div id="Sx3.SSx4.SSSx4.p1" class="ltx_para">
<p id="Sx3.SSx4.SSSx4.p1.6" class="ltx_p">Assume, by contradiction, that there exists an efficient adversary <math id="Sx3.SSx4.SSSx4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx4.p1.1.m1.1.1" xref="Sx3.SSx4.SSSx4.p1.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p1.1.m1.1b"><ci id="Sx3.SSx4.SSSx4.p1.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx4.p1.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p1.1.m1.1c">\mathcal{A}</annotation></semantics></math> that can distinguish between the target ciphertext <math id="Sx3.SSx4.SSSx4.p1.2.m2.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p1.2.m2.1a"><msub id="Sx3.SSx4.SSSx4.p1.2.m2.1.1" xref="Sx3.SSx4.SSSx4.p1.2.m2.1.1.cmml"><mi id="Sx3.SSx4.SSSx4.p1.2.m2.1.1.2" xref="Sx3.SSx4.SSSx4.p1.2.m2.1.1.2.cmml">c</mi><mi id="Sx3.SSx4.SSSx4.p1.2.m2.1.1.3" xref="Sx3.SSx4.SSSx4.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p1.2.m2.1b"><apply id="Sx3.SSx4.SSSx4.p1.2.m2.1.1.cmml" xref="Sx3.SSx4.SSSx4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx4.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx4.SSSx4.p1.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx4.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx4.SSSx4.p1.2.m2.1.1.2">𝑐</ci><ci id="Sx3.SSx4.SSSx4.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx4.SSSx4.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p1.2.m2.1c">c_{t}</annotation></semantics></math> and other ciphertexts in Alg. <a href="#alg1" title="In Description ‣ Server Processing ‣ Search over CKKS Ciphertexts ‣ Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>’s execution with non-negligible advantage <math id="Sx3.SSx4.SSSx4.p1.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="Sx3.SSx4.SSSx4.p1.3.m3.1a"><mi id="Sx3.SSx4.SSSx4.p1.3.m3.1.1" xref="Sx3.SSx4.SSSx4.p1.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p1.3.m3.1b"><ci id="Sx3.SSx4.SSSx4.p1.3.m3.1.1.cmml" xref="Sx3.SSx4.SSSx4.p1.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p1.3.m3.1c">\epsilon</annotation></semantics></math>.
We will construct an algorithm <math id="Sx3.SSx4.SSSx4.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx4.p1.4.m4.1.1" xref="Sx3.SSx4.SSSx4.p1.4.m4.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p1.4.m4.1b"><ci id="Sx3.SSx4.SSSx4.p1.4.m4.1.1.cmml" xref="Sx3.SSx4.SSSx4.p1.4.m4.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p1.4.m4.1c">\mathcal{B}</annotation></semantics></math> that breaks the IND-CPA security of the homomorphic encryption scheme <math id="Sx3.SSx4.SSSx4.p1.5.m5.1" class="ltx_Math" alttext="\Pi" display="inline"><semantics id="Sx3.SSx4.SSSx4.p1.5.m5.1a"><mi mathvariant="normal" id="Sx3.SSx4.SSSx4.p1.5.m5.1.1" xref="Sx3.SSx4.SSSx4.p1.5.m5.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p1.5.m5.1b"><ci id="Sx3.SSx4.SSSx4.p1.5.m5.1.1.cmml" xref="Sx3.SSx4.SSSx4.p1.5.m5.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p1.5.m5.1c">\Pi</annotation></semantics></math> by simulating the adversary <math id="Sx3.SSx4.SSSx4.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx4.p1.6.m6.1.1" xref="Sx3.SSx4.SSSx4.p1.6.m6.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p1.6.m6.1b"><ci id="Sx3.SSx4.SSSx4.p1.6.m6.1.1.cmml" xref="Sx3.SSx4.SSSx4.p1.6.m6.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p1.6.m6.1c">\mathcal{A}</annotation></semantics></math>.</p>
</div>
<div id="Sx3.SSx4.SSSx4.p2" class="ltx_para">
<p id="Sx3.SSx4.SSSx4.p2.1" class="ltx_p"><span id="Sx3.SSx4.SSSx4.p2.1.1" class="ltx_text ltx_font_bold">Algorithm <math id="Sx3.SSx4.SSSx4.p2.1.1.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p2.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx4.p2.1.1.m1.1.1" xref="Sx3.SSx4.SSSx4.p2.1.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p2.1.1.m1.1b"><ci id="Sx3.SSx4.SSSx4.p2.1.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx4.p2.1.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p2.1.1.m1.1c">\mathcal{B}</annotation></semantics></math>:</span></p>
</div>
<div id="Sx3.SSx4.SSSx4.p3" class="ltx_para">
<ol id="Sx3.I1" class="ltx_enumerate">
<li id="Sx3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="Sx3.I1.i1.p1" class="ltx_para">
<p id="Sx3.I1.i1.p1.2" class="ltx_p"><math id="Sx3.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.I1.i1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.I1.i1.p1.1.m1.1.1" xref="Sx3.I1.i1.p1.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.I1.i1.p1.1.m1.1b"><ci id="Sx3.I1.i1.p1.1.m1.1.1.cmml" xref="Sx3.I1.i1.p1.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i1.p1.1.m1.1c">\mathcal{B}</annotation></semantics></math> receives the public key <math id="Sx3.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="pk" display="inline"><semantics id="Sx3.I1.i1.p1.2.m2.1a"><mrow id="Sx3.I1.i1.p1.2.m2.1.1" xref="Sx3.I1.i1.p1.2.m2.1.1.cmml"><mi id="Sx3.I1.i1.p1.2.m2.1.1.2" xref="Sx3.I1.i1.p1.2.m2.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.I1.i1.p1.2.m2.1.1.1" xref="Sx3.I1.i1.p1.2.m2.1.1.1.cmml">​</mo><mi id="Sx3.I1.i1.p1.2.m2.1.1.3" xref="Sx3.I1.i1.p1.2.m2.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.I1.i1.p1.2.m2.1b"><apply id="Sx3.I1.i1.p1.2.m2.1.1.cmml" xref="Sx3.I1.i1.p1.2.m2.1.1"><times id="Sx3.I1.i1.p1.2.m2.1.1.1.cmml" xref="Sx3.I1.i1.p1.2.m2.1.1.1"></times><ci id="Sx3.I1.i1.p1.2.m2.1.1.2.cmml" xref="Sx3.I1.i1.p1.2.m2.1.1.2">𝑝</ci><ci id="Sx3.I1.i1.p1.2.m2.1.1.3.cmml" xref="Sx3.I1.i1.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i1.p1.2.m2.1c">pk</annotation></semantics></math> as input.</p>
</div>
</li>
<li id="Sx3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="Sx3.I1.i2.p1" class="ltx_para">
<p id="Sx3.I1.i2.p1.2" class="ltx_p"><math id="Sx3.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.I1.i2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.I1.i2.p1.1.m1.1.1" xref="Sx3.I1.i2.p1.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.I1.i2.p1.1.m1.1b"><ci id="Sx3.I1.i2.p1.1.m1.1.1.cmml" xref="Sx3.I1.i2.p1.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i2.p1.1.m1.1c">\mathcal{B}</annotation></semantics></math> simulates the encryption oracle by generating random plaintexts and obtaining their corresponding ciphertexts from the encryption algorithm using <math id="Sx3.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="pk" display="inline"><semantics id="Sx3.I1.i2.p1.2.m2.1a"><mrow id="Sx3.I1.i2.p1.2.m2.1.1" xref="Sx3.I1.i2.p1.2.m2.1.1.cmml"><mi id="Sx3.I1.i2.p1.2.m2.1.1.2" xref="Sx3.I1.i2.p1.2.m2.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.I1.i2.p1.2.m2.1.1.1" xref="Sx3.I1.i2.p1.2.m2.1.1.1.cmml">​</mo><mi id="Sx3.I1.i2.p1.2.m2.1.1.3" xref="Sx3.I1.i2.p1.2.m2.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.I1.i2.p1.2.m2.1b"><apply id="Sx3.I1.i2.p1.2.m2.1.1.cmml" xref="Sx3.I1.i2.p1.2.m2.1.1"><times id="Sx3.I1.i2.p1.2.m2.1.1.1.cmml" xref="Sx3.I1.i2.p1.2.m2.1.1.1"></times><ci id="Sx3.I1.i2.p1.2.m2.1.1.2.cmml" xref="Sx3.I1.i2.p1.2.m2.1.1.2">𝑝</ci><ci id="Sx3.I1.i2.p1.2.m2.1.1.3.cmml" xref="Sx3.I1.i2.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i2.p1.2.m2.1c">pk</annotation></semantics></math>.</p>
</div>
</li>
<li id="Sx3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="Sx3.I1.i3.p1" class="ltx_para">
<p id="Sx3.I1.i3.p1.4" class="ltx_p">When <math id="Sx3.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="Sx3.I1.i3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.I1.i3.p1.1.m1.1.1" xref="Sx3.I1.i3.p1.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="Sx3.I1.i3.p1.1.m1.1b"><ci id="Sx3.I1.i3.p1.1.m1.1.1.cmml" xref="Sx3.I1.i3.p1.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i3.p1.1.m1.1c">\mathcal{A}</annotation></semantics></math> queries the decryption oracle on a ciphertext <math id="Sx3.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="Sx3.I1.i3.p1.2.m2.1a"><mi id="Sx3.I1.i3.p1.2.m2.1.1" xref="Sx3.I1.i3.p1.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="Sx3.I1.i3.p1.2.m2.1b"><ci id="Sx3.I1.i3.p1.2.m2.1.1.cmml" xref="Sx3.I1.i3.p1.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i3.p1.2.m2.1c">c</annotation></semantics></math>, <math id="Sx3.I1.i3.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.I1.i3.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.I1.i3.p1.3.m3.1.1" xref="Sx3.I1.i3.p1.3.m3.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.I1.i3.p1.3.m3.1b"><ci id="Sx3.I1.i3.p1.3.m3.1.1.cmml" xref="Sx3.I1.i3.p1.3.m3.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i3.p1.3.m3.1c">\mathcal{B}</annotation></semantics></math> forwards the query to its decryption oracle, obtaining the decrypted plaintext <math id="Sx3.I1.i3.p1.4.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="Sx3.I1.i3.p1.4.m4.1a"><mi id="Sx3.I1.i3.p1.4.m4.1.1" xref="Sx3.I1.i3.p1.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="Sx3.I1.i3.p1.4.m4.1b"><ci id="Sx3.I1.i3.p1.4.m4.1.1.cmml" xref="Sx3.I1.i3.p1.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i3.p1.4.m4.1c">m</annotation></semantics></math>.</p>
</div>
</li>
<li id="Sx3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="Sx3.I1.i4.p1" class="ltx_para">
<p id="Sx3.I1.i4.p1.4" class="ltx_p"><math id="Sx3.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.I1.i4.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.I1.i4.p1.1.m1.1.1" xref="Sx3.I1.i4.p1.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.I1.i4.p1.1.m1.1b"><ci id="Sx3.I1.i4.p1.1.m1.1.1.cmml" xref="Sx3.I1.i4.p1.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i4.p1.1.m1.1c">\mathcal{B}</annotation></semantics></math> selects a random plaintext <math id="Sx3.I1.i4.p1.2.m2.1" class="ltx_Math" alttext="m^{\prime}" display="inline"><semantics id="Sx3.I1.i4.p1.2.m2.1a"><msup id="Sx3.I1.i4.p1.2.m2.1.1" xref="Sx3.I1.i4.p1.2.m2.1.1.cmml"><mi id="Sx3.I1.i4.p1.2.m2.1.1.2" xref="Sx3.I1.i4.p1.2.m2.1.1.2.cmml">m</mi><mo id="Sx3.I1.i4.p1.2.m2.1.1.3" xref="Sx3.I1.i4.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Sx3.I1.i4.p1.2.m2.1b"><apply id="Sx3.I1.i4.p1.2.m2.1.1.cmml" xref="Sx3.I1.i4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.I1.i4.p1.2.m2.1.1.1.cmml" xref="Sx3.I1.i4.p1.2.m2.1.1">superscript</csymbol><ci id="Sx3.I1.i4.p1.2.m2.1.1.2.cmml" xref="Sx3.I1.i4.p1.2.m2.1.1.2">𝑚</ci><ci id="Sx3.I1.i4.p1.2.m2.1.1.3.cmml" xref="Sx3.I1.i4.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i4.p1.2.m2.1c">m^{\prime}</annotation></semantics></math> and encrypts it using the encryption algorithm to obtain <math id="Sx3.I1.i4.p1.3.m3.1" class="ltx_Math" alttext="c^{\prime}" display="inline"><semantics id="Sx3.I1.i4.p1.3.m3.1a"><msup id="Sx3.I1.i4.p1.3.m3.1.1" xref="Sx3.I1.i4.p1.3.m3.1.1.cmml"><mi id="Sx3.I1.i4.p1.3.m3.1.1.2" xref="Sx3.I1.i4.p1.3.m3.1.1.2.cmml">c</mi><mo id="Sx3.I1.i4.p1.3.m3.1.1.3" xref="Sx3.I1.i4.p1.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Sx3.I1.i4.p1.3.m3.1b"><apply id="Sx3.I1.i4.p1.3.m3.1.1.cmml" xref="Sx3.I1.i4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.I1.i4.p1.3.m3.1.1.1.cmml" xref="Sx3.I1.i4.p1.3.m3.1.1">superscript</csymbol><ci id="Sx3.I1.i4.p1.3.m3.1.1.2.cmml" xref="Sx3.I1.i4.p1.3.m3.1.1.2">𝑐</ci><ci id="Sx3.I1.i4.p1.3.m3.1.1.3.cmml" xref="Sx3.I1.i4.p1.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i4.p1.3.m3.1c">c^{\prime}</annotation></semantics></math>. It then outputs <math id="Sx3.I1.i4.p1.4.m4.1" class="ltx_Math" alttext="c^{\prime}" display="inline"><semantics id="Sx3.I1.i4.p1.4.m4.1a"><msup id="Sx3.I1.i4.p1.4.m4.1.1" xref="Sx3.I1.i4.p1.4.m4.1.1.cmml"><mi id="Sx3.I1.i4.p1.4.m4.1.1.2" xref="Sx3.I1.i4.p1.4.m4.1.1.2.cmml">c</mi><mo id="Sx3.I1.i4.p1.4.m4.1.1.3" xref="Sx3.I1.i4.p1.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Sx3.I1.i4.p1.4.m4.1b"><apply id="Sx3.I1.i4.p1.4.m4.1.1.cmml" xref="Sx3.I1.i4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.I1.i4.p1.4.m4.1.1.1.cmml" xref="Sx3.I1.i4.p1.4.m4.1.1">superscript</csymbol><ci id="Sx3.I1.i4.p1.4.m4.1.1.2.cmml" xref="Sx3.I1.i4.p1.4.m4.1.1.2">𝑐</ci><ci id="Sx3.I1.i4.p1.4.m4.1.1.3.cmml" xref="Sx3.I1.i4.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i4.p1.4.m4.1c">c^{\prime}</annotation></semantics></math> as the decryption oracle’s response.</p>
</div>
</li>
<li id="Sx3.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span> 
<div id="Sx3.I1.i5.p1" class="ltx_para">
<p id="Sx3.I1.i5.p1.3" class="ltx_p"><math id="Sx3.I1.i5.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.I1.i5.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.I1.i5.p1.1.m1.1.1" xref="Sx3.I1.i5.p1.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.I1.i5.p1.1.m1.1b"><ci id="Sx3.I1.i5.p1.1.m1.1.1.cmml" xref="Sx3.I1.i5.p1.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i5.p1.1.m1.1c">\mathcal{B}</annotation></semantics></math> runs Alg. <a href="#alg1" title="In Description ‣ Server Processing ‣ Search over CKKS Ciphertexts ‣ Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> with the input ciphertexts as chosen by <math id="Sx3.I1.i5.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="Sx3.I1.i5.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.I1.i5.p1.2.m2.1.1" xref="Sx3.I1.i5.p1.2.m2.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="Sx3.I1.i5.p1.2.m2.1b"><ci id="Sx3.I1.i5.p1.2.m2.1.1.cmml" xref="Sx3.I1.i5.p1.2.m2.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i5.p1.2.m2.1c">\mathcal{A}</annotation></semantics></math>. It follows the same steps as the real algorithm but replaces <math id="Sx3.I1.i5.p1.3.m3.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="Sx3.I1.i5.p1.3.m3.1a"><msub id="Sx3.I1.i5.p1.3.m3.1.1" xref="Sx3.I1.i5.p1.3.m3.1.1.cmml"><mi id="Sx3.I1.i5.p1.3.m3.1.1.2" xref="Sx3.I1.i5.p1.3.m3.1.1.2.cmml">c</mi><mi id="Sx3.I1.i5.p1.3.m3.1.1.3" xref="Sx3.I1.i5.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.I1.i5.p1.3.m3.1b"><apply id="Sx3.I1.i5.p1.3.m3.1.1.cmml" xref="Sx3.I1.i5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.I1.i5.p1.3.m3.1.1.1.cmml" xref="Sx3.I1.i5.p1.3.m3.1.1">subscript</csymbol><ci id="Sx3.I1.i5.p1.3.m3.1.1.2.cmml" xref="Sx3.I1.i5.p1.3.m3.1.1.2">𝑐</ci><ci id="Sx3.I1.i5.p1.3.m3.1.1.3.cmml" xref="Sx3.I1.i5.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i5.p1.3.m3.1c">c_{t}</annotation></semantics></math> with a random ciphertext.</p>
</div>
</li>
<li id="Sx3.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span> 
<div id="Sx3.I1.i6.p1" class="ltx_para">
<p id="Sx3.I1.i6.p1.2" class="ltx_p"><math id="Sx3.I1.i6.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.I1.i6.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.I1.i6.p1.1.m1.1.1" xref="Sx3.I1.i6.p1.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.I1.i6.p1.1.m1.1b"><ci id="Sx3.I1.i6.p1.1.m1.1.1.cmml" xref="Sx3.I1.i6.p1.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i6.p1.1.m1.1c">\mathcal{B}</annotation></semantics></math> returns the output of <math id="Sx3.I1.i6.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="Sx3.I1.i6.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.I1.i6.p1.2.m2.1.1" xref="Sx3.I1.i6.p1.2.m2.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="Sx3.I1.i6.p1.2.m2.1b"><ci id="Sx3.I1.i6.p1.2.m2.1.1.cmml" xref="Sx3.I1.i6.p1.2.m2.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I1.i6.p1.2.m2.1c">\mathcal{A}</annotation></semantics></math> as its own output.</p>
</div>
</li>
</ol>
</div>
<div id="Sx3.SSx4.SSSx4.p4" class="ltx_para">
<p id="Sx3.SSx4.SSSx4.p4.9" class="ltx_p">By construction, <math id="Sx3.SSx4.SSSx4.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx4.p4.1.m1.1.1" xref="Sx3.SSx4.SSSx4.p4.1.m1.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p4.1.m1.1b"><ci id="Sx3.SSx4.SSSx4.p4.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx4.p4.1.m1.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p4.1.m1.1c">\mathcal{B}</annotation></semantics></math> simulates the interactions with <math id="Sx3.SSx4.SSSx4.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx4.p4.2.m2.1.1" xref="Sx3.SSx4.SSSx4.p4.2.m2.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p4.2.m2.1b"><ci id="Sx3.SSx4.SSSx4.p4.2.m2.1.1.cmml" xref="Sx3.SSx4.SSSx4.p4.2.m2.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p4.2.m2.1c">\mathcal{A}</annotation></semantics></math> and behaves exactly like the real execution of Alg. <a href="#alg1" title="In Description ‣ Server Processing ‣ Search over CKKS Ciphertexts ‣ Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
The advantage of <math id="Sx3.SSx4.SSSx4.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p4.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx4.p4.3.m3.1.1" xref="Sx3.SSx4.SSSx4.p4.3.m3.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p4.3.m3.1b"><ci id="Sx3.SSx4.SSSx4.p4.3.m3.1.1.cmml" xref="Sx3.SSx4.SSSx4.p4.3.m3.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p4.3.m3.1c">\mathcal{B}</annotation></semantics></math> in distinguishing between the target ciphertext <math id="Sx3.SSx4.SSSx4.p4.4.m4.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p4.4.m4.1a"><msub id="Sx3.SSx4.SSSx4.p4.4.m4.1.1" xref="Sx3.SSx4.SSSx4.p4.4.m4.1.1.cmml"><mi id="Sx3.SSx4.SSSx4.p4.4.m4.1.1.2" xref="Sx3.SSx4.SSSx4.p4.4.m4.1.1.2.cmml">c</mi><mi id="Sx3.SSx4.SSSx4.p4.4.m4.1.1.3" xref="Sx3.SSx4.SSSx4.p4.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p4.4.m4.1b"><apply id="Sx3.SSx4.SSSx4.p4.4.m4.1.1.cmml" xref="Sx3.SSx4.SSSx4.p4.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.SSSx4.p4.4.m4.1.1.1.cmml" xref="Sx3.SSx4.SSSx4.p4.4.m4.1.1">subscript</csymbol><ci id="Sx3.SSx4.SSSx4.p4.4.m4.1.1.2.cmml" xref="Sx3.SSx4.SSSx4.p4.4.m4.1.1.2">𝑐</ci><ci id="Sx3.SSx4.SSSx4.p4.4.m4.1.1.3.cmml" xref="Sx3.SSx4.SSSx4.p4.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p4.4.m4.1c">c_{t}</annotation></semantics></math> and other ciphertexts is the same as <math id="Sx3.SSx4.SSSx4.p4.5.m5.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p4.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx4.p4.5.m5.1.1" xref="Sx3.SSx4.SSSx4.p4.5.m5.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p4.5.m5.1b"><ci id="Sx3.SSx4.SSSx4.p4.5.m5.1.1.cmml" xref="Sx3.SSx4.SSSx4.p4.5.m5.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p4.5.m5.1c">\mathcal{A}</annotation></semantics></math>’s advantage, i.e., <math id="Sx3.SSx4.SSSx4.p4.6.m6.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="Sx3.SSx4.SSSx4.p4.6.m6.1a"><mi id="Sx3.SSx4.SSSx4.p4.6.m6.1.1" xref="Sx3.SSx4.SSSx4.p4.6.m6.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p4.6.m6.1b"><ci id="Sx3.SSx4.SSSx4.p4.6.m6.1.1.cmml" xref="Sx3.SSx4.SSSx4.p4.6.m6.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p4.6.m6.1c">\epsilon</annotation></semantics></math>. Since <math id="Sx3.SSx4.SSSx4.p4.7.m7.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="Sx3.SSx4.SSSx4.p4.7.m7.1a"><mi id="Sx3.SSx4.SSSx4.p4.7.m7.1.1" xref="Sx3.SSx4.SSSx4.p4.7.m7.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p4.7.m7.1b"><ci id="Sx3.SSx4.SSSx4.p4.7.m7.1.1.cmml" xref="Sx3.SSx4.SSSx4.p4.7.m7.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p4.7.m7.1c">\epsilon</annotation></semantics></math> is non-negligible, <math id="Sx3.SSx4.SSSx4.p4.8.m8.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p4.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx4.p4.8.m8.1.1" xref="Sx3.SSx4.SSSx4.p4.8.m8.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p4.8.m8.1b"><ci id="Sx3.SSx4.SSSx4.p4.8.m8.1.1.cmml" xref="Sx3.SSx4.SSSx4.p4.8.m8.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p4.8.m8.1c">\mathcal{B}</annotation></semantics></math> has a non-negligible advantage in breaking the IND-CPA security of the homomorphic encryption scheme <math id="Sx3.SSx4.SSSx4.p4.9.m9.1" class="ltx_Math" alttext="\Pi" display="inline"><semantics id="Sx3.SSx4.SSSx4.p4.9.m9.1a"><mi mathvariant="normal" id="Sx3.SSx4.SSSx4.p4.9.m9.1.1" xref="Sx3.SSx4.SSSx4.p4.9.m9.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p4.9.m9.1b"><ci id="Sx3.SSx4.SSSx4.p4.9.m9.1.1.cmml" xref="Sx3.SSx4.SSSx4.p4.9.m9.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p4.9.m9.1c">\Pi</annotation></semantics></math>.</p>
</div>
<div id="Sx3.SSx4.SSSx4.p5" class="ltx_para">
<p id="Sx3.SSx4.SSSx4.p5.3" class="ltx_p">This contradiction implies that the assumption of an efficient adversary <math id="Sx3.SSx4.SSSx4.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="Sx3.SSx4.SSSx4.p5.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.SSSx4.p5.1.m1.1.1" xref="Sx3.SSx4.SSSx4.p5.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p5.1.m1.1b"><ci id="Sx3.SSx4.SSSx4.p5.1.m1.1.1.cmml" xref="Sx3.SSx4.SSSx4.p5.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p5.1.m1.1c">\mathcal{A}</annotation></semantics></math> distinguishing the ciphertexts with non-negligible advantage <math id="Sx3.SSx4.SSSx4.p5.2.m2.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="Sx3.SSx4.SSSx4.p5.2.m2.1a"><mi id="Sx3.SSx4.SSSx4.p5.2.m2.1.1" xref="Sx3.SSx4.SSSx4.p5.2.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p5.2.m2.1b"><ci id="Sx3.SSx4.SSSx4.p5.2.m2.1.1.cmml" xref="Sx3.SSx4.SSSx4.p5.2.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p5.2.m2.1c">\epsilon</annotation></semantics></math> is false. Therefore, the ”Server Processing” algorithm, executed on ciphertexts encrypted using <math id="Sx3.SSx4.SSSx4.p5.3.m3.1" class="ltx_Math" alttext="\Pi" display="inline"><semantics id="Sx3.SSx4.SSSx4.p5.3.m3.1a"><mi mathvariant="normal" id="Sx3.SSx4.SSSx4.p5.3.m3.1.1" xref="Sx3.SSx4.SSSx4.p5.3.m3.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.SSSx4.p5.3.m3.1b"><ci id="Sx3.SSx4.SSSx4.p5.3.m3.1.1.cmml" xref="Sx3.SSx4.SSSx4.p5.3.m3.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.SSSx4.p5.3.m3.1c">\Pi</annotation></semantics></math>, satisfies the IND-CPA security property.</p>
</div>
</section>
</section>
<section id="Sx3.SSx5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Interaction Protocol</h3>

<section id="Sx3.SSx5.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Description</h4>

<div id="Sx3.SSx5.SSSx1.p1" class="ltx_para">
<p id="Sx3.SSx5.SSSx1.p1.1" class="ltx_p">Alg. <a href="#alg2" title="In Description ‣ Interaction Protocol ‣ Search over CKKS Ciphertexts ‣ Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> defines a protocol for communication between a client and a server to efficiently search for a specific target encrypted value using homomorphic encryption. The protocol employs a binary tree structure, where the server holds encrypted intermediate values, and the client interacts with the server to navigate through the tree, ultimately determining the index of the target value.</p>
</div>
<div id="Sx3.SSx5.SSSx1.p2" class="ltx_para">
<p id="Sx3.SSx5.SSSx1.p2.3" class="ltx_p">At the outset, the server initializes the protocol by generating an intermediate binary tree <span id="Sx3.SSx5.SSSx1.p2.3.1" class="ltx_text ltx_markedasmath ltx_font_bold">t</span>. This is achieved by performing pairwise multiplication on the target ciphertext <math id="Sx3.SSx5.SSSx1.p2.2.m2.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="Sx3.SSx5.SSSx1.p2.2.m2.1a"><msub id="Sx3.SSx5.SSSx1.p2.2.m2.1.1" xref="Sx3.SSx5.SSSx1.p2.2.m2.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p2.2.m2.1.1.2" xref="Sx3.SSx5.SSSx1.p2.2.m2.1.1.2.cmml">c</mi><mi id="Sx3.SSx5.SSSx1.p2.2.m2.1.1.3" xref="Sx3.SSx5.SSSx1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p2.2.m2.1b"><apply id="Sx3.SSx5.SSSx1.p2.2.m2.1.1.cmml" xref="Sx3.SSx5.SSSx1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx1.p2.2.m2.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p2.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx1.p2.2.m2.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p2.2.m2.1.1.2">𝑐</ci><ci id="Sx3.SSx5.SSSx1.p2.2.m2.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p2.2.m2.1c">c_{t}</annotation></semantics></math>. The server then sends the value of the root node, denoted as <math id="Sx3.SSx5.SSSx1.p2.3.m3.1" class="ltx_Math" alttext="t_{1}" display="inline"><semantics id="Sx3.SSx5.SSSx1.p2.3.m3.1a"><msub id="Sx3.SSx5.SSSx1.p2.3.m3.1.1" xref="Sx3.SSx5.SSSx1.p2.3.m3.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p2.3.m3.1.1.2" xref="Sx3.SSx5.SSSx1.p2.3.m3.1.1.2.cmml">t</mi><mn id="Sx3.SSx5.SSSx1.p2.3.m3.1.1.3" xref="Sx3.SSx5.SSSx1.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p2.3.m3.1b"><apply id="Sx3.SSx5.SSSx1.p2.3.m3.1.1.cmml" xref="Sx3.SSx5.SSSx1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx1.p2.3.m3.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p2.3.m3.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx1.p2.3.m3.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p2.3.m3.1.1.2">𝑡</ci><cn type="integer" id="Sx3.SSx5.SSSx1.p2.3.m3.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p2.3.m3.1c">t_{1}</annotation></semantics></math>, to the client. This initial interaction serves as the foundation for subsequent steps.</p>
</div>
<div id="Sx3.SSx5.SSSx1.p3" class="ltx_para">
<p id="Sx3.SSx5.SSSx1.p3.4" class="ltx_p">Upon receiving <math id="Sx3.SSx5.SSSx1.p3.1.m1.1" class="ltx_Math" alttext="t_{1}" display="inline"><semantics id="Sx3.SSx5.SSSx1.p3.1.m1.1a"><msub id="Sx3.SSx5.SSSx1.p3.1.m1.1.1" xref="Sx3.SSx5.SSSx1.p3.1.m1.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p3.1.m1.1.1.2" xref="Sx3.SSx5.SSSx1.p3.1.m1.1.1.2.cmml">t</mi><mn id="Sx3.SSx5.SSSx1.p3.1.m1.1.1.3" xref="Sx3.SSx5.SSSx1.p3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p3.1.m1.1b"><apply id="Sx3.SSx5.SSSx1.p3.1.m1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx1.p3.1.m1.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p3.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx1.p3.1.m1.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p3.1.m1.1.1.2">𝑡</ci><cn type="integer" id="Sx3.SSx5.SSSx1.p3.1.m1.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p3.1.m1.1c">t_{1}</annotation></semantics></math> from the server, the client’s involvement begins. The client’s initial task is to decrypt <math id="Sx3.SSx5.SSSx1.p3.2.m2.1" class="ltx_Math" alttext="t_{1}" display="inline"><semantics id="Sx3.SSx5.SSSx1.p3.2.m2.1a"><msub id="Sx3.SSx5.SSSx1.p3.2.m2.1.1" xref="Sx3.SSx5.SSSx1.p3.2.m2.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p3.2.m2.1.1.2" xref="Sx3.SSx5.SSSx1.p3.2.m2.1.1.2.cmml">t</mi><mn id="Sx3.SSx5.SSSx1.p3.2.m2.1.1.3" xref="Sx3.SSx5.SSSx1.p3.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p3.2.m2.1b"><apply id="Sx3.SSx5.SSSx1.p3.2.m2.1.1.cmml" xref="Sx3.SSx5.SSSx1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx1.p3.2.m2.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p3.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx1.p3.2.m2.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p3.2.m2.1.1.2">𝑡</ci><cn type="integer" id="Sx3.SSx5.SSSx1.p3.2.m2.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p3.2.m2.1c">t_{1}</annotation></semantics></math> and determine whether the decrypted value is non-zero. If the decryption yields a non-zero result, the client deduces that the target value must be present within the binary tree. As a response, the client sends a message to the server with a predefined value of <math id="Sx3.SSx5.SSSx1.p3.3.m3.1" class="ltx_Math" alttext="pivot=1" display="inline"><semantics id="Sx3.SSx5.SSSx1.p3.3.m3.1a"><mrow id="Sx3.SSx5.SSSx1.p3.3.m3.1.1" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.cmml"><mrow id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.cmml"><mi id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.2" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.1" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.3" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.1a" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.4" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.1b" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.5" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.1c" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.6" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.6.cmml">t</mi></mrow><mo id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.1" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.1.cmml">=</mo><mn id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.3" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p3.3.m3.1b"><apply id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.cmml" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1"><eq id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.1"></eq><apply id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2"><times id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.1.cmml" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.1"></times><ci id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.2.cmml" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.2">𝑝</ci><ci id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.3.cmml" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.3">𝑖</ci><ci id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.4.cmml" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.4">𝑣</ci><ci id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.5.cmml" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.5">𝑜</ci><ci id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.6.cmml" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.2.6">𝑡</ci></apply><cn type="integer" id="Sx3.SSx5.SSSx1.p3.3.m3.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p3.3.m3.1c">pivot=1</annotation></semantics></math>. Conversely, if the decryption of <math id="Sx3.SSx5.SSSx1.p3.4.m4.1" class="ltx_Math" alttext="t_{1}" display="inline"><semantics id="Sx3.SSx5.SSSx1.p3.4.m4.1a"><msub id="Sx3.SSx5.SSSx1.p3.4.m4.1.1" xref="Sx3.SSx5.SSSx1.p3.4.m4.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p3.4.m4.1.1.2" xref="Sx3.SSx5.SSSx1.p3.4.m4.1.1.2.cmml">t</mi><mn id="Sx3.SSx5.SSSx1.p3.4.m4.1.1.3" xref="Sx3.SSx5.SSSx1.p3.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p3.4.m4.1b"><apply id="Sx3.SSx5.SSSx1.p3.4.m4.1.1.cmml" xref="Sx3.SSx5.SSSx1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx1.p3.4.m4.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p3.4.m4.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx1.p3.4.m4.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p3.4.m4.1.1.2">𝑡</ci><cn type="integer" id="Sx3.SSx5.SSSx1.p3.4.m4.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p3.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p3.4.m4.1c">t_{1}</annotation></semantics></math> results in zero, the client concludes that the target value is not present and returns -1 as an indication.</p>
</div>
<div id="Sx3.SSx5.SSSx1.p4" class="ltx_para">
<p id="Sx3.SSx5.SSSx1.p4.5" class="ltx_p">The core of the algorithm lies in the subsequent traversal of the binary tree. This traversal takes place iteratively for each level of the binary tree, as determined by the logarithm of the total number of ciphertexts. During each iteration, the client interacts with the server by sending the current <math id="Sx3.SSx5.SSSx1.p4.1.m1.1" class="ltx_Math" alttext="pivot" display="inline"><semantics id="Sx3.SSx5.SSSx1.p4.1.m1.1a"><mrow id="Sx3.SSx5.SSSx1.p4.1.m1.1.1" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.2" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.1" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.3" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.1a" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.4" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.1b" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.5" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.1c" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.6" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p4.1.m1.1b"><apply id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1"><times id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.1"></times><ci id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.2">𝑝</ci><ci id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.3">𝑖</ci><ci id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.4.cmml" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.4">𝑣</ci><ci id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.5.cmml" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.5">𝑜</ci><ci id="Sx3.SSx5.SSSx1.p4.1.m1.1.1.6.cmml" xref="Sx3.SSx5.SSSx1.p4.1.m1.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p4.1.m1.1c">pivot</annotation></semantics></math> value. The server, in turn, calculates the indices of the left child (<math id="Sx3.SSx5.SSSx1.p4.2.m2.1" class="ltx_Math" alttext="lchild" display="inline"><semantics id="Sx3.SSx5.SSSx1.p4.2.m2.1a"><mrow id="Sx3.SSx5.SSSx1.p4.2.m2.1.1" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.2" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.3" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1a" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.4" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1b" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.5" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1c" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.6" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1d" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.7" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.7.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p4.2.m2.1b"><apply id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.cmml" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1"><times id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.1"></times><ci id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.2">𝑙</ci><ci id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.3">𝑐</ci><ci id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.4.cmml" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.4">ℎ</ci><ci id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.5.cmml" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.5">𝑖</ci><ci id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.6.cmml" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.6">𝑙</ci><ci id="Sx3.SSx5.SSSx1.p4.2.m2.1.1.7.cmml" xref="Sx3.SSx5.SSSx1.p4.2.m2.1.1.7">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p4.2.m2.1c">lchild</annotation></semantics></math>) and right child (<math id="Sx3.SSx5.SSSx1.p4.3.m3.1" class="ltx_Math" alttext="rchild" display="inline"><semantics id="Sx3.SSx5.SSSx1.p4.3.m3.1a"><mrow id="Sx3.SSx5.SSSx1.p4.3.m3.1.1" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.2" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.3" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1a" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.4" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1b" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.5" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1c" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.6" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1d" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.7" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.7.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p4.3.m3.1b"><apply id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.cmml" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1"><times id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.1"></times><ci id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.2">𝑟</ci><ci id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.3">𝑐</ci><ci id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.4.cmml" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.4">ℎ</ci><ci id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.5.cmml" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.5">𝑖</ci><ci id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.6.cmml" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.6">𝑙</ci><ci id="Sx3.SSx5.SSSx1.p4.3.m3.1.1.7.cmml" xref="Sx3.SSx5.SSSx1.p4.3.m3.1.1.7">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p4.3.m3.1c">rchild</annotation></semantics></math>) nodes and communicates the corresponding values <math id="Sx3.SSx5.SSSx1.p4.4.m4.1" class="ltx_Math" alttext="t_{lchild}" display="inline"><semantics id="Sx3.SSx5.SSSx1.p4.4.m4.1a"><msub id="Sx3.SSx5.SSSx1.p4.4.m4.1.1" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.2" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.2.cmml">t</mi><mrow id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.cmml"><mi id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.2" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.3" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1a" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.4" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1b" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.5" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1c" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.6" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1d" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.7" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.7.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p4.4.m4.1b"><apply id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.cmml" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.2">𝑡</ci><apply id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3"><times id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1.cmml" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.1"></times><ci id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.2.cmml" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.2">𝑙</ci><ci id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.3.cmml" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.3">𝑐</ci><ci id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.4.cmml" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.4">ℎ</ci><ci id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.5.cmml" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.5">𝑖</ci><ci id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.6.cmml" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.6">𝑙</ci><ci id="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.7.cmml" xref="Sx3.SSx5.SSSx1.p4.4.m4.1.1.3.7">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p4.4.m4.1c">t_{lchild}</annotation></semantics></math> and <math id="Sx3.SSx5.SSSx1.p4.5.m5.1" class="ltx_Math" alttext="t_{rchild}" display="inline"><semantics id="Sx3.SSx5.SSSx1.p4.5.m5.1a"><msub id="Sx3.SSx5.SSSx1.p4.5.m5.1.1" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.2" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.2.cmml">t</mi><mrow id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.cmml"><mi id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.2" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.3" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1a" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.4" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1b" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.5" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1c" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.6" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1d" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.7" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.7.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p4.5.m5.1b"><apply id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.cmml" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.2">𝑡</ci><apply id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3"><times id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1.cmml" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.1"></times><ci id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.2.cmml" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.2">𝑟</ci><ci id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.3.cmml" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.3">𝑐</ci><ci id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.4.cmml" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.4">ℎ</ci><ci id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.5.cmml" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.5">𝑖</ci><ci id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.6.cmml" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.6">𝑙</ci><ci id="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.7.cmml" xref="Sx3.SSx5.SSSx1.p4.5.m5.1.1.3.7">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p4.5.m5.1c">t_{rchild}</annotation></semantics></math> back to the client.</p>
</div>
<div id="Sx3.SSx5.SSSx1.p5" class="ltx_para">
<p id="Sx3.SSx5.SSSx1.p5.6" class="ltx_p">The client processes the values received from the server, decrypting <math id="Sx3.SSx5.SSSx1.p5.1.m1.1" class="ltx_Math" alttext="c_{0}" display="inline"><semantics id="Sx3.SSx5.SSSx1.p5.1.m1.1a"><msub id="Sx3.SSx5.SSSx1.p5.1.m1.1.1" xref="Sx3.SSx5.SSSx1.p5.1.m1.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p5.1.m1.1.1.2" xref="Sx3.SSx5.SSSx1.p5.1.m1.1.1.2.cmml">c</mi><mn id="Sx3.SSx5.SSSx1.p5.1.m1.1.1.3" xref="Sx3.SSx5.SSSx1.p5.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p5.1.m1.1b"><apply id="Sx3.SSx5.SSSx1.p5.1.m1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx1.p5.1.m1.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx1.p5.1.m1.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p5.1.m1.1.1.2">𝑐</ci><cn type="integer" id="Sx3.SSx5.SSSx1.p5.1.m1.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p5.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p5.1.m1.1c">c_{0}</annotation></semantics></math> and utilizing its result to determine the next <math id="Sx3.SSx5.SSSx1.p5.2.m2.1" class="ltx_Math" alttext="pivot" display="inline"><semantics id="Sx3.SSx5.SSSx1.p5.2.m2.1a"><mrow id="Sx3.SSx5.SSSx1.p5.2.m2.1.1" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.2" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.1" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.3" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.1a" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.4" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.1b" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.5" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.1c" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.6" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p5.2.m2.1b"><apply id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1"><times id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.1"></times><ci id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.2">𝑝</ci><ci id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.3">𝑖</ci><ci id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.4.cmml" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.4">𝑣</ci><ci id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.5.cmml" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.5">𝑜</ci><ci id="Sx3.SSx5.SSSx1.p5.2.m2.1.1.6.cmml" xref="Sx3.SSx5.SSSx1.p5.2.m2.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p5.2.m2.1c">pivot</annotation></semantics></math> value. Depending on the decryption outcome, the <math id="Sx3.SSx5.SSSx1.p5.3.m3.1" class="ltx_Math" alttext="pivot" display="inline"><semantics id="Sx3.SSx5.SSSx1.p5.3.m3.1a"><mrow id="Sx3.SSx5.SSSx1.p5.3.m3.1.1" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.2" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.1" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.3" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.1a" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.4" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.1b" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.5" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.1c" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.6" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p5.3.m3.1b"><apply id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1"><times id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.1"></times><ci id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.2">𝑝</ci><ci id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.3">𝑖</ci><ci id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.4.cmml" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.4">𝑣</ci><ci id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.5.cmml" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.5">𝑜</ci><ci id="Sx3.SSx5.SSSx1.p5.3.m3.1.1.6.cmml" xref="Sx3.SSx5.SSSx1.p5.3.m3.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p5.3.m3.1c">pivot</annotation></semantics></math> value is either doubled (in the case of the left child) or incremented by one (for the right child). If the updated <math id="Sx3.SSx5.SSSx1.p5.4.m4.1" class="ltx_Math" alttext="pivot" display="inline"><semantics id="Sx3.SSx5.SSSx1.p5.4.m4.1a"><mrow id="Sx3.SSx5.SSSx1.p5.4.m4.1.1" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.2" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.1" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.3" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.1a" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.4" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.1b" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.5" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.1c" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.6" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p5.4.m4.1b"><apply id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1"><times id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.1"></times><ci id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.2">𝑝</ci><ci id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.3">𝑖</ci><ci id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.4.cmml" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.4">𝑣</ci><ci id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.5.cmml" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.5">𝑜</ci><ci id="Sx3.SSx5.SSSx1.p5.4.m4.1.1.6.cmml" xref="Sx3.SSx5.SSSx1.p5.4.m4.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p5.4.m4.1c">pivot</annotation></semantics></math> value surpasses the maximum index of the binary tree, the client concludes its operation and directly returns the <math id="Sx3.SSx5.SSSx1.p5.5.m5.1" class="ltx_Math" alttext="pivot" display="inline"><semantics id="Sx3.SSx5.SSSx1.p5.5.m5.1a"><mrow id="Sx3.SSx5.SSSx1.p5.5.m5.1.1" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.2" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.1" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.3" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.1a" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.4" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.1b" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.5" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.1c" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.6" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p5.5.m5.1b"><apply id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1"><times id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.1"></times><ci id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.2">𝑝</ci><ci id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.3">𝑖</ci><ci id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.4.cmml" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.4">𝑣</ci><ci id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.5.cmml" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.5">𝑜</ci><ci id="Sx3.SSx5.SSSx1.p5.5.m5.1.1.6.cmml" xref="Sx3.SSx5.SSSx1.p5.5.m5.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p5.5.m5.1c">pivot</annotation></semantics></math> value, indicating the index of the target value. If the maximum index is not reached, the client continues the interaction by sending the updated <math id="Sx3.SSx5.SSSx1.p5.6.m6.1" class="ltx_Math" alttext="pivot" display="inline"><semantics id="Sx3.SSx5.SSSx1.p5.6.m6.1a"><mrow id="Sx3.SSx5.SSSx1.p5.6.m6.1.1" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.cmml"><mi id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.2" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.1" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.3" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.1a" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.4" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.1b" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.5" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.1c" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.6" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx1.p5.6.m6.1b"><apply id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1"><times id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.1.cmml" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.1"></times><ci id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.2.cmml" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.2">𝑝</ci><ci id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.3.cmml" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.3">𝑖</ci><ci id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.4.cmml" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.4">𝑣</ci><ci id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.5.cmml" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.5">𝑜</ci><ci id="Sx3.SSx5.SSSx1.p5.6.m6.1.1.6.cmml" xref="Sx3.SSx5.SSSx1.p5.6.m6.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx1.p5.6.m6.1c">pivot</annotation></semantics></math> value back to the server for the subsequent iteration.</p>
</div>
<figure id="alg2" class="ltx_float ltx_algorithm">
<div id="alg2.18" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg2.1.1" class="ltx_listingline">


<span id="alg2.1.1.1" class="ltx_text"><span id="alg2.1.1.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>
A target (encrypted) value <math id="alg2.1.1.m1.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="alg2.1.1.m1.1a"><msub id="alg2.1.1.m1.1.1" xref="alg2.1.1.m1.1.1.cmml"><mi id="alg2.1.1.m1.1.1.2" xref="alg2.1.1.m1.1.1.2.cmml">c</mi><mi id="alg2.1.1.m1.1.1.3" xref="alg2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.1.1.m1.1b"><apply id="alg2.1.1.m1.1.1.cmml" xref="alg2.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.1.1.m1.1.1.1.cmml" xref="alg2.1.1.m1.1.1">subscript</csymbol><ci id="alg2.1.1.m1.1.1.2.cmml" xref="alg2.1.1.m1.1.1.2">𝑐</ci><ci id="alg2.1.1.m1.1.1.3.cmml" xref="alg2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.m1.1c">c_{t}</annotation></semantics></math> to be searched on the server;

</div>
<div id="alg2.2.2" class="ltx_listingline">
<span id="alg2.2.2.1" class="ltx_text"><span id="alg2.2.2.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>
The index <math id="alg2.2.2.m1.2" class="ltx_Math" alttext="pivot\in[0,n)" display="inline"><semantics id="alg2.2.2.m1.2a"><mrow id="alg2.2.2.m1.2.3" xref="alg2.2.2.m1.2.3.cmml"><mrow id="alg2.2.2.m1.2.3.2" xref="alg2.2.2.m1.2.3.2.cmml"><mi id="alg2.2.2.m1.2.3.2.2" xref="alg2.2.2.m1.2.3.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.2.2.m1.2.3.2.1" xref="alg2.2.2.m1.2.3.2.1.cmml">​</mo><mi id="alg2.2.2.m1.2.3.2.3" xref="alg2.2.2.m1.2.3.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.2.2.m1.2.3.2.1a" xref="alg2.2.2.m1.2.3.2.1.cmml">​</mo><mi id="alg2.2.2.m1.2.3.2.4" xref="alg2.2.2.m1.2.3.2.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.2.2.m1.2.3.2.1b" xref="alg2.2.2.m1.2.3.2.1.cmml">​</mo><mi id="alg2.2.2.m1.2.3.2.5" xref="alg2.2.2.m1.2.3.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.2.2.m1.2.3.2.1c" xref="alg2.2.2.m1.2.3.2.1.cmml">​</mo><mi id="alg2.2.2.m1.2.3.2.6" xref="alg2.2.2.m1.2.3.2.6.cmml">t</mi></mrow><mo id="alg2.2.2.m1.2.3.1" xref="alg2.2.2.m1.2.3.1.cmml">∈</mo><mrow id="alg2.2.2.m1.2.3.3.2" xref="alg2.2.2.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg2.2.2.m1.2.3.3.2.1" xref="alg2.2.2.m1.2.3.3.1.cmml">[</mo><mn id="alg2.2.2.m1.1.1" xref="alg2.2.2.m1.1.1.cmml">0</mn><mo id="alg2.2.2.m1.2.3.3.2.2" xref="alg2.2.2.m1.2.3.3.1.cmml">,</mo><mi id="alg2.2.2.m1.2.2" xref="alg2.2.2.m1.2.2.cmml">n</mi><mo stretchy="false" id="alg2.2.2.m1.2.3.3.2.3" xref="alg2.2.2.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.2.2.m1.2b"><apply id="alg2.2.2.m1.2.3.cmml" xref="alg2.2.2.m1.2.3"><in id="alg2.2.2.m1.2.3.1.cmml" xref="alg2.2.2.m1.2.3.1"></in><apply id="alg2.2.2.m1.2.3.2.cmml" xref="alg2.2.2.m1.2.3.2"><times id="alg2.2.2.m1.2.3.2.1.cmml" xref="alg2.2.2.m1.2.3.2.1"></times><ci id="alg2.2.2.m1.2.3.2.2.cmml" xref="alg2.2.2.m1.2.3.2.2">𝑝</ci><ci id="alg2.2.2.m1.2.3.2.3.cmml" xref="alg2.2.2.m1.2.3.2.3">𝑖</ci><ci id="alg2.2.2.m1.2.3.2.4.cmml" xref="alg2.2.2.m1.2.3.2.4">𝑣</ci><ci id="alg2.2.2.m1.2.3.2.5.cmml" xref="alg2.2.2.m1.2.3.2.5">𝑜</ci><ci id="alg2.2.2.m1.2.3.2.6.cmml" xref="alg2.2.2.m1.2.3.2.6">𝑡</ci></apply><interval closure="closed-open" id="alg2.2.2.m1.2.3.3.1.cmml" xref="alg2.2.2.m1.2.3.3.2"><cn type="integer" id="alg2.2.2.m1.1.1.cmml" xref="alg2.2.2.m1.1.1">0</cn><ci id="alg2.2.2.m1.2.2.cmml" xref="alg2.2.2.m1.2.2">𝑛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.m1.2c">pivot\in[0,n)</annotation></semantics></math> of the target value on the server; -1 if not found

</div>
<div id="alg2.18.19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>

</div>
<div id="alg2.18.20" class="ltx_listingline">
</div>
<div id="alg2.18.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>

</div>
<div id="alg2.18.22" class="ltx_listingline">// On the server:
</div>
<div id="alg2.18.23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>

</div>
<div id="alg2.3.3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span><math id="alg2.3.3.m1.1" class="ltx_Math" alttext="\textbf{t}\coloneqq\text{PairwiseMul}(c_{t})" display="inline"><semantics id="alg2.3.3.m1.1a"><mrow id="alg2.3.3.m1.1.1" xref="alg2.3.3.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg2.3.3.m1.1.1.3" xref="alg2.3.3.m1.1.1.3a.cmml">t</mtext><mo id="alg2.3.3.m1.1.1.2" xref="alg2.3.3.m1.1.1.2.cmml">≔</mo><mrow id="alg2.3.3.m1.1.1.1" xref="alg2.3.3.m1.1.1.1.cmml"><mtext id="alg2.3.3.m1.1.1.1.3" xref="alg2.3.3.m1.1.1.1.3a.cmml">PairwiseMul</mtext><mo lspace="0em" rspace="0em" id="alg2.3.3.m1.1.1.1.2" xref="alg2.3.3.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.3.3.m1.1.1.1.1.1" xref="alg2.3.3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.3.3.m1.1.1.1.1.1.2" xref="alg2.3.3.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.3.3.m1.1.1.1.1.1.1" xref="alg2.3.3.m1.1.1.1.1.1.1.cmml"><mi id="alg2.3.3.m1.1.1.1.1.1.1.2" xref="alg2.3.3.m1.1.1.1.1.1.1.2.cmml">c</mi><mi id="alg2.3.3.m1.1.1.1.1.1.1.3" xref="alg2.3.3.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="alg2.3.3.m1.1.1.1.1.1.3" xref="alg2.3.3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.3.3.m1.1b"><apply id="alg2.3.3.m1.1.1.cmml" xref="alg2.3.3.m1.1.1"><ci id="alg2.3.3.m1.1.1.2.cmml" xref="alg2.3.3.m1.1.1.2">≔</ci><ci id="alg2.3.3.m1.1.1.3a.cmml" xref="alg2.3.3.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="alg2.3.3.m1.1.1.3.cmml" xref="alg2.3.3.m1.1.1.3">t</mtext></ci><apply id="alg2.3.3.m1.1.1.1.cmml" xref="alg2.3.3.m1.1.1.1"><times id="alg2.3.3.m1.1.1.1.2.cmml" xref="alg2.3.3.m1.1.1.1.2"></times><ci id="alg2.3.3.m1.1.1.1.3a.cmml" xref="alg2.3.3.m1.1.1.1.3"><mtext id="alg2.3.3.m1.1.1.1.3.cmml" xref="alg2.3.3.m1.1.1.1.3">PairwiseMul</mtext></ci><apply id="alg2.3.3.m1.1.1.1.1.1.1.cmml" xref="alg2.3.3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.3.3.m1.1.1.1.1.1.1.1.cmml" xref="alg2.3.3.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.3.3.m1.1.1.1.1.1.1.2.cmml" xref="alg2.3.3.m1.1.1.1.1.1.1.2">𝑐</ci><ci id="alg2.3.3.m1.1.1.1.1.1.1.3.cmml" xref="alg2.3.3.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.3.m1.1c">\textbf{t}\coloneqq\text{PairwiseMul}(c_{t})</annotation></semantics></math>
</div>
<div id="alg2.4.4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>
Server sends <math id="alg2.4.4.m1.1" class="ltx_Math" alttext="t_{1}=\textbf{t}[1]" display="inline"><semantics id="alg2.4.4.m1.1a"><mrow id="alg2.4.4.m1.1.2" xref="alg2.4.4.m1.1.2.cmml"><msub id="alg2.4.4.m1.1.2.2" xref="alg2.4.4.m1.1.2.2.cmml"><mi id="alg2.4.4.m1.1.2.2.2" xref="alg2.4.4.m1.1.2.2.2.cmml">t</mi><mn id="alg2.4.4.m1.1.2.2.3" xref="alg2.4.4.m1.1.2.2.3.cmml">1</mn></msub><mo id="alg2.4.4.m1.1.2.1" xref="alg2.4.4.m1.1.2.1.cmml">=</mo><mrow id="alg2.4.4.m1.1.2.3" xref="alg2.4.4.m1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="alg2.4.4.m1.1.2.3.2" xref="alg2.4.4.m1.1.2.3.2a.cmml">t</mtext><mo lspace="0em" rspace="0em" id="alg2.4.4.m1.1.2.3.1" xref="alg2.4.4.m1.1.2.3.1.cmml">​</mo><mrow id="alg2.4.4.m1.1.2.3.3.2" xref="alg2.4.4.m1.1.2.3.3.1.cmml"><mo stretchy="false" id="alg2.4.4.m1.1.2.3.3.2.1" xref="alg2.4.4.m1.1.2.3.3.1.1.cmml">[</mo><mn id="alg2.4.4.m1.1.1" xref="alg2.4.4.m1.1.1.cmml">1</mn><mo stretchy="false" id="alg2.4.4.m1.1.2.3.3.2.2" xref="alg2.4.4.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.4.4.m1.1b"><apply id="alg2.4.4.m1.1.2.cmml" xref="alg2.4.4.m1.1.2"><eq id="alg2.4.4.m1.1.2.1.cmml" xref="alg2.4.4.m1.1.2.1"></eq><apply id="alg2.4.4.m1.1.2.2.cmml" xref="alg2.4.4.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.4.4.m1.1.2.2.1.cmml" xref="alg2.4.4.m1.1.2.2">subscript</csymbol><ci id="alg2.4.4.m1.1.2.2.2.cmml" xref="alg2.4.4.m1.1.2.2.2">𝑡</ci><cn type="integer" id="alg2.4.4.m1.1.2.2.3.cmml" xref="alg2.4.4.m1.1.2.2.3">1</cn></apply><apply id="alg2.4.4.m1.1.2.3.cmml" xref="alg2.4.4.m1.1.2.3"><times id="alg2.4.4.m1.1.2.3.1.cmml" xref="alg2.4.4.m1.1.2.3.1"></times><ci id="alg2.4.4.m1.1.2.3.2a.cmml" xref="alg2.4.4.m1.1.2.3.2"><mtext class="ltx_mathvariant_bold" id="alg2.4.4.m1.1.2.3.2.cmml" xref="alg2.4.4.m1.1.2.3.2">t</mtext></ci><apply id="alg2.4.4.m1.1.2.3.3.1.cmml" xref="alg2.4.4.m1.1.2.3.3.2"><csymbol cd="latexml" id="alg2.4.4.m1.1.2.3.3.1.1.cmml" xref="alg2.4.4.m1.1.2.3.3.2.1">delimited-[]</csymbol><cn type="integer" id="alg2.4.4.m1.1.1.cmml" xref="alg2.4.4.m1.1.1">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.4.m1.1c">t_{1}=\textbf{t}[1]</annotation></semantics></math> to client
</div>
<div id="alg2.18.24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>

</div>
<div id="alg2.18.25" class="ltx_listingline">
</div>
<div id="alg2.18.26" class="ltx_listingline">
// On the client:
</div>
<div id="alg2.18.27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>

</div>
<div id="alg2.5.5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span><span id="alg2.5.5.2" class="ltx_text ltx_font_bold">if</span> <em id="alg2.5.5.1" class="ltx_emph ltx_font_italic"><math id="alg2.5.5.1.m1.1" class="ltx_Math" alttext="0\not=Dec(t_{1})" display="inline"><semantics id="alg2.5.5.1.m1.1a"><mrow id="alg2.5.5.1.m1.1.1" xref="alg2.5.5.1.m1.1.1.cmml"><mn id="alg2.5.5.1.m1.1.1.3" xref="alg2.5.5.1.m1.1.1.3.cmml">0</mn><mo id="alg2.5.5.1.m1.1.1.2" xref="alg2.5.5.1.m1.1.1.2.cmml">≠</mo><mrow id="alg2.5.5.1.m1.1.1.1" xref="alg2.5.5.1.m1.1.1.1.cmml"><mi id="alg2.5.5.1.m1.1.1.1.3" xref="alg2.5.5.1.m1.1.1.1.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="alg2.5.5.1.m1.1.1.1.2" xref="alg2.5.5.1.m1.1.1.1.2.cmml">​</mo><mi id="alg2.5.5.1.m1.1.1.1.4" xref="alg2.5.5.1.m1.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.5.5.1.m1.1.1.1.2a" xref="alg2.5.5.1.m1.1.1.1.2.cmml">​</mo><mi id="alg2.5.5.1.m1.1.1.1.5" xref="alg2.5.5.1.m1.1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.5.5.1.m1.1.1.1.2b" xref="alg2.5.5.1.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.5.5.1.m1.1.1.1.1.1" xref="alg2.5.5.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.5.5.1.m1.1.1.1.1.1.2" xref="alg2.5.5.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.5.5.1.m1.1.1.1.1.1.1" xref="alg2.5.5.1.m1.1.1.1.1.1.1.cmml"><mi id="alg2.5.5.1.m1.1.1.1.1.1.1.2" xref="alg2.5.5.1.m1.1.1.1.1.1.1.2.cmml">t</mi><mn id="alg2.5.5.1.m1.1.1.1.1.1.1.3" xref="alg2.5.5.1.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="alg2.5.5.1.m1.1.1.1.1.1.3" xref="alg2.5.5.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.5.5.1.m1.1b"><apply id="alg2.5.5.1.m1.1.1.cmml" xref="alg2.5.5.1.m1.1.1"><neq id="alg2.5.5.1.m1.1.1.2.cmml" xref="alg2.5.5.1.m1.1.1.2"></neq><cn type="integer" id="alg2.5.5.1.m1.1.1.3.cmml" xref="alg2.5.5.1.m1.1.1.3">0</cn><apply id="alg2.5.5.1.m1.1.1.1.cmml" xref="alg2.5.5.1.m1.1.1.1"><times id="alg2.5.5.1.m1.1.1.1.2.cmml" xref="alg2.5.5.1.m1.1.1.1.2"></times><ci id="alg2.5.5.1.m1.1.1.1.3.cmml" xref="alg2.5.5.1.m1.1.1.1.3">𝐷</ci><ci id="alg2.5.5.1.m1.1.1.1.4.cmml" xref="alg2.5.5.1.m1.1.1.1.4">𝑒</ci><ci id="alg2.5.5.1.m1.1.1.1.5.cmml" xref="alg2.5.5.1.m1.1.1.1.5">𝑐</ci><apply id="alg2.5.5.1.m1.1.1.1.1.1.1.cmml" xref="alg2.5.5.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.5.5.1.m1.1.1.1.1.1.1.1.cmml" xref="alg2.5.5.1.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.5.5.1.m1.1.1.1.1.1.1.2.cmml" xref="alg2.5.5.1.m1.1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg2.5.5.1.m1.1.1.1.1.1.1.3.cmml" xref="alg2.5.5.1.m1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.5.1.m1.1c">0\not=Dec(t_{1})</annotation></semantics></math></em> <span id="alg2.5.5.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="alg2.18.28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg2.18.28.1" class="ltx_text ltx_font_bold">return</span> -1
</div>
<div id="alg2.18.29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.18.30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>
<span id="alg2.18.30.1" class="ltx_text ltx_font_bold">else</span> 
</div>
<div id="alg2.6.6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Sends message <math id="alg2.6.6.m1.1" class="ltx_Math" alttext="pivot=1" display="inline"><semantics id="alg2.6.6.m1.1a"><mrow id="alg2.6.6.m1.1.1" xref="alg2.6.6.m1.1.1.cmml"><mrow id="alg2.6.6.m1.1.1.2" xref="alg2.6.6.m1.1.1.2.cmml"><mi id="alg2.6.6.m1.1.1.2.2" xref="alg2.6.6.m1.1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.6.6.m1.1.1.2.1" xref="alg2.6.6.m1.1.1.2.1.cmml">​</mo><mi id="alg2.6.6.m1.1.1.2.3" xref="alg2.6.6.m1.1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.6.6.m1.1.1.2.1a" xref="alg2.6.6.m1.1.1.2.1.cmml">​</mo><mi id="alg2.6.6.m1.1.1.2.4" xref="alg2.6.6.m1.1.1.2.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.6.6.m1.1.1.2.1b" xref="alg2.6.6.m1.1.1.2.1.cmml">​</mo><mi id="alg2.6.6.m1.1.1.2.5" xref="alg2.6.6.m1.1.1.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.6.6.m1.1.1.2.1c" xref="alg2.6.6.m1.1.1.2.1.cmml">​</mo><mi id="alg2.6.6.m1.1.1.2.6" xref="alg2.6.6.m1.1.1.2.6.cmml">t</mi></mrow><mo id="alg2.6.6.m1.1.1.1" xref="alg2.6.6.m1.1.1.1.cmml">=</mo><mn id="alg2.6.6.m1.1.1.3" xref="alg2.6.6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.6.6.m1.1b"><apply id="alg2.6.6.m1.1.1.cmml" xref="alg2.6.6.m1.1.1"><eq id="alg2.6.6.m1.1.1.1.cmml" xref="alg2.6.6.m1.1.1.1"></eq><apply id="alg2.6.6.m1.1.1.2.cmml" xref="alg2.6.6.m1.1.1.2"><times id="alg2.6.6.m1.1.1.2.1.cmml" xref="alg2.6.6.m1.1.1.2.1"></times><ci id="alg2.6.6.m1.1.1.2.2.cmml" xref="alg2.6.6.m1.1.1.2.2">𝑝</ci><ci id="alg2.6.6.m1.1.1.2.3.cmml" xref="alg2.6.6.m1.1.1.2.3">𝑖</ci><ci id="alg2.6.6.m1.1.1.2.4.cmml" xref="alg2.6.6.m1.1.1.2.4">𝑣</ci><ci id="alg2.6.6.m1.1.1.2.5.cmml" xref="alg2.6.6.m1.1.1.2.5">𝑜</ci><ci id="alg2.6.6.m1.1.1.2.6.cmml" xref="alg2.6.6.m1.1.1.2.6">𝑡</ci></apply><cn type="integer" id="alg2.6.6.m1.1.1.3.cmml" xref="alg2.6.6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.6.m1.1c">pivot=1</annotation></semantics></math> to the server
</div>
<div id="alg2.18.31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.18.32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span> end if
</div>
<div id="alg2.18.33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>
</div>
<div id="alg2.18.34" class="ltx_listingline">
</div>
<div id="alg2.18.35" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span>

</div>
<div id="alg2.7.7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span><span id="alg2.7.7.2" class="ltx_text ltx_font_bold">for</span> <em id="alg2.7.7.1" class="ltx_emph ltx_font_italic"><math id="alg2.7.7.1.m1.2" class="ltx_Math" alttext="lvl\coloneqq 1;lvl\leq\log n;lvl\coloneqq lvl+1" display="inline"><semantics id="alg2.7.7.1.m1.2a"><mrow id="alg2.7.7.1.m1.2.2.2" xref="alg2.7.7.1.m1.2.2.3.cmml"><mrow id="alg2.7.7.1.m1.1.1.1.1" xref="alg2.7.7.1.m1.1.1.1.1.cmml"><mrow id="alg2.7.7.1.m1.1.1.1.1.2" xref="alg2.7.7.1.m1.1.1.1.1.2.cmml"><mi id="alg2.7.7.1.m1.1.1.1.1.2.2" xref="alg2.7.7.1.m1.1.1.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.1.m1.1.1.1.1.2.1" xref="alg2.7.7.1.m1.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.7.7.1.m1.1.1.1.1.2.3" xref="alg2.7.7.1.m1.1.1.1.1.2.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.1.m1.1.1.1.1.2.1a" xref="alg2.7.7.1.m1.1.1.1.1.2.1.cmml">​</mo><mi id="alg2.7.7.1.m1.1.1.1.1.2.4" xref="alg2.7.7.1.m1.1.1.1.1.2.4.cmml">l</mi></mrow><mo id="alg2.7.7.1.m1.1.1.1.1.1" xref="alg2.7.7.1.m1.1.1.1.1.1.cmml">≔</mo><mn id="alg2.7.7.1.m1.1.1.1.1.3" xref="alg2.7.7.1.m1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg2.7.7.1.m1.2.2.2.3" xref="alg2.7.7.1.m1.2.2.3a.cmml">;</mo><mrow id="alg2.7.7.1.m1.2.2.2.2.2" xref="alg2.7.7.1.m1.2.2.2.2.3.cmml"><mrow id="alg2.7.7.1.m1.2.2.2.2.1.1" xref="alg2.7.7.1.m1.2.2.2.2.1.1.cmml"><mrow id="alg2.7.7.1.m1.2.2.2.2.1.1.2" xref="alg2.7.7.1.m1.2.2.2.2.1.1.2.cmml"><mi id="alg2.7.7.1.m1.2.2.2.2.1.1.2.2" xref="alg2.7.7.1.m1.2.2.2.2.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.1.m1.2.2.2.2.1.1.2.1" xref="alg2.7.7.1.m1.2.2.2.2.1.1.2.1.cmml">​</mo><mi id="alg2.7.7.1.m1.2.2.2.2.1.1.2.3" xref="alg2.7.7.1.m1.2.2.2.2.1.1.2.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.1.m1.2.2.2.2.1.1.2.1a" xref="alg2.7.7.1.m1.2.2.2.2.1.1.2.1.cmml">​</mo><mi id="alg2.7.7.1.m1.2.2.2.2.1.1.2.4" xref="alg2.7.7.1.m1.2.2.2.2.1.1.2.4.cmml">l</mi></mrow><mo id="alg2.7.7.1.m1.2.2.2.2.1.1.1" xref="alg2.7.7.1.m1.2.2.2.2.1.1.1.cmml">≤</mo><mrow id="alg2.7.7.1.m1.2.2.2.2.1.1.3" xref="alg2.7.7.1.m1.2.2.2.2.1.1.3.cmml"><mi id="alg2.7.7.1.m1.2.2.2.2.1.1.3.1" xref="alg2.7.7.1.m1.2.2.2.2.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="alg2.7.7.1.m1.2.2.2.2.1.1.3a" xref="alg2.7.7.1.m1.2.2.2.2.1.1.3.cmml">⁡</mo><mi id="alg2.7.7.1.m1.2.2.2.2.1.1.3.2" xref="alg2.7.7.1.m1.2.2.2.2.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="alg2.7.7.1.m1.2.2.2.2.2.3" xref="alg2.7.7.1.m1.2.2.2.2.3a.cmml">;</mo><mrow id="alg2.7.7.1.m1.2.2.2.2.2.2" xref="alg2.7.7.1.m1.2.2.2.2.2.2.cmml"><mrow id="alg2.7.7.1.m1.2.2.2.2.2.2.2" xref="alg2.7.7.1.m1.2.2.2.2.2.2.2.cmml"><mi id="alg2.7.7.1.m1.2.2.2.2.2.2.2.2" xref="alg2.7.7.1.m1.2.2.2.2.2.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.1.m1.2.2.2.2.2.2.2.1" xref="alg2.7.7.1.m1.2.2.2.2.2.2.2.1.cmml">​</mo><mi id="alg2.7.7.1.m1.2.2.2.2.2.2.2.3" xref="alg2.7.7.1.m1.2.2.2.2.2.2.2.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.1.m1.2.2.2.2.2.2.2.1a" xref="alg2.7.7.1.m1.2.2.2.2.2.2.2.1.cmml">​</mo><mi id="alg2.7.7.1.m1.2.2.2.2.2.2.2.4" xref="alg2.7.7.1.m1.2.2.2.2.2.2.2.4.cmml">l</mi></mrow><mo id="alg2.7.7.1.m1.2.2.2.2.2.2.1" xref="alg2.7.7.1.m1.2.2.2.2.2.2.1.cmml">≔</mo><mrow id="alg2.7.7.1.m1.2.2.2.2.2.2.3" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.cmml"><mrow id="alg2.7.7.1.m1.2.2.2.2.2.2.3.2" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.cmml"><mi id="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.2" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.1" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.1.cmml">​</mo><mi id="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.3" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.1a" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.1.cmml">​</mo><mi id="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.4" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.4.cmml">l</mi></mrow><mo id="alg2.7.7.1.m1.2.2.2.2.2.2.3.1" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.1.cmml">+</mo><mn id="alg2.7.7.1.m1.2.2.2.2.2.2.3.3" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.7.7.1.m1.2b"><apply id="alg2.7.7.1.m1.2.2.3.cmml" xref="alg2.7.7.1.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.7.7.1.m1.2.2.3a.cmml" xref="alg2.7.7.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.7.7.1.m1.1.1.1.1.cmml" xref="alg2.7.7.1.m1.1.1.1.1"><ci id="alg2.7.7.1.m1.1.1.1.1.1.cmml" xref="alg2.7.7.1.m1.1.1.1.1.1">≔</ci><apply id="alg2.7.7.1.m1.1.1.1.1.2.cmml" xref="alg2.7.7.1.m1.1.1.1.1.2"><times id="alg2.7.7.1.m1.1.1.1.1.2.1.cmml" xref="alg2.7.7.1.m1.1.1.1.1.2.1"></times><ci id="alg2.7.7.1.m1.1.1.1.1.2.2.cmml" xref="alg2.7.7.1.m1.1.1.1.1.2.2">𝑙</ci><ci id="alg2.7.7.1.m1.1.1.1.1.2.3.cmml" xref="alg2.7.7.1.m1.1.1.1.1.2.3">𝑣</ci><ci id="alg2.7.7.1.m1.1.1.1.1.2.4.cmml" xref="alg2.7.7.1.m1.1.1.1.1.2.4">𝑙</ci></apply><cn type="integer" id="alg2.7.7.1.m1.1.1.1.1.3.cmml" xref="alg2.7.7.1.m1.1.1.1.1.3">1</cn></apply><apply id="alg2.7.7.1.m1.2.2.2.2.3.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.7.7.1.m1.2.2.2.2.3a.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.7.7.1.m1.2.2.2.2.1.1.cmml" xref="alg2.7.7.1.m1.2.2.2.2.1.1"><leq id="alg2.7.7.1.m1.2.2.2.2.1.1.1.cmml" xref="alg2.7.7.1.m1.2.2.2.2.1.1.1"></leq><apply id="alg2.7.7.1.m1.2.2.2.2.1.1.2.cmml" xref="alg2.7.7.1.m1.2.2.2.2.1.1.2"><times id="alg2.7.7.1.m1.2.2.2.2.1.1.2.1.cmml" xref="alg2.7.7.1.m1.2.2.2.2.1.1.2.1"></times><ci id="alg2.7.7.1.m1.2.2.2.2.1.1.2.2.cmml" xref="alg2.7.7.1.m1.2.2.2.2.1.1.2.2">𝑙</ci><ci id="alg2.7.7.1.m1.2.2.2.2.1.1.2.3.cmml" xref="alg2.7.7.1.m1.2.2.2.2.1.1.2.3">𝑣</ci><ci id="alg2.7.7.1.m1.2.2.2.2.1.1.2.4.cmml" xref="alg2.7.7.1.m1.2.2.2.2.1.1.2.4">𝑙</ci></apply><apply id="alg2.7.7.1.m1.2.2.2.2.1.1.3.cmml" xref="alg2.7.7.1.m1.2.2.2.2.1.1.3"><log id="alg2.7.7.1.m1.2.2.2.2.1.1.3.1.cmml" xref="alg2.7.7.1.m1.2.2.2.2.1.1.3.1"></log><ci id="alg2.7.7.1.m1.2.2.2.2.1.1.3.2.cmml" xref="alg2.7.7.1.m1.2.2.2.2.1.1.3.2">𝑛</ci></apply></apply><apply id="alg2.7.7.1.m1.2.2.2.2.2.2.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2"><ci id="alg2.7.7.1.m1.2.2.2.2.2.2.1.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.1">≔</ci><apply id="alg2.7.7.1.m1.2.2.2.2.2.2.2.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.2"><times id="alg2.7.7.1.m1.2.2.2.2.2.2.2.1.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.2.1"></times><ci id="alg2.7.7.1.m1.2.2.2.2.2.2.2.2.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.2.2">𝑙</ci><ci id="alg2.7.7.1.m1.2.2.2.2.2.2.2.3.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.2.3">𝑣</ci><ci id="alg2.7.7.1.m1.2.2.2.2.2.2.2.4.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.2.4">𝑙</ci></apply><apply id="alg2.7.7.1.m1.2.2.2.2.2.2.3.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3"><plus id="alg2.7.7.1.m1.2.2.2.2.2.2.3.1.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.1"></plus><apply id="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.2"><times id="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.1.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.1"></times><ci id="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.2.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.2">𝑙</ci><ci id="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.3.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.3">𝑣</ci><ci id="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.4.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.2.4">𝑙</ci></apply><cn type="integer" id="alg2.7.7.1.m1.2.2.2.2.2.2.3.3.cmml" xref="alg2.7.7.1.m1.2.2.2.2.2.2.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.7.7.1.m1.2c">lvl\coloneqq 1;lvl\leq\log n;lvl\coloneqq lvl+1</annotation></semantics></math></em> <span id="alg2.7.7.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="alg2.18.36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.18.37" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg2.18.38" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
// On the server:
</div>
<div id="alg2.18.39" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Receives message <math id="alg2.8.8.m1.1" class="ltx_Math" alttext="pivot" display="inline"><semantics id="alg2.8.8.m1.1a"><mrow id="alg2.8.8.m1.1.1" xref="alg2.8.8.m1.1.1.cmml"><mi id="alg2.8.8.m1.1.1.2" xref="alg2.8.8.m1.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.8.8.m1.1.1.1" xref="alg2.8.8.m1.1.1.1.cmml">​</mo><mi id="alg2.8.8.m1.1.1.3" xref="alg2.8.8.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.8.8.m1.1.1.1a" xref="alg2.8.8.m1.1.1.1.cmml">​</mo><mi id="alg2.8.8.m1.1.1.4" xref="alg2.8.8.m1.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.8.8.m1.1.1.1b" xref="alg2.8.8.m1.1.1.1.cmml">​</mo><mi id="alg2.8.8.m1.1.1.5" xref="alg2.8.8.m1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.8.8.m1.1.1.1c" xref="alg2.8.8.m1.1.1.1.cmml">​</mo><mi id="alg2.8.8.m1.1.1.6" xref="alg2.8.8.m1.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.8.8.m1.1b"><apply id="alg2.8.8.m1.1.1.cmml" xref="alg2.8.8.m1.1.1"><times id="alg2.8.8.m1.1.1.1.cmml" xref="alg2.8.8.m1.1.1.1"></times><ci id="alg2.8.8.m1.1.1.2.cmml" xref="alg2.8.8.m1.1.1.2">𝑝</ci><ci id="alg2.8.8.m1.1.1.3.cmml" xref="alg2.8.8.m1.1.1.3">𝑖</ci><ci id="alg2.8.8.m1.1.1.4.cmml" xref="alg2.8.8.m1.1.1.4">𝑣</ci><ci id="alg2.8.8.m1.1.1.5.cmml" xref="alg2.8.8.m1.1.1.5">𝑜</ci><ci id="alg2.8.8.m1.1.1.6.cmml" xref="alg2.8.8.m1.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.8.8.m1.1c">pivot</annotation></semantics></math>
</div>
<div id="alg2.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.9.9.m1.1" class="ltx_Math" alttext="lchild\coloneqq 2\cdot pivot" display="inline"><semantics id="alg2.9.9.m1.1a"><mrow id="alg2.9.9.m1.1.1" xref="alg2.9.9.m1.1.1.cmml"><mrow id="alg2.9.9.m1.1.1.2" xref="alg2.9.9.m1.1.1.2.cmml"><mi id="alg2.9.9.m1.1.1.2.2" xref="alg2.9.9.m1.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.9.9.m1.1.1.2.1" xref="alg2.9.9.m1.1.1.2.1.cmml">​</mo><mi id="alg2.9.9.m1.1.1.2.3" xref="alg2.9.9.m1.1.1.2.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.9.9.m1.1.1.2.1a" xref="alg2.9.9.m1.1.1.2.1.cmml">​</mo><mi id="alg2.9.9.m1.1.1.2.4" xref="alg2.9.9.m1.1.1.2.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg2.9.9.m1.1.1.2.1b" xref="alg2.9.9.m1.1.1.2.1.cmml">​</mo><mi id="alg2.9.9.m1.1.1.2.5" xref="alg2.9.9.m1.1.1.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.9.9.m1.1.1.2.1c" xref="alg2.9.9.m1.1.1.2.1.cmml">​</mo><mi id="alg2.9.9.m1.1.1.2.6" xref="alg2.9.9.m1.1.1.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.9.9.m1.1.1.2.1d" xref="alg2.9.9.m1.1.1.2.1.cmml">​</mo><mi id="alg2.9.9.m1.1.1.2.7" xref="alg2.9.9.m1.1.1.2.7.cmml">d</mi></mrow><mo id="alg2.9.9.m1.1.1.1" xref="alg2.9.9.m1.1.1.1.cmml">≔</mo><mrow id="alg2.9.9.m1.1.1.3" xref="alg2.9.9.m1.1.1.3.cmml"><mrow id="alg2.9.9.m1.1.1.3.2" xref="alg2.9.9.m1.1.1.3.2.cmml"><mn id="alg2.9.9.m1.1.1.3.2.2" xref="alg2.9.9.m1.1.1.3.2.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="alg2.9.9.m1.1.1.3.2.1" xref="alg2.9.9.m1.1.1.3.2.1.cmml">⋅</mo><mi id="alg2.9.9.m1.1.1.3.2.3" xref="alg2.9.9.m1.1.1.3.2.3.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.9.9.m1.1.1.3.1" xref="alg2.9.9.m1.1.1.3.1.cmml">​</mo><mi id="alg2.9.9.m1.1.1.3.3" xref="alg2.9.9.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.9.9.m1.1.1.3.1a" xref="alg2.9.9.m1.1.1.3.1.cmml">​</mo><mi id="alg2.9.9.m1.1.1.3.4" xref="alg2.9.9.m1.1.1.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.9.9.m1.1.1.3.1b" xref="alg2.9.9.m1.1.1.3.1.cmml">​</mo><mi id="alg2.9.9.m1.1.1.3.5" xref="alg2.9.9.m1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.9.9.m1.1.1.3.1c" xref="alg2.9.9.m1.1.1.3.1.cmml">​</mo><mi id="alg2.9.9.m1.1.1.3.6" xref="alg2.9.9.m1.1.1.3.6.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.9.9.m1.1b"><apply id="alg2.9.9.m1.1.1.cmml" xref="alg2.9.9.m1.1.1"><ci id="alg2.9.9.m1.1.1.1.cmml" xref="alg2.9.9.m1.1.1.1">≔</ci><apply id="alg2.9.9.m1.1.1.2.cmml" xref="alg2.9.9.m1.1.1.2"><times id="alg2.9.9.m1.1.1.2.1.cmml" xref="alg2.9.9.m1.1.1.2.1"></times><ci id="alg2.9.9.m1.1.1.2.2.cmml" xref="alg2.9.9.m1.1.1.2.2">𝑙</ci><ci id="alg2.9.9.m1.1.1.2.3.cmml" xref="alg2.9.9.m1.1.1.2.3">𝑐</ci><ci id="alg2.9.9.m1.1.1.2.4.cmml" xref="alg2.9.9.m1.1.1.2.4">ℎ</ci><ci id="alg2.9.9.m1.1.1.2.5.cmml" xref="alg2.9.9.m1.1.1.2.5">𝑖</ci><ci id="alg2.9.9.m1.1.1.2.6.cmml" xref="alg2.9.9.m1.1.1.2.6">𝑙</ci><ci id="alg2.9.9.m1.1.1.2.7.cmml" xref="alg2.9.9.m1.1.1.2.7">𝑑</ci></apply><apply id="alg2.9.9.m1.1.1.3.cmml" xref="alg2.9.9.m1.1.1.3"><times id="alg2.9.9.m1.1.1.3.1.cmml" xref="alg2.9.9.m1.1.1.3.1"></times><apply id="alg2.9.9.m1.1.1.3.2.cmml" xref="alg2.9.9.m1.1.1.3.2"><ci id="alg2.9.9.m1.1.1.3.2.1.cmml" xref="alg2.9.9.m1.1.1.3.2.1">⋅</ci><cn type="integer" id="alg2.9.9.m1.1.1.3.2.2.cmml" xref="alg2.9.9.m1.1.1.3.2.2">2</cn><ci id="alg2.9.9.m1.1.1.3.2.3.cmml" xref="alg2.9.9.m1.1.1.3.2.3">𝑝</ci></apply><ci id="alg2.9.9.m1.1.1.3.3.cmml" xref="alg2.9.9.m1.1.1.3.3">𝑖</ci><ci id="alg2.9.9.m1.1.1.3.4.cmml" xref="alg2.9.9.m1.1.1.3.4">𝑣</ci><ci id="alg2.9.9.m1.1.1.3.5.cmml" xref="alg2.9.9.m1.1.1.3.5">𝑜</ci><ci id="alg2.9.9.m1.1.1.3.6.cmml" xref="alg2.9.9.m1.1.1.3.6">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.9.9.m1.1c">lchild\coloneqq 2\cdot pivot</annotation></semantics></math>
</div>
<div id="alg2.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.10.10.m1.1" class="ltx_Math" alttext="rchild\coloneqq lchild+1" display="inline"><semantics id="alg2.10.10.m1.1a"><mrow id="alg2.10.10.m1.1.1" xref="alg2.10.10.m1.1.1.cmml"><mrow id="alg2.10.10.m1.1.1.2" xref="alg2.10.10.m1.1.1.2.cmml"><mi id="alg2.10.10.m1.1.1.2.2" xref="alg2.10.10.m1.1.1.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.2.1" xref="alg2.10.10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.2.3" xref="alg2.10.10.m1.1.1.2.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.2.1a" xref="alg2.10.10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.2.4" xref="alg2.10.10.m1.1.1.2.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.2.1b" xref="alg2.10.10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.2.5" xref="alg2.10.10.m1.1.1.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.2.1c" xref="alg2.10.10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.2.6" xref="alg2.10.10.m1.1.1.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.2.1d" xref="alg2.10.10.m1.1.1.2.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.2.7" xref="alg2.10.10.m1.1.1.2.7.cmml">d</mi></mrow><mo id="alg2.10.10.m1.1.1.1" xref="alg2.10.10.m1.1.1.1.cmml">≔</mo><mrow id="alg2.10.10.m1.1.1.3" xref="alg2.10.10.m1.1.1.3.cmml"><mrow id="alg2.10.10.m1.1.1.3.2" xref="alg2.10.10.m1.1.1.3.2.cmml"><mi id="alg2.10.10.m1.1.1.3.2.2" xref="alg2.10.10.m1.1.1.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.3.2.1" xref="alg2.10.10.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.3.2.3" xref="alg2.10.10.m1.1.1.3.2.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.3.2.1a" xref="alg2.10.10.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.3.2.4" xref="alg2.10.10.m1.1.1.3.2.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.3.2.1b" xref="alg2.10.10.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.3.2.5" xref="alg2.10.10.m1.1.1.3.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.3.2.1c" xref="alg2.10.10.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.3.2.6" xref="alg2.10.10.m1.1.1.3.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.10.10.m1.1.1.3.2.1d" xref="alg2.10.10.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.10.10.m1.1.1.3.2.7" xref="alg2.10.10.m1.1.1.3.2.7.cmml">d</mi></mrow><mo id="alg2.10.10.m1.1.1.3.1" xref="alg2.10.10.m1.1.1.3.1.cmml">+</mo><mn id="alg2.10.10.m1.1.1.3.3" xref="alg2.10.10.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.10.10.m1.1b"><apply id="alg2.10.10.m1.1.1.cmml" xref="alg2.10.10.m1.1.1"><ci id="alg2.10.10.m1.1.1.1.cmml" xref="alg2.10.10.m1.1.1.1">≔</ci><apply id="alg2.10.10.m1.1.1.2.cmml" xref="alg2.10.10.m1.1.1.2"><times id="alg2.10.10.m1.1.1.2.1.cmml" xref="alg2.10.10.m1.1.1.2.1"></times><ci id="alg2.10.10.m1.1.1.2.2.cmml" xref="alg2.10.10.m1.1.1.2.2">𝑟</ci><ci id="alg2.10.10.m1.1.1.2.3.cmml" xref="alg2.10.10.m1.1.1.2.3">𝑐</ci><ci id="alg2.10.10.m1.1.1.2.4.cmml" xref="alg2.10.10.m1.1.1.2.4">ℎ</ci><ci id="alg2.10.10.m1.1.1.2.5.cmml" xref="alg2.10.10.m1.1.1.2.5">𝑖</ci><ci id="alg2.10.10.m1.1.1.2.6.cmml" xref="alg2.10.10.m1.1.1.2.6">𝑙</ci><ci id="alg2.10.10.m1.1.1.2.7.cmml" xref="alg2.10.10.m1.1.1.2.7">𝑑</ci></apply><apply id="alg2.10.10.m1.1.1.3.cmml" xref="alg2.10.10.m1.1.1.3"><plus id="alg2.10.10.m1.1.1.3.1.cmml" xref="alg2.10.10.m1.1.1.3.1"></plus><apply id="alg2.10.10.m1.1.1.3.2.cmml" xref="alg2.10.10.m1.1.1.3.2"><times id="alg2.10.10.m1.1.1.3.2.1.cmml" xref="alg2.10.10.m1.1.1.3.2.1"></times><ci id="alg2.10.10.m1.1.1.3.2.2.cmml" xref="alg2.10.10.m1.1.1.3.2.2">𝑙</ci><ci id="alg2.10.10.m1.1.1.3.2.3.cmml" xref="alg2.10.10.m1.1.1.3.2.3">𝑐</ci><ci id="alg2.10.10.m1.1.1.3.2.4.cmml" xref="alg2.10.10.m1.1.1.3.2.4">ℎ</ci><ci id="alg2.10.10.m1.1.1.3.2.5.cmml" xref="alg2.10.10.m1.1.1.3.2.5">𝑖</ci><ci id="alg2.10.10.m1.1.1.3.2.6.cmml" xref="alg2.10.10.m1.1.1.3.2.6">𝑙</ci><ci id="alg2.10.10.m1.1.1.3.2.7.cmml" xref="alg2.10.10.m1.1.1.3.2.7">𝑑</ci></apply><cn type="integer" id="alg2.10.10.m1.1.1.3.3.cmml" xref="alg2.10.10.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.10.10.m1.1c">rchild\coloneqq lchild+1</annotation></semantics></math>
</div>
<div id="alg2.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Sends pair <math id="alg2.11.11.m1.2" class="ltx_Math" alttext="(t_{lchild},t_{rchild})" display="inline"><semantics id="alg2.11.11.m1.2a"><mrow id="alg2.11.11.m1.2.2.2" xref="alg2.11.11.m1.2.2.3.cmml"><mo stretchy="false" id="alg2.11.11.m1.2.2.2.3" xref="alg2.11.11.m1.2.2.3.cmml">(</mo><msub id="alg2.11.11.m1.1.1.1.1" xref="alg2.11.11.m1.1.1.1.1.cmml"><mi id="alg2.11.11.m1.1.1.1.1.2" xref="alg2.11.11.m1.1.1.1.1.2.cmml">t</mi><mrow id="alg2.11.11.m1.1.1.1.1.3" xref="alg2.11.11.m1.1.1.1.1.3.cmml"><mi id="alg2.11.11.m1.1.1.1.1.3.2" xref="alg2.11.11.m1.1.1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.1.1.1.1.3.1" xref="alg2.11.11.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.11.11.m1.1.1.1.1.3.3" xref="alg2.11.11.m1.1.1.1.1.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.1.1.1.1.3.1a" xref="alg2.11.11.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.11.11.m1.1.1.1.1.3.4" xref="alg2.11.11.m1.1.1.1.1.3.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.1.1.1.1.3.1b" xref="alg2.11.11.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.11.11.m1.1.1.1.1.3.5" xref="alg2.11.11.m1.1.1.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.1.1.1.1.3.1c" xref="alg2.11.11.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.11.11.m1.1.1.1.1.3.6" xref="alg2.11.11.m1.1.1.1.1.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.1.1.1.1.3.1d" xref="alg2.11.11.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.11.11.m1.1.1.1.1.3.7" xref="alg2.11.11.m1.1.1.1.1.3.7.cmml">d</mi></mrow></msub><mo id="alg2.11.11.m1.2.2.2.4" xref="alg2.11.11.m1.2.2.3.cmml">,</mo><msub id="alg2.11.11.m1.2.2.2.2" xref="alg2.11.11.m1.2.2.2.2.cmml"><mi id="alg2.11.11.m1.2.2.2.2.2" xref="alg2.11.11.m1.2.2.2.2.2.cmml">t</mi><mrow id="alg2.11.11.m1.2.2.2.2.3" xref="alg2.11.11.m1.2.2.2.2.3.cmml"><mi id="alg2.11.11.m1.2.2.2.2.3.2" xref="alg2.11.11.m1.2.2.2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.2.2.2.2.3.1" xref="alg2.11.11.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.11.11.m1.2.2.2.2.3.3" xref="alg2.11.11.m1.2.2.2.2.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.2.2.2.2.3.1a" xref="alg2.11.11.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.11.11.m1.2.2.2.2.3.4" xref="alg2.11.11.m1.2.2.2.2.3.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.2.2.2.2.3.1b" xref="alg2.11.11.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.11.11.m1.2.2.2.2.3.5" xref="alg2.11.11.m1.2.2.2.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.2.2.2.2.3.1c" xref="alg2.11.11.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.11.11.m1.2.2.2.2.3.6" xref="alg2.11.11.m1.2.2.2.2.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.11.11.m1.2.2.2.2.3.1d" xref="alg2.11.11.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.11.11.m1.2.2.2.2.3.7" xref="alg2.11.11.m1.2.2.2.2.3.7.cmml">d</mi></mrow></msub><mo stretchy="false" id="alg2.11.11.m1.2.2.2.5" xref="alg2.11.11.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.11.11.m1.2b"><interval closure="open" id="alg2.11.11.m1.2.2.3.cmml" xref="alg2.11.11.m1.2.2.2"><apply id="alg2.11.11.m1.1.1.1.1.cmml" xref="alg2.11.11.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.11.11.m1.1.1.1.1.1.cmml" xref="alg2.11.11.m1.1.1.1.1">subscript</csymbol><ci id="alg2.11.11.m1.1.1.1.1.2.cmml" xref="alg2.11.11.m1.1.1.1.1.2">𝑡</ci><apply id="alg2.11.11.m1.1.1.1.1.3.cmml" xref="alg2.11.11.m1.1.1.1.1.3"><times id="alg2.11.11.m1.1.1.1.1.3.1.cmml" xref="alg2.11.11.m1.1.1.1.1.3.1"></times><ci id="alg2.11.11.m1.1.1.1.1.3.2.cmml" xref="alg2.11.11.m1.1.1.1.1.3.2">𝑙</ci><ci id="alg2.11.11.m1.1.1.1.1.3.3.cmml" xref="alg2.11.11.m1.1.1.1.1.3.3">𝑐</ci><ci id="alg2.11.11.m1.1.1.1.1.3.4.cmml" xref="alg2.11.11.m1.1.1.1.1.3.4">ℎ</ci><ci id="alg2.11.11.m1.1.1.1.1.3.5.cmml" xref="alg2.11.11.m1.1.1.1.1.3.5">𝑖</ci><ci id="alg2.11.11.m1.1.1.1.1.3.6.cmml" xref="alg2.11.11.m1.1.1.1.1.3.6">𝑙</ci><ci id="alg2.11.11.m1.1.1.1.1.3.7.cmml" xref="alg2.11.11.m1.1.1.1.1.3.7">𝑑</ci></apply></apply><apply id="alg2.11.11.m1.2.2.2.2.cmml" xref="alg2.11.11.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.11.11.m1.2.2.2.2.1.cmml" xref="alg2.11.11.m1.2.2.2.2">subscript</csymbol><ci id="alg2.11.11.m1.2.2.2.2.2.cmml" xref="alg2.11.11.m1.2.2.2.2.2">𝑡</ci><apply id="alg2.11.11.m1.2.2.2.2.3.cmml" xref="alg2.11.11.m1.2.2.2.2.3"><times id="alg2.11.11.m1.2.2.2.2.3.1.cmml" xref="alg2.11.11.m1.2.2.2.2.3.1"></times><ci id="alg2.11.11.m1.2.2.2.2.3.2.cmml" xref="alg2.11.11.m1.2.2.2.2.3.2">𝑟</ci><ci id="alg2.11.11.m1.2.2.2.2.3.3.cmml" xref="alg2.11.11.m1.2.2.2.2.3.3">𝑐</ci><ci id="alg2.11.11.m1.2.2.2.2.3.4.cmml" xref="alg2.11.11.m1.2.2.2.2.3.4">ℎ</ci><ci id="alg2.11.11.m1.2.2.2.2.3.5.cmml" xref="alg2.11.11.m1.2.2.2.2.3.5">𝑖</ci><ci id="alg2.11.11.m1.2.2.2.2.3.6.cmml" xref="alg2.11.11.m1.2.2.2.2.3.6">𝑙</ci><ci id="alg2.11.11.m1.2.2.2.2.3.7.cmml" xref="alg2.11.11.m1.2.2.2.2.3.7">𝑑</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.11.11.m1.2c">(t_{lchild},t_{rchild})</annotation></semantics></math> to the client
</div>
<div id="alg2.18.40" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.18.41" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg2.18.42" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
// On the client:
</div>
<div id="alg2.18.43" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Receives pair <math id="alg2.12.12.m1.2" class="ltx_Math" alttext="(c_{0},c_{1})" display="inline"><semantics id="alg2.12.12.m1.2a"><mrow id="alg2.12.12.m1.2.2.2" xref="alg2.12.12.m1.2.2.3.cmml"><mo stretchy="false" id="alg2.12.12.m1.2.2.2.3" xref="alg2.12.12.m1.2.2.3.cmml">(</mo><msub id="alg2.12.12.m1.1.1.1.1" xref="alg2.12.12.m1.1.1.1.1.cmml"><mi id="alg2.12.12.m1.1.1.1.1.2" xref="alg2.12.12.m1.1.1.1.1.2.cmml">c</mi><mn id="alg2.12.12.m1.1.1.1.1.3" xref="alg2.12.12.m1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg2.12.12.m1.2.2.2.4" xref="alg2.12.12.m1.2.2.3.cmml">,</mo><msub id="alg2.12.12.m1.2.2.2.2" xref="alg2.12.12.m1.2.2.2.2.cmml"><mi id="alg2.12.12.m1.2.2.2.2.2" xref="alg2.12.12.m1.2.2.2.2.2.cmml">c</mi><mn id="alg2.12.12.m1.2.2.2.2.3" xref="alg2.12.12.m1.2.2.2.2.3.cmml">1</mn></msub><mo stretchy="false" id="alg2.12.12.m1.2.2.2.5" xref="alg2.12.12.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.12.12.m1.2b"><interval closure="open" id="alg2.12.12.m1.2.2.3.cmml" xref="alg2.12.12.m1.2.2.2"><apply id="alg2.12.12.m1.1.1.1.1.cmml" xref="alg2.12.12.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.12.12.m1.1.1.1.1.1.cmml" xref="alg2.12.12.m1.1.1.1.1">subscript</csymbol><ci id="alg2.12.12.m1.1.1.1.1.2.cmml" xref="alg2.12.12.m1.1.1.1.1.2">𝑐</ci><cn type="integer" id="alg2.12.12.m1.1.1.1.1.3.cmml" xref="alg2.12.12.m1.1.1.1.1.3">0</cn></apply><apply id="alg2.12.12.m1.2.2.2.2.cmml" xref="alg2.12.12.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.12.12.m1.2.2.2.2.1.cmml" xref="alg2.12.12.m1.2.2.2.2">subscript</csymbol><ci id="alg2.12.12.m1.2.2.2.2.2.cmml" xref="alg2.12.12.m1.2.2.2.2.2">𝑐</ci><cn type="integer" id="alg2.12.12.m1.2.2.2.2.3.cmml" xref="alg2.12.12.m1.2.2.2.2.3">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.12.m1.2c">(c_{0},c_{1})</annotation></semantics></math> from the server
</div>
<div id="alg2.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">27</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg2.13.13.2" class="ltx_text ltx_font_bold">if</span> <em id="alg2.13.13.1" class="ltx_emph ltx_font_italic"><math id="alg2.13.13.1.m1.1" class="ltx_Math" alttext="0=Dec(c_{0})" display="inline"><semantics id="alg2.13.13.1.m1.1a"><mrow id="alg2.13.13.1.m1.1.1" xref="alg2.13.13.1.m1.1.1.cmml"><mn id="alg2.13.13.1.m1.1.1.3" xref="alg2.13.13.1.m1.1.1.3.cmml">0</mn><mo id="alg2.13.13.1.m1.1.1.2" xref="alg2.13.13.1.m1.1.1.2.cmml">=</mo><mrow id="alg2.13.13.1.m1.1.1.1" xref="alg2.13.13.1.m1.1.1.1.cmml"><mi id="alg2.13.13.1.m1.1.1.1.3" xref="alg2.13.13.1.m1.1.1.1.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.1.m1.1.1.1.2" xref="alg2.13.13.1.m1.1.1.1.2.cmml">​</mo><mi id="alg2.13.13.1.m1.1.1.1.4" xref="alg2.13.13.1.m1.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.1.m1.1.1.1.2a" xref="alg2.13.13.1.m1.1.1.1.2.cmml">​</mo><mi id="alg2.13.13.1.m1.1.1.1.5" xref="alg2.13.13.1.m1.1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.13.13.1.m1.1.1.1.2b" xref="alg2.13.13.1.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.13.13.1.m1.1.1.1.1.1" xref="alg2.13.13.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.13.13.1.m1.1.1.1.1.1.2" xref="alg2.13.13.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.13.13.1.m1.1.1.1.1.1.1" xref="alg2.13.13.1.m1.1.1.1.1.1.1.cmml"><mi id="alg2.13.13.1.m1.1.1.1.1.1.1.2" xref="alg2.13.13.1.m1.1.1.1.1.1.1.2.cmml">c</mi><mn id="alg2.13.13.1.m1.1.1.1.1.1.1.3" xref="alg2.13.13.1.m1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="alg2.13.13.1.m1.1.1.1.1.1.3" xref="alg2.13.13.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.13.13.1.m1.1b"><apply id="alg2.13.13.1.m1.1.1.cmml" xref="alg2.13.13.1.m1.1.1"><eq id="alg2.13.13.1.m1.1.1.2.cmml" xref="alg2.13.13.1.m1.1.1.2"></eq><cn type="integer" id="alg2.13.13.1.m1.1.1.3.cmml" xref="alg2.13.13.1.m1.1.1.3">0</cn><apply id="alg2.13.13.1.m1.1.1.1.cmml" xref="alg2.13.13.1.m1.1.1.1"><times id="alg2.13.13.1.m1.1.1.1.2.cmml" xref="alg2.13.13.1.m1.1.1.1.2"></times><ci id="alg2.13.13.1.m1.1.1.1.3.cmml" xref="alg2.13.13.1.m1.1.1.1.3">𝐷</ci><ci id="alg2.13.13.1.m1.1.1.1.4.cmml" xref="alg2.13.13.1.m1.1.1.1.4">𝑒</ci><ci id="alg2.13.13.1.m1.1.1.1.5.cmml" xref="alg2.13.13.1.m1.1.1.1.5">𝑐</ci><apply id="alg2.13.13.1.m1.1.1.1.1.1.1.cmml" xref="alg2.13.13.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.13.13.1.m1.1.1.1.1.1.1.1.cmml" xref="alg2.13.13.1.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.13.13.1.m1.1.1.1.1.1.1.2.cmml" xref="alg2.13.13.1.m1.1.1.1.1.1.1.2">𝑐</ci><cn type="integer" id="alg2.13.13.1.m1.1.1.1.1.1.1.3.cmml" xref="alg2.13.13.1.m1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.13.1.m1.1c">0=Dec(c_{0})</annotation></semantics></math></em> <span id="alg2.13.13.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="alg2.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">28</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.14.14.m1.1" class="ltx_Math" alttext="pivot\coloneqq 2\cdot pivot" display="inline"><semantics id="alg2.14.14.m1.1a"><mrow id="alg2.14.14.m1.1.1" xref="alg2.14.14.m1.1.1.cmml"><mrow id="alg2.14.14.m1.1.1.2" xref="alg2.14.14.m1.1.1.2.cmml"><mi id="alg2.14.14.m1.1.1.2.2" xref="alg2.14.14.m1.1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.14.14.m1.1.1.2.1" xref="alg2.14.14.m1.1.1.2.1.cmml">​</mo><mi id="alg2.14.14.m1.1.1.2.3" xref="alg2.14.14.m1.1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.14.14.m1.1.1.2.1a" xref="alg2.14.14.m1.1.1.2.1.cmml">​</mo><mi id="alg2.14.14.m1.1.1.2.4" xref="alg2.14.14.m1.1.1.2.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.14.14.m1.1.1.2.1b" xref="alg2.14.14.m1.1.1.2.1.cmml">​</mo><mi id="alg2.14.14.m1.1.1.2.5" xref="alg2.14.14.m1.1.1.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.14.14.m1.1.1.2.1c" xref="alg2.14.14.m1.1.1.2.1.cmml">​</mo><mi id="alg2.14.14.m1.1.1.2.6" xref="alg2.14.14.m1.1.1.2.6.cmml">t</mi></mrow><mo id="alg2.14.14.m1.1.1.1" xref="alg2.14.14.m1.1.1.1.cmml">≔</mo><mrow id="alg2.14.14.m1.1.1.3" xref="alg2.14.14.m1.1.1.3.cmml"><mrow id="alg2.14.14.m1.1.1.3.2" xref="alg2.14.14.m1.1.1.3.2.cmml"><mn id="alg2.14.14.m1.1.1.3.2.2" xref="alg2.14.14.m1.1.1.3.2.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="alg2.14.14.m1.1.1.3.2.1" xref="alg2.14.14.m1.1.1.3.2.1.cmml">⋅</mo><mi id="alg2.14.14.m1.1.1.3.2.3" xref="alg2.14.14.m1.1.1.3.2.3.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.14.14.m1.1.1.3.1" xref="alg2.14.14.m1.1.1.3.1.cmml">​</mo><mi id="alg2.14.14.m1.1.1.3.3" xref="alg2.14.14.m1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.14.14.m1.1.1.3.1a" xref="alg2.14.14.m1.1.1.3.1.cmml">​</mo><mi id="alg2.14.14.m1.1.1.3.4" xref="alg2.14.14.m1.1.1.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.14.14.m1.1.1.3.1b" xref="alg2.14.14.m1.1.1.3.1.cmml">​</mo><mi id="alg2.14.14.m1.1.1.3.5" xref="alg2.14.14.m1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.14.14.m1.1.1.3.1c" xref="alg2.14.14.m1.1.1.3.1.cmml">​</mo><mi id="alg2.14.14.m1.1.1.3.6" xref="alg2.14.14.m1.1.1.3.6.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.14.14.m1.1b"><apply id="alg2.14.14.m1.1.1.cmml" xref="alg2.14.14.m1.1.1"><ci id="alg2.14.14.m1.1.1.1.cmml" xref="alg2.14.14.m1.1.1.1">≔</ci><apply id="alg2.14.14.m1.1.1.2.cmml" xref="alg2.14.14.m1.1.1.2"><times id="alg2.14.14.m1.1.1.2.1.cmml" xref="alg2.14.14.m1.1.1.2.1"></times><ci id="alg2.14.14.m1.1.1.2.2.cmml" xref="alg2.14.14.m1.1.1.2.2">𝑝</ci><ci id="alg2.14.14.m1.1.1.2.3.cmml" xref="alg2.14.14.m1.1.1.2.3">𝑖</ci><ci id="alg2.14.14.m1.1.1.2.4.cmml" xref="alg2.14.14.m1.1.1.2.4">𝑣</ci><ci id="alg2.14.14.m1.1.1.2.5.cmml" xref="alg2.14.14.m1.1.1.2.5">𝑜</ci><ci id="alg2.14.14.m1.1.1.2.6.cmml" xref="alg2.14.14.m1.1.1.2.6">𝑡</ci></apply><apply id="alg2.14.14.m1.1.1.3.cmml" xref="alg2.14.14.m1.1.1.3"><times id="alg2.14.14.m1.1.1.3.1.cmml" xref="alg2.14.14.m1.1.1.3.1"></times><apply id="alg2.14.14.m1.1.1.3.2.cmml" xref="alg2.14.14.m1.1.1.3.2"><ci id="alg2.14.14.m1.1.1.3.2.1.cmml" xref="alg2.14.14.m1.1.1.3.2.1">⋅</ci><cn type="integer" id="alg2.14.14.m1.1.1.3.2.2.cmml" xref="alg2.14.14.m1.1.1.3.2.2">2</cn><ci id="alg2.14.14.m1.1.1.3.2.3.cmml" xref="alg2.14.14.m1.1.1.3.2.3">𝑝</ci></apply><ci id="alg2.14.14.m1.1.1.3.3.cmml" xref="alg2.14.14.m1.1.1.3.3">𝑖</ci><ci id="alg2.14.14.m1.1.1.3.4.cmml" xref="alg2.14.14.m1.1.1.3.4">𝑣</ci><ci id="alg2.14.14.m1.1.1.3.5.cmml" xref="alg2.14.14.m1.1.1.3.5">𝑜</ci><ci id="alg2.14.14.m1.1.1.3.6.cmml" xref="alg2.14.14.m1.1.1.3.6">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.14.m1.1c">pivot\coloneqq 2\cdot pivot</annotation></semantics></math>
</div>
<div id="alg2.18.44" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">29</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.18.45" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">30</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg2.18.45.1" class="ltx_text ltx_font_bold">else</span> 
</div>
<div id="alg2.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">31</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="alg2.15.15.m1.1" class="ltx_Math" alttext="pivot\coloneqq 2\cdot pivot+1" display="inline"><semantics id="alg2.15.15.m1.1a"><mrow id="alg2.15.15.m1.1.1" xref="alg2.15.15.m1.1.1.cmml"><mrow id="alg2.15.15.m1.1.1.2" xref="alg2.15.15.m1.1.1.2.cmml"><mi id="alg2.15.15.m1.1.1.2.2" xref="alg2.15.15.m1.1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.15.15.m1.1.1.2.1" xref="alg2.15.15.m1.1.1.2.1.cmml">​</mo><mi id="alg2.15.15.m1.1.1.2.3" xref="alg2.15.15.m1.1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.15.15.m1.1.1.2.1a" xref="alg2.15.15.m1.1.1.2.1.cmml">​</mo><mi id="alg2.15.15.m1.1.1.2.4" xref="alg2.15.15.m1.1.1.2.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.15.15.m1.1.1.2.1b" xref="alg2.15.15.m1.1.1.2.1.cmml">​</mo><mi id="alg2.15.15.m1.1.1.2.5" xref="alg2.15.15.m1.1.1.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.15.15.m1.1.1.2.1c" xref="alg2.15.15.m1.1.1.2.1.cmml">​</mo><mi id="alg2.15.15.m1.1.1.2.6" xref="alg2.15.15.m1.1.1.2.6.cmml">t</mi></mrow><mo id="alg2.15.15.m1.1.1.1" xref="alg2.15.15.m1.1.1.1.cmml">≔</mo><mrow id="alg2.15.15.m1.1.1.3" xref="alg2.15.15.m1.1.1.3.cmml"><mrow id="alg2.15.15.m1.1.1.3.2" xref="alg2.15.15.m1.1.1.3.2.cmml"><mrow id="alg2.15.15.m1.1.1.3.2.2" xref="alg2.15.15.m1.1.1.3.2.2.cmml"><mn id="alg2.15.15.m1.1.1.3.2.2.2" xref="alg2.15.15.m1.1.1.3.2.2.2.cmml">2</mn><mo lspace="0.222em" rspace="0.222em" id="alg2.15.15.m1.1.1.3.2.2.1" xref="alg2.15.15.m1.1.1.3.2.2.1.cmml">⋅</mo><mi id="alg2.15.15.m1.1.1.3.2.2.3" xref="alg2.15.15.m1.1.1.3.2.2.3.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.15.15.m1.1.1.3.2.1" xref="alg2.15.15.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.15.15.m1.1.1.3.2.3" xref="alg2.15.15.m1.1.1.3.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.15.15.m1.1.1.3.2.1a" xref="alg2.15.15.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.15.15.m1.1.1.3.2.4" xref="alg2.15.15.m1.1.1.3.2.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.15.15.m1.1.1.3.2.1b" xref="alg2.15.15.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.15.15.m1.1.1.3.2.5" xref="alg2.15.15.m1.1.1.3.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.15.15.m1.1.1.3.2.1c" xref="alg2.15.15.m1.1.1.3.2.1.cmml">​</mo><mi id="alg2.15.15.m1.1.1.3.2.6" xref="alg2.15.15.m1.1.1.3.2.6.cmml">t</mi></mrow><mo id="alg2.15.15.m1.1.1.3.1" xref="alg2.15.15.m1.1.1.3.1.cmml">+</mo><mn id="alg2.15.15.m1.1.1.3.3" xref="alg2.15.15.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.15.15.m1.1b"><apply id="alg2.15.15.m1.1.1.cmml" xref="alg2.15.15.m1.1.1"><ci id="alg2.15.15.m1.1.1.1.cmml" xref="alg2.15.15.m1.1.1.1">≔</ci><apply id="alg2.15.15.m1.1.1.2.cmml" xref="alg2.15.15.m1.1.1.2"><times id="alg2.15.15.m1.1.1.2.1.cmml" xref="alg2.15.15.m1.1.1.2.1"></times><ci id="alg2.15.15.m1.1.1.2.2.cmml" xref="alg2.15.15.m1.1.1.2.2">𝑝</ci><ci id="alg2.15.15.m1.1.1.2.3.cmml" xref="alg2.15.15.m1.1.1.2.3">𝑖</ci><ci id="alg2.15.15.m1.1.1.2.4.cmml" xref="alg2.15.15.m1.1.1.2.4">𝑣</ci><ci id="alg2.15.15.m1.1.1.2.5.cmml" xref="alg2.15.15.m1.1.1.2.5">𝑜</ci><ci id="alg2.15.15.m1.1.1.2.6.cmml" xref="alg2.15.15.m1.1.1.2.6">𝑡</ci></apply><apply id="alg2.15.15.m1.1.1.3.cmml" xref="alg2.15.15.m1.1.1.3"><plus id="alg2.15.15.m1.1.1.3.1.cmml" xref="alg2.15.15.m1.1.1.3.1"></plus><apply id="alg2.15.15.m1.1.1.3.2.cmml" xref="alg2.15.15.m1.1.1.3.2"><times id="alg2.15.15.m1.1.1.3.2.1.cmml" xref="alg2.15.15.m1.1.1.3.2.1"></times><apply id="alg2.15.15.m1.1.1.3.2.2.cmml" xref="alg2.15.15.m1.1.1.3.2.2"><ci id="alg2.15.15.m1.1.1.3.2.2.1.cmml" xref="alg2.15.15.m1.1.1.3.2.2.1">⋅</ci><cn type="integer" id="alg2.15.15.m1.1.1.3.2.2.2.cmml" xref="alg2.15.15.m1.1.1.3.2.2.2">2</cn><ci id="alg2.15.15.m1.1.1.3.2.2.3.cmml" xref="alg2.15.15.m1.1.1.3.2.2.3">𝑝</ci></apply><ci id="alg2.15.15.m1.1.1.3.2.3.cmml" xref="alg2.15.15.m1.1.1.3.2.3">𝑖</ci><ci id="alg2.15.15.m1.1.1.3.2.4.cmml" xref="alg2.15.15.m1.1.1.3.2.4">𝑣</ci><ci id="alg2.15.15.m1.1.1.3.2.5.cmml" xref="alg2.15.15.m1.1.1.3.2.5">𝑜</ci><ci id="alg2.15.15.m1.1.1.3.2.6.cmml" xref="alg2.15.15.m1.1.1.3.2.6">𝑡</ci></apply><cn type="integer" id="alg2.15.15.m1.1.1.3.3.cmml" xref="alg2.15.15.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.15.m1.1c">pivot\coloneqq 2\cdot pivot+1</annotation></semantics></math>
</div>
<div id="alg2.18.46" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">32</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.18.47" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">33</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end if
</div>
<div id="alg2.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">34</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="alg2.16.16.2" class="ltx_text ltx_font_bold">if</span> <em id="alg2.16.16.1" class="ltx_emph ltx_font_italic"><math id="alg2.16.16.1.m1.1" class="ltx_Math" alttext="pivot\geq 2^{\log n}" display="inline"><semantics id="alg2.16.16.1.m1.1a"><mrow id="alg2.16.16.1.m1.1.1" xref="alg2.16.16.1.m1.1.1.cmml"><mrow id="alg2.16.16.1.m1.1.1.2" xref="alg2.16.16.1.m1.1.1.2.cmml"><mi id="alg2.16.16.1.m1.1.1.2.2" xref="alg2.16.16.1.m1.1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.16.16.1.m1.1.1.2.1" xref="alg2.16.16.1.m1.1.1.2.1.cmml">​</mo><mi id="alg2.16.16.1.m1.1.1.2.3" xref="alg2.16.16.1.m1.1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.16.16.1.m1.1.1.2.1a" xref="alg2.16.16.1.m1.1.1.2.1.cmml">​</mo><mi id="alg2.16.16.1.m1.1.1.2.4" xref="alg2.16.16.1.m1.1.1.2.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.16.16.1.m1.1.1.2.1b" xref="alg2.16.16.1.m1.1.1.2.1.cmml">​</mo><mi id="alg2.16.16.1.m1.1.1.2.5" xref="alg2.16.16.1.m1.1.1.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.16.16.1.m1.1.1.2.1c" xref="alg2.16.16.1.m1.1.1.2.1.cmml">​</mo><mi id="alg2.16.16.1.m1.1.1.2.6" xref="alg2.16.16.1.m1.1.1.2.6.cmml">t</mi></mrow><mo id="alg2.16.16.1.m1.1.1.1" xref="alg2.16.16.1.m1.1.1.1.cmml">≥</mo><msup id="alg2.16.16.1.m1.1.1.3" xref="alg2.16.16.1.m1.1.1.3.cmml"><mn id="alg2.16.16.1.m1.1.1.3.2" xref="alg2.16.16.1.m1.1.1.3.2.cmml">2</mn><mrow id="alg2.16.16.1.m1.1.1.3.3" xref="alg2.16.16.1.m1.1.1.3.3.cmml"><mi id="alg2.16.16.1.m1.1.1.3.3.1" xref="alg2.16.16.1.m1.1.1.3.3.1.cmml">log</mi><mo lspace="0.167em" id="alg2.16.16.1.m1.1.1.3.3a" xref="alg2.16.16.1.m1.1.1.3.3.cmml">⁡</mo><mi id="alg2.16.16.1.m1.1.1.3.3.2" xref="alg2.16.16.1.m1.1.1.3.3.2.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.16.16.1.m1.1b"><apply id="alg2.16.16.1.m1.1.1.cmml" xref="alg2.16.16.1.m1.1.1"><geq id="alg2.16.16.1.m1.1.1.1.cmml" xref="alg2.16.16.1.m1.1.1.1"></geq><apply id="alg2.16.16.1.m1.1.1.2.cmml" xref="alg2.16.16.1.m1.1.1.2"><times id="alg2.16.16.1.m1.1.1.2.1.cmml" xref="alg2.16.16.1.m1.1.1.2.1"></times><ci id="alg2.16.16.1.m1.1.1.2.2.cmml" xref="alg2.16.16.1.m1.1.1.2.2">𝑝</ci><ci id="alg2.16.16.1.m1.1.1.2.3.cmml" xref="alg2.16.16.1.m1.1.1.2.3">𝑖</ci><ci id="alg2.16.16.1.m1.1.1.2.4.cmml" xref="alg2.16.16.1.m1.1.1.2.4">𝑣</ci><ci id="alg2.16.16.1.m1.1.1.2.5.cmml" xref="alg2.16.16.1.m1.1.1.2.5">𝑜</ci><ci id="alg2.16.16.1.m1.1.1.2.6.cmml" xref="alg2.16.16.1.m1.1.1.2.6">𝑡</ci></apply><apply id="alg2.16.16.1.m1.1.1.3.cmml" xref="alg2.16.16.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.16.16.1.m1.1.1.3.1.cmml" xref="alg2.16.16.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="alg2.16.16.1.m1.1.1.3.2.cmml" xref="alg2.16.16.1.m1.1.1.3.2">2</cn><apply id="alg2.16.16.1.m1.1.1.3.3.cmml" xref="alg2.16.16.1.m1.1.1.3.3"><log id="alg2.16.16.1.m1.1.1.3.3.1.cmml" xref="alg2.16.16.1.m1.1.1.3.3.1"></log><ci id="alg2.16.16.1.m1.1.1.3.3.2.cmml" xref="alg2.16.16.1.m1.1.1.3.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.16.1.m1.1c">pivot\geq 2^{\log n}</annotation></semantics></math></em> <span id="alg2.16.16.3" class="ltx_text ltx_font_bold">then</span>
</div>
<div id="alg2.17.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">35</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg2.17.17.1" class="ltx_text ltx_font_bold">return</span> <math id="alg2.17.17.m1.1" class="ltx_Math" alttext="pivot" display="inline"><semantics id="alg2.17.17.m1.1a"><mrow id="alg2.17.17.m1.1.1" xref="alg2.17.17.m1.1.1.cmml"><mi id="alg2.17.17.m1.1.1.2" xref="alg2.17.17.m1.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.1" xref="alg2.17.17.m1.1.1.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.3" xref="alg2.17.17.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.1a" xref="alg2.17.17.m1.1.1.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.4" xref="alg2.17.17.m1.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.1b" xref="alg2.17.17.m1.1.1.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.5" xref="alg2.17.17.m1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.17.17.m1.1.1.1c" xref="alg2.17.17.m1.1.1.1.cmml">​</mo><mi id="alg2.17.17.m1.1.1.6" xref="alg2.17.17.m1.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.17.17.m1.1b"><apply id="alg2.17.17.m1.1.1.cmml" xref="alg2.17.17.m1.1.1"><times id="alg2.17.17.m1.1.1.1.cmml" xref="alg2.17.17.m1.1.1.1"></times><ci id="alg2.17.17.m1.1.1.2.cmml" xref="alg2.17.17.m1.1.1.2">𝑝</ci><ci id="alg2.17.17.m1.1.1.3.cmml" xref="alg2.17.17.m1.1.1.3">𝑖</ci><ci id="alg2.17.17.m1.1.1.4.cmml" xref="alg2.17.17.m1.1.1.4">𝑣</ci><ci id="alg2.17.17.m1.1.1.5.cmml" xref="alg2.17.17.m1.1.1.5">𝑜</ci><ci id="alg2.17.17.m1.1.1.6.cmml" xref="alg2.17.17.m1.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.17.17.m1.1c">pivot</annotation></semantics></math>
</div>
<div id="alg2.18.48" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">36</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.18.49" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">37</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="alg2.18.49.1" class="ltx_text ltx_font_bold">else</span> 
</div>
<div id="alg2.18.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">38</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Sends <math id="alg2.18.18.m1.1" class="ltx_Math" alttext="pivot" display="inline"><semantics id="alg2.18.18.m1.1a"><mrow id="alg2.18.18.m1.1.1" xref="alg2.18.18.m1.1.1.cmml"><mi id="alg2.18.18.m1.1.1.2" xref="alg2.18.18.m1.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.18.18.m1.1.1.1" xref="alg2.18.18.m1.1.1.1.cmml">​</mo><mi id="alg2.18.18.m1.1.1.3" xref="alg2.18.18.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.18.18.m1.1.1.1a" xref="alg2.18.18.m1.1.1.1.cmml">​</mo><mi id="alg2.18.18.m1.1.1.4" xref="alg2.18.18.m1.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg2.18.18.m1.1.1.1b" xref="alg2.18.18.m1.1.1.1.cmml">​</mo><mi id="alg2.18.18.m1.1.1.5" xref="alg2.18.18.m1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.18.18.m1.1.1.1c" xref="alg2.18.18.m1.1.1.1.cmml">​</mo><mi id="alg2.18.18.m1.1.1.6" xref="alg2.18.18.m1.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.18.18.m1.1b"><apply id="alg2.18.18.m1.1.1.cmml" xref="alg2.18.18.m1.1.1"><times id="alg2.18.18.m1.1.1.1.cmml" xref="alg2.18.18.m1.1.1.1"></times><ci id="alg2.18.18.m1.1.1.2.cmml" xref="alg2.18.18.m1.1.1.2">𝑝</ci><ci id="alg2.18.18.m1.1.1.3.cmml" xref="alg2.18.18.m1.1.1.3">𝑖</ci><ci id="alg2.18.18.m1.1.1.4.cmml" xref="alg2.18.18.m1.1.1.4">𝑣</ci><ci id="alg2.18.18.m1.1.1.5.cmml" xref="alg2.18.18.m1.1.1.5">𝑜</ci><ci id="alg2.18.18.m1.1.1.6.cmml" xref="alg2.18.18.m1.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.18.18.m1.1c">pivot</annotation></semantics></math> to the server
</div>
<div id="alg2.18.50" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">39</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="alg2.18.51" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">40</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end if
</div>
<div id="alg2.18.52" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">41</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="alg2.18.53" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">42</span> end for
</div>
<div id="alg2.18.54" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">43</span>
</div>
<div id="alg2.18.55" class="ltx_listingline">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.20.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span>Interaction Protocol</figcaption>
</figure>
</section>
<section id="Sx3.SSx5.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Correctness</h4>

<div id="Sx3.SSx5.SSSx2.p1" class="ltx_para">
<p id="Sx3.SSx5.SSSx2.p1.1" class="ltx_p">The correctness of Alg. <a href="#alg2" title="In Description ‣ Interaction Protocol ‣ Search over CKKS Ciphertexts ‣ Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> stems from its careful orchestration of cryptographic operations, secure communication, and systematic traversal of the binary tree. The algorithm’s adherence to the principles of homomorphic encryption ensures the preservation of data privacy throughout its execution.</p>
</div>
<div id="Sx3.SSx5.SSSx2.p2" class="ltx_para">
<p id="Sx3.SSx5.SSSx2.p2.3" class="ltx_p">At the commencement of the protocol, the server initiates the process by generating the intermediate binary tree <span id="Sx3.SSx5.SSSx2.p2.3.1" class="ltx_text ltx_markedasmath ltx_font_bold">t</span> through pairwise multiplication of the target ciphertext <math id="Sx3.SSx5.SSSx2.p2.2.m2.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="Sx3.SSx5.SSSx2.p2.2.m2.1a"><msub id="Sx3.SSx5.SSSx2.p2.2.m2.1.1" xref="Sx3.SSx5.SSSx2.p2.2.m2.1.1.cmml"><mi id="Sx3.SSx5.SSSx2.p2.2.m2.1.1.2" xref="Sx3.SSx5.SSSx2.p2.2.m2.1.1.2.cmml">c</mi><mi id="Sx3.SSx5.SSSx2.p2.2.m2.1.1.3" xref="Sx3.SSx5.SSSx2.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx2.p2.2.m2.1b"><apply id="Sx3.SSx5.SSSx2.p2.2.m2.1.1.cmml" xref="Sx3.SSx5.SSSx2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx2.p2.2.m2.1.1.1.cmml" xref="Sx3.SSx5.SSSx2.p2.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx2.p2.2.m2.1.1.2.cmml" xref="Sx3.SSx5.SSSx2.p2.2.m2.1.1.2">𝑐</ci><ci id="Sx3.SSx5.SSSx2.p2.2.m2.1.1.3.cmml" xref="Sx3.SSx5.SSSx2.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx2.p2.2.m2.1c">c_{t}</annotation></semantics></math>. This operation respects the properties of homomorphic encryption, ensuring that computations on encrypted data accurately correspond to operations on plaintext data. The subsequent transmission of the root node value <math id="Sx3.SSx5.SSSx2.p2.3.m3.1" class="ltx_Math" alttext="t_{1}" display="inline"><semantics id="Sx3.SSx5.SSSx2.p2.3.m3.1a"><msub id="Sx3.SSx5.SSSx2.p2.3.m3.1.1" xref="Sx3.SSx5.SSSx2.p2.3.m3.1.1.cmml"><mi id="Sx3.SSx5.SSSx2.p2.3.m3.1.1.2" xref="Sx3.SSx5.SSSx2.p2.3.m3.1.1.2.cmml">t</mi><mn id="Sx3.SSx5.SSSx2.p2.3.m3.1.1.3" xref="Sx3.SSx5.SSSx2.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx2.p2.3.m3.1b"><apply id="Sx3.SSx5.SSSx2.p2.3.m3.1.1.cmml" xref="Sx3.SSx5.SSSx2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx2.p2.3.m3.1.1.1.cmml" xref="Sx3.SSx5.SSSx2.p2.3.m3.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx2.p2.3.m3.1.1.2.cmml" xref="Sx3.SSx5.SSSx2.p2.3.m3.1.1.2">𝑡</ci><cn type="integer" id="Sx3.SSx5.SSSx2.p2.3.m3.1.1.3.cmml" xref="Sx3.SSx5.SSSx2.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx2.p2.3.m3.1c">t_{1}</annotation></semantics></math> to the client establishes the foundation for secure interaction.</p>
</div>
<div id="Sx3.SSx5.SSSx2.p3" class="ltx_para">
<p id="Sx3.SSx5.SSSx2.p3.1" class="ltx_p">As the client enters the interaction phase, it decrypts <math id="Sx3.SSx5.SSSx2.p3.1.m1.1" class="ltx_Math" alttext="t_{1}" display="inline"><semantics id="Sx3.SSx5.SSSx2.p3.1.m1.1a"><msub id="Sx3.SSx5.SSSx2.p3.1.m1.1.1" xref="Sx3.SSx5.SSSx2.p3.1.m1.1.1.cmml"><mi id="Sx3.SSx5.SSSx2.p3.1.m1.1.1.2" xref="Sx3.SSx5.SSSx2.p3.1.m1.1.1.2.cmml">t</mi><mn id="Sx3.SSx5.SSSx2.p3.1.m1.1.1.3" xref="Sx3.SSx5.SSSx2.p3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx2.p3.1.m1.1b"><apply id="Sx3.SSx5.SSSx2.p3.1.m1.1.1.cmml" xref="Sx3.SSx5.SSSx2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx2.p3.1.m1.1.1.1.cmml" xref="Sx3.SSx5.SSSx2.p3.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx2.p3.1.m1.1.1.2.cmml" xref="Sx3.SSx5.SSSx2.p3.1.m1.1.1.2">𝑡</ci><cn type="integer" id="Sx3.SSx5.SSSx2.p3.1.m1.1.1.3.cmml" xref="Sx3.SSx5.SSSx2.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx2.p3.1.m1.1c">t_{1}</annotation></semantics></math> to ascertain whether the decrypted value is non-zero. This step maintains the confidentiality of the underlying data, as the client cannot deduce information about the plaintext values from the encrypted data. Based on the decryption result, the client’s actions align with the protocol’s objectives, either indicating the absence of the target value or triggering further interaction.</p>
</div>
<div id="Sx3.SSx5.SSSx2.p4" class="ltx_para">
<p id="Sx3.SSx5.SSSx2.p4.1" class="ltx_p">The binary tree traversal, executed iteratively for each level of the tree, further underscores the algorithm’s correctness. The client and server exchange messages and values, ensuring that the interactions adhere to the security properties of homomorphic encryption. The encryption and decryption operations, when applied to the values exchanged, respect the principles of the encryption scheme, preserving the confidentiality of the data while enabling meaningful computation.</p>
</div>
<div id="Sx3.SSx5.SSSx2.p5" class="ltx_para">
<p id="Sx3.SSx5.SSSx2.p5.1" class="ltx_p">Furthermore, the client’s decision-making process during each iteration is based solely on the decrypted values and follows a deterministic logic that aligns with the encrypted data. The use of <math id="Sx3.SSx5.SSSx2.p5.1.m1.1" class="ltx_Math" alttext="pivot" display="inline"><semantics id="Sx3.SSx5.SSSx2.p5.1.m1.1a"><mrow id="Sx3.SSx5.SSSx2.p5.1.m1.1.1" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.cmml"><mi id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.2" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.1" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.3" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.1a" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.4" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.1b" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.5" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.1c" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.6" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx2.p5.1.m1.1b"><apply id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.cmml" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1"><times id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.1.cmml" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.1"></times><ci id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.2.cmml" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.2">𝑝</ci><ci id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.3.cmml" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.3">𝑖</ci><ci id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.4.cmml" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.4">𝑣</ci><ci id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.5.cmml" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.5">𝑜</ci><ci id="Sx3.SSx5.SSSx2.p5.1.m1.1.1.6.cmml" xref="Sx3.SSx5.SSSx2.p5.1.m1.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx2.p5.1.m1.1c">pivot</annotation></semantics></math> values to navigate the binary tree, alongside the systematic left and right child index calculations, guarantees consistent and accurate traversal.</p>
</div>
</section>
<section id="Sx3.SSx5.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Complexity</h4>

<div id="Sx3.SSx5.SSSx3.p1" class="ltx_para">
<p id="Sx3.SSx5.SSSx3.p1.2" class="ltx_p">In the initialization phase, the server initiates communication by sending a single message to the client. This message contains the value of the root node (<math id="Sx3.SSx5.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="t_{1}" display="inline"><semantics id="Sx3.SSx5.SSSx3.p1.1.m1.1a"><msub id="Sx3.SSx5.SSSx3.p1.1.m1.1.1" xref="Sx3.SSx5.SSSx3.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx5.SSSx3.p1.1.m1.1.1.2" xref="Sx3.SSx5.SSSx3.p1.1.m1.1.1.2.cmml">t</mi><mn id="Sx3.SSx5.SSSx3.p1.1.m1.1.1.3" xref="Sx3.SSx5.SSSx3.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx3.p1.1.m1.1b"><apply id="Sx3.SSx5.SSSx3.p1.1.m1.1.1.cmml" xref="Sx3.SSx5.SSSx3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx3.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx5.SSSx3.p1.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx3.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx5.SSSx3.p1.1.m1.1.1.2">𝑡</ci><cn type="integer" id="Sx3.SSx5.SSSx3.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx5.SSSx3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx3.p1.1.m1.1c">t_{1}</annotation></semantics></math>) of the intermediate binary tree <span id="Sx3.SSx5.SSSx3.p1.2.1" class="ltx_text ltx_markedasmath ltx_font_bold">t</span>. This initial exchange establishes the foundation for the subsequent interaction between the client and server.</p>
</div>
<div id="Sx3.SSx5.SSSx3.p2" class="ltx_para">
<p id="Sx3.SSx5.SSSx3.p2.3" class="ltx_p">The client interaction phase encompasses the iterative nature of the protocol. For each level of the binary tree (determined by the logarithm of the total number of ciphertexts), a set of messages are exchanged between the client and server. The client begins by sending a message to the server, conveying the current <math id="Sx3.SSx5.SSSx3.p2.1.m1.1" class="ltx_Math" alttext="pivot" display="inline"><semantics id="Sx3.SSx5.SSSx3.p2.1.m1.1a"><mrow id="Sx3.SSx5.SSSx3.p2.1.m1.1.1" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.cmml"><mi id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.2" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.1" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.3" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.1a" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.4" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.1b" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.5" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.1c" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.6" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx3.p2.1.m1.1b"><apply id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.cmml" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1"><times id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.1.cmml" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.1"></times><ci id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.2.cmml" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.2">𝑝</ci><ci id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.3.cmml" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.3">𝑖</ci><ci id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.4.cmml" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.4">𝑣</ci><ci id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.5.cmml" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.5">𝑜</ci><ci id="Sx3.SSx5.SSSx3.p2.1.m1.1.1.6.cmml" xref="Sx3.SSx5.SSSx3.p2.1.m1.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx3.p2.1.m1.1c">pivot</annotation></semantics></math> value. In response, the server sends a pair of messages back to the client. Each message in the pair contains the values of the left and right child nodes (<math id="Sx3.SSx5.SSSx3.p2.2.m2.1" class="ltx_Math" alttext="t_{lchild}" display="inline"><semantics id="Sx3.SSx5.SSSx3.p2.2.m2.1a"><msub id="Sx3.SSx5.SSSx3.p2.2.m2.1.1" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.cmml"><mi id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.2" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.2.cmml">t</mi><mrow id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.cmml"><mi id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.2" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.3" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1a" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.4" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1b" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.5" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1c" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.6" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1d" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.7" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.7.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx3.p2.2.m2.1b"><apply id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.cmml" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.1.cmml" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.2.cmml" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.2">𝑡</ci><apply id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.cmml" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3"><times id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1.cmml" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.1"></times><ci id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.2.cmml" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.2">𝑙</ci><ci id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.3.cmml" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.3">𝑐</ci><ci id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.4.cmml" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.4">ℎ</ci><ci id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.5.cmml" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.5">𝑖</ci><ci id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.6.cmml" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.6">𝑙</ci><ci id="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.7.cmml" xref="Sx3.SSx5.SSSx3.p2.2.m2.1.1.3.7">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx3.p2.2.m2.1c">t_{lchild}</annotation></semantics></math> and <math id="Sx3.SSx5.SSSx3.p2.3.m3.1" class="ltx_Math" alttext="t_{rchild}" display="inline"><semantics id="Sx3.SSx5.SSSx3.p2.3.m3.1a"><msub id="Sx3.SSx5.SSSx3.p2.3.m3.1.1" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.cmml"><mi id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.2" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.2.cmml">t</mi><mrow id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.cmml"><mi id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.2" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.3" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1a" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.4" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1b" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.5" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1c" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.6" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1d" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.7" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.7.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx3.p2.3.m3.1b"><apply id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.cmml" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.1.cmml" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1">subscript</csymbol><ci id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.2.cmml" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.2">𝑡</ci><apply id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.cmml" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3"><times id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1.cmml" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.1"></times><ci id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.2.cmml" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.2">𝑟</ci><ci id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.3.cmml" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.3">𝑐</ci><ci id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.4.cmml" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.4">ℎ</ci><ci id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.5.cmml" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.5">𝑖</ci><ci id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.6.cmml" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.6">𝑙</ci><ci id="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.7.cmml" xref="Sx3.SSx5.SSSx3.p2.3.m3.1.1.3.7">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx3.p2.3.m3.1c">t_{rchild}</annotation></semantics></math>).</p>
</div>
<div id="Sx3.SSx5.SSSx3.p3" class="ltx_para">
<p id="Sx3.SSx5.SSSx3.p3.4" class="ltx_p">Considering the iterative nature of the protocol, the number of iterations equals the depth of the binary tree, which is <math id="Sx3.SSx5.SSSx3.p3.1.m1.1" class="ltx_Math" alttext="\log n" display="inline"><semantics id="Sx3.SSx5.SSSx3.p3.1.m1.1a"><mrow id="Sx3.SSx5.SSSx3.p3.1.m1.1.1" xref="Sx3.SSx5.SSSx3.p3.1.m1.1.1.cmml"><mi id="Sx3.SSx5.SSSx3.p3.1.m1.1.1.1" xref="Sx3.SSx5.SSSx3.p3.1.m1.1.1.1.cmml">log</mi><mo lspace="0.167em" id="Sx3.SSx5.SSSx3.p3.1.m1.1.1a" xref="Sx3.SSx5.SSSx3.p3.1.m1.1.1.cmml">⁡</mo><mi id="Sx3.SSx5.SSSx3.p3.1.m1.1.1.2" xref="Sx3.SSx5.SSSx3.p3.1.m1.1.1.2.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx3.p3.1.m1.1b"><apply id="Sx3.SSx5.SSSx3.p3.1.m1.1.1.cmml" xref="Sx3.SSx5.SSSx3.p3.1.m1.1.1"><log id="Sx3.SSx5.SSSx3.p3.1.m1.1.1.1.cmml" xref="Sx3.SSx5.SSSx3.p3.1.m1.1.1.1"></log><ci id="Sx3.SSx5.SSSx3.p3.1.m1.1.1.2.cmml" xref="Sx3.SSx5.SSSx3.p3.1.m1.1.1.2">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx3.p3.1.m1.1c">\log n</annotation></semantics></math> for <math id="Sx3.SSx5.SSSx3.p3.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="Sx3.SSx5.SSSx3.p3.2.m2.1a"><mi id="Sx3.SSx5.SSSx3.p3.2.m2.1.1" xref="Sx3.SSx5.SSSx3.p3.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx3.p3.2.m2.1b"><ci id="Sx3.SSx5.SSSx3.p3.2.m2.1.1.cmml" xref="Sx3.SSx5.SSSx3.p3.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx3.p3.2.m2.1c">n</annotation></semantics></math> ciphertexts. Thus, the communication complexity of Alg. <a href="#alg2" title="In Description ‣ Interaction Protocol ‣ Search over CKKS Ciphertexts ‣ Communication-Efficient Search under Fully Homomorphic Encryption for Federated Machine Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> can be expressed as the sum of messages exchanged during both the initialization phase and the client interaction phase. This yields a total of <math id="Sx3.SSx5.SSSx3.p3.3.m3.1" class="ltx_Math" alttext="1+2\log n" display="inline"><semantics id="Sx3.SSx5.SSSx3.p3.3.m3.1a"><mrow id="Sx3.SSx5.SSSx3.p3.3.m3.1.1" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.cmml"><mn id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.2" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.2.cmml">1</mn><mo id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.1" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.1.cmml">+</mo><mrow id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.cmml"><mn id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.2" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.2.cmml">2</mn><mo lspace="0.167em" rspace="0em" id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.1" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.1.cmml">​</mo><mrow id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3.cmml"><mi id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3.1" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3.1.cmml">log</mi><mo lspace="0.167em" id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3a" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3.cmml">⁡</mo><mi id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3.2" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3.2.cmml">n</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx3.p3.3.m3.1b"><apply id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.cmml" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1"><plus id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.1.cmml" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.1"></plus><cn type="integer" id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.2.cmml" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.2">1</cn><apply id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.cmml" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3"><times id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.1.cmml" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.1"></times><cn type="integer" id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.2.cmml" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.2">2</cn><apply id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3.cmml" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3"><log id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3.1.cmml" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3.1"></log><ci id="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3.2.cmml" xref="Sx3.SSx5.SSSx3.p3.3.m3.1.1.3.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx3.p3.3.m3.1c">1+2\log n</annotation></semantics></math> or <math id="Sx3.SSx5.SSSx3.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{O}(\log n)" display="inline"><semantics id="Sx3.SSx5.SSSx3.p3.4.m4.1a"><mrow id="Sx3.SSx5.SSSx3.p3.4.m4.1.1" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.3" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.3.cmml">𝒪</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.2" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.2.cmml">​</mo><mrow id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.2" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.cmml"><mi id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.1" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.1.cmml">log</mi><mo lspace="0.167em" id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1a" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.cmml">⁡</mo><mi id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.2" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.2.cmml">n</mi></mrow><mo stretchy="false" id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.3" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.SSSx3.p3.4.m4.1b"><apply id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.cmml" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1"><times id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.2.cmml" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.2"></times><ci id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.3.cmml" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.3">𝒪</ci><apply id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.cmml" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1"><log id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.1.cmml" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.1"></log><ci id="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.2.cmml" xref="Sx3.SSx5.SSSx3.p3.4.m4.1.1.1.1.1.2">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.SSSx3.p3.4.m4.1c">\mathcal{O}(\log n)</annotation></semantics></math> messages exchanged between the client and server.</p>
</div>
</section>
</section>
</section>
<section id="Sx4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Discussions</h2>

<section id="Sx4.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Multi-Party Secure Computation</h3>

<div id="Sx4.SSx1.p1" class="ltx_para">
<p id="Sx4.SSx1.p1.1" class="ltx_p">One possible extension involves extending the algorithm to support multi-party secure computation. In the current protocol, interaction is limited to a client-server relationship. However, in scenarios where multiple parties collaborate in federated learning, enabling secure communication among all participants becomes crucial. The extension could involve enhancing the protocol to accommodate secure interactions between multiple clients and a server, ensuring privacy-preserving collaboration among a larger set of participants. This extension would necessitate the development of cryptographic techniques to enable secure communication and computation among multiple parties.</p>
</div>
</section>
<section id="Sx4.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Dynamic Tree Structure</h3>

<div id="Sx4.SSx2.p1" class="ltx_para">
<p id="Sx4.SSx2.p1.1" class="ltx_p">Another potential extension involves adapting the algorithm to handle a dynamic binary tree structure. The current algorithm assumes a static binary tree, but in real-world scenarios, the structure of the tree might change due to various factors. This extension could involve devising mechanisms to handle insertions and deletions of ciphertexts in the binary tree while maintaining the integrity of the search protocol. Additionally, the algorithm might need to account for changes in tree structure during the interaction phase, requiring careful consideration of encryption and decryption operations.</p>
</div>
</section>
<section id="Sx4.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Batch Processing for Efficiency</h3>

<div id="Sx4.SSx3.p1" class="ltx_para">
<p id="Sx4.SSx3.p1.1" class="ltx_p">To enhance efficiency and reduce communication overhead, an extension could introduce batch processing capabilities to the algorithm. Instead of exchanging messages for individual ciphertexts, participants could process multiple ciphertexts in a single batch, reducing the number of communication rounds. This extension would involve modifying the algorithm to handle batch processing, optimizing the use of encryption and decryption operations, and ensuring that the privacy-preserving properties are maintained. Batch processing could significantly improve the algorithm’s efficiency in scenarios involving a large number of ciphertexts.</p>
</div>
</section>
</section>
<section id="Sx5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>

<div id="Sx5.p1" class="ltx_para">
<p id="Sx5.p1.1" class="ltx_p">In conclusion, the proposed <span id="Sx5.p1.1.1" class="ltx_text ltx_font_italic">Server Processing</span> and <span id="Sx5.p1.1.2" class="ltx_text ltx_font_italic">Interaction Protocol</span> algorithms collectively underscore the evolving landscape of privacy-preserving machine learning within federated learning scenarios. The server algorithm’s design demonstrates the fusion of homomorphic encryption and systematic aggregation, enabling the secure integration of clients’ encrypted updates while mitigating data exposure. Its incorporation of cryptographic operations to facilitate aggregation and model update processes signifies a significant stride toward maintaining data privacy in collaborative learning environments.</p>
</div>
<div id="Sx5.p2" class="ltx_para">
<p id="Sx5.p2.1" class="ltx_p">Complementing this, the interaction protocol introduces an innovative approach to securely search for target encrypted values through client-server interactions. By meticulously orchestrating decryption, encryption, and traversal steps within a binary tree structure, the protocol guarantees data privacy while enabling efficient data retrieval. The communication complexity analysis underscores its resource-efficient nature, crucial in federated learning settings where minimizing communication overhead is paramount.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aharoni et al. (2023)</span>
<span class="ltx_bibblock">
Aharoni, E.; Adir, A.; Baruch, M.; Drucker, N.; Ezov, G.; Farkash, A.;
Greenberg, L.; Masalha, R.; Moshkowich, G.; Murik, D.; Shaul, H.; and
Soceanu, O. 2023.

</span>
<span class="ltx_bibblock">HeLayers: A Tile Tensors Framework for Large Neural Networks on
Encrypted Data.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proc. Priv. Enhancing Technol.</em>, 2023(1): 325–342.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alfeld, Zhu, and Barford (2016)</span>
<span class="ltx_bibblock">
Alfeld, S.; Zhu, X.; and Barford, P. 2016.

</span>
<span class="ltx_bibblock">Data poisoning attacks against autoregressive models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bagdasaryan et al. (2020)</span>
<span class="ltx_bibblock">
Bagdasaryan, E.; Veit, A.; Hua, Y.; Estrin, D.; and Shmatikov, V. 2020.

</span>
<span class="ltx_bibblock">How To Backdoor Federated Learning.

</span>
<span class="ltx_bibblock">In Chiappa, S.; and Calandra, R., eds., <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">The 23rd International
Conference on Artificial Intelligence and Statistics, AISTATS 2020, 26-28
August 2020, Online [Palermo, Sicily, Italy]</em>, volume 108 of
<em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, 2938–2948. PMLR.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhagoji et al. (2019)</span>
<span class="ltx_bibblock">
Bhagoji, A. N.; Chakraborty, S.; Mittal, P.; and Calo, S. 2019.

</span>
<span class="ltx_bibblock">Analyzing federated learning through an adversarial lens.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 634–643.
PMLR.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blanchard et al. (2017)</span>
<span class="ltx_bibblock">
Blanchard, P.; El Mhamdi, E. M.; Guerraoui, R.; and Stainer, J. 2017.

</span>
<span class="ltx_bibblock">Machine Learning with Adversaries: Byzantine Tolerant Gradient
Descent.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 31st International Conference on Neural
Information Processing Systems</em>, NIPS’17, 118–128. Red Hook, NY, USA:
Curran Associates Inc.

</span>
<span class="ltx_bibblock">ISBN 9781510860964.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheon et al. (2017)</span>
<span class="ltx_bibblock">
Cheon, J. H.; Kim, A.; Kim, M.; and Song, Y. S. 2017.

</span>
<span class="ltx_bibblock">Homomorphic Encryption for Arithmetic of Approximate Numbers.

</span>
<span class="ltx_bibblock">In Takagi, T.; and Peyrin, T., eds., <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in Cryptology -
ASIACRYPT 2017 - 23rd International Conference on the Theory and
Applications of Cryptology and Information Security, Hong Kong, China,
December 3-7, 2017, Proceedings, Part I</em>, volume 10624 of <em id="bib.bib6.2.2" class="ltx_emph ltx_font_italic">Lecture
Notes in Computer Science</em>, 409–437. Springer.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al. (2021)</span>
<span class="ltx_bibblock">
Cui, S.; Pan, W.; Jian Liang, C. Z.; and Wang, F. 2021.

</span>
<span class="ltx_bibblock">Addressing algorithmic disparity and performance inconsistency in
federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan and Vercauteren (2012)</span>
<span class="ltx_bibblock">
Fan, J.; and Vercauteren, F. 2012.

</span>
<span class="ltx_bibblock">Somewhat Practical Fully Homomorphic Encryption.

</span>
<span class="ltx_bibblock">Cryptology ePrint Archive, Paper 2012/144.

</span>
<span class="ltx_bibblock"><span class="ltx_ref ltx_nolink ltx_url ltx_ref_self">https://eprint.iacr.org/2012/144</span>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. (2022)</span>
<span class="ltx_bibblock">
Gong, X.; Sharma, A.; Karanam, S.; Wu, Z.; Chen, T.; Doermann, D.; and Innanje,
A. 2022.

</span>
<span class="ltx_bibblock">Preserving Privacy in Federated Learning with Ensemble Cross-Domain
Knowledge Distillation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</em>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hamer, Mohri, and Suresh (2020)</span>
<span class="ltx_bibblock">
Hamer, J.; Mohri, M.; and Suresh, A. T. 2020.

</span>
<span class="ltx_bibblock">Fedboost: A communication-efficient algorithm for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hardy et al. (2017)</span>
<span class="ltx_bibblock">
Hardy, S.; Henecka, W.; Ivey-Law, H.; Nock, R.; Patrini, G.; Smith, G.; and
Thorne, B. 2017.

</span>
<span class="ltx_bibblock">Private federated learning on vertically partitioned data via entity
resolution and additively homomorphic encryption.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1711.10677.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, L.; Fan, Y.; Tse, M.; and Lin, K.-Y. 2020.

</span>
<span class="ltx_bibblock">A review of applications in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Computers &amp; Industrial Engineering</em>, 149: 106854.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B.; Moore, E.; Ramage, D.; Hampson, S.; and y Arcas, B. A. 2017.

</span>
<span class="ltx_bibblock">Communication-Efficient Learning of Deep Networks from Decentralized
Data.

</span>
<span class="ltx_bibblock">In Singh, A.; and Zhu, X. J., eds., <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th
International Conference on Artificial Intelligence and Statistics (AISTAT</em>,
volume 54 of <em id="bib.bib13.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, 1273–1282.
PMLR.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Merkle (1988)</span>
<span class="ltx_bibblock">
Merkle, R. C. 1988.

</span>
<span class="ltx_bibblock">A Digital Signature Based on a Conventional Encryption Function.

</span>
<span class="ltx_bibblock">In Pomerance, C., ed., <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Advances in Cryptology — CRYPTO ’87</em>,
369–378. Berlin, Heidelberg: Springer Berlin Heidelberg.

</span>
<span class="ltx_bibblock">ISBN 978-3-540-48184-3.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paillier (1999)</span>
<span class="ltx_bibblock">
Paillier, P. 1999.

</span>
<span class="ltx_bibblock">Public-Key Cryptosystems Based on Composite Degree Residuosity
Classes.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 17th International Conference on Theory
and Application of Cryptographic Techniques</em>, EUROCRYPT’99, 223–238.
Berlin, Heidelberg: Springer-Verlag.

</span>
<span class="ltx_bibblock">ISBN 3540658890.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reisizadeh et al. (2020)</span>
<span class="ltx_bibblock">
Reisizadeh, A.; Mokhtari, A.; Hassani, H.; Jadbabaie, A.; and Pedarsani, R.
2020.

</span>
<span class="ltx_bibblock">Fedpaq: A communication-efficient federated learning method with
periodic averaging and quantization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and
Statistics</em>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Savvides, Khandelwal, and Eugster (2020)</span>
<span class="ltx_bibblock">
Savvides, S.; Khandelwal, D.; and Eugster, P. 2020.

</span>
<span class="ltx_bibblock">Efficient Confidentiality-Preserving Data Analytics over
Symmetrically Encrypted Datasets.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proc. VLDB Endow.</em>, 13(8): 1290–1303.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shejwalkar and Houmansadr (2021)</span>
<span class="ltx_bibblock">
Shejwalkar, V.; and Houmansadr, A. 2021.

</span>
<span class="ltx_bibblock">Manipulating the byzantine: Optimizing model poisoning attacks and
defenses for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Network and Distributed Systems Security (NDSS) Symposium
2021</em>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2021)</span>
<span class="ltx_bibblock">
Sun, J.; Li, A.; DiValentin, L.; Hassanzadeh, A.; Chen, Y.; and Li, H. 2021.

</span>
<span class="ltx_bibblock">Fl-wbc: Enhancing robustness against model poisoning attacks in
federated learning from a client perspective.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2019)</span>
<span class="ltx_bibblock">
Sun, Z.; Kairouz, P.; Suresh, A. T.; and McMahan, H. B. 2019.

</span>
<span class="ltx_bibblock">Can you really backdoor federated learning?

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1911.07963</em>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2020)</span>
<span class="ltx_bibblock">
Xie, C.; Huang, K.; Chen, P.-Y.; and Li, B. 2020.

</span>
<span class="ltx_bibblock">DBA: Distributed Backdoor Attacks against Federated Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2019)</span>
<span class="ltx_bibblock">
Yang, Q.; Liu, Y.; Chen, T.; and Tong, Y. 2019.

</span>
<span class="ltx_bibblock">Federated Machine Learning: Concept and Applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ACM Trans. Intell. Syst. Technol.</em>, 10(2).

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2018)</span>
<span class="ltx_bibblock">
Yin, D.; Chen, Y.; Kannan, R.; and Bartlett, P. 2018.

</span>
<span class="ltx_bibblock">Byzantine-robust distributed learning: Towards optimal statistical
rates.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2020)</span>
<span class="ltx_bibblock">
Zhang, C.; Li, S.; Xia, J.; Wang, W.; Yan, F.; and Liu, Y. 2020.

</span>
<span class="ltx_bibblock">BatchCrypt: Efficient Homomorphic Encryption for Cross-Silo
Federated Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">2020 USENIX Annual Technical Conference (USENIX ATC 20)</em>,
493–506. USENIX Association.

</span>
<span class="ltx_bibblock">ISBN 978-1-939133-14-4.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2308.04647" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2308.04648" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2308.04648">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2308.04648" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2308.04650" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 13:15:27 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
