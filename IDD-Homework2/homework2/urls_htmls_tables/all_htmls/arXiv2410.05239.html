<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models</title>
<!--Generated on Tue Oct  8 06:57:35 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Prompt Tuning Vision-Language Segmentation Models Medical Image Segmentation" lang="en" name="keywords"/>
<base href="/html/2410.05239v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S1" title="In TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S2" title="In TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S2.SS1" title="In 2 Related Work ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Vision-Language Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S2.SS2" title="In 2 Related Work ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Vision-Language Segmentation Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S2.SS3" title="In 2 Related Work ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Prompt Tuning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S3" title="In TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Revisiting CLIP</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S3.SS1" title="In 3 Revisiting CLIP ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Text Encoding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S3.SS2" title="In 3 Revisiting CLIP ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Image Encoding</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S4" title="In TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Revisiting Prompt Tuning</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S4.SS1" title="In 4 Revisiting Prompt Tuning ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Textual Prompt Tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S4.SS2" title="In 4 Revisiting Prompt Tuning ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Visual Prompt Tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S4.SS3" title="In 4 Revisiting Prompt Tuning ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Multimodal Prompt Tuning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S5" title="In TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Method</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6" title="In TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.SS1" title="In 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.SS2" title="In 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S7" title="In TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Results and Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S7.SS1" title="In 7 Results and Discussion ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.1 </span>Choice of Prompt Tuning Technique</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S7.SS2" title="In 7 Results and Discussion ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2 </span>Importance of Prompt Initialization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S7.SS3" title="In 7 Results and Discussion ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.3 </span>Importance of Tuning Last Layer for Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S7.SS4" title="In 7 Results and Discussion ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.4 </span>Importance of Prompt Depth</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S7.SS5" title="In 7 Results and Discussion ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.5 </span>Learning Rate and Weight Decay</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S8" title="In TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S9" title="In TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">9 </span>Conclusion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S9.SS0.SSS1" title="In 9 Conclusion ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">9.0.1 </span>Acknowledgements</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#Pt0.A1" title="In TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">0.A </span>How does prompt depth affect Dice Score?</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#Pt0.A2" title="In TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">0.B </span>How does learning rate and weight decay affect Dice?</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rabin Adhikari<a class="ltx_ref ltx_href" href="https://orcid.org/0000-0001-5019-2205" title=""><span class="ltx_ERROR undefined" id="id11.2.2.id1">\XeTeXLinkBox</span><span class="ltx_text" id="id1.1.1.1"> <svg class="ltx_picture" height="1" id="id1.1.1.1.pic1" overflow="visible" version="1.1" width="1"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,1) matrix(1 0 0 -1 0 0)"><path d="M 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 Z" style="stroke:none"></path><path d="M 0 0 L 0 0 L 0 0 L 0 0 L 0 0 L 0 0 Z M 0 0 L 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 L 0 0 L 0 0 Z M 0 0 L 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 L 0 0 L 0 0 Z M 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 Z" style="stroke:none"></path></g></svg></span></a>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Safal Thapaliya<a class="ltx_ref ltx_href" href="https://orcid.org/0000-0002-4463-6700" title=""><span class="ltx_ERROR undefined" id="id12.2.2.id1">\XeTeXLinkBox</span><span class="ltx_text" id="id2.1.1.1"> <svg class="ltx_picture" height="1" id="id2.1.1.1.pic1" overflow="visible" version="1.1" width="1"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,1) matrix(1 0 0 -1 0 0)"><path d="M 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 Z" style="stroke:none"></path><path d="M 0 0 L 0 0 L 0 0 L 0 0 L 0 0 L 0 0 Z M 0 0 L 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 L 0 0 L 0 0 Z M 0 0 L 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 L 0 0 L 0 0 Z M 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 Z" style="stroke:none"></path></g></svg></span></a>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Manish Dhakal<span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotemark: </span></span></span></span><a class="ltx_ref ltx_href" href="https://orcid.org/0000-0002-0101-5592" title=""><span class="ltx_ERROR undefined" id="id13.2.2.id1">\XeTeXLinkBox</span><span class="ltx_text" id="id3.1.1.1"> <svg class="ltx_picture" height="1" id="id3.1.1.1.pic1" overflow="visible" version="1.1" width="1"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,1) matrix(1 0 0 -1 0 0)"><path d="M 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 Z" style="stroke:none"></path><path d="M 0 0 L 0 0 L 0 0 L 0 0 L 0 0 L 0 0 Z M 0 0 L 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 L 0 0 L 0 0 Z M 0 0 L 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 L 0 0 L 0 0 Z M 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 Z" style="stroke:none"></path></g></svg></span></a>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bishesh Khanal<a class="ltx_ref ltx_href" href="https://orcid.org/0000-0002-2775-4748" title=""><span class="ltx_ERROR undefined" id="id14.2.2.id1">\XeTeXLinkBox</span><span class="ltx_text" id="id4.1.1.1"> <svg class="ltx_picture" height="1" id="id4.1.1.1.pic1" overflow="visible" version="1.1" width="1"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,1) matrix(1 0 0 -1 0 0)"><path d="M 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 Z" style="stroke:none"></path><path d="M 0 0 L 0 0 L 0 0 L 0 0 L 0 0 L 0 0 Z M 0 0 L 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 L 0 0 L 0 0 Z M 0 0 L 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 L 0 0 L 0 0 Z M 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 C 0 0 0 0 0 0 Z" style="stroke:none"></path></g></svg></span></a>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id10.6">Vision-Language Models (VLMs) have shown impressive performance in vision tasks, but adapting them to new domains often requires expensive fine-tuning.
Prompt tuning techniques, including textual, visual, and multimodal prompting, offer efficient alternatives by leveraging learnable prompts.
However, their application to Vision-Language Segmentation Models (VLSMs) and evaluation under significant domain shifts remain unexplored.
This work presents an open-source benchmarking framework, <span class="ltx_text ltx_font_italic" id="id10.6.1">TuneVLSeg</span>, to integrate various unimodal and multimodal prompt tuning techniques into VLSMs, making prompt tuning usable for downstream segmentation datasets with any number of classes.
<span class="ltx_text ltx_font_italic" id="id10.6.2">TuneVLSeg</span> includes <math alttext="6" class="ltx_Math" display="inline" id="id5.1.m1.1"><semantics id="id5.1.m1.1a"><mn id="id5.1.m1.1.1" xref="id5.1.m1.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="id5.1.m1.1b"><cn id="id5.1.m1.1.1.cmml" type="integer" xref="id5.1.m1.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="id5.1.m1.1c">6</annotation><annotation encoding="application/x-llamapun" id="id5.1.m1.1d">6</annotation></semantics></math> prompt tuning strategies on various prompt depths used in <math alttext="2" class="ltx_Math" display="inline" id="id6.2.m2.1"><semantics id="id6.2.m2.1a"><mn id="id6.2.m2.1.1" xref="id6.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="id6.2.m2.1b"><cn id="id6.2.m2.1.1.cmml" type="integer" xref="id6.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="id6.2.m2.1c">2</annotation><annotation encoding="application/x-llamapun" id="id6.2.m2.1d">2</annotation></semantics></math> VLSMs totaling of <math alttext="8" class="ltx_Math" display="inline" id="id7.3.m3.1"><semantics id="id7.3.m3.1a"><mn id="id7.3.m3.1.1" xref="id7.3.m3.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="id7.3.m3.1b"><cn id="id7.3.m3.1.1.cmml" type="integer" xref="id7.3.m3.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="id7.3.m3.1c">8</annotation><annotation encoding="application/x-llamapun" id="id7.3.m3.1d">8</annotation></semantics></math> different combinations.
We test various prompt tuning on <math alttext="8" class="ltx_Math" display="inline" id="id8.4.m4.1"><semantics id="id8.4.m4.1a"><mn id="id8.4.m4.1.1" xref="id8.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="id8.4.m4.1b"><cn id="id8.4.m4.1.1.cmml" type="integer" xref="id8.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="id8.4.m4.1c">8</annotation><annotation encoding="application/x-llamapun" id="id8.4.m4.1d">8</annotation></semantics></math> diverse medical datasets, including <math alttext="3" class="ltx_Math" display="inline" id="id9.5.m5.1"><semantics id="id9.5.m5.1a"><mn id="id9.5.m5.1.1" xref="id9.5.m5.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="id9.5.m5.1b"><cn id="id9.5.m5.1.1.cmml" type="integer" xref="id9.5.m5.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="id9.5.m5.1c">3</annotation><annotation encoding="application/x-llamapun" id="id9.5.m5.1d">3</annotation></semantics></math> radiology datasets (breast tumor, echocardiograph, chest X-ray pathologies) and <math alttext="5" class="ltx_Math" display="inline" id="id10.6.m6.1"><semantics id="id10.6.m6.1a"><mn id="id10.6.m6.1.1" xref="id10.6.m6.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="id10.6.m6.1b"><cn id="id10.6.m6.1.1.cmml" type="integer" xref="id10.6.m6.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="id10.6.m6.1c">5</annotation><annotation encoding="application/x-llamapun" id="id10.6.m6.1d">5</annotation></semantics></math> non-radiology datasets (polyp, ulcer, skin cancer), and two natural domain segmentation datasets.
Our study found that textual prompt tuning struggles under significant domain shifts, from natural-domain images to medical data.
Furthermore, visual prompt tuning, with fewer hyperparameters than multimodal prompt tuning, often achieves performance competitive to multimodal approaches, making it a valuable first attempt.
Our work advances the understanding and applicability of different prompt-tuning techniques for robust domain-specific segmentation.
The source code is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/naamiinepal/tunevlseg" title="">https://github.com/naamiinepal/tunevlseg</a>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Prompt Tuning Vision-Language Segmentation Models Medical Image Segmentation
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering" id="S1.F1.g1" src="prompt-tuning-overview"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">Manual prompting in CLIP and CLIP-based segmentation models.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Segmenting the anatomical and pathological structures in medical images is crucial for computer-aided diagnosis, prognosis, and surgery planning.
Recent deep-learning-based segmentation models have shown excellent performance on curated datasets, but lack generalization across anatomies and image modalities as they are typically trained on a limited set of anatomies and modalities or fine-tuned using pretrained weights from models trained on natural images like ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib10" title="">10</a>]</cite>.
Recent advancements in foundational vision language models (VLMs) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib58" title="">58</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib28" title="">28</a>]</cite>, which leverage the image and text data, have gained significant attention from the research community due to their generalization capabilities across new dataset and vision tasks.
These models have been adopted for segmentation tasks in natural images <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib63" title="">63</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib32" title="">32</a>]</cite>, and show excellent generalization for segmentation as well.
These vision-language segmentation models (VLSMs) use the pretrained encoders of the VLMs with an added segmentation decoder.
The surprising generalization ability of VLSMs stems from the language supervision provided by text inputs, known as <span class="ltx_text ltx_font_italic" id="S1.p1.1.1">prompts</span>.
During inference, prompts like “<span class="ltx_text ltx_font_typewriter" id="S1.p1.1.2">a photo of a {<span class="ltx_text ltx_font_italic" id="S1.p1.1.2.1">object</span>}</span>” supply auxiliary information along with image embeddings to identify the target class, and high-quality prompts are crucial for enhancing VLSM’s performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib36" title="">36</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Extending VLSMs to medical image segmentation tasks presents challenges, particularly in designing effective prompts for VLSMs pretrained on natural images <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib36" title="">36</a>]</cite>.
This often results in suboptimal performance for medical image segmentation, thus requiring fine-tuning on medical datasets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib59" title="">59</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib56" title="">56</a>]</cite>.
Given the massive scale of these models and the scarcity of large labeled medical datasets, fine-tuning VLSMs for medical datasets is often infeasible.
One of the efforts to extend these models to new domains with fewer data and computational requirements is prompt tuning.
It is robust to noisy labels <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib49" title="">49</a>]</cite>, making this strategy favorable to extend VLMs pretrained on natural images to medical datasets.
The prompt tuning strategies (also known as <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">context learners</span>) can be extended to VLSMs as they share a similar architecture with VLMs, which are usually composed of text and vision encoders, with an added segmentation decoder (see <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S1.F1" title="In 1 Introduction ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Prompt tuning addresses the challenge of hand-engineering prompts by introducing learnable prompts (also called <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">context vectors</span>), thus adapting VLMs to new datasets by optimizing only these context vectors <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib62" title="">62</a>]</cite>.
Extending prompt tuning to the segmentation task has its caveats.
As illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S4.F2" title="In 4.3 Multimodal Prompt Tuning ‣ 4 Revisiting Prompt Tuning ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, the context vectors can be introduced at text <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib61" title="">61</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib62" title="">62</a>]</cite>, vision <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib19" title="">19</a>]</cite>, or both inputs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib53" title="">53</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib23" title="">23</a>]</cite>.
Additionally, these vectors can be injected at different depths at the encoders, and with an added decoder for segmentation tasks, these challenges are further escalated.
However, most studies on prompt tuning have focused primarily on image classification, limiting insights on the prospect of prompt tuning on downstream image segmentation tasks.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.4">In this work, we propose an open-source benchmark framework, <span class="ltx_text ltx_font_italic" id="S1.p4.4.1">TuneVLSeg</span>, incorporating unimodal and multimodal prompt tuning methods for a principled way of evaluating prompt tuning for different class-agnostic VLSMs.
We study the effects of adding the context vectors at multiple depths at both image and text encoders.
We also evaluate the performance of the <math alttext="6" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mn id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><cn id="S1.p4.1.m1.1.1.cmml" type="integer" xref="S1.p4.1.m1.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">6</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">6</annotation></semantics></math> prompt tuning methods on adapting <math alttext="2" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mn id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><cn id="S1.p4.2.m2.1.1.cmml" type="integer" xref="S1.p4.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">2</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">2</annotation></semantics></math> pretrained VLSMs to <math alttext="2" class="ltx_Math" display="inline" id="S1.p4.3.m3.1"><semantics id="S1.p4.3.m3.1a"><mn id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><cn id="S1.p4.3.m3.1.1.cmml" type="integer" xref="S1.p4.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">2</annotation><annotation encoding="application/x-llamapun" id="S1.p4.3.m3.1d">2</annotation></semantics></math> natural and <math alttext="8" class="ltx_Math" display="inline" id="S1.p4.4.m4.1"><semantics id="S1.p4.4.m4.1a"><mn id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.1b"><cn id="S1.p4.4.m4.1.1.cmml" type="integer" xref="S1.p4.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.1c">8</annotation><annotation encoding="application/x-llamapun" id="S1.p4.4.m4.1d">8</annotation></semantics></math> medical segmentation datasets.
Our benchmark framework can be extended to adapting other class-agnostic VLSMs using new prompt-tuning methods to other segmentation datasets with little to no effort.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Our major contributions encompass the following points:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">A principled way of evaluating different unimodal and multimodal prompt-tuning strategies for segmentation tasks.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">A modifiable and reusable benchmark framework, <span class="ltx_text ltx_font_italic" id="S1.I1.i2.p1.1.1">TuneVLSeg</span>, leveraging pretrained VLSMs to fine-tune them to target segmentation tasks with prompt-tuning.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Comparing the effectiveness of different unimodal and multimodal prompt-tuning in natural and medical segmentation datasets across multiple radiology and non-radiology images.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Vision-Language Models</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Vision-Language Models (VLMs) incorporate representation modules to connect image and text features, enabling their use in various vision-language tasks such as visual question-answering (VQA), image segmentation, image-text retrieval, object detection, and phrase grounding.
Bordes <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.1.1">et al</em>.<span class="ltx_text" id="S2.SS1.p1.1.2"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib6" title="">6</a>]</cite> have categorized VLM training into four distinct classes.
<span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.3">Contrastive VLMs </span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib54" title="">54</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib28" title="">28</a>]</cite> learn to project text and vision features onto the same embedding space to establish equivalence among the modalities.
<span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.4">VLMs with masking objectives</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib43" title="">43</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib8" title="">8</a>]</cite> are trained to guide models to predict missing image patches or text tokens for establishing similarity between both modalities.
<span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.5">Generative models</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib52" title="">52</a>]</cite> are optimized for generating images using the text representation and vice-versa.
<span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.6">VLMs with pretrained backbone</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib65" title="">65</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib44" title="">44</a>]</cite> train a mapping network between pretrained encoders, thus, requiring fewer compute.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Vision-Language Segmentation Models</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">VLMs’ capacity to capture multimodal information has led to their widespread use as a backbone for segmentation tasks.
Vision-Language Segmentation Models (VLSMs) incorporate a vision-language decoder on top of the pretrained VLM encoders to capture information from both text and vision branches.
DenseCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib38" title="">38</a>]</cite> employs a vision-language decoder atop CLIP encoders, utilizing pixel-text score maps to guide the learning of dense prediction models.
Similarly, CLIPSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib32" title="">32</a>]</cite> and CRIS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib45" title="">45</a>]</cite> provide zero-shot segmentations by predicting pixel-level activations for the given text or image query.
ZegCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib63" title="">63</a>]</cite> introduces tuned prompts and associates image information with text encodings before patch-text contrasting, aiming to reduce overfitting of seen classes in both inductive and transductive zero-shot settings.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Prompt Tuning</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Prompts play a crucial role in downstream datasets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib51" title="">51</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib21" title="">21</a>]</cite>.
However, identifying the optimal prompt for a given downstream task can be burdensome and sometimes requires prior knowledge.
Therefore, a more effective approach is automatically learning these prompts for specific downstream tasks instead of providing manual prompts.
This paradigm of learning a task-specific prompt is known as prompt tuning, which was first used in NLP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib60" title="">60</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib29" title="">29</a>]</cite>.
It was subsequently adapted for the text branch of VLMs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib61" title="">61</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib62" title="">62</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib64" title="">64</a>]</cite> and vision-only models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib57" title="">57</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib46" title="">46</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib47" title="">47</a>]</cite>.
Finally, multimodal prompt tuning strategies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib53" title="">53</a>]</cite> were applied to both text and vision encoders of VLMs, demonstrating superior performance compared to unimodal approaches.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">Although prompt tuning strategies have been extensively studied for VLMs like CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib37" title="">37</a>]</cite>, few studies have focused on applying these techniques to VLSMs.
DenseCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib38" title="">38</a>]</cite> and ZegCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib63" title="">63</a>]</cite> introduced CoOp <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib62" title="">62</a>]</cite> and VPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib19" title="">19</a>]</cite> for VLSMs, respectively.
However, the main drawback of these models is that changes in the number of classes in the segmentation task alter the number of channels in their weights.
This renders their pretrained weights unusable for downstream tasks unless the desired class(es) were present during pretraining.
</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Revisiting CLIP</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Text Encoding</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.5">CLIP’s text encoder tokenizes the provided text with some special tokens, generates their corresponding word embeddings, and adds the position encoding before passing them to the first transformer layer, <math alttext="W_{0}=[w_{0}^{1},w_{0}^{2},\cdots,w_{0}^{N}]\in\mathbb{R}^{N\times H_{l}}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.4"><semantics id="S3.SS1.p1.1.m1.4a"><mrow id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml"><msub id="S3.SS1.p1.1.m1.4.4.5" xref="S3.SS1.p1.1.m1.4.4.5.cmml"><mi id="S3.SS1.p1.1.m1.4.4.5.2" xref="S3.SS1.p1.1.m1.4.4.5.2.cmml">W</mi><mn id="S3.SS1.p1.1.m1.4.4.5.3" xref="S3.SS1.p1.1.m1.4.4.5.3.cmml">0</mn></msub><mo id="S3.SS1.p1.1.m1.4.4.6" xref="S3.SS1.p1.1.m1.4.4.6.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.4.4.3.3" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml"><mo id="S3.SS1.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">[</mo><msubsup id="S3.SS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.1.2.2" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.2.cmml">w</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.1.2.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.3.cmml">0</mn><mn id="S3.SS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.p1.1.m1.4.4.3.3.5" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.cmml">w</mi><mn id="S3.SS1.p1.1.m1.3.3.2.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.3.cmml">0</mn><mn id="S3.SS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.p1.1.m1.4.4.3.3.6" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.1.m1.4.4.3.3.7" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.1.m1.4.4.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.1.m1.4.4.3.3.3.2.2" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2.2.cmml">w</mi><mn id="S3.SS1.p1.1.m1.4.4.3.3.3.2.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2.3.cmml">0</mn><mi id="S3.SS1.p1.1.m1.4.4.3.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.3.cmml">N</mi></msubsup><mo id="S3.SS1.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">]</mo></mrow><mo id="S3.SS1.p1.1.m1.4.4.7" xref="S3.SS1.p1.1.m1.4.4.7.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.4.4.8" xref="S3.SS1.p1.1.m1.4.4.8.cmml"><mi id="S3.SS1.p1.1.m1.4.4.8.2" xref="S3.SS1.p1.1.m1.4.4.8.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.1.m1.4.4.8.3" xref="S3.SS1.p1.1.m1.4.4.8.3.cmml"><mi id="S3.SS1.p1.1.m1.4.4.8.3.2" xref="S3.SS1.p1.1.m1.4.4.8.3.2.cmml">N</mi><mo id="S3.SS1.p1.1.m1.4.4.8.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.4.4.8.3.1.cmml">×</mo><msub id="S3.SS1.p1.1.m1.4.4.8.3.3" xref="S3.SS1.p1.1.m1.4.4.8.3.3.cmml"><mi id="S3.SS1.p1.1.m1.4.4.8.3.3.2" xref="S3.SS1.p1.1.m1.4.4.8.3.3.2.cmml">H</mi><mi id="S3.SS1.p1.1.m1.4.4.8.3.3.3" xref="S3.SS1.p1.1.m1.4.4.8.3.3.3.cmml">l</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.4b"><apply id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4"><and id="S3.SS1.p1.1.m1.4.4a.cmml" xref="S3.SS1.p1.1.m1.4.4"></and><apply id="S3.SS1.p1.1.m1.4.4b.cmml" xref="S3.SS1.p1.1.m1.4.4"><eq id="S3.SS1.p1.1.m1.4.4.6.cmml" xref="S3.SS1.p1.1.m1.4.4.6"></eq><apply id="S3.SS1.p1.1.m1.4.4.5.cmml" xref="S3.SS1.p1.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.5.1.cmml" xref="S3.SS1.p1.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.5.2.cmml" xref="S3.SS1.p1.1.m1.4.4.5.2">𝑊</ci><cn id="S3.SS1.p1.1.m1.4.4.5.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.4.4.5.3">0</cn></apply><list id="S3.SS1.p1.1.m1.4.4.3.4.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3"><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.2">𝑤</ci><cn id="S3.SS1.p1.1.m1.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.3">0</cn></apply><cn id="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.2">𝑤</ci><cn id="S3.SS1.p1.1.m1.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.3">0</cn></apply><cn id="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">⋯</ci><apply id="S3.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3">superscript</csymbol><apply id="S3.SS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2.2">𝑤</ci><cn id="S3.SS1.p1.1.m1.4.4.3.3.3.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2.3">0</cn></apply><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3.3">𝑁</ci></apply></list></apply><apply id="S3.SS1.p1.1.m1.4.4c.cmml" xref="S3.SS1.p1.1.m1.4.4"><in id="S3.SS1.p1.1.m1.4.4.7.cmml" xref="S3.SS1.p1.1.m1.4.4.7"></in><share href="https://arxiv.org/html/2410.05239v2#S3.SS1.p1.1.m1.4.4.3.cmml" id="S3.SS1.p1.1.m1.4.4d.cmml" xref="S3.SS1.p1.1.m1.4.4"></share><apply id="S3.SS1.p1.1.m1.4.4.8.cmml" xref="S3.SS1.p1.1.m1.4.4.8"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.8.1.cmml" xref="S3.SS1.p1.1.m1.4.4.8">superscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.8.2.cmml" xref="S3.SS1.p1.1.m1.4.4.8.2">ℝ</ci><apply id="S3.SS1.p1.1.m1.4.4.8.3.cmml" xref="S3.SS1.p1.1.m1.4.4.8.3"><times id="S3.SS1.p1.1.m1.4.4.8.3.1.cmml" xref="S3.SS1.p1.1.m1.4.4.8.3.1"></times><ci id="S3.SS1.p1.1.m1.4.4.8.3.2.cmml" xref="S3.SS1.p1.1.m1.4.4.8.3.2">𝑁</ci><apply id="S3.SS1.p1.1.m1.4.4.8.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.8.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.8.3.3.1.cmml" xref="S3.SS1.p1.1.m1.4.4.8.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.8.3.3.2.cmml" xref="S3.SS1.p1.1.m1.4.4.8.3.3.2">𝐻</ci><ci id="S3.SS1.p1.1.m1.4.4.8.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.8.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.4c">W_{0}=[w_{0}^{1},w_{0}^{2},\cdots,w_{0}^{N}]\in\mathbb{R}^{N\times H_{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.4d">italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = [ italic_w start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , ⋯ , italic_w start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_H start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
Each <math alttext="W_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">W</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑊</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">W_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is passed to the <math alttext="(i+1)^{th}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msup id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mrow id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.3.m3.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml">i</mi><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p1.3.m3.1.1.3.1" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1">superscript</csymbol><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1"><plus id="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1"></plus><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.2">𝑖</ci><cn id="S3.SS1.p1.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><times id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1"></times><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">(i+1)^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">( italic_i + 1 ) start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> transformer layer <math alttext="\mathcal{L}_{i+1}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">ℒ</mi><mrow id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.4.m4.1.1.3.1" xref="S3.SS1.p1.4.m4.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">ℒ</ci><apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><plus id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3.1"></plus><ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">𝑖</ci><cn id="S3.SS1.p1.4.m4.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{L}_{i+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT</annotation></semantics></math>, outputting <math alttext="W_{i+1}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">W</mi><mrow id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.5.m5.1.1.3.1" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑊</ci><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><plus id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1"></plus><ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">𝑖</ci><cn id="S3.SS1.p1.5.m5.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">W_{i+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_W start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT</annotation></semantics></math>.
Mathematically,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="W_{i+1}=\mathcal{L}_{i+1}(W_{i})\qquad\qquad i=0,1,\cdots,K_{l}-1" class="ltx_Math" display="block" id="S3.E1.m1.5"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.2" xref="S3.E1.m1.5.5.3.cmml"><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><msub id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml"><mi id="S3.E1.m1.4.4.1.1.3.2" xref="S3.E1.m1.4.4.1.1.3.2.cmml">W</mi><mrow id="S3.E1.m1.4.4.1.1.3.3" xref="S3.E1.m1.4.4.1.1.3.3.cmml"><mi id="S3.E1.m1.4.4.1.1.3.3.2" xref="S3.E1.m1.4.4.1.1.3.3.2.cmml">i</mi><mo id="S3.E1.m1.4.4.1.1.3.3.1" xref="S3.E1.m1.4.4.1.1.3.3.1.cmml">+</mo><mn id="S3.E1.m1.4.4.1.1.3.3.3" xref="S3.E1.m1.4.4.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.1" xref="S3.E1.m1.4.4.1.1.1.cmml"><msub id="S3.E1.m1.4.4.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.1.3.2" xref="S3.E1.m1.4.4.1.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E1.m1.4.4.1.1.1.3.3" xref="S3.E1.m1.4.4.1.1.1.3.3.cmml"><mi id="S3.E1.m1.4.4.1.1.1.3.3.2" xref="S3.E1.m1.4.4.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E1.m1.4.4.1.1.1.3.3.1" xref="S3.E1.m1.4.4.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E1.m1.4.4.1.1.1.3.3.3" xref="S3.E1.m1.4.4.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E1.m1.4.4.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.4.4.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace id="S3.E1.m1.5.5.2.3" width="4em" xref="S3.E1.m1.5.5.3a.cmml"></mspace><mrow id="S3.E1.m1.5.5.2.2" xref="S3.E1.m1.5.5.2.2.cmml"><mi id="S3.E1.m1.5.5.2.2.3" xref="S3.E1.m1.5.5.2.2.3.cmml">i</mi><mo id="S3.E1.m1.5.5.2.2.2" xref="S3.E1.m1.5.5.2.2.2.cmml">=</mo><mrow id="S3.E1.m1.5.5.2.2.1.1" xref="S3.E1.m1.5.5.2.2.1.2.cmml"><mn id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">0</mn><mo id="S3.E1.m1.5.5.2.2.1.1.2" xref="S3.E1.m1.5.5.2.2.1.2.cmml">,</mo><mn id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">1</mn><mo id="S3.E1.m1.5.5.2.2.1.1.3" xref="S3.E1.m1.5.5.2.2.1.2.cmml">,</mo><mi id="S3.E1.m1.3.3" mathvariant="normal" xref="S3.E1.m1.3.3.cmml">⋯</mi><mo id="S3.E1.m1.5.5.2.2.1.1.4" xref="S3.E1.m1.5.5.2.2.1.2.cmml">,</mo><mrow id="S3.E1.m1.5.5.2.2.1.1.1" xref="S3.E1.m1.5.5.2.2.1.1.1.cmml"><msub id="S3.E1.m1.5.5.2.2.1.1.1.2" xref="S3.E1.m1.5.5.2.2.1.1.1.2.cmml"><mi id="S3.E1.m1.5.5.2.2.1.1.1.2.2" xref="S3.E1.m1.5.5.2.2.1.1.1.2.2.cmml">K</mi><mi id="S3.E1.m1.5.5.2.2.1.1.1.2.3" xref="S3.E1.m1.5.5.2.2.1.1.1.2.3.cmml">l</mi></msub><mo id="S3.E1.m1.5.5.2.2.1.1.1.1" xref="S3.E1.m1.5.5.2.2.1.1.1.1.cmml">−</mo><mn id="S3.E1.m1.5.5.2.2.1.1.1.3" xref="S3.E1.m1.5.5.2.2.1.1.1.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.3.cmml" xref="S3.E1.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.3a.cmml" xref="S3.E1.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1.1"><eq id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2"></eq><apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2">𝑊</ci><apply id="S3.E1.m1.4.4.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3"><plus id="S3.E1.m1.4.4.1.1.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.1"></plus><ci id="S3.E1.m1.4.4.1.1.3.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2">𝑖</ci><cn id="S3.E1.m1.4.4.1.1.3.3.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E1.m1.4.4.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1"><times id="S3.E1.m1.4.4.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.2"></times><apply id="S3.E1.m1.4.4.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.3.2">ℒ</ci><apply id="S3.E1.m1.4.4.1.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.1.3.3"><plus id="S3.E1.m1.4.4.1.1.1.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.3.3.1"></plus><ci id="S3.E1.m1.4.4.1.1.1.3.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.3.3.2">𝑖</ci><cn id="S3.E1.m1.4.4.1.1.1.3.3.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E1.m1.5.5.2.2.cmml" xref="S3.E1.m1.5.5.2.2"><eq id="S3.E1.m1.5.5.2.2.2.cmml" xref="S3.E1.m1.5.5.2.2.2"></eq><ci id="S3.E1.m1.5.5.2.2.3.cmml" xref="S3.E1.m1.5.5.2.2.3">𝑖</ci><list id="S3.E1.m1.5.5.2.2.1.2.cmml" xref="S3.E1.m1.5.5.2.2.1.1"><cn id="S3.E1.m1.1.1.cmml" type="integer" xref="S3.E1.m1.1.1">0</cn><cn id="S3.E1.m1.2.2.cmml" type="integer" xref="S3.E1.m1.2.2">1</cn><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">⋯</ci><apply id="S3.E1.m1.5.5.2.2.1.1.1.cmml" xref="S3.E1.m1.5.5.2.2.1.1.1"><minus id="S3.E1.m1.5.5.2.2.1.1.1.1.cmml" xref="S3.E1.m1.5.5.2.2.1.1.1.1"></minus><apply id="S3.E1.m1.5.5.2.2.1.1.1.2.cmml" xref="S3.E1.m1.5.5.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.5.5.2.2.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.5.5.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.5.5.2.2.1.1.1.2.2">𝐾</ci><ci id="S3.E1.m1.5.5.2.2.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.2.2.1.1.1.2.3">𝑙</ci></apply><cn id="S3.E1.m1.5.5.2.2.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.5.5.2.2.1.1.1.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">W_{i+1}=\mathcal{L}_{i+1}(W_{i})\qquad\qquad i=0,1,\cdots,K_{l}-1</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.5d">italic_W start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ( italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) italic_i = 0 , 1 , ⋯ , italic_K start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT - 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.4">Here, <math alttext="K_{l}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">K</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝐾</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">K_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_K start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> denotes the number of transformer layers for the text encoder.
Furthermore, the sentence embedding is extracted from the output the ultimate layer (<math alttext="W_{K}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">W</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑊</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">W_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>) as the last vector in the sequence (corresponding to the End of Sentence (EOS) token), <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.4.1">i.e</em>.<span class="ltx_text" id="S3.SS1.p2.4.2"></span>, <math alttext="W_{K}^{N}\in\mathbb{R}^{H_{l}}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><msubsup id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2.2.2" xref="S3.SS1.p2.3.m3.1.1.2.2.2.cmml">W</mi><mi id="S3.SS1.p2.3.m3.1.1.2.2.3" xref="S3.SS1.p2.3.m3.1.1.2.2.3.cmml">K</mi><mi id="S3.SS1.p2.3.m3.1.1.2.3" xref="S3.SS1.p2.3.m3.1.1.2.3.cmml">N</mi></msubsup><mo id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.3.2" xref="S3.SS1.p2.3.m3.1.1.3.3.2.cmml">H</mi><mi id="S3.SS1.p2.3.m3.1.1.3.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.3.cmml">l</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><in id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></in><apply id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.2">superscript</csymbol><apply id="S3.SS1.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.2.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2.2">𝑊</ci><ci id="S3.SS1.p2.3.m3.1.1.2.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2.3">𝐾</ci></apply><ci id="S3.SS1.p2.3.m3.1.1.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.2.3">𝑁</ci></apply><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">W_{K}^{N}\in\mathbb{R}^{H_{l}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
The sentence embedding in the text space is projected into the vision-language space using a learnable linear projection matrix, <math alttext="\mathcal{P}_{l}\in\mathbb{R}^{H_{l}\times H_{vl}}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><msub id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m4.1.1.2.2" xref="S3.SS1.p2.4.m4.1.1.2.2.cmml">𝒫</mi><mi id="S3.SS1.p2.4.m4.1.1.2.3" xref="S3.SS1.p2.4.m4.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml"><msub id="S3.SS1.p2.4.m4.1.1.3.3.2" xref="S3.SS1.p2.4.m4.1.1.3.3.2.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.3.2.2" xref="S3.SS1.p2.4.m4.1.1.3.3.2.2.cmml">H</mi><mi id="S3.SS1.p2.4.m4.1.1.3.3.2.3" xref="S3.SS1.p2.4.m4.1.1.3.3.2.3.cmml">l</mi></msub><mo id="S3.SS1.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p2.4.m4.1.1.3.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.3.3.2" xref="S3.SS1.p2.4.m4.1.1.3.3.3.2.cmml">H</mi><mrow id="S3.SS1.p2.4.m4.1.1.3.3.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.3.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.3.3.3.2" xref="S3.SS1.p2.4.m4.1.1.3.3.3.3.2.cmml">v</mi><mo id="S3.SS1.p2.4.m4.1.1.3.3.3.3.1" xref="S3.SS1.p2.4.m4.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.4.m4.1.1.3.3.3.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.3.3.3.cmml">l</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><in id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"></in><apply id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2.2">𝒫</ci><ci id="S3.SS1.p2.4.m4.1.1.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.2.3">𝑙</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3"><times id="S3.SS1.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.1"></times><apply id="S3.SS1.p2.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.2.2">𝐻</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.2.3">𝑙</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.3.2">𝐻</ci><apply id="S3.SS1.p2.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.3.3"><times id="S3.SS1.p2.4.m4.1.1.3.3.3.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.3.3.1"></times><ci id="S3.SS1.p2.4.m4.1.1.3.3.3.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.3.3.2">𝑣</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.3.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\mathcal{P}_{l}\in\mathbb{R}^{H_{l}\times H_{vl}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">caligraphic_P start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT × italic_H start_POSTSUBSCRIPT italic_v italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
Mathematically,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z_{l}=\mathcal{P}_{l}^{T}W_{K}^{N}\qquad\qquad z_{l}\in\mathbb{R}^{H_{vl}}" class="ltx_Math" display="block" id="S3.E2.m1.2"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.3.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E2.m1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.2.3.cmml">l</mi></msub><mo id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><msubsup id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.3.2.2.2" xref="S3.E2.m1.1.1.1.1.3.2.2.2.cmml">𝒫</mi><mi id="S3.E2.m1.1.1.1.1.3.2.2.3" xref="S3.E2.m1.1.1.1.1.3.2.2.3.cmml">l</mi><mi id="S3.E2.m1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.3.2.3.cmml">T</mi></msubsup><mo id="S3.E2.m1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.2.2" xref="S3.E2.m1.1.1.1.1.3.3.2.2.cmml">W</mi><mi id="S3.E2.m1.1.1.1.1.3.3.2.3" xref="S3.E2.m1.1.1.1.1.3.3.2.3.cmml">K</mi><mi id="S3.E2.m1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.3.3.3.cmml">N</mi></msubsup></mrow></mrow><mspace id="S3.E2.m1.2.2.2.3" width="4em" xref="S3.E2.m1.2.2.3a.cmml"></mspace><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml"><msub id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.3.cmml">l</mi></msub><mo id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.1.cmml">∈</mo><msup id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml"><mi id="S3.E2.m1.2.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.3.2.cmml">ℝ</mi><msub id="S3.E2.m1.2.2.2.2.3.3" xref="S3.E2.m1.2.2.2.2.3.3.cmml"><mi id="S3.E2.m1.2.2.2.2.3.3.2" xref="S3.E2.m1.2.2.2.2.3.3.2.cmml">H</mi><mrow id="S3.E2.m1.2.2.2.2.3.3.3" xref="S3.E2.m1.2.2.2.2.3.3.3.cmml"><mi id="S3.E2.m1.2.2.2.2.3.3.3.2" xref="S3.E2.m1.2.2.2.2.3.3.3.2.cmml">v</mi><mo id="S3.E2.m1.2.2.2.2.3.3.3.1" xref="S3.E2.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.2.2.3.3.3.3" xref="S3.E2.m1.2.2.2.2.3.3.3.3.cmml">l</mi></mrow></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.3a.cmml" xref="S3.E2.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"></eq><apply id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2">𝑧</ci><ci id="S3.E2.m1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><times id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.1"></times><apply id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2.2">𝒫</ci><ci id="S3.E2.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2.3">𝑙</ci></apply><ci id="S3.E2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3">𝑇</ci></apply><apply id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.2">𝑊</ci><ci id="S3.E2.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.3">𝐾</ci></apply><ci id="S3.E2.m1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.3">𝑁</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><in id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1"></in><apply id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2">𝑧</ci><ci id="S3.E2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3">𝑙</ci></apply><apply id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.3">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.3.2">ℝ</ci><apply id="S3.E2.m1.2.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.3.3.2.cmml" xref="S3.E2.m1.2.2.2.2.3.3.2">𝐻</ci><apply id="S3.E2.m1.2.2.2.2.3.3.3.cmml" xref="S3.E2.m1.2.2.2.2.3.3.3"><times id="S3.E2.m1.2.2.2.2.3.3.3.1.cmml" xref="S3.E2.m1.2.2.2.2.3.3.3.1"></times><ci id="S3.E2.m1.2.2.2.2.3.3.3.2.cmml" xref="S3.E2.m1.2.2.2.2.3.3.3.2">𝑣</ci><ci id="S3.E2.m1.2.2.2.2.3.3.3.3.cmml" xref="S3.E2.m1.2.2.2.2.3.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">z_{l}=\mathcal{P}_{l}^{T}W_{K}^{N}\qquad\qquad z_{l}\in\mathbb{R}^{H_{vl}}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.2d">italic_z start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT = caligraphic_P start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_z start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT italic_v italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Image Encoding</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.5">CLIP’s image encoder splits the image into multiple patches of predefined sizes.
It projects them linearly to obtain token embeddings and adds the position encoding to them before passing to the first ViT layer, <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.5.1">i.e</em>.<span class="ltx_text" id="S3.SS2.p1.5.2"></span>, <math alttext="E_{0}=[e_{0}^{1},e_{0}^{2},\cdots,e_{0}^{N}]\in\mathbb{R}^{N\times H_{v}}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.4"><semantics id="S3.SS2.p1.1.m1.4a"><mrow id="S3.SS2.p1.1.m1.4.4" xref="S3.SS2.p1.1.m1.4.4.cmml"><msub id="S3.SS2.p1.1.m1.4.4.5" xref="S3.SS2.p1.1.m1.4.4.5.cmml"><mi id="S3.SS2.p1.1.m1.4.4.5.2" xref="S3.SS2.p1.1.m1.4.4.5.2.cmml">E</mi><mn id="S3.SS2.p1.1.m1.4.4.5.3" xref="S3.SS2.p1.1.m1.4.4.5.3.cmml">0</mn></msub><mo id="S3.SS2.p1.1.m1.4.4.6" xref="S3.SS2.p1.1.m1.4.4.6.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.4.4.3.3" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml"><mo id="S3.SS2.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">[</mo><msubsup id="S3.SS2.p1.1.m1.2.2.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.2.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.cmml">e</mi><mn id="S3.SS2.p1.1.m1.2.2.1.1.1.2.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.3.cmml">0</mn><mn id="S3.SS2.p1.1.m1.2.2.1.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS2.p1.1.m1.4.4.3.3.5" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.p1.1.m1.3.3.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.3.3.2.2.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.2.cmml">e</mi><mn id="S3.SS2.p1.1.m1.3.3.2.2.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.3.cmml">0</mn><mn id="S3.SS2.p1.1.m1.3.3.2.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS2.p1.1.m1.4.4.3.3.6" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS2.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS2.p1.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS2.p1.1.m1.4.4.3.3.7" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S3.SS2.p1.1.m1.4.4.3.3.3" xref="S3.SS2.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.1.m1.4.4.3.3.3.2.2" xref="S3.SS2.p1.1.m1.4.4.3.3.3.2.2.cmml">e</mi><mn id="S3.SS2.p1.1.m1.4.4.3.3.3.2.3" xref="S3.SS2.p1.1.m1.4.4.3.3.3.2.3.cmml">0</mn><mi id="S3.SS2.p1.1.m1.4.4.3.3.3.3" xref="S3.SS2.p1.1.m1.4.4.3.3.3.3.cmml">N</mi></msubsup><mo id="S3.SS2.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">]</mo></mrow><mo id="S3.SS2.p1.1.m1.4.4.7" xref="S3.SS2.p1.1.m1.4.4.7.cmml">∈</mo><msup id="S3.SS2.p1.1.m1.4.4.8" xref="S3.SS2.p1.1.m1.4.4.8.cmml"><mi id="S3.SS2.p1.1.m1.4.4.8.2" xref="S3.SS2.p1.1.m1.4.4.8.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.1.m1.4.4.8.3" xref="S3.SS2.p1.1.m1.4.4.8.3.cmml"><mi id="S3.SS2.p1.1.m1.4.4.8.3.2" xref="S3.SS2.p1.1.m1.4.4.8.3.2.cmml">N</mi><mo id="S3.SS2.p1.1.m1.4.4.8.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.1.m1.4.4.8.3.1.cmml">×</mo><msub id="S3.SS2.p1.1.m1.4.4.8.3.3" xref="S3.SS2.p1.1.m1.4.4.8.3.3.cmml"><mi id="S3.SS2.p1.1.m1.4.4.8.3.3.2" xref="S3.SS2.p1.1.m1.4.4.8.3.3.2.cmml">H</mi><mi id="S3.SS2.p1.1.m1.4.4.8.3.3.3" xref="S3.SS2.p1.1.m1.4.4.8.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.4b"><apply id="S3.SS2.p1.1.m1.4.4.cmml" xref="S3.SS2.p1.1.m1.4.4"><and id="S3.SS2.p1.1.m1.4.4a.cmml" xref="S3.SS2.p1.1.m1.4.4"></and><apply id="S3.SS2.p1.1.m1.4.4b.cmml" xref="S3.SS2.p1.1.m1.4.4"><eq id="S3.SS2.p1.1.m1.4.4.6.cmml" xref="S3.SS2.p1.1.m1.4.4.6"></eq><apply id="S3.SS2.p1.1.m1.4.4.5.cmml" xref="S3.SS2.p1.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.4.5.1.cmml" xref="S3.SS2.p1.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS2.p1.1.m1.4.4.5.2.cmml" xref="S3.SS2.p1.1.m1.4.4.5.2">𝐸</ci><cn id="S3.SS2.p1.1.m1.4.4.5.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.4.4.5.3">0</cn></apply><list id="S3.SS2.p1.1.m1.4.4.3.4.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3"><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.2">𝑒</ci><cn id="S3.SS2.p1.1.m1.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.3">0</cn></apply><cn id="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.2">𝑒</ci><cn id="S3.SS2.p1.1.m1.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.3">0</cn></apply><cn id="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">⋯</ci><apply id="S3.SS2.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3">superscript</csymbol><apply id="S3.SS2.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.4.3.3.3.2.1.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.4.4.3.3.3.2.2.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3.2.2">𝑒</ci><cn id="S3.SS2.p1.1.m1.4.4.3.3.3.2.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.4.4.3.3.3.2.3">0</cn></apply><ci id="S3.SS2.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3.3">𝑁</ci></apply></list></apply><apply id="S3.SS2.p1.1.m1.4.4c.cmml" xref="S3.SS2.p1.1.m1.4.4"><in id="S3.SS2.p1.1.m1.4.4.7.cmml" xref="S3.SS2.p1.1.m1.4.4.7"></in><share href="https://arxiv.org/html/2410.05239v2#S3.SS2.p1.1.m1.4.4.3.cmml" id="S3.SS2.p1.1.m1.4.4d.cmml" xref="S3.SS2.p1.1.m1.4.4"></share><apply id="S3.SS2.p1.1.m1.4.4.8.cmml" xref="S3.SS2.p1.1.m1.4.4.8"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.4.8.1.cmml" xref="S3.SS2.p1.1.m1.4.4.8">superscript</csymbol><ci id="S3.SS2.p1.1.m1.4.4.8.2.cmml" xref="S3.SS2.p1.1.m1.4.4.8.2">ℝ</ci><apply id="S3.SS2.p1.1.m1.4.4.8.3.cmml" xref="S3.SS2.p1.1.m1.4.4.8.3"><times id="S3.SS2.p1.1.m1.4.4.8.3.1.cmml" xref="S3.SS2.p1.1.m1.4.4.8.3.1"></times><ci id="S3.SS2.p1.1.m1.4.4.8.3.2.cmml" xref="S3.SS2.p1.1.m1.4.4.8.3.2">𝑁</ci><apply id="S3.SS2.p1.1.m1.4.4.8.3.3.cmml" xref="S3.SS2.p1.1.m1.4.4.8.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.4.8.3.3.1.cmml" xref="S3.SS2.p1.1.m1.4.4.8.3.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.4.4.8.3.3.2.cmml" xref="S3.SS2.p1.1.m1.4.4.8.3.3.2">𝐻</ci><ci id="S3.SS2.p1.1.m1.4.4.8.3.3.3.cmml" xref="S3.SS2.p1.1.m1.4.4.8.3.3.3">𝑣</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.4c">E_{0}=[e_{0}^{1},e_{0}^{2},\cdots,e_{0}^{N}]\in\mathbb{R}^{N\times H_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.4d">italic_E start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = [ italic_e start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_e start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , ⋯ , italic_e start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_H start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
Additionally, a class (CLS) token embedding (<math alttext="c_{i}\in\mathbb{R}^{H_{v}}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">c</mi><mi id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.3.2" xref="S3.SS2.p1.2.m2.1.1.3.3.2.cmml">H</mi><mi id="S3.SS2.p1.2.m2.1.1.3.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.3.cmml">v</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><in id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></in><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">𝑐</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.2">𝐻</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.3">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">c_{i}\in\mathbb{R}^{H_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>) is concatenated to the token embedding (<math alttext="E_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">E</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝐸</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">E_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>) before passing to the transformer layer <math alttext="\mathcal{V}_{i+1}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">𝒱</mi><mrow id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.4.m4.1.1.3.1" xref="S3.SS2.p1.4.m4.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝒱</ci><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><plus id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.1"></plus><ci id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2">𝑖</ci><cn id="S3.SS2.p1.4.m4.1.1.3.3.cmml" type="integer" xref="S3.SS2.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\mathcal{V}_{i+1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">caligraphic_V start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT</annotation></semantics></math>, outputting <math alttext="[c_{i+1},E_{i+1}]" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.2"><semantics id="S3.SS2.p1.5.m5.2a"><mrow id="S3.SS2.p1.5.m5.2.2.2" xref="S3.SS2.p1.5.m5.2.2.3.cmml"><mo id="S3.SS2.p1.5.m5.2.2.2.3" stretchy="false" xref="S3.SS2.p1.5.m5.2.2.3.cmml">[</mo><msub id="S3.SS2.p1.5.m5.1.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.1.1.2" xref="S3.SS2.p1.5.m5.1.1.1.1.2.cmml">c</mi><mrow id="S3.SS2.p1.5.m5.1.1.1.1.3" xref="S3.SS2.p1.5.m5.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.5.m5.1.1.1.1.3.1" xref="S3.SS2.p1.5.m5.1.1.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p1.5.m5.1.1.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS2.p1.5.m5.2.2.2.4" xref="S3.SS2.p1.5.m5.2.2.3.cmml">,</mo><msub id="S3.SS2.p1.5.m5.2.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.2.cmml"><mi id="S3.SS2.p1.5.m5.2.2.2.2.2" xref="S3.SS2.p1.5.m5.2.2.2.2.2.cmml">E</mi><mrow id="S3.SS2.p1.5.m5.2.2.2.2.3" xref="S3.SS2.p1.5.m5.2.2.2.2.3.cmml"><mi id="S3.SS2.p1.5.m5.2.2.2.2.3.2" xref="S3.SS2.p1.5.m5.2.2.2.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.5.m5.2.2.2.2.3.1" xref="S3.SS2.p1.5.m5.2.2.2.2.3.1.cmml">+</mo><mn id="S3.SS2.p1.5.m5.2.2.2.2.3.3" xref="S3.SS2.p1.5.m5.2.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS2.p1.5.m5.2.2.2.5" stretchy="false" xref="S3.SS2.p1.5.m5.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.2b"><interval closure="closed" id="S3.SS2.p1.5.m5.2.2.3.cmml" xref="S3.SS2.p1.5.m5.2.2.2"><apply id="S3.SS2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.2">𝑐</ci><apply id="S3.SS2.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.3"><plus id="S3.SS2.p1.5.m5.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.3.1"></plus><ci id="S3.SS2.p1.5.m5.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS2.p1.5.m5.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.p1.5.m5.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS2.p1.5.m5.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.2.2.2.2.1.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.2">𝐸</ci><apply id="S3.SS2.p1.5.m5.2.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.3"><plus id="S3.SS2.p1.5.m5.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.3.1"></plus><ci id="S3.SS2.p1.5.m5.2.2.2.2.3.2.cmml" xref="S3.SS2.p1.5.m5.2.2.2.2.3.2">𝑖</ci><cn id="S3.SS2.p1.5.m5.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS2.p1.5.m5.2.2.2.2.3.3">1</cn></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.2c">[c_{i+1},E_{i+1}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.2d">[ italic_c start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ]</annotation></semantics></math>.
Mathematically,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[c_{i+1},E_{i+1}]=\mathcal{V}_{i+1}([c_{i},E_{i}])\qquad\qquad i=0,1,\cdots,K_%
{v}-1" class="ltx_Math" display="block" id="S3.E3.m1.5"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5.2" xref="S3.E3.m1.5.5.3.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1.2.2" xref="S3.E3.m1.4.4.1.1.2.3.cmml"><mo id="S3.E3.m1.4.4.1.1.2.2.3" stretchy="false" xref="S3.E3.m1.4.4.1.1.2.3.cmml">[</mo><msub id="S3.E3.m1.4.4.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.2.cmml">c</mi><mrow id="S3.E3.m1.4.4.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.1.3.2" xref="S3.E3.m1.4.4.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E3.m1.4.4.1.1.1.1.1.3.1" xref="S3.E3.m1.4.4.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E3.m1.4.4.1.1.1.1.1.3.3" xref="S3.E3.m1.4.4.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E3.m1.4.4.1.1.2.2.4" xref="S3.E3.m1.4.4.1.1.2.3.cmml">,</mo><msub id="S3.E3.m1.4.4.1.1.2.2.2" xref="S3.E3.m1.4.4.1.1.2.2.2.cmml"><mi id="S3.E3.m1.4.4.1.1.2.2.2.2" xref="S3.E3.m1.4.4.1.1.2.2.2.2.cmml">E</mi><mrow id="S3.E3.m1.4.4.1.1.2.2.2.3" xref="S3.E3.m1.4.4.1.1.2.2.2.3.cmml"><mi id="S3.E3.m1.4.4.1.1.2.2.2.3.2" xref="S3.E3.m1.4.4.1.1.2.2.2.3.2.cmml">i</mi><mo id="S3.E3.m1.4.4.1.1.2.2.2.3.1" xref="S3.E3.m1.4.4.1.1.2.2.2.3.1.cmml">+</mo><mn id="S3.E3.m1.4.4.1.1.2.2.2.3.3" xref="S3.E3.m1.4.4.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E3.m1.4.4.1.1.2.2.5" stretchy="false" xref="S3.E3.m1.4.4.1.1.2.3.cmml">]</mo></mrow><mo id="S3.E3.m1.4.4.1.1.4" xref="S3.E3.m1.4.4.1.1.4.cmml">=</mo><mrow id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml"><msub id="S3.E3.m1.4.4.1.1.3.3" xref="S3.E3.m1.4.4.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.1.1.3.3.2" xref="S3.E3.m1.4.4.1.1.3.3.2.cmml">𝒱</mi><mrow id="S3.E3.m1.4.4.1.1.3.3.3" xref="S3.E3.m1.4.4.1.1.3.3.3.cmml"><mi id="S3.E3.m1.4.4.1.1.3.3.3.2" xref="S3.E3.m1.4.4.1.1.3.3.3.2.cmml">i</mi><mo id="S3.E3.m1.4.4.1.1.3.3.3.1" xref="S3.E3.m1.4.4.1.1.3.3.3.1.cmml">+</mo><mn id="S3.E3.m1.4.4.1.1.3.3.3.3" xref="S3.E3.m1.4.4.1.1.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E3.m1.4.4.1.1.3.2" xref="S3.E3.m1.4.4.1.1.3.2.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.1.1.3.1.1" xref="S3.E3.m1.4.4.1.1.3.cmml"><mo id="S3.E3.m1.4.4.1.1.3.1.1.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.cmml">(</mo><mrow id="S3.E3.m1.4.4.1.1.3.1.1.1.2" xref="S3.E3.m1.4.4.1.1.3.1.1.1.3.cmml"><mo id="S3.E3.m1.4.4.1.1.3.1.1.1.2.3" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.1.1.1.3.cmml">[</mo><msub id="S3.E3.m1.4.4.1.1.3.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.3.1.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.3.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.3.1.1.1.1.1.2.cmml">c</mi><mi id="S3.E3.m1.4.4.1.1.3.1.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3.m1.4.4.1.1.3.1.1.1.2.4" xref="S3.E3.m1.4.4.1.1.3.1.1.1.3.cmml">,</mo><msub id="S3.E3.m1.4.4.1.1.3.1.1.1.2.2" xref="S3.E3.m1.4.4.1.1.3.1.1.1.2.2.cmml"><mi id="S3.E3.m1.4.4.1.1.3.1.1.1.2.2.2" xref="S3.E3.m1.4.4.1.1.3.1.1.1.2.2.2.cmml">E</mi><mi id="S3.E3.m1.4.4.1.1.3.1.1.1.2.2.3" xref="S3.E3.m1.4.4.1.1.3.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.E3.m1.4.4.1.1.3.1.1.1.2.5" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.1.1.1.3.cmml">]</mo></mrow><mo id="S3.E3.m1.4.4.1.1.3.1.1.3" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow></mrow><mspace id="S3.E3.m1.5.5.2.3" width="4em" xref="S3.E3.m1.5.5.3a.cmml"></mspace><mrow id="S3.E3.m1.5.5.2.2" xref="S3.E3.m1.5.5.2.2.cmml"><mi id="S3.E3.m1.5.5.2.2.3" xref="S3.E3.m1.5.5.2.2.3.cmml">i</mi><mo id="S3.E3.m1.5.5.2.2.2" xref="S3.E3.m1.5.5.2.2.2.cmml">=</mo><mrow id="S3.E3.m1.5.5.2.2.1.1" xref="S3.E3.m1.5.5.2.2.1.2.cmml"><mn id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">0</mn><mo id="S3.E3.m1.5.5.2.2.1.1.2" xref="S3.E3.m1.5.5.2.2.1.2.cmml">,</mo><mn id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">1</mn><mo id="S3.E3.m1.5.5.2.2.1.1.3" xref="S3.E3.m1.5.5.2.2.1.2.cmml">,</mo><mi id="S3.E3.m1.3.3" mathvariant="normal" xref="S3.E3.m1.3.3.cmml">⋯</mi><mo id="S3.E3.m1.5.5.2.2.1.1.4" xref="S3.E3.m1.5.5.2.2.1.2.cmml">,</mo><mrow id="S3.E3.m1.5.5.2.2.1.1.1" xref="S3.E3.m1.5.5.2.2.1.1.1.cmml"><msub id="S3.E3.m1.5.5.2.2.1.1.1.2" xref="S3.E3.m1.5.5.2.2.1.1.1.2.cmml"><mi id="S3.E3.m1.5.5.2.2.1.1.1.2.2" xref="S3.E3.m1.5.5.2.2.1.1.1.2.2.cmml">K</mi><mi id="S3.E3.m1.5.5.2.2.1.1.1.2.3" xref="S3.E3.m1.5.5.2.2.1.1.1.2.3.cmml">v</mi></msub><mo id="S3.E3.m1.5.5.2.2.1.1.1.1" xref="S3.E3.m1.5.5.2.2.1.1.1.1.cmml">−</mo><mn id="S3.E3.m1.5.5.2.2.1.1.1.3" xref="S3.E3.m1.5.5.2.2.1.1.1.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.3.cmml" xref="S3.E3.m1.5.5.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.3a.cmml" xref="S3.E3.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1.1"><eq id="S3.E3.m1.4.4.1.1.4.cmml" xref="S3.E3.m1.4.4.1.1.4"></eq><interval closure="closed" id="S3.E3.m1.4.4.1.1.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.2"><apply id="S3.E3.m1.4.4.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.2">𝑐</ci><apply id="S3.E3.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.3"><plus id="S3.E3.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.3.1"></plus><ci id="S3.E3.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.E3.m1.4.4.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E3.m1.4.4.1.1.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.2.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.2">𝐸</ci><apply id="S3.E3.m1.4.4.1.1.2.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.3"><plus id="S3.E3.m1.4.4.1.1.2.2.2.3.1.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.3.1"></plus><ci id="S3.E3.m1.4.4.1.1.2.2.2.3.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2.2.3.2">𝑖</ci><cn id="S3.E3.m1.4.4.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.2.2.2.3.3">1</cn></apply></apply></interval><apply id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3"><times id="S3.E3.m1.4.4.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2"></times><apply id="S3.E3.m1.4.4.1.1.3.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.3.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.2">𝒱</ci><apply id="S3.E3.m1.4.4.1.1.3.3.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3"><plus id="S3.E3.m1.4.4.1.1.3.3.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.1"></plus><ci id="S3.E3.m1.4.4.1.1.3.3.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2">𝑖</ci><cn id="S3.E3.m1.4.4.1.1.3.3.3.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.3.3.3.3">1</cn></apply></apply><interval closure="closed" id="S3.E3.m1.4.4.1.1.3.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3.1.1.1.2"><apply id="S3.E3.m1.4.4.1.1.3.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.3.1.1.1.1.1.2">𝑐</ci><ci id="S3.E3.m1.4.4.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.4.4.1.1.3.1.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.1.1.1.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.1.1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.3.1.1.1.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.1.1.1.2.2.2">𝐸</ci><ci id="S3.E3.m1.4.4.1.1.3.1.1.1.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.3.1.1.1.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S3.E3.m1.5.5.2.2.cmml" xref="S3.E3.m1.5.5.2.2"><eq id="S3.E3.m1.5.5.2.2.2.cmml" xref="S3.E3.m1.5.5.2.2.2"></eq><ci id="S3.E3.m1.5.5.2.2.3.cmml" xref="S3.E3.m1.5.5.2.2.3">𝑖</ci><list id="S3.E3.m1.5.5.2.2.1.2.cmml" xref="S3.E3.m1.5.5.2.2.1.1"><cn id="S3.E3.m1.1.1.cmml" type="integer" xref="S3.E3.m1.1.1">0</cn><cn id="S3.E3.m1.2.2.cmml" type="integer" xref="S3.E3.m1.2.2">1</cn><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">⋯</ci><apply id="S3.E3.m1.5.5.2.2.1.1.1.cmml" xref="S3.E3.m1.5.5.2.2.1.1.1"><minus id="S3.E3.m1.5.5.2.2.1.1.1.1.cmml" xref="S3.E3.m1.5.5.2.2.1.1.1.1"></minus><apply id="S3.E3.m1.5.5.2.2.1.1.1.2.cmml" xref="S3.E3.m1.5.5.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.2.2.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.2.2.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.5.5.2.2.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.2.2.1.1.1.2.2">𝐾</ci><ci id="S3.E3.m1.5.5.2.2.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.2.2.1.1.1.2.3">𝑣</ci></apply><cn id="S3.E3.m1.5.5.2.2.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.5.5.2.2.1.1.1.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">[c_{i+1},E_{i+1}]=\mathcal{V}_{i+1}([c_{i},E_{i}])\qquad\qquad i=0,1,\cdots,K_%
{v}-1</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.5d">[ italic_c start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ] = caligraphic_V start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ( [ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) italic_i = 0 , 1 , ⋯ , italic_K start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT - 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.3">Here, <math alttext="K_{v}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">K</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐾</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">K_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_K start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> denotes the number of transformer layers for the image encoder.
The class (CLS) embedding from the last layer (<math alttext="c_{K}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">c</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝑐</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">c_{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_c start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT</annotation></semantics></math>) corresponds to the global embedding (or image-level embedding), which is in the image space.
The embedding is projected into the vision-language space using a learnable linear projection matrix, <math alttext="\mathcal{P}_{v}\in\mathbb{R}^{H_{t}\times H_{vl}}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><msub id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.3.m3.1.1.2.2" xref="S3.SS2.p2.3.m3.1.1.2.2.cmml">𝒫</mi><mi id="S3.SS2.p2.3.m3.1.1.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.cmml">v</mi></msub><mo id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.3.m3.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.cmml"><msub id="S3.SS2.p2.3.m3.1.1.3.3.2" xref="S3.SS2.p2.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.3.2.2" xref="S3.SS2.p2.3.m3.1.1.3.3.2.2.cmml">H</mi><mi id="S3.SS2.p2.3.m3.1.1.3.3.2.3" xref="S3.SS2.p2.3.m3.1.1.3.3.2.3.cmml">t</mi></msub><mo id="S3.SS2.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p2.3.m3.1.1.3.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.3.3.2" xref="S3.SS2.p2.3.m3.1.1.3.3.3.2.cmml">H</mi><mrow id="S3.SS2.p2.3.m3.1.1.3.3.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.3.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.3.3.3.2" xref="S3.SS2.p2.3.m3.1.1.3.3.3.3.2.cmml">v</mi><mo id="S3.SS2.p2.3.m3.1.1.3.3.3.3.1" xref="S3.SS2.p2.3.m3.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.3.m3.1.1.3.3.3.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.3.3.3.cmml">l</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><in id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"></in><apply id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2">𝒫</ci><ci id="S3.SS2.p2.3.m3.1.1.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3">𝑣</ci></apply><apply id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3"><times id="S3.SS2.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.1"></times><apply id="S3.SS2.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.2.2">𝐻</ci><ci id="S3.SS2.p2.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.2.3">𝑡</ci></apply><apply id="S3.SS2.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.3.2">𝐻</ci><apply id="S3.SS2.p2.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.3.3"><times id="S3.SS2.p2.3.m3.1.1.3.3.3.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.3.3.1"></times><ci id="S3.SS2.p2.3.m3.1.1.3.3.3.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.3.3.2">𝑣</ci><ci id="S3.SS2.p2.3.m3.1.1.3.3.3.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\mathcal{P}_{v}\in\mathbb{R}^{H_{t}\times H_{vl}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">caligraphic_P start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT × italic_H start_POSTSUBSCRIPT italic_v italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
Mathematically,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z_{v}=\mathcal{P}_{v}^{T}c_{K}\qquad\qquad z_{v}\in\mathbb{R}^{H_{vl}}" class="ltx_Math" display="block" id="S3.E4.m1.2"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.3.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E4.m1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.3.cmml">v</mi></msub><mo id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><msubsup id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.3.2.2.2" xref="S3.E4.m1.1.1.1.1.3.2.2.2.cmml">𝒫</mi><mi id="S3.E4.m1.1.1.1.1.3.2.2.3" xref="S3.E4.m1.1.1.1.1.3.2.2.3.cmml">v</mi><mi id="S3.E4.m1.1.1.1.1.3.2.3" xref="S3.E4.m1.1.1.1.1.3.2.3.cmml">T</mi></msubsup><mo id="S3.E4.m1.1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.3.3.2.cmml">c</mi><mi id="S3.E4.m1.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.3.3.3.cmml">K</mi></msub></mrow></mrow><mspace id="S3.E4.m1.2.2.2.3" width="4em" xref="S3.E4.m1.2.2.3a.cmml"></mspace><mrow id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml"><msub id="S3.E4.m1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E4.m1.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.3.cmml">v</mi></msub><mo id="S3.E4.m1.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.1.cmml">∈</mo><msup id="S3.E4.m1.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.3.cmml"><mi id="S3.E4.m1.2.2.2.2.3.2" xref="S3.E4.m1.2.2.2.2.3.2.cmml">ℝ</mi><msub id="S3.E4.m1.2.2.2.2.3.3" xref="S3.E4.m1.2.2.2.2.3.3.cmml"><mi id="S3.E4.m1.2.2.2.2.3.3.2" xref="S3.E4.m1.2.2.2.2.3.3.2.cmml">H</mi><mrow id="S3.E4.m1.2.2.2.2.3.3.3" xref="S3.E4.m1.2.2.2.2.3.3.3.cmml"><mi id="S3.E4.m1.2.2.2.2.3.3.3.2" xref="S3.E4.m1.2.2.2.2.3.3.3.2.cmml">v</mi><mo id="S3.E4.m1.2.2.2.2.3.3.3.1" xref="S3.E4.m1.2.2.2.2.3.3.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.2.2.3.3.3.3" xref="S3.E4.m1.2.2.2.2.3.3.3.3.cmml">l</mi></mrow></msub></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.3.cmml" xref="S3.E4.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.3a.cmml" xref="S3.E4.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"></eq><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2">𝑧</ci><ci id="S3.E4.m1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.3">𝑣</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><times id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1"></times><apply id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2.2">𝒫</ci><ci id="S3.E4.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2.3">𝑣</ci></apply><ci id="S3.E4.m1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3">𝑇</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.3.2">𝑐</ci><ci id="S3.E4.m1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3.3">𝐾</ci></apply></apply></apply><apply id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2"><in id="S3.E4.m1.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.1"></in><apply id="S3.E4.m1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2">𝑧</ci><ci id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.3">𝑣</ci></apply><apply id="S3.E4.m1.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.3.1.cmml" xref="S3.E4.m1.2.2.2.2.3">superscript</csymbol><ci id="S3.E4.m1.2.2.2.2.3.2.cmml" xref="S3.E4.m1.2.2.2.2.3.2">ℝ</ci><apply id="S3.E4.m1.2.2.2.2.3.3.cmml" xref="S3.E4.m1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.3.3.1.cmml" xref="S3.E4.m1.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.3.3.2.cmml" xref="S3.E4.m1.2.2.2.2.3.3.2">𝐻</ci><apply id="S3.E4.m1.2.2.2.2.3.3.3.cmml" xref="S3.E4.m1.2.2.2.2.3.3.3"><times id="S3.E4.m1.2.2.2.2.3.3.3.1.cmml" xref="S3.E4.m1.2.2.2.2.3.3.3.1"></times><ci id="S3.E4.m1.2.2.2.2.3.3.3.2.cmml" xref="S3.E4.m1.2.2.2.2.3.3.3.2">𝑣</ci><ci id="S3.E4.m1.2.2.2.2.3.3.3.3.cmml" xref="S3.E4.m1.2.2.2.2.3.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">z_{v}=\mathcal{P}_{v}^{T}c_{K}\qquad\qquad z_{v}\in\mathbb{R}^{H_{vl}}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.2d">italic_z start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT = caligraphic_P start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_H start_POSTSUBSCRIPT italic_v italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Revisiting Prompt Tuning</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Textual Prompt Tuning</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.4">To learn language-specific prompts, we assign <math alttext="B" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_B</annotation></semantics></math> learnable tokens to the first transformer layer for CLIP’s text encoder, as <math alttext="P_{0}=[p_{0}^{1},p_{0}^{2},\cdots,p_{0}^{B}]\in\mathbb{R}^{B\times H_{l}}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.4"><semantics id="S4.SS1.p1.2.m2.4a"><mrow id="S4.SS1.p1.2.m2.4.4" xref="S4.SS1.p1.2.m2.4.4.cmml"><msub id="S4.SS1.p1.2.m2.4.4.5" xref="S4.SS1.p1.2.m2.4.4.5.cmml"><mi id="S4.SS1.p1.2.m2.4.4.5.2" xref="S4.SS1.p1.2.m2.4.4.5.2.cmml">P</mi><mn id="S4.SS1.p1.2.m2.4.4.5.3" xref="S4.SS1.p1.2.m2.4.4.5.3.cmml">0</mn></msub><mo id="S4.SS1.p1.2.m2.4.4.6" xref="S4.SS1.p1.2.m2.4.4.6.cmml">=</mo><mrow id="S4.SS1.p1.2.m2.4.4.3.3" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml"><mo id="S4.SS1.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml">[</mo><msubsup id="S4.SS1.p1.2.m2.2.2.1.1.1" xref="S4.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.2.m2.2.2.1.1.1.2.2" xref="S4.SS1.p1.2.m2.2.2.1.1.1.2.2.cmml">p</mi><mn id="S4.SS1.p1.2.m2.2.2.1.1.1.2.3" xref="S4.SS1.p1.2.m2.2.2.1.1.1.2.3.cmml">0</mn><mn id="S4.SS1.p1.2.m2.2.2.1.1.1.3" xref="S4.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S4.SS1.p1.2.m2.4.4.3.3.5" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msubsup id="S4.SS1.p1.2.m2.3.3.2.2.2" xref="S4.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S4.SS1.p1.2.m2.3.3.2.2.2.2.2" xref="S4.SS1.p1.2.m2.3.3.2.2.2.2.2.cmml">p</mi><mn id="S4.SS1.p1.2.m2.3.3.2.2.2.2.3" xref="S4.SS1.p1.2.m2.3.3.2.2.2.2.3.cmml">0</mn><mn id="S4.SS1.p1.2.m2.3.3.2.2.2.3" xref="S4.SS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S4.SS1.p1.2.m2.4.4.3.3.6" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S4.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S4.SS1.p1.2.m2.1.1.cmml">⋯</mi><mo id="S4.SS1.p1.2.m2.4.4.3.3.7" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msubsup id="S4.SS1.p1.2.m2.4.4.3.3.3" xref="S4.SS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S4.SS1.p1.2.m2.4.4.3.3.3.2.2" xref="S4.SS1.p1.2.m2.4.4.3.3.3.2.2.cmml">p</mi><mn id="S4.SS1.p1.2.m2.4.4.3.3.3.2.3" xref="S4.SS1.p1.2.m2.4.4.3.3.3.2.3.cmml">0</mn><mi id="S4.SS1.p1.2.m2.4.4.3.3.3.3" xref="S4.SS1.p1.2.m2.4.4.3.3.3.3.cmml">B</mi></msubsup><mo id="S4.SS1.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S4.SS1.p1.2.m2.4.4.3.4.cmml">]</mo></mrow><mo id="S4.SS1.p1.2.m2.4.4.7" xref="S4.SS1.p1.2.m2.4.4.7.cmml">∈</mo><msup id="S4.SS1.p1.2.m2.4.4.8" xref="S4.SS1.p1.2.m2.4.4.8.cmml"><mi id="S4.SS1.p1.2.m2.4.4.8.2" xref="S4.SS1.p1.2.m2.4.4.8.2.cmml">ℝ</mi><mrow id="S4.SS1.p1.2.m2.4.4.8.3" xref="S4.SS1.p1.2.m2.4.4.8.3.cmml"><mi id="S4.SS1.p1.2.m2.4.4.8.3.2" xref="S4.SS1.p1.2.m2.4.4.8.3.2.cmml">B</mi><mo id="S4.SS1.p1.2.m2.4.4.8.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.2.m2.4.4.8.3.1.cmml">×</mo><msub id="S4.SS1.p1.2.m2.4.4.8.3.3" xref="S4.SS1.p1.2.m2.4.4.8.3.3.cmml"><mi id="S4.SS1.p1.2.m2.4.4.8.3.3.2" xref="S4.SS1.p1.2.m2.4.4.8.3.3.2.cmml">H</mi><mi id="S4.SS1.p1.2.m2.4.4.8.3.3.3" xref="S4.SS1.p1.2.m2.4.4.8.3.3.3.cmml">l</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.4b"><apply id="S4.SS1.p1.2.m2.4.4.cmml" xref="S4.SS1.p1.2.m2.4.4"><and id="S4.SS1.p1.2.m2.4.4a.cmml" xref="S4.SS1.p1.2.m2.4.4"></and><apply id="S4.SS1.p1.2.m2.4.4b.cmml" xref="S4.SS1.p1.2.m2.4.4"><eq id="S4.SS1.p1.2.m2.4.4.6.cmml" xref="S4.SS1.p1.2.m2.4.4.6"></eq><apply id="S4.SS1.p1.2.m2.4.4.5.cmml" xref="S4.SS1.p1.2.m2.4.4.5"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.4.4.5.1.cmml" xref="S4.SS1.p1.2.m2.4.4.5">subscript</csymbol><ci id="S4.SS1.p1.2.m2.4.4.5.2.cmml" xref="S4.SS1.p1.2.m2.4.4.5.2">𝑃</ci><cn id="S4.SS1.p1.2.m2.4.4.5.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.4.4.5.3">0</cn></apply><list id="S4.SS1.p1.2.m2.4.4.3.4.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3"><apply id="S4.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.2.2.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.2.2.1.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.2.2.1.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2.1.1.1.2.2">𝑝</ci><cn id="S4.SS1.p1.2.m2.2.2.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.2.2.1.1.1.2.3">0</cn></apply><cn id="S4.SS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S4.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS1.p1.2.m2.3.3.2.2.2">superscript</csymbol><apply id="S4.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.3.3.2.2.2.2.1.cmml" xref="S4.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.3.3.2.2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.3.3.2.2.2.2.2">𝑝</ci><cn id="S4.SS1.p1.2.m2.3.3.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.3.3.2.2.2.2.3">0</cn></apply><cn id="S4.SS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">⋯</ci><apply id="S4.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3.3">superscript</csymbol><apply id="S4.SS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.4.4.3.3.3.2.1.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.2.m2.4.4.3.3.3.2.2.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3.3.2.2">𝑝</ci><cn id="S4.SS1.p1.2.m2.4.4.3.3.3.2.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.4.4.3.3.3.2.3">0</cn></apply><ci id="S4.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S4.SS1.p1.2.m2.4.4.3.3.3.3">𝐵</ci></apply></list></apply><apply id="S4.SS1.p1.2.m2.4.4c.cmml" xref="S4.SS1.p1.2.m2.4.4"><in id="S4.SS1.p1.2.m2.4.4.7.cmml" xref="S4.SS1.p1.2.m2.4.4.7"></in><share href="https://arxiv.org/html/2410.05239v2#S4.SS1.p1.2.m2.4.4.3.cmml" id="S4.SS1.p1.2.m2.4.4d.cmml" xref="S4.SS1.p1.2.m2.4.4"></share><apply id="S4.SS1.p1.2.m2.4.4.8.cmml" xref="S4.SS1.p1.2.m2.4.4.8"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.4.4.8.1.cmml" xref="S4.SS1.p1.2.m2.4.4.8">superscript</csymbol><ci id="S4.SS1.p1.2.m2.4.4.8.2.cmml" xref="S4.SS1.p1.2.m2.4.4.8.2">ℝ</ci><apply id="S4.SS1.p1.2.m2.4.4.8.3.cmml" xref="S4.SS1.p1.2.m2.4.4.8.3"><times id="S4.SS1.p1.2.m2.4.4.8.3.1.cmml" xref="S4.SS1.p1.2.m2.4.4.8.3.1"></times><ci id="S4.SS1.p1.2.m2.4.4.8.3.2.cmml" xref="S4.SS1.p1.2.m2.4.4.8.3.2">𝐵</ci><apply id="S4.SS1.p1.2.m2.4.4.8.3.3.cmml" xref="S4.SS1.p1.2.m2.4.4.8.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.4.4.8.3.3.1.cmml" xref="S4.SS1.p1.2.m2.4.4.8.3.3">subscript</csymbol><ci id="S4.SS1.p1.2.m2.4.4.8.3.3.2.cmml" xref="S4.SS1.p1.2.m2.4.4.8.3.3.2">𝐻</ci><ci id="S4.SS1.p1.2.m2.4.4.8.3.3.3.cmml" xref="S4.SS1.p1.2.m2.4.4.8.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.4c">P_{0}=[p_{0}^{1},p_{0}^{2},\cdots,p_{0}^{B}]\in\mathbb{R}^{B\times H_{l}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.4d">italic_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = [ italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , ⋯ , italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
The input for the first transformer layer of the text branch is the concatenation of the learnable prompts and provided fixed text prompt, <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.4.1">i.e</em>.<span class="ltx_text" id="S4.SS1.p1.4.2"></span>, <math alttext="[P_{0},W_{0}]" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.2"><semantics id="S4.SS1.p1.3.m3.2a"><mrow id="S4.SS1.p1.3.m3.2.2.2" xref="S4.SS1.p1.3.m3.2.2.3.cmml"><mo id="S4.SS1.p1.3.m3.2.2.2.3" stretchy="false" xref="S4.SS1.p1.3.m3.2.2.3.cmml">[</mo><msub id="S4.SS1.p1.3.m3.1.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.1.1.2" xref="S4.SS1.p1.3.m3.1.1.1.1.2.cmml">P</mi><mn id="S4.SS1.p1.3.m3.1.1.1.1.3" xref="S4.SS1.p1.3.m3.1.1.1.1.3.cmml">0</mn></msub><mo id="S4.SS1.p1.3.m3.2.2.2.4" xref="S4.SS1.p1.3.m3.2.2.3.cmml">,</mo><msub id="S4.SS1.p1.3.m3.2.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.2.cmml"><mi id="S4.SS1.p1.3.m3.2.2.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.2.2.cmml">W</mi><mn id="S4.SS1.p1.3.m3.2.2.2.2.3" xref="S4.SS1.p1.3.m3.2.2.2.2.3.cmml">0</mn></msub><mo id="S4.SS1.p1.3.m3.2.2.2.5" stretchy="false" xref="S4.SS1.p1.3.m3.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.2b"><interval closure="closed" id="S4.SS1.p1.3.m3.2.2.3.cmml" xref="S4.SS1.p1.3.m3.2.2.2"><apply id="S4.SS1.p1.3.m3.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.2">𝑃</ci><cn id="S4.SS1.p1.3.m3.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.1.1.3">0</cn></apply><apply id="S4.SS1.p1.3.m3.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.2.2.2.1.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2">𝑊</ci><cn id="S4.SS1.p1.3.m3.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.2.2.2.2.3">0</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.2c">[P_{0},W_{0}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.2d">[ italic_P start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ]</annotation></semantics></math> (see <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S4.F2.sf1" title="In Figure 2 ‣ 4.3 Multimodal Prompt Tuning ‣ 4 Revisiting Prompt Tuning ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(a)</span></a>).
Also, these learnable prompts can be extended to multiple layers of the text encoder, such that <math alttext="J" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">J</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_J</annotation></semantics></math> is the network depth up to which new prompts are learned for each layer.
This deep prompting technique helps align the intermediate layers’ outputs with the first layer’s output.
Mathematically,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[\_,W_{i+1}]=\mathcal{L}_{i+1}([P_{i},W_{i}])\qquad\qquad i=0,1,\cdots,J-1" class="ltx_Math" display="block" id="S4.E5.m1.6"><semantics id="S4.E5.m1.6a"><mrow id="S4.E5.m1.6.6.2" xref="S4.E5.m1.6.6.3.cmml"><mrow id="S4.E5.m1.5.5.1.1" xref="S4.E5.m1.5.5.1.1.cmml"><mrow id="S4.E5.m1.5.5.1.1.1.1" xref="S4.E5.m1.5.5.1.1.1.2.cmml"><mo id="S4.E5.m1.5.5.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.5.5.1.1.1.2.cmml">[</mo><mi id="S4.E5.m1.1.1" mathvariant="normal" xref="S4.E5.m1.1.1.cmml">_</mi><mo id="S4.E5.m1.5.5.1.1.1.1.3" xref="S4.E5.m1.5.5.1.1.1.2.cmml">,</mo><msub id="S4.E5.m1.5.5.1.1.1.1.1" xref="S4.E5.m1.5.5.1.1.1.1.1.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1.1.2" xref="S4.E5.m1.5.5.1.1.1.1.1.2.cmml">W</mi><mrow id="S4.E5.m1.5.5.1.1.1.1.1.3" xref="S4.E5.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1.1.3.2" xref="S4.E5.m1.5.5.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E5.m1.5.5.1.1.1.1.1.3.1" xref="S4.E5.m1.5.5.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.E5.m1.5.5.1.1.1.1.1.3.3" xref="S4.E5.m1.5.5.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E5.m1.5.5.1.1.1.1.4" stretchy="false" xref="S4.E5.m1.5.5.1.1.1.2.cmml">]</mo></mrow><mo id="S4.E5.m1.5.5.1.1.3" xref="S4.E5.m1.5.5.1.1.3.cmml">=</mo><mrow id="S4.E5.m1.5.5.1.1.2" xref="S4.E5.m1.5.5.1.1.2.cmml"><msub id="S4.E5.m1.5.5.1.1.2.3" xref="S4.E5.m1.5.5.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.5.5.1.1.2.3.2" xref="S4.E5.m1.5.5.1.1.2.3.2.cmml">ℒ</mi><mrow id="S4.E5.m1.5.5.1.1.2.3.3" xref="S4.E5.m1.5.5.1.1.2.3.3.cmml"><mi id="S4.E5.m1.5.5.1.1.2.3.3.2" xref="S4.E5.m1.5.5.1.1.2.3.3.2.cmml">i</mi><mo id="S4.E5.m1.5.5.1.1.2.3.3.1" xref="S4.E5.m1.5.5.1.1.2.3.3.1.cmml">+</mo><mn id="S4.E5.m1.5.5.1.1.2.3.3.3" xref="S4.E5.m1.5.5.1.1.2.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.E5.m1.5.5.1.1.2.2" xref="S4.E5.m1.5.5.1.1.2.2.cmml">⁢</mo><mrow id="S4.E5.m1.5.5.1.1.2.1.1" xref="S4.E5.m1.5.5.1.1.2.cmml"><mo id="S4.E5.m1.5.5.1.1.2.1.1.2" stretchy="false" xref="S4.E5.m1.5.5.1.1.2.cmml">(</mo><mrow id="S4.E5.m1.5.5.1.1.2.1.1.1.2" xref="S4.E5.m1.5.5.1.1.2.1.1.1.3.cmml"><mo id="S4.E5.m1.5.5.1.1.2.1.1.1.2.3" stretchy="false" xref="S4.E5.m1.5.5.1.1.2.1.1.1.3.cmml">[</mo><msub id="S4.E5.m1.5.5.1.1.2.1.1.1.1.1" xref="S4.E5.m1.5.5.1.1.2.1.1.1.1.1.cmml"><mi id="S4.E5.m1.5.5.1.1.2.1.1.1.1.1.2" xref="S4.E5.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">P</mi><mi id="S4.E5.m1.5.5.1.1.2.1.1.1.1.1.3" xref="S4.E5.m1.5.5.1.1.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E5.m1.5.5.1.1.2.1.1.1.2.4" xref="S4.E5.m1.5.5.1.1.2.1.1.1.3.cmml">,</mo><msub id="S4.E5.m1.5.5.1.1.2.1.1.1.2.2" xref="S4.E5.m1.5.5.1.1.2.1.1.1.2.2.cmml"><mi id="S4.E5.m1.5.5.1.1.2.1.1.1.2.2.2" xref="S4.E5.m1.5.5.1.1.2.1.1.1.2.2.2.cmml">W</mi><mi id="S4.E5.m1.5.5.1.1.2.1.1.1.2.2.3" xref="S4.E5.m1.5.5.1.1.2.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.E5.m1.5.5.1.1.2.1.1.1.2.5" stretchy="false" xref="S4.E5.m1.5.5.1.1.2.1.1.1.3.cmml">]</mo></mrow><mo id="S4.E5.m1.5.5.1.1.2.1.1.3" stretchy="false" xref="S4.E5.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow></mrow><mspace id="S4.E5.m1.6.6.2.3" width="4em" xref="S4.E5.m1.6.6.3a.cmml"></mspace><mrow id="S4.E5.m1.6.6.2.2" xref="S4.E5.m1.6.6.2.2.cmml"><mi id="S4.E5.m1.6.6.2.2.3" xref="S4.E5.m1.6.6.2.2.3.cmml">i</mi><mo id="S4.E5.m1.6.6.2.2.2" xref="S4.E5.m1.6.6.2.2.2.cmml">=</mo><mrow id="S4.E5.m1.6.6.2.2.1.1" xref="S4.E5.m1.6.6.2.2.1.2.cmml"><mn id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">0</mn><mo id="S4.E5.m1.6.6.2.2.1.1.2" xref="S4.E5.m1.6.6.2.2.1.2.cmml">,</mo><mn id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml">1</mn><mo id="S4.E5.m1.6.6.2.2.1.1.3" xref="S4.E5.m1.6.6.2.2.1.2.cmml">,</mo><mi id="S4.E5.m1.4.4" mathvariant="normal" xref="S4.E5.m1.4.4.cmml">⋯</mi><mo id="S4.E5.m1.6.6.2.2.1.1.4" xref="S4.E5.m1.6.6.2.2.1.2.cmml">,</mo><mrow id="S4.E5.m1.6.6.2.2.1.1.1" xref="S4.E5.m1.6.6.2.2.1.1.1.cmml"><mi id="S4.E5.m1.6.6.2.2.1.1.1.2" xref="S4.E5.m1.6.6.2.2.1.1.1.2.cmml">J</mi><mo id="S4.E5.m1.6.6.2.2.1.1.1.1" xref="S4.E5.m1.6.6.2.2.1.1.1.1.cmml">−</mo><mn id="S4.E5.m1.6.6.2.2.1.1.1.3" xref="S4.E5.m1.6.6.2.2.1.1.1.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.6b"><apply id="S4.E5.m1.6.6.3.cmml" xref="S4.E5.m1.6.6.2"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.3a.cmml" xref="S4.E5.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S4.E5.m1.5.5.1.1.cmml" xref="S4.E5.m1.5.5.1.1"><eq id="S4.E5.m1.5.5.1.1.3.cmml" xref="S4.E5.m1.5.5.1.1.3"></eq><interval closure="closed" id="S4.E5.m1.5.5.1.1.1.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1"><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">_</ci><apply id="S4.E5.m1.5.5.1.1.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.1.2">𝑊</ci><apply id="S4.E5.m1.5.5.1.1.1.1.1.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.1.3"><plus id="S4.E5.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.1.3.1"></plus><ci id="S4.E5.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.1.3.2">𝑖</ci><cn id="S4.E5.m1.5.5.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E5.m1.5.5.1.1.1.1.1.3.3">1</cn></apply></apply></interval><apply id="S4.E5.m1.5.5.1.1.2.cmml" xref="S4.E5.m1.5.5.1.1.2"><times id="S4.E5.m1.5.5.1.1.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2"></times><apply id="S4.E5.m1.5.5.1.1.2.3.cmml" xref="S4.E5.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.2.3">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.2.3.2">ℒ</ci><apply id="S4.E5.m1.5.5.1.1.2.3.3.cmml" xref="S4.E5.m1.5.5.1.1.2.3.3"><plus id="S4.E5.m1.5.5.1.1.2.3.3.1.cmml" xref="S4.E5.m1.5.5.1.1.2.3.3.1"></plus><ci id="S4.E5.m1.5.5.1.1.2.3.3.2.cmml" xref="S4.E5.m1.5.5.1.1.2.3.3.2">𝑖</ci><cn id="S4.E5.m1.5.5.1.1.2.3.3.3.cmml" type="integer" xref="S4.E5.m1.5.5.1.1.2.3.3.3">1</cn></apply></apply><interval closure="closed" id="S4.E5.m1.5.5.1.1.2.1.1.1.3.cmml" xref="S4.E5.m1.5.5.1.1.2.1.1.1.2"><apply id="S4.E5.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E5.m1.5.5.1.1.2.1.1.1.1.1.2">𝑃</ci><ci id="S4.E5.m1.5.5.1.1.2.1.1.1.1.1.3.cmml" xref="S4.E5.m1.5.5.1.1.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E5.m1.5.5.1.1.2.1.1.1.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.1.1.1.2.2.1.cmml" xref="S4.E5.m1.5.5.1.1.2.1.1.1.2.2">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.2.1.1.1.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.1.1.1.2.2.2">𝑊</ci><ci id="S4.E5.m1.5.5.1.1.2.1.1.1.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.2.1.1.1.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S4.E5.m1.6.6.2.2.cmml" xref="S4.E5.m1.6.6.2.2"><eq id="S4.E5.m1.6.6.2.2.2.cmml" xref="S4.E5.m1.6.6.2.2.2"></eq><ci id="S4.E5.m1.6.6.2.2.3.cmml" xref="S4.E5.m1.6.6.2.2.3">𝑖</ci><list id="S4.E5.m1.6.6.2.2.1.2.cmml" xref="S4.E5.m1.6.6.2.2.1.1"><cn id="S4.E5.m1.2.2.cmml" type="integer" xref="S4.E5.m1.2.2">0</cn><cn id="S4.E5.m1.3.3.cmml" type="integer" xref="S4.E5.m1.3.3">1</cn><ci id="S4.E5.m1.4.4.cmml" xref="S4.E5.m1.4.4">⋯</ci><apply id="S4.E5.m1.6.6.2.2.1.1.1.cmml" xref="S4.E5.m1.6.6.2.2.1.1.1"><minus id="S4.E5.m1.6.6.2.2.1.1.1.1.cmml" xref="S4.E5.m1.6.6.2.2.1.1.1.1"></minus><ci id="S4.E5.m1.6.6.2.2.1.1.1.2.cmml" xref="S4.E5.m1.6.6.2.2.1.1.1.2">𝐽</ci><cn id="S4.E5.m1.6.6.2.2.1.1.1.3.cmml" type="integer" xref="S4.E5.m1.6.6.2.2.1.1.1.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.6c">[\_,W_{i+1}]=\mathcal{L}_{i+1}([P_{i},W_{i}])\qquad\qquad i=0,1,\cdots,J-1</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.6d">[ _ , italic_W start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ] = caligraphic_L start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ( [ italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) italic_i = 0 , 1 , ⋯ , italic_J - 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.4">Up to <math alttext="J^{th}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><msup id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">J</mi><mrow id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml"><mi id="S4.SS1.p2.1.m1.1.1.3.2" xref="S4.SS1.p2.1.m1.1.1.3.2.cmml">t</mi><mo id="S4.SS1.p2.1.m1.1.1.3.1" xref="S4.SS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.1.m1.1.1.3.3" xref="S4.SS1.p2.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝐽</ci><apply id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3"><times id="S4.SS1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3.1"></times><ci id="S4.SS1.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.2">𝑡</ci><ci id="S4.SS1.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">J^{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_J start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> transformer layer, the outputs corresponding to learnable prompts <math alttext="P" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_P</annotation></semantics></math> are discarded, and a new set of learnable prompts is injected for each layer.
Whereas, after the <math alttext="J^{th}" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><msup id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">J</mi><mrow id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml"><mi id="S4.SS1.p2.3.m3.1.1.3.2" xref="S4.SS1.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS1.p2.3.m3.1.1.3.1" xref="S4.SS1.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p2.3.m3.1.1.3.3" xref="S4.SS1.p2.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝐽</ci><apply id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3"><times id="S4.SS1.p2.3.m3.1.1.3.1.cmml" xref="S4.SS1.p2.3.m3.1.1.3.1"></times><ci id="S4.SS1.p2.3.m3.1.1.3.2.cmml" xref="S4.SS1.p2.3.m3.1.1.3.2">𝑡</ci><ci id="S4.SS1.p2.3.m3.1.1.3.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">J^{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">italic_J start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> layer (<math alttext="\mathcal{L}_{J}" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><msub id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">ℒ</mi><mi id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">J</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">ℒ</ci><ci id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3">𝐽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\mathcal{L}_{J}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT</annotation></semantics></math>), the computation is carried on similar to the one described in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.05239v2#S3.SS1" title="3.1 Text Encoding ‣ 3 Revisiting CLIP ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">subsection 3.1</span></a> as if the prompts are identical to the word embeddings.
Mathematically,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[P_{i+1},W_{i+1}]=\mathcal{L}_{i+1}([P_{i},W_{i}])\qquad\qquad i=J,J+1,\cdots,%
N_{l}-1" class="ltx_Math" display="block" id="S4.E6.m1.4"><semantics id="S4.E6.m1.4a"><mrow id="S4.E6.m1.4.4.2" xref="S4.E6.m1.4.4.3.cmml"><mrow id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml"><mrow id="S4.E6.m1.3.3.1.1.2.2" xref="S4.E6.m1.3.3.1.1.2.3.cmml"><mo id="S4.E6.m1.3.3.1.1.2.2.3" stretchy="false" xref="S4.E6.m1.3.3.1.1.2.3.cmml">[</mo><msub id="S4.E6.m1.3.3.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.1.2.cmml">P</mi><mrow id="S4.E6.m1.3.3.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.1.3.2" xref="S4.E6.m1.3.3.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E6.m1.3.3.1.1.1.1.1.3.1" xref="S4.E6.m1.3.3.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.E6.m1.3.3.1.1.1.1.1.3.3" xref="S4.E6.m1.3.3.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E6.m1.3.3.1.1.2.2.4" xref="S4.E6.m1.3.3.1.1.2.3.cmml">,</mo><msub id="S4.E6.m1.3.3.1.1.2.2.2" xref="S4.E6.m1.3.3.1.1.2.2.2.cmml"><mi id="S4.E6.m1.3.3.1.1.2.2.2.2" xref="S4.E6.m1.3.3.1.1.2.2.2.2.cmml">W</mi><mrow id="S4.E6.m1.3.3.1.1.2.2.2.3" xref="S4.E6.m1.3.3.1.1.2.2.2.3.cmml"><mi id="S4.E6.m1.3.3.1.1.2.2.2.3.2" xref="S4.E6.m1.3.3.1.1.2.2.2.3.2.cmml">i</mi><mo id="S4.E6.m1.3.3.1.1.2.2.2.3.1" xref="S4.E6.m1.3.3.1.1.2.2.2.3.1.cmml">+</mo><mn id="S4.E6.m1.3.3.1.1.2.2.2.3.3" xref="S4.E6.m1.3.3.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.E6.m1.3.3.1.1.2.2.5" stretchy="false" xref="S4.E6.m1.3.3.1.1.2.3.cmml">]</mo></mrow><mo id="S4.E6.m1.3.3.1.1.4" xref="S4.E6.m1.3.3.1.1.4.cmml">=</mo><mrow id="S4.E6.m1.3.3.1.1.3" xref="S4.E6.m1.3.3.1.1.3.cmml"><msub id="S4.E6.m1.3.3.1.1.3.3" xref="S4.E6.m1.3.3.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.3.3.1.1.3.3.2" xref="S4.E6.m1.3.3.1.1.3.3.2.cmml">ℒ</mi><mrow id="S4.E6.m1.3.3.1.1.3.3.3" xref="S4.E6.m1.3.3.1.1.3.3.3.cmml"><mi id="S4.E6.m1.3.3.1.1.3.3.3.2" xref="S4.E6.m1.3.3.1.1.3.3.3.2.cmml">i</mi><mo id="S4.E6.m1.3.3.1.1.3.3.3.1" xref="S4.E6.m1.3.3.1.1.3.3.3.1.cmml">+</mo><mn id="S4.E6.m1.3.3.1.1.3.3.3.3" xref="S4.E6.m1.3.3.1.1.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.E6.m1.3.3.1.1.3.2" xref="S4.E6.m1.3.3.1.1.3.2.cmml">⁢</mo><mrow id="S4.E6.m1.3.3.1.1.3.1.1" xref="S4.E6.m1.3.3.1.1.3.cmml"><mo id="S4.E6.m1.3.3.1.1.3.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.3.cmml">(</mo><mrow id="S4.E6.m1.3.3.1.1.3.1.1.1.2" xref="S4.E6.m1.3.3.1.1.3.1.1.1.3.cmml"><mo id="S4.E6.m1.3.3.1.1.3.1.1.1.2.3" stretchy="false" xref="S4.E6.m1.3.3.1.1.3.1.1.1.3.cmml">[</mo><msub id="S4.E6.m1.3.3.1.1.3.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.3.1.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.3.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.3.1.1.1.1.1.2.cmml">P</mi><mi id="S4.E6.m1.3.3.1.1.3.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E6.m1.3.3.1.1.3.1.1.1.2.4" xref="S4.E6.m1.3.3.1.1.3.1.1.1.3.cmml">,</mo><msub id="S4.E6.m1.3.3.1.1.3.1.1.1.2.2" xref="S4.E6.m1.3.3.1.1.3.1.1.1.2.2.cmml"><mi id="S4.E6.m1.3.3.1.1.3.1.1.1.2.2.2" xref="S4.E6.m1.3.3.1.1.3.1.1.1.2.2.2.cmml">W</mi><mi id="S4.E6.m1.3.3.1.1.3.1.1.1.2.2.3" xref="S4.E6.m1.3.3.1.1.3.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.E6.m1.3.3.1.1.3.1.1.1.2.5" stretchy="false" xref="S4.E6.m1.3.3.1.1.3.1.1.1.3.cmml">]</mo></mrow><mo id="S4.E6.m1.3.3.1.1.3.1.1.3" stretchy="false" xref="S4.E6.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow></mrow><mspace id="S4.E6.m1.4.4.2.3" width="4em" xref="S4.E6.m1.4.4.3a.cmml"></mspace><mrow id="S4.E6.m1.4.4.2.2" xref="S4.E6.m1.4.4.2.2.cmml"><mi id="S4.E6.m1.4.4.2.2.4" xref="S4.E6.m1.4.4.2.2.4.cmml">i</mi><mo id="S4.E6.m1.4.4.2.2.3" xref="S4.E6.m1.4.4.2.2.3.cmml">=</mo><mrow id="S4.E6.m1.4.4.2.2.2.2" xref="S4.E6.m1.4.4.2.2.2.3.cmml"><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">J</mi><mo id="S4.E6.m1.4.4.2.2.2.2.3" xref="S4.E6.m1.4.4.2.2.2.3.cmml">,</mo><mrow id="S4.E6.m1.4.4.2.2.1.1.1" xref="S4.E6.m1.4.4.2.2.1.1.1.cmml"><mi id="S4.E6.m1.4.4.2.2.1.1.1.2" xref="S4.E6.m1.4.4.2.2.1.1.1.2.cmml">J</mi><mo id="S4.E6.m1.4.4.2.2.1.1.1.1" xref="S4.E6.m1.4.4.2.2.1.1.1.1.cmml">+</mo><mn id="S4.E6.m1.4.4.2.2.1.1.1.3" xref="S4.E6.m1.4.4.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E6.m1.4.4.2.2.2.2.4" xref="S4.E6.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S4.E6.m1.2.2" mathvariant="normal" xref="S4.E6.m1.2.2.cmml">⋯</mi><mo id="S4.E6.m1.4.4.2.2.2.2.5" xref="S4.E6.m1.4.4.2.2.2.3.cmml">,</mo><mrow id="S4.E6.m1.4.4.2.2.2.2.2" xref="S4.E6.m1.4.4.2.2.2.2.2.cmml"><msub id="S4.E6.m1.4.4.2.2.2.2.2.2" xref="S4.E6.m1.4.4.2.2.2.2.2.2.cmml"><mi id="S4.E6.m1.4.4.2.2.2.2.2.2.2" xref="S4.E6.m1.4.4.2.2.2.2.2.2.2.cmml">N</mi><mi id="S4.E6.m1.4.4.2.2.2.2.2.2.3" xref="S4.E6.m1.4.4.2.2.2.2.2.2.3.cmml">l</mi></msub><mo id="S4.E6.m1.4.4.2.2.2.2.2.1" xref="S4.E6.m1.4.4.2.2.2.2.2.1.cmml">−</mo><mn id="S4.E6.m1.4.4.2.2.2.2.2.3" xref="S4.E6.m1.4.4.2.2.2.2.2.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.4b"><apply id="S4.E6.m1.4.4.3.cmml" xref="S4.E6.m1.4.4.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.3a.cmml" xref="S4.E6.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1.1"><eq id="S4.E6.m1.3.3.1.1.4.cmml" xref="S4.E6.m1.3.3.1.1.4"></eq><interval closure="closed" id="S4.E6.m1.3.3.1.1.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2"><apply id="S4.E6.m1.3.3.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.2">𝑃</ci><apply id="S4.E6.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.3"><plus id="S4.E6.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.3.1"></plus><ci id="S4.E6.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.3.2">𝑖</ci><cn id="S4.E6.m1.3.3.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E6.m1.3.3.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E6.m1.3.3.1.1.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.2.2">𝑊</ci><apply id="S4.E6.m1.3.3.1.1.2.2.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.2.3"><plus id="S4.E6.m1.3.3.1.1.2.2.2.3.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2.2.3.1"></plus><ci id="S4.E6.m1.3.3.1.1.2.2.2.3.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.2.3.2">𝑖</ci><cn id="S4.E6.m1.3.3.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.E6.m1.3.3.1.1.2.2.2.3.3">1</cn></apply></apply></interval><apply id="S4.E6.m1.3.3.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.3"><times id="S4.E6.m1.3.3.1.1.3.2.cmml" xref="S4.E6.m1.3.3.1.1.3.2"></times><apply id="S4.E6.m1.3.3.1.1.3.3.cmml" xref="S4.E6.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.3.3.1.cmml" xref="S4.E6.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.3.3.2.cmml" xref="S4.E6.m1.3.3.1.1.3.3.2">ℒ</ci><apply id="S4.E6.m1.3.3.1.1.3.3.3.cmml" xref="S4.E6.m1.3.3.1.1.3.3.3"><plus id="S4.E6.m1.3.3.1.1.3.3.3.1.cmml" xref="S4.E6.m1.3.3.1.1.3.3.3.1"></plus><ci id="S4.E6.m1.3.3.1.1.3.3.3.2.cmml" xref="S4.E6.m1.3.3.1.1.3.3.3.2">𝑖</ci><cn id="S4.E6.m1.3.3.1.1.3.3.3.3.cmml" type="integer" xref="S4.E6.m1.3.3.1.1.3.3.3.3">1</cn></apply></apply><interval closure="closed" id="S4.E6.m1.3.3.1.1.3.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.3.1.1.1.2"><apply id="S4.E6.m1.3.3.1.1.3.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.3.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.3.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.3.1.1.1.1.1.2">𝑃</ci><ci id="S4.E6.m1.3.3.1.1.3.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E6.m1.3.3.1.1.3.1.1.1.2.2.cmml" xref="S4.E6.m1.3.3.1.1.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.3.1.1.1.2.2.1.cmml" xref="S4.E6.m1.3.3.1.1.3.1.1.1.2.2">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.3.1.1.1.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.3.1.1.1.2.2.2">𝑊</ci><ci id="S4.E6.m1.3.3.1.1.3.1.1.1.2.2.3.cmml" xref="S4.E6.m1.3.3.1.1.3.1.1.1.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S4.E6.m1.4.4.2.2.cmml" xref="S4.E6.m1.4.4.2.2"><eq id="S4.E6.m1.4.4.2.2.3.cmml" xref="S4.E6.m1.4.4.2.2.3"></eq><ci id="S4.E6.m1.4.4.2.2.4.cmml" xref="S4.E6.m1.4.4.2.2.4">𝑖</ci><list id="S4.E6.m1.4.4.2.2.2.3.cmml" xref="S4.E6.m1.4.4.2.2.2.2"><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">𝐽</ci><apply id="S4.E6.m1.4.4.2.2.1.1.1.cmml" xref="S4.E6.m1.4.4.2.2.1.1.1"><plus id="S4.E6.m1.4.4.2.2.1.1.1.1.cmml" xref="S4.E6.m1.4.4.2.2.1.1.1.1"></plus><ci id="S4.E6.m1.4.4.2.2.1.1.1.2.cmml" xref="S4.E6.m1.4.4.2.2.1.1.1.2">𝐽</ci><cn id="S4.E6.m1.4.4.2.2.1.1.1.3.cmml" type="integer" xref="S4.E6.m1.4.4.2.2.1.1.1.3">1</cn></apply><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">⋯</ci><apply id="S4.E6.m1.4.4.2.2.2.2.2.cmml" xref="S4.E6.m1.4.4.2.2.2.2.2"><minus id="S4.E6.m1.4.4.2.2.2.2.2.1.cmml" xref="S4.E6.m1.4.4.2.2.2.2.2.1"></minus><apply id="S4.E6.m1.4.4.2.2.2.2.2.2.cmml" xref="S4.E6.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E6.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S4.E6.m1.4.4.2.2.2.2.2.2.2">𝑁</ci><ci id="S4.E6.m1.4.4.2.2.2.2.2.2.3.cmml" xref="S4.E6.m1.4.4.2.2.2.2.2.2.3">𝑙</ci></apply><cn id="S4.E6.m1.4.4.2.2.2.2.2.3.cmml" type="integer" xref="S4.E6.m1.4.4.2.2.2.2.2.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.4c">[P_{i+1},W_{i+1}]=\mathcal{L}_{i+1}([P_{i},W_{i}])\qquad\qquad i=J,J+1,\cdots,%
N_{l}-1</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.4d">[ italic_P start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ] = caligraphic_L start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ( [ italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) italic_i = italic_J , italic_J + 1 , ⋯ , italic_N start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT - 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">When the depth of the network to which the prompt is injected is unity, <em class="ltx_emph ltx_font_italic" id="S4.SS1.p3.1.1">i.e</em>.<span class="ltx_text" id="S4.SS1.p3.1.2"></span>, <math alttext="J=1" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">J</mi><mo id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><eq id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"></eq><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝐽</ci><cn id="S4.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">J=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_J = 1</annotation></semantics></math>, it subsides to CoOp <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib62" title="">62</a>]</cite>.
CoCoOp <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib61" title="">61</a>]</cite> extended CoOp by adding the projection of CLIP’s image-level embeddings to learnable prompts.
It makes the textual prompts image-dependent compared to the instance-agnostic task-dependent prompts of CoOp.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Visual Prompt Tuning</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.3">Similar to textual prompt tuning, we assign <math alttext="B" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_B</annotation></semantics></math> learnable tokens to the first transformer layer for CLIP’s vision encoder, as <math alttext="\tilde{P}_{0}\in\mathbb{R}^{B\times H_{v}}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><msub id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml"><mover accent="true" id="S4.SS2.p1.2.m2.1.1.2.2" xref="S4.SS2.p1.2.m2.1.1.2.2.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2.2.2" xref="S4.SS2.p1.2.m2.1.1.2.2.2.cmml">P</mi><mo id="S4.SS2.p1.2.m2.1.1.2.2.1" xref="S4.SS2.p1.2.m2.1.1.2.2.1.cmml">~</mo></mover><mn id="S4.SS2.p1.2.m2.1.1.2.3" xref="S4.SS2.p1.2.m2.1.1.2.3.cmml">0</mn></msub><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.3.2" xref="S4.SS2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.2.m2.1.1.3.3" xref="S4.SS2.p1.2.m2.1.1.3.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.3.3.2" xref="S4.SS2.p1.2.m2.1.1.3.3.2.cmml">B</mi><mo id="S4.SS2.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S4.SS2.p1.2.m2.1.1.3.3.3" xref="S4.SS2.p1.2.m2.1.1.3.3.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.3.3.3.2" xref="S4.SS2.p1.2.m2.1.1.3.3.3.2.cmml">H</mi><mi id="S4.SS2.p1.2.m2.1.1.3.3.3.3" xref="S4.SS2.p1.2.m2.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><in id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></in><apply id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.2">subscript</csymbol><apply id="S4.SS2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2"><ci id="S4.SS2.p1.2.m2.1.1.2.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2.1">~</ci><ci id="S4.SS2.p1.2.m2.1.1.2.2.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2.2">𝑃</ci></apply><cn id="S4.SS2.p1.2.m2.1.1.2.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1.2.3">0</cn></apply><apply id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3.3"><times id="S4.SS2.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.3.3.1"></times><ci id="S4.SS2.p1.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.3.3.2">𝐵</ci><apply id="S4.SS2.p1.2.m2.1.1.3.3.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.3.3.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.3.3.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.3.3.3.2">𝐻</ci><ci id="S4.SS2.p1.2.m2.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\tilde{P}_{0}\in\mathbb{R}^{B\times H_{v}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> (see <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S4.F2.sf3" title="In Figure 2 ‣ 4.3 Multimodal Prompt Tuning ‣ 4 Revisiting Prompt Tuning ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(c)</span></a>).
The input for the first transformer layer of ViT is the concatenation of the CLS token, fixed image token embeddings, and the learnable prompts, <em class="ltx_emph ltx_font_italic" id="S4.SS2.p1.3.1">i.e</em>.<span class="ltx_text" id="S4.SS2.p1.3.2"></span>, <math alttext="[c_{0},E_{0},\tilde{P}_{0}]" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.3"><semantics id="S4.SS2.p1.3.m3.3a"><mrow id="S4.SS2.p1.3.m3.3.3.3" xref="S4.SS2.p1.3.m3.3.3.4.cmml"><mo id="S4.SS2.p1.3.m3.3.3.3.4" stretchy="false" xref="S4.SS2.p1.3.m3.3.3.4.cmml">[</mo><msub id="S4.SS2.p1.3.m3.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.1.1.2.cmml">c</mi><mn id="S4.SS2.p1.3.m3.1.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.1.1.3.cmml">0</mn></msub><mo id="S4.SS2.p1.3.m3.3.3.3.5" xref="S4.SS2.p1.3.m3.3.3.4.cmml">,</mo><msub id="S4.SS2.p1.3.m3.2.2.2.2" xref="S4.SS2.p1.3.m3.2.2.2.2.cmml"><mi id="S4.SS2.p1.3.m3.2.2.2.2.2" xref="S4.SS2.p1.3.m3.2.2.2.2.2.cmml">E</mi><mn id="S4.SS2.p1.3.m3.2.2.2.2.3" xref="S4.SS2.p1.3.m3.2.2.2.2.3.cmml">0</mn></msub><mo id="S4.SS2.p1.3.m3.3.3.3.6" xref="S4.SS2.p1.3.m3.3.3.4.cmml">,</mo><msub id="S4.SS2.p1.3.m3.3.3.3.3" xref="S4.SS2.p1.3.m3.3.3.3.3.cmml"><mover accent="true" id="S4.SS2.p1.3.m3.3.3.3.3.2" xref="S4.SS2.p1.3.m3.3.3.3.3.2.cmml"><mi id="S4.SS2.p1.3.m3.3.3.3.3.2.2" xref="S4.SS2.p1.3.m3.3.3.3.3.2.2.cmml">P</mi><mo id="S4.SS2.p1.3.m3.3.3.3.3.2.1" xref="S4.SS2.p1.3.m3.3.3.3.3.2.1.cmml">~</mo></mover><mn id="S4.SS2.p1.3.m3.3.3.3.3.3" xref="S4.SS2.p1.3.m3.3.3.3.3.3.cmml">0</mn></msub><mo id="S4.SS2.p1.3.m3.3.3.3.7" stretchy="false" xref="S4.SS2.p1.3.m3.3.3.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.3b"><list id="S4.SS2.p1.3.m3.3.3.4.cmml" xref="S4.SS2.p1.3.m3.3.3.3"><apply id="S4.SS2.p1.3.m3.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.2">𝑐</ci><cn id="S4.SS2.p1.3.m3.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p1.3.m3.1.1.1.1.3">0</cn></apply><apply id="S4.SS2.p1.3.m3.2.2.2.2.cmml" xref="S4.SS2.p1.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.2.2.2.2.1.cmml" xref="S4.SS2.p1.3.m3.2.2.2.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.2.2.2.2.2.cmml" xref="S4.SS2.p1.3.m3.2.2.2.2.2">𝐸</ci><cn id="S4.SS2.p1.3.m3.2.2.2.2.3.cmml" type="integer" xref="S4.SS2.p1.3.m3.2.2.2.2.3">0</cn></apply><apply id="S4.SS2.p1.3.m3.3.3.3.3.cmml" xref="S4.SS2.p1.3.m3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.3.3.3.3.1.cmml" xref="S4.SS2.p1.3.m3.3.3.3.3">subscript</csymbol><apply id="S4.SS2.p1.3.m3.3.3.3.3.2.cmml" xref="S4.SS2.p1.3.m3.3.3.3.3.2"><ci id="S4.SS2.p1.3.m3.3.3.3.3.2.1.cmml" xref="S4.SS2.p1.3.m3.3.3.3.3.2.1">~</ci><ci id="S4.SS2.p1.3.m3.3.3.3.3.2.2.cmml" xref="S4.SS2.p1.3.m3.3.3.3.3.2.2">𝑃</ci></apply><cn id="S4.SS2.p1.3.m3.3.3.3.3.3.cmml" type="integer" xref="S4.SS2.p1.3.m3.3.3.3.3.3">0</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.3c">[c_{0},E_{0},\tilde{P}_{0}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.3d">[ italic_c start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ]</annotation></semantics></math>.
Mathematically,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[c_{i+1},E_{i+1},\_]=\mathcal{V}_{i+1}([c_{i},E_{i},\tilde{P}_{i}])\qquad%
\qquad i=0,1,\cdots,J-1" class="ltx_Math" display="block" id="S4.E7.m1.6"><semantics id="S4.E7.m1.6a"><mrow id="S4.E7.m1.6.6.2" xref="S4.E7.m1.6.6.3.cmml"><mrow id="S4.E7.m1.5.5.1.1" xref="S4.E7.m1.5.5.1.1.cmml"><mrow id="S4.E7.m1.5.5.1.1.2.2" xref="S4.E7.m1.5.5.1.1.2.3.cmml"><mo id="S4.E7.m1.5.5.1.1.2.2.3" stretchy="false" xref="S4.E7.m1.5.5.1.1.2.3.cmml">[</mo><msub id="S4.E7.m1.5.5.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.1.cmml"><mi id="S4.E7.m1.5.5.1.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.1.1.1.2.cmml">c</mi><mrow id="S4.E7.m1.5.5.1.1.1.1.1.3" xref="S4.E7.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.5.5.1.1.1.1.1.3.2" xref="S4.E7.m1.5.5.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E7.m1.5.5.1.1.1.1.1.3.1" xref="S4.E7.m1.5.5.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.E7.m1.5.5.1.1.1.1.1.3.3" xref="S4.E7.m1.5.5.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E7.m1.5.5.1.1.2.2.4" xref="S4.E7.m1.5.5.1.1.2.3.cmml">,</mo><msub id="S4.E7.m1.5.5.1.1.2.2.2" xref="S4.E7.m1.5.5.1.1.2.2.2.cmml"><mi id="S4.E7.m1.5.5.1.1.2.2.2.2" xref="S4.E7.m1.5.5.1.1.2.2.2.2.cmml">E</mi><mrow id="S4.E7.m1.5.5.1.1.2.2.2.3" xref="S4.E7.m1.5.5.1.1.2.2.2.3.cmml"><mi id="S4.E7.m1.5.5.1.1.2.2.2.3.2" xref="S4.E7.m1.5.5.1.1.2.2.2.3.2.cmml">i</mi><mo id="S4.E7.m1.5.5.1.1.2.2.2.3.1" xref="S4.E7.m1.5.5.1.1.2.2.2.3.1.cmml">+</mo><mn id="S4.E7.m1.5.5.1.1.2.2.2.3.3" xref="S4.E7.m1.5.5.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.E7.m1.5.5.1.1.2.2.5" xref="S4.E7.m1.5.5.1.1.2.3.cmml">,</mo><mi id="S4.E7.m1.1.1" mathvariant="normal" xref="S4.E7.m1.1.1.cmml">_</mi><mo id="S4.E7.m1.5.5.1.1.2.2.6" stretchy="false" xref="S4.E7.m1.5.5.1.1.2.3.cmml">]</mo></mrow><mo id="S4.E7.m1.5.5.1.1.4" xref="S4.E7.m1.5.5.1.1.4.cmml">=</mo><mrow id="S4.E7.m1.5.5.1.1.3" xref="S4.E7.m1.5.5.1.1.3.cmml"><msub id="S4.E7.m1.5.5.1.1.3.3" xref="S4.E7.m1.5.5.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.5.5.1.1.3.3.2" xref="S4.E7.m1.5.5.1.1.3.3.2.cmml">𝒱</mi><mrow id="S4.E7.m1.5.5.1.1.3.3.3" xref="S4.E7.m1.5.5.1.1.3.3.3.cmml"><mi id="S4.E7.m1.5.5.1.1.3.3.3.2" xref="S4.E7.m1.5.5.1.1.3.3.3.2.cmml">i</mi><mo id="S4.E7.m1.5.5.1.1.3.3.3.1" xref="S4.E7.m1.5.5.1.1.3.3.3.1.cmml">+</mo><mn id="S4.E7.m1.5.5.1.1.3.3.3.3" xref="S4.E7.m1.5.5.1.1.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.E7.m1.5.5.1.1.3.2" xref="S4.E7.m1.5.5.1.1.3.2.cmml">⁢</mo><mrow id="S4.E7.m1.5.5.1.1.3.1.1" xref="S4.E7.m1.5.5.1.1.3.cmml"><mo id="S4.E7.m1.5.5.1.1.3.1.1.2" stretchy="false" xref="S4.E7.m1.5.5.1.1.3.cmml">(</mo><mrow id="S4.E7.m1.5.5.1.1.3.1.1.1.3" xref="S4.E7.m1.5.5.1.1.3.1.1.1.4.cmml"><mo id="S4.E7.m1.5.5.1.1.3.1.1.1.3.4" stretchy="false" xref="S4.E7.m1.5.5.1.1.3.1.1.1.4.cmml">[</mo><msub id="S4.E7.m1.5.5.1.1.3.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.3.1.1.1.1.1.cmml"><mi id="S4.E7.m1.5.5.1.1.3.1.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.3.1.1.1.1.1.2.cmml">c</mi><mi id="S4.E7.m1.5.5.1.1.3.1.1.1.1.1.3" xref="S4.E7.m1.5.5.1.1.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.5.5.1.1.3.1.1.1.3.5" xref="S4.E7.m1.5.5.1.1.3.1.1.1.4.cmml">,</mo><msub id="S4.E7.m1.5.5.1.1.3.1.1.1.2.2" xref="S4.E7.m1.5.5.1.1.3.1.1.1.2.2.cmml"><mi id="S4.E7.m1.5.5.1.1.3.1.1.1.2.2.2" xref="S4.E7.m1.5.5.1.1.3.1.1.1.2.2.2.cmml">E</mi><mi id="S4.E7.m1.5.5.1.1.3.1.1.1.2.2.3" xref="S4.E7.m1.5.5.1.1.3.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.E7.m1.5.5.1.1.3.1.1.1.3.6" xref="S4.E7.m1.5.5.1.1.3.1.1.1.4.cmml">,</mo><msub id="S4.E7.m1.5.5.1.1.3.1.1.1.3.3" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.cmml"><mover accent="true" id="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2.cmml"><mi id="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2.2" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2.2.cmml">P</mi><mo id="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2.1" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2.1.cmml">~</mo></mover><mi id="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.3" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.3.cmml">i</mi></msub><mo id="S4.E7.m1.5.5.1.1.3.1.1.1.3.7" stretchy="false" xref="S4.E7.m1.5.5.1.1.3.1.1.1.4.cmml">]</mo></mrow><mo id="S4.E7.m1.5.5.1.1.3.1.1.3" stretchy="false" xref="S4.E7.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow></mrow><mspace id="S4.E7.m1.6.6.2.3" width="4em" xref="S4.E7.m1.6.6.3a.cmml"></mspace><mrow id="S4.E7.m1.6.6.2.2" xref="S4.E7.m1.6.6.2.2.cmml"><mi id="S4.E7.m1.6.6.2.2.3" xref="S4.E7.m1.6.6.2.2.3.cmml">i</mi><mo id="S4.E7.m1.6.6.2.2.2" xref="S4.E7.m1.6.6.2.2.2.cmml">=</mo><mrow id="S4.E7.m1.6.6.2.2.1.1" xref="S4.E7.m1.6.6.2.2.1.2.cmml"><mn id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">0</mn><mo id="S4.E7.m1.6.6.2.2.1.1.2" xref="S4.E7.m1.6.6.2.2.1.2.cmml">,</mo><mn id="S4.E7.m1.3.3" xref="S4.E7.m1.3.3.cmml">1</mn><mo id="S4.E7.m1.6.6.2.2.1.1.3" xref="S4.E7.m1.6.6.2.2.1.2.cmml">,</mo><mi id="S4.E7.m1.4.4" mathvariant="normal" xref="S4.E7.m1.4.4.cmml">⋯</mi><mo id="S4.E7.m1.6.6.2.2.1.1.4" xref="S4.E7.m1.6.6.2.2.1.2.cmml">,</mo><mrow id="S4.E7.m1.6.6.2.2.1.1.1" xref="S4.E7.m1.6.6.2.2.1.1.1.cmml"><mi id="S4.E7.m1.6.6.2.2.1.1.1.2" xref="S4.E7.m1.6.6.2.2.1.1.1.2.cmml">J</mi><mo id="S4.E7.m1.6.6.2.2.1.1.1.1" xref="S4.E7.m1.6.6.2.2.1.1.1.1.cmml">−</mo><mn id="S4.E7.m1.6.6.2.2.1.1.1.3" xref="S4.E7.m1.6.6.2.2.1.1.1.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.6b"><apply id="S4.E7.m1.6.6.3.cmml" xref="S4.E7.m1.6.6.2"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.3a.cmml" xref="S4.E7.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S4.E7.m1.5.5.1.1.cmml" xref="S4.E7.m1.5.5.1.1"><eq id="S4.E7.m1.5.5.1.1.4.cmml" xref="S4.E7.m1.5.5.1.1.4"></eq><list id="S4.E7.m1.5.5.1.1.2.3.cmml" xref="S4.E7.m1.5.5.1.1.2.2"><apply id="S4.E7.m1.5.5.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.2">𝑐</ci><apply id="S4.E7.m1.5.5.1.1.1.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.3"><plus id="S4.E7.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.3.1"></plus><ci id="S4.E7.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.3.2">𝑖</ci><cn id="S4.E7.m1.5.5.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E7.m1.5.5.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E7.m1.5.5.1.1.2.2.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.2.2.2.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.2.2.2.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.2">𝐸</ci><apply id="S4.E7.m1.5.5.1.1.2.2.2.3.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3"><plus id="S4.E7.m1.5.5.1.1.2.2.2.3.1.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3.1"></plus><ci id="S4.E7.m1.5.5.1.1.2.2.2.3.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2.2.3.2">𝑖</ci><cn id="S4.E7.m1.5.5.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.E7.m1.5.5.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">_</ci></list><apply id="S4.E7.m1.5.5.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.3"><times id="S4.E7.m1.5.5.1.1.3.2.cmml" xref="S4.E7.m1.5.5.1.1.3.2"></times><apply id="S4.E7.m1.5.5.1.1.3.3.cmml" xref="S4.E7.m1.5.5.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.3.3.1.cmml" xref="S4.E7.m1.5.5.1.1.3.3">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.3.3.2.cmml" xref="S4.E7.m1.5.5.1.1.3.3.2">𝒱</ci><apply id="S4.E7.m1.5.5.1.1.3.3.3.cmml" xref="S4.E7.m1.5.5.1.1.3.3.3"><plus id="S4.E7.m1.5.5.1.1.3.3.3.1.cmml" xref="S4.E7.m1.5.5.1.1.3.3.3.1"></plus><ci id="S4.E7.m1.5.5.1.1.3.3.3.2.cmml" xref="S4.E7.m1.5.5.1.1.3.3.3.2">𝑖</ci><cn id="S4.E7.m1.5.5.1.1.3.3.3.3.cmml" type="integer" xref="S4.E7.m1.5.5.1.1.3.3.3.3">1</cn></apply></apply><list id="S4.E7.m1.5.5.1.1.3.1.1.1.4.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3"><apply id="S4.E7.m1.5.5.1.1.3.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.3.1.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.3.1.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.1.1.2">𝑐</ci><ci id="S4.E7.m1.5.5.1.1.3.1.1.1.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E7.m1.5.5.1.1.3.1.1.1.2.2.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.3.1.1.1.2.2.1.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.2.2">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.3.1.1.1.2.2.2.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.2.2.2">𝐸</ci><ci id="S4.E7.m1.5.5.1.1.3.1.1.1.2.2.3.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.1.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3.3">subscript</csymbol><apply id="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2"><ci id="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2.1.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2.1">~</ci><ci id="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2.2.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.2.2">𝑃</ci></apply><ci id="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.3.cmml" xref="S4.E7.m1.5.5.1.1.3.1.1.1.3.3.3">𝑖</ci></apply></list></apply></apply><apply id="S4.E7.m1.6.6.2.2.cmml" xref="S4.E7.m1.6.6.2.2"><eq id="S4.E7.m1.6.6.2.2.2.cmml" xref="S4.E7.m1.6.6.2.2.2"></eq><ci id="S4.E7.m1.6.6.2.2.3.cmml" xref="S4.E7.m1.6.6.2.2.3">𝑖</ci><list id="S4.E7.m1.6.6.2.2.1.2.cmml" xref="S4.E7.m1.6.6.2.2.1.1"><cn id="S4.E7.m1.2.2.cmml" type="integer" xref="S4.E7.m1.2.2">0</cn><cn id="S4.E7.m1.3.3.cmml" type="integer" xref="S4.E7.m1.3.3">1</cn><ci id="S4.E7.m1.4.4.cmml" xref="S4.E7.m1.4.4">⋯</ci><apply id="S4.E7.m1.6.6.2.2.1.1.1.cmml" xref="S4.E7.m1.6.6.2.2.1.1.1"><minus id="S4.E7.m1.6.6.2.2.1.1.1.1.cmml" xref="S4.E7.m1.6.6.2.2.1.1.1.1"></minus><ci id="S4.E7.m1.6.6.2.2.1.1.1.2.cmml" xref="S4.E7.m1.6.6.2.2.1.1.1.2">𝐽</ci><cn id="S4.E7.m1.6.6.2.2.1.1.1.3.cmml" type="integer" xref="S4.E7.m1.6.6.2.2.1.1.1.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.6c">[c_{i+1},E_{i+1},\_]=\mathcal{V}_{i+1}([c_{i},E_{i},\tilde{P}_{i}])\qquad%
\qquad i=0,1,\cdots,J-1</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.6d">[ italic_c start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , _ ] = caligraphic_V start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ( [ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) italic_i = 0 , 1 , ⋯ , italic_J - 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.4">Similar to textual prompt tuning, up to <math alttext="J^{th}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><msup id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">J</mi><mrow id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.3.2.cmml">t</mi><mo id="S4.SS2.p2.1.m1.1.1.3.1" xref="S4.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.1.m1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝐽</ci><apply id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><times id="S4.SS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.1"></times><ci id="S4.SS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2">𝑡</ci><ci id="S4.SS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">J^{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_J start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> transformer layer, the outputs corresponding to learnable prompts <math alttext="\tilde{P}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mover accent="true" id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">P</mi><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><ci id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1">~</ci><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\tilde{P}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">over~ start_ARG italic_P end_ARG</annotation></semantics></math> are discarded, and a new set of learnable prompts is injected for each layer.
Whereas, after the <math alttext="J^{th}" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><msup id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">J</mi><mrow id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS2.p2.3.m3.1.1.3.1" xref="S4.SS2.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">𝐽</ci><apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><times id="S4.SS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3.1"></times><ci id="S4.SS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.2">𝑡</ci><ci id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">J^{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_J start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> layer (<math alttext="\mathcal{V}_{J}" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><msub id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">𝒱</mi><mi id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">J</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝒱</ci><ci id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">𝐽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\mathcal{V}_{J}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">caligraphic_V start_POSTSUBSCRIPT italic_J end_POSTSUBSCRIPT</annotation></semantics></math>), the computation is carried on similar to the one described in <a class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2410.05239v2#S3.SS2" title="3.2 Image Encoding ‣ 3 Revisiting CLIP ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">subsection 3.2</span></a> as if the prompts are identical to the token embeddings.
Mathematically,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[c_{i+1},E_{i+1},\tilde{P}_{i+1}]=\mathcal{V}_{i+1}([c_{i},E_{i},\tilde{P}_{i}%
])\qquad\qquad i=J,J+1,\cdots,N_{v}-1" class="ltx_Math" display="block" id="S4.E8.m1.4"><semantics id="S4.E8.m1.4a"><mrow id="S4.E8.m1.4.4.2" xref="S4.E8.m1.4.4.3.cmml"><mrow id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1.3.3" xref="S4.E8.m1.3.3.1.1.3.4.cmml"><mo id="S4.E8.m1.3.3.1.1.3.3.4" stretchy="false" xref="S4.E8.m1.3.3.1.1.3.4.cmml">[</mo><msub id="S4.E8.m1.3.3.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.2.cmml">c</mi><mrow id="S4.E8.m1.3.3.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.3.2" xref="S4.E8.m1.3.3.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E8.m1.3.3.1.1.1.1.1.3.1" xref="S4.E8.m1.3.3.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.E8.m1.3.3.1.1.1.1.1.3.3" xref="S4.E8.m1.3.3.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E8.m1.3.3.1.1.3.3.5" xref="S4.E8.m1.3.3.1.1.3.4.cmml">,</mo><msub id="S4.E8.m1.3.3.1.1.2.2.2" xref="S4.E8.m1.3.3.1.1.2.2.2.cmml"><mi id="S4.E8.m1.3.3.1.1.2.2.2.2" xref="S4.E8.m1.3.3.1.1.2.2.2.2.cmml">E</mi><mrow id="S4.E8.m1.3.3.1.1.2.2.2.3" xref="S4.E8.m1.3.3.1.1.2.2.2.3.cmml"><mi id="S4.E8.m1.3.3.1.1.2.2.2.3.2" xref="S4.E8.m1.3.3.1.1.2.2.2.3.2.cmml">i</mi><mo id="S4.E8.m1.3.3.1.1.2.2.2.3.1" xref="S4.E8.m1.3.3.1.1.2.2.2.3.1.cmml">+</mo><mn id="S4.E8.m1.3.3.1.1.2.2.2.3.3" xref="S4.E8.m1.3.3.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.E8.m1.3.3.1.1.3.3.6" xref="S4.E8.m1.3.3.1.1.3.4.cmml">,</mo><msub id="S4.E8.m1.3.3.1.1.3.3.3" xref="S4.E8.m1.3.3.1.1.3.3.3.cmml"><mover accent="true" id="S4.E8.m1.3.3.1.1.3.3.3.2" xref="S4.E8.m1.3.3.1.1.3.3.3.2.cmml"><mi id="S4.E8.m1.3.3.1.1.3.3.3.2.2" xref="S4.E8.m1.3.3.1.1.3.3.3.2.2.cmml">P</mi><mo id="S4.E8.m1.3.3.1.1.3.3.3.2.1" xref="S4.E8.m1.3.3.1.1.3.3.3.2.1.cmml">~</mo></mover><mrow id="S4.E8.m1.3.3.1.1.3.3.3.3" xref="S4.E8.m1.3.3.1.1.3.3.3.3.cmml"><mi id="S4.E8.m1.3.3.1.1.3.3.3.3.2" xref="S4.E8.m1.3.3.1.1.3.3.3.3.2.cmml">i</mi><mo id="S4.E8.m1.3.3.1.1.3.3.3.3.1" xref="S4.E8.m1.3.3.1.1.3.3.3.3.1.cmml">+</mo><mn id="S4.E8.m1.3.3.1.1.3.3.3.3.3" xref="S4.E8.m1.3.3.1.1.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.E8.m1.3.3.1.1.3.3.7" stretchy="false" xref="S4.E8.m1.3.3.1.1.3.4.cmml">]</mo></mrow><mo id="S4.E8.m1.3.3.1.1.5" xref="S4.E8.m1.3.3.1.1.5.cmml">=</mo><mrow id="S4.E8.m1.3.3.1.1.4" xref="S4.E8.m1.3.3.1.1.4.cmml"><msub id="S4.E8.m1.3.3.1.1.4.3" xref="S4.E8.m1.3.3.1.1.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.3.3.1.1.4.3.2" xref="S4.E8.m1.3.3.1.1.4.3.2.cmml">𝒱</mi><mrow id="S4.E8.m1.3.3.1.1.4.3.3" xref="S4.E8.m1.3.3.1.1.4.3.3.cmml"><mi id="S4.E8.m1.3.3.1.1.4.3.3.2" xref="S4.E8.m1.3.3.1.1.4.3.3.2.cmml">i</mi><mo id="S4.E8.m1.3.3.1.1.4.3.3.1" xref="S4.E8.m1.3.3.1.1.4.3.3.1.cmml">+</mo><mn id="S4.E8.m1.3.3.1.1.4.3.3.3" xref="S4.E8.m1.3.3.1.1.4.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.E8.m1.3.3.1.1.4.2" xref="S4.E8.m1.3.3.1.1.4.2.cmml">⁢</mo><mrow id="S4.E8.m1.3.3.1.1.4.1.1" xref="S4.E8.m1.3.3.1.1.4.cmml"><mo id="S4.E8.m1.3.3.1.1.4.1.1.2" stretchy="false" xref="S4.E8.m1.3.3.1.1.4.cmml">(</mo><mrow id="S4.E8.m1.3.3.1.1.4.1.1.1.3" xref="S4.E8.m1.3.3.1.1.4.1.1.1.4.cmml"><mo id="S4.E8.m1.3.3.1.1.4.1.1.1.3.4" stretchy="false" xref="S4.E8.m1.3.3.1.1.4.1.1.1.4.cmml">[</mo><msub id="S4.E8.m1.3.3.1.1.4.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.4.1.1.1.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.4.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.4.1.1.1.1.1.2.cmml">c</mi><mi id="S4.E8.m1.3.3.1.1.4.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E8.m1.3.3.1.1.4.1.1.1.3.5" xref="S4.E8.m1.3.3.1.1.4.1.1.1.4.cmml">,</mo><msub id="S4.E8.m1.3.3.1.1.4.1.1.1.2.2" xref="S4.E8.m1.3.3.1.1.4.1.1.1.2.2.cmml"><mi id="S4.E8.m1.3.3.1.1.4.1.1.1.2.2.2" xref="S4.E8.m1.3.3.1.1.4.1.1.1.2.2.2.cmml">E</mi><mi id="S4.E8.m1.3.3.1.1.4.1.1.1.2.2.3" xref="S4.E8.m1.3.3.1.1.4.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.E8.m1.3.3.1.1.4.1.1.1.3.6" xref="S4.E8.m1.3.3.1.1.4.1.1.1.4.cmml">,</mo><msub id="S4.E8.m1.3.3.1.1.4.1.1.1.3.3" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.cmml"><mover accent="true" id="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2.cmml"><mi id="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2.2" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2.2.cmml">P</mi><mo id="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2.1" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2.1.cmml">~</mo></mover><mi id="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.3" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.3.cmml">i</mi></msub><mo id="S4.E8.m1.3.3.1.1.4.1.1.1.3.7" stretchy="false" xref="S4.E8.m1.3.3.1.1.4.1.1.1.4.cmml">]</mo></mrow><mo id="S4.E8.m1.3.3.1.1.4.1.1.3" stretchy="false" xref="S4.E8.m1.3.3.1.1.4.cmml">)</mo></mrow></mrow></mrow><mspace id="S4.E8.m1.4.4.2.3" width="4em" xref="S4.E8.m1.4.4.3a.cmml"></mspace><mrow id="S4.E8.m1.4.4.2.2" xref="S4.E8.m1.4.4.2.2.cmml"><mi id="S4.E8.m1.4.4.2.2.4" xref="S4.E8.m1.4.4.2.2.4.cmml">i</mi><mo id="S4.E8.m1.4.4.2.2.3" xref="S4.E8.m1.4.4.2.2.3.cmml">=</mo><mrow id="S4.E8.m1.4.4.2.2.2.2" xref="S4.E8.m1.4.4.2.2.2.3.cmml"><mi id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml">J</mi><mo id="S4.E8.m1.4.4.2.2.2.2.3" xref="S4.E8.m1.4.4.2.2.2.3.cmml">,</mo><mrow id="S4.E8.m1.4.4.2.2.1.1.1" xref="S4.E8.m1.4.4.2.2.1.1.1.cmml"><mi id="S4.E8.m1.4.4.2.2.1.1.1.2" xref="S4.E8.m1.4.4.2.2.1.1.1.2.cmml">J</mi><mo id="S4.E8.m1.4.4.2.2.1.1.1.1" xref="S4.E8.m1.4.4.2.2.1.1.1.1.cmml">+</mo><mn id="S4.E8.m1.4.4.2.2.1.1.1.3" xref="S4.E8.m1.4.4.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E8.m1.4.4.2.2.2.2.4" xref="S4.E8.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S4.E8.m1.2.2" mathvariant="normal" xref="S4.E8.m1.2.2.cmml">⋯</mi><mo id="S4.E8.m1.4.4.2.2.2.2.5" xref="S4.E8.m1.4.4.2.2.2.3.cmml">,</mo><mrow id="S4.E8.m1.4.4.2.2.2.2.2" xref="S4.E8.m1.4.4.2.2.2.2.2.cmml"><msub id="S4.E8.m1.4.4.2.2.2.2.2.2" xref="S4.E8.m1.4.4.2.2.2.2.2.2.cmml"><mi id="S4.E8.m1.4.4.2.2.2.2.2.2.2" xref="S4.E8.m1.4.4.2.2.2.2.2.2.2.cmml">N</mi><mi id="S4.E8.m1.4.4.2.2.2.2.2.2.3" xref="S4.E8.m1.4.4.2.2.2.2.2.2.3.cmml">v</mi></msub><mo id="S4.E8.m1.4.4.2.2.2.2.2.1" xref="S4.E8.m1.4.4.2.2.2.2.2.1.cmml">−</mo><mn id="S4.E8.m1.4.4.2.2.2.2.2.3" xref="S4.E8.m1.4.4.2.2.2.2.2.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.4b"><apply id="S4.E8.m1.4.4.3.cmml" xref="S4.E8.m1.4.4.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.3a.cmml" xref="S4.E8.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1.1"><eq id="S4.E8.m1.3.3.1.1.5.cmml" xref="S4.E8.m1.3.3.1.1.5"></eq><list id="S4.E8.m1.3.3.1.1.3.4.cmml" xref="S4.E8.m1.3.3.1.1.3.3"><apply id="S4.E8.m1.3.3.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.2">𝑐</ci><apply id="S4.E8.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.3"><plus id="S4.E8.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.3.1"></plus><ci id="S4.E8.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.3.2">𝑖</ci><cn id="S4.E8.m1.3.3.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E8.m1.3.3.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E8.m1.3.3.1.1.2.2.2.cmml" xref="S4.E8.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.2.2.2.1.cmml" xref="S4.E8.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E8.m1.3.3.1.1.2.2.2.2">𝐸</ci><apply id="S4.E8.m1.3.3.1.1.2.2.2.3.cmml" xref="S4.E8.m1.3.3.1.1.2.2.2.3"><plus id="S4.E8.m1.3.3.1.1.2.2.2.3.1.cmml" xref="S4.E8.m1.3.3.1.1.2.2.2.3.1"></plus><ci id="S4.E8.m1.3.3.1.1.2.2.2.3.2.cmml" xref="S4.E8.m1.3.3.1.1.2.2.2.3.2">𝑖</ci><cn id="S4.E8.m1.3.3.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.E8.m1.3.3.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="S4.E8.m1.3.3.1.1.3.3.3.cmml" xref="S4.E8.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.3.3.3.1.cmml" xref="S4.E8.m1.3.3.1.1.3.3.3">subscript</csymbol><apply id="S4.E8.m1.3.3.1.1.3.3.3.2.cmml" xref="S4.E8.m1.3.3.1.1.3.3.3.2"><ci id="S4.E8.m1.3.3.1.1.3.3.3.2.1.cmml" xref="S4.E8.m1.3.3.1.1.3.3.3.2.1">~</ci><ci id="S4.E8.m1.3.3.1.1.3.3.3.2.2.cmml" xref="S4.E8.m1.3.3.1.1.3.3.3.2.2">𝑃</ci></apply><apply id="S4.E8.m1.3.3.1.1.3.3.3.3.cmml" xref="S4.E8.m1.3.3.1.1.3.3.3.3"><plus id="S4.E8.m1.3.3.1.1.3.3.3.3.1.cmml" xref="S4.E8.m1.3.3.1.1.3.3.3.3.1"></plus><ci id="S4.E8.m1.3.3.1.1.3.3.3.3.2.cmml" xref="S4.E8.m1.3.3.1.1.3.3.3.3.2">𝑖</ci><cn id="S4.E8.m1.3.3.1.1.3.3.3.3.3.cmml" type="integer" xref="S4.E8.m1.3.3.1.1.3.3.3.3.3">1</cn></apply></apply></list><apply id="S4.E8.m1.3.3.1.1.4.cmml" xref="S4.E8.m1.3.3.1.1.4"><times id="S4.E8.m1.3.3.1.1.4.2.cmml" xref="S4.E8.m1.3.3.1.1.4.2"></times><apply id="S4.E8.m1.3.3.1.1.4.3.cmml" xref="S4.E8.m1.3.3.1.1.4.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.4.3.1.cmml" xref="S4.E8.m1.3.3.1.1.4.3">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.4.3.2.cmml" xref="S4.E8.m1.3.3.1.1.4.3.2">𝒱</ci><apply id="S4.E8.m1.3.3.1.1.4.3.3.cmml" xref="S4.E8.m1.3.3.1.1.4.3.3"><plus id="S4.E8.m1.3.3.1.1.4.3.3.1.cmml" xref="S4.E8.m1.3.3.1.1.4.3.3.1"></plus><ci id="S4.E8.m1.3.3.1.1.4.3.3.2.cmml" xref="S4.E8.m1.3.3.1.1.4.3.3.2">𝑖</ci><cn id="S4.E8.m1.3.3.1.1.4.3.3.3.cmml" type="integer" xref="S4.E8.m1.3.3.1.1.4.3.3.3">1</cn></apply></apply><list id="S4.E8.m1.3.3.1.1.4.1.1.1.4.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3"><apply id="S4.E8.m1.3.3.1.1.4.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.4.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.4.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.1.1.2">𝑐</ci><ci id="S4.E8.m1.3.3.1.1.4.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E8.m1.3.3.1.1.4.1.1.1.2.2.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.4.1.1.1.2.2.1.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.2.2">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.4.1.1.1.2.2.2.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.2.2.2">𝐸</ci><ci id="S4.E8.m1.3.3.1.1.4.1.1.1.2.2.3.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.1.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3.3">subscript</csymbol><apply id="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2"><ci id="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2.1.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2.1">~</ci><ci id="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2.2.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.2.2">𝑃</ci></apply><ci id="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.3.cmml" xref="S4.E8.m1.3.3.1.1.4.1.1.1.3.3.3">𝑖</ci></apply></list></apply></apply><apply id="S4.E8.m1.4.4.2.2.cmml" xref="S4.E8.m1.4.4.2.2"><eq id="S4.E8.m1.4.4.2.2.3.cmml" xref="S4.E8.m1.4.4.2.2.3"></eq><ci id="S4.E8.m1.4.4.2.2.4.cmml" xref="S4.E8.m1.4.4.2.2.4">𝑖</ci><list id="S4.E8.m1.4.4.2.2.2.3.cmml" xref="S4.E8.m1.4.4.2.2.2.2"><ci id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1">𝐽</ci><apply id="S4.E8.m1.4.4.2.2.1.1.1.cmml" xref="S4.E8.m1.4.4.2.2.1.1.1"><plus id="S4.E8.m1.4.4.2.2.1.1.1.1.cmml" xref="S4.E8.m1.4.4.2.2.1.1.1.1"></plus><ci id="S4.E8.m1.4.4.2.2.1.1.1.2.cmml" xref="S4.E8.m1.4.4.2.2.1.1.1.2">𝐽</ci><cn id="S4.E8.m1.4.4.2.2.1.1.1.3.cmml" type="integer" xref="S4.E8.m1.4.4.2.2.1.1.1.3">1</cn></apply><ci id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2">⋯</ci><apply id="S4.E8.m1.4.4.2.2.2.2.2.cmml" xref="S4.E8.m1.4.4.2.2.2.2.2"><minus id="S4.E8.m1.4.4.2.2.2.2.2.1.cmml" xref="S4.E8.m1.4.4.2.2.2.2.2.1"></minus><apply id="S4.E8.m1.4.4.2.2.2.2.2.2.cmml" xref="S4.E8.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.2.2.2.2.2.2.1.cmml" xref="S4.E8.m1.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E8.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S4.E8.m1.4.4.2.2.2.2.2.2.2">𝑁</ci><ci id="S4.E8.m1.4.4.2.2.2.2.2.2.3.cmml" xref="S4.E8.m1.4.4.2.2.2.2.2.2.3">𝑣</ci></apply><cn id="S4.E8.m1.4.4.2.2.2.2.2.3.cmml" type="integer" xref="S4.E8.m1.4.4.2.2.2.2.2.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.4c">[c_{i+1},E_{i+1},\tilde{P}_{i+1}]=\mathcal{V}_{i+1}([c_{i},E_{i},\tilde{P}_{i}%
])\qquad\qquad i=J,J+1,\cdots,N_{v}-1</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.4d">[ italic_c start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ] = caligraphic_V start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ( [ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] ) italic_i = italic_J , italic_J + 1 , ⋯ , italic_N start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT - 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Multimodal Prompt Tuning</h3>
<figure class="ltx_figure" id="S4.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf1"><img alt="Refer to caption" class="ltx_graphics" id="S4.F2.sf1.g1" src="coop_arch"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F2.sf1.3.2" style="font-size:90%;">CoOp Overview</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf2"><img alt="Refer to caption" class="ltx_graphics" id="S4.F2.sf2.g1" src="cocoop_arch"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F2.sf2.3.2" style="font-size:90%;">CoCoOp Overview</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf3"><img alt="Refer to caption" class="ltx_graphics" id="S4.F2.sf3.g1" src="vpt_arch"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S4.F2.sf3.3.2" style="font-size:90%;">VPT Overview</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf4"><img alt="Refer to caption" class="ltx_graphics" id="S4.F2.sf4.g1" src="maple_arch"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf4.2.1.1" style="font-size:90%;">(d)</span> </span><span class="ltx_text" id="S4.F2.sf4.3.2" style="font-size:90%;">Maple Overview</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf5"><img alt="Refer to caption" class="ltx_graphics" id="S4.F2.sf5.g1" src="shared_attn_arch"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf5.2.1.1" style="font-size:90%;">(e)</span> </span><span class="ltx_text" id="S4.F2.sf5.3.2" style="font-size:90%;">Shared Attention Overview</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf6"><img alt="Refer to caption" class="ltx_graphics" id="S4.F2.sf6.g1" src="shared_separate_arch"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf6.2.1.1" style="font-size:90%;">(f)</span> </span><span class="ltx_text" id="S4.F2.sf6.3.2" style="font-size:90%;">Shared Separate Overview</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">
Overview of various prompt tuning methods.
In the first row, there are unimodal prompt tuning methods and the second row shows the multimodal prompt tuning methods.
The prompting for only the first layer is shown here, the same concept is applicable when the prompt tuning is done for multiple transformer blocks.
</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.5">Multimodal approaches to prompt tuning were devised to adjust the output for both the encoders.
Similar to unimodal prompt tuning, we assign <math alttext="B" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_B</annotation></semantics></math> tokens to each transformer layer <math alttext="i" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_i</annotation></semantics></math> till the prompt depth <math alttext="J" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">J</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">italic_J</annotation></semantics></math> for CLIP’s text and vision encoders, as <math alttext="P_{i}\in\mathbb{R}^{B\times H_{l}}" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><mrow id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><msub id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2.2" xref="S4.SS3.p1.4.m4.1.1.2.2.cmml">P</mi><mi id="S4.SS3.p1.4.m4.1.1.2.3" xref="S4.SS3.p1.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS3.p1.4.m4.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.2" xref="S4.SS3.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.4.m4.1.1.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.3.2" xref="S4.SS3.p1.4.m4.1.1.3.3.2.cmml">B</mi><mo id="S4.SS3.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S4.SS3.p1.4.m4.1.1.3.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.3.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.3.3.2" xref="S4.SS3.p1.4.m4.1.1.3.3.3.2.cmml">H</mi><mi id="S4.SS3.p1.4.m4.1.1.3.3.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.3.3.cmml">l</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><in id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1"></in><apply id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.2.1.cmml" xref="S4.SS3.p1.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.2.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2.2">𝑃</ci><ci id="S4.SS3.p1.4.m4.1.1.2.3.cmml" xref="S4.SS3.p1.4.m4.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S4.SS3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3"><times id="S4.SS3.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.1"></times><ci id="S4.SS3.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.2">𝐵</ci><apply id="S4.SS3.p1.4.m4.1.1.3.3.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.3.3.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.3.3.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.3.2">𝐻</ci><ci id="S4.SS3.p1.4.m4.1.1.3.3.3.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">P_{i}\in\mathbb{R}^{B\times H_{l}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\tilde{P}_{i}\in\mathbb{R}^{B\times H_{v}}" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m5.1"><semantics id="S4.SS3.p1.5.m5.1a"><mrow id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><msub id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml"><mover accent="true" id="S4.SS3.p1.5.m5.1.1.2.2" xref="S4.SS3.p1.5.m5.1.1.2.2.cmml"><mi id="S4.SS3.p1.5.m5.1.1.2.2.2" xref="S4.SS3.p1.5.m5.1.1.2.2.2.cmml">P</mi><mo id="S4.SS3.p1.5.m5.1.1.2.2.1" xref="S4.SS3.p1.5.m5.1.1.2.2.1.cmml">~</mo></mover><mi id="S4.SS3.p1.5.m5.1.1.2.3" xref="S4.SS3.p1.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS3.p1.5.m5.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml"><mi id="S4.SS3.p1.5.m5.1.1.3.2" xref="S4.SS3.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.5.m5.1.1.3.3" xref="S4.SS3.p1.5.m5.1.1.3.3.cmml"><mi id="S4.SS3.p1.5.m5.1.1.3.3.2" xref="S4.SS3.p1.5.m5.1.1.3.3.2.cmml">B</mi><mo id="S4.SS3.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S4.SS3.p1.5.m5.1.1.3.3.3" xref="S4.SS3.p1.5.m5.1.1.3.3.3.cmml"><mi id="S4.SS3.p1.5.m5.1.1.3.3.3.2" xref="S4.SS3.p1.5.m5.1.1.3.3.3.2.cmml">H</mi><mi id="S4.SS3.p1.5.m5.1.1.3.3.3.3" xref="S4.SS3.p1.5.m5.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><in id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1"></in><apply id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.2.1.cmml" xref="S4.SS3.p1.5.m5.1.1.2">subscript</csymbol><apply id="S4.SS3.p1.5.m5.1.1.2.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2.2"><ci id="S4.SS3.p1.5.m5.1.1.2.2.1.cmml" xref="S4.SS3.p1.5.m5.1.1.2.2.1">~</ci><ci id="S4.SS3.p1.5.m5.1.1.2.2.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2.2.2">𝑃</ci></apply><ci id="S4.SS3.p1.5.m5.1.1.2.3.cmml" xref="S4.SS3.p1.5.m5.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.3.1.cmml" xref="S4.SS3.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.5.m5.1.1.3.2.cmml" xref="S4.SS3.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S4.SS3.p1.5.m5.1.1.3.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3.3"><times id="S4.SS3.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS3.p1.5.m5.1.1.3.3.1"></times><ci id="S4.SS3.p1.5.m5.1.1.3.3.2.cmml" xref="S4.SS3.p1.5.m5.1.1.3.3.2">𝐵</ci><apply id="S4.SS3.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.3.3.3.1.cmml" xref="S4.SS3.p1.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S4.SS3.p1.5.m5.1.1.3.3.3.2.cmml" xref="S4.SS3.p1.5.m5.1.1.3.3.3.2">𝐻</ci><ci id="S4.SS3.p1.5.m5.1.1.3.3.3.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">\tilde{P}_{i}\in\mathbb{R}^{B\times H_{v}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m5.1d">over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, respectively.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.5">A straightforward way to implement the multimodal prompt tuning is to learn both textual (<math alttext="P_{i}" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><msub id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">P</mi><mi id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝑃</ci><ci id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">P_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>) and visual (<math alttext="\tilde{P}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><msub id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mover accent="true" id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2.2" xref="S4.SS3.p2.2.m2.1.1.2.2.cmml">P</mi><mo id="S4.SS3.p2.2.m2.1.1.2.1" xref="S4.SS3.p2.2.m2.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">subscript</csymbol><apply id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2"><ci id="S4.SS3.p2.2.m2.1.1.2.1.cmml" xref="S4.SS3.p2.2.m2.1.1.2.1">~</ci><ci id="S4.SS3.p2.2.m2.1.1.2.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2.2">𝑃</ci></apply><ci id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\tilde{P}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>) prompts independently in the same training schedule.
However, studies have shown that such a naive training strategy leads to sub-optimal performance due to the lack of interaction between the vision and language branches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib53" title="">53</a>]</cite>.
The interaction between the two modalities can be achieved by introducing unified prompts for each transformer layer <math alttext="i" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1"><semantics id="S4.SS3.p2.3.m3.1a"><mi id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">italic_i</annotation></semantics></math>, denoted by <math alttext="\hat{P}_{i}\in\mathbb{R}^{B\times H_{u}}" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><mrow id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><msub id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml"><mover accent="true" id="S4.SS3.p2.4.m4.1.1.2.2" xref="S4.SS3.p2.4.m4.1.1.2.2.cmml"><mi id="S4.SS3.p2.4.m4.1.1.2.2.2" xref="S4.SS3.p2.4.m4.1.1.2.2.2.cmml">P</mi><mo id="S4.SS3.p2.4.m4.1.1.2.2.1" xref="S4.SS3.p2.4.m4.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS3.p2.4.m4.1.1.2.3" xref="S4.SS3.p2.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS3.p2.4.m4.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml"><mi id="S4.SS3.p2.4.m4.1.1.3.2" xref="S4.SS3.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p2.4.m4.1.1.3.3" xref="S4.SS3.p2.4.m4.1.1.3.3.cmml"><mi id="S4.SS3.p2.4.m4.1.1.3.3.2" xref="S4.SS3.p2.4.m4.1.1.3.3.2.cmml">B</mi><mo id="S4.SS3.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S4.SS3.p2.4.m4.1.1.3.3.3" xref="S4.SS3.p2.4.m4.1.1.3.3.3.cmml"><mi id="S4.SS3.p2.4.m4.1.1.3.3.3.2" xref="S4.SS3.p2.4.m4.1.1.3.3.3.2.cmml">H</mi><mi id="S4.SS3.p2.4.m4.1.1.3.3.3.3" xref="S4.SS3.p2.4.m4.1.1.3.3.3.3.cmml">u</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><in id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1"></in><apply id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.2.1.cmml" xref="S4.SS3.p2.4.m4.1.1.2">subscript</csymbol><apply id="S4.SS3.p2.4.m4.1.1.2.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2.2"><ci id="S4.SS3.p2.4.m4.1.1.2.2.1.cmml" xref="S4.SS3.p2.4.m4.1.1.2.2.1">^</ci><ci id="S4.SS3.p2.4.m4.1.1.2.2.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2.2.2">𝑃</ci></apply><ci id="S4.SS3.p2.4.m4.1.1.2.3.cmml" xref="S4.SS3.p2.4.m4.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.p2.4.m4.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.3.1.cmml" xref="S4.SS3.p2.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.4.m4.1.1.3.2.cmml" xref="S4.SS3.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S4.SS3.p2.4.m4.1.1.3.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3"><times id="S4.SS3.p2.4.m4.1.1.3.3.1.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3.1"></times><ci id="S4.SS3.p2.4.m4.1.1.3.3.2.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3.2">𝐵</ci><apply id="S4.SS3.p2.4.m4.1.1.3.3.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.3.3.3.1.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S4.SS3.p2.4.m4.1.1.3.3.3.2.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3.3.2">𝐻</ci><ci id="S4.SS3.p2.4.m4.1.1.3.3.3.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3.3.3.3">𝑢</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">\hat{P}_{i}\in\mathbb{R}^{B\times H_{u}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_H start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
Here, <math alttext="H_{u}" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m5.1"><semantics id="S4.SS3.p2.5.m5.1a"><msub id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml"><mi id="S4.SS3.p2.5.m5.1.1.2" xref="S4.SS3.p2.5.m5.1.1.2.cmml">H</mi><mi id="S4.SS3.p2.5.m5.1.1.3" xref="S4.SS3.p2.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><apply id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m5.1.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p2.5.m5.1.1.2.cmml" xref="S4.SS3.p2.5.m5.1.1.2">𝐻</ci><ci id="S4.SS3.p2.5.m5.1.1.3.cmml" xref="S4.SS3.p2.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">H_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m5.1d">italic_H start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, a hyperparameter, is the dimension of the unified prompt.
We obtain visual and textual prompts from the corresponding unified prompts as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[P_{i},\tilde{P}_{i}]=\mathcal{U}_{i}(\hat{P}_{i})" class="ltx_Math" display="block" id="S4.E9.m1.3"><semantics id="S4.E9.m1.3a"><mrow id="S4.E9.m1.3.3" xref="S4.E9.m1.3.3.cmml"><mrow id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.3.cmml"><mo id="S4.E9.m1.2.2.2.2.3" stretchy="false" xref="S4.E9.m1.2.2.2.3.cmml">[</mo><msub id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.2.cmml">P</mi><mi id="S4.E9.m1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E9.m1.2.2.2.2.4" xref="S4.E9.m1.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.cmml"><mover accent="true" id="S4.E9.m1.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.2.cmml"><mi id="S4.E9.m1.2.2.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.2.2.cmml">P</mi><mo id="S4.E9.m1.2.2.2.2.2.2.1" xref="S4.E9.m1.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S4.E9.m1.2.2.2.2.2.3" xref="S4.E9.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E9.m1.2.2.2.2.5" stretchy="false" xref="S4.E9.m1.2.2.2.3.cmml">]</mo></mrow><mo id="S4.E9.m1.3.3.4" xref="S4.E9.m1.3.3.4.cmml">=</mo><mrow id="S4.E9.m1.3.3.3" xref="S4.E9.m1.3.3.3.cmml"><msub id="S4.E9.m1.3.3.3.3" xref="S4.E9.m1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.3.3.3.3.2" xref="S4.E9.m1.3.3.3.3.2.cmml">𝒰</mi><mi id="S4.E9.m1.3.3.3.3.3" xref="S4.E9.m1.3.3.3.3.3.cmml">i</mi></msub><mo id="S4.E9.m1.3.3.3.2" xref="S4.E9.m1.3.3.3.2.cmml">⁢</mo><mrow id="S4.E9.m1.3.3.3.1.1" xref="S4.E9.m1.3.3.3.1.1.1.cmml"><mo id="S4.E9.m1.3.3.3.1.1.2" stretchy="false" xref="S4.E9.m1.3.3.3.1.1.1.cmml">(</mo><msub id="S4.E9.m1.3.3.3.1.1.1" xref="S4.E9.m1.3.3.3.1.1.1.cmml"><mover accent="true" id="S4.E9.m1.3.3.3.1.1.1.2" xref="S4.E9.m1.3.3.3.1.1.1.2.cmml"><mi id="S4.E9.m1.3.3.3.1.1.1.2.2" xref="S4.E9.m1.3.3.3.1.1.1.2.2.cmml">P</mi><mo id="S4.E9.m1.3.3.3.1.1.1.2.1" xref="S4.E9.m1.3.3.3.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E9.m1.3.3.3.1.1.1.3" xref="S4.E9.m1.3.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S4.E9.m1.3.3.3.1.1.3" stretchy="false" xref="S4.E9.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.3b"><apply id="S4.E9.m1.3.3.cmml" xref="S4.E9.m1.3.3"><eq id="S4.E9.m1.3.3.4.cmml" xref="S4.E9.m1.3.3.4"></eq><interval closure="closed" id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2"><apply id="S4.E9.m1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.2">𝑃</ci><ci id="S4.E9.m1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E9.m1.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.2.2.2">subscript</csymbol><apply id="S4.E9.m1.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2"><ci id="S4.E9.m1.2.2.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.2.2.2.2.1">~</ci><ci id="S4.E9.m1.2.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2.2">𝑃</ci></apply><ci id="S4.E9.m1.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.3">𝑖</ci></apply></interval><apply id="S4.E9.m1.3.3.3.cmml" xref="S4.E9.m1.3.3.3"><times id="S4.E9.m1.3.3.3.2.cmml" xref="S4.E9.m1.3.3.3.2"></times><apply id="S4.E9.m1.3.3.3.3.cmml" xref="S4.E9.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.3.1.cmml" xref="S4.E9.m1.3.3.3.3">subscript</csymbol><ci id="S4.E9.m1.3.3.3.3.2.cmml" xref="S4.E9.m1.3.3.3.3.2">𝒰</ci><ci id="S4.E9.m1.3.3.3.3.3.cmml" xref="S4.E9.m1.3.3.3.3.3">𝑖</ci></apply><apply id="S4.E9.m1.3.3.3.1.1.1.cmml" xref="S4.E9.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.1.1.1.1.cmml" xref="S4.E9.m1.3.3.3.1.1">subscript</csymbol><apply id="S4.E9.m1.3.3.3.1.1.1.2.cmml" xref="S4.E9.m1.3.3.3.1.1.1.2"><ci id="S4.E9.m1.3.3.3.1.1.1.2.1.cmml" xref="S4.E9.m1.3.3.3.1.1.1.2.1">^</ci><ci id="S4.E9.m1.3.3.3.1.1.1.2.2.cmml" xref="S4.E9.m1.3.3.3.1.1.1.2.2">𝑃</ci></apply><ci id="S4.E9.m1.3.3.3.1.1.1.3.cmml" xref="S4.E9.m1.3.3.3.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.3c">[P_{i},\tilde{P}_{i}]=\mathcal{U}_{i}(\hat{P}_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.3d">[ italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ] = caligraphic_U start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.7">Here, <math alttext="\mathcal{U}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><msub id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml">𝒰</mi><mi id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2">𝒰</ci><ci id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\mathcal{U}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">caligraphic_U start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is a learnable function that transforms unified prompts <math alttext="\hat{P}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><msub id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mover accent="true" id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2.2" xref="S4.SS3.p3.2.m2.1.1.2.2.cmml">P</mi><mo id="S4.SS3.p3.2.m2.1.1.2.1" xref="S4.SS3.p3.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">subscript</csymbol><apply id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2"><ci id="S4.SS3.p3.2.m2.1.1.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.2.1">^</ci><ci id="S4.SS3.p3.2.m2.1.1.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2.2">𝑃</ci></apply><ci id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">\hat{P}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for each transformer layer <math alttext="i" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.1"><semantics id="S4.SS3.p3.3.m3.1a"><mi id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><ci id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.1d">italic_i</annotation></semantics></math> into corresponding textual <math alttext="P_{i}" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m4.1"><semantics id="S4.SS3.p3.4.m4.1a"><msub id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml"><mi id="S4.SS3.p3.4.m4.1.1.2" xref="S4.SS3.p3.4.m4.1.1.2.cmml">P</mi><mi id="S4.SS3.p3.4.m4.1.1.3" xref="S4.SS3.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><apply id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.1.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p3.4.m4.1.1.2.cmml" xref="S4.SS3.p3.4.m4.1.1.2">𝑃</ci><ci id="S4.SS3.p3.4.m4.1.1.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">P_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and visual <math alttext="\tilde{P}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p3.5.m5.1"><semantics id="S4.SS3.p3.5.m5.1a"><msub id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml"><mover accent="true" id="S4.SS3.p3.5.m5.1.1.2" xref="S4.SS3.p3.5.m5.1.1.2.cmml"><mi id="S4.SS3.p3.5.m5.1.1.2.2" xref="S4.SS3.p3.5.m5.1.1.2.2.cmml">P</mi><mo id="S4.SS3.p3.5.m5.1.1.2.1" xref="S4.SS3.p3.5.m5.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS3.p3.5.m5.1.1.3" xref="S4.SS3.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><apply id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">subscript</csymbol><apply id="S4.SS3.p3.5.m5.1.1.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2"><ci id="S4.SS3.p3.5.m5.1.1.2.1.cmml" xref="S4.SS3.p3.5.m5.1.1.2.1">~</ci><ci id="S4.SS3.p3.5.m5.1.1.2.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2.2">𝑃</ci></apply><ci id="S4.SS3.p3.5.m5.1.1.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">\tilde{P}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.5.m5.1d">over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> prompts.
Some architectures of functions <math alttext="\mathcal{U}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p3.6.m6.1"><semantics id="S4.SS3.p3.6.m6.1a"><msub id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.6.m6.1.1.2" xref="S4.SS3.p3.6.m6.1.1.2.cmml">𝒰</mi><mi id="S4.SS3.p3.6.m6.1.1.3" xref="S4.SS3.p3.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b"><apply id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.1.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2">𝒰</ci><ci id="S4.SS3.p3.6.m6.1.1.3.cmml" xref="S4.SS3.p3.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.1c">\mathcal{U}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.6.m6.1d">caligraphic_U start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are self-attention mechanisms, multi-layer perception, or a mixture of both.
For this work, we use a transformer block for each <math alttext="\mathcal{U}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p3.7.m7.1"><semantics id="S4.SS3.p3.7.m7.1a"><msub id="S4.SS3.p3.7.m7.1.1" xref="S4.SS3.p3.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.7.m7.1.1.2" xref="S4.SS3.p3.7.m7.1.1.2.cmml">𝒰</mi><mi id="S4.SS3.p3.7.m7.1.1.3" xref="S4.SS3.p3.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b"><apply id="S4.SS3.p3.7.m7.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m7.1.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p3.7.m7.1.1.2.cmml" xref="S4.SS3.p3.7.m7.1.1.2">𝒰</ci><ci id="S4.SS3.p3.7.m7.1.1.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m7.1c">\mathcal{U}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.7.m7.1d">caligraphic_U start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as one of the methods of multimodal prompt tuning, named <span class="ltx_text ltx_font_italic" id="S4.SS3.p3.7.1">Shared Attention</span> (see <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S4.F2.sf5" title="In Figure 2 ‣ 4.3 Multimodal Prompt Tuning ‣ 4 Revisiting Prompt Tuning ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(e)</span></a>).</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.2">One specialized case of these transformations is when the transformations are split into separate components of text and vision transformations, viz. <math alttext="\mathcal{U}^{l}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p4.1.m1.1"><semantics id="S4.SS3.p4.1.m1.1a"><msubsup id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p4.1.m1.1.1.2.2" xref="S4.SS3.p4.1.m1.1.1.2.2.cmml">𝒰</mi><mi id="S4.SS3.p4.1.m1.1.1.3" xref="S4.SS3.p4.1.m1.1.1.3.cmml">i</mi><mi id="S4.SS3.p4.1.m1.1.1.2.3" xref="S4.SS3.p4.1.m1.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><apply id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.p4.1.m1.1.1.2.cmml" xref="S4.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.1.m1.1.1.2.1.cmml" xref="S4.SS3.p4.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.p4.1.m1.1.1.2.2.cmml" xref="S4.SS3.p4.1.m1.1.1.2.2">𝒰</ci><ci id="S4.SS3.p4.1.m1.1.1.2.3.cmml" xref="S4.SS3.p4.1.m1.1.1.2.3">𝑙</ci></apply><ci id="S4.SS3.p4.1.m1.1.1.3.cmml" xref="S4.SS3.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">\mathcal{U}^{l}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.m1.1d">caligraphic_U start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{U}^{v}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p4.2.m2.1"><semantics id="S4.SS3.p4.2.m2.1a"><msubsup id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p4.2.m2.1.1.2.2" xref="S4.SS3.p4.2.m2.1.1.2.2.cmml">𝒰</mi><mi id="S4.SS3.p4.2.m2.1.1.3" xref="S4.SS3.p4.2.m2.1.1.3.cmml">i</mi><mi id="S4.SS3.p4.2.m2.1.1.2.3" xref="S4.SS3.p4.2.m2.1.1.2.3.cmml">v</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><apply id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.1.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">subscript</csymbol><apply id="S4.SS3.p4.2.m2.1.1.2.cmml" xref="S4.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.1.1.2.1.cmml" xref="S4.SS3.p4.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.p4.2.m2.1.1.2.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2.2">𝒰</ci><ci id="S4.SS3.p4.2.m2.1.1.2.3.cmml" xref="S4.SS3.p4.2.m2.1.1.2.3">𝑣</ci></apply><ci id="S4.SS3.p4.2.m2.1.1.3.cmml" xref="S4.SS3.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">\mathcal{U}^{v}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.2.m2.1d">caligraphic_U start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> which transform the unified prompts to the corresponding text and vision spaces.
For example, the transformation function is a perceptron (an affine transformation) — and optionally followed by an activation function.
Mathematically,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{U}_{i}(\hat{P}_{i})=[\mathcal{U}^{l}_{i}(\hat{P}_{i}),\mathcal{U}^{v}%
_{i}(\hat{P}_{i})]" class="ltx_Math" display="block" id="S4.E10.m1.3"><semantics id="S4.E10.m1.3a"><mrow id="S4.E10.m1.3.3" xref="S4.E10.m1.3.3.cmml"><mrow id="S4.E10.m1.1.1.1" xref="S4.E10.m1.1.1.1.cmml"><msub id="S4.E10.m1.1.1.1.3" xref="S4.E10.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.3.2.cmml">𝒰</mi><mi id="S4.E10.m1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.E10.m1.1.1.1.2" xref="S4.E10.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E10.m1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.2.2" xref="S4.E10.m1.1.1.1.1.1.1.2.2.cmml">P</mi><mo id="S4.E10.m1.1.1.1.1.1.1.2.1" xref="S4.E10.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E10.m1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E10.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.3.3.4" xref="S4.E10.m1.3.3.4.cmml">=</mo><mrow id="S4.E10.m1.3.3.3.2" xref="S4.E10.m1.3.3.3.3.cmml"><mo id="S4.E10.m1.3.3.3.2.3" stretchy="false" xref="S4.E10.m1.3.3.3.3.cmml">[</mo><mrow id="S4.E10.m1.2.2.2.1.1" xref="S4.E10.m1.2.2.2.1.1.cmml"><msubsup id="S4.E10.m1.2.2.2.1.1.3" xref="S4.E10.m1.2.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.2.2.2.1.1.3.2.2" xref="S4.E10.m1.2.2.2.1.1.3.2.2.cmml">𝒰</mi><mi id="S4.E10.m1.2.2.2.1.1.3.3" xref="S4.E10.m1.2.2.2.1.1.3.3.cmml">i</mi><mi id="S4.E10.m1.2.2.2.1.1.3.2.3" xref="S4.E10.m1.2.2.2.1.1.3.2.3.cmml">l</mi></msubsup><mo id="S4.E10.m1.2.2.2.1.1.2" xref="S4.E10.m1.2.2.2.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.2.2.2.1.1.1.1" xref="S4.E10.m1.2.2.2.1.1.1.1.1.cmml"><mo id="S4.E10.m1.2.2.2.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.2.2.2.1.1.1.1.1.cmml">(</mo><msub id="S4.E10.m1.2.2.2.1.1.1.1.1" xref="S4.E10.m1.2.2.2.1.1.1.1.1.cmml"><mover accent="true" id="S4.E10.m1.2.2.2.1.1.1.1.1.2" xref="S4.E10.m1.2.2.2.1.1.1.1.1.2.cmml"><mi id="S4.E10.m1.2.2.2.1.1.1.1.1.2.2" xref="S4.E10.m1.2.2.2.1.1.1.1.1.2.2.cmml">P</mi><mo id="S4.E10.m1.2.2.2.1.1.1.1.1.2.1" xref="S4.E10.m1.2.2.2.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E10.m1.2.2.2.1.1.1.1.1.3" xref="S4.E10.m1.2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E10.m1.2.2.2.1.1.1.1.3" stretchy="false" xref="S4.E10.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.3.3.3.2.4" xref="S4.E10.m1.3.3.3.3.cmml">,</mo><mrow id="S4.E10.m1.3.3.3.2.2" xref="S4.E10.m1.3.3.3.2.2.cmml"><msubsup id="S4.E10.m1.3.3.3.2.2.3" xref="S4.E10.m1.3.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.3.3.3.2.2.3.2.2" xref="S4.E10.m1.3.3.3.2.2.3.2.2.cmml">𝒰</mi><mi id="S4.E10.m1.3.3.3.2.2.3.3" xref="S4.E10.m1.3.3.3.2.2.3.3.cmml">i</mi><mi id="S4.E10.m1.3.3.3.2.2.3.2.3" xref="S4.E10.m1.3.3.3.2.2.3.2.3.cmml">v</mi></msubsup><mo id="S4.E10.m1.3.3.3.2.2.2" xref="S4.E10.m1.3.3.3.2.2.2.cmml">⁢</mo><mrow id="S4.E10.m1.3.3.3.2.2.1.1" xref="S4.E10.m1.3.3.3.2.2.1.1.1.cmml"><mo id="S4.E10.m1.3.3.3.2.2.1.1.2" stretchy="false" xref="S4.E10.m1.3.3.3.2.2.1.1.1.cmml">(</mo><msub id="S4.E10.m1.3.3.3.2.2.1.1.1" xref="S4.E10.m1.3.3.3.2.2.1.1.1.cmml"><mover accent="true" id="S4.E10.m1.3.3.3.2.2.1.1.1.2" xref="S4.E10.m1.3.3.3.2.2.1.1.1.2.cmml"><mi id="S4.E10.m1.3.3.3.2.2.1.1.1.2.2" xref="S4.E10.m1.3.3.3.2.2.1.1.1.2.2.cmml">P</mi><mo id="S4.E10.m1.3.3.3.2.2.1.1.1.2.1" xref="S4.E10.m1.3.3.3.2.2.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E10.m1.3.3.3.2.2.1.1.1.3" xref="S4.E10.m1.3.3.3.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.E10.m1.3.3.3.2.2.1.1.3" stretchy="false" xref="S4.E10.m1.3.3.3.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.3.3.3.2.5" stretchy="false" xref="S4.E10.m1.3.3.3.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.3b"><apply id="S4.E10.m1.3.3.cmml" xref="S4.E10.m1.3.3"><eq id="S4.E10.m1.3.3.4.cmml" xref="S4.E10.m1.3.3.4"></eq><apply id="S4.E10.m1.1.1.1.cmml" xref="S4.E10.m1.1.1.1"><times id="S4.E10.m1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.2"></times><apply id="S4.E10.m1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.3.2">𝒰</ci><ci id="S4.E10.m1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1">subscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2"><ci id="S4.E10.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E10.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.2">𝑃</ci></apply><ci id="S4.E10.m1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><interval closure="closed" id="S4.E10.m1.3.3.3.3.cmml" xref="S4.E10.m1.3.3.3.2"><apply id="S4.E10.m1.2.2.2.1.1.cmml" xref="S4.E10.m1.2.2.2.1.1"><times id="S4.E10.m1.2.2.2.1.1.2.cmml" xref="S4.E10.m1.2.2.2.1.1.2"></times><apply id="S4.E10.m1.2.2.2.1.1.3.cmml" xref="S4.E10.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.2.1.1.3.1.cmml" xref="S4.E10.m1.2.2.2.1.1.3">subscript</csymbol><apply id="S4.E10.m1.2.2.2.1.1.3.2.cmml" xref="S4.E10.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.2.1.1.3.2.1.cmml" xref="S4.E10.m1.2.2.2.1.1.3">superscript</csymbol><ci id="S4.E10.m1.2.2.2.1.1.3.2.2.cmml" xref="S4.E10.m1.2.2.2.1.1.3.2.2">𝒰</ci><ci id="S4.E10.m1.2.2.2.1.1.3.2.3.cmml" xref="S4.E10.m1.2.2.2.1.1.3.2.3">𝑙</ci></apply><ci id="S4.E10.m1.2.2.2.1.1.3.3.cmml" xref="S4.E10.m1.2.2.2.1.1.3.3">𝑖</ci></apply><apply id="S4.E10.m1.2.2.2.1.1.1.1.1.cmml" xref="S4.E10.m1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E10.m1.2.2.2.1.1.1.1">subscript</csymbol><apply id="S4.E10.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E10.m1.2.2.2.1.1.1.1.1.2"><ci id="S4.E10.m1.2.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.2.2.2.1.1.1.1.1.2.1">^</ci><ci id="S4.E10.m1.2.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.2.2.2.1.1.1.1.1.2.2">𝑃</ci></apply><ci id="S4.E10.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E10.m1.2.2.2.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E10.m1.3.3.3.2.2.cmml" xref="S4.E10.m1.3.3.3.2.2"><times id="S4.E10.m1.3.3.3.2.2.2.cmml" xref="S4.E10.m1.3.3.3.2.2.2"></times><apply id="S4.E10.m1.3.3.3.2.2.3.cmml" xref="S4.E10.m1.3.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.2.2.3.1.cmml" xref="S4.E10.m1.3.3.3.2.2.3">subscript</csymbol><apply id="S4.E10.m1.3.3.3.2.2.3.2.cmml" xref="S4.E10.m1.3.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.2.2.3.2.1.cmml" xref="S4.E10.m1.3.3.3.2.2.3">superscript</csymbol><ci id="S4.E10.m1.3.3.3.2.2.3.2.2.cmml" xref="S4.E10.m1.3.3.3.2.2.3.2.2">𝒰</ci><ci id="S4.E10.m1.3.3.3.2.2.3.2.3.cmml" xref="S4.E10.m1.3.3.3.2.2.3.2.3">𝑣</ci></apply><ci id="S4.E10.m1.3.3.3.2.2.3.3.cmml" xref="S4.E10.m1.3.3.3.2.2.3.3">𝑖</ci></apply><apply id="S4.E10.m1.3.3.3.2.2.1.1.1.cmml" xref="S4.E10.m1.3.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3.2.2.1.1.1.1.cmml" xref="S4.E10.m1.3.3.3.2.2.1.1">subscript</csymbol><apply id="S4.E10.m1.3.3.3.2.2.1.1.1.2.cmml" xref="S4.E10.m1.3.3.3.2.2.1.1.1.2"><ci id="S4.E10.m1.3.3.3.2.2.1.1.1.2.1.cmml" xref="S4.E10.m1.3.3.3.2.2.1.1.1.2.1">^</ci><ci id="S4.E10.m1.3.3.3.2.2.1.1.1.2.2.cmml" xref="S4.E10.m1.3.3.3.2.2.1.1.1.2.2">𝑃</ci></apply><ci id="S4.E10.m1.3.3.3.2.2.1.1.1.3.cmml" xref="S4.E10.m1.3.3.3.2.2.1.1.1.3">𝑖</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.3c">\mathcal{U}_{i}(\hat{P}_{i})=[\mathcal{U}^{l}_{i}(\hat{P}_{i}),\mathcal{U}^{v}%
_{i}(\hat{P}_{i})]</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.3d">caligraphic_U start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = [ caligraphic_U start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , caligraphic_U start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p4.3">Equivalently,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P_{i}=\mathcal{U}^{l}_{i}(\hat{P}_{i})\qquad\tilde{P}_{i}=\mathcal{U}^{v}_{i}(%
\hat{P}_{i})" class="ltx_Math" display="block" id="S4.E11.m1.2"><semantics id="S4.E11.m1.2a"><mrow id="S4.E11.m1.2.2.2" xref="S4.E11.m1.2.2.3.cmml"><mrow id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml"><msub id="S4.E11.m1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.3.cmml"><mi id="S4.E11.m1.1.1.1.1.3.2" xref="S4.E11.m1.1.1.1.1.3.2.cmml">P</mi><mi id="S4.E11.m1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.E11.m1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E11.m1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.cmml"><msubsup id="S4.E11.m1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.1.1.1.1.3.2.2" xref="S4.E11.m1.1.1.1.1.1.3.2.2.cmml">𝒰</mi><mi id="S4.E11.m1.1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.1.3.3.cmml">i</mi><mi id="S4.E11.m1.1.1.1.1.1.3.2.3" xref="S4.E11.m1.1.1.1.1.1.3.2.3.cmml">l</mi></msubsup><mo id="S4.E11.m1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E11.m1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E11.m1.1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.cmml">P</mi><mo id="S4.E11.m1.1.1.1.1.1.1.1.1.2.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E11.m1.1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E11.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace id="S4.E11.m1.2.2.2.3" width="2em" xref="S4.E11.m1.2.2.3a.cmml"></mspace><mrow id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.2.cmml"><msub id="S4.E11.m1.2.2.2.2.3" xref="S4.E11.m1.2.2.2.2.3.cmml"><mover accent="true" id="S4.E11.m1.2.2.2.2.3.2" xref="S4.E11.m1.2.2.2.2.3.2.cmml"><mi id="S4.E11.m1.2.2.2.2.3.2.2" xref="S4.E11.m1.2.2.2.2.3.2.2.cmml">P</mi><mo id="S4.E11.m1.2.2.2.2.3.2.1" xref="S4.E11.m1.2.2.2.2.3.2.1.cmml">~</mo></mover><mi id="S4.E11.m1.2.2.2.2.3.3" xref="S4.E11.m1.2.2.2.2.3.3.cmml">i</mi></msub><mo id="S4.E11.m1.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.cmml">=</mo><mrow id="S4.E11.m1.2.2.2.2.1" xref="S4.E11.m1.2.2.2.2.1.cmml"><msubsup id="S4.E11.m1.2.2.2.2.1.3" xref="S4.E11.m1.2.2.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.2.2.2.2.1.3.2.2" xref="S4.E11.m1.2.2.2.2.1.3.2.2.cmml">𝒰</mi><mi id="S4.E11.m1.2.2.2.2.1.3.3" xref="S4.E11.m1.2.2.2.2.1.3.3.cmml">i</mi><mi id="S4.E11.m1.2.2.2.2.1.3.2.3" xref="S4.E11.m1.2.2.2.2.1.3.2.3.cmml">v</mi></msubsup><mo id="S4.E11.m1.2.2.2.2.1.2" xref="S4.E11.m1.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.2.2.2.2.1.1.1" xref="S4.E11.m1.2.2.2.2.1.1.1.1.cmml"><mo id="S4.E11.m1.2.2.2.2.1.1.1.2" stretchy="false" xref="S4.E11.m1.2.2.2.2.1.1.1.1.cmml">(</mo><msub id="S4.E11.m1.2.2.2.2.1.1.1.1" xref="S4.E11.m1.2.2.2.2.1.1.1.1.cmml"><mover accent="true" id="S4.E11.m1.2.2.2.2.1.1.1.1.2" xref="S4.E11.m1.2.2.2.2.1.1.1.1.2.cmml"><mi id="S4.E11.m1.2.2.2.2.1.1.1.1.2.2" xref="S4.E11.m1.2.2.2.2.1.1.1.1.2.2.cmml">P</mi><mo id="S4.E11.m1.2.2.2.2.1.1.1.1.2.1" xref="S4.E11.m1.2.2.2.2.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E11.m1.2.2.2.2.1.1.1.1.3" xref="S4.E11.m1.2.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E11.m1.2.2.2.2.1.1.1.3" stretchy="false" xref="S4.E11.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.2b"><apply id="S4.E11.m1.2.2.3.cmml" xref="S4.E11.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.3a.cmml" xref="S4.E11.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1"><eq id="S4.E11.m1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.2"></eq><apply id="S4.E11.m1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.1.3.2">𝑃</ci><ci id="S4.E11.m1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1"><times id="S4.E11.m1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.2"></times><apply id="S4.E11.m1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.3.2.2">𝒰</ci><ci id="S4.E11.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E11.m1.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S4.E11.m1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2"><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.2.2">𝑃</ci></apply><ci id="S4.E11.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E11.m1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2"><eq id="S4.E11.m1.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2"></eq><apply id="S4.E11.m1.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.3.1.cmml" xref="S4.E11.m1.2.2.2.2.3">subscript</csymbol><apply id="S4.E11.m1.2.2.2.2.3.2.cmml" xref="S4.E11.m1.2.2.2.2.3.2"><ci id="S4.E11.m1.2.2.2.2.3.2.1.cmml" xref="S4.E11.m1.2.2.2.2.3.2.1">~</ci><ci id="S4.E11.m1.2.2.2.2.3.2.2.cmml" xref="S4.E11.m1.2.2.2.2.3.2.2">𝑃</ci></apply><ci id="S4.E11.m1.2.2.2.2.3.3.cmml" xref="S4.E11.m1.2.2.2.2.3.3">𝑖</ci></apply><apply id="S4.E11.m1.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.1"><times id="S4.E11.m1.2.2.2.2.1.2.cmml" xref="S4.E11.m1.2.2.2.2.1.2"></times><apply id="S4.E11.m1.2.2.2.2.1.3.cmml" xref="S4.E11.m1.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.1.3.1.cmml" xref="S4.E11.m1.2.2.2.2.1.3">subscript</csymbol><apply id="S4.E11.m1.2.2.2.2.1.3.2.cmml" xref="S4.E11.m1.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.1.3.2.1.cmml" xref="S4.E11.m1.2.2.2.2.1.3">superscript</csymbol><ci id="S4.E11.m1.2.2.2.2.1.3.2.2.cmml" xref="S4.E11.m1.2.2.2.2.1.3.2.2">𝒰</ci><ci id="S4.E11.m1.2.2.2.2.1.3.2.3.cmml" xref="S4.E11.m1.2.2.2.2.1.3.2.3">𝑣</ci></apply><ci id="S4.E11.m1.2.2.2.2.1.3.3.cmml" xref="S4.E11.m1.2.2.2.2.1.3.3">𝑖</ci></apply><apply id="S4.E11.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1">subscript</csymbol><apply id="S4.E11.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1.1.2"><ci id="S4.E11.m1.2.2.2.2.1.1.1.1.2.1.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1.1.2.1">^</ci><ci id="S4.E11.m1.2.2.2.2.1.1.1.1.2.2.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1.1.2.2">𝑃</ci></apply><ci id="S4.E11.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.2c">P_{i}=\mathcal{U}^{l}_{i}(\hat{P}_{i})\qquad\tilde{P}_{i}=\mathcal{U}^{v}_{i}(%
\hat{P}_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.2d">italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = caligraphic_U start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) over~ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = caligraphic_U start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.2">For these separate transformations, we use a linear layer followed by layer normalization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib4" title="">4</a>]</cite> to project the unified prompts to textual and visual dimensions.
We call the method <span class="ltx_text ltx_font_italic" id="S4.SS3.p5.2.1">Shared Separate</span> (see <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S4.F2.sf6" title="In Figure 2 ‣ 4.3 Multimodal Prompt Tuning ‣ 4 Revisiting Prompt Tuning ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(f)</span></a>).
A more specialized case of these separable transforms is when one of the transforms, <math alttext="\mathcal{U}^{l}_{i}(\hat{P}_{i})" class="ltx_Math" display="inline" id="S4.SS3.p5.1.m1.1"><semantics id="S4.SS3.p5.1.m1.1a"><mrow id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml"><msubsup id="S4.SS3.p5.1.m1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.1.m1.1.1.3.2.2" xref="S4.SS3.p5.1.m1.1.1.3.2.2.cmml">𝒰</mi><mi id="S4.SS3.p5.1.m1.1.1.3.3" xref="S4.SS3.p5.1.m1.1.1.3.3.cmml">i</mi><mi id="S4.SS3.p5.1.m1.1.1.3.2.3" xref="S4.SS3.p5.1.m1.1.1.3.2.3.cmml">l</mi></msubsup><mo id="S4.SS3.p5.1.m1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p5.1.m1.1.1.1.1" xref="S4.SS3.p5.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS3.p5.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p5.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.p5.1.m1.1.1.1.1.1" xref="S4.SS3.p5.1.m1.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS3.p5.1.m1.1.1.1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p5.1.m1.1.1.1.1.1.2.2" xref="S4.SS3.p5.1.m1.1.1.1.1.1.2.2.cmml">P</mi><mo id="S4.SS3.p5.1.m1.1.1.1.1.1.2.1" xref="S4.SS3.p5.1.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS3.p5.1.m1.1.1.1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS3.p5.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p5.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1"><times id="S4.SS3.p5.1.m1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.2"></times><apply id="S4.SS3.p5.1.m1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.3.1.cmml" xref="S4.SS3.p5.1.m1.1.1.3">subscript</csymbol><apply id="S4.SS3.p5.1.m1.1.1.3.2.cmml" xref="S4.SS3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.3.2.1.cmml" xref="S4.SS3.p5.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.p5.1.m1.1.1.3.2.2.cmml" xref="S4.SS3.p5.1.m1.1.1.3.2.2">𝒰</ci><ci id="S4.SS3.p5.1.m1.1.1.3.2.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3.2.3">𝑙</ci></apply><ci id="S4.SS3.p5.1.m1.1.1.3.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3.3">𝑖</ci></apply><apply id="S4.SS3.p5.1.m1.1.1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1">subscript</csymbol><apply id="S4.SS3.p5.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1.1.2"><ci id="S4.SS3.p5.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1.1.2.1">^</ci><ci id="S4.SS3.p5.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1.1.2.2">𝑃</ci></apply><ci id="S4.SS3.p5.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">\mathcal{U}^{l}_{i}(\hat{P}_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.1.m1.1d">caligraphic_U start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> or <math alttext="\mathcal{U}^{v}_{i}(\hat{P}_{i})" class="ltx_Math" display="inline" id="S4.SS3.p5.2.m2.1"><semantics id="S4.SS3.p5.2.m2.1a"><mrow id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml"><msubsup id="S4.SS3.p5.2.m2.1.1.3" xref="S4.SS3.p5.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.2.m2.1.1.3.2.2" xref="S4.SS3.p5.2.m2.1.1.3.2.2.cmml">𝒰</mi><mi id="S4.SS3.p5.2.m2.1.1.3.3" xref="S4.SS3.p5.2.m2.1.1.3.3.cmml">i</mi><mi id="S4.SS3.p5.2.m2.1.1.3.2.3" xref="S4.SS3.p5.2.m2.1.1.3.2.3.cmml">v</mi></msubsup><mo id="S4.SS3.p5.2.m2.1.1.2" xref="S4.SS3.p5.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p5.2.m2.1.1.1.1" xref="S4.SS3.p5.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS3.p5.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS3.p5.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.p5.2.m2.1.1.1.1.1" xref="S4.SS3.p5.2.m2.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS3.p5.2.m2.1.1.1.1.1.2" xref="S4.SS3.p5.2.m2.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p5.2.m2.1.1.1.1.1.2.2" xref="S4.SS3.p5.2.m2.1.1.1.1.1.2.2.cmml">P</mi><mo id="S4.SS3.p5.2.m2.1.1.1.1.1.2.1" xref="S4.SS3.p5.2.m2.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS3.p5.2.m2.1.1.1.1.1.3" xref="S4.SS3.p5.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS3.p5.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS3.p5.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.1b"><apply id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1"><times id="S4.SS3.p5.2.m2.1.1.2.cmml" xref="S4.SS3.p5.2.m2.1.1.2"></times><apply id="S4.SS3.p5.2.m2.1.1.3.cmml" xref="S4.SS3.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p5.2.m2.1.1.3.1.cmml" xref="S4.SS3.p5.2.m2.1.1.3">subscript</csymbol><apply id="S4.SS3.p5.2.m2.1.1.3.2.cmml" xref="S4.SS3.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p5.2.m2.1.1.3.2.1.cmml" xref="S4.SS3.p5.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.p5.2.m2.1.1.3.2.2.cmml" xref="S4.SS3.p5.2.m2.1.1.3.2.2">𝒰</ci><ci id="S4.SS3.p5.2.m2.1.1.3.2.3.cmml" xref="S4.SS3.p5.2.m2.1.1.3.2.3">𝑣</ci></apply><ci id="S4.SS3.p5.2.m2.1.1.3.3.cmml" xref="S4.SS3.p5.2.m2.1.1.3.3">𝑖</ci></apply><apply id="S4.SS3.p5.2.m2.1.1.1.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1.1.1">subscript</csymbol><apply id="S4.SS3.p5.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS3.p5.2.m2.1.1.1.1.1.2"><ci id="S4.SS3.p5.2.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p5.2.m2.1.1.1.1.1.2.1">^</ci><ci id="S4.SS3.p5.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p5.2.m2.1.1.1.1.1.2.2">𝑃</ci></apply><ci id="S4.SS3.p5.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS3.p5.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.1c">\mathcal{U}^{v}_{i}(\hat{P}_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.2.m2.1d">caligraphic_U start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( over^ start_ARG italic_P end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, is identity.
In that case, the unified prompts are directly initialized to the space for which the transformation is identity.
Khattak <em class="ltx_emph ltx_font_italic" id="S4.SS3.p5.2.2">et al</em>.<span class="ltx_text" id="S4.SS3.p5.2.3"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib23" title="">23</a>]</cite> does the same;
they initialize the unified prompts in the text space (see <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S4.F2.sf4" title="In Figure 2 ‣ 4.3 Multimodal Prompt Tuning ‣ 4 Revisiting Prompt Tuning ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(d)</span></a>).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Method</h2>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering" id="S5.F3.g1" src="prompt_tuning_arch"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S5.F3.3.2" style="font-size:90%;">Multimodal Prompt Tuning Architecture.
To simplify, the projection layers for conditioning prompts from one mode to another are not shown here.
Likewise, for unimodal techniques, only either of the prompt modalities is fed into the model.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S5.F3" title="In 5 Method ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a> shows the general architecture of our proposed framework.
For multimodal prompt tuning, the learnable prompts are injected in both the encoders whereas for unimodal prompt tuning, the prompts are injected in the encoder of the respective modality.
Also, since all the parameters of the pretrained models are frozen, we train and store only the learnable contexts for each downstream task, thus saving computational resources and storage.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">In our study, we have used two VLSMs that are pretrained on natural images viz. CLIPSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib32" title="">32</a>]</cite> and CRIS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib45" title="">45</a>]</cite> for prompt tuning.
A key difference between CLIPSeg’s and CRIS’s architecture is that CLIPSeg uses ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib11" title="">11</a>]</cite> as the vision encoder while CRIS uses ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib16" title="">16</a>]</cite>.
And, while textual prompt tuning is used for both models, the visual and multimodal prompt tuning techniques are applied only to CLIPSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib32" title="">32</a>]</cite> because they require a ViT encoder.
Thus, we have used six prompt tuning methods for CLIPSeg — three multimodal, one visual, and two textual, whereas two textual prompt tuning methods for CRIS.
This amounts to a total of eight combinations of prompt tuning and VLSMs for each dataset.</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">Furthermore, inspired by Jia <em class="ltx_emph ltx_font_italic" id="S5.p3.1.1">et al</em>.<span class="ltx_text" id="S5.p3.1.2"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib19" title="">19</a>]</cite>, we have introduced a learnable upsampler (bottom right of <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S5.F3" title="In 5 Method ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>) that takes the output of the penultimate layer of the decoder; its output is added to the decoder’s output with learnable residual factor.
This learnable block consists of a bilinear upsampler followed by a 2D convolution layer with kernel size <math alttext="5\times 5" class="ltx_Math" display="inline" id="S5.p3.1.m1.1"><semantics id="S5.p3.1.m1.1a"><mrow id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml"><mn id="S5.p3.1.m1.1.1.2" xref="S5.p3.1.m1.1.1.2.cmml">5</mn><mo id="S5.p3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.p3.1.m1.1.1.1.cmml">×</mo><mn id="S5.p3.1.m1.1.1.3" xref="S5.p3.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><apply id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1"><times id="S5.p3.1.m1.1.1.1.cmml" xref="S5.p3.1.m1.1.1.1"></times><cn id="S5.p3.1.m1.1.1.2.cmml" type="integer" xref="S5.p3.1.m1.1.1.2">5</cn><cn id="S5.p3.1.m1.1.1.3.cmml" type="integer" xref="S5.p3.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">5\times 5</annotation><annotation encoding="application/x-llamapun" id="S5.p3.1.m1.1d">5 × 5</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experiments</h2>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Datasets</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">For our empirical analysis of medical datasets, we utilize eight of the datasets and their splits provided by Poudel <em class="ltx_emph ltx_font_italic" id="S6.SS1.p1.1.1">et al</em>.<span class="ltx_text" id="S6.SS1.p1.1.2"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib36" title="">36</a>]</cite>.
These datasets include five non-radiology datasets — Kvasir-SEG <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib17" title="">17</a>]</cite>, ClinicDB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib5" title="">5</a>]</cite>, and BKAI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib3" title="">3</a>]</cite> for polyp segmentation in endoscopic images, DFU <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib22" title="">22</a>]</cite> for diabetic foot ulcer segmentation, and ISIC-16 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib14" title="">14</a>]</cite> for skin lesion segmentation — and three radiology datasets — BUSI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib2" title="">2</a>]</cite> for breast ultrasound segmentation, CAMUS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib25" title="">25</a>]</cite> for 2D echocardiography segmentation, and CheXlocalize <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib40" title="">40</a>]</cite> for chest X-ray segmentation.
For our analysis, we only use the foreground class name to learn the prompt for each dataset automatically.</p>
</div>
<figure class="ltx_table" id="S6.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S6.T1.3.2" style="font-size:90%;">
An overview of our datasets compared across the dimensions of category, type or modality, organ (for medical datasets), foreground classes, and their splits.
</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S6.T1.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T1.4.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S6.T1.4.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T1.4.1.1.1.1" style="font-size:50%;">Category</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="S6.T1.4.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.1.1.2.1">
<span class="ltx_p" id="S6.T1.4.1.1.2.1.1" style="width:47.7pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.4.1.1.2.1.1.1" style="font-size:50%;">Type</span></span>
</span>
</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S6.T1.4.1.1.3"><span class="ltx_text ltx_font_bold" id="S6.T1.4.1.1.3.1" style="font-size:50%;">Organ</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S6.T1.4.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T1.4.1.1.4.1" style="font-size:50%;">Name</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="S6.T1.4.1.1.5">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.1.1.5.1">
<span class="ltx_p" id="S6.T1.4.1.1.5.1.1" style="width:156.1pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.4.1.1.5.1.1.1" style="font-size:50%;">Foreground Class(es)</span></span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="S6.T1.4.1.1.6"><span class="ltx_text ltx_font_bold" id="S6.T1.4.1.1.6.1" style="font-size:50%;"># train/val/test</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.4.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.2.2.1" rowspan="5"><span class="ltx_text" id="S6.T1.4.2.2.1.1" style="font-size:50%;">Non-Radiology</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T1.4.2.2.2" rowspan="3">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.2.2.2.1">
<span class="ltx_p" id="S6.T1.4.2.2.2.1.1" style="width:47.7pt;"><span class="ltx_text" id="S6.T1.4.2.2.2.1.1.1" style="font-size:50%;">Endoscopy</span></span>
</span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.2.2.3" rowspan="3"><span class="ltx_text" id="S6.T1.4.2.2.3.1" style="font-size:50%;">Colon</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.2.2.4"><span class="ltx_text" id="S6.T1.4.2.2.4.1" style="font-size:50%;">Kvasir-SEG</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T1.4.2.2.5" rowspan="3">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.2.2.5.1">
<span class="ltx_p" id="S6.T1.4.2.2.5.1.1" style="width:156.1pt;"><span class="ltx_text" id="S6.T1.4.2.2.5.1.1.1" style="font-size:50%;">Polyp</span></span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T1.4.2.2.6"><span class="ltx_text" id="S6.T1.4.2.2.6.1" style="font-size:50%;">800/100/100</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.4.3.3">
<td class="ltx_td ltx_align_left" id="S6.T1.4.3.3.1"><span class="ltx_text" id="S6.T1.4.3.3.1.1" style="font-size:50%;">ClinicDB</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T1.4.3.3.2"><span class="ltx_text" id="S6.T1.4.3.3.2.1" style="font-size:50%;">490/61/61</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.4.4.4">
<td class="ltx_td ltx_align_left" id="S6.T1.4.4.4.1"><span class="ltx_text" id="S6.T1.4.4.4.1.1" style="font-size:50%;">BKAI</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T1.4.4.4.2"><span class="ltx_text" id="S6.T1.4.4.4.2.1" style="font-size:50%;">800/100/100</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.4.5.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T1.4.5.5.1" rowspan="2">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.5.5.1.1">
<span class="ltx_p" id="S6.T1.4.5.5.1.1.1" style="width:47.7pt;"><span class="ltx_text" id="S6.T1.4.5.5.1.1.1.1" style="font-size:50%;">Photography</span></span>
</span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.5.5.2"><span class="ltx_text" id="S6.T1.4.5.5.2.1" style="font-size:50%;">Skin</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.5.5.3"><span class="ltx_text" id="S6.T1.4.5.5.3.1" style="font-size:50%;">ISIC 2016</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T1.4.5.5.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.5.5.4.1">
<span class="ltx_p" id="S6.T1.4.5.5.4.1.1" style="width:156.1pt;"><span class="ltx_text" id="S6.T1.4.5.5.4.1.1.1" style="font-size:50%;">Skin Lesion</span></span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T1.4.5.5.5"><span class="ltx_text" id="S6.T1.4.5.5.5.1" style="font-size:50%;">810/90/379</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.4.6.6">
<td class="ltx_td ltx_align_left" id="S6.T1.4.6.6.1"><span class="ltx_text" id="S6.T1.4.6.6.1.1" style="font-size:50%;">Foot</span></td>
<td class="ltx_td ltx_align_left" id="S6.T1.4.6.6.2"><span class="ltx_text" id="S6.T1.4.6.6.2.1" style="font-size:50%;">DFU 2022</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T1.4.6.6.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.6.6.3.1">
<span class="ltx_p" id="S6.T1.4.6.6.3.1.1" style="width:156.1pt;"><span class="ltx_text" id="S6.T1.4.6.6.3.1.1.1" style="font-size:50%;">Foot Ulcer</span></span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T1.4.6.6.4"><span class="ltx_text" id="S6.T1.4.6.6.4.1" style="font-size:50%;">1600/200/200</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.4.7.7">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.7.7.1" rowspan="3"><span class="ltx_text" id="S6.T1.4.7.7.1.1" style="font-size:50%;">Radiology</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T1.4.7.7.2" rowspan="2">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.7.7.2.1">
<span class="ltx_p" id="S6.T1.4.7.7.2.1.1" style="width:47.7pt;"><span class="ltx_text" id="S6.T1.4.7.7.2.1.1.1" style="font-size:50%;">Ultrasound</span></span>
</span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.7.7.3"><span class="ltx_text" id="S6.T1.4.7.7.3.1" style="font-size:50%;">Heart</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.7.7.4"><span class="ltx_text" id="S6.T1.4.7.7.4.1" style="font-size:50%;">CAMUS</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T1.4.7.7.5">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.7.7.5.1">
<span class="ltx_p" id="S6.T1.4.7.7.5.1.1" style="width:156.1pt;"><span class="ltx_text" id="S6.T1.4.7.7.5.1.1.1" style="font-size:50%;">Myocardium, Left ventricular, and Left atrium cavity</span></span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T1.4.7.7.6"><span class="ltx_text" id="S6.T1.4.7.7.6.1" style="font-size:50%;">4800/600/600</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.4.8.8">
<td class="ltx_td ltx_align_left" id="S6.T1.4.8.8.1"><span class="ltx_text" id="S6.T1.4.8.8.1.1" style="font-size:50%;">Breast</span></td>
<td class="ltx_td ltx_align_left" id="S6.T1.4.8.8.2"><span class="ltx_text" id="S6.T1.4.8.8.2.1" style="font-size:50%;">BUSI</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S6.T1.4.8.8.3">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.8.8.3.1">
<span class="ltx_p" id="S6.T1.4.8.8.3.1.1" style="width:156.1pt;"><span class="ltx_text" id="S6.T1.4.8.8.3.1.1.1" style="font-size:50%;">Benign and Malignant Tumors</span></span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T1.4.8.8.4"><span class="ltx_text" id="S6.T1.4.8.8.4.1" style="font-size:50%;">624/78/78</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.4.9.9">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T1.4.9.9.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.9.9.1.1">
<span class="ltx_p" id="S6.T1.4.9.9.1.1.1" style="width:47.7pt;"><span class="ltx_text" id="S6.T1.4.9.9.1.1.1.1" style="font-size:50%;">X-Ray</span></span>
</span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.9.9.2"><span class="ltx_text" id="S6.T1.4.9.9.2.1" style="font-size:50%;">Chest</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.9.9.3"><span class="ltx_text" id="S6.T1.4.9.9.3.1" style="font-size:50%;">CheXlocalize</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T1.4.9.9.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.9.9.4.1">
<span class="ltx_p" id="S6.T1.4.9.9.4.1.1" style="width:156.1pt;"><span class="ltx_text" id="S6.T1.4.9.9.4.1.1.1" style="font-size:50%;">Atelectasis, Cardiomegaly, Consolidation, Edema, Enlarged Cardiomediastinum, Lung Lesion, Lung Opacity, Pleural Effusion, Pneumothorax, and Support Devices</span></span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T1.4.9.9.5"><span class="ltx_text" id="S6.T1.4.9.9.5.1" style="font-size:50%;">1279/446/452</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.4.10.10">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S6.T1.4.10.10.1" rowspan="2"><span class="ltx_text" id="S6.T1.4.10.10.1.1" style="font-size:50%;">Open Domain</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T1.4.10.10.2">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.10.10.2.1">
<span class="ltx_p" id="S6.T1.4.10.10.2.1.1" style="width:47.7pt;"><span class="ltx_text" id="S6.T1.4.10.10.2.1.1.1" style="font-size:50%;">Street Scenes</span></span>
</span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.10.10.3"><span class="ltx_text" id="S6.T1.4.10.10.3.1" style="font-size:50%;">N/A</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T1.4.10.10.4"><span class="ltx_text" id="S6.T1.4.10.10.4.1" style="font-size:50%;">Cityscapes</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.T1.4.10.10.5">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.10.10.5.1">
<span class="ltx_p" id="S6.T1.4.10.10.5.1.1" style="width:156.1pt;"><span class="ltx_text" id="S6.T1.4.10.10.5.1.1.1" style="font-size:50%;">Bicycle, Building, Bus, Car, Fence, Motorcycle, Person, Pole, Rider, Road, Sidewalk, Sky, Terrain, Traffic Light, Traffic Sign, Train, Truck, Vegetation, Wall</span></span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S6.T1.4.10.10.6"><span class="ltx_text" id="S6.T1.4.10.10.6.1" style="font-size:50%;">34723/6005/-</span></td>
</tr>
<tr class="ltx_tr" id="S6.T1.4.11.11">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S6.T1.4.11.11.1">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.11.11.1.1">
<span class="ltx_p" id="S6.T1.4.11.11.1.1.1" style="width:47.7pt;"><span class="ltx_text" id="S6.T1.4.11.11.1.1.1.1" style="font-size:50%;">Diverse Scenes</span></span>
</span>
</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T1.4.11.11.2"><span class="ltx_text" id="S6.T1.4.11.11.2.1" style="font-size:50%;">N/A</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T1.4.11.11.3"><span class="ltx_text" id="S6.T1.4.11.11.3.1" style="font-size:50%;">PascalVOC</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S6.T1.4.11.11.4">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.4.11.11.4.1">
<span class="ltx_p" id="S6.T1.4.11.11.4.1.1" style="width:156.1pt;"><span class="ltx_text" id="S6.T1.4.11.11.4.1.1.1" style="font-size:50%;">Aeroplane, Bicycle, Bird, Boat, Bottle, Bus, Car, Cat, Chair, Cow, Dining table, Dog, Horse, Motorbike, Person, Potted plant, Sheep, Sofa, Train, TV Monitor</span></span>
</span>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S6.T1.4.11.11.5"><span class="ltx_text" id="S6.T1.4.11.11.5.1" style="font-size:50%;">2170/2148/-</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.4">As open-domain datasets, we choose Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib9" title="">9</a>]</cite> and PASCAL VOC 2012 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib12" title="">12</a>]</cite> datasets consisting of <math alttext="19" class="ltx_Math" display="inline" id="S6.SS1.p2.1.m1.1"><semantics id="S6.SS1.p2.1.m1.1a"><mn id="S6.SS1.p2.1.m1.1.1" xref="S6.SS1.p2.1.m1.1.1.cmml">19</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.1.m1.1b"><cn id="S6.SS1.p2.1.m1.1.1.cmml" type="integer" xref="S6.SS1.p2.1.m1.1.1">19</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.1.m1.1c">19</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.1.m1.1d">19</annotation></semantics></math> and <math alttext="20" class="ltx_Math" display="inline" id="S6.SS1.p2.2.m2.1"><semantics id="S6.SS1.p2.2.m2.1a"><mn id="S6.SS1.p2.2.m2.1.1" xref="S6.SS1.p2.2.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.2.m2.1b"><cn id="S6.SS1.p2.2.m2.1.1.cmml" type="integer" xref="S6.SS1.p2.2.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.2.m2.1c">20</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.2.m2.1d">20</annotation></semantics></math> classes, respectively.
The significance of using a natural-domain dataset is to evaluate the performance of various prompt-tuning methods in the same domain as the VLSMs were pretrained on.
Also, we can observe how the context learners perform when the number of classes (<math alttext="\approx 20" class="ltx_Math" display="inline" id="S6.SS1.p2.3.m3.1"><semantics id="S6.SS1.p2.3.m3.1a"><mrow id="S6.SS1.p2.3.m3.1.1" xref="S6.SS1.p2.3.m3.1.1.cmml"><mi id="S6.SS1.p2.3.m3.1.1.2" xref="S6.SS1.p2.3.m3.1.1.2.cmml"></mi><mo id="S6.SS1.p2.3.m3.1.1.1" xref="S6.SS1.p2.3.m3.1.1.1.cmml">≈</mo><mn id="S6.SS1.p2.3.m3.1.1.3" xref="S6.SS1.p2.3.m3.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.3.m3.1b"><apply id="S6.SS1.p2.3.m3.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1"><approx id="S6.SS1.p2.3.m3.1.1.1.cmml" xref="S6.SS1.p2.3.m3.1.1.1"></approx><csymbol cd="latexml" id="S6.SS1.p2.3.m3.1.1.2.cmml" xref="S6.SS1.p2.3.m3.1.1.2">absent</csymbol><cn id="S6.SS1.p2.3.m3.1.1.3.cmml" type="integer" xref="S6.SS1.p2.3.m3.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.3.m3.1c">\approx 20</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.3.m3.1d">≈ 20</annotation></semantics></math>) is higher compared to a maximum of <math alttext="10" class="ltx_Math" display="inline" id="S6.SS1.p2.4.m4.1"><semantics id="S6.SS1.p2.4.m4.1a"><mn id="S6.SS1.p2.4.m4.1.1" xref="S6.SS1.p2.4.m4.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S6.SS1.p2.4.m4.1b"><cn id="S6.SS1.p2.4.m4.1.1.cmml" type="integer" xref="S6.SS1.p2.4.m4.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p2.4.m4.1c">10</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p2.4.m4.1d">10</annotation></semantics></math> in the above-mentioned medical datasets.
A detailed description of the datasets selected for this study is shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.T1" title="In 6.1 Datasets ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_figure" id="S6.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F4.sf1"><img alt="Refer to caption" class="ltx_graphics" id="S6.F4.sf1.g1" src="phrase_tsne"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S6.F4.sf1.3.2" style="font-size:90%;">t-SNE of the Phrases</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S6.F4.sf2"><img alt="Refer to caption" class="ltx_graphics" id="S6.F4.sf2.g1" src="image_tsne"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S6.F4.sf2.3.2" style="font-size:90%;">t-SNE of Images</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S6.F4.3.2" style="font-size:90%;">
t-SNE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib33" title="">33</a>]</cite> plots of phrases and images of all the datasets.
Here, Phrasecut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib50" title="">50</a>]</cite> is the dataset on which CLIPSeg was pretrained, Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib9" title="">9</a>]</cite> and Pascal VOC2012 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib12" title="">12</a>]</cite> are the open-domain datasets, while others correspond to the medical domain.
In <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.F4.sf2" title="In Figure 4 ‣ 6.1 Datasets ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4(b)</span></a>, we can see the overlap of clusters for the open domain datasets, and the medical datasets have formed separate small clusters.
</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1">To analyze the domain shift between open-domain and medical datasets, we have plotted t-SNE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib33" title="">33</a>]</cite> of CLIP’s text and vision embeddings for all datasets in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.F4" title="In 6.1 Datasets ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>.
In addition to the datasets mentioned in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.SS1" title="6.1 Datasets ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">6.1</span></a>, we have also plotted the phrases in the Phrasecut dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib50" title="">50</a>]</cite>, the one used to pretrain CLIPSeg.
The figure has fewer text embeddings than image embeddings because many images correspond to a single prompt in the images in a dataset and the endoscopy datasets share the same foreground class (polyp).
Since the number of phrases for the semantic segmentation datasets is insignificant in comparison to the referring image segmentation dataset like PhraseCut, we cannot draw many conclusions from <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.F4.sf1" title="In Figure 4 ‣ 6.1 Datasets ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4(a)</span></a>.
However, in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.F4.sf2" title="In Figure 4 ‣ 6.1 Datasets ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4(b)</span></a>, we can see the image embeddings for the medical datasets forming their clusters, separate from that of the open domain datasets.
Similarly, the image embeddings of the open domain datasets overlap and the datasets with polyp as their foreground class are in the same cluster (center right).
This illustrates a significant domain shift in CLIP’s image embeddings from the dataset in which VLSMs were trained, to the medical datasets, thus, image embeddings require more adjustment to the domain shift.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Implementation Details</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.6">Before feeding the images to the models, we scaled and normalized the images in the original resolution of the respective models viz. <math alttext="416\times 416" class="ltx_Math" display="inline" id="S6.SS2.p1.1.m1.1"><semantics id="S6.SS2.p1.1.m1.1a"><mrow id="S6.SS2.p1.1.m1.1.1" xref="S6.SS2.p1.1.m1.1.1.cmml"><mn id="S6.SS2.p1.1.m1.1.1.2" xref="S6.SS2.p1.1.m1.1.1.2.cmml">416</mn><mo id="S6.SS2.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S6.SS2.p1.1.m1.1.1.3" xref="S6.SS2.p1.1.m1.1.1.3.cmml">416</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.1.m1.1b"><apply id="S6.SS2.p1.1.m1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1"><times id="S6.SS2.p1.1.m1.1.1.1.cmml" xref="S6.SS2.p1.1.m1.1.1.1"></times><cn id="S6.SS2.p1.1.m1.1.1.2.cmml" type="integer" xref="S6.SS2.p1.1.m1.1.1.2">416</cn><cn id="S6.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS2.p1.1.m1.1.1.3">416</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.1.m1.1c">416\times 416</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.1.m1.1d">416 × 416</annotation></semantics></math> for CRIS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib45" title="">45</a>]</cite> and <math alttext="352\times 352" class="ltx_Math" display="inline" id="S6.SS2.p1.2.m2.1"><semantics id="S6.SS2.p1.2.m2.1a"><mrow id="S6.SS2.p1.2.m2.1.1" xref="S6.SS2.p1.2.m2.1.1.cmml"><mn id="S6.SS2.p1.2.m2.1.1.2" xref="S6.SS2.p1.2.m2.1.1.2.cmml">352</mn><mo id="S6.SS2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S6.SS2.p1.2.m2.1.1.3" xref="S6.SS2.p1.2.m2.1.1.3.cmml">352</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.2.m2.1b"><apply id="S6.SS2.p1.2.m2.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1"><times id="S6.SS2.p1.2.m2.1.1.1.cmml" xref="S6.SS2.p1.2.m2.1.1.1"></times><cn id="S6.SS2.p1.2.m2.1.1.2.cmml" type="integer" xref="S6.SS2.p1.2.m2.1.1.2">352</cn><cn id="S6.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S6.SS2.p1.2.m2.1.1.3">352</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.2.m2.1c">352\times 352</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.2.m2.1d">352 × 352</annotation></semantics></math> for CLIPSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib32" title="">32</a>]</cite> using the bicubic interpolation.
Additionally, for the training split, we slightly augmented the images by randomly scaling the images in the range of <math alttext="2\%" class="ltx_Math" display="inline" id="S6.SS2.p1.3.m3.1"><semantics id="S6.SS2.p1.3.m3.1a"><mrow id="S6.SS2.p1.3.m3.1.1" xref="S6.SS2.p1.3.m3.1.1.cmml"><mn id="S6.SS2.p1.3.m3.1.1.2" xref="S6.SS2.p1.3.m3.1.1.2.cmml">2</mn><mo id="S6.SS2.p1.3.m3.1.1.1" xref="S6.SS2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.3.m3.1b"><apply id="S6.SS2.p1.3.m3.1.1.cmml" xref="S6.SS2.p1.3.m3.1.1"><csymbol cd="latexml" id="S6.SS2.p1.3.m3.1.1.1.cmml" xref="S6.SS2.p1.3.m3.1.1.1">percent</csymbol><cn id="S6.SS2.p1.3.m3.1.1.2.cmml" type="integer" xref="S6.SS2.p1.3.m3.1.1.2">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.3.m3.1c">2\%</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.3.m3.1d">2 %</annotation></semantics></math>, translating <math alttext="2\%" class="ltx_Math" display="inline" id="S6.SS2.p1.4.m4.1"><semantics id="S6.SS2.p1.4.m4.1a"><mrow id="S6.SS2.p1.4.m4.1.1" xref="S6.SS2.p1.4.m4.1.1.cmml"><mn id="S6.SS2.p1.4.m4.1.1.2" xref="S6.SS2.p1.4.m4.1.1.2.cmml">2</mn><mo id="S6.SS2.p1.4.m4.1.1.1" xref="S6.SS2.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.4.m4.1b"><apply id="S6.SS2.p1.4.m4.1.1.cmml" xref="S6.SS2.p1.4.m4.1.1"><csymbol cd="latexml" id="S6.SS2.p1.4.m4.1.1.1.cmml" xref="S6.SS2.p1.4.m4.1.1.1">percent</csymbol><cn id="S6.SS2.p1.4.m4.1.1.2.cmml" type="integer" xref="S6.SS2.p1.4.m4.1.1.2">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.4.m4.1c">2\%</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.4.m4.1d">2 %</annotation></semantics></math>, and rotating <math alttext="5^{\circ}" class="ltx_Math" display="inline" id="S6.SS2.p1.5.m5.1"><semantics id="S6.SS2.p1.5.m5.1a"><msup id="S6.SS2.p1.5.m5.1.1" xref="S6.SS2.p1.5.m5.1.1.cmml"><mn id="S6.SS2.p1.5.m5.1.1.2" xref="S6.SS2.p1.5.m5.1.1.2.cmml">5</mn><mo id="S6.SS2.p1.5.m5.1.1.3" xref="S6.SS2.p1.5.m5.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.5.m5.1b"><apply id="S6.SS2.p1.5.m5.1.1.cmml" xref="S6.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S6.SS2.p1.5.m5.1.1.1.cmml" xref="S6.SS2.p1.5.m5.1.1">superscript</csymbol><cn id="S6.SS2.p1.5.m5.1.1.2.cmml" type="integer" xref="S6.SS2.p1.5.m5.1.1.2">5</cn><compose id="S6.SS2.p1.5.m5.1.1.3.cmml" xref="S6.SS2.p1.5.m5.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.5.m5.1c">5^{\circ}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.5.m5.1d">5 start_POSTSUPERSCRIPT ∘ end_POSTSUPERSCRIPT</annotation></semantics></math> using the Albumentations library <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib7" title="">7</a>]</cite>.
Additionally, the brightness and contrast of the images are augmented in the range of <math alttext="10\%" class="ltx_Math" display="inline" id="S6.SS2.p1.6.m6.1"><semantics id="S6.SS2.p1.6.m6.1a"><mrow id="S6.SS2.p1.6.m6.1.1" xref="S6.SS2.p1.6.m6.1.1.cmml"><mn id="S6.SS2.p1.6.m6.1.1.2" xref="S6.SS2.p1.6.m6.1.1.2.cmml">10</mn><mo id="S6.SS2.p1.6.m6.1.1.1" xref="S6.SS2.p1.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p1.6.m6.1b"><apply id="S6.SS2.p1.6.m6.1.1.cmml" xref="S6.SS2.p1.6.m6.1.1"><csymbol cd="latexml" id="S6.SS2.p1.6.m6.1.1.1.cmml" xref="S6.SS2.p1.6.m6.1.1.1">percent</csymbol><cn id="S6.SS2.p1.6.m6.1.1.2.cmml" type="integer" xref="S6.SS2.p1.6.m6.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p1.6.m6.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p1.6.m6.1d">10 %</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.1">We used 16-bit floating-point mixed-precision training in the NVIDIA GPUs using AdamW <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib31" title="">31</a>]</cite> optimizer with an effective batch size of <math alttext="32" class="ltx_Math" display="inline" id="S6.SS2.p2.1.m1.1"><semantics id="S6.SS2.p2.1.m1.1a"><mn id="S6.SS2.p2.1.m1.1.1" xref="S6.SS2.p2.1.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.1.m1.1b"><cn id="S6.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S6.SS2.p2.1.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.1.m1.1c">32</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.1.m1.1d">32</annotation></semantics></math> for all the experiments in this paper.
For the loss function, we used a combined loss of Dice Loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib34" title="">34</a>]</cite> and Binary Cross Entropy loss.
Mathematically, the loss function used can be shown as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S6.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\lambda_{d}\mathcal{L}_{d}+\lambda_{ce}\mathcal{L}_{ce}" class="ltx_Math" display="block" id="S6.Ex1.m1.1"><semantics id="S6.Ex1.m1.1a"><mrow id="S6.Ex1.m1.1.1" xref="S6.Ex1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.Ex1.m1.1.1.2" xref="S6.Ex1.m1.1.1.2.cmml">ℒ</mi><mo id="S6.Ex1.m1.1.1.1" xref="S6.Ex1.m1.1.1.1.cmml">=</mo><mrow id="S6.Ex1.m1.1.1.3" xref="S6.Ex1.m1.1.1.3.cmml"><mrow id="S6.Ex1.m1.1.1.3.2" xref="S6.Ex1.m1.1.1.3.2.cmml"><msub id="S6.Ex1.m1.1.1.3.2.2" xref="S6.Ex1.m1.1.1.3.2.2.cmml"><mi id="S6.Ex1.m1.1.1.3.2.2.2" xref="S6.Ex1.m1.1.1.3.2.2.2.cmml">λ</mi><mi id="S6.Ex1.m1.1.1.3.2.2.3" xref="S6.Ex1.m1.1.1.3.2.2.3.cmml">d</mi></msub><mo id="S6.Ex1.m1.1.1.3.2.1" xref="S6.Ex1.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S6.Ex1.m1.1.1.3.2.3" xref="S6.Ex1.m1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.Ex1.m1.1.1.3.2.3.2" xref="S6.Ex1.m1.1.1.3.2.3.2.cmml">ℒ</mi><mi id="S6.Ex1.m1.1.1.3.2.3.3" xref="S6.Ex1.m1.1.1.3.2.3.3.cmml">d</mi></msub></mrow><mo id="S6.Ex1.m1.1.1.3.1" xref="S6.Ex1.m1.1.1.3.1.cmml">+</mo><mrow id="S6.Ex1.m1.1.1.3.3" xref="S6.Ex1.m1.1.1.3.3.cmml"><msub id="S6.Ex1.m1.1.1.3.3.2" xref="S6.Ex1.m1.1.1.3.3.2.cmml"><mi id="S6.Ex1.m1.1.1.3.3.2.2" xref="S6.Ex1.m1.1.1.3.3.2.2.cmml">λ</mi><mrow id="S6.Ex1.m1.1.1.3.3.2.3" xref="S6.Ex1.m1.1.1.3.3.2.3.cmml"><mi id="S6.Ex1.m1.1.1.3.3.2.3.2" xref="S6.Ex1.m1.1.1.3.3.2.3.2.cmml">c</mi><mo id="S6.Ex1.m1.1.1.3.3.2.3.1" xref="S6.Ex1.m1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S6.Ex1.m1.1.1.3.3.2.3.3" xref="S6.Ex1.m1.1.1.3.3.2.3.3.cmml">e</mi></mrow></msub><mo id="S6.Ex1.m1.1.1.3.3.1" xref="S6.Ex1.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S6.Ex1.m1.1.1.3.3.3" xref="S6.Ex1.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.Ex1.m1.1.1.3.3.3.2" xref="S6.Ex1.m1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S6.Ex1.m1.1.1.3.3.3.3" xref="S6.Ex1.m1.1.1.3.3.3.3.cmml"><mi id="S6.Ex1.m1.1.1.3.3.3.3.2" xref="S6.Ex1.m1.1.1.3.3.3.3.2.cmml">c</mi><mo id="S6.Ex1.m1.1.1.3.3.3.3.1" xref="S6.Ex1.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S6.Ex1.m1.1.1.3.3.3.3.3" xref="S6.Ex1.m1.1.1.3.3.3.3.3.cmml">e</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.Ex1.m1.1b"><apply id="S6.Ex1.m1.1.1.cmml" xref="S6.Ex1.m1.1.1"><eq id="S6.Ex1.m1.1.1.1.cmml" xref="S6.Ex1.m1.1.1.1"></eq><ci id="S6.Ex1.m1.1.1.2.cmml" xref="S6.Ex1.m1.1.1.2">ℒ</ci><apply id="S6.Ex1.m1.1.1.3.cmml" xref="S6.Ex1.m1.1.1.3"><plus id="S6.Ex1.m1.1.1.3.1.cmml" xref="S6.Ex1.m1.1.1.3.1"></plus><apply id="S6.Ex1.m1.1.1.3.2.cmml" xref="S6.Ex1.m1.1.1.3.2"><times id="S6.Ex1.m1.1.1.3.2.1.cmml" xref="S6.Ex1.m1.1.1.3.2.1"></times><apply id="S6.Ex1.m1.1.1.3.2.2.cmml" xref="S6.Ex1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S6.Ex1.m1.1.1.3.2.2.1.cmml" xref="S6.Ex1.m1.1.1.3.2.2">subscript</csymbol><ci id="S6.Ex1.m1.1.1.3.2.2.2.cmml" xref="S6.Ex1.m1.1.1.3.2.2.2">𝜆</ci><ci id="S6.Ex1.m1.1.1.3.2.2.3.cmml" xref="S6.Ex1.m1.1.1.3.2.2.3">𝑑</ci></apply><apply id="S6.Ex1.m1.1.1.3.2.3.cmml" xref="S6.Ex1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S6.Ex1.m1.1.1.3.2.3.1.cmml" xref="S6.Ex1.m1.1.1.3.2.3">subscript</csymbol><ci id="S6.Ex1.m1.1.1.3.2.3.2.cmml" xref="S6.Ex1.m1.1.1.3.2.3.2">ℒ</ci><ci id="S6.Ex1.m1.1.1.3.2.3.3.cmml" xref="S6.Ex1.m1.1.1.3.2.3.3">𝑑</ci></apply></apply><apply id="S6.Ex1.m1.1.1.3.3.cmml" xref="S6.Ex1.m1.1.1.3.3"><times id="S6.Ex1.m1.1.1.3.3.1.cmml" xref="S6.Ex1.m1.1.1.3.3.1"></times><apply id="S6.Ex1.m1.1.1.3.3.2.cmml" xref="S6.Ex1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S6.Ex1.m1.1.1.3.3.2.1.cmml" xref="S6.Ex1.m1.1.1.3.3.2">subscript</csymbol><ci id="S6.Ex1.m1.1.1.3.3.2.2.cmml" xref="S6.Ex1.m1.1.1.3.3.2.2">𝜆</ci><apply id="S6.Ex1.m1.1.1.3.3.2.3.cmml" xref="S6.Ex1.m1.1.1.3.3.2.3"><times id="S6.Ex1.m1.1.1.3.3.2.3.1.cmml" xref="S6.Ex1.m1.1.1.3.3.2.3.1"></times><ci id="S6.Ex1.m1.1.1.3.3.2.3.2.cmml" xref="S6.Ex1.m1.1.1.3.3.2.3.2">𝑐</ci><ci id="S6.Ex1.m1.1.1.3.3.2.3.3.cmml" xref="S6.Ex1.m1.1.1.3.3.2.3.3">𝑒</ci></apply></apply><apply id="S6.Ex1.m1.1.1.3.3.3.cmml" xref="S6.Ex1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S6.Ex1.m1.1.1.3.3.3.1.cmml" xref="S6.Ex1.m1.1.1.3.3.3">subscript</csymbol><ci id="S6.Ex1.m1.1.1.3.3.3.2.cmml" xref="S6.Ex1.m1.1.1.3.3.3.2">ℒ</ci><apply id="S6.Ex1.m1.1.1.3.3.3.3.cmml" xref="S6.Ex1.m1.1.1.3.3.3.3"><times id="S6.Ex1.m1.1.1.3.3.3.3.1.cmml" xref="S6.Ex1.m1.1.1.3.3.3.3.1"></times><ci id="S6.Ex1.m1.1.1.3.3.3.3.2.cmml" xref="S6.Ex1.m1.1.1.3.3.3.3.2">𝑐</ci><ci id="S6.Ex1.m1.1.1.3.3.3.3.3.cmml" xref="S6.Ex1.m1.1.1.3.3.3.3.3">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.Ex1.m1.1c">\mathcal{L}=\lambda_{d}\mathcal{L}_{d}+\lambda_{ce}\mathcal{L}_{ce}</annotation><annotation encoding="application/x-llamapun" id="S6.Ex1.m1.1d">caligraphic_L = italic_λ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT italic_c italic_e end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_c italic_e end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S6.SS2.p2.5">Here, <math alttext="\lambda_{d}" class="ltx_Math" display="inline" id="S6.SS2.p2.2.m1.1"><semantics id="S6.SS2.p2.2.m1.1a"><msub id="S6.SS2.p2.2.m1.1.1" xref="S6.SS2.p2.2.m1.1.1.cmml"><mi id="S6.SS2.p2.2.m1.1.1.2" xref="S6.SS2.p2.2.m1.1.1.2.cmml">λ</mi><mi id="S6.SS2.p2.2.m1.1.1.3" xref="S6.SS2.p2.2.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.2.m1.1b"><apply id="S6.SS2.p2.2.m1.1.1.cmml" xref="S6.SS2.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S6.SS2.p2.2.m1.1.1.1.cmml" xref="S6.SS2.p2.2.m1.1.1">subscript</csymbol><ci id="S6.SS2.p2.2.m1.1.1.2.cmml" xref="S6.SS2.p2.2.m1.1.1.2">𝜆</ci><ci id="S6.SS2.p2.2.m1.1.1.3.cmml" xref="S6.SS2.p2.2.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.2.m1.1c">\lambda_{d}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.2.m1.1d">italic_λ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{ce}" class="ltx_Math" display="inline" id="S6.SS2.p2.3.m2.1"><semantics id="S6.SS2.p2.3.m2.1a"><msub id="S6.SS2.p2.3.m2.1.1" xref="S6.SS2.p2.3.m2.1.1.cmml"><mi id="S6.SS2.p2.3.m2.1.1.2" xref="S6.SS2.p2.3.m2.1.1.2.cmml">λ</mi><mrow id="S6.SS2.p2.3.m2.1.1.3" xref="S6.SS2.p2.3.m2.1.1.3.cmml"><mi id="S6.SS2.p2.3.m2.1.1.3.2" xref="S6.SS2.p2.3.m2.1.1.3.2.cmml">c</mi><mo id="S6.SS2.p2.3.m2.1.1.3.1" xref="S6.SS2.p2.3.m2.1.1.3.1.cmml">⁢</mo><mi id="S6.SS2.p2.3.m2.1.1.3.3" xref="S6.SS2.p2.3.m2.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.3.m2.1b"><apply id="S6.SS2.p2.3.m2.1.1.cmml" xref="S6.SS2.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S6.SS2.p2.3.m2.1.1.1.cmml" xref="S6.SS2.p2.3.m2.1.1">subscript</csymbol><ci id="S6.SS2.p2.3.m2.1.1.2.cmml" xref="S6.SS2.p2.3.m2.1.1.2">𝜆</ci><apply id="S6.SS2.p2.3.m2.1.1.3.cmml" xref="S6.SS2.p2.3.m2.1.1.3"><times id="S6.SS2.p2.3.m2.1.1.3.1.cmml" xref="S6.SS2.p2.3.m2.1.1.3.1"></times><ci id="S6.SS2.p2.3.m2.1.1.3.2.cmml" xref="S6.SS2.p2.3.m2.1.1.3.2">𝑐</ci><ci id="S6.SS2.p2.3.m2.1.1.3.3.cmml" xref="S6.SS2.p2.3.m2.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.3.m2.1c">\lambda_{ce}</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.3.m2.1d">italic_λ start_POSTSUBSCRIPT italic_c italic_e end_POSTSUBSCRIPT</annotation></semantics></math> were chosen to be <math alttext="1" class="ltx_Math" display="inline" id="S6.SS2.p2.4.m3.1"><semantics id="S6.SS2.p2.4.m3.1a"><mn id="S6.SS2.p2.4.m3.1.1" xref="S6.SS2.p2.4.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.4.m3.1b"><cn id="S6.SS2.p2.4.m3.1.1.cmml" type="integer" xref="S6.SS2.p2.4.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.4.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.4.m3.1d">1</annotation></semantics></math> and <math alttext="0.2" class="ltx_Math" display="inline" id="S6.SS2.p2.5.m4.1"><semantics id="S6.SS2.p2.5.m4.1a"><mn id="S6.SS2.p2.5.m4.1.1" xref="S6.SS2.p2.5.m4.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.5.m4.1b"><cn id="S6.SS2.p2.5.m4.1.1.cmml" type="float" xref="S6.SS2.p2.5.m4.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.5.m4.1c">0.2</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.5.m4.1d">0.2</annotation></semantics></math>, respectively for all the datasets.</p>
</div>
<figure class="ltx_table" id="S6.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T2.12.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S6.T2.13.2" style="font-size:90%;">The search space for the hyperparameter search.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T2.10">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T2.10.11.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T2.10.11.1.1"><span class="ltx_text ltx_font_bold" id="S6.T2.10.11.1.1.1">Hyperparameter</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T2.10.11.1.2"><span class="ltx_text ltx_font_bold" id="S6.T2.10.11.1.2.1">Search Space</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S6.T2.10.11.1.3"><span class="ltx_text ltx_font_bold" id="S6.T2.10.11.1.3.1">Applicable for</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S6.T2.10.11.1.4"><span class="ltx_text ltx_font_bold" id="S6.T2.10.11.1.4.1">Space Type</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T2.1.1.2">Learning rate</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T2.1.1.1"><math alttext="[10^{-5},5\times 10^{-3}]" class="ltx_Math" display="inline" id="S6.T2.1.1.1.m1.2"><semantics id="S6.T2.1.1.1.m1.2a"><mrow id="S6.T2.1.1.1.m1.2.2.2" xref="S6.T2.1.1.1.m1.2.2.3.cmml"><mo id="S6.T2.1.1.1.m1.2.2.2.3" stretchy="false" xref="S6.T2.1.1.1.m1.2.2.3.cmml">[</mo><msup id="S6.T2.1.1.1.m1.1.1.1.1" xref="S6.T2.1.1.1.m1.1.1.1.1.cmml"><mn id="S6.T2.1.1.1.m1.1.1.1.1.2" xref="S6.T2.1.1.1.m1.1.1.1.1.2.cmml">10</mn><mrow id="S6.T2.1.1.1.m1.1.1.1.1.3" xref="S6.T2.1.1.1.m1.1.1.1.1.3.cmml"><mo id="S6.T2.1.1.1.m1.1.1.1.1.3a" xref="S6.T2.1.1.1.m1.1.1.1.1.3.cmml">−</mo><mn id="S6.T2.1.1.1.m1.1.1.1.1.3.2" xref="S6.T2.1.1.1.m1.1.1.1.1.3.2.cmml">5</mn></mrow></msup><mo id="S6.T2.1.1.1.m1.2.2.2.4" xref="S6.T2.1.1.1.m1.2.2.3.cmml">,</mo><mrow id="S6.T2.1.1.1.m1.2.2.2.2" xref="S6.T2.1.1.1.m1.2.2.2.2.cmml"><mn id="S6.T2.1.1.1.m1.2.2.2.2.2" xref="S6.T2.1.1.1.m1.2.2.2.2.2.cmml">5</mn><mo id="S6.T2.1.1.1.m1.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="S6.T2.1.1.1.m1.2.2.2.2.1.cmml">×</mo><msup id="S6.T2.1.1.1.m1.2.2.2.2.3" xref="S6.T2.1.1.1.m1.2.2.2.2.3.cmml"><mn id="S6.T2.1.1.1.m1.2.2.2.2.3.2" xref="S6.T2.1.1.1.m1.2.2.2.2.3.2.cmml">10</mn><mrow id="S6.T2.1.1.1.m1.2.2.2.2.3.3" xref="S6.T2.1.1.1.m1.2.2.2.2.3.3.cmml"><mo id="S6.T2.1.1.1.m1.2.2.2.2.3.3a" xref="S6.T2.1.1.1.m1.2.2.2.2.3.3.cmml">−</mo><mn id="S6.T2.1.1.1.m1.2.2.2.2.3.3.2" xref="S6.T2.1.1.1.m1.2.2.2.2.3.3.2.cmml">3</mn></mrow></msup></mrow><mo id="S6.T2.1.1.1.m1.2.2.2.5" stretchy="false" xref="S6.T2.1.1.1.m1.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.1.1.1.m1.2b"><interval closure="closed" id="S6.T2.1.1.1.m1.2.2.3.cmml" xref="S6.T2.1.1.1.m1.2.2.2"><apply id="S6.T2.1.1.1.m1.1.1.1.1.cmml" xref="S6.T2.1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S6.T2.1.1.1.m1.1.1.1.1.1.cmml" xref="S6.T2.1.1.1.m1.1.1.1.1">superscript</csymbol><cn id="S6.T2.1.1.1.m1.1.1.1.1.2.cmml" type="integer" xref="S6.T2.1.1.1.m1.1.1.1.1.2">10</cn><apply id="S6.T2.1.1.1.m1.1.1.1.1.3.cmml" xref="S6.T2.1.1.1.m1.1.1.1.1.3"><minus id="S6.T2.1.1.1.m1.1.1.1.1.3.1.cmml" xref="S6.T2.1.1.1.m1.1.1.1.1.3"></minus><cn id="S6.T2.1.1.1.m1.1.1.1.1.3.2.cmml" type="integer" xref="S6.T2.1.1.1.m1.1.1.1.1.3.2">5</cn></apply></apply><apply id="S6.T2.1.1.1.m1.2.2.2.2.cmml" xref="S6.T2.1.1.1.m1.2.2.2.2"><times id="S6.T2.1.1.1.m1.2.2.2.2.1.cmml" xref="S6.T2.1.1.1.m1.2.2.2.2.1"></times><cn id="S6.T2.1.1.1.m1.2.2.2.2.2.cmml" type="integer" xref="S6.T2.1.1.1.m1.2.2.2.2.2">5</cn><apply id="S6.T2.1.1.1.m1.2.2.2.2.3.cmml" xref="S6.T2.1.1.1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S6.T2.1.1.1.m1.2.2.2.2.3.1.cmml" xref="S6.T2.1.1.1.m1.2.2.2.2.3">superscript</csymbol><cn id="S6.T2.1.1.1.m1.2.2.2.2.3.2.cmml" type="integer" xref="S6.T2.1.1.1.m1.2.2.2.2.3.2">10</cn><apply id="S6.T2.1.1.1.m1.2.2.2.2.3.3.cmml" xref="S6.T2.1.1.1.m1.2.2.2.2.3.3"><minus id="S6.T2.1.1.1.m1.2.2.2.2.3.3.1.cmml" xref="S6.T2.1.1.1.m1.2.2.2.2.3.3"></minus><cn id="S6.T2.1.1.1.m1.2.2.2.2.3.3.2.cmml" type="integer" xref="S6.T2.1.1.1.m1.2.2.2.2.3.3.2">3</cn></apply></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.1.1.1.m1.2c">[10^{-5},5\times 10^{-3}]</annotation><annotation encoding="application/x-llamapun" id="S6.T2.1.1.1.m1.2d">[ 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT , 5 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT ]</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.1.1.3">ALL</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T2.1.1.4">Log</td>
</tr>
<tr class="ltx_tr" id="S6.T2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.2.2.2">Weight decay</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.2.2.1"><math alttext="[10^{-5},0.01]" class="ltx_Math" display="inline" id="S6.T2.2.2.1.m1.2"><semantics id="S6.T2.2.2.1.m1.2a"><mrow id="S6.T2.2.2.1.m1.2.2.1" xref="S6.T2.2.2.1.m1.2.2.2.cmml"><mo id="S6.T2.2.2.1.m1.2.2.1.2" stretchy="false" xref="S6.T2.2.2.1.m1.2.2.2.cmml">[</mo><msup id="S6.T2.2.2.1.m1.2.2.1.1" xref="S6.T2.2.2.1.m1.2.2.1.1.cmml"><mn id="S6.T2.2.2.1.m1.2.2.1.1.2" xref="S6.T2.2.2.1.m1.2.2.1.1.2.cmml">10</mn><mrow id="S6.T2.2.2.1.m1.2.2.1.1.3" xref="S6.T2.2.2.1.m1.2.2.1.1.3.cmml"><mo id="S6.T2.2.2.1.m1.2.2.1.1.3a" xref="S6.T2.2.2.1.m1.2.2.1.1.3.cmml">−</mo><mn id="S6.T2.2.2.1.m1.2.2.1.1.3.2" xref="S6.T2.2.2.1.m1.2.2.1.1.3.2.cmml">5</mn></mrow></msup><mo id="S6.T2.2.2.1.m1.2.2.1.3" xref="S6.T2.2.2.1.m1.2.2.2.cmml">,</mo><mn id="S6.T2.2.2.1.m1.1.1" xref="S6.T2.2.2.1.m1.1.1.cmml">0.01</mn><mo id="S6.T2.2.2.1.m1.2.2.1.4" stretchy="false" xref="S6.T2.2.2.1.m1.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.2.2.1.m1.2b"><interval closure="closed" id="S6.T2.2.2.1.m1.2.2.2.cmml" xref="S6.T2.2.2.1.m1.2.2.1"><apply id="S6.T2.2.2.1.m1.2.2.1.1.cmml" xref="S6.T2.2.2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S6.T2.2.2.1.m1.2.2.1.1.1.cmml" xref="S6.T2.2.2.1.m1.2.2.1.1">superscript</csymbol><cn id="S6.T2.2.2.1.m1.2.2.1.1.2.cmml" type="integer" xref="S6.T2.2.2.1.m1.2.2.1.1.2">10</cn><apply id="S6.T2.2.2.1.m1.2.2.1.1.3.cmml" xref="S6.T2.2.2.1.m1.2.2.1.1.3"><minus id="S6.T2.2.2.1.m1.2.2.1.1.3.1.cmml" xref="S6.T2.2.2.1.m1.2.2.1.1.3"></minus><cn id="S6.T2.2.2.1.m1.2.2.1.1.3.2.cmml" type="integer" xref="S6.T2.2.2.1.m1.2.2.1.1.3.2">5</cn></apply></apply><cn id="S6.T2.2.2.1.m1.1.1.cmml" type="float" xref="S6.T2.2.2.1.m1.1.1">0.01</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.2.2.1.m1.2c">[10^{-5},0.01]</annotation><annotation encoding="application/x-llamapun" id="S6.T2.2.2.1.m1.2d">[ 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT , 0.01 ]</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S6.T2.2.2.3">ALL</td>
<td class="ltx_td ltx_align_left" id="S6.T2.2.2.4">Log</td>
</tr>
<tr class="ltx_tr" id="S6.T2.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.3.3.2">Prompt depth</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.3.3.1"><math alttext="[1,11]" class="ltx_Math" display="inline" id="S6.T2.3.3.1.m1.2"><semantics id="S6.T2.3.3.1.m1.2a"><mrow id="S6.T2.3.3.1.m1.2.3.2" xref="S6.T2.3.3.1.m1.2.3.1.cmml"><mo id="S6.T2.3.3.1.m1.2.3.2.1" stretchy="false" xref="S6.T2.3.3.1.m1.2.3.1.cmml">[</mo><mn id="S6.T2.3.3.1.m1.1.1" xref="S6.T2.3.3.1.m1.1.1.cmml">1</mn><mo id="S6.T2.3.3.1.m1.2.3.2.2" xref="S6.T2.3.3.1.m1.2.3.1.cmml">,</mo><mn id="S6.T2.3.3.1.m1.2.2" xref="S6.T2.3.3.1.m1.2.2.cmml">11</mn><mo id="S6.T2.3.3.1.m1.2.3.2.3" stretchy="false" xref="S6.T2.3.3.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.3.3.1.m1.2b"><interval closure="closed" id="S6.T2.3.3.1.m1.2.3.1.cmml" xref="S6.T2.3.3.1.m1.2.3.2"><cn id="S6.T2.3.3.1.m1.1.1.cmml" type="integer" xref="S6.T2.3.3.1.m1.1.1">1</cn><cn id="S6.T2.3.3.1.m1.2.2.cmml" type="integer" xref="S6.T2.3.3.1.m1.2.2">11</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.3.3.1.m1.2c">[1,11]</annotation><annotation encoding="application/x-llamapun" id="S6.T2.3.3.1.m1.2d">[ 1 , 11 ]</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S6.T2.3.3.3">ALL</td>
<td class="ltx_td ltx_align_left" id="S6.T2.3.3.4">Integer</td>
</tr>
<tr class="ltx_tr" id="S6.T2.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.4.4.2">Intermediate dimension</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.4.4.1"><math alttext="\{32,64,96,128\}" class="ltx_Math" display="inline" id="S6.T2.4.4.1.m1.4"><semantics id="S6.T2.4.4.1.m1.4a"><mrow id="S6.T2.4.4.1.m1.4.5.2" xref="S6.T2.4.4.1.m1.4.5.1.cmml"><mo id="S6.T2.4.4.1.m1.4.5.2.1" stretchy="false" xref="S6.T2.4.4.1.m1.4.5.1.cmml">{</mo><mn id="S6.T2.4.4.1.m1.1.1" xref="S6.T2.4.4.1.m1.1.1.cmml">32</mn><mo id="S6.T2.4.4.1.m1.4.5.2.2" xref="S6.T2.4.4.1.m1.4.5.1.cmml">,</mo><mn id="S6.T2.4.4.1.m1.2.2" xref="S6.T2.4.4.1.m1.2.2.cmml">64</mn><mo id="S6.T2.4.4.1.m1.4.5.2.3" xref="S6.T2.4.4.1.m1.4.5.1.cmml">,</mo><mn id="S6.T2.4.4.1.m1.3.3" xref="S6.T2.4.4.1.m1.3.3.cmml">96</mn><mo id="S6.T2.4.4.1.m1.4.5.2.4" xref="S6.T2.4.4.1.m1.4.5.1.cmml">,</mo><mn id="S6.T2.4.4.1.m1.4.4" xref="S6.T2.4.4.1.m1.4.4.cmml">128</mn><mo id="S6.T2.4.4.1.m1.4.5.2.5" stretchy="false" xref="S6.T2.4.4.1.m1.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.4.4.1.m1.4b"><set id="S6.T2.4.4.1.m1.4.5.1.cmml" xref="S6.T2.4.4.1.m1.4.5.2"><cn id="S6.T2.4.4.1.m1.1.1.cmml" type="integer" xref="S6.T2.4.4.1.m1.1.1">32</cn><cn id="S6.T2.4.4.1.m1.2.2.cmml" type="integer" xref="S6.T2.4.4.1.m1.2.2">64</cn><cn id="S6.T2.4.4.1.m1.3.3.cmml" type="integer" xref="S6.T2.4.4.1.m1.3.3">96</cn><cn id="S6.T2.4.4.1.m1.4.4.cmml" type="integer" xref="S6.T2.4.4.1.m1.4.4">128</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.4.4.1.m1.4c">\{32,64,96,128\}</annotation><annotation encoding="application/x-llamapun" id="S6.T2.4.4.1.m1.4d">{ 32 , 64 , 96 , 128 }</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S6.T2.4.4.3">CoCoOp, Maple</td>
<td class="ltx_td ltx_align_left" id="S6.T2.4.4.4">Choice</td>
</tr>
<tr class="ltx_tr" id="S6.T2.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.5.5.2">Use LORA</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.5.5.1"><math alttext="\{true,false\}" class="ltx_Math" display="inline" id="S6.T2.5.5.1.m1.2"><semantics id="S6.T2.5.5.1.m1.2a"><mrow id="S6.T2.5.5.1.m1.2.2.2" xref="S6.T2.5.5.1.m1.2.2.3.cmml"><mo id="S6.T2.5.5.1.m1.2.2.2.3" stretchy="false" xref="S6.T2.5.5.1.m1.2.2.3.cmml">{</mo><mrow id="S6.T2.5.5.1.m1.1.1.1.1" xref="S6.T2.5.5.1.m1.1.1.1.1.cmml"><mi id="S6.T2.5.5.1.m1.1.1.1.1.2" xref="S6.T2.5.5.1.m1.1.1.1.1.2.cmml">t</mi><mo id="S6.T2.5.5.1.m1.1.1.1.1.1" xref="S6.T2.5.5.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S6.T2.5.5.1.m1.1.1.1.1.3" xref="S6.T2.5.5.1.m1.1.1.1.1.3.cmml">r</mi><mo id="S6.T2.5.5.1.m1.1.1.1.1.1a" xref="S6.T2.5.5.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S6.T2.5.5.1.m1.1.1.1.1.4" xref="S6.T2.5.5.1.m1.1.1.1.1.4.cmml">u</mi><mo id="S6.T2.5.5.1.m1.1.1.1.1.1b" xref="S6.T2.5.5.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S6.T2.5.5.1.m1.1.1.1.1.5" xref="S6.T2.5.5.1.m1.1.1.1.1.5.cmml">e</mi></mrow><mo id="S6.T2.5.5.1.m1.2.2.2.4" xref="S6.T2.5.5.1.m1.2.2.3.cmml">,</mo><mrow id="S6.T2.5.5.1.m1.2.2.2.2" xref="S6.T2.5.5.1.m1.2.2.2.2.cmml"><mi id="S6.T2.5.5.1.m1.2.2.2.2.2" xref="S6.T2.5.5.1.m1.2.2.2.2.2.cmml">f</mi><mo id="S6.T2.5.5.1.m1.2.2.2.2.1" xref="S6.T2.5.5.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="S6.T2.5.5.1.m1.2.2.2.2.3" xref="S6.T2.5.5.1.m1.2.2.2.2.3.cmml">a</mi><mo id="S6.T2.5.5.1.m1.2.2.2.2.1a" xref="S6.T2.5.5.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="S6.T2.5.5.1.m1.2.2.2.2.4" xref="S6.T2.5.5.1.m1.2.2.2.2.4.cmml">l</mi><mo id="S6.T2.5.5.1.m1.2.2.2.2.1b" xref="S6.T2.5.5.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="S6.T2.5.5.1.m1.2.2.2.2.5" xref="S6.T2.5.5.1.m1.2.2.2.2.5.cmml">s</mi><mo id="S6.T2.5.5.1.m1.2.2.2.2.1c" xref="S6.T2.5.5.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="S6.T2.5.5.1.m1.2.2.2.2.6" xref="S6.T2.5.5.1.m1.2.2.2.2.6.cmml">e</mi></mrow><mo id="S6.T2.5.5.1.m1.2.2.2.5" stretchy="false" xref="S6.T2.5.5.1.m1.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.5.5.1.m1.2b"><set id="S6.T2.5.5.1.m1.2.2.3.cmml" xref="S6.T2.5.5.1.m1.2.2.2"><apply id="S6.T2.5.5.1.m1.1.1.1.1.cmml" xref="S6.T2.5.5.1.m1.1.1.1.1"><times id="S6.T2.5.5.1.m1.1.1.1.1.1.cmml" xref="S6.T2.5.5.1.m1.1.1.1.1.1"></times><ci id="S6.T2.5.5.1.m1.1.1.1.1.2.cmml" xref="S6.T2.5.5.1.m1.1.1.1.1.2">𝑡</ci><ci id="S6.T2.5.5.1.m1.1.1.1.1.3.cmml" xref="S6.T2.5.5.1.m1.1.1.1.1.3">𝑟</ci><ci id="S6.T2.5.5.1.m1.1.1.1.1.4.cmml" xref="S6.T2.5.5.1.m1.1.1.1.1.4">𝑢</ci><ci id="S6.T2.5.5.1.m1.1.1.1.1.5.cmml" xref="S6.T2.5.5.1.m1.1.1.1.1.5">𝑒</ci></apply><apply id="S6.T2.5.5.1.m1.2.2.2.2.cmml" xref="S6.T2.5.5.1.m1.2.2.2.2"><times id="S6.T2.5.5.1.m1.2.2.2.2.1.cmml" xref="S6.T2.5.5.1.m1.2.2.2.2.1"></times><ci id="S6.T2.5.5.1.m1.2.2.2.2.2.cmml" xref="S6.T2.5.5.1.m1.2.2.2.2.2">𝑓</ci><ci id="S6.T2.5.5.1.m1.2.2.2.2.3.cmml" xref="S6.T2.5.5.1.m1.2.2.2.2.3">𝑎</ci><ci id="S6.T2.5.5.1.m1.2.2.2.2.4.cmml" xref="S6.T2.5.5.1.m1.2.2.2.2.4">𝑙</ci><ci id="S6.T2.5.5.1.m1.2.2.2.2.5.cmml" xref="S6.T2.5.5.1.m1.2.2.2.2.5">𝑠</ci><ci id="S6.T2.5.5.1.m1.2.2.2.2.6.cmml" xref="S6.T2.5.5.1.m1.2.2.2.2.6">𝑒</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.5.5.1.m1.2c">\{true,false\}</annotation><annotation encoding="application/x-llamapun" id="S6.T2.5.5.1.m1.2d">{ italic_t italic_r italic_u italic_e , italic_f italic_a italic_l italic_s italic_e }</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S6.T2.5.5.3">CoCoOp, Maple</td>
<td class="ltx_td ltx_align_left" id="S6.T2.5.5.4">Choice</td>
</tr>
<tr class="ltx_tr" id="S6.T2.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.6.6.2">Transformer: Number of Heads</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.6.6.1"><math alttext="\{16,20,32\}" class="ltx_Math" display="inline" id="S6.T2.6.6.1.m1.3"><semantics id="S6.T2.6.6.1.m1.3a"><mrow id="S6.T2.6.6.1.m1.3.4.2" xref="S6.T2.6.6.1.m1.3.4.1.cmml"><mo id="S6.T2.6.6.1.m1.3.4.2.1" stretchy="false" xref="S6.T2.6.6.1.m1.3.4.1.cmml">{</mo><mn id="S6.T2.6.6.1.m1.1.1" xref="S6.T2.6.6.1.m1.1.1.cmml">16</mn><mo id="S6.T2.6.6.1.m1.3.4.2.2" xref="S6.T2.6.6.1.m1.3.4.1.cmml">,</mo><mn id="S6.T2.6.6.1.m1.2.2" xref="S6.T2.6.6.1.m1.2.2.cmml">20</mn><mo id="S6.T2.6.6.1.m1.3.4.2.3" xref="S6.T2.6.6.1.m1.3.4.1.cmml">,</mo><mn id="S6.T2.6.6.1.m1.3.3" xref="S6.T2.6.6.1.m1.3.3.cmml">32</mn><mo id="S6.T2.6.6.1.m1.3.4.2.4" stretchy="false" xref="S6.T2.6.6.1.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.6.6.1.m1.3b"><set id="S6.T2.6.6.1.m1.3.4.1.cmml" xref="S6.T2.6.6.1.m1.3.4.2"><cn id="S6.T2.6.6.1.m1.1.1.cmml" type="integer" xref="S6.T2.6.6.1.m1.1.1">16</cn><cn id="S6.T2.6.6.1.m1.2.2.cmml" type="integer" xref="S6.T2.6.6.1.m1.2.2">20</cn><cn id="S6.T2.6.6.1.m1.3.3.cmml" type="integer" xref="S6.T2.6.6.1.m1.3.3">32</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.6.6.1.m1.3c">\{16,20,32\}</annotation><annotation encoding="application/x-llamapun" id="S6.T2.6.6.1.m1.3d">{ 16 , 20 , 32 }</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S6.T2.6.6.3">Shared Attention</td>
<td class="ltx_td ltx_align_left" id="S6.T2.6.6.4">Choice</td>
</tr>
<tr class="ltx_tr" id="S6.T2.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.7.7.2">Transformer: Dropout Probability</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.7.7.1"><math alttext="[0.1,0.55]" class="ltx_Math" display="inline" id="S6.T2.7.7.1.m1.2"><semantics id="S6.T2.7.7.1.m1.2a"><mrow id="S6.T2.7.7.1.m1.2.3.2" xref="S6.T2.7.7.1.m1.2.3.1.cmml"><mo id="S6.T2.7.7.1.m1.2.3.2.1" stretchy="false" xref="S6.T2.7.7.1.m1.2.3.1.cmml">[</mo><mn id="S6.T2.7.7.1.m1.1.1" xref="S6.T2.7.7.1.m1.1.1.cmml">0.1</mn><mo id="S6.T2.7.7.1.m1.2.3.2.2" xref="S6.T2.7.7.1.m1.2.3.1.cmml">,</mo><mn id="S6.T2.7.7.1.m1.2.2" xref="S6.T2.7.7.1.m1.2.2.cmml">0.55</mn><mo id="S6.T2.7.7.1.m1.2.3.2.3" stretchy="false" xref="S6.T2.7.7.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.7.7.1.m1.2b"><interval closure="closed" id="S6.T2.7.7.1.m1.2.3.1.cmml" xref="S6.T2.7.7.1.m1.2.3.2"><cn id="S6.T2.7.7.1.m1.1.1.cmml" type="float" xref="S6.T2.7.7.1.m1.1.1">0.1</cn><cn id="S6.T2.7.7.1.m1.2.2.cmml" type="float" xref="S6.T2.7.7.1.m1.2.2">0.55</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.7.7.1.m1.2c">[0.1,0.55]</annotation><annotation encoding="application/x-llamapun" id="S6.T2.7.7.1.m1.2d">[ 0.1 , 0.55 ]</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S6.T2.7.7.3">Shared Attention</td>
<td class="ltx_td ltx_align_left" id="S6.T2.7.7.4">Linear</td>
</tr>
<tr class="ltx_tr" id="S6.T2.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.8.8.2">Transformer: Feed-Forward Dim</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.8.8.1"><math alttext="\{1280,1420\}" class="ltx_Math" display="inline" id="S6.T2.8.8.1.m1.2"><semantics id="S6.T2.8.8.1.m1.2a"><mrow id="S6.T2.8.8.1.m1.2.3.2" xref="S6.T2.8.8.1.m1.2.3.1.cmml"><mo id="S6.T2.8.8.1.m1.2.3.2.1" stretchy="false" xref="S6.T2.8.8.1.m1.2.3.1.cmml">{</mo><mn id="S6.T2.8.8.1.m1.1.1" xref="S6.T2.8.8.1.m1.1.1.cmml">1280</mn><mo id="S6.T2.8.8.1.m1.2.3.2.2" xref="S6.T2.8.8.1.m1.2.3.1.cmml">,</mo><mn id="S6.T2.8.8.1.m1.2.2" xref="S6.T2.8.8.1.m1.2.2.cmml">1420</mn><mo id="S6.T2.8.8.1.m1.2.3.2.3" stretchy="false" xref="S6.T2.8.8.1.m1.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.8.8.1.m1.2b"><set id="S6.T2.8.8.1.m1.2.3.1.cmml" xref="S6.T2.8.8.1.m1.2.3.2"><cn id="S6.T2.8.8.1.m1.1.1.cmml" type="integer" xref="S6.T2.8.8.1.m1.1.1">1280</cn><cn id="S6.T2.8.8.1.m1.2.2.cmml" type="integer" xref="S6.T2.8.8.1.m1.2.2">1420</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.8.8.1.m1.2c">\{1280,1420\}</annotation><annotation encoding="application/x-llamapun" id="S6.T2.8.8.1.m1.2d">{ 1280 , 1420 }</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S6.T2.8.8.3">Shared Attention</td>
<td class="ltx_td ltx_align_left" id="S6.T2.8.8.4">Choice</td>
</tr>
<tr class="ltx_tr" id="S6.T2.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.9.9.2">Transformer: LayerNorm First</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T2.9.9.1"><math alttext="\{true,false\}" class="ltx_Math" display="inline" id="S6.T2.9.9.1.m1.2"><semantics id="S6.T2.9.9.1.m1.2a"><mrow id="S6.T2.9.9.1.m1.2.2.2" xref="S6.T2.9.9.1.m1.2.2.3.cmml"><mo id="S6.T2.9.9.1.m1.2.2.2.3" stretchy="false" xref="S6.T2.9.9.1.m1.2.2.3.cmml">{</mo><mrow id="S6.T2.9.9.1.m1.1.1.1.1" xref="S6.T2.9.9.1.m1.1.1.1.1.cmml"><mi id="S6.T2.9.9.1.m1.1.1.1.1.2" xref="S6.T2.9.9.1.m1.1.1.1.1.2.cmml">t</mi><mo id="S6.T2.9.9.1.m1.1.1.1.1.1" xref="S6.T2.9.9.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S6.T2.9.9.1.m1.1.1.1.1.3" xref="S6.T2.9.9.1.m1.1.1.1.1.3.cmml">r</mi><mo id="S6.T2.9.9.1.m1.1.1.1.1.1a" xref="S6.T2.9.9.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S6.T2.9.9.1.m1.1.1.1.1.4" xref="S6.T2.9.9.1.m1.1.1.1.1.4.cmml">u</mi><mo id="S6.T2.9.9.1.m1.1.1.1.1.1b" xref="S6.T2.9.9.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S6.T2.9.9.1.m1.1.1.1.1.5" xref="S6.T2.9.9.1.m1.1.1.1.1.5.cmml">e</mi></mrow><mo id="S6.T2.9.9.1.m1.2.2.2.4" xref="S6.T2.9.9.1.m1.2.2.3.cmml">,</mo><mrow id="S6.T2.9.9.1.m1.2.2.2.2" xref="S6.T2.9.9.1.m1.2.2.2.2.cmml"><mi id="S6.T2.9.9.1.m1.2.2.2.2.2" xref="S6.T2.9.9.1.m1.2.2.2.2.2.cmml">f</mi><mo id="S6.T2.9.9.1.m1.2.2.2.2.1" xref="S6.T2.9.9.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="S6.T2.9.9.1.m1.2.2.2.2.3" xref="S6.T2.9.9.1.m1.2.2.2.2.3.cmml">a</mi><mo id="S6.T2.9.9.1.m1.2.2.2.2.1a" xref="S6.T2.9.9.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="S6.T2.9.9.1.m1.2.2.2.2.4" xref="S6.T2.9.9.1.m1.2.2.2.2.4.cmml">l</mi><mo id="S6.T2.9.9.1.m1.2.2.2.2.1b" xref="S6.T2.9.9.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="S6.T2.9.9.1.m1.2.2.2.2.5" xref="S6.T2.9.9.1.m1.2.2.2.2.5.cmml">s</mi><mo id="S6.T2.9.9.1.m1.2.2.2.2.1c" xref="S6.T2.9.9.1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="S6.T2.9.9.1.m1.2.2.2.2.6" xref="S6.T2.9.9.1.m1.2.2.2.2.6.cmml">e</mi></mrow><mo id="S6.T2.9.9.1.m1.2.2.2.5" stretchy="false" xref="S6.T2.9.9.1.m1.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.9.9.1.m1.2b"><set id="S6.T2.9.9.1.m1.2.2.3.cmml" xref="S6.T2.9.9.1.m1.2.2.2"><apply id="S6.T2.9.9.1.m1.1.1.1.1.cmml" xref="S6.T2.9.9.1.m1.1.1.1.1"><times id="S6.T2.9.9.1.m1.1.1.1.1.1.cmml" xref="S6.T2.9.9.1.m1.1.1.1.1.1"></times><ci id="S6.T2.9.9.1.m1.1.1.1.1.2.cmml" xref="S6.T2.9.9.1.m1.1.1.1.1.2">𝑡</ci><ci id="S6.T2.9.9.1.m1.1.1.1.1.3.cmml" xref="S6.T2.9.9.1.m1.1.1.1.1.3">𝑟</ci><ci id="S6.T2.9.9.1.m1.1.1.1.1.4.cmml" xref="S6.T2.9.9.1.m1.1.1.1.1.4">𝑢</ci><ci id="S6.T2.9.9.1.m1.1.1.1.1.5.cmml" xref="S6.T2.9.9.1.m1.1.1.1.1.5">𝑒</ci></apply><apply id="S6.T2.9.9.1.m1.2.2.2.2.cmml" xref="S6.T2.9.9.1.m1.2.2.2.2"><times id="S6.T2.9.9.1.m1.2.2.2.2.1.cmml" xref="S6.T2.9.9.1.m1.2.2.2.2.1"></times><ci id="S6.T2.9.9.1.m1.2.2.2.2.2.cmml" xref="S6.T2.9.9.1.m1.2.2.2.2.2">𝑓</ci><ci id="S6.T2.9.9.1.m1.2.2.2.2.3.cmml" xref="S6.T2.9.9.1.m1.2.2.2.2.3">𝑎</ci><ci id="S6.T2.9.9.1.m1.2.2.2.2.4.cmml" xref="S6.T2.9.9.1.m1.2.2.2.2.4">𝑙</ci><ci id="S6.T2.9.9.1.m1.2.2.2.2.5.cmml" xref="S6.T2.9.9.1.m1.2.2.2.2.5">𝑠</ci><ci id="S6.T2.9.9.1.m1.2.2.2.2.6.cmml" xref="S6.T2.9.9.1.m1.2.2.2.2.6">𝑒</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.9.9.1.m1.2c">\{true,false\}</annotation><annotation encoding="application/x-llamapun" id="S6.T2.9.9.1.m1.2d">{ italic_t italic_r italic_u italic_e , italic_f italic_a italic_l italic_s italic_e }</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S6.T2.9.9.3">Shared Attention</td>
<td class="ltx_td ltx_align_left" id="S6.T2.9.9.4">Choice</td>
</tr>
<tr class="ltx_tr" id="S6.T2.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T2.10.10.2">Shared Space Dimension</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T2.10.10.1"><math alttext="\{32,64\}" class="ltx_Math" display="inline" id="S6.T2.10.10.1.m1.2"><semantics id="S6.T2.10.10.1.m1.2a"><mrow id="S6.T2.10.10.1.m1.2.3.2" xref="S6.T2.10.10.1.m1.2.3.1.cmml"><mo id="S6.T2.10.10.1.m1.2.3.2.1" stretchy="false" xref="S6.T2.10.10.1.m1.2.3.1.cmml">{</mo><mn id="S6.T2.10.10.1.m1.1.1" xref="S6.T2.10.10.1.m1.1.1.cmml">32</mn><mo id="S6.T2.10.10.1.m1.2.3.2.2" xref="S6.T2.10.10.1.m1.2.3.1.cmml">,</mo><mn id="S6.T2.10.10.1.m1.2.2" xref="S6.T2.10.10.1.m1.2.2.cmml">64</mn><mo id="S6.T2.10.10.1.m1.2.3.2.3" stretchy="false" xref="S6.T2.10.10.1.m1.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.10.10.1.m1.2b"><set id="S6.T2.10.10.1.m1.2.3.1.cmml" xref="S6.T2.10.10.1.m1.2.3.2"><cn id="S6.T2.10.10.1.m1.1.1.cmml" type="integer" xref="S6.T2.10.10.1.m1.1.1">32</cn><cn id="S6.T2.10.10.1.m1.2.2.cmml" type="integer" xref="S6.T2.10.10.1.m1.2.2">64</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.10.10.1.m1.2c">\{32,64\}</annotation><annotation encoding="application/x-llamapun" id="S6.T2.10.10.1.m1.2d">{ 32 , 64 }</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T2.10.10.3">Shared Separate</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T2.10.10.4">Choice</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S6.SS2.p3">
<p class="ltx_p" id="S6.SS2.p3.2">As Jia <em class="ltx_emph ltx_font_italic" id="S6.SS2.p3.2.1">et al</em>.<span class="ltx_text" id="S6.SS2.p3.2.2"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib19" title="">19</a>]</cite> shown that the same set of hyperparameters like learning rate and weight decay may not be optimal for all the datasets, we performed hyperparameter sweeps using TPESampler <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib48" title="">48</a>]</cite> from Optuna <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib1" title="">1</a>]</cite> library.
We ran each experiment <math alttext="20" class="ltx_Math" display="inline" id="S6.SS2.p3.1.m1.1"><semantics id="S6.SS2.p3.1.m1.1a"><mn id="S6.SS2.p3.1.m1.1.1" xref="S6.SS2.p3.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.1.m1.1b"><cn id="S6.SS2.p3.1.m1.1.1.cmml" type="integer" xref="S6.SS2.p3.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.1.m1.1c">20</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p3.1.m1.1d">20</annotation></semantics></math> times with the search space for each parameter shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.T2" title="In 6.2 Implementation Details ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.
Although CoOp <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib62" title="">62</a>]</cite> and CoCoOp <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib61" title="">61</a>]</cite> have proposed to use prompt depth of <math alttext="1" class="ltx_Math" display="inline" id="S6.SS2.p3.2.m2.1"><semantics id="S6.SS2.p3.2.m2.1a"><mn id="S6.SS2.p3.2.m2.1.1" xref="S6.SS2.p3.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.2.m2.1b"><cn id="S6.SS2.p3.2.m2.1.1.cmml" type="integer" xref="S6.SS2.p3.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p3.2.m2.1d">1</annotation></semantics></math>, we wanted to observe how much can we benefit from increasing the prompt depth in those textual tuning techniques and to make the comparison across the prompting techniques fair and uniform, we have kept the prompt depth as a hyperparameter for all the context learners.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Results and Discussion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">We report the results for each viable combination of models and context learns under the search space defined by <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.T2" title="In 6.2 Implementation Details ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a> corresponding to the best set of hyperparameters in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S7.T3" title="In 7 Results and Discussion ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a>.
We explain the results shown in the table in subsequent subsections.</p>
</div>
<figure class="ltx_table" id="S7.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T3.95.2.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S7.T3.2.1" style="font-size:90%;">
The dice scores for each viable combination of VLSMs, and context learners, and end-to-end(E2E) finetuning for all datasets.
Each cell corresponds to the best dice score on each dataset after searching <math alttext="20" class="ltx_Math" display="inline" id="S7.T3.2.1.m1.1"><semantics id="S7.T3.2.1.m1.1b"><mn id="S7.T3.2.1.m1.1.1" xref="S7.T3.2.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S7.T3.2.1.m1.1c"><cn id="S7.T3.2.1.m1.1.1.cmml" type="integer" xref="S7.T3.2.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.2.1.m1.1d">20</annotation><annotation encoding="application/x-llamapun" id="S7.T3.2.1.m1.1e">20</annotation></semantics></math> times using the search space defined by <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.T2" title="In 6.2 Implementation Details ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.
</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S7.T3.93" style="width:433.6pt;height:153.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-114.2pt,40.4pt) scale(0.654904450255325,0.654904450255325) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S7.T3.93.91">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T3.3.1.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_tt" colspan="2" id="S7.T3.3.1.1.1">Datasets <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S7.T3.3.1.1.1.m1.1"><semantics id="S7.T3.3.1.1.1.m1.1a"><mo id="S7.T3.3.1.1.1.m1.1.1" stretchy="false" xref="S7.T3.3.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S7.T3.3.1.1.1.m1.1b"><ci id="S7.T3.3.1.1.1.m1.1.1.cmml" xref="S7.T3.3.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.3.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S7.T3.3.1.1.1.m1.1d">→</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S7.T3.3.1.1.2">Non-Radiology</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S7.T3.3.1.1.3">Radiology</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S7.T3.3.1.1.4">Open Domain</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="S7.T3.3.1.1.5">Overall</td>
</tr>
<tr class="ltx_tr" id="S7.T3.4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T3.4.2.2.2">Model</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T3.4.2.2.3">Context Learner</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.4.2.2.4">BKAI</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.4.2.2.5">ClinicDB</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.4.2.2.6">Kvasir</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.4.2.2.7">DFU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.4.2.2.8">ISIC</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.4.2.2.9">BUSI</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.4.2.2.10">CAMUS</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.4.2.2.11">Chexlocalize</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.4.2.2.12">Cityscapes</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.4.2.2.13">PascalVOC</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S7.T3.4.2.2.1">Mean <math alttext="\scriptscriptstyle\pm Std" class="ltx_Math" display="inline" id="S7.T3.4.2.2.1.m1.1"><semantics id="S7.T3.4.2.2.1.m1.1a"><mrow id="S7.T3.4.2.2.1.m1.1.1" xref="S7.T3.4.2.2.1.m1.1.1.cmml"><mo id="S7.T3.4.2.2.1.m1.1.1a" mathsize="50%" xref="S7.T3.4.2.2.1.m1.1.1.cmml">±</mo><mrow id="S7.T3.4.2.2.1.m1.1.1.2" xref="S7.T3.4.2.2.1.m1.1.1.2.cmml"><mi id="S7.T3.4.2.2.1.m1.1.1.2.2" mathsize="50%" xref="S7.T3.4.2.2.1.m1.1.1.2.2.cmml">S</mi><mo id="S7.T3.4.2.2.1.m1.1.1.2.1" xref="S7.T3.4.2.2.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S7.T3.4.2.2.1.m1.1.1.2.3" mathsize="50%" xref="S7.T3.4.2.2.1.m1.1.1.2.3.cmml">t</mi><mo id="S7.T3.4.2.2.1.m1.1.1.2.1a" xref="S7.T3.4.2.2.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S7.T3.4.2.2.1.m1.1.1.2.4" mathsize="50%" xref="S7.T3.4.2.2.1.m1.1.1.2.4.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.T3.4.2.2.1.m1.1b"><apply id="S7.T3.4.2.2.1.m1.1.1.cmml" xref="S7.T3.4.2.2.1.m1.1.1"><csymbol cd="latexml" id="S7.T3.4.2.2.1.m1.1.1.1.cmml" xref="S7.T3.4.2.2.1.m1.1.1">plus-or-minus</csymbol><apply id="S7.T3.4.2.2.1.m1.1.1.2.cmml" xref="S7.T3.4.2.2.1.m1.1.1.2"><times id="S7.T3.4.2.2.1.m1.1.1.2.1.cmml" xref="S7.T3.4.2.2.1.m1.1.1.2.1"></times><ci id="S7.T3.4.2.2.1.m1.1.1.2.2.cmml" xref="S7.T3.4.2.2.1.m1.1.1.2.2">𝑆</ci><ci id="S7.T3.4.2.2.1.m1.1.1.2.3.cmml" xref="S7.T3.4.2.2.1.m1.1.1.2.3">𝑡</ci><ci id="S7.T3.4.2.2.1.m1.1.1.2.4.cmml" xref="S7.T3.4.2.2.1.m1.1.1.2.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.4.2.2.1.m1.1c">\scriptscriptstyle\pm Std</annotation><annotation encoding="application/x-llamapun" id="S7.T3.4.2.2.1.m1.1d">± italic_S italic_t italic_d</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S7.T3.93.91.92.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S7.T3.93.91.92.1.1">CRIS</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S7.T3.93.91.92.1.2" rowspan="2"><span class="ltx_text" id="S7.T3.93.91.92.1.2.1">E2E finetune</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T3.93.91.92.1.3">92.40</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T3.93.91.92.1.4">91.69</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T3.93.91.92.1.5">91.39</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T3.93.91.92.1.6">76.13</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T3.93.91.92.1.7">91.94</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T3.93.91.92.1.8">69.31</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T3.93.91.92.1.9">91.09</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T3.93.91.92.1.10">62.57</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T3.93.91.92.1.11">63.50</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S7.T3.93.91.92.1.12">75.73</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="S7.T3.93.91.92.1.13" rowspan="2"><span class="ltx_text" id="S7.T3.93.91.92.1.13.1">-</span></td>
</tr>
<tr class="ltx_tr" id="S7.T3.93.91.93.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T3.93.91.93.2.1">CLIPSeg</th>
<td class="ltx_td ltx_align_center" id="S7.T3.93.91.93.2.2">86.47</td>
<td class="ltx_td ltx_align_center" id="S7.T3.93.91.93.2.3">88.74</td>
<td class="ltx_td ltx_align_center" id="S7.T3.93.91.93.2.4">89.51</td>
<td class="ltx_td ltx_align_center" id="S7.T3.93.91.93.2.5">73.24</td>
<td class="ltx_td ltx_align_center" id="S7.T3.93.91.93.2.6">92.12</td>
<td class="ltx_td ltx_align_center" id="S7.T3.93.91.93.2.7">64.32</td>
<td class="ltx_td ltx_align_center" id="S7.T3.93.91.93.2.8">88.85</td>
<td class="ltx_td ltx_align_center" id="S7.T3.93.91.93.2.9">59.56</td>
<td class="ltx_td ltx_align_center" id="S7.T3.93.91.93.2.10">59.43</td>
<td class="ltx_td ltx_align_center" id="S7.T3.93.91.93.2.11">78.88</td>
</tr>
<tr class="ltx_tr" id="S7.T3.15.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T3.15.13.13.12" rowspan="6"><span class="ltx_text" id="S7.T3.15.13.13.12.1">CLIPSeg</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T3.15.13.13.13">Maple</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.5.3.3.1"><math alttext="84.82" class="ltx_Math" display="inline" id="S7.T3.5.3.3.1.m1.1"><semantics id="S7.T3.5.3.3.1.m1.1a"><mn id="S7.T3.5.3.3.1.m1.1.1" xref="S7.T3.5.3.3.1.m1.1.1.cmml">84.82</mn><annotation-xml encoding="MathML-Content" id="S7.T3.5.3.3.1.m1.1b"><cn id="S7.T3.5.3.3.1.m1.1.1.cmml" type="float" xref="S7.T3.5.3.3.1.m1.1.1">84.82</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.5.3.3.1.m1.1c">84.82</annotation><annotation encoding="application/x-llamapun" id="S7.T3.5.3.3.1.m1.1d">84.82</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.6.4.4.2"><math alttext="\mathbf{90.61}" class="ltx_Math" display="inline" id="S7.T3.6.4.4.2.m1.1"><semantics id="S7.T3.6.4.4.2.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T3.6.4.4.2.m1.1.1" mathvariant="bold" xref="S7.T3.6.4.4.2.m1.1.1.cmml">90.61</mn><annotation-xml encoding="MathML-Content" id="S7.T3.6.4.4.2.m1.1b"><cn id="S7.T3.6.4.4.2.m1.1.1.cmml" type="float" xref="S7.T3.6.4.4.2.m1.1.1">90.61</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.6.4.4.2.m1.1c">\mathbf{90.61}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.6.4.4.2.m1.1d">bold_90.61</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.7.5.5.3"><math alttext="87.25" class="ltx_Math" display="inline" id="S7.T3.7.5.5.3.m1.1"><semantics id="S7.T3.7.5.5.3.m1.1a"><mn id="S7.T3.7.5.5.3.m1.1.1" xref="S7.T3.7.5.5.3.m1.1.1.cmml">87.25</mn><annotation-xml encoding="MathML-Content" id="S7.T3.7.5.5.3.m1.1b"><cn id="S7.T3.7.5.5.3.m1.1.1.cmml" type="float" xref="S7.T3.7.5.5.3.m1.1.1">87.25</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.7.5.5.3.m1.1c">87.25</annotation><annotation encoding="application/x-llamapun" id="S7.T3.7.5.5.3.m1.1d">87.25</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.8.6.6.4"><math alttext="\mathbf{72.68}" class="ltx_Math" display="inline" id="S7.T3.8.6.6.4.m1.1"><semantics id="S7.T3.8.6.6.4.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T3.8.6.6.4.m1.1.1" mathvariant="bold" xref="S7.T3.8.6.6.4.m1.1.1.cmml">72.68</mn><annotation-xml encoding="MathML-Content" id="S7.T3.8.6.6.4.m1.1b"><cn id="S7.T3.8.6.6.4.m1.1.1.cmml" type="float" xref="S7.T3.8.6.6.4.m1.1.1">72.68</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.8.6.6.4.m1.1c">\mathbf{72.68}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.8.6.6.4.m1.1d">bold_72.68</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.9.7.7.5"><math alttext="\mathbf{92.10}" class="ltx_Math" display="inline" id="S7.T3.9.7.7.5.m1.1"><semantics id="S7.T3.9.7.7.5.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T3.9.7.7.5.m1.1.1" mathvariant="bold" xref="S7.T3.9.7.7.5.m1.1.1.cmml">92.10</mn><annotation-xml encoding="MathML-Content" id="S7.T3.9.7.7.5.m1.1b"><cn id="S7.T3.9.7.7.5.m1.1.1.cmml" type="float" xref="S7.T3.9.7.7.5.m1.1.1">92.10</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.9.7.7.5.m1.1c">\mathbf{92.10}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.9.7.7.5.m1.1d">bold_92.10</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.10.8.8.6"><math alttext="80.99" class="ltx_Math" display="inline" id="S7.T3.10.8.8.6.m1.1"><semantics id="S7.T3.10.8.8.6.m1.1a"><mn id="S7.T3.10.8.8.6.m1.1.1" xref="S7.T3.10.8.8.6.m1.1.1.cmml">80.99</mn><annotation-xml encoding="MathML-Content" id="S7.T3.10.8.8.6.m1.1b"><cn id="S7.T3.10.8.8.6.m1.1.1.cmml" type="float" xref="S7.T3.10.8.8.6.m1.1.1">80.99</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.10.8.8.6.m1.1c">80.99</annotation><annotation encoding="application/x-llamapun" id="S7.T3.10.8.8.6.m1.1d">80.99</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.11.9.9.7"><math alttext="88.95" class="ltx_Math" display="inline" id="S7.T3.11.9.9.7.m1.1"><semantics id="S7.T3.11.9.9.7.m1.1a"><mn id="S7.T3.11.9.9.7.m1.1.1" xref="S7.T3.11.9.9.7.m1.1.1.cmml">88.95</mn><annotation-xml encoding="MathML-Content" id="S7.T3.11.9.9.7.m1.1b"><cn id="S7.T3.11.9.9.7.m1.1.1.cmml" type="float" xref="S7.T3.11.9.9.7.m1.1.1">88.95</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.11.9.9.7.m1.1c">88.95</annotation><annotation encoding="application/x-llamapun" id="S7.T3.11.9.9.7.m1.1d">88.95</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.12.10.10.8"><math alttext="58.04" class="ltx_Math" display="inline" id="S7.T3.12.10.10.8.m1.1"><semantics id="S7.T3.12.10.10.8.m1.1a"><mn id="S7.T3.12.10.10.8.m1.1.1" xref="S7.T3.12.10.10.8.m1.1.1.cmml">58.04</mn><annotation-xml encoding="MathML-Content" id="S7.T3.12.10.10.8.m1.1b"><cn id="S7.T3.12.10.10.8.m1.1.1.cmml" type="float" xref="S7.T3.12.10.10.8.m1.1.1">58.04</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.12.10.10.8.m1.1c">58.04</annotation><annotation encoding="application/x-llamapun" id="S7.T3.12.10.10.8.m1.1d">58.04</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.13.11.11.9"><math alttext="\mathbf{56.70}" class="ltx_Math" display="inline" id="S7.T3.13.11.11.9.m1.1"><semantics id="S7.T3.13.11.11.9.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T3.13.11.11.9.m1.1.1" mathvariant="bold" xref="S7.T3.13.11.11.9.m1.1.1.cmml">56.70</mn><annotation-xml encoding="MathML-Content" id="S7.T3.13.11.11.9.m1.1b"><cn id="S7.T3.13.11.11.9.m1.1.1.cmml" type="float" xref="S7.T3.13.11.11.9.m1.1.1">56.70</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.13.11.11.9.m1.1c">\mathbf{56.70}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.13.11.11.9.m1.1d">bold_56.70</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.14.12.12.10"><math alttext="\mathbf{79.48}" class="ltx_Math" display="inline" id="S7.T3.14.12.12.10.m1.1"><semantics id="S7.T3.14.12.12.10.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T3.14.12.12.10.m1.1.1" mathvariant="bold" xref="S7.T3.14.12.12.10.m1.1.1.cmml">79.48</mn><annotation-xml encoding="MathML-Content" id="S7.T3.14.12.12.10.m1.1b"><cn id="S7.T3.14.12.12.10.m1.1.1.cmml" type="float" xref="S7.T3.14.12.12.10.m1.1.1">79.48</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.14.12.12.10.m1.1c">\mathbf{79.48}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.14.12.12.10.m1.1d">bold_79.48</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S7.T3.15.13.13.11"><math alttext="79.16\scriptscriptstyle\pm 12.2" class="ltx_Math" display="inline" id="S7.T3.15.13.13.11.m1.1"><semantics id="S7.T3.15.13.13.11.m1.1a"><mrow id="S7.T3.15.13.13.11.m1.1.1" xref="S7.T3.15.13.13.11.m1.1.1.cmml"><mn id="S7.T3.15.13.13.11.m1.1.1.2" xref="S7.T3.15.13.13.11.m1.1.1.2.cmml">79.16</mn><mo id="S7.T3.15.13.13.11.m1.1.1.1" mathsize="50%" xref="S7.T3.15.13.13.11.m1.1.1.1.cmml">±</mo><mn id="S7.T3.15.13.13.11.m1.1.1.3" mathsize="50%" xref="S7.T3.15.13.13.11.m1.1.1.3.cmml">12.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T3.15.13.13.11.m1.1b"><apply id="S7.T3.15.13.13.11.m1.1.1.cmml" xref="S7.T3.15.13.13.11.m1.1.1"><csymbol cd="latexml" id="S7.T3.15.13.13.11.m1.1.1.1.cmml" xref="S7.T3.15.13.13.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T3.15.13.13.11.m1.1.1.2.cmml" type="float" xref="S7.T3.15.13.13.11.m1.1.1.2">79.16</cn><cn id="S7.T3.15.13.13.11.m1.1.1.3.cmml" type="float" xref="S7.T3.15.13.13.11.m1.1.1.3">12.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.15.13.13.11.m1.1c">79.16\scriptscriptstyle\pm 12.2</annotation><annotation encoding="application/x-llamapun" id="S7.T3.15.13.13.11.m1.1d">79.16 ± 12.2</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T3.26.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T3.26.24.24.12">Shared Sep</th>
<td class="ltx_td ltx_align_center" id="S7.T3.16.14.14.1"><math alttext="86.06" class="ltx_Math" display="inline" id="S7.T3.16.14.14.1.m1.1"><semantics id="S7.T3.16.14.14.1.m1.1a"><mn id="S7.T3.16.14.14.1.m1.1.1" xref="S7.T3.16.14.14.1.m1.1.1.cmml">86.06</mn><annotation-xml encoding="MathML-Content" id="S7.T3.16.14.14.1.m1.1b"><cn id="S7.T3.16.14.14.1.m1.1.1.cmml" type="float" xref="S7.T3.16.14.14.1.m1.1.1">86.06</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.16.14.14.1.m1.1c">86.06</annotation><annotation encoding="application/x-llamapun" id="S7.T3.16.14.14.1.m1.1d">86.06</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.17.15.15.2"><math alttext="90.30" class="ltx_Math" display="inline" id="S7.T3.17.15.15.2.m1.1"><semantics id="S7.T3.17.15.15.2.m1.1a"><mn id="S7.T3.17.15.15.2.m1.1.1" xref="S7.T3.17.15.15.2.m1.1.1.cmml">90.30</mn><annotation-xml encoding="MathML-Content" id="S7.T3.17.15.15.2.m1.1b"><cn id="S7.T3.17.15.15.2.m1.1.1.cmml" type="float" xref="S7.T3.17.15.15.2.m1.1.1">90.30</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.17.15.15.2.m1.1c">90.30</annotation><annotation encoding="application/x-llamapun" id="S7.T3.17.15.15.2.m1.1d">90.30</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.18.16.16.3"><math alttext="88.02" class="ltx_Math" display="inline" id="S7.T3.18.16.16.3.m1.1"><semantics id="S7.T3.18.16.16.3.m1.1a"><mn id="S7.T3.18.16.16.3.m1.1.1" xref="S7.T3.18.16.16.3.m1.1.1.cmml">88.02</mn><annotation-xml encoding="MathML-Content" id="S7.T3.18.16.16.3.m1.1b"><cn id="S7.T3.18.16.16.3.m1.1.1.cmml" type="float" xref="S7.T3.18.16.16.3.m1.1.1">88.02</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.18.16.16.3.m1.1c">88.02</annotation><annotation encoding="application/x-llamapun" id="S7.T3.18.16.16.3.m1.1d">88.02</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.19.17.17.4"><math alttext="71.71" class="ltx_Math" display="inline" id="S7.T3.19.17.17.4.m1.1"><semantics id="S7.T3.19.17.17.4.m1.1a"><mn id="S7.T3.19.17.17.4.m1.1.1" xref="S7.T3.19.17.17.4.m1.1.1.cmml">71.71</mn><annotation-xml encoding="MathML-Content" id="S7.T3.19.17.17.4.m1.1b"><cn id="S7.T3.19.17.17.4.m1.1.1.cmml" type="float" xref="S7.T3.19.17.17.4.m1.1.1">71.71</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.19.17.17.4.m1.1c">71.71</annotation><annotation encoding="application/x-llamapun" id="S7.T3.19.17.17.4.m1.1d">71.71</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.20.18.18.5"><math alttext="92.03" class="ltx_Math" display="inline" id="S7.T3.20.18.18.5.m1.1"><semantics id="S7.T3.20.18.18.5.m1.1a"><mn id="S7.T3.20.18.18.5.m1.1.1" xref="S7.T3.20.18.18.5.m1.1.1.cmml">92.03</mn><annotation-xml encoding="MathML-Content" id="S7.T3.20.18.18.5.m1.1b"><cn id="S7.T3.20.18.18.5.m1.1.1.cmml" type="float" xref="S7.T3.20.18.18.5.m1.1.1">92.03</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.20.18.18.5.m1.1c">92.03</annotation><annotation encoding="application/x-llamapun" id="S7.T3.20.18.18.5.m1.1d">92.03</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.21.19.19.6"><math alttext="81.71" class="ltx_Math" display="inline" id="S7.T3.21.19.19.6.m1.1"><semantics id="S7.T3.21.19.19.6.m1.1a"><mn id="S7.T3.21.19.19.6.m1.1.1" xref="S7.T3.21.19.19.6.m1.1.1.cmml">81.71</mn><annotation-xml encoding="MathML-Content" id="S7.T3.21.19.19.6.m1.1b"><cn id="S7.T3.21.19.19.6.m1.1.1.cmml" type="float" xref="S7.T3.21.19.19.6.m1.1.1">81.71</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.21.19.19.6.m1.1c">81.71</annotation><annotation encoding="application/x-llamapun" id="S7.T3.21.19.19.6.m1.1d">81.71</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.22.20.20.7"><math alttext="89.29" class="ltx_Math" display="inline" id="S7.T3.22.20.20.7.m1.1"><semantics id="S7.T3.22.20.20.7.m1.1a"><mn id="S7.T3.22.20.20.7.m1.1.1" xref="S7.T3.22.20.20.7.m1.1.1.cmml">89.29</mn><annotation-xml encoding="MathML-Content" id="S7.T3.22.20.20.7.m1.1b"><cn id="S7.T3.22.20.20.7.m1.1.1.cmml" type="float" xref="S7.T3.22.20.20.7.m1.1.1">89.29</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.22.20.20.7.m1.1c">89.29</annotation><annotation encoding="application/x-llamapun" id="S7.T3.22.20.20.7.m1.1d">89.29</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.23.21.21.8"><math alttext="\mathbf{58.95}" class="ltx_Math" display="inline" id="S7.T3.23.21.21.8.m1.1"><semantics id="S7.T3.23.21.21.8.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T3.23.21.21.8.m1.1.1" mathvariant="bold" xref="S7.T3.23.21.21.8.m1.1.1.cmml">58.95</mn><annotation-xml encoding="MathML-Content" id="S7.T3.23.21.21.8.m1.1b"><cn id="S7.T3.23.21.21.8.m1.1.1.cmml" type="float" xref="S7.T3.23.21.21.8.m1.1.1">58.95</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.23.21.21.8.m1.1c">\mathbf{58.95}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.23.21.21.8.m1.1d">bold_58.95</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.24.22.22.9"><math alttext="\mathbf{56.70}" class="ltx_Math" display="inline" id="S7.T3.24.22.22.9.m1.1"><semantics id="S7.T3.24.22.22.9.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T3.24.22.22.9.m1.1.1" mathvariant="bold" xref="S7.T3.24.22.22.9.m1.1.1.cmml">56.70</mn><annotation-xml encoding="MathML-Content" id="S7.T3.24.22.22.9.m1.1b"><cn id="S7.T3.24.22.22.9.m1.1.1.cmml" type="float" xref="S7.T3.24.22.22.9.m1.1.1">56.70</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.24.22.22.9.m1.1c">\mathbf{56.70}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.24.22.22.9.m1.1d">bold_56.70</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.25.23.23.10"><math alttext="79.46" class="ltx_Math" display="inline" id="S7.T3.25.23.23.10.m1.1"><semantics id="S7.T3.25.23.23.10.m1.1a"><mn id="S7.T3.25.23.23.10.m1.1.1" xref="S7.T3.25.23.23.10.m1.1.1.cmml">79.46</mn><annotation-xml encoding="MathML-Content" id="S7.T3.25.23.23.10.m1.1b"><cn id="S7.T3.25.23.23.10.m1.1.1.cmml" type="float" xref="S7.T3.25.23.23.10.m1.1.1">79.46</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.25.23.23.10.m1.1c">79.46</annotation><annotation encoding="application/x-llamapun" id="S7.T3.25.23.23.10.m1.1d">79.46</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T3.26.24.24.11"><math alttext="79.42\scriptscriptstyle\pm 12.22" class="ltx_Math" display="inline" id="S7.T3.26.24.24.11.m1.1"><semantics id="S7.T3.26.24.24.11.m1.1a"><mrow id="S7.T3.26.24.24.11.m1.1.1" xref="S7.T3.26.24.24.11.m1.1.1.cmml"><mn id="S7.T3.26.24.24.11.m1.1.1.2" xref="S7.T3.26.24.24.11.m1.1.1.2.cmml">79.42</mn><mo id="S7.T3.26.24.24.11.m1.1.1.1" mathsize="50%" xref="S7.T3.26.24.24.11.m1.1.1.1.cmml">±</mo><mn id="S7.T3.26.24.24.11.m1.1.1.3" mathsize="50%" xref="S7.T3.26.24.24.11.m1.1.1.3.cmml">12.22</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T3.26.24.24.11.m1.1b"><apply id="S7.T3.26.24.24.11.m1.1.1.cmml" xref="S7.T3.26.24.24.11.m1.1.1"><csymbol cd="latexml" id="S7.T3.26.24.24.11.m1.1.1.1.cmml" xref="S7.T3.26.24.24.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T3.26.24.24.11.m1.1.1.2.cmml" type="float" xref="S7.T3.26.24.24.11.m1.1.1.2">79.42</cn><cn id="S7.T3.26.24.24.11.m1.1.1.3.cmml" type="float" xref="S7.T3.26.24.24.11.m1.1.1.3">12.22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.26.24.24.11.m1.1c">79.42\scriptscriptstyle\pm 12.22</annotation><annotation encoding="application/x-llamapun" id="S7.T3.26.24.24.11.m1.1d">79.42 ± 12.22</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T3.37.35.35">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T3.37.35.35.12">Shared Attn</th>
<td class="ltx_td ltx_align_center" id="S7.T3.27.25.25.1"><math alttext="84.63" class="ltx_Math" display="inline" id="S7.T3.27.25.25.1.m1.1"><semantics id="S7.T3.27.25.25.1.m1.1a"><mn id="S7.T3.27.25.25.1.m1.1.1" xref="S7.T3.27.25.25.1.m1.1.1.cmml">84.63</mn><annotation-xml encoding="MathML-Content" id="S7.T3.27.25.25.1.m1.1b"><cn id="S7.T3.27.25.25.1.m1.1.1.cmml" type="float" xref="S7.T3.27.25.25.1.m1.1.1">84.63</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.27.25.25.1.m1.1c">84.63</annotation><annotation encoding="application/x-llamapun" id="S7.T3.27.25.25.1.m1.1d">84.63</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.28.26.26.2"><math alttext="88.43" class="ltx_Math" display="inline" id="S7.T3.28.26.26.2.m1.1"><semantics id="S7.T3.28.26.26.2.m1.1a"><mn id="S7.T3.28.26.26.2.m1.1.1" xref="S7.T3.28.26.26.2.m1.1.1.cmml">88.43</mn><annotation-xml encoding="MathML-Content" id="S7.T3.28.26.26.2.m1.1b"><cn id="S7.T3.28.26.26.2.m1.1.1.cmml" type="float" xref="S7.T3.28.26.26.2.m1.1.1">88.43</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.28.26.26.2.m1.1c">88.43</annotation><annotation encoding="application/x-llamapun" id="S7.T3.28.26.26.2.m1.1d">88.43</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.29.27.27.3"><math alttext="88.07" class="ltx_Math" display="inline" id="S7.T3.29.27.27.3.m1.1"><semantics id="S7.T3.29.27.27.3.m1.1a"><mn id="S7.T3.29.27.27.3.m1.1.1" xref="S7.T3.29.27.27.3.m1.1.1.cmml">88.07</mn><annotation-xml encoding="MathML-Content" id="S7.T3.29.27.27.3.m1.1b"><cn id="S7.T3.29.27.27.3.m1.1.1.cmml" type="float" xref="S7.T3.29.27.27.3.m1.1.1">88.07</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.29.27.27.3.m1.1c">88.07</annotation><annotation encoding="application/x-llamapun" id="S7.T3.29.27.27.3.m1.1d">88.07</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.30.28.28.4"><math alttext="68.56" class="ltx_Math" display="inline" id="S7.T3.30.28.28.4.m1.1"><semantics id="S7.T3.30.28.28.4.m1.1a"><mn id="S7.T3.30.28.28.4.m1.1.1" xref="S7.T3.30.28.28.4.m1.1.1.cmml">68.56</mn><annotation-xml encoding="MathML-Content" id="S7.T3.30.28.28.4.m1.1b"><cn id="S7.T3.30.28.28.4.m1.1.1.cmml" type="float" xref="S7.T3.30.28.28.4.m1.1.1">68.56</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.30.28.28.4.m1.1c">68.56</annotation><annotation encoding="application/x-llamapun" id="S7.T3.30.28.28.4.m1.1d">68.56</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.31.29.29.5"><math alttext="91.77" class="ltx_Math" display="inline" id="S7.T3.31.29.29.5.m1.1"><semantics id="S7.T3.31.29.29.5.m1.1a"><mn id="S7.T3.31.29.29.5.m1.1.1" xref="S7.T3.31.29.29.5.m1.1.1.cmml">91.77</mn><annotation-xml encoding="MathML-Content" id="S7.T3.31.29.29.5.m1.1b"><cn id="S7.T3.31.29.29.5.m1.1.1.cmml" type="float" xref="S7.T3.31.29.29.5.m1.1.1">91.77</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.31.29.29.5.m1.1c">91.77</annotation><annotation encoding="application/x-llamapun" id="S7.T3.31.29.29.5.m1.1d">91.77</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.32.30.30.6"><math alttext="78.22" class="ltx_Math" display="inline" id="S7.T3.32.30.30.6.m1.1"><semantics id="S7.T3.32.30.30.6.m1.1a"><mn id="S7.T3.32.30.30.6.m1.1.1" xref="S7.T3.32.30.30.6.m1.1.1.cmml">78.22</mn><annotation-xml encoding="MathML-Content" id="S7.T3.32.30.30.6.m1.1b"><cn id="S7.T3.32.30.30.6.m1.1.1.cmml" type="float" xref="S7.T3.32.30.30.6.m1.1.1">78.22</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.32.30.30.6.m1.1c">78.22</annotation><annotation encoding="application/x-llamapun" id="S7.T3.32.30.30.6.m1.1d">78.22</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.33.31.31.7"><math alttext="83.08" class="ltx_Math" display="inline" id="S7.T3.33.31.31.7.m1.1"><semantics id="S7.T3.33.31.31.7.m1.1a"><mn id="S7.T3.33.31.31.7.m1.1.1" xref="S7.T3.33.31.31.7.m1.1.1.cmml">83.08</mn><annotation-xml encoding="MathML-Content" id="S7.T3.33.31.31.7.m1.1b"><cn id="S7.T3.33.31.31.7.m1.1.1.cmml" type="float" xref="S7.T3.33.31.31.7.m1.1.1">83.08</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.33.31.31.7.m1.1c">83.08</annotation><annotation encoding="application/x-llamapun" id="S7.T3.33.31.31.7.m1.1d">83.08</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.34.32.32.8"><math alttext="53.24" class="ltx_Math" display="inline" id="S7.T3.34.32.32.8.m1.1"><semantics id="S7.T3.34.32.32.8.m1.1a"><mn id="S7.T3.34.32.32.8.m1.1.1" xref="S7.T3.34.32.32.8.m1.1.1.cmml">53.24</mn><annotation-xml encoding="MathML-Content" id="S7.T3.34.32.32.8.m1.1b"><cn id="S7.T3.34.32.32.8.m1.1.1.cmml" type="float" xref="S7.T3.34.32.32.8.m1.1.1">53.24</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.34.32.32.8.m1.1c">53.24</annotation><annotation encoding="application/x-llamapun" id="S7.T3.34.32.32.8.m1.1d">53.24</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.35.33.33.9"><math alttext="55.58" class="ltx_Math" display="inline" id="S7.T3.35.33.33.9.m1.1"><semantics id="S7.T3.35.33.33.9.m1.1a"><mn id="S7.T3.35.33.33.9.m1.1.1" xref="S7.T3.35.33.33.9.m1.1.1.cmml">55.58</mn><annotation-xml encoding="MathML-Content" id="S7.T3.35.33.33.9.m1.1b"><cn id="S7.T3.35.33.33.9.m1.1.1.cmml" type="float" xref="S7.T3.35.33.33.9.m1.1.1">55.58</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.35.33.33.9.m1.1c">55.58</annotation><annotation encoding="application/x-llamapun" id="S7.T3.35.33.33.9.m1.1d">55.58</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.36.34.34.10"><math alttext="78.80" class="ltx_Math" display="inline" id="S7.T3.36.34.34.10.m1.1"><semantics id="S7.T3.36.34.34.10.m1.1a"><mn id="S7.T3.36.34.34.10.m1.1.1" xref="S7.T3.36.34.34.10.m1.1.1.cmml">78.80</mn><annotation-xml encoding="MathML-Content" id="S7.T3.36.34.34.10.m1.1b"><cn id="S7.T3.36.34.34.10.m1.1.1.cmml" type="float" xref="S7.T3.36.34.34.10.m1.1.1">78.80</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.36.34.34.10.m1.1c">78.80</annotation><annotation encoding="application/x-llamapun" id="S7.T3.36.34.34.10.m1.1d">78.80</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T3.37.35.35.11"><math alttext="77.04\scriptscriptstyle\pm 12.91" class="ltx_Math" display="inline" id="S7.T3.37.35.35.11.m1.1"><semantics id="S7.T3.37.35.35.11.m1.1a"><mrow id="S7.T3.37.35.35.11.m1.1.1" xref="S7.T3.37.35.35.11.m1.1.1.cmml"><mn id="S7.T3.37.35.35.11.m1.1.1.2" xref="S7.T3.37.35.35.11.m1.1.1.2.cmml">77.04</mn><mo id="S7.T3.37.35.35.11.m1.1.1.1" mathsize="50%" xref="S7.T3.37.35.35.11.m1.1.1.1.cmml">±</mo><mn id="S7.T3.37.35.35.11.m1.1.1.3" mathsize="50%" xref="S7.T3.37.35.35.11.m1.1.1.3.cmml">12.91</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T3.37.35.35.11.m1.1b"><apply id="S7.T3.37.35.35.11.m1.1.1.cmml" xref="S7.T3.37.35.35.11.m1.1.1"><csymbol cd="latexml" id="S7.T3.37.35.35.11.m1.1.1.1.cmml" xref="S7.T3.37.35.35.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T3.37.35.35.11.m1.1.1.2.cmml" type="float" xref="S7.T3.37.35.35.11.m1.1.1.2">77.04</cn><cn id="S7.T3.37.35.35.11.m1.1.1.3.cmml" type="float" xref="S7.T3.37.35.35.11.m1.1.1.3">12.91</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.37.35.35.11.m1.1c">77.04\scriptscriptstyle\pm 12.91</annotation><annotation encoding="application/x-llamapun" id="S7.T3.37.35.35.11.m1.1d">77.04 ± 12.91</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T3.48.46.46">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T3.48.46.46.12">VPT</th>
<td class="ltx_td ltx_align_center" id="S7.T3.38.36.36.1"><math alttext="\mathbf{87.96}" class="ltx_Math" display="inline" id="S7.T3.38.36.36.1.m1.1"><semantics id="S7.T3.38.36.36.1.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T3.38.36.36.1.m1.1.1" mathvariant="bold" xref="S7.T3.38.36.36.1.m1.1.1.cmml">87.96</mn><annotation-xml encoding="MathML-Content" id="S7.T3.38.36.36.1.m1.1b"><cn id="S7.T3.38.36.36.1.m1.1.1.cmml" type="float" xref="S7.T3.38.36.36.1.m1.1.1">87.96</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.38.36.36.1.m1.1c">\mathbf{87.96}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.38.36.36.1.m1.1d">bold_87.96</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.39.37.37.2"><math alttext="90.31" class="ltx_Math" display="inline" id="S7.T3.39.37.37.2.m1.1"><semantics id="S7.T3.39.37.37.2.m1.1a"><mn id="S7.T3.39.37.37.2.m1.1.1" xref="S7.T3.39.37.37.2.m1.1.1.cmml">90.31</mn><annotation-xml encoding="MathML-Content" id="S7.T3.39.37.37.2.m1.1b"><cn id="S7.T3.39.37.37.2.m1.1.1.cmml" type="float" xref="S7.T3.39.37.37.2.m1.1.1">90.31</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.39.37.37.2.m1.1c">90.31</annotation><annotation encoding="application/x-llamapun" id="S7.T3.39.37.37.2.m1.1d">90.31</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.40.38.38.3"><math alttext="\mathbf{89.03}" class="ltx_Math" display="inline" id="S7.T3.40.38.38.3.m1.1"><semantics id="S7.T3.40.38.38.3.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T3.40.38.38.3.m1.1.1" mathvariant="bold" xref="S7.T3.40.38.38.3.m1.1.1.cmml">89.03</mn><annotation-xml encoding="MathML-Content" id="S7.T3.40.38.38.3.m1.1b"><cn id="S7.T3.40.38.38.3.m1.1.1.cmml" type="float" xref="S7.T3.40.38.38.3.m1.1.1">89.03</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.40.38.38.3.m1.1c">\mathbf{89.03}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.40.38.38.3.m1.1d">bold_89.03</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.41.39.39.4"><math alttext="71.76" class="ltx_Math" display="inline" id="S7.T3.41.39.39.4.m1.1"><semantics id="S7.T3.41.39.39.4.m1.1a"><mn id="S7.T3.41.39.39.4.m1.1.1" xref="S7.T3.41.39.39.4.m1.1.1.cmml">71.76</mn><annotation-xml encoding="MathML-Content" id="S7.T3.41.39.39.4.m1.1b"><cn id="S7.T3.41.39.39.4.m1.1.1.cmml" type="float" xref="S7.T3.41.39.39.4.m1.1.1">71.76</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.41.39.39.4.m1.1c">71.76</annotation><annotation encoding="application/x-llamapun" id="S7.T3.41.39.39.4.m1.1d">71.76</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.42.40.40.5"><math alttext="91.99" class="ltx_Math" display="inline" id="S7.T3.42.40.40.5.m1.1"><semantics id="S7.T3.42.40.40.5.m1.1a"><mn id="S7.T3.42.40.40.5.m1.1.1" xref="S7.T3.42.40.40.5.m1.1.1.cmml">91.99</mn><annotation-xml encoding="MathML-Content" id="S7.T3.42.40.40.5.m1.1b"><cn id="S7.T3.42.40.40.5.m1.1.1.cmml" type="float" xref="S7.T3.42.40.40.5.m1.1.1">91.99</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.42.40.40.5.m1.1c">91.99</annotation><annotation encoding="application/x-llamapun" id="S7.T3.42.40.40.5.m1.1d">91.99</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.43.41.41.6"><math alttext="\mathbf{82.45}" class="ltx_Math" display="inline" id="S7.T3.43.41.41.6.m1.1"><semantics id="S7.T3.43.41.41.6.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T3.43.41.41.6.m1.1.1" mathvariant="bold" xref="S7.T3.43.41.41.6.m1.1.1.cmml">82.45</mn><annotation-xml encoding="MathML-Content" id="S7.T3.43.41.41.6.m1.1b"><cn id="S7.T3.43.41.41.6.m1.1.1.cmml" type="float" xref="S7.T3.43.41.41.6.m1.1.1">82.45</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.43.41.41.6.m1.1c">\mathbf{82.45}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.43.41.41.6.m1.1d">bold_82.45</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.44.42.42.7"><math alttext="\mathbf{89.36}" class="ltx_Math" display="inline" id="S7.T3.44.42.42.7.m1.1"><semantics id="S7.T3.44.42.42.7.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T3.44.42.42.7.m1.1.1" mathvariant="bold" xref="S7.T3.44.42.42.7.m1.1.1.cmml">89.36</mn><annotation-xml encoding="MathML-Content" id="S7.T3.44.42.42.7.m1.1b"><cn id="S7.T3.44.42.42.7.m1.1.1.cmml" type="float" xref="S7.T3.44.42.42.7.m1.1.1">89.36</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.44.42.42.7.m1.1c">\mathbf{89.36}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.44.42.42.7.m1.1d">bold_89.36</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.45.43.43.8"><math alttext="57.67" class="ltx_Math" display="inline" id="S7.T3.45.43.43.8.m1.1"><semantics id="S7.T3.45.43.43.8.m1.1a"><mn id="S7.T3.45.43.43.8.m1.1.1" xref="S7.T3.45.43.43.8.m1.1.1.cmml">57.67</mn><annotation-xml encoding="MathML-Content" id="S7.T3.45.43.43.8.m1.1b"><cn id="S7.T3.45.43.43.8.m1.1.1.cmml" type="float" xref="S7.T3.45.43.43.8.m1.1.1">57.67</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.45.43.43.8.m1.1c">57.67</annotation><annotation encoding="application/x-llamapun" id="S7.T3.45.43.43.8.m1.1d">57.67</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.46.44.44.9"><math alttext="56.51" class="ltx_Math" display="inline" id="S7.T3.46.44.44.9.m1.1"><semantics id="S7.T3.46.44.44.9.m1.1a"><mn id="S7.T3.46.44.44.9.m1.1.1" xref="S7.T3.46.44.44.9.m1.1.1.cmml">56.51</mn><annotation-xml encoding="MathML-Content" id="S7.T3.46.44.44.9.m1.1b"><cn id="S7.T3.46.44.44.9.m1.1.1.cmml" type="float" xref="S7.T3.46.44.44.9.m1.1.1">56.51</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.46.44.44.9.m1.1c">56.51</annotation><annotation encoding="application/x-llamapun" id="S7.T3.46.44.44.9.m1.1d">56.51</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.47.45.45.10"><math alttext="79.29" class="ltx_Math" display="inline" id="S7.T3.47.45.45.10.m1.1"><semantics id="S7.T3.47.45.45.10.m1.1a"><mn id="S7.T3.47.45.45.10.m1.1.1" xref="S7.T3.47.45.45.10.m1.1.1.cmml">79.29</mn><annotation-xml encoding="MathML-Content" id="S7.T3.47.45.45.10.m1.1b"><cn id="S7.T3.47.45.45.10.m1.1.1.cmml" type="float" xref="S7.T3.47.45.45.10.m1.1.1">79.29</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.47.45.45.10.m1.1c">79.29</annotation><annotation encoding="application/x-llamapun" id="S7.T3.47.45.45.10.m1.1d">79.29</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T3.48.46.46.11"><math alttext="\mathbf{79.63\scriptscriptstyle\pm 12.67}" class="ltx_Math" display="inline" id="S7.T3.48.46.46.11.m1.1"><semantics id="S7.T3.48.46.46.11.m1.1a"><mrow id="S7.T3.48.46.46.11.m1.1.1" xref="S7.T3.48.46.46.11.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" id="S7.T3.48.46.46.11.m1.1.1.2" mathvariant="bold" xref="S7.T3.48.46.46.11.m1.1.1.2.cmml">79.63</mn><mo id="S7.T3.48.46.46.11.m1.1.1.1" mathsize="50%" xref="S7.T3.48.46.46.11.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" id="S7.T3.48.46.46.11.m1.1.1.3" mathsize="50%" mathvariant="bold" xref="S7.T3.48.46.46.11.m1.1.1.3.cmml">12.67</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T3.48.46.46.11.m1.1b"><apply id="S7.T3.48.46.46.11.m1.1.1.cmml" xref="S7.T3.48.46.46.11.m1.1.1"><csymbol cd="latexml" id="S7.T3.48.46.46.11.m1.1.1.1.cmml" xref="S7.T3.48.46.46.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T3.48.46.46.11.m1.1.1.2.cmml" type="float" xref="S7.T3.48.46.46.11.m1.1.1.2">79.63</cn><cn id="S7.T3.48.46.46.11.m1.1.1.3.cmml" type="float" xref="S7.T3.48.46.46.11.m1.1.1.3">12.67</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.48.46.46.11.m1.1c">\mathbf{79.63\scriptscriptstyle\pm 12.67}</annotation><annotation encoding="application/x-llamapun" id="S7.T3.48.46.46.11.m1.1d">bold_79.63 ± bold_12.67</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T3.59.57.57">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T3.59.57.57.12">CoCoOp</th>
<td class="ltx_td ltx_align_center" id="S7.T3.49.47.47.1"><math alttext="56.78" class="ltx_Math" display="inline" id="S7.T3.49.47.47.1.m1.1"><semantics id="S7.T3.49.47.47.1.m1.1a"><mn id="S7.T3.49.47.47.1.m1.1.1" xref="S7.T3.49.47.47.1.m1.1.1.cmml">56.78</mn><annotation-xml encoding="MathML-Content" id="S7.T3.49.47.47.1.m1.1b"><cn id="S7.T3.49.47.47.1.m1.1.1.cmml" type="float" xref="S7.T3.49.47.47.1.m1.1.1">56.78</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.49.47.47.1.m1.1c">56.78</annotation><annotation encoding="application/x-llamapun" id="S7.T3.49.47.47.1.m1.1d">56.78</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.50.48.48.2"><math alttext="74.21" class="ltx_Math" display="inline" id="S7.T3.50.48.48.2.m1.1"><semantics id="S7.T3.50.48.48.2.m1.1a"><mn id="S7.T3.50.48.48.2.m1.1.1" xref="S7.T3.50.48.48.2.m1.1.1.cmml">74.21</mn><annotation-xml encoding="MathML-Content" id="S7.T3.50.48.48.2.m1.1b"><cn id="S7.T3.50.48.48.2.m1.1.1.cmml" type="float" xref="S7.T3.50.48.48.2.m1.1.1">74.21</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.50.48.48.2.m1.1c">74.21</annotation><annotation encoding="application/x-llamapun" id="S7.T3.50.48.48.2.m1.1d">74.21</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.51.49.49.3"><math alttext="75.63" class="ltx_Math" display="inline" id="S7.T3.51.49.49.3.m1.1"><semantics id="S7.T3.51.49.49.3.m1.1a"><mn id="S7.T3.51.49.49.3.m1.1.1" xref="S7.T3.51.49.49.3.m1.1.1.cmml">75.63</mn><annotation-xml encoding="MathML-Content" id="S7.T3.51.49.49.3.m1.1b"><cn id="S7.T3.51.49.49.3.m1.1.1.cmml" type="float" xref="S7.T3.51.49.49.3.m1.1.1">75.63</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.51.49.49.3.m1.1c">75.63</annotation><annotation encoding="application/x-llamapun" id="S7.T3.51.49.49.3.m1.1d">75.63</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.52.50.50.4"><math alttext="58.64" class="ltx_Math" display="inline" id="S7.T3.52.50.50.4.m1.1"><semantics id="S7.T3.52.50.50.4.m1.1a"><mn id="S7.T3.52.50.50.4.m1.1.1" xref="S7.T3.52.50.50.4.m1.1.1.cmml">58.64</mn><annotation-xml encoding="MathML-Content" id="S7.T3.52.50.50.4.m1.1b"><cn id="S7.T3.52.50.50.4.m1.1.1.cmml" type="float" xref="S7.T3.52.50.50.4.m1.1.1">58.64</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.52.50.50.4.m1.1c">58.64</annotation><annotation encoding="application/x-llamapun" id="S7.T3.52.50.50.4.m1.1d">58.64</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.53.51.51.5"><math alttext="89.56" class="ltx_Math" display="inline" id="S7.T3.53.51.51.5.m1.1"><semantics id="S7.T3.53.51.51.5.m1.1a"><mn id="S7.T3.53.51.51.5.m1.1.1" xref="S7.T3.53.51.51.5.m1.1.1.cmml">89.56</mn><annotation-xml encoding="MathML-Content" id="S7.T3.53.51.51.5.m1.1b"><cn id="S7.T3.53.51.51.5.m1.1.1.cmml" type="float" xref="S7.T3.53.51.51.5.m1.1.1">89.56</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.53.51.51.5.m1.1c">89.56</annotation><annotation encoding="application/x-llamapun" id="S7.T3.53.51.51.5.m1.1d">89.56</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.54.52.52.6"><math alttext="70.19" class="ltx_Math" display="inline" id="S7.T3.54.52.52.6.m1.1"><semantics id="S7.T3.54.52.52.6.m1.1a"><mn id="S7.T3.54.52.52.6.m1.1.1" xref="S7.T3.54.52.52.6.m1.1.1.cmml">70.19</mn><annotation-xml encoding="MathML-Content" id="S7.T3.54.52.52.6.m1.1b"><cn id="S7.T3.54.52.52.6.m1.1.1.cmml" type="float" xref="S7.T3.54.52.52.6.m1.1.1">70.19</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.54.52.52.6.m1.1c">70.19</annotation><annotation encoding="application/x-llamapun" id="S7.T3.54.52.52.6.m1.1d">70.19</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.55.53.53.7"><math alttext="62.16" class="ltx_Math" display="inline" id="S7.T3.55.53.53.7.m1.1"><semantics id="S7.T3.55.53.53.7.m1.1a"><mn id="S7.T3.55.53.53.7.m1.1.1" xref="S7.T3.55.53.53.7.m1.1.1.cmml">62.16</mn><annotation-xml encoding="MathML-Content" id="S7.T3.55.53.53.7.m1.1b"><cn id="S7.T3.55.53.53.7.m1.1.1.cmml" type="float" xref="S7.T3.55.53.53.7.m1.1.1">62.16</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.55.53.53.7.m1.1c">62.16</annotation><annotation encoding="application/x-llamapun" id="S7.T3.55.53.53.7.m1.1d">62.16</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.56.54.54.8"><math alttext="42.77" class="ltx_Math" display="inline" id="S7.T3.56.54.54.8.m1.1"><semantics id="S7.T3.56.54.54.8.m1.1a"><mn id="S7.T3.56.54.54.8.m1.1.1" xref="S7.T3.56.54.54.8.m1.1.1.cmml">42.77</mn><annotation-xml encoding="MathML-Content" id="S7.T3.56.54.54.8.m1.1b"><cn id="S7.T3.56.54.54.8.m1.1.1.cmml" type="float" xref="S7.T3.56.54.54.8.m1.1.1">42.77</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.56.54.54.8.m1.1c">42.77</annotation><annotation encoding="application/x-llamapun" id="S7.T3.56.54.54.8.m1.1d">42.77</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.57.55.55.9"><math alttext="47.65" class="ltx_Math" display="inline" id="S7.T3.57.55.55.9.m1.1"><semantics id="S7.T3.57.55.55.9.m1.1a"><mn id="S7.T3.57.55.55.9.m1.1.1" xref="S7.T3.57.55.55.9.m1.1.1.cmml">47.65</mn><annotation-xml encoding="MathML-Content" id="S7.T3.57.55.55.9.m1.1b"><cn id="S7.T3.57.55.55.9.m1.1.1.cmml" type="float" xref="S7.T3.57.55.55.9.m1.1.1">47.65</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.57.55.55.9.m1.1c">47.65</annotation><annotation encoding="application/x-llamapun" id="S7.T3.57.55.55.9.m1.1d">47.65</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.58.56.56.10"><math alttext="75.66" class="ltx_Math" display="inline" id="S7.T3.58.56.56.10.m1.1"><semantics id="S7.T3.58.56.56.10.m1.1a"><mn id="S7.T3.58.56.56.10.m1.1.1" xref="S7.T3.58.56.56.10.m1.1.1.cmml">75.66</mn><annotation-xml encoding="MathML-Content" id="S7.T3.58.56.56.10.m1.1b"><cn id="S7.T3.58.56.56.10.m1.1.1.cmml" type="float" xref="S7.T3.58.56.56.10.m1.1.1">75.66</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.58.56.56.10.m1.1c">75.66</annotation><annotation encoding="application/x-llamapun" id="S7.T3.58.56.56.10.m1.1d">75.66</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T3.59.57.57.11"><math alttext="65.33\scriptscriptstyle\pm 13.61" class="ltx_Math" display="inline" id="S7.T3.59.57.57.11.m1.1"><semantics id="S7.T3.59.57.57.11.m1.1a"><mrow id="S7.T3.59.57.57.11.m1.1.1" xref="S7.T3.59.57.57.11.m1.1.1.cmml"><mn id="S7.T3.59.57.57.11.m1.1.1.2" xref="S7.T3.59.57.57.11.m1.1.1.2.cmml">65.33</mn><mo id="S7.T3.59.57.57.11.m1.1.1.1" mathsize="50%" xref="S7.T3.59.57.57.11.m1.1.1.1.cmml">±</mo><mn id="S7.T3.59.57.57.11.m1.1.1.3" mathsize="50%" xref="S7.T3.59.57.57.11.m1.1.1.3.cmml">13.61</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T3.59.57.57.11.m1.1b"><apply id="S7.T3.59.57.57.11.m1.1.1.cmml" xref="S7.T3.59.57.57.11.m1.1.1"><csymbol cd="latexml" id="S7.T3.59.57.57.11.m1.1.1.1.cmml" xref="S7.T3.59.57.57.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T3.59.57.57.11.m1.1.1.2.cmml" type="float" xref="S7.T3.59.57.57.11.m1.1.1.2">65.33</cn><cn id="S7.T3.59.57.57.11.m1.1.1.3.cmml" type="float" xref="S7.T3.59.57.57.11.m1.1.1.3">13.61</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.59.57.57.11.m1.1c">65.33\scriptscriptstyle\pm 13.61</annotation><annotation encoding="application/x-llamapun" id="S7.T3.59.57.57.11.m1.1d">65.33 ± 13.61</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T3.70.68.68">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T3.70.68.68.12">CoOp</th>
<td class="ltx_td ltx_align_center" id="S7.T3.60.58.58.1"><math alttext="53.85" class="ltx_Math" display="inline" id="S7.T3.60.58.58.1.m1.1"><semantics id="S7.T3.60.58.58.1.m1.1a"><mn id="S7.T3.60.58.58.1.m1.1.1" xref="S7.T3.60.58.58.1.m1.1.1.cmml">53.85</mn><annotation-xml encoding="MathML-Content" id="S7.T3.60.58.58.1.m1.1b"><cn id="S7.T3.60.58.58.1.m1.1.1.cmml" type="float" xref="S7.T3.60.58.58.1.m1.1.1">53.85</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.60.58.58.1.m1.1c">53.85</annotation><annotation encoding="application/x-llamapun" id="S7.T3.60.58.58.1.m1.1d">53.85</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.61.59.59.2"><math alttext="66.59" class="ltx_Math" display="inline" id="S7.T3.61.59.59.2.m1.1"><semantics id="S7.T3.61.59.59.2.m1.1a"><mn id="S7.T3.61.59.59.2.m1.1.1" xref="S7.T3.61.59.59.2.m1.1.1.cmml">66.59</mn><annotation-xml encoding="MathML-Content" id="S7.T3.61.59.59.2.m1.1b"><cn id="S7.T3.61.59.59.2.m1.1.1.cmml" type="float" xref="S7.T3.61.59.59.2.m1.1.1">66.59</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.61.59.59.2.m1.1c">66.59</annotation><annotation encoding="application/x-llamapun" id="S7.T3.61.59.59.2.m1.1d">66.59</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.62.60.60.3"><math alttext="73.53" class="ltx_Math" display="inline" id="S7.T3.62.60.60.3.m1.1"><semantics id="S7.T3.62.60.60.3.m1.1a"><mn id="S7.T3.62.60.60.3.m1.1.1" xref="S7.T3.62.60.60.3.m1.1.1.cmml">73.53</mn><annotation-xml encoding="MathML-Content" id="S7.T3.62.60.60.3.m1.1b"><cn id="S7.T3.62.60.60.3.m1.1.1.cmml" type="float" xref="S7.T3.62.60.60.3.m1.1.1">73.53</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.62.60.60.3.m1.1c">73.53</annotation><annotation encoding="application/x-llamapun" id="S7.T3.62.60.60.3.m1.1d">73.53</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.63.61.61.4"><math alttext="54.64" class="ltx_Math" display="inline" id="S7.T3.63.61.61.4.m1.1"><semantics id="S7.T3.63.61.61.4.m1.1a"><mn id="S7.T3.63.61.61.4.m1.1.1" xref="S7.T3.63.61.61.4.m1.1.1.cmml">54.64</mn><annotation-xml encoding="MathML-Content" id="S7.T3.63.61.61.4.m1.1b"><cn id="S7.T3.63.61.61.4.m1.1.1.cmml" type="float" xref="S7.T3.63.61.61.4.m1.1.1">54.64</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.63.61.61.4.m1.1c">54.64</annotation><annotation encoding="application/x-llamapun" id="S7.T3.63.61.61.4.m1.1d">54.64</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.64.62.62.5"><math alttext="89.00" class="ltx_Math" display="inline" id="S7.T3.64.62.62.5.m1.1"><semantics id="S7.T3.64.62.62.5.m1.1a"><mn id="S7.T3.64.62.62.5.m1.1.1" xref="S7.T3.64.62.62.5.m1.1.1.cmml">89.00</mn><annotation-xml encoding="MathML-Content" id="S7.T3.64.62.62.5.m1.1b"><cn id="S7.T3.64.62.62.5.m1.1.1.cmml" type="float" xref="S7.T3.64.62.62.5.m1.1.1">89.00</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.64.62.62.5.m1.1c">89.00</annotation><annotation encoding="application/x-llamapun" id="S7.T3.64.62.62.5.m1.1d">89.00</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.65.63.63.6"><math alttext="67.28" class="ltx_Math" display="inline" id="S7.T3.65.63.63.6.m1.1"><semantics id="S7.T3.65.63.63.6.m1.1a"><mn id="S7.T3.65.63.63.6.m1.1.1" xref="S7.T3.65.63.63.6.m1.1.1.cmml">67.28</mn><annotation-xml encoding="MathML-Content" id="S7.T3.65.63.63.6.m1.1b"><cn id="S7.T3.65.63.63.6.m1.1.1.cmml" type="float" xref="S7.T3.65.63.63.6.m1.1.1">67.28</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.65.63.63.6.m1.1c">67.28</annotation><annotation encoding="application/x-llamapun" id="S7.T3.65.63.63.6.m1.1d">67.28</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.66.64.64.7"><math alttext="58.92" class="ltx_Math" display="inline" id="S7.T3.66.64.64.7.m1.1"><semantics id="S7.T3.66.64.64.7.m1.1a"><mn id="S7.T3.66.64.64.7.m1.1.1" xref="S7.T3.66.64.64.7.m1.1.1.cmml">58.92</mn><annotation-xml encoding="MathML-Content" id="S7.T3.66.64.64.7.m1.1b"><cn id="S7.T3.66.64.64.7.m1.1.1.cmml" type="float" xref="S7.T3.66.64.64.7.m1.1.1">58.92</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.66.64.64.7.m1.1c">58.92</annotation><annotation encoding="application/x-llamapun" id="S7.T3.66.64.64.7.m1.1d">58.92</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.67.65.65.8"><math alttext="41.82" class="ltx_Math" display="inline" id="S7.T3.67.65.65.8.m1.1"><semantics id="S7.T3.67.65.65.8.m1.1a"><mn id="S7.T3.67.65.65.8.m1.1.1" xref="S7.T3.67.65.65.8.m1.1.1.cmml">41.82</mn><annotation-xml encoding="MathML-Content" id="S7.T3.67.65.65.8.m1.1b"><cn id="S7.T3.67.65.65.8.m1.1.1.cmml" type="float" xref="S7.T3.67.65.65.8.m1.1.1">41.82</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.67.65.65.8.m1.1c">41.82</annotation><annotation encoding="application/x-llamapun" id="S7.T3.67.65.65.8.m1.1d">41.82</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.68.66.66.9"><math alttext="47.92" class="ltx_Math" display="inline" id="S7.T3.68.66.66.9.m1.1"><semantics id="S7.T3.68.66.66.9.m1.1a"><mn id="S7.T3.68.66.66.9.m1.1.1" xref="S7.T3.68.66.66.9.m1.1.1.cmml">47.92</mn><annotation-xml encoding="MathML-Content" id="S7.T3.68.66.66.9.m1.1b"><cn id="S7.T3.68.66.66.9.m1.1.1.cmml" type="float" xref="S7.T3.68.66.66.9.m1.1.1">47.92</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.68.66.66.9.m1.1c">47.92</annotation><annotation encoding="application/x-llamapun" id="S7.T3.68.66.66.9.m1.1d">47.92</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.69.67.67.10"><math alttext="75.50" class="ltx_Math" display="inline" id="S7.T3.69.67.67.10.m1.1"><semantics id="S7.T3.69.67.67.10.m1.1a"><mn id="S7.T3.69.67.67.10.m1.1.1" xref="S7.T3.69.67.67.10.m1.1.1.cmml">75.50</mn><annotation-xml encoding="MathML-Content" id="S7.T3.69.67.67.10.m1.1b"><cn id="S7.T3.69.67.67.10.m1.1.1.cmml" type="float" xref="S7.T3.69.67.67.10.m1.1.1">75.50</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.69.67.67.10.m1.1c">75.50</annotation><annotation encoding="application/x-llamapun" id="S7.T3.69.67.67.10.m1.1d">75.50</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T3.70.68.68.11"><math alttext="62.91\scriptscriptstyle\pm 13.49" class="ltx_Math" display="inline" id="S7.T3.70.68.68.11.m1.1"><semantics id="S7.T3.70.68.68.11.m1.1a"><mrow id="S7.T3.70.68.68.11.m1.1.1" xref="S7.T3.70.68.68.11.m1.1.1.cmml"><mn id="S7.T3.70.68.68.11.m1.1.1.2" xref="S7.T3.70.68.68.11.m1.1.1.2.cmml">62.91</mn><mo id="S7.T3.70.68.68.11.m1.1.1.1" mathsize="50%" xref="S7.T3.70.68.68.11.m1.1.1.1.cmml">±</mo><mn id="S7.T3.70.68.68.11.m1.1.1.3" mathsize="50%" xref="S7.T3.70.68.68.11.m1.1.1.3.cmml">13.49</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T3.70.68.68.11.m1.1b"><apply id="S7.T3.70.68.68.11.m1.1.1.cmml" xref="S7.T3.70.68.68.11.m1.1.1"><csymbol cd="latexml" id="S7.T3.70.68.68.11.m1.1.1.1.cmml" xref="S7.T3.70.68.68.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T3.70.68.68.11.m1.1.1.2.cmml" type="float" xref="S7.T3.70.68.68.11.m1.1.1.2">62.91</cn><cn id="S7.T3.70.68.68.11.m1.1.1.3.cmml" type="float" xref="S7.T3.70.68.68.11.m1.1.1.3">13.49</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.70.68.68.11.m1.1c">62.91\scriptscriptstyle\pm 13.49</annotation><annotation encoding="application/x-llamapun" id="S7.T3.70.68.68.11.m1.1d">62.91 ± 13.49</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T3.81.79.79">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T3.81.79.79.12" rowspan="2"><span class="ltx_text" id="S7.T3.81.79.79.12.1">CRIS</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T3.81.79.79.13">CoCoOp</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.71.69.69.1"><math alttext="76.85" class="ltx_Math" display="inline" id="S7.T3.71.69.69.1.m1.1"><semantics id="S7.T3.71.69.69.1.m1.1a"><mn id="S7.T3.71.69.69.1.m1.1.1" xref="S7.T3.71.69.69.1.m1.1.1.cmml">76.85</mn><annotation-xml encoding="MathML-Content" id="S7.T3.71.69.69.1.m1.1b"><cn id="S7.T3.71.69.69.1.m1.1.1.cmml" type="float" xref="S7.T3.71.69.69.1.m1.1.1">76.85</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.71.69.69.1.m1.1c">76.85</annotation><annotation encoding="application/x-llamapun" id="S7.T3.71.69.69.1.m1.1d">76.85</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.72.70.70.2"><math alttext="85.09" class="ltx_Math" display="inline" id="S7.T3.72.70.70.2.m1.1"><semantics id="S7.T3.72.70.70.2.m1.1a"><mn id="S7.T3.72.70.70.2.m1.1.1" xref="S7.T3.72.70.70.2.m1.1.1.cmml">85.09</mn><annotation-xml encoding="MathML-Content" id="S7.T3.72.70.70.2.m1.1b"><cn id="S7.T3.72.70.70.2.m1.1.1.cmml" type="float" xref="S7.T3.72.70.70.2.m1.1.1">85.09</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.72.70.70.2.m1.1c">85.09</annotation><annotation encoding="application/x-llamapun" id="S7.T3.72.70.70.2.m1.1d">85.09</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.73.71.71.3"><math alttext="82.12" class="ltx_Math" display="inline" id="S7.T3.73.71.71.3.m1.1"><semantics id="S7.T3.73.71.71.3.m1.1a"><mn id="S7.T3.73.71.71.3.m1.1.1" xref="S7.T3.73.71.71.3.m1.1.1.cmml">82.12</mn><annotation-xml encoding="MathML-Content" id="S7.T3.73.71.71.3.m1.1b"><cn id="S7.T3.73.71.71.3.m1.1.1.cmml" type="float" xref="S7.T3.73.71.71.3.m1.1.1">82.12</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.73.71.71.3.m1.1c">82.12</annotation><annotation encoding="application/x-llamapun" id="S7.T3.73.71.71.3.m1.1d">82.12</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.74.72.72.4"><math alttext="58.24" class="ltx_Math" display="inline" id="S7.T3.74.72.72.4.m1.1"><semantics id="S7.T3.74.72.72.4.m1.1a"><mn id="S7.T3.74.72.72.4.m1.1.1" xref="S7.T3.74.72.72.4.m1.1.1.cmml">58.24</mn><annotation-xml encoding="MathML-Content" id="S7.T3.74.72.72.4.m1.1b"><cn id="S7.T3.74.72.72.4.m1.1.1.cmml" type="float" xref="S7.T3.74.72.72.4.m1.1.1">58.24</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.74.72.72.4.m1.1c">58.24</annotation><annotation encoding="application/x-llamapun" id="S7.T3.74.72.72.4.m1.1d">58.24</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.75.73.73.5"><math alttext="86.87" class="ltx_Math" display="inline" id="S7.T3.75.73.73.5.m1.1"><semantics id="S7.T3.75.73.73.5.m1.1a"><mn id="S7.T3.75.73.73.5.m1.1.1" xref="S7.T3.75.73.73.5.m1.1.1.cmml">86.87</mn><annotation-xml encoding="MathML-Content" id="S7.T3.75.73.73.5.m1.1b"><cn id="S7.T3.75.73.73.5.m1.1.1.cmml" type="float" xref="S7.T3.75.73.73.5.m1.1.1">86.87</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.75.73.73.5.m1.1c">86.87</annotation><annotation encoding="application/x-llamapun" id="S7.T3.75.73.73.5.m1.1d">86.87</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.76.74.74.6"><math alttext="72.95" class="ltx_Math" display="inline" id="S7.T3.76.74.74.6.m1.1"><semantics id="S7.T3.76.74.74.6.m1.1a"><mn id="S7.T3.76.74.74.6.m1.1.1" xref="S7.T3.76.74.74.6.m1.1.1.cmml">72.95</mn><annotation-xml encoding="MathML-Content" id="S7.T3.76.74.74.6.m1.1b"><cn id="S7.T3.76.74.74.6.m1.1.1.cmml" type="float" xref="S7.T3.76.74.74.6.m1.1.1">72.95</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.76.74.74.6.m1.1c">72.95</annotation><annotation encoding="application/x-llamapun" id="S7.T3.76.74.74.6.m1.1d">72.95</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.77.75.75.7"><math alttext="81.96" class="ltx_Math" display="inline" id="S7.T3.77.75.75.7.m1.1"><semantics id="S7.T3.77.75.75.7.m1.1a"><mn id="S7.T3.77.75.75.7.m1.1.1" xref="S7.T3.77.75.75.7.m1.1.1.cmml">81.96</mn><annotation-xml encoding="MathML-Content" id="S7.T3.77.75.75.7.m1.1b"><cn id="S7.T3.77.75.75.7.m1.1.1.cmml" type="float" xref="S7.T3.77.75.75.7.m1.1.1">81.96</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.77.75.75.7.m1.1c">81.96</annotation><annotation encoding="application/x-llamapun" id="S7.T3.77.75.75.7.m1.1d">81.96</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.78.76.76.8"><math alttext="51.28" class="ltx_Math" display="inline" id="S7.T3.78.76.76.8.m1.1"><semantics id="S7.T3.78.76.76.8.m1.1a"><mn id="S7.T3.78.76.76.8.m1.1.1" xref="S7.T3.78.76.76.8.m1.1.1.cmml">51.28</mn><annotation-xml encoding="MathML-Content" id="S7.T3.78.76.76.8.m1.1b"><cn id="S7.T3.78.76.76.8.m1.1.1.cmml" type="float" xref="S7.T3.78.76.76.8.m1.1.1">51.28</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.78.76.76.8.m1.1c">51.28</annotation><annotation encoding="application/x-llamapun" id="S7.T3.78.76.76.8.m1.1d">51.28</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.79.77.77.9"><math alttext="44.88" class="ltx_Math" display="inline" id="S7.T3.79.77.77.9.m1.1"><semantics id="S7.T3.79.77.77.9.m1.1a"><mn id="S7.T3.79.77.77.9.m1.1.1" xref="S7.T3.79.77.77.9.m1.1.1.cmml">44.88</mn><annotation-xml encoding="MathML-Content" id="S7.T3.79.77.77.9.m1.1b"><cn id="S7.T3.79.77.77.9.m1.1.1.cmml" type="float" xref="S7.T3.79.77.77.9.m1.1.1">44.88</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.79.77.77.9.m1.1c">44.88</annotation><annotation encoding="application/x-llamapun" id="S7.T3.79.77.77.9.m1.1d">44.88</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T3.80.78.78.10"><math alttext="72.46" class="ltx_Math" display="inline" id="S7.T3.80.78.78.10.m1.1"><semantics id="S7.T3.80.78.78.10.m1.1a"><mn id="S7.T3.80.78.78.10.m1.1.1" xref="S7.T3.80.78.78.10.m1.1.1.cmml">72.46</mn><annotation-xml encoding="MathML-Content" id="S7.T3.80.78.78.10.m1.1b"><cn id="S7.T3.80.78.78.10.m1.1.1.cmml" type="float" xref="S7.T3.80.78.78.10.m1.1.1">72.46</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.80.78.78.10.m1.1c">72.46</annotation><annotation encoding="application/x-llamapun" id="S7.T3.80.78.78.10.m1.1d">72.46</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S7.T3.81.79.79.11"><math alttext="71.27\scriptscriptstyle\pm 14.03" class="ltx_Math" display="inline" id="S7.T3.81.79.79.11.m1.1"><semantics id="S7.T3.81.79.79.11.m1.1a"><mrow id="S7.T3.81.79.79.11.m1.1.1" xref="S7.T3.81.79.79.11.m1.1.1.cmml"><mn id="S7.T3.81.79.79.11.m1.1.1.2" xref="S7.T3.81.79.79.11.m1.1.1.2.cmml">71.27</mn><mo id="S7.T3.81.79.79.11.m1.1.1.1" mathsize="50%" xref="S7.T3.81.79.79.11.m1.1.1.1.cmml">±</mo><mn id="S7.T3.81.79.79.11.m1.1.1.3" mathsize="50%" xref="S7.T3.81.79.79.11.m1.1.1.3.cmml">14.03</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T3.81.79.79.11.m1.1b"><apply id="S7.T3.81.79.79.11.m1.1.1.cmml" xref="S7.T3.81.79.79.11.m1.1.1"><csymbol cd="latexml" id="S7.T3.81.79.79.11.m1.1.1.1.cmml" xref="S7.T3.81.79.79.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T3.81.79.79.11.m1.1.1.2.cmml" type="float" xref="S7.T3.81.79.79.11.m1.1.1.2">71.27</cn><cn id="S7.T3.81.79.79.11.m1.1.1.3.cmml" type="float" xref="S7.T3.81.79.79.11.m1.1.1.3">14.03</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.81.79.79.11.m1.1c">71.27\scriptscriptstyle\pm 14.03</annotation><annotation encoding="application/x-llamapun" id="S7.T3.81.79.79.11.m1.1d">71.27 ± 14.03</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T3.92.90.90">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T3.92.90.90.12">CoOp</th>
<td class="ltx_td ltx_align_center" id="S7.T3.82.80.80.1"><math alttext="75.55" class="ltx_Math" display="inline" id="S7.T3.82.80.80.1.m1.1"><semantics id="S7.T3.82.80.80.1.m1.1a"><mn id="S7.T3.82.80.80.1.m1.1.1" xref="S7.T3.82.80.80.1.m1.1.1.cmml">75.55</mn><annotation-xml encoding="MathML-Content" id="S7.T3.82.80.80.1.m1.1b"><cn id="S7.T3.82.80.80.1.m1.1.1.cmml" type="float" xref="S7.T3.82.80.80.1.m1.1.1">75.55</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.82.80.80.1.m1.1c">75.55</annotation><annotation encoding="application/x-llamapun" id="S7.T3.82.80.80.1.m1.1d">75.55</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.83.81.81.2"><math alttext="76.73" class="ltx_Math" display="inline" id="S7.T3.83.81.81.2.m1.1"><semantics id="S7.T3.83.81.81.2.m1.1a"><mn id="S7.T3.83.81.81.2.m1.1.1" xref="S7.T3.83.81.81.2.m1.1.1.cmml">76.73</mn><annotation-xml encoding="MathML-Content" id="S7.T3.83.81.81.2.m1.1b"><cn id="S7.T3.83.81.81.2.m1.1.1.cmml" type="float" xref="S7.T3.83.81.81.2.m1.1.1">76.73</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.83.81.81.2.m1.1c">76.73</annotation><annotation encoding="application/x-llamapun" id="S7.T3.83.81.81.2.m1.1d">76.73</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.84.82.82.3"><math alttext="80.38" class="ltx_Math" display="inline" id="S7.T3.84.82.82.3.m1.1"><semantics id="S7.T3.84.82.82.3.m1.1a"><mn id="S7.T3.84.82.82.3.m1.1.1" xref="S7.T3.84.82.82.3.m1.1.1.cmml">80.38</mn><annotation-xml encoding="MathML-Content" id="S7.T3.84.82.82.3.m1.1b"><cn id="S7.T3.84.82.82.3.m1.1.1.cmml" type="float" xref="S7.T3.84.82.82.3.m1.1.1">80.38</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.84.82.82.3.m1.1c">80.38</annotation><annotation encoding="application/x-llamapun" id="S7.T3.84.82.82.3.m1.1d">80.38</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.85.83.83.4"><math alttext="57.18" class="ltx_Math" display="inline" id="S7.T3.85.83.83.4.m1.1"><semantics id="S7.T3.85.83.83.4.m1.1a"><mn id="S7.T3.85.83.83.4.m1.1.1" xref="S7.T3.85.83.83.4.m1.1.1.cmml">57.18</mn><annotation-xml encoding="MathML-Content" id="S7.T3.85.83.83.4.m1.1b"><cn id="S7.T3.85.83.83.4.m1.1.1.cmml" type="float" xref="S7.T3.85.83.83.4.m1.1.1">57.18</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.85.83.83.4.m1.1c">57.18</annotation><annotation encoding="application/x-llamapun" id="S7.T3.85.83.83.4.m1.1d">57.18</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.86.84.84.5"><math alttext="86.10" class="ltx_Math" display="inline" id="S7.T3.86.84.84.5.m1.1"><semantics id="S7.T3.86.84.84.5.m1.1a"><mn id="S7.T3.86.84.84.5.m1.1.1" xref="S7.T3.86.84.84.5.m1.1.1.cmml">86.10</mn><annotation-xml encoding="MathML-Content" id="S7.T3.86.84.84.5.m1.1b"><cn id="S7.T3.86.84.84.5.m1.1.1.cmml" type="float" xref="S7.T3.86.84.84.5.m1.1.1">86.10</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.86.84.84.5.m1.1c">86.10</annotation><annotation encoding="application/x-llamapun" id="S7.T3.86.84.84.5.m1.1d">86.10</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.87.85.85.6"><math alttext="75.46" class="ltx_Math" display="inline" id="S7.T3.87.85.85.6.m1.1"><semantics id="S7.T3.87.85.85.6.m1.1a"><mn id="S7.T3.87.85.85.6.m1.1.1" xref="S7.T3.87.85.85.6.m1.1.1.cmml">75.46</mn><annotation-xml encoding="MathML-Content" id="S7.T3.87.85.85.6.m1.1b"><cn id="S7.T3.87.85.85.6.m1.1.1.cmml" type="float" xref="S7.T3.87.85.85.6.m1.1.1">75.46</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.87.85.85.6.m1.1c">75.46</annotation><annotation encoding="application/x-llamapun" id="S7.T3.87.85.85.6.m1.1d">75.46</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.88.86.86.7"><math alttext="79.23" class="ltx_Math" display="inline" id="S7.T3.88.86.86.7.m1.1"><semantics id="S7.T3.88.86.86.7.m1.1a"><mn id="S7.T3.88.86.86.7.m1.1.1" xref="S7.T3.88.86.86.7.m1.1.1.cmml">79.23</mn><annotation-xml encoding="MathML-Content" id="S7.T3.88.86.86.7.m1.1b"><cn id="S7.T3.88.86.86.7.m1.1.1.cmml" type="float" xref="S7.T3.88.86.86.7.m1.1.1">79.23</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.88.86.86.7.m1.1c">79.23</annotation><annotation encoding="application/x-llamapun" id="S7.T3.88.86.86.7.m1.1d">79.23</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.89.87.87.8"><math alttext="51.79" class="ltx_Math" display="inline" id="S7.T3.89.87.87.8.m1.1"><semantics id="S7.T3.89.87.87.8.m1.1a"><mn id="S7.T3.89.87.87.8.m1.1.1" xref="S7.T3.89.87.87.8.m1.1.1.cmml">51.79</mn><annotation-xml encoding="MathML-Content" id="S7.T3.89.87.87.8.m1.1b"><cn id="S7.T3.89.87.87.8.m1.1.1.cmml" type="float" xref="S7.T3.89.87.87.8.m1.1.1">51.79</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.89.87.87.8.m1.1c">51.79</annotation><annotation encoding="application/x-llamapun" id="S7.T3.89.87.87.8.m1.1d">51.79</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.90.88.88.9"><math alttext="46.50" class="ltx_Math" display="inline" id="S7.T3.90.88.88.9.m1.1"><semantics id="S7.T3.90.88.88.9.m1.1a"><mn id="S7.T3.90.88.88.9.m1.1.1" xref="S7.T3.90.88.88.9.m1.1.1.cmml">46.50</mn><annotation-xml encoding="MathML-Content" id="S7.T3.90.88.88.9.m1.1b"><cn id="S7.T3.90.88.88.9.m1.1.1.cmml" type="float" xref="S7.T3.90.88.88.9.m1.1.1">46.50</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.90.88.88.9.m1.1c">46.50</annotation><annotation encoding="application/x-llamapun" id="S7.T3.90.88.88.9.m1.1d">46.50</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T3.91.89.89.10"><math alttext="71.72" class="ltx_Math" display="inline" id="S7.T3.91.89.89.10.m1.1"><semantics id="S7.T3.91.89.89.10.m1.1a"><mn id="S7.T3.91.89.89.10.m1.1.1" xref="S7.T3.91.89.89.10.m1.1.1.cmml">71.72</mn><annotation-xml encoding="MathML-Content" id="S7.T3.91.89.89.10.m1.1b"><cn id="S7.T3.91.89.89.10.m1.1.1.cmml" type="float" xref="S7.T3.91.89.89.10.m1.1.1">71.72</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.91.89.89.10.m1.1c">71.72</annotation><annotation encoding="application/x-llamapun" id="S7.T3.91.89.89.10.m1.1d">71.72</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T3.92.90.90.11"><math alttext="70.06\scriptscriptstyle\pm 12.69" class="ltx_Math" display="inline" id="S7.T3.92.90.90.11.m1.1"><semantics id="S7.T3.92.90.90.11.m1.1a"><mrow id="S7.T3.92.90.90.11.m1.1.1" xref="S7.T3.92.90.90.11.m1.1.1.cmml"><mn id="S7.T3.92.90.90.11.m1.1.1.2" xref="S7.T3.92.90.90.11.m1.1.1.2.cmml">70.06</mn><mo id="S7.T3.92.90.90.11.m1.1.1.1" mathsize="50%" xref="S7.T3.92.90.90.11.m1.1.1.1.cmml">±</mo><mn id="S7.T3.92.90.90.11.m1.1.1.3" mathsize="50%" xref="S7.T3.92.90.90.11.m1.1.1.3.cmml">12.69</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T3.92.90.90.11.m1.1b"><apply id="S7.T3.92.90.90.11.m1.1.1.cmml" xref="S7.T3.92.90.90.11.m1.1.1"><csymbol cd="latexml" id="S7.T3.92.90.90.11.m1.1.1.1.cmml" xref="S7.T3.92.90.90.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T3.92.90.90.11.m1.1.1.2.cmml" type="float" xref="S7.T3.92.90.90.11.m1.1.1.2">70.06</cn><cn id="S7.T3.92.90.90.11.m1.1.1.3.cmml" type="float" xref="S7.T3.92.90.90.11.m1.1.1.3">12.69</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.92.90.90.11.m1.1c">70.06\scriptscriptstyle\pm 12.69</annotation><annotation encoding="application/x-llamapun" id="S7.T3.92.90.90.11.m1.1d">70.06 ± 12.69</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T3.93.91.91">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_t" colspan="12" id="S7.T3.93.91.91.2">Average across Methods</th>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" id="S7.T3.93.91.91.1"><math alttext="73.10\scriptscriptstyle\pm 6.24" class="ltx_Math" display="inline" id="S7.T3.93.91.91.1.m1.1"><semantics id="S7.T3.93.91.91.1.m1.1a"><mrow id="S7.T3.93.91.91.1.m1.1.1" xref="S7.T3.93.91.91.1.m1.1.1.cmml"><mn id="S7.T3.93.91.91.1.m1.1.1.2" xref="S7.T3.93.91.91.1.m1.1.1.2.cmml">73.10</mn><mo id="S7.T3.93.91.91.1.m1.1.1.1" mathsize="50%" xref="S7.T3.93.91.91.1.m1.1.1.1.cmml">±</mo><mn id="S7.T3.93.91.91.1.m1.1.1.3" mathsize="50%" xref="S7.T3.93.91.91.1.m1.1.1.3.cmml">6.24</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T3.93.91.91.1.m1.1b"><apply id="S7.T3.93.91.91.1.m1.1.1.cmml" xref="S7.T3.93.91.91.1.m1.1.1"><csymbol cd="latexml" id="S7.T3.93.91.91.1.m1.1.1.1.cmml" xref="S7.T3.93.91.91.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T3.93.91.91.1.m1.1.1.2.cmml" type="float" xref="S7.T3.93.91.91.1.m1.1.1.2">73.10</cn><cn id="S7.T3.93.91.91.1.m1.1.1.3.cmml" type="float" xref="S7.T3.93.91.91.1.m1.1.1.3">6.24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.93.91.91.1.m1.1c">73.10\scriptscriptstyle\pm 6.24</annotation><annotation encoding="application/x-llamapun" id="S7.T3.93.91.91.1.m1.1d">73.10 ± 6.24</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section class="ltx_subsection" id="S7.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Choice of Prompt Tuning Technique</h3>
<div class="ltx_para" id="S7.SS1.p1">
<p class="ltx_p" id="S7.SS1.p1.1">From <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S7.T3" title="In 7 Results and Discussion ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, we can see that the textual prompt tuning methods viz. CoCoOp and CoOp perform significantly worse than other prompt tuning techniques.
The table shows that although Maple <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib23" title="">23</a>]</cite> has the highest dice scores for some datasets, VPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib19" title="">19</a>]</cite> has the highest average dice score across the test datasets despite not tuning the textual prompts.
We hypothesize that since we used the same number of search trials for all the context learners, finding the optimal set of hyperparameters for VPT is easier as it has fewer hyperparameters than the multimodal variants (see <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.T2" title="In 6.2 Implementation Details ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a>).
Also, this could have occurred because, as shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.F4" title="In 6.1 Datasets ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, there is a significant domain shift from the open domain to the medical domain in the image domain only.
This premise is supported by the observation that VPT performs better than the multimodal variants in the medical domain but the multimodal variants perform better than VPT in the open domain datasets (see <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.T2" title="In 6.2 Implementation Details ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">2</span></a>).
From this observation, we can infer that VPT is a good starting point when you have a dataset different from the ones on which the VLSMs were pretrained.</p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>Importance of Prompt Initialization</h3>
<div class="ltx_para" id="S7.SS2.p1">
<p class="ltx_p" id="S7.SS2.p1.1">As shown by Zhou <em class="ltx_emph ltx_font_italic" id="S7.SS2.p1.1.1">et al</em>.<span class="ltx_text" id="S7.SS2.p1.1.2"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib62" title="">62</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib61" title="">61</a>]</cite>, a good initialization of the prompts leads to a better performance.
Rather than randomly initializing the first prompt to CLIP’s text encoder, they found initializing it with the embeddings of “a photo of a” led to a better performance.
So, for the context learners where the prompts are initialized in the textual space viz. CoOp, CoCoOp, and Maple, the first prompt is initialized as mentioned above.
We hypothesize that the ability to initialize the context vectors in the text space of the CLIP’s text encoder in Maple <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib23" title="">23</a>]</cite> could be the reason why Maple performed better than the other multimodal prompt tuning techniques in some datasets.
We trained Maple on CLIPSeg by initializing the context vectors from a Gaussian distribution (<math alttext="\mu=0,\sigma=0.02" class="ltx_Math" display="inline" id="S7.SS2.p1.1.m1.2"><semantics id="S7.SS2.p1.1.m1.2a"><mrow id="S7.SS2.p1.1.m1.2.2.2" xref="S7.SS2.p1.1.m1.2.2.3.cmml"><mrow id="S7.SS2.p1.1.m1.1.1.1.1" xref="S7.SS2.p1.1.m1.1.1.1.1.cmml"><mi id="S7.SS2.p1.1.m1.1.1.1.1.2" xref="S7.SS2.p1.1.m1.1.1.1.1.2.cmml">μ</mi><mo id="S7.SS2.p1.1.m1.1.1.1.1.1" xref="S7.SS2.p1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S7.SS2.p1.1.m1.1.1.1.1.3" xref="S7.SS2.p1.1.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="S7.SS2.p1.1.m1.2.2.2.3" xref="S7.SS2.p1.1.m1.2.2.3a.cmml">,</mo><mrow id="S7.SS2.p1.1.m1.2.2.2.2" xref="S7.SS2.p1.1.m1.2.2.2.2.cmml"><mi id="S7.SS2.p1.1.m1.2.2.2.2.2" xref="S7.SS2.p1.1.m1.2.2.2.2.2.cmml">σ</mi><mo id="S7.SS2.p1.1.m1.2.2.2.2.1" xref="S7.SS2.p1.1.m1.2.2.2.2.1.cmml">=</mo><mn id="S7.SS2.p1.1.m1.2.2.2.2.3" xref="S7.SS2.p1.1.m1.2.2.2.2.3.cmml">0.02</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS2.p1.1.m1.2b"><apply id="S7.SS2.p1.1.m1.2.2.3.cmml" xref="S7.SS2.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S7.SS2.p1.1.m1.2.2.3a.cmml" xref="S7.SS2.p1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S7.SS2.p1.1.m1.1.1.1.1.cmml" xref="S7.SS2.p1.1.m1.1.1.1.1"><eq id="S7.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S7.SS2.p1.1.m1.1.1.1.1.1"></eq><ci id="S7.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S7.SS2.p1.1.m1.1.1.1.1.2">𝜇</ci><cn id="S7.SS2.p1.1.m1.1.1.1.1.3.cmml" type="integer" xref="S7.SS2.p1.1.m1.1.1.1.1.3">0</cn></apply><apply id="S7.SS2.p1.1.m1.2.2.2.2.cmml" xref="S7.SS2.p1.1.m1.2.2.2.2"><eq id="S7.SS2.p1.1.m1.2.2.2.2.1.cmml" xref="S7.SS2.p1.1.m1.2.2.2.2.1"></eq><ci id="S7.SS2.p1.1.m1.2.2.2.2.2.cmml" xref="S7.SS2.p1.1.m1.2.2.2.2.2">𝜎</ci><cn id="S7.SS2.p1.1.m1.2.2.2.2.3.cmml" type="float" xref="S7.SS2.p1.1.m1.2.2.2.2.3">0.02</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p1.1.m1.2c">\mu=0,\sigma=0.02</annotation><annotation encoding="application/x-llamapun" id="S7.SS2.p1.1.m1.2d">italic_μ = 0 , italic_σ = 0.02</annotation></semantics></math>).
From <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S7.T4" title="In 7.2 Importance of Prompt Initialization ‣ 7 Results and Discussion ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, we can see that the performance of Maple decreases for most of the dataset when the context vectors for the first depth are initialized at random, which supports our hypothesis.
Additionally, the performance of different prompt tuning methods, is comparable for most of the datasets with end-to-end fine-tuning (Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S7.T3" title="Table 3 ‣ 7 Results and Discussion ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">3</span></a>, scores for the medical datasets are extracted from Poudel <em class="ltx_emph ltx_font_italic" id="S7.SS2.p1.1.3">et al</em>.<span class="ltx_text" id="S7.SS2.p1.1.4"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib36" title="">36</a>]</cite> and the rest are trained with the same set of hyperparameters.).</p>
</div>
<figure class="ltx_table" id="S7.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T4.27.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S7.T4.28.2" style="font-size:90%;">
Performance of Maple when the first vector is initialized from Gaussian distribution vs ‘a photo of a’.
</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S7.T4.25" style="width:433.6pt;height:52.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-82.7pt,9.9pt) scale(0.723871891294554,0.723871891294554) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S7.T4.25.25">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S7.T4.1.1.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S7.T4.1.1.1.1">Datasets <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S7.T4.1.1.1.1.m1.1"><semantics id="S7.T4.1.1.1.1.m1.1a"><mo id="S7.T4.1.1.1.1.m1.1.1" stretchy="false" xref="S7.T4.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S7.T4.1.1.1.1.m1.1b"><ci id="S7.T4.1.1.1.1.m1.1.1.cmml" xref="S7.T4.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S7.T4.1.1.1.1.m1.1d">→</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S7.T4.1.1.1.2">Non-Radiology</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S7.T4.1.1.1.3">Radiology</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S7.T4.1.1.1.4">Open Domain</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S7.T4.1.1.1.5">Overall</th>
</tr>
<tr class="ltx_tr" id="S7.T4.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S7.T4.2.2.2.1">Init <math alttext="\downarrow" class="ltx_Math" display="inline" id="S7.T4.2.2.2.1.m1.1"><semantics id="S7.T4.2.2.2.1.m1.1a"><mo id="S7.T4.2.2.2.1.m1.1.1" stretchy="false" xref="S7.T4.2.2.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S7.T4.2.2.2.1.m1.1b"><ci id="S7.T4.2.2.2.1.m1.1.1.cmml" xref="S7.T4.2.2.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.2.2.2.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S7.T4.2.2.2.1.m1.1d">↓</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T4.3.3.3.3">BKAI</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T4.3.3.3.4">ClinicDB</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T4.3.3.3.5">Kvasir</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T4.3.3.3.6">DFU</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T4.3.3.3.7">ISIC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T4.3.3.3.8">BUSI</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T4.3.3.3.9">CAMUS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T4.3.3.3.10">Chexlocalize</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T4.3.3.3.11">Cityscapes</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T4.3.3.3.12">PascalVOC</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S7.T4.3.3.3.2">Mean <math alttext="\pm" class="ltx_Math" display="inline" id="S7.T4.3.3.3.2.m1.1"><semantics id="S7.T4.3.3.3.2.m1.1a"><mo id="S7.T4.3.3.3.2.m1.1.1" xref="S7.T4.3.3.3.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S7.T4.3.3.3.2.m1.1b"><csymbol cd="latexml" id="S7.T4.3.3.3.2.m1.1.1.cmml" xref="S7.T4.3.3.3.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.3.3.3.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S7.T4.3.3.3.2.m1.1d">±</annotation></semantics></math> <span class="ltx_text" id="S7.T4.3.3.3.2.1" style="font-size:70%;">Std</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T4.14.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T4.14.14.14.12">Gaussian</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T4.4.4.4.1"><math alttext="83.96" class="ltx_Math" display="inline" id="S7.T4.4.4.4.1.m1.1"><semantics id="S7.T4.4.4.4.1.m1.1a"><mn id="S7.T4.4.4.4.1.m1.1.1" xref="S7.T4.4.4.4.1.m1.1.1.cmml">83.96</mn><annotation-xml encoding="MathML-Content" id="S7.T4.4.4.4.1.m1.1b"><cn id="S7.T4.4.4.4.1.m1.1.1.cmml" type="float" xref="S7.T4.4.4.4.1.m1.1.1">83.96</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.4.4.4.1.m1.1c">83.96</annotation><annotation encoding="application/x-llamapun" id="S7.T4.4.4.4.1.m1.1d">83.96</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T4.5.5.5.2"><math alttext="88.34" class="ltx_Math" display="inline" id="S7.T4.5.5.5.2.m1.1"><semantics id="S7.T4.5.5.5.2.m1.1a"><mn id="S7.T4.5.5.5.2.m1.1.1" xref="S7.T4.5.5.5.2.m1.1.1.cmml">88.34</mn><annotation-xml encoding="MathML-Content" id="S7.T4.5.5.5.2.m1.1b"><cn id="S7.T4.5.5.5.2.m1.1.1.cmml" type="float" xref="S7.T4.5.5.5.2.m1.1.1">88.34</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.5.5.5.2.m1.1c">88.34</annotation><annotation encoding="application/x-llamapun" id="S7.T4.5.5.5.2.m1.1d">88.34</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T4.6.6.6.3"><math alttext="\mathbf{88.65}" class="ltx_Math" display="inline" id="S7.T4.6.6.6.3.m1.1"><semantics id="S7.T4.6.6.6.3.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T4.6.6.6.3.m1.1.1" mathvariant="bold" xref="S7.T4.6.6.6.3.m1.1.1.cmml">88.65</mn><annotation-xml encoding="MathML-Content" id="S7.T4.6.6.6.3.m1.1b"><cn id="S7.T4.6.6.6.3.m1.1.1.cmml" type="float" xref="S7.T4.6.6.6.3.m1.1.1">88.65</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.6.6.6.3.m1.1c">\mathbf{88.65}</annotation><annotation encoding="application/x-llamapun" id="S7.T4.6.6.6.3.m1.1d">bold_88.65</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T4.7.7.7.4"><math alttext="70.14" class="ltx_Math" display="inline" id="S7.T4.7.7.7.4.m1.1"><semantics id="S7.T4.7.7.7.4.m1.1a"><mn id="S7.T4.7.7.7.4.m1.1.1" xref="S7.T4.7.7.7.4.m1.1.1.cmml">70.14</mn><annotation-xml encoding="MathML-Content" id="S7.T4.7.7.7.4.m1.1b"><cn id="S7.T4.7.7.7.4.m1.1.1.cmml" type="float" xref="S7.T4.7.7.7.4.m1.1.1">70.14</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.7.7.7.4.m1.1c">70.14</annotation><annotation encoding="application/x-llamapun" id="S7.T4.7.7.7.4.m1.1d">70.14</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T4.8.8.8.5"><math alttext="92.05" class="ltx_Math" display="inline" id="S7.T4.8.8.8.5.m1.1"><semantics id="S7.T4.8.8.8.5.m1.1a"><mn id="S7.T4.8.8.8.5.m1.1.1" xref="S7.T4.8.8.8.5.m1.1.1.cmml">92.05</mn><annotation-xml encoding="MathML-Content" id="S7.T4.8.8.8.5.m1.1b"><cn id="S7.T4.8.8.8.5.m1.1.1.cmml" type="float" xref="S7.T4.8.8.8.5.m1.1.1">92.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.8.8.8.5.m1.1c">92.05</annotation><annotation encoding="application/x-llamapun" id="S7.T4.8.8.8.5.m1.1d">92.05</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T4.9.9.9.6"><math alttext="\mathbf{81.25}" class="ltx_Math" display="inline" id="S7.T4.9.9.9.6.m1.1"><semantics id="S7.T4.9.9.9.6.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T4.9.9.9.6.m1.1.1" mathvariant="bold" xref="S7.T4.9.9.9.6.m1.1.1.cmml">81.25</mn><annotation-xml encoding="MathML-Content" id="S7.T4.9.9.9.6.m1.1b"><cn id="S7.T4.9.9.9.6.m1.1.1.cmml" type="float" xref="S7.T4.9.9.9.6.m1.1.1">81.25</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.9.9.9.6.m1.1c">\mathbf{81.25}</annotation><annotation encoding="application/x-llamapun" id="S7.T4.9.9.9.6.m1.1d">bold_81.25</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T4.10.10.10.7"><math alttext="88.25" class="ltx_Math" display="inline" id="S7.T4.10.10.10.7.m1.1"><semantics id="S7.T4.10.10.10.7.m1.1a"><mn id="S7.T4.10.10.10.7.m1.1.1" xref="S7.T4.10.10.10.7.m1.1.1.cmml">88.25</mn><annotation-xml encoding="MathML-Content" id="S7.T4.10.10.10.7.m1.1b"><cn id="S7.T4.10.10.10.7.m1.1.1.cmml" type="float" xref="S7.T4.10.10.10.7.m1.1.1">88.25</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.10.10.10.7.m1.1c">88.25</annotation><annotation encoding="application/x-llamapun" id="S7.T4.10.10.10.7.m1.1d">88.25</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T4.11.11.11.8"><math alttext="57.27" class="ltx_Math" display="inline" id="S7.T4.11.11.11.8.m1.1"><semantics id="S7.T4.11.11.11.8.m1.1a"><mn id="S7.T4.11.11.11.8.m1.1.1" xref="S7.T4.11.11.11.8.m1.1.1.cmml">57.27</mn><annotation-xml encoding="MathML-Content" id="S7.T4.11.11.11.8.m1.1b"><cn id="S7.T4.11.11.11.8.m1.1.1.cmml" type="float" xref="S7.T4.11.11.11.8.m1.1.1">57.27</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.11.11.11.8.m1.1c">57.27</annotation><annotation encoding="application/x-llamapun" id="S7.T4.11.11.11.8.m1.1d">57.27</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T4.12.12.12.9"><math alttext="56.62" class="ltx_Math" display="inline" id="S7.T4.12.12.12.9.m1.1"><semantics id="S7.T4.12.12.12.9.m1.1a"><mn id="S7.T4.12.12.12.9.m1.1.1" xref="S7.T4.12.12.12.9.m1.1.1.cmml">56.62</mn><annotation-xml encoding="MathML-Content" id="S7.T4.12.12.12.9.m1.1b"><cn id="S7.T4.12.12.12.9.m1.1.1.cmml" type="float" xref="S7.T4.12.12.12.9.m1.1.1">56.62</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.12.12.12.9.m1.1c">56.62</annotation><annotation encoding="application/x-llamapun" id="S7.T4.12.12.12.9.m1.1d">56.62</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T4.13.13.13.10"><math alttext="\mathbf{79.50}" class="ltx_Math" display="inline" id="S7.T4.13.13.13.10.m1.1"><semantics id="S7.T4.13.13.13.10.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T4.13.13.13.10.m1.1.1" mathvariant="bold" xref="S7.T4.13.13.13.10.m1.1.1.cmml">79.50</mn><annotation-xml encoding="MathML-Content" id="S7.T4.13.13.13.10.m1.1b"><cn id="S7.T4.13.13.13.10.m1.1.1.cmml" type="float" xref="S7.T4.13.13.13.10.m1.1.1">79.50</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.13.13.13.10.m1.1c">\mathbf{79.50}</annotation><annotation encoding="application/x-llamapun" id="S7.T4.13.13.13.10.m1.1d">bold_79.50</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S7.T4.14.14.14.11"><math alttext="78.6\scriptscriptstyle\pm 12.31" class="ltx_Math" display="inline" id="S7.T4.14.14.14.11.m1.1"><semantics id="S7.T4.14.14.14.11.m1.1a"><mrow id="S7.T4.14.14.14.11.m1.1.1" xref="S7.T4.14.14.14.11.m1.1.1.cmml"><mn id="S7.T4.14.14.14.11.m1.1.1.2" xref="S7.T4.14.14.14.11.m1.1.1.2.cmml">78.6</mn><mo id="S7.T4.14.14.14.11.m1.1.1.1" mathsize="50%" xref="S7.T4.14.14.14.11.m1.1.1.1.cmml">±</mo><mn id="S7.T4.14.14.14.11.m1.1.1.3" mathsize="50%" xref="S7.T4.14.14.14.11.m1.1.1.3.cmml">12.31</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.14.14.14.11.m1.1b"><apply id="S7.T4.14.14.14.11.m1.1.1.cmml" xref="S7.T4.14.14.14.11.m1.1.1"><csymbol cd="latexml" id="S7.T4.14.14.14.11.m1.1.1.1.cmml" xref="S7.T4.14.14.14.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T4.14.14.14.11.m1.1.1.2.cmml" type="float" xref="S7.T4.14.14.14.11.m1.1.1.2">78.6</cn><cn id="S7.T4.14.14.14.11.m1.1.1.3.cmml" type="float" xref="S7.T4.14.14.14.11.m1.1.1.3">12.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.14.14.14.11.m1.1c">78.6\scriptscriptstyle\pm 12.31</annotation><annotation encoding="application/x-llamapun" id="S7.T4.14.14.14.11.m1.1d">78.6 ± 12.31</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T4.25.25.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S7.T4.25.25.25.12">a photo of a</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T4.15.15.15.1"><math alttext="\mathbf{84.82}" class="ltx_Math" display="inline" id="S7.T4.15.15.15.1.m1.1"><semantics id="S7.T4.15.15.15.1.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T4.15.15.15.1.m1.1.1" mathvariant="bold" xref="S7.T4.15.15.15.1.m1.1.1.cmml">84.82</mn><annotation-xml encoding="MathML-Content" id="S7.T4.15.15.15.1.m1.1b"><cn id="S7.T4.15.15.15.1.m1.1.1.cmml" type="float" xref="S7.T4.15.15.15.1.m1.1.1">84.82</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.15.15.15.1.m1.1c">\mathbf{84.82}</annotation><annotation encoding="application/x-llamapun" id="S7.T4.15.15.15.1.m1.1d">bold_84.82</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T4.16.16.16.2"><math alttext="\mathbf{90.61}" class="ltx_Math" display="inline" id="S7.T4.16.16.16.2.m1.1"><semantics id="S7.T4.16.16.16.2.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T4.16.16.16.2.m1.1.1" mathvariant="bold" xref="S7.T4.16.16.16.2.m1.1.1.cmml">90.61</mn><annotation-xml encoding="MathML-Content" id="S7.T4.16.16.16.2.m1.1b"><cn id="S7.T4.16.16.16.2.m1.1.1.cmml" type="float" xref="S7.T4.16.16.16.2.m1.1.1">90.61</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.16.16.16.2.m1.1c">\mathbf{90.61}</annotation><annotation encoding="application/x-llamapun" id="S7.T4.16.16.16.2.m1.1d">bold_90.61</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T4.17.17.17.3"><math alttext="87.25" class="ltx_Math" display="inline" id="S7.T4.17.17.17.3.m1.1"><semantics id="S7.T4.17.17.17.3.m1.1a"><mn id="S7.T4.17.17.17.3.m1.1.1" xref="S7.T4.17.17.17.3.m1.1.1.cmml">87.25</mn><annotation-xml encoding="MathML-Content" id="S7.T4.17.17.17.3.m1.1b"><cn id="S7.T4.17.17.17.3.m1.1.1.cmml" type="float" xref="S7.T4.17.17.17.3.m1.1.1">87.25</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.17.17.17.3.m1.1c">87.25</annotation><annotation encoding="application/x-llamapun" id="S7.T4.17.17.17.3.m1.1d">87.25</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T4.18.18.18.4"><math alttext="\mathbf{72.68}" class="ltx_Math" display="inline" id="S7.T4.18.18.18.4.m1.1"><semantics id="S7.T4.18.18.18.4.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T4.18.18.18.4.m1.1.1" mathvariant="bold" xref="S7.T4.18.18.18.4.m1.1.1.cmml">72.68</mn><annotation-xml encoding="MathML-Content" id="S7.T4.18.18.18.4.m1.1b"><cn id="S7.T4.18.18.18.4.m1.1.1.cmml" type="float" xref="S7.T4.18.18.18.4.m1.1.1">72.68</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.18.18.18.4.m1.1c">\mathbf{72.68}</annotation><annotation encoding="application/x-llamapun" id="S7.T4.18.18.18.4.m1.1d">bold_72.68</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T4.19.19.19.5"><math alttext="\mathbf{92.10}" class="ltx_Math" display="inline" id="S7.T4.19.19.19.5.m1.1"><semantics id="S7.T4.19.19.19.5.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T4.19.19.19.5.m1.1.1" mathvariant="bold" xref="S7.T4.19.19.19.5.m1.1.1.cmml">92.10</mn><annotation-xml encoding="MathML-Content" id="S7.T4.19.19.19.5.m1.1b"><cn id="S7.T4.19.19.19.5.m1.1.1.cmml" type="float" xref="S7.T4.19.19.19.5.m1.1.1">92.10</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.19.19.19.5.m1.1c">\mathbf{92.10}</annotation><annotation encoding="application/x-llamapun" id="S7.T4.19.19.19.5.m1.1d">bold_92.10</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T4.20.20.20.6"><math alttext="80.99" class="ltx_Math" display="inline" id="S7.T4.20.20.20.6.m1.1"><semantics id="S7.T4.20.20.20.6.m1.1a"><mn id="S7.T4.20.20.20.6.m1.1.1" xref="S7.T4.20.20.20.6.m1.1.1.cmml">80.99</mn><annotation-xml encoding="MathML-Content" id="S7.T4.20.20.20.6.m1.1b"><cn id="S7.T4.20.20.20.6.m1.1.1.cmml" type="float" xref="S7.T4.20.20.20.6.m1.1.1">80.99</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.20.20.20.6.m1.1c">80.99</annotation><annotation encoding="application/x-llamapun" id="S7.T4.20.20.20.6.m1.1d">80.99</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T4.21.21.21.7"><math alttext="\mathbf{88.95}" class="ltx_Math" display="inline" id="S7.T4.21.21.21.7.m1.1"><semantics id="S7.T4.21.21.21.7.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T4.21.21.21.7.m1.1.1" mathvariant="bold" xref="S7.T4.21.21.21.7.m1.1.1.cmml">88.95</mn><annotation-xml encoding="MathML-Content" id="S7.T4.21.21.21.7.m1.1b"><cn id="S7.T4.21.21.21.7.m1.1.1.cmml" type="float" xref="S7.T4.21.21.21.7.m1.1.1">88.95</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.21.21.21.7.m1.1c">\mathbf{88.95}</annotation><annotation encoding="application/x-llamapun" id="S7.T4.21.21.21.7.m1.1d">bold_88.95</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T4.22.22.22.8"><math alttext="\mathbf{58.04}" class="ltx_Math" display="inline" id="S7.T4.22.22.22.8.m1.1"><semantics id="S7.T4.22.22.22.8.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T4.22.22.22.8.m1.1.1" mathvariant="bold" xref="S7.T4.22.22.22.8.m1.1.1.cmml">58.04</mn><annotation-xml encoding="MathML-Content" id="S7.T4.22.22.22.8.m1.1b"><cn id="S7.T4.22.22.22.8.m1.1.1.cmml" type="float" xref="S7.T4.22.22.22.8.m1.1.1">58.04</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.22.22.22.8.m1.1c">\mathbf{58.04}</annotation><annotation encoding="application/x-llamapun" id="S7.T4.22.22.22.8.m1.1d">bold_58.04</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T4.23.23.23.9"><math alttext="\mathbf{56.70}" class="ltx_Math" display="inline" id="S7.T4.23.23.23.9.m1.1"><semantics id="S7.T4.23.23.23.9.m1.1a"><mn class="ltx_mathvariant_bold" id="S7.T4.23.23.23.9.m1.1.1" mathvariant="bold" xref="S7.T4.23.23.23.9.m1.1.1.cmml">56.70</mn><annotation-xml encoding="MathML-Content" id="S7.T4.23.23.23.9.m1.1b"><cn id="S7.T4.23.23.23.9.m1.1.1.cmml" type="float" xref="S7.T4.23.23.23.9.m1.1.1">56.70</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.23.23.23.9.m1.1c">\mathbf{56.70}</annotation><annotation encoding="application/x-llamapun" id="S7.T4.23.23.23.9.m1.1d">bold_56.70</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T4.24.24.24.10"><math alttext="79.48" class="ltx_Math" display="inline" id="S7.T4.24.24.24.10.m1.1"><semantics id="S7.T4.24.24.24.10.m1.1a"><mn id="S7.T4.24.24.24.10.m1.1.1" xref="S7.T4.24.24.24.10.m1.1.1.cmml">79.48</mn><annotation-xml encoding="MathML-Content" id="S7.T4.24.24.24.10.m1.1b"><cn id="S7.T4.24.24.24.10.m1.1.1.cmml" type="float" xref="S7.T4.24.24.24.10.m1.1.1">79.48</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.24.24.24.10.m1.1c">79.48</annotation><annotation encoding="application/x-llamapun" id="S7.T4.24.24.24.10.m1.1d">79.48</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S7.T4.25.25.25.11"><math alttext="\mathbf{79.16\scriptscriptstyle\pm 12.2}" class="ltx_Math" display="inline" id="S7.T4.25.25.25.11.m1.1"><semantics id="S7.T4.25.25.25.11.m1.1a"><mrow id="S7.T4.25.25.25.11.m1.1.1" xref="S7.T4.25.25.25.11.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" id="S7.T4.25.25.25.11.m1.1.1.2" mathvariant="bold" xref="S7.T4.25.25.25.11.m1.1.1.2.cmml">79.16</mn><mo id="S7.T4.25.25.25.11.m1.1.1.1" mathsize="50%" xref="S7.T4.25.25.25.11.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" id="S7.T4.25.25.25.11.m1.1.1.3" mathsize="50%" mathvariant="bold" xref="S7.T4.25.25.25.11.m1.1.1.3.cmml">12.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.25.25.25.11.m1.1b"><apply id="S7.T4.25.25.25.11.m1.1.1.cmml" xref="S7.T4.25.25.25.11.m1.1.1"><csymbol cd="latexml" id="S7.T4.25.25.25.11.m1.1.1.1.cmml" xref="S7.T4.25.25.25.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T4.25.25.25.11.m1.1.1.2.cmml" type="float" xref="S7.T4.25.25.25.11.m1.1.1.2">79.16</cn><cn id="S7.T4.25.25.25.11.m1.1.1.3.cmml" type="float" xref="S7.T4.25.25.25.11.m1.1.1.3">12.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.25.25.25.11.m1.1c">\mathbf{79.16\scriptscriptstyle\pm 12.2}</annotation><annotation encoding="application/x-llamapun" id="S7.T4.25.25.25.11.m1.1d">bold_79.16 ± bold_12.2</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S7.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.3 </span>Importance of Tuning Last Layer for Segmentation</h3>
<figure class="ltx_table" id="S7.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S7.T5.93.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="S7.T5.94.2" style="font-size:90%;">
The dice scores for each viable combination of VLSMs and context learners for all the datasets when a new learnable last upsampling layer is not introduced.
</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S7.T5.91" style="width:433.6pt;height:129pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-115.9pt,34.5pt) scale(0.651678120947037,0.651678120947037) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S7.T5.91.91">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S7.T5.1.1.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_tt" colspan="2" id="S7.T5.1.1.1.1">Datasets <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S7.T5.1.1.1.1.m1.1"><semantics id="S7.T5.1.1.1.1.m1.1a"><mo id="S7.T5.1.1.1.1.m1.1.1" stretchy="false" xref="S7.T5.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S7.T5.1.1.1.1.m1.1b"><ci id="S7.T5.1.1.1.1.m1.1.1.cmml" xref="S7.T5.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S7.T5.1.1.1.1.m1.1d">→</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S7.T5.1.1.1.2">Non-Radiology</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S7.T5.1.1.1.3">Radiology</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S7.T5.1.1.1.4">Open Domain</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="S7.T5.1.1.1.5">Overall</td>
</tr>
<tr class="ltx_tr" id="S7.T5.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T5.2.2.2.2">Models</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T5.2.2.2.3">Context Learner</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.2.2.2.4">BKAI</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.2.2.2.5">ClinicDB</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.2.2.2.6">Kvasir</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.2.2.2.7">DFU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.2.2.2.8">ISIC</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.2.2.2.9">BUSI</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.2.2.2.10">CAMUS</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.2.2.2.11">Chexlocalize</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.2.2.2.12">Cityscapes</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.2.2.2.13">PascalVOC</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S7.T5.2.2.2.1">Mean <math alttext="\pm" class="ltx_Math" display="inline" id="S7.T5.2.2.2.1.m1.1"><semantics id="S7.T5.2.2.2.1.m1.1a"><mo id="S7.T5.2.2.2.1.m1.1.1" xref="S7.T5.2.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S7.T5.2.2.2.1.m1.1b"><csymbol cd="latexml" id="S7.T5.2.2.2.1.m1.1.1.cmml" xref="S7.T5.2.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.2.2.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S7.T5.2.2.2.1.m1.1d">±</annotation></semantics></math> <span class="ltx_text" id="S7.T5.2.2.2.1.1" style="font-size:70%;">Std</span>
</td>
</tr>
<tr class="ltx_tr" id="S7.T5.13.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T5.13.13.13.12" rowspan="6"><span class="ltx_text" id="S7.T5.13.13.13.12.1">CLIPSeg</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T5.13.13.13.13">Maple</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.3.3.3.1"><math alttext="81.56" class="ltx_Math" display="inline" id="S7.T5.3.3.3.1.m1.1"><semantics id="S7.T5.3.3.3.1.m1.1a"><mn id="S7.T5.3.3.3.1.m1.1.1" xref="S7.T5.3.3.3.1.m1.1.1.cmml">81.56</mn><annotation-xml encoding="MathML-Content" id="S7.T5.3.3.3.1.m1.1b"><cn id="S7.T5.3.3.3.1.m1.1.1.cmml" type="float" xref="S7.T5.3.3.3.1.m1.1.1">81.56</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.3.3.3.1.m1.1c">81.56</annotation><annotation encoding="application/x-llamapun" id="S7.T5.3.3.3.1.m1.1d">81.56</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.4.4.4.2"><math alttext="85.55" class="ltx_Math" display="inline" id="S7.T5.4.4.4.2.m1.1"><semantics id="S7.T5.4.4.4.2.m1.1a"><mn id="S7.T5.4.4.4.2.m1.1.1" xref="S7.T5.4.4.4.2.m1.1.1.cmml">85.55</mn><annotation-xml encoding="MathML-Content" id="S7.T5.4.4.4.2.m1.1b"><cn id="S7.T5.4.4.4.2.m1.1.1.cmml" type="float" xref="S7.T5.4.4.4.2.m1.1.1">85.55</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.4.4.4.2.m1.1c">85.55</annotation><annotation encoding="application/x-llamapun" id="S7.T5.4.4.4.2.m1.1d">85.55</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.5.5.5.3"><math alttext="86.45" class="ltx_Math" display="inline" id="S7.T5.5.5.5.3.m1.1"><semantics id="S7.T5.5.5.5.3.m1.1a"><mn id="S7.T5.5.5.5.3.m1.1.1" xref="S7.T5.5.5.5.3.m1.1.1.cmml">86.45</mn><annotation-xml encoding="MathML-Content" id="S7.T5.5.5.5.3.m1.1b"><cn id="S7.T5.5.5.5.3.m1.1.1.cmml" type="float" xref="S7.T5.5.5.5.3.m1.1.1">86.45</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.5.5.5.3.m1.1c">86.45</annotation><annotation encoding="application/x-llamapun" id="S7.T5.5.5.5.3.m1.1d">86.45</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.6.6.6.4"><math alttext="66.38" class="ltx_Math" display="inline" id="S7.T5.6.6.6.4.m1.1"><semantics id="S7.T5.6.6.6.4.m1.1a"><mn id="S7.T5.6.6.6.4.m1.1.1" xref="S7.T5.6.6.6.4.m1.1.1.cmml">66.38</mn><annotation-xml encoding="MathML-Content" id="S7.T5.6.6.6.4.m1.1b"><cn id="S7.T5.6.6.6.4.m1.1.1.cmml" type="float" xref="S7.T5.6.6.6.4.m1.1.1">66.38</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.6.6.6.4.m1.1c">66.38</annotation><annotation encoding="application/x-llamapun" id="S7.T5.6.6.6.4.m1.1d">66.38</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.7.7.7.5"><math alttext="91.20" class="ltx_Math" display="inline" id="S7.T5.7.7.7.5.m1.1"><semantics id="S7.T5.7.7.7.5.m1.1a"><mn id="S7.T5.7.7.7.5.m1.1.1" xref="S7.T5.7.7.7.5.m1.1.1.cmml">91.20</mn><annotation-xml encoding="MathML-Content" id="S7.T5.7.7.7.5.m1.1b"><cn id="S7.T5.7.7.7.5.m1.1.1.cmml" type="float" xref="S7.T5.7.7.7.5.m1.1.1">91.20</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.7.7.7.5.m1.1c">91.20</annotation><annotation encoding="application/x-llamapun" id="S7.T5.7.7.7.5.m1.1d">91.20</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.8.8.8.6"><math alttext="80.95" class="ltx_Math" display="inline" id="S7.T5.8.8.8.6.m1.1"><semantics id="S7.T5.8.8.8.6.m1.1a"><mn id="S7.T5.8.8.8.6.m1.1.1" xref="S7.T5.8.8.8.6.m1.1.1.cmml">80.95</mn><annotation-xml encoding="MathML-Content" id="S7.T5.8.8.8.6.m1.1b"><cn id="S7.T5.8.8.8.6.m1.1.1.cmml" type="float" xref="S7.T5.8.8.8.6.m1.1.1">80.95</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.8.8.8.6.m1.1c">80.95</annotation><annotation encoding="application/x-llamapun" id="S7.T5.8.8.8.6.m1.1d">80.95</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.9.9.9.7"><math alttext="84.96" class="ltx_Math" display="inline" id="S7.T5.9.9.9.7.m1.1"><semantics id="S7.T5.9.9.9.7.m1.1a"><mn id="S7.T5.9.9.9.7.m1.1.1" xref="S7.T5.9.9.9.7.m1.1.1.cmml">84.96</mn><annotation-xml encoding="MathML-Content" id="S7.T5.9.9.9.7.m1.1b"><cn id="S7.T5.9.9.9.7.m1.1.1.cmml" type="float" xref="S7.T5.9.9.9.7.m1.1.1">84.96</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.9.9.9.7.m1.1c">84.96</annotation><annotation encoding="application/x-llamapun" id="S7.T5.9.9.9.7.m1.1d">84.96</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.10.10.10.8"><math alttext="55.96" class="ltx_Math" display="inline" id="S7.T5.10.10.10.8.m1.1"><semantics id="S7.T5.10.10.10.8.m1.1a"><mn id="S7.T5.10.10.10.8.m1.1.1" xref="S7.T5.10.10.10.8.m1.1.1.cmml">55.96</mn><annotation-xml encoding="MathML-Content" id="S7.T5.10.10.10.8.m1.1b"><cn id="S7.T5.10.10.10.8.m1.1.1.cmml" type="float" xref="S7.T5.10.10.10.8.m1.1.1">55.96</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.10.10.10.8.m1.1c">55.96</annotation><annotation encoding="application/x-llamapun" id="S7.T5.10.10.10.8.m1.1d">55.96</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.11.11.11.9"><math alttext="53.16" class="ltx_Math" display="inline" id="S7.T5.11.11.11.9.m1.1"><semantics id="S7.T5.11.11.11.9.m1.1a"><mn id="S7.T5.11.11.11.9.m1.1.1" xref="S7.T5.11.11.11.9.m1.1.1.cmml">53.16</mn><annotation-xml encoding="MathML-Content" id="S7.T5.11.11.11.9.m1.1b"><cn id="S7.T5.11.11.11.9.m1.1.1.cmml" type="float" xref="S7.T5.11.11.11.9.m1.1.1">53.16</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.11.11.11.9.m1.1c">53.16</annotation><annotation encoding="application/x-llamapun" id="S7.T5.11.11.11.9.m1.1d">53.16</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.12.12.12.10"><math alttext="76.95" class="ltx_Math" display="inline" id="S7.T5.12.12.12.10.m1.1"><semantics id="S7.T5.12.12.12.10.m1.1a"><mn id="S7.T5.12.12.12.10.m1.1.1" xref="S7.T5.12.12.12.10.m1.1.1.cmml">76.95</mn><annotation-xml encoding="MathML-Content" id="S7.T5.12.12.12.10.m1.1b"><cn id="S7.T5.12.12.12.10.m1.1.1.cmml" type="float" xref="S7.T5.12.12.12.10.m1.1.1">76.95</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.12.12.12.10.m1.1c">76.95</annotation><annotation encoding="application/x-llamapun" id="S7.T5.12.12.12.10.m1.1d">76.95</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S7.T5.13.13.13.11"><math alttext="76.31\scriptscriptstyle\pm 12.58" class="ltx_Math" display="inline" id="S7.T5.13.13.13.11.m1.1"><semantics id="S7.T5.13.13.13.11.m1.1a"><mrow id="S7.T5.13.13.13.11.m1.1.1" xref="S7.T5.13.13.13.11.m1.1.1.cmml"><mn id="S7.T5.13.13.13.11.m1.1.1.2" xref="S7.T5.13.13.13.11.m1.1.1.2.cmml">76.31</mn><mo id="S7.T5.13.13.13.11.m1.1.1.1" mathsize="50%" xref="S7.T5.13.13.13.11.m1.1.1.1.cmml">±</mo><mn id="S7.T5.13.13.13.11.m1.1.1.3" mathsize="50%" xref="S7.T5.13.13.13.11.m1.1.1.3.cmml">12.58</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.13.13.13.11.m1.1b"><apply id="S7.T5.13.13.13.11.m1.1.1.cmml" xref="S7.T5.13.13.13.11.m1.1.1"><csymbol cd="latexml" id="S7.T5.13.13.13.11.m1.1.1.1.cmml" xref="S7.T5.13.13.13.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T5.13.13.13.11.m1.1.1.2.cmml" type="float" xref="S7.T5.13.13.13.11.m1.1.1.2">76.31</cn><cn id="S7.T5.13.13.13.11.m1.1.1.3.cmml" type="float" xref="S7.T5.13.13.13.11.m1.1.1.3">12.58</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.13.13.13.11.m1.1c">76.31\scriptscriptstyle\pm 12.58</annotation><annotation encoding="application/x-llamapun" id="S7.T5.13.13.13.11.m1.1d">76.31 ± 12.58</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T5.24.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T5.24.24.24.12">Shared Sep</th>
<td class="ltx_td ltx_align_center" id="S7.T5.14.14.14.1"><math alttext="80.45" class="ltx_Math" display="inline" id="S7.T5.14.14.14.1.m1.1"><semantics id="S7.T5.14.14.14.1.m1.1a"><mn id="S7.T5.14.14.14.1.m1.1.1" xref="S7.T5.14.14.14.1.m1.1.1.cmml">80.45</mn><annotation-xml encoding="MathML-Content" id="S7.T5.14.14.14.1.m1.1b"><cn id="S7.T5.14.14.14.1.m1.1.1.cmml" type="float" xref="S7.T5.14.14.14.1.m1.1.1">80.45</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.14.14.14.1.m1.1c">80.45</annotation><annotation encoding="application/x-llamapun" id="S7.T5.14.14.14.1.m1.1d">80.45</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.15.15.15.2"><math alttext="83.31" class="ltx_Math" display="inline" id="S7.T5.15.15.15.2.m1.1"><semantics id="S7.T5.15.15.15.2.m1.1a"><mn id="S7.T5.15.15.15.2.m1.1.1" xref="S7.T5.15.15.15.2.m1.1.1.cmml">83.31</mn><annotation-xml encoding="MathML-Content" id="S7.T5.15.15.15.2.m1.1b"><cn id="S7.T5.15.15.15.2.m1.1.1.cmml" type="float" xref="S7.T5.15.15.15.2.m1.1.1">83.31</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.15.15.15.2.m1.1c">83.31</annotation><annotation encoding="application/x-llamapun" id="S7.T5.15.15.15.2.m1.1d">83.31</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.16.16.16.3"><math alttext="86.07" class="ltx_Math" display="inline" id="S7.T5.16.16.16.3.m1.1"><semantics id="S7.T5.16.16.16.3.m1.1a"><mn id="S7.T5.16.16.16.3.m1.1.1" xref="S7.T5.16.16.16.3.m1.1.1.cmml">86.07</mn><annotation-xml encoding="MathML-Content" id="S7.T5.16.16.16.3.m1.1b"><cn id="S7.T5.16.16.16.3.m1.1.1.cmml" type="float" xref="S7.T5.16.16.16.3.m1.1.1">86.07</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.16.16.16.3.m1.1c">86.07</annotation><annotation encoding="application/x-llamapun" id="S7.T5.16.16.16.3.m1.1d">86.07</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.17.17.17.4"><math alttext="65.46" class="ltx_Math" display="inline" id="S7.T5.17.17.17.4.m1.1"><semantics id="S7.T5.17.17.17.4.m1.1a"><mn id="S7.T5.17.17.17.4.m1.1.1" xref="S7.T5.17.17.17.4.m1.1.1.cmml">65.46</mn><annotation-xml encoding="MathML-Content" id="S7.T5.17.17.17.4.m1.1b"><cn id="S7.T5.17.17.17.4.m1.1.1.cmml" type="float" xref="S7.T5.17.17.17.4.m1.1.1">65.46</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.17.17.17.4.m1.1c">65.46</annotation><annotation encoding="application/x-llamapun" id="S7.T5.17.17.17.4.m1.1d">65.46</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.18.18.18.5"><math alttext="91.00" class="ltx_Math" display="inline" id="S7.T5.18.18.18.5.m1.1"><semantics id="S7.T5.18.18.18.5.m1.1a"><mn id="S7.T5.18.18.18.5.m1.1.1" xref="S7.T5.18.18.18.5.m1.1.1.cmml">91.00</mn><annotation-xml encoding="MathML-Content" id="S7.T5.18.18.18.5.m1.1b"><cn id="S7.T5.18.18.18.5.m1.1.1.cmml" type="float" xref="S7.T5.18.18.18.5.m1.1.1">91.00</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.18.18.18.5.m1.1c">91.00</annotation><annotation encoding="application/x-llamapun" id="S7.T5.18.18.18.5.m1.1d">91.00</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.19.19.19.6"><math alttext="78.81" class="ltx_Math" display="inline" id="S7.T5.19.19.19.6.m1.1"><semantics id="S7.T5.19.19.19.6.m1.1a"><mn id="S7.T5.19.19.19.6.m1.1.1" xref="S7.T5.19.19.19.6.m1.1.1.cmml">78.81</mn><annotation-xml encoding="MathML-Content" id="S7.T5.19.19.19.6.m1.1b"><cn id="S7.T5.19.19.19.6.m1.1.1.cmml" type="float" xref="S7.T5.19.19.19.6.m1.1.1">78.81</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.19.19.19.6.m1.1c">78.81</annotation><annotation encoding="application/x-llamapun" id="S7.T5.19.19.19.6.m1.1d">78.81</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.20.20.20.7"><math alttext="85.71" class="ltx_Math" display="inline" id="S7.T5.20.20.20.7.m1.1"><semantics id="S7.T5.20.20.20.7.m1.1a"><mn id="S7.T5.20.20.20.7.m1.1.1" xref="S7.T5.20.20.20.7.m1.1.1.cmml">85.71</mn><annotation-xml encoding="MathML-Content" id="S7.T5.20.20.20.7.m1.1b"><cn id="S7.T5.20.20.20.7.m1.1.1.cmml" type="float" xref="S7.T5.20.20.20.7.m1.1.1">85.71</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.20.20.20.7.m1.1c">85.71</annotation><annotation encoding="application/x-llamapun" id="S7.T5.20.20.20.7.m1.1d">85.71</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.21.21.21.8"><math alttext="57.72" class="ltx_Math" display="inline" id="S7.T5.21.21.21.8.m1.1"><semantics id="S7.T5.21.21.21.8.m1.1a"><mn id="S7.T5.21.21.21.8.m1.1.1" xref="S7.T5.21.21.21.8.m1.1.1.cmml">57.72</mn><annotation-xml encoding="MathML-Content" id="S7.T5.21.21.21.8.m1.1b"><cn id="S7.T5.21.21.21.8.m1.1.1.cmml" type="float" xref="S7.T5.21.21.21.8.m1.1.1">57.72</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.21.21.21.8.m1.1c">57.72</annotation><annotation encoding="application/x-llamapun" id="S7.T5.21.21.21.8.m1.1d">57.72</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.22.22.22.9"><math alttext="53.06" class="ltx_Math" display="inline" id="S7.T5.22.22.22.9.m1.1"><semantics id="S7.T5.22.22.22.9.m1.1a"><mn id="S7.T5.22.22.22.9.m1.1.1" xref="S7.T5.22.22.22.9.m1.1.1.cmml">53.06</mn><annotation-xml encoding="MathML-Content" id="S7.T5.22.22.22.9.m1.1b"><cn id="S7.T5.22.22.22.9.m1.1.1.cmml" type="float" xref="S7.T5.22.22.22.9.m1.1.1">53.06</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.22.22.22.9.m1.1c">53.06</annotation><annotation encoding="application/x-llamapun" id="S7.T5.22.22.22.9.m1.1d">53.06</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.23.23.23.10"><math alttext="76.72" class="ltx_Math" display="inline" id="S7.T5.23.23.23.10.m1.1"><semantics id="S7.T5.23.23.23.10.m1.1a"><mn id="S7.T5.23.23.23.10.m1.1.1" xref="S7.T5.23.23.23.10.m1.1.1.cmml">76.72</mn><annotation-xml encoding="MathML-Content" id="S7.T5.23.23.23.10.m1.1b"><cn id="S7.T5.23.23.23.10.m1.1.1.cmml" type="float" xref="S7.T5.23.23.23.10.m1.1.1">76.72</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.23.23.23.10.m1.1c">76.72</annotation><annotation encoding="application/x-llamapun" id="S7.T5.23.23.23.10.m1.1d">76.72</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T5.24.24.24.11"><math alttext="75.83\scriptscriptstyle\pm 12.14" class="ltx_Math" display="inline" id="S7.T5.24.24.24.11.m1.1"><semantics id="S7.T5.24.24.24.11.m1.1a"><mrow id="S7.T5.24.24.24.11.m1.1.1" xref="S7.T5.24.24.24.11.m1.1.1.cmml"><mn id="S7.T5.24.24.24.11.m1.1.1.2" xref="S7.T5.24.24.24.11.m1.1.1.2.cmml">75.83</mn><mo id="S7.T5.24.24.24.11.m1.1.1.1" mathsize="50%" xref="S7.T5.24.24.24.11.m1.1.1.1.cmml">±</mo><mn id="S7.T5.24.24.24.11.m1.1.1.3" mathsize="50%" xref="S7.T5.24.24.24.11.m1.1.1.3.cmml">12.14</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.24.24.24.11.m1.1b"><apply id="S7.T5.24.24.24.11.m1.1.1.cmml" xref="S7.T5.24.24.24.11.m1.1.1"><csymbol cd="latexml" id="S7.T5.24.24.24.11.m1.1.1.1.cmml" xref="S7.T5.24.24.24.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T5.24.24.24.11.m1.1.1.2.cmml" type="float" xref="S7.T5.24.24.24.11.m1.1.1.2">75.83</cn><cn id="S7.T5.24.24.24.11.m1.1.1.3.cmml" type="float" xref="S7.T5.24.24.24.11.m1.1.1.3">12.14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.24.24.24.11.m1.1c">75.83\scriptscriptstyle\pm 12.14</annotation><annotation encoding="application/x-llamapun" id="S7.T5.24.24.24.11.m1.1d">75.83 ± 12.14</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T5.35.35.35">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T5.35.35.35.12">Shared Attn</th>
<td class="ltx_td ltx_align_center" id="S7.T5.25.25.25.1"><math alttext="80.21" class="ltx_Math" display="inline" id="S7.T5.25.25.25.1.m1.1"><semantics id="S7.T5.25.25.25.1.m1.1a"><mn id="S7.T5.25.25.25.1.m1.1.1" xref="S7.T5.25.25.25.1.m1.1.1.cmml">80.21</mn><annotation-xml encoding="MathML-Content" id="S7.T5.25.25.25.1.m1.1b"><cn id="S7.T5.25.25.25.1.m1.1.1.cmml" type="float" xref="S7.T5.25.25.25.1.m1.1.1">80.21</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.25.25.25.1.m1.1c">80.21</annotation><annotation encoding="application/x-llamapun" id="S7.T5.25.25.25.1.m1.1d">80.21</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.26.26.26.2"><math alttext="85.89" class="ltx_Math" display="inline" id="S7.T5.26.26.26.2.m1.1"><semantics id="S7.T5.26.26.26.2.m1.1a"><mn id="S7.T5.26.26.26.2.m1.1.1" xref="S7.T5.26.26.26.2.m1.1.1.cmml">85.89</mn><annotation-xml encoding="MathML-Content" id="S7.T5.26.26.26.2.m1.1b"><cn id="S7.T5.26.26.26.2.m1.1.1.cmml" type="float" xref="S7.T5.26.26.26.2.m1.1.1">85.89</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.26.26.26.2.m1.1c">85.89</annotation><annotation encoding="application/x-llamapun" id="S7.T5.26.26.26.2.m1.1d">85.89</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.27.27.27.3"><math alttext="85.62" class="ltx_Math" display="inline" id="S7.T5.27.27.27.3.m1.1"><semantics id="S7.T5.27.27.27.3.m1.1a"><mn id="S7.T5.27.27.27.3.m1.1.1" xref="S7.T5.27.27.27.3.m1.1.1.cmml">85.62</mn><annotation-xml encoding="MathML-Content" id="S7.T5.27.27.27.3.m1.1b"><cn id="S7.T5.27.27.27.3.m1.1.1.cmml" type="float" xref="S7.T5.27.27.27.3.m1.1.1">85.62</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.27.27.27.3.m1.1c">85.62</annotation><annotation encoding="application/x-llamapun" id="S7.T5.27.27.27.3.m1.1d">85.62</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.28.28.28.4"><math alttext="62.23" class="ltx_Math" display="inline" id="S7.T5.28.28.28.4.m1.1"><semantics id="S7.T5.28.28.28.4.m1.1a"><mn id="S7.T5.28.28.28.4.m1.1.1" xref="S7.T5.28.28.28.4.m1.1.1.cmml">62.23</mn><annotation-xml encoding="MathML-Content" id="S7.T5.28.28.28.4.m1.1b"><cn id="S7.T5.28.28.28.4.m1.1.1.cmml" type="float" xref="S7.T5.28.28.28.4.m1.1.1">62.23</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.28.28.28.4.m1.1c">62.23</annotation><annotation encoding="application/x-llamapun" id="S7.T5.28.28.28.4.m1.1d">62.23</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.29.29.29.5"><math alttext="90.91" class="ltx_Math" display="inline" id="S7.T5.29.29.29.5.m1.1"><semantics id="S7.T5.29.29.29.5.m1.1a"><mn id="S7.T5.29.29.29.5.m1.1.1" xref="S7.T5.29.29.29.5.m1.1.1.cmml">90.91</mn><annotation-xml encoding="MathML-Content" id="S7.T5.29.29.29.5.m1.1b"><cn id="S7.T5.29.29.29.5.m1.1.1.cmml" type="float" xref="S7.T5.29.29.29.5.m1.1.1">90.91</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.29.29.29.5.m1.1c">90.91</annotation><annotation encoding="application/x-llamapun" id="S7.T5.29.29.29.5.m1.1d">90.91</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.30.30.30.6"><math alttext="76.27" class="ltx_Math" display="inline" id="S7.T5.30.30.30.6.m1.1"><semantics id="S7.T5.30.30.30.6.m1.1a"><mn id="S7.T5.30.30.30.6.m1.1.1" xref="S7.T5.30.30.30.6.m1.1.1.cmml">76.27</mn><annotation-xml encoding="MathML-Content" id="S7.T5.30.30.30.6.m1.1b"><cn id="S7.T5.30.30.30.6.m1.1.1.cmml" type="float" xref="S7.T5.30.30.30.6.m1.1.1">76.27</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.30.30.30.6.m1.1c">76.27</annotation><annotation encoding="application/x-llamapun" id="S7.T5.30.30.30.6.m1.1d">76.27</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.31.31.31.7"><math alttext="84.30" class="ltx_Math" display="inline" id="S7.T5.31.31.31.7.m1.1"><semantics id="S7.T5.31.31.31.7.m1.1a"><mn id="S7.T5.31.31.31.7.m1.1.1" xref="S7.T5.31.31.31.7.m1.1.1.cmml">84.30</mn><annotation-xml encoding="MathML-Content" id="S7.T5.31.31.31.7.m1.1b"><cn id="S7.T5.31.31.31.7.m1.1.1.cmml" type="float" xref="S7.T5.31.31.31.7.m1.1.1">84.30</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.31.31.31.7.m1.1c">84.30</annotation><annotation encoding="application/x-llamapun" id="S7.T5.31.31.31.7.m1.1d">84.30</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.32.32.32.8"><math alttext="55.77" class="ltx_Math" display="inline" id="S7.T5.32.32.32.8.m1.1"><semantics id="S7.T5.32.32.32.8.m1.1a"><mn id="S7.T5.32.32.32.8.m1.1.1" xref="S7.T5.32.32.32.8.m1.1.1.cmml">55.77</mn><annotation-xml encoding="MathML-Content" id="S7.T5.32.32.32.8.m1.1b"><cn id="S7.T5.32.32.32.8.m1.1.1.cmml" type="float" xref="S7.T5.32.32.32.8.m1.1.1">55.77</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.32.32.32.8.m1.1c">55.77</annotation><annotation encoding="application/x-llamapun" id="S7.T5.32.32.32.8.m1.1d">55.77</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.33.33.33.9"><math alttext="51.86" class="ltx_Math" display="inline" id="S7.T5.33.33.33.9.m1.1"><semantics id="S7.T5.33.33.33.9.m1.1a"><mn id="S7.T5.33.33.33.9.m1.1.1" xref="S7.T5.33.33.33.9.m1.1.1.cmml">51.86</mn><annotation-xml encoding="MathML-Content" id="S7.T5.33.33.33.9.m1.1b"><cn id="S7.T5.33.33.33.9.m1.1.1.cmml" type="float" xref="S7.T5.33.33.33.9.m1.1.1">51.86</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.33.33.33.9.m1.1c">51.86</annotation><annotation encoding="application/x-llamapun" id="S7.T5.33.33.33.9.m1.1d">51.86</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.34.34.34.10"><math alttext="76.50" class="ltx_Math" display="inline" id="S7.T5.34.34.34.10.m1.1"><semantics id="S7.T5.34.34.34.10.m1.1a"><mn id="S7.T5.34.34.34.10.m1.1.1" xref="S7.T5.34.34.34.10.m1.1.1.cmml">76.50</mn><annotation-xml encoding="MathML-Content" id="S7.T5.34.34.34.10.m1.1b"><cn id="S7.T5.34.34.34.10.m1.1.1.cmml" type="float" xref="S7.T5.34.34.34.10.m1.1.1">76.50</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.34.34.34.10.m1.1c">76.50</annotation><annotation encoding="application/x-llamapun" id="S7.T5.34.34.34.10.m1.1d">76.50</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T5.35.35.35.11"><math alttext="74.96\scriptscriptstyle\pm 12.92" class="ltx_Math" display="inline" id="S7.T5.35.35.35.11.m1.1"><semantics id="S7.T5.35.35.35.11.m1.1a"><mrow id="S7.T5.35.35.35.11.m1.1.1" xref="S7.T5.35.35.35.11.m1.1.1.cmml"><mn id="S7.T5.35.35.35.11.m1.1.1.2" xref="S7.T5.35.35.35.11.m1.1.1.2.cmml">74.96</mn><mo id="S7.T5.35.35.35.11.m1.1.1.1" mathsize="50%" xref="S7.T5.35.35.35.11.m1.1.1.1.cmml">±</mo><mn id="S7.T5.35.35.35.11.m1.1.1.3" mathsize="50%" xref="S7.T5.35.35.35.11.m1.1.1.3.cmml">12.92</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.35.35.35.11.m1.1b"><apply id="S7.T5.35.35.35.11.m1.1.1.cmml" xref="S7.T5.35.35.35.11.m1.1.1"><csymbol cd="latexml" id="S7.T5.35.35.35.11.m1.1.1.1.cmml" xref="S7.T5.35.35.35.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T5.35.35.35.11.m1.1.1.2.cmml" type="float" xref="S7.T5.35.35.35.11.m1.1.1.2">74.96</cn><cn id="S7.T5.35.35.35.11.m1.1.1.3.cmml" type="float" xref="S7.T5.35.35.35.11.m1.1.1.3">12.92</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.35.35.35.11.m1.1c">74.96\scriptscriptstyle\pm 12.92</annotation><annotation encoding="application/x-llamapun" id="S7.T5.35.35.35.11.m1.1d">74.96 ± 12.92</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T5.46.46.46">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T5.46.46.46.12">VPT</th>
<td class="ltx_td ltx_align_center" id="S7.T5.36.36.36.1"><math alttext="81.57" class="ltx_Math" display="inline" id="S7.T5.36.36.36.1.m1.1"><semantics id="S7.T5.36.36.36.1.m1.1a"><mn id="S7.T5.36.36.36.1.m1.1.1" xref="S7.T5.36.36.36.1.m1.1.1.cmml">81.57</mn><annotation-xml encoding="MathML-Content" id="S7.T5.36.36.36.1.m1.1b"><cn id="S7.T5.36.36.36.1.m1.1.1.cmml" type="float" xref="S7.T5.36.36.36.1.m1.1.1">81.57</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.36.36.36.1.m1.1c">81.57</annotation><annotation encoding="application/x-llamapun" id="S7.T5.36.36.36.1.m1.1d">81.57</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.37.37.37.2"><math alttext="85.22" class="ltx_Math" display="inline" id="S7.T5.37.37.37.2.m1.1"><semantics id="S7.T5.37.37.37.2.m1.1a"><mn id="S7.T5.37.37.37.2.m1.1.1" xref="S7.T5.37.37.37.2.m1.1.1.cmml">85.22</mn><annotation-xml encoding="MathML-Content" id="S7.T5.37.37.37.2.m1.1b"><cn id="S7.T5.37.37.37.2.m1.1.1.cmml" type="float" xref="S7.T5.37.37.37.2.m1.1.1">85.22</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.37.37.37.2.m1.1c">85.22</annotation><annotation encoding="application/x-llamapun" id="S7.T5.37.37.37.2.m1.1d">85.22</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.38.38.38.3"><math alttext="86.64" class="ltx_Math" display="inline" id="S7.T5.38.38.38.3.m1.1"><semantics id="S7.T5.38.38.38.3.m1.1a"><mn id="S7.T5.38.38.38.3.m1.1.1" xref="S7.T5.38.38.38.3.m1.1.1.cmml">86.64</mn><annotation-xml encoding="MathML-Content" id="S7.T5.38.38.38.3.m1.1b"><cn id="S7.T5.38.38.38.3.m1.1.1.cmml" type="float" xref="S7.T5.38.38.38.3.m1.1.1">86.64</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.38.38.38.3.m1.1c">86.64</annotation><annotation encoding="application/x-llamapun" id="S7.T5.38.38.38.3.m1.1d">86.64</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.39.39.39.4"><math alttext="65.06" class="ltx_Math" display="inline" id="S7.T5.39.39.39.4.m1.1"><semantics id="S7.T5.39.39.39.4.m1.1a"><mn id="S7.T5.39.39.39.4.m1.1.1" xref="S7.T5.39.39.39.4.m1.1.1.cmml">65.06</mn><annotation-xml encoding="MathML-Content" id="S7.T5.39.39.39.4.m1.1b"><cn id="S7.T5.39.39.39.4.m1.1.1.cmml" type="float" xref="S7.T5.39.39.39.4.m1.1.1">65.06</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.39.39.39.4.m1.1c">65.06</annotation><annotation encoding="application/x-llamapun" id="S7.T5.39.39.39.4.m1.1d">65.06</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.40.40.40.5"><math alttext="91.33" class="ltx_Math" display="inline" id="S7.T5.40.40.40.5.m1.1"><semantics id="S7.T5.40.40.40.5.m1.1a"><mn id="S7.T5.40.40.40.5.m1.1.1" xref="S7.T5.40.40.40.5.m1.1.1.cmml">91.33</mn><annotation-xml encoding="MathML-Content" id="S7.T5.40.40.40.5.m1.1b"><cn id="S7.T5.40.40.40.5.m1.1.1.cmml" type="float" xref="S7.T5.40.40.40.5.m1.1.1">91.33</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.40.40.40.5.m1.1c">91.33</annotation><annotation encoding="application/x-llamapun" id="S7.T5.40.40.40.5.m1.1d">91.33</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.41.41.41.6"><math alttext="78.93" class="ltx_Math" display="inline" id="S7.T5.41.41.41.6.m1.1"><semantics id="S7.T5.41.41.41.6.m1.1a"><mn id="S7.T5.41.41.41.6.m1.1.1" xref="S7.T5.41.41.41.6.m1.1.1.cmml">78.93</mn><annotation-xml encoding="MathML-Content" id="S7.T5.41.41.41.6.m1.1b"><cn id="S7.T5.41.41.41.6.m1.1.1.cmml" type="float" xref="S7.T5.41.41.41.6.m1.1.1">78.93</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.41.41.41.6.m1.1c">78.93</annotation><annotation encoding="application/x-llamapun" id="S7.T5.41.41.41.6.m1.1d">78.93</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.42.42.42.7"><math alttext="85.32" class="ltx_Math" display="inline" id="S7.T5.42.42.42.7.m1.1"><semantics id="S7.T5.42.42.42.7.m1.1a"><mn id="S7.T5.42.42.42.7.m1.1.1" xref="S7.T5.42.42.42.7.m1.1.1.cmml">85.32</mn><annotation-xml encoding="MathML-Content" id="S7.T5.42.42.42.7.m1.1b"><cn id="S7.T5.42.42.42.7.m1.1.1.cmml" type="float" xref="S7.T5.42.42.42.7.m1.1.1">85.32</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.42.42.42.7.m1.1c">85.32</annotation><annotation encoding="application/x-llamapun" id="S7.T5.42.42.42.7.m1.1d">85.32</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.43.43.43.8"><math alttext="57.22" class="ltx_Math" display="inline" id="S7.T5.43.43.43.8.m1.1"><semantics id="S7.T5.43.43.43.8.m1.1a"><mn id="S7.T5.43.43.43.8.m1.1.1" xref="S7.T5.43.43.43.8.m1.1.1.cmml">57.22</mn><annotation-xml encoding="MathML-Content" id="S7.T5.43.43.43.8.m1.1b"><cn id="S7.T5.43.43.43.8.m1.1.1.cmml" type="float" xref="S7.T5.43.43.43.8.m1.1.1">57.22</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.43.43.43.8.m1.1c">57.22</annotation><annotation encoding="application/x-llamapun" id="S7.T5.43.43.43.8.m1.1d">57.22</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.44.44.44.9"><math alttext="52.65" class="ltx_Math" display="inline" id="S7.T5.44.44.44.9.m1.1"><semantics id="S7.T5.44.44.44.9.m1.1a"><mn id="S7.T5.44.44.44.9.m1.1.1" xref="S7.T5.44.44.44.9.m1.1.1.cmml">52.65</mn><annotation-xml encoding="MathML-Content" id="S7.T5.44.44.44.9.m1.1b"><cn id="S7.T5.44.44.44.9.m1.1.1.cmml" type="float" xref="S7.T5.44.44.44.9.m1.1.1">52.65</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.44.44.44.9.m1.1c">52.65</annotation><annotation encoding="application/x-llamapun" id="S7.T5.44.44.44.9.m1.1d">52.65</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.45.45.45.10"><math alttext="76.18" class="ltx_Math" display="inline" id="S7.T5.45.45.45.10.m1.1"><semantics id="S7.T5.45.45.45.10.m1.1a"><mn id="S7.T5.45.45.45.10.m1.1.1" xref="S7.T5.45.45.45.10.m1.1.1.cmml">76.18</mn><annotation-xml encoding="MathML-Content" id="S7.T5.45.45.45.10.m1.1b"><cn id="S7.T5.45.45.45.10.m1.1.1.cmml" type="float" xref="S7.T5.45.45.45.10.m1.1.1">76.18</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.45.45.45.10.m1.1c">76.18</annotation><annotation encoding="application/x-llamapun" id="S7.T5.45.45.45.10.m1.1d">76.18</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T5.46.46.46.11"><math alttext="76.01\scriptscriptstyle\pm 12.56" class="ltx_Math" display="inline" id="S7.T5.46.46.46.11.m1.1"><semantics id="S7.T5.46.46.46.11.m1.1a"><mrow id="S7.T5.46.46.46.11.m1.1.1" xref="S7.T5.46.46.46.11.m1.1.1.cmml"><mn id="S7.T5.46.46.46.11.m1.1.1.2" xref="S7.T5.46.46.46.11.m1.1.1.2.cmml">76.01</mn><mo id="S7.T5.46.46.46.11.m1.1.1.1" mathsize="50%" xref="S7.T5.46.46.46.11.m1.1.1.1.cmml">±</mo><mn id="S7.T5.46.46.46.11.m1.1.1.3" mathsize="50%" xref="S7.T5.46.46.46.11.m1.1.1.3.cmml">12.56</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.46.46.46.11.m1.1b"><apply id="S7.T5.46.46.46.11.m1.1.1.cmml" xref="S7.T5.46.46.46.11.m1.1.1"><csymbol cd="latexml" id="S7.T5.46.46.46.11.m1.1.1.1.cmml" xref="S7.T5.46.46.46.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T5.46.46.46.11.m1.1.1.2.cmml" type="float" xref="S7.T5.46.46.46.11.m1.1.1.2">76.01</cn><cn id="S7.T5.46.46.46.11.m1.1.1.3.cmml" type="float" xref="S7.T5.46.46.46.11.m1.1.1.3">12.56</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.46.46.46.11.m1.1c">76.01\scriptscriptstyle\pm 12.56</annotation><annotation encoding="application/x-llamapun" id="S7.T5.46.46.46.11.m1.1d">76.01 ± 12.56</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T5.57.57.57">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T5.57.57.57.12">CoCoOp</th>
<td class="ltx_td ltx_align_center" id="S7.T5.47.47.47.1"><math alttext="55.75" class="ltx_Math" display="inline" id="S7.T5.47.47.47.1.m1.1"><semantics id="S7.T5.47.47.47.1.m1.1a"><mn id="S7.T5.47.47.47.1.m1.1.1" xref="S7.T5.47.47.47.1.m1.1.1.cmml">55.75</mn><annotation-xml encoding="MathML-Content" id="S7.T5.47.47.47.1.m1.1b"><cn id="S7.T5.47.47.47.1.m1.1.1.cmml" type="float" xref="S7.T5.47.47.47.1.m1.1.1">55.75</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.47.47.47.1.m1.1c">55.75</annotation><annotation encoding="application/x-llamapun" id="S7.T5.47.47.47.1.m1.1d">55.75</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.48.48.48.2"><math alttext="73.03" class="ltx_Math" display="inline" id="S7.T5.48.48.48.2.m1.1"><semantics id="S7.T5.48.48.48.2.m1.1a"><mn id="S7.T5.48.48.48.2.m1.1.1" xref="S7.T5.48.48.48.2.m1.1.1.cmml">73.03</mn><annotation-xml encoding="MathML-Content" id="S7.T5.48.48.48.2.m1.1b"><cn id="S7.T5.48.48.48.2.m1.1.1.cmml" type="float" xref="S7.T5.48.48.48.2.m1.1.1">73.03</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.48.48.48.2.m1.1c">73.03</annotation><annotation encoding="application/x-llamapun" id="S7.T5.48.48.48.2.m1.1d">73.03</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.49.49.49.3"><math alttext="75.54" class="ltx_Math" display="inline" id="S7.T5.49.49.49.3.m1.1"><semantics id="S7.T5.49.49.49.3.m1.1a"><mn id="S7.T5.49.49.49.3.m1.1.1" xref="S7.T5.49.49.49.3.m1.1.1.cmml">75.54</mn><annotation-xml encoding="MathML-Content" id="S7.T5.49.49.49.3.m1.1b"><cn id="S7.T5.49.49.49.3.m1.1.1.cmml" type="float" xref="S7.T5.49.49.49.3.m1.1.1">75.54</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.49.49.49.3.m1.1c">75.54</annotation><annotation encoding="application/x-llamapun" id="S7.T5.49.49.49.3.m1.1d">75.54</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.50.50.50.4"><math alttext="57.90" class="ltx_Math" display="inline" id="S7.T5.50.50.50.4.m1.1"><semantics id="S7.T5.50.50.50.4.m1.1a"><mn id="S7.T5.50.50.50.4.m1.1.1" xref="S7.T5.50.50.50.4.m1.1.1.cmml">57.90</mn><annotation-xml encoding="MathML-Content" id="S7.T5.50.50.50.4.m1.1b"><cn id="S7.T5.50.50.50.4.m1.1.1.cmml" type="float" xref="S7.T5.50.50.50.4.m1.1.1">57.90</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.50.50.50.4.m1.1c">57.90</annotation><annotation encoding="application/x-llamapun" id="S7.T5.50.50.50.4.m1.1d">57.90</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.51.51.51.5"><math alttext="89.55" class="ltx_Math" display="inline" id="S7.T5.51.51.51.5.m1.1"><semantics id="S7.T5.51.51.51.5.m1.1a"><mn id="S7.T5.51.51.51.5.m1.1.1" xref="S7.T5.51.51.51.5.m1.1.1.cmml">89.55</mn><annotation-xml encoding="MathML-Content" id="S7.T5.51.51.51.5.m1.1b"><cn id="S7.T5.51.51.51.5.m1.1.1.cmml" type="float" xref="S7.T5.51.51.51.5.m1.1.1">89.55</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.51.51.51.5.m1.1c">89.55</annotation><annotation encoding="application/x-llamapun" id="S7.T5.51.51.51.5.m1.1d">89.55</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.52.52.52.6"><math alttext="70.60" class="ltx_Math" display="inline" id="S7.T5.52.52.52.6.m1.1"><semantics id="S7.T5.52.52.52.6.m1.1a"><mn id="S7.T5.52.52.52.6.m1.1.1" xref="S7.T5.52.52.52.6.m1.1.1.cmml">70.60</mn><annotation-xml encoding="MathML-Content" id="S7.T5.52.52.52.6.m1.1b"><cn id="S7.T5.52.52.52.6.m1.1.1.cmml" type="float" xref="S7.T5.52.52.52.6.m1.1.1">70.60</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.52.52.52.6.m1.1c">70.60</annotation><annotation encoding="application/x-llamapun" id="S7.T5.52.52.52.6.m1.1d">70.60</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.53.53.53.7"><math alttext="60.23" class="ltx_Math" display="inline" id="S7.T5.53.53.53.7.m1.1"><semantics id="S7.T5.53.53.53.7.m1.1a"><mn id="S7.T5.53.53.53.7.m1.1.1" xref="S7.T5.53.53.53.7.m1.1.1.cmml">60.23</mn><annotation-xml encoding="MathML-Content" id="S7.T5.53.53.53.7.m1.1b"><cn id="S7.T5.53.53.53.7.m1.1.1.cmml" type="float" xref="S7.T5.53.53.53.7.m1.1.1">60.23</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.53.53.53.7.m1.1c">60.23</annotation><annotation encoding="application/x-llamapun" id="S7.T5.53.53.53.7.m1.1d">60.23</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.54.54.54.8"><math alttext="42.61" class="ltx_Math" display="inline" id="S7.T5.54.54.54.8.m1.1"><semantics id="S7.T5.54.54.54.8.m1.1a"><mn id="S7.T5.54.54.54.8.m1.1.1" xref="S7.T5.54.54.54.8.m1.1.1.cmml">42.61</mn><annotation-xml encoding="MathML-Content" id="S7.T5.54.54.54.8.m1.1b"><cn id="S7.T5.54.54.54.8.m1.1.1.cmml" type="float" xref="S7.T5.54.54.54.8.m1.1.1">42.61</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.54.54.54.8.m1.1c">42.61</annotation><annotation encoding="application/x-llamapun" id="S7.T5.54.54.54.8.m1.1d">42.61</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.55.55.55.9"><math alttext="47.91" class="ltx_Math" display="inline" id="S7.T5.55.55.55.9.m1.1"><semantics id="S7.T5.55.55.55.9.m1.1a"><mn id="S7.T5.55.55.55.9.m1.1.1" xref="S7.T5.55.55.55.9.m1.1.1.cmml">47.91</mn><annotation-xml encoding="MathML-Content" id="S7.T5.55.55.55.9.m1.1b"><cn id="S7.T5.55.55.55.9.m1.1.1.cmml" type="float" xref="S7.T5.55.55.55.9.m1.1.1">47.91</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.55.55.55.9.m1.1c">47.91</annotation><annotation encoding="application/x-llamapun" id="S7.T5.55.55.55.9.m1.1d">47.91</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.56.56.56.10"><math alttext="75.85" class="ltx_Math" display="inline" id="S7.T5.56.56.56.10.m1.1"><semantics id="S7.T5.56.56.56.10.m1.1a"><mn id="S7.T5.56.56.56.10.m1.1.1" xref="S7.T5.56.56.56.10.m1.1.1.cmml">75.85</mn><annotation-xml encoding="MathML-Content" id="S7.T5.56.56.56.10.m1.1b"><cn id="S7.T5.56.56.56.10.m1.1.1.cmml" type="float" xref="S7.T5.56.56.56.10.m1.1.1">75.85</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.56.56.56.10.m1.1c">75.85</annotation><annotation encoding="application/x-llamapun" id="S7.T5.56.56.56.10.m1.1d">75.85</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T5.57.57.57.11"><math alttext="64.9\scriptscriptstyle\pm 13.71" class="ltx_Math" display="inline" id="S7.T5.57.57.57.11.m1.1"><semantics id="S7.T5.57.57.57.11.m1.1a"><mrow id="S7.T5.57.57.57.11.m1.1.1" xref="S7.T5.57.57.57.11.m1.1.1.cmml"><mn id="S7.T5.57.57.57.11.m1.1.1.2" xref="S7.T5.57.57.57.11.m1.1.1.2.cmml">64.9</mn><mo id="S7.T5.57.57.57.11.m1.1.1.1" mathsize="50%" xref="S7.T5.57.57.57.11.m1.1.1.1.cmml">±</mo><mn id="S7.T5.57.57.57.11.m1.1.1.3" mathsize="50%" xref="S7.T5.57.57.57.11.m1.1.1.3.cmml">13.71</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.57.57.57.11.m1.1b"><apply id="S7.T5.57.57.57.11.m1.1.1.cmml" xref="S7.T5.57.57.57.11.m1.1.1"><csymbol cd="latexml" id="S7.T5.57.57.57.11.m1.1.1.1.cmml" xref="S7.T5.57.57.57.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T5.57.57.57.11.m1.1.1.2.cmml" type="float" xref="S7.T5.57.57.57.11.m1.1.1.2">64.9</cn><cn id="S7.T5.57.57.57.11.m1.1.1.3.cmml" type="float" xref="S7.T5.57.57.57.11.m1.1.1.3">13.71</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.57.57.57.11.m1.1c">64.9\scriptscriptstyle\pm 13.71</annotation><annotation encoding="application/x-llamapun" id="S7.T5.57.57.57.11.m1.1d">64.9 ± 13.71</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T5.68.68.68">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T5.68.68.68.12">CoOp</th>
<td class="ltx_td ltx_align_center" id="S7.T5.58.58.58.1"><math alttext="53.80" class="ltx_Math" display="inline" id="S7.T5.58.58.58.1.m1.1"><semantics id="S7.T5.58.58.58.1.m1.1a"><mn id="S7.T5.58.58.58.1.m1.1.1" xref="S7.T5.58.58.58.1.m1.1.1.cmml">53.80</mn><annotation-xml encoding="MathML-Content" id="S7.T5.58.58.58.1.m1.1b"><cn id="S7.T5.58.58.58.1.m1.1.1.cmml" type="float" xref="S7.T5.58.58.58.1.m1.1.1">53.80</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.58.58.58.1.m1.1c">53.80</annotation><annotation encoding="application/x-llamapun" id="S7.T5.58.58.58.1.m1.1d">53.80</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.59.59.59.2"><math alttext="66.56" class="ltx_Math" display="inline" id="S7.T5.59.59.59.2.m1.1"><semantics id="S7.T5.59.59.59.2.m1.1a"><mn id="S7.T5.59.59.59.2.m1.1.1" xref="S7.T5.59.59.59.2.m1.1.1.cmml">66.56</mn><annotation-xml encoding="MathML-Content" id="S7.T5.59.59.59.2.m1.1b"><cn id="S7.T5.59.59.59.2.m1.1.1.cmml" type="float" xref="S7.T5.59.59.59.2.m1.1.1">66.56</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.59.59.59.2.m1.1c">66.56</annotation><annotation encoding="application/x-llamapun" id="S7.T5.59.59.59.2.m1.1d">66.56</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.60.60.60.3"><math alttext="73.29" class="ltx_Math" display="inline" id="S7.T5.60.60.60.3.m1.1"><semantics id="S7.T5.60.60.60.3.m1.1a"><mn id="S7.T5.60.60.60.3.m1.1.1" xref="S7.T5.60.60.60.3.m1.1.1.cmml">73.29</mn><annotation-xml encoding="MathML-Content" id="S7.T5.60.60.60.3.m1.1b"><cn id="S7.T5.60.60.60.3.m1.1.1.cmml" type="float" xref="S7.T5.60.60.60.3.m1.1.1">73.29</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.60.60.60.3.m1.1c">73.29</annotation><annotation encoding="application/x-llamapun" id="S7.T5.60.60.60.3.m1.1d">73.29</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.61.61.61.4"><math alttext="54.53" class="ltx_Math" display="inline" id="S7.T5.61.61.61.4.m1.1"><semantics id="S7.T5.61.61.61.4.m1.1a"><mn id="S7.T5.61.61.61.4.m1.1.1" xref="S7.T5.61.61.61.4.m1.1.1.cmml">54.53</mn><annotation-xml encoding="MathML-Content" id="S7.T5.61.61.61.4.m1.1b"><cn id="S7.T5.61.61.61.4.m1.1.1.cmml" type="float" xref="S7.T5.61.61.61.4.m1.1.1">54.53</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.61.61.61.4.m1.1c">54.53</annotation><annotation encoding="application/x-llamapun" id="S7.T5.61.61.61.4.m1.1d">54.53</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.62.62.62.5"><math alttext="88.98" class="ltx_Math" display="inline" id="S7.T5.62.62.62.5.m1.1"><semantics id="S7.T5.62.62.62.5.m1.1a"><mn id="S7.T5.62.62.62.5.m1.1.1" xref="S7.T5.62.62.62.5.m1.1.1.cmml">88.98</mn><annotation-xml encoding="MathML-Content" id="S7.T5.62.62.62.5.m1.1b"><cn id="S7.T5.62.62.62.5.m1.1.1.cmml" type="float" xref="S7.T5.62.62.62.5.m1.1.1">88.98</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.62.62.62.5.m1.1c">88.98</annotation><annotation encoding="application/x-llamapun" id="S7.T5.62.62.62.5.m1.1d">88.98</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.63.63.63.6"><math alttext="67.85" class="ltx_Math" display="inline" id="S7.T5.63.63.63.6.m1.1"><semantics id="S7.T5.63.63.63.6.m1.1a"><mn id="S7.T5.63.63.63.6.m1.1.1" xref="S7.T5.63.63.63.6.m1.1.1.cmml">67.85</mn><annotation-xml encoding="MathML-Content" id="S7.T5.63.63.63.6.m1.1b"><cn id="S7.T5.63.63.63.6.m1.1.1.cmml" type="float" xref="S7.T5.63.63.63.6.m1.1.1">67.85</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.63.63.63.6.m1.1c">67.85</annotation><annotation encoding="application/x-llamapun" id="S7.T5.63.63.63.6.m1.1d">67.85</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.64.64.64.7"><math alttext="57.93" class="ltx_Math" display="inline" id="S7.T5.64.64.64.7.m1.1"><semantics id="S7.T5.64.64.64.7.m1.1a"><mn id="S7.T5.64.64.64.7.m1.1.1" xref="S7.T5.64.64.64.7.m1.1.1.cmml">57.93</mn><annotation-xml encoding="MathML-Content" id="S7.T5.64.64.64.7.m1.1b"><cn id="S7.T5.64.64.64.7.m1.1.1.cmml" type="float" xref="S7.T5.64.64.64.7.m1.1.1">57.93</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.64.64.64.7.m1.1c">57.93</annotation><annotation encoding="application/x-llamapun" id="S7.T5.64.64.64.7.m1.1d">57.93</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.65.65.65.8"><math alttext="41.06" class="ltx_Math" display="inline" id="S7.T5.65.65.65.8.m1.1"><semantics id="S7.T5.65.65.65.8.m1.1a"><mn id="S7.T5.65.65.65.8.m1.1.1" xref="S7.T5.65.65.65.8.m1.1.1.cmml">41.06</mn><annotation-xml encoding="MathML-Content" id="S7.T5.65.65.65.8.m1.1b"><cn id="S7.T5.65.65.65.8.m1.1.1.cmml" type="float" xref="S7.T5.65.65.65.8.m1.1.1">41.06</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.65.65.65.8.m1.1c">41.06</annotation><annotation encoding="application/x-llamapun" id="S7.T5.65.65.65.8.m1.1d">41.06</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.66.66.66.9"><math alttext="47.91" class="ltx_Math" display="inline" id="S7.T5.66.66.66.9.m1.1"><semantics id="S7.T5.66.66.66.9.m1.1a"><mn id="S7.T5.66.66.66.9.m1.1.1" xref="S7.T5.66.66.66.9.m1.1.1.cmml">47.91</mn><annotation-xml encoding="MathML-Content" id="S7.T5.66.66.66.9.m1.1b"><cn id="S7.T5.66.66.66.9.m1.1.1.cmml" type="float" xref="S7.T5.66.66.66.9.m1.1.1">47.91</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.66.66.66.9.m1.1c">47.91</annotation><annotation encoding="application/x-llamapun" id="S7.T5.66.66.66.9.m1.1d">47.91</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.67.67.67.10"><math alttext="75.47" class="ltx_Math" display="inline" id="S7.T5.67.67.67.10.m1.1"><semantics id="S7.T5.67.67.67.10.m1.1a"><mn id="S7.T5.67.67.67.10.m1.1.1" xref="S7.T5.67.67.67.10.m1.1.1.cmml">75.47</mn><annotation-xml encoding="MathML-Content" id="S7.T5.67.67.67.10.m1.1b"><cn id="S7.T5.67.67.67.10.m1.1.1.cmml" type="float" xref="S7.T5.67.67.67.10.m1.1.1">75.47</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.67.67.67.10.m1.1c">75.47</annotation><annotation encoding="application/x-llamapun" id="S7.T5.67.67.67.10.m1.1d">75.47</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T5.68.68.68.11"><math alttext="62.74\scriptscriptstyle\pm 13.65" class="ltx_Math" display="inline" id="S7.T5.68.68.68.11.m1.1"><semantics id="S7.T5.68.68.68.11.m1.1a"><mrow id="S7.T5.68.68.68.11.m1.1.1" xref="S7.T5.68.68.68.11.m1.1.1.cmml"><mn id="S7.T5.68.68.68.11.m1.1.1.2" xref="S7.T5.68.68.68.11.m1.1.1.2.cmml">62.74</mn><mo id="S7.T5.68.68.68.11.m1.1.1.1" mathsize="50%" xref="S7.T5.68.68.68.11.m1.1.1.1.cmml">±</mo><mn id="S7.T5.68.68.68.11.m1.1.1.3" mathsize="50%" xref="S7.T5.68.68.68.11.m1.1.1.3.cmml">13.65</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.68.68.68.11.m1.1b"><apply id="S7.T5.68.68.68.11.m1.1.1.cmml" xref="S7.T5.68.68.68.11.m1.1.1"><csymbol cd="latexml" id="S7.T5.68.68.68.11.m1.1.1.1.cmml" xref="S7.T5.68.68.68.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T5.68.68.68.11.m1.1.1.2.cmml" type="float" xref="S7.T5.68.68.68.11.m1.1.1.2">62.74</cn><cn id="S7.T5.68.68.68.11.m1.1.1.3.cmml" type="float" xref="S7.T5.68.68.68.11.m1.1.1.3">13.65</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.68.68.68.11.m1.1c">62.74\scriptscriptstyle\pm 13.65</annotation><annotation encoding="application/x-llamapun" id="S7.T5.68.68.68.11.m1.1d">62.74 ± 13.65</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T5.79.79.79">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T5.79.79.79.12" rowspan="2"><span class="ltx_text" id="S7.T5.79.79.79.12.1">CRIS</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S7.T5.79.79.79.13">CoCoOp</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.69.69.69.1"><math alttext="72.63" class="ltx_Math" display="inline" id="S7.T5.69.69.69.1.m1.1"><semantics id="S7.T5.69.69.69.1.m1.1a"><mn id="S7.T5.69.69.69.1.m1.1.1" xref="S7.T5.69.69.69.1.m1.1.1.cmml">72.63</mn><annotation-xml encoding="MathML-Content" id="S7.T5.69.69.69.1.m1.1b"><cn id="S7.T5.69.69.69.1.m1.1.1.cmml" type="float" xref="S7.T5.69.69.69.1.m1.1.1">72.63</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.69.69.69.1.m1.1c">72.63</annotation><annotation encoding="application/x-llamapun" id="S7.T5.69.69.69.1.m1.1d">72.63</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.70.70.70.2"><math alttext="77.19" class="ltx_Math" display="inline" id="S7.T5.70.70.70.2.m1.1"><semantics id="S7.T5.70.70.70.2.m1.1a"><mn id="S7.T5.70.70.70.2.m1.1.1" xref="S7.T5.70.70.70.2.m1.1.1.cmml">77.19</mn><annotation-xml encoding="MathML-Content" id="S7.T5.70.70.70.2.m1.1b"><cn id="S7.T5.70.70.70.2.m1.1.1.cmml" type="float" xref="S7.T5.70.70.70.2.m1.1.1">77.19</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.70.70.70.2.m1.1c">77.19</annotation><annotation encoding="application/x-llamapun" id="S7.T5.70.70.70.2.m1.1d">77.19</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.71.71.71.3"><math alttext="81.69" class="ltx_Math" display="inline" id="S7.T5.71.71.71.3.m1.1"><semantics id="S7.T5.71.71.71.3.m1.1a"><mn id="S7.T5.71.71.71.3.m1.1.1" xref="S7.T5.71.71.71.3.m1.1.1.cmml">81.69</mn><annotation-xml encoding="MathML-Content" id="S7.T5.71.71.71.3.m1.1b"><cn id="S7.T5.71.71.71.3.m1.1.1.cmml" type="float" xref="S7.T5.71.71.71.3.m1.1.1">81.69</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.71.71.71.3.m1.1c">81.69</annotation><annotation encoding="application/x-llamapun" id="S7.T5.71.71.71.3.m1.1d">81.69</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.72.72.72.4"><math alttext="53.05" class="ltx_Math" display="inline" id="S7.T5.72.72.72.4.m1.1"><semantics id="S7.T5.72.72.72.4.m1.1a"><mn id="S7.T5.72.72.72.4.m1.1.1" xref="S7.T5.72.72.72.4.m1.1.1.cmml">53.05</mn><annotation-xml encoding="MathML-Content" id="S7.T5.72.72.72.4.m1.1b"><cn id="S7.T5.72.72.72.4.m1.1.1.cmml" type="float" xref="S7.T5.72.72.72.4.m1.1.1">53.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.72.72.72.4.m1.1c">53.05</annotation><annotation encoding="application/x-llamapun" id="S7.T5.72.72.72.4.m1.1d">53.05</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.73.73.73.5"><math alttext="84.51" class="ltx_Math" display="inline" id="S7.T5.73.73.73.5.m1.1"><semantics id="S7.T5.73.73.73.5.m1.1a"><mn id="S7.T5.73.73.73.5.m1.1.1" xref="S7.T5.73.73.73.5.m1.1.1.cmml">84.51</mn><annotation-xml encoding="MathML-Content" id="S7.T5.73.73.73.5.m1.1b"><cn id="S7.T5.73.73.73.5.m1.1.1.cmml" type="float" xref="S7.T5.73.73.73.5.m1.1.1">84.51</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.73.73.73.5.m1.1c">84.51</annotation><annotation encoding="application/x-llamapun" id="S7.T5.73.73.73.5.m1.1d">84.51</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.74.74.74.6"><math alttext="62.62" class="ltx_Math" display="inline" id="S7.T5.74.74.74.6.m1.1"><semantics id="S7.T5.74.74.74.6.m1.1a"><mn id="S7.T5.74.74.74.6.m1.1.1" xref="S7.T5.74.74.74.6.m1.1.1.cmml">62.62</mn><annotation-xml encoding="MathML-Content" id="S7.T5.74.74.74.6.m1.1b"><cn id="S7.T5.74.74.74.6.m1.1.1.cmml" type="float" xref="S7.T5.74.74.74.6.m1.1.1">62.62</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.74.74.74.6.m1.1c">62.62</annotation><annotation encoding="application/x-llamapun" id="S7.T5.74.74.74.6.m1.1d">62.62</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.75.75.75.7"><math alttext="75.71" class="ltx_Math" display="inline" id="S7.T5.75.75.75.7.m1.1"><semantics id="S7.T5.75.75.75.7.m1.1a"><mn id="S7.T5.75.75.75.7.m1.1.1" xref="S7.T5.75.75.75.7.m1.1.1.cmml">75.71</mn><annotation-xml encoding="MathML-Content" id="S7.T5.75.75.75.7.m1.1b"><cn id="S7.T5.75.75.75.7.m1.1.1.cmml" type="float" xref="S7.T5.75.75.75.7.m1.1.1">75.71</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.75.75.75.7.m1.1c">75.71</annotation><annotation encoding="application/x-llamapun" id="S7.T5.75.75.75.7.m1.1d">75.71</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.76.76.76.8"><math alttext="47.45" class="ltx_Math" display="inline" id="S7.T5.76.76.76.8.m1.1"><semantics id="S7.T5.76.76.76.8.m1.1a"><mn id="S7.T5.76.76.76.8.m1.1.1" xref="S7.T5.76.76.76.8.m1.1.1.cmml">47.45</mn><annotation-xml encoding="MathML-Content" id="S7.T5.76.76.76.8.m1.1b"><cn id="S7.T5.76.76.76.8.m1.1.1.cmml" type="float" xref="S7.T5.76.76.76.8.m1.1.1">47.45</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.76.76.76.8.m1.1c">47.45</annotation><annotation encoding="application/x-llamapun" id="S7.T5.76.76.76.8.m1.1d">47.45</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.77.77.77.9"><math alttext="43.20" class="ltx_Math" display="inline" id="S7.T5.77.77.77.9.m1.1"><semantics id="S7.T5.77.77.77.9.m1.1a"><mn id="S7.T5.77.77.77.9.m1.1.1" xref="S7.T5.77.77.77.9.m1.1.1.cmml">43.20</mn><annotation-xml encoding="MathML-Content" id="S7.T5.77.77.77.9.m1.1b"><cn id="S7.T5.77.77.77.9.m1.1.1.cmml" type="float" xref="S7.T5.77.77.77.9.m1.1.1">43.20</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.77.77.77.9.m1.1c">43.20</annotation><annotation encoding="application/x-llamapun" id="S7.T5.77.77.77.9.m1.1d">43.20</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S7.T5.78.78.78.10"><math alttext="70.04" class="ltx_Math" display="inline" id="S7.T5.78.78.78.10.m1.1"><semantics id="S7.T5.78.78.78.10.m1.1a"><mn id="S7.T5.78.78.78.10.m1.1.1" xref="S7.T5.78.78.78.10.m1.1.1.cmml">70.04</mn><annotation-xml encoding="MathML-Content" id="S7.T5.78.78.78.10.m1.1b"><cn id="S7.T5.78.78.78.10.m1.1.1.cmml" type="float" xref="S7.T5.78.78.78.10.m1.1.1">70.04</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.78.78.78.10.m1.1c">70.04</annotation><annotation encoding="application/x-llamapun" id="S7.T5.78.78.78.10.m1.1d">70.04</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S7.T5.79.79.79.11"><math alttext="66.81\scriptscriptstyle\pm 13.8" class="ltx_Math" display="inline" id="S7.T5.79.79.79.11.m1.1"><semantics id="S7.T5.79.79.79.11.m1.1a"><mrow id="S7.T5.79.79.79.11.m1.1.1" xref="S7.T5.79.79.79.11.m1.1.1.cmml"><mn id="S7.T5.79.79.79.11.m1.1.1.2" xref="S7.T5.79.79.79.11.m1.1.1.2.cmml">66.81</mn><mo id="S7.T5.79.79.79.11.m1.1.1.1" mathsize="50%" xref="S7.T5.79.79.79.11.m1.1.1.1.cmml">±</mo><mn id="S7.T5.79.79.79.11.m1.1.1.3" mathsize="50%" xref="S7.T5.79.79.79.11.m1.1.1.3.cmml">13.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.79.79.79.11.m1.1b"><apply id="S7.T5.79.79.79.11.m1.1.1.cmml" xref="S7.T5.79.79.79.11.m1.1.1"><csymbol cd="latexml" id="S7.T5.79.79.79.11.m1.1.1.1.cmml" xref="S7.T5.79.79.79.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T5.79.79.79.11.m1.1.1.2.cmml" type="float" xref="S7.T5.79.79.79.11.m1.1.1.2">66.81</cn><cn id="S7.T5.79.79.79.11.m1.1.1.3.cmml" type="float" xref="S7.T5.79.79.79.11.m1.1.1.3">13.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.79.79.79.11.m1.1c">66.81\scriptscriptstyle\pm 13.8</annotation><annotation encoding="application/x-llamapun" id="S7.T5.79.79.79.11.m1.1d">66.81 ± 13.8</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T5.90.90.90">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T5.90.90.90.12">CoOp</th>
<td class="ltx_td ltx_align_center" id="S7.T5.80.80.80.1"><math alttext="72.14" class="ltx_Math" display="inline" id="S7.T5.80.80.80.1.m1.1"><semantics id="S7.T5.80.80.80.1.m1.1a"><mn id="S7.T5.80.80.80.1.m1.1.1" xref="S7.T5.80.80.80.1.m1.1.1.cmml">72.14</mn><annotation-xml encoding="MathML-Content" id="S7.T5.80.80.80.1.m1.1b"><cn id="S7.T5.80.80.80.1.m1.1.1.cmml" type="float" xref="S7.T5.80.80.80.1.m1.1.1">72.14</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.80.80.80.1.m1.1c">72.14</annotation><annotation encoding="application/x-llamapun" id="S7.T5.80.80.80.1.m1.1d">72.14</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.81.81.81.2"><math alttext="75.73" class="ltx_Math" display="inline" id="S7.T5.81.81.81.2.m1.1"><semantics id="S7.T5.81.81.81.2.m1.1a"><mn id="S7.T5.81.81.81.2.m1.1.1" xref="S7.T5.81.81.81.2.m1.1.1.cmml">75.73</mn><annotation-xml encoding="MathML-Content" id="S7.T5.81.81.81.2.m1.1b"><cn id="S7.T5.81.81.81.2.m1.1.1.cmml" type="float" xref="S7.T5.81.81.81.2.m1.1.1">75.73</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.81.81.81.2.m1.1c">75.73</annotation><annotation encoding="application/x-llamapun" id="S7.T5.81.81.81.2.m1.1d">75.73</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.82.82.82.3"><math alttext="79.44" class="ltx_Math" display="inline" id="S7.T5.82.82.82.3.m1.1"><semantics id="S7.T5.82.82.82.3.m1.1a"><mn id="S7.T5.82.82.82.3.m1.1.1" xref="S7.T5.82.82.82.3.m1.1.1.cmml">79.44</mn><annotation-xml encoding="MathML-Content" id="S7.T5.82.82.82.3.m1.1b"><cn id="S7.T5.82.82.82.3.m1.1.1.cmml" type="float" xref="S7.T5.82.82.82.3.m1.1.1">79.44</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.82.82.82.3.m1.1c">79.44</annotation><annotation encoding="application/x-llamapun" id="S7.T5.82.82.82.3.m1.1d">79.44</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.83.83.83.4"><math alttext="52.02" class="ltx_Math" display="inline" id="S7.T5.83.83.83.4.m1.1"><semantics id="S7.T5.83.83.83.4.m1.1a"><mn id="S7.T5.83.83.83.4.m1.1.1" xref="S7.T5.83.83.83.4.m1.1.1.cmml">52.02</mn><annotation-xml encoding="MathML-Content" id="S7.T5.83.83.83.4.m1.1b"><cn id="S7.T5.83.83.83.4.m1.1.1.cmml" type="float" xref="S7.T5.83.83.83.4.m1.1.1">52.02</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.83.83.83.4.m1.1c">52.02</annotation><annotation encoding="application/x-llamapun" id="S7.T5.83.83.83.4.m1.1d">52.02</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.84.84.84.5"><math alttext="83.44" class="ltx_Math" display="inline" id="S7.T5.84.84.84.5.m1.1"><semantics id="S7.T5.84.84.84.5.m1.1a"><mn id="S7.T5.84.84.84.5.m1.1.1" xref="S7.T5.84.84.84.5.m1.1.1.cmml">83.44</mn><annotation-xml encoding="MathML-Content" id="S7.T5.84.84.84.5.m1.1b"><cn id="S7.T5.84.84.84.5.m1.1.1.cmml" type="float" xref="S7.T5.84.84.84.5.m1.1.1">83.44</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.84.84.84.5.m1.1c">83.44</annotation><annotation encoding="application/x-llamapun" id="S7.T5.84.84.84.5.m1.1d">83.44</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.85.85.85.6"><math alttext="64.53" class="ltx_Math" display="inline" id="S7.T5.85.85.85.6.m1.1"><semantics id="S7.T5.85.85.85.6.m1.1a"><mn id="S7.T5.85.85.85.6.m1.1.1" xref="S7.T5.85.85.85.6.m1.1.1.cmml">64.53</mn><annotation-xml encoding="MathML-Content" id="S7.T5.85.85.85.6.m1.1b"><cn id="S7.T5.85.85.85.6.m1.1.1.cmml" type="float" xref="S7.T5.85.85.85.6.m1.1.1">64.53</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.85.85.85.6.m1.1c">64.53</annotation><annotation encoding="application/x-llamapun" id="S7.T5.85.85.85.6.m1.1d">64.53</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.86.86.86.7"><math alttext="75.03" class="ltx_Math" display="inline" id="S7.T5.86.86.86.7.m1.1"><semantics id="S7.T5.86.86.86.7.m1.1a"><mn id="S7.T5.86.86.86.7.m1.1.1" xref="S7.T5.86.86.86.7.m1.1.1.cmml">75.03</mn><annotation-xml encoding="MathML-Content" id="S7.T5.86.86.86.7.m1.1b"><cn id="S7.T5.86.86.86.7.m1.1.1.cmml" type="float" xref="S7.T5.86.86.86.7.m1.1.1">75.03</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.86.86.86.7.m1.1c">75.03</annotation><annotation encoding="application/x-llamapun" id="S7.T5.86.86.86.7.m1.1d">75.03</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.87.87.87.8"><math alttext="48.71" class="ltx_Math" display="inline" id="S7.T5.87.87.87.8.m1.1"><semantics id="S7.T5.87.87.87.8.m1.1a"><mn id="S7.T5.87.87.87.8.m1.1.1" xref="S7.T5.87.87.87.8.m1.1.1.cmml">48.71</mn><annotation-xml encoding="MathML-Content" id="S7.T5.87.87.87.8.m1.1b"><cn id="S7.T5.87.87.87.8.m1.1.1.cmml" type="float" xref="S7.T5.87.87.87.8.m1.1.1">48.71</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.87.87.87.8.m1.1c">48.71</annotation><annotation encoding="application/x-llamapun" id="S7.T5.87.87.87.8.m1.1d">48.71</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.88.88.88.9"><math alttext="44.03" class="ltx_Math" display="inline" id="S7.T5.88.88.88.9.m1.1"><semantics id="S7.T5.88.88.88.9.m1.1a"><mn id="S7.T5.88.88.88.9.m1.1.1" xref="S7.T5.88.88.88.9.m1.1.1.cmml">44.03</mn><annotation-xml encoding="MathML-Content" id="S7.T5.88.88.88.9.m1.1b"><cn id="S7.T5.88.88.88.9.m1.1.1.cmml" type="float" xref="S7.T5.88.88.88.9.m1.1.1">44.03</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.88.88.88.9.m1.1c">44.03</annotation><annotation encoding="application/x-llamapun" id="S7.T5.88.88.88.9.m1.1d">44.03</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S7.T5.89.89.89.10"><math alttext="70.03" class="ltx_Math" display="inline" id="S7.T5.89.89.89.10.m1.1"><semantics id="S7.T5.89.89.89.10.m1.1a"><mn id="S7.T5.89.89.89.10.m1.1.1" xref="S7.T5.89.89.89.10.m1.1.1.cmml">70.03</mn><annotation-xml encoding="MathML-Content" id="S7.T5.89.89.89.10.m1.1b"><cn id="S7.T5.89.89.89.10.m1.1.1.cmml" type="float" xref="S7.T5.89.89.89.10.m1.1.1">70.03</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.89.89.89.10.m1.1c">70.03</annotation><annotation encoding="application/x-llamapun" id="S7.T5.89.89.89.10.m1.1d">70.03</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T5.90.90.90.11"><math alttext="66.51\scriptscriptstyle\pm 13.01" class="ltx_Math" display="inline" id="S7.T5.90.90.90.11.m1.1"><semantics id="S7.T5.90.90.90.11.m1.1a"><mrow id="S7.T5.90.90.90.11.m1.1.1" xref="S7.T5.90.90.90.11.m1.1.1.cmml"><mn id="S7.T5.90.90.90.11.m1.1.1.2" xref="S7.T5.90.90.90.11.m1.1.1.2.cmml">66.51</mn><mo id="S7.T5.90.90.90.11.m1.1.1.1" mathsize="50%" xref="S7.T5.90.90.90.11.m1.1.1.1.cmml">±</mo><mn id="S7.T5.90.90.90.11.m1.1.1.3" mathsize="50%" xref="S7.T5.90.90.90.11.m1.1.1.3.cmml">13.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.90.90.90.11.m1.1b"><apply id="S7.T5.90.90.90.11.m1.1.1.cmml" xref="S7.T5.90.90.90.11.m1.1.1"><csymbol cd="latexml" id="S7.T5.90.90.90.11.m1.1.1.1.cmml" xref="S7.T5.90.90.90.11.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T5.90.90.90.11.m1.1.1.2.cmml" type="float" xref="S7.T5.90.90.90.11.m1.1.1.2">66.51</cn><cn id="S7.T5.90.90.90.11.m1.1.1.3.cmml" type="float" xref="S7.T5.90.90.90.11.m1.1.1.3">13.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.90.90.90.11.m1.1c">66.51\scriptscriptstyle\pm 13.01</annotation><annotation encoding="application/x-llamapun" id="S7.T5.90.90.90.11.m1.1d">66.51 ± 13.01</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S7.T5.91.91.91">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb ltx_border_t" colspan="12" id="S7.T5.91.91.91.2">Average across Methods</th>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" id="S7.T5.91.91.91.1"><math alttext="70.51\scriptscriptstyle\pm 5.4" class="ltx_Math" display="inline" id="S7.T5.91.91.91.1.m1.1"><semantics id="S7.T5.91.91.91.1.m1.1a"><mrow id="S7.T5.91.91.91.1.m1.1.1" xref="S7.T5.91.91.91.1.m1.1.1.cmml"><mn id="S7.T5.91.91.91.1.m1.1.1.2" xref="S7.T5.91.91.91.1.m1.1.1.2.cmml">70.51</mn><mo id="S7.T5.91.91.91.1.m1.1.1.1" mathsize="50%" xref="S7.T5.91.91.91.1.m1.1.1.1.cmml">±</mo><mn id="S7.T5.91.91.91.1.m1.1.1.3" mathsize="50%" xref="S7.T5.91.91.91.1.m1.1.1.3.cmml">5.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T5.91.91.91.1.m1.1b"><apply id="S7.T5.91.91.91.1.m1.1.1.cmml" xref="S7.T5.91.91.91.1.m1.1.1"><csymbol cd="latexml" id="S7.T5.91.91.91.1.m1.1.1.1.cmml" xref="S7.T5.91.91.91.1.m1.1.1.1">plus-or-minus</csymbol><cn id="S7.T5.91.91.91.1.m1.1.1.2.cmml" type="float" xref="S7.T5.91.91.91.1.m1.1.1.2">70.51</cn><cn id="S7.T5.91.91.91.1.m1.1.1.3.cmml" type="float" xref="S7.T5.91.91.91.1.m1.1.1.3">5.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T5.91.91.91.1.m1.1c">70.51\scriptscriptstyle\pm 5.4</annotation><annotation encoding="application/x-llamapun" id="S7.T5.91.91.91.1.m1.1d">70.51 ± 5.4</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S7.SS3.p1">
<p class="ltx_p" id="S7.SS3.p1.1">As mentioned in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S5" title="5 Method ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5</span></a>, we have used a learnable upsampler as a residual connection to the decoder’s last layer.
To study the importance of the layer, we conduct an ablation by removing the learnable layer, keeping encoders and decoder frozen; the results from the ablation are shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S7.T5" title="In 7.3 Importance of Tuning Last Layer for Segmentation ‣ 7 Results and Discussion ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">5</span></a>.
From the table, we can see that the dice score has decreased for most of the cases, reducing the overall average dice score by <math alttext="2.59" class="ltx_Math" display="inline" id="S7.SS3.p1.1.m1.1"><semantics id="S7.SS3.p1.1.m1.1a"><mn id="S7.SS3.p1.1.m1.1.1" xref="S7.SS3.p1.1.m1.1.1.cmml">2.59</mn><annotation-xml encoding="MathML-Content" id="S7.SS3.p1.1.m1.1b"><cn id="S7.SS3.p1.1.m1.1.1.cmml" type="float" xref="S7.SS3.p1.1.m1.1.1">2.59</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.p1.1.m1.1c">2.59</annotation><annotation encoding="application/x-llamapun" id="S7.SS3.p1.1.m1.1d">2.59</annotation></semantics></math>.
This shows the advantage of the learnable upsampler for segmentation.</p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.4 </span>Importance of Prompt Depth</h3>
<div class="ltx_para" id="S7.SS4.p1">
<p class="ltx_p" id="S7.SS4.p1.1">Since prompt depth has shown to be an important hyperparameter of prompt tuning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib53" title="">53</a>]</cite>, we ran the experiments for various prompt depths as mentioned in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#S6.SS2" title="6.2 Implementation Details ‣ 6 Experiments ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">6.2</span></a>.
We have plotted the test dice score versus the prompt depth for various context learners for all the datasets in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#Pt0.A1.F6" title="In Appendix 0.A How does prompt depth affect Dice Score? ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>.
The reason to include the dice score for all the datasets in the same graph is to observe if each prompt learning technique improves in general on increasing the prompt depth.
From <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#Pt0.A1.F6.sf1" title="In Figure 6 ‣ Appendix 0.A How does prompt depth affect Dice Score? ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Figs.</span> <span class="ltx_text ltx_ref_tag">6(a)</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#Pt0.A1.F6.sf2" title="Figure 6(b) ‣ Figure 6 ‣ Appendix 0.A How does prompt depth affect Dice Score? ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">6(b)</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#Pt0.A1.F6.sf3" title="Figure 6(c) ‣ Figure 6 ‣ Appendix 0.A How does prompt depth affect Dice Score? ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">6(c)</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#Pt0.A1.F6.sf4" title="Figure 6(d) ‣ Figure 6 ‣ Appendix 0.A How does prompt depth affect Dice Score? ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">6(d)</span></a>, we can see that the textual context learners do not benefit significantly on increasing the prompt depth.</p>
</div>
<figure class="ltx_figure" id="S7.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S7.F5.sf1"><img alt="Refer to caption" class="ltx_graphics" id="S7.F5.sf1.g1" src="prompt_depth_coop_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F5.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S7.F5.sf1.3.2" style="font-size:90%;">CoOp CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S7.F5.sf2"><img alt="Refer to caption" class="ltx_graphics" id="S7.F5.sf2.g1" src="prompt_depth_coop_cris"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F5.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S7.F5.sf2.3.2" style="font-size:90%;">CoOp CRIS</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S7.F5.sf3"><img alt="Refer to caption" class="ltx_graphics" id="S7.F5.sf3.g1" src="prompt_depth_cocoop_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F5.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S7.F5.sf3.3.2" style="font-size:90%;">CoCoOp CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S7.F5.sf4"><img alt="Refer to caption" class="ltx_graphics" id="S7.F5.sf4.g1" src="prompt_depth_cocoop_cris"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F5.sf4.2.1.1" style="font-size:90%;">(d)</span> </span><span class="ltx_text" id="S7.F5.sf4.3.2" style="font-size:90%;">CoCoOp CRIS</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F5.4.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S7.F5.5.2" style="font-size:90%;">Test Dice <em class="ltx_emph ltx_font_italic" id="S7.F5.5.2.1">vs</em>.<span class="ltx_text" id="S7.F5.5.2.2"></span> Prompt Depth for Textual Tuning of all Datasets</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S7.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.5 </span>Learning Rate and Weight Decay</h3>
<div class="ltx_para" id="S7.SS5.p1">
<p class="ltx_p" id="S7.SS5.p1.1">Similar to Jia <em class="ltx_emph ltx_font_italic" id="S7.SS5.p1.1.1">et al</em>.<span class="ltx_text" id="S7.SS5.p1.1.2"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib19" title="">19</a>]</cite>, we also observed that no single learning rate and weight decay pair performs the best for all the dataset and context learners (see Appendix).
So, we need to perform some sort of hyperparameter sweep to obtain the best set of configurations for the downstream dataset of choice.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Limitations</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">This work focuses on using VLSMs pretrained on segmentation tasks and evaluates their performance on downstream tasks.
Since the classes used to train the models may not be the same as the ones used to evaluate the models in the downstream tasks, we chose VLSMs that output a binary mask, and the class to segment is provided through the text encoder.
We refer to the VLSMs whose parameters do not need to be changed as the classes in downstream tasks differ from the pretrained task as <span class="ltx_text ltx_font_italic" id="S8.p1.1.1">class-agnostic VLSMs</span>.
Also, since the multimodal prompt tuning assumes the vision and text encoders run in parallel, one depending upon another, we restricted our study to VLSMs that use both encoders in (almost) parallel settings.
Due to these constraints, we bounded our scope of study to CLIPSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib32" title="">32</a>]</cite> and CRIS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#bib.bib45" title="">45</a>]</cite>, VLSMs which output binary segmentation masks and use CLIP’s encoders for the segmentation tasks.</p>
</div>
</section>
<section class="ltx_section" id="S9">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Conclusion</h2>
<div class="ltx_para" id="S9.p1">
<p class="ltx_p" id="S9.p1.4">In this paper, we propose an open-source benchmark framework, <span class="ltx_text ltx_font_italic" id="S9.p1.4.1">TuneVLSeg</span>, to evaluate various unimodal and multimodal prompt tuning strategies on VLSMs for the segmentation task.
Although VLSMs other than the ones used in this paper are also available, we used only the class-agnostic VLSMs because of the difference in the classes between the pretrained and the downstream datasets.
Nevertheless, this can be extended to more VLSMs, if retaining the pretrained weights is not an issue, and more prompt tuning methodologies with minimum effort.
Besides, to present the effectiveness of our framework, we report the performance of <math alttext="6" class="ltx_Math" display="inline" id="S9.p1.1.m1.1"><semantics id="S9.p1.1.m1.1a"><mn id="S9.p1.1.m1.1.1" xref="S9.p1.1.m1.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S9.p1.1.m1.1b"><cn id="S9.p1.1.m1.1.1.cmml" type="integer" xref="S9.p1.1.m1.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.1.m1.1c">6</annotation><annotation encoding="application/x-llamapun" id="S9.p1.1.m1.1d">6</annotation></semantics></math> prompt tuning methods on adapting <math alttext="2" class="ltx_Math" display="inline" id="S9.p1.2.m2.1"><semantics id="S9.p1.2.m2.1a"><mn id="S9.p1.2.m2.1.1" xref="S9.p1.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S9.p1.2.m2.1b"><cn id="S9.p1.2.m2.1.1.cmml" type="integer" xref="S9.p1.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.2.m2.1c">2</annotation><annotation encoding="application/x-llamapun" id="S9.p1.2.m2.1d">2</annotation></semantics></math> CLIP-based VLSMs to <math alttext="2" class="ltx_Math" display="inline" id="S9.p1.3.m3.1"><semantics id="S9.p1.3.m3.1a"><mn id="S9.p1.3.m3.1.1" xref="S9.p1.3.m3.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S9.p1.3.m3.1b"><cn id="S9.p1.3.m3.1.1.cmml" type="integer" xref="S9.p1.3.m3.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.3.m3.1c">2</annotation><annotation encoding="application/x-llamapun" id="S9.p1.3.m3.1d">2</annotation></semantics></math> natural domain and <math alttext="8" class="ltx_Math" display="inline" id="S9.p1.4.m4.1"><semantics id="S9.p1.4.m4.1a"><mn id="S9.p1.4.m4.1.1" xref="S9.p1.4.m4.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S9.p1.4.m4.1b"><cn id="S9.p1.4.m4.1.1.cmml" type="integer" xref="S9.p1.4.m4.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.4.m4.1c">8</annotation><annotation encoding="application/x-llamapun" id="S9.p1.4.m4.1d">8</annotation></semantics></math> diverse medical domain segmentation datasets.
This work presents prompt tuning as an effective strategy to adapt pretrained foundational VLSMs for domain-specific segmentation tasks, with potential applications in clinical settings for medical image segmentation.</p>
</div>
<section class="ltx_subsubsection" id="S9.SS0.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">9.0.1 </span>Acknowledgements</h4>
<div class="ltx_para" id="S9.SS0.SSS1.p1">
<p class="ltx_p" id="S9.SS0.SSS1.p1.1">We would like to thank SUNY Korea for providing us with the computational resources required for this research project.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Akiba, T., Sano, S., Yanase, T., Ohta, T., Koyama, M.: Optuna: A next-generation hyperparameter optimization framework. In: Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery &amp; data mining. pp. 2623–2631 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Al-Dhabyani, W., Gomaa, M., Khaled, H., Fahmy, A.: Dataset of breast ultrasound images. Data in brief <span class="ltx_text ltx_font_bold" id="bib.bib2.1.1">28</span>, 104863 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
An, N.S., Lan, P.N., Hang, D.V., Long, D.V., Trung, T.Q., Thuy, N.T., Sang, D.V.: BlazeNeo: Blazing fast polyp segmentation and neoplasm detection. IEEE Access <span class="ltx_text ltx_font_bold" id="bib.bib3.1.1">10</span>, 43669–43684 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Ba, J.L., Kiros, J.R., Hinton, G.E.: Layer normalization. arXiv preprint arXiv:1607.06450 (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Bernal, J., Sánchez, F.J., Fernández-Esparrach, G., Gil, D., Rodríguez, C., Vilariño, F.: Wm-dova maps for accurate polyp highlighting in colonoscopy: Validation vs. saliency maps from physicians. Computerized Medical Imaging and Graphics <span class="ltx_text ltx_font_bold" id="bib.bib5.1.1">43</span>, 99–111 (2015)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Bordes, F., Pang, R.Y., Ajay, A., Li, A.C., Bardes, A., Petryk, S., Mañas, O., Lin, Z., Mahmoud, A., Jayaraman, B., et al.: An introduction to vision-language modeling. arXiv preprint arXiv:2405.17247 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Buslaev, A., Iglovikov, V.I., Khvedchenya, E., Parinov, A., Druzhinin, M., Kalinin, A.A.: Albumentations: fast and flexible image augmentations. Information <span class="ltx_text ltx_font_bold" id="bib.bib7.1.1">11</span>(2),  125 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Chen, Y.C., Li, L., Yu, L., El Kholy, A., Ahmed, F., Gan, Z., Cheng, Y., Liu, J.: UNITER: Universal image-text representation learning. In: European conference on computer vision. pp. 104–120. Springer (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Cordts, M., Omran, M., Ramos, S., Rehfeld, T., Enzweiler, M., Benenson, R., Franke, U., Roth, S., Schiele, B.: The cityscapes dataset for semantic urban scene understanding. In: Proceedings of the IEEE conference on computer vision and pattern recognition. pp. 3213–3223 (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Deng, J., Dong, W., Socher, R., Li, L.J., Li, K., Fei-Fei, L.: Imagenet: A large-scale hierarchical image database. In: 2009 IEEE Conference on Computer Vision and Pattern Recognition. pp. 248–255. IEEE (2009)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X., Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., et al.: An image is worth 16x16 words: Transformers for image recognition at scale. In: International Conference on Learning Representations (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Everingham, M., Winn, J.: The pascal visual object classes challenge 2012 (voc2012) development kit. Pattern Anal. Stat. Model. Comput. Learn., Tech. Rep <span class="ltx_text ltx_font_bold" id="bib.bib12.1.1">2007</span>(1-45),  5 (2012)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Goyal, S., Kumar, A., Garg, S., Kolter, Z., Raghunathan, A.: Finetune like you pretrain: Improved finetuning of zero-shot vision models. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 19338–19347 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Gutman, D., Codella, N.C., Celebi, E., Helba, B., Marchetti, M., Mishra, N., Halpern, A.: Skin Lesion Analysis toward Melanoma Detection: A Challenge at ISBI 2016, hosted by ISIC. arXiv preprint arXiv:1605.01397 (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., Sun, J.: Deep residual learning for image recognition. In: Proceedings of the IEEE conference on computer vision and pattern recognition. pp. 770–778 (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
He, T., Zhang, Z., Zhang, H., Zhang, Z., Xie, J., Li, M.: Bag of tricks for image classification with convolutional neural networks. In: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. pp. 558–567 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jha, D., Smedsrud, P.H., Riegler, M.A., Halvorsen, P., de Lange, T., Johansen, D., Johansen, H.D.: Kvasir-SEG: A segmented polyp dataset. In: MultiMedia Modeling. pp. 451–462. Springer (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Jia, C., Yang, Y., Xia, Y., Chen, Y.T., Parekh, Z., Pham, H., Le, Q., Sung, Y.H., Li, Z., Duerig, T.: Scaling up visual and vision-language representation learning with noisy text supervision. In: International conference on machine learning. pp. 4904–4916. PMLR (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Jia, M., Tang, L., Chen, B.C., Cardie, C., Belongie, S., Hariharan, B., Lim, S.N.: Visual prompt tuning. In: European Conference on Computer Vision. pp. 709–727. Springer (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Jiang, Z., Xu, F.F., Araki, J., Neubig, G.: How can we know what language models know? Transactions of the Association for Computational Linguistics <span class="ltx_text ltx_font_bold" id="bib.bib20.1.1">8</span>, 423–438 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Jin, W., Cheng, Y., Shen, Y., Chen, W., Ren, X.: A good prompt is worth millions of parameters: Low-resource prompt-based learning for vision-language models. In: Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers). pp. 2763–2775 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Kendrick, C., Cassidy, B., Pappachan, J.M., O’Shea, C., Fernandez, C.J., Chacko, E., Jacob, K., Reeves, N.D., Yap, M.H.: Translating clinical delineation of diabetic foot ulcers into machine-interpretable segmentation. arXiv preprint arXiv:2204.11618 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Khattak, M.U., Rasheed, H., Maaz, M., Khan, S., Khan, F.S.: Maple: Multi-modal prompt learning. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 19113–19122 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Kwon, G., Cai, Z., Ravichandran, A., Bas, E., Bhotika, R., Soatto, S.: Masked vision and language modeling for multi-modal representation learning. In: The Eleventh International Conference on Learning Representations (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Leclerc, S., Smistad, E., Pedrosa, J., Østvik, A., Cervenansky, F., Espinosa, F., Espeland, T., Berg, E.A.R., Jodoin, P.M., Grenier, T., et al.: Deep learning for segmentation using an open large-scale dataset in 2d echocardiography. IEEE Transactions on medical imaging <span class="ltx_text ltx_font_bold" id="bib.bib25.1.1">38</span>(9), 2198–2210 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Lester, B., Al-Rfou, R., Constant, N.: The power of scale for parameter-efficient prompt tuning. In: Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing. pp. 3045–3059 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Li, X.L., Liang, P.: Prefix-tuning: Optimizing continuous prompts for generation. In: Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing (Volume 1: Long Papers). pp. 4582–4597 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Li, Y., Liang, F., Zhao, L., Cui, Y., Ouyang, W., Shao, J., Yu, F., Yan, J.: Supervision exists everywhere: A data efficient contrastive language-image pre-training paradigm. In: International Conference on Learning Representations (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Liu, P., Yuan, W., Fu, J., Jiang, Z., Hayashi, H., Neubig, G.: Pre-train, prompt, and predict: A systematic survey of prompting methods in natural language processing. ACM Computing Surveys <span class="ltx_text ltx_font_bold" id="bib.bib29.1.1">55</span>(9), 1–35 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Liu, X., Ji, K., Fu, Y., Tam, W., Du, Z., Yang, Z., Tang, J.: P-tuning: Prompt tuning can be comparable to fine-tuning across scales and tasks. In: Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 2: Short Papers). pp. 61–68 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Loshchilov, I., Hutter, F.: Decoupled weight decay regularization. In: International Conference on Learning Representations (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Lüddecke, T., Ecker, A.: Image segmentation using text and image prompts. In: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. pp. 7086–7096 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Van der Maaten, L., Hinton, G.: Visualizing data using t-sne. Journal of machine learning research <span class="ltx_text ltx_font_bold" id="bib.bib33.1.1">9</span>(11) (2008)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Milletari, F., Navab, N., Ahmadi, S.A.: V-net: Fully convolutional neural networks for volumetric medical image segmentation. In: 2016 Fourth International Conference on 3D Vision (3DV). pp. 565–571. IEEE (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Ngoc Lan, P., An, N.S., Hang, D.V., Long, D.V., Trung, T.Q., Thuy, N.T., Sang, D.V.: NeoUNet: Towards accurate colon polyp segmentation and neoplasm detection. In: Advances in Visual Computing. pp. 15–28. Springer (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Poudel, K., Dhakal, M., Bhandari, P., Adhikari, R., Thapaliya, S., Khanal, B.: Exploring transfer learning in medical image segmentation using vision-language models. In: Medical Imaging with Deep Learning (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Radford, A., Kim, J.W., Hallacy, C., Ramesh, A., Goh, G., Agarwal, S., Sastry, G., Askell, A., Mishkin, P., Clark, J., et al.: Learning transferable visual models from natural language supervision. In: International conference on machine learning. pp. 8748–8763. PMLR (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Rao, Y., Zhao, W., Chen, G., Tang, Y., Zhu, Z., Huang, G., Zhou, J., Lu, J.: Denseclip: Language-guided dense prediction with context-aware prompting. In: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. pp. 18082–18091 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Rombach, R., Blattmann, A., Lorenz, D., Esser, P., Ommer, B.: High-resolution image synthesis with latent diffusion models. In: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. pp. 10684–10695 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Saporta, A., Gui, X., Agrawal, A., Pareek, A., Truong, S.Q., Nguyen, C.D., Ngo, V.D., Seekins, J., Blankenberg, F.G., Ng, A.Y., et al.: Benchmarking saliency methods for chest x-ray interpretation. Nature Machine Intelligence <span class="ltx_text ltx_font_bold" id="bib.bib40.1.1">4</span>(10), 867–878 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Shin, T., Razeghi, Y., Logan IV, R.L., Wallace, E., Singh, S.: Autoprompt: Eliciting knowledge from language models with automatically generated prompts. In: Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing (EMNLP). pp. 4222–4235 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Shrestha, P., Amgain, S., Khanal, B., Linte, C.A., Bhattarai, B.: Medical vision language pretraining: A survey. arXiv preprint arXiv:2312.06224 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Singh, A., Hu, R., Goswami, V., Couairon, G., Galuba, W., Rohrbach, M., Kiela, D.: Flava: A foundational language and vision alignment model. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 15638–15650 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Tsimpoukelli, M., Menick, J.L., Cabi, S., Eslami, S., Vinyals, O., Hill, F.: Multimodal few-shot learning with frozen language models. Advances in Neural Information Processing Systems <span class="ltx_text ltx_font_bold" id="bib.bib44.1.1">34</span>, 200–212 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Wang, Z., Lu, Y., Li, Q., Tao, X., Guo, Y., Gong, M., Liu, T.: Cris: Clip-driven referring image segmentation. In: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. pp. 11686–11695 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Wang, Z., Zhang, Z., Ebrahimi, S., Sun, R., Zhang, H., Lee, C.Y., Ren, X., Su, G., Perot, V., Dy, J., et al.: Dualprompt: Complementary prompting for rehearsal-free continual learning. In: European Conference on Computer Vision. pp. 631–648. Springer (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Wang, Z., Zhang, Z., Lee, C.Y., Zhang, H., Sun, R., Ren, X., Su, G., Perot, V., Dy, J., Pfister, T.: Learning to prompt for continual learning. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 139–149 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Watanabe, S.: Tree-structured parzen estimator: Understanding its algorithm components and their roles for better empirical performance. arXiv preprint arXiv:2304.11127 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Wu, C.E., Tian, Y., Yu, H., Wang, H., Morgado, P., Hu, Y.H., Yang, L.: Why is prompt tuning for vision-language models robust to noisy labels? In: Proceedings of the IEEE/CVF International Conference on Computer Vision. pp. 15488–15497 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Wu, C., Lin, Z., Cohen, S., Bui, T., Maji, S.: Phrasecut: Language-based image segmentation in the wild. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 10216–10225 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Yao, Y., Zhang, A., Zhang, Z., Liu, Z., Chua, T.S., Sun, M.: CPT: Colorful prompt tuning for pre-trained vision-language models. AI Open <span class="ltx_text ltx_font_bold" id="bib.bib51.1.1">5</span>, 30–38 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Yu, J., Wang, Z., Vasudevan, V., Yeung, L., Seyedhosseini, M., Wu, Y.: CoCa: Contrastive captioners are image-text foundation models. Transactions on Machine Learning Research (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Zang, Y., Li, W., Zhou, K., Huang, C., Loy, C.C.: Unified vision and language prompt learning. arXiv preprint arXiv:2210.07225 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Zhai, X., Mustafa, B., Kolesnikov, A., Beyer, L.: Sigmoid loss for language image pre-training. In: Proceedings of the IEEE/CVF International Conference on Computer Vision. pp. 11975–11986 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Zhai, X., Wang, X., Mustafa, B., Steiner, A., Keysers, D., Kolesnikov, A., Beyer, L.: Lit: Zero-shot transfer with locked-image text tuning. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 18123–18133 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Zhang, Y., Shen, Z., Jiao, R.: Segment anything model for medical image segmentation: Current applications and future directions. Computers in Biology and Medicine p. 108238 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Zhang, Y., Zhou, K., Liu, Z.: Neural prompt search. arXiv preprint arXiv:2206.04673 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Zhang, Y., Jiang, H., Miura, Y., Manning, C.D., Langlotz, C.P.: Contrastive learning of medical visual representations from paired images and text. In: Machine Learning for Healthcare Conference. pp. 2–25. PMLR (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Zhao, Z., Liu, Y., Wu, H., Li, Y., Wang, S., Teng, L., Liu, D., Li, X., Cui, Z., Wang, Q., et al.: Clip in medical imaging: A comprehensive survey. arXiv preprint arXiv:2312.07353 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Zhong, Z., Friedman, D., Chen, D.: Factual probing is [mask]: Learning vs. learning to recall. In: Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies. pp. 5017–5033 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
Zhou, K., Yang, J., Loy, C.C., Liu, Z.: Conditional prompt learning for vision-language models. In: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. pp. 16816–16825 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Zhou, K., Yang, J., Loy, C.C., Liu, Z.: Learning to prompt for vision-language models. International Journal of Computer Vision <span class="ltx_text ltx_font_bold" id="bib.bib62.1.1">130</span>(9), 2337–2348 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
Zhou, Z., Lei, Y., Zhang, B., Liu, L., Liu, Y.: ZegCLIP: Towards adapting clip for zero-shot semantic segmentation. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 11175–11185 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
Zhu, B., Niu, Y., Han, Y., Wu, Y., Zhang, H.: Prompt-aligned gradient for prompt tuning. In: Proceedings of the IEEE/CVF International Conference on Computer Vision. pp. 15659–15669 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
Zhu, D., Chen, J., Shen, X., Li, X., Elhoseiny, M.: MiniGPT-4: Enhancing vision-language understanding with advanced large language models. In: The Twelfth International Conference on Learning Representations (2024)

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="Pt0.A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.A </span>How does prompt depth affect Dice Score?</h2>
<div class="ltx_para" id="Pt0.A1.p1">
<p class="ltx_p" id="Pt0.A1.p1.1">The scatter plot of test dice vs the prompt depth is shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#Pt0.A1.F6" title="In Appendix 0.A How does prompt depth affect Dice Score? ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>.
We have also fitted a linear regression for the data and have shown <math alttext="R^{2}" class="ltx_Math" display="inline" id="Pt0.A1.p1.1.m1.1"><semantics id="Pt0.A1.p1.1.m1.1a"><msup id="Pt0.A1.p1.1.m1.1.1" xref="Pt0.A1.p1.1.m1.1.1.cmml"><mi id="Pt0.A1.p1.1.m1.1.1.2" xref="Pt0.A1.p1.1.m1.1.1.2.cmml">R</mi><mn id="Pt0.A1.p1.1.m1.1.1.3" xref="Pt0.A1.p1.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="Pt0.A1.p1.1.m1.1b"><apply id="Pt0.A1.p1.1.m1.1.1.cmml" xref="Pt0.A1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Pt0.A1.p1.1.m1.1.1.1.cmml" xref="Pt0.A1.p1.1.m1.1.1">superscript</csymbol><ci id="Pt0.A1.p1.1.m1.1.1.2.cmml" xref="Pt0.A1.p1.1.m1.1.1.2">𝑅</ci><cn id="Pt0.A1.p1.1.m1.1.1.3.cmml" type="integer" xref="Pt0.A1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A1.p1.1.m1.1c">R^{2}</annotation><annotation encoding="application/x-llamapun" id="Pt0.A1.p1.1.m1.1d">italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> score for each context learner.
There isn’t a strong correlation between test dice and the prompt depth when the dice score, indicating that increasing prompt depth may not always increase the dice score for all the datasets and methods.</p>
</div>
<figure class="ltx_figure" id="Pt0.A1.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A1.F6.sf1"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A1.F6.sf1.g1" src="prompt_depth_coop_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A1.F6.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="Pt0.A1.F6.sf1.3.2" style="font-size:90%;">CoOp CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A1.F6.sf2"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A1.F6.sf2.g1" src="prompt_depth_coop_cris"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A1.F6.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="Pt0.A1.F6.sf2.3.2" style="font-size:90%;">CoOp CRIS</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A1.F6.sf3"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A1.F6.sf3.g1" src="prompt_depth_cocoop_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A1.F6.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="Pt0.A1.F6.sf3.3.2" style="font-size:90%;">CoCoOp CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A1.F6.sf4"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A1.F6.sf4.g1" src="prompt_depth_cocoop_cris"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A1.F6.sf4.2.1.1" style="font-size:90%;">(d)</span> </span><span class="ltx_text" id="Pt0.A1.F6.sf4.3.2" style="font-size:90%;">CoCoOp CRIS</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A1.F6.sf5"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A1.F6.sf5.g1" src="prompt_depth_vpt_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A1.F6.sf5.2.1.1" style="font-size:90%;">(e)</span> </span><span class="ltx_text" id="Pt0.A1.F6.sf5.3.2" style="font-size:90%;">VPT CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A1.F6.sf6"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A1.F6.sf6.g1" src="prompt_depth_shared_attn_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A1.F6.sf6.2.1.1" style="font-size:90%;">(f)</span> </span><span class="ltx_text" id="Pt0.A1.F6.sf6.3.2" style="font-size:90%;">Shared Attention CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A1.F6.sf7"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A1.F6.sf7.g1" src="prompt_depth_shared_separate_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A1.F6.sf7.2.1.1" style="font-size:90%;">(g)</span> </span><span class="ltx_text" id="Pt0.A1.F6.sf7.3.2" style="font-size:90%;">Shared Separate CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A1.F6.sf8"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A1.F6.sf8.g1" src="prompt_depth_maple_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A1.F6.sf8.2.1.1" style="font-size:90%;">(h)</span> </span><span class="ltx_text" id="Pt0.A1.F6.sf8.3.2" style="font-size:90%;">Maple CLIPSeg</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A1.F6.4.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="Pt0.A1.F6.5.2" style="font-size:90%;">Test Dice <em class="ltx_emph ltx_font_italic" id="Pt0.A1.F6.5.2.1">vs</em>.<span class="ltx_text" id="Pt0.A1.F6.5.2.2"></span> Prompt Depth for Textual Tuning for all Datasets</span></figcaption>
</figure>
</section>
<section class="ltx_appendix" id="Pt0.A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix 0.B </span>How does learning rate and weight decay affect Dice?</h2>
<div class="ltx_para" id="Pt0.A2.p1">
<p class="ltx_p" id="Pt0.A2.p1.1">The scatter plot showing the test dice on different weight decays and learning rates is shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.05239v2#Pt0.A2.F7" title="In Appendix 0.B How does learning rate and weight decay affect Dice? ‣ TuneVLSeg: Prompt Tuning Benchmark for Vision-Language Segmentation Models"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">7</span></a>.
Although there doesn’t seem to be a direct between weight decay and test dice nor learning rate and test dice, a learning rate of around <math alttext="10^{-3}" class="ltx_Math" display="inline" id="Pt0.A2.p1.1.m1.1"><semantics id="Pt0.A2.p1.1.m1.1a"><msup id="Pt0.A2.p1.1.m1.1.1" xref="Pt0.A2.p1.1.m1.1.1.cmml"><mn id="Pt0.A2.p1.1.m1.1.1.2" xref="Pt0.A2.p1.1.m1.1.1.2.cmml">10</mn><mrow id="Pt0.A2.p1.1.m1.1.1.3" xref="Pt0.A2.p1.1.m1.1.1.3.cmml"><mo id="Pt0.A2.p1.1.m1.1.1.3a" xref="Pt0.A2.p1.1.m1.1.1.3.cmml">−</mo><mn id="Pt0.A2.p1.1.m1.1.1.3.2" xref="Pt0.A2.p1.1.m1.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="Pt0.A2.p1.1.m1.1b"><apply id="Pt0.A2.p1.1.m1.1.1.cmml" xref="Pt0.A2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Pt0.A2.p1.1.m1.1.1.1.cmml" xref="Pt0.A2.p1.1.m1.1.1">superscript</csymbol><cn id="Pt0.A2.p1.1.m1.1.1.2.cmml" type="integer" xref="Pt0.A2.p1.1.m1.1.1.2">10</cn><apply id="Pt0.A2.p1.1.m1.1.1.3.cmml" xref="Pt0.A2.p1.1.m1.1.1.3"><minus id="Pt0.A2.p1.1.m1.1.1.3.1.cmml" xref="Pt0.A2.p1.1.m1.1.1.3"></minus><cn id="Pt0.A2.p1.1.m1.1.1.3.2.cmml" type="integer" xref="Pt0.A2.p1.1.m1.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Pt0.A2.p1.1.m1.1c">10^{-3}</annotation><annotation encoding="application/x-llamapun" id="Pt0.A2.p1.1.m1.1d">10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math> seems to be a good starting point to train these context learners.</p>
</div>
<figure class="ltx_figure" id="Pt0.A2.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A2.F7.sf1"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A2.F7.sf1.g1" src="lr_wd_coop_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F7.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="Pt0.A2.F7.sf1.3.2" style="font-size:90%;">CoOp CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A2.F7.sf2"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A2.F7.sf2.g1" src="lr_wd_coop_cris"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F7.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="Pt0.A2.F7.sf2.3.2" style="font-size:90%;">CoOp CRIS</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A2.F7.sf3"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A2.F7.sf3.g1" src="lr_wd_cocoop_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F7.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="Pt0.A2.F7.sf3.3.2" style="font-size:90%;">CoCoOp CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A2.F7.sf4"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A2.F7.sf4.g1" src="lr_wd_cocoop_cris"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F7.sf4.2.1.1" style="font-size:90%;">(d)</span> </span><span class="ltx_text" id="Pt0.A2.F7.sf4.3.2" style="font-size:90%;">CoCoOp CRIS</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A2.F7.sf5"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A2.F7.sf5.g1" src="lr_wd_vpt_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F7.sf5.2.1.1" style="font-size:90%;">(e)</span> </span><span class="ltx_text" id="Pt0.A2.F7.sf5.3.2" style="font-size:90%;">VPT CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A2.F7.sf6"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A2.F7.sf6.g1" src="lr_wd_shared_attn_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F7.sf6.2.1.1" style="font-size:90%;">(f)</span> </span><span class="ltx_text" id="Pt0.A2.F7.sf6.3.2" style="font-size:90%;">Shared Attention CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A2.F7.sf7"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A2.F7.sf7.g1" src="lr_wd_shared_separate_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F7.sf7.2.1.1" style="font-size:90%;">(g)</span> </span><span class="ltx_text" id="Pt0.A2.F7.sf7.3.2" style="font-size:90%;">Shared Separate CLIPSeg</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Pt0.A2.F7.sf8"><img alt="Refer to caption" class="ltx_graphics" id="Pt0.A2.F7.sf8.g1" src="lr_wd_maple_clipseg"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F7.sf8.2.1.1" style="font-size:90%;">(h)</span> </span><span class="ltx_text" id="Pt0.A2.F7.sf8.3.2" style="font-size:90%;">Maple CLIPSeg</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Pt0.A2.F7.6.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="Pt0.A2.F7.7.2" style="font-size:90%;">Test Dice <em class="ltx_emph ltx_font_italic" id="Pt0.A2.F7.7.2.1">vs</em>.<span class="ltx_text" id="Pt0.A2.F7.7.2.2"></span> Learning Rate <em class="ltx_emph ltx_font_italic" id="Pt0.A2.F7.7.2.3">vs</em>.<span class="ltx_text" id="Pt0.A2.F7.7.2.4"></span> Weight Decay for all Datasets</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Oct  8 06:57:35 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
