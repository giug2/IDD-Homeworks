<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2407.20563] Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering</title><meta property="og:description" content="Visual question answering (VQA) is the task of providing accurate answers to natural language questions based on visual input. Programmatic VQA (PVQA) models have been gaining attention recently. These use large langua…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2407.20563">

<!--Generated on Mon Aug  5 13:39:08 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Pyramid Coder: Hierarchical Code Generator for 
<br class="ltx_break">Compositional Visual Question Answering</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Visual question answering (VQA) is the task of providing accurate answers to natural language questions based on visual input. Programmatic VQA (PVQA) models have been gaining attention recently. These use large language models (LLMs) to formulate executable programs that address questions requiring complex visual reasoning.
However, there are challenges in enabling LLMs to comprehend the usage of image processing modules and generate relevant code. To overcome these challenges, this paper introduces PyramidCoder, a novel prompting framework for PVQA models. PyramidCoder consists of three hierarchical levels, each serving a distinct purpose: query rephrasing, code generation, and answer aggregation.
Notably, PyramidCoder utilizes a single frozen LLM and pre-defined prompts at each level, eliminating the need for additional training and ensuring flexibility across various LLM architectures.
Compared to the state-of-the-art PVQA model, our approach improves accuracy by at least 0.5% on the GQA dataset, 1.4% on the VQAv2 dataset, and 2.9% on the NLVR2 dataset.</p>
<p id="id2.id2" class="ltx_p"><span id="id2.id2.1" class="ltx_text ltx_font_bold ltx_font_italic">Index Terms<span id="id2.id2.1.1" class="ltx_text ltx_font_upright">— </span></span>
Visual question answering, Large language models, Code generation, Prompting methods.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual question answering (VQA), which aims to provide accurate answers to natural language questions based on visual input, is a crucial research topic in computer vision and natural language processing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. The last decade has seen significant advances in deep learning applied to VQA, with the development of end-to-end multimodal models such as GLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and PNP-VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. However, despite these advances, compositional VQA, which involves complex spatial relationships and object attributes, remains difficult due to the lack of an explicit understanding of visual elements during the inference process.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To address the difficulties in compositional VQA, recent studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> have proposed models that generate executable programs to answer questions based on given images, questions, and image processing modules. These models, which we refer to as Programmatic VQA (PVQA) models, represent a novel approach to integrating multimodal inputs, leading to more tractable and traceable inference.
Typically, PVQA models consist of three components: a large language model (LLM) for code generation, a set of image processing modules, and a Python executor. The LLM analyzes a given query (text-form question) and generates Python code to answer it using a predefined API set of image processing modules, including both low-level modules such as image cropping and high-level modules such as object detection. The generated code is then executed by the Python executor to produce the answer. This architecture allows questions to be decomposed into manageable segments of code, providing a more precise approach to compositional VQA.
However, enabling the LLM to understand API usage and generate appropriate code for VQA is not always straightforward.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2407.20563/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="388" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>
PyramidCoder is a hierarchical framework comprising three modules. It generates multiple code candidates, maximizing the diversity of solutions available for a given input query to produce the correct answer effectively.
</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To fully leverage the capabilities of LLMs, a number of prompting frameworks have been developed for natural language processing tasks. Chain-of-Thought (CoT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, for example, demonstrates how structured prompts can guide LLMs to decompose complex problems into a series of simpler, linked steps. There are also extensions of CoT such as Tree of Thoughts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, which creates a tree structure of thinking steps. These frameworks not only improve performance, but also provide greater transparency into their reasoning process.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Inspired by these approaches, this paper introduces PyramidCoder, a novel code generation prompting framework for PVQA models.
Previous PVQA models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> employ Input-Output (IO) prompting to generate code from prompt input directly. However, IO prompting constraints a singular solution for a question, resulting in a simplistic and uniform code generation. In contrast, PyramidCoder explores the diversity of question statements and possible solutions through a hierarchical framework consisting of three levels.
As shown in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the first level rephrases a given query into multiple variations. The second level then generates multiple code candidates corresponding to the rephrased queries. Finally, the third level aggregates them and generates the final code and answer for the input query.
All these procedures are implemented with a single frozen LLM and pre-defined prompts at each level, without the need for additional training. In experiments, we substantiate the efficacy of PyramidCoder across GQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, VQAv2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, and NLVR2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> datasets, showing its ability to significantly enhance VQA performance.
In summary, our contribution is three-fold:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We introduce PyramidCoder, a novel code generation framework for PVQA consisting of three modules: a query rephraser, a code generator, and an answer aggregator.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;padding-top:4.0pt;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a prompting method to implement all modules with a single frozen LLM to avoid additional training. This approach offers flexibility and is not constrained by the specific LLM employed.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;padding-top:4.0pt;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We demonstrate the effectiveness of our method over the state-of-the-art CodeVQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> model by conducting experiments on three VQA datasets.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Visual Question Answering</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">VQA is an interdisciplinary research area combining computer vision and natural language processing. It aims to develop AI systems that respond to queries about images by integrating multimodal information. Early VQA models relied on convolutional neural networks to extract image features and recurrent neural networks to process textual inputs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. The introduction of attention mechanisms
 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> has since improved these models’ capacity to handle complex questions and comprehend fine-grained image details. Recently, multimodal pretaining approaches
 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> have been employed, leveraging large-scale pretraining on both image and text data to capture richer contextual information.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">However, fine-tuning multimodal pre-trained models for VQA requires substantial expertise, vast amounts of data, and significant computational resources.
PVQA models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> address these issues by utilizing an LLM to generate a Python-like code, which is then executed with predefined APIs to find answers to questions.
These models can quickly adapt to new tasks or domains with minimal data, without the need for additional training or fine-tuning.
Despite these advantages, PVQA models using IO prompting display a level of simplicity that hampers the effective utilization of LLM capabilities. Consequently, methods for activating the latent potential of LLMs and guiding them towards optimal API utilization remain an underexplored domain.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Large Language Models</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p"><span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_bold">Code Generation Models.</span>
Large language models have demonstrated remarkable capabilities in a wide range of natural language processing tasks. While general LLMs find application in various tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, a subset of these models has been specifically tailored for code generation. This specialized category of LLMs undergoes training on extensive corpora of programming-related text, enabling them to comprehend and generate code in response to natural language descriptions. Codex <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, an extension of the GPT-3 series, demonstrates proficiency in over a dozen languages.
StarCoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, as one of the pioneering open-source Code LLMs, undergoes training on datasets sourced from Github licensed data, covering over 80 programming languages. CodeLlama <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, fine-tuned from Llama2 with a higher sampling of code, augments support for larger input contexts and zero-shot instruction following ability. Noteworthy among recent developments are native multimodality LLMs such as Gemini <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. These models leverage multimodal data (i.e., text, images, and code) throughout the entirety of the training process to enhance their proficiency in generating code that meets specific requirements.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.1" class="ltx_p"><span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_bold">Prompting.</span>
Prompting methods are employed to optimize prompts for LLMs in order to maximize their capacity. Chain-of-Thought (CoT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> guides LLMs in generating intermediate reasoning steps before predicting the answer. This method has inspired several extensions.
Notably, Self-consistency <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> samples from the LLM decoder multiple times and aggregates the final answer through majority voting. AutoCoT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> automatically constructs demonstrations through question clustering and zero-shot CoT reasoning chain generation. ReAct <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> alternately generates thoughts and actions, performs the action based on the thought, and adjusts the thought based on the action result. Similar to CoT prompting and its variations, Tree of Thoughts (ToT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> decomposes problems into smaller thoughts and explores multiple solution paths in parallel, forming a tree structure of thoughts.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2407.20563/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="143" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.27.1.1" class="ltx_text ltx_font_bold">Fig. 2</span>: </span><span id="S2.F2.28.2" class="ltx_text ltx_font_bold">Framework overview.</span>
(a) PyramidCoder <math id="S2.F2.13.m1.1" class="ltx_Math" alttext="\Pi" display="inline"><semantics id="S2.F2.13.m1.1b"><mi mathvariant="normal" id="S2.F2.13.m1.1.1" xref="S2.F2.13.m1.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="S2.F2.13.m1.1c"><ci id="S2.F2.13.m1.1.1.cmml" xref="S2.F2.13.m1.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.13.m1.1d">\Pi</annotation></semantics></math> takes an image <math id="S2.F2.14.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.F2.14.m2.1b"><mi id="S2.F2.14.m2.1.1" xref="S2.F2.14.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.F2.14.m2.1c"><ci id="S2.F2.14.m2.1.1.cmml" xref="S2.F2.14.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.14.m2.1d">x</annotation></semantics></math> and a query <math id="S2.F2.15.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S2.F2.15.m3.1b"><mi id="S2.F2.15.m3.1.1" xref="S2.F2.15.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.F2.15.m3.1c"><ci id="S2.F2.15.m3.1.1.cmml" xref="S2.F2.15.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.15.m3.1d">q</annotation></semantics></math> as input, producing both the code and answer for the input image-query pair. (b) PyramidCoder contains three modules: a query rephraser <math id="S2.F2.16.m4.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S2.F2.16.m4.1b"><mi id="S2.F2.16.m4.1.1" xref="S2.F2.16.m4.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S2.F2.16.m4.1c"><ci id="S2.F2.16.m4.1.1.cmml" xref="S2.F2.16.m4.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.16.m4.1d">R</annotation></semantics></math>, a code generator <math id="S2.F2.17.m5.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S2.F2.17.m5.1b"><mi id="S2.F2.17.m5.1.1" xref="S2.F2.17.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S2.F2.17.m5.1c"><ci id="S2.F2.17.m5.1.1.cmml" xref="S2.F2.17.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.17.m5.1d">G</annotation></semantics></math>, and an answer aggregator <math id="S2.F2.18.m6.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S2.F2.18.m6.1b"><mi id="S2.F2.18.m6.1.1" xref="S2.F2.18.m6.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S2.F2.18.m6.1c"><ci id="S2.F2.18.m6.1.1.cmml" xref="S2.F2.18.m6.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.18.m6.1d">A</annotation></semantics></math>. Image processing APIs are also used in the code-executing process. (c) For each input query, the PyramidCoder generates diverse expressions <math id="S2.F2.19.m7.1" class="ltx_Math" alttext="r_{i}" display="inline"><semantics id="S2.F2.19.m7.1b"><msub id="S2.F2.19.m7.1.1" xref="S2.F2.19.m7.1.1.cmml"><mi id="S2.F2.19.m7.1.1.2" xref="S2.F2.19.m7.1.1.2.cmml">r</mi><mi id="S2.F2.19.m7.1.1.3" xref="S2.F2.19.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.19.m7.1c"><apply id="S2.F2.19.m7.1.1.cmml" xref="S2.F2.19.m7.1.1"><csymbol cd="ambiguous" id="S2.F2.19.m7.1.1.1.cmml" xref="S2.F2.19.m7.1.1">subscript</csymbol><ci id="S2.F2.19.m7.1.1.2.cmml" xref="S2.F2.19.m7.1.1.2">𝑟</ci><ci id="S2.F2.19.m7.1.1.3.cmml" xref="S2.F2.19.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.19.m7.1d">r_{i}</annotation></semantics></math> of the input query and multiple code candidates <math id="S2.F2.20.m8.1" class="ltx_Math" alttext="z_{ij}" display="inline"><semantics id="S2.F2.20.m8.1b"><msub id="S2.F2.20.m8.1.1" xref="S2.F2.20.m8.1.1.cmml"><mi id="S2.F2.20.m8.1.1.2" xref="S2.F2.20.m8.1.1.2.cmml">z</mi><mrow id="S2.F2.20.m8.1.1.3" xref="S2.F2.20.m8.1.1.3.cmml"><mi id="S2.F2.20.m8.1.1.3.2" xref="S2.F2.20.m8.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.F2.20.m8.1.1.3.1" xref="S2.F2.20.m8.1.1.3.1.cmml">​</mo><mi id="S2.F2.20.m8.1.1.3.3" xref="S2.F2.20.m8.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.F2.20.m8.1c"><apply id="S2.F2.20.m8.1.1.cmml" xref="S2.F2.20.m8.1.1"><csymbol cd="ambiguous" id="S2.F2.20.m8.1.1.1.cmml" xref="S2.F2.20.m8.1.1">subscript</csymbol><ci id="S2.F2.20.m8.1.1.2.cmml" xref="S2.F2.20.m8.1.1.2">𝑧</ci><apply id="S2.F2.20.m8.1.1.3.cmml" xref="S2.F2.20.m8.1.1.3"><times id="S2.F2.20.m8.1.1.3.1.cmml" xref="S2.F2.20.m8.1.1.3.1"></times><ci id="S2.F2.20.m8.1.1.3.2.cmml" xref="S2.F2.20.m8.1.1.3.2">𝑖</ci><ci id="S2.F2.20.m8.1.1.3.3.cmml" xref="S2.F2.20.m8.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.20.m8.1d">z_{ij}</annotation></semantics></math>, each representing a distinct solution to the given query. Finally, these codes <math id="S2.F2.21.m9.1" class="ltx_Math" alttext="z_{ij}" display="inline"><semantics id="S2.F2.21.m9.1b"><msub id="S2.F2.21.m9.1.1" xref="S2.F2.21.m9.1.1.cmml"><mi id="S2.F2.21.m9.1.1.2" xref="S2.F2.21.m9.1.1.2.cmml">z</mi><mrow id="S2.F2.21.m9.1.1.3" xref="S2.F2.21.m9.1.1.3.cmml"><mi id="S2.F2.21.m9.1.1.3.2" xref="S2.F2.21.m9.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.F2.21.m9.1.1.3.1" xref="S2.F2.21.m9.1.1.3.1.cmml">​</mo><mi id="S2.F2.21.m9.1.1.3.3" xref="S2.F2.21.m9.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.F2.21.m9.1c"><apply id="S2.F2.21.m9.1.1.cmml" xref="S2.F2.21.m9.1.1"><csymbol cd="ambiguous" id="S2.F2.21.m9.1.1.1.cmml" xref="S2.F2.21.m9.1.1">subscript</csymbol><ci id="S2.F2.21.m9.1.1.2.cmml" xref="S2.F2.21.m9.1.1.2">𝑧</ci><apply id="S2.F2.21.m9.1.1.3.cmml" xref="S2.F2.21.m9.1.1.3"><times id="S2.F2.21.m9.1.1.3.1.cmml" xref="S2.F2.21.m9.1.1.3.1"></times><ci id="S2.F2.21.m9.1.1.3.2.cmml" xref="S2.F2.21.m9.1.1.3.2">𝑖</ci><ci id="S2.F2.21.m9.1.1.3.3.cmml" xref="S2.F2.21.m9.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.21.m9.1d">z_{ij}</annotation></semantics></math> and their corresponding pre-execution results <math id="S2.F2.22.m10.1" class="ltx_Math" alttext="a_{ij}" display="inline"><semantics id="S2.F2.22.m10.1b"><msub id="S2.F2.22.m10.1.1" xref="S2.F2.22.m10.1.1.cmml"><mi id="S2.F2.22.m10.1.1.2" xref="S2.F2.22.m10.1.1.2.cmml">a</mi><mrow id="S2.F2.22.m10.1.1.3" xref="S2.F2.22.m10.1.1.3.cmml"><mi id="S2.F2.22.m10.1.1.3.2" xref="S2.F2.22.m10.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.F2.22.m10.1.1.3.1" xref="S2.F2.22.m10.1.1.3.1.cmml">​</mo><mi id="S2.F2.22.m10.1.1.3.3" xref="S2.F2.22.m10.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.F2.22.m10.1c"><apply id="S2.F2.22.m10.1.1.cmml" xref="S2.F2.22.m10.1.1"><csymbol cd="ambiguous" id="S2.F2.22.m10.1.1.1.cmml" xref="S2.F2.22.m10.1.1">subscript</csymbol><ci id="S2.F2.22.m10.1.1.2.cmml" xref="S2.F2.22.m10.1.1.2">𝑎</ci><apply id="S2.F2.22.m10.1.1.3.cmml" xref="S2.F2.22.m10.1.1.3"><times id="S2.F2.22.m10.1.1.3.1.cmml" xref="S2.F2.22.m10.1.1.3.1"></times><ci id="S2.F2.22.m10.1.1.3.2.cmml" xref="S2.F2.22.m10.1.1.3.2">𝑖</ci><ci id="S2.F2.22.m10.1.1.3.3.cmml" xref="S2.F2.22.m10.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.22.m10.1d">a_{ij}</annotation></semantics></math> are aggregated to derive the final answer <math id="S2.F2.23.m11.1" class="ltx_Math" alttext="\hat{a}" display="inline"><semantics id="S2.F2.23.m11.1b"><mover accent="true" id="S2.F2.23.m11.1.1" xref="S2.F2.23.m11.1.1.cmml"><mi id="S2.F2.23.m11.1.1.2" xref="S2.F2.23.m11.1.1.2.cmml">a</mi><mo id="S2.F2.23.m11.1.1.1" xref="S2.F2.23.m11.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.F2.23.m11.1c"><apply id="S2.F2.23.m11.1.1.cmml" xref="S2.F2.23.m11.1.1"><ci id="S2.F2.23.m11.1.1.1.cmml" xref="S2.F2.23.m11.1.1.1">^</ci><ci id="S2.F2.23.m11.1.1.2.cmml" xref="S2.F2.23.m11.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.23.m11.1d">\hat{a}</annotation></semantics></math> and the accompanying interpretable code <math id="S2.F2.24.m12.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.F2.24.m12.1b"><mi id="S2.F2.24.m12.1.1" xref="S2.F2.24.m12.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.F2.24.m12.1c"><ci id="S2.F2.24.m12.1.1.cmml" xref="S2.F2.24.m12.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.24.m12.1d">z</annotation></semantics></math>.
</figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.3" class="ltx_p">This section introduces PyramidCoder, a hierarchical code generation framework for PVQA. As shown in Figure <a href="#S2.F2" title="Figure 2 ‣ 2.2 Large Language Models ‣ 2 Related work ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, PyramidCoder generates a Python code to answer a question given a query, an image, and a set of pre-defined APIs for simple processing tasks. The framework consists of three modules: a query rephraser <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">R</annotation></semantics></math>, a code generator <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">G</annotation></semantics></math>, and an answer aggregator <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">A</annotation></semantics></math>. These three modules are implemented with a single frozen LLM and work in conjunction to enhance the quality of code generation within the pyramid structure.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overall Framework</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.13" class="ltx_p"><span id="S3.SS1.p1.13.1" class="ltx_text ltx_font_bold">Problem setting.</span>
We follow the notation used in previous studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.
Let <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="x\in\mathcal{X}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">x</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑥</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">x\in\mathcal{X}</annotation></semantics></math> be an input image and <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="q\in\mathcal{Q}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">q</mi><mo id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">𝒬</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><in id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></in><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑞</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝒬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">q\in\mathcal{Q}</annotation></semantics></math> be a textual query, where <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{X}</annotation></semantics></math> is a set of images and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{Q}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{Q}</annotation></semantics></math> is a set of textual queries.
The goal is to generate a code <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="z\in\mathcal{Z}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">z</mi><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">𝒵</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><in id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></in><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑧</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">z\in\mathcal{Z}</annotation></semantics></math> that returns the answer <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="a\in\mathcal{A}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">a</mi><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><in id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></in><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑎</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">a\in\mathcal{A}</annotation></semantics></math> to the query given the image, where <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathcal{Z}</annotation></semantics></math> is a set of executable codes and <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">\mathcal{A}</annotation></semantics></math> is a set of answers. This study assumes that <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\mathcal{Z}</annotation></semantics></math> is a set of Python codes. Note that the three sets <math id="S3.SS1.p1.10.m10.2" class="ltx_Math" alttext="\mathcal{Q},\mathcal{Z}" display="inline"><semantics id="S3.SS1.p1.10.m10.2a"><mrow id="S3.SS1.p1.10.m10.2.3.2" xref="S3.SS1.p1.10.m10.2.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">𝒬</mi><mo id="S3.SS1.p1.10.m10.2.3.2.1" xref="S3.SS1.p1.10.m10.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m10.2.2" xref="S3.SS1.p1.10.m10.2.2.cmml">𝒵</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.2b"><list id="S3.SS1.p1.10.m10.2.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.2"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝒬</ci><ci id="S3.SS1.p1.10.m10.2.2.cmml" xref="S3.SS1.p1.10.m10.2.2">𝒵</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.2c">\mathcal{Q},\mathcal{Z}</annotation></semantics></math> and <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">\mathcal{A}</annotation></semantics></math> are subsets of the whole set of texts, which we denote as <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{T}" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\mathcal{T}</annotation></semantics></math>. We use a frozen LLM <math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="\pi:\mathcal{T}\to\mathcal{T}" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><mrow id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">π</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p1.13.m13.1.1.1" xref="S3.SS1.p1.13.m13.1.1.1.cmml">:</mo><mrow id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m13.1.1.3.2" xref="S3.SS1.p1.13.m13.1.1.3.2.cmml">𝒯</mi><mo stretchy="false" id="S3.SS1.p1.13.m13.1.1.3.1" xref="S3.SS1.p1.13.m13.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m13.1.1.3.3" xref="S3.SS1.p1.13.m13.1.1.3.3.cmml">𝒯</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><ci id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1">:</ci><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝜋</ci><apply id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3"><ci id="S3.SS1.p1.13.m13.1.1.3.1.cmml" xref="S3.SS1.p1.13.m13.1.1.3.1">→</ci><ci id="S3.SS1.p1.13.m13.1.1.3.2.cmml" xref="S3.SS1.p1.13.m13.1.1.3.2">𝒯</ci><ci id="S3.SS1.p1.13.m13.1.1.3.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3.3">𝒯</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">\pi:\mathcal{T}\to\mathcal{T}</annotation></semantics></math> to find mappings between these subsets.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.5" class="ltx_p"><span id="S3.SS1.p2.5.1" class="ltx_text ltx_font_bold">Framework.</span>
The PyramidCoder framework consists of two stages: the coding stage and the execution stage.
The coding stage generates a code as</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\displaystyle z=\Pi(q,x)," display="inline"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">z</mi><mo id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mi mathvariant="normal" id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.3.1" xref="S3.E1.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.3.2.1" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">q</mi><mo id="S3.E1.m1.3.3.1.1.3.3.2.2" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">x</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.3.2.3" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"></eq><ci id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2">𝑧</ci><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><times id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1"></times><ci id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2">Π</ci><interval closure="open" id="S3.E1.m1.3.3.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑞</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑥</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\displaystyle z=\Pi(q,x),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.1" class="ltx_p">where
<math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\Pi:\mathcal{Q}\times\mathcal{X}\to\mathcal{Z}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">Π</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mrow id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1.3.2.2" xref="S3.SS1.p2.1.m1.1.1.3.2.2.cmml">𝒬</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.1.m1.1.1.3.2.1" xref="S3.SS1.p2.1.m1.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1.3.2.3" xref="S3.SS1.p2.1.m1.1.1.3.2.3.cmml">𝒳</mi></mrow><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">𝒵</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><ci id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1">:</ci><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">Π</ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><ci id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.1">→</ci><apply id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2"><times id="S3.SS1.p2.1.m1.1.1.3.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2.1"></times><ci id="S3.SS1.p2.1.m1.1.1.3.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2.2">𝒬</ci><ci id="S3.SS1.p2.1.m1.1.1.3.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2.3">𝒳</ci></apply><ci id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3">𝒵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\Pi:\mathcal{Q}\times\mathcal{X}\to\mathcal{Z}</annotation></semantics></math>
is the code generation process.
In the execution stage, the generated code is executed with the input image to obtain an answer as</p>
<table id="S6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.3" class="ltx_Math" alttext="\displaystyle a=\Lambda(x,z)," display="inline"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml">a</mi><mo id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml">Λ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.3.3.2.1" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">x</mi><mo id="S3.E2.m1.3.3.1.1.3.3.2.2" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">z</mi><mo stretchy="false" id="S3.E2.m1.3.3.1.1.3.3.2.3" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"></eq><ci id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2">𝑎</ci><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><times id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"></times><ci id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2">Λ</ci><interval closure="open" id="S3.E2.m1.3.3.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑥</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑧</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\displaystyle a=\Lambda(x,z),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.4" class="ltx_p">where <math id="S3.SS1.p2.2.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.SS1.p2.2.m1.1a"><mi id="S3.SS1.p2.2.m1.1.1" xref="S3.SS1.p2.2.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m1.1b"><ci id="S3.SS1.p2.2.m1.1.1.cmml" xref="S3.SS1.p2.2.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m1.1c">a</annotation></semantics></math> is the predicted answer and <math id="S3.SS1.p2.3.m2.1" class="ltx_Math" alttext="\Lambda:\mathcal{X}\times\mathcal{Z}\to\mathcal{A}" display="inline"><semantics id="S3.SS1.p2.3.m2.1a"><mrow id="S3.SS1.p2.3.m2.1.1" xref="S3.SS1.p2.3.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p2.3.m2.1.1.2" xref="S3.SS1.p2.3.m2.1.1.2.cmml">Λ</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.3.m2.1.1.1" xref="S3.SS1.p2.3.m2.1.1.1.cmml">:</mo><mrow id="S3.SS1.p2.3.m2.1.1.3" xref="S3.SS1.p2.3.m2.1.1.3.cmml"><mrow id="S3.SS1.p2.3.m2.1.1.3.2" xref="S3.SS1.p2.3.m2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m2.1.1.3.2.2" xref="S3.SS1.p2.3.m2.1.1.3.2.2.cmml">𝒳</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.3.m2.1.1.3.2.1" xref="S3.SS1.p2.3.m2.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m2.1.1.3.2.3" xref="S3.SS1.p2.3.m2.1.1.3.2.3.cmml">𝒵</mi></mrow><mo stretchy="false" id="S3.SS1.p2.3.m2.1.1.3.1" xref="S3.SS1.p2.3.m2.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m2.1.1.3.3" xref="S3.SS1.p2.3.m2.1.1.3.3.cmml">𝒜</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m2.1b"><apply id="S3.SS1.p2.3.m2.1.1.cmml" xref="S3.SS1.p2.3.m2.1.1"><ci id="S3.SS1.p2.3.m2.1.1.1.cmml" xref="S3.SS1.p2.3.m2.1.1.1">:</ci><ci id="S3.SS1.p2.3.m2.1.1.2.cmml" xref="S3.SS1.p2.3.m2.1.1.2">Λ</ci><apply id="S3.SS1.p2.3.m2.1.1.3.cmml" xref="S3.SS1.p2.3.m2.1.1.3"><ci id="S3.SS1.p2.3.m2.1.1.3.1.cmml" xref="S3.SS1.p2.3.m2.1.1.3.1">→</ci><apply id="S3.SS1.p2.3.m2.1.1.3.2.cmml" xref="S3.SS1.p2.3.m2.1.1.3.2"><times id="S3.SS1.p2.3.m2.1.1.3.2.1.cmml" xref="S3.SS1.p2.3.m2.1.1.3.2.1"></times><ci id="S3.SS1.p2.3.m2.1.1.3.2.2.cmml" xref="S3.SS1.p2.3.m2.1.1.3.2.2">𝒳</ci><ci id="S3.SS1.p2.3.m2.1.1.3.2.3.cmml" xref="S3.SS1.p2.3.m2.1.1.3.2.3">𝒵</ci></apply><ci id="S3.SS1.p2.3.m2.1.1.3.3.cmml" xref="S3.SS1.p2.3.m2.1.1.3.3">𝒜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m2.1c">\Lambda:\mathcal{X}\times\mathcal{Z}\to\mathcal{A}</annotation></semantics></math> is the Python execution engine.
This paper studies the design of the code generation process <math id="S3.SS1.p2.4.m3.1" class="ltx_Math" alttext="\Pi" display="inline"><semantics id="S3.SS1.p2.4.m3.1a"><mi mathvariant="normal" id="S3.SS1.p2.4.m3.1.1" xref="S3.SS1.p2.4.m3.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m3.1b"><ci id="S3.SS1.p2.4.m3.1.1.cmml" xref="S3.SS1.p2.4.m3.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m3.1c">\Pi</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.14" class="ltx_p"><span id="S3.SS1.p3.14.1" class="ltx_text ltx_font_bold">Algorithm.</span>
The proposed code generation process <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\Pi" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi mathvariant="normal" id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\Pi</annotation></semantics></math> is summarized in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.2 Module implementation with a single LLM ‣ 3 Proposed Method ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
It consists of three steps.
First, given an input query <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="q\in\mathcal{Q}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">q</mi><mo id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">𝒬</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><in id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1"></in><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝑞</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝒬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">q\in\mathcal{Q}</annotation></semantics></math>,
the query rephraser <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">R</annotation></semantics></math> is applied to obtain a set of rephrased queries <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="\{r_{i}\}_{i=1}^{N}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><msubsup id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mrow id="S3.SS1.p3.4.m4.1.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.4.m4.1.1.1.1.1.2" xref="S3.SS1.p3.4.m4.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p3.4.m4.1.1.1.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.1.1.1.1.2" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1.2.cmml">r</mi><mi id="S3.SS1.p3.4.m4.1.1.1.1.1.1.3" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p3.4.m4.1.1.1.1.1.3" xref="S3.SS1.p3.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p3.4.m4.1.1.1.3" xref="S3.SS1.p3.4.m4.1.1.1.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.1.3.2" xref="S3.SS1.p3.4.m4.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p3.4.m4.1.1.1.3.1" xref="S3.SS1.p3.4.m4.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p3.4.m4.1.1.1.3.3" xref="S3.SS1.p3.4.m4.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1">superscript</csymbol><apply id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1">subscript</csymbol><set id="S3.SS1.p3.4.m4.1.1.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1"><apply id="S3.SS1.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1.2">𝑟</ci><ci id="S3.SS1.p3.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p3.4.m4.1.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.1.3"><eq id="S3.SS1.p3.4.m4.1.1.1.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1.3.1"></eq><ci id="S3.SS1.p3.4.m4.1.1.1.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p3.4.m4.1.1.1.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\{r_{i}\}_{i=1}^{N}</annotation></semantics></math>.
Here, each <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="r_{i}" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><msub id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml">r</mi><mi id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2">𝑟</ci><ci id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">r_{i}</annotation></semantics></math> is a rephrased version of <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mi id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><ci id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">q</annotation></semantics></math>, intended to make coding more effective with a more comprehensive understanding of the input query.
Second, the code generator <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><mi id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><ci id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">G</annotation></semantics></math> is applied to each rephrased query. This step produces multiple candidate codes <math id="S3.SS1.p3.8.m8.1" class="ltx_Math" alttext="\{z_{ij}\}_{j=1}^{M}" display="inline"><semantics id="S3.SS1.p3.8.m8.1a"><msubsup id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml"><mrow id="S3.SS1.p3.8.m8.1.1.1.1.1" xref="S3.SS1.p3.8.m8.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.8.m8.1.1.1.1.1.2" xref="S3.SS1.p3.8.m8.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p3.8.m8.1.1.1.1.1.1" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.8.m8.1.1.1.1.1.1.2" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.SS1.p3.8.m8.1.1.1.1.1.1.3" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.2" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.1" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.3" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p3.8.m8.1.1.1.1.1.3" xref="S3.SS1.p3.8.m8.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p3.8.m8.1.1.1.3" xref="S3.SS1.p3.8.m8.1.1.1.3.cmml"><mi id="S3.SS1.p3.8.m8.1.1.1.3.2" xref="S3.SS1.p3.8.m8.1.1.1.3.2.cmml">j</mi><mo id="S3.SS1.p3.8.m8.1.1.1.3.1" xref="S3.SS1.p3.8.m8.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p3.8.m8.1.1.1.3.3" xref="S3.SS1.p3.8.m8.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p3.8.m8.1.1.3" xref="S3.SS1.p3.8.m8.1.1.3.cmml">M</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><apply id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1">superscript</csymbol><apply id="S3.SS1.p3.8.m8.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1">subscript</csymbol><set id="S3.SS1.p3.8.m8.1.1.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1"><apply id="S3.SS1.p3.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m8.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.3"><times id="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.1"></times><ci id="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.8.m8.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></set><apply id="S3.SS1.p3.8.m8.1.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.1.3"><eq id="S3.SS1.p3.8.m8.1.1.1.3.1.cmml" xref="S3.SS1.p3.8.m8.1.1.1.3.1"></eq><ci id="S3.SS1.p3.8.m8.1.1.1.3.2.cmml" xref="S3.SS1.p3.8.m8.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS1.p3.8.m8.1.1.1.3.3.cmml" xref="S3.SS1.p3.8.m8.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p3.8.m8.1.1.3.cmml" xref="S3.SS1.p3.8.m8.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">\{z_{ij}\}_{j=1}^{M}</annotation></semantics></math> for each rephrased query <math id="S3.SS1.p3.9.m9.1" class="ltx_Math" alttext="r_{i}" display="inline"><semantics id="S3.SS1.p3.9.m9.1a"><msub id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml"><mi id="S3.SS1.p3.9.m9.1.1.2" xref="S3.SS1.p3.9.m9.1.1.2.cmml">r</mi><mi id="S3.SS1.p3.9.m9.1.1.3" xref="S3.SS1.p3.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><apply id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m9.1.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p3.9.m9.1.1.2.cmml" xref="S3.SS1.p3.9.m9.1.1.2">𝑟</ci><ci id="S3.SS1.p3.9.m9.1.1.3.cmml" xref="S3.SS1.p3.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">r_{i}</annotation></semantics></math> and pre-executes them to obtain candidate answers <math id="S3.SS1.p3.10.m10.2" class="ltx_Math" alttext="a_{ij}=\Lambda(x,z_{ij})" display="inline"><semantics id="S3.SS1.p3.10.m10.2a"><mrow id="S3.SS1.p3.10.m10.2.2" xref="S3.SS1.p3.10.m10.2.2.cmml"><msub id="S3.SS1.p3.10.m10.2.2.3" xref="S3.SS1.p3.10.m10.2.2.3.cmml"><mi id="S3.SS1.p3.10.m10.2.2.3.2" xref="S3.SS1.p3.10.m10.2.2.3.2.cmml">a</mi><mrow id="S3.SS1.p3.10.m10.2.2.3.3" xref="S3.SS1.p3.10.m10.2.2.3.3.cmml"><mi id="S3.SS1.p3.10.m10.2.2.3.3.2" xref="S3.SS1.p3.10.m10.2.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.10.m10.2.2.3.3.1" xref="S3.SS1.p3.10.m10.2.2.3.3.1.cmml">​</mo><mi id="S3.SS1.p3.10.m10.2.2.3.3.3" xref="S3.SS1.p3.10.m10.2.2.3.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS1.p3.10.m10.2.2.2" xref="S3.SS1.p3.10.m10.2.2.2.cmml">=</mo><mrow id="S3.SS1.p3.10.m10.2.2.1" xref="S3.SS1.p3.10.m10.2.2.1.cmml"><mi mathvariant="normal" id="S3.SS1.p3.10.m10.2.2.1.3" xref="S3.SS1.p3.10.m10.2.2.1.3.cmml">Λ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.10.m10.2.2.1.2" xref="S3.SS1.p3.10.m10.2.2.1.2.cmml">​</mo><mrow id="S3.SS1.p3.10.m10.2.2.1.1.1" xref="S3.SS1.p3.10.m10.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.10.m10.2.2.1.1.1.2" xref="S3.SS1.p3.10.m10.2.2.1.1.2.cmml">(</mo><mi id="S3.SS1.p3.10.m10.1.1" xref="S3.SS1.p3.10.m10.1.1.cmml">x</mi><mo id="S3.SS1.p3.10.m10.2.2.1.1.1.3" xref="S3.SS1.p3.10.m10.2.2.1.1.2.cmml">,</mo><msub id="S3.SS1.p3.10.m10.2.2.1.1.1.1" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1.cmml"><mi id="S3.SS1.p3.10.m10.2.2.1.1.1.1.2" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1.2.cmml">z</mi><mrow id="S3.SS1.p3.10.m10.2.2.1.1.1.1.3" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.2" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.1" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.3" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p3.10.m10.2.2.1.1.1.4" xref="S3.SS1.p3.10.m10.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.2b"><apply id="S3.SS1.p3.10.m10.2.2.cmml" xref="S3.SS1.p3.10.m10.2.2"><eq id="S3.SS1.p3.10.m10.2.2.2.cmml" xref="S3.SS1.p3.10.m10.2.2.2"></eq><apply id="S3.SS1.p3.10.m10.2.2.3.cmml" xref="S3.SS1.p3.10.m10.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.10.m10.2.2.3.1.cmml" xref="S3.SS1.p3.10.m10.2.2.3">subscript</csymbol><ci id="S3.SS1.p3.10.m10.2.2.3.2.cmml" xref="S3.SS1.p3.10.m10.2.2.3.2">𝑎</ci><apply id="S3.SS1.p3.10.m10.2.2.3.3.cmml" xref="S3.SS1.p3.10.m10.2.2.3.3"><times id="S3.SS1.p3.10.m10.2.2.3.3.1.cmml" xref="S3.SS1.p3.10.m10.2.2.3.3.1"></times><ci id="S3.SS1.p3.10.m10.2.2.3.3.2.cmml" xref="S3.SS1.p3.10.m10.2.2.3.3.2">𝑖</ci><ci id="S3.SS1.p3.10.m10.2.2.3.3.3.cmml" xref="S3.SS1.p3.10.m10.2.2.3.3.3">𝑗</ci></apply></apply><apply id="S3.SS1.p3.10.m10.2.2.1.cmml" xref="S3.SS1.p3.10.m10.2.2.1"><times id="S3.SS1.p3.10.m10.2.2.1.2.cmml" xref="S3.SS1.p3.10.m10.2.2.1.2"></times><ci id="S3.SS1.p3.10.m10.2.2.1.3.cmml" xref="S3.SS1.p3.10.m10.2.2.1.3">Λ</ci><interval closure="open" id="S3.SS1.p3.10.m10.2.2.1.1.2.cmml" xref="S3.SS1.p3.10.m10.2.2.1.1.1"><ci id="S3.SS1.p3.10.m10.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1">𝑥</ci><apply id="S3.SS1.p3.10.m10.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.10.m10.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.10.m10.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1.2">𝑧</ci><apply id="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1.3"><times id="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.1"></times><ci id="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.10.m10.2.2.1.1.1.1.3.3">𝑗</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.2c">a_{ij}=\Lambda(x,z_{ij})</annotation></semantics></math>.
Finally, the answer aggregator <math id="S3.SS1.p3.11.m11.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p3.11.m11.1a"><mi id="S3.SS1.p3.11.m11.1.1" xref="S3.SS1.p3.11.m11.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m11.1b"><ci id="S3.SS1.p3.11.m11.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m11.1c">A</annotation></semantics></math> is applied to the set of candidate code-answer pairs. This step chooses the final answer <math id="S3.SS1.p3.12.m12.1" class="ltx_Math" alttext="a_{\tau}" display="inline"><semantics id="S3.SS1.p3.12.m12.1a"><msub id="S3.SS1.p3.12.m12.1.1" xref="S3.SS1.p3.12.m12.1.1.cmml"><mi id="S3.SS1.p3.12.m12.1.1.2" xref="S3.SS1.p3.12.m12.1.1.2.cmml">a</mi><mi id="S3.SS1.p3.12.m12.1.1.3" xref="S3.SS1.p3.12.m12.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.12.m12.1b"><apply id="S3.SS1.p3.12.m12.1.1.cmml" xref="S3.SS1.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.12.m12.1.1.1.cmml" xref="S3.SS1.p3.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p3.12.m12.1.1.2.cmml" xref="S3.SS1.p3.12.m12.1.1.2">𝑎</ci><ci id="S3.SS1.p3.12.m12.1.1.3.cmml" xref="S3.SS1.p3.12.m12.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.12.m12.1c">a_{\tau}</annotation></semantics></math> and the best code <math id="S3.SS1.p3.13.m13.1" class="ltx_Math" alttext="z_{\tau}" display="inline"><semantics id="S3.SS1.p3.13.m13.1a"><msub id="S3.SS1.p3.13.m13.1.1" xref="S3.SS1.p3.13.m13.1.1.cmml"><mi id="S3.SS1.p3.13.m13.1.1.2" xref="S3.SS1.p3.13.m13.1.1.2.cmml">z</mi><mi id="S3.SS1.p3.13.m13.1.1.3" xref="S3.SS1.p3.13.m13.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.13.m13.1b"><apply id="S3.SS1.p3.13.m13.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.13.m13.1.1.1.cmml" xref="S3.SS1.p3.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p3.13.m13.1.1.2.cmml" xref="S3.SS1.p3.13.m13.1.1.2">𝑧</ci><ci id="S3.SS1.p3.13.m13.1.1.3.cmml" xref="S3.SS1.p3.13.m13.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.13.m13.1c">z_{\tau}</annotation></semantics></math>, where <math id="S3.SS1.p3.14.m14.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p3.14.m14.1a"><mi id="S3.SS1.p3.14.m14.1.1" xref="S3.SS1.p3.14.m14.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.14.m14.1b"><ci id="S3.SS1.p3.14.m14.1.1.cmml" xref="S3.SS1.p3.14.m14.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.14.m14.1c">\tau</annotation></semantics></math> is the index of the chosen pair.
As shown in Figure <a href="#S2.F2" title="Figure 2 ‣ 2.2 Large Language Models ‣ 2 Related work ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>,
PyramidCoder implements all modules with a single frozen LLM, and the code generation process is represented by a pyramid structure of texts (queries and codes) generated by the LLM.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Module implementation with a single LLM</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.4" class="ltx_p">Given a frozen LLM <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\pi:\mathcal{T}\to\mathcal{T}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">π</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">𝒯</mi><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">𝒯</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><ci id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1">:</ci><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝜋</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><ci id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1">→</ci><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">𝒯</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝒯</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\pi:\mathcal{T}\to\mathcal{T}</annotation></semantics></math> pre-trained on a large text dataset comprising both natural language and programming code, we implement the query rephraser <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">R</annotation></semantics></math>, the code generator <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">G</annotation></semantics></math> and the answer aggregator <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">A</annotation></semantics></math> with the aforementioned LLM without any additional training.
Below, we describe the motivation and definition of each module.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.4.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> PyramidCoder <math id="alg1.2.m1.2" class="ltx_Math" alttext="\Pi(q,x)" display="inline"><semantics id="alg1.2.m1.2b"><mrow id="alg1.2.m1.2.3" xref="alg1.2.m1.2.3.cmml"><mi mathvariant="normal" id="alg1.2.m1.2.3.2" xref="alg1.2.m1.2.3.2.cmml">Π</mi><mo lspace="0em" rspace="0em" id="alg1.2.m1.2.3.1" xref="alg1.2.m1.2.3.1.cmml">​</mo><mrow id="alg1.2.m1.2.3.3.2" xref="alg1.2.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.2.m1.2.3.3.2.1" xref="alg1.2.m1.2.3.3.1.cmml">(</mo><mi id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml">q</mi><mo id="alg1.2.m1.2.3.3.2.2" xref="alg1.2.m1.2.3.3.1.cmml">,</mo><mi id="alg1.2.m1.2.2" xref="alg1.2.m1.2.2.cmml">x</mi><mo stretchy="false" id="alg1.2.m1.2.3.3.2.3" xref="alg1.2.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.m1.2c"><apply id="alg1.2.m1.2.3.cmml" xref="alg1.2.m1.2.3"><times id="alg1.2.m1.2.3.1.cmml" xref="alg1.2.m1.2.3.1"></times><ci id="alg1.2.m1.2.3.2.cmml" xref="alg1.2.m1.2.3.2">Π</ci><interval closure="open" id="alg1.2.m1.2.3.3.1.cmml" xref="alg1.2.m1.2.3.3.2"><ci id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1">𝑞</ci><ci id="alg1.2.m1.2.2.cmml" xref="alg1.2.m1.2.2">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.2d">\Pi(q,x)</annotation></semantics></math></figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  Query <math id="alg1.l0.m1.1" class="ltx_Math" alttext="q\in\mathcal{Q}" display="inline"><semantics id="alg1.l0.m1.1a"><mrow id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml"><mi id="alg1.l0.m1.1.1.2" xref="alg1.l0.m1.1.1.2.cmml">q</mi><mo id="alg1.l0.m1.1.1.1" xref="alg1.l0.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m1.1.1.3" xref="alg1.l0.m1.1.1.3.cmml">𝒬</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><apply id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1"><in id="alg1.l0.m1.1.1.1.cmml" xref="alg1.l0.m1.1.1.1"></in><ci id="alg1.l0.m1.1.1.2.cmml" xref="alg1.l0.m1.1.1.2">𝑞</ci><ci id="alg1.l0.m1.1.1.3.cmml" xref="alg1.l0.m1.1.1.3">𝒬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">q\in\mathcal{Q}</annotation></semantics></math>, Image <math id="alg1.l0.m2.1" class="ltx_Math" alttext="x\in\mathcal{X}" display="inline"><semantics id="alg1.l0.m2.1a"><mrow id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml"><mi id="alg1.l0.m2.1.1.2" xref="alg1.l0.m2.1.1.2.cmml">x</mi><mo id="alg1.l0.m2.1.1.1" xref="alg1.l0.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m2.1.1.3" xref="alg1.l0.m2.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><apply id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1"><in id="alg1.l0.m2.1.1.1.cmml" xref="alg1.l0.m2.1.1.1"></in><ci id="alg1.l0.m2.1.1.2.cmml" xref="alg1.l0.m2.1.1.2">𝑥</ci><ci id="alg1.l0.m2.1.1.3.cmml" xref="alg1.l0.m2.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">x\in\mathcal{X}</annotation></semantics></math>, LLM <math id="alg1.l0.m3.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">\pi</annotation></semantics></math>

</div>
<div id="alg1.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0a.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  Code <math id="alg1.l0a.m1.1" class="ltx_Math" alttext="z\in\mathcal{Z}" display="inline"><semantics id="alg1.l0a.m1.1a"><mrow id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml"><mi id="alg1.l0a.m1.1.1.2" xref="alg1.l0a.m1.1.1.2.cmml">z</mi><mo id="alg1.l0a.m1.1.1.1" xref="alg1.l0a.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l0a.m1.1.1.3" xref="alg1.l0a.m1.1.1.3.cmml">𝒵</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><apply id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1"><in id="alg1.l0a.m1.1.1.1.cmml" xref="alg1.l0a.m1.1.1.1"></in><ci id="alg1.l0a.m1.1.1.2.cmml" xref="alg1.l0a.m1.1.1.2">𝑧</ci><ci id="alg1.l0a.m1.1.1.3.cmml" xref="alg1.l0a.m1.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">z\in\mathcal{Z}</annotation></semantics></math>, Answer <math id="alg1.l0a.m2.1" class="ltx_Math" alttext="\hat{a}\in\mathcal{A}" display="inline"><semantics id="alg1.l0a.m2.1a"><mrow id="alg1.l0a.m2.1.1" xref="alg1.l0a.m2.1.1.cmml"><mover accent="true" id="alg1.l0a.m2.1.1.2" xref="alg1.l0a.m2.1.1.2.cmml"><mi id="alg1.l0a.m2.1.1.2.2" xref="alg1.l0a.m2.1.1.2.2.cmml">a</mi><mo id="alg1.l0a.m2.1.1.2.1" xref="alg1.l0a.m2.1.1.2.1.cmml">^</mo></mover><mo id="alg1.l0a.m2.1.1.1" xref="alg1.l0a.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l0a.m2.1.1.3" xref="alg1.l0a.m2.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m2.1b"><apply id="alg1.l0a.m2.1.1.cmml" xref="alg1.l0a.m2.1.1"><in id="alg1.l0a.m2.1.1.1.cmml" xref="alg1.l0a.m2.1.1.1"></in><apply id="alg1.l0a.m2.1.1.2.cmml" xref="alg1.l0a.m2.1.1.2"><ci id="alg1.l0a.m2.1.1.2.1.cmml" xref="alg1.l0a.m2.1.1.2.1">^</ci><ci id="alg1.l0a.m2.1.1.2.2.cmml" xref="alg1.l0a.m2.1.1.2.2">𝑎</ci></apply><ci id="alg1.l0a.m2.1.1.3.cmml" xref="alg1.l0a.m2.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m2.1c">\hat{a}\in\mathcal{A}</annotation></semantics></math>

</div>
<div id="alg1.l1" class="ltx_listingline">  <math id="alg1.l1.m1.1" class="ltx_Math" alttext="Z\leftarrow\emptyset" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">Z</mi><mo stretchy="false" id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">←</mo><mi mathvariant="normal" id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">←</ci><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑍</ci><emptyset id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">Z\leftarrow\emptyset</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">  <math id="alg1.l2.m1.5" class="ltx_Math" alttext="[r_{1},r_{2},\cdots,r_{N}]\leftarrow R(q)" display="inline"><semantics id="alg1.l2.m1.5a"><mrow id="alg1.l2.m1.5.5" xref="alg1.l2.m1.5.5.cmml"><mrow id="alg1.l2.m1.5.5.3.3" xref="alg1.l2.m1.5.5.3.4.cmml"><mo stretchy="false" id="alg1.l2.m1.5.5.3.3.4" xref="alg1.l2.m1.5.5.3.4.cmml">[</mo><msub id="alg1.l2.m1.3.3.1.1.1" xref="alg1.l2.m1.3.3.1.1.1.cmml"><mi id="alg1.l2.m1.3.3.1.1.1.2" xref="alg1.l2.m1.3.3.1.1.1.2.cmml">r</mi><mn id="alg1.l2.m1.3.3.1.1.1.3" xref="alg1.l2.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l2.m1.5.5.3.3.5" xref="alg1.l2.m1.5.5.3.4.cmml">,</mo><msub id="alg1.l2.m1.4.4.2.2.2" xref="alg1.l2.m1.4.4.2.2.2.cmml"><mi id="alg1.l2.m1.4.4.2.2.2.2" xref="alg1.l2.m1.4.4.2.2.2.2.cmml">r</mi><mn id="alg1.l2.m1.4.4.2.2.2.3" xref="alg1.l2.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="alg1.l2.m1.5.5.3.3.6" xref="alg1.l2.m1.5.5.3.4.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">⋯</mi><mo id="alg1.l2.m1.5.5.3.3.7" xref="alg1.l2.m1.5.5.3.4.cmml">,</mo><msub id="alg1.l2.m1.5.5.3.3.3" xref="alg1.l2.m1.5.5.3.3.3.cmml"><mi id="alg1.l2.m1.5.5.3.3.3.2" xref="alg1.l2.m1.5.5.3.3.3.2.cmml">r</mi><mi id="alg1.l2.m1.5.5.3.3.3.3" xref="alg1.l2.m1.5.5.3.3.3.3.cmml">N</mi></msub><mo stretchy="false" id="alg1.l2.m1.5.5.3.3.8" xref="alg1.l2.m1.5.5.3.4.cmml">]</mo></mrow><mo stretchy="false" id="alg1.l2.m1.5.5.4" xref="alg1.l2.m1.5.5.4.cmml">←</mo><mrow id="alg1.l2.m1.5.5.5" xref="alg1.l2.m1.5.5.5.cmml"><mi id="alg1.l2.m1.5.5.5.2" xref="alg1.l2.m1.5.5.5.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m1.5.5.5.1" xref="alg1.l2.m1.5.5.5.1.cmml">​</mo><mrow id="alg1.l2.m1.5.5.5.3.2" xref="alg1.l2.m1.5.5.5.cmml"><mo stretchy="false" id="alg1.l2.m1.5.5.5.3.2.1" xref="alg1.l2.m1.5.5.5.cmml">(</mo><mi id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">q</mi><mo stretchy="false" id="alg1.l2.m1.5.5.5.3.2.2" xref="alg1.l2.m1.5.5.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.5b"><apply id="alg1.l2.m1.5.5.cmml" xref="alg1.l2.m1.5.5"><ci id="alg1.l2.m1.5.5.4.cmml" xref="alg1.l2.m1.5.5.4">←</ci><list id="alg1.l2.m1.5.5.3.4.cmml" xref="alg1.l2.m1.5.5.3.3"><apply id="alg1.l2.m1.3.3.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.3.3.1.1.1.1.cmml" xref="alg1.l2.m1.3.3.1.1.1">subscript</csymbol><ci id="alg1.l2.m1.3.3.1.1.1.2.cmml" xref="alg1.l2.m1.3.3.1.1.1.2">𝑟</ci><cn type="integer" id="alg1.l2.m1.3.3.1.1.1.3.cmml" xref="alg1.l2.m1.3.3.1.1.1.3">1</cn></apply><apply id="alg1.l2.m1.4.4.2.2.2.cmml" xref="alg1.l2.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.4.4.2.2.2.1.cmml" xref="alg1.l2.m1.4.4.2.2.2">subscript</csymbol><ci id="alg1.l2.m1.4.4.2.2.2.2.cmml" xref="alg1.l2.m1.4.4.2.2.2.2">𝑟</ci><cn type="integer" id="alg1.l2.m1.4.4.2.2.2.3.cmml" xref="alg1.l2.m1.4.4.2.2.2.3">2</cn></apply><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">⋯</ci><apply id="alg1.l2.m1.5.5.3.3.3.cmml" xref="alg1.l2.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="alg1.l2.m1.5.5.3.3.3.1.cmml" xref="alg1.l2.m1.5.5.3.3.3">subscript</csymbol><ci id="alg1.l2.m1.5.5.3.3.3.2.cmml" xref="alg1.l2.m1.5.5.3.3.3.2">𝑟</ci><ci id="alg1.l2.m1.5.5.3.3.3.3.cmml" xref="alg1.l2.m1.5.5.3.3.3.3">𝑁</ci></apply></list><apply id="alg1.l2.m1.5.5.5.cmml" xref="alg1.l2.m1.5.5.5"><times id="alg1.l2.m1.5.5.5.1.cmml" xref="alg1.l2.m1.5.5.5.1"></times><ci id="alg1.l2.m1.5.5.5.2.cmml" xref="alg1.l2.m1.5.5.5.2">𝑅</ci><ci id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.5c">[r_{1},r_{2},\cdots,r_{N}]\leftarrow R(q)</annotation></semantics></math> # Query rephraser

</div>
<div id="alg1.l3" class="ltx_listingline">  <span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.3" class="ltx_Math" alttext="i=1,\cdots,N" display="inline"><semantics id="alg1.l3.m1.3a"><mrow id="alg1.l3.m1.3.4" xref="alg1.l3.m1.3.4.cmml"><mi id="alg1.l3.m1.3.4.2" xref="alg1.l3.m1.3.4.2.cmml">i</mi><mo id="alg1.l3.m1.3.4.1" xref="alg1.l3.m1.3.4.1.cmml">=</mo><mrow id="alg1.l3.m1.3.4.3.2" xref="alg1.l3.m1.3.4.3.1.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.3.4.3.2.1" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">⋯</mi><mo id="alg1.l3.m1.3.4.3.2.2" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.3b"><apply id="alg1.l3.m1.3.4.cmml" xref="alg1.l3.m1.3.4"><eq id="alg1.l3.m1.3.4.1.cmml" xref="alg1.l3.m1.3.4.1"></eq><ci id="alg1.l3.m1.3.4.2.cmml" xref="alg1.l3.m1.3.4.2">𝑖</ci><list id="alg1.l3.m1.3.4.3.1.cmml" xref="alg1.l3.m1.3.4.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">⋯</ci><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.3c">i=1,\cdots,N</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">     <math id="alg1.l4.m1.5" class="ltx_Math" alttext="[z_{i1},z_{i2},\cdots,z_{iM}]\leftarrow G(r_{i})" display="inline"><semantics id="alg1.l4.m1.5a"><mrow id="alg1.l4.m1.5.5" xref="alg1.l4.m1.5.5.cmml"><mrow id="alg1.l4.m1.4.4.3.3" xref="alg1.l4.m1.4.4.3.4.cmml"><mo stretchy="false" id="alg1.l4.m1.4.4.3.3.4" xref="alg1.l4.m1.4.4.3.4.cmml">[</mo><msub id="alg1.l4.m1.2.2.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.cmml"><mi id="alg1.l4.m1.2.2.1.1.1.2" xref="alg1.l4.m1.2.2.1.1.1.2.cmml">z</mi><mrow id="alg1.l4.m1.2.2.1.1.1.3" xref="alg1.l4.m1.2.2.1.1.1.3.cmml"><mi id="alg1.l4.m1.2.2.1.1.1.3.2" xref="alg1.l4.m1.2.2.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.2.2.1.1.1.3.1" xref="alg1.l4.m1.2.2.1.1.1.3.1.cmml">​</mo><mn id="alg1.l4.m1.2.2.1.1.1.3.3" xref="alg1.l4.m1.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l4.m1.4.4.3.3.5" xref="alg1.l4.m1.4.4.3.4.cmml">,</mo><msub id="alg1.l4.m1.3.3.2.2.2" xref="alg1.l4.m1.3.3.2.2.2.cmml"><mi id="alg1.l4.m1.3.3.2.2.2.2" xref="alg1.l4.m1.3.3.2.2.2.2.cmml">z</mi><mrow id="alg1.l4.m1.3.3.2.2.2.3" xref="alg1.l4.m1.3.3.2.2.2.3.cmml"><mi id="alg1.l4.m1.3.3.2.2.2.3.2" xref="alg1.l4.m1.3.3.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.2.2.2.3.1" xref="alg1.l4.m1.3.3.2.2.2.3.1.cmml">​</mo><mn id="alg1.l4.m1.3.3.2.2.2.3.3" xref="alg1.l4.m1.3.3.2.2.2.3.3.cmml">2</mn></mrow></msub><mo id="alg1.l4.m1.4.4.3.3.6" xref="alg1.l4.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">⋯</mi><mo id="alg1.l4.m1.4.4.3.3.7" xref="alg1.l4.m1.4.4.3.4.cmml">,</mo><msub id="alg1.l4.m1.4.4.3.3.3" xref="alg1.l4.m1.4.4.3.3.3.cmml"><mi id="alg1.l4.m1.4.4.3.3.3.2" xref="alg1.l4.m1.4.4.3.3.3.2.cmml">z</mi><mrow id="alg1.l4.m1.4.4.3.3.3.3" xref="alg1.l4.m1.4.4.3.3.3.3.cmml"><mi id="alg1.l4.m1.4.4.3.3.3.3.2" xref="alg1.l4.m1.4.4.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.4.4.3.3.3.3.1" xref="alg1.l4.m1.4.4.3.3.3.3.1.cmml">​</mo><mi id="alg1.l4.m1.4.4.3.3.3.3.3" xref="alg1.l4.m1.4.4.3.3.3.3.3.cmml">M</mi></mrow></msub><mo stretchy="false" id="alg1.l4.m1.4.4.3.3.8" xref="alg1.l4.m1.4.4.3.4.cmml">]</mo></mrow><mo stretchy="false" id="alg1.l4.m1.5.5.5" xref="alg1.l4.m1.5.5.5.cmml">←</mo><mrow id="alg1.l4.m1.5.5.4" xref="alg1.l4.m1.5.5.4.cmml"><mi id="alg1.l4.m1.5.5.4.3" xref="alg1.l4.m1.5.5.4.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.5.5.4.2" xref="alg1.l4.m1.5.5.4.2.cmml">​</mo><mrow id="alg1.l4.m1.5.5.4.1.1" xref="alg1.l4.m1.5.5.4.1.1.1.cmml"><mo stretchy="false" id="alg1.l4.m1.5.5.4.1.1.2" xref="alg1.l4.m1.5.5.4.1.1.1.cmml">(</mo><msub id="alg1.l4.m1.5.5.4.1.1.1" xref="alg1.l4.m1.5.5.4.1.1.1.cmml"><mi id="alg1.l4.m1.5.5.4.1.1.1.2" xref="alg1.l4.m1.5.5.4.1.1.1.2.cmml">r</mi><mi id="alg1.l4.m1.5.5.4.1.1.1.3" xref="alg1.l4.m1.5.5.4.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l4.m1.5.5.4.1.1.3" xref="alg1.l4.m1.5.5.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.5b"><apply id="alg1.l4.m1.5.5.cmml" xref="alg1.l4.m1.5.5"><ci id="alg1.l4.m1.5.5.5.cmml" xref="alg1.l4.m1.5.5.5">←</ci><list id="alg1.l4.m1.4.4.3.4.cmml" xref="alg1.l4.m1.4.4.3.3"><apply id="alg1.l4.m1.2.2.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.2.2.1.1.1.2.cmml" xref="alg1.l4.m1.2.2.1.1.1.2">𝑧</ci><apply id="alg1.l4.m1.2.2.1.1.1.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.3"><times id="alg1.l4.m1.2.2.1.1.1.3.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.3.1"></times><ci id="alg1.l4.m1.2.2.1.1.1.3.2.cmml" xref="alg1.l4.m1.2.2.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l4.m1.2.2.1.1.1.3.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l4.m1.3.3.2.2.2.cmml" xref="alg1.l4.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.2.2.2.1.cmml" xref="alg1.l4.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.l4.m1.3.3.2.2.2.2.cmml" xref="alg1.l4.m1.3.3.2.2.2.2">𝑧</ci><apply id="alg1.l4.m1.3.3.2.2.2.3.cmml" xref="alg1.l4.m1.3.3.2.2.2.3"><times id="alg1.l4.m1.3.3.2.2.2.3.1.cmml" xref="alg1.l4.m1.3.3.2.2.2.3.1"></times><ci id="alg1.l4.m1.3.3.2.2.2.3.2.cmml" xref="alg1.l4.m1.3.3.2.2.2.3.2">𝑖</ci><cn type="integer" id="alg1.l4.m1.3.3.2.2.2.3.3.cmml" xref="alg1.l4.m1.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">⋯</ci><apply id="alg1.l4.m1.4.4.3.3.3.cmml" xref="alg1.l4.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.4.4.3.3.3.1.cmml" xref="alg1.l4.m1.4.4.3.3.3">subscript</csymbol><ci id="alg1.l4.m1.4.4.3.3.3.2.cmml" xref="alg1.l4.m1.4.4.3.3.3.2">𝑧</ci><apply id="alg1.l4.m1.4.4.3.3.3.3.cmml" xref="alg1.l4.m1.4.4.3.3.3.3"><times id="alg1.l4.m1.4.4.3.3.3.3.1.cmml" xref="alg1.l4.m1.4.4.3.3.3.3.1"></times><ci id="alg1.l4.m1.4.4.3.3.3.3.2.cmml" xref="alg1.l4.m1.4.4.3.3.3.3.2">𝑖</ci><ci id="alg1.l4.m1.4.4.3.3.3.3.3.cmml" xref="alg1.l4.m1.4.4.3.3.3.3.3">𝑀</ci></apply></apply></list><apply id="alg1.l4.m1.5.5.4.cmml" xref="alg1.l4.m1.5.5.4"><times id="alg1.l4.m1.5.5.4.2.cmml" xref="alg1.l4.m1.5.5.4.2"></times><ci id="alg1.l4.m1.5.5.4.3.cmml" xref="alg1.l4.m1.5.5.4.3">𝐺</ci><apply id="alg1.l4.m1.5.5.4.1.1.1.cmml" xref="alg1.l4.m1.5.5.4.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.5.5.4.1.1.1.1.cmml" xref="alg1.l4.m1.5.5.4.1.1">subscript</csymbol><ci id="alg1.l4.m1.5.5.4.1.1.1.2.cmml" xref="alg1.l4.m1.5.5.4.1.1.1.2">𝑟</ci><ci id="alg1.l4.m1.5.5.4.1.1.1.3.cmml" xref="alg1.l4.m1.5.5.4.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.5c">[z_{i1},z_{i2},\cdots,z_{iM}]\leftarrow G(r_{i})</annotation></semantics></math> # Code generator

</div>
<div id="alg1.l5" class="ltx_listingline">     <span id="alg1.l5.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l5.m1.3" class="ltx_Math" alttext="j=1,\cdots,M" display="inline"><semantics id="alg1.l5.m1.3a"><mrow id="alg1.l5.m1.3.4" xref="alg1.l5.m1.3.4.cmml"><mi id="alg1.l5.m1.3.4.2" xref="alg1.l5.m1.3.4.2.cmml">j</mi><mo id="alg1.l5.m1.3.4.1" xref="alg1.l5.m1.3.4.1.cmml">=</mo><mrow id="alg1.l5.m1.3.4.3.2" xref="alg1.l5.m1.3.4.3.1.cmml"><mn id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">1</mn><mo id="alg1.l5.m1.3.4.3.2.1" xref="alg1.l5.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml">⋯</mi><mo id="alg1.l5.m1.3.4.3.2.2" xref="alg1.l5.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.3b"><apply id="alg1.l5.m1.3.4.cmml" xref="alg1.l5.m1.3.4"><eq id="alg1.l5.m1.3.4.1.cmml" xref="alg1.l5.m1.3.4.1"></eq><ci id="alg1.l5.m1.3.4.2.cmml" xref="alg1.l5.m1.3.4.2">𝑗</ci><list id="alg1.l5.m1.3.4.3.1.cmml" xref="alg1.l5.m1.3.4.3.2"><cn type="integer" id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">1</cn><ci id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">⋯</ci><ci id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3">𝑀</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.3c">j=1,\cdots,M</annotation></semantics></math> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l6" class="ltx_listingline">        <math id="alg1.l6.m1.2" class="ltx_Math" alttext="a_{ij}\leftarrow\Lambda(x,z_{ij})" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><msub id="alg1.l6.m1.2.2.3" xref="alg1.l6.m1.2.2.3.cmml"><mi id="alg1.l6.m1.2.2.3.2" xref="alg1.l6.m1.2.2.3.2.cmml">a</mi><mrow id="alg1.l6.m1.2.2.3.3" xref="alg1.l6.m1.2.2.3.3.cmml"><mi id="alg1.l6.m1.2.2.3.3.2" xref="alg1.l6.m1.2.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.3.3.1" xref="alg1.l6.m1.2.2.3.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.3.3.3" xref="alg1.l6.m1.2.2.3.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.2.cmml">←</mo><mrow id="alg1.l6.m1.2.2.1" xref="alg1.l6.m1.2.2.1.cmml"><mi mathvariant="normal" id="alg1.l6.m1.2.2.1.3" xref="alg1.l6.m1.2.2.1.3.cmml">Λ</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.1.2" xref="alg1.l6.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.2.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">x</mi><mo id="alg1.l6.m1.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.2.cmml">,</mo><msub id="alg1.l6.m1.2.2.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.1.2.cmml">z</mi><mrow id="alg1.l6.m1.2.2.1.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.1.3.2" xref="alg1.l6.m1.2.2.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.1.1.1.1.3.1" xref="alg1.l6.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.1.1.1.1.3.3" xref="alg1.l6.m1.2.2.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="alg1.l6.m1.2.2.1.1.1.4" xref="alg1.l6.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><ci id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2">←</ci><apply id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.3.1.cmml" xref="alg1.l6.m1.2.2.3">subscript</csymbol><ci id="alg1.l6.m1.2.2.3.2.cmml" xref="alg1.l6.m1.2.2.3.2">𝑎</ci><apply id="alg1.l6.m1.2.2.3.3.cmml" xref="alg1.l6.m1.2.2.3.3"><times id="alg1.l6.m1.2.2.3.3.1.cmml" xref="alg1.l6.m1.2.2.3.3.1"></times><ci id="alg1.l6.m1.2.2.3.3.2.cmml" xref="alg1.l6.m1.2.2.3.3.2">𝑖</ci><ci id="alg1.l6.m1.2.2.3.3.3.cmml" xref="alg1.l6.m1.2.2.3.3.3">𝑗</ci></apply></apply><apply id="alg1.l6.m1.2.2.1.cmml" xref="alg1.l6.m1.2.2.1"><times id="alg1.l6.m1.2.2.1.2.cmml" xref="alg1.l6.m1.2.2.1.2"></times><ci id="alg1.l6.m1.2.2.1.3.cmml" xref="alg1.l6.m1.2.2.1.3">Λ</ci><interval closure="open" id="alg1.l6.m1.2.2.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑥</ci><apply id="alg1.l6.m1.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.2">𝑧</ci><apply id="alg1.l6.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.3"><times id="alg1.l6.m1.2.2.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.3.1"></times><ci id="alg1.l6.m1.2.2.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.3.2">𝑖</ci><ci id="alg1.l6.m1.2.2.1.1.1.1.3.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.3.3">𝑗</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">a_{ij}\leftarrow\Lambda(x,z_{ij})</annotation></semantics></math> # Python executor

</div>
<div id="alg1.l7" class="ltx_listingline">        <math id="alg1.l7.m1.1" class="ltx_Math" alttext="Z\leftarrow Z\cup\{(z_{ij},a_{ij})\}" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">Z</mi><mo stretchy="false" id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">←</mo><mrow id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.1.1.1.3.cmml">Z</mi><mo id="alg1.l7.m1.1.1.1.2" xref="alg1.l7.m1.1.1.1.2.cmml">∪</mo><mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l7.m1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.1.2.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">(</mo><msub id="alg1.l7.m1.1.1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="alg1.l7.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.1.1.1.1.1.3.1" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l7.m1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="alg1.l7.m1.1.1.1.1.1.1.2.4" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">,</mo><msub id="alg1.l7.m1.1.1.1.1.1.1.2.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.2.cmml">a</mi><mrow id="alg1.l7.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.2.2.3.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.1.1.1.2.2.3.1" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="alg1.l7.m1.1.1.1.1.1.1.2.2.3.3" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.1.2.5" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">←</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑍</ci><apply id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"><union id="alg1.l7.m1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.2"></union><ci id="alg1.l7.m1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.3">𝑍</ci><set id="alg1.l7.m1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1"><interval closure="open" id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2"><apply id="alg1.l7.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="alg1.l7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3"><times id="alg1.l7.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="alg1.l7.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.2">𝑎</ci><apply id="alg1.l7.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.3"><times id="alg1.l7.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.3.1"></times><ci id="alg1.l7.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply></interval></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">Z\leftarrow Z\cup\{(z_{ij},a_{ij})\}</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">     <span id="alg1.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">  <span id="alg1.l9.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">  <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\bm{\sigma}\leftarrow A_{\text{ans}}(Z)" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.2" xref="alg1.l10.m1.1.2.cmml"><mi id="alg1.l10.m1.1.2.2" xref="alg1.l10.m1.1.2.2.cmml">𝝈</mi><mo stretchy="false" id="alg1.l10.m1.1.2.1" xref="alg1.l10.m1.1.2.1.cmml">←</mo><mrow id="alg1.l10.m1.1.2.3" xref="alg1.l10.m1.1.2.3.cmml"><msub id="alg1.l10.m1.1.2.3.2" xref="alg1.l10.m1.1.2.3.2.cmml"><mi id="alg1.l10.m1.1.2.3.2.2" xref="alg1.l10.m1.1.2.3.2.2.cmml">A</mi><mtext id="alg1.l10.m1.1.2.3.2.3" xref="alg1.l10.m1.1.2.3.2.3a.cmml">ans</mtext></msub><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.2.3.1" xref="alg1.l10.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l10.m1.1.2.3.3.2" xref="alg1.l10.m1.1.2.3.cmml"><mo stretchy="false" id="alg1.l10.m1.1.2.3.3.2.1" xref="alg1.l10.m1.1.2.3.cmml">(</mo><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">Z</mi><mo stretchy="false" id="alg1.l10.m1.1.2.3.3.2.2" xref="alg1.l10.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.2.cmml" xref="alg1.l10.m1.1.2"><ci id="alg1.l10.m1.1.2.1.cmml" xref="alg1.l10.m1.1.2.1">←</ci><ci id="alg1.l10.m1.1.2.2.cmml" xref="alg1.l10.m1.1.2.2">𝝈</ci><apply id="alg1.l10.m1.1.2.3.cmml" xref="alg1.l10.m1.1.2.3"><times id="alg1.l10.m1.1.2.3.1.cmml" xref="alg1.l10.m1.1.2.3.1"></times><apply id="alg1.l10.m1.1.2.3.2.cmml" xref="alg1.l10.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.2.3.2.1.cmml" xref="alg1.l10.m1.1.2.3.2">subscript</csymbol><ci id="alg1.l10.m1.1.2.3.2.2.cmml" xref="alg1.l10.m1.1.2.3.2.2">𝐴</ci><ci id="alg1.l10.m1.1.2.3.2.3a.cmml" xref="alg1.l10.m1.1.2.3.2.3"><mtext mathsize="70%" id="alg1.l10.m1.1.2.3.2.3.cmml" xref="alg1.l10.m1.1.2.3.2.3">ans</mtext></ci></apply><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝑍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\bm{\sigma}\leftarrow A_{\text{ans}}(Z)</annotation></semantics></math> # Answer aggregator

</div>
<div id="alg1.l11" class="ltx_listingline">  <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\tau\leftarrow A_{\text{code}}(Z_{\bm{\sigma}})" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">τ</mi><mo stretchy="false" id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">←</mo><mrow id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml"><msub id="alg1.l11.m1.1.1.1.3" xref="alg1.l11.m1.1.1.1.3.cmml"><mi id="alg1.l11.m1.1.1.1.3.2" xref="alg1.l11.m1.1.1.1.3.2.cmml">A</mi><mtext id="alg1.l11.m1.1.1.1.3.3" xref="alg1.l11.m1.1.1.1.3.3a.cmml">code</mtext></msub><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.1.1.2" xref="alg1.l11.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l11.m1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l11.m1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.1.2.cmml">Z</mi><mi id="alg1.l11.m1.1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.3.cmml">𝝈</mi></msub><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">←</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝜏</ci><apply id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"><times id="alg1.l11.m1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.2"></times><apply id="alg1.l11.m1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.1.3.2">𝐴</ci><ci id="alg1.l11.m1.1.1.1.3.3a.cmml" xref="alg1.l11.m1.1.1.1.3.3"><mtext mathsize="70%" id="alg1.l11.m1.1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.1.3.3">code</mtext></ci></apply><apply id="alg1.l11.m1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2">𝑍</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3">𝝈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\tau\leftarrow A_{\text{code}}(Z_{\bm{\sigma}})</annotation></semantics></math> # Answer aggregator

</div>
<div id="alg1.l12" class="ltx_listingline">  <span id="alg1.l12.1" class="ltx_text ltx_font_bold">return</span>  Code <math id="alg1.l12.m1.1" class="ltx_Math" alttext="z=z_{\tau}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">z</mi><mo id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">=</mo><msub id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml">z</mi><mi id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml">τ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><eq id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"></eq><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑧</ci><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2">𝑧</ci><ci id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">z=z_{\tau}</annotation></semantics></math>, Answer <math id="alg1.l12.m2.1" class="ltx_Math" alttext="\hat{a}=a_{\tau}" display="inline"><semantics id="alg1.l12.m2.1a"><mrow id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><mover accent="true" id="alg1.l12.m2.1.1.2" xref="alg1.l12.m2.1.1.2.cmml"><mi id="alg1.l12.m2.1.1.2.2" xref="alg1.l12.m2.1.1.2.2.cmml">a</mi><mo id="alg1.l12.m2.1.1.2.1" xref="alg1.l12.m2.1.1.2.1.cmml">^</mo></mover><mo id="alg1.l12.m2.1.1.1" xref="alg1.l12.m2.1.1.1.cmml">=</mo><msub id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml"><mi id="alg1.l12.m2.1.1.3.2" xref="alg1.l12.m2.1.1.3.2.cmml">a</mi><mi id="alg1.l12.m2.1.1.3.3" xref="alg1.l12.m2.1.1.3.3.cmml">τ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><eq id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1.1"></eq><apply id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1.2"><ci id="alg1.l12.m2.1.1.2.1.cmml" xref="alg1.l12.m2.1.1.2.1">^</ci><ci id="alg1.l12.m2.1.1.2.2.cmml" xref="alg1.l12.m2.1.1.2.2">𝑎</ci></apply><apply id="alg1.l12.m2.1.1.3.cmml" xref="alg1.l12.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.3.1.cmml" xref="alg1.l12.m2.1.1.3">subscript</csymbol><ci id="alg1.l12.m2.1.1.3.2.cmml" xref="alg1.l12.m2.1.1.3.2">𝑎</ci><ci id="alg1.l12.m2.1.1.3.3.cmml" xref="alg1.l12.m2.1.1.3.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">\hat{a}=a_{\tau}</annotation></semantics></math>

</div>
</div>
</figure>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Query Rephraser</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS1.p1.1" class="ltx_p"><span id="S3.SS2.SSS1.p1.1.1" class="ltx_text ltx_font_bold">Motivation.</span>
The query rephraser module in PyramidCoder is designed to enhance the interpretability and robustness of the model’s comprehension of input queries.
The VQA task demands a precise understanding of diverse query expressions, as users may articulate questions in various linguistic forms. It is widely recognized that the input prompt, including input queries, significantly influences the response quality of LLMs. The query rephraser module dynamically reformulates an input query into diverse expressions while preserving the underlying semantics. Consequently, the subsequent code generation stage benefits from a more comprehensive and adaptable understanding of user queries, thereby alleviating potential misinterpretations and improving overall task performance.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS1.p2.5" class="ltx_p"><span id="S3.SS2.SSS1.p2.5.1" class="ltx_text ltx_font_bold">Definition.</span> We define the query rephraser by</p>
<table id="S6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.2" class="ltx_Math" alttext="\displaystyle R(q)\triangleq\pi(p_{\text{qr}}+s_{\text{qr}}+q)," display="inline"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.3.2" xref="S3.E3.m1.2.2.1.1.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.1" xref="S3.E3.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.2.2.1.1.3.3.2" xref="S3.E3.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.3.3.2.1" xref="S3.E3.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">q</mi><mo stretchy="false" id="S3.E3.m1.2.2.1.1.3.3.2.2" xref="S3.E3.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.cmml">≜</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml">p</mi><mtext id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3a.cmml">qr</mtext></msub><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.2.cmml">s</mi><mtext id="S3.E3.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.3a.cmml">qr</mtext></msub><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1a" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.4" xref="S3.E3.m1.2.2.1.1.1.1.1.1.4.cmml">q</mi></mrow><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><ci id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2">≜</ci><apply id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"><times id="S3.E3.m1.2.2.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.1"></times><ci id="S3.E3.m1.2.2.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2">𝑅</ci><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑞</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2"></times><ci id="S3.E3.m1.2.2.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3">𝜋</ci><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"><plus id="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3a.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3">qr</mtext></ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.3.3a.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.E3.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.3">qr</mtext></ci></apply><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.4">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\displaystyle R(q)\triangleq\pi(p_{\text{qr}}+s_{\text{qr}}+q),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p2.4" class="ltx_p">where <math id="S3.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS2.SSS1.p2.1.m1.1a"><mi id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b"><ci id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">q</annotation></semantics></math> is an input query, <math id="S3.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="p_{\text{qr}}" display="inline"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><msub id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p2.2.m2.1.1.2" xref="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml">p</mi><mtext id="S3.SS2.SSS1.p2.2.m2.1.1.3" xref="S3.SS2.SSS1.p2.2.m2.1.1.3a.cmml">qr</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><apply id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.2">𝑝</ci><ci id="S3.SS2.SSS1.p2.2.m2.1.1.3a.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS1.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1.3">qr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">p_{\text{qr}}</annotation></semantics></math> is the query rephraser prompt as shown in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2.1 Query Rephraser ‣ 3.2 Module implementation with a single LLM ‣ 3 Proposed Method ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>a, and <math id="S3.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="s_{\text{qr}}" display="inline"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><msub id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml">s</mi><mtext id="S3.SS2.SSS1.p2.3.m3.1.1.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.3a.cmml">qr</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><apply id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p2.3.m3.1.1.3a.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3">qr</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">s_{\text{qr}}</annotation></semantics></math> is the few-shot examples prompt used for rephrasing.
The operation <math id="S3.SS2.SSS1.p2.4.m4.1" class="ltx_Math" alttext="+" display="inline"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><mo id="S3.SS2.SSS1.p2.4.m4.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><plus id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">+</annotation></semantics></math> indicates the concatenation of texts.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2407.20563/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="460" height="629" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text ltx_font_bold">Fig. 3</span>: </span>Prompt definitions.</figcaption>
</figure>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.10.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>Comparison with SOTA methods for compositional visual question answering.
Accuracy (%) on three datasets is reported.
Code: <math id="S3.T1.2.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S3.T1.2.m1.1b"><mi mathvariant="normal" id="S3.T1.2.m1.1.1" xref="S3.T1.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S3.T1.2.m1.1c"><ci id="S3.T1.2.m1.1.1.cmml" xref="S3.T1.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.m1.1d">\checkmark</annotation></semantics></math> indicates code generation methods. LLM: Model names of large language models.
</figcaption>
<table id="S3.T1.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.8.7.1" class="ltx_tr">
<th id="S3.T1.8.7.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;" rowspan="2"><span id="S3.T1.8.7.1.1.1" class="ltx_text">Method</span></th>
<th id="S3.T1.8.7.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;" rowspan="2"><span id="S3.T1.8.7.1.2.1" class="ltx_text">Code</span></th>
<th id="S3.T1.8.7.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;" rowspan="2"><span id="S3.T1.8.7.1.3.1" class="ltx_text">LLM</span></th>
<td id="S3.T1.8.7.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">GQA</td>
<td id="S3.T1.8.7.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">GQA</td>
<td id="S3.T1.8.7.1.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">VQAv2</td>
<td id="S3.T1.8.7.1.7" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">NLVR2</td>
</tr>
<tr id="S3.T1.8.8.2" class="ltx_tr">
<td id="S3.T1.8.8.2.1" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">val2000</td>
<td id="S3.T1.8.8.2.2" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">testdev</td>
<td id="S3.T1.8.8.2.3" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">val4000</td>
<td id="S3.T1.8.8.2.4" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">test</td>
</tr>
<tr id="S3.T1.3.1" class="ltx_tr">
<th id="S3.T1.3.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">CodeVQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</th>
<th id="S3.T1.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><math id="S3.T1.3.1.1.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S3.T1.3.1.1.m1.1a"><mi mathvariant="normal" id="S3.T1.3.1.1.m1.1.1" xref="S3.T1.3.1.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S3.T1.3.1.1.m1.1b"><ci id="S3.T1.3.1.1.m1.1.1.cmml" xref="S3.T1.3.1.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.1.1.m1.1c">\checkmark</annotation></semantics></math></th>
<th id="S3.T1.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">StarCoder-Base</th>
<td id="S3.T1.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">46.5</td>
<td id="S3.T1.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">41.0</td>
<td id="S3.T1.3.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">56.4</td>
<td id="S3.T1.3.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">53.5</td>
</tr>
<tr id="S3.T1.4.2" class="ltx_tr">
<th id="S3.T1.4.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">PyramidCoder (Ours)</th>
<th id="S3.T1.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;"><math id="S3.T1.4.2.1.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S3.T1.4.2.1.m1.1a"><mi mathvariant="normal" id="S3.T1.4.2.1.m1.1.1" xref="S3.T1.4.2.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S3.T1.4.2.1.m1.1b"><ci id="S3.T1.4.2.1.m1.1.1.cmml" xref="S3.T1.4.2.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.2.1.m1.1c">\checkmark</annotation></semantics></math></th>
<th id="S3.T1.4.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">StarCoder-Base</th>
<td id="S3.T1.4.2.4" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.4.2.4.1" class="ltx_text ltx_font_bold">48.2</span></td>
<td id="S3.T1.4.2.5" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.4.2.5.1" class="ltx_text ltx_font_bold">41.5</span></td>
<td id="S3.T1.4.2.6" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.4.2.6.1" class="ltx_text ltx_font_bold">57.8</span></td>
<td id="S3.T1.4.2.7" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.4.2.7.1" class="ltx_text ltx_font_bold">59.2</span></td>
</tr>
<tr id="S3.T1.5.3" class="ltx_tr">
<th id="S3.T1.5.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">CodeVQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</th>
<th id="S3.T1.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><math id="S3.T1.5.3.1.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S3.T1.5.3.1.m1.1a"><mi mathvariant="normal" id="S3.T1.5.3.1.m1.1.1" xref="S3.T1.5.3.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S3.T1.5.3.1.m1.1b"><ci id="S3.T1.5.3.1.m1.1.1.cmml" xref="S3.T1.5.3.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.3.1.m1.1c">\checkmark</annotation></semantics></math></th>
<th id="S3.T1.5.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">CodeLlama-7b-Python</th>
<td id="S3.T1.5.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">48.0</td>
<td id="S3.T1.5.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">42.8</td>
<td id="S3.T1.5.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">61.3</td>
<td id="S3.T1.5.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">57.8</td>
</tr>
<tr id="S3.T1.6.4" class="ltx_tr">
<th id="S3.T1.6.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">PyramidCoder (Ours)</th>
<th id="S3.T1.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;"><math id="S3.T1.6.4.1.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S3.T1.6.4.1.m1.1a"><mi mathvariant="normal" id="S3.T1.6.4.1.m1.1.1" xref="S3.T1.6.4.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S3.T1.6.4.1.m1.1b"><ci id="S3.T1.6.4.1.m1.1.1.cmml" xref="S3.T1.6.4.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.4.1.m1.1c">\checkmark</annotation></semantics></math></th>
<th id="S3.T1.6.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">CodeLlama-7b-Python</th>
<td id="S3.T1.6.4.4" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.6.4.4.1" class="ltx_text ltx_font_bold">51.3</span></td>
<td id="S3.T1.6.4.5" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.6.4.5.1" class="ltx_text ltx_font_bold">43.4</span></td>
<td id="S3.T1.6.4.6" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.6.4.6.1" class="ltx_text ltx_font_bold">62.8</span></td>
<td id="S3.T1.6.4.7" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.6.4.7.1" class="ltx_text ltx_font_bold">60.7</span></td>
</tr>
<tr id="S3.T1.8.6" class="ltx_tr">
<th id="S3.T1.8.6.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.8.6.3.1" class="ltx_text" style="color:#808080;">Few-shot PnP-VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite></span></th>
<th id="S3.T1.7.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><math id="S3.T1.7.5.1.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S3.T1.7.5.1.m1.1a"><mo mathcolor="#808080" id="S3.T1.7.5.1.m1.1.1" xref="S3.T1.7.5.1.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="S3.T1.7.5.1.m1.1b"><minus id="S3.T1.7.5.1.m1.1.1.cmml" xref="S3.T1.7.5.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.5.1.m1.1c">-</annotation></semantics></math></th>
<th id="S3.T1.8.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><math id="S3.T1.8.6.2.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S3.T1.8.6.2.m1.1a"><mo mathcolor="#808080" id="S3.T1.8.6.2.m1.1.1" xref="S3.T1.8.6.2.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="S3.T1.8.6.2.m1.1b"><minus id="S3.T1.8.6.2.m1.1.1.cmml" xref="S3.T1.8.6.2.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.6.2.m1.1c">-</annotation></semantics></math></th>
<td id="S3.T1.8.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.8.6.4.1" class="ltx_text" style="color:#808080;">55.1</span></td>
<td id="S3.T1.8.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.8.6.5.1" class="ltx_text" style="color:#808080;">46.6</span></td>
<td id="S3.T1.8.6.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.8.6.6.1" class="ltx_text" style="color:#808080;">66.8</span></td>
<td id="S3.T1.8.6.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S3.T1.8.6.7.1" class="ltx_text" style="color:#808080;">63.4</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Code Generator</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS2.p1.1" class="ltx_p"><span id="S3.SS2.SSS2.p1.1.1" class="ltx_text ltx_font_bold">Motivation.</span>
The development of the code generator module is driven by the recognition that complex problem-solving often involves an inherent diversity and multiplicity of solutions. Traditional PVQA models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> predominantly focus on generating a singular Python code for a given input query. However, this conventional methodology overlooks the intrinsic variability in problem-solving strategies and fails to capture the diversity of viable solutions that may lead to the correct answer. By introducing the capability to generate multiple Python codes for a single input query, the code generator aims to make full use of potential solutions associated with a given query. This approach is grounded in the understanding that various coding strategies may be employed to achieve the same desired outcome, fostering a more nuanced and adaptable code generation in complex problem-solving domains.</p>
</div>
<div id="S3.SS2.SSS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS2.p2.5" class="ltx_p"><span id="S3.SS2.SSS2.p2.5.1" class="ltx_text ltx_font_bold">Definition.</span>
We define the code generator by</p>
<table id="S6.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.2" class="ltx_Math" alttext="\displaystyle G(r)\triangleq\pi(p_{\text{cg}}+p_{\text{api}}+s_{\text{cg}}+r)," display="inline"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.3.2" xref="S3.E4.m1.2.2.1.1.3.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.3.1" xref="S3.E4.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.3.3.2" xref="S3.E4.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.3.3.2.1" xref="S3.E4.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">r</mi><mo stretchy="false" id="S3.E4.m1.2.2.1.1.3.3.2.2" xref="S3.E4.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml">≜</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.cmml">p</mi><mtext id="S3.E4.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.3a.cmml">cg</mtext></msub><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E4.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.2.cmml">p</mi><mtext id="S3.E4.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.3a.cmml">api</mtext></msub><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1a" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E4.m1.2.2.1.1.1.1.1.1.4" xref="S3.E4.m1.2.2.1.1.1.1.1.1.4.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.4.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.4.2.cmml">s</mi><mtext id="S3.E4.m1.2.2.1.1.1.1.1.1.4.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.4.3a.cmml">cg</mtext></msub><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1b" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.5" xref="S3.E4.m1.2.2.1.1.1.1.1.1.5.cmml">r</mi></mrow><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><ci id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2">≜</ci><apply id="S3.E4.m1.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3"><times id="S3.E4.m1.2.2.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3.1"></times><ci id="S3.E4.m1.2.2.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.2">𝐺</ci><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑟</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><times id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2"></times><ci id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3">𝜋</ci><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1"><plus id="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.2.3a.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E4.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.3">cg</mtext></ci></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.3.3a.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.E4.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.3">api</mtext></ci></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.4.2">𝑠</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.4.3a.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.4.3"><mtext mathsize="70%" id="S3.E4.m1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.4.3">cg</mtext></ci></apply><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.5.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.5">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\displaystyle G(r)\triangleq\pi(p_{\text{cg}}+p_{\text{api}}+s_{\text{cg}}+r),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p2.4" class="ltx_p">where <math id="S3.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><mi id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><ci id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">r</annotation></semantics></math> is a rephrased query, <math id="S3.SS2.SSS2.p2.2.m2.1" class="ltx_Math" alttext="p_{\text{cg}}" display="inline"><semantics id="S3.SS2.SSS2.p2.2.m2.1a"><msub id="S3.SS2.SSS2.p2.2.m2.1.1" xref="S3.SS2.SSS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p2.2.m2.1.1.2" xref="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p2.2.m2.1.1.3" xref="S3.SS2.SSS2.p2.2.m2.1.1.3a.cmml">cg</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.2.m2.1b"><apply id="S3.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.2">𝑝</ci><ci id="S3.SS2.SSS2.p2.2.m2.1.1.3a.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1.3">cg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.2.m2.1c">p_{\text{cg}}</annotation></semantics></math> is the code generator prompt in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2.1 Query Rephraser ‣ 3.2 Module implementation with a single LLM ‣ 3 Proposed Method ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>b, <math id="S3.SS2.SSS2.p2.3.m3.1" class="ltx_Math" alttext="p_{\text{api}}" display="inline"><semantics id="S3.SS2.SSS2.p2.3.m3.1a"><msub id="S3.SS2.SSS2.p2.3.m3.1.1" xref="S3.SS2.SSS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p2.3.m3.1.1.2" xref="S3.SS2.SSS2.p2.3.m3.1.1.2.cmml">p</mi><mtext id="S3.SS2.SSS2.p2.3.m3.1.1.3" xref="S3.SS2.SSS2.p2.3.m3.1.1.3a.cmml">api</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.3.m3.1b"><apply id="S3.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.2">𝑝</ci><ci id="S3.SS2.SSS2.p2.3.m3.1.1.3a.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p2.3.m3.1.1.3">api</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.3.m3.1c">p_{\text{api}}</annotation></semantics></math> is API reference texts detailed in Figure <a href="#S4.F4" title="Figure 4 ‣ 4.1 Experimental Settings ‣ 4 Experiments ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, and <math id="S3.SS2.SSS2.p2.4.m4.1" class="ltx_Math" alttext="s_{\text{cg}}" display="inline"><semantics id="S3.SS2.SSS2.p2.4.m4.1a"><msub id="S3.SS2.SSS2.p2.4.m4.1.1" xref="S3.SS2.SSS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p2.4.m4.1.1.2" xref="S3.SS2.SSS2.p2.4.m4.1.1.2.cmml">s</mi><mtext id="S3.SS2.SSS2.p2.4.m4.1.1.3" xref="S3.SS2.SSS2.p2.4.m4.1.1.3a.cmml">cg</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.4.m4.1b"><apply id="S3.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.2">𝑠</ci><ci id="S3.SS2.SSS2.p2.4.m4.1.1.3a.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p2.4.m4.1.1.3">cg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.4.m4.1c">s_{\text{cg}}</annotation></semantics></math> is the few-shot examples prompt for code generation.</p>
</div>
</section>
<section id="S3.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Answer Aggregator</h4>

<div id="S3.SS2.SSS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS3.p1.1" class="ltx_p"><span id="S3.SS2.SSS3.p1.1.1" class="ltx_text ltx_font_bold">Motivation.</span>
The traditional approach often employs majority voting to aggregate solutions.
However, this approach encounters challenges when failed code execution leads to the default answer being the majority or when multiple answers achieve majority status. In response to these limitations, the answer aggregator utilizes the capabilities of LLMs to select the final output, considering not only the frequency but also the semantic compatibility between the query and potential answers.
The answer aggregator operates in two steps. First, selecting the final answer from the candidate answer set, and then selecting the most suitable code that produced this final answer during pre-execution.
This sequential approach minimizes input token consumption and alleviates potential mismatches between answers and their corresponding code that might be caused by hallucinations.</p>
</div>
<div id="S3.SS2.SSS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.SSS3.p2.1" class="ltx_p"><span id="S3.SS2.SSS3.p2.1.1" class="ltx_text ltx_font_bold">Definition.</span>
Given a set of candidate answers and codes <math id="S3.SS2.SSS3.p2.1.m1.1" class="ltx_Math" alttext="Z=\{(z_{k},a_{k})\}_{k=1}^{O}" display="inline"><semantics id="S3.SS2.SSS3.p2.1.m1.1a"><mrow id="S3.SS2.SSS3.p2.1.m1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.1.1.3" xref="S3.SS2.SSS3.p2.1.m1.1.1.3.cmml">Z</mi><mo id="S3.SS2.SSS3.p2.1.m1.1.1.2" xref="S3.SS2.SSS3.p2.1.m1.1.1.2.cmml">=</mo><msubsup id="S3.SS2.SSS3.p2.1.m1.1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.cmml"><mrow id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.4" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">a</mi><mi id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.5" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.2" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.2.cmml">k</mi><mo id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.3" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS3.p2.1.m1.1.1.1.3" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.3.cmml">O</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.1.m1.1b"><apply id="S3.SS2.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1"><eq id="S3.SS2.SSS3.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.2"></eq><ci id="S3.SS2.SSS3.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.3">𝑍</ci><apply id="S3.SS2.SSS3.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1">subscript</csymbol><set id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1"><interval closure="open" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2"><apply id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2.2">𝑎</ci><ci id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply></interval></set><apply id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3"><eq id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.1"></eq><ci id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS3.p2.1.m1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.3">𝑂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.1.m1.1c">Z=\{(z_{k},a_{k})\}_{k=1}^{O}</annotation></semantics></math>, we define the answer aggregator by</p>
<table id="S6.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\displaystyle A_{\text{ans}}(Z)" display="inline"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.2" xref="S3.E5.m1.1.2.cmml"><msub id="S3.E5.m1.1.2.2" xref="S3.E5.m1.1.2.2.cmml"><mi id="S3.E5.m1.1.2.2.2" xref="S3.E5.m1.1.2.2.2.cmml">A</mi><mtext id="S3.E5.m1.1.2.2.3" xref="S3.E5.m1.1.2.2.3a.cmml">ans</mtext></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.2.1" xref="S3.E5.m1.1.2.1.cmml">​</mo><mrow id="S3.E5.m1.1.2.3.2" xref="S3.E5.m1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.1.2.3.2.1" xref="S3.E5.m1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">Z</mi><mo stretchy="false" id="S3.E5.m1.1.2.3.2.2" xref="S3.E5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.2.cmml" xref="S3.E5.m1.1.2"><times id="S3.E5.m1.1.2.1.cmml" xref="S3.E5.m1.1.2.1"></times><apply id="S3.E5.m1.1.2.2.cmml" xref="S3.E5.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.2.2.1.cmml" xref="S3.E5.m1.1.2.2">subscript</csymbol><ci id="S3.E5.m1.1.2.2.2.cmml" xref="S3.E5.m1.1.2.2.2">𝐴</ci><ci id="S3.E5.m1.1.2.2.3a.cmml" xref="S3.E5.m1.1.2.2.3"><mtext mathsize="70%" id="S3.E5.m1.1.2.2.3.cmml" xref="S3.E5.m1.1.2.2.3">ans</mtext></ci></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\displaystyle A_{\text{ans}}(Z)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5.m2.2" class="ltx_Math" alttext="\displaystyle\triangleq\pi(p_{\text{aga}}+[a_{1},a_{2},\cdots,a_{O}])," display="inline"><semantics id="S3.E5.m2.2a"><mrow id="S3.E5.m2.2.2.1" xref="S3.E5.m2.2.2.1.1.cmml"><mrow id="S3.E5.m2.2.2.1.1" xref="S3.E5.m2.2.2.1.1.cmml"><mi id="S3.E5.m2.2.2.1.1.3" xref="S3.E5.m2.2.2.1.1.3.cmml"></mi><mo id="S3.E5.m2.2.2.1.1.2" xref="S3.E5.m2.2.2.1.1.2.cmml">≜</mo><mrow id="S3.E5.m2.2.2.1.1.1" xref="S3.E5.m2.2.2.1.1.1.cmml"><mi id="S3.E5.m2.2.2.1.1.1.3" xref="S3.E5.m2.2.2.1.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E5.m2.2.2.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m2.2.2.1.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m2.2.2.1.1.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m2.2.2.1.1.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E5.m2.2.2.1.1.1.1.1.1.5" xref="S3.E5.m2.2.2.1.1.1.1.1.1.5.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.5.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.5.2.cmml">p</mi><mtext id="S3.E5.m2.2.2.1.1.1.1.1.1.5.3" xref="S3.E5.m2.2.2.1.1.1.1.1.1.5.3a.cmml">aga</mtext></msub><mo id="S3.E5.m2.2.2.1.1.1.1.1.1.4" xref="S3.E5.m2.2.2.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.4.cmml"><mo stretchy="false" id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.4" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.4.cmml">[</mo><msub id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mn id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.5" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml">a</mi><mn id="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2.3" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.6" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E5.m2.1.1" xref="S3.E5.m2.1.1.cmml">⋯</mi><mo id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.7" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3.2" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3.2.cmml">a</mi><mi id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3.3" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3.3.cmml">O</mi></msub><mo stretchy="false" id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.8" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.4.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E5.m2.2.2.1.1.1.1.1.3" xref="S3.E5.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m2.2.2.1.2" xref="S3.E5.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m2.2b"><apply id="S3.E5.m2.2.2.1.1.cmml" xref="S3.E5.m2.2.2.1"><ci id="S3.E5.m2.2.2.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.2">≜</ci><csymbol cd="latexml" id="S3.E5.m2.2.2.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.3">absent</csymbol><apply id="S3.E5.m2.2.2.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1"><times id="S3.E5.m2.2.2.1.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.2"></times><ci id="S3.E5.m2.2.2.1.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.1.3">𝜋</ci><apply id="S3.E5.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1"><plus id="S3.E5.m2.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.4"></plus><apply id="S3.E5.m2.2.2.1.1.1.1.1.1.5.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.1.1.1.1.1.1.5.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.5.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.5.2">𝑝</ci><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.5.3a.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.5.3"><mtext mathsize="70%" id="S3.E5.m2.2.2.1.1.1.1.1.1.5.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.5.3">aga</mtext></ci></apply><list id="S3.E5.m2.2.2.1.1.1.1.1.1.3.4.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.3"><apply id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.2">𝑎</ci><cn type="integer" id="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2.2">𝑎</ci><cn type="integer" id="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S3.E5.m2.1.1.cmml" xref="S3.E5.m2.1.1">⋯</ci><apply id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3.2">𝑎</ci><ci id="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m2.2.2.1.1.1.1.1.1.3.3.3.3">𝑂</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m2.2c">\displaystyle\triangleq\pi(p_{\text{aga}}+[a_{1},a_{2},\cdots,a_{O}]),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\displaystyle A_{\text{code}}(Z_{\bm{\sigma}})" display="inline"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msub id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml">A</mi><mtext id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3a.cmml">code</mtext></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">Z</mi><mi id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml">𝝈</mi></msub><mo stretchy="false" id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><times id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"></times><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2">𝐴</ci><ci id="S3.E6.m1.1.1.3.3a.cmml" xref="S3.E6.m1.1.1.3.3"><mtext mathsize="70%" id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3">code</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2">𝑍</ci><ci id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3">𝝈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle A_{\text{code}}(Z_{\bm{\sigma}})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6.m2.2" class="ltx_Math" alttext="\displaystyle\triangleq\pi(p_{\text{agc}}+[z_{\sigma_{1}},z_{\sigma_{2}},\cdots,z_{\sigma_{l}}])," display="inline"><semantics id="S3.E6.m2.2a"><mrow id="S3.E6.m2.2.2.1" xref="S3.E6.m2.2.2.1.1.cmml"><mrow id="S3.E6.m2.2.2.1.1" xref="S3.E6.m2.2.2.1.1.cmml"><mi id="S3.E6.m2.2.2.1.1.3" xref="S3.E6.m2.2.2.1.1.3.cmml"></mi><mo id="S3.E6.m2.2.2.1.1.2" xref="S3.E6.m2.2.2.1.1.2.cmml">≜</mo><mrow id="S3.E6.m2.2.2.1.1.1" xref="S3.E6.m2.2.2.1.1.1.cmml"><mi id="S3.E6.m2.2.2.1.1.1.3" xref="S3.E6.m2.2.2.1.1.1.3.cmml">π</mi><mo lspace="0em" rspace="0em" id="S3.E6.m2.2.2.1.1.1.2" xref="S3.E6.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m2.2.2.1.1.1.1.1" xref="S3.E6.m2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m2.2.2.1.1.1.1.1.2" xref="S3.E6.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m2.2.2.1.1.1.1.1.1" xref="S3.E6.m2.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E6.m2.2.2.1.1.1.1.1.1.5" xref="S3.E6.m2.2.2.1.1.1.1.1.1.5.cmml"><mi id="S3.E6.m2.2.2.1.1.1.1.1.1.5.2" xref="S3.E6.m2.2.2.1.1.1.1.1.1.5.2.cmml">p</mi><mtext id="S3.E6.m2.2.2.1.1.1.1.1.1.5.3" xref="S3.E6.m2.2.2.1.1.1.1.1.1.5.3a.cmml">agc</mtext></msub><mo id="S3.E6.m2.2.2.1.1.1.1.1.1.4" xref="S3.E6.m2.2.2.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.4.cmml"><mo stretchy="false" id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.4" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.4.cmml">[</mo><msub id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><msub id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">σ</mi><mn id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.5" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml">z</mi><msub id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml">σ</mi><mn id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.6" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E6.m2.1.1" xref="S3.E6.m2.1.1.cmml">⋯</mi><mo id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.7" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.2" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.2.cmml">z</mi><msub id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3.2" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3.2.cmml">σ</mi><mi id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3.3" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3.3.cmml">l</mi></msub></msub><mo stretchy="false" id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.8" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.4.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m2.2.2.1.1.1.1.1.3" xref="S3.E6.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m2.2.2.1.2" xref="S3.E6.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m2.2b"><apply id="S3.E6.m2.2.2.1.1.cmml" xref="S3.E6.m2.2.2.1"><ci id="S3.E6.m2.2.2.1.1.2.cmml" xref="S3.E6.m2.2.2.1.1.2">≜</ci><csymbol cd="latexml" id="S3.E6.m2.2.2.1.1.3.cmml" xref="S3.E6.m2.2.2.1.1.3">absent</csymbol><apply id="S3.E6.m2.2.2.1.1.1.cmml" xref="S3.E6.m2.2.2.1.1.1"><times id="S3.E6.m2.2.2.1.1.1.2.cmml" xref="S3.E6.m2.2.2.1.1.1.2"></times><ci id="S3.E6.m2.2.2.1.1.1.3.cmml" xref="S3.E6.m2.2.2.1.1.1.3">𝜋</ci><apply id="S3.E6.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1"><plus id="S3.E6.m2.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.4"></plus><apply id="S3.E6.m2.2.2.1.1.1.1.1.1.5.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E6.m2.2.2.1.1.1.1.1.1.5.1.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E6.m2.2.2.1.1.1.1.1.1.5.2.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.5.2">𝑝</ci><ci id="S3.E6.m2.2.2.1.1.1.1.1.1.5.3a.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.5.3"><mtext mathsize="70%" id="S3.E6.m2.2.2.1.1.1.1.1.1.5.3.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.5.3">agc</mtext></ci></apply><list id="S3.E6.m2.2.2.1.1.1.1.1.1.3.4.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3"><apply id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3.2">𝜎</ci><cn type="integer" id="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.2">𝑧</ci><apply id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3.2">𝜎</ci><cn type="integer" id="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.2.2.2.3.3">2</cn></apply></apply><ci id="S3.E6.m2.1.1.cmml" xref="S3.E6.m2.1.1">⋯</ci><apply id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.2">𝑧</ci><apply id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3.2">𝜎</ci><ci id="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E6.m2.2.2.1.1.1.1.1.1.3.3.3.3.3">𝑙</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m2.2c">\displaystyle\triangleq\pi(p_{\text{agc}}+[z_{\sigma_{1}},z_{\sigma_{2}},\cdots,z_{\sigma_{l}}]),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.p2.7" class="ltx_p">where <math id="S3.SS2.SSS3.p2.2.m1.1" class="ltx_Math" alttext="p_{\text{aga}}" display="inline"><semantics id="S3.SS2.SSS3.p2.2.m1.1a"><msub id="S3.SS2.SSS3.p2.2.m1.1.1" xref="S3.SS2.SSS3.p2.2.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.2.m1.1.1.2" xref="S3.SS2.SSS3.p2.2.m1.1.1.2.cmml">p</mi><mtext id="S3.SS2.SSS3.p2.2.m1.1.1.3" xref="S3.SS2.SSS3.p2.2.m1.1.1.3a.cmml">aga</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.2.m1.1b"><apply id="S3.SS2.SSS3.p2.2.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.2.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.2.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.2.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.2.m1.1.1.2">𝑝</ci><ci id="S3.SS2.SSS3.p2.2.m1.1.1.3a.cmml" xref="S3.SS2.SSS3.p2.2.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS3.p2.2.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.2.m1.1.1.3">aga</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.2.m1.1c">p_{\text{aga}}</annotation></semantics></math> is the prompt used by the answer aggregator to select the final answer shown in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2.1 Query Rephraser ‣ 3.2 Module implementation with a single LLM ‣ 3 Proposed Method ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>c, and <math id="S3.SS2.SSS3.p2.3.m2.1" class="ltx_Math" alttext="p_{\text{agc}}" display="inline"><semantics id="S3.SS2.SSS3.p2.3.m2.1a"><msub id="S3.SS2.SSS3.p2.3.m2.1.1" xref="S3.SS2.SSS3.p2.3.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p2.3.m2.1.1.2" xref="S3.SS2.SSS3.p2.3.m2.1.1.2.cmml">p</mi><mtext id="S3.SS2.SSS3.p2.3.m2.1.1.3" xref="S3.SS2.SSS3.p2.3.m2.1.1.3a.cmml">agc</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.3.m2.1b"><apply id="S3.SS2.SSS3.p2.3.m2.1.1.cmml" xref="S3.SS2.SSS3.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.3.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p2.3.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.3.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p2.3.m2.1.1.2">𝑝</ci><ci id="S3.SS2.SSS3.p2.3.m2.1.1.3a.cmml" xref="S3.SS2.SSS3.p2.3.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS3.p2.3.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p2.3.m2.1.1.3">agc</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.3.m2.1c">p_{\text{agc}}</annotation></semantics></math> is the prompt to choose the best code shown in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2.1 Query Rephraser ‣ 3.2 Module implementation with a single LLM ‣ 3 Proposed Method ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>d. The operation [] represents the aggregation of elements into a list and the conversion to string format. <math id="S3.SS2.SSS3.p2.4.m3.1" class="ltx_Math" alttext="Z_{\bm{\sigma}}=\{z_{\sigma_{l}}\}_{l=1}^{L}" display="inline"><semantics id="S3.SS2.SSS3.p2.4.m3.1a"><mrow id="S3.SS2.SSS3.p2.4.m3.1.1" xref="S3.SS2.SSS3.p2.4.m3.1.1.cmml"><msub id="S3.SS2.SSS3.p2.4.m3.1.1.3" xref="S3.SS2.SSS3.p2.4.m3.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.4.m3.1.1.3.2" xref="S3.SS2.SSS3.p2.4.m3.1.1.3.2.cmml">Z</mi><mi id="S3.SS2.SSS3.p2.4.m3.1.1.3.3" xref="S3.SS2.SSS3.p2.4.m3.1.1.3.3.cmml">𝝈</mi></msub><mo id="S3.SS2.SSS3.p2.4.m3.1.1.2" xref="S3.SS2.SSS3.p2.4.m3.1.1.2.cmml">=</mo><msubsup id="S3.SS2.SSS3.p2.4.m3.1.1.1" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.cmml"><mrow id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.2.cmml">z</mi><msub id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3.2" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3.2.cmml">σ</mi><mi id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3.3" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3.3.cmml">l</mi></msub></msub><mo stretchy="false" id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.2" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.2.cmml">l</mi><mo id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.1" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.3" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS3.p2.4.m3.1.1.1.3" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.3.cmml">L</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.4.m3.1b"><apply id="S3.SS2.SSS3.p2.4.m3.1.1.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1"><eq id="S3.SS2.SSS3.p2.4.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.2"></eq><apply id="S3.SS2.SSS3.p2.4.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.4.m3.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS3.p2.4.m3.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.3.2">𝑍</ci><ci id="S3.SS2.SSS3.p2.4.m3.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.3.3">𝝈</ci></apply><apply id="S3.SS2.SSS3.p2.4.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.4.m3.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1">subscript</csymbol><set id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1"><apply id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3.2">𝜎</ci><ci id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></set><apply id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3"><eq id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.1"></eq><ci id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS3.p2.4.m3.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.4.m3.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.4.m3.1c">Z_{\bm{\sigma}}=\{z_{\sigma_{l}}\}_{l=1}^{L}</annotation></semantics></math> is a subset of <math id="S3.SS2.SSS3.p2.5.m4.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S3.SS2.SSS3.p2.5.m4.1a"><mi id="S3.SS2.SSS3.p2.5.m4.1.1" xref="S3.SS2.SSS3.p2.5.m4.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.5.m4.1b"><ci id="S3.SS2.SSS3.p2.5.m4.1.1.cmml" xref="S3.SS2.SSS3.p2.5.m4.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.5.m4.1c">Z</annotation></semantics></math>, where <math id="S3.SS2.SSS3.p2.6.m5.1" class="ltx_Math" alttext="\bm{\sigma}=\{\sigma_{l}\}_{l=1}^{L}" display="inline"><semantics id="S3.SS2.SSS3.p2.6.m5.1a"><mrow id="S3.SS2.SSS3.p2.6.m5.1.1" xref="S3.SS2.SSS3.p2.6.m5.1.1.cmml"><mi id="S3.SS2.SSS3.p2.6.m5.1.1.3" xref="S3.SS2.SSS3.p2.6.m5.1.1.3.cmml">𝝈</mi><mo id="S3.SS2.SSS3.p2.6.m5.1.1.2" xref="S3.SS2.SSS3.p2.6.m5.1.1.2.cmml">=</mo><msubsup id="S3.SS2.SSS3.p2.6.m5.1.1.1" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.cmml"><mrow id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1.2.cmml">σ</mi><mi id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.2" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.2.cmml">l</mi><mo id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.1" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.3" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS3.p2.6.m5.1.1.1.3" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.3.cmml">L</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.6.m5.1b"><apply id="S3.SS2.SSS3.p2.6.m5.1.1.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1"><eq id="S3.SS2.SSS3.p2.6.m5.1.1.2.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.2"></eq><ci id="S3.SS2.SSS3.p2.6.m5.1.1.3.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.3">𝝈</ci><apply id="S3.SS2.SSS3.p2.6.m5.1.1.1.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.6.m5.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1">subscript</csymbol><set id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1"><apply id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1.2">𝜎</ci><ci id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3"><eq id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.1"></eq><ci id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS3.p2.6.m5.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.6.m5.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.6.m5.1c">\bm{\sigma}=\{\sigma_{l}\}_{l=1}^{L}</annotation></semantics></math> is the output of <math id="S3.SS2.SSS3.p2.7.m6.1" class="ltx_Math" alttext="A_{\text{ans}}" display="inline"><semantics id="S3.SS2.SSS3.p2.7.m6.1a"><msub id="S3.SS2.SSS3.p2.7.m6.1.1" xref="S3.SS2.SSS3.p2.7.m6.1.1.cmml"><mi id="S3.SS2.SSS3.p2.7.m6.1.1.2" xref="S3.SS2.SSS3.p2.7.m6.1.1.2.cmml">A</mi><mtext id="S3.SS2.SSS3.p2.7.m6.1.1.3" xref="S3.SS2.SSS3.p2.7.m6.1.1.3a.cmml">ans</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.7.m6.1b"><apply id="S3.SS2.SSS3.p2.7.m6.1.1.cmml" xref="S3.SS2.SSS3.p2.7.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.7.m6.1.1.1.cmml" xref="S3.SS2.SSS3.p2.7.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.7.m6.1.1.2.cmml" xref="S3.SS2.SSS3.p2.7.m6.1.1.2">𝐴</ci><ci id="S3.SS2.SSS3.p2.7.m6.1.1.3a.cmml" xref="S3.SS2.SSS3.p2.7.m6.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS3.p2.7.m6.1.1.3.cmml" xref="S3.SS2.SSS3.p2.7.m6.1.1.3">ans</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.7.m6.1c">A_{\text{ans}}</annotation></semantics></math> and represents the set of code indices where the pre-execution output for the code matches the selected answer.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Settings</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Datasets and evaluation metrics.</span>
Three VQA datasets, namely GQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, VQAv2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, and NLVR2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, are employed for assessment in the conducted experiment.
The GQA dataset is known for its challenging questions that involve spatial reasoning, commonsense reasoning, and an understanding of image details.
The VQAv2 dataset comprises images from the COCO dataset paired with open-ended questions. The questions exhibit a range of complexities and topics, and answers are expected to be provided in free-form text. The NLVR2 dataset consists of statements about pairs of images, each annotated as true or false based on the image content. For our experiments, these statements are reformulated into a query format.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">Following the baseline method, 12 in-context examples are sampled to construct the in-context prompt for the GQA and VQAv2 datasets, while 6 examples are used for the NLVR2 dataset. To conserve computational resources, for certain datasets, we utilize the same randomly sampled subset as the baseline for evaluation purposes. In the results table, GQA val2000 consists of a subset of 2000 samples randomly selected from the GQA validation set, and VQAv2 val4000 comprises 4000 examples randomly sampled from the VQAv2 validation set. The evaluation metric is the exact match accuracy for case-insensitive answers.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2407.20563/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="460" height="345" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.4.1.1" class="ltx_text ltx_font_bold">Fig. 4</span>: </span>API reference <math id="S4.F4.2.m1.1" class="ltx_Math" alttext="p_{\text{api}}" display="inline"><semantics id="S4.F4.2.m1.1b"><msub id="S4.F4.2.m1.1.1" xref="S4.F4.2.m1.1.1.cmml"><mi id="S4.F4.2.m1.1.1.2" xref="S4.F4.2.m1.1.1.2.cmml">p</mi><mtext id="S4.F4.2.m1.1.1.3" xref="S4.F4.2.m1.1.1.3a.cmml">api</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.F4.2.m1.1c"><apply id="S4.F4.2.m1.1.1.cmml" xref="S4.F4.2.m1.1.1"><csymbol cd="ambiguous" id="S4.F4.2.m1.1.1.1.cmml" xref="S4.F4.2.m1.1.1">subscript</csymbol><ci id="S4.F4.2.m1.1.1.2.cmml" xref="S4.F4.2.m1.1.1.2">𝑝</ci><ci id="S4.F4.2.m1.1.1.3a.cmml" xref="S4.F4.2.m1.1.1.3"><mtext mathsize="70%" id="S4.F4.2.m1.1.1.3.cmml" xref="S4.F4.2.m1.1.1.3">api</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.m1.1d">p_{\text{api}}</annotation></semantics></math>.</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation Details</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.2" class="ltx_p"><span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_bold">Frozen LLM <math id="S4.SS2.p1.1.1.m1.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S4.SS2.p1.1.1.m1.1a"><mi id="S4.SS2.p1.1.1.m1.1.1" xref="S4.SS2.p1.1.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.1.m1.1b"><ci id="S4.SS2.p1.1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.1.m1.1c">\pi</annotation></semantics></math>.</span>
PyramidCoder exhibits insensitivity to the underlying base LLM model <math id="S4.SS2.p1.2.m1.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S4.SS2.p1.2.m1.1a"><mi id="S4.SS2.p1.2.m1.1.1" xref="S4.SS2.p1.2.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m1.1b"><ci id="S4.SS2.p1.2.m1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m1.1c">\pi</annotation></semantics></math>. In our evaluation, we employ one closed general LLM, namely, GPT-3.5 (<span id="S4.SS2.p1.2.2" class="ltx_text ltx_font_typewriter" style="font-size:90%;">gpt-3.5-turbo</span>) available through the OpenAI API, and two open-source Code LLMs: StarCoderBase <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and CodeLlama-7b-Python <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.1" class="ltx_p"><span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_bold">Framework and APIs.</span>
We validate the efficacy of our approach by employing the state-of-the-art PVQA model, CodeVQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, as our baseline framework. Utilizing identical image processing modules as those employed in CodeVQA, we use GroundingDINO<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> for object detection through <span id="S4.SS2.p2.1.2" class="ltx_text ltx_font_typewriter">get_object_boxes()</span>. For image captioning, we utilize BLIP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> within <span id="S4.SS2.p2.1.3" class="ltx_text ltx_font_typewriter">query()</span>. Additionally, the question-answering module incorporated within <span id="S4.SS2.p2.1.4" class="ltx_text ltx_font_typewriter">query()</span> employs the same LLM as the one used in the code generation stage.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.2.1.1" class="ltx_text ltx_font_bold">Table 2</span>: </span>Comparison with state-of-the-art prompting methods.</figcaption>
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.3.1.1" class="ltx_tr">
<th id="S4.T2.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">Method</th>
<th id="S4.T2.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">GQA</th>
<th id="S4.T2.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">VQAv2</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.3.2.1" class="ltx_tr">
<td id="S4.T2.3.2.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">Input-Output (Default)</td>
<td id="S4.T2.3.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">48.0</td>
<td id="S4.T2.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">61.3</td>
</tr>
<tr id="S4.T2.3.3.2" class="ltx_tr">
<td id="S4.T2.3.3.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">Chain-of-Thought <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>
</td>
<td id="S4.T2.3.3.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">48.3</td>
<td id="S4.T2.3.3.2.3" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">61.0</td>
</tr>
<tr id="S4.T2.3.4.3" class="ltx_tr">
<td id="S4.T2.3.4.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">Tree of Thoughts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S4.T2.3.4.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">48.7</td>
<td id="S4.T2.3.4.3.3" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">61.5</td>
</tr>
<tr id="S4.T2.3.5.4" class="ltx_tr">
<td id="S4.T2.3.5.4.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">PyramidCoder (Ours)</td>
<td id="S4.T2.3.5.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S4.T2.3.5.4.2.1" class="ltx_text ltx_font_bold">51.3</span></td>
<td id="S4.T2.3.5.4.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S4.T2.3.5.4.3.1" class="ltx_text ltx_font_bold">62.8</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.2.1.1" class="ltx_text ltx_font_bold">Table 3</span>: </span>Results using different LLMs on GQA val2000. IO is the default strategy used in CodeVQA.</figcaption>
<table id="S4.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.3.1.1" class="ltx_tr">
<th id="S4.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">LLM</th>
<th id="S4.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">IO</th>
<th id="S4.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">Ours</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.3.2.1" class="ltx_tr">
<th id="S4.T3.3.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">gpt3.5-turbo</th>
<td id="S4.T3.3.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">46.6</td>
<td id="S4.T3.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S4.T3.3.2.1.3.1" class="ltx_text ltx_font_bold">55.8</span></td>
</tr>
<tr id="S4.T3.3.3.2" class="ltx_tr">
<th id="S4.T3.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">StarCoder-Base</th>
<td id="S4.T3.3.3.2.2" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">46.5</td>
<td id="S4.T3.3.3.2.3" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S4.T3.3.3.2.3.1" class="ltx_text ltx_font_bold">48.2</span></td>
</tr>
<tr id="S4.T3.3.4.3" class="ltx_tr">
<th id="S4.T3.3.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">CodeLlama-7b</th>
<td id="S4.T3.3.4.3.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:9.0pt;padding-right:9.0pt;">48.0</td>
<td id="S4.T3.3.4.3.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S4.T3.3.4.3.3.1" class="ltx_text ltx_font_bold">51.3</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.2.1.1" class="ltx_text ltx_font_bold">Table 4</span>: </span>Ablation study with respect to the three modules.</figcaption>
<table id="S4.T4.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.3.1.1" class="ltx_tr">
<th id="S4.T4.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">Method</th>
<th id="S4.T4.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">GQA</th>
<th id="S4.T4.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">VQAv2</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.3.2.1" class="ltx_tr">
<th id="S4.T4.3.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">PyramidCoder</th>
<td id="S4.T4.3.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">51.3</td>
<td id="S4.T4.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">62.8</td>
</tr>
<tr id="S4.T4.3.3.2" class="ltx_tr">
<th id="S4.T4.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">w/o query rephraser</th>
<td id="S4.T4.3.3.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">47.8</td>
<td id="S4.T4.3.3.2.3" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">61.0</td>
</tr>
<tr id="S4.T4.3.4.3" class="ltx_tr">
<th id="S4.T4.3.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">w/o code generator</th>
<td id="S4.T4.3.4.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">49.4</td>
<td id="S4.T4.3.4.3.3" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">61.0</td>
</tr>
<tr id="S4.T4.3.5.4" class="ltx_tr">
<th id="S4.T4.3.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">w/o answer aggregator</th>
<td id="S4.T4.3.5.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">51.0</td>
<td id="S4.T4.3.5.4.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:9.0pt;padding-right:9.0pt;">62.1</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results and Analysis</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p"><span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_bold">VQA performance.</span>
Table <a href="#S3.T1" title="Table 1 ‣ 3.2.1 Query Rephraser ‣ 3.2 Module implementation with a single LLM ‣ 3 Proposed Method ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> lists the performance across three VQA datasets. Our baseline is the state-of-the-art CodeVQA model, which uses default IO prompting. The same settings and APIs are utilized for all experiments. Compared with the baseline, PyramidCoder demonstrates relative improvements of a minimum of 1.65 points on the GQA val2000 set, 0.5 points on the GQA test set, 1.4 points on the VQAv2 val4000 set, and 2.9 points on the NLVR2 test set. These results indicate the effectiveness of PyramidCoder, which maintains its performance across a variety of underlying LLMs and datasets.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">Prompting Methods.</span>
Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> provides a comparative analysis of our PyramidCoder against existing prompting methodologies, namely few-shot CoT and few-shot ToT with a creative writing setup. All methods employ identical in-context examples and few-shot configurations as described earlier. While the preceding prompting techniques show improvements in comparison to default IO prompting, they tend to generate homogeneous codes. In contrast, PyramidCoder surpasses these methods by producing diverse code candidates, which provides more substantial reasoning evidence.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.1" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">Analysis by question type.</span>
Figure <a href="#S4.F5" title="Figure 5 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> illustrates the QA accuracy across diverse question types within the GQA val2000 dataset.
The improvements are particularly evident in addressing logical questions involving logical inference, choose questions characterized by the inclusion of alternative options within the query, and compare questions requiring comparisons between two or more objects. These findings reveal the model’s proficiency in handling queries necessitating intricate reasoning and comprehension of visual content. Moreover, PyramidCoder demonstrates heightened performance even in addressing simpler question types, such as verify questions that require binary responses (yes/no) and queries involving open-ended questions. This comprehensive enhancement underscores the versatility and efficacy of the PyramidCoder in diverse question-answering scenarios.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2407.20563/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="218" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.2.1.1" class="ltx_text ltx_font_bold">Fig. 5</span>: </span>QA Accuracy by question type.</figcaption>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2407.20563/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="200" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.2.1.1" class="ltx_text ltx_font_bold">Fig. 6</span>: </span>Qualitative examples</figcaption>
</figure>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.1" class="ltx_p"><span id="S4.SS3.p4.1.1" class="ltx_text ltx_font_bold">LLM.</span>
Table <a href="#S4.T3" title="Table 3 ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the performance of PyramidCoder using different LLMs on the GQA val2000 dataset. Besides the results listed in Table <a href="#S3.T1" title="Table 1 ‣ 3.2.1 Query Rephraser ‣ 3.2 Module implementation with a single LLM ‣ 3 Proposed Method ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we also include results using GPT-3.5, a private general LLM, for code generation to measure its performance.
The results summarized in Table <a href="#S4.T3" title="Table 3 ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> demonstrate that PyramidCoder consistently improves performance across diverse LLMs.
This consistency highlights that PyramidCoder is independent of the employed LLM, as stronger LLMs usually lead to better performance. Remarkably, PyramidCoder exhibits versatility by performing well with both closed and open-source LLMs, as well as with models designed for general and code-specific tasks.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para ltx_noindent">
<p id="S4.SS3.p5.1" class="ltx_p"><span id="S4.SS3.p5.1.1" class="ltx_text ltx_font_bold">Ablation study.</span>
The ablation study is conducted on the sampled GQA and VQAv2 datasets, and the results are summarized in Table <a href="#S4.T4" title="Table 4 ‣ 4.2 Implementation Details ‣ 4 Experiments ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. The first row shows the performance of the complete PyramidCoder. To show the significance of each component, the query rephraser, code generator, and answer aggregator are individually omitted from the whole framework. The results clearly indicate that the exclusion of any of these modules leads to a noticeable decrease in the VQA accuracy across both datasets.</p>
</div>
<div id="S4.SS3.p6" class="ltx_para ltx_noindent">
<p id="S4.SS3.p6.1" class="ltx_p"><span id="S4.SS3.p6.1.1" class="ltx_text ltx_font_bold">Qualitative examples.</span>
Figure <a href="#S4.F6" title="Figure 6 ‣ 4.3 Results and Analysis ‣ 4 Experiments ‣ Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> illustrates the diversified code generation capabilities of PyramidCoder. When confronted with queries of distinct content, the generated code exhibits varying levels of complexity and employs different APIs to construct disparate code solutions.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we proposed PyramidCoder, a prompting framework designed for compositional visual question answering. This framework operates through query rephrasing, code candidate generation, and answer aggregation facilitated by three distinct modules.
A key feature of this framework is its use of a single frozen LLM and predefined prompts at each level, eliminating the need for additional training and ensuring flexibility across different LLM architectures. Experimental evaluations conducted on three VQA datasets demonstrate its efficacy.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Acknowledgements</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">This work was supported by JSPS KAKENHI Grant Number JP23H00490 and NEDO JPNP18002.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
D. A. Hudson and C. D. Manning,

</span>
<span class="ltx_bibblock">“Gqa: A new dataset for real-world visual reasoning and compositional question answering,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Proc. IEEE/CVF International Conference on Computer Vision (ICCV)</span>, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Y. Goyal, T. Khot, et al.,

</span>
<span class="ltx_bibblock">“Making the v in vqa matter: Elevating the role of image understanding in visual question answering,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Proc. IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</span>, 2017, pp. 6904–6913.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
A. Suhr, S. Zhou, A. Zhang, I. Zhang, H. Bai, and Y. Artzi,

</span>
<span class="ltx_bibblock">“A corpus for reasoning about natural language grounded in photographs,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Proc. Annual Meeting of the Association for Computational Linguistics (ACL)</span>, 2019, pp. 6418–6428.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
L. H. Li, P. Zhang, H. Zhang, J. Yang, C. Li, Y. Zhong, L. Wang, L. Yuan, L. Zhang, J.-N. Hwang, et al.,

</span>
<span class="ltx_bibblock">“Grounded language-image pre-training,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Proc. IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</span>, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
A. M. H. Tiong, J. Li, B. Li, S. Savarese, et al.,

</span>
<span class="ltx_bibblock">“Plug-and-play vqa: Zero-shot vqa by conjoining large pre-trained models with zero training,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Proc. Findings of Empirical Methods in Natural Language Processing (EMNLP Findings)</span>, 2022.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
D. Surís, S. Menon, and C. Vondrick,

</span>
<span class="ltx_bibblock">“ViperGPT: Visual inference via python execution for reasoning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">arXiv:2303.08128</span>, 2023.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
T. Gupta and A. Kembhavi,

</span>
<span class="ltx_bibblock">“Visual programming: Compositional visual reasoning without training,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Proc. IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</span>, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
S. Subramanian, M. Narasimhan, et al.,

</span>
<span class="ltx_bibblock">“Modular visual question answering via code generation,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Proc. Annual Meeting of the Association for Computational Linguistics (ACL)</span>, 2023.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
J. Wei, X. Wang, D. Schuurmans, et al.,

</span>
<span class="ltx_bibblock">“Chain-of-thought prompting elicits reasoning in large language models,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Proc. Annual Conference on Neural Information Processing Systems (NeurIPS)</span>, 2022.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
S. Yao, D. Yu, J. Zhao, et al.,

</span>
<span class="ltx_bibblock">“Tree of Thoughts: Deliberate problem solving with large language models,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proc. Annual Conference on Neural Information Processing Systems (NeurIPS)</span>, 2023.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
M. Malinowski, M. Rohrbach, and M. Fritz,

</span>
<span class="ltx_bibblock">“Ask your neurons: A neural-based approach to answering questions about images,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Proc. IEEE/CVF International Conference on Computer Vision (ICCV)</span>, 2015, pp. 1–9.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Z. Huang, H. Zhu, Y. Sun, et al.,

</span>
<span class="ltx_bibblock">“A diagnostic study of visual question answering with analogical reasoning,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Proc. IEEE International Conference on Image Processing (ICIP)</span>, 2021, pp. 2463–2467.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
H. Zhang and W. Wu,

</span>
<span class="ltx_bibblock">“Context relation fusion model for visual question answering,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Proc. IEEE International Conference on Image Processing (ICIP)</span>, 2022, pp. 2112–2116.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Z. Yang, X. He, J. Gao, et al.,

</span>
<span class="ltx_bibblock">“Stacked attention networks for image question answering,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Proc. IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</span>, 2016.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
P. Anderson, X. He, C. Buehler, et al.,

</span>
<span class="ltx_bibblock">“Bottom-up and top-down attention for image captioning and visual question answering,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Proc. IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</span>, 2018, pp. 6077–6086.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
A. Sarkar and M. Rahnemoonfar,

</span>
<span class="ltx_bibblock">“Grad-CAM aware supervised attention for visual question answering for post-disaster damage assessment,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Proc. IEEE International Conference on Image Processing (ICIP)</span>, 2022, pp. 3783–3787.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
X. Wu, J. Lu, Z. Li, and F. Xiong,

</span>
<span class="ltx_bibblock">“Ques-to-visual guided visual question answering,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Proc. IEEE International Conference on Image Processing (ICIP)</span>, 2022, pp. 4193–4197.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
R. Shen, N. Inoue, and K. Shinoda,

</span>
<span class="ltx_bibblock">“Text-guided object detector for multi-modal video question answering,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Proc. IEEE Conference on Winter Conference on Applications of Computer Vision (WACV)</span>, 2023, pp. 1032–1042.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
L. H. Li, H. You, Z. Wang, et al.,

</span>
<span class="ltx_bibblock">“Unsupervised vision-and-language pre-training without parallel images and captions,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Proc. Annual Conference of the North American Chapter of the Association for Computational Linguistics (NAACL)</span>, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
T. Le, H. T. Nguyen, and M. Le Nguyen,

</span>
<span class="ltx_bibblock">“Vision and text transformer for predicting answerability on visual question answering,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">Proc. IEEE International Conference on Image Processing (ICIP)</span>, 2021, pp. 934–938.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
T. Brown, B. Mann, N. Ryder, et al.,

</span>
<span class="ltx_bibblock">“Language models are few-shot learners,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Proc. Annual Conference on Neural Information Processing Systems (NeurIPS)</span>, 2020, pp. 1877–1901.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
H. Touvron, L. Martin, K. Stone, et al.,

</span>
<span class="ltx_bibblock">“Llama 2: Open foundation and fine-tuned chat models,”

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2307.09288</span>, 2023.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
M. Chen, J. Tworek, et al.,

</span>
<span class="ltx_bibblock">“Evaluating large language models trained on code,”

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">arXiv2107.03374</span>, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
R. Li et al.,

</span>
<span class="ltx_bibblock">“Starcoder: may the source be with you!,”

</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">arXiv:2305.06161</span>, 2023.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
B. Roziere, J. Gehring, F. Gloeckle, et al.,

</span>
<span class="ltx_bibblock">“Code llama: Open foundation models for code,”

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2308.12950</span>, 2023.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
G. Team, R. Anil, et al.,

</span>
<span class="ltx_bibblock">“Gemini: a family of highly capable multimodal models,”

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2312.11805</span>, 2023.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
X. Wang, J. Wei, D. Schuurmans, et al.,

</span>
<span class="ltx_bibblock">“Self-consistency improves chain of thought reasoning in language models,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">Proc. International Conference on Learning Representations (ICLR)</span>, 2023.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Z. Zhang, A. Zhang, M. Li, and A. Smola,

</span>
<span class="ltx_bibblock">“Automatic chain of thought prompting in large language models,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">Proc. International Conference on Learning Representations (ICLR)</span>, 2023.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
S. Yao, J. Zhao, D. Yu, et al.,

</span>
<span class="ltx_bibblock">“React: Synergizing reasoning and acting in language models,”

</span>
<span class="ltx_bibblock">2023.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
J. Johnson, B. Hariharan, L. van der Maaten, et al.,

</span>
<span class="ltx_bibblock">“Inferring and executing programs for visual reasoning,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">Proc. IEEE/CVF International Conference on Computer Vision (ICCV)</span>, 2017.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
S. Liu, Z. Zeng, T. Ren, et al.,

</span>
<span class="ltx_bibblock">“Grounding DINO: Marrying DINO with grounded pre-training for open-set object detection,”

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2303.05499</span>, 2023.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
J. Li, D. Li, C. Xiong, and S. Hoi,

</span>
<span class="ltx_bibblock">“BLIP: Bootstrapping language-image pre-training for unified vision-language understanding and generation,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">Proc. International Conference on Machine Learning (ICML)</span>, 2022, pp. 12888–12900.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2407.20562" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2407.20563" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2407.20563">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2407.20563" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2407.20564" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Aug  5 13:39:08 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
