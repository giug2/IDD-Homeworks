<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach</title>
<!--Generated on Mon Aug  5 13:16:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Knowledge graph completion,  Graph attention network,  Attention mechanism" lang="en" name="keywords"/>
<base href="/html/2408.02456v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S1" title="In Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S2" title="In Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S2.SS0.SSS0.Px1" title="In 2. Related work ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Translation-based models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S2.SS0.SSS0.Px2" title="In 2. Related work ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Semantic matching-based models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S2.SS0.SSS0.Px3" title="In 2. Related work ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">GCN-based models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S2.SS0.SSS0.Px4" title="In 2. Related work ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">GAT-based models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S2.SS0.SSS0.Px5" title="In 2. Related work ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Language model-based models</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S3" title="In Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Background</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S3.SS1" title="In 3. Background ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Knowledge graph</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S3.SS1.SSS0.Px1" title="In 3.1. Knowledge graph ‣ 3. Background ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Knowledge Graph</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S3.SS1.SSS0.Px2" title="In 3.1. Knowledge graph ‣ 3. Background ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Knowledge Graph Embedding</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S3.SS2" title="In 3. Background ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Attention mechanism</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S3.SS2.SSS0.Px1" title="In 3.2. Attention mechanism ‣ 3. Background ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Self-Attention Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S3.SS2.SSS0.Px2" title="In 3.2. Attention mechanism ‣ 3. Background ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Multi-Head Attention</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4" title="In Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4.SS1" title="In 4. Method ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Overall Framework</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4.SS2" title="In 4. Method ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Encoder</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4.SS2.SSS0.Px1" title="In 4.2. Encoder ‣ 4. Method ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Entity-Specific Attention Network</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4.SS2.SSS0.Px2" title="In 4.2. Encoder ‣ 4. Method ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Entity-Relation Joint Attention Network</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4.SS2.SSS0.Px3" title="In 4.2. Encoder ‣ 4. Method ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Analysis of Model Parameters.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4.SS2.SSS0.Px4" title="In 4.2. Encoder ‣ 4. Method ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Aggregation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4.SS3" title="In 4. Method ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Decoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4.SS4" title="In 4. Method ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Loss function</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5" title="In Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.SS1" title="In 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Datasets</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.SS1.SSS0.Px1" title="In 5.1. Datasets ‣ 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">FB15K-237</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.SS1.SSS0.Px2" title="In 5.1. Datasets ‣ 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">WN18RR</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.SS2" title="In 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Baselines</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.SS2.SSS0.Px1" title="In 5.2. Baselines ‣ 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Translation-based models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.SS2.SSS0.Px2" title="In 5.2. Baselines ‣ 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Semantic matching-based models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.SS2.SSS0.Px3" title="In 5.2. Baselines ‣ 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">GCN-based models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.SS2.SSS0.Px4" title="In 5.2. Baselines ‣ 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">GAT-based models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.SS2.SSS0.Px5" title="In 5.2. Baselines ‣ 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Decoder-only models</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.SS3" title="In 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Experiment setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.SS4" title="In 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Evaluation indicators</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6" title="In Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Result</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.SS1" title="In 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Overall performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.SS2" title="In 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Ablation study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.SS3" title="In 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>The performance with different sample sizes</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.SS3.SSS0.Px1" title="In 6.3. The performance with different sample sizes ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Performance on different entity sample sizes</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.SS3.SSS0.Px2" title="In 6.3. The performance with different sample sizes ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title">Performance on different relation sample sizes</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.SS4" title="In 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Training utilization analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S7" title="In Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion and future work</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wanxu Wei
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:handsome_wwx@sjtu.edu.cn">handsome_wwx@sjtu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Shanghai Jiao Tong University</span><span class="ltx_text ltx_affiliation_streetaddress" id="id2.2.id2">Dongchuan Road 800</span><span class="ltx_text ltx_affiliation_city" id="id3.3.id3">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id4.4.id4">China</span><span class="ltx_text ltx_affiliation_postcode" id="id5.5.id5">200240</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yitong Song
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:yitong_song@sjtu.edu.cn">yitong_song@sjtu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id6.1.id1">Shanghai Jiao Tong University</span><span class="ltx_text ltx_affiliation_streetaddress" id="id7.2.id2">Dongchuan Road 800</span><span class="ltx_text ltx_affiliation_city" id="id8.3.id3">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id9.4.id4">China</span><span class="ltx_text ltx_affiliation_postcode" id="id10.5.id5">200240</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bin Yao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:yaobin@cs.sjtu.edu.cn">yaobin@cs.sjtu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id11.1.id1">Shanghai Jiao Tong University</span><span class="ltx_text ltx_affiliation_streetaddress" id="id12.2.id2">Dongchuan Road 800</span><span class="ltx_text ltx_affiliation_city" id="id13.3.id3">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id14.4.id4">China</span><span class="ltx_text ltx_affiliation_postcode" id="id15.5.id5">200240</span>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id16.id1">Knowledge graphs (KGs) play a vital role in enhancing search results and recommendation systems. With the rapid increase in the size of the KGs, they are becoming inaccuracy and incomplete. This problem can be solved by the knowledge graph completion methods, of which graph attention network (GAT)-based methods stand out since their superior performance. However, existing GAT-based knowledge graph completion methods often suffer from overfitting issues when dealing with heterogeneous knowledge graphs, primarily due to the unbalanced number of samples. Additionally, these methods demonstrate poor performance in predicting the tail (head) entity that shares the same relation and head (tail) entity with others. To solve these problems, we propose GATH, a novel <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="id16.id1.1">GAT</span>-based method designed for <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="id16.id1.2">H</span>eterogeneous KGs. GATH incorporates two separate attention network modules that work synergistically to predict the missing entities. We also introduce novel encoding and feature transformation approaches, enabling the robust performance of GATH in scenarios with imbalanced samples. Comprehensive experiments are conducted to evaluate the GATH’s performance. Compared with the existing SOTA GAT-based model on Hits@10 and MRR metrics, our model improves performance by 5.2% and 5.2% on the FB15K-237 dataset, and by 4.5% and 14.6% on the WN18RR dataset, respectively.</p>
</div>
<div class="ltx_keywords">Knowledge graph completion, Graph attention network, Attention mechanism
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Data mining</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Semantic networks</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.7">Knowledge graphs (KGs) store entities and their relations as triplets. Each triplet, which is also called fact, can be denoted as <math alttext="(h,r,t)" class="ltx_Math" display="inline" id="S1.p1.1.m1.3"><semantics id="S1.p1.1.m1.3a"><mrow id="S1.p1.1.m1.3.4.2" xref="S1.p1.1.m1.3.4.1.cmml"><mo id="S1.p1.1.m1.3.4.2.1" stretchy="false" xref="S1.p1.1.m1.3.4.1.cmml">(</mo><mi id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">h</mi><mo id="S1.p1.1.m1.3.4.2.2" xref="S1.p1.1.m1.3.4.1.cmml">,</mo><mi id="S1.p1.1.m1.2.2" xref="S1.p1.1.m1.2.2.cmml">r</mi><mo id="S1.p1.1.m1.3.4.2.3" xref="S1.p1.1.m1.3.4.1.cmml">,</mo><mi id="S1.p1.1.m1.3.3" xref="S1.p1.1.m1.3.3.cmml">t</mi><mo id="S1.p1.1.m1.3.4.2.4" stretchy="false" xref="S1.p1.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.3b"><vector id="S1.p1.1.m1.3.4.1.cmml" xref="S1.p1.1.m1.3.4.2"><ci id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">ℎ</ci><ci id="S1.p1.1.m1.2.2.cmml" xref="S1.p1.1.m1.2.2">𝑟</ci><ci id="S1.p1.1.m1.3.3.cmml" xref="S1.p1.1.m1.3.3">𝑡</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.3c">(h,r,t)</annotation><annotation encoding="application/x-llamapun" id="S1.p1.1.m1.3d">( italic_h , italic_r , italic_t )</annotation></semantics></math>, where <math alttext="h" class="ltx_Math" display="inline" id="S1.p1.2.m2.1"><semantics id="S1.p1.2.m2.1a"><mi id="S1.p1.2.m2.1.1" xref="S1.p1.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S1.p1.2.m2.1b"><ci id="S1.p1.2.m2.1.1.cmml" xref="S1.p1.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S1.p1.2.m2.1d">italic_h</annotation></semantics></math> and <math alttext="t" class="ltx_Math" display="inline" id="S1.p1.3.m3.1"><semantics id="S1.p1.3.m3.1a"><mi id="S1.p1.3.m3.1.1" xref="S1.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S1.p1.3.m3.1b"><ci id="S1.p1.3.m3.1.1.cmml" xref="S1.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S1.p1.3.m3.1d">italic_t</annotation></semantics></math> are the head and tail entities, and <math alttext="r" class="ltx_Math" display="inline" id="S1.p1.4.m4.1"><semantics id="S1.p1.4.m4.1a"><mi id="S1.p1.4.m4.1.1" xref="S1.p1.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S1.p1.4.m4.1b"><ci id="S1.p1.4.m4.1.1.cmml" xref="S1.p1.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.4.m4.1c">r</annotation><annotation encoding="application/x-llamapun" id="S1.p1.4.m4.1d">italic_r</annotation></semantics></math> is their relation (e.g., the head entity <math alttext="h" class="ltx_Math" display="inline" id="S1.p1.5.m5.1"><semantics id="S1.p1.5.m5.1a"><mi id="S1.p1.5.m5.1.1" xref="S1.p1.5.m5.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S1.p1.5.m5.1b"><ci id="S1.p1.5.m5.1.1.cmml" xref="S1.p1.5.m5.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.5.m5.1c">h</annotation><annotation encoding="application/x-llamapun" id="S1.p1.5.m5.1d">italic_h</annotation></semantics></math> is ”Kobe”, the relation <math alttext="r" class="ltx_Math" display="inline" id="S1.p1.6.m6.1"><semantics id="S1.p1.6.m6.1a"><mi id="S1.p1.6.m6.1.1" xref="S1.p1.6.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S1.p1.6.m6.1b"><ci id="S1.p1.6.m6.1.1.cmml" xref="S1.p1.6.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.6.m6.1c">r</annotation><annotation encoding="application/x-llamapun" id="S1.p1.6.m6.1d">italic_r</annotation></semantics></math> is ”Career”, and the tail entity <math alttext="t" class="ltx_Math" display="inline" id="S1.p1.7.m7.1"><semantics id="S1.p1.7.m7.1a"><mi id="S1.p1.7.m7.1.1" xref="S1.p1.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S1.p1.7.m7.1b"><ci id="S1.p1.7.m7.1.1.cmml" xref="S1.p1.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.7.m7.1c">t</annotation><annotation encoding="application/x-llamapun" id="S1.p1.7.m7.1d">italic_t</annotation></semantics></math> is ”Basketball Player”). Brimming with vast amounts of facts, KGs are widely employed to enhance the search results <cite class="ltx_cite ltx_citemacro_citep">(Yasunaga et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib39" title="">2021</a>; Huang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib10" title="">2019</a>; Do and Phan, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib7" title="">2022</a>)</cite> and refine the recommendation results <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib33" title="">2019</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib34" title="">2021</a>; Hui et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib11" title="">2022</a>)</cite>. However, as KGs expand rapidly in size, the facts it contains may become inaccurate and incomplete, hindering the ability to provide satisfactory search and recommendation results.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.4">The knowledge graph completion (KGC) technique is dedicated to completing incomplete triples in KGs. Currently, several studies on knowledge graph completion focus on link prediction, which predicts missing values in a possible triplet. Link prediction is usually defined as, given a query triplet <math alttext="(?,r,t)" class="ltx_Math" display="inline" id="S1.p2.1.m1.3"><semantics id="S1.p2.1.m1.3a"><mrow id="S1.p2.1.m1.3.4.2" xref="S1.p2.1.m1.3.4.1.cmml"><mo id="S1.p2.1.m1.3.4.2.1" stretchy="false" xref="S1.p2.1.m1.3.4.1.cmml">(</mo><mi id="S1.p2.1.m1.1.1" mathvariant="normal" xref="S1.p2.1.m1.1.1.cmml">?</mi><mo id="S1.p2.1.m1.3.4.2.2" xref="S1.p2.1.m1.3.4.1.cmml">,</mo><mi id="S1.p2.1.m1.2.2" xref="S1.p2.1.m1.2.2.cmml">r</mi><mo id="S1.p2.1.m1.3.4.2.3" xref="S1.p2.1.m1.3.4.1.cmml">,</mo><mi id="S1.p2.1.m1.3.3" xref="S1.p2.1.m1.3.3.cmml">t</mi><mo id="S1.p2.1.m1.3.4.2.4" stretchy="false" xref="S1.p2.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.3b"><vector id="S1.p2.1.m1.3.4.1.cmml" xref="S1.p2.1.m1.3.4.2"><ci id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1">?</ci><ci id="S1.p2.1.m1.2.2.cmml" xref="S1.p2.1.m1.2.2">𝑟</ci><ci id="S1.p2.1.m1.3.3.cmml" xref="S1.p2.1.m1.3.3">𝑡</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.3c">(?,r,t)</annotation><annotation encoding="application/x-llamapun" id="S1.p2.1.m1.3d">( ? , italic_r , italic_t )</annotation></semantics></math> or <math alttext="(h,r,?)" class="ltx_Math" display="inline" id="S1.p2.2.m2.3"><semantics id="S1.p2.2.m2.3a"><mrow id="S1.p2.2.m2.3.4.2" xref="S1.p2.2.m2.3.4.1.cmml"><mo id="S1.p2.2.m2.3.4.2.1" stretchy="false" xref="S1.p2.2.m2.3.4.1.cmml">(</mo><mi id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml">h</mi><mo id="S1.p2.2.m2.3.4.2.2" xref="S1.p2.2.m2.3.4.1.cmml">,</mo><mi id="S1.p2.2.m2.2.2" xref="S1.p2.2.m2.2.2.cmml">r</mi><mo id="S1.p2.2.m2.3.4.2.3" xref="S1.p2.2.m2.3.4.1.cmml">,</mo><mi id="S1.p2.2.m2.3.3" mathvariant="normal" xref="S1.p2.2.m2.3.3.cmml">?</mi><mo id="S1.p2.2.m2.3.4.2.4" stretchy="false" xref="S1.p2.2.m2.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.3b"><vector id="S1.p2.2.m2.3.4.1.cmml" xref="S1.p2.2.m2.3.4.2"><ci id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1">ℎ</ci><ci id="S1.p2.2.m2.2.2.cmml" xref="S1.p2.2.m2.2.2">𝑟</ci><ci id="S1.p2.2.m2.3.3.cmml" xref="S1.p2.2.m2.3.3">?</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.3c">(h,r,?)</annotation><annotation encoding="application/x-llamapun" id="S1.p2.2.m2.3d">( italic_h , italic_r , ? )</annotation></semantics></math>, where <math alttext="?" class="ltx_Math" display="inline" id="S1.p2.3.m3.1"><semantics id="S1.p2.3.m3.1a"><mi id="S1.p2.3.m3.1.1" mathvariant="normal" xref="S1.p2.3.m3.1.1.cmml">?</mi><annotation-xml encoding="MathML-Content" id="S1.p2.3.m3.1b"><ci id="S1.p2.3.m3.1.1.cmml" xref="S1.p2.3.m3.1.1">?</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.3.m3.1c">?</annotation><annotation encoding="application/x-llamapun" id="S1.p2.3.m3.1d">?</annotation></semantics></math> represents the missing value that needs to be predicted. For instance, given the query <math alttext="(?,\text{isMarriedTo},\text{William})" class="ltx_Math" display="inline" id="S1.p2.4.m4.3"><semantics id="S1.p2.4.m4.3a"><mrow id="S1.p2.4.m4.3.4.2" xref="S1.p2.4.m4.3.4.1.cmml"><mo id="S1.p2.4.m4.3.4.2.1" stretchy="false" xref="S1.p2.4.m4.3.4.1.cmml">(</mo><mi id="S1.p2.4.m4.1.1" mathvariant="normal" xref="S1.p2.4.m4.1.1.cmml">?</mi><mo id="S1.p2.4.m4.3.4.2.2" xref="S1.p2.4.m4.3.4.1.cmml">,</mo><mtext id="S1.p2.4.m4.2.2" xref="S1.p2.4.m4.2.2a.cmml">isMarriedTo</mtext><mo id="S1.p2.4.m4.3.4.2.3" xref="S1.p2.4.m4.3.4.1.cmml">,</mo><mtext id="S1.p2.4.m4.3.3" xref="S1.p2.4.m4.3.3a.cmml">William</mtext><mo id="S1.p2.4.m4.3.4.2.4" stretchy="false" xref="S1.p2.4.m4.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.4.m4.3b"><vector id="S1.p2.4.m4.3.4.1.cmml" xref="S1.p2.4.m4.3.4.2"><ci id="S1.p2.4.m4.1.1.cmml" xref="S1.p2.4.m4.1.1">?</ci><ci id="S1.p2.4.m4.2.2a.cmml" xref="S1.p2.4.m4.2.2"><mtext id="S1.p2.4.m4.2.2.cmml" xref="S1.p2.4.m4.2.2">isMarriedTo</mtext></ci><ci id="S1.p2.4.m4.3.3a.cmml" xref="S1.p2.4.m4.3.3"><mtext id="S1.p2.4.m4.3.3.cmml" xref="S1.p2.4.m4.3.3">William</mtext></ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.4.m4.3c">(?,\text{isMarriedTo},\text{William})</annotation><annotation encoding="application/x-llamapun" id="S1.p2.4.m4.3d">( ? , isMarriedTo , William )</annotation></semantics></math>, the goal of link prediction is to predict that the missing value is ”Kate”. In this paper, we also study the link prediction problem for knowledge graph completion.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Recently, knowledge graph embedding models based on graph neural network (GNN) have emerged as a successful method for the link prediction task.
These approaches offer a comprehensive and nuanced representation of the knowledge graph by capturing the semantics of individual triplets as well as the structural information of the whole KG.
Among all GNN-based methods, GAT-based approaches (e.g., GAT <cite class="ltx_cite ltx_citemacro_citep">(Veličković et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib31" title="">2017</a>)</cite>, r-GAT <cite class="ltx_cite ltx_citemacro_citep">(Busbridge et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib3" title="">2019</a>)</cite>, KAME <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib14" title="">2021</a>)</cite>, DisenKGAT <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib36" title="">2021</a>)</cite>) exhibit superior performance. This is due to the fact that GAT-based approaches assign different weights or importance to each neighbor during the information aggregation process. This allows the model to prioritize learning from important neighbors while diminishing the influence of unimportant connections.
While significant progress has been made with GAT-based methods, further improvements are still needed for heterogeneous KGs. Heterogeneous KGs consist of diverse types of entities and relations, which provide a better representation of complex and varied real-world data. However, it becomes more challenging to predict entities and relations in such graphs using GAT-based methods.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="210" id="S1.F1.sf1.g1" src="extracted/5774499/hete_KG_a.png" width="252"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="S1.F1.sf1.3.2" style="font-size:80%;">Case 1: The heterogeneous knowledge graph with unbalanced number of relations.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="210" id="S1.F1.sf2.g1" src="extracted/5774499/hete_KG_b.png" width="252"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="S1.F1.sf2.3.2" style="font-size:80%;">Case 2: The heterogeneous knowledge graph with the entities sharing the same relation with others.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>The examples of heterogeneous knowledge graphs, where the circle represents the entity, labeled as <math alttext="E_{x}" class="ltx_Math" display="inline" id="S1.F1.4.m1.1"><semantics id="S1.F1.4.m1.1b"><msub id="S1.F1.4.m1.1.1" xref="S1.F1.4.m1.1.1.cmml"><mi id="S1.F1.4.m1.1.1.2" xref="S1.F1.4.m1.1.1.2.cmml">E</mi><mi id="S1.F1.4.m1.1.1.3" xref="S1.F1.4.m1.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.4.m1.1c"><apply id="S1.F1.4.m1.1.1.cmml" xref="S1.F1.4.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.4.m1.1.1.1.cmml" xref="S1.F1.4.m1.1.1">subscript</csymbol><ci id="S1.F1.4.m1.1.1.2.cmml" xref="S1.F1.4.m1.1.1.2">𝐸</ci><ci id="S1.F1.4.m1.1.1.3.cmml" xref="S1.F1.4.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.m1.1d">E_{x}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.4.m1.1e">italic_E start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="x" class="ltx_Math" display="inline" id="S1.F1.5.m2.1"><semantics id="S1.F1.5.m2.1b"><mi id="S1.F1.5.m2.1.1" xref="S1.F1.5.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S1.F1.5.m2.1c"><ci id="S1.F1.5.m2.1.1.cmml" xref="S1.F1.5.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m2.1d">x</annotation><annotation encoding="application/x-llamapun" id="S1.F1.5.m2.1e">italic_x</annotation></semantics></math> is the number. The arrows indicate the relations and different color arrows indicate different types of relations. The relation is noted as <math alttext="r_{x}" class="ltx_Math" display="inline" id="S1.F1.6.m3.1"><semantics id="S1.F1.6.m3.1b"><msub id="S1.F1.6.m3.1.1" xref="S1.F1.6.m3.1.1.cmml"><mi id="S1.F1.6.m3.1.1.2" xref="S1.F1.6.m3.1.1.2.cmml">r</mi><mi id="S1.F1.6.m3.1.1.3" xref="S1.F1.6.m3.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.6.m3.1c"><apply id="S1.F1.6.m3.1.1.cmml" xref="S1.F1.6.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.6.m3.1.1.1.cmml" xref="S1.F1.6.m3.1.1">subscript</csymbol><ci id="S1.F1.6.m3.1.1.2.cmml" xref="S1.F1.6.m3.1.1.2">𝑟</ci><ci id="S1.F1.6.m3.1.1.3.cmml" xref="S1.F1.6.m3.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m3.1d">r_{x}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.6.m3.1e">italic_r start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math>. </figcaption>
</figure>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.19"><span class="ltx_text ltx_font_bold" id="S1.p4.19.1">Challenge 1: Existing GAT-based approaches overfit in sparse entity and relation predictions.</span>
<span class="ltx_text" id="S1.p4.19.2" style="color:#000000;">In deep learning, overfitting is a fundamental problem characterized by a model that can match the training set with high accuracy but performs poorly when modeling other data. <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib40" title="">2021</a>)</cite> mentions that when the number of model parameters exceeds the amount of information in the training set. the model tends to memorize the training data rather than learn the underlying patterns, resulting in overfitting.</span>
The distribution of information in the real world tends to be skewed, resulting in some entities and relations appearing infrequently. For example, in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">1</span></a>(a), only one triple contains node <math alttext="E_{6}" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><msub id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">E</mi><mn id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.cmml" xref="S1.p4.1.m1.1.1">subscript</csymbol><ci id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2">𝐸</ci><cn id="S1.p4.1.m1.1.1.3.cmml" type="integer" xref="S1.p4.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">E_{6}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">italic_E start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math> and relation <math alttext="r_{3}" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><msub id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml"><mi id="S1.p4.2.m2.1.1.2" xref="S1.p4.2.m2.1.1.2.cmml">r</mi><mn id="S1.p4.2.m2.1.1.3" xref="S1.p4.2.m2.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><apply id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p4.2.m2.1.1.1.cmml" xref="S1.p4.2.m2.1.1">subscript</csymbol><ci id="S1.p4.2.m2.1.1.2.cmml" xref="S1.p4.2.m2.1.1.2">𝑟</ci><cn id="S1.p4.2.m2.1.1.3.cmml" type="integer" xref="S1.p4.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">r_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">italic_r start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>. We call these entities and relations with low frequency ”sparse entities” and ”sparse relations”, respectively.
<span class="ltx_text" id="S1.p4.19.3" style="color:#000000;">Existing GAT-based models often have a large number of parameters, which can lead to overfitting when modeling sparse entities and relations due to the parameter quantity exceeding the number of data points. </span> Therefore, existing GAT-based methods suffer from performance degradation due to the presence of sparse entities and relations. For example, in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">1</span></a>(a), only one triple contains <math alttext="r_{3}" class="ltx_Math" display="inline" id="S1.p4.3.m3.1"><semantics id="S1.p4.3.m3.1a"><msub id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml"><mi id="S1.p4.3.m3.1.1.2" xref="S1.p4.3.m3.1.1.2.cmml">r</mi><mn id="S1.p4.3.m3.1.1.3" xref="S1.p4.3.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><apply id="S1.p4.3.m3.1.1.cmml" xref="S1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p4.3.m3.1.1.1.cmml" xref="S1.p4.3.m3.1.1">subscript</csymbol><ci id="S1.p4.3.m3.1.1.2.cmml" xref="S1.p4.3.m3.1.1.2">𝑟</ci><cn id="S1.p4.3.m3.1.1.3.cmml" type="integer" xref="S1.p4.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">r_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.3.m3.1d">italic_r start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>. Given the head entity <math alttext="E_{3}" class="ltx_Math" display="inline" id="S1.p4.4.m4.1"><semantics id="S1.p4.4.m4.1a"><msub id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml"><mi id="S1.p4.4.m4.1.1.2" xref="S1.p4.4.m4.1.1.2.cmml">E</mi><mn id="S1.p4.4.m4.1.1.3" xref="S1.p4.4.m4.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.1b"><apply id="S1.p4.4.m4.1.1.cmml" xref="S1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S1.p4.4.m4.1.1.1.cmml" xref="S1.p4.4.m4.1.1">subscript</csymbol><ci id="S1.p4.4.m4.1.1.2.cmml" xref="S1.p4.4.m4.1.1.2">𝐸</ci><cn id="S1.p4.4.m4.1.1.3.cmml" type="integer" xref="S1.p4.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.1c">E_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.4.m4.1d">italic_E start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> and relation <math alttext="r_{3}" class="ltx_Math" display="inline" id="S1.p4.5.m5.1"><semantics id="S1.p4.5.m5.1a"><msub id="S1.p4.5.m5.1.1" xref="S1.p4.5.m5.1.1.cmml"><mi id="S1.p4.5.m5.1.1.2" xref="S1.p4.5.m5.1.1.2.cmml">r</mi><mn id="S1.p4.5.m5.1.1.3" xref="S1.p4.5.m5.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.5.m5.1b"><apply id="S1.p4.5.m5.1.1.cmml" xref="S1.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S1.p4.5.m5.1.1.1.cmml" xref="S1.p4.5.m5.1.1">subscript</csymbol><ci id="S1.p4.5.m5.1.1.2.cmml" xref="S1.p4.5.m5.1.1.2">𝑟</ci><cn id="S1.p4.5.m5.1.1.3.cmml" type="integer" xref="S1.p4.5.m5.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.5.m5.1c">r_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.5.m5.1d">italic_r start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>, the model is likely to predict the entity <math alttext="E_{4}" class="ltx_Math" display="inline" id="S1.p4.6.m6.1"><semantics id="S1.p4.6.m6.1a"><msub id="S1.p4.6.m6.1.1" xref="S1.p4.6.m6.1.1.cmml"><mi id="S1.p4.6.m6.1.1.2" xref="S1.p4.6.m6.1.1.2.cmml">E</mi><mn id="S1.p4.6.m6.1.1.3" xref="S1.p4.6.m6.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.6.m6.1b"><apply id="S1.p4.6.m6.1.1.cmml" xref="S1.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S1.p4.6.m6.1.1.1.cmml" xref="S1.p4.6.m6.1.1">subscript</csymbol><ci id="S1.p4.6.m6.1.1.2.cmml" xref="S1.p4.6.m6.1.1.2">𝐸</ci><cn id="S1.p4.6.m6.1.1.3.cmml" type="integer" xref="S1.p4.6.m6.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.6.m6.1c">E_{4}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.6.m6.1d">italic_E start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>, whereas the other potential tail entities are masked or overlooked. This is because overfitting occurs when using a large number of parameters to model sparse relations <math alttext="r_{3}" class="ltx_Math" display="inline" id="S1.p4.7.m7.1"><semantics id="S1.p4.7.m7.1a"><msub id="S1.p4.7.m7.1.1" xref="S1.p4.7.m7.1.1.cmml"><mi id="S1.p4.7.m7.1.1.2" xref="S1.p4.7.m7.1.1.2.cmml">r</mi><mn id="S1.p4.7.m7.1.1.3" xref="S1.p4.7.m7.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.7.m7.1b"><apply id="S1.p4.7.m7.1.1.cmml" xref="S1.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S1.p4.7.m7.1.1.1.cmml" xref="S1.p4.7.m7.1.1">subscript</csymbol><ci id="S1.p4.7.m7.1.1.2.cmml" xref="S1.p4.7.m7.1.1.2">𝑟</ci><cn id="S1.p4.7.m7.1.1.3.cmml" type="integer" xref="S1.p4.7.m7.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.7.m7.1c">r_{3}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.7.m7.1d">italic_r start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> with less information.
As another example, there only exists one triple containing <math alttext="E_{6}" class="ltx_Math" display="inline" id="S1.p4.8.m8.1"><semantics id="S1.p4.8.m8.1a"><msub id="S1.p4.8.m8.1.1" xref="S1.p4.8.m8.1.1.cmml"><mi id="S1.p4.8.m8.1.1.2" xref="S1.p4.8.m8.1.1.2.cmml">E</mi><mn id="S1.p4.8.m8.1.1.3" xref="S1.p4.8.m8.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.8.m8.1b"><apply id="S1.p4.8.m8.1.1.cmml" xref="S1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S1.p4.8.m8.1.1.1.cmml" xref="S1.p4.8.m8.1.1">subscript</csymbol><ci id="S1.p4.8.m8.1.1.2.cmml" xref="S1.p4.8.m8.1.1.2">𝐸</ci><cn id="S1.p4.8.m8.1.1.3.cmml" type="integer" xref="S1.p4.8.m8.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.8.m8.1c">E_{6}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.8.m8.1d">italic_E start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math>, i.e., <math alttext="(E_{6},r_{2},E_{1})" class="ltx_Math" display="inline" id="S1.p4.9.m9.3"><semantics id="S1.p4.9.m9.3a"><mrow id="S1.p4.9.m9.3.3.3" xref="S1.p4.9.m9.3.3.4.cmml"><mo id="S1.p4.9.m9.3.3.3.4" stretchy="false" xref="S1.p4.9.m9.3.3.4.cmml">(</mo><msub id="S1.p4.9.m9.1.1.1.1" xref="S1.p4.9.m9.1.1.1.1.cmml"><mi id="S1.p4.9.m9.1.1.1.1.2" xref="S1.p4.9.m9.1.1.1.1.2.cmml">E</mi><mn id="S1.p4.9.m9.1.1.1.1.3" xref="S1.p4.9.m9.1.1.1.1.3.cmml">6</mn></msub><mo id="S1.p4.9.m9.3.3.3.5" xref="S1.p4.9.m9.3.3.4.cmml">,</mo><msub id="S1.p4.9.m9.2.2.2.2" xref="S1.p4.9.m9.2.2.2.2.cmml"><mi id="S1.p4.9.m9.2.2.2.2.2" xref="S1.p4.9.m9.2.2.2.2.2.cmml">r</mi><mn id="S1.p4.9.m9.2.2.2.2.3" xref="S1.p4.9.m9.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p4.9.m9.3.3.3.6" xref="S1.p4.9.m9.3.3.4.cmml">,</mo><msub id="S1.p4.9.m9.3.3.3.3" xref="S1.p4.9.m9.3.3.3.3.cmml"><mi id="S1.p4.9.m9.3.3.3.3.2" xref="S1.p4.9.m9.3.3.3.3.2.cmml">E</mi><mn id="S1.p4.9.m9.3.3.3.3.3" xref="S1.p4.9.m9.3.3.3.3.3.cmml">1</mn></msub><mo id="S1.p4.9.m9.3.3.3.7" stretchy="false" xref="S1.p4.9.m9.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.9.m9.3b"><vector id="S1.p4.9.m9.3.3.4.cmml" xref="S1.p4.9.m9.3.3.3"><apply id="S1.p4.9.m9.1.1.1.1.cmml" xref="S1.p4.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S1.p4.9.m9.1.1.1.1.1.cmml" xref="S1.p4.9.m9.1.1.1.1">subscript</csymbol><ci id="S1.p4.9.m9.1.1.1.1.2.cmml" xref="S1.p4.9.m9.1.1.1.1.2">𝐸</ci><cn id="S1.p4.9.m9.1.1.1.1.3.cmml" type="integer" xref="S1.p4.9.m9.1.1.1.1.3">6</cn></apply><apply id="S1.p4.9.m9.2.2.2.2.cmml" xref="S1.p4.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S1.p4.9.m9.2.2.2.2.1.cmml" xref="S1.p4.9.m9.2.2.2.2">subscript</csymbol><ci id="S1.p4.9.m9.2.2.2.2.2.cmml" xref="S1.p4.9.m9.2.2.2.2.2">𝑟</ci><cn id="S1.p4.9.m9.2.2.2.2.3.cmml" type="integer" xref="S1.p4.9.m9.2.2.2.2.3">2</cn></apply><apply id="S1.p4.9.m9.3.3.3.3.cmml" xref="S1.p4.9.m9.3.3.3.3"><csymbol cd="ambiguous" id="S1.p4.9.m9.3.3.3.3.1.cmml" xref="S1.p4.9.m9.3.3.3.3">subscript</csymbol><ci id="S1.p4.9.m9.3.3.3.3.2.cmml" xref="S1.p4.9.m9.3.3.3.3.2">𝐸</ci><cn id="S1.p4.9.m9.3.3.3.3.3.cmml" type="integer" xref="S1.p4.9.m9.3.3.3.3.3">1</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.9.m9.3c">(E_{6},r_{2},E_{1})</annotation><annotation encoding="application/x-llamapun" id="S1.p4.9.m9.3d">( italic_E start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math>. And <math alttext="E_{5}" class="ltx_Math" display="inline" id="S1.p4.10.m10.1"><semantics id="S1.p4.10.m10.1a"><msub id="S1.p4.10.m10.1.1" xref="S1.p4.10.m10.1.1.cmml"><mi id="S1.p4.10.m10.1.1.2" xref="S1.p4.10.m10.1.1.2.cmml">E</mi><mn id="S1.p4.10.m10.1.1.3" xref="S1.p4.10.m10.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.10.m10.1b"><apply id="S1.p4.10.m10.1.1.cmml" xref="S1.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S1.p4.10.m10.1.1.1.cmml" xref="S1.p4.10.m10.1.1">subscript</csymbol><ci id="S1.p4.10.m10.1.1.2.cmml" xref="S1.p4.10.m10.1.1.2">𝐸</ci><cn id="S1.p4.10.m10.1.1.3.cmml" type="integer" xref="S1.p4.10.m10.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.10.m10.1c">E_{5}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.10.m10.1d">italic_E start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT</annotation></semantics></math> is also related to <math alttext="E_{1}" class="ltx_Math" display="inline" id="S1.p4.11.m11.1"><semantics id="S1.p4.11.m11.1a"><msub id="S1.p4.11.m11.1.1" xref="S1.p4.11.m11.1.1.cmml"><mi id="S1.p4.11.m11.1.1.2" xref="S1.p4.11.m11.1.1.2.cmml">E</mi><mn id="S1.p4.11.m11.1.1.3" xref="S1.p4.11.m11.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.11.m11.1b"><apply id="S1.p4.11.m11.1.1.cmml" xref="S1.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S1.p4.11.m11.1.1.1.cmml" xref="S1.p4.11.m11.1.1">subscript</csymbol><ci id="S1.p4.11.m11.1.1.2.cmml" xref="S1.p4.11.m11.1.1.2">𝐸</ci><cn id="S1.p4.11.m11.1.1.3.cmml" type="integer" xref="S1.p4.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.11.m11.1c">E_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.11.m11.1d">italic_E start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> by <math alttext="r_{2}" class="ltx_Math" display="inline" id="S1.p4.12.m12.1"><semantics id="S1.p4.12.m12.1a"><msub id="S1.p4.12.m12.1.1" xref="S1.p4.12.m12.1.1.cmml"><mi id="S1.p4.12.m12.1.1.2" xref="S1.p4.12.m12.1.1.2.cmml">r</mi><mn id="S1.p4.12.m12.1.1.3" xref="S1.p4.12.m12.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.12.m12.1b"><apply id="S1.p4.12.m12.1.1.cmml" xref="S1.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S1.p4.12.m12.1.1.1.cmml" xref="S1.p4.12.m12.1.1">subscript</csymbol><ci id="S1.p4.12.m12.1.1.2.cmml" xref="S1.p4.12.m12.1.1.2">𝑟</ci><cn id="S1.p4.12.m12.1.1.3.cmml" type="integer" xref="S1.p4.12.m12.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.12.m12.1c">r_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.12.m12.1d">italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. Assuming <math alttext="r_{2}" class="ltx_Math" display="inline" id="S1.p4.13.m13.1"><semantics id="S1.p4.13.m13.1a"><msub id="S1.p4.13.m13.1.1" xref="S1.p4.13.m13.1.1.cmml"><mi id="S1.p4.13.m13.1.1.2" xref="S1.p4.13.m13.1.1.2.cmml">r</mi><mn id="S1.p4.13.m13.1.1.3" xref="S1.p4.13.m13.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.13.m13.1b"><apply id="S1.p4.13.m13.1.1.cmml" xref="S1.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S1.p4.13.m13.1.1.1.cmml" xref="S1.p4.13.m13.1.1">subscript</csymbol><ci id="S1.p4.13.m13.1.1.2.cmml" xref="S1.p4.13.m13.1.1.2">𝑟</ci><cn id="S1.p4.13.m13.1.1.3.cmml" type="integer" xref="S1.p4.13.m13.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.13.m13.1c">r_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.13.m13.1d">italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> as a <math alttext="Teammate\_of" class="ltx_Math" display="inline" id="S1.p4.14.m14.1"><semantics id="S1.p4.14.m14.1a"><mrow id="S1.p4.14.m14.1.1" xref="S1.p4.14.m14.1.1.cmml"><mi id="S1.p4.14.m14.1.1.2" xref="S1.p4.14.m14.1.1.2.cmml">T</mi><mo id="S1.p4.14.m14.1.1.1" xref="S1.p4.14.m14.1.1.1.cmml">⁢</mo><mi id="S1.p4.14.m14.1.1.3" xref="S1.p4.14.m14.1.1.3.cmml">e</mi><mo id="S1.p4.14.m14.1.1.1a" xref="S1.p4.14.m14.1.1.1.cmml">⁢</mo><mi id="S1.p4.14.m14.1.1.4" xref="S1.p4.14.m14.1.1.4.cmml">a</mi><mo id="S1.p4.14.m14.1.1.1b" xref="S1.p4.14.m14.1.1.1.cmml">⁢</mo><mi id="S1.p4.14.m14.1.1.5" xref="S1.p4.14.m14.1.1.5.cmml">m</mi><mo id="S1.p4.14.m14.1.1.1c" xref="S1.p4.14.m14.1.1.1.cmml">⁢</mo><mi id="S1.p4.14.m14.1.1.6" xref="S1.p4.14.m14.1.1.6.cmml">m</mi><mo id="S1.p4.14.m14.1.1.1d" xref="S1.p4.14.m14.1.1.1.cmml">⁢</mo><mi id="S1.p4.14.m14.1.1.7" xref="S1.p4.14.m14.1.1.7.cmml">a</mi><mo id="S1.p4.14.m14.1.1.1e" xref="S1.p4.14.m14.1.1.1.cmml">⁢</mo><mi id="S1.p4.14.m14.1.1.8" xref="S1.p4.14.m14.1.1.8.cmml">t</mi><mo id="S1.p4.14.m14.1.1.1f" xref="S1.p4.14.m14.1.1.1.cmml">⁢</mo><mi id="S1.p4.14.m14.1.1.9" xref="S1.p4.14.m14.1.1.9.cmml">e</mi><mo id="S1.p4.14.m14.1.1.1g" xref="S1.p4.14.m14.1.1.1.cmml">⁢</mo><mi id="S1.p4.14.m14.1.1.10" mathvariant="normal" xref="S1.p4.14.m14.1.1.10.cmml">_</mi><mo id="S1.p4.14.m14.1.1.1h" xref="S1.p4.14.m14.1.1.1.cmml">⁢</mo><mi id="S1.p4.14.m14.1.1.11" xref="S1.p4.14.m14.1.1.11.cmml">o</mi><mo id="S1.p4.14.m14.1.1.1i" xref="S1.p4.14.m14.1.1.1.cmml">⁢</mo><mi id="S1.p4.14.m14.1.1.12" xref="S1.p4.14.m14.1.1.12.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.14.m14.1b"><apply id="S1.p4.14.m14.1.1.cmml" xref="S1.p4.14.m14.1.1"><times id="S1.p4.14.m14.1.1.1.cmml" xref="S1.p4.14.m14.1.1.1"></times><ci id="S1.p4.14.m14.1.1.2.cmml" xref="S1.p4.14.m14.1.1.2">𝑇</ci><ci id="S1.p4.14.m14.1.1.3.cmml" xref="S1.p4.14.m14.1.1.3">𝑒</ci><ci id="S1.p4.14.m14.1.1.4.cmml" xref="S1.p4.14.m14.1.1.4">𝑎</ci><ci id="S1.p4.14.m14.1.1.5.cmml" xref="S1.p4.14.m14.1.1.5">𝑚</ci><ci id="S1.p4.14.m14.1.1.6.cmml" xref="S1.p4.14.m14.1.1.6">𝑚</ci><ci id="S1.p4.14.m14.1.1.7.cmml" xref="S1.p4.14.m14.1.1.7">𝑎</ci><ci id="S1.p4.14.m14.1.1.8.cmml" xref="S1.p4.14.m14.1.1.8">𝑡</ci><ci id="S1.p4.14.m14.1.1.9.cmml" xref="S1.p4.14.m14.1.1.9">𝑒</ci><ci id="S1.p4.14.m14.1.1.10.cmml" xref="S1.p4.14.m14.1.1.10">_</ci><ci id="S1.p4.14.m14.1.1.11.cmml" xref="S1.p4.14.m14.1.1.11">𝑜</ci><ci id="S1.p4.14.m14.1.1.12.cmml" xref="S1.p4.14.m14.1.1.12">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.14.m14.1c">Teammate\_of</annotation><annotation encoding="application/x-llamapun" id="S1.p4.14.m14.1d">italic_T italic_e italic_a italic_m italic_m italic_a italic_t italic_e _ italic_o italic_f</annotation></semantics></math> relation, there exists a fact <math alttext="(E_{6},r_{2},E_{5})" class="ltx_Math" display="inline" id="S1.p4.15.m15.3"><semantics id="S1.p4.15.m15.3a"><mrow id="S1.p4.15.m15.3.3.3" xref="S1.p4.15.m15.3.3.4.cmml"><mo id="S1.p4.15.m15.3.3.3.4" stretchy="false" xref="S1.p4.15.m15.3.3.4.cmml">(</mo><msub id="S1.p4.15.m15.1.1.1.1" xref="S1.p4.15.m15.1.1.1.1.cmml"><mi id="S1.p4.15.m15.1.1.1.1.2" xref="S1.p4.15.m15.1.1.1.1.2.cmml">E</mi><mn id="S1.p4.15.m15.1.1.1.1.3" xref="S1.p4.15.m15.1.1.1.1.3.cmml">6</mn></msub><mo id="S1.p4.15.m15.3.3.3.5" xref="S1.p4.15.m15.3.3.4.cmml">,</mo><msub id="S1.p4.15.m15.2.2.2.2" xref="S1.p4.15.m15.2.2.2.2.cmml"><mi id="S1.p4.15.m15.2.2.2.2.2" xref="S1.p4.15.m15.2.2.2.2.2.cmml">r</mi><mn id="S1.p4.15.m15.2.2.2.2.3" xref="S1.p4.15.m15.2.2.2.2.3.cmml">2</mn></msub><mo id="S1.p4.15.m15.3.3.3.6" xref="S1.p4.15.m15.3.3.4.cmml">,</mo><msub id="S1.p4.15.m15.3.3.3.3" xref="S1.p4.15.m15.3.3.3.3.cmml"><mi id="S1.p4.15.m15.3.3.3.3.2" xref="S1.p4.15.m15.3.3.3.3.2.cmml">E</mi><mn id="S1.p4.15.m15.3.3.3.3.3" xref="S1.p4.15.m15.3.3.3.3.3.cmml">5</mn></msub><mo id="S1.p4.15.m15.3.3.3.7" stretchy="false" xref="S1.p4.15.m15.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.15.m15.3b"><vector id="S1.p4.15.m15.3.3.4.cmml" xref="S1.p4.15.m15.3.3.3"><apply id="S1.p4.15.m15.1.1.1.1.cmml" xref="S1.p4.15.m15.1.1.1.1"><csymbol cd="ambiguous" id="S1.p4.15.m15.1.1.1.1.1.cmml" xref="S1.p4.15.m15.1.1.1.1">subscript</csymbol><ci id="S1.p4.15.m15.1.1.1.1.2.cmml" xref="S1.p4.15.m15.1.1.1.1.2">𝐸</ci><cn id="S1.p4.15.m15.1.1.1.1.3.cmml" type="integer" xref="S1.p4.15.m15.1.1.1.1.3">6</cn></apply><apply id="S1.p4.15.m15.2.2.2.2.cmml" xref="S1.p4.15.m15.2.2.2.2"><csymbol cd="ambiguous" id="S1.p4.15.m15.2.2.2.2.1.cmml" xref="S1.p4.15.m15.2.2.2.2">subscript</csymbol><ci id="S1.p4.15.m15.2.2.2.2.2.cmml" xref="S1.p4.15.m15.2.2.2.2.2">𝑟</ci><cn id="S1.p4.15.m15.2.2.2.2.3.cmml" type="integer" xref="S1.p4.15.m15.2.2.2.2.3">2</cn></apply><apply id="S1.p4.15.m15.3.3.3.3.cmml" xref="S1.p4.15.m15.3.3.3.3"><csymbol cd="ambiguous" id="S1.p4.15.m15.3.3.3.3.1.cmml" xref="S1.p4.15.m15.3.3.3.3">subscript</csymbol><ci id="S1.p4.15.m15.3.3.3.3.2.cmml" xref="S1.p4.15.m15.3.3.3.3.2">𝐸</ci><cn id="S1.p4.15.m15.3.3.3.3.3.cmml" type="integer" xref="S1.p4.15.m15.3.3.3.3.3">5</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.15.m15.3c">(E_{6},r_{2},E_{5})</annotation><annotation encoding="application/x-llamapun" id="S1.p4.15.m15.3d">( italic_E start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_E start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT )</annotation></semantics></math> in the real world but not in the KG. In this case, existing models fail to predict the entity <math alttext="E_{5}" class="ltx_Math" display="inline" id="S1.p4.16.m16.1"><semantics id="S1.p4.16.m16.1a"><msub id="S1.p4.16.m16.1.1" xref="S1.p4.16.m16.1.1.cmml"><mi id="S1.p4.16.m16.1.1.2" xref="S1.p4.16.m16.1.1.2.cmml">E</mi><mn id="S1.p4.16.m16.1.1.3" xref="S1.p4.16.m16.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.16.m16.1b"><apply id="S1.p4.16.m16.1.1.cmml" xref="S1.p4.16.m16.1.1"><csymbol cd="ambiguous" id="S1.p4.16.m16.1.1.1.cmml" xref="S1.p4.16.m16.1.1">subscript</csymbol><ci id="S1.p4.16.m16.1.1.2.cmml" xref="S1.p4.16.m16.1.1.2">𝐸</ci><cn id="S1.p4.16.m16.1.1.3.cmml" type="integer" xref="S1.p4.16.m16.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.16.m16.1c">E_{5}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.16.m16.1d">italic_E start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT</annotation></semantics></math> when provided with the head entity <math alttext="E_{6}" class="ltx_Math" display="inline" id="S1.p4.17.m17.1"><semantics id="S1.p4.17.m17.1a"><msub id="S1.p4.17.m17.1.1" xref="S1.p4.17.m17.1.1.cmml"><mi id="S1.p4.17.m17.1.1.2" xref="S1.p4.17.m17.1.1.2.cmml">E</mi><mn id="S1.p4.17.m17.1.1.3" xref="S1.p4.17.m17.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.17.m17.1b"><apply id="S1.p4.17.m17.1.1.cmml" xref="S1.p4.17.m17.1.1"><csymbol cd="ambiguous" id="S1.p4.17.m17.1.1.1.cmml" xref="S1.p4.17.m17.1.1">subscript</csymbol><ci id="S1.p4.17.m17.1.1.2.cmml" xref="S1.p4.17.m17.1.1.2">𝐸</ci><cn id="S1.p4.17.m17.1.1.3.cmml" type="integer" xref="S1.p4.17.m17.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.17.m17.1c">E_{6}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.17.m17.1d">italic_E start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math> and relation <math alttext="r_{2}" class="ltx_Math" display="inline" id="S1.p4.18.m18.1"><semantics id="S1.p4.18.m18.1a"><msub id="S1.p4.18.m18.1.1" xref="S1.p4.18.m18.1.1.cmml"><mi id="S1.p4.18.m18.1.1.2" xref="S1.p4.18.m18.1.1.2.cmml">r</mi><mn id="S1.p4.18.m18.1.1.3" xref="S1.p4.18.m18.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.18.m18.1b"><apply id="S1.p4.18.m18.1.1.cmml" xref="S1.p4.18.m18.1.1"><csymbol cd="ambiguous" id="S1.p4.18.m18.1.1.1.cmml" xref="S1.p4.18.m18.1.1">subscript</csymbol><ci id="S1.p4.18.m18.1.1.2.cmml" xref="S1.p4.18.m18.1.1.2">𝑟</ci><cn id="S1.p4.18.m18.1.1.3.cmml" type="integer" xref="S1.p4.18.m18.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.18.m18.1c">r_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.18.m18.1d">italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. This failure is primarily due to insufficient embedded information for <math alttext="E_{6}" class="ltx_Math" display="inline" id="S1.p4.19.m19.1"><semantics id="S1.p4.19.m19.1a"><msub id="S1.p4.19.m19.1.1" xref="S1.p4.19.m19.1.1.cmml"><mi id="S1.p4.19.m19.1.1.2" xref="S1.p4.19.m19.1.1.2.cmml">E</mi><mn id="S1.p4.19.m19.1.1.3" xref="S1.p4.19.m19.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.19.m19.1b"><apply id="S1.p4.19.m19.1.1.cmml" xref="S1.p4.19.m19.1.1"><csymbol cd="ambiguous" id="S1.p4.19.m19.1.1.1.cmml" xref="S1.p4.19.m19.1.1">subscript</csymbol><ci id="S1.p4.19.m19.1.1.2.cmml" xref="S1.p4.19.m19.1.1.2">𝐸</ci><cn id="S1.p4.19.m19.1.1.3.cmml" type="integer" xref="S1.p4.19.m19.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.19.m19.1c">E_{6}</annotation><annotation encoding="application/x-llamapun" id="S1.p4.19.m19.1d">italic_E start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.4"><span class="ltx_text ltx_font_bold" id="S1.p5.4.5">Challenge 2: Existing GAT-based approaches demonstrate poor performance in predicting the tail (head) entity that shares the same relation and head (tail) entity with others.</span>
In heterogeneous KGs, it is quite common to encounter scenarios where different tail (head) entities share the same relation with a particular head (tail) entity, as depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">1</span></a>(b).
In such cases, existing GAT-based approaches assign weights to entities based on relations.
<span class="ltx_text" id="S1.p5.4.6" style="color:#000000;">This will directly lead to the following two limitation: </span>
<span class="ltx_text" id="S1.p5.2.2" style="color:#000000;">1) Some information about neighboring entities may be lost. Relations may prioritize specific information about entities while disregarding other information. For example, consider the example illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S1.F2" title="Figure 2 ‣ 1. Introduction ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">2</span></a>, where the entity of a basketball player, <math alttext="Ming\ Yao" class="ltx_Math" display="inline" id="S1.p5.1.1.m1.1"><semantics id="S1.p5.1.1.m1.1a"><mrow id="S1.p5.1.1.m1.1.1" xref="S1.p5.1.1.m1.1.1.cmml"><mi id="S1.p5.1.1.m1.1.1.2" mathcolor="#000000" xref="S1.p5.1.1.m1.1.1.2.cmml">M</mi><mo id="S1.p5.1.1.m1.1.1.1" xref="S1.p5.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.1.1.m1.1.1.3" mathcolor="#000000" xref="S1.p5.1.1.m1.1.1.3.cmml">i</mi><mo id="S1.p5.1.1.m1.1.1.1a" xref="S1.p5.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.1.1.m1.1.1.4" mathcolor="#000000" xref="S1.p5.1.1.m1.1.1.4.cmml">n</mi><mo id="S1.p5.1.1.m1.1.1.1b" xref="S1.p5.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.1.1.m1.1.1.5" mathcolor="#000000" xref="S1.p5.1.1.m1.1.1.5.cmml">g</mi><mo id="S1.p5.1.1.m1.1.1.1c" lspace="0.500em" xref="S1.p5.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.1.1.m1.1.1.6" mathcolor="#000000" xref="S1.p5.1.1.m1.1.1.6.cmml">Y</mi><mo id="S1.p5.1.1.m1.1.1.1d" xref="S1.p5.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.1.1.m1.1.1.7" mathcolor="#000000" xref="S1.p5.1.1.m1.1.1.7.cmml">a</mi><mo id="S1.p5.1.1.m1.1.1.1e" xref="S1.p5.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.1.1.m1.1.1.8" mathcolor="#000000" xref="S1.p5.1.1.m1.1.1.8.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.1.1.m1.1b"><apply id="S1.p5.1.1.m1.1.1.cmml" xref="S1.p5.1.1.m1.1.1"><times id="S1.p5.1.1.m1.1.1.1.cmml" xref="S1.p5.1.1.m1.1.1.1"></times><ci id="S1.p5.1.1.m1.1.1.2.cmml" xref="S1.p5.1.1.m1.1.1.2">𝑀</ci><ci id="S1.p5.1.1.m1.1.1.3.cmml" xref="S1.p5.1.1.m1.1.1.3">𝑖</ci><ci id="S1.p5.1.1.m1.1.1.4.cmml" xref="S1.p5.1.1.m1.1.1.4">𝑛</ci><ci id="S1.p5.1.1.m1.1.1.5.cmml" xref="S1.p5.1.1.m1.1.1.5">𝑔</ci><ci id="S1.p5.1.1.m1.1.1.6.cmml" xref="S1.p5.1.1.m1.1.1.6">𝑌</ci><ci id="S1.p5.1.1.m1.1.1.7.cmml" xref="S1.p5.1.1.m1.1.1.7">𝑎</ci><ci id="S1.p5.1.1.m1.1.1.8.cmml" xref="S1.p5.1.1.m1.1.1.8">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.1.m1.1c">Ming\ Yao</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.1.m1.1d">italic_M italic_i italic_n italic_g italic_Y italic_a italic_o</annotation></semantics></math>, encompasses various aspects of information such as family information and occupation information. However, the relation <math alttext="Teammate\_of" class="ltx_Math" display="inline" id="S1.p5.2.2.m2.1"><semantics id="S1.p5.2.2.m2.1a"><mrow id="S1.p5.2.2.m2.1.1" xref="S1.p5.2.2.m2.1.1.cmml"><mi id="S1.p5.2.2.m2.1.1.2" mathcolor="#000000" xref="S1.p5.2.2.m2.1.1.2.cmml">T</mi><mo id="S1.p5.2.2.m2.1.1.1" xref="S1.p5.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.2.2.m2.1.1.3" mathcolor="#000000" xref="S1.p5.2.2.m2.1.1.3.cmml">e</mi><mo id="S1.p5.2.2.m2.1.1.1a" xref="S1.p5.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.2.2.m2.1.1.4" mathcolor="#000000" xref="S1.p5.2.2.m2.1.1.4.cmml">a</mi><mo id="S1.p5.2.2.m2.1.1.1b" xref="S1.p5.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.2.2.m2.1.1.5" mathcolor="#000000" xref="S1.p5.2.2.m2.1.1.5.cmml">m</mi><mo id="S1.p5.2.2.m2.1.1.1c" xref="S1.p5.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.2.2.m2.1.1.6" mathcolor="#000000" xref="S1.p5.2.2.m2.1.1.6.cmml">m</mi><mo id="S1.p5.2.2.m2.1.1.1d" xref="S1.p5.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.2.2.m2.1.1.7" mathcolor="#000000" xref="S1.p5.2.2.m2.1.1.7.cmml">a</mi><mo id="S1.p5.2.2.m2.1.1.1e" xref="S1.p5.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.2.2.m2.1.1.8" mathcolor="#000000" xref="S1.p5.2.2.m2.1.1.8.cmml">t</mi><mo id="S1.p5.2.2.m2.1.1.1f" xref="S1.p5.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.2.2.m2.1.1.9" mathcolor="#000000" xref="S1.p5.2.2.m2.1.1.9.cmml">e</mi><mo id="S1.p5.2.2.m2.1.1.1g" xref="S1.p5.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.2.2.m2.1.1.10" mathcolor="#000000" mathvariant="normal" xref="S1.p5.2.2.m2.1.1.10.cmml">_</mi><mo id="S1.p5.2.2.m2.1.1.1h" xref="S1.p5.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.2.2.m2.1.1.11" mathcolor="#000000" xref="S1.p5.2.2.m2.1.1.11.cmml">o</mi><mo id="S1.p5.2.2.m2.1.1.1i" xref="S1.p5.2.2.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.2.2.m2.1.1.12" mathcolor="#000000" xref="S1.p5.2.2.m2.1.1.12.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.2.2.m2.1b"><apply id="S1.p5.2.2.m2.1.1.cmml" xref="S1.p5.2.2.m2.1.1"><times id="S1.p5.2.2.m2.1.1.1.cmml" xref="S1.p5.2.2.m2.1.1.1"></times><ci id="S1.p5.2.2.m2.1.1.2.cmml" xref="S1.p5.2.2.m2.1.1.2">𝑇</ci><ci id="S1.p5.2.2.m2.1.1.3.cmml" xref="S1.p5.2.2.m2.1.1.3">𝑒</ci><ci id="S1.p5.2.2.m2.1.1.4.cmml" xref="S1.p5.2.2.m2.1.1.4">𝑎</ci><ci id="S1.p5.2.2.m2.1.1.5.cmml" xref="S1.p5.2.2.m2.1.1.5">𝑚</ci><ci id="S1.p5.2.2.m2.1.1.6.cmml" xref="S1.p5.2.2.m2.1.1.6">𝑚</ci><ci id="S1.p5.2.2.m2.1.1.7.cmml" xref="S1.p5.2.2.m2.1.1.7">𝑎</ci><ci id="S1.p5.2.2.m2.1.1.8.cmml" xref="S1.p5.2.2.m2.1.1.8">𝑡</ci><ci id="S1.p5.2.2.m2.1.1.9.cmml" xref="S1.p5.2.2.m2.1.1.9">𝑒</ci><ci id="S1.p5.2.2.m2.1.1.10.cmml" xref="S1.p5.2.2.m2.1.1.10">_</ci><ci id="S1.p5.2.2.m2.1.1.11.cmml" xref="S1.p5.2.2.m2.1.1.11">𝑜</ci><ci id="S1.p5.2.2.m2.1.1.12.cmml" xref="S1.p5.2.2.m2.1.1.12">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.2.m2.1c">Teammate\_of</annotation><annotation encoding="application/x-llamapun" id="S1.p5.2.2.m2.1d">italic_T italic_e italic_a italic_m italic_m italic_a italic_t italic_e _ italic_o italic_f</annotation></semantics></math> primarily focuses on the occupation information while neglecting other aspects.</span>
<span class="ltx_text" id="S1.p5.4.4" style="color:#000000;">2) Another limitation lies in the inability to capture the varying emphasis that the head entity places on different tail entities within the same relation. Even through the same relation, the head entity will have different inclinations towards neighboring entities. For example, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S1.F2" title="Figure 2 ‣ 1. Introduction ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">2</span></a>, <math alttext="Ming\ Yao" class="ltx_Math" display="inline" id="S1.p5.3.3.m1.1"><semantics id="S1.p5.3.3.m1.1a"><mrow id="S1.p5.3.3.m1.1.1" xref="S1.p5.3.3.m1.1.1.cmml"><mi id="S1.p5.3.3.m1.1.1.2" mathcolor="#000000" xref="S1.p5.3.3.m1.1.1.2.cmml">M</mi><mo id="S1.p5.3.3.m1.1.1.1" xref="S1.p5.3.3.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.3.3.m1.1.1.3" mathcolor="#000000" xref="S1.p5.3.3.m1.1.1.3.cmml">i</mi><mo id="S1.p5.3.3.m1.1.1.1a" xref="S1.p5.3.3.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.3.3.m1.1.1.4" mathcolor="#000000" xref="S1.p5.3.3.m1.1.1.4.cmml">n</mi><mo id="S1.p5.3.3.m1.1.1.1b" xref="S1.p5.3.3.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.3.3.m1.1.1.5" mathcolor="#000000" xref="S1.p5.3.3.m1.1.1.5.cmml">g</mi><mo id="S1.p5.3.3.m1.1.1.1c" lspace="0.500em" xref="S1.p5.3.3.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.3.3.m1.1.1.6" mathcolor="#000000" xref="S1.p5.3.3.m1.1.1.6.cmml">Y</mi><mo id="S1.p5.3.3.m1.1.1.1d" xref="S1.p5.3.3.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.3.3.m1.1.1.7" mathcolor="#000000" xref="S1.p5.3.3.m1.1.1.7.cmml">a</mi><mo id="S1.p5.3.3.m1.1.1.1e" xref="S1.p5.3.3.m1.1.1.1.cmml">⁢</mo><mi id="S1.p5.3.3.m1.1.1.8" mathcolor="#000000" xref="S1.p5.3.3.m1.1.1.8.cmml">o</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.3.3.m1.1b"><apply id="S1.p5.3.3.m1.1.1.cmml" xref="S1.p5.3.3.m1.1.1"><times id="S1.p5.3.3.m1.1.1.1.cmml" xref="S1.p5.3.3.m1.1.1.1"></times><ci id="S1.p5.3.3.m1.1.1.2.cmml" xref="S1.p5.3.3.m1.1.1.2">𝑀</ci><ci id="S1.p5.3.3.m1.1.1.3.cmml" xref="S1.p5.3.3.m1.1.1.3">𝑖</ci><ci id="S1.p5.3.3.m1.1.1.4.cmml" xref="S1.p5.3.3.m1.1.1.4">𝑛</ci><ci id="S1.p5.3.3.m1.1.1.5.cmml" xref="S1.p5.3.3.m1.1.1.5">𝑔</ci><ci id="S1.p5.3.3.m1.1.1.6.cmml" xref="S1.p5.3.3.m1.1.1.6">𝑌</ci><ci id="S1.p5.3.3.m1.1.1.7.cmml" xref="S1.p5.3.3.m1.1.1.7">𝑎</ci><ci id="S1.p5.3.3.m1.1.1.8.cmml" xref="S1.p5.3.3.m1.1.1.8">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.3.3.m1.1c">Ming\ Yao</annotation><annotation encoding="application/x-llamapun" id="S1.p5.3.3.m1.1d">italic_M italic_i italic_n italic_g italic_Y italic_a italic_o</annotation></semantics></math> may have varying inclinations towards different teammates because of information unrelated to occupation information, such as personality and family. This difference cannot be explained if we only consider the relation <math alttext="Teammate\_of" class="ltx_Math" display="inline" id="S1.p5.4.4.m2.1"><semantics id="S1.p5.4.4.m2.1a"><mrow id="S1.p5.4.4.m2.1.1" xref="S1.p5.4.4.m2.1.1.cmml"><mi id="S1.p5.4.4.m2.1.1.2" mathcolor="#000000" xref="S1.p5.4.4.m2.1.1.2.cmml">T</mi><mo id="S1.p5.4.4.m2.1.1.1" xref="S1.p5.4.4.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.4.4.m2.1.1.3" mathcolor="#000000" xref="S1.p5.4.4.m2.1.1.3.cmml">e</mi><mo id="S1.p5.4.4.m2.1.1.1a" xref="S1.p5.4.4.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.4.4.m2.1.1.4" mathcolor="#000000" xref="S1.p5.4.4.m2.1.1.4.cmml">a</mi><mo id="S1.p5.4.4.m2.1.1.1b" xref="S1.p5.4.4.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.4.4.m2.1.1.5" mathcolor="#000000" xref="S1.p5.4.4.m2.1.1.5.cmml">m</mi><mo id="S1.p5.4.4.m2.1.1.1c" xref="S1.p5.4.4.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.4.4.m2.1.1.6" mathcolor="#000000" xref="S1.p5.4.4.m2.1.1.6.cmml">m</mi><mo id="S1.p5.4.4.m2.1.1.1d" xref="S1.p5.4.4.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.4.4.m2.1.1.7" mathcolor="#000000" xref="S1.p5.4.4.m2.1.1.7.cmml">a</mi><mo id="S1.p5.4.4.m2.1.1.1e" xref="S1.p5.4.4.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.4.4.m2.1.1.8" mathcolor="#000000" xref="S1.p5.4.4.m2.1.1.8.cmml">t</mi><mo id="S1.p5.4.4.m2.1.1.1f" xref="S1.p5.4.4.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.4.4.m2.1.1.9" mathcolor="#000000" xref="S1.p5.4.4.m2.1.1.9.cmml">e</mi><mo id="S1.p5.4.4.m2.1.1.1g" xref="S1.p5.4.4.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.4.4.m2.1.1.10" mathcolor="#000000" mathvariant="normal" xref="S1.p5.4.4.m2.1.1.10.cmml">_</mi><mo id="S1.p5.4.4.m2.1.1.1h" xref="S1.p5.4.4.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.4.4.m2.1.1.11" mathcolor="#000000" xref="S1.p5.4.4.m2.1.1.11.cmml">o</mi><mo id="S1.p5.4.4.m2.1.1.1i" xref="S1.p5.4.4.m2.1.1.1.cmml">⁢</mo><mi id="S1.p5.4.4.m2.1.1.12" mathcolor="#000000" xref="S1.p5.4.4.m2.1.1.12.cmml">f</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.4.4.m2.1b"><apply id="S1.p5.4.4.m2.1.1.cmml" xref="S1.p5.4.4.m2.1.1"><times id="S1.p5.4.4.m2.1.1.1.cmml" xref="S1.p5.4.4.m2.1.1.1"></times><ci id="S1.p5.4.4.m2.1.1.2.cmml" xref="S1.p5.4.4.m2.1.1.2">𝑇</ci><ci id="S1.p5.4.4.m2.1.1.3.cmml" xref="S1.p5.4.4.m2.1.1.3">𝑒</ci><ci id="S1.p5.4.4.m2.1.1.4.cmml" xref="S1.p5.4.4.m2.1.1.4">𝑎</ci><ci id="S1.p5.4.4.m2.1.1.5.cmml" xref="S1.p5.4.4.m2.1.1.5">𝑚</ci><ci id="S1.p5.4.4.m2.1.1.6.cmml" xref="S1.p5.4.4.m2.1.1.6">𝑚</ci><ci id="S1.p5.4.4.m2.1.1.7.cmml" xref="S1.p5.4.4.m2.1.1.7">𝑎</ci><ci id="S1.p5.4.4.m2.1.1.8.cmml" xref="S1.p5.4.4.m2.1.1.8">𝑡</ci><ci id="S1.p5.4.4.m2.1.1.9.cmml" xref="S1.p5.4.4.m2.1.1.9">𝑒</ci><ci id="S1.p5.4.4.m2.1.1.10.cmml" xref="S1.p5.4.4.m2.1.1.10">_</ci><ci id="S1.p5.4.4.m2.1.1.11.cmml" xref="S1.p5.4.4.m2.1.1.11">𝑜</ci><ci id="S1.p5.4.4.m2.1.1.12.cmml" xref="S1.p5.4.4.m2.1.1.12">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.4.4.m2.1c">Teammate\_of</annotation><annotation encoding="application/x-llamapun" id="S1.p5.4.4.m2.1d">italic_T italic_e italic_a italic_m italic_m italic_a italic_t italic_e _ italic_o italic_f</annotation></semantics></math>.</span></p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="294" id="S1.F2.g1" src="extracted/5774499/feature_in_different_scenarios.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Entity information is represented by a combination of information in different scenarios. In the feature vector, different dimensions correspond to different scenes. A relation is a concrete representation of a scene.</figcaption>
</figure>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.5">In this paper, we propose a novel end-to-end GAT-based method for heterogeneous knowledge graph completion, aiming to overcome the limitations of existing GAT-based methods.
<span class="ltx_text" id="S1.p6.5.6" style="color:#000000;">In response to challenge 1, that is, the model is overfitting on sparse entities and relations due to a large number of parameters, our proposed solution is to reduce model parameters.</span>
<span class="ltx_text" id="S1.p6.5.5" style="color:#000000;">Specifically, we first use <span class="ltx_text ltx_font_bold" id="S1.p6.5.5.1">reducing features</span> to reduce the number of parameters representing relations. Instead of using matrices, we represent relations using embedding vectors.
Additionally, reducing parameters may limit the model’s ability to model relations with rich information. To address this, we introduce <span class="ltx_text ltx_font_bold" id="S1.p6.5.5.2">weight sharing</span> to enhance the feature extraction capabilities of relations. We use the same attention projection matrices for all relations, which have a global perspective of KG.
By applying these two methods, we reduce the parameters for representing relations from <math alttext="2nDF" class="ltx_Math" display="inline" id="S1.p6.1.1.m1.1"><semantics id="S1.p6.1.1.m1.1a"><mrow id="S1.p6.1.1.m1.1.1" xref="S1.p6.1.1.m1.1.1.cmml"><mn id="S1.p6.1.1.m1.1.1.2" mathcolor="#000000" xref="S1.p6.1.1.m1.1.1.2.cmml">2</mn><mo id="S1.p6.1.1.m1.1.1.1" xref="S1.p6.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.p6.1.1.m1.1.1.3" mathcolor="#000000" xref="S1.p6.1.1.m1.1.1.3.cmml">n</mi><mo id="S1.p6.1.1.m1.1.1.1a" xref="S1.p6.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.p6.1.1.m1.1.1.4" mathcolor="#000000" xref="S1.p6.1.1.m1.1.1.4.cmml">D</mi><mo id="S1.p6.1.1.m1.1.1.1b" xref="S1.p6.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S1.p6.1.1.m1.1.1.5" mathcolor="#000000" xref="S1.p6.1.1.m1.1.1.5.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.1.1.m1.1b"><apply id="S1.p6.1.1.m1.1.1.cmml" xref="S1.p6.1.1.m1.1.1"><times id="S1.p6.1.1.m1.1.1.1.cmml" xref="S1.p6.1.1.m1.1.1.1"></times><cn id="S1.p6.1.1.m1.1.1.2.cmml" type="integer" xref="S1.p6.1.1.m1.1.1.2">2</cn><ci id="S1.p6.1.1.m1.1.1.3.cmml" xref="S1.p6.1.1.m1.1.1.3">𝑛</ci><ci id="S1.p6.1.1.m1.1.1.4.cmml" xref="S1.p6.1.1.m1.1.1.4">𝐷</ci><ci id="S1.p6.1.1.m1.1.1.5.cmml" xref="S1.p6.1.1.m1.1.1.5">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.1.m1.1c">2nDF</annotation><annotation encoding="application/x-llamapun" id="S1.p6.1.1.m1.1d">2 italic_n italic_D italic_F</annotation></semantics></math> to <math alttext="nD+2DF" class="ltx_Math" display="inline" id="S1.p6.2.2.m2.1"><semantics id="S1.p6.2.2.m2.1a"><mrow id="S1.p6.2.2.m2.1.1" xref="S1.p6.2.2.m2.1.1.cmml"><mrow id="S1.p6.2.2.m2.1.1.2" xref="S1.p6.2.2.m2.1.1.2.cmml"><mi id="S1.p6.2.2.m2.1.1.2.2" mathcolor="#000000" xref="S1.p6.2.2.m2.1.1.2.2.cmml">n</mi><mo id="S1.p6.2.2.m2.1.1.2.1" xref="S1.p6.2.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S1.p6.2.2.m2.1.1.2.3" mathcolor="#000000" xref="S1.p6.2.2.m2.1.1.2.3.cmml">D</mi></mrow><mo id="S1.p6.2.2.m2.1.1.1" mathcolor="#000000" xref="S1.p6.2.2.m2.1.1.1.cmml">+</mo><mrow id="S1.p6.2.2.m2.1.1.3" xref="S1.p6.2.2.m2.1.1.3.cmml"><mn id="S1.p6.2.2.m2.1.1.3.2" mathcolor="#000000" xref="S1.p6.2.2.m2.1.1.3.2.cmml">2</mn><mo id="S1.p6.2.2.m2.1.1.3.1" xref="S1.p6.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S1.p6.2.2.m2.1.1.3.3" mathcolor="#000000" xref="S1.p6.2.2.m2.1.1.3.3.cmml">D</mi><mo id="S1.p6.2.2.m2.1.1.3.1a" xref="S1.p6.2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S1.p6.2.2.m2.1.1.3.4" mathcolor="#000000" xref="S1.p6.2.2.m2.1.1.3.4.cmml">F</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.2.2.m2.1b"><apply id="S1.p6.2.2.m2.1.1.cmml" xref="S1.p6.2.2.m2.1.1"><plus id="S1.p6.2.2.m2.1.1.1.cmml" xref="S1.p6.2.2.m2.1.1.1"></plus><apply id="S1.p6.2.2.m2.1.1.2.cmml" xref="S1.p6.2.2.m2.1.1.2"><times id="S1.p6.2.2.m2.1.1.2.1.cmml" xref="S1.p6.2.2.m2.1.1.2.1"></times><ci id="S1.p6.2.2.m2.1.1.2.2.cmml" xref="S1.p6.2.2.m2.1.1.2.2">𝑛</ci><ci id="S1.p6.2.2.m2.1.1.2.3.cmml" xref="S1.p6.2.2.m2.1.1.2.3">𝐷</ci></apply><apply id="S1.p6.2.2.m2.1.1.3.cmml" xref="S1.p6.2.2.m2.1.1.3"><times id="S1.p6.2.2.m2.1.1.3.1.cmml" xref="S1.p6.2.2.m2.1.1.3.1"></times><cn id="S1.p6.2.2.m2.1.1.3.2.cmml" type="integer" xref="S1.p6.2.2.m2.1.1.3.2">2</cn><ci id="S1.p6.2.2.m2.1.1.3.3.cmml" xref="S1.p6.2.2.m2.1.1.3.3">𝐷</ci><ci id="S1.p6.2.2.m2.1.1.3.4.cmml" xref="S1.p6.2.2.m2.1.1.3.4">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.2.2.m2.1c">nD+2DF</annotation><annotation encoding="application/x-llamapun" id="S1.p6.2.2.m2.1d">italic_n italic_D + 2 italic_D italic_F</annotation></semantics></math>, where <math alttext="n" class="ltx_Math" display="inline" id="S1.p6.3.3.m3.1"><semantics id="S1.p6.3.3.m3.1a"><mi id="S1.p6.3.3.m3.1.1" mathcolor="#000000" xref="S1.p6.3.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S1.p6.3.3.m3.1b"><ci id="S1.p6.3.3.m3.1.1.cmml" xref="S1.p6.3.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.3.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S1.p6.3.3.m3.1d">italic_n</annotation></semantics></math> represents the number of relations, <math alttext="D" class="ltx_Math" display="inline" id="S1.p6.4.4.m4.1"><semantics id="S1.p6.4.4.m4.1a"><mi id="S1.p6.4.4.m4.1.1" mathcolor="#000000" xref="S1.p6.4.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S1.p6.4.4.m4.1b"><ci id="S1.p6.4.4.m4.1.1.cmml" xref="S1.p6.4.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.4.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S1.p6.4.4.m4.1d">italic_D</annotation></semantics></math> represents the entity embedding dimension, and <math alttext="F" class="ltx_Math" display="inline" id="S1.p6.5.5.m5.1"><semantics id="S1.p6.5.5.m5.1a"><mi id="S1.p6.5.5.m5.1.1" mathcolor="#000000" xref="S1.p6.5.5.m5.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S1.p6.5.5.m5.1b"><ci id="S1.p6.5.5.m5.1.1.cmml" xref="S1.p6.5.5.m5.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.5.5.m5.1c">F</annotation><annotation encoding="application/x-llamapun" id="S1.p6.5.5.m5.1d">italic_F</annotation></semantics></math> represents the dimension of query or key vectors. In summary, our approach significantly reduces model parameters and effectively mitigates the problem of overfitting.</span></p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1"><span class="ltx_text" id="S1.p7.1.1" style="color:#000000;">Another challenge of existing GAT-based models, as stated in Challenge 2, is that they cannot effectively predict tail (head) entities that share head (tail) entities and relations with other entities.</span>
This challenge arises from the models’ failure to distinguish the importance of entities independently of the relations.
<span class="ltx_text" id="S1.p7.1.2" style="color:#000000;">To address this challenge, in addition to calculating attention scores between entities based on relations, we also introduce a novel entity-specific attention network.</span>
<span class="ltx_text" id="S1.p7.1.3" style="color:#000000;">The key to addressing challenge 2 is to address its two limitations, i.e. 1) the loss of partial information in neighboring entities and 2) the inability to represent the varying importance of the head entity to different tail entities connected to the same relation.</span>
<span class="ltx_text" id="S1.p7.1.4" style="color:#000000;">For the first limitation, the additionally introduced entity-specific attention network is capable of directly calculating attention scores for the head entities and the tail entities. Specifically, we linearly transform the head entities into query vectors and the tail entities into key vectors. Both are then fed into a single-layer feedforward neural network to obtain inter-entity attention scores.</span>
<span class="ltx_text" id="S1.p7.1.5" style="color:#000000;">2) Regarding the second limitation, the newly introduced attention network can produce more differentiated attention scores. Specifically, we perform a Hadamard product operation on the query vector and key vector to obtain an intermediate vector. The intermediate vector is used to calculate the attention score. As a result, tail entities that are similar to the head entity get higher attention scores, while dissimilar tail entities receive lower attention scores.</span></p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">In conclusion, our contributions are summarized as follows.</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce GATH, a novel <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S1.I1.i1.p1.1.1">GAT</span>-based method specifically designed for <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S1.I1.i1.p1.1.2">H</span>eterogeneous knowledge graph completion. GATH comprises two key components: an entity-specific attention network module and an entity-relation joint attention network module. These components work together to predict the missing entities.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">To address the issue of model overfitting on heterogeneous KGs, we propose a novel encoding and feature transformation method. This method enables the robust performance of GATH in scenarios with sparse samples by effectively reducing the number of model parameters.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We conduct a comprehensive evaluation of GATH on the FB15K-237 and WN18RR datasets. Results show that GATH has superior performance than other competitors on various evaluation metrics, including mean reciprocal ranking (MRR), mean ranking (MR), and Hits@n. Compared with the existing SOTA GAT-based model on Hits@10 and MRR metrics, our model improves performance by 5.2% and 5.2% on the FB15K-237 dataset, and by 4.5% and 14.6% on the WN18RR dataset, respectively.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Knowledge graph completion methods can be divided into translation-based models, semantic matching-based models, GCN-based models, GAT-based models, and language model-based models, as described below.</p>
</div>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Translation-based models</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.7">TransE <cite class="ltx_cite ltx_citemacro_citep">(Bordes et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib2" title="">2013</a>)</cite> is a pioneering work of translation-based model. Inspired by word2vec <cite class="ltx_cite ltx_citemacro_citep">(Mikolov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib18" title="">2013</a>)</cite>, TransE utilizes the translation invariance of word vectors. It maps the head entity, relation, and tail entity respectively to the dense vectors <math alttext="h" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.1.m1.1d">italic_h</annotation></semantics></math>, <math alttext="r" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.2.m2.1d">italic_r</annotation></semantics></math>, <math alttext="t" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="S2.SS0.SSS0.Px1.p1.3.m3.1a"><mi id="S2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.3.m3.1d">italic_t</annotation></semantics></math> in a low-dimensional space, and then adjusts <math alttext="h" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.4.m4.1"><semantics id="S2.SS0.SSS0.Px1.p1.4.m4.1a"><mi id="S2.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.4.m4.1b"><ci id="S2.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.4.m4.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.4.m4.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.4.m4.1d">italic_h</annotation></semantics></math>, <math alttext="r" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.5.m5.1"><semantics id="S2.SS0.SSS0.Px1.p1.5.m5.1a"><mi id="S2.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.5.m5.1b"><ci id="S2.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.5.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.5.m5.1c">r</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.5.m5.1d">italic_r</annotation></semantics></math>, <math alttext="t" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.6.m6.1"><semantics id="S2.SS0.SSS0.Px1.p1.6.m6.1a"><mi id="S2.SS0.SSS0.Px1.p1.6.m6.1.1" xref="S2.SS0.SSS0.Px1.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.6.m6.1b"><ci id="S2.SS0.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.6.m6.1d">italic_t</annotation></semantics></math> so that <math alttext="h+r\approx t" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.7.m7.1"><semantics id="S2.SS0.SSS0.Px1.p1.7.m7.1a"><mrow id="S2.SS0.SSS0.Px1.p1.7.m7.1.1" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.cmml"><mrow id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.cmml"><mi id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.2" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.2.cmml">h</mi><mo id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.1" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.1.cmml">+</mo><mi id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.3" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.3.cmml">r</mi></mrow><mo id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.1" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.1.cmml">≈</mo><mi id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.3" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.7.m7.1b"><apply id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1"><approx id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.1"></approx><apply id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2"><plus id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.1.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.1"></plus><ci id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.2.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.2">ℎ</ci><ci id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.2.3">𝑟</ci></apply><ci id="S2.SS0.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.7.m7.1c">h+r\approx t</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.7.m7.1d">italic_h + italic_r ≈ italic_t</annotation></semantics></math>. Subsequent models, such as TransH <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib35" title="">2014</a>)</cite>, TransR <cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib16" title="">2015</a>)</cite>, TransD <cite class="ltx_cite ltx_citemacro_citep">(Ji et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib13" title="">2015</a>)</cite>, etc., proposed novel methods of relational translation, increasing the complexity of models and improving their performance. These models are also known as <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px1.p1.7.1">translation models</span> or <span class="ltx_text ltx_font_italic" id="S2.SS0.SSS0.Px1.p1.7.2">additive models</span>. However, translation-based models have limited consideration of semantic information and struggle to handle one-to-many or many-to-many connections effectively. Despite their ease of expansion, these models have inherent limitations in capturing complex relations.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Semantic matching-based models</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">As opposed to translation-based models, semantic matching-based models evaluate the rationality of facts by matching the potential semantics in embedded entities and relations. These models utilize scoring functions to quantify the semantic similarity between entities. RESCAL <cite class="ltx_cite ltx_citemacro_citep">(Nickel et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib20" title="">2011</a>)</cite> declares a matrix for each relation and uses the bilinear function to calculate the rationality of triples. DistMult <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib37" title="">2014</a>)</cite> simplifies RESCAL by replacing the relation-specific matrix with a diagonal matrix. ComplEx <cite class="ltx_cite ltx_citemacro_citep">(Trouillon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib27" title="">2016</a>)</cite> extends DistMult to the complex space and is the first model to introduce complex number embeddings for knowledge graphs. However, although semantic matching-based models overcome the limitations of translation models by effectively capturing the symmetry or asymmetry of relations, they often struggle to efficiently model complex relational patterns. These models typically require a large number of parameters, leading to potential memory inefficiencies.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">GCN-based models</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px3.p1.1">GCN-based models enhance the vanilla GCN for knowledge graph embedding through the incorporation of 1) relation-specific linear transformations, 2) weighted aggregation, and 3) relation representation transformations. Among these, RGCN <cite class="ltx_cite ltx_citemacro_citep">(Schlichtkrull et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib22" title="">2018</a>)</cite> is the first work that introduces GCN to knowledge graph embedding. RGCN aggregates neighbor information through a relation-specific matrix. After that, SACN <cite class="ltx_cite ltx_citemacro_citep">(Shang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib23" title="">2019</a>)</cite> assigns static weights to each relation type. CompGCN <cite class="ltx_cite ltx_citemacro_citep">(Vashishth et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib29" title="">2019</a>)</cite> jointly embeds entities and relations and uses combination operators to model their interaction. However, GCN-based models often exhibit limited flexibility and require loading the entire knowledge graph into memory, leading to scalability issues and posing challenges when applied to large knowledge graphs.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">GAT-based models</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px4.p1.1">GAT-based models achieve state-of-the-art performance in knowledge graph embedding by dynamically modeling the interactions between entities and relations. In contrast to GCN, GAT <cite class="ltx_cite ltx_citemacro_citep">(Veličković et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib31" title="">2017</a>)</cite> introduces attention mechanisms to dynamically adjust node weights. Based on GAT, RGAT <cite class="ltx_cite ltx_citemacro_citep">(Busbridge et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib3" title="">2019</a>)</cite> utilizes self-attention to derive relation-related weights for relation features. It combines the inter-entity attention results from GAT to obtain the final outcome. DisenKGAT <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib36" title="">2021</a>)</cite> assumes that entities consist of multiple independent factors and leverages attention mechanisms within each sub-representation space to aggregate neighbor information. HRAN <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib15" title="">2021</a>)</cite> incorporates an entity-level encoder to generate neighborhood features for each relation type and a relation-level encoder to capture their relative importance. MRGAT <cite class="ltx_cite ltx_citemacro_citep">(Dai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib4" title="">2022</a>)</cite> utilizes two matrices for each relation type, embedding the head and tail entities into the query and key vectors for attention calculation. However, these models often face challenges such as overfitting on sparse data and limited scalability when dealing with a large number of rapidly increasing relations.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">Language model-based models</h4>
<div class="ltx_para" id="S2.SS0.SSS0.Px5.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px5.p1.1">Knowledge graph text has been successfully leveraged to pre-train embeddings in language model-based models. KG-BERT <cite class="ltx_cite ltx_citemacro_citep">(Yao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib38" title="">2019</a>)</cite> is the first model to apply BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib6" title="">2018</a>)</cite>, a pre-training language model widely used in various Natural Language Processing (NLP) tasks, to knowledge graph embedding. KG-BERT offers two variants for knowledge graph completion: KG-BERT (variant a) models triples using their textual descriptions, while KG-BERT (variant b) predicts relations using only the textual descriptions of the head and tail entities. On the other hand, LMKE <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib32" title="">2022</a>)</cite> utilizes a language model to generate embeddings for both entities and relations in the knowledge graph. Both KG-BERT and LMKE can effectively use large amounts of text data to pre-train embeddings for knowledge graph entities and relations. However, it is essential to note that the reliance on text data limits the application scenarios of these models.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Background</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Knowledge graph</h3>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Knowledge Graph</h4>
<div class="ltx_para" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.4">A knowledge graph (KG) can be denoted as <math alttext="\mathcal{G=(E,R,T)}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.1.m1.3"><semantics id="S3.SS1.SSS0.Px1.p1.1.m1.3a"><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.3.4" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.1.m1.3.4.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4.2.cmml">𝒢</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.3.4.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4.1.cmml">=</mo><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.1.cmml"><mo id="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.2.1" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">ℰ</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.2.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.1.m1.2.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.cmml">ℛ</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.2.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.1.m1.3.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.3.cmml">𝒯</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.2.4" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.1.m1.3b"><apply id="S3.SS1.SSS0.Px1.p1.1.m1.3.4.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4"><eq id="S3.SS1.SSS0.Px1.p1.1.m1.3.4.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4.1"></eq><ci id="S3.SS1.SSS0.Px1.p1.1.m1.3.4.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4.2">𝒢</ci><vector id="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.4.3.2"><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1">ℰ</ci><ci id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2">ℛ</ci><ci id="S3.SS1.SSS0.Px1.p1.1.m1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.3.3">𝒯</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.1.m1.3c">\mathcal{G=(E,R,T)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.1.m1.3d">caligraphic_G = ( caligraphic_E , caligraphic_R , caligraphic_T )</annotation></semantics></math>, where <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS1.SSS0.Px1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.2.m2.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.2.m2.1d">caligraphic_E</annotation></semantics></math> represents the set of entities, <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS1.SSS0.Px1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.3.m3.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.3.m3.1d">caligraphic_R</annotation></semantics></math> represents the set of relations, <math alttext="\mathcal{T\subseteq E\times R\times E}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS1.SSS0.Px1.p1.4.m4.1a"><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml">𝒯</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml">⊆</mo><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">ℰ</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.3.cmml">ℛ</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.4" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.4.cmml">ℰ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1"><subset id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1"></subset><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.2">𝒯</ci><apply id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3"><times id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.1"></times><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.2">ℰ</ci><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.3">ℛ</ci><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.4.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.3.4">ℰ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.4.m4.1c">\mathcal{T\subseteq E\times R\times E}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.4.m4.1d">caligraphic_T ⊆ caligraphic_E × caligraphic_R × caligraphic_E</annotation></semantics></math> represents the set of triplets.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Knowledge Graph Embedding</h4>
<div class="ltx_para" id="S3.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.10">A KG <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS1.SSS0.Px2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.1.m1.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.1.m1.1d">caligraphic_G</annotation></semantics></math> can be embedded into a low-dimensional vector space. In other words, a knowledge graph embedding is defined as,
<math alttext="\mathcal{KGE}=\{(\mathbf{h},\mathbf{r},\mathbf{t})|\mathbf{h},\mathbf{t}\in%
\mathbf{H},\mathbf{r}\in\mathbf{R}\}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.2.m2.7"><semantics id="S3.SS1.SSS0.Px2.p1.2.m2.7a"><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.7.7" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.cmml"><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.2.cmml">𝒦</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.3.cmml">𝒢</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.1a" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.4" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.4.cmml">ℰ</mi></mrow><mo id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.3.cmml">=</mo><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.3.cmml"><mo id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.3" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.3.1.cmml">{</mo><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.1.cmml"><mo id="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.2.1" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.1.cmml">(</mo><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">𝐡</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.1.cmml">,</mo><mi id="S3.SS1.SSS0.Px2.p1.2.m2.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.2.cmml">𝐫</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.2.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.1.cmml">,</mo><mi id="S3.SS1.SSS0.Px2.p1.2.m2.3.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.3.3.cmml">𝐭</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.2.4" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.4" lspace="0em" rspace="0em" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.3.1.cmml">|</mo><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.3.cmml"><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.cmml"><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.2.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.4.4" xref="S3.SS1.SSS0.Px2.p1.2.m2.4.4.cmml">𝐡</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.2.2.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.2.1.cmml">,</mo><mi id="S3.SS1.SSS0.Px2.p1.2.m2.5.5" xref="S3.SS1.SSS0.Px2.p1.2.m2.5.5.cmml">𝐭</mi></mrow><mo id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.1.cmml">∈</mo><mi id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.3.cmml">𝐇</mi></mrow><mo id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.3a.cmml">,</mo><mrow id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.2.cmml">𝐫</mi><mo id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.1.cmml">∈</mo><mi id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.3.cmml">𝐑</mi></mrow></mrow><mo id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.5" stretchy="false" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.2.m2.7b"><apply id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7"><eq id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.3"></eq><apply id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4"><times id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.1"></times><ci id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.2">𝒦</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.3">𝒢</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.4.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.4.4">ℰ</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2"><csymbol cd="latexml" id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.3">conditional-set</csymbol><vector id="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.6.6.1.1.1.2"><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1">𝐡</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.2.2">𝐫</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.3.3">𝐭</ci></vector><apply id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.3a.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1"><in id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.1"></in><list id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.2.2"><ci id="S3.SS1.SSS0.Px2.p1.2.m2.4.4.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.4.4">𝐡</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.5.5.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.5.5">𝐭</ci></list><ci id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.1.1.3">𝐇</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2"><in id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.1"></in><ci id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.2">𝐫</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.7.7.2.2.2.2.2.3">𝐑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.2.m2.7c">\mathcal{KGE}=\{(\mathbf{h},\mathbf{r},\mathbf{t})|\mathbf{h},\mathbf{t}\in%
\mathbf{H},\mathbf{r}\in\mathbf{R}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.2.m2.7d">caligraphic_K caligraphic_G caligraphic_E = { ( bold_h , bold_r , bold_t ) | bold_h , bold_t ∈ bold_H , bold_r ∈ bold_R }</annotation></semantics></math>, where <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS1.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.3.m3.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.3.m3.1d">bold_H</annotation></semantics></math> and <math alttext="\mathbf{R}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS1.SSS0.Px2.p1.4.m4.1a"><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">𝐑</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1">𝐑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.4.m4.1c">\mathbf{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.4.m4.1d">bold_R</annotation></semantics></math> represent the embedding sets of entities and relations which are <math alttext="n_{e}\times d_{e}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS1.SSS0.Px2.p1.5.m5.1a"><mrow id="S3.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml"><msub id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.2" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.2.cmml">n</mi><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.3" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.3.cmml">e</mi></msub><mo id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.1.cmml">×</mo><msub id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.2" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.2.cmml">d</mi><mi id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.3" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.3.cmml">e</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.5.m5.1b"><apply id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1"><times id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.1"></times><apply id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.2">𝑛</ci><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.2.3">𝑒</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.2">𝑑</ci><ci id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.5.m5.1c">n_{e}\times d_{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.5.m5.1d">italic_n start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="n_{r}\times d_{r}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.6.m6.1"><semantics id="S3.SS1.SSS0.Px2.p1.6.m6.1a"><mrow id="S3.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.cmml"><msub id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.2" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.2.cmml">n</mi><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.cmml">r</mi></msub><mo id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.1.cmml">×</mo><msub id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2.cmml">d</mi><mi id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3.cmml">r</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.6.m6.1b"><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1"><times id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.1"></times><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.2">𝑛</ci><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.2.3">𝑟</ci></apply><apply id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.2">𝑑</ci><ci id="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m6.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.6.m6.1c">n_{r}\times d_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.6.m6.1d">italic_n start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> dimensions respectively. <math alttext="n_{e}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.7.m7.1"><semantics id="S3.SS1.SSS0.Px2.p1.7.m7.1a"><msub id="S3.SS1.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.cmml">n</mi><mi id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.3" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.7.m7.1b"><apply id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.2">𝑛</ci><ci id="S3.SS1.SSS0.Px2.p1.7.m7.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.7.m7.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.7.m7.1c">n_{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.7.m7.1d">italic_n start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="n_{r}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.8.m8.1"><semantics id="S3.SS1.SSS0.Px2.p1.8.m8.1a"><msub id="S3.SS1.SSS0.Px2.p1.8.m8.1.1" xref="S3.SS1.SSS0.Px2.p1.8.m8.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.8.m8.1.1.2" xref="S3.SS1.SSS0.Px2.p1.8.m8.1.1.2.cmml">n</mi><mi id="S3.SS1.SSS0.Px2.p1.8.m8.1.1.3" xref="S3.SS1.SSS0.Px2.p1.8.m8.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.8.m8.1b"><apply id="S3.SS1.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.8.m8.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.8.m8.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.8.m8.1.1.2">𝑛</ci><ci id="S3.SS1.SSS0.Px2.p1.8.m8.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.8.m8.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.8.m8.1c">n_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.8.m8.1d">italic_n start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> represent the number of entities and relations respectively. <math alttext="d_{e}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.9.m9.1"><semantics id="S3.SS1.SSS0.Px2.p1.9.m9.1a"><msub id="S3.SS1.SSS0.Px2.p1.9.m9.1.1" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.2" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.2.cmml">d</mi><mi id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.3" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.9.m9.1b"><apply id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.2">𝑑</ci><ci id="S3.SS1.SSS0.Px2.p1.9.m9.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.9.m9.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.9.m9.1c">d_{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.9.m9.1d">italic_d start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="d_{r}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.10.m10.1"><semantics id="S3.SS1.SSS0.Px2.p1.10.m10.1a"><msub id="S3.SS1.SSS0.Px2.p1.10.m10.1.1" xref="S3.SS1.SSS0.Px2.p1.10.m10.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.10.m10.1.1.2" xref="S3.SS1.SSS0.Px2.p1.10.m10.1.1.2.cmml">d</mi><mi id="S3.SS1.SSS0.Px2.p1.10.m10.1.1.3" xref="S3.SS1.SSS0.Px2.p1.10.m10.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.10.m10.1b"><apply id="S3.SS1.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.10.m10.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.10.m10.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.10.m10.1.1.2">𝑑</ci><ci id="S3.SS1.SSS0.Px2.p1.10.m10.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.10.m10.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.10.m10.1c">d_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.10.m10.1d">italic_d start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> represent the embedding dimensions of entities and relations respectively.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Attention mechanism</h3>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Self-Attention Mechanism</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.2">Transformer <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib30" title="">2017</a>)</cite> introduces the self-attention mechanism, which has been widely adopted in various NLP tasks. Several language models, such as GPT <cite class="ltx_cite ltx_citemacro_citep">(Radford et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib21" title="">2018</a>)</cite> and BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib6" title="">2018</a>)</cite>, are built upon the self-attention mechanism and have achieved state-of-the-art (SOTA) performance in semantic analysis, machine translation, and other NLP tasks. The self-attention mechanism is responsible for encoding an input sequence consisting of <math alttext="d_{h}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><msub id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2">𝑑</ci><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">d_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>-dimensional vectors <math alttext="\mathbf{H}=[h_{1},...,h_{N}]^{T}\in\mathbb{R}^{N\times d_{h}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.2.m2.3"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.3a"><mrow id="S3.SS2.SSS0.Px1.p1.2.m2.3.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.4" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.4.cmml">𝐇</mi><mo id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.5" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.5.cmml">=</mo><msup id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.3.cmml"><mo id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.3.cmml">[</mo><msub id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.2.cmml">h</mi><mn id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.4" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.3.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.5" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.2.cmml">h</mi><mi id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.3.cmml">N</mi></msub><mo id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.6" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.3.cmml">]</mo></mrow><mi id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.4" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.4.cmml">T</mi></msup><mo id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.6" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.6.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.2.cmml">N</mi><mo id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.1.cmml">×</mo><msub id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.3b"><apply id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3"><and id="S3.SS2.SSS0.Px1.p1.2.m2.3.3a.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3"></and><apply id="S3.SS2.SSS0.Px1.p1.2.m2.3.3b.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3"><eq id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.5.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.5"></eq><ci id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.4">𝐇</ci><apply id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2">superscript</csymbol><list id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2"><apply id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.2">ℎ</ci><cn id="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p1.2.m2.2.2.1.1.1.1.3">1</cn></apply><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">…</ci><apply id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.2">ℎ</ci><ci id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.2.2.2.3">𝑁</ci></apply></list><ci id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.4.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.4">𝑇</ci></apply></apply><apply id="S3.SS2.SSS0.Px1.p1.2.m2.3.3c.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3"><in id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.6.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.6"></in><share href="https://arxiv.org/html/2408.02456v1#S3.SS2.SSS0.Px1.p1.2.m2.3.3.2.cmml" id="S3.SS2.SSS0.Px1.p1.2.m2.3.3d.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3"></share><apply id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3"><times id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.1"></times><ci id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.2">𝑁</ci><apply id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3.2">𝑑</ci><ci id="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.3.3.7.3.3.3">ℎ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.3c">\mathbf{H}=[h_{1},...,h_{N}]^{T}\in\mathbb{R}^{N\times d_{h}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.2.m2.3d">bold_H = [ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, and it can be formulated as follows,</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{self\_att}(\mathbf{Q,K,V})=\text{softmax}(\frac{\mathbf{Q}\mathbf{K}^{T}%
}{\sqrt{d_{k}}})\mathbf{V}" class="ltx_Math" display="block" id="S3.E1.m1.4"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.5" xref="S3.E1.m1.4.5.cmml"><mrow id="S3.E1.m1.4.5.2" xref="S3.E1.m1.4.5.2.cmml"><mtext id="S3.E1.m1.4.5.2.2" xref="S3.E1.m1.4.5.2.2a.cmml">self_att</mtext><mo id="S3.E1.m1.4.5.2.1" xref="S3.E1.m1.4.5.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.4.5.2.3.2" xref="S3.E1.m1.4.5.2.3.1.cmml"><mo id="S3.E1.m1.4.5.2.3.2.1" stretchy="false" xref="S3.E1.m1.4.5.2.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝐐</mi><mo id="S3.E1.m1.4.5.2.3.2.2" xref="S3.E1.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝐊</mi><mo id="S3.E1.m1.4.5.2.3.2.3" xref="S3.E1.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">𝐕</mi><mo id="S3.E1.m1.4.5.2.3.2.4" stretchy="false" xref="S3.E1.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.5.1" xref="S3.E1.m1.4.5.1.cmml">=</mo><mrow id="S3.E1.m1.4.5.3" xref="S3.E1.m1.4.5.3.cmml"><mtext id="S3.E1.m1.4.5.3.2" xref="S3.E1.m1.4.5.3.2a.cmml">softmax</mtext><mo id="S3.E1.m1.4.5.3.1" xref="S3.E1.m1.4.5.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.4.5.3.3.2" xref="S3.E1.m1.4.4.cmml"><mo id="S3.E1.m1.4.5.3.3.2.1" stretchy="false" xref="S3.E1.m1.4.4.cmml">(</mo><mfrac id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><msup id="S3.E1.m1.4.4.2" xref="S3.E1.m1.4.4.2.cmml"><mi id="S3.E1.m1.4.4.2.2" xref="S3.E1.m1.4.4.2.2.cmml">𝐐𝐊</mi><mi id="S3.E1.m1.4.4.2.3" xref="S3.E1.m1.4.4.2.3.cmml">T</mi></msup><msqrt id="S3.E1.m1.4.4.3" xref="S3.E1.m1.4.4.3.cmml"><msub id="S3.E1.m1.4.4.3.2" xref="S3.E1.m1.4.4.3.2.cmml"><mi id="S3.E1.m1.4.4.3.2.2" xref="S3.E1.m1.4.4.3.2.2.cmml">d</mi><mi id="S3.E1.m1.4.4.3.2.3" xref="S3.E1.m1.4.4.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="S3.E1.m1.4.5.3.3.2.2" stretchy="false" xref="S3.E1.m1.4.4.cmml">)</mo></mrow><mo id="S3.E1.m1.4.5.3.1a" xref="S3.E1.m1.4.5.3.1.cmml">⁢</mo><mi id="S3.E1.m1.4.5.3.4" xref="S3.E1.m1.4.5.3.4.cmml">𝐕</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.5.cmml" xref="S3.E1.m1.4.5"><eq id="S3.E1.m1.4.5.1.cmml" xref="S3.E1.m1.4.5.1"></eq><apply id="S3.E1.m1.4.5.2.cmml" xref="S3.E1.m1.4.5.2"><times id="S3.E1.m1.4.5.2.1.cmml" xref="S3.E1.m1.4.5.2.1"></times><ci id="S3.E1.m1.4.5.2.2a.cmml" xref="S3.E1.m1.4.5.2.2"><mtext id="S3.E1.m1.4.5.2.2.cmml" xref="S3.E1.m1.4.5.2.2">self_att</mtext></ci><vector id="S3.E1.m1.4.5.2.3.1.cmml" xref="S3.E1.m1.4.5.2.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝐐</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐊</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝐕</ci></vector></apply><apply id="S3.E1.m1.4.5.3.cmml" xref="S3.E1.m1.4.5.3"><times id="S3.E1.m1.4.5.3.1.cmml" xref="S3.E1.m1.4.5.3.1"></times><ci id="S3.E1.m1.4.5.3.2a.cmml" xref="S3.E1.m1.4.5.3.2"><mtext id="S3.E1.m1.4.5.3.2.cmml" xref="S3.E1.m1.4.5.3.2">softmax</mtext></ci><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.5.3.3.2"><divide id="S3.E1.m1.4.4.1.cmml" xref="S3.E1.m1.4.5.3.3.2"></divide><apply id="S3.E1.m1.4.4.2.cmml" xref="S3.E1.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.2.1.cmml" xref="S3.E1.m1.4.4.2">superscript</csymbol><ci id="S3.E1.m1.4.4.2.2.cmml" xref="S3.E1.m1.4.4.2.2">𝐐𝐊</ci><ci id="S3.E1.m1.4.4.2.3.cmml" xref="S3.E1.m1.4.4.2.3">𝑇</ci></apply><apply id="S3.E1.m1.4.4.3.cmml" xref="S3.E1.m1.4.4.3"><root id="S3.E1.m1.4.4.3a.cmml" xref="S3.E1.m1.4.4.3"></root><apply id="S3.E1.m1.4.4.3.2.cmml" xref="S3.E1.m1.4.4.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.3.2.1.cmml" xref="S3.E1.m1.4.4.3.2">subscript</csymbol><ci id="S3.E1.m1.4.4.3.2.2.cmml" xref="S3.E1.m1.4.4.3.2.2">𝑑</ci><ci id="S3.E1.m1.4.4.3.2.3.cmml" xref="S3.E1.m1.4.4.3.2.3">𝑘</ci></apply></apply></apply><ci id="S3.E1.m1.4.5.3.4.cmml" xref="S3.E1.m1.4.5.3.4">𝐕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\text{self\_att}(\mathbf{Q,K,V})=\text{softmax}(\frac{\mathbf{Q}\mathbf{K}^{T}%
}{\sqrt{d_{k}}})\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.4d">self_att ( bold_Q , bold_K , bold_V ) = softmax ( divide start_ARG bold_QK start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) bold_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Q=HW_{q}},\mathbf{K=HW_{k}},\mathbf{V=HW_{v}}" class="ltx_Math" display="block" id="S3.E2.m1.2"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.3.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">𝐐</mi><mo id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml">=</mo><msub id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml">𝐇𝐖</mi><mi id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml">𝐪</mi></msub></mrow><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.3a.cmml">,</mo><mrow id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.3.cmml"><mrow id="S3.E2.m1.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml">𝐊</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.cmml">=</mo><msub id="S3.E2.m1.2.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.3.2" xref="S3.E2.m1.2.2.2.2.1.1.3.2.cmml">𝐇𝐖</mi><mi id="S3.E2.m1.2.2.2.2.1.1.3.3" xref="S3.E2.m1.2.2.2.2.1.1.3.3.cmml">𝐤</mi></msub></mrow><mo id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.cmml">𝐕</mi><mo id="S3.E2.m1.2.2.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.2.2.1.cmml">=</mo><msub id="S3.E2.m1.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.2.2.3.2.cmml">𝐇𝐖</mi><mi id="S3.E2.m1.2.2.2.2.2.2.3.3" xref="S3.E2.m1.2.2.2.2.2.2.3.3.cmml">𝐯</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.3a.cmml" xref="S3.E2.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"></eq><ci id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2">𝐐</ci><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2">𝐇𝐖</ci><ci id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3">𝐪</ci></apply></apply><apply id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.3a.cmml" xref="S3.E2.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1"><eq id="S3.E2.m1.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1"></eq><ci id="S3.E2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.2">𝐊</ci><apply id="S3.E2.m1.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3.2">𝐇𝐖</ci><ci id="S3.E2.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.3.3">𝐤</ci></apply></apply><apply id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><eq id="S3.E2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1"></eq><ci id="S3.E2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2">𝐕</ci><apply id="S3.E2.m1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.3.2">𝐇𝐖</ci><ci id="S3.E2.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.3.3">𝐯</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\mathbf{Q=HW_{q}},\mathbf{K=HW_{k}},\mathbf{V=HW_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.2d">bold_Q = bold_HW start_POSTSUBSCRIPT bold_q end_POSTSUBSCRIPT , bold_K = bold_HW start_POSTSUBSCRIPT bold_k end_POSTSUBSCRIPT , bold_V = bold_HW start_POSTSUBSCRIPT bold_v end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.10">where <math alttext="\mathbf{W_{q},W_{k}\in\mathbb{R}}^{d_{h}\times d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.1.m1.2"><semantics id="S3.SS2.SSS0.Px1.p2.1.m1.2a"><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.cmml"><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.3.cmml"><msub id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml">𝐖</mi><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.cmml">𝐪</mi></msub><mo id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3.cmml">𝐤</mi></msub></mrow><mo id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.3.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.cmml"><msub id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2.3.cmml">h</mi></msub><mo id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.1.cmml">×</mo><msub id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.1.m1.2b"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2"><in id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.3"></in><list id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.2">𝐖</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.1.1.3">𝐪</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.2">𝐖</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.2.2.2.3">𝐤</ci></apply></list><apply id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3"><times id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.1"></times><apply id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2.2">𝑑</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.2.3">ℎ</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3.2">𝑑</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.4.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.1.m1.2c">\mathbf{W_{q},W_{k}\in\mathbb{R}}^{d_{h}\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.1.m1.2d">bold_W start_POSTSUBSCRIPT bold_q end_POSTSUBSCRIPT , bold_W start_POSTSUBSCRIPT bold_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{W_{v}\in\mathbb{R}}^{d_{h}\times d_{v}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p2.2.m2.1a"><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.3.cmml">𝐯</mi></msub><mo id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.cmml"><msub id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3.cmml">h</mi></msub><mo id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.2" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.3" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1"><in id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.1"></in><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.2">𝐖</ci><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.2.3">𝐯</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3"><times id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.1"></times><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.2.3">ℎ</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.2.m2.1c">\mathbf{W_{v}\in\mathbb{R}}^{d_{h}\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.2.m2.1d">bold_W start_POSTSUBSCRIPT bold_v end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> project the input sequence <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p2.3.m3.1a"><mi id="S3.SS2.SSS0.Px1.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.3.m3.1b"><ci id="S3.SS2.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m3.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.3.m3.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.3.m3.1d">bold_H</annotation></semantics></math> to the query matrix <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p2.4.m4.1a"><mi id="S3.SS2.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.4.m4.1b"><ci id="S3.SS2.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.4.m4.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.4.m4.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.4.m4.1d">bold_Q</annotation></semantics></math>, key matrix <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p2.5.m5.1a"><mi id="S3.SS2.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.5.m5.1b"><ci id="S3.SS2.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.5.m5.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.5.m5.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.5.m5.1d">bold_K</annotation></semantics></math> and value matrix <math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.6.m6.1"><semantics id="S3.SS2.SSS0.Px1.p2.6.m6.1a"><mi id="S3.SS2.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.6.m6.1b"><ci id="S3.SS2.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.6.m6.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.6.m6.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.6.m6.1d">bold_V</annotation></semantics></math> respectively. <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.7.m7.1"><semantics id="S3.SS2.SSS0.Px1.p2.7.m7.1a"><mi id="S3.SS2.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.7.m7.1b"><ci id="S3.SS2.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.7.m7.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.7.m7.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.7.m7.1d">bold_Q</annotation></semantics></math> and <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.8.m8.1"><semantics id="S3.SS2.SSS0.Px1.p2.8.m8.1a"><mi id="S3.SS2.SSS0.Px1.p2.8.m8.1.1" xref="S3.SS2.SSS0.Px1.p2.8.m8.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.8.m8.1b"><ci id="S3.SS2.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.8.m8.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.8.m8.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.8.m8.1d">bold_K</annotation></semantics></math> are multiplied and divided by <math alttext="\sqrt{d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.9.m9.1"><semantics id="S3.SS2.SSS0.Px1.p2.9.m9.1a"><msqrt id="S3.SS2.SSS0.Px1.p2.9.m9.1.1" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.cmml"><msub id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.2" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.3.cmml">k</mi></msub></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.9.m9.1b"><apply id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1"><root id="S3.SS2.SSS0.Px1.p2.9.m9.1.1a.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1"></root><apply id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.2">𝑑</ci><ci id="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.9.m9.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.9.m9.1c">\sqrt{d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.9.m9.1d">square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>, and the attention score can be obtained by performing softmax normalization. Finally, we can get the output of the self-attention function by multiplying the attention score and <math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.10.m10.1"><semantics id="S3.SS2.SSS0.Px1.p2.10.m10.1a"><mi id="S3.SS2.SSS0.Px1.p2.10.m10.1.1" xref="S3.SS2.SSS0.Px1.p2.10.m10.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.10.m10.1b"><ci id="S3.SS2.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.10.m10.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.10.m10.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.10.m10.1d">bold_V</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Multi-Head Attention</h4>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.2">The self-attention mechanism is limited to capturing features within a single projection space of <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.1.m1.1d">bold_H</annotation></semantics></math>, which makes it sensitive to initialization. To overcome this limitation and capture more diverse features, a multi-head attention mechanism is introduced, drawing inspiration from Convolutional Neural Networks (CNNs). The idea is to leverage multiple projection spaces to capture different aspects of the input. Specifically, if we aim to capture features from <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.2.m2.1d">italic_M</annotation></semantics></math> projection spaces, the multi-head attention mechanism can be formulated as follows,</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Multihead}(\mathbf{H})=[\text{head}_{1};...;\text{head}_{m}]\mathbf{W_{o}}" class="ltx_Math" display="block" id="S3.E3.m1.4"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml"><mrow id="S3.E3.m1.4.4.4" xref="S3.E3.m1.4.4.4.cmml"><mtext id="S3.E3.m1.4.4.4.2" xref="S3.E3.m1.4.4.4.2a.cmml">Multihead</mtext><mo id="S3.E3.m1.4.4.4.1" xref="S3.E3.m1.4.4.4.1.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.4.3.2" xref="S3.E3.m1.4.4.4.cmml"><mo id="S3.E3.m1.4.4.4.3.2.1" stretchy="false" xref="S3.E3.m1.4.4.4.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">𝐇</mi><mo id="S3.E3.m1.4.4.4.3.2.2" stretchy="false" xref="S3.E3.m1.4.4.4.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.4.3" xref="S3.E3.m1.4.4.3.cmml">=</mo><mrow id="S3.E3.m1.4.4.2" xref="S3.E3.m1.4.4.2.cmml"><mrow id="S3.E3.m1.4.4.2.2.2" xref="S3.E3.m1.4.4.2.2.3.cmml"><mo id="S3.E3.m1.4.4.2.2.2.3" stretchy="false" xref="S3.E3.m1.4.4.2.2.3.cmml">[</mo><msub id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.cmml"><mtext id="S3.E3.m1.3.3.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.2a.cmml">head</mtext><mn id="S3.E3.m1.3.3.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E3.m1.4.4.2.2.2.4" xref="S3.E3.m1.4.4.2.2.3.cmml">;</mo><mi id="S3.E3.m1.2.2" mathvariant="normal" xref="S3.E3.m1.2.2.cmml">…</mi><mo id="S3.E3.m1.4.4.2.2.2.5" xref="S3.E3.m1.4.4.2.2.3.cmml">;</mo><msub id="S3.E3.m1.4.4.2.2.2.2" xref="S3.E3.m1.4.4.2.2.2.2.cmml"><mtext id="S3.E3.m1.4.4.2.2.2.2.2" xref="S3.E3.m1.4.4.2.2.2.2.2a.cmml">head</mtext><mi id="S3.E3.m1.4.4.2.2.2.2.3" xref="S3.E3.m1.4.4.2.2.2.2.3.cmml">m</mi></msub><mo id="S3.E3.m1.4.4.2.2.2.6" stretchy="false" xref="S3.E3.m1.4.4.2.2.3.cmml">]</mo></mrow><mo id="S3.E3.m1.4.4.2.3" xref="S3.E3.m1.4.4.2.3.cmml">⁢</mo><msub id="S3.E3.m1.4.4.2.4" xref="S3.E3.m1.4.4.2.4.cmml"><mi id="S3.E3.m1.4.4.2.4.2" xref="S3.E3.m1.4.4.2.4.2.cmml">𝐖</mi><mi id="S3.E3.m1.4.4.2.4.3" xref="S3.E3.m1.4.4.2.4.3.cmml">𝐨</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4"><eq id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4.3"></eq><apply id="S3.E3.m1.4.4.4.cmml" xref="S3.E3.m1.4.4.4"><times id="S3.E3.m1.4.4.4.1.cmml" xref="S3.E3.m1.4.4.4.1"></times><ci id="S3.E3.m1.4.4.4.2a.cmml" xref="S3.E3.m1.4.4.4.2"><mtext id="S3.E3.m1.4.4.4.2.cmml" xref="S3.E3.m1.4.4.4.2">Multihead</mtext></ci><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝐇</ci></apply><apply id="S3.E3.m1.4.4.2.cmml" xref="S3.E3.m1.4.4.2"><times id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.3"></times><list id="S3.E3.m1.4.4.2.2.3.cmml" xref="S3.E3.m1.4.4.2.2.2"><apply id="S3.E3.m1.3.3.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.2a.cmml" xref="S3.E3.m1.3.3.1.1.1.1.2"><mtext id="S3.E3.m1.3.3.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.2">head</mtext></ci><cn id="S3.E3.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.3.3.1.1.1.1.3">1</cn></apply><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">…</ci><apply id="S3.E3.m1.4.4.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.2.2.2.1.cmml" xref="S3.E3.m1.4.4.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.4.4.2.2.2.2.2a.cmml" xref="S3.E3.m1.4.4.2.2.2.2.2"><mtext id="S3.E3.m1.4.4.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.2.2.2.2.2">head</mtext></ci><ci id="S3.E3.m1.4.4.2.2.2.2.3.cmml" xref="S3.E3.m1.4.4.2.2.2.2.3">𝑚</ci></apply></list><apply id="S3.E3.m1.4.4.2.4.cmml" xref="S3.E3.m1.4.4.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.2.4.1.cmml" xref="S3.E3.m1.4.4.2.4">subscript</csymbol><ci id="S3.E3.m1.4.4.2.4.2.cmml" xref="S3.E3.m1.4.4.2.4.2">𝐖</ci><ci id="S3.E3.m1.4.4.2.4.3.cmml" xref="S3.E3.m1.4.4.2.4.3">𝐨</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\text{Multihead}(\mathbf{H})=[\text{head}_{1};...;\text{head}_{m}]\mathbf{W_{o}}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.4d">Multihead ( bold_H ) = [ head start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; … ; head start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ] bold_W start_POSTSUBSCRIPT bold_o end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{head}_{m}=\text{self\_att}(\mathbf{Q}_{m},\mathbf{K}_{m},\mathbf{V}_{m})" class="ltx_Math" display="block" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml"><msub id="S3.E4.m1.3.3.5" xref="S3.E4.m1.3.3.5.cmml"><mtext id="S3.E4.m1.3.3.5.2" xref="S3.E4.m1.3.3.5.2a.cmml">head</mtext><mi id="S3.E4.m1.3.3.5.3" xref="S3.E4.m1.3.3.5.3.cmml">m</mi></msub><mo id="S3.E4.m1.3.3.4" xref="S3.E4.m1.3.3.4.cmml">=</mo><mrow id="S3.E4.m1.3.3.3" xref="S3.E4.m1.3.3.3.cmml"><mtext id="S3.E4.m1.3.3.3.5" xref="S3.E4.m1.3.3.3.5a.cmml">self_att</mtext><mo id="S3.E4.m1.3.3.3.4" xref="S3.E4.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.3.3.3" xref="S3.E4.m1.3.3.3.3.4.cmml"><mo id="S3.E4.m1.3.3.3.3.3.4" stretchy="false" xref="S3.E4.m1.3.3.3.3.4.cmml">(</mo><msub id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">𝐐</mi><mi id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo id="S3.E4.m1.3.3.3.3.3.5" xref="S3.E4.m1.3.3.3.3.4.cmml">,</mo><msub id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.2.cmml">𝐊</mi><mi id="S3.E4.m1.2.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.2.3.cmml">m</mi></msub><mo id="S3.E4.m1.3.3.3.3.3.6" xref="S3.E4.m1.3.3.3.3.4.cmml">,</mo><msub id="S3.E4.m1.3.3.3.3.3.3" xref="S3.E4.m1.3.3.3.3.3.3.cmml"><mi id="S3.E4.m1.3.3.3.3.3.3.2" xref="S3.E4.m1.3.3.3.3.3.3.2.cmml">𝐕</mi><mi id="S3.E4.m1.3.3.3.3.3.3.3" xref="S3.E4.m1.3.3.3.3.3.3.3.cmml">m</mi></msub><mo id="S3.E4.m1.3.3.3.3.3.7" stretchy="false" xref="S3.E4.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"><eq id="S3.E4.m1.3.3.4.cmml" xref="S3.E4.m1.3.3.4"></eq><apply id="S3.E4.m1.3.3.5.cmml" xref="S3.E4.m1.3.3.5"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.5.1.cmml" xref="S3.E4.m1.3.3.5">subscript</csymbol><ci id="S3.E4.m1.3.3.5.2a.cmml" xref="S3.E4.m1.3.3.5.2"><mtext id="S3.E4.m1.3.3.5.2.cmml" xref="S3.E4.m1.3.3.5.2">head</mtext></ci><ci id="S3.E4.m1.3.3.5.3.cmml" xref="S3.E4.m1.3.3.5.3">𝑚</ci></apply><apply id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.3"><times id="S3.E4.m1.3.3.3.4.cmml" xref="S3.E4.m1.3.3.3.4"></times><ci id="S3.E4.m1.3.3.3.5a.cmml" xref="S3.E4.m1.3.3.3.5"><mtext id="S3.E4.m1.3.3.3.5.cmml" xref="S3.E4.m1.3.3.3.5">self_att</mtext></ci><vector id="S3.E4.m1.3.3.3.3.4.cmml" xref="S3.E4.m1.3.3.3.3.3"><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">𝐐</ci><ci id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.2">𝐊</ci><ci id="S3.E4.m1.2.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2.3">𝑚</ci></apply><apply id="S3.E4.m1.3.3.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.3.3.1.cmml" xref="S3.E4.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E4.m1.3.3.3.3.3.3.2.cmml" xref="S3.E4.m1.3.3.3.3.3.3.2">𝐕</ci><ci id="S3.E4.m1.3.3.3.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3.3.3.3">𝑚</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\text{head}_{m}=\text{self\_att}(\mathbf{Q}_{m},\mathbf{K}_{m},\mathbf{V}_{m})</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">head start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = self_att ( bold_Q start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , bold_K start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , bold_V start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Q}_{m}=\mathbf{H}\mathbf{W}_{q}^{m},\mathbf{K}_{m}=\mathbf{H}\mathbf{W%
}_{k}^{m},\mathbf{V}_{m}=\mathbf{H}\mathbf{W}_{v}^{m}" class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.3.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.2.2.cmml">𝐐</mi><mi id="S3.E5.m1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.2.3.cmml">m</mi></msub><mo id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml">=</mo><msubsup id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.cmml">𝐇𝐖</mi><mi id="S3.E5.m1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.3.2.3.cmml">q</mi><mi id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml">m</mi></msubsup></mrow><mo id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.3a.cmml">,</mo><mrow id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.3.cmml"><mrow id="S3.E5.m1.2.2.2.2.1.1" xref="S3.E5.m1.2.2.2.2.1.1.cmml"><msub id="S3.E5.m1.2.2.2.2.1.1.2" xref="S3.E5.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E5.m1.2.2.2.2.1.1.2.2" xref="S3.E5.m1.2.2.2.2.1.1.2.2.cmml">𝐊</mi><mi id="S3.E5.m1.2.2.2.2.1.1.2.3" xref="S3.E5.m1.2.2.2.2.1.1.2.3.cmml">m</mi></msub><mo id="S3.E5.m1.2.2.2.2.1.1.1" xref="S3.E5.m1.2.2.2.2.1.1.1.cmml">=</mo><msubsup id="S3.E5.m1.2.2.2.2.1.1.3" xref="S3.E5.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E5.m1.2.2.2.2.1.1.3.2.2" xref="S3.E5.m1.2.2.2.2.1.1.3.2.2.cmml">𝐇𝐖</mi><mi id="S3.E5.m1.2.2.2.2.1.1.3.2.3" xref="S3.E5.m1.2.2.2.2.1.1.3.2.3.cmml">k</mi><mi id="S3.E5.m1.2.2.2.2.1.1.3.3" xref="S3.E5.m1.2.2.2.2.1.1.3.3.cmml">m</mi></msubsup></mrow><mo id="S3.E5.m1.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.cmml"><msub id="S3.E5.m1.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E5.m1.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.2.2.cmml">𝐕</mi><mi id="S3.E5.m1.2.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.2.2.3.cmml">m</mi></msub><mo id="S3.E5.m1.2.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.2.1.cmml">=</mo><msubsup id="S3.E5.m1.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.2.2.2.2.2.2.3.2.2" xref="S3.E5.m1.2.2.2.2.2.2.3.2.2.cmml">𝐇𝐖</mi><mi id="S3.E5.m1.2.2.2.2.2.2.3.2.3" xref="S3.E5.m1.2.2.2.2.2.2.3.2.3.cmml">v</mi><mi id="S3.E5.m1.2.2.2.2.2.2.3.3" xref="S3.E5.m1.2.2.2.2.2.2.3.3.cmml">m</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3a.cmml" xref="S3.E5.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"></eq><apply id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2">𝐐</ci><ci id="S3.E5.m1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.3">𝑚</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2">𝐇𝐖</ci><ci id="S3.E5.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3">𝑞</ci></apply><ci id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S3.E5.m1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.3a.cmml" xref="S3.E5.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.2.2.2.2.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1"><eq id="S3.E5.m1.2.2.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1.1"></eq><apply id="S3.E5.m1.2.2.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.2.2">𝐊</ci><ci id="S3.E5.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.2.3">𝑚</ci></apply><apply id="S3.E5.m1.2.2.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1.3">superscript</csymbol><apply id="S3.E5.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.3.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.1.3.2.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.3.2.2">𝐇𝐖</ci><ci id="S3.E5.m1.2.2.2.2.1.1.3.2.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E5.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.3.3">𝑚</ci></apply></apply><apply id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2"><eq id="S3.E5.m1.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.1"></eq><apply id="S3.E5.m1.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2">𝐕</ci><ci id="S3.E5.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.3">𝑚</ci></apply><apply id="S3.E5.m1.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.3">superscript</csymbol><apply id="S3.E5.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.2.3.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.2.3.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.3.2.2">𝐇𝐖</ci><ci id="S3.E5.m1.2.2.2.2.2.2.3.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.3.2.3">𝑣</ci></apply><ci id="S3.E5.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.3.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\mathbf{Q}_{m}=\mathbf{H}\mathbf{W}_{q}^{m},\mathbf{K}_{m}=\mathbf{H}\mathbf{W%
}_{k}^{m},\mathbf{V}_{m}=\mathbf{H}\mathbf{W}_{v}^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">bold_Q start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = bold_HW start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT , bold_K start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = bold_HW start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT , bold_V start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = bold_HW start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p2.9">where <math alttext="\mathbf{W_{o}}\in\mathbb{R}^{M*d_{v}\times d_{h^{\prime}}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><mrow id="S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3.cmml">𝐨</mi></msub><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.2.cmml">M</mi><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.1.cmml">∗</mo><msub id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3.3.cmml">v</mi></msub></mrow><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.2.cmml">d</mi><msup id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3.2.cmml">h</mi><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3.3.cmml">′</mo></msup></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1"><in id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1"></in><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.2">𝐖</ci><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.3">𝐨</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3"><times id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.1"></times><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2"><times id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.1"></times><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.2">𝑀</ci><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3.2">𝑑</ci><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.2.3.3">𝑣</ci></apply></apply><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.2">𝑑</ci><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3.2">ℎ</ci><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.3.3.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">\mathbf{W_{o}}\in\mathbb{R}^{M*d_{v}\times d_{h^{\prime}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.1.m1.1d">bold_W start_POSTSUBSCRIPT bold_o end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_M ∗ italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the projection matrix used to convert the slices of multiple self-attention outputs to the original dimension. <math alttext="head_{m}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p2.2.m2.1a"><mrow id="S3.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.2" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.2.cmml">h</mi><mo id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.3" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.3.cmml">e</mi><mo id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1a" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.4" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.4.cmml">a</mi><mo id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1b" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.cmml">⁢</mo><msub id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5.cmml"><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5.2" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5.3" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.2.m2.1b"><apply id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1"><times id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.1"></times><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.2">ℎ</ci><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.3">𝑒</ci><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.4.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.4">𝑎</ci><apply id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5.2.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5.2">𝑑</ci><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5.3.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.5.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.2.m2.1c">head_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.2.m2.1d">italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> corresponds to the output sequence of the m-th self-attention function. <math alttext="\mathbf{W}_{q}^{m},\mathbf{W}_{k}^{m}\in\mathbb{R}^{d_{h}\times d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.3.m3.2"><semantics id="S3.SS2.SSS0.Px2.p2.3.m3.2a"><mrow id="S3.SS2.SSS0.Px2.p2.3.m3.2.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.cmml"><mrow id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.3.cmml"><msubsup id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.3.cmml">q</mi><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3.cmml">m</mi></msubsup><mo id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.2.3.cmml">k</mi><mi id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.3.cmml">m</mi></msubsup></mrow><mo id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.3.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.cmml"><msub id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2.3.cmml">h</mi></msub><mo id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.1.cmml">×</mo><msub id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3.2" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3.3" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.3.m3.2b"><apply id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2"><in id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.3"></in><list id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2"><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.2">𝐖</ci><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.2.3">𝑞</ci></apply><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.1.1.1.3">𝑚</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.2.2">𝐖</ci><ci id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.2.2.2.3">𝑚</ci></apply></list><apply id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3"><times id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.1"></times><apply id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2.2">𝑑</ci><ci id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.2.3">ℎ</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3.2">𝑑</ci><ci id="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.2.2.4.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.3.m3.2c">\mathbf{W}_{q}^{m},\mathbf{W}_{k}^{m}\in\mathbb{R}^{d_{h}\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.3.m3.2d">bold_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT , bold_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{W}_{v}^{m}\in\mathbb{R}^{d_{h}\times d_{v}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.4.m4.1"><semantics id="S3.SS2.SSS0.Px2.p2.4.m4.1a"><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml"><msubsup id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.2.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.2.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.2.3.cmml">v</mi><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.3.cmml">m</mi></msubsup><mo id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.cmml"><msub id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2.3.cmml">h</mi></msub><mo id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3.2" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3.3" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.4.m4.1b"><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1"><in id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.1"></in><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.2.2">𝐖</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.2.3">𝑣</ci></apply><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.2.3">𝑚</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3"><times id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.1"></times><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.2.3">ℎ</ci></apply><apply id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.4.m4.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.4.m4.1c">\mathbf{W}_{v}^{m}\in\mathbb{R}^{d_{h}\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.4.m4.1d">bold_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> respectively project <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.5.m5.1"><semantics id="S3.SS2.SSS0.Px2.p2.5.m5.1a"><mi id="S3.SS2.SSS0.Px2.p2.5.m5.1.1" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.5.m5.1b"><ci id="S3.SS2.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.5.m5.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.5.m5.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.5.m5.1d">bold_H</annotation></semantics></math> to the query matrix <math alttext="\mathbf{Q}_{m}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.6.m6.1"><semantics id="S3.SS2.SSS0.Px2.p2.6.m6.1a"><msub id="S3.SS2.SSS0.Px2.p2.6.m6.1.1" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.6.m6.1.1.2" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1.2.cmml">𝐐</mi><mi id="S3.SS2.SSS0.Px2.p2.6.m6.1.1.3" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.6.m6.1b"><apply id="S3.SS2.SSS0.Px2.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1.2">𝐐</ci><ci id="S3.SS2.SSS0.Px2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.6.m6.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.6.m6.1c">\mathbf{Q}_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.6.m6.1d">bold_Q start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, key matrix <math alttext="\mathbf{K}_{m}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.7.m7.1"><semantics id="S3.SS2.SSS0.Px2.p2.7.m7.1a"><msub id="S3.SS2.SSS0.Px2.p2.7.m7.1.1" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2.cmml">𝐊</mi><mi id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.7.m7.1b"><apply id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.2">𝐊</ci><ci id="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.7.m7.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.7.m7.1c">\mathbf{K}_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.7.m7.1d">bold_K start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> and value matrix <math alttext="\mathbf{V}_{m}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.8.m8.1"><semantics id="S3.SS2.SSS0.Px2.p2.8.m8.1a"><msub id="S3.SS2.SSS0.Px2.p2.8.m8.1.1" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.2" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.2.cmml">𝐕</mi><mi id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.3" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.8.m8.1b"><apply id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.2">𝐕</ci><ci id="S3.SS2.SSS0.Px2.p2.8.m8.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.8.m8.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.8.m8.1c">\mathbf{V}_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.8.m8.1d">bold_V start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> of the m-th attention head, while <math alttext="m\in{1,...,M}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.9.m9.3"><semantics id="S3.SS2.SSS0.Px2.p2.9.m9.3a"><mrow id="S3.SS2.SSS0.Px2.p2.9.m9.3.4" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.4.cmml"><mi id="S3.SS2.SSS0.Px2.p2.9.m9.3.4.2" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.4.2.cmml">m</mi><mo id="S3.SS2.SSS0.Px2.p2.9.m9.3.4.1" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.4.1.cmml">∈</mo><mrow id="S3.SS2.SSS0.Px2.p2.9.m9.3.4.3.2" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.4.3.1.cmml"><mn id="S3.SS2.SSS0.Px2.p2.9.m9.1.1" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1.cmml">1</mn><mo id="S3.SS2.SSS0.Px2.p2.9.m9.3.4.3.2.1" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.4.3.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px2.p2.9.m9.2.2" mathvariant="normal" xref="S3.SS2.SSS0.Px2.p2.9.m9.2.2.cmml">…</mi><mo id="S3.SS2.SSS0.Px2.p2.9.m9.3.4.3.2.2" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.4.3.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px2.p2.9.m9.3.3" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.9.m9.3b"><apply id="S3.SS2.SSS0.Px2.p2.9.m9.3.4.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.4"><in id="S3.SS2.SSS0.Px2.p2.9.m9.3.4.1.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.4.1"></in><ci id="S3.SS2.SSS0.Px2.p2.9.m9.3.4.2.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.4.2">𝑚</ci><list id="S3.SS2.SSS0.Px2.p2.9.m9.3.4.3.1.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.4.3.2"><cn id="S3.SS2.SSS0.Px2.p2.9.m9.1.1.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p2.9.m9.1.1">1</cn><ci id="S3.SS2.SSS0.Px2.p2.9.m9.2.2.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.2.2">…</ci><ci id="S3.SS2.SSS0.Px2.p2.9.m9.3.3.cmml" xref="S3.SS2.SSS0.Px2.p2.9.m9.3.3">𝑀</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.9.m9.3c">m\in{1,...,M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.9.m9.3d">italic_m ∈ 1 , … , italic_M</annotation></semantics></math></p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Method</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we will provide a detailed introduction to GATH. We first introduce the overall framework of GATH and then describe each module and its interconnections in detail. Finally, the loss function used in GATH is proposed.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Overall Framework</h3>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="276" id="S4.F3.g1" src="extracted/5774499/framework02.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Framework of GATH. GATH consists of two parts: encoder and decoder.
In the entity-specific attention network module, an entity’s attention score to its neighbors depends on the neighbors themselves. In the entity-relation joint attention network module, an entity’s attention score to its neighbors depends on the relation type. Similarly, the aggregation module aggregates information from the entity-specific attention network module and the entity-relation joint attention network module.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">The architecture of GATH follows the Encoder-Decoder framework, as depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4.F3" title="Figure 3 ‣ 4.1. Overall Framework ‣ 4. Method ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">3</span></a>. The encoder is responsible for generating embeddings of entities by incorporating both the structural and neighborhood information from the KG. Specifically, the encoder consists of an attention module that calculates attention scores between the central entity and its neighbors, as well as an aggregation module that combines information from all neighboring entities into a single representation. To begin, the attention module computes attention scores via entity pair and relation type, respectively. Subsequently, the aggregation module utilizes these attention scores to aggregate relational and neighborhood information toward the central entity. Finally, the encoder feeds the generated entity embeddings into a decoder. The decoder can be any generic decoder (such as TransE or ConvE) for knowledge graph embedding models. In our case, we employ a decoder based on ConvE with certain enhancements to better capture diverse relational patterns in KGs. Next, we describe each component in detail.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Encoder</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The encoder of GATH consists of two primary components: 1) the entity-specific attention network, and 2) the entity-relation joint attention network. These two parts calculate the attention scores of head and tail entities respectively from the entity feature space and the entity-relation joint feature space. They are described separately as follows.</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Entity-Specific Attention Network</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">To address the challenge of poor performance in predicting the tail (head) entities that share the same relation and head (tail) entities with others, we introduce an entity-specific attention network that is relation-agnostic. This module aims to capture the intrinsic interaction between a central entity and its neighbor entities, allowing GATH to assign different attention weights to neighbor entities based on their relevance to the central entity regardless of the specific relation involved. By doing so, GATH can efficiently handle the situation shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">1</span></a>(b).</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.6">We use <math alttext="\mathbf{H}^{0}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p2.1.m1.1a"><msup id="S4.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml">𝐇</mi><mn id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.2">𝐇</ci><cn id="S4.SS2.SSS0.Px1.p2.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.1.m1.1c">\mathbf{H}^{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.1.m1.1d">bold_H start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> as the initial entity embedding matrix, which is initialized by Gaussian distribution sampling. In <math alttext="l" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p2.2.m2.1a"><mi id="S4.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.2.m2.1b"><ci id="S4.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.2.m2.1d">italic_l</annotation></semantics></math>-th entity-specific attention network module, the input is <math alttext="\mathbf{H}^{(l-1)}\in\mathbb{R}^{N_{e}\times D_{h}^{(l-1)}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.3.m3.2"><semantics id="S4.SS2.SSS0.Px1.p2.3.m3.2a"><mrow id="S4.SS2.SSS0.Px1.p2.3.m3.2.3" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.cmml"><msup id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.2" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.2.cmml"><mi id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.2.2" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.2.2.cmml">𝐇</mi><mrow id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.1.cmml">∈</mo><msup id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.3" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.3.cmml"><mi id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.3.2" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.cmml"><msub id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.cmml"><mi id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.2" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.2.cmml">N</mi><mi id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.3" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.3.cmml">e</mi></msub><mo id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.2.cmml">×</mo><msubsup id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.cmml"><mi id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.2.2" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.2.2.cmml">D</mi><mi id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.2.3" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.2.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.cmml">)</mo></mrow></msubsup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.3.m3.2b"><apply id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3"><in id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.1"></in><apply id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.2.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.2.2">𝐇</ci><apply id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1"><minus id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p2.3.m3.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.3.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.3.m3.2.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.3.3.2">ℝ</ci><apply id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1"><times id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.2"></times><apply id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.2.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.2">𝑁</ci><ci id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.3.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.3.3">𝑒</ci></apply><apply id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4">superscript</csymbol><apply id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.2.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.2.2">𝐷</ci><ci id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.2.3.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.4.2.3">ℎ</ci></apply><apply id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1"><minus id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p2.3.m3.2.2.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.3.m3.2c">\mathbf{H}^{(l-1)}\in\mathbb{R}^{N_{e}\times D_{h}^{(l-1)}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.3.m3.2d">bold_H start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT × italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="N_{e}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.4.m4.1"><semantics id="S4.SS2.SSS0.Px1.p2.4.m4.1a"><msub id="S4.SS2.SSS0.Px1.p2.4.m4.1.1" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.4.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1.2.cmml">N</mi><mi id="S4.SS2.SSS0.Px1.p2.4.m4.1.1.3" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.4.m4.1b"><apply id="S4.SS2.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1.2">𝑁</ci><ci id="S4.SS2.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.4.m4.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.4.m4.1c">N_{e}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> is the number of entities, <math alttext="l" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.5.m5.1"><semantics id="S4.SS2.SSS0.Px1.p2.5.m5.1a"><mi id="S4.SS2.SSS0.Px1.p2.5.m5.1.1" xref="S4.SS2.SSS0.Px1.p2.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.5.m5.1b"><ci id="S4.SS2.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.5.m5.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.5.m5.1d">italic_l</annotation></semantics></math> represents the number of layers of the encoder, <math alttext="D_{h}^{(l-1)}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.6.m6.1"><semantics id="S4.SS2.SSS0.Px1.p2.6.m6.1a"><msubsup id="S4.SS2.SSS0.Px1.p2.6.m6.1.2" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p2.6.m6.1.2.2.2" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.2.2.2.cmml">D</mi><mi id="S4.SS2.SSS0.Px1.p2.6.m6.1.2.2.3" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.2.2.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.6.m6.1b"><apply id="S4.SS2.SSS0.Px1.p2.6.m6.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.6.m6.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.2">superscript</csymbol><apply id="S4.SS2.SSS0.Px1.p2.6.m6.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.6.m6.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.6.m6.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.2.2.2">𝐷</ci><ci id="S4.SS2.SSS0.Px1.p2.6.m6.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.2.2.3">ℎ</ci></apply><apply id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1"><minus id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p2.6.m6.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.6.m6.1c">D_{h}^{(l-1)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.6.m6.1d">italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math> represents the dimension of the input vector. We first project the head and tail embeddings into the query and key vectors respectively as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q_{(h)i}^{(l)}=h_{i}^{(l-1)}\textbf{W}_{(h)q}^{(l)},k_{(h)j}^{(l)}=h_{j}^{(l-1%
)}\textbf{W}_{(h)k}^{(l)}" class="ltx_Math" display="block" id="S4.E6.m1.12"><semantics id="S4.E6.m1.12a"><mrow id="S4.E6.m1.12.12.2" xref="S4.E6.m1.12.12.3.cmml"><mrow id="S4.E6.m1.11.11.1.1" xref="S4.E6.m1.11.11.1.1.cmml"><msubsup id="S4.E6.m1.11.11.1.1.2" xref="S4.E6.m1.11.11.1.1.2.cmml"><mi id="S4.E6.m1.11.11.1.1.2.2.2" xref="S4.E6.m1.11.11.1.1.2.2.2.cmml">q</mi><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.cmml"><mo id="S4.E6.m1.1.1.1.3.2.1" stretchy="false" xref="S4.E6.m1.1.1.1.cmml">(</mo><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">h</mi><mo id="S4.E6.m1.1.1.1.3.2.2" stretchy="false" xref="S4.E6.m1.1.1.1.cmml">)</mo></mrow><mo id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.E6.m1.1.1.1.4" xref="S4.E6.m1.1.1.1.4.cmml">i</mi></mrow><mrow id="S4.E6.m1.2.2.1.3" xref="S4.E6.m1.11.11.1.1.2.cmml"><mo id="S4.E6.m1.2.2.1.3.1" stretchy="false" xref="S4.E6.m1.11.11.1.1.2.cmml">(</mo><mi id="S4.E6.m1.2.2.1.1" xref="S4.E6.m1.2.2.1.1.cmml">l</mi><mo id="S4.E6.m1.2.2.1.3.2" stretchy="false" xref="S4.E6.m1.11.11.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.E6.m1.11.11.1.1.1" xref="S4.E6.m1.11.11.1.1.1.cmml">=</mo><mrow id="S4.E6.m1.11.11.1.1.3" xref="S4.E6.m1.11.11.1.1.3.cmml"><msubsup id="S4.E6.m1.11.11.1.1.3.2" xref="S4.E6.m1.11.11.1.1.3.2.cmml"><mi id="S4.E6.m1.11.11.1.1.3.2.2.2" xref="S4.E6.m1.11.11.1.1.3.2.2.2.cmml">h</mi><mi id="S4.E6.m1.11.11.1.1.3.2.2.3" xref="S4.E6.m1.11.11.1.1.3.2.2.3.cmml">i</mi><mrow id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.1.cmml"><mo id="S4.E6.m1.3.3.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.3.3.1.1.1" xref="S4.E6.m1.3.3.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.2.cmml">l</mi><mo id="S4.E6.m1.3.3.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S4.E6.m1.3.3.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E6.m1.3.3.1.1.3" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E6.m1.11.11.1.1.3.1" xref="S4.E6.m1.11.11.1.1.3.1.cmml">⁢</mo><msubsup id="S4.E6.m1.11.11.1.1.3.3" xref="S4.E6.m1.11.11.1.1.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.11.11.1.1.3.3.2.2" xref="S4.E6.m1.11.11.1.1.3.3.2.2a.cmml">W</mtext><mrow id="S4.E6.m1.4.4.1" xref="S4.E6.m1.4.4.1.cmml"><mrow id="S4.E6.m1.4.4.1.3.2" xref="S4.E6.m1.4.4.1.cmml"><mo id="S4.E6.m1.4.4.1.3.2.1" stretchy="false" xref="S4.E6.m1.4.4.1.cmml">(</mo><mi id="S4.E6.m1.4.4.1.1" xref="S4.E6.m1.4.4.1.1.cmml">h</mi><mo id="S4.E6.m1.4.4.1.3.2.2" stretchy="false" xref="S4.E6.m1.4.4.1.cmml">)</mo></mrow><mo id="S4.E6.m1.4.4.1.2" xref="S4.E6.m1.4.4.1.2.cmml">⁢</mo><mi id="S4.E6.m1.4.4.1.4" xref="S4.E6.m1.4.4.1.4.cmml">q</mi></mrow><mrow id="S4.E6.m1.5.5.1.3" xref="S4.E6.m1.11.11.1.1.3.3.cmml"><mo id="S4.E6.m1.5.5.1.3.1" stretchy="false" xref="S4.E6.m1.11.11.1.1.3.3.cmml">(</mo><mi id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1.cmml">l</mi><mo id="S4.E6.m1.5.5.1.3.2" stretchy="false" xref="S4.E6.m1.11.11.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S4.E6.m1.12.12.2.3" xref="S4.E6.m1.12.12.3a.cmml">,</mo><mrow id="S4.E6.m1.12.12.2.2" xref="S4.E6.m1.12.12.2.2.cmml"><msubsup id="S4.E6.m1.12.12.2.2.2" xref="S4.E6.m1.12.12.2.2.2.cmml"><mi id="S4.E6.m1.12.12.2.2.2.2.2" xref="S4.E6.m1.12.12.2.2.2.2.2.cmml">k</mi><mrow id="S4.E6.m1.6.6.1" xref="S4.E6.m1.6.6.1.cmml"><mrow id="S4.E6.m1.6.6.1.3.2" xref="S4.E6.m1.6.6.1.cmml"><mo id="S4.E6.m1.6.6.1.3.2.1" stretchy="false" xref="S4.E6.m1.6.6.1.cmml">(</mo><mi id="S4.E6.m1.6.6.1.1" xref="S4.E6.m1.6.6.1.1.cmml">h</mi><mo id="S4.E6.m1.6.6.1.3.2.2" stretchy="false" xref="S4.E6.m1.6.6.1.cmml">)</mo></mrow><mo id="S4.E6.m1.6.6.1.2" xref="S4.E6.m1.6.6.1.2.cmml">⁢</mo><mi id="S4.E6.m1.6.6.1.4" xref="S4.E6.m1.6.6.1.4.cmml">j</mi></mrow><mrow id="S4.E6.m1.7.7.1.3" xref="S4.E6.m1.12.12.2.2.2.cmml"><mo id="S4.E6.m1.7.7.1.3.1" stretchy="false" xref="S4.E6.m1.12.12.2.2.2.cmml">(</mo><mi id="S4.E6.m1.7.7.1.1" xref="S4.E6.m1.7.7.1.1.cmml">l</mi><mo id="S4.E6.m1.7.7.1.3.2" stretchy="false" xref="S4.E6.m1.12.12.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.E6.m1.12.12.2.2.1" xref="S4.E6.m1.12.12.2.2.1.cmml">=</mo><mrow id="S4.E6.m1.12.12.2.2.3" xref="S4.E6.m1.12.12.2.2.3.cmml"><msubsup id="S4.E6.m1.12.12.2.2.3.2" xref="S4.E6.m1.12.12.2.2.3.2.cmml"><mi id="S4.E6.m1.12.12.2.2.3.2.2.2" xref="S4.E6.m1.12.12.2.2.3.2.2.2.cmml">h</mi><mi id="S4.E6.m1.12.12.2.2.3.2.2.3" xref="S4.E6.m1.12.12.2.2.3.2.2.3.cmml">j</mi><mrow id="S4.E6.m1.8.8.1.1" xref="S4.E6.m1.8.8.1.1.1.cmml"><mo id="S4.E6.m1.8.8.1.1.2" stretchy="false" xref="S4.E6.m1.8.8.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.8.8.1.1.1" xref="S4.E6.m1.8.8.1.1.1.cmml"><mi id="S4.E6.m1.8.8.1.1.1.2" xref="S4.E6.m1.8.8.1.1.1.2.cmml">l</mi><mo id="S4.E6.m1.8.8.1.1.1.1" xref="S4.E6.m1.8.8.1.1.1.1.cmml">−</mo><mn id="S4.E6.m1.8.8.1.1.1.3" xref="S4.E6.m1.8.8.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E6.m1.8.8.1.1.3" stretchy="false" xref="S4.E6.m1.8.8.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E6.m1.12.12.2.2.3.1" xref="S4.E6.m1.12.12.2.2.3.1.cmml">⁢</mo><msubsup id="S4.E6.m1.12.12.2.2.3.3" xref="S4.E6.m1.12.12.2.2.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.12.12.2.2.3.3.2.2" xref="S4.E6.m1.12.12.2.2.3.3.2.2a.cmml">W</mtext><mrow id="S4.E6.m1.9.9.1" xref="S4.E6.m1.9.9.1.cmml"><mrow id="S4.E6.m1.9.9.1.3.2" xref="S4.E6.m1.9.9.1.cmml"><mo id="S4.E6.m1.9.9.1.3.2.1" stretchy="false" xref="S4.E6.m1.9.9.1.cmml">(</mo><mi id="S4.E6.m1.9.9.1.1" xref="S4.E6.m1.9.9.1.1.cmml">h</mi><mo id="S4.E6.m1.9.9.1.3.2.2" stretchy="false" xref="S4.E6.m1.9.9.1.cmml">)</mo></mrow><mo id="S4.E6.m1.9.9.1.2" xref="S4.E6.m1.9.9.1.2.cmml">⁢</mo><mi id="S4.E6.m1.9.9.1.4" xref="S4.E6.m1.9.9.1.4.cmml">k</mi></mrow><mrow id="S4.E6.m1.10.10.1.3" xref="S4.E6.m1.12.12.2.2.3.3.cmml"><mo id="S4.E6.m1.10.10.1.3.1" stretchy="false" xref="S4.E6.m1.12.12.2.2.3.3.cmml">(</mo><mi id="S4.E6.m1.10.10.1.1" xref="S4.E6.m1.10.10.1.1.cmml">l</mi><mo id="S4.E6.m1.10.10.1.3.2" stretchy="false" xref="S4.E6.m1.12.12.2.2.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.12b"><apply id="S4.E6.m1.12.12.3.cmml" xref="S4.E6.m1.12.12.2"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.3a.cmml" xref="S4.E6.m1.12.12.2.3">formulae-sequence</csymbol><apply id="S4.E6.m1.11.11.1.1.cmml" xref="S4.E6.m1.11.11.1.1"><eq id="S4.E6.m1.11.11.1.1.1.cmml" xref="S4.E6.m1.11.11.1.1.1"></eq><apply id="S4.E6.m1.11.11.1.1.2.cmml" xref="S4.E6.m1.11.11.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.11.11.1.1.2.1.cmml" xref="S4.E6.m1.11.11.1.1.2">superscript</csymbol><apply id="S4.E6.m1.11.11.1.1.2.2.cmml" xref="S4.E6.m1.11.11.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.11.11.1.1.2.2.1.cmml" xref="S4.E6.m1.11.11.1.1.2">subscript</csymbol><ci id="S4.E6.m1.11.11.1.1.2.2.2.cmml" xref="S4.E6.m1.11.11.1.1.2.2.2">𝑞</ci><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><times id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.2"></times><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">ℎ</ci><ci id="S4.E6.m1.1.1.1.4.cmml" xref="S4.E6.m1.1.1.1.4">𝑖</ci></apply></apply><ci id="S4.E6.m1.2.2.1.1.cmml" xref="S4.E6.m1.2.2.1.1">𝑙</ci></apply><apply id="S4.E6.m1.11.11.1.1.3.cmml" xref="S4.E6.m1.11.11.1.1.3"><times id="S4.E6.m1.11.11.1.1.3.1.cmml" xref="S4.E6.m1.11.11.1.1.3.1"></times><apply id="S4.E6.m1.11.11.1.1.3.2.cmml" xref="S4.E6.m1.11.11.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.11.11.1.1.3.2.1.cmml" xref="S4.E6.m1.11.11.1.1.3.2">superscript</csymbol><apply id="S4.E6.m1.11.11.1.1.3.2.2.cmml" xref="S4.E6.m1.11.11.1.1.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.11.11.1.1.3.2.2.1.cmml" xref="S4.E6.m1.11.11.1.1.3.2">subscript</csymbol><ci id="S4.E6.m1.11.11.1.1.3.2.2.2.cmml" xref="S4.E6.m1.11.11.1.1.3.2.2.2">ℎ</ci><ci id="S4.E6.m1.11.11.1.1.3.2.2.3.cmml" xref="S4.E6.m1.11.11.1.1.3.2.2.3">𝑖</ci></apply><apply id="S4.E6.m1.3.3.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1"><minus id="S4.E6.m1.3.3.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1"></minus><ci id="S4.E6.m1.3.3.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.2">𝑙</ci><cn id="S4.E6.m1.3.3.1.1.1.3.cmml" type="integer" xref="S4.E6.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="S4.E6.m1.11.11.1.1.3.3.cmml" xref="S4.E6.m1.11.11.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.11.11.1.1.3.3.1.cmml" xref="S4.E6.m1.11.11.1.1.3.3">superscript</csymbol><apply id="S4.E6.m1.11.11.1.1.3.3.2.cmml" xref="S4.E6.m1.11.11.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.11.11.1.1.3.3.2.1.cmml" xref="S4.E6.m1.11.11.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.11.11.1.1.3.3.2.2a.cmml" xref="S4.E6.m1.11.11.1.1.3.3.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.11.11.1.1.3.3.2.2.cmml" xref="S4.E6.m1.11.11.1.1.3.3.2.2">W</mtext></ci><apply id="S4.E6.m1.4.4.1.cmml" xref="S4.E6.m1.4.4.1"><times id="S4.E6.m1.4.4.1.2.cmml" xref="S4.E6.m1.4.4.1.2"></times><ci id="S4.E6.m1.4.4.1.1.cmml" xref="S4.E6.m1.4.4.1.1">ℎ</ci><ci id="S4.E6.m1.4.4.1.4.cmml" xref="S4.E6.m1.4.4.1.4">𝑞</ci></apply></apply><ci id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1.1">𝑙</ci></apply></apply></apply><apply id="S4.E6.m1.12.12.2.2.cmml" xref="S4.E6.m1.12.12.2.2"><eq id="S4.E6.m1.12.12.2.2.1.cmml" xref="S4.E6.m1.12.12.2.2.1"></eq><apply id="S4.E6.m1.12.12.2.2.2.cmml" xref="S4.E6.m1.12.12.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.2.2.2.1.cmml" xref="S4.E6.m1.12.12.2.2.2">superscript</csymbol><apply id="S4.E6.m1.12.12.2.2.2.2.cmml" xref="S4.E6.m1.12.12.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.2.2.2.2.1.cmml" xref="S4.E6.m1.12.12.2.2.2">subscript</csymbol><ci id="S4.E6.m1.12.12.2.2.2.2.2.cmml" xref="S4.E6.m1.12.12.2.2.2.2.2">𝑘</ci><apply id="S4.E6.m1.6.6.1.cmml" xref="S4.E6.m1.6.6.1"><times id="S4.E6.m1.6.6.1.2.cmml" xref="S4.E6.m1.6.6.1.2"></times><ci id="S4.E6.m1.6.6.1.1.cmml" xref="S4.E6.m1.6.6.1.1">ℎ</ci><ci id="S4.E6.m1.6.6.1.4.cmml" xref="S4.E6.m1.6.6.1.4">𝑗</ci></apply></apply><ci id="S4.E6.m1.7.7.1.1.cmml" xref="S4.E6.m1.7.7.1.1">𝑙</ci></apply><apply id="S4.E6.m1.12.12.2.2.3.cmml" xref="S4.E6.m1.12.12.2.2.3"><times id="S4.E6.m1.12.12.2.2.3.1.cmml" xref="S4.E6.m1.12.12.2.2.3.1"></times><apply id="S4.E6.m1.12.12.2.2.3.2.cmml" xref="S4.E6.m1.12.12.2.2.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.2.2.3.2.1.cmml" xref="S4.E6.m1.12.12.2.2.3.2">superscript</csymbol><apply id="S4.E6.m1.12.12.2.2.3.2.2.cmml" xref="S4.E6.m1.12.12.2.2.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.2.2.3.2.2.1.cmml" xref="S4.E6.m1.12.12.2.2.3.2">subscript</csymbol><ci id="S4.E6.m1.12.12.2.2.3.2.2.2.cmml" xref="S4.E6.m1.12.12.2.2.3.2.2.2">ℎ</ci><ci id="S4.E6.m1.12.12.2.2.3.2.2.3.cmml" xref="S4.E6.m1.12.12.2.2.3.2.2.3">𝑗</ci></apply><apply id="S4.E6.m1.8.8.1.1.1.cmml" xref="S4.E6.m1.8.8.1.1"><minus id="S4.E6.m1.8.8.1.1.1.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1"></minus><ci id="S4.E6.m1.8.8.1.1.1.2.cmml" xref="S4.E6.m1.8.8.1.1.1.2">𝑙</ci><cn id="S4.E6.m1.8.8.1.1.1.3.cmml" type="integer" xref="S4.E6.m1.8.8.1.1.1.3">1</cn></apply></apply><apply id="S4.E6.m1.12.12.2.2.3.3.cmml" xref="S4.E6.m1.12.12.2.2.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.2.2.3.3.1.cmml" xref="S4.E6.m1.12.12.2.2.3.3">superscript</csymbol><apply id="S4.E6.m1.12.12.2.2.3.3.2.cmml" xref="S4.E6.m1.12.12.2.2.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.12.12.2.2.3.3.2.1.cmml" xref="S4.E6.m1.12.12.2.2.3.3">subscript</csymbol><ci id="S4.E6.m1.12.12.2.2.3.3.2.2a.cmml" xref="S4.E6.m1.12.12.2.2.3.3.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E6.m1.12.12.2.2.3.3.2.2.cmml" xref="S4.E6.m1.12.12.2.2.3.3.2.2">W</mtext></ci><apply id="S4.E6.m1.9.9.1.cmml" xref="S4.E6.m1.9.9.1"><times id="S4.E6.m1.9.9.1.2.cmml" xref="S4.E6.m1.9.9.1.2"></times><ci id="S4.E6.m1.9.9.1.1.cmml" xref="S4.E6.m1.9.9.1.1">ℎ</ci><ci id="S4.E6.m1.9.9.1.4.cmml" xref="S4.E6.m1.9.9.1.4">𝑘</ci></apply></apply><ci id="S4.E6.m1.10.10.1.1.cmml" xref="S4.E6.m1.10.10.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.12c">q_{(h)i}^{(l)}=h_{i}^{(l-1)}\textbf{W}_{(h)q}^{(l)},k_{(h)j}^{(l)}=h_{j}^{(l-1%
)}\textbf{W}_{(h)k}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.12d">italic_q start_POSTSUBSCRIPT ( italic_h ) italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT W start_POSTSUBSCRIPT ( italic_h ) italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , italic_k start_POSTSUBSCRIPT ( italic_h ) italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT W start_POSTSUBSCRIPT ( italic_h ) italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.16">where <math alttext="h_{i}^{(l-1)}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.7.m1.1"><semantics id="S4.SS2.SSS0.Px1.p2.7.m1.1a"><msubsup id="S4.SS2.SSS0.Px1.p2.7.m1.1.2" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p2.7.m1.1.2.2.2" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.2.2.2.cmml">h</mi><mi id="S4.SS2.SSS0.Px1.p2.7.m1.1.2.2.3" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.2.2.3.cmml">i</mi><mrow id="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.7.m1.1b"><apply id="S4.SS2.SSS0.Px1.p2.7.m1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.7.m1.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.2">superscript</csymbol><apply id="S4.SS2.SSS0.Px1.p2.7.m1.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.7.m1.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.7.m1.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.2.2.2">ℎ</ci><ci id="S4.SS2.SSS0.Px1.p2.7.m1.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.2.2.3">𝑖</ci></apply><apply id="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1"><minus id="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p2.7.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.7.m1.1c">h_{i}^{(l-1)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.7.m1.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="h_{j}^{(l-1)}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.8.m2.1"><semantics id="S4.SS2.SSS0.Px1.p2.8.m2.1a"><msubsup id="S4.SS2.SSS0.Px1.p2.8.m2.1.2" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p2.8.m2.1.2.2.2" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.2.2.2.cmml">h</mi><mi id="S4.SS2.SSS0.Px1.p2.8.m2.1.2.2.3" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.2.2.3.cmml">j</mi><mrow id="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.8.m2.1b"><apply id="S4.SS2.SSS0.Px1.p2.8.m2.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.8.m2.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.2">superscript</csymbol><apply id="S4.SS2.SSS0.Px1.p2.8.m2.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.8.m2.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.8.m2.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.2.2.2">ℎ</ci><ci id="S4.SS2.SSS0.Px1.p2.8.m2.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.2.2.3">𝑗</ci></apply><apply id="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1"><minus id="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p2.8.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.8.m2.1c">h_{j}^{(l-1)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.8.m2.1d">italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math> denote the embeddings of the i-th node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.9.m3.1"><semantics id="S4.SS2.SSS0.Px1.p2.9.m3.1a"><msub id="S4.SS2.SSS0.Px1.p2.9.m3.1.1" xref="S4.SS2.SSS0.Px1.p2.9.m3.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.9.m3.1.1.2" xref="S4.SS2.SSS0.Px1.p2.9.m3.1.1.2.cmml">v</mi><mi id="S4.SS2.SSS0.Px1.p2.9.m3.1.1.3" xref="S4.SS2.SSS0.Px1.p2.9.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.9.m3.1b"><apply id="S4.SS2.SSS0.Px1.p2.9.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.9.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.9.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.9.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.9.m3.1.1.2">𝑣</ci><ci id="S4.SS2.SSS0.Px1.p2.9.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.9.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.9.m3.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.9.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and the j-th node <math alttext="v_{j}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.10.m4.1"><semantics id="S4.SS2.SSS0.Px1.p2.10.m4.1a"><msub id="S4.SS2.SSS0.Px1.p2.10.m4.1.1" xref="S4.SS2.SSS0.Px1.p2.10.m4.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.10.m4.1.1.2" xref="S4.SS2.SSS0.Px1.p2.10.m4.1.1.2.cmml">v</mi><mi id="S4.SS2.SSS0.Px1.p2.10.m4.1.1.3" xref="S4.SS2.SSS0.Px1.p2.10.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.10.m4.1b"><apply id="S4.SS2.SSS0.Px1.p2.10.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.10.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.10.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.10.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.10.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.10.m4.1.1.2">𝑣</ci><ci id="S4.SS2.SSS0.Px1.p2.10.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.10.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.10.m4.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.10.m4.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> of KG respectively and <math alttext="v_{j}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.11.m5.1"><semantics id="S4.SS2.SSS0.Px1.p2.11.m5.1a"><msub id="S4.SS2.SSS0.Px1.p2.11.m5.1.1" xref="S4.SS2.SSS0.Px1.p2.11.m5.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.11.m5.1.1.2" xref="S4.SS2.SSS0.Px1.p2.11.m5.1.1.2.cmml">v</mi><mi id="S4.SS2.SSS0.Px1.p2.11.m5.1.1.3" xref="S4.SS2.SSS0.Px1.p2.11.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.11.m5.1b"><apply id="S4.SS2.SSS0.Px1.p2.11.m5.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.11.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.11.m5.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.11.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.11.m5.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.11.m5.1.1.2">𝑣</ci><ci id="S4.SS2.SSS0.Px1.p2.11.m5.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.11.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.11.m5.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.11.m5.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is in <math alttext="\mathcal{N}_{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.12.m6.1"><semantics id="S4.SS2.SSS0.Px1.p2.12.m6.1a"><msub id="S4.SS2.SSS0.Px1.p2.12.m6.1.1" xref="S4.SS2.SSS0.Px1.p2.12.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px1.p2.12.m6.1.1.2" xref="S4.SS2.SSS0.Px1.p2.12.m6.1.1.2.cmml">𝒩</mi><mi id="S4.SS2.SSS0.Px1.p2.12.m6.1.1.3" xref="S4.SS2.SSS0.Px1.p2.12.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.12.m6.1b"><apply id="S4.SS2.SSS0.Px1.p2.12.m6.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.12.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.12.m6.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.12.m6.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.12.m6.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.12.m6.1.1.2">𝒩</ci><ci id="S4.SS2.SSS0.Px1.p2.12.m6.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.12.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.12.m6.1c">\mathcal{N}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.12.m6.1d">caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, which is the set of neighbors of <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.13.m7.1"><semantics id="S4.SS2.SSS0.Px1.p2.13.m7.1a"><msub id="S4.SS2.SSS0.Px1.p2.13.m7.1.1" xref="S4.SS2.SSS0.Px1.p2.13.m7.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.13.m7.1.1.2" xref="S4.SS2.SSS0.Px1.p2.13.m7.1.1.2.cmml">v</mi><mi id="S4.SS2.SSS0.Px1.p2.13.m7.1.1.3" xref="S4.SS2.SSS0.Px1.p2.13.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.13.m7.1b"><apply id="S4.SS2.SSS0.Px1.p2.13.m7.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.13.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.13.m7.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.13.m7.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.13.m7.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.13.m7.1.1.2">𝑣</ci><ci id="S4.SS2.SSS0.Px1.p2.13.m7.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.13.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.13.m7.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.13.m7.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="\mathbf{W}_{(h)q}^{(l)}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.14.m8.2"><semantics id="S4.SS2.SSS0.Px1.p2.14.m8.2a"><msubsup id="S4.SS2.SSS0.Px1.p2.14.m8.2.3" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.3.cmml"><mi id="S4.SS2.SSS0.Px1.p2.14.m8.2.3.2.2" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.3.2.2.cmml">𝐖</mi><mrow id="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1" xref="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.cmml"><mrow id="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.3.2" xref="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.1.cmml">h</mi><mo id="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.4" xref="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.4.cmml">q</mi></mrow><mrow id="S4.SS2.SSS0.Px1.p2.14.m8.2.2.1.3" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.3.cmml"><mo id="S4.SS2.SSS0.Px1.p2.14.m8.2.2.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.3.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p2.14.m8.2.2.1.1" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.2.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p2.14.m8.2.2.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.14.m8.2b"><apply id="S4.SS2.SSS0.Px1.p2.14.m8.2.3.cmml" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.14.m8.2.3.1.cmml" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.3">superscript</csymbol><apply id="S4.SS2.SSS0.Px1.p2.14.m8.2.3.2.cmml" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.14.m8.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.14.m8.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.3.2.2">𝐖</ci><apply id="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1"><times id="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.2"></times><ci id="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.1">ℎ</ci><ci id="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.4.cmml" xref="S4.SS2.SSS0.Px1.p2.14.m8.1.1.1.4">𝑞</ci></apply></apply><ci id="S4.SS2.SSS0.Px1.p2.14.m8.2.2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.14.m8.2.2.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.14.m8.2c">\mathbf{W}_{(h)q}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.14.m8.2d">bold_W start_POSTSUBSCRIPT ( italic_h ) italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{W}_{(h)k}^{(l)}\in\mathbb{R}^{D_{h}^{(l-1)}\times d_{k}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.15.m9.3"><semantics id="S4.SS2.SSS0.Px1.p2.15.m9.3a"><mrow id="S4.SS2.SSS0.Px1.p2.15.m9.3.4" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.cmml"><msubsup id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.cmml"><mi id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.2.2" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.2.2.cmml">𝐖</mi><mrow id="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1" xref="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.cmml"><mrow id="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.3.2" xref="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.1.cmml">h</mi><mo id="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.4" xref="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.4.cmml">k</mi></mrow><mrow id="S4.SS2.SSS0.Px1.p2.15.m9.2.2.1.3" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.cmml"><mo id="S4.SS2.SSS0.Px1.p2.15.m9.2.2.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p2.15.m9.2.2.1.1" xref="S4.SS2.SSS0.Px1.p2.15.m9.2.2.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p2.15.m9.2.2.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.1" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.1.cmml">∈</mo><msup id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.3" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.3.cmml"><mi id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.3.2" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.cmml"><msubsup id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.cmml"><mi id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.2.2" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.2.2.cmml">D</mi><mi id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.2.3" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.2.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.2" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.2.cmml">×</mo><msub id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4.cmml"><mi id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4.2" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4.2.cmml">d</mi><mi id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4.3" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.15.m9.3b"><apply id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4"><in id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.1"></in><apply id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2">superscript</csymbol><apply id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.2.2.2">𝐖</ci><apply id="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1"><times id="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.2"></times><ci id="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.1">ℎ</ci><ci id="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.4.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.1.1.1.4">𝑘</ci></apply></apply><ci id="S4.SS2.SSS0.Px1.p2.15.m9.2.2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.2.2.1.1">𝑙</ci></apply><apply id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.3.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.3.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.15.m9.3.4.3.2.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.4.3.2">ℝ</ci><apply id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1"><times id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.2"></times><apply id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3">superscript</csymbol><apply id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.2.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.2.2">𝐷</ci><ci id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.2.3.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.3.2.3">ℎ</ci></apply><apply id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1"><minus id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4.1.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4.2.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4.2">𝑑</ci><ci id="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4.3.cmml" xref="S4.SS2.SSS0.Px1.p2.15.m9.3.3.1.4.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.15.m9.3c">\mathbf{W}_{(h)k}^{(l)}\in\mathbb{R}^{D_{h}^{(l-1)}\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.15.m9.3d">bold_W start_POSTSUBSCRIPT ( italic_h ) italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are relation-independent learnable projection matrices. <math alttext="d_{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p2.16.m10.1"><semantics id="S4.SS2.SSS0.Px1.p2.16.m10.1a"><msub id="S4.SS2.SSS0.Px1.p2.16.m10.1.1" xref="S4.SS2.SSS0.Px1.p2.16.m10.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p2.16.m10.1.1.2" xref="S4.SS2.SSS0.Px1.p2.16.m10.1.1.2.cmml">d</mi><mi id="S4.SS2.SSS0.Px1.p2.16.m10.1.1.3" xref="S4.SS2.SSS0.Px1.p2.16.m10.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p2.16.m10.1b"><apply id="S4.SS2.SSS0.Px1.p2.16.m10.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.16.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p2.16.m10.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p2.16.m10.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p2.16.m10.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p2.16.m10.1.1.2">𝑑</ci><ci id="S4.SS2.SSS0.Px1.p2.16.m10.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p2.16.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p2.16.m10.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p2.16.m10.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the dimension of the query vector and key vector.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p3">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p3.4">After obtaining the query and key vector, we use a shared attention mechanism when measuring the relation-independent entity importance as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{att}^{(l)}_{(h)ij}=f(q_{(h)i}^{(l)}\odot k_{(h)j}^{(l)})" class="ltx_Math" display="block" id="S4.E7.m1.7"><semantics id="S4.E7.m1.7a"><mrow id="S4.E7.m1.7.7" xref="S4.E7.m1.7.7.cmml"><msubsup id="S4.E7.m1.7.7.3" xref="S4.E7.m1.7.7.3.cmml"><mtext id="S4.E7.m1.7.7.3.2.2" xref="S4.E7.m1.7.7.3.2.2a.cmml">att</mtext><mrow id="S4.E7.m1.2.2.1" xref="S4.E7.m1.2.2.1.cmml"><mrow id="S4.E7.m1.2.2.1.3.2" xref="S4.E7.m1.2.2.1.cmml"><mo id="S4.E7.m1.2.2.1.3.2.1" stretchy="false" xref="S4.E7.m1.2.2.1.cmml">(</mo><mi id="S4.E7.m1.2.2.1.1" xref="S4.E7.m1.2.2.1.1.cmml">h</mi><mo id="S4.E7.m1.2.2.1.3.2.2" stretchy="false" xref="S4.E7.m1.2.2.1.cmml">)</mo></mrow><mo id="S4.E7.m1.2.2.1.2" xref="S4.E7.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E7.m1.2.2.1.4" xref="S4.E7.m1.2.2.1.4.cmml">i</mi><mo id="S4.E7.m1.2.2.1.2a" xref="S4.E7.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E7.m1.2.2.1.5" xref="S4.E7.m1.2.2.1.5.cmml">j</mi></mrow><mrow id="S4.E7.m1.1.1.1.3" xref="S4.E7.m1.7.7.3.cmml"><mo id="S4.E7.m1.1.1.1.3.1" stretchy="false" xref="S4.E7.m1.7.7.3.cmml">(</mo><mi id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml">l</mi><mo id="S4.E7.m1.1.1.1.3.2" stretchy="false" xref="S4.E7.m1.7.7.3.cmml">)</mo></mrow></msubsup><mo id="S4.E7.m1.7.7.2" xref="S4.E7.m1.7.7.2.cmml">=</mo><mrow id="S4.E7.m1.7.7.1" xref="S4.E7.m1.7.7.1.cmml"><mi id="S4.E7.m1.7.7.1.3" xref="S4.E7.m1.7.7.1.3.cmml">f</mi><mo id="S4.E7.m1.7.7.1.2" xref="S4.E7.m1.7.7.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.7.7.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.cmml"><mo id="S4.E7.m1.7.7.1.1.1.2" stretchy="false" xref="S4.E7.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.7.7.1.1.1.1" xref="S4.E7.m1.7.7.1.1.1.1.cmml"><msubsup id="S4.E7.m1.7.7.1.1.1.1.2" xref="S4.E7.m1.7.7.1.1.1.1.2.cmml"><mi id="S4.E7.m1.7.7.1.1.1.1.2.2.2" xref="S4.E7.m1.7.7.1.1.1.1.2.2.2.cmml">q</mi><mrow id="S4.E7.m1.3.3.1" xref="S4.E7.m1.3.3.1.cmml"><mrow id="S4.E7.m1.3.3.1.3.2" xref="S4.E7.m1.3.3.1.cmml"><mo id="S4.E7.m1.3.3.1.3.2.1" stretchy="false" xref="S4.E7.m1.3.3.1.cmml">(</mo><mi id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml">h</mi><mo id="S4.E7.m1.3.3.1.3.2.2" stretchy="false" xref="S4.E7.m1.3.3.1.cmml">)</mo></mrow><mo id="S4.E7.m1.3.3.1.2" xref="S4.E7.m1.3.3.1.2.cmml">⁢</mo><mi id="S4.E7.m1.3.3.1.4" xref="S4.E7.m1.3.3.1.4.cmml">i</mi></mrow><mrow id="S4.E7.m1.4.4.1.3" xref="S4.E7.m1.7.7.1.1.1.1.2.cmml"><mo id="S4.E7.m1.4.4.1.3.1" stretchy="false" xref="S4.E7.m1.7.7.1.1.1.1.2.cmml">(</mo><mi id="S4.E7.m1.4.4.1.1" xref="S4.E7.m1.4.4.1.1.cmml">l</mi><mo id="S4.E7.m1.4.4.1.3.2" stretchy="false" xref="S4.E7.m1.7.7.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.E7.m1.7.7.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.E7.m1.7.7.1.1.1.1.1.cmml">⊙</mo><msubsup id="S4.E7.m1.7.7.1.1.1.1.3" xref="S4.E7.m1.7.7.1.1.1.1.3.cmml"><mi id="S4.E7.m1.7.7.1.1.1.1.3.2.2" xref="S4.E7.m1.7.7.1.1.1.1.3.2.2.cmml">k</mi><mrow id="S4.E7.m1.5.5.1" xref="S4.E7.m1.5.5.1.cmml"><mrow id="S4.E7.m1.5.5.1.3.2" xref="S4.E7.m1.5.5.1.cmml"><mo id="S4.E7.m1.5.5.1.3.2.1" stretchy="false" xref="S4.E7.m1.5.5.1.cmml">(</mo><mi id="S4.E7.m1.5.5.1.1" xref="S4.E7.m1.5.5.1.1.cmml">h</mi><mo id="S4.E7.m1.5.5.1.3.2.2" stretchy="false" xref="S4.E7.m1.5.5.1.cmml">)</mo></mrow><mo id="S4.E7.m1.5.5.1.2" xref="S4.E7.m1.5.5.1.2.cmml">⁢</mo><mi id="S4.E7.m1.5.5.1.4" xref="S4.E7.m1.5.5.1.4.cmml">j</mi></mrow><mrow id="S4.E7.m1.6.6.1.3" xref="S4.E7.m1.7.7.1.1.1.1.3.cmml"><mo id="S4.E7.m1.6.6.1.3.1" stretchy="false" xref="S4.E7.m1.7.7.1.1.1.1.3.cmml">(</mo><mi id="S4.E7.m1.6.6.1.1" xref="S4.E7.m1.6.6.1.1.cmml">l</mi><mo id="S4.E7.m1.6.6.1.3.2" stretchy="false" xref="S4.E7.m1.7.7.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E7.m1.7.7.1.1.1.3" stretchy="false" xref="S4.E7.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.7b"><apply id="S4.E7.m1.7.7.cmml" xref="S4.E7.m1.7.7"><eq id="S4.E7.m1.7.7.2.cmml" xref="S4.E7.m1.7.7.2"></eq><apply id="S4.E7.m1.7.7.3.cmml" xref="S4.E7.m1.7.7.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.3.1.cmml" xref="S4.E7.m1.7.7.3">subscript</csymbol><apply id="S4.E7.m1.7.7.3.2.cmml" xref="S4.E7.m1.7.7.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.3.2.1.cmml" xref="S4.E7.m1.7.7.3">superscript</csymbol><ci id="S4.E7.m1.7.7.3.2.2a.cmml" xref="S4.E7.m1.7.7.3.2.2"><mtext id="S4.E7.m1.7.7.3.2.2.cmml" xref="S4.E7.m1.7.7.3.2.2">att</mtext></ci><ci id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E7.m1.2.2.1.cmml" xref="S4.E7.m1.2.2.1"><times id="S4.E7.m1.2.2.1.2.cmml" xref="S4.E7.m1.2.2.1.2"></times><ci id="S4.E7.m1.2.2.1.1.cmml" xref="S4.E7.m1.2.2.1.1">ℎ</ci><ci id="S4.E7.m1.2.2.1.4.cmml" xref="S4.E7.m1.2.2.1.4">𝑖</ci><ci id="S4.E7.m1.2.2.1.5.cmml" xref="S4.E7.m1.2.2.1.5">𝑗</ci></apply></apply><apply id="S4.E7.m1.7.7.1.cmml" xref="S4.E7.m1.7.7.1"><times id="S4.E7.m1.7.7.1.2.cmml" xref="S4.E7.m1.7.7.1.2"></times><ci id="S4.E7.m1.7.7.1.3.cmml" xref="S4.E7.m1.7.7.1.3">𝑓</ci><apply id="S4.E7.m1.7.7.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.7.7.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.1">direct-product</csymbol><apply id="S4.E7.m1.7.7.1.1.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.2.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2">superscript</csymbol><apply id="S4.E7.m1.7.7.1.1.1.1.2.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.7.7.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.2.2.2">𝑞</ci><apply id="S4.E7.m1.3.3.1.cmml" xref="S4.E7.m1.3.3.1"><times id="S4.E7.m1.3.3.1.2.cmml" xref="S4.E7.m1.3.3.1.2"></times><ci id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1.1">ℎ</ci><ci id="S4.E7.m1.3.3.1.4.cmml" xref="S4.E7.m1.3.3.1.4">𝑖</ci></apply></apply><ci id="S4.E7.m1.4.4.1.1.cmml" xref="S4.E7.m1.4.4.1.1">𝑙</ci></apply><apply id="S4.E7.m1.7.7.1.1.1.1.3.cmml" xref="S4.E7.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.3.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.3">superscript</csymbol><apply id="S4.E7.m1.7.7.1.1.1.1.3.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.7.7.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.7.7.1.1.1.1.3.2.2">𝑘</ci><apply id="S4.E7.m1.5.5.1.cmml" xref="S4.E7.m1.5.5.1"><times id="S4.E7.m1.5.5.1.2.cmml" xref="S4.E7.m1.5.5.1.2"></times><ci id="S4.E7.m1.5.5.1.1.cmml" xref="S4.E7.m1.5.5.1.1">ℎ</ci><ci id="S4.E7.m1.5.5.1.4.cmml" xref="S4.E7.m1.5.5.1.4">𝑗</ci></apply></apply><ci id="S4.E7.m1.6.6.1.1.cmml" xref="S4.E7.m1.6.6.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.7c">\text{att}^{(l)}_{(h)ij}=f(q_{(h)i}^{(l)}\odot k_{(h)j}^{(l)})</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.7d">att start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i italic_j end_POSTSUBSCRIPT = italic_f ( italic_q start_POSTSUBSCRIPT ( italic_h ) italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ⊙ italic_k start_POSTSUBSCRIPT ( italic_h ) italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p3.3">where <math alttext="\odot" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.1.m1.1"><semantics id="S4.SS2.SSS0.Px1.p3.1.m1.1a"><mo id="S4.SS2.SSS0.Px1.p3.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.1.m1.1b"><csymbol cd="latexml" id="S4.SS2.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.1.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.1.m1.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.1.m1.1d">⊙</annotation></semantics></math> means Hadamard product, <math alttext="f(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p3.2.m2.1a"><mrow id="S4.SS2.SSS0.Px1.p3.2.m2.1.2" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.2.cmml"><mi id="S4.SS2.SSS0.Px1.p3.2.m2.1.2.2" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.2.2.cmml">f</mi><mo id="S4.SS2.SSS0.Px1.p3.2.m2.1.2.1" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px1.p3.2.m2.1.2.3.2" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.2.cmml"><mo id="S4.SS2.SSS0.Px1.p3.2.m2.1.2.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.2.cmml">(</mo><mo id="S4.SS2.SSS0.Px1.p3.2.m2.1.1" lspace="0em" rspace="0em" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1.cmml">⋅</mo><mo id="S4.SS2.SSS0.Px1.p3.2.m2.1.2.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p3.2.m2.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.2"><times id="S4.SS2.SSS0.Px1.p3.2.m2.1.2.1.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.2.1"></times><ci id="S4.SS2.SSS0.Px1.p3.2.m2.1.2.2.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.2.2">𝑓</ci><ci id="S4.SS2.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.2.m2.1c">f(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.2.m2.1d">italic_f ( ⋅ )</annotation></semantics></math> represents a feed-forward network capable of capturing entity features with a parameter matrix of <math alttext="W\in\mathcal{R}^{d_{k}\times 1}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p3.3.m3.1"><semantics id="S4.SS2.SSS0.Px1.p3.3.m3.1a"><mrow id="S4.SS2.SSS0.Px1.p3.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.2" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.2.cmml">W</mi><mo id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.1" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.2" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.2.cmml">ℛ</mi><mrow id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.cmml"><msub id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2.cmml"><mi id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2.2" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2.2.cmml">d</mi><mi id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2.3" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2.3.cmml">k</mi></msub><mo id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.3" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p3.3.m3.1b"><apply id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1"><in id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.1"></in><ci id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.2">𝑊</ci><apply id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.2">ℛ</ci><apply id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3"><times id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.1.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.1"></times><apply id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2.2">𝑑</ci><ci id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2.3.cmml" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.2.3">𝑘</ci></apply><cn id="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.3.cmml" type="integer" xref="S4.SS2.SSS0.Px1.p3.3.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p3.3.m3.1c">W\in\mathcal{R}^{d_{k}\times 1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p3.3.m3.1d">italic_W ∈ caligraphic_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT × 1 end_POSTSUPERSCRIPT</annotation></semantics></math>, followed by a nonlinear function.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p4">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p4.4">Finally, softmax is used to make the importance smoother, i.e.,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E8">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E8X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha^{(l)}_{(h)ij}" class="ltx_Math" display="inline" id="S4.E8X.2.1.1.m1.2"><semantics id="S4.E8X.2.1.1.m1.2a"><msubsup id="S4.E8X.2.1.1.m1.2.3" xref="S4.E8X.2.1.1.m1.2.3.cmml"><mi id="S4.E8X.2.1.1.m1.2.3.2.2" xref="S4.E8X.2.1.1.m1.2.3.2.2.cmml">α</mi><mrow id="S4.E8X.2.1.1.m1.2.2.1" xref="S4.E8X.2.1.1.m1.2.2.1.cmml"><mrow id="S4.E8X.2.1.1.m1.2.2.1.3.2" xref="S4.E8X.2.1.1.m1.2.2.1.cmml"><mo id="S4.E8X.2.1.1.m1.2.2.1.3.2.1" stretchy="false" xref="S4.E8X.2.1.1.m1.2.2.1.cmml">(</mo><mi id="S4.E8X.2.1.1.m1.2.2.1.1" xref="S4.E8X.2.1.1.m1.2.2.1.1.cmml">h</mi><mo id="S4.E8X.2.1.1.m1.2.2.1.3.2.2" stretchy="false" xref="S4.E8X.2.1.1.m1.2.2.1.cmml">)</mo></mrow><mo id="S4.E8X.2.1.1.m1.2.2.1.2" xref="S4.E8X.2.1.1.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E8X.2.1.1.m1.2.2.1.4" xref="S4.E8X.2.1.1.m1.2.2.1.4.cmml">i</mi><mo id="S4.E8X.2.1.1.m1.2.2.1.2a" xref="S4.E8X.2.1.1.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E8X.2.1.1.m1.2.2.1.5" xref="S4.E8X.2.1.1.m1.2.2.1.5.cmml">j</mi></mrow><mrow id="S4.E8X.2.1.1.m1.1.1.1.3" xref="S4.E8X.2.1.1.m1.2.3.cmml"><mo id="S4.E8X.2.1.1.m1.1.1.1.3.1" stretchy="false" xref="S4.E8X.2.1.1.m1.2.3.cmml">(</mo><mi id="S4.E8X.2.1.1.m1.1.1.1.1" xref="S4.E8X.2.1.1.m1.1.1.1.1.cmml">l</mi><mo id="S4.E8X.2.1.1.m1.1.1.1.3.2" stretchy="false" xref="S4.E8X.2.1.1.m1.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.E8X.2.1.1.m1.2b"><apply id="S4.E8X.2.1.1.m1.2.3.cmml" xref="S4.E8X.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.2.3.1.cmml" xref="S4.E8X.2.1.1.m1.2.3">subscript</csymbol><apply id="S4.E8X.2.1.1.m1.2.3.2.cmml" xref="S4.E8X.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.2.3.2.1.cmml" xref="S4.E8X.2.1.1.m1.2.3">superscript</csymbol><ci id="S4.E8X.2.1.1.m1.2.3.2.2.cmml" xref="S4.E8X.2.1.1.m1.2.3.2.2">𝛼</ci><ci id="S4.E8X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E8X.2.1.1.m1.2.2.1.cmml" xref="S4.E8X.2.1.1.m1.2.2.1"><times id="S4.E8X.2.1.1.m1.2.2.1.2.cmml" xref="S4.E8X.2.1.1.m1.2.2.1.2"></times><ci id="S4.E8X.2.1.1.m1.2.2.1.1.cmml" xref="S4.E8X.2.1.1.m1.2.2.1.1">ℎ</ci><ci id="S4.E8X.2.1.1.m1.2.2.1.4.cmml" xref="S4.E8X.2.1.1.m1.2.2.1.4">𝑖</ci><ci id="S4.E8X.2.1.1.m1.2.2.1.5.cmml" xref="S4.E8X.2.1.1.m1.2.2.1.5">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8X.2.1.1.m1.2c">\displaystyle\alpha^{(l)}_{(h)ij}</annotation><annotation encoding="application/x-llamapun" id="S4.E8X.2.1.1.m1.2d">italic_α start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{softmax}_{j}(att^{(l)}_{(h)ij})" class="ltx_Math" display="inline" id="S4.E8X.3.2.2.m1.3"><semantics id="S4.E8X.3.2.2.m1.3a"><mrow id="S4.E8X.3.2.2.m1.3.3" xref="S4.E8X.3.2.2.m1.3.3.cmml"><mi id="S4.E8X.3.2.2.m1.3.3.3" xref="S4.E8X.3.2.2.m1.3.3.3.cmml"></mi><mo id="S4.E8X.3.2.2.m1.3.3.2" xref="S4.E8X.3.2.2.m1.3.3.2.cmml">=</mo><mrow id="S4.E8X.3.2.2.m1.3.3.1" xref="S4.E8X.3.2.2.m1.3.3.1.cmml"><msub id="S4.E8X.3.2.2.m1.3.3.1.3" xref="S4.E8X.3.2.2.m1.3.3.1.3.cmml"><mtext id="S4.E8X.3.2.2.m1.3.3.1.3.2" xref="S4.E8X.3.2.2.m1.3.3.1.3.2a.cmml">softmax</mtext><mi id="S4.E8X.3.2.2.m1.3.3.1.3.3" xref="S4.E8X.3.2.2.m1.3.3.1.3.3.cmml">j</mi></msub><mo id="S4.E8X.3.2.2.m1.3.3.1.2" xref="S4.E8X.3.2.2.m1.3.3.1.2.cmml">⁢</mo><mrow id="S4.E8X.3.2.2.m1.3.3.1.1.1" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.cmml"><mo id="S4.E8X.3.2.2.m1.3.3.1.1.1.2" stretchy="false" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.E8X.3.2.2.m1.3.3.1.1.1.1" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.cmml"><mi id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.2" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.2.cmml">a</mi><mo id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.3" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.3.cmml">t</mi><mo id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1a" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><msubsup id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.cmml"><mi id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.2.2" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.2.2.cmml">t</mi><mrow id="S4.E8X.3.2.2.m1.2.2.1" xref="S4.E8X.3.2.2.m1.2.2.1.cmml"><mrow id="S4.E8X.3.2.2.m1.2.2.1.3.2" xref="S4.E8X.3.2.2.m1.2.2.1.cmml"><mo id="S4.E8X.3.2.2.m1.2.2.1.3.2.1" stretchy="false" xref="S4.E8X.3.2.2.m1.2.2.1.cmml">(</mo><mi id="S4.E8X.3.2.2.m1.2.2.1.1" xref="S4.E8X.3.2.2.m1.2.2.1.1.cmml">h</mi><mo id="S4.E8X.3.2.2.m1.2.2.1.3.2.2" stretchy="false" xref="S4.E8X.3.2.2.m1.2.2.1.cmml">)</mo></mrow><mo id="S4.E8X.3.2.2.m1.2.2.1.2" xref="S4.E8X.3.2.2.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E8X.3.2.2.m1.2.2.1.4" xref="S4.E8X.3.2.2.m1.2.2.1.4.cmml">i</mi><mo id="S4.E8X.3.2.2.m1.2.2.1.2a" xref="S4.E8X.3.2.2.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E8X.3.2.2.m1.2.2.1.5" xref="S4.E8X.3.2.2.m1.2.2.1.5.cmml">j</mi></mrow><mrow id="S4.E8X.3.2.2.m1.1.1.1.3" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.cmml"><mo id="S4.E8X.3.2.2.m1.1.1.1.3.1" stretchy="false" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.cmml">(</mo><mi id="S4.E8X.3.2.2.m1.1.1.1.1" xref="S4.E8X.3.2.2.m1.1.1.1.1.cmml">l</mi><mo id="S4.E8X.3.2.2.m1.1.1.1.3.2" stretchy="false" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E8X.3.2.2.m1.3.3.1.1.1.3" stretchy="false" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8X.3.2.2.m1.3b"><apply id="S4.E8X.3.2.2.m1.3.3.cmml" xref="S4.E8X.3.2.2.m1.3.3"><eq id="S4.E8X.3.2.2.m1.3.3.2.cmml" xref="S4.E8X.3.2.2.m1.3.3.2"></eq><csymbol cd="latexml" id="S4.E8X.3.2.2.m1.3.3.3.cmml" xref="S4.E8X.3.2.2.m1.3.3.3">absent</csymbol><apply id="S4.E8X.3.2.2.m1.3.3.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1"><times id="S4.E8X.3.2.2.m1.3.3.1.2.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.2"></times><apply id="S4.E8X.3.2.2.m1.3.3.1.3.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.3"><csymbol cd="ambiguous" id="S4.E8X.3.2.2.m1.3.3.1.3.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.3">subscript</csymbol><ci id="S4.E8X.3.2.2.m1.3.3.1.3.2a.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.3.2"><mtext id="S4.E8X.3.2.2.m1.3.3.1.3.2.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.3.2">softmax</mtext></ci><ci id="S4.E8X.3.2.2.m1.3.3.1.3.3.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.3.3">𝑗</ci></apply><apply id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1"><times id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1"></times><ci id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.2">𝑎</ci><ci id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.3.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.3">𝑡</ci><apply id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4">subscript</csymbol><apply id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.2.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.2.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4">superscript</csymbol><ci id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.2.2.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.4.2.2">𝑡</ci><ci id="S4.E8X.3.2.2.m1.1.1.1.1.cmml" xref="S4.E8X.3.2.2.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E8X.3.2.2.m1.2.2.1.cmml" xref="S4.E8X.3.2.2.m1.2.2.1"><times id="S4.E8X.3.2.2.m1.2.2.1.2.cmml" xref="S4.E8X.3.2.2.m1.2.2.1.2"></times><ci id="S4.E8X.3.2.2.m1.2.2.1.1.cmml" xref="S4.E8X.3.2.2.m1.2.2.1.1">ℎ</ci><ci id="S4.E8X.3.2.2.m1.2.2.1.4.cmml" xref="S4.E8X.3.2.2.m1.2.2.1.4">𝑖</ci><ci id="S4.E8X.3.2.2.m1.2.2.1.5.cmml" xref="S4.E8X.3.2.2.m1.2.2.1.5">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8X.3.2.2.m1.3c">\displaystyle=\text{softmax}_{j}(att^{(l)}_{(h)ij})</annotation><annotation encoding="application/x-llamapun" id="S4.E8X.3.2.2.m1.3d">= softmax start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_a italic_t italic_t start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i italic_j end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E8Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\exp(att^{(l)}_{(h)ij})}{\sum_{v_{k}\in\mathcal{N}_{i}}%
\exp(\text{att}^{(l)}_{(h)ik})}" class="ltx_Math" display="inline" id="S4.E8Xa.2.1.1.m1.8"><semantics id="S4.E8Xa.2.1.1.m1.8a"><mrow id="S4.E8Xa.2.1.1.m1.8.9" xref="S4.E8Xa.2.1.1.m1.8.9.cmml"><mi id="S4.E8Xa.2.1.1.m1.8.9.2" xref="S4.E8Xa.2.1.1.m1.8.9.2.cmml"></mi><mo id="S4.E8Xa.2.1.1.m1.8.9.1" xref="S4.E8Xa.2.1.1.m1.8.9.1.cmml">=</mo><mstyle displaystyle="true" id="S4.E8Xa.2.1.1.m1.8.8" xref="S4.E8Xa.2.1.1.m1.8.8.cmml"><mfrac id="S4.E8Xa.2.1.1.m1.8.8a" xref="S4.E8Xa.2.1.1.m1.8.8.cmml"><mrow id="S4.E8Xa.2.1.1.m1.4.4.4.4" xref="S4.E8Xa.2.1.1.m1.4.4.4.5.cmml"><mi id="S4.E8Xa.2.1.1.m1.3.3.3.3" xref="S4.E8Xa.2.1.1.m1.3.3.3.3.cmml">exp</mi><mo id="S4.E8Xa.2.1.1.m1.4.4.4.4a" xref="S4.E8Xa.2.1.1.m1.4.4.4.5.cmml">⁡</mo><mrow id="S4.E8Xa.2.1.1.m1.4.4.4.4.1" xref="S4.E8Xa.2.1.1.m1.4.4.4.5.cmml"><mo id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.2" stretchy="false" xref="S4.E8Xa.2.1.1.m1.4.4.4.5.cmml">(</mo><mrow id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.cmml"><mi id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.2" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.2.cmml">a</mi><mo id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.1" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.1.cmml">⁢</mo><mi id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.3" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.3.cmml">t</mi><mo id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.1a" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.1.cmml">⁢</mo><msubsup id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.cmml"><mi id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.2.2" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.2.2.cmml">t</mi><mrow id="S4.E8Xa.2.1.1.m1.2.2.2.2.1" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.cmml"><mrow id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.3.2" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.cmml"><mo id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.3.2.1" stretchy="false" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.cmml">(</mo><mi id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.1" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.1.cmml">h</mi><mo id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.3.2.2" stretchy="false" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.cmml">)</mo></mrow><mo id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.2" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.4" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.4.cmml">i</mi><mo id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.2a" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.5" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.5.cmml">j</mi></mrow><mrow id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.3" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.cmml"><mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.3.1" stretchy="false" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.cmml">(</mo><mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.cmml">l</mi><mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.3.2" stretchy="false" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.3" stretchy="false" xref="S4.E8Xa.2.1.1.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S4.E8Xa.2.1.1.m1.8.8.8" xref="S4.E8Xa.2.1.1.m1.8.8.8.cmml"><msub id="S4.E8Xa.2.1.1.m1.8.8.8.5" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.cmml"><mo id="S4.E8Xa.2.1.1.m1.8.8.8.5.2" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.2.cmml">∑</mo><mrow id="S4.E8Xa.2.1.1.m1.8.8.8.5.3" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.cmml"><msub id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2.cmml"><mi id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2.2" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2.2.cmml">v</mi><mi id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2.3" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2.3.cmml">k</mi></msub><mo id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.1" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.1.cmml">∈</mo><msub id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3.2" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3.2.cmml">𝒩</mi><mi id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3.3" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3.3.cmml">i</mi></msub></mrow></msub><mrow id="S4.E8Xa.2.1.1.m1.8.8.8.4.1" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.2.cmml"><mi id="S4.E8Xa.2.1.1.m1.7.7.7.3" xref="S4.E8Xa.2.1.1.m1.7.7.7.3.cmml">exp</mi><mo id="S4.E8Xa.2.1.1.m1.8.8.8.4.1a" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.2.cmml">⁡</mo><mrow id="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.2.cmml"><mo id="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.2" stretchy="false" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.2.cmml">(</mo><msubsup id="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.cmml"><mtext id="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.2.2" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.2.2a.cmml">att</mtext><mrow id="S4.E8Xa.2.1.1.m1.6.6.6.2.1" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.cmml"><mrow id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.3.2" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.cmml"><mo id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.3.2.1" stretchy="false" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.cmml">(</mo><mi id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.1" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.1.cmml">h</mi><mo id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.3.2.2" stretchy="false" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.cmml">)</mo></mrow><mo id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.2" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.2.cmml">⁢</mo><mi id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.4" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.4.cmml">i</mi><mo id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.2a" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.2.cmml">⁢</mo><mi id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.5" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.5.cmml">k</mi></mrow><mrow id="S4.E8Xa.2.1.1.m1.5.5.5.1.1.3" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.cmml"><mo id="S4.E8Xa.2.1.1.m1.5.5.5.1.1.3.1" stretchy="false" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.cmml">(</mo><mi id="S4.E8Xa.2.1.1.m1.5.5.5.1.1.1" xref="S4.E8Xa.2.1.1.m1.5.5.5.1.1.1.cmml">l</mi><mo id="S4.E8Xa.2.1.1.m1.5.5.5.1.1.3.2" stretchy="false" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.3" stretchy="false" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.E8Xa.2.1.1.m1.8b"><apply id="S4.E8Xa.2.1.1.m1.8.9.cmml" xref="S4.E8Xa.2.1.1.m1.8.9"><eq id="S4.E8Xa.2.1.1.m1.8.9.1.cmml" xref="S4.E8Xa.2.1.1.m1.8.9.1"></eq><csymbol cd="latexml" id="S4.E8Xa.2.1.1.m1.8.9.2.cmml" xref="S4.E8Xa.2.1.1.m1.8.9.2">absent</csymbol><apply id="S4.E8Xa.2.1.1.m1.8.8.cmml" xref="S4.E8Xa.2.1.1.m1.8.8"><divide id="S4.E8Xa.2.1.1.m1.8.8.9.cmml" xref="S4.E8Xa.2.1.1.m1.8.8"></divide><apply id="S4.E8Xa.2.1.1.m1.4.4.4.5.cmml" xref="S4.E8Xa.2.1.1.m1.4.4.4.4"><exp id="S4.E8Xa.2.1.1.m1.3.3.3.3.cmml" xref="S4.E8Xa.2.1.1.m1.3.3.3.3"></exp><apply id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1"><times id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.1"></times><ci id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.2.cmml" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.2">𝑎</ci><ci id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.3.cmml" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.3">𝑡</ci><apply id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.cmml" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4"><csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.1.cmml" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4">subscript</csymbol><apply id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.2.cmml" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4"><csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.2.1.cmml" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4">superscript</csymbol><ci id="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.2.2.cmml" xref="S4.E8Xa.2.1.1.m1.4.4.4.4.1.1.4.2.2">𝑡</ci><ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1">𝑙</ci></apply><apply id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.cmml" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1"><times id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.2.cmml" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.2"></times><ci id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.1">ℎ</ci><ci id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.4.cmml" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.4">𝑖</ci><ci id="S4.E8Xa.2.1.1.m1.2.2.2.2.1.5.cmml" xref="S4.E8Xa.2.1.1.m1.2.2.2.2.1.5">𝑗</ci></apply></apply></apply></apply><apply id="S4.E8Xa.2.1.1.m1.8.8.8.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8"><apply id="S4.E8Xa.2.1.1.m1.8.8.8.5.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5"><csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.8.8.8.5.1.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5">subscript</csymbol><sum id="S4.E8Xa.2.1.1.m1.8.8.8.5.2.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.2"></sum><apply id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3"><in id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.1.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.1"></in><apply id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2"><csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2.1.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2">subscript</csymbol><ci id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2.2.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2.2">𝑣</ci><ci id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2.3.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.2.3">𝑘</ci></apply><apply id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3"><csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3.1.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3">subscript</csymbol><ci id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3.2.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3.2">𝒩</ci><ci id="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3.3.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.5.3.3.3">𝑖</ci></apply></apply></apply><apply id="S4.E8Xa.2.1.1.m1.8.8.8.4.2.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1"><exp id="S4.E8Xa.2.1.1.m1.7.7.7.3.cmml" xref="S4.E8Xa.2.1.1.m1.7.7.7.3"></exp><apply id="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1"><csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1">subscript</csymbol><apply id="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.2.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1"><csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.2.1.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1">superscript</csymbol><ci id="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.2.2a.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.2.2"><mtext id="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.2.2.cmml" xref="S4.E8Xa.2.1.1.m1.8.8.8.4.1.1.1.2.2">att</mtext></ci><ci id="S4.E8Xa.2.1.1.m1.5.5.5.1.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.5.5.5.1.1.1">𝑙</ci></apply><apply id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.cmml" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1"><times id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.2.cmml" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.2"></times><ci id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.1">ℎ</ci><ci id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.4.cmml" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.4">𝑖</ci><ci id="S4.E8Xa.2.1.1.m1.6.6.6.2.1.5.cmml" xref="S4.E8Xa.2.1.1.m1.6.6.6.2.1.5">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8Xa.2.1.1.m1.8c">\displaystyle=\frac{\exp(att^{(l)}_{(h)ij})}{\sum_{v_{k}\in\mathcal{N}_{i}}%
\exp(\text{att}^{(l)}_{(h)ik})}</annotation><annotation encoding="application/x-llamapun" id="S4.E8Xa.2.1.1.m1.8d">= divide start_ARG roman_exp ( italic_a italic_t italic_t start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_exp ( att start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i italic_k end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p4.3">where <math alttext="\alpha^{(l)}_{(h)ij}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p4.1.m1.2"><semantics id="S4.SS2.SSS0.Px1.p4.1.m1.2a"><msubsup id="S4.SS2.SSS0.Px1.p4.1.m1.2.3" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.3.cmml"><mi id="S4.SS2.SSS0.Px1.p4.1.m1.2.3.2.2" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.3.2.2.cmml">α</mi><mrow id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.cmml"><mrow id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.3.2" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.cmml"><mo id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.1" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.1.cmml">h</mi><mo id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.2" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.4" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.4.cmml">i</mi><mo id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.2a" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.5" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.5.cmml">j</mi></mrow><mrow id="S4.SS2.SSS0.Px1.p4.1.m1.1.1.1.3" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.3.cmml"><mo id="S4.SS2.SSS0.Px1.p4.1.m1.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.3.cmml">(</mo><mi id="S4.SS2.SSS0.Px1.p4.1.m1.1.1.1.1" xref="S4.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px1.p4.1.m1.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p4.1.m1.2b"><apply id="S4.SS2.SSS0.Px1.p4.1.m1.2.3.cmml" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p4.1.m1.2.3.1.cmml" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.3">subscript</csymbol><apply id="S4.SS2.SSS0.Px1.p4.1.m1.2.3.2.cmml" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p4.1.m1.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px1.p4.1.m1.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.3.2.2">𝛼</ci><ci id="S4.SS2.SSS0.Px1.p4.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p4.1.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.cmml" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1"><times id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.2.cmml" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.2"></times><ci id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.1">ℎ</ci><ci id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.4.cmml" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.4">𝑖</ci><ci id="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.5.cmml" xref="S4.SS2.SSS0.Px1.p4.1.m1.2.2.1.5">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p4.1.m1.2c">\alpha^{(l)}_{(h)ij}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p4.1.m1.2d">italic_α start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the attention score of the central node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p4.2.m2.1"><semantics id="S4.SS2.SSS0.Px1.p4.2.m2.1a"><msub id="S4.SS2.SSS0.Px1.p4.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p4.2.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p4.2.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p4.2.m2.1.1.2.cmml">v</mi><mi id="S4.SS2.SSS0.Px1.p4.2.m2.1.1.3" xref="S4.SS2.SSS0.Px1.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p4.2.m2.1b"><apply id="S4.SS2.SSS0.Px1.p4.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p4.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p4.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p4.2.m2.1.1.2">𝑣</ci><ci id="S4.SS2.SSS0.Px1.p4.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p4.2.m2.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p4.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to its neighbor <math alttext="v_{j}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px1.p4.3.m3.1"><semantics id="S4.SS2.SSS0.Px1.p4.3.m3.1a"><msub id="S4.SS2.SSS0.Px1.p4.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p4.3.m3.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p4.3.m3.1.1.2" xref="S4.SS2.SSS0.Px1.p4.3.m3.1.1.2.cmml">v</mi><mi id="S4.SS2.SSS0.Px1.p4.3.m3.1.1.3" xref="S4.SS2.SSS0.Px1.p4.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p4.3.m3.1b"><apply id="S4.SS2.SSS0.Px1.p4.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p4.3.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p4.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p4.3.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p4.3.m3.1.1.2">𝑣</ci><ci id="S4.SS2.SSS0.Px1.p4.3.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p4.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p4.3.m3.1c">v_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px1.p4.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> when no additional relation information is considered.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Entity-Relation Joint Attention Network</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.7">In heterogeneous KGs, entities and relations are embedded in different feature spaces, which poses a challenge to effectively capture the joint features of entities and relations. A general approach is to generate a query projection matrix <math alttext="W_{Q}\in\mathbb{R}^{D\times F}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><msub id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.2.cmml">W</mi><mi id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.3" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.cmml">Q</mi></msub><mo id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.cmml"><mi id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.2" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml">D</mi><mo id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.3" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml">F</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1"><in id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.1"></in><apply id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.2">𝑊</ci><ci id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.2.3">𝑄</ci></apply><apply id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3"><times id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.1"></times><ci id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.2">𝐷</ci><ci id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.3">𝐹</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.1.m1.1c">W_{Q}\in\mathbb{R}^{D\times F}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.1.m1.1d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × italic_F end_POSTSUPERSCRIPT</annotation></semantics></math> and a key projection matrix <math alttext="W_{K}\in\mathbb{R}^{D\times F}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS2.SSS0.Px2.p1.2.m2.1a"><mrow id="S4.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.cmml"><msub id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.2" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.2.cmml">W</mi><mi id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.3" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.3.cmml">K</mi></msub><mo id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.1" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.2" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.cmml"><mi id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.2" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.2.cmml">D</mi><mo id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.3" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.3.cmml">F</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1"><in id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.1"></in><apply id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.2">𝑊</ci><ci id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.2.3">𝐾</ci></apply><apply id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3"><times id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.1"></times><ci id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.2">𝐷</ci><ci id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.3.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.3">𝐹</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.2.m2.1c">W_{K}\in\mathbb{R}^{D\times F}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × italic_F end_POSTSUPERSCRIPT</annotation></semantics></math> for each relation, project head, and tail entities as query and key vectors, respectively, and then obtain the attention score, where <math alttext="D" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="S4.SS2.SSS0.Px2.p1.3.m3.1a"><mi id="S4.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px2.p1.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.3.m3.1b"><ci id="S4.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.3.m3.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.3.m3.1d">italic_D</annotation></semantics></math> represents the dimension of entity embedding and <math alttext="F" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.4.m4.1"><semantics id="S4.SS2.SSS0.Px2.p1.4.m4.1a"><mi id="S4.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px2.p1.4.m4.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.4.m4.1b"><ci id="S4.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.4.m4.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.4.m4.1c">F</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.4.m4.1d">italic_F</annotation></semantics></math> represents the dimension of query vector and key vector. For a KG with <math alttext="n" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.5.m5.1"><semantics id="S4.SS2.SSS0.Px2.p1.5.m5.1a"><mi id="S4.SS2.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS2.SSS0.Px2.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.5.m5.1b"><ci id="S4.SS2.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.5.m5.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.5.m5.1d">italic_n</annotation></semantics></math> types of relations, the model needs <math alttext="2*n*D*F" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.6.m6.1"><semantics id="S4.SS2.SSS0.Px2.p1.6.m6.1a"><mrow id="S4.SS2.SSS0.Px2.p1.6.m6.1.1" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.cmml"><mn id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.2" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.2.cmml">2</mn><mo id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.1.cmml">∗</mo><mi id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.3" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.3.cmml">n</mi><mo id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.1.cmml">∗</mo><mi id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.4" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.4.cmml">D</mi><mo id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.1.cmml">∗</mo><mi id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.5" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.5.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.6.m6.1b"><apply id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1"><times id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.1"></times><cn id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.2.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.2">2</cn><ci id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.3">𝑛</ci><ci id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.4.cmml" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.4">𝐷</ci><ci id="S4.SS2.SSS0.Px2.p1.6.m6.1.1.5.cmml" xref="S4.SS2.SSS0.Px2.p1.6.m6.1.1.5">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.6.m6.1c">2*n*D*F</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.6.m6.1d">2 ∗ italic_n ∗ italic_D ∗ italic_F</annotation></semantics></math> space to store relation features. Therefore, this calculation method requires too many parameters for handling numerous relations in large-scale KGs while risking overfitting on sparse relations. Moreover, it is difficult to extend this approach to handle KGs with many different relations due to its high space complexity.
<span class="ltx_text" id="S4.SS2.SSS0.Px2.p1.7.1" style="color:#000000;">To simplify the parameters representing the relation, we use a <math alttext="D" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p1.7.1.m1.1"><semantics id="S4.SS2.SSS0.Px2.p1.7.1.m1.1a"><mi id="S4.SS2.SSS0.Px2.p1.7.1.m1.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px2.p1.7.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.7.1.m1.1b"><ci id="S4.SS2.SSS0.Px2.p1.7.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.7.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.7.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p1.7.1.m1.1d">italic_D</annotation></semantics></math>-dimensional embedding vector to represent the relation. Furthermore, we make two shared attention projection matrices to map head (tail) entity embeddings transformed by relations to query (key) vectors.</span></p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p2.1">We assume that each entity is represented by a combination of information in different scenarios. For example, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S1.F2" title="Figure 2 ‣ 1. Introduction ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">2</span></a>, a person entity may be represented by a combination of information in various scenarios, such as occupation information and family information. Specifically, in the entity feature space, information in different dimensions corresponds to entity information in different scenarios. A relation is a concrete representation of a scene, so each relation focuses on information under the specific dimensions of the entity feature. We refer to entity features transformed by specific relations as entity-relation joint features. We will compute the attention score based on the entity-relation joint feature.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p3">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p3.4"><span class="ltx_text" id="S4.SS2.SSS0.Px2.p3.4.4" style="color:#000000;">In practice, in the <math alttext="D" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p3.1.1.m1.1"><semantics id="S4.SS2.SSS0.Px2.p3.1.1.m1.1a"><mi id="S4.SS2.SSS0.Px2.p3.1.1.m1.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px2.p3.1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p3.1.1.m1.1b"><ci id="S4.SS2.SSS0.Px2.p3.1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p3.1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p3.1.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p3.1.1.m1.1d">italic_D</annotation></semantics></math>-dimensional relation embedding that matches the entity embedding dimension, the value under each dimension indicates the degree of attention of the relation to the entity information under the corresponding dimension. In other words, a <math alttext="D" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p3.2.2.m2.1"><semantics id="S4.SS2.SSS0.Px2.p3.2.2.m2.1a"><mi id="S4.SS2.SSS0.Px2.p3.2.2.m2.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px2.p3.2.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p3.2.2.m2.1b"><ci id="S4.SS2.SSS0.Px2.p3.2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p3.2.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p3.2.2.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p3.2.2.m2.1d">italic_D</annotation></semantics></math>-dimensional entity embedding can be represented as consisting of <math alttext="D" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p3.3.3.m3.1"><semantics id="S4.SS2.SSS0.Px2.p3.3.3.m3.1a"><mi id="S4.SS2.SSS0.Px2.p3.3.3.m3.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px2.p3.3.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p3.3.3.m3.1b"><ci id="S4.SS2.SSS0.Px2.p3.3.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px2.p3.3.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p3.3.3.m3.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p3.3.3.m3.1d">italic_D</annotation></semantics></math> subspaces of dimension <math alttext="1" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p3.4.4.m4.1"><semantics id="S4.SS2.SSS0.Px2.p3.4.4.m4.1a"><mn id="S4.SS2.SSS0.Px2.p3.4.4.m4.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px2.p3.4.4.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p3.4.4.m4.1b"><cn id="S4.SS2.SSS0.Px2.p3.4.4.m4.1.1.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p3.4.4.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p3.4.4.m4.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p3.4.4.m4.1d">1</annotation></semantics></math>. The relation-based entity feature transformation is that the relation enhances or weakens the characteristics of the entity information in each subspace. The following is a detailed demonstration of the calculation process.</span></p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p4">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p4.4">The entity-relation joint attention network internally preserves relation features <math alttext="\mathbf{R}^{(l)}\in\mathbb{R}^{N_{r}\times D_{h}^{(l-1)}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p4.1.m1.2"><semantics id="S4.SS2.SSS0.Px2.p4.1.m1.2a"><mrow id="S4.SS2.SSS0.Px2.p4.1.m1.2.3" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.cmml"><msup id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2.cmml"><mi id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2.2" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2.2.cmml">𝐑</mi><mrow id="S4.SS2.SSS0.Px2.p4.1.m1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2.cmml"><mo id="S4.SS2.SSS0.Px2.p4.1.m1.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px2.p4.1.m1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.1.m1.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px2.p4.1.m1.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2.cmml">)</mo></mrow></msup><mo id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.1" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.1.cmml">∈</mo><msup id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.3" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.3.cmml"><mi id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.3.2" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.cmml"><msub id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3.2" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3.2.cmml">N</mi><mi id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3.3" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3.3.cmml">r</mi></msub><mo id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.2.cmml">×</mo><msubsup id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.cmml"><mi id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.2.2" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.2.2.cmml">D</mi><mi id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.2.3" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.2.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></msubsup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p4.1.m1.2b"><apply id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3"><in id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.1.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.1"></in><apply id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.2.2">𝐑</ci><ci id="S4.SS2.SSS0.Px2.p4.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.3.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.3.1.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.1.m1.2.3.3.2.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.3.3.2">ℝ</ci><apply id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1"><times id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.2"></times><apply id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3.2">𝑁</ci><ci id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.3.3">𝑟</ci></apply><apply id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.1.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4">superscript</csymbol><apply id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.2.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.2.2">𝐷</ci><ci id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.2.3.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.4.2.3">ℎ</ci></apply><apply id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1"><minus id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p4.1.m1.2.2.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p4.1.m1.2c">\mathbf{R}^{(l)}\in\mathbb{R}^{N_{r}\times D_{h}^{(l-1)}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p4.1.m1.2d">bold_R start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and receives entity embeddings <math alttext="\mathbf{H}^{(l-1)}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p4.2.m2.1"><semantics id="S4.SS2.SSS0.Px2.p4.2.m2.1a"><msup id="S4.SS2.SSS0.Px2.p4.2.m2.1.2" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.2.cmml"><mi id="S4.SS2.SSS0.Px2.p4.2.m2.1.2.2" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.2.2.cmml">𝐇</mi><mrow id="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p4.2.m2.1b"><apply id="S4.SS2.SSS0.Px2.p4.2.m2.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.2.m2.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.2.m2.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.2.2">𝐇</ci><apply id="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1"><minus id="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p4.2.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p4.2.m2.1c">\mathbf{H}^{(l-1)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p4.2.m2.1d">bold_H start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="N_{r}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p4.3.m3.1"><semantics id="S4.SS2.SSS0.Px2.p4.3.m3.1a"><msub id="S4.SS2.SSS0.Px2.p4.3.m3.1.1" xref="S4.SS2.SSS0.Px2.p4.3.m3.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p4.3.m3.1.1.2" xref="S4.SS2.SSS0.Px2.p4.3.m3.1.1.2.cmml">N</mi><mi id="S4.SS2.SSS0.Px2.p4.3.m3.1.1.3" xref="S4.SS2.SSS0.Px2.p4.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p4.3.m3.1b"><apply id="S4.SS2.SSS0.Px2.p4.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.3.m3.1.1.2">𝑁</ci><ci id="S4.SS2.SSS0.Px2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p4.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p4.3.m3.1c">N_{r}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p4.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> represents the number of types of relations and <math alttext="D_{h}^{(l-1)}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p4.4.m4.1"><semantics id="S4.SS2.SSS0.Px2.p4.4.m4.1a"><msubsup id="S4.SS2.SSS0.Px2.p4.4.m4.1.2" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.2.cmml"><mi id="S4.SS2.SSS0.Px2.p4.4.m4.1.2.2.2" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.2.2.2.cmml">D</mi><mi id="S4.SS2.SSS0.Px2.p4.4.m4.1.2.2.3" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.2.2.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p4.4.m4.1b"><apply id="S4.SS2.SSS0.Px2.p4.4.m4.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.4.m4.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.2">superscript</csymbol><apply id="S4.SS2.SSS0.Px2.p4.4.m4.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.4.m4.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.4.m4.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.2.2.2">𝐷</ci><ci id="S4.SS2.SSS0.Px2.p4.4.m4.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.2.2.3">ℎ</ci></apply><apply id="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1"><minus id="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p4.4.m4.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p4.4.m4.1c">D_{h}^{(l-1)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p4.4.m4.1d">italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the dimensionality of each entity embedding. We then obtain the joint features of entities and relations through the following operations,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{joint}_{i}^{(l)}=h_{i}^{(l-1)}\odot r_{r}^{(l)},\text{joint}_{j}^{(l)}=h%
_{j}^{(l-1)}\odot r_{r}^{(l)}" class="ltx_Math" display="block" id="S4.E9.m1.8"><semantics id="S4.E9.m1.8a"><mrow id="S4.E9.m1.8.8.2" xref="S4.E9.m1.8.8.3.cmml"><mrow id="S4.E9.m1.7.7.1.1" xref="S4.E9.m1.7.7.1.1.cmml"><msubsup id="S4.E9.m1.7.7.1.1.2" xref="S4.E9.m1.7.7.1.1.2.cmml"><mtext id="S4.E9.m1.7.7.1.1.2.2.2" xref="S4.E9.m1.7.7.1.1.2.2.2a.cmml">joint</mtext><mi id="S4.E9.m1.7.7.1.1.2.2.3" xref="S4.E9.m1.7.7.1.1.2.2.3.cmml">i</mi><mrow id="S4.E9.m1.1.1.1.3" xref="S4.E9.m1.7.7.1.1.2.cmml"><mo id="S4.E9.m1.1.1.1.3.1" stretchy="false" xref="S4.E9.m1.7.7.1.1.2.cmml">(</mo><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">l</mi><mo id="S4.E9.m1.1.1.1.3.2" stretchy="false" xref="S4.E9.m1.7.7.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.E9.m1.7.7.1.1.1" xref="S4.E9.m1.7.7.1.1.1.cmml">=</mo><mrow id="S4.E9.m1.7.7.1.1.3" xref="S4.E9.m1.7.7.1.1.3.cmml"><msubsup id="S4.E9.m1.7.7.1.1.3.2" xref="S4.E9.m1.7.7.1.1.3.2.cmml"><mi id="S4.E9.m1.7.7.1.1.3.2.2.2" xref="S4.E9.m1.7.7.1.1.3.2.2.2.cmml">h</mi><mi id="S4.E9.m1.7.7.1.1.3.2.2.3" xref="S4.E9.m1.7.7.1.1.3.2.2.3.cmml">i</mi><mrow id="S4.E9.m1.2.2.1.1" xref="S4.E9.m1.2.2.1.1.1.cmml"><mo id="S4.E9.m1.2.2.1.1.2" stretchy="false" xref="S4.E9.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.2.2.1.1.1" xref="S4.E9.m1.2.2.1.1.1.cmml"><mi id="S4.E9.m1.2.2.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.2.cmml">l</mi><mo id="S4.E9.m1.2.2.1.1.1.1" xref="S4.E9.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S4.E9.m1.2.2.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E9.m1.2.2.1.1.3" stretchy="false" xref="S4.E9.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E9.m1.7.7.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E9.m1.7.7.1.1.3.1.cmml">⊙</mo><msubsup id="S4.E9.m1.7.7.1.1.3.3" xref="S4.E9.m1.7.7.1.1.3.3.cmml"><mi id="S4.E9.m1.7.7.1.1.3.3.2.2" xref="S4.E9.m1.7.7.1.1.3.3.2.2.cmml">r</mi><mi id="S4.E9.m1.7.7.1.1.3.3.2.3" xref="S4.E9.m1.7.7.1.1.3.3.2.3.cmml">r</mi><mrow id="S4.E9.m1.3.3.1.3" xref="S4.E9.m1.7.7.1.1.3.3.cmml"><mo id="S4.E9.m1.3.3.1.3.1" stretchy="false" xref="S4.E9.m1.7.7.1.1.3.3.cmml">(</mo><mi id="S4.E9.m1.3.3.1.1" xref="S4.E9.m1.3.3.1.1.cmml">l</mi><mo id="S4.E9.m1.3.3.1.3.2" stretchy="false" xref="S4.E9.m1.7.7.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S4.E9.m1.8.8.2.3" xref="S4.E9.m1.8.8.3a.cmml">,</mo><mrow id="S4.E9.m1.8.8.2.2" xref="S4.E9.m1.8.8.2.2.cmml"><msubsup id="S4.E9.m1.8.8.2.2.2" xref="S4.E9.m1.8.8.2.2.2.cmml"><mtext id="S4.E9.m1.8.8.2.2.2.2.2" xref="S4.E9.m1.8.8.2.2.2.2.2a.cmml">joint</mtext><mi id="S4.E9.m1.8.8.2.2.2.2.3" xref="S4.E9.m1.8.8.2.2.2.2.3.cmml">j</mi><mrow id="S4.E9.m1.4.4.1.3" xref="S4.E9.m1.8.8.2.2.2.cmml"><mo id="S4.E9.m1.4.4.1.3.1" stretchy="false" xref="S4.E9.m1.8.8.2.2.2.cmml">(</mo><mi id="S4.E9.m1.4.4.1.1" xref="S4.E9.m1.4.4.1.1.cmml">l</mi><mo id="S4.E9.m1.4.4.1.3.2" stretchy="false" xref="S4.E9.m1.8.8.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.E9.m1.8.8.2.2.1" xref="S4.E9.m1.8.8.2.2.1.cmml">=</mo><mrow id="S4.E9.m1.8.8.2.2.3" xref="S4.E9.m1.8.8.2.2.3.cmml"><msubsup id="S4.E9.m1.8.8.2.2.3.2" xref="S4.E9.m1.8.8.2.2.3.2.cmml"><mi id="S4.E9.m1.8.8.2.2.3.2.2.2" xref="S4.E9.m1.8.8.2.2.3.2.2.2.cmml">h</mi><mi id="S4.E9.m1.8.8.2.2.3.2.2.3" xref="S4.E9.m1.8.8.2.2.3.2.2.3.cmml">j</mi><mrow id="S4.E9.m1.5.5.1.1" xref="S4.E9.m1.5.5.1.1.1.cmml"><mo id="S4.E9.m1.5.5.1.1.2" stretchy="false" xref="S4.E9.m1.5.5.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.5.5.1.1.1" xref="S4.E9.m1.5.5.1.1.1.cmml"><mi id="S4.E9.m1.5.5.1.1.1.2" xref="S4.E9.m1.5.5.1.1.1.2.cmml">l</mi><mo id="S4.E9.m1.5.5.1.1.1.1" xref="S4.E9.m1.5.5.1.1.1.1.cmml">−</mo><mn id="S4.E9.m1.5.5.1.1.1.3" xref="S4.E9.m1.5.5.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E9.m1.5.5.1.1.3" stretchy="false" xref="S4.E9.m1.5.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E9.m1.8.8.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E9.m1.8.8.2.2.3.1.cmml">⊙</mo><msubsup id="S4.E9.m1.8.8.2.2.3.3" xref="S4.E9.m1.8.8.2.2.3.3.cmml"><mi id="S4.E9.m1.8.8.2.2.3.3.2.2" xref="S4.E9.m1.8.8.2.2.3.3.2.2.cmml">r</mi><mi id="S4.E9.m1.8.8.2.2.3.3.2.3" xref="S4.E9.m1.8.8.2.2.3.3.2.3.cmml">r</mi><mrow id="S4.E9.m1.6.6.1.3" xref="S4.E9.m1.8.8.2.2.3.3.cmml"><mo id="S4.E9.m1.6.6.1.3.1" stretchy="false" xref="S4.E9.m1.8.8.2.2.3.3.cmml">(</mo><mi id="S4.E9.m1.6.6.1.1" xref="S4.E9.m1.6.6.1.1.cmml">l</mi><mo id="S4.E9.m1.6.6.1.3.2" stretchy="false" xref="S4.E9.m1.8.8.2.2.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.8b"><apply id="S4.E9.m1.8.8.3.cmml" xref="S4.E9.m1.8.8.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.3a.cmml" xref="S4.E9.m1.8.8.2.3">formulae-sequence</csymbol><apply id="S4.E9.m1.7.7.1.1.cmml" xref="S4.E9.m1.7.7.1.1"><eq id="S4.E9.m1.7.7.1.1.1.cmml" xref="S4.E9.m1.7.7.1.1.1"></eq><apply id="S4.E9.m1.7.7.1.1.2.cmml" xref="S4.E9.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.2.1.cmml" xref="S4.E9.m1.7.7.1.1.2">superscript</csymbol><apply id="S4.E9.m1.7.7.1.1.2.2.cmml" xref="S4.E9.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.2.2.1.cmml" xref="S4.E9.m1.7.7.1.1.2">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.2.2.2a.cmml" xref="S4.E9.m1.7.7.1.1.2.2.2"><mtext id="S4.E9.m1.7.7.1.1.2.2.2.cmml" xref="S4.E9.m1.7.7.1.1.2.2.2">joint</mtext></ci><ci id="S4.E9.m1.7.7.1.1.2.2.3.cmml" xref="S4.E9.m1.7.7.1.1.2.2.3">𝑖</ci></apply><ci id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E9.m1.7.7.1.1.3.cmml" xref="S4.E9.m1.7.7.1.1.3"><csymbol cd="latexml" id="S4.E9.m1.7.7.1.1.3.1.cmml" xref="S4.E9.m1.7.7.1.1.3.1">direct-product</csymbol><apply id="S4.E9.m1.7.7.1.1.3.2.cmml" xref="S4.E9.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.3.2.1.cmml" xref="S4.E9.m1.7.7.1.1.3.2">superscript</csymbol><apply id="S4.E9.m1.7.7.1.1.3.2.2.cmml" xref="S4.E9.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.3.2.2.1.cmml" xref="S4.E9.m1.7.7.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.3.2.2.2.cmml" xref="S4.E9.m1.7.7.1.1.3.2.2.2">ℎ</ci><ci id="S4.E9.m1.7.7.1.1.3.2.2.3.cmml" xref="S4.E9.m1.7.7.1.1.3.2.2.3">𝑖</ci></apply><apply id="S4.E9.m1.2.2.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1"><minus id="S4.E9.m1.2.2.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1.1"></minus><ci id="S4.E9.m1.2.2.1.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.2">𝑙</ci><cn id="S4.E9.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.E9.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="S4.E9.m1.7.7.1.1.3.3.cmml" xref="S4.E9.m1.7.7.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.3.3.1.cmml" xref="S4.E9.m1.7.7.1.1.3.3">superscript</csymbol><apply id="S4.E9.m1.7.7.1.1.3.3.2.cmml" xref="S4.E9.m1.7.7.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.3.3.2.1.cmml" xref="S4.E9.m1.7.7.1.1.3.3">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.3.3.2.2.cmml" xref="S4.E9.m1.7.7.1.1.3.3.2.2">𝑟</ci><ci id="S4.E9.m1.7.7.1.1.3.3.2.3.cmml" xref="S4.E9.m1.7.7.1.1.3.3.2.3">𝑟</ci></apply><ci id="S4.E9.m1.3.3.1.1.cmml" xref="S4.E9.m1.3.3.1.1">𝑙</ci></apply></apply></apply><apply id="S4.E9.m1.8.8.2.2.cmml" xref="S4.E9.m1.8.8.2.2"><eq id="S4.E9.m1.8.8.2.2.1.cmml" xref="S4.E9.m1.8.8.2.2.1"></eq><apply id="S4.E9.m1.8.8.2.2.2.cmml" xref="S4.E9.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.2.2.2.1.cmml" xref="S4.E9.m1.8.8.2.2.2">superscript</csymbol><apply id="S4.E9.m1.8.8.2.2.2.2.cmml" xref="S4.E9.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.2.2.2.2.1.cmml" xref="S4.E9.m1.8.8.2.2.2">subscript</csymbol><ci id="S4.E9.m1.8.8.2.2.2.2.2a.cmml" xref="S4.E9.m1.8.8.2.2.2.2.2"><mtext id="S4.E9.m1.8.8.2.2.2.2.2.cmml" xref="S4.E9.m1.8.8.2.2.2.2.2">joint</mtext></ci><ci id="S4.E9.m1.8.8.2.2.2.2.3.cmml" xref="S4.E9.m1.8.8.2.2.2.2.3">𝑗</ci></apply><ci id="S4.E9.m1.4.4.1.1.cmml" xref="S4.E9.m1.4.4.1.1">𝑙</ci></apply><apply id="S4.E9.m1.8.8.2.2.3.cmml" xref="S4.E9.m1.8.8.2.2.3"><csymbol cd="latexml" id="S4.E9.m1.8.8.2.2.3.1.cmml" xref="S4.E9.m1.8.8.2.2.3.1">direct-product</csymbol><apply id="S4.E9.m1.8.8.2.2.3.2.cmml" xref="S4.E9.m1.8.8.2.2.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.2.2.3.2.1.cmml" xref="S4.E9.m1.8.8.2.2.3.2">superscript</csymbol><apply id="S4.E9.m1.8.8.2.2.3.2.2.cmml" xref="S4.E9.m1.8.8.2.2.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.2.2.3.2.2.1.cmml" xref="S4.E9.m1.8.8.2.2.3.2">subscript</csymbol><ci id="S4.E9.m1.8.8.2.2.3.2.2.2.cmml" xref="S4.E9.m1.8.8.2.2.3.2.2.2">ℎ</ci><ci id="S4.E9.m1.8.8.2.2.3.2.2.3.cmml" xref="S4.E9.m1.8.8.2.2.3.2.2.3">𝑗</ci></apply><apply id="S4.E9.m1.5.5.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1"><minus id="S4.E9.m1.5.5.1.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1"></minus><ci id="S4.E9.m1.5.5.1.1.1.2.cmml" xref="S4.E9.m1.5.5.1.1.1.2">𝑙</ci><cn id="S4.E9.m1.5.5.1.1.1.3.cmml" type="integer" xref="S4.E9.m1.5.5.1.1.1.3">1</cn></apply></apply><apply id="S4.E9.m1.8.8.2.2.3.3.cmml" xref="S4.E9.m1.8.8.2.2.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.2.2.3.3.1.cmml" xref="S4.E9.m1.8.8.2.2.3.3">superscript</csymbol><apply id="S4.E9.m1.8.8.2.2.3.3.2.cmml" xref="S4.E9.m1.8.8.2.2.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.2.2.3.3.2.1.cmml" xref="S4.E9.m1.8.8.2.2.3.3">subscript</csymbol><ci id="S4.E9.m1.8.8.2.2.3.3.2.2.cmml" xref="S4.E9.m1.8.8.2.2.3.3.2.2">𝑟</ci><ci id="S4.E9.m1.8.8.2.2.3.3.2.3.cmml" xref="S4.E9.m1.8.8.2.2.3.3.2.3">𝑟</ci></apply><ci id="S4.E9.m1.6.6.1.1.cmml" xref="S4.E9.m1.6.6.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.8c">\text{joint}_{i}^{(l)}=h_{i}^{(l-1)}\odot r_{r}^{(l)},\text{joint}_{j}^{(l)}=h%
_{j}^{(l-1)}\odot r_{r}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.8d">joint start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ⊙ italic_r start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , joint start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ⊙ italic_r start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p4.10">where <math alttext="r_{r}^{(l)}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p4.5.m1.1"><semantics id="S4.SS2.SSS0.Px2.p4.5.m1.1a"><msubsup id="S4.SS2.SSS0.Px2.p4.5.m1.1.2" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2.cmml"><mi id="S4.SS2.SSS0.Px2.p4.5.m1.1.2.2.2" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2.2.2.cmml">r</mi><mi id="S4.SS2.SSS0.Px2.p4.5.m1.1.2.2.3" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2.2.3.cmml">r</mi><mrow id="S4.SS2.SSS0.Px2.p4.5.m1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2.cmml"><mo id="S4.SS2.SSS0.Px2.p4.5.m1.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px2.p4.5.m1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px2.p4.5.m1.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p4.5.m1.1b"><apply id="S4.SS2.SSS0.Px2.p4.5.m1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.5.m1.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2">superscript</csymbol><apply id="S4.SS2.SSS0.Px2.p4.5.m1.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.5.m1.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.5.m1.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2.2.2">𝑟</ci><ci id="S4.SS2.SSS0.Px2.p4.5.m1.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.2.2.3">𝑟</ci></apply><ci id="S4.SS2.SSS0.Px2.p4.5.m1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.5.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p4.5.m1.1c">r_{r}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p4.5.m1.1d">italic_r start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> represents the embedding of the <math alttext="r" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p4.6.m2.1"><semantics id="S4.SS2.SSS0.Px2.p4.6.m2.1a"><mi id="S4.SS2.SSS0.Px2.p4.6.m2.1.1" xref="S4.SS2.SSS0.Px2.p4.6.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p4.6.m2.1b"><ci id="S4.SS2.SSS0.Px2.p4.6.m2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.6.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p4.6.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p4.6.m2.1d">italic_r</annotation></semantics></math>-th relation, and <math alttext="(v_{i},r_{r},v_{j})" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p4.7.m3.3"><semantics id="S4.SS2.SSS0.Px2.p4.7.m3.3a"><mrow id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.4.cmml"><mo id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.4" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.4.cmml">(</mo><msub id="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1.2" xref="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1.2.cmml">v</mi><mi id="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.5" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.4.cmml">,</mo><msub id="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2" xref="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2.cmml"><mi id="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2.2" xref="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2.2.cmml">r</mi><mi id="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2.3" xref="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2.3.cmml">r</mi></msub><mo id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.6" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.4.cmml">,</mo><msub id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3.cmml"><mi id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3.2" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3.2.cmml">v</mi><mi id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3.3" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3.3.cmml">j</mi></msub><mo id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.7" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p4.7.m3.3b"><vector id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.4.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3"><apply id="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1.2">𝑣</ci><ci id="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2.2">𝑟</ci><ci id="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2.3.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.2.2.2.2.3">𝑟</ci></apply><apply id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3.1.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3.2.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3.2">𝑣</ci><ci id="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3.3.cmml" xref="S4.SS2.SSS0.Px2.p4.7.m3.3.3.3.3.3">𝑗</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p4.7.m3.3c">(v_{i},r_{r},v_{j})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p4.7.m3.3d">( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> is in <math alttext="\mathcal{N}_{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p4.8.m4.1"><semantics id="S4.SS2.SSS0.Px2.p4.8.m4.1a"><msub id="S4.SS2.SSS0.Px2.p4.8.m4.1.1" xref="S4.SS2.SSS0.Px2.p4.8.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px2.p4.8.m4.1.1.2" xref="S4.SS2.SSS0.Px2.p4.8.m4.1.1.2.cmml">𝒩</mi><mi id="S4.SS2.SSS0.Px2.p4.8.m4.1.1.3" xref="S4.SS2.SSS0.Px2.p4.8.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p4.8.m4.1b"><apply id="S4.SS2.SSS0.Px2.p4.8.m4.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.8.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.8.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.8.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.8.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.8.m4.1.1.2">𝒩</ci><ci id="S4.SS2.SSS0.Px2.p4.8.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p4.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p4.8.m4.1c">\mathcal{N}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p4.8.m4.1d">caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="\text{joint}_{i}^{(l)}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p4.9.m5.1"><semantics id="S4.SS2.SSS0.Px2.p4.9.m5.1a"><msubsup id="S4.SS2.SSS0.Px2.p4.9.m5.1.2" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2.cmml"><mtext id="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.2" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.2a.cmml">joint</mtext><mi id="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.3" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.3.cmml">i</mi><mrow id="S4.SS2.SSS0.Px2.p4.9.m5.1.1.1.3" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2.cmml"><mo id="S4.SS2.SSS0.Px2.p4.9.m5.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px2.p4.9.m5.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px2.p4.9.m5.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p4.9.m5.1b"><apply id="S4.SS2.SSS0.Px2.p4.9.m5.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.9.m5.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2">superscript</csymbol><apply id="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.2a.cmml" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.2"><mtext id="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.2">joint</mtext></ci><ci id="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.2.2.3">𝑖</ci></apply><ci id="S4.SS2.SSS0.Px2.p4.9.m5.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.9.m5.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p4.9.m5.1c">\text{joint}_{i}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p4.9.m5.1d">joint start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> represents the joint feature of the head entity and relation, and similarly, <math alttext="\text{joint}_{j}^{(l)}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p4.10.m6.1"><semantics id="S4.SS2.SSS0.Px2.p4.10.m6.1a"><msubsup id="S4.SS2.SSS0.Px2.p4.10.m6.1.2" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2.cmml"><mtext id="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.2" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.2a.cmml">joint</mtext><mi id="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.3" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.3.cmml">j</mi><mrow id="S4.SS2.SSS0.Px2.p4.10.m6.1.1.1.3" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2.cmml"><mo id="S4.SS2.SSS0.Px2.p4.10.m6.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px2.p4.10.m6.1.1.1.1" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px2.p4.10.m6.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p4.10.m6.1b"><apply id="S4.SS2.SSS0.Px2.p4.10.m6.1.2.cmml" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.10.m6.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2">superscript</csymbol><apply id="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.2a.cmml" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.2"><mtext id="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.2">joint</mtext></ci><ci id="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.2.2.3">𝑗</ci></apply><ci id="S4.SS2.SSS0.Px2.p4.10.m6.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p4.10.m6.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p4.10.m6.1c">\text{joint}_{j}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p4.10.m6.1d">joint start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> corresponds to the joint feature of the tail entity and relation.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p5">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p5.3">The parameter matrices shared by all relations project the joint features to the query and key vectors. This process can make the information in each dimension of the joint features interact. The attention score will be calculated as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q_{(r)i}^{(l)}=\text{joint}_{i}^{(l)}\textbf{W}_{(r)q}^{(l)},k_{(r)j}^{(l)}=%
\text{joint}_{j}^{(l)}\mathbf{W}_{(r)k}^{(l)}" class="ltx_Math" display="block" id="S4.E10.m1.12"><semantics id="S4.E10.m1.12a"><mrow id="S4.E10.m1.12.12.2" xref="S4.E10.m1.12.12.3.cmml"><mrow id="S4.E10.m1.11.11.1.1" xref="S4.E10.m1.11.11.1.1.cmml"><msubsup id="S4.E10.m1.11.11.1.1.2" xref="S4.E10.m1.11.11.1.1.2.cmml"><mi id="S4.E10.m1.11.11.1.1.2.2.2" xref="S4.E10.m1.11.11.1.1.2.2.2.cmml">q</mi><mrow id="S4.E10.m1.1.1.1" xref="S4.E10.m1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.cmml"><mo id="S4.E10.m1.1.1.1.3.2.1" stretchy="false" xref="S4.E10.m1.1.1.1.cmml">(</mo><mi id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml">r</mi><mo id="S4.E10.m1.1.1.1.3.2.2" stretchy="false" xref="S4.E10.m1.1.1.1.cmml">)</mo></mrow><mo id="S4.E10.m1.1.1.1.2" xref="S4.E10.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.E10.m1.1.1.1.4" xref="S4.E10.m1.1.1.1.4.cmml">i</mi></mrow><mrow id="S4.E10.m1.2.2.1.3" xref="S4.E10.m1.11.11.1.1.2.cmml"><mo id="S4.E10.m1.2.2.1.3.1" stretchy="false" xref="S4.E10.m1.11.11.1.1.2.cmml">(</mo><mi id="S4.E10.m1.2.2.1.1" xref="S4.E10.m1.2.2.1.1.cmml">l</mi><mo id="S4.E10.m1.2.2.1.3.2" stretchy="false" xref="S4.E10.m1.11.11.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.E10.m1.11.11.1.1.1" xref="S4.E10.m1.11.11.1.1.1.cmml">=</mo><mrow id="S4.E10.m1.11.11.1.1.3" xref="S4.E10.m1.11.11.1.1.3.cmml"><msubsup id="S4.E10.m1.11.11.1.1.3.2" xref="S4.E10.m1.11.11.1.1.3.2.cmml"><mtext id="S4.E10.m1.11.11.1.1.3.2.2.2" xref="S4.E10.m1.11.11.1.1.3.2.2.2a.cmml">joint</mtext><mi id="S4.E10.m1.11.11.1.1.3.2.2.3" xref="S4.E10.m1.11.11.1.1.3.2.2.3.cmml">i</mi><mrow id="S4.E10.m1.3.3.1.3" xref="S4.E10.m1.11.11.1.1.3.2.cmml"><mo id="S4.E10.m1.3.3.1.3.1" stretchy="false" xref="S4.E10.m1.11.11.1.1.3.2.cmml">(</mo><mi id="S4.E10.m1.3.3.1.1" xref="S4.E10.m1.3.3.1.1.cmml">l</mi><mo id="S4.E10.m1.3.3.1.3.2" stretchy="false" xref="S4.E10.m1.11.11.1.1.3.2.cmml">)</mo></mrow></msubsup><mo id="S4.E10.m1.11.11.1.1.3.1" xref="S4.E10.m1.11.11.1.1.3.1.cmml">⁢</mo><msubsup id="S4.E10.m1.11.11.1.1.3.3" xref="S4.E10.m1.11.11.1.1.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S4.E10.m1.11.11.1.1.3.3.2.2" xref="S4.E10.m1.11.11.1.1.3.3.2.2a.cmml">W</mtext><mrow id="S4.E10.m1.4.4.1" xref="S4.E10.m1.4.4.1.cmml"><mrow id="S4.E10.m1.4.4.1.3.2" xref="S4.E10.m1.4.4.1.cmml"><mo id="S4.E10.m1.4.4.1.3.2.1" stretchy="false" xref="S4.E10.m1.4.4.1.cmml">(</mo><mi id="S4.E10.m1.4.4.1.1" xref="S4.E10.m1.4.4.1.1.cmml">r</mi><mo id="S4.E10.m1.4.4.1.3.2.2" stretchy="false" xref="S4.E10.m1.4.4.1.cmml">)</mo></mrow><mo id="S4.E10.m1.4.4.1.2" xref="S4.E10.m1.4.4.1.2.cmml">⁢</mo><mi id="S4.E10.m1.4.4.1.4" xref="S4.E10.m1.4.4.1.4.cmml">q</mi></mrow><mrow id="S4.E10.m1.5.5.1.3" xref="S4.E10.m1.11.11.1.1.3.3.cmml"><mo id="S4.E10.m1.5.5.1.3.1" stretchy="false" xref="S4.E10.m1.11.11.1.1.3.3.cmml">(</mo><mi id="S4.E10.m1.5.5.1.1" xref="S4.E10.m1.5.5.1.1.cmml">l</mi><mo id="S4.E10.m1.5.5.1.3.2" stretchy="false" xref="S4.E10.m1.11.11.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S4.E10.m1.12.12.2.3" xref="S4.E10.m1.12.12.3a.cmml">,</mo><mrow id="S4.E10.m1.12.12.2.2" xref="S4.E10.m1.12.12.2.2.cmml"><msubsup id="S4.E10.m1.12.12.2.2.2" xref="S4.E10.m1.12.12.2.2.2.cmml"><mi id="S4.E10.m1.12.12.2.2.2.2.2" xref="S4.E10.m1.12.12.2.2.2.2.2.cmml">k</mi><mrow id="S4.E10.m1.6.6.1" xref="S4.E10.m1.6.6.1.cmml"><mrow id="S4.E10.m1.6.6.1.3.2" xref="S4.E10.m1.6.6.1.cmml"><mo id="S4.E10.m1.6.6.1.3.2.1" stretchy="false" xref="S4.E10.m1.6.6.1.cmml">(</mo><mi id="S4.E10.m1.6.6.1.1" xref="S4.E10.m1.6.6.1.1.cmml">r</mi><mo id="S4.E10.m1.6.6.1.3.2.2" stretchy="false" xref="S4.E10.m1.6.6.1.cmml">)</mo></mrow><mo id="S4.E10.m1.6.6.1.2" xref="S4.E10.m1.6.6.1.2.cmml">⁢</mo><mi id="S4.E10.m1.6.6.1.4" xref="S4.E10.m1.6.6.1.4.cmml">j</mi></mrow><mrow id="S4.E10.m1.7.7.1.3" xref="S4.E10.m1.12.12.2.2.2.cmml"><mo id="S4.E10.m1.7.7.1.3.1" stretchy="false" xref="S4.E10.m1.12.12.2.2.2.cmml">(</mo><mi id="S4.E10.m1.7.7.1.1" xref="S4.E10.m1.7.7.1.1.cmml">l</mi><mo id="S4.E10.m1.7.7.1.3.2" stretchy="false" xref="S4.E10.m1.12.12.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.E10.m1.12.12.2.2.1" xref="S4.E10.m1.12.12.2.2.1.cmml">=</mo><mrow id="S4.E10.m1.12.12.2.2.3" xref="S4.E10.m1.12.12.2.2.3.cmml"><msubsup id="S4.E10.m1.12.12.2.2.3.2" xref="S4.E10.m1.12.12.2.2.3.2.cmml"><mtext id="S4.E10.m1.12.12.2.2.3.2.2.2" xref="S4.E10.m1.12.12.2.2.3.2.2.2a.cmml">joint</mtext><mi id="S4.E10.m1.12.12.2.2.3.2.2.3" xref="S4.E10.m1.12.12.2.2.3.2.2.3.cmml">j</mi><mrow id="S4.E10.m1.8.8.1.3" xref="S4.E10.m1.12.12.2.2.3.2.cmml"><mo id="S4.E10.m1.8.8.1.3.1" stretchy="false" xref="S4.E10.m1.12.12.2.2.3.2.cmml">(</mo><mi id="S4.E10.m1.8.8.1.1" xref="S4.E10.m1.8.8.1.1.cmml">l</mi><mo id="S4.E10.m1.8.8.1.3.2" stretchy="false" xref="S4.E10.m1.12.12.2.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S4.E10.m1.12.12.2.2.3.1" xref="S4.E10.m1.12.12.2.2.3.1.cmml">⁢</mo><msubsup id="S4.E10.m1.12.12.2.2.3.3" xref="S4.E10.m1.12.12.2.2.3.3.cmml"><mi id="S4.E10.m1.12.12.2.2.3.3.2.2" xref="S4.E10.m1.12.12.2.2.3.3.2.2.cmml">𝐖</mi><mrow id="S4.E10.m1.9.9.1" xref="S4.E10.m1.9.9.1.cmml"><mrow id="S4.E10.m1.9.9.1.3.2" xref="S4.E10.m1.9.9.1.cmml"><mo id="S4.E10.m1.9.9.1.3.2.1" stretchy="false" xref="S4.E10.m1.9.9.1.cmml">(</mo><mi id="S4.E10.m1.9.9.1.1" xref="S4.E10.m1.9.9.1.1.cmml">r</mi><mo id="S4.E10.m1.9.9.1.3.2.2" stretchy="false" xref="S4.E10.m1.9.9.1.cmml">)</mo></mrow><mo id="S4.E10.m1.9.9.1.2" xref="S4.E10.m1.9.9.1.2.cmml">⁢</mo><mi id="S4.E10.m1.9.9.1.4" xref="S4.E10.m1.9.9.1.4.cmml">k</mi></mrow><mrow id="S4.E10.m1.10.10.1.3" xref="S4.E10.m1.12.12.2.2.3.3.cmml"><mo id="S4.E10.m1.10.10.1.3.1" stretchy="false" xref="S4.E10.m1.12.12.2.2.3.3.cmml">(</mo><mi id="S4.E10.m1.10.10.1.1" xref="S4.E10.m1.10.10.1.1.cmml">l</mi><mo id="S4.E10.m1.10.10.1.3.2" stretchy="false" xref="S4.E10.m1.12.12.2.2.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.12b"><apply id="S4.E10.m1.12.12.3.cmml" xref="S4.E10.m1.12.12.2"><csymbol cd="ambiguous" id="S4.E10.m1.12.12.3a.cmml" xref="S4.E10.m1.12.12.2.3">formulae-sequence</csymbol><apply id="S4.E10.m1.11.11.1.1.cmml" xref="S4.E10.m1.11.11.1.1"><eq id="S4.E10.m1.11.11.1.1.1.cmml" xref="S4.E10.m1.11.11.1.1.1"></eq><apply id="S4.E10.m1.11.11.1.1.2.cmml" xref="S4.E10.m1.11.11.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.1.1.2.1.cmml" xref="S4.E10.m1.11.11.1.1.2">superscript</csymbol><apply id="S4.E10.m1.11.11.1.1.2.2.cmml" xref="S4.E10.m1.11.11.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.1.1.2.2.1.cmml" xref="S4.E10.m1.11.11.1.1.2">subscript</csymbol><ci id="S4.E10.m1.11.11.1.1.2.2.2.cmml" xref="S4.E10.m1.11.11.1.1.2.2.2">𝑞</ci><apply id="S4.E10.m1.1.1.1.cmml" xref="S4.E10.m1.1.1.1"><times id="S4.E10.m1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.2"></times><ci id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1">𝑟</ci><ci id="S4.E10.m1.1.1.1.4.cmml" xref="S4.E10.m1.1.1.1.4">𝑖</ci></apply></apply><ci id="S4.E10.m1.2.2.1.1.cmml" xref="S4.E10.m1.2.2.1.1">𝑙</ci></apply><apply id="S4.E10.m1.11.11.1.1.3.cmml" xref="S4.E10.m1.11.11.1.1.3"><times id="S4.E10.m1.11.11.1.1.3.1.cmml" xref="S4.E10.m1.11.11.1.1.3.1"></times><apply id="S4.E10.m1.11.11.1.1.3.2.cmml" xref="S4.E10.m1.11.11.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.1.1.3.2.1.cmml" xref="S4.E10.m1.11.11.1.1.3.2">superscript</csymbol><apply id="S4.E10.m1.11.11.1.1.3.2.2.cmml" xref="S4.E10.m1.11.11.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.1.1.3.2.2.1.cmml" xref="S4.E10.m1.11.11.1.1.3.2">subscript</csymbol><ci id="S4.E10.m1.11.11.1.1.3.2.2.2a.cmml" xref="S4.E10.m1.11.11.1.1.3.2.2.2"><mtext id="S4.E10.m1.11.11.1.1.3.2.2.2.cmml" xref="S4.E10.m1.11.11.1.1.3.2.2.2">joint</mtext></ci><ci id="S4.E10.m1.11.11.1.1.3.2.2.3.cmml" xref="S4.E10.m1.11.11.1.1.3.2.2.3">𝑖</ci></apply><ci id="S4.E10.m1.3.3.1.1.cmml" xref="S4.E10.m1.3.3.1.1">𝑙</ci></apply><apply id="S4.E10.m1.11.11.1.1.3.3.cmml" xref="S4.E10.m1.11.11.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.1.1.3.3.1.cmml" xref="S4.E10.m1.11.11.1.1.3.3">superscript</csymbol><apply id="S4.E10.m1.11.11.1.1.3.3.2.cmml" xref="S4.E10.m1.11.11.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.11.11.1.1.3.3.2.1.cmml" xref="S4.E10.m1.11.11.1.1.3.3">subscript</csymbol><ci id="S4.E10.m1.11.11.1.1.3.3.2.2a.cmml" xref="S4.E10.m1.11.11.1.1.3.3.2.2"><mtext class="ltx_mathvariant_bold" id="S4.E10.m1.11.11.1.1.3.3.2.2.cmml" xref="S4.E10.m1.11.11.1.1.3.3.2.2">W</mtext></ci><apply id="S4.E10.m1.4.4.1.cmml" xref="S4.E10.m1.4.4.1"><times id="S4.E10.m1.4.4.1.2.cmml" xref="S4.E10.m1.4.4.1.2"></times><ci id="S4.E10.m1.4.4.1.1.cmml" xref="S4.E10.m1.4.4.1.1">𝑟</ci><ci id="S4.E10.m1.4.4.1.4.cmml" xref="S4.E10.m1.4.4.1.4">𝑞</ci></apply></apply><ci id="S4.E10.m1.5.5.1.1.cmml" xref="S4.E10.m1.5.5.1.1">𝑙</ci></apply></apply></apply><apply id="S4.E10.m1.12.12.2.2.cmml" xref="S4.E10.m1.12.12.2.2"><eq id="S4.E10.m1.12.12.2.2.1.cmml" xref="S4.E10.m1.12.12.2.2.1"></eq><apply id="S4.E10.m1.12.12.2.2.2.cmml" xref="S4.E10.m1.12.12.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.12.12.2.2.2.1.cmml" xref="S4.E10.m1.12.12.2.2.2">superscript</csymbol><apply id="S4.E10.m1.12.12.2.2.2.2.cmml" xref="S4.E10.m1.12.12.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.12.12.2.2.2.2.1.cmml" xref="S4.E10.m1.12.12.2.2.2">subscript</csymbol><ci id="S4.E10.m1.12.12.2.2.2.2.2.cmml" xref="S4.E10.m1.12.12.2.2.2.2.2">𝑘</ci><apply id="S4.E10.m1.6.6.1.cmml" xref="S4.E10.m1.6.6.1"><times id="S4.E10.m1.6.6.1.2.cmml" xref="S4.E10.m1.6.6.1.2"></times><ci id="S4.E10.m1.6.6.1.1.cmml" xref="S4.E10.m1.6.6.1.1">𝑟</ci><ci id="S4.E10.m1.6.6.1.4.cmml" xref="S4.E10.m1.6.6.1.4">𝑗</ci></apply></apply><ci id="S4.E10.m1.7.7.1.1.cmml" xref="S4.E10.m1.7.7.1.1">𝑙</ci></apply><apply id="S4.E10.m1.12.12.2.2.3.cmml" xref="S4.E10.m1.12.12.2.2.3"><times id="S4.E10.m1.12.12.2.2.3.1.cmml" xref="S4.E10.m1.12.12.2.2.3.1"></times><apply id="S4.E10.m1.12.12.2.2.3.2.cmml" xref="S4.E10.m1.12.12.2.2.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.12.12.2.2.3.2.1.cmml" xref="S4.E10.m1.12.12.2.2.3.2">superscript</csymbol><apply id="S4.E10.m1.12.12.2.2.3.2.2.cmml" xref="S4.E10.m1.12.12.2.2.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.12.12.2.2.3.2.2.1.cmml" xref="S4.E10.m1.12.12.2.2.3.2">subscript</csymbol><ci id="S4.E10.m1.12.12.2.2.3.2.2.2a.cmml" xref="S4.E10.m1.12.12.2.2.3.2.2.2"><mtext id="S4.E10.m1.12.12.2.2.3.2.2.2.cmml" xref="S4.E10.m1.12.12.2.2.3.2.2.2">joint</mtext></ci><ci id="S4.E10.m1.12.12.2.2.3.2.2.3.cmml" xref="S4.E10.m1.12.12.2.2.3.2.2.3">𝑗</ci></apply><ci id="S4.E10.m1.8.8.1.1.cmml" xref="S4.E10.m1.8.8.1.1">𝑙</ci></apply><apply id="S4.E10.m1.12.12.2.2.3.3.cmml" xref="S4.E10.m1.12.12.2.2.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.12.12.2.2.3.3.1.cmml" xref="S4.E10.m1.12.12.2.2.3.3">superscript</csymbol><apply id="S4.E10.m1.12.12.2.2.3.3.2.cmml" xref="S4.E10.m1.12.12.2.2.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.12.12.2.2.3.3.2.1.cmml" xref="S4.E10.m1.12.12.2.2.3.3">subscript</csymbol><ci id="S4.E10.m1.12.12.2.2.3.3.2.2.cmml" xref="S4.E10.m1.12.12.2.2.3.3.2.2">𝐖</ci><apply id="S4.E10.m1.9.9.1.cmml" xref="S4.E10.m1.9.9.1"><times id="S4.E10.m1.9.9.1.2.cmml" xref="S4.E10.m1.9.9.1.2"></times><ci id="S4.E10.m1.9.9.1.1.cmml" xref="S4.E10.m1.9.9.1.1">𝑟</ci><ci id="S4.E10.m1.9.9.1.4.cmml" xref="S4.E10.m1.9.9.1.4">𝑘</ci></apply></apply><ci id="S4.E10.m1.10.10.1.1.cmml" xref="S4.E10.m1.10.10.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.12c">q_{(r)i}^{(l)}=\text{joint}_{i}^{(l)}\textbf{W}_{(r)q}^{(l)},k_{(r)j}^{(l)}=%
\text{joint}_{j}^{(l)}\mathbf{W}_{(r)k}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.12d">italic_q start_POSTSUBSCRIPT ( italic_r ) italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = joint start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT W start_POSTSUBSCRIPT ( italic_r ) italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , italic_k start_POSTSUBSCRIPT ( italic_r ) italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = joint start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT bold_W start_POSTSUBSCRIPT ( italic_r ) italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{att}^{(l)}_{(r)ij}=f(q_{(r)i}^{(l)},k_{(r)r}^{(l)})" class="ltx_Math" display="block" id="S4.E11.m1.8"><semantics id="S4.E11.m1.8a"><mrow id="S4.E11.m1.8.8" xref="S4.E11.m1.8.8.cmml"><msubsup id="S4.E11.m1.8.8.4" xref="S4.E11.m1.8.8.4.cmml"><mtext id="S4.E11.m1.8.8.4.2.2" xref="S4.E11.m1.8.8.4.2.2a.cmml">att</mtext><mrow id="S4.E11.m1.2.2.1" xref="S4.E11.m1.2.2.1.cmml"><mrow id="S4.E11.m1.2.2.1.3.2" xref="S4.E11.m1.2.2.1.cmml"><mo id="S4.E11.m1.2.2.1.3.2.1" stretchy="false" xref="S4.E11.m1.2.2.1.cmml">(</mo><mi id="S4.E11.m1.2.2.1.1" xref="S4.E11.m1.2.2.1.1.cmml">r</mi><mo id="S4.E11.m1.2.2.1.3.2.2" stretchy="false" xref="S4.E11.m1.2.2.1.cmml">)</mo></mrow><mo id="S4.E11.m1.2.2.1.2" xref="S4.E11.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E11.m1.2.2.1.4" xref="S4.E11.m1.2.2.1.4.cmml">i</mi><mo id="S4.E11.m1.2.2.1.2a" xref="S4.E11.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E11.m1.2.2.1.5" xref="S4.E11.m1.2.2.1.5.cmml">j</mi></mrow><mrow id="S4.E11.m1.1.1.1.3" xref="S4.E11.m1.8.8.4.cmml"><mo id="S4.E11.m1.1.1.1.3.1" stretchy="false" xref="S4.E11.m1.8.8.4.cmml">(</mo><mi id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml">l</mi><mo id="S4.E11.m1.1.1.1.3.2" stretchy="false" xref="S4.E11.m1.8.8.4.cmml">)</mo></mrow></msubsup><mo id="S4.E11.m1.8.8.3" xref="S4.E11.m1.8.8.3.cmml">=</mo><mrow id="S4.E11.m1.8.8.2" xref="S4.E11.m1.8.8.2.cmml"><mi id="S4.E11.m1.8.8.2.4" xref="S4.E11.m1.8.8.2.4.cmml">f</mi><mo id="S4.E11.m1.8.8.2.3" xref="S4.E11.m1.8.8.2.3.cmml">⁢</mo><mrow id="S4.E11.m1.8.8.2.2.2" xref="S4.E11.m1.8.8.2.2.3.cmml"><mo id="S4.E11.m1.8.8.2.2.2.3" stretchy="false" xref="S4.E11.m1.8.8.2.2.3.cmml">(</mo><msubsup id="S4.E11.m1.7.7.1.1.1.1" xref="S4.E11.m1.7.7.1.1.1.1.cmml"><mi id="S4.E11.m1.7.7.1.1.1.1.2.2" xref="S4.E11.m1.7.7.1.1.1.1.2.2.cmml">q</mi><mrow id="S4.E11.m1.3.3.1" xref="S4.E11.m1.3.3.1.cmml"><mrow id="S4.E11.m1.3.3.1.3.2" xref="S4.E11.m1.3.3.1.cmml"><mo id="S4.E11.m1.3.3.1.3.2.1" stretchy="false" xref="S4.E11.m1.3.3.1.cmml">(</mo><mi id="S4.E11.m1.3.3.1.1" xref="S4.E11.m1.3.3.1.1.cmml">r</mi><mo id="S4.E11.m1.3.3.1.3.2.2" stretchy="false" xref="S4.E11.m1.3.3.1.cmml">)</mo></mrow><mo id="S4.E11.m1.3.3.1.2" xref="S4.E11.m1.3.3.1.2.cmml">⁢</mo><mi id="S4.E11.m1.3.3.1.4" xref="S4.E11.m1.3.3.1.4.cmml">i</mi></mrow><mrow id="S4.E11.m1.4.4.1.3" xref="S4.E11.m1.7.7.1.1.1.1.cmml"><mo id="S4.E11.m1.4.4.1.3.1" stretchy="false" xref="S4.E11.m1.7.7.1.1.1.1.cmml">(</mo><mi id="S4.E11.m1.4.4.1.1" xref="S4.E11.m1.4.4.1.1.cmml">l</mi><mo id="S4.E11.m1.4.4.1.3.2" stretchy="false" xref="S4.E11.m1.7.7.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E11.m1.8.8.2.2.2.4" xref="S4.E11.m1.8.8.2.2.3.cmml">,</mo><msubsup id="S4.E11.m1.8.8.2.2.2.2" xref="S4.E11.m1.8.8.2.2.2.2.cmml"><mi id="S4.E11.m1.8.8.2.2.2.2.2.2" xref="S4.E11.m1.8.8.2.2.2.2.2.2.cmml">k</mi><mrow id="S4.E11.m1.5.5.1" xref="S4.E11.m1.5.5.1.cmml"><mrow id="S4.E11.m1.5.5.1.3.2" xref="S4.E11.m1.5.5.1.cmml"><mo id="S4.E11.m1.5.5.1.3.2.1" stretchy="false" xref="S4.E11.m1.5.5.1.cmml">(</mo><mi id="S4.E11.m1.5.5.1.1" xref="S4.E11.m1.5.5.1.1.cmml">r</mi><mo id="S4.E11.m1.5.5.1.3.2.2" stretchy="false" xref="S4.E11.m1.5.5.1.cmml">)</mo></mrow><mo id="S4.E11.m1.5.5.1.2" xref="S4.E11.m1.5.5.1.2.cmml">⁢</mo><mi id="S4.E11.m1.5.5.1.4" xref="S4.E11.m1.5.5.1.4.cmml">r</mi></mrow><mrow id="S4.E11.m1.6.6.1.3" xref="S4.E11.m1.8.8.2.2.2.2.cmml"><mo id="S4.E11.m1.6.6.1.3.1" stretchy="false" xref="S4.E11.m1.8.8.2.2.2.2.cmml">(</mo><mi id="S4.E11.m1.6.6.1.1" xref="S4.E11.m1.6.6.1.1.cmml">l</mi><mo id="S4.E11.m1.6.6.1.3.2" stretchy="false" xref="S4.E11.m1.8.8.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.E11.m1.8.8.2.2.2.5" stretchy="false" xref="S4.E11.m1.8.8.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.8b"><apply id="S4.E11.m1.8.8.cmml" xref="S4.E11.m1.8.8"><eq id="S4.E11.m1.8.8.3.cmml" xref="S4.E11.m1.8.8.3"></eq><apply id="S4.E11.m1.8.8.4.cmml" xref="S4.E11.m1.8.8.4"><csymbol cd="ambiguous" id="S4.E11.m1.8.8.4.1.cmml" xref="S4.E11.m1.8.8.4">subscript</csymbol><apply id="S4.E11.m1.8.8.4.2.cmml" xref="S4.E11.m1.8.8.4"><csymbol cd="ambiguous" id="S4.E11.m1.8.8.4.2.1.cmml" xref="S4.E11.m1.8.8.4">superscript</csymbol><ci id="S4.E11.m1.8.8.4.2.2a.cmml" xref="S4.E11.m1.8.8.4.2.2"><mtext id="S4.E11.m1.8.8.4.2.2.cmml" xref="S4.E11.m1.8.8.4.2.2">att</mtext></ci><ci id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E11.m1.2.2.1.cmml" xref="S4.E11.m1.2.2.1"><times id="S4.E11.m1.2.2.1.2.cmml" xref="S4.E11.m1.2.2.1.2"></times><ci id="S4.E11.m1.2.2.1.1.cmml" xref="S4.E11.m1.2.2.1.1">𝑟</ci><ci id="S4.E11.m1.2.2.1.4.cmml" xref="S4.E11.m1.2.2.1.4">𝑖</ci><ci id="S4.E11.m1.2.2.1.5.cmml" xref="S4.E11.m1.2.2.1.5">𝑗</ci></apply></apply><apply id="S4.E11.m1.8.8.2.cmml" xref="S4.E11.m1.8.8.2"><times id="S4.E11.m1.8.8.2.3.cmml" xref="S4.E11.m1.8.8.2.3"></times><ci id="S4.E11.m1.8.8.2.4.cmml" xref="S4.E11.m1.8.8.2.4">𝑓</ci><interval closure="open" id="S4.E11.m1.8.8.2.2.3.cmml" xref="S4.E11.m1.8.8.2.2.2"><apply id="S4.E11.m1.7.7.1.1.1.1.cmml" xref="S4.E11.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.7.7.1.1.1.1.1.cmml" xref="S4.E11.m1.7.7.1.1.1.1">superscript</csymbol><apply id="S4.E11.m1.7.7.1.1.1.1.2.cmml" xref="S4.E11.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.7.7.1.1.1.1.2.1.cmml" xref="S4.E11.m1.7.7.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.7.7.1.1.1.1.2.2.cmml" xref="S4.E11.m1.7.7.1.1.1.1.2.2">𝑞</ci><apply id="S4.E11.m1.3.3.1.cmml" xref="S4.E11.m1.3.3.1"><times id="S4.E11.m1.3.3.1.2.cmml" xref="S4.E11.m1.3.3.1.2"></times><ci id="S4.E11.m1.3.3.1.1.cmml" xref="S4.E11.m1.3.3.1.1">𝑟</ci><ci id="S4.E11.m1.3.3.1.4.cmml" xref="S4.E11.m1.3.3.1.4">𝑖</ci></apply></apply><ci id="S4.E11.m1.4.4.1.1.cmml" xref="S4.E11.m1.4.4.1.1">𝑙</ci></apply><apply id="S4.E11.m1.8.8.2.2.2.2.cmml" xref="S4.E11.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.8.8.2.2.2.2.1.cmml" xref="S4.E11.m1.8.8.2.2.2.2">superscript</csymbol><apply id="S4.E11.m1.8.8.2.2.2.2.2.cmml" xref="S4.E11.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.8.8.2.2.2.2.2.1.cmml" xref="S4.E11.m1.8.8.2.2.2.2">subscript</csymbol><ci id="S4.E11.m1.8.8.2.2.2.2.2.2.cmml" xref="S4.E11.m1.8.8.2.2.2.2.2.2">𝑘</ci><apply id="S4.E11.m1.5.5.1.cmml" xref="S4.E11.m1.5.5.1"><times id="S4.E11.m1.5.5.1.2.cmml" xref="S4.E11.m1.5.5.1.2"></times><ci id="S4.E11.m1.5.5.1.1.cmml" xref="S4.E11.m1.5.5.1.1">𝑟</ci><ci id="S4.E11.m1.5.5.1.4.cmml" xref="S4.E11.m1.5.5.1.4">𝑟</ci></apply></apply><ci id="S4.E11.m1.6.6.1.1.cmml" xref="S4.E11.m1.6.6.1.1">𝑙</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.8c">\text{att}^{(l)}_{(r)ij}=f(q_{(r)i}^{(l)},k_{(r)r}^{(l)})</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.8d">att start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i italic_j end_POSTSUBSCRIPT = italic_f ( italic_q start_POSTSUBSCRIPT ( italic_r ) italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , italic_k start_POSTSUBSCRIPT ( italic_r ) italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p5.2">where <math alttext="\mathbf{W}_{(r)q}^{(l)},\mathbf{W}_{(r)k}^{(l)}\in\mathbb{R}^{D_{h}^{(l-1)}%
\times d_{k}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p5.1.m1.7"><semantics id="S4.SS2.SSS0.Px2.p5.1.m1.7a"><mrow id="S4.SS2.SSS0.Px2.p5.1.m1.7.7" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.cmml"><mrow id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.3.cmml"><msubsup id="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1" xref="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.2.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.2.2.cmml">𝐖</mi><mrow id="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1" xref="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.cmml"><mrow id="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.3.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.1.cmml">r</mi><mo id="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.4" xref="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.4.cmml">q</mi></mrow><mrow id="S4.SS2.SSS0.Px2.p5.1.m1.2.2.1.3" xref="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px2.p5.1.m1.2.2.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px2.p5.1.m1.2.2.1.1" xref="S4.SS2.SSS0.Px2.p5.1.m1.2.2.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px2.p5.1.m1.2.2.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.3" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.3.cmml">,</mo><msubsup id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.cmml"><mi id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.2.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.2.2.cmml">𝐖</mi><mrow id="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1" xref="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.cmml"><mrow id="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.3.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.cmml"><mo id="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.1" xref="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.1.cmml">r</mi><mo id="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.4" xref="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.4.cmml">k</mi></mrow><mrow id="S4.SS2.SSS0.Px2.p5.1.m1.4.4.1.3" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.cmml"><mo id="S4.SS2.SSS0.Px2.p5.1.m1.4.4.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px2.p5.1.m1.4.4.1.1" xref="S4.SS2.SSS0.Px2.p5.1.m1.4.4.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px2.p5.1.m1.4.4.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.3" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.3.cmml">∈</mo><msup id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.4" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.4.cmml"><mi id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.4.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.4.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.cmml"><msubsup id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.2.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.2.2.cmml">D</mi><mi id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.2.3" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.2.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.2" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.2.cmml">×</mo><msub id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4.cmml"><mi id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4.2" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4.2.cmml">d</mi><mi id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4.3" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p5.1.m1.7b"><apply id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7"><in id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.3.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.3"></in><list id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.3.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2"><apply id="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1">superscript</csymbol><apply id="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.6.6.1.1.1.2.2">𝐖</ci><apply id="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1"><times id="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.2"></times><ci id="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.1">𝑟</ci><ci id="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.4.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.1.1.1.4">𝑞</ci></apply></apply><ci id="S4.SS2.SSS0.Px2.p5.1.m1.2.2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.2.2.1.1">𝑙</ci></apply><apply id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2">superscript</csymbol><apply id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.2.2.2.2.2">𝐖</ci><apply id="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1"><times id="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.2"></times><ci id="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.1">𝑟</ci><ci id="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.4.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.3.3.1.4">𝑘</ci></apply></apply><ci id="S4.SS2.SSS0.Px2.p5.1.m1.4.4.1.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.4.4.1.1">𝑙</ci></apply></list><apply id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.4.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.4.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.4">superscript</csymbol><ci id="S4.SS2.SSS0.Px2.p5.1.m1.7.7.4.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.7.7.4.2">ℝ</ci><apply id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1"><times id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.2"></times><apply id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3">superscript</csymbol><apply id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.2.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.2.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.2.2">𝐷</ci><ci id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.2.3.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.3.2.3">ℎ</ci></apply><apply id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1"><minus id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4.1.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4.2.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4.2">𝑑</ci><ci id="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4.3.cmml" xref="S4.SS2.SSS0.Px2.p5.1.m1.5.5.1.4.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p5.1.m1.7c">\mathbf{W}_{(r)q}^{(l)},\mathbf{W}_{(r)k}^{(l)}\in\mathbb{R}^{D_{h}^{(l-1)}%
\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p5.1.m1.7d">bold_W start_POSTSUBSCRIPT ( italic_r ) italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , bold_W start_POSTSUBSCRIPT ( italic_r ) italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are learnable projection matrices shared by all relations. <math alttext="f(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p5.2.m2.1"><semantics id="S4.SS2.SSS0.Px2.p5.2.m2.1a"><mrow id="S4.SS2.SSS0.Px2.p5.2.m2.1.2" xref="S4.SS2.SSS0.Px2.p5.2.m2.1.2.cmml"><mi id="S4.SS2.SSS0.Px2.p5.2.m2.1.2.2" xref="S4.SS2.SSS0.Px2.p5.2.m2.1.2.2.cmml">f</mi><mo id="S4.SS2.SSS0.Px2.p5.2.m2.1.2.1" xref="S4.SS2.SSS0.Px2.p5.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px2.p5.2.m2.1.2.3.2" xref="S4.SS2.SSS0.Px2.p5.2.m2.1.2.cmml"><mo id="S4.SS2.SSS0.Px2.p5.2.m2.1.2.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.2.m2.1.2.cmml">(</mo><mo id="S4.SS2.SSS0.Px2.p5.2.m2.1.1" lspace="0em" rspace="0em" xref="S4.SS2.SSS0.Px2.p5.2.m2.1.1.cmml">⋅</mo><mo id="S4.SS2.SSS0.Px2.p5.2.m2.1.2.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p5.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p5.2.m2.1b"><apply id="S4.SS2.SSS0.Px2.p5.2.m2.1.2.cmml" xref="S4.SS2.SSS0.Px2.p5.2.m2.1.2"><times id="S4.SS2.SSS0.Px2.p5.2.m2.1.2.1.cmml" xref="S4.SS2.SSS0.Px2.p5.2.m2.1.2.1"></times><ci id="S4.SS2.SSS0.Px2.p5.2.m2.1.2.2.cmml" xref="S4.SS2.SSS0.Px2.p5.2.m2.1.2.2">𝑓</ci><ci id="S4.SS2.SSS0.Px2.p5.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p5.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p5.2.m2.1c">f(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p5.2.m2.1d">italic_f ( ⋅ )</annotation></semantics></math> is a fully connected layer with an output dimension of 1.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p6">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p6.2">In order to make the attention scores more comparable, a softmax operation will be performed,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E12">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E12X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha^{(l)}_{(r)ij}" class="ltx_Math" display="inline" id="S4.E12X.2.1.1.m1.2"><semantics id="S4.E12X.2.1.1.m1.2a"><msubsup id="S4.E12X.2.1.1.m1.2.3" xref="S4.E12X.2.1.1.m1.2.3.cmml"><mi id="S4.E12X.2.1.1.m1.2.3.2.2" xref="S4.E12X.2.1.1.m1.2.3.2.2.cmml">α</mi><mrow id="S4.E12X.2.1.1.m1.2.2.1" xref="S4.E12X.2.1.1.m1.2.2.1.cmml"><mrow id="S4.E12X.2.1.1.m1.2.2.1.3.2" xref="S4.E12X.2.1.1.m1.2.2.1.cmml"><mo id="S4.E12X.2.1.1.m1.2.2.1.3.2.1" stretchy="false" xref="S4.E12X.2.1.1.m1.2.2.1.cmml">(</mo><mi id="S4.E12X.2.1.1.m1.2.2.1.1" xref="S4.E12X.2.1.1.m1.2.2.1.1.cmml">r</mi><mo id="S4.E12X.2.1.1.m1.2.2.1.3.2.2" stretchy="false" xref="S4.E12X.2.1.1.m1.2.2.1.cmml">)</mo></mrow><mo id="S4.E12X.2.1.1.m1.2.2.1.2" xref="S4.E12X.2.1.1.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E12X.2.1.1.m1.2.2.1.4" xref="S4.E12X.2.1.1.m1.2.2.1.4.cmml">i</mi><mo id="S4.E12X.2.1.1.m1.2.2.1.2a" xref="S4.E12X.2.1.1.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E12X.2.1.1.m1.2.2.1.5" xref="S4.E12X.2.1.1.m1.2.2.1.5.cmml">j</mi></mrow><mrow id="S4.E12X.2.1.1.m1.1.1.1.3" xref="S4.E12X.2.1.1.m1.2.3.cmml"><mo id="S4.E12X.2.1.1.m1.1.1.1.3.1" stretchy="false" xref="S4.E12X.2.1.1.m1.2.3.cmml">(</mo><mi id="S4.E12X.2.1.1.m1.1.1.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.cmml">l</mi><mo id="S4.E12X.2.1.1.m1.1.1.1.3.2" stretchy="false" xref="S4.E12X.2.1.1.m1.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.E12X.2.1.1.m1.2b"><apply id="S4.E12X.2.1.1.m1.2.3.cmml" xref="S4.E12X.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.2.3.1.cmml" xref="S4.E12X.2.1.1.m1.2.3">subscript</csymbol><apply id="S4.E12X.2.1.1.m1.2.3.2.cmml" xref="S4.E12X.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.2.3.2.1.cmml" xref="S4.E12X.2.1.1.m1.2.3">superscript</csymbol><ci id="S4.E12X.2.1.1.m1.2.3.2.2.cmml" xref="S4.E12X.2.1.1.m1.2.3.2.2">𝛼</ci><ci id="S4.E12X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E12X.2.1.1.m1.2.2.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1"><times id="S4.E12X.2.1.1.m1.2.2.1.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.2"></times><ci id="S4.E12X.2.1.1.m1.2.2.1.1.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.1">𝑟</ci><ci id="S4.E12X.2.1.1.m1.2.2.1.4.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.4">𝑖</ci><ci id="S4.E12X.2.1.1.m1.2.2.1.5.cmml" xref="S4.E12X.2.1.1.m1.2.2.1.5">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12X.2.1.1.m1.2c">\displaystyle\alpha^{(l)}_{(r)ij}</annotation><annotation encoding="application/x-llamapun" id="S4.E12X.2.1.1.m1.2d">italic_α start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{softmax}_{j}(att^{(l)}_{(r)ij})" class="ltx_Math" display="inline" id="S4.E12X.3.2.2.m1.3"><semantics id="S4.E12X.3.2.2.m1.3a"><mrow id="S4.E12X.3.2.2.m1.3.3" xref="S4.E12X.3.2.2.m1.3.3.cmml"><mi id="S4.E12X.3.2.2.m1.3.3.3" xref="S4.E12X.3.2.2.m1.3.3.3.cmml"></mi><mo id="S4.E12X.3.2.2.m1.3.3.2" xref="S4.E12X.3.2.2.m1.3.3.2.cmml">=</mo><mrow id="S4.E12X.3.2.2.m1.3.3.1" xref="S4.E12X.3.2.2.m1.3.3.1.cmml"><msub id="S4.E12X.3.2.2.m1.3.3.1.3" xref="S4.E12X.3.2.2.m1.3.3.1.3.cmml"><mtext id="S4.E12X.3.2.2.m1.3.3.1.3.2" xref="S4.E12X.3.2.2.m1.3.3.1.3.2a.cmml">softmax</mtext><mi id="S4.E12X.3.2.2.m1.3.3.1.3.3" xref="S4.E12X.3.2.2.m1.3.3.1.3.3.cmml">j</mi></msub><mo id="S4.E12X.3.2.2.m1.3.3.1.2" xref="S4.E12X.3.2.2.m1.3.3.1.2.cmml">⁢</mo><mrow id="S4.E12X.3.2.2.m1.3.3.1.1.1" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.cmml"><mo id="S4.E12X.3.2.2.m1.3.3.1.1.1.2" stretchy="false" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.E12X.3.2.2.m1.3.3.1.1.1.1" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.cmml"><mi id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.2" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.2.cmml">a</mi><mo id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.1" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.3" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.3.cmml">t</mi><mo id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.1a" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><msubsup id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.cmml"><mi id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.2.2" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.2.2.cmml">t</mi><mrow id="S4.E12X.3.2.2.m1.2.2.1" xref="S4.E12X.3.2.2.m1.2.2.1.cmml"><mrow id="S4.E12X.3.2.2.m1.2.2.1.3.2" xref="S4.E12X.3.2.2.m1.2.2.1.cmml"><mo id="S4.E12X.3.2.2.m1.2.2.1.3.2.1" stretchy="false" xref="S4.E12X.3.2.2.m1.2.2.1.cmml">(</mo><mi id="S4.E12X.3.2.2.m1.2.2.1.1" xref="S4.E12X.3.2.2.m1.2.2.1.1.cmml">r</mi><mo id="S4.E12X.3.2.2.m1.2.2.1.3.2.2" stretchy="false" xref="S4.E12X.3.2.2.m1.2.2.1.cmml">)</mo></mrow><mo id="S4.E12X.3.2.2.m1.2.2.1.2" xref="S4.E12X.3.2.2.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E12X.3.2.2.m1.2.2.1.4" xref="S4.E12X.3.2.2.m1.2.2.1.4.cmml">i</mi><mo id="S4.E12X.3.2.2.m1.2.2.1.2a" xref="S4.E12X.3.2.2.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E12X.3.2.2.m1.2.2.1.5" xref="S4.E12X.3.2.2.m1.2.2.1.5.cmml">j</mi></mrow><mrow id="S4.E12X.3.2.2.m1.1.1.1.3" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.cmml"><mo id="S4.E12X.3.2.2.m1.1.1.1.3.1" stretchy="false" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.cmml">(</mo><mi id="S4.E12X.3.2.2.m1.1.1.1.1" xref="S4.E12X.3.2.2.m1.1.1.1.1.cmml">l</mi><mo id="S4.E12X.3.2.2.m1.1.1.1.3.2" stretchy="false" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E12X.3.2.2.m1.3.3.1.1.1.3" stretchy="false" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E12X.3.2.2.m1.3b"><apply id="S4.E12X.3.2.2.m1.3.3.cmml" xref="S4.E12X.3.2.2.m1.3.3"><eq id="S4.E12X.3.2.2.m1.3.3.2.cmml" xref="S4.E12X.3.2.2.m1.3.3.2"></eq><csymbol cd="latexml" id="S4.E12X.3.2.2.m1.3.3.3.cmml" xref="S4.E12X.3.2.2.m1.3.3.3">absent</csymbol><apply id="S4.E12X.3.2.2.m1.3.3.1.cmml" xref="S4.E12X.3.2.2.m1.3.3.1"><times id="S4.E12X.3.2.2.m1.3.3.1.2.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.2"></times><apply id="S4.E12X.3.2.2.m1.3.3.1.3.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.3"><csymbol cd="ambiguous" id="S4.E12X.3.2.2.m1.3.3.1.3.1.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.3">subscript</csymbol><ci id="S4.E12X.3.2.2.m1.3.3.1.3.2a.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.3.2"><mtext id="S4.E12X.3.2.2.m1.3.3.1.3.2.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.3.2">softmax</mtext></ci><ci id="S4.E12X.3.2.2.m1.3.3.1.3.3.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.3.3">𝑗</ci></apply><apply id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.1.1"><times id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.1"></times><ci id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.2">𝑎</ci><ci id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.3.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.3">𝑡</ci><apply id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.1.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4">subscript</csymbol><apply id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.2.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.2.1.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4">superscript</csymbol><ci id="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.2.2.cmml" xref="S4.E12X.3.2.2.m1.3.3.1.1.1.1.4.2.2">𝑡</ci><ci id="S4.E12X.3.2.2.m1.1.1.1.1.cmml" xref="S4.E12X.3.2.2.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E12X.3.2.2.m1.2.2.1.cmml" xref="S4.E12X.3.2.2.m1.2.2.1"><times id="S4.E12X.3.2.2.m1.2.2.1.2.cmml" xref="S4.E12X.3.2.2.m1.2.2.1.2"></times><ci id="S4.E12X.3.2.2.m1.2.2.1.1.cmml" xref="S4.E12X.3.2.2.m1.2.2.1.1">𝑟</ci><ci id="S4.E12X.3.2.2.m1.2.2.1.4.cmml" xref="S4.E12X.3.2.2.m1.2.2.1.4">𝑖</ci><ci id="S4.E12X.3.2.2.m1.2.2.1.5.cmml" xref="S4.E12X.3.2.2.m1.2.2.1.5">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12X.3.2.2.m1.3c">\displaystyle=\text{softmax}_{j}(att^{(l)}_{(r)ij})</annotation><annotation encoding="application/x-llamapun" id="S4.E12X.3.2.2.m1.3d">= softmax start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_a italic_t italic_t start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i italic_j end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E12Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\exp(\text{att}^{(l)}_{(r)ij})}{\sum_{(v_{i},r_{r},v_{k})%
\in\mathcal{N}_{i}}\exp(\text{att}^{(l)}_{(r)ik})}" class="ltx_Math" display="inline" id="S4.E12Xa.2.1.1.m1.11"><semantics id="S4.E12Xa.2.1.1.m1.11a"><mrow id="S4.E12Xa.2.1.1.m1.11.12" xref="S4.E12Xa.2.1.1.m1.11.12.cmml"><mi id="S4.E12Xa.2.1.1.m1.11.12.2" xref="S4.E12Xa.2.1.1.m1.11.12.2.cmml"></mi><mo id="S4.E12Xa.2.1.1.m1.11.12.1" xref="S4.E12Xa.2.1.1.m1.11.12.1.cmml">=</mo><mstyle displaystyle="true" id="S4.E12Xa.2.1.1.m1.11.11" xref="S4.E12Xa.2.1.1.m1.11.11.cmml"><mfrac id="S4.E12Xa.2.1.1.m1.11.11a" xref="S4.E12Xa.2.1.1.m1.11.11.cmml"><mrow id="S4.E12Xa.2.1.1.m1.4.4.4.4" xref="S4.E12Xa.2.1.1.m1.4.4.4.5.cmml"><mi id="S4.E12Xa.2.1.1.m1.3.3.3.3" xref="S4.E12Xa.2.1.1.m1.3.3.3.3.cmml">exp</mi><mo id="S4.E12Xa.2.1.1.m1.4.4.4.4a" xref="S4.E12Xa.2.1.1.m1.4.4.4.5.cmml">⁡</mo><mrow id="S4.E12Xa.2.1.1.m1.4.4.4.4.1" xref="S4.E12Xa.2.1.1.m1.4.4.4.5.cmml"><mo id="S4.E12Xa.2.1.1.m1.4.4.4.4.1.2" stretchy="false" xref="S4.E12Xa.2.1.1.m1.4.4.4.5.cmml">(</mo><msubsup id="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1" xref="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.cmml"><mtext id="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.2.2" xref="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.2.2a.cmml">att</mtext><mrow id="S4.E12Xa.2.1.1.m1.2.2.2.2.1" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.cmml"><mrow id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.3.2" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.cmml"><mo id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.3.2.1" stretchy="false" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.cmml">(</mo><mi id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.1" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.1.cmml">r</mi><mo id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.3.2.2" stretchy="false" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.cmml">)</mo></mrow><mo id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.2" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.4" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.4.cmml">i</mi><mo id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.2a" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.5" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.5.cmml">j</mi></mrow><mrow id="S4.E12Xa.2.1.1.m1.1.1.1.1.1.3" xref="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.cmml"><mo id="S4.E12Xa.2.1.1.m1.1.1.1.1.1.3.1" stretchy="false" xref="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.cmml">(</mo><mi id="S4.E12Xa.2.1.1.m1.1.1.1.1.1.1" xref="S4.E12Xa.2.1.1.m1.1.1.1.1.1.1.cmml">l</mi><mo id="S4.E12Xa.2.1.1.m1.1.1.1.1.1.3.2" stretchy="false" xref="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E12Xa.2.1.1.m1.4.4.4.4.1.3" stretchy="false" xref="S4.E12Xa.2.1.1.m1.4.4.4.5.cmml">)</mo></mrow></mrow><mrow id="S4.E12Xa.2.1.1.m1.11.11.11" xref="S4.E12Xa.2.1.1.m1.11.11.11.cmml"><msub id="S4.E12Xa.2.1.1.m1.11.11.11.8" xref="S4.E12Xa.2.1.1.m1.11.11.11.8.cmml"><mo id="S4.E12Xa.2.1.1.m1.11.11.11.8.2" xref="S4.E12Xa.2.1.1.m1.11.11.11.8.2.cmml">∑</mo><mrow id="S4.E12Xa.2.1.1.m1.7.7.7.3.3" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.cmml"><mrow id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.4.cmml"><mo id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.4" stretchy="false" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.4.cmml">(</mo><msub id="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1" xref="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1.cmml"><mi id="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1.2" xref="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1.2.cmml">v</mi><mi id="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1.3" xref="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.5" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.4.cmml">,</mo><msub id="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2" xref="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2.cmml"><mi id="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2.2" xref="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2.2.cmml">r</mi><mi id="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2.3" xref="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2.3.cmml">r</mi></msub><mo id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.6" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.4.cmml">,</mo><msub id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3.cmml"><mi id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3.2" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3.2.cmml">v</mi><mi id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3.3" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3.3.cmml">k</mi></msub><mo id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.7" stretchy="false" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.4.cmml">)</mo></mrow><mo id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.4" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.4.cmml">∈</mo><msub id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5.2" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5.2.cmml">𝒩</mi><mi id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5.3" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5.3.cmml">i</mi></msub></mrow></msub><mrow id="S4.E12Xa.2.1.1.m1.11.11.11.7.1" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.2.cmml"><mi id="S4.E12Xa.2.1.1.m1.10.10.10.6" xref="S4.E12Xa.2.1.1.m1.10.10.10.6.cmml">exp</mi><mo id="S4.E12Xa.2.1.1.m1.11.11.11.7.1a" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.2.cmml">⁡</mo><mrow id="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.2.cmml"><mo id="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.2" stretchy="false" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.2.cmml">(</mo><msubsup id="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.cmml"><mtext id="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.2.2" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.2.2a.cmml">att</mtext><mrow id="S4.E12Xa.2.1.1.m1.9.9.9.5.1" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.cmml"><mrow id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.3.2" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.cmml"><mo id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.3.2.1" stretchy="false" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.cmml">(</mo><mi id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.1" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.1.cmml">r</mi><mo id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.3.2.2" stretchy="false" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.cmml">)</mo></mrow><mo id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.2" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.2.cmml">⁢</mo><mi id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.4" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.4.cmml">i</mi><mo id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.2a" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.2.cmml">⁢</mo><mi id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.5" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.5.cmml">k</mi></mrow><mrow id="S4.E12Xa.2.1.1.m1.8.8.8.4.1.3" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.cmml"><mo id="S4.E12Xa.2.1.1.m1.8.8.8.4.1.3.1" stretchy="false" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.cmml">(</mo><mi id="S4.E12Xa.2.1.1.m1.8.8.8.4.1.1" xref="S4.E12Xa.2.1.1.m1.8.8.8.4.1.1.cmml">l</mi><mo id="S4.E12Xa.2.1.1.m1.8.8.8.4.1.3.2" stretchy="false" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.3" stretchy="false" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.E12Xa.2.1.1.m1.11b"><apply id="S4.E12Xa.2.1.1.m1.11.12.cmml" xref="S4.E12Xa.2.1.1.m1.11.12"><eq id="S4.E12Xa.2.1.1.m1.11.12.1.cmml" xref="S4.E12Xa.2.1.1.m1.11.12.1"></eq><csymbol cd="latexml" id="S4.E12Xa.2.1.1.m1.11.12.2.cmml" xref="S4.E12Xa.2.1.1.m1.11.12.2">absent</csymbol><apply id="S4.E12Xa.2.1.1.m1.11.11.cmml" xref="S4.E12Xa.2.1.1.m1.11.11"><divide id="S4.E12Xa.2.1.1.m1.11.11.12.cmml" xref="S4.E12Xa.2.1.1.m1.11.11"></divide><apply id="S4.E12Xa.2.1.1.m1.4.4.4.5.cmml" xref="S4.E12Xa.2.1.1.m1.4.4.4.4"><exp id="S4.E12Xa.2.1.1.m1.3.3.3.3.cmml" xref="S4.E12Xa.2.1.1.m1.3.3.3.3"></exp><apply id="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.cmml" xref="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.1.cmml" xref="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1">subscript</csymbol><apply id="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.2.cmml" xref="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.2.1.cmml" xref="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1">superscript</csymbol><ci id="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.2.2a.cmml" xref="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.2.2"><mtext id="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.2.2.cmml" xref="S4.E12Xa.2.1.1.m1.4.4.4.4.1.1.2.2">att</mtext></ci><ci id="S4.E12Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E12Xa.2.1.1.m1.1.1.1.1.1.1">𝑙</ci></apply><apply id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.cmml" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1"><times id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.2.cmml" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.2"></times><ci id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.1">𝑟</ci><ci id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.4.cmml" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.4">𝑖</ci><ci id="S4.E12Xa.2.1.1.m1.2.2.2.2.1.5.cmml" xref="S4.E12Xa.2.1.1.m1.2.2.2.2.1.5">𝑗</ci></apply></apply></apply><apply id="S4.E12Xa.2.1.1.m1.11.11.11.cmml" xref="S4.E12Xa.2.1.1.m1.11.11.11"><apply id="S4.E12Xa.2.1.1.m1.11.11.11.8.cmml" xref="S4.E12Xa.2.1.1.m1.11.11.11.8"><csymbol cd="ambiguous" id="S4.E12Xa.2.1.1.m1.11.11.11.8.1.cmml" xref="S4.E12Xa.2.1.1.m1.11.11.11.8">subscript</csymbol><sum id="S4.E12Xa.2.1.1.m1.11.11.11.8.2.cmml" xref="S4.E12Xa.2.1.1.m1.11.11.11.8.2"></sum><apply id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.cmml" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3"><in id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.4.cmml" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.4"></in><vector id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.4.cmml" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3"><apply id="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1.cmml" xref="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1.1.cmml" xref="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1">subscript</csymbol><ci id="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1.2.cmml" xref="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1.2">𝑣</ci><ci id="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1.3.cmml" xref="S4.E12Xa.2.1.1.m1.5.5.5.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2.cmml" xref="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2.1.cmml" xref="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2">subscript</csymbol><ci id="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2.2.cmml" xref="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2.2">𝑟</ci><ci id="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2.3.cmml" xref="S4.E12Xa.2.1.1.m1.6.6.6.2.2.2.2.2.3">𝑟</ci></apply><apply id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3.cmml" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3.1.cmml" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3">subscript</csymbol><ci id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3.2.cmml" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3.2">𝑣</ci><ci id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3.3.cmml" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.3.3.3.3">𝑘</ci></apply></vector><apply id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5.cmml" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5"><csymbol cd="ambiguous" id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5.1.cmml" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5">subscript</csymbol><ci id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5.2.cmml" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5.2">𝒩</ci><ci id="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5.3.cmml" xref="S4.E12Xa.2.1.1.m1.7.7.7.3.3.5.3">𝑖</ci></apply></apply></apply><apply id="S4.E12Xa.2.1.1.m1.11.11.11.7.2.cmml" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1"><exp id="S4.E12Xa.2.1.1.m1.10.10.10.6.cmml" xref="S4.E12Xa.2.1.1.m1.10.10.10.6"></exp><apply id="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.cmml" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1"><csymbol cd="ambiguous" id="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.1.cmml" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1">subscript</csymbol><apply id="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.2.cmml" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1"><csymbol cd="ambiguous" id="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.2.1.cmml" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1">superscript</csymbol><ci id="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.2.2a.cmml" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.2.2"><mtext id="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.2.2.cmml" xref="S4.E12Xa.2.1.1.m1.11.11.11.7.1.1.1.2.2">att</mtext></ci><ci id="S4.E12Xa.2.1.1.m1.8.8.8.4.1.1.cmml" xref="S4.E12Xa.2.1.1.m1.8.8.8.4.1.1">𝑙</ci></apply><apply id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.cmml" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1"><times id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.2.cmml" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.2"></times><ci id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.1.cmml" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.1">𝑟</ci><ci id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.4.cmml" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.4">𝑖</ci><ci id="S4.E12Xa.2.1.1.m1.9.9.9.5.1.5.cmml" xref="S4.E12Xa.2.1.1.m1.9.9.9.5.1.5">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12Xa.2.1.1.m1.11c">\displaystyle=\frac{\exp(\text{att}^{(l)}_{(r)ij})}{\sum_{(v_{i},r_{r},v_{k})%
\in\mathcal{N}_{i}}\exp(\text{att}^{(l)}_{(r)ik})}</annotation><annotation encoding="application/x-llamapun" id="S4.E12Xa.2.1.1.m1.11d">= divide start_ARG roman_exp ( att start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_exp ( att start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i italic_k end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p6.1">where <math alttext="\alpha^{(l)}_{(r)ij}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p6.1.m1.2"><semantics id="S4.SS2.SSS0.Px2.p6.1.m1.2a"><msubsup id="S4.SS2.SSS0.Px2.p6.1.m1.2.3" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.3.cmml"><mi id="S4.SS2.SSS0.Px2.p6.1.m1.2.3.2.2" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.3.2.2.cmml">α</mi><mrow id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.cmml"><mrow id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.3.2" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.cmml"><mo id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.1" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.1.cmml">r</mi><mo id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.2" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.4" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.4.cmml">i</mi><mo id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.2a" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.5" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.5.cmml">j</mi></mrow><mrow id="S4.SS2.SSS0.Px2.p6.1.m1.1.1.1.3" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.3.cmml"><mo id="S4.SS2.SSS0.Px2.p6.1.m1.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.3.cmml">(</mo><mi id="S4.SS2.SSS0.Px2.p6.1.m1.1.1.1.1" xref="S4.SS2.SSS0.Px2.p6.1.m1.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px2.p6.1.m1.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p6.1.m1.2b"><apply id="S4.SS2.SSS0.Px2.p6.1.m1.2.3.cmml" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p6.1.m1.2.3.1.cmml" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.3">subscript</csymbol><apply id="S4.SS2.SSS0.Px2.p6.1.m1.2.3.2.cmml" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p6.1.m1.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px2.p6.1.m1.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.3.2.2">𝛼</ci><ci id="S4.SS2.SSS0.Px2.p6.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p6.1.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.cmml" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1"><times id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.2.cmml" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.2"></times><ci id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.1">𝑟</ci><ci id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.4.cmml" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.4">𝑖</ci><ci id="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.5.cmml" xref="S4.SS2.SSS0.Px2.p6.1.m1.2.2.1.5">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p6.1.m1.2c">\alpha^{(l)}_{(r)ij}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p6.1.m1.2d">italic_α start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the relation-specific head-to-tail attention score.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Analysis of Model Parameters.</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px3.p1.11"><span class="ltx_text" id="S4.SS2.SSS0.Px3.p1.7.7" style="color:#000000;">The model space complexity of GATH is <math alttext="O(L(N_{e}D+N_{r}D+DF))" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.1.1.m1.1"><semantics id="S4.SS2.SSS0.Px3.p1.1.1.m1.1a"><mrow id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.3.cmml">O</mi><mo id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.3.cmml">L</mi><mo id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2.2" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">N</mi><mi id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">e</mi></msub><mo id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.1" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml">D</mi></mrow><mo id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2.2" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">N</mi><mi id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">r</mi></msub><mo id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.1" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">D</mi></mrow><mo id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.1a" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.2" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.2.cmml">D</mi><mo id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.1" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.3.cmml">F</mi></mrow></mrow><mo id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.1.1.m1.1b"><apply id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1"><times id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.2"></times><ci id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.3">𝑂</ci><apply id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1"><times id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.2"></times><ci id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.3">𝐿</ci><apply id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1"><plus id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2"><times id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2.2">𝑁</ci><ci id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.2.3">𝑒</ci></apply><ci id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.2.3">𝐷</ci></apply><apply id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3"><times id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2.2">𝑁</ci><ci id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.2.3">𝑟</ci></apply><ci id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.3.3">𝐷</ci></apply><apply id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4"><times id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.1"></times><ci id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.2">𝐷</ci><ci id="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.SS2.SSS0.Px3.p1.1.1.m1.1.1.1.1.1.1.1.1.4.3">𝐹</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.1.1.m1.1c">O(L(N_{e}D+N_{r}D+DF))</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.1.1.m1.1d">italic_O ( italic_L ( italic_N start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_D + italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_D + italic_D italic_F ) )</annotation></semantics></math>, while the model space complexity of MRGAT is <math alttext="O(L(N_{e}D+N_{r}DF))" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.2.2.m2.1"><semantics id="S4.SS2.SSS0.Px3.p1.2.2.m2.1a"><mrow id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.3.cmml">O</mi><mo id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.2" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.3.cmml">L</mi><mo id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.2" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2.2" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2.2.cmml">N</mi><mi id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2.3.cmml">e</mi></msub><mo id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.1" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.3.cmml">D</mi></mrow><mo id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.cmml"><msub id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2.2" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2.2.cmml">N</mi><mi id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2.3.cmml">r</mi></msub><mo id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.1" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.3.cmml">D</mi><mo id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.1a" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.4" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.4.cmml">F</mi></mrow></mrow><mo id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.3" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.2.2.m2.1b"><apply id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1"><times id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.2"></times><ci id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.3">𝑂</ci><apply id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1"><times id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.2"></times><ci id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.3">𝐿</ci><apply id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1"><plus id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2"><times id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.1"></times><apply id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2.2">𝑁</ci><ci id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.2.3">𝑒</ci></apply><ci id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.2.3">𝐷</ci></apply><apply id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3"><times id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.1"></times><apply id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2.2">𝑁</ci><ci id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.2.3">𝑟</ci></apply><ci id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.3">𝐷</ci><ci id="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.SS2.SSS0.Px3.p1.2.2.m2.1.1.1.1.1.1.1.1.3.4">𝐹</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.2.2.m2.1c">O(L(N_{e}D+N_{r}DF))</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.2.2.m2.1d">italic_O ( italic_L ( italic_N start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_D + italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT italic_D italic_F ) )</annotation></semantics></math>, where <math alttext="D" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.3.3.m3.1"><semantics id="S4.SS2.SSS0.Px3.p1.3.3.m3.1a"><mi id="S4.SS2.SSS0.Px3.p1.3.3.m3.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.3.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.3.3.m3.1b"><ci id="S4.SS2.SSS0.Px3.p1.3.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.3.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.3.3.m3.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.3.3.m3.1d">italic_D</annotation></semantics></math> represents the embedding dimension. <math alttext="N_{e}=|\mathcal{E}|" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.4.4.m4.1"><semantics id="S4.SS2.SSS0.Px3.p1.4.4.m4.1a"><mrow id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.cmml"><msub id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2.cmml"><mi id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2.2" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2.2.cmml">N</mi><mi id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2.3.cmml">e</mi></msub><mo id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.1.cmml">=</mo><mrow id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.3.2" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.3.1.cmml"><mo id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.3.2.1" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.1.cmml">ℰ</mi><mo id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.3.2.2" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.4.4.m4.1b"><apply id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2"><eq id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.1"></eq><apply id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2.2">𝑁</ci><ci id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.2.3">𝑒</ci></apply><apply id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.3.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.3.2"><abs id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.3.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.2.3.2.1"></abs><ci id="S4.SS2.SSS0.Px3.p1.4.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.4.4.m4.1.1">ℰ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.4.4.m4.1c">N_{e}=|\mathcal{E}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.4.4.m4.1d">italic_N start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT = | caligraphic_E |</annotation></semantics></math> and <math alttext="N_{r}=|\mathcal{R}|" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.5.5.m5.1"><semantics id="S4.SS2.SSS0.Px3.p1.5.5.m5.1a"><mrow id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.cmml"><msub id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2.cmml"><mi id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2.2" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2.2.cmml">N</mi><mi id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2.3" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2.3.cmml">r</mi></msub><mo id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.1.cmml">=</mo><mrow id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.3.2" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.3.1.cmml"><mo id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.3.2.1" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.1.cmml">ℛ</mi><mo id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.3.2.2" mathcolor="#000000" stretchy="false" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.5.5.m5.1b"><apply id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2"><eq id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.1"></eq><apply id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2.2">𝑁</ci><ci id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.2.3">𝑟</ci></apply><apply id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.3.1.cmml" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.3.2"><abs id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.3.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.2.3.2.1"></abs><ci id="S4.SS2.SSS0.Px3.p1.5.5.m5.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.5.5.m5.1.1">ℛ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.5.5.m5.1c">N_{r}=|\mathcal{R}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.5.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT = | caligraphic_R |</annotation></semantics></math> represent the number of entities and relations respectively. <math alttext="F" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.6.6.m6.1"><semantics id="S4.SS2.SSS0.Px3.p1.6.6.m6.1a"><mi id="S4.SS2.SSS0.Px3.p1.6.6.m6.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.6.6.m6.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.6.6.m6.1b"><ci id="S4.SS2.SSS0.Px3.p1.6.6.m6.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.6.6.m6.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.6.6.m6.1c">F</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.6.6.m6.1d">italic_F</annotation></semantics></math> represents the dimension of the query and key vectors. <math alttext="L" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.7.7.m7.1"><semantics id="S4.SS2.SSS0.Px3.p1.7.7.m7.1a"><mi id="S4.SS2.SSS0.Px3.p1.7.7.m7.1.1" mathcolor="#000000" xref="S4.SS2.SSS0.Px3.p1.7.7.m7.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.7.7.m7.1b"><ci id="S4.SS2.SSS0.Px3.p1.7.7.m7.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.7.7.m7.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.7.7.m7.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.7.7.m7.1d">italic_L</annotation></semantics></math> represents the number of encoder layers. It can be seen that reducing features and weight sharing strategies we proposed significantly reduce the space complexity.</span> Specifically,
1) Reduced features: The reduced features are shown in Formula <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4.E9" title="In Entity-Relation Joint Attention Network ‣ 4.2. Encoder ‣ 4. Method ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">9</span></a>. We assume that the relation is a specific representation in a certain scene, which will enhance or weaken the information of different dimensions in the entity embedding. The parameter amount of each relation feature is <math alttext="D" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.8.m1.1"><semantics id="S4.SS2.SSS0.Px3.p1.8.m1.1a"><mi id="S4.SS2.SSS0.Px3.p1.8.m1.1.1" xref="S4.SS2.SSS0.Px3.p1.8.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.8.m1.1b"><ci id="S4.SS2.SSS0.Px3.p1.8.m1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.8.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.8.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.8.m1.1d">italic_D</annotation></semantics></math>.
2) Weight sharing: If a learnable query projection matrix and key projection matrix are generated for each relation, the parameter amount is <math alttext="2nDF" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.9.m2.1"><semantics id="S4.SS2.SSS0.Px3.p1.9.m2.1a"><mrow id="S4.SS2.SSS0.Px3.p1.9.m2.1.1" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.cmml"><mn id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.2" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.2.cmml">2</mn><mo id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.1" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.3" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.3.cmml">n</mi><mo id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.1a" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.4" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.4.cmml">D</mi><mo id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.1b" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.5" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.5.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.9.m2.1b"><apply id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1"><times id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.1"></times><cn id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.2.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.2">2</cn><ci id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.3">𝑛</ci><ci id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.4.cmml" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.4">𝐷</ci><ci id="S4.SS2.SSS0.Px3.p1.9.m2.1.1.5.cmml" xref="S4.SS2.SSS0.Px3.p1.9.m2.1.1.5">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.9.m2.1c">2nDF</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.9.m2.1d">2 italic_n italic_D italic_F</annotation></semantics></math>. Inspired by the feature map sharing convolution kernel in CNN, we make all the relations share the projection matrix, as shown in Formula <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S4.E10" title="In Entity-Relation Joint Attention Network ‣ 4.2. Encoder ‣ 4. Method ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">10</span></a>.
Finally, we reduced the relation features from <math alttext="2nDF" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.10.m3.1"><semantics id="S4.SS2.SSS0.Px3.p1.10.m3.1a"><mrow id="S4.SS2.SSS0.Px3.p1.10.m3.1.1" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.cmml"><mn id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.2" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.2.cmml">2</mn><mo id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.1" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.3" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.3.cmml">n</mi><mo id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.1a" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.4" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.4.cmml">D</mi><mo id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.1b" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.5" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.5.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.10.m3.1b"><apply id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1"><times id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.1"></times><cn id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.2.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.2">2</cn><ci id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.3">𝑛</ci><ci id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.4.cmml" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.4">𝐷</ci><ci id="S4.SS2.SSS0.Px3.p1.10.m3.1.1.5.cmml" xref="S4.SS2.SSS0.Px3.p1.10.m3.1.1.5">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.10.m3.1c">2nDF</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.10.m3.1d">2 italic_n italic_D italic_F</annotation></semantics></math> to <math alttext="nD+2DF" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px3.p1.11.m4.1"><semantics id="S4.SS2.SSS0.Px3.p1.11.m4.1a"><mrow id="S4.SS2.SSS0.Px3.p1.11.m4.1.1" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.cmml"><mrow id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.cmml"><mi id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.2" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.2.cmml">n</mi><mo id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.1" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.3" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.3.cmml">D</mi></mrow><mo id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.1" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.1.cmml">+</mo><mrow id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.cmml"><mn id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.2" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.2.cmml">2</mn><mo id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.1" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.3" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.3.cmml">D</mi><mo id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.1a" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.4" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.4.cmml">F</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px3.p1.11.m4.1b"><apply id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1"><plus id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.1"></plus><apply id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2"><times id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.1.cmml" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.1"></times><ci id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.2.cmml" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.2">𝑛</ci><ci id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.3.cmml" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.2.3">𝐷</ci></apply><apply id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3"><times id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.1"></times><cn id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.2.cmml" type="integer" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.2">2</cn><ci id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.3">𝐷</ci><ci id="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.4.cmml" xref="S4.SS2.SSS0.Px3.p1.11.m4.1.1.3.4">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px3.p1.11.m4.1c">nD+2DF</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px3.p1.11.m4.1d">italic_n italic_D + 2 italic_D italic_F</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Aggregation</h4>
<div class="ltx_para" id="S4.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p1.1">The aggregation module linearly combines the embeddings of the neighbors according to the attention scores calculated above, and then aggregates this information to generate a new embedding for the central node. For node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.1.m1.1"><semantics id="S4.SS2.SSS0.Px4.p1.1.m1.1a"><msub id="S4.SS2.SSS0.Px4.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px4.p1.1.m1.1.1.2" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1.2.cmml">v</mi><mi id="S4.SS2.SSS0.Px4.p1.1.m1.1.1.3" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.1.m1.1b"><apply id="S4.SS2.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px4.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1.2">𝑣</ci><ci id="S4.SS2.SSS0.Px4.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px4.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.1.m1.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, the formula for aggregating neighborhood information is as follows,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S7.EGx1">
<tbody id="S4.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h^{(l)}_{(h)i}" class="ltx_Math" display="inline" id="S4.E13.m1.2"><semantics id="S4.E13.m1.2a"><msubsup id="S4.E13.m1.2.3" xref="S4.E13.m1.2.3.cmml"><mi id="S4.E13.m1.2.3.2.2" xref="S4.E13.m1.2.3.2.2.cmml">h</mi><mrow id="S4.E13.m1.2.2.1" xref="S4.E13.m1.2.2.1.cmml"><mrow id="S4.E13.m1.2.2.1.3.2" xref="S4.E13.m1.2.2.1.cmml"><mo id="S4.E13.m1.2.2.1.3.2.1" stretchy="false" xref="S4.E13.m1.2.2.1.cmml">(</mo><mi id="S4.E13.m1.2.2.1.1" xref="S4.E13.m1.2.2.1.1.cmml">h</mi><mo id="S4.E13.m1.2.2.1.3.2.2" stretchy="false" xref="S4.E13.m1.2.2.1.cmml">)</mo></mrow><mo id="S4.E13.m1.2.2.1.2" xref="S4.E13.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E13.m1.2.2.1.4" xref="S4.E13.m1.2.2.1.4.cmml">i</mi></mrow><mrow id="S4.E13.m1.1.1.1.3" xref="S4.E13.m1.2.3.cmml"><mo id="S4.E13.m1.1.1.1.3.1" stretchy="false" xref="S4.E13.m1.2.3.cmml">(</mo><mi id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml">l</mi><mo id="S4.E13.m1.1.1.1.3.2" stretchy="false" xref="S4.E13.m1.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.E13.m1.2b"><apply id="S4.E13.m1.2.3.cmml" xref="S4.E13.m1.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.2.3.1.cmml" xref="S4.E13.m1.2.3">subscript</csymbol><apply id="S4.E13.m1.2.3.2.cmml" xref="S4.E13.m1.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.2.3.2.1.cmml" xref="S4.E13.m1.2.3">superscript</csymbol><ci id="S4.E13.m1.2.3.2.2.cmml" xref="S4.E13.m1.2.3.2.2">ℎ</ci><ci id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E13.m1.2.2.1.cmml" xref="S4.E13.m1.2.2.1"><times id="S4.E13.m1.2.2.1.2.cmml" xref="S4.E13.m1.2.2.1.2"></times><ci id="S4.E13.m1.2.2.1.1.cmml" xref="S4.E13.m1.2.2.1.1">ℎ</ci><ci id="S4.E13.m1.2.2.1.4.cmml" xref="S4.E13.m1.2.2.1.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.2c">\displaystyle h^{(l)}_{(h)i}</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.2d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{v_{j}\in\mathcal{N}_{i}}\alpha^{(l)}_{(h)ij}h_{j}^{(l-1)}%
\mathbf{W}^{(l)}" class="ltx_Math" display="inline" id="S4.E13.m2.4"><semantics id="S4.E13.m2.4a"><mrow id="S4.E13.m2.4.5" xref="S4.E13.m2.4.5.cmml"><mi id="S4.E13.m2.4.5.2" xref="S4.E13.m2.4.5.2.cmml"></mi><mo id="S4.E13.m2.4.5.1" xref="S4.E13.m2.4.5.1.cmml">=</mo><mrow id="S4.E13.m2.4.5.3" xref="S4.E13.m2.4.5.3.cmml"><mstyle displaystyle="true" id="S4.E13.m2.4.5.3.1" xref="S4.E13.m2.4.5.3.1.cmml"><munder id="S4.E13.m2.4.5.3.1a" xref="S4.E13.m2.4.5.3.1.cmml"><mo id="S4.E13.m2.4.5.3.1.2" movablelimits="false" xref="S4.E13.m2.4.5.3.1.2.cmml">∑</mo><mrow id="S4.E13.m2.4.5.3.1.3" xref="S4.E13.m2.4.5.3.1.3.cmml"><msub id="S4.E13.m2.4.5.3.1.3.2" xref="S4.E13.m2.4.5.3.1.3.2.cmml"><mi id="S4.E13.m2.4.5.3.1.3.2.2" xref="S4.E13.m2.4.5.3.1.3.2.2.cmml">v</mi><mi id="S4.E13.m2.4.5.3.1.3.2.3" xref="S4.E13.m2.4.5.3.1.3.2.3.cmml">j</mi></msub><mo id="S4.E13.m2.4.5.3.1.3.1" xref="S4.E13.m2.4.5.3.1.3.1.cmml">∈</mo><msub id="S4.E13.m2.4.5.3.1.3.3" xref="S4.E13.m2.4.5.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m2.4.5.3.1.3.3.2" xref="S4.E13.m2.4.5.3.1.3.3.2.cmml">𝒩</mi><mi id="S4.E13.m2.4.5.3.1.3.3.3" xref="S4.E13.m2.4.5.3.1.3.3.3.cmml">i</mi></msub></mrow></munder></mstyle><mrow id="S4.E13.m2.4.5.3.2" xref="S4.E13.m2.4.5.3.2.cmml"><msubsup id="S4.E13.m2.4.5.3.2.2" xref="S4.E13.m2.4.5.3.2.2.cmml"><mi id="S4.E13.m2.4.5.3.2.2.2.2" xref="S4.E13.m2.4.5.3.2.2.2.2.cmml">α</mi><mrow id="S4.E13.m2.2.2.1" xref="S4.E13.m2.2.2.1.cmml"><mrow id="S4.E13.m2.2.2.1.3.2" xref="S4.E13.m2.2.2.1.cmml"><mo id="S4.E13.m2.2.2.1.3.2.1" stretchy="false" xref="S4.E13.m2.2.2.1.cmml">(</mo><mi id="S4.E13.m2.2.2.1.1" xref="S4.E13.m2.2.2.1.1.cmml">h</mi><mo id="S4.E13.m2.2.2.1.3.2.2" stretchy="false" xref="S4.E13.m2.2.2.1.cmml">)</mo></mrow><mo id="S4.E13.m2.2.2.1.2" xref="S4.E13.m2.2.2.1.2.cmml">⁢</mo><mi id="S4.E13.m2.2.2.1.4" xref="S4.E13.m2.2.2.1.4.cmml">i</mi><mo id="S4.E13.m2.2.2.1.2a" xref="S4.E13.m2.2.2.1.2.cmml">⁢</mo><mi id="S4.E13.m2.2.2.1.5" xref="S4.E13.m2.2.2.1.5.cmml">j</mi></mrow><mrow id="S4.E13.m2.1.1.1.3" xref="S4.E13.m2.4.5.3.2.2.cmml"><mo id="S4.E13.m2.1.1.1.3.1" stretchy="false" xref="S4.E13.m2.4.5.3.2.2.cmml">(</mo><mi id="S4.E13.m2.1.1.1.1" xref="S4.E13.m2.1.1.1.1.cmml">l</mi><mo id="S4.E13.m2.1.1.1.3.2" stretchy="false" xref="S4.E13.m2.4.5.3.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.E13.m2.4.5.3.2.1" xref="S4.E13.m2.4.5.3.2.1.cmml">⁢</mo><msubsup id="S4.E13.m2.4.5.3.2.3" xref="S4.E13.m2.4.5.3.2.3.cmml"><mi id="S4.E13.m2.4.5.3.2.3.2.2" xref="S4.E13.m2.4.5.3.2.3.2.2.cmml">h</mi><mi id="S4.E13.m2.4.5.3.2.3.2.3" xref="S4.E13.m2.4.5.3.2.3.2.3.cmml">j</mi><mrow id="S4.E13.m2.3.3.1.1" xref="S4.E13.m2.3.3.1.1.1.cmml"><mo id="S4.E13.m2.3.3.1.1.2" stretchy="false" xref="S4.E13.m2.3.3.1.1.1.cmml">(</mo><mrow id="S4.E13.m2.3.3.1.1.1" xref="S4.E13.m2.3.3.1.1.1.cmml"><mi id="S4.E13.m2.3.3.1.1.1.2" xref="S4.E13.m2.3.3.1.1.1.2.cmml">l</mi><mo id="S4.E13.m2.3.3.1.1.1.1" xref="S4.E13.m2.3.3.1.1.1.1.cmml">−</mo><mn id="S4.E13.m2.3.3.1.1.1.3" xref="S4.E13.m2.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E13.m2.3.3.1.1.3" stretchy="false" xref="S4.E13.m2.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E13.m2.4.5.3.2.1a" xref="S4.E13.m2.4.5.3.2.1.cmml">⁢</mo><msup id="S4.E13.m2.4.5.3.2.4" xref="S4.E13.m2.4.5.3.2.4.cmml"><mi id="S4.E13.m2.4.5.3.2.4.2" xref="S4.E13.m2.4.5.3.2.4.2.cmml">𝐖</mi><mrow id="S4.E13.m2.4.4.1.3" xref="S4.E13.m2.4.5.3.2.4.cmml"><mo id="S4.E13.m2.4.4.1.3.1" stretchy="false" xref="S4.E13.m2.4.5.3.2.4.cmml">(</mo><mi id="S4.E13.m2.4.4.1.1" xref="S4.E13.m2.4.4.1.1.cmml">l</mi><mo id="S4.E13.m2.4.4.1.3.2" stretchy="false" xref="S4.E13.m2.4.5.3.2.4.cmml">)</mo></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m2.4b"><apply id="S4.E13.m2.4.5.cmml" xref="S4.E13.m2.4.5"><eq id="S4.E13.m2.4.5.1.cmml" xref="S4.E13.m2.4.5.1"></eq><csymbol cd="latexml" id="S4.E13.m2.4.5.2.cmml" xref="S4.E13.m2.4.5.2">absent</csymbol><apply id="S4.E13.m2.4.5.3.cmml" xref="S4.E13.m2.4.5.3"><apply id="S4.E13.m2.4.5.3.1.cmml" xref="S4.E13.m2.4.5.3.1"><csymbol cd="ambiguous" id="S4.E13.m2.4.5.3.1.1.cmml" xref="S4.E13.m2.4.5.3.1">subscript</csymbol><sum id="S4.E13.m2.4.5.3.1.2.cmml" xref="S4.E13.m2.4.5.3.1.2"></sum><apply id="S4.E13.m2.4.5.3.1.3.cmml" xref="S4.E13.m2.4.5.3.1.3"><in id="S4.E13.m2.4.5.3.1.3.1.cmml" xref="S4.E13.m2.4.5.3.1.3.1"></in><apply id="S4.E13.m2.4.5.3.1.3.2.cmml" xref="S4.E13.m2.4.5.3.1.3.2"><csymbol cd="ambiguous" id="S4.E13.m2.4.5.3.1.3.2.1.cmml" xref="S4.E13.m2.4.5.3.1.3.2">subscript</csymbol><ci id="S4.E13.m2.4.5.3.1.3.2.2.cmml" xref="S4.E13.m2.4.5.3.1.3.2.2">𝑣</ci><ci id="S4.E13.m2.4.5.3.1.3.2.3.cmml" xref="S4.E13.m2.4.5.3.1.3.2.3">𝑗</ci></apply><apply id="S4.E13.m2.4.5.3.1.3.3.cmml" xref="S4.E13.m2.4.5.3.1.3.3"><csymbol cd="ambiguous" id="S4.E13.m2.4.5.3.1.3.3.1.cmml" xref="S4.E13.m2.4.5.3.1.3.3">subscript</csymbol><ci id="S4.E13.m2.4.5.3.1.3.3.2.cmml" xref="S4.E13.m2.4.5.3.1.3.3.2">𝒩</ci><ci id="S4.E13.m2.4.5.3.1.3.3.3.cmml" xref="S4.E13.m2.4.5.3.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S4.E13.m2.4.5.3.2.cmml" xref="S4.E13.m2.4.5.3.2"><times id="S4.E13.m2.4.5.3.2.1.cmml" xref="S4.E13.m2.4.5.3.2.1"></times><apply id="S4.E13.m2.4.5.3.2.2.cmml" xref="S4.E13.m2.4.5.3.2.2"><csymbol cd="ambiguous" id="S4.E13.m2.4.5.3.2.2.1.cmml" xref="S4.E13.m2.4.5.3.2.2">subscript</csymbol><apply id="S4.E13.m2.4.5.3.2.2.2.cmml" xref="S4.E13.m2.4.5.3.2.2"><csymbol cd="ambiguous" id="S4.E13.m2.4.5.3.2.2.2.1.cmml" xref="S4.E13.m2.4.5.3.2.2">superscript</csymbol><ci id="S4.E13.m2.4.5.3.2.2.2.2.cmml" xref="S4.E13.m2.4.5.3.2.2.2.2">𝛼</ci><ci id="S4.E13.m2.1.1.1.1.cmml" xref="S4.E13.m2.1.1.1.1">𝑙</ci></apply><apply id="S4.E13.m2.2.2.1.cmml" xref="S4.E13.m2.2.2.1"><times id="S4.E13.m2.2.2.1.2.cmml" xref="S4.E13.m2.2.2.1.2"></times><ci id="S4.E13.m2.2.2.1.1.cmml" xref="S4.E13.m2.2.2.1.1">ℎ</ci><ci id="S4.E13.m2.2.2.1.4.cmml" xref="S4.E13.m2.2.2.1.4">𝑖</ci><ci id="S4.E13.m2.2.2.1.5.cmml" xref="S4.E13.m2.2.2.1.5">𝑗</ci></apply></apply><apply id="S4.E13.m2.4.5.3.2.3.cmml" xref="S4.E13.m2.4.5.3.2.3"><csymbol cd="ambiguous" id="S4.E13.m2.4.5.3.2.3.1.cmml" xref="S4.E13.m2.4.5.3.2.3">superscript</csymbol><apply id="S4.E13.m2.4.5.3.2.3.2.cmml" xref="S4.E13.m2.4.5.3.2.3"><csymbol cd="ambiguous" id="S4.E13.m2.4.5.3.2.3.2.1.cmml" xref="S4.E13.m2.4.5.3.2.3">subscript</csymbol><ci id="S4.E13.m2.4.5.3.2.3.2.2.cmml" xref="S4.E13.m2.4.5.3.2.3.2.2">ℎ</ci><ci id="S4.E13.m2.4.5.3.2.3.2.3.cmml" xref="S4.E13.m2.4.5.3.2.3.2.3">𝑗</ci></apply><apply id="S4.E13.m2.3.3.1.1.1.cmml" xref="S4.E13.m2.3.3.1.1"><minus id="S4.E13.m2.3.3.1.1.1.1.cmml" xref="S4.E13.m2.3.3.1.1.1.1"></minus><ci id="S4.E13.m2.3.3.1.1.1.2.cmml" xref="S4.E13.m2.3.3.1.1.1.2">𝑙</ci><cn id="S4.E13.m2.3.3.1.1.1.3.cmml" type="integer" xref="S4.E13.m2.3.3.1.1.1.3">1</cn></apply></apply><apply id="S4.E13.m2.4.5.3.2.4.cmml" xref="S4.E13.m2.4.5.3.2.4"><csymbol cd="ambiguous" id="S4.E13.m2.4.5.3.2.4.1.cmml" xref="S4.E13.m2.4.5.3.2.4">superscript</csymbol><ci id="S4.E13.m2.4.5.3.2.4.2.cmml" xref="S4.E13.m2.4.5.3.2.4.2">𝐖</ci><ci id="S4.E13.m2.4.4.1.1.cmml" xref="S4.E13.m2.4.4.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m2.4c">\displaystyle=\sum_{v_{j}\in\mathcal{N}_{i}}\alpha^{(l)}_{(h)ij}h_{j}^{(l-1)}%
\mathbf{W}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m2.4d">= ∑ start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_α start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i italic_j end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h^{(l)}_{(r)i}" class="ltx_Math" display="inline" id="S4.E14.m1.2"><semantics id="S4.E14.m1.2a"><msubsup id="S4.E14.m1.2.3" xref="S4.E14.m1.2.3.cmml"><mi id="S4.E14.m1.2.3.2.2" xref="S4.E14.m1.2.3.2.2.cmml">h</mi><mrow id="S4.E14.m1.2.2.1" xref="S4.E14.m1.2.2.1.cmml"><mrow id="S4.E14.m1.2.2.1.3.2" xref="S4.E14.m1.2.2.1.cmml"><mo id="S4.E14.m1.2.2.1.3.2.1" stretchy="false" xref="S4.E14.m1.2.2.1.cmml">(</mo><mi id="S4.E14.m1.2.2.1.1" xref="S4.E14.m1.2.2.1.1.cmml">r</mi><mo id="S4.E14.m1.2.2.1.3.2.2" stretchy="false" xref="S4.E14.m1.2.2.1.cmml">)</mo></mrow><mo id="S4.E14.m1.2.2.1.2" xref="S4.E14.m1.2.2.1.2.cmml">⁢</mo><mi id="S4.E14.m1.2.2.1.4" xref="S4.E14.m1.2.2.1.4.cmml">i</mi></mrow><mrow id="S4.E14.m1.1.1.1.3" xref="S4.E14.m1.2.3.cmml"><mo id="S4.E14.m1.1.1.1.3.1" stretchy="false" xref="S4.E14.m1.2.3.cmml">(</mo><mi id="S4.E14.m1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml">l</mi><mo id="S4.E14.m1.1.1.1.3.2" stretchy="false" xref="S4.E14.m1.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.E14.m1.2b"><apply id="S4.E14.m1.2.3.cmml" xref="S4.E14.m1.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.2.3.1.cmml" xref="S4.E14.m1.2.3">subscript</csymbol><apply id="S4.E14.m1.2.3.2.cmml" xref="S4.E14.m1.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.2.3.2.1.cmml" xref="S4.E14.m1.2.3">superscript</csymbol><ci id="S4.E14.m1.2.3.2.2.cmml" xref="S4.E14.m1.2.3.2.2">ℎ</ci><ci id="S4.E14.m1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E14.m1.2.2.1.cmml" xref="S4.E14.m1.2.2.1"><times id="S4.E14.m1.2.2.1.2.cmml" xref="S4.E14.m1.2.2.1.2"></times><ci id="S4.E14.m1.2.2.1.1.cmml" xref="S4.E14.m1.2.2.1.1">𝑟</ci><ci id="S4.E14.m1.2.2.1.4.cmml" xref="S4.E14.m1.2.2.1.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.2c">\displaystyle h^{(l)}_{(r)i}</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.2d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{(v_{i},r_{r},v_{j})\in\mathcal{N}_{i}}\alpha^{(l)}_{(r)ij}%
h_{j}^{(l-1)}\mathbf{W}^{(l)}" class="ltx_Math" display="inline" id="S4.E14.m2.7"><semantics id="S4.E14.m2.7a"><mrow id="S4.E14.m2.7.8" xref="S4.E14.m2.7.8.cmml"><mi id="S4.E14.m2.7.8.2" xref="S4.E14.m2.7.8.2.cmml"></mi><mo id="S4.E14.m2.7.8.1" xref="S4.E14.m2.7.8.1.cmml">=</mo><mrow id="S4.E14.m2.7.8.3" xref="S4.E14.m2.7.8.3.cmml"><mstyle displaystyle="true" id="S4.E14.m2.7.8.3.1" xref="S4.E14.m2.7.8.3.1.cmml"><munder id="S4.E14.m2.7.8.3.1a" xref="S4.E14.m2.7.8.3.1.cmml"><mo id="S4.E14.m2.7.8.3.1.2" movablelimits="false" xref="S4.E14.m2.7.8.3.1.2.cmml">∑</mo><mrow id="S4.E14.m2.3.3.3" xref="S4.E14.m2.3.3.3.cmml"><mrow id="S4.E14.m2.3.3.3.3.3" xref="S4.E14.m2.3.3.3.3.4.cmml"><mo id="S4.E14.m2.3.3.3.3.3.4" stretchy="false" xref="S4.E14.m2.3.3.3.3.4.cmml">(</mo><msub id="S4.E14.m2.1.1.1.1.1.1" xref="S4.E14.m2.1.1.1.1.1.1.cmml"><mi id="S4.E14.m2.1.1.1.1.1.1.2" xref="S4.E14.m2.1.1.1.1.1.1.2.cmml">v</mi><mi id="S4.E14.m2.1.1.1.1.1.1.3" xref="S4.E14.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E14.m2.3.3.3.3.3.5" xref="S4.E14.m2.3.3.3.3.4.cmml">,</mo><msub id="S4.E14.m2.2.2.2.2.2.2" xref="S4.E14.m2.2.2.2.2.2.2.cmml"><mi id="S4.E14.m2.2.2.2.2.2.2.2" xref="S4.E14.m2.2.2.2.2.2.2.2.cmml">r</mi><mi id="S4.E14.m2.2.2.2.2.2.2.3" xref="S4.E14.m2.2.2.2.2.2.2.3.cmml">r</mi></msub><mo id="S4.E14.m2.3.3.3.3.3.6" xref="S4.E14.m2.3.3.3.3.4.cmml">,</mo><msub id="S4.E14.m2.3.3.3.3.3.3" xref="S4.E14.m2.3.3.3.3.3.3.cmml"><mi id="S4.E14.m2.3.3.3.3.3.3.2" xref="S4.E14.m2.3.3.3.3.3.3.2.cmml">v</mi><mi id="S4.E14.m2.3.3.3.3.3.3.3" xref="S4.E14.m2.3.3.3.3.3.3.3.cmml">j</mi></msub><mo id="S4.E14.m2.3.3.3.3.3.7" stretchy="false" xref="S4.E14.m2.3.3.3.3.4.cmml">)</mo></mrow><mo id="S4.E14.m2.3.3.3.4" xref="S4.E14.m2.3.3.3.4.cmml">∈</mo><msub id="S4.E14.m2.3.3.3.5" xref="S4.E14.m2.3.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E14.m2.3.3.3.5.2" xref="S4.E14.m2.3.3.3.5.2.cmml">𝒩</mi><mi id="S4.E14.m2.3.3.3.5.3" xref="S4.E14.m2.3.3.3.5.3.cmml">i</mi></msub></mrow></munder></mstyle><mrow id="S4.E14.m2.7.8.3.2" xref="S4.E14.m2.7.8.3.2.cmml"><msubsup id="S4.E14.m2.7.8.3.2.2" xref="S4.E14.m2.7.8.3.2.2.cmml"><mi id="S4.E14.m2.7.8.3.2.2.2.2" xref="S4.E14.m2.7.8.3.2.2.2.2.cmml">α</mi><mrow id="S4.E14.m2.5.5.1" xref="S4.E14.m2.5.5.1.cmml"><mrow id="S4.E14.m2.5.5.1.3.2" xref="S4.E14.m2.5.5.1.cmml"><mo id="S4.E14.m2.5.5.1.3.2.1" stretchy="false" xref="S4.E14.m2.5.5.1.cmml">(</mo><mi id="S4.E14.m2.5.5.1.1" xref="S4.E14.m2.5.5.1.1.cmml">r</mi><mo id="S4.E14.m2.5.5.1.3.2.2" stretchy="false" xref="S4.E14.m2.5.5.1.cmml">)</mo></mrow><mo id="S4.E14.m2.5.5.1.2" xref="S4.E14.m2.5.5.1.2.cmml">⁢</mo><mi id="S4.E14.m2.5.5.1.4" xref="S4.E14.m2.5.5.1.4.cmml">i</mi><mo id="S4.E14.m2.5.5.1.2a" xref="S4.E14.m2.5.5.1.2.cmml">⁢</mo><mi id="S4.E14.m2.5.5.1.5" xref="S4.E14.m2.5.5.1.5.cmml">j</mi></mrow><mrow id="S4.E14.m2.4.4.1.3" xref="S4.E14.m2.7.8.3.2.2.cmml"><mo id="S4.E14.m2.4.4.1.3.1" stretchy="false" xref="S4.E14.m2.7.8.3.2.2.cmml">(</mo><mi id="S4.E14.m2.4.4.1.1" xref="S4.E14.m2.4.4.1.1.cmml">l</mi><mo id="S4.E14.m2.4.4.1.3.2" stretchy="false" xref="S4.E14.m2.7.8.3.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.E14.m2.7.8.3.2.1" xref="S4.E14.m2.7.8.3.2.1.cmml">⁢</mo><msubsup id="S4.E14.m2.7.8.3.2.3" xref="S4.E14.m2.7.8.3.2.3.cmml"><mi id="S4.E14.m2.7.8.3.2.3.2.2" xref="S4.E14.m2.7.8.3.2.3.2.2.cmml">h</mi><mi id="S4.E14.m2.7.8.3.2.3.2.3" xref="S4.E14.m2.7.8.3.2.3.2.3.cmml">j</mi><mrow id="S4.E14.m2.6.6.1.1" xref="S4.E14.m2.6.6.1.1.1.cmml"><mo id="S4.E14.m2.6.6.1.1.2" stretchy="false" xref="S4.E14.m2.6.6.1.1.1.cmml">(</mo><mrow id="S4.E14.m2.6.6.1.1.1" xref="S4.E14.m2.6.6.1.1.1.cmml"><mi id="S4.E14.m2.6.6.1.1.1.2" xref="S4.E14.m2.6.6.1.1.1.2.cmml">l</mi><mo id="S4.E14.m2.6.6.1.1.1.1" xref="S4.E14.m2.6.6.1.1.1.1.cmml">−</mo><mn id="S4.E14.m2.6.6.1.1.1.3" xref="S4.E14.m2.6.6.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E14.m2.6.6.1.1.3" stretchy="false" xref="S4.E14.m2.6.6.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E14.m2.7.8.3.2.1a" xref="S4.E14.m2.7.8.3.2.1.cmml">⁢</mo><msup id="S4.E14.m2.7.8.3.2.4" xref="S4.E14.m2.7.8.3.2.4.cmml"><mi id="S4.E14.m2.7.8.3.2.4.2" xref="S4.E14.m2.7.8.3.2.4.2.cmml">𝐖</mi><mrow id="S4.E14.m2.7.7.1.3" xref="S4.E14.m2.7.8.3.2.4.cmml"><mo id="S4.E14.m2.7.7.1.3.1" stretchy="false" xref="S4.E14.m2.7.8.3.2.4.cmml">(</mo><mi id="S4.E14.m2.7.7.1.1" xref="S4.E14.m2.7.7.1.1.cmml">l</mi><mo id="S4.E14.m2.7.7.1.3.2" stretchy="false" xref="S4.E14.m2.7.8.3.2.4.cmml">)</mo></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m2.7b"><apply id="S4.E14.m2.7.8.cmml" xref="S4.E14.m2.7.8"><eq id="S4.E14.m2.7.8.1.cmml" xref="S4.E14.m2.7.8.1"></eq><csymbol cd="latexml" id="S4.E14.m2.7.8.2.cmml" xref="S4.E14.m2.7.8.2">absent</csymbol><apply id="S4.E14.m2.7.8.3.cmml" xref="S4.E14.m2.7.8.3"><apply id="S4.E14.m2.7.8.3.1.cmml" xref="S4.E14.m2.7.8.3.1"><csymbol cd="ambiguous" id="S4.E14.m2.7.8.3.1.1.cmml" xref="S4.E14.m2.7.8.3.1">subscript</csymbol><sum id="S4.E14.m2.7.8.3.1.2.cmml" xref="S4.E14.m2.7.8.3.1.2"></sum><apply id="S4.E14.m2.3.3.3.cmml" xref="S4.E14.m2.3.3.3"><in id="S4.E14.m2.3.3.3.4.cmml" xref="S4.E14.m2.3.3.3.4"></in><vector id="S4.E14.m2.3.3.3.3.4.cmml" xref="S4.E14.m2.3.3.3.3.3"><apply id="S4.E14.m2.1.1.1.1.1.1.cmml" xref="S4.E14.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m2.1.1.1.1.1.1.1.cmml" xref="S4.E14.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E14.m2.1.1.1.1.1.1.2.cmml" xref="S4.E14.m2.1.1.1.1.1.1.2">𝑣</ci><ci id="S4.E14.m2.1.1.1.1.1.1.3.cmml" xref="S4.E14.m2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E14.m2.2.2.2.2.2.2.cmml" xref="S4.E14.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E14.m2.2.2.2.2.2.2.1.cmml" xref="S4.E14.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E14.m2.2.2.2.2.2.2.2.cmml" xref="S4.E14.m2.2.2.2.2.2.2.2">𝑟</ci><ci id="S4.E14.m2.2.2.2.2.2.2.3.cmml" xref="S4.E14.m2.2.2.2.2.2.2.3">𝑟</ci></apply><apply id="S4.E14.m2.3.3.3.3.3.3.cmml" xref="S4.E14.m2.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E14.m2.3.3.3.3.3.3.1.cmml" xref="S4.E14.m2.3.3.3.3.3.3">subscript</csymbol><ci id="S4.E14.m2.3.3.3.3.3.3.2.cmml" xref="S4.E14.m2.3.3.3.3.3.3.2">𝑣</ci><ci id="S4.E14.m2.3.3.3.3.3.3.3.cmml" xref="S4.E14.m2.3.3.3.3.3.3.3">𝑗</ci></apply></vector><apply id="S4.E14.m2.3.3.3.5.cmml" xref="S4.E14.m2.3.3.3.5"><csymbol cd="ambiguous" id="S4.E14.m2.3.3.3.5.1.cmml" xref="S4.E14.m2.3.3.3.5">subscript</csymbol><ci id="S4.E14.m2.3.3.3.5.2.cmml" xref="S4.E14.m2.3.3.3.5.2">𝒩</ci><ci id="S4.E14.m2.3.3.3.5.3.cmml" xref="S4.E14.m2.3.3.3.5.3">𝑖</ci></apply></apply></apply><apply id="S4.E14.m2.7.8.3.2.cmml" xref="S4.E14.m2.7.8.3.2"><times id="S4.E14.m2.7.8.3.2.1.cmml" xref="S4.E14.m2.7.8.3.2.1"></times><apply id="S4.E14.m2.7.8.3.2.2.cmml" xref="S4.E14.m2.7.8.3.2.2"><csymbol cd="ambiguous" id="S4.E14.m2.7.8.3.2.2.1.cmml" xref="S4.E14.m2.7.8.3.2.2">subscript</csymbol><apply id="S4.E14.m2.7.8.3.2.2.2.cmml" xref="S4.E14.m2.7.8.3.2.2"><csymbol cd="ambiguous" id="S4.E14.m2.7.8.3.2.2.2.1.cmml" xref="S4.E14.m2.7.8.3.2.2">superscript</csymbol><ci id="S4.E14.m2.7.8.3.2.2.2.2.cmml" xref="S4.E14.m2.7.8.3.2.2.2.2">𝛼</ci><ci id="S4.E14.m2.4.4.1.1.cmml" xref="S4.E14.m2.4.4.1.1">𝑙</ci></apply><apply id="S4.E14.m2.5.5.1.cmml" xref="S4.E14.m2.5.5.1"><times id="S4.E14.m2.5.5.1.2.cmml" xref="S4.E14.m2.5.5.1.2"></times><ci id="S4.E14.m2.5.5.1.1.cmml" xref="S4.E14.m2.5.5.1.1">𝑟</ci><ci id="S4.E14.m2.5.5.1.4.cmml" xref="S4.E14.m2.5.5.1.4">𝑖</ci><ci id="S4.E14.m2.5.5.1.5.cmml" xref="S4.E14.m2.5.5.1.5">𝑗</ci></apply></apply><apply id="S4.E14.m2.7.8.3.2.3.cmml" xref="S4.E14.m2.7.8.3.2.3"><csymbol cd="ambiguous" id="S4.E14.m2.7.8.3.2.3.1.cmml" xref="S4.E14.m2.7.8.3.2.3">superscript</csymbol><apply id="S4.E14.m2.7.8.3.2.3.2.cmml" xref="S4.E14.m2.7.8.3.2.3"><csymbol cd="ambiguous" id="S4.E14.m2.7.8.3.2.3.2.1.cmml" xref="S4.E14.m2.7.8.3.2.3">subscript</csymbol><ci id="S4.E14.m2.7.8.3.2.3.2.2.cmml" xref="S4.E14.m2.7.8.3.2.3.2.2">ℎ</ci><ci id="S4.E14.m2.7.8.3.2.3.2.3.cmml" xref="S4.E14.m2.7.8.3.2.3.2.3">𝑗</ci></apply><apply id="S4.E14.m2.6.6.1.1.1.cmml" xref="S4.E14.m2.6.6.1.1"><minus id="S4.E14.m2.6.6.1.1.1.1.cmml" xref="S4.E14.m2.6.6.1.1.1.1"></minus><ci id="S4.E14.m2.6.6.1.1.1.2.cmml" xref="S4.E14.m2.6.6.1.1.1.2">𝑙</ci><cn id="S4.E14.m2.6.6.1.1.1.3.cmml" type="integer" xref="S4.E14.m2.6.6.1.1.1.3">1</cn></apply></apply><apply id="S4.E14.m2.7.8.3.2.4.cmml" xref="S4.E14.m2.7.8.3.2.4"><csymbol cd="ambiguous" id="S4.E14.m2.7.8.3.2.4.1.cmml" xref="S4.E14.m2.7.8.3.2.4">superscript</csymbol><ci id="S4.E14.m2.7.8.3.2.4.2.cmml" xref="S4.E14.m2.7.8.3.2.4.2">𝐖</ci><ci id="S4.E14.m2.7.7.1.1.cmml" xref="S4.E14.m2.7.7.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m2.7c">\displaystyle=\sum_{(v_{i},r_{r},v_{j})\in\mathcal{N}_{i}}\alpha^{(l)}_{(r)ij}%
h_{j}^{(l-1)}\mathbf{W}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m2.7d">= ∑ start_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_α start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i italic_j end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p1.5">where <math alttext="\mathbf{W}^{(l)}\in\mathbb{R}^{D^{(l-1)}_{h}\times d_{v}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.2.m1.2"><semantics id="S4.SS2.SSS0.Px4.p1.2.m1.2a"><mrow id="S4.SS2.SSS0.Px4.p1.2.m1.2.3" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.cmml"><msup id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2.cmml"><mi id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2.2" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2.2.cmml">𝐖</mi><mrow id="S4.SS2.SSS0.Px4.p1.2.m1.1.1.1.3" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2.cmml"><mo id="S4.SS2.SSS0.Px4.p1.2.m1.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p1.2.m1.1.1.1.1" xref="S4.SS2.SSS0.Px4.p1.2.m1.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p1.2.m1.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2.cmml">)</mo></mrow></msup><mo id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.1" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.1.cmml">∈</mo><msup id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.3" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.3.cmml"><mi id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.3.2" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.cmml"><msubsup id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.cmml"><mi id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.2.2" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.2.2.cmml">D</mi><mi id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.3" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.2.cmml">×</mo><msub id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4.cmml"><mi id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4.2" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4.2.cmml">d</mi><mi id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4.3" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.2.m1.2b"><apply id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3"><in id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.1"></in><apply id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.2.2">𝐖</ci><ci id="S4.SS2.SSS0.Px4.p1.2.m1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.3.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.3.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px4.p1.2.m1.2.3.3.2.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.3.3.2">ℝ</ci><apply id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1"><times id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.2.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.2"></times><apply id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3">subscript</csymbol><apply id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.2.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.2.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.2.2.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.2.2">𝐷</ci><apply id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1"><minus id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.1.1.1.1.3">1</cn></apply></apply><ci id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.3.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.3.3">ℎ</ci></apply><apply id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4.1.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4.2.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4.2">𝑑</ci><ci id="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4.3.cmml" xref="S4.SS2.SSS0.Px4.p1.2.m1.2.2.1.4.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.2.m1.2c">\mathbf{W}^{(l)}\in\mathbb{R}^{D^{(l-1)}_{h}\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.2.m1.2d">bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is a learnable transformation matrix that projects entity embedding to value vectors. <math alttext="d_{v}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.3.m2.1"><semantics id="S4.SS2.SSS0.Px4.p1.3.m2.1a"><msub id="S4.SS2.SSS0.Px4.p1.3.m2.1.1" xref="S4.SS2.SSS0.Px4.p1.3.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px4.p1.3.m2.1.1.2" xref="S4.SS2.SSS0.Px4.p1.3.m2.1.1.2.cmml">d</mi><mi id="S4.SS2.SSS0.Px4.p1.3.m2.1.1.3" xref="S4.SS2.SSS0.Px4.p1.3.m2.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.3.m2.1b"><apply id="S4.SS2.SSS0.Px4.p1.3.m2.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p1.3.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.3.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px4.p1.3.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px4.p1.3.m2.1.1.2">𝑑</ci><ci id="S4.SS2.SSS0.Px4.p1.3.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px4.p1.3.m2.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.3.m2.1c">d_{v}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.3.m2.1d">italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> represents the dimension of the value vector. <math alttext="h^{(l)}_{(h)i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.4.m3.2"><semantics id="S4.SS2.SSS0.Px4.p1.4.m3.2a"><msubsup id="S4.SS2.SSS0.Px4.p1.4.m3.2.3" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.3.cmml"><mi id="S4.SS2.SSS0.Px4.p1.4.m3.2.3.2.2" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.3.2.2.cmml">h</mi><mrow id="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.cmml"><mrow id="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.3.2" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.cmml"><mo id="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.1" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.1.cmml">h</mi><mo id="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.2" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.4" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.4.cmml">i</mi></mrow><mrow id="S4.SS2.SSS0.Px4.p1.4.m3.1.1.1.3" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.3.cmml"><mo id="S4.SS2.SSS0.Px4.p1.4.m3.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.3.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p1.4.m3.1.1.1.1" xref="S4.SS2.SSS0.Px4.p1.4.m3.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p1.4.m3.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.4.m3.2b"><apply id="S4.SS2.SSS0.Px4.p1.4.m3.2.3.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p1.4.m3.2.3.1.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.3">subscript</csymbol><apply id="S4.SS2.SSS0.Px4.p1.4.m3.2.3.2.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p1.4.m3.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px4.p1.4.m3.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.3.2.2">ℎ</ci><ci id="S4.SS2.SSS0.Px4.p1.4.m3.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m3.1.1.1.1">𝑙</ci></apply><apply id="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1"><times id="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.2.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.2"></times><ci id="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.1">ℎ</ci><ci id="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.4.cmml" xref="S4.SS2.SSS0.Px4.p1.4.m3.2.2.1.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.4.m3.2c">h^{(l)}_{(h)i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.4.m3.2d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="h^{(l)}_{(r)i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p1.5.m4.2"><semantics id="S4.SS2.SSS0.Px4.p1.5.m4.2a"><msubsup id="S4.SS2.SSS0.Px4.p1.5.m4.2.3" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.3.cmml"><mi id="S4.SS2.SSS0.Px4.p1.5.m4.2.3.2.2" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.3.2.2.cmml">h</mi><mrow id="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.cmml"><mrow id="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.3.2" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.cmml"><mo id="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.1" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.1.cmml">r</mi><mo id="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.2" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.4" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.4.cmml">i</mi></mrow><mrow id="S4.SS2.SSS0.Px4.p1.5.m4.1.1.1.3" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.3.cmml"><mo id="S4.SS2.SSS0.Px4.p1.5.m4.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.3.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p1.5.m4.1.1.1.1" xref="S4.SS2.SSS0.Px4.p1.5.m4.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p1.5.m4.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p1.5.m4.2b"><apply id="S4.SS2.SSS0.Px4.p1.5.m4.2.3.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p1.5.m4.2.3.1.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.3">subscript</csymbol><apply id="S4.SS2.SSS0.Px4.p1.5.m4.2.3.2.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p1.5.m4.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px4.p1.5.m4.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.3.2.2">ℎ</ci><ci id="S4.SS2.SSS0.Px4.p1.5.m4.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m4.1.1.1.1">𝑙</ci></apply><apply id="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1"><times id="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.2.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.2"></times><ci id="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.1.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.1">𝑟</ci><ci id="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.4.cmml" xref="S4.SS2.SSS0.Px4.p1.5.m4.2.2.1.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p1.5.m4.2c">h^{(l)}_{(r)i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p1.5.m4.2d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denote the embeddings that aggregate the neighborhood from the entity-specific attention network module and the entity-relation joint attention network module, respectively.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px4.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p2.2">The multi-head attention mechanism enables simultaneous focus on different feature spaces, allowing for the extraction of richer feature information. This has two main advantages. Firstly, it can accelerate model convergence by capturing diverse aspects of the input data. Secondly, it effectively mitigates the sensitivity of the attention mechanism to initialization, enhancing the stability and robustness of the model. Therefore, GATH adopts a multi-head attention mechanism instead of the single-head attention mechanism in order to learn different semantic features more effectively. Assuming there are <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p2.1.m1.1"><semantics id="S4.SS2.SSS0.Px4.p2.1.m1.1a"><mi id="S4.SS2.SSS0.Px4.p2.1.m1.1.1" xref="S4.SS2.SSS0.Px4.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p2.1.m1.1b"><ci id="S4.SS2.SSS0.Px4.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p2.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p2.1.m1.1d">italic_M</annotation></semantics></math> attention heads, we use the following formula to concatenate the output of <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p2.2.m2.1"><semantics id="S4.SS2.SSS0.Px4.p2.2.m2.1a"><mi id="S4.SS2.SSS0.Px4.p2.2.m2.1.1" xref="S4.SS2.SSS0.Px4.p2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p2.2.m2.1b"><ci id="S4.SS2.SSS0.Px4.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p2.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p2.2.m2.1d">italic_M</annotation></semantics></math> heads and project them into the entity feature space,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{h_{i}}^{(l)}=\text{CONCAT}(h^{(l),1}_{(h)i},h^{(l),1}_{(r)i},...,h^{(l),M%
}_{(h)i},h^{(l),M}_{(r)i})\mathbf{W}^{(l)}_{o}" class="ltx_Math" display="block" id="S4.E15.m1.23"><semantics id="S4.E15.m1.23a"><mrow id="S4.E15.m1.23.23" xref="S4.E15.m1.23.23.cmml"><msup id="S4.E15.m1.23.23.6" xref="S4.E15.m1.23.23.6.cmml"><mover accent="true" id="S4.E15.m1.23.23.6.2" xref="S4.E15.m1.23.23.6.2.cmml"><msub id="S4.E15.m1.23.23.6.2.2" xref="S4.E15.m1.23.23.6.2.2.cmml"><mi id="S4.E15.m1.23.23.6.2.2.2" xref="S4.E15.m1.23.23.6.2.2.2.cmml">h</mi><mi id="S4.E15.m1.23.23.6.2.2.3" xref="S4.E15.m1.23.23.6.2.2.3.cmml">i</mi></msub><mo id="S4.E15.m1.23.23.6.2.1" xref="S4.E15.m1.23.23.6.2.1.cmml">^</mo></mover><mrow id="S4.E15.m1.1.1.1.3" xref="S4.E15.m1.23.23.6.cmml"><mo id="S4.E15.m1.1.1.1.3.1" stretchy="false" xref="S4.E15.m1.23.23.6.cmml">(</mo><mi id="S4.E15.m1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.cmml">l</mi><mo id="S4.E15.m1.1.1.1.3.2" stretchy="false" xref="S4.E15.m1.23.23.6.cmml">)</mo></mrow></msup><mo id="S4.E15.m1.23.23.5" xref="S4.E15.m1.23.23.5.cmml">=</mo><mrow id="S4.E15.m1.23.23.4" xref="S4.E15.m1.23.23.4.cmml"><mtext id="S4.E15.m1.23.23.4.6" xref="S4.E15.m1.23.23.4.6a.cmml">CONCAT</mtext><mo id="S4.E15.m1.23.23.4.5" xref="S4.E15.m1.23.23.4.5.cmml">⁢</mo><mrow id="S4.E15.m1.23.23.4.4.4" xref="S4.E15.m1.23.23.4.4.5.cmml"><mo id="S4.E15.m1.23.23.4.4.4.5" stretchy="false" xref="S4.E15.m1.23.23.4.4.5.cmml">(</mo><msubsup id="S4.E15.m1.20.20.1.1.1.1" xref="S4.E15.m1.20.20.1.1.1.1.cmml"><mi id="S4.E15.m1.20.20.1.1.1.1.2.2" xref="S4.E15.m1.20.20.1.1.1.1.2.2.cmml">h</mi><mrow id="S4.E15.m1.5.5.1" xref="S4.E15.m1.5.5.1.cmml"><mrow id="S4.E15.m1.5.5.1.3.2" xref="S4.E15.m1.5.5.1.cmml"><mo id="S4.E15.m1.5.5.1.3.2.1" stretchy="false" xref="S4.E15.m1.5.5.1.cmml">(</mo><mi id="S4.E15.m1.5.5.1.1" xref="S4.E15.m1.5.5.1.1.cmml">h</mi><mo id="S4.E15.m1.5.5.1.3.2.2" stretchy="false" xref="S4.E15.m1.5.5.1.cmml">)</mo></mrow><mo id="S4.E15.m1.5.5.1.2" xref="S4.E15.m1.5.5.1.2.cmml">⁢</mo><mi id="S4.E15.m1.5.5.1.4" xref="S4.E15.m1.5.5.1.4.cmml">i</mi></mrow><mrow id="S4.E15.m1.4.4.3.3" xref="S4.E15.m1.4.4.3.4.cmml"><mrow id="S4.E15.m1.4.4.3.3.1.2" xref="S4.E15.m1.4.4.3.4.cmml"><mo id="S4.E15.m1.4.4.3.3.1.2.1" stretchy="false" xref="S4.E15.m1.4.4.3.4.cmml">(</mo><mi id="S4.E15.m1.2.2.1.1" xref="S4.E15.m1.2.2.1.1.cmml">l</mi><mo id="S4.E15.m1.4.4.3.3.1.2.2" stretchy="false" xref="S4.E15.m1.4.4.3.4.cmml">)</mo></mrow><mo id="S4.E15.m1.4.4.3.3.2" xref="S4.E15.m1.4.4.3.4.cmml">,</mo><mn id="S4.E15.m1.3.3.2.2" xref="S4.E15.m1.3.3.2.2.cmml">1</mn></mrow></msubsup><mo id="S4.E15.m1.23.23.4.4.4.6" xref="S4.E15.m1.23.23.4.4.5.cmml">,</mo><msubsup id="S4.E15.m1.21.21.2.2.2.2" xref="S4.E15.m1.21.21.2.2.2.2.cmml"><mi id="S4.E15.m1.21.21.2.2.2.2.2.2" xref="S4.E15.m1.21.21.2.2.2.2.2.2.cmml">h</mi><mrow id="S4.E15.m1.9.9.1" xref="S4.E15.m1.9.9.1.cmml"><mrow id="S4.E15.m1.9.9.1.3.2" xref="S4.E15.m1.9.9.1.cmml"><mo id="S4.E15.m1.9.9.1.3.2.1" stretchy="false" xref="S4.E15.m1.9.9.1.cmml">(</mo><mi id="S4.E15.m1.9.9.1.1" xref="S4.E15.m1.9.9.1.1.cmml">r</mi><mo id="S4.E15.m1.9.9.1.3.2.2" stretchy="false" xref="S4.E15.m1.9.9.1.cmml">)</mo></mrow><mo id="S4.E15.m1.9.9.1.2" xref="S4.E15.m1.9.9.1.2.cmml">⁢</mo><mi id="S4.E15.m1.9.9.1.4" xref="S4.E15.m1.9.9.1.4.cmml">i</mi></mrow><mrow id="S4.E15.m1.8.8.3.3" xref="S4.E15.m1.8.8.3.4.cmml"><mrow id="S4.E15.m1.8.8.3.3.1.2" xref="S4.E15.m1.8.8.3.4.cmml"><mo id="S4.E15.m1.8.8.3.3.1.2.1" stretchy="false" xref="S4.E15.m1.8.8.3.4.cmml">(</mo><mi id="S4.E15.m1.6.6.1.1" xref="S4.E15.m1.6.6.1.1.cmml">l</mi><mo id="S4.E15.m1.8.8.3.3.1.2.2" stretchy="false" xref="S4.E15.m1.8.8.3.4.cmml">)</mo></mrow><mo id="S4.E15.m1.8.8.3.3.2" xref="S4.E15.m1.8.8.3.4.cmml">,</mo><mn id="S4.E15.m1.7.7.2.2" xref="S4.E15.m1.7.7.2.2.cmml">1</mn></mrow></msubsup><mo id="S4.E15.m1.23.23.4.4.4.7" xref="S4.E15.m1.23.23.4.4.5.cmml">,</mo><mi id="S4.E15.m1.19.19" mathvariant="normal" xref="S4.E15.m1.19.19.cmml">…</mi><mo id="S4.E15.m1.23.23.4.4.4.8" xref="S4.E15.m1.23.23.4.4.5.cmml">,</mo><msubsup id="S4.E15.m1.22.22.3.3.3.3" xref="S4.E15.m1.22.22.3.3.3.3.cmml"><mi id="S4.E15.m1.22.22.3.3.3.3.2.2" xref="S4.E15.m1.22.22.3.3.3.3.2.2.cmml">h</mi><mrow id="S4.E15.m1.13.13.1" xref="S4.E15.m1.13.13.1.cmml"><mrow id="S4.E15.m1.13.13.1.3.2" xref="S4.E15.m1.13.13.1.cmml"><mo id="S4.E15.m1.13.13.1.3.2.1" stretchy="false" xref="S4.E15.m1.13.13.1.cmml">(</mo><mi id="S4.E15.m1.13.13.1.1" xref="S4.E15.m1.13.13.1.1.cmml">h</mi><mo id="S4.E15.m1.13.13.1.3.2.2" stretchy="false" xref="S4.E15.m1.13.13.1.cmml">)</mo></mrow><mo id="S4.E15.m1.13.13.1.2" xref="S4.E15.m1.13.13.1.2.cmml">⁢</mo><mi id="S4.E15.m1.13.13.1.4" xref="S4.E15.m1.13.13.1.4.cmml">i</mi></mrow><mrow id="S4.E15.m1.12.12.3.3" xref="S4.E15.m1.12.12.3.4.cmml"><mrow id="S4.E15.m1.12.12.3.3.1.2" xref="S4.E15.m1.12.12.3.4.cmml"><mo id="S4.E15.m1.12.12.3.3.1.2.1" stretchy="false" xref="S4.E15.m1.12.12.3.4.cmml">(</mo><mi id="S4.E15.m1.10.10.1.1" xref="S4.E15.m1.10.10.1.1.cmml">l</mi><mo id="S4.E15.m1.12.12.3.3.1.2.2" stretchy="false" xref="S4.E15.m1.12.12.3.4.cmml">)</mo></mrow><mo id="S4.E15.m1.12.12.3.3.2" xref="S4.E15.m1.12.12.3.4.cmml">,</mo><mi id="S4.E15.m1.11.11.2.2" xref="S4.E15.m1.11.11.2.2.cmml">M</mi></mrow></msubsup><mo id="S4.E15.m1.23.23.4.4.4.9" xref="S4.E15.m1.23.23.4.4.5.cmml">,</mo><msubsup id="S4.E15.m1.23.23.4.4.4.4" xref="S4.E15.m1.23.23.4.4.4.4.cmml"><mi id="S4.E15.m1.23.23.4.4.4.4.2.2" xref="S4.E15.m1.23.23.4.4.4.4.2.2.cmml">h</mi><mrow id="S4.E15.m1.17.17.1" xref="S4.E15.m1.17.17.1.cmml"><mrow id="S4.E15.m1.17.17.1.3.2" xref="S4.E15.m1.17.17.1.cmml"><mo id="S4.E15.m1.17.17.1.3.2.1" stretchy="false" xref="S4.E15.m1.17.17.1.cmml">(</mo><mi id="S4.E15.m1.17.17.1.1" xref="S4.E15.m1.17.17.1.1.cmml">r</mi><mo id="S4.E15.m1.17.17.1.3.2.2" stretchy="false" xref="S4.E15.m1.17.17.1.cmml">)</mo></mrow><mo id="S4.E15.m1.17.17.1.2" xref="S4.E15.m1.17.17.1.2.cmml">⁢</mo><mi id="S4.E15.m1.17.17.1.4" xref="S4.E15.m1.17.17.1.4.cmml">i</mi></mrow><mrow id="S4.E15.m1.16.16.3.3" xref="S4.E15.m1.16.16.3.4.cmml"><mrow id="S4.E15.m1.16.16.3.3.1.2" xref="S4.E15.m1.16.16.3.4.cmml"><mo id="S4.E15.m1.16.16.3.3.1.2.1" stretchy="false" xref="S4.E15.m1.16.16.3.4.cmml">(</mo><mi id="S4.E15.m1.14.14.1.1" xref="S4.E15.m1.14.14.1.1.cmml">l</mi><mo id="S4.E15.m1.16.16.3.3.1.2.2" stretchy="false" xref="S4.E15.m1.16.16.3.4.cmml">)</mo></mrow><mo id="S4.E15.m1.16.16.3.3.2" xref="S4.E15.m1.16.16.3.4.cmml">,</mo><mi id="S4.E15.m1.15.15.2.2" xref="S4.E15.m1.15.15.2.2.cmml">M</mi></mrow></msubsup><mo id="S4.E15.m1.23.23.4.4.4.10" stretchy="false" xref="S4.E15.m1.23.23.4.4.5.cmml">)</mo></mrow><mo id="S4.E15.m1.23.23.4.5a" xref="S4.E15.m1.23.23.4.5.cmml">⁢</mo><msubsup id="S4.E15.m1.23.23.4.7" xref="S4.E15.m1.23.23.4.7.cmml"><mi id="S4.E15.m1.23.23.4.7.2.2" xref="S4.E15.m1.23.23.4.7.2.2.cmml">𝐖</mi><mi id="S4.E15.m1.23.23.4.7.3" xref="S4.E15.m1.23.23.4.7.3.cmml">o</mi><mrow id="S4.E15.m1.18.18.1.3" xref="S4.E15.m1.23.23.4.7.cmml"><mo id="S4.E15.m1.18.18.1.3.1" stretchy="false" xref="S4.E15.m1.23.23.4.7.cmml">(</mo><mi id="S4.E15.m1.18.18.1.1" xref="S4.E15.m1.18.18.1.1.cmml">l</mi><mo id="S4.E15.m1.18.18.1.3.2" stretchy="false" xref="S4.E15.m1.23.23.4.7.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.23b"><apply id="S4.E15.m1.23.23.cmml" xref="S4.E15.m1.23.23"><eq id="S4.E15.m1.23.23.5.cmml" xref="S4.E15.m1.23.23.5"></eq><apply id="S4.E15.m1.23.23.6.cmml" xref="S4.E15.m1.23.23.6"><csymbol cd="ambiguous" id="S4.E15.m1.23.23.6.1.cmml" xref="S4.E15.m1.23.23.6">superscript</csymbol><apply id="S4.E15.m1.23.23.6.2.cmml" xref="S4.E15.m1.23.23.6.2"><ci id="S4.E15.m1.23.23.6.2.1.cmml" xref="S4.E15.m1.23.23.6.2.1">^</ci><apply id="S4.E15.m1.23.23.6.2.2.cmml" xref="S4.E15.m1.23.23.6.2.2"><csymbol cd="ambiguous" id="S4.E15.m1.23.23.6.2.2.1.cmml" xref="S4.E15.m1.23.23.6.2.2">subscript</csymbol><ci id="S4.E15.m1.23.23.6.2.2.2.cmml" xref="S4.E15.m1.23.23.6.2.2.2">ℎ</ci><ci id="S4.E15.m1.23.23.6.2.2.3.cmml" xref="S4.E15.m1.23.23.6.2.2.3">𝑖</ci></apply></apply><ci id="S4.E15.m1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1">𝑙</ci></apply><apply id="S4.E15.m1.23.23.4.cmml" xref="S4.E15.m1.23.23.4"><times id="S4.E15.m1.23.23.4.5.cmml" xref="S4.E15.m1.23.23.4.5"></times><ci id="S4.E15.m1.23.23.4.6a.cmml" xref="S4.E15.m1.23.23.4.6"><mtext id="S4.E15.m1.23.23.4.6.cmml" xref="S4.E15.m1.23.23.4.6">CONCAT</mtext></ci><vector id="S4.E15.m1.23.23.4.4.5.cmml" xref="S4.E15.m1.23.23.4.4.4"><apply id="S4.E15.m1.20.20.1.1.1.1.cmml" xref="S4.E15.m1.20.20.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.20.20.1.1.1.1.1.cmml" xref="S4.E15.m1.20.20.1.1.1.1">subscript</csymbol><apply id="S4.E15.m1.20.20.1.1.1.1.2.cmml" xref="S4.E15.m1.20.20.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.20.20.1.1.1.1.2.1.cmml" xref="S4.E15.m1.20.20.1.1.1.1">superscript</csymbol><ci id="S4.E15.m1.20.20.1.1.1.1.2.2.cmml" xref="S4.E15.m1.20.20.1.1.1.1.2.2">ℎ</ci><list id="S4.E15.m1.4.4.3.4.cmml" xref="S4.E15.m1.4.4.3.3"><ci id="S4.E15.m1.2.2.1.1.cmml" xref="S4.E15.m1.2.2.1.1">𝑙</ci><cn id="S4.E15.m1.3.3.2.2.cmml" type="integer" xref="S4.E15.m1.3.3.2.2">1</cn></list></apply><apply id="S4.E15.m1.5.5.1.cmml" xref="S4.E15.m1.5.5.1"><times id="S4.E15.m1.5.5.1.2.cmml" xref="S4.E15.m1.5.5.1.2"></times><ci id="S4.E15.m1.5.5.1.1.cmml" xref="S4.E15.m1.5.5.1.1">ℎ</ci><ci id="S4.E15.m1.5.5.1.4.cmml" xref="S4.E15.m1.5.5.1.4">𝑖</ci></apply></apply><apply id="S4.E15.m1.21.21.2.2.2.2.cmml" xref="S4.E15.m1.21.21.2.2.2.2"><csymbol cd="ambiguous" id="S4.E15.m1.21.21.2.2.2.2.1.cmml" xref="S4.E15.m1.21.21.2.2.2.2">subscript</csymbol><apply id="S4.E15.m1.21.21.2.2.2.2.2.cmml" xref="S4.E15.m1.21.21.2.2.2.2"><csymbol cd="ambiguous" id="S4.E15.m1.21.21.2.2.2.2.2.1.cmml" xref="S4.E15.m1.21.21.2.2.2.2">superscript</csymbol><ci id="S4.E15.m1.21.21.2.2.2.2.2.2.cmml" xref="S4.E15.m1.21.21.2.2.2.2.2.2">ℎ</ci><list id="S4.E15.m1.8.8.3.4.cmml" xref="S4.E15.m1.8.8.3.3"><ci id="S4.E15.m1.6.6.1.1.cmml" xref="S4.E15.m1.6.6.1.1">𝑙</ci><cn id="S4.E15.m1.7.7.2.2.cmml" type="integer" xref="S4.E15.m1.7.7.2.2">1</cn></list></apply><apply id="S4.E15.m1.9.9.1.cmml" xref="S4.E15.m1.9.9.1"><times id="S4.E15.m1.9.9.1.2.cmml" xref="S4.E15.m1.9.9.1.2"></times><ci id="S4.E15.m1.9.9.1.1.cmml" xref="S4.E15.m1.9.9.1.1">𝑟</ci><ci id="S4.E15.m1.9.9.1.4.cmml" xref="S4.E15.m1.9.9.1.4">𝑖</ci></apply></apply><ci id="S4.E15.m1.19.19.cmml" xref="S4.E15.m1.19.19">…</ci><apply id="S4.E15.m1.22.22.3.3.3.3.cmml" xref="S4.E15.m1.22.22.3.3.3.3"><csymbol cd="ambiguous" id="S4.E15.m1.22.22.3.3.3.3.1.cmml" xref="S4.E15.m1.22.22.3.3.3.3">subscript</csymbol><apply id="S4.E15.m1.22.22.3.3.3.3.2.cmml" xref="S4.E15.m1.22.22.3.3.3.3"><csymbol cd="ambiguous" id="S4.E15.m1.22.22.3.3.3.3.2.1.cmml" xref="S4.E15.m1.22.22.3.3.3.3">superscript</csymbol><ci id="S4.E15.m1.22.22.3.3.3.3.2.2.cmml" xref="S4.E15.m1.22.22.3.3.3.3.2.2">ℎ</ci><list id="S4.E15.m1.12.12.3.4.cmml" xref="S4.E15.m1.12.12.3.3"><ci id="S4.E15.m1.10.10.1.1.cmml" xref="S4.E15.m1.10.10.1.1">𝑙</ci><ci id="S4.E15.m1.11.11.2.2.cmml" xref="S4.E15.m1.11.11.2.2">𝑀</ci></list></apply><apply id="S4.E15.m1.13.13.1.cmml" xref="S4.E15.m1.13.13.1"><times id="S4.E15.m1.13.13.1.2.cmml" xref="S4.E15.m1.13.13.1.2"></times><ci id="S4.E15.m1.13.13.1.1.cmml" xref="S4.E15.m1.13.13.1.1">ℎ</ci><ci id="S4.E15.m1.13.13.1.4.cmml" xref="S4.E15.m1.13.13.1.4">𝑖</ci></apply></apply><apply id="S4.E15.m1.23.23.4.4.4.4.cmml" xref="S4.E15.m1.23.23.4.4.4.4"><csymbol cd="ambiguous" id="S4.E15.m1.23.23.4.4.4.4.1.cmml" xref="S4.E15.m1.23.23.4.4.4.4">subscript</csymbol><apply id="S4.E15.m1.23.23.4.4.4.4.2.cmml" xref="S4.E15.m1.23.23.4.4.4.4"><csymbol cd="ambiguous" id="S4.E15.m1.23.23.4.4.4.4.2.1.cmml" xref="S4.E15.m1.23.23.4.4.4.4">superscript</csymbol><ci id="S4.E15.m1.23.23.4.4.4.4.2.2.cmml" xref="S4.E15.m1.23.23.4.4.4.4.2.2">ℎ</ci><list id="S4.E15.m1.16.16.3.4.cmml" xref="S4.E15.m1.16.16.3.3"><ci id="S4.E15.m1.14.14.1.1.cmml" xref="S4.E15.m1.14.14.1.1">𝑙</ci><ci id="S4.E15.m1.15.15.2.2.cmml" xref="S4.E15.m1.15.15.2.2">𝑀</ci></list></apply><apply id="S4.E15.m1.17.17.1.cmml" xref="S4.E15.m1.17.17.1"><times id="S4.E15.m1.17.17.1.2.cmml" xref="S4.E15.m1.17.17.1.2"></times><ci id="S4.E15.m1.17.17.1.1.cmml" xref="S4.E15.m1.17.17.1.1">𝑟</ci><ci id="S4.E15.m1.17.17.1.4.cmml" xref="S4.E15.m1.17.17.1.4">𝑖</ci></apply></apply></vector><apply id="S4.E15.m1.23.23.4.7.cmml" xref="S4.E15.m1.23.23.4.7"><csymbol cd="ambiguous" id="S4.E15.m1.23.23.4.7.1.cmml" xref="S4.E15.m1.23.23.4.7">subscript</csymbol><apply id="S4.E15.m1.23.23.4.7.2.cmml" xref="S4.E15.m1.23.23.4.7"><csymbol cd="ambiguous" id="S4.E15.m1.23.23.4.7.2.1.cmml" xref="S4.E15.m1.23.23.4.7">superscript</csymbol><ci id="S4.E15.m1.23.23.4.7.2.2.cmml" xref="S4.E15.m1.23.23.4.7.2.2">𝐖</ci><ci id="S4.E15.m1.18.18.1.1.cmml" xref="S4.E15.m1.18.18.1.1">𝑙</ci></apply><ci id="S4.E15.m1.23.23.4.7.3.cmml" xref="S4.E15.m1.23.23.4.7.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.23c">\hat{h_{i}}^{(l)}=\text{CONCAT}(h^{(l),1}_{(h)i},h^{(l),1}_{(r)i},...,h^{(l),M%
}_{(h)i},h^{(l),M}_{(r)i})\mathbf{W}^{(l)}_{o}</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.23d">over^ start_ARG italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = CONCAT ( italic_h start_POSTSUPERSCRIPT ( italic_l ) , 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT ( italic_l ) , 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i end_POSTSUBSCRIPT , … , italic_h start_POSTSUPERSCRIPT ( italic_l ) , italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i end_POSTSUBSCRIPT , italic_h start_POSTSUPERSCRIPT ( italic_l ) , italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i end_POSTSUBSCRIPT ) bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p2.6">where <math alttext="h^{(l),m}_{(h)i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p2.3.m1.4"><semantics id="S4.SS2.SSS0.Px4.p2.3.m1.4a"><msubsup id="S4.SS2.SSS0.Px4.p2.3.m1.4.5" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.5.cmml"><mi id="S4.SS2.SSS0.Px4.p2.3.m1.4.5.2.2" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.5.2.2.cmml">h</mi><mrow id="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.cmml"><mrow id="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.3.2" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.cmml"><mo id="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.1" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.1.cmml">h</mi><mo id="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.2" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.4" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.4.cmml">i</mi></mrow><mrow id="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.3" xref="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.4.cmml"><mrow id="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.3.1.2" xref="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.4.cmml"><mo id="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.3.1.2.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.4.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p2.3.m1.1.1.1.1" xref="S4.SS2.SSS0.Px4.p2.3.m1.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.3.1.2.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.4.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.3.2" xref="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.4.cmml">,</mo><mi id="S4.SS2.SSS0.Px4.p2.3.m1.2.2.2.2" xref="S4.SS2.SSS0.Px4.p2.3.m1.2.2.2.2.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p2.3.m1.4b"><apply id="S4.SS2.SSS0.Px4.p2.3.m1.4.5.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.5"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.3.m1.4.5.1.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.5">subscript</csymbol><apply id="S4.SS2.SSS0.Px4.p2.3.m1.4.5.2.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.5"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.3.m1.4.5.2.1.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.5">superscript</csymbol><ci id="S4.SS2.SSS0.Px4.p2.3.m1.4.5.2.2.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.5.2.2">ℎ</ci><list id="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.4.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.3.3.3.3"><ci id="S4.SS2.SSS0.Px4.p2.3.m1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.1.1.1.1">𝑙</ci><ci id="S4.SS2.SSS0.Px4.p2.3.m1.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.2.2.2.2">𝑚</ci></list></apply><apply id="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1"><times id="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.2.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.2"></times><ci id="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.1">ℎ</ci><ci id="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.4.cmml" xref="S4.SS2.SSS0.Px4.p2.3.m1.4.4.1.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p2.3.m1.4c">h^{(l),m}_{(h)i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p2.3.m1.4d">italic_h start_POSTSUPERSCRIPT ( italic_l ) , italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="h^{(l),m}_{(r)i}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p2.4.m2.4"><semantics id="S4.SS2.SSS0.Px4.p2.4.m2.4a"><msubsup id="S4.SS2.SSS0.Px4.p2.4.m2.4.5" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.5.cmml"><mi id="S4.SS2.SSS0.Px4.p2.4.m2.4.5.2.2" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.5.2.2.cmml">h</mi><mrow id="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.cmml"><mrow id="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.3.2" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.cmml"><mo id="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.1" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.1.cmml">r</mi><mo id="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.2" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.2.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.4" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.4.cmml">i</mi></mrow><mrow id="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.3" xref="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.4.cmml"><mrow id="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.3.1.2" xref="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.4.cmml"><mo id="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.3.1.2.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.4.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p2.4.m2.1.1.1.1" xref="S4.SS2.SSS0.Px4.p2.4.m2.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.3.1.2.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.4.cmml">)</mo></mrow><mo id="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.3.2" xref="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.4.cmml">,</mo><mi id="S4.SS2.SSS0.Px4.p2.4.m2.2.2.2.2" xref="S4.SS2.SSS0.Px4.p2.4.m2.2.2.2.2.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p2.4.m2.4b"><apply id="S4.SS2.SSS0.Px4.p2.4.m2.4.5.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.5"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.4.m2.4.5.1.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.5">subscript</csymbol><apply id="S4.SS2.SSS0.Px4.p2.4.m2.4.5.2.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.5"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.4.m2.4.5.2.1.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.5">superscript</csymbol><ci id="S4.SS2.SSS0.Px4.p2.4.m2.4.5.2.2.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.5.2.2">ℎ</ci><list id="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.4.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.3.3.3.3"><ci id="S4.SS2.SSS0.Px4.p2.4.m2.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.1.1.1.1">𝑙</ci><ci id="S4.SS2.SSS0.Px4.p2.4.m2.2.2.2.2.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.2.2.2.2">𝑚</ci></list></apply><apply id="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1"><times id="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.2.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.2"></times><ci id="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.1">𝑟</ci><ci id="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.4.cmml" xref="S4.SS2.SSS0.Px4.p2.4.m2.4.4.1.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p2.4.m2.4c">h^{(l),m}_{(r)i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p2.4.m2.4d">italic_h start_POSTSUPERSCRIPT ( italic_l ) , italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denote the embeddings generated by the m-th entity-specific attention network module and entity-relation joint attention network module respectively. <math alttext="\mathbf{W}^{(l)}_{o}\in\mathbb{R}^{2Md_{v}\times D_{h}^{(l)}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p2.5.m3.2"><semantics id="S4.SS2.SSS0.Px4.p2.5.m3.2a"><mrow id="S4.SS2.SSS0.Px4.p2.5.m3.2.3" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.cmml"><msubsup id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.cmml"><mi id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.2.2" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.2.2.cmml">𝐖</mi><mi id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.3" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.3.cmml">o</mi><mrow id="S4.SS2.SSS0.Px4.p2.5.m3.1.1.1.3" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.cmml"><mo id="S4.SS2.SSS0.Px4.p2.5.m3.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p2.5.m3.1.1.1.1" xref="S4.SS2.SSS0.Px4.p2.5.m3.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p2.5.m3.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.1" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.1.cmml">∈</mo><msup id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.3" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.3.cmml"><mi id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.3.2" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.cmml"><mrow id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.cmml"><mn id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.2" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.2.cmml">2</mn><mo id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.1" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.3" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.3.cmml">M</mi><mo id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.1a" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4.cmml"><mi id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4.2" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4.2.cmml">d</mi><mi id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4.3" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4.3.cmml">v</mi></msub></mrow><mo id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.2.cmml">×</mo><msubsup id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.cmml"><mi id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.2.2" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.2.2.cmml">D</mi><mi id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.2.3" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.2.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.1.1.3" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.cmml"><mo id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.1.1.1" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.cmml">)</mo></mrow></msubsup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p2.5.m3.2b"><apply id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3"><in id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.1.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.1"></in><apply id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.1.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2">subscript</csymbol><apply id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.2.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.2.1.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.2.2.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.2.2">𝐖</ci><ci id="S4.SS2.SSS0.Px4.p2.5.m3.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.1.1.1.1">𝑙</ci></apply><ci id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.3.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.2.3">𝑜</ci></apply><apply id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.3.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.3.1.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px4.p2.5.m3.2.3.3.2.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.3.3.2">ℝ</ci><apply id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1"><times id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.2.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.2"></times><apply id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3"><times id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.1.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.1"></times><cn id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.2.cmml" type="integer" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.2">2</cn><ci id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.3.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.3">𝑀</ci><apply id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4.1.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4.2.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4.2">𝑑</ci><ci id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4.3.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.3.4.3">𝑣</ci></apply></apply><apply id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.1.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4">superscript</csymbol><apply id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.2.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.2.1.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.2.2.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.2.2">𝐷</ci><ci id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.2.3.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.4.2.3">ℎ</ci></apply><ci id="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.5.m3.2.2.1.1.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p2.5.m3.2c">\mathbf{W}^{(l)}_{o}\in\mathbb{R}^{2Md_{v}\times D_{h}^{(l)}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p2.5.m3.2d">bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 2 italic_M italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT × italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> transforms the multi-head attention output to the entity feature space. <math alttext="D_{h}^{(l)}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p2.6.m4.1"><semantics id="S4.SS2.SSS0.Px4.p2.6.m4.1a"><msubsup id="S4.SS2.SSS0.Px4.p2.6.m4.1.2" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2.cmml"><mi id="S4.SS2.SSS0.Px4.p2.6.m4.1.2.2.2" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2.2.2.cmml">D</mi><mi id="S4.SS2.SSS0.Px4.p2.6.m4.1.2.2.3" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2.2.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px4.p2.6.m4.1.1.1.3" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2.cmml"><mo id="S4.SS2.SSS0.Px4.p2.6.m4.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p2.6.m4.1.1.1.1" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p2.6.m4.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p2.6.m4.1b"><apply id="S4.SS2.SSS0.Px4.p2.6.m4.1.2.cmml" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.6.m4.1.2.1.cmml" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2">superscript</csymbol><apply id="S4.SS2.SSS0.Px4.p2.6.m4.1.2.2.cmml" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p2.6.m4.1.2.2.1.cmml" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2">subscript</csymbol><ci id="S4.SS2.SSS0.Px4.p2.6.m4.1.2.2.2.cmml" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2.2.2">𝐷</ci><ci id="S4.SS2.SSS0.Px4.p2.6.m4.1.2.2.3.cmml" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.2.2.3">ℎ</ci></apply><ci id="S4.SS2.SSS0.Px4.p2.6.m4.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p2.6.m4.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p2.6.m4.1c">D_{h}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p2.6.m4.1d">italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the dimension of the output entity embedding of the aggregation module.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS0.Px4.p3">
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p3.1">Up to this point, the entities have gathered all the neighborhood information. It is worth noting that the information of the entities themselves is not propagated, which may lead to an over-smoothing of the graph, i.e., the entity embeddings tend to be the same. Inspired by ResNet<cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib9" title="">2016</a>)</cite>, we introduce self-loops as residual connections and a learnable parameter <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p3.1.m1.1"><semantics id="S4.SS2.SSS0.Px4.p3.1.m1.1a"><mi id="S4.SS2.SSS0.Px4.p3.1.m1.1.1" xref="S4.SS2.SSS0.Px4.p3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p3.1.m1.1b"><ci id="S4.SS2.SSS0.Px4.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p3.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p3.1.m1.1d">italic_β</annotation></semantics></math> for each entity to make information propagation more flexible. The updated formula for entity embedding propagation is as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(16)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h^{(l)}_{i}=\sigma(\hat{h_{i}}^{(l)}+\beta h_{i}^{(l-1)}\mathbf{W}^{(l)}_{h})" class="ltx_Math" display="block" id="S4.E16.m1.5"><semantics id="S4.E16.m1.5a"><mrow id="S4.E16.m1.5.5" xref="S4.E16.m1.5.5.cmml"><msubsup id="S4.E16.m1.5.5.3" xref="S4.E16.m1.5.5.3.cmml"><mi id="S4.E16.m1.5.5.3.2.2" xref="S4.E16.m1.5.5.3.2.2.cmml">h</mi><mi id="S4.E16.m1.5.5.3.3" xref="S4.E16.m1.5.5.3.3.cmml">i</mi><mrow id="S4.E16.m1.1.1.1.3" xref="S4.E16.m1.5.5.3.cmml"><mo id="S4.E16.m1.1.1.1.3.1" stretchy="false" xref="S4.E16.m1.5.5.3.cmml">(</mo><mi id="S4.E16.m1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.cmml">l</mi><mo id="S4.E16.m1.1.1.1.3.2" stretchy="false" xref="S4.E16.m1.5.5.3.cmml">)</mo></mrow></msubsup><mo id="S4.E16.m1.5.5.2" xref="S4.E16.m1.5.5.2.cmml">=</mo><mrow id="S4.E16.m1.5.5.1" xref="S4.E16.m1.5.5.1.cmml"><mi id="S4.E16.m1.5.5.1.3" xref="S4.E16.m1.5.5.1.3.cmml">σ</mi><mo id="S4.E16.m1.5.5.1.2" xref="S4.E16.m1.5.5.1.2.cmml">⁢</mo><mrow id="S4.E16.m1.5.5.1.1.1" xref="S4.E16.m1.5.5.1.1.1.1.cmml"><mo id="S4.E16.m1.5.5.1.1.1.2" stretchy="false" xref="S4.E16.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S4.E16.m1.5.5.1.1.1.1" xref="S4.E16.m1.5.5.1.1.1.1.cmml"><msup id="S4.E16.m1.5.5.1.1.1.1.2" xref="S4.E16.m1.5.5.1.1.1.1.2.cmml"><mover accent="true" id="S4.E16.m1.5.5.1.1.1.1.2.2" xref="S4.E16.m1.5.5.1.1.1.1.2.2.cmml"><msub id="S4.E16.m1.5.5.1.1.1.1.2.2.2" xref="S4.E16.m1.5.5.1.1.1.1.2.2.2.cmml"><mi id="S4.E16.m1.5.5.1.1.1.1.2.2.2.2" xref="S4.E16.m1.5.5.1.1.1.1.2.2.2.2.cmml">h</mi><mi id="S4.E16.m1.5.5.1.1.1.1.2.2.2.3" xref="S4.E16.m1.5.5.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S4.E16.m1.5.5.1.1.1.1.2.2.1" xref="S4.E16.m1.5.5.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.E16.m1.2.2.1.3" xref="S4.E16.m1.5.5.1.1.1.1.2.cmml"><mo id="S4.E16.m1.2.2.1.3.1" stretchy="false" xref="S4.E16.m1.5.5.1.1.1.1.2.cmml">(</mo><mi id="S4.E16.m1.2.2.1.1" xref="S4.E16.m1.2.2.1.1.cmml">l</mi><mo id="S4.E16.m1.2.2.1.3.2" stretchy="false" xref="S4.E16.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S4.E16.m1.5.5.1.1.1.1.1" xref="S4.E16.m1.5.5.1.1.1.1.1.cmml">+</mo><mrow id="S4.E16.m1.5.5.1.1.1.1.3" xref="S4.E16.m1.5.5.1.1.1.1.3.cmml"><mi id="S4.E16.m1.5.5.1.1.1.1.3.2" xref="S4.E16.m1.5.5.1.1.1.1.3.2.cmml">β</mi><mo id="S4.E16.m1.5.5.1.1.1.1.3.1" xref="S4.E16.m1.5.5.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S4.E16.m1.5.5.1.1.1.1.3.3" xref="S4.E16.m1.5.5.1.1.1.1.3.3.cmml"><mi id="S4.E16.m1.5.5.1.1.1.1.3.3.2.2" xref="S4.E16.m1.5.5.1.1.1.1.3.3.2.2.cmml">h</mi><mi id="S4.E16.m1.5.5.1.1.1.1.3.3.2.3" xref="S4.E16.m1.5.5.1.1.1.1.3.3.2.3.cmml">i</mi><mrow id="S4.E16.m1.3.3.1.1" xref="S4.E16.m1.3.3.1.1.1.cmml"><mo id="S4.E16.m1.3.3.1.1.2" stretchy="false" xref="S4.E16.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.E16.m1.3.3.1.1.1" xref="S4.E16.m1.3.3.1.1.1.cmml"><mi id="S4.E16.m1.3.3.1.1.1.2" xref="S4.E16.m1.3.3.1.1.1.2.cmml">l</mi><mo id="S4.E16.m1.3.3.1.1.1.1" xref="S4.E16.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S4.E16.m1.3.3.1.1.1.3" xref="S4.E16.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E16.m1.3.3.1.1.3" stretchy="false" xref="S4.E16.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E16.m1.5.5.1.1.1.1.3.1a" xref="S4.E16.m1.5.5.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S4.E16.m1.5.5.1.1.1.1.3.4" xref="S4.E16.m1.5.5.1.1.1.1.3.4.cmml"><mi id="S4.E16.m1.5.5.1.1.1.1.3.4.2.2" xref="S4.E16.m1.5.5.1.1.1.1.3.4.2.2.cmml">𝐖</mi><mi id="S4.E16.m1.5.5.1.1.1.1.3.4.3" xref="S4.E16.m1.5.5.1.1.1.1.3.4.3.cmml">h</mi><mrow id="S4.E16.m1.4.4.1.3" xref="S4.E16.m1.5.5.1.1.1.1.3.4.cmml"><mo id="S4.E16.m1.4.4.1.3.1" stretchy="false" xref="S4.E16.m1.5.5.1.1.1.1.3.4.cmml">(</mo><mi id="S4.E16.m1.4.4.1.1" xref="S4.E16.m1.4.4.1.1.cmml">l</mi><mo id="S4.E16.m1.4.4.1.3.2" stretchy="false" xref="S4.E16.m1.5.5.1.1.1.1.3.4.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S4.E16.m1.5.5.1.1.1.3" stretchy="false" xref="S4.E16.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E16.m1.5b"><apply id="S4.E16.m1.5.5.cmml" xref="S4.E16.m1.5.5"><eq id="S4.E16.m1.5.5.2.cmml" xref="S4.E16.m1.5.5.2"></eq><apply id="S4.E16.m1.5.5.3.cmml" xref="S4.E16.m1.5.5.3"><csymbol cd="ambiguous" id="S4.E16.m1.5.5.3.1.cmml" xref="S4.E16.m1.5.5.3">subscript</csymbol><apply id="S4.E16.m1.5.5.3.2.cmml" xref="S4.E16.m1.5.5.3"><csymbol cd="ambiguous" id="S4.E16.m1.5.5.3.2.1.cmml" xref="S4.E16.m1.5.5.3">superscript</csymbol><ci id="S4.E16.m1.5.5.3.2.2.cmml" xref="S4.E16.m1.5.5.3.2.2">ℎ</ci><ci id="S4.E16.m1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1">𝑙</ci></apply><ci id="S4.E16.m1.5.5.3.3.cmml" xref="S4.E16.m1.5.5.3.3">𝑖</ci></apply><apply id="S4.E16.m1.5.5.1.cmml" xref="S4.E16.m1.5.5.1"><times id="S4.E16.m1.5.5.1.2.cmml" xref="S4.E16.m1.5.5.1.2"></times><ci id="S4.E16.m1.5.5.1.3.cmml" xref="S4.E16.m1.5.5.1.3">𝜎</ci><apply id="S4.E16.m1.5.5.1.1.1.1.cmml" xref="S4.E16.m1.5.5.1.1.1"><plus id="S4.E16.m1.5.5.1.1.1.1.1.cmml" xref="S4.E16.m1.5.5.1.1.1.1.1"></plus><apply id="S4.E16.m1.5.5.1.1.1.1.2.cmml" xref="S4.E16.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E16.m1.5.5.1.1.1.1.2.1.cmml" xref="S4.E16.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S4.E16.m1.5.5.1.1.1.1.2.2.cmml" xref="S4.E16.m1.5.5.1.1.1.1.2.2"><ci id="S4.E16.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S4.E16.m1.5.5.1.1.1.1.2.2.1">^</ci><apply id="S4.E16.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S4.E16.m1.5.5.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E16.m1.5.5.1.1.1.1.2.2.2.1.cmml" xref="S4.E16.m1.5.5.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E16.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="S4.E16.m1.5.5.1.1.1.1.2.2.2.2">ℎ</ci><ci id="S4.E16.m1.5.5.1.1.1.1.2.2.2.3.cmml" xref="S4.E16.m1.5.5.1.1.1.1.2.2.2.3">𝑖</ci></apply></apply><ci id="S4.E16.m1.2.2.1.1.cmml" xref="S4.E16.m1.2.2.1.1">𝑙</ci></apply><apply id="S4.E16.m1.5.5.1.1.1.1.3.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3"><times id="S4.E16.m1.5.5.1.1.1.1.3.1.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.1"></times><ci id="S4.E16.m1.5.5.1.1.1.1.3.2.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.2">𝛽</ci><apply id="S4.E16.m1.5.5.1.1.1.1.3.3.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E16.m1.5.5.1.1.1.1.3.3.1.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.3">superscript</csymbol><apply id="S4.E16.m1.5.5.1.1.1.1.3.3.2.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E16.m1.5.5.1.1.1.1.3.3.2.1.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E16.m1.5.5.1.1.1.1.3.3.2.2.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.3.2.2">ℎ</ci><ci id="S4.E16.m1.5.5.1.1.1.1.3.3.2.3.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.3.2.3">𝑖</ci></apply><apply id="S4.E16.m1.3.3.1.1.1.cmml" xref="S4.E16.m1.3.3.1.1"><minus id="S4.E16.m1.3.3.1.1.1.1.cmml" xref="S4.E16.m1.3.3.1.1.1.1"></minus><ci id="S4.E16.m1.3.3.1.1.1.2.cmml" xref="S4.E16.m1.3.3.1.1.1.2">𝑙</ci><cn id="S4.E16.m1.3.3.1.1.1.3.cmml" type="integer" xref="S4.E16.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="S4.E16.m1.5.5.1.1.1.1.3.4.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.E16.m1.5.5.1.1.1.1.3.4.1.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.4">subscript</csymbol><apply id="S4.E16.m1.5.5.1.1.1.1.3.4.2.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.E16.m1.5.5.1.1.1.1.3.4.2.1.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.4">superscript</csymbol><ci id="S4.E16.m1.5.5.1.1.1.1.3.4.2.2.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.4.2.2">𝐖</ci><ci id="S4.E16.m1.4.4.1.1.cmml" xref="S4.E16.m1.4.4.1.1">𝑙</ci></apply><ci id="S4.E16.m1.5.5.1.1.1.1.3.4.3.cmml" xref="S4.E16.m1.5.5.1.1.1.1.3.4.3">ℎ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.5c">h^{(l)}_{i}=\sigma(\hat{h_{i}}^{(l)}+\beta h_{i}^{(l-1)}\mathbf{W}^{(l)}_{h})</annotation><annotation encoding="application/x-llamapun" id="S4.E16.m1.5d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_σ ( over^ start_ARG italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT + italic_β italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px4.p3.3">where <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p3.2.m1.1"><semantics id="S4.SS2.SSS0.Px4.p3.2.m1.1a"><mrow id="S4.SS2.SSS0.Px4.p3.2.m1.1.2" xref="S4.SS2.SSS0.Px4.p3.2.m1.1.2.cmml"><mi id="S4.SS2.SSS0.Px4.p3.2.m1.1.2.2" xref="S4.SS2.SSS0.Px4.p3.2.m1.1.2.2.cmml">σ</mi><mo id="S4.SS2.SSS0.Px4.p3.2.m1.1.2.1" xref="S4.SS2.SSS0.Px4.p3.2.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS0.Px4.p3.2.m1.1.2.3.2" xref="S4.SS2.SSS0.Px4.p3.2.m1.1.2.cmml"><mo id="S4.SS2.SSS0.Px4.p3.2.m1.1.2.3.2.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p3.2.m1.1.2.cmml">(</mo><mo id="S4.SS2.SSS0.Px4.p3.2.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS2.SSS0.Px4.p3.2.m1.1.1.cmml">⋅</mo><mo id="S4.SS2.SSS0.Px4.p3.2.m1.1.2.3.2.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p3.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p3.2.m1.1b"><apply id="S4.SS2.SSS0.Px4.p3.2.m1.1.2.cmml" xref="S4.SS2.SSS0.Px4.p3.2.m1.1.2"><times id="S4.SS2.SSS0.Px4.p3.2.m1.1.2.1.cmml" xref="S4.SS2.SSS0.Px4.p3.2.m1.1.2.1"></times><ci id="S4.SS2.SSS0.Px4.p3.2.m1.1.2.2.cmml" xref="S4.SS2.SSS0.Px4.p3.2.m1.1.2.2">𝜎</ci><ci id="S4.SS2.SSS0.Px4.p3.2.m1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p3.2.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p3.2.m1.1c">\sigma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p3.2.m1.1d">italic_σ ( ⋅ )</annotation></semantics></math> is a non-linear activation function. <math alttext="\mathbf{W}^{(l)}_{h}\in\mathbb{R}^{D_{h}^{(l-1)}\times D_{h}^{(l)}}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px4.p3.3.m2.3"><semantics id="S4.SS2.SSS0.Px4.p3.3.m2.3a"><mrow id="S4.SS2.SSS0.Px4.p3.3.m2.3.4" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.cmml"><msubsup id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.cmml"><mi id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.2.2" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.2.2.cmml">𝐖</mi><mi id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.3" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px4.p3.3.m2.1.1.1.3" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.cmml"><mo id="S4.SS2.SSS0.Px4.p3.3.m2.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p3.3.m2.1.1.1.1" xref="S4.SS2.SSS0.Px4.p3.3.m2.1.1.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p3.3.m2.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.1" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.1.cmml">∈</mo><msup id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.3" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.3.cmml"><mi id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.3.2" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.cmml"><msubsup id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.cmml"><mi id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.2.2" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.2.2.cmml">D</mi><mi id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.2.3" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.2.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1" xref="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1" xref="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.2" xref="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.2.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.1" xref="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.3" xref="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.3" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.3.cmml">×</mo><msubsup id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.cmml"><mi id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.2.2" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.2.2.cmml">D</mi><mi id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.2.3" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.2.3.cmml">h</mi><mrow id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.2.1.3" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.cmml"><mo id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.2.1.3.1" stretchy="false" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.cmml">(</mo><mi id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.2.1.1" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.2.1.1.cmml">l</mi><mo id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.2.1.3.2" stretchy="false" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.cmml">)</mo></mrow></msubsup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px4.p3.3.m2.3b"><apply id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4"><in id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.1"></in><apply id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2">subscript</csymbol><apply id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.2.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.2.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2">superscript</csymbol><ci id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.2.2.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.2.2">𝐖</ci><ci id="S4.SS2.SSS0.Px4.p3.3.m2.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.1.1.1.1">𝑙</ci></apply><ci id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.3.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.2.3">ℎ</ci></apply><apply id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.3.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.3.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.3">superscript</csymbol><ci id="S4.SS2.SSS0.Px4.p3.3.m2.3.4.3.2.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.4.3.2">ℝ</ci><apply id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2"><times id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.3.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.3"></times><apply id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4">superscript</csymbol><apply id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.2.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.2.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4">subscript</csymbol><ci id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.2.2.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.2.2">𝐷</ci><ci id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.2.3.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.4.2.3">ℎ</ci></apply><apply id="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1"><minus id="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.1"></minus><ci id="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.2">𝑙</ci><cn id="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS0.Px4.p3.3.m2.2.2.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5">superscript</csymbol><apply id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.2.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.2.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5">subscript</csymbol><ci id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.2.2.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.2.2">𝐷</ci><ci id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.2.3.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.5.2.3">ℎ</ci></apply><ci id="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.2.1.1.cmml" xref="S4.SS2.SSS0.Px4.p3.3.m2.3.3.2.2.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px4.p3.3.m2.3c">\mathbf{W}^{(l)}_{h}\in\mathbb{R}^{D_{h}^{(l-1)}\times D_{h}^{(l)}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px4.p3.3.m2.3d">bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT × italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is propagation matrix.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Forward Propagation of Entity and Relation Embedding Matrix in Encoder</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l0.1.1.1" style="font-size:80%;">0:</span></span>  Knowledge Graph <math alttext="\mathcal{G=(E,R,T)}" class="ltx_Math" display="inline" id="alg1.l0.m1.3"><semantics id="alg1.l0.m1.3a"><mrow id="alg1.l0.m1.3.4" xref="alg1.l0.m1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m1.3.4.2" xref="alg1.l0.m1.3.4.2.cmml">𝒢</mi><mo id="alg1.l0.m1.3.4.1" xref="alg1.l0.m1.3.4.1.cmml">=</mo><mrow id="alg1.l0.m1.3.4.3.2" xref="alg1.l0.m1.3.4.3.1.cmml"><mo id="alg1.l0.m1.3.4.3.2.1" stretchy="false" xref="alg1.l0.m1.3.4.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">ℰ</mi><mo id="alg1.l0.m1.3.4.3.2.2" xref="alg1.l0.m1.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m1.2.2" xref="alg1.l0.m1.2.2.cmml">ℛ</mi><mo id="alg1.l0.m1.3.4.3.2.3" xref="alg1.l0.m1.3.4.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m1.3.3" xref="alg1.l0.m1.3.3.cmml">𝒯</mi><mo id="alg1.l0.m1.3.4.3.2.4" stretchy="false" xref="alg1.l0.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.3b"><apply id="alg1.l0.m1.3.4.cmml" xref="alg1.l0.m1.3.4"><eq id="alg1.l0.m1.3.4.1.cmml" xref="alg1.l0.m1.3.4.1"></eq><ci id="alg1.l0.m1.3.4.2.cmml" xref="alg1.l0.m1.3.4.2">𝒢</ci><vector id="alg1.l0.m1.3.4.3.1.cmml" xref="alg1.l0.m1.3.4.3.2"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">ℰ</ci><ci id="alg1.l0.m1.2.2.cmml" xref="alg1.l0.m1.2.2">ℛ</ci><ci id="alg1.l0.m1.3.3.cmml" xref="alg1.l0.m1.3.3">𝒯</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.3c">\mathcal{G=(E,R,T)}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.3d">caligraphic_G = ( caligraphic_E , caligraphic_R , caligraphic_T )</annotation></semantics></math>Initial entity embedding <math alttext="\mathbf{H}\in\mathbb{R}^{N_{e}\times D_{h}^{(0)}}" class="ltx_Math" display="inline" id="alg1.l0.m2.1"><semantics id="alg1.l0.m2.1a"><mrow id="alg1.l0.m2.1.2" xref="alg1.l0.m2.1.2.cmml"><mi id="alg1.l0.m2.1.2.2" xref="alg1.l0.m2.1.2.2.cmml">𝐇</mi><mo id="alg1.l0.m2.1.2.1" xref="alg1.l0.m2.1.2.1.cmml">∈</mo><msup id="alg1.l0.m2.1.2.3" xref="alg1.l0.m2.1.2.3.cmml"><mi id="alg1.l0.m2.1.2.3.2" xref="alg1.l0.m2.1.2.3.2.cmml">ℝ</mi><mrow id="alg1.l0.m2.1.1.1" xref="alg1.l0.m2.1.1.1.cmml"><msub id="alg1.l0.m2.1.1.1.3" xref="alg1.l0.m2.1.1.1.3.cmml"><mi id="alg1.l0.m2.1.1.1.3.2" xref="alg1.l0.m2.1.1.1.3.2.cmml">N</mi><mi id="alg1.l0.m2.1.1.1.3.3" xref="alg1.l0.m2.1.1.1.3.3.cmml">e</mi></msub><mo id="alg1.l0.m2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg1.l0.m2.1.1.1.2.cmml">×</mo><msubsup id="alg1.l0.m2.1.1.1.4" xref="alg1.l0.m2.1.1.1.4.cmml"><mi id="alg1.l0.m2.1.1.1.4.2.2" xref="alg1.l0.m2.1.1.1.4.2.2.cmml">D</mi><mi id="alg1.l0.m2.1.1.1.4.2.3" xref="alg1.l0.m2.1.1.1.4.2.3.cmml">h</mi><mrow id="alg1.l0.m2.1.1.1.1.1.3" xref="alg1.l0.m2.1.1.1.4.cmml"><mo id="alg1.l0.m2.1.1.1.1.1.3.1" stretchy="false" xref="alg1.l0.m2.1.1.1.4.cmml">(</mo><mn id="alg1.l0.m2.1.1.1.1.1.1" xref="alg1.l0.m2.1.1.1.1.1.1.cmml">0</mn><mo id="alg1.l0.m2.1.1.1.1.1.3.2" stretchy="false" xref="alg1.l0.m2.1.1.1.4.cmml">)</mo></mrow></msubsup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><apply id="alg1.l0.m2.1.2.cmml" xref="alg1.l0.m2.1.2"><in id="alg1.l0.m2.1.2.1.cmml" xref="alg1.l0.m2.1.2.1"></in><ci id="alg1.l0.m2.1.2.2.cmml" xref="alg1.l0.m2.1.2.2">𝐇</ci><apply id="alg1.l0.m2.1.2.3.cmml" xref="alg1.l0.m2.1.2.3"><csymbol cd="ambiguous" id="alg1.l0.m2.1.2.3.1.cmml" xref="alg1.l0.m2.1.2.3">superscript</csymbol><ci id="alg1.l0.m2.1.2.3.2.cmml" xref="alg1.l0.m2.1.2.3.2">ℝ</ci><apply id="alg1.l0.m2.1.1.1.cmml" xref="alg1.l0.m2.1.1.1"><times id="alg1.l0.m2.1.1.1.2.cmml" xref="alg1.l0.m2.1.1.1.2"></times><apply id="alg1.l0.m2.1.1.1.3.cmml" xref="alg1.l0.m2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.3.1.cmml" xref="alg1.l0.m2.1.1.1.3">subscript</csymbol><ci id="alg1.l0.m2.1.1.1.3.2.cmml" xref="alg1.l0.m2.1.1.1.3.2">𝑁</ci><ci id="alg1.l0.m2.1.1.1.3.3.cmml" xref="alg1.l0.m2.1.1.1.3.3">𝑒</ci></apply><apply id="alg1.l0.m2.1.1.1.4.cmml" xref="alg1.l0.m2.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.4.1.cmml" xref="alg1.l0.m2.1.1.1.4">superscript</csymbol><apply id="alg1.l0.m2.1.1.1.4.2.cmml" xref="alg1.l0.m2.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.4.2.1.cmml" xref="alg1.l0.m2.1.1.1.4">subscript</csymbol><ci id="alg1.l0.m2.1.1.1.4.2.2.cmml" xref="alg1.l0.m2.1.1.1.4.2.2">𝐷</ci><ci id="alg1.l0.m2.1.1.1.4.2.3.cmml" xref="alg1.l0.m2.1.1.1.4.2.3">ℎ</ci></apply><cn id="alg1.l0.m2.1.1.1.1.1.1.cmml" type="integer" xref="alg1.l0.m2.1.1.1.1.1.1">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">\mathbf{H}\in\mathbb{R}^{N_{e}\times D_{h}^{(0)}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">bold_H ∈ blackboard_R start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT × italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>Encoder layers <math alttext="L" class="ltx_Math" display="inline" id="alg1.l0.m3.1"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.1d">italic_L</annotation></semantics></math>Attention heads <math alttext="M" class="ltx_Math" display="inline" id="alg1.l0.m4.1"><semantics id="alg1.l0.m4.1a"><mi id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><ci id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">M</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m4.1d">italic_M</annotation></semantics></math>Self-loop coefficient <math alttext="\beta" class="ltx_Math" display="inline" id="alg1.l0.m5.1"><semantics id="alg1.l0.m5.1a"><mi id="alg1.l0.m5.1.1" xref="alg1.l0.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><ci id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m5.1d">italic_β</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l0a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l0a.1.1.1" style="font-size:80%;">0:</span></span>  Generic entity embedding <math alttext="\mathbf{H}\in\mathbb{R}^{N_{e}\times D_{h}^{(L)}}" class="ltx_Math" display="inline" id="alg1.l0a.m1.1"><semantics id="alg1.l0a.m1.1a"><mrow id="alg1.l0a.m1.1.2" xref="alg1.l0a.m1.1.2.cmml"><mi id="alg1.l0a.m1.1.2.2" xref="alg1.l0a.m1.1.2.2.cmml">𝐇</mi><mo id="alg1.l0a.m1.1.2.1" xref="alg1.l0a.m1.1.2.1.cmml">∈</mo><msup id="alg1.l0a.m1.1.2.3" xref="alg1.l0a.m1.1.2.3.cmml"><mi id="alg1.l0a.m1.1.2.3.2" xref="alg1.l0a.m1.1.2.3.2.cmml">ℝ</mi><mrow id="alg1.l0a.m1.1.1.1" xref="alg1.l0a.m1.1.1.1.cmml"><msub id="alg1.l0a.m1.1.1.1.3" xref="alg1.l0a.m1.1.1.1.3.cmml"><mi id="alg1.l0a.m1.1.1.1.3.2" xref="alg1.l0a.m1.1.1.1.3.2.cmml">N</mi><mi id="alg1.l0a.m1.1.1.1.3.3" xref="alg1.l0a.m1.1.1.1.3.3.cmml">e</mi></msub><mo id="alg1.l0a.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="alg1.l0a.m1.1.1.1.2.cmml">×</mo><msubsup id="alg1.l0a.m1.1.1.1.4" xref="alg1.l0a.m1.1.1.1.4.cmml"><mi id="alg1.l0a.m1.1.1.1.4.2.2" xref="alg1.l0a.m1.1.1.1.4.2.2.cmml">D</mi><mi id="alg1.l0a.m1.1.1.1.4.2.3" xref="alg1.l0a.m1.1.1.1.4.2.3.cmml">h</mi><mrow id="alg1.l0a.m1.1.1.1.1.1.3" xref="alg1.l0a.m1.1.1.1.4.cmml"><mo id="alg1.l0a.m1.1.1.1.1.1.3.1" stretchy="false" xref="alg1.l0a.m1.1.1.1.4.cmml">(</mo><mi id="alg1.l0a.m1.1.1.1.1.1.1" xref="alg1.l0a.m1.1.1.1.1.1.1.cmml">L</mi><mo id="alg1.l0a.m1.1.1.1.1.1.3.2" stretchy="false" xref="alg1.l0a.m1.1.1.1.4.cmml">)</mo></mrow></msubsup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><apply id="alg1.l0a.m1.1.2.cmml" xref="alg1.l0a.m1.1.2"><in id="alg1.l0a.m1.1.2.1.cmml" xref="alg1.l0a.m1.1.2.1"></in><ci id="alg1.l0a.m1.1.2.2.cmml" xref="alg1.l0a.m1.1.2.2">𝐇</ci><apply id="alg1.l0a.m1.1.2.3.cmml" xref="alg1.l0a.m1.1.2.3"><csymbol cd="ambiguous" id="alg1.l0a.m1.1.2.3.1.cmml" xref="alg1.l0a.m1.1.2.3">superscript</csymbol><ci id="alg1.l0a.m1.1.2.3.2.cmml" xref="alg1.l0a.m1.1.2.3.2">ℝ</ci><apply id="alg1.l0a.m1.1.1.1.cmml" xref="alg1.l0a.m1.1.1.1"><times id="alg1.l0a.m1.1.1.1.2.cmml" xref="alg1.l0a.m1.1.1.1.2"></times><apply id="alg1.l0a.m1.1.1.1.3.cmml" xref="alg1.l0a.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l0a.m1.1.1.1.3.1.cmml" xref="alg1.l0a.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l0a.m1.1.1.1.3.2.cmml" xref="alg1.l0a.m1.1.1.1.3.2">𝑁</ci><ci id="alg1.l0a.m1.1.1.1.3.3.cmml" xref="alg1.l0a.m1.1.1.1.3.3">𝑒</ci></apply><apply id="alg1.l0a.m1.1.1.1.4.cmml" xref="alg1.l0a.m1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l0a.m1.1.1.1.4.1.cmml" xref="alg1.l0a.m1.1.1.1.4">superscript</csymbol><apply id="alg1.l0a.m1.1.1.1.4.2.cmml" xref="alg1.l0a.m1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l0a.m1.1.1.1.4.2.1.cmml" xref="alg1.l0a.m1.1.1.1.4">subscript</csymbol><ci id="alg1.l0a.m1.1.1.1.4.2.2.cmml" xref="alg1.l0a.m1.1.1.1.4.2.2">𝐷</ci><ci id="alg1.l0a.m1.1.1.1.4.2.3.cmml" xref="alg1.l0a.m1.1.1.1.4.2.3">ℎ</ci></apply><ci id="alg1.l0a.m1.1.1.1.1.1.1.cmml" xref="alg1.l0a.m1.1.1.1.1.1.1">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">\mathbf{H}\in\mathbb{R}^{N_{e}\times D_{h}^{(L)}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m1.1d">bold_H ∈ blackboard_R start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT × italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l1.2">for</span> l from 1 to L <span class="ltx_text ltx_font_bold" id="alg1.l1.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l2.2">for</span> i from 1 to <math alttext="N_{e}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">N</mi><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑁</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">N_{e}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_N start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l2.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>        get all neighbors <math alttext="N_{i}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">N</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑁</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">N_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>        <span class="ltx_text ltx_font_bold" id="alg1.l4.2">for</span> m from 1 to M <span class="ltx_text ltx_font_bold" id="alg1.l4.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>           <span class="ltx_text ltx_font_bold" id="alg1.l5.2">for all</span> <math alttext="(v_{i},r_{r},v_{j})\in N_{i}" class="ltx_Math" display="inline" id="alg1.l5.m1.3"><semantics id="alg1.l5.m1.3a"><mrow id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml"><mrow id="alg1.l5.m1.3.3.3.3" xref="alg1.l5.m1.3.3.3.4.cmml"><mo id="alg1.l5.m1.3.3.3.3.4" stretchy="false" xref="alg1.l5.m1.3.3.3.4.cmml">(</mo><msub id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.2.cmml">v</mi><mi id="alg1.l5.m1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l5.m1.3.3.3.3.5" xref="alg1.l5.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l5.m1.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.cmml"><mi id="alg1.l5.m1.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.2.cmml">r</mi><mi id="alg1.l5.m1.2.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.2.3.cmml">r</mi></msub><mo id="alg1.l5.m1.3.3.3.3.6" xref="alg1.l5.m1.3.3.3.4.cmml">,</mo><msub id="alg1.l5.m1.3.3.3.3.3" xref="alg1.l5.m1.3.3.3.3.3.cmml"><mi id="alg1.l5.m1.3.3.3.3.3.2" xref="alg1.l5.m1.3.3.3.3.3.2.cmml">v</mi><mi id="alg1.l5.m1.3.3.3.3.3.3" xref="alg1.l5.m1.3.3.3.3.3.3.cmml">j</mi></msub><mo id="alg1.l5.m1.3.3.3.3.7" stretchy="false" xref="alg1.l5.m1.3.3.3.4.cmml">)</mo></mrow><mo id="alg1.l5.m1.3.3.4" xref="alg1.l5.m1.3.3.4.cmml">∈</mo><msub id="alg1.l5.m1.3.3.5" xref="alg1.l5.m1.3.3.5.cmml"><mi id="alg1.l5.m1.3.3.5.2" xref="alg1.l5.m1.3.3.5.2.cmml">N</mi><mi id="alg1.l5.m1.3.3.5.3" xref="alg1.l5.m1.3.3.5.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.3b"><apply id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3"><in id="alg1.l5.m1.3.3.4.cmml" xref="alg1.l5.m1.3.3.4"></in><vector id="alg1.l5.m1.3.3.3.4.cmml" xref="alg1.l5.m1.3.3.3.3"><apply id="alg1.l5.m1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.2">𝑣</ci><ci id="alg1.l5.m1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l5.m1.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2">𝑟</ci><ci id="alg1.l5.m1.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.3">𝑟</ci></apply><apply id="alg1.l5.m1.3.3.3.3.3.cmml" xref="alg1.l5.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.3.3.3.1.cmml" xref="alg1.l5.m1.3.3.3.3.3">subscript</csymbol><ci id="alg1.l5.m1.3.3.3.3.3.2.cmml" xref="alg1.l5.m1.3.3.3.3.3.2">𝑣</ci><ci id="alg1.l5.m1.3.3.3.3.3.3.cmml" xref="alg1.l5.m1.3.3.3.3.3.3">𝑗</ci></apply></vector><apply id="alg1.l5.m1.3.3.5.cmml" xref="alg1.l5.m1.3.3.5"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.5.1.cmml" xref="alg1.l5.m1.3.3.5">subscript</csymbol><ci id="alg1.l5.m1.3.3.5.2.cmml" xref="alg1.l5.m1.3.3.5.2">𝑁</ci><ci id="alg1.l5.m1.3.3.5.3.cmml" xref="alg1.l5.m1.3.3.5.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.3c">(v_{i},r_{r},v_{j})\in N_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.3d">( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ italic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l5.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>              <math alttext="\alpha^{(l)}_{(h)ij}\longleftarrow attention(\mathbf{h_{i}},\mathbf{h_{j}})" class="ltx_Math" display="inline" id="alg1.l6.m1.4"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml"><msubsup id="alg1.l6.m1.4.4.4" xref="alg1.l6.m1.4.4.4.cmml"><mi id="alg1.l6.m1.4.4.4.2.2" xref="alg1.l6.m1.4.4.4.2.2.cmml">α</mi><mrow id="alg1.l6.m1.2.2.1" xref="alg1.l6.m1.2.2.1.cmml"><mrow id="alg1.l6.m1.2.2.1.3.2" xref="alg1.l6.m1.2.2.1.cmml"><mo id="alg1.l6.m1.2.2.1.3.2.1" stretchy="false" xref="alg1.l6.m1.2.2.1.cmml">(</mo><mi id="alg1.l6.m1.2.2.1.1" xref="alg1.l6.m1.2.2.1.1.cmml">h</mi><mo id="alg1.l6.m1.2.2.1.3.2.2" stretchy="false" xref="alg1.l6.m1.2.2.1.cmml">)</mo></mrow><mo id="alg1.l6.m1.2.2.1.2" xref="alg1.l6.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.1.4" xref="alg1.l6.m1.2.2.1.4.cmml">i</mi><mo id="alg1.l6.m1.2.2.1.2a" xref="alg1.l6.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.1.5" xref="alg1.l6.m1.2.2.1.5.cmml">j</mi></mrow><mrow id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.4.4.4.cmml"><mo id="alg1.l6.m1.1.1.1.3.1" stretchy="false" xref="alg1.l6.m1.4.4.4.cmml">(</mo><mi id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml">l</mi><mo id="alg1.l6.m1.1.1.1.3.2" stretchy="false" xref="alg1.l6.m1.4.4.4.cmml">)</mo></mrow></msubsup><mo id="alg1.l6.m1.4.4.3" stretchy="false" xref="alg1.l6.m1.4.4.3.cmml">⟵</mo><mrow id="alg1.l6.m1.4.4.2" xref="alg1.l6.m1.4.4.2.cmml"><mi id="alg1.l6.m1.4.4.2.4" xref="alg1.l6.m1.4.4.2.4.cmml">a</mi><mo id="alg1.l6.m1.4.4.2.3" xref="alg1.l6.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.4.4.2.5" xref="alg1.l6.m1.4.4.2.5.cmml">t</mi><mo id="alg1.l6.m1.4.4.2.3a" xref="alg1.l6.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.4.4.2.6" xref="alg1.l6.m1.4.4.2.6.cmml">t</mi><mo id="alg1.l6.m1.4.4.2.3b" xref="alg1.l6.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.4.4.2.7" xref="alg1.l6.m1.4.4.2.7.cmml">e</mi><mo id="alg1.l6.m1.4.4.2.3c" xref="alg1.l6.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.4.4.2.8" xref="alg1.l6.m1.4.4.2.8.cmml">n</mi><mo id="alg1.l6.m1.4.4.2.3d" xref="alg1.l6.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.4.4.2.9" xref="alg1.l6.m1.4.4.2.9.cmml">t</mi><mo id="alg1.l6.m1.4.4.2.3e" xref="alg1.l6.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.4.4.2.10" xref="alg1.l6.m1.4.4.2.10.cmml">i</mi><mo id="alg1.l6.m1.4.4.2.3f" xref="alg1.l6.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.4.4.2.11" xref="alg1.l6.m1.4.4.2.11.cmml">o</mi><mo id="alg1.l6.m1.4.4.2.3g" xref="alg1.l6.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l6.m1.4.4.2.12" xref="alg1.l6.m1.4.4.2.12.cmml">n</mi><mo id="alg1.l6.m1.4.4.2.3h" xref="alg1.l6.m1.4.4.2.3.cmml">⁢</mo><mrow id="alg1.l6.m1.4.4.2.2.2" xref="alg1.l6.m1.4.4.2.2.3.cmml"><mo id="alg1.l6.m1.4.4.2.2.2.3" stretchy="false" xref="alg1.l6.m1.4.4.2.2.3.cmml">(</mo><msub id="alg1.l6.m1.3.3.1.1.1.1" xref="alg1.l6.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l6.m1.3.3.1.1.1.1.2" xref="alg1.l6.m1.3.3.1.1.1.1.2.cmml">𝐡</mi><mi id="alg1.l6.m1.3.3.1.1.1.1.3" xref="alg1.l6.m1.3.3.1.1.1.1.3.cmml">𝐢</mi></msub><mo id="alg1.l6.m1.4.4.2.2.2.4" xref="alg1.l6.m1.4.4.2.2.3.cmml">,</mo><msub id="alg1.l6.m1.4.4.2.2.2.2" xref="alg1.l6.m1.4.4.2.2.2.2.cmml"><mi id="alg1.l6.m1.4.4.2.2.2.2.2" xref="alg1.l6.m1.4.4.2.2.2.2.2.cmml">𝐡</mi><mi id="alg1.l6.m1.4.4.2.2.2.2.3" xref="alg1.l6.m1.4.4.2.2.2.2.3.cmml">𝐣</mi></msub><mo id="alg1.l6.m1.4.4.2.2.2.5" stretchy="false" xref="alg1.l6.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4"><ci id="alg1.l6.m1.4.4.3.cmml" xref="alg1.l6.m1.4.4.3">⟵</ci><apply id="alg1.l6.m1.4.4.4.cmml" xref="alg1.l6.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.4.1.cmml" xref="alg1.l6.m1.4.4.4">subscript</csymbol><apply id="alg1.l6.m1.4.4.4.2.cmml" xref="alg1.l6.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.4.2.1.cmml" xref="alg1.l6.m1.4.4.4">superscript</csymbol><ci id="alg1.l6.m1.4.4.4.2.2.cmml" xref="alg1.l6.m1.4.4.4.2.2">𝛼</ci><ci id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">𝑙</ci></apply><apply id="alg1.l6.m1.2.2.1.cmml" xref="alg1.l6.m1.2.2.1"><times id="alg1.l6.m1.2.2.1.2.cmml" xref="alg1.l6.m1.2.2.1.2"></times><ci id="alg1.l6.m1.2.2.1.1.cmml" xref="alg1.l6.m1.2.2.1.1">ℎ</ci><ci id="alg1.l6.m1.2.2.1.4.cmml" xref="alg1.l6.m1.2.2.1.4">𝑖</ci><ci id="alg1.l6.m1.2.2.1.5.cmml" xref="alg1.l6.m1.2.2.1.5">𝑗</ci></apply></apply><apply id="alg1.l6.m1.4.4.2.cmml" xref="alg1.l6.m1.4.4.2"><times id="alg1.l6.m1.4.4.2.3.cmml" xref="alg1.l6.m1.4.4.2.3"></times><ci id="alg1.l6.m1.4.4.2.4.cmml" xref="alg1.l6.m1.4.4.2.4">𝑎</ci><ci id="alg1.l6.m1.4.4.2.5.cmml" xref="alg1.l6.m1.4.4.2.5">𝑡</ci><ci id="alg1.l6.m1.4.4.2.6.cmml" xref="alg1.l6.m1.4.4.2.6">𝑡</ci><ci id="alg1.l6.m1.4.4.2.7.cmml" xref="alg1.l6.m1.4.4.2.7">𝑒</ci><ci id="alg1.l6.m1.4.4.2.8.cmml" xref="alg1.l6.m1.4.4.2.8">𝑛</ci><ci id="alg1.l6.m1.4.4.2.9.cmml" xref="alg1.l6.m1.4.4.2.9">𝑡</ci><ci id="alg1.l6.m1.4.4.2.10.cmml" xref="alg1.l6.m1.4.4.2.10">𝑖</ci><ci id="alg1.l6.m1.4.4.2.11.cmml" xref="alg1.l6.m1.4.4.2.11">𝑜</ci><ci id="alg1.l6.m1.4.4.2.12.cmml" xref="alg1.l6.m1.4.4.2.12">𝑛</ci><interval closure="open" id="alg1.l6.m1.4.4.2.2.3.cmml" xref="alg1.l6.m1.4.4.2.2.2"><apply id="alg1.l6.m1.3.3.1.1.1.1.cmml" xref="alg1.l6.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l6.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.2">𝐡</ci><ci id="alg1.l6.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l6.m1.3.3.1.1.1.1.3">𝐢</ci></apply><apply id="alg1.l6.m1.4.4.2.2.2.2.cmml" xref="alg1.l6.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l6.m1.4.4.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l6.m1.4.4.2.2.2.2.2">𝐡</ci><ci id="alg1.l6.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l6.m1.4.4.2.2.2.2.3">𝐣</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">\alpha^{(l)}_{(h)ij}\longleftarrow attention(\mathbf{h_{i}},\mathbf{h_{j}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.4d">italic_α start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i italic_j end_POSTSUBSCRIPT ⟵ italic_a italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ( bold_h start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT , bold_h start_POSTSUBSCRIPT bold_j end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>              <math alttext="\alpha^{(l)}_{(r)ij}\longleftarrow attention(joint(\mathbf{h_{i}},\mathbf{r_{r%
}}),joint(\mathbf{h_{j}},\mathbf{r_{r}}))" class="ltx_Math" display="inline" id="alg1.l7.m1.4"><semantics id="alg1.l7.m1.4a"><mrow id="alg1.l7.m1.4.4" xref="alg1.l7.m1.4.4.cmml"><msubsup id="alg1.l7.m1.4.4.4" xref="alg1.l7.m1.4.4.4.cmml"><mi id="alg1.l7.m1.4.4.4.2.2" xref="alg1.l7.m1.4.4.4.2.2.cmml">α</mi><mrow id="alg1.l7.m1.2.2.1" xref="alg1.l7.m1.2.2.1.cmml"><mrow id="alg1.l7.m1.2.2.1.3.2" xref="alg1.l7.m1.2.2.1.cmml"><mo id="alg1.l7.m1.2.2.1.3.2.1" stretchy="false" xref="alg1.l7.m1.2.2.1.cmml">(</mo><mi id="alg1.l7.m1.2.2.1.1" xref="alg1.l7.m1.2.2.1.1.cmml">r</mi><mo id="alg1.l7.m1.2.2.1.3.2.2" stretchy="false" xref="alg1.l7.m1.2.2.1.cmml">)</mo></mrow><mo id="alg1.l7.m1.2.2.1.2" xref="alg1.l7.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l7.m1.2.2.1.4" xref="alg1.l7.m1.2.2.1.4.cmml">i</mi><mo id="alg1.l7.m1.2.2.1.2a" xref="alg1.l7.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l7.m1.2.2.1.5" xref="alg1.l7.m1.2.2.1.5.cmml">j</mi></mrow><mrow id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.4.4.4.cmml"><mo id="alg1.l7.m1.1.1.1.3.1" stretchy="false" xref="alg1.l7.m1.4.4.4.cmml">(</mo><mi id="alg1.l7.m1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.cmml">l</mi><mo id="alg1.l7.m1.1.1.1.3.2" stretchy="false" xref="alg1.l7.m1.4.4.4.cmml">)</mo></mrow></msubsup><mo id="alg1.l7.m1.4.4.3" stretchy="false" xref="alg1.l7.m1.4.4.3.cmml">⟵</mo><mrow id="alg1.l7.m1.4.4.2" xref="alg1.l7.m1.4.4.2.cmml"><mi id="alg1.l7.m1.4.4.2.4" xref="alg1.l7.m1.4.4.2.4.cmml">a</mi><mo id="alg1.l7.m1.4.4.2.3" xref="alg1.l7.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.5" xref="alg1.l7.m1.4.4.2.5.cmml">t</mi><mo id="alg1.l7.m1.4.4.2.3a" xref="alg1.l7.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.6" xref="alg1.l7.m1.4.4.2.6.cmml">t</mi><mo id="alg1.l7.m1.4.4.2.3b" xref="alg1.l7.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.7" xref="alg1.l7.m1.4.4.2.7.cmml">e</mi><mo id="alg1.l7.m1.4.4.2.3c" xref="alg1.l7.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.8" xref="alg1.l7.m1.4.4.2.8.cmml">n</mi><mo id="alg1.l7.m1.4.4.2.3d" xref="alg1.l7.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.9" xref="alg1.l7.m1.4.4.2.9.cmml">t</mi><mo id="alg1.l7.m1.4.4.2.3e" xref="alg1.l7.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.10" xref="alg1.l7.m1.4.4.2.10.cmml">i</mi><mo id="alg1.l7.m1.4.4.2.3f" xref="alg1.l7.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.11" xref="alg1.l7.m1.4.4.2.11.cmml">o</mi><mo id="alg1.l7.m1.4.4.2.3g" xref="alg1.l7.m1.4.4.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.12" xref="alg1.l7.m1.4.4.2.12.cmml">n</mi><mo id="alg1.l7.m1.4.4.2.3h" xref="alg1.l7.m1.4.4.2.3.cmml">⁢</mo><mrow id="alg1.l7.m1.4.4.2.2.2" xref="alg1.l7.m1.4.4.2.2.3.cmml"><mo id="alg1.l7.m1.4.4.2.2.2.3" stretchy="false" xref="alg1.l7.m1.4.4.2.2.3.cmml">(</mo><mrow id="alg1.l7.m1.3.3.1.1.1.1" xref="alg1.l7.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l7.m1.3.3.1.1.1.1.4" xref="alg1.l7.m1.3.3.1.1.1.1.4.cmml">j</mi><mo id="alg1.l7.m1.3.3.1.1.1.1.3" xref="alg1.l7.m1.3.3.1.1.1.1.3.cmml">⁢</mo><mi id="alg1.l7.m1.3.3.1.1.1.1.5" xref="alg1.l7.m1.3.3.1.1.1.1.5.cmml">o</mi><mo id="alg1.l7.m1.3.3.1.1.1.1.3a" xref="alg1.l7.m1.3.3.1.1.1.1.3.cmml">⁢</mo><mi id="alg1.l7.m1.3.3.1.1.1.1.6" xref="alg1.l7.m1.3.3.1.1.1.1.6.cmml">i</mi><mo id="alg1.l7.m1.3.3.1.1.1.1.3b" xref="alg1.l7.m1.3.3.1.1.1.1.3.cmml">⁢</mo><mi id="alg1.l7.m1.3.3.1.1.1.1.7" xref="alg1.l7.m1.3.3.1.1.1.1.7.cmml">n</mi><mo id="alg1.l7.m1.3.3.1.1.1.1.3c" xref="alg1.l7.m1.3.3.1.1.1.1.3.cmml">⁢</mo><mi id="alg1.l7.m1.3.3.1.1.1.1.8" xref="alg1.l7.m1.3.3.1.1.1.1.8.cmml">t</mi><mo id="alg1.l7.m1.3.3.1.1.1.1.3d" xref="alg1.l7.m1.3.3.1.1.1.1.3.cmml">⁢</mo><mrow id="alg1.l7.m1.3.3.1.1.1.1.2.2" xref="alg1.l7.m1.3.3.1.1.1.1.2.3.cmml"><mo id="alg1.l7.m1.3.3.1.1.1.1.2.2.3" stretchy="false" xref="alg1.l7.m1.3.3.1.1.1.1.2.3.cmml">(</mo><msub id="alg1.l7.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l7.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.3.3.1.1.1.1.1.1.1.2" xref="alg1.l7.m1.3.3.1.1.1.1.1.1.1.2.cmml">𝐡</mi><mi id="alg1.l7.m1.3.3.1.1.1.1.1.1.1.3" xref="alg1.l7.m1.3.3.1.1.1.1.1.1.1.3.cmml">𝐢</mi></msub><mo id="alg1.l7.m1.3.3.1.1.1.1.2.2.4" xref="alg1.l7.m1.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l7.m1.3.3.1.1.1.1.2.2.2" xref="alg1.l7.m1.3.3.1.1.1.1.2.2.2.cmml"><mi id="alg1.l7.m1.3.3.1.1.1.1.2.2.2.2" xref="alg1.l7.m1.3.3.1.1.1.1.2.2.2.2.cmml">𝐫</mi><mi id="alg1.l7.m1.3.3.1.1.1.1.2.2.2.3" xref="alg1.l7.m1.3.3.1.1.1.1.2.2.2.3.cmml">𝐫</mi></msub><mo id="alg1.l7.m1.3.3.1.1.1.1.2.2.5" stretchy="false" xref="alg1.l7.m1.3.3.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l7.m1.4.4.2.2.2.4" xref="alg1.l7.m1.4.4.2.2.3.cmml">,</mo><mrow id="alg1.l7.m1.4.4.2.2.2.2" xref="alg1.l7.m1.4.4.2.2.2.2.cmml"><mi id="alg1.l7.m1.4.4.2.2.2.2.4" xref="alg1.l7.m1.4.4.2.2.2.2.4.cmml">j</mi><mo id="alg1.l7.m1.4.4.2.2.2.2.3" xref="alg1.l7.m1.4.4.2.2.2.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.2.2.2.5" xref="alg1.l7.m1.4.4.2.2.2.2.5.cmml">o</mi><mo id="alg1.l7.m1.4.4.2.2.2.2.3a" xref="alg1.l7.m1.4.4.2.2.2.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.2.2.2.6" xref="alg1.l7.m1.4.4.2.2.2.2.6.cmml">i</mi><mo id="alg1.l7.m1.4.4.2.2.2.2.3b" xref="alg1.l7.m1.4.4.2.2.2.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.2.2.2.7" xref="alg1.l7.m1.4.4.2.2.2.2.7.cmml">n</mi><mo id="alg1.l7.m1.4.4.2.2.2.2.3c" xref="alg1.l7.m1.4.4.2.2.2.2.3.cmml">⁢</mo><mi id="alg1.l7.m1.4.4.2.2.2.2.8" xref="alg1.l7.m1.4.4.2.2.2.2.8.cmml">t</mi><mo id="alg1.l7.m1.4.4.2.2.2.2.3d" xref="alg1.l7.m1.4.4.2.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l7.m1.4.4.2.2.2.2.2.2" xref="alg1.l7.m1.4.4.2.2.2.2.2.3.cmml"><mo id="alg1.l7.m1.4.4.2.2.2.2.2.2.3" stretchy="false" xref="alg1.l7.m1.4.4.2.2.2.2.2.3.cmml">(</mo><msub id="alg1.l7.m1.4.4.2.2.2.2.1.1.1" xref="alg1.l7.m1.4.4.2.2.2.2.1.1.1.cmml"><mi id="alg1.l7.m1.4.4.2.2.2.2.1.1.1.2" xref="alg1.l7.m1.4.4.2.2.2.2.1.1.1.2.cmml">𝐡</mi><mi id="alg1.l7.m1.4.4.2.2.2.2.1.1.1.3" xref="alg1.l7.m1.4.4.2.2.2.2.1.1.1.3.cmml">𝐣</mi></msub><mo id="alg1.l7.m1.4.4.2.2.2.2.2.2.4" xref="alg1.l7.m1.4.4.2.2.2.2.2.3.cmml">,</mo><msub id="alg1.l7.m1.4.4.2.2.2.2.2.2.2" xref="alg1.l7.m1.4.4.2.2.2.2.2.2.2.cmml"><mi id="alg1.l7.m1.4.4.2.2.2.2.2.2.2.2" xref="alg1.l7.m1.4.4.2.2.2.2.2.2.2.2.cmml">𝐫</mi><mi id="alg1.l7.m1.4.4.2.2.2.2.2.2.2.3" xref="alg1.l7.m1.4.4.2.2.2.2.2.2.2.3.cmml">𝐫</mi></msub><mo id="alg1.l7.m1.4.4.2.2.2.2.2.2.5" stretchy="false" xref="alg1.l7.m1.4.4.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l7.m1.4.4.2.2.2.5" stretchy="false" xref="alg1.l7.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.4b"><apply id="alg1.l7.m1.4.4.cmml" xref="alg1.l7.m1.4.4"><ci id="alg1.l7.m1.4.4.3.cmml" xref="alg1.l7.m1.4.4.3">⟵</ci><apply id="alg1.l7.m1.4.4.4.cmml" xref="alg1.l7.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.4.1.cmml" xref="alg1.l7.m1.4.4.4">subscript</csymbol><apply id="alg1.l7.m1.4.4.4.2.cmml" xref="alg1.l7.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.4.2.1.cmml" xref="alg1.l7.m1.4.4.4">superscript</csymbol><ci id="alg1.l7.m1.4.4.4.2.2.cmml" xref="alg1.l7.m1.4.4.4.2.2">𝛼</ci><ci id="alg1.l7.m1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1">𝑙</ci></apply><apply id="alg1.l7.m1.2.2.1.cmml" xref="alg1.l7.m1.2.2.1"><times id="alg1.l7.m1.2.2.1.2.cmml" xref="alg1.l7.m1.2.2.1.2"></times><ci id="alg1.l7.m1.2.2.1.1.cmml" xref="alg1.l7.m1.2.2.1.1">𝑟</ci><ci id="alg1.l7.m1.2.2.1.4.cmml" xref="alg1.l7.m1.2.2.1.4">𝑖</ci><ci id="alg1.l7.m1.2.2.1.5.cmml" xref="alg1.l7.m1.2.2.1.5">𝑗</ci></apply></apply><apply id="alg1.l7.m1.4.4.2.cmml" xref="alg1.l7.m1.4.4.2"><times id="alg1.l7.m1.4.4.2.3.cmml" xref="alg1.l7.m1.4.4.2.3"></times><ci id="alg1.l7.m1.4.4.2.4.cmml" xref="alg1.l7.m1.4.4.2.4">𝑎</ci><ci id="alg1.l7.m1.4.4.2.5.cmml" xref="alg1.l7.m1.4.4.2.5">𝑡</ci><ci id="alg1.l7.m1.4.4.2.6.cmml" xref="alg1.l7.m1.4.4.2.6">𝑡</ci><ci id="alg1.l7.m1.4.4.2.7.cmml" xref="alg1.l7.m1.4.4.2.7">𝑒</ci><ci id="alg1.l7.m1.4.4.2.8.cmml" xref="alg1.l7.m1.4.4.2.8">𝑛</ci><ci id="alg1.l7.m1.4.4.2.9.cmml" xref="alg1.l7.m1.4.4.2.9">𝑡</ci><ci id="alg1.l7.m1.4.4.2.10.cmml" xref="alg1.l7.m1.4.4.2.10">𝑖</ci><ci id="alg1.l7.m1.4.4.2.11.cmml" xref="alg1.l7.m1.4.4.2.11">𝑜</ci><ci id="alg1.l7.m1.4.4.2.12.cmml" xref="alg1.l7.m1.4.4.2.12">𝑛</ci><interval closure="open" id="alg1.l7.m1.4.4.2.2.3.cmml" xref="alg1.l7.m1.4.4.2.2.2"><apply id="alg1.l7.m1.3.3.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1"><times id="alg1.l7.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.3"></times><ci id="alg1.l7.m1.3.3.1.1.1.1.4.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.4">𝑗</ci><ci id="alg1.l7.m1.3.3.1.1.1.1.5.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.5">𝑜</ci><ci id="alg1.l7.m1.3.3.1.1.1.1.6.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.6">𝑖</ci><ci id="alg1.l7.m1.3.3.1.1.1.1.7.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.7">𝑛</ci><ci id="alg1.l7.m1.3.3.1.1.1.1.8.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.8">𝑡</ci><interval closure="open" id="alg1.l7.m1.3.3.1.1.1.1.2.3.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2.2"><apply id="alg1.l7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.1.1.1.2">𝐡</ci><ci id="alg1.l7.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.1.1.1.3">𝐢</ci></apply><apply id="alg1.l7.m1.3.3.1.1.1.1.2.2.2.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2.2.2.2">𝐫</ci><ci id="alg1.l7.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="alg1.l7.m1.3.3.1.1.1.1.2.2.2.3">𝐫</ci></apply></interval></apply><apply id="alg1.l7.m1.4.4.2.2.2.2.cmml" xref="alg1.l7.m1.4.4.2.2.2.2"><times id="alg1.l7.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.3"></times><ci id="alg1.l7.m1.4.4.2.2.2.2.4.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.4">𝑗</ci><ci id="alg1.l7.m1.4.4.2.2.2.2.5.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.5">𝑜</ci><ci id="alg1.l7.m1.4.4.2.2.2.2.6.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.6">𝑖</ci><ci id="alg1.l7.m1.4.4.2.2.2.2.7.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.7">𝑛</ci><ci id="alg1.l7.m1.4.4.2.2.2.2.8.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.8">𝑡</ci><interval closure="open" id="alg1.l7.m1.4.4.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.2.2"><apply id="alg1.l7.m1.4.4.2.2.2.2.1.1.1.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.2.2.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.1.1.1.2">𝐡</ci><ci id="alg1.l7.m1.4.4.2.2.2.2.1.1.1.3.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.1.1.1.3">𝐣</ci></apply><apply id="alg1.l7.m1.4.4.2.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.2.2.2.2.2.2.2.1.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.4.4.2.2.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.2.2.2.2">𝐫</ci><ci id="alg1.l7.m1.4.4.2.2.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.4.4.2.2.2.2.2.2.2.3">𝐫</ci></apply></interval></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.4c">\alpha^{(l)}_{(r)ij}\longleftarrow attention(joint(\mathbf{h_{i}},\mathbf{r_{r%
}}),joint(\mathbf{h_{j}},\mathbf{r_{r}}))</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.4d">italic_α start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i italic_j end_POSTSUBSCRIPT ⟵ italic_a italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ( italic_j italic_o italic_i italic_n italic_t ( bold_h start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT , bold_r start_POSTSUBSCRIPT bold_r end_POSTSUBSCRIPT ) , italic_j italic_o italic_i italic_n italic_t ( bold_h start_POSTSUBSCRIPT bold_j end_POSTSUBSCRIPT , bold_r start_POSTSUBSCRIPT bold_r end_POSTSUBSCRIPT ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>           <span class="ltx_text ltx_font_bold" id="alg1.l8.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l8.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>           get m-th head output: <math alttext="h^{(l)}_{(h)i}" class="ltx_Math" display="inline" id="alg1.l9.m1.2"><semantics id="alg1.l9.m1.2a"><msubsup id="alg1.l9.m1.2.3" xref="alg1.l9.m1.2.3.cmml"><mi id="alg1.l9.m1.2.3.2.2" xref="alg1.l9.m1.2.3.2.2.cmml">h</mi><mrow id="alg1.l9.m1.2.2.1" xref="alg1.l9.m1.2.2.1.cmml"><mrow id="alg1.l9.m1.2.2.1.3.2" xref="alg1.l9.m1.2.2.1.cmml"><mo id="alg1.l9.m1.2.2.1.3.2.1" stretchy="false" xref="alg1.l9.m1.2.2.1.cmml">(</mo><mi id="alg1.l9.m1.2.2.1.1" xref="alg1.l9.m1.2.2.1.1.cmml">h</mi><mo id="alg1.l9.m1.2.2.1.3.2.2" stretchy="false" xref="alg1.l9.m1.2.2.1.cmml">)</mo></mrow><mo id="alg1.l9.m1.2.2.1.2" xref="alg1.l9.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.1.4" xref="alg1.l9.m1.2.2.1.4.cmml">i</mi></mrow><mrow id="alg1.l9.m1.1.1.1.3" xref="alg1.l9.m1.2.3.cmml"><mo id="alg1.l9.m1.1.1.1.3.1" stretchy="false" xref="alg1.l9.m1.2.3.cmml">(</mo><mi id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml">l</mi><mo id="alg1.l9.m1.1.1.1.3.2" stretchy="false" xref="alg1.l9.m1.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.3.cmml" xref="alg1.l9.m1.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.3.1.cmml" xref="alg1.l9.m1.2.3">subscript</csymbol><apply id="alg1.l9.m1.2.3.2.cmml" xref="alg1.l9.m1.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.3.2.1.cmml" xref="alg1.l9.m1.2.3">superscript</csymbol><ci id="alg1.l9.m1.2.3.2.2.cmml" xref="alg1.l9.m1.2.3.2.2">ℎ</ci><ci id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1">𝑙</ci></apply><apply id="alg1.l9.m1.2.2.1.cmml" xref="alg1.l9.m1.2.2.1"><times id="alg1.l9.m1.2.2.1.2.cmml" xref="alg1.l9.m1.2.2.1.2"></times><ci id="alg1.l9.m1.2.2.1.1.cmml" xref="alg1.l9.m1.2.2.1.1">ℎ</ci><ci id="alg1.l9.m1.2.2.1.4.cmml" xref="alg1.l9.m1.2.2.1.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">h^{(l)}_{(h)i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.2d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_h ) italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="h^{(l)}_{(r)i}" class="ltx_Math" display="inline" id="alg1.l9.m2.2"><semantics id="alg1.l9.m2.2a"><msubsup id="alg1.l9.m2.2.3" xref="alg1.l9.m2.2.3.cmml"><mi id="alg1.l9.m2.2.3.2.2" xref="alg1.l9.m2.2.3.2.2.cmml">h</mi><mrow id="alg1.l9.m2.2.2.1" xref="alg1.l9.m2.2.2.1.cmml"><mrow id="alg1.l9.m2.2.2.1.3.2" xref="alg1.l9.m2.2.2.1.cmml"><mo id="alg1.l9.m2.2.2.1.3.2.1" stretchy="false" xref="alg1.l9.m2.2.2.1.cmml">(</mo><mi id="alg1.l9.m2.2.2.1.1" xref="alg1.l9.m2.2.2.1.1.cmml">r</mi><mo id="alg1.l9.m2.2.2.1.3.2.2" stretchy="false" xref="alg1.l9.m2.2.2.1.cmml">)</mo></mrow><mo id="alg1.l9.m2.2.2.1.2" xref="alg1.l9.m2.2.2.1.2.cmml">⁢</mo><mi id="alg1.l9.m2.2.2.1.4" xref="alg1.l9.m2.2.2.1.4.cmml">i</mi></mrow><mrow id="alg1.l9.m2.1.1.1.3" xref="alg1.l9.m2.2.3.cmml"><mo id="alg1.l9.m2.1.1.1.3.1" stretchy="false" xref="alg1.l9.m2.2.3.cmml">(</mo><mi id="alg1.l9.m2.1.1.1.1" xref="alg1.l9.m2.1.1.1.1.cmml">l</mi><mo id="alg1.l9.m2.1.1.1.3.2" stretchy="false" xref="alg1.l9.m2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.2b"><apply id="alg1.l9.m2.2.3.cmml" xref="alg1.l9.m2.2.3"><csymbol cd="ambiguous" id="alg1.l9.m2.2.3.1.cmml" xref="alg1.l9.m2.2.3">subscript</csymbol><apply id="alg1.l9.m2.2.3.2.cmml" xref="alg1.l9.m2.2.3"><csymbol cd="ambiguous" id="alg1.l9.m2.2.3.2.1.cmml" xref="alg1.l9.m2.2.3">superscript</csymbol><ci id="alg1.l9.m2.2.3.2.2.cmml" xref="alg1.l9.m2.2.3.2.2">ℎ</ci><ci id="alg1.l9.m2.1.1.1.1.cmml" xref="alg1.l9.m2.1.1.1.1">𝑙</ci></apply><apply id="alg1.l9.m2.2.2.1.cmml" xref="alg1.l9.m2.2.2.1"><times id="alg1.l9.m2.2.2.1.2.cmml" xref="alg1.l9.m2.2.2.1.2"></times><ci id="alg1.l9.m2.2.2.1.1.cmml" xref="alg1.l9.m2.2.2.1.1">𝑟</ci><ci id="alg1.l9.m2.2.2.1.4.cmml" xref="alg1.l9.m2.2.2.1.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.2c">h^{(l)}_{(r)i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.2d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_r ) italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>        <span class="ltx_text ltx_font_bold" id="alg1.l10.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l10.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>        <math alttext="\hat{h_{i}}^{(l)}\longleftarrow Aggregate(M)" class="ltx_Math" display="inline" id="alg1.l11.m1.2"><semantics id="alg1.l11.m1.2a"><mrow id="alg1.l11.m1.2.3" xref="alg1.l11.m1.2.3.cmml"><msup id="alg1.l11.m1.2.3.2" xref="alg1.l11.m1.2.3.2.cmml"><mover accent="true" id="alg1.l11.m1.2.3.2.2" xref="alg1.l11.m1.2.3.2.2.cmml"><msub id="alg1.l11.m1.2.3.2.2.2" xref="alg1.l11.m1.2.3.2.2.2.cmml"><mi id="alg1.l11.m1.2.3.2.2.2.2" xref="alg1.l11.m1.2.3.2.2.2.2.cmml">h</mi><mi id="alg1.l11.m1.2.3.2.2.2.3" xref="alg1.l11.m1.2.3.2.2.2.3.cmml">i</mi></msub><mo id="alg1.l11.m1.2.3.2.2.1" xref="alg1.l11.m1.2.3.2.2.1.cmml">^</mo></mover><mrow id="alg1.l11.m1.1.1.1.3" xref="alg1.l11.m1.2.3.2.cmml"><mo id="alg1.l11.m1.1.1.1.3.1" stretchy="false" xref="alg1.l11.m1.2.3.2.cmml">(</mo><mi id="alg1.l11.m1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.cmml">l</mi><mo id="alg1.l11.m1.1.1.1.3.2" stretchy="false" xref="alg1.l11.m1.2.3.2.cmml">)</mo></mrow></msup><mo id="alg1.l11.m1.2.3.1" stretchy="false" xref="alg1.l11.m1.2.3.1.cmml">⟵</mo><mrow id="alg1.l11.m1.2.3.3" xref="alg1.l11.m1.2.3.3.cmml"><mi id="alg1.l11.m1.2.3.3.2" xref="alg1.l11.m1.2.3.3.2.cmml">A</mi><mo id="alg1.l11.m1.2.3.3.1" xref="alg1.l11.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.3.3.3" xref="alg1.l11.m1.2.3.3.3.cmml">g</mi><mo id="alg1.l11.m1.2.3.3.1a" xref="alg1.l11.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.3.3.4" xref="alg1.l11.m1.2.3.3.4.cmml">g</mi><mo id="alg1.l11.m1.2.3.3.1b" xref="alg1.l11.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.3.3.5" xref="alg1.l11.m1.2.3.3.5.cmml">r</mi><mo id="alg1.l11.m1.2.3.3.1c" xref="alg1.l11.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.3.3.6" xref="alg1.l11.m1.2.3.3.6.cmml">e</mi><mo id="alg1.l11.m1.2.3.3.1d" xref="alg1.l11.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.3.3.7" xref="alg1.l11.m1.2.3.3.7.cmml">g</mi><mo id="alg1.l11.m1.2.3.3.1e" xref="alg1.l11.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.3.3.8" xref="alg1.l11.m1.2.3.3.8.cmml">a</mi><mo id="alg1.l11.m1.2.3.3.1f" xref="alg1.l11.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.3.3.9" xref="alg1.l11.m1.2.3.3.9.cmml">t</mi><mo id="alg1.l11.m1.2.3.3.1g" xref="alg1.l11.m1.2.3.3.1.cmml">⁢</mo><mi id="alg1.l11.m1.2.3.3.10" xref="alg1.l11.m1.2.3.3.10.cmml">e</mi><mo id="alg1.l11.m1.2.3.3.1h" xref="alg1.l11.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l11.m1.2.3.3.11.2" xref="alg1.l11.m1.2.3.3.cmml"><mo id="alg1.l11.m1.2.3.3.11.2.1" stretchy="false" xref="alg1.l11.m1.2.3.3.cmml">(</mo><mi id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml">M</mi><mo id="alg1.l11.m1.2.3.3.11.2.2" stretchy="false" xref="alg1.l11.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.2b"><apply id="alg1.l11.m1.2.3.cmml" xref="alg1.l11.m1.2.3"><ci id="alg1.l11.m1.2.3.1.cmml" xref="alg1.l11.m1.2.3.1">⟵</ci><apply id="alg1.l11.m1.2.3.2.cmml" xref="alg1.l11.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.2.3.2.1.cmml" xref="alg1.l11.m1.2.3.2">superscript</csymbol><apply id="alg1.l11.m1.2.3.2.2.cmml" xref="alg1.l11.m1.2.3.2.2"><ci id="alg1.l11.m1.2.3.2.2.1.cmml" xref="alg1.l11.m1.2.3.2.2.1">^</ci><apply id="alg1.l11.m1.2.3.2.2.2.cmml" xref="alg1.l11.m1.2.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.2.3.2.2.2.1.cmml" xref="alg1.l11.m1.2.3.2.2.2">subscript</csymbol><ci id="alg1.l11.m1.2.3.2.2.2.2.cmml" xref="alg1.l11.m1.2.3.2.2.2.2">ℎ</ci><ci id="alg1.l11.m1.2.3.2.2.2.3.cmml" xref="alg1.l11.m1.2.3.2.2.2.3">𝑖</ci></apply></apply><ci id="alg1.l11.m1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1">𝑙</ci></apply><apply id="alg1.l11.m1.2.3.3.cmml" xref="alg1.l11.m1.2.3.3"><times id="alg1.l11.m1.2.3.3.1.cmml" xref="alg1.l11.m1.2.3.3.1"></times><ci id="alg1.l11.m1.2.3.3.2.cmml" xref="alg1.l11.m1.2.3.3.2">𝐴</ci><ci id="alg1.l11.m1.2.3.3.3.cmml" xref="alg1.l11.m1.2.3.3.3">𝑔</ci><ci id="alg1.l11.m1.2.3.3.4.cmml" xref="alg1.l11.m1.2.3.3.4">𝑔</ci><ci id="alg1.l11.m1.2.3.3.5.cmml" xref="alg1.l11.m1.2.3.3.5">𝑟</ci><ci id="alg1.l11.m1.2.3.3.6.cmml" xref="alg1.l11.m1.2.3.3.6">𝑒</ci><ci id="alg1.l11.m1.2.3.3.7.cmml" xref="alg1.l11.m1.2.3.3.7">𝑔</ci><ci id="alg1.l11.m1.2.3.3.8.cmml" xref="alg1.l11.m1.2.3.3.8">𝑎</ci><ci id="alg1.l11.m1.2.3.3.9.cmml" xref="alg1.l11.m1.2.3.3.9">𝑡</ci><ci id="alg1.l11.m1.2.3.3.10.cmml" xref="alg1.l11.m1.2.3.3.10">𝑒</ci><ci id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.2c">\hat{h_{i}}^{(l)}\longleftarrow Aggregate(M)</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.2d">over^ start_ARG italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ⟵ italic_A italic_g italic_g italic_r italic_e italic_g italic_a italic_t italic_e ( italic_M )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>        <math alttext="h^{(l)}_{i}=\sigma(\hat{h_{i}}^{(l)}+\beta h_{i}^{(l-1)}\mathbf{W}^{(l)}_{h})" class="ltx_Math" display="inline" id="alg1.l12.m1.5"><semantics id="alg1.l12.m1.5a"><mrow id="alg1.l12.m1.5.5" xref="alg1.l12.m1.5.5.cmml"><msubsup id="alg1.l12.m1.5.5.3" xref="alg1.l12.m1.5.5.3.cmml"><mi id="alg1.l12.m1.5.5.3.2.2" xref="alg1.l12.m1.5.5.3.2.2.cmml">h</mi><mi id="alg1.l12.m1.5.5.3.3" xref="alg1.l12.m1.5.5.3.3.cmml">i</mi><mrow id="alg1.l12.m1.1.1.1.3" xref="alg1.l12.m1.5.5.3.cmml"><mo id="alg1.l12.m1.1.1.1.3.1" stretchy="false" xref="alg1.l12.m1.5.5.3.cmml">(</mo><mi id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml">l</mi><mo id="alg1.l12.m1.1.1.1.3.2" stretchy="false" xref="alg1.l12.m1.5.5.3.cmml">)</mo></mrow></msubsup><mo id="alg1.l12.m1.5.5.2" xref="alg1.l12.m1.5.5.2.cmml">=</mo><mrow id="alg1.l12.m1.5.5.1" xref="alg1.l12.m1.5.5.1.cmml"><mi id="alg1.l12.m1.5.5.1.3" xref="alg1.l12.m1.5.5.1.3.cmml">σ</mi><mo id="alg1.l12.m1.5.5.1.2" xref="alg1.l12.m1.5.5.1.2.cmml">⁢</mo><mrow id="alg1.l12.m1.5.5.1.1.1" xref="alg1.l12.m1.5.5.1.1.1.1.cmml"><mo id="alg1.l12.m1.5.5.1.1.1.2" stretchy="false" xref="alg1.l12.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="alg1.l12.m1.5.5.1.1.1.1" xref="alg1.l12.m1.5.5.1.1.1.1.cmml"><msup id="alg1.l12.m1.5.5.1.1.1.1.2" xref="alg1.l12.m1.5.5.1.1.1.1.2.cmml"><mover accent="true" id="alg1.l12.m1.5.5.1.1.1.1.2.2" xref="alg1.l12.m1.5.5.1.1.1.1.2.2.cmml"><msub id="alg1.l12.m1.5.5.1.1.1.1.2.2.2" xref="alg1.l12.m1.5.5.1.1.1.1.2.2.2.cmml"><mi id="alg1.l12.m1.5.5.1.1.1.1.2.2.2.2" xref="alg1.l12.m1.5.5.1.1.1.1.2.2.2.2.cmml">h</mi><mi id="alg1.l12.m1.5.5.1.1.1.1.2.2.2.3" xref="alg1.l12.m1.5.5.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="alg1.l12.m1.5.5.1.1.1.1.2.2.1" xref="alg1.l12.m1.5.5.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="alg1.l12.m1.2.2.1.3" xref="alg1.l12.m1.5.5.1.1.1.1.2.cmml"><mo id="alg1.l12.m1.2.2.1.3.1" stretchy="false" xref="alg1.l12.m1.5.5.1.1.1.1.2.cmml">(</mo><mi id="alg1.l12.m1.2.2.1.1" xref="alg1.l12.m1.2.2.1.1.cmml">l</mi><mo id="alg1.l12.m1.2.2.1.3.2" stretchy="false" xref="alg1.l12.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="alg1.l12.m1.5.5.1.1.1.1.1" xref="alg1.l12.m1.5.5.1.1.1.1.1.cmml">+</mo><mrow id="alg1.l12.m1.5.5.1.1.1.1.3" xref="alg1.l12.m1.5.5.1.1.1.1.3.cmml"><mi id="alg1.l12.m1.5.5.1.1.1.1.3.2" xref="alg1.l12.m1.5.5.1.1.1.1.3.2.cmml">β</mi><mo id="alg1.l12.m1.5.5.1.1.1.1.3.1" xref="alg1.l12.m1.5.5.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="alg1.l12.m1.5.5.1.1.1.1.3.3" xref="alg1.l12.m1.5.5.1.1.1.1.3.3.cmml"><mi id="alg1.l12.m1.5.5.1.1.1.1.3.3.2.2" xref="alg1.l12.m1.5.5.1.1.1.1.3.3.2.2.cmml">h</mi><mi id="alg1.l12.m1.5.5.1.1.1.1.3.3.2.3" xref="alg1.l12.m1.5.5.1.1.1.1.3.3.2.3.cmml">i</mi><mrow id="alg1.l12.m1.3.3.1.1" xref="alg1.l12.m1.3.3.1.1.1.cmml"><mo id="alg1.l12.m1.3.3.1.1.2" stretchy="false" xref="alg1.l12.m1.3.3.1.1.1.cmml">(</mo><mrow id="alg1.l12.m1.3.3.1.1.1" xref="alg1.l12.m1.3.3.1.1.1.cmml"><mi id="alg1.l12.m1.3.3.1.1.1.2" xref="alg1.l12.m1.3.3.1.1.1.2.cmml">l</mi><mo id="alg1.l12.m1.3.3.1.1.1.1" xref="alg1.l12.m1.3.3.1.1.1.1.cmml">−</mo><mn id="alg1.l12.m1.3.3.1.1.1.3" xref="alg1.l12.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l12.m1.3.3.1.1.3" stretchy="false" xref="alg1.l12.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l12.m1.5.5.1.1.1.1.3.1a" xref="alg1.l12.m1.5.5.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="alg1.l12.m1.5.5.1.1.1.1.3.4" xref="alg1.l12.m1.5.5.1.1.1.1.3.4.cmml"><mi id="alg1.l12.m1.5.5.1.1.1.1.3.4.2.2" xref="alg1.l12.m1.5.5.1.1.1.1.3.4.2.2.cmml">𝐖</mi><mi id="alg1.l12.m1.5.5.1.1.1.1.3.4.3" xref="alg1.l12.m1.5.5.1.1.1.1.3.4.3.cmml">h</mi><mrow id="alg1.l12.m1.4.4.1.3" xref="alg1.l12.m1.5.5.1.1.1.1.3.4.cmml"><mo id="alg1.l12.m1.4.4.1.3.1" stretchy="false" xref="alg1.l12.m1.5.5.1.1.1.1.3.4.cmml">(</mo><mi id="alg1.l12.m1.4.4.1.1" xref="alg1.l12.m1.4.4.1.1.cmml">l</mi><mo id="alg1.l12.m1.4.4.1.3.2" stretchy="false" xref="alg1.l12.m1.5.5.1.1.1.1.3.4.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="alg1.l12.m1.5.5.1.1.1.3" stretchy="false" xref="alg1.l12.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.5b"><apply id="alg1.l12.m1.5.5.cmml" xref="alg1.l12.m1.5.5"><eq id="alg1.l12.m1.5.5.2.cmml" xref="alg1.l12.m1.5.5.2"></eq><apply id="alg1.l12.m1.5.5.3.cmml" xref="alg1.l12.m1.5.5.3"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.3.1.cmml" xref="alg1.l12.m1.5.5.3">subscript</csymbol><apply id="alg1.l12.m1.5.5.3.2.cmml" xref="alg1.l12.m1.5.5.3"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.3.2.1.cmml" xref="alg1.l12.m1.5.5.3">superscript</csymbol><ci id="alg1.l12.m1.5.5.3.2.2.cmml" xref="alg1.l12.m1.5.5.3.2.2">ℎ</ci><ci id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1">𝑙</ci></apply><ci id="alg1.l12.m1.5.5.3.3.cmml" xref="alg1.l12.m1.5.5.3.3">𝑖</ci></apply><apply id="alg1.l12.m1.5.5.1.cmml" xref="alg1.l12.m1.5.5.1"><times id="alg1.l12.m1.5.5.1.2.cmml" xref="alg1.l12.m1.5.5.1.2"></times><ci id="alg1.l12.m1.5.5.1.3.cmml" xref="alg1.l12.m1.5.5.1.3">𝜎</ci><apply id="alg1.l12.m1.5.5.1.1.1.1.cmml" xref="alg1.l12.m1.5.5.1.1.1"><plus id="alg1.l12.m1.5.5.1.1.1.1.1.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.1"></plus><apply id="alg1.l12.m1.5.5.1.1.1.1.2.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.1.1.1.1.2.1.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="alg1.l12.m1.5.5.1.1.1.1.2.2.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.2.2"><ci id="alg1.l12.m1.5.5.1.1.1.1.2.2.1.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.2.2.1">^</ci><apply id="alg1.l12.m1.5.5.1.1.1.1.2.2.2.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.1.1.1.1.2.2.2.1.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l12.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.2.2.2.2">ℎ</ci><ci id="alg1.l12.m1.5.5.1.1.1.1.2.2.2.3.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.2.2.2.3">𝑖</ci></apply></apply><ci id="alg1.l12.m1.2.2.1.1.cmml" xref="alg1.l12.m1.2.2.1.1">𝑙</ci></apply><apply id="alg1.l12.m1.5.5.1.1.1.1.3.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3"><times id="alg1.l12.m1.5.5.1.1.1.1.3.1.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.1"></times><ci id="alg1.l12.m1.5.5.1.1.1.1.3.2.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.2">𝛽</ci><apply id="alg1.l12.m1.5.5.1.1.1.1.3.3.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.1.1.1.1.3.3.1.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.3">superscript</csymbol><apply id="alg1.l12.m1.5.5.1.1.1.1.3.3.2.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.1.1.1.1.3.3.2.1.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l12.m1.5.5.1.1.1.1.3.3.2.2.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.3.2.2">ℎ</ci><ci id="alg1.l12.m1.5.5.1.1.1.1.3.3.2.3.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.3.2.3">𝑖</ci></apply><apply id="alg1.l12.m1.3.3.1.1.1.cmml" xref="alg1.l12.m1.3.3.1.1"><minus id="alg1.l12.m1.3.3.1.1.1.1.cmml" xref="alg1.l12.m1.3.3.1.1.1.1"></minus><ci id="alg1.l12.m1.3.3.1.1.1.2.cmml" xref="alg1.l12.m1.3.3.1.1.1.2">𝑙</ci><cn id="alg1.l12.m1.3.3.1.1.1.3.cmml" type="integer" xref="alg1.l12.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="alg1.l12.m1.5.5.1.1.1.1.3.4.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.1.1.1.1.3.4.1.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.4">subscript</csymbol><apply id="alg1.l12.m1.5.5.1.1.1.1.3.4.2.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l12.m1.5.5.1.1.1.1.3.4.2.1.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.4">superscript</csymbol><ci id="alg1.l12.m1.5.5.1.1.1.1.3.4.2.2.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.4.2.2">𝐖</ci><ci id="alg1.l12.m1.4.4.1.1.cmml" xref="alg1.l12.m1.4.4.1.1">𝑙</ci></apply><ci id="alg1.l12.m1.5.5.1.1.1.1.3.4.3.cmml" xref="alg1.l12.m1.5.5.1.1.1.1.3.4.3">ℎ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.5c">h^{(l)}_{i}=\sigma(\hat{h_{i}}^{(l)}+\beta h_{i}^{(l-1)}\mathbf{W}^{(l)}_{h})</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.5d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_σ ( over^ start_ARG italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT + italic_β italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span>     <span class="ltx_text ltx_font_bold" id="alg1.l13.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l13.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l14.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l14.3">for</span>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Decoder</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">GATH can adopt any knowledge graph embedding model’s decoder, such as TransE or ConvE, etc. Our decoder is implemented based on ConvE, which uses 2D convolutions to model KGs and has better performance in predicting highly connected entities. In addition, inspired by semantic matching-based models, our decoder additionally introduces relation-based entity feature transformation to accurately evaluate the plausibility of triples.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.3">Our encoder generates entity embeddings <math alttext="\mathbf{H}" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">bold_H</annotation></semantics></math> and feeds them into the decoder. The decoder defines the relation embedding matrix <math alttext="\mathbf{R}\in\mathbb{R}^{N_{r}\times D_{h}^{(l)}}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mrow id="S4.SS3.p2.2.m2.1.2" xref="S4.SS3.p2.2.m2.1.2.cmml"><mi id="S4.SS3.p2.2.m2.1.2.2" xref="S4.SS3.p2.2.m2.1.2.2.cmml">𝐑</mi><mo id="S4.SS3.p2.2.m2.1.2.1" xref="S4.SS3.p2.2.m2.1.2.1.cmml">∈</mo><msup id="S4.SS3.p2.2.m2.1.2.3" xref="S4.SS3.p2.2.m2.1.2.3.cmml"><mi id="S4.SS3.p2.2.m2.1.2.3.2" xref="S4.SS3.p2.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p2.2.m2.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.cmml"><msub id="S4.SS3.p2.2.m2.1.1.1.3" xref="S4.SS3.p2.2.m2.1.1.1.3.cmml"><mi id="S4.SS3.p2.2.m2.1.1.1.3.2" xref="S4.SS3.p2.2.m2.1.1.1.3.2.cmml">N</mi><mi id="S4.SS3.p2.2.m2.1.1.1.3.3" xref="S4.SS3.p2.2.m2.1.1.1.3.3.cmml">r</mi></msub><mo id="S4.SS3.p2.2.m2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.2.m2.1.1.1.2.cmml">×</mo><msubsup id="S4.SS3.p2.2.m2.1.1.1.4" xref="S4.SS3.p2.2.m2.1.1.1.4.cmml"><mi id="S4.SS3.p2.2.m2.1.1.1.4.2.2" xref="S4.SS3.p2.2.m2.1.1.1.4.2.2.cmml">D</mi><mi id="S4.SS3.p2.2.m2.1.1.1.4.2.3" xref="S4.SS3.p2.2.m2.1.1.1.4.2.3.cmml">h</mi><mrow id="S4.SS3.p2.2.m2.1.1.1.1.1.3" xref="S4.SS3.p2.2.m2.1.1.1.4.cmml"><mo id="S4.SS3.p2.2.m2.1.1.1.1.1.3.1" stretchy="false" xref="S4.SS3.p2.2.m2.1.1.1.4.cmml">(</mo><mi id="S4.SS3.p2.2.m2.1.1.1.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.1.1.1.cmml">l</mi><mo id="S4.SS3.p2.2.m2.1.1.1.1.1.3.2" stretchy="false" xref="S4.SS3.p2.2.m2.1.1.1.4.cmml">)</mo></mrow></msubsup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.2.cmml" xref="S4.SS3.p2.2.m2.1.2"><in id="S4.SS3.p2.2.m2.1.2.1.cmml" xref="S4.SS3.p2.2.m2.1.2.1"></in><ci id="S4.SS3.p2.2.m2.1.2.2.cmml" xref="S4.SS3.p2.2.m2.1.2.2">𝐑</ci><apply id="S4.SS3.p2.2.m2.1.2.3.cmml" xref="S4.SS3.p2.2.m2.1.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.2.3.1.cmml" xref="S4.SS3.p2.2.m2.1.2.3">superscript</csymbol><ci id="S4.SS3.p2.2.m2.1.2.3.2.cmml" xref="S4.SS3.p2.2.m2.1.2.3.2">ℝ</ci><apply id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1"><times id="S4.SS3.p2.2.m2.1.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.1.2"></times><apply id="S4.SS3.p2.2.m2.1.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.3.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.1.3.2.cmml" xref="S4.SS3.p2.2.m2.1.1.1.3.2">𝑁</ci><ci id="S4.SS3.p2.2.m2.1.1.1.3.3.cmml" xref="S4.SS3.p2.2.m2.1.1.1.3.3">𝑟</ci></apply><apply id="S4.SS3.p2.2.m2.1.1.1.4.cmml" xref="S4.SS3.p2.2.m2.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.4.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1.4">superscript</csymbol><apply id="S4.SS3.p2.2.m2.1.1.1.4.2.cmml" xref="S4.SS3.p2.2.m2.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.4.2.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1.4">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.1.4.2.2.cmml" xref="S4.SS3.p2.2.m2.1.1.1.4.2.2">𝐷</ci><ci id="S4.SS3.p2.2.m2.1.1.1.4.2.3.cmml" xref="S4.SS3.p2.2.m2.1.1.1.4.2.3">ℎ</ci></apply><ci id="S4.SS3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1.1.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\mathbf{R}\in\mathbb{R}^{N_{r}\times D_{h}^{(l)}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">bold_R ∈ blackboard_R start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT × italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, initialized with Gaussian distribution sampling. The <math alttext="STACK" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1"><semantics id="S4.SS3.p2.3.m3.1a"><mrow id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">S</mi><mo id="S4.SS3.p2.3.m3.1.1.1" xref="S4.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml">T</mi><mo id="S4.SS3.p2.3.m3.1.1.1a" xref="S4.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p2.3.m3.1.1.4" xref="S4.SS3.p2.3.m3.1.1.4.cmml">A</mi><mo id="S4.SS3.p2.3.m3.1.1.1b" xref="S4.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p2.3.m3.1.1.5" xref="S4.SS3.p2.3.m3.1.1.5.cmml">C</mi><mo id="S4.SS3.p2.3.m3.1.1.1c" xref="S4.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p2.3.m3.1.1.6" xref="S4.SS3.p2.3.m3.1.1.6.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><times id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1.1"></times><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">𝑆</ci><ci id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3">𝑇</ci><ci id="S4.SS3.p2.3.m3.1.1.4.cmml" xref="S4.SS3.p2.3.m3.1.1.4">𝐴</ci><ci id="S4.SS3.p2.3.m3.1.1.5.cmml" xref="S4.SS3.p2.3.m3.1.1.5">𝐶</ci><ci id="S4.SS3.p2.3.m3.1.1.6.cmml" xref="S4.SS3.p2.3.m3.1.1.6">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">STACK</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">italic_S italic_T italic_A italic_C italic_K</annotation></semantics></math> operation, which will concatenate a sequence of vectors on the first dimension, is performed on the entity embeddings, relation embeddings, and their transformed features to obtain the input. Then, we feed this input into a convolutional neural network to make predictions as shown below,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(17)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\text{input}=\text{STACK}(\mathbf{h},\mathbf{r},\mathbf{h\odot r}%
)\end{split}" class="ltx_Math" display="block" id="S4.E17.m1.14"><semantics id="S4.E17.m1.14a"><mtable displaystyle="true" id="S4.E17.m1.14.14.2" xref="S4.E17.m1.13.13.1.cmml"><mtr id="S4.E17.m1.14.14.2a" xref="S4.E17.m1.13.13.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S4.E17.m1.14.14.2b" xref="S4.E17.m1.13.13.1.cmml"><mrow id="S4.E17.m1.14.14.2.13.13.13" xref="S4.E17.m1.13.13.1.cmml"><mtext id="S4.E17.m1.1.1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.1.1a.cmml">input</mtext><mo id="S4.E17.m1.2.2.2.2.2.2" xref="S4.E17.m1.2.2.2.2.2.2.cmml">=</mo><mrow id="S4.E17.m1.14.14.2.13.13.13.13" xref="S4.E17.m1.13.13.1.cmml"><mtext id="S4.E17.m1.3.3.3.3.3.3" xref="S4.E17.m1.3.3.3.3.3.3a.cmml">STACK</mtext><mo id="S4.E17.m1.14.14.2.13.13.13.13.2" xref="S4.E17.m1.13.13.1.cmml">⁢</mo><mrow id="S4.E17.m1.14.14.2.13.13.13.13.1.1" xref="S4.E17.m1.13.13.1.cmml"><mo id="S4.E17.m1.4.4.4.4.4.4" stretchy="false" xref="S4.E17.m1.13.13.1.cmml">(</mo><mi id="S4.E17.m1.5.5.5.5.5.5" xref="S4.E17.m1.5.5.5.5.5.5.cmml">𝐡</mi><mo id="S4.E17.m1.6.6.6.6.6.6" xref="S4.E17.m1.13.13.1.cmml">,</mo><mi id="S4.E17.m1.7.7.7.7.7.7" xref="S4.E17.m1.7.7.7.7.7.7.cmml">𝐫</mi><mo id="S4.E17.m1.8.8.8.8.8.8" xref="S4.E17.m1.13.13.1.cmml">,</mo><mrow id="S4.E17.m1.14.14.2.13.13.13.13.1.1.1" xref="S4.E17.m1.13.13.1.cmml"><mi id="S4.E17.m1.9.9.9.9.9.9" xref="S4.E17.m1.9.9.9.9.9.9.cmml">𝐡</mi><mo id="S4.E17.m1.10.10.10.10.10.10" lspace="0.222em" rspace="0.222em" xref="S4.E17.m1.10.10.10.10.10.10.cmml">⊙</mo><mi id="S4.E17.m1.11.11.11.11.11.11" xref="S4.E17.m1.11.11.11.11.11.11.cmml">𝐫</mi></mrow><mo id="S4.E17.m1.12.12.12.12.12.12" stretchy="false" xref="S4.E17.m1.13.13.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E17.m1.14b"><apply id="S4.E17.m1.13.13.1.cmml" xref="S4.E17.m1.14.14.2"><eq id="S4.E17.m1.2.2.2.2.2.2.cmml" xref="S4.E17.m1.2.2.2.2.2.2"></eq><ci id="S4.E17.m1.1.1.1.1.1.1a.cmml" xref="S4.E17.m1.1.1.1.1.1.1"><mtext id="S4.E17.m1.1.1.1.1.1.1.cmml" xref="S4.E17.m1.1.1.1.1.1.1">input</mtext></ci><apply id="S4.E17.m1.13.13.1.1.cmml" xref="S4.E17.m1.14.14.2"><times id="S4.E17.m1.13.13.1.1.2.cmml" xref="S4.E17.m1.14.14.2"></times><ci id="S4.E17.m1.3.3.3.3.3.3a.cmml" xref="S4.E17.m1.3.3.3.3.3.3"><mtext id="S4.E17.m1.3.3.3.3.3.3.cmml" xref="S4.E17.m1.3.3.3.3.3.3">STACK</mtext></ci><vector id="S4.E17.m1.13.13.1.1.1.2.cmml" xref="S4.E17.m1.14.14.2"><ci id="S4.E17.m1.5.5.5.5.5.5.cmml" xref="S4.E17.m1.5.5.5.5.5.5">𝐡</ci><ci id="S4.E17.m1.7.7.7.7.7.7.cmml" xref="S4.E17.m1.7.7.7.7.7.7">𝐫</ci><apply id="S4.E17.m1.13.13.1.1.1.1.1.cmml" xref="S4.E17.m1.14.14.2"><csymbol cd="latexml" id="S4.E17.m1.10.10.10.10.10.10.cmml" xref="S4.E17.m1.10.10.10.10.10.10">direct-product</csymbol><ci id="S4.E17.m1.9.9.9.9.9.9.cmml" xref="S4.E17.m1.9.9.9.9.9.9">𝐡</ci><ci id="S4.E17.m1.11.11.11.11.11.11.cmml" xref="S4.E17.m1.11.11.11.11.11.11">𝐫</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E17.m1.14c">\begin{split}\text{input}=\text{STACK}(\mathbf{h},\mathbf{r},\mathbf{h\odot r}%
)\end{split}</annotation><annotation encoding="application/x-llamapun" id="S4.E17.m1.14d">start_ROW start_CELL input = STACK ( bold_h , bold_r , bold_h ⊙ bold_r ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(18)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="g(h,r,t)=\sigma(vec((\overline{\text{input}}\ast\omega))\mathbf{W})\mathbf{t}" class="ltx_Math" display="block" id="S4.E18.m1.4"><semantics id="S4.E18.m1.4a"><mrow id="S4.E18.m1.4.4" xref="S4.E18.m1.4.4.cmml"><mrow id="S4.E18.m1.4.4.3" xref="S4.E18.m1.4.4.3.cmml"><mi id="S4.E18.m1.4.4.3.2" xref="S4.E18.m1.4.4.3.2.cmml">g</mi><mo id="S4.E18.m1.4.4.3.1" xref="S4.E18.m1.4.4.3.1.cmml">⁢</mo><mrow id="S4.E18.m1.4.4.3.3.2" xref="S4.E18.m1.4.4.3.3.1.cmml"><mo id="S4.E18.m1.4.4.3.3.2.1" stretchy="false" xref="S4.E18.m1.4.4.3.3.1.cmml">(</mo><mi id="S4.E18.m1.1.1" xref="S4.E18.m1.1.1.cmml">h</mi><mo id="S4.E18.m1.4.4.3.3.2.2" xref="S4.E18.m1.4.4.3.3.1.cmml">,</mo><mi id="S4.E18.m1.2.2" xref="S4.E18.m1.2.2.cmml">r</mi><mo id="S4.E18.m1.4.4.3.3.2.3" xref="S4.E18.m1.4.4.3.3.1.cmml">,</mo><mi id="S4.E18.m1.3.3" xref="S4.E18.m1.3.3.cmml">t</mi><mo id="S4.E18.m1.4.4.3.3.2.4" stretchy="false" xref="S4.E18.m1.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E18.m1.4.4.2" xref="S4.E18.m1.4.4.2.cmml">=</mo><mrow id="S4.E18.m1.4.4.1" xref="S4.E18.m1.4.4.1.cmml"><mi id="S4.E18.m1.4.4.1.3" xref="S4.E18.m1.4.4.1.3.cmml">σ</mi><mo id="S4.E18.m1.4.4.1.2" xref="S4.E18.m1.4.4.1.2.cmml">⁢</mo><mrow id="S4.E18.m1.4.4.1.1.1" xref="S4.E18.m1.4.4.1.1.1.1.cmml"><mo id="S4.E18.m1.4.4.1.1.1.2" stretchy="false" xref="S4.E18.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.E18.m1.4.4.1.1.1.1" xref="S4.E18.m1.4.4.1.1.1.1.cmml"><mi id="S4.E18.m1.4.4.1.1.1.1.3" xref="S4.E18.m1.4.4.1.1.1.1.3.cmml">v</mi><mo id="S4.E18.m1.4.4.1.1.1.1.2" xref="S4.E18.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E18.m1.4.4.1.1.1.1.4" xref="S4.E18.m1.4.4.1.1.1.1.4.cmml">e</mi><mo id="S4.E18.m1.4.4.1.1.1.1.2a" xref="S4.E18.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E18.m1.4.4.1.1.1.1.5" xref="S4.E18.m1.4.4.1.1.1.1.5.cmml">c</mi><mo id="S4.E18.m1.4.4.1.1.1.1.2b" xref="S4.E18.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E18.m1.4.4.1.1.1.1.1.1" xref="S4.E18.m1.4.4.1.1.1.1.cmml"><mo id="S4.E18.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S4.E18.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mtext id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.2a.cmml">input</mtext><mo id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml">¯</mo></mover><mo id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">∗</mo><mi id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">ω</mi></mrow><mo id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E18.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S4.E18.m1.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E18.m1.4.4.1.1.1.1.2c" xref="S4.E18.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E18.m1.4.4.1.1.1.1.6" xref="S4.E18.m1.4.4.1.1.1.1.6.cmml">𝐖</mi></mrow><mo id="S4.E18.m1.4.4.1.1.1.3" stretchy="false" xref="S4.E18.m1.4.4.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E18.m1.4.4.1.2a" xref="S4.E18.m1.4.4.1.2.cmml">⁢</mo><mi id="S4.E18.m1.4.4.1.4" xref="S4.E18.m1.4.4.1.4.cmml">𝐭</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E18.m1.4b"><apply id="S4.E18.m1.4.4.cmml" xref="S4.E18.m1.4.4"><eq id="S4.E18.m1.4.4.2.cmml" xref="S4.E18.m1.4.4.2"></eq><apply id="S4.E18.m1.4.4.3.cmml" xref="S4.E18.m1.4.4.3"><times id="S4.E18.m1.4.4.3.1.cmml" xref="S4.E18.m1.4.4.3.1"></times><ci id="S4.E18.m1.4.4.3.2.cmml" xref="S4.E18.m1.4.4.3.2">𝑔</ci><vector id="S4.E18.m1.4.4.3.3.1.cmml" xref="S4.E18.m1.4.4.3.3.2"><ci id="S4.E18.m1.1.1.cmml" xref="S4.E18.m1.1.1">ℎ</ci><ci id="S4.E18.m1.2.2.cmml" xref="S4.E18.m1.2.2">𝑟</ci><ci id="S4.E18.m1.3.3.cmml" xref="S4.E18.m1.3.3">𝑡</ci></vector></apply><apply id="S4.E18.m1.4.4.1.cmml" xref="S4.E18.m1.4.4.1"><times id="S4.E18.m1.4.4.1.2.cmml" xref="S4.E18.m1.4.4.1.2"></times><ci id="S4.E18.m1.4.4.1.3.cmml" xref="S4.E18.m1.4.4.1.3">𝜎</ci><apply id="S4.E18.m1.4.4.1.1.1.1.cmml" xref="S4.E18.m1.4.4.1.1.1"><times id="S4.E18.m1.4.4.1.1.1.1.2.cmml" xref="S4.E18.m1.4.4.1.1.1.1.2"></times><ci id="S4.E18.m1.4.4.1.1.1.1.3.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3">𝑣</ci><ci id="S4.E18.m1.4.4.1.1.1.1.4.cmml" xref="S4.E18.m1.4.4.1.1.1.1.4">𝑒</ci><ci id="S4.E18.m1.4.4.1.1.1.1.5.cmml" xref="S4.E18.m1.4.4.1.1.1.1.5">𝑐</ci><apply id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1"><ci id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.1">∗</ci><apply id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2"><ci id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.1">¯</ci><ci id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.2"><mtext id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.2.2">input</mtext></ci></apply><ci id="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E18.m1.4.4.1.1.1.1.1.1.1.1.1.3">𝜔</ci></apply><ci id="S4.E18.m1.4.4.1.1.1.1.6.cmml" xref="S4.E18.m1.4.4.1.1.1.1.6">𝐖</ci></apply><ci id="S4.E18.m1.4.4.1.4.cmml" xref="S4.E18.m1.4.4.1.4">𝐭</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E18.m1.4c">g(h,r,t)=\sigma(vec((\overline{\text{input}}\ast\omega))\mathbf{W})\mathbf{t}</annotation><annotation encoding="application/x-llamapun" id="S4.E18.m1.4d">italic_g ( italic_h , italic_r , italic_t ) = italic_σ ( italic_v italic_e italic_c ( ( over¯ start_ARG input end_ARG ∗ italic_ω ) ) bold_W ) bold_t</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p2.8">where <math alttext="\overline{\cdot}" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m1.1"><semantics id="S4.SS3.p2.4.m1.1a"><mover accent="true" id="S4.SS3.p2.4.m1.1.1" xref="S4.SS3.p2.4.m1.1.1.cmml"><mo id="S4.SS3.p2.4.m1.1.1.2" xref="S4.SS3.p2.4.m1.1.1.2.cmml">⋅</mo><mo id="S4.SS3.p2.4.m1.1.1.1" xref="S4.SS3.p2.4.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m1.1b"><apply id="S4.SS3.p2.4.m1.1.1.cmml" xref="S4.SS3.p2.4.m1.1.1"><ci id="S4.SS3.p2.4.m1.1.1.1.cmml" xref="S4.SS3.p2.4.m1.1.1.1">¯</ci><ci id="S4.SS3.p2.4.m1.1.1.2.cmml" xref="S4.SS3.p2.4.m1.1.1.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m1.1c">\overline{\cdot}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m1.1d">over¯ start_ARG ⋅ end_ARG</annotation></semantics></math> converts each <math alttext="D_{h}" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m2.1"><semantics id="S4.SS3.p2.5.m2.1a"><msub id="S4.SS3.p2.5.m2.1.1" xref="S4.SS3.p2.5.m2.1.1.cmml"><mi id="S4.SS3.p2.5.m2.1.1.2" xref="S4.SS3.p2.5.m2.1.1.2.cmml">D</mi><mi id="S4.SS3.p2.5.m2.1.1.3" xref="S4.SS3.p2.5.m2.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m2.1b"><apply id="S4.SS3.p2.5.m2.1.1.cmml" xref="S4.SS3.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m2.1.1.1.cmml" xref="S4.SS3.p2.5.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.5.m2.1.1.2.cmml" xref="S4.SS3.p2.5.m2.1.1.2">𝐷</ci><ci id="S4.SS3.p2.5.m2.1.1.3.cmml" xref="S4.SS3.p2.5.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m2.1c">D_{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m2.1d">italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>-dimensional vector into a matrix with dimensions <math alttext="d_{w}" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m3.1"><semantics id="S4.SS3.p2.6.m3.1a"><msub id="S4.SS3.p2.6.m3.1.1" xref="S4.SS3.p2.6.m3.1.1.cmml"><mi id="S4.SS3.p2.6.m3.1.1.2" xref="S4.SS3.p2.6.m3.1.1.2.cmml">d</mi><mi id="S4.SS3.p2.6.m3.1.1.3" xref="S4.SS3.p2.6.m3.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m3.1b"><apply id="S4.SS3.p2.6.m3.1.1.cmml" xref="S4.SS3.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m3.1.1.1.cmml" xref="S4.SS3.p2.6.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.6.m3.1.1.2.cmml" xref="S4.SS3.p2.6.m3.1.1.2">𝑑</ci><ci id="S4.SS3.p2.6.m3.1.1.3.cmml" xref="S4.SS3.p2.6.m3.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m3.1c">d_{w}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m3.1d">italic_d start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="d_{h}" class="ltx_Math" display="inline" id="S4.SS3.p2.7.m4.1"><semantics id="S4.SS3.p2.7.m4.1a"><msub id="S4.SS3.p2.7.m4.1.1" xref="S4.SS3.p2.7.m4.1.1.cmml"><mi id="S4.SS3.p2.7.m4.1.1.2" xref="S4.SS3.p2.7.m4.1.1.2.cmml">d</mi><mi id="S4.SS3.p2.7.m4.1.1.3" xref="S4.SS3.p2.7.m4.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m4.1b"><apply id="S4.SS3.p2.7.m4.1.1.cmml" xref="S4.SS3.p2.7.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m4.1.1.1.cmml" xref="S4.SS3.p2.7.m4.1.1">subscript</csymbol><ci id="S4.SS3.p2.7.m4.1.1.2.cmml" xref="S4.SS3.p2.7.m4.1.1.2">𝑑</ci><ci id="S4.SS3.p2.7.m4.1.1.3.cmml" xref="S4.SS3.p2.7.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m4.1c">d_{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.7.m4.1d">italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> where <math alttext="D_{h}=d_{w}\times d_{h}" class="ltx_Math" display="inline" id="S4.SS3.p2.8.m5.1"><semantics id="S4.SS3.p2.8.m5.1a"><mrow id="S4.SS3.p2.8.m5.1.1" xref="S4.SS3.p2.8.m5.1.1.cmml"><msub id="S4.SS3.p2.8.m5.1.1.2" xref="S4.SS3.p2.8.m5.1.1.2.cmml"><mi id="S4.SS3.p2.8.m5.1.1.2.2" xref="S4.SS3.p2.8.m5.1.1.2.2.cmml">D</mi><mi id="S4.SS3.p2.8.m5.1.1.2.3" xref="S4.SS3.p2.8.m5.1.1.2.3.cmml">h</mi></msub><mo id="S4.SS3.p2.8.m5.1.1.1" xref="S4.SS3.p2.8.m5.1.1.1.cmml">=</mo><mrow id="S4.SS3.p2.8.m5.1.1.3" xref="S4.SS3.p2.8.m5.1.1.3.cmml"><msub id="S4.SS3.p2.8.m5.1.1.3.2" xref="S4.SS3.p2.8.m5.1.1.3.2.cmml"><mi id="S4.SS3.p2.8.m5.1.1.3.2.2" xref="S4.SS3.p2.8.m5.1.1.3.2.2.cmml">d</mi><mi id="S4.SS3.p2.8.m5.1.1.3.2.3" xref="S4.SS3.p2.8.m5.1.1.3.2.3.cmml">w</mi></msub><mo id="S4.SS3.p2.8.m5.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.8.m5.1.1.3.1.cmml">×</mo><msub id="S4.SS3.p2.8.m5.1.1.3.3" xref="S4.SS3.p2.8.m5.1.1.3.3.cmml"><mi id="S4.SS3.p2.8.m5.1.1.3.3.2" xref="S4.SS3.p2.8.m5.1.1.3.3.2.cmml">d</mi><mi id="S4.SS3.p2.8.m5.1.1.3.3.3" xref="S4.SS3.p2.8.m5.1.1.3.3.3.cmml">h</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m5.1b"><apply id="S4.SS3.p2.8.m5.1.1.cmml" xref="S4.SS3.p2.8.m5.1.1"><eq id="S4.SS3.p2.8.m5.1.1.1.cmml" xref="S4.SS3.p2.8.m5.1.1.1"></eq><apply id="S4.SS3.p2.8.m5.1.1.2.cmml" xref="S4.SS3.p2.8.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m5.1.1.2.1.cmml" xref="S4.SS3.p2.8.m5.1.1.2">subscript</csymbol><ci id="S4.SS3.p2.8.m5.1.1.2.2.cmml" xref="S4.SS3.p2.8.m5.1.1.2.2">𝐷</ci><ci id="S4.SS3.p2.8.m5.1.1.2.3.cmml" xref="S4.SS3.p2.8.m5.1.1.2.3">ℎ</ci></apply><apply id="S4.SS3.p2.8.m5.1.1.3.cmml" xref="S4.SS3.p2.8.m5.1.1.3"><times id="S4.SS3.p2.8.m5.1.1.3.1.cmml" xref="S4.SS3.p2.8.m5.1.1.3.1"></times><apply id="S4.SS3.p2.8.m5.1.1.3.2.cmml" xref="S4.SS3.p2.8.m5.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m5.1.1.3.2.1.cmml" xref="S4.SS3.p2.8.m5.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p2.8.m5.1.1.3.2.2.cmml" xref="S4.SS3.p2.8.m5.1.1.3.2.2">𝑑</ci><ci id="S4.SS3.p2.8.m5.1.1.3.2.3.cmml" xref="S4.SS3.p2.8.m5.1.1.3.2.3">𝑤</ci></apply><apply id="S4.SS3.p2.8.m5.1.1.3.3.cmml" xref="S4.SS3.p2.8.m5.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m5.1.1.3.3.1.cmml" xref="S4.SS3.p2.8.m5.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p2.8.m5.1.1.3.3.2.cmml" xref="S4.SS3.p2.8.m5.1.1.3.3.2">𝑑</ci><ci id="S4.SS3.p2.8.m5.1.1.3.3.3.cmml" xref="S4.SS3.p2.8.m5.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m5.1c">D_{h}=d_{w}\times d_{h}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.8.m5.1d">italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT = italic_d start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.14">In the feed-forward stage, firstly, each vector in the input is reshaped into a 2D matrix. They are then fed into a 2D convolutional layer with kernel <math alttext="\omega" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">italic_ω</annotation></semantics></math>, which will produce a feature map tensor <math alttext="\mathcal{F}\in\mathbb{R}^{c\times m\times n}" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><mrow id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">ℱ</mi><mo id="S4.SS3.p3.2.m2.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.3.2" xref="S4.SS3.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p3.2.m2.1.1.3.3" xref="S4.SS3.p3.2.m2.1.1.3.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.3.3.2" xref="S4.SS3.p3.2.m2.1.1.3.3.2.cmml">c</mi><mo id="S4.SS3.p3.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p3.2.m2.1.1.3.3.3" xref="S4.SS3.p3.2.m2.1.1.3.3.3.cmml">m</mi><mo id="S4.SS3.p3.2.m2.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p3.2.m2.1.1.3.3.4" xref="S4.SS3.p3.2.m2.1.1.3.3.4.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><in id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1"></in><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">ℱ</ci><apply id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.2.m2.1.1.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3"><times id="S4.SS3.p3.2.m2.1.1.3.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.1"></times><ci id="S4.SS3.p3.2.m2.1.1.3.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.2">𝑐</ci><ci id="S4.SS3.p3.2.m2.1.1.3.3.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.3">𝑚</ci><ci id="S4.SS3.p3.2.m2.1.1.3.3.4.cmml" xref="S4.SS3.p3.2.m2.1.1.3.3.4">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">\mathcal{F}\in\mathbb{R}^{c\times m\times n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">caligraphic_F ∈ blackboard_R start_POSTSUPERSCRIPT italic_c × italic_m × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>. <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.1"><semantics id="S4.SS3.p3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><ci id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.1d">caligraphic_F</annotation></semantics></math> contains <math alttext="c" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m4.1"><semantics id="S4.SS3.p3.4.m4.1a"><mi id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><ci id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">c</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m4.1d">italic_c</annotation></semantics></math> feature maps with dimensions <math alttext="m" class="ltx_Math" display="inline" id="S4.SS3.p3.5.m5.1"><semantics id="S4.SS3.p3.5.m5.1a"><mi id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><ci id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.5.m5.1d">italic_m</annotation></semantics></math> and <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p3.6.m6.1"><semantics id="S4.SS3.p3.6.m6.1a"><mi id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b"><ci id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.6.m6.1d">italic_n</annotation></semantics></math>. Secondly, the <math alttext="vec(\cdot)" class="ltx_Math" display="inline" id="S4.SS3.p3.7.m7.1"><semantics id="S4.SS3.p3.7.m7.1a"><mrow id="S4.SS3.p3.7.m7.1.2" xref="S4.SS3.p3.7.m7.1.2.cmml"><mi id="S4.SS3.p3.7.m7.1.2.2" xref="S4.SS3.p3.7.m7.1.2.2.cmml">v</mi><mo id="S4.SS3.p3.7.m7.1.2.1" xref="S4.SS3.p3.7.m7.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p3.7.m7.1.2.3" xref="S4.SS3.p3.7.m7.1.2.3.cmml">e</mi><mo id="S4.SS3.p3.7.m7.1.2.1a" xref="S4.SS3.p3.7.m7.1.2.1.cmml">⁢</mo><mi id="S4.SS3.p3.7.m7.1.2.4" xref="S4.SS3.p3.7.m7.1.2.4.cmml">c</mi><mo id="S4.SS3.p3.7.m7.1.2.1b" xref="S4.SS3.p3.7.m7.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.p3.7.m7.1.2.5.2" xref="S4.SS3.p3.7.m7.1.2.cmml"><mo id="S4.SS3.p3.7.m7.1.2.5.2.1" stretchy="false" xref="S4.SS3.p3.7.m7.1.2.cmml">(</mo><mo id="S4.SS3.p3.7.m7.1.1" lspace="0em" rspace="0em" xref="S4.SS3.p3.7.m7.1.1.cmml">⋅</mo><mo id="S4.SS3.p3.7.m7.1.2.5.2.2" stretchy="false" xref="S4.SS3.p3.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b"><apply id="S4.SS3.p3.7.m7.1.2.cmml" xref="S4.SS3.p3.7.m7.1.2"><times id="S4.SS3.p3.7.m7.1.2.1.cmml" xref="S4.SS3.p3.7.m7.1.2.1"></times><ci id="S4.SS3.p3.7.m7.1.2.2.cmml" xref="S4.SS3.p3.7.m7.1.2.2">𝑣</ci><ci id="S4.SS3.p3.7.m7.1.2.3.cmml" xref="S4.SS3.p3.7.m7.1.2.3">𝑒</ci><ci id="S4.SS3.p3.7.m7.1.2.4.cmml" xref="S4.SS3.p3.7.m7.1.2.4">𝑐</ci><ci id="S4.SS3.p3.7.m7.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m7.1c">vec(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.7.m7.1d">italic_v italic_e italic_c ( ⋅ )</annotation></semantics></math> operation converts the feature map <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S4.SS3.p3.8.m8.1"><semantics id="S4.SS3.p3.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.8.m8.1.1" xref="S4.SS3.p3.8.m8.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m8.1b"><ci id="S4.SS3.p3.8.m8.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m8.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.8.m8.1d">caligraphic_F</annotation></semantics></math> into a vector <math alttext="v_{1}\in\mathbb{R}^{cmn}" class="ltx_Math" display="inline" id="S4.SS3.p3.9.m9.1"><semantics id="S4.SS3.p3.9.m9.1a"><mrow id="S4.SS3.p3.9.m9.1.1" xref="S4.SS3.p3.9.m9.1.1.cmml"><msub id="S4.SS3.p3.9.m9.1.1.2" xref="S4.SS3.p3.9.m9.1.1.2.cmml"><mi id="S4.SS3.p3.9.m9.1.1.2.2" xref="S4.SS3.p3.9.m9.1.1.2.2.cmml">v</mi><mn id="S4.SS3.p3.9.m9.1.1.2.3" xref="S4.SS3.p3.9.m9.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS3.p3.9.m9.1.1.1" xref="S4.SS3.p3.9.m9.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.9.m9.1.1.3" xref="S4.SS3.p3.9.m9.1.1.3.cmml"><mi id="S4.SS3.p3.9.m9.1.1.3.2" xref="S4.SS3.p3.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p3.9.m9.1.1.3.3" xref="S4.SS3.p3.9.m9.1.1.3.3.cmml"><mi id="S4.SS3.p3.9.m9.1.1.3.3.2" xref="S4.SS3.p3.9.m9.1.1.3.3.2.cmml">c</mi><mo id="S4.SS3.p3.9.m9.1.1.3.3.1" xref="S4.SS3.p3.9.m9.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.9.m9.1.1.3.3.3" xref="S4.SS3.p3.9.m9.1.1.3.3.3.cmml">m</mi><mo id="S4.SS3.p3.9.m9.1.1.3.3.1a" xref="S4.SS3.p3.9.m9.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.9.m9.1.1.3.3.4" xref="S4.SS3.p3.9.m9.1.1.3.3.4.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m9.1b"><apply id="S4.SS3.p3.9.m9.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1"><in id="S4.SS3.p3.9.m9.1.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1.1"></in><apply id="S4.SS3.p3.9.m9.1.1.2.cmml" xref="S4.SS3.p3.9.m9.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.1.1.2.1.cmml" xref="S4.SS3.p3.9.m9.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.9.m9.1.1.2.2.cmml" xref="S4.SS3.p3.9.m9.1.1.2.2">𝑣</ci><cn id="S4.SS3.p3.9.m9.1.1.2.3.cmml" type="integer" xref="S4.SS3.p3.9.m9.1.1.2.3">1</cn></apply><apply id="S4.SS3.p3.9.m9.1.1.3.cmml" xref="S4.SS3.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.1.1.3.1.cmml" xref="S4.SS3.p3.9.m9.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.9.m9.1.1.3.2.cmml" xref="S4.SS3.p3.9.m9.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.9.m9.1.1.3.3.cmml" xref="S4.SS3.p3.9.m9.1.1.3.3"><times id="S4.SS3.p3.9.m9.1.1.3.3.1.cmml" xref="S4.SS3.p3.9.m9.1.1.3.3.1"></times><ci id="S4.SS3.p3.9.m9.1.1.3.3.2.cmml" xref="S4.SS3.p3.9.m9.1.1.3.3.2">𝑐</ci><ci id="S4.SS3.p3.9.m9.1.1.3.3.3.cmml" xref="S4.SS3.p3.9.m9.1.1.3.3.3">𝑚</ci><ci id="S4.SS3.p3.9.m9.1.1.3.3.4.cmml" xref="S4.SS3.p3.9.m9.1.1.3.3.4">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m9.1c">v_{1}\in\mathbb{R}^{cmn}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.9.m9.1d">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_c italic_m italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>. Then the vector <math alttext="v_{1}" class="ltx_Math" display="inline" id="S4.SS3.p3.10.m10.1"><semantics id="S4.SS3.p3.10.m10.1a"><msub id="S4.SS3.p3.10.m10.1.1" xref="S4.SS3.p3.10.m10.1.1.cmml"><mi id="S4.SS3.p3.10.m10.1.1.2" xref="S4.SS3.p3.10.m10.1.1.2.cmml">v</mi><mn id="S4.SS3.p3.10.m10.1.1.3" xref="S4.SS3.p3.10.m10.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.10.m10.1b"><apply id="S4.SS3.p3.10.m10.1.1.cmml" xref="S4.SS3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m10.1.1.1.cmml" xref="S4.SS3.p3.10.m10.1.1">subscript</csymbol><ci id="S4.SS3.p3.10.m10.1.1.2.cmml" xref="S4.SS3.p3.10.m10.1.1.2">𝑣</ci><cn id="S4.SS3.p3.10.m10.1.1.3.cmml" type="integer" xref="S4.SS3.p3.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.10.m10.1c">v_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.10.m10.1d">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is projected into the entity feature space by <math alttext="\mathbf{W}\in\mathbb{R}^{cmn\times D_{h}}" class="ltx_Math" display="inline" id="S4.SS3.p3.11.m11.1"><semantics id="S4.SS3.p3.11.m11.1a"><mrow id="S4.SS3.p3.11.m11.1.1" xref="S4.SS3.p3.11.m11.1.1.cmml"><mi id="S4.SS3.p3.11.m11.1.1.2" xref="S4.SS3.p3.11.m11.1.1.2.cmml">𝐖</mi><mo id="S4.SS3.p3.11.m11.1.1.1" xref="S4.SS3.p3.11.m11.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.11.m11.1.1.3" xref="S4.SS3.p3.11.m11.1.1.3.cmml"><mi id="S4.SS3.p3.11.m11.1.1.3.2" xref="S4.SS3.p3.11.m11.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p3.11.m11.1.1.3.3" xref="S4.SS3.p3.11.m11.1.1.3.3.cmml"><mrow id="S4.SS3.p3.11.m11.1.1.3.3.2" xref="S4.SS3.p3.11.m11.1.1.3.3.2.cmml"><mi id="S4.SS3.p3.11.m11.1.1.3.3.2.2" xref="S4.SS3.p3.11.m11.1.1.3.3.2.2.cmml">c</mi><mo id="S4.SS3.p3.11.m11.1.1.3.3.2.1" xref="S4.SS3.p3.11.m11.1.1.3.3.2.1.cmml">⁢</mo><mi id="S4.SS3.p3.11.m11.1.1.3.3.2.3" xref="S4.SS3.p3.11.m11.1.1.3.3.2.3.cmml">m</mi><mo id="S4.SS3.p3.11.m11.1.1.3.3.2.1a" xref="S4.SS3.p3.11.m11.1.1.3.3.2.1.cmml">⁢</mo><mi id="S4.SS3.p3.11.m11.1.1.3.3.2.4" xref="S4.SS3.p3.11.m11.1.1.3.3.2.4.cmml">n</mi></mrow><mo id="S4.SS3.p3.11.m11.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.11.m11.1.1.3.3.1.cmml">×</mo><msub id="S4.SS3.p3.11.m11.1.1.3.3.3" xref="S4.SS3.p3.11.m11.1.1.3.3.3.cmml"><mi id="S4.SS3.p3.11.m11.1.1.3.3.3.2" xref="S4.SS3.p3.11.m11.1.1.3.3.3.2.cmml">D</mi><mi id="S4.SS3.p3.11.m11.1.1.3.3.3.3" xref="S4.SS3.p3.11.m11.1.1.3.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.11.m11.1b"><apply id="S4.SS3.p3.11.m11.1.1.cmml" xref="S4.SS3.p3.11.m11.1.1"><in id="S4.SS3.p3.11.m11.1.1.1.cmml" xref="S4.SS3.p3.11.m11.1.1.1"></in><ci id="S4.SS3.p3.11.m11.1.1.2.cmml" xref="S4.SS3.p3.11.m11.1.1.2">𝐖</ci><apply id="S4.SS3.p3.11.m11.1.1.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.11.m11.1.1.3.1.cmml" xref="S4.SS3.p3.11.m11.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.11.m11.1.1.3.2.cmml" xref="S4.SS3.p3.11.m11.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.11.m11.1.1.3.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3"><times id="S4.SS3.p3.11.m11.1.1.3.3.1.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.1"></times><apply id="S4.SS3.p3.11.m11.1.1.3.3.2.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.2"><times id="S4.SS3.p3.11.m11.1.1.3.3.2.1.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.2.1"></times><ci id="S4.SS3.p3.11.m11.1.1.3.3.2.2.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.2.2">𝑐</ci><ci id="S4.SS3.p3.11.m11.1.1.3.3.2.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.2.3">𝑚</ci><ci id="S4.SS3.p3.11.m11.1.1.3.3.2.4.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.2.4">𝑛</ci></apply><apply id="S4.SS3.p3.11.m11.1.1.3.3.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.11.m11.1.1.3.3.3.1.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.3">subscript</csymbol><ci id="S4.SS3.p3.11.m11.1.1.3.3.3.2.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.3.2">𝐷</ci><ci id="S4.SS3.p3.11.m11.1.1.3.3.3.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.11.m11.1c">\mathbf{W}\in\mathbb{R}^{cmn\times D_{h}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.11.m11.1d">bold_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_c italic_m italic_n × italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Thirdly, the nonlinear transformation will be performed to get <math alttext="v_{2}\in\mathbb{R}^{D_{h}}" class="ltx_Math" display="inline" id="S4.SS3.p3.12.m12.1"><semantics id="S4.SS3.p3.12.m12.1a"><mrow id="S4.SS3.p3.12.m12.1.1" xref="S4.SS3.p3.12.m12.1.1.cmml"><msub id="S4.SS3.p3.12.m12.1.1.2" xref="S4.SS3.p3.12.m12.1.1.2.cmml"><mi id="S4.SS3.p3.12.m12.1.1.2.2" xref="S4.SS3.p3.12.m12.1.1.2.2.cmml">v</mi><mn id="S4.SS3.p3.12.m12.1.1.2.3" xref="S4.SS3.p3.12.m12.1.1.2.3.cmml">2</mn></msub><mo id="S4.SS3.p3.12.m12.1.1.1" xref="S4.SS3.p3.12.m12.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.12.m12.1.1.3" xref="S4.SS3.p3.12.m12.1.1.3.cmml"><mi id="S4.SS3.p3.12.m12.1.1.3.2" xref="S4.SS3.p3.12.m12.1.1.3.2.cmml">ℝ</mi><msub id="S4.SS3.p3.12.m12.1.1.3.3" xref="S4.SS3.p3.12.m12.1.1.3.3.cmml"><mi id="S4.SS3.p3.12.m12.1.1.3.3.2" xref="S4.SS3.p3.12.m12.1.1.3.3.2.cmml">D</mi><mi id="S4.SS3.p3.12.m12.1.1.3.3.3" xref="S4.SS3.p3.12.m12.1.1.3.3.3.cmml">h</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.12.m12.1b"><apply id="S4.SS3.p3.12.m12.1.1.cmml" xref="S4.SS3.p3.12.m12.1.1"><in id="S4.SS3.p3.12.m12.1.1.1.cmml" xref="S4.SS3.p3.12.m12.1.1.1"></in><apply id="S4.SS3.p3.12.m12.1.1.2.cmml" xref="S4.SS3.p3.12.m12.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.12.m12.1.1.2.1.cmml" xref="S4.SS3.p3.12.m12.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.12.m12.1.1.2.2.cmml" xref="S4.SS3.p3.12.m12.1.1.2.2">𝑣</ci><cn id="S4.SS3.p3.12.m12.1.1.2.3.cmml" type="integer" xref="S4.SS3.p3.12.m12.1.1.2.3">2</cn></apply><apply id="S4.SS3.p3.12.m12.1.1.3.cmml" xref="S4.SS3.p3.12.m12.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.12.m12.1.1.3.1.cmml" xref="S4.SS3.p3.12.m12.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.12.m12.1.1.3.2.cmml" xref="S4.SS3.p3.12.m12.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.12.m12.1.1.3.3.cmml" xref="S4.SS3.p3.12.m12.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.12.m12.1.1.3.3.1.cmml" xref="S4.SS3.p3.12.m12.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p3.12.m12.1.1.3.3.2.cmml" xref="S4.SS3.p3.12.m12.1.1.3.3.2">𝐷</ci><ci id="S4.SS3.p3.12.m12.1.1.3.3.3.cmml" xref="S4.SS3.p3.12.m12.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.12.m12.1c">v_{2}\in\mathbb{R}^{D_{h}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.12.m12.1d">italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> followed by computing the inner product of <math alttext="v_{2}" class="ltx_Math" display="inline" id="S4.SS3.p3.13.m13.1"><semantics id="S4.SS3.p3.13.m13.1a"><msub id="S4.SS3.p3.13.m13.1.1" xref="S4.SS3.p3.13.m13.1.1.cmml"><mi id="S4.SS3.p3.13.m13.1.1.2" xref="S4.SS3.p3.13.m13.1.1.2.cmml">v</mi><mn id="S4.SS3.p3.13.m13.1.1.3" xref="S4.SS3.p3.13.m13.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.13.m13.1b"><apply id="S4.SS3.p3.13.m13.1.1.cmml" xref="S4.SS3.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.13.m13.1.1.1.cmml" xref="S4.SS3.p3.13.m13.1.1">subscript</csymbol><ci id="S4.SS3.p3.13.m13.1.1.2.cmml" xref="S4.SS3.p3.13.m13.1.1.2">𝑣</ci><cn id="S4.SS3.p3.13.m13.1.1.3.cmml" type="integer" xref="S4.SS3.p3.13.m13.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.13.m13.1c">v_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.13.m13.1d">italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> and the tail entity embedding <math alttext="t" class="ltx_Math" display="inline" id="S4.SS3.p3.14.m14.1"><semantics id="S4.SS3.p3.14.m14.1a"><mi id="S4.SS3.p3.14.m14.1.1" xref="S4.SS3.p3.14.m14.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.14.m14.1b"><ci id="S4.SS3.p3.14.m14.1.1.cmml" xref="S4.SS3.p3.14.m14.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.14.m14.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.14.m14.1d">italic_t</annotation></semantics></math> as the score. Finally, the score is normalized to obtain predicted probabilities as shown,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(19)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(h,r,t)=\text{sigmoid}(g(h,r,t))" class="ltx_Math" display="block" id="S4.E19.m1.7"><semantics id="S4.E19.m1.7a"><mrow id="S4.E19.m1.7.7" xref="S4.E19.m1.7.7.cmml"><mrow id="S4.E19.m1.7.7.3" xref="S4.E19.m1.7.7.3.cmml"><mi id="S4.E19.m1.7.7.3.2" xref="S4.E19.m1.7.7.3.2.cmml">p</mi><mo id="S4.E19.m1.7.7.3.1" xref="S4.E19.m1.7.7.3.1.cmml">⁢</mo><mrow id="S4.E19.m1.7.7.3.3.2" xref="S4.E19.m1.7.7.3.3.1.cmml"><mo id="S4.E19.m1.7.7.3.3.2.1" stretchy="false" xref="S4.E19.m1.7.7.3.3.1.cmml">(</mo><mi id="S4.E19.m1.1.1" xref="S4.E19.m1.1.1.cmml">h</mi><mo id="S4.E19.m1.7.7.3.3.2.2" xref="S4.E19.m1.7.7.3.3.1.cmml">,</mo><mi id="S4.E19.m1.2.2" xref="S4.E19.m1.2.2.cmml">r</mi><mo id="S4.E19.m1.7.7.3.3.2.3" xref="S4.E19.m1.7.7.3.3.1.cmml">,</mo><mi id="S4.E19.m1.3.3" xref="S4.E19.m1.3.3.cmml">t</mi><mo id="S4.E19.m1.7.7.3.3.2.4" stretchy="false" xref="S4.E19.m1.7.7.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E19.m1.7.7.2" xref="S4.E19.m1.7.7.2.cmml">=</mo><mrow id="S4.E19.m1.7.7.1" xref="S4.E19.m1.7.7.1.cmml"><mtext id="S4.E19.m1.7.7.1.3" xref="S4.E19.m1.7.7.1.3a.cmml">sigmoid</mtext><mo id="S4.E19.m1.7.7.1.2" xref="S4.E19.m1.7.7.1.2.cmml">⁢</mo><mrow id="S4.E19.m1.7.7.1.1.1" xref="S4.E19.m1.7.7.1.1.1.1.cmml"><mo id="S4.E19.m1.7.7.1.1.1.2" stretchy="false" xref="S4.E19.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S4.E19.m1.7.7.1.1.1.1" xref="S4.E19.m1.7.7.1.1.1.1.cmml"><mi id="S4.E19.m1.7.7.1.1.1.1.2" xref="S4.E19.m1.7.7.1.1.1.1.2.cmml">g</mi><mo id="S4.E19.m1.7.7.1.1.1.1.1" xref="S4.E19.m1.7.7.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E19.m1.7.7.1.1.1.1.3.2" xref="S4.E19.m1.7.7.1.1.1.1.3.1.cmml"><mo id="S4.E19.m1.7.7.1.1.1.1.3.2.1" stretchy="false" xref="S4.E19.m1.7.7.1.1.1.1.3.1.cmml">(</mo><mi id="S4.E19.m1.4.4" xref="S4.E19.m1.4.4.cmml">h</mi><mo id="S4.E19.m1.7.7.1.1.1.1.3.2.2" xref="S4.E19.m1.7.7.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E19.m1.5.5" xref="S4.E19.m1.5.5.cmml">r</mi><mo id="S4.E19.m1.7.7.1.1.1.1.3.2.3" xref="S4.E19.m1.7.7.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E19.m1.6.6" xref="S4.E19.m1.6.6.cmml">t</mi><mo id="S4.E19.m1.7.7.1.1.1.1.3.2.4" stretchy="false" xref="S4.E19.m1.7.7.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E19.m1.7.7.1.1.1.3" stretchy="false" xref="S4.E19.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E19.m1.7b"><apply id="S4.E19.m1.7.7.cmml" xref="S4.E19.m1.7.7"><eq id="S4.E19.m1.7.7.2.cmml" xref="S4.E19.m1.7.7.2"></eq><apply id="S4.E19.m1.7.7.3.cmml" xref="S4.E19.m1.7.7.3"><times id="S4.E19.m1.7.7.3.1.cmml" xref="S4.E19.m1.7.7.3.1"></times><ci id="S4.E19.m1.7.7.3.2.cmml" xref="S4.E19.m1.7.7.3.2">𝑝</ci><vector id="S4.E19.m1.7.7.3.3.1.cmml" xref="S4.E19.m1.7.7.3.3.2"><ci id="S4.E19.m1.1.1.cmml" xref="S4.E19.m1.1.1">ℎ</ci><ci id="S4.E19.m1.2.2.cmml" xref="S4.E19.m1.2.2">𝑟</ci><ci id="S4.E19.m1.3.3.cmml" xref="S4.E19.m1.3.3">𝑡</ci></vector></apply><apply id="S4.E19.m1.7.7.1.cmml" xref="S4.E19.m1.7.7.1"><times id="S4.E19.m1.7.7.1.2.cmml" xref="S4.E19.m1.7.7.1.2"></times><ci id="S4.E19.m1.7.7.1.3a.cmml" xref="S4.E19.m1.7.7.1.3"><mtext id="S4.E19.m1.7.7.1.3.cmml" xref="S4.E19.m1.7.7.1.3">sigmoid</mtext></ci><apply id="S4.E19.m1.7.7.1.1.1.1.cmml" xref="S4.E19.m1.7.7.1.1.1"><times id="S4.E19.m1.7.7.1.1.1.1.1.cmml" xref="S4.E19.m1.7.7.1.1.1.1.1"></times><ci id="S4.E19.m1.7.7.1.1.1.1.2.cmml" xref="S4.E19.m1.7.7.1.1.1.1.2">𝑔</ci><vector id="S4.E19.m1.7.7.1.1.1.1.3.1.cmml" xref="S4.E19.m1.7.7.1.1.1.1.3.2"><ci id="S4.E19.m1.4.4.cmml" xref="S4.E19.m1.4.4">ℎ</ci><ci id="S4.E19.m1.5.5.cmml" xref="S4.E19.m1.5.5">𝑟</ci><ci id="S4.E19.m1.6.6.cmml" xref="S4.E19.m1.6.6">𝑡</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E19.m1.7c">p(h,r,t)=\text{sigmoid}(g(h,r,t))</annotation><annotation encoding="application/x-llamapun" id="S4.E19.m1.7d">italic_p ( italic_h , italic_r , italic_t ) = sigmoid ( italic_g ( italic_h , italic_r , italic_t ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Loss function</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.4"><span class="ltx_text" id="S4.SS4.p1.4.4" style="color:#000000;">If the input triple <math alttext="(h,r,t)" class="ltx_Math" display="inline" id="S4.SS4.p1.1.1.m1.3"><semantics id="S4.SS4.p1.1.1.m1.3a"><mrow id="S4.SS4.p1.1.1.m1.3.4.2" xref="S4.SS4.p1.1.1.m1.3.4.1.cmml"><mo id="S4.SS4.p1.1.1.m1.3.4.2.1" mathcolor="#000000" stretchy="false" xref="S4.SS4.p1.1.1.m1.3.4.1.cmml">(</mo><mi id="S4.SS4.p1.1.1.m1.1.1" mathcolor="#000000" xref="S4.SS4.p1.1.1.m1.1.1.cmml">h</mi><mo id="S4.SS4.p1.1.1.m1.3.4.2.2" mathcolor="#000000" xref="S4.SS4.p1.1.1.m1.3.4.1.cmml">,</mo><mi id="S4.SS4.p1.1.1.m1.2.2" mathcolor="#000000" xref="S4.SS4.p1.1.1.m1.2.2.cmml">r</mi><mo id="S4.SS4.p1.1.1.m1.3.4.2.3" mathcolor="#000000" xref="S4.SS4.p1.1.1.m1.3.4.1.cmml">,</mo><mi id="S4.SS4.p1.1.1.m1.3.3" mathcolor="#000000" xref="S4.SS4.p1.1.1.m1.3.3.cmml">t</mi><mo id="S4.SS4.p1.1.1.m1.3.4.2.4" mathcolor="#000000" stretchy="false" xref="S4.SS4.p1.1.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.1.m1.3b"><vector id="S4.SS4.p1.1.1.m1.3.4.1.cmml" xref="S4.SS4.p1.1.1.m1.3.4.2"><ci id="S4.SS4.p1.1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.1.m1.1.1">ℎ</ci><ci id="S4.SS4.p1.1.1.m1.2.2.cmml" xref="S4.SS4.p1.1.1.m1.2.2">𝑟</ci><ci id="S4.SS4.p1.1.1.m1.3.3.cmml" xref="S4.SS4.p1.1.1.m1.3.3">𝑡</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.1.m1.3c">(h,r,t)</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.1.m1.3d">( italic_h , italic_r , italic_t )</annotation></semantics></math> is valid in KG, then we want the predicted probability <math alttext="p(h,r,t)" class="ltx_Math" display="inline" id="S4.SS4.p1.2.2.m2.3"><semantics id="S4.SS4.p1.2.2.m2.3a"><mrow id="S4.SS4.p1.2.2.m2.3.4" xref="S4.SS4.p1.2.2.m2.3.4.cmml"><mi id="S4.SS4.p1.2.2.m2.3.4.2" mathcolor="#000000" xref="S4.SS4.p1.2.2.m2.3.4.2.cmml">p</mi><mo id="S4.SS4.p1.2.2.m2.3.4.1" xref="S4.SS4.p1.2.2.m2.3.4.1.cmml">⁢</mo><mrow id="S4.SS4.p1.2.2.m2.3.4.3.2" xref="S4.SS4.p1.2.2.m2.3.4.3.1.cmml"><mo id="S4.SS4.p1.2.2.m2.3.4.3.2.1" mathcolor="#000000" stretchy="false" xref="S4.SS4.p1.2.2.m2.3.4.3.1.cmml">(</mo><mi id="S4.SS4.p1.2.2.m2.1.1" mathcolor="#000000" xref="S4.SS4.p1.2.2.m2.1.1.cmml">h</mi><mo id="S4.SS4.p1.2.2.m2.3.4.3.2.2" mathcolor="#000000" xref="S4.SS4.p1.2.2.m2.3.4.3.1.cmml">,</mo><mi id="S4.SS4.p1.2.2.m2.2.2" mathcolor="#000000" xref="S4.SS4.p1.2.2.m2.2.2.cmml">r</mi><mo id="S4.SS4.p1.2.2.m2.3.4.3.2.3" mathcolor="#000000" xref="S4.SS4.p1.2.2.m2.3.4.3.1.cmml">,</mo><mi id="S4.SS4.p1.2.2.m2.3.3" mathcolor="#000000" xref="S4.SS4.p1.2.2.m2.3.3.cmml">t</mi><mo id="S4.SS4.p1.2.2.m2.3.4.3.2.4" mathcolor="#000000" stretchy="false" xref="S4.SS4.p1.2.2.m2.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.2.m2.3b"><apply id="S4.SS4.p1.2.2.m2.3.4.cmml" xref="S4.SS4.p1.2.2.m2.3.4"><times id="S4.SS4.p1.2.2.m2.3.4.1.cmml" xref="S4.SS4.p1.2.2.m2.3.4.1"></times><ci id="S4.SS4.p1.2.2.m2.3.4.2.cmml" xref="S4.SS4.p1.2.2.m2.3.4.2">𝑝</ci><vector id="S4.SS4.p1.2.2.m2.3.4.3.1.cmml" xref="S4.SS4.p1.2.2.m2.3.4.3.2"><ci id="S4.SS4.p1.2.2.m2.1.1.cmml" xref="S4.SS4.p1.2.2.m2.1.1">ℎ</ci><ci id="S4.SS4.p1.2.2.m2.2.2.cmml" xref="S4.SS4.p1.2.2.m2.2.2">𝑟</ci><ci id="S4.SS4.p1.2.2.m2.3.3.cmml" xref="S4.SS4.p1.2.2.m2.3.3">𝑡</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.2.m2.3c">p(h,r,t)</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.2.m2.3d">italic_p ( italic_h , italic_r , italic_t )</annotation></semantics></math> to be <math alttext="1" class="ltx_Math" display="inline" id="S4.SS4.p1.3.3.m3.1"><semantics id="S4.SS4.p1.3.3.m3.1a"><mn id="S4.SS4.p1.3.3.m3.1.1" mathcolor="#000000" xref="S4.SS4.p1.3.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.3.m3.1b"><cn id="S4.SS4.p1.3.3.m3.1.1.cmml" type="integer" xref="S4.SS4.p1.3.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.3.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.3.m3.1d">1</annotation></semantics></math>. Otherwise, we want the predicted probability to be <math alttext="0" class="ltx_Math" display="inline" id="S4.SS4.p1.4.4.m4.1"><semantics id="S4.SS4.p1.4.4.m4.1a"><mn id="S4.SS4.p1.4.4.m4.1.1" mathcolor="#000000" xref="S4.SS4.p1.4.4.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.4.m4.1b"><cn id="S4.SS4.p1.4.4.m4.1.1.cmml" type="integer" xref="S4.SS4.p1.4.4.m4.1.1">0</cn></annotation-xml></semantics></math><cite class="ltx_cite ltx_citemacro_citep">(Dai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib4" title="">2022</a>)</cite>. So the loss function is defined as follows,</span></p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E20">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E20X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(20)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}(h,r,t)=" class="ltx_Math" display="inline" id="S4.E20X.2.1.1.m1.3"><semantics id="S4.E20X.2.1.1.m1.3a"><mrow id="S4.E20X.2.1.1.m1.3.4" xref="S4.E20X.2.1.1.m1.3.4.cmml"><mrow id="S4.E20X.2.1.1.m1.3.4.2" xref="S4.E20X.2.1.1.m1.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E20X.2.1.1.m1.3.4.2.2" xref="S4.E20X.2.1.1.m1.3.4.2.2.cmml">ℒ</mi><mo id="S4.E20X.2.1.1.m1.3.4.2.1" xref="S4.E20X.2.1.1.m1.3.4.2.1.cmml">⁢</mo><mrow id="S4.E20X.2.1.1.m1.3.4.2.3.2" xref="S4.E20X.2.1.1.m1.3.4.2.3.1.cmml"><mo id="S4.E20X.2.1.1.m1.3.4.2.3.2.1" stretchy="false" xref="S4.E20X.2.1.1.m1.3.4.2.3.1.cmml">(</mo><mi id="S4.E20X.2.1.1.m1.1.1" xref="S4.E20X.2.1.1.m1.1.1.cmml">h</mi><mo id="S4.E20X.2.1.1.m1.3.4.2.3.2.2" xref="S4.E20X.2.1.1.m1.3.4.2.3.1.cmml">,</mo><mi id="S4.E20X.2.1.1.m1.2.2" xref="S4.E20X.2.1.1.m1.2.2.cmml">r</mi><mo id="S4.E20X.2.1.1.m1.3.4.2.3.2.3" xref="S4.E20X.2.1.1.m1.3.4.2.3.1.cmml">,</mo><mi id="S4.E20X.2.1.1.m1.3.3" xref="S4.E20X.2.1.1.m1.3.3.cmml">t</mi><mo id="S4.E20X.2.1.1.m1.3.4.2.3.2.4" stretchy="false" xref="S4.E20X.2.1.1.m1.3.4.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E20X.2.1.1.m1.3.4.1" xref="S4.E20X.2.1.1.m1.3.4.1.cmml">=</mo><mi id="S4.E20X.2.1.1.m1.3.4.3" xref="S4.E20X.2.1.1.m1.3.4.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E20X.2.1.1.m1.3b"><apply id="S4.E20X.2.1.1.m1.3.4.cmml" xref="S4.E20X.2.1.1.m1.3.4"><eq id="S4.E20X.2.1.1.m1.3.4.1.cmml" xref="S4.E20X.2.1.1.m1.3.4.1"></eq><apply id="S4.E20X.2.1.1.m1.3.4.2.cmml" xref="S4.E20X.2.1.1.m1.3.4.2"><times id="S4.E20X.2.1.1.m1.3.4.2.1.cmml" xref="S4.E20X.2.1.1.m1.3.4.2.1"></times><ci id="S4.E20X.2.1.1.m1.3.4.2.2.cmml" xref="S4.E20X.2.1.1.m1.3.4.2.2">ℒ</ci><vector id="S4.E20X.2.1.1.m1.3.4.2.3.1.cmml" xref="S4.E20X.2.1.1.m1.3.4.2.3.2"><ci id="S4.E20X.2.1.1.m1.1.1.cmml" xref="S4.E20X.2.1.1.m1.1.1">ℎ</ci><ci id="S4.E20X.2.1.1.m1.2.2.cmml" xref="S4.E20X.2.1.1.m1.2.2">𝑟</ci><ci id="S4.E20X.2.1.1.m1.3.3.cmml" xref="S4.E20X.2.1.1.m1.3.3">𝑡</ci></vector></apply><csymbol cd="latexml" id="S4.E20X.2.1.1.m1.3.4.3.cmml" xref="S4.E20X.2.1.1.m1.3.4.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E20X.2.1.1.m1.3c">\displaystyle\mathcal{L}(h,r,t)=</annotation><annotation encoding="application/x-llamapun" id="S4.E20X.2.1.1.m1.3d">caligraphic_L ( italic_h , italic_r , italic_t ) =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle-\frac{1}{N}\sum^{N}_{i=1}(y(h,r,t_{i})\cdot\log(p(h,r,t_{i}))+" class="ltx_math_unparsed" display="inline" id="S4.E20X.3.2.2.m1.5"><semantics id="S4.E20X.3.2.2.m1.5a"><mrow id="S4.E20X.3.2.2.m1.5b"><mo id="S4.E20X.3.2.2.m1.5.6">−</mo><mstyle displaystyle="true" id="S4.E20X.3.2.2.m1.5.7"><mfrac id="S4.E20X.3.2.2.m1.5.7a"><mn id="S4.E20X.3.2.2.m1.5.7.2">1</mn><mi id="S4.E20X.3.2.2.m1.5.7.3">N</mi></mfrac></mstyle><mstyle displaystyle="true" id="S4.E20X.3.2.2.m1.5.8"><munderover id="S4.E20X.3.2.2.m1.5.8a"><mo id="S4.E20X.3.2.2.m1.5.8.2.2" movablelimits="false">∑</mo><mrow id="S4.E20X.3.2.2.m1.5.8.3"><mi id="S4.E20X.3.2.2.m1.5.8.3.2">i</mi><mo id="S4.E20X.3.2.2.m1.5.8.3.1">=</mo><mn id="S4.E20X.3.2.2.m1.5.8.3.3">1</mn></mrow><mi id="S4.E20X.3.2.2.m1.5.8.2.3">N</mi></munderover></mstyle><mrow id="S4.E20X.3.2.2.m1.5.9"><mo id="S4.E20X.3.2.2.m1.5.9.1" stretchy="false">(</mo><mi id="S4.E20X.3.2.2.m1.5.9.2">y</mi><mrow id="S4.E20X.3.2.2.m1.5.9.3"><mo id="S4.E20X.3.2.2.m1.5.9.3.1" stretchy="false">(</mo><mi id="S4.E20X.3.2.2.m1.1.1">h</mi><mo id="S4.E20X.3.2.2.m1.5.9.3.2">,</mo><mi id="S4.E20X.3.2.2.m1.2.2">r</mi><mo id="S4.E20X.3.2.2.m1.5.9.3.3">,</mo><msub id="S4.E20X.3.2.2.m1.5.9.3.4"><mi id="S4.E20X.3.2.2.m1.5.9.3.4.2">t</mi><mi id="S4.E20X.3.2.2.m1.5.9.3.4.3">i</mi></msub><mo id="S4.E20X.3.2.2.m1.5.9.3.5" rspace="0.055em" stretchy="false">)</mo></mrow><mo id="S4.E20X.3.2.2.m1.5.9.4" rspace="0.222em">⋅</mo><mi id="S4.E20X.3.2.2.m1.5.5">log</mi><mrow id="S4.E20X.3.2.2.m1.5.9.5"><mo id="S4.E20X.3.2.2.m1.5.9.5.1" stretchy="false">(</mo><mi id="S4.E20X.3.2.2.m1.5.9.5.2">p</mi><mrow id="S4.E20X.3.2.2.m1.5.9.5.3"><mo id="S4.E20X.3.2.2.m1.5.9.5.3.1" stretchy="false">(</mo><mi id="S4.E20X.3.2.2.m1.3.3">h</mi><mo id="S4.E20X.3.2.2.m1.5.9.5.3.2">,</mo><mi id="S4.E20X.3.2.2.m1.4.4">r</mi><mo id="S4.E20X.3.2.2.m1.5.9.5.3.3">,</mo><msub id="S4.E20X.3.2.2.m1.5.9.5.3.4"><mi id="S4.E20X.3.2.2.m1.5.9.5.3.4.2">t</mi><mi id="S4.E20X.3.2.2.m1.5.9.5.3.4.3">i</mi></msub><mo id="S4.E20X.3.2.2.m1.5.9.5.3.5" stretchy="false">)</mo></mrow><mo id="S4.E20X.3.2.2.m1.5.9.5.4" stretchy="false">)</mo></mrow><mo id="S4.E20X.3.2.2.m1.5.9.6">+</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.E20X.3.2.2.m1.5c">\displaystyle-\frac{1}{N}\sum^{N}_{i=1}(y(h,r,t_{i})\cdot\log(p(h,r,t_{i}))+</annotation><annotation encoding="application/x-llamapun" id="S4.E20X.3.2.2.m1.5d">- divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT ( italic_y ( italic_h , italic_r , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⋅ roman_log ( italic_p ( italic_h , italic_r , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) +</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E20Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle(1-y(h,r,t_{i}))\cdot\log(1-p(h,r,t_{i})))" class="ltx_math_unparsed" display="inline" id="S4.E20Xa.2.1.1.m1.5"><semantics id="S4.E20Xa.2.1.1.m1.5a"><mrow id="S4.E20Xa.2.1.1.m1.5b"><mrow id="S4.E20Xa.2.1.1.m1.5.6"><mo id="S4.E20Xa.2.1.1.m1.5.6.1" stretchy="false">(</mo><mn id="S4.E20Xa.2.1.1.m1.5.6.2">1</mn><mo id="S4.E20Xa.2.1.1.m1.5.6.3">−</mo><mi id="S4.E20Xa.2.1.1.m1.5.6.4">y</mi><mrow id="S4.E20Xa.2.1.1.m1.5.6.5"><mo id="S4.E20Xa.2.1.1.m1.5.6.5.1" stretchy="false">(</mo><mi id="S4.E20Xa.2.1.1.m1.1.1">h</mi><mo id="S4.E20Xa.2.1.1.m1.5.6.5.2">,</mo><mi id="S4.E20Xa.2.1.1.m1.2.2">r</mi><mo id="S4.E20Xa.2.1.1.m1.5.6.5.3">,</mo><msub id="S4.E20Xa.2.1.1.m1.5.6.5.4"><mi id="S4.E20Xa.2.1.1.m1.5.6.5.4.2">t</mi><mi id="S4.E20Xa.2.1.1.m1.5.6.5.4.3">i</mi></msub><mo id="S4.E20Xa.2.1.1.m1.5.6.5.5" stretchy="false">)</mo></mrow><mo id="S4.E20Xa.2.1.1.m1.5.6.6" rspace="0.055em" stretchy="false">)</mo></mrow><mo id="S4.E20Xa.2.1.1.m1.5.7" rspace="0.222em">⋅</mo><mi id="S4.E20Xa.2.1.1.m1.5.5">log</mi><mrow id="S4.E20Xa.2.1.1.m1.5.8"><mo id="S4.E20Xa.2.1.1.m1.5.8.1" stretchy="false">(</mo><mn id="S4.E20Xa.2.1.1.m1.5.8.2">1</mn><mo id="S4.E20Xa.2.1.1.m1.5.8.3">−</mo><mi id="S4.E20Xa.2.1.1.m1.5.8.4">p</mi><mrow id="S4.E20Xa.2.1.1.m1.5.8.5"><mo id="S4.E20Xa.2.1.1.m1.5.8.5.1" stretchy="false">(</mo><mi id="S4.E20Xa.2.1.1.m1.3.3">h</mi><mo id="S4.E20Xa.2.1.1.m1.5.8.5.2">,</mo><mi id="S4.E20Xa.2.1.1.m1.4.4">r</mi><mo id="S4.E20Xa.2.1.1.m1.5.8.5.3">,</mo><msub id="S4.E20Xa.2.1.1.m1.5.8.5.4"><mi id="S4.E20Xa.2.1.1.m1.5.8.5.4.2">t</mi><mi id="S4.E20Xa.2.1.1.m1.5.8.5.4.3">i</mi></msub><mo id="S4.E20Xa.2.1.1.m1.5.8.5.5" stretchy="false">)</mo></mrow><mo id="S4.E20Xa.2.1.1.m1.5.8.6" stretchy="false">)</mo></mrow><mo id="S4.E20Xa.2.1.1.m1.5.9" stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" id="S4.E20Xa.2.1.1.m1.5c">\displaystyle(1-y(h,r,t_{i}))\cdot\log(1-p(h,r,t_{i})))</annotation><annotation encoding="application/x-llamapun" id="S4.E20Xa.2.1.1.m1.5d">( 1 - italic_y ( italic_h , italic_r , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) ⋅ roman_log ( 1 - italic_p ( italic_h , italic_r , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS4.p1.9">in which</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E21">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(21)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="y(h,r,t_{i})=\left\{\begin{matrix}1\quad\text{if}\ (h,r,t_{i})\in\mathcal{T}\\
0\quad\text{if}\ (h,r,t_{i})\notin\mathcal{T}\end{matrix}\right." class="ltx_math_unparsed" display="block" id="S4.E21.m1.3"><semantics id="S4.E21.m1.3a"><mrow id="S4.E21.m1.3b"><mi id="S4.E21.m1.3.4">y</mi><mrow id="S4.E21.m1.3.5"><mo id="S4.E21.m1.3.5.1" stretchy="false">(</mo><mi id="S4.E21.m1.2.2">h</mi><mo id="S4.E21.m1.3.5.2">,</mo><mi id="S4.E21.m1.3.3">r</mi><mo id="S4.E21.m1.3.5.3">,</mo><msub id="S4.E21.m1.3.5.4"><mi id="S4.E21.m1.3.5.4.2">t</mi><mi id="S4.E21.m1.3.5.4.3">i</mi></msub><mo id="S4.E21.m1.3.5.5" stretchy="false">)</mo></mrow><mo id="S4.E21.m1.3.6">=</mo><mrow id="S4.E21.m1.3.7"><mo id="S4.E21.m1.3.7.1">{</mo><mtable displaystyle="true" id="S4.E21.m1.1.1.1.1" rowspacing="0pt"><mtr id="S4.E21.m1.1.1.1.1a"><mtd id="S4.E21.m1.1.1.1.1b"><mrow id="S4.E21.m1.1.1.1.1.4.4.4.4"><mrow id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1"><mn id="S4.E21.m1.1.1.1.1.3.3.3.3.3">1</mn><mspace id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.2" width="1em"></mspace><mrow id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.1"><mtext id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.1.3">if</mtext><mo id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.1.2" lspace="0.500em">⁢</mo><mrow id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.1.1.1"><mo id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.1.1.1.2" stretchy="false">(</mo><mi id="S4.E21.m1.1.1.1.1.1.1.1.1.1">h</mi><mo id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.1.1.1.3">,</mo><mi id="S4.E21.m1.1.1.1.1.2.2.2.2.2">r</mi><mo id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.1.1.1.4">,</mo><msub id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.1.1.1.1"><mi id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.1.1.1.1.2">t</mi><mi id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.1.1.1.1.3">i</mi></msub><mo id="S4.E21.m1.1.1.1.1.4.4.4.4.4.1.1.1.1.5" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E21.m1.1.1.1.1.4.4.4.4.5">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E21.m1.1.1.1.1.4.4.4.4.6">𝒯</mi></mrow></mtd></mtr><mtr id="S4.E21.m1.1.1.1.1c"><mtd id="S4.E21.m1.1.1.1.1d"><mrow id="S4.E21.m1.1.1.1.1.8.8.4.4"><mrow id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1"><mn id="S4.E21.m1.1.1.1.1.7.7.3.3.3">0</mn><mspace id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.2" width="1em"></mspace><mrow id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.1"><mtext id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.1.3">if</mtext><mo id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.1.2" lspace="0.500em">⁢</mo><mrow id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.1.1.1"><mo id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.1.1.1.2" stretchy="false">(</mo><mi id="S4.E21.m1.1.1.1.1.5.5.1.1.1">h</mi><mo id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.1.1.1.3">,</mo><mi id="S4.E21.m1.1.1.1.1.6.6.2.2.2">r</mi><mo id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.1.1.1.4">,</mo><msub id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.1.1.1.1"><mi id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.1.1.1.1.2">t</mi><mi id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.1.1.1.1.3">i</mi></msub><mo id="S4.E21.m1.1.1.1.1.8.8.4.4.4.1.1.1.1.5" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S4.E21.m1.1.1.1.1.8.8.4.4.5">∉</mo><mi class="ltx_font_mathcaligraphic" id="S4.E21.m1.1.1.1.1.8.8.4.4.6">𝒯</mi></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="S4.E21.m1.3c">y(h,r,t_{i})=\left\{\begin{matrix}1\quad\text{if}\ (h,r,t_{i})\in\mathcal{T}\\
0\quad\text{if}\ (h,r,t_{i})\notin\mathcal{T}\end{matrix}\right.</annotation><annotation encoding="application/x-llamapun" id="S4.E21.m1.3d">italic_y ( italic_h , italic_r , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = { start_ARG start_ROW start_CELL 1 if ( italic_h , italic_r , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∈ caligraphic_T end_CELL end_ROW start_ROW start_CELL 0 if ( italic_h , italic_r , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∉ caligraphic_T end_CELL end_ROW end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.p1.8">where <math alttext="y(h,r,t_{i})" class="ltx_Math" display="inline" id="S4.SS4.p1.5.m1.3"><semantics id="S4.SS4.p1.5.m1.3a"><mrow id="S4.SS4.p1.5.m1.3.3" xref="S4.SS4.p1.5.m1.3.3.cmml"><mi id="S4.SS4.p1.5.m1.3.3.3" xref="S4.SS4.p1.5.m1.3.3.3.cmml">y</mi><mo id="S4.SS4.p1.5.m1.3.3.2" xref="S4.SS4.p1.5.m1.3.3.2.cmml">⁢</mo><mrow id="S4.SS4.p1.5.m1.3.3.1.1" xref="S4.SS4.p1.5.m1.3.3.1.2.cmml"><mo id="S4.SS4.p1.5.m1.3.3.1.1.2" stretchy="false" xref="S4.SS4.p1.5.m1.3.3.1.2.cmml">(</mo><mi id="S4.SS4.p1.5.m1.1.1" xref="S4.SS4.p1.5.m1.1.1.cmml">h</mi><mo id="S4.SS4.p1.5.m1.3.3.1.1.3" xref="S4.SS4.p1.5.m1.3.3.1.2.cmml">,</mo><mi id="S4.SS4.p1.5.m1.2.2" xref="S4.SS4.p1.5.m1.2.2.cmml">r</mi><mo id="S4.SS4.p1.5.m1.3.3.1.1.4" xref="S4.SS4.p1.5.m1.3.3.1.2.cmml">,</mo><msub id="S4.SS4.p1.5.m1.3.3.1.1.1" xref="S4.SS4.p1.5.m1.3.3.1.1.1.cmml"><mi id="S4.SS4.p1.5.m1.3.3.1.1.1.2" xref="S4.SS4.p1.5.m1.3.3.1.1.1.2.cmml">t</mi><mi id="S4.SS4.p1.5.m1.3.3.1.1.1.3" xref="S4.SS4.p1.5.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS4.p1.5.m1.3.3.1.1.5" stretchy="false" xref="S4.SS4.p1.5.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m1.3b"><apply id="S4.SS4.p1.5.m1.3.3.cmml" xref="S4.SS4.p1.5.m1.3.3"><times id="S4.SS4.p1.5.m1.3.3.2.cmml" xref="S4.SS4.p1.5.m1.3.3.2"></times><ci id="S4.SS4.p1.5.m1.3.3.3.cmml" xref="S4.SS4.p1.5.m1.3.3.3">𝑦</ci><vector id="S4.SS4.p1.5.m1.3.3.1.2.cmml" xref="S4.SS4.p1.5.m1.3.3.1.1"><ci id="S4.SS4.p1.5.m1.1.1.cmml" xref="S4.SS4.p1.5.m1.1.1">ℎ</ci><ci id="S4.SS4.p1.5.m1.2.2.cmml" xref="S4.SS4.p1.5.m1.2.2">𝑟</ci><apply id="S4.SS4.p1.5.m1.3.3.1.1.1.cmml" xref="S4.SS4.p1.5.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m1.3.3.1.1.1.1.cmml" xref="S4.SS4.p1.5.m1.3.3.1.1.1">subscript</csymbol><ci id="S4.SS4.p1.5.m1.3.3.1.1.1.2.cmml" xref="S4.SS4.p1.5.m1.3.3.1.1.1.2">𝑡</ci><ci id="S4.SS4.p1.5.m1.3.3.1.1.1.3.cmml" xref="S4.SS4.p1.5.m1.3.3.1.1.1.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m1.3c">y(h,r,t_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.5.m1.3d">italic_y ( italic_h , italic_r , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> indicates whether the triplet <math alttext="(h,r,t_{i})" class="ltx_Math" display="inline" id="S4.SS4.p1.6.m2.3"><semantics id="S4.SS4.p1.6.m2.3a"><mrow id="S4.SS4.p1.6.m2.3.3.1" xref="S4.SS4.p1.6.m2.3.3.2.cmml"><mo id="S4.SS4.p1.6.m2.3.3.1.2" stretchy="false" xref="S4.SS4.p1.6.m2.3.3.2.cmml">(</mo><mi id="S4.SS4.p1.6.m2.1.1" xref="S4.SS4.p1.6.m2.1.1.cmml">h</mi><mo id="S4.SS4.p1.6.m2.3.3.1.3" xref="S4.SS4.p1.6.m2.3.3.2.cmml">,</mo><mi id="S4.SS4.p1.6.m2.2.2" xref="S4.SS4.p1.6.m2.2.2.cmml">r</mi><mo id="S4.SS4.p1.6.m2.3.3.1.4" xref="S4.SS4.p1.6.m2.3.3.2.cmml">,</mo><msub id="S4.SS4.p1.6.m2.3.3.1.1" xref="S4.SS4.p1.6.m2.3.3.1.1.cmml"><mi id="S4.SS4.p1.6.m2.3.3.1.1.2" xref="S4.SS4.p1.6.m2.3.3.1.1.2.cmml">t</mi><mi id="S4.SS4.p1.6.m2.3.3.1.1.3" xref="S4.SS4.p1.6.m2.3.3.1.1.3.cmml">i</mi></msub><mo id="S4.SS4.p1.6.m2.3.3.1.5" stretchy="false" xref="S4.SS4.p1.6.m2.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m2.3b"><vector id="S4.SS4.p1.6.m2.3.3.2.cmml" xref="S4.SS4.p1.6.m2.3.3.1"><ci id="S4.SS4.p1.6.m2.1.1.cmml" xref="S4.SS4.p1.6.m2.1.1">ℎ</ci><ci id="S4.SS4.p1.6.m2.2.2.cmml" xref="S4.SS4.p1.6.m2.2.2">𝑟</ci><apply id="S4.SS4.p1.6.m2.3.3.1.1.cmml" xref="S4.SS4.p1.6.m2.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m2.3.3.1.1.1.cmml" xref="S4.SS4.p1.6.m2.3.3.1.1">subscript</csymbol><ci id="S4.SS4.p1.6.m2.3.3.1.1.2.cmml" xref="S4.SS4.p1.6.m2.3.3.1.1.2">𝑡</ci><ci id="S4.SS4.p1.6.m2.3.3.1.1.3.cmml" xref="S4.SS4.p1.6.m2.3.3.1.1.3">𝑖</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m2.3c">(h,r,t_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.6.m2.3d">( italic_h , italic_r , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is a positive triplet, and its value is {0,1}. <math alttext="N" class="ltx_Math" display="inline" id="S4.SS4.p1.7.m3.1"><semantics id="S4.SS4.p1.7.m3.1a"><mi id="S4.SS4.p1.7.m3.1.1" xref="S4.SS4.p1.7.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m3.1b"><ci id="S4.SS4.p1.7.m3.1.1.cmml" xref="S4.SS4.p1.7.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.7.m3.1d">italic_N</annotation></semantics></math> represents the total number of tail nodes to be predicted. <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS4.p1.8.m4.1"><semantics id="S4.SS4.p1.8.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.8.m4.1.1" xref="S4.SS4.p1.8.m4.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.8.m4.1b"><ci id="S4.SS4.p1.8.m4.1.1.cmml" xref="S4.SS4.p1.8.m4.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.8.m4.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.8.m4.1d">caligraphic_T</annotation></semantics></math> represents the set of valid triples.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiment</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Datasets</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">Most of the knowledge graph embedding models and knowledge graph completion models<cite class="ltx_cite ltx_citemacro_citep">(Shang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib23" title="">2019</a>; Vashishth et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib28" title="">2020</a>; Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib8" title="">2021</a>; Dai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib4" title="">2022</a>; Yao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib38" title="">2019</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib36" title="">2021</a>)</cite> are developed on the FB15K-237 and WN18RR datasets. Likewise, these two datasets will also be used to evaluate the performance of GATH. A short introduction to these two datasets is given below.</p>
</div>
<section class="ltx_paragraph" id="S5.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">FB15K-237</h4>
<div class="ltx_para" id="S5.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS1.SSS0.Px1.p1.1">FB15K-237<cite class="ltx_cite ltx_citemacro_citep">(Toutanova and Chen, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib26" title="">2015</a>)</cite> is a dataset for link prediction with 14541 entities, 237 relations, and 310,116 triples. It is the subset of FB15K<cite class="ltx_cite ltx_citemacro_citep">(Bordes et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib2" title="">2013</a>)</cite>. In FB15K, many triples are inverses that cause leakage from the training to testing and validation splits. And the inverse relations are removed in FB15K-237.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">WN18RR</h4>
<div class="ltx_para" id="S5.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS1.SSS0.Px2.p1.1">WN18RR<cite class="ltx_cite ltx_citemacro_citep">(Dettmers et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib5" title="">2018</a>)</cite> is a subset of WN18<cite class="ltx_cite ltx_citemacro_citep">(Bordes et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib2" title="">2013</a>)</cite>. The WN18 also suffers from test leakage, similar to FB15K. Therefore, WN18RR has revised WN18 and deletes the inverse relations. In all, WN18RR contains more than 40,000 entities, 11 relations, and more than 90,000 triples. Compared with FB15K-237, WN18RR has more entities, but the complex connections are reduced a lot.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Dataset Statistics</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.1.1.1.1">Dataset</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.1.1.1.2">FB15K-237</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.1.1.1.3">WN18RR</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S5.T1.1.2.2.1">Entities</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.1.2.2.2">14541</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.1.2.2.3">40943</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T1.1.3.3.1">Relations</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.3.3.2">237</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.3.3.3">11</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T1.1.4.4.1">Triplets</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.4.4.2">310,116</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.4.4.3">93,004</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T1.1.5.5.1">Train Triplets</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.5.5.2">272115</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.5.5.3">86835</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" id="S5.T1.1.6.6.1">Val Triplets</th>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.6.6.2">17535</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.6.6.3">3035</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="S5.T1.1.7.7.1">Test Triplets</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.1.7.7.2">20466</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.1.7.7.3">3134</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Baselines</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">In order to demonstrate the superiority of GATH in knowledge graph completion, we mainly conduct comprehensive comparisons with the following 5 categories of knowledge graph embedding models: 1) translation-based models, 2) semantic matching-based models, 3) GCN-based models, 4) GAT-based models and 5) decoder-only models. The calculation process related to the baselines is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S5.T2" title="Table 2 ‣ Decoder-only models ‣ 5.2. Baselines ‣ 5. Experiment ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Translation-based models</h4>
<div class="ltx_para" id="S5.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px1.p1.1">Translation-based models use distance functions as scoring functions. We use TransE<cite class="ltx_cite ltx_citemacro_citep">(Bordes et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib2" title="">2013</a>)</cite> and RotatE<cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib25" title="">2019</a>)</cite> as our baselines. This is because TransE is a pioneering work based on translation, while RotatE views relation as the rotation of entity in complex number space and significantly improves the performance of embedded models.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Semantic matching-based models</h4>
<div class="ltx_para" id="S5.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px2.p1.1">Semantic matching-based models usually use similarity functions as scoring functions, such as DistMult <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib37" title="">2014</a>)</cite> and ComplEx <cite class="ltx_cite ltx_citemacro_citep">(Trouillon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib27" title="">2016</a>)</cite>. Similarly, DistMult and ComplEx measure the similarity of triples in real and complex number spaces, respectively. We choose DistMult because it can succinctly obtain high-quality entity embeddings, while ComplEx introduces complex entity embeddings making the model performance greatly improved.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">GCN-based models</h4>
<div class="ltx_para" id="S5.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px3.p1.1">GCN-based models use static relation attributes to aggregate neighbor information.
Among them, we have chosen SACN <cite class="ltx_cite ltx_citemacro_citep">(Shang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib23" title="">2019</a>)</cite> and NoGE <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib19" title="">2022</a>)</cite> as baselines. SACN aggregates neighbor information by assigning static weights to relations, while NoGE aggregates neighbor information with the help of dual quaternion. Although SACN obtains the optimal result, NoGE introduces quaternion to improve the performance. Therefore, SACN and NoGE were chosen as the baselines.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">GAT-based models</h4>
<div class="ltx_para" id="S5.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px4.p1.1">GAT-based models combine graph neural networks and attention to dynamically aggregate neighbor information.
We chose RGAT <cite class="ltx_cite ltx_citemacro_citep">(Busbridge et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib3" title="">2019</a>)</cite>, DisenKGAT <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib36" title="">2021</a>)</cite>, and MRGAT <cite class="ltx_cite ltx_citemacro_citep">(Dai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib4" title="">2022</a>)</cite> as baselines. RGAT extends the original GAT to take relation into account, while DisenKGAT assumes that entity information is composed of multiple sub-feature information and aggregates neighbor information in different subspaces. MRGAT transforms head and tail entities into attention components via relation-specific projection matrices. The reason we chose these three baselines is that RGAT expands the original GAT and considers the relations in KG, greatly improving the performance of the embedding models; DisenKGAT has a similar idea to ours, where entities are composed of features from multiple subspaces together; and MRGAT is currently the state-of-the-art model.</p>
</div>
</section>
<section class="ltx_paragraph" id="S5.SS2.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">Decoder-only models</h4>
<div class="ltx_para" id="S5.SS2.SSS0.Px5.p1">
<p class="ltx_p" id="S5.SS2.SSS0.Px5.p1.1">Decoder-only models work on the initial embedding of entities, such as ConvE <cite class="ltx_cite ltx_citemacro_citep">(Dettmers et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib5" title="">2018</a>)</cite>, Conv_TransE <cite class="ltx_cite ltx_citemacro_citep">(Shang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib23" title="">2019</a>)</cite>, InteractE <cite class="ltx_cite ltx_citemacro_citep">(Vashishth et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib28" title="">2020</a>)</cite>, and CTKGC <cite class="ltx_cite ltx_citemacro_citep">(Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib8" title="">2021</a>)</cite>. ConvE is similar to Conv_TransE. Specifically, ConvE reshapes the input while Conv_TransE does not perform additional processing on the input to maintain translation invariance. InteractE enhances the expressive power of models by increasing the possible interactions between embeddings. CTKGC relies on the fact that the multiplication of the head entity and relation is approximately equal to the tail entity. We choose these baselines for the following reasons. ConvE and InteractE respectively achieved their best performance at the time and were chosen as the baseline by us. ConvE was pioneering work in applying CNN as a decoder, while Conv_TransE is the decoder of SACN. As a decoder-only model, CTKGC has achieved excellent results in the current knowledge graph embedding models.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>The feature propagation and scoring function of all baselines. <math alttext="||\cdot||_{p}" class="ltx_math_unparsed" display="inline" id="S5.T2.13.m1.1"><semantics id="S5.T2.13.m1.1b"><mrow id="S5.T2.13.m1.1c"><mo fence="false" id="S5.T2.13.m1.1.1" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S5.T2.13.m1.1.2" stretchy="false">|</mo><mo id="S5.T2.13.m1.1.3" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S5.T2.13.m1.1.4" rspace="0.167em" stretchy="false">|</mo><msub id="S5.T2.13.m1.1.5"><mo fence="false" id="S5.T2.13.m1.1.5.2" stretchy="false">|</mo><mi id="S5.T2.13.m1.1.5.3">p</mi></msub></mrow><annotation encoding="application/x-tex" id="S5.T2.13.m1.1d">||\cdot||_{p}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.13.m1.1e">| | ⋅ | | start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> represents the p-norm of the vector, and p is usually set to 2. <math alttext="&lt;\cdot&gt;" class="ltx_Math" display="inline" id="S5.T2.14.m2.3"><semantics id="S5.T2.14.m2.3b"><mrow id="S5.T2.14.m2.3.4.2" xref="S5.T2.14.m2.3.4.1.cmml"><mo id="S5.T2.14.m2.1.1" xref="S5.T2.14.m2.1.1.cmml">&lt;</mo><mo id="S5.T2.14.m2.3.4.2.1" lspace="0em" xref="S5.T2.14.m2.3.4.1.cmml">⁣</mo><mo id="S5.T2.14.m2.2.2" xref="S5.T2.14.m2.2.2.cmml">⋅</mo><mo id="S5.T2.14.m2.3.4.2.2" lspace="0em" xref="S5.T2.14.m2.3.4.1.cmml">⁣</mo><mo id="S5.T2.14.m2.3.3" xref="S5.T2.14.m2.3.3.cmml">&gt;</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.14.m2.3c"><list id="S5.T2.14.m2.3.4.1.cmml" xref="S5.T2.14.m2.3.4.2"><lt id="S5.T2.14.m2.1.1.cmml" xref="S5.T2.14.m2.1.1"></lt><ci id="S5.T2.14.m2.2.2.cmml" xref="S5.T2.14.m2.2.2">⋅</ci><gt id="S5.T2.14.m2.3.3.cmml" xref="S5.T2.14.m2.3.3"></gt></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.m2.3d">&lt;\cdot&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T2.14.m2.3e">&lt; ⋅ &gt;</annotation></semantics></math> represents the dot product of vectors. <math alttext="\overline{\cdot}" class="ltx_Math" display="inline" id="S5.T2.15.m3.1"><semantics id="S5.T2.15.m3.1b"><mover accent="true" id="S5.T2.15.m3.1.1" xref="S5.T2.15.m3.1.1.cmml"><mo id="S5.T2.15.m3.1.1.2" xref="S5.T2.15.m3.1.1.2.cmml">⋅</mo><mo id="S5.T2.15.m3.1.1.1" xref="S5.T2.15.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S5.T2.15.m3.1c"><apply id="S5.T2.15.m3.1.1.cmml" xref="S5.T2.15.m3.1.1"><ci id="S5.T2.15.m3.1.1.1.cmml" xref="S5.T2.15.m3.1.1.1">¯</ci><ci id="S5.T2.15.m3.1.1.2.cmml" xref="S5.T2.15.m3.1.1.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.m3.1d">\overline{\cdot}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.15.m3.1e">over¯ start_ARG ⋅ end_ARG</annotation></semantics></math> denotes conjugate for complex vectors in ComplEx, and 2D reshape for real vectors in ConvE and other models. <math alttext="\circ" class="ltx_Math" display="inline" id="S5.T2.16.m4.1"><semantics id="S5.T2.16.m4.1b"><mo id="S5.T2.16.m4.1.1" xref="S5.T2.16.m4.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S5.T2.16.m4.1c"><compose id="S5.T2.16.m4.1.1.cmml" xref="S5.T2.16.m4.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.m4.1d">\circ</annotation><annotation encoding="application/x-llamapun" id="S5.T2.16.m4.1e">∘</annotation></semantics></math> means Hadamard product. <math alttext="\ast" class="ltx_Math" display="inline" id="S5.T2.17.m5.1"><semantics id="S5.T2.17.m5.1b"><mo id="S5.T2.17.m5.1.1" xref="S5.T2.17.m5.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S5.T2.17.m5.1c"><ci id="S5.T2.17.m5.1.1.cmml" xref="S5.T2.17.m5.1.1">∗</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.m5.1d">\ast</annotation><annotation encoding="application/x-llamapun" id="S5.T2.17.m5.1e">∗</annotation></semantics></math> indicates convolution operation. <math alttext="\sigma" class="ltx_Math" display="inline" id="S5.T2.18.m6.1"><semantics id="S5.T2.18.m6.1b"><mi id="S5.T2.18.m6.1.1" xref="S5.T2.18.m6.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S5.T2.18.m6.1c"><ci id="S5.T2.18.m6.1.1.cmml" xref="S5.T2.18.m6.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.m6.1d">\sigma</annotation><annotation encoding="application/x-llamapun" id="S5.T2.18.m6.1e">italic_σ</annotation></semantics></math> represents a non-linear activation function, such as tanh. <math alttext="||_{1}^{K}" class="ltx_math_unparsed" display="inline" id="S5.T2.19.m7.1"><semantics id="S5.T2.19.m7.1b"><mrow id="S5.T2.19.m7.1c"><mo fence="false" id="S5.T2.19.m7.1.1" rspace="0.167em" stretchy="false">|</mo><msubsup id="S5.T2.19.m7.1.2"><mo fence="false" id="S5.T2.19.m7.1.2.2.2" stretchy="false">|</mo><mn id="S5.T2.19.m7.1.2.2.3">1</mn><mi id="S5.T2.19.m7.1.2.3">K</mi></msubsup></mrow><annotation encoding="application/x-tex" id="S5.T2.19.m7.1d">||_{1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.19.m7.1e">| | start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math> means multi-head attention mechanism. <math alttext="\otimes" class="ltx_Math" display="inline" id="S5.T2.20.m8.1"><semantics id="S5.T2.20.m8.1b"><mo id="S5.T2.20.m8.1.1" xref="S5.T2.20.m8.1.1.cmml">⊗</mo><annotation-xml encoding="MathML-Content" id="S5.T2.20.m8.1c"><csymbol cd="latexml" id="S5.T2.20.m8.1.1.cmml" xref="S5.T2.20.m8.1.1">tensor-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.20.m8.1d">\otimes</annotation><annotation encoding="application/x-llamapun" id="S5.T2.20.m8.1e">⊗</annotation></semantics></math> means the Hamilton product. <math alttext="\bigstar" class="ltx_Math" display="inline" id="S5.T2.21.m9.1"><semantics id="S5.T2.21.m9.1b"><mi id="S5.T2.21.m9.1.1" mathvariant="normal" xref="S5.T2.21.m9.1.1.cmml">★</mi><annotation-xml encoding="MathML-Content" id="S5.T2.21.m9.1c"><ci id="S5.T2.21.m9.1.1.cmml" xref="S5.T2.21.m9.1.1">★</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.21.m9.1d">\bigstar</annotation><annotation encoding="application/x-llamapun" id="S5.T2.21.m9.1e">★</annotation></semantics></math> denotes depth-wise circular convolution. <math alttext="\phi_{chk}" class="ltx_Math" display="inline" id="S5.T2.22.m10.1"><semantics id="S5.T2.22.m10.1b"><msub id="S5.T2.22.m10.1.1" xref="S5.T2.22.m10.1.1.cmml"><mi id="S5.T2.22.m10.1.1.2" xref="S5.T2.22.m10.1.1.2.cmml">ϕ</mi><mrow id="S5.T2.22.m10.1.1.3" xref="S5.T2.22.m10.1.1.3.cmml"><mi id="S5.T2.22.m10.1.1.3.2" xref="S5.T2.22.m10.1.1.3.2.cmml">c</mi><mo id="S5.T2.22.m10.1.1.3.1" xref="S5.T2.22.m10.1.1.3.1.cmml">⁢</mo><mi id="S5.T2.22.m10.1.1.3.3" xref="S5.T2.22.m10.1.1.3.3.cmml">h</mi><mo id="S5.T2.22.m10.1.1.3.1b" xref="S5.T2.22.m10.1.1.3.1.cmml">⁢</mo><mi id="S5.T2.22.m10.1.1.3.4" xref="S5.T2.22.m10.1.1.3.4.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.22.m10.1c"><apply id="S5.T2.22.m10.1.1.cmml" xref="S5.T2.22.m10.1.1"><csymbol cd="ambiguous" id="S5.T2.22.m10.1.1.1.cmml" xref="S5.T2.22.m10.1.1">subscript</csymbol><ci id="S5.T2.22.m10.1.1.2.cmml" xref="S5.T2.22.m10.1.1.2">italic-ϕ</ci><apply id="S5.T2.22.m10.1.1.3.cmml" xref="S5.T2.22.m10.1.1.3"><times id="S5.T2.22.m10.1.1.3.1.cmml" xref="S5.T2.22.m10.1.1.3.1"></times><ci id="S5.T2.22.m10.1.1.3.2.cmml" xref="S5.T2.22.m10.1.1.3.2">𝑐</ci><ci id="S5.T2.22.m10.1.1.3.3.cmml" xref="S5.T2.22.m10.1.1.3.3">ℎ</ci><ci id="S5.T2.22.m10.1.1.3.4.cmml" xref="S5.T2.22.m10.1.1.3.4">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.22.m10.1d">\phi_{chk}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.22.m10.1e">italic_ϕ start_POSTSUBSCRIPT italic_c italic_h italic_k end_POSTSUBSCRIPT</annotation></semantics></math> rearranges the input vector sequence and combines the elements at the same position to output. A simple example is:<math alttext="\phi_{chk}([x_{1},x_{2},x_{3}],[y_{1},y_{2},y_{3}])=[x_{1},y_{1},x_{2},y_{2},x%
_{3},y_{3}]" class="ltx_Math" display="inline" id="S5.T2.23.m11.8"><semantics id="S5.T2.23.m11.8b"><mrow id="S5.T2.23.m11.8.8" xref="S5.T2.23.m11.8.8.cmml"><mrow id="S5.T2.23.m11.2.2.2" xref="S5.T2.23.m11.2.2.2.cmml"><msub id="S5.T2.23.m11.2.2.2.4" xref="S5.T2.23.m11.2.2.2.4.cmml"><mi id="S5.T2.23.m11.2.2.2.4.2" xref="S5.T2.23.m11.2.2.2.4.2.cmml">ϕ</mi><mrow id="S5.T2.23.m11.2.2.2.4.3" xref="S5.T2.23.m11.2.2.2.4.3.cmml"><mi id="S5.T2.23.m11.2.2.2.4.3.2" xref="S5.T2.23.m11.2.2.2.4.3.2.cmml">c</mi><mo id="S5.T2.23.m11.2.2.2.4.3.1" xref="S5.T2.23.m11.2.2.2.4.3.1.cmml">⁢</mo><mi id="S5.T2.23.m11.2.2.2.4.3.3" xref="S5.T2.23.m11.2.2.2.4.3.3.cmml">h</mi><mo id="S5.T2.23.m11.2.2.2.4.3.1b" xref="S5.T2.23.m11.2.2.2.4.3.1.cmml">⁢</mo><mi id="S5.T2.23.m11.2.2.2.4.3.4" xref="S5.T2.23.m11.2.2.2.4.3.4.cmml">k</mi></mrow></msub><mo id="S5.T2.23.m11.2.2.2.3" xref="S5.T2.23.m11.2.2.2.3.cmml">⁢</mo><mrow id="S5.T2.23.m11.2.2.2.2.2" xref="S5.T2.23.m11.2.2.2.2.3.cmml"><mo id="S5.T2.23.m11.2.2.2.2.2.3" stretchy="false" xref="S5.T2.23.m11.2.2.2.2.3.cmml">(</mo><mrow id="S5.T2.23.m11.1.1.1.1.1.1.3" xref="S5.T2.23.m11.1.1.1.1.1.1.4.cmml"><mo id="S5.T2.23.m11.1.1.1.1.1.1.3.4" stretchy="false" xref="S5.T2.23.m11.1.1.1.1.1.1.4.cmml">[</mo><msub id="S5.T2.23.m11.1.1.1.1.1.1.1.1" xref="S5.T2.23.m11.1.1.1.1.1.1.1.1.cmml"><mi id="S5.T2.23.m11.1.1.1.1.1.1.1.1.2" xref="S5.T2.23.m11.1.1.1.1.1.1.1.1.2.cmml">x</mi><mn id="S5.T2.23.m11.1.1.1.1.1.1.1.1.3" xref="S5.T2.23.m11.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S5.T2.23.m11.1.1.1.1.1.1.3.5" xref="S5.T2.23.m11.1.1.1.1.1.1.4.cmml">,</mo><msub id="S5.T2.23.m11.1.1.1.1.1.1.2.2" xref="S5.T2.23.m11.1.1.1.1.1.1.2.2.cmml"><mi id="S5.T2.23.m11.1.1.1.1.1.1.2.2.2" xref="S5.T2.23.m11.1.1.1.1.1.1.2.2.2.cmml">x</mi><mn id="S5.T2.23.m11.1.1.1.1.1.1.2.2.3" xref="S5.T2.23.m11.1.1.1.1.1.1.2.2.3.cmml">2</mn></msub><mo id="S5.T2.23.m11.1.1.1.1.1.1.3.6" xref="S5.T2.23.m11.1.1.1.1.1.1.4.cmml">,</mo><msub id="S5.T2.23.m11.1.1.1.1.1.1.3.3" xref="S5.T2.23.m11.1.1.1.1.1.1.3.3.cmml"><mi id="S5.T2.23.m11.1.1.1.1.1.1.3.3.2" xref="S5.T2.23.m11.1.1.1.1.1.1.3.3.2.cmml">x</mi><mn id="S5.T2.23.m11.1.1.1.1.1.1.3.3.3" xref="S5.T2.23.m11.1.1.1.1.1.1.3.3.3.cmml">3</mn></msub><mo id="S5.T2.23.m11.1.1.1.1.1.1.3.7" stretchy="false" xref="S5.T2.23.m11.1.1.1.1.1.1.4.cmml">]</mo></mrow><mo id="S5.T2.23.m11.2.2.2.2.2.4" xref="S5.T2.23.m11.2.2.2.2.3.cmml">,</mo><mrow id="S5.T2.23.m11.2.2.2.2.2.2.3" xref="S5.T2.23.m11.2.2.2.2.2.2.4.cmml"><mo id="S5.T2.23.m11.2.2.2.2.2.2.3.4" stretchy="false" xref="S5.T2.23.m11.2.2.2.2.2.2.4.cmml">[</mo><msub id="S5.T2.23.m11.2.2.2.2.2.2.1.1" xref="S5.T2.23.m11.2.2.2.2.2.2.1.1.cmml"><mi id="S5.T2.23.m11.2.2.2.2.2.2.1.1.2" xref="S5.T2.23.m11.2.2.2.2.2.2.1.1.2.cmml">y</mi><mn id="S5.T2.23.m11.2.2.2.2.2.2.1.1.3" xref="S5.T2.23.m11.2.2.2.2.2.2.1.1.3.cmml">1</mn></msub><mo id="S5.T2.23.m11.2.2.2.2.2.2.3.5" xref="S5.T2.23.m11.2.2.2.2.2.2.4.cmml">,</mo><msub id="S5.T2.23.m11.2.2.2.2.2.2.2.2" xref="S5.T2.23.m11.2.2.2.2.2.2.2.2.cmml"><mi id="S5.T2.23.m11.2.2.2.2.2.2.2.2.2" xref="S5.T2.23.m11.2.2.2.2.2.2.2.2.2.cmml">y</mi><mn id="S5.T2.23.m11.2.2.2.2.2.2.2.2.3" xref="S5.T2.23.m11.2.2.2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S5.T2.23.m11.2.2.2.2.2.2.3.6" xref="S5.T2.23.m11.2.2.2.2.2.2.4.cmml">,</mo><msub id="S5.T2.23.m11.2.2.2.2.2.2.3.3" xref="S5.T2.23.m11.2.2.2.2.2.2.3.3.cmml"><mi id="S5.T2.23.m11.2.2.2.2.2.2.3.3.2" xref="S5.T2.23.m11.2.2.2.2.2.2.3.3.2.cmml">y</mi><mn id="S5.T2.23.m11.2.2.2.2.2.2.3.3.3" xref="S5.T2.23.m11.2.2.2.2.2.2.3.3.3.cmml">3</mn></msub><mo id="S5.T2.23.m11.2.2.2.2.2.2.3.7" stretchy="false" xref="S5.T2.23.m11.2.2.2.2.2.2.4.cmml">]</mo></mrow><mo id="S5.T2.23.m11.2.2.2.2.2.5" stretchy="false" xref="S5.T2.23.m11.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S5.T2.23.m11.8.8.9" xref="S5.T2.23.m11.8.8.9.cmml">=</mo><mrow id="S5.T2.23.m11.8.8.8.6" xref="S5.T2.23.m11.8.8.8.7.cmml"><mo id="S5.T2.23.m11.8.8.8.6.7" stretchy="false" xref="S5.T2.23.m11.8.8.8.7.cmml">[</mo><msub id="S5.T2.23.m11.3.3.3.1.1" xref="S5.T2.23.m11.3.3.3.1.1.cmml"><mi id="S5.T2.23.m11.3.3.3.1.1.2" xref="S5.T2.23.m11.3.3.3.1.1.2.cmml">x</mi><mn id="S5.T2.23.m11.3.3.3.1.1.3" xref="S5.T2.23.m11.3.3.3.1.1.3.cmml">1</mn></msub><mo id="S5.T2.23.m11.8.8.8.6.8" xref="S5.T2.23.m11.8.8.8.7.cmml">,</mo><msub id="S5.T2.23.m11.4.4.4.2.2" xref="S5.T2.23.m11.4.4.4.2.2.cmml"><mi id="S5.T2.23.m11.4.4.4.2.2.2" xref="S5.T2.23.m11.4.4.4.2.2.2.cmml">y</mi><mn id="S5.T2.23.m11.4.4.4.2.2.3" xref="S5.T2.23.m11.4.4.4.2.2.3.cmml">1</mn></msub><mo id="S5.T2.23.m11.8.8.8.6.9" xref="S5.T2.23.m11.8.8.8.7.cmml">,</mo><msub id="S5.T2.23.m11.5.5.5.3.3" xref="S5.T2.23.m11.5.5.5.3.3.cmml"><mi id="S5.T2.23.m11.5.5.5.3.3.2" xref="S5.T2.23.m11.5.5.5.3.3.2.cmml">x</mi><mn id="S5.T2.23.m11.5.5.5.3.3.3" xref="S5.T2.23.m11.5.5.5.3.3.3.cmml">2</mn></msub><mo id="S5.T2.23.m11.8.8.8.6.10" xref="S5.T2.23.m11.8.8.8.7.cmml">,</mo><msub id="S5.T2.23.m11.6.6.6.4.4" xref="S5.T2.23.m11.6.6.6.4.4.cmml"><mi id="S5.T2.23.m11.6.6.6.4.4.2" xref="S5.T2.23.m11.6.6.6.4.4.2.cmml">y</mi><mn id="S5.T2.23.m11.6.6.6.4.4.3" xref="S5.T2.23.m11.6.6.6.4.4.3.cmml">2</mn></msub><mo id="S5.T2.23.m11.8.8.8.6.11" xref="S5.T2.23.m11.8.8.8.7.cmml">,</mo><msub id="S5.T2.23.m11.7.7.7.5.5" xref="S5.T2.23.m11.7.7.7.5.5.cmml"><mi id="S5.T2.23.m11.7.7.7.5.5.2" xref="S5.T2.23.m11.7.7.7.5.5.2.cmml">x</mi><mn id="S5.T2.23.m11.7.7.7.5.5.3" xref="S5.T2.23.m11.7.7.7.5.5.3.cmml">3</mn></msub><mo id="S5.T2.23.m11.8.8.8.6.12" xref="S5.T2.23.m11.8.8.8.7.cmml">,</mo><msub id="S5.T2.23.m11.8.8.8.6.6" xref="S5.T2.23.m11.8.8.8.6.6.cmml"><mi id="S5.T2.23.m11.8.8.8.6.6.2" xref="S5.T2.23.m11.8.8.8.6.6.2.cmml">y</mi><mn id="S5.T2.23.m11.8.8.8.6.6.3" xref="S5.T2.23.m11.8.8.8.6.6.3.cmml">3</mn></msub><mo id="S5.T2.23.m11.8.8.8.6.13" stretchy="false" xref="S5.T2.23.m11.8.8.8.7.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.23.m11.8c"><apply id="S5.T2.23.m11.8.8.cmml" xref="S5.T2.23.m11.8.8"><eq id="S5.T2.23.m11.8.8.9.cmml" xref="S5.T2.23.m11.8.8.9"></eq><apply id="S5.T2.23.m11.2.2.2.cmml" xref="S5.T2.23.m11.2.2.2"><times id="S5.T2.23.m11.2.2.2.3.cmml" xref="S5.T2.23.m11.2.2.2.3"></times><apply id="S5.T2.23.m11.2.2.2.4.cmml" xref="S5.T2.23.m11.2.2.2.4"><csymbol cd="ambiguous" id="S5.T2.23.m11.2.2.2.4.1.cmml" xref="S5.T2.23.m11.2.2.2.4">subscript</csymbol><ci id="S5.T2.23.m11.2.2.2.4.2.cmml" xref="S5.T2.23.m11.2.2.2.4.2">italic-ϕ</ci><apply id="S5.T2.23.m11.2.2.2.4.3.cmml" xref="S5.T2.23.m11.2.2.2.4.3"><times id="S5.T2.23.m11.2.2.2.4.3.1.cmml" xref="S5.T2.23.m11.2.2.2.4.3.1"></times><ci id="S5.T2.23.m11.2.2.2.4.3.2.cmml" xref="S5.T2.23.m11.2.2.2.4.3.2">𝑐</ci><ci id="S5.T2.23.m11.2.2.2.4.3.3.cmml" xref="S5.T2.23.m11.2.2.2.4.3.3">ℎ</ci><ci id="S5.T2.23.m11.2.2.2.4.3.4.cmml" xref="S5.T2.23.m11.2.2.2.4.3.4">𝑘</ci></apply></apply><interval closure="open" id="S5.T2.23.m11.2.2.2.2.3.cmml" xref="S5.T2.23.m11.2.2.2.2.2"><list id="S5.T2.23.m11.1.1.1.1.1.1.4.cmml" xref="S5.T2.23.m11.1.1.1.1.1.1.3"><apply id="S5.T2.23.m11.1.1.1.1.1.1.1.1.cmml" xref="S5.T2.23.m11.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.T2.23.m11.1.1.1.1.1.1.1.1.1.cmml" xref="S5.T2.23.m11.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.T2.23.m11.1.1.1.1.1.1.1.1.2.cmml" xref="S5.T2.23.m11.1.1.1.1.1.1.1.1.2">𝑥</ci><cn id="S5.T2.23.m11.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S5.T2.23.m11.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S5.T2.23.m11.1.1.1.1.1.1.2.2.cmml" xref="S5.T2.23.m11.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.T2.23.m11.1.1.1.1.1.1.2.2.1.cmml" xref="S5.T2.23.m11.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S5.T2.23.m11.1.1.1.1.1.1.2.2.2.cmml" xref="S5.T2.23.m11.1.1.1.1.1.1.2.2.2">𝑥</ci><cn id="S5.T2.23.m11.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S5.T2.23.m11.1.1.1.1.1.1.2.2.3">2</cn></apply><apply id="S5.T2.23.m11.1.1.1.1.1.1.3.3.cmml" xref="S5.T2.23.m11.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T2.23.m11.1.1.1.1.1.1.3.3.1.cmml" xref="S5.T2.23.m11.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S5.T2.23.m11.1.1.1.1.1.1.3.3.2.cmml" xref="S5.T2.23.m11.1.1.1.1.1.1.3.3.2">𝑥</ci><cn id="S5.T2.23.m11.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S5.T2.23.m11.1.1.1.1.1.1.3.3.3">3</cn></apply></list><list id="S5.T2.23.m11.2.2.2.2.2.2.4.cmml" xref="S5.T2.23.m11.2.2.2.2.2.2.3"><apply id="S5.T2.23.m11.2.2.2.2.2.2.1.1.cmml" xref="S5.T2.23.m11.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S5.T2.23.m11.2.2.2.2.2.2.1.1.1.cmml" xref="S5.T2.23.m11.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S5.T2.23.m11.2.2.2.2.2.2.1.1.2.cmml" xref="S5.T2.23.m11.2.2.2.2.2.2.1.1.2">𝑦</ci><cn id="S5.T2.23.m11.2.2.2.2.2.2.1.1.3.cmml" type="integer" xref="S5.T2.23.m11.2.2.2.2.2.2.1.1.3">1</cn></apply><apply id="S5.T2.23.m11.2.2.2.2.2.2.2.2.cmml" xref="S5.T2.23.m11.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.T2.23.m11.2.2.2.2.2.2.2.2.1.cmml" xref="S5.T2.23.m11.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S5.T2.23.m11.2.2.2.2.2.2.2.2.2.cmml" xref="S5.T2.23.m11.2.2.2.2.2.2.2.2.2">𝑦</ci><cn id="S5.T2.23.m11.2.2.2.2.2.2.2.2.3.cmml" type="integer" xref="S5.T2.23.m11.2.2.2.2.2.2.2.2.3">2</cn></apply><apply id="S5.T2.23.m11.2.2.2.2.2.2.3.3.cmml" xref="S5.T2.23.m11.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S5.T2.23.m11.2.2.2.2.2.2.3.3.1.cmml" xref="S5.T2.23.m11.2.2.2.2.2.2.3.3">subscript</csymbol><ci id="S5.T2.23.m11.2.2.2.2.2.2.3.3.2.cmml" xref="S5.T2.23.m11.2.2.2.2.2.2.3.3.2">𝑦</ci><cn id="S5.T2.23.m11.2.2.2.2.2.2.3.3.3.cmml" type="integer" xref="S5.T2.23.m11.2.2.2.2.2.2.3.3.3">3</cn></apply></list></interval></apply><list id="S5.T2.23.m11.8.8.8.7.cmml" xref="S5.T2.23.m11.8.8.8.6"><apply id="S5.T2.23.m11.3.3.3.1.1.cmml" xref="S5.T2.23.m11.3.3.3.1.1"><csymbol cd="ambiguous" id="S5.T2.23.m11.3.3.3.1.1.1.cmml" xref="S5.T2.23.m11.3.3.3.1.1">subscript</csymbol><ci id="S5.T2.23.m11.3.3.3.1.1.2.cmml" xref="S5.T2.23.m11.3.3.3.1.1.2">𝑥</ci><cn id="S5.T2.23.m11.3.3.3.1.1.3.cmml" type="integer" xref="S5.T2.23.m11.3.3.3.1.1.3">1</cn></apply><apply id="S5.T2.23.m11.4.4.4.2.2.cmml" xref="S5.T2.23.m11.4.4.4.2.2"><csymbol cd="ambiguous" id="S5.T2.23.m11.4.4.4.2.2.1.cmml" xref="S5.T2.23.m11.4.4.4.2.2">subscript</csymbol><ci id="S5.T2.23.m11.4.4.4.2.2.2.cmml" xref="S5.T2.23.m11.4.4.4.2.2.2">𝑦</ci><cn id="S5.T2.23.m11.4.4.4.2.2.3.cmml" type="integer" xref="S5.T2.23.m11.4.4.4.2.2.3">1</cn></apply><apply id="S5.T2.23.m11.5.5.5.3.3.cmml" xref="S5.T2.23.m11.5.5.5.3.3"><csymbol cd="ambiguous" id="S5.T2.23.m11.5.5.5.3.3.1.cmml" xref="S5.T2.23.m11.5.5.5.3.3">subscript</csymbol><ci id="S5.T2.23.m11.5.5.5.3.3.2.cmml" xref="S5.T2.23.m11.5.5.5.3.3.2">𝑥</ci><cn id="S5.T2.23.m11.5.5.5.3.3.3.cmml" type="integer" xref="S5.T2.23.m11.5.5.5.3.3.3">2</cn></apply><apply id="S5.T2.23.m11.6.6.6.4.4.cmml" xref="S5.T2.23.m11.6.6.6.4.4"><csymbol cd="ambiguous" id="S5.T2.23.m11.6.6.6.4.4.1.cmml" xref="S5.T2.23.m11.6.6.6.4.4">subscript</csymbol><ci id="S5.T2.23.m11.6.6.6.4.4.2.cmml" xref="S5.T2.23.m11.6.6.6.4.4.2">𝑦</ci><cn id="S5.T2.23.m11.6.6.6.4.4.3.cmml" type="integer" xref="S5.T2.23.m11.6.6.6.4.4.3">2</cn></apply><apply id="S5.T2.23.m11.7.7.7.5.5.cmml" xref="S5.T2.23.m11.7.7.7.5.5"><csymbol cd="ambiguous" id="S5.T2.23.m11.7.7.7.5.5.1.cmml" xref="S5.T2.23.m11.7.7.7.5.5">subscript</csymbol><ci id="S5.T2.23.m11.7.7.7.5.5.2.cmml" xref="S5.T2.23.m11.7.7.7.5.5.2">𝑥</ci><cn id="S5.T2.23.m11.7.7.7.5.5.3.cmml" type="integer" xref="S5.T2.23.m11.7.7.7.5.5.3">3</cn></apply><apply id="S5.T2.23.m11.8.8.8.6.6.cmml" xref="S5.T2.23.m11.8.8.8.6.6"><csymbol cd="ambiguous" id="S5.T2.23.m11.8.8.8.6.6.1.cmml" xref="S5.T2.23.m11.8.8.8.6.6">subscript</csymbol><ci id="S5.T2.23.m11.8.8.8.6.6.2.cmml" xref="S5.T2.23.m11.8.8.8.6.6.2">𝑦</ci><cn id="S5.T2.23.m11.8.8.8.6.6.3.cmml" type="integer" xref="S5.T2.23.m11.8.8.8.6.6.3">3</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.23.m11.8d">\phi_{chk}([x_{1},x_{2},x_{3}],[y_{1},y_{2},y_{3}])=[x_{1},y_{1},x_{2},y_{2},x%
_{3},y_{3}]</annotation><annotation encoding="application/x-llamapun" id="S5.T2.23.m11.8e">italic_ϕ start_POSTSUBSCRIPT italic_c italic_h italic_k end_POSTSUBSCRIPT ( [ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ] , [ italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ] ) = [ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ]</annotation></semantics></math>. <math alttext="vec(\cdot)" class="ltx_Math" display="inline" id="S5.T2.24.m12.1"><semantics id="S5.T2.24.m12.1b"><mrow id="S5.T2.24.m12.1.2" xref="S5.T2.24.m12.1.2.cmml"><mi id="S5.T2.24.m12.1.2.2" xref="S5.T2.24.m12.1.2.2.cmml">v</mi><mo id="S5.T2.24.m12.1.2.1" xref="S5.T2.24.m12.1.2.1.cmml">⁢</mo><mi id="S5.T2.24.m12.1.2.3" xref="S5.T2.24.m12.1.2.3.cmml">e</mi><mo id="S5.T2.24.m12.1.2.1b" xref="S5.T2.24.m12.1.2.1.cmml">⁢</mo><mi id="S5.T2.24.m12.1.2.4" xref="S5.T2.24.m12.1.2.4.cmml">c</mi><mo id="S5.T2.24.m12.1.2.1c" xref="S5.T2.24.m12.1.2.1.cmml">⁢</mo><mrow id="S5.T2.24.m12.1.2.5.2" xref="S5.T2.24.m12.1.2.cmml"><mo id="S5.T2.24.m12.1.2.5.2.1" stretchy="false" xref="S5.T2.24.m12.1.2.cmml">(</mo><mo id="S5.T2.24.m12.1.1" lspace="0em" rspace="0em" xref="S5.T2.24.m12.1.1.cmml">⋅</mo><mo id="S5.T2.24.m12.1.2.5.2.2" stretchy="false" xref="S5.T2.24.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.24.m12.1c"><apply id="S5.T2.24.m12.1.2.cmml" xref="S5.T2.24.m12.1.2"><times id="S5.T2.24.m12.1.2.1.cmml" xref="S5.T2.24.m12.1.2.1"></times><ci id="S5.T2.24.m12.1.2.2.cmml" xref="S5.T2.24.m12.1.2.2">𝑣</ci><ci id="S5.T2.24.m12.1.2.3.cmml" xref="S5.T2.24.m12.1.2.3">𝑒</ci><ci id="S5.T2.24.m12.1.2.4.cmml" xref="S5.T2.24.m12.1.2.4">𝑐</ci><ci id="S5.T2.24.m12.1.1.cmml" xref="S5.T2.24.m12.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.24.m12.1d">vec(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.24.m12.1e">italic_v italic_e italic_c ( ⋅ )</annotation></semantics></math> means to convert all inputs to a vector. Both RotatE and ComplEx perform embedding in the complex domain.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T2.43">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.43.20.1">
<td class="ltx_td ltx_align_left ltx_border_tt ltx_border_t" id="S5.T2.43.20.1.1"><span class="ltx_text ltx_font_bold" id="S5.T2.43.20.1.1.1">Models</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt ltx_border_t" id="S5.T2.43.20.1.2">Feature Propagation</td>
<td class="ltx_td ltx_align_left ltx_border_tt ltx_border_t" id="S5.T2.43.20.1.3">Score Function</td>
</tr>
<tr class="ltx_tr" id="S5.T2.25.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.25.1.2">TransE</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.25.1.3">-</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.25.1.1"><math alttext="||h+r-t||_{p}" class="ltx_Math" display="inline" id="S5.T2.25.1.1.m1.1"><semantics id="S5.T2.25.1.1.m1.1a"><msub id="S5.T2.25.1.1.m1.1.1" xref="S5.T2.25.1.1.m1.1.1.cmml"><mrow id="S5.T2.25.1.1.m1.1.1.1.1" xref="S5.T2.25.1.1.m1.1.1.1.2.cmml"><mo id="S5.T2.25.1.1.m1.1.1.1.1.2" stretchy="false" xref="S5.T2.25.1.1.m1.1.1.1.2.1.cmml">‖</mo><mrow id="S5.T2.25.1.1.m1.1.1.1.1.1" xref="S5.T2.25.1.1.m1.1.1.1.1.1.cmml"><mrow id="S5.T2.25.1.1.m1.1.1.1.1.1.2" xref="S5.T2.25.1.1.m1.1.1.1.1.1.2.cmml"><mi id="S5.T2.25.1.1.m1.1.1.1.1.1.2.2" xref="S5.T2.25.1.1.m1.1.1.1.1.1.2.2.cmml">h</mi><mo id="S5.T2.25.1.1.m1.1.1.1.1.1.2.1" xref="S5.T2.25.1.1.m1.1.1.1.1.1.2.1.cmml">+</mo><mi id="S5.T2.25.1.1.m1.1.1.1.1.1.2.3" xref="S5.T2.25.1.1.m1.1.1.1.1.1.2.3.cmml">r</mi></mrow><mo id="S5.T2.25.1.1.m1.1.1.1.1.1.1" xref="S5.T2.25.1.1.m1.1.1.1.1.1.1.cmml">−</mo><mi id="S5.T2.25.1.1.m1.1.1.1.1.1.3" xref="S5.T2.25.1.1.m1.1.1.1.1.1.3.cmml">t</mi></mrow><mo id="S5.T2.25.1.1.m1.1.1.1.1.3" stretchy="false" xref="S5.T2.25.1.1.m1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S5.T2.25.1.1.m1.1.1.3" xref="S5.T2.25.1.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S5.T2.25.1.1.m1.1b"><apply id="S5.T2.25.1.1.m1.1.1.cmml" xref="S5.T2.25.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.25.1.1.m1.1.1.2.cmml" xref="S5.T2.25.1.1.m1.1.1">subscript</csymbol><apply id="S5.T2.25.1.1.m1.1.1.1.2.cmml" xref="S5.T2.25.1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S5.T2.25.1.1.m1.1.1.1.2.1.cmml" xref="S5.T2.25.1.1.m1.1.1.1.1.2">norm</csymbol><apply id="S5.T2.25.1.1.m1.1.1.1.1.1.cmml" xref="S5.T2.25.1.1.m1.1.1.1.1.1"><minus id="S5.T2.25.1.1.m1.1.1.1.1.1.1.cmml" xref="S5.T2.25.1.1.m1.1.1.1.1.1.1"></minus><apply id="S5.T2.25.1.1.m1.1.1.1.1.1.2.cmml" xref="S5.T2.25.1.1.m1.1.1.1.1.1.2"><plus id="S5.T2.25.1.1.m1.1.1.1.1.1.2.1.cmml" xref="S5.T2.25.1.1.m1.1.1.1.1.1.2.1"></plus><ci id="S5.T2.25.1.1.m1.1.1.1.1.1.2.2.cmml" xref="S5.T2.25.1.1.m1.1.1.1.1.1.2.2">ℎ</ci><ci id="S5.T2.25.1.1.m1.1.1.1.1.1.2.3.cmml" xref="S5.T2.25.1.1.m1.1.1.1.1.1.2.3">𝑟</ci></apply><ci id="S5.T2.25.1.1.m1.1.1.1.1.1.3.cmml" xref="S5.T2.25.1.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="S5.T2.25.1.1.m1.1.1.3.cmml" xref="S5.T2.25.1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.25.1.1.m1.1c">||h+r-t||_{p}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.25.1.1.m1.1d">| | italic_h + italic_r - italic_t | | start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.26.2">
<td class="ltx_td ltx_align_left" id="S5.T2.26.2.2">DistMult</td>
<td class="ltx_td ltx_align_left" id="S5.T2.26.2.3">-</td>
<td class="ltx_td ltx_align_left" id="S5.T2.26.2.1"><math alttext="&lt;r,h,t&gt;" class="ltx_math_unparsed" display="inline" id="S5.T2.26.2.1.m1.3"><semantics id="S5.T2.26.2.1.m1.3a"><mrow id="S5.T2.26.2.1.m1.3b"><mo id="S5.T2.26.2.1.m1.3.4">&lt;</mo><mi id="S5.T2.26.2.1.m1.1.1">r</mi><mo id="S5.T2.26.2.1.m1.3.5">,</mo><mi id="S5.T2.26.2.1.m1.2.2">h</mi><mo id="S5.T2.26.2.1.m1.3.6">,</mo><mi id="S5.T2.26.2.1.m1.3.3">t</mi><mo id="S5.T2.26.2.1.m1.3.7">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S5.T2.26.2.1.m1.3c">&lt;r,h,t&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T2.26.2.1.m1.3d">&lt; italic_r , italic_h , italic_t &gt;</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.27.3">
<td class="ltx_td ltx_align_left" id="S5.T2.27.3.2">ComplEx</td>
<td class="ltx_td ltx_align_left" id="S5.T2.27.3.3">-</td>
<td class="ltx_td ltx_align_left" id="S5.T2.27.3.1"><math alttext="Re(&lt;r,h,\overline{t}&gt;)" class="ltx_math_unparsed" display="inline" id="S5.T2.27.3.1.m1.3"><semantics id="S5.T2.27.3.1.m1.3a"><mrow id="S5.T2.27.3.1.m1.3b"><mi id="S5.T2.27.3.1.m1.3.4">R</mi><mi id="S5.T2.27.3.1.m1.3.5">e</mi><mrow id="S5.T2.27.3.1.m1.3.6"><mo id="S5.T2.27.3.1.m1.3.6.1" stretchy="false">(</mo><mo id="S5.T2.27.3.1.m1.3.6.2" lspace="0em">&lt;</mo><mi id="S5.T2.27.3.1.m1.1.1">r</mi><mo id="S5.T2.27.3.1.m1.3.6.3">,</mo><mi id="S5.T2.27.3.1.m1.2.2">h</mi><mo id="S5.T2.27.3.1.m1.3.6.4">,</mo><mover accent="true" id="S5.T2.27.3.1.m1.3.3"><mi id="S5.T2.27.3.1.m1.3.3.2">t</mi><mo id="S5.T2.27.3.1.m1.3.3.1">¯</mo></mover><mo id="S5.T2.27.3.1.m1.3.6.5" rspace="0em">&gt;</mo><mo id="S5.T2.27.3.1.m1.3.6.6" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S5.T2.27.3.1.m1.3c">Re(&lt;r,h,\overline{t}&gt;)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.27.3.1.m1.3d">italic_R italic_e ( &lt; italic_r , italic_h , over¯ start_ARG italic_t end_ARG &gt; )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.28.4">
<td class="ltx_td ltx_align_left" id="S5.T2.28.4.2">ConvE</td>
<td class="ltx_td ltx_align_left" id="S5.T2.28.4.3">-</td>
<td class="ltx_td ltx_align_left" id="S5.T2.28.4.1"><math alttext="&lt;\sigma(vec(\sigma([\overline{h};\overline{r}]\ast\omega))W),t&gt;" class="ltx_math_unparsed" display="inline" id="S5.T2.28.4.1.m1.3"><semantics id="S5.T2.28.4.1.m1.3a"><mrow id="S5.T2.28.4.1.m1.3b"><mo id="S5.T2.28.4.1.m1.3.4">&lt;</mo><mi id="S5.T2.28.4.1.m1.3.5">σ</mi><mrow id="S5.T2.28.4.1.m1.3.6"><mo id="S5.T2.28.4.1.m1.3.6.1" stretchy="false">(</mo><mi id="S5.T2.28.4.1.m1.3.6.2">v</mi><mi id="S5.T2.28.4.1.m1.3.6.3">e</mi><mi id="S5.T2.28.4.1.m1.3.6.4">c</mi><mrow id="S5.T2.28.4.1.m1.3.6.5"><mo id="S5.T2.28.4.1.m1.3.6.5.1" stretchy="false">(</mo><mi id="S5.T2.28.4.1.m1.3.6.5.2">σ</mi><mrow id="S5.T2.28.4.1.m1.3.6.5.3"><mo id="S5.T2.28.4.1.m1.3.6.5.3.1" stretchy="false">(</mo><mrow id="S5.T2.28.4.1.m1.3.6.5.3.2"><mo id="S5.T2.28.4.1.m1.3.6.5.3.2.1" stretchy="false">[</mo><mover accent="true" id="S5.T2.28.4.1.m1.1.1"><mi id="S5.T2.28.4.1.m1.1.1.2">h</mi><mo id="S5.T2.28.4.1.m1.1.1.1">¯</mo></mover><mo id="S5.T2.28.4.1.m1.3.6.5.3.2.2">;</mo><mover accent="true" id="S5.T2.28.4.1.m1.2.2"><mi id="S5.T2.28.4.1.m1.2.2.2">r</mi><mo id="S5.T2.28.4.1.m1.2.2.1">¯</mo></mover><mo id="S5.T2.28.4.1.m1.3.6.5.3.2.3" rspace="0.055em" stretchy="false">]</mo></mrow><mo id="S5.T2.28.4.1.m1.3.6.5.3.3" rspace="0.222em">∗</mo><mi id="S5.T2.28.4.1.m1.3.6.5.3.4">ω</mi><mo id="S5.T2.28.4.1.m1.3.6.5.3.5" stretchy="false">)</mo></mrow><mo id="S5.T2.28.4.1.m1.3.6.5.4" stretchy="false">)</mo></mrow><mi id="S5.T2.28.4.1.m1.3.6.6">W</mi><mo id="S5.T2.28.4.1.m1.3.6.7" stretchy="false">)</mo></mrow><mo id="S5.T2.28.4.1.m1.3.7">,</mo><mi id="S5.T2.28.4.1.m1.3.3">t</mi><mo id="S5.T2.28.4.1.m1.3.8">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S5.T2.28.4.1.m1.3c">&lt;\sigma(vec(\sigma([\overline{h};\overline{r}]\ast\omega))W),t&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T2.28.4.1.m1.3d">&lt; italic_σ ( italic_v italic_e italic_c ( italic_σ ( [ over¯ start_ARG italic_h end_ARG ; over¯ start_ARG italic_r end_ARG ] ∗ italic_ω ) ) italic_W ) , italic_t &gt;</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.29.5">
<td class="ltx_td ltx_align_left" id="S5.T2.29.5.2">RotatE</td>
<td class="ltx_td ltx_align_left" id="S5.T2.29.5.3">-</td>
<td class="ltx_td ltx_align_left" id="S5.T2.29.5.1"><math alttext="||h\circ r-t||_{2}" class="ltx_Math" display="inline" id="S5.T2.29.5.1.m1.1"><semantics id="S5.T2.29.5.1.m1.1a"><msub id="S5.T2.29.5.1.m1.1.1" xref="S5.T2.29.5.1.m1.1.1.cmml"><mrow id="S5.T2.29.5.1.m1.1.1.1.1" xref="S5.T2.29.5.1.m1.1.1.1.2.cmml"><mo id="S5.T2.29.5.1.m1.1.1.1.1.2" stretchy="false" xref="S5.T2.29.5.1.m1.1.1.1.2.1.cmml">‖</mo><mrow id="S5.T2.29.5.1.m1.1.1.1.1.1" xref="S5.T2.29.5.1.m1.1.1.1.1.1.cmml"><mrow id="S5.T2.29.5.1.m1.1.1.1.1.1.2" xref="S5.T2.29.5.1.m1.1.1.1.1.1.2.cmml"><mi id="S5.T2.29.5.1.m1.1.1.1.1.1.2.2" xref="S5.T2.29.5.1.m1.1.1.1.1.1.2.2.cmml">h</mi><mo id="S5.T2.29.5.1.m1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S5.T2.29.5.1.m1.1.1.1.1.1.2.1.cmml">∘</mo><mi id="S5.T2.29.5.1.m1.1.1.1.1.1.2.3" xref="S5.T2.29.5.1.m1.1.1.1.1.1.2.3.cmml">r</mi></mrow><mo id="S5.T2.29.5.1.m1.1.1.1.1.1.1" xref="S5.T2.29.5.1.m1.1.1.1.1.1.1.cmml">−</mo><mi id="S5.T2.29.5.1.m1.1.1.1.1.1.3" xref="S5.T2.29.5.1.m1.1.1.1.1.1.3.cmml">t</mi></mrow><mo id="S5.T2.29.5.1.m1.1.1.1.1.3" stretchy="false" xref="S5.T2.29.5.1.m1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S5.T2.29.5.1.m1.1.1.3" xref="S5.T2.29.5.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.T2.29.5.1.m1.1b"><apply id="S5.T2.29.5.1.m1.1.1.cmml" xref="S5.T2.29.5.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.29.5.1.m1.1.1.2.cmml" xref="S5.T2.29.5.1.m1.1.1">subscript</csymbol><apply id="S5.T2.29.5.1.m1.1.1.1.2.cmml" xref="S5.T2.29.5.1.m1.1.1.1.1"><csymbol cd="latexml" id="S5.T2.29.5.1.m1.1.1.1.2.1.cmml" xref="S5.T2.29.5.1.m1.1.1.1.1.2">norm</csymbol><apply id="S5.T2.29.5.1.m1.1.1.1.1.1.cmml" xref="S5.T2.29.5.1.m1.1.1.1.1.1"><minus id="S5.T2.29.5.1.m1.1.1.1.1.1.1.cmml" xref="S5.T2.29.5.1.m1.1.1.1.1.1.1"></minus><apply id="S5.T2.29.5.1.m1.1.1.1.1.1.2.cmml" xref="S5.T2.29.5.1.m1.1.1.1.1.1.2"><compose id="S5.T2.29.5.1.m1.1.1.1.1.1.2.1.cmml" xref="S5.T2.29.5.1.m1.1.1.1.1.1.2.1"></compose><ci id="S5.T2.29.5.1.m1.1.1.1.1.1.2.2.cmml" xref="S5.T2.29.5.1.m1.1.1.1.1.1.2.2">ℎ</ci><ci id="S5.T2.29.5.1.m1.1.1.1.1.1.2.3.cmml" xref="S5.T2.29.5.1.m1.1.1.1.1.1.2.3">𝑟</ci></apply><ci id="S5.T2.29.5.1.m1.1.1.1.1.1.3.cmml" xref="S5.T2.29.5.1.m1.1.1.1.1.1.3">𝑡</ci></apply></apply><cn id="S5.T2.29.5.1.m1.1.1.3.cmml" type="integer" xref="S5.T2.29.5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.29.5.1.m1.1c">||h\circ r-t||_{2}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.29.5.1.m1.1d">| | italic_h ∘ italic_r - italic_t | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.30.6">
<td class="ltx_td ltx_align_left" id="S5.T2.30.6.2">ConvTransE</td>
<td class="ltx_td ltx_align_left" id="S5.T2.30.6.3">-</td>
<td class="ltx_td ltx_align_left" id="S5.T2.30.6.1"><math alttext="&lt;\sigma(vec(\sigma([h;r]\ast\omega))W),t&gt;" class="ltx_math_unparsed" display="inline" id="S5.T2.30.6.1.m1.3"><semantics id="S5.T2.30.6.1.m1.3a"><mrow id="S5.T2.30.6.1.m1.3b"><mo id="S5.T2.30.6.1.m1.3.4">&lt;</mo><mi id="S5.T2.30.6.1.m1.3.5">σ</mi><mrow id="S5.T2.30.6.1.m1.3.6"><mo id="S5.T2.30.6.1.m1.3.6.1" stretchy="false">(</mo><mi id="S5.T2.30.6.1.m1.3.6.2">v</mi><mi id="S5.T2.30.6.1.m1.3.6.3">e</mi><mi id="S5.T2.30.6.1.m1.3.6.4">c</mi><mrow id="S5.T2.30.6.1.m1.3.6.5"><mo id="S5.T2.30.6.1.m1.3.6.5.1" stretchy="false">(</mo><mi id="S5.T2.30.6.1.m1.3.6.5.2">σ</mi><mrow id="S5.T2.30.6.1.m1.3.6.5.3"><mo id="S5.T2.30.6.1.m1.3.6.5.3.1" stretchy="false">(</mo><mrow id="S5.T2.30.6.1.m1.3.6.5.3.2"><mo id="S5.T2.30.6.1.m1.3.6.5.3.2.1" stretchy="false">[</mo><mi id="S5.T2.30.6.1.m1.1.1">h</mi><mo id="S5.T2.30.6.1.m1.3.6.5.3.2.2">;</mo><mi id="S5.T2.30.6.1.m1.2.2">r</mi><mo id="S5.T2.30.6.1.m1.3.6.5.3.2.3" rspace="0.055em" stretchy="false">]</mo></mrow><mo id="S5.T2.30.6.1.m1.3.6.5.3.3" rspace="0.222em">∗</mo><mi id="S5.T2.30.6.1.m1.3.6.5.3.4">ω</mi><mo id="S5.T2.30.6.1.m1.3.6.5.3.5" stretchy="false">)</mo></mrow><mo id="S5.T2.30.6.1.m1.3.6.5.4" stretchy="false">)</mo></mrow><mi id="S5.T2.30.6.1.m1.3.6.6">W</mi><mo id="S5.T2.30.6.1.m1.3.6.7" stretchy="false">)</mo></mrow><mo id="S5.T2.30.6.1.m1.3.7">,</mo><mi id="S5.T2.30.6.1.m1.3.3">t</mi><mo id="S5.T2.30.6.1.m1.3.8">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S5.T2.30.6.1.m1.3c">&lt;\sigma(vec(\sigma([h;r]\ast\omega))W),t&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T2.30.6.1.m1.3d">&lt; italic_σ ( italic_v italic_e italic_c ( italic_σ ( [ italic_h ; italic_r ] ∗ italic_ω ) ) italic_W ) , italic_t &gt;</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.32.8">
<td class="ltx_td ltx_align_left" id="S5.T2.32.8.3">SACN</td>
<td class="ltx_td ltx_align_left" id="S5.T2.31.7.1"><math alttext="h_{i}^{l+1}=\sigma\left(\sum\limits_{j\in\mathcal{N}_{i}}\alpha_{r}^{l}h_{j}^{%
l}W^{l}+h_{i}^{l}W^{l}\right)" class="ltx_Math" display="inline" id="S5.T2.31.7.1.m1.1"><semantics id="S5.T2.31.7.1.m1.1a"><mrow id="S5.T2.31.7.1.m1.1.1" xref="S5.T2.31.7.1.m1.1.1.cmml"><msubsup id="S5.T2.31.7.1.m1.1.1.3" xref="S5.T2.31.7.1.m1.1.1.3.cmml"><mi id="S5.T2.31.7.1.m1.1.1.3.2.2" xref="S5.T2.31.7.1.m1.1.1.3.2.2.cmml">h</mi><mi id="S5.T2.31.7.1.m1.1.1.3.2.3" xref="S5.T2.31.7.1.m1.1.1.3.2.3.cmml">i</mi><mrow id="S5.T2.31.7.1.m1.1.1.3.3" xref="S5.T2.31.7.1.m1.1.1.3.3.cmml"><mi id="S5.T2.31.7.1.m1.1.1.3.3.2" xref="S5.T2.31.7.1.m1.1.1.3.3.2.cmml">l</mi><mo id="S5.T2.31.7.1.m1.1.1.3.3.1" xref="S5.T2.31.7.1.m1.1.1.3.3.1.cmml">+</mo><mn id="S5.T2.31.7.1.m1.1.1.3.3.3" xref="S5.T2.31.7.1.m1.1.1.3.3.3.cmml">1</mn></mrow></msubsup><mo id="S5.T2.31.7.1.m1.1.1.2" xref="S5.T2.31.7.1.m1.1.1.2.cmml">=</mo><mrow id="S5.T2.31.7.1.m1.1.1.1" xref="S5.T2.31.7.1.m1.1.1.1.cmml"><mi id="S5.T2.31.7.1.m1.1.1.1.3" xref="S5.T2.31.7.1.m1.1.1.1.3.cmml">σ</mi><mo id="S5.T2.31.7.1.m1.1.1.1.2" xref="S5.T2.31.7.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S5.T2.31.7.1.m1.1.1.1.1.1" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.cmml"><mo id="S5.T2.31.7.1.m1.1.1.1.1.1.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.T2.31.7.1.m1.1.1.1.1.1.1" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.cmml"><mrow id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.cmml"><munder id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.cmml"><mo id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.2" lspace="0em" movablelimits="false" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.2.cmml">∑</mo><mrow id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.cmml"><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.2.cmml">j</mi><mo id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.1" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.1.cmml">∈</mo><msub id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3.2.cmml">𝒩</mi><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.cmml"><msubsup id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.2.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">α</mi><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.2.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">r</mi><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.3.cmml">l</mi></msubsup><mo id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.1" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><msubsup id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.2.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.2.2.cmml">h</mi><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.2.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.2.3.cmml">j</mi><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.3.cmml">l</mi></msubsup><mo id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.1a" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><msup id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4.cmml"><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4.2.cmml">W</mi><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4.3.cmml">l</mi></msup></mrow></mrow><mo id="S5.T2.31.7.1.m1.1.1.1.1.1.1.1" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.cmml"><msubsup id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.2.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.2.2.cmml">h</mi><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.2.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.2.3.cmml">i</mi><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.3.cmml">l</mi></msubsup><mo id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.1" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msup id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3.2" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3.3.cmml">l</mi></msup></mrow></mrow><mo id="S5.T2.31.7.1.m1.1.1.1.1.1.3" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.31.7.1.m1.1b"><apply id="S5.T2.31.7.1.m1.1.1.cmml" xref="S5.T2.31.7.1.m1.1.1"><eq id="S5.T2.31.7.1.m1.1.1.2.cmml" xref="S5.T2.31.7.1.m1.1.1.2"></eq><apply id="S5.T2.31.7.1.m1.1.1.3.cmml" xref="S5.T2.31.7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.3.1.cmml" xref="S5.T2.31.7.1.m1.1.1.3">superscript</csymbol><apply id="S5.T2.31.7.1.m1.1.1.3.2.cmml" xref="S5.T2.31.7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.3.2.1.cmml" xref="S5.T2.31.7.1.m1.1.1.3">subscript</csymbol><ci id="S5.T2.31.7.1.m1.1.1.3.2.2.cmml" xref="S5.T2.31.7.1.m1.1.1.3.2.2">ℎ</ci><ci id="S5.T2.31.7.1.m1.1.1.3.2.3.cmml" xref="S5.T2.31.7.1.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S5.T2.31.7.1.m1.1.1.3.3.cmml" xref="S5.T2.31.7.1.m1.1.1.3.3"><plus id="S5.T2.31.7.1.m1.1.1.3.3.1.cmml" xref="S5.T2.31.7.1.m1.1.1.3.3.1"></plus><ci id="S5.T2.31.7.1.m1.1.1.3.3.2.cmml" xref="S5.T2.31.7.1.m1.1.1.3.3.2">𝑙</ci><cn id="S5.T2.31.7.1.m1.1.1.3.3.3.cmml" type="integer" xref="S5.T2.31.7.1.m1.1.1.3.3.3">1</cn></apply></apply><apply id="S5.T2.31.7.1.m1.1.1.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1"><times id="S5.T2.31.7.1.m1.1.1.1.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.2"></times><ci id="S5.T2.31.7.1.m1.1.1.1.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.3">𝜎</ci><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1"><plus id="S5.T2.31.7.1.m1.1.1.1.1.1.1.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.1"></plus><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2"><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.2"></sum><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3"><in id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.1"></in><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.2">𝑗</ci><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3">subscript</csymbol><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3.2">𝒩</ci><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2"><times id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.1"></times><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.2.2">𝛼</ci><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.2.3">𝑟</ci></apply><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.2.3">𝑙</ci></apply><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.2.2">ℎ</ci><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.2.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.2.3">𝑗</ci></apply><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.3.3">𝑙</ci></apply><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4">superscript</csymbol><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4.2">𝑊</ci><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.2.2.4.3">𝑙</ci></apply></apply></apply><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3"><times id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.1"></times><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.2.2">ℎ</ci><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.2.3">𝑖</ci></apply><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><apply id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3.2">𝑊</ci><ci id="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S5.T2.31.7.1.m1.1.1.1.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.31.7.1.m1.1c">h_{i}^{l+1}=\sigma\left(\sum\limits_{j\in\mathcal{N}_{i}}\alpha_{r}^{l}h_{j}^{%
l}W^{l}+h_{i}^{l}W^{l}\right)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.31.7.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT = italic_σ ( ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_α start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT + italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S5.T2.32.8.2"><math alttext="&lt;\sigma(vec(\sigma([h;r]\ast\omega))W),t&gt;" class="ltx_math_unparsed" display="inline" id="S5.T2.32.8.2.m1.3"><semantics id="S5.T2.32.8.2.m1.3a"><mrow id="S5.T2.32.8.2.m1.3b"><mo id="S5.T2.32.8.2.m1.3.4">&lt;</mo><mi id="S5.T2.32.8.2.m1.3.5">σ</mi><mrow id="S5.T2.32.8.2.m1.3.6"><mo id="S5.T2.32.8.2.m1.3.6.1" stretchy="false">(</mo><mi id="S5.T2.32.8.2.m1.3.6.2">v</mi><mi id="S5.T2.32.8.2.m1.3.6.3">e</mi><mi id="S5.T2.32.8.2.m1.3.6.4">c</mi><mrow id="S5.T2.32.8.2.m1.3.6.5"><mo id="S5.T2.32.8.2.m1.3.6.5.1" stretchy="false">(</mo><mi id="S5.T2.32.8.2.m1.3.6.5.2">σ</mi><mrow id="S5.T2.32.8.2.m1.3.6.5.3"><mo id="S5.T2.32.8.2.m1.3.6.5.3.1" stretchy="false">(</mo><mrow id="S5.T2.32.8.2.m1.3.6.5.3.2"><mo id="S5.T2.32.8.2.m1.3.6.5.3.2.1" stretchy="false">[</mo><mi id="S5.T2.32.8.2.m1.1.1">h</mi><mo id="S5.T2.32.8.2.m1.3.6.5.3.2.2">;</mo><mi id="S5.T2.32.8.2.m1.2.2">r</mi><mo id="S5.T2.32.8.2.m1.3.6.5.3.2.3" rspace="0.055em" stretchy="false">]</mo></mrow><mo id="S5.T2.32.8.2.m1.3.6.5.3.3" rspace="0.222em">∗</mo><mi id="S5.T2.32.8.2.m1.3.6.5.3.4">ω</mi><mo id="S5.T2.32.8.2.m1.3.6.5.3.5" stretchy="false">)</mo></mrow><mo id="S5.T2.32.8.2.m1.3.6.5.4" stretchy="false">)</mo></mrow><mi id="S5.T2.32.8.2.m1.3.6.6">W</mi><mo id="S5.T2.32.8.2.m1.3.6.7" stretchy="false">)</mo></mrow><mo id="S5.T2.32.8.2.m1.3.7">,</mo><mi id="S5.T2.32.8.2.m1.3.3">t</mi><mo id="S5.T2.32.8.2.m1.3.8">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S5.T2.32.8.2.m1.3c">&lt;\sigma(vec(\sigma([h;r]\ast\omega))W),t&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T2.32.8.2.m1.3d">&lt; italic_σ ( italic_v italic_e italic_c ( italic_σ ( [ italic_h ; italic_r ] ∗ italic_ω ) ) italic_W ) , italic_t &gt;</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.33.9">
<td class="ltx_td ltx_align_left" id="S5.T2.33.9.2">RGAT</td>
<td class="ltx_td ltx_align_left" id="S5.T2.33.9.1"><math alttext="h_{i}^{l+1}=\sigma\left([||_{1}^{K}\sum\limits_{j\in\mathcal{N}_{i}}\alpha^{lk%
}_{ij}h_{j}^{l}W_{k}^{l};||_{1}^{M}\sum\limits_{j\in\mathcal{N}_{i}}g(r)^{lm}h%
_{j}^{l}W_{m}^{l}]W^{l+1}\right)" class="ltx_math_unparsed" display="inline" id="S5.T2.33.9.1.m1.1"><semantics id="S5.T2.33.9.1.m1.1a"><mrow id="S5.T2.33.9.1.m1.1b"><msubsup id="S5.T2.33.9.1.m1.1.1"><mi id="S5.T2.33.9.1.m1.1.1.2.2">h</mi><mi id="S5.T2.33.9.1.m1.1.1.2.3">i</mi><mrow id="S5.T2.33.9.1.m1.1.1.3"><mi id="S5.T2.33.9.1.m1.1.1.3.2">l</mi><mo id="S5.T2.33.9.1.m1.1.1.3.1">+</mo><mn id="S5.T2.33.9.1.m1.1.1.3.3">1</mn></mrow></msubsup><mo id="S5.T2.33.9.1.m1.1.2">=</mo><mi id="S5.T2.33.9.1.m1.1.3">σ</mi><mrow id="S5.T2.33.9.1.m1.1.4"><mo id="S5.T2.33.9.1.m1.1.4.1">(</mo><mrow id="S5.T2.33.9.1.m1.1.4.2"><mo id="S5.T2.33.9.1.m1.1.4.2.1" stretchy="false">[</mo><mo fence="false" id="S5.T2.33.9.1.m1.1.4.2.2" rspace="0.167em" stretchy="false">|</mo><msubsup id="S5.T2.33.9.1.m1.1.4.2.3"><mo fence="false" id="S5.T2.33.9.1.m1.1.4.2.3.2.2" stretchy="false">|</mo><mn id="S5.T2.33.9.1.m1.1.4.2.3.2.3">1</mn><mi id="S5.T2.33.9.1.m1.1.4.2.3.3">K</mi></msubsup><munder id="S5.T2.33.9.1.m1.1.4.2.4"><mo id="S5.T2.33.9.1.m1.1.4.2.4.2" movablelimits="false">∑</mo><mrow id="S5.T2.33.9.1.m1.1.4.2.4.3"><mi id="S5.T2.33.9.1.m1.1.4.2.4.3.2">j</mi><mo id="S5.T2.33.9.1.m1.1.4.2.4.3.1">∈</mo><msub id="S5.T2.33.9.1.m1.1.4.2.4.3.3"><mi class="ltx_font_mathcaligraphic" id="S5.T2.33.9.1.m1.1.4.2.4.3.3.2">𝒩</mi><mi id="S5.T2.33.9.1.m1.1.4.2.4.3.3.3">i</mi></msub></mrow></munder><msubsup id="S5.T2.33.9.1.m1.1.4.2.5"><mi id="S5.T2.33.9.1.m1.1.4.2.5.2.2">α</mi><mrow id="S5.T2.33.9.1.m1.1.4.2.5.3"><mi id="S5.T2.33.9.1.m1.1.4.2.5.3.2">i</mi><mo id="S5.T2.33.9.1.m1.1.4.2.5.3.1">⁢</mo><mi id="S5.T2.33.9.1.m1.1.4.2.5.3.3">j</mi></mrow><mrow id="S5.T2.33.9.1.m1.1.4.2.5.2.3"><mi id="S5.T2.33.9.1.m1.1.4.2.5.2.3.2">l</mi><mo id="S5.T2.33.9.1.m1.1.4.2.5.2.3.1">⁢</mo><mi id="S5.T2.33.9.1.m1.1.4.2.5.2.3.3">k</mi></mrow></msubsup><msubsup id="S5.T2.33.9.1.m1.1.4.2.6"><mi id="S5.T2.33.9.1.m1.1.4.2.6.2.2">h</mi><mi id="S5.T2.33.9.1.m1.1.4.2.6.2.3">j</mi><mi id="S5.T2.33.9.1.m1.1.4.2.6.3">l</mi></msubsup><msubsup id="S5.T2.33.9.1.m1.1.4.2.7"><mi id="S5.T2.33.9.1.m1.1.4.2.7.2.2">W</mi><mi id="S5.T2.33.9.1.m1.1.4.2.7.2.3">k</mi><mi id="S5.T2.33.9.1.m1.1.4.2.7.3">l</mi></msubsup><mo id="S5.T2.33.9.1.m1.1.4.2.8">;</mo><mo fence="false" id="S5.T2.33.9.1.m1.1.4.2.9" rspace="0.167em" stretchy="false">|</mo><msubsup id="S5.T2.33.9.1.m1.1.4.2.10"><mo fence="false" id="S5.T2.33.9.1.m1.1.4.2.10.2.2" stretchy="false">|</mo><mn id="S5.T2.33.9.1.m1.1.4.2.10.2.3">1</mn><mi id="S5.T2.33.9.1.m1.1.4.2.10.3">M</mi></msubsup><munder id="S5.T2.33.9.1.m1.1.4.2.11"><mo id="S5.T2.33.9.1.m1.1.4.2.11.2" movablelimits="false">∑</mo><mrow id="S5.T2.33.9.1.m1.1.4.2.11.3"><mi id="S5.T2.33.9.1.m1.1.4.2.11.3.2">j</mi><mo id="S5.T2.33.9.1.m1.1.4.2.11.3.1">∈</mo><msub id="S5.T2.33.9.1.m1.1.4.2.11.3.3"><mi class="ltx_font_mathcaligraphic" id="S5.T2.33.9.1.m1.1.4.2.11.3.3.2">𝒩</mi><mi id="S5.T2.33.9.1.m1.1.4.2.11.3.3.3">i</mi></msub></mrow></munder><mi id="S5.T2.33.9.1.m1.1.4.2.12">g</mi><msup id="S5.T2.33.9.1.m1.1.4.2.13"><mrow id="S5.T2.33.9.1.m1.1.4.2.13.2"><mo id="S5.T2.33.9.1.m1.1.4.2.13.2.1" stretchy="false">(</mo><mi id="S5.T2.33.9.1.m1.1.4.2.13.2.2">r</mi><mo id="S5.T2.33.9.1.m1.1.4.2.13.2.3" stretchy="false">)</mo></mrow><mrow id="S5.T2.33.9.1.m1.1.4.2.13.3"><mi id="S5.T2.33.9.1.m1.1.4.2.13.3.2">l</mi><mo id="S5.T2.33.9.1.m1.1.4.2.13.3.1">⁢</mo><mi id="S5.T2.33.9.1.m1.1.4.2.13.3.3">m</mi></mrow></msup><msubsup id="S5.T2.33.9.1.m1.1.4.2.14"><mi id="S5.T2.33.9.1.m1.1.4.2.14.2.2">h</mi><mi id="S5.T2.33.9.1.m1.1.4.2.14.2.3">j</mi><mi id="S5.T2.33.9.1.m1.1.4.2.14.3">l</mi></msubsup><msubsup id="S5.T2.33.9.1.m1.1.4.2.15"><mi id="S5.T2.33.9.1.m1.1.4.2.15.2.2">W</mi><mi id="S5.T2.33.9.1.m1.1.4.2.15.2.3">m</mi><mi id="S5.T2.33.9.1.m1.1.4.2.15.3">l</mi></msubsup><mo id="S5.T2.33.9.1.m1.1.4.2.16" stretchy="false">]</mo></mrow><msup id="S5.T2.33.9.1.m1.1.4.3"><mi id="S5.T2.33.9.1.m1.1.4.3.2">W</mi><mrow id="S5.T2.33.9.1.m1.1.4.3.3"><mi id="S5.T2.33.9.1.m1.1.4.3.3.2">l</mi><mo id="S5.T2.33.9.1.m1.1.4.3.3.1">+</mo><mn id="S5.T2.33.9.1.m1.1.4.3.3.3">1</mn></mrow></msup><mo id="S5.T2.33.9.1.m1.1.4.4">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S5.T2.33.9.1.m1.1c">h_{i}^{l+1}=\sigma\left([||_{1}^{K}\sum\limits_{j\in\mathcal{N}_{i}}\alpha^{lk%
}_{ij}h_{j}^{l}W_{k}^{l};||_{1}^{M}\sum\limits_{j\in\mathcal{N}_{i}}g(r)^{lm}h%
_{j}^{l}W_{m}^{l}]W^{l+1}\right)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.33.9.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT = italic_σ ( [ | | start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_α start_POSTSUPERSCRIPT italic_l italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ; | | start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_g ( italic_r ) start_POSTSUPERSCRIPT italic_l italic_m end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ] italic_W start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S5.T2.33.9.3">-</td>
</tr>
<tr class="ltx_tr" id="S5.T2.34.10">
<td class="ltx_td ltx_align_left" id="S5.T2.34.10.2">InteractE</td>
<td class="ltx_td ltx_align_left" id="S5.T2.34.10.3">-</td>
<td class="ltx_td ltx_align_left" id="S5.T2.34.10.1"><math alttext="&lt;\sigma(vec(\sigma(\phi_{chk}(P_{k})\bigstar\omega))W),t&gt;" class="ltx_math_unparsed" display="inline" id="S5.T2.34.10.1.m1.1"><semantics id="S5.T2.34.10.1.m1.1a"><mrow id="S5.T2.34.10.1.m1.1b"><mo id="S5.T2.34.10.1.m1.1.2">&lt;</mo><mi id="S5.T2.34.10.1.m1.1.3">σ</mi><mrow id="S5.T2.34.10.1.m1.1.4"><mo id="S5.T2.34.10.1.m1.1.4.1" stretchy="false">(</mo><mi id="S5.T2.34.10.1.m1.1.4.2">v</mi><mi id="S5.T2.34.10.1.m1.1.4.3">e</mi><mi id="S5.T2.34.10.1.m1.1.4.4">c</mi><mrow id="S5.T2.34.10.1.m1.1.4.5"><mo id="S5.T2.34.10.1.m1.1.4.5.1" stretchy="false">(</mo><mi id="S5.T2.34.10.1.m1.1.4.5.2">σ</mi><mrow id="S5.T2.34.10.1.m1.1.4.5.3"><mo id="S5.T2.34.10.1.m1.1.4.5.3.1" stretchy="false">(</mo><msub id="S5.T2.34.10.1.m1.1.4.5.3.2"><mi id="S5.T2.34.10.1.m1.1.4.5.3.2.2">ϕ</mi><mrow id="S5.T2.34.10.1.m1.1.4.5.3.2.3"><mi id="S5.T2.34.10.1.m1.1.4.5.3.2.3.2">c</mi><mo id="S5.T2.34.10.1.m1.1.4.5.3.2.3.1">⁢</mo><mi id="S5.T2.34.10.1.m1.1.4.5.3.2.3.3">h</mi><mo id="S5.T2.34.10.1.m1.1.4.5.3.2.3.1a">⁢</mo><mi id="S5.T2.34.10.1.m1.1.4.5.3.2.3.4">k</mi></mrow></msub><mrow id="S5.T2.34.10.1.m1.1.4.5.3.3"><mo id="S5.T2.34.10.1.m1.1.4.5.3.3.1" stretchy="false">(</mo><msub id="S5.T2.34.10.1.m1.1.4.5.3.3.2"><mi id="S5.T2.34.10.1.m1.1.4.5.3.3.2.2">P</mi><mi id="S5.T2.34.10.1.m1.1.4.5.3.3.2.3">k</mi></msub><mo id="S5.T2.34.10.1.m1.1.4.5.3.3.3" stretchy="false">)</mo></mrow><mi id="S5.T2.34.10.1.m1.1.4.5.3.4" mathvariant="normal">★</mi><mi id="S5.T2.34.10.1.m1.1.4.5.3.5">ω</mi><mo id="S5.T2.34.10.1.m1.1.4.5.3.6" stretchy="false">)</mo></mrow><mo id="S5.T2.34.10.1.m1.1.4.5.4" stretchy="false">)</mo></mrow><mi id="S5.T2.34.10.1.m1.1.4.6">W</mi><mo id="S5.T2.34.10.1.m1.1.4.7" stretchy="false">)</mo></mrow><mo id="S5.T2.34.10.1.m1.1.5">,</mo><mi id="S5.T2.34.10.1.m1.1.1">t</mi><mo id="S5.T2.34.10.1.m1.1.6">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S5.T2.34.10.1.m1.1c">&lt;\sigma(vec(\sigma(\phi_{chk}(P_{k})\bigstar\omega))W),t&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T2.34.10.1.m1.1d">&lt; italic_σ ( italic_v italic_e italic_c ( italic_σ ( italic_ϕ start_POSTSUBSCRIPT italic_c italic_h italic_k end_POSTSUBSCRIPT ( italic_P start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ★ italic_ω ) ) italic_W ) , italic_t &gt;</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.35.11">
<td class="ltx_td ltx_align_left" id="S5.T2.35.11.2">CTKGC</td>
<td class="ltx_td ltx_align_left" id="S5.T2.35.11.3">-</td>
<td class="ltx_td ltx_align_left" id="S5.T2.35.11.1"><math alttext="&lt;f(vec(\sigma([h^{T}\otimes r\ast\omega))W),t&gt;" class="ltx_math_unparsed" display="inline" id="S5.T2.35.11.1.m1.1"><semantics id="S5.T2.35.11.1.m1.1a"><mrow id="S5.T2.35.11.1.m1.1b"><mo id="S5.T2.35.11.1.m1.1.1">&lt;</mo><mi id="S5.T2.35.11.1.m1.1.2">f</mi><mrow id="S5.T2.35.11.1.m1.1.3"><mo id="S5.T2.35.11.1.m1.1.3.1" stretchy="false">(</mo><mi id="S5.T2.35.11.1.m1.1.3.2">v</mi><mi id="S5.T2.35.11.1.m1.1.3.3">e</mi><mi id="S5.T2.35.11.1.m1.1.3.4">c</mi><mrow id="S5.T2.35.11.1.m1.1.3.5"><mo id="S5.T2.35.11.1.m1.1.3.5.1" stretchy="false">(</mo><mi id="S5.T2.35.11.1.m1.1.3.5.2">σ</mi><mrow id="S5.T2.35.11.1.m1.1.3.5.3"><mo id="S5.T2.35.11.1.m1.1.3.5.3.1" stretchy="false">(</mo><mrow id="S5.T2.35.11.1.m1.1.3.5.3.2"><mo id="S5.T2.35.11.1.m1.1.3.5.3.2.1" stretchy="false">[</mo><msup id="S5.T2.35.11.1.m1.1.3.5.3.2.2"><mi id="S5.T2.35.11.1.m1.1.3.5.3.2.2.2">h</mi><mi id="S5.T2.35.11.1.m1.1.3.5.3.2.2.3">T</mi></msup><mo id="S5.T2.35.11.1.m1.1.3.5.3.2.3" lspace="0.222em" rspace="0.222em">⊗</mo><mi id="S5.T2.35.11.1.m1.1.3.5.3.2.4">r</mi><mo id="S5.T2.35.11.1.m1.1.3.5.3.2.5" lspace="0.222em" rspace="0.222em">∗</mo><mi id="S5.T2.35.11.1.m1.1.3.5.3.2.6">ω</mi><mo id="S5.T2.35.11.1.m1.1.3.5.3.2.7" stretchy="false">)</mo></mrow><mo id="S5.T2.35.11.1.m1.1.3.5.3.3" stretchy="false">)</mo></mrow><mi id="S5.T2.35.11.1.m1.1.3.5.4">W</mi><mo id="S5.T2.35.11.1.m1.1.3.5.5" stretchy="false">)</mo></mrow><mo id="S5.T2.35.11.1.m1.1.3.6">,</mo><mi id="S5.T2.35.11.1.m1.1.3.7">t</mi><mo id="S5.T2.35.11.1.m1.1.3.8">&gt;</mo></mrow></mrow><annotation encoding="application/x-tex" id="S5.T2.35.11.1.m1.1c">&lt;f(vec(\sigma([h^{T}\otimes r\ast\omega))W),t&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T2.35.11.1.m1.1d">&lt; italic_f ( italic_v italic_e italic_c ( italic_σ ( [ italic_h start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ⊗ italic_r ∗ italic_ω ) ) italic_W ) , italic_t &gt;</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.37.13">
<td class="ltx_td ltx_align_left" id="S5.T2.37.13.3">DisenKGAT</td>
<td class="ltx_td ltx_align_left" id="S5.T2.36.12.1"><math alttext="h_{i}^{l+1}=\sigma\left(\sum\limits_{(v_{j},r_{r})\in\mathcal{N}_{u}}\alpha^{k%
}_{(v_{i},v_{j},r_{r})}\phi(h_{v,k},r,\theta_{r})\right)" class="ltx_Math" display="inline" id="S5.T2.36.12.1.m1.9"><semantics id="S5.T2.36.12.1.m1.9a"><mrow id="S5.T2.36.12.1.m1.9.9" xref="S5.T2.36.12.1.m1.9.9.cmml"><msubsup id="S5.T2.36.12.1.m1.9.9.3" xref="S5.T2.36.12.1.m1.9.9.3.cmml"><mi id="S5.T2.36.12.1.m1.9.9.3.2.2" xref="S5.T2.36.12.1.m1.9.9.3.2.2.cmml">h</mi><mi id="S5.T2.36.12.1.m1.9.9.3.2.3" xref="S5.T2.36.12.1.m1.9.9.3.2.3.cmml">i</mi><mrow id="S5.T2.36.12.1.m1.9.9.3.3" xref="S5.T2.36.12.1.m1.9.9.3.3.cmml"><mi id="S5.T2.36.12.1.m1.9.9.3.3.2" xref="S5.T2.36.12.1.m1.9.9.3.3.2.cmml">l</mi><mo id="S5.T2.36.12.1.m1.9.9.3.3.1" xref="S5.T2.36.12.1.m1.9.9.3.3.1.cmml">+</mo><mn id="S5.T2.36.12.1.m1.9.9.3.3.3" xref="S5.T2.36.12.1.m1.9.9.3.3.3.cmml">1</mn></mrow></msubsup><mo id="S5.T2.36.12.1.m1.9.9.2" xref="S5.T2.36.12.1.m1.9.9.2.cmml">=</mo><mrow id="S5.T2.36.12.1.m1.9.9.1" xref="S5.T2.36.12.1.m1.9.9.1.cmml"><mi id="S5.T2.36.12.1.m1.9.9.1.3" xref="S5.T2.36.12.1.m1.9.9.1.3.cmml">σ</mi><mo id="S5.T2.36.12.1.m1.9.9.1.2" xref="S5.T2.36.12.1.m1.9.9.1.2.cmml">⁢</mo><mrow id="S5.T2.36.12.1.m1.9.9.1.1.1" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.cmml"><mo id="S5.T2.36.12.1.m1.9.9.1.1.1.2" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.cmml">(</mo><mrow id="S5.T2.36.12.1.m1.9.9.1.1.1.1" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.cmml"><munder id="S5.T2.36.12.1.m1.9.9.1.1.1.1.3" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.3.cmml"><mo id="S5.T2.36.12.1.m1.9.9.1.1.1.1.3.2" lspace="0em" movablelimits="false" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.3.2.cmml">∑</mo><mrow id="S5.T2.36.12.1.m1.2.2.2" xref="S5.T2.36.12.1.m1.2.2.2.cmml"><mrow id="S5.T2.36.12.1.m1.2.2.2.2.2" xref="S5.T2.36.12.1.m1.2.2.2.2.3.cmml"><mo id="S5.T2.36.12.1.m1.2.2.2.2.2.3" stretchy="false" xref="S5.T2.36.12.1.m1.2.2.2.2.3.cmml">(</mo><msub id="S5.T2.36.12.1.m1.1.1.1.1.1.1" xref="S5.T2.36.12.1.m1.1.1.1.1.1.1.cmml"><mi id="S5.T2.36.12.1.m1.1.1.1.1.1.1.2" xref="S5.T2.36.12.1.m1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S5.T2.36.12.1.m1.1.1.1.1.1.1.3" xref="S5.T2.36.12.1.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S5.T2.36.12.1.m1.2.2.2.2.2.4" xref="S5.T2.36.12.1.m1.2.2.2.2.3.cmml">,</mo><msub id="S5.T2.36.12.1.m1.2.2.2.2.2.2" xref="S5.T2.36.12.1.m1.2.2.2.2.2.2.cmml"><mi id="S5.T2.36.12.1.m1.2.2.2.2.2.2.2" xref="S5.T2.36.12.1.m1.2.2.2.2.2.2.2.cmml">r</mi><mi id="S5.T2.36.12.1.m1.2.2.2.2.2.2.3" xref="S5.T2.36.12.1.m1.2.2.2.2.2.2.3.cmml">r</mi></msub><mo id="S5.T2.36.12.1.m1.2.2.2.2.2.5" stretchy="false" xref="S5.T2.36.12.1.m1.2.2.2.2.3.cmml">)</mo></mrow><mo id="S5.T2.36.12.1.m1.2.2.2.3" xref="S5.T2.36.12.1.m1.2.2.2.3.cmml">∈</mo><msub id="S5.T2.36.12.1.m1.2.2.2.4" xref="S5.T2.36.12.1.m1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T2.36.12.1.m1.2.2.2.4.2" xref="S5.T2.36.12.1.m1.2.2.2.4.2.cmml">𝒩</mi><mi id="S5.T2.36.12.1.m1.2.2.2.4.3" xref="S5.T2.36.12.1.m1.2.2.2.4.3.cmml">u</mi></msub></mrow></munder><mrow id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.cmml"><msubsup id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.cmml"><mi id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.2.2" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.2.2.cmml">α</mi><mrow id="S5.T2.36.12.1.m1.5.5.3.3" xref="S5.T2.36.12.1.m1.5.5.3.4.cmml"><mo id="S5.T2.36.12.1.m1.5.5.3.3.4" stretchy="false" xref="S5.T2.36.12.1.m1.5.5.3.4.cmml">(</mo><msub id="S5.T2.36.12.1.m1.3.3.1.1.1" xref="S5.T2.36.12.1.m1.3.3.1.1.1.cmml"><mi id="S5.T2.36.12.1.m1.3.3.1.1.1.2" xref="S5.T2.36.12.1.m1.3.3.1.1.1.2.cmml">v</mi><mi id="S5.T2.36.12.1.m1.3.3.1.1.1.3" xref="S5.T2.36.12.1.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S5.T2.36.12.1.m1.5.5.3.3.5" xref="S5.T2.36.12.1.m1.5.5.3.4.cmml">,</mo><msub id="S5.T2.36.12.1.m1.4.4.2.2.2" xref="S5.T2.36.12.1.m1.4.4.2.2.2.cmml"><mi id="S5.T2.36.12.1.m1.4.4.2.2.2.2" xref="S5.T2.36.12.1.m1.4.4.2.2.2.2.cmml">v</mi><mi id="S5.T2.36.12.1.m1.4.4.2.2.2.3" xref="S5.T2.36.12.1.m1.4.4.2.2.2.3.cmml">j</mi></msub><mo id="S5.T2.36.12.1.m1.5.5.3.3.6" xref="S5.T2.36.12.1.m1.5.5.3.4.cmml">,</mo><msub id="S5.T2.36.12.1.m1.5.5.3.3.3" xref="S5.T2.36.12.1.m1.5.5.3.3.3.cmml"><mi id="S5.T2.36.12.1.m1.5.5.3.3.3.2" xref="S5.T2.36.12.1.m1.5.5.3.3.3.2.cmml">r</mi><mi id="S5.T2.36.12.1.m1.5.5.3.3.3.3" xref="S5.T2.36.12.1.m1.5.5.3.3.3.3.cmml">r</mi></msub><mo id="S5.T2.36.12.1.m1.5.5.3.3.7" stretchy="false" xref="S5.T2.36.12.1.m1.5.5.3.4.cmml">)</mo></mrow><mi id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.2.3" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.2.3.cmml">k</mi></msubsup><mo id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.3" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.3.cmml">⁢</mo><mi id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.5" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.5.cmml">ϕ</mi><mo id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.3a" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.3.cmml"><mo id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.3" stretchy="false" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.3.cmml">(</mo><msub id="S5.T2.36.12.1.m1.9.9.1.1.1.1.1.1.1.1" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.1.1.1.1.cmml"><mi id="S5.T2.36.12.1.m1.9.9.1.1.1.1.1.1.1.1.2" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.1.1.1.1.2.cmml">h</mi><mrow id="S5.T2.36.12.1.m1.7.7.2.4" xref="S5.T2.36.12.1.m1.7.7.2.3.cmml"><mi id="S5.T2.36.12.1.m1.6.6.1.1" xref="S5.T2.36.12.1.m1.6.6.1.1.cmml">v</mi><mo id="S5.T2.36.12.1.m1.7.7.2.4.1" xref="S5.T2.36.12.1.m1.7.7.2.3.cmml">,</mo><mi id="S5.T2.36.12.1.m1.7.7.2.2" xref="S5.T2.36.12.1.m1.7.7.2.2.cmml">k</mi></mrow></msub><mo id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.4" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.3.cmml">,</mo><mi id="S5.T2.36.12.1.m1.8.8" xref="S5.T2.36.12.1.m1.8.8.cmml">r</mi><mo id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.5" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.3.cmml">,</mo><msub id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2.cmml"><mi id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2.2" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2.2.cmml">θ</mi><mi id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2.3" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2.3.cmml">r</mi></msub><mo id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.6" stretchy="false" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S5.T2.36.12.1.m1.9.9.1.1.1.3" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.36.12.1.m1.9b"><apply id="S5.T2.36.12.1.m1.9.9.cmml" xref="S5.T2.36.12.1.m1.9.9"><eq id="S5.T2.36.12.1.m1.9.9.2.cmml" xref="S5.T2.36.12.1.m1.9.9.2"></eq><apply id="S5.T2.36.12.1.m1.9.9.3.cmml" xref="S5.T2.36.12.1.m1.9.9.3"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.9.9.3.1.cmml" xref="S5.T2.36.12.1.m1.9.9.3">superscript</csymbol><apply id="S5.T2.36.12.1.m1.9.9.3.2.cmml" xref="S5.T2.36.12.1.m1.9.9.3"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.9.9.3.2.1.cmml" xref="S5.T2.36.12.1.m1.9.9.3">subscript</csymbol><ci id="S5.T2.36.12.1.m1.9.9.3.2.2.cmml" xref="S5.T2.36.12.1.m1.9.9.3.2.2">ℎ</ci><ci id="S5.T2.36.12.1.m1.9.9.3.2.3.cmml" xref="S5.T2.36.12.1.m1.9.9.3.2.3">𝑖</ci></apply><apply id="S5.T2.36.12.1.m1.9.9.3.3.cmml" xref="S5.T2.36.12.1.m1.9.9.3.3"><plus id="S5.T2.36.12.1.m1.9.9.3.3.1.cmml" xref="S5.T2.36.12.1.m1.9.9.3.3.1"></plus><ci id="S5.T2.36.12.1.m1.9.9.3.3.2.cmml" xref="S5.T2.36.12.1.m1.9.9.3.3.2">𝑙</ci><cn id="S5.T2.36.12.1.m1.9.9.3.3.3.cmml" type="integer" xref="S5.T2.36.12.1.m1.9.9.3.3.3">1</cn></apply></apply><apply id="S5.T2.36.12.1.m1.9.9.1.cmml" xref="S5.T2.36.12.1.m1.9.9.1"><times id="S5.T2.36.12.1.m1.9.9.1.2.cmml" xref="S5.T2.36.12.1.m1.9.9.1.2"></times><ci id="S5.T2.36.12.1.m1.9.9.1.3.cmml" xref="S5.T2.36.12.1.m1.9.9.1.3">𝜎</ci><apply id="S5.T2.36.12.1.m1.9.9.1.1.1.1.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1"><apply id="S5.T2.36.12.1.m1.9.9.1.1.1.1.3.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.9.9.1.1.1.1.3.1.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.3">subscript</csymbol><sum id="S5.T2.36.12.1.m1.9.9.1.1.1.1.3.2.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.3.2"></sum><apply id="S5.T2.36.12.1.m1.2.2.2.cmml" xref="S5.T2.36.12.1.m1.2.2.2"><in id="S5.T2.36.12.1.m1.2.2.2.3.cmml" xref="S5.T2.36.12.1.m1.2.2.2.3"></in><interval closure="open" id="S5.T2.36.12.1.m1.2.2.2.2.3.cmml" xref="S5.T2.36.12.1.m1.2.2.2.2.2"><apply id="S5.T2.36.12.1.m1.1.1.1.1.1.1.cmml" xref="S5.T2.36.12.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.1.1.1.1.1.1.1.cmml" xref="S5.T2.36.12.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.T2.36.12.1.m1.1.1.1.1.1.1.2.cmml" xref="S5.T2.36.12.1.m1.1.1.1.1.1.1.2">𝑣</ci><ci id="S5.T2.36.12.1.m1.1.1.1.1.1.1.3.cmml" xref="S5.T2.36.12.1.m1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S5.T2.36.12.1.m1.2.2.2.2.2.2.cmml" xref="S5.T2.36.12.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.2.2.2.2.2.2.1.cmml" xref="S5.T2.36.12.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S5.T2.36.12.1.m1.2.2.2.2.2.2.2.cmml" xref="S5.T2.36.12.1.m1.2.2.2.2.2.2.2">𝑟</ci><ci id="S5.T2.36.12.1.m1.2.2.2.2.2.2.3.cmml" xref="S5.T2.36.12.1.m1.2.2.2.2.2.2.3">𝑟</ci></apply></interval><apply id="S5.T2.36.12.1.m1.2.2.2.4.cmml" xref="S5.T2.36.12.1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.2.2.2.4.1.cmml" xref="S5.T2.36.12.1.m1.2.2.2.4">subscript</csymbol><ci id="S5.T2.36.12.1.m1.2.2.2.4.2.cmml" xref="S5.T2.36.12.1.m1.2.2.2.4.2">𝒩</ci><ci id="S5.T2.36.12.1.m1.2.2.2.4.3.cmml" xref="S5.T2.36.12.1.m1.2.2.2.4.3">𝑢</ci></apply></apply></apply><apply id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2"><times id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.3.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.3"></times><apply id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.1.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4">subscript</csymbol><apply id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.2.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.2.1.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4">superscript</csymbol><ci id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.2.2.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.2.2">𝛼</ci><ci id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.2.3.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.4.2.3">𝑘</ci></apply><vector id="S5.T2.36.12.1.m1.5.5.3.4.cmml" xref="S5.T2.36.12.1.m1.5.5.3.3"><apply id="S5.T2.36.12.1.m1.3.3.1.1.1.cmml" xref="S5.T2.36.12.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.3.3.1.1.1.1.cmml" xref="S5.T2.36.12.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S5.T2.36.12.1.m1.3.3.1.1.1.2.cmml" xref="S5.T2.36.12.1.m1.3.3.1.1.1.2">𝑣</ci><ci id="S5.T2.36.12.1.m1.3.3.1.1.1.3.cmml" xref="S5.T2.36.12.1.m1.3.3.1.1.1.3">𝑖</ci></apply><apply id="S5.T2.36.12.1.m1.4.4.2.2.2.cmml" xref="S5.T2.36.12.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.4.4.2.2.2.1.cmml" xref="S5.T2.36.12.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S5.T2.36.12.1.m1.4.4.2.2.2.2.cmml" xref="S5.T2.36.12.1.m1.4.4.2.2.2.2">𝑣</ci><ci id="S5.T2.36.12.1.m1.4.4.2.2.2.3.cmml" xref="S5.T2.36.12.1.m1.4.4.2.2.2.3">𝑗</ci></apply><apply id="S5.T2.36.12.1.m1.5.5.3.3.3.cmml" xref="S5.T2.36.12.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.5.5.3.3.3.1.cmml" xref="S5.T2.36.12.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S5.T2.36.12.1.m1.5.5.3.3.3.2.cmml" xref="S5.T2.36.12.1.m1.5.5.3.3.3.2">𝑟</ci><ci id="S5.T2.36.12.1.m1.5.5.3.3.3.3.cmml" xref="S5.T2.36.12.1.m1.5.5.3.3.3.3">𝑟</ci></apply></vector></apply><ci id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.5.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.5">italic-ϕ</ci><vector id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.3.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2"><apply id="S5.T2.36.12.1.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.9.9.1.1.1.1.1.1.1.1.1.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.T2.36.12.1.m1.9.9.1.1.1.1.1.1.1.1.2.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.1.1.1.1.2">ℎ</ci><list id="S5.T2.36.12.1.m1.7.7.2.3.cmml" xref="S5.T2.36.12.1.m1.7.7.2.4"><ci id="S5.T2.36.12.1.m1.6.6.1.1.cmml" xref="S5.T2.36.12.1.m1.6.6.1.1">𝑣</ci><ci id="S5.T2.36.12.1.m1.7.7.2.2.cmml" xref="S5.T2.36.12.1.m1.7.7.2.2">𝑘</ci></list></apply><ci id="S5.T2.36.12.1.m1.8.8.cmml" xref="S5.T2.36.12.1.m1.8.8">𝑟</ci><apply id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2.1.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2.2.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2.2">𝜃</ci><ci id="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2.3.cmml" xref="S5.T2.36.12.1.m1.9.9.1.1.1.1.2.2.2.2.3">𝑟</ci></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.36.12.1.m1.9c">h_{i}^{l+1}=\sigma\left(\sum\limits_{(v_{j},r_{r})\in\mathcal{N}_{u}}\alpha^{k%
}_{(v_{i},v_{j},r_{r})}\phi(h_{v,k},r,\theta_{r})\right)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.36.12.1.m1.9d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT = italic_σ ( ∑ start_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) ∈ caligraphic_N start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_α start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT italic_ϕ ( italic_h start_POSTSUBSCRIPT italic_v , italic_k end_POSTSUBSCRIPT , italic_r , italic_θ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S5.T2.37.13.2"><math alttext="\sum\limits_{k}\beta^{k}&lt;\sigma(vec(\sigma([\overline{h_{k}};\overline{r}]\ast%
\omega))W),t_{k}&gt;" class="ltx_math_unparsed" display="inline" id="S5.T2.37.13.2.m1.2"><semantics id="S5.T2.37.13.2.m1.2a"><mrow id="S5.T2.37.13.2.m1.2b"><munder id="S5.T2.37.13.2.m1.2.3"><mo id="S5.T2.37.13.2.m1.2.3.2" movablelimits="false">∑</mo><mi id="S5.T2.37.13.2.m1.2.3.3">k</mi></munder><msup id="S5.T2.37.13.2.m1.2.4"><mi id="S5.T2.37.13.2.m1.2.4.2">β</mi><mi id="S5.T2.37.13.2.m1.2.4.3">k</mi></msup><mo id="S5.T2.37.13.2.m1.2.5">&lt;</mo><mi id="S5.T2.37.13.2.m1.2.6">σ</mi><mrow id="S5.T2.37.13.2.m1.2.7"><mo id="S5.T2.37.13.2.m1.2.7.1" stretchy="false">(</mo><mi id="S5.T2.37.13.2.m1.2.7.2">v</mi><mi id="S5.T2.37.13.2.m1.2.7.3">e</mi><mi id="S5.T2.37.13.2.m1.2.7.4">c</mi><mrow id="S5.T2.37.13.2.m1.2.7.5"><mo id="S5.T2.37.13.2.m1.2.7.5.1" stretchy="false">(</mo><mi id="S5.T2.37.13.2.m1.2.7.5.2">σ</mi><mrow id="S5.T2.37.13.2.m1.2.7.5.3"><mo id="S5.T2.37.13.2.m1.2.7.5.3.1" stretchy="false">(</mo><mrow id="S5.T2.37.13.2.m1.2.7.5.3.2"><mo id="S5.T2.37.13.2.m1.2.7.5.3.2.1" stretchy="false">[</mo><mover accent="true" id="S5.T2.37.13.2.m1.1.1"><msub id="S5.T2.37.13.2.m1.1.1.2"><mi id="S5.T2.37.13.2.m1.1.1.2.2">h</mi><mi id="S5.T2.37.13.2.m1.1.1.2.3">k</mi></msub><mo id="S5.T2.37.13.2.m1.1.1.1">¯</mo></mover><mo id="S5.T2.37.13.2.m1.2.7.5.3.2.2">;</mo><mover accent="true" id="S5.T2.37.13.2.m1.2.2"><mi id="S5.T2.37.13.2.m1.2.2.2">r</mi><mo id="S5.T2.37.13.2.m1.2.2.1">¯</mo></mover><mo id="S5.T2.37.13.2.m1.2.7.5.3.2.3" rspace="0.055em" stretchy="false">]</mo></mrow><mo id="S5.T2.37.13.2.m1.2.7.5.3.3" rspace="0.222em">∗</mo><mi id="S5.T2.37.13.2.m1.2.7.5.3.4">ω</mi><mo id="S5.T2.37.13.2.m1.2.7.5.3.5" stretchy="false">)</mo></mrow><mo id="S5.T2.37.13.2.m1.2.7.5.4" stretchy="false">)</mo></mrow><mi id="S5.T2.37.13.2.m1.2.7.6">W</mi><mo id="S5.T2.37.13.2.m1.2.7.7" stretchy="false">)</mo></mrow><mo id="S5.T2.37.13.2.m1.2.8">,</mo><msub id="S5.T2.37.13.2.m1.2.9"><mi id="S5.T2.37.13.2.m1.2.9.2">t</mi><mi id="S5.T2.37.13.2.m1.2.9.3">k</mi></msub><mo id="S5.T2.37.13.2.m1.2.10">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S5.T2.37.13.2.m1.2c">\sum\limits_{k}\beta^{k}&lt;\sigma(vec(\sigma([\overline{h_{k}};\overline{r}]\ast%
\omega))W),t_{k}&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T2.37.13.2.m1.2d">∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_β start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT &lt; italic_σ ( italic_v italic_e italic_c ( italic_σ ( [ over¯ start_ARG italic_h start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG ; over¯ start_ARG italic_r end_ARG ] ∗ italic_ω ) ) italic_W ) , italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT &gt;</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.39.15">
<td class="ltx_td ltx_align_left" id="S5.T2.39.15.3">NoGE</td>
<td class="ltx_td ltx_align_left" id="S5.T2.38.14.1"><math alttext="h_{i,k}^{l+1}=\sigma\left(\sum\limits_{j\in\mathcal{N}_{i}}a_{i,j}W^{k}\otimes%
_{d}h_{j}^{k}\right)" class="ltx_Math" display="inline" id="S5.T2.38.14.1.m1.5"><semantics id="S5.T2.38.14.1.m1.5a"><mrow id="S5.T2.38.14.1.m1.5.5" xref="S5.T2.38.14.1.m1.5.5.cmml"><msubsup id="S5.T2.38.14.1.m1.5.5.3" xref="S5.T2.38.14.1.m1.5.5.3.cmml"><mi id="S5.T2.38.14.1.m1.5.5.3.2.2" xref="S5.T2.38.14.1.m1.5.5.3.2.2.cmml">h</mi><mrow id="S5.T2.38.14.1.m1.2.2.2.4" xref="S5.T2.38.14.1.m1.2.2.2.3.cmml"><mi id="S5.T2.38.14.1.m1.1.1.1.1" xref="S5.T2.38.14.1.m1.1.1.1.1.cmml">i</mi><mo id="S5.T2.38.14.1.m1.2.2.2.4.1" xref="S5.T2.38.14.1.m1.2.2.2.3.cmml">,</mo><mi id="S5.T2.38.14.1.m1.2.2.2.2" xref="S5.T2.38.14.1.m1.2.2.2.2.cmml">k</mi></mrow><mrow id="S5.T2.38.14.1.m1.5.5.3.3" xref="S5.T2.38.14.1.m1.5.5.3.3.cmml"><mi id="S5.T2.38.14.1.m1.5.5.3.3.2" xref="S5.T2.38.14.1.m1.5.5.3.3.2.cmml">l</mi><mo id="S5.T2.38.14.1.m1.5.5.3.3.1" xref="S5.T2.38.14.1.m1.5.5.3.3.1.cmml">+</mo><mn id="S5.T2.38.14.1.m1.5.5.3.3.3" xref="S5.T2.38.14.1.m1.5.5.3.3.3.cmml">1</mn></mrow></msubsup><mo id="S5.T2.38.14.1.m1.5.5.2" xref="S5.T2.38.14.1.m1.5.5.2.cmml">=</mo><mrow id="S5.T2.38.14.1.m1.5.5.1" xref="S5.T2.38.14.1.m1.5.5.1.cmml"><mi id="S5.T2.38.14.1.m1.5.5.1.3" xref="S5.T2.38.14.1.m1.5.5.1.3.cmml">σ</mi><mo id="S5.T2.38.14.1.m1.5.5.1.2" xref="S5.T2.38.14.1.m1.5.5.1.2.cmml">⁢</mo><mrow id="S5.T2.38.14.1.m1.5.5.1.1.1" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.cmml"><mo id="S5.T2.38.14.1.m1.5.5.1.1.1.2" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S5.T2.38.14.1.m1.5.5.1.1.1.1" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.cmml"><munder id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.cmml"><mo id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.2" lspace="0em" movablelimits="false" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.2.cmml">∑</mo><mrow id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.2" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.2.cmml">j</mi><mo id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.1" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.1.cmml">∈</mo><msub id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3.2" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3.2.cmml">𝒩</mi><mi id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3.3" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.cmml"><mrow id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.cmml"><msub id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.2" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.2.cmml"><mi id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.2.2" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.2.2.cmml">a</mi><mrow id="S5.T2.38.14.1.m1.4.4.2.4" xref="S5.T2.38.14.1.m1.4.4.2.3.cmml"><mi id="S5.T2.38.14.1.m1.3.3.1.1" xref="S5.T2.38.14.1.m1.3.3.1.1.cmml">i</mi><mo id="S5.T2.38.14.1.m1.4.4.2.4.1" xref="S5.T2.38.14.1.m1.4.4.2.3.cmml">,</mo><mi id="S5.T2.38.14.1.m1.4.4.2.2" xref="S5.T2.38.14.1.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.1" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.1.cmml">⁢</mo><msup id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3.2" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3.2.cmml">W</mi><mi id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3.3" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3.3.cmml">k</mi></msup></mrow><msub id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1.cmml"><mo id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1.2" lspace="0.222em" rspace="0.222em" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1.2.cmml">⊗</mo><mi id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1.3" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1.3.cmml">d</mi></msub><msubsup id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.cmml"><mi id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.2.2" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.2.2.cmml">h</mi><mi id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.2.3" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.2.3.cmml">j</mi><mi id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.3" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.3.cmml">k</mi></msubsup></mrow></mrow><mo id="S5.T2.38.14.1.m1.5.5.1.1.1.3" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.38.14.1.m1.5b"><apply id="S5.T2.38.14.1.m1.5.5.cmml" xref="S5.T2.38.14.1.m1.5.5"><eq id="S5.T2.38.14.1.m1.5.5.2.cmml" xref="S5.T2.38.14.1.m1.5.5.2"></eq><apply id="S5.T2.38.14.1.m1.5.5.3.cmml" xref="S5.T2.38.14.1.m1.5.5.3"><csymbol cd="ambiguous" id="S5.T2.38.14.1.m1.5.5.3.1.cmml" xref="S5.T2.38.14.1.m1.5.5.3">superscript</csymbol><apply id="S5.T2.38.14.1.m1.5.5.3.2.cmml" xref="S5.T2.38.14.1.m1.5.5.3"><csymbol cd="ambiguous" id="S5.T2.38.14.1.m1.5.5.3.2.1.cmml" xref="S5.T2.38.14.1.m1.5.5.3">subscript</csymbol><ci id="S5.T2.38.14.1.m1.5.5.3.2.2.cmml" xref="S5.T2.38.14.1.m1.5.5.3.2.2">ℎ</ci><list id="S5.T2.38.14.1.m1.2.2.2.3.cmml" xref="S5.T2.38.14.1.m1.2.2.2.4"><ci id="S5.T2.38.14.1.m1.1.1.1.1.cmml" xref="S5.T2.38.14.1.m1.1.1.1.1">𝑖</ci><ci id="S5.T2.38.14.1.m1.2.2.2.2.cmml" xref="S5.T2.38.14.1.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S5.T2.38.14.1.m1.5.5.3.3.cmml" xref="S5.T2.38.14.1.m1.5.5.3.3"><plus id="S5.T2.38.14.1.m1.5.5.3.3.1.cmml" xref="S5.T2.38.14.1.m1.5.5.3.3.1"></plus><ci id="S5.T2.38.14.1.m1.5.5.3.3.2.cmml" xref="S5.T2.38.14.1.m1.5.5.3.3.2">𝑙</ci><cn id="S5.T2.38.14.1.m1.5.5.3.3.3.cmml" type="integer" xref="S5.T2.38.14.1.m1.5.5.3.3.3">1</cn></apply></apply><apply id="S5.T2.38.14.1.m1.5.5.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1"><times id="S5.T2.38.14.1.m1.5.5.1.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.2"></times><ci id="S5.T2.38.14.1.m1.5.5.1.3.cmml" xref="S5.T2.38.14.1.m1.5.5.1.3">𝜎</ci><apply id="S5.T2.38.14.1.m1.5.5.1.1.1.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1"><apply id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1">subscript</csymbol><sum id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.2"></sum><apply id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3"><in id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.1"></in><ci id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.2">𝑗</ci><apply id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3">subscript</csymbol><ci id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3.2">𝒩</ci><ci id="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3.3.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2"><apply id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1">subscript</csymbol><csymbol cd="latexml" id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1.2">tensor-product</csymbol><ci id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1.3.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.1.3">𝑑</ci></apply><apply id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2"><times id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.1"></times><apply id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.2.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.2">subscript</csymbol><ci id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.2.2">𝑎</ci><list id="S5.T2.38.14.1.m1.4.4.2.3.cmml" xref="S5.T2.38.14.1.m1.4.4.2.4"><ci id="S5.T2.38.14.1.m1.3.3.1.1.cmml" xref="S5.T2.38.14.1.m1.3.3.1.1">𝑖</ci><ci id="S5.T2.38.14.1.m1.4.4.2.2.cmml" xref="S5.T2.38.14.1.m1.4.4.2.2">𝑗</ci></list></apply><apply id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3">superscript</csymbol><ci id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3.2">𝑊</ci><ci id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3.3.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.2.3.3">𝑘</ci></apply></apply><apply id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3">superscript</csymbol><apply id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.2.1.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3">subscript</csymbol><ci id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.2.2.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.2.2">ℎ</ci><ci id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.2.3.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.2.3">𝑗</ci></apply><ci id="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.3.cmml" xref="S5.T2.38.14.1.m1.5.5.1.1.1.1.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.38.14.1.m1.5c">h_{i,k}^{l+1}=\sigma\left(\sum\limits_{j\in\mathcal{N}_{i}}a_{i,j}W^{k}\otimes%
_{d}h_{j}^{k}\right)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.38.14.1.m1.5d">italic_h start_POSTSUBSCRIPT italic_i , italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT = italic_σ ( ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ⊗ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S5.T2.39.15.2"><math alttext="&lt;h,r,t&gt;" class="ltx_math_unparsed" display="inline" id="S5.T2.39.15.2.m1.3"><semantics id="S5.T2.39.15.2.m1.3a"><mrow id="S5.T2.39.15.2.m1.3b"><mo id="S5.T2.39.15.2.m1.3.4">&lt;</mo><mi id="S5.T2.39.15.2.m1.1.1">h</mi><mo id="S5.T2.39.15.2.m1.3.5">,</mo><mi id="S5.T2.39.15.2.m1.2.2">r</mi><mo id="S5.T2.39.15.2.m1.3.6">,</mo><mi id="S5.T2.39.15.2.m1.3.3">t</mi><mo id="S5.T2.39.15.2.m1.3.7">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S5.T2.39.15.2.m1.3c">&lt;h,r,t&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T2.39.15.2.m1.3d">&lt; italic_h , italic_r , italic_t &gt;</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.41.17">
<td class="ltx_td ltx_align_left" id="S5.T2.41.17.3">MRGAT</td>
<td class="ltx_td ltx_align_left" id="S5.T2.40.16.1"><math alttext="h_{i}^{l+1}=\sigma\left(h_{i}^{l}W^{l}+||_{1}^{K}\sum\limits_{j\in\mathcal{N}_%
{i}}a_{ij}^{l.k}h_{j}^{l}W_{v}^{l,k}\right)" class="ltx_math_unparsed" display="inline" id="S5.T2.40.16.1.m1.4"><semantics id="S5.T2.40.16.1.m1.4a"><mrow id="S5.T2.40.16.1.m1.4b"><msubsup id="S5.T2.40.16.1.m1.4.5"><mi id="S5.T2.40.16.1.m1.4.5.2.2">h</mi><mi id="S5.T2.40.16.1.m1.4.5.2.3">i</mi><mrow id="S5.T2.40.16.1.m1.4.5.3"><mi id="S5.T2.40.16.1.m1.4.5.3.2">l</mi><mo id="S5.T2.40.16.1.m1.4.5.3.1">+</mo><mn id="S5.T2.40.16.1.m1.4.5.3.3">1</mn></mrow></msubsup><mo id="S5.T2.40.16.1.m1.4.6">=</mo><mi id="S5.T2.40.16.1.m1.4.7">σ</mi><mrow id="S5.T2.40.16.1.m1.4.8"><mo id="S5.T2.40.16.1.m1.4.8.1">(</mo><msubsup id="S5.T2.40.16.1.m1.4.8.2"><mi id="S5.T2.40.16.1.m1.4.8.2.2.2">h</mi><mi id="S5.T2.40.16.1.m1.4.8.2.2.3">i</mi><mi id="S5.T2.40.16.1.m1.4.8.2.3">l</mi></msubsup><msup id="S5.T2.40.16.1.m1.4.8.3"><mi id="S5.T2.40.16.1.m1.4.8.3.2">W</mi><mi id="S5.T2.40.16.1.m1.4.8.3.3">l</mi></msup><mo id="S5.T2.40.16.1.m1.4.8.4" rspace="0em">+</mo><mo fence="false" id="S5.T2.40.16.1.m1.4.8.5" rspace="0.167em" stretchy="false">|</mo><msubsup id="S5.T2.40.16.1.m1.4.8.6"><mo fence="false" id="S5.T2.40.16.1.m1.4.8.6.2.2" stretchy="false">|</mo><mn id="S5.T2.40.16.1.m1.4.8.6.2.3">1</mn><mi id="S5.T2.40.16.1.m1.4.8.6.3">K</mi></msubsup><munder id="S5.T2.40.16.1.m1.4.8.7"><mo id="S5.T2.40.16.1.m1.4.8.7.2" movablelimits="false">∑</mo><mrow id="S5.T2.40.16.1.m1.4.8.7.3"><mi id="S5.T2.40.16.1.m1.4.8.7.3.2">j</mi><mo id="S5.T2.40.16.1.m1.4.8.7.3.1">∈</mo><msub id="S5.T2.40.16.1.m1.4.8.7.3.3"><mi class="ltx_font_mathcaligraphic" id="S5.T2.40.16.1.m1.4.8.7.3.3.2">𝒩</mi><mi id="S5.T2.40.16.1.m1.4.8.7.3.3.3">i</mi></msub></mrow></munder><msubsup id="S5.T2.40.16.1.m1.4.8.8"><mi id="S5.T2.40.16.1.m1.4.8.8.2.2">a</mi><mrow id="S5.T2.40.16.1.m1.4.8.8.2.3"><mi id="S5.T2.40.16.1.m1.4.8.8.2.3.2">i</mi><mo id="S5.T2.40.16.1.m1.4.8.8.2.3.1">⁢</mo><mi id="S5.T2.40.16.1.m1.4.8.8.2.3.3">j</mi></mrow><mrow id="S5.T2.40.16.1.m1.2.2.2.4"><mi id="S5.T2.40.16.1.m1.1.1.1.1">l</mi><mo id="S5.T2.40.16.1.m1.2.2.2.4.1" lspace="0em" rspace="0.167em">.</mo><mi id="S5.T2.40.16.1.m1.2.2.2.2">k</mi></mrow></msubsup><msubsup id="S5.T2.40.16.1.m1.4.8.9"><mi id="S5.T2.40.16.1.m1.4.8.9.2.2">h</mi><mi id="S5.T2.40.16.1.m1.4.8.9.2.3">j</mi><mi id="S5.T2.40.16.1.m1.4.8.9.3">l</mi></msubsup><msubsup id="S5.T2.40.16.1.m1.4.8.10"><mi id="S5.T2.40.16.1.m1.4.8.10.2.2">W</mi><mi id="S5.T2.40.16.1.m1.4.8.10.2.3">v</mi><mrow id="S5.T2.40.16.1.m1.4.4.2.4"><mi id="S5.T2.40.16.1.m1.3.3.1.1">l</mi><mo id="S5.T2.40.16.1.m1.4.4.2.4.1">,</mo><mi id="S5.T2.40.16.1.m1.4.4.2.2">k</mi></mrow></msubsup><mo id="S5.T2.40.16.1.m1.4.8.11">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S5.T2.40.16.1.m1.4c">h_{i}^{l+1}=\sigma\left(h_{i}^{l}W^{l}+||_{1}^{K}\sum\limits_{j\in\mathcal{N}_%
{i}}a_{ij}^{l.k}h_{j}^{l}W_{v}^{l,k}\right)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.40.16.1.m1.4d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT = italic_σ ( italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT + | | start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l . italic_k end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l , italic_k end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left" id="S5.T2.41.17.2"><math alttext="&lt;\sigma(vec(\sigma([h;r]\ast\omega))W),t&gt;" class="ltx_math_unparsed" display="inline" id="S5.T2.41.17.2.m1.3"><semantics id="S5.T2.41.17.2.m1.3a"><mrow id="S5.T2.41.17.2.m1.3b"><mo id="S5.T2.41.17.2.m1.3.4">&lt;</mo><mi id="S5.T2.41.17.2.m1.3.5">σ</mi><mrow id="S5.T2.41.17.2.m1.3.6"><mo id="S5.T2.41.17.2.m1.3.6.1" stretchy="false">(</mo><mi id="S5.T2.41.17.2.m1.3.6.2">v</mi><mi id="S5.T2.41.17.2.m1.3.6.3">e</mi><mi id="S5.T2.41.17.2.m1.3.6.4">c</mi><mrow id="S5.T2.41.17.2.m1.3.6.5"><mo id="S5.T2.41.17.2.m1.3.6.5.1" stretchy="false">(</mo><mi id="S5.T2.41.17.2.m1.3.6.5.2">σ</mi><mrow id="S5.T2.41.17.2.m1.3.6.5.3"><mo id="S5.T2.41.17.2.m1.3.6.5.3.1" stretchy="false">(</mo><mrow id="S5.T2.41.17.2.m1.3.6.5.3.2"><mo id="S5.T2.41.17.2.m1.3.6.5.3.2.1" stretchy="false">[</mo><mi id="S5.T2.41.17.2.m1.1.1">h</mi><mo id="S5.T2.41.17.2.m1.3.6.5.3.2.2">;</mo><mi id="S5.T2.41.17.2.m1.2.2">r</mi><mo id="S5.T2.41.17.2.m1.3.6.5.3.2.3" rspace="0.055em" stretchy="false">]</mo></mrow><mo id="S5.T2.41.17.2.m1.3.6.5.3.3" rspace="0.222em">∗</mo><mi id="S5.T2.41.17.2.m1.3.6.5.3.4">ω</mi><mo id="S5.T2.41.17.2.m1.3.6.5.3.5" stretchy="false">)</mo></mrow><mo id="S5.T2.41.17.2.m1.3.6.5.4" stretchy="false">)</mo></mrow><mi id="S5.T2.41.17.2.m1.3.6.6">W</mi><mo id="S5.T2.41.17.2.m1.3.6.7" stretchy="false">)</mo></mrow><mo id="S5.T2.41.17.2.m1.3.7">,</mo><mi id="S5.T2.41.17.2.m1.3.3">t</mi><mo id="S5.T2.41.17.2.m1.3.8">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S5.T2.41.17.2.m1.3c">&lt;\sigma(vec(\sigma([h;r]\ast\omega))W),t&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T2.41.17.2.m1.3d">&lt; italic_σ ( italic_v italic_e italic_c ( italic_σ ( [ italic_h ; italic_r ] ∗ italic_ω ) ) italic_W ) , italic_t &gt;</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S5.T2.43.19">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S5.T2.43.19.3">GATH</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S5.T2.42.18.1"><math alttext="h_{i}^{l+1}=\sigma\left(\beta h_{i}^{l}W_{h}^{l}+||_{1}^{K}\sum\limits_{j\in%
\mathcal{N}_{i}}[a_{(h)ij}^{lk}h_{j}W^{l};a_{(r)ij}^{lk}h_{j}W^{l}]\right)" class="ltx_math_unparsed" display="inline" id="S5.T2.42.18.1.m1.2"><semantics id="S5.T2.42.18.1.m1.2a"><mrow id="S5.T2.42.18.1.m1.2b"><msubsup id="S5.T2.42.18.1.m1.2.3"><mi id="S5.T2.42.18.1.m1.2.3.2.2">h</mi><mi id="S5.T2.42.18.1.m1.2.3.2.3">i</mi><mrow id="S5.T2.42.18.1.m1.2.3.3"><mi id="S5.T2.42.18.1.m1.2.3.3.2">l</mi><mo id="S5.T2.42.18.1.m1.2.3.3.1">+</mo><mn id="S5.T2.42.18.1.m1.2.3.3.3">1</mn></mrow></msubsup><mo id="S5.T2.42.18.1.m1.2.4">=</mo><mi id="S5.T2.42.18.1.m1.2.5">σ</mi><mrow id="S5.T2.42.18.1.m1.2.6"><mo id="S5.T2.42.18.1.m1.2.6.1">(</mo><mi id="S5.T2.42.18.1.m1.2.6.2">β</mi><msubsup id="S5.T2.42.18.1.m1.2.6.3"><mi id="S5.T2.42.18.1.m1.2.6.3.2.2">h</mi><mi id="S5.T2.42.18.1.m1.2.6.3.2.3">i</mi><mi id="S5.T2.42.18.1.m1.2.6.3.3">l</mi></msubsup><msubsup id="S5.T2.42.18.1.m1.2.6.4"><mi id="S5.T2.42.18.1.m1.2.6.4.2.2">W</mi><mi id="S5.T2.42.18.1.m1.2.6.4.2.3">h</mi><mi id="S5.T2.42.18.1.m1.2.6.4.3">l</mi></msubsup><mo id="S5.T2.42.18.1.m1.2.6.5" rspace="0em">+</mo><mo fence="false" id="S5.T2.42.18.1.m1.2.6.6" rspace="0.167em" stretchy="false">|</mo><msubsup id="S5.T2.42.18.1.m1.2.6.7"><mo fence="false" id="S5.T2.42.18.1.m1.2.6.7.2.2" stretchy="false">|</mo><mn id="S5.T2.42.18.1.m1.2.6.7.2.3">1</mn><mi id="S5.T2.42.18.1.m1.2.6.7.3">K</mi></msubsup><munder id="S5.T2.42.18.1.m1.2.6.8"><mo id="S5.T2.42.18.1.m1.2.6.8.2" movablelimits="false" rspace="0em">∑</mo><mrow id="S5.T2.42.18.1.m1.2.6.8.3"><mi id="S5.T2.42.18.1.m1.2.6.8.3.2">j</mi><mo id="S5.T2.42.18.1.m1.2.6.8.3.1">∈</mo><msub id="S5.T2.42.18.1.m1.2.6.8.3.3"><mi class="ltx_font_mathcaligraphic" id="S5.T2.42.18.1.m1.2.6.8.3.3.2">𝒩</mi><mi id="S5.T2.42.18.1.m1.2.6.8.3.3.3">i</mi></msub></mrow></munder><mrow id="S5.T2.42.18.1.m1.2.6.9"><mo id="S5.T2.42.18.1.m1.2.6.9.1" stretchy="false">[</mo><msubsup id="S5.T2.42.18.1.m1.2.6.9.2"><mi id="S5.T2.42.18.1.m1.2.6.9.2.2.2">a</mi><mrow id="S5.T2.42.18.1.m1.1.1.1"><mrow id="S5.T2.42.18.1.m1.1.1.1.3.2"><mo id="S5.T2.42.18.1.m1.1.1.1.3.2.1" stretchy="false">(</mo><mi id="S5.T2.42.18.1.m1.1.1.1.1">h</mi><mo id="S5.T2.42.18.1.m1.1.1.1.3.2.2" stretchy="false">)</mo></mrow><mo id="S5.T2.42.18.1.m1.1.1.1.2">⁢</mo><mi id="S5.T2.42.18.1.m1.1.1.1.4">i</mi><mo id="S5.T2.42.18.1.m1.1.1.1.2a">⁢</mo><mi id="S5.T2.42.18.1.m1.1.1.1.5">j</mi></mrow><mrow id="S5.T2.42.18.1.m1.2.6.9.2.3"><mi id="S5.T2.42.18.1.m1.2.6.9.2.3.2">l</mi><mo id="S5.T2.42.18.1.m1.2.6.9.2.3.1">⁢</mo><mi id="S5.T2.42.18.1.m1.2.6.9.2.3.3">k</mi></mrow></msubsup><msub id="S5.T2.42.18.1.m1.2.6.9.3"><mi id="S5.T2.42.18.1.m1.2.6.9.3.2">h</mi><mi id="S5.T2.42.18.1.m1.2.6.9.3.3">j</mi></msub><msup id="S5.T2.42.18.1.m1.2.6.9.4"><mi id="S5.T2.42.18.1.m1.2.6.9.4.2">W</mi><mi id="S5.T2.42.18.1.m1.2.6.9.4.3">l</mi></msup><mo id="S5.T2.42.18.1.m1.2.6.9.5">;</mo><msubsup id="S5.T2.42.18.1.m1.2.6.9.6"><mi id="S5.T2.42.18.1.m1.2.6.9.6.2.2">a</mi><mrow id="S5.T2.42.18.1.m1.2.2.1"><mrow id="S5.T2.42.18.1.m1.2.2.1.3.2"><mo id="S5.T2.42.18.1.m1.2.2.1.3.2.1" stretchy="false">(</mo><mi id="S5.T2.42.18.1.m1.2.2.1.1">r</mi><mo id="S5.T2.42.18.1.m1.2.2.1.3.2.2" stretchy="false">)</mo></mrow><mo id="S5.T2.42.18.1.m1.2.2.1.2">⁢</mo><mi id="S5.T2.42.18.1.m1.2.2.1.4">i</mi><mo id="S5.T2.42.18.1.m1.2.2.1.2a">⁢</mo><mi id="S5.T2.42.18.1.m1.2.2.1.5">j</mi></mrow><mrow id="S5.T2.42.18.1.m1.2.6.9.6.3"><mi id="S5.T2.42.18.1.m1.2.6.9.6.3.2">l</mi><mo id="S5.T2.42.18.1.m1.2.6.9.6.3.1">⁢</mo><mi id="S5.T2.42.18.1.m1.2.6.9.6.3.3">k</mi></mrow></msubsup><msub id="S5.T2.42.18.1.m1.2.6.9.7"><mi id="S5.T2.42.18.1.m1.2.6.9.7.2">h</mi><mi id="S5.T2.42.18.1.m1.2.6.9.7.3">j</mi></msub><msup id="S5.T2.42.18.1.m1.2.6.9.8"><mi id="S5.T2.42.18.1.m1.2.6.9.8.2">W</mi><mi id="S5.T2.42.18.1.m1.2.6.9.8.3">l</mi></msup><mo id="S5.T2.42.18.1.m1.2.6.9.9" stretchy="false">]</mo></mrow><mo id="S5.T2.42.18.1.m1.2.6.10">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S5.T2.42.18.1.m1.2c">h_{i}^{l+1}=\sigma\left(\beta h_{i}^{l}W_{h}^{l}+||_{1}^{K}\sum\limits_{j\in%
\mathcal{N}_{i}}[a_{(h)ij}^{lk}h_{j}W^{l};a_{(r)ij}^{lk}h_{j}W^{l}]\right)</annotation><annotation encoding="application/x-llamapun" id="S5.T2.42.18.1.m1.2d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT = italic_σ ( italic_β italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT + | | start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_N start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_a start_POSTSUBSCRIPT ( italic_h ) italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l italic_k end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ; italic_a start_POSTSUBSCRIPT ( italic_r ) italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l italic_k end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_W start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S5.T2.43.19.2"><math alttext="&lt;\sigma(vec(\sigma([\overline{h};\overline{r};\overline{h_{trans}}]\ast\omega)%
)W),t&gt;" class="ltx_math_unparsed" display="inline" id="S5.T2.43.19.2.m1.4"><semantics id="S5.T2.43.19.2.m1.4a"><mrow id="S5.T2.43.19.2.m1.4b"><mo id="S5.T2.43.19.2.m1.4.5">&lt;</mo><mi id="S5.T2.43.19.2.m1.4.6">σ</mi><mrow id="S5.T2.43.19.2.m1.4.7"><mo id="S5.T2.43.19.2.m1.4.7.1" stretchy="false">(</mo><mi id="S5.T2.43.19.2.m1.4.7.2">v</mi><mi id="S5.T2.43.19.2.m1.4.7.3">e</mi><mi id="S5.T2.43.19.2.m1.4.7.4">c</mi><mrow id="S5.T2.43.19.2.m1.4.7.5"><mo id="S5.T2.43.19.2.m1.4.7.5.1" stretchy="false">(</mo><mi id="S5.T2.43.19.2.m1.4.7.5.2">σ</mi><mrow id="S5.T2.43.19.2.m1.4.7.5.3"><mo id="S5.T2.43.19.2.m1.4.7.5.3.1" stretchy="false">(</mo><mrow id="S5.T2.43.19.2.m1.4.7.5.3.2"><mo id="S5.T2.43.19.2.m1.4.7.5.3.2.1" stretchy="false">[</mo><mover accent="true" id="S5.T2.43.19.2.m1.1.1"><mi id="S5.T2.43.19.2.m1.1.1.2">h</mi><mo id="S5.T2.43.19.2.m1.1.1.1">¯</mo></mover><mo id="S5.T2.43.19.2.m1.4.7.5.3.2.2">;</mo><mover accent="true" id="S5.T2.43.19.2.m1.2.2"><mi id="S5.T2.43.19.2.m1.2.2.2">r</mi><mo id="S5.T2.43.19.2.m1.2.2.1">¯</mo></mover><mo id="S5.T2.43.19.2.m1.4.7.5.3.2.3">;</mo><mover accent="true" id="S5.T2.43.19.2.m1.3.3"><msub id="S5.T2.43.19.2.m1.3.3.2"><mi id="S5.T2.43.19.2.m1.3.3.2.2">h</mi><mrow id="S5.T2.43.19.2.m1.3.3.2.3"><mi id="S5.T2.43.19.2.m1.3.3.2.3.2">t</mi><mo id="S5.T2.43.19.2.m1.3.3.2.3.1">⁢</mo><mi id="S5.T2.43.19.2.m1.3.3.2.3.3">r</mi><mo id="S5.T2.43.19.2.m1.3.3.2.3.1a">⁢</mo><mi id="S5.T2.43.19.2.m1.3.3.2.3.4">a</mi><mo id="S5.T2.43.19.2.m1.3.3.2.3.1b">⁢</mo><mi id="S5.T2.43.19.2.m1.3.3.2.3.5">n</mi><mo id="S5.T2.43.19.2.m1.3.3.2.3.1c">⁢</mo><mi id="S5.T2.43.19.2.m1.3.3.2.3.6">s</mi></mrow></msub><mo id="S5.T2.43.19.2.m1.3.3.1">¯</mo></mover><mo id="S5.T2.43.19.2.m1.4.7.5.3.2.4" rspace="0.055em" stretchy="false">]</mo></mrow><mo id="S5.T2.43.19.2.m1.4.7.5.3.3" rspace="0.222em">∗</mo><mi id="S5.T2.43.19.2.m1.4.7.5.3.4">ω</mi><mo id="S5.T2.43.19.2.m1.4.7.5.3.5" stretchy="false">)</mo></mrow><mo id="S5.T2.43.19.2.m1.4.7.5.4" stretchy="false">)</mo></mrow><mi id="S5.T2.43.19.2.m1.4.7.6">W</mi><mo id="S5.T2.43.19.2.m1.4.7.7" stretchy="false">)</mo></mrow><mo id="S5.T2.43.19.2.m1.4.8">,</mo><mi id="S5.T2.43.19.2.m1.4.4">t</mi><mo id="S5.T2.43.19.2.m1.4.9">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S5.T2.43.19.2.m1.4c">&lt;\sigma(vec(\sigma([\overline{h};\overline{r};\overline{h_{trans}}]\ast\omega)%
)W),t&gt;</annotation><annotation encoding="application/x-llamapun" id="S5.T2.43.19.2.m1.4d">&lt; italic_σ ( italic_v italic_e italic_c ( italic_σ ( [ over¯ start_ARG italic_h end_ARG ; over¯ start_ARG italic_r end_ARG ; over¯ start_ARG italic_h start_POSTSUBSCRIPT italic_t italic_r italic_a italic_n italic_s end_POSTSUBSCRIPT end_ARG ] ∗ italic_ω ) ) italic_W ) , italic_t &gt;</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Experiment setup</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">The number of GATH’s encoding layer is set to 2, and AdamW<cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib17" title="">2017</a>)</cite> is used as an optimization algorithm for the training of GATH. The above settings are applied to all baselines based on GCN and GAT. At the same time, in order to speed up convergence and prevent model overfitting, GATH also adopts dropout<cite class="ltx_cite ltx_citemacro_citep">(Srivastava et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib24" title="">2014</a>)</cite> and batch normalization<cite class="ltx_cite ltx_citemacro_citep">(Ioffe and Szegedy, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib12" title="">2015</a>)</cite> for entity and relation embeddings. Periodic decay of the learning rate is applied to GATH and baselines. A high learning rate makes the loss drop rapidly in the early stage of training and enters a plateau in the middle stage, and finally, a small learning rate makes the model converge slowly. Therefore, we set the initial learning rate to 0.01, and let it decay to 0.985 of the current learning rate every epoch. <em class="ltx_emph ltx_font_italic" id="S5.SS3.p1.1.2">batch_size</em> and <em class="ltx_emph ltx_font_italic" id="S5.SS3.p1.1.3">embedding_size</em> are set to 128 and 200 respectively. <span class="ltx_text" id="S5.SS3.p1.1.1" style="color:#000000;">For baselines that can use the block-diagonal-decomposition regularization scheme<cite class="ltx_cite ltx_citemacro_citep">(Schlichtkrull et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#bib.bib22" title="">2018</a>)</cite>, we set num_blocks to <math alttext="50" class="ltx_Math" display="inline" id="S5.SS3.p1.1.1.m1.1"><semantics id="S5.SS3.p1.1.1.m1.1a"><mn id="S5.SS3.p1.1.1.m1.1.1" mathcolor="#000000" xref="S5.SS3.p1.1.1.m1.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.1.m1.1b"><cn id="S5.SS3.p1.1.1.m1.1.1.cmml" type="integer" xref="S5.SS3.p1.1.1.m1.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.1.m1.1c">50</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.1.m1.1d">50</annotation></semantics></math>.</span></p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">The environment of GATH is python3.9+pytorch1.12 and it runs on NVIDIA 4090 Graphics Processing Units. The computation time of GATH for each epoch is about 4.3 minutes and 1.6 minutes for the FB15K-237 and WN18RR datasets respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Evaluation indicators</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.14">To evaluate the performance of GATH, we perform the link prediction task on the test set. Specifically, for each triplet <math alttext="(h,r,t)" class="ltx_Math" display="inline" id="S5.SS4.p1.1.m1.3"><semantics id="S5.SS4.p1.1.m1.3a"><mrow id="S5.SS4.p1.1.m1.3.4.2" xref="S5.SS4.p1.1.m1.3.4.1.cmml"><mo id="S5.SS4.p1.1.m1.3.4.2.1" stretchy="false" xref="S5.SS4.p1.1.m1.3.4.1.cmml">(</mo><mi id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml">h</mi><mo id="S5.SS4.p1.1.m1.3.4.2.2" xref="S5.SS4.p1.1.m1.3.4.1.cmml">,</mo><mi id="S5.SS4.p1.1.m1.2.2" xref="S5.SS4.p1.1.m1.2.2.cmml">r</mi><mo id="S5.SS4.p1.1.m1.3.4.2.3" xref="S5.SS4.p1.1.m1.3.4.1.cmml">,</mo><mi id="S5.SS4.p1.1.m1.3.3" xref="S5.SS4.p1.1.m1.3.3.cmml">t</mi><mo id="S5.SS4.p1.1.m1.3.4.2.4" stretchy="false" xref="S5.SS4.p1.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.3b"><vector id="S5.SS4.p1.1.m1.3.4.1.cmml" xref="S5.SS4.p1.1.m1.3.4.2"><ci id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">ℎ</ci><ci id="S5.SS4.p1.1.m1.2.2.cmml" xref="S5.SS4.p1.1.m1.2.2">𝑟</ci><ci id="S5.SS4.p1.1.m1.3.3.cmml" xref="S5.SS4.p1.1.m1.3.3">𝑡</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.3c">(h,r,t)</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.3d">( italic_h , italic_r , italic_t )</annotation></semantics></math> in the test set, we construct the corresponding reverse triplet <math alttext="(t,r\_reverse,h)" class="ltx_Math" display="inline" id="S5.SS4.p1.2.m2.3"><semantics id="S5.SS4.p1.2.m2.3a"><mrow id="S5.SS4.p1.2.m2.3.3.1" xref="S5.SS4.p1.2.m2.3.3.2.cmml"><mo id="S5.SS4.p1.2.m2.3.3.1.2" stretchy="false" xref="S5.SS4.p1.2.m2.3.3.2.cmml">(</mo><mi id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml">t</mi><mo id="S5.SS4.p1.2.m2.3.3.1.3" xref="S5.SS4.p1.2.m2.3.3.2.cmml">,</mo><mrow id="S5.SS4.p1.2.m2.3.3.1.1" xref="S5.SS4.p1.2.m2.3.3.1.1.cmml"><mi id="S5.SS4.p1.2.m2.3.3.1.1.2" xref="S5.SS4.p1.2.m2.3.3.1.1.2.cmml">r</mi><mo id="S5.SS4.p1.2.m2.3.3.1.1.1" xref="S5.SS4.p1.2.m2.3.3.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.3.3.1.1.3" mathvariant="normal" xref="S5.SS4.p1.2.m2.3.3.1.1.3.cmml">_</mi><mo id="S5.SS4.p1.2.m2.3.3.1.1.1a" xref="S5.SS4.p1.2.m2.3.3.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.3.3.1.1.4" xref="S5.SS4.p1.2.m2.3.3.1.1.4.cmml">r</mi><mo id="S5.SS4.p1.2.m2.3.3.1.1.1b" xref="S5.SS4.p1.2.m2.3.3.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.3.3.1.1.5" xref="S5.SS4.p1.2.m2.3.3.1.1.5.cmml">e</mi><mo id="S5.SS4.p1.2.m2.3.3.1.1.1c" xref="S5.SS4.p1.2.m2.3.3.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.3.3.1.1.6" xref="S5.SS4.p1.2.m2.3.3.1.1.6.cmml">v</mi><mo id="S5.SS4.p1.2.m2.3.3.1.1.1d" xref="S5.SS4.p1.2.m2.3.3.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.3.3.1.1.7" xref="S5.SS4.p1.2.m2.3.3.1.1.7.cmml">e</mi><mo id="S5.SS4.p1.2.m2.3.3.1.1.1e" xref="S5.SS4.p1.2.m2.3.3.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.3.3.1.1.8" xref="S5.SS4.p1.2.m2.3.3.1.1.8.cmml">r</mi><mo id="S5.SS4.p1.2.m2.3.3.1.1.1f" xref="S5.SS4.p1.2.m2.3.3.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.3.3.1.1.9" xref="S5.SS4.p1.2.m2.3.3.1.1.9.cmml">s</mi><mo id="S5.SS4.p1.2.m2.3.3.1.1.1g" xref="S5.SS4.p1.2.m2.3.3.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.2.m2.3.3.1.1.10" xref="S5.SS4.p1.2.m2.3.3.1.1.10.cmml">e</mi></mrow><mo id="S5.SS4.p1.2.m2.3.3.1.4" xref="S5.SS4.p1.2.m2.3.3.2.cmml">,</mo><mi id="S5.SS4.p1.2.m2.2.2" xref="S5.SS4.p1.2.m2.2.2.cmml">h</mi><mo id="S5.SS4.p1.2.m2.3.3.1.5" stretchy="false" xref="S5.SS4.p1.2.m2.3.3.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.3b"><vector id="S5.SS4.p1.2.m2.3.3.2.cmml" xref="S5.SS4.p1.2.m2.3.3.1"><ci id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">𝑡</ci><apply id="S5.SS4.p1.2.m2.3.3.1.1.cmml" xref="S5.SS4.p1.2.m2.3.3.1.1"><times id="S5.SS4.p1.2.m2.3.3.1.1.1.cmml" xref="S5.SS4.p1.2.m2.3.3.1.1.1"></times><ci id="S5.SS4.p1.2.m2.3.3.1.1.2.cmml" xref="S5.SS4.p1.2.m2.3.3.1.1.2">𝑟</ci><ci id="S5.SS4.p1.2.m2.3.3.1.1.3.cmml" xref="S5.SS4.p1.2.m2.3.3.1.1.3">_</ci><ci id="S5.SS4.p1.2.m2.3.3.1.1.4.cmml" xref="S5.SS4.p1.2.m2.3.3.1.1.4">𝑟</ci><ci id="S5.SS4.p1.2.m2.3.3.1.1.5.cmml" xref="S5.SS4.p1.2.m2.3.3.1.1.5">𝑒</ci><ci id="S5.SS4.p1.2.m2.3.3.1.1.6.cmml" xref="S5.SS4.p1.2.m2.3.3.1.1.6">𝑣</ci><ci id="S5.SS4.p1.2.m2.3.3.1.1.7.cmml" xref="S5.SS4.p1.2.m2.3.3.1.1.7">𝑒</ci><ci id="S5.SS4.p1.2.m2.3.3.1.1.8.cmml" xref="S5.SS4.p1.2.m2.3.3.1.1.8">𝑟</ci><ci id="S5.SS4.p1.2.m2.3.3.1.1.9.cmml" xref="S5.SS4.p1.2.m2.3.3.1.1.9">𝑠</ci><ci id="S5.SS4.p1.2.m2.3.3.1.1.10.cmml" xref="S5.SS4.p1.2.m2.3.3.1.1.10">𝑒</ci></apply><ci id="S5.SS4.p1.2.m2.2.2.cmml" xref="S5.SS4.p1.2.m2.2.2">ℎ</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.3c">(t,r\_reverse,h)</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.2.m2.3d">( italic_t , italic_r _ italic_r italic_e italic_v italic_e italic_r italic_s italic_e , italic_h )</annotation></semantics></math>. Each triplet <math alttext="(e1,r,e2)" class="ltx_Math" display="inline" id="S5.SS4.p1.3.m3.3"><semantics id="S5.SS4.p1.3.m3.3a"><mrow id="S5.SS4.p1.3.m3.3.3.2" xref="S5.SS4.p1.3.m3.3.3.3.cmml"><mo id="S5.SS4.p1.3.m3.3.3.2.3" stretchy="false" xref="S5.SS4.p1.3.m3.3.3.3.cmml">(</mo><mrow id="S5.SS4.p1.3.m3.2.2.1.1" xref="S5.SS4.p1.3.m3.2.2.1.1.cmml"><mi id="S5.SS4.p1.3.m3.2.2.1.1.2" xref="S5.SS4.p1.3.m3.2.2.1.1.2.cmml">e</mi><mo id="S5.SS4.p1.3.m3.2.2.1.1.1" xref="S5.SS4.p1.3.m3.2.2.1.1.1.cmml">⁢</mo><mn id="S5.SS4.p1.3.m3.2.2.1.1.3" xref="S5.SS4.p1.3.m3.2.2.1.1.3.cmml">1</mn></mrow><mo id="S5.SS4.p1.3.m3.3.3.2.4" xref="S5.SS4.p1.3.m3.3.3.3.cmml">,</mo><mi id="S5.SS4.p1.3.m3.1.1" xref="S5.SS4.p1.3.m3.1.1.cmml">r</mi><mo id="S5.SS4.p1.3.m3.3.3.2.5" xref="S5.SS4.p1.3.m3.3.3.3.cmml">,</mo><mrow id="S5.SS4.p1.3.m3.3.3.2.2" xref="S5.SS4.p1.3.m3.3.3.2.2.cmml"><mi id="S5.SS4.p1.3.m3.3.3.2.2.2" xref="S5.SS4.p1.3.m3.3.3.2.2.2.cmml">e</mi><mo id="S5.SS4.p1.3.m3.3.3.2.2.1" xref="S5.SS4.p1.3.m3.3.3.2.2.1.cmml">⁢</mo><mn id="S5.SS4.p1.3.m3.3.3.2.2.3" xref="S5.SS4.p1.3.m3.3.3.2.2.3.cmml">2</mn></mrow><mo id="S5.SS4.p1.3.m3.3.3.2.6" stretchy="false" xref="S5.SS4.p1.3.m3.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m3.3b"><vector id="S5.SS4.p1.3.m3.3.3.3.cmml" xref="S5.SS4.p1.3.m3.3.3.2"><apply id="S5.SS4.p1.3.m3.2.2.1.1.cmml" xref="S5.SS4.p1.3.m3.2.2.1.1"><times id="S5.SS4.p1.3.m3.2.2.1.1.1.cmml" xref="S5.SS4.p1.3.m3.2.2.1.1.1"></times><ci id="S5.SS4.p1.3.m3.2.2.1.1.2.cmml" xref="S5.SS4.p1.3.m3.2.2.1.1.2">𝑒</ci><cn id="S5.SS4.p1.3.m3.2.2.1.1.3.cmml" type="integer" xref="S5.SS4.p1.3.m3.2.2.1.1.3">1</cn></apply><ci id="S5.SS4.p1.3.m3.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1">𝑟</ci><apply id="S5.SS4.p1.3.m3.3.3.2.2.cmml" xref="S5.SS4.p1.3.m3.3.3.2.2"><times id="S5.SS4.p1.3.m3.3.3.2.2.1.cmml" xref="S5.SS4.p1.3.m3.3.3.2.2.1"></times><ci id="S5.SS4.p1.3.m3.3.3.2.2.2.cmml" xref="S5.SS4.p1.3.m3.3.3.2.2.2">𝑒</ci><cn id="S5.SS4.p1.3.m3.3.3.2.2.3.cmml" type="integer" xref="S5.SS4.p1.3.m3.3.3.2.2.3">2</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m3.3c">(e1,r,e2)</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.3.m3.3d">( italic_e 1 , italic_r , italic_e 2 )</annotation></semantics></math> in the constructed test set will be used for prediction. For the decoder, it receives the head entity <math alttext="e1" class="ltx_Math" display="inline" id="S5.SS4.p1.4.m4.1"><semantics id="S5.SS4.p1.4.m4.1a"><mrow id="S5.SS4.p1.4.m4.1.1" xref="S5.SS4.p1.4.m4.1.1.cmml"><mi id="S5.SS4.p1.4.m4.1.1.2" xref="S5.SS4.p1.4.m4.1.1.2.cmml">e</mi><mo id="S5.SS4.p1.4.m4.1.1.1" xref="S5.SS4.p1.4.m4.1.1.1.cmml">⁢</mo><mn id="S5.SS4.p1.4.m4.1.1.3" xref="S5.SS4.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.4.m4.1b"><apply id="S5.SS4.p1.4.m4.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1"><times id="S5.SS4.p1.4.m4.1.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1.1"></times><ci id="S5.SS4.p1.4.m4.1.1.2.cmml" xref="S5.SS4.p1.4.m4.1.1.2">𝑒</ci><cn id="S5.SS4.p1.4.m4.1.1.3.cmml" type="integer" xref="S5.SS4.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.4.m4.1c">e1</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.4.m4.1d">italic_e 1</annotation></semantics></math> and relation <math alttext="r" class="ltx_Math" display="inline" id="S5.SS4.p1.5.m5.1"><semantics id="S5.SS4.p1.5.m5.1a"><mi id="S5.SS4.p1.5.m5.1.1" xref="S5.SS4.p1.5.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.5.m5.1b"><ci id="S5.SS4.p1.5.m5.1.1.cmml" xref="S5.SS4.p1.5.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.5.m5.1c">r</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.5.m5.1d">italic_r</annotation></semantics></math> as input and outputs the probabilities of all tail entities. The prediction result is a list <math alttext="pred" class="ltx_Math" display="inline" id="S5.SS4.p1.6.m6.1"><semantics id="S5.SS4.p1.6.m6.1a"><mrow id="S5.SS4.p1.6.m6.1.1" xref="S5.SS4.p1.6.m6.1.1.cmml"><mi id="S5.SS4.p1.6.m6.1.1.2" xref="S5.SS4.p1.6.m6.1.1.2.cmml">p</mi><mo id="S5.SS4.p1.6.m6.1.1.1" xref="S5.SS4.p1.6.m6.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.6.m6.1.1.3" xref="S5.SS4.p1.6.m6.1.1.3.cmml">r</mi><mo id="S5.SS4.p1.6.m6.1.1.1a" xref="S5.SS4.p1.6.m6.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.6.m6.1.1.4" xref="S5.SS4.p1.6.m6.1.1.4.cmml">e</mi><mo id="S5.SS4.p1.6.m6.1.1.1b" xref="S5.SS4.p1.6.m6.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.6.m6.1.1.5" xref="S5.SS4.p1.6.m6.1.1.5.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.6.m6.1b"><apply id="S5.SS4.p1.6.m6.1.1.cmml" xref="S5.SS4.p1.6.m6.1.1"><times id="S5.SS4.p1.6.m6.1.1.1.cmml" xref="S5.SS4.p1.6.m6.1.1.1"></times><ci id="S5.SS4.p1.6.m6.1.1.2.cmml" xref="S5.SS4.p1.6.m6.1.1.2">𝑝</ci><ci id="S5.SS4.p1.6.m6.1.1.3.cmml" xref="S5.SS4.p1.6.m6.1.1.3">𝑟</ci><ci id="S5.SS4.p1.6.m6.1.1.4.cmml" xref="S5.SS4.p1.6.m6.1.1.4">𝑒</ci><ci id="S5.SS4.p1.6.m6.1.1.5.cmml" xref="S5.SS4.p1.6.m6.1.1.5">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.6.m6.1c">pred</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.6.m6.1d">italic_p italic_r italic_e italic_d</annotation></semantics></math>, whose length is the number of all entities, and the corresponding element <math alttext="pred[i]" class="ltx_Math" display="inline" id="S5.SS4.p1.7.m7.1"><semantics id="S5.SS4.p1.7.m7.1a"><mrow id="S5.SS4.p1.7.m7.1.2" xref="S5.SS4.p1.7.m7.1.2.cmml"><mi id="S5.SS4.p1.7.m7.1.2.2" xref="S5.SS4.p1.7.m7.1.2.2.cmml">p</mi><mo id="S5.SS4.p1.7.m7.1.2.1" xref="S5.SS4.p1.7.m7.1.2.1.cmml">⁢</mo><mi id="S5.SS4.p1.7.m7.1.2.3" xref="S5.SS4.p1.7.m7.1.2.3.cmml">r</mi><mo id="S5.SS4.p1.7.m7.1.2.1a" xref="S5.SS4.p1.7.m7.1.2.1.cmml">⁢</mo><mi id="S5.SS4.p1.7.m7.1.2.4" xref="S5.SS4.p1.7.m7.1.2.4.cmml">e</mi><mo id="S5.SS4.p1.7.m7.1.2.1b" xref="S5.SS4.p1.7.m7.1.2.1.cmml">⁢</mo><mi id="S5.SS4.p1.7.m7.1.2.5" xref="S5.SS4.p1.7.m7.1.2.5.cmml">d</mi><mo id="S5.SS4.p1.7.m7.1.2.1c" xref="S5.SS4.p1.7.m7.1.2.1.cmml">⁢</mo><mrow id="S5.SS4.p1.7.m7.1.2.6.2" xref="S5.SS4.p1.7.m7.1.2.6.1.cmml"><mo id="S5.SS4.p1.7.m7.1.2.6.2.1" stretchy="false" xref="S5.SS4.p1.7.m7.1.2.6.1.1.cmml">[</mo><mi id="S5.SS4.p1.7.m7.1.1" xref="S5.SS4.p1.7.m7.1.1.cmml">i</mi><mo id="S5.SS4.p1.7.m7.1.2.6.2.2" stretchy="false" xref="S5.SS4.p1.7.m7.1.2.6.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.7.m7.1b"><apply id="S5.SS4.p1.7.m7.1.2.cmml" xref="S5.SS4.p1.7.m7.1.2"><times id="S5.SS4.p1.7.m7.1.2.1.cmml" xref="S5.SS4.p1.7.m7.1.2.1"></times><ci id="S5.SS4.p1.7.m7.1.2.2.cmml" xref="S5.SS4.p1.7.m7.1.2.2">𝑝</ci><ci id="S5.SS4.p1.7.m7.1.2.3.cmml" xref="S5.SS4.p1.7.m7.1.2.3">𝑟</ci><ci id="S5.SS4.p1.7.m7.1.2.4.cmml" xref="S5.SS4.p1.7.m7.1.2.4">𝑒</ci><ci id="S5.SS4.p1.7.m7.1.2.5.cmml" xref="S5.SS4.p1.7.m7.1.2.5">𝑑</ci><apply id="S5.SS4.p1.7.m7.1.2.6.1.cmml" xref="S5.SS4.p1.7.m7.1.2.6.2"><csymbol cd="latexml" id="S5.SS4.p1.7.m7.1.2.6.1.1.cmml" xref="S5.SS4.p1.7.m7.1.2.6.2.1">delimited-[]</csymbol><ci id="S5.SS4.p1.7.m7.1.1.cmml" xref="S5.SS4.p1.7.m7.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.7.m7.1c">pred[i]</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.7.m7.1d">italic_p italic_r italic_e italic_d [ italic_i ]</annotation></semantics></math> is the probability of triplet <math alttext="(e_{1},r,e_{v_{i}})" class="ltx_Math" display="inline" id="S5.SS4.p1.8.m8.3"><semantics id="S5.SS4.p1.8.m8.3a"><mrow id="S5.SS4.p1.8.m8.3.3.2" xref="S5.SS4.p1.8.m8.3.3.3.cmml"><mo id="S5.SS4.p1.8.m8.3.3.2.3" stretchy="false" xref="S5.SS4.p1.8.m8.3.3.3.cmml">(</mo><msub id="S5.SS4.p1.8.m8.2.2.1.1" xref="S5.SS4.p1.8.m8.2.2.1.1.cmml"><mi id="S5.SS4.p1.8.m8.2.2.1.1.2" xref="S5.SS4.p1.8.m8.2.2.1.1.2.cmml">e</mi><mn id="S5.SS4.p1.8.m8.2.2.1.1.3" xref="S5.SS4.p1.8.m8.2.2.1.1.3.cmml">1</mn></msub><mo id="S5.SS4.p1.8.m8.3.3.2.4" xref="S5.SS4.p1.8.m8.3.3.3.cmml">,</mo><mi id="S5.SS4.p1.8.m8.1.1" xref="S5.SS4.p1.8.m8.1.1.cmml">r</mi><mo id="S5.SS4.p1.8.m8.3.3.2.5" xref="S5.SS4.p1.8.m8.3.3.3.cmml">,</mo><msub id="S5.SS4.p1.8.m8.3.3.2.2" xref="S5.SS4.p1.8.m8.3.3.2.2.cmml"><mi id="S5.SS4.p1.8.m8.3.3.2.2.2" xref="S5.SS4.p1.8.m8.3.3.2.2.2.cmml">e</mi><msub id="S5.SS4.p1.8.m8.3.3.2.2.3" xref="S5.SS4.p1.8.m8.3.3.2.2.3.cmml"><mi id="S5.SS4.p1.8.m8.3.3.2.2.3.2" xref="S5.SS4.p1.8.m8.3.3.2.2.3.2.cmml">v</mi><mi id="S5.SS4.p1.8.m8.3.3.2.2.3.3" xref="S5.SS4.p1.8.m8.3.3.2.2.3.3.cmml">i</mi></msub></msub><mo id="S5.SS4.p1.8.m8.3.3.2.6" stretchy="false" xref="S5.SS4.p1.8.m8.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.8.m8.3b"><vector id="S5.SS4.p1.8.m8.3.3.3.cmml" xref="S5.SS4.p1.8.m8.3.3.2"><apply id="S5.SS4.p1.8.m8.2.2.1.1.cmml" xref="S5.SS4.p1.8.m8.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.8.m8.2.2.1.1.1.cmml" xref="S5.SS4.p1.8.m8.2.2.1.1">subscript</csymbol><ci id="S5.SS4.p1.8.m8.2.2.1.1.2.cmml" xref="S5.SS4.p1.8.m8.2.2.1.1.2">𝑒</ci><cn id="S5.SS4.p1.8.m8.2.2.1.1.3.cmml" type="integer" xref="S5.SS4.p1.8.m8.2.2.1.1.3">1</cn></apply><ci id="S5.SS4.p1.8.m8.1.1.cmml" xref="S5.SS4.p1.8.m8.1.1">𝑟</ci><apply id="S5.SS4.p1.8.m8.3.3.2.2.cmml" xref="S5.SS4.p1.8.m8.3.3.2.2"><csymbol cd="ambiguous" id="S5.SS4.p1.8.m8.3.3.2.2.1.cmml" xref="S5.SS4.p1.8.m8.3.3.2.2">subscript</csymbol><ci id="S5.SS4.p1.8.m8.3.3.2.2.2.cmml" xref="S5.SS4.p1.8.m8.3.3.2.2.2">𝑒</ci><apply id="S5.SS4.p1.8.m8.3.3.2.2.3.cmml" xref="S5.SS4.p1.8.m8.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.SS4.p1.8.m8.3.3.2.2.3.1.cmml" xref="S5.SS4.p1.8.m8.3.3.2.2.3">subscript</csymbol><ci id="S5.SS4.p1.8.m8.3.3.2.2.3.2.cmml" xref="S5.SS4.p1.8.m8.3.3.2.2.3.2">𝑣</ci><ci id="S5.SS4.p1.8.m8.3.3.2.2.3.3.cmml" xref="S5.SS4.p1.8.m8.3.3.2.2.3.3">𝑖</ci></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.8.m8.3c">(e_{1},r,e_{v_{i}})</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.8.m8.3d">( italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r , italic_e start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> in KGs. Since the triplets in the training set and test set will also appear in the prediction list, <math alttext="pred" class="ltx_Math" display="inline" id="S5.SS4.p1.9.m9.1"><semantics id="S5.SS4.p1.9.m9.1a"><mrow id="S5.SS4.p1.9.m9.1.1" xref="S5.SS4.p1.9.m9.1.1.cmml"><mi id="S5.SS4.p1.9.m9.1.1.2" xref="S5.SS4.p1.9.m9.1.1.2.cmml">p</mi><mo id="S5.SS4.p1.9.m9.1.1.1" xref="S5.SS4.p1.9.m9.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.9.m9.1.1.3" xref="S5.SS4.p1.9.m9.1.1.3.cmml">r</mi><mo id="S5.SS4.p1.9.m9.1.1.1a" xref="S5.SS4.p1.9.m9.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.9.m9.1.1.4" xref="S5.SS4.p1.9.m9.1.1.4.cmml">e</mi><mo id="S5.SS4.p1.9.m9.1.1.1b" xref="S5.SS4.p1.9.m9.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.9.m9.1.1.5" xref="S5.SS4.p1.9.m9.1.1.5.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.9.m9.1b"><apply id="S5.SS4.p1.9.m9.1.1.cmml" xref="S5.SS4.p1.9.m9.1.1"><times id="S5.SS4.p1.9.m9.1.1.1.cmml" xref="S5.SS4.p1.9.m9.1.1.1"></times><ci id="S5.SS4.p1.9.m9.1.1.2.cmml" xref="S5.SS4.p1.9.m9.1.1.2">𝑝</ci><ci id="S5.SS4.p1.9.m9.1.1.3.cmml" xref="S5.SS4.p1.9.m9.1.1.3">𝑟</ci><ci id="S5.SS4.p1.9.m9.1.1.4.cmml" xref="S5.SS4.p1.9.m9.1.1.4">𝑒</ci><ci id="S5.SS4.p1.9.m9.1.1.5.cmml" xref="S5.SS4.p1.9.m9.1.1.5">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.9.m9.1c">pred</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.9.m9.1d">italic_p italic_r italic_e italic_d</annotation></semantics></math> needs to be filtered, that is, the probability of the corresponding triplet is set to 0. Sort <math alttext="pred" class="ltx_Math" display="inline" id="S5.SS4.p1.10.m10.1"><semantics id="S5.SS4.p1.10.m10.1a"><mrow id="S5.SS4.p1.10.m10.1.1" xref="S5.SS4.p1.10.m10.1.1.cmml"><mi id="S5.SS4.p1.10.m10.1.1.2" xref="S5.SS4.p1.10.m10.1.1.2.cmml">p</mi><mo id="S5.SS4.p1.10.m10.1.1.1" xref="S5.SS4.p1.10.m10.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.10.m10.1.1.3" xref="S5.SS4.p1.10.m10.1.1.3.cmml">r</mi><mo id="S5.SS4.p1.10.m10.1.1.1a" xref="S5.SS4.p1.10.m10.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.10.m10.1.1.4" xref="S5.SS4.p1.10.m10.1.1.4.cmml">e</mi><mo id="S5.SS4.p1.10.m10.1.1.1b" xref="S5.SS4.p1.10.m10.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.10.m10.1.1.5" xref="S5.SS4.p1.10.m10.1.1.5.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.10.m10.1b"><apply id="S5.SS4.p1.10.m10.1.1.cmml" xref="S5.SS4.p1.10.m10.1.1"><times id="S5.SS4.p1.10.m10.1.1.1.cmml" xref="S5.SS4.p1.10.m10.1.1.1"></times><ci id="S5.SS4.p1.10.m10.1.1.2.cmml" xref="S5.SS4.p1.10.m10.1.1.2">𝑝</ci><ci id="S5.SS4.p1.10.m10.1.1.3.cmml" xref="S5.SS4.p1.10.m10.1.1.3">𝑟</ci><ci id="S5.SS4.p1.10.m10.1.1.4.cmml" xref="S5.SS4.p1.10.m10.1.1.4">𝑒</ci><ci id="S5.SS4.p1.10.m10.1.1.5.cmml" xref="S5.SS4.p1.10.m10.1.1.5">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.10.m10.1c">pred</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.10.m10.1d">italic_p italic_r italic_e italic_d</annotation></semantics></math> from high to low to generate <math alttext="spred" class="ltx_Math" display="inline" id="S5.SS4.p1.11.m11.1"><semantics id="S5.SS4.p1.11.m11.1a"><mrow id="S5.SS4.p1.11.m11.1.1" xref="S5.SS4.p1.11.m11.1.1.cmml"><mi id="S5.SS4.p1.11.m11.1.1.2" xref="S5.SS4.p1.11.m11.1.1.2.cmml">s</mi><mo id="S5.SS4.p1.11.m11.1.1.1" xref="S5.SS4.p1.11.m11.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.11.m11.1.1.3" xref="S5.SS4.p1.11.m11.1.1.3.cmml">p</mi><mo id="S5.SS4.p1.11.m11.1.1.1a" xref="S5.SS4.p1.11.m11.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.11.m11.1.1.4" xref="S5.SS4.p1.11.m11.1.1.4.cmml">r</mi><mo id="S5.SS4.p1.11.m11.1.1.1b" xref="S5.SS4.p1.11.m11.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.11.m11.1.1.5" xref="S5.SS4.p1.11.m11.1.1.5.cmml">e</mi><mo id="S5.SS4.p1.11.m11.1.1.1c" xref="S5.SS4.p1.11.m11.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.11.m11.1.1.6" xref="S5.SS4.p1.11.m11.1.1.6.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.11.m11.1b"><apply id="S5.SS4.p1.11.m11.1.1.cmml" xref="S5.SS4.p1.11.m11.1.1"><times id="S5.SS4.p1.11.m11.1.1.1.cmml" xref="S5.SS4.p1.11.m11.1.1.1"></times><ci id="S5.SS4.p1.11.m11.1.1.2.cmml" xref="S5.SS4.p1.11.m11.1.1.2">𝑠</ci><ci id="S5.SS4.p1.11.m11.1.1.3.cmml" xref="S5.SS4.p1.11.m11.1.1.3">𝑝</ci><ci id="S5.SS4.p1.11.m11.1.1.4.cmml" xref="S5.SS4.p1.11.m11.1.1.4">𝑟</ci><ci id="S5.SS4.p1.11.m11.1.1.5.cmml" xref="S5.SS4.p1.11.m11.1.1.5">𝑒</ci><ci id="S5.SS4.p1.11.m11.1.1.6.cmml" xref="S5.SS4.p1.11.m11.1.1.6">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.11.m11.1c">spred</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.11.m11.1d">italic_s italic_p italic_r italic_e italic_d</annotation></semantics></math>, and the index of <math alttext="e_{2}" class="ltx_Math" display="inline" id="S5.SS4.p1.12.m12.1"><semantics id="S5.SS4.p1.12.m12.1a"><msub id="S5.SS4.p1.12.m12.1.1" xref="S5.SS4.p1.12.m12.1.1.cmml"><mi id="S5.SS4.p1.12.m12.1.1.2" xref="S5.SS4.p1.12.m12.1.1.2.cmml">e</mi><mn id="S5.SS4.p1.12.m12.1.1.3" xref="S5.SS4.p1.12.m12.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.12.m12.1b"><apply id="S5.SS4.p1.12.m12.1.1.cmml" xref="S5.SS4.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.12.m12.1.1.1.cmml" xref="S5.SS4.p1.12.m12.1.1">subscript</csymbol><ci id="S5.SS4.p1.12.m12.1.1.2.cmml" xref="S5.SS4.p1.12.m12.1.1.2">𝑒</ci><cn id="S5.SS4.p1.12.m12.1.1.3.cmml" type="integer" xref="S5.SS4.p1.12.m12.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.12.m12.1c">e_{2}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.12.m12.1d">italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="spred" class="ltx_Math" display="inline" id="S5.SS4.p1.13.m13.1"><semantics id="S5.SS4.p1.13.m13.1a"><mrow id="S5.SS4.p1.13.m13.1.1" xref="S5.SS4.p1.13.m13.1.1.cmml"><mi id="S5.SS4.p1.13.m13.1.1.2" xref="S5.SS4.p1.13.m13.1.1.2.cmml">s</mi><mo id="S5.SS4.p1.13.m13.1.1.1" xref="S5.SS4.p1.13.m13.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.13.m13.1.1.3" xref="S5.SS4.p1.13.m13.1.1.3.cmml">p</mi><mo id="S5.SS4.p1.13.m13.1.1.1a" xref="S5.SS4.p1.13.m13.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.13.m13.1.1.4" xref="S5.SS4.p1.13.m13.1.1.4.cmml">r</mi><mo id="S5.SS4.p1.13.m13.1.1.1b" xref="S5.SS4.p1.13.m13.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.13.m13.1.1.5" xref="S5.SS4.p1.13.m13.1.1.5.cmml">e</mi><mo id="S5.SS4.p1.13.m13.1.1.1c" xref="S5.SS4.p1.13.m13.1.1.1.cmml">⁢</mo><mi id="S5.SS4.p1.13.m13.1.1.6" xref="S5.SS4.p1.13.m13.1.1.6.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.13.m13.1b"><apply id="S5.SS4.p1.13.m13.1.1.cmml" xref="S5.SS4.p1.13.m13.1.1"><times id="S5.SS4.p1.13.m13.1.1.1.cmml" xref="S5.SS4.p1.13.m13.1.1.1"></times><ci id="S5.SS4.p1.13.m13.1.1.2.cmml" xref="S5.SS4.p1.13.m13.1.1.2">𝑠</ci><ci id="S5.SS4.p1.13.m13.1.1.3.cmml" xref="S5.SS4.p1.13.m13.1.1.3">𝑝</ci><ci id="S5.SS4.p1.13.m13.1.1.4.cmml" xref="S5.SS4.p1.13.m13.1.1.4">𝑟</ci><ci id="S5.SS4.p1.13.m13.1.1.5.cmml" xref="S5.SS4.p1.13.m13.1.1.5">𝑒</ci><ci id="S5.SS4.p1.13.m13.1.1.6.cmml" xref="S5.SS4.p1.13.m13.1.1.6">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.13.m13.1c">spred</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.13.m13.1d">italic_s italic_p italic_r italic_e italic_d</annotation></semantics></math> is the ranking score for <math alttext="(e_{1},r,e_{2})" class="ltx_Math" display="inline" id="S5.SS4.p1.14.m14.3"><semantics id="S5.SS4.p1.14.m14.3a"><mrow id="S5.SS4.p1.14.m14.3.3.2" xref="S5.SS4.p1.14.m14.3.3.3.cmml"><mo id="S5.SS4.p1.14.m14.3.3.2.3" stretchy="false" xref="S5.SS4.p1.14.m14.3.3.3.cmml">(</mo><msub id="S5.SS4.p1.14.m14.2.2.1.1" xref="S5.SS4.p1.14.m14.2.2.1.1.cmml"><mi id="S5.SS4.p1.14.m14.2.2.1.1.2" xref="S5.SS4.p1.14.m14.2.2.1.1.2.cmml">e</mi><mn id="S5.SS4.p1.14.m14.2.2.1.1.3" xref="S5.SS4.p1.14.m14.2.2.1.1.3.cmml">1</mn></msub><mo id="S5.SS4.p1.14.m14.3.3.2.4" xref="S5.SS4.p1.14.m14.3.3.3.cmml">,</mo><mi id="S5.SS4.p1.14.m14.1.1" xref="S5.SS4.p1.14.m14.1.1.cmml">r</mi><mo id="S5.SS4.p1.14.m14.3.3.2.5" xref="S5.SS4.p1.14.m14.3.3.3.cmml">,</mo><msub id="S5.SS4.p1.14.m14.3.3.2.2" xref="S5.SS4.p1.14.m14.3.3.2.2.cmml"><mi id="S5.SS4.p1.14.m14.3.3.2.2.2" xref="S5.SS4.p1.14.m14.3.3.2.2.2.cmml">e</mi><mn id="S5.SS4.p1.14.m14.3.3.2.2.3" xref="S5.SS4.p1.14.m14.3.3.2.2.3.cmml">2</mn></msub><mo id="S5.SS4.p1.14.m14.3.3.2.6" stretchy="false" xref="S5.SS4.p1.14.m14.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.14.m14.3b"><vector id="S5.SS4.p1.14.m14.3.3.3.cmml" xref="S5.SS4.p1.14.m14.3.3.2"><apply id="S5.SS4.p1.14.m14.2.2.1.1.cmml" xref="S5.SS4.p1.14.m14.2.2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.14.m14.2.2.1.1.1.cmml" xref="S5.SS4.p1.14.m14.2.2.1.1">subscript</csymbol><ci id="S5.SS4.p1.14.m14.2.2.1.1.2.cmml" xref="S5.SS4.p1.14.m14.2.2.1.1.2">𝑒</ci><cn id="S5.SS4.p1.14.m14.2.2.1.1.3.cmml" type="integer" xref="S5.SS4.p1.14.m14.2.2.1.1.3">1</cn></apply><ci id="S5.SS4.p1.14.m14.1.1.cmml" xref="S5.SS4.p1.14.m14.1.1">𝑟</ci><apply id="S5.SS4.p1.14.m14.3.3.2.2.cmml" xref="S5.SS4.p1.14.m14.3.3.2.2"><csymbol cd="ambiguous" id="S5.SS4.p1.14.m14.3.3.2.2.1.cmml" xref="S5.SS4.p1.14.m14.3.3.2.2">subscript</csymbol><ci id="S5.SS4.p1.14.m14.3.3.2.2.2.cmml" xref="S5.SS4.p1.14.m14.3.3.2.2.2">𝑒</ci><cn id="S5.SS4.p1.14.m14.3.3.2.2.3.cmml" type="integer" xref="S5.SS4.p1.14.m14.3.3.2.2.3">2</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.14.m14.3c">(e_{1},r,e_{2})</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.14.m14.3d">( italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r , italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>. The specific metrics include Mean Reciprocal Rank (MRR), Mean Rank (MR) and the percentage of correct entities ranked top 1, 3, and 10 (Hits@1, Hits@3, Hits@10). These metrics are calculated as follows,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S7.EGx2">
<tbody id="S5.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath" id="S5.Ex1.2.1.1.1">MRR</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{|S|}\sum_{i=1}^{|S|}\frac{1}{\text{rank}_{i}}" class="ltx_Math" display="inline" id="S5.Ex1.m2.2"><semantics id="S5.Ex1.m2.2a"><mrow id="S5.Ex1.m2.2.3" xref="S5.Ex1.m2.2.3.cmml"><mi id="S5.Ex1.m2.2.3.2" xref="S5.Ex1.m2.2.3.2.cmml"></mi><mo id="S5.Ex1.m2.2.3.1" xref="S5.Ex1.m2.2.3.1.cmml">=</mo><mrow id="S5.Ex1.m2.2.3.3" xref="S5.Ex1.m2.2.3.3.cmml"><mstyle displaystyle="true" id="S5.Ex1.m2.1.1" xref="S5.Ex1.m2.1.1.cmml"><mfrac id="S5.Ex1.m2.1.1a" xref="S5.Ex1.m2.1.1.cmml"><mn id="S5.Ex1.m2.1.1.3" xref="S5.Ex1.m2.1.1.3.cmml">1</mn><mrow id="S5.Ex1.m2.1.1.1.3" xref="S5.Ex1.m2.1.1.1.2.cmml"><mo id="S5.Ex1.m2.1.1.1.3.1" stretchy="false" xref="S5.Ex1.m2.1.1.1.2.1.cmml">|</mo><mi id="S5.Ex1.m2.1.1.1.1" xref="S5.Ex1.m2.1.1.1.1.cmml">S</mi><mo id="S5.Ex1.m2.1.1.1.3.2" stretchy="false" xref="S5.Ex1.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S5.Ex1.m2.2.3.3.1" xref="S5.Ex1.m2.2.3.3.1.cmml">⁢</mo><mrow id="S5.Ex1.m2.2.3.3.2" xref="S5.Ex1.m2.2.3.3.2.cmml"><mstyle displaystyle="true" id="S5.Ex1.m2.2.3.3.2.1" xref="S5.Ex1.m2.2.3.3.2.1.cmml"><munderover id="S5.Ex1.m2.2.3.3.2.1a" xref="S5.Ex1.m2.2.3.3.2.1.cmml"><mo id="S5.Ex1.m2.2.3.3.2.1.2.2" movablelimits="false" xref="S5.Ex1.m2.2.3.3.2.1.2.2.cmml">∑</mo><mrow id="S5.Ex1.m2.2.3.3.2.1.2.3" xref="S5.Ex1.m2.2.3.3.2.1.2.3.cmml"><mi id="S5.Ex1.m2.2.3.3.2.1.2.3.2" xref="S5.Ex1.m2.2.3.3.2.1.2.3.2.cmml">i</mi><mo id="S5.Ex1.m2.2.3.3.2.1.2.3.1" xref="S5.Ex1.m2.2.3.3.2.1.2.3.1.cmml">=</mo><mn id="S5.Ex1.m2.2.3.3.2.1.2.3.3" xref="S5.Ex1.m2.2.3.3.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S5.Ex1.m2.2.2.1.3" xref="S5.Ex1.m2.2.2.1.2.cmml"><mo id="S5.Ex1.m2.2.2.1.3.1" stretchy="false" xref="S5.Ex1.m2.2.2.1.2.1.cmml">|</mo><mi id="S5.Ex1.m2.2.2.1.1" xref="S5.Ex1.m2.2.2.1.1.cmml">S</mi><mo id="S5.Ex1.m2.2.2.1.3.2" stretchy="false" xref="S5.Ex1.m2.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mstyle displaystyle="true" id="S5.Ex1.m2.2.3.3.2.2" xref="S5.Ex1.m2.2.3.3.2.2.cmml"><mfrac id="S5.Ex1.m2.2.3.3.2.2a" xref="S5.Ex1.m2.2.3.3.2.2.cmml"><mn id="S5.Ex1.m2.2.3.3.2.2.2" xref="S5.Ex1.m2.2.3.3.2.2.2.cmml">1</mn><msub id="S5.Ex1.m2.2.3.3.2.2.3" xref="S5.Ex1.m2.2.3.3.2.2.3.cmml"><mtext id="S5.Ex1.m2.2.3.3.2.2.3.2" xref="S5.Ex1.m2.2.3.3.2.2.3.2a.cmml">rank</mtext><mi id="S5.Ex1.m2.2.3.3.2.2.3.3" xref="S5.Ex1.m2.2.3.3.2.2.3.3.cmml">i</mi></msub></mfrac></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex1.m2.2b"><apply id="S5.Ex1.m2.2.3.cmml" xref="S5.Ex1.m2.2.3"><eq id="S5.Ex1.m2.2.3.1.cmml" xref="S5.Ex1.m2.2.3.1"></eq><csymbol cd="latexml" id="S5.Ex1.m2.2.3.2.cmml" xref="S5.Ex1.m2.2.3.2">absent</csymbol><apply id="S5.Ex1.m2.2.3.3.cmml" xref="S5.Ex1.m2.2.3.3"><times id="S5.Ex1.m2.2.3.3.1.cmml" xref="S5.Ex1.m2.2.3.3.1"></times><apply id="S5.Ex1.m2.1.1.cmml" xref="S5.Ex1.m2.1.1"><divide id="S5.Ex1.m2.1.1.2.cmml" xref="S5.Ex1.m2.1.1"></divide><cn id="S5.Ex1.m2.1.1.3.cmml" type="integer" xref="S5.Ex1.m2.1.1.3">1</cn><apply id="S5.Ex1.m2.1.1.1.2.cmml" xref="S5.Ex1.m2.1.1.1.3"><abs id="S5.Ex1.m2.1.1.1.2.1.cmml" xref="S5.Ex1.m2.1.1.1.3.1"></abs><ci id="S5.Ex1.m2.1.1.1.1.cmml" xref="S5.Ex1.m2.1.1.1.1">𝑆</ci></apply></apply><apply id="S5.Ex1.m2.2.3.3.2.cmml" xref="S5.Ex1.m2.2.3.3.2"><apply id="S5.Ex1.m2.2.3.3.2.1.cmml" xref="S5.Ex1.m2.2.3.3.2.1"><csymbol cd="ambiguous" id="S5.Ex1.m2.2.3.3.2.1.1.cmml" xref="S5.Ex1.m2.2.3.3.2.1">superscript</csymbol><apply id="S5.Ex1.m2.2.3.3.2.1.2.cmml" xref="S5.Ex1.m2.2.3.3.2.1"><csymbol cd="ambiguous" id="S5.Ex1.m2.2.3.3.2.1.2.1.cmml" xref="S5.Ex1.m2.2.3.3.2.1">subscript</csymbol><sum id="S5.Ex1.m2.2.3.3.2.1.2.2.cmml" xref="S5.Ex1.m2.2.3.3.2.1.2.2"></sum><apply id="S5.Ex1.m2.2.3.3.2.1.2.3.cmml" xref="S5.Ex1.m2.2.3.3.2.1.2.3"><eq id="S5.Ex1.m2.2.3.3.2.1.2.3.1.cmml" xref="S5.Ex1.m2.2.3.3.2.1.2.3.1"></eq><ci id="S5.Ex1.m2.2.3.3.2.1.2.3.2.cmml" xref="S5.Ex1.m2.2.3.3.2.1.2.3.2">𝑖</ci><cn id="S5.Ex1.m2.2.3.3.2.1.2.3.3.cmml" type="integer" xref="S5.Ex1.m2.2.3.3.2.1.2.3.3">1</cn></apply></apply><apply id="S5.Ex1.m2.2.2.1.2.cmml" xref="S5.Ex1.m2.2.2.1.3"><abs id="S5.Ex1.m2.2.2.1.2.1.cmml" xref="S5.Ex1.m2.2.2.1.3.1"></abs><ci id="S5.Ex1.m2.2.2.1.1.cmml" xref="S5.Ex1.m2.2.2.1.1">𝑆</ci></apply></apply><apply id="S5.Ex1.m2.2.3.3.2.2.cmml" xref="S5.Ex1.m2.2.3.3.2.2"><divide id="S5.Ex1.m2.2.3.3.2.2.1.cmml" xref="S5.Ex1.m2.2.3.3.2.2"></divide><cn id="S5.Ex1.m2.2.3.3.2.2.2.cmml" type="integer" xref="S5.Ex1.m2.2.3.3.2.2.2">1</cn><apply id="S5.Ex1.m2.2.3.3.2.2.3.cmml" xref="S5.Ex1.m2.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S5.Ex1.m2.2.3.3.2.2.3.1.cmml" xref="S5.Ex1.m2.2.3.3.2.2.3">subscript</csymbol><ci id="S5.Ex1.m2.2.3.3.2.2.3.2a.cmml" xref="S5.Ex1.m2.2.3.3.2.2.3.2"><mtext id="S5.Ex1.m2.2.3.3.2.2.3.2.cmml" xref="S5.Ex1.m2.2.3.3.2.2.3.2">rank</mtext></ci><ci id="S5.Ex1.m2.2.3.3.2.2.3.3.cmml" xref="S5.Ex1.m2.2.3.3.2.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex1.m2.2c">\displaystyle=\frac{1}{|S|}\sum_{i=1}^{|S|}\frac{1}{\text{rank}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S5.Ex1.m2.2d">= divide start_ARG 1 end_ARG start_ARG | italic_S | end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_S | end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG rank start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S5.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath" id="S5.Ex2.2.1.1.1">MR</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{|S|}\sum_{i=1}^{|S|}\text{rank}_{i}" class="ltx_Math" display="inline" id="S5.Ex2.m2.2"><semantics id="S5.Ex2.m2.2a"><mrow id="S5.Ex2.m2.2.3" xref="S5.Ex2.m2.2.3.cmml"><mi id="S5.Ex2.m2.2.3.2" xref="S5.Ex2.m2.2.3.2.cmml"></mi><mo id="S5.Ex2.m2.2.3.1" xref="S5.Ex2.m2.2.3.1.cmml">=</mo><mrow id="S5.Ex2.m2.2.3.3" xref="S5.Ex2.m2.2.3.3.cmml"><mstyle displaystyle="true" id="S5.Ex2.m2.1.1" xref="S5.Ex2.m2.1.1.cmml"><mfrac id="S5.Ex2.m2.1.1a" xref="S5.Ex2.m2.1.1.cmml"><mn id="S5.Ex2.m2.1.1.3" xref="S5.Ex2.m2.1.1.3.cmml">1</mn><mrow id="S5.Ex2.m2.1.1.1.3" xref="S5.Ex2.m2.1.1.1.2.cmml"><mo id="S5.Ex2.m2.1.1.1.3.1" stretchy="false" xref="S5.Ex2.m2.1.1.1.2.1.cmml">|</mo><mi id="S5.Ex2.m2.1.1.1.1" xref="S5.Ex2.m2.1.1.1.1.cmml">S</mi><mo id="S5.Ex2.m2.1.1.1.3.2" stretchy="false" xref="S5.Ex2.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S5.Ex2.m2.2.3.3.1" xref="S5.Ex2.m2.2.3.3.1.cmml">⁢</mo><mrow id="S5.Ex2.m2.2.3.3.2" xref="S5.Ex2.m2.2.3.3.2.cmml"><mstyle displaystyle="true" id="S5.Ex2.m2.2.3.3.2.1" xref="S5.Ex2.m2.2.3.3.2.1.cmml"><munderover id="S5.Ex2.m2.2.3.3.2.1a" xref="S5.Ex2.m2.2.3.3.2.1.cmml"><mo id="S5.Ex2.m2.2.3.3.2.1.2.2" movablelimits="false" xref="S5.Ex2.m2.2.3.3.2.1.2.2.cmml">∑</mo><mrow id="S5.Ex2.m2.2.3.3.2.1.2.3" xref="S5.Ex2.m2.2.3.3.2.1.2.3.cmml"><mi id="S5.Ex2.m2.2.3.3.2.1.2.3.2" xref="S5.Ex2.m2.2.3.3.2.1.2.3.2.cmml">i</mi><mo id="S5.Ex2.m2.2.3.3.2.1.2.3.1" xref="S5.Ex2.m2.2.3.3.2.1.2.3.1.cmml">=</mo><mn id="S5.Ex2.m2.2.3.3.2.1.2.3.3" xref="S5.Ex2.m2.2.3.3.2.1.2.3.3.cmml">1</mn></mrow><mrow id="S5.Ex2.m2.2.2.1.3" xref="S5.Ex2.m2.2.2.1.2.cmml"><mo id="S5.Ex2.m2.2.2.1.3.1" stretchy="false" xref="S5.Ex2.m2.2.2.1.2.1.cmml">|</mo><mi id="S5.Ex2.m2.2.2.1.1" xref="S5.Ex2.m2.2.2.1.1.cmml">S</mi><mo id="S5.Ex2.m2.2.2.1.3.2" stretchy="false" xref="S5.Ex2.m2.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><msub id="S5.Ex2.m2.2.3.3.2.2" xref="S5.Ex2.m2.2.3.3.2.2.cmml"><mtext id="S5.Ex2.m2.2.3.3.2.2.2" xref="S5.Ex2.m2.2.3.3.2.2.2a.cmml">rank</mtext><mi id="S5.Ex2.m2.2.3.3.2.2.3" xref="S5.Ex2.m2.2.3.3.2.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex2.m2.2b"><apply id="S5.Ex2.m2.2.3.cmml" xref="S5.Ex2.m2.2.3"><eq id="S5.Ex2.m2.2.3.1.cmml" xref="S5.Ex2.m2.2.3.1"></eq><csymbol cd="latexml" id="S5.Ex2.m2.2.3.2.cmml" xref="S5.Ex2.m2.2.3.2">absent</csymbol><apply id="S5.Ex2.m2.2.3.3.cmml" xref="S5.Ex2.m2.2.3.3"><times id="S5.Ex2.m2.2.3.3.1.cmml" xref="S5.Ex2.m2.2.3.3.1"></times><apply id="S5.Ex2.m2.1.1.cmml" xref="S5.Ex2.m2.1.1"><divide id="S5.Ex2.m2.1.1.2.cmml" xref="S5.Ex2.m2.1.1"></divide><cn id="S5.Ex2.m2.1.1.3.cmml" type="integer" xref="S5.Ex2.m2.1.1.3">1</cn><apply id="S5.Ex2.m2.1.1.1.2.cmml" xref="S5.Ex2.m2.1.1.1.3"><abs id="S5.Ex2.m2.1.1.1.2.1.cmml" xref="S5.Ex2.m2.1.1.1.3.1"></abs><ci id="S5.Ex2.m2.1.1.1.1.cmml" xref="S5.Ex2.m2.1.1.1.1">𝑆</ci></apply></apply><apply id="S5.Ex2.m2.2.3.3.2.cmml" xref="S5.Ex2.m2.2.3.3.2"><apply id="S5.Ex2.m2.2.3.3.2.1.cmml" xref="S5.Ex2.m2.2.3.3.2.1"><csymbol cd="ambiguous" id="S5.Ex2.m2.2.3.3.2.1.1.cmml" xref="S5.Ex2.m2.2.3.3.2.1">superscript</csymbol><apply id="S5.Ex2.m2.2.3.3.2.1.2.cmml" xref="S5.Ex2.m2.2.3.3.2.1"><csymbol cd="ambiguous" id="S5.Ex2.m2.2.3.3.2.1.2.1.cmml" xref="S5.Ex2.m2.2.3.3.2.1">subscript</csymbol><sum id="S5.Ex2.m2.2.3.3.2.1.2.2.cmml" xref="S5.Ex2.m2.2.3.3.2.1.2.2"></sum><apply id="S5.Ex2.m2.2.3.3.2.1.2.3.cmml" xref="S5.Ex2.m2.2.3.3.2.1.2.3"><eq id="S5.Ex2.m2.2.3.3.2.1.2.3.1.cmml" xref="S5.Ex2.m2.2.3.3.2.1.2.3.1"></eq><ci id="S5.Ex2.m2.2.3.3.2.1.2.3.2.cmml" xref="S5.Ex2.m2.2.3.3.2.1.2.3.2">𝑖</ci><cn id="S5.Ex2.m2.2.3.3.2.1.2.3.3.cmml" type="integer" xref="S5.Ex2.m2.2.3.3.2.1.2.3.3">1</cn></apply></apply><apply id="S5.Ex2.m2.2.2.1.2.cmml" xref="S5.Ex2.m2.2.2.1.3"><abs id="S5.Ex2.m2.2.2.1.2.1.cmml" xref="S5.Ex2.m2.2.2.1.3.1"></abs><ci id="S5.Ex2.m2.2.2.1.1.cmml" xref="S5.Ex2.m2.2.2.1.1">𝑆</ci></apply></apply><apply id="S5.Ex2.m2.2.3.3.2.2.cmml" xref="S5.Ex2.m2.2.3.3.2.2"><csymbol cd="ambiguous" id="S5.Ex2.m2.2.3.3.2.2.1.cmml" xref="S5.Ex2.m2.2.3.3.2.2">subscript</csymbol><ci id="S5.Ex2.m2.2.3.3.2.2.2a.cmml" xref="S5.Ex2.m2.2.3.3.2.2.2"><mtext id="S5.Ex2.m2.2.3.3.2.2.2.cmml" xref="S5.Ex2.m2.2.3.3.2.2.2">rank</mtext></ci><ci id="S5.Ex2.m2.2.3.3.2.2.3.cmml" xref="S5.Ex2.m2.2.3.3.2.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex2.m2.2c">\displaystyle=\frac{1}{|S|}\sum_{i=1}^{|S|}\text{rank}_{i}</annotation><annotation encoding="application/x-llamapun" id="S5.Ex2.m2.2d">= divide start_ARG 1 end_ARG start_ARG | italic_S | end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_S | end_POSTSUPERSCRIPT rank start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S5.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{Hits@}n" class="ltx_Math" display="inline" id="S5.Ex3.m1.1"><semantics id="S5.Ex3.m1.1a"><mrow id="S5.Ex3.m1.1.1" xref="S5.Ex3.m1.1.1.cmml"><mtext id="S5.Ex3.m1.1.1.2" xref="S5.Ex3.m1.1.1.2a.cmml">Hits@</mtext><mo id="S5.Ex3.m1.1.1.1" xref="S5.Ex3.m1.1.1.1.cmml">⁢</mo><mi id="S5.Ex3.m1.1.1.3" xref="S5.Ex3.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex3.m1.1b"><apply id="S5.Ex3.m1.1.1.cmml" xref="S5.Ex3.m1.1.1"><times id="S5.Ex3.m1.1.1.1.cmml" xref="S5.Ex3.m1.1.1.1"></times><ci id="S5.Ex3.m1.1.1.2a.cmml" xref="S5.Ex3.m1.1.1.2"><mtext id="S5.Ex3.m1.1.1.2.cmml" xref="S5.Ex3.m1.1.1.2">Hits@</mtext></ci><ci id="S5.Ex3.m1.1.1.3.cmml" xref="S5.Ex3.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex3.m1.1c">\displaystyle\text{Hits@}n</annotation><annotation encoding="application/x-llamapun" id="S5.Ex3.m1.1d">Hits@ italic_n</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{|S|}\sum_{i=1}^{|S|}I(\text{rank}_{i}\leq n),where\ n=1%
,3,10" class="ltx_Math" display="inline" id="S5.Ex3.m2.7"><semantics id="S5.Ex3.m2.7a"><mrow id="S5.Ex3.m2.7.7.2" xref="S5.Ex3.m2.7.7.3.cmml"><mrow id="S5.Ex3.m2.6.6.1.1" xref="S5.Ex3.m2.6.6.1.1.cmml"><mi id="S5.Ex3.m2.6.6.1.1.3" xref="S5.Ex3.m2.6.6.1.1.3.cmml"></mi><mo id="S5.Ex3.m2.6.6.1.1.2" xref="S5.Ex3.m2.6.6.1.1.2.cmml">=</mo><mrow id="S5.Ex3.m2.6.6.1.1.1" xref="S5.Ex3.m2.6.6.1.1.1.cmml"><mstyle displaystyle="true" id="S5.Ex3.m2.1.1" xref="S5.Ex3.m2.1.1.cmml"><mfrac id="S5.Ex3.m2.1.1a" xref="S5.Ex3.m2.1.1.cmml"><mn id="S5.Ex3.m2.1.1.3" xref="S5.Ex3.m2.1.1.3.cmml">1</mn><mrow id="S5.Ex3.m2.1.1.1.3" xref="S5.Ex3.m2.1.1.1.2.cmml"><mo id="S5.Ex3.m2.1.1.1.3.1" stretchy="false" xref="S5.Ex3.m2.1.1.1.2.1.cmml">|</mo><mi id="S5.Ex3.m2.1.1.1.1" xref="S5.Ex3.m2.1.1.1.1.cmml">S</mi><mo id="S5.Ex3.m2.1.1.1.3.2" stretchy="false" xref="S5.Ex3.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S5.Ex3.m2.6.6.1.1.1.2" xref="S5.Ex3.m2.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S5.Ex3.m2.6.6.1.1.1.1" xref="S5.Ex3.m2.6.6.1.1.1.1.cmml"><mstyle displaystyle="true" id="S5.Ex3.m2.6.6.1.1.1.1.2" xref="S5.Ex3.m2.6.6.1.1.1.1.2.cmml"><munderover id="S5.Ex3.m2.6.6.1.1.1.1.2a" xref="S5.Ex3.m2.6.6.1.1.1.1.2.cmml"><mo id="S5.Ex3.m2.6.6.1.1.1.1.2.2.2" movablelimits="false" xref="S5.Ex3.m2.6.6.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S5.Ex3.m2.6.6.1.1.1.1.2.2.3" xref="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.cmml"><mi id="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.2" xref="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.1" xref="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.3" xref="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S5.Ex3.m2.2.2.1.3" xref="S5.Ex3.m2.2.2.1.2.cmml"><mo id="S5.Ex3.m2.2.2.1.3.1" stretchy="false" xref="S5.Ex3.m2.2.2.1.2.1.cmml">|</mo><mi id="S5.Ex3.m2.2.2.1.1" xref="S5.Ex3.m2.2.2.1.1.cmml">S</mi><mo id="S5.Ex3.m2.2.2.1.3.2" stretchy="false" xref="S5.Ex3.m2.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S5.Ex3.m2.6.6.1.1.1.1.1" xref="S5.Ex3.m2.6.6.1.1.1.1.1.cmml"><mi id="S5.Ex3.m2.6.6.1.1.1.1.1.3" xref="S5.Ex3.m2.6.6.1.1.1.1.1.3.cmml">I</mi><mo id="S5.Ex3.m2.6.6.1.1.1.1.1.2" xref="S5.Ex3.m2.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.cmml"><msub id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.cmml"><mtext id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.2" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.2a.cmml">rank</mtext><mi id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.3" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.1" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.1.cmml">≤</mo><mi id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.3" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S5.Ex3.m2.7.7.2.3" xref="S5.Ex3.m2.7.7.3a.cmml">,</mo><mrow id="S5.Ex3.m2.7.7.2.2" xref="S5.Ex3.m2.7.7.2.2.cmml"><mrow id="S5.Ex3.m2.7.7.2.2.2" xref="S5.Ex3.m2.7.7.2.2.2.cmml"><mi id="S5.Ex3.m2.7.7.2.2.2.2" xref="S5.Ex3.m2.7.7.2.2.2.2.cmml">w</mi><mo id="S5.Ex3.m2.7.7.2.2.2.1" xref="S5.Ex3.m2.7.7.2.2.2.1.cmml">⁢</mo><mi id="S5.Ex3.m2.7.7.2.2.2.3" xref="S5.Ex3.m2.7.7.2.2.2.3.cmml">h</mi><mo id="S5.Ex3.m2.7.7.2.2.2.1a" xref="S5.Ex3.m2.7.7.2.2.2.1.cmml">⁢</mo><mi id="S5.Ex3.m2.7.7.2.2.2.4" xref="S5.Ex3.m2.7.7.2.2.2.4.cmml">e</mi><mo id="S5.Ex3.m2.7.7.2.2.2.1b" xref="S5.Ex3.m2.7.7.2.2.2.1.cmml">⁢</mo><mi id="S5.Ex3.m2.7.7.2.2.2.5" xref="S5.Ex3.m2.7.7.2.2.2.5.cmml">r</mi><mo id="S5.Ex3.m2.7.7.2.2.2.1c" xref="S5.Ex3.m2.7.7.2.2.2.1.cmml">⁢</mo><mi id="S5.Ex3.m2.7.7.2.2.2.6" xref="S5.Ex3.m2.7.7.2.2.2.6.cmml">e</mi><mo id="S5.Ex3.m2.7.7.2.2.2.1d" lspace="0.500em" xref="S5.Ex3.m2.7.7.2.2.2.1.cmml">⁢</mo><mi id="S5.Ex3.m2.7.7.2.2.2.7" xref="S5.Ex3.m2.7.7.2.2.2.7.cmml">n</mi></mrow><mo id="S5.Ex3.m2.7.7.2.2.1" xref="S5.Ex3.m2.7.7.2.2.1.cmml">=</mo><mrow id="S5.Ex3.m2.7.7.2.2.3.2" xref="S5.Ex3.m2.7.7.2.2.3.1.cmml"><mn id="S5.Ex3.m2.3.3" xref="S5.Ex3.m2.3.3.cmml">1</mn><mo id="S5.Ex3.m2.7.7.2.2.3.2.1" xref="S5.Ex3.m2.7.7.2.2.3.1.cmml">,</mo><mn id="S5.Ex3.m2.4.4" xref="S5.Ex3.m2.4.4.cmml">3</mn><mo id="S5.Ex3.m2.7.7.2.2.3.2.2" xref="S5.Ex3.m2.7.7.2.2.3.1.cmml">,</mo><mn id="S5.Ex3.m2.5.5" xref="S5.Ex3.m2.5.5.cmml">10</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex3.m2.7b"><apply id="S5.Ex3.m2.7.7.3.cmml" xref="S5.Ex3.m2.7.7.2"><csymbol cd="ambiguous" id="S5.Ex3.m2.7.7.3a.cmml" xref="S5.Ex3.m2.7.7.2.3">formulae-sequence</csymbol><apply id="S5.Ex3.m2.6.6.1.1.cmml" xref="S5.Ex3.m2.6.6.1.1"><eq id="S5.Ex3.m2.6.6.1.1.2.cmml" xref="S5.Ex3.m2.6.6.1.1.2"></eq><csymbol cd="latexml" id="S5.Ex3.m2.6.6.1.1.3.cmml" xref="S5.Ex3.m2.6.6.1.1.3">absent</csymbol><apply id="S5.Ex3.m2.6.6.1.1.1.cmml" xref="S5.Ex3.m2.6.6.1.1.1"><times id="S5.Ex3.m2.6.6.1.1.1.2.cmml" xref="S5.Ex3.m2.6.6.1.1.1.2"></times><apply id="S5.Ex3.m2.1.1.cmml" xref="S5.Ex3.m2.1.1"><divide id="S5.Ex3.m2.1.1.2.cmml" xref="S5.Ex3.m2.1.1"></divide><cn id="S5.Ex3.m2.1.1.3.cmml" type="integer" xref="S5.Ex3.m2.1.1.3">1</cn><apply id="S5.Ex3.m2.1.1.1.2.cmml" xref="S5.Ex3.m2.1.1.1.3"><abs id="S5.Ex3.m2.1.1.1.2.1.cmml" xref="S5.Ex3.m2.1.1.1.3.1"></abs><ci id="S5.Ex3.m2.1.1.1.1.cmml" xref="S5.Ex3.m2.1.1.1.1">𝑆</ci></apply></apply><apply id="S5.Ex3.m2.6.6.1.1.1.1.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1"><apply id="S5.Ex3.m2.6.6.1.1.1.1.2.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex3.m2.6.6.1.1.1.1.2.1.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.2">superscript</csymbol><apply id="S5.Ex3.m2.6.6.1.1.1.1.2.2.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex3.m2.6.6.1.1.1.1.2.2.1.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.2">subscript</csymbol><sum id="S5.Ex3.m2.6.6.1.1.1.1.2.2.2.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.2.2.2"></sum><apply id="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.2.2.3"><eq id="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.1.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.1"></eq><ci id="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.2.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S5.Ex3.m2.6.6.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S5.Ex3.m2.2.2.1.2.cmml" xref="S5.Ex3.m2.2.2.1.3"><abs id="S5.Ex3.m2.2.2.1.2.1.cmml" xref="S5.Ex3.m2.2.2.1.3.1"></abs><ci id="S5.Ex3.m2.2.2.1.1.cmml" xref="S5.Ex3.m2.2.2.1.1">𝑆</ci></apply></apply><apply id="S5.Ex3.m2.6.6.1.1.1.1.1.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.1"><times id="S5.Ex3.m2.6.6.1.1.1.1.1.2.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.1.2"></times><ci id="S5.Ex3.m2.6.6.1.1.1.1.1.3.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.1.3">𝐼</ci><apply id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1"><leq id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.1"></leq><apply id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.2"><mtext id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.2">rank</mtext></ci><ci id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S5.Ex3.m2.6.6.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply></apply></apply><apply id="S5.Ex3.m2.7.7.2.2.cmml" xref="S5.Ex3.m2.7.7.2.2"><eq id="S5.Ex3.m2.7.7.2.2.1.cmml" xref="S5.Ex3.m2.7.7.2.2.1"></eq><apply id="S5.Ex3.m2.7.7.2.2.2.cmml" xref="S5.Ex3.m2.7.7.2.2.2"><times id="S5.Ex3.m2.7.7.2.2.2.1.cmml" xref="S5.Ex3.m2.7.7.2.2.2.1"></times><ci id="S5.Ex3.m2.7.7.2.2.2.2.cmml" xref="S5.Ex3.m2.7.7.2.2.2.2">𝑤</ci><ci id="S5.Ex3.m2.7.7.2.2.2.3.cmml" xref="S5.Ex3.m2.7.7.2.2.2.3">ℎ</ci><ci id="S5.Ex3.m2.7.7.2.2.2.4.cmml" xref="S5.Ex3.m2.7.7.2.2.2.4">𝑒</ci><ci id="S5.Ex3.m2.7.7.2.2.2.5.cmml" xref="S5.Ex3.m2.7.7.2.2.2.5">𝑟</ci><ci id="S5.Ex3.m2.7.7.2.2.2.6.cmml" xref="S5.Ex3.m2.7.7.2.2.2.6">𝑒</ci><ci id="S5.Ex3.m2.7.7.2.2.2.7.cmml" xref="S5.Ex3.m2.7.7.2.2.2.7">𝑛</ci></apply><list id="S5.Ex3.m2.7.7.2.2.3.1.cmml" xref="S5.Ex3.m2.7.7.2.2.3.2"><cn id="S5.Ex3.m2.3.3.cmml" type="integer" xref="S5.Ex3.m2.3.3">1</cn><cn id="S5.Ex3.m2.4.4.cmml" type="integer" xref="S5.Ex3.m2.4.4">3</cn><cn id="S5.Ex3.m2.5.5.cmml" type="integer" xref="S5.Ex3.m2.5.5">10</cn></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex3.m2.7c">\displaystyle=\frac{1}{|S|}\sum_{i=1}^{|S|}I(\text{rank}_{i}\leq n),where\ n=1%
,3,10</annotation><annotation encoding="application/x-llamapun" id="S5.Ex3.m2.7d">= divide start_ARG 1 end_ARG start_ARG | italic_S | end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_S | end_POSTSUPERSCRIPT italic_I ( rank start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≤ italic_n ) , italic_w italic_h italic_e italic_r italic_e italic_n = 1 , 3 , 10</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Result</h2>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1. </span>Overall performance</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">The performance of GATH is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.T3" title="Table 3 ‣ 6.1. Overall performance ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">3</span></a>. When compared with other existing knowledge graph embedding models, GATH can achieve the best performance in most indicators on FB15K-237 and WN18RR datasets. Next, we will conduct a more in-depth analysis of the results shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.T3" title="Table 3 ‣ 6.1. Overall performance ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">3</span></a>:</p>
</div>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1">First, we compare decoder-only baselines with our decoder. On FB15K-237, ConvTransE has better performance than other decoder-only baselines. It can be seen that our decoder is 1.7% higher than ConvTransE on the Hits@10 indicator, 7.3% on the Hits@1 indicator, and 4.5% on the MRR indicator. Compared with FB15K-237, WN18RR has a lot less complex connections, but our decoder can still maintain the competition. This demonstrates that relation-based entity feature transformation can improve performance when modeling heterogeneous KGs with complex connections.</p>
</div>
<div class="ltx_para" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1">Second, our proposed GATH is able to perceive structural information through graph attention networks, improving the quality of entity embeddings. By comparing GATH with our decoder, all indicators have been significantly improved. On FB15K-237, GATH improves Hits@1, Hits@10, and MRR by 15.5%, 11.2%, and 13.5% compared to our decoder. Similarly, on WN18RR, the performance of GATH improves by 7.0%, 9.4%, and 7.7%, respectively. This demonstrates the effectiveness of GATH’s encoding layer.</p>
</div>
<div class="ltx_para" id="S6.SS1.p4">
<p class="ltx_p" id="S6.SS1.p4.1">Thirdly, it’s noteworthy that our proposed GATH outperforms other GNN-based models, such as SACN and MRGAT, in most evaluation metrics. For example, compared with the best-performing model MRGAT in the GNN-based model, the three indicators (Hits@1, Hits@10, and MRR) of our GATH on FB15K-237 have increased by 5.4%, 5.2%, and 5.2% respectively, and the corresponding increases of 24.2%, 4.5%, and 14.6% on WN18RR. This indicates that GATH is more advanced. Unlike GCN-based models, GATH can adaptively learn the importance between entities to aggregate neighbor information. Furthermore, by exploring the intrinsic attention within entities, GATH provides higher-quality entity embeddings for downstream decoders, compared to most GAT-based models that only consider computing attention based on relational features.</p>
</div>
<div class="ltx_para" id="S6.SS1.p5">
<p class="ltx_p" id="S6.SS1.p5.1">Overall, after a comprehensive comparison with different types of knowledge graph embedding models, we find that our proposed GATH model shows significant competitiveness on all evaluation metrics. On the one hand, as a variant of GNN, GATH can capture the topological information in the graph, thus outperforming traditional knowledge graph embedding models such as TransE, RotatE, and ConvE, which only focus on independent triplets. On the other hand, compared to other GCN-based and GAT-based models, such as SACN, RGAT, NoGE and MRGAT, GATH still exhibits more advanced performance because its encoder can focus on important node information under complex connections within heterogeneous multi-relational graphs.</p>
</div>
<figure class="ltx_table" id="S6.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3. </span>Link prediction performance on FB15K-237 and WN18RR datasets</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S6.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T3.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt ltx_border_t" id="S6.T3.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.1.1.1">Models</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" colspan="5" id="S6.T3.1.1.1.2">
<span class="ltx_text ltx_font_bold" id="S6.T3.1.1.1.2.1">FB15K-237</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" colspan="5" id="S6.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S6.T3.1.1.1.3.1">WN18RR</span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.2.2">
<td class="ltx_td ltx_border_t" id="S6.T3.1.2.2.1"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S6.T3.1.2.2.2">Hits@n</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.2.2.3">MR</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.2.2.4">MRR</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S6.T3.1.2.2.5">Hits@n</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.2.2.6">MR</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.2.2.7">MRR</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.3.3">
<td class="ltx_td ltx_border_t" id="S6.T3.1.3.3.1"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.3.3.2">1</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.3.3.3">3</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.3.3.4">10</td>
<td class="ltx_td ltx_border_t" id="S6.T3.1.3.3.5"></td>
<td class="ltx_td ltx_border_t" id="S6.T3.1.3.3.6"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.3.3.7">1</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.3.3.8">3</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.1.3.3.9">10</td>
<td class="ltx_td ltx_border_t" id="S6.T3.1.3.3.10"></td>
<td class="ltx_td ltx_border_t" id="S6.T3.1.3.3.11"></td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.4.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="S6.T3.1.4.4.1">TransE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.4.4.2">0.105</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.4.4.3">0.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.4.4.4">0.425</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.4.4.5">401</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.4.4.6">0.219</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.4.4.7">0.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.4.4.8">0.318</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.4.4.9">0.458</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.4.4.10">5548</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.1.4.4.11">0.2</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.5.5">
<td class="ltx_td ltx_align_left" id="S6.T3.1.5.5.1">DistMult</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.5.5.2">0.158</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.5.5.3">0.247</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.5.5.4">0.363</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.5.5.5">1105</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.5.5.6">0.226</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.5.5.7">0.362</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.5.5.8">0.405</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.5.5.9">0.456</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.5.5.10">9249</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.5.5.11">0.392</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.6.6">
<td class="ltx_td ltx_align_left" id="S6.T3.1.6.6.1">ComplEx</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.6.6.2">0.215</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.6.6.3">0.329</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.6.6.4">0.466</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.6.6.5">666</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.6.6.6">0.298</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.6.6.7">0.386</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.6.6.8">0.437</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.6.6.9">0.493</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.6.6.10">8580</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.6.6.11">0.42</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.7.7">
<td class="ltx_td ltx_align_left" id="S6.T3.1.7.7.1">ConvE</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.7.7.2">0.207</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.7.7.3">0.316</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.7.7.4">0.461</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.7.7.5">362</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.7.7.6">0.29</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.7.7.7">0.394</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.7.7.8">0.434</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.7.7.9">0.490</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.7.7.10">5554</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.7.7.11">0.425</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.8.8">
<td class="ltx_td ltx_align_left" id="S6.T3.1.8.8.1">RotatE</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.8.8.2">0.205</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.8.8.3">0.317</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.8.8.4">0.457</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.8.8.5">515</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.8.8.6">0.288</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.8.8.7">0.406</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.8.8.8">0.451</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.8.8.9">0.494</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.8.8.10">7409</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.8.8.11">0.436</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.9.9">
<td class="ltx_td ltx_align_left" id="S6.T3.1.9.9.1">ConvTransE</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.9.9.2">0.204</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.9.9.3">0.32</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.9.9.4">0.466</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.9.9.5">432</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.9.9.6">0.29</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.9.9.7">0.255</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.9.9.8">0.322</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.9.9.9">0.383</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.9.9.10">7043</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.9.9.11">0.3</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.10.10">
<td class="ltx_td ltx_align_left" id="S6.T3.1.10.10.1">SACN</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.10.10.2">0.239</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.10.10.3">0.361</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.10.10.4">0.5</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.10.10.5">205</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.10.10.6">0.328</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.10.10.7">0.334</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.10.10.8">0.407</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.10.10.9">0.474</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.10.10.10">6194</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.10.10.11">0.378</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.11.11">
<td class="ltx_td ltx_align_left" id="S6.T3.1.11.11.1">RGAT</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.11.11.2">0.234</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.11.11.3">0.36</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.11.11.4">0.506</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.11.11.5">191</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.11.11.6">0.326</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.11.11.7">0.083</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.11.11.8">0.278</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.11.11.9">0.432</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.11.11.10">4086</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.11.11.11">0.202</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.12.12">
<td class="ltx_td ltx_align_left" id="S6.T3.1.12.12.1">InteractE</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.12.12.2">0.211</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.12.12.3">0.317</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.12.12.4">0.464</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.12.12.5">575</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.12.12.6">0.296</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.12.12.7">0.416</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.12.12.8">0.455</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.12.12.9">0.499</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.12.12.10">5281</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.12.12.11">0.444</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.13.13">
<td class="ltx_td ltx_align_left" id="S6.T3.1.13.13.1">CTKGC</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.13.13.2">0.202</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.13.13.3">0.305</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.13.13.4">0.433</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.13.13.5">742</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.13.13.6">0.278</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.13.13.7">0.423</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.13.13.8">0.464</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.13.13.9">0.506</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.13.13.10">5862</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.13.13.11">0.451</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.14.14">
<td class="ltx_td ltx_align_left" id="S6.T3.1.14.14.1">DisenKGAT</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.14.14.2">0.227</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.14.14.3">0.347</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.14.14.4">0.487</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.14.14.5">242</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.14.14.6">0.314</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.14.14.7">0.379</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.14.14.8">0.441</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.14.14.9">0.498</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.14.14.10">4823</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.14.14.11">0.421</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.15.15">
<td class="ltx_td ltx_align_left" id="S6.T3.1.15.15.1">NoGE</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.15.15.2">0.235</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.15.15.3">0.361</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.15.15.4">0.511</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.15.15.5">218</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.15.15.6">0.326</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.15.15.7">0.067</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.15.15.8">0.36</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.15.15.9">0.47</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.15.15.10">3397</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.15.15.11">0.226</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.16.16">
<td class="ltx_td ltx_align_left" id="S6.T3.1.16.16.1">MRGAT</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.16.16.2">0.24</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.16.16.3">0.356</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.16.16.4">0.501</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.16.16.5"><span class="ltx_text ltx_font_bold" id="S6.T3.1.16.16.5.1">178</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.16.16.6">0.327</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.16.16.7">0.343</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.16.16.8">0.437</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.16.16.9">0.514</td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.16.16.10"><span class="ltx_text ltx_font_bold" id="S6.T3.1.16.16.10.1">2615</span></td>
<td class="ltx_td ltx_align_center" id="S6.T3.1.16.16.11">0.404</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.17.17">
<td class="ltx_td ltx_align_left ltx_border_tt ltx_border_t" id="S6.T3.1.17.17.1">our decoder</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S6.T3.1.17.17.2">0.219</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S6.T3.1.17.17.3">0.331</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S6.T3.1.17.17.4">0.474</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S6.T3.1.17.17.5">296</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S6.T3.1.17.17.6">0.303</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S6.T3.1.17.17.7">0.398</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S6.T3.1.17.17.8">0.443</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S6.T3.1.17.17.9">0.491</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S6.T3.1.17.17.10">5964</td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" id="S6.T3.1.17.17.11">0.43</td>
</tr>
<tr class="ltx_tr" id="S6.T3.1.18.18">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S6.T3.1.18.18.1">GATH</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.18.18.2"><span class="ltx_text ltx_font_bold" id="S6.T3.1.18.18.2.1">0.253</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.18.18.3"><span class="ltx_text ltx_font_bold" id="S6.T3.1.18.18.3.1">0.376</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.18.18.4"><span class="ltx_text ltx_font_bold" id="S6.T3.1.18.18.4.1">0.527</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.18.18.5">192</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.18.18.6"><span class="ltx_text ltx_font_bold" id="S6.T3.1.18.18.6.1">0.344</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.18.18.7"><span class="ltx_text ltx_font_bold" id="S6.T3.1.18.18.7.1">0.426</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.18.18.8"><span class="ltx_text ltx_font_bold" id="S6.T3.1.18.18.8.1">0.475</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.18.18.9"><span class="ltx_text ltx_font_bold" id="S6.T3.1.18.18.9.1">0.537</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.18.18.10">3442</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T3.1.18.18.11"><span class="ltx_text ltx_font_bold" id="S6.T3.1.18.18.11.1">0.463</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2. </span>Ablation study</h3>
<figure class="ltx_table" id="S6.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4. </span>Ablation study. The first line is that the model only uses our decoder for link prediction. The second line is the result of adding an encoder that uses the entity-relation joint attention network. The third line is the complete GATH, with both entity-specific attention network and entity-relation joint attention network added to the encoder.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_t" id="S6.T4.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T4.1.1.1.1.1">Models</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt ltx_border_t" colspan="5" id="S6.T4.1.1.1.2">
<span class="ltx_text ltx_font_bold" id="S6.T4.1.1.1.2.1">FB15K-237</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_border_t" colspan="5" id="S6.T4.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S6.T4.1.1.1.3.1">WN18RR</span></th>
</tr>
<tr class="ltx_tr" id="S6.T4.1.2.2">
<th class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T4.1.2.2.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S6.T4.1.2.2.2">Hits@n</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.2.2.3">MR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S6.T4.1.2.2.4">MRR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S6.T4.1.2.2.5">Hits@n</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.2.2.6">MR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.2.2.7">MRR</th>
</tr>
<tr class="ltx_tr" id="S6.T4.1.3.3">
<th class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T4.1.3.3.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.3.3.2">1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.3.3.3">3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S6.T4.1.3.3.4">10</th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_t" id="S6.T4.1.3.3.5"></th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S6.T4.1.3.3.6"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.3.3.7">1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T4.1.3.3.8">3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S6.T4.1.3.3.9">10</th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_t" id="S6.T4.1.3.3.10"></th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_t" id="S6.T4.1.3.3.11"></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T4.1.4.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S6.T4.1.4.1.1">Decoder-only</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.4.1.2">0.219</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.4.1.3">0.331</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.1.4.1.4">0.474</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.4.1.5">296</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.1.4.1.6">0.303</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.4.1.7">0.398</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.4.1.8">0.443</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.1.4.1.9">0.491</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.4.1.10">5964</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T4.1.4.1.11">0.43</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.5.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T4.1.5.2.1">Entity-relation joint attention network-only</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.5.2.2">0.253</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.5.2.3">0.377</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T4.1.5.2.4">0.524</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.5.2.5">168</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T4.1.5.2.6">0.343</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.5.2.7">0.401</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.5.2.8">0.465</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T4.1.5.2.9">0.52</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.5.2.10">3246</td>
<td class="ltx_td ltx_align_center" id="S6.T4.1.5.2.11">0.445</td>
</tr>
<tr class="ltx_tr" id="S6.T4.1.6.3">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S6.T4.1.6.3.1">GATH</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.6.3.2">0.253</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.6.3.3">0.376</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T4.1.6.3.4">0.527</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.6.3.5">192</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T4.1.6.3.6">0.344</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.6.3.7">0.426</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.6.3.8">0.475</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S6.T4.1.6.3.9">0.537</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.6.3.10">3442</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T4.1.6.3.11">0.463</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.T4" title="Table 4 ‣ 6.2. Ablation study ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">4</span></a> shows the results of our ablation study. Through observation, we find that: (1) The addition of the entity-specific attention network resulted in an increase in most link prediction indicators, which proves the existence of intrinsic interaction features between entities and the effectiveness of the entity-specific attention network. (2) After considering entity-specific attention network, there was a significant improvement in link prediction results on the WN18RR dataset, where Hits@1, Hits@10, and MRR increased by 6.23%, 3%, and 4.04%, respectively. But on the FB15k-237, the increase is small, and even the Hits@3 indicator has decreased. This is because the types and number of relations in WN18RR are small, so the interaction intensity between entities and relations is smaller than that of FB15k-237, and the interaction between entities is highlighted, which finally makes the improvement of link predictors by entity-specific attention networks on WN18RR more obvious.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3. </span>The performance with different sample sizes</h3>
<section class="ltx_paragraph" id="S6.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Performance on different entity sample sizes</h4>
<div class="ltx_para" id="S6.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S6.SS3.SSS0.Px1.p1.1">”Graph degree” refers to the number of edges that a node is connected to in a graph. This concept is widely used in graph theory. Similarly, in KGs, the degree is defined as the number of triples containing a node. The degree of a node is related to its sparsity. A node with a small degree is a sparse node with fewer occurrences in KG. Relatively, a node with a higher degree is a dense node.</p>
</div>
<div class="ltx_para" id="S6.SS3.SSS0.Px1.p2">
<p class="ltx_p" id="S6.SS3.SSS0.Px1.p2.1">Based on the degree of the node, we classify it into Sparse Nodes, Moderate Nodes, and Dense Nodes. Among them, Sparse Nodes is a set of nodes with a degree in the range [0, 100], Moderate Nodes is a set of nodes with a degree in the range (100, 1000], and Dense Nodes is a set of nodes with a degree greater than 1000. We then conduct link prediction tasks on GATH, as well as embedding models: TransE, DistMult, and ConvE, and graph neural network SACN (GCN-based), and MRGAT (GAT-based), which are all classic works or SOTA embedding models in their respective types of models. We report the results in terms of Hits@10 and MRR metrics, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.T5" title="Table 5 ‣ Performance on different entity sample sizes ‣ 6.3. The performance with different sample sizes ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div class="ltx_para" id="S6.SS3.SSS0.Px1.p3">
<p class="ltx_p" id="S6.SS3.SSS0.Px1.p3.1">After studying Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.T5" title="Table 5 ‣ Performance on different entity sample sizes ‣ 6.3. The performance with different sample sizes ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">5</span></a>, we find that: (1) When the degree of nodes increases, the model performance often improves. (2) On Sparse Nodes, GATH exhibits the best performance. Compared with the state-of-the-art model MRGAT based on GAT, we have introduced feature reduction and entity-specific attention network, making our model perform better on nodes with a lower degree, such as Sparse Nodes and Moderate Nodes. On the one hand, this proves the effectiveness of our work. On the other hand, this indicates that GATH has higher robustness against sparse nodes.</p>
</div>
<figure class="ltx_table" id="S6.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5. </span>Link prediction performance on different entity sample sizes</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt ltx_border_t" id="S6.T5.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.1.1">Models</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" colspan="2" id="S6.T5.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.2.1">Sparse Nodes</span></td>
<td class="ltx_td ltx_border_tt ltx_border_t" id="S6.T5.1.1.1.3"></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" colspan="2" id="S6.T5.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.4.1">Moderate Nodes</span></td>
<td class="ltx_td ltx_border_tt ltx_border_t" id="S6.T5.1.1.1.5"></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" colspan="2" id="S6.T5.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S6.T5.1.1.1.6.1">Dense Nodes</span></td>
<td class="ltx_td ltx_border_tt ltx_border_t" id="S6.T5.1.1.1.7"></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.2.2">
<th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.2.2.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.2.2.2">Hits@10</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.2.2.3">MRR</td>
<td class="ltx_td ltx_border_t" id="S6.T5.1.2.2.4"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.2.2.5">Hits@10</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.2.2.6">MRR</td>
<td class="ltx_td ltx_border_t" id="S6.T5.1.2.2.7"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.2.2.8">Hits@10</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T5.1.2.2.9">MRR</td>
<td class="ltx_td ltx_border_t" id="S6.T5.1.2.2.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.3.3.1">TransE</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.3.3.2">0.421</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.3.3.3">0.218</td>
<td class="ltx_td ltx_border_t" id="S6.T5.1.3.3.4"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.3.3.5">0.458</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.3.3.6">0.216</td>
<td class="ltx_td ltx_border_t" id="S6.T5.1.3.3.7"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.3.3.8">0.505</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.3.3.9">0.359</td>
<td class="ltx_td ltx_border_t" id="S6.T5.1.3.3.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.4.4.1">ConvE</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.4.2">0.457</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.4.3">0.289</td>
<td class="ltx_td" id="S6.T5.1.4.4.4"></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.4.5">0.516</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.4.6">0.306</td>
<td class="ltx_td" id="S6.T5.1.4.4.7"></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.4.8">0.526</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.4.9">0.431</td>
<td class="ltx_td" id="S6.T5.1.4.4.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.5.5.1">DistMult</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.5.5.2">0.361</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.5.5.3">0.227</td>
<td class="ltx_td" id="S6.T5.1.5.5.4"></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.5.5.5">0.382</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.5.5.6">0.212</td>
<td class="ltx_td" id="S6.T5.1.5.5.7"></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.5.5.8">0.442</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.5.5.9">0.343</td>
<td class="ltx_td" id="S6.T5.1.5.5.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.6.6.1">SACN</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.6.2">0.457</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.6.3">0.194</td>
<td class="ltx_td" id="S6.T5.1.6.6.4"></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.6.5">0.558</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.6.6">0.222</td>
<td class="ltx_td" id="S6.T5.1.6.6.7"></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.6.8">0.570</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.6.9">0.484</td>
<td class="ltx_td" id="S6.T5.1.6.6.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.7.7.1">MRGAT</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.7.2">0.490</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.7.3">0.318</td>
<td class="ltx_td" id="S6.T5.1.7.7.4"></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.7.5">0.592</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.7.6">0.386</td>
<td class="ltx_td" id="S6.T5.1.7.7.7"></td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.7.8">0.607</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.7.9">0.507</td>
<td class="ltx_td" id="S6.T5.1.7.7.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="S6.T5.1.8.8.1">GATH</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T5.1.8.8.2">0.511</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T5.1.8.8.3">0.334</td>
<td class="ltx_td ltx_border_bb ltx_border_tt" id="S6.T5.1.8.8.4"></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T5.1.8.8.5">0.601</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T5.1.8.8.6">0.397</td>
<td class="ltx_td ltx_border_bb ltx_border_tt" id="S6.T5.1.8.8.7"></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T5.1.8.8.8">0.594</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T5.1.8.8.9">0.505</td>
<td class="ltx_td ltx_border_bb ltx_border_tt" id="S6.T5.1.8.8.10"></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_paragraph" id="S6.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Performance on different relation sample sizes</h4>
<div class="ltx_para" id="S6.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S6.SS3.SSS0.Px2.p1.1">We choose FB15k-237 as the dataset, which has 237 types of relations. We take the number of triples containing a certain relation in the graph as the degree of the relation. Based on the degree of the relation, we classify it into Sparse Relations, Moderate Relations, and Dense Relations. Among them, Sparse Relations is a set of relations with a degree in the range [0, 200], Moderate Relations is a set of relations with a degree in the range (200, 500], and Dense Relations is a set of relations with a degree greater than 500. The comparison results between GATH and several other baselines are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.T6" title="Table 6 ‣ Performance on different relation sample sizes ‣ 6.3. The performance with different sample sizes ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">6</span></a>. For each set of relations, we demonstrate Hits@10 And MRR indicators.</p>
</div>
<div class="ltx_para" id="S6.SS3.SSS0.Px2.p2">
<p class="ltx_p" id="S6.SS3.SSS0.Px2.p2.1">Through studying Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.T6" title="Table 6 ‣ Performance on different relation sample sizes ‣ 6.3. The performance with different sample sizes ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">6</span></a>, we find that: (1) several models in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.T6" title="Table 6 ‣ Performance on different relation sample sizes ‣ 6.3. The performance with different sample sizes ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">6</span></a> include GATH decrease MRR and Hits@10 scores as the degree of the relation increases. (2) Our model achieved optimal performance on all indicators, especially with significant performance improvement in small-degree relations, i.e., Sparse Relations and Moderate Relations. This proves that our strategy of reduced features and weight sharing can effectively model sparse data in KGs.</p>
</div>
<figure class="ltx_table" id="S6.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6. </span>Link prediction performance on different relation sample sizes</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T6.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T6.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt ltx_border_t" id="S6.T6.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.1.1.1">Models</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" colspan="2" id="S6.T6.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.1.2.1">Sparse Relations</span></td>
<td class="ltx_td ltx_border_tt ltx_border_t" id="S6.T6.1.1.1.3"></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" colspan="2" id="S6.T6.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.1.4.1">Moderate Relations</span></td>
<td class="ltx_td ltx_border_tt ltx_border_t" id="S6.T6.1.1.1.5"></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" colspan="2" id="S6.T6.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.1.6.1">Dense Relations</span></td>
<td class="ltx_td ltx_border_tt ltx_border_t" id="S6.T6.1.1.1.7"></td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.2.2">
<th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S6.T6.1.2.2.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.2.2.2">Hits@10</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.2.2.3">MRR</td>
<td class="ltx_td ltx_border_t" id="S6.T6.1.2.2.4"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.2.2.5">Hits@10</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.2.2.6">MRR</td>
<td class="ltx_td ltx_border_t" id="S6.T6.1.2.2.7"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.2.2.8">Hits@10</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T6.1.2.2.9">MRR</td>
<td class="ltx_td ltx_border_t" id="S6.T6.1.2.2.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T6.1.3.3.1">TransE</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.3.3.2">0.585</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.3.3.3">0.379</td>
<td class="ltx_td ltx_border_t" id="S6.T6.1.3.3.4"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.3.3.5">0.542</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.3.3.6">0.346</td>
<td class="ltx_td ltx_border_t" id="S6.T6.1.3.3.7"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.3.3.8">0.407</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.3.3.9">0.199</td>
<td class="ltx_td ltx_border_t" id="S6.T6.1.3.3.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.4.4.1">ConvE</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.4.2">0.639</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.4.3">0.450</td>
<td class="ltx_td" id="S6.T6.1.4.4.4"></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.4.5">0.590</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.4.6">0.404</td>
<td class="ltx_td" id="S6.T6.1.4.4.7"></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.4.8">0.443</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.4.4.9">0.274</td>
<td class="ltx_td" id="S6.T6.1.4.4.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.5.5.1">DistMult</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.5.2">0.505</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.5.3">0.379</td>
<td class="ltx_td" id="S6.T6.1.5.5.4"></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.5.5">0.488</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.5.6">0.326</td>
<td class="ltx_td" id="S6.T6.1.5.5.7"></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.5.8">0.345</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.5.5.9">0.210</td>
<td class="ltx_td" id="S6.T6.1.5.5.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.6.6.1">SACN</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.6.6.2">0.645</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.6.6.3">0.470</td>
<td class="ltx_td" id="S6.T6.1.6.6.4"></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.6.6.5">0.612</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.6.6.6">0.423</td>
<td class="ltx_td" id="S6.T6.1.6.6.7"></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.6.6.8">0.485</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.6.6.9">0.311</td>
<td class="ltx_td" id="S6.T6.1.6.6.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.7.7.1">MRGAT</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.7.7.2">0.632</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.7.7.3">0.461</td>
<td class="ltx_td" id="S6.T6.1.7.7.4"></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.7.7.5">0.596</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.7.7.6">0.406</td>
<td class="ltx_td" id="S6.T6.1.7.7.7"></td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.7.7.8">0.487</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.7.7.9">0.312</td>
<td class="ltx_td" id="S6.T6.1.7.7.10"></td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt" id="S6.T6.1.8.8.1">GATH</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T6.1.8.8.2">0.672</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T6.1.8.8.3">0.503</td>
<td class="ltx_td ltx_border_bb ltx_border_tt" id="S6.T6.1.8.8.4"></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T6.1.8.8.5">0.626</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T6.1.8.8.6">0.438</td>
<td class="ltx_td ltx_border_bb ltx_border_tt" id="S6.T6.1.8.8.7"></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T6.1.8.8.8">0.503</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S6.T6.1.8.8.9">0.325</td>
<td class="ltx_td ltx_border_bb ltx_border_tt" id="S6.T6.1.8.8.10"></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4. </span>Training utilization analysis</h3>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1"><span class="ltx_text" id="S6.SS4.p1.1.1" style="color:#000000;">To compare the training speed and space occupation of the models, we have chosen SACN and MRGAT as the baseline models. SACN is the best-performing GCN-based model in the experiment, and similarly, MRGAT is the optimal GAT-based model. Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.T7" title="Table 7 ‣ 6.4. Training utilization analysis ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">7</span></a> shows the time required for GATH and the baseline models to train one epoch, as well as the size of each encoder layer during training.</span></p>
</div>
<div class="ltx_para" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.1"><span class="ltx_text" id="S6.SS4.p2.1.1" style="color:#000000;">By studying Table <a class="ltx_ref" href="https://arxiv.org/html/2408.02456v1#S6.T7" title="Table 7 ‣ 6.4. Training utilization analysis ‣ 6. Result ‣ Enhancing Heterogeneous Knowledge Graph Completion with a Novel GAT-based Approach"><span class="ltx_text ltx_ref_tag">7</span></a>, we find that: 1) Compared to the GAT-based baseline—MRGAT, GATH performs better in both model occupation and training time. This indicates the effectiveness of our improvements to the current GAT-based models. We use embedding vectors instead of matrices to represent relations, significantly reducing model occupation and improving training efficiency. 2) SACN uses static weights to represent relations. Although it uses fewer training resources, its performance in link prediction is much lower compared to MRGAT and GATH.</span></p>
</div>
<figure class="ltx_table" id="S6.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7. </span>Link prediction utilization on FB15K-237 and WN18RR</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T7.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T7.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt ltx_border_t" id="S6.T7.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T7.1.1.1.1.1">Models</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" colspan="2" id="S6.T7.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S6.T7.1.1.1.2.1">Time(s/epoch)</span></td>
<td class="ltx_td ltx_border_tt ltx_border_t" id="S6.T7.1.1.1.3"></td>
<td class="ltx_td ltx_align_center ltx_border_tt ltx_border_t" colspan="2" id="S6.T7.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S6.T7.1.1.1.4.1">Space(GB/Encoder)</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.1.2.2">
<th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S6.T7.1.2.2.1"></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T7.1.2.2.2">FB15K-237</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T7.1.2.2.3">WN18RR</td>
<td class="ltx_td ltx_border_t" id="S6.T7.1.2.2.4"></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T7.1.2.2.5">FB15K-237</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T7.1.2.2.6">WN18RR</td>
</tr>
<tr class="ltx_tr" id="S6.T7.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T7.1.3.3.1">SACN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.3.3.2">46</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.3.3.3">54</td>
<td class="ltx_td ltx_border_t" id="S6.T7.1.3.3.4"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.3.3.5">0.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.3.3.6">0.2</td>
</tr>
<tr class="ltx_tr" id="S6.T7.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T7.1.4.4.1">MRGAT</th>
<td class="ltx_td ltx_align_center" id="S6.T7.1.4.4.2">375</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.4.4.3">131</td>
<td class="ltx_td" id="S6.T7.1.4.4.4"></td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.4.4.5">20</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.4.4.6">8.5</td>
</tr>
<tr class="ltx_tr" id="S6.T7.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_tt ltx_border_t" id="S6.T7.1.5.5.1">GATH</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt ltx_border_t" id="S6.T7.1.5.5.2">260</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt ltx_border_t" id="S6.T7.1.5.5.3">97</td>
<td class="ltx_td ltx_border_bb ltx_border_tt ltx_border_t" id="S6.T7.1.5.5.4"></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt ltx_border_t" id="S6.T7.1.5.5.5">9.8</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt ltx_border_t" id="S6.T7.1.5.5.6">3.4</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7. </span>Conclusion and future work</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">We first point out that current knowledge graph completion models cannot maintain good performance when modeling sparse data in heterogeneous KG. Afterward, they struggle when the same head (tail) entity and relation are connected to multiple different tail (head) entities in heterogeneous KGs. To address these issues, we propose a graph attention network called GATH. On the one hand, GATH reduces the impact of sparsity on model performance by reducing features and weight sharing. On the other hand, we consider the intrinsic interactions of entities within the entity feature space to select more important neighbors.
We conduct a comprehensive evaluation of GATH and achieve SOTA performance. We also test Gath with MindSpore and get similar results.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">In the next step, we hope to overcome the over-smoothing problem of the graph neural network that has been planted. And we hope to extend the model to the complex number space to obtain further performance improvements.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
This work was supported by the National Key Research and Development Program of China 2020YFB1710200, the NSFC 61832017, and the CAAI-Huawei MindSpore Open Fund.

</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bordes et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
Antoine Bordes, Nicolas
Usunier, Alberto Garcia-Duran, Jason
Weston, and Oksana Yakhnenko.
2013.

</span>
<span class="ltx_bibblock">Translating embeddings for modeling
multi-relational data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">NeurIPS</em> 26
(2013).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Busbridge et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Dan Busbridge, Dane
Sherburn, Pietro Cavallo, and Nils Y
Hammerla. 2019.

</span>
<span class="ltx_bibblock">Relational graph attention networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">arXiv preprint arXiv:1904.05811</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Guoquan Dai, Xizhao Wang,
Xiaoying Zou, Chao Liu, and
Si Cen. 2022.

</span>
<span class="ltx_bibblock">MRGAT: multi-relational graph attention network for
knowledge graph completion.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Neural Networks</em> 154
(2022), 234–245.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Tim Dettmers, Pasquale
Minervini, Pontus Stenetorp, and
Sebastian Riedel. 2018.

</span>
<span class="ltx_bibblock">Convolutional 2d knowledge graph embeddings. In
<em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">AAAI</em>, Vol. 32.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei
Chang, Kenton Lee, and Kristina
Toutanova. 2018.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional
transformers for language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">arXiv preprint arXiv:1810.04805</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Do and Phan (2022)</span>
<span class="ltx_bibblock">
Phuc Do and Truong HV
Phan. 2022.

</span>
<span class="ltx_bibblock">Developing a BERT based triple classification model
using knowledge graph embedding for question answering system.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">APIN</em> 52,
1 (2022), 636–651.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jianzhou Feng, Qikai Wei,
Jinman Cui, and Jing Chen.
2021.

</span>
<span class="ltx_bibblock">Novel translation knowledge graph completion model
based on 2D convolution.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Applied Intelligence</em>
(2021), 1–10.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu
Zhang, Shaoqing Ren, and Jian Sun.
2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition. In
<em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">CVPR</em>. 770–778.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiao Huang, Jingyuan
Zhang, Dingcheng Li, and Ping Li.
2019.

</span>
<span class="ltx_bibblock">Knowledge graph embedding based question
answering. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">WSDM</em>. 105–113.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hui et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Bei Hui, Lizong Zhang,
Xue Zhou, Xiao Wen, and
Yuhui Nian. 2022.

</span>
<span class="ltx_bibblock">Personalized recommendation system based on
knowledge embedding and historical behavior.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">APIN</em> (2022),
1–13.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ioffe and Szegedy (2015)</span>
<span class="ltx_bibblock">
Sergey Ioffe and
Christian Szegedy. 2015.

</span>
<span class="ltx_bibblock">Batch normalization: Accelerating deep network
training by reducing internal covariate shift. In
<em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">ICML</em>. pmlr, 448–456.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Guoliang Ji, Shizhu He,
Liheng Xu, Kang Liu, and
Jun Zhao. 2015.

</span>
<span class="ltx_bibblock">Knowledge graph embedding via dynamic mapping
matrix. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">ACL</em>. 687–696.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Dan Jiang, Ronggui Wang,
Juan Yang, and Lixia Xue.
2021.

</span>
<span class="ltx_bibblock">Kernel multi-attention neural network for knowledge
graph embedding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Knowledge-Based Systems</em>
227 (2021), 107188.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhifei Li, Hai Liu,
Zhaoli Zhang, Tingting Liu, and
Neal N Xiong. 2021.

</span>
<span class="ltx_bibblock">Learning knowledge graph embedding with
heterogeneous relation attention networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">IEEE TNNLS</em> 33,
8 (2021), 3961–3973.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Yankai Lin, Zhiyuan Liu,
Maosong Sun, Yang Liu, and
Xuan Zhu. 2015.

</span>
<span class="ltx_bibblock">Learning entity and relation embeddings for
knowledge graph completion. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">AAAI</em>,
Vol. 29.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2017)</span>
<span class="ltx_bibblock">
Ilya Loshchilov and
Frank Hutter. 2017.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:1711.05101</em>
(2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mikolov et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
Tomas Mikolov, Ilya
Sutskever, Kai Chen, Greg S Corrado,
and Jeff Dean. 2013.

</span>
<span class="ltx_bibblock">Distributed representations of words and phrases
and their compositionality.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">NeurIPS</em> 26
(2013).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Dai Quoc Nguyen, Vinh
Tong, Dinh Phung, and Dat Quoc
Nguyen. 2022.

</span>
<span class="ltx_bibblock">Node Co-occurrence based Graph Neural Networks for
Knowledge Graph Link Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">WSDM</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nickel et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Maximilian Nickel, Volker
Tresp, Hans-Peter Kriegel, et al<span class="ltx_text" id="bib.bib20.3.1">.</span>
2011.

</span>
<span class="ltx_bibblock">A three-way model for collective learning on
multi-relational data.. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.4.1">Icml</em>,
Vol. 11. 3104482–3104584.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Alec Radford, Karthik
Narasimhan, Tim Salimans, Ilya
Sutskever, et al<span class="ltx_text" id="bib.bib21.3.1">.</span> 2018.

</span>
<span class="ltx_bibblock">Improving language understanding by generative
pre-training.

</span>
<span class="ltx_bibblock">(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schlichtkrull et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Michael Schlichtkrull,
Thomas N Kipf, Peter Bloem,
Rianne Van Den Berg, Ivan Titov, and
Max Welling. 2018.

</span>
<span class="ltx_bibblock">Modeling relational data with graph convolutional
networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">ESWC</em>. Springer,
593–607.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shang et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Chao Shang, Yun Tang,
Jing Huang, Jinbo Bi,
Xiaodong He, and Bowen Zhou.
2019.

</span>
<span class="ltx_bibblock">End-to-end structure-aware convolutional networks
for knowledge base completion. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">AAAI</em>,
Vol. 33. 3060–3067.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Nitish Srivastava,
Geoffrey Hinton, Alex Krizhevsky,
Ilya Sutskever, and Ruslan
Salakhutdinov. 2014.

</span>
<span class="ltx_bibblock">Dropout: a simple way to prevent neural networks
from overfitting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">The journal of machine learning research</em>
15, 1 (2014),
1929–1958.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Zhiqing Sun, Zhi-Hong
Deng, Jian-Yun Nie, and Jian Tang.
2019.

</span>
<span class="ltx_bibblock">Rotate: Knowledge graph embedding by relational
rotation in complex space.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">arXiv preprint arXiv:1902.10197</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Toutanova and Chen (2015)</span>
<span class="ltx_bibblock">
Kristina Toutanova and
Danqi Chen. 2015.

</span>
<span class="ltx_bibblock">Observed versus latent features for knowledge base
and text inference. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">CVSC</em>.
57–66.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Trouillon et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Théo Trouillon,
Johannes Welbl, Sebastian Riedel,
Éric Gaussier, and Guillaume
Bouchard. 2016.

</span>
<span class="ltx_bibblock">Complex embeddings for simple link prediction. In
<em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">ICML</em>. PMLR, 2071–2080.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vashishth et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Shikhar Vashishth, Soumya
Sanyal, Vikram Nitin, Nilesh Agrawal,
and Partha Talukdar. 2020.

</span>
<span class="ltx_bibblock">InteractE: Improving Convolution-based Knowledge
Graph Embeddings by Increasing Feature Interactions. In
<em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">AAAI</em>. AAAI Press,
3009–3016.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aaai.org/ojs/index.php/AAAI/article/view/5694" title="">https://aaai.org/ojs/index.php/AAAI/article/view/5694</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vashishth et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shikhar Vashishth, Soumya
Sanyal, Vikram Nitin, and Partha
Talukdar. 2019.

</span>
<span class="ltx_bibblock">Composition-based multi-relational graph
convolutional networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">arXiv preprint arXiv:1911.03082</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam
Shazeer, Niki Parmar, Jakob Uszkoreit,
Llion Jones, Aidan N Gomez,
Łukasz Kaiser, and Illia
Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">NeurIPS</em> 30
(2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Veličković et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Petar Veličković,
Guillem Cucurull, Arantxa Casanova,
Adriana Romero, Pietro Lio, and
Yoshua Bengio. 2017.

</span>
<span class="ltx_bibblock">Graph attention networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">arXiv preprint arXiv:1710.10903</em>
(2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Xintao Wang, Qianyu He,
Jiaqing Liang, and Yanghua Xiao.
2022.

</span>
<span class="ltx_bibblock">Language Models as Knowledge Embeddings.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">arXiv preprint arXiv:2206.12617</em>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiang Wang, Xiangnan He,
Yixin Cao, Meng Liu, and
Tat-Seng Chua. 2019.

</span>
<span class="ltx_bibblock">Kgat: Knowledge graph attention network for
recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">KDD</em>.
950–958.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiang Wang, Tinglin
Huang, Dingxian Wang, Yancheng Yuan,
Zhenguang Liu, Xiangnan He, and
Tat-Seng Chua. 2021.

</span>
<span class="ltx_bibblock">Learning intents behind interactions with knowledge
graph for recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">WWW</em>.
878–887.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Zhen Wang, Jianwen Zhang,
Jianlin Feng, and Zheng Chen.
2014.

</span>
<span class="ltx_bibblock">Knowledge graph embedding by translating on
hyperplanes. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">AAAI</em>, Vol. 28.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Junkang Wu, Wentao Shi,
Xuezhi Cao, Jiawei Chen,
Wenqiang Lei, Fuzheng Zhang,
Wei Wu, and Xiangnan He.
2021.

</span>
<span class="ltx_bibblock">DisenKGAT: Knowledge graph embedding with
disentangled graph attention network. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">CIKM</em>.
2140–2149.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Bishan Yang, Wen-tau Yih,
Xiaodong He, Jianfeng Gao, and
Li Deng. 2014.

</span>
<span class="ltx_bibblock">Embedding entities and relations for learning and
inference in knowledge bases.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">arXiv preprint arXiv:1412.6575</em>
(2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Liang Yao, Chengsheng
Mao, and Yuan Luo. 2019.

</span>
<span class="ltx_bibblock">KG-BERT: BERT for knowledge graph completion.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">arXiv preprint arXiv:1909.03193</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yasunaga et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Michihiro Yasunaga, Hongyu
Ren, Antoine Bosselut, Percy Liang,
and Jure Leskovec. 2021.

</span>
<span class="ltx_bibblock">QA-GNN: Reasoning with language models and
knowledge graphs for question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">arXiv preprint arXiv:2104.06378</em>
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Chiyuan Zhang, Samy
Bengio, Moritz Hardt, Benjamin Recht,
and Oriol Vinyals. 2021.

</span>
<span class="ltx_bibblock">Understanding deep learning (still) requires
rethinking generalization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Commun. ACM</em> 64,
3 (2021), 107–115.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Aug  5 13:16:13 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
