<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Towards Scalable Semantic Representation for Recommendation</title>
<!--Generated on Sat Oct 12 15:10:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.09560v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S1" title="In Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S2" title="In Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3" title="In Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>On the Scaling of Semantic Representation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.SS1" title="In 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Limination of a Single Code</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.SS2" title="In 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Baseline approaches to Scalable Semantic Representation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.SS3" title="In 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Measurement on Scalability of Semantic Representation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S4" title="In Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S4.SS1" title="In 4 Method ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Multi Codebooks for vector quantization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S4.SS2" title="In 4 Method ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Mixture-of-Codes for Implicit Fusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S4.SS3" title="In 4 Method ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>In-depth Scalability Analysis of MoC</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5" title="In Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.SS1" title="In 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.SS2" title="In 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Overall Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.SS3" title="In 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Correlation between Multiple Representation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.SS4" title="In 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>More comparison Results with RQ-VAE</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.SS5" title="In 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Ablation on MoC Fusion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S6" title="In Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S7" title="In Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Towards Scalable Semantic Representation for Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Taolin Zhang, Junwei Pan<sup class="ltx_sup" id="id1.1.id1">§</sup>, Jinpeng Wang, Yaohua Zha, Tao Dai, Bin Chen, Ruisheng Luo, 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id2.2.id2">Xiaoxiang Deng<sup class="ltx_sup" id="id2.2.id2.1">§</sup>, Yuan Wang<sup class="ltx_sup" id="id2.2.id2.2">§</sup>, Ming Yue<sup class="ltx_sup" id="id2.2.id2.3">§</sup>, Jie Jiang<sup class="ltx_sup" id="id2.2.id2.4">§</sup>, Shu-Tao Xia</span>
<br class="ltx_break"/>Tsinghua University, China
<br class="ltx_break"/><sup class="ltx_sup" id="id3.3.id3">§</sup>Tencent Inc, China
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id4.4.id4">jonaspan@tencent.com,</span> <span class="ltx_text ltx_font_typewriter" id="id5.5.id5">{ztl23
xiast}@mails.tsinghua.edu.cn</span>
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id6.id1">With recent advances in large language models (LLMs), there has been emerging numbers of research in developing Semantic IDs based on LLMs to enhance the performance of recommendation systems.
However, the dimension of these embeddings needs to match that of the ID embedding in recommendation, which is usually much smaller than the original length.
Such dimension compression results in inevitable losses in discriminability and dimension robustness of the LLM embeddings, which motivates us to scale up the semantic representation.
In this paper, we propose Mixture-of-Codes, which first constructs multiple independent codebooks for LLM representation in the <em class="ltx_emph ltx_font_italic" id="id6.id1.1">indexing stage</em>, and then utilizes the Semantic Representation along with a fusion module for the downstream <em class="ltx_emph ltx_font_italic" id="id6.id1.2">recommendation stage</em>.
Extensive analysis and experiments demonstrate that our method achieves superior discriminability and dimension robustness scalability, leading to the best scale-up performance in recommendations.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recently, the emergence of large language models (LLM) <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib5" title="">2024</a>; Achiam et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib1" title="">2023</a>)</cite> sheds light in improving the recommendation systems via the semantic knowledge from LLM <cite class="ltx_cite ltx_citemacro_citep">(Hou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib10" title="">2024</a>; Bao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib2" title="">2023</a>)</cite>.
An intuitive practice is to simply project the LLM embeddings to low-dimension embeddings via only MLPs into the recommendation systems for feature interactions. However, such application
is ineffective, largely due to the massive semantic gap between the embedding spaces of LLM and recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib15" title="">2023</a>; Pan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib17" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Several works <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib19" title="">2024</a>; Singh et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib21" title="">2023</a>)</cite> have proposed to derive Semantic IDs (<em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">i.e.</em>, codes) based on clustering methods such as VQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Van Den Oord et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib24" title="">2017</a>)</cite> or RQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib14" title="">2022</a>)</cite> to capture information from the LLM embedding. In particular, they first train an auto-encoder with discrete codes and then apply these codes to downstream tasks such as retrieval or ranking. Such methods aim to transfer knowledge from the LLM embedding space to recommendation systems, utilizing the codes to capture the local structure of the original space. Besides, embedding these codes in the downstream stage facilitates the effective training in an end-to-end manner.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Notably, the LLM embeddings usually have very large dimensions, ranging from 4,096 to 16,384 <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib5" title="">2024</a>)</cite>.
When generating the embeddings for these codes, their dimension needs to match that of the recommendation IDs.
However, the dimension in recommendation is usually small due to the <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">Interaction Collapse Theory</em> <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib8" title="">2023</a>)</cite>.
Therefore, the code embeddings are also only able to span a low-dimension space.
With one single semantic embedding as the semantic representation, it may fail to capture the complex, high-dimensional structure of the original LLM embeddings, <em class="ltx_emph ltx_font_italic" id="S1.p3.1.2">lead to inevitable information loss and performance deterioration</em> during the knowledge transfer.
This motivates us to study how to <em class="ltx_emph ltx_font_italic" id="S1.p3.1.3">scale up the semantic representation effectively</em>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">We delve into two approaches based on existing works, including Multi-Embedding <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib8" title="">2023</a>)</cite> and RQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib14" title="">2022</a>)</cite>, to scale up the semantic representation by either using one codebook with multiple embeddings, or multiple hierarchical codebooks and embeddings.
Nevertheless, the analysis and empirical results demonstrate that the representations of these two methods are not scalable in terms of discriminability and dimension robustness.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In this paper, we propose Mixture-of-Codes (MoC), a novel two-stage approach to effectively scale up semantic representations for recommendation.
First, we propose a Multi-Codebooks VQ-VAE method that learns multiple independent discrete codebooks in the indexing stage.
Once we have these codes for all items, we adopt a Mixture-of-Codes module to fuse the learnable embeddings of multiple codes in the downstream recommendation stage.
We use the name MoC to refer both the second stage itself, as well as the whole two-stage approach.
Comprehensive analysis shows that our method successfully achieves scalability regarding discriminability, dimension robustness, and performance.
Our contributions can be summarized as follows:</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We pioneer a study on the scalability of semantic representation on transferring knowledge from LLM to recommendation systems, and reveal that several baseline approaches fail to scale up effectively.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose a novel two-stage Mixture-of-Codes approach, which learns multiple codebooks in the indexing stage based on LLM embeddings and then employs a Mixture-of-Codes module to fuse the embeddings of multiple codes in the downstream recommendation stage.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Comprehensive experiments on three public datasets show that our method successfully achieves scalability regarding both discriminability, dimension robustness, and performance.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.8"><span class="ltx_text ltx_font_bold" id="S2.p1.8.1">VQ-VAE.</span>
VQ-VAE first encodes the input <math alttext="x" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_x</annotation></semantics></math> with an encoder <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">caligraphic_E</annotation></semantics></math> and then train a codebook to transform embedding into discrete tokens.
Formally, a codebook <math alttext="\mathcal{Z}=\{z_{k}\}_{k=1}^{K}" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mrow id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">𝒵</mi><mo id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml">=</mo><msubsup id="S2.p1.3.m3.1.1.1" xref="S2.p1.3.m3.1.1.1.cmml"><mrow id="S2.p1.3.m3.1.1.1.1.1.1" xref="S2.p1.3.m3.1.1.1.1.1.2.cmml"><mo id="S2.p1.3.m3.1.1.1.1.1.1.2" stretchy="false" xref="S2.p1.3.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S2.p1.3.m3.1.1.1.1.1.1.1" xref="S2.p1.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S2.p1.3.m3.1.1.1.1.1.1.1.2" xref="S2.p1.3.m3.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S2.p1.3.m3.1.1.1.1.1.1.1.3" xref="S2.p1.3.m3.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S2.p1.3.m3.1.1.1.1.1.1.3" stretchy="false" xref="S2.p1.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.3.m3.1.1.1.1.3" xref="S2.p1.3.m3.1.1.1.1.3.cmml"><mi id="S2.p1.3.m3.1.1.1.1.3.2" xref="S2.p1.3.m3.1.1.1.1.3.2.cmml">k</mi><mo id="S2.p1.3.m3.1.1.1.1.3.1" xref="S2.p1.3.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S2.p1.3.m3.1.1.1.1.3.3" xref="S2.p1.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p1.3.m3.1.1.1.3" xref="S2.p1.3.m3.1.1.1.3.cmml">K</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><eq id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2"></eq><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝒵</ci><apply id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.2.cmml" xref="S2.p1.3.m3.1.1.1">superscript</csymbol><apply id="S2.p1.3.m3.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.1.2.cmml" xref="S2.p1.3.m3.1.1.1">subscript</csymbol><set id="S2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1"><apply id="S2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S2.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S2.p1.3.m3.1.1.1.1.3.cmml" xref="S2.p1.3.m3.1.1.1.1.3"><eq id="S2.p1.3.m3.1.1.1.1.3.1.cmml" xref="S2.p1.3.m3.1.1.1.1.3.1"></eq><ci id="S2.p1.3.m3.1.1.1.1.3.2.cmml" xref="S2.p1.3.m3.1.1.1.1.3.2">𝑘</ci><cn id="S2.p1.3.m3.1.1.1.1.3.3.cmml" type="integer" xref="S2.p1.3.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p1.3.m3.1.1.1.3.cmml" xref="S2.p1.3.m3.1.1.1.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">\mathcal{Z}=\{z_{k}\}_{k=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">caligraphic_Z = { italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math> is define as a finite set with prototype vectors <math alttext="z_{k}\in\mathbb{R}^{n_{z}}" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><mrow id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><msub id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml"><mi id="S2.p1.4.m4.1.1.2.2" xref="S2.p1.4.m4.1.1.2.2.cmml">z</mi><mi id="S2.p1.4.m4.1.1.2.3" xref="S2.p1.4.m4.1.1.2.3.cmml">k</mi></msub><mo id="S2.p1.4.m4.1.1.1" xref="S2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml"><mi id="S2.p1.4.m4.1.1.3.2" xref="S2.p1.4.m4.1.1.3.2.cmml">ℝ</mi><msub id="S2.p1.4.m4.1.1.3.3" xref="S2.p1.4.m4.1.1.3.3.cmml"><mi id="S2.p1.4.m4.1.1.3.3.2" xref="S2.p1.4.m4.1.1.3.3.2.cmml">n</mi><mi id="S2.p1.4.m4.1.1.3.3.3" xref="S2.p1.4.m4.1.1.3.3.3.cmml">z</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><in id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1"></in><apply id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.2.1.cmml" xref="S2.p1.4.m4.1.1.2">subscript</csymbol><ci id="S2.p1.4.m4.1.1.2.2.cmml" xref="S2.p1.4.m4.1.1.2.2">𝑧</ci><ci id="S2.p1.4.m4.1.1.2.3.cmml" xref="S2.p1.4.m4.1.1.2.3">𝑘</ci></apply><apply id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.3.1.cmml" xref="S2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S2.p1.4.m4.1.1.3.2.cmml" xref="S2.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S2.p1.4.m4.1.1.3.3.cmml" xref="S2.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S2.p1.4.m4.1.1.3.3.1.cmml" xref="S2.p1.4.m4.1.1.3.3">subscript</csymbol><ci id="S2.p1.4.m4.1.1.3.3.2.cmml" xref="S2.p1.4.m4.1.1.3.3.2">𝑛</ci><ci id="S2.p1.4.m4.1.1.3.3.3.cmml" xref="S2.p1.4.m4.1.1.3.3.3">𝑧</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">z_{k}\in\mathbb{R}^{n_{z}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="K" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">italic_K</annotation></semantics></math> is the codebook size and <math alttext="n_{z}" class="ltx_Math" display="inline" id="S2.p1.6.m6.1"><semantics id="S2.p1.6.m6.1a"><msub id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">n</mi><mi id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2">𝑛</ci><ci id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">n_{z}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">italic_n start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> is the dimensionality of code embeddings.
Given the encoder output <math alttext="\mathbf{z}:=\mathcal{E}(x)\in\mathbb{R}^{n_{z}}" class="ltx_Math" display="inline" id="S2.p1.7.m7.1"><semantics id="S2.p1.7.m7.1a"><mrow id="S2.p1.7.m7.1.2" xref="S2.p1.7.m7.1.2.cmml"><mi id="S2.p1.7.m7.1.2.2" xref="S2.p1.7.m7.1.2.2.cmml">𝐳</mi><mo id="S2.p1.7.m7.1.2.3" lspace="0.278em" rspace="0.278em" xref="S2.p1.7.m7.1.2.3.cmml">:=</mo><mrow id="S2.p1.7.m7.1.2.4" xref="S2.p1.7.m7.1.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.7.m7.1.2.4.2" xref="S2.p1.7.m7.1.2.4.2.cmml">ℰ</mi><mo id="S2.p1.7.m7.1.2.4.1" xref="S2.p1.7.m7.1.2.4.1.cmml">⁢</mo><mrow id="S2.p1.7.m7.1.2.4.3.2" xref="S2.p1.7.m7.1.2.4.cmml"><mo id="S2.p1.7.m7.1.2.4.3.2.1" stretchy="false" xref="S2.p1.7.m7.1.2.4.cmml">(</mo><mi id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml">x</mi><mo id="S2.p1.7.m7.1.2.4.3.2.2" stretchy="false" xref="S2.p1.7.m7.1.2.4.cmml">)</mo></mrow></mrow><mo id="S2.p1.7.m7.1.2.5" xref="S2.p1.7.m7.1.2.5.cmml">∈</mo><msup id="S2.p1.7.m7.1.2.6" xref="S2.p1.7.m7.1.2.6.cmml"><mi id="S2.p1.7.m7.1.2.6.2" xref="S2.p1.7.m7.1.2.6.2.cmml">ℝ</mi><msub id="S2.p1.7.m7.1.2.6.3" xref="S2.p1.7.m7.1.2.6.3.cmml"><mi id="S2.p1.7.m7.1.2.6.3.2" xref="S2.p1.7.m7.1.2.6.3.2.cmml">n</mi><mi id="S2.p1.7.m7.1.2.6.3.3" xref="S2.p1.7.m7.1.2.6.3.3.cmml">z</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.2.cmml" xref="S2.p1.7.m7.1.2"><and id="S2.p1.7.m7.1.2a.cmml" xref="S2.p1.7.m7.1.2"></and><apply id="S2.p1.7.m7.1.2b.cmml" xref="S2.p1.7.m7.1.2"><csymbol cd="latexml" id="S2.p1.7.m7.1.2.3.cmml" xref="S2.p1.7.m7.1.2.3">assign</csymbol><ci id="S2.p1.7.m7.1.2.2.cmml" xref="S2.p1.7.m7.1.2.2">𝐳</ci><apply id="S2.p1.7.m7.1.2.4.cmml" xref="S2.p1.7.m7.1.2.4"><times id="S2.p1.7.m7.1.2.4.1.cmml" xref="S2.p1.7.m7.1.2.4.1"></times><ci id="S2.p1.7.m7.1.2.4.2.cmml" xref="S2.p1.7.m7.1.2.4.2">ℰ</ci><ci id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1">𝑥</ci></apply></apply><apply id="S2.p1.7.m7.1.2c.cmml" xref="S2.p1.7.m7.1.2"><in id="S2.p1.7.m7.1.2.5.cmml" xref="S2.p1.7.m7.1.2.5"></in><share href="https://arxiv.org/html/2410.09560v1#S2.p1.7.m7.1.2.4.cmml" id="S2.p1.7.m7.1.2d.cmml" xref="S2.p1.7.m7.1.2"></share><apply id="S2.p1.7.m7.1.2.6.cmml" xref="S2.p1.7.m7.1.2.6"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.2.6.1.cmml" xref="S2.p1.7.m7.1.2.6">superscript</csymbol><ci id="S2.p1.7.m7.1.2.6.2.cmml" xref="S2.p1.7.m7.1.2.6.2">ℝ</ci><apply id="S2.p1.7.m7.1.2.6.3.cmml" xref="S2.p1.7.m7.1.2.6.3"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.2.6.3.1.cmml" xref="S2.p1.7.m7.1.2.6.3">subscript</csymbol><ci id="S2.p1.7.m7.1.2.6.3.2.cmml" xref="S2.p1.7.m7.1.2.6.3.2">𝑛</ci><ci id="S2.p1.7.m7.1.2.6.3.3.cmml" xref="S2.p1.7.m7.1.2.6.3.3">𝑧</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">\mathbf{z}:=\mathcal{E}(x)\in\mathbb{R}^{n_{z}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m7.1d">bold_z := caligraphic_E ( italic_x ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, VQ-VAE quantities the embedding with the code whose embedding is nearest to <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="S2.p1.8.m8.1"><semantics id="S2.p1.8.m8.1a"><mi id="S2.p1.8.m8.1.1" xref="S2.p1.8.m8.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><ci id="S2.p1.8.m8.1.1.cmml" xref="S2.p1.8.m8.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.8.m8.1d">bold_z</annotation></semantics></math>, that is,</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}^{\mathbf{q}}=\operatorname*{\arg\min}_{z_{k}\in Z}\|\mathbf{z}-z_{k%
}\|_{2}^{2}." class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><msup id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S2.E1.m1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.3.3.cmml">𝐪</mi></msup><mo id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><munder id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.2.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2.2.1" xref="S2.E1.m1.1.1.1.1.1.2.2.1.cmml">arg</mi><mo id="S2.E1.m1.1.1.1.1.1.2.2a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.1.2.2.cmml">⁡</mo><mi id="S2.E1.m1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.1.1.1.1.1.2.2.2.cmml">min</mi></mrow><mrow id="S2.E1.m1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.2.3.cmml"><msub id="S2.E1.m1.1.1.1.1.1.2.3.2" xref="S2.E1.m1.1.1.1.1.1.2.3.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2.3.2.2" xref="S2.E1.m1.1.1.1.1.1.2.3.2.2.cmml">z</mi><mi id="S2.E1.m1.1.1.1.1.1.2.3.2.3" xref="S2.E1.m1.1.1.1.1.1.2.3.2.3.cmml">k</mi></msub><mo id="S2.E1.m1.1.1.1.1.1.2.3.1" xref="S2.E1.m1.1.1.1.1.1.2.3.1.cmml">∈</mo><mi id="S2.E1.m1.1.1.1.1.1.2.3.3" xref="S2.E1.m1.1.1.1.1.1.2.3.3.cmml">Z</mi></mrow></munder><mo id="S2.E1.m1.1.1.1.1.1a" xref="S2.E1.m1.1.1.1.1.1.cmml">⁡</mo><msubsup id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">z</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E1.m1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" lspace="0em" xref="S2.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"></eq><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2">𝐳</ci><ci id="S2.E1.m1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.3">𝐪</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><apply id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2">subscript</csymbol><apply id="S2.E1.m1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2"><arg id="S2.E1.m1.1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2.1"></arg><min id="S2.E1.m1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2.2"></min></apply><apply id="S2.E1.m1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3"><in id="S2.E1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3.1"></in><apply id="S2.E1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.2.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.2.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3.2.2">𝑧</ci><ci id="S2.E1.m1.1.1.1.1.1.2.3.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3.2.3">𝑘</ci></apply><ci id="S2.E1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3.3">𝑍</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1"><minus id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑧</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><cn id="S2.E1.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.1.1.1.3">2</cn></apply><cn id="S2.E1.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\mathbf{z}^{\mathbf{q}}=\operatorname*{\arg\min}_{z_{k}\in Z}\|\mathbf{z}-z_{k%
}\|_{2}^{2}.</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">bold_z start_POSTSUPERSCRIPT bold_q end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ italic_Z end_POSTSUBSCRIPT ∥ bold_z - italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.3">Then the reconstruction is derived based on the quantized output <math alttext="\mathbf{z}_{\mathbf{q}}" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><msub id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">𝐳</mi><mi id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml">𝐪</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.1.cmml" xref="S2.p3.1.m1.1.1">subscript</csymbol><ci id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.2">𝐳</ci><ci id="S2.p3.1.m1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.3">𝐪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\mathbf{z}_{\mathbf{q}}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">bold_z start_POSTSUBSCRIPT bold_q end_POSTSUBSCRIPT</annotation></semantics></math> and a decoder <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">caligraphic_D</annotation></semantics></math>: <math alttext="\hat{x}=\mathcal{D}(\mathbf{z}_{\mathbf{q}})" class="ltx_Math" display="inline" id="S2.p3.3.m3.1"><semantics id="S2.p3.3.m3.1a"><mrow id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml"><mover accent="true" id="S2.p3.3.m3.1.1.3" xref="S2.p3.3.m3.1.1.3.cmml"><mi id="S2.p3.3.m3.1.1.3.2" xref="S2.p3.3.m3.1.1.3.2.cmml">x</mi><mo id="S2.p3.3.m3.1.1.3.1" xref="S2.p3.3.m3.1.1.3.1.cmml">^</mo></mover><mo id="S2.p3.3.m3.1.1.2" xref="S2.p3.3.m3.1.1.2.cmml">=</mo><mrow id="S2.p3.3.m3.1.1.1" xref="S2.p3.3.m3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p3.3.m3.1.1.1.3" xref="S2.p3.3.m3.1.1.1.3.cmml">𝒟</mi><mo id="S2.p3.3.m3.1.1.1.2" xref="S2.p3.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S2.p3.3.m3.1.1.1.1.1" xref="S2.p3.3.m3.1.1.1.1.1.1.cmml"><mo id="S2.p3.3.m3.1.1.1.1.1.2" stretchy="false" xref="S2.p3.3.m3.1.1.1.1.1.1.cmml">(</mo><msub id="S2.p3.3.m3.1.1.1.1.1.1" xref="S2.p3.3.m3.1.1.1.1.1.1.cmml"><mi id="S2.p3.3.m3.1.1.1.1.1.1.2" xref="S2.p3.3.m3.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S2.p3.3.m3.1.1.1.1.1.1.3" xref="S2.p3.3.m3.1.1.1.1.1.1.3.cmml">𝐪</mi></msub><mo id="S2.p3.3.m3.1.1.1.1.1.3" stretchy="false" xref="S2.p3.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1"><eq id="S2.p3.3.m3.1.1.2.cmml" xref="S2.p3.3.m3.1.1.2"></eq><apply id="S2.p3.3.m3.1.1.3.cmml" xref="S2.p3.3.m3.1.1.3"><ci id="S2.p3.3.m3.1.1.3.1.cmml" xref="S2.p3.3.m3.1.1.3.1">^</ci><ci id="S2.p3.3.m3.1.1.3.2.cmml" xref="S2.p3.3.m3.1.1.3.2">𝑥</ci></apply><apply id="S2.p3.3.m3.1.1.1.cmml" xref="S2.p3.3.m3.1.1.1"><times id="S2.p3.3.m3.1.1.1.2.cmml" xref="S2.p3.3.m3.1.1.1.2"></times><ci id="S2.p3.3.m3.1.1.1.3.cmml" xref="S2.p3.3.m3.1.1.1.3">𝒟</ci><apply id="S2.p3.3.m3.1.1.1.1.1.1.cmml" xref="S2.p3.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.p3.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.3.m3.1.1.1.1.1.1.2.cmml" xref="S2.p3.3.m3.1.1.1.1.1.1.2">𝐳</ci><ci id="S2.p3.3.m3.1.1.1.1.1.1.3.cmml" xref="S2.p3.3.m3.1.1.1.1.1.1.3">𝐪</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">\hat{x}=\mathcal{D}(\mathbf{z}_{\mathbf{q}})</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m3.1d">over^ start_ARG italic_x end_ARG = caligraphic_D ( bold_z start_POSTSUBSCRIPT bold_q end_POSTSUBSCRIPT )</annotation></semantics></math>.
The model and codebook can be trained end-to-end via the loss function</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathrm{VQ}}(\mathcal{E},\mathcal{D},\mathcal{Z})=\|x-\hat{x}\|^{%
2}+\left\|\mathrm{sg}[\mathbf{z}^{\mathbf{q}}]-\mathbf{z}\right\|_{2}^{2}+%
\left\|\mathrm{sg}[\mathbf{z}]-\mathbf{z}^{\mathbf{q}}\right\|_{2}^{2}," class="ltx_Math" display="block" id="S2.E2.m1.5"><semantics id="S2.E2.m1.5a"><mrow id="S2.E2.m1.5.5.1" xref="S2.E2.m1.5.5.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1" xref="S2.E2.m1.5.5.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1.5" xref="S2.E2.m1.5.5.1.1.5.cmml"><msub id="S2.E2.m1.5.5.1.1.5.2" xref="S2.E2.m1.5.5.1.1.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.5.5.1.1.5.2.2" xref="S2.E2.m1.5.5.1.1.5.2.2.cmml">ℒ</mi><mi id="S2.E2.m1.5.5.1.1.5.2.3" xref="S2.E2.m1.5.5.1.1.5.2.3.cmml">VQ</mi></msub><mo id="S2.E2.m1.5.5.1.1.5.1" xref="S2.E2.m1.5.5.1.1.5.1.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.5.3.2" xref="S2.E2.m1.5.5.1.1.5.3.1.cmml"><mo id="S2.E2.m1.5.5.1.1.5.3.2.1" stretchy="false" xref="S2.E2.m1.5.5.1.1.5.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">ℰ</mi><mo id="S2.E2.m1.5.5.1.1.5.3.2.2" xref="S2.E2.m1.5.5.1.1.5.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">𝒟</mi><mo id="S2.E2.m1.5.5.1.1.5.3.2.3" xref="S2.E2.m1.5.5.1.1.5.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">𝒵</mi><mo id="S2.E2.m1.5.5.1.1.5.3.2.4" stretchy="false" xref="S2.E2.m1.5.5.1.1.5.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.5.5.1.1.4" xref="S2.E2.m1.5.5.1.1.4.cmml">=</mo><mrow id="S2.E2.m1.5.5.1.1.3" xref="S2.E2.m1.5.5.1.1.3.cmml"><msup id="S2.E2.m1.5.5.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E2.m1.5.5.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.3.cmml">2</mn></msup><mo id="S2.E2.m1.5.5.1.1.3.4" xref="S2.E2.m1.5.5.1.1.3.4.cmml">+</mo><msubsup id="S2.E2.m1.5.5.1.1.2.2" xref="S2.E2.m1.5.5.1.1.2.2.cmml"><mrow id="S2.E2.m1.5.5.1.1.2.2.1.1.1" xref="S2.E2.m1.5.5.1.1.2.2.1.1.2.cmml"><mo id="S2.E2.m1.5.5.1.1.2.2.1.1.1.2" xref="S2.E2.m1.5.5.1.1.2.2.1.1.2.1.cmml">‖</mo><mrow id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.cmml"><mi id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.3.cmml">sg</mi><mo id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.2.cmml"><mo id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.2.1.cmml">[</mo><msup id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml">𝐪</mi></msup><mo id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.2.cmml">−</mo><mi id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.3.cmml">𝐳</mi></mrow><mo id="S2.E2.m1.5.5.1.1.2.2.1.1.1.3" xref="S2.E2.m1.5.5.1.1.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E2.m1.5.5.1.1.2.2.1.3" xref="S2.E2.m1.5.5.1.1.2.2.1.3.cmml">2</mn><mn id="S2.E2.m1.5.5.1.1.2.2.3" xref="S2.E2.m1.5.5.1.1.2.2.3.cmml">2</mn></msubsup><mo id="S2.E2.m1.5.5.1.1.3.4a" xref="S2.E2.m1.5.5.1.1.3.4.cmml">+</mo><msubsup id="S2.E2.m1.5.5.1.1.3.3" xref="S2.E2.m1.5.5.1.1.3.3.cmml"><mrow id="S2.E2.m1.5.5.1.1.3.3.1.1.1" xref="S2.E2.m1.5.5.1.1.3.3.1.1.2.cmml"><mo id="S2.E2.m1.5.5.1.1.3.3.1.1.1.2" xref="S2.E2.m1.5.5.1.1.3.3.1.1.2.1.cmml">‖</mo><mrow id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.cmml"><mi id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.2" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.2.cmml">sg</mi><mo id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.1" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.3.2" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.3.1.cmml"><mo id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.3.2.1" stretchy="false" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.3.1.1.cmml">[</mo><mi id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">𝐳</mi><mo id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.3.2.2" stretchy="false" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.1.cmml">−</mo><msup id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3.3" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3.3.cmml">𝐪</mi></msup></mrow><mo id="S2.E2.m1.5.5.1.1.3.3.1.1.1.3" xref="S2.E2.m1.5.5.1.1.3.3.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E2.m1.5.5.1.1.3.3.1.3" xref="S2.E2.m1.5.5.1.1.3.3.1.3.cmml">2</mn><mn id="S2.E2.m1.5.5.1.1.3.3.3" xref="S2.E2.m1.5.5.1.1.3.3.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S2.E2.m1.5.5.1.2" xref="S2.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.5b"><apply id="S2.E2.m1.5.5.1.1.cmml" xref="S2.E2.m1.5.5.1"><eq id="S2.E2.m1.5.5.1.1.4.cmml" xref="S2.E2.m1.5.5.1.1.4"></eq><apply id="S2.E2.m1.5.5.1.1.5.cmml" xref="S2.E2.m1.5.5.1.1.5"><times id="S2.E2.m1.5.5.1.1.5.1.cmml" xref="S2.E2.m1.5.5.1.1.5.1"></times><apply id="S2.E2.m1.5.5.1.1.5.2.cmml" xref="S2.E2.m1.5.5.1.1.5.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.5.2.1.cmml" xref="S2.E2.m1.5.5.1.1.5.2">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.5.2.2.cmml" xref="S2.E2.m1.5.5.1.1.5.2.2">ℒ</ci><ci id="S2.E2.m1.5.5.1.1.5.2.3.cmml" xref="S2.E2.m1.5.5.1.1.5.2.3">VQ</ci></apply><vector id="S2.E2.m1.5.5.1.1.5.3.1.cmml" xref="S2.E2.m1.5.5.1.1.5.3.2"><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">ℰ</ci><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">𝒟</ci><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝒵</ci></vector></apply><apply id="S2.E2.m1.5.5.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.3"><plus id="S2.E2.m1.5.5.1.1.3.4.cmml" xref="S2.E2.m1.5.5.1.1.3.4"></plus><apply id="S2.E2.m1.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1"><minus id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1"></minus><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.3"><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.1">^</ci><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.2">𝑥</ci></apply></apply></apply><cn id="S2.E2.m1.5.5.1.1.1.1.3.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.1.1.3">2</cn></apply><apply id="S2.E2.m1.5.5.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.2.2.2.cmml" xref="S2.E2.m1.5.5.1.1.2.2">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.2.2.1.cmml" xref="S2.E2.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.2.2.1.2.cmml" xref="S2.E2.m1.5.5.1.1.2.2">subscript</csymbol><apply id="S2.E2.m1.5.5.1.1.2.2.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.2.2.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.2">norm</csymbol><apply id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1"><minus id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.2"></minus><apply id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1"><times id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.2"></times><ci id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.3">sg</ci><apply id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3">𝐪</ci></apply></apply></apply><ci id="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1.1.1.1.3">𝐳</ci></apply></apply><cn id="S2.E2.m1.5.5.1.1.2.2.1.3.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.2.2.1.3">2</cn></apply><cn id="S2.E2.m1.5.5.1.1.2.2.3.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.2.2.3">2</cn></apply><apply id="S2.E2.m1.5.5.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.3.3.2.cmml" xref="S2.E2.m1.5.5.1.1.3.3">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.3.3.1.cmml" xref="S2.E2.m1.5.5.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.3.3.1.2.cmml" xref="S2.E2.m1.5.5.1.1.3.3">subscript</csymbol><apply id="S2.E2.m1.5.5.1.1.3.3.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.3.3.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.2">norm</csymbol><apply id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1"><minus id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.1"></minus><apply id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2"><times id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.1"></times><ci id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.2">sg</ci><apply id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.3.2"><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.3.1.1.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4">𝐳</ci></apply></apply><apply id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3">superscript</csymbol><ci id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3.2">𝐳</ci><ci id="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.3.3.1.1.1.1.3.3">𝐪</ci></apply></apply></apply><cn id="S2.E2.m1.5.5.1.1.3.3.1.3.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.3.3.1.3">2</cn></apply><cn id="S2.E2.m1.5.5.1.1.3.3.3.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.5c">\mathcal{L}_{\mathrm{VQ}}(\mathcal{E},\mathcal{D},\mathcal{Z})=\|x-\hat{x}\|^{%
2}+\left\|\mathrm{sg}[\mathbf{z}^{\mathbf{q}}]-\mathbf{z}\right\|_{2}^{2}+%
\left\|\mathrm{sg}[\mathbf{z}]-\mathbf{z}^{\mathbf{q}}\right\|_{2}^{2},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.5d">caligraphic_L start_POSTSUBSCRIPT roman_VQ end_POSTSUBSCRIPT ( caligraphic_E , caligraphic_D , caligraphic_Z ) = ∥ italic_x - over^ start_ARG italic_x end_ARG ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∥ roman_sg [ bold_z start_POSTSUPERSCRIPT bold_q end_POSTSUPERSCRIPT ] - bold_z ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∥ roman_sg [ bold_z ] - bold_z start_POSTSUPERSCRIPT bold_q end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p3.5">where sg[·] denotes the stop-gradient operation, the first term <math alttext="\mathcal{L}_{\mathrm{rec}}=\|x-\hat{x}\|^{2}" class="ltx_Math" display="inline" id="S2.p3.4.m1.1"><semantics id="S2.p3.4.m1.1a"><mrow id="S2.p3.4.m1.1.1" xref="S2.p3.4.m1.1.1.cmml"><msub id="S2.p3.4.m1.1.1.3" xref="S2.p3.4.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p3.4.m1.1.1.3.2" xref="S2.p3.4.m1.1.1.3.2.cmml">ℒ</mi><mi id="S2.p3.4.m1.1.1.3.3" xref="S2.p3.4.m1.1.1.3.3.cmml">rec</mi></msub><mo id="S2.p3.4.m1.1.1.2" xref="S2.p3.4.m1.1.1.2.cmml">=</mo><msup id="S2.p3.4.m1.1.1.1" xref="S2.p3.4.m1.1.1.1.cmml"><mrow id="S2.p3.4.m1.1.1.1.1.1" xref="S2.p3.4.m1.1.1.1.1.2.cmml"><mo id="S2.p3.4.m1.1.1.1.1.1.2" stretchy="false" xref="S2.p3.4.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.p3.4.m1.1.1.1.1.1.1" xref="S2.p3.4.m1.1.1.1.1.1.1.cmml"><mi id="S2.p3.4.m1.1.1.1.1.1.1.2" xref="S2.p3.4.m1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S2.p3.4.m1.1.1.1.1.1.1.1" xref="S2.p3.4.m1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S2.p3.4.m1.1.1.1.1.1.1.3" xref="S2.p3.4.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.p3.4.m1.1.1.1.1.1.1.3.2" xref="S2.p3.4.m1.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="S2.p3.4.m1.1.1.1.1.1.1.3.1" xref="S2.p3.4.m1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S2.p3.4.m1.1.1.1.1.1.3" stretchy="false" xref="S2.p3.4.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.p3.4.m1.1.1.1.3" xref="S2.p3.4.m1.1.1.1.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.4.m1.1b"><apply id="S2.p3.4.m1.1.1.cmml" xref="S2.p3.4.m1.1.1"><eq id="S2.p3.4.m1.1.1.2.cmml" xref="S2.p3.4.m1.1.1.2"></eq><apply id="S2.p3.4.m1.1.1.3.cmml" xref="S2.p3.4.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.4.m1.1.1.3.1.cmml" xref="S2.p3.4.m1.1.1.3">subscript</csymbol><ci id="S2.p3.4.m1.1.1.3.2.cmml" xref="S2.p3.4.m1.1.1.3.2">ℒ</ci><ci id="S2.p3.4.m1.1.1.3.3.cmml" xref="S2.p3.4.m1.1.1.3.3">rec</ci></apply><apply id="S2.p3.4.m1.1.1.1.cmml" xref="S2.p3.4.m1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.4.m1.1.1.1.2.cmml" xref="S2.p3.4.m1.1.1.1">superscript</csymbol><apply id="S2.p3.4.m1.1.1.1.1.2.cmml" xref="S2.p3.4.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p3.4.m1.1.1.1.1.2.1.cmml" xref="S2.p3.4.m1.1.1.1.1.1.2">norm</csymbol><apply id="S2.p3.4.m1.1.1.1.1.1.1.cmml" xref="S2.p3.4.m1.1.1.1.1.1.1"><minus id="S2.p3.4.m1.1.1.1.1.1.1.1.cmml" xref="S2.p3.4.m1.1.1.1.1.1.1.1"></minus><ci id="S2.p3.4.m1.1.1.1.1.1.1.2.cmml" xref="S2.p3.4.m1.1.1.1.1.1.1.2">𝑥</ci><apply id="S2.p3.4.m1.1.1.1.1.1.1.3.cmml" xref="S2.p3.4.m1.1.1.1.1.1.1.3"><ci id="S2.p3.4.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.p3.4.m1.1.1.1.1.1.1.3.1">^</ci><ci id="S2.p3.4.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.p3.4.m1.1.1.1.1.1.1.3.2">𝑥</ci></apply></apply></apply><cn id="S2.p3.4.m1.1.1.1.3.cmml" type="integer" xref="S2.p3.4.m1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m1.1c">\mathcal{L}_{\mathrm{rec}}=\|x-\hat{x}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_rec end_POSTSUBSCRIPT = ∥ italic_x - over^ start_ARG italic_x end_ARG ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> is a reconstruction loss, the second term is the commitment
loss that is used to force the encoder output <math alttext="\mathbf{z}_{\mathbf{q}}" class="ltx_Math" display="inline" id="S2.p3.5.m2.1"><semantics id="S2.p3.5.m2.1a"><msub id="S2.p3.5.m2.1.1" xref="S2.p3.5.m2.1.1.cmml"><mi id="S2.p3.5.m2.1.1.2" xref="S2.p3.5.m2.1.1.2.cmml">𝐳</mi><mi id="S2.p3.5.m2.1.1.3" xref="S2.p3.5.m2.1.1.3.cmml">𝐪</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.5.m2.1b"><apply id="S2.p3.5.m2.1.1.cmml" xref="S2.p3.5.m2.1.1"><csymbol cd="ambiguous" id="S2.p3.5.m2.1.1.1.cmml" xref="S2.p3.5.m2.1.1">subscript</csymbol><ci id="S2.p3.5.m2.1.1.2.cmml" xref="S2.p3.5.m2.1.1.2">𝐳</ci><ci id="S2.p3.5.m2.1.1.3.cmml" xref="S2.p3.5.m2.1.1.3">𝐪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m2.1c">\mathbf{z}_{\mathbf{q}}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.5.m2.1d">bold_z start_POSTSUBSCRIPT bold_q end_POSTSUBSCRIPT</annotation></semantics></math> commits to the codewords and the bottleneck codewords are optimized by the third term.
In practice, we perform moving averages update <cite class="ltx_cite ltx_citemacro_citep">(Van Den Oord et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib24" title="">2017</a>)</cite> instead of adding auxiliary losses for stable training of the codebook.
Then the selected index can be used as Semantic IDs for clustering in the context of the semantic codebook, therefore capturing local structure of the original embedding.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.3"><span class="ltx_text ltx_font_bold" id="S2.p4.3.1">Semantic IDs for Feature Interaction.</span>
In recommendation system, feature interaction models how different attributes from users and items influence each other to affect recommendation outcomes. When incorporating the Semantic ID from quantization, the models treat the Semantic ID
<math alttext="x_{sid}" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><msub id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml"><mi id="S2.p4.1.m1.1.1.2" xref="S2.p4.1.m1.1.1.2.cmml">x</mi><mrow id="S2.p4.1.m1.1.1.3" xref="S2.p4.1.m1.1.1.3.cmml"><mi id="S2.p4.1.m1.1.1.3.2" xref="S2.p4.1.m1.1.1.3.2.cmml">s</mi><mo id="S2.p4.1.m1.1.1.3.1" xref="S2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.p4.1.m1.1.1.3.3" xref="S2.p4.1.m1.1.1.3.3.cmml">i</mi><mo id="S2.p4.1.m1.1.1.3.1a" xref="S2.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.p4.1.m1.1.1.3.4" xref="S2.p4.1.m1.1.1.3.4.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.m1.1.1.1.cmml" xref="S2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.p4.1.m1.1.1.2.cmml" xref="S2.p4.1.m1.1.1.2">𝑥</ci><apply id="S2.p4.1.m1.1.1.3.cmml" xref="S2.p4.1.m1.1.1.3"><times id="S2.p4.1.m1.1.1.3.1.cmml" xref="S2.p4.1.m1.1.1.3.1"></times><ci id="S2.p4.1.m1.1.1.3.2.cmml" xref="S2.p4.1.m1.1.1.3.2">𝑠</ci><ci id="S2.p4.1.m1.1.1.3.3.cmml" xref="S2.p4.1.m1.1.1.3.3">𝑖</ci><ci id="S2.p4.1.m1.1.1.3.4.cmml" xref="S2.p4.1.m1.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">x_{sid}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT</annotation></semantics></math>
as a new feature field. The features are fed with other <math alttext="N" class="ltx_Math" display="inline" id="S2.p4.2.m2.1"><semantics id="S2.p4.2.m2.1a"><mi id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><ci id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.1d">italic_N</annotation></semantics></math> features into the embedding layer <math alttext="E_{i}" class="ltx_Math" display="inline" id="S2.p4.3.m3.1"><semantics id="S2.p4.3.m3.1a"><msub id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml"><mi id="S2.p4.3.m3.1.1.2" xref="S2.p4.3.m3.1.1.2.cmml">E</mi><mi id="S2.p4.3.m3.1.1.3" xref="S2.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.1b"><apply id="S2.p4.3.m3.1.1.cmml" xref="S2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p4.3.m3.1.1.1.cmml" xref="S2.p4.3.m3.1.1">subscript</csymbol><ci id="S2.p4.3.m3.1.1.2.cmml" xref="S2.p4.3.m3.1.1.2">𝐸</ci><ci id="S2.p4.3.m3.1.1.3.cmml" xref="S2.p4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.1c">E_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.3.m3.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
for each field and subsequently into the feature interaction modules for prediction.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p5">
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\bm{e}_{i}" class="ltx_Math" display="inline" id="S2.E3X.2.1.1.m1.1"><semantics id="S2.E3X.2.1.1.m1.1a"><msub id="S2.E3X.2.1.1.m1.1.1" xref="S2.E3X.2.1.1.m1.1.1.cmml"><mi id="S2.E3X.2.1.1.m1.1.1.2" xref="S2.E3X.2.1.1.m1.1.1.2.cmml">𝒆</mi><mi id="S2.E3X.2.1.1.m1.1.1.3" xref="S2.E3X.2.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E3X.2.1.1.m1.1b"><apply id="S2.E3X.2.1.1.m1.1.1.cmml" xref="S2.E3X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E3X.2.1.1.m1.1.1.1.cmml" xref="S2.E3X.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E3X.2.1.1.m1.1.1.2.cmml" xref="S2.E3X.2.1.1.m1.1.1.2">𝒆</ci><ci id="S2.E3X.2.1.1.m1.1.1.3.cmml" xref="S2.E3X.2.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.2.1.1.m1.1c">\displaystyle\bm{e}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.2.1.1.m1.1d">bold_italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\bm{E}_{i}^{\top}\bm{1}_{x_{i}},\mathrm{~{}}\forall i\in\{1,2,..%
.,N\}," class="ltx_Math" display="inline" id="S2.E3X.3.2.2.m1.5"><semantics id="S2.E3X.3.2.2.m1.5a"><mrow id="S2.E3X.3.2.2.m1.5.5.1"><mrow id="S2.E3X.3.2.2.m1.5.5.1.1.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.3.cmml"><mrow id="S2.E3X.3.2.2.m1.5.5.1.1.1.1" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.cmml"><mi id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.2.cmml"></mi><mo id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.1" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.1.cmml">=</mo><mrow id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.cmml"><msubsup id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.cmml"><mi id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.2.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.2.2.cmml">𝑬</mi><mi id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.2.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.2.3.cmml">i</mi><mo id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.3.cmml">⊤</mo></msubsup><mo id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.1" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.cmml"><mn id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.2.cmml">𝟏</mn><msub id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3.cmml"><mi id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3.3.cmml">i</mi></msub></msub></mrow></mrow><mo id="S2.E3X.3.2.2.m1.5.5.1.1.2.3" rspace="0.497em" xref="S2.E3X.3.2.2.m1.5.5.1.1.3a.cmml">,</mo><mrow id="S2.E3X.3.2.2.m1.5.5.1.1.2.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.cmml"><mrow id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2.cmml"><mo id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2.1" rspace="0.167em" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2.1.cmml">∀</mo><mi id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2.2.cmml">i</mi></mrow><mo id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.1" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.1.cmml">∈</mo><mrow id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml"><mo id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.2.1" stretchy="false" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml">{</mo><mn id="S2.E3X.3.2.2.m1.1.1" xref="S2.E3X.3.2.2.m1.1.1.cmml">1</mn><mo id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.2.2" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mn id="S2.E3X.3.2.2.m1.2.2" xref="S2.E3X.3.2.2.m1.2.2.cmml">2</mn><mo id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.2.3" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mi id="S2.E3X.3.2.2.m1.3.3" mathvariant="normal" xref="S2.E3X.3.2.2.m1.3.3.cmml">…</mi><mo id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.2.4" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mi id="S2.E3X.3.2.2.m1.4.4" xref="S2.E3X.3.2.2.m1.4.4.cmml">N</mi><mo id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.2.5" stretchy="false" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><mo id="S2.E3X.3.2.2.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3X.3.2.2.m1.5b"><apply id="S2.E3X.3.2.2.m1.5.5.1.1.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.5.5.1.1.3a.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1"><eq id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.2">absent</csymbol><apply id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3"><times id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.1"></times><apply id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2">superscript</csymbol><apply id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.2.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.2.2">𝑬</ci><ci id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.2.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.2.3">top</csymbol></apply><apply id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3">subscript</csymbol><cn id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.2.cmml" type="integer" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.2">1</cn><apply id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3.3.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2"><in id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.1"></in><apply id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2"><csymbol cd="latexml" id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2.1">for-all</csymbol><ci id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.2.2">𝑖</ci></apply><set id="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml" xref="S2.E3X.3.2.2.m1.5.5.1.1.2.2.3.2"><cn id="S2.E3X.3.2.2.m1.1.1.cmml" type="integer" xref="S2.E3X.3.2.2.m1.1.1">1</cn><cn id="S2.E3X.3.2.2.m1.2.2.cmml" type="integer" xref="S2.E3X.3.2.2.m1.2.2">2</cn><ci id="S2.E3X.3.2.2.m1.3.3.cmml" xref="S2.E3X.3.2.2.m1.3.3">…</ci><ci id="S2.E3X.3.2.2.m1.4.4.cmml" xref="S2.E3X.3.2.2.m1.4.4">𝑁</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.3.2.2.m1.5c">\displaystyle=\bm{E}_{i}^{\top}\bm{1}_{x_{i}},\mathrm{~{}}\forall i\in\{1,2,..%
.,N\},</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.3.2.2.m1.5d">= bold_italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT , ∀ italic_i ∈ { 1 , 2 , … , italic_N } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="4"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\bm{e}_{sid}" class="ltx_Math" display="inline" id="S2.E3Xa.2.1.1.m1.1"><semantics id="S2.E3Xa.2.1.1.m1.1a"><msub id="S2.E3Xa.2.1.1.m1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.2" xref="S2.E3Xa.2.1.1.m1.1.1.2.cmml">𝒆</mi><mrow id="S2.E3Xa.2.1.1.m1.1.1.3" xref="S2.E3Xa.2.1.1.m1.1.1.3.cmml"><mi id="S2.E3Xa.2.1.1.m1.1.1.3.2" xref="S2.E3Xa.2.1.1.m1.1.1.3.2.cmml">s</mi><mo id="S2.E3Xa.2.1.1.m1.1.1.3.1" xref="S2.E3Xa.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E3Xa.2.1.1.m1.1.1.3.3" xref="S2.E3Xa.2.1.1.m1.1.1.3.3.cmml">i</mi><mo id="S2.E3Xa.2.1.1.m1.1.1.3.1a" xref="S2.E3Xa.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E3Xa.2.1.1.m1.1.1.3.4" xref="S2.E3Xa.2.1.1.m1.1.1.3.4.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.E3Xa.2.1.1.m1.1b"><apply id="S2.E3Xa.2.1.1.m1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.2">𝒆</ci><apply id="S2.E3Xa.2.1.1.m1.1.1.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.3"><times id="S2.E3Xa.2.1.1.m1.1.1.3.1.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.3.1"></times><ci id="S2.E3Xa.2.1.1.m1.1.1.3.2.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.3.2">𝑠</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.3.3.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.3.3">𝑖</ci><ci id="S2.E3Xa.2.1.1.m1.1.1.3.4.cmml" xref="S2.E3Xa.2.1.1.m1.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xa.2.1.1.m1.1c">\displaystyle\bm{e}_{sid}</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xa.2.1.1.m1.1d">bold_italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\bm{E}_{sid}^{\top}\bm{1}_{x_{sid}}," class="ltx_Math" display="inline" id="S2.E3Xa.3.2.2.m1.1"><semantics id="S2.E3Xa.3.2.2.m1.1a"><mrow id="S2.E3Xa.3.2.2.m1.1.1.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S2.E3Xa.3.2.2.m1.1.1.1.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="S2.E3Xa.3.2.2.m1.1.1.1.1.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E3Xa.3.2.2.m1.1.1.1.1.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.cmml"><msubsup id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.cmml"><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.2.cmml">𝑬</mi><mrow id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.cmml"><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.cmml">s</mi><mo id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.3.cmml">i</mi><mo id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.1a" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.4" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.4.cmml">d</mi></mrow><mo id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml">⊤</mo></msubsup><mo id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.cmml"><mn id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.2.cmml">𝟏</mn><msub id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.cmml"><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.2.cmml">x</mi><mrow id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.2.cmml">s</mi><mo id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.1" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.3" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.3.cmml">i</mi><mo id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.1a" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.4" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.4.cmml">d</mi></mrow></msub></msub></mrow></mrow><mo id="S2.E3Xa.3.2.2.m1.1.1.1.2" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3Xa.3.2.2.m1.1b"><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1"><eq id="S2.E3Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E3Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.2">absent</csymbol><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3"><times id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.1"></times><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.2">𝑬</ci><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3"><times id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.1"></times><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.2">𝑠</ci><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.3">𝑖</ci><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.4.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.2.3.4">𝑑</ci></apply></apply><csymbol cd="latexml" id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.2.3">top</csymbol></apply><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3">subscript</csymbol><cn id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.2.cmml" type="integer" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.2">1</cn><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.2">𝑥</ci><apply id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3"><times id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.2">𝑠</ci><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.3">𝑖</ci><ci id="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.4.cmml" xref="S2.E3Xa.3.2.2.m1.1.1.1.1.3.3.3.3.4">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xa.3.2.2.m1.1c">\displaystyle=\bm{E}_{sid}^{\top}\bm{1}_{x_{sid}},</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xa.3.2.2.m1.1d">= bold_italic_E start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h" class="ltx_Math" display="inline" id="S2.E3Xb.2.1.1.m1.1"><semantics id="S2.E3Xb.2.1.1.m1.1a"><mi id="S2.E3Xb.2.1.1.m1.1.1" xref="S2.E3Xb.2.1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.E3Xb.2.1.1.m1.1b"><ci id="S2.E3Xb.2.1.1.m1.1.1.cmml" xref="S2.E3Xb.2.1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xb.2.1.1.m1.1c">\displaystyle h</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xb.2.1.1.m1.1d">italic_h</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=I(\bm{e}_{1},\bm{e}_{2},...,\bm{e}_{n},\bm{e}_{sid})," class="ltx_Math" display="inline" id="S2.E3Xb.3.2.2.m1.2"><semantics id="S2.E3Xb.3.2.2.m1.2a"><mrow id="S2.E3Xb.3.2.2.m1.2.2.1" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.cmml"><mrow id="S2.E3Xb.3.2.2.m1.2.2.1.1" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.cmml"><mi id="S2.E3Xb.3.2.2.m1.2.2.1.1.6" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.6.cmml"></mi><mo id="S2.E3Xb.3.2.2.m1.2.2.1.1.5" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.5.cmml">=</mo><mrow id="S2.E3Xb.3.2.2.m1.2.2.1.1.4" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.cmml"><mi id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.6" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.6.cmml">I</mi><mo id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.5" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.5.cmml">⁢</mo><mrow id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.5.cmml"><mo id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.5" stretchy="false" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.5.cmml">(</mo><msub id="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml">𝒆</mi><mn id="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.6" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.5.cmml">,</mo><msub id="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.cmml">𝒆</mi><mn id="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.3" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.7" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.5.cmml">,</mo><mi id="S2.E3Xb.3.2.2.m1.1.1" mathvariant="normal" xref="S2.E3Xb.3.2.2.m1.1.1.cmml">…</mi><mo id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.8" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.5.cmml">,</mo><msub id="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3.cmml"><mi id="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3.2" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3.2.cmml">𝒆</mi><mi id="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3.3" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3.3.cmml">n</mi></msub><mo id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.9" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.5.cmml">,</mo><msub id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.cmml"><mi id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.2" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.2.cmml">𝒆</mi><mrow id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.cmml"><mi id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.2" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.2.cmml">s</mi><mo id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.1" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.1.cmml">⁢</mo><mi id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.3" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.3.cmml">i</mi><mo id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.1a" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.1.cmml">⁢</mo><mi id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.4" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.4.cmml">d</mi></mrow></msub><mo id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.10" stretchy="false" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.5.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3Xb.3.2.2.m1.2.2.1.2" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3Xb.3.2.2.m1.2b"><apply id="S2.E3Xb.3.2.2.m1.2.2.1.1.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1"><eq id="S2.E3Xb.3.2.2.m1.2.2.1.1.5.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.5"></eq><csymbol cd="latexml" id="S2.E3Xb.3.2.2.m1.2.2.1.1.6.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.6">absent</csymbol><apply id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4"><times id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.5.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.5"></times><ci id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.6.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.6">𝐼</ci><vector id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.5.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4"><apply id="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.2">𝒆</ci><cn id="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.1.1.1.1.3">1</cn></apply><apply id="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.2">𝒆</ci><cn id="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.3.cmml" type="integer" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.2.2.2.2.3">2</cn></apply><ci id="S2.E3Xb.3.2.2.m1.1.1.cmml" xref="S2.E3Xb.3.2.2.m1.1.1">…</ci><apply id="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3">subscript</csymbol><ci id="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3.2">𝒆</ci><ci id="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.3.3.3.3.3">𝑛</ci></apply><apply id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.1.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4">subscript</csymbol><ci id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.2.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.2">𝒆</ci><apply id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3"><times id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.1.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.1"></times><ci id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.2.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.2">𝑠</ci><ci id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.3.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.3">𝑖</ci><ci id="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.4.cmml" xref="S2.E3Xb.3.2.2.m1.2.2.1.1.4.4.4.4.3.4">𝑑</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xb.3.2.2.m1.2c">\displaystyle=I(\bm{e}_{1},\bm{e}_{2},...,\bm{e}_{n},\bm{e}_{sid}),</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xb.3.2.2.m1.2d">= italic_I ( bold_italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_italic_e start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , bold_italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3Xc">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{y}" class="ltx_Math" display="inline" id="S2.E3Xc.2.1.1.m1.1"><semantics id="S2.E3Xc.2.1.1.m1.1a"><mover accent="true" id="S2.E3Xc.2.1.1.m1.1.1" xref="S2.E3Xc.2.1.1.m1.1.1.cmml"><mi id="S2.E3Xc.2.1.1.m1.1.1.2" xref="S2.E3Xc.2.1.1.m1.1.1.2.cmml">y</mi><mo id="S2.E3Xc.2.1.1.m1.1.1.1" xref="S2.E3Xc.2.1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.E3Xc.2.1.1.m1.1b"><apply id="S2.E3Xc.2.1.1.m1.1.1.cmml" xref="S2.E3Xc.2.1.1.m1.1.1"><ci id="S2.E3Xc.2.1.1.m1.1.1.1.cmml" xref="S2.E3Xc.2.1.1.m1.1.1.1">^</ci><ci id="S2.E3Xc.2.1.1.m1.1.1.2.cmml" xref="S2.E3Xc.2.1.1.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xc.2.1.1.m1.1c">\displaystyle\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xc.2.1.1.m1.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=F(h)," class="ltx_Math" display="inline" id="S2.E3Xc.3.2.2.m1.2"><semantics id="S2.E3Xc.3.2.2.m1.2a"><mrow id="S2.E3Xc.3.2.2.m1.2.2.1" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.cmml"><mrow id="S2.E3Xc.3.2.2.m1.2.2.1.1" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.cmml"><mi id="S2.E3Xc.3.2.2.m1.2.2.1.1.2" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.2.cmml"></mi><mo id="S2.E3Xc.3.2.2.m1.2.2.1.1.1" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E3Xc.3.2.2.m1.2.2.1.1.3" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.3.cmml"><mi id="S2.E3Xc.3.2.2.m1.2.2.1.1.3.2" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.3.2.cmml">F</mi><mo id="S2.E3Xc.3.2.2.m1.2.2.1.1.3.1" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E3Xc.3.2.2.m1.2.2.1.1.3.3.2" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.3.cmml"><mo id="S2.E3Xc.3.2.2.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E3Xc.3.2.2.m1.1.1" xref="S2.E3Xc.3.2.2.m1.1.1.cmml">h</mi><mo id="S2.E3Xc.3.2.2.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3Xc.3.2.2.m1.2.2.1.2" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3Xc.3.2.2.m1.2b"><apply id="S2.E3Xc.3.2.2.m1.2.2.1.1.cmml" xref="S2.E3Xc.3.2.2.m1.2.2.1"><eq id="S2.E3Xc.3.2.2.m1.2.2.1.1.1.cmml" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.1"></eq><csymbol cd="latexml" id="S2.E3Xc.3.2.2.m1.2.2.1.1.2.cmml" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.2">absent</csymbol><apply id="S2.E3Xc.3.2.2.m1.2.2.1.1.3.cmml" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.3"><times id="S2.E3Xc.3.2.2.m1.2.2.1.1.3.1.cmml" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.3.1"></times><ci id="S2.E3Xc.3.2.2.m1.2.2.1.1.3.2.cmml" xref="S2.E3Xc.3.2.2.m1.2.2.1.1.3.2">𝐹</ci><ci id="S2.E3Xc.3.2.2.m1.1.1.cmml" xref="S2.E3Xc.3.2.2.m1.1.1">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xc.3.2.2.m1.2c">\displaystyle=F(h),</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xc.3.2.2.m1.2d">= italic_F ( italic_h ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>On the Scaling of Semantic Representation</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we first revisit the design of one single codebook for recommendation and discover the information loss due to dimension compression.
Based on this observation, we are motivated to design scalable semantic representations and propose two quantitative metrics to measure the information and dimension gain from scaling.
Next, we conduct a detailed analysis of existing scaling methods based on these metrics.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Limination of a Single Code</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">The original LLM embeddings span a high-dimensional space, <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.1.1">e.g.</em>, ranging from 1,024 to 416,384 dimensions. <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib5" title="">2024</a>)</cite>.
When we build a semantic representation based on the LLM embeddings to transfer their knowledge to recommendation, the dimension of these representation needs to match that of the recommendation ID embeddings.
However, the dimension of recommendations is usually no more than 256 due to the Interaction Collapse Theory <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib8" title="">2023</a>)</cite>, and hence is much smaller than that of the LLM embeddings.
Such dramatic dimension compression may result in huge information loss.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">To illustrate this empirically, we conduct a toy study based on the reconstruction error of the LLM embeddings in a VAE-based generative model.
As shown in Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.F2" title="Figure 2 ‣ 3.1 Limination of a Single Code ‣ 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, we utilize a two-layer MLP with 512 hidden units to reconstruct the original 4096-dimensional LLM embedding.
When using only single set of Semantic ID as input, the reconstruction error is extremely high, indicating the significant information loss.
However, the error drops significantly when we scale up the dimensions via using multiple (<em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.1.1">i.e.</em>, 2x and 3x) independent codebooks.
This demonstrates the original single code embedding only preserves limited information of the LLM embeddings.
Therefore, we aim to scale up the semantic representation appropriately to preserve the rich information from the LLM, thereby improving the performance of downstream recommendation tasks.</p>
</div>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F2.1" style="width:104.1pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="819" id="S3.F2.1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Reconstruction Error with different sets of Semantic IDs.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F2.fig1" style="width:320.9pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S3.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="837" id="S3.F2.sf1.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Flatten Emb NMI w.r.t. scaling factors, with 100 clusters.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S3.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="788" id="S3.F2.sf2.g1" src="x3.png" width="831"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Flatten Emb NMI w.r.t. Cluster Number, with scaling factor of 7x.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S3.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="788" id="S3.F2.sf3.g1" src="x4.png" width="831"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Comparison with RQ-VAE SID 1 embedding, with scaling factor of 7x.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Scalability on discriminability of various methods.</figcaption>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Baseline approaches to Scalable Semantic Representation</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Below we present two baseline approaches to scale up semantic representation based on Multi-Embedding <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib8" title="">2023</a>)</cite> and RQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib14" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.2"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.2.1">Single Codebook with Multi-Embeddings.</span>
Inspired by the recent Multi-Embedding <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib8" title="">2023</a>)</cite> approach to scale up embeddings in recommendation systems, our first choice is to assign multiple embeddings for each semantic ID.
Specifically, we still learn only one single codebook during the indexing stage, while we build <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_M</annotation></semantics></math> independent embeddings <math alttext="\{\bm{e}_{sid}^{1},\dots,\bm{e}_{sid}^{M}\}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.3"><semantics id="S3.SS2.p2.2.m2.3a"><mrow id="S3.SS2.p2.2.m2.3.3.2" xref="S3.SS2.p2.2.m2.3.3.3.cmml"><mo id="S3.SS2.p2.2.m2.3.3.2.3" stretchy="false" xref="S3.SS2.p2.2.m2.3.3.3.cmml">{</mo><msubsup id="S3.SS2.p2.2.m2.2.2.1.1" xref="S3.SS2.p2.2.m2.2.2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.2.2.1.1.2.2" xref="S3.SS2.p2.2.m2.2.2.1.1.2.2.cmml">𝒆</mi><mrow id="S3.SS2.p2.2.m2.2.2.1.1.2.3" xref="S3.SS2.p2.2.m2.2.2.1.1.2.3.cmml"><mi id="S3.SS2.p2.2.m2.2.2.1.1.2.3.2" xref="S3.SS2.p2.2.m2.2.2.1.1.2.3.2.cmml">s</mi><mo id="S3.SS2.p2.2.m2.2.2.1.1.2.3.1" xref="S3.SS2.p2.2.m2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.2.2.1.1.2.3.3" xref="S3.SS2.p2.2.m2.2.2.1.1.2.3.3.cmml">i</mi><mo id="S3.SS2.p2.2.m2.2.2.1.1.2.3.1a" xref="S3.SS2.p2.2.m2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.2.2.1.1.2.3.4" xref="S3.SS2.p2.2.m2.2.2.1.1.2.3.4.cmml">d</mi></mrow><mn id="S3.SS2.p2.2.m2.2.2.1.1.3" xref="S3.SS2.p2.2.m2.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS2.p2.2.m2.3.3.2.4" xref="S3.SS2.p2.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS2.p2.2.m2.1.1" mathvariant="normal" xref="S3.SS2.p2.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.p2.2.m2.3.3.2.5" xref="S3.SS2.p2.2.m2.3.3.3.cmml">,</mo><msubsup id="S3.SS2.p2.2.m2.3.3.2.2" xref="S3.SS2.p2.2.m2.3.3.2.2.cmml"><mi id="S3.SS2.p2.2.m2.3.3.2.2.2.2" xref="S3.SS2.p2.2.m2.3.3.2.2.2.2.cmml">𝒆</mi><mrow id="S3.SS2.p2.2.m2.3.3.2.2.2.3" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3.cmml"><mi id="S3.SS2.p2.2.m2.3.3.2.2.2.3.2" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3.2.cmml">s</mi><mo id="S3.SS2.p2.2.m2.3.3.2.2.2.3.1" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.3.3.2.2.2.3.3" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3.3.cmml">i</mi><mo id="S3.SS2.p2.2.m2.3.3.2.2.2.3.1a" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.3.3.2.2.2.3.4" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3.4.cmml">d</mi></mrow><mi id="S3.SS2.p2.2.m2.3.3.2.2.3" xref="S3.SS2.p2.2.m2.3.3.2.2.3.cmml">M</mi></msubsup><mo id="S3.SS2.p2.2.m2.3.3.2.6" stretchy="false" xref="S3.SS2.p2.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.3b"><set id="S3.SS2.p2.2.m2.3.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3.2"><apply id="S3.SS2.p2.2.m2.2.2.1.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1">superscript</csymbol><apply id="S3.SS2.p2.2.m2.2.2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.2.2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.2.2">𝒆</ci><apply id="S3.SS2.p2.2.m2.2.2.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.2.3"><times id="S3.SS2.p2.2.m2.2.2.1.1.2.3.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.2.3.1"></times><ci id="S3.SS2.p2.2.m2.2.2.1.1.2.3.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.2.3.2">𝑠</ci><ci id="S3.SS2.p2.2.m2.2.2.1.1.2.3.3.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.2.3.3">𝑖</ci><ci id="S3.SS2.p2.2.m2.2.2.1.1.2.3.4.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.2.3.4">𝑑</ci></apply></apply><cn id="S3.SS2.p2.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p2.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">…</ci><apply id="S3.SS2.p2.2.m2.3.3.2.2.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.3.3.2.2.1.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2">superscript</csymbol><apply id="S3.SS2.p2.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.2.2">𝒆</ci><apply id="S3.SS2.p2.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3"><times id="S3.SS2.p2.2.m2.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3.1"></times><ci id="S3.SS2.p2.2.m2.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3.2">𝑠</ci><ci id="S3.SS2.p2.2.m2.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3.3">𝑖</ci><ci id="S3.SS2.p2.2.m2.3.3.2.2.2.3.4.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.2.3.4">𝑑</ci></apply></apply><ci id="S3.SS2.p2.2.m2.3.3.2.2.3.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.3">𝑀</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.3c">\{\bm{e}_{sid}^{1},\dots,\bm{e}_{sid}^{M}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.3d">{ bold_italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , bold_italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT }</annotation></semantics></math> in the downstream stage.
Formally, we have</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E4X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\bm{e}_{sid}^{i}" class="ltx_Math" display="inline" id="S3.E4X.2.1.1.m1.1"><semantics id="S3.E4X.2.1.1.m1.1a"><msubsup id="S3.E4X.2.1.1.m1.1.1" xref="S3.E4X.2.1.1.m1.1.1.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.2.2" xref="S3.E4X.2.1.1.m1.1.1.2.2.cmml">𝒆</mi><mrow id="S3.E4X.2.1.1.m1.1.1.2.3" xref="S3.E4X.2.1.1.m1.1.1.2.3.cmml"><mi id="S3.E4X.2.1.1.m1.1.1.2.3.2" xref="S3.E4X.2.1.1.m1.1.1.2.3.2.cmml">s</mi><mo id="S3.E4X.2.1.1.m1.1.1.2.3.1" xref="S3.E4X.2.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4X.2.1.1.m1.1.1.2.3.3" xref="S3.E4X.2.1.1.m1.1.1.2.3.3.cmml">i</mi><mo id="S3.E4X.2.1.1.m1.1.1.2.3.1a" xref="S3.E4X.2.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4X.2.1.1.m1.1.1.2.3.4" xref="S3.E4X.2.1.1.m1.1.1.2.3.4.cmml">d</mi></mrow><mi id="S3.E4X.2.1.1.m1.1.1.3" xref="S3.E4X.2.1.1.m1.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.1b"><apply id="S3.E4X.2.1.1.m1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1">superscript</csymbol><apply id="S3.E4X.2.1.1.m1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E4X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.2">𝒆</ci><apply id="S3.E4X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.3"><times id="S3.E4X.2.1.1.m1.1.1.2.3.1.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.3.1"></times><ci id="S3.E4X.2.1.1.m1.1.1.2.3.2.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.3.2">𝑠</ci><ci id="S3.E4X.2.1.1.m1.1.1.2.3.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.3.3">𝑖</ci><ci id="S3.E4X.2.1.1.m1.1.1.2.3.4.cmml" xref="S3.E4X.2.1.1.m1.1.1.2.3.4">𝑑</ci></apply></apply><ci id="S3.E4X.2.1.1.m1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.1c">\displaystyle\bm{e}_{sid}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.E4X.2.1.1.m1.1d">bold_italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(\bm{E}_{sid}^{i})^{\top}\bm{1}_{x_{sid}},\mathrm{~{}}\forall i%
\in\{1,2,...,M\}," class="ltx_Math" display="inline" id="S3.E4X.3.2.2.m1.5"><semantics id="S3.E4X.3.2.2.m1.5a"><mrow id="S3.E4X.3.2.2.m1.5.5.1"><mrow id="S3.E4X.3.2.2.m1.5.5.1.1.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.3.cmml"><mrow id="S3.E4X.3.2.2.m1.5.5.1.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.cmml"><mi id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.3.cmml"></mi><mo id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.2.cmml">=</mo><mrow id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.cmml"><msup id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">𝑬</mi><mrow id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi><mo id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1a" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.4" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.4.cmml">d</mi></mrow><mi id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.cmml"><mn id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.2.cmml">𝟏</mn><msub id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.cmml"><mi id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.2.cmml">x</mi><mrow id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.2.cmml">s</mi><mo id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.1" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.3" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.3.cmml">i</mi><mo id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.1a" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.4" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.4.cmml">d</mi></mrow></msub></msub></mrow></mrow><mo id="S3.E4X.3.2.2.m1.5.5.1.1.2.3" rspace="0.497em" xref="S3.E4X.3.2.2.m1.5.5.1.1.3a.cmml">,</mo><mrow id="S3.E4X.3.2.2.m1.5.5.1.1.2.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.cmml"><mrow id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2.cmml"><mo id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2.1" rspace="0.167em" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2.1.cmml">∀</mo><mi id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2.2.cmml">i</mi></mrow><mo id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.1" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.1.cmml">∈</mo><mrow id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml"><mo id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.2.1" stretchy="false" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml">{</mo><mn id="S3.E4X.3.2.2.m1.1.1" xref="S3.E4X.3.2.2.m1.1.1.cmml">1</mn><mo id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.2.2" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mn id="S3.E4X.3.2.2.m1.2.2" xref="S3.E4X.3.2.2.m1.2.2.cmml">2</mn><mo id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.2.3" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E4X.3.2.2.m1.3.3" mathvariant="normal" xref="S3.E4X.3.2.2.m1.3.3.cmml">…</mi><mo id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.2.4" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E4X.3.2.2.m1.4.4" xref="S3.E4X.3.2.2.m1.4.4.cmml">M</mi><mo id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.2.5" stretchy="false" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><mo id="S3.E4X.3.2.2.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.3.2.2.m1.5b"><apply id="S3.E4X.3.2.2.m1.5.5.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.5.5.1.1.3a.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1"><eq id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.3">absent</csymbol><apply id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1"><times id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.2"></times><apply id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2">𝑬</ci><apply id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci><ci id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.4">𝑑</ci></apply></apply><ci id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.1.3">top</csymbol></apply><apply id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3">subscript</csymbol><cn id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.2">1</cn><apply id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.2">𝑥</ci><apply id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3"><times id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.1"></times><ci id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.2">𝑠</ci><ci id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.3">𝑖</ci><ci id="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.4.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.1.1.1.3.3.3.4">𝑑</ci></apply></apply></apply></apply></apply><apply id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2"><in id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.1"></in><apply id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2"><csymbol cd="latexml" id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2.1">for-all</csymbol><ci id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.2.2">𝑖</ci></apply><set id="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.5.5.1.1.2.2.3.2"><cn id="S3.E4X.3.2.2.m1.1.1.cmml" type="integer" xref="S3.E4X.3.2.2.m1.1.1">1</cn><cn id="S3.E4X.3.2.2.m1.2.2.cmml" type="integer" xref="S3.E4X.3.2.2.m1.2.2">2</cn><ci id="S3.E4X.3.2.2.m1.3.3.cmml" xref="S3.E4X.3.2.2.m1.3.3">…</ci><ci id="S3.E4X.3.2.2.m1.4.4.cmml" xref="S3.E4X.3.2.2.m1.4.4">𝑀</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.3.2.2.m1.5c">\displaystyle=(\bm{E}_{sid}^{i})^{\top}\bm{1}_{x_{sid}},\mathrm{~{}}\forall i%
\in\{1,2,...,M\},</annotation><annotation encoding="application/x-llamapun" id="S3.E4X.3.2.2.m1.5d">= ( bold_italic_E start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT end_POSTSUBSCRIPT , ∀ italic_i ∈ { 1 , 2 , … , italic_M } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E4Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h" class="ltx_Math" display="inline" id="S3.E4Xa.2.1.1.m1.1"><semantics id="S3.E4Xa.2.1.1.m1.1a"><mi id="S3.E4Xa.2.1.1.m1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.E4Xa.2.1.1.m1.1b"><ci id="S3.E4Xa.2.1.1.m1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E4Xa.2.1.1.m1.1c">\displaystyle h</annotation><annotation encoding="application/x-llamapun" id="S3.E4Xa.2.1.1.m1.1d">italic_h</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=I(\bm{e}_{1},\bm{e}_{2},...,\bm{e}_{n},\bm{e}_{sid}^{1},...,\bm{%
e}_{sid}^{M})." class="ltx_Math" display="inline" id="S3.E4Xa.3.2.2.m1.3"><semantics id="S3.E4Xa.3.2.2.m1.3a"><mrow id="S3.E4Xa.3.2.2.m1.3.3.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.cmml"><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.7" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.7.cmml"></mi><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.6" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.6.cmml">=</mo><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1.5" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.7" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.7.cmml">I</mi><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.6" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.6.cmml">⁢</mo><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml"><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.6" stretchy="false" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">(</mo><msub id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">𝒆</mi><mn id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.7" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><msub id="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.cmml">𝒆</mi><mn id="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.8" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><mi id="S3.E4Xa.3.2.2.m1.1.1" mathvariant="normal" xref="S3.E4Xa.3.2.2.m1.1.1.cmml">…</mi><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.9" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><msub id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3.2.cmml">𝒆</mi><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.cmml">n</mi></msub><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.10" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><msubsup id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.2.cmml">𝒆</mi><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.2.cmml">s</mi><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.3.cmml">i</mi><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.1a" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.4" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.4.cmml">d</mi></mrow><mn id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.cmml">1</mn></msubsup><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.11" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><mi id="S3.E4Xa.3.2.2.m1.2.2" mathvariant="normal" xref="S3.E4Xa.3.2.2.m1.2.2.cmml">…</mi><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.12" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><msubsup id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.2.cmml">𝒆</mi><mrow id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.cmml"><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.2" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.2.cmml">s</mi><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.1" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.1.cmml">⁢</mo><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.3.cmml">i</mi><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.1a" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.1.cmml">⁢</mo><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.4" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.4.cmml">d</mi></mrow><mi id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.cmml">M</mi></msubsup><mo id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.13" stretchy="false" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4Xa.3.2.2.m1.3.3.1.2" lspace="0em" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4Xa.3.2.2.m1.3b"><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1"><eq id="S3.E4Xa.3.2.2.m1.3.3.1.1.6.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.6"></eq><csymbol cd="latexml" id="S3.E4Xa.3.2.2.m1.3.3.1.1.7.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.7">absent</csymbol><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5"><times id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.6.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.6"></times><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.7.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.7">𝐼</ci><vector id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5"><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2">𝒆</ci><cn id="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2">𝒆</ci><cn id="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.2.2.2.2.3">2</cn></apply><ci id="S3.E4Xa.3.2.2.m1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1">…</ci><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3.2">𝒆</ci><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3">𝑛</ci></apply><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4">superscript</csymbol><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4">subscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.2">𝒆</ci><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3"><times id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.1"></times><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.2">𝑠</ci><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.3">𝑖</ci><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.4.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.3.4">𝑑</ci></apply></apply><cn id="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.cmml" type="integer" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3">1</cn></apply><ci id="S3.E4Xa.3.2.2.m1.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.2.2">…</ci><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5">superscript</csymbol><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5">subscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.2">𝒆</ci><apply id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3"><times id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.1.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.1"></times><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.2.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.2">𝑠</ci><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.3">𝑖</ci><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.4.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.3.4">𝑑</ci></apply></apply><ci id="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.cmml" xref="S3.E4Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3">𝑀</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4Xa.3.2.2.m1.3c">\displaystyle=I(\bm{e}_{1},\bm{e}_{2},...,\bm{e}_{n},\bm{e}_{sid}^{1},...,\bm{%
e}_{sid}^{M}).</annotation><annotation encoding="application/x-llamapun" id="S3.E4Xa.3.2.2.m1.3d">= italic_I ( bold_italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_italic_e start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , bold_italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , bold_italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.1.1">RQ-VAE (<em class="ltx_emph ltx_font_italic" id="S3.SS2.p3.1.1.1">i.e.</em>, Multiple Hierarchical Codebooks and Multi-Embeddings).</span>
RQ-VAE is a common practice for deriving Semantic IDs in recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib19" title="">2024</a>; Jin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib12" title="">2023</a>; Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib27" title="">2024</a>)</cite>. It applies quantization on residuals at multiple levels with different codebooks. The reconstructed target in the next level is the residual representation in the current level:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E5X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z_{i}}^{\mathbf{q}}" class="ltx_Math" display="inline" id="S3.E5X.2.1.1.m1.1"><semantics id="S3.E5X.2.1.1.m1.1a"><mmultiscripts id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.2.2" xref="S3.E5X.2.1.1.m1.1.1.2.2.cmml">𝐳</mi><mi id="S3.E5X.2.1.1.m1.1.1.2.3" xref="S3.E5X.2.1.1.m1.1.1.2.3.cmml">𝐢</mi><mrow id="S3.E5X.2.1.1.m1.1.1a" xref="S3.E5X.2.1.1.m1.1.1.cmml"></mrow><mrow id="S3.E5X.2.1.1.m1.1.1b" xref="S3.E5X.2.1.1.m1.1.1.cmml"></mrow><mi id="S3.E5X.2.1.1.m1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.3.cmml">𝐪</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><apply id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1">superscript</csymbol><apply id="S3.E5X.2.1.1.m1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.2.1.cmml" xref="S3.E5X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.2.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.2">𝐳</ci><ci id="S3.E5X.2.1.1.m1.1.1.2.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.2.3">𝐢</ci></apply><ci id="S3.E5X.2.1.1.m1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3">𝐪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\mathbf{z_{i}}^{\mathbf{q}}</annotation><annotation encoding="application/x-llamapun" id="S3.E5X.2.1.1.m1.1d">bold_z start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT bold_q end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname*{\arg\min}_{z_{k}\in Z_{i}}\|\mathbf{z_{i}}-z_{k}%
\|_{2}^{2}," class="ltx_Math" display="inline" id="S3.E5X.3.2.2.m1.1"><semantics id="S3.E5X.3.2.2.m1.1a"><mrow id="S3.E5X.3.2.2.m1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.3.cmml"></mi><mo id="S3.E5X.3.2.2.m1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml"><munder id="S3.E5X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.1.cmml">arg</mi><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2a" lspace="0.167em" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.cmml">⁡</mo><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.2.cmml">min</mi></mrow><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.cmml"><msub id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2.2.cmml">z</mi><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2.3.cmml">k</mi></msub><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3.2.cmml">Z</mi><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3.3.cmml">i</mi></msub></mrow></munder><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1a" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml">⁡</mo><msubsup id="S3.E5X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">𝐢</mi></msub><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">z</mi><mi id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S3.E5X.3.2.2.m1.1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.1b"><apply id="S3.E5X.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1"><eq id="S3.E5X.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.3">absent</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1"><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2"><arg id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.1"></arg><min id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.2.2"></min></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3"><in id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.1"></in><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2.2">𝑧</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.2.3">𝑘</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3.2">𝑍</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝐢</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑧</ci><ci id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><cn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.1.3">2</cn></apply><cn id="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E5X.3.2.2.m1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.1c">\displaystyle=\operatorname*{\arg\min}_{z_{k}\in Z_{i}}\|\mathbf{z_{i}}-z_{k}%
\|_{2}^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E5X.3.2.2.m1.1d">= start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ italic_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ bold_z start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT - italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E5Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z_{i+1}}" class="ltx_Math" display="inline" id="S3.E5Xa.2.1.1.m1.1"><semantics id="S3.E5Xa.2.1.1.m1.1a"><msub id="S3.E5Xa.2.1.1.m1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.2.cmml">𝐳</mi><mrow id="S3.E5Xa.2.1.1.m1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.3.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.3.2" xref="S3.E5Xa.2.1.1.m1.1.1.3.2.cmml">𝐢</mi><mo id="S3.E5Xa.2.1.1.m1.1.1.3.1" xref="S3.E5Xa.2.1.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.E5Xa.2.1.1.m1.1.1.3.3" xref="S3.E5Xa.2.1.1.m1.1.1.3.3.cmml">𝟏</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.1b"><apply id="S3.E5Xa.2.1.1.m1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2">𝐳</ci><apply id="S3.E5Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3"><plus id="S3.E5Xa.2.1.1.m1.1.1.3.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3.1"></plus><ci id="S3.E5Xa.2.1.1.m1.1.1.3.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3.2">𝐢</ci><cn id="S3.E5Xa.2.1.1.m1.1.1.3.3.cmml" type="integer" xref="S3.E5Xa.2.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.1c">\displaystyle\mathbf{z_{i+1}}</annotation><annotation encoding="application/x-llamapun" id="S3.E5Xa.2.1.1.m1.1d">bold_z start_POSTSUBSCRIPT bold_i + bold_1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbf{z_{i}}-\mathbf{z_{i}}^{\mathbf{q}}." class="ltx_Math" display="inline" id="S3.E5Xa.3.2.2.m1.1"><semantics id="S3.E5Xa.3.2.2.m1.1a"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml"><msub id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml">𝐳</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml">𝐢</mi></msub><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.1.cmml">−</mo><mmultiscripts id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.2.2.cmml">𝐳</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.2.3.cmml">𝐢</mi><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3a" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.cmml"></mrow><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3b" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.cmml"></mrow><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.3.cmml">𝐪</mi></mmultiscripts></mrow></mrow><mo id="S3.E5Xa.3.2.2.m1.1.1.1.2" lspace="0em" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.3.2.2.m1.1b"><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1"><eq id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2">absent</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3"><minus id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.1"></minus><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.2">𝐳</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.3">𝐢</ci></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.2.2">𝐳</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.2.3">𝐢</ci></apply><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.3">𝐪</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.3.2.2.m1.1c">\displaystyle=\mathbf{z_{i}}-\mathbf{z_{i}}^{\mathbf{q}}.</annotation><annotation encoding="application/x-llamapun" id="S3.E5Xa.3.2.2.m1.1d">= bold_z start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT - bold_z start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT bold_q end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.2">Due to the hierarchical design of RQ-VAE, the Semantic IDs obtained from the codebooks are highly dependent and entangled.
With <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_M</annotation></semantics></math> levels of hierarchical Semantic IDs <math alttext="\{x_{sid_{i}}\}_{i=1}^{M}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><msubsup id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mrow id="S3.SS2.p4.2.m2.1.1.1.1.1" xref="S3.SS2.p4.2.m2.1.1.1.1.2.cmml"><mo id="S3.SS2.p4.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p4.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.p4.2.m2.1.1.1.1.1.1" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.2" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.2.cmml">s</mi><mo id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.1" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.3" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.3.cmml">i</mi><mo id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.1a" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4.cmml"><mi id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4.2" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4.2.cmml">d</mi><mi id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4.3" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4.3.cmml">i</mi></msub></mrow></msub><mo id="S3.SS2.p4.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p4.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p4.2.m2.1.1.1.3" xref="S3.SS2.p4.2.m2.1.1.1.3.cmml"><mi id="S3.SS2.p4.2.m2.1.1.1.3.2" xref="S3.SS2.p4.2.m2.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p4.2.m2.1.1.1.3.1" xref="S3.SS2.p4.2.m2.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p4.2.m2.1.1.1.3.3" xref="S3.SS2.p4.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">M</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><set id="S3.SS2.p4.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1"><apply id="S3.SS2.p4.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3"><times id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.1"></times><ci id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.3">𝑖</ci><apply id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4.2.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4.2">𝑑</ci><ci id="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4.3.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1.1.1.3.4.3">𝑖</ci></apply></apply></apply></set><apply id="S3.SS2.p4.2.m2.1.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.1.3"><eq id="S3.SS2.p4.2.m2.1.1.1.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1.3.1"></eq><ci id="S3.SS2.p4.2.m2.1.1.1.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.1.3.2">𝑖</ci><cn id="S3.SS2.p4.2.m2.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.p4.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\{x_{sid_{i}}\}_{i=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">{ italic_x start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>, it is practical to utilize to scale the Semantic Representation as follows.</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E6">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E6X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\bm{e}_{sid_{i}}" class="ltx_Math" display="inline" id="S3.E6X.2.1.1.m1.1"><semantics id="S3.E6X.2.1.1.m1.1a"><msub id="S3.E6X.2.1.1.m1.1.1" xref="S3.E6X.2.1.1.m1.1.1.cmml"><mi id="S3.E6X.2.1.1.m1.1.1.2" xref="S3.E6X.2.1.1.m1.1.1.2.cmml">𝒆</mi><mrow id="S3.E6X.2.1.1.m1.1.1.3" xref="S3.E6X.2.1.1.m1.1.1.3.cmml"><mi id="S3.E6X.2.1.1.m1.1.1.3.2" xref="S3.E6X.2.1.1.m1.1.1.3.2.cmml">s</mi><mo id="S3.E6X.2.1.1.m1.1.1.3.1" xref="S3.E6X.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6X.2.1.1.m1.1.1.3.3" xref="S3.E6X.2.1.1.m1.1.1.3.3.cmml">i</mi><mo id="S3.E6X.2.1.1.m1.1.1.3.1a" xref="S3.E6X.2.1.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S3.E6X.2.1.1.m1.1.1.3.4" xref="S3.E6X.2.1.1.m1.1.1.3.4.cmml"><mi id="S3.E6X.2.1.1.m1.1.1.3.4.2" xref="S3.E6X.2.1.1.m1.1.1.3.4.2.cmml">d</mi><mi id="S3.E6X.2.1.1.m1.1.1.3.4.3" xref="S3.E6X.2.1.1.m1.1.1.3.4.3.cmml">i</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E6X.2.1.1.m1.1b"><apply id="S3.E6X.2.1.1.m1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.2">𝒆</ci><apply id="S3.E6X.2.1.1.m1.1.1.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.3"><times id="S3.E6X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.3.1"></times><ci id="S3.E6X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.3.2">𝑠</ci><ci id="S3.E6X.2.1.1.m1.1.1.3.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.3.3">𝑖</ci><apply id="S3.E6X.2.1.1.m1.1.1.3.4.cmml" xref="S3.E6X.2.1.1.m1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.1.1.3.4.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.3.4">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.1.1.3.4.2.cmml" xref="S3.E6X.2.1.1.m1.1.1.3.4.2">𝑑</ci><ci id="S3.E6X.2.1.1.m1.1.1.3.4.3.cmml" xref="S3.E6X.2.1.1.m1.1.1.3.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6X.2.1.1.m1.1c">\displaystyle\bm{e}_{sid_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.E6X.2.1.1.m1.1d">bold_italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=(\bm{E}_{sid_{i}})^{\top}\bm{1}_{x_{sid_{i}}},\mathrm{~{}}%
\forall i\in\{1,2,...,M\}" class="ltx_Math" display="inline" id="S3.E6X.3.2.2.m1.6"><semantics id="S3.E6X.3.2.2.m1.6a"><mrow id="S3.E6X.3.2.2.m1.6.6.2" xref="S3.E6X.3.2.2.m1.6.6.3.cmml"><mrow id="S3.E6X.3.2.2.m1.5.5.1.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.3.cmml"></mi><mo id="S3.E6X.3.2.2.m1.5.5.1.1.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.cmml"><msup id="S3.E6X.3.2.2.m1.5.5.1.1.1.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.cmml"><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.cmml">𝑬</mi><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.3.cmml">i</mi><mo id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.1a" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4.2.cmml">d</mi><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4.3.cmml">i</mi></msub></mrow></msub><mo id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.E6X.3.2.2.m1.5.5.1.1.1.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.2.cmml">⁢</mo><msub id="S3.E6X.3.2.2.m1.5.5.1.1.1.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.cmml"><mn id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.cmml">𝟏</mn><msub id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.2.cmml">x</mi><mrow id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.2.cmml">s</mi><mo id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.1" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.3.cmml">i</mi><mo id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.1a" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.1.cmml">⁢</mo><msub id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4.cmml"><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4.2" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4.2.cmml">d</mi><mi id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4.3" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4.3.cmml">i</mi></msub></mrow></msub></msub></mrow></mrow><mo id="S3.E6X.3.2.2.m1.6.6.2.3" rspace="0.497em" xref="S3.E6X.3.2.2.m1.6.6.3a.cmml">,</mo><mrow id="S3.E6X.3.2.2.m1.6.6.2.2" xref="S3.E6X.3.2.2.m1.6.6.2.2.cmml"><mrow id="S3.E6X.3.2.2.m1.6.6.2.2.2" xref="S3.E6X.3.2.2.m1.6.6.2.2.2.cmml"><mo id="S3.E6X.3.2.2.m1.6.6.2.2.2.1" rspace="0.167em" xref="S3.E6X.3.2.2.m1.6.6.2.2.2.1.cmml">∀</mo><mi id="S3.E6X.3.2.2.m1.6.6.2.2.2.2" xref="S3.E6X.3.2.2.m1.6.6.2.2.2.2.cmml">i</mi></mrow><mo id="S3.E6X.3.2.2.m1.6.6.2.2.1" xref="S3.E6X.3.2.2.m1.6.6.2.2.1.cmml">∈</mo><mrow id="S3.E6X.3.2.2.m1.6.6.2.2.3.2" xref="S3.E6X.3.2.2.m1.6.6.2.2.3.1.cmml"><mo id="S3.E6X.3.2.2.m1.6.6.2.2.3.2.1" stretchy="false" xref="S3.E6X.3.2.2.m1.6.6.2.2.3.1.cmml">{</mo><mn id="S3.E6X.3.2.2.m1.1.1" xref="S3.E6X.3.2.2.m1.1.1.cmml">1</mn><mo id="S3.E6X.3.2.2.m1.6.6.2.2.3.2.2" xref="S3.E6X.3.2.2.m1.6.6.2.2.3.1.cmml">,</mo><mn id="S3.E6X.3.2.2.m1.2.2" xref="S3.E6X.3.2.2.m1.2.2.cmml">2</mn><mo id="S3.E6X.3.2.2.m1.6.6.2.2.3.2.3" xref="S3.E6X.3.2.2.m1.6.6.2.2.3.1.cmml">,</mo><mi id="S3.E6X.3.2.2.m1.3.3" mathvariant="normal" xref="S3.E6X.3.2.2.m1.3.3.cmml">…</mi><mo id="S3.E6X.3.2.2.m1.6.6.2.2.3.2.4" xref="S3.E6X.3.2.2.m1.6.6.2.2.3.1.cmml">,</mo><mi id="S3.E6X.3.2.2.m1.4.4" xref="S3.E6X.3.2.2.m1.4.4.cmml">M</mi><mo id="S3.E6X.3.2.2.m1.6.6.2.2.3.2.5" stretchy="false" xref="S3.E6X.3.2.2.m1.6.6.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6X.3.2.2.m1.6b"><apply id="S3.E6X.3.2.2.m1.6.6.3.cmml" xref="S3.E6X.3.2.2.m1.6.6.2"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.6.6.3a.cmml" xref="S3.E6X.3.2.2.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S3.E6X.3.2.2.m1.5.5.1.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1"><eq id="S3.E6X.3.2.2.m1.5.5.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.2"></eq><csymbol cd="latexml" id="S3.E6X.3.2.2.m1.5.5.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.3">absent</csymbol><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1"><times id="S3.E6X.3.2.2.m1.5.5.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.2"></times><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1">superscript</csymbol><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2">𝑬</ci><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3"><times id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.3">𝑖</ci><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4.2">𝑑</ci><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3.4.3">𝑖</ci></apply></apply></apply><csymbol cd="latexml" id="S3.E6X.3.2.2.m1.5.5.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.1.3">top</csymbol></apply><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3">subscript</csymbol><cn id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2.cmml" type="integer" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.2">1</cn><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3">subscript</csymbol><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.2">𝑥</ci><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3"><times id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.1"></times><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.2">𝑠</ci><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.3">𝑖</ci><apply id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4.1.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4">subscript</csymbol><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4.2.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4.2">𝑑</ci><ci id="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4.3.cmml" xref="S3.E6X.3.2.2.m1.5.5.1.1.1.3.3.3.4.3">𝑖</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E6X.3.2.2.m1.6.6.2.2.cmml" xref="S3.E6X.3.2.2.m1.6.6.2.2"><in id="S3.E6X.3.2.2.m1.6.6.2.2.1.cmml" xref="S3.E6X.3.2.2.m1.6.6.2.2.1"></in><apply id="S3.E6X.3.2.2.m1.6.6.2.2.2.cmml" xref="S3.E6X.3.2.2.m1.6.6.2.2.2"><csymbol cd="latexml" id="S3.E6X.3.2.2.m1.6.6.2.2.2.1.cmml" xref="S3.E6X.3.2.2.m1.6.6.2.2.2.1">for-all</csymbol><ci id="S3.E6X.3.2.2.m1.6.6.2.2.2.2.cmml" xref="S3.E6X.3.2.2.m1.6.6.2.2.2.2">𝑖</ci></apply><set id="S3.E6X.3.2.2.m1.6.6.2.2.3.1.cmml" xref="S3.E6X.3.2.2.m1.6.6.2.2.3.2"><cn id="S3.E6X.3.2.2.m1.1.1.cmml" type="integer" xref="S3.E6X.3.2.2.m1.1.1">1</cn><cn id="S3.E6X.3.2.2.m1.2.2.cmml" type="integer" xref="S3.E6X.3.2.2.m1.2.2">2</cn><ci id="S3.E6X.3.2.2.m1.3.3.cmml" xref="S3.E6X.3.2.2.m1.3.3">…</ci><ci id="S3.E6X.3.2.2.m1.4.4.cmml" xref="S3.E6X.3.2.2.m1.4.4">𝑀</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6X.3.2.2.m1.6c">\displaystyle=(\bm{E}_{sid_{i}})^{\top}\bm{1}_{x_{sid_{i}}},\mathrm{~{}}%
\forall i\in\{1,2,...,M\}</annotation><annotation encoding="application/x-llamapun" id="S3.E6X.3.2.2.m1.6d">= ( bold_italic_E start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT , ∀ italic_i ∈ { 1 , 2 , … , italic_M }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E6Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h" class="ltx_Math" display="inline" id="S3.E6Xa.2.1.1.m1.1"><semantics id="S3.E6Xa.2.1.1.m1.1a"><mi id="S3.E6Xa.2.1.1.m1.1.1" xref="S3.E6Xa.2.1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.E6Xa.2.1.1.m1.1b"><ci id="S3.E6Xa.2.1.1.m1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E6Xa.2.1.1.m1.1c">\displaystyle h</annotation><annotation encoding="application/x-llamapun" id="S3.E6Xa.2.1.1.m1.1d">italic_h</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=I(\bm{e}_{1},\bm{e}_{2},...,\bm{e}_{n},\bm{e}_{sid_{1}},...,\bm{%
e}_{sid_{M}})." class="ltx_Math" display="inline" id="S3.E6Xa.3.2.2.m1.3"><semantics id="S3.E6Xa.3.2.2.m1.3a"><mrow id="S3.E6Xa.3.2.2.m1.3.3.1" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.cmml"><mrow id="S3.E6Xa.3.2.2.m1.3.3.1.1" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.7" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.7.cmml"></mi><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.6" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.6.cmml">=</mo><mrow id="S3.E6Xa.3.2.2.m1.3.3.1.1.5" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.7" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.7.cmml">I</mi><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.6" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.6.cmml">⁢</mo><mrow id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml"><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.6" stretchy="false" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">(</mo><msub id="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">𝒆</mi><mn id="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.7" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><msub id="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.cmml">𝒆</mi><mn id="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2.3" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.8" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><mi id="S3.E6Xa.3.2.2.m1.1.1" mathvariant="normal" xref="S3.E6Xa.3.2.2.m1.1.1.cmml">…</mi><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.9" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><msub id="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3.2" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3.2.cmml">𝒆</mi><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.cmml">n</mi></msub><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.10" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><msub id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.cmml">𝒆</mi><mrow id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.2" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.2.cmml">s</mi><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.1" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.1.cmml">⁢</mo><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.3" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.3.cmml">i</mi><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.1a" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.1.cmml">⁢</mo><msub id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4.2" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4.2.cmml">d</mi><mn id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4.3" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4.3.cmml">1</mn></msub></mrow></msub><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.11" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><mi id="S3.E6Xa.3.2.2.m1.2.2" mathvariant="normal" xref="S3.E6Xa.3.2.2.m1.2.2.cmml">…</mi><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.12" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">,</mo><msub id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.cmml">𝒆</mi><mrow id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.2" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.2.cmml">s</mi><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.1" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.1.cmml">⁢</mo><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.3" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.3.cmml">i</mi><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.1a" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.1.cmml">⁢</mo><msub id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4.2" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4.2.cmml">d</mi><mi id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4.3" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4.3.cmml">M</mi></msub></mrow></msub><mo id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.13" stretchy="false" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6Xa.3.2.2.m1.3.3.1.2" lspace="0em" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6Xa.3.2.2.m1.3b"><apply id="S3.E6Xa.3.2.2.m1.3.3.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1"><eq id="S3.E6Xa.3.2.2.m1.3.3.1.1.6.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.6"></eq><csymbol cd="latexml" id="S3.E6Xa.3.2.2.m1.3.3.1.1.7.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.7">absent</csymbol><apply id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5"><times id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.6.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.6"></times><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.7.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.7">𝐼</ci><vector id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.6.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5"><apply id="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2">𝒆</ci><cn id="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2">𝒆</ci><cn id="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.2.2.2.2.3">2</cn></apply><ci id="S3.E6Xa.3.2.2.m1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1">…</ci><apply id="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3.2">𝒆</ci><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.3.3.3.3.3">𝑛</ci></apply><apply id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4">subscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.2">𝒆</ci><apply id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3"><times id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.1"></times><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.2">𝑠</ci><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.3.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.3">𝑖</ci><apply id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4">subscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4.2">𝑑</ci><cn id="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4.3.cmml" type="integer" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.4.4.4.4.3.4.3">1</cn></apply></apply></apply><ci id="S3.E6Xa.3.2.2.m1.2.2.cmml" xref="S3.E6Xa.3.2.2.m1.2.2">…</ci><apply id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5">subscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.2">𝒆</ci><apply id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3"><times id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.1"></times><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.2">𝑠</ci><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.3.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.3">𝑖</ci><apply id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4">subscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4.2">𝑑</ci><ci id="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4.3.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.1.1.5.5.5.5.3.4.3">𝑀</ci></apply></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6Xa.3.2.2.m1.3c">\displaystyle=I(\bm{e}_{1},\bm{e}_{2},...,\bm{e}_{n},\bm{e}_{sid_{1}},...,\bm{%
e}_{sid_{M}}).</annotation><annotation encoding="application/x-llamapun" id="S3.E6Xa.3.2.2.m1.3d">= italic_I ( bold_italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_italic_e start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , bold_italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , bold_italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<figure class="ltx_figure" id="S3.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S3.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="535" id="S3.F3.sf1.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>NMI w.r.t. Semantic ID.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S3.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="534" id="S3.F3.sf2.g1" src="x6.png" width="831"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>NMI w.r.t. Semantic Representation.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Normalized Mutual Information(NMI) of Semantic Representation with 7x scaling factor. </figcaption>
</figure>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="584" id="S3.F4.sf1.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>3x scaling factor.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="614" id="S3.F4.sf2.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>5x scaling factor.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="602" id="S3.F4.sf3.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>7x scaling factor.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Scalability of Dimension Robustness regarding different scaling factors. Each figure presents the singular spectrum of the semantic representation at the given scaling factor.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Measurement on Scalability of Semantic Representation</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Below we present two ways to quantify the scalability of semantic representations, one from a discriminability perspective and another from a dimension robustness perspective.</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="373" id="S3.F5.g1" src="x10.png" width="746"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text ltx_font_bold" id="S3.F5.2.1">Comparison among Multi-Embedding VQ, RQ-VAE and Mixture-of-Codes. The codebooks with deeper color contain more information relevant to the input data. (a) Multi-Embedding VQ builds independent embeddings for a single set of semantic IDs and is equivalent to perform index copying for downstream models. (b) RQ-VAE utilizes hierarchical codebooks and high-level semantic IDs are less informative. (c) Our Mixture-of-Codes uses parallel codebooks to capture important semantics in the original LLM space and employs a fusion network for better generalization in downstream tasks.</span>
</figcaption>
</figure>
<div class="ltx_theorem ltx_theorem_definition" id="S3.Thmdefinition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmdefinition1.1.1.1">Definition 3.1</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmdefinition1.2.2"> </span>(Discriminability Scalability of Semantic Representation)<span class="ltx_text ltx_font_bold" id="S3.Thmdefinition1.3.3">.</span>
</h6>
<div class="ltx_para" id="S3.Thmdefinition1.p1">
<p class="ltx_p" id="S3.Thmdefinition1.p1.5">With each scaling factors from <math alttext="1" class="ltx_Math" display="inline" id="S3.Thmdefinition1.p1.1.m1.1"><semantics id="S3.Thmdefinition1.p1.1.m1.1a"><mn id="S3.Thmdefinition1.p1.1.m1.1.1" xref="S3.Thmdefinition1.p1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.Thmdefinition1.p1.1.m1.1b"><cn id="S3.Thmdefinition1.p1.1.m1.1.1.cmml" type="integer" xref="S3.Thmdefinition1.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmdefinition1.p1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.Thmdefinition1.p1.1.m1.1d">1</annotation></semantics></math>x to <math alttext="M" class="ltx_Math" display="inline" id="S3.Thmdefinition1.p1.2.m2.1"><semantics id="S3.Thmdefinition1.p1.2.m2.1a"><mi id="S3.Thmdefinition1.p1.2.m2.1.1" xref="S3.Thmdefinition1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.Thmdefinition1.p1.2.m2.1b"><ci id="S3.Thmdefinition1.p1.2.m2.1.1.cmml" xref="S3.Thmdefinition1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmdefinition1.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.Thmdefinition1.p1.2.m2.1d">italic_M</annotation></semantics></math>x,
the discriminability of a Semantic Representation in the continuous space is defined as the mutual information between its quantized representation <math alttext="Q(\bm{r})" class="ltx_Math" display="inline" id="S3.Thmdefinition1.p1.3.m3.1"><semantics id="S3.Thmdefinition1.p1.3.m3.1a"><mrow id="S3.Thmdefinition1.p1.3.m3.1.2" xref="S3.Thmdefinition1.p1.3.m3.1.2.cmml"><mi id="S3.Thmdefinition1.p1.3.m3.1.2.2" xref="S3.Thmdefinition1.p1.3.m3.1.2.2.cmml">Q</mi><mo id="S3.Thmdefinition1.p1.3.m3.1.2.1" xref="S3.Thmdefinition1.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.Thmdefinition1.p1.3.m3.1.2.3.2" xref="S3.Thmdefinition1.p1.3.m3.1.2.cmml"><mo id="S3.Thmdefinition1.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S3.Thmdefinition1.p1.3.m3.1.2.cmml">(</mo><mi id="S3.Thmdefinition1.p1.3.m3.1.1" xref="S3.Thmdefinition1.p1.3.m3.1.1.cmml">𝒓</mi><mo id="S3.Thmdefinition1.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S3.Thmdefinition1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmdefinition1.p1.3.m3.1b"><apply id="S3.Thmdefinition1.p1.3.m3.1.2.cmml" xref="S3.Thmdefinition1.p1.3.m3.1.2"><times id="S3.Thmdefinition1.p1.3.m3.1.2.1.cmml" xref="S3.Thmdefinition1.p1.3.m3.1.2.1"></times><ci id="S3.Thmdefinition1.p1.3.m3.1.2.2.cmml" xref="S3.Thmdefinition1.p1.3.m3.1.2.2">𝑄</ci><ci id="S3.Thmdefinition1.p1.3.m3.1.1.cmml" xref="S3.Thmdefinition1.p1.3.m3.1.1">𝒓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmdefinition1.p1.3.m3.1c">Q(\bm{r})</annotation><annotation encoding="application/x-llamapun" id="S3.Thmdefinition1.p1.3.m3.1d">italic_Q ( bold_italic_r )</annotation></semantics></math> and the supervised label in the downstream tasks <math alttext="Y" class="ltx_Math" display="inline" id="S3.Thmdefinition1.p1.4.m4.1"><semantics id="S3.Thmdefinition1.p1.4.m4.1a"><mi id="S3.Thmdefinition1.p1.4.m4.1.1" xref="S3.Thmdefinition1.p1.4.m4.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.Thmdefinition1.p1.4.m4.1b"><ci id="S3.Thmdefinition1.p1.4.m4.1.1.cmml" xref="S3.Thmdefinition1.p1.4.m4.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmdefinition1.p1.4.m4.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S3.Thmdefinition1.p1.4.m4.1d">italic_Y</annotation></semantics></math>, <em class="ltx_emph ltx_font_italic" id="S3.Thmdefinition1.p1.5.1">i.e.</em>, <math alttext="\text{MI}(Q(\bm{r}),Y)" class="ltx_Math" display="inline" id="S3.Thmdefinition1.p1.5.m5.3"><semantics id="S3.Thmdefinition1.p1.5.m5.3a"><mrow id="S3.Thmdefinition1.p1.5.m5.3.3" xref="S3.Thmdefinition1.p1.5.m5.3.3.cmml"><mtext id="S3.Thmdefinition1.p1.5.m5.3.3.3" xref="S3.Thmdefinition1.p1.5.m5.3.3.3a.cmml">MI</mtext><mo id="S3.Thmdefinition1.p1.5.m5.3.3.2" xref="S3.Thmdefinition1.p1.5.m5.3.3.2.cmml">⁢</mo><mrow id="S3.Thmdefinition1.p1.5.m5.3.3.1.1" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.2.cmml"><mo id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.2" stretchy="false" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.2.cmml">(</mo><mrow id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.cmml"><mi id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.2" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.2.cmml">Q</mi><mo id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.1" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.3.2" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.cmml"><mo id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.3.2.1" stretchy="false" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.cmml">(</mo><mi id="S3.Thmdefinition1.p1.5.m5.1.1" xref="S3.Thmdefinition1.p1.5.m5.1.1.cmml">𝒓</mi><mo id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.3.2.2" stretchy="false" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.3" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.2.cmml">,</mo><mi id="S3.Thmdefinition1.p1.5.m5.2.2" xref="S3.Thmdefinition1.p1.5.m5.2.2.cmml">Y</mi><mo id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.4" stretchy="false" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmdefinition1.p1.5.m5.3b"><apply id="S3.Thmdefinition1.p1.5.m5.3.3.cmml" xref="S3.Thmdefinition1.p1.5.m5.3.3"><times id="S3.Thmdefinition1.p1.5.m5.3.3.2.cmml" xref="S3.Thmdefinition1.p1.5.m5.3.3.2"></times><ci id="S3.Thmdefinition1.p1.5.m5.3.3.3a.cmml" xref="S3.Thmdefinition1.p1.5.m5.3.3.3"><mtext id="S3.Thmdefinition1.p1.5.m5.3.3.3.cmml" xref="S3.Thmdefinition1.p1.5.m5.3.3.3">MI</mtext></ci><interval closure="open" id="S3.Thmdefinition1.p1.5.m5.3.3.1.2.cmml" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.1"><apply id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.cmml" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1"><times id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.1"></times><ci id="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.Thmdefinition1.p1.5.m5.3.3.1.1.1.2">𝑄</ci><ci id="S3.Thmdefinition1.p1.5.m5.1.1.cmml" xref="S3.Thmdefinition1.p1.5.m5.1.1">𝒓</ci></apply><ci id="S3.Thmdefinition1.p1.5.m5.2.2.cmml" xref="S3.Thmdefinition1.p1.5.m5.2.2">𝑌</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmdefinition1.p1.5.m5.3c">\text{MI}(Q(\bm{r}),Y)</annotation><annotation encoding="application/x-llamapun" id="S3.Thmdefinition1.p1.5.m5.3d">MI ( italic_Q ( bold_italic_r ) , italic_Y )</annotation></semantics></math>.</p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">Following previous approach <cite class="ltx_cite ltx_citemacro_citep">(Jawahar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib11" title="">2019</a>)</cite>, we apply K-means as the discrete method for normalized mutual information (NMI) calculation and analyze the flatten embedding of the concatenated Semantic Representations among different methods in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.F2" title="Figure 2 ‣ 3.1 Limination of a Single Code ‣ 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>. We present results with respect to different scaling factors with 100 clusters and provide flattened embedding NMI under varying cluster numbers in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.F2.sf2" title="Figure 2(b) ‣ Figure 2 ‣ 3.1 Limination of a Single Code ‣ 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">2(b)</span></a>.
We observe that the discriminability of the ME does not increase with the scaling factor and may even decrease slightly. This is because all these extra embeddings still correspond to the same Semantic IDs from a single codebook, thus containing minimal additional information and redundancy.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">Regarding RQ-VAE, its discriminability also does not consistently increase with the scaling factor due to the fact that the additional fine-grained Semantic IDs introduced at higher level contain diminishing information.
We illustrate this by comparing NMI across different Semantic IDs and their representations in downstream tasks in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.F3" title="Figure 3 ‣ 3.2 Baseline approaches to Scalable Semantic Representation ‣ 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. Another surprising observation from the results in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.F3" title="Figure 3 ‣ 3.2 Baseline approaches to Scalable Semantic Representation ‣ 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> is that the lowest level Semantic ID, <em class="ltx_emph ltx_font_italic" id="S3.SS3.p3.1.1">i.e.</em>, SID 1, and its representation contain more information than the flattened embedding of all the Semantic IDs.
We provide the NMI results across various cluster numbers in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.F2.sf3" title="Figure 2(c) ‣ Figure 2 ‣ 3.1 Limination of a Single Code ‣ 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">2(c)</span></a> and observe that the NMI of SID 1 is consistently larger than that of the flattened embedding when the cluster number exceeds 50, demonstrating that higher-level Semantic IDs may hinder the generalization of lower-level Semantic IDs.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">When scaling up the Semantic Representation, the interaction between low-frequency information and high frequency becomes important as the dimension increases. Therefore, we propose a new metric to measure the dimension robustness of the scaling Semantic Representation.</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="S3.Thmdefinition2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="S3.Thmdefinition2.1.1.1">Definition 3.2</span></span><span class="ltx_text ltx_font_bold" id="S3.Thmdefinition2.2.2"> </span>(Dimension Robustness Scalability of Semantic Representation)<span class="ltx_text ltx_font_bold" id="S3.Thmdefinition2.3.3">.</span>
</h6>
<div class="ltx_para" id="S3.Thmdefinition2.p1">
<p class="ltx_p" id="S3.Thmdefinition2.p1.1">The dimension robustness scalability of Semantic Representation can be measured by the singular spectrum of the Semantic Representation under different scaling factors. A robust Semantic Representation should have higher top singular values without suffering from dimension collapse.</p>
</div>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1">We plot the singular spectrum of ME and RQ-VAE in different scaling factors in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.F4" title="Figure 4 ‣ 3.2 Baseline approaches to Scalable Semantic Representation ‣ 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> to compare the dimension robustness and its scalability between models. And we have the following observations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p6.1.1">Observation 1.</span> RQ-VAE doesn’t suffer from dimensional collapse since that its long-tail singular values don’t diminish. However, its top singular values are not large enough
compared with ME.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p7.1.1">Observation 2.</span> ME has the largest top singular values. However, it suffers from dimensional collapse since its long-tail singular values diminishes suddenly after index 250 in 5x and 275 in 7x setting.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p8">
<p class="ltx_p" id="S3.SS3.p8.1">We conclude with the following finding:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p9">
<svg class="ltx_picture" height="41.9" id="S3.SS3.p9.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,41.9) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 4.53 L 0 37.37 C 0 39.87 2.03 41.9 4.53 41.9 L 595.47 41.9 C 597.97 41.9 600 39.87 600 37.37 L 600 4.53 C 600 2.03 597.97 0 595.47 0 L 4.53 0 C 2.03 0 0 2.03 0 4.53 Z" style="stroke:none"></path></g><g fill="#FAFAFF" fill-opacity="1.0"><path d="M 1.57 4.53 L 1.57 37.37 C 1.57 39 2.9 40.32 4.53 40.32 L 595.47 40.32 C 597.1 40.32 598.43 39 598.43 37.37 L 598.43 4.53 C 598.43 2.9 597.1 1.57 595.47 1.57 L 4.53 1.57 C 2.9 1.57 1.57 2.9 1.57 4.53 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 13.39 6.5)"><foreignobject color="#000000" height="28.9" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="573.23">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S3.SS3.p9.pic1.1.1.1.1.1" style="width:414.3pt;">
<span class="ltx_p" id="S3.SS3.p9.pic1.1.1.1.1.1.1"><em class="ltx_emph ltx_font_italic" id="S3.SS3.p9.pic1.1.1.1.1.1.1.1">Finding 1. Existing methods such as ME and RQ-VAE are not scalable semantic representations for recommendation regarding discriminability and dimension robustness.</em></span>
</span></foreignobject></g></g></svg>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we propose Mixture-of-Codes (MoC) as a novel two-stage method to scale up semantic representation.
We first introduce multiple codebooks in the indexing stage to generate multiple sets of Semantic IDs, and then present Mixture-of-Codes in the downstream recommendation modeling stage for better knowledge transfer.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Multi Codebooks for vector quantization</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.4">Motivated by the observation that multi-embedding does not provide new information due to the same Semantic ID while RQ-VAE focuses on hierarchical indices that are less informative for downstream tasks, we aim to uncover more information from the LLM embedding at a more fundamental level. Specifically, instead of the hierarchical design of RQ-VAE, we utilize multiple parallel codebooks to capture complementary information of the LLM embedding.
Different codebooks project the hidden embedding into various spaces and collaborate to extract information from the LLM embedding.
Formally, given encoder <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">caligraphic_E</annotation></semantics></math>, decoder <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">caligraphic_D</annotation></semantics></math> and <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_N</annotation></semantics></math> Codebooks <math alttext="\{\mathcal{Z}_{i}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><msubsup id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mrow id="S4.SS1.p1.4.m4.1.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.2.cmml"><mo id="S4.SS1.p1.4.m4.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.4.m4.1.1.1.1.2.cmml">{</mo><msub id="S4.SS1.p1.4.m4.1.1.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m4.1.1.1.1.1.1.2" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.2.cmml">𝒵</mi><mi id="S4.SS1.p1.4.m4.1.1.1.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p1.4.m4.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p1.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p1.4.m4.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.1.3.2" xref="S4.SS1.p1.4.m4.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p1.4.m4.1.1.1.3.1" xref="S4.SS1.p1.4.m4.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p1.4.m4.1.1.1.3.3" xref="S4.SS1.p1.4.m4.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1">superscript</csymbol><apply id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><set id="S4.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1"><apply id="S4.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.2">𝒵</ci><ci id="S4.SS1.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS1.p1.4.m4.1.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.3"><eq id="S4.SS1.p1.4.m4.1.1.1.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.3.1"></eq><ci id="S4.SS1.p1.4.m4.1.1.1.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.3.2">𝑖</ci><cn id="S4.SS1.p1.4.m4.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\{\mathcal{Z}_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">{ caligraphic_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, we perform an average over their quantized embedding and the training loss is</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E7">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E7X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\mathrm{MoC}}(\mathcal{E},\mathcal{D},\{\mathcal{Z}_%
{i}\}_{i=1}^{N})" class="ltx_Math" display="inline" id="S4.E7X.2.1.1.m1.3"><semantics id="S4.E7X.2.1.1.m1.3a"><mrow id="S4.E7X.2.1.1.m1.3.3" xref="S4.E7X.2.1.1.m1.3.3.cmml"><msub id="S4.E7X.2.1.1.m1.3.3.3" xref="S4.E7X.2.1.1.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7X.2.1.1.m1.3.3.3.2" xref="S4.E7X.2.1.1.m1.3.3.3.2.cmml">ℒ</mi><mi id="S4.E7X.2.1.1.m1.3.3.3.3" xref="S4.E7X.2.1.1.m1.3.3.3.3.cmml">MoC</mi></msub><mo id="S4.E7X.2.1.1.m1.3.3.2" xref="S4.E7X.2.1.1.m1.3.3.2.cmml">⁢</mo><mrow id="S4.E7X.2.1.1.m1.3.3.1.1" xref="S4.E7X.2.1.1.m1.3.3.1.2.cmml"><mo id="S4.E7X.2.1.1.m1.3.3.1.1.2" stretchy="false" xref="S4.E7X.2.1.1.m1.3.3.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.E7X.2.1.1.m1.1.1" xref="S4.E7X.2.1.1.m1.1.1.cmml">ℰ</mi><mo id="S4.E7X.2.1.1.m1.3.3.1.1.3" xref="S4.E7X.2.1.1.m1.3.3.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E7X.2.1.1.m1.2.2" xref="S4.E7X.2.1.1.m1.2.2.cmml">𝒟</mi><mo id="S4.E7X.2.1.1.m1.3.3.1.1.4" xref="S4.E7X.2.1.1.m1.3.3.1.2.cmml">,</mo><msubsup id="S4.E7X.2.1.1.m1.3.3.1.1.1" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.cmml"><mrow id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">{</mo><msub id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">𝒵</mi><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.cmml"><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.2" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.1" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.1.cmml">=</mo><mn id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.E7X.2.1.1.m1.3.3.1.1.1.3" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.3.cmml">N</mi></msubsup><mo id="S4.E7X.2.1.1.m1.3.3.1.1.5" stretchy="false" xref="S4.E7X.2.1.1.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7X.2.1.1.m1.3b"><apply id="S4.E7X.2.1.1.m1.3.3.cmml" xref="S4.E7X.2.1.1.m1.3.3"><times id="S4.E7X.2.1.1.m1.3.3.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.2"></times><apply id="S4.E7X.2.1.1.m1.3.3.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.3"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.3.3.3.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.3">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.3.3.3.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.3.2">ℒ</ci><ci id="S4.E7X.2.1.1.m1.3.3.3.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.3.3">MoC</ci></apply><vector id="S4.E7X.2.1.1.m1.3.3.1.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1"><ci id="S4.E7X.2.1.1.m1.1.1.cmml" xref="S4.E7X.2.1.1.m1.1.1">ℰ</ci><ci id="S4.E7X.2.1.1.m1.2.2.cmml" xref="S4.E7X.2.1.1.m1.2.2">𝒟</ci><apply id="S4.E7X.2.1.1.m1.3.3.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1">superscript</csymbol><apply id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1">subscript</csymbol><set id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1"><apply id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.2">𝒵</ci><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3"><eq id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.1"></eq><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.2.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.2">𝑖</ci><cn id="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.3.cmml" type="integer" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.E7X.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.3.3.1.1.1.3">𝑁</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7X.2.1.1.m1.3c">\displaystyle\mathcal{L}_{\mathrm{MoC}}(\mathcal{E},\mathcal{D},\{\mathcal{Z}_%
{i}\}_{i=1}^{N})</annotation><annotation encoding="application/x-llamapun" id="S4.E7X.2.1.1.m1.3d">caligraphic_L start_POSTSUBSCRIPT roman_MoC end_POSTSUBSCRIPT ( caligraphic_E , caligraphic_D , { caligraphic_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\|x-\hat{x}\|^{2}+\left\|\mathrm{sg}[\mathbf{z}^{\mathbf{q}}]-%
\mathbf{z}\right\|_{2}^{2}+\left\|\mathrm{sg}[\mathbf{z}]-\mathbf{z}^{\mathbf{%
q}}\right\|_{2}^{2}," class="ltx_Math" display="inline" id="S4.E7X.3.2.2.m1.2"><semantics id="S4.E7X.3.2.2.m1.2a"><mrow id="S4.E7X.3.2.2.m1.2.2.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.cmml"><mrow id="S4.E7X.3.2.2.m1.2.2.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.cmml"><mi id="S4.E7X.3.2.2.m1.2.2.1.1.5" xref="S4.E7X.3.2.2.m1.2.2.1.1.5.cmml"></mi><mo id="S4.E7X.3.2.2.m1.2.2.1.1.4" xref="S4.E7X.3.2.2.m1.2.2.1.1.4.cmml">=</mo><mrow id="S4.E7X.3.2.2.m1.2.2.1.1.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.cmml"><msup id="S4.E7X.3.2.2.m1.2.2.1.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.cmml"><mrow id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">x</mi><mo id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E7X.3.2.2.m1.2.2.1.1.3.4" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.4.cmml">+</mo><msubsup id="S4.E7X.3.2.2.m1.2.2.1.1.2.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.cmml"><mrow id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.2.cmml"><mo id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.2.1.cmml">‖</mo><mrow id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mrow id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.cmml"><mi id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.3.cmml">sg</mi><mo id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.2.cmml"><mo id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.2.1.cmml">[</mo><msup id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml">𝐪</mi></msup><mo id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.2.cmml">−</mo><mi id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.3.cmml">𝐳</mi></mrow><mo id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.3.cmml">2</mn><mn id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.3.cmml">2</mn></msubsup><mo id="S4.E7X.3.2.2.m1.2.2.1.1.3.4a" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.4.cmml">+</mo><msubsup id="S4.E7X.3.2.2.m1.2.2.1.1.3.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.cmml"><mrow id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.2.cmml"><mo id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.2.1.cmml">‖</mo><mrow id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.cmml"><mrow id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.cmml"><mi id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.2.cmml">sg</mi><mo id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.3.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.3.1.cmml"><mo id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.3.2.1" stretchy="false" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.3.1.1.cmml">[</mo><mi id="S4.E7X.3.2.2.m1.1.1" xref="S4.E7X.3.2.2.m1.1.1.cmml">𝐳</mi><mo id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.3.2.2" stretchy="false" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.3.1.1.cmml">]</mo></mrow></mrow><mo id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.1" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.1.cmml">−</mo><msup id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3.cmml"><mi id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3.3.cmml">𝐪</mi></msup></mrow><mo id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.3.cmml">2</mn><mn id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.3" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S4.E7X.3.2.2.m1.2.2.1.2" xref="S4.E7X.3.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7X.3.2.2.m1.2b"><apply id="S4.E7X.3.2.2.m1.2.2.1.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1"><eq id="S4.E7X.3.2.2.m1.2.2.1.1.4.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.4"></eq><csymbol cd="latexml" id="S4.E7X.3.2.2.m1.2.2.1.1.5.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.5">absent</csymbol><apply id="S4.E7X.3.2.2.m1.2.2.1.1.3.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3"><plus id="S4.E7X.3.2.2.m1.2.2.1.1.3.4.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.4"></plus><apply id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1"><minus id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1"></minus><ci id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3"><ci id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.1">^</ci><ci id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2">𝑥</ci></apply></apply></apply><cn id="S4.E7X.3.2.2.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.E7X.3.2.2.m1.2.2.1.1.1.1.3">2</cn></apply><apply id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2">superscript</csymbol><apply id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2">subscript</csymbol><apply id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.2.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.2">norm</csymbol><apply id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1"><minus id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.2"></minus><apply id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1"><times id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.2"></times><ci id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.3.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.3">sg</ci><apply id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.1.1.1.1.3">𝐪</ci></apply></apply></apply><ci id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.3.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.1.1.1.3">𝐳</ci></apply></apply><cn id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.3.cmml" type="integer" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.1.3">2</cn></apply><cn id="S4.E7X.3.2.2.m1.2.2.1.1.2.2.3.cmml" type="integer" xref="S4.E7X.3.2.2.m1.2.2.1.1.2.2.3">2</cn></apply><apply id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3">superscript</csymbol><apply id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3">subscript</csymbol><apply id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1"><csymbol cd="latexml" id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.2.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.2">norm</csymbol><apply id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1"><minus id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.1"></minus><apply id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2"><times id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.1"></times><ci id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.2">sg</ci><apply id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.3.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.3.2"><csymbol cd="latexml" id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.3.1.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.E7X.3.2.2.m1.1.1.cmml" xref="S4.E7X.3.2.2.m1.1.1">𝐳</ci></apply></apply><apply id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3.1.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3">superscript</csymbol><ci id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3.2.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3.2">𝐳</ci><ci id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3.3.cmml" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.1.1.1.3.3">𝐪</ci></apply></apply></apply><cn id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.3.cmml" type="integer" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.1.3">2</cn></apply><cn id="S4.E7X.3.2.2.m1.2.2.1.1.3.3.3.cmml" type="integer" xref="S4.E7X.3.2.2.m1.2.2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7X.3.2.2.m1.2c">\displaystyle=\|x-\hat{x}\|^{2}+\left\|\mathrm{sg}[\mathbf{z}^{\mathbf{q}}]-%
\mathbf{z}\right\|_{2}^{2}+\left\|\mathrm{sg}[\mathbf{z}]-\mathbf{z}^{\mathbf{%
q}}\right\|_{2}^{2},</annotation><annotation encoding="application/x-llamapun" id="S4.E7X.3.2.2.m1.2d">= ∥ italic_x - over^ start_ARG italic_x end_ARG ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∥ roman_sg [ bold_z start_POSTSUPERSCRIPT bold_q end_POSTSUPERSCRIPT ] - bold_z ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∥ roman_sg [ bold_z ] - bold_z start_POSTSUPERSCRIPT bold_q end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E7Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{z^{q}}" class="ltx_Math" display="inline" id="S4.E7Xa.2.1.1.m1.1"><semantics id="S4.E7Xa.2.1.1.m1.1a"><msup id="S4.E7Xa.2.1.1.m1.1.1" xref="S4.E7Xa.2.1.1.m1.1.1.cmml"><mi id="S4.E7Xa.2.1.1.m1.1.1.2" xref="S4.E7Xa.2.1.1.m1.1.1.2.cmml">𝐳</mi><mi id="S4.E7Xa.2.1.1.m1.1.1.3" xref="S4.E7Xa.2.1.1.m1.1.1.3.cmml">𝐪</mi></msup><annotation-xml encoding="MathML-Content" id="S4.E7Xa.2.1.1.m1.1b"><apply id="S4.E7Xa.2.1.1.m1.1.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.E7Xa.2.1.1.m1.1.1.1.cmml" xref="S4.E7Xa.2.1.1.m1.1.1">superscript</csymbol><ci id="S4.E7Xa.2.1.1.m1.1.1.2.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.2">𝐳</ci><ci id="S4.E7Xa.2.1.1.m1.1.1.3.cmml" xref="S4.E7Xa.2.1.1.m1.1.1.3">𝐪</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7Xa.2.1.1.m1.1c">\displaystyle\mathbf{z^{q}}</annotation><annotation encoding="application/x-llamapun" id="S4.E7Xa.2.1.1.m1.1d">bold_z start_POSTSUPERSCRIPT bold_q end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{AVG}(\{\mathbf{z_{i}^{q}}\}_{i=1}^{N})," class="ltx_Math" display="inline" id="S4.E7Xa.3.2.2.m1.1"><semantics id="S4.E7Xa.3.2.2.m1.1a"><mrow id="S4.E7Xa.3.2.2.m1.1.1.1" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S4.E7Xa.3.2.2.m1.1.1.1.1" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S4.E7Xa.3.2.2.m1.1.1.1.1.3" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.3.cmml"></mi><mo id="S4.E7Xa.3.2.2.m1.1.1.1.1.2" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E7Xa.3.2.2.m1.1.1.1.1.1" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.cmml"><mtext id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.3" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.3a.cmml">AVG</mtext><mo id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.2" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msubsup id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">𝐢</mi><mi id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐪</mi></msubsup><mo id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">N</mi></msubsup><mo id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7Xa.3.2.2.m1.1.1.1.2" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7Xa.3.2.2.m1.1b"><apply id="S4.E7Xa.3.2.2.m1.1.1.1.1.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1"><eq id="S4.E7Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E7Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.3">absent</csymbol><apply id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1"><times id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.2"></times><ci id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.3a.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.3"><mtext id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.3">AVG</mtext></ci><apply id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><set id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝐢</ci></apply><ci id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐪</ci></apply></set><apply id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3"><eq id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.1"></eq><ci id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7Xa.3.2.2.m1.1c">\displaystyle=\text{AVG}(\{\mathbf{z_{i}^{q}}\}_{i=1}^{N}),</annotation><annotation encoding="application/x-llamapun" id="S4.E7Xa.3.2.2.m1.1d">= AVG ( { bold_z start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT bold_q end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.5">where <math alttext="\mathbf{z}^{q}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m1.1"><semantics id="S4.SS1.p1.5.m1.1a"><msup id="S4.SS1.p1.5.m1.1.1" xref="S4.SS1.p1.5.m1.1.1.cmml"><mi id="S4.SS1.p1.5.m1.1.1.2" xref="S4.SS1.p1.5.m1.1.1.2.cmml">𝐳</mi><mi id="S4.SS1.p1.5.m1.1.1.3" xref="S4.SS1.p1.5.m1.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m1.1b"><apply id="S4.SS1.p1.5.m1.1.1.cmml" xref="S4.SS1.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m1.1.1.1.cmml" xref="S4.SS1.p1.5.m1.1.1">superscript</csymbol><ci id="S4.SS1.p1.5.m1.1.1.2.cmml" xref="S4.SS1.p1.5.m1.1.1.2">𝐳</ci><ci id="S4.SS1.p1.5.m1.1.1.3.cmml" xref="S4.SS1.p1.5.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m1.1c">\mathbf{z}^{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m1.1d">bold_z start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT</annotation></semantics></math> is the average quantization results and we select the corresponding indices as Semantic IDs.</p>
</div>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="411" id="S4.F6.g1" src="x11.png" width="685"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_bold" id="S4.F6.2.1">The overall architecture of MoC Fusion. A bottleneck network is adopted for feature fusion in the downstream stage.</span>
</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Mixture-of-Codes for Implicit Fusion</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">For traditional mixtures of experts, a gating router is used to select some of the experts and perform mixing based on the weights generated by the router with the help of the task-specific loss. However, this approach is impractical in MoC since we do not train the codebooks in an end-to-end style, and the embeddings are initialized and tuned in the downstream stage.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.2">Therefore, we propose a fusion network in the downstream stage for implicit fusion of the codebooks. Specifically, we employ a bottleneck network following the embedding layer to ensure information flow across different features before the feature interaction modules, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S4.F6" title="Figure 6 ‣ 4.1 Multi Codebooks for vector quantization ‣ 4 Method ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>. This implicit fusion design is trained using task-specific loss and mixes the embeddings for better
performance, serving a role similar to the gating network.
Formally, given <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_N</annotation></semantics></math> original attributes and <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_M</annotation></semantics></math> Semantic IDs, we have</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E8">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E8X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle e_{\text{concat}}" class="ltx_Math" display="inline" id="S4.E8X.2.1.1.m1.1"><semantics id="S4.E8X.2.1.1.m1.1a"><msub id="S4.E8X.2.1.1.m1.1.1" xref="S4.E8X.2.1.1.m1.1.1.cmml"><mi id="S4.E8X.2.1.1.m1.1.1.2" xref="S4.E8X.2.1.1.m1.1.1.2.cmml">e</mi><mtext id="S4.E8X.2.1.1.m1.1.1.3" xref="S4.E8X.2.1.1.m1.1.1.3a.cmml">concat</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.E8X.2.1.1.m1.1b"><apply id="S4.E8X.2.1.1.m1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1">subscript</csymbol><ci id="S4.E8X.2.1.1.m1.1.1.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.2">𝑒</ci><ci id="S4.E8X.2.1.1.m1.1.1.3a.cmml" xref="S4.E8X.2.1.1.m1.1.1.3"><mtext id="S4.E8X.2.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.E8X.2.1.1.m1.1.1.3">concat</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8X.2.1.1.m1.1c">\displaystyle e_{\text{concat}}</annotation><annotation encoding="application/x-llamapun" id="S4.E8X.2.1.1.m1.1d">italic_e start_POSTSUBSCRIPT concat end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{CONCAT}(\bm{e}_{1},...,\bm{e}_{n},\bm{e}_{\text{sid}_{1}},%
...,\bm{e}_{\text{sid}_{M}})," class="ltx_Math" display="inline" id="S4.E8X.3.2.2.m1.3"><semantics id="S4.E8X.3.2.2.m1.3a"><mrow id="S4.E8X.3.2.2.m1.3.3.1" xref="S4.E8X.3.2.2.m1.3.3.1.1.cmml"><mrow id="S4.E8X.3.2.2.m1.3.3.1.1" xref="S4.E8X.3.2.2.m1.3.3.1.1.cmml"><mi id="S4.E8X.3.2.2.m1.3.3.1.1.6" xref="S4.E8X.3.2.2.m1.3.3.1.1.6.cmml"></mi><mo id="S4.E8X.3.2.2.m1.3.3.1.1.5" xref="S4.E8X.3.2.2.m1.3.3.1.1.5.cmml">=</mo><mrow id="S4.E8X.3.2.2.m1.3.3.1.1.4" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.cmml"><mtext id="S4.E8X.3.2.2.m1.3.3.1.1.4.6" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.6a.cmml">CONCAT</mtext><mo id="S4.E8X.3.2.2.m1.3.3.1.1.4.5" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.5.cmml">⁢</mo><mrow id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.5.cmml"><mo id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.5" stretchy="false" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.5.cmml">(</mo><msub id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">𝒆</mi><mn id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.6" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.5.cmml">,</mo><mi id="S4.E8X.3.2.2.m1.1.1" mathvariant="normal" xref="S4.E8X.3.2.2.m1.1.1.cmml">…</mi><mo id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.7" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.5.cmml">,</mo><msub id="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2" xref="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2.2" xref="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2.2.cmml">𝒆</mi><mi id="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2.3" xref="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2.3.cmml">n</mi></msub><mo id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.8" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.5.cmml">,</mo><msub id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.cmml"><mi id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.2" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.2.cmml">𝒆</mi><msub id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.cmml"><mtext id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.2" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.2a.cmml">sid</mtext><mn id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.3" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.3.cmml">1</mn></msub></msub><mo id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.9" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.5.cmml">,</mo><mi id="S4.E8X.3.2.2.m1.2.2" mathvariant="normal" xref="S4.E8X.3.2.2.m1.2.2.cmml">…</mi><mo id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.10" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.5.cmml">,</mo><msub id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.cmml"><mi id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.2" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.2.cmml">𝒆</mi><msub id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.cmml"><mtext id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.2" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.2a.cmml">sid</mtext><mi id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.3" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.3.cmml">M</mi></msub></msub><mo id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.11" stretchy="false" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.5.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8X.3.2.2.m1.3.3.1.2" xref="S4.E8X.3.2.2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8X.3.2.2.m1.3b"><apply id="S4.E8X.3.2.2.m1.3.3.1.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1"><eq id="S4.E8X.3.2.2.m1.3.3.1.1.5.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.5"></eq><csymbol cd="latexml" id="S4.E8X.3.2.2.m1.3.3.1.1.6.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.6">absent</csymbol><apply id="S4.E8X.3.2.2.m1.3.3.1.1.4.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4"><times id="S4.E8X.3.2.2.m1.3.3.1.1.4.5.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.5"></times><ci id="S4.E8X.3.2.2.m1.3.3.1.1.4.6a.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.6"><mtext id="S4.E8X.3.2.2.m1.3.3.1.1.4.6.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.6">CONCAT</mtext></ci><vector id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.5.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4"><apply id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1.2">𝒆</ci><cn id="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E8X.3.2.2.m1.3.3.1.1.1.1.1.1.3">1</cn></apply><ci id="S4.E8X.3.2.2.m1.1.1.cmml" xref="S4.E8X.3.2.2.m1.1.1">…</ci><apply id="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2.2">𝒆</ci><ci id="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.2.2.2.2.3">𝑛</ci></apply><apply id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3">subscript</csymbol><ci id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.2.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.2">𝒆</ci><apply id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3">subscript</csymbol><ci id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.2a.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.2"><mtext id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.2.cmml" mathsize="70%" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.2">sid</mtext></ci><cn id="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.3.cmml" type="integer" xref="S4.E8X.3.2.2.m1.3.3.1.1.3.3.3.3.3.3">1</cn></apply></apply><ci id="S4.E8X.3.2.2.m1.2.2.cmml" xref="S4.E8X.3.2.2.m1.2.2">…</ci><apply id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4">subscript</csymbol><ci id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.2.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.2">𝒆</ci><apply id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3"><csymbol cd="ambiguous" id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.1.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3">subscript</csymbol><ci id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.2a.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.2"><mtext id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.2.cmml" mathsize="70%" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.2">sid</mtext></ci><ci id="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.3.cmml" xref="S4.E8X.3.2.2.m1.3.3.1.1.4.4.4.4.3.3">𝑀</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8X.3.2.2.m1.3c">\displaystyle=\text{CONCAT}(\bm{e}_{1},...,\bm{e}_{n},\bm{e}_{\text{sid}_{1}},%
...,\bm{e}_{\text{sid}_{M}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E8X.3.2.2.m1.3d">= CONCAT ( bold_italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_italic_e start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , bold_italic_e start_POSTSUBSCRIPT sid start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , bold_italic_e start_POSTSUBSCRIPT sid start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E8Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle e_{\text{concat}}^{\prime}" class="ltx_Math" display="inline" id="S4.E8Xa.2.1.1.m1.1"><semantics id="S4.E8Xa.2.1.1.m1.1a"><msubsup id="S4.E8Xa.2.1.1.m1.1.1" xref="S4.E8Xa.2.1.1.m1.1.1.cmml"><mi id="S4.E8Xa.2.1.1.m1.1.1.2.2" xref="S4.E8Xa.2.1.1.m1.1.1.2.2.cmml">e</mi><mtext id="S4.E8Xa.2.1.1.m1.1.1.2.3" xref="S4.E8Xa.2.1.1.m1.1.1.2.3a.cmml">concat</mtext><mo id="S4.E8Xa.2.1.1.m1.1.1.3" xref="S4.E8Xa.2.1.1.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.E8Xa.2.1.1.m1.1b"><apply id="S4.E8Xa.2.1.1.m1.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.1.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1">superscript</csymbol><apply id="S4.E8Xa.2.1.1.m1.1.1.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.1.1.2.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S4.E8Xa.2.1.1.m1.1.1.2.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.2.2">𝑒</ci><ci id="S4.E8Xa.2.1.1.m1.1.1.2.3a.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.2.3"><mtext id="S4.E8Xa.2.1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S4.E8Xa.2.1.1.m1.1.1.2.3">concat</mtext></ci></apply><ci id="S4.E8Xa.2.1.1.m1.1.1.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8Xa.2.1.1.m1.1c">\displaystyle e_{\text{concat}}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.E8Xa.2.1.1.m1.1d">italic_e start_POSTSUBSCRIPT concat end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=e_{\text{concat}}+e_{\text{concat}}\cdot\mathbf{W}_{\text{down}}%
\cdot\mathbf{W}_{\text{up}}," class="ltx_Math" display="inline" id="S4.E8Xa.3.2.2.m1.1"><semantics id="S4.E8Xa.3.2.2.m1.1a"><mrow id="S4.E8Xa.3.2.2.m1.1.1.1" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S4.E8Xa.3.2.2.m1.1.1.1.1" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S4.E8Xa.3.2.2.m1.1.1.1.1.2" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.2.cmml"></mi><mo id="S4.E8Xa.3.2.2.m1.1.1.1.1.1" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E8Xa.3.2.2.m1.1.1.1.1.3" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.cmml"><msub id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.cmml"><mi id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.2" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml">e</mi><mtext id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.3" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.3a.cmml">concat</mtext></msub><mo id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.1" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.cmml"><msub id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.cmml"><mi id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.2" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.2.cmml">e</mi><mtext id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.3" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.3a.cmml">concat</mtext></msub><mo id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.1.cmml">⋅</mo><msub id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.cmml"><mi id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.2" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.2.cmml">𝐖</mi><mtext id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.3" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.3a.cmml">down</mtext></msub><mo id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.1.cmml">⋅</mo><msub id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.cmml"><mi id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.2" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.2.cmml">𝐖</mi><mtext id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.3" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.3a.cmml">up</mtext></msub></mrow></mrow></mrow><mo id="S4.E8Xa.3.2.2.m1.1.1.1.2" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8Xa.3.2.2.m1.1b"><apply id="S4.E8Xa.3.2.2.m1.1.1.1.1.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1"><eq id="S4.E8Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.1"></eq><csymbol cd="latexml" id="S4.E8Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.2">absent</csymbol><apply id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3"><plus id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.1"></plus><apply id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.2">𝑒</ci><ci id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.3a.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.3"><mtext id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.2.3">concat</mtext></ci></apply><apply id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3"><ci id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.1.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.1">⋅</ci><apply id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.2">𝑒</ci><ci id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.3a.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.3"><mtext id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.3.cmml" mathsize="70%" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.2.3">concat</mtext></ci></apply><apply id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.2">𝐖</ci><ci id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.3a.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.3"><mtext id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.3.cmml" mathsize="70%" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.3.3">down</mtext></ci></apply><apply id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.1.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4">subscript</csymbol><ci id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.2.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.2">𝐖</ci><ci id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.3a.cmml" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.3"><mtext id="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.3.cmml" mathsize="70%" xref="S4.E8Xa.3.2.2.m1.1.1.1.1.3.3.4.3">up</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8Xa.3.2.2.m1.1c">\displaystyle=e_{\text{concat}}+e_{\text{concat}}\cdot\mathbf{W}_{\text{down}}%
\cdot\mathbf{W}_{\text{up}},</annotation><annotation encoding="application/x-llamapun" id="S4.E8Xa.3.2.2.m1.1d">= italic_e start_POSTSUBSCRIPT concat end_POSTSUBSCRIPT + italic_e start_POSTSUBSCRIPT concat end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT down end_POSTSUBSCRIPT ⋅ bold_W start_POSTSUBSCRIPT up end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E8Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\bm{e}_{1},...,\bm{e}_{n},\bm{e}_{\text{sid}_{1}},...,\bm{e}_{%
\text{sid}_{M}}" class="ltx_Math" display="inline" id="S4.E8Xb.2.1.1.m1.6"><semantics id="S4.E8Xb.2.1.1.m1.6a"><mrow id="S4.E8Xb.2.1.1.m1.6.6.4" xref="S4.E8Xb.2.1.1.m1.6.6.5.cmml"><msub id="S4.E8Xb.2.1.1.m1.3.3.1.1" xref="S4.E8Xb.2.1.1.m1.3.3.1.1.cmml"><mi id="S4.E8Xb.2.1.1.m1.3.3.1.1.2" xref="S4.E8Xb.2.1.1.m1.3.3.1.1.2.cmml">𝒆</mi><mn id="S4.E8Xb.2.1.1.m1.3.3.1.1.3" xref="S4.E8Xb.2.1.1.m1.3.3.1.1.3.cmml">1</mn></msub><mo id="S4.E8Xb.2.1.1.m1.6.6.4.5" xref="S4.E8Xb.2.1.1.m1.6.6.5.cmml">,</mo><mi id="S4.E8Xb.2.1.1.m1.1.1" mathvariant="normal" xref="S4.E8Xb.2.1.1.m1.1.1.cmml">…</mi><mo id="S4.E8Xb.2.1.1.m1.6.6.4.6" xref="S4.E8Xb.2.1.1.m1.6.6.5.cmml">,</mo><msub id="S4.E8Xb.2.1.1.m1.4.4.2.2" xref="S4.E8Xb.2.1.1.m1.4.4.2.2.cmml"><mi id="S4.E8Xb.2.1.1.m1.4.4.2.2.2" xref="S4.E8Xb.2.1.1.m1.4.4.2.2.2.cmml">𝒆</mi><mi id="S4.E8Xb.2.1.1.m1.4.4.2.2.3" xref="S4.E8Xb.2.1.1.m1.4.4.2.2.3.cmml">n</mi></msub><mo id="S4.E8Xb.2.1.1.m1.6.6.4.7" xref="S4.E8Xb.2.1.1.m1.6.6.5.cmml">,</mo><msub id="S4.E8Xb.2.1.1.m1.5.5.3.3" xref="S4.E8Xb.2.1.1.m1.5.5.3.3.cmml"><mi id="S4.E8Xb.2.1.1.m1.5.5.3.3.2" xref="S4.E8Xb.2.1.1.m1.5.5.3.3.2.cmml">𝒆</mi><msub id="S4.E8Xb.2.1.1.m1.5.5.3.3.3" xref="S4.E8Xb.2.1.1.m1.5.5.3.3.3.cmml"><mtext id="S4.E8Xb.2.1.1.m1.5.5.3.3.3.2" xref="S4.E8Xb.2.1.1.m1.5.5.3.3.3.2a.cmml">sid</mtext><mn id="S4.E8Xb.2.1.1.m1.5.5.3.3.3.3" xref="S4.E8Xb.2.1.1.m1.5.5.3.3.3.3.cmml">1</mn></msub></msub><mo id="S4.E8Xb.2.1.1.m1.6.6.4.8" xref="S4.E8Xb.2.1.1.m1.6.6.5.cmml">,</mo><mi id="S4.E8Xb.2.1.1.m1.2.2" mathvariant="normal" xref="S4.E8Xb.2.1.1.m1.2.2.cmml">…</mi><mo id="S4.E8Xb.2.1.1.m1.6.6.4.9" xref="S4.E8Xb.2.1.1.m1.6.6.5.cmml">,</mo><msub id="S4.E8Xb.2.1.1.m1.6.6.4.4" xref="S4.E8Xb.2.1.1.m1.6.6.4.4.cmml"><mi id="S4.E8Xb.2.1.1.m1.6.6.4.4.2" xref="S4.E8Xb.2.1.1.m1.6.6.4.4.2.cmml">𝒆</mi><msub id="S4.E8Xb.2.1.1.m1.6.6.4.4.3" xref="S4.E8Xb.2.1.1.m1.6.6.4.4.3.cmml"><mtext id="S4.E8Xb.2.1.1.m1.6.6.4.4.3.2" xref="S4.E8Xb.2.1.1.m1.6.6.4.4.3.2a.cmml">sid</mtext><mi id="S4.E8Xb.2.1.1.m1.6.6.4.4.3.3" xref="S4.E8Xb.2.1.1.m1.6.6.4.4.3.3.cmml">M</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.E8Xb.2.1.1.m1.6b"><list id="S4.E8Xb.2.1.1.m1.6.6.5.cmml" xref="S4.E8Xb.2.1.1.m1.6.6.4"><apply id="S4.E8Xb.2.1.1.m1.3.3.1.1.cmml" xref="S4.E8Xb.2.1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S4.E8Xb.2.1.1.m1.3.3.1.1.1.cmml" xref="S4.E8Xb.2.1.1.m1.3.3.1.1">subscript</csymbol><ci id="S4.E8Xb.2.1.1.m1.3.3.1.1.2.cmml" xref="S4.E8Xb.2.1.1.m1.3.3.1.1.2">𝒆</ci><cn id="S4.E8Xb.2.1.1.m1.3.3.1.1.3.cmml" type="integer" xref="S4.E8Xb.2.1.1.m1.3.3.1.1.3">1</cn></apply><ci id="S4.E8Xb.2.1.1.m1.1.1.cmml" xref="S4.E8Xb.2.1.1.m1.1.1">…</ci><apply id="S4.E8Xb.2.1.1.m1.4.4.2.2.cmml" xref="S4.E8Xb.2.1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S4.E8Xb.2.1.1.m1.4.4.2.2.1.cmml" xref="S4.E8Xb.2.1.1.m1.4.4.2.2">subscript</csymbol><ci id="S4.E8Xb.2.1.1.m1.4.4.2.2.2.cmml" xref="S4.E8Xb.2.1.1.m1.4.4.2.2.2">𝒆</ci><ci id="S4.E8Xb.2.1.1.m1.4.4.2.2.3.cmml" xref="S4.E8Xb.2.1.1.m1.4.4.2.2.3">𝑛</ci></apply><apply id="S4.E8Xb.2.1.1.m1.5.5.3.3.cmml" xref="S4.E8Xb.2.1.1.m1.5.5.3.3"><csymbol cd="ambiguous" id="S4.E8Xb.2.1.1.m1.5.5.3.3.1.cmml" xref="S4.E8Xb.2.1.1.m1.5.5.3.3">subscript</csymbol><ci id="S4.E8Xb.2.1.1.m1.5.5.3.3.2.cmml" xref="S4.E8Xb.2.1.1.m1.5.5.3.3.2">𝒆</ci><apply id="S4.E8Xb.2.1.1.m1.5.5.3.3.3.cmml" xref="S4.E8Xb.2.1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S4.E8Xb.2.1.1.m1.5.5.3.3.3.1.cmml" xref="S4.E8Xb.2.1.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S4.E8Xb.2.1.1.m1.5.5.3.3.3.2a.cmml" xref="S4.E8Xb.2.1.1.m1.5.5.3.3.3.2"><mtext id="S4.E8Xb.2.1.1.m1.5.5.3.3.3.2.cmml" mathsize="70%" xref="S4.E8Xb.2.1.1.m1.5.5.3.3.3.2">sid</mtext></ci><cn id="S4.E8Xb.2.1.1.m1.5.5.3.3.3.3.cmml" type="integer" xref="S4.E8Xb.2.1.1.m1.5.5.3.3.3.3">1</cn></apply></apply><ci id="S4.E8Xb.2.1.1.m1.2.2.cmml" xref="S4.E8Xb.2.1.1.m1.2.2">…</ci><apply id="S4.E8Xb.2.1.1.m1.6.6.4.4.cmml" xref="S4.E8Xb.2.1.1.m1.6.6.4.4"><csymbol cd="ambiguous" id="S4.E8Xb.2.1.1.m1.6.6.4.4.1.cmml" xref="S4.E8Xb.2.1.1.m1.6.6.4.4">subscript</csymbol><ci id="S4.E8Xb.2.1.1.m1.6.6.4.4.2.cmml" xref="S4.E8Xb.2.1.1.m1.6.6.4.4.2">𝒆</ci><apply id="S4.E8Xb.2.1.1.m1.6.6.4.4.3.cmml" xref="S4.E8Xb.2.1.1.m1.6.6.4.4.3"><csymbol cd="ambiguous" id="S4.E8Xb.2.1.1.m1.6.6.4.4.3.1.cmml" xref="S4.E8Xb.2.1.1.m1.6.6.4.4.3">subscript</csymbol><ci id="S4.E8Xb.2.1.1.m1.6.6.4.4.3.2a.cmml" xref="S4.E8Xb.2.1.1.m1.6.6.4.4.3.2"><mtext id="S4.E8Xb.2.1.1.m1.6.6.4.4.3.2.cmml" mathsize="70%" xref="S4.E8Xb.2.1.1.m1.6.6.4.4.3.2">sid</mtext></ci><ci id="S4.E8Xb.2.1.1.m1.6.6.4.4.3.3.cmml" xref="S4.E8Xb.2.1.1.m1.6.6.4.4.3.3">𝑀</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.E8Xb.2.1.1.m1.6c">\displaystyle\bm{e}_{1},...,\bm{e}_{n},\bm{e}_{\text{sid}_{1}},...,\bm{e}_{%
\text{sid}_{M}}</annotation><annotation encoding="application/x-llamapun" id="S4.E8Xb.2.1.1.m1.6d">bold_italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_italic_e start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , bold_italic_e start_POSTSUBSCRIPT sid start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , bold_italic_e start_POSTSUBSCRIPT sid start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{SPLIT}(e_{\text{concat}}^{\prime})," class="ltx_Math" display="inline" id="S4.E8Xb.3.2.2.m1.1"><semantics id="S4.E8Xb.3.2.2.m1.1a"><mrow id="S4.E8Xb.3.2.2.m1.1.1.1" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.cmml"><mrow id="S4.E8Xb.3.2.2.m1.1.1.1.1" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.cmml"><mi id="S4.E8Xb.3.2.2.m1.1.1.1.1.3" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.3.cmml"></mi><mo id="S4.E8Xb.3.2.2.m1.1.1.1.1.2" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E8Xb.3.2.2.m1.1.1.1.1.1" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.cmml"><mtext id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.3" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.3a.cmml">SPLIT</mtext><mo id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.2" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml">e</mi><mtext id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.3a.cmml">concat</mtext><mo id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8Xb.3.2.2.m1.1.1.1.2" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8Xb.3.2.2.m1.1b"><apply id="S4.E8Xb.3.2.2.m1.1.1.1.1.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1"><eq id="S4.E8Xb.3.2.2.m1.1.1.1.1.2.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E8Xb.3.2.2.m1.1.1.1.1.3.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.3">absent</csymbol><apply id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1"><times id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.2"></times><ci id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.3a.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.3"><mtext id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.3">SPLIT</mtext></ci><apply id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.2">𝑒</ci><ci id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.3"><mtext id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.2.3">concat</mtext></ci></apply><ci id="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8Xb.3.2.2.m1.1.1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8Xb.3.2.2.m1.1c">\displaystyle=\text{SPLIT}(e_{\text{concat}}^{\prime}),</annotation><annotation encoding="application/x-llamapun" id="S4.E8Xb.3.2.2.m1.1d">= SPLIT ( italic_e start_POSTSUBSCRIPT concat end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.2">where <math alttext="\mathbf{W}_{\text{down}}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">𝐖</mi><mtext id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3a.cmml">down</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝐖</ci><ci id="S4.SS2.p3.1.m1.1.1.3a.cmml" xref="S4.SS2.p3.1.m1.1.1.3"><mtext id="S4.SS2.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p3.1.m1.1.1.3">down</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\mathbf{W}_{\text{down}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">bold_W start_POSTSUBSCRIPT down end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{W}_{\text{up}}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><msub id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">𝐖</mi><mtext id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3a.cmml">up</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝐖</ci><ci id="S4.SS2.p3.2.m2.1.1.3a.cmml" xref="S4.SS2.p3.2.m2.1.1.3"><mtext id="S4.SS2.p3.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p3.2.m2.1.1.3">up</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\mathbf{W}_{\text{up}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">bold_W start_POSTSUBSCRIPT up end_POSTSUBSCRIPT</annotation></semantics></math> denotes the down and up projection layer, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>In-depth Scalability Analysis of MoC</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.1">Scalability of Discriminability</span>
We study the discriminability of MoC by the mutual information between quantized representation and the label at various scaling factors in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.F3.sf2" title="Figure 3(b) ‣ Figure 3 ‣ 3.2 Baseline approaches to Scalable Semantic Representation ‣ 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">3(b)</span></a>.
It can be observed that the discriminability of MoC at 1x is comparable with that of RQ-VAE and much higher than ME.
Furthermore, the discriminability of MoC gets higher with larger scaling factors from 1x to 7x, indicating that it has better scalability regarding discriminability.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.1">Scalability of Dimension Robustness</span>
We plot the singular spectrum of MoC on various scaling factors in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S3.F4" title="Figure 4 ‣ 3.2 Baseline approaches to Scalable Semantic Representation ‣ 3 On the Scaling of Semantic Representation ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>., and find that it gets higher values on the low-index singular, compared to the RQ-VAE, even though not as high as ME.
Besides, its singular values on high-indices are also robust, not diminishing as ME in 5x and 7x factors.
In conclusion, the dimension of MoC are more robust than ME and RQ-VAE when we scale up its representation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1">Based on the observations above, we conclude with the following finding:</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p4">
<svg class="ltx_picture" height="41.9" id="S4.SS3.p4.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,41.9) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 4.53 L 0 37.37 C 0 39.87 2.03 41.9 4.53 41.9 L 595.47 41.9 C 597.97 41.9 600 39.87 600 37.37 L 600 4.53 C 600 2.03 597.97 0 595.47 0 L 4.53 0 C 2.03 0 0 2.03 0 4.53 Z" style="stroke:none"></path></g><g fill="#FAFAFF" fill-opacity="1.0"><path d="M 1.57 4.53 L 1.57 37.37 C 1.57 39 2.9 40.32 4.53 40.32 L 595.47 40.32 C 597.1 40.32 598.43 39 598.43 37.37 L 598.43 4.53 C 598.43 2.9 597.1 1.57 595.47 1.57 L 4.53 1.57 C 2.9 1.57 1.57 2.9 1.57 4.53 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 13.39 6.5)"><foreignobject color="#000000" height="28.9" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="573.23">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S4.SS3.p4.pic1.1.1.1.1.1" style="width:414.3pt;">
<span class="ltx_p" id="S4.SS3.p4.pic1.1.1.1.1.1.1"><em class="ltx_emph ltx_font_italic" id="S4.SS3.p4.pic1.1.1.1.1.1.1.1">Finding 2. Our proposed MoC successfully enables scalable Semantic Representation regarding both discriminability and dimension robustness.</em></span>
</span></foreignobject></g></g></svg>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Test AUC of different methods over various models. We report the test AUC results with 1x, 2x, 3x and 7x scaling factors. </figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T1.1" style="width:397.5pt;height:171.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-92.6pt,40.1pt) scale(0.682116047974723,0.682116047974723) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.1.1">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S5.T1.1.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T1.1.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S5.T1.1.1.1.2">Toys</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S5.T1.1.1.1.3">Beauty</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S5.T1.1.1.1.4">Sports</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.1">1x</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.2">2x</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.3">3x</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.4">7x</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.5">1x</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.6">2x</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.7">3x</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.8">7x</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.9">1x</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.10">2x</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.11">3x</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.2.12">7x</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.1" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.3.1.1">DeepFM</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.2">ME</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.3" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.3.3.1">0.7406</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.4">0.7403</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.5">0.7397</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.6">0.7390</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.7" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.3.7.1">0.6651</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.8">0.6651</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.9">0.6649</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.10">0.6638</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.11" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.3.11.1">0.6931</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.12">0.6942</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.13">0.6928</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.3.14">0.6917</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.4">
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.1">RQ-VAE</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.4.2.1">0.7409</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.3">0.7405</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.4">0.7398</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.5"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.4.5.1">0.6676</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.6">0.6670</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.7"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.4.7.1">0.6687</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.8"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.4.8.1">0.6945</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.9">0.6932</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.4.10">0.6937</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.5">
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.5.1">MoC</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.5.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.5.2.1">0.7408</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.5.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.5.3.1">0.7415</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.5.4"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.5.4.1">0.7418</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.5.5">0.6656</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.5.6"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.5.6.1">0.6674</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.5.7">0.6681</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.5.8">0.6931</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.5.9"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.5.9.1">0.6936</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.5.10"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.5.10.1">0.6953</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.1" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.6.1.1">DeepIM</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.2">ME</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.3" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.6.3.1">0.7404</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.4">0.7396</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.5">0.7404</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.6">0.7395</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.7" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.6.7.1">0.6648</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.8">0.6620</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.9">0.6635</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.10">0.6637</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.11" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.6.11.1">0.6931</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.12">0.6907</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.13">0.6910</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.6.14">0.6925</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.7">
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.7.1">RQ-VAE</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.7.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.7.2.1">0.7401</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.7.3">0.7403</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.7.4">0.7404</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.7.5"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.7.5.1">0.6651</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.7.6">0.6660</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.7.7">0.6678</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.7.8">0.6918</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.7.9">0.6925</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.7.10">0.6938</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.8">
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.8.1">MoC</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.8.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.8.2.1">0.7401</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.8.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.8.3.1">0.7417</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.8.4"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.8.4.1">0.7422</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.8.5">0.6641</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.8.6"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.8.6.1">0.6668</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.8.7"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.8.7.1">0.6691</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.8.8"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.8.8.1">0.6927</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.8.9"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.8.9.1">0.6935</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.8.10"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.8.10.1">0.6942</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.9">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.1" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.9.1.1">AutoInt+</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.2">ME</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.3" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.9.3.1">0.7415</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.4"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.9.4.1">0.7430</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.5">0.7419</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.6">0.7414</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.7" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.9.7.1">0.6630</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.8">0.6648</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.9">0.6630</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.10">0.6641</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.11" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.9.11.1">0.6911</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.12">0.6935</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.13">0.6930</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.9.14"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.9.14.1">0.6929</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.10">
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.10.1">RQ-VAE</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.10.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.10.2.1">0.7430</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.10.3">0.7419</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.10.4">0.7418</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.10.5"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.10.5.1">0.6672</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.10.6">0.6642</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.10.7">0.6677</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.10.8">0.6934</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.10.9"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.10.9.1">0.6933</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.10.10">0.6915</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.11">
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.11.1">MoC</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.11.2">0.7414</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.11.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.11.3.1">0.7420</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.11.4"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.11.4.1">0.7447</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.11.5">0.6661</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.11.6"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.11.6.1">0.6651</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.11.7"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.11.7.1">0.6689</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.11.8"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.11.8.1">0.6939</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.11.9">0.6926</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.11.10"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.11.10.1">0.6927</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.12">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T1.1.1.12.1" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.12.1.1">DCNv2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.12.2">ME</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T1.1.1.12.3" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.12.3.1">0.7445</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.12.4">0.7445</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.12.5">0.7449</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.12.6">0.7459</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T1.1.1.12.7" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.12.7.1">0.6701</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.12.8">0.6717</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.12.9">0.6716</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.12.10">0.6722</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T1.1.1.12.11" rowspan="3"><span class="ltx_text" id="S5.T1.1.1.12.11.1">0.6962</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.12.12">0.6955</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.12.13">0.6963</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.1.12.14">0.6976</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.13">
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.13.1">RQ-VAE</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.13.2">0.7457</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.13.3">0.7457</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.13.4">0.7469</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.13.5"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.13.5.1">0.6719</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.13.6">0.6720</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.13.7">0.6726</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.13.8">0.6965</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.13.9">0.6966</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.13.10">0.6979</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.1.14">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.14.1">MoC</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.14.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.14.2.1">0.7462</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.14.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.14.3.1">0.7458</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.14.4"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.14.4.1">0.7474</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.14.5">0.6714</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.14.6"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.14.6.1">0.6730</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.14.7"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.14.7.1">0.6729</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.14.8"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.14.8.1">0.6970</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.14.9"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.14.9.1">0.6972</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.1.14.10"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.14.10.1">0.6989</span></td>
</tr>
</table>
</span></div>
</figure>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Setup</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">Datasets.</span>
We conduct experiments on three domains from Amazon review benchmark <cite class="ltx_cite ltx_citemacro_citep">(He &amp; McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib9" title="">2016</a>)</cite>: Amazon-Beauty, Amazon-Sports, and Amazon-Toys.
We follow LMINDEXER <cite class="ltx_cite ltx_citemacro_citep">(Jin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib12" title="">2023</a>)</cite> and keep the users and items that have
at least 5 interactions to filter out unpopular interacting behavior.
Given textual description of items comprising of title, brand and categories, we utilize LLM2Vec <cite class="ltx_cite ltx_citemacro_citep">(BehnamGhader et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib3" title="">2024</a>)</cite> with LLama3 <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib5" title="">2024</a>)</cite> as backbone to obtain their LLM embeddings.
Early stop strategy are adopted over 8/1/1 training/validation/test splits of all the three datasets.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Implementation Details.</span>
We follow TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib19" title="">2024</a>)</cite> to set 256 as the codebook size and 32 as the latent representation. The encoder in the indexing stage has three hidden layers of size 512, 256 and 128 with ReLU activation.
We evaluate the performance of DeepFM <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib7" title="">2017</a>)</cite>, DeepIM <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib26" title="">2020</a>)</cite>, AutoInt+ <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib22" title="">2019</a>)</cite> and DCNv2 <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib25" title="">2021</a>)</cite> in the downstream tasks.
We adpot the Adam optimizer with batch size 8012 and learning rate 0.001.
All the experiments are run across three trials with different seeds and the averaged results are reported.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Overall Performance</h3>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We compare the three semantic scaling methods upon four representative CTR models, <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.1.1">e.g.</em>, DeepFM, DeepIM, AutoInt+ and DCN V2 on three public datasets.
With the same number of IDs, our MoC outperforms the baselines by a large margin, especially in scenarios with a larger number of IDs, <em class="ltx_emph ltx_font_italic" id="S5.SS2.p1.1.2">e.g.</em>, 7x.
Specifically, with 7x scaling factor, all the four models benefits from MoC on Toys datasets and surpass RQ-VAE by 0.20%, 0.18%, 0.29% and 0.05%, respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">More interestingly, in many scenarios, <em class="ltx_emph ltx_font_italic" id="S5.SS2.p2.1.1">our MoC succeed in achieving scaling law regarding the scaling factors</em>, <em class="ltx_emph ltx_font_italic" id="S5.SS2.p2.1.2">i.e.</em>, the performance increases when we include more Semantic Representations.
In contrast, ME suffers from performance degradation due to the redundant semantic information, while RQ-VAE gain slight performance gain because of the less informative Semantic IDs at the high level.</p>
</div>
<figure class="ltx_figure" id="S5.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="792" id="S5.F7.sf1.g1" src="x12.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>MoC correlation.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="792" id="S5.F7.sf2.g1" src="x13.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>RQ-VAE correlation.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F7.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="792" id="S5.F7.sf3.g1" src="x14.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>ME correlation.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Correlation analysis of different methods. </figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Correlation between Multiple Representation.</h3>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.3">The Semantic Representation from different IDs have a deep influence on each other in downstream tasks, and hence we analyze the correlation between different representations to measure the extent of their similarity.
Here we calculate Person correlation coefficient <cite class="ltx_cite ltx_citemacro_citep">(Cohen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib4" title="">2009</a>)</cite> between Semantic Representation <math alttext="e_{sid_{i}}" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">e</mi><mrow id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml"><mi id="S5.SS3.p1.1.m1.1.1.3.2" xref="S5.SS3.p1.1.m1.1.1.3.2.cmml">s</mi><mo id="S5.SS3.p1.1.m1.1.1.3.1" xref="S5.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p1.1.m1.1.1.3.3" xref="S5.SS3.p1.1.m1.1.1.3.3.cmml">i</mi><mo id="S5.SS3.p1.1.m1.1.1.3.1a" xref="S5.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S5.SS3.p1.1.m1.1.1.3.4" xref="S5.SS3.p1.1.m1.1.1.3.4.cmml"><mi id="S5.SS3.p1.1.m1.1.1.3.4.2" xref="S5.SS3.p1.1.m1.1.1.3.4.2.cmml">d</mi><mi id="S5.SS3.p1.1.m1.1.1.3.4.3" xref="S5.SS3.p1.1.m1.1.1.3.4.3.cmml">i</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝑒</ci><apply id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3"><times id="S5.SS3.p1.1.m1.1.1.3.1.cmml" xref="S5.SS3.p1.1.m1.1.1.3.1"></times><ci id="S5.SS3.p1.1.m1.1.1.3.2.cmml" xref="S5.SS3.p1.1.m1.1.1.3.2">𝑠</ci><ci id="S5.SS3.p1.1.m1.1.1.3.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3.3">𝑖</ci><apply id="S5.SS3.p1.1.m1.1.1.3.4.cmml" xref="S5.SS3.p1.1.m1.1.1.3.4"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.3.4.1.cmml" xref="S5.SS3.p1.1.m1.1.1.3.4">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.3.4.2.cmml" xref="S5.SS3.p1.1.m1.1.1.3.4.2">𝑑</ci><ci id="S5.SS3.p1.1.m1.1.1.3.4.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">e_{sid_{i}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="e_{sid_{j}}" class="ltx_Math" display="inline" id="S5.SS3.p1.2.m2.1"><semantics id="S5.SS3.p1.2.m2.1a"><msub id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">e</mi><mrow id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml"><mi id="S5.SS3.p1.2.m2.1.1.3.2" xref="S5.SS3.p1.2.m2.1.1.3.2.cmml">s</mi><mo id="S5.SS3.p1.2.m2.1.1.3.1" xref="S5.SS3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS3.p1.2.m2.1.1.3.3" xref="S5.SS3.p1.2.m2.1.1.3.3.cmml">i</mi><mo id="S5.SS3.p1.2.m2.1.1.3.1a" xref="S5.SS3.p1.2.m2.1.1.3.1.cmml">⁢</mo><msub id="S5.SS3.p1.2.m2.1.1.3.4" xref="S5.SS3.p1.2.m2.1.1.3.4.cmml"><mi id="S5.SS3.p1.2.m2.1.1.3.4.2" xref="S5.SS3.p1.2.m2.1.1.3.4.2.cmml">d</mi><mi id="S5.SS3.p1.2.m2.1.1.3.4.3" xref="S5.SS3.p1.2.m2.1.1.3.4.3.cmml">j</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">𝑒</ci><apply id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3"><times id="S5.SS3.p1.2.m2.1.1.3.1.cmml" xref="S5.SS3.p1.2.m2.1.1.3.1"></times><ci id="S5.SS3.p1.2.m2.1.1.3.2.cmml" xref="S5.SS3.p1.2.m2.1.1.3.2">𝑠</ci><ci id="S5.SS3.p1.2.m2.1.1.3.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3">𝑖</ci><apply id="S5.SS3.p1.2.m2.1.1.3.4.cmml" xref="S5.SS3.p1.2.m2.1.1.3.4"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.3.4.1.cmml" xref="S5.SS3.p1.2.m2.1.1.3.4">subscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.3.4.2.cmml" xref="S5.SS3.p1.2.m2.1.1.3.4.2">𝑑</ci><ci id="S5.SS3.p1.2.m2.1.1.3.4.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3.4.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">e_{sid_{j}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.2.m2.1d">italic_e start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> over <math alttext="n" class="ltx_Math" display="inline" id="S5.SS3.p1.3.m3.1"><semantics id="S5.SS3.p1.3.m3.1a"><mi id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><ci id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.3.m3.1d">italic_n</annotation></semantics></math> samples, and adopt dot product for multiplication of embedding vectors:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S7.EGx1">
<tbody id="S5.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle r_{ij}=\frac{\sum_{k=1}^{n}(e^{k}_{sid_{i}}-\bar{e}_{sid_{i}})(e%
^{k}_{sid_{j}}-\bar{e}_{sid_{j}})}{\sqrt{\sum_{k=1}^{n}(e^{k}_{sid_{i}}-\bar{e%
}_{sid_{i}})^{2}}\sqrt{\sum_{k=1}^{n}(e^{k}_{sid_{j}}-\bar{e}_{sid_{j}})^{2}}}." class="ltx_Math" display="inline" id="S5.Ex1.m1.5"><semantics id="S5.Ex1.m1.5a"><mrow id="S5.Ex1.m1.5.5.1" xref="S5.Ex1.m1.5.5.1.1.cmml"><mrow id="S5.Ex1.m1.5.5.1.1" xref="S5.Ex1.m1.5.5.1.1.cmml"><msub id="S5.Ex1.m1.5.5.1.1.2" xref="S5.Ex1.m1.5.5.1.1.2.cmml"><mi id="S5.Ex1.m1.5.5.1.1.2.2" xref="S5.Ex1.m1.5.5.1.1.2.2.cmml">r</mi><mrow id="S5.Ex1.m1.5.5.1.1.2.3" xref="S5.Ex1.m1.5.5.1.1.2.3.cmml"><mi id="S5.Ex1.m1.5.5.1.1.2.3.2" xref="S5.Ex1.m1.5.5.1.1.2.3.2.cmml">i</mi><mo id="S5.Ex1.m1.5.5.1.1.2.3.1" xref="S5.Ex1.m1.5.5.1.1.2.3.1.cmml">⁢</mo><mi id="S5.Ex1.m1.5.5.1.1.2.3.3" xref="S5.Ex1.m1.5.5.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S5.Ex1.m1.5.5.1.1.1" xref="S5.Ex1.m1.5.5.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S5.Ex1.m1.4.4" xref="S5.Ex1.m1.4.4.cmml"><mfrac id="S5.Ex1.m1.4.4a" xref="S5.Ex1.m1.4.4.cmml"><mrow id="S5.Ex1.m1.2.2.2" xref="S5.Ex1.m1.2.2.2.cmml"><msubsup id="S5.Ex1.m1.2.2.2.3" xref="S5.Ex1.m1.2.2.2.3.cmml"><mo id="S5.Ex1.m1.2.2.2.3.2.2" xref="S5.Ex1.m1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S5.Ex1.m1.2.2.2.3.2.3" xref="S5.Ex1.m1.2.2.2.3.2.3.cmml"><mi id="S5.Ex1.m1.2.2.2.3.2.3.2" xref="S5.Ex1.m1.2.2.2.3.2.3.2.cmml">k</mi><mo id="S5.Ex1.m1.2.2.2.3.2.3.1" xref="S5.Ex1.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S5.Ex1.m1.2.2.2.3.2.3.3" xref="S5.Ex1.m1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S5.Ex1.m1.2.2.2.3.3" xref="S5.Ex1.m1.2.2.2.3.3.cmml">n</mi></msubsup><mrow id="S5.Ex1.m1.2.2.2.2" xref="S5.Ex1.m1.2.2.2.2.cmml"><mrow id="S5.Ex1.m1.1.1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.1.1.1.cmml"><mo id="S5.Ex1.m1.1.1.1.1.1.1.2" lspace="0em" stretchy="false" xref="S5.Ex1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.Ex1.m1.1.1.1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.1.1.1.cmml"><msubsup id="S5.Ex1.m1.1.1.1.1.1.1.1.2" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.2.2.2" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.2.2.cmml">e</mi><mrow id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.2" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.1" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.3" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi><mo id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.1a" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><msub id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4.2" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4.2.cmml">d</mi><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4.3" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4.3.cmml">i</mi></msub></mrow><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.2.2.3" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S5.Ex1.m1.1.1.1.1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S5.Ex1.m1.1.1.1.1.1.1.1.3" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S5.Ex1.m1.1.1.1.1.1.1.1.3.2" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.3.2.2" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.2.2.cmml">e</mi><mo id="S5.Ex1.m1.1.1.1.1.1.1.1.3.2.1" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.2" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.1" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.3" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi><mo id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.1a" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4.2" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4.2.cmml">d</mi><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4.3" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4.3.cmml">i</mi></msub></mrow></msub></mrow><mo id="S5.Ex1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S5.Ex1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.Ex1.m1.2.2.2.2.3" xref="S5.Ex1.m1.2.2.2.2.3.cmml">⁢</mo><mrow id="S5.Ex1.m1.2.2.2.2.2.1" xref="S5.Ex1.m1.2.2.2.2.2.1.1.cmml"><mo id="S5.Ex1.m1.2.2.2.2.2.1.2" stretchy="false" xref="S5.Ex1.m1.2.2.2.2.2.1.1.cmml">(</mo><mrow id="S5.Ex1.m1.2.2.2.2.2.1.1" xref="S5.Ex1.m1.2.2.2.2.2.1.1.cmml"><msubsup id="S5.Ex1.m1.2.2.2.2.2.1.1.2" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.cmml"><mi id="S5.Ex1.m1.2.2.2.2.2.1.1.2.2.2" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.2.2.cmml">e</mi><mrow id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.cmml"><mi id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.2" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.2.cmml">s</mi><mo id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.1" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.3" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.3.cmml">i</mi><mo id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.1a" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.1.cmml">⁢</mo><msub id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4.cmml"><mi id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4.2" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4.2.cmml">d</mi><mi id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4.3" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4.3.cmml">j</mi></msub></mrow><mi id="S5.Ex1.m1.2.2.2.2.2.1.1.2.2.3" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S5.Ex1.m1.2.2.2.2.2.1.1.1" xref="S5.Ex1.m1.2.2.2.2.2.1.1.1.cmml">−</mo><msub id="S5.Ex1.m1.2.2.2.2.2.1.1.3" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.cmml"><mover accent="true" id="S5.Ex1.m1.2.2.2.2.2.1.1.3.2" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.2.cmml"><mi id="S5.Ex1.m1.2.2.2.2.2.1.1.3.2.2" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.2.2.cmml">e</mi><mo id="S5.Ex1.m1.2.2.2.2.2.1.1.3.2.1" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.2.1.cmml">¯</mo></mover><mrow id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.cmml"><mi id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.2" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.2.cmml">s</mi><mo id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.1" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.3" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.3.cmml">i</mi><mo id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.1a" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.1.cmml">⁢</mo><msub id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4.cmml"><mi id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4.2" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4.2.cmml">d</mi><mi id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4.3" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4.3.cmml">j</mi></msub></mrow></msub></mrow><mo id="S5.Ex1.m1.2.2.2.2.2.1.3" stretchy="false" xref="S5.Ex1.m1.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S5.Ex1.m1.4.4.4" xref="S5.Ex1.m1.4.4.4.cmml"><msqrt id="S5.Ex1.m1.3.3.3.1" xref="S5.Ex1.m1.3.3.3.1.cmml"><mrow id="S5.Ex1.m1.3.3.3.1.1" xref="S5.Ex1.m1.3.3.3.1.1.cmml"><msubsup id="S5.Ex1.m1.3.3.3.1.1.2" xref="S5.Ex1.m1.3.3.3.1.1.2.cmml"><mo id="S5.Ex1.m1.3.3.3.1.1.2.2.2" xref="S5.Ex1.m1.3.3.3.1.1.2.2.2.cmml">∑</mo><mrow id="S5.Ex1.m1.3.3.3.1.1.2.2.3" xref="S5.Ex1.m1.3.3.3.1.1.2.2.3.cmml"><mi id="S5.Ex1.m1.3.3.3.1.1.2.2.3.2" xref="S5.Ex1.m1.3.3.3.1.1.2.2.3.2.cmml">k</mi><mo id="S5.Ex1.m1.3.3.3.1.1.2.2.3.1" xref="S5.Ex1.m1.3.3.3.1.1.2.2.3.1.cmml">=</mo><mn id="S5.Ex1.m1.3.3.3.1.1.2.2.3.3" xref="S5.Ex1.m1.3.3.3.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S5.Ex1.m1.3.3.3.1.1.2.3" xref="S5.Ex1.m1.3.3.3.1.1.2.3.cmml">n</mi></msubsup><msup id="S5.Ex1.m1.3.3.3.1.1.1" xref="S5.Ex1.m1.3.3.3.1.1.1.cmml"><mrow id="S5.Ex1.m1.3.3.3.1.1.1.1.1" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.cmml"><mo id="S5.Ex1.m1.3.3.3.1.1.1.1.1.2" lspace="0em" stretchy="false" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.cmml"><msubsup id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.cmml"><mi id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.2.2" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.2.2.cmml">e</mi><mrow id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.2" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.1" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.3" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.3.cmml">i</mi><mo id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.1a" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><msub id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4.cmml"><mi id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4.2" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4.2.cmml">d</mi><mi id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4.3" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4.3.cmml">i</mi></msub></mrow><mi id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.2.3" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.1" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.1.cmml">−</mo><msub id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2.2" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2.2.cmml">e</mi><mo id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2.1" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.2" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.1" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.3" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.3.cmml">i</mi><mo id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.1a" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4.cmml"><mi id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4.2" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4.2.cmml">d</mi><mi id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4.3" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4.3.cmml">i</mi></msub></mrow></msub></mrow><mo id="S5.Ex1.m1.3.3.3.1.1.1.1.1.3" stretchy="false" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S5.Ex1.m1.3.3.3.1.1.1.3" xref="S5.Ex1.m1.3.3.3.1.1.1.3.cmml">2</mn></msup></mrow></msqrt><mo id="S5.Ex1.m1.4.4.4.3" xref="S5.Ex1.m1.4.4.4.3.cmml">⁢</mo><msqrt id="S5.Ex1.m1.4.4.4.2" xref="S5.Ex1.m1.4.4.4.2.cmml"><mrow id="S5.Ex1.m1.4.4.4.2.1" xref="S5.Ex1.m1.4.4.4.2.1.cmml"><msubsup id="S5.Ex1.m1.4.4.4.2.1.2" xref="S5.Ex1.m1.4.4.4.2.1.2.cmml"><mo id="S5.Ex1.m1.4.4.4.2.1.2.2.2" xref="S5.Ex1.m1.4.4.4.2.1.2.2.2.cmml">∑</mo><mrow id="S5.Ex1.m1.4.4.4.2.1.2.2.3" xref="S5.Ex1.m1.4.4.4.2.1.2.2.3.cmml"><mi id="S5.Ex1.m1.4.4.4.2.1.2.2.3.2" xref="S5.Ex1.m1.4.4.4.2.1.2.2.3.2.cmml">k</mi><mo id="S5.Ex1.m1.4.4.4.2.1.2.2.3.1" xref="S5.Ex1.m1.4.4.4.2.1.2.2.3.1.cmml">=</mo><mn id="S5.Ex1.m1.4.4.4.2.1.2.2.3.3" xref="S5.Ex1.m1.4.4.4.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S5.Ex1.m1.4.4.4.2.1.2.3" xref="S5.Ex1.m1.4.4.4.2.1.2.3.cmml">n</mi></msubsup><msup id="S5.Ex1.m1.4.4.4.2.1.1" xref="S5.Ex1.m1.4.4.4.2.1.1.cmml"><mrow id="S5.Ex1.m1.4.4.4.2.1.1.1.1" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.cmml"><mo id="S5.Ex1.m1.4.4.4.2.1.1.1.1.2" lspace="0em" stretchy="false" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.cmml">(</mo><mrow id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.cmml"><msubsup id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.cmml"><mi id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.2.2" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.2.2.cmml">e</mi><mrow id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.cmml"><mi id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.2" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.2.cmml">s</mi><mo id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.1" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.3" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.3.cmml">i</mi><mo id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.1a" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.1.cmml">⁢</mo><msub id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4.cmml"><mi id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4.2" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4.2.cmml">d</mi><mi id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4.3" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4.3.cmml">j</mi></msub></mrow><mi id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.2.3" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.2.3.cmml">k</mi></msubsup><mo id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.1" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.1.cmml">−</mo><msub id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.cmml"><mover accent="true" id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2.cmml"><mi id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2.2" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2.2.cmml">e</mi><mo id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2.1" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.cmml"><mi id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.2" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.2.cmml">s</mi><mo id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.1" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.3" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.3.cmml">i</mi><mo id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.1a" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4.cmml"><mi id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4.2" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4.2.cmml">d</mi><mi id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4.3" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4.3.cmml">j</mi></msub></mrow></msub></mrow><mo id="S5.Ex1.m1.4.4.4.2.1.1.1.1.3" stretchy="false" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.cmml">)</mo></mrow><mn id="S5.Ex1.m1.4.4.4.2.1.1.3" xref="S5.Ex1.m1.4.4.4.2.1.1.3.cmml">2</mn></msup></mrow></msqrt></mrow></mfrac></mstyle></mrow><mo id="S5.Ex1.m1.5.5.1.2" lspace="0em" xref="S5.Ex1.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex1.m1.5b"><apply id="S5.Ex1.m1.5.5.1.1.cmml" xref="S5.Ex1.m1.5.5.1"><eq id="S5.Ex1.m1.5.5.1.1.1.cmml" xref="S5.Ex1.m1.5.5.1.1.1"></eq><apply id="S5.Ex1.m1.5.5.1.1.2.cmml" xref="S5.Ex1.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.5.5.1.1.2.1.cmml" xref="S5.Ex1.m1.5.5.1.1.2">subscript</csymbol><ci id="S5.Ex1.m1.5.5.1.1.2.2.cmml" xref="S5.Ex1.m1.5.5.1.1.2.2">𝑟</ci><apply id="S5.Ex1.m1.5.5.1.1.2.3.cmml" xref="S5.Ex1.m1.5.5.1.1.2.3"><times id="S5.Ex1.m1.5.5.1.1.2.3.1.cmml" xref="S5.Ex1.m1.5.5.1.1.2.3.1"></times><ci id="S5.Ex1.m1.5.5.1.1.2.3.2.cmml" xref="S5.Ex1.m1.5.5.1.1.2.3.2">𝑖</ci><ci id="S5.Ex1.m1.5.5.1.1.2.3.3.cmml" xref="S5.Ex1.m1.5.5.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S5.Ex1.m1.4.4.cmml" xref="S5.Ex1.m1.4.4"><divide id="S5.Ex1.m1.4.4.5.cmml" xref="S5.Ex1.m1.4.4"></divide><apply id="S5.Ex1.m1.2.2.2.cmml" xref="S5.Ex1.m1.2.2.2"><apply id="S5.Ex1.m1.2.2.2.3.cmml" xref="S5.Ex1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.2.3.1.cmml" xref="S5.Ex1.m1.2.2.2.3">superscript</csymbol><apply id="S5.Ex1.m1.2.2.2.3.2.cmml" xref="S5.Ex1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.2.3.2.1.cmml" xref="S5.Ex1.m1.2.2.2.3">subscript</csymbol><sum id="S5.Ex1.m1.2.2.2.3.2.2.cmml" xref="S5.Ex1.m1.2.2.2.3.2.2"></sum><apply id="S5.Ex1.m1.2.2.2.3.2.3.cmml" xref="S5.Ex1.m1.2.2.2.3.2.3"><eq id="S5.Ex1.m1.2.2.2.3.2.3.1.cmml" xref="S5.Ex1.m1.2.2.2.3.2.3.1"></eq><ci id="S5.Ex1.m1.2.2.2.3.2.3.2.cmml" xref="S5.Ex1.m1.2.2.2.3.2.3.2">𝑘</ci><cn id="S5.Ex1.m1.2.2.2.3.2.3.3.cmml" type="integer" xref="S5.Ex1.m1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S5.Ex1.m1.2.2.2.3.3.cmml" xref="S5.Ex1.m1.2.2.2.3.3">𝑛</ci></apply><apply id="S5.Ex1.m1.2.2.2.2.cmml" xref="S5.Ex1.m1.2.2.2.2"><times id="S5.Ex1.m1.2.2.2.2.3.cmml" xref="S5.Ex1.m1.2.2.2.2.3"></times><apply id="S5.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1"><minus id="S5.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1"></minus><apply id="S5.Ex1.m1.1.1.1.1.1.1.1.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S5.Ex1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.2.2">𝑒</ci><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply><apply id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3"><times id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.3">𝑖</ci><apply id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4">subscript</csymbol><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4.2">𝑑</ci><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.2.3.4.3">𝑖</ci></apply></apply></apply><apply id="S5.Ex1.m1.1.1.1.1.1.1.1.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S5.Ex1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.2"><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.2.1">¯</ci><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.2.2">𝑒</ci></apply><apply id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3"><times id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.3">𝑖</ci><apply id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4">subscript</csymbol><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4.2">𝑑</ci><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.3.3.4.3">𝑖</ci></apply></apply></apply></apply><apply id="S5.Ex1.m1.2.2.2.2.2.1.1.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1"><minus id="S5.Ex1.m1.2.2.2.2.2.1.1.1.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.1"></minus><apply id="S5.Ex1.m1.2.2.2.2.2.1.1.2.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.2.2.2.1.1.2.1.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2">subscript</csymbol><apply id="S5.Ex1.m1.2.2.2.2.2.1.1.2.2.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.2.2.2.1.1.2.2.1.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2">superscript</csymbol><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.2.2.2.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.2.2">𝑒</ci><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.2.2.3.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.2.3">𝑘</ci></apply><apply id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3"><times id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.1.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.1"></times><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.2.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.2">𝑠</ci><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.3.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.3">𝑖</ci><apply id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4.1.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4">subscript</csymbol><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4.2.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4.2">𝑑</ci><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4.3.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.2.3.4.3">𝑗</ci></apply></apply></apply><apply id="S5.Ex1.m1.2.2.2.2.2.1.1.3.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.2.2.2.1.1.3.1.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3">subscript</csymbol><apply id="S5.Ex1.m1.2.2.2.2.2.1.1.3.2.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.2"><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.3.2.1.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.2.1">¯</ci><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.3.2.2.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.2.2">𝑒</ci></apply><apply id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3"><times id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.1.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.1"></times><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.2.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.2">𝑠</ci><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.3.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.3">𝑖</ci><apply id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4"><csymbol cd="ambiguous" id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4.1.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4">subscript</csymbol><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4.2.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4.2">𝑑</ci><ci id="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4.3.cmml" xref="S5.Ex1.m1.2.2.2.2.2.1.1.3.3.4.3">𝑗</ci></apply></apply></apply></apply></apply></apply><apply id="S5.Ex1.m1.4.4.4.cmml" xref="S5.Ex1.m1.4.4.4"><times id="S5.Ex1.m1.4.4.4.3.cmml" xref="S5.Ex1.m1.4.4.4.3"></times><apply id="S5.Ex1.m1.3.3.3.1.cmml" xref="S5.Ex1.m1.3.3.3.1"><root id="S5.Ex1.m1.3.3.3.1a.cmml" xref="S5.Ex1.m1.3.3.3.1"></root><apply id="S5.Ex1.m1.3.3.3.1.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1"><apply id="S5.Ex1.m1.3.3.3.1.1.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.3.3.3.1.1.2.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.2">superscript</csymbol><apply id="S5.Ex1.m1.3.3.3.1.1.2.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.3.3.3.1.1.2.2.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.2">subscript</csymbol><sum id="S5.Ex1.m1.3.3.3.1.1.2.2.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.2.2.2"></sum><apply id="S5.Ex1.m1.3.3.3.1.1.2.2.3.cmml" xref="S5.Ex1.m1.3.3.3.1.1.2.2.3"><eq id="S5.Ex1.m1.3.3.3.1.1.2.2.3.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.2.2.3.1"></eq><ci id="S5.Ex1.m1.3.3.3.1.1.2.2.3.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.2.2.3.2">𝑘</ci><cn id="S5.Ex1.m1.3.3.3.1.1.2.2.3.3.cmml" type="integer" xref="S5.Ex1.m1.3.3.3.1.1.2.2.3.3">1</cn></apply></apply><ci id="S5.Ex1.m1.3.3.3.1.1.2.3.cmml" xref="S5.Ex1.m1.3.3.3.1.1.2.3">𝑛</ci></apply><apply id="S5.Ex1.m1.3.3.3.1.1.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S5.Ex1.m1.3.3.3.1.1.1.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1">superscript</csymbol><apply id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1"><minus id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.1"></minus><apply id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2">subscript</csymbol><apply id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2">superscript</csymbol><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.2.2">𝑒</ci><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.2.3">𝑘</ci></apply><apply id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3"><times id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.1"></times><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.3">𝑖</ci><apply id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4"><csymbol cd="ambiguous" id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4">subscript</csymbol><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4.2">𝑑</ci><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4.3.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.2.3.4.3">𝑖</ci></apply></apply></apply><apply id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3">subscript</csymbol><apply id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2"><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2.1">¯</ci><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.2.2">𝑒</ci></apply><apply id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3"><times id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.1"></times><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.3">𝑖</ci><apply id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4"><csymbol cd="ambiguous" id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4.1.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4">subscript</csymbol><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4.2.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4.2">𝑑</ci><ci id="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4.3.cmml" xref="S5.Ex1.m1.3.3.3.1.1.1.1.1.1.3.3.4.3">𝑖</ci></apply></apply></apply></apply><cn id="S5.Ex1.m1.3.3.3.1.1.1.3.cmml" type="integer" xref="S5.Ex1.m1.3.3.3.1.1.1.3">2</cn></apply></apply></apply><apply id="S5.Ex1.m1.4.4.4.2.cmml" xref="S5.Ex1.m1.4.4.4.2"><root id="S5.Ex1.m1.4.4.4.2a.cmml" xref="S5.Ex1.m1.4.4.4.2"></root><apply id="S5.Ex1.m1.4.4.4.2.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1"><apply id="S5.Ex1.m1.4.4.4.2.1.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.4.4.4.2.1.2.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.2">superscript</csymbol><apply id="S5.Ex1.m1.4.4.4.2.1.2.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.4.4.4.2.1.2.2.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.2">subscript</csymbol><sum id="S5.Ex1.m1.4.4.4.2.1.2.2.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.2.2.2"></sum><apply id="S5.Ex1.m1.4.4.4.2.1.2.2.3.cmml" xref="S5.Ex1.m1.4.4.4.2.1.2.2.3"><eq id="S5.Ex1.m1.4.4.4.2.1.2.2.3.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.2.2.3.1"></eq><ci id="S5.Ex1.m1.4.4.4.2.1.2.2.3.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.2.2.3.2">𝑘</ci><cn id="S5.Ex1.m1.4.4.4.2.1.2.2.3.3.cmml" type="integer" xref="S5.Ex1.m1.4.4.4.2.1.2.2.3.3">1</cn></apply></apply><ci id="S5.Ex1.m1.4.4.4.2.1.2.3.cmml" xref="S5.Ex1.m1.4.4.4.2.1.2.3">𝑛</ci></apply><apply id="S5.Ex1.m1.4.4.4.2.1.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1"><csymbol cd="ambiguous" id="S5.Ex1.m1.4.4.4.2.1.1.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1">superscript</csymbol><apply id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1"><minus id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.1"></minus><apply id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2">subscript</csymbol><apply id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.2.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2">superscript</csymbol><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.2.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.2.2">𝑒</ci><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.2.3.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.2.3">𝑘</ci></apply><apply id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3"><times id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.1"></times><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.2">𝑠</ci><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.3.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.3">𝑖</ci><apply id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4"><csymbol cd="ambiguous" id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4">subscript</csymbol><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4.2">𝑑</ci><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4.3.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.2.3.4.3">𝑗</ci></apply></apply></apply><apply id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3">subscript</csymbol><apply id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2"><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2.1">¯</ci><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.2.2">𝑒</ci></apply><apply id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3"><times id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.1"></times><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.2">𝑠</ci><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.3.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.3">𝑖</ci><apply id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4"><csymbol cd="ambiguous" id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4.1.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4">subscript</csymbol><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4.2.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4.2">𝑑</ci><ci id="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4.3.cmml" xref="S5.Ex1.m1.4.4.4.2.1.1.1.1.1.3.3.4.3">𝑗</ci></apply></apply></apply></apply><cn id="S5.Ex1.m1.4.4.4.2.1.1.3.cmml" type="integer" xref="S5.Ex1.m1.4.4.4.2.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex1.m1.5c">\displaystyle r_{ij}=\frac{\sum_{k=1}^{n}(e^{k}_{sid_{i}}-\bar{e}_{sid_{i}})(e%
^{k}_{sid_{j}}-\bar{e}_{sid_{j}})}{\sqrt{\sum_{k=1}^{n}(e^{k}_{sid_{i}}-\bar{e%
}_{sid_{i}})^{2}}\sqrt{\sum_{k=1}^{n}(e^{k}_{sid_{j}}-\bar{e}_{sid_{j}})^{2}}}.</annotation><annotation encoding="application/x-llamapun" id="S5.Ex1.m1.5d">italic_r start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = divide start_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ( italic_e start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT - over¯ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ( italic_e start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT - over¯ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_ARG start_ARG square-root start_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ( italic_e start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT - over¯ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG square-root start_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ( italic_e start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT - over¯ start_ARG italic_e end_ARG start_POSTSUBSCRIPT italic_s italic_i italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.F7" title="Figure 7 ‣ 5.2 Overall Performance ‣ 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a>, the Semantic Representation in ME are highly correlated with each other, <em class="ltx_emph ltx_font_italic" id="S5.SS3.p2.1.1">i.e.</em>, many different Semantic Representation have strong correlation, <em class="ltx_emph ltx_font_italic" id="S5.SS3.p2.1.2">i.e.</em>, representation 1 and 3, 4 and 6 are strongly correlated with each other.
Such strong correlation makes the representation easily influenced by each other, leading to unstable optimization and ineffective scalability.
Regarding MoC and RQ-VAE, the correlation between different Semantic Representation are low, as evidenced by the low correlation score in the off-diagonal cells in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.F7" title="Figure 7 ‣ 5.2 Overall Performance ‣ 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>More comparison Results with RQ-VAE</h3>
<div class="ltx_para ltx_noindent" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">To further verify the information contained in the semantic IDs at each level, we provide a more detailed comparison with RQ-VAE in terms of adding a single ID at each level in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.F8.sf1" title="Figure 8(a) ‣ Figure 9 ‣ 5.5 Ablation on MoC Fusion ‣ 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">8(a)</span></a> and adding multiple IDs starting from the lowest level in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.F8.sf2" title="Figure 8(b) ‣ Figure 9 ‣ 5.5 Ablation on MoC Fusion ‣ 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">8(b)</span></a>.
As the results in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.F8.sf1" title="Figure 8(a) ‣ Figure 9 ‣ 5.5 Ablation on MoC Fusion ‣ 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">8(a)</span></a> indicate, adding a single semantic ID at the low level of RQ-VAE provides a larger performance gain than at the high level, proving that semantic IDs at the high level hold little information.
In contrast, MoC performs uniformly across various Semantic IDs and consistently show better performance than RQ-VAE.
When equipping multi Semantic IDs starting from the lowest level, MoC gains significant improvements than RQ-VAE under different scaling factors, showcasing better generalization.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Ablation on MoC Fusion</h3>
<div class="ltx_para ltx_noindent" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">We conduct an ablation study on MoC Fusion to verify the importance of mixing in the downstream stages. We equip both RQ-VAE and MoC with the fusion module and surprisingly find that both methods benefit from it when scaling up. We also examine the discriminability and dimension robustness scalability of MoC Fusion.
In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.F9" title="Figure 9 ‣ 5.5 Ablation on MoC Fusion ‣ 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">9</span></a>, it can be observed that the fusion module enhances the overall discriminability scalability of MoC by mixing the features. In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#S5.F10" title="Figure 10 ‣ Table 2 ‣ 5.5 Ablation on MoC Fusion ‣ 5 Experiments ‣ Towards Scalable Semantic Representation for Recommendation"><span class="ltx_text ltx_ref_tag">10</span></a>, we truncate the singular spectrum and surprisingly find that the fusion module amplifies the principal components of the Semantic Representation, resulting in significantly higher top singular values. Additionally, the long-tail part is close to that of RQ-VAE and does not suffer from dimension collapse.</p>
</div>
<figure class="ltx_figure" id="S5.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.fig1" style="width:254.4pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S5.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="609" id="S5.F8.sf1.g1" src="x15.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>AUC w.r.t. Single ID.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="609" id="S5.F8.sf2.g1" src="x16.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>AUC w.r.t. Multi ID.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>More comparison results with RQ-VAE.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S5.F9.1" style="width:135.1pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="625" id="S5.F9.1.g1" src="x17.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Discriminability scalability of MoC Fusion.</figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_table" id="S5.T2">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S5.T2.fig1" style="width:258.4pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Table 2: </span>Ablation on MoC Fusion. The experiments are conducted over Toys dataset with DeepFM as the backbone.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.fig1.1" style="width:397.5pt;height:97.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(52.3pt,-12.9pt) scale(1.35711609022505,1.35711609022505) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.fig1.1.1">
<tr class="ltx_tr" id="S5.T2.fig1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.fig1.1.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T2.fig1.1.1.1.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S5.T2.fig1.1.1.1.2">2x</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S5.T2.fig1.1.1.1.3">3x</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S5.T2.fig1.1.1.1.4">7x</td>
</tr>
<tr class="ltx_tr" id="S5.T2.fig1.1.1.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.2.1">w/o</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.2.2">w/</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.2.3">w/o</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.2.4">w/</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.2.5">w/o</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.2.6">w/</td>
</tr>
<tr class="ltx_tr" id="S5.T2.fig1.1.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.3.1">RQ-VAE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.3.2">0.7409</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.3.3">0.7414</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.3.4">0.7405</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.3.5">0.7407</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.3.6">0.7398</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.fig1.1.1.3.7">0.7413</td>
</tr>
<tr class="ltx_tr" id="S5.T2.fig1.1.1.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.fig1.1.1.4.1">MoC</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.fig1.1.1.4.2">0.7409</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.fig1.1.1.4.3">0.7408</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.fig1.1.1.4.4">0.7404</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.fig1.1.1.4.5">0.7415</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.fig1.1.1.4.6">0.7416</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.fig1.1.1.4.7">0.7418</td>
</tr>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center ltx_align_middle" id="S5.F10" style="width:127.2pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="542" id="S5.T2.1.g1" src="x18.png" width="760"/>
<br class="ltx_break ltx_break"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Dimension robustness scalability of MoC Fusion.</figcaption>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1"><span class="ltx_text ltx_font_bold" id="S6.p1.1.1">Discrete representation learning.</span>
Discrete representation is first introduced by <cite class="ltx_cite ltx_citemacro_citep">(Van Den Oord et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib24" title="">2017</a>)</cite> and shows feasibility and great success in the field of generate models <cite class="ltx_cite ltx_citemacro_citep">(Esser et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib6" title="">2021</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib14" title="">2022</a>; Rombach et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib20" title="">2022</a>; Peebles &amp; Xie, <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib18" title="">2023</a>; Mentzer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib16" title="">2023</a>)</cite>. It utilize vector quantization (VQ) to model distributions over discrete variables with a codebook and define a simple uniform prior instead of Gaussian prior in VAE <cite class="ltx_cite ltx_citemacro_citep">(Kingma, <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib13" title="">2013</a>)</cite> to avoid posterior collapse. RQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib14" title="">2022</a>)</cite> further introduces residual quantization for better minimization of reconstruction error. FSQ <cite class="ltx_cite ltx_citemacro_citep">(Mentzer et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib16" title="">2023</a>)</cite> remove auxiliary losses and replace the vector quantizer in VQ-VAE with a simple scalar quantization.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1"><span class="ltx_text ltx_font_bold" id="S6.p2.1.1">Semantic IDs.</span>
The discrete representation obtained through VQ-VAE can be employed as a semantic clustering IDs, thus capturing the local structure of the LLM embedding to a certain extent.
In the context of the recommendation system, TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib19" title="">2024</a>)</cite> takes advantage of a hierarchical quantizer <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib14" title="">2022</a>)</cite> to convert items into tokens for generative recommendation and retrieval.
LC-Rec <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib27" title="">2024</a>)</cite> improves TIGER by incorporating knowledge from LLMs like LLama <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib23" title="">2023</a>)</cite> and introducing instruction tuning tasks for effective adaptation to recommender systems.
LMINDEXER <cite class="ltx_cite ltx_citemacro_citep">(Jin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09560v1#bib.bib12" title="">2023</a>)</cite> learns the Semantic IDs in a self-supervised styles to obtain the document’s semantic representations and their hierarchical structures.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this paper, we investigate the scalability of semantic representation based on LLM for recommendation.
We unveil that simple methods, such as using a single codebook with multiple embeddings and scaling with hierarchical codebooks in RQ-VAE, do not scale effectively in Semantic Representation.
We propose a novel multiple codebooks method which learn multiple independent Semantic IDs in the VQ-VAE based on LLM embeddings, and then employ these codebooks with a fusion module in the downstream recommendation models.
Comprehensive experiments show that the proposed method successfully achieves scalability regarding discriminability, dimension robustness, and performance.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et al. (2023)</span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bao et al. (2023)</span>
<span class="ltx_bibblock">
Keqin Bao, Jizhi Zhang, Yang Zhang, Wenjie Wang, Fuli Feng, and Xiangnan He.

</span>
<span class="ltx_bibblock">Tallrec: An effective and efficient tuning framework to align large language model with recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the 17th ACM Conference on Recommender Systems</em>, pp.  1007–1014, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">BehnamGhader et al. (2024)</span>
<span class="ltx_bibblock">
Parishad BehnamGhader, Vaibhav Adlakha, Marius Mosbach, Dzmitry Bahdanau, Nicolas Chapados, and Siva Reddy.

</span>
<span class="ltx_bibblock">Llm2vec: Large language models are secretly powerful text encoders.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2404.05961</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen et al. (2009)</span>
<span class="ltx_bibblock">
Israel Cohen, Yiteng Huang, Jingdong Chen, Jacob Benesty, Jacob Benesty, Jingdong Chen, Yiteng Huang, and Israel Cohen.

</span>
<span class="ltx_bibblock">Pearson correlation coefficient.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Noise reduction in speech processing</em>, pp.  1–4, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubey et al. (2024)</span>
<span class="ltx_bibblock">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, et al.

</span>
<span class="ltx_bibblock">The llama 3 herd of models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2407.21783</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Esser et al. (2021)</span>
<span class="ltx_bibblock">
Patrick Esser, Robin Rombach, and Bjorn Ommer.

</span>
<span class="ltx_bibblock">Taming transformers for high-resolution image synthesis.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pp.  12873–12883, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2017)</span>
<span class="ltx_bibblock">
Huifeng Guo, Ruiming Tang, Yunming Ye, Zhenguo Li, and Xiuqiang He.

</span>
<span class="ltx_bibblock">Deepfm: a factorization-machine based neural network for ctr prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:1703.04247</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2023)</span>
<span class="ltx_bibblock">
Xingzhuo Guo, Junwei Pan, Ximei Wang, Baixu Chen, Jie Jiang, and Mingsheng Long.

</span>
<span class="ltx_bibblock">On the embedding collapse when scaling up recommendation models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2310.04400</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He &amp; McAuley (2016)</span>
<span class="ltx_bibblock">
Ruining He and Julian McAuley.

</span>
<span class="ltx_bibblock">Ups and downs: Modeling the visual evolution of fashion trends with one-class collaborative filtering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">proceedings of the 25th international conference on world wide web</em>, pp.  507–517, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al. (2024)</span>
<span class="ltx_bibblock">
Yupeng Hou, Junjie Zhang, Zihan Lin, Hongyu Lu, Ruobing Xie, Julian McAuley, and Wayne Xin Zhao.

</span>
<span class="ltx_bibblock">Large language models are zero-shot rankers for recommender systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">European Conference on Information Retrieval</em>, pp.  364–381. Springer, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jawahar et al. (2019)</span>
<span class="ltx_bibblock">
Ganesh Jawahar, Benoît Sagot, and Djamé Seddah.

</span>
<span class="ltx_bibblock">What does bert learn about the structure of language?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">ACL 2019-57th Annual Meeting of the Association for Computational Linguistics</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al. (2023)</span>
<span class="ltx_bibblock">
Bowen Jin, Hansi Zeng, Guoyin Wang, Xiusi Chen, Tianxin Wei, Ruirui Li, Zhengyang Wang, Zheng Li, Yang Li, Hanqing Lu, et al.

</span>
<span class="ltx_bibblock">Language models as semantic indexers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2310.07815</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma (2013)</span>
<span class="ltx_bibblock">
Diederik P Kingma.

</span>
<span class="ltx_bibblock">Auto-encoding variational bayes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:1312.6114</em>, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2022)</span>
<span class="ltx_bibblock">
Doyup Lee, Chiheon Kim, Saehoon Kim, Minsu Cho, and Wook-Shin Han.

</span>
<span class="ltx_bibblock">Autoregressive image generation using residual quantization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  11523–11532, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2023)</span>
<span class="ltx_bibblock">
Jianghao Lin, Xinyi Dai, Yunjia Xi, Weiwen Liu, Bo Chen, Hao Zhang, Yong Liu, Chuhan Wu, Xiangyang Li, Chenxu Zhu, et al.

</span>
<span class="ltx_bibblock">How can recommender systems benefit from large language models: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2306.05817</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mentzer et al. (2023)</span>
<span class="ltx_bibblock">
Fabian Mentzer, David Minnen, Eirikur Agustsson, and Michael Tschannen.

</span>
<span class="ltx_bibblock">Finite scalar quantization: Vq-vae made simple.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2309.15505</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al. (2024)</span>
<span class="ltx_bibblock">
Junwei Pan, Wei Xue, Ximei Wang, Haibin Yu, Xun Liu, Shijie Quan, Xueming Qiu, Dapeng Liu, Lei Xiao, and Jie Jiang.

</span>
<span class="ltx_bibblock">Ads recommendation in a collapsed and entangled world.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, pp.  5566–5577, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peebles &amp; Xie (2023)</span>
<span class="ltx_bibblock">
William Peebles and Saining Xie.

</span>
<span class="ltx_bibblock">Scalable diffusion models with transformers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pp.  4195–4205, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajput et al. (2024)</span>
<span class="ltx_bibblock">
Shashank Rajput, Nikhil Mehta, Anima Singh, Raghunandan Hulikal Keshavan, Trung Vu, Lukasz Heldt, Lichan Hong, Yi Tay, Vinh Tran, Jonah Samost, et al.

</span>
<span class="ltx_bibblock">Recommender systems with generative retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rombach et al. (2022)</span>
<span class="ltx_bibblock">
Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Björn Ommer.

</span>
<span class="ltx_bibblock">High-resolution image synthesis with latent diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pp.  10684–10695, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singh et al. (2023)</span>
<span class="ltx_bibblock">
Anima Singh, Trung Vu, Nikhil Mehta, Raghunandan Keshavan, Maheswaran Sathiamoorthy, Yilin Zheng, Lichan Hong, Lukasz Heldt, Li Wei, Devansh Tandon, et al.

</span>
<span class="ltx_bibblock">Better generalization with semantic ids: A case study in ranking for recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2306.08121</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2019)</span>
<span class="ltx_bibblock">
Weiping Song, Chence Shi, Zhiping Xiao, Zhijian Duan, Yewen Xu, Ming Zhang, and Jian Tang.

</span>
<span class="ltx_bibblock">Autoint: Automatic feature interaction learning via self-attentive neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>, pp.  1161–1170, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2302.13971</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van Den Oord et al. (2017)</span>
<span class="ltx_bibblock">
Aaron Van Den Oord, Oriol Vinyals, et al.

</span>
<span class="ltx_bibblock">Neural discrete representation learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Rakesh Shivanna, Derek Cheng, Sagar Jain, Dong Lin, Lichan Hong, and Ed Chi.

</span>
<span class="ltx_bibblock">Dcn v2: Improved deep &amp; cross network and practical lessons for web-scale learning to rank systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the web conference 2021</em>, pp.  1785–1797, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2020)</span>
<span class="ltx_bibblock">
Feng Yu, Zhaocheng Liu, Qiang Liu, Haoli Zhang, Shu Wu, and Liang Wang.

</span>
<span class="ltx_bibblock">Deep interaction machine: A simple but effective model for high-order feature interactions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management</em>, pp.  2285–2288, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2024)</span>
<span class="ltx_bibblock">
Bowen Zheng, Yupeng Hou, Hongyu Lu, Yu Chen, Wayne Xin Zhao, Ming Chen, and Ji-Rong Wen.

</span>
<span class="ltx_bibblock">Adapting large language models by integrating collaborative semantics for recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">2024 IEEE 40th International Conference on Data Engineering (ICDE)</em>, pp.  1435–1448. IEEE, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Oct 12 15:10:40 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
