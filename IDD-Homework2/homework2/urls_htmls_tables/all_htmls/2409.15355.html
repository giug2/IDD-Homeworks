<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Block-Attention for Efficient RAG</title>
<!--Generated on Tue Oct  1 03:35:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.15355v3/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S1" title="In Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2" title="In Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Block-Attention</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.SS1" title="In 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Main Idea</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.SS2" title="In 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Block Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.SS3" title="In 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Position Re-Encoding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.SS4" title="In 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Block Fine-tune</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.SS5" title="In 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span>Inference</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3" title="In Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.SS1" title="In 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Datasets</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.SS1.SSS0.Px1" title="In 3.1 Datasets ‣ 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title">Train Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.SS1.SSS0.Px2" title="In 3.1 Datasets ‣ 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title">Evaluation Dataset</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.SS2" title="In 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Input Format</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.SS3" title="In 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Base Model &amp; Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.SS4" title="In 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.SS5" title="In 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Main Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.SS6" title="In 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Inference Efficiency of Block-Attention</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.SS7" title="In 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.7 </span>Discussion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S4" title="In Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S4.SS1" title="In 4 Related Works ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Retrieval-Augmented Generation (RAG)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S4.SS2" title="In 4 Related Works ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Efficiency of RAG</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S5" title="In Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Block-Attention for Efficient RAG</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">East Sun

<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">tianjibai@gmail.com</span>
<br class="ltx_break"/>&amp;Yan Wang<span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span>
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id2.2.id2">yanwang.branden@gmail.com</span>
&amp;Tian Lan
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id3.3.id3">lantiangmftby@gmail.com</span>
</span><span class="ltx_author_notes">  Equal Contribution  Corresponding Author</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id4.id1">We introduce Block-Attention, an attention mechanism designed to address the increased inference latency and cost in Retrieval-Augmented Generation (RAG) scenarios.
Traditional approaches often encode the entire context.
Instead, Block-Attention divides retrieved documents into discrete blocks, with each block independently calculating key-value (KV) states except for the final block.
In RAG scenarios, by defining each passage as a block, Block-Attention enables us to reuse the KV states of passages that have been seen before, thereby significantly reducing the latency and the computation overhead during inference.
The implementation of Block-Attention involves block segmentation, position re-encoding, and fine-tuning the LLM to adapt to the Block-Attention mechanism.
Experiments on four RAG benchmarks demonstrate that after block fine-tuning, the Block-Attention model achieves performance comparable to self-attention models (68.4% vs 67.9% on Llama3) or even superior performance (62.8% vs 59.6% on Mistral).
Notably, Block-Attention significantly reduces the time to first token (TTFT) and floating point operations (FLOPs) to a very low level. It only takes 45 ms to output the first token for an input sequence with a total length of 32K. Compared to the self-attention models, the time consumption and corresponding FLOPs are reduced by 98.7% and 99.8%, respectively.
<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Codes are available at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/TemporaryLoRA/Block-Attention" title="">https://github.com/TemporaryLoRA/Block-Attention</a></span></span></span></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Retrieval-Augmented Generation (RAG) <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib17" title="">2022</a>)</cite> is a crucial technology for mitigating knowledge hallucination in Large Language Models (LLMs). By utilizing retrieval technology, LLMs can seamlessly access passages stored in external databases, grounding their responses in the content of these passages. To the best of our understanding, RAG has emerged as the most effective method for infusing specific domain knowledge into LLMs in real-world scenarios.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, everything has two sides, and RAG is no exception.
Generally, for each user query, in order to ensure that a passage with the “correct knowledge” is successfully recalled, it is a common practice to retrieve multiple passages—typically between 5 to 30 in most scenarios <cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib12" title="">2019</a>; Joshi et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib10" title="">2017</a>)</cite>. These passages are then incorporated into the input prompt for the LLM.
As a result, the inference efficiency decreases significantly due to the increased sequence length of this extended input prompt.
Specifically, the inference latency, measured as the time to first token (TTFT), is considerably higher for a RAG-LLM compared to a non-RAG LLM <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib18" title="">2023</a>; Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib28" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Given that the passages in the external databases might have been computed, it is natural to restore their KV cache for fast inference and avoid re-computing these passages.
Nonetheless, for autoregressive LLMs, the KV states are inherently context-dependent, which means the KV states for the same passage will vary in different contexts.
As a result, when encountering an unseen query, the model must undertake a complete re-encoding of the KV states to ensure an accurate prediction.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we propose the Block-Attention method, which reduces the TTFT and computation FLOPs of RAG-LLMs to a level nearly equivalent to that of non-RAG LLMs, while fully maintaining the same accuracy level. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">1</span></a>, the main idea of Block-Attention is to divide the entire input sequence into several blocks. Each block independently calculates its KV states through self-attention, without any attention to other blocks. Only the final block is able to attend other blocks, <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">i.e.,</span> the user query is able to attend all the retrieved documents in the previous blocks. When utilizing Block-Attention in RAG scenarios, we may achieve substantial benefits by defining each passage as a single block and caching its KV states in the memory for further reuse.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="253" id="S1.F1.g1" src="x1.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The Block-Attention Masks</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The implementation of Block-Attention can be easily achieved through the following steps: 1) Encode all blocks except the last one separately; 2) calculating the positional encoding for each based on its position in the input prompt; 3) Integrating these blocks to compute the KV states for the final block. However, the primary challenge in utilizing Block-Attention is that the LLMs have not been exposed to such an attention mechanism during their training, leading to difficulties in accurately interpreting the input prompt. In our preliminary experiments, we attempted to directly implement Block-Attention in the LLMs without updating any parameters. Unfortunately, this approach resulted in a substantial decrease in performance, with the average accuracy of Llama3-8B on four RAG benchmarks falling from 67.9% to 48.0%.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">To address this challenge, we implemented a fine-tuning process for the LLMs to adapt to the Block-Attention mechanism. Our experiments demonstrated that, after approximately 100 - 1000 fine-tuning steps, the Block-Attention model achieved a full recovery of its original accuracy across both in-domain and out-domain scenarios, impressively increasing from 48.0% to 68.4%. This outcome underscores the Block-Attention LLMs’ capability to uphold inference accuracy while significantly enhancing inference efficiency in RAG scenarios.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">We evaluate Block-Attention on four RAG benchmarks. Experimental results demonstrate that after fine-tuning, the average accuracy of the Block-Attention model on the benchmarks can remain comparable to (68.4% vs 67.9% on Llama3) or even slightly exceed (62.3% vs 59.6% on Mistral) the performance of self-attention models. In terms of efficiency, we counted the TTFT and FLOPs to the first token (FLOPs-TFT) of the block-attention model when the length of user input is 50 and the total length of the input sequence gradually increases. We found that the longer the total length, the more obvious the improvement of block-attention on efficiency. When the length of the input sequence reaches 32K, the TTFT and FLOPs-TFT of the block-attention model are 1.3% and 0.2% of that of the self-attention model, respectively.<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Given that the KV cache is already a mature and low-cost technology <cite class="ltx_cite ltx_citemacro_citep">(Qin et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib20" title="">2024</a>; Lan et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib13" title="">2023</a>; Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib15" title="">2021</a>)</cite>, in this paper we do not take the cost of KV cache into account.</span></span></span></p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Block-Attention</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Main Idea</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.12">Let <math alttext="\mathcal{S}=\{s_{0},s_{1},...,s_{n}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.4"><semantics id="S2.SS1.p1.1.m1.4a"><mrow id="S2.SS1.p1.1.m1.4.4" xref="S2.SS1.p1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.4.4.5" xref="S2.SS1.p1.1.m1.4.4.5.cmml">𝒮</mi><mo id="S2.SS1.p1.1.m1.4.4.4" xref="S2.SS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.1.m1.4.4.3.3" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml"><mo id="S2.SS1.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S2.SS1.p1.1.m1.2.2.1.1.1" xref="S2.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.2.2.1.1.1.2" xref="S2.SS1.p1.1.m1.2.2.1.1.1.2.cmml">s</mi><mn id="S2.SS1.p1.1.m1.2.2.1.1.1.3" xref="S2.SS1.p1.1.m1.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS1.p1.1.m1.4.4.3.3.5" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.1.m1.3.3.2.2.2" xref="S2.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.1.m1.3.3.2.2.2.2" xref="S2.SS1.p1.1.m1.3.3.2.2.2.2.cmml">s</mi><mn id="S2.SS1.p1.1.m1.3.3.2.2.2.3" xref="S2.SS1.p1.1.m1.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S2.SS1.p1.1.m1.4.4.3.3.6" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S2.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S2.SS1.p1.1.m1.4.4.3.3.7" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.1.m1.4.4.3.3.3" xref="S2.SS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.1.m1.4.4.3.3.3.2" xref="S2.SS1.p1.1.m1.4.4.3.3.3.2.cmml">s</mi><mi id="S2.SS1.p1.1.m1.4.4.3.3.3.3" xref="S2.SS1.p1.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S2.SS1.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.4b"><apply id="S2.SS1.p1.1.m1.4.4.cmml" xref="S2.SS1.p1.1.m1.4.4"><eq id="S2.SS1.p1.1.m1.4.4.4.cmml" xref="S2.SS1.p1.1.m1.4.4.4"></eq><ci id="S2.SS1.p1.1.m1.4.4.5.cmml" xref="S2.SS1.p1.1.m1.4.4.5">𝒮</ci><set id="S2.SS1.p1.1.m1.4.4.3.4.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3"><apply id="S2.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1.2">𝑠</ci><cn id="S2.SS1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.2.2.1.1.1.3">0</cn></apply><apply id="S2.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2.2">𝑠</ci><cn id="S2.SS1.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.3.3.2.2.2.3">1</cn></apply><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">…</ci><apply id="S2.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3.2">𝑠</ci><ci id="S2.SS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.4c">\mathcal{S}=\{s_{0},s_{1},...,s_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.4d">caligraphic_S = { italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> represents the input sequence, where each <math alttext="s" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_s</annotation></semantics></math> represents a token. We denote the KV states associated with <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">caligraphic_S</annotation></semantics></math> as <math alttext="\mathcal{K}=\{k_{0},k_{1},...,k_{n}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.4"><semantics id="S2.SS1.p1.4.m4.4a"><mrow id="S2.SS1.p1.4.m4.4.4" xref="S2.SS1.p1.4.m4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.4.4.5" xref="S2.SS1.p1.4.m4.4.4.5.cmml">𝒦</mi><mo id="S2.SS1.p1.4.m4.4.4.4" xref="S2.SS1.p1.4.m4.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.4.m4.4.4.3.3" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml"><mo id="S2.SS1.p1.4.m4.4.4.3.3.4" stretchy="false" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml">{</mo><msub id="S2.SS1.p1.4.m4.2.2.1.1.1" xref="S2.SS1.p1.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.4.m4.2.2.1.1.1.2" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml">k</mi><mn id="S2.SS1.p1.4.m4.2.2.1.1.1.3" xref="S2.SS1.p1.4.m4.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS1.p1.4.m4.4.4.3.3.5" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.4.m4.3.3.2.2.2" xref="S2.SS1.p1.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.4.m4.3.3.2.2.2.2" xref="S2.SS1.p1.4.m4.3.3.2.2.2.2.cmml">k</mi><mn id="S2.SS1.p1.4.m4.3.3.2.2.2.3" xref="S2.SS1.p1.4.m4.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S2.SS1.p1.4.m4.4.4.3.3.6" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p1.4.m4.1.1" mathvariant="normal" xref="S2.SS1.p1.4.m4.1.1.cmml">…</mi><mo id="S2.SS1.p1.4.m4.4.4.3.3.7" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.4.m4.4.4.3.3.3" xref="S2.SS1.p1.4.m4.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.4.m4.4.4.3.3.3.2" xref="S2.SS1.p1.4.m4.4.4.3.3.3.2.cmml">k</mi><mi id="S2.SS1.p1.4.m4.4.4.3.3.3.3" xref="S2.SS1.p1.4.m4.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S2.SS1.p1.4.m4.4.4.3.3.8" stretchy="false" xref="S2.SS1.p1.4.m4.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.4b"><apply id="S2.SS1.p1.4.m4.4.4.cmml" xref="S2.SS1.p1.4.m4.4.4"><eq id="S2.SS1.p1.4.m4.4.4.4.cmml" xref="S2.SS1.p1.4.m4.4.4.4"></eq><ci id="S2.SS1.p1.4.m4.4.4.5.cmml" xref="S2.SS1.p1.4.m4.4.4.5">𝒦</ci><set id="S2.SS1.p1.4.m4.4.4.3.4.cmml" xref="S2.SS1.p1.4.m4.4.4.3.3"><apply id="S2.SS1.p1.4.m4.2.2.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2">𝑘</ci><cn id="S2.SS1.p1.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.2.2.1.1.1.3">0</cn></apply><apply id="S2.SS1.p1.4.m4.3.3.2.2.2.cmml" xref="S2.SS1.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.4.m4.3.3.2.2.2.2">𝑘</ci><cn id="S2.SS1.p1.4.m4.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.3.3.2.2.2.3">1</cn></apply><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">…</ci><apply id="S2.SS1.p1.4.m4.4.4.3.3.3.cmml" xref="S2.SS1.p1.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.4.m4.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.4.m4.4.4.3.3.3.2">𝑘</ci><ci id="S2.SS1.p1.4.m4.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.4.m4.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.4c">\mathcal{K}=\{k_{0},k_{1},...,k_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.4d">caligraphic_K = { italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_k start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> and <math alttext="\mathcal{V}=\{v_{0},v_{1},...,v_{n}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.4"><semantics id="S2.SS1.p1.5.m5.4a"><mrow id="S2.SS1.p1.5.m5.4.4" xref="S2.SS1.p1.5.m5.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.5.m5.4.4.5" xref="S2.SS1.p1.5.m5.4.4.5.cmml">𝒱</mi><mo id="S2.SS1.p1.5.m5.4.4.4" xref="S2.SS1.p1.5.m5.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.5.m5.4.4.3.3" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml"><mo id="S2.SS1.p1.5.m5.4.4.3.3.4" stretchy="false" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml">{</mo><msub id="S2.SS1.p1.5.m5.2.2.1.1.1" xref="S2.SS1.p1.5.m5.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.5.m5.2.2.1.1.1.2" xref="S2.SS1.p1.5.m5.2.2.1.1.1.2.cmml">v</mi><mn id="S2.SS1.p1.5.m5.2.2.1.1.1.3" xref="S2.SS1.p1.5.m5.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS1.p1.5.m5.4.4.3.3.5" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.5.m5.3.3.2.2.2" xref="S2.SS1.p1.5.m5.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.5.m5.3.3.2.2.2.2" xref="S2.SS1.p1.5.m5.3.3.2.2.2.2.cmml">v</mi><mn id="S2.SS1.p1.5.m5.3.3.2.2.2.3" xref="S2.SS1.p1.5.m5.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S2.SS1.p1.5.m5.4.4.3.3.6" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p1.5.m5.1.1" mathvariant="normal" xref="S2.SS1.p1.5.m5.1.1.cmml">…</mi><mo id="S2.SS1.p1.5.m5.4.4.3.3.7" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p1.5.m5.4.4.3.3.3" xref="S2.SS1.p1.5.m5.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.5.m5.4.4.3.3.3.2" xref="S2.SS1.p1.5.m5.4.4.3.3.3.2.cmml">v</mi><mi id="S2.SS1.p1.5.m5.4.4.3.3.3.3" xref="S2.SS1.p1.5.m5.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S2.SS1.p1.5.m5.4.4.3.3.8" stretchy="false" xref="S2.SS1.p1.5.m5.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.4b"><apply id="S2.SS1.p1.5.m5.4.4.cmml" xref="S2.SS1.p1.5.m5.4.4"><eq id="S2.SS1.p1.5.m5.4.4.4.cmml" xref="S2.SS1.p1.5.m5.4.4.4"></eq><ci id="S2.SS1.p1.5.m5.4.4.5.cmml" xref="S2.SS1.p1.5.m5.4.4.5">𝒱</ci><set id="S2.SS1.p1.5.m5.4.4.3.4.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3"><apply id="S2.SS1.p1.5.m5.2.2.1.1.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1.1.2">𝑣</ci><cn id="S2.SS1.p1.5.m5.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.2.2.1.1.1.3">0</cn></apply><apply id="S2.SS1.p1.5.m5.3.3.2.2.2.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.5.m5.3.3.2.2.2.2">𝑣</ci><cn id="S2.SS1.p1.5.m5.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.5.m5.3.3.2.2.2.3">1</cn></apply><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">…</ci><apply id="S2.SS1.p1.5.m5.4.4.3.3.3.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.5.m5.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3.2">𝑣</ci><ci id="S2.SS1.p1.5.m5.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.5.m5.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.4c">\mathcal{V}=\{v_{0},v_{1},...,v_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.4d">caligraphic_V = { italic_v start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>, respectively. For an auto-regressive model <math alttext="\Theta_{LLM}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" mathvariant="normal" xref="S2.SS1.p1.6.m6.1.1.2.cmml">Θ</mi><mrow id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml"><mi id="S2.SS1.p1.6.m6.1.1.3.2" xref="S2.SS1.p1.6.m6.1.1.3.2.cmml">L</mi><mo id="S2.SS1.p1.6.m6.1.1.3.1" xref="S2.SS1.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.6.m6.1.1.3.3" xref="S2.SS1.p1.6.m6.1.1.3.3.cmml">L</mi><mo id="S2.SS1.p1.6.m6.1.1.3.1a" xref="S2.SS1.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.6.m6.1.1.3.4" xref="S2.SS1.p1.6.m6.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">Θ</ci><apply id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3"><times id="S2.SS1.p1.6.m6.1.1.3.1.cmml" xref="S2.SS1.p1.6.m6.1.1.3.1"></times><ci id="S2.SS1.p1.6.m6.1.1.3.2.cmml" xref="S2.SS1.p1.6.m6.1.1.3.2">𝐿</ci><ci id="S2.SS1.p1.6.m6.1.1.3.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3.3">𝐿</ci><ci id="S2.SS1.p1.6.m6.1.1.3.4.cmml" xref="S2.SS1.p1.6.m6.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\Theta_{LLM}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">roman_Θ start_POSTSUBSCRIPT italic_L italic_L italic_M end_POSTSUBSCRIPT</annotation></semantics></math>, since the computation of the KV states is dependent on their preceding tokens, when a text block {<math alttext="s_{i},...,s_{j}\}" class="ltx_math_unparsed" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><mrow id="S2.SS1.p1.7.m7.1b"><msub id="S2.SS1.p1.7.m7.1.2"><mi id="S2.SS1.p1.7.m7.1.2.2">s</mi><mi id="S2.SS1.p1.7.m7.1.2.3">i</mi></msub><mo id="S2.SS1.p1.7.m7.1.3">,</mo><mi id="S2.SS1.p1.7.m7.1.1" mathvariant="normal">…</mi><mo id="S2.SS1.p1.7.m7.1.4">,</mo><msub id="S2.SS1.p1.7.m7.1.5"><mi id="S2.SS1.p1.7.m7.1.5.2">s</mi><mi id="S2.SS1.p1.7.m7.1.5.3">j</mi></msub><mo id="S2.SS1.p1.7.m7.1.6" stretchy="false">}</mo></mrow><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">s_{i},...,s_{j}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT }</annotation></semantics></math> changes to a new text block {<math alttext="s^{\prime}_{i},...,s^{\prime}_{m}\}" class="ltx_math_unparsed" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><mrow id="S2.SS1.p1.8.m8.1b"><msubsup id="S2.SS1.p1.8.m8.1.2"><mi id="S2.SS1.p1.8.m8.1.2.2.2">s</mi><mi id="S2.SS1.p1.8.m8.1.2.3">i</mi><mo id="S2.SS1.p1.8.m8.1.2.2.3">′</mo></msubsup><mo id="S2.SS1.p1.8.m8.1.3">,</mo><mi id="S2.SS1.p1.8.m8.1.1" mathvariant="normal">…</mi><mo id="S2.SS1.p1.8.m8.1.4">,</mo><msubsup id="S2.SS1.p1.8.m8.1.5"><mi id="S2.SS1.p1.8.m8.1.5.2.2">s</mi><mi id="S2.SS1.p1.8.m8.1.5.3">m</mi><mo id="S2.SS1.p1.8.m8.1.5.2.3">′</mo></msubsup><mo id="S2.SS1.p1.8.m8.1.6" stretchy="false">}</mo></mrow><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">s^{\prime}_{i},...,s^{\prime}_{m}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , … , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT }</annotation></semantics></math>, for the new sequence <math alttext="\mathcal{S^{\prime}}=\{s_{0},...,s^{\prime}_{i},...,s^{\prime}_{m},s_{j+1},...%
,s_{n}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.8"><semantics id="S2.SS1.p1.9.m9.8a"><mrow id="S2.SS1.p1.9.m9.8.8" xref="S2.SS1.p1.9.m9.8.8.cmml"><msup id="S2.SS1.p1.9.m9.8.8.7" xref="S2.SS1.p1.9.m9.8.8.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.9.m9.8.8.7.2" xref="S2.SS1.p1.9.m9.8.8.7.2.cmml">𝒮</mi><mo id="S2.SS1.p1.9.m9.8.8.7.3" xref="S2.SS1.p1.9.m9.8.8.7.3.cmml">′</mo></msup><mo id="S2.SS1.p1.9.m9.8.8.6" xref="S2.SS1.p1.9.m9.8.8.6.cmml">=</mo><mrow id="S2.SS1.p1.9.m9.8.8.5.5" xref="S2.SS1.p1.9.m9.8.8.5.6.cmml"><mo id="S2.SS1.p1.9.m9.8.8.5.5.6" stretchy="false" xref="S2.SS1.p1.9.m9.8.8.5.6.cmml">{</mo><msub id="S2.SS1.p1.9.m9.4.4.1.1.1" xref="S2.SS1.p1.9.m9.4.4.1.1.1.cmml"><mi id="S2.SS1.p1.9.m9.4.4.1.1.1.2" xref="S2.SS1.p1.9.m9.4.4.1.1.1.2.cmml">s</mi><mn id="S2.SS1.p1.9.m9.4.4.1.1.1.3" xref="S2.SS1.p1.9.m9.4.4.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS1.p1.9.m9.8.8.5.5.7" xref="S2.SS1.p1.9.m9.8.8.5.6.cmml">,</mo><mi id="S2.SS1.p1.9.m9.1.1" mathvariant="normal" xref="S2.SS1.p1.9.m9.1.1.cmml">…</mi><mo id="S2.SS1.p1.9.m9.8.8.5.5.8" xref="S2.SS1.p1.9.m9.8.8.5.6.cmml">,</mo><msubsup id="S2.SS1.p1.9.m9.5.5.2.2.2" xref="S2.SS1.p1.9.m9.5.5.2.2.2.cmml"><mi id="S2.SS1.p1.9.m9.5.5.2.2.2.2.2" xref="S2.SS1.p1.9.m9.5.5.2.2.2.2.2.cmml">s</mi><mi id="S2.SS1.p1.9.m9.5.5.2.2.2.3" xref="S2.SS1.p1.9.m9.5.5.2.2.2.3.cmml">i</mi><mo id="S2.SS1.p1.9.m9.5.5.2.2.2.2.3" xref="S2.SS1.p1.9.m9.5.5.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S2.SS1.p1.9.m9.8.8.5.5.9" xref="S2.SS1.p1.9.m9.8.8.5.6.cmml">,</mo><mi id="S2.SS1.p1.9.m9.2.2" mathvariant="normal" xref="S2.SS1.p1.9.m9.2.2.cmml">…</mi><mo id="S2.SS1.p1.9.m9.8.8.5.5.10" xref="S2.SS1.p1.9.m9.8.8.5.6.cmml">,</mo><msubsup id="S2.SS1.p1.9.m9.6.6.3.3.3" xref="S2.SS1.p1.9.m9.6.6.3.3.3.cmml"><mi id="S2.SS1.p1.9.m9.6.6.3.3.3.2.2" xref="S2.SS1.p1.9.m9.6.6.3.3.3.2.2.cmml">s</mi><mi id="S2.SS1.p1.9.m9.6.6.3.3.3.3" xref="S2.SS1.p1.9.m9.6.6.3.3.3.3.cmml">m</mi><mo id="S2.SS1.p1.9.m9.6.6.3.3.3.2.3" xref="S2.SS1.p1.9.m9.6.6.3.3.3.2.3.cmml">′</mo></msubsup><mo id="S2.SS1.p1.9.m9.8.8.5.5.11" xref="S2.SS1.p1.9.m9.8.8.5.6.cmml">,</mo><msub id="S2.SS1.p1.9.m9.7.7.4.4.4" xref="S2.SS1.p1.9.m9.7.7.4.4.4.cmml"><mi id="S2.SS1.p1.9.m9.7.7.4.4.4.2" xref="S2.SS1.p1.9.m9.7.7.4.4.4.2.cmml">s</mi><mrow id="S2.SS1.p1.9.m9.7.7.4.4.4.3" xref="S2.SS1.p1.9.m9.7.7.4.4.4.3.cmml"><mi id="S2.SS1.p1.9.m9.7.7.4.4.4.3.2" xref="S2.SS1.p1.9.m9.7.7.4.4.4.3.2.cmml">j</mi><mo id="S2.SS1.p1.9.m9.7.7.4.4.4.3.1" xref="S2.SS1.p1.9.m9.7.7.4.4.4.3.1.cmml">+</mo><mn id="S2.SS1.p1.9.m9.7.7.4.4.4.3.3" xref="S2.SS1.p1.9.m9.7.7.4.4.4.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS1.p1.9.m9.8.8.5.5.12" xref="S2.SS1.p1.9.m9.8.8.5.6.cmml">,</mo><mi id="S2.SS1.p1.9.m9.3.3" mathvariant="normal" xref="S2.SS1.p1.9.m9.3.3.cmml">…</mi><mo id="S2.SS1.p1.9.m9.8.8.5.5.13" xref="S2.SS1.p1.9.m9.8.8.5.6.cmml">,</mo><msub id="S2.SS1.p1.9.m9.8.8.5.5.5" xref="S2.SS1.p1.9.m9.8.8.5.5.5.cmml"><mi id="S2.SS1.p1.9.m9.8.8.5.5.5.2" xref="S2.SS1.p1.9.m9.8.8.5.5.5.2.cmml">s</mi><mi id="S2.SS1.p1.9.m9.8.8.5.5.5.3" xref="S2.SS1.p1.9.m9.8.8.5.5.5.3.cmml">n</mi></msub><mo id="S2.SS1.p1.9.m9.8.8.5.5.14" stretchy="false" xref="S2.SS1.p1.9.m9.8.8.5.6.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.8b"><apply id="S2.SS1.p1.9.m9.8.8.cmml" xref="S2.SS1.p1.9.m9.8.8"><eq id="S2.SS1.p1.9.m9.8.8.6.cmml" xref="S2.SS1.p1.9.m9.8.8.6"></eq><apply id="S2.SS1.p1.9.m9.8.8.7.cmml" xref="S2.SS1.p1.9.m9.8.8.7"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.8.8.7.1.cmml" xref="S2.SS1.p1.9.m9.8.8.7">superscript</csymbol><ci id="S2.SS1.p1.9.m9.8.8.7.2.cmml" xref="S2.SS1.p1.9.m9.8.8.7.2">𝒮</ci><ci id="S2.SS1.p1.9.m9.8.8.7.3.cmml" xref="S2.SS1.p1.9.m9.8.8.7.3">′</ci></apply><set id="S2.SS1.p1.9.m9.8.8.5.6.cmml" xref="S2.SS1.p1.9.m9.8.8.5.5"><apply id="S2.SS1.p1.9.m9.4.4.1.1.1.cmml" xref="S2.SS1.p1.9.m9.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.4.4.1.1.1.1.cmml" xref="S2.SS1.p1.9.m9.4.4.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m9.4.4.1.1.1.2.cmml" xref="S2.SS1.p1.9.m9.4.4.1.1.1.2">𝑠</ci><cn id="S2.SS1.p1.9.m9.4.4.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.9.m9.4.4.1.1.1.3">0</cn></apply><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">…</ci><apply id="S2.SS1.p1.9.m9.5.5.2.2.2.cmml" xref="S2.SS1.p1.9.m9.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.5.5.2.2.2.1.cmml" xref="S2.SS1.p1.9.m9.5.5.2.2.2">subscript</csymbol><apply id="S2.SS1.p1.9.m9.5.5.2.2.2.2.cmml" xref="S2.SS1.p1.9.m9.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.5.5.2.2.2.2.1.cmml" xref="S2.SS1.p1.9.m9.5.5.2.2.2">superscript</csymbol><ci id="S2.SS1.p1.9.m9.5.5.2.2.2.2.2.cmml" xref="S2.SS1.p1.9.m9.5.5.2.2.2.2.2">𝑠</ci><ci id="S2.SS1.p1.9.m9.5.5.2.2.2.2.3.cmml" xref="S2.SS1.p1.9.m9.5.5.2.2.2.2.3">′</ci></apply><ci id="S2.SS1.p1.9.m9.5.5.2.2.2.3.cmml" xref="S2.SS1.p1.9.m9.5.5.2.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.9.m9.2.2.cmml" xref="S2.SS1.p1.9.m9.2.2">…</ci><apply id="S2.SS1.p1.9.m9.6.6.3.3.3.cmml" xref="S2.SS1.p1.9.m9.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.6.6.3.3.3.1.cmml" xref="S2.SS1.p1.9.m9.6.6.3.3.3">subscript</csymbol><apply id="S2.SS1.p1.9.m9.6.6.3.3.3.2.cmml" xref="S2.SS1.p1.9.m9.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.6.6.3.3.3.2.1.cmml" xref="S2.SS1.p1.9.m9.6.6.3.3.3">superscript</csymbol><ci id="S2.SS1.p1.9.m9.6.6.3.3.3.2.2.cmml" xref="S2.SS1.p1.9.m9.6.6.3.3.3.2.2">𝑠</ci><ci id="S2.SS1.p1.9.m9.6.6.3.3.3.2.3.cmml" xref="S2.SS1.p1.9.m9.6.6.3.3.3.2.3">′</ci></apply><ci id="S2.SS1.p1.9.m9.6.6.3.3.3.3.cmml" xref="S2.SS1.p1.9.m9.6.6.3.3.3.3">𝑚</ci></apply><apply id="S2.SS1.p1.9.m9.7.7.4.4.4.cmml" xref="S2.SS1.p1.9.m9.7.7.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.7.7.4.4.4.1.cmml" xref="S2.SS1.p1.9.m9.7.7.4.4.4">subscript</csymbol><ci id="S2.SS1.p1.9.m9.7.7.4.4.4.2.cmml" xref="S2.SS1.p1.9.m9.7.7.4.4.4.2">𝑠</ci><apply id="S2.SS1.p1.9.m9.7.7.4.4.4.3.cmml" xref="S2.SS1.p1.9.m9.7.7.4.4.4.3"><plus id="S2.SS1.p1.9.m9.7.7.4.4.4.3.1.cmml" xref="S2.SS1.p1.9.m9.7.7.4.4.4.3.1"></plus><ci id="S2.SS1.p1.9.m9.7.7.4.4.4.3.2.cmml" xref="S2.SS1.p1.9.m9.7.7.4.4.4.3.2">𝑗</ci><cn id="S2.SS1.p1.9.m9.7.7.4.4.4.3.3.cmml" type="integer" xref="S2.SS1.p1.9.m9.7.7.4.4.4.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.9.m9.3.3.cmml" xref="S2.SS1.p1.9.m9.3.3">…</ci><apply id="S2.SS1.p1.9.m9.8.8.5.5.5.cmml" xref="S2.SS1.p1.9.m9.8.8.5.5.5"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.8.8.5.5.5.1.cmml" xref="S2.SS1.p1.9.m9.8.8.5.5.5">subscript</csymbol><ci id="S2.SS1.p1.9.m9.8.8.5.5.5.2.cmml" xref="S2.SS1.p1.9.m9.8.8.5.5.5.2">𝑠</ci><ci id="S2.SS1.p1.9.m9.8.8.5.5.5.3.cmml" xref="S2.SS1.p1.9.m9.8.8.5.5.5.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.8c">\mathcal{S^{\prime}}=\{s_{0},...,s^{\prime}_{i},...,s^{\prime}_{m},s_{j+1},...%
,s_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.8d">caligraphic_S start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = { italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , … , italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_j + 1 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>, its KV states become <math alttext="\mathcal{K^{\prime}}=\{k_{0},...,k^{\prime}_{i},...,k^{\prime}_{m},k^{\prime}_%
{j+1},...,k^{\prime}_{n}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.8"><semantics id="S2.SS1.p1.10.m10.8a"><mrow id="S2.SS1.p1.10.m10.8.8" xref="S2.SS1.p1.10.m10.8.8.cmml"><msup id="S2.SS1.p1.10.m10.8.8.7" xref="S2.SS1.p1.10.m10.8.8.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.10.m10.8.8.7.2" xref="S2.SS1.p1.10.m10.8.8.7.2.cmml">𝒦</mi><mo id="S2.SS1.p1.10.m10.8.8.7.3" xref="S2.SS1.p1.10.m10.8.8.7.3.cmml">′</mo></msup><mo id="S2.SS1.p1.10.m10.8.8.6" xref="S2.SS1.p1.10.m10.8.8.6.cmml">=</mo><mrow id="S2.SS1.p1.10.m10.8.8.5.5" xref="S2.SS1.p1.10.m10.8.8.5.6.cmml"><mo id="S2.SS1.p1.10.m10.8.8.5.5.6" stretchy="false" xref="S2.SS1.p1.10.m10.8.8.5.6.cmml">{</mo><msub id="S2.SS1.p1.10.m10.4.4.1.1.1" xref="S2.SS1.p1.10.m10.4.4.1.1.1.cmml"><mi id="S2.SS1.p1.10.m10.4.4.1.1.1.2" xref="S2.SS1.p1.10.m10.4.4.1.1.1.2.cmml">k</mi><mn id="S2.SS1.p1.10.m10.4.4.1.1.1.3" xref="S2.SS1.p1.10.m10.4.4.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS1.p1.10.m10.8.8.5.5.7" xref="S2.SS1.p1.10.m10.8.8.5.6.cmml">,</mo><mi id="S2.SS1.p1.10.m10.1.1" mathvariant="normal" xref="S2.SS1.p1.10.m10.1.1.cmml">…</mi><mo id="S2.SS1.p1.10.m10.8.8.5.5.8" xref="S2.SS1.p1.10.m10.8.8.5.6.cmml">,</mo><msubsup id="S2.SS1.p1.10.m10.5.5.2.2.2" xref="S2.SS1.p1.10.m10.5.5.2.2.2.cmml"><mi id="S2.SS1.p1.10.m10.5.5.2.2.2.2.2" xref="S2.SS1.p1.10.m10.5.5.2.2.2.2.2.cmml">k</mi><mi id="S2.SS1.p1.10.m10.5.5.2.2.2.3" xref="S2.SS1.p1.10.m10.5.5.2.2.2.3.cmml">i</mi><mo id="S2.SS1.p1.10.m10.5.5.2.2.2.2.3" xref="S2.SS1.p1.10.m10.5.5.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S2.SS1.p1.10.m10.8.8.5.5.9" xref="S2.SS1.p1.10.m10.8.8.5.6.cmml">,</mo><mi id="S2.SS1.p1.10.m10.2.2" mathvariant="normal" xref="S2.SS1.p1.10.m10.2.2.cmml">…</mi><mo id="S2.SS1.p1.10.m10.8.8.5.5.10" xref="S2.SS1.p1.10.m10.8.8.5.6.cmml">,</mo><msubsup id="S2.SS1.p1.10.m10.6.6.3.3.3" xref="S2.SS1.p1.10.m10.6.6.3.3.3.cmml"><mi id="S2.SS1.p1.10.m10.6.6.3.3.3.2.2" xref="S2.SS1.p1.10.m10.6.6.3.3.3.2.2.cmml">k</mi><mi id="S2.SS1.p1.10.m10.6.6.3.3.3.3" xref="S2.SS1.p1.10.m10.6.6.3.3.3.3.cmml">m</mi><mo id="S2.SS1.p1.10.m10.6.6.3.3.3.2.3" xref="S2.SS1.p1.10.m10.6.6.3.3.3.2.3.cmml">′</mo></msubsup><mo id="S2.SS1.p1.10.m10.8.8.5.5.11" xref="S2.SS1.p1.10.m10.8.8.5.6.cmml">,</mo><msubsup id="S2.SS1.p1.10.m10.7.7.4.4.4" xref="S2.SS1.p1.10.m10.7.7.4.4.4.cmml"><mi id="S2.SS1.p1.10.m10.7.7.4.4.4.2.2" xref="S2.SS1.p1.10.m10.7.7.4.4.4.2.2.cmml">k</mi><mrow id="S2.SS1.p1.10.m10.7.7.4.4.4.3" xref="S2.SS1.p1.10.m10.7.7.4.4.4.3.cmml"><mi id="S2.SS1.p1.10.m10.7.7.4.4.4.3.2" xref="S2.SS1.p1.10.m10.7.7.4.4.4.3.2.cmml">j</mi><mo id="S2.SS1.p1.10.m10.7.7.4.4.4.3.1" xref="S2.SS1.p1.10.m10.7.7.4.4.4.3.1.cmml">+</mo><mn id="S2.SS1.p1.10.m10.7.7.4.4.4.3.3" xref="S2.SS1.p1.10.m10.7.7.4.4.4.3.3.cmml">1</mn></mrow><mo id="S2.SS1.p1.10.m10.7.7.4.4.4.2.3" xref="S2.SS1.p1.10.m10.7.7.4.4.4.2.3.cmml">′</mo></msubsup><mo id="S2.SS1.p1.10.m10.8.8.5.5.12" xref="S2.SS1.p1.10.m10.8.8.5.6.cmml">,</mo><mi id="S2.SS1.p1.10.m10.3.3" mathvariant="normal" xref="S2.SS1.p1.10.m10.3.3.cmml">…</mi><mo id="S2.SS1.p1.10.m10.8.8.5.5.13" xref="S2.SS1.p1.10.m10.8.8.5.6.cmml">,</mo><msubsup id="S2.SS1.p1.10.m10.8.8.5.5.5" xref="S2.SS1.p1.10.m10.8.8.5.5.5.cmml"><mi id="S2.SS1.p1.10.m10.8.8.5.5.5.2.2" xref="S2.SS1.p1.10.m10.8.8.5.5.5.2.2.cmml">k</mi><mi id="S2.SS1.p1.10.m10.8.8.5.5.5.3" xref="S2.SS1.p1.10.m10.8.8.5.5.5.3.cmml">n</mi><mo id="S2.SS1.p1.10.m10.8.8.5.5.5.2.3" xref="S2.SS1.p1.10.m10.8.8.5.5.5.2.3.cmml">′</mo></msubsup><mo id="S2.SS1.p1.10.m10.8.8.5.5.14" stretchy="false" xref="S2.SS1.p1.10.m10.8.8.5.6.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.8b"><apply id="S2.SS1.p1.10.m10.8.8.cmml" xref="S2.SS1.p1.10.m10.8.8"><eq id="S2.SS1.p1.10.m10.8.8.6.cmml" xref="S2.SS1.p1.10.m10.8.8.6"></eq><apply id="S2.SS1.p1.10.m10.8.8.7.cmml" xref="S2.SS1.p1.10.m10.8.8.7"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.8.8.7.1.cmml" xref="S2.SS1.p1.10.m10.8.8.7">superscript</csymbol><ci id="S2.SS1.p1.10.m10.8.8.7.2.cmml" xref="S2.SS1.p1.10.m10.8.8.7.2">𝒦</ci><ci id="S2.SS1.p1.10.m10.8.8.7.3.cmml" xref="S2.SS1.p1.10.m10.8.8.7.3">′</ci></apply><set id="S2.SS1.p1.10.m10.8.8.5.6.cmml" xref="S2.SS1.p1.10.m10.8.8.5.5"><apply id="S2.SS1.p1.10.m10.4.4.1.1.1.cmml" xref="S2.SS1.p1.10.m10.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.4.4.1.1.1.1.cmml" xref="S2.SS1.p1.10.m10.4.4.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m10.4.4.1.1.1.2.cmml" xref="S2.SS1.p1.10.m10.4.4.1.1.1.2">𝑘</ci><cn id="S2.SS1.p1.10.m10.4.4.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.10.m10.4.4.1.1.1.3">0</cn></apply><ci id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">…</ci><apply id="S2.SS1.p1.10.m10.5.5.2.2.2.cmml" xref="S2.SS1.p1.10.m10.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.5.5.2.2.2.1.cmml" xref="S2.SS1.p1.10.m10.5.5.2.2.2">subscript</csymbol><apply id="S2.SS1.p1.10.m10.5.5.2.2.2.2.cmml" xref="S2.SS1.p1.10.m10.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.5.5.2.2.2.2.1.cmml" xref="S2.SS1.p1.10.m10.5.5.2.2.2">superscript</csymbol><ci id="S2.SS1.p1.10.m10.5.5.2.2.2.2.2.cmml" xref="S2.SS1.p1.10.m10.5.5.2.2.2.2.2">𝑘</ci><ci id="S2.SS1.p1.10.m10.5.5.2.2.2.2.3.cmml" xref="S2.SS1.p1.10.m10.5.5.2.2.2.2.3">′</ci></apply><ci id="S2.SS1.p1.10.m10.5.5.2.2.2.3.cmml" xref="S2.SS1.p1.10.m10.5.5.2.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.10.m10.2.2.cmml" xref="S2.SS1.p1.10.m10.2.2">…</ci><apply id="S2.SS1.p1.10.m10.6.6.3.3.3.cmml" xref="S2.SS1.p1.10.m10.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.6.6.3.3.3.1.cmml" xref="S2.SS1.p1.10.m10.6.6.3.3.3">subscript</csymbol><apply id="S2.SS1.p1.10.m10.6.6.3.3.3.2.cmml" xref="S2.SS1.p1.10.m10.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.6.6.3.3.3.2.1.cmml" xref="S2.SS1.p1.10.m10.6.6.3.3.3">superscript</csymbol><ci id="S2.SS1.p1.10.m10.6.6.3.3.3.2.2.cmml" xref="S2.SS1.p1.10.m10.6.6.3.3.3.2.2">𝑘</ci><ci id="S2.SS1.p1.10.m10.6.6.3.3.3.2.3.cmml" xref="S2.SS1.p1.10.m10.6.6.3.3.3.2.3">′</ci></apply><ci id="S2.SS1.p1.10.m10.6.6.3.3.3.3.cmml" xref="S2.SS1.p1.10.m10.6.6.3.3.3.3">𝑚</ci></apply><apply id="S2.SS1.p1.10.m10.7.7.4.4.4.cmml" xref="S2.SS1.p1.10.m10.7.7.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.7.7.4.4.4.1.cmml" xref="S2.SS1.p1.10.m10.7.7.4.4.4">subscript</csymbol><apply id="S2.SS1.p1.10.m10.7.7.4.4.4.2.cmml" xref="S2.SS1.p1.10.m10.7.7.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.7.7.4.4.4.2.1.cmml" xref="S2.SS1.p1.10.m10.7.7.4.4.4">superscript</csymbol><ci id="S2.SS1.p1.10.m10.7.7.4.4.4.2.2.cmml" xref="S2.SS1.p1.10.m10.7.7.4.4.4.2.2">𝑘</ci><ci id="S2.SS1.p1.10.m10.7.7.4.4.4.2.3.cmml" xref="S2.SS1.p1.10.m10.7.7.4.4.4.2.3">′</ci></apply><apply id="S2.SS1.p1.10.m10.7.7.4.4.4.3.cmml" xref="S2.SS1.p1.10.m10.7.7.4.4.4.3"><plus id="S2.SS1.p1.10.m10.7.7.4.4.4.3.1.cmml" xref="S2.SS1.p1.10.m10.7.7.4.4.4.3.1"></plus><ci id="S2.SS1.p1.10.m10.7.7.4.4.4.3.2.cmml" xref="S2.SS1.p1.10.m10.7.7.4.4.4.3.2">𝑗</ci><cn id="S2.SS1.p1.10.m10.7.7.4.4.4.3.3.cmml" type="integer" xref="S2.SS1.p1.10.m10.7.7.4.4.4.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.10.m10.3.3.cmml" xref="S2.SS1.p1.10.m10.3.3">…</ci><apply id="S2.SS1.p1.10.m10.8.8.5.5.5.cmml" xref="S2.SS1.p1.10.m10.8.8.5.5.5"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.8.8.5.5.5.1.cmml" xref="S2.SS1.p1.10.m10.8.8.5.5.5">subscript</csymbol><apply id="S2.SS1.p1.10.m10.8.8.5.5.5.2.cmml" xref="S2.SS1.p1.10.m10.8.8.5.5.5"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.8.8.5.5.5.2.1.cmml" xref="S2.SS1.p1.10.m10.8.8.5.5.5">superscript</csymbol><ci id="S2.SS1.p1.10.m10.8.8.5.5.5.2.2.cmml" xref="S2.SS1.p1.10.m10.8.8.5.5.5.2.2">𝑘</ci><ci id="S2.SS1.p1.10.m10.8.8.5.5.5.2.3.cmml" xref="S2.SS1.p1.10.m10.8.8.5.5.5.2.3">′</ci></apply><ci id="S2.SS1.p1.10.m10.8.8.5.5.5.3.cmml" xref="S2.SS1.p1.10.m10.8.8.5.5.5.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.8c">\mathcal{K^{\prime}}=\{k_{0},...,k^{\prime}_{i},...,k^{\prime}_{m},k^{\prime}_%
{j+1},...,k^{\prime}_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.8d">caligraphic_K start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = { italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_k start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , … , italic_k start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , italic_k start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j + 1 end_POSTSUBSCRIPT , … , italic_k start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> and <math alttext="\mathcal{V^{\prime}}=\{v_{0},...,v^{\prime}_{i},...,v^{\prime}_{m},v^{\prime}_%
{j+1},...,v^{\prime}_{n}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m11.8"><semantics id="S2.SS1.p1.11.m11.8a"><mrow id="S2.SS1.p1.11.m11.8.8" xref="S2.SS1.p1.11.m11.8.8.cmml"><msup id="S2.SS1.p1.11.m11.8.8.7" xref="S2.SS1.p1.11.m11.8.8.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.11.m11.8.8.7.2" xref="S2.SS1.p1.11.m11.8.8.7.2.cmml">𝒱</mi><mo id="S2.SS1.p1.11.m11.8.8.7.3" xref="S2.SS1.p1.11.m11.8.8.7.3.cmml">′</mo></msup><mo id="S2.SS1.p1.11.m11.8.8.6" xref="S2.SS1.p1.11.m11.8.8.6.cmml">=</mo><mrow id="S2.SS1.p1.11.m11.8.8.5.5" xref="S2.SS1.p1.11.m11.8.8.5.6.cmml"><mo id="S2.SS1.p1.11.m11.8.8.5.5.6" stretchy="false" xref="S2.SS1.p1.11.m11.8.8.5.6.cmml">{</mo><msub id="S2.SS1.p1.11.m11.4.4.1.1.1" xref="S2.SS1.p1.11.m11.4.4.1.1.1.cmml"><mi id="S2.SS1.p1.11.m11.4.4.1.1.1.2" xref="S2.SS1.p1.11.m11.4.4.1.1.1.2.cmml">v</mi><mn id="S2.SS1.p1.11.m11.4.4.1.1.1.3" xref="S2.SS1.p1.11.m11.4.4.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS1.p1.11.m11.8.8.5.5.7" xref="S2.SS1.p1.11.m11.8.8.5.6.cmml">,</mo><mi id="S2.SS1.p1.11.m11.1.1" mathvariant="normal" xref="S2.SS1.p1.11.m11.1.1.cmml">…</mi><mo id="S2.SS1.p1.11.m11.8.8.5.5.8" xref="S2.SS1.p1.11.m11.8.8.5.6.cmml">,</mo><msubsup id="S2.SS1.p1.11.m11.5.5.2.2.2" xref="S2.SS1.p1.11.m11.5.5.2.2.2.cmml"><mi id="S2.SS1.p1.11.m11.5.5.2.2.2.2.2" xref="S2.SS1.p1.11.m11.5.5.2.2.2.2.2.cmml">v</mi><mi id="S2.SS1.p1.11.m11.5.5.2.2.2.3" xref="S2.SS1.p1.11.m11.5.5.2.2.2.3.cmml">i</mi><mo id="S2.SS1.p1.11.m11.5.5.2.2.2.2.3" xref="S2.SS1.p1.11.m11.5.5.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S2.SS1.p1.11.m11.8.8.5.5.9" xref="S2.SS1.p1.11.m11.8.8.5.6.cmml">,</mo><mi id="S2.SS1.p1.11.m11.2.2" mathvariant="normal" xref="S2.SS1.p1.11.m11.2.2.cmml">…</mi><mo id="S2.SS1.p1.11.m11.8.8.5.5.10" xref="S2.SS1.p1.11.m11.8.8.5.6.cmml">,</mo><msubsup id="S2.SS1.p1.11.m11.6.6.3.3.3" xref="S2.SS1.p1.11.m11.6.6.3.3.3.cmml"><mi id="S2.SS1.p1.11.m11.6.6.3.3.3.2.2" xref="S2.SS1.p1.11.m11.6.6.3.3.3.2.2.cmml">v</mi><mi id="S2.SS1.p1.11.m11.6.6.3.3.3.3" xref="S2.SS1.p1.11.m11.6.6.3.3.3.3.cmml">m</mi><mo id="S2.SS1.p1.11.m11.6.6.3.3.3.2.3" xref="S2.SS1.p1.11.m11.6.6.3.3.3.2.3.cmml">′</mo></msubsup><mo id="S2.SS1.p1.11.m11.8.8.5.5.11" xref="S2.SS1.p1.11.m11.8.8.5.6.cmml">,</mo><msubsup id="S2.SS1.p1.11.m11.7.7.4.4.4" xref="S2.SS1.p1.11.m11.7.7.4.4.4.cmml"><mi id="S2.SS1.p1.11.m11.7.7.4.4.4.2.2" xref="S2.SS1.p1.11.m11.7.7.4.4.4.2.2.cmml">v</mi><mrow id="S2.SS1.p1.11.m11.7.7.4.4.4.3" xref="S2.SS1.p1.11.m11.7.7.4.4.4.3.cmml"><mi id="S2.SS1.p1.11.m11.7.7.4.4.4.3.2" xref="S2.SS1.p1.11.m11.7.7.4.4.4.3.2.cmml">j</mi><mo id="S2.SS1.p1.11.m11.7.7.4.4.4.3.1" xref="S2.SS1.p1.11.m11.7.7.4.4.4.3.1.cmml">+</mo><mn id="S2.SS1.p1.11.m11.7.7.4.4.4.3.3" xref="S2.SS1.p1.11.m11.7.7.4.4.4.3.3.cmml">1</mn></mrow><mo id="S2.SS1.p1.11.m11.7.7.4.4.4.2.3" xref="S2.SS1.p1.11.m11.7.7.4.4.4.2.3.cmml">′</mo></msubsup><mo id="S2.SS1.p1.11.m11.8.8.5.5.12" xref="S2.SS1.p1.11.m11.8.8.5.6.cmml">,</mo><mi id="S2.SS1.p1.11.m11.3.3" mathvariant="normal" xref="S2.SS1.p1.11.m11.3.3.cmml">…</mi><mo id="S2.SS1.p1.11.m11.8.8.5.5.13" xref="S2.SS1.p1.11.m11.8.8.5.6.cmml">,</mo><msubsup id="S2.SS1.p1.11.m11.8.8.5.5.5" xref="S2.SS1.p1.11.m11.8.8.5.5.5.cmml"><mi id="S2.SS1.p1.11.m11.8.8.5.5.5.2.2" xref="S2.SS1.p1.11.m11.8.8.5.5.5.2.2.cmml">v</mi><mi id="S2.SS1.p1.11.m11.8.8.5.5.5.3" xref="S2.SS1.p1.11.m11.8.8.5.5.5.3.cmml">n</mi><mo id="S2.SS1.p1.11.m11.8.8.5.5.5.2.3" xref="S2.SS1.p1.11.m11.8.8.5.5.5.2.3.cmml">′</mo></msubsup><mo id="S2.SS1.p1.11.m11.8.8.5.5.14" stretchy="false" xref="S2.SS1.p1.11.m11.8.8.5.6.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.8b"><apply id="S2.SS1.p1.11.m11.8.8.cmml" xref="S2.SS1.p1.11.m11.8.8"><eq id="S2.SS1.p1.11.m11.8.8.6.cmml" xref="S2.SS1.p1.11.m11.8.8.6"></eq><apply id="S2.SS1.p1.11.m11.8.8.7.cmml" xref="S2.SS1.p1.11.m11.8.8.7"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.8.8.7.1.cmml" xref="S2.SS1.p1.11.m11.8.8.7">superscript</csymbol><ci id="S2.SS1.p1.11.m11.8.8.7.2.cmml" xref="S2.SS1.p1.11.m11.8.8.7.2">𝒱</ci><ci id="S2.SS1.p1.11.m11.8.8.7.3.cmml" xref="S2.SS1.p1.11.m11.8.8.7.3">′</ci></apply><set id="S2.SS1.p1.11.m11.8.8.5.6.cmml" xref="S2.SS1.p1.11.m11.8.8.5.5"><apply id="S2.SS1.p1.11.m11.4.4.1.1.1.cmml" xref="S2.SS1.p1.11.m11.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.4.4.1.1.1.1.cmml" xref="S2.SS1.p1.11.m11.4.4.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.11.m11.4.4.1.1.1.2.cmml" xref="S2.SS1.p1.11.m11.4.4.1.1.1.2">𝑣</ci><cn id="S2.SS1.p1.11.m11.4.4.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.11.m11.4.4.1.1.1.3">0</cn></apply><ci id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">…</ci><apply id="S2.SS1.p1.11.m11.5.5.2.2.2.cmml" xref="S2.SS1.p1.11.m11.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.5.5.2.2.2.1.cmml" xref="S2.SS1.p1.11.m11.5.5.2.2.2">subscript</csymbol><apply id="S2.SS1.p1.11.m11.5.5.2.2.2.2.cmml" xref="S2.SS1.p1.11.m11.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.5.5.2.2.2.2.1.cmml" xref="S2.SS1.p1.11.m11.5.5.2.2.2">superscript</csymbol><ci id="S2.SS1.p1.11.m11.5.5.2.2.2.2.2.cmml" xref="S2.SS1.p1.11.m11.5.5.2.2.2.2.2">𝑣</ci><ci id="S2.SS1.p1.11.m11.5.5.2.2.2.2.3.cmml" xref="S2.SS1.p1.11.m11.5.5.2.2.2.2.3">′</ci></apply><ci id="S2.SS1.p1.11.m11.5.5.2.2.2.3.cmml" xref="S2.SS1.p1.11.m11.5.5.2.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.11.m11.2.2.cmml" xref="S2.SS1.p1.11.m11.2.2">…</ci><apply id="S2.SS1.p1.11.m11.6.6.3.3.3.cmml" xref="S2.SS1.p1.11.m11.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.6.6.3.3.3.1.cmml" xref="S2.SS1.p1.11.m11.6.6.3.3.3">subscript</csymbol><apply id="S2.SS1.p1.11.m11.6.6.3.3.3.2.cmml" xref="S2.SS1.p1.11.m11.6.6.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.6.6.3.3.3.2.1.cmml" xref="S2.SS1.p1.11.m11.6.6.3.3.3">superscript</csymbol><ci id="S2.SS1.p1.11.m11.6.6.3.3.3.2.2.cmml" xref="S2.SS1.p1.11.m11.6.6.3.3.3.2.2">𝑣</ci><ci id="S2.SS1.p1.11.m11.6.6.3.3.3.2.3.cmml" xref="S2.SS1.p1.11.m11.6.6.3.3.3.2.3">′</ci></apply><ci id="S2.SS1.p1.11.m11.6.6.3.3.3.3.cmml" xref="S2.SS1.p1.11.m11.6.6.3.3.3.3">𝑚</ci></apply><apply id="S2.SS1.p1.11.m11.7.7.4.4.4.cmml" xref="S2.SS1.p1.11.m11.7.7.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.7.7.4.4.4.1.cmml" xref="S2.SS1.p1.11.m11.7.7.4.4.4">subscript</csymbol><apply id="S2.SS1.p1.11.m11.7.7.4.4.4.2.cmml" xref="S2.SS1.p1.11.m11.7.7.4.4.4"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.7.7.4.4.4.2.1.cmml" xref="S2.SS1.p1.11.m11.7.7.4.4.4">superscript</csymbol><ci id="S2.SS1.p1.11.m11.7.7.4.4.4.2.2.cmml" xref="S2.SS1.p1.11.m11.7.7.4.4.4.2.2">𝑣</ci><ci id="S2.SS1.p1.11.m11.7.7.4.4.4.2.3.cmml" xref="S2.SS1.p1.11.m11.7.7.4.4.4.2.3">′</ci></apply><apply id="S2.SS1.p1.11.m11.7.7.4.4.4.3.cmml" xref="S2.SS1.p1.11.m11.7.7.4.4.4.3"><plus id="S2.SS1.p1.11.m11.7.7.4.4.4.3.1.cmml" xref="S2.SS1.p1.11.m11.7.7.4.4.4.3.1"></plus><ci id="S2.SS1.p1.11.m11.7.7.4.4.4.3.2.cmml" xref="S2.SS1.p1.11.m11.7.7.4.4.4.3.2">𝑗</ci><cn id="S2.SS1.p1.11.m11.7.7.4.4.4.3.3.cmml" type="integer" xref="S2.SS1.p1.11.m11.7.7.4.4.4.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.11.m11.3.3.cmml" xref="S2.SS1.p1.11.m11.3.3">…</ci><apply id="S2.SS1.p1.11.m11.8.8.5.5.5.cmml" xref="S2.SS1.p1.11.m11.8.8.5.5.5"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.8.8.5.5.5.1.cmml" xref="S2.SS1.p1.11.m11.8.8.5.5.5">subscript</csymbol><apply id="S2.SS1.p1.11.m11.8.8.5.5.5.2.cmml" xref="S2.SS1.p1.11.m11.8.8.5.5.5"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.8.8.5.5.5.2.1.cmml" xref="S2.SS1.p1.11.m11.8.8.5.5.5">superscript</csymbol><ci id="S2.SS1.p1.11.m11.8.8.5.5.5.2.2.cmml" xref="S2.SS1.p1.11.m11.8.8.5.5.5.2.2">𝑣</ci><ci id="S2.SS1.p1.11.m11.8.8.5.5.5.2.3.cmml" xref="S2.SS1.p1.11.m11.8.8.5.5.5.2.3">′</ci></apply><ci id="S2.SS1.p1.11.m11.8.8.5.5.5.3.cmml" xref="S2.SS1.p1.11.m11.8.8.5.5.5.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.8c">\mathcal{V^{\prime}}=\{v_{0},...,v^{\prime}_{i},...,v^{\prime}_{m},v^{\prime}_%
{j+1},...,v^{\prime}_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.8d">caligraphic_V start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = { italic_v start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , … , italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j + 1 end_POSTSUBSCRIPT , … , italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>. It is evident that although only one block {<math alttext="s_{i},...,s_{j}\}" class="ltx_math_unparsed" display="inline" id="S2.SS1.p1.12.m12.1"><semantics id="S2.SS1.p1.12.m12.1a"><mrow id="S2.SS1.p1.12.m12.1b"><msub id="S2.SS1.p1.12.m12.1.2"><mi id="S2.SS1.p1.12.m12.1.2.2">s</mi><mi id="S2.SS1.p1.12.m12.1.2.3">i</mi></msub><mo id="S2.SS1.p1.12.m12.1.3">,</mo><mi id="S2.SS1.p1.12.m12.1.1" mathvariant="normal">…</mi><mo id="S2.SS1.p1.12.m12.1.4">,</mo><msub id="S2.SS1.p1.12.m12.1.5"><mi id="S2.SS1.p1.12.m12.1.5.2">s</mi><mi id="S2.SS1.p1.12.m12.1.5.3">j</mi></msub><mo id="S2.SS1.p1.12.m12.1.6" stretchy="false">}</mo></mrow><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">s_{i},...,s_{j}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.12.m12.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT }</annotation></semantics></math> has changed, due to the auto-regressive nature of LLMs, the KV states of all subsequent blocks must be re-encoded.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">In the scenario of RAG, a given passage frequently recurs in the retrieval results for numerous queries <cite class="ltx_cite ltx_citemacro_citep">(Qin et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib20" title="">2024</a>)</cite>, making it a natural consideration to explore the possibility of reusing its KV states. Unfortunately, the auto-regressive nature of the encoding approach, as previously outlined, imposes constraints that render the KV states nearly non-reusable across distinct queries. Our research is dedicated to examining a novel attention mechanism, Block-Attention, that designed to necessitate the re-computation of only the altered text blocks between two input sequences, thereby achieving an outcome equivalent to that of full sequence re-encoding.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.7">As illustrated in Figure 1, the essence of Block-Attention is to divide the input sequence <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.1"><semantics id="S2.SS1.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><ci id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.1d">caligraphic_S</annotation></semantics></math> into several independent blocks. Each block autonomously calculates its KV states through self-attention, without considering other blocks. The final block, however, has the unique capability to integrate information from preceding blocks. A primary advantage of this method is the modular independence it provides: when a block <math alttext="b_{i}" class="ltx_Math" display="inline" id="S2.SS1.p3.2.m2.1"><semantics id="S2.SS1.p3.2.m2.1a"><msub id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml"><mi id="S2.SS1.p3.2.m2.1.1.2" xref="S2.SS1.p3.2.m2.1.1.2.cmml">b</mi><mi id="S2.SS1.p3.2.m2.1.1.3" xref="S2.SS1.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><apply id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p3.2.m2.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.2">𝑏</ci><ci id="S2.SS1.p3.2.m2.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">b_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.1d">italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is updated to <math alttext="b^{\prime}_{i}" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.1"><semantics id="S2.SS1.p3.3.m3.1a"><msubsup id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml"><mi id="S2.SS1.p3.3.m3.1.1.2.2" xref="S2.SS1.p3.3.m3.1.1.2.2.cmml">b</mi><mi id="S2.SS1.p3.3.m3.1.1.3" xref="S2.SS1.p3.3.m3.1.1.3.cmml">i</mi><mo id="S2.SS1.p3.3.m3.1.1.2.3" xref="S2.SS1.p3.3.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.1b"><apply id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1">subscript</csymbol><apply id="S2.SS1.p3.3.m3.1.1.2.cmml" xref="S2.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.1.1.2.1.cmml" xref="S2.SS1.p3.3.m3.1.1">superscript</csymbol><ci id="S2.SS1.p3.3.m3.1.1.2.2.cmml" xref="S2.SS1.p3.3.m3.1.1.2.2">𝑏</ci><ci id="S2.SS1.p3.3.m3.1.1.2.3.cmml" xref="S2.SS1.p3.3.m3.1.1.2.3">′</ci></apply><ci id="S2.SS1.p3.3.m3.1.1.3.cmml" xref="S2.SS1.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.1c">b^{\prime}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.1d">italic_b start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, re-encoding only the KV states of the affected block <math alttext="k_{b^{\prime}_{i}}" class="ltx_Math" display="inline" id="S2.SS1.p3.4.m4.1"><semantics id="S2.SS1.p3.4.m4.1a"><msub id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml"><mi id="S2.SS1.p3.4.m4.1.1.2" xref="S2.SS1.p3.4.m4.1.1.2.cmml">k</mi><msubsup id="S2.SS1.p3.4.m4.1.1.3" xref="S2.SS1.p3.4.m4.1.1.3.cmml"><mi id="S2.SS1.p3.4.m4.1.1.3.2.2" xref="S2.SS1.p3.4.m4.1.1.3.2.2.cmml">b</mi><mi id="S2.SS1.p3.4.m4.1.1.3.3" xref="S2.SS1.p3.4.m4.1.1.3.3.cmml">i</mi><mo id="S2.SS1.p3.4.m4.1.1.3.2.3" xref="S2.SS1.p3.4.m4.1.1.3.2.3.cmml">′</mo></msubsup></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.1b"><apply id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m4.1.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p3.4.m4.1.1.2.cmml" xref="S2.SS1.p3.4.m4.1.1.2">𝑘</ci><apply id="S2.SS1.p3.4.m4.1.1.3.cmml" xref="S2.SS1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m4.1.1.3.1.cmml" xref="S2.SS1.p3.4.m4.1.1.3">subscript</csymbol><apply id="S2.SS1.p3.4.m4.1.1.3.2.cmml" xref="S2.SS1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m4.1.1.3.2.1.cmml" xref="S2.SS1.p3.4.m4.1.1.3">superscript</csymbol><ci id="S2.SS1.p3.4.m4.1.1.3.2.2.cmml" xref="S2.SS1.p3.4.m4.1.1.3.2.2">𝑏</ci><ci id="S2.SS1.p3.4.m4.1.1.3.2.3.cmml" xref="S2.SS1.p3.4.m4.1.1.3.2.3">′</ci></apply><ci id="S2.SS1.p3.4.m4.1.1.3.3.cmml" xref="S2.SS1.p3.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.1c">k_{b^{\prime}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.4.m4.1d">italic_k start_POSTSUBSCRIPT italic_b start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="v_{b^{\prime}_{i}}" class="ltx_Math" display="inline" id="S2.SS1.p3.5.m5.1"><semantics id="S2.SS1.p3.5.m5.1a"><msub id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml"><mi id="S2.SS1.p3.5.m5.1.1.2" xref="S2.SS1.p3.5.m5.1.1.2.cmml">v</mi><msubsup id="S2.SS1.p3.5.m5.1.1.3" xref="S2.SS1.p3.5.m5.1.1.3.cmml"><mi id="S2.SS1.p3.5.m5.1.1.3.2.2" xref="S2.SS1.p3.5.m5.1.1.3.2.2.cmml">b</mi><mi id="S2.SS1.p3.5.m5.1.1.3.3" xref="S2.SS1.p3.5.m5.1.1.3.3.cmml">i</mi><mo id="S2.SS1.p3.5.m5.1.1.3.2.3" xref="S2.SS1.p3.5.m5.1.1.3.2.3.cmml">′</mo></msubsup></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><apply id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m5.1.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p3.5.m5.1.1.2.cmml" xref="S2.SS1.p3.5.m5.1.1.2">𝑣</ci><apply id="S2.SS1.p3.5.m5.1.1.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m5.1.1.3.1.cmml" xref="S2.SS1.p3.5.m5.1.1.3">subscript</csymbol><apply id="S2.SS1.p3.5.m5.1.1.3.2.cmml" xref="S2.SS1.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m5.1.1.3.2.1.cmml" xref="S2.SS1.p3.5.m5.1.1.3">superscript</csymbol><ci id="S2.SS1.p3.5.m5.1.1.3.2.2.cmml" xref="S2.SS1.p3.5.m5.1.1.3.2.2">𝑏</ci><ci id="S2.SS1.p3.5.m5.1.1.3.2.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3.2.3">′</ci></apply><ci id="S2.SS1.p3.5.m5.1.1.3.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">v_{b^{\prime}_{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.5.m5.1d">italic_v start_POSTSUBSCRIPT italic_b start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, and those of the final block <math alttext="k_{b_{k}}" class="ltx_Math" display="inline" id="S2.SS1.p3.6.m6.1"><semantics id="S2.SS1.p3.6.m6.1a"><msub id="S2.SS1.p3.6.m6.1.1" xref="S2.SS1.p3.6.m6.1.1.cmml"><mi id="S2.SS1.p3.6.m6.1.1.2" xref="S2.SS1.p3.6.m6.1.1.2.cmml">k</mi><msub id="S2.SS1.p3.6.m6.1.1.3" xref="S2.SS1.p3.6.m6.1.1.3.cmml"><mi id="S2.SS1.p3.6.m6.1.1.3.2" xref="S2.SS1.p3.6.m6.1.1.3.2.cmml">b</mi><mi id="S2.SS1.p3.6.m6.1.1.3.3" xref="S2.SS1.p3.6.m6.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m6.1b"><apply id="S2.SS1.p3.6.m6.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.6.m6.1.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p3.6.m6.1.1.2.cmml" xref="S2.SS1.p3.6.m6.1.1.2">𝑘</ci><apply id="S2.SS1.p3.6.m6.1.1.3.cmml" xref="S2.SS1.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.6.m6.1.1.3.1.cmml" xref="S2.SS1.p3.6.m6.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.6.m6.1.1.3.2.cmml" xref="S2.SS1.p3.6.m6.1.1.3.2">𝑏</ci><ci id="S2.SS1.p3.6.m6.1.1.3.3.cmml" xref="S2.SS1.p3.6.m6.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.6.m6.1c">k_{b_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.6.m6.1d">italic_k start_POSTSUBSCRIPT italic_b start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="v_{b_{k}}" class="ltx_Math" display="inline" id="S2.SS1.p3.7.m7.1"><semantics id="S2.SS1.p3.7.m7.1a"><msub id="S2.SS1.p3.7.m7.1.1" xref="S2.SS1.p3.7.m7.1.1.cmml"><mi id="S2.SS1.p3.7.m7.1.1.2" xref="S2.SS1.p3.7.m7.1.1.2.cmml">v</mi><msub id="S2.SS1.p3.7.m7.1.1.3" xref="S2.SS1.p3.7.m7.1.1.3.cmml"><mi id="S2.SS1.p3.7.m7.1.1.3.2" xref="S2.SS1.p3.7.m7.1.1.3.2.cmml">b</mi><mi id="S2.SS1.p3.7.m7.1.1.3.3" xref="S2.SS1.p3.7.m7.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.7.m7.1b"><apply id="S2.SS1.p3.7.m7.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.7.m7.1.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p3.7.m7.1.1.2.cmml" xref="S2.SS1.p3.7.m7.1.1.2">𝑣</ci><apply id="S2.SS1.p3.7.m7.1.1.3.cmml" xref="S2.SS1.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.7.m7.1.1.3.1.cmml" xref="S2.SS1.p3.7.m7.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.7.m7.1.1.3.2.cmml" xref="S2.SS1.p3.7.m7.1.1.3.2">𝑏</ci><ci id="S2.SS1.p3.7.m7.1.1.3.3.cmml" xref="S2.SS1.p3.7.m7.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.7.m7.1c">v_{b_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.7.m7.1d">italic_v start_POSTSUBSCRIPT italic_b start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, is sufficient to obtain the updated sequence’s KV states.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.1">To develop a Block-Attention LLM capable of precise inference, we must tackle three key challenges:</p>
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1">How do we segment blocks?</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1">How should the positional encoding be calculated for each block?</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.1">How can the LLM be adapted to the Block-Attention mechanism?</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS1.p5">
<p class="ltx_p" id="S2.SS1.p5.1">These issues will be addressed in detail in Sections <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.SS2" title="2.2 Block Segmentation ‣ 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">2.2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.SS3" title="2.3 Position Re-Encoding ‣ 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">2.3</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.SS4" title="2.4 Block Fine-tune ‣ 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">2.4</span></a>, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Block Segmentation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The primary principle of block division is to segment semantically independent parts of the prompt into separate blocks. In RAG scenarios, since the retrieved passages are originally mutually independent, it is natural to divide them into different blocks. Therefore, let’s go back to the left part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">1</span></a>, where we allocate each passage to a single block and designate the user’s query as the final block. This principle extends to other scenarios as well. For example, in the context of code generation tasks, a function may be treated as one block; in multi-turn dialogues, each turn could be segmented into an individual block. In this paper, our primary focus is on the application of Block-Attention in RAG, with the exploration of other scenarios reserved for future research.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Position Re-Encoding</h3>
<div class="ltx_para ltx_noindent" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.2">The second problem is to re-encoding the positional information. Although the same passage may appear in multiple input prompts, its position generally varies. Therefore, when we attempt to reuse the KV states of a block, we need to re-encode its positional information. The process of re-encoding is simple and straightforward: taking the rotary positional encoding (RoPE) as an example, assume we wish to change the positional encoding of a block <math alttext="b=\{s_{i},...,s_{j}\}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.3"><semantics id="S2.SS3.p1.1.m1.3a"><mrow id="S2.SS3.p1.1.m1.3.3" xref="S2.SS3.p1.1.m1.3.3.cmml"><mi id="S2.SS3.p1.1.m1.3.3.4" xref="S2.SS3.p1.1.m1.3.3.4.cmml">b</mi><mo id="S2.SS3.p1.1.m1.3.3.3" xref="S2.SS3.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S2.SS3.p1.1.m1.3.3.2.2" xref="S2.SS3.p1.1.m1.3.3.2.3.cmml"><mo id="S2.SS3.p1.1.m1.3.3.2.2.3" stretchy="false" xref="S2.SS3.p1.1.m1.3.3.2.3.cmml">{</mo><msub id="S2.SS3.p1.1.m1.2.2.1.1.1" xref="S2.SS3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.2.2.1.1.1.2" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.cmml">s</mi><mi id="S2.SS3.p1.1.m1.2.2.1.1.1.3" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS3.p1.1.m1.3.3.2.2.4" xref="S2.SS3.p1.1.m1.3.3.2.3.cmml">,</mo><mi id="S2.SS3.p1.1.m1.1.1" mathvariant="normal" xref="S2.SS3.p1.1.m1.1.1.cmml">…</mi><mo id="S2.SS3.p1.1.m1.3.3.2.2.5" xref="S2.SS3.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S2.SS3.p1.1.m1.3.3.2.2.2" xref="S2.SS3.p1.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS3.p1.1.m1.3.3.2.2.2.2" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2.cmml">s</mi><mi id="S2.SS3.p1.1.m1.3.3.2.2.2.3" xref="S2.SS3.p1.1.m1.3.3.2.2.2.3.cmml">j</mi></msub><mo id="S2.SS3.p1.1.m1.3.3.2.2.6" stretchy="false" xref="S2.SS3.p1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.3b"><apply id="S2.SS3.p1.1.m1.3.3.cmml" xref="S2.SS3.p1.1.m1.3.3"><eq id="S2.SS3.p1.1.m1.3.3.3.cmml" xref="S2.SS3.p1.1.m1.3.3.3"></eq><ci id="S2.SS3.p1.1.m1.3.3.4.cmml" xref="S2.SS3.p1.1.m1.3.3.4">𝑏</ci><set id="S2.SS3.p1.1.m1.3.3.2.3.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2"><apply id="S2.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2">𝑠</ci><ci id="S2.SS3.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3">𝑖</ci></apply><ci id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">…</ci><apply id="S2.SS3.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.2">𝑠</ci><ci id="S2.SS3.p1.1.m1.3.3.2.2.2.3.cmml" xref="S2.SS3.p1.1.m1.3.3.2.2.2.3">𝑗</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.3c">b=\{s_{i},...,s_{j}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.3d">italic_b = { italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT }</annotation></semantics></math> to <math alttext="b^{\prime}=\{s_{i_{\Delta}},...,s_{j_{\Delta}}\}" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.3"><semantics id="S2.SS3.p1.2.m2.3a"><mrow id="S2.SS3.p1.2.m2.3.3" xref="S2.SS3.p1.2.m2.3.3.cmml"><msup id="S2.SS3.p1.2.m2.3.3.4" xref="S2.SS3.p1.2.m2.3.3.4.cmml"><mi id="S2.SS3.p1.2.m2.3.3.4.2" xref="S2.SS3.p1.2.m2.3.3.4.2.cmml">b</mi><mo id="S2.SS3.p1.2.m2.3.3.4.3" xref="S2.SS3.p1.2.m2.3.3.4.3.cmml">′</mo></msup><mo id="S2.SS3.p1.2.m2.3.3.3" xref="S2.SS3.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S2.SS3.p1.2.m2.3.3.2.2" xref="S2.SS3.p1.2.m2.3.3.2.3.cmml"><mo id="S2.SS3.p1.2.m2.3.3.2.2.3" stretchy="false" xref="S2.SS3.p1.2.m2.3.3.2.3.cmml">{</mo><msub id="S2.SS3.p1.2.m2.2.2.1.1.1" xref="S2.SS3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS3.p1.2.m2.2.2.1.1.1.2" xref="S2.SS3.p1.2.m2.2.2.1.1.1.2.cmml">s</mi><msub id="S2.SS3.p1.2.m2.2.2.1.1.1.3" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3.cmml"><mi id="S2.SS3.p1.2.m2.2.2.1.1.1.3.2" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3.2.cmml">i</mi><mi id="S2.SS3.p1.2.m2.2.2.1.1.1.3.3" mathvariant="normal" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3.3.cmml">Δ</mi></msub></msub><mo id="S2.SS3.p1.2.m2.3.3.2.2.4" xref="S2.SS3.p1.2.m2.3.3.2.3.cmml">,</mo><mi id="S2.SS3.p1.2.m2.1.1" mathvariant="normal" xref="S2.SS3.p1.2.m2.1.1.cmml">…</mi><mo id="S2.SS3.p1.2.m2.3.3.2.2.5" xref="S2.SS3.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S2.SS3.p1.2.m2.3.3.2.2.2" xref="S2.SS3.p1.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS3.p1.2.m2.3.3.2.2.2.2" xref="S2.SS3.p1.2.m2.3.3.2.2.2.2.cmml">s</mi><msub id="S2.SS3.p1.2.m2.3.3.2.2.2.3" xref="S2.SS3.p1.2.m2.3.3.2.2.2.3.cmml"><mi id="S2.SS3.p1.2.m2.3.3.2.2.2.3.2" xref="S2.SS3.p1.2.m2.3.3.2.2.2.3.2.cmml">j</mi><mi id="S2.SS3.p1.2.m2.3.3.2.2.2.3.3" mathvariant="normal" xref="S2.SS3.p1.2.m2.3.3.2.2.2.3.3.cmml">Δ</mi></msub></msub><mo id="S2.SS3.p1.2.m2.3.3.2.2.6" stretchy="false" xref="S2.SS3.p1.2.m2.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.3b"><apply id="S2.SS3.p1.2.m2.3.3.cmml" xref="S2.SS3.p1.2.m2.3.3"><eq id="S2.SS3.p1.2.m2.3.3.3.cmml" xref="S2.SS3.p1.2.m2.3.3.3"></eq><apply id="S2.SS3.p1.2.m2.3.3.4.cmml" xref="S2.SS3.p1.2.m2.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.3.3.4.1.cmml" xref="S2.SS3.p1.2.m2.3.3.4">superscript</csymbol><ci id="S2.SS3.p1.2.m2.3.3.4.2.cmml" xref="S2.SS3.p1.2.m2.3.3.4.2">𝑏</ci><ci id="S2.SS3.p1.2.m2.3.3.4.3.cmml" xref="S2.SS3.p1.2.m2.3.3.4.3">′</ci></apply><set id="S2.SS3.p1.2.m2.3.3.2.3.cmml" xref="S2.SS3.p1.2.m2.3.3.2.2"><apply id="S2.SS3.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.2">𝑠</ci><apply id="S2.SS3.p1.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.2.2.1.1.1.3.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.SS3.p1.2.m2.2.2.1.1.1.3.2.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3.2">𝑖</ci><ci id="S2.SS3.p1.2.m2.2.2.1.1.1.3.3.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3.3">Δ</ci></apply></apply><ci id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">…</ci><apply id="S2.SS3.p1.2.m2.3.3.2.2.2.cmml" xref="S2.SS3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS3.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.p1.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS3.p1.2.m2.3.3.2.2.2.2">𝑠</ci><apply id="S2.SS3.p1.2.m2.3.3.2.2.2.3.cmml" xref="S2.SS3.p1.2.m2.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.3.3.2.2.2.3.1.cmml" xref="S2.SS3.p1.2.m2.3.3.2.2.2.3">subscript</csymbol><ci id="S2.SS3.p1.2.m2.3.3.2.2.2.3.2.cmml" xref="S2.SS3.p1.2.m2.3.3.2.2.2.3.2">𝑗</ci><ci id="S2.SS3.p1.2.m2.3.3.2.2.2.3.3.cmml" xref="S2.SS3.p1.2.m2.3.3.2.2.2.3.3">Δ</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.3c">b^{\prime}=\{s_{i_{\Delta}},...,s_{j_{\Delta}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.3d">italic_b start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = { italic_s start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math>, then we only need three steps:</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.2">1) For the token <math alttext="s_{i}" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><msub id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">s</mi><mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">𝑠</ci><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, its positional encoding vector <math alttext="f(s_{i},i)" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.2"><semantics id="S2.SS3.p2.2.m2.2a"><mrow id="S2.SS3.p2.2.m2.2.2" xref="S2.SS3.p2.2.m2.2.2.cmml"><mi id="S2.SS3.p2.2.m2.2.2.3" xref="S2.SS3.p2.2.m2.2.2.3.cmml">f</mi><mo id="S2.SS3.p2.2.m2.2.2.2" xref="S2.SS3.p2.2.m2.2.2.2.cmml">⁢</mo><mrow id="S2.SS3.p2.2.m2.2.2.1.1" xref="S2.SS3.p2.2.m2.2.2.1.2.cmml"><mo id="S2.SS3.p2.2.m2.2.2.1.1.2" stretchy="false" xref="S2.SS3.p2.2.m2.2.2.1.2.cmml">(</mo><msub id="S2.SS3.p2.2.m2.2.2.1.1.1" xref="S2.SS3.p2.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS3.p2.2.m2.2.2.1.1.1.2" xref="S2.SS3.p2.2.m2.2.2.1.1.1.2.cmml">s</mi><mi id="S2.SS3.p2.2.m2.2.2.1.1.1.3" xref="S2.SS3.p2.2.m2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS3.p2.2.m2.2.2.1.1.3" xref="S2.SS3.p2.2.m2.2.2.1.2.cmml">,</mo><mi id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">i</mi><mo id="S2.SS3.p2.2.m2.2.2.1.1.4" stretchy="false" xref="S2.SS3.p2.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.2b"><apply id="S2.SS3.p2.2.m2.2.2.cmml" xref="S2.SS3.p2.2.m2.2.2"><times id="S2.SS3.p2.2.m2.2.2.2.cmml" xref="S2.SS3.p2.2.m2.2.2.2"></times><ci id="S2.SS3.p2.2.m2.2.2.3.cmml" xref="S2.SS3.p2.2.m2.2.2.3">𝑓</ci><interval closure="open" id="S2.SS3.p2.2.m2.2.2.1.2.cmml" xref="S2.SS3.p2.2.m2.2.2.1.1"><apply id="S2.SS3.p2.2.m2.2.2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS3.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS3.p2.2.m2.2.2.1.1.1.2">𝑠</ci><ci id="S2.SS3.p2.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS3.p2.2.m2.2.2.1.1.1.3">𝑖</ci></apply><ci id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">𝑖</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.2c">f(s_{i},i)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.2d">italic_f ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_i )</annotation></semantics></math> is calculated using the following formula:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f(x_{i},i)=\left(\begin{matrix}\cos{i\theta_{0}}&amp;&amp;-\sin{i\theta}&amp;&amp;\cdots&amp;&amp;0&amp;&amp;0%
\\
\sin{i\theta_{0}}&amp;&amp;\cos{i\theta}&amp;&amp;\cdots&amp;&amp;0&amp;&amp;0\\
0&amp;&amp;0&amp;&amp;\cdots&amp;&amp;\cos{i\theta_{\frac{d}{2}-1}}&amp;&amp;-\sin{i\theta_{\frac{d}{2}-1}}\\
0&amp;&amp;0&amp;&amp;\cdots&amp;&amp;\sin{i\theta_{\frac{d}{2}-1}}&amp;&amp;\cos{i\theta_{\frac{d}{2}-1}}\end%
{matrix}\right)\left(\begin{matrix}p_{0}\\
p_{1}\\
\cdots\\
p_{d-1}\end{matrix}\right)" class="ltx_Math" display="block" id="S2.E1.m1.4"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml"><mrow id="S2.E1.m1.4.4.1" xref="S2.E1.m1.4.4.1.cmml"><mi id="S2.E1.m1.4.4.1.3" xref="S2.E1.m1.4.4.1.3.cmml">f</mi><mo id="S2.E1.m1.4.4.1.2" xref="S2.E1.m1.4.4.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.1.1.1" xref="S2.E1.m1.4.4.1.1.2.cmml"><mo id="S2.E1.m1.4.4.1.1.1.2" stretchy="false" xref="S2.E1.m1.4.4.1.1.2.cmml">(</mo><msub id="S2.E1.m1.4.4.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml">x</mi><mi id="S2.E1.m1.4.4.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E1.m1.4.4.1.1.1.3" xref="S2.E1.m1.4.4.1.1.2.cmml">,</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">i</mi><mo id="S2.E1.m1.4.4.1.1.1.4" stretchy="false" xref="S2.E1.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.4.4.2" xref="S2.E1.m1.4.4.2.cmml">=</mo><mrow id="S2.E1.m1.4.4.3" xref="S2.E1.m1.4.4.3.cmml"><mrow id="S2.E1.m1.4.4.3.2.2" xref="S2.E1.m1.4.4.3.cmml"><mo id="S2.E1.m1.4.4.3.2.2.1" xref="S2.E1.m1.4.4.3.cmml">(</mo><mtable columnspacing="5pt" displaystyle="true" id="S2.E1.m1.1.1.1.1" rowspacing="0pt" xref="S2.E1.m1.1.1.2.cmml"><mtr id="S2.E1.m1.1.1.1.1a" xref="S2.E1.m1.1.1.2.cmml"><mtd id="S2.E1.m1.1.1.1.1b" xref="S2.E1.m1.1.1.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">cos</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1.2.1" xref="S2.E1.m1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.2.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.2.3.2.cmml">θ</mi><mn id="S2.E1.m1.1.1.1.1.1.1.1.2.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.2.3.3.cmml">0</mn></msub></mrow></mrow></mtd><mtd id="S2.E1.m1.1.1.1.1c" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1d" xref="S2.E1.m1.1.1.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.1.3.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.3.1a" rspace="0.167em" xref="S2.E1.m1.1.1.1.1.1.3.1.cmml">−</mo><mrow id="S2.E1.m1.1.1.1.1.1.3.1.2" xref="S2.E1.m1.1.1.1.1.1.3.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.3.1.2.1" xref="S2.E1.m1.1.1.1.1.1.3.1.2.1.cmml">sin</mi><mo id="S2.E1.m1.1.1.1.1.1.3.1.2a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.1.3.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.1.1.1.1.1.3.1.2.2" xref="S2.E1.m1.1.1.1.1.1.3.1.2.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.3.1.2.2.2" xref="S2.E1.m1.1.1.1.1.1.3.1.2.2.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.1.3.1.2.2.1" xref="S2.E1.m1.1.1.1.1.1.3.1.2.2.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.1.1.1.3.1.2.2.3" xref="S2.E1.m1.1.1.1.1.1.3.1.2.2.3.cmml">θ</mi></mrow></mrow></mrow></mtd><mtd id="S2.E1.m1.1.1.1.1e" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1f" xref="S2.E1.m1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.5.1" mathvariant="normal" xref="S2.E1.m1.1.1.1.1.1.5.1.cmml">⋯</mi></mtd><mtd id="S2.E1.m1.1.1.1.1g" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1h" xref="S2.E1.m1.1.1.2.cmml"><mn id="S2.E1.m1.1.1.1.1.1.7.1" xref="S2.E1.m1.1.1.1.1.1.7.1.cmml">0</mn></mtd><mtd id="S2.E1.m1.1.1.1.1i" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1j" xref="S2.E1.m1.1.1.2.cmml"><mn id="S2.E1.m1.1.1.1.1.1.9.1" xref="S2.E1.m1.1.1.1.1.1.9.1.cmml">0</mn></mtd></mtr><mtr id="S2.E1.m1.1.1.1.1k" xref="S2.E1.m1.1.1.2.cmml"><mtd id="S2.E1.m1.1.1.1.1l" xref="S2.E1.m1.1.1.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.2.1.1" xref="S2.E1.m1.1.1.1.1.2.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.2.1.1.1" xref="S2.E1.m1.1.1.1.1.2.1.1.1.cmml">sin</mi><mo id="S2.E1.m1.1.1.1.1.2.1.1a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.2.1.1.cmml">⁡</mo><mrow id="S2.E1.m1.1.1.1.1.2.1.1.2" xref="S2.E1.m1.1.1.1.1.2.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.2.1.1.2.2" xref="S2.E1.m1.1.1.1.1.2.1.1.2.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.2.1.1.2.1" xref="S2.E1.m1.1.1.1.1.2.1.1.2.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.2.1.1.2.3" xref="S2.E1.m1.1.1.1.1.2.1.1.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.2.1.1.2.3.2" xref="S2.E1.m1.1.1.1.1.2.1.1.2.3.2.cmml">θ</mi><mn id="S2.E1.m1.1.1.1.1.2.1.1.2.3.3" xref="S2.E1.m1.1.1.1.1.2.1.1.2.3.3.cmml">0</mn></msub></mrow></mrow></mtd><mtd id="S2.E1.m1.1.1.1.1m" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1n" xref="S2.E1.m1.1.1.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.2.3.1" xref="S2.E1.m1.1.1.1.1.2.3.1.cmml"><mi id="S2.E1.m1.1.1.1.1.2.3.1.1" xref="S2.E1.m1.1.1.1.1.2.3.1.1.cmml">cos</mi><mo id="S2.E1.m1.1.1.1.1.2.3.1a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.2.3.1.cmml">⁡</mo><mrow id="S2.E1.m1.1.1.1.1.2.3.1.2" xref="S2.E1.m1.1.1.1.1.2.3.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.2.3.1.2.2" xref="S2.E1.m1.1.1.1.1.2.3.1.2.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.2.3.1.2.1" xref="S2.E1.m1.1.1.1.1.2.3.1.2.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.1.1.2.3.1.2.3" xref="S2.E1.m1.1.1.1.1.2.3.1.2.3.cmml">θ</mi></mrow></mrow></mtd><mtd id="S2.E1.m1.1.1.1.1o" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1p" xref="S2.E1.m1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.2.5.1" mathvariant="normal" xref="S2.E1.m1.1.1.1.1.2.5.1.cmml">⋯</mi></mtd><mtd id="S2.E1.m1.1.1.1.1q" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1r" xref="S2.E1.m1.1.1.2.cmml"><mn id="S2.E1.m1.1.1.1.1.2.7.1" xref="S2.E1.m1.1.1.1.1.2.7.1.cmml">0</mn></mtd><mtd id="S2.E1.m1.1.1.1.1s" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1t" xref="S2.E1.m1.1.1.2.cmml"><mn id="S2.E1.m1.1.1.1.1.2.9.1" xref="S2.E1.m1.1.1.1.1.2.9.1.cmml">0</mn></mtd></mtr><mtr id="S2.E1.m1.1.1.1.1u" xref="S2.E1.m1.1.1.2.cmml"><mtd id="S2.E1.m1.1.1.1.1v" xref="S2.E1.m1.1.1.2.cmml"><mn id="S2.E1.m1.1.1.1.1.3.1.1" xref="S2.E1.m1.1.1.1.1.3.1.1.cmml">0</mn></mtd><mtd id="S2.E1.m1.1.1.1.1w" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1x" xref="S2.E1.m1.1.1.2.cmml"><mn id="S2.E1.m1.1.1.1.1.3.3.1" xref="S2.E1.m1.1.1.1.1.3.3.1.cmml">0</mn></mtd><mtd id="S2.E1.m1.1.1.1.1y" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1z" xref="S2.E1.m1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.3.5.1" mathvariant="normal" xref="S2.E1.m1.1.1.1.1.3.5.1.cmml">⋯</mi></mtd><mtd id="S2.E1.m1.1.1.1.1aa" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1ab" xref="S2.E1.m1.1.1.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.3.7.1" xref="S2.E1.m1.1.1.1.1.3.7.1.cmml"><mi id="S2.E1.m1.1.1.1.1.3.7.1.1" xref="S2.E1.m1.1.1.1.1.3.7.1.1.cmml">cos</mi><mo id="S2.E1.m1.1.1.1.1.3.7.1a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.3.7.1.cmml">⁡</mo><mrow id="S2.E1.m1.1.1.1.1.3.7.1.2" xref="S2.E1.m1.1.1.1.1.3.7.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.3.7.1.2.2" xref="S2.E1.m1.1.1.1.1.3.7.1.2.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.3.7.1.2.1" xref="S2.E1.m1.1.1.1.1.3.7.1.2.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.3.7.1.2.3" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.7.1.2.3.2" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.2.cmml">θ</mi><mrow id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.cmml"><mfrac id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2.cmml"><mi id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2.2" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2.2.cmml">d</mi><mn id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2.3" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2.3.cmml">2</mn></mfrac><mo id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.1" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.1.cmml">−</mo><mn id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.3" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mtd><mtd id="S2.E1.m1.1.1.1.1ac" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1ad" xref="S2.E1.m1.1.1.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.3.9.1" xref="S2.E1.m1.1.1.1.1.3.9.1.cmml"><mo id="S2.E1.m1.1.1.1.1.3.9.1a" rspace="0.167em" xref="S2.E1.m1.1.1.1.1.3.9.1.cmml">−</mo><mrow id="S2.E1.m1.1.1.1.1.3.9.1.2" xref="S2.E1.m1.1.1.1.1.3.9.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.3.9.1.2.1" xref="S2.E1.m1.1.1.1.1.3.9.1.2.1.cmml">sin</mi><mo id="S2.E1.m1.1.1.1.1.3.9.1.2a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.3.9.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.1.1.1.1.3.9.1.2.2" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.cmml"><mi id="S2.E1.m1.1.1.1.1.3.9.1.2.2.2" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.3.9.1.2.2.1" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.2" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.2.cmml">θ</mi><mrow id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.cmml"><mfrac id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2.cmml"><mi id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2.2" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2.2.cmml">d</mi><mn id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2.3" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2.3.cmml">2</mn></mfrac><mo id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.1" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.1.cmml">−</mo><mn id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.3" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S2.E1.m1.1.1.1.1ae" xref="S2.E1.m1.1.1.2.cmml"><mtd id="S2.E1.m1.1.1.1.1af" xref="S2.E1.m1.1.1.2.cmml"><mn id="S2.E1.m1.1.1.1.1.4.1.1" xref="S2.E1.m1.1.1.1.1.4.1.1.cmml">0</mn></mtd><mtd id="S2.E1.m1.1.1.1.1ag" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1ah" xref="S2.E1.m1.1.1.2.cmml"><mn id="S2.E1.m1.1.1.1.1.4.3.1" xref="S2.E1.m1.1.1.1.1.4.3.1.cmml">0</mn></mtd><mtd id="S2.E1.m1.1.1.1.1ai" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1aj" xref="S2.E1.m1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.4.5.1" mathvariant="normal" xref="S2.E1.m1.1.1.1.1.4.5.1.cmml">⋯</mi></mtd><mtd id="S2.E1.m1.1.1.1.1ak" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1al" xref="S2.E1.m1.1.1.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.4.7.1" xref="S2.E1.m1.1.1.1.1.4.7.1.cmml"><mi id="S2.E1.m1.1.1.1.1.4.7.1.1" xref="S2.E1.m1.1.1.1.1.4.7.1.1.cmml">sin</mi><mo id="S2.E1.m1.1.1.1.1.4.7.1a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.4.7.1.cmml">⁡</mo><mrow id="S2.E1.m1.1.1.1.1.4.7.1.2" xref="S2.E1.m1.1.1.1.1.4.7.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.4.7.1.2.2" xref="S2.E1.m1.1.1.1.1.4.7.1.2.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.4.7.1.2.1" xref="S2.E1.m1.1.1.1.1.4.7.1.2.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.4.7.1.2.3" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.4.7.1.2.3.2" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.2.cmml">θ</mi><mrow id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.cmml"><mfrac id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2.cmml"><mi id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2.2" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2.2.cmml">d</mi><mn id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2.3" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2.3.cmml">2</mn></mfrac><mo id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.1" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.1.cmml">−</mo><mn id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.3" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mtd><mtd id="S2.E1.m1.1.1.1.1am" xref="S2.E1.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E1.m1.1.1.1.1an" xref="S2.E1.m1.1.1.2.cmml"><mrow id="S2.E1.m1.1.1.1.1.4.9.1" xref="S2.E1.m1.1.1.1.1.4.9.1.cmml"><mi id="S2.E1.m1.1.1.1.1.4.9.1.1" xref="S2.E1.m1.1.1.1.1.4.9.1.1.cmml">cos</mi><mo id="S2.E1.m1.1.1.1.1.4.9.1a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.4.9.1.cmml">⁡</mo><mrow id="S2.E1.m1.1.1.1.1.4.9.1.2" xref="S2.E1.m1.1.1.1.1.4.9.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.4.9.1.2.2" xref="S2.E1.m1.1.1.1.1.4.9.1.2.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.4.9.1.2.1" xref="S2.E1.m1.1.1.1.1.4.9.1.2.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.4.9.1.2.3" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.4.9.1.2.3.2" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.2.cmml">θ</mi><mrow id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.cmml"><mfrac id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2.cmml"><mi id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2.2" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2.2.cmml">d</mi><mn id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2.3" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2.3.cmml">2</mn></mfrac><mo id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.1" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.1.cmml">−</mo><mn id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.3" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mtd></mtr></mtable><mo id="S2.E1.m1.4.4.3.2.2.2" xref="S2.E1.m1.4.4.3.cmml">)</mo></mrow><mo id="S2.E1.m1.4.4.3.1" xref="S2.E1.m1.4.4.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.3.3.2" xref="S2.E1.m1.4.4.3.cmml"><mo id="S2.E1.m1.4.4.3.3.2.1" xref="S2.E1.m1.4.4.3.cmml">(</mo><mtable displaystyle="true" id="S2.E1.m1.2.2.1.1" rowspacing="0pt" xref="S2.E1.m1.2.2.2.cmml"><mtr id="S2.E1.m1.2.2.1.1a" xref="S2.E1.m1.2.2.2.cmml"><mtd id="S2.E1.m1.2.2.1.1b" xref="S2.E1.m1.2.2.2.cmml"><msub id="S2.E1.m1.2.2.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.2.cmml">p</mi><mn id="S2.E1.m1.2.2.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.3.cmml">0</mn></msub></mtd></mtr><mtr id="S2.E1.m1.2.2.1.1c" xref="S2.E1.m1.2.2.2.cmml"><mtd id="S2.E1.m1.2.2.1.1d" xref="S2.E1.m1.2.2.2.cmml"><msub id="S2.E1.m1.2.2.1.1.2.1.1" xref="S2.E1.m1.2.2.1.1.2.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.2.1.1.2" xref="S2.E1.m1.2.2.1.1.2.1.1.2.cmml">p</mi><mn id="S2.E1.m1.2.2.1.1.2.1.1.3" xref="S2.E1.m1.2.2.1.1.2.1.1.3.cmml">1</mn></msub></mtd></mtr><mtr id="S2.E1.m1.2.2.1.1e" xref="S2.E1.m1.2.2.2.cmml"><mtd id="S2.E1.m1.2.2.1.1f" xref="S2.E1.m1.2.2.2.cmml"><mi id="S2.E1.m1.2.2.1.1.3.1.1" mathvariant="normal" xref="S2.E1.m1.2.2.1.1.3.1.1.cmml">⋯</mi></mtd></mtr><mtr id="S2.E1.m1.2.2.1.1g" xref="S2.E1.m1.2.2.2.cmml"><mtd id="S2.E1.m1.2.2.1.1h" xref="S2.E1.m1.2.2.2.cmml"><msub id="S2.E1.m1.2.2.1.1.4.1.1" xref="S2.E1.m1.2.2.1.1.4.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.4.1.1.2" xref="S2.E1.m1.2.2.1.1.4.1.1.2.cmml">p</mi><mrow id="S2.E1.m1.2.2.1.1.4.1.1.3" xref="S2.E1.m1.2.2.1.1.4.1.1.3.cmml"><mi id="S2.E1.m1.2.2.1.1.4.1.1.3.2" xref="S2.E1.m1.2.2.1.1.4.1.1.3.2.cmml">d</mi><mo id="S2.E1.m1.2.2.1.1.4.1.1.3.1" xref="S2.E1.m1.2.2.1.1.4.1.1.3.1.cmml">−</mo><mn id="S2.E1.m1.2.2.1.1.4.1.1.3.3" xref="S2.E1.m1.2.2.1.1.4.1.1.3.3.cmml">1</mn></mrow></msub></mtd></mtr></mtable><mo id="S2.E1.m1.4.4.3.3.2.2" xref="S2.E1.m1.4.4.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4"><eq id="S2.E1.m1.4.4.2.cmml" xref="S2.E1.m1.4.4.2"></eq><apply id="S2.E1.m1.4.4.1.cmml" xref="S2.E1.m1.4.4.1"><times id="S2.E1.m1.4.4.1.2.cmml" xref="S2.E1.m1.4.4.1.2"></times><ci id="S2.E1.m1.4.4.1.3.cmml" xref="S2.E1.m1.4.4.1.3">𝑓</ci><interval closure="open" id="S2.E1.m1.4.4.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1"><apply id="S2.E1.m1.4.4.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2">𝑥</ci><ci id="S2.E1.m1.4.4.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.3">𝑖</ci></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑖</ci></interval></apply><apply id="S2.E1.m1.4.4.3.cmml" xref="S2.E1.m1.4.4.3"><times id="S2.E1.m1.4.4.3.1.cmml" xref="S2.E1.m1.4.4.3.1"></times><apply id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1">matrix</csymbol><matrix id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1"><matrixrow id="S2.E1.m1.1.1.1.1a.cmml" xref="S2.E1.m1.1.1.1.1"><apply id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"><cos id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1"></cos><apply id="S2.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2"><times id="S2.E1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2.1"></times><ci id="S2.E1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2">𝑖</ci><apply id="S2.E1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2.3.2">𝜃</ci><cn id="S2.E1.m1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.1.1.1.2.3.3">0</cn></apply></apply></apply><cerror id="S2.E1.m1.1.1.1.1b.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1c.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E1.m1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.3.1"><minus id="S2.E1.m1.1.1.1.1.1.3.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.3.1"></minus><apply id="S2.E1.m1.1.1.1.1.1.3.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.3.1.2"><sin id="S2.E1.m1.1.1.1.1.1.3.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.3.1.2.1"></sin><apply id="S2.E1.m1.1.1.1.1.1.3.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.3.1.2.2"><times id="S2.E1.m1.1.1.1.1.1.3.1.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.3.1.2.2.1"></times><ci id="S2.E1.m1.1.1.1.1.1.3.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.3.1.2.2.2">𝑖</ci><ci id="S2.E1.m1.1.1.1.1.1.3.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3.1.2.2.3">𝜃</ci></apply></apply></apply><cerror id="S2.E1.m1.1.1.1.1d.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1e.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><ci id="S2.E1.m1.1.1.1.1.1.5.1.cmml" xref="S2.E1.m1.1.1.1.1.1.5.1">⋯</ci><cerror id="S2.E1.m1.1.1.1.1f.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1g.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><cn id="S2.E1.m1.1.1.1.1.1.7.1.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.1.7.1">0</cn><cerror id="S2.E1.m1.1.1.1.1h.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1i.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><cn id="S2.E1.m1.1.1.1.1.1.9.1.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.1.9.1">0</cn></matrixrow><matrixrow id="S2.E1.m1.1.1.1.1j.cmml" xref="S2.E1.m1.1.1.1.1"><apply id="S2.E1.m1.1.1.1.1.2.1.1.cmml" xref="S2.E1.m1.1.1.1.1.2.1.1"><sin id="S2.E1.m1.1.1.1.1.2.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.2.1.1.1"></sin><apply id="S2.E1.m1.1.1.1.1.2.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2.1.1.2"><times id="S2.E1.m1.1.1.1.1.2.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2.1.1.2.1"></times><ci id="S2.E1.m1.1.1.1.1.2.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.1.1.2.2">𝑖</ci><apply id="S2.E1.m1.1.1.1.1.2.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.1.1.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.2.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.2.1.1.2.3.2">𝜃</ci><cn id="S2.E1.m1.1.1.1.1.2.1.1.2.3.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.2.1.1.2.3.3">0</cn></apply></apply></apply><cerror id="S2.E1.m1.1.1.1.1k.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1l.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E1.m1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.3.1"><cos id="S2.E1.m1.1.1.1.1.2.3.1.1.cmml" xref="S2.E1.m1.1.1.1.1.2.3.1.1"></cos><apply id="S2.E1.m1.1.1.1.1.2.3.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2.3.1.2"><times id="S2.E1.m1.1.1.1.1.2.3.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2.3.1.2.1"></times><ci id="S2.E1.m1.1.1.1.1.2.3.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.3.1.2.2">𝑖</ci><ci id="S2.E1.m1.1.1.1.1.2.3.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.3.1.2.3">𝜃</ci></apply></apply><cerror id="S2.E1.m1.1.1.1.1m.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1n.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><ci id="S2.E1.m1.1.1.1.1.2.5.1.cmml" xref="S2.E1.m1.1.1.1.1.2.5.1">⋯</ci><cerror id="S2.E1.m1.1.1.1.1o.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1p.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><cn id="S2.E1.m1.1.1.1.1.2.7.1.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.2.7.1">0</cn><cerror id="S2.E1.m1.1.1.1.1q.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1r.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><cn id="S2.E1.m1.1.1.1.1.2.9.1.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.2.9.1">0</cn></matrixrow><matrixrow id="S2.E1.m1.1.1.1.1s.cmml" xref="S2.E1.m1.1.1.1.1"><cn id="S2.E1.m1.1.1.1.1.3.1.1.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.3.1.1">0</cn><cerror id="S2.E1.m1.1.1.1.1t.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1u.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><cn id="S2.E1.m1.1.1.1.1.3.3.1.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.3.3.1">0</cn><cerror id="S2.E1.m1.1.1.1.1v.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1w.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><ci id="S2.E1.m1.1.1.1.1.3.5.1.cmml" xref="S2.E1.m1.1.1.1.1.3.5.1">⋯</ci><cerror id="S2.E1.m1.1.1.1.1x.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1y.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E1.m1.1.1.1.1.3.7.1.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1"><cos id="S2.E1.m1.1.1.1.1.3.7.1.1.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.1"></cos><apply id="S2.E1.m1.1.1.1.1.3.7.1.2.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.2"><times id="S2.E1.m1.1.1.1.1.3.7.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.2.1"></times><ci id="S2.E1.m1.1.1.1.1.3.7.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.2.2">𝑖</ci><apply id="S2.E1.m1.1.1.1.1.3.7.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.7.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.7.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.2">𝜃</ci><apply id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3"><minus id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.1"></minus><apply id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2"><divide id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2"></divide><ci id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2.2">𝑑</ci><cn id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.2.3">2</cn></apply><cn id="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.3.7.1.2.3.3.3">1</cn></apply></apply></apply></apply><cerror id="S2.E1.m1.1.1.1.1z.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1aa.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E1.m1.1.1.1.1.3.9.1.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1"><minus id="S2.E1.m1.1.1.1.1.3.9.1.1.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1"></minus><apply id="S2.E1.m1.1.1.1.1.3.9.1.2.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2"><sin id="S2.E1.m1.1.1.1.1.3.9.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.1"></sin><apply id="S2.E1.m1.1.1.1.1.3.9.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2"><times id="S2.E1.m1.1.1.1.1.3.9.1.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.1"></times><ci id="S2.E1.m1.1.1.1.1.3.9.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.2">𝑖</ci><apply id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.2">𝜃</ci><apply id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3"><minus id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.1"></minus><apply id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2"><divide id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2"></divide><ci id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2.2">𝑑</ci><cn id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.2.3">2</cn></apply><cn id="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.3.9.1.2.2.3.3.3">1</cn></apply></apply></apply></apply></apply></matrixrow><matrixrow id="S2.E1.m1.1.1.1.1ab.cmml" xref="S2.E1.m1.1.1.1.1"><cn id="S2.E1.m1.1.1.1.1.4.1.1.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.4.1.1">0</cn><cerror id="S2.E1.m1.1.1.1.1ac.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1ad.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><cn id="S2.E1.m1.1.1.1.1.4.3.1.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.4.3.1">0</cn><cerror id="S2.E1.m1.1.1.1.1ae.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1af.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><ci id="S2.E1.m1.1.1.1.1.4.5.1.cmml" xref="S2.E1.m1.1.1.1.1.4.5.1">⋯</ci><cerror id="S2.E1.m1.1.1.1.1ag.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1ah.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E1.m1.1.1.1.1.4.7.1.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1"><sin id="S2.E1.m1.1.1.1.1.4.7.1.1.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.1"></sin><apply id="S2.E1.m1.1.1.1.1.4.7.1.2.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.2"><times id="S2.E1.m1.1.1.1.1.4.7.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.2.1"></times><ci id="S2.E1.m1.1.1.1.1.4.7.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.2.2">𝑖</ci><apply id="S2.E1.m1.1.1.1.1.4.7.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.4.7.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.4.7.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.2">𝜃</ci><apply id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3"><minus id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.1"></minus><apply id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2"><divide id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2"></divide><ci id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2.2">𝑑</ci><cn id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.2.3">2</cn></apply><cn id="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.4.7.1.2.3.3.3">1</cn></apply></apply></apply></apply><cerror id="S2.E1.m1.1.1.1.1ai.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1aj.cmml" xref="S2.E1.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E1.m1.1.1.1.1.4.9.1.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1"><cos id="S2.E1.m1.1.1.1.1.4.9.1.1.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.1"></cos><apply id="S2.E1.m1.1.1.1.1.4.9.1.2.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.2"><times id="S2.E1.m1.1.1.1.1.4.9.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.2.1"></times><ci id="S2.E1.m1.1.1.1.1.4.9.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.2.2">𝑖</ci><apply id="S2.E1.m1.1.1.1.1.4.9.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.4.9.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.4.9.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.2">𝜃</ci><apply id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3"><minus id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.1"></minus><apply id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2"><divide id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2"></divide><ci id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2.2">𝑑</ci><cn id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.2.3">2</cn></apply><cn id="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.4.9.1.2.3.3.3">1</cn></apply></apply></apply></apply></matrixrow></matrix></apply><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1"><csymbol cd="latexml" id="S2.E1.m1.2.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1">matrix</csymbol><matrix id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1.1"><matrixrow id="S2.E1.m1.2.2.1.1a.cmml" xref="S2.E1.m1.2.2.1.1"><apply id="S2.E1.m1.2.2.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.2">𝑝</ci><cn id="S2.E1.m1.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.2.2.1.1.1.1.1.3">0</cn></apply></matrixrow><matrixrow id="S2.E1.m1.2.2.1.1b.cmml" xref="S2.E1.m1.2.2.1.1"><apply id="S2.E1.m1.2.2.1.1.2.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.2.1.1.2">𝑝</ci><cn id="S2.E1.m1.2.2.1.1.2.1.1.3.cmml" type="integer" xref="S2.E1.m1.2.2.1.1.2.1.1.3">1</cn></apply></matrixrow><matrixrow id="S2.E1.m1.2.2.1.1c.cmml" xref="S2.E1.m1.2.2.1.1"><ci id="S2.E1.m1.2.2.1.1.3.1.1.cmml" xref="S2.E1.m1.2.2.1.1.3.1.1">⋯</ci></matrixrow><matrixrow id="S2.E1.m1.2.2.1.1d.cmml" xref="S2.E1.m1.2.2.1.1"><apply id="S2.E1.m1.2.2.1.1.4.1.1.cmml" xref="S2.E1.m1.2.2.1.1.4.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.4.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.4.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.4.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.4.1.1.2">𝑝</ci><apply id="S2.E1.m1.2.2.1.1.4.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.4.1.1.3"><minus id="S2.E1.m1.2.2.1.1.4.1.1.3.1.cmml" xref="S2.E1.m1.2.2.1.1.4.1.1.3.1"></minus><ci id="S2.E1.m1.2.2.1.1.4.1.1.3.2.cmml" xref="S2.E1.m1.2.2.1.1.4.1.1.3.2">𝑑</ci><cn id="S2.E1.m1.2.2.1.1.4.1.1.3.3.cmml" type="integer" xref="S2.E1.m1.2.2.1.1.4.1.1.3.3">1</cn></apply></apply></matrixrow></matrix></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">f(x_{i},i)=\left(\begin{matrix}\cos{i\theta_{0}}&amp;&amp;-\sin{i\theta}&amp;&amp;\cdots&amp;&amp;0&amp;&amp;0%
\\
\sin{i\theta_{0}}&amp;&amp;\cos{i\theta}&amp;&amp;\cdots&amp;&amp;0&amp;&amp;0\\
0&amp;&amp;0&amp;&amp;\cdots&amp;&amp;\cos{i\theta_{\frac{d}{2}-1}}&amp;&amp;-\sin{i\theta_{\frac{d}{2}-1}}\\
0&amp;&amp;0&amp;&amp;\cdots&amp;&amp;\sin{i\theta_{\frac{d}{2}-1}}&amp;&amp;\cos{i\theta_{\frac{d}{2}-1}}\end%
{matrix}\right)\left(\begin{matrix}p_{0}\\
p_{1}\\
\cdots\\
p_{d-1}\end{matrix}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.4d">italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_i ) = ( start_ARG start_ROW start_CELL roman_cos italic_i italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_CELL start_CELL end_CELL start_CELL - roman_sin italic_i italic_θ end_CELL start_CELL end_CELL start_CELL ⋯ end_CELL start_CELL end_CELL start_CELL 0 end_CELL start_CELL end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL roman_sin italic_i italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_CELL start_CELL end_CELL start_CELL roman_cos italic_i italic_θ end_CELL start_CELL end_CELL start_CELL ⋯ end_CELL start_CELL end_CELL start_CELL 0 end_CELL start_CELL end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL end_CELL start_CELL 0 end_CELL start_CELL end_CELL start_CELL ⋯ end_CELL start_CELL end_CELL start_CELL roman_cos italic_i italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL start_CELL end_CELL start_CELL - roman_sin italic_i italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL end_CELL start_CELL 0 end_CELL start_CELL end_CELL start_CELL ⋯ end_CELL start_CELL end_CELL start_CELL roman_sin italic_i italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL start_CELL end_CELL start_CELL roman_cos italic_i italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ) ( start_ARG start_ROW start_CELL italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL ⋯ end_CELL end_ROW start_ROW start_CELL italic_p start_POSTSUBSCRIPT italic_d - 1 end_POSTSUBSCRIPT end_CELL end_ROW end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.2">2)
We rotating <math alttext="x_{i}" class="ltx_Math" display="inline" id="S2.SS3.p3.1.m1.1"><semantics id="S2.SS3.p3.1.m1.1a"><msub id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml"><mi id="S2.SS3.p3.1.m1.1.1.2" xref="S2.SS3.p3.1.m1.1.1.2.cmml">x</mi><mi id="S2.SS3.p3.1.m1.1.1.3" xref="S2.SS3.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><apply id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p3.1.m1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2">𝑥</ci><ci id="S2.SS3.p3.1.m1.1.1.3.cmml" xref="S2.SS3.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> counterclockwise by <math alttext="i\theta" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m2.1"><semantics id="S2.SS3.p3.2.m2.1a"><mrow id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml"><mi id="S2.SS3.p3.2.m2.1.1.2" xref="S2.SS3.p3.2.m2.1.1.2.cmml">i</mi><mo id="S2.SS3.p3.2.m2.1.1.1" xref="S2.SS3.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.SS3.p3.2.m2.1.1.3" xref="S2.SS3.p3.2.m2.1.1.3.cmml">θ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><apply id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1"><times id="S2.SS3.p3.2.m2.1.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1.1"></times><ci id="S2.SS3.p3.2.m2.1.1.2.cmml" xref="S2.SS3.p3.2.m2.1.1.2">𝑖</ci><ci id="S2.SS3.p3.2.m2.1.1.3.cmml" xref="S2.SS3.p3.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">i\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.1d">italic_i italic_θ</annotation></semantics></math> degrees, to re-set its positional encoding to zero:</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p4">
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f(x_{i},0)=\left(\begin{matrix}  \cos{i\theta_{0}}&amp;&amp;\sin{i\theta}&amp;&amp;\cdots&amp;&amp;0&amp;&amp;%
0  \\
  -\sin{i\theta_{0}}&amp;&amp;\cos{i\theta}&amp;&amp;\cdots&amp;&amp;0&amp;&amp;0  \\
  0&amp;&amp;0&amp;&amp;\cdots&amp;&amp;\cos{i\theta_{\frac{d}{2}-1}}&amp;&amp;\sin{i\theta_{\frac{d}{2}-1}}  %
\\
  0&amp;&amp;0&amp;&amp;\cdots&amp;&amp;-\sin{i\theta_{\frac{d}{2}-1}}&amp;&amp;\cos{i\theta_{\frac{d}{2}-1}}%
\end{matrix}\right)f(x_{i},i)" class="ltx_Math" display="block" id="S2.E2.m1.5"><semantics id="S2.E2.m1.5a"><mrow id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml"><mrow id="S2.E2.m1.4.4.1" xref="S2.E2.m1.4.4.1.cmml"><mi id="S2.E2.m1.4.4.1.3" xref="S2.E2.m1.4.4.1.3.cmml">f</mi><mo id="S2.E2.m1.4.4.1.2" xref="S2.E2.m1.4.4.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.4.4.1.1.1" xref="S2.E2.m1.4.4.1.1.2.cmml"><mo id="S2.E2.m1.4.4.1.1.1.2" stretchy="false" xref="S2.E2.m1.4.4.1.1.2.cmml">(</mo><msub id="S2.E2.m1.4.4.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.2.cmml">x</mi><mi id="S2.E2.m1.4.4.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2.m1.4.4.1.1.1.3" xref="S2.E2.m1.4.4.1.1.2.cmml">,</mo><mn id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">0</mn><mo id="S2.E2.m1.4.4.1.1.1.4" stretchy="false" xref="S2.E2.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.5.5.3" xref="S2.E2.m1.5.5.3.cmml">=</mo><mrow id="S2.E2.m1.5.5.2" xref="S2.E2.m1.5.5.2.cmml"><mrow id="S2.E2.m1.5.5.2.3.2" xref="S2.E2.m1.5.5.2.cmml"><mo id="S2.E2.m1.5.5.2.3.2.1" xref="S2.E2.m1.5.5.2.cmml">(</mo><mtable columnspacing="5pt" displaystyle="true" id="S2.E2.m1.1.1.1.1" rowspacing="0pt" xref="S2.E2.m1.1.1.2.cmml"><mtr id="S2.E2.m1.1.1.1.1a" xref="S2.E2.m1.1.1.2.cmml"><mtd id="S2.E2.m1.1.1.1.1b" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.2" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.1.1.1.2.cmml"> </mi><mo id="S2.E2.m1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.1.1.3" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.1.1.1.3.cmml"> </mi><mo id="S2.E2.m1.1.1.1.1.1.1.1.1a" lspace="0.167em" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.4" xref="S2.E2.m1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.4.1" xref="S2.E2.m1.1.1.1.1.1.1.1.4.1.cmml">cos</mi><mo id="S2.E2.m1.1.1.1.1.1.1.1.4a" lspace="0.167em" xref="S2.E2.m1.1.1.1.1.1.1.1.4.cmml">⁡</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.4.2" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.4.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.1.1.1.4.2.1" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.1.1.1.1.1.4.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.4.2.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.3.2.cmml">θ</mi><mn id="S2.E2.m1.1.1.1.1.1.1.1.4.2.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.3.3.cmml">0</mn></msub></mrow></mrow></mrow></mtd><mtd id="S2.E2.m1.1.1.1.1c" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1d" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.3.1" xref="S2.E2.m1.1.1.1.1.1.3.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.3.1.1" xref="S2.E2.m1.1.1.1.1.1.3.1.1.cmml">sin</mi><mo id="S2.E2.m1.1.1.1.1.1.3.1a" lspace="0.167em" xref="S2.E2.m1.1.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S2.E2.m1.1.1.1.1.1.3.1.2" xref="S2.E2.m1.1.1.1.1.1.3.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.3.1.2.2" xref="S2.E2.m1.1.1.1.1.1.3.1.2.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.1.3.1.2.1" xref="S2.E2.m1.1.1.1.1.1.3.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.3.1.2.3" xref="S2.E2.m1.1.1.1.1.1.3.1.2.3.cmml">θ</mi></mrow></mrow></mtd><mtd id="S2.E2.m1.1.1.1.1e" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1f" xref="S2.E2.m1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.5.1" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.1.5.1.cmml">⋯</mi></mtd><mtd id="S2.E2.m1.1.1.1.1g" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1h" xref="S2.E2.m1.1.1.2.cmml"><mn id="S2.E2.m1.1.1.1.1.1.7.1" xref="S2.E2.m1.1.1.1.1.1.7.1.cmml">0</mn></mtd><mtd id="S2.E2.m1.1.1.1.1i" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1j" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.9.1" xref="S2.E2.m1.1.1.1.1.1.9.1.cmml"><mn id="S2.E2.m1.1.1.1.1.1.9.1.2" xref="S2.E2.m1.1.1.1.1.1.9.1.2.cmml">0</mn><mo id="S2.E2.m1.1.1.1.1.1.9.1.1" xref="S2.E2.m1.1.1.1.1.1.9.1.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.9.1.3" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.1.9.1.3.cmml"> </mi><mo id="S2.E2.m1.1.1.1.1.1.9.1.1a" xref="S2.E2.m1.1.1.1.1.1.9.1.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.9.1.4" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.1.9.1.4.cmml"> </mi></mrow></mtd></mtr><mtr id="S2.E2.m1.1.1.1.1k" xref="S2.E2.m1.1.1.2.cmml"><mtd id="S2.E2.m1.1.1.1.1l" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.2.1.1" xref="S2.E2.m1.1.1.1.1.2.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1.2.1.1.2" xref="S2.E2.m1.1.1.1.1.2.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.2.1.1.2.2" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.2.1.1.2.2.cmml"> </mi><mo id="S2.E2.m1.1.1.1.1.2.1.1.2.1" xref="S2.E2.m1.1.1.1.1.2.1.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.2.1.1.2.3" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.2.1.1.2.3.cmml"> </mi></mrow><mo id="S2.E2.m1.1.1.1.1.2.1.1.1" xref="S2.E2.m1.1.1.1.1.2.1.1.1.cmml">−</mo><mrow id="S2.E2.m1.1.1.1.1.2.1.1.3" xref="S2.E2.m1.1.1.1.1.2.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.2.1.1.3.1" xref="S2.E2.m1.1.1.1.1.2.1.1.3.1.cmml">sin</mi><mo id="S2.E2.m1.1.1.1.1.2.1.1.3a" lspace="0.167em" xref="S2.E2.m1.1.1.1.1.2.1.1.3.cmml">⁡</mo><mrow id="S2.E2.m1.1.1.1.1.2.1.1.3.2" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.cmml"><mi id="S2.E2.m1.1.1.1.1.2.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.2.1.1.3.2.1" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.1.1.2.1.1.3.2.3" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.2.1.1.3.2.3.2" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.3.2.cmml">θ</mi><mn id="S2.E2.m1.1.1.1.1.2.1.1.3.2.3.3" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.3.3.cmml">0</mn></msub></mrow></mrow></mrow></mtd><mtd id="S2.E2.m1.1.1.1.1m" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1n" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.2.3.1" xref="S2.E2.m1.1.1.1.1.2.3.1.cmml"><mi id="S2.E2.m1.1.1.1.1.2.3.1.1" xref="S2.E2.m1.1.1.1.1.2.3.1.1.cmml">cos</mi><mo id="S2.E2.m1.1.1.1.1.2.3.1a" lspace="0.167em" xref="S2.E2.m1.1.1.1.1.2.3.1.cmml">⁡</mo><mrow id="S2.E2.m1.1.1.1.1.2.3.1.2" xref="S2.E2.m1.1.1.1.1.2.3.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.2.3.1.2.2" xref="S2.E2.m1.1.1.1.1.2.3.1.2.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.2.3.1.2.1" xref="S2.E2.m1.1.1.1.1.2.3.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.2.3.1.2.3" xref="S2.E2.m1.1.1.1.1.2.3.1.2.3.cmml">θ</mi></mrow></mrow></mtd><mtd id="S2.E2.m1.1.1.1.1o" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1p" xref="S2.E2.m1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.2.5.1" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.2.5.1.cmml">⋯</mi></mtd><mtd id="S2.E2.m1.1.1.1.1q" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1r" xref="S2.E2.m1.1.1.2.cmml"><mn id="S2.E2.m1.1.1.1.1.2.7.1" xref="S2.E2.m1.1.1.1.1.2.7.1.cmml">0</mn></mtd><mtd id="S2.E2.m1.1.1.1.1s" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1t" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.2.9.1" xref="S2.E2.m1.1.1.1.1.2.9.1.cmml"><mn id="S2.E2.m1.1.1.1.1.2.9.1.2" xref="S2.E2.m1.1.1.1.1.2.9.1.2.cmml">0</mn><mo id="S2.E2.m1.1.1.1.1.2.9.1.1" xref="S2.E2.m1.1.1.1.1.2.9.1.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.2.9.1.3" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.2.9.1.3.cmml"> </mi><mo id="S2.E2.m1.1.1.1.1.2.9.1.1a" xref="S2.E2.m1.1.1.1.1.2.9.1.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.2.9.1.4" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.2.9.1.4.cmml"> </mi></mrow></mtd></mtr><mtr id="S2.E2.m1.1.1.1.1u" xref="S2.E2.m1.1.1.2.cmml"><mtd id="S2.E2.m1.1.1.1.1v" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.3.1.1" xref="S2.E2.m1.1.1.1.1.3.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.3.1.1.2" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.3.1.1.2.cmml"> </mi><mo id="S2.E2.m1.1.1.1.1.3.1.1.1" xref="S2.E2.m1.1.1.1.1.3.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.1.1.3" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.3.1.1.3.cmml"> </mi><mo id="S2.E2.m1.1.1.1.1.3.1.1.1a" xref="S2.E2.m1.1.1.1.1.3.1.1.1.cmml">⁢</mo><mn id="S2.E2.m1.1.1.1.1.3.1.1.4" xref="S2.E2.m1.1.1.1.1.3.1.1.4.cmml">0</mn></mrow></mtd><mtd id="S2.E2.m1.1.1.1.1w" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1x" xref="S2.E2.m1.1.1.2.cmml"><mn id="S2.E2.m1.1.1.1.1.3.3.1" xref="S2.E2.m1.1.1.1.1.3.3.1.cmml">0</mn></mtd><mtd id="S2.E2.m1.1.1.1.1y" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1z" xref="S2.E2.m1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.5.1" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.3.5.1.cmml">⋯</mi></mtd><mtd id="S2.E2.m1.1.1.1.1aa" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1ab" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.3.7.1" xref="S2.E2.m1.1.1.1.1.3.7.1.cmml"><mi id="S2.E2.m1.1.1.1.1.3.7.1.1" xref="S2.E2.m1.1.1.1.1.3.7.1.1.cmml">cos</mi><mo id="S2.E2.m1.1.1.1.1.3.7.1a" lspace="0.167em" xref="S2.E2.m1.1.1.1.1.3.7.1.cmml">⁡</mo><mrow id="S2.E2.m1.1.1.1.1.3.7.1.2" xref="S2.E2.m1.1.1.1.1.3.7.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.7.1.2.2" xref="S2.E2.m1.1.1.1.1.3.7.1.2.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.3.7.1.2.1" xref="S2.E2.m1.1.1.1.1.3.7.1.2.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.1.1.3.7.1.2.3" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.7.1.2.3.2" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.2.cmml">θ</mi><mrow id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.cmml"><mfrac id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2.2" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2.2.cmml">d</mi><mn id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2.3" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2.3.cmml">2</mn></mfrac><mo id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.1" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.1.cmml">−</mo><mn id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.3" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mtd><mtd id="S2.E2.m1.1.1.1.1ac" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1ad" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.3.9.1" xref="S2.E2.m1.1.1.1.1.3.9.1.cmml"><mi id="S2.E2.m1.1.1.1.1.3.9.1.1" xref="S2.E2.m1.1.1.1.1.3.9.1.1.cmml">sin</mi><mo id="S2.E2.m1.1.1.1.1.3.9.1a" lspace="0.167em" xref="S2.E2.m1.1.1.1.1.3.9.1.cmml">⁡</mo><mrow id="S2.E2.m1.1.1.1.1.3.9.1.2" xref="S2.E2.m1.1.1.1.1.3.9.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.9.1.2.2" xref="S2.E2.m1.1.1.1.1.3.9.1.2.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.3.9.1.2.1" xref="S2.E2.m1.1.1.1.1.3.9.1.2.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.1.1.3.9.1.2.3" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.9.1.2.3.2" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.2.cmml">θ</mi><mrow id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.cmml"><mfrac id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2.2" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2.2.cmml">d</mi><mn id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2.3" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2.3.cmml">2</mn></mfrac><mo id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.1" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.1.cmml">−</mo><mn id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.3" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E2.m1.1.1.1.1.3.9.1.2.1a" xref="S2.E2.m1.1.1.1.1.3.9.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.9.1.2.4" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.3.9.1.2.4.cmml"> </mi><mo id="S2.E2.m1.1.1.1.1.3.9.1.2.1b" xref="S2.E2.m1.1.1.1.1.3.9.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.9.1.2.5" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.3.9.1.2.5.cmml"> </mi></mrow></mrow></mtd></mtr><mtr id="S2.E2.m1.1.1.1.1ae" xref="S2.E2.m1.1.1.2.cmml"><mtd id="S2.E2.m1.1.1.1.1af" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.4.1.1" xref="S2.E2.m1.1.1.1.1.4.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.4.1.1.2" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.4.1.1.2.cmml"> </mi><mo id="S2.E2.m1.1.1.1.1.4.1.1.1" xref="S2.E2.m1.1.1.1.1.4.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.4.1.1.3" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.4.1.1.3.cmml"> </mi><mo id="S2.E2.m1.1.1.1.1.4.1.1.1a" xref="S2.E2.m1.1.1.1.1.4.1.1.1.cmml">⁢</mo><mn id="S2.E2.m1.1.1.1.1.4.1.1.4" xref="S2.E2.m1.1.1.1.1.4.1.1.4.cmml">0</mn></mrow></mtd><mtd id="S2.E2.m1.1.1.1.1ag" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1ah" xref="S2.E2.m1.1.1.2.cmml"><mn id="S2.E2.m1.1.1.1.1.4.3.1" xref="S2.E2.m1.1.1.1.1.4.3.1.cmml">0</mn></mtd><mtd id="S2.E2.m1.1.1.1.1ai" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1aj" xref="S2.E2.m1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.4.5.1" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.4.5.1.cmml">⋯</mi></mtd><mtd id="S2.E2.m1.1.1.1.1ak" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1al" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.4.7.1" xref="S2.E2.m1.1.1.1.1.4.7.1.cmml"><mo id="S2.E2.m1.1.1.1.1.4.7.1a" rspace="0.167em" xref="S2.E2.m1.1.1.1.1.4.7.1.cmml">−</mo><mrow id="S2.E2.m1.1.1.1.1.4.7.1.2" xref="S2.E2.m1.1.1.1.1.4.7.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.4.7.1.2.1" xref="S2.E2.m1.1.1.1.1.4.7.1.2.1.cmml">sin</mi><mo id="S2.E2.m1.1.1.1.1.4.7.1.2a" lspace="0.167em" xref="S2.E2.m1.1.1.1.1.4.7.1.2.cmml">⁡</mo><mrow id="S2.E2.m1.1.1.1.1.4.7.1.2.2" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.4.7.1.2.2.2" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.4.7.1.2.2.1" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.2" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.2.cmml">θ</mi><mrow id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.cmml"><mfrac id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2.cmml"><mi id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2.2" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2.2.cmml">d</mi><mn id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2.3" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2.3.cmml">2</mn></mfrac><mo id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.1" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.1.cmml">−</mo><mn id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.3" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mrow></mtd><mtd id="S2.E2.m1.1.1.1.1am" xref="S2.E2.m1.1.1.1.1c.cmml"></mtd><mtd id="S2.E2.m1.1.1.1.1an" xref="S2.E2.m1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.4.9.1" xref="S2.E2.m1.1.1.1.1.4.9.1.cmml"><mi id="S2.E2.m1.1.1.1.1.4.9.1.1" xref="S2.E2.m1.1.1.1.1.4.9.1.1.cmml">cos</mi><mo id="S2.E2.m1.1.1.1.1.4.9.1a" lspace="0.167em" xref="S2.E2.m1.1.1.1.1.4.9.1.cmml">⁡</mo><mrow id="S2.E2.m1.1.1.1.1.4.9.1.2" xref="S2.E2.m1.1.1.1.1.4.9.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.4.9.1.2.2" xref="S2.E2.m1.1.1.1.1.4.9.1.2.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.4.9.1.2.1" xref="S2.E2.m1.1.1.1.1.4.9.1.2.1.cmml">⁢</mo><msub id="S2.E2.m1.1.1.1.1.4.9.1.2.3" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.4.9.1.2.3.2" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.2.cmml">θ</mi><mrow id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.cmml"><mfrac id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2.cmml"><mi id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2.2" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2.2.cmml">d</mi><mn id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2.3" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2.3.cmml">2</mn></mfrac><mo id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.1" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.1.cmml">−</mo><mn id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.3" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mtd></mtr></mtable><mo id="S2.E2.m1.5.5.2.3.2.2" xref="S2.E2.m1.5.5.2.cmml">)</mo></mrow><mo id="S2.E2.m1.5.5.2.2" xref="S2.E2.m1.5.5.2.2.cmml">⁢</mo><mi id="S2.E2.m1.5.5.2.4" xref="S2.E2.m1.5.5.2.4.cmml">f</mi><mo id="S2.E2.m1.5.5.2.2a" xref="S2.E2.m1.5.5.2.2.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.2.1.1" xref="S2.E2.m1.5.5.2.1.2.cmml"><mo id="S2.E2.m1.5.5.2.1.1.2" stretchy="false" xref="S2.E2.m1.5.5.2.1.2.cmml">(</mo><msub id="S2.E2.m1.5.5.2.1.1.1" xref="S2.E2.m1.5.5.2.1.1.1.cmml"><mi id="S2.E2.m1.5.5.2.1.1.1.2" xref="S2.E2.m1.5.5.2.1.1.1.2.cmml">x</mi><mi id="S2.E2.m1.5.5.2.1.1.1.3" xref="S2.E2.m1.5.5.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2.m1.5.5.2.1.1.3" xref="S2.E2.m1.5.5.2.1.2.cmml">,</mo><mi id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">i</mi><mo id="S2.E2.m1.5.5.2.1.1.4" stretchy="false" xref="S2.E2.m1.5.5.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.5b"><apply id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5"><eq id="S2.E2.m1.5.5.3.cmml" xref="S2.E2.m1.5.5.3"></eq><apply id="S2.E2.m1.4.4.1.cmml" xref="S2.E2.m1.4.4.1"><times id="S2.E2.m1.4.4.1.2.cmml" xref="S2.E2.m1.4.4.1.2"></times><ci id="S2.E2.m1.4.4.1.3.cmml" xref="S2.E2.m1.4.4.1.3">𝑓</ci><interval closure="open" id="S2.E2.m1.4.4.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1"><apply id="S2.E2.m1.4.4.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2">𝑥</ci><ci id="S2.E2.m1.4.4.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3">𝑖</ci></apply><cn id="S2.E2.m1.2.2.cmml" type="integer" xref="S2.E2.m1.2.2">0</cn></interval></apply><apply id="S2.E2.m1.5.5.2.cmml" xref="S2.E2.m1.5.5.2"><times id="S2.E2.m1.5.5.2.2.cmml" xref="S2.E2.m1.5.5.2.2"></times><apply id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1">matrix</csymbol><matrix id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1"><matrixrow id="S2.E2.m1.1.1.1.1a.cmml" xref="S2.E2.m1.1.1.1.1"><apply id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1"></times><ci id="S2.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2"> </ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.3"> </ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4"><cos id="S2.E2.m1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.1"></cos><apply id="S2.E2.m1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2"><times id="S2.E2.m1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.1"></times><ci id="S2.E2.m1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.2">𝑖</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.3.2">𝜃</ci><cn id="S2.E2.m1.1.1.1.1.1.1.1.4.2.3.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.1.1.1.4.2.3.3">0</cn></apply></apply></apply></apply><cerror id="S2.E2.m1.1.1.1.1b.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1c.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E2.m1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.3.1"><sin id="S2.E2.m1.1.1.1.1.1.3.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.3.1.1"></sin><apply id="S2.E2.m1.1.1.1.1.1.3.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.3.1.2"><times id="S2.E2.m1.1.1.1.1.1.3.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.3.1.2.1"></times><ci id="S2.E2.m1.1.1.1.1.1.3.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.3.1.2.2">𝑖</ci><ci id="S2.E2.m1.1.1.1.1.1.3.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3.1.2.3">𝜃</ci></apply></apply><cerror id="S2.E2.m1.1.1.1.1d.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1e.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><ci id="S2.E2.m1.1.1.1.1.1.5.1.cmml" xref="S2.E2.m1.1.1.1.1.1.5.1">⋯</ci><cerror id="S2.E2.m1.1.1.1.1f.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1g.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><cn id="S2.E2.m1.1.1.1.1.1.7.1.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.1.7.1">0</cn><cerror id="S2.E2.m1.1.1.1.1h.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1i.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E2.m1.1.1.1.1.1.9.1.cmml" xref="S2.E2.m1.1.1.1.1.1.9.1"><times id="S2.E2.m1.1.1.1.1.1.9.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.9.1.1"></times><cn id="S2.E2.m1.1.1.1.1.1.9.1.2.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.1.9.1.2">0</cn><ci id="S2.E2.m1.1.1.1.1.1.9.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.9.1.3"> </ci><ci id="S2.E2.m1.1.1.1.1.1.9.1.4.cmml" xref="S2.E2.m1.1.1.1.1.1.9.1.4"> </ci></apply></matrixrow><matrixrow id="S2.E2.m1.1.1.1.1j.cmml" xref="S2.E2.m1.1.1.1.1"><apply id="S2.E2.m1.1.1.1.1.2.1.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1"><minus id="S2.E2.m1.1.1.1.1.2.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.1"></minus><apply id="S2.E2.m1.1.1.1.1.2.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.2"><times id="S2.E2.m1.1.1.1.1.2.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.2.1"></times><ci id="S2.E2.m1.1.1.1.1.2.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.2.2"> </ci><ci id="S2.E2.m1.1.1.1.1.2.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.2.3"> </ci></apply><apply id="S2.E2.m1.1.1.1.1.2.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.3"><sin id="S2.E2.m1.1.1.1.1.2.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.3.1"></sin><apply id="S2.E2.m1.1.1.1.1.2.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2"><times id="S2.E2.m1.1.1.1.1.2.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.1"></times><ci id="S2.E2.m1.1.1.1.1.2.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.2">𝑖</ci><apply id="S2.E2.m1.1.1.1.1.2.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.1.1.3.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.1.1.3.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.3.2">𝜃</ci><cn id="S2.E2.m1.1.1.1.1.2.1.1.3.2.3.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.2.1.1.3.2.3.3">0</cn></apply></apply></apply></apply><cerror id="S2.E2.m1.1.1.1.1k.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1l.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E2.m1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.2.3.1"><cos id="S2.E2.m1.1.1.1.1.2.3.1.1.cmml" xref="S2.E2.m1.1.1.1.1.2.3.1.1"></cos><apply id="S2.E2.m1.1.1.1.1.2.3.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2.3.1.2"><times id="S2.E2.m1.1.1.1.1.2.3.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.3.1.2.1"></times><ci id="S2.E2.m1.1.1.1.1.2.3.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.3.1.2.2">𝑖</ci><ci id="S2.E2.m1.1.1.1.1.2.3.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3.1.2.3">𝜃</ci></apply></apply><cerror id="S2.E2.m1.1.1.1.1m.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1n.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><ci id="S2.E2.m1.1.1.1.1.2.5.1.cmml" xref="S2.E2.m1.1.1.1.1.2.5.1">⋯</ci><cerror id="S2.E2.m1.1.1.1.1o.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1p.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><cn id="S2.E2.m1.1.1.1.1.2.7.1.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.2.7.1">0</cn><cerror id="S2.E2.m1.1.1.1.1q.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1r.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E2.m1.1.1.1.1.2.9.1.cmml" xref="S2.E2.m1.1.1.1.1.2.9.1"><times id="S2.E2.m1.1.1.1.1.2.9.1.1.cmml" xref="S2.E2.m1.1.1.1.1.2.9.1.1"></times><cn id="S2.E2.m1.1.1.1.1.2.9.1.2.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.2.9.1.2">0</cn><ci id="S2.E2.m1.1.1.1.1.2.9.1.3.cmml" xref="S2.E2.m1.1.1.1.1.2.9.1.3"> </ci><ci id="S2.E2.m1.1.1.1.1.2.9.1.4.cmml" xref="S2.E2.m1.1.1.1.1.2.9.1.4"> </ci></apply></matrixrow><matrixrow id="S2.E2.m1.1.1.1.1s.cmml" xref="S2.E2.m1.1.1.1.1"><apply id="S2.E2.m1.1.1.1.1.3.1.1.cmml" xref="S2.E2.m1.1.1.1.1.3.1.1"><times id="S2.E2.m1.1.1.1.1.3.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.3.1.1.1"></times><ci id="S2.E2.m1.1.1.1.1.3.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.3.1.1.2"> </ci><ci id="S2.E2.m1.1.1.1.1.3.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3.1.1.3"> </ci><cn id="S2.E2.m1.1.1.1.1.3.1.1.4.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.3.1.1.4">0</cn></apply><cerror id="S2.E2.m1.1.1.1.1t.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1u.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><cn id="S2.E2.m1.1.1.1.1.3.3.1.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.3.3.1">0</cn><cerror id="S2.E2.m1.1.1.1.1v.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1w.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><ci id="S2.E2.m1.1.1.1.1.3.5.1.cmml" xref="S2.E2.m1.1.1.1.1.3.5.1">⋯</ci><cerror id="S2.E2.m1.1.1.1.1x.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1y.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E2.m1.1.1.1.1.3.7.1.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1"><cos id="S2.E2.m1.1.1.1.1.3.7.1.1.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.1"></cos><apply id="S2.E2.m1.1.1.1.1.3.7.1.2.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.2"><times id="S2.E2.m1.1.1.1.1.3.7.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.2.1"></times><ci id="S2.E2.m1.1.1.1.1.3.7.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.2.2">𝑖</ci><apply id="S2.E2.m1.1.1.1.1.3.7.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.7.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.7.1.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.2">𝜃</ci><apply id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3"><minus id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.1"></minus><apply id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2"><divide id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2"></divide><ci id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2.2">𝑑</ci><cn id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.2.3">2</cn></apply><cn id="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.3.7.1.2.3.3.3">1</cn></apply></apply></apply></apply><cerror id="S2.E2.m1.1.1.1.1z.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1aa.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E2.m1.1.1.1.1.3.9.1.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1"><sin id="S2.E2.m1.1.1.1.1.3.9.1.1.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.1"></sin><apply id="S2.E2.m1.1.1.1.1.3.9.1.2.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2"><times id="S2.E2.m1.1.1.1.1.3.9.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.1"></times><ci id="S2.E2.m1.1.1.1.1.3.9.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.2">𝑖</ci><apply id="S2.E2.m1.1.1.1.1.3.9.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.9.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.9.1.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.2">𝜃</ci><apply id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3"><minus id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.1"></minus><apply id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2"><divide id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2"></divide><ci id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2.2">𝑑</ci><cn id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.2.3">2</cn></apply><cn id="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.3.9.1.2.3.3.3">1</cn></apply></apply><ci id="S2.E2.m1.1.1.1.1.3.9.1.2.4.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.4"> </ci><ci id="S2.E2.m1.1.1.1.1.3.9.1.2.5.cmml" xref="S2.E2.m1.1.1.1.1.3.9.1.2.5"> </ci></apply></apply></matrixrow><matrixrow id="S2.E2.m1.1.1.1.1ab.cmml" xref="S2.E2.m1.1.1.1.1"><apply id="S2.E2.m1.1.1.1.1.4.1.1.cmml" xref="S2.E2.m1.1.1.1.1.4.1.1"><times id="S2.E2.m1.1.1.1.1.4.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.4.1.1.1"></times><ci id="S2.E2.m1.1.1.1.1.4.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.4.1.1.2"> </ci><ci id="S2.E2.m1.1.1.1.1.4.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.4.1.1.3"> </ci><cn id="S2.E2.m1.1.1.1.1.4.1.1.4.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.4.1.1.4">0</cn></apply><cerror id="S2.E2.m1.1.1.1.1ac.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1ad.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><cn id="S2.E2.m1.1.1.1.1.4.3.1.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.4.3.1">0</cn><cerror id="S2.E2.m1.1.1.1.1ae.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1af.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><ci id="S2.E2.m1.1.1.1.1.4.5.1.cmml" xref="S2.E2.m1.1.1.1.1.4.5.1">⋯</ci><cerror id="S2.E2.m1.1.1.1.1ag.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1ah.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E2.m1.1.1.1.1.4.7.1.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1"><minus id="S2.E2.m1.1.1.1.1.4.7.1.1.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1"></minus><apply id="S2.E2.m1.1.1.1.1.4.7.1.2.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2"><sin id="S2.E2.m1.1.1.1.1.4.7.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.1"></sin><apply id="S2.E2.m1.1.1.1.1.4.7.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2"><times id="S2.E2.m1.1.1.1.1.4.7.1.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.1"></times><ci id="S2.E2.m1.1.1.1.1.4.7.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.2">𝑖</ci><apply id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.2">𝜃</ci><apply id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3"><minus id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.1"></minus><apply id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2"><divide id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2"></divide><ci id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2.2">𝑑</ci><cn id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.2.3">2</cn></apply><cn id="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.4.7.1.2.2.3.3.3">1</cn></apply></apply></apply></apply></apply><cerror id="S2.E2.m1.1.1.1.1ai.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1aj.cmml" xref="S2.E2.m1.1.1.1.1c">missing-subexpression</csymbol></cerror><apply id="S2.E2.m1.1.1.1.1.4.9.1.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1"><cos id="S2.E2.m1.1.1.1.1.4.9.1.1.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.1"></cos><apply id="S2.E2.m1.1.1.1.1.4.9.1.2.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.2"><times id="S2.E2.m1.1.1.1.1.4.9.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.2.1"></times><ci id="S2.E2.m1.1.1.1.1.4.9.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.2.2">𝑖</ci><apply id="S2.E2.m1.1.1.1.1.4.9.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.4.9.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.4.9.1.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.2">𝜃</ci><apply id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3"><minus id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.1"></minus><apply id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2"><divide id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2"></divide><ci id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2.2">𝑑</ci><cn id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.2.3">2</cn></apply><cn id="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.4.9.1.2.3.3.3">1</cn></apply></apply></apply></apply></matrixrow></matrix></apply><ci id="S2.E2.m1.5.5.2.4.cmml" xref="S2.E2.m1.5.5.2.4">𝑓</ci><interval closure="open" id="S2.E2.m1.5.5.2.1.2.cmml" xref="S2.E2.m1.5.5.2.1.1"><apply id="S2.E2.m1.5.5.2.1.1.1.cmml" xref="S2.E2.m1.5.5.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.1.1.1.1.cmml" xref="S2.E2.m1.5.5.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.5.5.2.1.1.1.2.cmml" xref="S2.E2.m1.5.5.2.1.1.1.2">𝑥</ci><ci id="S2.E2.m1.5.5.2.1.1.1.3.cmml" xref="S2.E2.m1.5.5.2.1.1.1.3">𝑖</ci></apply><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝑖</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.5c">f(x_{i},0)=\left(\begin{matrix}  \cos{i\theta_{0}}&amp;&amp;\sin{i\theta}&amp;&amp;\cdots&amp;&amp;0&amp;&amp;%
0  \\
  -\sin{i\theta_{0}}&amp;&amp;\cos{i\theta}&amp;&amp;\cdots&amp;&amp;0&amp;&amp;0  \\
  0&amp;&amp;0&amp;&amp;\cdots&amp;&amp;\cos{i\theta_{\frac{d}{2}-1}}&amp;&amp;\sin{i\theta_{\frac{d}{2}-1}}  %
\\
  0&amp;&amp;0&amp;&amp;\cdots&amp;&amp;-\sin{i\theta_{\frac{d}{2}-1}}&amp;&amp;\cos{i\theta_{\frac{d}{2}-1}}%
\end{matrix}\right)f(x_{i},i)</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.5d">italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , 0 ) = ( start_ARG start_ROW start_CELL roman_cos italic_i italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_CELL start_CELL end_CELL start_CELL roman_sin italic_i italic_θ end_CELL start_CELL end_CELL start_CELL ⋯ end_CELL start_CELL end_CELL start_CELL 0 end_CELL start_CELL end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL - roman_sin italic_i italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_CELL start_CELL end_CELL start_CELL roman_cos italic_i italic_θ end_CELL start_CELL end_CELL start_CELL ⋯ end_CELL start_CELL end_CELL start_CELL 0 end_CELL start_CELL end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL end_CELL start_CELL 0 end_CELL start_CELL end_CELL start_CELL ⋯ end_CELL start_CELL end_CELL start_CELL roman_cos italic_i italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL start_CELL end_CELL start_CELL roman_sin italic_i italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL end_CELL start_CELL 0 end_CELL start_CELL end_CELL start_CELL ⋯ end_CELL start_CELL end_CELL start_CELL - roman_sin italic_i italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL start_CELL end_CELL start_CELL roman_cos italic_i italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ) italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_i )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p5">
<p class="ltx_p" id="S2.SS3.p5.1">3) Then, by performing a clockwise rotation of <math alttext="(i_{\Delta})\theta" class="ltx_Math" display="inline" id="S2.SS3.p5.1.m1.1"><semantics id="S2.SS3.p5.1.m1.1a"><mrow id="S2.SS3.p5.1.m1.1.1" xref="S2.SS3.p5.1.m1.1.1.cmml"><mrow id="S2.SS3.p5.1.m1.1.1.1.1" xref="S2.SS3.p5.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS3.p5.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS3.p5.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS3.p5.1.m1.1.1.1.1.1" xref="S2.SS3.p5.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS3.p5.1.m1.1.1.1.1.1.2" xref="S2.SS3.p5.1.m1.1.1.1.1.1.2.cmml">i</mi><mi id="S2.SS3.p5.1.m1.1.1.1.1.1.3" mathvariant="normal" xref="S2.SS3.p5.1.m1.1.1.1.1.1.3.cmml">Δ</mi></msub><mo id="S2.SS3.p5.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS3.p5.1.m1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS3.p5.1.m1.1.1.2" xref="S2.SS3.p5.1.m1.1.1.2.cmml">⁢</mo><mi id="S2.SS3.p5.1.m1.1.1.3" xref="S2.SS3.p5.1.m1.1.1.3.cmml">θ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.1.m1.1b"><apply id="S2.SS3.p5.1.m1.1.1.cmml" xref="S2.SS3.p5.1.m1.1.1"><times id="S2.SS3.p5.1.m1.1.1.2.cmml" xref="S2.SS3.p5.1.m1.1.1.2"></times><apply id="S2.SS3.p5.1.m1.1.1.1.1.1.cmml" xref="S2.SS3.p5.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p5.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.p5.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p5.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS3.p5.1.m1.1.1.1.1.1.2">𝑖</ci><ci id="S2.SS3.p5.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS3.p5.1.m1.1.1.1.1.1.3">Δ</ci></apply><ci id="S2.SS3.p5.1.m1.1.1.3.cmml" xref="S2.SS3.p5.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.1.m1.1c">(i_{\Delta})\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p5.1.m1.1d">( italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ) italic_θ</annotation></semantics></math> degrees, we obtain the final positional encoding vector:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle f(x_{i_{\Delta}},i_{\Delta})" class="ltx_Math" display="inline" id="S2.E3X.2.1.1.m1.2"><semantics id="S2.E3X.2.1.1.m1.2a"><mrow id="S2.E3X.2.1.1.m1.2.2" xref="S2.E3X.2.1.1.m1.2.2.cmml"><mi id="S2.E3X.2.1.1.m1.2.2.4" xref="S2.E3X.2.1.1.m1.2.2.4.cmml">f</mi><mo id="S2.E3X.2.1.1.m1.2.2.3" xref="S2.E3X.2.1.1.m1.2.2.3.cmml">⁢</mo><mrow id="S2.E3X.2.1.1.m1.2.2.2.2" xref="S2.E3X.2.1.1.m1.2.2.2.3.cmml"><mo id="S2.E3X.2.1.1.m1.2.2.2.2.3" stretchy="false" xref="S2.E3X.2.1.1.m1.2.2.2.3.cmml">(</mo><msub id="S2.E3X.2.1.1.m1.1.1.1.1.1" xref="S2.E3X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S2.E3X.2.1.1.m1.1.1.1.1.1.2" xref="S2.E3X.2.1.1.m1.1.1.1.1.1.2.cmml">x</mi><msub id="S2.E3X.2.1.1.m1.1.1.1.1.1.3" xref="S2.E3X.2.1.1.m1.1.1.1.1.1.3.cmml"><mi id="S2.E3X.2.1.1.m1.1.1.1.1.1.3.2" xref="S2.E3X.2.1.1.m1.1.1.1.1.1.3.2.cmml">i</mi><mi id="S2.E3X.2.1.1.m1.1.1.1.1.1.3.3" mathvariant="normal" xref="S2.E3X.2.1.1.m1.1.1.1.1.1.3.3.cmml">Δ</mi></msub></msub><mo id="S2.E3X.2.1.1.m1.2.2.2.2.4" xref="S2.E3X.2.1.1.m1.2.2.2.3.cmml">,</mo><msub id="S2.E3X.2.1.1.m1.2.2.2.2.2" xref="S2.E3X.2.1.1.m1.2.2.2.2.2.cmml"><mi id="S2.E3X.2.1.1.m1.2.2.2.2.2.2" xref="S2.E3X.2.1.1.m1.2.2.2.2.2.2.cmml">i</mi><mi id="S2.E3X.2.1.1.m1.2.2.2.2.2.3" mathvariant="normal" xref="S2.E3X.2.1.1.m1.2.2.2.2.2.3.cmml">Δ</mi></msub><mo id="S2.E3X.2.1.1.m1.2.2.2.2.5" stretchy="false" xref="S2.E3X.2.1.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3X.2.1.1.m1.2b"><apply id="S2.E3X.2.1.1.m1.2.2.cmml" xref="S2.E3X.2.1.1.m1.2.2"><times id="S2.E3X.2.1.1.m1.2.2.3.cmml" xref="S2.E3X.2.1.1.m1.2.2.3"></times><ci id="S2.E3X.2.1.1.m1.2.2.4.cmml" xref="S2.E3X.2.1.1.m1.2.2.4">𝑓</ci><interval closure="open" id="S2.E3X.2.1.1.m1.2.2.2.3.cmml" xref="S2.E3X.2.1.1.m1.2.2.2.2"><apply id="S2.E3X.2.1.1.m1.1.1.1.1.1.cmml" xref="S2.E3X.2.1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E3X.2.1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S2.E3X.2.1.1.m1.1.1.1.1.1.2">𝑥</ci><apply id="S2.E3X.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S2.E3X.2.1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3X.2.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.E3X.2.1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3X.2.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.E3X.2.1.1.m1.1.1.1.1.1.3.2">𝑖</ci><ci id="S2.E3X.2.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.E3X.2.1.1.m1.1.1.1.1.1.3.3">Δ</ci></apply></apply><apply id="S2.E3X.2.1.1.m1.2.2.2.2.2.cmml" xref="S2.E3X.2.1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3X.2.1.1.m1.2.2.2.2.2.1.cmml" xref="S2.E3X.2.1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.E3X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S2.E3X.2.1.1.m1.2.2.2.2.2.2">𝑖</ci><ci id="S2.E3X.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S2.E3X.2.1.1.m1.2.2.2.2.2.3">Δ</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.2.1.1.m1.2c">\displaystyle f(x_{i_{\Delta}},i_{\Delta})</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.2.1.1.m1.2d">italic_f ( italic_x start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=f(x_{i},i_{\Delta})" class="ltx_Math" display="inline" id="S2.E3X.3.2.2.m1.2"><semantics id="S2.E3X.3.2.2.m1.2a"><mrow id="S2.E3X.3.2.2.m1.2.2" xref="S2.E3X.3.2.2.m1.2.2.cmml"><mi id="S2.E3X.3.2.2.m1.2.2.4" xref="S2.E3X.3.2.2.m1.2.2.4.cmml"></mi><mo id="S2.E3X.3.2.2.m1.2.2.3" xref="S2.E3X.3.2.2.m1.2.2.3.cmml">=</mo><mrow id="S2.E3X.3.2.2.m1.2.2.2" xref="S2.E3X.3.2.2.m1.2.2.2.cmml"><mi id="S2.E3X.3.2.2.m1.2.2.2.4" xref="S2.E3X.3.2.2.m1.2.2.2.4.cmml">f</mi><mo id="S2.E3X.3.2.2.m1.2.2.2.3" xref="S2.E3X.3.2.2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E3X.3.2.2.m1.2.2.2.2.2" xref="S2.E3X.3.2.2.m1.2.2.2.2.3.cmml"><mo id="S2.E3X.3.2.2.m1.2.2.2.2.2.3" stretchy="false" xref="S2.E3X.3.2.2.m1.2.2.2.2.3.cmml">(</mo><msub id="S2.E3X.3.2.2.m1.1.1.1.1.1.1" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.2" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.3" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E3X.3.2.2.m1.2.2.2.2.2.4" xref="S2.E3X.3.2.2.m1.2.2.2.2.3.cmml">,</mo><msub id="S2.E3X.3.2.2.m1.2.2.2.2.2.2" xref="S2.E3X.3.2.2.m1.2.2.2.2.2.2.cmml"><mi id="S2.E3X.3.2.2.m1.2.2.2.2.2.2.2" xref="S2.E3X.3.2.2.m1.2.2.2.2.2.2.2.cmml">i</mi><mi id="S2.E3X.3.2.2.m1.2.2.2.2.2.2.3" mathvariant="normal" xref="S2.E3X.3.2.2.m1.2.2.2.2.2.2.3.cmml">Δ</mi></msub><mo id="S2.E3X.3.2.2.m1.2.2.2.2.2.5" stretchy="false" xref="S2.E3X.3.2.2.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3X.3.2.2.m1.2b"><apply id="S2.E3X.3.2.2.m1.2.2.cmml" xref="S2.E3X.3.2.2.m1.2.2"><eq id="S2.E3X.3.2.2.m1.2.2.3.cmml" xref="S2.E3X.3.2.2.m1.2.2.3"></eq><csymbol cd="latexml" id="S2.E3X.3.2.2.m1.2.2.4.cmml" xref="S2.E3X.3.2.2.m1.2.2.4">absent</csymbol><apply id="S2.E3X.3.2.2.m1.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.2.2.2"><times id="S2.E3X.3.2.2.m1.2.2.2.3.cmml" xref="S2.E3X.3.2.2.m1.2.2.2.3"></times><ci id="S2.E3X.3.2.2.m1.2.2.2.4.cmml" xref="S2.E3X.3.2.2.m1.2.2.2.4">𝑓</ci><interval closure="open" id="S2.E3X.3.2.2.m1.2.2.2.2.3.cmml" xref="S2.E3X.3.2.2.m1.2.2.2.2.2"><apply id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.E3X.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E3X.3.2.2.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E3X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3X.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S2.E3X.3.2.2.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E3X.3.2.2.m1.2.2.2.2.2.2.2.cmml" xref="S2.E3X.3.2.2.m1.2.2.2.2.2.2.2">𝑖</ci><ci id="S2.E3X.3.2.2.m1.2.2.2.2.2.2.3.cmml" xref="S2.E3X.3.2.2.m1.2.2.2.2.2.2.3">Δ</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3X.3.2.2.m1.2c">\displaystyle=f(x_{i},i_{\Delta})</annotation><annotation encoding="application/x-llamapun" id="S2.E3X.3.2.2.m1.2d">= italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\begin{pmatrix}\cos{(i_{\Delta})\theta_{0}}&amp;-\sin{(i_{\Delta})%
\theta}&amp;\cdots&amp;0&amp;0\\
\sin{(i_{\Delta})\theta_{0}}&amp;\cos{(i_{\Delta})\theta}&amp;\cdots&amp;0&amp;0\\
0&amp;0&amp;\cdots&amp;\cos{(i_{\Delta})\theta_{\frac{d}{2}-1}}&amp;-\sin{(i_{\Delta})\theta_{%
\frac{d}{2}-1}}\\
0&amp;0&amp;\cdots&amp;\sin{(i_{\Delta})\theta_{\frac{d}{2}-1}}&amp;\cos{(i_{\Delta})\theta_{%
\frac{d}{2}-1}}\end{pmatrix}f(x_{i},0)" class="ltx_Math" display="inline" id="S2.E3Xa.2.1.1.m1.2"><semantics id="S2.E3Xa.2.1.1.m1.2a"><mrow id="S2.E3Xa.2.1.1.m1.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1a.3" xref="S2.E3.m1.1.1.1.1.1.1a.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1a.3.1" xref="S2.E3.m1.1.1.1.1.1.1a.2.1.cmml">(</mo><mtable columnspacing="5pt" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf" rowspacing="0pt" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtr id="S2.E3.m1.1.1.1.1.1.1.1.1.mfa" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfb" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.cmml">cos</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1a" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.2.cmml">⁡</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.2.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1.2.cmml">i</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1.3" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1.3.cmml">Δ</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.3.cmml">⁢</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4.2.cmml">θ</mi><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4.3.cmml">0</mn></msub></mrow></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfc" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2a" rspace="0.167em" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.cmml">−</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.3.3.3.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.3.3.3.1.1.cmml">sin</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1a" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.2.cmml">⁡</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.2.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1.2.cmml">i</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1.3" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1.3.cmml">Δ</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.2.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.3.cmml">θ</mi></mrow></mrow></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfd" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.5.1" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.5.1.cmml">⋯</mi></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfe" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.6.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.6.1.cmml">0</mn></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mff" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.7.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.7.1.cmml">0</mn></mtd></mtr><mtr id="S2.E3.m1.1.1.1.1.1.1.1.1.mfg" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfh" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.5.5.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.5.5.1.1.1.cmml">sin</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1a" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.2.cmml">⁡</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.2.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1.2.cmml">i</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1.3" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1.3.cmml">Δ</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.3.cmml">⁢</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4.2.cmml">θ</mi><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4.3.cmml">0</mn></msub></mrow></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfi" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.7.7.3.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.7.7.3.1.1.cmml">cos</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1a" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.2.cmml">⁡</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.2.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1.2.cmml">i</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1.3" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1.3.cmml">Δ</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.3.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.4" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.4.cmml">θ</mi></mrow></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfj" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.5.1" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.5.1.cmml">⋯</mi></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfk" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.6.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.6.1.cmml">0</mn></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfl" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.7.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.7.1.cmml">0</mn></mtd></mtr><mtr id="S2.E3.m1.1.1.1.1.1.1.1.1.mfm" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfn" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.5.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.5.1.cmml">0</mn></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfo" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.6.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.6.1.cmml">0</mn></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfp" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.7.1" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.7.1.cmml">⋯</mi></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfq" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.9.9.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.9.9.1.1.1.cmml">cos</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1a" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.2.cmml">⁡</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.2.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1.2.cmml">i</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1.3" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1.3.cmml">Δ</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.3.cmml">⁢</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.2.cmml">θ</mi><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.cmml"><mfrac id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2.2.cmml">d</mi><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2.3.cmml">2</mn></mfrac><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.1.cmml">−</mo><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.3.cmml">1</mn></mrow></msub></mrow></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfr" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2a" rspace="0.167em" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.cmml">−</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.11.11.3.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.11.11.3.1.1.cmml">sin</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1a" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.2.cmml">⁡</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.2.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1.2.cmml">i</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1.3" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1.3.cmml">Δ</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.2.cmml">⁢</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.2.cmml">θ</mi><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.cmml"><mfrac id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2.2.cmml">d</mi><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2.3.cmml">2</mn></mfrac><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.1.cmml">−</mo><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mtd></mtr><mtr id="S2.E3.m1.1.1.1.1.1.1.1.1.mfs" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mft" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.5.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.5.1.cmml">0</mn></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfu" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.6.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.6.1.cmml">0</mn></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfv" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.7.1" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.7.1.cmml">⋯</mi></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfw" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.13.13.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.13.13.1.1.1.cmml">sin</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1a" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.2.cmml">⁡</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.2.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1.2.cmml">i</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1.3" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1.3.cmml">Δ</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.3.cmml">⁢</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.2.cmml">θ</mi><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.cmml"><mfrac id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2.2.cmml">d</mi><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2.3.cmml">2</mn></mfrac><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.1.cmml">−</mo><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.3.cmml">1</mn></mrow></msub></mrow></mtd><mtd id="S2.E3.m1.1.1.1.1.1.1.1.1.mfx" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.15.15.3.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.15.15.3.1.1.cmml">cos</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1a" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.2.cmml">⁡</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.2.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.2.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1.2.cmml">i</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1.3" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1.3.cmml">Δ</mi></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.3.cmml">⁢</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.2.cmml">θ</mi><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.cmml"><mfrac id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2.2.cmml">d</mi><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2.3.cmml">2</mn></mfrac><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.1.cmml">−</mo><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.3.cmml">1</mn></mrow></msub></mrow></mtd></mtr></mtable><mo id="S2.E3.m1.1.1.1.1.1.1a.3.2" xref="S2.E3.m1.1.1.1.1.1.1a.2.1.cmml">)</mo></mrow><mo id="S2.E3Xa.2.1.1.m1.2.2.2" xref="S2.E3Xa.2.1.1.m1.2.2.2.cmml">⁢</mo><mi id="S2.E3Xa.2.1.1.m1.2.2.3" xref="S2.E3Xa.2.1.1.m1.2.2.3.cmml">f</mi><mo id="S2.E3Xa.2.1.1.m1.2.2.2a" xref="S2.E3Xa.2.1.1.m1.2.2.2.cmml">⁢</mo><mrow id="S2.E3Xa.2.1.1.m1.2.2.1.1" xref="S2.E3Xa.2.1.1.m1.2.2.1.2.cmml"><mo id="S2.E3Xa.2.1.1.m1.2.2.1.1.2" stretchy="false" xref="S2.E3Xa.2.1.1.m1.2.2.1.2.cmml">(</mo><msub id="S2.E3Xa.2.1.1.m1.2.2.1.1.1" xref="S2.E3Xa.2.1.1.m1.2.2.1.1.1.cmml"><mi id="S2.E3Xa.2.1.1.m1.2.2.1.1.1.2" xref="S2.E3Xa.2.1.1.m1.2.2.1.1.1.2.cmml">x</mi><mi id="S2.E3Xa.2.1.1.m1.2.2.1.1.1.3" xref="S2.E3Xa.2.1.1.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.E3Xa.2.1.1.m1.2.2.1.1.3" xref="S2.E3Xa.2.1.1.m1.2.2.1.2.cmml">,</mo><mn id="S2.E3Xa.2.1.1.m1.1.1" xref="S2.E3Xa.2.1.1.m1.1.1.cmml">0</mn><mo id="S2.E3Xa.2.1.1.m1.2.2.1.1.4" stretchy="false" xref="S2.E3Xa.2.1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3Xa.2.1.1.m1.2b"><apply id="S2.E3Xa.2.1.1.m1.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2"><times id="S2.E3Xa.2.1.1.m1.2.2.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.2"></times><apply id="S2.E3.m1.1.1.1.1.1.1a.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1a.3"><csymbol cd="latexml" id="S2.E3.m1.1.1.1.1.1.1a.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1a.3.1">matrix</csymbol><matrix id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf"><matrixrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mfa.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf"><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.3"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1"><cos id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.1.1.1.1.1"></cos><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1.2">𝑖</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.2.1.1.1.3">Δ</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4.2">𝜃</ci><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.2.2.2.2.4.3">0</cn></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2"><minus id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2"></minus><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.2"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1"><sin id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.3.3.3.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.3.3.3.1.1"></sin><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1.2">𝑖</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.1.1.1.1.3">Δ</ci></apply></apply><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.4.2.2.3">𝜃</ci></apply></apply><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.5.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.5.1">⋯</ci><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.6.1.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.6.1">0</cn><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.7.1.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.4.4.7.1">0</cn></matrixrow><matrixrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mfb.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf"><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.3"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1"><sin id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.5.5.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.5.5.1.1.1"></sin><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1.2">𝑖</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.2.1.1.1.3">Δ</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4.2">𝜃</ci><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.6.6.2.2.4.3">0</cn></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.3"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1"><cos id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.7.7.3.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.7.7.3.1.1"></cos><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1.2">𝑖</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.2.1.1.1.3">Δ</ci></apply></apply><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.4.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.4.2.4">𝜃</ci></apply><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.5.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.5.1">⋯</ci><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.6.1.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.6.1">0</cn><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.7.1.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.8.8.7.1">0</cn></matrixrow><matrixrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mfc.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf"><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.5.1.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.5.1">0</cn><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.6.1.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.6.1">0</cn><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.7.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.7.1">⋯</ci><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.3"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1"><cos id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.9.9.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.9.9.1.1.1"></cos><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1.2">𝑖</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.2.1.1.1.3">Δ</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.2">𝜃</ci><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3"><minus id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.1"></minus><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2"><divide id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2"></divide><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2.2">𝑑</ci><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.2.3">2</cn></apply><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.10.10.2.2.4.3.3">1</cn></apply></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2"><minus id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2"></minus><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.2"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1"><sin id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.11.11.3.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.11.11.3.1.1"></sin><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1.2">𝑖</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.1.1.1.1.3">Δ</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.2">𝜃</ci><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3"><minus id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.1"></minus><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2"><divide id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2"></divide><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2.2">𝑑</ci><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.2.3">2</cn></apply><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.12.12.4.2.2.3.3.3">1</cn></apply></apply></apply></apply></matrixrow><matrixrow id="S2.E3.m1.1.1.1.1.1.1.1.1.mfd.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf"><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.5.1.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.5.1">0</cn><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.6.1.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.6.1">0</cn><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.7.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.7.1">⋯</ci><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.3"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1"><sin id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.13.13.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.13.13.1.1.1"></sin><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1.2">𝑖</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.2.1.1.1.3">Δ</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.2">𝜃</ci><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3"><minus id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.1"></minus><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2"><divide id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2"></divide><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2.2">𝑑</ci><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.2.3">2</cn></apply><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.14.14.2.2.4.3.3">1</cn></apply></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.3"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1"><cos id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.15.15.3.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.15.15.3.1.1"></cos><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1.2">𝑖</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.2.1.1.1.3">Δ</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.2">𝜃</ci><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3"><minus id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.1"></minus><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2"><divide id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2"></divide><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2.2">𝑑</ci><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.2.3">2</cn></apply><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.mf.16.16.4.2.4.3.3">1</cn></apply></apply></apply></matrixrow></matrix></apply><ci id="S2.E3Xa.2.1.1.m1.2.2.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.3">𝑓</ci><interval closure="open" id="S2.E3Xa.2.1.1.m1.2.2.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.1.1"><apply id="S2.E3Xa.2.1.1.m1.2.2.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3Xa.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.E3Xa.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.1.1.1.2">𝑥</ci><ci id="S2.E3Xa.2.1.1.m1.2.2.1.1.1.3.cmml" xref="S2.E3Xa.2.1.1.m1.2.2.1.1.1.3">𝑖</ci></apply><cn id="S2.E3Xa.2.1.1.m1.1.1.cmml" type="integer" xref="S2.E3Xa.2.1.1.m1.1.1">0</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3Xa.2.1.1.m1.2c">\displaystyle\begin{pmatrix}\cos{(i_{\Delta})\theta_{0}}&amp;-\sin{(i_{\Delta})%
\theta}&amp;\cdots&amp;0&amp;0\\
\sin{(i_{\Delta})\theta_{0}}&amp;\cos{(i_{\Delta})\theta}&amp;\cdots&amp;0&amp;0\\
0&amp;0&amp;\cdots&amp;\cos{(i_{\Delta})\theta_{\frac{d}{2}-1}}&amp;-\sin{(i_{\Delta})\theta_{%
\frac{d}{2}-1}}\\
0&amp;0&amp;\cdots&amp;\sin{(i_{\Delta})\theta_{\frac{d}{2}-1}}&amp;\cos{(i_{\Delta})\theta_{%
\frac{d}{2}-1}}\end{pmatrix}f(x_{i},0)</annotation><annotation encoding="application/x-llamapun" id="S2.E3Xa.2.1.1.m1.2d">( start_ARG start_ROW start_CELL roman_cos ( italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ) italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_CELL start_CELL - roman_sin ( italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ) italic_θ end_CELL start_CELL ⋯ end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL roman_sin ( italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ) italic_θ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_CELL start_CELL roman_cos ( italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ) italic_θ end_CELL start_CELL ⋯ end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL ⋯ end_CELL start_CELL roman_cos ( italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ) italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL start_CELL - roman_sin ( italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ) italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL ⋯ end_CELL start_CELL roman_sin ( italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ) italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL start_CELL roman_cos ( italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT ) italic_θ start_POSTSUBSCRIPT divide start_ARG italic_d end_ARG start_ARG 2 end_ARG - 1 end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ) italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , 0 )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p6">
<p class="ltx_p" id="S2.SS3.p6.4">For the remaining tokens within block <math alttext="b" class="ltx_Math" display="inline" id="S2.SS3.p6.1.m1.1"><semantics id="S2.SS3.p6.1.m1.1a"><mi id="S2.SS3.p6.1.m1.1.1" xref="S2.SS3.p6.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.1.m1.1b"><ci id="S2.SS3.p6.1.m1.1.1.cmml" xref="S2.SS3.p6.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.1.m1.1d">italic_b</annotation></semantics></math>, namely <math alttext="s_{i+1},\ldots,s_{j}" class="ltx_Math" display="inline" id="S2.SS3.p6.2.m2.3"><semantics id="S2.SS3.p6.2.m2.3a"><mrow id="S2.SS3.p6.2.m2.3.3.2" xref="S2.SS3.p6.2.m2.3.3.3.cmml"><msub id="S2.SS3.p6.2.m2.2.2.1.1" xref="S2.SS3.p6.2.m2.2.2.1.1.cmml"><mi id="S2.SS3.p6.2.m2.2.2.1.1.2" xref="S2.SS3.p6.2.m2.2.2.1.1.2.cmml">s</mi><mrow id="S2.SS3.p6.2.m2.2.2.1.1.3" xref="S2.SS3.p6.2.m2.2.2.1.1.3.cmml"><mi id="S2.SS3.p6.2.m2.2.2.1.1.3.2" xref="S2.SS3.p6.2.m2.2.2.1.1.3.2.cmml">i</mi><mo id="S2.SS3.p6.2.m2.2.2.1.1.3.1" xref="S2.SS3.p6.2.m2.2.2.1.1.3.1.cmml">+</mo><mn id="S2.SS3.p6.2.m2.2.2.1.1.3.3" xref="S2.SS3.p6.2.m2.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS3.p6.2.m2.3.3.2.3" xref="S2.SS3.p6.2.m2.3.3.3.cmml">,</mo><mi id="S2.SS3.p6.2.m2.1.1" mathvariant="normal" xref="S2.SS3.p6.2.m2.1.1.cmml">…</mi><mo id="S2.SS3.p6.2.m2.3.3.2.4" xref="S2.SS3.p6.2.m2.3.3.3.cmml">,</mo><msub id="S2.SS3.p6.2.m2.3.3.2.2" xref="S2.SS3.p6.2.m2.3.3.2.2.cmml"><mi id="S2.SS3.p6.2.m2.3.3.2.2.2" xref="S2.SS3.p6.2.m2.3.3.2.2.2.cmml">s</mi><mi id="S2.SS3.p6.2.m2.3.3.2.2.3" xref="S2.SS3.p6.2.m2.3.3.2.2.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.2.m2.3b"><list id="S2.SS3.p6.2.m2.3.3.3.cmml" xref="S2.SS3.p6.2.m2.3.3.2"><apply id="S2.SS3.p6.2.m2.2.2.1.1.cmml" xref="S2.SS3.p6.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p6.2.m2.2.2.1.1.1.cmml" xref="S2.SS3.p6.2.m2.2.2.1.1">subscript</csymbol><ci id="S2.SS3.p6.2.m2.2.2.1.1.2.cmml" xref="S2.SS3.p6.2.m2.2.2.1.1.2">𝑠</ci><apply id="S2.SS3.p6.2.m2.2.2.1.1.3.cmml" xref="S2.SS3.p6.2.m2.2.2.1.1.3"><plus id="S2.SS3.p6.2.m2.2.2.1.1.3.1.cmml" xref="S2.SS3.p6.2.m2.2.2.1.1.3.1"></plus><ci id="S2.SS3.p6.2.m2.2.2.1.1.3.2.cmml" xref="S2.SS3.p6.2.m2.2.2.1.1.3.2">𝑖</ci><cn id="S2.SS3.p6.2.m2.2.2.1.1.3.3.cmml" type="integer" xref="S2.SS3.p6.2.m2.2.2.1.1.3.3">1</cn></apply></apply><ci id="S2.SS3.p6.2.m2.1.1.cmml" xref="S2.SS3.p6.2.m2.1.1">…</ci><apply id="S2.SS3.p6.2.m2.3.3.2.2.cmml" xref="S2.SS3.p6.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS3.p6.2.m2.3.3.2.2.1.cmml" xref="S2.SS3.p6.2.m2.3.3.2.2">subscript</csymbol><ci id="S2.SS3.p6.2.m2.3.3.2.2.2.cmml" xref="S2.SS3.p6.2.m2.3.3.2.2.2">𝑠</ci><ci id="S2.SS3.p6.2.m2.3.3.2.2.3.cmml" xref="S2.SS3.p6.2.m2.3.3.2.2.3">𝑗</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.2.m2.3c">s_{i+1},\ldots,s_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.2.m2.3d">italic_s start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, we can re-encode their positional information in a similar manner. Although the formulas presented above may seem complex, the principle is quite straightforward: <span class="ltx_text ltx_font_bold" id="S2.SS3.p6.4.1">first set the positional encoding to zero, and then rotate it to the updated position</span>. One might wonder why we do not simply rotate by <math alttext="(i_{\Delta}-i)\theta" class="ltx_Math" display="inline" id="S2.SS3.p6.3.m3.1"><semantics id="S2.SS3.p6.3.m3.1a"><mrow id="S2.SS3.p6.3.m3.1.1" xref="S2.SS3.p6.3.m3.1.1.cmml"><mrow id="S2.SS3.p6.3.m3.1.1.1.1" xref="S2.SS3.p6.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS3.p6.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS3.p6.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p6.3.m3.1.1.1.1.1" xref="S2.SS3.p6.3.m3.1.1.1.1.1.cmml"><msub id="S2.SS3.p6.3.m3.1.1.1.1.1.2" xref="S2.SS3.p6.3.m3.1.1.1.1.1.2.cmml"><mi id="S2.SS3.p6.3.m3.1.1.1.1.1.2.2" xref="S2.SS3.p6.3.m3.1.1.1.1.1.2.2.cmml">i</mi><mi id="S2.SS3.p6.3.m3.1.1.1.1.1.2.3" mathvariant="normal" xref="S2.SS3.p6.3.m3.1.1.1.1.1.2.3.cmml">Δ</mi></msub><mo id="S2.SS3.p6.3.m3.1.1.1.1.1.1" xref="S2.SS3.p6.3.m3.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS3.p6.3.m3.1.1.1.1.1.3" xref="S2.SS3.p6.3.m3.1.1.1.1.1.3.cmml">i</mi></mrow><mo id="S2.SS3.p6.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS3.p6.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS3.p6.3.m3.1.1.2" xref="S2.SS3.p6.3.m3.1.1.2.cmml">⁢</mo><mi id="S2.SS3.p6.3.m3.1.1.3" xref="S2.SS3.p6.3.m3.1.1.3.cmml">θ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.3.m3.1b"><apply id="S2.SS3.p6.3.m3.1.1.cmml" xref="S2.SS3.p6.3.m3.1.1"><times id="S2.SS3.p6.3.m3.1.1.2.cmml" xref="S2.SS3.p6.3.m3.1.1.2"></times><apply id="S2.SS3.p6.3.m3.1.1.1.1.1.cmml" xref="S2.SS3.p6.3.m3.1.1.1.1"><minus id="S2.SS3.p6.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS3.p6.3.m3.1.1.1.1.1.1"></minus><apply id="S2.SS3.p6.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS3.p6.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p6.3.m3.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p6.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS3.p6.3.m3.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p6.3.m3.1.1.1.1.1.2.2">𝑖</ci><ci id="S2.SS3.p6.3.m3.1.1.1.1.1.2.3.cmml" xref="S2.SS3.p6.3.m3.1.1.1.1.1.2.3">Δ</ci></apply><ci id="S2.SS3.p6.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS3.p6.3.m3.1.1.1.1.1.3">𝑖</ci></apply><ci id="S2.SS3.p6.3.m3.1.1.3.cmml" xref="S2.SS3.p6.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.3.m3.1c">(i_{\Delta}-i)\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.3.m3.1d">( italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT - italic_i ) italic_θ</annotation></semantics></math> degrees directly? The reason is to mitigate the potential for errors in updating positional encodings within practical applications: in the KV cache, the positional encoding of the initial token of each block is standardized to zero, and with only the updated positional index <math alttext="i_{\Delta}" class="ltx_Math" display="inline" id="S2.SS3.p6.4.m4.1"><semantics id="S2.SS3.p6.4.m4.1a"><msub id="S2.SS3.p6.4.m4.1.1" xref="S2.SS3.p6.4.m4.1.1.cmml"><mi id="S2.SS3.p6.4.m4.1.1.2" xref="S2.SS3.p6.4.m4.1.1.2.cmml">i</mi><mi id="S2.SS3.p6.4.m4.1.1.3" mathvariant="normal" xref="S2.SS3.p6.4.m4.1.1.3.cmml">Δ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p6.4.m4.1b"><apply id="S2.SS3.p6.4.m4.1.1.cmml" xref="S2.SS3.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p6.4.m4.1.1.1.cmml" xref="S2.SS3.p6.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.p6.4.m4.1.1.2.cmml" xref="S2.SS3.p6.4.m4.1.1.2">𝑖</ci><ci id="S2.SS3.p6.4.m4.1.1.3.cmml" xref="S2.SS3.p6.4.m4.1.1.3">Δ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p6.4.m4.1c">i_{\Delta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p6.4.m4.1d">italic_i start_POSTSUBSCRIPT roman_Δ end_POSTSUBSCRIPT</annotation></semantics></math>, we can readily determine their new positional encoding vectors as per Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.E3" title="In 2.3 Position Re-Encoding ‣ 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Block Fine-tune</h3>
<div class="ltx_para ltx_noindent" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">Due to the LLM’s reliance on full self-attention during the training phase, a direct switch to Block-Attention during inference might result in a significant discrepancy between the training and inference states. Our preliminary findings indicate that introducing Block-Attention without subsequent fine-tuning could precipitate a substantial decrease in performance, with the average accuracy dropping significantly from 67.9% to 48.0%. Adapting the LLM to Block-Attention through fine-tuning, which we refer to as ”<span class="ltx_text ltx_font_bold" id="S2.SS4.p1.1.1">block fine-tune</span>,” is quite straightforward. The only difference from the standard SFT process is the modification of the traditional lower-triangular attention mask matrix to the attention mask matrix depicted in the right part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">1</span></a>. With this masking matrix, tokens in all blocks except the last are restricted to attending only to information within their own block, thereby ensuring consistency between training and inference.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="338" id="S2.F2.g1" src="x2.png" width="498"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The Inference Pipeline of Block-Attention Model</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5 </span>Inference</h3>
<div class="ltx_para ltx_noindent" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.2">In inference, the Block-Attention model retrieves the KV states of blocks from the KV cache and concatenates them into the complete input KV states. The detailed process of the inference stage is depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.F2" title="Figure 2 ‣ 2.4 Block Fine-tune ‣ 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">2</span></a>. Initially, we query and extract the KV states of the first
<math alttext="k-1" class="ltx_Math" display="inline" id="S2.SS5.p1.1.m1.1"><semantics id="S2.SS5.p1.1.m1.1a"><mrow id="S2.SS5.p1.1.m1.1.1" xref="S2.SS5.p1.1.m1.1.1.cmml"><mi id="S2.SS5.p1.1.m1.1.1.2" xref="S2.SS5.p1.1.m1.1.1.2.cmml">k</mi><mo id="S2.SS5.p1.1.m1.1.1.1" xref="S2.SS5.p1.1.m1.1.1.1.cmml">−</mo><mn id="S2.SS5.p1.1.m1.1.1.3" xref="S2.SS5.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.1.m1.1b"><apply id="S2.SS5.p1.1.m1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1"><minus id="S2.SS5.p1.1.m1.1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1.1"></minus><ci id="S2.SS5.p1.1.m1.1.1.2.cmml" xref="S2.SS5.p1.1.m1.1.1.2">𝑘</ci><cn id="S2.SS5.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS5.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.1.m1.1c">k-1</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.1.m1.1d">italic_k - 1</annotation></semantics></math> blocks from the cache. Then, based on the position of each block within the input sequence, we calculate their positional encoding using Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.E3" title="In 2.3 Position Re-Encoding ‣ 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">3</span></a>. Finally, using the KV states of the first <math alttext="k-1" class="ltx_Math" display="inline" id="S2.SS5.p1.2.m2.1"><semantics id="S2.SS5.p1.2.m2.1a"><mrow id="S2.SS5.p1.2.m2.1.1" xref="S2.SS5.p1.2.m2.1.1.cmml"><mi id="S2.SS5.p1.2.m2.1.1.2" xref="S2.SS5.p1.2.m2.1.1.2.cmml">k</mi><mo id="S2.SS5.p1.2.m2.1.1.1" xref="S2.SS5.p1.2.m2.1.1.1.cmml">−</mo><mn id="S2.SS5.p1.2.m2.1.1.3" xref="S2.SS5.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.2.m2.1b"><apply id="S2.SS5.p1.2.m2.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1"><minus id="S2.SS5.p1.2.m2.1.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1.1"></minus><ci id="S2.SS5.p1.2.m2.1.1.2.cmml" xref="S2.SS5.p1.2.m2.1.1.2">𝑘</ci><cn id="S2.SS5.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS5.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.2.m2.1c">k-1</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.2.m2.1d">italic_k - 1</annotation></semantics></math> blocks, we compute the KV states of the last block as well as the model output. In the RAG scenarios, the last block is the user query.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">After the above analysis, there exists two concerns about the Block-Attention method: 1) Can the Block-Attention model achieve the same accuracy as self-attention in RAG scenarios? 2) How much can the Block-Attention mechanism improve the efficiency? The following experimental results will reveal the answers to these two questions. In Sections <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.SS5" title="3.5 Main Results ‣ 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">3.5</span></a>, we analyze the accuracy of Block-Attention models. Meanwhile, in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.SS6" title="3.6 Inference Efficiency of Block-Attention ‣ 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">3.6</span></a>, we demonstrate the efficiency of Block-Attention.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Datasets</h3>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Train Dataset</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.1">We construct the training datasets by randomly sampling 20,000 instances from these TriviaQA (TQA) <cite class="ltx_cite ltx_citemacro_citep">(Joshi et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib10" title="">2017</a>)</cite> and 2WikiMultiHopQA (2Wiki) <cite class="ltx_cite ltx_citemacro_citep">(Ho et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib7" title="">2020</a>)</cite> for fine-tuning models.
Each training sample consists of (1) a question, (2) 10 passages retrieved from these two datasets using the Contriver toolkit<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://github.com/facebookresearch/contriever</span></span></span>, which identifies the 10 most relevant passages,
and (3) an answer generated by GPT-4 based on the retrieved passages.
The reason to use the GPT-4 answer instead of the ground-truth answers is because the answer might not be present in our retrieved passages.
This discrepancy could lead the model to overlook the content of the retrieved passages and generate outputs directly.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Evaluation Dataset</h4>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.1">We evaluate the performance of our proposed Block-Attention mechanism and baseline models on four widely-used RAG benchmarks: Natural Questions (NQ) <cite class="ltx_cite ltx_citemacro_citep">(Kwiatkowski et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib12" title="">2019</a>)</cite>, TriviaQA (TQA) <cite class="ltx_cite ltx_citemacro_citep">(Joshi et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib10" title="">2017</a>)</cite>, HotpotQA (HQA) <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib25" title="">2018</a>)</cite>, and 2WikiMultiHopQA (2Wiki) <cite class="ltx_cite ltx_citemacro_citep">(Ho et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib7" title="">2020</a>)</cite>.
Since the training samples include instances from TQA and 2Wiki, their test sets are considered in-domain, whereas HQA and NQ are treated as out-of-domain test sets.
Following  <cite class="ltx_cite ltx_citemacro_citet">Kandpal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib11" title="">2023</a>)</cite> and  <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib19" title="">2024</a>)</cite>, we use accuracy as our primary evaluation
metric, judging whether any correct answers appear in the predicted output. To mitigate biases arising from output length, we set a maximum token limit of 200 for the output sequences.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="389" id="S3.F3.g1" src="x3.png" width="789"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The Inference Pipeline of Block-Attention Model. The retrieved documents at the top have the highest relevance to the user query.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Input Format</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The format of input prompt for all datasets follows  <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib19" title="">2024</a>)</cite>. For retrieved passages, we concatenate them in ascending order of retrieval score. An example is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.F3" title="Figure 3 ‣ Evaluation Dataset ‣ 3.1 Datasets ‣ 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Base Model &amp; Baselines </h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">We implement the Block-Attention mechanism on two base language models: Llama3-8B-base<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>https://huggingface.co/meta-llama/Meta-Llama-3-8B</span></span></span> and Mistral-7B-v3.0<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>https://huggingface.co/mistralai/Mistral-7B-v0.3</span></span></span>. After applying block fine-tuning, these models are denoted as <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.1">Llama3-block-ft</span> and <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.2">Mistral-block-ft</span>. For comparison, we implemented three baselines for each of these two base language models.</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">Strong baselines:</span> <span class="ltx_text ltx_font_italic" id="S3.I1.i1.p1.1.2">Llama3-vanilla-sft</span> and <span class="ltx_text ltx_font_italic" id="S3.I1.i1.p1.1.3">Mistral-vanilla-sft</span> are established by fine-tuning the base language models on our constructed training dataset. These models serve as the upper bound performance for the Block-Attention models. We aim for the Block-Attention model’s performance to approach these as closely as possible.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">Weak baselines:</span> <span class="ltx_text ltx_font_italic" id="S3.I1.i2.p1.1.2">Llama3-block-w/o-ft</span> and <span class="ltx_text ltx_font_italic" id="S3.I1.i2.p1.1.3">Mistral-block-w/o-ft</span>. These models transition the attention mechanism of <span class="ltx_text ltx_font_italic" id="S3.I1.i2.p1.1.4">Llama3-vanilla-sft</span> and <span class="ltx_text ltx_font_italic" id="S3.I1.i2.p1.1.5">Mistral-vanilla-sft</span> to a Block-Attention mechanism <span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.6">without any block fine-tuning</span>. The outcomes of these models represent the lower bounds for the Block-Attention model’s effectiveness, given that they have not undergone any adaptation to Block-Attention during the training phase.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.1.1">w/o-pos:</span> <span class="ltx_text ltx_font_italic" id="S3.I1.i3.p1.1.2">Llama3-block-ft-w/o-pos</span> and <span class="ltx_text ltx_font_italic" id="S3.I1.i3.p1.1.3">Mistral-block-ft-w/o-pos</span> are baselines that also fine-tuned to adapt the Block-Attention mechanism, while no additional position re-encoding operations described in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S2.SS3" title="2.3 Position Re-Encoding ‣ 2 Block-Attention ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">2.3</span></a> are conducted. This group of models will be used to evaluate the effectiveness of the proposed position re-encoding process.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">Please note that we have not utilized instruction-tuning models as our base language model, such as Llama3-instruct. The reason is our inability to entirely re-implement the fine-tuning processes of these models, which precludes a direct comparison between self-attention and Block-Attention methodologies under identical experimental conditions. Instead, we perform vanilla fine-tuning and block fine-tuning on the same base models using the same dataset, ensuring a fair comparison.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">Additionally, our idea has some similarities with PCW  <cite class="ltx_cite ltx_citemacro_citep">(Ratner et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib22" title="">2023b</a>)</cite> and Prompt Cache <cite class="ltx_cite ltx_citemacro_citep">(Gim et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib6" title="">2024</a>)</cite>. However, the focus of PCW is on extending the context window rather than efficient inference. When we directly applied their attention mechanism in the RAG scenario, their accuracy was even lower than the weak baselines, so we did not choose it as a baseline. We also re-implemented Prompt Cache. Then, we had an interesting finding: their results are exactly the same as the two weak baselines: <span class="ltx_text ltx_font_italic" id="S3.SS3.p3.1.1">Llama3-block-w/o-ft</span> and <span class="ltx_text ltx_font_italic" id="S3.SS3.p3.1.2">Mistral-block-w/o-ft</span>. Therefore, for the results of Prompt Cache, please directly refer to the result of these two models.<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>Please note that in addition to accuracy, Prompt Cache also has serious efficiency issues when applied in the RAG field: once the rank of a passage in the input sequence changes, its KV cache cannot be reused.</span></span></span></p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Setup</h3>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.3">All experiments are done with 8 NVIDIA A800 GPUs, we set the learning rate <math alttext="\alpha=2\times 10^{-5}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">α</mi><mo id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mn id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">2</mn><mo id="S3.SS4.p1.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">×</mo><msup id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml"><mn id="S3.SS4.p1.1.m1.1.1.3.3.2" xref="S3.SS4.p1.1.m1.1.1.3.3.2.cmml">10</mn><mrow id="S3.SS4.p1.1.m1.1.1.3.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.3.cmml"><mo id="S3.SS4.p1.1.m1.1.1.3.3.3a" xref="S3.SS4.p1.1.m1.1.1.3.3.3.cmml">−</mo><mn id="S3.SS4.p1.1.m1.1.1.3.3.3.2" xref="S3.SS4.p1.1.m1.1.1.3.3.3.2.cmml">5</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><eq id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1"></eq><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝛼</ci><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><times id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3.1"></times><cn id="S3.SS4.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S3.SS4.p1.1.m1.1.1.3.2">2</cn><apply id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3">superscript</csymbol><cn id="S3.SS4.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS4.p1.1.m1.1.1.3.3.2">10</cn><apply id="S3.SS4.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.3"><minus id="S3.SS4.p1.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3.3"></minus><cn id="S3.SS4.p1.1.m1.1.1.3.3.3.2.cmml" type="integer" xref="S3.SS4.p1.1.m1.1.1.3.3.3.2">5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\alpha=2\times 10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_α = 2 × 10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math>, batch size <math alttext="b=64" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><mrow id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">b</mi><mo id="S3.SS4.p1.2.m2.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><eq id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1"></eq><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑏</ci><cn id="S3.SS4.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.p1.2.m2.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">b=64</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">italic_b = 64</annotation></semantics></math> and the number of epochs <math alttext="n=1" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><mrow id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">n</mi><mo id="S3.SS4.p1.3.m3.1.1.1" xref="S3.SS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><eq id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1.1"></eq><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝑛</ci><cn id="S3.SS4.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS4.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">n=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">italic_n = 1</annotation></semantics></math> for all models.
We use a linear learning rate warmup for the first 20 steps. Its training is in bfloat16 format, using DeepSpeed ZeRO Stage-2<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/microsoft/DeepSpeed" title="">https://github.com/microsoft/DeepSpeed</a></span></span></span> and Flash-Attention V2 <cite class="ltx_cite ltx_citemacro_citep">(Dao et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib4" title="">2022</a>)</cite>.
The Flash-Attention toolkit is used for efficient inference for our models and baselines.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.1" style="width:397.5pt;height:179.8pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-7.4pt,3.3pt) scale(0.964182676986291,0.964182676986291) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1.1">Models</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.2.1">TQA</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.3.1">2wiki</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.4.1">NQ</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.5.1">HQA</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.6">
<table class="ltx_tabular ltx_align_middle" id="S3.T1.1.1.1.1.6.1">
<tr class="ltx_tr" id="S3.T1.1.1.1.1.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.1.1.1.1.6.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.6.1.1.1.1">In-Dom.</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.1.1.6.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.1.1.1.1.6.1.2.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.6.1.2.1.1">Avg.</span></td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.7">
<table class="ltx_tabular ltx_align_middle" id="S3.T1.1.1.1.1.7.1">
<tr class="ltx_tr" id="S3.T1.1.1.1.1.7.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.1.1.1.1.7.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.7.1.1.1.1">Out-Dom.</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.1.1.7.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.1.1.1.1.7.1.2.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.7.1.2.1.1">Avg.</span></td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1.8">
<table class="ltx_tabular ltx_align_middle" id="S3.T1.1.1.1.1.8.1">
<tr class="ltx_tr" id="S3.T1.1.1.1.1.8.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.1.1.1.1.8.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.8.1.1.1.1">Mix</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.1.1.8.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.1.1.1.1.8.1.2.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.8.1.2.1.1">Avg.</span></td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.1.2.1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.T1.1.1.2.1.1.1">Llama3-vanilla-sft</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.2">72.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.3.1">73.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.4">55.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.5"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.5.1">69.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.6"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.6.1">73.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.7"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.2.1.7.1">62.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.1.8">67.9</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.1.1.3.2.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.T1.1.1.3.2.1.1">Llama3-block-ft</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.2.2.1">73.0</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.2.3.1">73.3</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.2.4.1">56.2</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.5">68.5</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.6">73.6</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.7">63.2</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.3.2.8"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.3.2.8.1">68.4</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.1.1.4.3.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.T1.1.1.4.3.1.1">Llama3-block-ft-w/o-pos</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.2">70.8</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.3">66.8</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.4">52.9</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.5">61.4</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.6">69.3</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.7">58.5</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.3.8">63.9</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.1.1.5.4.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.T1.1.1.5.4.1.1">Llama3-block-w/o-ft</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.2">62.7</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.3">48.1</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.4">43.3</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.5">39.6</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.6">54.7</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.7">41.4</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.5.4.8">48.0</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.1.6.5.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.T1.1.1.6.5.1.1">Mistral-vanilla-sft</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.6.5.2">66.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.6.5.3">69.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.6.5.4">46.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.6.5.5">56.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.6.5.6">68.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.6.5.7">50.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.6.5.8">59.6</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.1.1.7.6.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.T1.1.1.7.6.1.1">Mistral-block-ft</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.6.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.2.1">69.9</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.6.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.3.1">70.5</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.6.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.4.1">50.8</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.6.5"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.5.1">57.9</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.6.6"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.6.1">70.2</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.6.7"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.7.1">54.4</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.7.6.8"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.7.6.8.1">62.3</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.1.1.8.7.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.T1.1.1.8.7.1.1">Mistral-block-ft-w/o-pos</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.8.7.2">67.8</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.8.7.3">67.4</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.8.7.4">47.5</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.8.7.5">52.4</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.8.7.6">67.3</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.8.7.7">50.4</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.8.7.8">58.8</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T1.1.1.9.8.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.T1.1.1.9.8.1.1">Mistral-block-w/o-ft</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.9.8.2">51.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.9.8.3">44.6</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.9.8.4">32.1</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.9.8.5">27.8</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.9.8.6">47.7</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.9.8.7">29.7</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.1.9.8.8">38.7</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy of different models on four benchmarks. Please note that the “average” column does not depict a simple arithmetic mean of the preceding columns, as the number of samples contained in each test set varies. </figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Main Results</h3>
<div class="ltx_para ltx_noindent" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">From the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.T1" title="Table 1 ‣ 3.4 Setup ‣ 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">1</span></a>, we can draw three important conclusions:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.1">1) It is not advisable to directly switch from self-attention to Block-Attention, as it will lead to a sharp accuracy drop.
For example, removing the Block fine-tune process leads to the 21.99% average absolute performance decrease on all four benchmarks for Llama3-8B and Mistral-7B models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.1">2) However, if we use the Block-Attention mechanism in the fine-tuning stage, then the resultant model has almost the same performance as the self-attention model or is even slightly better on some datasets. For instance, <span class="ltx_text ltx_font_italic" id="S3.SS5.p3.1.1">Mistral-block-ft</span> outperforms the strong baseline <span class="ltx_text ltx_font_italic" id="S3.SS5.p3.1.2">Mistral-vanilla-sft</span>, with 2.7% absolute improvements on four benchmarks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p4">
<p class="ltx_p" id="S3.SS5.p4.1">3) The position re-encoding operations are essential for the Block-Attention Model. Removing it leads to significant performance drop—average 4% decreases in accuracy on four datasets.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="436" id="S3.F4.g1" src="x4.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The accuracy of model checkpoint at different steps</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS5.p5">
<p class="ltx_p" id="S3.SS5.p5.1">The first conclusion is easy to understand: The model has never seen an input sequence in the Block-Attention manner during the training process. Therefore, the sharp drop makes sense. Next, we will focus on the second conclusion. From Table <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.T1" title="Table 1 ‣ 3.4 Setup ‣ 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">1</span></a>, we can easily find that the models trained with two attention methods, namely <span class="ltx_text ltx_font_italic" id="S3.SS5.p5.1.1">Llama3-vanilla-sft</span> and <span class="ltx_text ltx_font_italic" id="S3.SS5.p5.1.2">Llama3-block-ft</span>, not only have comparable effects on in-domain test sets but also have little difference on out-domain test sets. This indicates that in the RAG scenario, it is completely feasible to replace self-attention with Block-Attention, and there will be almost no performance loss.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p6">
<p class="ltx_p" id="S3.SS5.p6.1">Moreover, the experimental results on Mistral show some interesting results: the accuracy of Block-Attention models actually slightly outperformed the results of self-attention models on most datasets. It raised a conjecture: is Block-Attention a better attention mechanism than the self-attention mechanism? Intuitively, the semantics of each retrieved passage are mutually independent, and the self-attention method may cause the representation of the passage to be interfered by the context and not accurate enough. However, we still need sufficient experiments to verify the correctness of this assertion, so this is only a conjecture and not our conclusion.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p7">
<p class="ltx_p" id="S3.SS5.p7.1">Finally, one may still be interested in knowing exactly how many training steps are needed for the model to adapt to the Block-Attention mechanism. Therefore, we counted the accuracy of the Llama3-8B model on the four test sets at different fine-tuning steps and plotted it in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.F4" title="Figure 4 ‣ 3.5 Main Results ‣ 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">4</span></a>. It can be observed that at the beginning stage of fine-tuning, there is a huge performance difference between the two models. It makes sense because the model needs more training steps to adapt to the Block-Attention manner. After about 400 training steps, the model completely adapts to the new attention mechanism, and the two models show comparable accuracy.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>Inference Efficiency of Block-Attention</h3>
<div class="ltx_para ltx_noindent" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.1">In the previous section, we already addressed our first concern: After fine-tuning, the Block-Attention model can achieve similar or even better performance than the self-attention model. In this section, we focus on our second concern: How much can the Block-Attention mechanism reduce the TTFT and FLOPs-TFT?</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS6.p2">
<p class="ltx_p" id="S3.SS6.p2.1">To quantify the effects of the Block-Attention mechanism on the efficiency, we show in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#S3.T2" title="Table 2 ‣ 3.6 Inference Efficiency of Block-Attention ‣ 3 Experiments ‣ Block-Attention for Efficient RAG"><span class="ltx_text ltx_ref_tag">2</span></a> the respective TTFTs and FLOPs-TFT of the <span class="ltx_text ltx_font_italic" id="S3.SS6.p2.1.1">Llama3-block-ft</span> and <span class="ltx_text ltx_font_italic" id="S3.SS6.p2.1.2">Llama3-vanilla-sft</span> when the KV states of all retrieved passages have been pre-computed and cached in memory. Obviously, the acceleration effect is gratifying: Once the length of the input sequence is 512 and the length of user input is 50, using Block-Attention can reduce TTFT by 48% and reduce FLOPs-TFT by 90.1%. As the total length increases, the TTFT and FLOPs-TTF of the Block-Attention model maintain an essentially unchanged trend. When the length reaches 32K, the acceleration effect reaches an astonishing 98.7%, and the consumption of FLOPs-TFT is even reduced by 99.8%. We may simply conclude the results as: <span class="ltx_text ltx_font_italic" id="S3.SS6.p2.1.3">with greater text comes greater necessity for Block-Attention</span>.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T2.1.1.1.1" style="padding:1pt 4.3pt;">Prompt Length</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.2" style="padding:1pt 4.3pt;">50</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.3" style="padding:1pt 4.3pt;">512</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.4" style="padding:1pt 4.3pt;">1K</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.5" style="padding:1pt 4.3pt;">2K</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.6" style="padding:1pt 4.3pt;">4K</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.7" style="padding:1pt 4.3pt;">8K</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.8" style="padding:1pt 4.3pt;">16K</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.9" style="padding:1pt 4.3pt;">32K</th>
</tr>
<tr class="ltx_tr" id="S3.T2.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" id="S3.T2.1.2.2.1" style="padding:1pt 4.3pt;">TTFT-vanilla</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.2.2.2" style="padding:1pt 4.3pt;">26</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.2.2.3" style="padding:1pt 4.3pt;">50</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.2.2.4" style="padding:1pt 4.3pt;">87</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.2.2.5" style="padding:1pt 4.3pt;">167</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.2.2.6" style="padding:1pt 4.3pt;">330</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.2.2.7" style="padding:1pt 4.3pt;">691</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.2.2.8" style="padding:1pt 4.3pt;">1515</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.2.2.9" style="padding:1pt 4.3pt;">3638</th>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" id="S3.T2.1.3.3.1" style="padding:1pt 4.3pt;">TTFT-block</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.3.3.2" style="padding:1pt 4.3pt;">26</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.3.3.3" style="padding:1pt 4.3pt;">26(<span class="ltx_text" id="S3.T2.1.3.3.3.1" style="color:#0000FF;">48%</span>)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.3.3.4" style="padding:1pt 4.3pt;">26(<span class="ltx_text" id="S3.T2.1.3.3.4.1" style="color:#0000FF;">71%</span>)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.3.3.5" style="padding:1pt 4.3pt;">26(<span class="ltx_text" id="S3.T2.1.3.3.5.1" style="color:#0000FF;">84%</span>)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.3.3.6" style="padding:1pt 4.3pt;">27(<span class="ltx_text" id="S3.T2.1.3.3.6.1" style="color:#0000FF;">91%</span>)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.3.3.7" style="padding:1pt 4.3pt;">29(<span class="ltx_text" id="S3.T2.1.3.3.7.1" style="color:#0000FF;">95%</span>)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.3.3.8" style="padding:1pt 4.3pt;">34(<span class="ltx_text" id="S3.T2.1.3.3.8.1" style="color:#0000FF;">97%</span>)</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T2.1.3.3.9" style="padding:1pt 4.3pt;">45(<span class="ltx_text" id="S3.T2.1.3.3.9.1" style="color:#0000FF;">98.7%</span>)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.1.4.1.1" style="padding:1pt 4.3pt;">FLOPs-TFT-vanilla</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.4.1.2" style="padding:1pt 4.3pt;">7.5e+11</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.4.1.3" style="padding:1pt 4.3pt;">7.6e+12</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.4.1.4" style="padding:1pt 4.3pt;">1.5e+13</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.4.1.5" style="padding:1pt 4.3pt;">3.0e+13</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.4.1.6" style="padding:1pt 4.3pt;">6.1e+13</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.4.1.7" style="padding:1pt 4.3pt;">1.2e+14</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.4.1.8" style="padding:1pt 4.3pt;">2.45e+14</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.4.1.9" style="padding:1pt 4.3pt;">4.9e+14</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.1.5.2.1" style="padding:1pt 4.3pt;">FLOPs-TFT-block</th>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.2.2" style="padding:1pt 4.3pt;">7.5e+11</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.2.3" style="padding:1pt 4.3pt;">7.5e+11</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.2.4" style="padding:1pt 4.3pt;">7.5e+11</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.2.5" style="padding:1pt 4.3pt;">7.5e+11</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.2.6" style="padding:1pt 4.3pt;">7.5e+11</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.2.7" style="padding:1pt 4.3pt;">7.5e+11</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.2.8" style="padding:1pt 4.3pt;">7.5e+11</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.2.9" style="padding:1pt 4.3pt;">7.5e+11</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="S3.T2.1.6.3.1" style="padding:1pt 4.3pt;">Reduction</th>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T2.1.6.3.2" style="padding:1pt 4.3pt;">-</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T2.1.6.3.3" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S3.T2.1.6.3.3.1" style="color:#0000FF;">90.1%</span></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T2.1.6.3.4" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S3.T2.1.6.3.4.1" style="color:#0000FF;">95.0%</span></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T2.1.6.3.5" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S3.T2.1.6.3.5.1" style="color:#0000FF;">97.5%</span></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T2.1.6.3.6" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S3.T2.1.6.3.6.1" style="color:#0000FF;">98.7%</span></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T2.1.6.3.7" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S3.T2.1.6.3.7.1" style="color:#0000FF;">99.3%</span></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T2.1.6.3.8" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S3.T2.1.6.3.8.1" style="color:#0000FF;">99.6%</span></td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S3.T2.1.6.3.9" style="padding:1pt 4.3pt;"><span class="ltx_text" id="S3.T2.1.6.3.9.1" style="color:#0000FF;">99.8%</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>The Time and FLOPs consumed by the first token of a user input with a length of 50 tokens under different total length of the retrieved passages </figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.7 </span>Discussion</h3>
<div class="ltx_para ltx_noindent" id="S3.SS7.p1">
<p class="ltx_p" id="S3.SS7.p1.1">From the experimental results, we can figure out the effects of Block-Attention on existing RAG applications: Under the existing technical paradigm, developers need to deliberately balance the trade-off between accuracy and latency. Therefore, they have to limit the number of retrieved passages to a certain number, such as 3 to 10. With Block-Attention, the impact of the number of retrieved passages on inference speed will be greatly reduced, which will empower the developers to freely choose the number of retrieved passages that gives the optimal effect without any hesitation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS7.p2">
<p class="ltx_p" id="S3.SS7.p2.1">Furthermore, some dynamic RAG paradigms such as ReAct <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib26" title="">2023</a>)</cite> have been proven to enhance the general task-solving ability of the LLM. However, compared to vanilla RAG, such paradigms need to iteratively compute the KV states of retrieved passages for single user input, which results in a disastrous inference latency. With the help of Block-Attention, the additional latency consumption in this aspect can be reduced to a level that users can tolerate. Developers will be able to safely use such paradigms in online scenarios to optimize the reasoning ability of LLM.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Works</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Retrieval-Augmented Generation (RAG)</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">RAG is a widely used technique to improve generations of language models by using retrieved nearest-neighbor documents or passages as references, which typically involves two stages: retrieval and generation.
Before generation, retrieval finds most similar passages with the user query or the context, by using BM25 or dense retrieval model <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib15" title="">2021</a>; Lan et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib13" title="">2023</a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib14" title="">2024</a>)</cite>.
After collecting retrieved passages, there are numerous techniques to incorporate the knowledge during generation. Earlier works includes concatenation <cite class="ltx_cite ltx_citemacro_citep">(Izacard &amp; Grave, <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib8" title="">2021</a>)</cite> and cross-attention <cite class="ltx_cite ltx_citemacro_citep">(Borgeaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib2" title="">2022</a>)</cite>.
Some studies have also begun to attempt to directly use the retriever as text generator, that is, text generation is performed by selecting context-aware phrases from a collection of supporting documents.  <cite class="ltx_cite ltx_citemacro_citep">(Lan et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib13" title="">2023</a>; Cao et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib3" title="">2024</a>)</cite></p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">Recently, LLMs becomes the most powerful paradigm for most NLP tasks, and simply concatenating all retrieved documents into the context of LLMs becomes the most simple and effective way for retrieval-augmented generation (RAG).
For example, Self-RAG <cite class="ltx_cite ltx_citemacro_citep">(Asai et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib1" title="">2023</a>)</cite> leverage a critic model to decide which content in retrieved passages should be used during generation.
As a specific application of RAG, tool learning is widely used to call external APIs to retrieve related passages from external database or tools to solve knowledge-intensive tasks <cite class="ltx_cite ltx_citemacro_citep">(Schick et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib23" title="">2023</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Efficiency of RAG</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The efficieny of LLM inference gradually decreases as the sequence length of the concatenation of retrieved passages rapidly increases, leading to a huge challenges for retrieval augmented generation of LLMs.
To solve this problem, there are numerous novel architectures, model quantization and inference strategies are proposed.
For example, the linear attention and Mixture of Expert <cite class="ltx_cite ltx_citemacro_citep">(Fedus et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib5" title="">2022</a>)</cite> architecture are widely used architectures for reducing the complexity of LLM inference <cite class="ltx_cite ltx_citemacro_citep">(Shazeer, <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib24" title="">2019</a>; Zhang &amp; Cai, <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib27" title="">2022</a>; Fedus et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib5" title="">2022</a>)</cite>.
Speculative decoding leverages the parallel of language models to speed up the inference <cite class="ltx_cite ltx_citemacro_citep">(Leviathan et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib16" title="">2023</a>)</cite>.
However, most previous works are not designed for RAG scenarios.
Recently, RAG Cache<cite class="ltx_cite ltx_citemacro_citep">(Jin et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib9" title="">2024</a>)</cite> caches the intermediate states of retrieved knowledge in GPUs, showing 4x TTFT.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Another stream of researches focus on individually and parallely process each documents, which is related to our work, such as FiD <cite class="ltx_cite ltx_citemacro_citep">(Izacard &amp; Grave, <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib8" title="">2021</a>)</cite>, PCW <cite class="ltx_cite ltx_citemacro_citep">(Ratner et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib21" title="">2023a</a>)</cite> and Prompt Cache <cite class="ltx_cite ltx_citemacro_citep">(Gim et al., <a class="ltx_ref" href="https://arxiv.org/html/2409.15355v3#bib.bib6" title="">2024</a>)</cite>.
However, FiD is widely used for encode-decoder architecture, and not compatible for the decoder-only architecture of LLMs, since they need to concatenate the hidden states for decoder during inference.
PCW focuses on extending the context window rather than efficient inference.
Prompt Cache enables the efficient inference for RAG applications by designing the Prompt Markup Language (PML), while their pre-computed KV cache of retrieved passages are bound to the specific IDs, leading to its limited applications. In other words, once the rank of a passage in the input sequence changes, its KV cache cannot be reused.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We introduce Block-Attention to optimize the inference efficiency of LLM in RAG scenarios. Its essence lies in separately calculating the KV states of independent blocks in the input prompt. Block-Attention enables us to pre-compute the KV states for all passages and cache them in memory, thus avoiding repeated computation of the KV states of the same passage during inference.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">Our experimental results across various RAG benchmarks demonstrated the profound impact of Block-Attention. We showed that Block-Attention can maintain the original reasoning accuracy of LLM while significantly reducing its TTFT and FLOPs-TTF in RAG scenarios. The effectiveness of Block-Attention becomes increasingly apparent as the number of passages increases or the frequency of retrievals increases. When considering the implementation of Block-Attention in your applications, bear in mind this guiding principle: With greater text comes greater necessity for Block-Attention.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">We also want to note that Block-Attention plays an important role in many scenarios and is not limited to RAG only. We only introduced its effects on RAG because of that, due to some confidentiality reasons, we cannot disclose how we use it in our industrial applications. We look forward to researchers from the community being able to further explore the potential of Block-Attention and apply it to more appropriate scenarios.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Asai et al. (2023)</span>
<span class="ltx_bibblock">
Akari Asai, Zeqiu Wu, Yizhong Wang, Avirup Sil, and Hannaneh Hajishirzi.

</span>
<span class="ltx_bibblock">Self-rag: Learning to retrieve, generate, and critique through self-reflection, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2310.11511" title="">https://arxiv.org/abs/2310.11511</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borgeaud et al. (2022)</span>
<span class="ltx_bibblock">
Sebastian Borgeaud, Arthur Mensch, Jordan Hoffmann, Trevor Cai, Eliza Rutherford, Katie Millican, George van den Driessche, Jean-Baptiste Lespiau, Bogdan Damoc, Aidan Clark, Diego de Las Casas, Aurelia Guy, Jacob Menick, Roman Ring, Tom Hennigan, Saffron Huang, Loren Maggiore, Chris Jones, Albin Cassirer, Andy Brock, Michela Paganini, Geoffrey Irving, Oriol Vinyals, Simon Osindero, Karen Simonyan, Jack W. Rae, Erich Elsen, and Laurent Sifre.

</span>
<span class="ltx_bibblock">Improving language models by retrieving from trillions of tokens, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2112.04426" title="">https://arxiv.org/abs/2112.04426</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. (2024)</span>
<span class="ltx_bibblock">
Bowen Cao, Deng Cai, Leyang Cui, Xuxin Cheng, Wei Bi, Yuexian Zou, and Shuming Shi.

</span>
<span class="ltx_bibblock">Retrieval is accurate generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">The Twelfth International Conference on Learning Representations</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=oXYZJXDdo7" title="">https://openreview.net/forum?id=oXYZJXDdo7</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et al. (2022)</span>
<span class="ltx_bibblock">
Tri Dao, Daniel Y. Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Flashattention: Fast and memory-efficient exact attention with io-awareness, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2205.14135" title="">https://arxiv.org/abs/2205.14135</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fedus et al. (2022)</span>
<span class="ltx_bibblock">
William Fedus, Barret Zoph, and Noam Shazeer.

</span>
<span class="ltx_bibblock">Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2101.03961" title="">https://arxiv.org/abs/2101.03961</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gim et al. (2024)</span>
<span class="ltx_bibblock">
In Gim, Guojun Chen, Seung seob Lee, Nikhil Sarda, Anurag Khandelwal, and Lin Zhong.

</span>
<span class="ltx_bibblock">Prompt cache: Modular attention reuse for low-latency inference, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2311.04934" title="">https://arxiv.org/abs/2311.04934</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al. (2020)</span>
<span class="ltx_bibblock">
Xanh Ho, Anh-Khoa Duong Nguyen, Saku Sugawara, and Akiko Aizawa.

</span>
<span class="ltx_bibblock">Constructing a multi-hop QA dataset for comprehensive evaluation of reasoning steps.

</span>
<span class="ltx_bibblock">In Donia Scott, Nuria Bel, and Chengqing Zong (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 28th International Conference on Computational Linguistics</em>, pp.  6609–6625, Barcelona, Spain (Online), December 2020. International Committee on Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2020.coling-main.580</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2020.coling-main.580" title="">https://aclanthology.org/2020.coling-main.580</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard &amp; Grave (2021)</span>
<span class="ltx_bibblock">
Gautier Izacard and Edouard Grave.

</span>
<span class="ltx_bibblock">Leveraging passage retrieval with generative models for open domain question answering.

</span>
<span class="ltx_bibblock">In Paola Merlo, Jorg Tiedemann, and Reut Tsarfaty (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 16th Conference of the European Chapter of the Association for Computational Linguistics: Main Volume</em>, pp.  874–880, Online, April 2021. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2021.eacl-main.74</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2021.eacl-main.74" title="">https://aclanthology.org/2021.eacl-main.74</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al. (2024)</span>
<span class="ltx_bibblock">
Chao Jin, Zili Zhang, Xuanlin Jiang, Fangyue Liu, Xin Liu, Xuanzhe Liu, and Xin Jin.

</span>
<span class="ltx_bibblock">Ragcache: Efficient knowledge caching for retrieval-augmented generation, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2404.12457" title="">https://arxiv.org/abs/2404.12457</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joshi et al. (2017)</span>
<span class="ltx_bibblock">
Mandar Joshi, Eunsol Choi, Daniel Weld, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">TriviaQA: A large scale distantly supervised challenge dataset for reading comprehension.

</span>
<span class="ltx_bibblock">In Regina Barzilay and Min-Yen Kan (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pp.  1601–1611, Vancouver, Canada, July 2017. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/P17-1147</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/P17-1147" title="">https://aclanthology.org/P17-1147</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kandpal et al. (2023)</span>
<span class="ltx_bibblock">
Nikhil Kandpal, Haikang Deng, Adam Roberts, Eric Wallace, and Colin Raffel.

</span>
<span class="ltx_bibblock">Large language models struggle to learn long-tail knowledge, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2211.08411" title="">https://arxiv.org/abs/2211.08411</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski et al. (2019)</span>
<span class="ltx_bibblock">
Tom Kwiatkowski, Jennimaria Palomaki, Olivia Redfield, Michael Collins, Ankur Parikh, Chris Alberti, Danielle Epstein, Illia Polosukhin, Jacob Devlin, Kenton Lee, Kristina Toutanova, Llion Jones, Matthew Kelcey, Ming-Wei Chang, Andrew M. Dai, Jakob Uszkoreit, Quoc Le, and Slav Petrov.

</span>
<span class="ltx_bibblock">Natural questions: A benchmark for question answering research.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Transactions of the Association for Computational Linguistics</em>, 7:452–466, 2019.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1162/tacl˙a˙00276</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/Q19-1026" title="">https://aclanthology.org/Q19-1026</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lan et al. (2023)</span>
<span class="ltx_bibblock">
Tian Lan, Deng Cai, Yan Wang, Heyan Huang, and Xian-Ling Mao.

</span>
<span class="ltx_bibblock">Copy is all you need, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2307.06962" title="">https://arxiv.org/abs/2307.06962</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lan et al. (2024)</span>
<span class="ltx_bibblock">
Tian Lan, Deng Cai, Yan Wang, Yixuan Su, Heyan Huang, and Xian-Ling Mao.

</span>
<span class="ltx_bibblock">Exploring dense retrieval for dialogue response selection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">ACM Trans. Inf. Syst.</em>, 42(3), jan 2024.

</span>
<span class="ltx_bibblock">ISSN 1046-8188.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/3632750</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3632750" title="">https://doi.org/10.1145/3632750</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2021)</span>
<span class="ltx_bibblock">
Jinhyuk Lee, Mujeen Sung, Jaewoo Kang, and Danqi Chen.

</span>
<span class="ltx_bibblock">Learning dense representations of phrases at scale, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2012.12624" title="">https://arxiv.org/abs/2012.12624</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leviathan et al. (2023)</span>
<span class="ltx_bibblock">
Yaniv Leviathan, Matan Kalman, and Yossi Matias.

</span>
<span class="ltx_bibblock">Fast inference from transformers via speculative decoding, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2211.17192" title="">https://arxiv.org/abs/2211.17192</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Huayang Li, Yixuan Su, Deng Cai, Yan Wang, and Lemao Liu.

</span>
<span class="ltx_bibblock">A survey on retrieval-augmented text generation, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2202.01110" title="">https://arxiv.org/abs/2202.01110</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Yucheng Li, Bo Dong, Frank Guerin, and Chenghua Lin.

</span>
<span class="ltx_bibblock">Compressing context to enhance inference efficiency of large language models.

</span>
<span class="ltx_bibblock">In Houda Bouamor, Juan Pino, and Kalika Bali (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pp.  6342–6353, Singapore, December 2023. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2023.emnlp-main.391</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.emnlp-main.391" title="">https://aclanthology.org/2023.emnlp-main.391</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024)</span>
<span class="ltx_bibblock">
Nelson F. Liu, Kevin Lin, John Hewitt, Ashwin Paranjape, Michele Bevilacqua, Fabio Petroni, and Percy Liang.

</span>
<span class="ltx_bibblock">Lost in the middle: How language models use long contexts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Transactions of the Association for Computational Linguistics</em>, 12:157–173, 2024.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1162/tacl˙a˙00638</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2024.tacl-1.9" title="">https://aclanthology.org/2024.tacl-1.9</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al. (2024)</span>
<span class="ltx_bibblock">
Ruoyu Qin, Zheming Li, Weiran He, Mingxing Zhang, Yongwei Wu, Weimin Zheng, and Xinran Xu.

</span>
<span class="ltx_bibblock">Mooncake: A kvcache-centric disaggregated architecture for llm serving, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2407.00079" title="">https://arxiv.org/abs/2407.00079</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ratner et al. (2023a)</span>
<span class="ltx_bibblock">
Nir Ratner, Yoav Levine, Yonatan Belinkov, Ori Ram, Inbal Magar, Omri Abend, Ehud Karpas, Amnon Shashua, Kevin Leyton-Brown, and Yoav Shoham.

</span>
<span class="ltx_bibblock">Parallel context windows for large language models.

</span>
<span class="ltx_bibblock">In Anna Rogers, Jordan Boyd-Graber, and Naoaki Okazaki (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pp.  6383–6402, Toronto, Canada, July 2023a. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2023.acl-long.352</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.acl-long.352" title="">https://aclanthology.org/2023.acl-long.352</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ratner et al. (2023b)</span>
<span class="ltx_bibblock">
Nir Ratner, Yoav Levine, Yonatan Belinkov, Ori Ram, Inbal Magar, Omri Abend, Ehud Karpas, Amnon Shashua, Kevin Leyton-Brown, and Yoav Shoham.

</span>
<span class="ltx_bibblock">Parallel context windows for large language models, 2023b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2212.10947" title="">https://arxiv.org/abs/2212.10947</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schick et al. (2023)</span>
<span class="ltx_bibblock">
Timo Schick, Jane Dwivedi-Yu, Roberto Dessi, Roberta Raileanu, Maria Lomeli, Eric Hambro, Luke Zettlemoyer, Nicola Cancedda, and Thomas Scialom.

</span>
<span class="ltx_bibblock">Toolformer: Language models can teach themselves to use tools.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Thirty-seventh Conference on Neural Information Processing Systems</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=Yacmpz84TH" title="">https://openreview.net/forum?id=Yacmpz84TH</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer (2019)</span>
<span class="ltx_bibblock">
Noam Shazeer.

</span>
<span class="ltx_bibblock">Fast transformer decoding: One write-head is all you need, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1911.02150" title="">https://arxiv.org/abs/1911.02150</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2018)</span>
<span class="ltx_bibblock">
Zhilin Yang, Peng Qi, Saizheng Zhang, Yoshua Bengio, William W. Cohen, Ruslan Salakhutdinov, and Christopher D. Manning.

</span>
<span class="ltx_bibblock">Hotpotqa: A dataset for diverse, explainable multi-hop question answering, 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1809.09600" title="">https://arxiv.org/abs/1809.09600</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2023)</span>
<span class="ltx_bibblock">
Shunyu Yao, Jeffrey Zhao, Dian Yu, Nan Du, Izhak Shafran, Karthik Narasimhan, and Yuan Cao.

</span>
<span class="ltx_bibblock">React: Synergizing reasoning and acting in language models, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2210.03629" title="">https://arxiv.org/abs/2210.03629</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang &amp; Cai (2022)</span>
<span class="ltx_bibblock">
Yizhe Zhang and Deng Cai.

</span>
<span class="ltx_bibblock">Linearizing transformer with key-value memory.

</span>
<span class="ltx_bibblock">In Yoav Goldberg, Zornitsa Kozareva, and Yue Zhang (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pp.  346–359, Abu Dhabi, United Arab Emirates, December 2022. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2022.emnlp-main.24</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2022.emnlp-main.24" title="">https://aclanthology.org/2022.emnlp-main.24</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2024)</span>
<span class="ltx_bibblock">
Yun Zhu, Jia-Chen Gu, Caitlin Sikora, Ho Ko, Yinxiao Liu, Chu-Cheng Lin, Lei Shu, Liangchen Luo, Lei Meng, Bang Liu, and Jindong Chen.

</span>
<span class="ltx_bibblock">Accelerating inference of retrieval-augmented generation via sparse context selection, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2405.16178" title="">https://arxiv.org/abs/2405.16178</a>.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Oct  1 03:35:32 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
