<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2312.15191] Personalized Federated Learning with Contextual Modulation and Meta-Learning</title><meta property="og:description" content="Federated learning has emerged as a promising approach for training machine learning models on decentralized data sources while preserving data privacy. However, challenges such as communication bottlenecks, heterogene…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Personalized Federated Learning with Contextual Modulation and Meta-Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Personalized Federated Learning with Contextual Modulation and Meta-Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2312.15191">

<!--Generated on Tue Feb 27 11:47:47 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document" style="font-size:144%;">Personalized Federated Learning with Contextual Modulation and Meta-Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Anna Vettoruzzo
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text" style="font-size:90%;">anna.vettoruzzo@hh.se
</span>
</span><span class="ltx_author_notes">Center for Applied Intelligent Systems Research (CAISR), Halmstad University, Halmstad, Sweden.</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mohamed-Rafik Bouguelia<span id="footnotex1" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span> 
<br class="ltx_break"><span id="id2.1.id1" class="ltx_text" style="font-size:90%;">mohamed-rafik.bouguelia@hh.se
</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Thorsteinn Rögnvaldsson<span id="footnotex2" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">1</span></span></span></span> 
<br class="ltx_break"><span id="id3.1.id1" class="ltx_text" style="font-size:90%;">thorsteinn.rognvaldsson@hh.se </span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p"><span id="id4.id1.1" class="ltx_text" style="font-size:90%;">Federated learning has emerged as a promising approach for training machine learning models on decentralized data sources while preserving data privacy. However, challenges such as communication bottlenecks, heterogeneity of client devices, and non-i.i.d. data distribution pose significant obstacles to achieving optimal model performance. We propose a novel framework that combines federated learning with meta-learning techniques to enhance both efficiency and generalization capabilities. Our approach introduces a federated modulator that learns contextual information from data batches and uses this knowledge to generate modulation parameters. These parameters dynamically adjust the activations of a base model, which operates using a MAML-based approach for model personalization. Experimental results across diverse datasets highlight the improvements in convergence speed and model performance compared to existing federated learning approaches. These findings highlight the potential of incorporating contextual information and meta-learning techniques into federated learning, paving the way for advancements in distributed machine learning paradigms.</span></p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold">Keywords</span>: Personalized federated learning, Meta-learning, Federated learning, Context learning</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Machine learning and deep learning have revolutionized various domains by enabling models to learn from vast amounts of centralized data. However, the traditional approach of collecting data into a central server raises concerns regarding data privacy and security. To address these issues, federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx27" title="" class="ltx_ref">27</a>]</cite> has emerged as a promising framework that enables collaborative model training while keeping the data decentralized on individual devices. This decentralized approach has gained significant attention in domains such as healthcare, Internet of Things (IoT), and mobile applications, where data cannot be easily transferred to a central server due to privacy regulations, connectivity limitations, or security risks.
However, in the context of FL, data distributions across clients are often not “<em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">independent and identically distributed</em>” (non-i.i.d.) since different devices generate and collect data separately. This poses a challenge for FL methods, such as FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx27" title="" class="ltx_ref">27</a>]</cite>, that were primarily designed to handle i.i.d. data.
Personalized federated learning (PFL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx9" title="" class="ltx_ref">9</a>]</cite> takes a step further by customizing models to the needs and preferences of individual clients, an important aspect in domains such as recommendation systems and user behavior analysis.
One way to accomplish this is by integrating meta-learning techniques into the FL framework. For example, Per-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx9" title="" class="ltx_ref">9</a>]</cite> finds an initialization of a global model that performs well after each client’s update with respect to its own data and loss function, potentially by performing a few steps of gradient descent. This approach accounts for the heterogeneity of data distributions while benefiting from collaborative training.
However, when there are substantial differences between client distributions, relying on a single global model may be insufficient. Some approaches have attempted to tackle this issue by learning multiple global models that simultaneously fit different data distributions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx8" title="" class="ltx_ref">8</a>, <a href="#bib.bibx11" title="" class="ltx_ref">11</a>, <a href="#bib.bibx26" title="" class="ltx_ref">26</a>, <a href="#bib.bibx33" title="" class="ltx_ref">33</a>, <a href="#bib.bibx43" title="" class="ltx_ref">43</a>]</cite>, but this can impose a high computational cost at the server level, as storing multiple models typically requires significant memory resources. Moreover, selecting the most suitable model for each client based on the limited locally available data can be challenging.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In this paper, we propose <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">CAFeMe</em>, a <span id="S1.p2.1.2" class="ltx_text ltx_font_bold">c</span>ontext-<span id="S1.p2.1.3" class="ltx_text ltx_font_bold">a</span>ware <span id="S1.p2.1.4" class="ltx_text ltx_font_bold">fe</span>derated learning solution that leverages <span id="S1.p2.1.5" class="ltx_text ltx_font_bold">me</span>ta-learning to facilitate personalization to each client.
Our approach is based on a global model comprising a federated modulator and a base model. The federated modulator network captures contextual information from the data of each client and generates modulation parameters that dynamically adjust the activations of the base model.
In each communication round, the global model is distributed to the clients,
which personalize it with their locally available data. The modulation parameters generated by the federated modulator serve as additional parameters within the base network, allowing for the personalization of the model to the unique characteristics of each client’s data distribution. This allows our proposed approach to deal with high heterogeneity in the clients’ data while maintaining a single model at the server level.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">We demonstrate the effectiveness of <em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">CAFeMe</em> in improving model convergence, generalization, and personalized prediction on various datasets within the PFL framework. The results highlight the potential of leveraging only relevant information for personalization to each client. This also results in a fast learning process that is particularly advantageous in time-sensitive applications. Furthermore, we showcase the robustness of our framework under the concept shift scenario, where the same class-label may be related to different concepts across clients. The code is available online at <a target="_blank" href="https://github.com/annaVettoruzzo/CAFeMe" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/annaVettoruzzo/CAFeMe</a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related works</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">The pioneering federated learning (FL) algorithm, FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx27" title="" class="ltx_ref">27</a>]</cite>, performs well in scenarios where the local data across clients is i.i.d. However, in scenarios with heterogeneous (non-i.i.d.) data distributions, several techniques have been proposed to improve local learning. These include regularization methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx1" title="" class="ltx_ref">1</a>, <a href="#bib.bibx21" title="" class="ltx_ref">21</a>, <a href="#bib.bibx24" title="" class="ltx_ref">24</a>]</cite>, local bias correction techniques <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx6" title="" class="ltx_ref">6</a>, <a href="#bib.bibx17" title="" class="ltx_ref">17</a>, <a href="#bib.bibx28" title="" class="ltx_ref">28</a>]</cite>, data sharing mechanisms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx47" title="" class="ltx_ref">47</a>]</cite>, data augmentation methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx44" title="" class="ltx_ref">44</a>]</cite>, and selective clients aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx36" title="" class="ltx_ref">36</a>, <a href="#bib.bibx41" title="" class="ltx_ref">41</a>]</cite>.
These methods primarily focus on improving the performance of the global model without considering better customization for each client.
An alternative approach is personalized federated learning (PFL), which aims to develop customized models for individual clients while leveraging the collaborative nature of FL.
Popular PFL methods include L2GD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx13" title="" class="ltx_ref">13</a>]</cite>, which combines local and global models, FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx5" title="" class="ltx_ref">5</a>]</cite> that decouples the parameters of the feature extractor and the classifier to learn unique local heads for each client, methods that investigate client-specific model aggregations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx15" title="" class="ltx_ref">15</a>, <a href="#bib.bibx46" title="" class="ltx_ref">46</a>]</cite>, as well as multi-task learning methods such as pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx35" title="" class="ltx_ref">35</a>]</cite>, Ditto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx22" title="" class="ltx_ref">22</a>]</cite>, and FedPAC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx42" title="" class="ltx_ref">42</a>]</cite>. Recently, some frameworks propose to incorporate meta-learning into the PFL framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx38" title="" class="ltx_ref">38</a>]</cite>. One notable approach is Per-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx9" title="" class="ltx_ref">9</a>]</cite>, which proposes a decentralized version of model-agnostic meta-learning (MAML) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx10" title="" class="ltx_ref">10</a>]</cite> for the FL setting. MAML is a meta-learning algorithm that learns models that can efficiently be adapted, through an optimization procedure, to new tasks. In the context of PFL, <em id="S2.p1.1.1" class="ltx_emph ltx_font_italic">personalization to a client</em> aligns with <em id="S2.p1.1.2" class="ltx_emph ltx_font_italic">adaptation to a task</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx16" title="" class="ltx_ref">16</a>]</cite>.
Other papers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx3" title="" class="ltx_ref">3</a>, <a href="#bib.bibx16" title="" class="ltx_ref">16</a>, <a href="#bib.bibx23" title="" class="ltx_ref">23</a>]</cite> explore the combination of MAML-type methods with FL architectures to improve personalization for each client’s local dataset. Additionally, the authors of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx18" title="" class="ltx_ref">18</a>]</cite> propose ARUBA, a meta-learning algorithm inspired by online convex optimization, which enhances the performance of FedAvg.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.3" class="ltx_p">While the effectiveness of these approaches in PFL has been demonstrated, concerns remain regarding their ability to handle highly heterogeneous data distributions among clients.
A special type of PFL approach that tries to address this concern is clustered or group-based FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx8" title="" class="ltx_ref">8</a>, <a href="#bib.bibx11" title="" class="ltx_ref">11</a>, <a href="#bib.bibx26" title="" class="ltx_ref">26</a>, <a href="#bib.bibx33" title="" class="ltx_ref">33</a>, <a href="#bib.bibx43" title="" class="ltx_ref">43</a>]</cite>, where multiple (i.e., <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">K</annotation></semantics></math>) group-based global models are learned after partitioning clients into <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">K</annotation></semantics></math> groups. These methods can either perform clustering at the server level, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx33" title="" class="ltx_ref">33</a>, <a href="#bib.bibx12" title="" class="ltx_ref">12</a>, <a href="#bib.bibx43" title="" class="ltx_ref">43</a>]</cite>, or let the clients compute the cluster identity based on their local empirical loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx11" title="" class="ltx_ref">11</a>]</cite>. However, partitioning clients into groups presents challenges due to the ambiguity in the clustering structure, and the memory costs of storing <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">K</annotation></semantics></math> models at the server level.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Our contribution consists of improving the performance and scalability of the PFL framework, even in scenarios where clients exhibit substantial differences in the data distribution. Our proposed method incorporates context information extracted from each client’s local data to drive the personalized model towards a better fit of the client-specific data distribution, while ensuring that the personalized base model does not deviate too far from the global version at the server level. This approach ensures a balance between local adaptation and global consistency, facilitating effective model personalization for each client.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Background and Notation</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.18" class="ltx_p">This section provides a formal description of the PFL problem and its connection with the MAML algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx10" title="" class="ltx_ref">10</a>]</cite>, specifically designed for meta-learning problems.
In PFL, we consider a distributed learning setting where a central server communicates with <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">C</annotation></semantics></math> clients.
Let <math id="S3.p1.2.m2.3" class="ltx_Math" alttext="\mathbb{C}=\{1,\cdots,C\}" display="inline"><semantics id="S3.p1.2.m2.3a"><mrow id="S3.p1.2.m2.3.4" xref="S3.p1.2.m2.3.4.cmml"><mi id="S3.p1.2.m2.3.4.2" xref="S3.p1.2.m2.3.4.2.cmml">ℂ</mi><mo id="S3.p1.2.m2.3.4.1" xref="S3.p1.2.m2.3.4.1.cmml">=</mo><mrow id="S3.p1.2.m2.3.4.3.2" xref="S3.p1.2.m2.3.4.3.1.cmml"><mo stretchy="false" id="S3.p1.2.m2.3.4.3.2.1" xref="S3.p1.2.m2.3.4.3.1.cmml">{</mo><mn id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">1</mn><mo id="S3.p1.2.m2.3.4.3.2.2" xref="S3.p1.2.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.p1.2.m2.2.2" xref="S3.p1.2.m2.2.2.cmml">⋯</mi><mo id="S3.p1.2.m2.3.4.3.2.3" xref="S3.p1.2.m2.3.4.3.1.cmml">,</mo><mi id="S3.p1.2.m2.3.3" xref="S3.p1.2.m2.3.3.cmml">C</mi><mo stretchy="false" id="S3.p1.2.m2.3.4.3.2.4" xref="S3.p1.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.3b"><apply id="S3.p1.2.m2.3.4.cmml" xref="S3.p1.2.m2.3.4"><eq id="S3.p1.2.m2.3.4.1.cmml" xref="S3.p1.2.m2.3.4.1"></eq><ci id="S3.p1.2.m2.3.4.2.cmml" xref="S3.p1.2.m2.3.4.2">ℂ</ci><set id="S3.p1.2.m2.3.4.3.1.cmml" xref="S3.p1.2.m2.3.4.3.2"><cn type="integer" id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">1</cn><ci id="S3.p1.2.m2.2.2.cmml" xref="S3.p1.2.m2.2.2">⋯</ci><ci id="S3.p1.2.m2.3.3.cmml" xref="S3.p1.2.m2.3.3">𝐶</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.3c">\mathbb{C}=\{1,\cdots,C\}</annotation></semantics></math> denote the set of clients participating in the training process. Each client <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">i</annotation></semantics></math> has its own data distribution <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="P_{\mathcal{X}\mathcal{Y}}^{(i)}" display="inline"><semantics id="S3.p1.4.m4.1a"><msubsup id="S3.p1.4.m4.1.2" xref="S3.p1.4.m4.1.2.cmml"><mi id="S3.p1.4.m4.1.2.2.2" xref="S3.p1.4.m4.1.2.2.2.cmml">P</mi><mrow id="S3.p1.4.m4.1.2.2.3" xref="S3.p1.4.m4.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.4.m4.1.2.2.3.2" xref="S3.p1.4.m4.1.2.2.3.2.cmml">𝒳</mi><mo lspace="0em" rspace="0em" id="S3.p1.4.m4.1.2.2.3.1" xref="S3.p1.4.m4.1.2.2.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.4.m4.1.2.2.3.3" xref="S3.p1.4.m4.1.2.2.3.3.cmml">𝒴</mi></mrow><mrow id="S3.p1.4.m4.1.1.1.3" xref="S3.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S3.p1.4.m4.1.1.1.3.1" xref="S3.p1.4.m4.1.2.cmml">(</mo><mi id="S3.p1.4.m4.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.4.m4.1.1.1.3.2" xref="S3.p1.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.2.cmml" xref="S3.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.2.1.cmml" xref="S3.p1.4.m4.1.2">superscript</csymbol><apply id="S3.p1.4.m4.1.2.2.cmml" xref="S3.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.2.2.1.cmml" xref="S3.p1.4.m4.1.2">subscript</csymbol><ci id="S3.p1.4.m4.1.2.2.2.cmml" xref="S3.p1.4.m4.1.2.2.2">𝑃</ci><apply id="S3.p1.4.m4.1.2.2.3.cmml" xref="S3.p1.4.m4.1.2.2.3"><times id="S3.p1.4.m4.1.2.2.3.1.cmml" xref="S3.p1.4.m4.1.2.2.3.1"></times><ci id="S3.p1.4.m4.1.2.2.3.2.cmml" xref="S3.p1.4.m4.1.2.2.3.2">𝒳</ci><ci id="S3.p1.4.m4.1.2.2.3.3.cmml" xref="S3.p1.4.m4.1.2.2.3.3">𝒴</ci></apply></apply><ci id="S3.p1.4.m4.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">P_{\mathcal{X}\mathcal{Y}}^{(i)}</annotation></semantics></math> on <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{X}\times\mathcal{Y}" display="inline"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">𝒳</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><times id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"></times><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝒳</ci><ci id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\mathcal{X}\times\mathcal{Y}</annotation></semantics></math>, where <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S3.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\mathcal{X}</annotation></semantics></math> represents the input space and <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{Y}" display="inline"><semantics id="S3.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\mathcal{Y}</annotation></semantics></math> denotes the label space. Each client <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.8.m8.1a"><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">i</annotation></semantics></math> has access to <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S3.p1.9.m9.1a"><msub id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml"><mi id="S3.p1.9.m9.1.1.2" xref="S3.p1.9.m9.1.1.2.cmml">n</mi><mi id="S3.p1.9.m9.1.1.3" xref="S3.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.cmml" xref="S3.p1.9.m9.1.1">subscript</csymbol><ci id="S3.p1.9.m9.1.1.2.cmml" xref="S3.p1.9.m9.1.1.2">𝑛</ci><ci id="S3.p1.9.m9.1.1.3.cmml" xref="S3.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">n_{i}</annotation></semantics></math> data points, represented as <math id="S3.p1.10.m10.2" class="ltx_Math" alttext="\mathcal{D}_{i}=\{x_{k},y_{k}\}" display="inline"><semantics id="S3.p1.10.m10.2a"><mrow id="S3.p1.10.m10.2.2" xref="S3.p1.10.m10.2.2.cmml"><msub id="S3.p1.10.m10.2.2.4" xref="S3.p1.10.m10.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.10.m10.2.2.4.2" xref="S3.p1.10.m10.2.2.4.2.cmml">𝒟</mi><mi id="S3.p1.10.m10.2.2.4.3" xref="S3.p1.10.m10.2.2.4.3.cmml">i</mi></msub><mo id="S3.p1.10.m10.2.2.3" xref="S3.p1.10.m10.2.2.3.cmml">=</mo><mrow id="S3.p1.10.m10.2.2.2.2" xref="S3.p1.10.m10.2.2.2.3.cmml"><mo stretchy="false" id="S3.p1.10.m10.2.2.2.2.3" xref="S3.p1.10.m10.2.2.2.3.cmml">{</mo><msub id="S3.p1.10.m10.1.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.1.cmml"><mi id="S3.p1.10.m10.1.1.1.1.1.2" xref="S3.p1.10.m10.1.1.1.1.1.2.cmml">x</mi><mi id="S3.p1.10.m10.1.1.1.1.1.3" xref="S3.p1.10.m10.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.p1.10.m10.2.2.2.2.4" xref="S3.p1.10.m10.2.2.2.3.cmml">,</mo><msub id="S3.p1.10.m10.2.2.2.2.2" xref="S3.p1.10.m10.2.2.2.2.2.cmml"><mi id="S3.p1.10.m10.2.2.2.2.2.2" xref="S3.p1.10.m10.2.2.2.2.2.2.cmml">y</mi><mi id="S3.p1.10.m10.2.2.2.2.2.3" xref="S3.p1.10.m10.2.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S3.p1.10.m10.2.2.2.2.5" xref="S3.p1.10.m10.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.2b"><apply id="S3.p1.10.m10.2.2.cmml" xref="S3.p1.10.m10.2.2"><eq id="S3.p1.10.m10.2.2.3.cmml" xref="S3.p1.10.m10.2.2.3"></eq><apply id="S3.p1.10.m10.2.2.4.cmml" xref="S3.p1.10.m10.2.2.4"><csymbol cd="ambiguous" id="S3.p1.10.m10.2.2.4.1.cmml" xref="S3.p1.10.m10.2.2.4">subscript</csymbol><ci id="S3.p1.10.m10.2.2.4.2.cmml" xref="S3.p1.10.m10.2.2.4.2">𝒟</ci><ci id="S3.p1.10.m10.2.2.4.3.cmml" xref="S3.p1.10.m10.2.2.4.3">𝑖</ci></apply><set id="S3.p1.10.m10.2.2.2.3.cmml" xref="S3.p1.10.m10.2.2.2.2"><apply id="S3.p1.10.m10.1.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.10.m10.1.1.1.1.1.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.2">𝑥</ci><ci id="S3.p1.10.m10.1.1.1.1.1.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.p1.10.m10.2.2.2.2.2.cmml" xref="S3.p1.10.m10.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.10.m10.2.2.2.2.2.1.cmml" xref="S3.p1.10.m10.2.2.2.2.2">subscript</csymbol><ci id="S3.p1.10.m10.2.2.2.2.2.2.cmml" xref="S3.p1.10.m10.2.2.2.2.2.2">𝑦</ci><ci id="S3.p1.10.m10.2.2.2.2.2.3.cmml" xref="S3.p1.10.m10.2.2.2.2.2.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.2c">\mathcal{D}_{i}=\{x_{k},y_{k}\}</annotation></semantics></math>, which are samples drawn from <math id="S3.p1.11.m11.1" class="ltx_Math" alttext="P_{\mathcal{X}\mathcal{Y}}^{(i)}" display="inline"><semantics id="S3.p1.11.m11.1a"><msubsup id="S3.p1.11.m11.1.2" xref="S3.p1.11.m11.1.2.cmml"><mi id="S3.p1.11.m11.1.2.2.2" xref="S3.p1.11.m11.1.2.2.2.cmml">P</mi><mrow id="S3.p1.11.m11.1.2.2.3" xref="S3.p1.11.m11.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.11.m11.1.2.2.3.2" xref="S3.p1.11.m11.1.2.2.3.2.cmml">𝒳</mi><mo lspace="0em" rspace="0em" id="S3.p1.11.m11.1.2.2.3.1" xref="S3.p1.11.m11.1.2.2.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.11.m11.1.2.2.3.3" xref="S3.p1.11.m11.1.2.2.3.3.cmml">𝒴</mi></mrow><mrow id="S3.p1.11.m11.1.1.1.3" xref="S3.p1.11.m11.1.2.cmml"><mo stretchy="false" id="S3.p1.11.m11.1.1.1.3.1" xref="S3.p1.11.m11.1.2.cmml">(</mo><mi id="S3.p1.11.m11.1.1.1.1" xref="S3.p1.11.m11.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.11.m11.1.1.1.3.2" xref="S3.p1.11.m11.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><apply id="S3.p1.11.m11.1.2.cmml" xref="S3.p1.11.m11.1.2"><csymbol cd="ambiguous" id="S3.p1.11.m11.1.2.1.cmml" xref="S3.p1.11.m11.1.2">superscript</csymbol><apply id="S3.p1.11.m11.1.2.2.cmml" xref="S3.p1.11.m11.1.2"><csymbol cd="ambiguous" id="S3.p1.11.m11.1.2.2.1.cmml" xref="S3.p1.11.m11.1.2">subscript</csymbol><ci id="S3.p1.11.m11.1.2.2.2.cmml" xref="S3.p1.11.m11.1.2.2.2">𝑃</ci><apply id="S3.p1.11.m11.1.2.2.3.cmml" xref="S3.p1.11.m11.1.2.2.3"><times id="S3.p1.11.m11.1.2.2.3.1.cmml" xref="S3.p1.11.m11.1.2.2.3.1"></times><ci id="S3.p1.11.m11.1.2.2.3.2.cmml" xref="S3.p1.11.m11.1.2.2.3.2">𝒳</ci><ci id="S3.p1.11.m11.1.2.2.3.3.cmml" xref="S3.p1.11.m11.1.2.2.3.3">𝒴</ci></apply></apply><ci id="S3.p1.11.m11.1.1.1.1.cmml" xref="S3.p1.11.m11.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">P_{\mathcal{X}\mathcal{Y}}^{(i)}</annotation></semantics></math>.
In this context, it is assumed that the probability distributions <math id="S3.p1.12.m12.1" class="ltx_Math" alttext="P_{\mathcal{X}\mathcal{Y}}^{(i)}" display="inline"><semantics id="S3.p1.12.m12.1a"><msubsup id="S3.p1.12.m12.1.2" xref="S3.p1.12.m12.1.2.cmml"><mi id="S3.p1.12.m12.1.2.2.2" xref="S3.p1.12.m12.1.2.2.2.cmml">P</mi><mrow id="S3.p1.12.m12.1.2.2.3" xref="S3.p1.12.m12.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.12.m12.1.2.2.3.2" xref="S3.p1.12.m12.1.2.2.3.2.cmml">𝒳</mi><mo lspace="0em" rspace="0em" id="S3.p1.12.m12.1.2.2.3.1" xref="S3.p1.12.m12.1.2.2.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.12.m12.1.2.2.3.3" xref="S3.p1.12.m12.1.2.2.3.3.cmml">𝒴</mi></mrow><mrow id="S3.p1.12.m12.1.1.1.3" xref="S3.p1.12.m12.1.2.cmml"><mo stretchy="false" id="S3.p1.12.m12.1.1.1.3.1" xref="S3.p1.12.m12.1.2.cmml">(</mo><mi id="S3.p1.12.m12.1.1.1.1" xref="S3.p1.12.m12.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.12.m12.1.1.1.3.2" xref="S3.p1.12.m12.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.1b"><apply id="S3.p1.12.m12.1.2.cmml" xref="S3.p1.12.m12.1.2"><csymbol cd="ambiguous" id="S3.p1.12.m12.1.2.1.cmml" xref="S3.p1.12.m12.1.2">superscript</csymbol><apply id="S3.p1.12.m12.1.2.2.cmml" xref="S3.p1.12.m12.1.2"><csymbol cd="ambiguous" id="S3.p1.12.m12.1.2.2.1.cmml" xref="S3.p1.12.m12.1.2">subscript</csymbol><ci id="S3.p1.12.m12.1.2.2.2.cmml" xref="S3.p1.12.m12.1.2.2.2">𝑃</ci><apply id="S3.p1.12.m12.1.2.2.3.cmml" xref="S3.p1.12.m12.1.2.2.3"><times id="S3.p1.12.m12.1.2.2.3.1.cmml" xref="S3.p1.12.m12.1.2.2.3.1"></times><ci id="S3.p1.12.m12.1.2.2.3.2.cmml" xref="S3.p1.12.m12.1.2.2.3.2">𝒳</ci><ci id="S3.p1.12.m12.1.2.2.3.3.cmml" xref="S3.p1.12.m12.1.2.2.3.3">𝒴</ci></apply></apply><ci id="S3.p1.12.m12.1.1.1.1.cmml" xref="S3.p1.12.m12.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.1c">P_{\mathcal{X}\mathcal{Y}}^{(i)}</annotation></semantics></math> and <math id="S3.p1.13.m13.1" class="ltx_Math" alttext="P_{\mathcal{X}\mathcal{Y}}^{(j)}" display="inline"><semantics id="S3.p1.13.m13.1a"><msubsup id="S3.p1.13.m13.1.2" xref="S3.p1.13.m13.1.2.cmml"><mi id="S3.p1.13.m13.1.2.2.2" xref="S3.p1.13.m13.1.2.2.2.cmml">P</mi><mrow id="S3.p1.13.m13.1.2.2.3" xref="S3.p1.13.m13.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.13.m13.1.2.2.3.2" xref="S3.p1.13.m13.1.2.2.3.2.cmml">𝒳</mi><mo lspace="0em" rspace="0em" id="S3.p1.13.m13.1.2.2.3.1" xref="S3.p1.13.m13.1.2.2.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.13.m13.1.2.2.3.3" xref="S3.p1.13.m13.1.2.2.3.3.cmml">𝒴</mi></mrow><mrow id="S3.p1.13.m13.1.1.1.3" xref="S3.p1.13.m13.1.2.cmml"><mo stretchy="false" id="S3.p1.13.m13.1.1.1.3.1" xref="S3.p1.13.m13.1.2.cmml">(</mo><mi id="S3.p1.13.m13.1.1.1.1" xref="S3.p1.13.m13.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.p1.13.m13.1.1.1.3.2" xref="S3.p1.13.m13.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.13.m13.1b"><apply id="S3.p1.13.m13.1.2.cmml" xref="S3.p1.13.m13.1.2"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.2.1.cmml" xref="S3.p1.13.m13.1.2">superscript</csymbol><apply id="S3.p1.13.m13.1.2.2.cmml" xref="S3.p1.13.m13.1.2"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.2.2.1.cmml" xref="S3.p1.13.m13.1.2">subscript</csymbol><ci id="S3.p1.13.m13.1.2.2.2.cmml" xref="S3.p1.13.m13.1.2.2.2">𝑃</ci><apply id="S3.p1.13.m13.1.2.2.3.cmml" xref="S3.p1.13.m13.1.2.2.3"><times id="S3.p1.13.m13.1.2.2.3.1.cmml" xref="S3.p1.13.m13.1.2.2.3.1"></times><ci id="S3.p1.13.m13.1.2.2.3.2.cmml" xref="S3.p1.13.m13.1.2.2.3.2">𝒳</ci><ci id="S3.p1.13.m13.1.2.2.3.3.cmml" xref="S3.p1.13.m13.1.2.2.3.3">𝒴</ci></apply></apply><ci id="S3.p1.13.m13.1.1.1.1.cmml" xref="S3.p1.13.m13.1.1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m13.1c">P_{\mathcal{X}\mathcal{Y}}^{(j)}</annotation></semantics></math> differ for any pair of clients <math id="S3.p1.14.m14.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.14.m14.1a"><mi id="S3.p1.14.m14.1.1" xref="S3.p1.14.m14.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.14.m14.1b"><ci id="S3.p1.14.m14.1.1.cmml" xref="S3.p1.14.m14.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m14.1c">i</annotation></semantics></math> and <math id="S3.p1.15.m15.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.p1.15.m15.1a"><mi id="S3.p1.15.m15.1.1" xref="S3.p1.15.m15.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.p1.15.m15.1b"><ci id="S3.p1.15.m15.1.1.cmml" xref="S3.p1.15.m15.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m15.1c">j</annotation></semantics></math>, which is typically the case in PFL. This is referred to as the non-i.i.d setting. The differences in probability distributions can arise from variations in <math id="S3.p1.16.m16.1" class="ltx_Math" alttext="P_{\mathcal{X}}" display="inline"><semantics id="S3.p1.16.m16.1a"><msub id="S3.p1.16.m16.1.1" xref="S3.p1.16.m16.1.1.cmml"><mi id="S3.p1.16.m16.1.1.2" xref="S3.p1.16.m16.1.1.2.cmml">P</mi><mi class="ltx_font_mathcaligraphic" id="S3.p1.16.m16.1.1.3" xref="S3.p1.16.m16.1.1.3.cmml">𝒳</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.16.m16.1b"><apply id="S3.p1.16.m16.1.1.cmml" xref="S3.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.p1.16.m16.1.1.1.cmml" xref="S3.p1.16.m16.1.1">subscript</csymbol><ci id="S3.p1.16.m16.1.1.2.cmml" xref="S3.p1.16.m16.1.1.2">𝑃</ci><ci id="S3.p1.16.m16.1.1.3.cmml" xref="S3.p1.16.m16.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m16.1c">P_{\mathcal{X}}</annotation></semantics></math>, in <math id="S3.p1.17.m17.1" class="ltx_Math" alttext="P_{\mathcal{Y}}" display="inline"><semantics id="S3.p1.17.m17.1a"><msub id="S3.p1.17.m17.1.1" xref="S3.p1.17.m17.1.1.cmml"><mi id="S3.p1.17.m17.1.1.2" xref="S3.p1.17.m17.1.1.2.cmml">P</mi><mi class="ltx_font_mathcaligraphic" id="S3.p1.17.m17.1.1.3" xref="S3.p1.17.m17.1.1.3.cmml">𝒴</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.17.m17.1b"><apply id="S3.p1.17.m17.1.1.cmml" xref="S3.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S3.p1.17.m17.1.1.1.cmml" xref="S3.p1.17.m17.1.1">subscript</csymbol><ci id="S3.p1.17.m17.1.1.2.cmml" xref="S3.p1.17.m17.1.1.2">𝑃</ci><ci id="S3.p1.17.m17.1.1.3.cmml" xref="S3.p1.17.m17.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.17.m17.1c">P_{\mathcal{Y}}</annotation></semantics></math> or in the conditional <math id="S3.p1.18.m18.1" class="ltx_Math" alttext="P_{\mathcal{Y}|\mathcal{X}}" display="inline"><semantics id="S3.p1.18.m18.1a"><msub id="S3.p1.18.m18.1.1" xref="S3.p1.18.m18.1.1.cmml"><mi id="S3.p1.18.m18.1.1.2" xref="S3.p1.18.m18.1.1.2.cmml">P</mi><mrow id="S3.p1.18.m18.1.1.3" xref="S3.p1.18.m18.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.18.m18.1.1.3.2" xref="S3.p1.18.m18.1.1.3.2.cmml">𝒴</mi><mo fence="false" id="S3.p1.18.m18.1.1.3.1" xref="S3.p1.18.m18.1.1.3.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.18.m18.1.1.3.3" xref="S3.p1.18.m18.1.1.3.3.cmml">𝒳</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.18.m18.1b"><apply id="S3.p1.18.m18.1.1.cmml" xref="S3.p1.18.m18.1.1"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.1.1.cmml" xref="S3.p1.18.m18.1.1">subscript</csymbol><ci id="S3.p1.18.m18.1.1.2.cmml" xref="S3.p1.18.m18.1.1.2">𝑃</ci><apply id="S3.p1.18.m18.1.1.3.cmml" xref="S3.p1.18.m18.1.1.3"><csymbol cd="latexml" id="S3.p1.18.m18.1.1.3.1.cmml" xref="S3.p1.18.m18.1.1.3.1">conditional</csymbol><ci id="S3.p1.18.m18.1.1.3.2.cmml" xref="S3.p1.18.m18.1.1.3.2">𝒴</ci><ci id="S3.p1.18.m18.1.1.3.3.cmml" xref="S3.p1.18.m18.1.1.3.3">𝒳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m18.1c">P_{\mathcal{Y}|\mathcal{X}}</annotation></semantics></math>, resulting in covariate shift, label shift, or concept shift, respectively. While previous works have primarily focused on the first two, our proposed solution is designed to effectively handle the concept shift scenario as well.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.8" class="ltx_p">The main goal of PFL is to learn a global model <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="f_{\omega}" display="inline"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">f</mi><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">ω</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝑓</ci><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">f_{\omega}</annotation></semantics></math> that performs well after personalization to each client’s local dataset. This is achieved through an update scheme that proceeds in rounds of communication. In each communication round of the training process, the global model is initialized with <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\omega</annotation></semantics></math> and sent to the clients. Each client <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="i\in\mathbb{C}" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">i</mi><mo id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml">∈</mo><mi id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">ℂ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><in id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1"></in><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝑖</ci><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">ℂ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">i\in\mathbb{C}</annotation></semantics></math> then personalizes the global model using its local data <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.p2.4.m4.1a"><msub id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">𝒟</mi><mi id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝒟</ci><ci id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\mathcal{D}_{i}</annotation></semantics></math> to derive personalized model parameters <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="\omega^{\prime}_{i}" display="inline"><semantics id="S3.p2.5.m5.1a"><msubsup id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2.2" xref="S3.p2.5.m5.1.1.2.2.cmml">ω</mi><mi id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">i</mi><mo id="S3.p2.5.m5.1.1.2.3" xref="S3.p2.5.m5.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1">subscript</csymbol><apply id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.2.1.cmml" xref="S3.p2.5.m5.1.1">superscript</csymbol><ci id="S3.p2.5.m5.1.1.2.2.cmml" xref="S3.p2.5.m5.1.1.2.2">𝜔</ci><ci id="S3.p2.5.m5.1.1.2.3.cmml" xref="S3.p2.5.m5.1.1.2.3">′</ci></apply><ci id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">\omega^{\prime}_{i}</annotation></semantics></math>. Typically, this personalization process involves performing a few steps of gradient descent on the client’s local dataset. Formally, let <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="\mathcal{L}_{\mathcal{D}_{i}}(f_{\omega^{\prime}_{i}})" display="inline"><semantics id="S3.p2.6.m6.1a"><mrow id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><msub id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.6.m6.1.1.3.2" xref="S3.p2.6.m6.1.1.3.2.cmml">ℒ</mi><msub id="S3.p2.6.m6.1.1.3.3" xref="S3.p2.6.m6.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.6.m6.1.1.3.3.2" xref="S3.p2.6.m6.1.1.3.3.2.cmml">𝒟</mi><mi id="S3.p2.6.m6.1.1.3.3.3" xref="S3.p2.6.m6.1.1.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">​</mo><mrow id="S3.p2.6.m6.1.1.1.1" xref="S3.p2.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.6.m6.1.1.1.1.2" xref="S3.p2.6.m6.1.1.1.1.1.cmml">(</mo><msub id="S3.p2.6.m6.1.1.1.1.1" xref="S3.p2.6.m6.1.1.1.1.1.cmml"><mi id="S3.p2.6.m6.1.1.1.1.1.2" xref="S3.p2.6.m6.1.1.1.1.1.2.cmml">f</mi><msubsup id="S3.p2.6.m6.1.1.1.1.1.3" xref="S3.p2.6.m6.1.1.1.1.1.3.cmml"><mi id="S3.p2.6.m6.1.1.1.1.1.3.2.2" xref="S3.p2.6.m6.1.1.1.1.1.3.2.2.cmml">ω</mi><mi id="S3.p2.6.m6.1.1.1.1.1.3.3" xref="S3.p2.6.m6.1.1.1.1.1.3.3.cmml">i</mi><mo id="S3.p2.6.m6.1.1.1.1.1.3.2.3" xref="S3.p2.6.m6.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup></msub><mo stretchy="false" id="S3.p2.6.m6.1.1.1.1.3" xref="S3.p2.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><times id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2"></times><apply id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.3.1.cmml" xref="S3.p2.6.m6.1.1.3">subscript</csymbol><ci id="S3.p2.6.m6.1.1.3.2.cmml" xref="S3.p2.6.m6.1.1.3.2">ℒ</ci><apply id="S3.p2.6.m6.1.1.3.3.cmml" xref="S3.p2.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.3.3.1.cmml" xref="S3.p2.6.m6.1.1.3.3">subscript</csymbol><ci id="S3.p2.6.m6.1.1.3.3.2.cmml" xref="S3.p2.6.m6.1.1.3.3.2">𝒟</ci><ci id="S3.p2.6.m6.1.1.3.3.3.cmml" xref="S3.p2.6.m6.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.p2.6.m6.1.1.1.1.1.cmml" xref="S3.p2.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.1.1.1.cmml" xref="S3.p2.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.p2.6.m6.1.1.1.1.1.2.cmml" xref="S3.p2.6.m6.1.1.1.1.1.2">𝑓</ci><apply id="S3.p2.6.m6.1.1.1.1.1.3.cmml" xref="S3.p2.6.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.1.1.3.1.cmml" xref="S3.p2.6.m6.1.1.1.1.1.3">subscript</csymbol><apply id="S3.p2.6.m6.1.1.1.1.1.3.2.cmml" xref="S3.p2.6.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.1.1.3.2.1.cmml" xref="S3.p2.6.m6.1.1.1.1.1.3">superscript</csymbol><ci id="S3.p2.6.m6.1.1.1.1.1.3.2.2.cmml" xref="S3.p2.6.m6.1.1.1.1.1.3.2.2">𝜔</ci><ci id="S3.p2.6.m6.1.1.1.1.1.3.2.3.cmml" xref="S3.p2.6.m6.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.p2.6.m6.1.1.1.1.1.3.3.cmml" xref="S3.p2.6.m6.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">\mathcal{L}_{\mathcal{D}_{i}}(f_{\omega^{\prime}_{i}})</annotation></semantics></math> be the empirical risk of the local model <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="f_{\omega^{\prime}_{i}}" display="inline"><semantics id="S3.p2.7.m7.1a"><msub id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">f</mi><msubsup id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml"><mi id="S3.p2.7.m7.1.1.3.2.2" xref="S3.p2.7.m7.1.1.3.2.2.cmml">ω</mi><mi id="S3.p2.7.m7.1.1.3.3" xref="S3.p2.7.m7.1.1.3.3.cmml">i</mi><mo id="S3.p2.7.m7.1.1.3.2.3" xref="S3.p2.7.m7.1.1.3.2.3.cmml">′</mo></msubsup></msub><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">𝑓</ci><apply id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.3.1.cmml" xref="S3.p2.7.m7.1.1.3">subscript</csymbol><apply id="S3.p2.7.m7.1.1.3.2.cmml" xref="S3.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.3.2.1.cmml" xref="S3.p2.7.m7.1.1.3">superscript</csymbol><ci id="S3.p2.7.m7.1.1.3.2.2.cmml" xref="S3.p2.7.m7.1.1.3.2.2">𝜔</ci><ci id="S3.p2.7.m7.1.1.3.2.3.cmml" xref="S3.p2.7.m7.1.1.3.2.3">′</ci></apply><ci id="S3.p2.7.m7.1.1.3.3.cmml" xref="S3.p2.7.m7.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">f_{\omega^{\prime}_{i}}</annotation></semantics></math> on the local dataset <math id="S3.p2.8.m8.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.p2.8.m8.1a"><msub id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml">𝒟</mi><mi id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.1.cmml" xref="S3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2">𝒟</ci><ci id="S3.p2.8.m8.1.1.3.cmml" xref="S3.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">\mathcal{D}_{i}</annotation></semantics></math>. The objective of PFL can be described as follows:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3.1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\min_{\bm{W}}\biggl{\{}F(\bm{W}):=\frac{1}{C}\sum_{i=1}^{C}\mathcal{L}_{\mathcal{D}_{i}}(f_{\omega^{\prime}_{i}})\biggr{\}}" display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.3.cmml"><munder id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml">min</mi><mi id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.1.3.cmml">𝑾</mi></munder><mo id="S3.E1.m1.3.3.2a" xref="S3.E1.m1.3.3.3.cmml">⁡</mo><mrow id="S3.E1.m1.3.3.2.2" xref="S3.E1.m1.3.3.3.cmml"><mo maxsize="210%" minsize="210%" id="S3.E1.m1.3.3.2.2.2" xref="S3.E1.m1.3.3.3.cmml">{</mo><mrow id="S3.E1.m1.3.3.2.2.1" xref="S3.E1.m1.3.3.2.2.1.cmml"><mrow id="S3.E1.m1.3.3.2.2.1.3" xref="S3.E1.m1.3.3.2.2.1.3.cmml"><mi id="S3.E1.m1.3.3.2.2.1.3.2" xref="S3.E1.m1.3.3.2.2.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.2.2.1.3.1" xref="S3.E1.m1.3.3.2.2.1.3.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.2.2.1.3.3.2" xref="S3.E1.m1.3.3.2.2.1.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.2.2.1.3.3.2.1" xref="S3.E1.m1.3.3.2.2.1.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝑾</mi><mo rspace="0.278em" stretchy="false" id="S3.E1.m1.3.3.2.2.1.3.3.2.2" xref="S3.E1.m1.3.3.2.2.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.E1.m1.3.3.2.2.1.2" xref="S3.E1.m1.3.3.2.2.1.2.cmml">:=</mo><mrow id="S3.E1.m1.3.3.2.2.1.1" xref="S3.E1.m1.3.3.2.2.1.1.cmml"><mfrac id="S3.E1.m1.3.3.2.2.1.1.3" xref="S3.E1.m1.3.3.2.2.1.1.3.cmml"><mn id="S3.E1.m1.3.3.2.2.1.1.3.2" xref="S3.E1.m1.3.3.2.2.1.1.3.2.cmml">1</mn><mi id="S3.E1.m1.3.3.2.2.1.1.3.3" xref="S3.E1.m1.3.3.2.2.1.1.3.3.cmml">C</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.2.2.1.1.2" xref="S3.E1.m1.3.3.2.2.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.2.2.1.1.1" xref="S3.E1.m1.3.3.2.2.1.1.1.cmml"><munderover id="S3.E1.m1.3.3.2.2.1.1.1.2" xref="S3.E1.m1.3.3.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.3.3.2.2.1.1.1.2.2.2" xref="S3.E1.m1.3.3.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.2.2.1.1.1.2.2.3" xref="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.2" xref="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.1" xref="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.3" xref="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.3.3.2.2.1.1.1.2.3" xref="S3.E1.m1.3.3.2.2.1.1.1.2.3.cmml">C</mi></munderover><mrow id="S3.E1.m1.3.3.2.2.1.1.1.1" xref="S3.E1.m1.3.3.2.2.1.1.1.1.cmml"><msub id="S3.E1.m1.3.3.2.2.1.1.1.1.3" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.2.2.1.1.1.1.3.2" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3.2.cmml">ℒ</mi><msub id="S3.E1.m1.3.3.2.2.1.1.1.1.3.3" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.2.2.1.1.1.1.3.3.2" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3.3.2.cmml">𝒟</mi><mi id="S3.E1.m1.3.3.2.2.1.1.1.1.3.3.3" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.2.2.1.1.1.1.2" xref="S3.E1.m1.3.3.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.2.cmml">f</mi><msubsup id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.2.cmml">ω</mi><mi id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.3.cmml">i</mi><mo id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup></msub><mo stretchy="false" id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo maxsize="210%" minsize="210%" id="S3.E1.m1.3.3.2.2.3" xref="S3.E1.m1.3.3.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.2"><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1">subscript</csymbol><min id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"></min><ci id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3">𝑾</ci></apply><apply id="S3.E1.m1.3.3.2.2.1.cmml" xref="S3.E1.m1.3.3.2.2.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.2.2.1.2.cmml" xref="S3.E1.m1.3.3.2.2.1.2">assign</csymbol><apply id="S3.E1.m1.3.3.2.2.1.3.cmml" xref="S3.E1.m1.3.3.2.2.1.3"><times id="S3.E1.m1.3.3.2.2.1.3.1.cmml" xref="S3.E1.m1.3.3.2.2.1.3.1"></times><ci id="S3.E1.m1.3.3.2.2.1.3.2.cmml" xref="S3.E1.m1.3.3.2.2.1.3.2">𝐹</ci><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑾</ci></apply><apply id="S3.E1.m1.3.3.2.2.1.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1"><times id="S3.E1.m1.3.3.2.2.1.1.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.2"></times><apply id="S3.E1.m1.3.3.2.2.1.1.3.cmml" xref="S3.E1.m1.3.3.2.2.1.1.3"><divide id="S3.E1.m1.3.3.2.2.1.1.3.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.3"></divide><cn type="integer" id="S3.E1.m1.3.3.2.2.1.1.3.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.3.2">1</cn><ci id="S3.E1.m1.3.3.2.2.1.1.3.3.cmml" xref="S3.E1.m1.3.3.2.2.1.1.3.3">𝐶</ci></apply><apply id="S3.E1.m1.3.3.2.2.1.1.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1"><apply id="S3.E1.m1.3.3.2.2.1.1.1.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.3.3.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.3.3.2.2.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.2.2.3"><eq id="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.3.3.2.2.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.2.3">𝐶</ci></apply><apply id="S3.E1.m1.3.3.2.2.1.1.1.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1"><times id="S3.E1.m1.3.3.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.2"></times><apply id="S3.E1.m1.3.3.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.2.2.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3.2">ℒ</ci><apply id="S3.E1.m1.3.3.2.2.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.2.2.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3.3.2">𝒟</ci><ci id="S3.E1.m1.3.3.2.2.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.2">𝑓</ci><apply id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.2">𝜔</ci><ci id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.2.2.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\min_{\bm{W}}\biggl{\{}F(\bm{W}):=\frac{1}{C}\sum_{i=1}^{C}\mathcal{L}_{\mathcal{D}_{i}}(f_{\omega^{\prime}_{i}})\biggr{\}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.p2.10" class="ltx_p">where <math id="S3.p2.9.m1.1" class="ltx_Math" alttext="\bm{W}" display="inline"><semantics id="S3.p2.9.m1.1a"><mi id="S3.p2.9.m1.1.1" xref="S3.p2.9.m1.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.p2.9.m1.1b"><ci id="S3.p2.9.m1.1.1.cmml" xref="S3.p2.9.m1.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m1.1c">\bm{W}</annotation></semantics></math> denotes the collection of all local models, i.e., <math id="S3.p2.10.m2.1" class="ltx_Math" alttext="\bm{W}=\{\omega^{\prime}_{i}\}_{i=1}^{C}" display="inline"><semantics id="S3.p2.10.m2.1a"><mrow id="S3.p2.10.m2.1.1" xref="S3.p2.10.m2.1.1.cmml"><mi id="S3.p2.10.m2.1.1.3" xref="S3.p2.10.m2.1.1.3.cmml">𝑾</mi><mo id="S3.p2.10.m2.1.1.2" xref="S3.p2.10.m2.1.1.2.cmml">=</mo><msubsup id="S3.p2.10.m2.1.1.1" xref="S3.p2.10.m2.1.1.1.cmml"><mrow id="S3.p2.10.m2.1.1.1.1.1.1" xref="S3.p2.10.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p2.10.m2.1.1.1.1.1.1.2" xref="S3.p2.10.m2.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.p2.10.m2.1.1.1.1.1.1.1" xref="S3.p2.10.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.p2.10.m2.1.1.1.1.1.1.1.2.2" xref="S3.p2.10.m2.1.1.1.1.1.1.1.2.2.cmml">ω</mi><mi id="S3.p2.10.m2.1.1.1.1.1.1.1.3" xref="S3.p2.10.m2.1.1.1.1.1.1.1.3.cmml">i</mi><mo id="S3.p2.10.m2.1.1.1.1.1.1.1.2.3" xref="S3.p2.10.m2.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S3.p2.10.m2.1.1.1.1.1.1.3" xref="S3.p2.10.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p2.10.m2.1.1.1.1.3" xref="S3.p2.10.m2.1.1.1.1.3.cmml"><mi id="S3.p2.10.m2.1.1.1.1.3.2" xref="S3.p2.10.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.p2.10.m2.1.1.1.1.3.1" xref="S3.p2.10.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S3.p2.10.m2.1.1.1.1.3.3" xref="S3.p2.10.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.p2.10.m2.1.1.1.3" xref="S3.p2.10.m2.1.1.1.3.cmml">C</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.10.m2.1b"><apply id="S3.p2.10.m2.1.1.cmml" xref="S3.p2.10.m2.1.1"><eq id="S3.p2.10.m2.1.1.2.cmml" xref="S3.p2.10.m2.1.1.2"></eq><ci id="S3.p2.10.m2.1.1.3.cmml" xref="S3.p2.10.m2.1.1.3">𝑾</ci><apply id="S3.p2.10.m2.1.1.1.cmml" xref="S3.p2.10.m2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.10.m2.1.1.1.2.cmml" xref="S3.p2.10.m2.1.1.1">superscript</csymbol><apply id="S3.p2.10.m2.1.1.1.1.cmml" xref="S3.p2.10.m2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.10.m2.1.1.1.1.2.cmml" xref="S3.p2.10.m2.1.1.1">subscript</csymbol><set id="S3.p2.10.m2.1.1.1.1.1.2.cmml" xref="S3.p2.10.m2.1.1.1.1.1.1"><apply id="S3.p2.10.m2.1.1.1.1.1.1.1.cmml" xref="S3.p2.10.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.10.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.10.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.p2.10.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.p2.10.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.10.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.p2.10.m2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.p2.10.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.p2.10.m2.1.1.1.1.1.1.1.2.2">𝜔</ci><ci id="S3.p2.10.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.p2.10.m2.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S3.p2.10.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.p2.10.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.p2.10.m2.1.1.1.1.3.cmml" xref="S3.p2.10.m2.1.1.1.1.3"><eq id="S3.p2.10.m2.1.1.1.1.3.1.cmml" xref="S3.p2.10.m2.1.1.1.1.3.1"></eq><ci id="S3.p2.10.m2.1.1.1.1.3.2.cmml" xref="S3.p2.10.m2.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.p2.10.m2.1.1.1.1.3.3.cmml" xref="S3.p2.10.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.p2.10.m2.1.1.1.3.cmml" xref="S3.p2.10.m2.1.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m2.1c">\bm{W}=\{\omega^{\prime}_{i}\}_{i=1}^{C}</annotation></semantics></math>.
However, in the non-i.i.d setting, it is challenging to find a global model that performs well after personalization to heterogeneous clients. One way to address this challenge is to incorporate meta-learning into the PFL setting.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.13" class="ltx_p">Meta-learning approaches aim to learn models that can be efficiently adapted to new tasks by leveraging the knowledge acquired from previous tasks. Optimization-based meta-learning methods, such as MAML <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx10" title="" class="ltx_ref">10</a>]</cite>, use a bi-level optimization process to learn an initial set of parameters <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\omega</annotation></semantics></math> that can be effectively adapted with gradient descent on new tasks. During the meta-training phase, a set of training tasks <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="\{\mathcal{T}_{i}\}_{i=1}^{T}" display="inline"><semantics id="S3.p3.2.m2.1a"><msubsup id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mrow id="S3.p3.2.m2.1.1.1.1.1" xref="S3.p3.2.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p3.2.m2.1.1.1.1.1.2" xref="S3.p3.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S3.p3.2.m2.1.1.1.1.1.1" xref="S3.p3.2.m2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.2.m2.1.1.1.1.1.1.2" xref="S3.p3.2.m2.1.1.1.1.1.1.2.cmml">𝒯</mi><mi id="S3.p3.2.m2.1.1.1.1.1.1.3" xref="S3.p3.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p3.2.m2.1.1.1.1.1.3" xref="S3.p3.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p3.2.m2.1.1.1.3" xref="S3.p3.2.m2.1.1.1.3.cmml"><mi id="S3.p3.2.m2.1.1.1.3.2" xref="S3.p3.2.m2.1.1.1.3.2.cmml">i</mi><mo id="S3.p3.2.m2.1.1.1.3.1" xref="S3.p3.2.m2.1.1.1.3.1.cmml">=</mo><mn id="S3.p3.2.m2.1.1.1.3.3" xref="S3.p3.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1">superscript</csymbol><apply id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.2.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><set id="S3.p3.2.m2.1.1.1.1.2.cmml" xref="S3.p3.2.m2.1.1.1.1.1"><apply id="S3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.p3.2.m2.1.1.1.1.1.1.2">𝒯</ci><ci id="S3.p3.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.p3.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.p3.2.m2.1.1.1.3.cmml" xref="S3.p3.2.m2.1.1.1.3"><eq id="S3.p3.2.m2.1.1.1.3.1.cmml" xref="S3.p3.2.m2.1.1.1.3.1"></eq><ci id="S3.p3.2.m2.1.1.1.3.2.cmml" xref="S3.p3.2.m2.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.p3.2.m2.1.1.1.3.3.cmml" xref="S3.p3.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\{\mathcal{T}_{i}\}_{i=1}^{T}</annotation></semantics></math> is used. Each task <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{T}_{i}" display="inline"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">𝒯</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝒯</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">\mathcal{T}_{i}</annotation></semantics></math> corresponds to data generating distributions <math id="S3.p3.4.m4.4" class="ltx_Math" alttext="\mathcal{T}_{i}\triangleq\{P_{\mathcal{X}}^{(i)},P_{\mathcal{Y}|\mathcal{X}}^{(i)}\}" display="inline"><semantics id="S3.p3.4.m4.4a"><mrow id="S3.p3.4.m4.4.4" xref="S3.p3.4.m4.4.4.cmml"><msub id="S3.p3.4.m4.4.4.4" xref="S3.p3.4.m4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.4.m4.4.4.4.2" xref="S3.p3.4.m4.4.4.4.2.cmml">𝒯</mi><mi id="S3.p3.4.m4.4.4.4.3" xref="S3.p3.4.m4.4.4.4.3.cmml">i</mi></msub><mo id="S3.p3.4.m4.4.4.3" xref="S3.p3.4.m4.4.4.3.cmml">≜</mo><mrow id="S3.p3.4.m4.4.4.2.2" xref="S3.p3.4.m4.4.4.2.3.cmml"><mo stretchy="false" id="S3.p3.4.m4.4.4.2.2.3" xref="S3.p3.4.m4.4.4.2.3.cmml">{</mo><msubsup id="S3.p3.4.m4.3.3.1.1.1" xref="S3.p3.4.m4.3.3.1.1.1.cmml"><mi id="S3.p3.4.m4.3.3.1.1.1.2.2" xref="S3.p3.4.m4.3.3.1.1.1.2.2.cmml">P</mi><mi class="ltx_font_mathcaligraphic" id="S3.p3.4.m4.3.3.1.1.1.2.3" xref="S3.p3.4.m4.3.3.1.1.1.2.3.cmml">𝒳</mi><mrow id="S3.p3.4.m4.1.1.1.3" xref="S3.p3.4.m4.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.p3.4.m4.1.1.1.3.1" xref="S3.p3.4.m4.3.3.1.1.1.cmml">(</mo><mi id="S3.p3.4.m4.1.1.1.1" xref="S3.p3.4.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p3.4.m4.1.1.1.3.2" xref="S3.p3.4.m4.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p3.4.m4.4.4.2.2.4" xref="S3.p3.4.m4.4.4.2.3.cmml">,</mo><msubsup id="S3.p3.4.m4.4.4.2.2.2" xref="S3.p3.4.m4.4.4.2.2.2.cmml"><mi id="S3.p3.4.m4.4.4.2.2.2.2.2" xref="S3.p3.4.m4.4.4.2.2.2.2.2.cmml">P</mi><mrow id="S3.p3.4.m4.4.4.2.2.2.2.3" xref="S3.p3.4.m4.4.4.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.4.m4.4.4.2.2.2.2.3.2" xref="S3.p3.4.m4.4.4.2.2.2.2.3.2.cmml">𝒴</mi><mo fence="false" id="S3.p3.4.m4.4.4.2.2.2.2.3.1" xref="S3.p3.4.m4.4.4.2.2.2.2.3.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.p3.4.m4.4.4.2.2.2.2.3.3" xref="S3.p3.4.m4.4.4.2.2.2.2.3.3.cmml">𝒳</mi></mrow><mrow id="S3.p3.4.m4.2.2.1.3" xref="S3.p3.4.m4.4.4.2.2.2.cmml"><mo stretchy="false" id="S3.p3.4.m4.2.2.1.3.1" xref="S3.p3.4.m4.4.4.2.2.2.cmml">(</mo><mi id="S3.p3.4.m4.2.2.1.1" xref="S3.p3.4.m4.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.p3.4.m4.2.2.1.3.2" xref="S3.p3.4.m4.4.4.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.p3.4.m4.4.4.2.2.5" xref="S3.p3.4.m4.4.4.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.4b"><apply id="S3.p3.4.m4.4.4.cmml" xref="S3.p3.4.m4.4.4"><ci id="S3.p3.4.m4.4.4.3.cmml" xref="S3.p3.4.m4.4.4.3">≜</ci><apply id="S3.p3.4.m4.4.4.4.cmml" xref="S3.p3.4.m4.4.4.4"><csymbol cd="ambiguous" id="S3.p3.4.m4.4.4.4.1.cmml" xref="S3.p3.4.m4.4.4.4">subscript</csymbol><ci id="S3.p3.4.m4.4.4.4.2.cmml" xref="S3.p3.4.m4.4.4.4.2">𝒯</ci><ci id="S3.p3.4.m4.4.4.4.3.cmml" xref="S3.p3.4.m4.4.4.4.3">𝑖</ci></apply><set id="S3.p3.4.m4.4.4.2.3.cmml" xref="S3.p3.4.m4.4.4.2.2"><apply id="S3.p3.4.m4.3.3.1.1.1.cmml" xref="S3.p3.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.3.3.1.1.1.1.cmml" xref="S3.p3.4.m4.3.3.1.1.1">superscript</csymbol><apply id="S3.p3.4.m4.3.3.1.1.1.2.cmml" xref="S3.p3.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.3.3.1.1.1.2.1.cmml" xref="S3.p3.4.m4.3.3.1.1.1">subscript</csymbol><ci id="S3.p3.4.m4.3.3.1.1.1.2.2.cmml" xref="S3.p3.4.m4.3.3.1.1.1.2.2">𝑃</ci><ci id="S3.p3.4.m4.3.3.1.1.1.2.3.cmml" xref="S3.p3.4.m4.3.3.1.1.1.2.3">𝒳</ci></apply><ci id="S3.p3.4.m4.1.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1.1">𝑖</ci></apply><apply id="S3.p3.4.m4.4.4.2.2.2.cmml" xref="S3.p3.4.m4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.p3.4.m4.4.4.2.2.2.1.cmml" xref="S3.p3.4.m4.4.4.2.2.2">superscript</csymbol><apply id="S3.p3.4.m4.4.4.2.2.2.2.cmml" xref="S3.p3.4.m4.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.p3.4.m4.4.4.2.2.2.2.1.cmml" xref="S3.p3.4.m4.4.4.2.2.2">subscript</csymbol><ci id="S3.p3.4.m4.4.4.2.2.2.2.2.cmml" xref="S3.p3.4.m4.4.4.2.2.2.2.2">𝑃</ci><apply id="S3.p3.4.m4.4.4.2.2.2.2.3.cmml" xref="S3.p3.4.m4.4.4.2.2.2.2.3"><csymbol cd="latexml" id="S3.p3.4.m4.4.4.2.2.2.2.3.1.cmml" xref="S3.p3.4.m4.4.4.2.2.2.2.3.1">conditional</csymbol><ci id="S3.p3.4.m4.4.4.2.2.2.2.3.2.cmml" xref="S3.p3.4.m4.4.4.2.2.2.2.3.2">𝒴</ci><ci id="S3.p3.4.m4.4.4.2.2.2.2.3.3.cmml" xref="S3.p3.4.m4.4.4.2.2.2.2.3.3">𝒳</ci></apply></apply><ci id="S3.p3.4.m4.2.2.1.1.cmml" xref="S3.p3.4.m4.2.2.1.1">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.4c">\mathcal{T}_{i}\triangleq\{P_{\mathcal{X}}^{(i)},P_{\mathcal{Y}|\mathcal{X}}^{(i)}\}</annotation></semantics></math>. The data sampled from each task is divided into a <em id="S3.p3.13.1" class="ltx_emph ltx_font_italic">support set</em> <math id="S3.p3.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{(sp)}" display="inline"><semantics id="S3.p3.5.m5.1a"><msubsup id="S3.p3.5.m5.1.2" xref="S3.p3.5.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.5.m5.1.2.2.2" xref="S3.p3.5.m5.1.2.2.2.cmml">𝒟</mi><mi id="S3.p3.5.m5.1.2.2.3" xref="S3.p3.5.m5.1.2.2.3.cmml">i</mi><mrow id="S3.p3.5.m5.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p3.5.m5.1.1.1.1.2" xref="S3.p3.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.p3.5.m5.1.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.1.cmml"><mi id="S3.p3.5.m5.1.1.1.1.1.2" xref="S3.p3.5.m5.1.1.1.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p3.5.m5.1.1.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p3.5.m5.1.1.1.1.1.3" xref="S3.p3.5.m5.1.1.1.1.1.3.cmml">p</mi></mrow><mo stretchy="false" id="S3.p3.5.m5.1.1.1.1.3" xref="S3.p3.5.m5.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.2.cmml" xref="S3.p3.5.m5.1.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.2.1.cmml" xref="S3.p3.5.m5.1.2">superscript</csymbol><apply id="S3.p3.5.m5.1.2.2.cmml" xref="S3.p3.5.m5.1.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.2.2.1.cmml" xref="S3.p3.5.m5.1.2">subscript</csymbol><ci id="S3.p3.5.m5.1.2.2.2.cmml" xref="S3.p3.5.m5.1.2.2.2">𝒟</ci><ci id="S3.p3.5.m5.1.2.2.3.cmml" xref="S3.p3.5.m5.1.2.2.3">𝑖</ci></apply><apply id="S3.p3.5.m5.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1"><times id="S3.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1.1.1"></times><ci id="S3.p3.5.m5.1.1.1.1.1.2.cmml" xref="S3.p3.5.m5.1.1.1.1.1.2">𝑠</ci><ci id="S3.p3.5.m5.1.1.1.1.1.3.cmml" xref="S3.p3.5.m5.1.1.1.1.1.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">\mathcal{D}_{i}^{(sp)}</annotation></semantics></math> containing <math id="S3.p3.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.p3.6.m6.1a"><mi id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><ci id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">K</annotation></semantics></math> training examples, and a <em id="S3.p3.13.2" class="ltx_emph ltx_font_italic">query set</em> <math id="S3.p3.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{(qr)}" display="inline"><semantics id="S3.p3.7.m7.1a"><msubsup id="S3.p3.7.m7.1.2" xref="S3.p3.7.m7.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.7.m7.1.2.2.2" xref="S3.p3.7.m7.1.2.2.2.cmml">𝒟</mi><mi id="S3.p3.7.m7.1.2.2.3" xref="S3.p3.7.m7.1.2.2.3.cmml">i</mi><mrow id="S3.p3.7.m7.1.1.1.1" xref="S3.p3.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p3.7.m7.1.1.1.1.2" xref="S3.p3.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S3.p3.7.m7.1.1.1.1.1" xref="S3.p3.7.m7.1.1.1.1.1.cmml"><mi id="S3.p3.7.m7.1.1.1.1.1.2" xref="S3.p3.7.m7.1.1.1.1.1.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.p3.7.m7.1.1.1.1.1.1" xref="S3.p3.7.m7.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p3.7.m7.1.1.1.1.1.3" xref="S3.p3.7.m7.1.1.1.1.1.3.cmml">r</mi></mrow><mo stretchy="false" id="S3.p3.7.m7.1.1.1.1.3" xref="S3.p3.7.m7.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><apply id="S3.p3.7.m7.1.2.cmml" xref="S3.p3.7.m7.1.2"><csymbol cd="ambiguous" id="S3.p3.7.m7.1.2.1.cmml" xref="S3.p3.7.m7.1.2">superscript</csymbol><apply id="S3.p3.7.m7.1.2.2.cmml" xref="S3.p3.7.m7.1.2"><csymbol cd="ambiguous" id="S3.p3.7.m7.1.2.2.1.cmml" xref="S3.p3.7.m7.1.2">subscript</csymbol><ci id="S3.p3.7.m7.1.2.2.2.cmml" xref="S3.p3.7.m7.1.2.2.2">𝒟</ci><ci id="S3.p3.7.m7.1.2.2.3.cmml" xref="S3.p3.7.m7.1.2.2.3">𝑖</ci></apply><apply id="S3.p3.7.m7.1.1.1.1.1.cmml" xref="S3.p3.7.m7.1.1.1.1"><times id="S3.p3.7.m7.1.1.1.1.1.1.cmml" xref="S3.p3.7.m7.1.1.1.1.1.1"></times><ci id="S3.p3.7.m7.1.1.1.1.1.2.cmml" xref="S3.p3.7.m7.1.1.1.1.1.2">𝑞</ci><ci id="S3.p3.7.m7.1.1.1.1.1.3.cmml" xref="S3.p3.7.m7.1.1.1.1.1.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">\mathcal{D}_{i}^{(qr)}</annotation></semantics></math> used for evaluating the model’s performance.
MAML meta-trains a neural network model <math id="S3.p3.8.m8.1" class="ltx_Math" alttext="f_{\omega}" display="inline"><semantics id="S3.p3.8.m8.1a"><msub id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml"><mi id="S3.p3.8.m8.1.1.2" xref="S3.p3.8.m8.1.1.2.cmml">f</mi><mi id="S3.p3.8.m8.1.1.3" xref="S3.p3.8.m8.1.1.3.cmml">ω</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><apply id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p3.8.m8.1.1.1.cmml" xref="S3.p3.8.m8.1.1">subscript</csymbol><ci id="S3.p3.8.m8.1.1.2.cmml" xref="S3.p3.8.m8.1.1.2">𝑓</ci><ci id="S3.p3.8.m8.1.1.3.cmml" xref="S3.p3.8.m8.1.1.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">f_{\omega}</annotation></semantics></math> parameterized by <math id="S3.p3.9.m9.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p3.9.m9.1a"><mi id="S3.p3.9.m9.1.1" xref="S3.p3.9.m9.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.1b"><ci id="S3.p3.9.m9.1.1.cmml" xref="S3.p3.9.m9.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">\omega</annotation></semantics></math> using a two-stage procedure consisting of an inner and an outer loop. In the inner loop, the initial parameters <math id="S3.p3.10.m10.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p3.10.m10.1a"><mi id="S3.p3.10.m10.1.1" xref="S3.p3.10.m10.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p3.10.m10.1b"><ci id="S3.p3.10.m10.1.1.cmml" xref="S3.p3.10.m10.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m10.1c">\omega</annotation></semantics></math> are adapted to each training task <math id="S3.p3.11.m11.1" class="ltx_Math" alttext="\mathcal{T}_{i}" display="inline"><semantics id="S3.p3.11.m11.1a"><msub id="S3.p3.11.m11.1.1" xref="S3.p3.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.11.m11.1.1.2" xref="S3.p3.11.m11.1.1.2.cmml">𝒯</mi><mi id="S3.p3.11.m11.1.1.3" xref="S3.p3.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.11.m11.1b"><apply id="S3.p3.11.m11.1.1.cmml" xref="S3.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p3.11.m11.1.1.1.cmml" xref="S3.p3.11.m11.1.1">subscript</csymbol><ci id="S3.p3.11.m11.1.1.2.cmml" xref="S3.p3.11.m11.1.1.2">𝒯</ci><ci id="S3.p3.11.m11.1.1.3.cmml" xref="S3.p3.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.m11.1c">\mathcal{T}_{i}</annotation></semantics></math> by taking a few gradient descents steps on the support set <math id="S3.p3.12.m12.3" class="ltx_Math" alttext="\mathcal{D}_{i}^{(sp)}\triangleq\{x_{k},y_{k}\}_{k=1}^{K}" display="inline"><semantics id="S3.p3.12.m12.3a"><mrow id="S3.p3.12.m12.3.3" xref="S3.p3.12.m12.3.3.cmml"><msubsup id="S3.p3.12.m12.3.3.4" xref="S3.p3.12.m12.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.12.m12.3.3.4.2.2" xref="S3.p3.12.m12.3.3.4.2.2.cmml">𝒟</mi><mi id="S3.p3.12.m12.3.3.4.2.3" xref="S3.p3.12.m12.3.3.4.2.3.cmml">i</mi><mrow id="S3.p3.12.m12.1.1.1.1" xref="S3.p3.12.m12.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p3.12.m12.1.1.1.1.2" xref="S3.p3.12.m12.1.1.1.1.1.cmml">(</mo><mrow id="S3.p3.12.m12.1.1.1.1.1" xref="S3.p3.12.m12.1.1.1.1.1.cmml"><mi id="S3.p3.12.m12.1.1.1.1.1.2" xref="S3.p3.12.m12.1.1.1.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p3.12.m12.1.1.1.1.1.1" xref="S3.p3.12.m12.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p3.12.m12.1.1.1.1.1.3" xref="S3.p3.12.m12.1.1.1.1.1.3.cmml">p</mi></mrow><mo stretchy="false" id="S3.p3.12.m12.1.1.1.1.3" xref="S3.p3.12.m12.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p3.12.m12.3.3.3" xref="S3.p3.12.m12.3.3.3.cmml">≜</mo><msubsup id="S3.p3.12.m12.3.3.2" xref="S3.p3.12.m12.3.3.2.cmml"><mrow id="S3.p3.12.m12.3.3.2.2.2.2" xref="S3.p3.12.m12.3.3.2.2.2.3.cmml"><mo stretchy="false" id="S3.p3.12.m12.3.3.2.2.2.2.3" xref="S3.p3.12.m12.3.3.2.2.2.3.cmml">{</mo><msub id="S3.p3.12.m12.2.2.1.1.1.1.1" xref="S3.p3.12.m12.2.2.1.1.1.1.1.cmml"><mi id="S3.p3.12.m12.2.2.1.1.1.1.1.2" xref="S3.p3.12.m12.2.2.1.1.1.1.1.2.cmml">x</mi><mi id="S3.p3.12.m12.2.2.1.1.1.1.1.3" xref="S3.p3.12.m12.2.2.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.p3.12.m12.3.3.2.2.2.2.4" xref="S3.p3.12.m12.3.3.2.2.2.3.cmml">,</mo><msub id="S3.p3.12.m12.3.3.2.2.2.2.2" xref="S3.p3.12.m12.3.3.2.2.2.2.2.cmml"><mi id="S3.p3.12.m12.3.3.2.2.2.2.2.2" xref="S3.p3.12.m12.3.3.2.2.2.2.2.2.cmml">y</mi><mi id="S3.p3.12.m12.3.3.2.2.2.2.2.3" xref="S3.p3.12.m12.3.3.2.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S3.p3.12.m12.3.3.2.2.2.2.5" xref="S3.p3.12.m12.3.3.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.p3.12.m12.3.3.2.2.4" xref="S3.p3.12.m12.3.3.2.2.4.cmml"><mi id="S3.p3.12.m12.3.3.2.2.4.2" xref="S3.p3.12.m12.3.3.2.2.4.2.cmml">k</mi><mo id="S3.p3.12.m12.3.3.2.2.4.1" xref="S3.p3.12.m12.3.3.2.2.4.1.cmml">=</mo><mn id="S3.p3.12.m12.3.3.2.2.4.3" xref="S3.p3.12.m12.3.3.2.2.4.3.cmml">1</mn></mrow><mi id="S3.p3.12.m12.3.3.2.4" xref="S3.p3.12.m12.3.3.2.4.cmml">K</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.12.m12.3b"><apply id="S3.p3.12.m12.3.3.cmml" xref="S3.p3.12.m12.3.3"><ci id="S3.p3.12.m12.3.3.3.cmml" xref="S3.p3.12.m12.3.3.3">≜</ci><apply id="S3.p3.12.m12.3.3.4.cmml" xref="S3.p3.12.m12.3.3.4"><csymbol cd="ambiguous" id="S3.p3.12.m12.3.3.4.1.cmml" xref="S3.p3.12.m12.3.3.4">superscript</csymbol><apply id="S3.p3.12.m12.3.3.4.2.cmml" xref="S3.p3.12.m12.3.3.4"><csymbol cd="ambiguous" id="S3.p3.12.m12.3.3.4.2.1.cmml" xref="S3.p3.12.m12.3.3.4">subscript</csymbol><ci id="S3.p3.12.m12.3.3.4.2.2.cmml" xref="S3.p3.12.m12.3.3.4.2.2">𝒟</ci><ci id="S3.p3.12.m12.3.3.4.2.3.cmml" xref="S3.p3.12.m12.3.3.4.2.3">𝑖</ci></apply><apply id="S3.p3.12.m12.1.1.1.1.1.cmml" xref="S3.p3.12.m12.1.1.1.1"><times id="S3.p3.12.m12.1.1.1.1.1.1.cmml" xref="S3.p3.12.m12.1.1.1.1.1.1"></times><ci id="S3.p3.12.m12.1.1.1.1.1.2.cmml" xref="S3.p3.12.m12.1.1.1.1.1.2">𝑠</ci><ci id="S3.p3.12.m12.1.1.1.1.1.3.cmml" xref="S3.p3.12.m12.1.1.1.1.1.3">𝑝</ci></apply></apply><apply id="S3.p3.12.m12.3.3.2.cmml" xref="S3.p3.12.m12.3.3.2"><csymbol cd="ambiguous" id="S3.p3.12.m12.3.3.2.3.cmml" xref="S3.p3.12.m12.3.3.2">superscript</csymbol><apply id="S3.p3.12.m12.3.3.2.2.cmml" xref="S3.p3.12.m12.3.3.2"><csymbol cd="ambiguous" id="S3.p3.12.m12.3.3.2.2.3.cmml" xref="S3.p3.12.m12.3.3.2">subscript</csymbol><set id="S3.p3.12.m12.3.3.2.2.2.3.cmml" xref="S3.p3.12.m12.3.3.2.2.2.2"><apply id="S3.p3.12.m12.2.2.1.1.1.1.1.cmml" xref="S3.p3.12.m12.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.12.m12.2.2.1.1.1.1.1.1.cmml" xref="S3.p3.12.m12.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.12.m12.2.2.1.1.1.1.1.2.cmml" xref="S3.p3.12.m12.2.2.1.1.1.1.1.2">𝑥</ci><ci id="S3.p3.12.m12.2.2.1.1.1.1.1.3.cmml" xref="S3.p3.12.m12.2.2.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.p3.12.m12.3.3.2.2.2.2.2.cmml" xref="S3.p3.12.m12.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.12.m12.3.3.2.2.2.2.2.1.cmml" xref="S3.p3.12.m12.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.p3.12.m12.3.3.2.2.2.2.2.2.cmml" xref="S3.p3.12.m12.3.3.2.2.2.2.2.2">𝑦</ci><ci id="S3.p3.12.m12.3.3.2.2.2.2.2.3.cmml" xref="S3.p3.12.m12.3.3.2.2.2.2.2.3">𝑘</ci></apply></set><apply id="S3.p3.12.m12.3.3.2.2.4.cmml" xref="S3.p3.12.m12.3.3.2.2.4"><eq id="S3.p3.12.m12.3.3.2.2.4.1.cmml" xref="S3.p3.12.m12.3.3.2.2.4.1"></eq><ci id="S3.p3.12.m12.3.3.2.2.4.2.cmml" xref="S3.p3.12.m12.3.3.2.2.4.2">𝑘</ci><cn type="integer" id="S3.p3.12.m12.3.3.2.2.4.3.cmml" xref="S3.p3.12.m12.3.3.2.2.4.3">1</cn></apply></apply><ci id="S3.p3.12.m12.3.3.2.4.cmml" xref="S3.p3.12.m12.3.3.2.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.12.m12.3c">\mathcal{D}_{i}^{(sp)}\triangleq\{x_{k},y_{k}\}_{k=1}^{K}</annotation></semantics></math>. This process results in task-specific parameters <math id="S3.p3.13.m13.1" class="ltx_Math" alttext="\omega^{\prime}_{i}" display="inline"><semantics id="S3.p3.13.m13.1a"><msubsup id="S3.p3.13.m13.1.1" xref="S3.p3.13.m13.1.1.cmml"><mi id="S3.p3.13.m13.1.1.2.2" xref="S3.p3.13.m13.1.1.2.2.cmml">ω</mi><mi id="S3.p3.13.m13.1.1.3" xref="S3.p3.13.m13.1.1.3.cmml">i</mi><mo id="S3.p3.13.m13.1.1.2.3" xref="S3.p3.13.m13.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.13.m13.1b"><apply id="S3.p3.13.m13.1.1.cmml" xref="S3.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.p3.13.m13.1.1.1.cmml" xref="S3.p3.13.m13.1.1">subscript</csymbol><apply id="S3.p3.13.m13.1.1.2.cmml" xref="S3.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.p3.13.m13.1.1.2.1.cmml" xref="S3.p3.13.m13.1.1">superscript</csymbol><ci id="S3.p3.13.m13.1.1.2.2.cmml" xref="S3.p3.13.m13.1.1.2.2">𝜔</ci><ci id="S3.p3.13.m13.1.1.2.3.cmml" xref="S3.p3.13.m13.1.1.2.3">′</ci></apply><ci id="S3.p3.13.m13.1.1.3.cmml" xref="S3.p3.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.13.m13.1c">\omega^{\prime}_{i}</annotation></semantics></math>, as illustrated in Eq. <a href="#S3.E2" title="In 3 Background and Notation ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> when a single gradient step is used:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3.2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\omega^{\prime}_{i}=\omega-\alpha\nabla_{\omega}\mathcal{L}_{\mathcal{D}_{i}^{(sp)}}(f_{\omega})." display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><msubsup id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.3.2.2.cmml">ω</mi><mi id="S3.E2.m1.2.2.1.1.3.3" xref="S3.E2.m1.2.2.1.1.3.3.cmml">i</mi><mo id="S3.E2.m1.2.2.1.1.3.2.3" xref="S3.E2.m1.2.2.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml">ω</mi><mo id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml">−</mo><mrow id="S3.E2.m1.2.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.3.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.4" xref="S3.E2.m1.2.2.1.1.1.1.4.cmml"><msub id="S3.E2.m1.2.2.1.1.1.1.4.1" xref="S3.E2.m1.2.2.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S3.E2.m1.2.2.1.1.1.1.4.1.2" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2.cmml">∇</mo><mi id="S3.E2.m1.2.2.1.1.1.1.4.1.3" xref="S3.E2.m1.2.2.1.1.1.1.4.1.3.cmml">ω</mi></msub><msub id="S3.E2.m1.2.2.1.1.1.1.4.2" xref="S3.E2.m1.2.2.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.1.1.1.1.4.2.2" xref="S3.E2.m1.2.2.1.1.1.1.4.2.2.cmml">ℒ</mi><msubsup id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.3.2.cmml">𝒟</mi><mi id="S3.E2.m1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.3.3.cmml">i</mi><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.cmml">p</mi></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.1.1.2a" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml">f</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml">ω</mi></msub><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2"></eq><apply id="S3.E2.m1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2.2">𝜔</ci><ci id="S3.E2.m1.2.2.1.1.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.2.3">′</ci></apply><ci id="S3.E2.m1.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><minus id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2"></minus><ci id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3">𝜔</ci><apply id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1"><times id="S3.E2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2"></times><ci id="S3.E2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3">𝛼</ci><apply id="S3.E2.m1.2.2.1.1.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4"><apply id="S3.E2.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.4.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.4.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1.2">∇</ci><ci id="S3.E2.m1.2.2.1.1.1.1.4.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.1.3">𝜔</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.4.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.4.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.4.2.2">ℒ</ci><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.3.2">𝒟</ci><ci id="S3.E2.m1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3">𝑝</ci></apply></apply></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.3">𝜔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\omega^{\prime}_{i}=\omega-\alpha\nabla_{\omega}\mathcal{L}_{\mathcal{D}_{i}^{(sp)}}(f_{\omega}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.p3.17" class="ltx_p">The initial parameters <math id="S3.p3.14.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p3.14.m1.1a"><mi id="S3.p3.14.m1.1.1" xref="S3.p3.14.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p3.14.m1.1b"><ci id="S3.p3.14.m1.1.1.cmml" xref="S3.p3.14.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.14.m1.1c">\omega</annotation></semantics></math> are then optimized in the outer loop by minimizing the loss achieved by the task-specific parameters <math id="S3.p3.15.m2.1" class="ltx_Math" alttext="\omega^{\prime}_{i}" display="inline"><semantics id="S3.p3.15.m2.1a"><msubsup id="S3.p3.15.m2.1.1" xref="S3.p3.15.m2.1.1.cmml"><mi id="S3.p3.15.m2.1.1.2.2" xref="S3.p3.15.m2.1.1.2.2.cmml">ω</mi><mi id="S3.p3.15.m2.1.1.3" xref="S3.p3.15.m2.1.1.3.cmml">i</mi><mo id="S3.p3.15.m2.1.1.2.3" xref="S3.p3.15.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.15.m2.1b"><apply id="S3.p3.15.m2.1.1.cmml" xref="S3.p3.15.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.15.m2.1.1.1.cmml" xref="S3.p3.15.m2.1.1">subscript</csymbol><apply id="S3.p3.15.m2.1.1.2.cmml" xref="S3.p3.15.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.15.m2.1.1.2.1.cmml" xref="S3.p3.15.m2.1.1">superscript</csymbol><ci id="S3.p3.15.m2.1.1.2.2.cmml" xref="S3.p3.15.m2.1.1.2.2">𝜔</ci><ci id="S3.p3.15.m2.1.1.2.3.cmml" xref="S3.p3.15.m2.1.1.2.3">′</ci></apply><ci id="S3.p3.15.m2.1.1.3.cmml" xref="S3.p3.15.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.15.m2.1c">\omega^{\prime}_{i}</annotation></semantics></math> on the query set <math id="S3.p3.16.m3.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{(qr)}" display="inline"><semantics id="S3.p3.16.m3.1a"><msubsup id="S3.p3.16.m3.1.2" xref="S3.p3.16.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.16.m3.1.2.2.2" xref="S3.p3.16.m3.1.2.2.2.cmml">𝒟</mi><mi id="S3.p3.16.m3.1.2.2.3" xref="S3.p3.16.m3.1.2.2.3.cmml">i</mi><mrow id="S3.p3.16.m3.1.1.1.1" xref="S3.p3.16.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p3.16.m3.1.1.1.1.2" xref="S3.p3.16.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.p3.16.m3.1.1.1.1.1" xref="S3.p3.16.m3.1.1.1.1.1.cmml"><mi id="S3.p3.16.m3.1.1.1.1.1.2" xref="S3.p3.16.m3.1.1.1.1.1.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.p3.16.m3.1.1.1.1.1.1" xref="S3.p3.16.m3.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p3.16.m3.1.1.1.1.1.3" xref="S3.p3.16.m3.1.1.1.1.1.3.cmml">r</mi></mrow><mo stretchy="false" id="S3.p3.16.m3.1.1.1.1.3" xref="S3.p3.16.m3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.16.m3.1b"><apply id="S3.p3.16.m3.1.2.cmml" xref="S3.p3.16.m3.1.2"><csymbol cd="ambiguous" id="S3.p3.16.m3.1.2.1.cmml" xref="S3.p3.16.m3.1.2">superscript</csymbol><apply id="S3.p3.16.m3.1.2.2.cmml" xref="S3.p3.16.m3.1.2"><csymbol cd="ambiguous" id="S3.p3.16.m3.1.2.2.1.cmml" xref="S3.p3.16.m3.1.2">subscript</csymbol><ci id="S3.p3.16.m3.1.2.2.2.cmml" xref="S3.p3.16.m3.1.2.2.2">𝒟</ci><ci id="S3.p3.16.m3.1.2.2.3.cmml" xref="S3.p3.16.m3.1.2.2.3">𝑖</ci></apply><apply id="S3.p3.16.m3.1.1.1.1.1.cmml" xref="S3.p3.16.m3.1.1.1.1"><times id="S3.p3.16.m3.1.1.1.1.1.1.cmml" xref="S3.p3.16.m3.1.1.1.1.1.1"></times><ci id="S3.p3.16.m3.1.1.1.1.1.2.cmml" xref="S3.p3.16.m3.1.1.1.1.1.2">𝑞</ci><ci id="S3.p3.16.m3.1.1.1.1.1.3.cmml" xref="S3.p3.16.m3.1.1.1.1.1.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.16.m3.1c">\mathcal{D}_{i}^{(qr)}</annotation></semantics></math> of the same task <math id="S3.p3.17.m4.1" class="ltx_Math" alttext="\mathcal{T}_{i}" display="inline"><semantics id="S3.p3.17.m4.1a"><msub id="S3.p3.17.m4.1.1" xref="S3.p3.17.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.17.m4.1.1.2" xref="S3.p3.17.m4.1.1.2.cmml">𝒯</mi><mi id="S3.p3.17.m4.1.1.3" xref="S3.p3.17.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.17.m4.1b"><apply id="S3.p3.17.m4.1.1.cmml" xref="S3.p3.17.m4.1.1"><csymbol cd="ambiguous" id="S3.p3.17.m4.1.1.1.cmml" xref="S3.p3.17.m4.1.1">subscript</csymbol><ci id="S3.p3.17.m4.1.1.2.cmml" xref="S3.p3.17.m4.1.1.2">𝒯</ci><ci id="S3.p3.17.m4.1.1.3.cmml" xref="S3.p3.17.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.17.m4.1c">\mathcal{T}_{i}</annotation></semantics></math>. This is shown in Eq. <a href="#S3.E3" title="In 3 Background and Notation ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3.3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.3" class="ltx_Math" alttext="\omega\leftarrow\omega-\beta\nabla_{\omega}\sum_{\mathcal{T}_{i}\sim\textnormal{P}(\mathcal{T})}\mathcal{L}_{\mathcal{D}_{i}^{(qr)}}(f_{\omega^{\prime}_{i}})." display="block"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml">ω</mi><mo stretchy="false" id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml">←</mo><mrow id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.3.cmml">ω</mi><mo id="S3.E3.m1.3.3.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.2.cmml">−</mo><mrow id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.3.cmml">β</mi><mo lspace="0.167em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.2.cmml">​</mo><msub id="S3.E3.m1.3.3.1.1.1.1.4" xref="S3.E3.m1.3.3.1.1.1.1.4.cmml"><mo id="S3.E3.m1.3.3.1.1.1.1.4.2" xref="S3.E3.m1.3.3.1.1.1.1.4.2.cmml">∇</mo><mi id="S3.E3.m1.3.3.1.1.1.1.4.3" xref="S3.E3.m1.3.3.1.1.1.1.4.3.cmml">ω</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.2a" xref="S3.E3.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.cmml"><munder id="S3.E3.m1.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E3.m1.3.3.1.1.1.1.1.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.3.2.cmml">𝒯</mi><mi id="S3.E3.m1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">∼</mo><mrow id="S3.E3.m1.1.1.1.4" xref="S3.E3.m1.1.1.1.4.cmml"><mtext id="S3.E3.m1.1.1.1.4.2" xref="S3.E3.m1.1.1.1.4.2a.cmml">P</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.4.1" xref="S3.E3.m1.1.1.1.4.1.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.4.3.2" xref="S3.E3.m1.1.1.1.4.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.4.3.2.1" xref="S3.E3.m1.1.1.1.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">𝒯</mi><mo stretchy="false" id="S3.E3.m1.1.1.1.4.3.2.2" xref="S3.E3.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml">ℒ</mi><msubsup id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.1.3.2" xref="S3.E3.m1.2.2.1.3.2.cmml">𝒟</mi><mi id="S3.E3.m1.2.2.1.3.3" xref="S3.E3.m1.2.2.1.3.3.cmml">i</mi><mrow id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.3.cmml">r</mi></mrow><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></msubsup></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">f</mi><msubsup id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.cmml">ω</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup></msub><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1"><ci id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2">←</ci><ci id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3">𝜔</ci><apply id="S3.E3.m1.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1"><minus id="S3.E3.m1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.2"></minus><ci id="S3.E3.m1.3.3.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3">𝜔</ci><apply id="S3.E3.m1.3.3.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1"><times id="S3.E3.m1.3.3.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.2"></times><ci id="S3.E3.m1.3.3.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.3">𝛽</ci><apply id="S3.E3.m1.3.3.1.1.1.1.4.cmml" xref="S3.E3.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.4.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.4.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.4.2">∇</ci><ci id="S3.E3.m1.3.3.1.1.1.1.4.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.4.3">𝜔</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1"><apply id="S3.E3.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E3.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.2.2"></sum><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2">similar-to</csymbol><apply id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.3.2">𝒯</ci><ci id="S3.E3.m1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.4"><times id="S3.E3.m1.1.1.1.4.1.cmml" xref="S3.E3.m1.1.1.1.4.1"></times><ci id="S3.E3.m1.1.1.1.4.2a.cmml" xref="S3.E3.m1.1.1.1.4.2"><mtext mathsize="70%" id="S3.E3.m1.1.1.1.4.2.cmml" xref="S3.E3.m1.1.1.1.4.2">P</mtext></ci><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝒯</ci></apply></apply></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1"><times id="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2"></times><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.2">ℒ</ci><apply id="S3.E3.m1.2.2.1.cmml" xref="S3.E3.m1.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1">superscript</csymbol><apply id="S3.E3.m1.2.2.1.3.cmml" xref="S3.E3.m1.2.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.3.1.cmml" xref="S3.E3.m1.2.2.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.3.2.cmml" xref="S3.E3.m1.2.2.1.3.2">𝒟</ci><ci id="S3.E3.m1.2.2.1.3.3.cmml" xref="S3.E3.m1.2.2.1.3.3">𝑖</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1"></times><ci id="S3.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2">𝑞</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.3">𝑟</ci></apply></apply></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑓</ci><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2">𝜔</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\omega\leftarrow\omega-\beta\nabla_{\omega}\sum_{\mathcal{T}_{i}\sim\textnormal{P}(\mathcal{T})}\mathcal{L}_{\mathcal{D}_{i}^{(qr)}}(f_{\omega^{\prime}_{i}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.p3.22" class="ltx_p">The result is a model initialization <math id="S3.p3.18.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p3.18.m1.1a"><mi id="S3.p3.18.m1.1.1" xref="S3.p3.18.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p3.18.m1.1b"><ci id="S3.p3.18.m1.1.1.cmml" xref="S3.p3.18.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.18.m1.1c">\omega</annotation></semantics></math> that performs well when updated with a few training examples <math id="S3.p3.19.m2.3" class="ltx_Math" alttext="\mathcal{D}_{new}^{(sp)}\triangleq\{x_{k},y_{k}\}_{k=1}^{K}" display="inline"><semantics id="S3.p3.19.m2.3a"><mrow id="S3.p3.19.m2.3.3" xref="S3.p3.19.m2.3.3.cmml"><msubsup id="S3.p3.19.m2.3.3.4" xref="S3.p3.19.m2.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.19.m2.3.3.4.2.2" xref="S3.p3.19.m2.3.3.4.2.2.cmml">𝒟</mi><mrow id="S3.p3.19.m2.3.3.4.2.3" xref="S3.p3.19.m2.3.3.4.2.3.cmml"><mi id="S3.p3.19.m2.3.3.4.2.3.2" xref="S3.p3.19.m2.3.3.4.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p3.19.m2.3.3.4.2.3.1" xref="S3.p3.19.m2.3.3.4.2.3.1.cmml">​</mo><mi id="S3.p3.19.m2.3.3.4.2.3.3" xref="S3.p3.19.m2.3.3.4.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p3.19.m2.3.3.4.2.3.1a" xref="S3.p3.19.m2.3.3.4.2.3.1.cmml">​</mo><mi id="S3.p3.19.m2.3.3.4.2.3.4" xref="S3.p3.19.m2.3.3.4.2.3.4.cmml">w</mi></mrow><mrow id="S3.p3.19.m2.1.1.1.1" xref="S3.p3.19.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p3.19.m2.1.1.1.1.2" xref="S3.p3.19.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.p3.19.m2.1.1.1.1.1" xref="S3.p3.19.m2.1.1.1.1.1.cmml"><mi id="S3.p3.19.m2.1.1.1.1.1.2" xref="S3.p3.19.m2.1.1.1.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p3.19.m2.1.1.1.1.1.1" xref="S3.p3.19.m2.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p3.19.m2.1.1.1.1.1.3" xref="S3.p3.19.m2.1.1.1.1.1.3.cmml">p</mi></mrow><mo stretchy="false" id="S3.p3.19.m2.1.1.1.1.3" xref="S3.p3.19.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p3.19.m2.3.3.3" xref="S3.p3.19.m2.3.3.3.cmml">≜</mo><msubsup id="S3.p3.19.m2.3.3.2" xref="S3.p3.19.m2.3.3.2.cmml"><mrow id="S3.p3.19.m2.3.3.2.2.2.2" xref="S3.p3.19.m2.3.3.2.2.2.3.cmml"><mo stretchy="false" id="S3.p3.19.m2.3.3.2.2.2.2.3" xref="S3.p3.19.m2.3.3.2.2.2.3.cmml">{</mo><msub id="S3.p3.19.m2.2.2.1.1.1.1.1" xref="S3.p3.19.m2.2.2.1.1.1.1.1.cmml"><mi id="S3.p3.19.m2.2.2.1.1.1.1.1.2" xref="S3.p3.19.m2.2.2.1.1.1.1.1.2.cmml">x</mi><mi id="S3.p3.19.m2.2.2.1.1.1.1.1.3" xref="S3.p3.19.m2.2.2.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.p3.19.m2.3.3.2.2.2.2.4" xref="S3.p3.19.m2.3.3.2.2.2.3.cmml">,</mo><msub id="S3.p3.19.m2.3.3.2.2.2.2.2" xref="S3.p3.19.m2.3.3.2.2.2.2.2.cmml"><mi id="S3.p3.19.m2.3.3.2.2.2.2.2.2" xref="S3.p3.19.m2.3.3.2.2.2.2.2.2.cmml">y</mi><mi id="S3.p3.19.m2.3.3.2.2.2.2.2.3" xref="S3.p3.19.m2.3.3.2.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S3.p3.19.m2.3.3.2.2.2.2.5" xref="S3.p3.19.m2.3.3.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.p3.19.m2.3.3.2.2.4" xref="S3.p3.19.m2.3.3.2.2.4.cmml"><mi id="S3.p3.19.m2.3.3.2.2.4.2" xref="S3.p3.19.m2.3.3.2.2.4.2.cmml">k</mi><mo id="S3.p3.19.m2.3.3.2.2.4.1" xref="S3.p3.19.m2.3.3.2.2.4.1.cmml">=</mo><mn id="S3.p3.19.m2.3.3.2.2.4.3" xref="S3.p3.19.m2.3.3.2.2.4.3.cmml">1</mn></mrow><mi id="S3.p3.19.m2.3.3.2.4" xref="S3.p3.19.m2.3.3.2.4.cmml">K</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.19.m2.3b"><apply id="S3.p3.19.m2.3.3.cmml" xref="S3.p3.19.m2.3.3"><ci id="S3.p3.19.m2.3.3.3.cmml" xref="S3.p3.19.m2.3.3.3">≜</ci><apply id="S3.p3.19.m2.3.3.4.cmml" xref="S3.p3.19.m2.3.3.4"><csymbol cd="ambiguous" id="S3.p3.19.m2.3.3.4.1.cmml" xref="S3.p3.19.m2.3.3.4">superscript</csymbol><apply id="S3.p3.19.m2.3.3.4.2.cmml" xref="S3.p3.19.m2.3.3.4"><csymbol cd="ambiguous" id="S3.p3.19.m2.3.3.4.2.1.cmml" xref="S3.p3.19.m2.3.3.4">subscript</csymbol><ci id="S3.p3.19.m2.3.3.4.2.2.cmml" xref="S3.p3.19.m2.3.3.4.2.2">𝒟</ci><apply id="S3.p3.19.m2.3.3.4.2.3.cmml" xref="S3.p3.19.m2.3.3.4.2.3"><times id="S3.p3.19.m2.3.3.4.2.3.1.cmml" xref="S3.p3.19.m2.3.3.4.2.3.1"></times><ci id="S3.p3.19.m2.3.3.4.2.3.2.cmml" xref="S3.p3.19.m2.3.3.4.2.3.2">𝑛</ci><ci id="S3.p3.19.m2.3.3.4.2.3.3.cmml" xref="S3.p3.19.m2.3.3.4.2.3.3">𝑒</ci><ci id="S3.p3.19.m2.3.3.4.2.3.4.cmml" xref="S3.p3.19.m2.3.3.4.2.3.4">𝑤</ci></apply></apply><apply id="S3.p3.19.m2.1.1.1.1.1.cmml" xref="S3.p3.19.m2.1.1.1.1"><times id="S3.p3.19.m2.1.1.1.1.1.1.cmml" xref="S3.p3.19.m2.1.1.1.1.1.1"></times><ci id="S3.p3.19.m2.1.1.1.1.1.2.cmml" xref="S3.p3.19.m2.1.1.1.1.1.2">𝑠</ci><ci id="S3.p3.19.m2.1.1.1.1.1.3.cmml" xref="S3.p3.19.m2.1.1.1.1.1.3">𝑝</ci></apply></apply><apply id="S3.p3.19.m2.3.3.2.cmml" xref="S3.p3.19.m2.3.3.2"><csymbol cd="ambiguous" id="S3.p3.19.m2.3.3.2.3.cmml" xref="S3.p3.19.m2.3.3.2">superscript</csymbol><apply id="S3.p3.19.m2.3.3.2.2.cmml" xref="S3.p3.19.m2.3.3.2"><csymbol cd="ambiguous" id="S3.p3.19.m2.3.3.2.2.3.cmml" xref="S3.p3.19.m2.3.3.2">subscript</csymbol><set id="S3.p3.19.m2.3.3.2.2.2.3.cmml" xref="S3.p3.19.m2.3.3.2.2.2.2"><apply id="S3.p3.19.m2.2.2.1.1.1.1.1.cmml" xref="S3.p3.19.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.19.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.p3.19.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.19.m2.2.2.1.1.1.1.1.2.cmml" xref="S3.p3.19.m2.2.2.1.1.1.1.1.2">𝑥</ci><ci id="S3.p3.19.m2.2.2.1.1.1.1.1.3.cmml" xref="S3.p3.19.m2.2.2.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.p3.19.m2.3.3.2.2.2.2.2.cmml" xref="S3.p3.19.m2.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.19.m2.3.3.2.2.2.2.2.1.cmml" xref="S3.p3.19.m2.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.p3.19.m2.3.3.2.2.2.2.2.2.cmml" xref="S3.p3.19.m2.3.3.2.2.2.2.2.2">𝑦</ci><ci id="S3.p3.19.m2.3.3.2.2.2.2.2.3.cmml" xref="S3.p3.19.m2.3.3.2.2.2.2.2.3">𝑘</ci></apply></set><apply id="S3.p3.19.m2.3.3.2.2.4.cmml" xref="S3.p3.19.m2.3.3.2.2.4"><eq id="S3.p3.19.m2.3.3.2.2.4.1.cmml" xref="S3.p3.19.m2.3.3.2.2.4.1"></eq><ci id="S3.p3.19.m2.3.3.2.2.4.2.cmml" xref="S3.p3.19.m2.3.3.2.2.4.2">𝑘</ci><cn type="integer" id="S3.p3.19.m2.3.3.2.2.4.3.cmml" xref="S3.p3.19.m2.3.3.2.2.4.3">1</cn></apply></apply><ci id="S3.p3.19.m2.3.3.2.4.cmml" xref="S3.p3.19.m2.3.3.2.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.19.m2.3c">\mathcal{D}_{new}^{(sp)}\triangleq\{x_{k},y_{k}\}_{k=1}^{K}</annotation></semantics></math> from a new task <math id="S3.p3.20.m3.1" class="ltx_Math" alttext="\mathcal{T}_{new}" display="inline"><semantics id="S3.p3.20.m3.1a"><msub id="S3.p3.20.m3.1.1" xref="S3.p3.20.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.20.m3.1.1.2" xref="S3.p3.20.m3.1.1.2.cmml">𝒯</mi><mrow id="S3.p3.20.m3.1.1.3" xref="S3.p3.20.m3.1.1.3.cmml"><mi id="S3.p3.20.m3.1.1.3.2" xref="S3.p3.20.m3.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p3.20.m3.1.1.3.1" xref="S3.p3.20.m3.1.1.3.1.cmml">​</mo><mi id="S3.p3.20.m3.1.1.3.3" xref="S3.p3.20.m3.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p3.20.m3.1.1.3.1a" xref="S3.p3.20.m3.1.1.3.1.cmml">​</mo><mi id="S3.p3.20.m3.1.1.3.4" xref="S3.p3.20.m3.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p3.20.m3.1b"><apply id="S3.p3.20.m3.1.1.cmml" xref="S3.p3.20.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.20.m3.1.1.1.cmml" xref="S3.p3.20.m3.1.1">subscript</csymbol><ci id="S3.p3.20.m3.1.1.2.cmml" xref="S3.p3.20.m3.1.1.2">𝒯</ci><apply id="S3.p3.20.m3.1.1.3.cmml" xref="S3.p3.20.m3.1.1.3"><times id="S3.p3.20.m3.1.1.3.1.cmml" xref="S3.p3.20.m3.1.1.3.1"></times><ci id="S3.p3.20.m3.1.1.3.2.cmml" xref="S3.p3.20.m3.1.1.3.2">𝑛</ci><ci id="S3.p3.20.m3.1.1.3.3.cmml" xref="S3.p3.20.m3.1.1.3.3">𝑒</ci><ci id="S3.p3.20.m3.1.1.3.4.cmml" xref="S3.p3.20.m3.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.20.m3.1c">\mathcal{T}_{new}</annotation></semantics></math>. The goal is to train the model on <math id="S3.p3.21.m4.1" class="ltx_Math" alttext="\mathcal{D}_{new}^{(sp)}" display="inline"><semantics id="S3.p3.21.m4.1a"><msubsup id="S3.p3.21.m4.1.2" xref="S3.p3.21.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.21.m4.1.2.2.2" xref="S3.p3.21.m4.1.2.2.2.cmml">𝒟</mi><mrow id="S3.p3.21.m4.1.2.2.3" xref="S3.p3.21.m4.1.2.2.3.cmml"><mi id="S3.p3.21.m4.1.2.2.3.2" xref="S3.p3.21.m4.1.2.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p3.21.m4.1.2.2.3.1" xref="S3.p3.21.m4.1.2.2.3.1.cmml">​</mo><mi id="S3.p3.21.m4.1.2.2.3.3" xref="S3.p3.21.m4.1.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p3.21.m4.1.2.2.3.1a" xref="S3.p3.21.m4.1.2.2.3.1.cmml">​</mo><mi id="S3.p3.21.m4.1.2.2.3.4" xref="S3.p3.21.m4.1.2.2.3.4.cmml">w</mi></mrow><mrow id="S3.p3.21.m4.1.1.1.1" xref="S3.p3.21.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p3.21.m4.1.1.1.1.2" xref="S3.p3.21.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.p3.21.m4.1.1.1.1.1" xref="S3.p3.21.m4.1.1.1.1.1.cmml"><mi id="S3.p3.21.m4.1.1.1.1.1.2" xref="S3.p3.21.m4.1.1.1.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p3.21.m4.1.1.1.1.1.1" xref="S3.p3.21.m4.1.1.1.1.1.1.cmml">​</mo><mi id="S3.p3.21.m4.1.1.1.1.1.3" xref="S3.p3.21.m4.1.1.1.1.1.3.cmml">p</mi></mrow><mo stretchy="false" id="S3.p3.21.m4.1.1.1.1.3" xref="S3.p3.21.m4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.21.m4.1b"><apply id="S3.p3.21.m4.1.2.cmml" xref="S3.p3.21.m4.1.2"><csymbol cd="ambiguous" id="S3.p3.21.m4.1.2.1.cmml" xref="S3.p3.21.m4.1.2">superscript</csymbol><apply id="S3.p3.21.m4.1.2.2.cmml" xref="S3.p3.21.m4.1.2"><csymbol cd="ambiguous" id="S3.p3.21.m4.1.2.2.1.cmml" xref="S3.p3.21.m4.1.2">subscript</csymbol><ci id="S3.p3.21.m4.1.2.2.2.cmml" xref="S3.p3.21.m4.1.2.2.2">𝒟</ci><apply id="S3.p3.21.m4.1.2.2.3.cmml" xref="S3.p3.21.m4.1.2.2.3"><times id="S3.p3.21.m4.1.2.2.3.1.cmml" xref="S3.p3.21.m4.1.2.2.3.1"></times><ci id="S3.p3.21.m4.1.2.2.3.2.cmml" xref="S3.p3.21.m4.1.2.2.3.2">𝑛</ci><ci id="S3.p3.21.m4.1.2.2.3.3.cmml" xref="S3.p3.21.m4.1.2.2.3.3">𝑒</ci><ci id="S3.p3.21.m4.1.2.2.3.4.cmml" xref="S3.p3.21.m4.1.2.2.3.4">𝑤</ci></apply></apply><apply id="S3.p3.21.m4.1.1.1.1.1.cmml" xref="S3.p3.21.m4.1.1.1.1"><times id="S3.p3.21.m4.1.1.1.1.1.1.cmml" xref="S3.p3.21.m4.1.1.1.1.1.1"></times><ci id="S3.p3.21.m4.1.1.1.1.1.2.cmml" xref="S3.p3.21.m4.1.1.1.1.1.2">𝑠</ci><ci id="S3.p3.21.m4.1.1.1.1.1.3.cmml" xref="S3.p3.21.m4.1.1.1.1.1.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.21.m4.1c">\mathcal{D}_{new}^{(sp)}</annotation></semantics></math> while leveraging the previous knowledge acquired during meta-training in order to achieve good generalization performance on new unlabeled test examples from <math id="S3.p3.22.m5.1" class="ltx_Math" alttext="\mathcal{T}_{new}" display="inline"><semantics id="S3.p3.22.m5.1a"><msub id="S3.p3.22.m5.1.1" xref="S3.p3.22.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.22.m5.1.1.2" xref="S3.p3.22.m5.1.1.2.cmml">𝒯</mi><mrow id="S3.p3.22.m5.1.1.3" xref="S3.p3.22.m5.1.1.3.cmml"><mi id="S3.p3.22.m5.1.1.3.2" xref="S3.p3.22.m5.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p3.22.m5.1.1.3.1" xref="S3.p3.22.m5.1.1.3.1.cmml">​</mo><mi id="S3.p3.22.m5.1.1.3.3" xref="S3.p3.22.m5.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p3.22.m5.1.1.3.1a" xref="S3.p3.22.m5.1.1.3.1.cmml">​</mo><mi id="S3.p3.22.m5.1.1.3.4" xref="S3.p3.22.m5.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p3.22.m5.1b"><apply id="S3.p3.22.m5.1.1.cmml" xref="S3.p3.22.m5.1.1"><csymbol cd="ambiguous" id="S3.p3.22.m5.1.1.1.cmml" xref="S3.p3.22.m5.1.1">subscript</csymbol><ci id="S3.p3.22.m5.1.1.2.cmml" xref="S3.p3.22.m5.1.1.2">𝒯</ci><apply id="S3.p3.22.m5.1.1.3.cmml" xref="S3.p3.22.m5.1.1.3"><times id="S3.p3.22.m5.1.1.3.1.cmml" xref="S3.p3.22.m5.1.1.3.1"></times><ci id="S3.p3.22.m5.1.1.3.2.cmml" xref="S3.p3.22.m5.1.1.3.2">𝑛</ci><ci id="S3.p3.22.m5.1.1.3.3.cmml" xref="S3.p3.22.m5.1.1.3.3">𝑒</ci><ci id="S3.p3.22.m5.1.1.3.4.cmml" xref="S3.p3.22.m5.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.22.m5.1c">\mathcal{T}_{new}</annotation></semantics></math>.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.3" class="ltx_p">As suggested in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx16" title="" class="ltx_ref">16</a>, <a href="#bib.bibx9" title="" class="ltx_ref">9</a>]</cite>, optimization-based meta-learning algorithms, such as MAML, bear relevance to the PFL setting due to the inherent heterogeneity present both in tasks (for meta-learning) and in clients (for federated learning). While MAML assumes access to only a few labeled data from a new task at test time, PFL does not have this constraint. Consequently, an estimation of the empirical loss (in Equations <a href="#S3.E2" title="In 3 Background and Notation ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> and <a href="#S3.E3" title="In 3 Background and Notation ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>) can be computed using independent batches of data (e.g., <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{\prime}" display="inline"><semantics id="S3.p4.1.m1.1a"><msubsup id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.1.m1.1.1.2.2" xref="S3.p4.1.m1.1.1.2.2.cmml">𝒟</mi><mi id="S3.p4.1.m1.1.1.2.3" xref="S3.p4.1.m1.1.1.2.3.cmml">i</mi><mo id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1">superscript</csymbol><apply id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.2.1.cmml" xref="S3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.p4.1.m1.1.1.2.2.cmml" xref="S3.p4.1.m1.1.1.2.2">𝒟</ci><ci id="S3.p4.1.m1.1.1.2.3.cmml" xref="S3.p4.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">\mathcal{D}_{i}^{\prime}</annotation></semantics></math>, <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{\prime\prime}" display="inline"><semantics id="S3.p4.2.m2.1a"><msubsup id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.2.m2.1.1.2.2" xref="S3.p4.2.m2.1.1.2.2.cmml">𝒟</mi><mi id="S3.p4.2.m2.1.1.2.3" xref="S3.p4.2.m2.1.1.2.3.cmml">i</mi><mo id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml">′′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1">superscript</csymbol><apply id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.2.1.cmml" xref="S3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.p4.2.m2.1.1.2.2.cmml" xref="S3.p4.2.m2.1.1.2.2">𝒟</ci><ci id="S3.p4.2.m2.1.1.2.3.cmml" xref="S3.p4.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3">′′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\mathcal{D}_{i}^{\prime\prime}</annotation></semantics></math>, etc.) that belongs to <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.p4.3.m3.1a"><msub id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">𝒟</mi><mi id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1">subscript</csymbol><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝒟</ci><ci id="S3.p4.3.m3.1.1.3.cmml" xref="S3.p4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">\mathcal{D}_{i}</annotation></semantics></math>, as suggested in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx9" title="" class="ltx_ref">9</a>]</cite>.
By incorporating the MAML formulation into PFL, the objective of PFL shifts towards finding a model initialization shared among all clients that performs well once each client updates it based on the loss function computed with their own local data.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Proposed approach</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.4" class="ltx_p">In this section, we present our proposed <em id="S4.p1.4.1" class="ltx_emph ltx_font_italic">CAFeMe</em> approach in detail. The aim is to improve the performance and scalability of the PFL framework by leveraging meta-learning techniques and extracting contextual information from each client’s local data. To achieve this, we introduce a federated modulator network <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="g_{\mu}" display="inline"><semantics id="S4.p1.1.m1.1a"><msub id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml"><mi id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">g</mi><mi id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">μ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.p1.1.m1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.2">𝑔</ci><ci id="S4.p1.1.m1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">g_{\mu}</annotation></semantics></math> followed by a base network <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="f_{\psi}" display="inline"><semantics id="S4.p1.2.m2.1a"><msub id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">f</mi><mi id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">𝑓</ci><ci id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">f_{\psi}</annotation></semantics></math>, as shown in Figure <a href="#S4.F1" title="Figure 1 ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We define the complete set of model parameters encompassing both the modulator and the base network as <math id="S4.p1.3.m3.2" class="ltx_Math" alttext="\omega=\{\mu,\psi\}" display="inline"><semantics id="S4.p1.3.m3.2a"><mrow id="S4.p1.3.m3.2.3" xref="S4.p1.3.m3.2.3.cmml"><mi id="S4.p1.3.m3.2.3.2" xref="S4.p1.3.m3.2.3.2.cmml">ω</mi><mo id="S4.p1.3.m3.2.3.1" xref="S4.p1.3.m3.2.3.1.cmml">=</mo><mrow id="S4.p1.3.m3.2.3.3.2" xref="S4.p1.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S4.p1.3.m3.2.3.3.2.1" xref="S4.p1.3.m3.2.3.3.1.cmml">{</mo><mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">μ</mi><mo id="S4.p1.3.m3.2.3.3.2.2" xref="S4.p1.3.m3.2.3.3.1.cmml">,</mo><mi id="S4.p1.3.m3.2.2" xref="S4.p1.3.m3.2.2.cmml">ψ</mi><mo stretchy="false" id="S4.p1.3.m3.2.3.3.2.3" xref="S4.p1.3.m3.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.2b"><apply id="S4.p1.3.m3.2.3.cmml" xref="S4.p1.3.m3.2.3"><eq id="S4.p1.3.m3.2.3.1.cmml" xref="S4.p1.3.m3.2.3.1"></eq><ci id="S4.p1.3.m3.2.3.2.cmml" xref="S4.p1.3.m3.2.3.2">𝜔</ci><set id="S4.p1.3.m3.2.3.3.1.cmml" xref="S4.p1.3.m3.2.3.3.2"><ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">𝜇</ci><ci id="S4.p1.3.m3.2.2.cmml" xref="S4.p1.3.m3.2.2">𝜓</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.2c">\omega=\{\mu,\psi\}</annotation></semantics></math>. Additionally, we incorporate <em id="S4.p1.4.2" class="ltx_emph ltx_font_italic">modulation layers</em> in the base network to enable efficient personalization to each client’s local dataset. These layers aim to condition the base network <math id="S4.p1.4.m4.1" class="ltx_Math" alttext="f_{\psi}" display="inline"><semantics id="S4.p1.4.m4.1a"><msub id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml"><mi id="S4.p1.4.m4.1.1.2" xref="S4.p1.4.m4.1.1.2.cmml">f</mi><mi id="S4.p1.4.m4.1.1.3" xref="S4.p1.4.m4.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><apply id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p1.4.m4.1.1.1.cmml" xref="S4.p1.4.m4.1.1">subscript</csymbol><ci id="S4.p1.4.m4.1.1.2.cmml" xref="S4.p1.4.m4.1.1.2">𝑓</ci><ci id="S4.p1.4.m4.1.1.3.cmml" xref="S4.p1.4.m4.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">f_{\psi}</annotation></semantics></math> on that client’s data by employing a feature-wise gating mechanism to the activations of the preceding layers, allowing only the relevant features (or activations) to propagate forward while disregarding the non-relevant ones. The parameters of the modulation layers are predicted by the federated modulator. The latter extracts some context from batches of data available at the client level and transforms it to generate the modulation parameters. The context is designed to be representative of the client’s local dataset and invariant to the permutation of data samples, ensuring the predicted modulation parameters are independent of the ordering of the data. We delve into the architecture of the federated modulator in Section <a href="#S4.SS1" title="4.1 Federated Modulator. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a> and provide the complete algorithm in Section <a href="#S4.SS2" title="4.2 Algorithm. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<figure id="S4.F1" class="ltx_figure"><img src="/html/2312.15191/assets/images/cafeme2.png" id="S4.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="329" height="143" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F1.15.7.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S4.F1.12.6" class="ltx_text" style="font-size:90%;">Overall framework of <em id="S4.F1.12.6.1" class="ltx_emph ltx_font_italic">CAFeMe</em>. For each client involved in the federation, the federated modulator <math id="S4.F1.7.1.m1.1" class="ltx_Math" alttext="g_{\mu}" display="inline"><semantics id="S4.F1.7.1.m1.1b"><msub id="S4.F1.7.1.m1.1.1" xref="S4.F1.7.1.m1.1.1.cmml"><mi id="S4.F1.7.1.m1.1.1.2" xref="S4.F1.7.1.m1.1.1.2.cmml">g</mi><mi id="S4.F1.7.1.m1.1.1.3" xref="S4.F1.7.1.m1.1.1.3.cmml">μ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F1.7.1.m1.1c"><apply id="S4.F1.7.1.m1.1.1.cmml" xref="S4.F1.7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.F1.7.1.m1.1.1.1.cmml" xref="S4.F1.7.1.m1.1.1">subscript</csymbol><ci id="S4.F1.7.1.m1.1.1.2.cmml" xref="S4.F1.7.1.m1.1.1.2">𝑔</ci><ci id="S4.F1.7.1.m1.1.1.3.cmml" xref="S4.F1.7.1.m1.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.7.1.m1.1d">g_{\mu}</annotation></semantics></math> takes in input a batch of local data <math id="S4.F1.8.2.m2.1" class="ltx_Math" alttext="\mathcal{D}^{\prime}_{i}" display="inline"><semantics id="S4.F1.8.2.m2.1b"><msubsup id="S4.F1.8.2.m2.1.1" xref="S4.F1.8.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F1.8.2.m2.1.1.2.2" xref="S4.F1.8.2.m2.1.1.2.2.cmml">𝒟</mi><mi id="S4.F1.8.2.m2.1.1.3" xref="S4.F1.8.2.m2.1.1.3.cmml">i</mi><mo id="S4.F1.8.2.m2.1.1.2.3" xref="S4.F1.8.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.F1.8.2.m2.1c"><apply id="S4.F1.8.2.m2.1.1.cmml" xref="S4.F1.8.2.m2.1.1"><csymbol cd="ambiguous" id="S4.F1.8.2.m2.1.1.1.cmml" xref="S4.F1.8.2.m2.1.1">subscript</csymbol><apply id="S4.F1.8.2.m2.1.1.2.cmml" xref="S4.F1.8.2.m2.1.1"><csymbol cd="ambiguous" id="S4.F1.8.2.m2.1.1.2.1.cmml" xref="S4.F1.8.2.m2.1.1">superscript</csymbol><ci id="S4.F1.8.2.m2.1.1.2.2.cmml" xref="S4.F1.8.2.m2.1.1.2.2">𝒟</ci><ci id="S4.F1.8.2.m2.1.1.2.3.cmml" xref="S4.F1.8.2.m2.1.1.2.3">′</ci></apply><ci id="S4.F1.8.2.m2.1.1.3.cmml" xref="S4.F1.8.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.8.2.m2.1d">\mathcal{D}^{\prime}_{i}</annotation></semantics></math>, sampled from <math id="S4.F1.9.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{pers}" display="inline"><semantics id="S4.F1.9.3.m3.1b"><msubsup id="S4.F1.9.3.m3.1.1" xref="S4.F1.9.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F1.9.3.m3.1.1.2.2" xref="S4.F1.9.3.m3.1.1.2.2.cmml">𝒟</mi><mi id="S4.F1.9.3.m3.1.1.2.3" xref="S4.F1.9.3.m3.1.1.2.3.cmml">i</mi><mrow id="S4.F1.9.3.m3.1.1.3" xref="S4.F1.9.3.m3.1.1.3.cmml"><mi id="S4.F1.9.3.m3.1.1.3.2" xref="S4.F1.9.3.m3.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.F1.9.3.m3.1.1.3.1" xref="S4.F1.9.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.F1.9.3.m3.1.1.3.3" xref="S4.F1.9.3.m3.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.F1.9.3.m3.1.1.3.1b" xref="S4.F1.9.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.F1.9.3.m3.1.1.3.4" xref="S4.F1.9.3.m3.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.F1.9.3.m3.1.1.3.1c" xref="S4.F1.9.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.F1.9.3.m3.1.1.3.5" xref="S4.F1.9.3.m3.1.1.3.5.cmml">s</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.F1.9.3.m3.1c"><apply id="S4.F1.9.3.m3.1.1.cmml" xref="S4.F1.9.3.m3.1.1"><csymbol cd="ambiguous" id="S4.F1.9.3.m3.1.1.1.cmml" xref="S4.F1.9.3.m3.1.1">superscript</csymbol><apply id="S4.F1.9.3.m3.1.1.2.cmml" xref="S4.F1.9.3.m3.1.1"><csymbol cd="ambiguous" id="S4.F1.9.3.m3.1.1.2.1.cmml" xref="S4.F1.9.3.m3.1.1">subscript</csymbol><ci id="S4.F1.9.3.m3.1.1.2.2.cmml" xref="S4.F1.9.3.m3.1.1.2.2">𝒟</ci><ci id="S4.F1.9.3.m3.1.1.2.3.cmml" xref="S4.F1.9.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S4.F1.9.3.m3.1.1.3.cmml" xref="S4.F1.9.3.m3.1.1.3"><times id="S4.F1.9.3.m3.1.1.3.1.cmml" xref="S4.F1.9.3.m3.1.1.3.1"></times><ci id="S4.F1.9.3.m3.1.1.3.2.cmml" xref="S4.F1.9.3.m3.1.1.3.2">𝑝</ci><ci id="S4.F1.9.3.m3.1.1.3.3.cmml" xref="S4.F1.9.3.m3.1.1.3.3">𝑒</ci><ci id="S4.F1.9.3.m3.1.1.3.4.cmml" xref="S4.F1.9.3.m3.1.1.3.4">𝑟</ci><ci id="S4.F1.9.3.m3.1.1.3.5.cmml" xref="S4.F1.9.3.m3.1.1.3.5">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.9.3.m3.1d">\mathcal{D}_{i}^{pers}</annotation></semantics></math>, and predicts the parameters of the modulation layers <math id="S4.F1.10.4.m4.1" class="ltx_Math" alttext="\bm{\zeta}_{i}" display="inline"><semantics id="S4.F1.10.4.m4.1b"><msub id="S4.F1.10.4.m4.1.1" xref="S4.F1.10.4.m4.1.1.cmml"><mi id="S4.F1.10.4.m4.1.1.2" xref="S4.F1.10.4.m4.1.1.2.cmml">𝜻</mi><mi id="S4.F1.10.4.m4.1.1.3" xref="S4.F1.10.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F1.10.4.m4.1c"><apply id="S4.F1.10.4.m4.1.1.cmml" xref="S4.F1.10.4.m4.1.1"><csymbol cd="ambiguous" id="S4.F1.10.4.m4.1.1.1.cmml" xref="S4.F1.10.4.m4.1.1">subscript</csymbol><ci id="S4.F1.10.4.m4.1.1.2.cmml" xref="S4.F1.10.4.m4.1.1.2">𝜻</ci><ci id="S4.F1.10.4.m4.1.1.3.cmml" xref="S4.F1.10.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.10.4.m4.1d">\bm{\zeta}_{i}</annotation></semantics></math>. These parameters are used to modulate the activations of the base network <math id="S4.F1.11.5.m5.1" class="ltx_Math" alttext="f_{\psi}" display="inline"><semantics id="S4.F1.11.5.m5.1b"><msub id="S4.F1.11.5.m5.1.1" xref="S4.F1.11.5.m5.1.1.cmml"><mi id="S4.F1.11.5.m5.1.1.2" xref="S4.F1.11.5.m5.1.1.2.cmml">f</mi><mi id="S4.F1.11.5.m5.1.1.3" xref="S4.F1.11.5.m5.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F1.11.5.m5.1c"><apply id="S4.F1.11.5.m5.1.1.cmml" xref="S4.F1.11.5.m5.1.1"><csymbol cd="ambiguous" id="S4.F1.11.5.m5.1.1.1.cmml" xref="S4.F1.11.5.m5.1.1">subscript</csymbol><ci id="S4.F1.11.5.m5.1.1.2.cmml" xref="S4.F1.11.5.m5.1.1.2">𝑓</ci><ci id="S4.F1.11.5.m5.1.1.3.cmml" xref="S4.F1.11.5.m5.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.11.5.m5.1d">f_{\psi}</annotation></semantics></math>. The modulation operator is denoted by <math id="S4.F1.12.6.m6.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S4.F1.12.6.m6.1b"><mo id="S4.F1.12.6.m6.1.1" xref="S4.F1.12.6.m6.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S4.F1.12.6.m6.1c"><csymbol cd="latexml" id="S4.F1.12.6.m6.1.1.cmml" xref="S4.F1.12.6.m6.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.12.6.m6.1d">\odot</annotation></semantics></math>.</span></figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Federated Modulator.</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.20" class="ltx_p">As illustrated in Figure <a href="#S4.F2" title="Figure 2 ‣ 4.1 Federated Modulator. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the federated modulator network <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="g_{\mu}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">g</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">μ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑔</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">g_{\mu}</annotation></semantics></math> consists of three parts: a feature extractor (A), an averaging layer (B), and a multilayer perception (MLP) (C).
The feature extractor (A) takes as input a batch of data <math id="S4.SS1.p1.2.m2.2" class="ltx_Math" alttext="\mathcal{D}_{i}^{\prime}=\{x_{b},y_{b}\}_{b=1}^{B}" display="inline"><semantics id="S4.SS1.p1.2.m2.2a"><mrow id="S4.SS1.p1.2.m2.2.2" xref="S4.SS1.p1.2.m2.2.2.cmml"><msubsup id="S4.SS1.p1.2.m2.2.2.4" xref="S4.SS1.p1.2.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.2.2.4.2.2" xref="S4.SS1.p1.2.m2.2.2.4.2.2.cmml">𝒟</mi><mi id="S4.SS1.p1.2.m2.2.2.4.2.3" xref="S4.SS1.p1.2.m2.2.2.4.2.3.cmml">i</mi><mo id="S4.SS1.p1.2.m2.2.2.4.3" xref="S4.SS1.p1.2.m2.2.2.4.3.cmml">′</mo></msubsup><mo id="S4.SS1.p1.2.m2.2.2.3" xref="S4.SS1.p1.2.m2.2.2.3.cmml">=</mo><msubsup id="S4.SS1.p1.2.m2.2.2.2" xref="S4.SS1.p1.2.m2.2.2.2.cmml"><mrow id="S4.SS1.p1.2.m2.2.2.2.2.2.2" xref="S4.SS1.p1.2.m2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.2.m2.2.2.2.2.2.2.3" xref="S4.SS1.p1.2.m2.2.2.2.2.2.3.cmml">{</mo><msub id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S4.SS1.p1.2.m2.2.2.2.2.2.2.4" xref="S4.SS1.p1.2.m2.2.2.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p1.2.m2.2.2.2.2.2.2.2" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.cmml"><mi id="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.2" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.3" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.3.cmml">b</mi></msub><mo stretchy="false" id="S4.SS1.p1.2.m2.2.2.2.2.2.2.5" xref="S4.SS1.p1.2.m2.2.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S4.SS1.p1.2.m2.2.2.2.2.4" xref="S4.SS1.p1.2.m2.2.2.2.2.4.cmml"><mi id="S4.SS1.p1.2.m2.2.2.2.2.4.2" xref="S4.SS1.p1.2.m2.2.2.2.2.4.2.cmml">b</mi><mo id="S4.SS1.p1.2.m2.2.2.2.2.4.1" xref="S4.SS1.p1.2.m2.2.2.2.2.4.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.2.2.2.2.4.3" xref="S4.SS1.p1.2.m2.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.2.m2.2.2.2.4" xref="S4.SS1.p1.2.m2.2.2.2.4.cmml">B</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.2b"><apply id="S4.SS1.p1.2.m2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2"><eq id="S4.SS1.p1.2.m2.2.2.3.cmml" xref="S4.SS1.p1.2.m2.2.2.3"></eq><apply id="S4.SS1.p1.2.m2.2.2.4.cmml" xref="S4.SS1.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.2.2.4.1.cmml" xref="S4.SS1.p1.2.m2.2.2.4">superscript</csymbol><apply id="S4.SS1.p1.2.m2.2.2.4.2.cmml" xref="S4.SS1.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.2.2.4.2.1.cmml" xref="S4.SS1.p1.2.m2.2.2.4">subscript</csymbol><ci id="S4.SS1.p1.2.m2.2.2.4.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2.4.2.2">𝒟</ci><ci id="S4.SS1.p1.2.m2.2.2.4.2.3.cmml" xref="S4.SS1.p1.2.m2.2.2.4.2.3">𝑖</ci></apply><ci id="S4.SS1.p1.2.m2.2.2.4.3.cmml" xref="S4.SS1.p1.2.m2.2.2.4.3">′</ci></apply><apply id="S4.SS1.p1.2.m2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.2.2.2.3.cmml" xref="S4.SS1.p1.2.m2.2.2.2">superscript</csymbol><apply id="S4.SS1.p1.2.m2.2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.2.2.2.2.3.cmml" xref="S4.SS1.p1.2.m2.2.2.2">subscript</csymbol><set id="S4.SS1.p1.2.m2.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2"><apply id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3">𝑏</ci></apply><apply id="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.2.2.2.3">𝑏</ci></apply></set><apply id="S4.SS1.p1.2.m2.2.2.2.2.4.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.4"><eq id="S4.SS1.p1.2.m2.2.2.2.2.4.1.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.4.1"></eq><ci id="S4.SS1.p1.2.m2.2.2.2.2.4.2.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.4.2">𝑏</ci><cn type="integer" id="S4.SS1.p1.2.m2.2.2.2.2.4.3.cmml" xref="S4.SS1.p1.2.m2.2.2.2.2.4.3">1</cn></apply></apply><ci id="S4.SS1.p1.2.m2.2.2.2.4.cmml" xref="S4.SS1.p1.2.m2.2.2.2.4">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.2c">\mathcal{D}_{i}^{\prime}=\{x_{b},y_{b}\}_{b=1}^{B}</annotation></semantics></math>, where <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">B</annotation></semantics></math> is the batch size. Each batch consists of inputs <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="x_{b}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">x</mi><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑥</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">x_{b}</annotation></semantics></math> and labels <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="y_{b}" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><msub id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">y</mi><mi id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">𝑦</ci><ci id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">y_{b}</annotation></semantics></math> (represented as one-hot-vectors in classification) sampled from a client <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">i</annotation></semantics></math>. It then transforms them into <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{Z}_{i}=\{h(~{}h_{x}(x_{b})~{}\oplus~{}y_{b}~{})\}_{b=1}^{B}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mrow id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><msub id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.7.m7.1.1.3.2" xref="S4.SS1.p1.7.m7.1.1.3.2.cmml">𝒵</mi><mi id="S4.SS1.p1.7.m7.1.1.3.3" xref="S4.SS1.p1.7.m7.1.1.3.3.cmml">i</mi></msub><mo id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">=</mo><msubsup id="S4.SS1.p1.7.m7.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.cmml"><mrow id="S4.SS1.p1.7.m7.1.1.1.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.2.cmml">{</mo><mrow id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.cmml"><mo rspace="0.330em" stretchy="false" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">x</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">b</mi></msub><mo rspace="0.330em" stretchy="false" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.552em" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.2.cmml">⊕</mo><msub id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3.3.cmml">b</mi></msub></mrow><mo stretchy="false" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p1.7.m7.1.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.1.3.cmml"><mi id="S4.SS1.p1.7.m7.1.1.1.1.3.2" xref="S4.SS1.p1.7.m7.1.1.1.1.3.2.cmml">b</mi><mo id="S4.SS1.p1.7.m7.1.1.1.1.3.1" xref="S4.SS1.p1.7.m7.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p1.7.m7.1.1.1.1.3.3" xref="S4.SS1.p1.7.m7.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.7.m7.1.1.1.3" xref="S4.SS1.p1.7.m7.1.1.1.3.cmml">B</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><eq id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2"></eq><apply id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.3.1.cmml" xref="S4.SS1.p1.7.m7.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.3.2.cmml" xref="S4.SS1.p1.7.m7.1.1.3.2">𝒵</ci><ci id="S4.SS1.p1.7.m7.1.1.3.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3.3">𝑖</ci></apply><apply id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.7.m7.1.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1">subscript</csymbol><set id="S4.SS1.p1.7.m7.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1"><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1"><times id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.2"></times><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.3">ℎ</ci><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.2">direct-sum</csymbol><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3.2">ℎ</ci><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑥</ci></apply><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑏</ci></apply></apply><apply id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.3.3">𝑏</ci></apply></apply></apply></set><apply id="S4.SS1.p1.7.m7.1.1.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.3"><eq id="S4.SS1.p1.7.m7.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.3.1"></eq><ci id="S4.SS1.p1.7.m7.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.3.2">𝑏</ci><cn type="integer" id="S4.SS1.p1.7.m7.1.1.1.1.3.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.7.m7.1.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.1.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\mathcal{Z}_{i}=\{h(~{}h_{x}(x_{b})~{}\oplus~{}y_{b}~{})\}_{b=1}^{B}</annotation></semantics></math>, where <math id="S4.SS1.p1.8.m8.1" class="ltx_math_unparsed" alttext="h_{x}(.)" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mrow id="S4.SS1.p1.8.m8.1b"><msub id="S4.SS1.p1.8.m8.1.1"><mi id="S4.SS1.p1.8.m8.1.1.2">h</mi><mi id="S4.SS1.p1.8.m8.1.1.3">x</mi></msub><mrow id="S4.SS1.p1.8.m8.1.2"><mo stretchy="false" id="S4.SS1.p1.8.m8.1.2.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.SS1.p1.8.m8.1.2.2">.</mo><mo stretchy="false" id="S4.SS1.p1.8.m8.1.2.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">h_{x}(.)</annotation></semantics></math> denotes an input-specific feature extractor, and <math id="S4.SS1.p1.9.m9.1" class="ltx_Math" alttext="\oplus" display="inline"><semantics id="S4.SS1.p1.9.m9.1a"><mo id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><csymbol cd="latexml" id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">\oplus</annotation></semantics></math> denotes the concatenation operator. The averaging layer (B) calculates the mean of the transformed data <math id="S4.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{Z}_{i}" display="inline"><semantics id="S4.SS1.p1.10.m10.1a"><msub id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.10.m10.1.1.2" xref="S4.SS1.p1.10.m10.1.1.2.cmml">𝒵</mi><mi id="S4.SS1.p1.10.m10.1.1.3" xref="S4.SS1.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><apply id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS1.p1.10.m10.1.1.2.cmml" xref="S4.SS1.p1.10.m10.1.1.2">𝒵</ci><ci id="S4.SS1.p1.10.m10.1.1.3.cmml" xref="S4.SS1.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">\mathcal{Z}_{i}</annotation></semantics></math> along the <math id="S4.SS1.p1.11.m11.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS1.p1.11.m11.1a"><mi id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><ci id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">B</annotation></semantics></math> examples, creating a vector representation <math id="S4.SS1.p1.12.m12.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S4.SS1.p1.12.m12.1a"><msub id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml"><mi id="S4.SS1.p1.12.m12.1.1.2" xref="S4.SS1.p1.12.m12.1.1.2.cmml">z</mi><mi id="S4.SS1.p1.12.m12.1.1.3" xref="S4.SS1.p1.12.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.1b"><apply id="S4.SS1.p1.12.m12.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.1.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S4.SS1.p1.12.m12.1.1.2.cmml" xref="S4.SS1.p1.12.m12.1.1.2">𝑧</ci><ci id="S4.SS1.p1.12.m12.1.1.3.cmml" xref="S4.SS1.p1.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.1c">z_{i}</annotation></semantics></math> that characterizes client <math id="S4.SS1.p1.13.m13.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p1.13.m13.1a"><mi id="S4.SS1.p1.13.m13.1.1" xref="S4.SS1.p1.13.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.1b"><ci id="S4.SS1.p1.13.m13.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.1c">i</annotation></semantics></math>. This task representation is invariant to permutations of the examples and is expected to capture client-specific information. The final part (C) of the network generates the parameters for the modulation layers in the base network. It is an MLP that takes <math id="S4.SS1.p1.14.m14.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S4.SS1.p1.14.m14.1a"><msub id="S4.SS1.p1.14.m14.1.1" xref="S4.SS1.p1.14.m14.1.1.cmml"><mi id="S4.SS1.p1.14.m14.1.1.2" xref="S4.SS1.p1.14.m14.1.1.2.cmml">z</mi><mi id="S4.SS1.p1.14.m14.1.1.3" xref="S4.SS1.p1.14.m14.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m14.1b"><apply id="S4.SS1.p1.14.m14.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.1.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1">subscript</csymbol><ci id="S4.SS1.p1.14.m14.1.1.2.cmml" xref="S4.SS1.p1.14.m14.1.1.2">𝑧</ci><ci id="S4.SS1.p1.14.m14.1.1.3.cmml" xref="S4.SS1.p1.14.m14.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m14.1c">z_{i}</annotation></semantics></math> as input and predicts a set of parameters <math id="S4.SS1.p1.15.m15.2" class="ltx_Math" alttext="\bm{\zeta}_{i}=\{\zeta_{i}^{1},\cdots\zeta_{i}^{L}\}" display="inline"><semantics id="S4.SS1.p1.15.m15.2a"><mrow id="S4.SS1.p1.15.m15.2.2" xref="S4.SS1.p1.15.m15.2.2.cmml"><msub id="S4.SS1.p1.15.m15.2.2.4" xref="S4.SS1.p1.15.m15.2.2.4.cmml"><mi id="S4.SS1.p1.15.m15.2.2.4.2" xref="S4.SS1.p1.15.m15.2.2.4.2.cmml">𝜻</mi><mi id="S4.SS1.p1.15.m15.2.2.4.3" xref="S4.SS1.p1.15.m15.2.2.4.3.cmml">i</mi></msub><mo id="S4.SS1.p1.15.m15.2.2.3" xref="S4.SS1.p1.15.m15.2.2.3.cmml">=</mo><mrow id="S4.SS1.p1.15.m15.2.2.2.2" xref="S4.SS1.p1.15.m15.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.15.m15.2.2.2.2.3" xref="S4.SS1.p1.15.m15.2.2.2.3.cmml">{</mo><msubsup id="S4.SS1.p1.15.m15.1.1.1.1.1" xref="S4.SS1.p1.15.m15.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.15.m15.1.1.1.1.1.2.2" xref="S4.SS1.p1.15.m15.1.1.1.1.1.2.2.cmml">ζ</mi><mi id="S4.SS1.p1.15.m15.1.1.1.1.1.2.3" xref="S4.SS1.p1.15.m15.1.1.1.1.1.2.3.cmml">i</mi><mn id="S4.SS1.p1.15.m15.1.1.1.1.1.3" xref="S4.SS1.p1.15.m15.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S4.SS1.p1.15.m15.2.2.2.2.4" xref="S4.SS1.p1.15.m15.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.p1.15.m15.2.2.2.2.2" xref="S4.SS1.p1.15.m15.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S4.SS1.p1.15.m15.2.2.2.2.2.2" xref="S4.SS1.p1.15.m15.2.2.2.2.2.2.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.15.m15.2.2.2.2.2.1" xref="S4.SS1.p1.15.m15.2.2.2.2.2.1.cmml">​</mo><msubsup id="S4.SS1.p1.15.m15.2.2.2.2.2.3" xref="S4.SS1.p1.15.m15.2.2.2.2.2.3.cmml"><mi id="S4.SS1.p1.15.m15.2.2.2.2.2.3.2.2" xref="S4.SS1.p1.15.m15.2.2.2.2.2.3.2.2.cmml">ζ</mi><mi id="S4.SS1.p1.15.m15.2.2.2.2.2.3.2.3" xref="S4.SS1.p1.15.m15.2.2.2.2.2.3.2.3.cmml">i</mi><mi id="S4.SS1.p1.15.m15.2.2.2.2.2.3.3" xref="S4.SS1.p1.15.m15.2.2.2.2.2.3.3.cmml">L</mi></msubsup></mrow><mo stretchy="false" id="S4.SS1.p1.15.m15.2.2.2.2.5" xref="S4.SS1.p1.15.m15.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m15.2b"><apply id="S4.SS1.p1.15.m15.2.2.cmml" xref="S4.SS1.p1.15.m15.2.2"><eq id="S4.SS1.p1.15.m15.2.2.3.cmml" xref="S4.SS1.p1.15.m15.2.2.3"></eq><apply id="S4.SS1.p1.15.m15.2.2.4.cmml" xref="S4.SS1.p1.15.m15.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.15.m15.2.2.4.1.cmml" xref="S4.SS1.p1.15.m15.2.2.4">subscript</csymbol><ci id="S4.SS1.p1.15.m15.2.2.4.2.cmml" xref="S4.SS1.p1.15.m15.2.2.4.2">𝜻</ci><ci id="S4.SS1.p1.15.m15.2.2.4.3.cmml" xref="S4.SS1.p1.15.m15.2.2.4.3">𝑖</ci></apply><set id="S4.SS1.p1.15.m15.2.2.2.3.cmml" xref="S4.SS1.p1.15.m15.2.2.2.2"><apply id="S4.SS1.p1.15.m15.1.1.1.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.15.m15.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.15.m15.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.15.m15.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.15.m15.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.1.2.2">𝜁</ci><ci id="S4.SS1.p1.15.m15.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S4.SS1.p1.15.m15.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.1.3">1</cn></apply><apply id="S4.SS1.p1.15.m15.2.2.2.2.2.cmml" xref="S4.SS1.p1.15.m15.2.2.2.2.2"><times id="S4.SS1.p1.15.m15.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.15.m15.2.2.2.2.2.1"></times><ci id="S4.SS1.p1.15.m15.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.15.m15.2.2.2.2.2.2">⋯</ci><apply id="S4.SS1.p1.15.m15.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.15.m15.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.15.m15.2.2.2.2.2.3.1.cmml" xref="S4.SS1.p1.15.m15.2.2.2.2.2.3">superscript</csymbol><apply id="S4.SS1.p1.15.m15.2.2.2.2.2.3.2.cmml" xref="S4.SS1.p1.15.m15.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.15.m15.2.2.2.2.2.3.2.1.cmml" xref="S4.SS1.p1.15.m15.2.2.2.2.2.3">subscript</csymbol><ci id="S4.SS1.p1.15.m15.2.2.2.2.2.3.2.2.cmml" xref="S4.SS1.p1.15.m15.2.2.2.2.2.3.2.2">𝜁</ci><ci id="S4.SS1.p1.15.m15.2.2.2.2.2.3.2.3.cmml" xref="S4.SS1.p1.15.m15.2.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="S4.SS1.p1.15.m15.2.2.2.2.2.3.3.cmml" xref="S4.SS1.p1.15.m15.2.2.2.2.2.3.3">𝐿</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.15.m15.2c">\bm{\zeta}_{i}=\{\zeta_{i}^{1},\cdots\zeta_{i}^{L}\}</annotation></semantics></math>, where <math id="S4.SS1.p1.16.m16.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS1.p1.16.m16.1a"><mi id="S4.SS1.p1.16.m16.1.1" xref="S4.SS1.p1.16.m16.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.16.m16.1b"><ci id="S4.SS1.p1.16.m16.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.16.m16.1c">L</annotation></semantics></math> is the number of hidden layers in the base model. Each <math id="S4.SS1.p1.17.m17.1" class="ltx_Math" alttext="\zeta_{i}^{l}" display="inline"><semantics id="S4.SS1.p1.17.m17.1a"><msubsup id="S4.SS1.p1.17.m17.1.1" xref="S4.SS1.p1.17.m17.1.1.cmml"><mi id="S4.SS1.p1.17.m17.1.1.2.2" xref="S4.SS1.p1.17.m17.1.1.2.2.cmml">ζ</mi><mi id="S4.SS1.p1.17.m17.1.1.2.3" xref="S4.SS1.p1.17.m17.1.1.2.3.cmml">i</mi><mi id="S4.SS1.p1.17.m17.1.1.3" xref="S4.SS1.p1.17.m17.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.17.m17.1b"><apply id="S4.SS1.p1.17.m17.1.1.cmml" xref="S4.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.17.m17.1.1.1.cmml" xref="S4.SS1.p1.17.m17.1.1">superscript</csymbol><apply id="S4.SS1.p1.17.m17.1.1.2.cmml" xref="S4.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.17.m17.1.1.2.1.cmml" xref="S4.SS1.p1.17.m17.1.1">subscript</csymbol><ci id="S4.SS1.p1.17.m17.1.1.2.2.cmml" xref="S4.SS1.p1.17.m17.1.1.2.2">𝜁</ci><ci id="S4.SS1.p1.17.m17.1.1.2.3.cmml" xref="S4.SS1.p1.17.m17.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.p1.17.m17.1.1.3.cmml" xref="S4.SS1.p1.17.m17.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.17.m17.1c">\zeta_{i}^{l}</annotation></semantics></math>, for <math id="S4.SS1.p1.18.m18.3" class="ltx_Math" alttext="l=1,...,L" display="inline"><semantics id="S4.SS1.p1.18.m18.3a"><mrow id="S4.SS1.p1.18.m18.3.4" xref="S4.SS1.p1.18.m18.3.4.cmml"><mi id="S4.SS1.p1.18.m18.3.4.2" xref="S4.SS1.p1.18.m18.3.4.2.cmml">l</mi><mo id="S4.SS1.p1.18.m18.3.4.1" xref="S4.SS1.p1.18.m18.3.4.1.cmml">=</mo><mrow id="S4.SS1.p1.18.m18.3.4.3.2" xref="S4.SS1.p1.18.m18.3.4.3.1.cmml"><mn id="S4.SS1.p1.18.m18.1.1" xref="S4.SS1.p1.18.m18.1.1.cmml">1</mn><mo id="S4.SS1.p1.18.m18.3.4.3.2.1" xref="S4.SS1.p1.18.m18.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.18.m18.2.2" xref="S4.SS1.p1.18.m18.2.2.cmml">…</mi><mo id="S4.SS1.p1.18.m18.3.4.3.2.2" xref="S4.SS1.p1.18.m18.3.4.3.1.cmml">,</mo><mi id="S4.SS1.p1.18.m18.3.3" xref="S4.SS1.p1.18.m18.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.18.m18.3b"><apply id="S4.SS1.p1.18.m18.3.4.cmml" xref="S4.SS1.p1.18.m18.3.4"><eq id="S4.SS1.p1.18.m18.3.4.1.cmml" xref="S4.SS1.p1.18.m18.3.4.1"></eq><ci id="S4.SS1.p1.18.m18.3.4.2.cmml" xref="S4.SS1.p1.18.m18.3.4.2">𝑙</ci><list id="S4.SS1.p1.18.m18.3.4.3.1.cmml" xref="S4.SS1.p1.18.m18.3.4.3.2"><cn type="integer" id="S4.SS1.p1.18.m18.1.1.cmml" xref="S4.SS1.p1.18.m18.1.1">1</cn><ci id="S4.SS1.p1.18.m18.2.2.cmml" xref="S4.SS1.p1.18.m18.2.2">…</ci><ci id="S4.SS1.p1.18.m18.3.3.cmml" xref="S4.SS1.p1.18.m18.3.3">𝐿</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.18.m18.3c">l=1,...,L</annotation></semantics></math>, corresponds to the parameters of the modulation layer following the <math id="S4.SS1.p1.19.m19.1" class="ltx_Math" alttext="l^{\textnormal{th}}" display="inline"><semantics id="S4.SS1.p1.19.m19.1a"><msup id="S4.SS1.p1.19.m19.1.1" xref="S4.SS1.p1.19.m19.1.1.cmml"><mi id="S4.SS1.p1.19.m19.1.1.2" xref="S4.SS1.p1.19.m19.1.1.2.cmml">l</mi><mtext id="S4.SS1.p1.19.m19.1.1.3" xref="S4.SS1.p1.19.m19.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.19.m19.1b"><apply id="S4.SS1.p1.19.m19.1.1.cmml" xref="S4.SS1.p1.19.m19.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.19.m19.1.1.1.cmml" xref="S4.SS1.p1.19.m19.1.1">superscript</csymbol><ci id="S4.SS1.p1.19.m19.1.1.2.cmml" xref="S4.SS1.p1.19.m19.1.1.2">𝑙</ci><ci id="S4.SS1.p1.19.m19.1.1.3a.cmml" xref="S4.SS1.p1.19.m19.1.1.3"><mtext mathsize="70%" id="S4.SS1.p1.19.m19.1.1.3.cmml" xref="S4.SS1.p1.19.m19.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.19.m19.1c">l^{\textnormal{th}}</annotation></semantics></math> layer in the base model.
These parameters will act as “scaling” or “gating” parameters; they adjust the feature importance and diminish the contribution of less informative features for the given client <math id="S4.SS1.p1.20.m20.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p1.20.m20.1a"><mi id="S4.SS1.p1.20.m20.1.1" xref="S4.SS1.p1.20.m20.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.20.m20.1b"><ci id="S4.SS1.p1.20.m20.1.1.cmml" xref="S4.SS1.p1.20.m20.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.20.m20.1c">i</annotation></semantics></math>. This is described more formally in the next section.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2312.15191/assets/images/modulator.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="306" height="96" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.3.2" class="ltx_text" style="font-size:90%;">Architecture of the federated modulator. It consists of three parts: a feature extractor (A), an averaging layer (B), and an MLP (C).</span></figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Algorithm.</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.23" class="ltx_p">The complete algorithm of the <em id="S4.SS2.p1.23.1" class="ltx_emph ltx_font_italic">CAFeMe</em> method is presented in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 4.2 Algorithm. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. At each communication round <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">t</annotation></semantics></math>, with <math id="S4.SS2.p1.2.m2.3" class="ltx_Math" alttext="t=1,\cdots,T" display="inline"><semantics id="S4.SS2.p1.2.m2.3a"><mrow id="S4.SS2.p1.2.m2.3.4" xref="S4.SS2.p1.2.m2.3.4.cmml"><mi id="S4.SS2.p1.2.m2.3.4.2" xref="S4.SS2.p1.2.m2.3.4.2.cmml">t</mi><mo id="S4.SS2.p1.2.m2.3.4.1" xref="S4.SS2.p1.2.m2.3.4.1.cmml">=</mo><mrow id="S4.SS2.p1.2.m2.3.4.3.2" xref="S4.SS2.p1.2.m2.3.4.3.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">1</mn><mo id="S4.SS2.p1.2.m2.3.4.3.2.1" xref="S4.SS2.p1.2.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.p1.2.m2.2.2" xref="S4.SS2.p1.2.m2.2.2.cmml">⋯</mi><mo id="S4.SS2.p1.2.m2.3.4.3.2.2" xref="S4.SS2.p1.2.m2.3.4.3.1.cmml">,</mo><mi id="S4.SS2.p1.2.m2.3.3" xref="S4.SS2.p1.2.m2.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.3b"><apply id="S4.SS2.p1.2.m2.3.4.cmml" xref="S4.SS2.p1.2.m2.3.4"><eq id="S4.SS2.p1.2.m2.3.4.1.cmml" xref="S4.SS2.p1.2.m2.3.4.1"></eq><ci id="S4.SS2.p1.2.m2.3.4.2.cmml" xref="S4.SS2.p1.2.m2.3.4.2">𝑡</ci><list id="S4.SS2.p1.2.m2.3.4.3.1.cmml" xref="S4.SS2.p1.2.m2.3.4.3.2"><cn type="integer" id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">1</cn><ci id="S4.SS2.p1.2.m2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2">⋯</ci><ci id="S4.SS2.p1.2.m2.3.3.cmml" xref="S4.SS2.p1.2.m2.3.3">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.3c">t=1,\cdots,T</annotation></semantics></math>, a subset of <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">M</annotation></semantics></math> clients is randomly sampled and denoted with <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{C}^{(t)}" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><msup id="S4.SS2.p1.4.m4.1.2" xref="S4.SS2.p1.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.4.m4.1.2.2" xref="S4.SS2.p1.4.m4.1.2.2.cmml">𝒞</mi><mrow id="S4.SS2.p1.4.m4.1.1.1.3" xref="S4.SS2.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m4.1.1.1.3.1" xref="S4.SS2.p1.4.m4.1.2.cmml">(</mo><mi id="S4.SS2.p1.4.m4.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS2.p1.4.m4.1.1.1.3.2" xref="S4.SS2.p1.4.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.2.cmml" xref="S4.SS2.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.2.1.cmml" xref="S4.SS2.p1.4.m4.1.2">superscript</csymbol><ci id="S4.SS2.p1.4.m4.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.2.2">𝒞</ci><ci id="S4.SS2.p1.4.m4.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\mathcal{C}^{(t)}</annotation></semantics></math>. In line 4 of Algorithm <a href="#alg1" title="Algorithm 1 ‣ 4.2 Algorithm. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the parameters of the global model <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\omega</annotation></semantics></math> are sent to each of the selected clients with the aim of personalizing them to each client’s local data. To do so, each client’s dataset <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><msub id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml">𝒟</mi><mi id="S4.SS2.p1.6.m6.1.1.3" xref="S4.SS2.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2">𝒟</ci><ci id="S4.SS2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\mathcal{D}_{i}</annotation></semantics></math> is split into two disjoint sets, <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{pers}" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><msubsup id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.7.m7.1.1.2.2" xref="S4.SS2.p1.7.m7.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS2.p1.7.m7.1.1.2.3" xref="S4.SS2.p1.7.m7.1.1.2.3.cmml">i</mi><mrow id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml"><mi id="S4.SS2.p1.7.m7.1.1.3.2" xref="S4.SS2.p1.7.m7.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.7.m7.1.1.3.1" xref="S4.SS2.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.7.m7.1.1.3.3" xref="S4.SS2.p1.7.m7.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.7.m7.1.1.3.1a" xref="S4.SS2.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.7.m7.1.1.3.4" xref="S4.SS2.p1.7.m7.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.7.m7.1.1.3.1b" xref="S4.SS2.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.7.m7.1.1.3.5" xref="S4.SS2.p1.7.m7.1.1.3.5.cmml">s</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">superscript</csymbol><apply id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m7.1.1.2.1.cmml" xref="S4.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.m7.1.1.2.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2.2">𝒟</ci><ci id="S4.SS2.p1.7.m7.1.1.2.3.cmml" xref="S4.SS2.p1.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3"><times id="S4.SS2.p1.7.m7.1.1.3.1.cmml" xref="S4.SS2.p1.7.m7.1.1.3.1"></times><ci id="S4.SS2.p1.7.m7.1.1.3.2.cmml" xref="S4.SS2.p1.7.m7.1.1.3.2">𝑝</ci><ci id="S4.SS2.p1.7.m7.1.1.3.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3.3">𝑒</ci><ci id="S4.SS2.p1.7.m7.1.1.3.4.cmml" xref="S4.SS2.p1.7.m7.1.1.3.4">𝑟</ci><ci id="S4.SS2.p1.7.m7.1.1.3.5.cmml" xref="S4.SS2.p1.7.m7.1.1.3.5">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">\mathcal{D}_{i}^{pers}</annotation></semantics></math> and <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{eval}" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><msubsup id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.8.m8.1.1.2.2" xref="S4.SS2.p1.8.m8.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS2.p1.8.m8.1.1.2.3" xref="S4.SS2.p1.8.m8.1.1.2.3.cmml">i</mi><mrow id="S4.SS2.p1.8.m8.1.1.3" xref="S4.SS2.p1.8.m8.1.1.3.cmml"><mi id="S4.SS2.p1.8.m8.1.1.3.2" xref="S4.SS2.p1.8.m8.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m8.1.1.3.1" xref="S4.SS2.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.8.m8.1.1.3.3" xref="S4.SS2.p1.8.m8.1.1.3.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m8.1.1.3.1a" xref="S4.SS2.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.8.m8.1.1.3.4" xref="S4.SS2.p1.8.m8.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m8.1.1.3.1b" xref="S4.SS2.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.8.m8.1.1.3.5" xref="S4.SS2.p1.8.m8.1.1.3.5.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><apply id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">superscript</csymbol><apply id="S4.SS2.p1.8.m8.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.1.2.1.cmml" xref="S4.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p1.8.m8.1.1.2.2.cmml" xref="S4.SS2.p1.8.m8.1.1.2.2">𝒟</ci><ci id="S4.SS2.p1.8.m8.1.1.2.3.cmml" xref="S4.SS2.p1.8.m8.1.1.2.3">𝑖</ci></apply><apply id="S4.SS2.p1.8.m8.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3"><times id="S4.SS2.p1.8.m8.1.1.3.1.cmml" xref="S4.SS2.p1.8.m8.1.1.3.1"></times><ci id="S4.SS2.p1.8.m8.1.1.3.2.cmml" xref="S4.SS2.p1.8.m8.1.1.3.2">𝑒</ci><ci id="S4.SS2.p1.8.m8.1.1.3.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3.3">𝑣</ci><ci id="S4.SS2.p1.8.m8.1.1.3.4.cmml" xref="S4.SS2.p1.8.m8.1.1.3.4">𝑎</ci><ci id="S4.SS2.p1.8.m8.1.1.3.5.cmml" xref="S4.SS2.p1.8.m8.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">\mathcal{D}_{i}^{eval}</annotation></semantics></math>. The former set is used in line 7 to personalize the global model’s parameters <math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><mi id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><ci id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">\omega</annotation></semantics></math> to client <math id="S4.SS2.p1.10.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p1.10.m10.1a"><mi id="S4.SS2.p1.10.m10.1.1" xref="S4.SS2.p1.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m10.1b"><ci id="S4.SS2.p1.10.m10.1.1.cmml" xref="S4.SS2.p1.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m10.1c">i</annotation></semantics></math>. This personalization is described in Algorithm <a href="#alg2" title="Algorithm 2 ‣ 4.2 Algorithm. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, where after a first initialization step in line 1, a batch of data is sampled from <math id="S4.SS2.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{pers}" display="inline"><semantics id="S4.SS2.p1.11.m11.1a"><msubsup id="S4.SS2.p1.11.m11.1.1" xref="S4.SS2.p1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.11.m11.1.1.2.2" xref="S4.SS2.p1.11.m11.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS2.p1.11.m11.1.1.2.3" xref="S4.SS2.p1.11.m11.1.1.2.3.cmml">i</mi><mrow id="S4.SS2.p1.11.m11.1.1.3" xref="S4.SS2.p1.11.m11.1.1.3.cmml"><mi id="S4.SS2.p1.11.m11.1.1.3.2" xref="S4.SS2.p1.11.m11.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.11.m11.1.1.3.1" xref="S4.SS2.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.11.m11.1.1.3.3" xref="S4.SS2.p1.11.m11.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.11.m11.1.1.3.1a" xref="S4.SS2.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.11.m11.1.1.3.4" xref="S4.SS2.p1.11.m11.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.11.m11.1.1.3.1b" xref="S4.SS2.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.11.m11.1.1.3.5" xref="S4.SS2.p1.11.m11.1.1.3.5.cmml">s</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m11.1b"><apply id="S4.SS2.p1.11.m11.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m11.1.1.1.cmml" xref="S4.SS2.p1.11.m11.1.1">superscript</csymbol><apply id="S4.SS2.p1.11.m11.1.1.2.cmml" xref="S4.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m11.1.1.2.1.cmml" xref="S4.SS2.p1.11.m11.1.1">subscript</csymbol><ci id="S4.SS2.p1.11.m11.1.1.2.2.cmml" xref="S4.SS2.p1.11.m11.1.1.2.2">𝒟</ci><ci id="S4.SS2.p1.11.m11.1.1.2.3.cmml" xref="S4.SS2.p1.11.m11.1.1.2.3">𝑖</ci></apply><apply id="S4.SS2.p1.11.m11.1.1.3.cmml" xref="S4.SS2.p1.11.m11.1.1.3"><times id="S4.SS2.p1.11.m11.1.1.3.1.cmml" xref="S4.SS2.p1.11.m11.1.1.3.1"></times><ci id="S4.SS2.p1.11.m11.1.1.3.2.cmml" xref="S4.SS2.p1.11.m11.1.1.3.2">𝑝</ci><ci id="S4.SS2.p1.11.m11.1.1.3.3.cmml" xref="S4.SS2.p1.11.m11.1.1.3.3">𝑒</ci><ci id="S4.SS2.p1.11.m11.1.1.3.4.cmml" xref="S4.SS2.p1.11.m11.1.1.3.4">𝑟</ci><ci id="S4.SS2.p1.11.m11.1.1.3.5.cmml" xref="S4.SS2.p1.11.m11.1.1.3.5">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m11.1c">\mathcal{D}_{i}^{pers}</annotation></semantics></math> and input in the federated modulator <math id="S4.SS2.p1.12.m12.1" class="ltx_Math" alttext="g_{\mu}" display="inline"><semantics id="S4.SS2.p1.12.m12.1a"><msub id="S4.SS2.p1.12.m12.1.1" xref="S4.SS2.p1.12.m12.1.1.cmml"><mi id="S4.SS2.p1.12.m12.1.1.2" xref="S4.SS2.p1.12.m12.1.1.2.cmml">g</mi><mi id="S4.SS2.p1.12.m12.1.1.3" xref="S4.SS2.p1.12.m12.1.1.3.cmml">μ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m12.1b"><apply id="S4.SS2.p1.12.m12.1.1.cmml" xref="S4.SS2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.12.m12.1.1.1.cmml" xref="S4.SS2.p1.12.m12.1.1">subscript</csymbol><ci id="S4.SS2.p1.12.m12.1.1.2.cmml" xref="S4.SS2.p1.12.m12.1.1.2">𝑔</ci><ci id="S4.SS2.p1.12.m12.1.1.3.cmml" xref="S4.SS2.p1.12.m12.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m12.1c">g_{\mu}</annotation></semantics></math> to obtain the modulation parameters <math id="S4.SS2.p1.13.m13.1" class="ltx_Math" alttext="\bm{\zeta}_{i}" display="inline"><semantics id="S4.SS2.p1.13.m13.1a"><msub id="S4.SS2.p1.13.m13.1.1" xref="S4.SS2.p1.13.m13.1.1.cmml"><mi id="S4.SS2.p1.13.m13.1.1.2" xref="S4.SS2.p1.13.m13.1.1.2.cmml">𝜻</mi><mi id="S4.SS2.p1.13.m13.1.1.3" xref="S4.SS2.p1.13.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m13.1b"><apply id="S4.SS2.p1.13.m13.1.1.cmml" xref="S4.SS2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.13.m13.1.1.1.cmml" xref="S4.SS2.p1.13.m13.1.1">subscript</csymbol><ci id="S4.SS2.p1.13.m13.1.1.2.cmml" xref="S4.SS2.p1.13.m13.1.1.2">𝜻</ci><ci id="S4.SS2.p1.13.m13.1.1.3.cmml" xref="S4.SS2.p1.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m13.1c">\bm{\zeta}_{i}</annotation></semantics></math>, as described in Section <a href="#S4.SS1" title="4.1 Federated Modulator. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>. Note that if <math id="S4.SS2.p1.14.m14.1" class="ltx_Math" alttext="S&gt;1" display="inline"><semantics id="S4.SS2.p1.14.m14.1a"><mrow id="S4.SS2.p1.14.m14.1.1" xref="S4.SS2.p1.14.m14.1.1.cmml"><mi id="S4.SS2.p1.14.m14.1.1.2" xref="S4.SS2.p1.14.m14.1.1.2.cmml">S</mi><mo id="S4.SS2.p1.14.m14.1.1.1" xref="S4.SS2.p1.14.m14.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.p1.14.m14.1.1.3" xref="S4.SS2.p1.14.m14.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m14.1b"><apply id="S4.SS2.p1.14.m14.1.1.cmml" xref="S4.SS2.p1.14.m14.1.1"><gt id="S4.SS2.p1.14.m14.1.1.1.cmml" xref="S4.SS2.p1.14.m14.1.1.1"></gt><ci id="S4.SS2.p1.14.m14.1.1.2.cmml" xref="S4.SS2.p1.14.m14.1.1.2">𝑆</ci><cn type="integer" id="S4.SS2.p1.14.m14.1.1.3.cmml" xref="S4.SS2.p1.14.m14.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.14.m14.1c">S&gt;1</annotation></semantics></math>, an independent batch <math id="S4.SS2.p1.15.m15.1" class="ltx_Math" alttext="\mathcal{D}^{\prime}" display="inline"><semantics id="S4.SS2.p1.15.m15.1a"><msup id="S4.SS2.p1.15.m15.1.1" xref="S4.SS2.p1.15.m15.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.15.m15.1.1.2" xref="S4.SS2.p1.15.m15.1.1.2.cmml">𝒟</mi><mo id="S4.SS2.p1.15.m15.1.1.3" xref="S4.SS2.p1.15.m15.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.15.m15.1b"><apply id="S4.SS2.p1.15.m15.1.1.cmml" xref="S4.SS2.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.15.m15.1.1.1.cmml" xref="S4.SS2.p1.15.m15.1.1">superscript</csymbol><ci id="S4.SS2.p1.15.m15.1.1.2.cmml" xref="S4.SS2.p1.15.m15.1.1.2">𝒟</ci><ci id="S4.SS2.p1.15.m15.1.1.3.cmml" xref="S4.SS2.p1.15.m15.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.15.m15.1c">\mathcal{D}^{\prime}</annotation></semantics></math> is sampled at each iteration. The modulation parameters <math id="S4.SS2.p1.16.m16.1" class="ltx_Math" alttext="\bm{\zeta}_{i}" display="inline"><semantics id="S4.SS2.p1.16.m16.1a"><msub id="S4.SS2.p1.16.m16.1.1" xref="S4.SS2.p1.16.m16.1.1.cmml"><mi id="S4.SS2.p1.16.m16.1.1.2" xref="S4.SS2.p1.16.m16.1.1.2.cmml">𝜻</mi><mi id="S4.SS2.p1.16.m16.1.1.3" xref="S4.SS2.p1.16.m16.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.16.m16.1b"><apply id="S4.SS2.p1.16.m16.1.1.cmml" xref="S4.SS2.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.16.m16.1.1.1.cmml" xref="S4.SS2.p1.16.m16.1.1">subscript</csymbol><ci id="S4.SS2.p1.16.m16.1.1.2.cmml" xref="S4.SS2.p1.16.m16.1.1.2">𝜻</ci><ci id="S4.SS2.p1.16.m16.1.1.3.cmml" xref="S4.SS2.p1.16.m16.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.16.m16.1c">\bm{\zeta}_{i}</annotation></semantics></math> are then used to modulate the activations of the base network, resulting in a <em id="S4.SS2.p1.23.2" class="ltx_emph ltx_font_italic">modulated model</em> denoted by <math id="S4.SS2.p1.17.m17.1" class="ltx_Math" alttext="f_{\psi}|\bm{\zeta}_{i}" display="inline"><semantics id="S4.SS2.p1.17.m17.1a"><mrow id="S4.SS2.p1.17.m17.1.1" xref="S4.SS2.p1.17.m17.1.1.cmml"><msub id="S4.SS2.p1.17.m17.1.1.2" xref="S4.SS2.p1.17.m17.1.1.2.cmml"><mi id="S4.SS2.p1.17.m17.1.1.2.2" xref="S4.SS2.p1.17.m17.1.1.2.2.cmml">f</mi><mi id="S4.SS2.p1.17.m17.1.1.2.3" xref="S4.SS2.p1.17.m17.1.1.2.3.cmml">ψ</mi></msub><mo fence="false" id="S4.SS2.p1.17.m17.1.1.1" xref="S4.SS2.p1.17.m17.1.1.1.cmml">|</mo><msub id="S4.SS2.p1.17.m17.1.1.3" xref="S4.SS2.p1.17.m17.1.1.3.cmml"><mi id="S4.SS2.p1.17.m17.1.1.3.2" xref="S4.SS2.p1.17.m17.1.1.3.2.cmml">𝜻</mi><mi id="S4.SS2.p1.17.m17.1.1.3.3" xref="S4.SS2.p1.17.m17.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.17.m17.1b"><apply id="S4.SS2.p1.17.m17.1.1.cmml" xref="S4.SS2.p1.17.m17.1.1"><csymbol cd="latexml" id="S4.SS2.p1.17.m17.1.1.1.cmml" xref="S4.SS2.p1.17.m17.1.1.1">conditional</csymbol><apply id="S4.SS2.p1.17.m17.1.1.2.cmml" xref="S4.SS2.p1.17.m17.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.17.m17.1.1.2.1.cmml" xref="S4.SS2.p1.17.m17.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.17.m17.1.1.2.2.cmml" xref="S4.SS2.p1.17.m17.1.1.2.2">𝑓</ci><ci id="S4.SS2.p1.17.m17.1.1.2.3.cmml" xref="S4.SS2.p1.17.m17.1.1.2.3">𝜓</ci></apply><apply id="S4.SS2.p1.17.m17.1.1.3.cmml" xref="S4.SS2.p1.17.m17.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.17.m17.1.1.3.1.cmml" xref="S4.SS2.p1.17.m17.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.17.m17.1.1.3.2.cmml" xref="S4.SS2.p1.17.m17.1.1.3.2">𝜻</ci><ci id="S4.SS2.p1.17.m17.1.1.3.3.cmml" xref="S4.SS2.p1.17.m17.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.17.m17.1c">f_{\psi}|\bm{\zeta}_{i}</annotation></semantics></math> which is more personalized for the client at hand. To better explain the modulated network <math id="S4.SS2.p1.18.m18.1" class="ltx_Math" alttext="f_{\psi}|\bm{\zeta}_{i}" display="inline"><semantics id="S4.SS2.p1.18.m18.1a"><mrow id="S4.SS2.p1.18.m18.1.1" xref="S4.SS2.p1.18.m18.1.1.cmml"><msub id="S4.SS2.p1.18.m18.1.1.2" xref="S4.SS2.p1.18.m18.1.1.2.cmml"><mi id="S4.SS2.p1.18.m18.1.1.2.2" xref="S4.SS2.p1.18.m18.1.1.2.2.cmml">f</mi><mi id="S4.SS2.p1.18.m18.1.1.2.3" xref="S4.SS2.p1.18.m18.1.1.2.3.cmml">ψ</mi></msub><mo fence="false" id="S4.SS2.p1.18.m18.1.1.1" xref="S4.SS2.p1.18.m18.1.1.1.cmml">|</mo><msub id="S4.SS2.p1.18.m18.1.1.3" xref="S4.SS2.p1.18.m18.1.1.3.cmml"><mi id="S4.SS2.p1.18.m18.1.1.3.2" xref="S4.SS2.p1.18.m18.1.1.3.2.cmml">𝜻</mi><mi id="S4.SS2.p1.18.m18.1.1.3.3" xref="S4.SS2.p1.18.m18.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.18.m18.1b"><apply id="S4.SS2.p1.18.m18.1.1.cmml" xref="S4.SS2.p1.18.m18.1.1"><csymbol cd="latexml" id="S4.SS2.p1.18.m18.1.1.1.cmml" xref="S4.SS2.p1.18.m18.1.1.1">conditional</csymbol><apply id="S4.SS2.p1.18.m18.1.1.2.cmml" xref="S4.SS2.p1.18.m18.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.18.m18.1.1.2.1.cmml" xref="S4.SS2.p1.18.m18.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.18.m18.1.1.2.2.cmml" xref="S4.SS2.p1.18.m18.1.1.2.2">𝑓</ci><ci id="S4.SS2.p1.18.m18.1.1.2.3.cmml" xref="S4.SS2.p1.18.m18.1.1.2.3">𝜓</ci></apply><apply id="S4.SS2.p1.18.m18.1.1.3.cmml" xref="S4.SS2.p1.18.m18.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.18.m18.1.1.3.1.cmml" xref="S4.SS2.p1.18.m18.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.18.m18.1.1.3.2.cmml" xref="S4.SS2.p1.18.m18.1.1.3.2">𝜻</ci><ci id="S4.SS2.p1.18.m18.1.1.3.3.cmml" xref="S4.SS2.p1.18.m18.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.18.m18.1c">f_{\psi}|\bm{\zeta}_{i}</annotation></semantics></math>, let us examine the activations <math id="S4.SS2.p1.19.m19.1" class="ltx_Math" alttext="a(\mathbf{x}~{}\psi^{l})" display="inline"><semantics id="S4.SS2.p1.19.m19.1a"><mrow id="S4.SS2.p1.19.m19.1.1" xref="S4.SS2.p1.19.m19.1.1.cmml"><mi id="S4.SS2.p1.19.m19.1.1.3" xref="S4.SS2.p1.19.m19.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.19.m19.1.1.2" xref="S4.SS2.p1.19.m19.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.19.m19.1.1.1.1" xref="S4.SS2.p1.19.m19.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.19.m19.1.1.1.1.2" xref="S4.SS2.p1.19.m19.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.19.m19.1.1.1.1.1" xref="S4.SS2.p1.19.m19.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.19.m19.1.1.1.1.1.2" xref="S4.SS2.p1.19.m19.1.1.1.1.1.2.cmml">𝐱</mi><mo lspace="0.330em" rspace="0em" id="S4.SS2.p1.19.m19.1.1.1.1.1.1" xref="S4.SS2.p1.19.m19.1.1.1.1.1.1.cmml">​</mo><msup id="S4.SS2.p1.19.m19.1.1.1.1.1.3" xref="S4.SS2.p1.19.m19.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.19.m19.1.1.1.1.1.3.2" xref="S4.SS2.p1.19.m19.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S4.SS2.p1.19.m19.1.1.1.1.1.3.3" xref="S4.SS2.p1.19.m19.1.1.1.1.1.3.3.cmml">l</mi></msup></mrow><mo stretchy="false" id="S4.SS2.p1.19.m19.1.1.1.1.3" xref="S4.SS2.p1.19.m19.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.19.m19.1b"><apply id="S4.SS2.p1.19.m19.1.1.cmml" xref="S4.SS2.p1.19.m19.1.1"><times id="S4.SS2.p1.19.m19.1.1.2.cmml" xref="S4.SS2.p1.19.m19.1.1.2"></times><ci id="S4.SS2.p1.19.m19.1.1.3.cmml" xref="S4.SS2.p1.19.m19.1.1.3">𝑎</ci><apply id="S4.SS2.p1.19.m19.1.1.1.1.1.cmml" xref="S4.SS2.p1.19.m19.1.1.1.1"><times id="S4.SS2.p1.19.m19.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.19.m19.1.1.1.1.1.1"></times><ci id="S4.SS2.p1.19.m19.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.19.m19.1.1.1.1.1.2">𝐱</ci><apply id="S4.SS2.p1.19.m19.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.19.m19.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.19.m19.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.19.m19.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.19.m19.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.19.m19.1.1.1.1.1.3.2">𝜓</ci><ci id="S4.SS2.p1.19.m19.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.19.m19.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.19.m19.1c">a(\mathbf{x}~{}\psi^{l})</annotation></semantics></math> produced by a particular layer <math id="S4.SS2.p1.20.m20.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS2.p1.20.m20.1a"><mi id="S4.SS2.p1.20.m20.1.1" xref="S4.SS2.p1.20.m20.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.20.m20.1b"><ci id="S4.SS2.p1.20.m20.1.1.cmml" xref="S4.SS2.p1.20.m20.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.20.m20.1c">l</annotation></semantics></math>. Using modulation parameters <math id="S4.SS2.p1.21.m21.1" class="ltx_Math" alttext="\zeta_{i}^{l}" display="inline"><semantics id="S4.SS2.p1.21.m21.1a"><msubsup id="S4.SS2.p1.21.m21.1.1" xref="S4.SS2.p1.21.m21.1.1.cmml"><mi id="S4.SS2.p1.21.m21.1.1.2.2" xref="S4.SS2.p1.21.m21.1.1.2.2.cmml">ζ</mi><mi id="S4.SS2.p1.21.m21.1.1.2.3" xref="S4.SS2.p1.21.m21.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p1.21.m21.1.1.3" xref="S4.SS2.p1.21.m21.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.21.m21.1b"><apply id="S4.SS2.p1.21.m21.1.1.cmml" xref="S4.SS2.p1.21.m21.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.21.m21.1.1.1.cmml" xref="S4.SS2.p1.21.m21.1.1">superscript</csymbol><apply id="S4.SS2.p1.21.m21.1.1.2.cmml" xref="S4.SS2.p1.21.m21.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.21.m21.1.1.2.1.cmml" xref="S4.SS2.p1.21.m21.1.1">subscript</csymbol><ci id="S4.SS2.p1.21.m21.1.1.2.2.cmml" xref="S4.SS2.p1.21.m21.1.1.2.2">𝜁</ci><ci id="S4.SS2.p1.21.m21.1.1.2.3.cmml" xref="S4.SS2.p1.21.m21.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p1.21.m21.1.1.3.cmml" xref="S4.SS2.p1.21.m21.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.21.m21.1c">\zeta_{i}^{l}</annotation></semantics></math>, the activations can be transformed to produce modulated activations, indicated as <math id="S4.SS2.p1.22.m22.1" class="ltx_Math" alttext="a(\mathbf{x}~{}\psi^{l})\odot\zeta_{i}^{l}" display="inline"><semantics id="S4.SS2.p1.22.m22.1a"><mrow id="S4.SS2.p1.22.m22.1.1" xref="S4.SS2.p1.22.m22.1.1.cmml"><mrow id="S4.SS2.p1.22.m22.1.1.1" xref="S4.SS2.p1.22.m22.1.1.1.cmml"><mi id="S4.SS2.p1.22.m22.1.1.1.3" xref="S4.SS2.p1.22.m22.1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.22.m22.1.1.1.2" xref="S4.SS2.p1.22.m22.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.22.m22.1.1.1.1.1" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.22.m22.1.1.1.1.1.2" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.22.m22.1.1.1.1.1.1" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.22.m22.1.1.1.1.1.1.2" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.2.cmml">𝐱</mi><mo lspace="0.330em" rspace="0em" id="S4.SS2.p1.22.m22.1.1.1.1.1.1.1" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.1.cmml">​</mo><msup id="S4.SS2.p1.22.m22.1.1.1.1.1.1.3" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.22.m22.1.1.1.1.1.1.3.2" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S4.SS2.p1.22.m22.1.1.1.1.1.1.3.3" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.3.3.cmml">l</mi></msup></mrow><mo rspace="0.055em" stretchy="false" id="S4.SS2.p1.22.m22.1.1.1.1.1.3" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S4.SS2.p1.22.m22.1.1.2" xref="S4.SS2.p1.22.m22.1.1.2.cmml">⊙</mo><msubsup id="S4.SS2.p1.22.m22.1.1.3" xref="S4.SS2.p1.22.m22.1.1.3.cmml"><mi id="S4.SS2.p1.22.m22.1.1.3.2.2" xref="S4.SS2.p1.22.m22.1.1.3.2.2.cmml">ζ</mi><mi id="S4.SS2.p1.22.m22.1.1.3.2.3" xref="S4.SS2.p1.22.m22.1.1.3.2.3.cmml">i</mi><mi id="S4.SS2.p1.22.m22.1.1.3.3" xref="S4.SS2.p1.22.m22.1.1.3.3.cmml">l</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.22.m22.1b"><apply id="S4.SS2.p1.22.m22.1.1.cmml" xref="S4.SS2.p1.22.m22.1.1"><csymbol cd="latexml" id="S4.SS2.p1.22.m22.1.1.2.cmml" xref="S4.SS2.p1.22.m22.1.1.2">direct-product</csymbol><apply id="S4.SS2.p1.22.m22.1.1.1.cmml" xref="S4.SS2.p1.22.m22.1.1.1"><times id="S4.SS2.p1.22.m22.1.1.1.2.cmml" xref="S4.SS2.p1.22.m22.1.1.1.2"></times><ci id="S4.SS2.p1.22.m22.1.1.1.3.cmml" xref="S4.SS2.p1.22.m22.1.1.1.3">𝑎</ci><apply id="S4.SS2.p1.22.m22.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.22.m22.1.1.1.1.1"><times id="S4.SS2.p1.22.m22.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.1"></times><ci id="S4.SS2.p1.22.m22.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.2">𝐱</ci><apply id="S4.SS2.p1.22.m22.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.22.m22.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.22.m22.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.3.2">𝜓</ci><ci id="S4.SS2.p1.22.m22.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.22.m22.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><apply id="S4.SS2.p1.22.m22.1.1.3.cmml" xref="S4.SS2.p1.22.m22.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.22.m22.1.1.3.1.cmml" xref="S4.SS2.p1.22.m22.1.1.3">superscript</csymbol><apply id="S4.SS2.p1.22.m22.1.1.3.2.cmml" xref="S4.SS2.p1.22.m22.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.22.m22.1.1.3.2.1.cmml" xref="S4.SS2.p1.22.m22.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.22.m22.1.1.3.2.2.cmml" xref="S4.SS2.p1.22.m22.1.1.3.2.2">𝜁</ci><ci id="S4.SS2.p1.22.m22.1.1.3.2.3.cmml" xref="S4.SS2.p1.22.m22.1.1.3.2.3">𝑖</ci></apply><ci id="S4.SS2.p1.22.m22.1.1.3.3.cmml" xref="S4.SS2.p1.22.m22.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.22.m22.1c">a(\mathbf{x}~{}\psi^{l})\odot\zeta_{i}^{l}</annotation></semantics></math>, as exemplified by Equation <a href="#S4.E4" title="In 4.2 Algorithm. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>. This equation outlines a “sigmoidal gating” mechanism that enables <math id="S4.SS2.p1.23.m23.1" class="ltx_Math" alttext="\zeta_{i}^{l}" display="inline"><semantics id="S4.SS2.p1.23.m23.1a"><msubsup id="S4.SS2.p1.23.m23.1.1" xref="S4.SS2.p1.23.m23.1.1.cmml"><mi id="S4.SS2.p1.23.m23.1.1.2.2" xref="S4.SS2.p1.23.m23.1.1.2.2.cmml">ζ</mi><mi id="S4.SS2.p1.23.m23.1.1.2.3" xref="S4.SS2.p1.23.m23.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p1.23.m23.1.1.3" xref="S4.SS2.p1.23.m23.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.23.m23.1b"><apply id="S4.SS2.p1.23.m23.1.1.cmml" xref="S4.SS2.p1.23.m23.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.23.m23.1.1.1.cmml" xref="S4.SS2.p1.23.m23.1.1">superscript</csymbol><apply id="S4.SS2.p1.23.m23.1.1.2.cmml" xref="S4.SS2.p1.23.m23.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.23.m23.1.1.2.1.cmml" xref="S4.SS2.p1.23.m23.1.1">subscript</csymbol><ci id="S4.SS2.p1.23.m23.1.1.2.2.cmml" xref="S4.SS2.p1.23.m23.1.1.2.2">𝜁</ci><ci id="S4.SS2.p1.23.m23.1.1.2.3.cmml" xref="S4.SS2.p1.23.m23.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p1.23.m23.1.1.3.cmml" xref="S4.SS2.p1.23.m23.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.23.m23.1c">\zeta_{i}^{l}</annotation></semantics></math> to determine which activations are propagated forward to the next layers and which are zeroed out. Note that this approach is not restricted to this type of modulation, but we believe that gating the model’s activations is sufficient to specialize the model to specific clients while simultaneously leveraging the knowledge learned from other clients.</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4.4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.1" class="ltx_Math" alttext="a(\mathbf{x}~{}\psi^{l})\odot\zeta_{i}^{l}=a(\mathbf{x}~{}\psi^{l})\otimes\sigma(\zeta_{i}^{l})," display="block"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mo lspace="0.330em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msup></mrow><mo rspace="0.055em" stretchy="false" id="S4.E4.m1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S4.E4.m1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.2.cmml">⊙</mo><msubsup id="S4.E4.m1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.3.2.2" xref="S4.E4.m1.1.1.1.1.1.3.2.2.cmml">ζ</mi><mi id="S4.E4.m1.1.1.1.1.1.3.2.3" xref="S4.E4.m1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S4.E4.m1.1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.1.3.3.cmml">l</mi></msubsup></mrow><mo id="S4.E4.m1.1.1.1.1.4" xref="S4.E4.m1.1.1.1.1.4.cmml">=</mo><mrow id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.3.cmml"><mrow id="S4.E4.m1.1.1.1.1.2.1" xref="S4.E4.m1.1.1.1.1.2.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.2.1.1" xref="S4.E4.m1.1.1.1.1.2.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.2.1.1.3" xref="S4.E4.m1.1.1.1.1.2.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.2.1.1.2" xref="S4.E4.m1.1.1.1.1.2.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.1.1.1.1.2.1.1.1.1" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.1.1.1.1.2.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.2.cmml">𝐱</mi><mo lspace="0.330em" rspace="0em" id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.1.cmml">​</mo><msup id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3.3.cmml">l</mi></msup></mrow><mo rspace="0.055em" stretchy="false" id="S4.E4.m1.1.1.1.1.2.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S4.E4.m1.1.1.1.1.2.1.2" xref="S4.E4.m1.1.1.1.1.2.1.2.cmml">⊗</mo><mi id="S4.E4.m1.1.1.1.1.2.1.3" xref="S4.E4.m1.1.1.1.1.2.1.3.cmml">σ</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.3.3.cmml">​</mo><mrow id="S4.E4.m1.1.1.1.1.3.2.1" xref="S4.E4.m1.1.1.1.1.3.2.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.1.1.1.1.3.2.1.2" xref="S4.E4.m1.1.1.1.1.3.2.1.1.cmml">(</mo><msubsup id="S4.E4.m1.1.1.1.1.3.2.1.1" xref="S4.E4.m1.1.1.1.1.3.2.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.3.2.1.1.2.2" xref="S4.E4.m1.1.1.1.1.3.2.1.1.2.2.cmml">ζ</mi><mi id="S4.E4.m1.1.1.1.1.3.2.1.1.2.3" xref="S4.E4.m1.1.1.1.1.3.2.1.1.2.3.cmml">i</mi><mi id="S4.E4.m1.1.1.1.1.3.2.1.1.3" xref="S4.E4.m1.1.1.1.1.3.2.1.1.3.cmml">l</mi></msubsup><mo stretchy="false" id="S4.E4.m1.1.1.1.1.3.2.1.3" xref="S4.E4.m1.1.1.1.1.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><eq id="S4.E4.m1.1.1.1.1.4.cmml" xref="S4.E4.m1.1.1.1.1.4"></eq><apply id="S4.E4.m1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.2">direct-product</csymbol><apply id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1"><times id="S4.E4.m1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2"></times><ci id="S4.E4.m1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.3">𝑎</ci><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1"><times id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2">𝜓</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><apply id="S4.E4.m1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.3.2.2">𝜁</ci><ci id="S4.E4.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E4.m1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="S4.E4.m1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3"><times id="S4.E4.m1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.3.3"></times><apply id="S4.E4.m1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1"><csymbol cd="latexml" id="S4.E4.m1.1.1.1.1.2.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.2">tensor-product</csymbol><apply id="S4.E4.m1.1.1.1.1.2.1.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1"><times id="S4.E4.m1.1.1.1.1.2.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.2"></times><ci id="S4.E4.m1.1.1.1.1.2.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.3">𝑎</ci><apply id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1"><times id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.1"></times><ci id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.2">𝐱</ci><apply id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3.2">𝜓</ci><ci id="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><ci id="S4.E4.m1.1.1.1.1.2.1.3.cmml" xref="S4.E4.m1.1.1.1.1.2.1.3">𝜎</ci></apply><apply id="S4.E4.m1.1.1.1.1.3.2.1.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.2.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.3.2.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.2.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.3.2.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1.1.2.2">𝜁</ci><ci id="S4.E4.m1.1.1.1.1.3.2.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1.1.2.3">𝑖</ci></apply><ci id="S4.E4.m1.1.1.1.1.3.2.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1.1.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">a(\mathbf{x}~{}\psi^{l})\odot\zeta_{i}^{l}=a(\mathbf{x}~{}\psi^{l})\otimes\sigma(\zeta_{i}^{l}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.36" class="ltx_p">where <math id="S4.SS2.p1.24.m1.1" class="ltx_Math" alttext="\otimes" display="inline"><semantics id="S4.SS2.p1.24.m1.1a"><mo id="S4.SS2.p1.24.m1.1.1" xref="S4.SS2.p1.24.m1.1.1.cmml">⊗</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.24.m1.1b"><csymbol cd="latexml" id="S4.SS2.p1.24.m1.1.1.cmml" xref="S4.SS2.p1.24.m1.1.1">tensor-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.24.m1.1c">\otimes</annotation></semantics></math> denotes an element-wise multiplication and <math id="S4.SS2.p1.25.m2.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS2.p1.25.m2.1a"><mi id="S4.SS2.p1.25.m2.1.1" xref="S4.SS2.p1.25.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.25.m2.1b"><ci id="S4.SS2.p1.25.m2.1.1.cmml" xref="S4.SS2.p1.25.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.25.m2.1c">\sigma</annotation></semantics></math> is the sigmoid function making each value of <math id="S4.SS2.p1.26.m3.1" class="ltx_Math" alttext="\zeta_{i}^{l}" display="inline"><semantics id="S4.SS2.p1.26.m3.1a"><msubsup id="S4.SS2.p1.26.m3.1.1" xref="S4.SS2.p1.26.m3.1.1.cmml"><mi id="S4.SS2.p1.26.m3.1.1.2.2" xref="S4.SS2.p1.26.m3.1.1.2.2.cmml">ζ</mi><mi id="S4.SS2.p1.26.m3.1.1.2.3" xref="S4.SS2.p1.26.m3.1.1.2.3.cmml">i</mi><mi id="S4.SS2.p1.26.m3.1.1.3" xref="S4.SS2.p1.26.m3.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.26.m3.1b"><apply id="S4.SS2.p1.26.m3.1.1.cmml" xref="S4.SS2.p1.26.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.26.m3.1.1.1.cmml" xref="S4.SS2.p1.26.m3.1.1">superscript</csymbol><apply id="S4.SS2.p1.26.m3.1.1.2.cmml" xref="S4.SS2.p1.26.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.26.m3.1.1.2.1.cmml" xref="S4.SS2.p1.26.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.26.m3.1.1.2.2.cmml" xref="S4.SS2.p1.26.m3.1.1.2.2">𝜁</ci><ci id="S4.SS2.p1.26.m3.1.1.2.3.cmml" xref="S4.SS2.p1.26.m3.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p1.26.m3.1.1.3.cmml" xref="S4.SS2.p1.26.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.26.m3.1c">\zeta_{i}^{l}</annotation></semantics></math> in the range <math id="S4.SS2.p1.27.m4.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S4.SS2.p1.27.m4.2a"><mrow id="S4.SS2.p1.27.m4.2.3.2" xref="S4.SS2.p1.27.m4.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p1.27.m4.2.3.2.1" xref="S4.SS2.p1.27.m4.2.3.1.cmml">[</mo><mn id="S4.SS2.p1.27.m4.1.1" xref="S4.SS2.p1.27.m4.1.1.cmml">0</mn><mo id="S4.SS2.p1.27.m4.2.3.2.2" xref="S4.SS2.p1.27.m4.2.3.1.cmml">,</mo><mn id="S4.SS2.p1.27.m4.2.2" xref="S4.SS2.p1.27.m4.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS2.p1.27.m4.2.3.2.3" xref="S4.SS2.p1.27.m4.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.27.m4.2b"><interval closure="closed" id="S4.SS2.p1.27.m4.2.3.1.cmml" xref="S4.SS2.p1.27.m4.2.3.2"><cn type="integer" id="S4.SS2.p1.27.m4.1.1.cmml" xref="S4.SS2.p1.27.m4.1.1">0</cn><cn type="integer" id="S4.SS2.p1.27.m4.2.2.cmml" xref="S4.SS2.p1.27.m4.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.27.m4.2c">[0,1]</annotation></semantics></math>. The parameters <math id="S4.SS2.p1.28.m5.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS2.p1.28.m5.1a"><mi id="S4.SS2.p1.28.m5.1.1" xref="S4.SS2.p1.28.m5.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.28.m5.1b"><ci id="S4.SS2.p1.28.m5.1.1.cmml" xref="S4.SS2.p1.28.m5.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.28.m5.1c">\mu</annotation></semantics></math> and <math id="S4.SS2.p1.29.m6.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.SS2.p1.29.m6.1a"><mi id="S4.SS2.p1.29.m6.1.1" xref="S4.SS2.p1.29.m6.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.29.m6.1b"><ci id="S4.SS2.p1.29.m6.1.1.cmml" xref="S4.SS2.p1.29.m6.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.29.m6.1c">\psi</annotation></semantics></math> are then personalized to the specific client in lines 5 and 6 of Algorithm <a href="#alg2" title="Algorithm 2 ‣ 4.2 Algorithm. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, resulting in client-specific parameters <math id="S4.SS2.p1.30.m7.1" class="ltx_Math" alttext="\mu^{\prime}" display="inline"><semantics id="S4.SS2.p1.30.m7.1a"><msup id="S4.SS2.p1.30.m7.1.1" xref="S4.SS2.p1.30.m7.1.1.cmml"><mi id="S4.SS2.p1.30.m7.1.1.2" xref="S4.SS2.p1.30.m7.1.1.2.cmml">μ</mi><mo id="S4.SS2.p1.30.m7.1.1.3" xref="S4.SS2.p1.30.m7.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.30.m7.1b"><apply id="S4.SS2.p1.30.m7.1.1.cmml" xref="S4.SS2.p1.30.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.30.m7.1.1.1.cmml" xref="S4.SS2.p1.30.m7.1.1">superscript</csymbol><ci id="S4.SS2.p1.30.m7.1.1.2.cmml" xref="S4.SS2.p1.30.m7.1.1.2">𝜇</ci><ci id="S4.SS2.p1.30.m7.1.1.3.cmml" xref="S4.SS2.p1.30.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.30.m7.1c">\mu^{\prime}</annotation></semantics></math> and <math id="S4.SS2.p1.31.m8.1" class="ltx_Math" alttext="\psi^{\prime}" display="inline"><semantics id="S4.SS2.p1.31.m8.1a"><msup id="S4.SS2.p1.31.m8.1.1" xref="S4.SS2.p1.31.m8.1.1.cmml"><mi id="S4.SS2.p1.31.m8.1.1.2" xref="S4.SS2.p1.31.m8.1.1.2.cmml">ψ</mi><mo id="S4.SS2.p1.31.m8.1.1.3" xref="S4.SS2.p1.31.m8.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.31.m8.1b"><apply id="S4.SS2.p1.31.m8.1.1.cmml" xref="S4.SS2.p1.31.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.31.m8.1.1.1.cmml" xref="S4.SS2.p1.31.m8.1.1">superscript</csymbol><ci id="S4.SS2.p1.31.m8.1.1.2.cmml" xref="S4.SS2.p1.31.m8.1.1.2">𝜓</ci><ci id="S4.SS2.p1.31.m8.1.1.3.cmml" xref="S4.SS2.p1.31.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.31.m8.1c">\psi^{\prime}</annotation></semantics></math>, respectively. This personalization is performed in a MAML-based manner, see Equation <a href="#S3.E2" title="In 3 Background and Notation ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, but the loss is now computed with a batch of data <math id="S4.SS2.p1.32.m9.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{\prime}" display="inline"><semantics id="S4.SS2.p1.32.m9.1a"><msubsup id="S4.SS2.p1.32.m9.1.1" xref="S4.SS2.p1.32.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.32.m9.1.1.2.2" xref="S4.SS2.p1.32.m9.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS2.p1.32.m9.1.1.2.3" xref="S4.SS2.p1.32.m9.1.1.2.3.cmml">i</mi><mo id="S4.SS2.p1.32.m9.1.1.3" xref="S4.SS2.p1.32.m9.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.32.m9.1b"><apply id="S4.SS2.p1.32.m9.1.1.cmml" xref="S4.SS2.p1.32.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.32.m9.1.1.1.cmml" xref="S4.SS2.p1.32.m9.1.1">superscript</csymbol><apply id="S4.SS2.p1.32.m9.1.1.2.cmml" xref="S4.SS2.p1.32.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.32.m9.1.1.2.1.cmml" xref="S4.SS2.p1.32.m9.1.1">subscript</csymbol><ci id="S4.SS2.p1.32.m9.1.1.2.2.cmml" xref="S4.SS2.p1.32.m9.1.1.2.2">𝒟</ci><ci id="S4.SS2.p1.32.m9.1.1.2.3.cmml" xref="S4.SS2.p1.32.m9.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p1.32.m9.1.1.3.cmml" xref="S4.SS2.p1.32.m9.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.32.m9.1c">\mathcal{D}_{i}^{\prime}</annotation></semantics></math> (not necessarily small as in MAML), and with <math id="S4.SS2.p1.33.m10.1" class="ltx_Math" alttext="f_{\psi}|\bm{\zeta}_{i}" display="inline"><semantics id="S4.SS2.p1.33.m10.1a"><mrow id="S4.SS2.p1.33.m10.1.1" xref="S4.SS2.p1.33.m10.1.1.cmml"><msub id="S4.SS2.p1.33.m10.1.1.2" xref="S4.SS2.p1.33.m10.1.1.2.cmml"><mi id="S4.SS2.p1.33.m10.1.1.2.2" xref="S4.SS2.p1.33.m10.1.1.2.2.cmml">f</mi><mi id="S4.SS2.p1.33.m10.1.1.2.3" xref="S4.SS2.p1.33.m10.1.1.2.3.cmml">ψ</mi></msub><mo fence="false" id="S4.SS2.p1.33.m10.1.1.1" xref="S4.SS2.p1.33.m10.1.1.1.cmml">|</mo><msub id="S4.SS2.p1.33.m10.1.1.3" xref="S4.SS2.p1.33.m10.1.1.3.cmml"><mi id="S4.SS2.p1.33.m10.1.1.3.2" xref="S4.SS2.p1.33.m10.1.1.3.2.cmml">𝜻</mi><mi id="S4.SS2.p1.33.m10.1.1.3.3" xref="S4.SS2.p1.33.m10.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.33.m10.1b"><apply id="S4.SS2.p1.33.m10.1.1.cmml" xref="S4.SS2.p1.33.m10.1.1"><csymbol cd="latexml" id="S4.SS2.p1.33.m10.1.1.1.cmml" xref="S4.SS2.p1.33.m10.1.1.1">conditional</csymbol><apply id="S4.SS2.p1.33.m10.1.1.2.cmml" xref="S4.SS2.p1.33.m10.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.33.m10.1.1.2.1.cmml" xref="S4.SS2.p1.33.m10.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.33.m10.1.1.2.2.cmml" xref="S4.SS2.p1.33.m10.1.1.2.2">𝑓</ci><ci id="S4.SS2.p1.33.m10.1.1.2.3.cmml" xref="S4.SS2.p1.33.m10.1.1.2.3">𝜓</ci></apply><apply id="S4.SS2.p1.33.m10.1.1.3.cmml" xref="S4.SS2.p1.33.m10.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.33.m10.1.1.3.1.cmml" xref="S4.SS2.p1.33.m10.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.33.m10.1.1.3.2.cmml" xref="S4.SS2.p1.33.m10.1.1.3.2">𝜻</ci><ci id="S4.SS2.p1.33.m10.1.1.3.3.cmml" xref="S4.SS2.p1.33.m10.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.33.m10.1c">f_{\psi}|\bm{\zeta}_{i}</annotation></semantics></math> that is the base model whose activations have been transformed with the parameters of the modulation layers. This process can be iterated for <math id="S4.SS2.p1.34.m11.1" class="ltx_Math" alttext="S\geq 1" display="inline"><semantics id="S4.SS2.p1.34.m11.1a"><mrow id="S4.SS2.p1.34.m11.1.1" xref="S4.SS2.p1.34.m11.1.1.cmml"><mi id="S4.SS2.p1.34.m11.1.1.2" xref="S4.SS2.p1.34.m11.1.1.2.cmml">S</mi><mo id="S4.SS2.p1.34.m11.1.1.1" xref="S4.SS2.p1.34.m11.1.1.1.cmml">≥</mo><mn id="S4.SS2.p1.34.m11.1.1.3" xref="S4.SS2.p1.34.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.34.m11.1b"><apply id="S4.SS2.p1.34.m11.1.1.cmml" xref="S4.SS2.p1.34.m11.1.1"><geq id="S4.SS2.p1.34.m11.1.1.1.cmml" xref="S4.SS2.p1.34.m11.1.1.1"></geq><ci id="S4.SS2.p1.34.m11.1.1.2.cmml" xref="S4.SS2.p1.34.m11.1.1.2">𝑆</ci><cn type="integer" id="S4.SS2.p1.34.m11.1.1.3.cmml" xref="S4.SS2.p1.34.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.34.m11.1c">S\geq 1</annotation></semantics></math> gradient descent steps, and the personalized parameters <math id="S4.SS2.p1.35.m12.1" class="ltx_Math" alttext="\psi_{i}^{\prime}" display="inline"><semantics id="S4.SS2.p1.35.m12.1a"><msubsup id="S4.SS2.p1.35.m12.1.1" xref="S4.SS2.p1.35.m12.1.1.cmml"><mi id="S4.SS2.p1.35.m12.1.1.2.2" xref="S4.SS2.p1.35.m12.1.1.2.2.cmml">ψ</mi><mi id="S4.SS2.p1.35.m12.1.1.2.3" xref="S4.SS2.p1.35.m12.1.1.2.3.cmml">i</mi><mo id="S4.SS2.p1.35.m12.1.1.3" xref="S4.SS2.p1.35.m12.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.35.m12.1b"><apply id="S4.SS2.p1.35.m12.1.1.cmml" xref="S4.SS2.p1.35.m12.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.35.m12.1.1.1.cmml" xref="S4.SS2.p1.35.m12.1.1">superscript</csymbol><apply id="S4.SS2.p1.35.m12.1.1.2.cmml" xref="S4.SS2.p1.35.m12.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.35.m12.1.1.2.1.cmml" xref="S4.SS2.p1.35.m12.1.1">subscript</csymbol><ci id="S4.SS2.p1.35.m12.1.1.2.2.cmml" xref="S4.SS2.p1.35.m12.1.1.2.2">𝜓</ci><ci id="S4.SS2.p1.35.m12.1.1.2.3.cmml" xref="S4.SS2.p1.35.m12.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p1.35.m12.1.1.3.cmml" xref="S4.SS2.p1.35.m12.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.35.m12.1c">\psi_{i}^{\prime}</annotation></semantics></math> and <math id="S4.SS2.p1.36.m13.1" class="ltx_Math" alttext="\bm{\zeta}_{i}" display="inline"><semantics id="S4.SS2.p1.36.m13.1a"><msub id="S4.SS2.p1.36.m13.1.1" xref="S4.SS2.p1.36.m13.1.1.cmml"><mi id="S4.SS2.p1.36.m13.1.1.2" xref="S4.SS2.p1.36.m13.1.1.2.cmml">𝜻</mi><mi id="S4.SS2.p1.36.m13.1.1.3" xref="S4.SS2.p1.36.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.36.m13.1b"><apply id="S4.SS2.p1.36.m13.1.1.cmml" xref="S4.SS2.p1.36.m13.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.36.m13.1.1.1.cmml" xref="S4.SS2.p1.36.m13.1.1">subscript</csymbol><ci id="S4.SS2.p1.36.m13.1.1.2.cmml" xref="S4.SS2.p1.36.m13.1.1.2">𝜻</ci><ci id="S4.SS2.p1.36.m13.1.1.3.cmml" xref="S4.SS2.p1.36.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.36.m13.1c">\bm{\zeta}_{i}</annotation></semantics></math> are returned.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.9" class="ltx_p">In line 8 of Algorithm <a href="#alg1" title="Algorithm 1 ‣ 4.2 Algorithm. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the initial set of parameters <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\omega</annotation></semantics></math> is updated, similarly to Equation <a href="#S3.E3" title="In 3 Background and Notation ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>, by minimizing the loss computed on <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{eval}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><msubsup id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.2.m2.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS2.p2.2.m2.1.1.2.3" xref="S4.SS2.p2.2.m2.1.1.2.3.cmml">i</mi><mrow id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.3.1" xref="S4.SS2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.3.1a" xref="S4.SS2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.3.4" xref="S4.SS2.p2.2.m2.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.3.1b" xref="S4.SS2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.3.5" xref="S4.SS2.p2.2.m2.1.1.3.5.cmml">l</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">superscript</csymbol><apply id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2.2">𝒟</ci><ci id="S4.SS2.p2.2.m2.1.1.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><times id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.1"></times><ci id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">𝑒</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3">𝑣</ci><ci id="S4.SS2.p2.2.m2.1.1.3.4.cmml" xref="S4.SS2.p2.2.m2.1.1.3.4">𝑎</ci><ci id="S4.SS2.p2.2.m2.1.1.3.5.cmml" xref="S4.SS2.p2.2.m2.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\mathcal{D}_{i}^{eval}</annotation></semantics></math> using <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="f_{\psi^{\prime}_{i}}|\bm{\zeta}_{i}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><msub id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.cmml">f</mi><msubsup id="S4.SS2.p2.3.m3.1.1.2.3" xref="S4.SS2.p2.3.m3.1.1.2.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2.3.2.2" xref="S4.SS2.p2.3.m3.1.1.2.3.2.2.cmml">ψ</mi><mi id="S4.SS2.p2.3.m3.1.1.2.3.3" xref="S4.SS2.p2.3.m3.1.1.2.3.3.cmml">i</mi><mo id="S4.SS2.p2.3.m3.1.1.2.3.2.3" xref="S4.SS2.p2.3.m3.1.1.2.3.2.3.cmml">′</mo></msubsup></msub><mo fence="false" id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">|</mo><msub id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.3.2" xref="S4.SS2.p2.3.m3.1.1.3.2.cmml">𝜻</mi><mi id="S4.SS2.p2.3.m3.1.1.3.3" xref="S4.SS2.p2.3.m3.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1">conditional</csymbol><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2">𝑓</ci><apply id="S4.SS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3">subscript</csymbol><apply id="S4.SS2.p2.3.m3.1.1.2.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.3.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3">superscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.3.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3.2.2">𝜓</ci><ci id="S4.SS2.p2.3.m3.1.1.2.3.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3.2.3">′</ci></apply><ci id="S4.SS2.p2.3.m3.1.1.2.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.3.2">𝜻</ci><ci id="S4.SS2.p2.3.m3.1.1.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">f_{\psi^{\prime}_{i}}|\bm{\zeta}_{i}</annotation></semantics></math> (i.e., the evaluation loss achieved by the model after being personalized to client <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">i</annotation></semantics></math>). Here, any optimizer of choice, e.g., Adam, can be used (not necessarily gradient descent). This results in a set of parameters <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="\omega_{i}^{\prime}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><msubsup id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2.2" xref="S4.SS2.p2.5.m5.1.1.2.2.cmml">ω</mi><mi id="S4.SS2.p2.5.m5.1.1.2.3" xref="S4.SS2.p2.5.m5.1.1.2.3.cmml">i</mi><mo id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">superscript</csymbol><apply id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.2.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2.2">𝜔</ci><ci id="S4.SS2.p2.5.m5.1.1.2.3.cmml" xref="S4.SS2.p2.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\omega_{i}^{\prime}</annotation></semantics></math> (comprising both <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="\mu_{i}^{\prime}" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><msubsup id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2.2" xref="S4.SS2.p2.6.m6.1.1.2.2.cmml">μ</mi><mi id="S4.SS2.p2.6.m6.1.1.2.3" xref="S4.SS2.p2.6.m6.1.1.2.3.cmml">i</mi><mo id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">superscript</csymbol><apply id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.2.1.cmml" xref="S4.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2.2">𝜇</ci><ci id="S4.SS2.p2.6.m6.1.1.2.3.cmml" xref="S4.SS2.p2.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">\mu_{i}^{\prime}</annotation></semantics></math> and <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="\psi_{i}^{\prime}" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><msubsup id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mi id="S4.SS2.p2.7.m7.1.1.2.2" xref="S4.SS2.p2.7.m7.1.1.2.2.cmml">ψ</mi><mi id="S4.SS2.p2.7.m7.1.1.2.3" xref="S4.SS2.p2.7.m7.1.1.2.3.cmml">i</mi><mo id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">superscript</csymbol><apply id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.1.1.2.1.cmml" xref="S4.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p2.7.m7.1.1.2.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2.2">𝜓</ci><ci id="S4.SS2.p2.7.m7.1.1.2.3.cmml" xref="S4.SS2.p2.7.m7.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">\psi_{i}^{\prime}</annotation></semantics></math>) that are personalized to the client’s data and, at the same time, generalize well to a held-out dataset sampled from the same distribution. This guarantee good performance when new data from the same client are observed and prevents overfitting to the client’s initial data.
The updated parameters <math id="S4.SS2.p2.8.m8.1" class="ltx_Math" alttext="\omega_{i}^{\prime}" display="inline"><semantics id="S4.SS2.p2.8.m8.1a"><msubsup id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml"><mi id="S4.SS2.p2.8.m8.1.1.2.2" xref="S4.SS2.p2.8.m8.1.1.2.2.cmml">ω</mi><mi id="S4.SS2.p2.8.m8.1.1.2.3" xref="S4.SS2.p2.8.m8.1.1.2.3.cmml">i</mi><mo id="S4.SS2.p2.8.m8.1.1.3" xref="S4.SS2.p2.8.m8.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><apply id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.1.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1">superscript</csymbol><apply id="S4.SS2.p2.8.m8.1.1.2.cmml" xref="S4.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.1.1.2.1.cmml" xref="S4.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m8.1.1.2.2.cmml" xref="S4.SS2.p2.8.m8.1.1.2.2">𝜔</ci><ci id="S4.SS2.p2.8.m8.1.1.2.3.cmml" xref="S4.SS2.p2.8.m8.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p2.8.m8.1.1.3.cmml" xref="S4.SS2.p2.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">\omega_{i}^{\prime}</annotation></semantics></math> are then sent back to the server in line 9. After receiving the parameters from all the selected clients, the server collects the local models and computes the average to reinitialize <math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><mi id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><ci id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">\omega</annotation></semantics></math>, following a similar approach to the FedAvg algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx27" title="" class="ltx_ref">27</a>]</cite>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.5.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <em id="alg1.6.2" class="ltx_emph ltx_font_italic">CAFeMe</em></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.2" class="ltx_p ltx_figure_panel"><span id="alg1.2.1" class="ltx_text ltx_font_bold">Require</span> Active clients <math id="alg1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">M</annotation></semantics></math>, step sizes <math id="alg1.2.m2.2" class="ltx_Math" alttext="\alpha,\beta" display="inline"><semantics id="alg1.2.m2.2a"><mrow id="alg1.2.m2.2.3.2" xref="alg1.2.m2.2.3.1.cmml"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">α</mi><mo id="alg1.2.m2.2.3.2.1" xref="alg1.2.m2.2.3.1.cmml">,</mo><mi id="alg1.2.m2.2.2" xref="alg1.2.m2.2.2.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.m2.2b"><list id="alg1.2.m2.2.3.1.cmml" xref="alg1.2.m2.2.3.2"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝛼</ci><ci id="alg1.2.m2.2.2.cmml" xref="alg1.2.m2.2.2">𝛽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.2c">\alpha,\beta</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.7" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  Randomly initialize <math id="alg1.l1.m1.2" class="ltx_Math" alttext="\omega=\{\mu,\psi\}" display="inline"><semantics id="alg1.l1.m1.2a"><mrow id="alg1.l1.m1.2.3" xref="alg1.l1.m1.2.3.cmml"><mi id="alg1.l1.m1.2.3.2" xref="alg1.l1.m1.2.3.2.cmml">ω</mi><mo id="alg1.l1.m1.2.3.1" xref="alg1.l1.m1.2.3.1.cmml">=</mo><mrow id="alg1.l1.m1.2.3.3.2" xref="alg1.l1.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l1.m1.2.3.3.2.1" xref="alg1.l1.m1.2.3.3.1.cmml">{</mo><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">μ</mi><mo id="alg1.l1.m1.2.3.3.2.2" xref="alg1.l1.m1.2.3.3.1.cmml">,</mo><mi id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">ψ</mi><mo stretchy="false" id="alg1.l1.m1.2.3.3.2.3" xref="alg1.l1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.2b"><apply id="alg1.l1.m1.2.3.cmml" xref="alg1.l1.m1.2.3"><eq id="alg1.l1.m1.2.3.1.cmml" xref="alg1.l1.m1.2.3.1"></eq><ci id="alg1.l1.m1.2.3.2.cmml" xref="alg1.l1.m1.2.3.2">𝜔</ci><set id="alg1.l1.m1.2.3.3.1.cmml" xref="alg1.l1.m1.2.3.3.2"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝜇</ci><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">𝜓</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.2c">\omega=\{\mu,\psi\}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.3" class="ltx_Math" alttext="t=1,\cdots,T" display="inline"><semantics id="alg1.l2.m1.3a"><mrow id="alg1.l2.m1.3.4" xref="alg1.l2.m1.3.4.cmml"><mi id="alg1.l2.m1.3.4.2" xref="alg1.l2.m1.3.4.2.cmml">t</mi><mo id="alg1.l2.m1.3.4.1" xref="alg1.l2.m1.3.4.1.cmml">=</mo><mrow id="alg1.l2.m1.3.4.3.2" xref="alg1.l2.m1.3.4.3.1.cmml"><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo id="alg1.l2.m1.3.4.3.2.1" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">⋯</mi><mo id="alg1.l2.m1.3.4.3.2.2" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><apply id="alg1.l2.m1.3.4.cmml" xref="alg1.l2.m1.3.4"><eq id="alg1.l2.m1.3.4.1.cmml" xref="alg1.l2.m1.3.4.1"></eq><ci id="alg1.l2.m1.3.4.2.cmml" xref="alg1.l2.m1.3.4.2">𝑡</ci><list id="alg1.l2.m1.3.4.3.1.cmml" xref="alg1.l2.m1.3.4.3.2"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">1</cn><ci id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">⋯</ci><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">t=1,\cdots,T</annotation></semantics></math> <span id="alg1.l2.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>     Choose a subset of clients <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\mathcal{C}^{(t)}" display="inline"><semantics id="alg1.l3.m1.1a"><msup id="alg1.l3.m1.1.2" xref="alg1.l3.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.2.2" xref="alg1.l3.m1.1.2.2.cmml">𝒞</mi><mrow id="alg1.l3.m1.1.1.1.3" xref="alg1.l3.m1.1.2.cmml"><mo stretchy="false" id="alg1.l3.m1.1.1.1.3.1" xref="alg1.l3.m1.1.2.cmml">(</mo><mi id="alg1.l3.m1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l3.m1.1.1.1.3.2" xref="alg1.l3.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.2.cmml" xref="alg1.l3.m1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.2.1.cmml" xref="alg1.l3.m1.1.2">superscript</csymbol><ci id="alg1.l3.m1.1.2.2.cmml" xref="alg1.l3.m1.1.2.2">𝒞</ci><ci id="alg1.l3.m1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathcal{C}^{(t)}</annotation></semantics></math> with size <math id="alg1.l3.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">M</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     Send <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\omega</annotation></semantics></math> to all clients in <math id="alg1.l4.m2.1" class="ltx_Math" alttext="\mathcal{C}^{(t)}" display="inline"><semantics id="alg1.l4.m2.1a"><msup id="alg1.l4.m2.1.2" xref="alg1.l4.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m2.1.2.2" xref="alg1.l4.m2.1.2.2.cmml">𝒞</mi><mrow id="alg1.l4.m2.1.1.1.3" xref="alg1.l4.m2.1.2.cmml"><mo stretchy="false" id="alg1.l4.m2.1.1.1.3.1" xref="alg1.l4.m2.1.2.cmml">(</mo><mi id="alg1.l4.m2.1.1.1.1" xref="alg1.l4.m2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l4.m2.1.1.1.3.2" xref="alg1.l4.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.2.cmml" xref="alg1.l4.m2.1.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.2.1.cmml" xref="alg1.l4.m2.1.2">superscript</csymbol><ci id="alg1.l4.m2.1.2.2.cmml" xref="alg1.l4.m2.1.2.2">𝒞</ci><ci id="alg1.l4.m2.1.1.1.1.cmml" xref="alg1.l4.m2.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\mathcal{C}^{(t)}</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <span id="alg1.l5.1" class="ltx_text ltx_font_bold">for all</span> <math id="alg1.l5.m1.1" class="ltx_Math" alttext="i\in\mathcal{C}^{(t)}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><mi id="alg1.l5.m1.1.2.2" xref="alg1.l5.m1.1.2.2.cmml">i</mi><mo id="alg1.l5.m1.1.2.1" xref="alg1.l5.m1.1.2.1.cmml">∈</mo><msup id="alg1.l5.m1.1.2.3" xref="alg1.l5.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.1.2.3.2" xref="alg1.l5.m1.1.2.3.2.cmml">𝒞</mi><mrow id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.2.3.cmml"><mo stretchy="false" id="alg1.l5.m1.1.1.1.3.1" xref="alg1.l5.m1.1.2.3.cmml">(</mo><mi id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l5.m1.1.1.1.3.2" xref="alg1.l5.m1.1.2.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><in id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2.1"></in><ci id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2.2">𝑖</ci><apply id="alg1.l5.m1.1.2.3.cmml" xref="alg1.l5.m1.1.2.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.3.1.cmml" xref="alg1.l5.m1.1.2.3">superscript</csymbol><ci id="alg1.l5.m1.1.2.3.2.cmml" xref="alg1.l5.m1.1.2.3.2">𝒞</ci><ci id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">i\in\mathcal{C}^{(t)}</annotation></semantics></math> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>        Split data <math id="alg1.l6.m1.2" class="ltx_Math" alttext="\mathcal{D}_{i}=\{\mathcal{D}_{i}^{pers},\mathcal{D}_{i}^{eval}\}" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><msub id="alg1.l6.m1.2.2.4" xref="alg1.l6.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.2.2.4.2" xref="alg1.l6.m1.2.2.4.2.cmml">𝒟</mi><mi id="alg1.l6.m1.2.2.4.3" xref="alg1.l6.m1.2.2.4.3.cmml">i</mi></msub><mo id="alg1.l6.m1.2.2.3" xref="alg1.l6.m1.2.2.3.cmml">=</mo><mrow id="alg1.l6.m1.2.2.2.2" xref="alg1.l6.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.3.cmml">{</mo><msubsup id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="alg1.l6.m1.1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.1.3.1" xref="alg1.l6.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.1.3.1a" xref="alg1.l6.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.1.1.1.3.4" xref="alg1.l6.m1.1.1.1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.1.3.1b" xref="alg1.l6.m1.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.1.1.1.3.5" xref="alg1.l6.m1.1.1.1.1.1.3.5.cmml">s</mi></mrow></msubsup><mo id="alg1.l6.m1.2.2.2.2.4" xref="alg1.l6.m1.2.2.2.3.cmml">,</mo><msubsup id="alg1.l6.m1.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.2.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.2.cmml">𝒟</mi><mi id="alg1.l6.m1.2.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.2.3.cmml">i</mi><mrow id="alg1.l6.m1.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l6.m1.2.2.2.2.2.3.2" xref="alg1.l6.m1.2.2.2.2.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.3" xref="alg1.l6.m1.2.2.2.2.2.3.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1a" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.4" xref="alg1.l6.m1.2.2.2.2.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.2.3.1b" xref="alg1.l6.m1.2.2.2.2.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.2.2.2.2.3.5" xref="alg1.l6.m1.2.2.2.2.2.3.5.cmml">l</mi></mrow></msubsup><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.5" xref="alg1.l6.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><eq id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.3"></eq><apply id="alg1.l6.m1.2.2.4.cmml" xref="alg1.l6.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.4.1.cmml" xref="alg1.l6.m1.2.2.4">subscript</csymbol><ci id="alg1.l6.m1.2.2.4.2.cmml" xref="alg1.l6.m1.2.2.4.2">𝒟</ci><ci id="alg1.l6.m1.2.2.4.3.cmml" xref="alg1.l6.m1.2.2.4.3">𝑖</ci></apply><set id="alg1.l6.m1.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2"><apply id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.2">𝒟</ci><ci id="alg1.l6.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l6.m1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.3"><times id="alg1.l6.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.3.1"></times><ci id="alg1.l6.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.3.2">𝑝</ci><ci id="alg1.l6.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.3.3">𝑒</ci><ci id="alg1.l6.m1.1.1.1.1.1.3.4.cmml" xref="alg1.l6.m1.1.1.1.1.1.3.4">𝑟</ci><ci id="alg1.l6.m1.1.1.1.1.1.3.5.cmml" xref="alg1.l6.m1.1.1.1.1.1.3.5">𝑠</ci></apply></apply><apply id="alg1.l6.m1.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l6.m1.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.2">𝒟</ci><ci id="alg1.l6.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="alg1.l6.m1.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.3"><times id="alg1.l6.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.1"></times><ci id="alg1.l6.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.2">𝑒</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.3">𝑣</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.4.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.4">𝑎</ci><ci id="alg1.l6.m1.2.2.2.2.2.3.5.cmml" xref="alg1.l6.m1.2.2.2.2.2.3.5">𝑙</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">\mathcal{D}_{i}=\{\mathcal{D}_{i}^{pers},\mathcal{D}_{i}^{eval}\}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>        Personalize the global model: <math id="alg1.l7.m1.6" class="ltx_Math" alttext="\psi_{i}^{\prime},\bm{\zeta}_{i}\leftarrow\emph{Personalization}(S,\alpha,\mathcal{D}_{i}^{pers},\omega)" display="inline"><semantics id="alg1.l7.m1.6a"><mrow id="alg1.l7.m1.6.6" xref="alg1.l7.m1.6.6.cmml"><mrow id="alg1.l7.m1.5.5.2.2" xref="alg1.l7.m1.5.5.2.3.cmml"><msubsup id="alg1.l7.m1.4.4.1.1.1" xref="alg1.l7.m1.4.4.1.1.1.cmml"><mi id="alg1.l7.m1.4.4.1.1.1.2.2" xref="alg1.l7.m1.4.4.1.1.1.2.2.cmml">ψ</mi><mi id="alg1.l7.m1.4.4.1.1.1.2.3" xref="alg1.l7.m1.4.4.1.1.1.2.3.cmml">i</mi><mo id="alg1.l7.m1.4.4.1.1.1.3" xref="alg1.l7.m1.4.4.1.1.1.3.cmml">′</mo></msubsup><mo id="alg1.l7.m1.5.5.2.2.3" xref="alg1.l7.m1.5.5.2.3.cmml">,</mo><msub id="alg1.l7.m1.5.5.2.2.2" xref="alg1.l7.m1.5.5.2.2.2.cmml"><mi id="alg1.l7.m1.5.5.2.2.2.2" xref="alg1.l7.m1.5.5.2.2.2.2.cmml">𝜻</mi><mi id="alg1.l7.m1.5.5.2.2.2.3" xref="alg1.l7.m1.5.5.2.2.2.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l7.m1.6.6.4" xref="alg1.l7.m1.6.6.4.cmml">←</mo><mrow id="alg1.l7.m1.6.6.3" xref="alg1.l7.m1.6.6.3.cmml"><mtext class="ltx_mathvariant_italic" id="alg1.l7.m1.6.6.3.3" xref="alg1.l7.m1.6.6.3.3b.cmml"><em id="alg1.l7.m1.6.6.3.3.1nest" class="ltx_emph ltx_font_italic">Personalization</em></mtext><mo lspace="0em" rspace="0em" id="alg1.l7.m1.6.6.3.2" xref="alg1.l7.m1.6.6.3.2.cmml">​</mo><mrow id="alg1.l7.m1.6.6.3.1.1" xref="alg1.l7.m1.6.6.3.1.2.cmml"><mo stretchy="false" id="alg1.l7.m1.6.6.3.1.1.2" xref="alg1.l7.m1.6.6.3.1.2.cmml">(</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">S</mi><mo id="alg1.l7.m1.6.6.3.1.1.3" xref="alg1.l7.m1.6.6.3.1.2.cmml">,</mo><mi id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">α</mi><mo id="alg1.l7.m1.6.6.3.1.1.4" xref="alg1.l7.m1.6.6.3.1.2.cmml">,</mo><msubsup id="alg1.l7.m1.6.6.3.1.1.1" xref="alg1.l7.m1.6.6.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.6.6.3.1.1.1.2.2" xref="alg1.l7.m1.6.6.3.1.1.1.2.2.cmml">𝒟</mi><mi id="alg1.l7.m1.6.6.3.1.1.1.2.3" xref="alg1.l7.m1.6.6.3.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l7.m1.6.6.3.1.1.1.3" xref="alg1.l7.m1.6.6.3.1.1.1.3.cmml"><mi id="alg1.l7.m1.6.6.3.1.1.1.3.2" xref="alg1.l7.m1.6.6.3.1.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.6.6.3.1.1.1.3.1" xref="alg1.l7.m1.6.6.3.1.1.1.3.1.cmml">​</mo><mi id="alg1.l7.m1.6.6.3.1.1.1.3.3" xref="alg1.l7.m1.6.6.3.1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.6.6.3.1.1.1.3.1a" xref="alg1.l7.m1.6.6.3.1.1.1.3.1.cmml">​</mo><mi id="alg1.l7.m1.6.6.3.1.1.1.3.4" xref="alg1.l7.m1.6.6.3.1.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.6.6.3.1.1.1.3.1b" xref="alg1.l7.m1.6.6.3.1.1.1.3.1.cmml">​</mo><mi id="alg1.l7.m1.6.6.3.1.1.1.3.5" xref="alg1.l7.m1.6.6.3.1.1.1.3.5.cmml">s</mi></mrow></msubsup><mo id="alg1.l7.m1.6.6.3.1.1.5" xref="alg1.l7.m1.6.6.3.1.2.cmml">,</mo><mi id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml">ω</mi><mo stretchy="false" id="alg1.l7.m1.6.6.3.1.1.6" xref="alg1.l7.m1.6.6.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.6b"><apply id="alg1.l7.m1.6.6.cmml" xref="alg1.l7.m1.6.6"><ci id="alg1.l7.m1.6.6.4.cmml" xref="alg1.l7.m1.6.6.4">←</ci><list id="alg1.l7.m1.5.5.2.3.cmml" xref="alg1.l7.m1.5.5.2.2"><apply id="alg1.l7.m1.4.4.1.1.1.cmml" xref="alg1.l7.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.1.1.1.1.cmml" xref="alg1.l7.m1.4.4.1.1.1">superscript</csymbol><apply id="alg1.l7.m1.4.4.1.1.1.2.cmml" xref="alg1.l7.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.1.1.1.2.1.cmml" xref="alg1.l7.m1.4.4.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.4.4.1.1.1.2.2.cmml" xref="alg1.l7.m1.4.4.1.1.1.2.2">𝜓</ci><ci id="alg1.l7.m1.4.4.1.1.1.2.3.cmml" xref="alg1.l7.m1.4.4.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l7.m1.4.4.1.1.1.3.cmml" xref="alg1.l7.m1.4.4.1.1.1.3">′</ci></apply><apply id="alg1.l7.m1.5.5.2.2.2.cmml" xref="alg1.l7.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.5.5.2.2.2.1.cmml" xref="alg1.l7.m1.5.5.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.5.5.2.2.2.2.cmml" xref="alg1.l7.m1.5.5.2.2.2.2">𝜻</ci><ci id="alg1.l7.m1.5.5.2.2.2.3.cmml" xref="alg1.l7.m1.5.5.2.2.2.3">𝑖</ci></apply></list><apply id="alg1.l7.m1.6.6.3.cmml" xref="alg1.l7.m1.6.6.3"><times id="alg1.l7.m1.6.6.3.2.cmml" xref="alg1.l7.m1.6.6.3.2"></times><ci id="alg1.l7.m1.6.6.3.3b.cmml" xref="alg1.l7.m1.6.6.3.3"><mtext class="ltx_mathvariant_italic" id="alg1.l7.m1.6.6.3.3.cmml" xref="alg1.l7.m1.6.6.3.3"><em id="alg1.l7.m1.6.6.3.3.1anest" class="ltx_emph ltx_font_italic">Personalization</em></mtext></ci><vector id="alg1.l7.m1.6.6.3.1.2.cmml" xref="alg1.l7.m1.6.6.3.1.1"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑆</ci><ci id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">𝛼</ci><apply id="alg1.l7.m1.6.6.3.1.1.1.cmml" xref="alg1.l7.m1.6.6.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.6.6.3.1.1.1.1.cmml" xref="alg1.l7.m1.6.6.3.1.1.1">superscript</csymbol><apply id="alg1.l7.m1.6.6.3.1.1.1.2.cmml" xref="alg1.l7.m1.6.6.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.6.6.3.1.1.1.2.1.cmml" xref="alg1.l7.m1.6.6.3.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.6.6.3.1.1.1.2.2.cmml" xref="alg1.l7.m1.6.6.3.1.1.1.2.2">𝒟</ci><ci id="alg1.l7.m1.6.6.3.1.1.1.2.3.cmml" xref="alg1.l7.m1.6.6.3.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l7.m1.6.6.3.1.1.1.3.cmml" xref="alg1.l7.m1.6.6.3.1.1.1.3"><times id="alg1.l7.m1.6.6.3.1.1.1.3.1.cmml" xref="alg1.l7.m1.6.6.3.1.1.1.3.1"></times><ci id="alg1.l7.m1.6.6.3.1.1.1.3.2.cmml" xref="alg1.l7.m1.6.6.3.1.1.1.3.2">𝑝</ci><ci id="alg1.l7.m1.6.6.3.1.1.1.3.3.cmml" xref="alg1.l7.m1.6.6.3.1.1.1.3.3">𝑒</ci><ci id="alg1.l7.m1.6.6.3.1.1.1.3.4.cmml" xref="alg1.l7.m1.6.6.3.1.1.1.3.4">𝑟</ci><ci id="alg1.l7.m1.6.6.3.1.1.1.3.5.cmml" xref="alg1.l7.m1.6.6.3.1.1.1.3.5">𝑠</ci></apply></apply><ci id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3">𝜔</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.6c">\psi_{i}^{\prime},\bm{\zeta}_{i}\leftarrow\emph{Personalization}(S,\alpha,\mathcal{D}_{i}^{pers},\omega)</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>        Update <math id="alg1.l8.m1.1" class="ltx_Math" alttext="\omega_{i}^{\prime}\leftarrow\omega-\beta\nabla_{\omega}\mathcal{L}_{\mathcal{D}_{i}^{eval}}(f_{\psi_{i}^{\prime}}|\bm{\zeta}_{i})" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msubsup id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.3.2.2" xref="alg1.l8.m1.1.1.3.2.2.cmml">ω</mi><mi id="alg1.l8.m1.1.1.3.2.3" xref="alg1.l8.m1.1.1.3.2.3.cmml">i</mi><mo id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml">′</mo></msubsup><mo stretchy="false" id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">←</mo><mrow id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.1.1.3.cmml">ω</mi><mo id="alg1.l8.m1.1.1.1.2" xref="alg1.l8.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.3.cmml">β</mi><mo lspace="0.167em" rspace="0em" id="alg1.l8.m1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l8.m1.1.1.1.1.4" xref="alg1.l8.m1.1.1.1.1.4.cmml"><msub id="alg1.l8.m1.1.1.1.1.4.1" xref="alg1.l8.m1.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="alg1.l8.m1.1.1.1.1.4.1.2" xref="alg1.l8.m1.1.1.1.1.4.1.2.cmml">∇</mo><mi id="alg1.l8.m1.1.1.1.1.4.1.3" xref="alg1.l8.m1.1.1.1.1.4.1.3.cmml">ω</mi></msub><msub id="alg1.l8.m1.1.1.1.1.4.2" xref="alg1.l8.m1.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1.1.1.4.2.2" xref="alg1.l8.m1.1.1.1.1.4.2.2.cmml">ℒ</mi><msubsup id="alg1.l8.m1.1.1.1.1.4.2.3" xref="alg1.l8.m1.1.1.1.1.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1.1.1.4.2.3.2.2" xref="alg1.l8.m1.1.1.1.1.4.2.3.2.2.cmml">𝒟</mi><mi id="alg1.l8.m1.1.1.1.1.4.2.3.2.3" xref="alg1.l8.m1.1.1.1.1.4.2.3.2.3.cmml">i</mi><mrow id="alg1.l8.m1.1.1.1.1.4.2.3.3" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.4.2.3.3.2" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.4.2.3.3.1" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.4.2.3.3.3" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.3.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.4.2.3.3.1a" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.4.2.3.3.4" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.4.2.3.3.1b" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.1.cmml">​</mo><mi id="alg1.l8.m1.1.1.1.1.4.2.3.3.5" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.5.cmml">l</mi></mrow></msubsup></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.2a" xref="alg1.l8.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l8.m1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l8.m1.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.cmml">f</mi><msubsup id="alg1.l8.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.2.3.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3.2.2.cmml">ψ</mi><mi id="alg1.l8.m1.1.1.1.1.1.1.1.2.3.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3.2.3.cmml">i</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.1.2.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3.3.cmml">′</mo></msubsup></msub><mo fence="false" id="alg1.l8.m1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="alg1.l8.m1.1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.3.2.cmml">𝜻</mi><mi id="alg1.l8.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l8.m1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">←</ci><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3">superscript</csymbol><apply id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.2.1.cmml" xref="alg1.l8.m1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.2">𝜔</ci><ci id="alg1.l8.m1.1.1.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3">′</ci></apply><apply id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"><minus id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.2"></minus><ci id="alg1.l8.m1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.3">𝜔</ci><apply id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1"><times id="alg1.l8.m1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.2"></times><ci id="alg1.l8.m1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.3">𝛽</ci><apply id="alg1.l8.m1.1.1.1.1.4.cmml" xref="alg1.l8.m1.1.1.1.1.4"><apply id="alg1.l8.m1.1.1.1.1.4.1.cmml" xref="alg1.l8.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.4.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.4.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.4.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.4.1.2">∇</ci><ci id="alg1.l8.m1.1.1.1.1.4.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.4.1.3">𝜔</ci></apply><apply id="alg1.l8.m1.1.1.1.1.4.2.cmml" xref="alg1.l8.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.4.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.4.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.4.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.2">ℒ</ci><apply id="alg1.l8.m1.1.1.1.1.4.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.4.2.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3">superscript</csymbol><apply id="alg1.l8.m1.1.1.1.1.4.2.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.4.2.3.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.4.2.3.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3.2.2">𝒟</ci><ci id="alg1.l8.m1.1.1.1.1.4.2.3.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3.2.3">𝑖</ci></apply><apply id="alg1.l8.m1.1.1.1.1.4.2.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3.3"><times id="alg1.l8.m1.1.1.1.1.4.2.3.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.1"></times><ci id="alg1.l8.m1.1.1.1.1.4.2.3.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.2">𝑒</ci><ci id="alg1.l8.m1.1.1.1.1.4.2.3.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.3">𝑣</ci><ci id="alg1.l8.m1.1.1.1.1.4.2.3.3.4.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.4">𝑎</ci><ci id="alg1.l8.m1.1.1.1.1.4.2.3.3.5.cmml" xref="alg1.l8.m1.1.1.1.1.4.2.3.3.5">𝑙</ci></apply></apply></apply></apply><apply id="alg1.l8.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l8.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="alg1.l8.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2">𝑓</ci><apply id="alg1.l8.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="alg1.l8.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3.2.2">𝜓</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="alg1.l8.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.3.3">′</ci></apply></apply><apply id="alg1.l8.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.3.2">𝜻</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\omega_{i}^{\prime}\leftarrow\omega-\beta\nabla_{\omega}\mathcal{L}_{\mathcal{D}_{i}^{eval}}(f_{\psi_{i}^{\prime}}|\bm{\zeta}_{i})</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>        Send <math id="alg1.l9.m1.1" class="ltx_Math" alttext="\omega_{i}^{\prime}" display="inline"><semantics id="alg1.l9.m1.1a"><msubsup id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">ω</mi><mi id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">i</mi><mo id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">superscript</csymbol><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝜔</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\omega_{i}^{\prime}</annotation></semantics></math> back to the server

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <span id="alg1.l10.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>     Server updates <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\omega=\frac{1}{M}\sum_{i\in\mathcal{C}^{(t)}}\omega_{i}^{\prime}" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.2" xref="alg1.l11.m1.1.2.cmml"><mi id="alg1.l11.m1.1.2.2" xref="alg1.l11.m1.1.2.2.cmml">ω</mi><mo id="alg1.l11.m1.1.2.1" xref="alg1.l11.m1.1.2.1.cmml">=</mo><mrow id="alg1.l11.m1.1.2.3" xref="alg1.l11.m1.1.2.3.cmml"><mfrac id="alg1.l11.m1.1.2.3.2" xref="alg1.l11.m1.1.2.3.2.cmml"><mn id="alg1.l11.m1.1.2.3.2.2" xref="alg1.l11.m1.1.2.3.2.2.cmml">1</mn><mi id="alg1.l11.m1.1.2.3.2.3" xref="alg1.l11.m1.1.2.3.2.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.2.3.1" xref="alg1.l11.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l11.m1.1.2.3.3" xref="alg1.l11.m1.1.2.3.3.cmml"><msub id="alg1.l11.m1.1.2.3.3.1" xref="alg1.l11.m1.1.2.3.3.1.cmml"><mo id="alg1.l11.m1.1.2.3.3.1.2" xref="alg1.l11.m1.1.2.3.3.1.2.cmml">∑</mo><mrow id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml"><mi id="alg1.l11.m1.1.1.1.3" xref="alg1.l11.m1.1.1.1.3.cmml">i</mi><mo id="alg1.l11.m1.1.1.1.2" xref="alg1.l11.m1.1.1.1.2.cmml">∈</mo><msup id="alg1.l11.m1.1.1.1.4" xref="alg1.l11.m1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1.1.4.2" xref="alg1.l11.m1.1.1.1.4.2.cmml">𝒞</mi><mrow id="alg1.l11.m1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.4.cmml"><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.1.3.1" xref="alg1.l11.m1.1.1.1.4.cmml">(</mo><mi id="alg1.l11.m1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l11.m1.1.1.1.1.1.3.2" xref="alg1.l11.m1.1.1.1.4.cmml">)</mo></mrow></msup></mrow></msub><msubsup id="alg1.l11.m1.1.2.3.3.2" xref="alg1.l11.m1.1.2.3.3.2.cmml"><mi id="alg1.l11.m1.1.2.3.3.2.2.2" xref="alg1.l11.m1.1.2.3.3.2.2.2.cmml">ω</mi><mi id="alg1.l11.m1.1.2.3.3.2.2.3" xref="alg1.l11.m1.1.2.3.3.2.2.3.cmml">i</mi><mo id="alg1.l11.m1.1.2.3.3.2.3" xref="alg1.l11.m1.1.2.3.3.2.3.cmml">′</mo></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.2.cmml" xref="alg1.l11.m1.1.2"><eq id="alg1.l11.m1.1.2.1.cmml" xref="alg1.l11.m1.1.2.1"></eq><ci id="alg1.l11.m1.1.2.2.cmml" xref="alg1.l11.m1.1.2.2">𝜔</ci><apply id="alg1.l11.m1.1.2.3.cmml" xref="alg1.l11.m1.1.2.3"><times id="alg1.l11.m1.1.2.3.1.cmml" xref="alg1.l11.m1.1.2.3.1"></times><apply id="alg1.l11.m1.1.2.3.2.cmml" xref="alg1.l11.m1.1.2.3.2"><divide id="alg1.l11.m1.1.2.3.2.1.cmml" xref="alg1.l11.m1.1.2.3.2"></divide><cn type="integer" id="alg1.l11.m1.1.2.3.2.2.cmml" xref="alg1.l11.m1.1.2.3.2.2">1</cn><ci id="alg1.l11.m1.1.2.3.2.3.cmml" xref="alg1.l11.m1.1.2.3.2.3">𝑀</ci></apply><apply id="alg1.l11.m1.1.2.3.3.cmml" xref="alg1.l11.m1.1.2.3.3"><apply id="alg1.l11.m1.1.2.3.3.1.cmml" xref="alg1.l11.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.2.3.3.1.1.cmml" xref="alg1.l11.m1.1.2.3.3.1">subscript</csymbol><sum id="alg1.l11.m1.1.2.3.3.1.2.cmml" xref="alg1.l11.m1.1.2.3.3.1.2"></sum><apply id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"><in id="alg1.l11.m1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.2"></in><ci id="alg1.l11.m1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.3">𝑖</ci><apply id="alg1.l11.m1.1.1.1.4.cmml" xref="alg1.l11.m1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.4.1.cmml" xref="alg1.l11.m1.1.1.1.4">superscript</csymbol><ci id="alg1.l11.m1.1.1.1.4.2.cmml" xref="alg1.l11.m1.1.1.1.4.2">𝒞</ci><ci id="alg1.l11.m1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1">𝑡</ci></apply></apply></apply><apply id="alg1.l11.m1.1.2.3.3.2.cmml" xref="alg1.l11.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.2.3.3.2.1.cmml" xref="alg1.l11.m1.1.2.3.3.2">superscript</csymbol><apply id="alg1.l11.m1.1.2.3.3.2.2.cmml" xref="alg1.l11.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.2.3.3.2.2.1.cmml" xref="alg1.l11.m1.1.2.3.3.2">subscript</csymbol><ci id="alg1.l11.m1.1.2.3.3.2.2.2.cmml" xref="alg1.l11.m1.1.2.3.3.2.2.2">𝜔</ci><ci id="alg1.l11.m1.1.2.3.3.2.2.3.cmml" xref="alg1.l11.m1.1.2.3.3.2.2.3">𝑖</ci></apply><ci id="alg1.l11.m1.1.2.3.3.2.3.cmml" xref="alg1.l11.m1.1.2.3.3.2.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\omega=\frac{1}{M}\sum_{i\in\mathcal{C}^{(t)}}\omega_{i}^{\prime}</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>  <span id="alg1.l12.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.2" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</div>
</div>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.9.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> <em id="alg2.10.2" class="ltx_emph ltx_font_italic">Personalization</em>(<math id="alg2.2.m1.4" class="ltx_Math" alttext="S,\alpha,\mathcal{D}^{pers},\omega" display="inline"><semantics id="alg2.2.m1.4b"><mrow id="alg2.2.m1.4.4.1" xref="alg2.2.m1.4.4.2.cmml"><mi id="alg2.2.m1.1.1" xref="alg2.2.m1.1.1.cmml">S</mi><mo id="alg2.2.m1.4.4.1.2" xref="alg2.2.m1.4.4.2.cmml">,</mo><mi id="alg2.2.m1.2.2" xref="alg2.2.m1.2.2.cmml">α</mi><mo id="alg2.2.m1.4.4.1.3" xref="alg2.2.m1.4.4.2.cmml">,</mo><msup id="alg2.2.m1.4.4.1.1" xref="alg2.2.m1.4.4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.2.m1.4.4.1.1.2" xref="alg2.2.m1.4.4.1.1.2.cmml">𝒟</mi><mrow id="alg2.2.m1.4.4.1.1.3" xref="alg2.2.m1.4.4.1.1.3.cmml"><mi id="alg2.2.m1.4.4.1.1.3.2" xref="alg2.2.m1.4.4.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.2.m1.4.4.1.1.3.1" xref="alg2.2.m1.4.4.1.1.3.1.cmml">​</mo><mi id="alg2.2.m1.4.4.1.1.3.3" xref="alg2.2.m1.4.4.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.2.m1.4.4.1.1.3.1b" xref="alg2.2.m1.4.4.1.1.3.1.cmml">​</mo><mi id="alg2.2.m1.4.4.1.1.3.4" xref="alg2.2.m1.4.4.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.2.m1.4.4.1.1.3.1c" xref="alg2.2.m1.4.4.1.1.3.1.cmml">​</mo><mi id="alg2.2.m1.4.4.1.1.3.5" xref="alg2.2.m1.4.4.1.1.3.5.cmml">s</mi></mrow></msup><mo id="alg2.2.m1.4.4.1.4" xref="alg2.2.m1.4.4.2.cmml">,</mo><mi id="alg2.2.m1.3.3" xref="alg2.2.m1.3.3.cmml">ω</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.2.m1.4c"><list id="alg2.2.m1.4.4.2.cmml" xref="alg2.2.m1.4.4.1"><ci id="alg2.2.m1.1.1.cmml" xref="alg2.2.m1.1.1">𝑆</ci><ci id="alg2.2.m1.2.2.cmml" xref="alg2.2.m1.2.2">𝛼</ci><apply id="alg2.2.m1.4.4.1.1.cmml" xref="alg2.2.m1.4.4.1.1"><csymbol cd="ambiguous" id="alg2.2.m1.4.4.1.1.1.cmml" xref="alg2.2.m1.4.4.1.1">superscript</csymbol><ci id="alg2.2.m1.4.4.1.1.2.cmml" xref="alg2.2.m1.4.4.1.1.2">𝒟</ci><apply id="alg2.2.m1.4.4.1.1.3.cmml" xref="alg2.2.m1.4.4.1.1.3"><times id="alg2.2.m1.4.4.1.1.3.1.cmml" xref="alg2.2.m1.4.4.1.1.3.1"></times><ci id="alg2.2.m1.4.4.1.1.3.2.cmml" xref="alg2.2.m1.4.4.1.1.3.2">𝑝</ci><ci id="alg2.2.m1.4.4.1.1.3.3.cmml" xref="alg2.2.m1.4.4.1.1.3.3">𝑒</ci><ci id="alg2.2.m1.4.4.1.1.3.4.cmml" xref="alg2.2.m1.4.4.1.1.3.4">𝑟</ci><ci id="alg2.2.m1.4.4.1.1.3.5.cmml" xref="alg2.2.m1.4.4.1.1.3.5">𝑠</ci></apply></apply><ci id="alg2.2.m1.3.3.cmml" xref="alg2.2.m1.3.3">𝜔</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.m1.4d">S,\alpha,\mathcal{D}^{pers},\omega</annotation></semantics></math>)</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.6" class="ltx_p ltx_figure_panel"><span id="alg2.6.1" class="ltx_text ltx_font_bold">Require</span> Personalization steps <math id="alg2.3.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg2.3.m1.1a"><mi id="alg2.3.m1.1.1" xref="alg2.3.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg2.3.m1.1b"><ci id="alg2.3.m1.1.1.cmml" xref="alg2.3.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.m1.1c">S</annotation></semantics></math>, step size <math id="alg2.4.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg2.4.m2.1a"><mi id="alg2.4.m2.1.1" xref="alg2.4.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg2.4.m2.1b"><ci id="alg2.4.m2.1.1.cmml" xref="alg2.4.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.m2.1c">\alpha</annotation></semantics></math>, local dataset for personalization <math id="alg2.5.m3.1" class="ltx_Math" alttext="\mathcal{D}_{i}^{pers}" display="inline"><semantics id="alg2.5.m3.1a"><msubsup id="alg2.5.m3.1.1" xref="alg2.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.5.m3.1.1.2.2" xref="alg2.5.m3.1.1.2.2.cmml">𝒟</mi><mi id="alg2.5.m3.1.1.2.3" xref="alg2.5.m3.1.1.2.3.cmml">i</mi><mrow id="alg2.5.m3.1.1.3" xref="alg2.5.m3.1.1.3.cmml"><mi id="alg2.5.m3.1.1.3.2" xref="alg2.5.m3.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.5.m3.1.1.3.1" xref="alg2.5.m3.1.1.3.1.cmml">​</mo><mi id="alg2.5.m3.1.1.3.3" xref="alg2.5.m3.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.5.m3.1.1.3.1a" xref="alg2.5.m3.1.1.3.1.cmml">​</mo><mi id="alg2.5.m3.1.1.3.4" xref="alg2.5.m3.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.5.m3.1.1.3.1b" xref="alg2.5.m3.1.1.3.1.cmml">​</mo><mi id="alg2.5.m3.1.1.3.5" xref="alg2.5.m3.1.1.3.5.cmml">s</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.5.m3.1b"><apply id="alg2.5.m3.1.1.cmml" xref="alg2.5.m3.1.1"><csymbol cd="ambiguous" id="alg2.5.m3.1.1.1.cmml" xref="alg2.5.m3.1.1">superscript</csymbol><apply id="alg2.5.m3.1.1.2.cmml" xref="alg2.5.m3.1.1"><csymbol cd="ambiguous" id="alg2.5.m3.1.1.2.1.cmml" xref="alg2.5.m3.1.1">subscript</csymbol><ci id="alg2.5.m3.1.1.2.2.cmml" xref="alg2.5.m3.1.1.2.2">𝒟</ci><ci id="alg2.5.m3.1.1.2.3.cmml" xref="alg2.5.m3.1.1.2.3">𝑖</ci></apply><apply id="alg2.5.m3.1.1.3.cmml" xref="alg2.5.m3.1.1.3"><times id="alg2.5.m3.1.1.3.1.cmml" xref="alg2.5.m3.1.1.3.1"></times><ci id="alg2.5.m3.1.1.3.2.cmml" xref="alg2.5.m3.1.1.3.2">𝑝</ci><ci id="alg2.5.m3.1.1.3.3.cmml" xref="alg2.5.m3.1.1.3.3">𝑒</ci><ci id="alg2.5.m3.1.1.3.4.cmml" xref="alg2.5.m3.1.1.3.4">𝑟</ci><ci id="alg2.5.m3.1.1.3.5.cmml" xref="alg2.5.m3.1.1.3.5">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.5.m3.1c">\mathcal{D}_{i}^{pers}</annotation></semantics></math>, initial parameters of the model <math id="alg2.6.m4.2" class="ltx_Math" alttext="\omega=\{\mu,\psi\}" display="inline"><semantics id="alg2.6.m4.2a"><mrow id="alg2.6.m4.2.3" xref="alg2.6.m4.2.3.cmml"><mi id="alg2.6.m4.2.3.2" xref="alg2.6.m4.2.3.2.cmml">ω</mi><mo id="alg2.6.m4.2.3.1" xref="alg2.6.m4.2.3.1.cmml">=</mo><mrow id="alg2.6.m4.2.3.3.2" xref="alg2.6.m4.2.3.3.1.cmml"><mo stretchy="false" id="alg2.6.m4.2.3.3.2.1" xref="alg2.6.m4.2.3.3.1.cmml">{</mo><mi id="alg2.6.m4.1.1" xref="alg2.6.m4.1.1.cmml">μ</mi><mo id="alg2.6.m4.2.3.3.2.2" xref="alg2.6.m4.2.3.3.1.cmml">,</mo><mi id="alg2.6.m4.2.2" xref="alg2.6.m4.2.2.cmml">ψ</mi><mo stretchy="false" id="alg2.6.m4.2.3.3.2.3" xref="alg2.6.m4.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.6.m4.2b"><apply id="alg2.6.m4.2.3.cmml" xref="alg2.6.m4.2.3"><eq id="alg2.6.m4.2.3.1.cmml" xref="alg2.6.m4.2.3.1"></eq><ci id="alg2.6.m4.2.3.2.cmml" xref="alg2.6.m4.2.3.2">𝜔</ci><set id="alg2.6.m4.2.3.3.1.cmml" xref="alg2.6.m4.2.3.3.2"><ci id="alg2.6.m4.1.1.cmml" xref="alg2.6.m4.1.1">𝜇</ci><ci id="alg2.6.m4.2.2.cmml" xref="alg2.6.m4.2.2">𝜓</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.6.m4.2c">\omega=\{\mu,\psi\}</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg2.11" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  Initialize <math id="alg2.l1.m1.1" class="ltx_Math" alttext="\mu^{\prime}\leftarrow\mu" display="inline"><semantics id="alg2.l1.m1.1a"><mrow id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><msup id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml"><mi id="alg2.l1.m1.1.1.2.2" xref="alg2.l1.m1.1.1.2.2.cmml">μ</mi><mo id="alg2.l1.m1.1.1.2.3" xref="alg2.l1.m1.1.1.2.3.cmml">′</mo></msup><mo stretchy="false" id="alg2.l1.m1.1.1.1" xref="alg2.l1.m1.1.1.1.cmml">←</mo><mi id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml">μ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><ci id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1">←</ci><apply id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.2.1.cmml" xref="alg2.l1.m1.1.1.2">superscript</csymbol><ci id="alg2.l1.m1.1.1.2.2.cmml" xref="alg2.l1.m1.1.1.2.2">𝜇</ci><ci id="alg2.l1.m1.1.1.2.3.cmml" xref="alg2.l1.m1.1.1.2.3">′</ci></apply><ci id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">𝜇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\mu^{\prime}\leftarrow\mu</annotation></semantics></math>, <math id="alg2.l1.m2.1" class="ltx_Math" alttext="\psi^{\prime}\leftarrow\psi" display="inline"><semantics id="alg2.l1.m2.1a"><mrow id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml"><msup id="alg2.l1.m2.1.1.2" xref="alg2.l1.m2.1.1.2.cmml"><mi id="alg2.l1.m2.1.1.2.2" xref="alg2.l1.m2.1.1.2.2.cmml">ψ</mi><mo id="alg2.l1.m2.1.1.2.3" xref="alg2.l1.m2.1.1.2.3.cmml">′</mo></msup><mo stretchy="false" id="alg2.l1.m2.1.1.1" xref="alg2.l1.m2.1.1.1.cmml">←</mo><mi id="alg2.l1.m2.1.1.3" xref="alg2.l1.m2.1.1.3.cmml">ψ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><apply id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1"><ci id="alg2.l1.m2.1.1.1.cmml" xref="alg2.l1.m2.1.1.1">←</ci><apply id="alg2.l1.m2.1.1.2.cmml" xref="alg2.l1.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.2.1.cmml" xref="alg2.l1.m2.1.1.2">superscript</csymbol><ci id="alg2.l1.m2.1.1.2.2.cmml" xref="alg2.l1.m2.1.1.2.2">𝜓</ci><ci id="alg2.l1.m2.1.1.2.3.cmml" xref="alg2.l1.m2.1.1.2.3">′</ci></apply><ci id="alg2.l1.m2.1.1.3.cmml" xref="alg2.l1.m2.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">\psi^{\prime}\leftarrow\psi</annotation></semantics></math>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span id="alg2.l2.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l2.m1.3" class="ltx_Math" alttext="s=1,\cdots,S" display="inline"><semantics id="alg2.l2.m1.3a"><mrow id="alg2.l2.m1.3.4" xref="alg2.l2.m1.3.4.cmml"><mi id="alg2.l2.m1.3.4.2" xref="alg2.l2.m1.3.4.2.cmml">s</mi><mo id="alg2.l2.m1.3.4.1" xref="alg2.l2.m1.3.4.1.cmml">=</mo><mrow id="alg2.l2.m1.3.4.3.2" xref="alg2.l2.m1.3.4.3.1.cmml"><mn id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">1</mn><mo id="alg2.l2.m1.3.4.3.2.1" xref="alg2.l2.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l2.m1.2.2" xref="alg2.l2.m1.2.2.cmml">⋯</mi><mo id="alg2.l2.m1.3.4.3.2.2" xref="alg2.l2.m1.3.4.3.1.cmml">,</mo><mi id="alg2.l2.m1.3.3" xref="alg2.l2.m1.3.3.cmml">S</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.3b"><apply id="alg2.l2.m1.3.4.cmml" xref="alg2.l2.m1.3.4"><eq id="alg2.l2.m1.3.4.1.cmml" xref="alg2.l2.m1.3.4.1"></eq><ci id="alg2.l2.m1.3.4.2.cmml" xref="alg2.l2.m1.3.4.2">𝑠</ci><list id="alg2.l2.m1.3.4.3.1.cmml" xref="alg2.l2.m1.3.4.3.2"><cn type="integer" id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">1</cn><ci id="alg2.l2.m1.2.2.cmml" xref="alg2.l2.m1.2.2">⋯</ci><ci id="alg2.l2.m1.3.3.cmml" xref="alg2.l2.m1.3.3">𝑆</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.3c">s=1,\cdots,S</annotation></semantics></math> <span id="alg2.l2.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>     Sample batch of data <math id="alg2.l3.m1.1" class="ltx_Math" alttext="\mathcal{D}^{\prime}" display="inline"><semantics id="alg2.l3.m1.1a"><msup id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">𝒟</mi><mo id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1">superscript</csymbol><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝒟</ci><ci id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">\mathcal{D}^{\prime}</annotation></semantics></math> from <math id="alg2.l3.m2.1" class="ltx_Math" alttext="\mathcal{D}^{pers}" display="inline"><semantics id="alg2.l3.m2.1a"><msup id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m2.1.1.2" xref="alg2.l3.m2.1.1.2.cmml">𝒟</mi><mrow id="alg2.l3.m2.1.1.3" xref="alg2.l3.m2.1.1.3.cmml"><mi id="alg2.l3.m2.1.1.3.2" xref="alg2.l3.m2.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m2.1.1.3.1" xref="alg2.l3.m2.1.1.3.1.cmml">​</mo><mi id="alg2.l3.m2.1.1.3.3" xref="alg2.l3.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m2.1.1.3.1a" xref="alg2.l3.m2.1.1.3.1.cmml">​</mo><mi id="alg2.l3.m2.1.1.3.4" xref="alg2.l3.m2.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m2.1.1.3.1b" xref="alg2.l3.m2.1.1.3.1.cmml">​</mo><mi id="alg2.l3.m2.1.1.3.5" xref="alg2.l3.m2.1.1.3.5.cmml">s</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><apply id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1"><csymbol cd="ambiguous" id="alg2.l3.m2.1.1.1.cmml" xref="alg2.l3.m2.1.1">superscript</csymbol><ci id="alg2.l3.m2.1.1.2.cmml" xref="alg2.l3.m2.1.1.2">𝒟</ci><apply id="alg2.l3.m2.1.1.3.cmml" xref="alg2.l3.m2.1.1.3"><times id="alg2.l3.m2.1.1.3.1.cmml" xref="alg2.l3.m2.1.1.3.1"></times><ci id="alg2.l3.m2.1.1.3.2.cmml" xref="alg2.l3.m2.1.1.3.2">𝑝</ci><ci id="alg2.l3.m2.1.1.3.3.cmml" xref="alg2.l3.m2.1.1.3.3">𝑒</ci><ci id="alg2.l3.m2.1.1.3.4.cmml" xref="alg2.l3.m2.1.1.3.4">𝑟</ci><ci id="alg2.l3.m2.1.1.3.5.cmml" xref="alg2.l3.m2.1.1.3.5">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">\mathcal{D}^{pers}</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     Predict modulation parameters <math id="alg2.l4.m1.1" class="ltx_Math" alttext="\bm{\zeta}=g_{\mu^{\prime}}(\mathcal{D}^{\prime})" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">𝜻</mi><mo id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">=</mo><mrow id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml"><msub id="alg2.l4.m1.1.1.1.3" xref="alg2.l4.m1.1.1.1.3.cmml"><mi id="alg2.l4.m1.1.1.1.3.2" xref="alg2.l4.m1.1.1.1.3.2.cmml">g</mi><msup id="alg2.l4.m1.1.1.1.3.3" xref="alg2.l4.m1.1.1.1.3.3.cmml"><mi id="alg2.l4.m1.1.1.1.3.3.2" xref="alg2.l4.m1.1.1.1.3.3.2.cmml">μ</mi><mo id="alg2.l4.m1.1.1.1.3.3.3" xref="alg2.l4.m1.1.1.1.3.3.3.cmml">′</mo></msup></msub><mo lspace="0em" rspace="0em" id="alg2.l4.m1.1.1.1.2" xref="alg2.l4.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l4.m1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l4.m1.1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.1.1.cmml">(</mo><msup id="alg2.l4.m1.1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.1.1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.1.1.2.cmml">𝒟</mi><mo id="alg2.l4.m1.1.1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="alg2.l4.m1.1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><eq id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2"></eq><ci id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">𝜻</ci><apply id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"><times id="alg2.l4.m1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.2"></times><apply id="alg2.l4.m1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l4.m1.1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.1.3.2">𝑔</ci><apply id="alg2.l4.m1.1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.3.3.1.cmml" xref="alg2.l4.m1.1.1.1.3.3">superscript</csymbol><ci id="alg2.l4.m1.1.1.1.3.3.2.cmml" xref="alg2.l4.m1.1.1.1.3.3.2">𝜇</ci><ci id="alg2.l4.m1.1.1.1.3.3.3.cmml" xref="alg2.l4.m1.1.1.1.3.3.3">′</ci></apply></apply><apply id="alg2.l4.m1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l4.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.2">𝒟</ci><ci id="alg2.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\bm{\zeta}=g_{\mu^{\prime}}(\mathcal{D}^{\prime})</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math id="alg2.l5.m1.1" class="ltx_Math" alttext="\mu^{\prime}=\mu^{\prime}-\alpha\nabla_{\mu^{\prime}}\mathcal{L}_{\mathcal{D}^{\prime}}(f_{\psi^{\prime}}|\bm{\zeta})" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><msup id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml"><mi id="alg2.l5.m1.1.1.3.2" xref="alg2.l5.m1.1.1.3.2.cmml">μ</mi><mo id="alg2.l5.m1.1.1.3.3" xref="alg2.l5.m1.1.1.3.3.cmml">′</mo></msup><mo id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">=</mo><mrow id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml"><msup id="alg2.l5.m1.1.1.1.3" xref="alg2.l5.m1.1.1.1.3.cmml"><mi id="alg2.l5.m1.1.1.1.3.2" xref="alg2.l5.m1.1.1.1.3.2.cmml">μ</mi><mo id="alg2.l5.m1.1.1.1.3.3" xref="alg2.l5.m1.1.1.1.3.3.cmml">′</mo></msup><mo id="alg2.l5.m1.1.1.1.2" xref="alg2.l5.m1.1.1.1.2.cmml">−</mo><mrow id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.cmml"><mi id="alg2.l5.m1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.3.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="alg2.l5.m1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l5.m1.1.1.1.1.4" xref="alg2.l5.m1.1.1.1.1.4.cmml"><msub id="alg2.l5.m1.1.1.1.1.4.1" xref="alg2.l5.m1.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="alg2.l5.m1.1.1.1.1.4.1.2" xref="alg2.l5.m1.1.1.1.1.4.1.2.cmml">∇</mo><msup id="alg2.l5.m1.1.1.1.1.4.1.3" xref="alg2.l5.m1.1.1.1.1.4.1.3.cmml"><mi id="alg2.l5.m1.1.1.1.1.4.1.3.2" xref="alg2.l5.m1.1.1.1.1.4.1.3.2.cmml">μ</mi><mo id="alg2.l5.m1.1.1.1.1.4.1.3.3" xref="alg2.l5.m1.1.1.1.1.4.1.3.3.cmml">′</mo></msup></msub><msub id="alg2.l5.m1.1.1.1.1.4.2" xref="alg2.l5.m1.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m1.1.1.1.1.4.2.2" xref="alg2.l5.m1.1.1.1.1.4.2.2.cmml">ℒ</mi><msup id="alg2.l5.m1.1.1.1.1.4.2.3" xref="alg2.l5.m1.1.1.1.1.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m1.1.1.1.1.4.2.3.2" xref="alg2.l5.m1.1.1.1.1.4.2.3.2.cmml">𝒟</mi><mo id="alg2.l5.m1.1.1.1.1.4.2.3.3" xref="alg2.l5.m1.1.1.1.1.4.2.3.3.cmml">′</mo></msup></msub></mrow><mo lspace="0em" rspace="0em" id="alg2.l5.m1.1.1.1.1.2a" xref="alg2.l5.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l5.m1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l5.m1.1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l5.m1.1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml"><msub id="alg2.l5.m1.1.1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l5.m1.1.1.1.1.1.1.1.2.2" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.2.cmml">f</mi><msup id="alg2.l5.m1.1.1.1.1.1.1.1.2.3" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="alg2.l5.m1.1.1.1.1.1.1.1.2.3.2" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.3.2.cmml">ψ</mi><mo id="alg2.l5.m1.1.1.1.1.1.1.1.2.3.3" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.3.3.cmml">′</mo></msup></msub><mo fence="false" id="alg2.l5.m1.1.1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="alg2.l5.m1.1.1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.1.1.3.cmml">𝜻</mi></mrow><mo stretchy="false" id="alg2.l5.m1.1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><eq id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"></eq><apply id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.3">superscript</csymbol><ci id="alg2.l5.m1.1.1.3.2.cmml" xref="alg2.l5.m1.1.1.3.2">𝜇</ci><ci id="alg2.l5.m1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.3.3">′</ci></apply><apply id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1"><minus id="alg2.l5.m1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.2"></minus><apply id="alg2.l5.m1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.1.3">superscript</csymbol><ci id="alg2.l5.m1.1.1.1.3.2.cmml" xref="alg2.l5.m1.1.1.1.3.2">𝜇</ci><ci id="alg2.l5.m1.1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.1.3.3">′</ci></apply><apply id="alg2.l5.m1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1"><times id="alg2.l5.m1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.2"></times><ci id="alg2.l5.m1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.3">𝛼</ci><apply id="alg2.l5.m1.1.1.1.1.4.cmml" xref="alg2.l5.m1.1.1.1.1.4"><apply id="alg2.l5.m1.1.1.1.1.4.1.cmml" xref="alg2.l5.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.4.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.4.1">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.4.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.4.1.2">∇</ci><apply id="alg2.l5.m1.1.1.1.1.4.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.4.1.3.1.cmml" xref="alg2.l5.m1.1.1.1.1.4.1.3">superscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.4.1.3.2.cmml" xref="alg2.l5.m1.1.1.1.1.4.1.3.2">𝜇</ci><ci id="alg2.l5.m1.1.1.1.1.4.1.3.3.cmml" xref="alg2.l5.m1.1.1.1.1.4.1.3.3">′</ci></apply></apply><apply id="alg2.l5.m1.1.1.1.1.4.2.cmml" xref="alg2.l5.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.4.2.1.cmml" xref="alg2.l5.m1.1.1.1.1.4.2">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.4.2.2.cmml" xref="alg2.l5.m1.1.1.1.1.4.2.2">ℒ</ci><apply id="alg2.l5.m1.1.1.1.1.4.2.3.cmml" xref="alg2.l5.m1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.4.2.3.1.cmml" xref="alg2.l5.m1.1.1.1.1.4.2.3">superscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.4.2.3.2.cmml" xref="alg2.l5.m1.1.1.1.1.4.2.3.2">𝒟</ci><ci id="alg2.l5.m1.1.1.1.1.4.2.3.3.cmml" xref="alg2.l5.m1.1.1.1.1.4.2.3.3">′</ci></apply></apply></apply><apply id="alg2.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l5.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="alg2.l5.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.2">𝑓</ci><apply id="alg2.l5.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.3.2">𝜓</ci><ci id="alg2.l5.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.3.3">′</ci></apply></apply><ci id="alg2.l5.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.3">𝜻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\mu^{\prime}=\mu^{\prime}-\alpha\nabla_{\mu^{\prime}}\mathcal{L}_{\mathcal{D}^{\prime}}(f_{\psi^{\prime}}|\bm{\zeta})</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math id="alg2.l6.m1.1" class="ltx_Math" alttext="\psi^{\prime}=\psi^{\prime}-\alpha\nabla_{\psi^{\prime}}\mathcal{L}_{\mathcal{D}^{\prime}}(f_{\psi^{\prime}}|\bm{\zeta})" display="inline"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><msup id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml"><mi id="alg2.l6.m1.1.1.3.2" xref="alg2.l6.m1.1.1.3.2.cmml">ψ</mi><mo id="alg2.l6.m1.1.1.3.3" xref="alg2.l6.m1.1.1.3.3.cmml">′</mo></msup><mo id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml">=</mo><mrow id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml"><msup id="alg2.l6.m1.1.1.1.3" xref="alg2.l6.m1.1.1.1.3.cmml"><mi id="alg2.l6.m1.1.1.1.3.2" xref="alg2.l6.m1.1.1.1.3.2.cmml">ψ</mi><mo id="alg2.l6.m1.1.1.1.3.3" xref="alg2.l6.m1.1.1.1.3.3.cmml">′</mo></msup><mo id="alg2.l6.m1.1.1.1.2" xref="alg2.l6.m1.1.1.1.2.cmml">−</mo><mrow id="alg2.l6.m1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.cmml"><mi id="alg2.l6.m1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.3.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="alg2.l6.m1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l6.m1.1.1.1.1.4" xref="alg2.l6.m1.1.1.1.1.4.cmml"><msub id="alg2.l6.m1.1.1.1.1.4.1" xref="alg2.l6.m1.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="alg2.l6.m1.1.1.1.1.4.1.2" xref="alg2.l6.m1.1.1.1.1.4.1.2.cmml">∇</mo><msup id="alg2.l6.m1.1.1.1.1.4.1.3" xref="alg2.l6.m1.1.1.1.1.4.1.3.cmml"><mi id="alg2.l6.m1.1.1.1.1.4.1.3.2" xref="alg2.l6.m1.1.1.1.1.4.1.3.2.cmml">ψ</mi><mo id="alg2.l6.m1.1.1.1.1.4.1.3.3" xref="alg2.l6.m1.1.1.1.1.4.1.3.3.cmml">′</mo></msup></msub><msub id="alg2.l6.m1.1.1.1.1.4.2" xref="alg2.l6.m1.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.1.1.1.1.4.2.2" xref="alg2.l6.m1.1.1.1.1.4.2.2.cmml">ℒ</mi><msup id="alg2.l6.m1.1.1.1.1.4.2.3" xref="alg2.l6.m1.1.1.1.1.4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.1.1.1.1.4.2.3.2" xref="alg2.l6.m1.1.1.1.1.4.2.3.2.cmml">𝒟</mi><mo id="alg2.l6.m1.1.1.1.1.4.2.3.3" xref="alg2.l6.m1.1.1.1.1.4.2.3.3.cmml">′</mo></msup></msub></mrow><mo lspace="0em" rspace="0em" id="alg2.l6.m1.1.1.1.1.2a" xref="alg2.l6.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l6.m1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l6.m1.1.1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l6.m1.1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.1.cmml"><msub id="alg2.l6.m1.1.1.1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l6.m1.1.1.1.1.1.1.1.2.2" xref="alg2.l6.m1.1.1.1.1.1.1.1.2.2.cmml">f</mi><msup id="alg2.l6.m1.1.1.1.1.1.1.1.2.3" xref="alg2.l6.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="alg2.l6.m1.1.1.1.1.1.1.1.2.3.2" xref="alg2.l6.m1.1.1.1.1.1.1.1.2.3.2.cmml">ψ</mi><mo id="alg2.l6.m1.1.1.1.1.1.1.1.2.3.3" xref="alg2.l6.m1.1.1.1.1.1.1.1.2.3.3.cmml">′</mo></msup></msub><mo fence="false" id="alg2.l6.m1.1.1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="alg2.l6.m1.1.1.1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.1.1.1.3.cmml">𝜻</mi></mrow><mo stretchy="false" id="alg2.l6.m1.1.1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><eq id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2"></eq><apply id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.3">superscript</csymbol><ci id="alg2.l6.m1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.3.2">𝜓</ci><ci id="alg2.l6.m1.1.1.3.3.cmml" xref="alg2.l6.m1.1.1.3.3">′</ci></apply><apply id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1"><minus id="alg2.l6.m1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.2"></minus><apply id="alg2.l6.m1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.1.3">superscript</csymbol><ci id="alg2.l6.m1.1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.1.3.2">𝜓</ci><ci id="alg2.l6.m1.1.1.1.3.3.cmml" xref="alg2.l6.m1.1.1.1.3.3">′</ci></apply><apply id="alg2.l6.m1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1"><times id="alg2.l6.m1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.2"></times><ci id="alg2.l6.m1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.3">𝛼</ci><apply id="alg2.l6.m1.1.1.1.1.4.cmml" xref="alg2.l6.m1.1.1.1.1.4"><apply id="alg2.l6.m1.1.1.1.1.4.1.cmml" xref="alg2.l6.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.4.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.4.1">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.4.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.4.1.2">∇</ci><apply id="alg2.l6.m1.1.1.1.1.4.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.4.1.3.1.cmml" xref="alg2.l6.m1.1.1.1.1.4.1.3">superscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.4.1.3.2.cmml" xref="alg2.l6.m1.1.1.1.1.4.1.3.2">𝜓</ci><ci id="alg2.l6.m1.1.1.1.1.4.1.3.3.cmml" xref="alg2.l6.m1.1.1.1.1.4.1.3.3">′</ci></apply></apply><apply id="alg2.l6.m1.1.1.1.1.4.2.cmml" xref="alg2.l6.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.4.2.1.cmml" xref="alg2.l6.m1.1.1.1.1.4.2">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.4.2.2.cmml" xref="alg2.l6.m1.1.1.1.1.4.2.2">ℒ</ci><apply id="alg2.l6.m1.1.1.1.1.4.2.3.cmml" xref="alg2.l6.m1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.4.2.3.1.cmml" xref="alg2.l6.m1.1.1.1.1.4.2.3">superscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.4.2.3.2.cmml" xref="alg2.l6.m1.1.1.1.1.4.2.3.2">𝒟</ci><ci id="alg2.l6.m1.1.1.1.1.4.2.3.3.cmml" xref="alg2.l6.m1.1.1.1.1.4.2.3.3">′</ci></apply></apply></apply><apply id="alg2.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l6.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="alg2.l6.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.2.2">𝑓</ci><apply id="alg2.l6.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.2.3.2">𝜓</ci><ci id="alg2.l6.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.2.3.3">′</ci></apply></apply><ci id="alg2.l6.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.1.3">𝜻</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\psi^{\prime}=\psi^{\prime}-\alpha\nabla_{\psi^{\prime}}\mathcal{L}_{\mathcal{D}^{\prime}}(f_{\psi^{\prime}}|\bm{\zeta})</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>  <span id="alg2.l7.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l7.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>  Predict modulation parameters <math id="alg2.l8.m1.1" class="ltx_Math" alttext="\bm{\zeta}=g_{\mu^{\prime}}(\mathcal{D}^{\prime})" display="inline"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml">𝜻</mi><mo id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">=</mo><mrow id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml"><msub id="alg2.l8.m1.1.1.1.3" xref="alg2.l8.m1.1.1.1.3.cmml"><mi id="alg2.l8.m1.1.1.1.3.2" xref="alg2.l8.m1.1.1.1.3.2.cmml">g</mi><msup id="alg2.l8.m1.1.1.1.3.3" xref="alg2.l8.m1.1.1.1.3.3.cmml"><mi id="alg2.l8.m1.1.1.1.3.3.2" xref="alg2.l8.m1.1.1.1.3.3.2.cmml">μ</mi><mo id="alg2.l8.m1.1.1.1.3.3.3" xref="alg2.l8.m1.1.1.1.3.3.3.cmml">′</mo></msup></msub><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.1.2" xref="alg2.l8.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l8.m1.1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l8.m1.1.1.1.1.1.2" xref="alg2.l8.m1.1.1.1.1.1.1.cmml">(</mo><msup id="alg2.l8.m1.1.1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.1.1.1.1.1.1.2" xref="alg2.l8.m1.1.1.1.1.1.1.2.cmml">𝒟</mi><mo id="alg2.l8.m1.1.1.1.1.1.1.3" xref="alg2.l8.m1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="alg2.l8.m1.1.1.1.1.1.3" xref="alg2.l8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><eq id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2"></eq><ci id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3">𝜻</ci><apply id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1"><times id="alg2.l8.m1.1.1.1.2.cmml" xref="alg2.l8.m1.1.1.1.2"></times><apply id="alg2.l8.m1.1.1.1.3.cmml" xref="alg2.l8.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l8.m1.1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.1.3.2">𝑔</ci><apply id="alg2.l8.m1.1.1.1.3.3.cmml" xref="alg2.l8.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.3.3.1.cmml" xref="alg2.l8.m1.1.1.1.3.3">superscript</csymbol><ci id="alg2.l8.m1.1.1.1.3.3.2.cmml" xref="alg2.l8.m1.1.1.1.3.3.2">𝜇</ci><ci id="alg2.l8.m1.1.1.1.3.3.3.cmml" xref="alg2.l8.m1.1.1.1.3.3.3">′</ci></apply></apply><apply id="alg2.l8.m1.1.1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l8.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.2">𝒟</ci><ci id="alg2.l8.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\bm{\zeta}=g_{\mu^{\prime}}(\mathcal{D}^{\prime})</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>  <span id="alg2.l9.1" class="ltx_text ltx_font_bold">return</span> <math id="alg2.l9.m1.2" class="ltx_Math" alttext="\psi^{\prime},\bm{\zeta}" display="inline"><semantics id="alg2.l9.m1.2a"><mrow id="alg2.l9.m1.2.2.1" xref="alg2.l9.m1.2.2.2.cmml"><msup id="alg2.l9.m1.2.2.1.1" xref="alg2.l9.m1.2.2.1.1.cmml"><mi id="alg2.l9.m1.2.2.1.1.2" xref="alg2.l9.m1.2.2.1.1.2.cmml">ψ</mi><mo id="alg2.l9.m1.2.2.1.1.3" xref="alg2.l9.m1.2.2.1.1.3.cmml">′</mo></msup><mo id="alg2.l9.m1.2.2.1.2" xref="alg2.l9.m1.2.2.2.cmml">,</mo><mi id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">𝜻</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.2b"><list id="alg2.l9.m1.2.2.2.cmml" xref="alg2.l9.m1.2.2.1"><apply id="alg2.l9.m1.2.2.1.1.cmml" xref="alg2.l9.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.1.1.1.cmml" xref="alg2.l9.m1.2.2.1.1">superscript</csymbol><ci id="alg2.l9.m1.2.2.1.1.2.cmml" xref="alg2.l9.m1.2.2.1.1.2">𝜓</ci><ci id="alg2.l9.m1.2.2.1.1.3.cmml" xref="alg2.l9.m1.2.2.1.1.3">′</ci></apply><ci id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">𝜻</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.2c">\psi^{\prime},\bm{\zeta}</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">During the testing phase, new clients can join the federation, possibly with local data sampled from different data distributions compared to those encountered during training. The objective is to obtain a personalized model for each new client that performs effectively on its local data, potentially requiring a few personalization steps and only a small amount of labeled data.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experimental setup</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Datasets.</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We assess the performance of <em id="S5.SS1.p1.1.1" class="ltx_emph ltx_font_italic">CAFeMe</em> on various datasets, including synthetic and realistic non-i.i.d datasets. For the synthetic datasets, we synthesize distributed non-i.i.d datasets by partitioning well-known benchmarks, such as CIFAR-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx19" title="" class="ltx_ref">19</a>]</cite> and RMNIST (a modified version of the classic MNIST dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx7" title="" class="ltx_ref">7</a>]</cite>), into smaller subsets specific to each client. Inspired by previous works in the field <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx27" title="" class="ltx_ref">27</a>, <a href="#bib.bibx45" title="" class="ltx_ref">45</a>, <a href="#bib.bibx14" title="" class="ltx_ref">14</a>, <a href="#bib.bibx40" title="" class="ltx_ref">40</a>]</cite>, we explore two different data partitioning schemes: the <em id="S5.SS1.p1.1.2" class="ltx_emph ltx_font_italic">shards</em> partition and the <em id="S5.SS1.p1.1.3" class="ltx_emph ltx_font_italic">dirichlet</em> partition.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">We also evaluate the performance of the proposed approach on two more realistic datasets, namely FEMNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx2" title="" class="ltx_ref">2</a>]</cite> and Meta-Dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx37" title="" class="ltx_ref">37</a>]</cite>. While FEMNIST has been extensively used in the FL literature, this study represents the first time Meta-Dataset is employed to evaluate the performance of a PFL algorithm. Meta-Dataset is a large-scale dataset comprising various classification datasets.
In this setting, we assume clients share the common tasks of classifying images into <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">N</annotation></semantics></math> different classes, but their local data are sampled from completely different datasets. For this reason, the same label might have different meanings across clients, hence the concept shift scenario. This scenario closely resembles real-world situations where clients that participate in the federation might belong to different enterprises with diverse goals and interests.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Compared methods.</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We compare the results with several state-of-the-art approaches. Specifically, we include FL works such as FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx27" title="" class="ltx_ref">27</a>]</cite> with its fine-tuned variant (i.e., FedAvg-FT), and IFCA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx11" title="" class="ltx_ref">11</a>]</cite>, a framework specifically designed for clustered FL, together with IFCA-FT. Furthermore, we consider Ditto <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx22" title="" class="ltx_ref">22</a>]</cite> a multi-task learning framework tailored for PFL, FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx5" title="" class="ltx_ref">5</a>]</cite> a PFL method characterized by parameter decoupling of feature extractor and classifier, and Per-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx9" title="" class="ltx_ref">9</a>]</cite> a meta-learning approach specifically designed for solving PFL problems.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Training setting.</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.13" class="ltx_p">To ensure fair and reliable comparisons, similar hyperparameters and model architectures have been used for all the baselines.
For all the datasets, <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="80" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mn id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><cn type="integer" id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">80</annotation></semantics></math> clients (<math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="C=80" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">C</mi><mo id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml">80</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><eq id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1"></eq><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">𝐶</ci><cn type="integer" id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">C=80</annotation></semantics></math>) are used for training the models and <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mn id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><cn type="integer" id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">20</annotation></semantics></math> clients for evaluation of the performance. The number of communication rounds is set to <math id="S5.SS3.p1.4.m4.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S5.SS3.p1.4.m4.1a"><mn id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><cn type="integer" id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">1000</annotation></semantics></math>, except for FEMNIST and Meta-Dataset where it is set to <math id="S5.SS3.p1.5.m5.1" class="ltx_Math" alttext="2000" display="inline"><semantics id="S5.SS3.p1.5.m5.1a"><mn id="S5.SS3.p1.5.m5.1.1" xref="S5.SS3.p1.5.m5.1.1.cmml">2000</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.5.m5.1b"><cn type="integer" id="S5.SS3.p1.5.m5.1.1.cmml" xref="S5.SS3.p1.5.m5.1.1">2000</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.5.m5.1c">2000</annotation></semantics></math>, due to the complexity of the datasets. For each round of communication, we randomly select <math id="S5.SS3.p1.6.m6.1" class="ltx_Math" alttext="M=5" display="inline"><semantics id="S5.SS3.p1.6.m6.1a"><mrow id="S5.SS3.p1.6.m6.1.1" xref="S5.SS3.p1.6.m6.1.1.cmml"><mi id="S5.SS3.p1.6.m6.1.1.2" xref="S5.SS3.p1.6.m6.1.1.2.cmml">M</mi><mo id="S5.SS3.p1.6.m6.1.1.1" xref="S5.SS3.p1.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.6.m6.1.1.3" xref="S5.SS3.p1.6.m6.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.6.m6.1b"><apply id="S5.SS3.p1.6.m6.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1"><eq id="S5.SS3.p1.6.m6.1.1.1.cmml" xref="S5.SS3.p1.6.m6.1.1.1"></eq><ci id="S5.SS3.p1.6.m6.1.1.2.cmml" xref="S5.SS3.p1.6.m6.1.1.2">𝑀</ci><cn type="integer" id="S5.SS3.p1.6.m6.1.1.3.cmml" xref="S5.SS3.p1.6.m6.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.6.m6.1c">M=5</annotation></semantics></math> clients, and we perform <math id="S5.SS3.p1.7.m7.1" class="ltx_Math" alttext="S=5" display="inline"><semantics id="S5.SS3.p1.7.m7.1a"><mrow id="S5.SS3.p1.7.m7.1.1" xref="S5.SS3.p1.7.m7.1.1.cmml"><mi id="S5.SS3.p1.7.m7.1.1.2" xref="S5.SS3.p1.7.m7.1.1.2.cmml">S</mi><mo id="S5.SS3.p1.7.m7.1.1.1" xref="S5.SS3.p1.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.7.m7.1.1.3" xref="S5.SS3.p1.7.m7.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.7.m7.1b"><apply id="S5.SS3.p1.7.m7.1.1.cmml" xref="S5.SS3.p1.7.m7.1.1"><eq id="S5.SS3.p1.7.m7.1.1.1.cmml" xref="S5.SS3.p1.7.m7.1.1.1"></eq><ci id="S5.SS3.p1.7.m7.1.1.2.cmml" xref="S5.SS3.p1.7.m7.1.1.2">𝑆</ci><cn type="integer" id="S5.SS3.p1.7.m7.1.1.3.cmml" xref="S5.SS3.p1.7.m7.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.7.m7.1c">S=5</annotation></semantics></math> personalization steps. At test time, we let the models perform <math id="S5.SS3.p1.8.m8.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S5.SS3.p1.8.m8.1a"><mn id="S5.SS3.p1.8.m8.1.1" xref="S5.SS3.p1.8.m8.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.8.m8.1b"><cn type="integer" id="S5.SS3.p1.8.m8.1.1.cmml" xref="S5.SS3.p1.8.m8.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.8.m8.1c">50</annotation></semantics></math> personalization steps to allow a good personalization to each client’s own data. We use mini-batch stochastic gradient descent (SGD) as a local optimizer, with a fixed batch size of <math id="S5.SS3.p1.9.m9.1" class="ltx_Math" alttext="30" display="inline"><semantics id="S5.SS3.p1.9.m9.1a"><mn id="S5.SS3.p1.9.m9.1.1" xref="S5.SS3.p1.9.m9.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.9.m9.1b"><cn type="integer" id="S5.SS3.p1.9.m9.1.1.cmml" xref="S5.SS3.p1.9.m9.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.9.m9.1c">30</annotation></semantics></math> samples.
For <em id="S5.SS3.p1.13.1" class="ltx_emph ltx_font_italic">CAFeMe</em>, we use the feature-wise gating defined in Equation <a href="#S4.E4" title="In 4.2 Algorithm. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a> as a way to modulate the activations of the base model. However, we also investigated an alternative way by using an affine transformation, as used in FiLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx31" title="" class="ltx_ref">31</a>]</cite>. In this case, the modulation parameters <math id="S5.SS3.p1.10.m10.1" class="ltx_Math" alttext="\zeta^{l}" display="inline"><semantics id="S5.SS3.p1.10.m10.1a"><msup id="S5.SS3.p1.10.m10.1.1" xref="S5.SS3.p1.10.m10.1.1.cmml"><mi id="S5.SS3.p1.10.m10.1.1.2" xref="S5.SS3.p1.10.m10.1.1.2.cmml">ζ</mi><mi id="S5.SS3.p1.10.m10.1.1.3" xref="S5.SS3.p1.10.m10.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.10.m10.1b"><apply id="S5.SS3.p1.10.m10.1.1.cmml" xref="S5.SS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.10.m10.1.1.1.cmml" xref="S5.SS3.p1.10.m10.1.1">superscript</csymbol><ci id="S5.SS3.p1.10.m10.1.1.2.cmml" xref="S5.SS3.p1.10.m10.1.1.2">𝜁</ci><ci id="S5.SS3.p1.10.m10.1.1.3.cmml" xref="S5.SS3.p1.10.m10.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.10.m10.1c">\zeta^{l}</annotation></semantics></math> of a layer <math id="S5.SS3.p1.11.m11.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S5.SS3.p1.11.m11.1a"><mi id="S5.SS3.p1.11.m11.1.1" xref="S5.SS3.p1.11.m11.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.11.m11.1b"><ci id="S5.SS3.p1.11.m11.1.1.cmml" xref="S5.SS3.p1.11.m11.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.11.m11.1c">l</annotation></semantics></math> consists of two vectors, <math id="S5.SS3.p1.12.m12.1" class="ltx_Math" alttext="\zeta_{a}^{l}" display="inline"><semantics id="S5.SS3.p1.12.m12.1a"><msubsup id="S5.SS3.p1.12.m12.1.1" xref="S5.SS3.p1.12.m12.1.1.cmml"><mi id="S5.SS3.p1.12.m12.1.1.2.2" xref="S5.SS3.p1.12.m12.1.1.2.2.cmml">ζ</mi><mi id="S5.SS3.p1.12.m12.1.1.2.3" xref="S5.SS3.p1.12.m12.1.1.2.3.cmml">a</mi><mi id="S5.SS3.p1.12.m12.1.1.3" xref="S5.SS3.p1.12.m12.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.12.m12.1b"><apply id="S5.SS3.p1.12.m12.1.1.cmml" xref="S5.SS3.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.12.m12.1.1.1.cmml" xref="S5.SS3.p1.12.m12.1.1">superscript</csymbol><apply id="S5.SS3.p1.12.m12.1.1.2.cmml" xref="S5.SS3.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.12.m12.1.1.2.1.cmml" xref="S5.SS3.p1.12.m12.1.1">subscript</csymbol><ci id="S5.SS3.p1.12.m12.1.1.2.2.cmml" xref="S5.SS3.p1.12.m12.1.1.2.2">𝜁</ci><ci id="S5.SS3.p1.12.m12.1.1.2.3.cmml" xref="S5.SS3.p1.12.m12.1.1.2.3">𝑎</ci></apply><ci id="S5.SS3.p1.12.m12.1.1.3.cmml" xref="S5.SS3.p1.12.m12.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.12.m12.1c">\zeta_{a}^{l}</annotation></semantics></math> and <math id="S5.SS3.p1.13.m13.1" class="ltx_Math" alttext="\zeta_{b}^{l}" display="inline"><semantics id="S5.SS3.p1.13.m13.1a"><msubsup id="S5.SS3.p1.13.m13.1.1" xref="S5.SS3.p1.13.m13.1.1.cmml"><mi id="S5.SS3.p1.13.m13.1.1.2.2" xref="S5.SS3.p1.13.m13.1.1.2.2.cmml">ζ</mi><mi id="S5.SS3.p1.13.m13.1.1.2.3" xref="S5.SS3.p1.13.m13.1.1.2.3.cmml">b</mi><mi id="S5.SS3.p1.13.m13.1.1.3" xref="S5.SS3.p1.13.m13.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.13.m13.1b"><apply id="S5.SS3.p1.13.m13.1.1.cmml" xref="S5.SS3.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.13.m13.1.1.1.cmml" xref="S5.SS3.p1.13.m13.1.1">superscript</csymbol><apply id="S5.SS3.p1.13.m13.1.1.2.cmml" xref="S5.SS3.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.13.m13.1.1.2.1.cmml" xref="S5.SS3.p1.13.m13.1.1">subscript</csymbol><ci id="S5.SS3.p1.13.m13.1.1.2.2.cmml" xref="S5.SS3.p1.13.m13.1.1.2.2">𝜁</ci><ci id="S5.SS3.p1.13.m13.1.1.2.3.cmml" xref="S5.SS3.p1.13.m13.1.1.2.3">𝑏</ci></apply><ci id="S5.SS3.p1.13.m13.1.1.3.cmml" xref="S5.SS3.p1.13.m13.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.13.m13.1c">\zeta_{b}^{l}</annotation></semantics></math>, used to scale and bias the activations, i.e.,</p>
<table id="S5.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.Ex1.m1.1" class="ltx_Math" alttext="a(\mathbf{x}~{}\psi^{l})\odot\zeta^{l}=\zeta_{a}^{l}~{}\otimes~{}a(\mathbf{x}~{}\psi^{l})~{}+~{}\zeta_{b}^{l}." display="block"><semantics id="S5.Ex1.m1.1a"><mrow id="S5.Ex1.m1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.cmml"><mrow id="S5.Ex1.m1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.cmml"><mrow id="S5.Ex1.m1.1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.1.cmml"><mrow id="S5.Ex1.m1.1.1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.1.1.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.1.3" xref="S5.Ex1.m1.1.1.1.1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.1.1.1.1.1.1.2" xref="S5.Ex1.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S5.Ex1.m1.1.1.1.1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.Ex1.m1.1.1.1.1.1.1.1.1.2" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.2" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mo lspace="0.330em" rspace="0em" id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msup></mrow><mo rspace="0.055em" stretchy="false" id="S5.Ex1.m1.1.1.1.1.1.1.1.1.3" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S5.Ex1.m1.1.1.1.1.1.2" xref="S5.Ex1.m1.1.1.1.1.1.2.cmml">⊙</mo><msup id="S5.Ex1.m1.1.1.1.1.1.3" xref="S5.Ex1.m1.1.1.1.1.1.3.cmml"><mi id="S5.Ex1.m1.1.1.1.1.1.3.2" xref="S5.Ex1.m1.1.1.1.1.1.3.2.cmml">ζ</mi><mi id="S5.Ex1.m1.1.1.1.1.1.3.3" xref="S5.Ex1.m1.1.1.1.1.1.3.3.cmml">l</mi></msup></mrow><mo id="S5.Ex1.m1.1.1.1.1.3" xref="S5.Ex1.m1.1.1.1.1.3.cmml">=</mo><mrow id="S5.Ex1.m1.1.1.1.1.2" xref="S5.Ex1.m1.1.1.1.1.2.cmml"><mrow id="S5.Ex1.m1.1.1.1.1.2.1" xref="S5.Ex1.m1.1.1.1.1.2.1.cmml"><mrow id="S5.Ex1.m1.1.1.1.1.2.1.3" xref="S5.Ex1.m1.1.1.1.1.2.1.3.cmml"><msubsup id="S5.Ex1.m1.1.1.1.1.2.1.3.2" xref="S5.Ex1.m1.1.1.1.1.2.1.3.2.cmml"><mi id="S5.Ex1.m1.1.1.1.1.2.1.3.2.2.2" xref="S5.Ex1.m1.1.1.1.1.2.1.3.2.2.2.cmml">ζ</mi><mi id="S5.Ex1.m1.1.1.1.1.2.1.3.2.2.3" xref="S5.Ex1.m1.1.1.1.1.2.1.3.2.2.3.cmml">a</mi><mi id="S5.Ex1.m1.1.1.1.1.2.1.3.2.3" xref="S5.Ex1.m1.1.1.1.1.2.1.3.2.3.cmml">l</mi></msubsup><mo lspace="0.222em" rspace="0.552em" id="S5.Ex1.m1.1.1.1.1.2.1.3.1" xref="S5.Ex1.m1.1.1.1.1.2.1.3.1.cmml">⊗</mo><mi id="S5.Ex1.m1.1.1.1.1.2.1.3.3" xref="S5.Ex1.m1.1.1.1.1.2.1.3.3.cmml">a</mi></mrow><mo lspace="0em" rspace="0em" id="S5.Ex1.m1.1.1.1.1.2.1.2" xref="S5.Ex1.m1.1.1.1.1.2.1.2.cmml">​</mo><mrow id="S5.Ex1.m1.1.1.1.1.2.1.1.1" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S5.Ex1.m1.1.1.1.1.2.1.1.1.2" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.2" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.2.cmml">𝐱</mi><mo lspace="0.330em" rspace="0em" id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.1" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.1.cmml">​</mo><msup id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3.2" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3.2.cmml">ψ</mi><mi id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3.3" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3.3.cmml">l</mi></msup></mrow><mo rspace="0.330em" stretchy="false" id="S5.Ex1.m1.1.1.1.1.2.1.1.1.3" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.552em" id="S5.Ex1.m1.1.1.1.1.2.2" xref="S5.Ex1.m1.1.1.1.1.2.2.cmml">+</mo><msubsup id="S5.Ex1.m1.1.1.1.1.2.3" xref="S5.Ex1.m1.1.1.1.1.2.3.cmml"><mi id="S5.Ex1.m1.1.1.1.1.2.3.2.2" xref="S5.Ex1.m1.1.1.1.1.2.3.2.2.cmml">ζ</mi><mi id="S5.Ex1.m1.1.1.1.1.2.3.2.3" xref="S5.Ex1.m1.1.1.1.1.2.3.2.3.cmml">b</mi><mi id="S5.Ex1.m1.1.1.1.1.2.3.3" xref="S5.Ex1.m1.1.1.1.1.2.3.3.cmml">l</mi></msubsup></mrow></mrow><mo lspace="0em" id="S5.Ex1.m1.1.1.1.2" xref="S5.Ex1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex1.m1.1b"><apply id="S5.Ex1.m1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1"><eq id="S5.Ex1.m1.1.1.1.1.3.cmml" xref="S5.Ex1.m1.1.1.1.1.3"></eq><apply id="S5.Ex1.m1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S5.Ex1.m1.1.1.1.1.1.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.2">direct-product</csymbol><apply id="S5.Ex1.m1.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1"><times id="S5.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.2"></times><ci id="S5.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.3">𝑎</ci><apply id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1"><times id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3.2">𝜓</ci><ci id="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><apply id="S5.Ex1.m1.1.1.1.1.1.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.1.3.1.cmml" xref="S5.Ex1.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S5.Ex1.m1.1.1.1.1.1.3.2.cmml" xref="S5.Ex1.m1.1.1.1.1.1.3.2">𝜁</ci><ci id="S5.Ex1.m1.1.1.1.1.1.3.3.cmml" xref="S5.Ex1.m1.1.1.1.1.1.3.3">𝑙</ci></apply></apply><apply id="S5.Ex1.m1.1.1.1.1.2.cmml" xref="S5.Ex1.m1.1.1.1.1.2"><plus id="S5.Ex1.m1.1.1.1.1.2.2.cmml" xref="S5.Ex1.m1.1.1.1.1.2.2"></plus><apply id="S5.Ex1.m1.1.1.1.1.2.1.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1"><times id="S5.Ex1.m1.1.1.1.1.2.1.2.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.2"></times><apply id="S5.Ex1.m1.1.1.1.1.2.1.3.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.3"><csymbol cd="latexml" id="S5.Ex1.m1.1.1.1.1.2.1.3.1.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.3.1">tensor-product</csymbol><apply id="S5.Ex1.m1.1.1.1.1.2.1.3.2.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.3.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.2.1.3.2.1.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.3.2">superscript</csymbol><apply id="S5.Ex1.m1.1.1.1.1.2.1.3.2.2.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.3.2"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.2.1.3.2.2.1.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.3.2">subscript</csymbol><ci id="S5.Ex1.m1.1.1.1.1.2.1.3.2.2.2.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.3.2.2.2">𝜁</ci><ci id="S5.Ex1.m1.1.1.1.1.2.1.3.2.2.3.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.3.2.2.3">𝑎</ci></apply><ci id="S5.Ex1.m1.1.1.1.1.2.1.3.2.3.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.3.2.3">𝑙</ci></apply><ci id="S5.Ex1.m1.1.1.1.1.2.1.3.3.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.3.3">𝑎</ci></apply><apply id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1"><times id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.1"></times><ci id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.2">𝐱</ci><apply id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3">superscript</csymbol><ci id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3.2">𝜓</ci><ci id="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3.3.cmml" xref="S5.Ex1.m1.1.1.1.1.2.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><apply id="S5.Ex1.m1.1.1.1.1.2.3.cmml" xref="S5.Ex1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.2.3.1.cmml" xref="S5.Ex1.m1.1.1.1.1.2.3">superscript</csymbol><apply id="S5.Ex1.m1.1.1.1.1.2.3.2.cmml" xref="S5.Ex1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S5.Ex1.m1.1.1.1.1.2.3.2.1.cmml" xref="S5.Ex1.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S5.Ex1.m1.1.1.1.1.2.3.2.2.cmml" xref="S5.Ex1.m1.1.1.1.1.2.3.2.2">𝜁</ci><ci id="S5.Ex1.m1.1.1.1.1.2.3.2.3.cmml" xref="S5.Ex1.m1.1.1.1.1.2.3.2.3">𝑏</ci></apply><ci id="S5.Ex1.m1.1.1.1.1.2.3.3.cmml" xref="S5.Ex1.m1.1.1.1.1.2.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex1.m1.1c">a(\mathbf{x}~{}\psi^{l})\odot\zeta^{l}=\zeta_{a}^{l}~{}\otimes~{}a(\mathbf{x}~{}\psi^{l})~{}+~{}\zeta_{b}^{l}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S5.SS3.p1.14" class="ltx_p">Nonetheless, with this modulation, the performance of <em id="S5.SS3.p1.14.1" class="ltx_emph ltx_font_italic">CAFeMe</em> is highly variable across different runs of the algorithm and doesn’t achieve a good performance. This is likely because scaling the model’s activations with a value that is not normalized in <math id="S5.SS3.p1.14.m1.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S5.SS3.p1.14.m1.2a"><mrow id="S5.SS3.p1.14.m1.2.3.2" xref="S5.SS3.p1.14.m1.2.3.1.cmml"><mo stretchy="false" id="S5.SS3.p1.14.m1.2.3.2.1" xref="S5.SS3.p1.14.m1.2.3.1.cmml">[</mo><mn id="S5.SS3.p1.14.m1.1.1" xref="S5.SS3.p1.14.m1.1.1.cmml">0</mn><mo id="S5.SS3.p1.14.m1.2.3.2.2" xref="S5.SS3.p1.14.m1.2.3.1.cmml">,</mo><mn id="S5.SS3.p1.14.m1.2.2" xref="S5.SS3.p1.14.m1.2.2.cmml">1</mn><mo stretchy="false" id="S5.SS3.p1.14.m1.2.3.2.3" xref="S5.SS3.p1.14.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.14.m1.2b"><interval closure="closed" id="S5.SS3.p1.14.m1.2.3.1.cmml" xref="S5.SS3.p1.14.m1.2.3.2"><cn type="integer" id="S5.SS3.p1.14.m1.1.1.cmml" xref="S5.SS3.p1.14.m1.1.1">0</cn><cn type="integer" id="S5.SS3.p1.14.m1.2.2.cmml" xref="S5.SS3.p1.14.m1.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.14.m1.2c">[0,1]</annotation></semantics></math> (unlike the sigmoidal feature-wise gating of Equation <a href="#S4.E4" title="In 4.2 Algorithm. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>) may result in ending up in a local minima far from the optimal results. Therefore, in the rest of the experiments, all results are reported using the feature-wise gating mechanism in Equation <a href="#S4.E4" title="In 4.2 Algorithm. ‣ 4 Proposed approach ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.1" class="ltx_p">We construct two different models for RMNIST/FEMNIST and CIFAR-10/Meta-Dataset, respectively. The first CNN model comprises two modules, each consisting of a convolutional layer with 32 filters, followed by batch normalization and ReLU nonlinearities. One linear layer with a size of 576 is used to complete the classification model. Similarly, the architecture of the federated modulator consists of the same two modules followed by three linear layers with sizes of 100, 200, 200, respectively. The second CNN model is similar to the first one but comprises three modules with 64 filters and two linear layers with a size of 576. Also, the federated modulator has three modules and four linear layers with sizes of 100, 100, 200, 200.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.1" class="ltx_p">To account for statistical variations, we conduct five complete runs of the algorithms and report the results as the average accuracy and standard deviation.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Results</h2>

<figure id="S6.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S6.T1.36.2.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S6.T1.2.1" class="ltx_text" style="font-size:90%;">Comparison of test accuracy (%) after <math id="S6.T1.2.1.m1.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S6.T1.2.1.m1.1b"><mn id="S6.T1.2.1.m1.1.1" xref="S6.T1.2.1.m1.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S6.T1.2.1.m1.1c"><cn type="integer" id="S6.T1.2.1.m1.1.1.cmml" xref="S6.T1.2.1.m1.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.2.1.m1.1d">50</annotation></semantics></math> personalization steps on new clients at test time on synthetic datasets.</span></figcaption>
<table id="S6.T1.34" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T1.34.33.1" class="ltx_tr">
<th id="S6.T1.34.33.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S6.T1.34.33.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S6.T1.34.33.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2"><span id="S6.T1.34.33.1.2.1" class="ltx_text ltx_font_bold">CIFAR-10</span></th>
<th id="S6.T1.34.33.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2"><span id="S6.T1.34.33.1.3.1" class="ltx_text ltx_font_bold">RMNIST</span></th>
</tr>
<tr id="S6.T1.34.34.2" class="ltx_tr">
<th id="S6.T1.34.34.2.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S6.T1.34.34.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><em id="S6.T1.34.34.2.2.1" class="ltx_emph ltx_font_italic">Shards</em></th>
<th id="S6.T1.34.34.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><em id="S6.T1.34.34.2.3.1" class="ltx_emph ltx_font_italic">Dirichlet</em></th>
<th id="S6.T1.34.34.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><em id="S6.T1.34.34.2.4.1" class="ltx_emph ltx_font_italic">Shards</em></th>
<th id="S6.T1.34.34.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><em id="S6.T1.34.34.2.5.1" class="ltx_emph ltx_font_italic">Dirichlet</em></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T1.6.4" class="ltx_tr">
<th id="S6.T1.6.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg</th>
<td id="S6.T1.3.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S6.T1.3.1.1.m1.1" class="ltx_Math" alttext="27.87\pm 1.10" display="inline"><semantics id="S6.T1.3.1.1.m1.1a"><mrow id="S6.T1.3.1.1.m1.1.1" xref="S6.T1.3.1.1.m1.1.1.cmml"><mn id="S6.T1.3.1.1.m1.1.1.2" xref="S6.T1.3.1.1.m1.1.1.2.cmml">27.87</mn><mo id="S6.T1.3.1.1.m1.1.1.1" xref="S6.T1.3.1.1.m1.1.1.1.cmml">±</mo><mn id="S6.T1.3.1.1.m1.1.1.3" xref="S6.T1.3.1.1.m1.1.1.3.cmml">1.10</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.3.1.1.m1.1b"><apply id="S6.T1.3.1.1.m1.1.1.cmml" xref="S6.T1.3.1.1.m1.1.1"><csymbol cd="latexml" id="S6.T1.3.1.1.m1.1.1.1.cmml" xref="S6.T1.3.1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.3.1.1.m1.1.1.2.cmml" xref="S6.T1.3.1.1.m1.1.1.2">27.87</cn><cn type="float" id="S6.T1.3.1.1.m1.1.1.3.cmml" xref="S6.T1.3.1.1.m1.1.1.3">1.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.3.1.1.m1.1c">27.87\pm 1.10</annotation></semantics></math></td>
<td id="S6.T1.4.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S6.T1.4.2.2.m1.1" class="ltx_Math" alttext="40.91\pm 1.98" display="inline"><semantics id="S6.T1.4.2.2.m1.1a"><mrow id="S6.T1.4.2.2.m1.1.1" xref="S6.T1.4.2.2.m1.1.1.cmml"><mn id="S6.T1.4.2.2.m1.1.1.2" xref="S6.T1.4.2.2.m1.1.1.2.cmml">40.91</mn><mo id="S6.T1.4.2.2.m1.1.1.1" xref="S6.T1.4.2.2.m1.1.1.1.cmml">±</mo><mn id="S6.T1.4.2.2.m1.1.1.3" xref="S6.T1.4.2.2.m1.1.1.3.cmml">1.98</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.4.2.2.m1.1b"><apply id="S6.T1.4.2.2.m1.1.1.cmml" xref="S6.T1.4.2.2.m1.1.1"><csymbol cd="latexml" id="S6.T1.4.2.2.m1.1.1.1.cmml" xref="S6.T1.4.2.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.4.2.2.m1.1.1.2.cmml" xref="S6.T1.4.2.2.m1.1.1.2">40.91</cn><cn type="float" id="S6.T1.4.2.2.m1.1.1.3.cmml" xref="S6.T1.4.2.2.m1.1.1.3">1.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.4.2.2.m1.1c">40.91\pm 1.98</annotation></semantics></math></td>
<td id="S6.T1.5.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S6.T1.5.3.3.m1.1" class="ltx_Math" alttext="60.26\pm 3.77" display="inline"><semantics id="S6.T1.5.3.3.m1.1a"><mrow id="S6.T1.5.3.3.m1.1.1" xref="S6.T1.5.3.3.m1.1.1.cmml"><mn id="S6.T1.5.3.3.m1.1.1.2" xref="S6.T1.5.3.3.m1.1.1.2.cmml">60.26</mn><mo id="S6.T1.5.3.3.m1.1.1.1" xref="S6.T1.5.3.3.m1.1.1.1.cmml">±</mo><mn id="S6.T1.5.3.3.m1.1.1.3" xref="S6.T1.5.3.3.m1.1.1.3.cmml">3.77</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.5.3.3.m1.1b"><apply id="S6.T1.5.3.3.m1.1.1.cmml" xref="S6.T1.5.3.3.m1.1.1"><csymbol cd="latexml" id="S6.T1.5.3.3.m1.1.1.1.cmml" xref="S6.T1.5.3.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.5.3.3.m1.1.1.2.cmml" xref="S6.T1.5.3.3.m1.1.1.2">60.26</cn><cn type="float" id="S6.T1.5.3.3.m1.1.1.3.cmml" xref="S6.T1.5.3.3.m1.1.1.3">3.77</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.5.3.3.m1.1c">60.26\pm 3.77</annotation></semantics></math></td>
<td id="S6.T1.6.4.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S6.T1.6.4.4.m1.1" class="ltx_Math" alttext="79.16\pm 2.93" display="inline"><semantics id="S6.T1.6.4.4.m1.1a"><mrow id="S6.T1.6.4.4.m1.1.1" xref="S6.T1.6.4.4.m1.1.1.cmml"><mn id="S6.T1.6.4.4.m1.1.1.2" xref="S6.T1.6.4.4.m1.1.1.2.cmml">79.16</mn><mo id="S6.T1.6.4.4.m1.1.1.1" xref="S6.T1.6.4.4.m1.1.1.1.cmml">±</mo><mn id="S6.T1.6.4.4.m1.1.1.3" xref="S6.T1.6.4.4.m1.1.1.3.cmml">2.93</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.6.4.4.m1.1b"><apply id="S6.T1.6.4.4.m1.1.1.cmml" xref="S6.T1.6.4.4.m1.1.1"><csymbol cd="latexml" id="S6.T1.6.4.4.m1.1.1.1.cmml" xref="S6.T1.6.4.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.6.4.4.m1.1.1.2.cmml" xref="S6.T1.6.4.4.m1.1.1.2">79.16</cn><cn type="float" id="S6.T1.6.4.4.m1.1.1.3.cmml" xref="S6.T1.6.4.4.m1.1.1.3">2.93</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.6.4.4.m1.1c">79.16\pm 2.93</annotation></semantics></math></td>
</tr>
<tr id="S6.T1.10.8" class="ltx_tr">
<th id="S6.T1.10.8.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvg-FT</th>
<td id="S6.T1.7.5.1" class="ltx_td ltx_align_center"><math id="S6.T1.7.5.1.m1.1" class="ltx_Math" alttext="87.00\pm 2.40" display="inline"><semantics id="S6.T1.7.5.1.m1.1a"><mrow id="S6.T1.7.5.1.m1.1.1" xref="S6.T1.7.5.1.m1.1.1.cmml"><mn id="S6.T1.7.5.1.m1.1.1.2" xref="S6.T1.7.5.1.m1.1.1.2.cmml">87.00</mn><mo id="S6.T1.7.5.1.m1.1.1.1" xref="S6.T1.7.5.1.m1.1.1.1.cmml">±</mo><mn id="S6.T1.7.5.1.m1.1.1.3" xref="S6.T1.7.5.1.m1.1.1.3.cmml">2.40</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.7.5.1.m1.1b"><apply id="S6.T1.7.5.1.m1.1.1.cmml" xref="S6.T1.7.5.1.m1.1.1"><csymbol cd="latexml" id="S6.T1.7.5.1.m1.1.1.1.cmml" xref="S6.T1.7.5.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.7.5.1.m1.1.1.2.cmml" xref="S6.T1.7.5.1.m1.1.1.2">87.00</cn><cn type="float" id="S6.T1.7.5.1.m1.1.1.3.cmml" xref="S6.T1.7.5.1.m1.1.1.3">2.40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.7.5.1.m1.1c">87.00\pm 2.40</annotation></semantics></math></td>
<td id="S6.T1.8.6.2" class="ltx_td ltx_align_center"><math id="S6.T1.8.6.2.m1.1" class="ltx_Math" alttext="67.13\pm 1.48" display="inline"><semantics id="S6.T1.8.6.2.m1.1a"><mrow id="S6.T1.8.6.2.m1.1.1" xref="S6.T1.8.6.2.m1.1.1.cmml"><mn id="S6.T1.8.6.2.m1.1.1.2" xref="S6.T1.8.6.2.m1.1.1.2.cmml">67.13</mn><mo id="S6.T1.8.6.2.m1.1.1.1" xref="S6.T1.8.6.2.m1.1.1.1.cmml">±</mo><mn id="S6.T1.8.6.2.m1.1.1.3" xref="S6.T1.8.6.2.m1.1.1.3.cmml">1.48</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.8.6.2.m1.1b"><apply id="S6.T1.8.6.2.m1.1.1.cmml" xref="S6.T1.8.6.2.m1.1.1"><csymbol cd="latexml" id="S6.T1.8.6.2.m1.1.1.1.cmml" xref="S6.T1.8.6.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.8.6.2.m1.1.1.2.cmml" xref="S6.T1.8.6.2.m1.1.1.2">67.13</cn><cn type="float" id="S6.T1.8.6.2.m1.1.1.3.cmml" xref="S6.T1.8.6.2.m1.1.1.3">1.48</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.8.6.2.m1.1c">67.13\pm 1.48</annotation></semantics></math></td>
<td id="S6.T1.9.7.3" class="ltx_td ltx_align_center"><math id="S6.T1.9.7.3.m1.1" class="ltx_Math" alttext="87.08\pm 3.39" display="inline"><semantics id="S6.T1.9.7.3.m1.1a"><mrow id="S6.T1.9.7.3.m1.1.1" xref="S6.T1.9.7.3.m1.1.1.cmml"><mn id="S6.T1.9.7.3.m1.1.1.2" xref="S6.T1.9.7.3.m1.1.1.2.cmml">87.08</mn><mo id="S6.T1.9.7.3.m1.1.1.1" xref="S6.T1.9.7.3.m1.1.1.1.cmml">±</mo><mn id="S6.T1.9.7.3.m1.1.1.3" xref="S6.T1.9.7.3.m1.1.1.3.cmml">3.39</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.9.7.3.m1.1b"><apply id="S6.T1.9.7.3.m1.1.1.cmml" xref="S6.T1.9.7.3.m1.1.1"><csymbol cd="latexml" id="S6.T1.9.7.3.m1.1.1.1.cmml" xref="S6.T1.9.7.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.9.7.3.m1.1.1.2.cmml" xref="S6.T1.9.7.3.m1.1.1.2">87.08</cn><cn type="float" id="S6.T1.9.7.3.m1.1.1.3.cmml" xref="S6.T1.9.7.3.m1.1.1.3">3.39</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.9.7.3.m1.1c">87.08\pm 3.39</annotation></semantics></math></td>
<td id="S6.T1.10.8.4" class="ltx_td ltx_align_center"><math id="S6.T1.10.8.4.m1.1" class="ltx_Math" alttext="89.47\pm 1.43" display="inline"><semantics id="S6.T1.10.8.4.m1.1a"><mrow id="S6.T1.10.8.4.m1.1.1" xref="S6.T1.10.8.4.m1.1.1.cmml"><mn id="S6.T1.10.8.4.m1.1.1.2" xref="S6.T1.10.8.4.m1.1.1.2.cmml">89.47</mn><mo id="S6.T1.10.8.4.m1.1.1.1" xref="S6.T1.10.8.4.m1.1.1.1.cmml">±</mo><mn id="S6.T1.10.8.4.m1.1.1.3" xref="S6.T1.10.8.4.m1.1.1.3.cmml">1.43</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.10.8.4.m1.1b"><apply id="S6.T1.10.8.4.m1.1.1.cmml" xref="S6.T1.10.8.4.m1.1.1"><csymbol cd="latexml" id="S6.T1.10.8.4.m1.1.1.1.cmml" xref="S6.T1.10.8.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.10.8.4.m1.1.1.2.cmml" xref="S6.T1.10.8.4.m1.1.1.2">89.47</cn><cn type="float" id="S6.T1.10.8.4.m1.1.1.3.cmml" xref="S6.T1.10.8.4.m1.1.1.3">1.43</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.10.8.4.m1.1c">89.47\pm 1.43</annotation></semantics></math></td>
</tr>
<tr id="S6.T1.14.12" class="ltx_tr">
<th id="S6.T1.14.12.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">IFCA</th>
<td id="S6.T1.11.9.1" class="ltx_td ltx_align_center"><math id="S6.T1.11.9.1.m1.1" class="ltx_Math" alttext="29.01\pm 2.06" display="inline"><semantics id="S6.T1.11.9.1.m1.1a"><mrow id="S6.T1.11.9.1.m1.1.1" xref="S6.T1.11.9.1.m1.1.1.cmml"><mn id="S6.T1.11.9.1.m1.1.1.2" xref="S6.T1.11.9.1.m1.1.1.2.cmml">29.01</mn><mo id="S6.T1.11.9.1.m1.1.1.1" xref="S6.T1.11.9.1.m1.1.1.1.cmml">±</mo><mn id="S6.T1.11.9.1.m1.1.1.3" xref="S6.T1.11.9.1.m1.1.1.3.cmml">2.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.11.9.1.m1.1b"><apply id="S6.T1.11.9.1.m1.1.1.cmml" xref="S6.T1.11.9.1.m1.1.1"><csymbol cd="latexml" id="S6.T1.11.9.1.m1.1.1.1.cmml" xref="S6.T1.11.9.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.11.9.1.m1.1.1.2.cmml" xref="S6.T1.11.9.1.m1.1.1.2">29.01</cn><cn type="float" id="S6.T1.11.9.1.m1.1.1.3.cmml" xref="S6.T1.11.9.1.m1.1.1.3">2.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.11.9.1.m1.1c">29.01\pm 2.06</annotation></semantics></math></td>
<td id="S6.T1.12.10.2" class="ltx_td ltx_align_center"><math id="S6.T1.12.10.2.m1.1" class="ltx_Math" alttext="42.10\pm 3.00" display="inline"><semantics id="S6.T1.12.10.2.m1.1a"><mrow id="S6.T1.12.10.2.m1.1.1" xref="S6.T1.12.10.2.m1.1.1.cmml"><mn id="S6.T1.12.10.2.m1.1.1.2" xref="S6.T1.12.10.2.m1.1.1.2.cmml">42.10</mn><mo id="S6.T1.12.10.2.m1.1.1.1" xref="S6.T1.12.10.2.m1.1.1.1.cmml">±</mo><mn id="S6.T1.12.10.2.m1.1.1.3" xref="S6.T1.12.10.2.m1.1.1.3.cmml">3.00</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.12.10.2.m1.1b"><apply id="S6.T1.12.10.2.m1.1.1.cmml" xref="S6.T1.12.10.2.m1.1.1"><csymbol cd="latexml" id="S6.T1.12.10.2.m1.1.1.1.cmml" xref="S6.T1.12.10.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.12.10.2.m1.1.1.2.cmml" xref="S6.T1.12.10.2.m1.1.1.2">42.10</cn><cn type="float" id="S6.T1.12.10.2.m1.1.1.3.cmml" xref="S6.T1.12.10.2.m1.1.1.3">3.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.12.10.2.m1.1c">42.10\pm 3.00</annotation></semantics></math></td>
<td id="S6.T1.13.11.3" class="ltx_td ltx_align_center"><math id="S6.T1.13.11.3.m1.1" class="ltx_Math" alttext="65.13\pm 6.26" display="inline"><semantics id="S6.T1.13.11.3.m1.1a"><mrow id="S6.T1.13.11.3.m1.1.1" xref="S6.T1.13.11.3.m1.1.1.cmml"><mn id="S6.T1.13.11.3.m1.1.1.2" xref="S6.T1.13.11.3.m1.1.1.2.cmml">65.13</mn><mo id="S6.T1.13.11.3.m1.1.1.1" xref="S6.T1.13.11.3.m1.1.1.1.cmml">±</mo><mn id="S6.T1.13.11.3.m1.1.1.3" xref="S6.T1.13.11.3.m1.1.1.3.cmml">6.26</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.13.11.3.m1.1b"><apply id="S6.T1.13.11.3.m1.1.1.cmml" xref="S6.T1.13.11.3.m1.1.1"><csymbol cd="latexml" id="S6.T1.13.11.3.m1.1.1.1.cmml" xref="S6.T1.13.11.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.13.11.3.m1.1.1.2.cmml" xref="S6.T1.13.11.3.m1.1.1.2">65.13</cn><cn type="float" id="S6.T1.13.11.3.m1.1.1.3.cmml" xref="S6.T1.13.11.3.m1.1.1.3">6.26</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.13.11.3.m1.1c">65.13\pm 6.26</annotation></semantics></math></td>
<td id="S6.T1.14.12.4" class="ltx_td ltx_align_center"><math id="S6.T1.14.12.4.m1.1" class="ltx_Math" alttext="80.50\pm 1.69" display="inline"><semantics id="S6.T1.14.12.4.m1.1a"><mrow id="S6.T1.14.12.4.m1.1.1" xref="S6.T1.14.12.4.m1.1.1.cmml"><mn id="S6.T1.14.12.4.m1.1.1.2" xref="S6.T1.14.12.4.m1.1.1.2.cmml">80.50</mn><mo id="S6.T1.14.12.4.m1.1.1.1" xref="S6.T1.14.12.4.m1.1.1.1.cmml">±</mo><mn id="S6.T1.14.12.4.m1.1.1.3" xref="S6.T1.14.12.4.m1.1.1.3.cmml">1.69</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.14.12.4.m1.1b"><apply id="S6.T1.14.12.4.m1.1.1.cmml" xref="S6.T1.14.12.4.m1.1.1"><csymbol cd="latexml" id="S6.T1.14.12.4.m1.1.1.1.cmml" xref="S6.T1.14.12.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.14.12.4.m1.1.1.2.cmml" xref="S6.T1.14.12.4.m1.1.1.2">80.50</cn><cn type="float" id="S6.T1.14.12.4.m1.1.1.3.cmml" xref="S6.T1.14.12.4.m1.1.1.3">1.69</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.14.12.4.m1.1c">80.50\pm 1.69</annotation></semantics></math></td>
</tr>
<tr id="S6.T1.18.16" class="ltx_tr">
<th id="S6.T1.18.16.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">IFCA-FT</th>
<td id="S6.T1.15.13.1" class="ltx_td ltx_align_center"><math id="S6.T1.15.13.1.m1.1" class="ltx_Math" alttext="87.26\pm 2.50" display="inline"><semantics id="S6.T1.15.13.1.m1.1a"><mrow id="S6.T1.15.13.1.m1.1.1" xref="S6.T1.15.13.1.m1.1.1.cmml"><mn id="S6.T1.15.13.1.m1.1.1.2" xref="S6.T1.15.13.1.m1.1.1.2.cmml">87.26</mn><mo id="S6.T1.15.13.1.m1.1.1.1" xref="S6.T1.15.13.1.m1.1.1.1.cmml">±</mo><mn id="S6.T1.15.13.1.m1.1.1.3" xref="S6.T1.15.13.1.m1.1.1.3.cmml">2.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.15.13.1.m1.1b"><apply id="S6.T1.15.13.1.m1.1.1.cmml" xref="S6.T1.15.13.1.m1.1.1"><csymbol cd="latexml" id="S6.T1.15.13.1.m1.1.1.1.cmml" xref="S6.T1.15.13.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.15.13.1.m1.1.1.2.cmml" xref="S6.T1.15.13.1.m1.1.1.2">87.26</cn><cn type="float" id="S6.T1.15.13.1.m1.1.1.3.cmml" xref="S6.T1.15.13.1.m1.1.1.3">2.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.15.13.1.m1.1c">87.26\pm 2.50</annotation></semantics></math></td>
<td id="S6.T1.16.14.2" class="ltx_td ltx_align_center"><math id="S6.T1.16.14.2.m1.1" class="ltx_Math" alttext="64.96\pm 1.21" display="inline"><semantics id="S6.T1.16.14.2.m1.1a"><mrow id="S6.T1.16.14.2.m1.1.1" xref="S6.T1.16.14.2.m1.1.1.cmml"><mn id="S6.T1.16.14.2.m1.1.1.2" xref="S6.T1.16.14.2.m1.1.1.2.cmml">64.96</mn><mo id="S6.T1.16.14.2.m1.1.1.1" xref="S6.T1.16.14.2.m1.1.1.1.cmml">±</mo><mn id="S6.T1.16.14.2.m1.1.1.3" xref="S6.T1.16.14.2.m1.1.1.3.cmml">1.21</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.16.14.2.m1.1b"><apply id="S6.T1.16.14.2.m1.1.1.cmml" xref="S6.T1.16.14.2.m1.1.1"><csymbol cd="latexml" id="S6.T1.16.14.2.m1.1.1.1.cmml" xref="S6.T1.16.14.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.16.14.2.m1.1.1.2.cmml" xref="S6.T1.16.14.2.m1.1.1.2">64.96</cn><cn type="float" id="S6.T1.16.14.2.m1.1.1.3.cmml" xref="S6.T1.16.14.2.m1.1.1.3">1.21</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.16.14.2.m1.1c">64.96\pm 1.21</annotation></semantics></math></td>
<td id="S6.T1.17.15.3" class="ltx_td ltx_align_center"><math id="S6.T1.17.15.3.m1.1" class="ltx_Math" alttext="88.52\pm 3.32" display="inline"><semantics id="S6.T1.17.15.3.m1.1a"><mrow id="S6.T1.17.15.3.m1.1.1" xref="S6.T1.17.15.3.m1.1.1.cmml"><mn id="S6.T1.17.15.3.m1.1.1.2" xref="S6.T1.17.15.3.m1.1.1.2.cmml">88.52</mn><mo id="S6.T1.17.15.3.m1.1.1.1" xref="S6.T1.17.15.3.m1.1.1.1.cmml">±</mo><mn id="S6.T1.17.15.3.m1.1.1.3" xref="S6.T1.17.15.3.m1.1.1.3.cmml">3.32</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.17.15.3.m1.1b"><apply id="S6.T1.17.15.3.m1.1.1.cmml" xref="S6.T1.17.15.3.m1.1.1"><csymbol cd="latexml" id="S6.T1.17.15.3.m1.1.1.1.cmml" xref="S6.T1.17.15.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.17.15.3.m1.1.1.2.cmml" xref="S6.T1.17.15.3.m1.1.1.2">88.52</cn><cn type="float" id="S6.T1.17.15.3.m1.1.1.3.cmml" xref="S6.T1.17.15.3.m1.1.1.3">3.32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.17.15.3.m1.1c">88.52\pm 3.32</annotation></semantics></math></td>
<td id="S6.T1.18.16.4" class="ltx_td ltx_align_center"><math id="S6.T1.18.16.4.m1.1" class="ltx_Math" alttext="89.84\pm 1.21" display="inline"><semantics id="S6.T1.18.16.4.m1.1a"><mrow id="S6.T1.18.16.4.m1.1.1" xref="S6.T1.18.16.4.m1.1.1.cmml"><mn id="S6.T1.18.16.4.m1.1.1.2" xref="S6.T1.18.16.4.m1.1.1.2.cmml">89.84</mn><mo id="S6.T1.18.16.4.m1.1.1.1" xref="S6.T1.18.16.4.m1.1.1.1.cmml">±</mo><mn id="S6.T1.18.16.4.m1.1.1.3" xref="S6.T1.18.16.4.m1.1.1.3.cmml">1.21</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.18.16.4.m1.1b"><apply id="S6.T1.18.16.4.m1.1.1.cmml" xref="S6.T1.18.16.4.m1.1.1"><csymbol cd="latexml" id="S6.T1.18.16.4.m1.1.1.1.cmml" xref="S6.T1.18.16.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.18.16.4.m1.1.1.2.cmml" xref="S6.T1.18.16.4.m1.1.1.2">89.84</cn><cn type="float" id="S6.T1.18.16.4.m1.1.1.3.cmml" xref="S6.T1.18.16.4.m1.1.1.3">1.21</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.18.16.4.m1.1c">89.84\pm 1.21</annotation></semantics></math></td>
</tr>
<tr id="S6.T1.22.20" class="ltx_tr">
<th id="S6.T1.22.20.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Ditto</th>
<td id="S6.T1.19.17.1" class="ltx_td ltx_align_center"><math id="S6.T1.19.17.1.m1.1" class="ltx_Math" alttext="89.87\pm 1.02" display="inline"><semantics id="S6.T1.19.17.1.m1.1a"><mrow id="S6.T1.19.17.1.m1.1.1" xref="S6.T1.19.17.1.m1.1.1.cmml"><mn id="S6.T1.19.17.1.m1.1.1.2" xref="S6.T1.19.17.1.m1.1.1.2.cmml">89.87</mn><mo id="S6.T1.19.17.1.m1.1.1.1" xref="S6.T1.19.17.1.m1.1.1.1.cmml">±</mo><mn id="S6.T1.19.17.1.m1.1.1.3" xref="S6.T1.19.17.1.m1.1.1.3.cmml">1.02</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.19.17.1.m1.1b"><apply id="S6.T1.19.17.1.m1.1.1.cmml" xref="S6.T1.19.17.1.m1.1.1"><csymbol cd="latexml" id="S6.T1.19.17.1.m1.1.1.1.cmml" xref="S6.T1.19.17.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.19.17.1.m1.1.1.2.cmml" xref="S6.T1.19.17.1.m1.1.1.2">89.87</cn><cn type="float" id="S6.T1.19.17.1.m1.1.1.3.cmml" xref="S6.T1.19.17.1.m1.1.1.3">1.02</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.19.17.1.m1.1c">89.87\pm 1.02</annotation></semantics></math></td>
<td id="S6.T1.20.18.2" class="ltx_td ltx_align_center"><math id="S6.T1.20.18.2.m1.1" class="ltx_Math" alttext="70.71\pm 1.54" display="inline"><semantics id="S6.T1.20.18.2.m1.1a"><mrow id="S6.T1.20.18.2.m1.1.1" xref="S6.T1.20.18.2.m1.1.1.cmml"><mn id="S6.T1.20.18.2.m1.1.1.2" xref="S6.T1.20.18.2.m1.1.1.2.cmml">70.71</mn><mo id="S6.T1.20.18.2.m1.1.1.1" xref="S6.T1.20.18.2.m1.1.1.1.cmml">±</mo><mn id="S6.T1.20.18.2.m1.1.1.3" xref="S6.T1.20.18.2.m1.1.1.3.cmml">1.54</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.20.18.2.m1.1b"><apply id="S6.T1.20.18.2.m1.1.1.cmml" xref="S6.T1.20.18.2.m1.1.1"><csymbol cd="latexml" id="S6.T1.20.18.2.m1.1.1.1.cmml" xref="S6.T1.20.18.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.20.18.2.m1.1.1.2.cmml" xref="S6.T1.20.18.2.m1.1.1.2">70.71</cn><cn type="float" id="S6.T1.20.18.2.m1.1.1.3.cmml" xref="S6.T1.20.18.2.m1.1.1.3">1.54</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.20.18.2.m1.1c">70.71\pm 1.54</annotation></semantics></math></td>
<td id="S6.T1.21.19.3" class="ltx_td ltx_align_center"><math id="S6.T1.21.19.3.m1.1" class="ltx_Math" alttext="90.44\pm 1.44" display="inline"><semantics id="S6.T1.21.19.3.m1.1a"><mrow id="S6.T1.21.19.3.m1.1.1" xref="S6.T1.21.19.3.m1.1.1.cmml"><mn id="S6.T1.21.19.3.m1.1.1.2" xref="S6.T1.21.19.3.m1.1.1.2.cmml">90.44</mn><mo id="S6.T1.21.19.3.m1.1.1.1" xref="S6.T1.21.19.3.m1.1.1.1.cmml">±</mo><mn id="S6.T1.21.19.3.m1.1.1.3" xref="S6.T1.21.19.3.m1.1.1.3.cmml">1.44</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.21.19.3.m1.1b"><apply id="S6.T1.21.19.3.m1.1.1.cmml" xref="S6.T1.21.19.3.m1.1.1"><csymbol cd="latexml" id="S6.T1.21.19.3.m1.1.1.1.cmml" xref="S6.T1.21.19.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.21.19.3.m1.1.1.2.cmml" xref="S6.T1.21.19.3.m1.1.1.2">90.44</cn><cn type="float" id="S6.T1.21.19.3.m1.1.1.3.cmml" xref="S6.T1.21.19.3.m1.1.1.3">1.44</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.21.19.3.m1.1c">90.44\pm 1.44</annotation></semantics></math></td>
<td id="S6.T1.22.20.4" class="ltx_td ltx_align_center"><math id="S6.T1.22.20.4.m1.1" class="ltx_Math" alttext="89.27\pm 1.50" display="inline"><semantics id="S6.T1.22.20.4.m1.1a"><mrow id="S6.T1.22.20.4.m1.1.1" xref="S6.T1.22.20.4.m1.1.1.cmml"><mn id="S6.T1.22.20.4.m1.1.1.2" xref="S6.T1.22.20.4.m1.1.1.2.cmml">89.27</mn><mo id="S6.T1.22.20.4.m1.1.1.1" xref="S6.T1.22.20.4.m1.1.1.1.cmml">±</mo><mn id="S6.T1.22.20.4.m1.1.1.3" xref="S6.T1.22.20.4.m1.1.1.3.cmml">1.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.22.20.4.m1.1b"><apply id="S6.T1.22.20.4.m1.1.1.cmml" xref="S6.T1.22.20.4.m1.1.1"><csymbol cd="latexml" id="S6.T1.22.20.4.m1.1.1.1.cmml" xref="S6.T1.22.20.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.22.20.4.m1.1.1.2.cmml" xref="S6.T1.22.20.4.m1.1.1.2">89.27</cn><cn type="float" id="S6.T1.22.20.4.m1.1.1.3.cmml" xref="S6.T1.22.20.4.m1.1.1.3">1.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.22.20.4.m1.1c">89.27\pm 1.50</annotation></semantics></math></td>
</tr>
<tr id="S6.T1.26.24" class="ltx_tr">
<th id="S6.T1.26.24.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedRep</th>
<td id="S6.T1.23.21.1" class="ltx_td ltx_align_center"><math id="S6.T1.23.21.1.m1.1" class="ltx_Math" alttext="88.77\pm 1.43" display="inline"><semantics id="S6.T1.23.21.1.m1.1a"><mrow id="S6.T1.23.21.1.m1.1.1" xref="S6.T1.23.21.1.m1.1.1.cmml"><mn id="S6.T1.23.21.1.m1.1.1.2" xref="S6.T1.23.21.1.m1.1.1.2.cmml">88.77</mn><mo id="S6.T1.23.21.1.m1.1.1.1" xref="S6.T1.23.21.1.m1.1.1.1.cmml">±</mo><mn id="S6.T1.23.21.1.m1.1.1.3" xref="S6.T1.23.21.1.m1.1.1.3.cmml">1.43</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.23.21.1.m1.1b"><apply id="S6.T1.23.21.1.m1.1.1.cmml" xref="S6.T1.23.21.1.m1.1.1"><csymbol cd="latexml" id="S6.T1.23.21.1.m1.1.1.1.cmml" xref="S6.T1.23.21.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.23.21.1.m1.1.1.2.cmml" xref="S6.T1.23.21.1.m1.1.1.2">88.77</cn><cn type="float" id="S6.T1.23.21.1.m1.1.1.3.cmml" xref="S6.T1.23.21.1.m1.1.1.3">1.43</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.23.21.1.m1.1c">88.77\pm 1.43</annotation></semantics></math></td>
<td id="S6.T1.24.22.2" class="ltx_td ltx_align_center"><math id="S6.T1.24.22.2.m1.1" class="ltx_Math" alttext="68.44\pm 2.16" display="inline"><semantics id="S6.T1.24.22.2.m1.1a"><mrow id="S6.T1.24.22.2.m1.1.1" xref="S6.T1.24.22.2.m1.1.1.cmml"><mn id="S6.T1.24.22.2.m1.1.1.2" xref="S6.T1.24.22.2.m1.1.1.2.cmml">68.44</mn><mo id="S6.T1.24.22.2.m1.1.1.1" xref="S6.T1.24.22.2.m1.1.1.1.cmml">±</mo><mn id="S6.T1.24.22.2.m1.1.1.3" xref="S6.T1.24.22.2.m1.1.1.3.cmml">2.16</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.24.22.2.m1.1b"><apply id="S6.T1.24.22.2.m1.1.1.cmml" xref="S6.T1.24.22.2.m1.1.1"><csymbol cd="latexml" id="S6.T1.24.22.2.m1.1.1.1.cmml" xref="S6.T1.24.22.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.24.22.2.m1.1.1.2.cmml" xref="S6.T1.24.22.2.m1.1.1.2">68.44</cn><cn type="float" id="S6.T1.24.22.2.m1.1.1.3.cmml" xref="S6.T1.24.22.2.m1.1.1.3">2.16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.24.22.2.m1.1c">68.44\pm 2.16</annotation></semantics></math></td>
<td id="S6.T1.25.23.3" class="ltx_td ltx_align_center"><math id="S6.T1.25.23.3.m1.1" class="ltx_Math" alttext="90.95\pm 1.64" display="inline"><semantics id="S6.T1.25.23.3.m1.1a"><mrow id="S6.T1.25.23.3.m1.1.1" xref="S6.T1.25.23.3.m1.1.1.cmml"><mn id="S6.T1.25.23.3.m1.1.1.2" xref="S6.T1.25.23.3.m1.1.1.2.cmml">90.95</mn><mo id="S6.T1.25.23.3.m1.1.1.1" xref="S6.T1.25.23.3.m1.1.1.1.cmml">±</mo><mn id="S6.T1.25.23.3.m1.1.1.3" xref="S6.T1.25.23.3.m1.1.1.3.cmml">1.64</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.25.23.3.m1.1b"><apply id="S6.T1.25.23.3.m1.1.1.cmml" xref="S6.T1.25.23.3.m1.1.1"><csymbol cd="latexml" id="S6.T1.25.23.3.m1.1.1.1.cmml" xref="S6.T1.25.23.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.25.23.3.m1.1.1.2.cmml" xref="S6.T1.25.23.3.m1.1.1.2">90.95</cn><cn type="float" id="S6.T1.25.23.3.m1.1.1.3.cmml" xref="S6.T1.25.23.3.m1.1.1.3">1.64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.25.23.3.m1.1c">90.95\pm 1.64</annotation></semantics></math></td>
<td id="S6.T1.26.24.4" class="ltx_td ltx_align_center"><math id="S6.T1.26.24.4.m1.1" class="ltx_Math" alttext="89.88\pm 1.46" display="inline"><semantics id="S6.T1.26.24.4.m1.1a"><mrow id="S6.T1.26.24.4.m1.1.1" xref="S6.T1.26.24.4.m1.1.1.cmml"><mn id="S6.T1.26.24.4.m1.1.1.2" xref="S6.T1.26.24.4.m1.1.1.2.cmml">89.88</mn><mo id="S6.T1.26.24.4.m1.1.1.1" xref="S6.T1.26.24.4.m1.1.1.1.cmml">±</mo><mn id="S6.T1.26.24.4.m1.1.1.3" xref="S6.T1.26.24.4.m1.1.1.3.cmml">1.46</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.26.24.4.m1.1b"><apply id="S6.T1.26.24.4.m1.1.1.cmml" xref="S6.T1.26.24.4.m1.1.1"><csymbol cd="latexml" id="S6.T1.26.24.4.m1.1.1.1.cmml" xref="S6.T1.26.24.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.26.24.4.m1.1.1.2.cmml" xref="S6.T1.26.24.4.m1.1.1.2">89.88</cn><cn type="float" id="S6.T1.26.24.4.m1.1.1.3.cmml" xref="S6.T1.26.24.4.m1.1.1.3">1.46</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.26.24.4.m1.1c">89.88\pm 1.46</annotation></semantics></math></td>
</tr>
<tr id="S6.T1.30.28" class="ltx_tr">
<th id="S6.T1.30.28.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Per-FedAvg</th>
<td id="S6.T1.27.25.1" class="ltx_td ltx_align_center"><math id="S6.T1.27.25.1.m1.1" class="ltx_Math" alttext="88.41\pm 2.06" display="inline"><semantics id="S6.T1.27.25.1.m1.1a"><mrow id="S6.T1.27.25.1.m1.1.1" xref="S6.T1.27.25.1.m1.1.1.cmml"><mn id="S6.T1.27.25.1.m1.1.1.2" xref="S6.T1.27.25.1.m1.1.1.2.cmml">88.41</mn><mo id="S6.T1.27.25.1.m1.1.1.1" xref="S6.T1.27.25.1.m1.1.1.1.cmml">±</mo><mn id="S6.T1.27.25.1.m1.1.1.3" xref="S6.T1.27.25.1.m1.1.1.3.cmml">2.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.27.25.1.m1.1b"><apply id="S6.T1.27.25.1.m1.1.1.cmml" xref="S6.T1.27.25.1.m1.1.1"><csymbol cd="latexml" id="S6.T1.27.25.1.m1.1.1.1.cmml" xref="S6.T1.27.25.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.27.25.1.m1.1.1.2.cmml" xref="S6.T1.27.25.1.m1.1.1.2">88.41</cn><cn type="float" id="S6.T1.27.25.1.m1.1.1.3.cmml" xref="S6.T1.27.25.1.m1.1.1.3">2.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.27.25.1.m1.1c">88.41\pm 2.06</annotation></semantics></math></td>
<td id="S6.T1.28.26.2" class="ltx_td ltx_align_center"><math id="S6.T1.28.26.2.m1.1" class="ltx_Math" alttext="71.04\pm 1.91" display="inline"><semantics id="S6.T1.28.26.2.m1.1a"><mrow id="S6.T1.28.26.2.m1.1.1" xref="S6.T1.28.26.2.m1.1.1.cmml"><mn id="S6.T1.28.26.2.m1.1.1.2" xref="S6.T1.28.26.2.m1.1.1.2.cmml">71.04</mn><mo id="S6.T1.28.26.2.m1.1.1.1" xref="S6.T1.28.26.2.m1.1.1.1.cmml">±</mo><mn id="S6.T1.28.26.2.m1.1.1.3" xref="S6.T1.28.26.2.m1.1.1.3.cmml">1.91</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.28.26.2.m1.1b"><apply id="S6.T1.28.26.2.m1.1.1.cmml" xref="S6.T1.28.26.2.m1.1.1"><csymbol cd="latexml" id="S6.T1.28.26.2.m1.1.1.1.cmml" xref="S6.T1.28.26.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.28.26.2.m1.1.1.2.cmml" xref="S6.T1.28.26.2.m1.1.1.2">71.04</cn><cn type="float" id="S6.T1.28.26.2.m1.1.1.3.cmml" xref="S6.T1.28.26.2.m1.1.1.3">1.91</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.28.26.2.m1.1c">71.04\pm 1.91</annotation></semantics></math></td>
<td id="S6.T1.29.27.3" class="ltx_td ltx_align_center"><math id="S6.T1.29.27.3.m1.1" class="ltx_Math" alttext="83.86\pm 1.74" display="inline"><semantics id="S6.T1.29.27.3.m1.1a"><mrow id="S6.T1.29.27.3.m1.1.1" xref="S6.T1.29.27.3.m1.1.1.cmml"><mn id="S6.T1.29.27.3.m1.1.1.2" xref="S6.T1.29.27.3.m1.1.1.2.cmml">83.86</mn><mo id="S6.T1.29.27.3.m1.1.1.1" xref="S6.T1.29.27.3.m1.1.1.1.cmml">±</mo><mn id="S6.T1.29.27.3.m1.1.1.3" xref="S6.T1.29.27.3.m1.1.1.3.cmml">1.74</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.29.27.3.m1.1b"><apply id="S6.T1.29.27.3.m1.1.1.cmml" xref="S6.T1.29.27.3.m1.1.1"><csymbol cd="latexml" id="S6.T1.29.27.3.m1.1.1.1.cmml" xref="S6.T1.29.27.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.29.27.3.m1.1.1.2.cmml" xref="S6.T1.29.27.3.m1.1.1.2">83.86</cn><cn type="float" id="S6.T1.29.27.3.m1.1.1.3.cmml" xref="S6.T1.29.27.3.m1.1.1.3">1.74</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.29.27.3.m1.1c">83.86\pm 1.74</annotation></semantics></math></td>
<td id="S6.T1.30.28.4" class="ltx_td ltx_align_center"><math id="S6.T1.30.28.4.m1.1" class="ltx_Math" alttext="74.57\pm 3.12" display="inline"><semantics id="S6.T1.30.28.4.m1.1a"><mrow id="S6.T1.30.28.4.m1.1.1" xref="S6.T1.30.28.4.m1.1.1.cmml"><mn id="S6.T1.30.28.4.m1.1.1.2" xref="S6.T1.30.28.4.m1.1.1.2.cmml">74.57</mn><mo id="S6.T1.30.28.4.m1.1.1.1" xref="S6.T1.30.28.4.m1.1.1.1.cmml">±</mo><mn id="S6.T1.30.28.4.m1.1.1.3" xref="S6.T1.30.28.4.m1.1.1.3.cmml">3.12</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.30.28.4.m1.1b"><apply id="S6.T1.30.28.4.m1.1.1.cmml" xref="S6.T1.30.28.4.m1.1.1"><csymbol cd="latexml" id="S6.T1.30.28.4.m1.1.1.1.cmml" xref="S6.T1.30.28.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.30.28.4.m1.1.1.2.cmml" xref="S6.T1.30.28.4.m1.1.1.2">74.57</cn><cn type="float" id="S6.T1.30.28.4.m1.1.1.3.cmml" xref="S6.T1.30.28.4.m1.1.1.3">3.12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.30.28.4.m1.1c">74.57\pm 3.12</annotation></semantics></math></td>
</tr>
<tr id="S6.T1.34.32" class="ltx_tr">
<th id="S6.T1.34.32.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b"><span id="S6.T1.34.32.5.1" class="ltx_text ltx_font_bold">CAFeMe</span></th>
<td id="S6.T1.31.29.1" class="ltx_td ltx_align_center ltx_border_b"><math id="S6.T1.31.29.1.m1.1" class="ltx_Math" alttext="\mathbf{90.66\pm 0.66}" display="inline"><semantics id="S6.T1.31.29.1.m1.1a"><mrow id="S6.T1.31.29.1.m1.1.1" xref="S6.T1.31.29.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T1.31.29.1.m1.1.1.2" xref="S6.T1.31.29.1.m1.1.1.2.cmml">90.66</mn><mo id="S6.T1.31.29.1.m1.1.1.1" xref="S6.T1.31.29.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T1.31.29.1.m1.1.1.3" xref="S6.T1.31.29.1.m1.1.1.3.cmml">0.66</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.31.29.1.m1.1b"><apply id="S6.T1.31.29.1.m1.1.1.cmml" xref="S6.T1.31.29.1.m1.1.1"><csymbol cd="latexml" id="S6.T1.31.29.1.m1.1.1.1.cmml" xref="S6.T1.31.29.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.31.29.1.m1.1.1.2.cmml" xref="S6.T1.31.29.1.m1.1.1.2">90.66</cn><cn type="float" id="S6.T1.31.29.1.m1.1.1.3.cmml" xref="S6.T1.31.29.1.m1.1.1.3">0.66</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.31.29.1.m1.1c">\mathbf{90.66\pm 0.66}</annotation></semantics></math></td>
<td id="S6.T1.32.30.2" class="ltx_td ltx_align_center ltx_border_b"><math id="S6.T1.32.30.2.m1.1" class="ltx_Math" alttext="\mathbf{74.97\pm 1.67}" display="inline"><semantics id="S6.T1.32.30.2.m1.1a"><mrow id="S6.T1.32.30.2.m1.1.1" xref="S6.T1.32.30.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T1.32.30.2.m1.1.1.2" xref="S6.T1.32.30.2.m1.1.1.2.cmml">74.97</mn><mo id="S6.T1.32.30.2.m1.1.1.1" xref="S6.T1.32.30.2.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T1.32.30.2.m1.1.1.3" xref="S6.T1.32.30.2.m1.1.1.3.cmml">1.67</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.32.30.2.m1.1b"><apply id="S6.T1.32.30.2.m1.1.1.cmml" xref="S6.T1.32.30.2.m1.1.1"><csymbol cd="latexml" id="S6.T1.32.30.2.m1.1.1.1.cmml" xref="S6.T1.32.30.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.32.30.2.m1.1.1.2.cmml" xref="S6.T1.32.30.2.m1.1.1.2">74.97</cn><cn type="float" id="S6.T1.32.30.2.m1.1.1.3.cmml" xref="S6.T1.32.30.2.m1.1.1.3">1.67</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.32.30.2.m1.1c">\mathbf{74.97\pm 1.67}</annotation></semantics></math></td>
<td id="S6.T1.33.31.3" class="ltx_td ltx_align_center ltx_border_b"><math id="S6.T1.33.31.3.m1.1" class="ltx_Math" alttext="\mathbf{98.82\pm 0.11}" display="inline"><semantics id="S6.T1.33.31.3.m1.1a"><mrow id="S6.T1.33.31.3.m1.1.1" xref="S6.T1.33.31.3.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T1.33.31.3.m1.1.1.2" xref="S6.T1.33.31.3.m1.1.1.2.cmml">98.82</mn><mo id="S6.T1.33.31.3.m1.1.1.1" xref="S6.T1.33.31.3.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T1.33.31.3.m1.1.1.3" xref="S6.T1.33.31.3.m1.1.1.3.cmml">0.11</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.33.31.3.m1.1b"><apply id="S6.T1.33.31.3.m1.1.1.cmml" xref="S6.T1.33.31.3.m1.1.1"><csymbol cd="latexml" id="S6.T1.33.31.3.m1.1.1.1.cmml" xref="S6.T1.33.31.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.33.31.3.m1.1.1.2.cmml" xref="S6.T1.33.31.3.m1.1.1.2">98.82</cn><cn type="float" id="S6.T1.33.31.3.m1.1.1.3.cmml" xref="S6.T1.33.31.3.m1.1.1.3">0.11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.33.31.3.m1.1c">\mathbf{98.82\pm 0.11}</annotation></semantics></math></td>
<td id="S6.T1.34.32.4" class="ltx_td ltx_align_center ltx_border_b"><math id="S6.T1.34.32.4.m1.1" class="ltx_Math" alttext="\mathbf{94.31\pm 1.00}" display="inline"><semantics id="S6.T1.34.32.4.m1.1a"><mrow id="S6.T1.34.32.4.m1.1.1" xref="S6.T1.34.32.4.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T1.34.32.4.m1.1.1.2" xref="S6.T1.34.32.4.m1.1.1.2.cmml">94.31</mn><mo id="S6.T1.34.32.4.m1.1.1.1" xref="S6.T1.34.32.4.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T1.34.32.4.m1.1.1.3" xref="S6.T1.34.32.4.m1.1.1.3.cmml">1.00</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.34.32.4.m1.1b"><apply id="S6.T1.34.32.4.m1.1.1.cmml" xref="S6.T1.34.32.4.m1.1.1"><csymbol cd="latexml" id="S6.T1.34.32.4.m1.1.1.1.cmml" xref="S6.T1.34.32.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T1.34.32.4.m1.1.1.2.cmml" xref="S6.T1.34.32.4.m1.1.1.2">94.31</cn><cn type="float" id="S6.T1.34.32.4.m1.1.1.3.cmml" xref="S6.T1.34.32.4.m1.1.1.3">1.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.34.32.4.m1.1c">\mathbf{94.31\pm 1.00}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S6.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S6.T2.20.2.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S6.T2.2.1" class="ltx_text" style="font-size:90%;">Comparison of test accuracy (%) after <math id="S6.T2.2.1.m1.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S6.T2.2.1.m1.1b"><mn id="S6.T2.2.1.m1.1.1" xref="S6.T2.2.1.m1.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S6.T2.2.1.m1.1c"><cn type="integer" id="S6.T2.2.1.m1.1.1.cmml" xref="S6.T2.2.1.m1.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.2.1.m1.1d">50</annotation></semantics></math> personalization steps on new clients at test time on realistic datasets.</span></figcaption>
<table id="S6.T2.18" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T2.18.17.1" class="ltx_tr">
<th id="S6.T2.18.17.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S6.T2.18.17.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S6.T2.18.17.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S6.T2.18.17.1.2.1" class="ltx_text ltx_font_bold">FEMNIST</span></th>
<th id="S6.T2.18.17.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S6.T2.18.17.1.3.1" class="ltx_text ltx_font_bold">Meta-Dataset</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T2.4.2" class="ltx_tr">
<th id="S6.T2.4.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg</th>
<td id="S6.T2.3.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S6.T2.3.1.1.m1.1" class="ltx_Math" alttext="79.81\pm 2.21" display="inline"><semantics id="S6.T2.3.1.1.m1.1a"><mrow id="S6.T2.3.1.1.m1.1.1" xref="S6.T2.3.1.1.m1.1.1.cmml"><mn id="S6.T2.3.1.1.m1.1.1.2" xref="S6.T2.3.1.1.m1.1.1.2.cmml">79.81</mn><mo id="S6.T2.3.1.1.m1.1.1.1" xref="S6.T2.3.1.1.m1.1.1.1.cmml">±</mo><mn id="S6.T2.3.1.1.m1.1.1.3" xref="S6.T2.3.1.1.m1.1.1.3.cmml">2.21</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.3.1.1.m1.1b"><apply id="S6.T2.3.1.1.m1.1.1.cmml" xref="S6.T2.3.1.1.m1.1.1"><csymbol cd="latexml" id="S6.T2.3.1.1.m1.1.1.1.cmml" xref="S6.T2.3.1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.3.1.1.m1.1.1.2.cmml" xref="S6.T2.3.1.1.m1.1.1.2">79.81</cn><cn type="float" id="S6.T2.3.1.1.m1.1.1.3.cmml" xref="S6.T2.3.1.1.m1.1.1.3">2.21</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.3.1.1.m1.1c">79.81\pm 2.21</annotation></semantics></math></td>
<td id="S6.T2.4.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S6.T2.4.2.2.m1.1" class="ltx_Math" alttext="10.58\pm 0.75" display="inline"><semantics id="S6.T2.4.2.2.m1.1a"><mrow id="S6.T2.4.2.2.m1.1.1" xref="S6.T2.4.2.2.m1.1.1.cmml"><mn id="S6.T2.4.2.2.m1.1.1.2" xref="S6.T2.4.2.2.m1.1.1.2.cmml">10.58</mn><mo id="S6.T2.4.2.2.m1.1.1.1" xref="S6.T2.4.2.2.m1.1.1.1.cmml">±</mo><mn id="S6.T2.4.2.2.m1.1.1.3" xref="S6.T2.4.2.2.m1.1.1.3.cmml">0.75</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.4.2.2.m1.1b"><apply id="S6.T2.4.2.2.m1.1.1.cmml" xref="S6.T2.4.2.2.m1.1.1"><csymbol cd="latexml" id="S6.T2.4.2.2.m1.1.1.1.cmml" xref="S6.T2.4.2.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.4.2.2.m1.1.1.2.cmml" xref="S6.T2.4.2.2.m1.1.1.2">10.58</cn><cn type="float" id="S6.T2.4.2.2.m1.1.1.3.cmml" xref="S6.T2.4.2.2.m1.1.1.3">0.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.4.2.2.m1.1c">10.58\pm 0.75</annotation></semantics></math></td>
</tr>
<tr id="S6.T2.6.4" class="ltx_tr">
<th id="S6.T2.6.4.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvg-FT</th>
<td id="S6.T2.5.3.1" class="ltx_td ltx_align_center"><math id="S6.T2.5.3.1.m1.1" class="ltx_Math" alttext="82.07\pm 1.92" display="inline"><semantics id="S6.T2.5.3.1.m1.1a"><mrow id="S6.T2.5.3.1.m1.1.1" xref="S6.T2.5.3.1.m1.1.1.cmml"><mn id="S6.T2.5.3.1.m1.1.1.2" xref="S6.T2.5.3.1.m1.1.1.2.cmml">82.07</mn><mo id="S6.T2.5.3.1.m1.1.1.1" xref="S6.T2.5.3.1.m1.1.1.1.cmml">±</mo><mn id="S6.T2.5.3.1.m1.1.1.3" xref="S6.T2.5.3.1.m1.1.1.3.cmml">1.92</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.5.3.1.m1.1b"><apply id="S6.T2.5.3.1.m1.1.1.cmml" xref="S6.T2.5.3.1.m1.1.1"><csymbol cd="latexml" id="S6.T2.5.3.1.m1.1.1.1.cmml" xref="S6.T2.5.3.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.5.3.1.m1.1.1.2.cmml" xref="S6.T2.5.3.1.m1.1.1.2">82.07</cn><cn type="float" id="S6.T2.5.3.1.m1.1.1.3.cmml" xref="S6.T2.5.3.1.m1.1.1.3">1.92</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.5.3.1.m1.1c">82.07\pm 1.92</annotation></semantics></math></td>
<td id="S6.T2.6.4.2" class="ltx_td ltx_align_center"><math id="S6.T2.6.4.2.m1.1" class="ltx_Math" alttext="57.78\pm 1.16" display="inline"><semantics id="S6.T2.6.4.2.m1.1a"><mrow id="S6.T2.6.4.2.m1.1.1" xref="S6.T2.6.4.2.m1.1.1.cmml"><mn id="S6.T2.6.4.2.m1.1.1.2" xref="S6.T2.6.4.2.m1.1.1.2.cmml">57.78</mn><mo id="S6.T2.6.4.2.m1.1.1.1" xref="S6.T2.6.4.2.m1.1.1.1.cmml">±</mo><mn id="S6.T2.6.4.2.m1.1.1.3" xref="S6.T2.6.4.2.m1.1.1.3.cmml">1.16</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.6.4.2.m1.1b"><apply id="S6.T2.6.4.2.m1.1.1.cmml" xref="S6.T2.6.4.2.m1.1.1"><csymbol cd="latexml" id="S6.T2.6.4.2.m1.1.1.1.cmml" xref="S6.T2.6.4.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.6.4.2.m1.1.1.2.cmml" xref="S6.T2.6.4.2.m1.1.1.2">57.78</cn><cn type="float" id="S6.T2.6.4.2.m1.1.1.3.cmml" xref="S6.T2.6.4.2.m1.1.1.3">1.16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.6.4.2.m1.1c">57.78\pm 1.16</annotation></semantics></math></td>
</tr>
<tr id="S6.T2.8.6" class="ltx_tr">
<th id="S6.T2.8.6.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">IFCA</th>
<td id="S6.T2.7.5.1" class="ltx_td ltx_align_center"><math id="S6.T2.7.5.1.m1.1" class="ltx_Math" alttext="79.81\pm 2.04" display="inline"><semantics id="S6.T2.7.5.1.m1.1a"><mrow id="S6.T2.7.5.1.m1.1.1" xref="S6.T2.7.5.1.m1.1.1.cmml"><mn id="S6.T2.7.5.1.m1.1.1.2" xref="S6.T2.7.5.1.m1.1.1.2.cmml">79.81</mn><mo id="S6.T2.7.5.1.m1.1.1.1" xref="S6.T2.7.5.1.m1.1.1.1.cmml">±</mo><mn id="S6.T2.7.5.1.m1.1.1.3" xref="S6.T2.7.5.1.m1.1.1.3.cmml">2.04</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.7.5.1.m1.1b"><apply id="S6.T2.7.5.1.m1.1.1.cmml" xref="S6.T2.7.5.1.m1.1.1"><csymbol cd="latexml" id="S6.T2.7.5.1.m1.1.1.1.cmml" xref="S6.T2.7.5.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.7.5.1.m1.1.1.2.cmml" xref="S6.T2.7.5.1.m1.1.1.2">79.81</cn><cn type="float" id="S6.T2.7.5.1.m1.1.1.3.cmml" xref="S6.T2.7.5.1.m1.1.1.3">2.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.7.5.1.m1.1c">79.81\pm 2.04</annotation></semantics></math></td>
<td id="S6.T2.8.6.2" class="ltx_td ltx_align_center"><math id="S6.T2.8.6.2.m1.1" class="ltx_Math" alttext="9.74\pm 0.73" display="inline"><semantics id="S6.T2.8.6.2.m1.1a"><mrow id="S6.T2.8.6.2.m1.1.1" xref="S6.T2.8.6.2.m1.1.1.cmml"><mn id="S6.T2.8.6.2.m1.1.1.2" xref="S6.T2.8.6.2.m1.1.1.2.cmml">9.74</mn><mo id="S6.T2.8.6.2.m1.1.1.1" xref="S6.T2.8.6.2.m1.1.1.1.cmml">±</mo><mn id="S6.T2.8.6.2.m1.1.1.3" xref="S6.T2.8.6.2.m1.1.1.3.cmml">0.73</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.8.6.2.m1.1b"><apply id="S6.T2.8.6.2.m1.1.1.cmml" xref="S6.T2.8.6.2.m1.1.1"><csymbol cd="latexml" id="S6.T2.8.6.2.m1.1.1.1.cmml" xref="S6.T2.8.6.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.8.6.2.m1.1.1.2.cmml" xref="S6.T2.8.6.2.m1.1.1.2">9.74</cn><cn type="float" id="S6.T2.8.6.2.m1.1.1.3.cmml" xref="S6.T2.8.6.2.m1.1.1.3">0.73</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.8.6.2.m1.1c">9.74\pm 0.73</annotation></semantics></math></td>
</tr>
<tr id="S6.T2.10.8" class="ltx_tr">
<th id="S6.T2.10.8.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">IFCA-FT</th>
<td id="S6.T2.9.7.1" class="ltx_td ltx_align_center"><math id="S6.T2.9.7.1.m1.1" class="ltx_Math" alttext="82.56\pm 1.79" display="inline"><semantics id="S6.T2.9.7.1.m1.1a"><mrow id="S6.T2.9.7.1.m1.1.1" xref="S6.T2.9.7.1.m1.1.1.cmml"><mn id="S6.T2.9.7.1.m1.1.1.2" xref="S6.T2.9.7.1.m1.1.1.2.cmml">82.56</mn><mo id="S6.T2.9.7.1.m1.1.1.1" xref="S6.T2.9.7.1.m1.1.1.1.cmml">±</mo><mn id="S6.T2.9.7.1.m1.1.1.3" xref="S6.T2.9.7.1.m1.1.1.3.cmml">1.79</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.9.7.1.m1.1b"><apply id="S6.T2.9.7.1.m1.1.1.cmml" xref="S6.T2.9.7.1.m1.1.1"><csymbol cd="latexml" id="S6.T2.9.7.1.m1.1.1.1.cmml" xref="S6.T2.9.7.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.9.7.1.m1.1.1.2.cmml" xref="S6.T2.9.7.1.m1.1.1.2">82.56</cn><cn type="float" id="S6.T2.9.7.1.m1.1.1.3.cmml" xref="S6.T2.9.7.1.m1.1.1.3">1.79</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.9.7.1.m1.1c">82.56\pm 1.79</annotation></semantics></math></td>
<td id="S6.T2.10.8.2" class="ltx_td ltx_align_center"><math id="S6.T2.10.8.2.m1.1" class="ltx_Math" alttext="57.17\pm 1.44" display="inline"><semantics id="S6.T2.10.8.2.m1.1a"><mrow id="S6.T2.10.8.2.m1.1.1" xref="S6.T2.10.8.2.m1.1.1.cmml"><mn id="S6.T2.10.8.2.m1.1.1.2" xref="S6.T2.10.8.2.m1.1.1.2.cmml">57.17</mn><mo id="S6.T2.10.8.2.m1.1.1.1" xref="S6.T2.10.8.2.m1.1.1.1.cmml">±</mo><mn id="S6.T2.10.8.2.m1.1.1.3" xref="S6.T2.10.8.2.m1.1.1.3.cmml">1.44</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.10.8.2.m1.1b"><apply id="S6.T2.10.8.2.m1.1.1.cmml" xref="S6.T2.10.8.2.m1.1.1"><csymbol cd="latexml" id="S6.T2.10.8.2.m1.1.1.1.cmml" xref="S6.T2.10.8.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.10.8.2.m1.1.1.2.cmml" xref="S6.T2.10.8.2.m1.1.1.2">57.17</cn><cn type="float" id="S6.T2.10.8.2.m1.1.1.3.cmml" xref="S6.T2.10.8.2.m1.1.1.3">1.44</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.10.8.2.m1.1c">57.17\pm 1.44</annotation></semantics></math></td>
</tr>
<tr id="S6.T2.12.10" class="ltx_tr">
<th id="S6.T2.12.10.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">Ditto</th>
<td id="S6.T2.11.9.1" class="ltx_td ltx_align_center"><math id="S6.T2.11.9.1.m1.1" class="ltx_Math" alttext="80.41\pm 1.29" display="inline"><semantics id="S6.T2.11.9.1.m1.1a"><mrow id="S6.T2.11.9.1.m1.1.1" xref="S6.T2.11.9.1.m1.1.1.cmml"><mn id="S6.T2.11.9.1.m1.1.1.2" xref="S6.T2.11.9.1.m1.1.1.2.cmml">80.41</mn><mo id="S6.T2.11.9.1.m1.1.1.1" xref="S6.T2.11.9.1.m1.1.1.1.cmml">±</mo><mn id="S6.T2.11.9.1.m1.1.1.3" xref="S6.T2.11.9.1.m1.1.1.3.cmml">1.29</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.11.9.1.m1.1b"><apply id="S6.T2.11.9.1.m1.1.1.cmml" xref="S6.T2.11.9.1.m1.1.1"><csymbol cd="latexml" id="S6.T2.11.9.1.m1.1.1.1.cmml" xref="S6.T2.11.9.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.11.9.1.m1.1.1.2.cmml" xref="S6.T2.11.9.1.m1.1.1.2">80.41</cn><cn type="float" id="S6.T2.11.9.1.m1.1.1.3.cmml" xref="S6.T2.11.9.1.m1.1.1.3">1.29</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.11.9.1.m1.1c">80.41\pm 1.29</annotation></semantics></math></td>
<td id="S6.T2.12.10.2" class="ltx_td ltx_align_center"><math id="S6.T2.12.10.2.m1.1" class="ltx_Math" alttext="45.31\pm 1.44" display="inline"><semantics id="S6.T2.12.10.2.m1.1a"><mrow id="S6.T2.12.10.2.m1.1.1" xref="S6.T2.12.10.2.m1.1.1.cmml"><mn id="S6.T2.12.10.2.m1.1.1.2" xref="S6.T2.12.10.2.m1.1.1.2.cmml">45.31</mn><mo id="S6.T2.12.10.2.m1.1.1.1" xref="S6.T2.12.10.2.m1.1.1.1.cmml">±</mo><mn id="S6.T2.12.10.2.m1.1.1.3" xref="S6.T2.12.10.2.m1.1.1.3.cmml">1.44</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.12.10.2.m1.1b"><apply id="S6.T2.12.10.2.m1.1.1.cmml" xref="S6.T2.12.10.2.m1.1.1"><csymbol cd="latexml" id="S6.T2.12.10.2.m1.1.1.1.cmml" xref="S6.T2.12.10.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.12.10.2.m1.1.1.2.cmml" xref="S6.T2.12.10.2.m1.1.1.2">45.31</cn><cn type="float" id="S6.T2.12.10.2.m1.1.1.3.cmml" xref="S6.T2.12.10.2.m1.1.1.3">1.44</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.12.10.2.m1.1c">45.31\pm 1.44</annotation></semantics></math></td>
</tr>
<tr id="S6.T2.14.12" class="ltx_tr">
<th id="S6.T2.14.12.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedRep</th>
<td id="S6.T2.13.11.1" class="ltx_td ltx_align_center"><math id="S6.T2.13.11.1.m1.1" class="ltx_Math" alttext="78.10\pm 1.81" display="inline"><semantics id="S6.T2.13.11.1.m1.1a"><mrow id="S6.T2.13.11.1.m1.1.1" xref="S6.T2.13.11.1.m1.1.1.cmml"><mn id="S6.T2.13.11.1.m1.1.1.2" xref="S6.T2.13.11.1.m1.1.1.2.cmml">78.10</mn><mo id="S6.T2.13.11.1.m1.1.1.1" xref="S6.T2.13.11.1.m1.1.1.1.cmml">±</mo><mn id="S6.T2.13.11.1.m1.1.1.3" xref="S6.T2.13.11.1.m1.1.1.3.cmml">1.81</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.13.11.1.m1.1b"><apply id="S6.T2.13.11.1.m1.1.1.cmml" xref="S6.T2.13.11.1.m1.1.1"><csymbol cd="latexml" id="S6.T2.13.11.1.m1.1.1.1.cmml" xref="S6.T2.13.11.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.13.11.1.m1.1.1.2.cmml" xref="S6.T2.13.11.1.m1.1.1.2">78.10</cn><cn type="float" id="S6.T2.13.11.1.m1.1.1.3.cmml" xref="S6.T2.13.11.1.m1.1.1.3">1.81</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.13.11.1.m1.1c">78.10\pm 1.81</annotation></semantics></math></td>
<td id="S6.T2.14.12.2" class="ltx_td ltx_align_center"><math id="S6.T2.14.12.2.m1.1" class="ltx_Math" alttext="45.17\pm 1.90" display="inline"><semantics id="S6.T2.14.12.2.m1.1a"><mrow id="S6.T2.14.12.2.m1.1.1" xref="S6.T2.14.12.2.m1.1.1.cmml"><mn id="S6.T2.14.12.2.m1.1.1.2" xref="S6.T2.14.12.2.m1.1.1.2.cmml">45.17</mn><mo id="S6.T2.14.12.2.m1.1.1.1" xref="S6.T2.14.12.2.m1.1.1.1.cmml">±</mo><mn id="S6.T2.14.12.2.m1.1.1.3" xref="S6.T2.14.12.2.m1.1.1.3.cmml">1.90</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.14.12.2.m1.1b"><apply id="S6.T2.14.12.2.m1.1.1.cmml" xref="S6.T2.14.12.2.m1.1.1"><csymbol cd="latexml" id="S6.T2.14.12.2.m1.1.1.1.cmml" xref="S6.T2.14.12.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.14.12.2.m1.1.1.2.cmml" xref="S6.T2.14.12.2.m1.1.1.2">45.17</cn><cn type="float" id="S6.T2.14.12.2.m1.1.1.3.cmml" xref="S6.T2.14.12.2.m1.1.1.3">1.90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.14.12.2.m1.1c">45.17\pm 1.90</annotation></semantics></math></td>
</tr>
<tr id="S6.T2.16.14" class="ltx_tr">
<th id="S6.T2.16.14.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">Per-FedAvg</th>
<td id="S6.T2.15.13.1" class="ltx_td ltx_align_center"><math id="S6.T2.15.13.1.m1.1" class="ltx_Math" alttext="80.26\pm 2.60" display="inline"><semantics id="S6.T2.15.13.1.m1.1a"><mrow id="S6.T2.15.13.1.m1.1.1" xref="S6.T2.15.13.1.m1.1.1.cmml"><mn id="S6.T2.15.13.1.m1.1.1.2" xref="S6.T2.15.13.1.m1.1.1.2.cmml">80.26</mn><mo id="S6.T2.15.13.1.m1.1.1.1" xref="S6.T2.15.13.1.m1.1.1.1.cmml">±</mo><mn id="S6.T2.15.13.1.m1.1.1.3" xref="S6.T2.15.13.1.m1.1.1.3.cmml">2.60</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.15.13.1.m1.1b"><apply id="S6.T2.15.13.1.m1.1.1.cmml" xref="S6.T2.15.13.1.m1.1.1"><csymbol cd="latexml" id="S6.T2.15.13.1.m1.1.1.1.cmml" xref="S6.T2.15.13.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.15.13.1.m1.1.1.2.cmml" xref="S6.T2.15.13.1.m1.1.1.2">80.26</cn><cn type="float" id="S6.T2.15.13.1.m1.1.1.3.cmml" xref="S6.T2.15.13.1.m1.1.1.3">2.60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.15.13.1.m1.1c">80.26\pm 2.60</annotation></semantics></math></td>
<td id="S6.T2.16.14.2" class="ltx_td ltx_align_center"><math id="S6.T2.16.14.2.m1.1" class="ltx_Math" alttext="57.89\pm 1.09" display="inline"><semantics id="S6.T2.16.14.2.m1.1a"><mrow id="S6.T2.16.14.2.m1.1.1" xref="S6.T2.16.14.2.m1.1.1.cmml"><mn id="S6.T2.16.14.2.m1.1.1.2" xref="S6.T2.16.14.2.m1.1.1.2.cmml">57.89</mn><mo id="S6.T2.16.14.2.m1.1.1.1" xref="S6.T2.16.14.2.m1.1.1.1.cmml">±</mo><mn id="S6.T2.16.14.2.m1.1.1.3" xref="S6.T2.16.14.2.m1.1.1.3.cmml">1.09</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.16.14.2.m1.1b"><apply id="S6.T2.16.14.2.m1.1.1.cmml" xref="S6.T2.16.14.2.m1.1.1"><csymbol cd="latexml" id="S6.T2.16.14.2.m1.1.1.1.cmml" xref="S6.T2.16.14.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.16.14.2.m1.1.1.2.cmml" xref="S6.T2.16.14.2.m1.1.1.2">57.89</cn><cn type="float" id="S6.T2.16.14.2.m1.1.1.3.cmml" xref="S6.T2.16.14.2.m1.1.1.3">1.09</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.16.14.2.m1.1c">57.89\pm 1.09</annotation></semantics></math></td>
</tr>
<tr id="S6.T2.18.16" class="ltx_tr">
<th id="S6.T2.18.16.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b"><span id="S6.T2.18.16.3.1" class="ltx_text ltx_font_bold">CAFeMe</span></th>
<td id="S6.T2.17.15.1" class="ltx_td ltx_align_center ltx_border_b"><math id="S6.T2.17.15.1.m1.1" class="ltx_Math" alttext="\mathbf{82.76\pm 0.83}" display="inline"><semantics id="S6.T2.17.15.1.m1.1a"><mrow id="S6.T2.17.15.1.m1.1.1" xref="S6.T2.17.15.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T2.17.15.1.m1.1.1.2" xref="S6.T2.17.15.1.m1.1.1.2.cmml">82.76</mn><mo id="S6.T2.17.15.1.m1.1.1.1" xref="S6.T2.17.15.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T2.17.15.1.m1.1.1.3" xref="S6.T2.17.15.1.m1.1.1.3.cmml">0.83</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.17.15.1.m1.1b"><apply id="S6.T2.17.15.1.m1.1.1.cmml" xref="S6.T2.17.15.1.m1.1.1"><csymbol cd="latexml" id="S6.T2.17.15.1.m1.1.1.1.cmml" xref="S6.T2.17.15.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.17.15.1.m1.1.1.2.cmml" xref="S6.T2.17.15.1.m1.1.1.2">82.76</cn><cn type="float" id="S6.T2.17.15.1.m1.1.1.3.cmml" xref="S6.T2.17.15.1.m1.1.1.3">0.83</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.17.15.1.m1.1c">\mathbf{82.76\pm 0.83}</annotation></semantics></math></td>
<td id="S6.T2.18.16.2" class="ltx_td ltx_align_center ltx_border_b"><math id="S6.T2.18.16.2.m1.1" class="ltx_Math" alttext="\mathbf{62.62\pm 1.33}" display="inline"><semantics id="S6.T2.18.16.2.m1.1a"><mrow id="S6.T2.18.16.2.m1.1.1" xref="S6.T2.18.16.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T2.18.16.2.m1.1.1.2" xref="S6.T2.18.16.2.m1.1.1.2.cmml">62.62</mn><mo id="S6.T2.18.16.2.m1.1.1.1" xref="S6.T2.18.16.2.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S6.T2.18.16.2.m1.1.1.3" xref="S6.T2.18.16.2.m1.1.1.3.cmml">1.33</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.T2.18.16.2.m1.1b"><apply id="S6.T2.18.16.2.m1.1.1.cmml" xref="S6.T2.18.16.2.m1.1.1"><csymbol cd="latexml" id="S6.T2.18.16.2.m1.1.1.1.cmml" xref="S6.T2.18.16.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S6.T2.18.16.2.m1.1.1.2.cmml" xref="S6.T2.18.16.2.m1.1.1.2">62.62</cn><cn type="float" id="S6.T2.18.16.2.m1.1.1.3.cmml" xref="S6.T2.18.16.2.m1.1.1.3">1.33</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T2.18.16.2.m1.1c">\mathbf{62.62\pm 1.33}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">The experimental results are summarized in Tables <a href="#S6.T1" title="Table 1 ‣ 6 Results ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S6.T2" title="Table 2 ‣ 6 Results ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> for the synthetic and realistic datasets, respectively. Across all datasets, <em id="S6.p1.1.1" class="ltx_emph ltx_font_italic">CAFeMe</em> consistently outperforms the other baseline methods. The performance gap becomes even more evident when the heterogeneity in clients’ data distribution is large (as observed in RMNIST and Meta-Dataset), highlighting the effectiveness of the proposed approach in personalizing to each client’s local data distribution.
This observation is supported by the results presented in Figure <a href="#S6.F3" title="Figure 3 ‣ 6 Results ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, which illustrates the performance of different PFL methods under varying levels of data heterogeneity in the RMNIST dataset.</p>
</div>
<figure id="S6.F3" class="ltx_figure"><img src="/html/2312.15191/assets/images/data_heterogenity.png" id="S6.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="326" height="163" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F3.5.2.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S6.F3.2.1" class="ltx_text" style="font-size:90%;">Performance comparison on RMNIST dataset varying data heterogeneity. “None” indicates that no partition schemes have been applied on the dataset, while “Dir” stands for <em id="S6.F3.2.1.1" class="ltx_emph ltx_font_italic">dirichlet</em> partition scheme with <math id="S6.F3.2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.F3.2.1.m1.1b"><mi id="S6.F3.2.1.m1.1.1" xref="S6.F3.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.F3.2.1.m1.1c"><ci id="S6.F3.2.1.m1.1.1.cmml" xref="S6.F3.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F3.2.1.m1.1d">\alpha</annotation></semantics></math> the concentration parameter of the Dirichlet distribution.</span></figcaption>
</figure>
<figure id="S6.F4" class="ltx_figure"><img src="/html/2312.15191/assets/images/avgacc2.png" id="S6.F4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="306" height="303" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S6.F4.3.2" class="ltx_text" style="font-size:90%;">Personalization to new clients at test time varying the number of personalization steps.</span></figcaption>
</figure>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.3" class="ltx_p">When the data are (almost) balanced and i.i.d, as indicated by the “None” column in the histogram and when <math id="S6.p2.1.m1.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="S6.p2.1.m1.1a"><mrow id="S6.p2.1.m1.1.1" xref="S6.p2.1.m1.1.1.cmml"><mi id="S6.p2.1.m1.1.1.2" xref="S6.p2.1.m1.1.1.2.cmml">α</mi><mo id="S6.p2.1.m1.1.1.1" xref="S6.p2.1.m1.1.1.1.cmml">=</mo><mn id="S6.p2.1.m1.1.1.3" xref="S6.p2.1.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.1b"><apply id="S6.p2.1.m1.1.1.cmml" xref="S6.p2.1.m1.1.1"><eq id="S6.p2.1.m1.1.1.1.cmml" xref="S6.p2.1.m1.1.1.1"></eq><ci id="S6.p2.1.m1.1.1.2.cmml" xref="S6.p2.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S6.p2.1.m1.1.1.3.cmml" xref="S6.p2.1.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.1c">\alpha=1000</annotation></semantics></math>, the performance of <em id="S6.p2.3.1" class="ltx_emph ltx_font_italic">CAFeMe</em> is comparable to other baselines, such as Ditto and FedRep. However, as the data heterogeneity across clients increases (lower <math id="S6.p2.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.p2.2.m2.1a"><mi id="S6.p2.2.m2.1.1" xref="S6.p2.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.p2.2.m2.1b"><ci id="S6.p2.2.m2.1.1.cmml" xref="S6.p2.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.2.m2.1c">\alpha</annotation></semantics></math> values), <em id="S6.p2.3.2" class="ltx_emph ltx_font_italic">CAFeMe</em> consistently maintains strong performance, while the performance of the other baselines significantly deteriorates. This is particularly evident when using the <em id="S6.p2.3.3" class="ltx_emph ltx_font_italic">shards</em> partition scheme, where most of the clients have data from only two classes. In this challenging scenario, personalizing the global model to each local dataset becomes difficult due to the narrow local data distribution compared to the one used for learning the global model. Nevertheless, <em id="S6.p2.3.4" class="ltx_emph ltx_font_italic">CAFeMe</em> overcomes this challenge by effectively modulating the global model through meta-learning, resulting in robust personalization even in the presence of concept shifts. This observation is further supported by the results on Meta-Dataset (Table <a href="#S6.T2" title="Table 2 ‣ 6 Results ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). The variability in the conditional distribution <math id="S6.p2.3.m3.1" class="ltx_Math" alttext="P_{\mathcal{Y}|\mathcal{X}}" display="inline"><semantics id="S6.p2.3.m3.1a"><msub id="S6.p2.3.m3.1.1" xref="S6.p2.3.m3.1.1.cmml"><mi id="S6.p2.3.m3.1.1.2" xref="S6.p2.3.m3.1.1.2.cmml">P</mi><mrow id="S6.p2.3.m3.1.1.3" xref="S6.p2.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.p2.3.m3.1.1.3.2" xref="S6.p2.3.m3.1.1.3.2.cmml">𝒴</mi><mo fence="false" id="S6.p2.3.m3.1.1.3.1" xref="S6.p2.3.m3.1.1.3.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S6.p2.3.m3.1.1.3.3" xref="S6.p2.3.m3.1.1.3.3.cmml">𝒳</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.p2.3.m3.1b"><apply id="S6.p2.3.m3.1.1.cmml" xref="S6.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S6.p2.3.m3.1.1.1.cmml" xref="S6.p2.3.m3.1.1">subscript</csymbol><ci id="S6.p2.3.m3.1.1.2.cmml" xref="S6.p2.3.m3.1.1.2">𝑃</ci><apply id="S6.p2.3.m3.1.1.3.cmml" xref="S6.p2.3.m3.1.1.3"><csymbol cd="latexml" id="S6.p2.3.m3.1.1.3.1.cmml" xref="S6.p2.3.m3.1.1.3.1">conditional</csymbol><ci id="S6.p2.3.m3.1.1.3.2.cmml" xref="S6.p2.3.m3.1.1.3.2">𝒴</ci><ci id="S6.p2.3.m3.1.1.3.3.cmml" xref="S6.p2.3.m3.1.1.3.3">𝒳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.3.m3.1c">P_{\mathcal{Y}|\mathcal{X}}</annotation></semantics></math> across different clients hurts the performance of other methods, which struggle to adapt the global model to such variability. Even using multiple global models, as in IFCA-FT, is insufficient for effective personalization on the client side, also due to the limitations on the estimation of the cluster identity. In contrast, <em id="S6.p2.3.5" class="ltx_emph ltx_font_italic">CAFeMe</em> leverages meta-learning and the federated modulator to achieve superior performance in personalizing the global model among clients with concept shifts.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">Furthermore, Figure <a href="#S6.F4" title="Figure 4 ‣ 6 Results ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows that <em id="S6.p3.1.1" class="ltx_emph ltx_font_italic">CAFeMe</em> achieves efficient personalization with a small number of personalization steps at test time across all datasets. This demonstrates the efficiency of the proposed approach, enabling quick personalization for clients with limited computational resources. We also conducted additional experiments to investigate the impact of different dataset sizes at the client level. As depicted in Figure <a href="#S6.F5" title="Figure 5 ‣ 6 Results ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, when the local data size is too small (e.g., 100), all baselines exhibit low performance due to the inability of personalizing the global model effectively to the client’s local data distribution. On the other hand, as the size of data increases, <em id="S6.p3.1.2" class="ltx_emph ltx_font_italic">CAFeMe</em> shows a substantial improvement in performance, suggesting its applicability even in scenarios with small amounts of data at the client level.</p>
</div>
<figure id="S6.F5" class="ltx_figure"><img src="/html/2312.15191/assets/images/comparison_size.png" id="S6.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="306" height="214" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S6.F5.3.2" class="ltx_text" style="font-size:90%;">Performance comparison on Meta-Dataset varying the size of data available at the client level. </span></figcaption>
</figure>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this work, we presented <em id="S7.p1.1.1" class="ltx_emph ltx_font_italic">CAFeMe</em>, a novel approach for PFL that leverages meta-learning and a federated modulator network to achieve efficient and effective personalization of the global model to each client’s local data distribution. Our proposed approach overcomes the limitations of traditional FL methods in scenarios with non-i.i.d data distributions by introducing modulation layers that condition the base model on each client’s data.</p>
</div>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.1" class="ltx_p">Through extensive experiments on various synthetic and realistic datasets, we demonstrated the superiority of <em id="S7.p2.1.1" class="ltx_emph ltx_font_italic">CAFeMe</em> over state-of-the-art baselines. The performance gap was particularly evident when the data heterogeneity among clients was significant, showing the robustness and adaptability of our approach in such challenging scenarios. The ability to personalize the global model effectively, even in the presence of concept shifts, was one of the key strengths of <em id="S7.p2.1.2" class="ltx_emph ltx_font_italic">CAFeMe</em>, setting it apart from traditional approaches that struggled to handle such scenarios. We believe that <em id="S7.p2.1.3" class="ltx_emph ltx_font_italic">CAFeMe</em> holds great promise for advancing personalized federated learning in various real-world applications, and we hope that our work inspires further research in this exciting and rapidly evolving field.
Future research directions may involve investigating more sophisticated modulator architectures as well as diverse meta-learning techniques and algorithms to optimize the personalization process for clients with varying data distributions. Furthermore, it would be interesting to explore the robustness of <em id="S7.p2.1.4" class="ltx_emph ltx_font_italic">CAFeMe</em> under adversarial settings and develop mechanisms to defend against potential security and privacy threats.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work was supported by the “Knowledge Foundation” (KK-stiftelsen).</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bibx1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">Durmus Alp Emre Acar et al.
</span>
<span class="ltx_bibblock">“Federated Learning Based on Dynamic Regularization”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx1.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021
</span>
</li>
<li id="bib.bibx2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">Sebastian Caldas et al.
</span>
<span class="ltx_bibblock">“Leaf: A benchmark for federated settings”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.01097</em>, 2018
</span>
</li>
<li id="bib.bibx3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">Fei Chen et al.
</span>
<span class="ltx_bibblock">“Federated meta-learning with fast convergence and efficient communication”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1802.07876</em>, 2018
</span>
</li>
<li id="bib.bibx4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">Mircea Cimpoi et al.
</span>
<span class="ltx_bibblock">“Describing textures in the wild”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx4.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, 2014, pp. 3606–3613
</span>
</li>
<li id="bib.bibx5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">Liam Collins, Hamed Hassani, Aryan Mokhtari and Sanjay Shakkottai
</span>
<span class="ltx_bibblock">“Exploiting shared representations for personalized federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx5.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2021, pp. 2089–2099
</span>
<span class="ltx_bibblock">PMLR
</span>
</li>
<li id="bib.bibx6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">Yatin Dandi, Luis Barba and Martin Jaggi
</span>
<span class="ltx_bibblock">“Implicit gradient alignment in distributed and federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em> <span id="bib.bibx6.2.2" class="ltx_text ltx_font_bold">36.6</span>, 2022, pp. 6454–6462
</span>
</li>
<li id="bib.bibx7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">Li Deng
</span>
<span class="ltx_bibblock">“The mnist database of handwritten digit images for machine learning research [best of the web]”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx7.1.1" class="ltx_emph ltx_font_italic">IEEE signal processing magazine</em> <span id="bib.bibx7.2.2" class="ltx_text ltx_font_bold">29.6</span>
</span>
<span class="ltx_bibblock">IEEE, 2012, pp. 141–142
</span>
</li>
<li id="bib.bibx8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">Moming Duan et al.
</span>
<span class="ltx_bibblock">“Flexible clustered federated learning for client-level data distribution shift”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx8.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Parallel and Distributed Systems</em> <span id="bib.bibx8.2.2" class="ltx_text ltx_font_bold">33.11</span>
</span>
<span class="ltx_bibblock">IEEE, 2021, pp. 2661–2674
</span>
</li>
<li id="bib.bibx9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">Alireza Fallah, Aryan Mokhtari and Asuman Ozdaglar
</span>
<span class="ltx_bibblock">“Personalized federated learning: A meta-learning approach”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.07948</em>, 2020
</span>
</li>
<li id="bib.bibx10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">Chelsea Finn, Pieter Abbeel and Sergey Levine
</span>
<span class="ltx_bibblock">“Model-agnostic meta-learning for fast adaptation of deep networks”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx10.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, 2017, pp. 1126–1135
</span>
<span class="ltx_bibblock">PMLR
</span>
</li>
<li id="bib.bibx11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">Avishek Ghosh, Jichan Chung, Dong Yin and Kannan Ramchandran
</span>
<span class="ltx_bibblock">“An efficient framework for clustered federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx11.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em> <span id="bib.bibx11.2.2" class="ltx_text ltx_font_bold">33</span>, 2020, pp. 19586–19597
</span>
</li>
<li id="bib.bibx12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">Avishek Ghosh, Justin Hong, Dong Yin and Kannan Ramchandran
</span>
<span class="ltx_bibblock">“Robust federated learning in a heterogeneous environment”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.06629</em>, 2019
</span>
</li>
<li id="bib.bibx13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">Filip Hanzely and Peter Richtárik
</span>
<span class="ltx_bibblock">“Federated learning of a mixture of global and local models”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.05516</em>, 2020
</span>
</li>
<li id="bib.bibx14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">Tzu-Ming Harry Hsu, Hang Qi and Matthew Brown
</span>
<span class="ltx_bibblock">“Measuring the effects of non-identical data distribution for federated visual classification”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.06335</em>, 2019
</span>
</li>
<li id="bib.bibx15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">Yutao Huang et al.
</span>
<span class="ltx_bibblock">“Personalized cross-silo federated learning on non-iid data”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em> <span id="bib.bibx15.2.2" class="ltx_text ltx_font_bold">35.9</span>, 2021, pp. 7865–7873
</span>
</li>
<li id="bib.bibx16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">Yihan Jiang, Jakub Konečnỳ, Keith Rush and Sreeram Kannan
</span>
<span class="ltx_bibblock">“Improving federated learning personalization via model agnostic meta learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.12488</em>, 2019
</span>
</li>
<li id="bib.bibx17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">Sai Praneeth Karimireddy et al.
</span>
<span class="ltx_bibblock">“Scaffold: Stochastic controlled averaging for federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx17.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2020, pp. 5132–5143
</span>
<span class="ltx_bibblock">PMLR
</span>
</li>
<li id="bib.bibx18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">Mikhail Khodak, Maria-Florina F Balcan and Ameet S Talwalkar
</span>
<span class="ltx_bibblock">“Adaptive gradient-based meta-learning methods”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx18.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em> <span id="bib.bibx18.2.2" class="ltx_text ltx_font_bold">32</span>, 2019
</span>
</li>
<li id="bib.bibx19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">Alex Krizhevsky
</span>
<span class="ltx_bibblock">“Learning multiple layers of features from tiny images”, 2009
</span>
</li>
<li id="bib.bibx20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">Brenden Lake, Ruslan Salakhutdinov, Jason Gross and Joshua Tenenbaum
</span>
<span class="ltx_bibblock">“One shot learning of simple visual concepts”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the annual meeting of the cognitive science society</em> <span id="bib.bibx20.2.2" class="ltx_text ltx_font_bold">33.33</span>, 2011
</span>
</li>
<li id="bib.bibx21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">Qinbin Li, Bingsheng He and Dawn Song
</span>
<span class="ltx_bibblock">“Model-contrastive federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2021, pp. 10713–10722
</span>
</li>
<li id="bib.bibx22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">Tian Li, Shengyuan Hu, Ahmad Beirami and Virginia Smith
</span>
<span class="ltx_bibblock">“Ditto: Fair and robust federated learning through personalization”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx22.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2021, pp. 6357–6368
</span>
<span class="ltx_bibblock">PMLR
</span>
</li>
<li id="bib.bibx23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">Tian Li, Maziar Sanjabi, Ahmad Beirami and Virginia Smith
</span>
<span class="ltx_bibblock">“Fair Resource Allocation in Federated Learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx23.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2020
</span>
</li>
<li id="bib.bibx24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">Tian Li et al.
</span>
<span class="ltx_bibblock">“Federated optimization in heterogeneous networks”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx24.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine learning and systems</em> <span id="bib.bibx24.2.2" class="ltx_text ltx_font_bold">2</span>, 2020, pp. 429–450
</span>
</li>
<li id="bib.bibx25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">Subhransu Maji et al.
</span>
<span class="ltx_bibblock">“Fine-grained visual classification of aircraft”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1306.5151</em>, 2013
</span>
</li>
<li id="bib.bibx26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">Yishay Mansour, Mehryar Mohri, Jae Ro and Ananda Theertha Suresh
</span>
<span class="ltx_bibblock">“Three approaches for personalization with applications to federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.10619</em>, 2020
</span>
</li>
<li id="bib.bibx27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">Brendan McMahan et al.
</span>
<span class="ltx_bibblock">“Communication-efficient learning of deep networks from decentralized data”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx27.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, 2017, pp. 1273–1282
</span>
<span class="ltx_bibblock">PMLR
</span>
</li>
<li id="bib.bibx28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">Tomoya Murata and Taiji Suzuki
</span>
<span class="ltx_bibblock">“Bias-Variance Reduced Local SGD for Less Heterogeneous Federated Learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx28.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2021, pp. 7872–7881
</span>
<span class="ltx_bibblock">PMLR
</span>
</li>
<li id="bib.bibx29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">Maria-Elena Nilsback and Andrew Zisserman
</span>
<span class="ltx_bibblock">“Automated flower classification over a large number of classes”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx29.1.1" class="ltx_emph ltx_font_italic">2008 Sixth Indian Conference on Computer Vision, Graphics &amp; Image Processing</em>, 2008, pp. 722–729
</span>
<span class="ltx_bibblock">IEEE
</span>
</li>
<li id="bib.bibx30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">Boris Oreshkin, Pau Rodriguez Lopez and Alexandre Lacoste
</span>
<span class="ltx_bibblock">“Tadam: Task dependent adaptive metric for improved few-shot learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx30.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em> <span id="bib.bibx30.2.2" class="ltx_text ltx_font_bold">31</span>, 2018
</span>
</li>
<li id="bib.bibx31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">Ethan Perez et al.
</span>
<span class="ltx_bibblock">“Film: Visual reasoning with a general conditioning layer”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx31.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em> <span id="bib.bibx31.2.2" class="ltx_text ltx_font_bold">32.1</span>, 2018
</span>
</li>
<li id="bib.bibx32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">Sachin Ravi and Hugo Larochelle
</span>
<span class="ltx_bibblock">“Optimization as a model for few-shot learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx32.1.1" class="ltx_emph ltx_font_italic">International conference on learning representations</em>, 2017
</span>
</li>
<li id="bib.bibx33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">Felix Sattler, Klaus-Robert Müller and Wojciech Samek
</span>
<span class="ltx_bibblock">“Clustered federated learning: Model-agnostic distributed multitask optimization under privacy constraints”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx33.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em> <span id="bib.bibx33.2.2" class="ltx_text ltx_font_bold">32.8</span>
</span>
<span class="ltx_bibblock">IEEE, 2020, pp. 3710–3722
</span>
</li>
<li id="bib.bibx34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">Johannes Stallkamp, Marc Schlipsing, Jan Salmen and Christian Igel
</span>
<span class="ltx_bibblock">“Man vs. computer: Benchmarking machine learning algorithms for traffic sign recognition”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx34.1.1" class="ltx_emph ltx_font_italic">Neural networks</em> <span id="bib.bibx34.2.2" class="ltx_text ltx_font_bold">32</span>
</span>
<span class="ltx_bibblock">Elsevier, 2012, pp. 323–332
</span>
</li>
<li id="bib.bibx35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">Canh T Dinh, Nguyen Tran and Josh Nguyen
</span>
<span class="ltx_bibblock">“Personalized federated learning with moreau envelopes”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx35.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em> <span id="bib.bibx35.2.2" class="ltx_text ltx_font_bold">33</span>, 2020, pp. 21394–21405
</span>
</li>
<li id="bib.bibx36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">Minxue Tang et al.
</span>
<span class="ltx_bibblock">“FedCor: Correlation-based active client selection strategy for heterogeneous federated learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx36.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2022, pp. 10102–10111
</span>
</li>
<li id="bib.bibx37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">Eleni Triantafillou et al.
</span>
<span class="ltx_bibblock">“Meta-Dataset: A Dataset of Datasets for Learning to Learn from Few Examples”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx37.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2020
</span>
</li>
<li id="bib.bibx38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">Anna Vettoruzzo et al.
</span>
<span class="ltx_bibblock">“Advances and Challenges in Meta-Learning: A Technical Review”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx38.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.04722</em>, 2023
</span>
</li>
<li id="bib.bibx39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">Catherine Wah et al.
</span>
<span class="ltx_bibblock">“The caltech-ucsd birds-200-2011 dataset”, 2011
</span>
</li>
<li id="bib.bibx40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">Hongyi Wang et al.
</span>
<span class="ltx_bibblock">“Federated Learning with Matched Averaging”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx40.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2020
</span>
</li>
<li id="bib.bibx41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">Hongda Wu and Ping Wang
</span>
<span class="ltx_bibblock">“Node selection toward faster convergence for federated learning on non-iid data”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx41.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Network Science and Engineering</em> <span id="bib.bibx41.2.2" class="ltx_text ltx_font_bold">9.5</span>
</span>
<span class="ltx_bibblock">IEEE, 2022, pp. 3099–3111
</span>
</li>
<li id="bib.bibx42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">Jian Xu, Xinyi Tong and Huang Shao-Lun
</span>
<span class="ltx_bibblock">“Personalized Federated Learning with Feature Alignment and Classifier Collaboration”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx42.1.1" class="ltx_emph ltx_font_italic">International conference on learning representations</em>, 2023
</span>
</li>
<li id="bib.bibx43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">Lei Yang, Jiaming Huang, Wanyu Lin and Jiannong Cao
</span>
<span class="ltx_bibblock">“Personalized federated learning on non-IID data via group-based meta-learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx43.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Knowledge Discovery from Data</em> <span id="bib.bibx43.2.2" class="ltx_text ltx_font_bold">17.4</span>
</span>
<span class="ltx_bibblock">ACM New York, NY, 2023, pp. 1–20
</span>
</li>
<li id="bib.bibx44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">Tehrim Yoon, Sumin Shin, Sung Ju Hwang and Eunho Yang
</span>
<span class="ltx_bibblock">“FedMix: Approximation of Mixup under Mean Augmented Federated Learning”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx44.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>
</span>
</li>
<li id="bib.bibx45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">Mikhail Yurochkin et al.
</span>
<span class="ltx_bibblock">“Bayesian nonparametric federated learning of neural networks”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx45.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, 2019, pp. 7252–7261
</span>
<span class="ltx_bibblock">PMLR
</span>
</li>
<li id="bib.bibx46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">Michael Zhang et al.
</span>
<span class="ltx_bibblock">“Personalized Federated Learning with First Order Model Optimization”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx46.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021
</span>
</li>
<li id="bib.bibx47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">Yue Zhao et al.
</span>
<span class="ltx_bibblock">“Federated learning with non-iid data”
</span>
<span class="ltx_bibblock">In <em id="bib.bibx47.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p">
<span id="p2.1.1" class="ltx_text ltx_font_bold" style="font-size:144%;">Supplementary Material</span></p>
</div>
<div id="p3" class="ltx_para">
<div class="ltx_pagination ltx_role_start_3_columns"></div>
<div class="ltx_pagination ltx_role_end_3_columns"></div>
</div>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Datasets</h2>

<section id="S8.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.1 </span>Synthetic datasets.</h3>

<div id="S8.SS1.p1" class="ltx_para">
<p id="S8.SS1.p1.2" class="ltx_p">We evaluate our model on two synthetic datasets: CIFAR-10 and a rotated version of MNIST, referred to as RMNIST. For the latter, we partition MNIST data into <math id="S8.SS1.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S8.SS1.p1.1.m1.1a"><mn id="S8.SS1.p1.1.m1.1.1" xref="S8.SS1.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S8.SS1.p1.1.m1.1b"><cn type="integer" id="S8.SS1.p1.1.m1.1.1.cmml" xref="S8.SS1.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p1.1.m1.1c">10</annotation></semantics></math> subsets of equal size and we apply a distinct degree of rotation within the range <math id="S8.SS1.p1.2.m2.2" class="ltx_Math" alttext="[0,200]" display="inline"><semantics id="S8.SS1.p1.2.m2.2a"><mrow id="S8.SS1.p1.2.m2.2.3.2" xref="S8.SS1.p1.2.m2.2.3.1.cmml"><mo stretchy="false" id="S8.SS1.p1.2.m2.2.3.2.1" xref="S8.SS1.p1.2.m2.2.3.1.cmml">[</mo><mn id="S8.SS1.p1.2.m2.1.1" xref="S8.SS1.p1.2.m2.1.1.cmml">0</mn><mo id="S8.SS1.p1.2.m2.2.3.2.2" xref="S8.SS1.p1.2.m2.2.3.1.cmml">,</mo><mn id="S8.SS1.p1.2.m2.2.2" xref="S8.SS1.p1.2.m2.2.2.cmml">200</mn><mo stretchy="false" id="S8.SS1.p1.2.m2.2.3.2.3" xref="S8.SS1.p1.2.m2.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S8.SS1.p1.2.m2.2b"><interval closure="closed" id="S8.SS1.p1.2.m2.2.3.1.cmml" xref="S8.SS1.p1.2.m2.2.3.2"><cn type="integer" id="S8.SS1.p1.2.m2.1.1.cmml" xref="S8.SS1.p1.2.m2.1.1">0</cn><cn type="integer" id="S8.SS1.p1.2.m2.2.2.cmml" xref="S8.SS1.p1.2.m2.2.2">200</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p1.2.m2.2c">[0,200]</annotation></semantics></math> to each subset. This rotational variation enhances the diversity within the MNIST dataset, enabling a more realistic representation of non-i.i.d. data.</p>
</div>
<div id="S8.SS1.p2" class="ltx_para">
<p id="S8.SS1.p2.8" class="ltx_p">To partition data into clients, we designed two partition schemes: the <em id="S8.SS1.p2.8.1" class="ltx_emph ltx_font_italic">shards</em> partition and the <em id="S8.SS1.p2.8.2" class="ltx_emph ltx_font_italic">dirichlet</em> partition. A visual representation of these two partition schemes is shown in Figure <a href="#S8.F6" title="Figure 6 ‣ 8.1 Synthetic datasets. ‣ 8 Datasets ‣ Personalized Federated Learning with Contextual Modulation and Meta-Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
The <em id="S8.SS1.p2.8.3" class="ltx_emph ltx_font_italic">shards</em> partition scheme involves a balanced non-i.i.d. partition, where each client is allocated an equal number of samples. To construct this scheme, we first sort the data by label, divide it into <math id="S8.SS1.p2.1.m1.1" class="ltx_Math" alttext="200" display="inline"><semantics id="S8.SS1.p2.1.m1.1a"><mn id="S8.SS1.p2.1.m1.1.1" xref="S8.SS1.p2.1.m1.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S8.SS1.p2.1.m1.1b"><cn type="integer" id="S8.SS1.p2.1.m1.1.1.cmml" xref="S8.SS1.p2.1.m1.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p2.1.m1.1c">200</annotation></semantics></math> shards, and assign two shards to each client. Therefore, most clients solely have examples from two classes. On the other hand, the <em id="S8.SS1.p2.8.4" class="ltx_emph ltx_font_italic">dirichlet</em> partition exhibits an unbalanced and non-i.i.d. scheme, characterized by varying numbers of data points and class proportions across clients. For each client, we sample <math id="S8.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{p}_{n}\sim\textnormal{Dir}_{C}(\alpha)" display="inline"><semantics id="S8.SS1.p2.2.m2.1a"><mrow id="S8.SS1.p2.2.m2.1.2" xref="S8.SS1.p2.2.m2.1.2.cmml"><msub id="S8.SS1.p2.2.m2.1.2.2" xref="S8.SS1.p2.2.m2.1.2.2.cmml"><mi id="S8.SS1.p2.2.m2.1.2.2.2" xref="S8.SS1.p2.2.m2.1.2.2.2.cmml">𝐩</mi><mi id="S8.SS1.p2.2.m2.1.2.2.3" xref="S8.SS1.p2.2.m2.1.2.2.3.cmml">n</mi></msub><mo id="S8.SS1.p2.2.m2.1.2.1" xref="S8.SS1.p2.2.m2.1.2.1.cmml">∼</mo><mrow id="S8.SS1.p2.2.m2.1.2.3" xref="S8.SS1.p2.2.m2.1.2.3.cmml"><msub id="S8.SS1.p2.2.m2.1.2.3.2" xref="S8.SS1.p2.2.m2.1.2.3.2.cmml"><mtext id="S8.SS1.p2.2.m2.1.2.3.2.2" xref="S8.SS1.p2.2.m2.1.2.3.2.2a.cmml">Dir</mtext><mi id="S8.SS1.p2.2.m2.1.2.3.2.3" xref="S8.SS1.p2.2.m2.1.2.3.2.3.cmml">C</mi></msub><mo lspace="0em" rspace="0em" id="S8.SS1.p2.2.m2.1.2.3.1" xref="S8.SS1.p2.2.m2.1.2.3.1.cmml">​</mo><mrow id="S8.SS1.p2.2.m2.1.2.3.3.2" xref="S8.SS1.p2.2.m2.1.2.3.cmml"><mo stretchy="false" id="S8.SS1.p2.2.m2.1.2.3.3.2.1" xref="S8.SS1.p2.2.m2.1.2.3.cmml">(</mo><mi id="S8.SS1.p2.2.m2.1.1" xref="S8.SS1.p2.2.m2.1.1.cmml">α</mi><mo stretchy="false" id="S8.SS1.p2.2.m2.1.2.3.3.2.2" xref="S8.SS1.p2.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S8.SS1.p2.2.m2.1b"><apply id="S8.SS1.p2.2.m2.1.2.cmml" xref="S8.SS1.p2.2.m2.1.2"><csymbol cd="latexml" id="S8.SS1.p2.2.m2.1.2.1.cmml" xref="S8.SS1.p2.2.m2.1.2.1">similar-to</csymbol><apply id="S8.SS1.p2.2.m2.1.2.2.cmml" xref="S8.SS1.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S8.SS1.p2.2.m2.1.2.2.1.cmml" xref="S8.SS1.p2.2.m2.1.2.2">subscript</csymbol><ci id="S8.SS1.p2.2.m2.1.2.2.2.cmml" xref="S8.SS1.p2.2.m2.1.2.2.2">𝐩</ci><ci id="S8.SS1.p2.2.m2.1.2.2.3.cmml" xref="S8.SS1.p2.2.m2.1.2.2.3">𝑛</ci></apply><apply id="S8.SS1.p2.2.m2.1.2.3.cmml" xref="S8.SS1.p2.2.m2.1.2.3"><times id="S8.SS1.p2.2.m2.1.2.3.1.cmml" xref="S8.SS1.p2.2.m2.1.2.3.1"></times><apply id="S8.SS1.p2.2.m2.1.2.3.2.cmml" xref="S8.SS1.p2.2.m2.1.2.3.2"><csymbol cd="ambiguous" id="S8.SS1.p2.2.m2.1.2.3.2.1.cmml" xref="S8.SS1.p2.2.m2.1.2.3.2">subscript</csymbol><ci id="S8.SS1.p2.2.m2.1.2.3.2.2a.cmml" xref="S8.SS1.p2.2.m2.1.2.3.2.2"><mtext id="S8.SS1.p2.2.m2.1.2.3.2.2.cmml" xref="S8.SS1.p2.2.m2.1.2.3.2.2">Dir</mtext></ci><ci id="S8.SS1.p2.2.m2.1.2.3.2.3.cmml" xref="S8.SS1.p2.2.m2.1.2.3.2.3">𝐶</ci></apply><ci id="S8.SS1.p2.2.m2.1.1.cmml" xref="S8.SS1.p2.2.m2.1.1">𝛼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p2.2.m2.1c">\mathbf{p}_{n}\sim\textnormal{Dir}_{C}(\alpha)</annotation></semantics></math>, where <math id="S8.SS1.p2.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S8.SS1.p2.3.m3.1a"><mi id="S8.SS1.p2.3.m3.1.1" xref="S8.SS1.p2.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S8.SS1.p2.3.m3.1b"><ci id="S8.SS1.p2.3.m3.1.1.cmml" xref="S8.SS1.p2.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p2.3.m3.1c">C</annotation></semantics></math> represents the number of clients, and allocate a <math id="S8.SS1.p2.4.m4.2" class="ltx_Math" alttext="\mathbf{p}_{n,i}" display="inline"><semantics id="S8.SS1.p2.4.m4.2a"><msub id="S8.SS1.p2.4.m4.2.3" xref="S8.SS1.p2.4.m4.2.3.cmml"><mi id="S8.SS1.p2.4.m4.2.3.2" xref="S8.SS1.p2.4.m4.2.3.2.cmml">𝐩</mi><mrow id="S8.SS1.p2.4.m4.2.2.2.4" xref="S8.SS1.p2.4.m4.2.2.2.3.cmml"><mi id="S8.SS1.p2.4.m4.1.1.1.1" xref="S8.SS1.p2.4.m4.1.1.1.1.cmml">n</mi><mo id="S8.SS1.p2.4.m4.2.2.2.4.1" xref="S8.SS1.p2.4.m4.2.2.2.3.cmml">,</mo><mi id="S8.SS1.p2.4.m4.2.2.2.2" xref="S8.SS1.p2.4.m4.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S8.SS1.p2.4.m4.2b"><apply id="S8.SS1.p2.4.m4.2.3.cmml" xref="S8.SS1.p2.4.m4.2.3"><csymbol cd="ambiguous" id="S8.SS1.p2.4.m4.2.3.1.cmml" xref="S8.SS1.p2.4.m4.2.3">subscript</csymbol><ci id="S8.SS1.p2.4.m4.2.3.2.cmml" xref="S8.SS1.p2.4.m4.2.3.2">𝐩</ci><list id="S8.SS1.p2.4.m4.2.2.2.3.cmml" xref="S8.SS1.p2.4.m4.2.2.2.4"><ci id="S8.SS1.p2.4.m4.1.1.1.1.cmml" xref="S8.SS1.p2.4.m4.1.1.1.1">𝑛</ci><ci id="S8.SS1.p2.4.m4.2.2.2.2.cmml" xref="S8.SS1.p2.4.m4.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p2.4.m4.2c">\mathbf{p}_{n,i}</annotation></semantics></math> proportion of class <math id="S8.SS1.p2.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S8.SS1.p2.5.m5.1a"><mi id="S8.SS1.p2.5.m5.1.1" xref="S8.SS1.p2.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S8.SS1.p2.5.m5.1b"><ci id="S8.SS1.p2.5.m5.1.1.cmml" xref="S8.SS1.p2.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p2.5.m5.1c">n</annotation></semantics></math> to local client <math id="S8.SS1.p2.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S8.SS1.p2.6.m6.1a"><mi id="S8.SS1.p2.6.m6.1.1" xref="S8.SS1.p2.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S8.SS1.p2.6.m6.1b"><ci id="S8.SS1.p2.6.m6.1.1.cmml" xref="S8.SS1.p2.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p2.6.m6.1c">i</annotation></semantics></math>. The concentration parameter <math id="S8.SS1.p2.7.m7.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S8.SS1.p2.7.m7.1a"><mi id="S8.SS1.p2.7.m7.1.1" xref="S8.SS1.p2.7.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S8.SS1.p2.7.m7.1b"><ci id="S8.SS1.p2.7.m7.1.1.cmml" xref="S8.SS1.p2.7.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p2.7.m7.1c">\alpha</annotation></semantics></math> regulates the level of data heterogeneity across different clients: the smaller this value, the higher the class imbalance. We set it to <math id="S8.SS1.p2.8.m8.1" class="ltx_Math" alttext="0.3" display="inline"><semantics id="S8.SS1.p2.8.m8.1a"><mn id="S8.SS1.p2.8.m8.1.1" xref="S8.SS1.p2.8.m8.1.1.cmml">0.3</mn><annotation-xml encoding="MathML-Content" id="S8.SS1.p2.8.m8.1b"><cn type="float" id="S8.SS1.p2.8.m8.1.1.cmml" xref="S8.SS1.p2.8.m8.1.1">0.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.SS1.p2.8.m8.1c">0.3</annotation></semantics></math> by default if not explicitly mentioned.</p>
</div>
<figure id="S8.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S8.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.15191/assets/images/rmnist_shards.png" id="S8.F6.sf1.g1" class="ltx_graphics ltx_img_landscape" width="238" height="180" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S8.F6.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S8.F6.sf1.3.2" class="ltx_text" style="font-size:90%;">Shards</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S8.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.15191/assets/images/rmnist_dirichlet1000.png" id="S8.F6.sf2.g1" class="ltx_graphics ltx_img_landscape" width="238" height="179" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S8.F6.sf2.4.2.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S8.F6.sf2.2.1" class="ltx_text" style="font-size:90%;">Dirichlet <math id="S8.F6.sf2.2.1.m1.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="S8.F6.sf2.2.1.m1.1b"><mrow id="S8.F6.sf2.2.1.m1.1.1" xref="S8.F6.sf2.2.1.m1.1.1.cmml"><mi id="S8.F6.sf2.2.1.m1.1.1.2" xref="S8.F6.sf2.2.1.m1.1.1.2.cmml">α</mi><mo id="S8.F6.sf2.2.1.m1.1.1.1" xref="S8.F6.sf2.2.1.m1.1.1.1.cmml">=</mo><mn id="S8.F6.sf2.2.1.m1.1.1.3" xref="S8.F6.sf2.2.1.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.F6.sf2.2.1.m1.1c"><apply id="S8.F6.sf2.2.1.m1.1.1.cmml" xref="S8.F6.sf2.2.1.m1.1.1"><eq id="S8.F6.sf2.2.1.m1.1.1.1.cmml" xref="S8.F6.sf2.2.1.m1.1.1.1"></eq><ci id="S8.F6.sf2.2.1.m1.1.1.2.cmml" xref="S8.F6.sf2.2.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S8.F6.sf2.2.1.m1.1.1.3.cmml" xref="S8.F6.sf2.2.1.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.F6.sf2.2.1.m1.1d">\alpha=1000</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S8.F6.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2312.15191/assets/images/rmnist_dirichlet0.3.png" id="S8.F6.sf3.g1" class="ltx_graphics ltx_img_landscape" width="238" height="179" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S8.F6.sf3.4.2.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S8.F6.sf3.2.1" class="ltx_text" style="font-size:90%;">Dirichlet <math id="S8.F6.sf3.2.1.m1.1" class="ltx_Math" alttext="\alpha=0.3" display="inline"><semantics id="S8.F6.sf3.2.1.m1.1b"><mrow id="S8.F6.sf3.2.1.m1.1.1" xref="S8.F6.sf3.2.1.m1.1.1.cmml"><mi id="S8.F6.sf3.2.1.m1.1.1.2" xref="S8.F6.sf3.2.1.m1.1.1.2.cmml">α</mi><mo id="S8.F6.sf3.2.1.m1.1.1.1" xref="S8.F6.sf3.2.1.m1.1.1.1.cmml">=</mo><mn id="S8.F6.sf3.2.1.m1.1.1.3" xref="S8.F6.sf3.2.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.F6.sf3.2.1.m1.1c"><apply id="S8.F6.sf3.2.1.m1.1.1.cmml" xref="S8.F6.sf3.2.1.m1.1.1"><eq id="S8.F6.sf3.2.1.m1.1.1.1.cmml" xref="S8.F6.sf3.2.1.m1.1.1.1"></eq><ci id="S8.F6.sf3.2.1.m1.1.1.2.cmml" xref="S8.F6.sf3.2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S8.F6.sf3.2.1.m1.1.1.3.cmml" xref="S8.F6.sf3.2.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.F6.sf3.2.1.m1.1d">\alpha=0.3</annotation></semantics></math></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S8.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S8.F6.3.2" class="ltx_text" style="font-size:90%;">Class distributions of 10 exemplary clients using different partition schemes for RMNIST dataset.</span></figcaption>
</figure>
</section>
<section id="S8.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">8.2 </span>Realistic datasets.</h3>

<div id="S8.SS2.p1" class="ltx_para">
<p id="S8.SS2.p1.2" class="ltx_p">To assess the performance of <em id="S8.SS2.p1.2.1" class="ltx_emph ltx_font_italic">CAFeMe</em> in a more realistic scenario we evaluate it on FEMNIST and Meta-Dataset. While FEMNIST is a well-known dataset in the field of PFL, this is the first work that uses Meta-Dataset to assess the performance of a PFL framework.
Meta-Dataset is a large-scale dataset comprising various classification datasets such as Mini-Imagenet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx32" title="" class="ltx_ref">32</a>]</cite>, FC100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx30" title="" class="ltx_ref">30</a>]</cite>, Omniglot <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx20" title="" class="ltx_ref">20</a>]</cite>, Aircraft <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx25" title="" class="ltx_ref">25</a>]</cite>, CUB Birds <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx39" title="" class="ltx_ref">39</a>]</cite>, Describable Textures Dataset (DTD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx4" title="" class="ltx_ref">4</a>]</cite>, Traffic Signs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx34" title="" class="ltx_ref">34</a>]</cite>, and VGG Flowers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx29" title="" class="ltx_ref">29</a>]</cite>. In this context, each client is assigned data with <math id="S8.SS2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S8.SS2.p1.1.m1.1a"><mi id="S8.SS2.p1.1.m1.1.1" xref="S8.SS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S8.SS2.p1.1.m1.1b"><ci id="S8.SS2.p1.1.m1.1.1.cmml" xref="S8.SS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS2.p1.1.m1.1c">N</annotation></semantics></math> classes sampled from one of these classification datasets. Therefore, while all clients share the same task of classifying images into <math id="S8.SS2.p1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S8.SS2.p1.2.m2.1a"><mi id="S8.SS2.p1.2.m2.1.1" xref="S8.SS2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S8.SS2.p1.2.m2.1b"><ci id="S8.SS2.p1.2.m2.1.1.cmml" xref="S8.SS2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.SS2.p1.2.m2.1c">N</annotation></semantics></math> classes, the nature of their local data varies significantly, resulting in labels that might have different meanings across clients. This leads to the emergence of the concept shift scenario, a common phenomenon in real-world situations.</p>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2312.15190" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2312.15191" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2312.15191">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2312.15191" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2312.15192" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 11:47:47 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
