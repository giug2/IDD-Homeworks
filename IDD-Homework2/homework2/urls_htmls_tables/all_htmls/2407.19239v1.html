<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation</title>
<!--Generated on Sat Jul 27 05:29:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2407.19239v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx1" title="In MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx2" title="In MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Preparation Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx2.SSx1" title="In Preparation Work ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Sequential Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx2.SSx2" title="In Preparation Work ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Transformer and Mamba</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx3" title="In MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">MaTrRec</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx3.SSx1" title="In MaTrRec ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Problem Statement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx3.SSx2" title="In MaTrRec ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Model Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx3.SSx3" title="In MaTrRec ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Embedding Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx3.SSx4" title="In MaTrRec ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Mamba Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx3.SSx5" title="In MaTrRec ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Multi-Head Attention layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx3.SSx6" title="In MaTrRec ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Feed-Forward Network</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx3.SSx7" title="In MaTrRec ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Prediction Layer</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4" title="In MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.SSx1" title="In Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.SSx2" title="In Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Experimental Details and Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.SSx3" title="In Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Baseline Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.SSx4" title="In Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Overall Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.SSx5" title="In Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.SSx6" title="In Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Impact of Dropout Parameter on Model Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.SSx7" title="In Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Impact of Maximum Sequence Length N on Model Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.SSx8" title="In Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Model Complexity</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx5" title="In MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_title">Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Shun Zhang, Runsen Zhang, Zhirong Yang
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Sequential recommendation systems aim to provide personalized recommendations by analyzing dynamic preferences and dependencies within user behavior sequences. Recently, Transformer models can effectively capture user preferences. However, their quadratic computational complexity limits recommendation performance on long interaction sequence data. Inspired by the State Space Model (SSM) representative model, Mamba, which efficiently captures user preferences in long interaction sequences with linear complexity, we find that Mamba’s recommendation effectiveness is limited in short interaction sequences, with failing to recall items of actual interest to users and exacerbating the data sparsity cold start problem.</p>
<p class="ltx_p" id="id2.id2">To address this issue, we innovatively propose a new model, MaTrRec, which combines the strengths of Mamba and Transformer. This model fully leverages Mamba’s advantages in handling long-term dependencies and Transformer’s global attention advantages in short-term dependencies, thereby enhances predictive capabilities on both long and short interaction sequence datasets while balancing model efficiency. Notably, our model significantly improves the data sparsity cold start problem, with an improvement of up to 33% on the highly sparse Amazon Musical Instruments dataset. We conducted extensive experimental evaluations on five widely used public datasets. The experimental results show that our model outperforms the current state-of-the-art sequential recommendation models on all five datasets.</p>
<p class="ltx_p" id="id3.id3">Specifically, MaTrRec excels in both long interaction sequence datasets (such as ML-1M) and short interaction sequence datasets (such as Musical), while effectively combining the advantages of Mamba and Transformer in handling long and short interaction sequences. Thereby it significantly enhances the overall performance of the recommendation system and addresses the data sparsity cold start problem. The code is available at https://github.com/Unintelligentmumu/MaTrRec.</p>
</div>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Introduction</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">Sequential recommendation is a method in recommender systems that utilizes the temporal order of users’ historical behaviors to predict items or content they may be interested in the future. In sequential recommendation, each user interaction (such as browsing, purchasing, rating, etc.) is considered an event in a time sequence. By analyzing these sequences, the system learns the evolution of user preferences, enabling it to more accurately predict items of potential interest to the users.<cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib17" title="">2015</a>; Lin et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib15" title="">2023</a>; Wang et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib25" title="">2021</a>; Quadrana et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib19" title="">2017</a>)</cite>. Based on the length of user behavior sequences, these sequences can be roughly divided into long interaction sequences and short interaction sequences.Long interaction sequences: Long interaction sequences provide richer information about users’ historical preferences, including trends in their long-term interests. This helps to uncover users’ long-term interest patterns and behavior habits, leading to more personalized and accurate recommendations. However, handling long sequences requires more computational resources and more complex models to capture the dependencies within the sequences. Long interaction sequence data is beneficial for learning users’ stable long-term interests, but it comes with higher computational complexity and resource demands.Short interaction sequences: Short interaction sequences, due to the shorter average length of user interactions, provide relatively limited information about users’ interests and preferences, making it challenging to comprehensively depict users’ interests. Therefore, the model needs to capture users’ current interests as efficiently as possible with limited data. Short interaction sequences are relatively simple to process and consume fewer computational resources. However, they suffer from a lack of information, which may lead to less accurate recommendations. Additionally, short interaction sequences face the problem of data sparsity and cold start. Due to the lack of sufficient historical data, the model struggles to accurately capture user interests, thereby affecting the recommendation quality. This data sparsity exacerbates the cold start problem, where the model performs poorly in recommending for new users or new items.</p>
</div>
<div class="ltx_para" id="Sx1.p2">
<p class="ltx_p" id="Sx1.p2.1">To effectively model user behavior sequences, researchers have utilized various neural network frameworks for sequence recommendation. For instance, early studies applied Recurrent Neural Networks (RNNs) and Convolutional Neural Networks (CNNs) in sequence recommendation, but encountered catastrophic forgetting issues, making it difficult for models to remember earlier user behaviors<cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib23" title="">2018</a>; Donkers, Loepp, and Ziegler <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib2" title="">2017</a>)</cite>. Subsequently, the Transformer<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib24" title="">2017</a>)</cite> architecture was introduced to sequence recommendation and achieved significant effectiveness. However, due to the <math alttext="O(n^{2})" class="ltx_Math" display="inline" id="Sx1.p2.1.m1.1"><semantics id="Sx1.p2.1.m1.1a"><mrow id="Sx1.p2.1.m1.1.1" xref="Sx1.p2.1.m1.1.1.cmml"><mi id="Sx1.p2.1.m1.1.1.3" xref="Sx1.p2.1.m1.1.1.3.cmml">O</mi><mo id="Sx1.p2.1.m1.1.1.2" xref="Sx1.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="Sx1.p2.1.m1.1.1.1.1" xref="Sx1.p2.1.m1.1.1.1.1.1.cmml"><mo id="Sx1.p2.1.m1.1.1.1.1.2" stretchy="false" xref="Sx1.p2.1.m1.1.1.1.1.1.cmml">(</mo><msup id="Sx1.p2.1.m1.1.1.1.1.1" xref="Sx1.p2.1.m1.1.1.1.1.1.cmml"><mi id="Sx1.p2.1.m1.1.1.1.1.1.2" xref="Sx1.p2.1.m1.1.1.1.1.1.2.cmml">n</mi><mn id="Sx1.p2.1.m1.1.1.1.1.1.3" xref="Sx1.p2.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="Sx1.p2.1.m1.1.1.1.1.3" stretchy="false" xref="Sx1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx1.p2.1.m1.1b"><apply id="Sx1.p2.1.m1.1.1.cmml" xref="Sx1.p2.1.m1.1.1"><times id="Sx1.p2.1.m1.1.1.2.cmml" xref="Sx1.p2.1.m1.1.1.2"></times><ci id="Sx1.p2.1.m1.1.1.3.cmml" xref="Sx1.p2.1.m1.1.1.3">𝑂</ci><apply id="Sx1.p2.1.m1.1.1.1.1.1.cmml" xref="Sx1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Sx1.p2.1.m1.1.1.1.1.1.1.cmml" xref="Sx1.p2.1.m1.1.1.1.1">superscript</csymbol><ci id="Sx1.p2.1.m1.1.1.1.1.1.2.cmml" xref="Sx1.p2.1.m1.1.1.1.1.1.2">𝑛</ci><cn id="Sx1.p2.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="Sx1.p2.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.p2.1.m1.1c">O(n^{2})</annotation><annotation encoding="application/x-llamapun" id="Sx1.p2.1.m1.1d">italic_O ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> computational complexity of the Transformer model’s self-attention mechanism, where n is the sequence length, it incurs high computational costs. Additionally, Transformers rely on positional encoding to capture the position information of elements in sequences, but this encoding method may not adequately capture dynamic positional relationships in complex or long interaction sequences, leading to challenges in prediction accuracy, training, and inference speed in long interaction sequence scenarios. Recently, researchers introduced the state space model (SSM)<cite class="ltx_cite ltx_citemacro_citep">(Gu, Goel, and R’e <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib5" title="">2021</a>)</cite> representative architecture, Mamba<cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib4" title="">2023</a>)</cite>into the field of sequence recommendation. Mamba, with its linear complexity, excels in capturing user preferences in long interaction sequences. However, experiments indicate that Mamba exhibits lower recall rates when handling short interaction sequence datasets. Recall rate is a critical evaluation metric in sequence recommendation, measuring the proportion of truly relevant items retrieved in the recommendation list, indicating the system’s ability to retrieve items from all those that should be recommended. This limitation exacerbates the cold start problem due to data sparsity, particularly when facing new users or items where historical data is insufficient for accurate recommendations.</p>
</div>
<div class="ltx_para" id="Sx1.p3">
<p class="ltx_p" id="Sx1.p3.1">To address the data sparsity cold start problem and effectively combine Mamba’s excellent performance in capturing dependencies in long interaction sequences with Transformer’s advantages in handling short interaction sequences and global attention mechanisms, we propose a novel sequence recommendation model—MaTrRec. MaTrRec leverages Mamba’s strong capability in capturing long sequence dependencies, while integrating Transformer’s strengths in managing dependencies and global attention in short sequences. This model aims to balance performance across both long and short interaction sequences, significantly improving the cold start issue caused by data sparsity in recommendation systems. Extensive experiments conducted on five publicly available datasets demonstrate substantial improvements across multiple metrics, effectively mitigating the data sparsity cold start problem. Our model comprehensively outperforms various state-of-the-art baseline models.The main contributions of this work are as follows:</p>
<ul class="ltx_itemize" id="Sx1.I1">
<li class="ltx_item" id="Sx1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i1.p1">
<p class="ltx_p" id="Sx1.I1.i1.p1.1">We are the first to combine Mamba and Transformer for sequence recommendation.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i2.p1">
<p class="ltx_p" id="Sx1.I1.i2.p1.1">Effectively mitigated the data sparsity cold start problem in recommendation systems.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i3.p1">
<p class="ltx_p" id="Sx1.I1.i3.p1.1">Conducted extensive experiments on five publicly available real-world datasets, showing that MaTrRec outperforms existing baseline models in both long and short interaction sequences, demonstrating its applicability and superiority across different scenarios.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i4.p1">
<p class="ltx_p" id="Sx1.I1.i4.p1.1">Performed a series of ablation experiments to thoroughly analyze the contributions of each model component, validating their effectiveness in enhancing overall model performance.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Preparation Work</h2>
<section class="ltx_subsection" id="Sx2.SSx1">
<h3 class="ltx_title ltx_title_subsection">Sequential Recommendation</h3>
<div class="ltx_para" id="Sx2.SSx1.p1">
<p class="ltx_p" id="Sx2.SSx1.p1.1">In recent years, sequential recommendation technology has evolved from traditional statistical models to deep learning models, continually exploring how to more accurately capture the dynamic evolution of user interests. Early work focused mainly on Markov Chain-based methods<cite class="ltx_cite ltx_citemacro_citep">(He and McAuley <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib8" title="">2016</a>; Koren, Bell, and Volinsky <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib12" title="">2009</a>)</cite>, which, although capable of initially considering sequence characteristics, had limitations in handling high-dimensional sparse data and recognizing patterns in long interaction sequences. Subsequently, Recurrent Neural Networks (RNNs)<cite class="ltx_cite ltx_citemacro_citep">(Donkers, Loepp, and Ziegler <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib2" title="">2017</a>; Li et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib13" title="">2017</a>)</cite> and their variants, such as Long Short-Term Memory (LSTM)<cite class="ltx_cite ltx_citemacro_citep">(Yao et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib28" title="">2018</a>)</cite> and Gated Recurrent Unit (GRU)<cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib9" title="">2016</a>)</cite>, were widely applied to sequential recommendation due to their superior capabilities in sequence modeling. These models effectively solve the long-range dependency problem by passing information through hidden states. Recently, inspired by the Transformer model, the self-attention mechanism has been introduced into the sequential recommendation field. Representative works like SASRec<cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib11" title="">2018</a>)</cite> and BERT4Rec<cite class="ltx_cite ltx_citemacro_citep">(Sun et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib21" title="">2019</a>)</cite> directly model the interdependencies among all elements in a sequence, demonstrating strong capabilities in capturing sequence patterns. Researchers recently introduced Mamba into sequential recommendation systems, proposing the Mamba4Rec<cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib16" title="">2024</a>)</cite> model, which has shown excellent performance on long interaction sequences.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx2.SSx2">
<h3 class="ltx_title ltx_title_subsection">Transformer and Mamba</h3>
<div class="ltx_para" id="Sx2.SSx2.p1">
<p class="ltx_p" id="Sx2.SSx2.p1.1">The Transformer model leverages the self-attention mechanism to capture dependencies among elements in a sequence. By parallelizing computations, the Transformer effectively addresses long-range dependencies without relying on sequential processing. Transformer models are widely applied in various fields, such as natural language processing (NLP) with BERT (Bidirectional Encoder Representations from Transformers)<cite class="ltx_cite ltx_citemacro_citep">(Devlin et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib1" title="">2019</a>)</cite> and GPT (Generative Pre-trained Transformer)<cite class="ltx_cite ltx_citemacro_citep">(Radford and Narasimhan <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib20" title="">2018</a>)</cite>, computer vision with Vision Transformer (ViT)<cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib3" title="">2020</a>)</cite>, and sequential recommendation systems like SASRec and BERT4Rec. These applications utilize the Transformer’s ability to model user interaction sequences, providing precise personalized recommendations.</p>
</div>
<div class="ltx_para" id="Sx2.SSx2.p2">
<p class="ltx_p" id="Sx2.SSx2.p2.1">The latest architecture in structured state space models (SSMs), Mamba, excels in handling long sequence tasks due to its linear computational complexity with respect to sequence length during inference. Mamba has been subsequently applied in the visual domain, leading to the Vision Mamba model<cite class="ltx_cite ltx_citemacro_citep">(Zhu et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib31" title="">2024</a>)</cite>, and has found extensive use in medical imaging<cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib26" title="">2024</a>)</cite>. Recently, researchers introduced Mamba into sequential recommendation systems with the Mamba4Rec model, demonstrating Mamba’s feasibility in this domain<cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib16" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="Sx2.SSx2.p3">
<p class="ltx_p" id="Sx2.SSx2.p3.1">Recently, researchers have begun exploring how to fully leverage the complementary advantages of Mamba and Transformer models, striving to find effective ways to integrate them. Jamba<cite class="ltx_cite ltx_citemacro_citep">(Lieber et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib14" title="">2024</a>)</cite> is the first large-scale model successfully integrating the Mamba structured state space model with Transformer architecture.Mambaformer<cite class="ltx_cite ltx_citemacro_citep">(Xu et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib27" title="">2024</a>)</cite> is a hybrid model designed specifically for time series prediction.</p>
</div>
</section>
</section>
<section class="ltx_section" id="Sx3">
<h2 class="ltx_title ltx_title_section">MaTrRec</h2>
<div class="ltx_para" id="Sx3.p1">
<p class="ltx_p" id="Sx3.p1.1">In this chapter, we detail the structure and implementation of the proposed hybrid model MaTrRec, which is based on Mamba and Transformer.</p>
</div>
<figure class="ltx_figure" id="Sx3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="587" id="Sx3.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The framework of MaTrRec</figcaption>
</figure>
<section class="ltx_subsection" id="Sx3.SSx1">
<h3 class="ltx_title ltx_title_subsection">Problem Statement</h3>
<div class="ltx_para" id="Sx3.SSx1.p1">
<p class="ltx_p" id="Sx3.SSx1.p1.8">In a recommendation system, <math alttext="\mathcal{U}=\{u_{1},u_{2},\ldots,u_{|\mathcal{U}|}\}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.1.m1.5"><semantics id="Sx3.SSx1.p1.1.m1.5a"><mrow id="Sx3.SSx1.p1.1.m1.5.5" xref="Sx3.SSx1.p1.1.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.1.m1.5.5.5" xref="Sx3.SSx1.p1.1.m1.5.5.5.cmml">𝒰</mi><mo id="Sx3.SSx1.p1.1.m1.5.5.4" xref="Sx3.SSx1.p1.1.m1.5.5.4.cmml">=</mo><mrow id="Sx3.SSx1.p1.1.m1.5.5.3.3" xref="Sx3.SSx1.p1.1.m1.5.5.3.4.cmml"><mo id="Sx3.SSx1.p1.1.m1.5.5.3.3.4" stretchy="false" xref="Sx3.SSx1.p1.1.m1.5.5.3.4.cmml">{</mo><msub id="Sx3.SSx1.p1.1.m1.3.3.1.1.1" xref="Sx3.SSx1.p1.1.m1.3.3.1.1.1.cmml"><mi id="Sx3.SSx1.p1.1.m1.3.3.1.1.1.2" xref="Sx3.SSx1.p1.1.m1.3.3.1.1.1.2.cmml">u</mi><mn id="Sx3.SSx1.p1.1.m1.3.3.1.1.1.3" xref="Sx3.SSx1.p1.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx1.p1.1.m1.5.5.3.3.5" xref="Sx3.SSx1.p1.1.m1.5.5.3.4.cmml">,</mo><msub id="Sx3.SSx1.p1.1.m1.4.4.2.2.2" xref="Sx3.SSx1.p1.1.m1.4.4.2.2.2.cmml"><mi id="Sx3.SSx1.p1.1.m1.4.4.2.2.2.2" xref="Sx3.SSx1.p1.1.m1.4.4.2.2.2.2.cmml">u</mi><mn id="Sx3.SSx1.p1.1.m1.4.4.2.2.2.3" xref="Sx3.SSx1.p1.1.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="Sx3.SSx1.p1.1.m1.5.5.3.3.6" xref="Sx3.SSx1.p1.1.m1.5.5.3.4.cmml">,</mo><mi id="Sx3.SSx1.p1.1.m1.2.2" mathvariant="normal" xref="Sx3.SSx1.p1.1.m1.2.2.cmml">…</mi><mo id="Sx3.SSx1.p1.1.m1.5.5.3.3.7" xref="Sx3.SSx1.p1.1.m1.5.5.3.4.cmml">,</mo><msub id="Sx3.SSx1.p1.1.m1.5.5.3.3.3" xref="Sx3.SSx1.p1.1.m1.5.5.3.3.3.cmml"><mi id="Sx3.SSx1.p1.1.m1.5.5.3.3.3.2" xref="Sx3.SSx1.p1.1.m1.5.5.3.3.3.2.cmml">u</mi><mrow id="Sx3.SSx1.p1.1.m1.1.1.1.3" xref="Sx3.SSx1.p1.1.m1.1.1.1.2.cmml"><mo id="Sx3.SSx1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="Sx3.SSx1.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.1.m1.1.1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.1.1.cmml">𝒰</mi><mo id="Sx3.SSx1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="Sx3.SSx1.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="Sx3.SSx1.p1.1.m1.5.5.3.3.8" stretchy="false" xref="Sx3.SSx1.p1.1.m1.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.1.m1.5b"><apply id="Sx3.SSx1.p1.1.m1.5.5.cmml" xref="Sx3.SSx1.p1.1.m1.5.5"><eq id="Sx3.SSx1.p1.1.m1.5.5.4.cmml" xref="Sx3.SSx1.p1.1.m1.5.5.4"></eq><ci id="Sx3.SSx1.p1.1.m1.5.5.5.cmml" xref="Sx3.SSx1.p1.1.m1.5.5.5">𝒰</ci><set id="Sx3.SSx1.p1.1.m1.5.5.3.4.cmml" xref="Sx3.SSx1.p1.1.m1.5.5.3.3"><apply id="Sx3.SSx1.p1.1.m1.3.3.1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.1.m1.3.3.1.1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.1.m1.3.3.1.1.1.2.cmml" xref="Sx3.SSx1.p1.1.m1.3.3.1.1.1.2">𝑢</ci><cn id="Sx3.SSx1.p1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="Sx3.SSx1.p1.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="Sx3.SSx1.p1.1.m1.4.4.2.2.2.cmml" xref="Sx3.SSx1.p1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.1.m1.4.4.2.2.2.1.cmml" xref="Sx3.SSx1.p1.1.m1.4.4.2.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.1.m1.4.4.2.2.2.2.cmml" xref="Sx3.SSx1.p1.1.m1.4.4.2.2.2.2">𝑢</ci><cn id="Sx3.SSx1.p1.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="Sx3.SSx1.p1.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="Sx3.SSx1.p1.1.m1.2.2.cmml" xref="Sx3.SSx1.p1.1.m1.2.2">…</ci><apply id="Sx3.SSx1.p1.1.m1.5.5.3.3.3.cmml" xref="Sx3.SSx1.p1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.1.m1.5.5.3.3.3.1.cmml" xref="Sx3.SSx1.p1.1.m1.5.5.3.3.3">subscript</csymbol><ci id="Sx3.SSx1.p1.1.m1.5.5.3.3.3.2.cmml" xref="Sx3.SSx1.p1.1.m1.5.5.3.3.3.2">𝑢</ci><apply id="Sx3.SSx1.p1.1.m1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.1.3"><abs id="Sx3.SSx1.p1.1.m1.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.1.3.1"></abs><ci id="Sx3.SSx1.p1.1.m1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.1.1">𝒰</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.1.m1.5c">\mathcal{U}=\{u_{1},u_{2},\ldots,u_{|\mathcal{U}|}\}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.1.m1.5d">caligraphic_U = { italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_u start_POSTSUBSCRIPT | caligraphic_U | end_POSTSUBSCRIPT }</annotation></semantics></math> denotes users, <math alttext="\mathcal{V}=\{v_{1},v_{2},\ldots,v_{|\mathcal{V}|}\}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.2.m2.5"><semantics id="Sx3.SSx1.p1.2.m2.5a"><mrow id="Sx3.SSx1.p1.2.m2.5.5" xref="Sx3.SSx1.p1.2.m2.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.2.m2.5.5.5" xref="Sx3.SSx1.p1.2.m2.5.5.5.cmml">𝒱</mi><mo id="Sx3.SSx1.p1.2.m2.5.5.4" xref="Sx3.SSx1.p1.2.m2.5.5.4.cmml">=</mo><mrow id="Sx3.SSx1.p1.2.m2.5.5.3.3" xref="Sx3.SSx1.p1.2.m2.5.5.3.4.cmml"><mo id="Sx3.SSx1.p1.2.m2.5.5.3.3.4" stretchy="false" xref="Sx3.SSx1.p1.2.m2.5.5.3.4.cmml">{</mo><msub id="Sx3.SSx1.p1.2.m2.3.3.1.1.1" xref="Sx3.SSx1.p1.2.m2.3.3.1.1.1.cmml"><mi id="Sx3.SSx1.p1.2.m2.3.3.1.1.1.2" xref="Sx3.SSx1.p1.2.m2.3.3.1.1.1.2.cmml">v</mi><mn id="Sx3.SSx1.p1.2.m2.3.3.1.1.1.3" xref="Sx3.SSx1.p1.2.m2.3.3.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx1.p1.2.m2.5.5.3.3.5" xref="Sx3.SSx1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="Sx3.SSx1.p1.2.m2.4.4.2.2.2" xref="Sx3.SSx1.p1.2.m2.4.4.2.2.2.cmml"><mi id="Sx3.SSx1.p1.2.m2.4.4.2.2.2.2" xref="Sx3.SSx1.p1.2.m2.4.4.2.2.2.2.cmml">v</mi><mn id="Sx3.SSx1.p1.2.m2.4.4.2.2.2.3" xref="Sx3.SSx1.p1.2.m2.4.4.2.2.2.3.cmml">2</mn></msub><mo id="Sx3.SSx1.p1.2.m2.5.5.3.3.6" xref="Sx3.SSx1.p1.2.m2.5.5.3.4.cmml">,</mo><mi id="Sx3.SSx1.p1.2.m2.2.2" mathvariant="normal" xref="Sx3.SSx1.p1.2.m2.2.2.cmml">…</mi><mo id="Sx3.SSx1.p1.2.m2.5.5.3.3.7" xref="Sx3.SSx1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="Sx3.SSx1.p1.2.m2.5.5.3.3.3" xref="Sx3.SSx1.p1.2.m2.5.5.3.3.3.cmml"><mi id="Sx3.SSx1.p1.2.m2.5.5.3.3.3.2" xref="Sx3.SSx1.p1.2.m2.5.5.3.3.3.2.cmml">v</mi><mrow id="Sx3.SSx1.p1.2.m2.1.1.1.3" xref="Sx3.SSx1.p1.2.m2.1.1.1.2.cmml"><mo id="Sx3.SSx1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="Sx3.SSx1.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.2.m2.1.1.1.1" xref="Sx3.SSx1.p1.2.m2.1.1.1.1.cmml">𝒱</mi><mo id="Sx3.SSx1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="Sx3.SSx1.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="Sx3.SSx1.p1.2.m2.5.5.3.3.8" stretchy="false" xref="Sx3.SSx1.p1.2.m2.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.2.m2.5b"><apply id="Sx3.SSx1.p1.2.m2.5.5.cmml" xref="Sx3.SSx1.p1.2.m2.5.5"><eq id="Sx3.SSx1.p1.2.m2.5.5.4.cmml" xref="Sx3.SSx1.p1.2.m2.5.5.4"></eq><ci id="Sx3.SSx1.p1.2.m2.5.5.5.cmml" xref="Sx3.SSx1.p1.2.m2.5.5.5">𝒱</ci><set id="Sx3.SSx1.p1.2.m2.5.5.3.4.cmml" xref="Sx3.SSx1.p1.2.m2.5.5.3.3"><apply id="Sx3.SSx1.p1.2.m2.3.3.1.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.2.m2.3.3.1.1.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.3.3.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.2.m2.3.3.1.1.1.2.cmml" xref="Sx3.SSx1.p1.2.m2.3.3.1.1.1.2">𝑣</ci><cn id="Sx3.SSx1.p1.2.m2.3.3.1.1.1.3.cmml" type="integer" xref="Sx3.SSx1.p1.2.m2.3.3.1.1.1.3">1</cn></apply><apply id="Sx3.SSx1.p1.2.m2.4.4.2.2.2.cmml" xref="Sx3.SSx1.p1.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.2.m2.4.4.2.2.2.1.cmml" xref="Sx3.SSx1.p1.2.m2.4.4.2.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.2.m2.4.4.2.2.2.2.cmml" xref="Sx3.SSx1.p1.2.m2.4.4.2.2.2.2">𝑣</ci><cn id="Sx3.SSx1.p1.2.m2.4.4.2.2.2.3.cmml" type="integer" xref="Sx3.SSx1.p1.2.m2.4.4.2.2.2.3">2</cn></apply><ci id="Sx3.SSx1.p1.2.m2.2.2.cmml" xref="Sx3.SSx1.p1.2.m2.2.2">…</ci><apply id="Sx3.SSx1.p1.2.m2.5.5.3.3.3.cmml" xref="Sx3.SSx1.p1.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.2.m2.5.5.3.3.3.1.cmml" xref="Sx3.SSx1.p1.2.m2.5.5.3.3.3">subscript</csymbol><ci id="Sx3.SSx1.p1.2.m2.5.5.3.3.3.2.cmml" xref="Sx3.SSx1.p1.2.m2.5.5.3.3.3.2">𝑣</ci><apply id="Sx3.SSx1.p1.2.m2.1.1.1.2.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.1.3"><abs id="Sx3.SSx1.p1.2.m2.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.1.3.1"></abs><ci id="Sx3.SSx1.p1.2.m2.1.1.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.1.1">𝒱</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.2.m2.5c">\mathcal{V}=\{v_{1},v_{2},\ldots,v_{|\mathcal{V}|}\}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.2.m2.5d">caligraphic_V = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT | caligraphic_V | end_POSTSUBSCRIPT }</annotation></semantics></math> denotes items, and <math alttext="S_{u}=\{v_{1}^{(u)},v_{2}^{(u)},\ldots,v_{n}^{(u)}\}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.3.m3.7"><semantics id="Sx3.SSx1.p1.3.m3.7a"><mrow id="Sx3.SSx1.p1.3.m3.7.7" xref="Sx3.SSx1.p1.3.m3.7.7.cmml"><msub id="Sx3.SSx1.p1.3.m3.7.7.5" xref="Sx3.SSx1.p1.3.m3.7.7.5.cmml"><mi id="Sx3.SSx1.p1.3.m3.7.7.5.2" xref="Sx3.SSx1.p1.3.m3.7.7.5.2.cmml">S</mi><mi id="Sx3.SSx1.p1.3.m3.7.7.5.3" xref="Sx3.SSx1.p1.3.m3.7.7.5.3.cmml">u</mi></msub><mo id="Sx3.SSx1.p1.3.m3.7.7.4" xref="Sx3.SSx1.p1.3.m3.7.7.4.cmml">=</mo><mrow id="Sx3.SSx1.p1.3.m3.7.7.3.3" xref="Sx3.SSx1.p1.3.m3.7.7.3.4.cmml"><mo id="Sx3.SSx1.p1.3.m3.7.7.3.3.4" stretchy="false" xref="Sx3.SSx1.p1.3.m3.7.7.3.4.cmml">{</mo><msubsup id="Sx3.SSx1.p1.3.m3.5.5.1.1.1" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1.cmml"><mi id="Sx3.SSx1.p1.3.m3.5.5.1.1.1.2.2" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1.2.2.cmml">v</mi><mn id="Sx3.SSx1.p1.3.m3.5.5.1.1.1.2.3" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1.2.3.cmml">1</mn><mrow id="Sx3.SSx1.p1.3.m3.1.1.1.3" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1.cmml"><mo id="Sx3.SSx1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1.cmml">(</mo><mi id="Sx3.SSx1.p1.3.m3.1.1.1.1" xref="Sx3.SSx1.p1.3.m3.1.1.1.1.cmml">u</mi><mo id="Sx3.SSx1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="Sx3.SSx1.p1.3.m3.7.7.3.3.5" xref="Sx3.SSx1.p1.3.m3.7.7.3.4.cmml">,</mo><msubsup id="Sx3.SSx1.p1.3.m3.6.6.2.2.2" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2.cmml"><mi id="Sx3.SSx1.p1.3.m3.6.6.2.2.2.2.2" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2.2.2.cmml">v</mi><mn id="Sx3.SSx1.p1.3.m3.6.6.2.2.2.2.3" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2.2.3.cmml">2</mn><mrow id="Sx3.SSx1.p1.3.m3.2.2.1.3" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2.cmml"><mo id="Sx3.SSx1.p1.3.m3.2.2.1.3.1" stretchy="false" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2.cmml">(</mo><mi id="Sx3.SSx1.p1.3.m3.2.2.1.1" xref="Sx3.SSx1.p1.3.m3.2.2.1.1.cmml">u</mi><mo id="Sx3.SSx1.p1.3.m3.2.2.1.3.2" stretchy="false" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2.cmml">)</mo></mrow></msubsup><mo id="Sx3.SSx1.p1.3.m3.7.7.3.3.6" xref="Sx3.SSx1.p1.3.m3.7.7.3.4.cmml">,</mo><mi id="Sx3.SSx1.p1.3.m3.4.4" mathvariant="normal" xref="Sx3.SSx1.p1.3.m3.4.4.cmml">…</mi><mo id="Sx3.SSx1.p1.3.m3.7.7.3.3.7" xref="Sx3.SSx1.p1.3.m3.7.7.3.4.cmml">,</mo><msubsup id="Sx3.SSx1.p1.3.m3.7.7.3.3.3" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3.cmml"><mi id="Sx3.SSx1.p1.3.m3.7.7.3.3.3.2.2" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3.2.2.cmml">v</mi><mi id="Sx3.SSx1.p1.3.m3.7.7.3.3.3.2.3" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3.2.3.cmml">n</mi><mrow id="Sx3.SSx1.p1.3.m3.3.3.1.3" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3.cmml"><mo id="Sx3.SSx1.p1.3.m3.3.3.1.3.1" stretchy="false" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3.cmml">(</mo><mi id="Sx3.SSx1.p1.3.m3.3.3.1.1" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.cmml">u</mi><mo id="Sx3.SSx1.p1.3.m3.3.3.1.3.2" stretchy="false" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3.cmml">)</mo></mrow></msubsup><mo id="Sx3.SSx1.p1.3.m3.7.7.3.3.8" stretchy="false" xref="Sx3.SSx1.p1.3.m3.7.7.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.3.m3.7b"><apply id="Sx3.SSx1.p1.3.m3.7.7.cmml" xref="Sx3.SSx1.p1.3.m3.7.7"><eq id="Sx3.SSx1.p1.3.m3.7.7.4.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.4"></eq><apply id="Sx3.SSx1.p1.3.m3.7.7.5.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.5"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.7.7.5.1.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.5">subscript</csymbol><ci id="Sx3.SSx1.p1.3.m3.7.7.5.2.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.5.2">𝑆</ci><ci id="Sx3.SSx1.p1.3.m3.7.7.5.3.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.5.3">𝑢</ci></apply><set id="Sx3.SSx1.p1.3.m3.7.7.3.4.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.3.3"><apply id="Sx3.SSx1.p1.3.m3.5.5.1.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.5.5.1.1.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1">superscript</csymbol><apply id="Sx3.SSx1.p1.3.m3.5.5.1.1.1.2.cmml" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.5.5.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.3.m3.5.5.1.1.1.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1.2.2">𝑣</ci><cn id="Sx3.SSx1.p1.3.m3.5.5.1.1.1.2.3.cmml" type="integer" xref="Sx3.SSx1.p1.3.m3.5.5.1.1.1.2.3">1</cn></apply><ci id="Sx3.SSx1.p1.3.m3.1.1.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1.1.1">𝑢</ci></apply><apply id="Sx3.SSx1.p1.3.m3.6.6.2.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.6.6.2.2.2.1.cmml" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2">superscript</csymbol><apply id="Sx3.SSx1.p1.3.m3.6.6.2.2.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.6.6.2.2.2.2.1.cmml" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.3.m3.6.6.2.2.2.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2.2.2">𝑣</ci><cn id="Sx3.SSx1.p1.3.m3.6.6.2.2.2.2.3.cmml" type="integer" xref="Sx3.SSx1.p1.3.m3.6.6.2.2.2.2.3">2</cn></apply><ci id="Sx3.SSx1.p1.3.m3.2.2.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.2.2.1.1">𝑢</ci></apply><ci id="Sx3.SSx1.p1.3.m3.4.4.cmml" xref="Sx3.SSx1.p1.3.m3.4.4">…</ci><apply id="Sx3.SSx1.p1.3.m3.7.7.3.3.3.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.7.7.3.3.3.1.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3">superscript</csymbol><apply id="Sx3.SSx1.p1.3.m3.7.7.3.3.3.2.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.7.7.3.3.3.2.1.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3">subscript</csymbol><ci id="Sx3.SSx1.p1.3.m3.7.7.3.3.3.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3.2.2">𝑣</ci><ci id="Sx3.SSx1.p1.3.m3.7.7.3.3.3.2.3.cmml" xref="Sx3.SSx1.p1.3.m3.7.7.3.3.3.2.3">𝑛</ci></apply><ci id="Sx3.SSx1.p1.3.m3.3.3.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.3.3.1.1">𝑢</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.3.m3.7c">S_{u}=\{v_{1}^{(u)},v_{2}^{(u)},\ldots,v_{n}^{(u)}\}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.3.m3.7d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT }</annotation></semantics></math> denotes the interaction sequence of user <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.4.m4.1"><semantics id="Sx3.SSx1.p1.4.m4.1a"><mrow id="Sx3.SSx1.p1.4.m4.1.1" xref="Sx3.SSx1.p1.4.m4.1.1.cmml"><mi id="Sx3.SSx1.p1.4.m4.1.1.2" xref="Sx3.SSx1.p1.4.m4.1.1.2.cmml">u</mi><mo id="Sx3.SSx1.p1.4.m4.1.1.1" xref="Sx3.SSx1.p1.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.4.m4.1.1.3" xref="Sx3.SSx1.p1.4.m4.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.4.m4.1b"><apply id="Sx3.SSx1.p1.4.m4.1.1.cmml" xref="Sx3.SSx1.p1.4.m4.1.1"><in id="Sx3.SSx1.p1.4.m4.1.1.1.cmml" xref="Sx3.SSx1.p1.4.m4.1.1.1"></in><ci id="Sx3.SSx1.p1.4.m4.1.1.2.cmml" xref="Sx3.SSx1.p1.4.m4.1.1.2">𝑢</ci><ci id="Sx3.SSx1.p1.4.m4.1.1.3.cmml" xref="Sx3.SSx1.p1.4.m4.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.4.m4.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.4.m4.1d">italic_u ∈ caligraphic_U</annotation></semantics></math> in chronological order, where <math alttext="v_{i}^{(u)}\in\mathcal{V}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.5.m5.1"><semantics id="Sx3.SSx1.p1.5.m5.1a"><mrow id="Sx3.SSx1.p1.5.m5.1.2" xref="Sx3.SSx1.p1.5.m5.1.2.cmml"><msubsup id="Sx3.SSx1.p1.5.m5.1.2.2" xref="Sx3.SSx1.p1.5.m5.1.2.2.cmml"><mi id="Sx3.SSx1.p1.5.m5.1.2.2.2.2" xref="Sx3.SSx1.p1.5.m5.1.2.2.2.2.cmml">v</mi><mi id="Sx3.SSx1.p1.5.m5.1.2.2.2.3" xref="Sx3.SSx1.p1.5.m5.1.2.2.2.3.cmml">i</mi><mrow id="Sx3.SSx1.p1.5.m5.1.1.1.3" xref="Sx3.SSx1.p1.5.m5.1.2.2.cmml"><mo id="Sx3.SSx1.p1.5.m5.1.1.1.3.1" stretchy="false" xref="Sx3.SSx1.p1.5.m5.1.2.2.cmml">(</mo><mi id="Sx3.SSx1.p1.5.m5.1.1.1.1" xref="Sx3.SSx1.p1.5.m5.1.1.1.1.cmml">u</mi><mo id="Sx3.SSx1.p1.5.m5.1.1.1.3.2" stretchy="false" xref="Sx3.SSx1.p1.5.m5.1.2.2.cmml">)</mo></mrow></msubsup><mo id="Sx3.SSx1.p1.5.m5.1.2.1" xref="Sx3.SSx1.p1.5.m5.1.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.5.m5.1.2.3" xref="Sx3.SSx1.p1.5.m5.1.2.3.cmml">𝒱</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.5.m5.1b"><apply id="Sx3.SSx1.p1.5.m5.1.2.cmml" xref="Sx3.SSx1.p1.5.m5.1.2"><in id="Sx3.SSx1.p1.5.m5.1.2.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.2.1"></in><apply id="Sx3.SSx1.p1.5.m5.1.2.2.cmml" xref="Sx3.SSx1.p1.5.m5.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.5.m5.1.2.2.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.2.2">superscript</csymbol><apply id="Sx3.SSx1.p1.5.m5.1.2.2.2.cmml" xref="Sx3.SSx1.p1.5.m5.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.5.m5.1.2.2.2.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.5.m5.1.2.2.2.2.cmml" xref="Sx3.SSx1.p1.5.m5.1.2.2.2.2">𝑣</ci><ci id="Sx3.SSx1.p1.5.m5.1.2.2.2.3.cmml" xref="Sx3.SSx1.p1.5.m5.1.2.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx1.p1.5.m5.1.1.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.1.1.1">𝑢</ci></apply><ci id="Sx3.SSx1.p1.5.m5.1.2.3.cmml" xref="Sx3.SSx1.p1.5.m5.1.2.3">𝒱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.5.m5.1c">v_{i}^{(u)}\in\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.5.m5.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT ∈ caligraphic_V</annotation></semantics></math>. The goal of sequential recommendation is to predict the next item <math alttext="v_{n+1}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.6.m6.1"><semantics id="Sx3.SSx1.p1.6.m6.1a"><msub id="Sx3.SSx1.p1.6.m6.1.1" xref="Sx3.SSx1.p1.6.m6.1.1.cmml"><mi id="Sx3.SSx1.p1.6.m6.1.1.2" xref="Sx3.SSx1.p1.6.m6.1.1.2.cmml">v</mi><mrow id="Sx3.SSx1.p1.6.m6.1.1.3" xref="Sx3.SSx1.p1.6.m6.1.1.3.cmml"><mi id="Sx3.SSx1.p1.6.m6.1.1.3.2" xref="Sx3.SSx1.p1.6.m6.1.1.3.2.cmml">n</mi><mo id="Sx3.SSx1.p1.6.m6.1.1.3.1" xref="Sx3.SSx1.p1.6.m6.1.1.3.1.cmml">+</mo><mn id="Sx3.SSx1.p1.6.m6.1.1.3.3" xref="Sx3.SSx1.p1.6.m6.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.6.m6.1b"><apply id="Sx3.SSx1.p1.6.m6.1.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.6.m6.1.1.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.6.m6.1.1.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.2">𝑣</ci><apply id="Sx3.SSx1.p1.6.m6.1.1.3.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.3"><plus id="Sx3.SSx1.p1.6.m6.1.1.3.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.3.1"></plus><ci id="Sx3.SSx1.p1.6.m6.1.1.3.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.3.2">𝑛</ci><cn id="Sx3.SSx1.p1.6.m6.1.1.3.3.cmml" type="integer" xref="Sx3.SSx1.p1.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.6.m6.1c">v_{n+1}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math> that user <math alttext="u" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.7.m7.1"><semantics id="Sx3.SSx1.p1.7.m7.1a"><mi id="Sx3.SSx1.p1.7.m7.1.1" xref="Sx3.SSx1.p1.7.m7.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.7.m7.1b"><ci id="Sx3.SSx1.p1.7.m7.1.1.cmml" xref="Sx3.SSx1.p1.7.m7.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.7.m7.1c">u</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.7.m7.1d">italic_u</annotation></semantics></math> will interact with, given their interaction history <math alttext="S_{u}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.8.m8.1"><semantics id="Sx3.SSx1.p1.8.m8.1a"><msub id="Sx3.SSx1.p1.8.m8.1.1" xref="Sx3.SSx1.p1.8.m8.1.1.cmml"><mi id="Sx3.SSx1.p1.8.m8.1.1.2" xref="Sx3.SSx1.p1.8.m8.1.1.2.cmml">S</mi><mi id="Sx3.SSx1.p1.8.m8.1.1.3" xref="Sx3.SSx1.p1.8.m8.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.8.m8.1b"><apply id="Sx3.SSx1.p1.8.m8.1.1.cmml" xref="Sx3.SSx1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.8.m8.1.1.1.cmml" xref="Sx3.SSx1.p1.8.m8.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.8.m8.1.1.2.cmml" xref="Sx3.SSx1.p1.8.m8.1.1.2">𝑆</ci><ci id="Sx3.SSx1.p1.8.m8.1.1.3.cmml" xref="Sx3.SSx1.p1.8.m8.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.8.m8.1c">S_{u}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.8.m8.1d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx2">
<h3 class="ltx_title ltx_title_subsection">Model Architecture</h3>
<div class="ltx_para" id="Sx3.SSx2.p1">
<p class="ltx_p" id="Sx3.SSx2.p1.1">The MaTrRec model consists of the following modules: the embedding module maps item IDs to a high-dimensional space; the Mamba module includes two Mamba blocks, with the first capturing preliminary sequence information and the second refining this information; the Transformer Encoder<cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib24" title="">2017</a>)</cite> module utilizes multi-head attention and feed-forward neural networks to extract and process information; the feed-forward neural network further extracts and transforms features; residual connections<cite class="ltx_cite ltx_citemacro_citep">(He et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib7" title="">2016</a>)</cite> enhance the overall performance and stability; finally, the prediction layer uses the Softmax function for the final prediction.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx3">
<h3 class="ltx_title ltx_title_subsection">Embedding Layer</h3>
<div class="ltx_para" id="Sx3.SSx3.p1">
<p class="ltx_p" id="Sx3.SSx3.p1.5">We use an embedding layer to map item IDs to a high-dimensional space. Let the embedding matrix be <math alttext="E\in\mathbb{R}^{\left|\mathcal{V}\right|\times D}" class="ltx_Math" display="inline" id="Sx3.SSx3.p1.1.m1.1"><semantics id="Sx3.SSx3.p1.1.m1.1a"><mrow id="Sx3.SSx3.p1.1.m1.1.2" xref="Sx3.SSx3.p1.1.m1.1.2.cmml"><mi id="Sx3.SSx3.p1.1.m1.1.2.2" xref="Sx3.SSx3.p1.1.m1.1.2.2.cmml">E</mi><mo id="Sx3.SSx3.p1.1.m1.1.2.1" xref="Sx3.SSx3.p1.1.m1.1.2.1.cmml">∈</mo><msup id="Sx3.SSx3.p1.1.m1.1.2.3" xref="Sx3.SSx3.p1.1.m1.1.2.3.cmml"><mi id="Sx3.SSx3.p1.1.m1.1.2.3.2" xref="Sx3.SSx3.p1.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx3.p1.1.m1.1.1.1" xref="Sx3.SSx3.p1.1.m1.1.1.1.cmml"><mrow id="Sx3.SSx3.p1.1.m1.1.1.1.3.2" xref="Sx3.SSx3.p1.1.m1.1.1.1.3.1.cmml"><mo id="Sx3.SSx3.p1.1.m1.1.1.1.3.2.1" xref="Sx3.SSx3.p1.1.m1.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p1.1.m1.1.1.1.1" xref="Sx3.SSx3.p1.1.m1.1.1.1.1.cmml">𝒱</mi><mo id="Sx3.SSx3.p1.1.m1.1.1.1.3.2.2" rspace="0.055em" xref="Sx3.SSx3.p1.1.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="Sx3.SSx3.p1.1.m1.1.1.1.2" rspace="0.222em" xref="Sx3.SSx3.p1.1.m1.1.1.1.2.cmml">×</mo><mi id="Sx3.SSx3.p1.1.m1.1.1.1.4" xref="Sx3.SSx3.p1.1.m1.1.1.1.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.1.m1.1b"><apply id="Sx3.SSx3.p1.1.m1.1.2.cmml" xref="Sx3.SSx3.p1.1.m1.1.2"><in id="Sx3.SSx3.p1.1.m1.1.2.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.2.1"></in><ci id="Sx3.SSx3.p1.1.m1.1.2.2.cmml" xref="Sx3.SSx3.p1.1.m1.1.2.2">𝐸</ci><apply id="Sx3.SSx3.p1.1.m1.1.2.3.cmml" xref="Sx3.SSx3.p1.1.m1.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.1.m1.1.2.3.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.2.3">superscript</csymbol><ci id="Sx3.SSx3.p1.1.m1.1.2.3.2.cmml" xref="Sx3.SSx3.p1.1.m1.1.2.3.2">ℝ</ci><apply id="Sx3.SSx3.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.1"><times id="Sx3.SSx3.p1.1.m1.1.1.1.2.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.1.2"></times><apply id="Sx3.SSx3.p1.1.m1.1.1.1.3.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.1.3.2"><abs id="Sx3.SSx3.p1.1.m1.1.1.1.3.1.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.1.3.2.1"></abs><ci id="Sx3.SSx3.p1.1.m1.1.1.1.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.1.1">𝒱</ci></apply><ci id="Sx3.SSx3.p1.1.m1.1.1.1.4.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.1.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.1.m1.1c">E\in\mathbb{R}^{\left|\mathcal{V}\right|\times D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx3.p1.1.m1.1d">italic_E ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_V | × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>,where <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="Sx3.SSx3.p1.2.m2.1"><semantics id="Sx3.SSx3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p1.2.m2.1.1" xref="Sx3.SSx3.p1.2.m2.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.2.m2.1b"><ci id="Sx3.SSx3.p1.2.m2.1.1.cmml" xref="Sx3.SSx3.p1.2.m2.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.2.m2.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx3.p1.2.m2.1d">caligraphic_V</annotation></semantics></math> is the number of items and <math alttext="D" class="ltx_Math" display="inline" id="Sx3.SSx3.p1.3.m3.1"><semantics id="Sx3.SSx3.p1.3.m3.1a"><mi id="Sx3.SSx3.p1.3.m3.1.1" xref="Sx3.SSx3.p1.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.3.m3.1b"><ci id="Sx3.SSx3.p1.3.m3.1.1.cmml" xref="Sx3.SSx3.p1.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.3.m3.1c">D</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx3.p1.3.m3.1d">italic_D</annotation></semantics></math> is the embedding dimension.
For a user’s item sequence <math alttext="S_{u}=\{v_{1}^{(u)},v_{2}^{(u)},\ldots,v_{n}^{(u)}\}" class="ltx_Math" display="inline" id="Sx3.SSx3.p1.4.m4.7"><semantics id="Sx3.SSx3.p1.4.m4.7a"><mrow id="Sx3.SSx3.p1.4.m4.7.7" xref="Sx3.SSx3.p1.4.m4.7.7.cmml"><msub id="Sx3.SSx3.p1.4.m4.7.7.5" xref="Sx3.SSx3.p1.4.m4.7.7.5.cmml"><mi id="Sx3.SSx3.p1.4.m4.7.7.5.2" xref="Sx3.SSx3.p1.4.m4.7.7.5.2.cmml">S</mi><mi id="Sx3.SSx3.p1.4.m4.7.7.5.3" xref="Sx3.SSx3.p1.4.m4.7.7.5.3.cmml">u</mi></msub><mo id="Sx3.SSx3.p1.4.m4.7.7.4" xref="Sx3.SSx3.p1.4.m4.7.7.4.cmml">=</mo><mrow id="Sx3.SSx3.p1.4.m4.7.7.3.3" xref="Sx3.SSx3.p1.4.m4.7.7.3.4.cmml"><mo id="Sx3.SSx3.p1.4.m4.7.7.3.3.4" stretchy="false" xref="Sx3.SSx3.p1.4.m4.7.7.3.4.cmml">{</mo><msubsup id="Sx3.SSx3.p1.4.m4.5.5.1.1.1" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1.cmml"><mi id="Sx3.SSx3.p1.4.m4.5.5.1.1.1.2.2" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1.2.2.cmml">v</mi><mn id="Sx3.SSx3.p1.4.m4.5.5.1.1.1.2.3" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1.2.3.cmml">1</mn><mrow id="Sx3.SSx3.p1.4.m4.1.1.1.3" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1.cmml"><mo id="Sx3.SSx3.p1.4.m4.1.1.1.3.1" stretchy="false" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1.cmml">(</mo><mi id="Sx3.SSx3.p1.4.m4.1.1.1.1" xref="Sx3.SSx3.p1.4.m4.1.1.1.1.cmml">u</mi><mo id="Sx3.SSx3.p1.4.m4.1.1.1.3.2" stretchy="false" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="Sx3.SSx3.p1.4.m4.7.7.3.3.5" xref="Sx3.SSx3.p1.4.m4.7.7.3.4.cmml">,</mo><msubsup id="Sx3.SSx3.p1.4.m4.6.6.2.2.2" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2.cmml"><mi id="Sx3.SSx3.p1.4.m4.6.6.2.2.2.2.2" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2.2.2.cmml">v</mi><mn id="Sx3.SSx3.p1.4.m4.6.6.2.2.2.2.3" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2.2.3.cmml">2</mn><mrow id="Sx3.SSx3.p1.4.m4.2.2.1.3" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2.cmml"><mo id="Sx3.SSx3.p1.4.m4.2.2.1.3.1" stretchy="false" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2.cmml">(</mo><mi id="Sx3.SSx3.p1.4.m4.2.2.1.1" xref="Sx3.SSx3.p1.4.m4.2.2.1.1.cmml">u</mi><mo id="Sx3.SSx3.p1.4.m4.2.2.1.3.2" stretchy="false" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2.cmml">)</mo></mrow></msubsup><mo id="Sx3.SSx3.p1.4.m4.7.7.3.3.6" xref="Sx3.SSx3.p1.4.m4.7.7.3.4.cmml">,</mo><mi id="Sx3.SSx3.p1.4.m4.4.4" mathvariant="normal" xref="Sx3.SSx3.p1.4.m4.4.4.cmml">…</mi><mo id="Sx3.SSx3.p1.4.m4.7.7.3.3.7" xref="Sx3.SSx3.p1.4.m4.7.7.3.4.cmml">,</mo><msubsup id="Sx3.SSx3.p1.4.m4.7.7.3.3.3" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3.cmml"><mi id="Sx3.SSx3.p1.4.m4.7.7.3.3.3.2.2" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3.2.2.cmml">v</mi><mi id="Sx3.SSx3.p1.4.m4.7.7.3.3.3.2.3" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3.2.3.cmml">n</mi><mrow id="Sx3.SSx3.p1.4.m4.3.3.1.3" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3.cmml"><mo id="Sx3.SSx3.p1.4.m4.3.3.1.3.1" stretchy="false" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3.cmml">(</mo><mi id="Sx3.SSx3.p1.4.m4.3.3.1.1" xref="Sx3.SSx3.p1.4.m4.3.3.1.1.cmml">u</mi><mo id="Sx3.SSx3.p1.4.m4.3.3.1.3.2" stretchy="false" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3.cmml">)</mo></mrow></msubsup><mo id="Sx3.SSx3.p1.4.m4.7.7.3.3.8" stretchy="false" xref="Sx3.SSx3.p1.4.m4.7.7.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.4.m4.7b"><apply id="Sx3.SSx3.p1.4.m4.7.7.cmml" xref="Sx3.SSx3.p1.4.m4.7.7"><eq id="Sx3.SSx3.p1.4.m4.7.7.4.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.4"></eq><apply id="Sx3.SSx3.p1.4.m4.7.7.5.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.5"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.4.m4.7.7.5.1.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.5">subscript</csymbol><ci id="Sx3.SSx3.p1.4.m4.7.7.5.2.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.5.2">𝑆</ci><ci id="Sx3.SSx3.p1.4.m4.7.7.5.3.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.5.3">𝑢</ci></apply><set id="Sx3.SSx3.p1.4.m4.7.7.3.4.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.3.3"><apply id="Sx3.SSx3.p1.4.m4.5.5.1.1.1.cmml" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.4.m4.5.5.1.1.1.1.cmml" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1">superscript</csymbol><apply id="Sx3.SSx3.p1.4.m4.5.5.1.1.1.2.cmml" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.4.m4.5.5.1.1.1.2.1.cmml" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1">subscript</csymbol><ci id="Sx3.SSx3.p1.4.m4.5.5.1.1.1.2.2.cmml" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1.2.2">𝑣</ci><cn id="Sx3.SSx3.p1.4.m4.5.5.1.1.1.2.3.cmml" type="integer" xref="Sx3.SSx3.p1.4.m4.5.5.1.1.1.2.3">1</cn></apply><ci id="Sx3.SSx3.p1.4.m4.1.1.1.1.cmml" xref="Sx3.SSx3.p1.4.m4.1.1.1.1">𝑢</ci></apply><apply id="Sx3.SSx3.p1.4.m4.6.6.2.2.2.cmml" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.4.m4.6.6.2.2.2.1.cmml" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2">superscript</csymbol><apply id="Sx3.SSx3.p1.4.m4.6.6.2.2.2.2.cmml" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.4.m4.6.6.2.2.2.2.1.cmml" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2">subscript</csymbol><ci id="Sx3.SSx3.p1.4.m4.6.6.2.2.2.2.2.cmml" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2.2.2">𝑣</ci><cn id="Sx3.SSx3.p1.4.m4.6.6.2.2.2.2.3.cmml" type="integer" xref="Sx3.SSx3.p1.4.m4.6.6.2.2.2.2.3">2</cn></apply><ci id="Sx3.SSx3.p1.4.m4.2.2.1.1.cmml" xref="Sx3.SSx3.p1.4.m4.2.2.1.1">𝑢</ci></apply><ci id="Sx3.SSx3.p1.4.m4.4.4.cmml" xref="Sx3.SSx3.p1.4.m4.4.4">…</ci><apply id="Sx3.SSx3.p1.4.m4.7.7.3.3.3.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.4.m4.7.7.3.3.3.1.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3">superscript</csymbol><apply id="Sx3.SSx3.p1.4.m4.7.7.3.3.3.2.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.4.m4.7.7.3.3.3.2.1.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3">subscript</csymbol><ci id="Sx3.SSx3.p1.4.m4.7.7.3.3.3.2.2.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3.2.2">𝑣</ci><ci id="Sx3.SSx3.p1.4.m4.7.7.3.3.3.2.3.cmml" xref="Sx3.SSx3.p1.4.m4.7.7.3.3.3.2.3">𝑛</ci></apply><ci id="Sx3.SSx3.p1.4.m4.3.3.1.1.cmml" xref="Sx3.SSx3.p1.4.m4.3.3.1.1">𝑢</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.4.m4.7c">S_{u}=\{v_{1}^{(u)},v_{2}^{(u)},\ldots,v_{n}^{(u)}\}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx3.p1.4.m4.7d">italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_u ) end_POSTSUPERSCRIPT }</annotation></semantics></math> , the embedding layer converts it to item embedding vectors <math alttext="H_{u}\in\mathbb{R}^{n_{u}\times D}" class="ltx_Math" display="inline" id="Sx3.SSx3.p1.5.m5.1"><semantics id="Sx3.SSx3.p1.5.m5.1a"><mrow id="Sx3.SSx3.p1.5.m5.1.1" xref="Sx3.SSx3.p1.5.m5.1.1.cmml"><msub id="Sx3.SSx3.p1.5.m5.1.1.2" xref="Sx3.SSx3.p1.5.m5.1.1.2.cmml"><mi id="Sx3.SSx3.p1.5.m5.1.1.2.2" xref="Sx3.SSx3.p1.5.m5.1.1.2.2.cmml">H</mi><mi id="Sx3.SSx3.p1.5.m5.1.1.2.3" xref="Sx3.SSx3.p1.5.m5.1.1.2.3.cmml">u</mi></msub><mo id="Sx3.SSx3.p1.5.m5.1.1.1" xref="Sx3.SSx3.p1.5.m5.1.1.1.cmml">∈</mo><msup id="Sx3.SSx3.p1.5.m5.1.1.3" xref="Sx3.SSx3.p1.5.m5.1.1.3.cmml"><mi id="Sx3.SSx3.p1.5.m5.1.1.3.2" xref="Sx3.SSx3.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx3.p1.5.m5.1.1.3.3" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.cmml"><msub id="Sx3.SSx3.p1.5.m5.1.1.3.3.2" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.2.cmml"><mi id="Sx3.SSx3.p1.5.m5.1.1.3.3.2.2" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.2.2.cmml">n</mi><mi id="Sx3.SSx3.p1.5.m5.1.1.3.3.2.3" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.2.3.cmml">u</mi></msub><mo id="Sx3.SSx3.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx3.p1.5.m5.1.1.3.3.3" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.5.m5.1b"><apply id="Sx3.SSx3.p1.5.m5.1.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1"><in id="Sx3.SSx3.p1.5.m5.1.1.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.1"></in><apply id="Sx3.SSx3.p1.5.m5.1.1.2.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.5.m5.1.1.2.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.2">subscript</csymbol><ci id="Sx3.SSx3.p1.5.m5.1.1.2.2.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.2.2">𝐻</ci><ci id="Sx3.SSx3.p1.5.m5.1.1.2.3.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.2.3">𝑢</ci></apply><apply id="Sx3.SSx3.p1.5.m5.1.1.3.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.5.m5.1.1.3.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.3">superscript</csymbol><ci id="Sx3.SSx3.p1.5.m5.1.1.3.2.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.3.2">ℝ</ci><apply id="Sx3.SSx3.p1.5.m5.1.1.3.3.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.3.3"><times id="Sx3.SSx3.p1.5.m5.1.1.3.3.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.1"></times><apply id="Sx3.SSx3.p1.5.m5.1.1.3.3.2.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.5.m5.1.1.3.3.2.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.2">subscript</csymbol><ci id="Sx3.SSx3.p1.5.m5.1.1.3.3.2.2.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.2.2">𝑛</ci><ci id="Sx3.SSx3.p1.5.m5.1.1.3.3.2.3.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.2.3">𝑢</ci></apply><ci id="Sx3.SSx3.p1.5.m5.1.1.3.3.3.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.5.m5.1c">H_{u}\in\mathbb{R}^{n_{u}\times D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx3.p1.5.m5.1d">italic_H start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>. To enhance robustness and prevent overfitting, we apply Dropout and Layer Normalization to the embedding vectors:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="H_{u,dropout}=Dropout\left(H_{u}\right)," class="ltx_Math" display="block" id="Sx3.E1.m1.3"><semantics id="Sx3.E1.m1.3a"><mrow id="Sx3.E1.m1.3.3.1" xref="Sx3.E1.m1.3.3.1.1.cmml"><mrow id="Sx3.E1.m1.3.3.1.1" xref="Sx3.E1.m1.3.3.1.1.cmml"><msub id="Sx3.E1.m1.3.3.1.1.3" xref="Sx3.E1.m1.3.3.1.1.3.cmml"><mi id="Sx3.E1.m1.3.3.1.1.3.2" xref="Sx3.E1.m1.3.3.1.1.3.2.cmml">H</mi><mrow id="Sx3.E1.m1.2.2.2.2" xref="Sx3.E1.m1.2.2.2.3.cmml"><mi id="Sx3.E1.m1.1.1.1.1" xref="Sx3.E1.m1.1.1.1.1.cmml">u</mi><mo id="Sx3.E1.m1.2.2.2.2.2" xref="Sx3.E1.m1.2.2.2.3.cmml">,</mo><mrow id="Sx3.E1.m1.2.2.2.2.1" xref="Sx3.E1.m1.2.2.2.2.1.cmml"><mi id="Sx3.E1.m1.2.2.2.2.1.2" xref="Sx3.E1.m1.2.2.2.2.1.2.cmml">d</mi><mo id="Sx3.E1.m1.2.2.2.2.1.1" xref="Sx3.E1.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E1.m1.2.2.2.2.1.3" xref="Sx3.E1.m1.2.2.2.2.1.3.cmml">r</mi><mo id="Sx3.E1.m1.2.2.2.2.1.1a" xref="Sx3.E1.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E1.m1.2.2.2.2.1.4" xref="Sx3.E1.m1.2.2.2.2.1.4.cmml">o</mi><mo id="Sx3.E1.m1.2.2.2.2.1.1b" xref="Sx3.E1.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E1.m1.2.2.2.2.1.5" xref="Sx3.E1.m1.2.2.2.2.1.5.cmml">p</mi><mo id="Sx3.E1.m1.2.2.2.2.1.1c" xref="Sx3.E1.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E1.m1.2.2.2.2.1.6" xref="Sx3.E1.m1.2.2.2.2.1.6.cmml">o</mi><mo id="Sx3.E1.m1.2.2.2.2.1.1d" xref="Sx3.E1.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E1.m1.2.2.2.2.1.7" xref="Sx3.E1.m1.2.2.2.2.1.7.cmml">u</mi><mo id="Sx3.E1.m1.2.2.2.2.1.1e" xref="Sx3.E1.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E1.m1.2.2.2.2.1.8" xref="Sx3.E1.m1.2.2.2.2.1.8.cmml">t</mi></mrow></mrow></msub><mo id="Sx3.E1.m1.3.3.1.1.2" xref="Sx3.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="Sx3.E1.m1.3.3.1.1.1" xref="Sx3.E1.m1.3.3.1.1.1.cmml"><mi id="Sx3.E1.m1.3.3.1.1.1.3" xref="Sx3.E1.m1.3.3.1.1.1.3.cmml">D</mi><mo id="Sx3.E1.m1.3.3.1.1.1.2" xref="Sx3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E1.m1.3.3.1.1.1.4" xref="Sx3.E1.m1.3.3.1.1.1.4.cmml">r</mi><mo id="Sx3.E1.m1.3.3.1.1.1.2a" xref="Sx3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E1.m1.3.3.1.1.1.5" xref="Sx3.E1.m1.3.3.1.1.1.5.cmml">o</mi><mo id="Sx3.E1.m1.3.3.1.1.1.2b" xref="Sx3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E1.m1.3.3.1.1.1.6" xref="Sx3.E1.m1.3.3.1.1.1.6.cmml">p</mi><mo id="Sx3.E1.m1.3.3.1.1.1.2c" xref="Sx3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E1.m1.3.3.1.1.1.7" xref="Sx3.E1.m1.3.3.1.1.1.7.cmml">o</mi><mo id="Sx3.E1.m1.3.3.1.1.1.2d" xref="Sx3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E1.m1.3.3.1.1.1.8" xref="Sx3.E1.m1.3.3.1.1.1.8.cmml">u</mi><mo id="Sx3.E1.m1.3.3.1.1.1.2e" xref="Sx3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E1.m1.3.3.1.1.1.9" xref="Sx3.E1.m1.3.3.1.1.1.9.cmml">t</mi><mo id="Sx3.E1.m1.3.3.1.1.1.2f" xref="Sx3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="Sx3.E1.m1.3.3.1.1.1.1.1" xref="Sx3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo id="Sx3.E1.m1.3.3.1.1.1.1.1.2" xref="Sx3.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E1.m1.3.3.1.1.1.1.1.1" xref="Sx3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="Sx3.E1.m1.3.3.1.1.1.1.1.1.2" xref="Sx3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">H</mi><mi id="Sx3.E1.m1.3.3.1.1.1.1.1.1.3" xref="Sx3.E1.m1.3.3.1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="Sx3.E1.m1.3.3.1.1.1.1.1.3" xref="Sx3.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E1.m1.3.3.1.2" xref="Sx3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E1.m1.3b"><apply id="Sx3.E1.m1.3.3.1.1.cmml" xref="Sx3.E1.m1.3.3.1"><eq id="Sx3.E1.m1.3.3.1.1.2.cmml" xref="Sx3.E1.m1.3.3.1.1.2"></eq><apply id="Sx3.E1.m1.3.3.1.1.3.cmml" xref="Sx3.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="Sx3.E1.m1.3.3.1.1.3.1.cmml" xref="Sx3.E1.m1.3.3.1.1.3">subscript</csymbol><ci id="Sx3.E1.m1.3.3.1.1.3.2.cmml" xref="Sx3.E1.m1.3.3.1.1.3.2">𝐻</ci><list id="Sx3.E1.m1.2.2.2.3.cmml" xref="Sx3.E1.m1.2.2.2.2"><ci id="Sx3.E1.m1.1.1.1.1.cmml" xref="Sx3.E1.m1.1.1.1.1">𝑢</ci><apply id="Sx3.E1.m1.2.2.2.2.1.cmml" xref="Sx3.E1.m1.2.2.2.2.1"><times id="Sx3.E1.m1.2.2.2.2.1.1.cmml" xref="Sx3.E1.m1.2.2.2.2.1.1"></times><ci id="Sx3.E1.m1.2.2.2.2.1.2.cmml" xref="Sx3.E1.m1.2.2.2.2.1.2">𝑑</ci><ci id="Sx3.E1.m1.2.2.2.2.1.3.cmml" xref="Sx3.E1.m1.2.2.2.2.1.3">𝑟</ci><ci id="Sx3.E1.m1.2.2.2.2.1.4.cmml" xref="Sx3.E1.m1.2.2.2.2.1.4">𝑜</ci><ci id="Sx3.E1.m1.2.2.2.2.1.5.cmml" xref="Sx3.E1.m1.2.2.2.2.1.5">𝑝</ci><ci id="Sx3.E1.m1.2.2.2.2.1.6.cmml" xref="Sx3.E1.m1.2.2.2.2.1.6">𝑜</ci><ci id="Sx3.E1.m1.2.2.2.2.1.7.cmml" xref="Sx3.E1.m1.2.2.2.2.1.7">𝑢</ci><ci id="Sx3.E1.m1.2.2.2.2.1.8.cmml" xref="Sx3.E1.m1.2.2.2.2.1.8">𝑡</ci></apply></list></apply><apply id="Sx3.E1.m1.3.3.1.1.1.cmml" xref="Sx3.E1.m1.3.3.1.1.1"><times id="Sx3.E1.m1.3.3.1.1.1.2.cmml" xref="Sx3.E1.m1.3.3.1.1.1.2"></times><ci id="Sx3.E1.m1.3.3.1.1.1.3.cmml" xref="Sx3.E1.m1.3.3.1.1.1.3">𝐷</ci><ci id="Sx3.E1.m1.3.3.1.1.1.4.cmml" xref="Sx3.E1.m1.3.3.1.1.1.4">𝑟</ci><ci id="Sx3.E1.m1.3.3.1.1.1.5.cmml" xref="Sx3.E1.m1.3.3.1.1.1.5">𝑜</ci><ci id="Sx3.E1.m1.3.3.1.1.1.6.cmml" xref="Sx3.E1.m1.3.3.1.1.1.6">𝑝</ci><ci id="Sx3.E1.m1.3.3.1.1.1.7.cmml" xref="Sx3.E1.m1.3.3.1.1.1.7">𝑜</ci><ci id="Sx3.E1.m1.3.3.1.1.1.8.cmml" xref="Sx3.E1.m1.3.3.1.1.1.8">𝑢</ci><ci id="Sx3.E1.m1.3.3.1.1.1.9.cmml" xref="Sx3.E1.m1.3.3.1.1.1.9">𝑡</ci><apply id="Sx3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="Sx3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="Sx3.E1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="Sx3.E1.m1.3.3.1.1.1.1.1.1.2">𝐻</ci><ci id="Sx3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="Sx3.E1.m1.3.3.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1.m1.3c">H_{u,dropout}=Dropout\left(H_{u}\right),</annotation><annotation encoding="application/x-llamapun" id="Sx3.E1.m1.3d">italic_H start_POSTSUBSCRIPT italic_u , italic_d italic_r italic_o italic_p italic_o italic_u italic_t end_POSTSUBSCRIPT = italic_D italic_r italic_o italic_p italic_o italic_u italic_t ( italic_H start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="Sx3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="H_{u,norm}=LayerNorm\left(H_{u,dropout}\right)." class="ltx_Math" display="block" id="Sx3.E2.m1.5"><semantics id="Sx3.E2.m1.5a"><mrow id="Sx3.E2.m1.5.5.1" xref="Sx3.E2.m1.5.5.1.1.cmml"><mrow id="Sx3.E2.m1.5.5.1.1" xref="Sx3.E2.m1.5.5.1.1.cmml"><msub id="Sx3.E2.m1.5.5.1.1.3" xref="Sx3.E2.m1.5.5.1.1.3.cmml"><mi id="Sx3.E2.m1.5.5.1.1.3.2" xref="Sx3.E2.m1.5.5.1.1.3.2.cmml">H</mi><mrow id="Sx3.E2.m1.2.2.2.2" xref="Sx3.E2.m1.2.2.2.3.cmml"><mi id="Sx3.E2.m1.1.1.1.1" xref="Sx3.E2.m1.1.1.1.1.cmml">u</mi><mo id="Sx3.E2.m1.2.2.2.2.2" xref="Sx3.E2.m1.2.2.2.3.cmml">,</mo><mrow id="Sx3.E2.m1.2.2.2.2.1" xref="Sx3.E2.m1.2.2.2.2.1.cmml"><mi id="Sx3.E2.m1.2.2.2.2.1.2" xref="Sx3.E2.m1.2.2.2.2.1.2.cmml">n</mi><mo id="Sx3.E2.m1.2.2.2.2.1.1" xref="Sx3.E2.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E2.m1.2.2.2.2.1.3" xref="Sx3.E2.m1.2.2.2.2.1.3.cmml">o</mi><mo id="Sx3.E2.m1.2.2.2.2.1.1a" xref="Sx3.E2.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E2.m1.2.2.2.2.1.4" xref="Sx3.E2.m1.2.2.2.2.1.4.cmml">r</mi><mo id="Sx3.E2.m1.2.2.2.2.1.1b" xref="Sx3.E2.m1.2.2.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E2.m1.2.2.2.2.1.5" xref="Sx3.E2.m1.2.2.2.2.1.5.cmml">m</mi></mrow></mrow></msub><mo id="Sx3.E2.m1.5.5.1.1.2" xref="Sx3.E2.m1.5.5.1.1.2.cmml">=</mo><mrow id="Sx3.E2.m1.5.5.1.1.1" xref="Sx3.E2.m1.5.5.1.1.1.cmml"><mi id="Sx3.E2.m1.5.5.1.1.1.3" xref="Sx3.E2.m1.5.5.1.1.1.3.cmml">L</mi><mo id="Sx3.E2.m1.5.5.1.1.1.2" xref="Sx3.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E2.m1.5.5.1.1.1.4" xref="Sx3.E2.m1.5.5.1.1.1.4.cmml">a</mi><mo id="Sx3.E2.m1.5.5.1.1.1.2a" xref="Sx3.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E2.m1.5.5.1.1.1.5" xref="Sx3.E2.m1.5.5.1.1.1.5.cmml">y</mi><mo id="Sx3.E2.m1.5.5.1.1.1.2b" xref="Sx3.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E2.m1.5.5.1.1.1.6" xref="Sx3.E2.m1.5.5.1.1.1.6.cmml">e</mi><mo id="Sx3.E2.m1.5.5.1.1.1.2c" xref="Sx3.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E2.m1.5.5.1.1.1.7" xref="Sx3.E2.m1.5.5.1.1.1.7.cmml">r</mi><mo id="Sx3.E2.m1.5.5.1.1.1.2d" xref="Sx3.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E2.m1.5.5.1.1.1.8" xref="Sx3.E2.m1.5.5.1.1.1.8.cmml">N</mi><mo id="Sx3.E2.m1.5.5.1.1.1.2e" xref="Sx3.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E2.m1.5.5.1.1.1.9" xref="Sx3.E2.m1.5.5.1.1.1.9.cmml">o</mi><mo id="Sx3.E2.m1.5.5.1.1.1.2f" xref="Sx3.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E2.m1.5.5.1.1.1.10" xref="Sx3.E2.m1.5.5.1.1.1.10.cmml">r</mi><mo id="Sx3.E2.m1.5.5.1.1.1.2g" xref="Sx3.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E2.m1.5.5.1.1.1.11" xref="Sx3.E2.m1.5.5.1.1.1.11.cmml">m</mi><mo id="Sx3.E2.m1.5.5.1.1.1.2h" xref="Sx3.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="Sx3.E2.m1.5.5.1.1.1.1.1" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.cmml"><mo id="Sx3.E2.m1.5.5.1.1.1.1.1.2" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E2.m1.5.5.1.1.1.1.1.1" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.cmml"><mi id="Sx3.E2.m1.5.5.1.1.1.1.1.1.2" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.2.cmml">H</mi><mrow id="Sx3.E2.m1.4.4.2.2" xref="Sx3.E2.m1.4.4.2.3.cmml"><mi id="Sx3.E2.m1.3.3.1.1" xref="Sx3.E2.m1.3.3.1.1.cmml">u</mi><mo id="Sx3.E2.m1.4.4.2.2.2" xref="Sx3.E2.m1.4.4.2.3.cmml">,</mo><mrow id="Sx3.E2.m1.4.4.2.2.1" xref="Sx3.E2.m1.4.4.2.2.1.cmml"><mi id="Sx3.E2.m1.4.4.2.2.1.2" xref="Sx3.E2.m1.4.4.2.2.1.2.cmml">d</mi><mo id="Sx3.E2.m1.4.4.2.2.1.1" xref="Sx3.E2.m1.4.4.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E2.m1.4.4.2.2.1.3" xref="Sx3.E2.m1.4.4.2.2.1.3.cmml">r</mi><mo id="Sx3.E2.m1.4.4.2.2.1.1a" xref="Sx3.E2.m1.4.4.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E2.m1.4.4.2.2.1.4" xref="Sx3.E2.m1.4.4.2.2.1.4.cmml">o</mi><mo id="Sx3.E2.m1.4.4.2.2.1.1b" xref="Sx3.E2.m1.4.4.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E2.m1.4.4.2.2.1.5" xref="Sx3.E2.m1.4.4.2.2.1.5.cmml">p</mi><mo id="Sx3.E2.m1.4.4.2.2.1.1c" xref="Sx3.E2.m1.4.4.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E2.m1.4.4.2.2.1.6" xref="Sx3.E2.m1.4.4.2.2.1.6.cmml">o</mi><mo id="Sx3.E2.m1.4.4.2.2.1.1d" xref="Sx3.E2.m1.4.4.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E2.m1.4.4.2.2.1.7" xref="Sx3.E2.m1.4.4.2.2.1.7.cmml">u</mi><mo id="Sx3.E2.m1.4.4.2.2.1.1e" xref="Sx3.E2.m1.4.4.2.2.1.1.cmml">⁢</mo><mi id="Sx3.E2.m1.4.4.2.2.1.8" xref="Sx3.E2.m1.4.4.2.2.1.8.cmml">t</mi></mrow></mrow></msub><mo id="Sx3.E2.m1.5.5.1.1.1.1.1.3" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E2.m1.5.5.1.2" lspace="0em" xref="Sx3.E2.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2.m1.5b"><apply id="Sx3.E2.m1.5.5.1.1.cmml" xref="Sx3.E2.m1.5.5.1"><eq id="Sx3.E2.m1.5.5.1.1.2.cmml" xref="Sx3.E2.m1.5.5.1.1.2"></eq><apply id="Sx3.E2.m1.5.5.1.1.3.cmml" xref="Sx3.E2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="Sx3.E2.m1.5.5.1.1.3.1.cmml" xref="Sx3.E2.m1.5.5.1.1.3">subscript</csymbol><ci id="Sx3.E2.m1.5.5.1.1.3.2.cmml" xref="Sx3.E2.m1.5.5.1.1.3.2">𝐻</ci><list id="Sx3.E2.m1.2.2.2.3.cmml" xref="Sx3.E2.m1.2.2.2.2"><ci id="Sx3.E2.m1.1.1.1.1.cmml" xref="Sx3.E2.m1.1.1.1.1">𝑢</ci><apply id="Sx3.E2.m1.2.2.2.2.1.cmml" xref="Sx3.E2.m1.2.2.2.2.1"><times id="Sx3.E2.m1.2.2.2.2.1.1.cmml" xref="Sx3.E2.m1.2.2.2.2.1.1"></times><ci id="Sx3.E2.m1.2.2.2.2.1.2.cmml" xref="Sx3.E2.m1.2.2.2.2.1.2">𝑛</ci><ci id="Sx3.E2.m1.2.2.2.2.1.3.cmml" xref="Sx3.E2.m1.2.2.2.2.1.3">𝑜</ci><ci id="Sx3.E2.m1.2.2.2.2.1.4.cmml" xref="Sx3.E2.m1.2.2.2.2.1.4">𝑟</ci><ci id="Sx3.E2.m1.2.2.2.2.1.5.cmml" xref="Sx3.E2.m1.2.2.2.2.1.5">𝑚</ci></apply></list></apply><apply id="Sx3.E2.m1.5.5.1.1.1.cmml" xref="Sx3.E2.m1.5.5.1.1.1"><times id="Sx3.E2.m1.5.5.1.1.1.2.cmml" xref="Sx3.E2.m1.5.5.1.1.1.2"></times><ci id="Sx3.E2.m1.5.5.1.1.1.3.cmml" xref="Sx3.E2.m1.5.5.1.1.1.3">𝐿</ci><ci id="Sx3.E2.m1.5.5.1.1.1.4.cmml" xref="Sx3.E2.m1.5.5.1.1.1.4">𝑎</ci><ci id="Sx3.E2.m1.5.5.1.1.1.5.cmml" xref="Sx3.E2.m1.5.5.1.1.1.5">𝑦</ci><ci id="Sx3.E2.m1.5.5.1.1.1.6.cmml" xref="Sx3.E2.m1.5.5.1.1.1.6">𝑒</ci><ci id="Sx3.E2.m1.5.5.1.1.1.7.cmml" xref="Sx3.E2.m1.5.5.1.1.1.7">𝑟</ci><ci id="Sx3.E2.m1.5.5.1.1.1.8.cmml" xref="Sx3.E2.m1.5.5.1.1.1.8">𝑁</ci><ci id="Sx3.E2.m1.5.5.1.1.1.9.cmml" xref="Sx3.E2.m1.5.5.1.1.1.9">𝑜</ci><ci id="Sx3.E2.m1.5.5.1.1.1.10.cmml" xref="Sx3.E2.m1.5.5.1.1.1.10">𝑟</ci><ci id="Sx3.E2.m1.5.5.1.1.1.11.cmml" xref="Sx3.E2.m1.5.5.1.1.1.11">𝑚</ci><apply id="Sx3.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="Sx3.E2.m1.5.5.1.1.1.1.1.1.2">𝐻</ci><list id="Sx3.E2.m1.4.4.2.3.cmml" xref="Sx3.E2.m1.4.4.2.2"><ci id="Sx3.E2.m1.3.3.1.1.cmml" xref="Sx3.E2.m1.3.3.1.1">𝑢</ci><apply id="Sx3.E2.m1.4.4.2.2.1.cmml" xref="Sx3.E2.m1.4.4.2.2.1"><times id="Sx3.E2.m1.4.4.2.2.1.1.cmml" xref="Sx3.E2.m1.4.4.2.2.1.1"></times><ci id="Sx3.E2.m1.4.4.2.2.1.2.cmml" xref="Sx3.E2.m1.4.4.2.2.1.2">𝑑</ci><ci id="Sx3.E2.m1.4.4.2.2.1.3.cmml" xref="Sx3.E2.m1.4.4.2.2.1.3">𝑟</ci><ci id="Sx3.E2.m1.4.4.2.2.1.4.cmml" xref="Sx3.E2.m1.4.4.2.2.1.4">𝑜</ci><ci id="Sx3.E2.m1.4.4.2.2.1.5.cmml" xref="Sx3.E2.m1.4.4.2.2.1.5">𝑝</ci><ci id="Sx3.E2.m1.4.4.2.2.1.6.cmml" xref="Sx3.E2.m1.4.4.2.2.1.6">𝑜</ci><ci id="Sx3.E2.m1.4.4.2.2.1.7.cmml" xref="Sx3.E2.m1.4.4.2.2.1.7">𝑢</ci><ci id="Sx3.E2.m1.4.4.2.2.1.8.cmml" xref="Sx3.E2.m1.4.4.2.2.1.8">𝑡</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2.m1.5c">H_{u,norm}=LayerNorm\left(H_{u,dropout}\right).</annotation><annotation encoding="application/x-llamapun" id="Sx3.E2.m1.5d">italic_H start_POSTSUBSCRIPT italic_u , italic_n italic_o italic_r italic_m end_POSTSUBSCRIPT = italic_L italic_a italic_y italic_e italic_r italic_N italic_o italic_r italic_m ( italic_H start_POSTSUBSCRIPT italic_u , italic_d italic_r italic_o italic_p italic_o italic_u italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx3.SSx3.p1.8">To improve efficiency, we merge multiple samples into a batch, resulting in <math alttext="X\in\mathcal{R}^{B\times L\times D}" class="ltx_Math" display="inline" id="Sx3.SSx3.p1.6.m1.1"><semantics id="Sx3.SSx3.p1.6.m1.1a"><mrow id="Sx3.SSx3.p1.6.m1.1.1" xref="Sx3.SSx3.p1.6.m1.1.1.cmml"><mi id="Sx3.SSx3.p1.6.m1.1.1.2" xref="Sx3.SSx3.p1.6.m1.1.1.2.cmml">X</mi><mo id="Sx3.SSx3.p1.6.m1.1.1.1" xref="Sx3.SSx3.p1.6.m1.1.1.1.cmml">∈</mo><msup id="Sx3.SSx3.p1.6.m1.1.1.3" xref="Sx3.SSx3.p1.6.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p1.6.m1.1.1.3.2" xref="Sx3.SSx3.p1.6.m1.1.1.3.2.cmml">ℛ</mi><mrow id="Sx3.SSx3.p1.6.m1.1.1.3.3" xref="Sx3.SSx3.p1.6.m1.1.1.3.3.cmml"><mi id="Sx3.SSx3.p1.6.m1.1.1.3.3.2" xref="Sx3.SSx3.p1.6.m1.1.1.3.3.2.cmml">B</mi><mo id="Sx3.SSx3.p1.6.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx3.p1.6.m1.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx3.p1.6.m1.1.1.3.3.3" xref="Sx3.SSx3.p1.6.m1.1.1.3.3.3.cmml">L</mi><mo id="Sx3.SSx3.p1.6.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx3.p1.6.m1.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx3.p1.6.m1.1.1.3.3.4" xref="Sx3.SSx3.p1.6.m1.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.6.m1.1b"><apply id="Sx3.SSx3.p1.6.m1.1.1.cmml" xref="Sx3.SSx3.p1.6.m1.1.1"><in id="Sx3.SSx3.p1.6.m1.1.1.1.cmml" xref="Sx3.SSx3.p1.6.m1.1.1.1"></in><ci id="Sx3.SSx3.p1.6.m1.1.1.2.cmml" xref="Sx3.SSx3.p1.6.m1.1.1.2">𝑋</ci><apply id="Sx3.SSx3.p1.6.m1.1.1.3.cmml" xref="Sx3.SSx3.p1.6.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.6.m1.1.1.3.1.cmml" xref="Sx3.SSx3.p1.6.m1.1.1.3">superscript</csymbol><ci id="Sx3.SSx3.p1.6.m1.1.1.3.2.cmml" xref="Sx3.SSx3.p1.6.m1.1.1.3.2">ℛ</ci><apply id="Sx3.SSx3.p1.6.m1.1.1.3.3.cmml" xref="Sx3.SSx3.p1.6.m1.1.1.3.3"><times id="Sx3.SSx3.p1.6.m1.1.1.3.3.1.cmml" xref="Sx3.SSx3.p1.6.m1.1.1.3.3.1"></times><ci id="Sx3.SSx3.p1.6.m1.1.1.3.3.2.cmml" xref="Sx3.SSx3.p1.6.m1.1.1.3.3.2">𝐵</ci><ci id="Sx3.SSx3.p1.6.m1.1.1.3.3.3.cmml" xref="Sx3.SSx3.p1.6.m1.1.1.3.3.3">𝐿</ci><ci id="Sx3.SSx3.p1.6.m1.1.1.3.3.4.cmml" xref="Sx3.SSx3.p1.6.m1.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.6.m1.1c">X\in\mathcal{R}^{B\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx3.p1.6.m1.1d">italic_X ∈ caligraphic_R start_POSTSUPERSCRIPT italic_B × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>,where <math alttext="B" class="ltx_Math" display="inline" id="Sx3.SSx3.p1.7.m2.1"><semantics id="Sx3.SSx3.p1.7.m2.1a"><mi id="Sx3.SSx3.p1.7.m2.1.1" xref="Sx3.SSx3.p1.7.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.7.m2.1b"><ci id="Sx3.SSx3.p1.7.m2.1.1.cmml" xref="Sx3.SSx3.p1.7.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.7.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx3.p1.7.m2.1d">italic_B</annotation></semantics></math> is the batch size and <math alttext="L" class="ltx_Math" display="inline" id="Sx3.SSx3.p1.8.m3.1"><semantics id="Sx3.SSx3.p1.8.m3.1a"><mi id="Sx3.SSx3.p1.8.m3.1.1" xref="Sx3.SSx3.p1.8.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.8.m3.1b"><ci id="Sx3.SSx3.p1.8.m3.1.1.cmml" xref="Sx3.SSx3.p1.8.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.8.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx3.p1.8.m3.1d">italic_L</annotation></semantics></math> is the padded sequence length.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx4">
<h3 class="ltx_title ltx_title_subsection">Mamba Layer</h3>
<div class="ltx_para" id="Sx3.SSx4.p1">
<p class="ltx_p" id="Sx3.SSx4.p1.1">In the Mamba layer, Mamba can implicitly capture the sequential information of interaction sequences. Therefore, even without the need to separately add position encoding, the model can still learn positional information within the sequence. It captures crucial dynamic information and preprocesses the sequence, thereby providing optimized input for the multi-head attention layer.</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="H=Mamba\left(X\right)\in\mathbb{R}^{B\times L\times D}." class="ltx_Math" display="block" id="Sx3.E3.m1.2"><semantics id="Sx3.E3.m1.2a"><mrow id="Sx3.E3.m1.2.2.1" xref="Sx3.E3.m1.2.2.1.1.cmml"><mrow id="Sx3.E3.m1.2.2.1.1" xref="Sx3.E3.m1.2.2.1.1.cmml"><mi id="Sx3.E3.m1.2.2.1.1.2" xref="Sx3.E3.m1.2.2.1.1.2.cmml">H</mi><mo id="Sx3.E3.m1.2.2.1.1.3" xref="Sx3.E3.m1.2.2.1.1.3.cmml">=</mo><mrow id="Sx3.E3.m1.2.2.1.1.4" xref="Sx3.E3.m1.2.2.1.1.4.cmml"><mi id="Sx3.E3.m1.2.2.1.1.4.2" xref="Sx3.E3.m1.2.2.1.1.4.2.cmml">M</mi><mo id="Sx3.E3.m1.2.2.1.1.4.1" xref="Sx3.E3.m1.2.2.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E3.m1.2.2.1.1.4.3" xref="Sx3.E3.m1.2.2.1.1.4.3.cmml">a</mi><mo id="Sx3.E3.m1.2.2.1.1.4.1a" xref="Sx3.E3.m1.2.2.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E3.m1.2.2.1.1.4.4" xref="Sx3.E3.m1.2.2.1.1.4.4.cmml">m</mi><mo id="Sx3.E3.m1.2.2.1.1.4.1b" xref="Sx3.E3.m1.2.2.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E3.m1.2.2.1.1.4.5" xref="Sx3.E3.m1.2.2.1.1.4.5.cmml">b</mi><mo id="Sx3.E3.m1.2.2.1.1.4.1c" xref="Sx3.E3.m1.2.2.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E3.m1.2.2.1.1.4.6" xref="Sx3.E3.m1.2.2.1.1.4.6.cmml">a</mi><mo id="Sx3.E3.m1.2.2.1.1.4.1d" xref="Sx3.E3.m1.2.2.1.1.4.1.cmml">⁢</mo><mrow id="Sx3.E3.m1.2.2.1.1.4.7.2" xref="Sx3.E3.m1.2.2.1.1.4.cmml"><mo id="Sx3.E3.m1.2.2.1.1.4.7.2.1" xref="Sx3.E3.m1.2.2.1.1.4.cmml">(</mo><mi id="Sx3.E3.m1.1.1" xref="Sx3.E3.m1.1.1.cmml">X</mi><mo id="Sx3.E3.m1.2.2.1.1.4.7.2.2" xref="Sx3.E3.m1.2.2.1.1.4.cmml">)</mo></mrow></mrow><mo id="Sx3.E3.m1.2.2.1.1.5" xref="Sx3.E3.m1.2.2.1.1.5.cmml">∈</mo><msup id="Sx3.E3.m1.2.2.1.1.6" xref="Sx3.E3.m1.2.2.1.1.6.cmml"><mi id="Sx3.E3.m1.2.2.1.1.6.2" xref="Sx3.E3.m1.2.2.1.1.6.2.cmml">ℝ</mi><mrow id="Sx3.E3.m1.2.2.1.1.6.3" xref="Sx3.E3.m1.2.2.1.1.6.3.cmml"><mi id="Sx3.E3.m1.2.2.1.1.6.3.2" xref="Sx3.E3.m1.2.2.1.1.6.3.2.cmml">B</mi><mo id="Sx3.E3.m1.2.2.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="Sx3.E3.m1.2.2.1.1.6.3.1.cmml">×</mo><mi id="Sx3.E3.m1.2.2.1.1.6.3.3" xref="Sx3.E3.m1.2.2.1.1.6.3.3.cmml">L</mi><mo id="Sx3.E3.m1.2.2.1.1.6.3.1a" lspace="0.222em" rspace="0.222em" xref="Sx3.E3.m1.2.2.1.1.6.3.1.cmml">×</mo><mi id="Sx3.E3.m1.2.2.1.1.6.3.4" xref="Sx3.E3.m1.2.2.1.1.6.3.4.cmml">D</mi></mrow></msup></mrow><mo id="Sx3.E3.m1.2.2.1.2" lspace="0em" xref="Sx3.E3.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E3.m1.2b"><apply id="Sx3.E3.m1.2.2.1.1.cmml" xref="Sx3.E3.m1.2.2.1"><and id="Sx3.E3.m1.2.2.1.1a.cmml" xref="Sx3.E3.m1.2.2.1"></and><apply id="Sx3.E3.m1.2.2.1.1b.cmml" xref="Sx3.E3.m1.2.2.1"><eq id="Sx3.E3.m1.2.2.1.1.3.cmml" xref="Sx3.E3.m1.2.2.1.1.3"></eq><ci id="Sx3.E3.m1.2.2.1.1.2.cmml" xref="Sx3.E3.m1.2.2.1.1.2">𝐻</ci><apply id="Sx3.E3.m1.2.2.1.1.4.cmml" xref="Sx3.E3.m1.2.2.1.1.4"><times id="Sx3.E3.m1.2.2.1.1.4.1.cmml" xref="Sx3.E3.m1.2.2.1.1.4.1"></times><ci id="Sx3.E3.m1.2.2.1.1.4.2.cmml" xref="Sx3.E3.m1.2.2.1.1.4.2">𝑀</ci><ci id="Sx3.E3.m1.2.2.1.1.4.3.cmml" xref="Sx3.E3.m1.2.2.1.1.4.3">𝑎</ci><ci id="Sx3.E3.m1.2.2.1.1.4.4.cmml" xref="Sx3.E3.m1.2.2.1.1.4.4">𝑚</ci><ci id="Sx3.E3.m1.2.2.1.1.4.5.cmml" xref="Sx3.E3.m1.2.2.1.1.4.5">𝑏</ci><ci id="Sx3.E3.m1.2.2.1.1.4.6.cmml" xref="Sx3.E3.m1.2.2.1.1.4.6">𝑎</ci><ci id="Sx3.E3.m1.1.1.cmml" xref="Sx3.E3.m1.1.1">𝑋</ci></apply></apply><apply id="Sx3.E3.m1.2.2.1.1c.cmml" xref="Sx3.E3.m1.2.2.1"><in id="Sx3.E3.m1.2.2.1.1.5.cmml" xref="Sx3.E3.m1.2.2.1.1.5"></in><share href="https://arxiv.org/html/2407.19239v1#Sx3.E3.m1.2.2.1.1.4.cmml" id="Sx3.E3.m1.2.2.1.1d.cmml" xref="Sx3.E3.m1.2.2.1"></share><apply id="Sx3.E3.m1.2.2.1.1.6.cmml" xref="Sx3.E3.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="Sx3.E3.m1.2.2.1.1.6.1.cmml" xref="Sx3.E3.m1.2.2.1.1.6">superscript</csymbol><ci id="Sx3.E3.m1.2.2.1.1.6.2.cmml" xref="Sx3.E3.m1.2.2.1.1.6.2">ℝ</ci><apply id="Sx3.E3.m1.2.2.1.1.6.3.cmml" xref="Sx3.E3.m1.2.2.1.1.6.3"><times id="Sx3.E3.m1.2.2.1.1.6.3.1.cmml" xref="Sx3.E3.m1.2.2.1.1.6.3.1"></times><ci id="Sx3.E3.m1.2.2.1.1.6.3.2.cmml" xref="Sx3.E3.m1.2.2.1.1.6.3.2">𝐵</ci><ci id="Sx3.E3.m1.2.2.1.1.6.3.3.cmml" xref="Sx3.E3.m1.2.2.1.1.6.3.3">𝐿</ci><ci id="Sx3.E3.m1.2.2.1.1.6.3.4.cmml" xref="Sx3.E3.m1.2.2.1.1.6.3.4">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E3.m1.2c">H=Mamba\left(X\right)\in\mathbb{R}^{B\times L\times D}.</annotation><annotation encoding="application/x-llamapun" id="Sx3.E3.m1.2d">italic_H = italic_M italic_a italic_m italic_b italic_a ( italic_X ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L × italic_D end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx5">
<h3 class="ltx_title ltx_title_subsection">Multi-Head Attention layer</h3>
<div class="ltx_para" id="Sx3.SSx5.p1">
<p class="ltx_p" id="Sx3.SSx5.p1.11">The multi-head self-attention layer captures various dependencies between different positions in the interaction sequence, allowing for a more comprehensive extraction of information from the sequence data. By processing multiple attention heads in parallel, each head can focus on different parts and patterns, enhancing the model’s representation capability and understanding of complex relationships. The multi-head attention mechanism is computed as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="MultiHead(Q,K,V)=Concat(head_{1},\dots,head_{h})W^{O}," class="ltx_Math" display="block" id="Sx3.E4.m1.5"><semantics id="Sx3.E4.m1.5a"><mrow id="Sx3.E4.m1.5.5.1" xref="Sx3.E4.m1.5.5.1.1.cmml"><mrow id="Sx3.E4.m1.5.5.1.1" xref="Sx3.E4.m1.5.5.1.1.cmml"><mrow id="Sx3.E4.m1.5.5.1.1.4" xref="Sx3.E4.m1.5.5.1.1.4.cmml"><mi id="Sx3.E4.m1.5.5.1.1.4.2" xref="Sx3.E4.m1.5.5.1.1.4.2.cmml">M</mi><mo id="Sx3.E4.m1.5.5.1.1.4.1" xref="Sx3.E4.m1.5.5.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.4.3" xref="Sx3.E4.m1.5.5.1.1.4.3.cmml">u</mi><mo id="Sx3.E4.m1.5.5.1.1.4.1a" xref="Sx3.E4.m1.5.5.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.4.4" xref="Sx3.E4.m1.5.5.1.1.4.4.cmml">l</mi><mo id="Sx3.E4.m1.5.5.1.1.4.1b" xref="Sx3.E4.m1.5.5.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.4.5" xref="Sx3.E4.m1.5.5.1.1.4.5.cmml">t</mi><mo id="Sx3.E4.m1.5.5.1.1.4.1c" xref="Sx3.E4.m1.5.5.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.4.6" xref="Sx3.E4.m1.5.5.1.1.4.6.cmml">i</mi><mo id="Sx3.E4.m1.5.5.1.1.4.1d" xref="Sx3.E4.m1.5.5.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.4.7" xref="Sx3.E4.m1.5.5.1.1.4.7.cmml">H</mi><mo id="Sx3.E4.m1.5.5.1.1.4.1e" xref="Sx3.E4.m1.5.5.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.4.8" xref="Sx3.E4.m1.5.5.1.1.4.8.cmml">e</mi><mo id="Sx3.E4.m1.5.5.1.1.4.1f" xref="Sx3.E4.m1.5.5.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.4.9" xref="Sx3.E4.m1.5.5.1.1.4.9.cmml">a</mi><mo id="Sx3.E4.m1.5.5.1.1.4.1g" xref="Sx3.E4.m1.5.5.1.1.4.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.4.10" xref="Sx3.E4.m1.5.5.1.1.4.10.cmml">d</mi><mo id="Sx3.E4.m1.5.5.1.1.4.1h" xref="Sx3.E4.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="Sx3.E4.m1.5.5.1.1.4.11.2" xref="Sx3.E4.m1.5.5.1.1.4.11.1.cmml"><mo id="Sx3.E4.m1.5.5.1.1.4.11.2.1" stretchy="false" xref="Sx3.E4.m1.5.5.1.1.4.11.1.cmml">(</mo><mi id="Sx3.E4.m1.1.1" xref="Sx3.E4.m1.1.1.cmml">Q</mi><mo id="Sx3.E4.m1.5.5.1.1.4.11.2.2" xref="Sx3.E4.m1.5.5.1.1.4.11.1.cmml">,</mo><mi id="Sx3.E4.m1.2.2" xref="Sx3.E4.m1.2.2.cmml">K</mi><mo id="Sx3.E4.m1.5.5.1.1.4.11.2.3" xref="Sx3.E4.m1.5.5.1.1.4.11.1.cmml">,</mo><mi id="Sx3.E4.m1.3.3" xref="Sx3.E4.m1.3.3.cmml">V</mi><mo id="Sx3.E4.m1.5.5.1.1.4.11.2.4" stretchy="false" xref="Sx3.E4.m1.5.5.1.1.4.11.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E4.m1.5.5.1.1.3" xref="Sx3.E4.m1.5.5.1.1.3.cmml">=</mo><mrow id="Sx3.E4.m1.5.5.1.1.2" xref="Sx3.E4.m1.5.5.1.1.2.cmml"><mi id="Sx3.E4.m1.5.5.1.1.2.4" xref="Sx3.E4.m1.5.5.1.1.2.4.cmml">C</mi><mo id="Sx3.E4.m1.5.5.1.1.2.3" xref="Sx3.E4.m1.5.5.1.1.2.3.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.2.5" xref="Sx3.E4.m1.5.5.1.1.2.5.cmml">o</mi><mo id="Sx3.E4.m1.5.5.1.1.2.3a" xref="Sx3.E4.m1.5.5.1.1.2.3.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.2.6" xref="Sx3.E4.m1.5.5.1.1.2.6.cmml">n</mi><mo id="Sx3.E4.m1.5.5.1.1.2.3b" xref="Sx3.E4.m1.5.5.1.1.2.3.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.2.7" xref="Sx3.E4.m1.5.5.1.1.2.7.cmml">c</mi><mo id="Sx3.E4.m1.5.5.1.1.2.3c" xref="Sx3.E4.m1.5.5.1.1.2.3.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.2.8" xref="Sx3.E4.m1.5.5.1.1.2.8.cmml">a</mi><mo id="Sx3.E4.m1.5.5.1.1.2.3d" xref="Sx3.E4.m1.5.5.1.1.2.3.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.2.9" xref="Sx3.E4.m1.5.5.1.1.2.9.cmml">t</mi><mo id="Sx3.E4.m1.5.5.1.1.2.3e" xref="Sx3.E4.m1.5.5.1.1.2.3.cmml">⁢</mo><mrow id="Sx3.E4.m1.5.5.1.1.2.2.2" xref="Sx3.E4.m1.5.5.1.1.2.2.3.cmml"><mo id="Sx3.E4.m1.5.5.1.1.2.2.2.3" stretchy="false" xref="Sx3.E4.m1.5.5.1.1.2.2.3.cmml">(</mo><mrow id="Sx3.E4.m1.5.5.1.1.1.1.1.1" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.cmml"><mi id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.cmml">h</mi><mo id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.1.1.1.1.3" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.cmml">e</mi><mo id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1a" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.1.1.1.1.4" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.4.cmml">a</mi><mo id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1b" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="Sx3.E4.m1.5.5.1.1.1.1.1.1.5" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.5.cmml"><mi id="Sx3.E4.m1.5.5.1.1.1.1.1.1.5.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.5.2.cmml">d</mi><mn id="Sx3.E4.m1.5.5.1.1.1.1.1.1.5.3" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.5.3.cmml">1</mn></msub></mrow><mo id="Sx3.E4.m1.5.5.1.1.2.2.2.4" xref="Sx3.E4.m1.5.5.1.1.2.2.3.cmml">,</mo><mi id="Sx3.E4.m1.4.4" mathvariant="normal" xref="Sx3.E4.m1.4.4.cmml">…</mi><mo id="Sx3.E4.m1.5.5.1.1.2.2.2.5" xref="Sx3.E4.m1.5.5.1.1.2.2.3.cmml">,</mo><mrow id="Sx3.E4.m1.5.5.1.1.2.2.2.2" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.cmml"><mi id="Sx3.E4.m1.5.5.1.1.2.2.2.2.2" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.2.cmml">h</mi><mo id="Sx3.E4.m1.5.5.1.1.2.2.2.2.1" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.2.2.2.2.3" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.3.cmml">e</mi><mo id="Sx3.E4.m1.5.5.1.1.2.2.2.2.1a" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.1.cmml">⁢</mo><mi id="Sx3.E4.m1.5.5.1.1.2.2.2.2.4" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.4.cmml">a</mi><mo id="Sx3.E4.m1.5.5.1.1.2.2.2.2.1b" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.1.cmml">⁢</mo><msub id="Sx3.E4.m1.5.5.1.1.2.2.2.2.5" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.5.cmml"><mi id="Sx3.E4.m1.5.5.1.1.2.2.2.2.5.2" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.5.2.cmml">d</mi><mi id="Sx3.E4.m1.5.5.1.1.2.2.2.2.5.3" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.5.3.cmml">h</mi></msub></mrow><mo id="Sx3.E4.m1.5.5.1.1.2.2.2.6" stretchy="false" xref="Sx3.E4.m1.5.5.1.1.2.2.3.cmml">)</mo></mrow><mo id="Sx3.E4.m1.5.5.1.1.2.3f" xref="Sx3.E4.m1.5.5.1.1.2.3.cmml">⁢</mo><msup id="Sx3.E4.m1.5.5.1.1.2.10" xref="Sx3.E4.m1.5.5.1.1.2.10.cmml"><mi id="Sx3.E4.m1.5.5.1.1.2.10.2" xref="Sx3.E4.m1.5.5.1.1.2.10.2.cmml">W</mi><mi id="Sx3.E4.m1.5.5.1.1.2.10.3" xref="Sx3.E4.m1.5.5.1.1.2.10.3.cmml">O</mi></msup></mrow></mrow><mo id="Sx3.E4.m1.5.5.1.2" xref="Sx3.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E4.m1.5b"><apply id="Sx3.E4.m1.5.5.1.1.cmml" xref="Sx3.E4.m1.5.5.1"><eq id="Sx3.E4.m1.5.5.1.1.3.cmml" xref="Sx3.E4.m1.5.5.1.1.3"></eq><apply id="Sx3.E4.m1.5.5.1.1.4.cmml" xref="Sx3.E4.m1.5.5.1.1.4"><times id="Sx3.E4.m1.5.5.1.1.4.1.cmml" xref="Sx3.E4.m1.5.5.1.1.4.1"></times><ci id="Sx3.E4.m1.5.5.1.1.4.2.cmml" xref="Sx3.E4.m1.5.5.1.1.4.2">𝑀</ci><ci id="Sx3.E4.m1.5.5.1.1.4.3.cmml" xref="Sx3.E4.m1.5.5.1.1.4.3">𝑢</ci><ci id="Sx3.E4.m1.5.5.1.1.4.4.cmml" xref="Sx3.E4.m1.5.5.1.1.4.4">𝑙</ci><ci id="Sx3.E4.m1.5.5.1.1.4.5.cmml" xref="Sx3.E4.m1.5.5.1.1.4.5">𝑡</ci><ci id="Sx3.E4.m1.5.5.1.1.4.6.cmml" xref="Sx3.E4.m1.5.5.1.1.4.6">𝑖</ci><ci id="Sx3.E4.m1.5.5.1.1.4.7.cmml" xref="Sx3.E4.m1.5.5.1.1.4.7">𝐻</ci><ci id="Sx3.E4.m1.5.5.1.1.4.8.cmml" xref="Sx3.E4.m1.5.5.1.1.4.8">𝑒</ci><ci id="Sx3.E4.m1.5.5.1.1.4.9.cmml" xref="Sx3.E4.m1.5.5.1.1.4.9">𝑎</ci><ci id="Sx3.E4.m1.5.5.1.1.4.10.cmml" xref="Sx3.E4.m1.5.5.1.1.4.10">𝑑</ci><vector id="Sx3.E4.m1.5.5.1.1.4.11.1.cmml" xref="Sx3.E4.m1.5.5.1.1.4.11.2"><ci id="Sx3.E4.m1.1.1.cmml" xref="Sx3.E4.m1.1.1">𝑄</ci><ci id="Sx3.E4.m1.2.2.cmml" xref="Sx3.E4.m1.2.2">𝐾</ci><ci id="Sx3.E4.m1.3.3.cmml" xref="Sx3.E4.m1.3.3">𝑉</ci></vector></apply><apply id="Sx3.E4.m1.5.5.1.1.2.cmml" xref="Sx3.E4.m1.5.5.1.1.2"><times id="Sx3.E4.m1.5.5.1.1.2.3.cmml" xref="Sx3.E4.m1.5.5.1.1.2.3"></times><ci id="Sx3.E4.m1.5.5.1.1.2.4.cmml" xref="Sx3.E4.m1.5.5.1.1.2.4">𝐶</ci><ci id="Sx3.E4.m1.5.5.1.1.2.5.cmml" xref="Sx3.E4.m1.5.5.1.1.2.5">𝑜</ci><ci id="Sx3.E4.m1.5.5.1.1.2.6.cmml" xref="Sx3.E4.m1.5.5.1.1.2.6">𝑛</ci><ci id="Sx3.E4.m1.5.5.1.1.2.7.cmml" xref="Sx3.E4.m1.5.5.1.1.2.7">𝑐</ci><ci id="Sx3.E4.m1.5.5.1.1.2.8.cmml" xref="Sx3.E4.m1.5.5.1.1.2.8">𝑎</ci><ci id="Sx3.E4.m1.5.5.1.1.2.9.cmml" xref="Sx3.E4.m1.5.5.1.1.2.9">𝑡</ci><vector id="Sx3.E4.m1.5.5.1.1.2.2.3.cmml" xref="Sx3.E4.m1.5.5.1.1.2.2.2"><apply id="Sx3.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1"><times id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1"></times><ci id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2">ℎ</ci><ci id="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.3">𝑒</ci><ci id="Sx3.E4.m1.5.5.1.1.1.1.1.1.4.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.4">𝑎</ci><apply id="Sx3.E4.m1.5.5.1.1.1.1.1.1.5.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.5.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.5">subscript</csymbol><ci id="Sx3.E4.m1.5.5.1.1.1.1.1.1.5.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.5.2">𝑑</ci><cn id="Sx3.E4.m1.5.5.1.1.1.1.1.1.5.3.cmml" type="integer" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.5.3">1</cn></apply></apply><ci id="Sx3.E4.m1.4.4.cmml" xref="Sx3.E4.m1.4.4">…</ci><apply id="Sx3.E4.m1.5.5.1.1.2.2.2.2.cmml" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2"><times id="Sx3.E4.m1.5.5.1.1.2.2.2.2.1.cmml" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.1"></times><ci id="Sx3.E4.m1.5.5.1.1.2.2.2.2.2.cmml" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.2">ℎ</ci><ci id="Sx3.E4.m1.5.5.1.1.2.2.2.2.3.cmml" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.3">𝑒</ci><ci id="Sx3.E4.m1.5.5.1.1.2.2.2.2.4.cmml" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.4">𝑎</ci><apply id="Sx3.E4.m1.5.5.1.1.2.2.2.2.5.cmml" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.5"><csymbol cd="ambiguous" id="Sx3.E4.m1.5.5.1.1.2.2.2.2.5.1.cmml" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.5">subscript</csymbol><ci id="Sx3.E4.m1.5.5.1.1.2.2.2.2.5.2.cmml" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.5.2">𝑑</ci><ci id="Sx3.E4.m1.5.5.1.1.2.2.2.2.5.3.cmml" xref="Sx3.E4.m1.5.5.1.1.2.2.2.2.5.3">ℎ</ci></apply></apply></vector><apply id="Sx3.E4.m1.5.5.1.1.2.10.cmml" xref="Sx3.E4.m1.5.5.1.1.2.10"><csymbol cd="ambiguous" id="Sx3.E4.m1.5.5.1.1.2.10.1.cmml" xref="Sx3.E4.m1.5.5.1.1.2.10">superscript</csymbol><ci id="Sx3.E4.m1.5.5.1.1.2.10.2.cmml" xref="Sx3.E4.m1.5.5.1.1.2.10.2">𝑊</ci><ci id="Sx3.E4.m1.5.5.1.1.2.10.3.cmml" xref="Sx3.E4.m1.5.5.1.1.2.10.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E4.m1.5c">MultiHead(Q,K,V)=Concat(head_{1},\dots,head_{h})W^{O},</annotation><annotation encoding="application/x-llamapun" id="Sx3.E4.m1.5d">italic_M italic_u italic_l italic_t italic_i italic_H italic_e italic_a italic_d ( italic_Q , italic_K , italic_V ) = italic_C italic_o italic_n italic_c italic_a italic_t ( italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="Sx3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="head_{i}=Attention(QW_{i}^{Q},KW_{i}^{K},VW_{i}^{V})," class="ltx_Math" display="block" id="Sx3.E5.m1.1"><semantics id="Sx3.E5.m1.1a"><mrow id="Sx3.E5.m1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.cmml"><mrow id="Sx3.E5.m1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.cmml"><mrow id="Sx3.E5.m1.1.1.1.1.5" xref="Sx3.E5.m1.1.1.1.1.5.cmml"><mi id="Sx3.E5.m1.1.1.1.1.5.2" xref="Sx3.E5.m1.1.1.1.1.5.2.cmml">h</mi><mo id="Sx3.E5.m1.1.1.1.1.5.1" xref="Sx3.E5.m1.1.1.1.1.5.1.cmml">⁢</mo><mi id="Sx3.E5.m1.1.1.1.1.5.3" xref="Sx3.E5.m1.1.1.1.1.5.3.cmml">e</mi><mo id="Sx3.E5.m1.1.1.1.1.5.1a" xref="Sx3.E5.m1.1.1.1.1.5.1.cmml">⁢</mo><mi id="Sx3.E5.m1.1.1.1.1.5.4" xref="Sx3.E5.m1.1.1.1.1.5.4.cmml">a</mi><mo id="Sx3.E5.m1.1.1.1.1.5.1b" xref="Sx3.E5.m1.1.1.1.1.5.1.cmml">⁢</mo><msub id="Sx3.E5.m1.1.1.1.1.5.5" xref="Sx3.E5.m1.1.1.1.1.5.5.cmml"><mi id="Sx3.E5.m1.1.1.1.1.5.5.2" xref="Sx3.E5.m1.1.1.1.1.5.5.2.cmml">d</mi><mi id="Sx3.E5.m1.1.1.1.1.5.5.3" xref="Sx3.E5.m1.1.1.1.1.5.5.3.cmml">i</mi></msub></mrow><mo id="Sx3.E5.m1.1.1.1.1.4" xref="Sx3.E5.m1.1.1.1.1.4.cmml">=</mo><mrow id="Sx3.E5.m1.1.1.1.1.3" xref="Sx3.E5.m1.1.1.1.1.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1.3.5" xref="Sx3.E5.m1.1.1.1.1.3.5.cmml">A</mi><mo id="Sx3.E5.m1.1.1.1.1.3.4" xref="Sx3.E5.m1.1.1.1.1.3.4.cmml">⁢</mo><mi id="Sx3.E5.m1.1.1.1.1.3.6" xref="Sx3.E5.m1.1.1.1.1.3.6.cmml">t</mi><mo id="Sx3.E5.m1.1.1.1.1.3.4a" xref="Sx3.E5.m1.1.1.1.1.3.4.cmml">⁢</mo><mi id="Sx3.E5.m1.1.1.1.1.3.7" xref="Sx3.E5.m1.1.1.1.1.3.7.cmml">t</mi><mo id="Sx3.E5.m1.1.1.1.1.3.4b" xref="Sx3.E5.m1.1.1.1.1.3.4.cmml">⁢</mo><mi id="Sx3.E5.m1.1.1.1.1.3.8" xref="Sx3.E5.m1.1.1.1.1.3.8.cmml">e</mi><mo id="Sx3.E5.m1.1.1.1.1.3.4c" xref="Sx3.E5.m1.1.1.1.1.3.4.cmml">⁢</mo><mi id="Sx3.E5.m1.1.1.1.1.3.9" xref="Sx3.E5.m1.1.1.1.1.3.9.cmml">n</mi><mo id="Sx3.E5.m1.1.1.1.1.3.4d" xref="Sx3.E5.m1.1.1.1.1.3.4.cmml">⁢</mo><mi id="Sx3.E5.m1.1.1.1.1.3.10" xref="Sx3.E5.m1.1.1.1.1.3.10.cmml">t</mi><mo id="Sx3.E5.m1.1.1.1.1.3.4e" xref="Sx3.E5.m1.1.1.1.1.3.4.cmml">⁢</mo><mi id="Sx3.E5.m1.1.1.1.1.3.11" xref="Sx3.E5.m1.1.1.1.1.3.11.cmml">i</mi><mo id="Sx3.E5.m1.1.1.1.1.3.4f" xref="Sx3.E5.m1.1.1.1.1.3.4.cmml">⁢</mo><mi id="Sx3.E5.m1.1.1.1.1.3.12" xref="Sx3.E5.m1.1.1.1.1.3.12.cmml">o</mi><mo id="Sx3.E5.m1.1.1.1.1.3.4g" xref="Sx3.E5.m1.1.1.1.1.3.4.cmml">⁢</mo><mi id="Sx3.E5.m1.1.1.1.1.3.13" xref="Sx3.E5.m1.1.1.1.1.3.13.cmml">n</mi><mo id="Sx3.E5.m1.1.1.1.1.3.4h" xref="Sx3.E5.m1.1.1.1.1.3.4.cmml">⁢</mo><mrow id="Sx3.E5.m1.1.1.1.1.3.3.3" xref="Sx3.E5.m1.1.1.1.1.3.3.4.cmml"><mo id="Sx3.E5.m1.1.1.1.1.3.3.3.4" stretchy="false" xref="Sx3.E5.m1.1.1.1.1.3.3.4.cmml">(</mo><mrow id="Sx3.E5.m1.1.1.1.1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.2.cmml">Q</mi><mo id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.2.2" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.2.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msubsup></mrow><mo id="Sx3.E5.m1.1.1.1.1.3.3.3.5" xref="Sx3.E5.m1.1.1.1.1.3.3.4.cmml">,</mo><mrow id="Sx3.E5.m1.1.1.1.1.2.2.2.2" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.cmml"><mi id="Sx3.E5.m1.1.1.1.1.2.2.2.2.2" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.2.cmml">K</mi><mo id="Sx3.E5.m1.1.1.1.1.2.2.2.2.1" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.1.cmml">⁢</mo><msubsup id="Sx3.E5.m1.1.1.1.1.2.2.2.2.3" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.2.2" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.2.2.cmml">W</mi><mi id="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.2.3" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.2.3.cmml">i</mi><mi id="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.3" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.3.cmml">K</mi></msubsup></mrow><mo id="Sx3.E5.m1.1.1.1.1.3.3.3.6" xref="Sx3.E5.m1.1.1.1.1.3.3.4.cmml">,</mo><mrow id="Sx3.E5.m1.1.1.1.1.3.3.3.3" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1.3.3.3.3.2" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.2.cmml">V</mi><mo id="Sx3.E5.m1.1.1.1.1.3.3.3.3.1" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><msubsup id="Sx3.E5.m1.1.1.1.1.3.3.3.3.3" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.2.2" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.2.2.cmml">W</mi><mi id="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.2.3" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.2.3.cmml">i</mi><mi id="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.3" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.3.cmml">V</mi></msubsup></mrow><mo id="Sx3.E5.m1.1.1.1.1.3.3.3.7" stretchy="false" xref="Sx3.E5.m1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E5.m1.1.1.1.2" xref="Sx3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E5.m1.1b"><apply id="Sx3.E5.m1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1"><eq id="Sx3.E5.m1.1.1.1.1.4.cmml" xref="Sx3.E5.m1.1.1.1.1.4"></eq><apply id="Sx3.E5.m1.1.1.1.1.5.cmml" xref="Sx3.E5.m1.1.1.1.1.5"><times id="Sx3.E5.m1.1.1.1.1.5.1.cmml" xref="Sx3.E5.m1.1.1.1.1.5.1"></times><ci id="Sx3.E5.m1.1.1.1.1.5.2.cmml" xref="Sx3.E5.m1.1.1.1.1.5.2">ℎ</ci><ci id="Sx3.E5.m1.1.1.1.1.5.3.cmml" xref="Sx3.E5.m1.1.1.1.1.5.3">𝑒</ci><ci id="Sx3.E5.m1.1.1.1.1.5.4.cmml" xref="Sx3.E5.m1.1.1.1.1.5.4">𝑎</ci><apply id="Sx3.E5.m1.1.1.1.1.5.5.cmml" xref="Sx3.E5.m1.1.1.1.1.5.5"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.5.5.1.cmml" xref="Sx3.E5.m1.1.1.1.1.5.5">subscript</csymbol><ci id="Sx3.E5.m1.1.1.1.1.5.5.2.cmml" xref="Sx3.E5.m1.1.1.1.1.5.5.2">𝑑</ci><ci id="Sx3.E5.m1.1.1.1.1.5.5.3.cmml" xref="Sx3.E5.m1.1.1.1.1.5.5.3">𝑖</ci></apply></apply><apply id="Sx3.E5.m1.1.1.1.1.3.cmml" xref="Sx3.E5.m1.1.1.1.1.3"><times id="Sx3.E5.m1.1.1.1.1.3.4.cmml" xref="Sx3.E5.m1.1.1.1.1.3.4"></times><ci id="Sx3.E5.m1.1.1.1.1.3.5.cmml" xref="Sx3.E5.m1.1.1.1.1.3.5">𝐴</ci><ci id="Sx3.E5.m1.1.1.1.1.3.6.cmml" xref="Sx3.E5.m1.1.1.1.1.3.6">𝑡</ci><ci id="Sx3.E5.m1.1.1.1.1.3.7.cmml" xref="Sx3.E5.m1.1.1.1.1.3.7">𝑡</ci><ci id="Sx3.E5.m1.1.1.1.1.3.8.cmml" xref="Sx3.E5.m1.1.1.1.1.3.8">𝑒</ci><ci id="Sx3.E5.m1.1.1.1.1.3.9.cmml" xref="Sx3.E5.m1.1.1.1.1.3.9">𝑛</ci><ci id="Sx3.E5.m1.1.1.1.1.3.10.cmml" xref="Sx3.E5.m1.1.1.1.1.3.10">𝑡</ci><ci id="Sx3.E5.m1.1.1.1.1.3.11.cmml" xref="Sx3.E5.m1.1.1.1.1.3.11">𝑖</ci><ci id="Sx3.E5.m1.1.1.1.1.3.12.cmml" xref="Sx3.E5.m1.1.1.1.1.3.12">𝑜</ci><ci id="Sx3.E5.m1.1.1.1.1.3.13.cmml" xref="Sx3.E5.m1.1.1.1.1.3.13">𝑛</ci><vector id="Sx3.E5.m1.1.1.1.1.3.3.4.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3"><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1"><times id="Sx3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.1"></times><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.2">𝑄</ci><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="Sx3.E5.m1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2"><times id="Sx3.E5.m1.1.1.1.1.2.2.2.2.1.cmml" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.1"></times><ci id="Sx3.E5.m1.1.1.1.1.2.2.2.2.2.cmml" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.2">𝐾</ci><apply id="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.cmml" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.3">superscript</csymbol><apply id="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.2.1.cmml" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.2.2.cmml" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.2.2">𝑊</ci><ci id="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.2.3.cmml" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.2.2.2.2.3.3">𝐾</ci></apply></apply><apply id="Sx3.E5.m1.1.1.1.1.3.3.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3"><times id="Sx3.E5.m1.1.1.1.1.3.3.3.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.1"></times><ci id="Sx3.E5.m1.1.1.1.1.3.3.3.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.2">𝑉</ci><apply id="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.1.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.3">superscript</csymbol><apply id="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.2.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.2.1.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.3">subscript</csymbol><ci id="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.2.2.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.2.2">𝑊</ci><ci id="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.2.3.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.2.3">𝑖</ci></apply><ci id="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.3.cmml" xref="Sx3.E5.m1.1.1.1.1.3.3.3.3.3.3">𝑉</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E5.m1.1c">head_{i}=Attention(QW_{i}^{Q},KW_{i}^{K},VW_{i}^{V}),</annotation><annotation encoding="application/x-llamapun" id="Sx3.E5.m1.1d">italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ( italic_Q italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_K italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , italic_V italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx3.SSx5.p1.10">where <math alttext="Q\in\mathbb{R}^{B\times L\times D}" class="ltx_Math" display="inline" id="Sx3.SSx5.p1.1.m1.1"><semantics id="Sx3.SSx5.p1.1.m1.1a"><mrow id="Sx3.SSx5.p1.1.m1.1.1" xref="Sx3.SSx5.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx5.p1.1.m1.1.1.2" xref="Sx3.SSx5.p1.1.m1.1.1.2.cmml">Q</mi><mo id="Sx3.SSx5.p1.1.m1.1.1.1" xref="Sx3.SSx5.p1.1.m1.1.1.1.cmml">∈</mo><msup id="Sx3.SSx5.p1.1.m1.1.1.3" xref="Sx3.SSx5.p1.1.m1.1.1.3.cmml"><mi id="Sx3.SSx5.p1.1.m1.1.1.3.2" xref="Sx3.SSx5.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx5.p1.1.m1.1.1.3.3" xref="Sx3.SSx5.p1.1.m1.1.1.3.3.cmml"><mi id="Sx3.SSx5.p1.1.m1.1.1.3.3.2" xref="Sx3.SSx5.p1.1.m1.1.1.3.3.2.cmml">B</mi><mo id="Sx3.SSx5.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx5.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx5.p1.1.m1.1.1.3.3.3" xref="Sx3.SSx5.p1.1.m1.1.1.3.3.3.cmml">L</mi><mo id="Sx3.SSx5.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx5.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx5.p1.1.m1.1.1.3.3.4" xref="Sx3.SSx5.p1.1.m1.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.1.m1.1b"><apply id="Sx3.SSx5.p1.1.m1.1.1.cmml" xref="Sx3.SSx5.p1.1.m1.1.1"><in id="Sx3.SSx5.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.1"></in><ci id="Sx3.SSx5.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.2">𝑄</ci><apply id="Sx3.SSx5.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.1.m1.1.1.3.1.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3">superscript</csymbol><ci id="Sx3.SSx5.p1.1.m1.1.1.3.2.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3.2">ℝ</ci><apply id="Sx3.SSx5.p1.1.m1.1.1.3.3.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3.3"><times id="Sx3.SSx5.p1.1.m1.1.1.3.3.1.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3.3.1"></times><ci id="Sx3.SSx5.p1.1.m1.1.1.3.3.2.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3.3.2">𝐵</ci><ci id="Sx3.SSx5.p1.1.m1.1.1.3.3.3.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3.3.3">𝐿</ci><ci id="Sx3.SSx5.p1.1.m1.1.1.3.3.4.cmml" xref="Sx3.SSx5.p1.1.m1.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.1.m1.1c">Q\in\mathbb{R}^{B\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx5.p1.1.m1.1d">italic_Q ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is the query matrix. <math alttext="K\in\mathbb{R}^{B\times L\times D}" class="ltx_Math" display="inline" id="Sx3.SSx5.p1.2.m2.1"><semantics id="Sx3.SSx5.p1.2.m2.1a"><mrow id="Sx3.SSx5.p1.2.m2.1.1" xref="Sx3.SSx5.p1.2.m2.1.1.cmml"><mi id="Sx3.SSx5.p1.2.m2.1.1.2" xref="Sx3.SSx5.p1.2.m2.1.1.2.cmml">K</mi><mo id="Sx3.SSx5.p1.2.m2.1.1.1" xref="Sx3.SSx5.p1.2.m2.1.1.1.cmml">∈</mo><msup id="Sx3.SSx5.p1.2.m2.1.1.3" xref="Sx3.SSx5.p1.2.m2.1.1.3.cmml"><mi id="Sx3.SSx5.p1.2.m2.1.1.3.2" xref="Sx3.SSx5.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx5.p1.2.m2.1.1.3.3" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.cmml"><mi id="Sx3.SSx5.p1.2.m2.1.1.3.3.2" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.2.cmml">B</mi><mo id="Sx3.SSx5.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx5.p1.2.m2.1.1.3.3.3" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.3.cmml">L</mi><mo id="Sx3.SSx5.p1.2.m2.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx5.p1.2.m2.1.1.3.3.4" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.2.m2.1b"><apply id="Sx3.SSx5.p1.2.m2.1.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1"><in id="Sx3.SSx5.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.1"></in><ci id="Sx3.SSx5.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.2">𝐾</ci><apply id="Sx3.SSx5.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.2.m2.1.1.3.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3">superscript</csymbol><ci id="Sx3.SSx5.p1.2.m2.1.1.3.2.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.2">ℝ</ci><apply id="Sx3.SSx5.p1.2.m2.1.1.3.3.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.3"><times id="Sx3.SSx5.p1.2.m2.1.1.3.3.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.1"></times><ci id="Sx3.SSx5.p1.2.m2.1.1.3.3.2.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.2">𝐵</ci><ci id="Sx3.SSx5.p1.2.m2.1.1.3.3.3.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.3">𝐿</ci><ci id="Sx3.SSx5.p1.2.m2.1.1.3.3.4.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.2.m2.1c">K\in\mathbb{R}^{B\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx5.p1.2.m2.1d">italic_K ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is the key matrix. <math alttext="V\in\mathbb{R}^{B\times L\times D}" class="ltx_Math" display="inline" id="Sx3.SSx5.p1.3.m3.1"><semantics id="Sx3.SSx5.p1.3.m3.1a"><mrow id="Sx3.SSx5.p1.3.m3.1.1" xref="Sx3.SSx5.p1.3.m3.1.1.cmml"><mi id="Sx3.SSx5.p1.3.m3.1.1.2" xref="Sx3.SSx5.p1.3.m3.1.1.2.cmml">V</mi><mo id="Sx3.SSx5.p1.3.m3.1.1.1" xref="Sx3.SSx5.p1.3.m3.1.1.1.cmml">∈</mo><msup id="Sx3.SSx5.p1.3.m3.1.1.3" xref="Sx3.SSx5.p1.3.m3.1.1.3.cmml"><mi id="Sx3.SSx5.p1.3.m3.1.1.3.2" xref="Sx3.SSx5.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx5.p1.3.m3.1.1.3.3" xref="Sx3.SSx5.p1.3.m3.1.1.3.3.cmml"><mi id="Sx3.SSx5.p1.3.m3.1.1.3.3.2" xref="Sx3.SSx5.p1.3.m3.1.1.3.3.2.cmml">B</mi><mo id="Sx3.SSx5.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx5.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx5.p1.3.m3.1.1.3.3.3" xref="Sx3.SSx5.p1.3.m3.1.1.3.3.3.cmml">L</mi><mo id="Sx3.SSx5.p1.3.m3.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx5.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx5.p1.3.m3.1.1.3.3.4" xref="Sx3.SSx5.p1.3.m3.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.3.m3.1b"><apply id="Sx3.SSx5.p1.3.m3.1.1.cmml" xref="Sx3.SSx5.p1.3.m3.1.1"><in id="Sx3.SSx5.p1.3.m3.1.1.1.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.1"></in><ci id="Sx3.SSx5.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.2">𝑉</ci><apply id="Sx3.SSx5.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.3.m3.1.1.3.1.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3">superscript</csymbol><ci id="Sx3.SSx5.p1.3.m3.1.1.3.2.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3.2">ℝ</ci><apply id="Sx3.SSx5.p1.3.m3.1.1.3.3.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3.3"><times id="Sx3.SSx5.p1.3.m3.1.1.3.3.1.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3.3.1"></times><ci id="Sx3.SSx5.p1.3.m3.1.1.3.3.2.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3.3.2">𝐵</ci><ci id="Sx3.SSx5.p1.3.m3.1.1.3.3.3.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3.3.3">𝐿</ci><ci id="Sx3.SSx5.p1.3.m3.1.1.3.3.4.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.3.m3.1c">V\in\mathbb{R}^{B\times L\times D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx5.p1.3.m3.1d">italic_V ∈ blackboard_R start_POSTSUPERSCRIPT italic_B × italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is the value matrix. <math alttext="W_{i}^{Q}\in\mathbb{R}^{D\times d_{k}}" class="ltx_Math" display="inline" id="Sx3.SSx5.p1.4.m4.1"><semantics id="Sx3.SSx5.p1.4.m4.1a"><mrow id="Sx3.SSx5.p1.4.m4.1.1" xref="Sx3.SSx5.p1.4.m4.1.1.cmml"><msubsup id="Sx3.SSx5.p1.4.m4.1.1.2" xref="Sx3.SSx5.p1.4.m4.1.1.2.cmml"><mi id="Sx3.SSx5.p1.4.m4.1.1.2.2.2" xref="Sx3.SSx5.p1.4.m4.1.1.2.2.2.cmml">W</mi><mi id="Sx3.SSx5.p1.4.m4.1.1.2.2.3" xref="Sx3.SSx5.p1.4.m4.1.1.2.2.3.cmml">i</mi><mi id="Sx3.SSx5.p1.4.m4.1.1.2.3" xref="Sx3.SSx5.p1.4.m4.1.1.2.3.cmml">Q</mi></msubsup><mo id="Sx3.SSx5.p1.4.m4.1.1.1" xref="Sx3.SSx5.p1.4.m4.1.1.1.cmml">∈</mo><msup id="Sx3.SSx5.p1.4.m4.1.1.3" xref="Sx3.SSx5.p1.4.m4.1.1.3.cmml"><mi id="Sx3.SSx5.p1.4.m4.1.1.3.2" xref="Sx3.SSx5.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx5.p1.4.m4.1.1.3.3" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.cmml"><mi id="Sx3.SSx5.p1.4.m4.1.1.3.3.2" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.2.cmml">D</mi><mo id="Sx3.SSx5.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.1.cmml">×</mo><msub id="Sx3.SSx5.p1.4.m4.1.1.3.3.3" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.3.cmml"><mi id="Sx3.SSx5.p1.4.m4.1.1.3.3.3.2" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.3.2.cmml">d</mi><mi id="Sx3.SSx5.p1.4.m4.1.1.3.3.3.3" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.4.m4.1b"><apply id="Sx3.SSx5.p1.4.m4.1.1.cmml" xref="Sx3.SSx5.p1.4.m4.1.1"><in id="Sx3.SSx5.p1.4.m4.1.1.1.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.1"></in><apply id="Sx3.SSx5.p1.4.m4.1.1.2.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.4.m4.1.1.2.1.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.2">superscript</csymbol><apply id="Sx3.SSx5.p1.4.m4.1.1.2.2.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.4.m4.1.1.2.2.1.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.2">subscript</csymbol><ci id="Sx3.SSx5.p1.4.m4.1.1.2.2.2.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.2.2.2">𝑊</ci><ci id="Sx3.SSx5.p1.4.m4.1.1.2.2.3.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx5.p1.4.m4.1.1.2.3.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.2.3">𝑄</ci></apply><apply id="Sx3.SSx5.p1.4.m4.1.1.3.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.4.m4.1.1.3.1.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.3">superscript</csymbol><ci id="Sx3.SSx5.p1.4.m4.1.1.3.2.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.3.2">ℝ</ci><apply id="Sx3.SSx5.p1.4.m4.1.1.3.3.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.3.3"><times id="Sx3.SSx5.p1.4.m4.1.1.3.3.1.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.1"></times><ci id="Sx3.SSx5.p1.4.m4.1.1.3.3.2.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.2">𝐷</ci><apply id="Sx3.SSx5.p1.4.m4.1.1.3.3.3.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.4.m4.1.1.3.3.3.1.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.3">subscript</csymbol><ci id="Sx3.SSx5.p1.4.m4.1.1.3.3.3.2.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="Sx3.SSx5.p1.4.m4.1.1.3.3.3.3.cmml" xref="Sx3.SSx5.p1.4.m4.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.4.m4.1c">W_{i}^{Q}\in\mathbb{R}^{D\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx5.p1.4.m4.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the query weight matrix. <math alttext="W_{i}^{K}\in\mathbb{R}^{D\times d_{k}}" class="ltx_Math" display="inline" id="Sx3.SSx5.p1.5.m5.1"><semantics id="Sx3.SSx5.p1.5.m5.1a"><mrow id="Sx3.SSx5.p1.5.m5.1.1" xref="Sx3.SSx5.p1.5.m5.1.1.cmml"><msubsup id="Sx3.SSx5.p1.5.m5.1.1.2" xref="Sx3.SSx5.p1.5.m5.1.1.2.cmml"><mi id="Sx3.SSx5.p1.5.m5.1.1.2.2.2" xref="Sx3.SSx5.p1.5.m5.1.1.2.2.2.cmml">W</mi><mi id="Sx3.SSx5.p1.5.m5.1.1.2.2.3" xref="Sx3.SSx5.p1.5.m5.1.1.2.2.3.cmml">i</mi><mi id="Sx3.SSx5.p1.5.m5.1.1.2.3" xref="Sx3.SSx5.p1.5.m5.1.1.2.3.cmml">K</mi></msubsup><mo id="Sx3.SSx5.p1.5.m5.1.1.1" xref="Sx3.SSx5.p1.5.m5.1.1.1.cmml">∈</mo><msup id="Sx3.SSx5.p1.5.m5.1.1.3" xref="Sx3.SSx5.p1.5.m5.1.1.3.cmml"><mi id="Sx3.SSx5.p1.5.m5.1.1.3.2" xref="Sx3.SSx5.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx5.p1.5.m5.1.1.3.3" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.cmml"><mi id="Sx3.SSx5.p1.5.m5.1.1.3.3.2" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.2.cmml">D</mi><mo id="Sx3.SSx5.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.1.cmml">×</mo><msub id="Sx3.SSx5.p1.5.m5.1.1.3.3.3" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.3.cmml"><mi id="Sx3.SSx5.p1.5.m5.1.1.3.3.3.2" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.3.2.cmml">d</mi><mi id="Sx3.SSx5.p1.5.m5.1.1.3.3.3.3" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.5.m5.1b"><apply id="Sx3.SSx5.p1.5.m5.1.1.cmml" xref="Sx3.SSx5.p1.5.m5.1.1"><in id="Sx3.SSx5.p1.5.m5.1.1.1.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.1"></in><apply id="Sx3.SSx5.p1.5.m5.1.1.2.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.5.m5.1.1.2.1.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.2">superscript</csymbol><apply id="Sx3.SSx5.p1.5.m5.1.1.2.2.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.5.m5.1.1.2.2.1.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.2">subscript</csymbol><ci id="Sx3.SSx5.p1.5.m5.1.1.2.2.2.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.2.2.2">𝑊</ci><ci id="Sx3.SSx5.p1.5.m5.1.1.2.2.3.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx5.p1.5.m5.1.1.2.3.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.2.3">𝐾</ci></apply><apply id="Sx3.SSx5.p1.5.m5.1.1.3.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.5.m5.1.1.3.1.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.3">superscript</csymbol><ci id="Sx3.SSx5.p1.5.m5.1.1.3.2.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.3.2">ℝ</ci><apply id="Sx3.SSx5.p1.5.m5.1.1.3.3.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.3.3"><times id="Sx3.SSx5.p1.5.m5.1.1.3.3.1.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.1"></times><ci id="Sx3.SSx5.p1.5.m5.1.1.3.3.2.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.2">𝐷</ci><apply id="Sx3.SSx5.p1.5.m5.1.1.3.3.3.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.5.m5.1.1.3.3.3.1.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.3">subscript</csymbol><ci id="Sx3.SSx5.p1.5.m5.1.1.3.3.3.2.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.3.2">𝑑</ci><ci id="Sx3.SSx5.p1.5.m5.1.1.3.3.3.3.cmml" xref="Sx3.SSx5.p1.5.m5.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.5.m5.1c">W_{i}^{K}\in\mathbb{R}^{D\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx5.p1.5.m5.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the key weight matrix. <math alttext="W_{i}^{V}\in\mathbb{R}^{D\times d_{v}}" class="ltx_Math" display="inline" id="Sx3.SSx5.p1.6.m6.1"><semantics id="Sx3.SSx5.p1.6.m6.1a"><mrow id="Sx3.SSx5.p1.6.m6.1.1" xref="Sx3.SSx5.p1.6.m6.1.1.cmml"><msubsup id="Sx3.SSx5.p1.6.m6.1.1.2" xref="Sx3.SSx5.p1.6.m6.1.1.2.cmml"><mi id="Sx3.SSx5.p1.6.m6.1.1.2.2.2" xref="Sx3.SSx5.p1.6.m6.1.1.2.2.2.cmml">W</mi><mi id="Sx3.SSx5.p1.6.m6.1.1.2.2.3" xref="Sx3.SSx5.p1.6.m6.1.1.2.2.3.cmml">i</mi><mi id="Sx3.SSx5.p1.6.m6.1.1.2.3" xref="Sx3.SSx5.p1.6.m6.1.1.2.3.cmml">V</mi></msubsup><mo id="Sx3.SSx5.p1.6.m6.1.1.1" xref="Sx3.SSx5.p1.6.m6.1.1.1.cmml">∈</mo><msup id="Sx3.SSx5.p1.6.m6.1.1.3" xref="Sx3.SSx5.p1.6.m6.1.1.3.cmml"><mi id="Sx3.SSx5.p1.6.m6.1.1.3.2" xref="Sx3.SSx5.p1.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx5.p1.6.m6.1.1.3.3" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.cmml"><mi id="Sx3.SSx5.p1.6.m6.1.1.3.3.2" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.2.cmml">D</mi><mo id="Sx3.SSx5.p1.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.1.cmml">×</mo><msub id="Sx3.SSx5.p1.6.m6.1.1.3.3.3" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.3.cmml"><mi id="Sx3.SSx5.p1.6.m6.1.1.3.3.3.2" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.3.2.cmml">d</mi><mi id="Sx3.SSx5.p1.6.m6.1.1.3.3.3.3" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.6.m6.1b"><apply id="Sx3.SSx5.p1.6.m6.1.1.cmml" xref="Sx3.SSx5.p1.6.m6.1.1"><in id="Sx3.SSx5.p1.6.m6.1.1.1.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.1"></in><apply id="Sx3.SSx5.p1.6.m6.1.1.2.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.6.m6.1.1.2.1.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.2">superscript</csymbol><apply id="Sx3.SSx5.p1.6.m6.1.1.2.2.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.6.m6.1.1.2.2.1.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.2">subscript</csymbol><ci id="Sx3.SSx5.p1.6.m6.1.1.2.2.2.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.2.2.2">𝑊</ci><ci id="Sx3.SSx5.p1.6.m6.1.1.2.2.3.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx5.p1.6.m6.1.1.2.3.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.2.3">𝑉</ci></apply><apply id="Sx3.SSx5.p1.6.m6.1.1.3.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.6.m6.1.1.3.1.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.3">superscript</csymbol><ci id="Sx3.SSx5.p1.6.m6.1.1.3.2.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.3.2">ℝ</ci><apply id="Sx3.SSx5.p1.6.m6.1.1.3.3.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.3.3"><times id="Sx3.SSx5.p1.6.m6.1.1.3.3.1.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.1"></times><ci id="Sx3.SSx5.p1.6.m6.1.1.3.3.2.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.2">𝐷</ci><apply id="Sx3.SSx5.p1.6.m6.1.1.3.3.3.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.6.m6.1.1.3.3.3.1.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.3">subscript</csymbol><ci id="Sx3.SSx5.p1.6.m6.1.1.3.3.3.2.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.3.2">𝑑</ci><ci id="Sx3.SSx5.p1.6.m6.1.1.3.3.3.3.cmml" xref="Sx3.SSx5.p1.6.m6.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.6.m6.1c">W_{i}^{V}\in\mathbb{R}^{D\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx5.p1.6.m6.1d">italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the value weight matrix. <math alttext="W^{O}\in\mathbb{R}^{h\cdot d_{v}\times D}" class="ltx_Math" display="inline" id="Sx3.SSx5.p1.7.m7.1"><semantics id="Sx3.SSx5.p1.7.m7.1a"><mrow id="Sx3.SSx5.p1.7.m7.1.1" xref="Sx3.SSx5.p1.7.m7.1.1.cmml"><msup id="Sx3.SSx5.p1.7.m7.1.1.2" xref="Sx3.SSx5.p1.7.m7.1.1.2.cmml"><mi id="Sx3.SSx5.p1.7.m7.1.1.2.2" xref="Sx3.SSx5.p1.7.m7.1.1.2.2.cmml">W</mi><mi id="Sx3.SSx5.p1.7.m7.1.1.2.3" xref="Sx3.SSx5.p1.7.m7.1.1.2.3.cmml">O</mi></msup><mo id="Sx3.SSx5.p1.7.m7.1.1.1" xref="Sx3.SSx5.p1.7.m7.1.1.1.cmml">∈</mo><msup id="Sx3.SSx5.p1.7.m7.1.1.3" xref="Sx3.SSx5.p1.7.m7.1.1.3.cmml"><mi id="Sx3.SSx5.p1.7.m7.1.1.3.2" xref="Sx3.SSx5.p1.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx5.p1.7.m7.1.1.3.3" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.cmml"><mrow id="Sx3.SSx5.p1.7.m7.1.1.3.3.2" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.cmml"><mi id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.2" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.2.cmml">h</mi><mo id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.1.cmml">⋅</mo><msub id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3.cmml"><mi id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3.2" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3.2.cmml">d</mi><mi id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3.3" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3.3.cmml">v</mi></msub></mrow><mo id="Sx3.SSx5.p1.7.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.1.cmml">×</mo><mi id="Sx3.SSx5.p1.7.m7.1.1.3.3.3" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.7.m7.1b"><apply id="Sx3.SSx5.p1.7.m7.1.1.cmml" xref="Sx3.SSx5.p1.7.m7.1.1"><in id="Sx3.SSx5.p1.7.m7.1.1.1.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.1"></in><apply id="Sx3.SSx5.p1.7.m7.1.1.2.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.7.m7.1.1.2.1.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.2">superscript</csymbol><ci id="Sx3.SSx5.p1.7.m7.1.1.2.2.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.2.2">𝑊</ci><ci id="Sx3.SSx5.p1.7.m7.1.1.2.3.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.2.3">𝑂</ci></apply><apply id="Sx3.SSx5.p1.7.m7.1.1.3.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.7.m7.1.1.3.1.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3">superscript</csymbol><ci id="Sx3.SSx5.p1.7.m7.1.1.3.2.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3.2">ℝ</ci><apply id="Sx3.SSx5.p1.7.m7.1.1.3.3.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3.3"><times id="Sx3.SSx5.p1.7.m7.1.1.3.3.1.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.1"></times><apply id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2"><ci id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.1.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.1">⋅</ci><ci id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.2.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.2">ℎ</ci><apply id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3.1.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3">subscript</csymbol><ci id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3.2.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3.2">𝑑</ci><ci id="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3.3.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.2.3.3">𝑣</ci></apply></apply><ci id="Sx3.SSx5.p1.7.m7.1.1.3.3.3.cmml" xref="Sx3.SSx5.p1.7.m7.1.1.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.7.m7.1c">W^{O}\in\mathbb{R}^{h\cdot d_{v}\times D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx5.p1.7.m7.1d">italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_h ⋅ italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is the output weight matrix.where <math alttext="h" class="ltx_Math" display="inline" id="Sx3.SSx5.p1.8.m8.1"><semantics id="Sx3.SSx5.p1.8.m8.1a"><mi id="Sx3.SSx5.p1.8.m8.1.1" xref="Sx3.SSx5.p1.8.m8.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.8.m8.1b"><ci id="Sx3.SSx5.p1.8.m8.1.1.cmml" xref="Sx3.SSx5.p1.8.m8.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.8.m8.1c">h</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx5.p1.8.m8.1d">italic_h</annotation></semantics></math> is the number of attention heads, and <math alttext="d_{k}" class="ltx_Math" display="inline" id="Sx3.SSx5.p1.9.m9.1"><semantics id="Sx3.SSx5.p1.9.m9.1a"><msub id="Sx3.SSx5.p1.9.m9.1.1" xref="Sx3.SSx5.p1.9.m9.1.1.cmml"><mi id="Sx3.SSx5.p1.9.m9.1.1.2" xref="Sx3.SSx5.p1.9.m9.1.1.2.cmml">d</mi><mi id="Sx3.SSx5.p1.9.m9.1.1.3" xref="Sx3.SSx5.p1.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.9.m9.1b"><apply id="Sx3.SSx5.p1.9.m9.1.1.cmml" xref="Sx3.SSx5.p1.9.m9.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.9.m9.1.1.1.cmml" xref="Sx3.SSx5.p1.9.m9.1.1">subscript</csymbol><ci id="Sx3.SSx5.p1.9.m9.1.1.2.cmml" xref="Sx3.SSx5.p1.9.m9.1.1.2">𝑑</ci><ci id="Sx3.SSx5.p1.9.m9.1.1.3.cmml" xref="Sx3.SSx5.p1.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.9.m9.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx5.p1.9.m9.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="d_{v}" class="ltx_Math" display="inline" id="Sx3.SSx5.p1.10.m10.1"><semantics id="Sx3.SSx5.p1.10.m10.1a"><msub id="Sx3.SSx5.p1.10.m10.1.1" xref="Sx3.SSx5.p1.10.m10.1.1.cmml"><mi id="Sx3.SSx5.p1.10.m10.1.1.2" xref="Sx3.SSx5.p1.10.m10.1.1.2.cmml">d</mi><mi id="Sx3.SSx5.p1.10.m10.1.1.3" xref="Sx3.SSx5.p1.10.m10.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.10.m10.1b"><apply id="Sx3.SSx5.p1.10.m10.1.1.cmml" xref="Sx3.SSx5.p1.10.m10.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.10.m10.1.1.1.cmml" xref="Sx3.SSx5.p1.10.m10.1.1">subscript</csymbol><ci id="Sx3.SSx5.p1.10.m10.1.1.2.cmml" xref="Sx3.SSx5.p1.10.m10.1.1.2">𝑑</ci><ci id="Sx3.SSx5.p1.10.m10.1.1.3.cmml" xref="Sx3.SSx5.p1.10.m10.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.10.m10.1c">d_{v}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx5.p1.10.m10.1d">italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> are the dimensions of keys and values for each head, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx6">
<h3 class="ltx_title ltx_title_subsection">Feed-Forward Network</h3>
<div class="ltx_para" id="Sx3.SSx6.p1">
<p class="ltx_p" id="Sx3.SSx6.p1.5">The feed-forward network (FFN) converts input features into higher-level feature representations for further feature extraction and transformation.We use the GELU activation function to enhance the model’s ability to learn complex patterns and relationships.</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="FFN(H)=GELU(HW^{(1)}+b^{(1)})W^{(2)}+b^{(2)}," class="ltx_Math" display="block" id="Sx3.E6.m1.6"><semantics id="Sx3.E6.m1.6a"><mrow id="Sx3.E6.m1.6.6.1" xref="Sx3.E6.m1.6.6.1.1.cmml"><mrow id="Sx3.E6.m1.6.6.1.1" xref="Sx3.E6.m1.6.6.1.1.cmml"><mrow id="Sx3.E6.m1.6.6.1.1.3" xref="Sx3.E6.m1.6.6.1.1.3.cmml"><mi id="Sx3.E6.m1.6.6.1.1.3.2" xref="Sx3.E6.m1.6.6.1.1.3.2.cmml">F</mi><mo id="Sx3.E6.m1.6.6.1.1.3.1" xref="Sx3.E6.m1.6.6.1.1.3.1.cmml">⁢</mo><mi id="Sx3.E6.m1.6.6.1.1.3.3" xref="Sx3.E6.m1.6.6.1.1.3.3.cmml">F</mi><mo id="Sx3.E6.m1.6.6.1.1.3.1a" xref="Sx3.E6.m1.6.6.1.1.3.1.cmml">⁢</mo><mi id="Sx3.E6.m1.6.6.1.1.3.4" xref="Sx3.E6.m1.6.6.1.1.3.4.cmml">N</mi><mo id="Sx3.E6.m1.6.6.1.1.3.1b" xref="Sx3.E6.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="Sx3.E6.m1.6.6.1.1.3.5.2" xref="Sx3.E6.m1.6.6.1.1.3.cmml"><mo id="Sx3.E6.m1.6.6.1.1.3.5.2.1" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.3.cmml">(</mo><mi id="Sx3.E6.m1.5.5" xref="Sx3.E6.m1.5.5.cmml">H</mi><mo id="Sx3.E6.m1.6.6.1.1.3.5.2.2" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.3.cmml">)</mo></mrow></mrow><mo id="Sx3.E6.m1.6.6.1.1.2" xref="Sx3.E6.m1.6.6.1.1.2.cmml">=</mo><mrow id="Sx3.E6.m1.6.6.1.1.1" xref="Sx3.E6.m1.6.6.1.1.1.cmml"><mrow id="Sx3.E6.m1.6.6.1.1.1.1" xref="Sx3.E6.m1.6.6.1.1.1.1.cmml"><mi id="Sx3.E6.m1.6.6.1.1.1.1.3" xref="Sx3.E6.m1.6.6.1.1.1.1.3.cmml">G</mi><mo id="Sx3.E6.m1.6.6.1.1.1.1.2" xref="Sx3.E6.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E6.m1.6.6.1.1.1.1.4" xref="Sx3.E6.m1.6.6.1.1.1.1.4.cmml">E</mi><mo id="Sx3.E6.m1.6.6.1.1.1.1.2a" xref="Sx3.E6.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E6.m1.6.6.1.1.1.1.5" xref="Sx3.E6.m1.6.6.1.1.1.1.5.cmml">L</mi><mo id="Sx3.E6.m1.6.6.1.1.1.1.2b" xref="Sx3.E6.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E6.m1.6.6.1.1.1.1.6" xref="Sx3.E6.m1.6.6.1.1.1.1.6.cmml">U</mi><mo id="Sx3.E6.m1.6.6.1.1.1.1.2c" xref="Sx3.E6.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx3.E6.m1.6.6.1.1.1.1.1.1" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="Sx3.E6.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.2" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.2.cmml">H</mi><mo id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.1" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3.2" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mrow id="Sx3.E6.m1.1.1.1.3" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3.cmml"><mo id="Sx3.E6.m1.1.1.1.3.1" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3.cmml">(</mo><mn id="Sx3.E6.m1.1.1.1.1" xref="Sx3.E6.m1.1.1.1.1.cmml">1</mn><mo id="Sx3.E6.m1.1.1.1.3.2" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></msup></mrow><mo id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.1" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.1.cmml">+</mo><msup id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3.2" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3.2.cmml">b</mi><mrow id="Sx3.E6.m1.2.2.1.3" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mo id="Sx3.E6.m1.2.2.1.3.1" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3.cmml">(</mo><mn id="Sx3.E6.m1.2.2.1.1" xref="Sx3.E6.m1.2.2.1.1.cmml">1</mn><mo id="Sx3.E6.m1.2.2.1.3.2" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="Sx3.E6.m1.6.6.1.1.1.1.1.1.3" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Sx3.E6.m1.6.6.1.1.1.1.2d" xref="Sx3.E6.m1.6.6.1.1.1.1.2.cmml">⁢</mo><msup id="Sx3.E6.m1.6.6.1.1.1.1.7" xref="Sx3.E6.m1.6.6.1.1.1.1.7.cmml"><mi id="Sx3.E6.m1.6.6.1.1.1.1.7.2" xref="Sx3.E6.m1.6.6.1.1.1.1.7.2.cmml">W</mi><mrow id="Sx3.E6.m1.3.3.1.3" xref="Sx3.E6.m1.6.6.1.1.1.1.7.cmml"><mo id="Sx3.E6.m1.3.3.1.3.1" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.1.1.7.cmml">(</mo><mn id="Sx3.E6.m1.3.3.1.1" xref="Sx3.E6.m1.3.3.1.1.cmml">2</mn><mo id="Sx3.E6.m1.3.3.1.3.2" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.1.1.7.cmml">)</mo></mrow></msup></mrow><mo id="Sx3.E6.m1.6.6.1.1.1.2" xref="Sx3.E6.m1.6.6.1.1.1.2.cmml">+</mo><msup id="Sx3.E6.m1.6.6.1.1.1.3" xref="Sx3.E6.m1.6.6.1.1.1.3.cmml"><mi id="Sx3.E6.m1.6.6.1.1.1.3.2" xref="Sx3.E6.m1.6.6.1.1.1.3.2.cmml">b</mi><mrow id="Sx3.E6.m1.4.4.1.3" xref="Sx3.E6.m1.6.6.1.1.1.3.cmml"><mo id="Sx3.E6.m1.4.4.1.3.1" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.1.3.cmml">(</mo><mn id="Sx3.E6.m1.4.4.1.1" xref="Sx3.E6.m1.4.4.1.1.cmml">2</mn><mo id="Sx3.E6.m1.4.4.1.3.2" stretchy="false" xref="Sx3.E6.m1.6.6.1.1.1.3.cmml">)</mo></mrow></msup></mrow></mrow><mo id="Sx3.E6.m1.6.6.1.2" xref="Sx3.E6.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E6.m1.6b"><apply id="Sx3.E6.m1.6.6.1.1.cmml" xref="Sx3.E6.m1.6.6.1"><eq id="Sx3.E6.m1.6.6.1.1.2.cmml" xref="Sx3.E6.m1.6.6.1.1.2"></eq><apply id="Sx3.E6.m1.6.6.1.1.3.cmml" xref="Sx3.E6.m1.6.6.1.1.3"><times id="Sx3.E6.m1.6.6.1.1.3.1.cmml" xref="Sx3.E6.m1.6.6.1.1.3.1"></times><ci id="Sx3.E6.m1.6.6.1.1.3.2.cmml" xref="Sx3.E6.m1.6.6.1.1.3.2">𝐹</ci><ci id="Sx3.E6.m1.6.6.1.1.3.3.cmml" xref="Sx3.E6.m1.6.6.1.1.3.3">𝐹</ci><ci id="Sx3.E6.m1.6.6.1.1.3.4.cmml" xref="Sx3.E6.m1.6.6.1.1.3.4">𝑁</ci><ci id="Sx3.E6.m1.5.5.cmml" xref="Sx3.E6.m1.5.5">𝐻</ci></apply><apply id="Sx3.E6.m1.6.6.1.1.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1"><plus id="Sx3.E6.m1.6.6.1.1.1.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.2"></plus><apply id="Sx3.E6.m1.6.6.1.1.1.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1"><times id="Sx3.E6.m1.6.6.1.1.1.1.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.2"></times><ci id="Sx3.E6.m1.6.6.1.1.1.1.3.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.3">𝐺</ci><ci id="Sx3.E6.m1.6.6.1.1.1.1.4.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.4">𝐸</ci><ci id="Sx3.E6.m1.6.6.1.1.1.1.5.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.5">𝐿</ci><ci id="Sx3.E6.m1.6.6.1.1.1.1.6.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.6">𝑈</ci><apply id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1"><plus id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.1"></plus><apply id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2"><times id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.1"></times><ci id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.2">𝐻</ci><apply id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.2.3.2">𝑊</ci><cn id="Sx3.E6.m1.1.1.1.1.cmml" type="integer" xref="Sx3.E6.m1.1.1.1.1">1</cn></apply></apply><apply id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.1.1.1.3.2">𝑏</ci><cn id="Sx3.E6.m1.2.2.1.1.cmml" type="integer" xref="Sx3.E6.m1.2.2.1.1">1</cn></apply></apply><apply id="Sx3.E6.m1.6.6.1.1.1.1.7.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.7"><csymbol cd="ambiguous" id="Sx3.E6.m1.6.6.1.1.1.1.7.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.7">superscript</csymbol><ci id="Sx3.E6.m1.6.6.1.1.1.1.7.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.1.7.2">𝑊</ci><cn id="Sx3.E6.m1.3.3.1.1.cmml" type="integer" xref="Sx3.E6.m1.3.3.1.1">2</cn></apply></apply><apply id="Sx3.E6.m1.6.6.1.1.1.3.cmml" xref="Sx3.E6.m1.6.6.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.6.6.1.1.1.3.1.cmml" xref="Sx3.E6.m1.6.6.1.1.1.3">superscript</csymbol><ci id="Sx3.E6.m1.6.6.1.1.1.3.2.cmml" xref="Sx3.E6.m1.6.6.1.1.1.3.2">𝑏</ci><cn id="Sx3.E6.m1.4.4.1.1.cmml" type="integer" xref="Sx3.E6.m1.4.4.1.1">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E6.m1.6c">FFN(H)=GELU(HW^{(1)}+b^{(1)})W^{(2)}+b^{(2)},</annotation><annotation encoding="application/x-llamapun" id="Sx3.E6.m1.6d">italic_F italic_F italic_N ( italic_H ) = italic_G italic_E italic_L italic_U ( italic_H italic_W start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT + italic_b start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ) italic_W start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT + italic_b start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx3.SSx6.p1.4">where,<math alttext="W^{(1)}\in\mathbb{R}^{D\times 4D}" class="ltx_Math" display="inline" id="Sx3.SSx6.p1.1.m1.1"><semantics id="Sx3.SSx6.p1.1.m1.1a"><mrow id="Sx3.SSx6.p1.1.m1.1.2" xref="Sx3.SSx6.p1.1.m1.1.2.cmml"><msup id="Sx3.SSx6.p1.1.m1.1.2.2" xref="Sx3.SSx6.p1.1.m1.1.2.2.cmml"><mi id="Sx3.SSx6.p1.1.m1.1.2.2.2" xref="Sx3.SSx6.p1.1.m1.1.2.2.2.cmml">W</mi><mrow id="Sx3.SSx6.p1.1.m1.1.1.1.3" xref="Sx3.SSx6.p1.1.m1.1.2.2.cmml"><mo id="Sx3.SSx6.p1.1.m1.1.1.1.3.1" stretchy="false" xref="Sx3.SSx6.p1.1.m1.1.2.2.cmml">(</mo><mn id="Sx3.SSx6.p1.1.m1.1.1.1.1" xref="Sx3.SSx6.p1.1.m1.1.1.1.1.cmml">1</mn><mo id="Sx3.SSx6.p1.1.m1.1.1.1.3.2" stretchy="false" xref="Sx3.SSx6.p1.1.m1.1.2.2.cmml">)</mo></mrow></msup><mo id="Sx3.SSx6.p1.1.m1.1.2.1" xref="Sx3.SSx6.p1.1.m1.1.2.1.cmml">∈</mo><msup id="Sx3.SSx6.p1.1.m1.1.2.3" xref="Sx3.SSx6.p1.1.m1.1.2.3.cmml"><mi id="Sx3.SSx6.p1.1.m1.1.2.3.2" xref="Sx3.SSx6.p1.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx6.p1.1.m1.1.2.3.3" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.cmml"><mrow id="Sx3.SSx6.p1.1.m1.1.2.3.3.2" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.2.cmml"><mi id="Sx3.SSx6.p1.1.m1.1.2.3.3.2.2" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.2.2.cmml">D</mi><mo id="Sx3.SSx6.p1.1.m1.1.2.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.2.1.cmml">×</mo><mn id="Sx3.SSx6.p1.1.m1.1.2.3.3.2.3" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.2.3.cmml">4</mn></mrow><mo id="Sx3.SSx6.p1.1.m1.1.2.3.3.1" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.1.cmml">⁢</mo><mi id="Sx3.SSx6.p1.1.m1.1.2.3.3.3" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.1.m1.1b"><apply id="Sx3.SSx6.p1.1.m1.1.2.cmml" xref="Sx3.SSx6.p1.1.m1.1.2"><in id="Sx3.SSx6.p1.1.m1.1.2.1.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.1"></in><apply id="Sx3.SSx6.p1.1.m1.1.2.2.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.1.m1.1.2.2.1.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.2">superscript</csymbol><ci id="Sx3.SSx6.p1.1.m1.1.2.2.2.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.2.2">𝑊</ci><cn id="Sx3.SSx6.p1.1.m1.1.1.1.1.cmml" type="integer" xref="Sx3.SSx6.p1.1.m1.1.1.1.1">1</cn></apply><apply id="Sx3.SSx6.p1.1.m1.1.2.3.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.1.m1.1.2.3.1.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.3">superscript</csymbol><ci id="Sx3.SSx6.p1.1.m1.1.2.3.2.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.3.2">ℝ</ci><apply id="Sx3.SSx6.p1.1.m1.1.2.3.3.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.3.3"><times id="Sx3.SSx6.p1.1.m1.1.2.3.3.1.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.1"></times><apply id="Sx3.SSx6.p1.1.m1.1.2.3.3.2.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.2"><times id="Sx3.SSx6.p1.1.m1.1.2.3.3.2.1.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.2.1"></times><ci id="Sx3.SSx6.p1.1.m1.1.2.3.3.2.2.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.2.2">𝐷</ci><cn id="Sx3.SSx6.p1.1.m1.1.2.3.3.2.3.cmml" type="integer" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.2.3">4</cn></apply><ci id="Sx3.SSx6.p1.1.m1.1.2.3.3.3.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.1.m1.1c">W^{(1)}\in\mathbb{R}^{D\times 4D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx6.p1.1.m1.1d">italic_W start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × 4 italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>,<math alttext="W^{(2)}\in\mathbb{R}^{4D\times D}" class="ltx_Math" display="inline" id="Sx3.SSx6.p1.2.m2.1"><semantics id="Sx3.SSx6.p1.2.m2.1a"><mrow id="Sx3.SSx6.p1.2.m2.1.2" xref="Sx3.SSx6.p1.2.m2.1.2.cmml"><msup id="Sx3.SSx6.p1.2.m2.1.2.2" xref="Sx3.SSx6.p1.2.m2.1.2.2.cmml"><mi id="Sx3.SSx6.p1.2.m2.1.2.2.2" xref="Sx3.SSx6.p1.2.m2.1.2.2.2.cmml">W</mi><mrow id="Sx3.SSx6.p1.2.m2.1.1.1.3" xref="Sx3.SSx6.p1.2.m2.1.2.2.cmml"><mo id="Sx3.SSx6.p1.2.m2.1.1.1.3.1" stretchy="false" xref="Sx3.SSx6.p1.2.m2.1.2.2.cmml">(</mo><mn id="Sx3.SSx6.p1.2.m2.1.1.1.1" xref="Sx3.SSx6.p1.2.m2.1.1.1.1.cmml">2</mn><mo id="Sx3.SSx6.p1.2.m2.1.1.1.3.2" stretchy="false" xref="Sx3.SSx6.p1.2.m2.1.2.2.cmml">)</mo></mrow></msup><mo id="Sx3.SSx6.p1.2.m2.1.2.1" xref="Sx3.SSx6.p1.2.m2.1.2.1.cmml">∈</mo><msup id="Sx3.SSx6.p1.2.m2.1.2.3" xref="Sx3.SSx6.p1.2.m2.1.2.3.cmml"><mi id="Sx3.SSx6.p1.2.m2.1.2.3.2" xref="Sx3.SSx6.p1.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx6.p1.2.m2.1.2.3.3" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.cmml"><mrow id="Sx3.SSx6.p1.2.m2.1.2.3.3.2" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.2.cmml"><mn id="Sx3.SSx6.p1.2.m2.1.2.3.3.2.2" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.2.2.cmml">4</mn><mo id="Sx3.SSx6.p1.2.m2.1.2.3.3.2.1" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.2.1.cmml">⁢</mo><mi id="Sx3.SSx6.p1.2.m2.1.2.3.3.2.3" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.2.3.cmml">D</mi></mrow><mo id="Sx3.SSx6.p1.2.m2.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.1.cmml">×</mo><mi id="Sx3.SSx6.p1.2.m2.1.2.3.3.3" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.2.m2.1b"><apply id="Sx3.SSx6.p1.2.m2.1.2.cmml" xref="Sx3.SSx6.p1.2.m2.1.2"><in id="Sx3.SSx6.p1.2.m2.1.2.1.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.1"></in><apply id="Sx3.SSx6.p1.2.m2.1.2.2.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.2.m2.1.2.2.1.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.2">superscript</csymbol><ci id="Sx3.SSx6.p1.2.m2.1.2.2.2.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.2.2">𝑊</ci><cn id="Sx3.SSx6.p1.2.m2.1.1.1.1.cmml" type="integer" xref="Sx3.SSx6.p1.2.m2.1.1.1.1">2</cn></apply><apply id="Sx3.SSx6.p1.2.m2.1.2.3.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.2.m2.1.2.3.1.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.3">superscript</csymbol><ci id="Sx3.SSx6.p1.2.m2.1.2.3.2.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.3.2">ℝ</ci><apply id="Sx3.SSx6.p1.2.m2.1.2.3.3.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.3.3"><times id="Sx3.SSx6.p1.2.m2.1.2.3.3.1.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.1"></times><apply id="Sx3.SSx6.p1.2.m2.1.2.3.3.2.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.2"><times id="Sx3.SSx6.p1.2.m2.1.2.3.3.2.1.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.2.1"></times><cn id="Sx3.SSx6.p1.2.m2.1.2.3.3.2.2.cmml" type="integer" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.2.2">4</cn><ci id="Sx3.SSx6.p1.2.m2.1.2.3.3.2.3.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.2.3">𝐷</ci></apply><ci id="Sx3.SSx6.p1.2.m2.1.2.3.3.3.cmml" xref="Sx3.SSx6.p1.2.m2.1.2.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.2.m2.1c">W^{(2)}\in\mathbb{R}^{4D\times D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx6.p1.2.m2.1d">italic_W start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 4 italic_D × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>,<math alttext="b^{(1)}\in\mathbb{R}^{4D}" class="ltx_Math" display="inline" id="Sx3.SSx6.p1.3.m3.1"><semantics id="Sx3.SSx6.p1.3.m3.1a"><mrow id="Sx3.SSx6.p1.3.m3.1.2" xref="Sx3.SSx6.p1.3.m3.1.2.cmml"><msup id="Sx3.SSx6.p1.3.m3.1.2.2" xref="Sx3.SSx6.p1.3.m3.1.2.2.cmml"><mi id="Sx3.SSx6.p1.3.m3.1.2.2.2" xref="Sx3.SSx6.p1.3.m3.1.2.2.2.cmml">b</mi><mrow id="Sx3.SSx6.p1.3.m3.1.1.1.3" xref="Sx3.SSx6.p1.3.m3.1.2.2.cmml"><mo id="Sx3.SSx6.p1.3.m3.1.1.1.3.1" stretchy="false" xref="Sx3.SSx6.p1.3.m3.1.2.2.cmml">(</mo><mn id="Sx3.SSx6.p1.3.m3.1.1.1.1" xref="Sx3.SSx6.p1.3.m3.1.1.1.1.cmml">1</mn><mo id="Sx3.SSx6.p1.3.m3.1.1.1.3.2" stretchy="false" xref="Sx3.SSx6.p1.3.m3.1.2.2.cmml">)</mo></mrow></msup><mo id="Sx3.SSx6.p1.3.m3.1.2.1" xref="Sx3.SSx6.p1.3.m3.1.2.1.cmml">∈</mo><msup id="Sx3.SSx6.p1.3.m3.1.2.3" xref="Sx3.SSx6.p1.3.m3.1.2.3.cmml"><mi id="Sx3.SSx6.p1.3.m3.1.2.3.2" xref="Sx3.SSx6.p1.3.m3.1.2.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx6.p1.3.m3.1.2.3.3" xref="Sx3.SSx6.p1.3.m3.1.2.3.3.cmml"><mn id="Sx3.SSx6.p1.3.m3.1.2.3.3.2" xref="Sx3.SSx6.p1.3.m3.1.2.3.3.2.cmml">4</mn><mo id="Sx3.SSx6.p1.3.m3.1.2.3.3.1" xref="Sx3.SSx6.p1.3.m3.1.2.3.3.1.cmml">⁢</mo><mi id="Sx3.SSx6.p1.3.m3.1.2.3.3.3" xref="Sx3.SSx6.p1.3.m3.1.2.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.3.m3.1b"><apply id="Sx3.SSx6.p1.3.m3.1.2.cmml" xref="Sx3.SSx6.p1.3.m3.1.2"><in id="Sx3.SSx6.p1.3.m3.1.2.1.cmml" xref="Sx3.SSx6.p1.3.m3.1.2.1"></in><apply id="Sx3.SSx6.p1.3.m3.1.2.2.cmml" xref="Sx3.SSx6.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.3.m3.1.2.2.1.cmml" xref="Sx3.SSx6.p1.3.m3.1.2.2">superscript</csymbol><ci id="Sx3.SSx6.p1.3.m3.1.2.2.2.cmml" xref="Sx3.SSx6.p1.3.m3.1.2.2.2">𝑏</ci><cn id="Sx3.SSx6.p1.3.m3.1.1.1.1.cmml" type="integer" xref="Sx3.SSx6.p1.3.m3.1.1.1.1">1</cn></apply><apply id="Sx3.SSx6.p1.3.m3.1.2.3.cmml" xref="Sx3.SSx6.p1.3.m3.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.3.m3.1.2.3.1.cmml" xref="Sx3.SSx6.p1.3.m3.1.2.3">superscript</csymbol><ci id="Sx3.SSx6.p1.3.m3.1.2.3.2.cmml" xref="Sx3.SSx6.p1.3.m3.1.2.3.2">ℝ</ci><apply id="Sx3.SSx6.p1.3.m3.1.2.3.3.cmml" xref="Sx3.SSx6.p1.3.m3.1.2.3.3"><times id="Sx3.SSx6.p1.3.m3.1.2.3.3.1.cmml" xref="Sx3.SSx6.p1.3.m3.1.2.3.3.1"></times><cn id="Sx3.SSx6.p1.3.m3.1.2.3.3.2.cmml" type="integer" xref="Sx3.SSx6.p1.3.m3.1.2.3.3.2">4</cn><ci id="Sx3.SSx6.p1.3.m3.1.2.3.3.3.cmml" xref="Sx3.SSx6.p1.3.m3.1.2.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.3.m3.1c">b^{(1)}\in\mathbb{R}^{4D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx6.p1.3.m3.1d">italic_b start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 4 italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> and
<math alttext="b^{(2)}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="Sx3.SSx6.p1.4.m4.1"><semantics id="Sx3.SSx6.p1.4.m4.1a"><mrow id="Sx3.SSx6.p1.4.m4.1.2" xref="Sx3.SSx6.p1.4.m4.1.2.cmml"><msup id="Sx3.SSx6.p1.4.m4.1.2.2" xref="Sx3.SSx6.p1.4.m4.1.2.2.cmml"><mi id="Sx3.SSx6.p1.4.m4.1.2.2.2" xref="Sx3.SSx6.p1.4.m4.1.2.2.2.cmml">b</mi><mrow id="Sx3.SSx6.p1.4.m4.1.1.1.3" xref="Sx3.SSx6.p1.4.m4.1.2.2.cmml"><mo id="Sx3.SSx6.p1.4.m4.1.1.1.3.1" stretchy="false" xref="Sx3.SSx6.p1.4.m4.1.2.2.cmml">(</mo><mn id="Sx3.SSx6.p1.4.m4.1.1.1.1" xref="Sx3.SSx6.p1.4.m4.1.1.1.1.cmml">2</mn><mo id="Sx3.SSx6.p1.4.m4.1.1.1.3.2" stretchy="false" xref="Sx3.SSx6.p1.4.m4.1.2.2.cmml">)</mo></mrow></msup><mo id="Sx3.SSx6.p1.4.m4.1.2.1" xref="Sx3.SSx6.p1.4.m4.1.2.1.cmml">∈</mo><msup id="Sx3.SSx6.p1.4.m4.1.2.3" xref="Sx3.SSx6.p1.4.m4.1.2.3.cmml"><mi id="Sx3.SSx6.p1.4.m4.1.2.3.2" xref="Sx3.SSx6.p1.4.m4.1.2.3.2.cmml">ℝ</mi><mi id="Sx3.SSx6.p1.4.m4.1.2.3.3" xref="Sx3.SSx6.p1.4.m4.1.2.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.4.m4.1b"><apply id="Sx3.SSx6.p1.4.m4.1.2.cmml" xref="Sx3.SSx6.p1.4.m4.1.2"><in id="Sx3.SSx6.p1.4.m4.1.2.1.cmml" xref="Sx3.SSx6.p1.4.m4.1.2.1"></in><apply id="Sx3.SSx6.p1.4.m4.1.2.2.cmml" xref="Sx3.SSx6.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.4.m4.1.2.2.1.cmml" xref="Sx3.SSx6.p1.4.m4.1.2.2">superscript</csymbol><ci id="Sx3.SSx6.p1.4.m4.1.2.2.2.cmml" xref="Sx3.SSx6.p1.4.m4.1.2.2.2">𝑏</ci><cn id="Sx3.SSx6.p1.4.m4.1.1.1.1.cmml" type="integer" xref="Sx3.SSx6.p1.4.m4.1.1.1.1">2</cn></apply><apply id="Sx3.SSx6.p1.4.m4.1.2.3.cmml" xref="Sx3.SSx6.p1.4.m4.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.4.m4.1.2.3.1.cmml" xref="Sx3.SSx6.p1.4.m4.1.2.3">superscript</csymbol><ci id="Sx3.SSx6.p1.4.m4.1.2.3.2.cmml" xref="Sx3.SSx6.p1.4.m4.1.2.3.2">ℝ</ci><ci id="Sx3.SSx6.p1.4.m4.1.2.3.3.cmml" xref="Sx3.SSx6.p1.4.m4.1.2.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.4.m4.1c">b^{(2)}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx6.p1.4.m4.1d">italic_b start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> .</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx7">
<h3 class="ltx_title ltx_title_subsection">Prediction Layer</h3>
<div class="ltx_para" id="Sx3.SSx7.p1">
<p class="ltx_p" id="Sx3.SSx7.p1.4">In the prediction layer, we use the common Softmax function to obtain the final prediction results. The Softmax function transforms the model’s output into a probability distribution to identify the most likely recommendations.</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}=softmax(HW_{h}+b_{h})\in\mathbb{R}^{\left|V\right|}," class="ltx_Math" display="block" id="Sx3.E7.m1.2"><semantics id="Sx3.E7.m1.2a"><mrow id="Sx3.E7.m1.2.2.1" xref="Sx3.E7.m1.2.2.1.1.cmml"><mrow id="Sx3.E7.m1.2.2.1.1" xref="Sx3.E7.m1.2.2.1.1.cmml"><mover accent="true" id="Sx3.E7.m1.2.2.1.1.3" xref="Sx3.E7.m1.2.2.1.1.3.cmml"><mi id="Sx3.E7.m1.2.2.1.1.3.2" xref="Sx3.E7.m1.2.2.1.1.3.2.cmml">y</mi><mo id="Sx3.E7.m1.2.2.1.1.3.1" xref="Sx3.E7.m1.2.2.1.1.3.1.cmml">^</mo></mover><mo id="Sx3.E7.m1.2.2.1.1.4" xref="Sx3.E7.m1.2.2.1.1.4.cmml">=</mo><mrow id="Sx3.E7.m1.2.2.1.1.1" xref="Sx3.E7.m1.2.2.1.1.1.cmml"><mi id="Sx3.E7.m1.2.2.1.1.1.3" xref="Sx3.E7.m1.2.2.1.1.1.3.cmml">s</mi><mo id="Sx3.E7.m1.2.2.1.1.1.2" xref="Sx3.E7.m1.2.2.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E7.m1.2.2.1.1.1.4" xref="Sx3.E7.m1.2.2.1.1.1.4.cmml">o</mi><mo id="Sx3.E7.m1.2.2.1.1.1.2a" xref="Sx3.E7.m1.2.2.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E7.m1.2.2.1.1.1.5" xref="Sx3.E7.m1.2.2.1.1.1.5.cmml">f</mi><mo id="Sx3.E7.m1.2.2.1.1.1.2b" xref="Sx3.E7.m1.2.2.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E7.m1.2.2.1.1.1.6" xref="Sx3.E7.m1.2.2.1.1.1.6.cmml">t</mi><mo id="Sx3.E7.m1.2.2.1.1.1.2c" xref="Sx3.E7.m1.2.2.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E7.m1.2.2.1.1.1.7" xref="Sx3.E7.m1.2.2.1.1.1.7.cmml">m</mi><mo id="Sx3.E7.m1.2.2.1.1.1.2d" xref="Sx3.E7.m1.2.2.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E7.m1.2.2.1.1.1.8" xref="Sx3.E7.m1.2.2.1.1.1.8.cmml">a</mi><mo id="Sx3.E7.m1.2.2.1.1.1.2e" xref="Sx3.E7.m1.2.2.1.1.1.2.cmml">⁢</mo><mi id="Sx3.E7.m1.2.2.1.1.1.9" xref="Sx3.E7.m1.2.2.1.1.1.9.cmml">x</mi><mo id="Sx3.E7.m1.2.2.1.1.1.2f" xref="Sx3.E7.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="Sx3.E7.m1.2.2.1.1.1.1.1" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.cmml"><mo id="Sx3.E7.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E7.m1.2.2.1.1.1.1.1.1" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.2" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.2.cmml">H</mi><mo id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.1" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3.2" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">W</mi><mi id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3.3" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">h</mi></msub></mrow><mo id="Sx3.E7.m1.2.2.1.1.1.1.1.1.1" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><msub id="Sx3.E7.m1.2.2.1.1.1.1.1.1.3" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E7.m1.2.2.1.1.1.1.1.1.3.2" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="Sx3.E7.m1.2.2.1.1.1.1.1.1.3.3" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.3.3.cmml">h</mi></msub></mrow><mo id="Sx3.E7.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E7.m1.2.2.1.1.5" xref="Sx3.E7.m1.2.2.1.1.5.cmml">∈</mo><msup id="Sx3.E7.m1.2.2.1.1.6" xref="Sx3.E7.m1.2.2.1.1.6.cmml"><mi id="Sx3.E7.m1.2.2.1.1.6.2" xref="Sx3.E7.m1.2.2.1.1.6.2.cmml">ℝ</mi><mrow id="Sx3.E7.m1.1.1.1.3" xref="Sx3.E7.m1.1.1.1.2.cmml"><mo id="Sx3.E7.m1.1.1.1.3.1" xref="Sx3.E7.m1.1.1.1.2.1.cmml">|</mo><mi id="Sx3.E7.m1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.cmml">V</mi><mo id="Sx3.E7.m1.1.1.1.3.2" xref="Sx3.E7.m1.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><mo id="Sx3.E7.m1.2.2.1.2" xref="Sx3.E7.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E7.m1.2b"><apply id="Sx3.E7.m1.2.2.1.1.cmml" xref="Sx3.E7.m1.2.2.1"><and id="Sx3.E7.m1.2.2.1.1a.cmml" xref="Sx3.E7.m1.2.2.1"></and><apply id="Sx3.E7.m1.2.2.1.1b.cmml" xref="Sx3.E7.m1.2.2.1"><eq id="Sx3.E7.m1.2.2.1.1.4.cmml" xref="Sx3.E7.m1.2.2.1.1.4"></eq><apply id="Sx3.E7.m1.2.2.1.1.3.cmml" xref="Sx3.E7.m1.2.2.1.1.3"><ci id="Sx3.E7.m1.2.2.1.1.3.1.cmml" xref="Sx3.E7.m1.2.2.1.1.3.1">^</ci><ci id="Sx3.E7.m1.2.2.1.1.3.2.cmml" xref="Sx3.E7.m1.2.2.1.1.3.2">𝑦</ci></apply><apply id="Sx3.E7.m1.2.2.1.1.1.cmml" xref="Sx3.E7.m1.2.2.1.1.1"><times id="Sx3.E7.m1.2.2.1.1.1.2.cmml" xref="Sx3.E7.m1.2.2.1.1.1.2"></times><ci id="Sx3.E7.m1.2.2.1.1.1.3.cmml" xref="Sx3.E7.m1.2.2.1.1.1.3">𝑠</ci><ci id="Sx3.E7.m1.2.2.1.1.1.4.cmml" xref="Sx3.E7.m1.2.2.1.1.1.4">𝑜</ci><ci id="Sx3.E7.m1.2.2.1.1.1.5.cmml" xref="Sx3.E7.m1.2.2.1.1.1.5">𝑓</ci><ci id="Sx3.E7.m1.2.2.1.1.1.6.cmml" xref="Sx3.E7.m1.2.2.1.1.1.6">𝑡</ci><ci id="Sx3.E7.m1.2.2.1.1.1.7.cmml" xref="Sx3.E7.m1.2.2.1.1.1.7">𝑚</ci><ci id="Sx3.E7.m1.2.2.1.1.1.8.cmml" xref="Sx3.E7.m1.2.2.1.1.1.8">𝑎</ci><ci id="Sx3.E7.m1.2.2.1.1.1.9.cmml" xref="Sx3.E7.m1.2.2.1.1.1.9">𝑥</ci><apply id="Sx3.E7.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1"><plus id="Sx3.E7.m1.2.2.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.1"></plus><apply id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2"><times id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.1"></times><ci id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.2">𝐻</ci><apply id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3.2">𝑊</ci><ci id="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.2.3.3">ℎ</ci></apply></apply><apply id="Sx3.E7.m1.2.2.1.1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E7.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E7.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.3.2">𝑏</ci><ci id="Sx3.E7.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E7.m1.2.2.1.1.1.1.1.1.3.3">ℎ</ci></apply></apply></apply></apply><apply id="Sx3.E7.m1.2.2.1.1c.cmml" xref="Sx3.E7.m1.2.2.1"><in id="Sx3.E7.m1.2.2.1.1.5.cmml" xref="Sx3.E7.m1.2.2.1.1.5"></in><share href="https://arxiv.org/html/2407.19239v1#Sx3.E7.m1.2.2.1.1.1.cmml" id="Sx3.E7.m1.2.2.1.1d.cmml" xref="Sx3.E7.m1.2.2.1"></share><apply id="Sx3.E7.m1.2.2.1.1.6.cmml" xref="Sx3.E7.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="Sx3.E7.m1.2.2.1.1.6.1.cmml" xref="Sx3.E7.m1.2.2.1.1.6">superscript</csymbol><ci id="Sx3.E7.m1.2.2.1.1.6.2.cmml" xref="Sx3.E7.m1.2.2.1.1.6.2">ℝ</ci><apply id="Sx3.E7.m1.1.1.1.2.cmml" xref="Sx3.E7.m1.1.1.1.3"><abs id="Sx3.E7.m1.1.1.1.2.1.cmml" xref="Sx3.E7.m1.1.1.1.3.1"></abs><ci id="Sx3.E7.m1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1">𝑉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E7.m1.2c">\hat{y}=softmax(HW_{h}+b_{h})\in\mathbb{R}^{\left|V\right|},</annotation><annotation encoding="application/x-llamapun" id="Sx3.E7.m1.2d">over^ start_ARG italic_y end_ARG = italic_s italic_o italic_f italic_t italic_m italic_a italic_x ( italic_H italic_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT | italic_V | end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx3.SSx7.p1.3">where <math alttext="H\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="Sx3.SSx7.p1.1.m1.1"><semantics id="Sx3.SSx7.p1.1.m1.1a"><mrow id="Sx3.SSx7.p1.1.m1.1.1" xref="Sx3.SSx7.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx7.p1.1.m1.1.1.2" xref="Sx3.SSx7.p1.1.m1.1.1.2.cmml">H</mi><mo id="Sx3.SSx7.p1.1.m1.1.1.1" xref="Sx3.SSx7.p1.1.m1.1.1.1.cmml">∈</mo><msup id="Sx3.SSx7.p1.1.m1.1.1.3" xref="Sx3.SSx7.p1.1.m1.1.1.3.cmml"><mi id="Sx3.SSx7.p1.1.m1.1.1.3.2" xref="Sx3.SSx7.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="Sx3.SSx7.p1.1.m1.1.1.3.3" xref="Sx3.SSx7.p1.1.m1.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx7.p1.1.m1.1b"><apply id="Sx3.SSx7.p1.1.m1.1.1.cmml" xref="Sx3.SSx7.p1.1.m1.1.1"><in id="Sx3.SSx7.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx7.p1.1.m1.1.1.1"></in><ci id="Sx3.SSx7.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx7.p1.1.m1.1.1.2">𝐻</ci><apply id="Sx3.SSx7.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx7.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx7.p1.1.m1.1.1.3.1.cmml" xref="Sx3.SSx7.p1.1.m1.1.1.3">superscript</csymbol><ci id="Sx3.SSx7.p1.1.m1.1.1.3.2.cmml" xref="Sx3.SSx7.p1.1.m1.1.1.3.2">ℝ</ci><ci id="Sx3.SSx7.p1.1.m1.1.1.3.3.cmml" xref="Sx3.SSx7.p1.1.m1.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx7.p1.1.m1.1c">H\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx7.p1.1.m1.1d">italic_H ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is the output from the previous layer, <math alttext="W_{h}\in\mathbb{R}^{D\times\left|V\right|}" class="ltx_Math" display="inline" id="Sx3.SSx7.p1.2.m2.1"><semantics id="Sx3.SSx7.p1.2.m2.1a"><mrow id="Sx3.SSx7.p1.2.m2.1.2" xref="Sx3.SSx7.p1.2.m2.1.2.cmml"><msub id="Sx3.SSx7.p1.2.m2.1.2.2" xref="Sx3.SSx7.p1.2.m2.1.2.2.cmml"><mi id="Sx3.SSx7.p1.2.m2.1.2.2.2" xref="Sx3.SSx7.p1.2.m2.1.2.2.2.cmml">W</mi><mi id="Sx3.SSx7.p1.2.m2.1.2.2.3" xref="Sx3.SSx7.p1.2.m2.1.2.2.3.cmml">h</mi></msub><mo id="Sx3.SSx7.p1.2.m2.1.2.1" xref="Sx3.SSx7.p1.2.m2.1.2.1.cmml">∈</mo><msup id="Sx3.SSx7.p1.2.m2.1.2.3" xref="Sx3.SSx7.p1.2.m2.1.2.3.cmml"><mi id="Sx3.SSx7.p1.2.m2.1.2.3.2" xref="Sx3.SSx7.p1.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx7.p1.2.m2.1.1.1" xref="Sx3.SSx7.p1.2.m2.1.1.1.cmml"><mi id="Sx3.SSx7.p1.2.m2.1.1.1.3" xref="Sx3.SSx7.p1.2.m2.1.1.1.3.cmml">D</mi><mo id="Sx3.SSx7.p1.2.m2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="Sx3.SSx7.p1.2.m2.1.1.1.2.cmml">×</mo><mrow id="Sx3.SSx7.p1.2.m2.1.1.1.4.2" xref="Sx3.SSx7.p1.2.m2.1.1.1.4.1.cmml"><mo id="Sx3.SSx7.p1.2.m2.1.1.1.4.2.1" xref="Sx3.SSx7.p1.2.m2.1.1.1.4.1.1.cmml">|</mo><mi id="Sx3.SSx7.p1.2.m2.1.1.1.1" xref="Sx3.SSx7.p1.2.m2.1.1.1.1.cmml">V</mi><mo id="Sx3.SSx7.p1.2.m2.1.1.1.4.2.2" xref="Sx3.SSx7.p1.2.m2.1.1.1.4.1.1.cmml">|</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx7.p1.2.m2.1b"><apply id="Sx3.SSx7.p1.2.m2.1.2.cmml" xref="Sx3.SSx7.p1.2.m2.1.2"><in id="Sx3.SSx7.p1.2.m2.1.2.1.cmml" xref="Sx3.SSx7.p1.2.m2.1.2.1"></in><apply id="Sx3.SSx7.p1.2.m2.1.2.2.cmml" xref="Sx3.SSx7.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx7.p1.2.m2.1.2.2.1.cmml" xref="Sx3.SSx7.p1.2.m2.1.2.2">subscript</csymbol><ci id="Sx3.SSx7.p1.2.m2.1.2.2.2.cmml" xref="Sx3.SSx7.p1.2.m2.1.2.2.2">𝑊</ci><ci id="Sx3.SSx7.p1.2.m2.1.2.2.3.cmml" xref="Sx3.SSx7.p1.2.m2.1.2.2.3">ℎ</ci></apply><apply id="Sx3.SSx7.p1.2.m2.1.2.3.cmml" xref="Sx3.SSx7.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx7.p1.2.m2.1.2.3.1.cmml" xref="Sx3.SSx7.p1.2.m2.1.2.3">superscript</csymbol><ci id="Sx3.SSx7.p1.2.m2.1.2.3.2.cmml" xref="Sx3.SSx7.p1.2.m2.1.2.3.2">ℝ</ci><apply id="Sx3.SSx7.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx7.p1.2.m2.1.1.1"><times id="Sx3.SSx7.p1.2.m2.1.1.1.2.cmml" xref="Sx3.SSx7.p1.2.m2.1.1.1.2"></times><ci id="Sx3.SSx7.p1.2.m2.1.1.1.3.cmml" xref="Sx3.SSx7.p1.2.m2.1.1.1.3">𝐷</ci><apply id="Sx3.SSx7.p1.2.m2.1.1.1.4.1.cmml" xref="Sx3.SSx7.p1.2.m2.1.1.1.4.2"><abs id="Sx3.SSx7.p1.2.m2.1.1.1.4.1.1.cmml" xref="Sx3.SSx7.p1.2.m2.1.1.1.4.2.1"></abs><ci id="Sx3.SSx7.p1.2.m2.1.1.1.1.cmml" xref="Sx3.SSx7.p1.2.m2.1.1.1.1">𝑉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx7.p1.2.m2.1c">W_{h}\in\mathbb{R}^{D\times\left|V\right|}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx7.p1.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × | italic_V | end_POSTSUPERSCRIPT</annotation></semantics></math> is the weight matrix, and <math alttext="b_{h}\in\mathbb{R}^{\left|V\right|}" class="ltx_Math" display="inline" id="Sx3.SSx7.p1.3.m3.1"><semantics id="Sx3.SSx7.p1.3.m3.1a"><mrow id="Sx3.SSx7.p1.3.m3.1.2" xref="Sx3.SSx7.p1.3.m3.1.2.cmml"><msub id="Sx3.SSx7.p1.3.m3.1.2.2" xref="Sx3.SSx7.p1.3.m3.1.2.2.cmml"><mi id="Sx3.SSx7.p1.3.m3.1.2.2.2" xref="Sx3.SSx7.p1.3.m3.1.2.2.2.cmml">b</mi><mi id="Sx3.SSx7.p1.3.m3.1.2.2.3" xref="Sx3.SSx7.p1.3.m3.1.2.2.3.cmml">h</mi></msub><mo id="Sx3.SSx7.p1.3.m3.1.2.1" xref="Sx3.SSx7.p1.3.m3.1.2.1.cmml">∈</mo><msup id="Sx3.SSx7.p1.3.m3.1.2.3" xref="Sx3.SSx7.p1.3.m3.1.2.3.cmml"><mi id="Sx3.SSx7.p1.3.m3.1.2.3.2" xref="Sx3.SSx7.p1.3.m3.1.2.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx7.p1.3.m3.1.1.1.3" xref="Sx3.SSx7.p1.3.m3.1.1.1.2.cmml"><mo id="Sx3.SSx7.p1.3.m3.1.1.1.3.1" xref="Sx3.SSx7.p1.3.m3.1.1.1.2.1.cmml">|</mo><mi id="Sx3.SSx7.p1.3.m3.1.1.1.1" xref="Sx3.SSx7.p1.3.m3.1.1.1.1.cmml">V</mi><mo id="Sx3.SSx7.p1.3.m3.1.1.1.3.2" xref="Sx3.SSx7.p1.3.m3.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx7.p1.3.m3.1b"><apply id="Sx3.SSx7.p1.3.m3.1.2.cmml" xref="Sx3.SSx7.p1.3.m3.1.2"><in id="Sx3.SSx7.p1.3.m3.1.2.1.cmml" xref="Sx3.SSx7.p1.3.m3.1.2.1"></in><apply id="Sx3.SSx7.p1.3.m3.1.2.2.cmml" xref="Sx3.SSx7.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx7.p1.3.m3.1.2.2.1.cmml" xref="Sx3.SSx7.p1.3.m3.1.2.2">subscript</csymbol><ci id="Sx3.SSx7.p1.3.m3.1.2.2.2.cmml" xref="Sx3.SSx7.p1.3.m3.1.2.2.2">𝑏</ci><ci id="Sx3.SSx7.p1.3.m3.1.2.2.3.cmml" xref="Sx3.SSx7.p1.3.m3.1.2.2.3">ℎ</ci></apply><apply id="Sx3.SSx7.p1.3.m3.1.2.3.cmml" xref="Sx3.SSx7.p1.3.m3.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx7.p1.3.m3.1.2.3.1.cmml" xref="Sx3.SSx7.p1.3.m3.1.2.3">superscript</csymbol><ci id="Sx3.SSx7.p1.3.m3.1.2.3.2.cmml" xref="Sx3.SSx7.p1.3.m3.1.2.3.2">ℝ</ci><apply id="Sx3.SSx7.p1.3.m3.1.1.1.2.cmml" xref="Sx3.SSx7.p1.3.m3.1.1.1.3"><abs id="Sx3.SSx7.p1.3.m3.1.1.1.2.1.cmml" xref="Sx3.SSx7.p1.3.m3.1.1.1.3.1"></abs><ci id="Sx3.SSx7.p1.3.m3.1.1.1.1.cmml" xref="Sx3.SSx7.p1.3.m3.1.1.1.1">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx7.p1.3.m3.1c">b_{h}\in\mathbb{R}^{\left|V\right|}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx7.p1.3.m3.1d">italic_b start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT | italic_V | end_POSTSUPERSCRIPT</annotation></semantics></math></p>
</div>
</section>
</section>
<section class="ltx_section" id="Sx4">
<h2 class="ltx_title ltx_title_section">Experiments</h2>
<div class="ltx_para" id="Sx4.p1">
<p class="ltx_p" id="Sx4.p1.1">In this section, we present the experimental design and results to demonstrate the effectiveness of our MaTrRec model. This study aims to address the following key questions:</p>
<ul class="ltx_itemize" id="Sx4.I2">
<li class="ltx_item" id="Sx4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I2.i1.p1">
<p class="ltx_p" id="Sx4.I2.i1.p1.1">Does the MaTrRec model outperform the current state-of-the-art sequential recommendation baselines?</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I2.i2.p1">
<p class="ltx_p" id="Sx4.I2.i2.p1.1">How does the performance of the MaTrRec model vary with different parameter settings?</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I2.i3.p1">
<p class="ltx_p" id="Sx4.I2.i3.p1.1">What is the impact of each component of the MaTrRec model on its overall performance?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="Sx4.SSx1">
<h3 class="ltx_title ltx_title_subsection">Datasets</h3>
<div class="ltx_para" id="Sx4.SSx1.p1">
<p class="ltx_p" id="Sx4.SSx1.p1.1">We conducted experiments on five widely used real-world datasets, including the MovieLens-1M dataset, the Steam dataset, and three Amazon datasets.</p>
<ul class="ltx_itemize" id="Sx4.I3">
<li class="ltx_item" id="Sx4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I3.i1.p1">
<p class="ltx_p" id="Sx4.I3.i1.p1.1">ML-1M Dataset: The MovieLens-1M dataset is a widely used public dataset in recommendation system research. It contains 1 million ratings from over 6,000 users on nearly 4,000 movies<cite class="ltx_cite ltx_citemacro_citep">(Harper and Konstan <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib6" title="">2015</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I3.i2.p1">
<p class="ltx_p" id="Sx4.I3.i2.p1.1">Musical,Health, Electronics, and Office datasets: These are multiple datasets from Amazon<cite class="ltx_cite ltx_citemacro_citep">(McAuley et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib18" title="">2015</a>)</cite>, and we have selected the ”Amazon Musical Instruments”, ”Amazon Health Personal Care”, ”Amazon Electronics”, and ”Amazon Office Products” datasets among them.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="Sx4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Statistics of datasets.</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="Sx4.T1.2" style="width:433.6pt;height:127.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(33.3pt,-9.8pt) scale(1.18116634197226,1.18116634197226) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="Sx4.T1.2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="Sx4.T1.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">#Users</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">#Items</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">#Inter</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">#Avg.Len<sub class="ltx_sub" id="Sx4.T1.1.1.1.1.1"><span class="ltx_text ltx_font_italic" id="Sx4.T1.1.1.1.1.1.1">U</span></sub>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">#Avg.Len<sub class="ltx_sub" id="Sx4.T1.2.2.2.2.1"><span class="ltx_text ltx_font_italic" id="Sx4.T1.2.2.2.2.1.1">I</span></sub>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">Sparsity</th>
</tr>
<tr class="ltx_tr" id="Sx4.T1.2.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.3.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">ML-1M</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.3.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">6,040</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.3.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">3,416</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.3.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">999,611</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.3.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">165.5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.3.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">292.6</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T1.2.2.3.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">95.16%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="Sx4.T1.2.2.4.1">
<td class="ltx_td ltx_align_left" id="Sx4.T1.2.2.4.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Musical</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.4.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">1430</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.4.1.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">901</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.4.1.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">10261</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.4.1.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">7.2</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.4.1.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">11.4</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.4.1.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">99.20%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.2.2.5.2">
<td class="ltx_td ltx_align_left" id="Sx4.T1.2.2.5.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Health</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.5.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">38610</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.5.2.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">18535</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.5.2.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">346355</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.5.2.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">9.0</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.5.2.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">18.7</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.5.2.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">99.95%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.2.2.6.3">
<td class="ltx_td ltx_align_left" id="Sx4.T1.2.2.6.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Electronics</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.6.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">192404</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.6.3.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">63002</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.6.3.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">1689188</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.6.3.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">8.8</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.6.3.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">26.8</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.2.2.6.3.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">99.99%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.2.2.7.4">
<td class="ltx_td ltx_align_left ltx_border_b" id="Sx4.T1.2.2.7.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Office</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.2.2.7.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">4906</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.2.2.7.4.3" style="padding-top:1.5pt;padding-bottom:1.5pt;">2421</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.2.2.7.4.4" style="padding-top:1.5pt;padding-bottom:1.5pt;">53258</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.2.2.7.4.5" style="padding-top:1.5pt;padding-bottom:1.5pt;">10.9</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.2.2.7.4.6" style="padding-top:1.5pt;padding-bottom:1.5pt;">22.0</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.2.2.7.4.7" style="padding-top:1.5pt;padding-bottom:1.5pt;">99.55%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="Sx4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Bold scores are the best in each row, while underlined scores are the second best. Improvements over baselines are statistically significant with <math alttext="p&lt;0.01" class="ltx_Math" display="inline" id="Sx4.T2.2.m1.1"><semantics id="Sx4.T2.2.m1.1b"><mrow id="Sx4.T2.2.m1.1.1" xref="Sx4.T2.2.m1.1.1.cmml"><mi id="Sx4.T2.2.m1.1.1.2" xref="Sx4.T2.2.m1.1.1.2.cmml">p</mi><mo id="Sx4.T2.2.m1.1.1.1" xref="Sx4.T2.2.m1.1.1.1.cmml">&lt;</mo><mn id="Sx4.T2.2.m1.1.1.3" xref="Sx4.T2.2.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.T2.2.m1.1c"><apply id="Sx4.T2.2.m1.1.1.cmml" xref="Sx4.T2.2.m1.1.1"><lt id="Sx4.T2.2.m1.1.1.1.cmml" xref="Sx4.T2.2.m1.1.1.1"></lt><ci id="Sx4.T2.2.m1.1.1.2.cmml" xref="Sx4.T2.2.m1.1.1.2">𝑝</ci><cn id="Sx4.T2.2.m1.1.1.3.cmml" type="float" xref="Sx4.T2.2.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.2.m1.1d">p&lt;0.01</annotation><annotation encoding="application/x-llamapun" id="Sx4.T2.2.m1.1e">italic_p &lt; 0.01</annotation></semantics></math>.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx4.T2.3" style="width:505.9pt;height:298.6pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-83.4pt,49.1pt) scale(0.752096439459062,0.752096439459062) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="Sx4.T2.3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="Sx4.T2.3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="Sx4.T2.3.1.1.1.1" rowspan="2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text" id="Sx4.T2.3.1.1.1.1.1">Datasets</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" id="Sx4.T2.3.1.1.1.2" rowspan="2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text" id="Sx4.T2.3.1.1.1.2.1">Metric</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T2.3.1.1.1.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">(a)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T2.3.1.1.1.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">(b)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T2.3.1.1.1.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">(c)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T2.3.1.1.1.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">(d)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T2.3.1.1.1.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">(e)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T2.3.1.1.1.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">(f)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T2.3.1.1.1.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">(g)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="Sx4.T2.3.1.1.1.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">(h)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx4.T2.3.1.1.1.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">(i)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="Sx4.T2.3.1.1.1.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">Improvement vs.</th>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T2.3.1.2.2.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">GRU4Rec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T2.3.1.2.2.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">NARM</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T2.3.1.2.2.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">SASRec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T2.3.1.2.2.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">NextItNet</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T2.3.1.2.2.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">BERT4Rec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T2.3.1.2.2.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">SINE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T2.3.1.2.2.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">CORE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="Sx4.T2.3.1.2.2.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">Mamba4Rec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T2.3.1.2.2.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">MaTrRec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T2.3.1.2.2.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">(c)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T2.3.1.2.2.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">(h)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="Sx4.T2.3.1.3.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.3.1.1" rowspan="4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text" id="Sx4.T2.3.1.3.1.1.1">ML-1M</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="Sx4.T2.3.1.3.1.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.3.1.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1935</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.3.1.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1684</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.3.1.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.2017</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.3.1.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0805</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.3.1.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1806</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.3.1.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0318</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.3.1.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0790</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.3.1.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.3.1.10.1">0.2258</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.3.1.11" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.3.1.11.1">0.2298</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.3.1.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">13.93%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.3.1.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.77%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.4.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.4.2.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.4.2.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.2773</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.4.2.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.2586</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.4.2.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.2803</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.4.2.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1278</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.4.2.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.2752</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.4.2.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0565</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.4.2.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1576</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.4.2.9" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.4.2.9.1">0.3132</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.4.2.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.4.2.10.1">0.3228</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.4.2.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">15.16%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.4.2.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.07%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.5.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.5.3.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@20</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.5.3.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.3760</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.5.3.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.3616</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.5.3.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.3811</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.5.3.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1954</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.5.3.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.3742</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.5.3.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1013</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.5.3.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.2705</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.5.3.9" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.5.3.9.1">0.4200</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.5.3.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.5.3.10.1">0.4242</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.5.3.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">11.31%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.5.3.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.00%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.6.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.6.4.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.6.4.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1597</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.6.4.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1414</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.6.4.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1611</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.6.4.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0672</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.6.4.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1528</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.6.4.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0273</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.6.4.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0681</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.6.4.9" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.6.4.9.1">0.1845</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.6.4.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.6.4.10.1">0.1882</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.6.4.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">16.82%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.6.4.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.01%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.7.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.7.5.1" rowspan="4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text" id="Sx4.T2.3.1.7.5.1.1">Musical</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="Sx4.T2.3.1.7.5.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.7.5.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0476</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.7.5.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0427</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.7.5.5" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.7.5.5.1">0.0700</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.7.5.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0518</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.7.5.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0427</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.7.5.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0350</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.7.5.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0189</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.7.5.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.7.5.10.1">0.0525</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.7.5.11" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.7.5.11.1">0.0700</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.7.5.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.00%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.7.5.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">33.33%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.8.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.8.6.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.8.6.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0707</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.8.6.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0665</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.8.6.4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.8.6.4.1">0.1029</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.8.6.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0784</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.8.6.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0700</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.8.6.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0777</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.8.6.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0651</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.8.6.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.084</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.8.6.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.8.6.10.1">0.1085</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.8.6.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.44%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.8.6.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">29.17%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.9.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.9.7.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@20</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.9.7.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1134</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.9.7.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1106</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.9.7.4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.9.7.4.1">0.1456</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.9.7.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1204</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.9.7.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1106</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.9.7.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1204</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.9.7.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1365</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.9.7.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1204</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.9.7.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.9.7.10.1">0.1554</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.9.7.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.73%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.9.7.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">29.07%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.10.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.10.8.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.10.8.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0384</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.10.8.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0352</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.10.8.4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.10.8.4.1">0.0516</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.10.8.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0427</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.10.8.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0404</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.10.8.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0353</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.10.8.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0240</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.10.8.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0439</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.10.8.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.10.8.10.1">0.0560</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.10.8.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">8.53%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.10.8.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">27.56%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.11.9">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.11.9.1" rowspan="4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text" id="Sx4.T2.3.1.11.9.1.1">Health</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="Sx4.T2.3.1.11.9.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.11.9.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0334</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.11.9.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0326</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.11.9.5" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.11.9.5.1">0.0393</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.11.9.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0238</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.11.9.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0174</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.11.9.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0330</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.11.9.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0223</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.11.9.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0385</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.11.9.11" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.11.9.11.1">0.0435</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.11.9.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">10.69%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.11.9.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">12.99%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.12.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.12.10.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.12.10.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0493</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.12.10.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0486</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.12.10.4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.12.10.4.1">0.0601</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.12.10.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0376</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.12.10.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0274</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.12.10.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0532</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.12.10.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0497</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.12.10.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0553</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.12.10.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.12.10.10.1">0.0662</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.12.10.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">10.15%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.12.10.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">19.71%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.13.11">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.13.11.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@20</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.13.11.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0700</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.13.11.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0689</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.13.11.4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.13.11.4.1">0.0856</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.13.11.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0576</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.13.11.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0442</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.13.11.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0773</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.13.11.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0822</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.13.11.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0791</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.13.11.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.13.11.10.1">0.0938</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.13.11.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">9.58%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.13.11.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">18.58%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.14.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.14.12.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.14.12.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0268</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.14.12.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0264</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.14.12.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0279</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.14.12.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0194</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.14.12.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0143</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.14.12.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0266</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.14.12.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0195</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.14.12.9" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.14.12.9.1">0.0314</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.14.12.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.14.12.10.1">0.0322</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.14.12.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">15.41%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.14.12.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.55%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.15.13">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.15.13.1" rowspan="4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text" id="Sx4.T2.3.1.15.13.1.1">Electronics</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="Sx4.T2.3.1.15.13.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.15.13.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0265</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.15.13.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0256</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.15.13.5" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.15.13.5.1">0.0321</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.15.13.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0222</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.15.13.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0194</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.15.13.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0238</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.15.13.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0210</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.15.13.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0300</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.15.13.11" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.15.13.11.1">0.0342</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.15.13.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.54%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.15.13.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">14.00%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.16.14">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.16.14.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.16.14.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0398</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.16.14.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0379</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.16.14.4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.16.14.4.1">0.0492</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.16.14.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0337</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.16.14.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0304</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.16.14.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0366</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.16.14.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0361</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.16.14.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0453</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.16.14.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.16.14.10.1">0.0526</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.16.14.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.91%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.16.14.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">16.11%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.17.15">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.17.15.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@20</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.17.15.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0583</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.17.15.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0556</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.17.15.4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.17.15.4.1">0.0711</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.17.15.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0503</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.17.15.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0458</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.17.15.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0543</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.17.15.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0564</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.17.15.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0658</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.17.15.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.17.15.10.1">0.0755</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.17.15.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.19%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.17.15.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">14.74%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.18.16">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.18.16.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.18.16.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0220</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.18.16.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0210</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.18.16.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0234</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.18.16.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0182</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.18.16.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0158</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.18.16.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0194</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.18.16.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0162</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.18.16.9" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.18.16.9.1">0.0250</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.18.16.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.18.16.10.1">0.0258</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.18.16.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">10.26%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.18.16.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.20%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.19.17">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="Sx4.T2.3.1.19.17.1" rowspan="4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text" id="Sx4.T2.3.1.19.17.1.1">Office</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="Sx4.T2.3.1.19.17.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.19.17.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0416</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.19.17.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0355</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.19.17.5" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.19.17.5.1">0.0624</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.19.17.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0306</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.19.17.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0218</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.19.17.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0451</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.19.17.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0489</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.19.17.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0538</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.19.17.11" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.19.17.11.1">0.0677</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.19.17.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">8.49%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.19.17.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">25.84%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.20.18">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.20.18.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.20.18.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0744</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.20.18.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0648</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.20.18.4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.20.18.4.1">0.0977</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.20.18.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0530</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.20.18.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0363</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.20.18.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0767</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.20.18.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0875</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.20.18.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0864</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.20.18.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.20.18.10.1">0.1019</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.20.18.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.30%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.20.18.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">17.94%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.21.19">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx4.T2.3.1.21.19.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@20</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.21.19.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1170</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.21.19.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1109</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.21.19.4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.21.19.4.1">0.1509</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.21.19.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0924</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.21.19.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0663</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.21.19.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1166</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.21.19.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1382</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.21.19.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1348</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.21.19.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.21.19.10.1">0.1598</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.21.19.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.90%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T2.3.1.21.19.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">18.55%</td>
</tr>
<tr class="ltx_tr" id="Sx4.T2.3.1.22.20">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="Sx4.T2.3.1.22.20.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T2.3.1.22.20.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0365</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T2.3.1.22.20.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0307</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T2.3.1.22.20.4" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="Sx4.T2.3.1.22.20.4.1">0.0482</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T2.3.1.22.20.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0253</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T2.3.1.22.20.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0181</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T2.3.1.22.20.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0376</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T2.3.1.22.20.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0371</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx4.T2.3.1.22.20.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0469</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T2.3.1.22.20.10" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.22.20.10.1">0.0519</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T2.3.1.22.20.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">7.68%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T2.3.1.22.20.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">10.66%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="Sx4.SSx1.p2">
<p class="ltx_p" id="Sx4.SSx1.p2.1">Before conducting experiments, we followed the same preprocessing method<cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib11" title="">2018</a>; Sun et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib21" title="">2019</a>)</cite>. Firstly, we grouped the data by user ID. Then, for each user, we sorted their interaction items based on timestamps to form each user’s interaction sequence. Additionally, we discarded users and items with fewer than five interactions<cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib11" title="">2018</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx4.SSx2">
<h3 class="ltx_title ltx_title_subsection">Experimental Details and Evaluation Metrics</h3>
<div class="ltx_para" id="Sx4.SSx2.p1">
<p class="ltx_p" id="Sx4.SSx2.p1.1">We used the open-source RecBole<cite class="ltx_cite ltx_citemacro_citep">(Zhao et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib30" title="">2021</a>)</cite> framework to evaluate the baseline models. All models have a hidden dimension of 64, a training batch size of 2048, and an evaluation batch size of 4096, trained using the Adam optimizer. In the Transformer, the number of heads in the multi-head attention mechanism is set to 1. For the Mamba block, we adopt common parameter settings, including a Sequential State Modeling (SSM) extension factor of 32, a 1D convolution kernel size of 4, and a linear projection extension factor of 2. On the Musical, Health, Electronics, and Office datasets, we set the dropout rate to 0.4 and the maximum sequence length to 50. On the MovieLens-1M dataset, the dropout rate is 0.1, and the maximum sequence length is 200.All experiments were conducted on Nvidia V100 GPUs on Alibaba Cloud.</p>
</div>
<div class="ltx_para" id="Sx4.SSx2.p2">
<p class="ltx_p" id="Sx4.SSx2.p2.1">We use two common evaluation metrics: Hit Rate (HR) and Normalized Discounted Cumulative Gain (NDCG). Model evaluation is performed using Leave-One-Out methodology, where each user has only one ground truth item, and HR@K is equivalent to Recall@K. Therefore, we report the following standard metrics: Recall@5, Recall@10, Recall@20, and NDCG@10. These metrics comprehensively assess the performance of models in recommendation tasks, particularly evaluating recall and ranking effectiveness across different recommendation list lengths.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx4.SSx3">
<h3 class="ltx_title ltx_title_subsection">Baseline Models</h3>
<div class="ltx_para" id="Sx4.SSx3.p1">
<p class="ltx_p" id="Sx4.SSx3.p1.1">We selected several representative models in the field of sequential recommendation for comparison:</p>
<ul class="ltx_itemize" id="Sx4.I4">
<li class="ltx_item" id="Sx4.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i1.p1">
<p class="ltx_p" id="Sx4.I4.i1.p1.1">GRU4Rec<cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib9" title="">2016</a>)</cite>: GRU4Rec is a model based on Gated Recurrent Units (GRU), specifically designed for sequential recommendation. It effectively captures sequential patterns in user behavior to predict the next item.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i2.p1">
<p class="ltx_p" id="Sx4.I4.i2.p1.1">NARM<cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib13" title="">2017</a>)</cite>: NARM combines Recurrent Neural Networks (RNN) with an attention mechanism to construct a recommendation model.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i3.p1">
<p class="ltx_p" id="Sx4.I4.i3.p1.1">SASRec<cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib11" title="">2018</a>)</cite>: SASRec is a sequential recommendation model based on the self-attention mechanism.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i4.p1">
<p class="ltx_p" id="Sx4.I4.i4.p1.1">NextItNet<cite class="ltx_cite ltx_citemacro_citep">(Yuan et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib29" title="">2019</a>)</cite>: NextItNet employs Convolutional Neural Networks (CNN) for item recommendation, leveraging CNN’s architecture for sequence modeling.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I4.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i5.p1">
<p class="ltx_p" id="Sx4.I4.i5.p1.1">BERT4Rec<cite class="ltx_cite ltx_citemacro_citep">(Sun et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib21" title="">2019</a>)</cite>: BERT4Rec utilizes the bidirectional encoder architecture of BERT to build a sequential recommendation model.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I4.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i6.p1">
<p class="ltx_p" id="Sx4.I4.i6.p1.1">SINE<cite class="ltx_cite ltx_citemacro_citep">(Tan et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib22" title="">2021</a>)</cite>:A sparse-interest network for sequential recom-
mendation.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I4.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i7.p1">
<p class="ltx_p" id="Sx4.I4.i7.p1.1">CORE<cite class="ltx_cite ltx_citemacro_citep">(Hou et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib10" title="">2022</a>)</cite>:A simple and effective session-based recommendation.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I4.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i8.p1">
<p class="ltx_p" id="Sx4.I4.i8.p1.1">Mamba4Rec<cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#bib.bib16" title="">2024</a>)</cite>: Mamba4Rec is a sequential recommendation model based on the Mamba architecture.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="Sx4.SSx4">
<h3 class="ltx_title ltx_title_subsection">Overall Performance</h3>
<div class="ltx_para" id="Sx4.SSx4.p1">
<p class="ltx_p" id="Sx4.SSx4.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.T2" title="Table 2 ‣ Datasets ‣ Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>presents the experimental results of our model on multiple datasets. According to the experimental data, the MaTrRec model significantly improved Recall@10 (by 15.16%) and NDCG@10 (by 16.82%) on the ML-1M long interaction sequence dataset compared to the Transformer-based SASRec model. On the Musical, Health, Electronics, and Office short interaction sequence datasets, the MaTrRec model showed an average increase in Recall@10 (by 6.7%) and NDCG@10 (by 10.47%) compared to the SASRec model. Additionally, compared to the Mamba-based Mamba4Rec model, MaTrRec achieved an average increase in Recall@10 (by 20.73%) on the Musical, Health, Electronics, and Office short interaction sequence datasets.</p>
</div>
<div class="ltx_para" id="Sx4.SSx4.p2">
<p class="ltx_p" id="Sx4.SSx4.p2.1">These results indicate that MaTrRec successfully combines the long-distance dependency handling capability of Mamba with the global attention capability of Transformer for short-term dependencies. This integration not only significantly enhances recommendation performance but also effectively addresses the data sparsity and cold start issues in recommendation systems. Our experimental results validate the robustness and versatility of MaTrRec across different datasets and interaction sequence lengths.</p>
</div>
<figure class="ltx_table" id="Sx4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Ablation Analysis on ML-1M, Musical, Health, Electronics, and Office Datasets. Bold scores indicate performance better than the default version, while ↓ indicates performance degradation over 10%. Default version (L=1, H=1).</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx4.T3.8" style="width:505.9pt;height:117.9pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-96.7pt,22.4pt) scale(0.723402267892033,0.723402267892033) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="Sx4.T3.8.8">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="Sx4.T3.8.8.9.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="Sx4.T3.8.8.9.1.1" rowspan="2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text" id="Sx4.T3.8.8.9.1.1.1">Architecture</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="Sx4.T3.8.8.9.1.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">ML-1m</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="Sx4.T3.8.8.9.1.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">Musical</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="Sx4.T3.8.8.9.1.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">Health</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="Sx4.T3.8.8.9.1.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">Electronics</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="Sx4.T3.8.8.9.1.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">Office</td>
</tr>
<tr class="ltx_tr" id="Sx4.T3.8.8.10.2">
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.10.2.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.10.2.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.10.2.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.10.2.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.10.2.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.10.2.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.10.2.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.10.2.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.10.2.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">Recall@10</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.10.2.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">NDCG@10</td>
</tr>
<tr class="ltx_tr" id="Sx4.T3.8.8.11.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="Sx4.T3.8.8.11.3.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">L=1,H=1</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.11.3.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.3228</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.11.3.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1882</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.11.3.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1085</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.11.3.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.056</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.11.3.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0662</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.11.3.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0322</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.11.3.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0526</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.11.3.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0258</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.11.3.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1019</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.11.3.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0519</td>
</tr>
<tr class="ltx_tr" id="Sx4.T3.8.8.12.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="Sx4.T3.8.8.12.4.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Add PE</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.12.4.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.3154</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.12.4.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1816</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.12.4.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1057</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.12.4.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0543</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.12.4.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0617</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.12.4.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0296</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.12.4.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0509</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.12.4.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0251</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.12.4.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0999</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.12.4.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0510</td>
</tr>
<tr class="ltx_tr" id="Sx4.T3.8.8.13.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="Sx4.T3.8.8.13.5.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Remove FFN</th>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.13.5.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.3146</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.13.5.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1819</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.13.5.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1036</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.13.5.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0548</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.13.5.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.061</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.13.5.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0291</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.13.5.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0521</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.13.5.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0259</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.13.5.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1036</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.13.5.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0509</td>
</tr>
<tr class="ltx_tr" id="Sx4.T3.8.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="Sx4.T3.8.8.8.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">Remove RC</th>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.8.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.2916</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.8.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1638</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.1.1.1.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0763<sup class="ltx_sup" id="Sx4.T3.1.1.1.1.1">↓</sup>
</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.2.2.2.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0419<sup class="ltx_sup" id="Sx4.T3.2.2.2.2.1">↓</sup>
</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.3.3.3.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0504<sup class="ltx_sup" id="Sx4.T3.3.3.3.3.1">↓</sup>
</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.4.4.4.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0258<sup class="ltx_sup" id="Sx4.T3.4.4.4.4.1">↓</sup>
</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.5.5.5.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0374<sup class="ltx_sup" id="Sx4.T3.5.5.5.5.1">↓</sup>
</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.6.6.6.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0198<sup class="ltx_sup" id="Sx4.T3.6.6.6.6.1">↓</sup>
</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.7.7.7.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.064<sup class="ltx_sup" id="Sx4.T3.7.7.7.7.1">↓</sup>
</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.8.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0315<sup class="ltx_sup" id="Sx4.T3.8.8.8.8.1">↓</sup>
</td>
</tr>
<tr class="ltx_tr" id="Sx4.T3.8.8.14.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="Sx4.T3.8.8.14.6.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Remove Dropout</th>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.14.6.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.3051</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.14.6.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1786</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.14.6.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.105</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.14.6.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0526</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.14.6.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0603</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.14.6.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0295</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.14.6.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0446</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.14.6.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0239</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.14.6.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.093</td>
<td class="ltx_td ltx_align_center" id="Sx4.T3.8.8.14.6.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0487</td>
</tr>
<tr class="ltx_tr" id="Sx4.T3.8.8.15.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="Sx4.T3.8.8.15.7.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">2heads(H=2)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.15.7.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.3141</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.15.7.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1825</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.15.7.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1057</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.15.7.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0549</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.15.7.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0649</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.15.7.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0313</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.15.7.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0522</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.15.7.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0256</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.15.7.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1011</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T3.8.8.15.7.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0500</td>
</tr>
<tr class="ltx_tr" id="Sx4.T3.8.8.16.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="Sx4.T3.8.8.16.8.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">2layers(L=2)</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T3.8.8.16.8.2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T3.8.8.16.8.2.1">0.3255</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T3.8.8.16.8.3" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T3.8.8.16.8.3.1">0.1904</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T3.8.8.16.8.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1085</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T3.8.8.16.8.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0550</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T3.8.8.16.8.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0650</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T3.8.8.16.8.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0322</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T3.8.8.16.8.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0515</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T3.8.8.16.8.9" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T3.8.8.16.8.9.1">0.0259</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T3.8.8.16.8.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.1003</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T3.8.8.16.8.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.0516</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="Sx4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="166" id="Sx4.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The effect of Dropout on a model’s Recall@10 and NDCG@10 performance.</figcaption>
</figure>
<div class="ltx_para" id="Sx4.SSx4.p3">
<ul class="ltx_itemize" id="Sx4.I5">
<li class="ltx_item" id="Sx4.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I5.i1.p1">
<p class="ltx_p" id="Sx4.I5.i1.p1.5">NDCG (Normalized Discounted Cumulative Gain) measures the ranking quality of the recommendation list. A higher NDCG@K indicates that the recommended items are ranked closer to the optimal order, better reflecting the user’s potential interest order. The position of the recommended items determines the NDCG@K score. The NDCG@K formula is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="NDCG_{k}=\frac{1}{IDCG_{k}}\sum_{i=1}^{k}\frac{2^{rel_{i}}-1}{log_{2}\left(i+1%
\right)}" class="ltx_Math" display="block" id="Sx4.E8.m1.1"><semantics id="Sx4.E8.m1.1a"><mrow id="Sx4.E8.m1.1.2" xref="Sx4.E8.m1.1.2.cmml"><mrow id="Sx4.E8.m1.1.2.2" xref="Sx4.E8.m1.1.2.2.cmml"><mi id="Sx4.E8.m1.1.2.2.2" xref="Sx4.E8.m1.1.2.2.2.cmml">N</mi><mo id="Sx4.E8.m1.1.2.2.1" xref="Sx4.E8.m1.1.2.2.1.cmml">⁢</mo><mi id="Sx4.E8.m1.1.2.2.3" xref="Sx4.E8.m1.1.2.2.3.cmml">D</mi><mo id="Sx4.E8.m1.1.2.2.1a" xref="Sx4.E8.m1.1.2.2.1.cmml">⁢</mo><mi id="Sx4.E8.m1.1.2.2.4" xref="Sx4.E8.m1.1.2.2.4.cmml">C</mi><mo id="Sx4.E8.m1.1.2.2.1b" xref="Sx4.E8.m1.1.2.2.1.cmml">⁢</mo><msub id="Sx4.E8.m1.1.2.2.5" xref="Sx4.E8.m1.1.2.2.5.cmml"><mi id="Sx4.E8.m1.1.2.2.5.2" xref="Sx4.E8.m1.1.2.2.5.2.cmml">G</mi><mi id="Sx4.E8.m1.1.2.2.5.3" xref="Sx4.E8.m1.1.2.2.5.3.cmml">k</mi></msub></mrow><mo id="Sx4.E8.m1.1.2.1" xref="Sx4.E8.m1.1.2.1.cmml">=</mo><mrow id="Sx4.E8.m1.1.2.3" xref="Sx4.E8.m1.1.2.3.cmml"><mfrac id="Sx4.E8.m1.1.2.3.2" xref="Sx4.E8.m1.1.2.3.2.cmml"><mn id="Sx4.E8.m1.1.2.3.2.2" xref="Sx4.E8.m1.1.2.3.2.2.cmml">1</mn><mrow id="Sx4.E8.m1.1.2.3.2.3" xref="Sx4.E8.m1.1.2.3.2.3.cmml"><mi id="Sx4.E8.m1.1.2.3.2.3.2" xref="Sx4.E8.m1.1.2.3.2.3.2.cmml">I</mi><mo id="Sx4.E8.m1.1.2.3.2.3.1" xref="Sx4.E8.m1.1.2.3.2.3.1.cmml">⁢</mo><mi id="Sx4.E8.m1.1.2.3.2.3.3" xref="Sx4.E8.m1.1.2.3.2.3.3.cmml">D</mi><mo id="Sx4.E8.m1.1.2.3.2.3.1a" xref="Sx4.E8.m1.1.2.3.2.3.1.cmml">⁢</mo><mi id="Sx4.E8.m1.1.2.3.2.3.4" xref="Sx4.E8.m1.1.2.3.2.3.4.cmml">C</mi><mo id="Sx4.E8.m1.1.2.3.2.3.1b" xref="Sx4.E8.m1.1.2.3.2.3.1.cmml">⁢</mo><msub id="Sx4.E8.m1.1.2.3.2.3.5" xref="Sx4.E8.m1.1.2.3.2.3.5.cmml"><mi id="Sx4.E8.m1.1.2.3.2.3.5.2" xref="Sx4.E8.m1.1.2.3.2.3.5.2.cmml">G</mi><mi id="Sx4.E8.m1.1.2.3.2.3.5.3" xref="Sx4.E8.m1.1.2.3.2.3.5.3.cmml">k</mi></msub></mrow></mfrac><mo id="Sx4.E8.m1.1.2.3.1" xref="Sx4.E8.m1.1.2.3.1.cmml">⁢</mo><mrow id="Sx4.E8.m1.1.2.3.3" xref="Sx4.E8.m1.1.2.3.3.cmml"><munderover id="Sx4.E8.m1.1.2.3.3.1" xref="Sx4.E8.m1.1.2.3.3.1.cmml"><mo id="Sx4.E8.m1.1.2.3.3.1.2.2" movablelimits="false" xref="Sx4.E8.m1.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="Sx4.E8.m1.1.2.3.3.1.2.3" xref="Sx4.E8.m1.1.2.3.3.1.2.3.cmml"><mi id="Sx4.E8.m1.1.2.3.3.1.2.3.2" xref="Sx4.E8.m1.1.2.3.3.1.2.3.2.cmml">i</mi><mo id="Sx4.E8.m1.1.2.3.3.1.2.3.1" xref="Sx4.E8.m1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="Sx4.E8.m1.1.2.3.3.1.2.3.3" xref="Sx4.E8.m1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="Sx4.E8.m1.1.2.3.3.1.3" xref="Sx4.E8.m1.1.2.3.3.1.3.cmml">k</mi></munderover><mfrac id="Sx4.E8.m1.1.1" xref="Sx4.E8.m1.1.1.cmml"><mrow id="Sx4.E8.m1.1.1.3" xref="Sx4.E8.m1.1.1.3.cmml"><msup id="Sx4.E8.m1.1.1.3.2" xref="Sx4.E8.m1.1.1.3.2.cmml"><mn id="Sx4.E8.m1.1.1.3.2.2" xref="Sx4.E8.m1.1.1.3.2.2.cmml">2</mn><mrow id="Sx4.E8.m1.1.1.3.2.3" xref="Sx4.E8.m1.1.1.3.2.3.cmml"><mi id="Sx4.E8.m1.1.1.3.2.3.2" xref="Sx4.E8.m1.1.1.3.2.3.2.cmml">r</mi><mo id="Sx4.E8.m1.1.1.3.2.3.1" xref="Sx4.E8.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="Sx4.E8.m1.1.1.3.2.3.3" xref="Sx4.E8.m1.1.1.3.2.3.3.cmml">e</mi><mo id="Sx4.E8.m1.1.1.3.2.3.1a" xref="Sx4.E8.m1.1.1.3.2.3.1.cmml">⁢</mo><msub id="Sx4.E8.m1.1.1.3.2.3.4" xref="Sx4.E8.m1.1.1.3.2.3.4.cmml"><mi id="Sx4.E8.m1.1.1.3.2.3.4.2" xref="Sx4.E8.m1.1.1.3.2.3.4.2.cmml">l</mi><mi id="Sx4.E8.m1.1.1.3.2.3.4.3" xref="Sx4.E8.m1.1.1.3.2.3.4.3.cmml">i</mi></msub></mrow></msup><mo id="Sx4.E8.m1.1.1.3.1" xref="Sx4.E8.m1.1.1.3.1.cmml">−</mo><mn id="Sx4.E8.m1.1.1.3.3" xref="Sx4.E8.m1.1.1.3.3.cmml">1</mn></mrow><mrow id="Sx4.E8.m1.1.1.1" xref="Sx4.E8.m1.1.1.1.cmml"><mi id="Sx4.E8.m1.1.1.1.3" xref="Sx4.E8.m1.1.1.1.3.cmml">l</mi><mo id="Sx4.E8.m1.1.1.1.2" xref="Sx4.E8.m1.1.1.1.2.cmml">⁢</mo><mi id="Sx4.E8.m1.1.1.1.4" xref="Sx4.E8.m1.1.1.1.4.cmml">o</mi><mo id="Sx4.E8.m1.1.1.1.2a" xref="Sx4.E8.m1.1.1.1.2.cmml">⁢</mo><msub id="Sx4.E8.m1.1.1.1.5" xref="Sx4.E8.m1.1.1.1.5.cmml"><mi id="Sx4.E8.m1.1.1.1.5.2" xref="Sx4.E8.m1.1.1.1.5.2.cmml">g</mi><mn id="Sx4.E8.m1.1.1.1.5.3" xref="Sx4.E8.m1.1.1.1.5.3.cmml">2</mn></msub><mo id="Sx4.E8.m1.1.1.1.2b" xref="Sx4.E8.m1.1.1.1.2.cmml">⁢</mo><mrow id="Sx4.E8.m1.1.1.1.1.1" xref="Sx4.E8.m1.1.1.1.1.1.1.cmml"><mo id="Sx4.E8.m1.1.1.1.1.1.2" xref="Sx4.E8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.E8.m1.1.1.1.1.1.1" xref="Sx4.E8.m1.1.1.1.1.1.1.cmml"><mi id="Sx4.E8.m1.1.1.1.1.1.1.2" xref="Sx4.E8.m1.1.1.1.1.1.1.2.cmml">i</mi><mo id="Sx4.E8.m1.1.1.1.1.1.1.1" xref="Sx4.E8.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="Sx4.E8.m1.1.1.1.1.1.1.3" xref="Sx4.E8.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="Sx4.E8.m1.1.1.1.1.1.3" xref="Sx4.E8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E8.m1.1b"><apply id="Sx4.E8.m1.1.2.cmml" xref="Sx4.E8.m1.1.2"><eq id="Sx4.E8.m1.1.2.1.cmml" xref="Sx4.E8.m1.1.2.1"></eq><apply id="Sx4.E8.m1.1.2.2.cmml" xref="Sx4.E8.m1.1.2.2"><times id="Sx4.E8.m1.1.2.2.1.cmml" xref="Sx4.E8.m1.1.2.2.1"></times><ci id="Sx4.E8.m1.1.2.2.2.cmml" xref="Sx4.E8.m1.1.2.2.2">𝑁</ci><ci id="Sx4.E8.m1.1.2.2.3.cmml" xref="Sx4.E8.m1.1.2.2.3">𝐷</ci><ci id="Sx4.E8.m1.1.2.2.4.cmml" xref="Sx4.E8.m1.1.2.2.4">𝐶</ci><apply id="Sx4.E8.m1.1.2.2.5.cmml" xref="Sx4.E8.m1.1.2.2.5"><csymbol cd="ambiguous" id="Sx4.E8.m1.1.2.2.5.1.cmml" xref="Sx4.E8.m1.1.2.2.5">subscript</csymbol><ci id="Sx4.E8.m1.1.2.2.5.2.cmml" xref="Sx4.E8.m1.1.2.2.5.2">𝐺</ci><ci id="Sx4.E8.m1.1.2.2.5.3.cmml" xref="Sx4.E8.m1.1.2.2.5.3">𝑘</ci></apply></apply><apply id="Sx4.E8.m1.1.2.3.cmml" xref="Sx4.E8.m1.1.2.3"><times id="Sx4.E8.m1.1.2.3.1.cmml" xref="Sx4.E8.m1.1.2.3.1"></times><apply id="Sx4.E8.m1.1.2.3.2.cmml" xref="Sx4.E8.m1.1.2.3.2"><divide id="Sx4.E8.m1.1.2.3.2.1.cmml" xref="Sx4.E8.m1.1.2.3.2"></divide><cn id="Sx4.E8.m1.1.2.3.2.2.cmml" type="integer" xref="Sx4.E8.m1.1.2.3.2.2">1</cn><apply id="Sx4.E8.m1.1.2.3.2.3.cmml" xref="Sx4.E8.m1.1.2.3.2.3"><times id="Sx4.E8.m1.1.2.3.2.3.1.cmml" xref="Sx4.E8.m1.1.2.3.2.3.1"></times><ci id="Sx4.E8.m1.1.2.3.2.3.2.cmml" xref="Sx4.E8.m1.1.2.3.2.3.2">𝐼</ci><ci id="Sx4.E8.m1.1.2.3.2.3.3.cmml" xref="Sx4.E8.m1.1.2.3.2.3.3">𝐷</ci><ci id="Sx4.E8.m1.1.2.3.2.3.4.cmml" xref="Sx4.E8.m1.1.2.3.2.3.4">𝐶</ci><apply id="Sx4.E8.m1.1.2.3.2.3.5.cmml" xref="Sx4.E8.m1.1.2.3.2.3.5"><csymbol cd="ambiguous" id="Sx4.E8.m1.1.2.3.2.3.5.1.cmml" xref="Sx4.E8.m1.1.2.3.2.3.5">subscript</csymbol><ci id="Sx4.E8.m1.1.2.3.2.3.5.2.cmml" xref="Sx4.E8.m1.1.2.3.2.3.5.2">𝐺</ci><ci id="Sx4.E8.m1.1.2.3.2.3.5.3.cmml" xref="Sx4.E8.m1.1.2.3.2.3.5.3">𝑘</ci></apply></apply></apply><apply id="Sx4.E8.m1.1.2.3.3.cmml" xref="Sx4.E8.m1.1.2.3.3"><apply id="Sx4.E8.m1.1.2.3.3.1.cmml" xref="Sx4.E8.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="Sx4.E8.m1.1.2.3.3.1.1.cmml" xref="Sx4.E8.m1.1.2.3.3.1">superscript</csymbol><apply id="Sx4.E8.m1.1.2.3.3.1.2.cmml" xref="Sx4.E8.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="Sx4.E8.m1.1.2.3.3.1.2.1.cmml" xref="Sx4.E8.m1.1.2.3.3.1">subscript</csymbol><sum id="Sx4.E8.m1.1.2.3.3.1.2.2.cmml" xref="Sx4.E8.m1.1.2.3.3.1.2.2"></sum><apply id="Sx4.E8.m1.1.2.3.3.1.2.3.cmml" xref="Sx4.E8.m1.1.2.3.3.1.2.3"><eq id="Sx4.E8.m1.1.2.3.3.1.2.3.1.cmml" xref="Sx4.E8.m1.1.2.3.3.1.2.3.1"></eq><ci id="Sx4.E8.m1.1.2.3.3.1.2.3.2.cmml" xref="Sx4.E8.m1.1.2.3.3.1.2.3.2">𝑖</ci><cn id="Sx4.E8.m1.1.2.3.3.1.2.3.3.cmml" type="integer" xref="Sx4.E8.m1.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="Sx4.E8.m1.1.2.3.3.1.3.cmml" xref="Sx4.E8.m1.1.2.3.3.1.3">𝑘</ci></apply><apply id="Sx4.E8.m1.1.1.cmml" xref="Sx4.E8.m1.1.1"><divide id="Sx4.E8.m1.1.1.2.cmml" xref="Sx4.E8.m1.1.1"></divide><apply id="Sx4.E8.m1.1.1.3.cmml" xref="Sx4.E8.m1.1.1.3"><minus id="Sx4.E8.m1.1.1.3.1.cmml" xref="Sx4.E8.m1.1.1.3.1"></minus><apply id="Sx4.E8.m1.1.1.3.2.cmml" xref="Sx4.E8.m1.1.1.3.2"><csymbol cd="ambiguous" id="Sx4.E8.m1.1.1.3.2.1.cmml" xref="Sx4.E8.m1.1.1.3.2">superscript</csymbol><cn id="Sx4.E8.m1.1.1.3.2.2.cmml" type="integer" xref="Sx4.E8.m1.1.1.3.2.2">2</cn><apply id="Sx4.E8.m1.1.1.3.2.3.cmml" xref="Sx4.E8.m1.1.1.3.2.3"><times id="Sx4.E8.m1.1.1.3.2.3.1.cmml" xref="Sx4.E8.m1.1.1.3.2.3.1"></times><ci id="Sx4.E8.m1.1.1.3.2.3.2.cmml" xref="Sx4.E8.m1.1.1.3.2.3.2">𝑟</ci><ci id="Sx4.E8.m1.1.1.3.2.3.3.cmml" xref="Sx4.E8.m1.1.1.3.2.3.3">𝑒</ci><apply id="Sx4.E8.m1.1.1.3.2.3.4.cmml" xref="Sx4.E8.m1.1.1.3.2.3.4"><csymbol cd="ambiguous" id="Sx4.E8.m1.1.1.3.2.3.4.1.cmml" xref="Sx4.E8.m1.1.1.3.2.3.4">subscript</csymbol><ci id="Sx4.E8.m1.1.1.3.2.3.4.2.cmml" xref="Sx4.E8.m1.1.1.3.2.3.4.2">𝑙</ci><ci id="Sx4.E8.m1.1.1.3.2.3.4.3.cmml" xref="Sx4.E8.m1.1.1.3.2.3.4.3">𝑖</ci></apply></apply></apply><cn id="Sx4.E8.m1.1.1.3.3.cmml" type="integer" xref="Sx4.E8.m1.1.1.3.3">1</cn></apply><apply id="Sx4.E8.m1.1.1.1.cmml" xref="Sx4.E8.m1.1.1.1"><times id="Sx4.E8.m1.1.1.1.2.cmml" xref="Sx4.E8.m1.1.1.1.2"></times><ci id="Sx4.E8.m1.1.1.1.3.cmml" xref="Sx4.E8.m1.1.1.1.3">𝑙</ci><ci id="Sx4.E8.m1.1.1.1.4.cmml" xref="Sx4.E8.m1.1.1.1.4">𝑜</ci><apply id="Sx4.E8.m1.1.1.1.5.cmml" xref="Sx4.E8.m1.1.1.1.5"><csymbol cd="ambiguous" id="Sx4.E8.m1.1.1.1.5.1.cmml" xref="Sx4.E8.m1.1.1.1.5">subscript</csymbol><ci id="Sx4.E8.m1.1.1.1.5.2.cmml" xref="Sx4.E8.m1.1.1.1.5.2">𝑔</ci><cn id="Sx4.E8.m1.1.1.1.5.3.cmml" type="integer" xref="Sx4.E8.m1.1.1.1.5.3">2</cn></apply><apply id="Sx4.E8.m1.1.1.1.1.1.1.cmml" xref="Sx4.E8.m1.1.1.1.1.1"><plus id="Sx4.E8.m1.1.1.1.1.1.1.1.cmml" xref="Sx4.E8.m1.1.1.1.1.1.1.1"></plus><ci id="Sx4.E8.m1.1.1.1.1.1.1.2.cmml" xref="Sx4.E8.m1.1.1.1.1.1.1.2">𝑖</ci><cn id="Sx4.E8.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="Sx4.E8.m1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E8.m1.1c">NDCG_{k}=\frac{1}{IDCG_{k}}\sum_{i=1}^{k}\frac{2^{rel_{i}}-1}{log_{2}\left(i+1%
\right)}</annotation><annotation encoding="application/x-llamapun" id="Sx4.E8.m1.1d">italic_N italic_D italic_C italic_G start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_I italic_D italic_C italic_G start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT divide start_ARG 2 start_POSTSUPERSCRIPT italic_r italic_e italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT - 1 end_ARG start_ARG italic_l italic_o italic_g start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_i + 1 ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx4.I5.i1.p1.4">where <math alttext="rel_{i}" class="ltx_Math" display="inline" id="Sx4.I5.i1.p1.1.m1.1"><semantics id="Sx4.I5.i1.p1.1.m1.1a"><mrow id="Sx4.I5.i1.p1.1.m1.1.1" xref="Sx4.I5.i1.p1.1.m1.1.1.cmml"><mi id="Sx4.I5.i1.p1.1.m1.1.1.2" xref="Sx4.I5.i1.p1.1.m1.1.1.2.cmml">r</mi><mo id="Sx4.I5.i1.p1.1.m1.1.1.1" xref="Sx4.I5.i1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="Sx4.I5.i1.p1.1.m1.1.1.3" xref="Sx4.I5.i1.p1.1.m1.1.1.3.cmml">e</mi><mo id="Sx4.I5.i1.p1.1.m1.1.1.1a" xref="Sx4.I5.i1.p1.1.m1.1.1.1.cmml">⁢</mo><msub id="Sx4.I5.i1.p1.1.m1.1.1.4" xref="Sx4.I5.i1.p1.1.m1.1.1.4.cmml"><mi id="Sx4.I5.i1.p1.1.m1.1.1.4.2" xref="Sx4.I5.i1.p1.1.m1.1.1.4.2.cmml">l</mi><mi id="Sx4.I5.i1.p1.1.m1.1.1.4.3" xref="Sx4.I5.i1.p1.1.m1.1.1.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.1.m1.1b"><apply id="Sx4.I5.i1.p1.1.m1.1.1.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1"><times id="Sx4.I5.i1.p1.1.m1.1.1.1.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1.1"></times><ci id="Sx4.I5.i1.p1.1.m1.1.1.2.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1.2">𝑟</ci><ci id="Sx4.I5.i1.p1.1.m1.1.1.3.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1.3">𝑒</ci><apply id="Sx4.I5.i1.p1.1.m1.1.1.4.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.1.m1.1.1.4.1.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1.4">subscript</csymbol><ci id="Sx4.I5.i1.p1.1.m1.1.1.4.2.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1.4.2">𝑙</ci><ci id="Sx4.I5.i1.p1.1.m1.1.1.4.3.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.1.m1.1c">rel_{i}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I5.i1.p1.1.m1.1d">italic_r italic_e italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the relevance score of the item at position <math alttext="i" class="ltx_Math" display="inline" id="Sx4.I5.i1.p1.2.m2.1"><semantics id="Sx4.I5.i1.p1.2.m2.1a"><mi id="Sx4.I5.i1.p1.2.m2.1.1" xref="Sx4.I5.i1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.2.m2.1b"><ci id="Sx4.I5.i1.p1.2.m2.1.1.cmml" xref="Sx4.I5.i1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="Sx4.I5.i1.p1.2.m2.1d">italic_i</annotation></semantics></math>,and <math alttext="IDCG_{k}" class="ltx_Math" display="inline" id="Sx4.I5.i1.p1.3.m3.1"><semantics id="Sx4.I5.i1.p1.3.m3.1a"><mrow id="Sx4.I5.i1.p1.3.m3.1.1" xref="Sx4.I5.i1.p1.3.m3.1.1.cmml"><mi id="Sx4.I5.i1.p1.3.m3.1.1.2" xref="Sx4.I5.i1.p1.3.m3.1.1.2.cmml">I</mi><mo id="Sx4.I5.i1.p1.3.m3.1.1.1" xref="Sx4.I5.i1.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="Sx4.I5.i1.p1.3.m3.1.1.3" xref="Sx4.I5.i1.p1.3.m3.1.1.3.cmml">D</mi><mo id="Sx4.I5.i1.p1.3.m3.1.1.1a" xref="Sx4.I5.i1.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="Sx4.I5.i1.p1.3.m3.1.1.4" xref="Sx4.I5.i1.p1.3.m3.1.1.4.cmml">C</mi><mo id="Sx4.I5.i1.p1.3.m3.1.1.1b" xref="Sx4.I5.i1.p1.3.m3.1.1.1.cmml">⁢</mo><msub id="Sx4.I5.i1.p1.3.m3.1.1.5" xref="Sx4.I5.i1.p1.3.m3.1.1.5.cmml"><mi id="Sx4.I5.i1.p1.3.m3.1.1.5.2" xref="Sx4.I5.i1.p1.3.m3.1.1.5.2.cmml">G</mi><mi id="Sx4.I5.i1.p1.3.m3.1.1.5.3" xref="Sx4.I5.i1.p1.3.m3.1.1.5.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.3.m3.1b"><apply id="Sx4.I5.i1.p1.3.m3.1.1.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1"><times id="Sx4.I5.i1.p1.3.m3.1.1.1.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1.1"></times><ci id="Sx4.I5.i1.p1.3.m3.1.1.2.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1.2">𝐼</ci><ci id="Sx4.I5.i1.p1.3.m3.1.1.3.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1.3">𝐷</ci><ci id="Sx4.I5.i1.p1.3.m3.1.1.4.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1.4">𝐶</ci><apply id="Sx4.I5.i1.p1.3.m3.1.1.5.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1.5"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.3.m3.1.1.5.1.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1.5">subscript</csymbol><ci id="Sx4.I5.i1.p1.3.m3.1.1.5.2.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1.5.2">𝐺</ci><ci id="Sx4.I5.i1.p1.3.m3.1.1.5.3.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1.5.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.3.m3.1c">IDCG_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I5.i1.p1.3.m3.1d">italic_I italic_D italic_C italic_G start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the ideal <math alttext="DCG" class="ltx_Math" display="inline" id="Sx4.I5.i1.p1.4.m4.1"><semantics id="Sx4.I5.i1.p1.4.m4.1a"><mrow id="Sx4.I5.i1.p1.4.m4.1.1" xref="Sx4.I5.i1.p1.4.m4.1.1.cmml"><mi id="Sx4.I5.i1.p1.4.m4.1.1.2" xref="Sx4.I5.i1.p1.4.m4.1.1.2.cmml">D</mi><mo id="Sx4.I5.i1.p1.4.m4.1.1.1" xref="Sx4.I5.i1.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="Sx4.I5.i1.p1.4.m4.1.1.3" xref="Sx4.I5.i1.p1.4.m4.1.1.3.cmml">C</mi><mo id="Sx4.I5.i1.p1.4.m4.1.1.1a" xref="Sx4.I5.i1.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="Sx4.I5.i1.p1.4.m4.1.1.4" xref="Sx4.I5.i1.p1.4.m4.1.1.4.cmml">G</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.4.m4.1b"><apply id="Sx4.I5.i1.p1.4.m4.1.1.cmml" xref="Sx4.I5.i1.p1.4.m4.1.1"><times id="Sx4.I5.i1.p1.4.m4.1.1.1.cmml" xref="Sx4.I5.i1.p1.4.m4.1.1.1"></times><ci id="Sx4.I5.i1.p1.4.m4.1.1.2.cmml" xref="Sx4.I5.i1.p1.4.m4.1.1.2">𝐷</ci><ci id="Sx4.I5.i1.p1.4.m4.1.1.3.cmml" xref="Sx4.I5.i1.p1.4.m4.1.1.3">𝐶</ci><ci id="Sx4.I5.i1.p1.4.m4.1.1.4.cmml" xref="Sx4.I5.i1.p1.4.m4.1.1.4">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.4.m4.1c">DCG</annotation><annotation encoding="application/x-llamapun" id="Sx4.I5.i1.p1.4.m4.1d">italic_D italic_C italic_G</annotation></semantics></math> value.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I5.i2.p1">
<p class="ltx_p" id="Sx4.I5.i2.p1.5">Recall@K calculates the number of relevant items among the top K items recommended by the model that the user is actually interested in (i.e., items marked as positive in the test set). A higher Recall@K indicates that the model captures more of the user’s real interests within the limited recommendation positions. Recall@K focuses solely on how many of the top K recommended items are relevant, regardless of their positions. The formula for Recall is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Recall_{k}=\frac{{\textstyle\sum_{u\in\mathcal{U}}}\left|Rel_{u}\bigcap Rec_{u%
}\right|}{{\textstyle\sum_{u\in\mathcal{U}}}\left|Rel_{u}\right|}" class="ltx_Math" display="block" id="Sx4.E9.m1.2"><semantics id="Sx4.E9.m1.2a"><mrow id="Sx4.E9.m1.2.3" xref="Sx4.E9.m1.2.3.cmml"><mrow id="Sx4.E9.m1.2.3.2" xref="Sx4.E9.m1.2.3.2.cmml"><mi id="Sx4.E9.m1.2.3.2.2" xref="Sx4.E9.m1.2.3.2.2.cmml">R</mi><mo id="Sx4.E9.m1.2.3.2.1" xref="Sx4.E9.m1.2.3.2.1.cmml">⁢</mo><mi id="Sx4.E9.m1.2.3.2.3" xref="Sx4.E9.m1.2.3.2.3.cmml">e</mi><mo id="Sx4.E9.m1.2.3.2.1a" xref="Sx4.E9.m1.2.3.2.1.cmml">⁢</mo><mi id="Sx4.E9.m1.2.3.2.4" xref="Sx4.E9.m1.2.3.2.4.cmml">c</mi><mo id="Sx4.E9.m1.2.3.2.1b" xref="Sx4.E9.m1.2.3.2.1.cmml">⁢</mo><mi id="Sx4.E9.m1.2.3.2.5" xref="Sx4.E9.m1.2.3.2.5.cmml">a</mi><mo id="Sx4.E9.m1.2.3.2.1c" xref="Sx4.E9.m1.2.3.2.1.cmml">⁢</mo><mi id="Sx4.E9.m1.2.3.2.6" xref="Sx4.E9.m1.2.3.2.6.cmml">l</mi><mo id="Sx4.E9.m1.2.3.2.1d" xref="Sx4.E9.m1.2.3.2.1.cmml">⁢</mo><msub id="Sx4.E9.m1.2.3.2.7" xref="Sx4.E9.m1.2.3.2.7.cmml"><mi id="Sx4.E9.m1.2.3.2.7.2" xref="Sx4.E9.m1.2.3.2.7.2.cmml">l</mi><mi id="Sx4.E9.m1.2.3.2.7.3" xref="Sx4.E9.m1.2.3.2.7.3.cmml">k</mi></msub></mrow><mo id="Sx4.E9.m1.2.3.1" xref="Sx4.E9.m1.2.3.1.cmml">=</mo><mfrac id="Sx4.E9.m1.2.2" xref="Sx4.E9.m1.2.2.cmml"><mrow id="Sx4.E9.m1.1.1.1" xref="Sx4.E9.m1.1.1.1.cmml"><msub id="Sx4.E9.m1.1.1.1.2" xref="Sx4.E9.m1.1.1.1.2.cmml"><mo id="Sx4.E9.m1.1.1.1.2.2" xref="Sx4.E9.m1.1.1.1.2.2.cmml">∑</mo><mrow id="Sx4.E9.m1.1.1.1.2.3" xref="Sx4.E9.m1.1.1.1.2.3.cmml"><mi id="Sx4.E9.m1.1.1.1.2.3.2" xref="Sx4.E9.m1.1.1.1.2.3.2.cmml">u</mi><mo id="Sx4.E9.m1.1.1.1.2.3.1" xref="Sx4.E9.m1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Sx4.E9.m1.1.1.1.2.3.3" xref="Sx4.E9.m1.1.1.1.2.3.3.cmml">𝒰</mi></mrow></msub><mrow id="Sx4.E9.m1.1.1.1.1.1" xref="Sx4.E9.m1.1.1.1.1.2.cmml"><mo id="Sx4.E9.m1.1.1.1.1.1.2" lspace="0em" xref="Sx4.E9.m1.1.1.1.1.2.1.cmml">|</mo><mrow id="Sx4.E9.m1.1.1.1.1.1.1" xref="Sx4.E9.m1.1.1.1.1.1.1.cmml"><mi id="Sx4.E9.m1.1.1.1.1.1.1.2" xref="Sx4.E9.m1.1.1.1.1.1.1.2.cmml">R</mi><mo id="Sx4.E9.m1.1.1.1.1.1.1.1" xref="Sx4.E9.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="Sx4.E9.m1.1.1.1.1.1.1.3" xref="Sx4.E9.m1.1.1.1.1.1.1.3.cmml">e</mi><mo id="Sx4.E9.m1.1.1.1.1.1.1.1a" xref="Sx4.E9.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="Sx4.E9.m1.1.1.1.1.1.1.4" xref="Sx4.E9.m1.1.1.1.1.1.1.4.cmml"><mi id="Sx4.E9.m1.1.1.1.1.1.1.4.2" xref="Sx4.E9.m1.1.1.1.1.1.1.4.2.cmml">l</mi><mi id="Sx4.E9.m1.1.1.1.1.1.1.4.3" xref="Sx4.E9.m1.1.1.1.1.1.1.4.3.cmml">u</mi></msub><mo id="Sx4.E9.m1.1.1.1.1.1.1.1b" xref="Sx4.E9.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Sx4.E9.m1.1.1.1.1.1.1.5" xref="Sx4.E9.m1.1.1.1.1.1.1.5.cmml"><mo id="Sx4.E9.m1.1.1.1.1.1.1.5.1" xref="Sx4.E9.m1.1.1.1.1.1.1.5.1.cmml">⋂</mo><mrow id="Sx4.E9.m1.1.1.1.1.1.1.5.2" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.cmml"><mi id="Sx4.E9.m1.1.1.1.1.1.1.5.2.2" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.2.cmml">R</mi><mo id="Sx4.E9.m1.1.1.1.1.1.1.5.2.1" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.1.cmml">⁢</mo><mi id="Sx4.E9.m1.1.1.1.1.1.1.5.2.3" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.3.cmml">e</mi><mo id="Sx4.E9.m1.1.1.1.1.1.1.5.2.1a" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.1.cmml">⁢</mo><msub id="Sx4.E9.m1.1.1.1.1.1.1.5.2.4" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.4.cmml"><mi id="Sx4.E9.m1.1.1.1.1.1.1.5.2.4.2" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.4.2.cmml">c</mi><mi id="Sx4.E9.m1.1.1.1.1.1.1.5.2.4.3" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.4.3.cmml">u</mi></msub></mrow></mrow></mrow><mo id="Sx4.E9.m1.1.1.1.1.1.3" xref="Sx4.E9.m1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mrow id="Sx4.E9.m1.2.2.2" xref="Sx4.E9.m1.2.2.2.cmml"><msub id="Sx4.E9.m1.2.2.2.2" xref="Sx4.E9.m1.2.2.2.2.cmml"><mo id="Sx4.E9.m1.2.2.2.2.2" xref="Sx4.E9.m1.2.2.2.2.2.cmml">∑</mo><mrow id="Sx4.E9.m1.2.2.2.2.3" xref="Sx4.E9.m1.2.2.2.2.3.cmml"><mi id="Sx4.E9.m1.2.2.2.2.3.2" xref="Sx4.E9.m1.2.2.2.2.3.2.cmml">u</mi><mo id="Sx4.E9.m1.2.2.2.2.3.1" xref="Sx4.E9.m1.2.2.2.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Sx4.E9.m1.2.2.2.2.3.3" xref="Sx4.E9.m1.2.2.2.2.3.3.cmml">𝒰</mi></mrow></msub><mrow id="Sx4.E9.m1.2.2.2.1.1" xref="Sx4.E9.m1.2.2.2.1.2.cmml"><mo id="Sx4.E9.m1.2.2.2.1.1.2" lspace="0em" xref="Sx4.E9.m1.2.2.2.1.2.1.cmml">|</mo><mrow id="Sx4.E9.m1.2.2.2.1.1.1" xref="Sx4.E9.m1.2.2.2.1.1.1.cmml"><mi id="Sx4.E9.m1.2.2.2.1.1.1.2" xref="Sx4.E9.m1.2.2.2.1.1.1.2.cmml">R</mi><mo id="Sx4.E9.m1.2.2.2.1.1.1.1" xref="Sx4.E9.m1.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="Sx4.E9.m1.2.2.2.1.1.1.3" xref="Sx4.E9.m1.2.2.2.1.1.1.3.cmml">e</mi><mo id="Sx4.E9.m1.2.2.2.1.1.1.1a" xref="Sx4.E9.m1.2.2.2.1.1.1.1.cmml">⁢</mo><msub id="Sx4.E9.m1.2.2.2.1.1.1.4" xref="Sx4.E9.m1.2.2.2.1.1.1.4.cmml"><mi id="Sx4.E9.m1.2.2.2.1.1.1.4.2" xref="Sx4.E9.m1.2.2.2.1.1.1.4.2.cmml">l</mi><mi id="Sx4.E9.m1.2.2.2.1.1.1.4.3" xref="Sx4.E9.m1.2.2.2.1.1.1.4.3.cmml">u</mi></msub></mrow><mo id="Sx4.E9.m1.2.2.2.1.1.3" xref="Sx4.E9.m1.2.2.2.1.2.1.cmml">|</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E9.m1.2b"><apply id="Sx4.E9.m1.2.3.cmml" xref="Sx4.E9.m1.2.3"><eq id="Sx4.E9.m1.2.3.1.cmml" xref="Sx4.E9.m1.2.3.1"></eq><apply id="Sx4.E9.m1.2.3.2.cmml" xref="Sx4.E9.m1.2.3.2"><times id="Sx4.E9.m1.2.3.2.1.cmml" xref="Sx4.E9.m1.2.3.2.1"></times><ci id="Sx4.E9.m1.2.3.2.2.cmml" xref="Sx4.E9.m1.2.3.2.2">𝑅</ci><ci id="Sx4.E9.m1.2.3.2.3.cmml" xref="Sx4.E9.m1.2.3.2.3">𝑒</ci><ci id="Sx4.E9.m1.2.3.2.4.cmml" xref="Sx4.E9.m1.2.3.2.4">𝑐</ci><ci id="Sx4.E9.m1.2.3.2.5.cmml" xref="Sx4.E9.m1.2.3.2.5">𝑎</ci><ci id="Sx4.E9.m1.2.3.2.6.cmml" xref="Sx4.E9.m1.2.3.2.6">𝑙</ci><apply id="Sx4.E9.m1.2.3.2.7.cmml" xref="Sx4.E9.m1.2.3.2.7"><csymbol cd="ambiguous" id="Sx4.E9.m1.2.3.2.7.1.cmml" xref="Sx4.E9.m1.2.3.2.7">subscript</csymbol><ci id="Sx4.E9.m1.2.3.2.7.2.cmml" xref="Sx4.E9.m1.2.3.2.7.2">𝑙</ci><ci id="Sx4.E9.m1.2.3.2.7.3.cmml" xref="Sx4.E9.m1.2.3.2.7.3">𝑘</ci></apply></apply><apply id="Sx4.E9.m1.2.2.cmml" xref="Sx4.E9.m1.2.2"><divide id="Sx4.E9.m1.2.2.3.cmml" xref="Sx4.E9.m1.2.2"></divide><apply id="Sx4.E9.m1.1.1.1.cmml" xref="Sx4.E9.m1.1.1.1"><apply id="Sx4.E9.m1.1.1.1.2.cmml" xref="Sx4.E9.m1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.E9.m1.1.1.1.2.1.cmml" xref="Sx4.E9.m1.1.1.1.2">subscript</csymbol><sum id="Sx4.E9.m1.1.1.1.2.2.cmml" xref="Sx4.E9.m1.1.1.1.2.2"></sum><apply id="Sx4.E9.m1.1.1.1.2.3.cmml" xref="Sx4.E9.m1.1.1.1.2.3"><in id="Sx4.E9.m1.1.1.1.2.3.1.cmml" xref="Sx4.E9.m1.1.1.1.2.3.1"></in><ci id="Sx4.E9.m1.1.1.1.2.3.2.cmml" xref="Sx4.E9.m1.1.1.1.2.3.2">𝑢</ci><ci id="Sx4.E9.m1.1.1.1.2.3.3.cmml" xref="Sx4.E9.m1.1.1.1.2.3.3">𝒰</ci></apply></apply><apply id="Sx4.E9.m1.1.1.1.1.2.cmml" xref="Sx4.E9.m1.1.1.1.1.1"><abs id="Sx4.E9.m1.1.1.1.1.2.1.cmml" xref="Sx4.E9.m1.1.1.1.1.1.2"></abs><apply id="Sx4.E9.m1.1.1.1.1.1.1.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1"><times id="Sx4.E9.m1.1.1.1.1.1.1.1.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.1"></times><ci id="Sx4.E9.m1.1.1.1.1.1.1.2.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.2">𝑅</ci><ci id="Sx4.E9.m1.1.1.1.1.1.1.3.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.3">𝑒</ci><apply id="Sx4.E9.m1.1.1.1.1.1.1.4.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx4.E9.m1.1.1.1.1.1.1.4.1.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="Sx4.E9.m1.1.1.1.1.1.1.4.2.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.4.2">𝑙</ci><ci id="Sx4.E9.m1.1.1.1.1.1.1.4.3.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.4.3">𝑢</ci></apply><apply id="Sx4.E9.m1.1.1.1.1.1.1.5.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.5"><intersect id="Sx4.E9.m1.1.1.1.1.1.1.5.1.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.5.1"></intersect><apply id="Sx4.E9.m1.1.1.1.1.1.1.5.2.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2"><times id="Sx4.E9.m1.1.1.1.1.1.1.5.2.1.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.1"></times><ci id="Sx4.E9.m1.1.1.1.1.1.1.5.2.2.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.2">𝑅</ci><ci id="Sx4.E9.m1.1.1.1.1.1.1.5.2.3.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.3">𝑒</ci><apply id="Sx4.E9.m1.1.1.1.1.1.1.5.2.4.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.4"><csymbol cd="ambiguous" id="Sx4.E9.m1.1.1.1.1.1.1.5.2.4.1.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.4">subscript</csymbol><ci id="Sx4.E9.m1.1.1.1.1.1.1.5.2.4.2.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.4.2">𝑐</ci><ci id="Sx4.E9.m1.1.1.1.1.1.1.5.2.4.3.cmml" xref="Sx4.E9.m1.1.1.1.1.1.1.5.2.4.3">𝑢</ci></apply></apply></apply></apply></apply></apply><apply id="Sx4.E9.m1.2.2.2.cmml" xref="Sx4.E9.m1.2.2.2"><apply id="Sx4.E9.m1.2.2.2.2.cmml" xref="Sx4.E9.m1.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.E9.m1.2.2.2.2.1.cmml" xref="Sx4.E9.m1.2.2.2.2">subscript</csymbol><sum id="Sx4.E9.m1.2.2.2.2.2.cmml" xref="Sx4.E9.m1.2.2.2.2.2"></sum><apply id="Sx4.E9.m1.2.2.2.2.3.cmml" xref="Sx4.E9.m1.2.2.2.2.3"><in id="Sx4.E9.m1.2.2.2.2.3.1.cmml" xref="Sx4.E9.m1.2.2.2.2.3.1"></in><ci id="Sx4.E9.m1.2.2.2.2.3.2.cmml" xref="Sx4.E9.m1.2.2.2.2.3.2">𝑢</ci><ci id="Sx4.E9.m1.2.2.2.2.3.3.cmml" xref="Sx4.E9.m1.2.2.2.2.3.3">𝒰</ci></apply></apply><apply id="Sx4.E9.m1.2.2.2.1.2.cmml" xref="Sx4.E9.m1.2.2.2.1.1"><abs id="Sx4.E9.m1.2.2.2.1.2.1.cmml" xref="Sx4.E9.m1.2.2.2.1.1.2"></abs><apply id="Sx4.E9.m1.2.2.2.1.1.1.cmml" xref="Sx4.E9.m1.2.2.2.1.1.1"><times id="Sx4.E9.m1.2.2.2.1.1.1.1.cmml" xref="Sx4.E9.m1.2.2.2.1.1.1.1"></times><ci id="Sx4.E9.m1.2.2.2.1.1.1.2.cmml" xref="Sx4.E9.m1.2.2.2.1.1.1.2">𝑅</ci><ci id="Sx4.E9.m1.2.2.2.1.1.1.3.cmml" xref="Sx4.E9.m1.2.2.2.1.1.1.3">𝑒</ci><apply id="Sx4.E9.m1.2.2.2.1.1.1.4.cmml" xref="Sx4.E9.m1.2.2.2.1.1.1.4"><csymbol cd="ambiguous" id="Sx4.E9.m1.2.2.2.1.1.1.4.1.cmml" xref="Sx4.E9.m1.2.2.2.1.1.1.4">subscript</csymbol><ci id="Sx4.E9.m1.2.2.2.1.1.1.4.2.cmml" xref="Sx4.E9.m1.2.2.2.1.1.1.4.2">𝑙</ci><ci id="Sx4.E9.m1.2.2.2.1.1.1.4.3.cmml" xref="Sx4.E9.m1.2.2.2.1.1.1.4.3">𝑢</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E9.m1.2c">Recall_{k}=\frac{{\textstyle\sum_{u\in\mathcal{U}}}\left|Rel_{u}\bigcap Rec_{u%
}\right|}{{\textstyle\sum_{u\in\mathcal{U}}}\left|Rel_{u}\right|}</annotation><annotation encoding="application/x-llamapun" id="Sx4.E9.m1.2d">italic_R italic_e italic_c italic_a italic_l italic_l start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = divide start_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ caligraphic_U end_POSTSUBSCRIPT | italic_R italic_e italic_l start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ⋂ italic_R italic_e italic_c start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ caligraphic_U end_POSTSUBSCRIPT | italic_R italic_e italic_l start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT | end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx4.I5.i2.p1.4">where <math alttext="Rel_{u}" class="ltx_Math" display="inline" id="Sx4.I5.i2.p1.1.m1.1"><semantics id="Sx4.I5.i2.p1.1.m1.1a"><mrow id="Sx4.I5.i2.p1.1.m1.1.1" xref="Sx4.I5.i2.p1.1.m1.1.1.cmml"><mi id="Sx4.I5.i2.p1.1.m1.1.1.2" xref="Sx4.I5.i2.p1.1.m1.1.1.2.cmml">R</mi><mo id="Sx4.I5.i2.p1.1.m1.1.1.1" xref="Sx4.I5.i2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="Sx4.I5.i2.p1.1.m1.1.1.3" xref="Sx4.I5.i2.p1.1.m1.1.1.3.cmml">e</mi><mo id="Sx4.I5.i2.p1.1.m1.1.1.1a" xref="Sx4.I5.i2.p1.1.m1.1.1.1.cmml">⁢</mo><msub id="Sx4.I5.i2.p1.1.m1.1.1.4" xref="Sx4.I5.i2.p1.1.m1.1.1.4.cmml"><mi id="Sx4.I5.i2.p1.1.m1.1.1.4.2" xref="Sx4.I5.i2.p1.1.m1.1.1.4.2.cmml">l</mi><mi id="Sx4.I5.i2.p1.1.m1.1.1.4.3" xref="Sx4.I5.i2.p1.1.m1.1.1.4.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx4.I5.i2.p1.1.m1.1b"><apply id="Sx4.I5.i2.p1.1.m1.1.1.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1"><times id="Sx4.I5.i2.p1.1.m1.1.1.1.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1.1"></times><ci id="Sx4.I5.i2.p1.1.m1.1.1.2.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1.2">𝑅</ci><ci id="Sx4.I5.i2.p1.1.m1.1.1.3.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1.3">𝑒</ci><apply id="Sx4.I5.i2.p1.1.m1.1.1.4.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="Sx4.I5.i2.p1.1.m1.1.1.4.1.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1.4">subscript</csymbol><ci id="Sx4.I5.i2.p1.1.m1.1.1.4.2.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1.4.2">𝑙</ci><ci id="Sx4.I5.i2.p1.1.m1.1.1.4.3.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1.4.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i2.p1.1.m1.1c">Rel_{u}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I5.i2.p1.1.m1.1d">italic_R italic_e italic_l start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the set of relevant items for user <math alttext="u" class="ltx_Math" display="inline" id="Sx4.I5.i2.p1.2.m2.1"><semantics id="Sx4.I5.i2.p1.2.m2.1a"><mi id="Sx4.I5.i2.p1.2.m2.1.1" xref="Sx4.I5.i2.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="Sx4.I5.i2.p1.2.m2.1b"><ci id="Sx4.I5.i2.p1.2.m2.1.1.cmml" xref="Sx4.I5.i2.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i2.p1.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="Sx4.I5.i2.p1.2.m2.1d">italic_u</annotation></semantics></math>,and <math alttext="Rec_{u}" class="ltx_Math" display="inline" id="Sx4.I5.i2.p1.3.m3.1"><semantics id="Sx4.I5.i2.p1.3.m3.1a"><mrow id="Sx4.I5.i2.p1.3.m3.1.1" xref="Sx4.I5.i2.p1.3.m3.1.1.cmml"><mi id="Sx4.I5.i2.p1.3.m3.1.1.2" xref="Sx4.I5.i2.p1.3.m3.1.1.2.cmml">R</mi><mo id="Sx4.I5.i2.p1.3.m3.1.1.1" xref="Sx4.I5.i2.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="Sx4.I5.i2.p1.3.m3.1.1.3" xref="Sx4.I5.i2.p1.3.m3.1.1.3.cmml">e</mi><mo id="Sx4.I5.i2.p1.3.m3.1.1.1a" xref="Sx4.I5.i2.p1.3.m3.1.1.1.cmml">⁢</mo><msub id="Sx4.I5.i2.p1.3.m3.1.1.4" xref="Sx4.I5.i2.p1.3.m3.1.1.4.cmml"><mi id="Sx4.I5.i2.p1.3.m3.1.1.4.2" xref="Sx4.I5.i2.p1.3.m3.1.1.4.2.cmml">c</mi><mi id="Sx4.I5.i2.p1.3.m3.1.1.4.3" xref="Sx4.I5.i2.p1.3.m3.1.1.4.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx4.I5.i2.p1.3.m3.1b"><apply id="Sx4.I5.i2.p1.3.m3.1.1.cmml" xref="Sx4.I5.i2.p1.3.m3.1.1"><times id="Sx4.I5.i2.p1.3.m3.1.1.1.cmml" xref="Sx4.I5.i2.p1.3.m3.1.1.1"></times><ci id="Sx4.I5.i2.p1.3.m3.1.1.2.cmml" xref="Sx4.I5.i2.p1.3.m3.1.1.2">𝑅</ci><ci id="Sx4.I5.i2.p1.3.m3.1.1.3.cmml" xref="Sx4.I5.i2.p1.3.m3.1.1.3">𝑒</ci><apply id="Sx4.I5.i2.p1.3.m3.1.1.4.cmml" xref="Sx4.I5.i2.p1.3.m3.1.1.4"><csymbol cd="ambiguous" id="Sx4.I5.i2.p1.3.m3.1.1.4.1.cmml" xref="Sx4.I5.i2.p1.3.m3.1.1.4">subscript</csymbol><ci id="Sx4.I5.i2.p1.3.m3.1.1.4.2.cmml" xref="Sx4.I5.i2.p1.3.m3.1.1.4.2">𝑐</ci><ci id="Sx4.I5.i2.p1.3.m3.1.1.4.3.cmml" xref="Sx4.I5.i2.p1.3.m3.1.1.4.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i2.p1.3.m3.1c">Rec_{u}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I5.i2.p1.3.m3.1d">italic_R italic_e italic_c start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the set of items recommended to user <math alttext="u" class="ltx_Math" display="inline" id="Sx4.I5.i2.p1.4.m4.1"><semantics id="Sx4.I5.i2.p1.4.m4.1a"><mi id="Sx4.I5.i2.p1.4.m4.1.1" xref="Sx4.I5.i2.p1.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="Sx4.I5.i2.p1.4.m4.1b"><ci id="Sx4.I5.i2.p1.4.m4.1.1.cmml" xref="Sx4.I5.i2.p1.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i2.p1.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="Sx4.I5.i2.p1.4.m4.1d">italic_u</annotation></semantics></math> within the top K positions.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="Sx4.SSx4.p3.1">The Mamba model processes the user’s interaction history sequentially, making it easier to prioritize and recommend items that the user is most interested in. This results in strong performance on the NDCG metric. However, it tends to perform relatively poorly on the Recall metric. In contrast, the Transformer’s global attention mechanism is better at capturing various types of global dependencies between different positions, leading to a more comprehensive generation of the recommendation set.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx4.SSx5">
<h3 class="ltx_title ltx_title_subsection">Ablation Study</h3>
<div class="ltx_para" id="Sx4.SSx5.p1">
<p class="ltx_p" id="Sx4.SSx5.p1.1">In the ablation study, we tested several key modules and analyzed the impact of the number of model layers and the number of heads in the multi-head attention mechanism on the model’s performance.</p>
<ul class="ltx_itemize" id="Sx4.I6">
<li class="ltx_item" id="Sx4.I6.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I6.i1.p1">
<p class="ltx_p" id="Sx4.I6.i1.p1.1">Add PE (Adding Positional Encoding): Typically, positional encoding is required in Transformer-based sequence recommendation modeling to capture the positional information of elements in the sequence. However, in our model, the data first passes through the Mamba block, which inherently captures the necessary positional information due to its sequential nature. Therefore, adding positional encoding introduces unnecessary noise, leading to a decline in model performance. This indicates that the Mamba block already sufficiently captures the sequence’s positional information without the need for additional positional encoding.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I6.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I6.i2.p1">
<p class="ltx_p" id="Sx4.I6.i2.p1.1">Remove FFN (Removing Feed-Forward Network): Removing the feed-forward network from the model results in a significant decrease in performance. The feed-forward network is responsible for enhancing the non-linear representation of features. Its removal prevents the model from effectively learning more complex feature representations, thus limiting the model’s overall capability. The feed-forward network is crucial for capturing complex relationships within the data and is a key component for efficient feature representation.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I6.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I6.i3.p1">
<p class="ltx_p" id="Sx4.I6.i3.p1.1">Remove RC (Removing Residual Connections): After removing residual connections from the model, the performance in sequence recommendation tasks declines noticeably. Residual connections help reduce information loss during transmission and promote training stability. Their removal hampers the model’s ability to learn and optimize effectively. Residual connections ensure better gradient flow through direct paths, making deep networks more trainable.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I6.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I6.i4.p1">
<p class="ltx_p" id="Sx4.I6.i4.p1.1">Remove Dropout (Removing Dropout): The removal of Dropout from the model leads to a notable reduction in performance in sequence recommendation tasks. Dropout helps mitigate overfitting during training and improves the model’s generalization ability. By randomly omitting certain neurons, Dropout increases the robustness and generalization of the model.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I6.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I6.i5.p1">
<p class="ltx_p" id="Sx4.I6.i5.p1.1">Number of Layers and Attention Heads: Increasing the number of model layers improved performance on the long interaction sequence dataset ML-1M, but did not significantly affect the results on the other four short interaction sequence datasets. This suggests that adding more layers helps the model better capture the complex dependencies and features in long sequences. In long sequence data, user behavior patterns and preferences are more complex, and additional layers enable the model to more deeply extract these long-term dependencies, thus enhancing performance. However, for short sequence datasets, due to the limited information in user behavior, increasing layers did not significantly improve the model’s performance and also required more computational resources. Additionally, increasing the number of attention heads did not result in significant performance gains. This may be because the model, with its current configuration of layers and heads, is already effectively capturing enough feature relationships, and further increasing the number of heads did not provide additional performance benefits.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="Sx4.SSx6">
<h3 class="ltx_title ltx_title_subsection">Impact of Dropout Parameter on Model Performance</h3>
<div class="ltx_para" id="Sx4.SSx6.p1">
<p class="ltx_p" id="Sx4.SSx6.p1.1">We analyzed the changes in the metrics Recall@10 and NDCG@10 of the model under different Dropout parameters across five datasets. Dropout refers to the intentional random dropping of some neurons during training to prevent the model from overfitting. If the Dropout rate is set too low, the model might overly rely on the details in the training data, making it difficult to generalize to unseen data. Conversely, if the Dropout rate is set too high, the model might struggle with learning from the limited information available, making it difficult to predict the large amount of dropped data, thereby complicating the training process.</p>
</div>
<div class="ltx_para" id="Sx4.SSx6.p2">
<p class="ltx_p" id="Sx4.SSx6.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.F2" title="Figure 2 ‣ Overall Performance ‣ Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> shows the results of varying the Dropout rate from 0.1 to 0.5. As shown in the figure, the model’s performance varies with different Dropout parameters across different datasets. In the ML-1M dataset, which features long interaction sequences with extensive user-item interactions, the model performs best with Dropout=0.1. This may be because the abundant information in long interaction sequences allows a lower Dropout rate to sufficiently prevent overfitting while retaining enough training data to capture complex patterns.In contrast, for the short interaction sequence datasets—Musical, Health, Electronics, and Office—where user-item interactions are relatively sparse, a Dropout rate around 0.4 yields the best performance. An intermediate Dropout rate helps the model learn effective patterns from limited interaction data while preventing overfitting.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx4.SSx7">
<h3 class="ltx_title ltx_title_subsection">Impact of Maximum Sequence Length N on Model Performance</h3>
<div class="ltx_para" id="Sx4.SSx7.p1">
<p class="ltx_p" id="Sx4.SSx7.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.F3" title="Figure 3 ‣ Impact of Maximum Sequence Length N on Model Performance ‣ Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the impact of different maximum sequence lengths (N) on model performance across the Musical, Health, Electronics, and Office datasets. The results indicate that the maximum sequence length (N) significantly affects the model’s performance. When the maximum sequence length (N) is set too low, the model cannot fully capture the information in the sequences, leading to suboptimal performance. Conversely, if N is too large, it introduces more noise, making it difficult for the model to distinguish between useful and irrelevant information, thereby affecting performance. Therefore, selecting an optimal N value is crucial to balance between fully learning the data features and avoiding noise introduction.</p>
</div>
<div class="ltx_para" id="Sx4.SSx7.p2">
<p class="ltx_p" id="Sx4.SSx7.p2.1">We observed that the performance on these short interaction datasets peaks around N=50. This suggests that N=50 is an optimal balance point that captures sufficient useful information without introducing excessive noise. However, when N continues to increase beyond this point, model performance declines. This decline is due to the increased noise in short interaction sequences, which interferes with the model’s ability to learn valuable information. Additionally, as N increases, the computational resources required by the model also rise.</p>
</div>
<div class="ltx_para" id="Sx4.SSx7.p3">
<p class="ltx_p" id="Sx4.SSx7.p3.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.T4" title="Table 4 ‣ Impact of Maximum Sequence Length N on Model Performance ‣ Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> shows the GPU memory and training time required by the model at different maximum sequence lengths (N) across these datasets. As seen in the table, both GPU memory and training time significantly increase with larger N values. This underscores the importance of considering not only model performance but also computational resource consumption when selecting the maximum sequence length (N).</p>
</div>
<figure class="ltx_figure" id="Sx4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="415" id="Sx4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The effect of Maximum Sequence Length N on a model’s Recall@10 and NDCG@10 performance.</figcaption>
</figure>
<figure class="ltx_table" id="Sx4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Impact of Different Maximum Sequence Lengths (N) on GPU Memory and Training Time Requirements</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx4.T4.1" style="width:433.6pt;height:112.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(8.1pt,-2.1pt) scale(1.03857489659558,1.03857489659558) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="Sx4.T4.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="Sx4.T4.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="Sx4.T4.1.1.1.1.1" rowspan="2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text" id="Sx4.T4.1.1.1.1.1.1">N</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="4" id="Sx4.T4.1.1.1.1.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">GPU memory</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="4" id="Sx4.T4.1.1.1.1.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">Training time</th>
</tr>
<tr class="ltx_tr" id="Sx4.T4.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T4.1.1.2.2.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Musical</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T4.1.1.2.2.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">Health</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T4.1.1.2.2.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">Electronics</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="Sx4.T4.1.1.2.2.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">Office</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T4.1.1.2.2.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">Musical</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T4.1.1.2.2.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">Health</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T4.1.1.2.2.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">Electronics</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T4.1.1.2.2.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">Office</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="Sx4.T4.1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="Sx4.T4.1.1.3.1.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T4.1.1.3.1.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.30 G</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T4.1.1.3.1.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.94 G</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T4.1.1.3.1.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.04 G</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T4.1.1.3.1.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.45 G</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T4.1.1.3.1.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.08s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T4.1.1.3.1.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.71s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T4.1.1.3.1.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">21.86s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T4.1.1.3.1.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.56s</td>
</tr>
<tr class="ltx_tr" id="Sx4.T4.1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="Sx4.T4.1.1.4.2.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">30</th>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.4.2.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.71 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.4.2.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.27 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.4.2.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.37 G</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T4.1.1.4.2.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.00 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.4.2.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.11s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.4.2.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.18s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.4.2.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">29.11s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.4.2.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.81 s</td>
</tr>
<tr class="ltx_tr" id="Sx4.T4.1.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="Sx4.T4.1.1.5.3.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">50</th>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.5.3.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.05 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.5.3.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.02 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.5.3.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.73 G</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T4.1.1.5.3.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.61 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.5.3.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.13s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.5.3.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.48s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.5.3.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">35.23s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T4.1.1.5.3.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.02s</td>
</tr>
<tr class="ltx_tr" id="Sx4.T4.1.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="Sx4.T4.1.1.6.4.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">70</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T4.1.1.6.4.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.42 G</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T4.1.1.6.4.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.52 G</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T4.1.1.6.4.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">7.10 G</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx4.T4.1.1.6.4.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.37 G</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T4.1.1.6.4.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.17s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T4.1.1.6.4.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">8.00s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T4.1.1.6.4.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">42.69s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T4.1.1.6.4.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.28s</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="Sx4.SSx8">
<h3 class="ltx_title ltx_title_subsection">Model Complexity</h3>
<div class="ltx_para" id="Sx4.SSx8.p1">
<p class="ltx_p" id="Sx4.SSx8.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19239v1#Sx4.T5" title="Table 5 ‣ Model Complexity ‣ Experiments ‣ MaTrRec: Uniting Mamba and Transformer for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a> provides detailed records of GPU memory usage, training time, and inference time for each model across five datasets. All experiments were conducted using the open-source RecBole framework to evaluate benchmark models. Each model’s hidden dimension was set to 64, with a training batch size of 2048 and an evaluation batch size of 4096, utilizing the standard Adam optimizer for training. These experiments were all carried out on Alibaba Cloud’s Nvidia V100 GPU.</p>
</div>
<figure class="ltx_table" id="Sx4.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>GPU Memory, Training Time, and Inference Time of Models Across Five Datasets</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx4.T5.1" style="width:505.9pt;height:133.1pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-125.4pt,32.8pt) scale(0.66852701735607,0.66852701735607) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="Sx4.T5.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="Sx4.T5.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="Sx4.T5.1.1.1.1.1" rowspan="2" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span class="ltx_text" id="Sx4.T5.1.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="5" id="Sx4.T5.1.1.1.1.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">GPU memory (GB)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="5" id="Sx4.T5.1.1.1.1.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">Training time (min)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="5" id="Sx4.T5.1.1.1.1.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">Inference time (sec)</th>
</tr>
<tr class="ltx_tr" id="Sx4.T5.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">ML-1m</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">Musical</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">Health</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">Electronics</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="Sx4.T5.1.1.2.2.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">Office</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">ML-1m</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">Musical</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">Health</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">Electronics</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="Sx4.T5.1.1.2.2.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">Office</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">ML-1m</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">Musical</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">Health</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.14" style="padding-top:2.5pt;padding-bottom:2.5pt;">Electronics</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="Sx4.T5.1.1.2.2.15" style="padding-top:2.5pt;padding-bottom:2.5pt;">Office</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="Sx4.T5.1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="Sx4.T5.1.1.3.1.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">GRU4Rec</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">7.32 G</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.08 G</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.34 G</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">7.28 G</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T5.1.1.3.1.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.87 G</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">15.89s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.04s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.07s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">14.38s</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T5.1.1.3.1.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.27s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.06s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.01s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.14" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.35s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.15" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.53s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T5.1.1.3.1.16" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.04s</td>
</tr>
<tr class="ltx_tr" id="Sx4.T5.1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="Sx4.T5.1.1.4.2.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">NARM</th>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">7.32 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.08 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.04 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">7.26 G</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.4.2.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.88 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">18.67s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.05s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.43s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">16.36s</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.4.2.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.34s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.06s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.01s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.14" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.32s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.15" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.31s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.4.2.16" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.04s</td>
</tr>
<tr class="ltx_tr" id="Sx4.T5.1.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="Sx4.T5.1.1.5.3.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">SASRec</th>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">10.94 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.27 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.38 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.33 G</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.5.3.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.05 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">53.90s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.11s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.49s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">26.55s</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.5.3.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.71s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.14s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.02s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.14" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.42s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.15" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.87s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.5.3.16" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.05s</td>
</tr>
<tr class="ltx_tr" id="Sx4.T5.1.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="Sx4.T5.1.1.6.4.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">NextItNet</th>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">8.19 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.93 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.69 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">7.38 G</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.6.4.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.13 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">490.71s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.85s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.30s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">160.33s</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.6.4.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.36s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.51s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.04s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.14" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.07s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.15" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.10s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.6.4.16" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.13s</td>
</tr>
<tr class="ltx_tr" id="Sx4.T5.1.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="Sx4.T5.1.1.7.5.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">BERT4Rec</th>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">8.04 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.38 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.48 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">16.54 G</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.7.5.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.26 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">161.23s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.21s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">14.63s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">178.36s</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.7.5.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.71s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.65s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.08s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.14" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.57s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.15" style="padding-top:2.5pt;padding-bottom:2.5pt;">10.83s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.7.5.16" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.28s</td>
</tr>
<tr class="ltx_tr" id="Sx4.T5.1.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="Sx4.T5.1.1.8.6.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">SINE</th>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.84 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.71 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.81 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.05 G</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.8.6.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.20 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">27.03s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.10s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.97s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">24.14s</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.8.6.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.61s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.07s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.01s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.14" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.34s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.15" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.36s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.8.6.16" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.04s</td>
</tr>
<tr class="ltx_tr" id="Sx4.T5.1.1.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="Sx4.T5.1.1.9.7.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">CORE</th>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">10.96 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.29 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.91 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">8.25 G</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.9.7.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.08 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">55.81s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.12s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.05s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">30.59s</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.9.7.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.77s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.14s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.02s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.14" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.47s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.15" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.91s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.9.7.16" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.06s</td>
</tr>
<tr class="ltx_tr" id="Sx4.T5.1.1.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="Sx4.T5.1.1.10.8.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">Mamba4Rec</th>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">4.81 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.88 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">2.88 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.59 G</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.10.8.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.40 G</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">72.20s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.12s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">5.79s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.00s</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T5.1.1.10.8.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.91s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.18s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.05s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.14" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.53s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.15" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.35s</td>
<td class="ltx_td ltx_align_center" id="Sx4.T5.1.1.10.8.16" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.08s</td>
</tr>
<tr class="ltx_tr" id="Sx4.T5.1.1.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="Sx4.T5.1.1.11.9.1" style="padding-top:2.5pt;padding-bottom:2.5pt;">MaTrRec</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.2" style="padding-top:2.5pt;padding-bottom:2.5pt;">7.73 G</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.3" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.05 G</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.4" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.02 G</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.5" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.73 G</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx4.T5.1.1.11.9.6" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.61 G</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.7" style="padding-top:2.5pt;padding-bottom:2.5pt;">88.24s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.8" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.13s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.9" style="padding-top:2.5pt;padding-bottom:2.5pt;">6.48s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.10" style="padding-top:2.5pt;padding-bottom:2.5pt;">35.23s</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="Sx4.T5.1.1.11.9.11" style="padding-top:2.5pt;padding-bottom:2.5pt;">1.02s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.12" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.23s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.13" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.05s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.14" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.55s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.15" style="padding-top:2.5pt;padding-bottom:2.5pt;">3.46s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T5.1.1.11.9.16" style="padding-top:2.5pt;padding-bottom:2.5pt;">0.09s</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_section" id="Sx5">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>
<div class="ltx_para" id="Sx5.p1">
<p class="ltx_p" id="Sx5.p1.1">This paper is based on the Mamba and Transformer, integrating Mamba’s advantages in long interaction sequences and Transformer’s multi-head attention mechanism for more comprehensive information capture in short interaction sequences. We conducted extensive experiments on three publicly available real-world datasets, and the results show that our model, MaTrRec, outperforms the state-of-the-art benchmark models on both long and short interaction sequence datasets. Additionally, through ablation experiments, we analyzed the impact of each module on model performance in detail, validating the effectiveness of these modules.</p>
</div>
<div class="ltx_para" id="Sx5.p2">
<p class="ltx_p" id="Sx5.p2.1">In summary, MaTrRec successfully combines the respective advantages of the Mamba and Transformer frameworks, effectively addressing the sequence recommendation problem. Future research can focus on further optimizing the model structure by integrating information such as time and type, incorporating richer contextual information to further enhance the model’s performance and applicability.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019)</span>
<span class="ltx_bibblock">
Devlin, J.; Chang, M.-W.; Lee, K.; and Toutanova, K. 2019.

</span>
<span class="ltx_bibblock">BERT: Pre-training of Deep Bidirectional Transformers for Language
Understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">North American Chapter of the Association for Computational
Linguistics</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Donkers, Loepp, and Ziegler (2017)</span>
<span class="ltx_bibblock">
Donkers, T.; Loepp, B.; and Ziegler, J. 2017.

</span>
<span class="ltx_bibblock">Sequential User-based Recurrent Neural Network Recommendations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the Eleventh ACM Conference on Recommender
Systems</em>, RecSys ’17, 152–160. New York, NY, USA: Association for Computing
Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450346528.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2020)</span>
<span class="ltx_bibblock">
Dosovitskiy, A.; Beyer, L.; Kolesnikov, A.; Weissenborn, D.; Zhai, X.;
Unterthiner, T.; Dehghani, M.; Minderer, M.; Heigold, G.; Gelly, S.;
Uszkoreit, J.; and Houlsby, N. 2020.

</span>
<span class="ltx_bibblock">An Image is Worth 16x16 Words: Transformers for Image Recognition at
Scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">ArXiv</em>, abs/2010.11929.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu and Dao (2023)</span>
<span class="ltx_bibblock">
Gu, A.; and Dao, T. 2023.

</span>
<span class="ltx_bibblock">Mamba: Linear-Time Sequence Modeling with Selective State Spaces.

</span>
<span class="ltx_bibblock">arXiv:2312.00752.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu, Goel, and R’e (2021)</span>
<span class="ltx_bibblock">
Gu, A.; Goel, K.; and R’e, C. 2021.

</span>
<span class="ltx_bibblock">Efficiently Modeling Long Sequences with Structured State Spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">ArXiv</em>, abs/2111.00396.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harper and Konstan (2015)</span>
<span class="ltx_bibblock">
Harper, F. M.; and Konstan, J. A. 2015.

</span>
<span class="ltx_bibblock">The MovieLens Datasets: History and Context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">ACM Trans. Interact. Intell. Syst.</em>, 5(4).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
He, K.; Zhang, X.; Ren, S.; and Sun, J. 2016.

</span>
<span class="ltx_bibblock">Deep Residual Learning for Image Recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">2016 IEEE Conference on Computer Vision and Pattern
Recognition (CVPR)</em>, 770–778.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and McAuley (2016)</span>
<span class="ltx_bibblock">
He, R.; and McAuley, J. 2016.

</span>
<span class="ltx_bibblock">Fusing Similarity Models with Markov Chains for Sparse Sequential
Recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">2016 IEEE 16th International Conference on Data Mining
(ICDM)</em>, 191–200.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al. (2016)</span>
<span class="ltx_bibblock">
Hidasi, B.; Karatzoglou, A.; Baltrunas, L.; and Tikk, D. 2016.

</span>
<span class="ltx_bibblock">Session-based Recommendations with Recurrent Neural Networks.

</span>
<span class="ltx_bibblock">In Bengio, Y.; and LeCun, Y., eds., <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">4th International
Conference on Learning Representations, ICLR 2016, San Juan, Puerto Rico,
May 2-4, 2016, Conference Track Proceedings</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al. (2022)</span>
<span class="ltx_bibblock">
Hou, Y.; Hu, B.; Zhang, Z.; and Zhao, W. X. 2022.

</span>
<span class="ltx_bibblock">CORE: Simple and Effective Session-based Recommendation within
Consistent Representation Space.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the 45th International ACM SIGIR Conference
on Research and Development in Information Retrieval</em>, SIGIR ’22,
1796–1801. New York, NY, USA: Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450387323.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Kang, W.-C.; and McAuley, J. 2018.

</span>
<span class="ltx_bibblock">Self-Attentive Sequential Recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">2018 IEEE International Conference on Data Mining (ICDM)</em>,
197–206.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koren, Bell, and Volinsky (2009)</span>
<span class="ltx_bibblock">
Koren, Y.; Bell, R.; and Volinsky, C. 2009.

</span>
<span class="ltx_bibblock">Matrix Factorization Techniques for Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Computer</em>, 42(8): 30–37.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2017)</span>
<span class="ltx_bibblock">
Li, J.; Ren, P.; Chen, Z.; Ren, Z.; Lian, T.; and Ma, J. 2017.

</span>
<span class="ltx_bibblock">Neural Attentive Session-based Recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the 2017 ACM on Conference on Information and
Knowledge Management</em>, CIKM ’17, 1419–1428. New York, NY, USA: Association
for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450349185.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lieber et al. (2024)</span>
<span class="ltx_bibblock">
Lieber, O.; Lenz, B.; Bata, H.; Cohen, G.; Osin, J.; Dalmedigos, I.; Safahi,
E.; Meirom, S. H.; Belinkov, Y.; Shalev-Shwartz, S.; Abend, O.; Alon, R.;
Asida, T.; Bergman, A.; Glozman, R.; Gokhman, M.; Manevich, A.; Ratner, N.;
Rozen, N.; Shwartz, E.; Zusman, M.; and Shoham, Y. 2024.

</span>
<span class="ltx_bibblock">Jamba: A Hybrid Transformer-Mamba Language Model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">ArXiv</em>, abs/2403.19887.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2023)</span>
<span class="ltx_bibblock">
Lin, J.; Qu, Y.; Guo, W.; Dai, X.; Tang, R.; Yu, Y.; and Zhang, W. 2023.

</span>
<span class="ltx_bibblock">MAP: A Model-agnostic Pretraining Framework for Click-through Rate
Prediction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge
Discovery and Data Mining</em>, KDD ’23, 1384–1395. New York, NY, USA:
Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9798400701030.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024)</span>
<span class="ltx_bibblock">
Liu, C.; Lin, J.; Wang, J.; Liu, H.; and Caverlee, J. 2024.

</span>
<span class="ltx_bibblock">Mamba4Rec: Towards Efficient Sequential Recommendation with Selective
State Space Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">ArXiv</em>, abs/2403.03900.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2015)</span>
<span class="ltx_bibblock">
Lu, J.; Wu, D.; Mao, M.; Wang, W.; and Zhang, G. 2015.

</span>
<span class="ltx_bibblock">Recommender system application developments: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Decis. Support Syst.</em>, 74: 12–32.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McAuley et al. (2015)</span>
<span class="ltx_bibblock">
McAuley, J.; Targett, C.; Shi, Q.; and van den Hengel, A. 2015.

</span>
<span class="ltx_bibblock">Image-Based Recommendations on Styles and Substitutes.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 38th International ACM SIGIR Conference
on Research and Development in Information Retrieval</em>, SIGIR ’15, 43–52.
New York, NY, USA: Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450336215.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quadrana et al. (2017)</span>
<span class="ltx_bibblock">
Quadrana, M.; Karatzoglou, A.; Hidasi, B.; and Cremonesi, P. 2017.

</span>
<span class="ltx_bibblock">Personalizing Session-based Recommendations with Hierarchical
Recurrent Neural Networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the Eleventh ACM Conference on Recommender
Systems</em>, RecSys ’17, 130–137. New York, NY, USA: Association for Computing
Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450346528.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford and Narasimhan (2018)</span>
<span class="ltx_bibblock">
Radford, A.; and Narasimhan, K. 2018.

</span>
<span class="ltx_bibblock">Improving Language Understanding by Generative Pre-Training.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2019)</span>
<span class="ltx_bibblock">
Sun, F.; Liu, J.; Wu, J.; Pei, C.; Lin, X.; Ou, W.; and Jiang, P. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential Recommendation with Bidirectional Encoder
Representations from Transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 28th ACM International Conference on
Information and Knowledge Management</em>, CIKM ’19, 1441–1450. New York, NY,
USA: Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450369763.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. (2021)</span>
<span class="ltx_bibblock">
Tan, Q.; Zhang, J.; Yao, J.; Liu, N.; Zhou, J.; Yang, H.; and Hu, X. 2021.

</span>
<span class="ltx_bibblock">Sparse-Interest Network for Sequential Recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 14th ACM International Conference on Web
Search and Data Mining</em>, WSDM ’21, 598–606. New York, NY, USA: Association
for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450382977.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Tang, J.; and Wang, K. 2018.

</span>
<span class="ltx_bibblock">Personalized Top-N Sequential Recommendation via Convolutional
Sequence Embedding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the Eleventh ACM International Conference on
Web Search and Data Mining</em>, WSDM ’18, 565–573. New York, NY, USA:
Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450355810.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Vaswani, A.; Shazeer, N.; Parmar, N.; Uszkoreit, J.; Jones, L.; Gomez, A. N.;
Kaiser, L. u.; and Polosukhin, I. 2017.

</span>
<span class="ltx_bibblock">Attention is All you Need.

</span>
<span class="ltx_bibblock">In Guyon, I.; Luxburg, U. V.; Bengio, S.; Wallach, H.; Fergus, R.;
Vishwanathan, S.; and Garnett, R., eds., <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Advances in Neural Information
Processing Systems</em>, volume 30. Curran Associates, Inc.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Wang, S.; Cao, L.; Wang, Y.; Sheng, Q. Z.; Orgun, M. A.; and Lian, D. 2021.

</span>
<span class="ltx_bibblock">A Survey on Session-based Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">ACM Comput. Surv.</em>, 54(7).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024)</span>
<span class="ltx_bibblock">
Wang, Z.; Zheng, J.-Q.; Zhang, Y.; Cui, G.; and Li, L. 2024.

</span>
<span class="ltx_bibblock">Mamba-UNet: UNet-Like Pure Visual Mamba for Medical Image
Segmentation.

</span>
<span class="ltx_bibblock">arXiv:2402.05079.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2024)</span>
<span class="ltx_bibblock">
Xu, X.; Liang, Y.; Huang, B.; Lan, Z.; and Shu, K. 2024.

</span>
<span class="ltx_bibblock">Integrating Mamba and Transformer for Long-Short Range Time Series
Forecasting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">ArXiv</em>, abs/2404.14757.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2018)</span>
<span class="ltx_bibblock">
Yao, H.; Tang, X.; Wei, H.; Zheng, G.; and Li, Z. J. 2018.

</span>
<span class="ltx_bibblock">Revisiting Spatial-Temporal Similarity: A Deep Learning Framework for
Traffic Prediction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">AAAI Conference on Artificial Intelligence</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al. (2019)</span>
<span class="ltx_bibblock">
Yuan, F.; Karatzoglou, A.; Arapakis, I.; Jose, J. M.; and He, X. 2019.

</span>
<span class="ltx_bibblock">A Simple Convolutional Generative Network for Next Item
Recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the Twelfth ACM International Conference on
Web Search and Data Mining</em>, WSDM ’19, 582–590. New York, NY, USA:
Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450359405.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2021)</span>
<span class="ltx_bibblock">
Zhao, W. X.; Mu, S.; Hou, Y.; Lin, Z.; Chen, Y.; Pan, X.; Li, K.; Lu, Y.; Wang,
H.; Tian, C.; Min, Y.; Feng, Z.; Fan, X.; Chen, X.; Wang, P.; Ji, W.; Li, Y.;
Wang, X.; and Wen, J.-R. 2021.

</span>
<span class="ltx_bibblock">RecBole: Towards a Unified, Comprehensive and Efficient Framework for
Recommendation Algorithms.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the 30th ACM International Conference on
Information &amp; Knowledge Management</em>, CIKM ’21, 4653–4664. New York, NY,
USA: Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450384469.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2024)</span>
<span class="ltx_bibblock">
Zhu, L.; Liao, B.; Zhang, Q.; Wang, X.; Liu, W.; and Wang, X. 2024.

</span>
<span class="ltx_bibblock">Vision Mamba: Efficient Visual Representation Learning with
Bidirectional State Space Model.

</span>
<span class="ltx_bibblock">arXiv:2401.09417.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Jul 27 05:29:58 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
