<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2402.09677] Prompt-based Personalized Federated Learning for Medical Visual Question Answering</title><meta property="og:description" content="We present a novel prompt-based personalized federated learning (pFL) method to address data heterogeneity and privacy concerns in traditional medical visual question answering (VQA) methods. Specifically, we regard me…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Prompt-based Personalized Federated Learning for Medical Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Prompt-based Personalized Federated Learning for Medical Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2402.09677">

<!--Generated on Tue Mar  5 17:03:50 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Prompt-based Personalized Federated Learning
<br class="ltx_break">for Medical Visual Question Answering</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p"><span id="id1.id1.1" class="ltx_text" style="font-size:90%;">We present a novel prompt-based personalized federated learning (pFL) method to address data heterogeneity and privacy concerns in traditional medical visual question answering (VQA) methods. Specifically, we regard medical datasets from different organs as clients and use pFL to train personalized transformer-based VQA models for each client. To address the high computational complexity of client-to-client communication in previous pFL methods, we propose a succinct information sharing system by introducing prompts that are small learnable parameters. In addition, the proposed method introduces a reliability parameter to prevent the negative effects of low performance and irrelevant clients. Finally, extensive evaluations on various heterogeneous medical datasets attest to the effectiveness of our proposed method.</span></p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic" style="font-size:90%;">Index Terms<span id="p1.1.1.1" class="ltx_text ltx_font_upright">— <span id="p1.1.1.1.1" class="ltx_text ltx_font_medium">
visual question answering, prompt learning, personalized federated learning, medical image.</span></span></span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p"><span id="S1.p1.1.1" class="ltx_text" style="font-size:90%;">Rising poverty levels and an increasing aging population are exacerbating the global shortage of healthcare resources. Medical AI is now seen as a pivotal solution to address these problems in the foreseeable future </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib1" title="" class="ltx_ref">1</a><span id="S1.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p1.1.4" class="ltx_text" style="font-size:90%;">.
The general tasks in medical AI, such as classification </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p1.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a><span id="S1.p1.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p1.1.7" class="ltx_text" style="font-size:90%;"> and segmentation </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p1.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S1.p1.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p1.1.10" class="ltx_text" style="font-size:90%;">, lack adaptability to rapidly changing clinical situations and often neglect patient involvement in medical diagnoses.
The recent rise of chatGPT </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p1.1.11.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib4" title="" class="ltx_ref">4</a><span id="S1.p1.1.12.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p1.1.13" class="ltx_text" style="font-size:90%;"> demonstrates capabilities that closely resemble human conversation and analytical skills, showing the potential of the language for medical applications.
As a vision-language task, medical visual question answering (VQA) </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p1.1.14.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib5" title="" class="ltx_ref">5</a><span id="S1.p1.1.15.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p1.1.16" class="ltx_text" style="font-size:90%;"> can interpret questions framed in natural language and provide accurate, user-friendly responses. This is expected to alleviate the workload on physicians by facilitating communication with patients.</span></p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p"><span id="S1.p2.1.1" class="ltx_text" style="font-size:90%;">While previous research has primarily focused on improving model accuracy </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib6" title="" class="ltx_ref">6</a><span id="S1.p2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.4" class="ltx_text" style="font-size:90%;">, two significant challenges remain in the medical domain. First, data distributions of the different patients are difficult to learn by a single model due to the heterogeneity such as feature distribution drift and label distribution skew </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S1.p2.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.7" class="ltx_text" style="font-size:90%;">. The other is that due to patient privacy concerns, the volume of data available for training remains constrained </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib8" title="" class="ltx_ref">8</a><span id="S1.p2.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.10" class="ltx_text" style="font-size:90%;">.
In the general domain, the federated learning (FL) </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.11.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib9" title="" class="ltx_ref">9</a><span id="S1.p2.1.12.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.13" class="ltx_text" style="font-size:90%;"> and the personalized federated learning (pFL) </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.14.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib10" title="" class="ltx_ref">10</a><span id="S1.p2.1.15.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p2.1.16" class="ltx_text" style="font-size:90%;"> are proposed for training personalized models separately using private data.
FL utilizes a central server to manage the global model, enabling certain clients to participate.
On the contrary, pFL has been developed to learn a customized model for each client that performs better on private data while benefiting from collaborative training.
Essentially, each pFL client model is uniquely calibrated to its respective user, and the individual clients do not communicate any data during the training process. However, due to the limitations of the previous pFL framework, it is challenging to introduce it directly into medical VQA.</span></p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p"><span id="S1.p3.1.1" class="ltx_text" style="font-size:90%;">The traditional pFL framework </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S1.p3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.4" class="ltx_text" style="font-size:90%;"> allows for information sharing by communicating the model weights of each client </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib12" title="" class="ltx_ref">12</a><span id="S1.p3.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.7" class="ltx_text" style="font-size:90%;">, which leads to many parameters requiring updates. As a result of computational limitations, pFL applications have been mostly confined to Deep Neural Networks (DNNs) that handle simpler datasets such as MNIST </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib13" title="" class="ltx_ref">13</a><span id="S1.p3.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.10" class="ltx_text" style="font-size:90%;"> and CIFAR10/100 </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.11.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib14" title="" class="ltx_ref">14</a><span id="S1.p3.1.12.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.13" class="ltx_text" style="font-size:90%;">.
However, the medical VQA task has textual information as an additional modality and typically deals with informative images. Furthermore, the transformer model </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.14.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib15" title="" class="ltx_ref">15</a><span id="S1.p3.1.15.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.16" class="ltx_text" style="font-size:90%;">, known for its state-of-the-art performance in the VQA task, inherently possesses more parameters than conventional DNNs. Although Li et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.17.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib16" title="" class="ltx_ref">16</a><span id="S1.p3.1.18.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.19" class="ltx_text" style="font-size:90%;"> proposed the personalized simple transformer with few blocks </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.20.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib15" title="" class="ltx_ref">15</a><span id="S1.p3.1.21.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.22" class="ltx_text" style="font-size:90%;">, it follows the previous consumptive parameter communication, which brings a massive consumption of computing resources. Inspired by Wang et al. </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.23.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a><span id="S1.p3.1.24.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.25" class="ltx_text" style="font-size:90%;">, we introduce prompt learning </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p3.1.26.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib19" title="" class="ltx_ref">19</a><span id="S1.p3.1.27.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S1.p3.1.28" class="ltx_text" style="font-size:90%;"> into the pFL method to reduce the number of parameters involved in client communication, which can reduce the computational complexity by replacing model weights with prompts.</span></p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text" style="font-size:90%;">In this paper, we propose prompt-based personalized federated learning for medical VQA to address the heterogeneity and privacy problem.
We establish clients for heterogeneous medical data from different organs and simultaneously train personalized VQA models for each client locally, where each model can be regarded as learning a different data distribution.
To achieve privacy protection, each client can only access its own private data during training, and information is shared among clients through model parameters.
Specifically, we introduce the prompt, a small learnable parameter with high dimensionality, as an additional input to the residual attention blocks in the transformer encoder. We only update the prompt during training so that it obtains the information in the training data.
Since a client’s prompts are accessible to other clients, we facilitate client-to-client communication by integrating the prompts to generate shared information.
Moreover, we propose a reliability parameter that determines the weight of each client in the communication process.
Our experimental findings indicate that parameter communication between clients outperforms individualized training.
Finally, we summarize our contributions of this paper as follows.</span></p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text" style="font-size:90%;">We propose a novel prompt-based pFL method for personalized medical VQA addressing the problems of the heterogeneity and privacy preservation in medical domain.</span></p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text" style="font-size:90%;">We provide a simple method to represent model information using prompts, which also reduces the computational complexity of the client-to-client communication process.</span></p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p"><span id="S1.I1.i3.p1.1.1" class="ltx_text" style="font-size:90%;">We propose a reliability parameter for controlling the weight of each client in the communication process to avoid negative effects.</span></p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">2 </span>PROMPT-BASED PERSONALIZED FEDERATED LEARNING FOR MEDICAL VQA</h2>

<figure id="S2.F1" class="ltx_figure"><img src="/html/2402.09677/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="257" height="83" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S2.F1.16.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>An overview of the proposed prompt-based pFL method. A client <math id="S2.F1.5.m1.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.F1.5.m1.1b"><msub id="S2.F1.5.m1.1.1" xref="S2.F1.5.m1.1.1.cmml"><mi id="S2.F1.5.m1.1.1.2" xref="S2.F1.5.m1.1.1.2.cmml">c</mi><mi id="S2.F1.5.m1.1.1.3" xref="S2.F1.5.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F1.5.m1.1c"><apply id="S2.F1.5.m1.1.1.cmml" xref="S2.F1.5.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.5.m1.1.1.1.cmml" xref="S2.F1.5.m1.1.1">subscript</csymbol><ci id="S2.F1.5.m1.1.1.2.cmml" xref="S2.F1.5.m1.1.1.2">𝑐</ci><ci id="S2.F1.5.m1.1.1.3.cmml" xref="S2.F1.5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.5.m1.1d">c_{t}</annotation></semantics></math> has private data <math id="S2.F1.6.m2.1" class="ltx_Math" alttext="\mathcal{D}_{t}" display="inline"><semantics id="S2.F1.6.m2.1b"><msub id="S2.F1.6.m2.1.1" xref="S2.F1.6.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F1.6.m2.1.1.2" xref="S2.F1.6.m2.1.1.2.cmml">𝒟</mi><mi id="S2.F1.6.m2.1.1.3" xref="S2.F1.6.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F1.6.m2.1c"><apply id="S2.F1.6.m2.1.1.cmml" xref="S2.F1.6.m2.1.1"><csymbol cd="ambiguous" id="S2.F1.6.m2.1.1.1.cmml" xref="S2.F1.6.m2.1.1">subscript</csymbol><ci id="S2.F1.6.m2.1.1.2.cmml" xref="S2.F1.6.m2.1.1.2">𝒟</ci><ci id="S2.F1.6.m2.1.1.3.cmml" xref="S2.F1.6.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.6.m2.1d">\mathcal{D}_{t}</annotation></semantics></math> following the distribution <math id="S2.F1.7.m3.1" class="ltx_Math" alttext="\mathcal{P}_{t}" display="inline"><semantics id="S2.F1.7.m3.1b"><msub id="S2.F1.7.m3.1.1" xref="S2.F1.7.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F1.7.m3.1.1.2" xref="S2.F1.7.m3.1.1.2.cmml">𝒫</mi><mi id="S2.F1.7.m3.1.1.3" xref="S2.F1.7.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F1.7.m3.1c"><apply id="S2.F1.7.m3.1.1.cmml" xref="S2.F1.7.m3.1.1"><csymbol cd="ambiguous" id="S2.F1.7.m3.1.1.1.cmml" xref="S2.F1.7.m3.1.1">subscript</csymbol><ci id="S2.F1.7.m3.1.1.2.cmml" xref="S2.F1.7.m3.1.1.2">𝒫</ci><ci id="S2.F1.7.m3.1.1.3.cmml" xref="S2.F1.7.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.7.m3.1d">\mathcal{P}_{t}</annotation></semantics></math>, and a personalized client VQA model with the weight <math id="S2.F1.8.m4.1" class="ltx_Math" alttext="\bm{w}_{t}" display="inline"><semantics id="S2.F1.8.m4.1b"><msub id="S2.F1.8.m4.1.1" xref="S2.F1.8.m4.1.1.cmml"><mi id="S2.F1.8.m4.1.1.2" xref="S2.F1.8.m4.1.1.2.cmml">𝒘</mi><mi id="S2.F1.8.m4.1.1.3" xref="S2.F1.8.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F1.8.m4.1c"><apply id="S2.F1.8.m4.1.1.cmml" xref="S2.F1.8.m4.1.1"><csymbol cd="ambiguous" id="S2.F1.8.m4.1.1.1.cmml" xref="S2.F1.8.m4.1.1">subscript</csymbol><ci id="S2.F1.8.m4.1.1.2.cmml" xref="S2.F1.8.m4.1.1.2">𝒘</ci><ci id="S2.F1.8.m4.1.1.3.cmml" xref="S2.F1.8.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.8.m4.1d">\bm{w}_{t}</annotation></semantics></math>. The client uploads the local information and obtains shared information through client-to-client communication.</figcaption>
</figure>
<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text" style="font-size:90%;">We provide an overview of our method in Fig. </span><a href="#S2.F1" title="Figure 1 ‣ 2 PROMPT-BASED PERSONALIZED FEDERATED LEARNING FOR MEDICAL VQA ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">1</span></a><span id="S2.p1.1.2" class="ltx_text" style="font-size:90%;">. We first formalize the proposed prompt-based pFL problem and then present the pFL medical VQA method.</span></p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Problem Formulation</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.13" class="ltx_p"><span id="S2.SS1.p1.13.1" class="ltx_text" style="font-size:90%;">The proposed method aims to train personalized medical VQA models for </span><math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi mathsize="90%" id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">T</annotation></semantics></math><span id="S2.SS1.p1.13.2" class="ltx_text" style="font-size:90%;"> clients collaboratively. Each client has its own private data and can communicate with others without sharing these data.
The </span><math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi mathsize="90%" id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">t</annotation></semantics></math><span id="S2.SS1.p1.13.3" class="ltx_text" style="font-size:90%;">-th client denoted as </span><math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝑐</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">c_{t}</annotation></semantics></math><span id="S2.SS1.p1.13.4" class="ltx_text" style="font-size:90%;"> is characterized by its data distribution </span><math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{P}_{t}:\mathcal{X}\times\mathcal{A}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><msub id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p1.4.m4.1.1.2.2" xref="S2.SS1.p1.4.m4.1.1.2.2.cmml">𝒫</mi><mi mathsize="90%" id="S2.SS1.p1.4.m4.1.1.2.3" xref="S2.SS1.p1.4.m4.1.1.2.3.cmml">t</mi></msub><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="S2.SS1.p1.4.m4.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.cmml">:</mo><mrow id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p1.4.m4.1.1.3.2" xref="S2.SS1.p1.4.m4.1.1.3.2.cmml">𝒳</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS1.p1.4.m4.1.1.3.1" xref="S2.SS1.p1.4.m4.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p1.4.m4.1.1.3.3" xref="S2.SS1.p1.4.m4.1.1.3.3.cmml">𝒜</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><ci id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1">:</ci><apply id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.2.1.cmml" xref="S2.SS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2.2">𝒫</ci><ci id="S2.SS1.p1.4.m4.1.1.2.3.cmml" xref="S2.SS1.p1.4.m4.1.1.2.3">𝑡</ci></apply><apply id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3"><times id="S2.SS1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS1.p1.4.m4.1.1.3.1"></times><ci id="S2.SS1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS1.p1.4.m4.1.1.3.2">𝒳</ci><ci id="S2.SS1.p1.4.m4.1.1.3.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3.3">𝒜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\mathcal{P}_{t}:\mathcal{X}\times\mathcal{A}</annotation></semantics></math><span id="S2.SS1.p1.13.5" class="ltx_text" style="font-size:90%;">, where </span><math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\mathcal{X}</annotation></semantics></math><span id="S2.SS1.p1.13.6" class="ltx_text" style="font-size:90%;"> represents the input data space and </span><math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\mathcal{A}</annotation></semantics></math><span id="S2.SS1.p1.13.7" class="ltx_text" style="font-size:90%;"> denotes the answer space. Assume that client </span><math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><msub id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.7.m7.1.1.2" xref="S2.SS1.p1.7.m7.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2">𝑐</ci><ci id="S2.SS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">c_{t}</annotation></semantics></math><span id="S2.SS1.p1.13.8" class="ltx_text" style="font-size:90%;"> has access to </span><math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="N_{t}" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><msub id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.8.m8.1.1.2" xref="S2.SS1.p1.8.m8.1.1.2.cmml">N</mi><mi mathsize="90%" id="S2.SS1.p1.8.m8.1.1.3" xref="S2.SS1.p1.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2">𝑁</ci><ci id="S2.SS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">N_{t}</annotation></semantics></math><span id="S2.SS1.p1.13.9" class="ltx_text" style="font-size:90%;"> independent and identically distributed (IID) samples from </span><math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{P}_{t}" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><msub id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml">𝒫</mi><mi mathsize="90%" id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2">𝒫</ci><ci id="S2.SS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\mathcal{P}_{t}</annotation></semantics></math><span id="S2.SS1.p1.13.10" class="ltx_text" style="font-size:90%;">, denoted by </span><math id="S2.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{D}_{t}=\{(I_{t}^{j},Q_{t}^{j},A_{t}^{j})\}_{j=1}^{N_{t}}" display="inline"><semantics id="S2.SS1.p1.10.m10.1a"><mrow id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><msub id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p1.10.m10.1.1.3.2" xref="S2.SS1.p1.10.m10.1.1.3.2.cmml">𝒟</mi><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.3.3" xref="S2.SS1.p1.10.m10.1.1.3.3.cmml">t</mi></msub><mo mathsize="90%" id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">=</mo><msubsup id="S2.SS1.p1.10.m10.1.1.1" xref="S2.SS1.p1.10.m10.1.1.1.cmml"><mrow id="S2.SS1.p1.10.m10.1.1.1.1.1.1" xref="S2.SS1.p1.10.m10.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.2" xref="S2.SS1.p1.10.m10.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.4.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.4" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.4.cmml">(</mo><msubsup id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.2.cmml">I</mi><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.5" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.4.cmml">,</mo><msubsup id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.cmml"><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.cmml">Q</mi><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.2.3" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.3" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msubsup><mo mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.6" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.4.cmml">,</mo><msubsup id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.2.2" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.2.2.cmml">A</mi><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.2.3" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.3" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></msubsup><mo maxsize="90%" minsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.7" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo maxsize="90%" minsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.3" xref="S2.SS1.p1.10.m10.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p1.10.m10.1.1.1.1.3" xref="S2.SS1.p1.10.m10.1.1.1.1.3.cmml"><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.3.2" xref="S2.SS1.p1.10.m10.1.1.1.1.3.2.cmml">j</mi><mo mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.3.1" xref="S2.SS1.p1.10.m10.1.1.1.1.3.1.cmml">=</mo><mn mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.1.3.3" xref="S2.SS1.p1.10.m10.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S2.SS1.p1.10.m10.1.1.1.3" xref="S2.SS1.p1.10.m10.1.1.1.3.cmml"><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.3.2" xref="S2.SS1.p1.10.m10.1.1.1.3.2.cmml">N</mi><mi mathsize="90%" id="S2.SS1.p1.10.m10.1.1.1.3.3" xref="S2.SS1.p1.10.m10.1.1.1.3.3.cmml">t</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><eq id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2"></eq><apply id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.3.1.cmml" xref="S2.SS1.p1.10.m10.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.3.2.cmml" xref="S2.SS1.p1.10.m10.1.1.3.2">𝒟</ci><ci id="S2.SS1.p1.10.m10.1.1.3.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3.3">𝑡</ci></apply><apply id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1">superscript</csymbol><apply id="S2.SS1.p1.10.m10.1.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1">subscript</csymbol><set id="S2.SS1.p1.10.m10.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1"><vector id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.4.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3"><apply id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.2">𝐼</ci><ci id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.2.2">𝑄</ci><ci id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply><ci id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.2.2">𝐴</ci><ci id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.2.3">𝑡</ci></apply><ci id="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></vector></set><apply id="S2.SS1.p1.10.m10.1.1.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.3"><eq id="S2.SS1.p1.10.m10.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.3.1"></eq><ci id="S2.SS1.p1.10.m10.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.3.2">𝑗</ci><cn type="integer" id="S2.SS1.p1.10.m10.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.10.m10.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p1.10.m10.1.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.3.1.cmml" xref="S2.SS1.p1.10.m10.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.1.3.2.cmml" xref="S2.SS1.p1.10.m10.1.1.1.3.2">𝑁</ci><ci id="S2.SS1.p1.10.m10.1.1.1.3.3.cmml" xref="S2.SS1.p1.10.m10.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\mathcal{D}_{t}=\{(I_{t}^{j},Q_{t}^{j},A_{t}^{j})\}_{j=1}^{N_{t}}</annotation></semantics></math><span id="S2.SS1.p1.13.11" class="ltx_text" style="font-size:90%;">, where </span><math id="S2.SS1.p1.11.m11.1" class="ltx_Math" alttext="I_{t}^{j}" display="inline"><semantics id="S2.SS1.p1.11.m11.1a"><msubsup id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.11.m11.1.1.2.2" xref="S2.SS1.p1.11.m11.1.1.2.2.cmml">I</mi><mi mathsize="90%" id="S2.SS1.p1.11.m11.1.1.2.3" xref="S2.SS1.p1.11.m11.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS1.p1.11.m11.1.1.3" xref="S2.SS1.p1.11.m11.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><apply id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">superscript</csymbol><apply id="S2.SS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.2.1.cmml" xref="S2.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.2.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2.2">𝐼</ci><ci id="S2.SS1.p1.11.m11.1.1.2.3.cmml" xref="S2.SS1.p1.11.m11.1.1.2.3">𝑡</ci></apply><ci id="S2.SS1.p1.11.m11.1.1.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">I_{t}^{j}</annotation></semantics></math><span id="S2.SS1.p1.13.12" class="ltx_text" style="font-size:90%;">, </span><math id="S2.SS1.p1.12.m12.1" class="ltx_Math" alttext="Q_{t}^{j}" display="inline"><semantics id="S2.SS1.p1.12.m12.1a"><msubsup id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.12.m12.1.1.2.2" xref="S2.SS1.p1.12.m12.1.1.2.2.cmml">Q</mi><mi mathsize="90%" id="S2.SS1.p1.12.m12.1.1.2.3" xref="S2.SS1.p1.12.m12.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS1.p1.12.m12.1.1.3" xref="S2.SS1.p1.12.m12.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><apply id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">superscript</csymbol><apply id="S2.SS1.p1.12.m12.1.1.2.cmml" xref="S2.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.1.1.2.1.cmml" xref="S2.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S2.SS1.p1.12.m12.1.1.2.2.cmml" xref="S2.SS1.p1.12.m12.1.1.2.2">𝑄</ci><ci id="S2.SS1.p1.12.m12.1.1.2.3.cmml" xref="S2.SS1.p1.12.m12.1.1.2.3">𝑡</ci></apply><ci id="S2.SS1.p1.12.m12.1.1.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">Q_{t}^{j}</annotation></semantics></math><span id="S2.SS1.p1.13.13" class="ltx_text" style="font-size:90%;"> and </span><math id="S2.SS1.p1.13.m13.1" class="ltx_Math" alttext="A_{t}^{j}" display="inline"><semantics id="S2.SS1.p1.13.m13.1a"><msubsup id="S2.SS1.p1.13.m13.1.1" xref="S2.SS1.p1.13.m13.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p1.13.m13.1.1.2.2" xref="S2.SS1.p1.13.m13.1.1.2.2.cmml">A</mi><mi mathsize="90%" id="S2.SS1.p1.13.m13.1.1.2.3" xref="S2.SS1.p1.13.m13.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS1.p1.13.m13.1.1.3" xref="S2.SS1.p1.13.m13.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.1b"><apply id="S2.SS1.p1.13.m13.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.1.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1">superscript</csymbol><apply id="S2.SS1.p1.13.m13.1.1.2.cmml" xref="S2.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.1.1.2.1.cmml" xref="S2.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S2.SS1.p1.13.m13.1.1.2.2.cmml" xref="S2.SS1.p1.13.m13.1.1.2.2">𝐴</ci><ci id="S2.SS1.p1.13.m13.1.1.2.3.cmml" xref="S2.SS1.p1.13.m13.1.1.2.3">𝑡</ci></apply><ci id="S2.SS1.p1.13.m13.1.1.3.cmml" xref="S2.SS1.p1.13.m13.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.1c">A_{t}^{j}</annotation></semantics></math><span id="S2.SS1.p1.13.14" class="ltx_text" style="font-size:90%;"> respectively represent the input images, questions and the ground truth answers.</span></p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.3" class="ltx_p"><span id="S2.SS1.p2.3.1" class="ltx_text" style="font-size:90%;">Let </span><math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{t}:\mathcal{X}\times\mathcal{A}\rightarrow\mathbb{R}+" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><msub id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p2.1.m1.1.1.2.2" xref="S2.SS1.p2.1.m1.1.1.2.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.SS1.p2.1.m1.1.1.2.3" xref="S2.SS1.p2.1.m1.1.1.2.3.cmml">t</mi></msub><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="S2.SS1.p2.1.m1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.cmml">:</mo><mrow id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml"><mrow id="S2.SS1.p2.1.m1.1.1.3.2" xref="S2.SS1.p2.1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p2.1.m1.1.1.3.2.2" xref="S2.SS1.p2.1.m1.1.1.3.2.2.cmml">𝒳</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS1.p2.1.m1.1.1.3.2.1" xref="S2.SS1.p2.1.m1.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p2.1.m1.1.1.3.2.3" xref="S2.SS1.p2.1.m1.1.1.3.2.3.cmml">𝒜</mi></mrow><mo mathsize="90%" stretchy="false" id="S2.SS1.p2.1.m1.1.1.3.1" xref="S2.SS1.p2.1.m1.1.1.3.1.cmml">→</mo><mrow id="S2.SS1.p2.1.m1.1.1.3.3" xref="S2.SS1.p2.1.m1.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS1.p2.1.m1.1.1.3.3.2" xref="S2.SS1.p2.1.m1.1.1.3.3.2.cmml">ℝ</mi><mo mathsize="90%" id="S2.SS1.p2.1.m1.1.1.3.3.3" xref="S2.SS1.p2.1.m1.1.1.3.3.3.cmml">+</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><ci id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1">:</ci><apply id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.2.1.cmml" xref="S2.SS1.p2.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2.2">ℒ</ci><ci id="S2.SS1.p2.1.m1.1.1.2.3.cmml" xref="S2.SS1.p2.1.m1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3"><ci id="S2.SS1.p2.1.m1.1.1.3.1.cmml" xref="S2.SS1.p2.1.m1.1.1.3.1">→</ci><apply id="S2.SS1.p2.1.m1.1.1.3.2.cmml" xref="S2.SS1.p2.1.m1.1.1.3.2"><times id="S2.SS1.p2.1.m1.1.1.3.2.1.cmml" xref="S2.SS1.p2.1.m1.1.1.3.2.1"></times><ci id="S2.SS1.p2.1.m1.1.1.3.2.2.cmml" xref="S2.SS1.p2.1.m1.1.1.3.2.2">𝒳</ci><ci id="S2.SS1.p2.1.m1.1.1.3.2.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3.2.3">𝒜</ci></apply><apply id="S2.SS1.p2.1.m1.1.1.3.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3"><csymbol cd="latexml" id="S2.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3">limit-from</csymbol><ci id="S2.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3.2">ℝ</ci><plus id="S2.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3.3"></plus></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\mathcal{L}_{t}:\mathcal{X}\times\mathcal{A}\rightarrow\mathbb{R}+</annotation></semantics></math><span id="S2.SS1.p2.3.2" class="ltx_text" style="font-size:90%;"> represent the loss function associated with client </span><math id="S2.SS1.p2.2.m2.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><msub id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p2.2.m2.1.1.2" xref="S2.SS1.p2.2.m2.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2">𝑐</ci><ci id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">c_{t}</annotation></semantics></math><span id="S2.SS1.p2.3.3" class="ltx_text" style="font-size:90%;"> and the data sampled from the distribution </span><math id="S2.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{P}_{t}" display="inline"><semantics id="S2.SS1.p2.3.m3.1a"><msub id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p2.3.m3.1.1.2" xref="S2.SS1.p2.3.m3.1.1.2.cmml">𝒫</mi><mi mathsize="90%" id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2">𝒫</ci><ci id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">\mathcal{P}_{t}</annotation></semantics></math><span id="S2.SS1.p2.3.4" class="ltx_text" style="font-size:90%;">.
The goal of the proposed method is to optimize</span></p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.4" class="ltx_Math" alttext="\mathcal{L}(\bm{W})=\mathrm{arg}\mathop{\min}_{\bm{w}_{t}}\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}_{(\mathcal{X},\mathcal{A})\sim\mathcal{P}_{t}}[\mathcal{L}_{t}(\bm{w}_{t};\mathcal{S}_{t},\mathcal{D}_{t})]," display="block"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4.1" xref="S2.E1.m1.4.4.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1.3" xref="S2.E1.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E1.m1.4.4.1.1.3.2" xref="S2.E1.m1.4.4.1.1.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.3.1" xref="S2.E1.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="S2.E1.m1.4.4.1.1.3.3.2" xref="S2.E1.m1.4.4.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E1.m1.4.4.1.1.3.3.2.1" xref="S2.E1.m1.4.4.1.1.3.cmml">(</mo><mi mathsize="90%" id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">𝑾</mi><mo maxsize="90%" minsize="90%" id="S2.E1.m1.4.4.1.1.3.3.2.2" xref="S2.E1.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.E1.m1.4.4.1.1.2" xref="S2.E1.m1.4.4.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.4.4.1.1.1" xref="S2.E1.m1.4.4.1.1.1.cmml"><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.3.cmml">arg</mi><mo lspace="0.167em" rspace="0em" id="S2.E1.m1.4.4.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.4.4.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.cmml"><munder id="S2.E1.m1.4.4.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml"><mo mathsize="90%" movablelimits="false" rspace="0.167em" id="S2.E1.m1.4.4.1.1.1.1.2.2" xref="S2.E1.m1.4.4.1.1.1.1.2.2.cmml">min</mo><msub id="S2.E1.m1.4.4.1.1.1.1.2.3" xref="S2.E1.m1.4.4.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.2.3.2" xref="S2.E1.m1.4.4.1.1.1.1.2.3.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.2.3.3" xref="S2.E1.m1.4.4.1.1.1.1.2.3.3.cmml">t</mi></msub></munder><mrow id="S2.E1.m1.4.4.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.cmml"><mfrac id="S2.E1.m1.4.4.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.3.cmml"><mn mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.3.2.cmml">1</mn><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.3.3.cmml">T</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml"><munderover id="S2.E1.m1.4.4.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.2.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.3.cmml">T</mi></munderover><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><mrow id="S2.E1.m1.2.2.2.4.2" xref="S2.E1.m1.2.2.2.4.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.E1.m1.2.2.2.4.2.1" xref="S2.E1.m1.2.2.2.4.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">𝒳</mi><mo mathsize="90%" id="S2.E1.m1.2.2.2.4.2.2" xref="S2.E1.m1.2.2.2.4.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">𝒜</mi><mo maxsize="90%" minsize="90%" id="S2.E1.m1.2.2.2.4.2.3" xref="S2.E1.m1.2.2.2.4.1.cmml">)</mo></mrow><mo mathsize="90%" id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml">∼</mo><msub id="S2.E1.m1.2.2.2.5" xref="S2.E1.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E1.m1.2.2.2.5.2" xref="S2.E1.m1.2.2.2.5.2.cmml">𝒫</mi><mi mathsize="90%" id="S2.E1.m1.2.2.2.5.3" xref="S2.E1.m1.2.2.2.5.3.cmml">t</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.cmml">​</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.4.cmml"><mo maxsize="90%" minsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.4" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.4.cmml">(</mo><msub id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.5" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.4.cmml">;</mo><msub id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝒮</mi><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.6" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">𝒟</mi><mi mathsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">t</mi></msub><mo maxsize="90%" minsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.7" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S2.E1.m1.4.4.1.2" xref="S2.E1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.1.1.cmml" xref="S2.E1.m1.4.4.1"><eq id="S2.E1.m1.4.4.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.2"></eq><apply id="S2.E1.m1.4.4.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.3"><times id="S2.E1.m1.4.4.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.3.1"></times><ci id="S2.E1.m1.4.4.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.3.2">ℒ</ci><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑾</ci></apply><apply id="S2.E1.m1.4.4.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1"><times id="S2.E1.m1.4.4.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.2"></times><ci id="S2.E1.m1.4.4.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3">arg</ci><apply id="S2.E1.m1.4.4.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1"><apply id="S2.E1.m1.4.4.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2">subscript</csymbol><min id="S2.E1.m1.4.4.1.1.1.1.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.2"></min><apply id="S2.E1.m1.4.4.1.1.1.1.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.3.2">𝒘</ci><ci id="S2.E1.m1.4.4.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S2.E1.m1.4.4.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1"><times id="S2.E1.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.2"></times><apply id="S2.E1.m1.4.4.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3"><divide id="S2.E1.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3"></divide><cn type="integer" id="S2.E1.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3.2">1</cn><ci id="S2.E1.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3.3">𝑇</ci></apply><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1"><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3"><eq id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1"><times id="S2.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.2"></times><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.3.2">𝔼</ci><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><csymbol cd="latexml" id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S2.E1.m1.2.2.2.4.1.cmml" xref="S2.E1.m1.2.2.2.4.2"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝒳</ci><ci id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2">𝒜</ci></interval><apply id="S2.E1.m1.2.2.2.5.cmml" xref="S2.E1.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.5.1.cmml" xref="S2.E1.m1.2.2.2.5">subscript</csymbol><ci id="S2.E1.m1.2.2.2.5.2.cmml" xref="S2.E1.m1.2.2.2.5.2">𝒫</ci><ci id="S2.E1.m1.2.2.2.5.3.cmml" xref="S2.E1.m1.2.2.2.5.3">𝑡</ci></apply></apply></apply><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.4"></times><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.2">ℒ</ci><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.5.3">𝑡</ci></apply><list id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3"><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝒮</ci><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝒟</ci><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑡</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">\mathcal{L}(\bm{W})=\mathrm{arg}\mathop{\min}_{\bm{w}_{t}}\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}_{(\mathcal{X},\mathcal{A})\sim\mathcal{P}_{t}}[\mathcal{L}_{t}(\bm{w}_{t};\mathcal{S}_{t},\mathcal{D}_{t})],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p2.6" class="ltx_p"><span id="S2.SS1.p2.6.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.SS1.p2.4.m1.4" class="ltx_Math" alttext="\bm{W}=\{\bm{w}_{1},\bm{w}_{2},...,\bm{w}_{T}\}" display="inline"><semantics id="S2.SS1.p2.4.m1.4a"><mrow id="S2.SS1.p2.4.m1.4.4" xref="S2.SS1.p2.4.m1.4.4.cmml"><mi mathsize="90%" id="S2.SS1.p2.4.m1.4.4.5" xref="S2.SS1.p2.4.m1.4.4.5.cmml">𝑾</mi><mo mathsize="90%" id="S2.SS1.p2.4.m1.4.4.4" xref="S2.SS1.p2.4.m1.4.4.4.cmml">=</mo><mrow id="S2.SS1.p2.4.m1.4.4.3.3" xref="S2.SS1.p2.4.m1.4.4.3.4.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS1.p2.4.m1.4.4.3.3.4" xref="S2.SS1.p2.4.m1.4.4.3.4.cmml">{</mo><msub id="S2.SS1.p2.4.m1.2.2.1.1.1" xref="S2.SS1.p2.4.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p2.4.m1.2.2.1.1.1.2" xref="S2.SS1.p2.4.m1.2.2.1.1.1.2.cmml">𝒘</mi><mn mathsize="90%" id="S2.SS1.p2.4.m1.2.2.1.1.1.3" xref="S2.SS1.p2.4.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S2.SS1.p2.4.m1.4.4.3.3.5" xref="S2.SS1.p2.4.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p2.4.m1.3.3.2.2.2" xref="S2.SS1.p2.4.m1.3.3.2.2.2.cmml"><mi mathsize="90%" id="S2.SS1.p2.4.m1.3.3.2.2.2.2" xref="S2.SS1.p2.4.m1.3.3.2.2.2.2.cmml">𝒘</mi><mn mathsize="90%" id="S2.SS1.p2.4.m1.3.3.2.2.2.3" xref="S2.SS1.p2.4.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo mathsize="90%" id="S2.SS1.p2.4.m1.4.4.3.3.6" xref="S2.SS1.p2.4.m1.4.4.3.4.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.SS1.p2.4.m1.1.1" xref="S2.SS1.p2.4.m1.1.1.cmml">…</mi><mo mathsize="90%" id="S2.SS1.p2.4.m1.4.4.3.3.7" xref="S2.SS1.p2.4.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS1.p2.4.m1.4.4.3.3.3" xref="S2.SS1.p2.4.m1.4.4.3.3.3.cmml"><mi mathsize="90%" id="S2.SS1.p2.4.m1.4.4.3.3.3.2" xref="S2.SS1.p2.4.m1.4.4.3.3.3.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.SS1.p2.4.m1.4.4.3.3.3.3" xref="S2.SS1.p2.4.m1.4.4.3.3.3.3.cmml">T</mi></msub><mo maxsize="90%" minsize="90%" id="S2.SS1.p2.4.m1.4.4.3.3.8" xref="S2.SS1.p2.4.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m1.4b"><apply id="S2.SS1.p2.4.m1.4.4.cmml" xref="S2.SS1.p2.4.m1.4.4"><eq id="S2.SS1.p2.4.m1.4.4.4.cmml" xref="S2.SS1.p2.4.m1.4.4.4"></eq><ci id="S2.SS1.p2.4.m1.4.4.5.cmml" xref="S2.SS1.p2.4.m1.4.4.5">𝑾</ci><set id="S2.SS1.p2.4.m1.4.4.3.4.cmml" xref="S2.SS1.p2.4.m1.4.4.3.3"><apply id="S2.SS1.p2.4.m1.2.2.1.1.1.cmml" xref="S2.SS1.p2.4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.4.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m1.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.4.m1.2.2.1.1.1.2">𝒘</ci><cn type="integer" id="S2.SS1.p2.4.m1.2.2.1.1.1.3.cmml" xref="S2.SS1.p2.4.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p2.4.m1.3.3.2.2.2.cmml" xref="S2.SS1.p2.4.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m1.3.3.2.2.2.1.cmml" xref="S2.SS1.p2.4.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p2.4.m1.3.3.2.2.2.2.cmml" xref="S2.SS1.p2.4.m1.3.3.2.2.2.2">𝒘</ci><cn type="integer" id="S2.SS1.p2.4.m1.3.3.2.2.2.3.cmml" xref="S2.SS1.p2.4.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p2.4.m1.1.1.cmml" xref="S2.SS1.p2.4.m1.1.1">…</ci><apply id="S2.SS1.p2.4.m1.4.4.3.3.3.cmml" xref="S2.SS1.p2.4.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m1.4.4.3.3.3.1.cmml" xref="S2.SS1.p2.4.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p2.4.m1.4.4.3.3.3.2.cmml" xref="S2.SS1.p2.4.m1.4.4.3.3.3.2">𝒘</ci><ci id="S2.SS1.p2.4.m1.4.4.3.3.3.3.cmml" xref="S2.SS1.p2.4.m1.4.4.3.3.3.3">𝑇</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m1.4c">\bm{W}=\{\bm{w}_{1},\bm{w}_{2},...,\bm{w}_{T}\}</annotation></semantics></math><span id="S2.SS1.p2.6.2" class="ltx_text" style="font-size:90%;"> is the parameter set of the client models, and </span><math id="S2.SS1.p2.5.m2.1" class="ltx_Math" alttext="\mathcal{S}_{t}" display="inline"><semantics id="S2.SS1.p2.5.m2.1a"><msub id="S2.SS1.p2.5.m2.1.1" xref="S2.SS1.p2.5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p2.5.m2.1.1.2" xref="S2.SS1.p2.5.m2.1.1.2.cmml">𝒮</mi><mi mathsize="90%" id="S2.SS1.p2.5.m2.1.1.3" xref="S2.SS1.p2.5.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m2.1b"><apply id="S2.SS1.p2.5.m2.1.1.cmml" xref="S2.SS1.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m2.1.1.1.cmml" xref="S2.SS1.p2.5.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m2.1.1.2.cmml" xref="S2.SS1.p2.5.m2.1.1.2">𝒮</ci><ci id="S2.SS1.p2.5.m2.1.1.3.cmml" xref="S2.SS1.p2.5.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m2.1c">\mathcal{S}_{t}</annotation></semantics></math><span id="S2.SS1.p2.6.3" class="ltx_text" style="font-size:90%;"> represents the shared information from all clients except </span><math id="S2.SS1.p2.6.m3.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.SS1.p2.6.m3.1a"><msub id="S2.SS1.p2.6.m3.1.1" xref="S2.SS1.p2.6.m3.1.1.cmml"><mi mathsize="90%" id="S2.SS1.p2.6.m3.1.1.2" xref="S2.SS1.p2.6.m3.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS1.p2.6.m3.1.1.3" xref="S2.SS1.p2.6.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m3.1b"><apply id="S2.SS1.p2.6.m3.1.1.cmml" xref="S2.SS1.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m3.1.1.1.cmml" xref="S2.SS1.p2.6.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.6.m3.1.1.2.cmml" xref="S2.SS1.p2.6.m3.1.1.2">𝑐</ci><ci id="S2.SS1.p2.6.m3.1.1.3.cmml" xref="S2.SS1.p2.6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m3.1c">c_{t}</annotation></semantics></math><span id="S2.SS1.p2.6.4" class="ltx_text" style="font-size:90%;">. However, as the true underlying distribution is often inaccessible, the goal is generally achieved through empirical risk minimization.
Consequently, the training objective can be computed as follows:</span></p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\mathrm{arg}\mathop{\min}_{\bm{w}_{t}}\sum_{t=1}^{T}[\mathcal{L}_{\mathrm{CE}}+\mathcal{R}+\mathcal{L}_{\mathrm{d}}]," display="block"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml">arg</mi><mo lspace="0.167em" rspace="0em" id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><munder id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml"><mo mathsize="90%" movablelimits="false" rspace="0em" id="S2.E2.m1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.2.2.cmml">min</mo><msub id="S2.E2.m1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.1.1.1.1.1.2.3.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.1.2.3.3" xref="S2.E2.m1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></munder><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><munderover id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" id="S2.E2.m1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.2.2.3.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.2.2.3.1" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.2.2.3.3" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">T</mi></munderover><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">CE</mi></msub><mo mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">ℛ</mi><mo mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1a" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.2.cmml">ℒ</mi><mi mathsize="90%" mathvariant="normal" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.3.cmml">d</mi></msub></mrow><mo maxsize="90%" minsize="90%" id="S2.E2.m1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3">arg</ci><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><apply id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.2">subscript</csymbol><min id="S2.E2.m1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2.2"></min><apply id="S2.E2.m1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2.3.2">𝒘</ci><ci id="S2.E2.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><apply id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3"><eq id="S2.E2.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1"><plus id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2">ℒ</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3">CE</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3">ℛ</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.2">ℒ</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.3">d</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\mathrm{arg}\mathop{\min}_{\bm{w}_{t}}\sum_{t=1}^{T}[\mathcal{L}_{\mathrm{CE}}+\mathcal{R}+\mathcal{L}_{\mathrm{d}}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p2.9" class="ltx_p"><span id="S2.SS1.p2.9.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.SS1.p2.7.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{CE}}" display="inline"><semantics id="S2.SS1.p2.7.m1.1a"><msub id="S2.SS1.p2.7.m1.1.1" xref="S2.SS1.p2.7.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p2.7.m1.1.1.2" xref="S2.SS1.p2.7.m1.1.1.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.SS1.p2.7.m1.1.1.3" xref="S2.SS1.p2.7.m1.1.1.3.cmml">CE</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m1.1b"><apply id="S2.SS1.p2.7.m1.1.1.cmml" xref="S2.SS1.p2.7.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m1.1.1.1.cmml" xref="S2.SS1.p2.7.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.7.m1.1.1.2.cmml" xref="S2.SS1.p2.7.m1.1.1.2">ℒ</ci><ci id="S2.SS1.p2.7.m1.1.1.3.cmml" xref="S2.SS1.p2.7.m1.1.1.3">CE</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m1.1c">\mathcal{L}_{\mathrm{CE}}</annotation></semantics></math><span id="S2.SS1.p2.9.2" class="ltx_text" style="font-size:90%;"> is a local average loss over personal training data, specifically, cross-entropy loss, </span><math id="S2.SS1.p2.8.m2.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S2.SS1.p2.8.m2.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p2.8.m2.1.1" xref="S2.SS1.p2.8.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m2.1b"><ci id="S2.SS1.p2.8.m2.1.1.cmml" xref="S2.SS1.p2.8.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m2.1c">\mathcal{R}</annotation></semantics></math><span id="S2.SS1.p2.9.3" class="ltx_text" style="font-size:90%;"> serves as a regularization term applied during the training process to mitigate overfitting among clients, and </span><math id="S2.SS1.p2.9.m3.1" class="ltx_Math" alttext="\mathcal{L}_{d}" display="inline"><semantics id="S2.SS1.p2.9.m3.1a"><msub id="S2.SS1.p2.9.m3.1.1" xref="S2.SS1.p2.9.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS1.p2.9.m3.1.1.2" xref="S2.SS1.p2.9.m3.1.1.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.SS1.p2.9.m3.1.1.3" xref="S2.SS1.p2.9.m3.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m3.1b"><apply id="S2.SS1.p2.9.m3.1.1.cmml" xref="S2.SS1.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m3.1.1.1.cmml" xref="S2.SS1.p2.9.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.9.m3.1.1.2.cmml" xref="S2.SS1.p2.9.m3.1.1.2">ℒ</ci><ci id="S2.SS1.p2.9.m3.1.1.3.cmml" xref="S2.SS1.p2.9.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m3.1c">\mathcal{L}_{d}</annotation></semantics></math><span id="S2.SS1.p2.9.4" class="ltx_text" style="font-size:90%;"> represents a distance loss to ensure the shared information can be utilized efficiently. The proposed method enables the simultaneous training of personalized VQA models tailored for diverse data distributions while sharing information instead of private data, thereby ensuring privacy and facilitating mutual benefits among clients.</span></p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Prompt-based Visual Question Answering Model</h3>

<figure id="S2.F2" class="ltx_figure"><img src="/html/2402.09677/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="257" height="92" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.13.1.1" class="ltx_text ltx_font_bold">Fig. 2</span>: </span>The proposed transformer encoder that introduces the prompt-based self-attention block. Local prompt <math id="S2.F2.4.m1.1" class="ltx_Math" alttext="\bm{p}_{t}^{p}" display="inline"><semantics id="S2.F2.4.m1.1b"><msubsup id="S2.F2.4.m1.1.1" xref="S2.F2.4.m1.1.1.cmml"><mi id="S2.F2.4.m1.1.1.2.2" xref="S2.F2.4.m1.1.1.2.2.cmml">𝒑</mi><mi id="S2.F2.4.m1.1.1.2.3" xref="S2.F2.4.m1.1.1.2.3.cmml">t</mi><mi id="S2.F2.4.m1.1.1.3" xref="S2.F2.4.m1.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.4.m1.1c"><apply id="S2.F2.4.m1.1.1.cmml" xref="S2.F2.4.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.4.m1.1.1.1.cmml" xref="S2.F2.4.m1.1.1">superscript</csymbol><apply id="S2.F2.4.m1.1.1.2.cmml" xref="S2.F2.4.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.4.m1.1.1.2.1.cmml" xref="S2.F2.4.m1.1.1">subscript</csymbol><ci id="S2.F2.4.m1.1.1.2.2.cmml" xref="S2.F2.4.m1.1.1.2.2">𝒑</ci><ci id="S2.F2.4.m1.1.1.2.3.cmml" xref="S2.F2.4.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.F2.4.m1.1.1.3.cmml" xref="S2.F2.4.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.4.m1.1d">\bm{p}_{t}^{p}</annotation></semantics></math> and shared prompt <math id="S2.F2.5.m2.1" class="ltx_Math" alttext="\bm{p}_{t}^{s}" display="inline"><semantics id="S2.F2.5.m2.1b"><msubsup id="S2.F2.5.m2.1.1" xref="S2.F2.5.m2.1.1.cmml"><mi id="S2.F2.5.m2.1.1.2.2" xref="S2.F2.5.m2.1.1.2.2.cmml">𝒑</mi><mi id="S2.F2.5.m2.1.1.2.3" xref="S2.F2.5.m2.1.1.2.3.cmml">t</mi><mi id="S2.F2.5.m2.1.1.3" xref="S2.F2.5.m2.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.5.m2.1c"><apply id="S2.F2.5.m2.1.1.cmml" xref="S2.F2.5.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.5.m2.1.1.1.cmml" xref="S2.F2.5.m2.1.1">superscript</csymbol><apply id="S2.F2.5.m2.1.1.2.cmml" xref="S2.F2.5.m2.1.1"><csymbol cd="ambiguous" id="S2.F2.5.m2.1.1.2.1.cmml" xref="S2.F2.5.m2.1.1">subscript</csymbol><ci id="S2.F2.5.m2.1.1.2.2.cmml" xref="S2.F2.5.m2.1.1.2.2">𝒑</ci><ci id="S2.F2.5.m2.1.1.2.3.cmml" xref="S2.F2.5.m2.1.1.2.3">𝑡</ci></apply><ci id="S2.F2.5.m2.1.1.3.cmml" xref="S2.F2.5.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.5.m2.1d">\bm{p}_{t}^{s}</annotation></semantics></math> are integrated into the process of self-attention, and the distance between them is controlled by the distance loss <math id="S2.F2.6.m3.1" class="ltx_Math" alttext="\mathcal{L}_{d}" display="inline"><semantics id="S2.F2.6.m3.1b"><msub id="S2.F2.6.m3.1.1" xref="S2.F2.6.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.F2.6.m3.1.1.2" xref="S2.F2.6.m3.1.1.2.cmml">ℒ</mi><mi id="S2.F2.6.m3.1.1.3" xref="S2.F2.6.m3.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F2.6.m3.1c"><apply id="S2.F2.6.m3.1.1.cmml" xref="S2.F2.6.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.6.m3.1.1.1.cmml" xref="S2.F2.6.m3.1.1">subscript</csymbol><ci id="S2.F2.6.m3.1.1.2.cmml" xref="S2.F2.6.m3.1.1.2">ℒ</ci><ci id="S2.F2.6.m3.1.1.3.cmml" xref="S2.F2.6.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.m3.1d">\mathcal{L}_{d}</annotation></semantics></math>.</figcaption>
</figure>
<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p"><span id="S2.SS2.p1.1.1" class="ltx_text" style="font-size:90%;">We describe the proposed prompt-based VQA client model with a general client </span><math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><msub id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝑐</ci><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">c_{t}</annotation></semantics></math><span id="S2.SS2.p1.1.2" class="ltx_text" style="font-size:90%;"> as an example. We employ a specific variational auto-encoder structure </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS2.p1.1.3.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib20" title="" class="ltx_ref">20</a><span id="S2.SS2.p1.1.4.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.SS2.p1.1.5" class="ltx_text" style="font-size:90%;"> that integrates an image encoder, a text encoder, and an answering decoder, where the two encoders have the same transformer architecture and different parameters.
The original transformer encoder consists of an input embedding layer and a set of multi-head self-attention (MHA) based residual attention (RA) blocks. The RA block uses self-attention mechanisms and feedforward neural networks, combined with residual connections and normalization, to effectively process data sequences.</span></p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.10" class="ltx_p"><span id="S2.SS2.p2.10.1" class="ltx_text" style="font-size:90%;">Directly using the original architecture can lead to excessive load in the communication process, significantly reducing the efficiency of federated learning.
Therefore, we propose a novel transformer encoder that introduces the prompt-based residual attention (pRA) block as shown in Fig. </span><a href="#S2.F2" title="Figure 2 ‣ 2.2 Prompt-based Visual Question Answering Model ‣ 2 PROMPT-BASED PERSONALIZED FEDERATED LEARNING FOR MEDICAL VQA ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S2.SS2.p2.10.2" class="ltx_text" style="font-size:90%;">. The pRA block uses a set of learnable prompts as an additional input of the MHA layer.
Specifically, for client </span><math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><msub id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝑐</ci><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">c_{t}</annotation></semantics></math><span id="S2.SS2.p2.10.3" class="ltx_text" style="font-size:90%;">, we introduce local prompt </span><math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="\bm{p}_{t}^{p}\in\mathbb{R}^{r\times L\times D}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><msubsup id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml"><mi mathsize="90%" id="S2.SS2.p2.2.m2.1.1.2.2.2" xref="S2.SS2.p2.2.m2.1.1.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p2.2.m2.1.1.2.2.3" xref="S2.SS2.p2.2.m2.1.1.2.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p2.2.m2.1.1.2.3" xref="S2.SS2.p2.2.m2.1.1.2.3.cmml">p</mi></msubsup><mo mathsize="90%" id="S2.SS2.p2.2.m2.1.1.1" xref="S2.SS2.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml"><mi mathsize="90%" id="S2.SS2.p2.2.m2.1.1.3.2" xref="S2.SS2.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p2.2.m2.1.1.3.3" xref="S2.SS2.p2.2.m2.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS2.p2.2.m2.1.1.3.3.2" xref="S2.SS2.p2.2.m2.1.1.3.3.2.cmml">r</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS2.p2.2.m2.1.1.3.3.1" xref="S2.SS2.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi mathsize="90%" id="S2.SS2.p2.2.m2.1.1.3.3.3" xref="S2.SS2.p2.2.m2.1.1.3.3.3.cmml">L</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS2.p2.2.m2.1.1.3.3.1a" xref="S2.SS2.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi mathsize="90%" id="S2.SS2.p2.2.m2.1.1.3.3.4" xref="S2.SS2.p2.2.m2.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><in id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1"></in><apply id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.2.1.cmml" xref="S2.SS2.p2.2.m2.1.1.2">superscript</csymbol><apply id="S2.SS2.p2.2.m2.1.1.2.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.2.2.1.cmml" xref="S2.SS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.2.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2.2.2">𝒑</ci><ci id="S2.SS2.p2.2.m2.1.1.2.2.3.cmml" xref="S2.SS2.p2.2.m2.1.1.2.2.3">𝑡</ci></apply><ci id="S2.SS2.p2.2.m2.1.1.2.3.cmml" xref="S2.SS2.p2.2.m2.1.1.2.3">𝑝</ci></apply><apply id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.3.1.cmml" xref="S2.SS2.p2.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.3.2.cmml" xref="S2.SS2.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S2.SS2.p2.2.m2.1.1.3.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3.3"><times id="S2.SS2.p2.2.m2.1.1.3.3.1.cmml" xref="S2.SS2.p2.2.m2.1.1.3.3.1"></times><ci id="S2.SS2.p2.2.m2.1.1.3.3.2.cmml" xref="S2.SS2.p2.2.m2.1.1.3.3.2">𝑟</ci><ci id="S2.SS2.p2.2.m2.1.1.3.3.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3.3.3">𝐿</ci><ci id="S2.SS2.p2.2.m2.1.1.3.3.4.cmml" xref="S2.SS2.p2.2.m2.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\bm{p}_{t}^{p}\in\mathbb{R}^{r\times L\times D}</annotation></semantics></math><span id="S2.SS2.p2.10.4" class="ltx_text" style="font-size:90%;"> trained locally and shared prompts </span><math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="\bm{p}_{t}^{s}\in\mathbb{R}^{r\times L\times D}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mrow id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><msubsup id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml"><mi mathsize="90%" id="S2.SS2.p2.3.m3.1.1.2.2.2" xref="S2.SS2.p2.3.m3.1.1.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p2.3.m3.1.1.2.2.3" xref="S2.SS2.p2.3.m3.1.1.2.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p2.3.m3.1.1.2.3" xref="S2.SS2.p2.3.m3.1.1.2.3.cmml">s</mi></msubsup><mo mathsize="90%" id="S2.SS2.p2.3.m3.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml"><mi mathsize="90%" id="S2.SS2.p2.3.m3.1.1.3.2" xref="S2.SS2.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p2.3.m3.1.1.3.3" xref="S2.SS2.p2.3.m3.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS2.p2.3.m3.1.1.3.3.2" xref="S2.SS2.p2.3.m3.1.1.3.3.2.cmml">r</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS2.p2.3.m3.1.1.3.3.1" xref="S2.SS2.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi mathsize="90%" id="S2.SS2.p2.3.m3.1.1.3.3.3" xref="S2.SS2.p2.3.m3.1.1.3.3.3.cmml">L</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS2.p2.3.m3.1.1.3.3.1a" xref="S2.SS2.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi mathsize="90%" id="S2.SS2.p2.3.m3.1.1.3.3.4" xref="S2.SS2.p2.3.m3.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><in id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1"></in><apply id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.2.1.cmml" xref="S2.SS2.p2.3.m3.1.1.2">superscript</csymbol><apply id="S2.SS2.p2.3.m3.1.1.2.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.2.2.1.cmml" xref="S2.SS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.2.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2.2.2">𝒑</ci><ci id="S2.SS2.p2.3.m3.1.1.2.2.3.cmml" xref="S2.SS2.p2.3.m3.1.1.2.2.3">𝑡</ci></apply><ci id="S2.SS2.p2.3.m3.1.1.2.3.cmml" xref="S2.SS2.p2.3.m3.1.1.2.3">𝑠</ci></apply><apply id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S2.SS2.p2.3.m3.1.1.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3"><times id="S2.SS2.p2.3.m3.1.1.3.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3.1"></times><ci id="S2.SS2.p2.3.m3.1.1.3.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3.2">𝑟</ci><ci id="S2.SS2.p2.3.m3.1.1.3.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3.3">𝐿</ci><ci id="S2.SS2.p2.3.m3.1.1.3.3.4.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\bm{p}_{t}^{s}\in\mathbb{R}^{r\times L\times D}</annotation></semantics></math><span id="S2.SS2.p2.10.5" class="ltx_text" style="font-size:90%;"> obtained from other clients, where </span><math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mi mathsize="90%" id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><ci id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">r</annotation></semantics></math><span id="S2.SS2.p2.10.6" class="ltx_text" style="font-size:90%;"> is the number of the pRA blocks, and </span><math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><mi mathsize="90%" id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><ci id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">L</annotation></semantics></math><span id="S2.SS2.p2.10.7" class="ltx_text" style="font-size:90%;"> is the length of the prompts. In contrast to the original RA block, the proposed pRA block introduces the prompts into the MHA layer using Prefix-Tuning (Pre-T) </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS2.p2.10.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S2.SS2.p2.10.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.SS2.p2.10.10" class="ltx_text" style="font-size:90%;">. Pre-T splits </span><math id="S2.SS2.p2.6.m6.1" class="ltx_Math" alttext="\bm{p}_{t}^{p}" display="inline"><semantics id="S2.SS2.p2.6.m6.1a"><msubsup id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p2.6.m6.1.1.2.2" xref="S2.SS2.p2.6.m6.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p2.6.m6.1.1.2.3" xref="S2.SS2.p2.6.m6.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p2.6.m6.1.1.3" xref="S2.SS2.p2.6.m6.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b"><apply id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">superscript</csymbol><apply id="S2.SS2.p2.6.m6.1.1.2.cmml" xref="S2.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.1.1.2.1.cmml" xref="S2.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p2.6.m6.1.1.2.2.cmml" xref="S2.SS2.p2.6.m6.1.1.2.2">𝒑</ci><ci id="S2.SS2.p2.6.m6.1.1.2.3.cmml" xref="S2.SS2.p2.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p2.6.m6.1.1.3.cmml" xref="S2.SS2.p2.6.m6.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">\bm{p}_{t}^{p}</annotation></semantics></math><span id="S2.SS2.p2.10.11" class="ltx_text" style="font-size:90%;"> and </span><math id="S2.SS2.p2.7.m7.1" class="ltx_Math" alttext="\bm{p}_{t}^{s}" display="inline"><semantics id="S2.SS2.p2.7.m7.1a"><msubsup id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p2.7.m7.1.1.2.2" xref="S2.SS2.p2.7.m7.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p2.7.m7.1.1.2.3" xref="S2.SS2.p2.7.m7.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p2.7.m7.1.1.3" xref="S2.SS2.p2.7.m7.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.1b"><apply id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.1.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1">superscript</csymbol><apply id="S2.SS2.p2.7.m7.1.1.2.cmml" xref="S2.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.1.1.2.1.cmml" xref="S2.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S2.SS2.p2.7.m7.1.1.2.2.cmml" xref="S2.SS2.p2.7.m7.1.1.2.2">𝒑</ci><ci id="S2.SS2.p2.7.m7.1.1.2.3.cmml" xref="S2.SS2.p2.7.m7.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p2.7.m7.1.1.3.cmml" xref="S2.SS2.p2.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.1c">\bm{p}_{t}^{s}</annotation></semantics></math><span id="S2.SS2.p2.10.12" class="ltx_text" style="font-size:90%;"> into </span><math id="S2.SS2.p2.8.m8.6" class="ltx_Math" alttext="\{\bm{p}_{t}^{p,K},\bm{p}_{t}^{p,V}\}\in\mathbb{R}^{1\times L/2\times D}" display="inline"><semantics id="S2.SS2.p2.8.m8.6a"><mrow id="S2.SS2.p2.8.m8.6.6" xref="S2.SS2.p2.8.m8.6.6.cmml"><mrow id="S2.SS2.p2.8.m8.6.6.2.2" xref="S2.SS2.p2.8.m8.6.6.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS2.p2.8.m8.6.6.2.2.3" xref="S2.SS2.p2.8.m8.6.6.2.3.cmml">{</mo><msubsup id="S2.SS2.p2.8.m8.5.5.1.1.1" xref="S2.SS2.p2.8.m8.5.5.1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p2.8.m8.5.5.1.1.1.2.2" xref="S2.SS2.p2.8.m8.5.5.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p2.8.m8.5.5.1.1.1.2.3" xref="S2.SS2.p2.8.m8.5.5.1.1.1.2.3.cmml">t</mi><mrow id="S2.SS2.p2.8.m8.2.2.2.4" xref="S2.SS2.p2.8.m8.2.2.2.3.cmml"><mi mathsize="90%" id="S2.SS2.p2.8.m8.1.1.1.1" xref="S2.SS2.p2.8.m8.1.1.1.1.cmml">p</mi><mo mathsize="90%" id="S2.SS2.p2.8.m8.2.2.2.4.1" xref="S2.SS2.p2.8.m8.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S2.SS2.p2.8.m8.2.2.2.2" xref="S2.SS2.p2.8.m8.2.2.2.2.cmml">K</mi></mrow></msubsup><mo mathsize="90%" id="S2.SS2.p2.8.m8.6.6.2.2.4" xref="S2.SS2.p2.8.m8.6.6.2.3.cmml">,</mo><msubsup id="S2.SS2.p2.8.m8.6.6.2.2.2" xref="S2.SS2.p2.8.m8.6.6.2.2.2.cmml"><mi mathsize="90%" id="S2.SS2.p2.8.m8.6.6.2.2.2.2.2" xref="S2.SS2.p2.8.m8.6.6.2.2.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p2.8.m8.6.6.2.2.2.2.3" xref="S2.SS2.p2.8.m8.6.6.2.2.2.2.3.cmml">t</mi><mrow id="S2.SS2.p2.8.m8.4.4.2.4" xref="S2.SS2.p2.8.m8.4.4.2.3.cmml"><mi mathsize="90%" id="S2.SS2.p2.8.m8.3.3.1.1" xref="S2.SS2.p2.8.m8.3.3.1.1.cmml">p</mi><mo mathsize="90%" id="S2.SS2.p2.8.m8.4.4.2.4.1" xref="S2.SS2.p2.8.m8.4.4.2.3.cmml">,</mo><mi mathsize="90%" id="S2.SS2.p2.8.m8.4.4.2.2" xref="S2.SS2.p2.8.m8.4.4.2.2.cmml">V</mi></mrow></msubsup><mo maxsize="90%" minsize="90%" id="S2.SS2.p2.8.m8.6.6.2.2.5" xref="S2.SS2.p2.8.m8.6.6.2.3.cmml">}</mo></mrow><mo mathsize="90%" id="S2.SS2.p2.8.m8.6.6.3" xref="S2.SS2.p2.8.m8.6.6.3.cmml">∈</mo><msup id="S2.SS2.p2.8.m8.6.6.4" xref="S2.SS2.p2.8.m8.6.6.4.cmml"><mi mathsize="90%" id="S2.SS2.p2.8.m8.6.6.4.2" xref="S2.SS2.p2.8.m8.6.6.4.2.cmml">ℝ</mi><mrow id="S2.SS2.p2.8.m8.6.6.4.3" xref="S2.SS2.p2.8.m8.6.6.4.3.cmml"><mrow id="S2.SS2.p2.8.m8.6.6.4.3.2" xref="S2.SS2.p2.8.m8.6.6.4.3.2.cmml"><mrow id="S2.SS2.p2.8.m8.6.6.4.3.2.2" xref="S2.SS2.p2.8.m8.6.6.4.3.2.2.cmml"><mn mathsize="90%" id="S2.SS2.p2.8.m8.6.6.4.3.2.2.2" xref="S2.SS2.p2.8.m8.6.6.4.3.2.2.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS2.p2.8.m8.6.6.4.3.2.2.1" xref="S2.SS2.p2.8.m8.6.6.4.3.2.2.1.cmml">×</mo><mi mathsize="90%" id="S2.SS2.p2.8.m8.6.6.4.3.2.2.3" xref="S2.SS2.p2.8.m8.6.6.4.3.2.2.3.cmml">L</mi></mrow><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="S2.SS2.p2.8.m8.6.6.4.3.2.1" xref="S2.SS2.p2.8.m8.6.6.4.3.2.1.cmml">/</mo><mn mathsize="90%" id="S2.SS2.p2.8.m8.6.6.4.3.2.3" xref="S2.SS2.p2.8.m8.6.6.4.3.2.3.cmml">2</mn></mrow><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS2.p2.8.m8.6.6.4.3.1" xref="S2.SS2.p2.8.m8.6.6.4.3.1.cmml">×</mo><mi mathsize="90%" id="S2.SS2.p2.8.m8.6.6.4.3.3" xref="S2.SS2.p2.8.m8.6.6.4.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.6b"><apply id="S2.SS2.p2.8.m8.6.6.cmml" xref="S2.SS2.p2.8.m8.6.6"><in id="S2.SS2.p2.8.m8.6.6.3.cmml" xref="S2.SS2.p2.8.m8.6.6.3"></in><set id="S2.SS2.p2.8.m8.6.6.2.3.cmml" xref="S2.SS2.p2.8.m8.6.6.2.2"><apply id="S2.SS2.p2.8.m8.5.5.1.1.1.cmml" xref="S2.SS2.p2.8.m8.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.5.5.1.1.1.1.cmml" xref="S2.SS2.p2.8.m8.5.5.1.1.1">superscript</csymbol><apply id="S2.SS2.p2.8.m8.5.5.1.1.1.2.cmml" xref="S2.SS2.p2.8.m8.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.5.5.1.1.1.2.1.cmml" xref="S2.SS2.p2.8.m8.5.5.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.8.m8.5.5.1.1.1.2.2.cmml" xref="S2.SS2.p2.8.m8.5.5.1.1.1.2.2">𝒑</ci><ci id="S2.SS2.p2.8.m8.5.5.1.1.1.2.3.cmml" xref="S2.SS2.p2.8.m8.5.5.1.1.1.2.3">𝑡</ci></apply><list id="S2.SS2.p2.8.m8.2.2.2.3.cmml" xref="S2.SS2.p2.8.m8.2.2.2.4"><ci id="S2.SS2.p2.8.m8.1.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1">𝑝</ci><ci id="S2.SS2.p2.8.m8.2.2.2.2.cmml" xref="S2.SS2.p2.8.m8.2.2.2.2">𝐾</ci></list></apply><apply id="S2.SS2.p2.8.m8.6.6.2.2.2.cmml" xref="S2.SS2.p2.8.m8.6.6.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.6.6.2.2.2.1.cmml" xref="S2.SS2.p2.8.m8.6.6.2.2.2">superscript</csymbol><apply id="S2.SS2.p2.8.m8.6.6.2.2.2.2.cmml" xref="S2.SS2.p2.8.m8.6.6.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.6.6.2.2.2.2.1.cmml" xref="S2.SS2.p2.8.m8.6.6.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.8.m8.6.6.2.2.2.2.2.cmml" xref="S2.SS2.p2.8.m8.6.6.2.2.2.2.2">𝒑</ci><ci id="S2.SS2.p2.8.m8.6.6.2.2.2.2.3.cmml" xref="S2.SS2.p2.8.m8.6.6.2.2.2.2.3">𝑡</ci></apply><list id="S2.SS2.p2.8.m8.4.4.2.3.cmml" xref="S2.SS2.p2.8.m8.4.4.2.4"><ci id="S2.SS2.p2.8.m8.3.3.1.1.cmml" xref="S2.SS2.p2.8.m8.3.3.1.1">𝑝</ci><ci id="S2.SS2.p2.8.m8.4.4.2.2.cmml" xref="S2.SS2.p2.8.m8.4.4.2.2">𝑉</ci></list></apply></set><apply id="S2.SS2.p2.8.m8.6.6.4.cmml" xref="S2.SS2.p2.8.m8.6.6.4"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.6.6.4.1.cmml" xref="S2.SS2.p2.8.m8.6.6.4">superscript</csymbol><ci id="S2.SS2.p2.8.m8.6.6.4.2.cmml" xref="S2.SS2.p2.8.m8.6.6.4.2">ℝ</ci><apply id="S2.SS2.p2.8.m8.6.6.4.3.cmml" xref="S2.SS2.p2.8.m8.6.6.4.3"><times id="S2.SS2.p2.8.m8.6.6.4.3.1.cmml" xref="S2.SS2.p2.8.m8.6.6.4.3.1"></times><apply id="S2.SS2.p2.8.m8.6.6.4.3.2.cmml" xref="S2.SS2.p2.8.m8.6.6.4.3.2"><divide id="S2.SS2.p2.8.m8.6.6.4.3.2.1.cmml" xref="S2.SS2.p2.8.m8.6.6.4.3.2.1"></divide><apply id="S2.SS2.p2.8.m8.6.6.4.3.2.2.cmml" xref="S2.SS2.p2.8.m8.6.6.4.3.2.2"><times id="S2.SS2.p2.8.m8.6.6.4.3.2.2.1.cmml" xref="S2.SS2.p2.8.m8.6.6.4.3.2.2.1"></times><cn type="integer" id="S2.SS2.p2.8.m8.6.6.4.3.2.2.2.cmml" xref="S2.SS2.p2.8.m8.6.6.4.3.2.2.2">1</cn><ci id="S2.SS2.p2.8.m8.6.6.4.3.2.2.3.cmml" xref="S2.SS2.p2.8.m8.6.6.4.3.2.2.3">𝐿</ci></apply><cn type="integer" id="S2.SS2.p2.8.m8.6.6.4.3.2.3.cmml" xref="S2.SS2.p2.8.m8.6.6.4.3.2.3">2</cn></apply><ci id="S2.SS2.p2.8.m8.6.6.4.3.3.cmml" xref="S2.SS2.p2.8.m8.6.6.4.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.6c">\{\bm{p}_{t}^{p,K},\bm{p}_{t}^{p,V}\}\in\mathbb{R}^{1\times L/2\times D}</annotation></semantics></math><span id="S2.SS2.p2.10.13" class="ltx_text" style="font-size:90%;"> and </span><math id="S2.SS2.p2.9.m9.6" class="ltx_Math" alttext="\{\bm{p}_{t}^{s,K},\bm{p}_{t}^{s,V}\}\in\mathbb{R}^{1\times L/2\times D}" display="inline"><semantics id="S2.SS2.p2.9.m9.6a"><mrow id="S2.SS2.p2.9.m9.6.6" xref="S2.SS2.p2.9.m9.6.6.cmml"><mrow id="S2.SS2.p2.9.m9.6.6.2.2" xref="S2.SS2.p2.9.m9.6.6.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS2.p2.9.m9.6.6.2.2.3" xref="S2.SS2.p2.9.m9.6.6.2.3.cmml">{</mo><msubsup id="S2.SS2.p2.9.m9.5.5.1.1.1" xref="S2.SS2.p2.9.m9.5.5.1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p2.9.m9.5.5.1.1.1.2.2" xref="S2.SS2.p2.9.m9.5.5.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p2.9.m9.5.5.1.1.1.2.3" xref="S2.SS2.p2.9.m9.5.5.1.1.1.2.3.cmml">t</mi><mrow id="S2.SS2.p2.9.m9.2.2.2.4" xref="S2.SS2.p2.9.m9.2.2.2.3.cmml"><mi mathsize="90%" id="S2.SS2.p2.9.m9.1.1.1.1" xref="S2.SS2.p2.9.m9.1.1.1.1.cmml">s</mi><mo mathsize="90%" id="S2.SS2.p2.9.m9.2.2.2.4.1" xref="S2.SS2.p2.9.m9.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S2.SS2.p2.9.m9.2.2.2.2" xref="S2.SS2.p2.9.m9.2.2.2.2.cmml">K</mi></mrow></msubsup><mo mathsize="90%" id="S2.SS2.p2.9.m9.6.6.2.2.4" xref="S2.SS2.p2.9.m9.6.6.2.3.cmml">,</mo><msubsup id="S2.SS2.p2.9.m9.6.6.2.2.2" xref="S2.SS2.p2.9.m9.6.6.2.2.2.cmml"><mi mathsize="90%" id="S2.SS2.p2.9.m9.6.6.2.2.2.2.2" xref="S2.SS2.p2.9.m9.6.6.2.2.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p2.9.m9.6.6.2.2.2.2.3" xref="S2.SS2.p2.9.m9.6.6.2.2.2.2.3.cmml">t</mi><mrow id="S2.SS2.p2.9.m9.4.4.2.4" xref="S2.SS2.p2.9.m9.4.4.2.3.cmml"><mi mathsize="90%" id="S2.SS2.p2.9.m9.3.3.1.1" xref="S2.SS2.p2.9.m9.3.3.1.1.cmml">s</mi><mo mathsize="90%" id="S2.SS2.p2.9.m9.4.4.2.4.1" xref="S2.SS2.p2.9.m9.4.4.2.3.cmml">,</mo><mi mathsize="90%" id="S2.SS2.p2.9.m9.4.4.2.2" xref="S2.SS2.p2.9.m9.4.4.2.2.cmml">V</mi></mrow></msubsup><mo maxsize="90%" minsize="90%" id="S2.SS2.p2.9.m9.6.6.2.2.5" xref="S2.SS2.p2.9.m9.6.6.2.3.cmml">}</mo></mrow><mo mathsize="90%" id="S2.SS2.p2.9.m9.6.6.3" xref="S2.SS2.p2.9.m9.6.6.3.cmml">∈</mo><msup id="S2.SS2.p2.9.m9.6.6.4" xref="S2.SS2.p2.9.m9.6.6.4.cmml"><mi mathsize="90%" id="S2.SS2.p2.9.m9.6.6.4.2" xref="S2.SS2.p2.9.m9.6.6.4.2.cmml">ℝ</mi><mrow id="S2.SS2.p2.9.m9.6.6.4.3" xref="S2.SS2.p2.9.m9.6.6.4.3.cmml"><mrow id="S2.SS2.p2.9.m9.6.6.4.3.2" xref="S2.SS2.p2.9.m9.6.6.4.3.2.cmml"><mrow id="S2.SS2.p2.9.m9.6.6.4.3.2.2" xref="S2.SS2.p2.9.m9.6.6.4.3.2.2.cmml"><mn mathsize="90%" id="S2.SS2.p2.9.m9.6.6.4.3.2.2.2" xref="S2.SS2.p2.9.m9.6.6.4.3.2.2.2.cmml">1</mn><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS2.p2.9.m9.6.6.4.3.2.2.1" xref="S2.SS2.p2.9.m9.6.6.4.3.2.2.1.cmml">×</mo><mi mathsize="90%" id="S2.SS2.p2.9.m9.6.6.4.3.2.2.3" xref="S2.SS2.p2.9.m9.6.6.4.3.2.2.3.cmml">L</mi></mrow><mo maxsize="90%" minsize="90%" stretchy="true" symmetric="true" id="S2.SS2.p2.9.m9.6.6.4.3.2.1" xref="S2.SS2.p2.9.m9.6.6.4.3.2.1.cmml">/</mo><mn mathsize="90%" id="S2.SS2.p2.9.m9.6.6.4.3.2.3" xref="S2.SS2.p2.9.m9.6.6.4.3.2.3.cmml">2</mn></mrow><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS2.p2.9.m9.6.6.4.3.1" xref="S2.SS2.p2.9.m9.6.6.4.3.1.cmml">×</mo><mi mathsize="90%" id="S2.SS2.p2.9.m9.6.6.4.3.3" xref="S2.SS2.p2.9.m9.6.6.4.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m9.6b"><apply id="S2.SS2.p2.9.m9.6.6.cmml" xref="S2.SS2.p2.9.m9.6.6"><in id="S2.SS2.p2.9.m9.6.6.3.cmml" xref="S2.SS2.p2.9.m9.6.6.3"></in><set id="S2.SS2.p2.9.m9.6.6.2.3.cmml" xref="S2.SS2.p2.9.m9.6.6.2.2"><apply id="S2.SS2.p2.9.m9.5.5.1.1.1.cmml" xref="S2.SS2.p2.9.m9.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.5.5.1.1.1.1.cmml" xref="S2.SS2.p2.9.m9.5.5.1.1.1">superscript</csymbol><apply id="S2.SS2.p2.9.m9.5.5.1.1.1.2.cmml" xref="S2.SS2.p2.9.m9.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.5.5.1.1.1.2.1.cmml" xref="S2.SS2.p2.9.m9.5.5.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.9.m9.5.5.1.1.1.2.2.cmml" xref="S2.SS2.p2.9.m9.5.5.1.1.1.2.2">𝒑</ci><ci id="S2.SS2.p2.9.m9.5.5.1.1.1.2.3.cmml" xref="S2.SS2.p2.9.m9.5.5.1.1.1.2.3">𝑡</ci></apply><list id="S2.SS2.p2.9.m9.2.2.2.3.cmml" xref="S2.SS2.p2.9.m9.2.2.2.4"><ci id="S2.SS2.p2.9.m9.1.1.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1.1.1">𝑠</ci><ci id="S2.SS2.p2.9.m9.2.2.2.2.cmml" xref="S2.SS2.p2.9.m9.2.2.2.2">𝐾</ci></list></apply><apply id="S2.SS2.p2.9.m9.6.6.2.2.2.cmml" xref="S2.SS2.p2.9.m9.6.6.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.6.6.2.2.2.1.cmml" xref="S2.SS2.p2.9.m9.6.6.2.2.2">superscript</csymbol><apply id="S2.SS2.p2.9.m9.6.6.2.2.2.2.cmml" xref="S2.SS2.p2.9.m9.6.6.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.6.6.2.2.2.2.1.cmml" xref="S2.SS2.p2.9.m9.6.6.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.9.m9.6.6.2.2.2.2.2.cmml" xref="S2.SS2.p2.9.m9.6.6.2.2.2.2.2">𝒑</ci><ci id="S2.SS2.p2.9.m9.6.6.2.2.2.2.3.cmml" xref="S2.SS2.p2.9.m9.6.6.2.2.2.2.3">𝑡</ci></apply><list id="S2.SS2.p2.9.m9.4.4.2.3.cmml" xref="S2.SS2.p2.9.m9.4.4.2.4"><ci id="S2.SS2.p2.9.m9.3.3.1.1.cmml" xref="S2.SS2.p2.9.m9.3.3.1.1">𝑠</ci><ci id="S2.SS2.p2.9.m9.4.4.2.2.cmml" xref="S2.SS2.p2.9.m9.4.4.2.2">𝑉</ci></list></apply></set><apply id="S2.SS2.p2.9.m9.6.6.4.cmml" xref="S2.SS2.p2.9.m9.6.6.4"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.6.6.4.1.cmml" xref="S2.SS2.p2.9.m9.6.6.4">superscript</csymbol><ci id="S2.SS2.p2.9.m9.6.6.4.2.cmml" xref="S2.SS2.p2.9.m9.6.6.4.2">ℝ</ci><apply id="S2.SS2.p2.9.m9.6.6.4.3.cmml" xref="S2.SS2.p2.9.m9.6.6.4.3"><times id="S2.SS2.p2.9.m9.6.6.4.3.1.cmml" xref="S2.SS2.p2.9.m9.6.6.4.3.1"></times><apply id="S2.SS2.p2.9.m9.6.6.4.3.2.cmml" xref="S2.SS2.p2.9.m9.6.6.4.3.2"><divide id="S2.SS2.p2.9.m9.6.6.4.3.2.1.cmml" xref="S2.SS2.p2.9.m9.6.6.4.3.2.1"></divide><apply id="S2.SS2.p2.9.m9.6.6.4.3.2.2.cmml" xref="S2.SS2.p2.9.m9.6.6.4.3.2.2"><times id="S2.SS2.p2.9.m9.6.6.4.3.2.2.1.cmml" xref="S2.SS2.p2.9.m9.6.6.4.3.2.2.1"></times><cn type="integer" id="S2.SS2.p2.9.m9.6.6.4.3.2.2.2.cmml" xref="S2.SS2.p2.9.m9.6.6.4.3.2.2.2">1</cn><ci id="S2.SS2.p2.9.m9.6.6.4.3.2.2.3.cmml" xref="S2.SS2.p2.9.m9.6.6.4.3.2.2.3">𝐿</ci></apply><cn type="integer" id="S2.SS2.p2.9.m9.6.6.4.3.2.3.cmml" xref="S2.SS2.p2.9.m9.6.6.4.3.2.3">2</cn></apply><ci id="S2.SS2.p2.9.m9.6.6.4.3.3.cmml" xref="S2.SS2.p2.9.m9.6.6.4.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m9.6c">\{\bm{p}_{t}^{s,K},\bm{p}_{t}^{s,V}\}\in\mathbb{R}^{1\times L/2\times D}</annotation></semantics></math><span id="S2.SS2.p2.10.14" class="ltx_text" style="font-size:90%;"> for each of the </span><math id="S2.SS2.p2.10.m10.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS2.p2.10.m10.1a"><mi mathsize="90%" id="S2.SS2.p2.10.m10.1.1" xref="S2.SS2.p2.10.m10.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m10.1b"><ci id="S2.SS2.p2.10.m10.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m10.1c">r</annotation></semantics></math><span id="S2.SS2.p2.10.15" class="ltx_text" style="font-size:90%;"> blocks, respectively.</span></p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.2" class="ltx_p"><span id="S2.SS2.p3.2.1" class="ltx_text" style="font-size:90%;">Each input image or question is embedded by the input embedding layer to </span><math id="S2.SS2.p3.1.m1.3" class="ltx_Math" alttext="\bm{h}=\{\bm{h}_{Q},\bm{h}_{K},\bm{h}_{V}\}\in\mathbb{R}^{D}" display="inline"><semantics id="S2.SS2.p3.1.m1.3a"><mrow id="S2.SS2.p3.1.m1.3.3" xref="S2.SS2.p3.1.m1.3.3.cmml"><mi mathsize="90%" id="S2.SS2.p3.1.m1.3.3.5" xref="S2.SS2.p3.1.m1.3.3.5.cmml">𝒉</mi><mo mathsize="90%" id="S2.SS2.p3.1.m1.3.3.6" xref="S2.SS2.p3.1.m1.3.3.6.cmml">=</mo><mrow id="S2.SS2.p3.1.m1.3.3.3.3" xref="S2.SS2.p3.1.m1.3.3.3.4.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS2.p3.1.m1.3.3.3.3.4" xref="S2.SS2.p3.1.m1.3.3.3.4.cmml">{</mo><msub id="S2.SS2.p3.1.m1.1.1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p3.1.m1.1.1.1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.1.1.1.2.cmml">𝒉</mi><mi mathsize="90%" id="S2.SS2.p3.1.m1.1.1.1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.1.1.1.3.cmml">Q</mi></msub><mo mathsize="90%" id="S2.SS2.p3.1.m1.3.3.3.3.5" xref="S2.SS2.p3.1.m1.3.3.3.4.cmml">,</mo><msub id="S2.SS2.p3.1.m1.2.2.2.2.2" xref="S2.SS2.p3.1.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="S2.SS2.p3.1.m1.2.2.2.2.2.2" xref="S2.SS2.p3.1.m1.2.2.2.2.2.2.cmml">𝒉</mi><mi mathsize="90%" id="S2.SS2.p3.1.m1.2.2.2.2.2.3" xref="S2.SS2.p3.1.m1.2.2.2.2.2.3.cmml">K</mi></msub><mo mathsize="90%" id="S2.SS2.p3.1.m1.3.3.3.3.6" xref="S2.SS2.p3.1.m1.3.3.3.4.cmml">,</mo><msub id="S2.SS2.p3.1.m1.3.3.3.3.3" xref="S2.SS2.p3.1.m1.3.3.3.3.3.cmml"><mi mathsize="90%" id="S2.SS2.p3.1.m1.3.3.3.3.3.2" xref="S2.SS2.p3.1.m1.3.3.3.3.3.2.cmml">𝒉</mi><mi mathsize="90%" id="S2.SS2.p3.1.m1.3.3.3.3.3.3" xref="S2.SS2.p3.1.m1.3.3.3.3.3.3.cmml">V</mi></msub><mo maxsize="90%" minsize="90%" id="S2.SS2.p3.1.m1.3.3.3.3.7" xref="S2.SS2.p3.1.m1.3.3.3.4.cmml">}</mo></mrow><mo mathsize="90%" id="S2.SS2.p3.1.m1.3.3.7" xref="S2.SS2.p3.1.m1.3.3.7.cmml">∈</mo><msup id="S2.SS2.p3.1.m1.3.3.8" xref="S2.SS2.p3.1.m1.3.3.8.cmml"><mi mathsize="90%" id="S2.SS2.p3.1.m1.3.3.8.2" xref="S2.SS2.p3.1.m1.3.3.8.2.cmml">ℝ</mi><mi mathsize="90%" id="S2.SS2.p3.1.m1.3.3.8.3" xref="S2.SS2.p3.1.m1.3.3.8.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.3b"><apply id="S2.SS2.p3.1.m1.3.3.cmml" xref="S2.SS2.p3.1.m1.3.3"><and id="S2.SS2.p3.1.m1.3.3a.cmml" xref="S2.SS2.p3.1.m1.3.3"></and><apply id="S2.SS2.p3.1.m1.3.3b.cmml" xref="S2.SS2.p3.1.m1.3.3"><eq id="S2.SS2.p3.1.m1.3.3.6.cmml" xref="S2.SS2.p3.1.m1.3.3.6"></eq><ci id="S2.SS2.p3.1.m1.3.3.5.cmml" xref="S2.SS2.p3.1.m1.3.3.5">𝒉</ci><set id="S2.SS2.p3.1.m1.3.3.3.4.cmml" xref="S2.SS2.p3.1.m1.3.3.3.3"><apply id="S2.SS2.p3.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.2">𝒉</ci><ci id="S2.SS2.p3.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.3">𝑄</ci></apply><apply id="S2.SS2.p3.1.m1.2.2.2.2.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.2.2.2.2.2.1.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p3.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.2.2">𝒉</ci><ci id="S2.SS2.p3.1.m1.2.2.2.2.2.3.cmml" xref="S2.SS2.p3.1.m1.2.2.2.2.2.3">𝐾</ci></apply><apply id="S2.SS2.p3.1.m1.3.3.3.3.3.cmml" xref="S2.SS2.p3.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.3.3.3.3.3.1.cmml" xref="S2.SS2.p3.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S2.SS2.p3.1.m1.3.3.3.3.3.2.cmml" xref="S2.SS2.p3.1.m1.3.3.3.3.3.2">𝒉</ci><ci id="S2.SS2.p3.1.m1.3.3.3.3.3.3.cmml" xref="S2.SS2.p3.1.m1.3.3.3.3.3.3">𝑉</ci></apply></set></apply><apply id="S2.SS2.p3.1.m1.3.3c.cmml" xref="S2.SS2.p3.1.m1.3.3"><in id="S2.SS2.p3.1.m1.3.3.7.cmml" xref="S2.SS2.p3.1.m1.3.3.7"></in><share href="#S2.SS2.p3.1.m1.3.3.3.cmml" id="S2.SS2.p3.1.m1.3.3d.cmml" xref="S2.SS2.p3.1.m1.3.3"></share><apply id="S2.SS2.p3.1.m1.3.3.8.cmml" xref="S2.SS2.p3.1.m1.3.3.8"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.3.3.8.1.cmml" xref="S2.SS2.p3.1.m1.3.3.8">superscript</csymbol><ci id="S2.SS2.p3.1.m1.3.3.8.2.cmml" xref="S2.SS2.p3.1.m1.3.3.8.2">ℝ</ci><ci id="S2.SS2.p3.1.m1.3.3.8.3.cmml" xref="S2.SS2.p3.1.m1.3.3.8.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.3c">\bm{h}=\{\bm{h}_{Q},\bm{h}_{K},\bm{h}_{V}\}\in\mathbb{R}^{D}</annotation></semantics></math><span id="S2.SS2.p3.2.2" class="ltx_text" style="font-size:90%;">, where the positional encoding has been added. Next, </span><math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><mi mathsize="90%" id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">h</annotation></semantics></math><span id="S2.SS2.p3.2.3" class="ltx_text" style="font-size:90%;"> is fed into the MHA layer, which is calculated as follows:</span></p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.2" class="ltx_math_unparsed" alttext="\mathrm{MHA}(\bm{h}_{Q},\bm{h}_{K},\bm{h}_{V},\bm{p}_{t}^{p},\bm{p}_{t}^{s})=\mathrm{Concat}(\hat{h}_{1},...,\hat{h}_{i},....,\hat{h}_{m})\bm{W}^{O}," display="block"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2b"><mi mathsize="90%" id="S2.E3.m1.2.3">MHA</mi><mrow id="S2.E3.m1.2.4"><mo maxsize="90%" minsize="90%" id="S2.E3.m1.2.4.1">(</mo><msub id="S2.E3.m1.2.4.2"><mi mathsize="90%" id="S2.E3.m1.2.4.2.2">𝒉</mi><mi mathsize="90%" id="S2.E3.m1.2.4.2.3">Q</mi></msub><mo mathsize="90%" id="S2.E3.m1.2.4.3">,</mo><msub id="S2.E3.m1.2.4.4"><mi mathsize="90%" id="S2.E3.m1.2.4.4.2">𝒉</mi><mi mathsize="90%" id="S2.E3.m1.2.4.4.3">K</mi></msub><mo mathsize="90%" id="S2.E3.m1.2.4.5">,</mo><msub id="S2.E3.m1.2.4.6"><mi mathsize="90%" id="S2.E3.m1.2.4.6.2">𝒉</mi><mi mathsize="90%" id="S2.E3.m1.2.4.6.3">V</mi></msub><mo mathsize="90%" id="S2.E3.m1.2.4.7">,</mo><msubsup id="S2.E3.m1.2.4.8"><mi mathsize="90%" id="S2.E3.m1.2.4.8.2.2">𝒑</mi><mi mathsize="90%" id="S2.E3.m1.2.4.8.2.3">t</mi><mi mathsize="90%" id="S2.E3.m1.2.4.8.3">p</mi></msubsup><mo mathsize="90%" id="S2.E3.m1.2.4.9">,</mo><msubsup id="S2.E3.m1.2.4.10"><mi mathsize="90%" id="S2.E3.m1.2.4.10.2.2">𝒑</mi><mi mathsize="90%" id="S2.E3.m1.2.4.10.2.3">t</mi><mi mathsize="90%" id="S2.E3.m1.2.4.10.3">s</mi></msubsup><mo maxsize="90%" minsize="90%" id="S2.E3.m1.2.4.11">)</mo></mrow><mo mathsize="90%" id="S2.E3.m1.2.5">=</mo><mi mathsize="90%" id="S2.E3.m1.2.6">Concat</mi><mrow id="S2.E3.m1.2.7"><mo maxsize="90%" minsize="90%" id="S2.E3.m1.2.7.1">(</mo><msub id="S2.E3.m1.2.7.2"><mover accent="true" id="S2.E3.m1.2.7.2.2"><mi mathsize="90%" id="S2.E3.m1.2.7.2.2.2">h</mi><mo mathsize="90%" id="S2.E3.m1.2.7.2.2.1">^</mo></mover><mn mathsize="90%" id="S2.E3.m1.2.7.2.3">1</mn></msub><mo mathsize="90%" id="S2.E3.m1.2.7.3">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.E3.m1.1.1">…</mi><mo mathsize="90%" id="S2.E3.m1.2.7.4">,</mo><msub id="S2.E3.m1.2.7.5"><mover accent="true" id="S2.E3.m1.2.7.5.2"><mi mathsize="90%" id="S2.E3.m1.2.7.5.2.2">h</mi><mo mathsize="90%" id="S2.E3.m1.2.7.5.2.1">^</mo></mover><mi mathsize="90%" id="S2.E3.m1.2.7.5.3">i</mi></msub><mo mathsize="90%" id="S2.E3.m1.2.7.6">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.E3.m1.2.2">…</mi><mo lspace="0em" mathsize="90%" rspace="0.167em" id="S2.E3.m1.2.7.7">.</mo><mo mathsize="90%" id="S2.E3.m1.2.7.8">,</mo><msub id="S2.E3.m1.2.7.9"><mover accent="true" id="S2.E3.m1.2.7.9.2"><mi mathsize="90%" id="S2.E3.m1.2.7.9.2.2">h</mi><mo mathsize="90%" id="S2.E3.m1.2.7.9.2.1">^</mo></mover><mi mathsize="90%" id="S2.E3.m1.2.7.9.3">m</mi></msub><mo maxsize="90%" minsize="90%" id="S2.E3.m1.2.7.10">)</mo></mrow><msup id="S2.E3.m1.2.8"><mi mathsize="90%" id="S2.E3.m1.2.8.2">𝑾</mi><mi mathsize="90%" id="S2.E3.m1.2.8.3">O</mi></msup><mo mathsize="90%" id="S2.E3.m1.2.9">,</mo></mrow><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\mathrm{MHA}(\bm{h}_{Q},\bm{h}_{K},\bm{h}_{V},\bm{p}_{t}^{p},\bm{p}_{t}^{s})=\mathrm{Concat}(\hat{h}_{1},...,\hat{h}_{i},....,\hat{h}_{m})\bm{W}^{O},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.1" class="ltx_Math" alttext="\hat{h}_{i}=\mathrm{Attention}(\bm{h}_{Q}\bm{W}_{i}^{Q},\hat{\bm{h}}_{K}\bm{W}_{i}^{K},\hat{\bm{h}}_{V}\bm{W}_{i}^{V})," display="block"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><msub id="S2.E4.m1.1.1.1.1.5" xref="S2.E4.m1.1.1.1.1.5.cmml"><mover accent="true" id="S2.E4.m1.1.1.1.1.5.2" xref="S2.E4.m1.1.1.1.1.5.2.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.5.2.2" xref="S2.E4.m1.1.1.1.1.5.2.2.cmml">h</mi><mo mathsize="90%" id="S2.E4.m1.1.1.1.1.5.2.1" xref="S2.E4.m1.1.1.1.1.5.2.1.cmml">^</mo></mover><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.5.3" xref="S2.E4.m1.1.1.1.1.5.3.cmml">i</mi></msub><mo mathsize="90%" id="S2.E4.m1.1.1.1.1.4" xref="S2.E4.m1.1.1.1.1.4.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.3.5" xref="S2.E4.m1.1.1.1.1.3.5.cmml">Attention</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.1.1.1.3.4" xref="S2.E4.m1.1.1.1.1.3.4.cmml">​</mo><mrow id="S2.E4.m1.1.1.1.1.3.3.3" xref="S2.E4.m1.1.1.1.1.3.3.4.cmml"><mo maxsize="90%" minsize="90%" id="S2.E4.m1.1.1.1.1.3.3.3.4" xref="S2.E4.m1.1.1.1.1.3.3.4.cmml">(</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E4.m1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝒉</mi><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml">Q</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S2.E4.m1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msubsup></mrow><mo mathsize="90%" id="S2.E4.m1.1.1.1.1.3.3.3.5" xref="S2.E4.m1.1.1.1.1.3.3.4.cmml">,</mo><mrow id="S2.E4.m1.1.1.1.1.2.2.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.2.cmml"><msub id="S2.E4.m1.1.1.1.1.2.2.2.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.cmml"><mover accent="true" id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">𝒉</mi><mo mathsize="90%" id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.1" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.2.2.2.2.2.3" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml">K</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.1.1.1.2.2.2.2.1" xref="S2.E4.m1.1.1.1.1.2.2.2.2.1.cmml">​</mo><msubsup id="S2.E4.m1.1.1.1.1.2.2.2.2.3" xref="S2.E4.m1.1.1.1.1.2.2.2.2.3.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.2.2.2.2.3.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.2.3.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.2.2.2.2.3.2.3" xref="S2.E4.m1.1.1.1.1.2.2.2.2.3.2.3.cmml">i</mi><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.2.2.2.2.3.3" xref="S2.E4.m1.1.1.1.1.2.2.2.2.3.3.cmml">K</mi></msubsup></mrow><mo mathsize="90%" id="S2.E4.m1.1.1.1.1.3.3.3.6" xref="S2.E4.m1.1.1.1.1.3.3.4.cmml">,</mo><mrow id="S2.E4.m1.1.1.1.1.3.3.3.3" xref="S2.E4.m1.1.1.1.1.3.3.3.3.cmml"><msub id="S2.E4.m1.1.1.1.1.3.3.3.3.2" xref="S2.E4.m1.1.1.1.1.3.3.3.3.2.cmml"><mover accent="true" id="S2.E4.m1.1.1.1.1.3.3.3.3.2.2" xref="S2.E4.m1.1.1.1.1.3.3.3.3.2.2.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.3.3.3.3.2.2.2" xref="S2.E4.m1.1.1.1.1.3.3.3.3.2.2.2.cmml">𝒉</mi><mo mathsize="90%" id="S2.E4.m1.1.1.1.1.3.3.3.3.2.2.1" xref="S2.E4.m1.1.1.1.1.3.3.3.3.2.2.1.cmml">^</mo></mover><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.3.3.3.3.2.3" xref="S2.E4.m1.1.1.1.1.3.3.3.3.2.3.cmml">V</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.1.1.1.1.3.3.3.3.1" xref="S2.E4.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><msubsup id="S2.E4.m1.1.1.1.1.3.3.3.3.3" xref="S2.E4.m1.1.1.1.1.3.3.3.3.3.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.3.3.3.3.3.2.2" xref="S2.E4.m1.1.1.1.1.3.3.3.3.3.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.3.3.3.3.3.2.3" xref="S2.E4.m1.1.1.1.1.3.3.3.3.3.2.3.cmml">i</mi><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.3.3.3.3.3.3" xref="S2.E4.m1.1.1.1.1.3.3.3.3.3.3.cmml">V</mi></msubsup></mrow><mo maxsize="90%" minsize="90%" id="S2.E4.m1.1.1.1.1.3.3.3.7" xref="S2.E4.m1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="S2.E4.m1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"><eq id="S2.E4.m1.1.1.1.1.4.cmml" xref="S2.E4.m1.1.1.1.1.4"></eq><apply id="S2.E4.m1.1.1.1.1.5.cmml" xref="S2.E4.m1.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.5.1.cmml" xref="S2.E4.m1.1.1.1.1.5">subscript</csymbol><apply id="S2.E4.m1.1.1.1.1.5.2.cmml" xref="S2.E4.m1.1.1.1.1.5.2"><ci id="S2.E4.m1.1.1.1.1.5.2.1.cmml" xref="S2.E4.m1.1.1.1.1.5.2.1">^</ci><ci id="S2.E4.m1.1.1.1.1.5.2.2.cmml" xref="S2.E4.m1.1.1.1.1.5.2.2">ℎ</ci></apply><ci id="S2.E4.m1.1.1.1.1.5.3.cmml" xref="S2.E4.m1.1.1.1.1.5.3">𝑖</ci></apply><apply id="S2.E4.m1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.3"><times id="S2.E4.m1.1.1.1.1.3.4.cmml" xref="S2.E4.m1.1.1.1.1.3.4"></times><ci id="S2.E4.m1.1.1.1.1.3.5.cmml" xref="S2.E4.m1.1.1.1.1.3.5">Attention</ci><vector id="S2.E4.m1.1.1.1.1.3.3.4.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3"><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1"><times id="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.2">𝒉</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.3">𝑄</ci></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.2.2">𝑾</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="S2.E4.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2"><times id="S2.E4.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.1"></times><apply id="S2.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2"><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.1">^</ci><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2">𝒉</ci></apply><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.3">𝐾</ci></apply><apply id="S2.E4.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.3">superscript</csymbol><apply id="S2.E4.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.2.2.2.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.3.2.2">𝑾</ci><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.3.3">𝐾</ci></apply></apply><apply id="S2.E4.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3"><times id="S2.E4.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.1"></times><apply id="S2.E4.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.3.3.3.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.2">subscript</csymbol><apply id="S2.E4.m1.1.1.1.1.3.3.3.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.2.2"><ci id="S2.E4.m1.1.1.1.1.3.3.3.3.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.2.2.1">^</ci><ci id="S2.E4.m1.1.1.1.1.3.3.3.3.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.2.2.2">𝒉</ci></apply><ci id="S2.E4.m1.1.1.1.1.3.3.3.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.2.3">𝑉</ci></apply><apply id="S2.E4.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.3.3.3.3.3.1.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.3">superscript</csymbol><apply id="S2.E4.m1.1.1.1.1.3.3.3.3.3.2.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.3.3.3.3.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.3.3.3.3.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.3.2.2">𝑾</ci><ci id="S2.E4.m1.1.1.1.1.3.3.3.3.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.3.2.3">𝑖</ci></apply><ci id="S2.E4.m1.1.1.1.1.3.3.3.3.3.3.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3.3.3.3">𝑉</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\hat{h}_{i}=\mathrm{Attention}(\bm{h}_{Q}\bm{W}_{i}^{Q},\hat{\bm{h}}_{K}\bm{W}_{i}^{K},\hat{\bm{h}}_{V}\bm{W}_{i}^{V}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.9" class="ltx_Math" alttext="\hat{\bm{h}}_{K}=\left[\bm{p}_{t}^{p,K}\oplus\bm{p}_{t}^{s,K};\bm{h}_{K}\right],\hat{\bm{h}}_{V}=\left[\bm{p}_{t}^{p,V}\oplus\bm{p}_{t}^{s,V};\bm{h}_{V}\right]." display="block"><semantics id="S2.E5.m1.9a"><mrow id="S2.E5.m1.9.9.1"><mrow id="S2.E5.m1.9.9.1.1.2" xref="S2.E5.m1.9.9.1.1.3.cmml"><mrow id="S2.E5.m1.9.9.1.1.1.1" xref="S2.E5.m1.9.9.1.1.1.1.cmml"><msub id="S2.E5.m1.9.9.1.1.1.1.4" xref="S2.E5.m1.9.9.1.1.1.1.4.cmml"><mover accent="true" id="S2.E5.m1.9.9.1.1.1.1.4.2" xref="S2.E5.m1.9.9.1.1.1.1.4.2.cmml"><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.4.2.2" xref="S2.E5.m1.9.9.1.1.1.1.4.2.2.cmml">𝒉</mi><mo mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.4.2.1" xref="S2.E5.m1.9.9.1.1.1.1.4.2.1.cmml">^</mo></mover><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.4.3" xref="S2.E5.m1.9.9.1.1.1.1.4.3.cmml">K</mi></msub><mo mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.3" xref="S2.E5.m1.9.9.1.1.1.1.3.cmml">=</mo><mrow id="S2.E5.m1.9.9.1.1.1.1.2.2" xref="S2.E5.m1.9.9.1.1.1.1.2.3.cmml"><mo id="S2.E5.m1.9.9.1.1.1.1.2.2.3" xref="S2.E5.m1.9.9.1.1.1.1.2.3.cmml">[</mo><mrow id="S2.E5.m1.9.9.1.1.1.1.1.1.1" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E5.m1.9.9.1.1.1.1.1.1.1.2" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.2.2" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.2.3" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mrow id="S2.E5.m1.2.2.2.4" xref="S2.E5.m1.2.2.2.3.cmml"><mi mathsize="90%" id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml">p</mi><mo mathsize="90%" id="S2.E5.m1.2.2.2.4.1" xref="S2.E5.m1.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.2.cmml">K</mi></mrow></msubsup><mo mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.1.1.1.1" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.1.cmml">⊕</mo><msubsup id="S2.E5.m1.9.9.1.1.1.1.1.1.1.3" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.2.2" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.2.3" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.2.3.cmml">t</mi><mrow id="S2.E5.m1.4.4.2.4" xref="S2.E5.m1.4.4.2.3.cmml"><mi mathsize="90%" id="S2.E5.m1.3.3.1.1" xref="S2.E5.m1.3.3.1.1.cmml">s</mi><mo mathsize="90%" id="S2.E5.m1.4.4.2.4.1" xref="S2.E5.m1.4.4.2.3.cmml">,</mo><mi mathsize="90%" id="S2.E5.m1.4.4.2.2" xref="S2.E5.m1.4.4.2.2.cmml">K</mi></mrow></msubsup></mrow><mo mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.2.2.4" xref="S2.E5.m1.9.9.1.1.1.1.2.3.cmml">;</mo><msub id="S2.E5.m1.9.9.1.1.1.1.2.2.2" xref="S2.E5.m1.9.9.1.1.1.1.2.2.2.cmml"><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.2.2.2.2" xref="S2.E5.m1.9.9.1.1.1.1.2.2.2.2.cmml">𝒉</mi><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.1.1.2.2.2.3" xref="S2.E5.m1.9.9.1.1.1.1.2.2.2.3.cmml">K</mi></msub><mo id="S2.E5.m1.9.9.1.1.1.1.2.2.5" xref="S2.E5.m1.9.9.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo mathsize="90%" id="S2.E5.m1.9.9.1.1.2.3" xref="S2.E5.m1.9.9.1.1.3a.cmml">,</mo><mrow id="S2.E5.m1.9.9.1.1.2.2" xref="S2.E5.m1.9.9.1.1.2.2.cmml"><msub id="S2.E5.m1.9.9.1.1.2.2.4" xref="S2.E5.m1.9.9.1.1.2.2.4.cmml"><mover accent="true" id="S2.E5.m1.9.9.1.1.2.2.4.2" xref="S2.E5.m1.9.9.1.1.2.2.4.2.cmml"><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.4.2.2" xref="S2.E5.m1.9.9.1.1.2.2.4.2.2.cmml">𝒉</mi><mo mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.4.2.1" xref="S2.E5.m1.9.9.1.1.2.2.4.2.1.cmml">^</mo></mover><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.4.3" xref="S2.E5.m1.9.9.1.1.2.2.4.3.cmml">V</mi></msub><mo mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.3" xref="S2.E5.m1.9.9.1.1.2.2.3.cmml">=</mo><mrow id="S2.E5.m1.9.9.1.1.2.2.2.2" xref="S2.E5.m1.9.9.1.1.2.2.2.3.cmml"><mo id="S2.E5.m1.9.9.1.1.2.2.2.2.3" xref="S2.E5.m1.9.9.1.1.2.2.2.3.cmml">[</mo><mrow id="S2.E5.m1.9.9.1.1.2.2.1.1.1" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.cmml"><msubsup id="S2.E5.m1.9.9.1.1.2.2.1.1.1.2" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.cmml"><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.2.2" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.2.3" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.2.3.cmml">t</mi><mrow id="S2.E5.m1.6.6.2.4" xref="S2.E5.m1.6.6.2.3.cmml"><mi mathsize="90%" id="S2.E5.m1.5.5.1.1" xref="S2.E5.m1.5.5.1.1.cmml">p</mi><mo mathsize="90%" id="S2.E5.m1.6.6.2.4.1" xref="S2.E5.m1.6.6.2.3.cmml">,</mo><mi mathsize="90%" id="S2.E5.m1.6.6.2.2" xref="S2.E5.m1.6.6.2.2.cmml">V</mi></mrow></msubsup><mo mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.1.1.1.1" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.1.cmml">⊕</mo><msubsup id="S2.E5.m1.9.9.1.1.2.2.1.1.1.3" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.cmml"><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.2.2" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.2.3" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.2.3.cmml">t</mi><mrow id="S2.E5.m1.8.8.2.4" xref="S2.E5.m1.8.8.2.3.cmml"><mi mathsize="90%" id="S2.E5.m1.7.7.1.1" xref="S2.E5.m1.7.7.1.1.cmml">s</mi><mo mathsize="90%" id="S2.E5.m1.8.8.2.4.1" xref="S2.E5.m1.8.8.2.3.cmml">,</mo><mi mathsize="90%" id="S2.E5.m1.8.8.2.2" xref="S2.E5.m1.8.8.2.2.cmml">V</mi></mrow></msubsup></mrow><mo mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.2.2.4" xref="S2.E5.m1.9.9.1.1.2.2.2.3.cmml">;</mo><msub id="S2.E5.m1.9.9.1.1.2.2.2.2.2" xref="S2.E5.m1.9.9.1.1.2.2.2.2.2.cmml"><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.2.2.2.2" xref="S2.E5.m1.9.9.1.1.2.2.2.2.2.2.cmml">𝒉</mi><mi mathsize="90%" id="S2.E5.m1.9.9.1.1.2.2.2.2.2.3" xref="S2.E5.m1.9.9.1.1.2.2.2.2.2.3.cmml">V</mi></msub><mo id="S2.E5.m1.9.9.1.1.2.2.2.2.5" xref="S2.E5.m1.9.9.1.1.2.2.2.3.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.E5.m1.9.9.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.9b"><apply id="S2.E5.m1.9.9.1.1.3.cmml" xref="S2.E5.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.3a.cmml" xref="S2.E5.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E5.m1.9.9.1.1.1.1.cmml" xref="S2.E5.m1.9.9.1.1.1.1"><eq id="S2.E5.m1.9.9.1.1.1.1.3.cmml" xref="S2.E5.m1.9.9.1.1.1.1.3"></eq><apply id="S2.E5.m1.9.9.1.1.1.1.4.cmml" xref="S2.E5.m1.9.9.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.1.1.4.1.cmml" xref="S2.E5.m1.9.9.1.1.1.1.4">subscript</csymbol><apply id="S2.E5.m1.9.9.1.1.1.1.4.2.cmml" xref="S2.E5.m1.9.9.1.1.1.1.4.2"><ci id="S2.E5.m1.9.9.1.1.1.1.4.2.1.cmml" xref="S2.E5.m1.9.9.1.1.1.1.4.2.1">^</ci><ci id="S2.E5.m1.9.9.1.1.1.1.4.2.2.cmml" xref="S2.E5.m1.9.9.1.1.1.1.4.2.2">𝒉</ci></apply><ci id="S2.E5.m1.9.9.1.1.1.1.4.3.cmml" xref="S2.E5.m1.9.9.1.1.1.1.4.3">𝐾</ci></apply><list id="S2.E5.m1.9.9.1.1.1.1.2.3.cmml" xref="S2.E5.m1.9.9.1.1.1.1.2.2"><apply id="S2.E5.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.1">direct-sum</csymbol><apply id="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.2.2">𝒑</ci><ci id="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><list id="S2.E5.m1.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.4"><ci id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1">𝑝</ci><ci id="S2.E5.m1.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2">𝐾</ci></list></apply><apply id="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.2.2">𝒑</ci><ci id="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E5.m1.9.9.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><list id="S2.E5.m1.4.4.2.3.cmml" xref="S2.E5.m1.4.4.2.4"><ci id="S2.E5.m1.3.3.1.1.cmml" xref="S2.E5.m1.3.3.1.1">𝑠</ci><ci id="S2.E5.m1.4.4.2.2.cmml" xref="S2.E5.m1.4.4.2.2">𝐾</ci></list></apply></apply><apply id="S2.E5.m1.9.9.1.1.1.1.2.2.2.cmml" xref="S2.E5.m1.9.9.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.1.1.2.2.2.1.cmml" xref="S2.E5.m1.9.9.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E5.m1.9.9.1.1.1.1.2.2.2.2.cmml" xref="S2.E5.m1.9.9.1.1.1.1.2.2.2.2">𝒉</ci><ci id="S2.E5.m1.9.9.1.1.1.1.2.2.2.3.cmml" xref="S2.E5.m1.9.9.1.1.1.1.2.2.2.3">𝐾</ci></apply></list></apply><apply id="S2.E5.m1.9.9.1.1.2.2.cmml" xref="S2.E5.m1.9.9.1.1.2.2"><eq id="S2.E5.m1.9.9.1.1.2.2.3.cmml" xref="S2.E5.m1.9.9.1.1.2.2.3"></eq><apply id="S2.E5.m1.9.9.1.1.2.2.4.cmml" xref="S2.E5.m1.9.9.1.1.2.2.4"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.2.2.4.1.cmml" xref="S2.E5.m1.9.9.1.1.2.2.4">subscript</csymbol><apply id="S2.E5.m1.9.9.1.1.2.2.4.2.cmml" xref="S2.E5.m1.9.9.1.1.2.2.4.2"><ci id="S2.E5.m1.9.9.1.1.2.2.4.2.1.cmml" xref="S2.E5.m1.9.9.1.1.2.2.4.2.1">^</ci><ci id="S2.E5.m1.9.9.1.1.2.2.4.2.2.cmml" xref="S2.E5.m1.9.9.1.1.2.2.4.2.2">𝒉</ci></apply><ci id="S2.E5.m1.9.9.1.1.2.2.4.3.cmml" xref="S2.E5.m1.9.9.1.1.2.2.4.3">𝑉</ci></apply><list id="S2.E5.m1.9.9.1.1.2.2.2.3.cmml" xref="S2.E5.m1.9.9.1.1.2.2.2.2"><apply id="S2.E5.m1.9.9.1.1.2.2.1.1.1.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.9.9.1.1.2.2.1.1.1.1.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.1">direct-sum</csymbol><apply id="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.1.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.2">superscript</csymbol><apply id="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.2.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.2.1.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.2.2.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.2.2">𝒑</ci><ci id="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.2.3.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.2.2.3">𝑡</ci></apply><list id="S2.E5.m1.6.6.2.3.cmml" xref="S2.E5.m1.6.6.2.4"><ci id="S2.E5.m1.5.5.1.1.cmml" xref="S2.E5.m1.5.5.1.1">𝑝</ci><ci id="S2.E5.m1.6.6.2.2.cmml" xref="S2.E5.m1.6.6.2.2">𝑉</ci></list></apply><apply id="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.1.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.3">superscript</csymbol><apply id="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.2.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.2.1.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.2.2.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.2.2">𝒑</ci><ci id="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.2.3.cmml" xref="S2.E5.m1.9.9.1.1.2.2.1.1.1.3.2.3">𝑡</ci></apply><list id="S2.E5.m1.8.8.2.3.cmml" xref="S2.E5.m1.8.8.2.4"><ci id="S2.E5.m1.7.7.1.1.cmml" xref="S2.E5.m1.7.7.1.1">𝑠</ci><ci id="S2.E5.m1.8.8.2.2.cmml" xref="S2.E5.m1.8.8.2.2">𝑉</ci></list></apply></apply><apply id="S2.E5.m1.9.9.1.1.2.2.2.2.2.cmml" xref="S2.E5.m1.9.9.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.9.9.1.1.2.2.2.2.2.1.cmml" xref="S2.E5.m1.9.9.1.1.2.2.2.2.2">subscript</csymbol><ci id="S2.E5.m1.9.9.1.1.2.2.2.2.2.2.cmml" xref="S2.E5.m1.9.9.1.1.2.2.2.2.2.2">𝒉</ci><ci id="S2.E5.m1.9.9.1.1.2.2.2.2.2.3.cmml" xref="S2.E5.m1.9.9.1.1.2.2.2.2.2.3">𝑉</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.9c">\hat{\bm{h}}_{K}=\left[\bm{p}_{t}^{p,K}\oplus\bm{p}_{t}^{s,K};\bm{h}_{K}\right],\hat{\bm{h}}_{V}=\left[\bm{p}_{t}^{p,V}\oplus\bm{p}_{t}^{s,V};\bm{h}_{V}\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p3.7" class="ltx_p"><span id="S2.SS2.p3.7.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.SS2.p3.3.m1.1" class="ltx_Math" alttext="\bm{W}^{O}" display="inline"><semantics id="S2.SS2.p3.3.m1.1a"><msup id="S2.SS2.p3.3.m1.1.1" xref="S2.SS2.p3.3.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p3.3.m1.1.1.2" xref="S2.SS2.p3.3.m1.1.1.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.SS2.p3.3.m1.1.1.3" xref="S2.SS2.p3.3.m1.1.1.3.cmml">O</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m1.1b"><apply id="S2.SS2.p3.3.m1.1.1.cmml" xref="S2.SS2.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m1.1.1.1.cmml" xref="S2.SS2.p3.3.m1.1.1">superscript</csymbol><ci id="S2.SS2.p3.3.m1.1.1.2.cmml" xref="S2.SS2.p3.3.m1.1.1.2">𝑾</ci><ci id="S2.SS2.p3.3.m1.1.1.3.cmml" xref="S2.SS2.p3.3.m1.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m1.1c">\bm{W}^{O}</annotation></semantics></math><span id="S2.SS2.p3.7.2" class="ltx_text" style="font-size:90%;">, </span><math id="S2.SS2.p3.4.m2.1" class="ltx_Math" alttext="\bm{W}_{i}^{Q}" display="inline"><semantics id="S2.SS2.p3.4.m2.1a"><msubsup id="S2.SS2.p3.4.m2.1.1" xref="S2.SS2.p3.4.m2.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p3.4.m2.1.1.2.2" xref="S2.SS2.p3.4.m2.1.1.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.SS2.p3.4.m2.1.1.2.3" xref="S2.SS2.p3.4.m2.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="S2.SS2.p3.4.m2.1.1.3" xref="S2.SS2.p3.4.m2.1.1.3.cmml">Q</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m2.1b"><apply id="S2.SS2.p3.4.m2.1.1.cmml" xref="S2.SS2.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.4.m2.1.1.1.cmml" xref="S2.SS2.p3.4.m2.1.1">superscript</csymbol><apply id="S2.SS2.p3.4.m2.1.1.2.cmml" xref="S2.SS2.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.4.m2.1.1.2.1.cmml" xref="S2.SS2.p3.4.m2.1.1">subscript</csymbol><ci id="S2.SS2.p3.4.m2.1.1.2.2.cmml" xref="S2.SS2.p3.4.m2.1.1.2.2">𝑾</ci><ci id="S2.SS2.p3.4.m2.1.1.2.3.cmml" xref="S2.SS2.p3.4.m2.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.p3.4.m2.1.1.3.cmml" xref="S2.SS2.p3.4.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m2.1c">\bm{W}_{i}^{Q}</annotation></semantics></math><span id="S2.SS2.p3.7.3" class="ltx_text" style="font-size:90%;">, </span><math id="S2.SS2.p3.5.m3.1" class="ltx_Math" alttext="\bm{W}_{i}^{K}" display="inline"><semantics id="S2.SS2.p3.5.m3.1a"><msubsup id="S2.SS2.p3.5.m3.1.1" xref="S2.SS2.p3.5.m3.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p3.5.m3.1.1.2.2" xref="S2.SS2.p3.5.m3.1.1.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.SS2.p3.5.m3.1.1.2.3" xref="S2.SS2.p3.5.m3.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="S2.SS2.p3.5.m3.1.1.3" xref="S2.SS2.p3.5.m3.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m3.1b"><apply id="S2.SS2.p3.5.m3.1.1.cmml" xref="S2.SS2.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m3.1.1.1.cmml" xref="S2.SS2.p3.5.m3.1.1">superscript</csymbol><apply id="S2.SS2.p3.5.m3.1.1.2.cmml" xref="S2.SS2.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m3.1.1.2.1.cmml" xref="S2.SS2.p3.5.m3.1.1">subscript</csymbol><ci id="S2.SS2.p3.5.m3.1.1.2.2.cmml" xref="S2.SS2.p3.5.m3.1.1.2.2">𝑾</ci><ci id="S2.SS2.p3.5.m3.1.1.2.3.cmml" xref="S2.SS2.p3.5.m3.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.p3.5.m3.1.1.3.cmml" xref="S2.SS2.p3.5.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m3.1c">\bm{W}_{i}^{K}</annotation></semantics></math><span id="S2.SS2.p3.7.4" class="ltx_text" style="font-size:90%;"> and </span><math id="S2.SS2.p3.6.m4.1" class="ltx_Math" alttext="\bm{W}_{i}^{K}" display="inline"><semantics id="S2.SS2.p3.6.m4.1a"><msubsup id="S2.SS2.p3.6.m4.1.1" xref="S2.SS2.p3.6.m4.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p3.6.m4.1.1.2.2" xref="S2.SS2.p3.6.m4.1.1.2.2.cmml">𝑾</mi><mi mathsize="90%" id="S2.SS2.p3.6.m4.1.1.2.3" xref="S2.SS2.p3.6.m4.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="S2.SS2.p3.6.m4.1.1.3" xref="S2.SS2.p3.6.m4.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.6.m4.1b"><apply id="S2.SS2.p3.6.m4.1.1.cmml" xref="S2.SS2.p3.6.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m4.1.1.1.cmml" xref="S2.SS2.p3.6.m4.1.1">superscript</csymbol><apply id="S2.SS2.p3.6.m4.1.1.2.cmml" xref="S2.SS2.p3.6.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m4.1.1.2.1.cmml" xref="S2.SS2.p3.6.m4.1.1">subscript</csymbol><ci id="S2.SS2.p3.6.m4.1.1.2.2.cmml" xref="S2.SS2.p3.6.m4.1.1.2.2">𝑾</ci><ci id="S2.SS2.p3.6.m4.1.1.2.3.cmml" xref="S2.SS2.p3.6.m4.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.p3.6.m4.1.1.3.cmml" xref="S2.SS2.p3.6.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.6.m4.1c">\bm{W}_{i}^{K}</annotation></semantics></math><span id="S2.SS2.p3.7.5" class="ltx_text" style="font-size:90%;"> are the parameter matrices of the transformer, and </span><math id="S2.SS2.p3.7.m5.1" class="ltx_Math" alttext="\mathrm{Attention}(\cdot)" display="inline"><semantics id="S2.SS2.p3.7.m5.1a"><mrow id="S2.SS2.p3.7.m5.1.2" xref="S2.SS2.p3.7.m5.1.2.cmml"><mi mathsize="90%" id="S2.SS2.p3.7.m5.1.2.2" xref="S2.SS2.p3.7.m5.1.2.2.cmml">Attention</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.7.m5.1.2.1" xref="S2.SS2.p3.7.m5.1.2.1.cmml">​</mo><mrow id="S2.SS2.p3.7.m5.1.2.3.2" xref="S2.SS2.p3.7.m5.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS2.p3.7.m5.1.2.3.2.1" xref="S2.SS2.p3.7.m5.1.2.cmml">(</mo><mo lspace="0em" mathsize="90%" rspace="0em" id="S2.SS2.p3.7.m5.1.1" xref="S2.SS2.p3.7.m5.1.1.cmml">⋅</mo><mo maxsize="90%" minsize="90%" id="S2.SS2.p3.7.m5.1.2.3.2.2" xref="S2.SS2.p3.7.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.7.m5.1b"><apply id="S2.SS2.p3.7.m5.1.2.cmml" xref="S2.SS2.p3.7.m5.1.2"><times id="S2.SS2.p3.7.m5.1.2.1.cmml" xref="S2.SS2.p3.7.m5.1.2.1"></times><ci id="S2.SS2.p3.7.m5.1.2.2.cmml" xref="S2.SS2.p3.7.m5.1.2.2">Attention</ci><ci id="S2.SS2.p3.7.m5.1.1.cmml" xref="S2.SS2.p3.7.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.7.m5.1c">\mathrm{Attention}(\cdot)</annotation></semantics></math><span id="S2.SS2.p3.7.6" class="ltx_text" style="font-size:90%;"> is the self-attention.
Moreover, we merge the original mask of the MHA layer with a all-ones matrix as the new mask to ensure that each block can refer to all the prompts during the self-attention process. In particular, we do not add the location information for the prompts because they are introduced directly as parameters.</span></p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.3" class="ltx_p"><span id="S2.SS2.p4.3.1" class="ltx_text" style="font-size:90%;">The outputs of the last pRA block of the image encoder and the text encoder are the image and language features of the input image </span><math id="S2.SS2.p4.1.m1.1" class="ltx_Math" alttext="I_{t}^{j}" display="inline"><semantics id="S2.SS2.p4.1.m1.1a"><msubsup id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p4.1.m1.1.1.2.2" xref="S2.SS2.p4.1.m1.1.1.2.2.cmml">I</mi><mi mathsize="90%" id="S2.SS2.p4.1.m1.1.1.2.3" xref="S2.SS2.p4.1.m1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p4.1.m1.1.1.3" xref="S2.SS2.p4.1.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><apply id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">superscript</csymbol><apply id="S2.SS2.p4.1.m1.1.1.2.cmml" xref="S2.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.1.1.2.1.cmml" xref="S2.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p4.1.m1.1.1.2.2.cmml" xref="S2.SS2.p4.1.m1.1.1.2.2">𝐼</ci><ci id="S2.SS2.p4.1.m1.1.1.2.3.cmml" xref="S2.SS2.p4.1.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p4.1.m1.1.1.3.cmml" xref="S2.SS2.p4.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">I_{t}^{j}</annotation></semantics></math><span id="S2.SS2.p4.3.2" class="ltx_text" style="font-size:90%;"> and question </span><math id="S2.SS2.p4.2.m2.1" class="ltx_Math" alttext="Q_{t}^{j}" display="inline"><semantics id="S2.SS2.p4.2.m2.1a"><msubsup id="S2.SS2.p4.2.m2.1.1" xref="S2.SS2.p4.2.m2.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p4.2.m2.1.1.2.2" xref="S2.SS2.p4.2.m2.1.1.2.2.cmml">Q</mi><mi mathsize="90%" id="S2.SS2.p4.2.m2.1.1.2.3" xref="S2.SS2.p4.2.m2.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p4.2.m2.1.1.3" xref="S2.SS2.p4.2.m2.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m2.1b"><apply id="S2.SS2.p4.2.m2.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.1.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1">superscript</csymbol><apply id="S2.SS2.p4.2.m2.1.1.2.cmml" xref="S2.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.1.1.2.1.cmml" xref="S2.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p4.2.m2.1.1.2.2.cmml" xref="S2.SS2.p4.2.m2.1.1.2.2">𝑄</ci><ci id="S2.SS2.p4.2.m2.1.1.2.3.cmml" xref="S2.SS2.p4.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p4.2.m2.1.1.3.cmml" xref="S2.SS2.p4.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m2.1c">Q_{t}^{j}</annotation></semantics></math><span id="S2.SS2.p4.3.3" class="ltx_text" style="font-size:90%;">. Next, the extracted features are joined and input into the personalized answer layer consisting of an MLP to output the probabilities of the predicted answer </span><math id="S2.SS2.p4.3.m3.1" class="ltx_Math" alttext="{\hat{A}_{t}^{j}}" display="inline"><semantics id="S2.SS2.p4.3.m3.1a"><msubsup id="S2.SS2.p4.3.m3.1.1" xref="S2.SS2.p4.3.m3.1.1.cmml"><mover accent="true" id="S2.SS2.p4.3.m3.1.1.2.2" xref="S2.SS2.p4.3.m3.1.1.2.2.cmml"><mi mathsize="90%" id="S2.SS2.p4.3.m3.1.1.2.2.2" xref="S2.SS2.p4.3.m3.1.1.2.2.2.cmml">A</mi><mo mathsize="90%" id="S2.SS2.p4.3.m3.1.1.2.2.1" xref="S2.SS2.p4.3.m3.1.1.2.2.1.cmml">^</mo></mover><mi mathsize="90%" id="S2.SS2.p4.3.m3.1.1.2.3" xref="S2.SS2.p4.3.m3.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p4.3.m3.1.1.3" xref="S2.SS2.p4.3.m3.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.3.m3.1b"><apply id="S2.SS2.p4.3.m3.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.3.m3.1.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1">superscript</csymbol><apply id="S2.SS2.p4.3.m3.1.1.2.cmml" xref="S2.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.3.m3.1.1.2.1.cmml" xref="S2.SS2.p4.3.m3.1.1">subscript</csymbol><apply id="S2.SS2.p4.3.m3.1.1.2.2.cmml" xref="S2.SS2.p4.3.m3.1.1.2.2"><ci id="S2.SS2.p4.3.m3.1.1.2.2.1.cmml" xref="S2.SS2.p4.3.m3.1.1.2.2.1">^</ci><ci id="S2.SS2.p4.3.m3.1.1.2.2.2.cmml" xref="S2.SS2.p4.3.m3.1.1.2.2.2">𝐴</ci></apply><ci id="S2.SS2.p4.3.m3.1.1.2.3.cmml" xref="S2.SS2.p4.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p4.3.m3.1.1.3.cmml" xref="S2.SS2.p4.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.3.m3.1c">{\hat{A}_{t}^{j}}</annotation></semantics></math><span id="S2.SS2.p4.3.4" class="ltx_text" style="font-size:90%;">.
We employ the cross-entropy loss to train the model, which can be calculated as</span></p>
<table id="S2.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E6.m1.2" class="ltx_Math" alttext="\mathcal{L}_{CE}=-\sum_{j=1}^{N_{t}}A_{t}^{j}\log(\hat{A}_{t}^{j})." display="block"><semantics id="S2.E6.m1.2a"><mrow id="S2.E6.m1.2.2.1" xref="S2.E6.m1.2.2.1.1.cmml"><mrow id="S2.E6.m1.2.2.1.1" xref="S2.E6.m1.2.2.1.1.cmml"><msub id="S2.E6.m1.2.2.1.1.3" xref="S2.E6.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E6.m1.2.2.1.1.3.2" xref="S2.E6.m1.2.2.1.1.3.2.cmml">ℒ</mi><mrow id="S2.E6.m1.2.2.1.1.3.3" xref="S2.E6.m1.2.2.1.1.3.3.cmml"><mi mathsize="90%" id="S2.E6.m1.2.2.1.1.3.3.2" xref="S2.E6.m1.2.2.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.2.2.1.1.3.3.1" xref="S2.E6.m1.2.2.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E6.m1.2.2.1.1.3.3.3" xref="S2.E6.m1.2.2.1.1.3.3.3.cmml">E</mi></mrow></msub><mo mathsize="90%" id="S2.E6.m1.2.2.1.1.2" xref="S2.E6.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E6.m1.2.2.1.1.1" xref="S2.E6.m1.2.2.1.1.1.cmml"><mo mathsize="90%" id="S2.E6.m1.2.2.1.1.1a" xref="S2.E6.m1.2.2.1.1.1.cmml">−</mo><mrow id="S2.E6.m1.2.2.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.cmml"><munderover id="S2.E6.m1.2.2.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E6.m1.2.2.1.1.1.1.2.2.2" xref="S2.E6.m1.2.2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.2.2.3" xref="S2.E6.m1.2.2.1.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.2.2.3.2" xref="S2.E6.m1.2.2.1.1.1.1.2.2.3.2.cmml">j</mi><mo mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.2.2.3.1" xref="S2.E6.m1.2.2.1.1.1.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.2.2.3.3" xref="S2.E6.m1.2.2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.E6.m1.2.2.1.1.1.1.2.3" xref="S2.E6.m1.2.2.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.2.3.2" xref="S2.E6.m1.2.2.1.1.1.1.2.3.2.cmml">N</mi><mi mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.2.3.3" xref="S2.E6.m1.2.2.1.1.1.1.2.3.3.cmml">t</mi></msub></munderover><mrow id="S2.E6.m1.2.2.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.cmml"><msubsup id="S2.E6.m1.2.2.1.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.1.3.2.2" xref="S2.E6.m1.2.2.1.1.1.1.1.3.2.2.cmml">A</mi><mi mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.1.3.2.3" xref="S2.E6.m1.2.2.1.1.1.1.1.3.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.1.3.3" xref="S2.E6.m1.2.2.1.1.1.1.1.3.3.cmml">j</mi></msubsup><mo lspace="0.167em" rspace="0em" id="S2.E6.m1.2.2.1.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">log</mi><mo id="S2.E6.m1.2.2.1.1.1.1.1.1.1a" xref="S2.E6.m1.2.2.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">A</mi><mo mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo maxsize="90%" minsize="90%" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.E6.m1.2.2.1.2" xref="S2.E6.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.2b"><apply id="S2.E6.m1.2.2.1.1.cmml" xref="S2.E6.m1.2.2.1"><eq id="S2.E6.m1.2.2.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.2"></eq><apply id="S2.E6.m1.2.2.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.3.1.cmml" xref="S2.E6.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.3.2.cmml" xref="S2.E6.m1.2.2.1.1.3.2">ℒ</ci><apply id="S2.E6.m1.2.2.1.1.3.3.cmml" xref="S2.E6.m1.2.2.1.1.3.3"><times id="S2.E6.m1.2.2.1.1.3.3.1.cmml" xref="S2.E6.m1.2.2.1.1.3.3.1"></times><ci id="S2.E6.m1.2.2.1.1.3.3.2.cmml" xref="S2.E6.m1.2.2.1.1.3.3.2">𝐶</ci><ci id="S2.E6.m1.2.2.1.1.3.3.3.cmml" xref="S2.E6.m1.2.2.1.1.3.3.3">𝐸</ci></apply></apply><apply id="S2.E6.m1.2.2.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1"><minus id="S2.E6.m1.2.2.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1"></minus><apply id="S2.E6.m1.2.2.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1"><apply id="S2.E6.m1.2.2.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S2.E6.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S2.E6.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.2.2"></sum><apply id="S2.E6.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.2.3"><eq id="S2.E6.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.2.3.1"></eq><ci id="S2.E6.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S2.E6.m1.2.2.1.1.1.1.2.2.3.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E6.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.3.2">𝑁</ci><ci id="S2.E6.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S2.E6.m1.2.2.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1"><times id="S2.E6.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2"></times><apply id="S2.E6.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E6.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.3.2.2">𝐴</ci><ci id="S2.E6.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S2.E6.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.3.3">𝑗</ci></apply><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1"><log id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1"></log><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2"><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">𝐴</ci></apply><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.2c">\mathcal{L}_{CE}=-\sum_{j=1}^{N_{t}}A_{t}^{j}\log(\hat{A}_{t}^{j}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p4.9" class="ltx_p"><span id="S2.SS2.p4.9.1" class="ltx_text" style="font-size:90%;">Moreover, to prevent heterogeneity between local and shared prompts leading to degradation of the results, we also introduce the following loss to control the distance between the two prompts:</span></p>
<table id="S2.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E7.m1.3" class="ltx_Math" alttext="\mathcal{L}_{d}=1-\frac{\bm{p}_{t}^{p}\cdot\bm{p}_{t}^{s}}{\|\bm{p}_{t}^{p}\|_{2}\times\|\bm{p}_{t}^{s}\|_{2}}," display="block"><semantics id="S2.E7.m1.3a"><mrow id="S2.E7.m1.3.3.1" xref="S2.E7.m1.3.3.1.1.cmml"><mrow id="S2.E7.m1.3.3.1.1" xref="S2.E7.m1.3.3.1.1.cmml"><msub id="S2.E7.m1.3.3.1.1.2" xref="S2.E7.m1.3.3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E7.m1.3.3.1.1.2.2" xref="S2.E7.m1.3.3.1.1.2.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.E7.m1.3.3.1.1.2.3" xref="S2.E7.m1.3.3.1.1.2.3.cmml">d</mi></msub><mo mathsize="90%" id="S2.E7.m1.3.3.1.1.1" xref="S2.E7.m1.3.3.1.1.1.cmml">=</mo><mrow id="S2.E7.m1.3.3.1.1.3" xref="S2.E7.m1.3.3.1.1.3.cmml"><mn mathsize="90%" id="S2.E7.m1.3.3.1.1.3.2" xref="S2.E7.m1.3.3.1.1.3.2.cmml">1</mn><mo mathsize="90%" id="S2.E7.m1.3.3.1.1.3.1" xref="S2.E7.m1.3.3.1.1.3.1.cmml">−</mo><mfrac id="S2.E7.m1.2.2" xref="S2.E7.m1.2.2.cmml"><mrow id="S2.E7.m1.2.2.4" xref="S2.E7.m1.2.2.4.cmml"><msubsup id="S2.E7.m1.2.2.4.2" xref="S2.E7.m1.2.2.4.2.cmml"><mi mathsize="90%" id="S2.E7.m1.2.2.4.2.2.2" xref="S2.E7.m1.2.2.4.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E7.m1.2.2.4.2.2.3" xref="S2.E7.m1.2.2.4.2.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E7.m1.2.2.4.2.3" xref="S2.E7.m1.2.2.4.2.3.cmml">p</mi></msubsup><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.E7.m1.2.2.4.1" xref="S2.E7.m1.2.2.4.1.cmml">⋅</mo><msubsup id="S2.E7.m1.2.2.4.3" xref="S2.E7.m1.2.2.4.3.cmml"><mi mathsize="90%" id="S2.E7.m1.2.2.4.3.2.2" xref="S2.E7.m1.2.2.4.3.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E7.m1.2.2.4.3.2.3" xref="S2.E7.m1.2.2.4.3.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E7.m1.2.2.4.3.3" xref="S2.E7.m1.2.2.4.3.3.cmml">s</mi></msubsup></mrow><mrow id="S2.E7.m1.2.2.2" xref="S2.E7.m1.2.2.2.cmml"><msub id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml"><mrow id="S2.E7.m1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E7.m1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S2.E7.m1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E7.m1.1.1.1.1.1.1.1.2.2" xref="S2.E7.m1.1.1.1.1.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E7.m1.1.1.1.1.1.1.1.2.3" xref="S2.E7.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E7.m1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.1.3.cmml">p</mi></msubsup><mo maxsize="90%" minsize="90%" id="S2.E7.m1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S2.E7.m1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.3.cmml">2</mn></msub><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.E7.m1.2.2.2.3" xref="S2.E7.m1.2.2.2.3.cmml">×</mo><msub id="S2.E7.m1.2.2.2.2" xref="S2.E7.m1.2.2.2.2.cmml"><mrow id="S2.E7.m1.2.2.2.2.1.1" xref="S2.E7.m1.2.2.2.2.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E7.m1.2.2.2.2.1.1.2" xref="S2.E7.m1.2.2.2.2.1.2.1.cmml">‖</mo><msubsup id="S2.E7.m1.2.2.2.2.1.1.1" xref="S2.E7.m1.2.2.2.2.1.1.1.cmml"><mi mathsize="90%" id="S2.E7.m1.2.2.2.2.1.1.1.2.2" xref="S2.E7.m1.2.2.2.2.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E7.m1.2.2.2.2.1.1.1.2.3" xref="S2.E7.m1.2.2.2.2.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E7.m1.2.2.2.2.1.1.1.3" xref="S2.E7.m1.2.2.2.2.1.1.1.3.cmml">s</mi></msubsup><mo maxsize="90%" minsize="90%" id="S2.E7.m1.2.2.2.2.1.1.3" xref="S2.E7.m1.2.2.2.2.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S2.E7.m1.2.2.2.2.3" xref="S2.E7.m1.2.2.2.2.3.cmml">2</mn></msub></mrow></mfrac></mrow></mrow><mo mathsize="90%" id="S2.E7.m1.3.3.1.2" xref="S2.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.3b"><apply id="S2.E7.m1.3.3.1.1.cmml" xref="S2.E7.m1.3.3.1"><eq id="S2.E7.m1.3.3.1.1.1.cmml" xref="S2.E7.m1.3.3.1.1.1"></eq><apply id="S2.E7.m1.3.3.1.1.2.cmml" xref="S2.E7.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.3.3.1.1.2.1.cmml" xref="S2.E7.m1.3.3.1.1.2">subscript</csymbol><ci id="S2.E7.m1.3.3.1.1.2.2.cmml" xref="S2.E7.m1.3.3.1.1.2.2">ℒ</ci><ci id="S2.E7.m1.3.3.1.1.2.3.cmml" xref="S2.E7.m1.3.3.1.1.2.3">𝑑</ci></apply><apply id="S2.E7.m1.3.3.1.1.3.cmml" xref="S2.E7.m1.3.3.1.1.3"><minus id="S2.E7.m1.3.3.1.1.3.1.cmml" xref="S2.E7.m1.3.3.1.1.3.1"></minus><cn type="integer" id="S2.E7.m1.3.3.1.1.3.2.cmml" xref="S2.E7.m1.3.3.1.1.3.2">1</cn><apply id="S2.E7.m1.2.2.cmml" xref="S2.E7.m1.2.2"><divide id="S2.E7.m1.2.2.3.cmml" xref="S2.E7.m1.2.2"></divide><apply id="S2.E7.m1.2.2.4.cmml" xref="S2.E7.m1.2.2.4"><ci id="S2.E7.m1.2.2.4.1.cmml" xref="S2.E7.m1.2.2.4.1">⋅</ci><apply id="S2.E7.m1.2.2.4.2.cmml" xref="S2.E7.m1.2.2.4.2"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.4.2.1.cmml" xref="S2.E7.m1.2.2.4.2">superscript</csymbol><apply id="S2.E7.m1.2.2.4.2.2.cmml" xref="S2.E7.m1.2.2.4.2"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.4.2.2.1.cmml" xref="S2.E7.m1.2.2.4.2">subscript</csymbol><ci id="S2.E7.m1.2.2.4.2.2.2.cmml" xref="S2.E7.m1.2.2.4.2.2.2">𝒑</ci><ci id="S2.E7.m1.2.2.4.2.2.3.cmml" xref="S2.E7.m1.2.2.4.2.2.3">𝑡</ci></apply><ci id="S2.E7.m1.2.2.4.2.3.cmml" xref="S2.E7.m1.2.2.4.2.3">𝑝</ci></apply><apply id="S2.E7.m1.2.2.4.3.cmml" xref="S2.E7.m1.2.2.4.3"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.4.3.1.cmml" xref="S2.E7.m1.2.2.4.3">superscript</csymbol><apply id="S2.E7.m1.2.2.4.3.2.cmml" xref="S2.E7.m1.2.2.4.3"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.4.3.2.1.cmml" xref="S2.E7.m1.2.2.4.3">subscript</csymbol><ci id="S2.E7.m1.2.2.4.3.2.2.cmml" xref="S2.E7.m1.2.2.4.3.2.2">𝒑</ci><ci id="S2.E7.m1.2.2.4.3.2.3.cmml" xref="S2.E7.m1.2.2.4.3.2.3">𝑡</ci></apply><ci id="S2.E7.m1.2.2.4.3.3.cmml" xref="S2.E7.m1.2.2.4.3.3">𝑠</ci></apply></apply><apply id="S2.E7.m1.2.2.2.cmml" xref="S2.E7.m1.2.2.2"><times id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.3"></times><apply id="S2.E7.m1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1">subscript</csymbol><apply id="S2.E7.m1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E7.m1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.2.2">𝒑</ci><ci id="S2.E7.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.3">𝑝</ci></apply></apply><cn type="integer" id="S2.E7.m1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.3">2</cn></apply><apply id="S2.E7.m1.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2">subscript</csymbol><apply id="S2.E7.m1.2.2.2.2.1.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="S2.E7.m1.2.2.2.2.1.2.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.2">norm</csymbol><apply id="S2.E7.m1.2.2.2.2.1.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1">superscript</csymbol><apply id="S2.E7.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E7.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.2.2">𝒑</ci><ci id="S2.E7.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.2.3">𝑡</ci></apply><ci id="S2.E7.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1.3">𝑠</ci></apply></apply><cn type="integer" id="S2.E7.m1.2.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.2.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.3c">\mathcal{L}_{d}=1-\frac{\bm{p}_{t}^{p}\cdot\bm{p}_{t}^{s}}{\|\bm{p}_{t}^{p}\|_{2}\times\|\bm{p}_{t}^{s}\|_{2}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p4.7" class="ltx_p"><span id="S2.SS2.p4.7.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.SS2.p4.4.m1.1" class="ltx_Math" alttext="\|\bm{p}_{t}^{p}\|_{2}" display="inline"><semantics id="S2.SS2.p4.4.m1.1a"><msub id="S2.SS2.p4.4.m1.1.1" xref="S2.SS2.p4.4.m1.1.1.cmml"><mrow id="S2.SS2.p4.4.m1.1.1.1.1" xref="S2.SS2.p4.4.m1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS2.p4.4.m1.1.1.1.1.2" xref="S2.SS2.p4.4.m1.1.1.1.2.1.cmml">‖</mo><msubsup id="S2.SS2.p4.4.m1.1.1.1.1.1" xref="S2.SS2.p4.4.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p4.4.m1.1.1.1.1.1.2.2" xref="S2.SS2.p4.4.m1.1.1.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p4.4.m1.1.1.1.1.1.2.3" xref="S2.SS2.p4.4.m1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p4.4.m1.1.1.1.1.1.3" xref="S2.SS2.p4.4.m1.1.1.1.1.1.3.cmml">p</mi></msubsup><mo maxsize="90%" minsize="90%" id="S2.SS2.p4.4.m1.1.1.1.1.3" xref="S2.SS2.p4.4.m1.1.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S2.SS2.p4.4.m1.1.1.3" xref="S2.SS2.p4.4.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.4.m1.1b"><apply id="S2.SS2.p4.4.m1.1.1.cmml" xref="S2.SS2.p4.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m1.1.1.2.cmml" xref="S2.SS2.p4.4.m1.1.1">subscript</csymbol><apply id="S2.SS2.p4.4.m1.1.1.1.2.cmml" xref="S2.SS2.p4.4.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p4.4.m1.1.1.1.2.1.cmml" xref="S2.SS2.p4.4.m1.1.1.1.1.2">norm</csymbol><apply id="S2.SS2.p4.4.m1.1.1.1.1.1.cmml" xref="S2.SS2.p4.4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.4.m1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p4.4.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p4.4.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p4.4.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p4.4.m1.1.1.1.1.1.2.2">𝒑</ci><ci id="S2.SS2.p4.4.m1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p4.4.m1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p4.4.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.4.m1.1.1.1.1.1.3">𝑝</ci></apply></apply><cn type="integer" id="S2.SS2.p4.4.m1.1.1.3.cmml" xref="S2.SS2.p4.4.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.4.m1.1c">\|\bm{p}_{t}^{p}\|_{2}</annotation></semantics></math><span id="S2.SS2.p4.7.2" class="ltx_text" style="font-size:90%;"> and </span><math id="S2.SS2.p4.5.m2.1" class="ltx_Math" alttext="\|\bm{p}_{t}^{s}\|_{2}" display="inline"><semantics id="S2.SS2.p4.5.m2.1a"><msub id="S2.SS2.p4.5.m2.1.1" xref="S2.SS2.p4.5.m2.1.1.cmml"><mrow id="S2.SS2.p4.5.m2.1.1.1.1" xref="S2.SS2.p4.5.m2.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS2.p4.5.m2.1.1.1.1.2" xref="S2.SS2.p4.5.m2.1.1.1.2.1.cmml">‖</mo><msubsup id="S2.SS2.p4.5.m2.1.1.1.1.1" xref="S2.SS2.p4.5.m2.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p4.5.m2.1.1.1.1.1.2.2" xref="S2.SS2.p4.5.m2.1.1.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p4.5.m2.1.1.1.1.1.2.3" xref="S2.SS2.p4.5.m2.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p4.5.m2.1.1.1.1.1.3" xref="S2.SS2.p4.5.m2.1.1.1.1.1.3.cmml">s</mi></msubsup><mo maxsize="90%" minsize="90%" id="S2.SS2.p4.5.m2.1.1.1.1.3" xref="S2.SS2.p4.5.m2.1.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S2.SS2.p4.5.m2.1.1.3" xref="S2.SS2.p4.5.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.5.m2.1b"><apply id="S2.SS2.p4.5.m2.1.1.cmml" xref="S2.SS2.p4.5.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.5.m2.1.1.2.cmml" xref="S2.SS2.p4.5.m2.1.1">subscript</csymbol><apply id="S2.SS2.p4.5.m2.1.1.1.2.cmml" xref="S2.SS2.p4.5.m2.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p4.5.m2.1.1.1.2.1.cmml" xref="S2.SS2.p4.5.m2.1.1.1.1.2">norm</csymbol><apply id="S2.SS2.p4.5.m2.1.1.1.1.1.cmml" xref="S2.SS2.p4.5.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.5.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.5.m2.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p4.5.m2.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.5.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.5.m2.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p4.5.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p4.5.m2.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p4.5.m2.1.1.1.1.1.2.2">𝒑</ci><ci id="S2.SS2.p4.5.m2.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p4.5.m2.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p4.5.m2.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.5.m2.1.1.1.1.1.3">𝑠</ci></apply></apply><cn type="integer" id="S2.SS2.p4.5.m2.1.1.3.cmml" xref="S2.SS2.p4.5.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.5.m2.1c">\|\bm{p}_{t}^{s}\|_{2}</annotation></semantics></math><span id="S2.SS2.p4.7.3" class="ltx_text" style="font-size:90%;"> are the L2 norms of the </span><math id="S2.SS2.p4.6.m3.1" class="ltx_Math" alttext="\bm{p}_{t}^{p}" display="inline"><semantics id="S2.SS2.p4.6.m3.1a"><msubsup id="S2.SS2.p4.6.m3.1.1" xref="S2.SS2.p4.6.m3.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p4.6.m3.1.1.2.2" xref="S2.SS2.p4.6.m3.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p4.6.m3.1.1.2.3" xref="S2.SS2.p4.6.m3.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p4.6.m3.1.1.3" xref="S2.SS2.p4.6.m3.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.6.m3.1b"><apply id="S2.SS2.p4.6.m3.1.1.cmml" xref="S2.SS2.p4.6.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.6.m3.1.1.1.cmml" xref="S2.SS2.p4.6.m3.1.1">superscript</csymbol><apply id="S2.SS2.p4.6.m3.1.1.2.cmml" xref="S2.SS2.p4.6.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.6.m3.1.1.2.1.cmml" xref="S2.SS2.p4.6.m3.1.1">subscript</csymbol><ci id="S2.SS2.p4.6.m3.1.1.2.2.cmml" xref="S2.SS2.p4.6.m3.1.1.2.2">𝒑</ci><ci id="S2.SS2.p4.6.m3.1.1.2.3.cmml" xref="S2.SS2.p4.6.m3.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p4.6.m3.1.1.3.cmml" xref="S2.SS2.p4.6.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.6.m3.1c">\bm{p}_{t}^{p}</annotation></semantics></math><span id="S2.SS2.p4.7.4" class="ltx_text" style="font-size:90%;"> and </span><math id="S2.SS2.p4.7.m4.1" class="ltx_Math" alttext="\bm{p}_{t}^{s}" display="inline"><semantics id="S2.SS2.p4.7.m4.1a"><msubsup id="S2.SS2.p4.7.m4.1.1" xref="S2.SS2.p4.7.m4.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p4.7.m4.1.1.2.2" xref="S2.SS2.p4.7.m4.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS2.p4.7.m4.1.1.2.3" xref="S2.SS2.p4.7.m4.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p4.7.m4.1.1.3" xref="S2.SS2.p4.7.m4.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.7.m4.1b"><apply id="S2.SS2.p4.7.m4.1.1.cmml" xref="S2.SS2.p4.7.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.7.m4.1.1.1.cmml" xref="S2.SS2.p4.7.m4.1.1">superscript</csymbol><apply id="S2.SS2.p4.7.m4.1.1.2.cmml" xref="S2.SS2.p4.7.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.7.m4.1.1.2.1.cmml" xref="S2.SS2.p4.7.m4.1.1">subscript</csymbol><ci id="S2.SS2.p4.7.m4.1.1.2.2.cmml" xref="S2.SS2.p4.7.m4.1.1.2.2">𝒑</ci><ci id="S2.SS2.p4.7.m4.1.1.2.3.cmml" xref="S2.SS2.p4.7.m4.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p4.7.m4.1.1.3.cmml" xref="S2.SS2.p4.7.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.7.m4.1c">\bm{p}_{t}^{s}</annotation></semantics></math><span id="S2.SS2.p4.7.5" class="ltx_text" style="font-size:90%;">, respectively.
The final loss can be calculated as follows:</span></p>
<table id="S2.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E8.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{client}}=\mathcal{L}_{CE}+\alpha\mathcal{L}_{d}+\beta\mathcal{R}," display="block"><semantics id="S2.E8.m1.1a"><mrow id="S2.E8.m1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml"><msub id="S2.E8.m1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E8.m1.1.1.1.1.2.2" xref="S2.E8.m1.1.1.1.1.2.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.E8.m1.1.1.1.1.2.3" xref="S2.E8.m1.1.1.1.1.2.3.cmml">client</mi></msub><mo mathsize="90%" id="S2.E8.m1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E8.m1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.3.cmml"><msub id="S2.E8.m1.1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E8.m1.1.1.1.1.3.2.2" xref="S2.E8.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S2.E8.m1.1.1.1.1.3.2.3" xref="S2.E8.m1.1.1.1.1.3.2.3.cmml"><mi mathsize="90%" id="S2.E8.m1.1.1.1.1.3.2.3.2" xref="S2.E8.m1.1.1.1.1.3.2.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E8.m1.1.1.1.1.3.2.3.1" xref="S2.E8.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E8.m1.1.1.1.1.3.2.3.3" xref="S2.E8.m1.1.1.1.1.3.2.3.3.cmml">E</mi></mrow></msub><mo mathsize="90%" id="S2.E8.m1.1.1.1.1.3.1" xref="S2.E8.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E8.m1.1.1.1.1.3.3" xref="S2.E8.m1.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="S2.E8.m1.1.1.1.1.3.3.2" xref="S2.E8.m1.1.1.1.1.3.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S2.E8.m1.1.1.1.1.3.3.1" xref="S2.E8.m1.1.1.1.1.3.3.1.cmml">​</mo><msub id="S2.E8.m1.1.1.1.1.3.3.3" xref="S2.E8.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E8.m1.1.1.1.1.3.3.3.2" xref="S2.E8.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.E8.m1.1.1.1.1.3.3.3.3" xref="S2.E8.m1.1.1.1.1.3.3.3.3.cmml">d</mi></msub></mrow><mo mathsize="90%" id="S2.E8.m1.1.1.1.1.3.1a" xref="S2.E8.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E8.m1.1.1.1.1.3.4" xref="S2.E8.m1.1.1.1.1.3.4.cmml"><mi mathsize="90%" id="S2.E8.m1.1.1.1.1.3.4.2" xref="S2.E8.m1.1.1.1.1.3.4.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S2.E8.m1.1.1.1.1.3.4.1" xref="S2.E8.m1.1.1.1.1.3.4.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E8.m1.1.1.1.1.3.4.3" xref="S2.E8.m1.1.1.1.1.3.4.3.cmml">ℛ</mi></mrow></mrow></mrow><mo mathsize="90%" id="S2.E8.m1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.1b"><apply id="S2.E8.m1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1"><eq id="S2.E8.m1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1"></eq><apply id="S2.E8.m1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.2.2">ℒ</ci><ci id="S2.E8.m1.1.1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.2.3">client</ci></apply><apply id="S2.E8.m1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.3"><plus id="S2.E8.m1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.3.1"></plus><apply id="S2.E8.m1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.3.2.1.cmml" xref="S2.E8.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.3.2.2.cmml" xref="S2.E8.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S2.E8.m1.1.1.1.1.3.2.3.cmml" xref="S2.E8.m1.1.1.1.1.3.2.3"><times id="S2.E8.m1.1.1.1.1.3.2.3.1.cmml" xref="S2.E8.m1.1.1.1.1.3.2.3.1"></times><ci id="S2.E8.m1.1.1.1.1.3.2.3.2.cmml" xref="S2.E8.m1.1.1.1.1.3.2.3.2">𝐶</ci><ci id="S2.E8.m1.1.1.1.1.3.2.3.3.cmml" xref="S2.E8.m1.1.1.1.1.3.2.3.3">𝐸</ci></apply></apply><apply id="S2.E8.m1.1.1.1.1.3.3.cmml" xref="S2.E8.m1.1.1.1.1.3.3"><times id="S2.E8.m1.1.1.1.1.3.3.1.cmml" xref="S2.E8.m1.1.1.1.1.3.3.1"></times><ci id="S2.E8.m1.1.1.1.1.3.3.2.cmml" xref="S2.E8.m1.1.1.1.1.3.3.2">𝛼</ci><apply id="S2.E8.m1.1.1.1.1.3.3.3.cmml" xref="S2.E8.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E8.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E8.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E8.m1.1.1.1.1.3.3.3.2">ℒ</ci><ci id="S2.E8.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E8.m1.1.1.1.1.3.3.3.3">𝑑</ci></apply></apply><apply id="S2.E8.m1.1.1.1.1.3.4.cmml" xref="S2.E8.m1.1.1.1.1.3.4"><times id="S2.E8.m1.1.1.1.1.3.4.1.cmml" xref="S2.E8.m1.1.1.1.1.3.4.1"></times><ci id="S2.E8.m1.1.1.1.1.3.4.2.cmml" xref="S2.E8.m1.1.1.1.1.3.4.2">𝛽</ci><ci id="S2.E8.m1.1.1.1.1.3.4.3.cmml" xref="S2.E8.m1.1.1.1.1.3.4.3">ℛ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.1c">\mathcal{L}_{\mathrm{client}}=\mathcal{L}_{CE}+\alpha\mathcal{L}_{d}+\beta\mathcal{R},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p4.8" class="ltx_p"><span id="S2.SS2.p4.8.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.SS2.p4.8.m1.1" class="ltx_Math" alttext="\mathcal{R}=\|\bm{w}_{t}^{\mathrm{mlp}}\|_{2}^{2}" display="inline"><semantics id="S2.SS2.p4.8.m1.1a"><mrow id="S2.SS2.p4.8.m1.1.1" xref="S2.SS2.p4.8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS2.p4.8.m1.1.1.3" xref="S2.SS2.p4.8.m1.1.1.3.cmml">ℛ</mi><mo mathsize="90%" id="S2.SS2.p4.8.m1.1.1.2" xref="S2.SS2.p4.8.m1.1.1.2.cmml">=</mo><msubsup id="S2.SS2.p4.8.m1.1.1.1" xref="S2.SS2.p4.8.m1.1.1.1.cmml"><mrow id="S2.SS2.p4.8.m1.1.1.1.1.1.1" xref="S2.SS2.p4.8.m1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS2.p4.8.m1.1.1.1.1.1.1.2" xref="S2.SS2.p4.8.m1.1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S2.SS2.p4.8.m1.1.1.1.1.1.1.1" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.2.2" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.2.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.2.3" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.3" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.3.cmml">mlp</mi></msubsup><mo maxsize="90%" minsize="90%" id="S2.SS2.p4.8.m1.1.1.1.1.1.1.3" xref="S2.SS2.p4.8.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S2.SS2.p4.8.m1.1.1.1.1.3" xref="S2.SS2.p4.8.m1.1.1.1.1.3.cmml">2</mn><mn mathsize="90%" id="S2.SS2.p4.8.m1.1.1.1.3" xref="S2.SS2.p4.8.m1.1.1.1.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.8.m1.1b"><apply id="S2.SS2.p4.8.m1.1.1.cmml" xref="S2.SS2.p4.8.m1.1.1"><eq id="S2.SS2.p4.8.m1.1.1.2.cmml" xref="S2.SS2.p4.8.m1.1.1.2"></eq><ci id="S2.SS2.p4.8.m1.1.1.3.cmml" xref="S2.SS2.p4.8.m1.1.1.3">ℛ</ci><apply id="S2.SS2.p4.8.m1.1.1.1.cmml" xref="S2.SS2.p4.8.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.8.m1.1.1.1.2.cmml" xref="S2.SS2.p4.8.m1.1.1.1">superscript</csymbol><apply id="S2.SS2.p4.8.m1.1.1.1.1.cmml" xref="S2.SS2.p4.8.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.8.m1.1.1.1.1.2.cmml" xref="S2.SS2.p4.8.m1.1.1.1">subscript</csymbol><apply id="S2.SS2.p4.8.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p4.8.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.2.2">𝒘</ci><ci id="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.8.m1.1.1.1.1.1.1.1.3">mlp</ci></apply></apply><cn type="integer" id="S2.SS2.p4.8.m1.1.1.1.1.3.cmml" xref="S2.SS2.p4.8.m1.1.1.1.1.3">2</cn></apply><cn type="integer" id="S2.SS2.p4.8.m1.1.1.1.3.cmml" xref="S2.SS2.p4.8.m1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.8.m1.1c">\mathcal{R}=\|\bm{w}_{t}^{\mathrm{mlp}}\|_{2}^{2}</annotation></semantics></math><span id="S2.SS2.p4.8.2" class="ltx_text" style="font-size:90%;"> is the L2 regularization constraint on the weights of the MLP layer to prevent overfitting.</span></p>
</div>
<div id="S2.SS2.p5" class="ltx_para">
<p id="S2.SS2.p5.1" class="ltx_p"><span id="S2.SS2.p5.1.1" class="ltx_text" style="font-size:90%;">All clients use parameter matrices with the same weights while training their respective prompts during the training process. By introducing the pRA block, the prompts can be used for client-to-client communication, which reduces the computational complexity by several orders of magnitude.</span></p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Client-to-Client Communication</h3>

<figure id="S2.F3" class="ltx_figure"><img src="/html/2402.09677/assets/x3.png" id="S2.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="242" height="108" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.19.1.1" class="ltx_text ltx_font_bold">Fig. 3</span>: </span>The proposed client-to-client communication process. Each client communicates to update <math id="S2.F3.6.m1.1" class="ltx_Math" alttext="\bm{p}_{t}^{p}" display="inline"><semantics id="S2.F3.6.m1.1b"><msubsup id="S2.F3.6.m1.1.1" xref="S2.F3.6.m1.1.1.cmml"><mi id="S2.F3.6.m1.1.1.2.2" xref="S2.F3.6.m1.1.1.2.2.cmml">𝒑</mi><mi id="S2.F3.6.m1.1.1.2.3" xref="S2.F3.6.m1.1.1.2.3.cmml">t</mi><mi id="S2.F3.6.m1.1.1.3" xref="S2.F3.6.m1.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F3.6.m1.1c"><apply id="S2.F3.6.m1.1.1.cmml" xref="S2.F3.6.m1.1.1"><csymbol cd="ambiguous" id="S2.F3.6.m1.1.1.1.cmml" xref="S2.F3.6.m1.1.1">superscript</csymbol><apply id="S2.F3.6.m1.1.1.2.cmml" xref="S2.F3.6.m1.1.1"><csymbol cd="ambiguous" id="S2.F3.6.m1.1.1.2.1.cmml" xref="S2.F3.6.m1.1.1">subscript</csymbol><ci id="S2.F3.6.m1.1.1.2.2.cmml" xref="S2.F3.6.m1.1.1.2.2">𝒑</ci><ci id="S2.F3.6.m1.1.1.2.3.cmml" xref="S2.F3.6.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.F3.6.m1.1.1.3.cmml" xref="S2.F3.6.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.6.m1.1d">\bm{p}_{t}^{p}</annotation></semantics></math> and get <math id="S2.F3.7.m2.1" class="ltx_Math" alttext="\bm{p}_{t}^{s}" display="inline"><semantics id="S2.F3.7.m2.1b"><msubsup id="S2.F3.7.m2.1.1" xref="S2.F3.7.m2.1.1.cmml"><mi id="S2.F3.7.m2.1.1.2.2" xref="S2.F3.7.m2.1.1.2.2.cmml">𝒑</mi><mi id="S2.F3.7.m2.1.1.2.3" xref="S2.F3.7.m2.1.1.2.3.cmml">t</mi><mi id="S2.F3.7.m2.1.1.3" xref="S2.F3.7.m2.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F3.7.m2.1c"><apply id="S2.F3.7.m2.1.1.cmml" xref="S2.F3.7.m2.1.1"><csymbol cd="ambiguous" id="S2.F3.7.m2.1.1.1.cmml" xref="S2.F3.7.m2.1.1">superscript</csymbol><apply id="S2.F3.7.m2.1.1.2.cmml" xref="S2.F3.7.m2.1.1"><csymbol cd="ambiguous" id="S2.F3.7.m2.1.1.2.1.cmml" xref="S2.F3.7.m2.1.1">subscript</csymbol><ci id="S2.F3.7.m2.1.1.2.2.cmml" xref="S2.F3.7.m2.1.1.2.2">𝒑</ci><ci id="S2.F3.7.m2.1.1.2.3.cmml" xref="S2.F3.7.m2.1.1.2.3">𝑡</ci></apply><ci id="S2.F3.7.m2.1.1.3.cmml" xref="S2.F3.7.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.7.m2.1d">\bm{p}_{t}^{s}</annotation></semantics></math> from the other clients. The reliability parameter <math id="S2.F3.8.m3.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S2.F3.8.m3.1b"><mi id="S2.F3.8.m3.1.1" xref="S2.F3.8.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S2.F3.8.m3.1c"><ci id="S2.F3.8.m3.1.1.cmml" xref="S2.F3.8.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.8.m3.1d">\eta</annotation></semantics></math> controls the weights of different clients in the communication process, which is computed from the accuracy <math id="S2.F3.9.m4.1" class="ltx_Math" alttext="acc" display="inline"><semantics id="S2.F3.9.m4.1b"><mrow id="S2.F3.9.m4.1.1" xref="S2.F3.9.m4.1.1.cmml"><mi id="S2.F3.9.m4.1.1.2" xref="S2.F3.9.m4.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.F3.9.m4.1.1.1" xref="S2.F3.9.m4.1.1.1.cmml">​</mo><mi id="S2.F3.9.m4.1.1.3" xref="S2.F3.9.m4.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.F3.9.m4.1.1.1b" xref="S2.F3.9.m4.1.1.1.cmml">​</mo><mi id="S2.F3.9.m4.1.1.4" xref="S2.F3.9.m4.1.1.4.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.F3.9.m4.1c"><apply id="S2.F3.9.m4.1.1.cmml" xref="S2.F3.9.m4.1.1"><times id="S2.F3.9.m4.1.1.1.cmml" xref="S2.F3.9.m4.1.1.1"></times><ci id="S2.F3.9.m4.1.1.2.cmml" xref="S2.F3.9.m4.1.1.2">𝑎</ci><ci id="S2.F3.9.m4.1.1.3.cmml" xref="S2.F3.9.m4.1.1.3">𝑐</ci><ci id="S2.F3.9.m4.1.1.4.cmml" xref="S2.F3.9.m4.1.1.4">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.9.m4.1d">acc</annotation></semantics></math> and the similarity function <math id="S2.F3.10.m5.1" class="ltx_Math" alttext="\mathrm{cs}(\cdot)" display="inline"><semantics id="S2.F3.10.m5.1b"><mrow id="S2.F3.10.m5.1.2" xref="S2.F3.10.m5.1.2.cmml"><mi id="S2.F3.10.m5.1.2.2" xref="S2.F3.10.m5.1.2.2.cmml">cs</mi><mo lspace="0em" rspace="0em" id="S2.F3.10.m5.1.2.1" xref="S2.F3.10.m5.1.2.1.cmml">​</mo><mrow id="S2.F3.10.m5.1.2.3.2" xref="S2.F3.10.m5.1.2.cmml"><mo stretchy="false" id="S2.F3.10.m5.1.2.3.2.1" xref="S2.F3.10.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.F3.10.m5.1.1" xref="S2.F3.10.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.F3.10.m5.1.2.3.2.2" xref="S2.F3.10.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F3.10.m5.1c"><apply id="S2.F3.10.m5.1.2.cmml" xref="S2.F3.10.m5.1.2"><times id="S2.F3.10.m5.1.2.1.cmml" xref="S2.F3.10.m5.1.2.1"></times><ci id="S2.F3.10.m5.1.2.2.cmml" xref="S2.F3.10.m5.1.2.2">cs</ci><ci id="S2.F3.10.m5.1.1.cmml" xref="S2.F3.10.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.10.m5.1d">\mathrm{cs}(\cdot)</annotation></semantics></math>.</figcaption>
</figure>
<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.4" class="ltx_p"><span id="S2.SS3.p1.4.1" class="ltx_text" style="font-size:90%;">We decouple the VQA model of client </span><math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><msub id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝑐</ci><ci id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">c_{t}</annotation></semantics></math><span id="S2.SS3.p1.4.2" class="ltx_text" style="font-size:90%;"> into the shared feature extractors and the personalized final answer layer, which are parameterized by </span><math id="S2.SS3.p1.2.m2.1" class="ltx_Math" alttext="\bm{p}_{t}^{p}" display="inline"><semantics id="S2.SS3.p1.2.m2.1a"><msubsup id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p1.2.m2.1.1.2.2" xref="S2.SS3.p1.2.m2.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS3.p1.2.m2.1.1.2.3" xref="S2.SS3.p1.2.m2.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">superscript</csymbol><apply id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.2.1.cmml" xref="S2.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p1.2.m2.1.1.2.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2.2">𝒑</ci><ci id="S2.SS3.p1.2.m2.1.1.2.3.cmml" xref="S2.SS3.p1.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">\bm{p}_{t}^{p}</annotation></semantics></math><span id="S2.SS3.p1.4.3" class="ltx_text" style="font-size:90%;"> and </span><math id="S2.SS3.p1.3.m3.1" class="ltx_Math" alttext="\bm{w}_{t}^{\mathrm{mlp}}" display="inline"><semantics id="S2.SS3.p1.3.m3.1a"><msubsup id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p1.3.m3.1.1.2.2" xref="S2.SS3.p1.3.m3.1.1.2.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.SS3.p1.3.m3.1.1.2.3" xref="S2.SS3.p1.3.m3.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS3.p1.3.m3.1.1.3" xref="S2.SS3.p1.3.m3.1.1.3.cmml">mlp</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><apply id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.1.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">superscript</csymbol><apply id="S2.SS3.p1.3.m3.1.1.2.cmml" xref="S2.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.1.1.2.1.cmml" xref="S2.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p1.3.m3.1.1.2.2.cmml" xref="S2.SS3.p1.3.m3.1.1.2.2">𝒘</ci><ci id="S2.SS3.p1.3.m3.1.1.2.3.cmml" xref="S2.SS3.p1.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S2.SS3.p1.3.m3.1.1.3.cmml" xref="S2.SS3.p1.3.m3.1.1.3">mlp</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">\bm{w}_{t}^{\mathrm{mlp}}</annotation></semantics></math><span id="S2.SS3.p1.4.4" class="ltx_text" style="font-size:90%;">, respectively.
Each client has a task similar to multitask learning, where the number of the answer list is completely different between clients. The clients share the information through the shared prompt </span><math id="S2.SS3.p1.4.m4.1" class="ltx_Math" alttext="\bm{p}_{t}^{s}" display="inline"><semantics id="S2.SS3.p1.4.m4.1a"><msubsup id="S2.SS3.p1.4.m4.1.1" xref="S2.SS3.p1.4.m4.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p1.4.m4.1.1.2.2" xref="S2.SS3.p1.4.m4.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS3.p1.4.m4.1.1.2.3" xref="S2.SS3.p1.4.m4.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS3.p1.4.m4.1.1.3" xref="S2.SS3.p1.4.m4.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.1b"><apply id="S2.SS3.p1.4.m4.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1">superscript</csymbol><apply id="S2.SS3.p1.4.m4.1.1.2.cmml" xref="S2.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.1.2.1.cmml" xref="S2.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.p1.4.m4.1.1.2.2.cmml" xref="S2.SS3.p1.4.m4.1.1.2.2">𝒑</ci><ci id="S2.SS3.p1.4.m4.1.1.2.3.cmml" xref="S2.SS3.p1.4.m4.1.1.2.3">𝑡</ci></apply><ci id="S2.SS3.p1.4.m4.1.1.3.cmml" xref="S2.SS3.p1.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.1c">\bm{p}_{t}^{s}</annotation></semantics></math><span id="S2.SS3.p1.4.5" class="ltx_text" style="font-size:90%;">, and Eq. (</span><a href="#S2.E1" title="In 2.1 Problem Formulation ‣ 2 PROMPT-BASED PERSONALIZED FEDERATED LEARNING FOR MEDICAL VQA ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">1</span></a><span id="S2.SS3.p1.4.6" class="ltx_text" style="font-size:90%;">) can be further presented as follows:</span></p>
<table id="S2.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E9.m1.6" class="ltx_Math" alttext="\mathcal{L}(W)=\mathrm{arg}\mathop{\min}_{\bm{p}_{t}^{p},\bm{w}_{t}^{\mathrm{mlp}}}\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}_{(\mathcal{X},\mathcal{A})\sim\mathcal{P}_{t}}[\mathcal{L}_{t}(\bm{p}_{t}^{p},\bm{w}_{t}^{\mathrm{mlp}};\bm{p}_{t}^{s},\mathcal{D}_{t})]." display="block"><semantics id="S2.E9.m1.6a"><mrow id="S2.E9.m1.6.6.1" xref="S2.E9.m1.6.6.1.1.cmml"><mrow id="S2.E9.m1.6.6.1.1" xref="S2.E9.m1.6.6.1.1.cmml"><mrow id="S2.E9.m1.6.6.1.1.3" xref="S2.E9.m1.6.6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E9.m1.6.6.1.1.3.2" xref="S2.E9.m1.6.6.1.1.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.6.6.1.1.3.1" xref="S2.E9.m1.6.6.1.1.3.1.cmml">​</mo><mrow id="S2.E9.m1.6.6.1.1.3.3.2" xref="S2.E9.m1.6.6.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E9.m1.6.6.1.1.3.3.2.1" xref="S2.E9.m1.6.6.1.1.3.cmml">(</mo><mi mathsize="90%" id="S2.E9.m1.5.5" xref="S2.E9.m1.5.5.cmml">W</mi><mo maxsize="90%" minsize="90%" id="S2.E9.m1.6.6.1.1.3.3.2.2" xref="S2.E9.m1.6.6.1.1.3.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.E9.m1.6.6.1.1.2" xref="S2.E9.m1.6.6.1.1.2.cmml">=</mo><mrow id="S2.E9.m1.6.6.1.1.1" xref="S2.E9.m1.6.6.1.1.1.cmml"><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.3" xref="S2.E9.m1.6.6.1.1.1.3.cmml">arg</mi><mo lspace="0.167em" rspace="0em" id="S2.E9.m1.6.6.1.1.1.2" xref="S2.E9.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="S2.E9.m1.6.6.1.1.1.1" xref="S2.E9.m1.6.6.1.1.1.1.cmml"><munder id="S2.E9.m1.6.6.1.1.1.1.2" xref="S2.E9.m1.6.6.1.1.1.1.2.cmml"><mo mathsize="90%" movablelimits="false" rspace="0.167em" id="S2.E9.m1.6.6.1.1.1.1.2.2" xref="S2.E9.m1.6.6.1.1.1.1.2.2.cmml">min</mo><mrow id="S2.E9.m1.2.2.2.2" xref="S2.E9.m1.2.2.2.3.cmml"><msubsup id="S2.E9.m1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E9.m1.1.1.1.1.1.2.2" xref="S2.E9.m1.1.1.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E9.m1.1.1.1.1.1.2.3" xref="S2.E9.m1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E9.m1.1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.1.3.cmml">p</mi></msubsup><mo mathsize="90%" id="S2.E9.m1.2.2.2.2.3" xref="S2.E9.m1.2.2.2.3.cmml">,</mo><msubsup id="S2.E9.m1.2.2.2.2.2" xref="S2.E9.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="S2.E9.m1.2.2.2.2.2.2.2" xref="S2.E9.m1.2.2.2.2.2.2.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.E9.m1.2.2.2.2.2.2.3" xref="S2.E9.m1.2.2.2.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E9.m1.2.2.2.2.2.3" xref="S2.E9.m1.2.2.2.2.2.3.cmml">mlp</mi></msubsup></mrow></munder><mrow id="S2.E9.m1.6.6.1.1.1.1.1" xref="S2.E9.m1.6.6.1.1.1.1.1.cmml"><mfrac id="S2.E9.m1.6.6.1.1.1.1.1.3" xref="S2.E9.m1.6.6.1.1.1.1.1.3.cmml"><mn mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.3.2" xref="S2.E9.m1.6.6.1.1.1.1.1.3.2.cmml">1</mn><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.3.3" xref="S2.E9.m1.6.6.1.1.1.1.1.3.3.cmml">T</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E9.m1.6.6.1.1.1.1.1.2" xref="S2.E9.m1.6.6.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E9.m1.6.6.1.1.1.1.1.1" xref="S2.E9.m1.6.6.1.1.1.1.1.1.cmml"><munderover id="S2.E9.m1.6.6.1.1.1.1.1.1.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.1" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.2.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.3.cmml">T</mi></munderover><mrow id="S2.E9.m1.6.6.1.1.1.1.1.1.1" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.cmml"><msub id="S2.E9.m1.6.6.1.1.1.1.1.1.1.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.3.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E9.m1.4.4.2" xref="S2.E9.m1.4.4.2.cmml"><mrow id="S2.E9.m1.4.4.2.4.2" xref="S2.E9.m1.4.4.2.4.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.E9.m1.4.4.2.4.2.1" xref="S2.E9.m1.4.4.2.4.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E9.m1.3.3.1.1" xref="S2.E9.m1.3.3.1.1.cmml">𝒳</mi><mo mathsize="90%" id="S2.E9.m1.4.4.2.4.2.2" xref="S2.E9.m1.4.4.2.4.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E9.m1.4.4.2.2" xref="S2.E9.m1.4.4.2.2.cmml">𝒜</mi><mo maxsize="90%" minsize="90%" id="S2.E9.m1.4.4.2.4.2.3" xref="S2.E9.m1.4.4.2.4.1.cmml">)</mo></mrow><mo mathsize="90%" id="S2.E9.m1.4.4.2.3" xref="S2.E9.m1.4.4.2.3.cmml">∼</mo><msub id="S2.E9.m1.4.4.2.5" xref="S2.E9.m1.4.4.2.5.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E9.m1.4.4.2.5.2" xref="S2.E9.m1.4.4.2.5.2.cmml">𝒫</mi><mi mathsize="90%" id="S2.E9.m1.4.4.2.5.3" xref="S2.E9.m1.4.4.2.5.3.cmml">t</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.5" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.5.cmml">​</mo><mrow id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.5.cmml"><mo maxsize="90%" minsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.5" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.5.cmml">(</mo><msubsup id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">p</mi></msubsup><mo mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.6" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><msubsup id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">mlp</mi></msubsup><mo mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.7" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.5.cmml">;</mo><msubsup id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.2.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">s</mi></msubsup><mo mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.8" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4.2" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4.2.cmml">𝒟</mi><mi mathsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4.3.cmml">t</mi></msub><mo maxsize="90%" minsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.9" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.5.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.E9.m1.6.6.1.2" xref="S2.E9.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.6b"><apply id="S2.E9.m1.6.6.1.1.cmml" xref="S2.E9.m1.6.6.1"><eq id="S2.E9.m1.6.6.1.1.2.cmml" xref="S2.E9.m1.6.6.1.1.2"></eq><apply id="S2.E9.m1.6.6.1.1.3.cmml" xref="S2.E9.m1.6.6.1.1.3"><times id="S2.E9.m1.6.6.1.1.3.1.cmml" xref="S2.E9.m1.6.6.1.1.3.1"></times><ci id="S2.E9.m1.6.6.1.1.3.2.cmml" xref="S2.E9.m1.6.6.1.1.3.2">ℒ</ci><ci id="S2.E9.m1.5.5.cmml" xref="S2.E9.m1.5.5">𝑊</ci></apply><apply id="S2.E9.m1.6.6.1.1.1.cmml" xref="S2.E9.m1.6.6.1.1.1"><times id="S2.E9.m1.6.6.1.1.1.2.cmml" xref="S2.E9.m1.6.6.1.1.1.2"></times><ci id="S2.E9.m1.6.6.1.1.1.3.cmml" xref="S2.E9.m1.6.6.1.1.1.3">arg</ci><apply id="S2.E9.m1.6.6.1.1.1.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1"><apply id="S2.E9.m1.6.6.1.1.1.1.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.2.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.2">subscript</csymbol><min id="S2.E9.m1.6.6.1.1.1.1.2.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.2.2"></min><list id="S2.E9.m1.2.2.2.3.cmml" xref="S2.E9.m1.2.2.2.2"><apply id="S2.E9.m1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1">superscript</csymbol><apply id="S2.E9.m1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.1.1.1.1.1.2.2">𝒑</ci><ci id="S2.E9.m1.1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.E9.m1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.E9.m1.2.2.2.2.2.cmml" xref="S2.E9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.2.1.cmml" xref="S2.E9.m1.2.2.2.2.2">superscript</csymbol><apply id="S2.E9.m1.2.2.2.2.2.2.cmml" xref="S2.E9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.2.2.1.cmml" xref="S2.E9.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.E9.m1.2.2.2.2.2.2.2.cmml" xref="S2.E9.m1.2.2.2.2.2.2.2">𝒘</ci><ci id="S2.E9.m1.2.2.2.2.2.2.3.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S2.E9.m1.2.2.2.2.2.3.cmml" xref="S2.E9.m1.2.2.2.2.2.3">mlp</ci></apply></list></apply><apply id="S2.E9.m1.6.6.1.1.1.1.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1"><times id="S2.E9.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.2"></times><apply id="S2.E9.m1.6.6.1.1.1.1.1.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.3"><divide id="S2.E9.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.3"></divide><cn type="integer" id="S2.E9.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.3.2">1</cn><ci id="S2.E9.m1.6.6.1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.3.3">𝑇</ci></apply><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1"><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3"><eq id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1"><times id="S2.E9.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.2"></times><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.3.2">𝔼</ci><apply id="S2.E9.m1.4.4.2.cmml" xref="S2.E9.m1.4.4.2"><csymbol cd="latexml" id="S2.E9.m1.4.4.2.3.cmml" xref="S2.E9.m1.4.4.2.3">similar-to</csymbol><interval closure="open" id="S2.E9.m1.4.4.2.4.1.cmml" xref="S2.E9.m1.4.4.2.4.2"><ci id="S2.E9.m1.3.3.1.1.cmml" xref="S2.E9.m1.3.3.1.1">𝒳</ci><ci id="S2.E9.m1.4.4.2.2.cmml" xref="S2.E9.m1.4.4.2.2">𝒜</ci></interval><apply id="S2.E9.m1.4.4.2.5.cmml" xref="S2.E9.m1.4.4.2.5"><csymbol cd="ambiguous" id="S2.E9.m1.4.4.2.5.1.cmml" xref="S2.E9.m1.4.4.2.5">subscript</csymbol><ci id="S2.E9.m1.4.4.2.5.2.cmml" xref="S2.E9.m1.4.4.2.5.2">𝒫</ci><ci id="S2.E9.m1.4.4.2.5.3.cmml" xref="S2.E9.m1.4.4.2.5.3">𝑡</ci></apply></apply></apply><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1"><times id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.5.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.5"></times><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6.2">ℒ</ci><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.6.3">𝑡</ci></apply><vector id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.5.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4"><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒑</ci><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝒘</ci><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3">mlp</ci></apply><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3">superscript</csymbol><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.2.2">𝒑</ci><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.2.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.2.3">𝑡</ci></apply><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑠</ci></apply><apply id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4.1.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4.2.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4.2">𝒟</ci><ci id="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4.3.cmml" xref="S2.E9.m1.6.6.1.1.1.1.1.1.1.1.1.1.4.4.4.3">𝑡</ci></apply></vector></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.6c">\mathcal{L}(W)=\mathrm{arg}\mathop{\min}_{\bm{p}_{t}^{p},\bm{w}_{t}^{\mathrm{mlp}}}\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}_{(\mathcal{X},\mathcal{A})\sim\mathcal{P}_{t}}[\mathcal{L}_{t}(\bm{p}_{t}^{p},\bm{w}_{t}^{\mathrm{mlp}};\bm{p}_{t}^{s},\mathcal{D}_{t})].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.3" class="ltx_p"><span id="S2.SS3.p2.3.1" class="ltx_text" style="font-size:90%;">Since there are differences in the performance and tasks of clients, there should be a tendency to access shared information on the client. Therefore, we introduce a set of client’s reliability parameter </span><math id="S2.SS3.p2.1.m1.1" class="ltx_Math" alttext="\{\eta_{t}\}_{t=1}^{T}" display="inline"><semantics id="S2.SS3.p2.1.m1.1a"><msubsup id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mrow id="S2.SS3.p2.1.m1.1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS3.p2.1.m1.1.1.1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS3.p2.1.m1.1.1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p2.1.m1.1.1.1.1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.2.cmml">η</mi><mi mathsize="90%" id="S2.SS3.p2.1.m1.1.1.1.1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo maxsize="90%" minsize="90%" id="S2.SS3.p2.1.m1.1.1.1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS3.p2.1.m1.1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.1.3.cmml"><mi mathsize="90%" id="S2.SS3.p2.1.m1.1.1.1.3.2" xref="S2.SS3.p2.1.m1.1.1.1.3.2.cmml">t</mi><mo mathsize="90%" id="S2.SS3.p2.1.m1.1.1.1.3.1" xref="S2.SS3.p2.1.m1.1.1.1.3.1.cmml">=</mo><mn mathsize="90%" id="S2.SS3.p2.1.m1.1.1.1.3.3" xref="S2.SS3.p2.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1">superscript</csymbol><apply id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1">subscript</csymbol><set id="S2.SS3.p2.1.m1.1.1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1"><apply id="S2.SS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.2">𝜂</ci><ci id="S2.SS3.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S2.SS3.p2.1.m1.1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.1.3"><eq id="S2.SS3.p2.1.m1.1.1.1.3.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.3.1"></eq><ci id="S2.SS3.p2.1.m1.1.1.1.3.2.cmml" xref="S2.SS3.p2.1.m1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S2.SS3.p2.1.m1.1.1.1.3.3.cmml" xref="S2.SS3.p2.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\{\eta_{t}\}_{t=1}^{T}</annotation></semantics></math><span id="S2.SS3.p2.3.2" class="ltx_text" style="font-size:90%;"> obtained from the performance and task similarity. For client </span><math id="S2.SS3.p2.2.m2.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.SS3.p2.2.m2.1a"><msub id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p2.2.m2.1.1.2" xref="S2.SS3.p2.2.m2.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2">𝑐</ci><ci id="S2.SS3.p2.2.m2.1.1.3.cmml" xref="S2.SS3.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">c_{t}</annotation></semantics></math><span id="S2.SS3.p2.3.3" class="ltx_text" style="font-size:90%;">, the shared prompt </span><math id="S2.SS3.p2.3.m3.1" class="ltx_Math" alttext="\bm{p}_{t}^{s}" display="inline"><semantics id="S2.SS3.p2.3.m3.1a"><msubsup id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p2.3.m3.1.1.2.2" xref="S2.SS3.p2.3.m3.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.SS3.p2.3.m3.1.1.2.3" xref="S2.SS3.p2.3.m3.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">superscript</csymbol><apply id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.2.1.cmml" xref="S2.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.2.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2.2">𝒑</ci><ci id="S2.SS3.p2.3.m3.1.1.2.3.cmml" xref="S2.SS3.p2.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">\bm{p}_{t}^{s}</annotation></semantics></math><span id="S2.SS3.p2.3.4" class="ltx_text" style="font-size:90%;"> can be calculated as follows:</span></p>
<table id="S2.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E10.m1.3" class="ltx_Math" alttext="\bm{p}_{t}^{s}=\sum_{{i=1,i\neq t}}^{T}\eta_{i}\bm{p}_{i}^{p}," display="block"><semantics id="S2.E10.m1.3a"><mrow id="S2.E10.m1.3.3.1" xref="S2.E10.m1.3.3.1.1.cmml"><mrow id="S2.E10.m1.3.3.1.1" xref="S2.E10.m1.3.3.1.1.cmml"><msubsup id="S2.E10.m1.3.3.1.1.2" xref="S2.E10.m1.3.3.1.1.2.cmml"><mi mathsize="90%" id="S2.E10.m1.3.3.1.1.2.2.2" xref="S2.E10.m1.3.3.1.1.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E10.m1.3.3.1.1.2.2.3" xref="S2.E10.m1.3.3.1.1.2.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E10.m1.3.3.1.1.2.3" xref="S2.E10.m1.3.3.1.1.2.3.cmml">s</mi></msubsup><mo mathsize="90%" rspace="0.111em" id="S2.E10.m1.3.3.1.1.1" xref="S2.E10.m1.3.3.1.1.1.cmml">=</mo><mrow id="S2.E10.m1.3.3.1.1.3" xref="S2.E10.m1.3.3.1.1.3.cmml"><munderover id="S2.E10.m1.3.3.1.1.3.1" xref="S2.E10.m1.3.3.1.1.3.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E10.m1.3.3.1.1.3.1.2.2" xref="S2.E10.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E10.m1.2.2.2.2" xref="S2.E10.m1.2.2.2.3.cmml"><mrow id="S2.E10.m1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E10.m1.1.1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.1.2.cmml">i</mi><mo mathsize="90%" id="S2.E10.m1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S2.E10.m1.1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo mathsize="90%" id="S2.E10.m1.2.2.2.2.3" xref="S2.E10.m1.2.2.2.3a.cmml">,</mo><mrow id="S2.E10.m1.2.2.2.2.2" xref="S2.E10.m1.2.2.2.2.2.cmml"><mi mathsize="90%" id="S2.E10.m1.2.2.2.2.2.2" xref="S2.E10.m1.2.2.2.2.2.2.cmml">i</mi><mo mathsize="90%" id="S2.E10.m1.2.2.2.2.2.1" xref="S2.E10.m1.2.2.2.2.2.1.cmml">≠</mo><mi mathsize="90%" id="S2.E10.m1.2.2.2.2.2.3" xref="S2.E10.m1.2.2.2.2.2.3.cmml">t</mi></mrow></mrow><mi mathsize="90%" id="S2.E10.m1.3.3.1.1.3.1.3" xref="S2.E10.m1.3.3.1.1.3.1.3.cmml">T</mi></munderover><mrow id="S2.E10.m1.3.3.1.1.3.2" xref="S2.E10.m1.3.3.1.1.3.2.cmml"><msub id="S2.E10.m1.3.3.1.1.3.2.2" xref="S2.E10.m1.3.3.1.1.3.2.2.cmml"><mi mathsize="90%" id="S2.E10.m1.3.3.1.1.3.2.2.2" xref="S2.E10.m1.3.3.1.1.3.2.2.2.cmml">η</mi><mi mathsize="90%" id="S2.E10.m1.3.3.1.1.3.2.2.3" xref="S2.E10.m1.3.3.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E10.m1.3.3.1.1.3.2.1" xref="S2.E10.m1.3.3.1.1.3.2.1.cmml">​</mo><msubsup id="S2.E10.m1.3.3.1.1.3.2.3" xref="S2.E10.m1.3.3.1.1.3.2.3.cmml"><mi mathsize="90%" id="S2.E10.m1.3.3.1.1.3.2.3.2.2" xref="S2.E10.m1.3.3.1.1.3.2.3.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E10.m1.3.3.1.1.3.2.3.2.3" xref="S2.E10.m1.3.3.1.1.3.2.3.2.3.cmml">i</mi><mi mathsize="90%" id="S2.E10.m1.3.3.1.1.3.2.3.3" xref="S2.E10.m1.3.3.1.1.3.2.3.3.cmml">p</mi></msubsup></mrow></mrow></mrow><mo mathsize="90%" id="S2.E10.m1.3.3.1.2" xref="S2.E10.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.3b"><apply id="S2.E10.m1.3.3.1.1.cmml" xref="S2.E10.m1.3.3.1"><eq id="S2.E10.m1.3.3.1.1.1.cmml" xref="S2.E10.m1.3.3.1.1.1"></eq><apply id="S2.E10.m1.3.3.1.1.2.cmml" xref="S2.E10.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.3.3.1.1.2.1.cmml" xref="S2.E10.m1.3.3.1.1.2">superscript</csymbol><apply id="S2.E10.m1.3.3.1.1.2.2.cmml" xref="S2.E10.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.3.3.1.1.2.2.1.cmml" xref="S2.E10.m1.3.3.1.1.2">subscript</csymbol><ci id="S2.E10.m1.3.3.1.1.2.2.2.cmml" xref="S2.E10.m1.3.3.1.1.2.2.2">𝒑</ci><ci id="S2.E10.m1.3.3.1.1.2.2.3.cmml" xref="S2.E10.m1.3.3.1.1.2.2.3">𝑡</ci></apply><ci id="S2.E10.m1.3.3.1.1.2.3.cmml" xref="S2.E10.m1.3.3.1.1.2.3">𝑠</ci></apply><apply id="S2.E10.m1.3.3.1.1.3.cmml" xref="S2.E10.m1.3.3.1.1.3"><apply id="S2.E10.m1.3.3.1.1.3.1.cmml" xref="S2.E10.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E10.m1.3.3.1.1.3.1.1.cmml" xref="S2.E10.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S2.E10.m1.3.3.1.1.3.1.2.cmml" xref="S2.E10.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E10.m1.3.3.1.1.3.1.2.1.cmml" xref="S2.E10.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S2.E10.m1.3.3.1.1.3.1.2.2.cmml" xref="S2.E10.m1.3.3.1.1.3.1.2.2"></sum><apply id="S2.E10.m1.2.2.2.3.cmml" xref="S2.E10.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E10.m1.2.2.2.3a.cmml" xref="S2.E10.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E10.m1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1"><eq id="S2.E10.m1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1"></eq><ci id="S2.E10.m1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="S2.E10.m1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.1.3">1</cn></apply><apply id="S2.E10.m1.2.2.2.2.2.cmml" xref="S2.E10.m1.2.2.2.2.2"><neq id="S2.E10.m1.2.2.2.2.2.1.cmml" xref="S2.E10.m1.2.2.2.2.2.1"></neq><ci id="S2.E10.m1.2.2.2.2.2.2.cmml" xref="S2.E10.m1.2.2.2.2.2.2">𝑖</ci><ci id="S2.E10.m1.2.2.2.2.2.3.cmml" xref="S2.E10.m1.2.2.2.2.2.3">𝑡</ci></apply></apply></apply><ci id="S2.E10.m1.3.3.1.1.3.1.3.cmml" xref="S2.E10.m1.3.3.1.1.3.1.3">𝑇</ci></apply><apply id="S2.E10.m1.3.3.1.1.3.2.cmml" xref="S2.E10.m1.3.3.1.1.3.2"><times id="S2.E10.m1.3.3.1.1.3.2.1.cmml" xref="S2.E10.m1.3.3.1.1.3.2.1"></times><apply id="S2.E10.m1.3.3.1.1.3.2.2.cmml" xref="S2.E10.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E10.m1.3.3.1.1.3.2.2.1.cmml" xref="S2.E10.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S2.E10.m1.3.3.1.1.3.2.2.2.cmml" xref="S2.E10.m1.3.3.1.1.3.2.2.2">𝜂</ci><ci id="S2.E10.m1.3.3.1.1.3.2.2.3.cmml" xref="S2.E10.m1.3.3.1.1.3.2.2.3">𝑖</ci></apply><apply id="S2.E10.m1.3.3.1.1.3.2.3.cmml" xref="S2.E10.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E10.m1.3.3.1.1.3.2.3.1.cmml" xref="S2.E10.m1.3.3.1.1.3.2.3">superscript</csymbol><apply id="S2.E10.m1.3.3.1.1.3.2.3.2.cmml" xref="S2.E10.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E10.m1.3.3.1.1.3.2.3.2.1.cmml" xref="S2.E10.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S2.E10.m1.3.3.1.1.3.2.3.2.2.cmml" xref="S2.E10.m1.3.3.1.1.3.2.3.2.2">𝒑</ci><ci id="S2.E10.m1.3.3.1.1.3.2.3.2.3.cmml" xref="S2.E10.m1.3.3.1.1.3.2.3.2.3">𝑖</ci></apply><ci id="S2.E10.m1.3.3.1.1.3.2.3.3.cmml" xref="S2.E10.m1.3.3.1.1.3.2.3.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.3c">\bm{p}_{t}^{s}=\sum_{{i=1,i\neq t}}^{T}\eta_{i}\bm{p}_{i}^{p},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<table id="S2.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E11.m1.7" class="ltx_Math" alttext="\eta_{i}=\frac{acc_{i}\times\mathrm{cs}(\bm{p}_{i}^{p},\bm{p}_{t}^{p})}{\sum_{{j=1,j\neq t}}^{T}acc_{j}\times\mathrm{cs}(\bm{p}_{j}^{p},\bm{p}_{t}^{p})}," display="block"><semantics id="S2.E11.m1.7a"><mrow id="S2.E11.m1.7.7.1" xref="S2.E11.m1.7.7.1.1.cmml"><mrow id="S2.E11.m1.7.7.1.1" xref="S2.E11.m1.7.7.1.1.cmml"><msub id="S2.E11.m1.7.7.1.1.2" xref="S2.E11.m1.7.7.1.1.2.cmml"><mi mathsize="90%" id="S2.E11.m1.7.7.1.1.2.2" xref="S2.E11.m1.7.7.1.1.2.2.cmml">η</mi><mi mathsize="90%" id="S2.E11.m1.7.7.1.1.2.3" xref="S2.E11.m1.7.7.1.1.2.3.cmml">i</mi></msub><mo mathsize="90%" id="S2.E11.m1.7.7.1.1.1" xref="S2.E11.m1.7.7.1.1.1.cmml">=</mo><mfrac id="S2.E11.m1.6.6" xref="S2.E11.m1.6.6.cmml"><mrow id="S2.E11.m1.2.2.2" xref="S2.E11.m1.2.2.2.cmml"><mrow id="S2.E11.m1.2.2.2.4" xref="S2.E11.m1.2.2.2.4.cmml"><mrow id="S2.E11.m1.2.2.2.4.2" xref="S2.E11.m1.2.2.2.4.2.cmml"><mi mathsize="90%" id="S2.E11.m1.2.2.2.4.2.2" xref="S2.E11.m1.2.2.2.4.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.E11.m1.2.2.2.4.2.1" xref="S2.E11.m1.2.2.2.4.2.1.cmml">​</mo><mi mathsize="90%" id="S2.E11.m1.2.2.2.4.2.3" xref="S2.E11.m1.2.2.2.4.2.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.E11.m1.2.2.2.4.2.1a" xref="S2.E11.m1.2.2.2.4.2.1.cmml">​</mo><msub id="S2.E11.m1.2.2.2.4.2.4" xref="S2.E11.m1.2.2.2.4.2.4.cmml"><mi mathsize="90%" id="S2.E11.m1.2.2.2.4.2.4.2" xref="S2.E11.m1.2.2.2.4.2.4.2.cmml">c</mi><mi mathsize="90%" id="S2.E11.m1.2.2.2.4.2.4.3" xref="S2.E11.m1.2.2.2.4.2.4.3.cmml">i</mi></msub></mrow><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.E11.m1.2.2.2.4.1" xref="S2.E11.m1.2.2.2.4.1.cmml">×</mo><mi mathsize="90%" id="S2.E11.m1.2.2.2.4.3" xref="S2.E11.m1.2.2.2.4.3.cmml">cs</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E11.m1.2.2.2.3" xref="S2.E11.m1.2.2.2.3.cmml">​</mo><mrow id="S2.E11.m1.2.2.2.2.2" xref="S2.E11.m1.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E11.m1.2.2.2.2.2.3" xref="S2.E11.m1.2.2.2.2.3.cmml">(</mo><msubsup id="S2.E11.m1.1.1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E11.m1.1.1.1.1.1.1.2.2" xref="S2.E11.m1.1.1.1.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E11.m1.1.1.1.1.1.1.2.3" xref="S2.E11.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="S2.E11.m1.1.1.1.1.1.1.3" xref="S2.E11.m1.1.1.1.1.1.1.3.cmml">p</mi></msubsup><mo mathsize="90%" id="S2.E11.m1.2.2.2.2.2.4" xref="S2.E11.m1.2.2.2.2.3.cmml">,</mo><msubsup id="S2.E11.m1.2.2.2.2.2.2" xref="S2.E11.m1.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="S2.E11.m1.2.2.2.2.2.2.2.2" xref="S2.E11.m1.2.2.2.2.2.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E11.m1.2.2.2.2.2.2.2.3" xref="S2.E11.m1.2.2.2.2.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E11.m1.2.2.2.2.2.2.3" xref="S2.E11.m1.2.2.2.2.2.2.3.cmml">p</mi></msubsup><mo maxsize="90%" minsize="90%" id="S2.E11.m1.2.2.2.2.2.5" xref="S2.E11.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S2.E11.m1.6.6.6" xref="S2.E11.m1.6.6.6.cmml"><msubsup id="S2.E11.m1.6.6.6.5" xref="S2.E11.m1.6.6.6.5.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S2.E11.m1.6.6.6.5.2.2" xref="S2.E11.m1.6.6.6.5.2.2.cmml">∑</mo><mrow id="S2.E11.m1.4.4.4.2.2.2" xref="S2.E11.m1.4.4.4.2.2.3.cmml"><mrow id="S2.E11.m1.3.3.3.1.1.1.1" xref="S2.E11.m1.3.3.3.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E11.m1.3.3.3.1.1.1.1.2" xref="S2.E11.m1.3.3.3.1.1.1.1.2.cmml">j</mi><mo mathsize="90%" id="S2.E11.m1.3.3.3.1.1.1.1.1" xref="S2.E11.m1.3.3.3.1.1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S2.E11.m1.3.3.3.1.1.1.1.3" xref="S2.E11.m1.3.3.3.1.1.1.1.3.cmml">1</mn></mrow><mo mathsize="90%" id="S2.E11.m1.4.4.4.2.2.2.3" xref="S2.E11.m1.4.4.4.2.2.3a.cmml">,</mo><mrow id="S2.E11.m1.4.4.4.2.2.2.2" xref="S2.E11.m1.4.4.4.2.2.2.2.cmml"><mi mathsize="90%" id="S2.E11.m1.4.4.4.2.2.2.2.2" xref="S2.E11.m1.4.4.4.2.2.2.2.2.cmml">j</mi><mo mathsize="90%" id="S2.E11.m1.4.4.4.2.2.2.2.1" xref="S2.E11.m1.4.4.4.2.2.2.2.1.cmml">≠</mo><mi mathsize="90%" id="S2.E11.m1.4.4.4.2.2.2.2.3" xref="S2.E11.m1.4.4.4.2.2.2.2.3.cmml">t</mi></mrow></mrow><mi mathsize="90%" id="S2.E11.m1.6.6.6.5.3" xref="S2.E11.m1.6.6.6.5.3.cmml">T</mi></msubsup><mrow id="S2.E11.m1.6.6.6.4" xref="S2.E11.m1.6.6.6.4.cmml"><mrow id="S2.E11.m1.6.6.6.4.4" xref="S2.E11.m1.6.6.6.4.4.cmml"><mrow id="S2.E11.m1.6.6.6.4.4.2" xref="S2.E11.m1.6.6.6.4.4.2.cmml"><mi mathsize="90%" id="S2.E11.m1.6.6.6.4.4.2.2" xref="S2.E11.m1.6.6.6.4.4.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.E11.m1.6.6.6.4.4.2.1" xref="S2.E11.m1.6.6.6.4.4.2.1.cmml">​</mo><mi mathsize="90%" id="S2.E11.m1.6.6.6.4.4.2.3" xref="S2.E11.m1.6.6.6.4.4.2.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.E11.m1.6.6.6.4.4.2.1a" xref="S2.E11.m1.6.6.6.4.4.2.1.cmml">​</mo><msub id="S2.E11.m1.6.6.6.4.4.2.4" xref="S2.E11.m1.6.6.6.4.4.2.4.cmml"><mi mathsize="90%" id="S2.E11.m1.6.6.6.4.4.2.4.2" xref="S2.E11.m1.6.6.6.4.4.2.4.2.cmml">c</mi><mi mathsize="90%" id="S2.E11.m1.6.6.6.4.4.2.4.3" xref="S2.E11.m1.6.6.6.4.4.2.4.3.cmml">j</mi></msub></mrow><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.E11.m1.6.6.6.4.4.1" xref="S2.E11.m1.6.6.6.4.4.1.cmml">×</mo><mi mathsize="90%" id="S2.E11.m1.6.6.6.4.4.3" xref="S2.E11.m1.6.6.6.4.4.3.cmml">cs</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E11.m1.6.6.6.4.3" xref="S2.E11.m1.6.6.6.4.3.cmml">​</mo><mrow id="S2.E11.m1.6.6.6.4.2.2" xref="S2.E11.m1.6.6.6.4.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E11.m1.6.6.6.4.2.2.3" xref="S2.E11.m1.6.6.6.4.2.3.cmml">(</mo><msubsup id="S2.E11.m1.5.5.5.3.1.1.1" xref="S2.E11.m1.5.5.5.3.1.1.1.cmml"><mi mathsize="90%" id="S2.E11.m1.5.5.5.3.1.1.1.2.2" xref="S2.E11.m1.5.5.5.3.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E11.m1.5.5.5.3.1.1.1.2.3" xref="S2.E11.m1.5.5.5.3.1.1.1.2.3.cmml">j</mi><mi mathsize="90%" id="S2.E11.m1.5.5.5.3.1.1.1.3" xref="S2.E11.m1.5.5.5.3.1.1.1.3.cmml">p</mi></msubsup><mo mathsize="90%" id="S2.E11.m1.6.6.6.4.2.2.4" xref="S2.E11.m1.6.6.6.4.2.3.cmml">,</mo><msubsup id="S2.E11.m1.6.6.6.4.2.2.2" xref="S2.E11.m1.6.6.6.4.2.2.2.cmml"><mi mathsize="90%" id="S2.E11.m1.6.6.6.4.2.2.2.2.2" xref="S2.E11.m1.6.6.6.4.2.2.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="S2.E11.m1.6.6.6.4.2.2.2.2.3" xref="S2.E11.m1.6.6.6.4.2.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="S2.E11.m1.6.6.6.4.2.2.2.3" xref="S2.E11.m1.6.6.6.4.2.2.2.3.cmml">p</mi></msubsup><mo maxsize="90%" minsize="90%" id="S2.E11.m1.6.6.6.4.2.2.5" xref="S2.E11.m1.6.6.6.4.2.3.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo mathsize="90%" id="S2.E11.m1.7.7.1.2" xref="S2.E11.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E11.m1.7b"><apply id="S2.E11.m1.7.7.1.1.cmml" xref="S2.E11.m1.7.7.1"><eq id="S2.E11.m1.7.7.1.1.1.cmml" xref="S2.E11.m1.7.7.1.1.1"></eq><apply id="S2.E11.m1.7.7.1.1.2.cmml" xref="S2.E11.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S2.E11.m1.7.7.1.1.2.1.cmml" xref="S2.E11.m1.7.7.1.1.2">subscript</csymbol><ci id="S2.E11.m1.7.7.1.1.2.2.cmml" xref="S2.E11.m1.7.7.1.1.2.2">𝜂</ci><ci id="S2.E11.m1.7.7.1.1.2.3.cmml" xref="S2.E11.m1.7.7.1.1.2.3">𝑖</ci></apply><apply id="S2.E11.m1.6.6.cmml" xref="S2.E11.m1.6.6"><divide id="S2.E11.m1.6.6.7.cmml" xref="S2.E11.m1.6.6"></divide><apply id="S2.E11.m1.2.2.2.cmml" xref="S2.E11.m1.2.2.2"><times id="S2.E11.m1.2.2.2.3.cmml" xref="S2.E11.m1.2.2.2.3"></times><apply id="S2.E11.m1.2.2.2.4.cmml" xref="S2.E11.m1.2.2.2.4"><times id="S2.E11.m1.2.2.2.4.1.cmml" xref="S2.E11.m1.2.2.2.4.1"></times><apply id="S2.E11.m1.2.2.2.4.2.cmml" xref="S2.E11.m1.2.2.2.4.2"><times id="S2.E11.m1.2.2.2.4.2.1.cmml" xref="S2.E11.m1.2.2.2.4.2.1"></times><ci id="S2.E11.m1.2.2.2.4.2.2.cmml" xref="S2.E11.m1.2.2.2.4.2.2">𝑎</ci><ci id="S2.E11.m1.2.2.2.4.2.3.cmml" xref="S2.E11.m1.2.2.2.4.2.3">𝑐</ci><apply id="S2.E11.m1.2.2.2.4.2.4.cmml" xref="S2.E11.m1.2.2.2.4.2.4"><csymbol cd="ambiguous" id="S2.E11.m1.2.2.2.4.2.4.1.cmml" xref="S2.E11.m1.2.2.2.4.2.4">subscript</csymbol><ci id="S2.E11.m1.2.2.2.4.2.4.2.cmml" xref="S2.E11.m1.2.2.2.4.2.4.2">𝑐</ci><ci id="S2.E11.m1.2.2.2.4.2.4.3.cmml" xref="S2.E11.m1.2.2.2.4.2.4.3">𝑖</ci></apply></apply><ci id="S2.E11.m1.2.2.2.4.3.cmml" xref="S2.E11.m1.2.2.2.4.3">cs</ci></apply><interval closure="open" id="S2.E11.m1.2.2.2.2.3.cmml" xref="S2.E11.m1.2.2.2.2.2"><apply id="S2.E11.m1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E11.m1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E11.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E11.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E11.m1.1.1.1.1.1.1.2.2">𝒑</ci><ci id="S2.E11.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E11.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E11.m1.1.1.1.1.1.1.3.cmml" xref="S2.E11.m1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.E11.m1.2.2.2.2.2.2.cmml" xref="S2.E11.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E11.m1.2.2.2.2.2.2.1.cmml" xref="S2.E11.m1.2.2.2.2.2.2">superscript</csymbol><apply id="S2.E11.m1.2.2.2.2.2.2.2.cmml" xref="S2.E11.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E11.m1.2.2.2.2.2.2.2.1.cmml" xref="S2.E11.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E11.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.E11.m1.2.2.2.2.2.2.2.2">𝒑</ci><ci id="S2.E11.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.E11.m1.2.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S2.E11.m1.2.2.2.2.2.2.3.cmml" xref="S2.E11.m1.2.2.2.2.2.2.3">𝑝</ci></apply></interval></apply><apply id="S2.E11.m1.6.6.6.cmml" xref="S2.E11.m1.6.6.6"><apply id="S2.E11.m1.6.6.6.5.cmml" xref="S2.E11.m1.6.6.6.5"><csymbol cd="ambiguous" id="S2.E11.m1.6.6.6.5.1.cmml" xref="S2.E11.m1.6.6.6.5">superscript</csymbol><apply id="S2.E11.m1.6.6.6.5.2.cmml" xref="S2.E11.m1.6.6.6.5"><csymbol cd="ambiguous" id="S2.E11.m1.6.6.6.5.2.1.cmml" xref="S2.E11.m1.6.6.6.5">subscript</csymbol><sum id="S2.E11.m1.6.6.6.5.2.2.cmml" xref="S2.E11.m1.6.6.6.5.2.2"></sum><apply id="S2.E11.m1.4.4.4.2.2.3.cmml" xref="S2.E11.m1.4.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.E11.m1.4.4.4.2.2.3a.cmml" xref="S2.E11.m1.4.4.4.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E11.m1.3.3.3.1.1.1.1.cmml" xref="S2.E11.m1.3.3.3.1.1.1.1"><eq id="S2.E11.m1.3.3.3.1.1.1.1.1.cmml" xref="S2.E11.m1.3.3.3.1.1.1.1.1"></eq><ci id="S2.E11.m1.3.3.3.1.1.1.1.2.cmml" xref="S2.E11.m1.3.3.3.1.1.1.1.2">𝑗</ci><cn type="integer" id="S2.E11.m1.3.3.3.1.1.1.1.3.cmml" xref="S2.E11.m1.3.3.3.1.1.1.1.3">1</cn></apply><apply id="S2.E11.m1.4.4.4.2.2.2.2.cmml" xref="S2.E11.m1.4.4.4.2.2.2.2"><neq id="S2.E11.m1.4.4.4.2.2.2.2.1.cmml" xref="S2.E11.m1.4.4.4.2.2.2.2.1"></neq><ci id="S2.E11.m1.4.4.4.2.2.2.2.2.cmml" xref="S2.E11.m1.4.4.4.2.2.2.2.2">𝑗</ci><ci id="S2.E11.m1.4.4.4.2.2.2.2.3.cmml" xref="S2.E11.m1.4.4.4.2.2.2.2.3">𝑡</ci></apply></apply></apply><ci id="S2.E11.m1.6.6.6.5.3.cmml" xref="S2.E11.m1.6.6.6.5.3">𝑇</ci></apply><apply id="S2.E11.m1.6.6.6.4.cmml" xref="S2.E11.m1.6.6.6.4"><times id="S2.E11.m1.6.6.6.4.3.cmml" xref="S2.E11.m1.6.6.6.4.3"></times><apply id="S2.E11.m1.6.6.6.4.4.cmml" xref="S2.E11.m1.6.6.6.4.4"><times id="S2.E11.m1.6.6.6.4.4.1.cmml" xref="S2.E11.m1.6.6.6.4.4.1"></times><apply id="S2.E11.m1.6.6.6.4.4.2.cmml" xref="S2.E11.m1.6.6.6.4.4.2"><times id="S2.E11.m1.6.6.6.4.4.2.1.cmml" xref="S2.E11.m1.6.6.6.4.4.2.1"></times><ci id="S2.E11.m1.6.6.6.4.4.2.2.cmml" xref="S2.E11.m1.6.6.6.4.4.2.2">𝑎</ci><ci id="S2.E11.m1.6.6.6.4.4.2.3.cmml" xref="S2.E11.m1.6.6.6.4.4.2.3">𝑐</ci><apply id="S2.E11.m1.6.6.6.4.4.2.4.cmml" xref="S2.E11.m1.6.6.6.4.4.2.4"><csymbol cd="ambiguous" id="S2.E11.m1.6.6.6.4.4.2.4.1.cmml" xref="S2.E11.m1.6.6.6.4.4.2.4">subscript</csymbol><ci id="S2.E11.m1.6.6.6.4.4.2.4.2.cmml" xref="S2.E11.m1.6.6.6.4.4.2.4.2">𝑐</ci><ci id="S2.E11.m1.6.6.6.4.4.2.4.3.cmml" xref="S2.E11.m1.6.6.6.4.4.2.4.3">𝑗</ci></apply></apply><ci id="S2.E11.m1.6.6.6.4.4.3.cmml" xref="S2.E11.m1.6.6.6.4.4.3">cs</ci></apply><interval closure="open" id="S2.E11.m1.6.6.6.4.2.3.cmml" xref="S2.E11.m1.6.6.6.4.2.2"><apply id="S2.E11.m1.5.5.5.3.1.1.1.cmml" xref="S2.E11.m1.5.5.5.3.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.5.5.5.3.1.1.1.1.cmml" xref="S2.E11.m1.5.5.5.3.1.1.1">superscript</csymbol><apply id="S2.E11.m1.5.5.5.3.1.1.1.2.cmml" xref="S2.E11.m1.5.5.5.3.1.1.1"><csymbol cd="ambiguous" id="S2.E11.m1.5.5.5.3.1.1.1.2.1.cmml" xref="S2.E11.m1.5.5.5.3.1.1.1">subscript</csymbol><ci id="S2.E11.m1.5.5.5.3.1.1.1.2.2.cmml" xref="S2.E11.m1.5.5.5.3.1.1.1.2.2">𝒑</ci><ci id="S2.E11.m1.5.5.5.3.1.1.1.2.3.cmml" xref="S2.E11.m1.5.5.5.3.1.1.1.2.3">𝑗</ci></apply><ci id="S2.E11.m1.5.5.5.3.1.1.1.3.cmml" xref="S2.E11.m1.5.5.5.3.1.1.1.3">𝑝</ci></apply><apply id="S2.E11.m1.6.6.6.4.2.2.2.cmml" xref="S2.E11.m1.6.6.6.4.2.2.2"><csymbol cd="ambiguous" id="S2.E11.m1.6.6.6.4.2.2.2.1.cmml" xref="S2.E11.m1.6.6.6.4.2.2.2">superscript</csymbol><apply id="S2.E11.m1.6.6.6.4.2.2.2.2.cmml" xref="S2.E11.m1.6.6.6.4.2.2.2"><csymbol cd="ambiguous" id="S2.E11.m1.6.6.6.4.2.2.2.2.1.cmml" xref="S2.E11.m1.6.6.6.4.2.2.2">subscript</csymbol><ci id="S2.E11.m1.6.6.6.4.2.2.2.2.2.cmml" xref="S2.E11.m1.6.6.6.4.2.2.2.2.2">𝒑</ci><ci id="S2.E11.m1.6.6.6.4.2.2.2.2.3.cmml" xref="S2.E11.m1.6.6.6.4.2.2.2.2.3">𝑡</ci></apply><ci id="S2.E11.m1.6.6.6.4.2.2.2.3.cmml" xref="S2.E11.m1.6.6.6.4.2.2.2.3">𝑝</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m1.7c">\eta_{i}=\frac{acc_{i}\times\mathrm{cs}(\bm{p}_{i}^{p},\bm{p}_{t}^{p})}{\sum_{{j=1,j\neq t}}^{T}acc_{j}\times\mathrm{cs}(\bm{p}_{j}^{p},\bm{p}_{t}^{p})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p2.7" class="ltx_p"><span id="S2.SS3.p2.7.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.SS3.p2.4.m1.1" class="ltx_Math" alttext="acc_{i}" display="inline"><semantics id="S2.SS3.p2.4.m1.1a"><mrow id="S2.SS3.p2.4.m1.1.1" xref="S2.SS3.p2.4.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p2.4.m1.1.1.2" xref="S2.SS3.p2.4.m1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.4.m1.1.1.1" xref="S2.SS3.p2.4.m1.1.1.1.cmml">​</mo><mi mathsize="90%" id="S2.SS3.p2.4.m1.1.1.3" xref="S2.SS3.p2.4.m1.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.4.m1.1.1.1a" xref="S2.SS3.p2.4.m1.1.1.1.cmml">​</mo><msub id="S2.SS3.p2.4.m1.1.1.4" xref="S2.SS3.p2.4.m1.1.1.4.cmml"><mi mathsize="90%" id="S2.SS3.p2.4.m1.1.1.4.2" xref="S2.SS3.p2.4.m1.1.1.4.2.cmml">c</mi><mi mathsize="90%" id="S2.SS3.p2.4.m1.1.1.4.3" xref="S2.SS3.p2.4.m1.1.1.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m1.1b"><apply id="S2.SS3.p2.4.m1.1.1.cmml" xref="S2.SS3.p2.4.m1.1.1"><times id="S2.SS3.p2.4.m1.1.1.1.cmml" xref="S2.SS3.p2.4.m1.1.1.1"></times><ci id="S2.SS3.p2.4.m1.1.1.2.cmml" xref="S2.SS3.p2.4.m1.1.1.2">𝑎</ci><ci id="S2.SS3.p2.4.m1.1.1.3.cmml" xref="S2.SS3.p2.4.m1.1.1.3">𝑐</ci><apply id="S2.SS3.p2.4.m1.1.1.4.cmml" xref="S2.SS3.p2.4.m1.1.1.4"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m1.1.1.4.1.cmml" xref="S2.SS3.p2.4.m1.1.1.4">subscript</csymbol><ci id="S2.SS3.p2.4.m1.1.1.4.2.cmml" xref="S2.SS3.p2.4.m1.1.1.4.2">𝑐</ci><ci id="S2.SS3.p2.4.m1.1.1.4.3.cmml" xref="S2.SS3.p2.4.m1.1.1.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m1.1c">acc_{i}</annotation></semantics></math><span id="S2.SS3.p2.7.2" class="ltx_text" style="font-size:90%;"> denotes the current accuracy of the client </span><math id="S2.SS3.p2.5.m2.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S2.SS3.p2.5.m2.1a"><msub id="S2.SS3.p2.5.m2.1.1" xref="S2.SS3.p2.5.m2.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p2.5.m2.1.1.2" xref="S2.SS3.p2.5.m2.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS3.p2.5.m2.1.1.3" xref="S2.SS3.p2.5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m2.1b"><apply id="S2.SS3.p2.5.m2.1.1.cmml" xref="S2.SS3.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m2.1.1.1.cmml" xref="S2.SS3.p2.5.m2.1.1">subscript</csymbol><ci id="S2.SS3.p2.5.m2.1.1.2.cmml" xref="S2.SS3.p2.5.m2.1.1.2">𝑐</ci><ci id="S2.SS3.p2.5.m2.1.1.3.cmml" xref="S2.SS3.p2.5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m2.1c">c_{i}</annotation></semantics></math><span id="S2.SS3.p2.7.3" class="ltx_text" style="font-size:90%;"> in answering the question, and </span><math id="S2.SS3.p2.6.m3.1" class="ltx_Math" alttext="\mathrm{cs}(\cdot)" display="inline"><semantics id="S2.SS3.p2.6.m3.1a"><mrow id="S2.SS3.p2.6.m3.1.2" xref="S2.SS3.p2.6.m3.1.2.cmml"><mi mathsize="90%" id="S2.SS3.p2.6.m3.1.2.2" xref="S2.SS3.p2.6.m3.1.2.2.cmml">cs</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.6.m3.1.2.1" xref="S2.SS3.p2.6.m3.1.2.1.cmml">​</mo><mrow id="S2.SS3.p2.6.m3.1.2.3.2" xref="S2.SS3.p2.6.m3.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS3.p2.6.m3.1.2.3.2.1" xref="S2.SS3.p2.6.m3.1.2.cmml">(</mo><mo lspace="0em" mathsize="90%" rspace="0em" id="S2.SS3.p2.6.m3.1.1" xref="S2.SS3.p2.6.m3.1.1.cmml">⋅</mo><mo maxsize="90%" minsize="90%" id="S2.SS3.p2.6.m3.1.2.3.2.2" xref="S2.SS3.p2.6.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m3.1b"><apply id="S2.SS3.p2.6.m3.1.2.cmml" xref="S2.SS3.p2.6.m3.1.2"><times id="S2.SS3.p2.6.m3.1.2.1.cmml" xref="S2.SS3.p2.6.m3.1.2.1"></times><ci id="S2.SS3.p2.6.m3.1.2.2.cmml" xref="S2.SS3.p2.6.m3.1.2.2">cs</ci><ci id="S2.SS3.p2.6.m3.1.1.cmml" xref="S2.SS3.p2.6.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m3.1c">\mathrm{cs}(\cdot)</annotation></semantics></math><span id="S2.SS3.p2.7.4" class="ltx_text" style="font-size:90%;"> denotes cosine similarity.
It can be seen from Eq. (</span><a href="#S2.E11" title="In 2.3 Client-to-Client Communication ‣ 2 PROMPT-BASED PERSONALIZED FEDERATED LEARNING FOR MEDICAL VQA ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">11</span></a><span id="S2.SS3.p2.7.5" class="ltx_text" style="font-size:90%;">) that clients with high accuracy and higher similarity to the target client </span><math id="S2.SS3.p2.7.m4.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.SS3.p2.7.m4.1a"><msub id="S2.SS3.p2.7.m4.1.1" xref="S2.SS3.p2.7.m4.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p2.7.m4.1.1.2" xref="S2.SS3.p2.7.m4.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS3.p2.7.m4.1.1.3" xref="S2.SS3.p2.7.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m4.1b"><apply id="S2.SS3.p2.7.m4.1.1.cmml" xref="S2.SS3.p2.7.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m4.1.1.1.cmml" xref="S2.SS3.p2.7.m4.1.1">subscript</csymbol><ci id="S2.SS3.p2.7.m4.1.1.2.cmml" xref="S2.SS3.p2.7.m4.1.1.2">𝑐</ci><ci id="S2.SS3.p2.7.m4.1.1.3.cmml" xref="S2.SS3.p2.7.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m4.1c">c_{t}</annotation></semantics></math><span id="S2.SS3.p2.7.6" class="ltx_text" style="font-size:90%;"> have higher reliability in the communication process.
Therefore, introducing the reliability parameter makes clients refer more to the information from clients with high accuracy, similar to their tasks, preventing the interference of invalid information. We provide an overview of the client-to-client communication in Fig. </span><a href="#S2.F3" title="Figure 3 ‣ 2.3 Client-to-Client Communication ‣ 2 PROMPT-BASED PERSONALIZED FEDERATED LEARNING FOR MEDICAL VQA ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">3</span></a><span id="S2.SS3.p2.7.7" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.2" class="ltx_p"><span id="S2.SS3.p3.2.1" class="ltx_text" style="font-size:90%;">After several local iterations, the client </span><math id="S2.SS3.p3.1.m1.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.SS3.p3.1.m1.1a"><msub id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p3.1.m1.1.1.2" xref="S2.SS3.p3.1.m1.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS3.p3.1.m1.1.1.3" xref="S2.SS3.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><apply id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p3.1.m1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2">𝑐</ci><ci id="S2.SS3.p3.1.m1.1.1.3.cmml" xref="S2.SS3.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">c_{t}</annotation></semantics></math><span id="S2.SS3.p3.2.2" class="ltx_text" style="font-size:90%;"> interacts with other clients to update the shared information before making local updates. By sharing parameters between clients, the client </span><math id="S2.SS3.p3.2.m2.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.SS3.p3.2.m2.1a"><msub id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p3.2.m2.1.1.2" xref="S2.SS3.p3.2.m2.1.1.2.cmml">c</mi><mi mathsize="90%" id="S2.SS3.p3.2.m2.1.1.3" xref="S2.SS3.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><apply id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.1.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p3.2.m2.1.1.2.cmml" xref="S2.SS3.p3.2.m2.1.1.2">𝑐</ci><ci id="S2.SS3.p3.2.m2.1.1.3.cmml" xref="S2.SS3.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">c_{t}</annotation></semantics></math><span id="S2.SS3.p3.2.3" class="ltx_text" style="font-size:90%;"> can access additional information without changing the end-to-end training process that only accesses the private data. The main training procedure is summarized in Algorithm </span><a href="#alg1" title="Algorithm 1 ‣ 2.3 Client-to-Client Communication ‣ 2 PROMPT-BASED PERSONALIZED FEDERATED LEARNING FOR MEDICAL VQA ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">1</span></a><span id="S2.SS3.p3.2.4" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg1.4.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Prompt-based pFL method for medical VQA</figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span><span id="alg1.l0.2" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.l0.m1.1" class="ltx_Math" alttext="I" display="inline"><semantics id="alg1.l0.m1.1a"><mi mathsize="90%" id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">I</annotation></semantics></math><span id="alg1.l0.3" class="ltx_text" style="font-size:90%;">-Number of iterations, </span><math id="alg1.l0.m2.1" class="ltx_Math" alttext="I_{L}" display="inline"><semantics id="alg1.l0.m2.1a"><msub id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml"><mi mathsize="90%" id="alg1.l0.m2.1.1.2" xref="alg1.l0.m2.1.1.2.cmml">I</mi><mi mathsize="90%" id="alg1.l0.m2.1.1.3" xref="alg1.l0.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><apply id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.cmml" xref="alg1.l0.m2.1.1">subscript</csymbol><ci id="alg1.l0.m2.1.1.2.cmml" xref="alg1.l0.m2.1.1.2">𝐼</ci><ci id="alg1.l0.m2.1.1.3.cmml" xref="alg1.l0.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">I_{L}</annotation></semantics></math><span id="alg1.l0.4" class="ltx_text" style="font-size:90%;">-Number of local iterations, </span><math id="alg1.l0.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg1.l0.m3.1a"><mi mathsize="90%" id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">\alpha</annotation></semantics></math><span id="alg1.l0.5" class="ltx_text" style="font-size:90%;"> — learning rate, </span><math id="alg1.l0.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l0.m4.1a"><mi mathsize="90%" id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><ci id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">T</annotation></semantics></math><span id="alg1.l0.6" class="ltx_text" style="font-size:90%;">-Number of clients
</span>
</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text" style="font-size:90%;">  Initialization: client set </span><math id="alg1.l1.m1.3" class="ltx_Math" alttext="C=\{\bm{p}_{t}^{p},\bm{p}_{t}^{s},\mathbf{w}_{t}^{\mathrm{mlp}}\}_{t=1}^{T}" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml"><mi mathsize="90%" id="alg1.l1.m1.3.3.5" xref="alg1.l1.m1.3.3.5.cmml">C</mi><mo mathsize="90%" id="alg1.l1.m1.3.3.4" xref="alg1.l1.m1.3.3.4.cmml">=</mo><msubsup id="alg1.l1.m1.3.3.3" xref="alg1.l1.m1.3.3.3.cmml"><mrow id="alg1.l1.m1.3.3.3.3.3.3" xref="alg1.l1.m1.3.3.3.3.3.4.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l1.m1.3.3.3.3.3.3.4" xref="alg1.l1.m1.3.3.3.3.3.4.cmml">{</mo><msubsup id="alg1.l1.m1.1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l1.m1.1.1.1.1.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l1.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l1.m1.1.1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.1.1.3.cmml">p</mi></msubsup><mo mathsize="90%" id="alg1.l1.m1.3.3.3.3.3.3.5" xref="alg1.l1.m1.3.3.3.3.3.4.cmml">,</mo><msubsup id="alg1.l1.m1.2.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l1.m1.2.2.2.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="alg1.l1.m1.2.2.2.2.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.2.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l1.m1.2.2.2.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.2.2.2.3.cmml">s</mi></msubsup><mo mathsize="90%" id="alg1.l1.m1.3.3.3.3.3.3.6" xref="alg1.l1.m1.3.3.3.3.3.4.cmml">,</mo><msubsup id="alg1.l1.m1.3.3.3.3.3.3.3" xref="alg1.l1.m1.3.3.3.3.3.3.3.cmml"><mi mathsize="90%" id="alg1.l1.m1.3.3.3.3.3.3.3.2.2" xref="alg1.l1.m1.3.3.3.3.3.3.3.2.2.cmml">𝐰</mi><mi mathsize="90%" id="alg1.l1.m1.3.3.3.3.3.3.3.2.3" xref="alg1.l1.m1.3.3.3.3.3.3.3.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l1.m1.3.3.3.3.3.3.3.3" xref="alg1.l1.m1.3.3.3.3.3.3.3.3.cmml">mlp</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l1.m1.3.3.3.3.3.3.7" xref="alg1.l1.m1.3.3.3.3.3.4.cmml">}</mo></mrow><mrow id="alg1.l1.m1.3.3.3.3.5" xref="alg1.l1.m1.3.3.3.3.5.cmml"><mi mathsize="90%" id="alg1.l1.m1.3.3.3.3.5.2" xref="alg1.l1.m1.3.3.3.3.5.2.cmml">t</mi><mo mathsize="90%" id="alg1.l1.m1.3.3.3.3.5.1" xref="alg1.l1.m1.3.3.3.3.5.1.cmml">=</mo><mn mathsize="90%" id="alg1.l1.m1.3.3.3.3.5.3" xref="alg1.l1.m1.3.3.3.3.5.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l1.m1.3.3.3.5" xref="alg1.l1.m1.3.3.3.5.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3"><eq id="alg1.l1.m1.3.3.4.cmml" xref="alg1.l1.m1.3.3.4"></eq><ci id="alg1.l1.m1.3.3.5.cmml" xref="alg1.l1.m1.3.3.5">𝐶</ci><apply id="alg1.l1.m1.3.3.3.cmml" xref="alg1.l1.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.3.4.cmml" xref="alg1.l1.m1.3.3.3">superscript</csymbol><apply id="alg1.l1.m1.3.3.3.3.cmml" xref="alg1.l1.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.3.3.4.cmml" xref="alg1.l1.m1.3.3.3">subscript</csymbol><set id="alg1.l1.m1.3.3.3.3.3.4.cmml" xref="alg1.l1.m1.3.3.3.3.3.3"><apply id="alg1.l1.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l1.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.2.2">𝒑</ci><ci id="alg1.l1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l1.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="alg1.l1.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.l1.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2.2.2">𝒑</ci><ci id="alg1.l1.m1.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l1.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2.3">𝑠</ci></apply><apply id="alg1.l1.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l1.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.3.3.3.3.3.1.cmml" xref="alg1.l1.m1.3.3.3.3.3.3.3">superscript</csymbol><apply id="alg1.l1.m1.3.3.3.3.3.3.3.2.cmml" xref="alg1.l1.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.3.3.3.3.3.2.1.cmml" xref="alg1.l1.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="alg1.l1.m1.3.3.3.3.3.3.3.2.2.cmml" xref="alg1.l1.m1.3.3.3.3.3.3.3.2.2">𝐰</ci><ci id="alg1.l1.m1.3.3.3.3.3.3.3.2.3.cmml" xref="alg1.l1.m1.3.3.3.3.3.3.3.2.3">𝑡</ci></apply><ci id="alg1.l1.m1.3.3.3.3.3.3.3.3.cmml" xref="alg1.l1.m1.3.3.3.3.3.3.3.3">mlp</ci></apply></set><apply id="alg1.l1.m1.3.3.3.3.5.cmml" xref="alg1.l1.m1.3.3.3.3.5"><eq id="alg1.l1.m1.3.3.3.3.5.1.cmml" xref="alg1.l1.m1.3.3.3.3.5.1"></eq><ci id="alg1.l1.m1.3.3.3.3.5.2.cmml" xref="alg1.l1.m1.3.3.3.3.5.2">𝑡</ci><cn type="integer" id="alg1.l1.m1.3.3.3.3.5.3.cmml" xref="alg1.l1.m1.3.3.3.3.5.3">1</cn></apply></apply><ci id="alg1.l1.m1.3.3.3.5.cmml" xref="alg1.l1.m1.3.3.3.5">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">C=\{\bm{p}_{t}^{p},\bm{p}_{t}^{s},\mathbf{w}_{t}^{\mathrm{mlp}}\}_{t=1}^{T}</annotation></semantics></math><span id="alg1.l1.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2.2" class="ltx_text" style="font-size:90%;">  </span><span id="alg1.l2.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l2.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l2.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">i</mi><mo mathsize="90%" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><eq id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></eq><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">i=1</annotation></semantics></math><span id="alg1.l2.5" class="ltx_text" style="font-size:90%;"> to </span><math id="alg1.l2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="alg1.l2.m2.1a"><mi mathsize="90%" id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">I</annotation></semantics></math><span id="alg1.l2.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l2.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l2.8" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg1.l3.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg1.l3.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l3.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l3.m1.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">t</mi><mo mathsize="90%" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">t=1</annotation></semantics></math><span id="alg1.l3.5" class="ltx_text" style="font-size:90%;"> to </span><math id="alg1.l3.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l3.m2.1a"><mi mathsize="90%" id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">T</annotation></semantics></math><span id="alg1.l3.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l3.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l3.8" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.2" class="ltx_text" style="font-size:90%;">        </span><span id="alg1.l4.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l4.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l4.m1.1" class="ltx_Math" alttext="j=1" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">j</mi><mo mathsize="90%" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑗</ci><cn type="integer" id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">j=1</annotation></semantics></math><span id="alg1.l4.5" class="ltx_text" style="font-size:90%;"> to </span><math id="alg1.l4.m2.1" class="ltx_Math" alttext="I_{L}" display="inline"><semantics id="alg1.l4.m2.1a"><msub id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mi mathsize="90%" id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml">I</mi><mi mathsize="90%" id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1">subscript</csymbol><ci id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2">𝐼</ci><ci id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">I_{L}</annotation></semantics></math><span id="alg1.l4.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l4.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l4.8" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg1.l5.2" class="ltx_text" style="font-size:90%;">           </span><math id="alg1.l5.m1.2" class="ltx_Math" alttext="\bm{p}_{t}^{p}=\bm{p}_{t}^{p}-\alpha\nabla_{\bm{p}_{t}^{p}}(\mathcal{L}_{\mathrm{client}}+\mathcal{L}_{d})" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml"><msubsup id="alg1.l5.m1.2.2.4" xref="alg1.l5.m1.2.2.4.cmml"><mi mathsize="90%" id="alg1.l5.m1.2.2.4.2.2" xref="alg1.l5.m1.2.2.4.2.2.cmml">𝒑</mi><mi mathsize="90%" id="alg1.l5.m1.2.2.4.2.3" xref="alg1.l5.m1.2.2.4.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l5.m1.2.2.4.3" xref="alg1.l5.m1.2.2.4.3.cmml">p</mi></msubsup><mo mathsize="90%" id="alg1.l5.m1.2.2.3" xref="alg1.l5.m1.2.2.3.cmml">=</mo><mrow id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.2.cmml"><msubsup id="alg1.l5.m1.2.2.2.4" xref="alg1.l5.m1.2.2.2.4.cmml"><mi mathsize="90%" id="alg1.l5.m1.2.2.2.4.2.2" xref="alg1.l5.m1.2.2.2.4.2.2.cmml">𝒑</mi><mi mathsize="90%" id="alg1.l5.m1.2.2.2.4.2.3" xref="alg1.l5.m1.2.2.2.4.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l5.m1.2.2.2.4.3" xref="alg1.l5.m1.2.2.2.4.3.cmml">p</mi></msubsup><mo mathsize="90%" id="alg1.l5.m1.2.2.2.3" xref="alg1.l5.m1.2.2.2.3.cmml">−</mo><mrow id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l5.m1.2.2.2.2.4" xref="alg1.l5.m1.2.2.2.2.4.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="alg1.l5.m1.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l5.m1.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.3.cmml"><msub id="alg1.l5.m1.1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.1.cmml"><mo mathsize="90%" id="alg1.l5.m1.1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.1.2.cmml">∇</mo><msubsup id="alg1.l5.m1.1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l5.m1.1.1.1.1.1.1.1.3.2.2" xref="alg1.l5.m1.1.1.1.1.1.1.1.3.2.2.cmml">𝒑</mi><mi mathsize="90%" id="alg1.l5.m1.1.1.1.1.1.1.1.3.2.3" xref="alg1.l5.m1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l5.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l5.m1.1.1.1.1.1.1.1.3.3.cmml">p</mi></msubsup></msub><mrow id="alg1.l5.m1.2.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l5.m1.2.2.2.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.3.cmml">(</mo><mrow id="alg1.l5.m1.2.2.2.2.2.2.2.1" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.cmml"><msub id="alg1.l5.m1.2.2.2.2.2.2.2.1.2" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l5.m1.2.2.2.2.2.2.2.1.2.2" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.2.2.cmml">ℒ</mi><mi mathsize="90%" id="alg1.l5.m1.2.2.2.2.2.2.2.1.2.3" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.2.3.cmml">client</mi></msub><mo mathsize="90%" id="alg1.l5.m1.2.2.2.2.2.2.2.1.1" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.1.cmml">+</mo><msub id="alg1.l5.m1.2.2.2.2.2.2.2.1.3" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l5.m1.2.2.2.2.2.2.2.1.3.2" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.3.2.cmml">ℒ</mi><mi mathsize="90%" id="alg1.l5.m1.2.2.2.2.2.2.2.1.3.3" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.3.3.cmml">d</mi></msub></mrow><mo maxsize="90%" minsize="90%" id="alg1.l5.m1.2.2.2.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2"><eq id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.3"></eq><apply id="alg1.l5.m1.2.2.4.cmml" xref="alg1.l5.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.4.1.cmml" xref="alg1.l5.m1.2.2.4">superscript</csymbol><apply id="alg1.l5.m1.2.2.4.2.cmml" xref="alg1.l5.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.4.2.1.cmml" xref="alg1.l5.m1.2.2.4">subscript</csymbol><ci id="alg1.l5.m1.2.2.4.2.2.cmml" xref="alg1.l5.m1.2.2.4.2.2">𝒑</ci><ci id="alg1.l5.m1.2.2.4.2.3.cmml" xref="alg1.l5.m1.2.2.4.2.3">𝑡</ci></apply><ci id="alg1.l5.m1.2.2.4.3.cmml" xref="alg1.l5.m1.2.2.4.3">𝑝</ci></apply><apply id="alg1.l5.m1.2.2.2.cmml" xref="alg1.l5.m1.2.2.2"><minus id="alg1.l5.m1.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.3"></minus><apply id="alg1.l5.m1.2.2.2.4.cmml" xref="alg1.l5.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.4.1.cmml" xref="alg1.l5.m1.2.2.2.4">superscript</csymbol><apply id="alg1.l5.m1.2.2.2.4.2.cmml" xref="alg1.l5.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.4.2.1.cmml" xref="alg1.l5.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.4.2.2.cmml" xref="alg1.l5.m1.2.2.2.4.2.2">𝒑</ci><ci id="alg1.l5.m1.2.2.2.4.2.3.cmml" xref="alg1.l5.m1.2.2.2.4.2.3">𝑡</ci></apply><ci id="alg1.l5.m1.2.2.2.4.3.cmml" xref="alg1.l5.m1.2.2.2.4.3">𝑝</ci></apply><apply id="alg1.l5.m1.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2"><times id="alg1.l5.m1.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.3"></times><ci id="alg1.l5.m1.2.2.2.2.4.cmml" xref="alg1.l5.m1.2.2.2.2.4">𝛼</ci><apply id="alg1.l5.m1.2.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.2"><apply id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.2">∇</ci><apply id="alg1.l5.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="alg1.l5.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.3.2.2">𝒑</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l5.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.3.3">𝑝</ci></apply></apply><apply id="alg1.l5.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.1"><plus id="alg1.l5.m1.2.2.2.2.2.2.2.1.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.1"></plus><apply id="alg1.l5.m1.2.2.2.2.2.2.2.1.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.2.2.1.2.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.2">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.2.2.1.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.2.2">ℒ</ci><ci id="alg1.l5.m1.2.2.2.2.2.2.2.1.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.2.3">client</ci></apply><apply id="alg1.l5.m1.2.2.2.2.2.2.2.1.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.2.2.2.1.3.1.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.3">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.2.2.1.3.2.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.3.2">ℒ</ci><ci id="alg1.l5.m1.2.2.2.2.2.2.2.1.3.3.cmml" xref="alg1.l5.m1.2.2.2.2.2.2.2.1.3.3">𝑑</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">\bm{p}_{t}^{p}=\bm{p}_{t}^{p}-\alpha\nabla_{\bm{p}_{t}^{p}}(\mathcal{L}_{\mathrm{client}}+\mathcal{L}_{d})</annotation></semantics></math><span id="alg1.l5.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6.2" class="ltx_text" style="font-size:90%;">           </span><math id="alg1.l6.m1.1" class="ltx_Math" alttext="\bm{w}_{t}^{\mathrm{mlp}}=\bm{w}_{t}^{\mathrm{mlp}}-\alpha\nabla_{\bm{w}_{t}^{\mathrm{mlp}}}\mathcal{L}_{\mathrm{client}}-\beta\nabla_{\bm{w}_{t}^{\mathrm{mlp}}}\|\bm{w}_{t}^{\mathrm{mlp}}\|_{2}^{2}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msubsup id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l6.m1.1.1.3.2.2" xref="alg1.l6.m1.1.1.3.2.2.cmml">𝒘</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.3.2.3" xref="alg1.l6.m1.1.1.3.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">mlp</mi></msubsup><mo mathsize="90%" id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">=</mo><mrow id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><msubsup id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l6.m1.1.1.1.3.2.2" xref="alg1.l6.m1.1.1.1.3.2.2.cmml">𝒘</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.1.3.2.3" xref="alg1.l6.m1.1.1.1.3.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.3.3.cmml">mlp</mi></msubsup><mo mathsize="90%" id="alg1.l6.m1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l6.m1.1.1.1.4" xref="alg1.l6.m1.1.1.1.4.cmml"><mi mathsize="90%" id="alg1.l6.m1.1.1.1.4.2" xref="alg1.l6.m1.1.1.1.4.2.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="alg1.l6.m1.1.1.1.4.1" xref="alg1.l6.m1.1.1.1.4.1.cmml">​</mo><mrow id="alg1.l6.m1.1.1.1.4.3" xref="alg1.l6.m1.1.1.1.4.3.cmml"><msub id="alg1.l6.m1.1.1.1.4.3.1" xref="alg1.l6.m1.1.1.1.4.3.1.cmml"><mo mathsize="90%" rspace="0.167em" id="alg1.l6.m1.1.1.1.4.3.1.2" xref="alg1.l6.m1.1.1.1.4.3.1.2.cmml">∇</mo><msubsup id="alg1.l6.m1.1.1.1.4.3.1.3" xref="alg1.l6.m1.1.1.1.4.3.1.3.cmml"><mi mathsize="90%" id="alg1.l6.m1.1.1.1.4.3.1.3.2.2" xref="alg1.l6.m1.1.1.1.4.3.1.3.2.2.cmml">𝒘</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.1.4.3.1.3.2.3" xref="alg1.l6.m1.1.1.1.4.3.1.3.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.1.4.3.1.3.3" xref="alg1.l6.m1.1.1.1.4.3.1.3.3.cmml">mlp</mi></msubsup></msub><msub id="alg1.l6.m1.1.1.1.4.3.2" xref="alg1.l6.m1.1.1.1.4.3.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l6.m1.1.1.1.4.3.2.2" xref="alg1.l6.m1.1.1.1.4.3.2.2.cmml">ℒ</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.1.4.3.2.3" xref="alg1.l6.m1.1.1.1.4.3.2.3.cmml">client</mi></msub></mrow></mrow><mo mathsize="90%" id="alg1.l6.m1.1.1.1.2a" xref="alg1.l6.m1.1.1.1.2.cmml">−</mo><mrow id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.3.cmml">β</mi><mo lspace="0.167em" rspace="0em" id="alg1.l6.m1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.2.cmml"><mo mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.2.2.cmml">∇</mo><msubsup id="alg1.l6.m1.1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.2.3.2.2" xref="alg1.l6.m1.1.1.1.1.1.2.3.2.2.cmml">𝒘</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.2.3.2.3" xref="alg1.l6.m1.1.1.1.1.1.2.3.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.2.3.3" xref="alg1.l6.m1.1.1.1.1.1.2.3.3.cmml">mlp</mi></msubsup></msub><msubsup id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mrow id="alg1.l6.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒘</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">mlp</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml">2</mn><mn mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><eq id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"></eq><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">superscript</csymbol><apply id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.3.2.2">𝒘</ci><ci id="alg1.l6.m1.1.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">mlp</ci></apply><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><minus id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.2"></minus><apply id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.3">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.1.3.2.2">𝒘</ci><ci id="alg1.l6.m1.1.1.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.3">mlp</ci></apply><apply id="alg1.l6.m1.1.1.1.4.cmml" xref="alg1.l6.m1.1.1.1.4"><times id="alg1.l6.m1.1.1.1.4.1.cmml" xref="alg1.l6.m1.1.1.1.4.1"></times><ci id="alg1.l6.m1.1.1.1.4.2.cmml" xref="alg1.l6.m1.1.1.1.4.2">𝛼</ci><apply id="alg1.l6.m1.1.1.1.4.3.cmml" xref="alg1.l6.m1.1.1.1.4.3"><apply id="alg1.l6.m1.1.1.1.4.3.1.cmml" xref="alg1.l6.m1.1.1.1.4.3.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.4.3.1.1.cmml" xref="alg1.l6.m1.1.1.1.4.3.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.4.3.1.2.cmml" xref="alg1.l6.m1.1.1.1.4.3.1.2">∇</ci><apply id="alg1.l6.m1.1.1.1.4.3.1.3.cmml" xref="alg1.l6.m1.1.1.1.4.3.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.4.3.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.4.3.1.3">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.4.3.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.4.3.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.4.3.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.1.4.3.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.4.3.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.1.4.3.1.3.2.2">𝒘</ci><ci id="alg1.l6.m1.1.1.1.4.3.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.1.4.3.1.3.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.1.1.1.4.3.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.4.3.1.3.3">mlp</ci></apply></apply><apply id="alg1.l6.m1.1.1.1.4.3.2.cmml" xref="alg1.l6.m1.1.1.1.4.3.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.4.3.2.1.cmml" xref="alg1.l6.m1.1.1.1.4.3.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.4.3.2.2.cmml" xref="alg1.l6.m1.1.1.1.4.3.2.2">ℒ</ci><ci id="alg1.l6.m1.1.1.1.4.3.2.3.cmml" xref="alg1.l6.m1.1.1.1.4.3.2.3">client</ci></apply></apply></apply><apply id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1"><times id="alg1.l6.m1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.2"></times><ci id="alg1.l6.m1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.3">𝛽</ci><apply id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><apply id="alg1.l6.m1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.2">∇</ci><apply id="alg1.l6.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.3">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.2.3.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.2.3.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.3.2.2">𝒘</ci><ci id="alg1.l6.m1.1.1.1.1.1.2.3.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.3.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.3.3">mlp</ci></apply></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l6.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝒘</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.3">mlp</ci></apply></apply><cn type="integer" id="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="alg1.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\bm{w}_{t}^{\mathrm{mlp}}=\bm{w}_{t}^{\mathrm{mlp}}-\alpha\nabla_{\bm{w}_{t}^{\mathrm{mlp}}}\mathcal{L}_{\mathrm{client}}-\beta\nabla_{\bm{w}_{t}^{\mathrm{mlp}}}\|\bm{w}_{t}^{\mathrm{mlp}}\|_{2}^{2}</annotation></semantics></math><span id="alg1.l6.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg1.l7.2" class="ltx_text" style="font-size:90%;">        </span><span id="alg1.l7.3" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg1.l7.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l7.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg1.l8.2" class="ltx_text" style="font-size:90%;">        </span><math id="alg1.l8.m1.1" class="ltx_Math" alttext="\bm{p}_{t}^{s}=\sum_{\begin{subarray}{c}i=1,\ i\neq t\end{subarray}}^{T}\eta_{i}\bm{p}_{i}^{p}" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.2" xref="alg1.l8.m1.1.2.cmml"><msubsup id="alg1.l8.m1.1.2.2" xref="alg1.l8.m1.1.2.2.cmml"><mi mathsize="90%" id="alg1.l8.m1.1.2.2.2.2" xref="alg1.l8.m1.1.2.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="alg1.l8.m1.1.2.2.2.3" xref="alg1.l8.m1.1.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l8.m1.1.2.2.3" xref="alg1.l8.m1.1.2.2.3.cmml">s</mi></msubsup><mo mathsize="90%" rspace="0.111em" id="alg1.l8.m1.1.2.1" xref="alg1.l8.m1.1.2.1.cmml">=</mo><mrow id="alg1.l8.m1.1.2.3" xref="alg1.l8.m1.1.2.3.cmml"><msubsup id="alg1.l8.m1.1.2.3.1" xref="alg1.l8.m1.1.2.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="alg1.l8.m1.1.2.3.1.2.2" xref="alg1.l8.m1.1.2.3.1.2.2.cmml">∑</mo><mtable id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.2.cmml"><mtr id="alg1.l8.m1.1.1.1.1.1.1a" xref="alg1.l8.m1.1.1.1.2.cmml"><mtd id="alg1.l8.m1.1.1.1.1.1.1b" xref="alg1.l8.m1.1.1.1.2.cmml"><mrow id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mrow id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mn id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.517em" id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.3a.cmml">,</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml">i</mi><mo id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.1" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml">≠</mo><mi id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml">t</mi></mrow></mrow></mtd></mtr></mtable><mi mathsize="90%" id="alg1.l8.m1.1.2.3.1.3" xref="alg1.l8.m1.1.2.3.1.3.cmml">T</mi></msubsup><mrow id="alg1.l8.m1.1.2.3.2" xref="alg1.l8.m1.1.2.3.2.cmml"><msub id="alg1.l8.m1.1.2.3.2.2" xref="alg1.l8.m1.1.2.3.2.2.cmml"><mi mathsize="90%" id="alg1.l8.m1.1.2.3.2.2.2" xref="alg1.l8.m1.1.2.3.2.2.2.cmml">η</mi><mi mathsize="90%" id="alg1.l8.m1.1.2.3.2.2.3" xref="alg1.l8.m1.1.2.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.2.3.2.1" xref="alg1.l8.m1.1.2.3.2.1.cmml">​</mo><msubsup id="alg1.l8.m1.1.2.3.2.3" xref="alg1.l8.m1.1.2.3.2.3.cmml"><mi mathsize="90%" id="alg1.l8.m1.1.2.3.2.3.2.2" xref="alg1.l8.m1.1.2.3.2.3.2.2.cmml">𝒑</mi><mi mathsize="90%" id="alg1.l8.m1.1.2.3.2.3.2.3" xref="alg1.l8.m1.1.2.3.2.3.2.3.cmml">i</mi><mi mathsize="90%" id="alg1.l8.m1.1.2.3.2.3.3" xref="alg1.l8.m1.1.2.3.2.3.3.cmml">p</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.2.cmml" xref="alg1.l8.m1.1.2"><eq id="alg1.l8.m1.1.2.1.cmml" xref="alg1.l8.m1.1.2.1"></eq><apply id="alg1.l8.m1.1.2.2.cmml" xref="alg1.l8.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.2.1.cmml" xref="alg1.l8.m1.1.2.2">superscript</csymbol><apply id="alg1.l8.m1.1.2.2.2.cmml" xref="alg1.l8.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.2.2.1.cmml" xref="alg1.l8.m1.1.2.2">subscript</csymbol><ci id="alg1.l8.m1.1.2.2.2.2.cmml" xref="alg1.l8.m1.1.2.2.2.2">𝒑</ci><ci id="alg1.l8.m1.1.2.2.2.3.cmml" xref="alg1.l8.m1.1.2.2.2.3">𝑡</ci></apply><ci id="alg1.l8.m1.1.2.2.3.cmml" xref="alg1.l8.m1.1.2.2.3">𝑠</ci></apply><apply id="alg1.l8.m1.1.2.3.cmml" xref="alg1.l8.m1.1.2.3"><apply id="alg1.l8.m1.1.2.3.1.cmml" xref="alg1.l8.m1.1.2.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.3.1.1.cmml" xref="alg1.l8.m1.1.2.3.1">superscript</csymbol><apply id="alg1.l8.m1.1.2.3.1.2.cmml" xref="alg1.l8.m1.1.2.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.3.1.2.1.cmml" xref="alg1.l8.m1.1.2.3.1">subscript</csymbol><sum id="alg1.l8.m1.1.2.3.1.2.2.cmml" xref="alg1.l8.m1.1.2.3.1.2.2"></sum><list id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1"><matrix id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1"><matrixrow id="alg1.l8.m1.1.1.1.1.1.1a.cmml" xref="alg1.l8.m1.1.1.1.1.1.1"><apply id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.3a.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1"><eq id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"></eq><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2"><neq id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.1"></neq><ci id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.2">𝑖</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.2.2.3">𝑡</ci></apply></apply></matrixrow></matrix></list></apply><ci id="alg1.l8.m1.1.2.3.1.3.cmml" xref="alg1.l8.m1.1.2.3.1.3">𝑇</ci></apply><apply id="alg1.l8.m1.1.2.3.2.cmml" xref="alg1.l8.m1.1.2.3.2"><times id="alg1.l8.m1.1.2.3.2.1.cmml" xref="alg1.l8.m1.1.2.3.2.1"></times><apply id="alg1.l8.m1.1.2.3.2.2.cmml" xref="alg1.l8.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.3.2.2.1.cmml" xref="alg1.l8.m1.1.2.3.2.2">subscript</csymbol><ci id="alg1.l8.m1.1.2.3.2.2.2.cmml" xref="alg1.l8.m1.1.2.3.2.2.2">𝜂</ci><ci id="alg1.l8.m1.1.2.3.2.2.3.cmml" xref="alg1.l8.m1.1.2.3.2.2.3">𝑖</ci></apply><apply id="alg1.l8.m1.1.2.3.2.3.cmml" xref="alg1.l8.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.3.2.3.1.cmml" xref="alg1.l8.m1.1.2.3.2.3">superscript</csymbol><apply id="alg1.l8.m1.1.2.3.2.3.2.cmml" xref="alg1.l8.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.3.2.3.2.1.cmml" xref="alg1.l8.m1.1.2.3.2.3">subscript</csymbol><ci id="alg1.l8.m1.1.2.3.2.3.2.2.cmml" xref="alg1.l8.m1.1.2.3.2.3.2.2">𝒑</ci><ci id="alg1.l8.m1.1.2.3.2.3.2.3.cmml" xref="alg1.l8.m1.1.2.3.2.3.2.3">𝑖</ci></apply><ci id="alg1.l8.m1.1.2.3.2.3.3.cmml" xref="alg1.l8.m1.1.2.3.2.3.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\bm{p}_{t}^{s}=\sum_{\begin{subarray}{c}i=1,\ i\neq t\end{subarray}}^{T}\eta_{i}\bm{p}_{i}^{p}</annotation></semantics></math><span id="alg1.l8.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg1.l9.2" class="ltx_text" style="font-size:90%;">     </span><span id="alg1.l9.3" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg1.l9.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l9.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg1.l10.2" class="ltx_text" style="font-size:90%;">  </span><span id="alg1.l10.3" class="ltx_text ltx_font_bold" style="font-size:90%;">end</span><span id="alg1.l10.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l10.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span>
</div>
<div id="alg1.l10a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10a.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg1.l10a.2" class="ltx_text" style="font-size:90%;">  </span><math id="alg1.l10a.m1.3" class="ltx_Math" alttext="C=\{\bm{p}_{t}^{p},\bm{p}_{t}^{s},\bm{w}_{t}^{\mathrm{mlp}}\}_{t=1}^{T}" display="inline"><semantics id="alg1.l10a.m1.3a"><mrow id="alg1.l10a.m1.3.3" xref="alg1.l10a.m1.3.3.cmml"><mi mathsize="90%" id="alg1.l10a.m1.3.3.5" xref="alg1.l10a.m1.3.3.5.cmml">C</mi><mo mathsize="90%" id="alg1.l10a.m1.3.3.4" xref="alg1.l10a.m1.3.3.4.cmml">=</mo><msubsup id="alg1.l10a.m1.3.3.3" xref="alg1.l10a.m1.3.3.3.cmml"><mrow id="alg1.l10a.m1.3.3.3.3.3.3" xref="alg1.l10a.m1.3.3.3.3.3.4.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l10a.m1.3.3.3.3.3.3.4" xref="alg1.l10a.m1.3.3.3.3.3.4.cmml">{</mo><msubsup id="alg1.l10a.m1.1.1.1.1.1.1.1" xref="alg1.l10a.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l10a.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l10a.m1.1.1.1.1.1.1.1.2.2.cmml">𝒑</mi><mi mathsize="90%" id="alg1.l10a.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l10a.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l10a.m1.1.1.1.1.1.1.1.3" xref="alg1.l10a.m1.1.1.1.1.1.1.1.3.cmml">p</mi></msubsup><mo mathsize="90%" id="alg1.l10a.m1.3.3.3.3.3.3.5" xref="alg1.l10a.m1.3.3.3.3.3.4.cmml">,</mo><msubsup id="alg1.l10a.m1.2.2.2.2.2.2.2" xref="alg1.l10a.m1.2.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l10a.m1.2.2.2.2.2.2.2.2.2" xref="alg1.l10a.m1.2.2.2.2.2.2.2.2.2.cmml">𝒑</mi><mi mathsize="90%" id="alg1.l10a.m1.2.2.2.2.2.2.2.2.3" xref="alg1.l10a.m1.2.2.2.2.2.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l10a.m1.2.2.2.2.2.2.2.3" xref="alg1.l10a.m1.2.2.2.2.2.2.2.3.cmml">s</mi></msubsup><mo mathsize="90%" id="alg1.l10a.m1.3.3.3.3.3.3.6" xref="alg1.l10a.m1.3.3.3.3.3.4.cmml">,</mo><msubsup id="alg1.l10a.m1.3.3.3.3.3.3.3" xref="alg1.l10a.m1.3.3.3.3.3.3.3.cmml"><mi mathsize="90%" id="alg1.l10a.m1.3.3.3.3.3.3.3.2.2" xref="alg1.l10a.m1.3.3.3.3.3.3.3.2.2.cmml">𝒘</mi><mi mathsize="90%" id="alg1.l10a.m1.3.3.3.3.3.3.3.2.3" xref="alg1.l10a.m1.3.3.3.3.3.3.3.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.l10a.m1.3.3.3.3.3.3.3.3" xref="alg1.l10a.m1.3.3.3.3.3.3.3.3.cmml">mlp</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.l10a.m1.3.3.3.3.3.3.7" xref="alg1.l10a.m1.3.3.3.3.3.4.cmml">}</mo></mrow><mrow id="alg1.l10a.m1.3.3.3.3.5" xref="alg1.l10a.m1.3.3.3.3.5.cmml"><mi mathsize="90%" id="alg1.l10a.m1.3.3.3.3.5.2" xref="alg1.l10a.m1.3.3.3.3.5.2.cmml">t</mi><mo mathsize="90%" id="alg1.l10a.m1.3.3.3.3.5.1" xref="alg1.l10a.m1.3.3.3.3.5.1.cmml">=</mo><mn mathsize="90%" id="alg1.l10a.m1.3.3.3.3.5.3" xref="alg1.l10a.m1.3.3.3.3.5.3.cmml">1</mn></mrow><mi mathsize="90%" id="alg1.l10a.m1.3.3.3.5" xref="alg1.l10a.m1.3.3.3.5.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10a.m1.3b"><apply id="alg1.l10a.m1.3.3.cmml" xref="alg1.l10a.m1.3.3"><eq id="alg1.l10a.m1.3.3.4.cmml" xref="alg1.l10a.m1.3.3.4"></eq><ci id="alg1.l10a.m1.3.3.5.cmml" xref="alg1.l10a.m1.3.3.5">𝐶</ci><apply id="alg1.l10a.m1.3.3.3.cmml" xref="alg1.l10a.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l10a.m1.3.3.3.4.cmml" xref="alg1.l10a.m1.3.3.3">superscript</csymbol><apply id="alg1.l10a.m1.3.3.3.3.cmml" xref="alg1.l10a.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l10a.m1.3.3.3.3.4.cmml" xref="alg1.l10a.m1.3.3.3">subscript</csymbol><set id="alg1.l10a.m1.3.3.3.3.3.4.cmml" xref="alg1.l10a.m1.3.3.3.3.3.3"><apply id="alg1.l10a.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l10a.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10a.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10a.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l10a.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l10a.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10a.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l10a.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10a.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l10a.m1.1.1.1.1.1.1.1.2.2">𝒑</ci><ci id="alg1.l10a.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l10a.m1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l10a.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l10a.m1.1.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="alg1.l10a.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l10a.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10a.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l10a.m1.2.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.l10a.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l10a.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10a.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l10a.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l10a.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l10a.m1.2.2.2.2.2.2.2.2.2">𝒑</ci><ci id="alg1.l10a.m1.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l10a.m1.2.2.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l10a.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l10a.m1.2.2.2.2.2.2.2.3">𝑠</ci></apply><apply id="alg1.l10a.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l10a.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l10a.m1.3.3.3.3.3.3.3.1.cmml" xref="alg1.l10a.m1.3.3.3.3.3.3.3">superscript</csymbol><apply id="alg1.l10a.m1.3.3.3.3.3.3.3.2.cmml" xref="alg1.l10a.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l10a.m1.3.3.3.3.3.3.3.2.1.cmml" xref="alg1.l10a.m1.3.3.3.3.3.3.3">subscript</csymbol><ci id="alg1.l10a.m1.3.3.3.3.3.3.3.2.2.cmml" xref="alg1.l10a.m1.3.3.3.3.3.3.3.2.2">𝒘</ci><ci id="alg1.l10a.m1.3.3.3.3.3.3.3.2.3.cmml" xref="alg1.l10a.m1.3.3.3.3.3.3.3.2.3">𝑡</ci></apply><ci id="alg1.l10a.m1.3.3.3.3.3.3.3.3.cmml" xref="alg1.l10a.m1.3.3.3.3.3.3.3.3">mlp</ci></apply></set><apply id="alg1.l10a.m1.3.3.3.3.5.cmml" xref="alg1.l10a.m1.3.3.3.3.5"><eq id="alg1.l10a.m1.3.3.3.3.5.1.cmml" xref="alg1.l10a.m1.3.3.3.3.5.1"></eq><ci id="alg1.l10a.m1.3.3.3.3.5.2.cmml" xref="alg1.l10a.m1.3.3.3.3.5.2">𝑡</ci><cn type="integer" id="alg1.l10a.m1.3.3.3.3.5.3.cmml" xref="alg1.l10a.m1.3.3.3.3.5.3">1</cn></apply></apply><ci id="alg1.l10a.m1.3.3.3.5.cmml" xref="alg1.l10a.m1.3.3.3.5">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10a.m1.3c">C=\{\bm{p}_{t}^{p},\bm{p}_{t}^{s},\bm{w}_{t}^{\mathrm{mlp}}\}_{t=1}^{T}</annotation></semantics></math><span id="alg1.l10a.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
</div>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">3 </span>EXPERIMENTS</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Settings</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p"><math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{Dataset\ and\ Client}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi mathsize="90%" id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝐃𝐚𝐭𝐚𝐬𝐞𝐭</mi><mo lspace="0.450em" rspace="0em" id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">​</mo><mi mathsize="90%" id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">𝐚𝐧𝐝</mi><mo lspace="0.450em" rspace="0em" id="S3.SS1.p1.1.m1.1.1.1a" xref="S3.SS1.p1.1.m1.1.1.1.cmml">​</mo><mi mathsize="90%" id="S3.SS1.p1.1.m1.1.1.4" xref="S3.SS1.p1.1.m1.1.1.4.cmml">𝐂𝐥𝐢𝐞𝐧𝐭</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><times id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></times><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐃𝐚𝐭𝐚𝐬𝐞𝐭</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝐚𝐧𝐝</ci><ci id="S3.SS1.p1.1.m1.1.1.4.cmml" xref="S3.SS1.p1.1.m1.1.1.4">𝐂𝐥𝐢𝐞𝐧𝐭</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathbf{Dataset\ and\ Client}</annotation></semantics></math><span id="S3.SS1.p1.1.1" class="ltx_text" style="font-size:90%;">.
In our experiments, we leveraged medical images and closed-type QA pairs from both VQA-RAD </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib22" title="" class="ltx_ref">22</a><span id="S3.SS1.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.1.4" class="ltx_text" style="font-size:90%;"> and Slake </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="S3.SS1.p1.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.1.7" class="ltx_text" style="font-size:90%;"> datasets. These datasets were further partitioned into sub-datasets based on the anatomical focus of the images. We split the datasets into sub-datasets depending on the organ of the image taken and set up client models for each sub-dataset.
Finally, we set four clients for Slake including “Lung”, “Abdomen”, “Brain” and “Others”, which contain 734, 829, 461, and 335 question pairs, respectively.
We set three clients for VQA-RAD including “Chest”, “Abdomen” and “Brain”, which contain 511, 439, and 269 question pairs, respectively.
We adhered to the original dataset division ratios as 70% for training, 15% for validation and 15% for testing in Slake, and 85% for training and 15% for testing in VQA-RAD.</span></p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.4" class="ltx_p"><span id="S3.SS1.p2.4.1" class="ltx_text" style="font-size:90%;">Our architecture employs the Contrastive Language–Image Pre-training (CLIP) </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p2.4.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib24" title="" class="ltx_ref">24</a><span id="S3.SS1.p2.4.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p2.4.4" class="ltx_text" style="font-size:90%;"> model as the backbone for both the image and text encoders. The answer layer is implemented as a 2-layer MLP with a hidden size of 512 and a dropout rate of 0.2. We standardized the length of all prompts to four. The weight </span><math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi mathsize="90%" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\alpha</annotation></semantics></math><span id="S3.SS1.p2.4.5" class="ltx_text" style="font-size:90%;"> of the loss was set to 0.5, and </span><math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi mathsize="90%" id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\beta</annotation></semantics></math><span id="S3.SS1.p2.4.6" class="ltx_text" style="font-size:90%;"> was set to 0.001. During the training, we set the global epoch to 30 and each local iteration to 5. Based on the experimental results, we used a uniform learning rate of 0.01 for all client models, which is multiplied by 0.1 every ten epochs. After adjusting for the block number </span><math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi mathsize="90%" id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">r</annotation></semantics></math><span id="S3.SS1.p2.4.7" class="ltx_text" style="font-size:90%;">, we found that the model had the best performance when </span><math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi mathsize="90%" id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">r</annotation></semantics></math><span id="S3.SS1.p2.4.8" class="ltx_text" style="font-size:90%;"> was set to 12.</span></p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p"><math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{Comparison\ Methods}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi mathsize="90%" id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">𝐂𝐨𝐦𝐩𝐚𝐫𝐢𝐬𝐨𝐧</mi><mo lspace="0.450em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">​</mo><mi mathsize="90%" id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">𝐌𝐞𝐭𝐡𝐨𝐝𝐬</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><times id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></times><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝐂𝐨𝐦𝐩𝐚𝐫𝐢𝐬𝐨𝐧</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝐌𝐞𝐭𝐡𝐨𝐝𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathbf{Comparison\ Methods}</annotation></semantics></math><span id="S3.SS1.p3.1.1" class="ltx_text" style="font-size:90%;">.
We compared the proposed method with several state-of-the-art medical VQA models.
We used the DNNs-based methods, VGG+SAN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="S3.SS1.p3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p3.1.4" class="ltx_text" style="font-size:90%;"> and MEVF </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p3.1.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib25" title="" class="ltx_ref">25</a><span id="S3.SS1.p3.1.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p3.1.7" class="ltx_text" style="font-size:90%;"> for Slake and VQA-RAD, respectively. And we used the transformer-based methods, PMCLIP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p3.1.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib26" title="" class="ltx_ref">26</a><span id="S3.SS1.p3.1.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p3.1.10" class="ltx_text" style="font-size:90%;"> and M2I2 </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p3.1.11.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib27" title="" class="ltx_ref">27</a><span id="S3.SS1.p3.1.12.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p3.1.13" class="ltx_text" style="font-size:90%;"> for both of them. To ensure consistent experimental conditions, we trained the comparison separately using split sub-datasets and did not use pre-training.</span></p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p"><math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{Ablation\ Studies}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi mathsize="90%" id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">𝐀𝐛𝐥𝐚𝐭𝐢𝐨𝐧</mi><mo lspace="0.450em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.cmml">​</mo><mi mathsize="90%" id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">𝐒𝐭𝐮𝐝𝐢𝐞𝐬</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><times id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1"></times><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝐀𝐛𝐥𝐚𝐭𝐢𝐨𝐧</ci><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝐒𝐭𝐮𝐝𝐢𝐞𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mathbf{Ablation\ Studies}</annotation></semantics></math><span id="S3.SS1.p4.1.1" class="ltx_text" style="font-size:90%;">.
We used ablation experiments to demonstrate the effectiveness of the proposed method.
We separately experimented with the proposed method with the following settings. AS1: w/o prompt and pFL, AS2: w/o pFL,
AS3: w/o image prompt, AS4: w/o text prompt.</span></p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Results</h3>

<figure id="S3.T2" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.T2.fig1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:203.8pt;">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S3.T2.fig1.3.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>The quantitative results of each client of Slake.</figcaption>
<table id="S3.T2.fig1.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T2.fig1.4.1.1" class="ltx_tr">
<td id="S3.T2.fig1.4.1.1.1" class="ltx_td ltx_border_t"></td>
<td id="S3.T2.fig1.4.1.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.1.1.2.1" class="ltx_text" style="font-size:90%;">Brain</span></td>
<td id="S3.T2.fig1.4.1.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.1.1.3.1" class="ltx_text" style="font-size:90%;">Abdomen</span></td>
<td id="S3.T2.fig1.4.1.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.1.1.4.1" class="ltx_text" style="font-size:90%;">Others</span></td>
<td id="S3.T2.fig1.4.1.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.1.1.5.1" class="ltx_text" style="font-size:90%;">Lung</span></td>
</tr>
<tr id="S3.T2.fig1.4.2.2" class="ltx_tr">
<td id="S3.T2.fig1.4.2.2.1" class="ltx_td ltx_align_center ltx_border_t">
<span id="S3.T2.fig1.4.2.2.1.1" class="ltx_text" style="font-size:90%;">VGG+SAN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T2.fig1.4.2.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="S3.T2.fig1.4.2.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T2.fig1.4.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.2.2.2.1" class="ltx_text" style="font-size:90%;">76.92</span></td>
<td id="S3.T2.fig1.4.2.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.2.2.3.1" class="ltx_text" style="font-size:90%;">72.34</span></td>
<td id="S3.T2.fig1.4.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.2.2.4.1" class="ltx_text" style="font-size:90%;">74.41</span></td>
<td id="S3.T2.fig1.4.2.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.2.2.5.1" class="ltx_text" style="font-size:90%;">75.89</span></td>
</tr>
<tr id="S3.T2.fig1.4.3.3" class="ltx_tr">
<td id="S3.T2.fig1.4.3.3.1" class="ltx_td ltx_align_center ltx_border_t">
<span id="S3.T2.fig1.4.3.3.1.1" class="ltx_text" style="font-size:90%;">PMCLIP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T2.fig1.4.3.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib26" title="" class="ltx_ref">26</a><span id="S3.T2.fig1.4.3.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T2.fig1.4.3.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.3.3.2.1" class="ltx_text" style="font-size:90%;">79.12</span></td>
<td id="S3.T2.fig1.4.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.3.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">80.85</span></td>
<td id="S3.T2.fig1.4.3.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.3.3.4.1" class="ltx_text" style="font-size:90%;">76.74</span></td>
<td id="S3.T2.fig1.4.3.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.3.3.5.1" class="ltx_text" style="font-size:90%;">82.98</span></td>
</tr>
<tr id="S3.T2.fig1.4.4.4" class="ltx_tr">
<td id="S3.T2.fig1.4.4.4.1" class="ltx_td ltx_align_center ltx_border_t">
<span id="S3.T2.fig1.4.4.4.1.1" class="ltx_text" style="font-size:90%;">M2I2 </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T2.fig1.4.4.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib27" title="" class="ltx_ref">27</a><span id="S3.T2.fig1.4.4.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T2.fig1.4.4.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.4.4.2.1" class="ltx_text" style="font-size:90%;">79.12</span></td>
<td id="S3.T2.fig1.4.4.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.4.4.3.1" class="ltx_text" style="font-size:90%;">68.09</span></td>
<td id="S3.T2.fig1.4.4.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.4.4.4.1" class="ltx_text" style="font-size:90%;">74.42</span></td>
<td id="S3.T2.fig1.4.4.4.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.4.4.5.1" class="ltx_text" style="font-size:90%;">81.56</span></td>
</tr>
<tr id="S3.T2.fig1.4.5.5" class="ltx_tr">
<td id="S3.T2.fig1.4.5.5.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.fig1.4.5.5.1.1" class="ltx_text" style="font-size:90%;">AS1</span></td>
<td id="S3.T2.fig1.4.5.5.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.fig1.4.5.5.2.1" class="ltx_text" style="font-size:90%;">79.12</span></td>
<td id="S3.T2.fig1.4.5.5.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.fig1.4.5.5.3.1" class="ltx_text" style="font-size:90%;">70.92</span></td>
<td id="S3.T2.fig1.4.5.5.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.fig1.4.5.5.4.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">81.40</span></td>
<td id="S3.T2.fig1.4.5.5.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.fig1.4.5.5.5.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">83.69</span></td>
</tr>
<tr id="S3.T2.fig1.4.6.6" class="ltx_tr">
<td id="S3.T2.fig1.4.6.6.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.6.6.1.1" class="ltx_text" style="font-size:90%;">AS2</span></td>
<td id="S3.T2.fig1.4.6.6.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.6.6.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">81.32</span></td>
<td id="S3.T2.fig1.4.6.6.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.6.6.3.1" class="ltx_text" style="font-size:90%;">72.34</span></td>
<td id="S3.T2.fig1.4.6.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.6.6.4.1" class="ltx_text" style="font-size:90%;">79.07</span></td>
<td id="S3.T2.fig1.4.6.6.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.6.6.5.1" class="ltx_text" style="font-size:90%;">82.98</span></td>
</tr>
<tr id="S3.T2.fig1.4.7.7" class="ltx_tr">
<td id="S3.T2.fig1.4.7.7.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.7.7.1.1" class="ltx_text" style="font-size:90%;">AS3</span></td>
<td id="S3.T2.fig1.4.7.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.7.7.2.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">80.22</span></td>
<td id="S3.T2.fig1.4.7.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.7.7.3.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">73.76</span></td>
<td id="S3.T2.fig1.4.7.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.7.7.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">81.84</span></td>
<td id="S3.T2.fig1.4.7.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.7.7.5.1" class="ltx_text" style="font-size:90%;">82.27</span></td>
</tr>
<tr id="S3.T2.fig1.4.8.8" class="ltx_tr">
<td id="S3.T2.fig1.4.8.8.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.8.8.1.1" class="ltx_text" style="font-size:90%;">AS4</span></td>
<td id="S3.T2.fig1.4.8.8.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.8.8.2.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">80.22</span></td>
<td id="S3.T2.fig1.4.8.8.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.8.8.3.1" class="ltx_text" style="font-size:90%;">70.92</span></td>
<td id="S3.T2.fig1.4.8.8.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.8.8.4.1" class="ltx_text" style="font-size:90%;">76.74</span></td>
<td id="S3.T2.fig1.4.8.8.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.4.8.8.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">84.40</span></td>
</tr>
<tr id="S3.T2.fig1.4.9.9" class="ltx_tr">
<td id="S3.T2.fig1.4.9.9.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig1.4.9.9.1.1" class="ltx_text" style="font-size:90%;">PM</span></td>
<td id="S3.T2.fig1.4.9.9.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig1.4.9.9.2.1" class="ltx_text" style="font-size:90%;">76.92</span></td>
<td id="S3.T2.fig1.4.9.9.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig1.4.9.9.3.1" class="ltx_text" style="font-size:90%;">72.34</span></td>
<td id="S3.T2.fig1.4.9.9.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig1.4.9.9.4.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">81.40</span></td>
<td id="S3.T2.fig1.4.9.9.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig1.4.9.9.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">84.40</span></td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.T2.fig2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:216.8pt;">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S3.T2.fig2.3.1.1" class="ltx_text ltx_font_bold">Table 2</span>: </span>The quantitative results of each client of VQA-RAD.</figcaption>
<table id="S3.T2.fig2.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T2.fig2.4.1.1" class="ltx_tr">
<td id="S3.T2.fig2.4.1.1.1" class="ltx_td ltx_border_t"></td>
<td id="S3.T2.fig2.4.1.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.1.1.2.1" class="ltx_text" style="font-size:90%;">Brain</span></td>
<td id="S3.T2.fig2.4.1.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.1.1.3.1" class="ltx_text" style="font-size:90%;">Abdomen</span></td>
<td id="S3.T2.fig2.4.1.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.1.1.4.1" class="ltx_text" style="font-size:90%;">Chest</span></td>
</tr>
<tr id="S3.T2.fig2.4.2.2" class="ltx_tr">
<td id="S3.T2.fig2.4.2.2.1" class="ltx_td ltx_align_center ltx_border_t">
<span id="S3.T2.fig2.4.2.2.1.1" class="ltx_text" style="font-size:90%;">MEVF </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T2.fig2.4.2.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib25" title="" class="ltx_ref">25</a><span id="S3.T2.fig2.4.2.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T2.fig2.4.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.2.2.2.1" class="ltx_text" style="font-size:90%;">68.63</span></td>
<td id="S3.T2.fig2.4.2.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.2.2.3.1" class="ltx_text" style="font-size:90%;">66.67</span></td>
<td id="S3.T2.fig2.4.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.2.2.4.1" class="ltx_text" style="font-size:90%;">60.61</span></td>
</tr>
<tr id="S3.T2.fig2.4.3.3" class="ltx_tr">
<td id="S3.T2.fig2.4.3.3.1" class="ltx_td ltx_align_center ltx_border_t">
<span id="S3.T2.fig2.4.3.3.1.1" class="ltx_text" style="font-size:90%;">PMCLIP </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T2.fig2.4.3.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib26" title="" class="ltx_ref">26</a><span id="S3.T2.fig2.4.3.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T2.fig2.4.3.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.3.3.2.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">73.53</span></td>
<td id="S3.T2.fig2.4.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.3.3.3.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">70.00</span></td>
<td id="S3.T2.fig2.4.3.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.3.3.4.1" class="ltx_text" style="font-size:90%;">62.12</span></td>
</tr>
<tr id="S3.T2.fig2.4.4.4" class="ltx_tr">
<td id="S3.T2.fig2.4.4.4.1" class="ltx_td ltx_align_center ltx_border_t">
<span id="S3.T2.fig2.4.4.4.1.1" class="ltx_text" style="font-size:90%;">M2I2 </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.T2.fig2.4.4.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib27" title="" class="ltx_ref">27</a><span id="S3.T2.fig2.4.4.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</td>
<td id="S3.T2.fig2.4.4.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.4.4.2.1" class="ltx_text" style="font-size:90%;">64.38</span></td>
<td id="S3.T2.fig2.4.4.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.4.4.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">71.11</span></td>
<td id="S3.T2.fig2.4.4.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.4.4.4.1" class="ltx_text ltx_framed ltx_framed_underline" style="font-size:90%;">63.64</span></td>
</tr>
<tr id="S3.T2.fig2.4.5.5" class="ltx_tr">
<td id="S3.T2.fig2.4.5.5.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.fig2.4.5.5.1.1" class="ltx_text" style="font-size:90%;">AS1</span></td>
<td id="S3.T2.fig2.4.5.5.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.fig2.4.5.5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">74.24</span></td>
<td id="S3.T2.fig2.4.5.5.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.fig2.4.5.5.3.1" class="ltx_text" style="font-size:90%;">67.78</span></td>
<td id="S3.T2.fig2.4.5.5.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S3.T2.fig2.4.5.5.4.1" class="ltx_text" style="font-size:90%;">61.76</span></td>
</tr>
<tr id="S3.T2.fig2.4.6.6" class="ltx_tr">
<td id="S3.T2.fig2.4.6.6.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.6.6.1.1" class="ltx_text" style="font-size:90%;">AS2</span></td>
<td id="S3.T2.fig2.4.6.6.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.6.6.2.1" class="ltx_text" style="font-size:90%;">68.18</span></td>
<td id="S3.T2.fig2.4.6.6.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.6.6.3.1" class="ltx_text" style="font-size:90%;">63.33</span></td>
<td id="S3.T2.fig2.4.6.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.6.6.4.1" class="ltx_text" style="font-size:90%;">61.76</span></td>
</tr>
<tr id="S3.T2.fig2.4.7.7" class="ltx_tr">
<td id="S3.T2.fig2.4.7.7.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.7.7.1.1" class="ltx_text" style="font-size:90%;">AS3</span></td>
<td id="S3.T2.fig2.4.7.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.7.7.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">74.24</span></td>
<td id="S3.T2.fig2.4.7.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.7.7.3.1" class="ltx_text" style="font-size:90%;">67.78</span></td>
<td id="S3.T2.fig2.4.7.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.7.7.4.1" class="ltx_text" style="font-size:90%;">61.76</span></td>
</tr>
<tr id="S3.T2.fig2.4.8.8" class="ltx_tr">
<td id="S3.T2.fig2.4.8.8.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.8.8.1.1" class="ltx_text" style="font-size:90%;">AS4</span></td>
<td id="S3.T2.fig2.4.8.8.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.8.8.2.1" class="ltx_text" style="font-size:90%;">69.70</span></td>
<td id="S3.T2.fig2.4.8.8.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.8.8.3.1" class="ltx_text" style="font-size:90%;">67.78</span></td>
<td id="S3.T2.fig2.4.8.8.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig2.4.8.8.4.1" class="ltx_text" style="font-size:90%;">60.78</span></td>
</tr>
<tr id="S3.T2.fig2.4.9.9" class="ltx_tr">
<td id="S3.T2.fig2.4.9.9.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig2.4.9.9.1.1" class="ltx_text" style="font-size:90%;">PM</span></td>
<td id="S3.T2.fig2.4.9.9.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig2.4.9.9.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">74.24</span></td>
<td id="S3.T2.fig2.4.9.9.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig2.4.9.9.3.1" class="ltx_text" style="font-size:90%;">68.89</span></td>
<td id="S3.T2.fig2.4.9.9.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig2.4.9.9.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">64.71</span></td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
<figure id="S3.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2402.09677/assets/x4.png" id="S3.F4.sf1.g1" class="ltx_graphics ltx_img_square" width="207" height="192" alt="Refer to caption">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.sf1.4.1.1" class="ltx_text" style="font-size:89%;">(a)</span> </span><span id="S3.F4.sf1.5.2" class="ltx_text" style="font-size:89%;">Slake</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2402.09677/assets/x5.png" id="S3.F4.sf2.g1" class="ltx_graphics ltx_img_square" width="207" height="194" alt="Refer to caption">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.sf2.4.1.1" class="ltx_text" style="font-size:89%;">(b)</span> </span><span id="S3.F4.sf2.5.2" class="ltx_text" style="font-size:89%;">VQA-RAD</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.4.1.1" class="ltx_text ltx_font_bold">Fig. 4</span>: </span>The tSNE visualization of the prompt embedding results on the Slake and VQA-RAD datasets. The “Local, Shared” represents the local and shared prompts in client 3 that is trained in the sub-dataset of the Abdomen. The “Ograns” represents the local prompt of each client.</figcaption>
</figure>
<figure id="S3.F5" class="ltx_figure"><img src="/html/2402.09677/assets/x6.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="242" height="182" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure"><span id="S3.F5.4.1.1" class="ltx_text ltx_font_bold">Fig. 5</span>: </span>Samples of the generated answers on Slake. The results show the four clients we set up, with the corresponding sub-datasets in parentheses.</figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p"><span id="S3.SS2.p1.1.1" class="ltx_text" style="font-size:90%;">We conducted experiments on the accuracy of different client models in answering questions, which are shown in Tables </span><a href="#S3.T2" title="Table 2 ‣ 3.2 Results ‣ 3 EXPERIMENTS ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S3.SS2.p1.1.2" class="ltx_text" style="font-size:90%;"> and </span><a href="#S3.T2" title="Table 2 ‣ 3.2 Results ‣ 3 EXPERIMENTS ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S3.SS2.p1.1.3" class="ltx_text" style="font-size:90%;">.
The high accuracy of PM, as well as AS3 and AS4, which incorporated pFL, attest to the efficacy of the pFL method.
Compared to AS1, AS2 does not exhibit significant improvements, demonstrating that incorporating prompts offers limited enhancements to the model’s performance.
Moreover, for Slake, the text prompt had a more positive impact than the image prompt, and for the VQA-RAD, both the image and text prompts improved the accuracy of the model.</span></p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p"><span id="S3.SS2.p2.1.1" class="ltx_text" style="font-size:90%;">We also visualized the prompts with tSNE </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS2.p2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib28" title="" class="ltx_ref">28</a><span id="S3.SS2.p2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS2.p2.1.4" class="ltx_text" style="font-size:90%;">. From the visualization results in Fig. </span><a href="#S3.F4.sf1" title="In Figure 4 ‣ 3.2 Results ‣ 3 EXPERIMENTS ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">4(a)</span></a><span id="S3.SS2.p2.1.5" class="ltx_text" style="font-size:90%;">, consistent with the quantitative results, we see that the text prompt of the Slake is more accurately mapped to different regions, while the image prompt is relatively cluttered. Furthermore, as shown in both Figs. </span><a href="#S3.F4.sf1" title="In Figure 4 ‣ 3.2 Results ‣ 3 EXPERIMENTS ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">4(a)</span></a><span id="S3.SS2.p2.1.6" class="ltx_text" style="font-size:90%;"> and </span><a href="#S3.F4.sf2" title="In Figure 4 ‣ 3.2 Results ‣ 3 EXPERIMENTS ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">4(b)</span></a><span id="S3.SS2.p2.1.7" class="ltx_text" style="font-size:90%;">, the 12 regions in the figures correspond to the 12 pRA blocks in the proposed method, which can prove that each block contains different potential information. The clear separation into several parts within each region in the “Organ” can prove that the prompts trained under different data distributions contain entirely different information. The “Local, Shared” results demonstrate the effectiveness of the proposed distance loss, where the corresponding local and shared prompts in each block are mapped to a similar space.
We also qualitatively evaluated the model answering the questions as shown in Fig. </span><a href="#S3.F5" title="Figure 5 ‣ 3.2 Results ‣ 3 EXPERIMENTS ‣ Prompt-based Personalized Federated Learning for Medical Visual Question Answering" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">5</span></a><span id="S3.SS2.p2.1.8" class="ltx_text" style="font-size:90%;">. It can be seen that our model can correctly answer the questions corresponding to the medical images.
In the experiments, the parameters to be updated of the proposed method were only 0.05% of that of previous pFL methods.</span></p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">4 </span>CONCLUSION</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text" style="font-size:90%;">The proposed prompt-based personalized federated learning method for medical VQA can train personalized models for sub-datasets of medical data with different distributions, which overlooked problems of medical data heterogeneity and privacy protection. By using the prompt-based self-attention block, the client model circumvented the computational intricacies of traditional model weight sharing. Both qualitative and quantitative results show that our method allows the model to gain in communication. Moreover, the proposed method is expected to be used in any transformer-based VQA baseline models.</span></p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Kun-Hsing Yu, Andrew L Beam, and Isaac S Kohane,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">“Artificial intelligence in healthcare,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Nature biomedical engineering</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">, vol. 2, no. 10, pp. 719–731, 2018.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Eka Miranda, Mediana Aryuni, and E. Irwansyah,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">“A survey of medical image classification techniques,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of International Conference on Information Management and Technology</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, 2016, pp. 56–61.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Saleha Masood, Muhammad Sharif, Afifa Masood, Mussarat Yasmin, and Mudassar Raza,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">“A survey on medical image segmentation,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Current Medical Imaging</span><span id="bib.bib3.4.2" class="ltx_text" style="font-size:90%;">, pp. 3–14, 2015.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
OpenAI,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">“GPT-3.5 (ChatGPT) – A large language model by OpenAI,” </span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self" style="font-size:90%;">https://openai.com</span><span id="bib.bib4.3.2" class="ltx_text" style="font-size:90%;">, 2023,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.4.1" class="ltx_text" style="font-size:90%;">Accessed: Sep. 6, 2023.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Zhihong Lin, Donghao Zhang, Qingyi Tao, Danli Shi, Gholamreza Haffari, Qi Wu, Mingguang He, and Zongyuan Ge,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">“Medical visual question answering: A survey,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Artificial Intelligence in Medicine</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, vol. 143, pp. 102611, 2023.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Haifan Gong, Guanqi Chen, Sishuo Liu, Yizhou Yu, and Guanbin Li,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">“Cross-modal self-attention with multi-task pre-training for medical visual question answering,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the International Conference on Multimedia Retrieval</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 456–460.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Nicholas J Schork,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">“Artificial intelligence and personalized medicine,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Precision medicine in Cancer therapy</span><span id="bib.bib7.4.2" class="ltx_text" style="font-size:90%;">, pp. 265–283, 2019.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Qiong Wu, Kaiwen He, and Xu Chen,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">“Personalized federated learning for intelligent iot applications: A cloud-edge based framework,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Open Journal of the Computer Society</span><span id="bib.bib8.4.2" class="ltx_text" style="font-size:90%;">, vol. 1, pp. 35–44, 2020.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Jie Xu, Benjamin S Glicksberg, Chang Su, Peter Walker, Jiang Bian, and Fei Wang,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">“Federated learning for healthcare informatics,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Journal of Healthcare Informatics Research</span><span id="bib.bib9.4.2" class="ltx_text" style="font-size:90%;">, vol. 5, pp. 1–19, 2021.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Alysa Ziying Tan, Han Yu, Lizhen Cui, and Qiang Yang,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">“Towards personalized federated learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Neural Networks and Learning Systems</span><span id="bib.bib10.4.2" class="ltx_text" style="font-size:90%;">, pp. 1–17, 2022.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Junyi Zhu, Xingchen Ma, and Matthew B Blaschko,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">“Confidence-aware personalized federated learning via variational expectation maximization,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, 2023, pp. 24542–24551.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Viraj Kulkarni, Milind Kulkarni, and Aniruddha Pant,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">“Survey of personalization techniques for federated learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of World Conference on Smart Trends in Systems, Security and Sustainability</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, 2020, pp. 794–797.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Li Deng,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">“The mnist database of handwritten digit images for machine learning research,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Signal Processing Magazine</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">, vol. 29, no. 6, pp. 141–142, 2012.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Alex Krizhevsky, Geoffrey Hinton, et al.,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">“Learning multiple layers of features from tiny images,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">University of Toronto</span><span id="bib.bib14.4.2" class="ltx_text" style="font-size:90%;">, 2009.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, </span><span id="bib.bib15.2.2" class="ltx_text ltx_font_caligraphic" style="font-size:90%;">L</span><span id="bib.bib15.3.3" class="ltx_text" style="font-size:90%;">ukasz Kaiser, and Illia Polosukhin,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.4.1" class="ltx_text" style="font-size:90%;">“Attention is all you need,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.5.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib15.6.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib15.7.3" class="ltx_text" style="font-size:90%;">, 2017, vol. 30.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Hongxia Li, Zhongyi Cai, Jingya Wang, Jiangnan Tang, Weiping Ding, Chin-Teng Lin, and Ye Shi,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">“Fedtp: Federated learning by transformer personalization,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Neural Networks and Learning Systems</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, pp. 1–15, 2023.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Zifeng Wang, Zizhao Zhang, Chen-Yu Lee, Han Zhang, Ruoxi Sun, Xiaoqi Ren, Guolong Su, Vincent Perot, Jennifer Dy, and Tomas Pfister,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">“Learning to prompt for continual learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, 2022, pp. 139–149.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Zifeng Wang, Zizhao Zhang, Sayna Ebrahimi, Ruoxi Sun, Han Zhang, Chen-Yu Lee, Xiaoqi Ren, Guolong Su, Vincent Perot, Jennifer Dy, et al.,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">“Dualprompt: Complementary prompting for rehearsal-free continual learning,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, 2022, pp. 631–648.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Pengfei Liu, Weizhe Yuan, Jinlan Fu, Zhengbao Jiang, Hiroaki Hayashi, and Graham Neubig,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">“Pre-train, prompt, and predict: A systematic survey of prompting methods in natural language processing,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ACM Computing Surveys</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, vol. 55, no. 9, pp. 1–35, 2023.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Diederik P Kingma and Max Welling,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">“Auto-encoding variational bayes,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1312.6114</span><span id="bib.bib20.4.2" class="ltx_text" style="font-size:90%;">, 2013.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Xiang Lisa Li and Percy Liang,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">“Prefix-tuning: Optimizing continuous prompts for generation,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2101.00190</span><span id="bib.bib21.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Jason J Lau, Soumya Gayen, Asma Ben Abacha, and Dina Demner-Fushman,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">“A dataset of clinically generated visual questions and answers about radiology images,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Scientific Data</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, vol. 5, pp. 1–10, 2018.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Bo Liu, Li-Ming Zhan, Li Xu, Lin Ma, Yan Yang, and Xiao-Ming Wu,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">“Slake: A semantically-labeled knowledge-enhanced dataset for medical visual question answering,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE International Symposium on Biomedical Imaging</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 1650–1654.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al.,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">“Learning transferable visual models from natural language supervision,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the International Conference on Machine Learning</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, 2021, pp. 8748–8763.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Binh D. Nguyen, Thanh-Toan Do, Binh X. Nguyen, Tuong Do, Erman Tjiputra, and Quang D. Tran,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">“Overcoming data limitation in medical visual question answering,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the Medical Image Computing and Computer Assisted Intervention</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, 2019, pp. 522–530.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Sedigheh Eslami, Christoph Meinel, and Gerard De Melo,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">“Pubmedclip: How much does clip benefit visual question answering in the medical domain?,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Findings of the Association for Computational Linguistics: EACL</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, 2023, pp. 1151–1163.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Pengfei Li, Gang Liu, Lin Tan, Jinying Liao, and Shenjun Zhong,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">“Self-supervised vision-language pretraining for medial visual question answering,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">in </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE 20th International Symposium on Biomedical Imaging</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2023, pp. 1–5.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Laurens Van der Maaten and Geoffrey Hinton,
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">“Visualizing data using t-sne,”
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Journal of machine learning research</span><span id="bib.bib28.4.2" class="ltx_text" style="font-size:90%;">, vol. 9, 2008.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2402.09676" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2402.09677" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2402.09677">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2402.09677" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2402.09678" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar  5 17:03:50 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
