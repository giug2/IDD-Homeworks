<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Embedding Compression in Recommender Systems: A Survey</title>
<!--Generated on Mon Aug  5 08:20:08 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="recommender systems; embedding tables; model compression; survey" lang="en" name="keywords"/>
<base href="/html/2408.02304v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S1" title="In Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S1.SS1" title="In 1. Introduction ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1.1 </span>Deep Learning Recommendation Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S1.SS2" title="In 1. Introduction ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1.2 </span>Embedding Compression in Recommender Systems</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S2" title="In Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Low-Precision</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S2.SS1" title="In 2. Low-Precision ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Binarization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S2.SS2" title="In 2. Low-Precision ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Quantization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S2.SS3" title="In 2. Low-Precision ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Discussion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S3" title="In Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Mixed-Dimension</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S3.SS1" title="In 3. Mixed-Dimension ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Rule-based Approaches</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S3.SS2" title="In 3. Mixed-Dimension ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>NAS-based Approaches</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S3.SS3" title="In 3. Mixed-Dimension ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Pruning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S3.SS4" title="In 3. Mixed-Dimension ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Discussion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S4" title="In Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Weight-Sharing</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S4.SS1" title="In 4. Weight-Sharing ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Hashing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S4.SS2" title="In 4. Weight-Sharing ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Vector Quantization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S4.SS3" title="In 4. Weight-Sharing ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Decomposition</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S4.SS4" title="In 4. Weight-Sharing ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Discussion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S5" title="In Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Summary</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S5.SS1" title="In 5. Summary ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>General Suggestions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S5.SS2" title="In 5. Summary ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Future Prospects</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Embedding Compression in Recommender Systems: A Survey</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shiwei Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:lishiwei@hust.edu.cn">lishiwei@hust.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-7067-0275" title="ORCID identifier">0000-0002-7067-0275</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Huazhong University of Science and Technology</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Wuhan</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span><span class="ltx_text ltx_affiliation_postcode" id="id4.4.id4">430074</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Huifeng Guo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:huifeng.guo@huawei.com">huifeng.guo@huawei.com</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-7393-8994" title="ORCID identifier">0000-0002-7393-8994</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_city" id="id6.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id7.3.id3">China</span><span class="ltx_text ltx_affiliation_postcode" id="id8.4.id4">518129</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xing Tang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:xing.tang@hotmail.com">xing.tang@hotmail.com</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0003-4360-0754" title="ORCID identifier">0000-0003-4360-0754</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">Tencent</span><span class="ltx_text ltx_affiliation_city" id="id10.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id11.3.id3">China</span><span class="ltx_text ltx_affiliation_postcode" id="id12.4.id4">518054</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ruiming Tang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:tangruiming@huawei.com">tangruiming@huawei.com</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-9224-2431" title="ORCID identifier">0000-0002-9224-2431</a></span>
</span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lu Hou
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:houlu3@huawei.com">houlu3@huawei.com</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-4694-1821" title="ORCID identifier">0000-0002-4694-1821</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">China</span><span class="ltx_text ltx_affiliation_postcode" id="id16.4.id4">518129</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ruixuan Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:rxli@hust.edu.cn">rxli@hust.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-7791-5511" title="ORCID identifier">0000-0002-7791-5511</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id17.1.id1">Huazhong University of Science and Technology</span><span class="ltx_text ltx_affiliation_city" id="id18.2.id2">Wuhan</span><span class="ltx_text ltx_affiliation_country" id="id19.3.id3">China</span><span class="ltx_text ltx_affiliation_postcode" id="id20.4.id4">430074</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rui Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:rayteam@yeah.net">rayteam@yeah.net</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0000-0002-8132-6250" title="ORCID identifier">0000-0002-8132-6250</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id21.1.id1">ruizhang.info</span><span class="ltx_text ltx_affiliation_country" id="id22.2.id2">China</span>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id23.id1">To alleviate the problem of information explosion, recommender systems are widely deployed to provide personalized information filtering services. Usually, embedding tables are employed in recommender systems to transform high-dimensional sparse one-hot vectors into dense real-valued embeddings. However, the embedding tables are huge and account for most of the parameters in industrial-scale recommender systems. In order to reduce memory costs and improve efficiency, various approaches are proposed to compress the embedding tables. In this survey, we provide a comprehensive review of embedding compression approaches in recommender systems. We first introduce deep learning recommendation models and the basic concept of embedding compression in recommender systems. Subsequently, we systematically organize existing approaches into three categories, namely low-precision, mixed-dimension, and weight-sharing, respectively. Lastly, we summarize the survey with some general suggestions and provide future prospects for this field.</p>
</div>
<div class="ltx_keywords">recommender systems; embedding tables; model compression; survey
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3637841</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journal" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journal: </span>CSUR</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalvolume" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalvolume: </span>56</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalnumber" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalnumber: </span>5</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_article" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">article: </span>130</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_publicationmonth" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">publicationmonth: </span>1</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id9"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems  Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">To alleviate the problem of information explosion, recommender systems <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib56" title="">2023</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib62" title="">2023</a>)</cite> are extensively deployed to provide personalized information filtering services, including online shopping <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib81" title="">2018</a>)</cite>, advertising systems <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib47" title="">2013</a>)</cite> and so on. Meanwhile, deep learning techniques have shown impressive capabilities in capturing user preferences for candidate items.
Thereupon, both the industry and research communities have proposed a variety of deep learning recommendation models (DLRMs) to enhance the performance of recommender systems, such as Wide &amp; Deep <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib7" title="">2016</a>)</cite> in Google Play, DIN <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib81" title="">2018</a>)</cite> in Alibaba and DeepFM <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib19" title="">2017</a>)</cite> in Huawei.</p>
</div>
<section class="ltx_subsection" id="S1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1. </span>Deep Learning Recommendation Models</h3>
<div class="ltx_para" id="S1.SS1.p1">
<p class="ltx_p" id="S1.SS1.p1.1">Recommender systems are utilized for a diverse range of tasks, such as candidate item matching <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib31" title="">2021</a>)</cite>, click-through rate (CTR) prediction <cite class="ltx_cite ltx_citemacro_citep">(Su et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib52" title="">2021</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib53" title="">2022</a>)</cite>, and conversion rate (CVR) prediction <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib45" title="">2018</a>)</cite>.
For each of these tasks, the employed DLRMs have undergone meticulous design processes to ensure optimal performance.
However, without loss of generality, most DLRMs follow the <span class="ltx_text ltx_font_italic" id="S1.SS1.p1.1.1">embedding table</span> and <span class="ltx_text ltx_font_italic" id="S1.SS1.p1.1.2">neural network</span> paradigm <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib58" title="">2017</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib59" title="">2021</a>; Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib19" title="">2017</a>; Mao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib46" title="">2021</a>)</cite>, despite the specific design of the <span class="ltx_text ltx_font_italic" id="S1.SS1.p1.1.3">neural network</span> component may vary across different model architectures.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="145" id="S1.F1.g1" src="extracted/5774277/figs/embnn.png" width="233"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>The <span class="ltx_text ltx_font_italic" id="S1.F1.5.1">embedding table</span> and <span class="ltx_text ltx_font_italic" id="S1.F1.6.2">neural network</span> paradigm of deep learning recommendation models (DLRMs). Note that the <span class="ltx_text ltx_font_italic" id="S1.F1.7.3">neural network</span> component may vary in different model architectures, here we only present the <span class="ltx_text ltx_font_italic" id="S1.F1.8.4">neural network</span> with the classic dual tower architecture as an example.</figcaption>
</figure>
<div class="ltx_para" id="S1.SS1.p2">
<p class="ltx_p" id="S1.SS1.p2.3">As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S1.F1" title="Figure 1 ‣ 1.1. Deep Learning Recommendation Models ‣ 1. Introduction ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">1</span></a>, the embedding table is responsible for converting input rows into dense embedding vectors.
It is worth noting that the input rows of DLRMs typically consist of categorical features, which are encoded as high-dimensional one-hot vectors.
Each category feature will be referred to as feature for short, and all features under the same category form a feature field.
Generally, each feature is associated with a unique embedding stored in the embedding table <math alttext="\mathbf{E}\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="S1.SS1.p2.1.m1.1"><semantics id="S1.SS1.p2.1.m1.1a"><mrow id="S1.SS1.p2.1.m1.1.1" xref="S1.SS1.p2.1.m1.1.1.cmml"><mi id="S1.SS1.p2.1.m1.1.1.2" xref="S1.SS1.p2.1.m1.1.1.2.cmml">𝐄</mi><mo id="S1.SS1.p2.1.m1.1.1.1" xref="S1.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S1.SS1.p2.1.m1.1.1.3" xref="S1.SS1.p2.1.m1.1.1.3.cmml"><mi id="S1.SS1.p2.1.m1.1.1.3.2" xref="S1.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S1.SS1.p2.1.m1.1.1.3.3" xref="S1.SS1.p2.1.m1.1.1.3.3.cmml"><mi id="S1.SS1.p2.1.m1.1.1.3.3.2" xref="S1.SS1.p2.1.m1.1.1.3.3.2.cmml">n</mi><mo id="S1.SS1.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S1.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S1.SS1.p2.1.m1.1.1.3.3.3" xref="S1.SS1.p2.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.p2.1.m1.1b"><apply id="S1.SS1.p2.1.m1.1.1.cmml" xref="S1.SS1.p2.1.m1.1.1"><in id="S1.SS1.p2.1.m1.1.1.1.cmml" xref="S1.SS1.p2.1.m1.1.1.1"></in><ci id="S1.SS1.p2.1.m1.1.1.2.cmml" xref="S1.SS1.p2.1.m1.1.1.2">𝐄</ci><apply id="S1.SS1.p2.1.m1.1.1.3.cmml" xref="S1.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.p2.1.m1.1.1.3.1.cmml" xref="S1.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S1.SS1.p2.1.m1.1.1.3.2.cmml" xref="S1.SS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S1.SS1.p2.1.m1.1.1.3.3.cmml" xref="S1.SS1.p2.1.m1.1.1.3.3"><times id="S1.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S1.SS1.p2.1.m1.1.1.3.3.1"></times><ci id="S1.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="S1.SS1.p2.1.m1.1.1.3.3.2">𝑛</ci><ci id="S1.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="S1.SS1.p2.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p2.1.m1.1c">\mathbf{E}\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.p2.1.m1.1d">bold_E ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="n" class="ltx_Math" display="inline" id="S1.SS1.p2.2.m2.1"><semantics id="S1.SS1.p2.2.m2.1a"><mi id="S1.SS1.p2.2.m2.1.1" xref="S1.SS1.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.p2.2.m2.1b"><ci id="S1.SS1.p2.2.m2.1.1.cmml" xref="S1.SS1.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p2.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.p2.2.m2.1d">italic_n</annotation></semantics></math> denotes the total number of features and <math alttext="d" class="ltx_Math" display="inline" id="S1.SS1.p2.3.m3.1"><semantics id="S1.SS1.p2.3.m3.1a"><mi id="S1.SS1.p2.3.m3.1.1" xref="S1.SS1.p2.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.p2.3.m3.1b"><ci id="S1.SS1.p2.3.m3.1.1.cmml" xref="S1.SS1.p2.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p2.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S1.SS1.p2.3.m3.1d">italic_d</annotation></semantics></math> denotes the embedding dimension.</p>
</div>
<div class="ltx_para" id="S1.SS1.p3">
<p class="ltx_p" id="S1.SS1.p3.1">On the other hand, the neural network is primarily engaged in interacting, processing, and analyzing feature embeddings, along with making predictions.
Recent studies <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib19" title="">2017</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib41" title="">2015</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib37" title="">2019b</a>; Xiao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib66" title="">2017</a>; Khawar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib30" title="">2020</a>; Yao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib71" title="">2020</a>)</cite> have consistently focused on optimizing the feature extraction capabilities of the neural networks.
For example, <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib19" title="">2017</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib59" title="">2021</a>)</cite> utilize product operators to model the feature interactions between different feature fields. <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib41" title="">2015</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib37" title="">2019b</a>)</cite> employ convolutions on embeddings to capture feature interactions of arbitrary order. <cite class="ltx_cite ltx_citemacro_citep">(Xiao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib66" title="">2017</a>)</cite> introduces an additional attention network to assign varying importance to different feature interactions. Additionally, <cite class="ltx_cite ltx_citemacro_citep">(Khawar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib30" title="">2020</a>; Yao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib71" title="">2020</a>)</cite> automatically search for suitable interaction functions using AutoML techniques <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib22" title="">2021</a>)</cite>. In this manuscript, we do not delve into the detailed design of the neural network component. Instead, we recommend referring to the works <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib76" title="">2021</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib75" title="">2019</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib62" title="">2023</a>)</cite> for a comprehensive understanding of the neural networks used in DLRMs.</p>
</div>
<div class="ltx_para" id="S1.SS1.p4">
<p class="ltx_p" id="S1.SS1.p4.1">Despite incorporating various intricate designs, the neural network usually entails relatively shallow layers and a limited number of model parameters.
In contrast, the embedding table occupies the vast majority of model parameters.
Especially in industrial-scale recommender systems, where there are billions or even trillions of categorical features, the embedding table may take hundreds of GB or even TB to hold <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib18" title="">2021</a>)</cite>.
For example, the size of embedding tables in Baidu’s advertising systems reaches 10 TB <cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib67" title="">2021</a>)</cite>.
As the scale of recommender systems perpetually expands, the continuous growth in the number of features will bring greater storage overhead.</p>
</div>
</section>
<section class="ltx_subsection" id="S1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.2. </span>Embedding Compression in Recommender Systems</h3>
<div class="ltx_para" id="S1.SS2.p1">
<p class="ltx_p" id="S1.SS2.p1.1">In addition to increasing storage overhead, larger embedding tables will also result in higher latency during table lookup <span class="ltx_note ltx_role_footnote" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The process of retrieving an embedding from the embedding table based on the input feature or index.</span></span></span>, which will reduce the efficiency of model training and inference. Therefore, to deploy the DLRMs with large embedding tables in real production environment efficiently and economically, it is necessary to compress their embedding tables.</p>
</div>
<div class="ltx_para" id="S1.SS2.p2">
<p class="ltx_p" id="S1.SS2.p2.1">However, embedding compression in DLRMs differs significantly from model compression in other fields, such as Computer Vision (CV) <cite class="ltx_cite ltx_citemacro_citep">(Choudhary et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib9" title="">2020</a>)</cite> and Natural Language Processing (NLP) <cite class="ltx_cite ltx_citemacro_citep">(Gupta and Agrawal, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib20" title="">2022</a>)</cite>.
These differences primarily manifest in three aspects: model architectures, properties of input data, and model size.
Firstly, vision models and language models are usually very deep neural networks stacked by fully-connected layers, convolutional layers, or transformers.
Consequently, compression methods designed for these models focus on compressing the aforementioned modules rather than embedding tables.
In contrast, DLRMs are typically shallow models, with the majority of parameters concentrated in the embedding tables.
Secondly, the input data of vision models and language models are usually images and texts, inherently containing abundant visual and semantic information that can be leveraged for model compression.
For example, <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib5" title="">2016</a>)</cite> use the semantic information as a prior knowledge to compress the word embeddings, while <cite class="ltx_cite ltx_citemacro_citep">(Han et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib21" title="">2020</a>)</cite> exploit the similarity between feature maps derived from image inputs to compress convolution kernels.
However, in recommender systems, there is generally limited visual or semantic information available.
Fortunately, DLRMs possess unique properties in the input data that can facilitate embedding compression.
Specifically, categorical features are organized in feature fields and often follow a highly skewed long-tail distribution, with varying numbers of features in different fields.
We can compress embedding tables based on feature frequency and field size.
Thirdly, embedding tables of DLRMs are usually hundreds or even thousands of times larger than vision models or language models <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib54" title="">2020</a>)</cite>, which presents a more challenging and necessary task for compression.</p>
</div>
<figure class="ltx_figure" id="S1.F2"><svg class="ltx_picture ltx_centering" height="365.59" id="S1.F2.1.pic1" overflow="visible" version="1.1" width="484.42"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,365.59) matrix(1 0 0 -1 0 0) translate(39.76,0) translate(0,326.43)"><path d="M 0 -137.8 M 118.11 -39.37 M 118.11 -137.8 M 118.11 -236.22" style="fill:none"></path><g stroke="#000000" stroke-width="0.8pt"><path d="M 33.67 -127.03 L -33.67 -127.03 C -36.73 -127.03 -39.2 -129.51 -39.2 -132.57 L -39.2 -143.02 C -39.2 -146.08 -36.73 -148.56 -33.67 -148.56 L 33.67 -148.56 C 36.73 -148.56 39.2 -146.08 39.2 -143.02 L 39.2 -132.57 C 39.2 -129.51 36.73 -127.03 33.67 -127.03 Z M -39.2 -148.56" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 -34.59 -141.33)"><foreignobject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="69.19">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.2.2.2.1.1" style="width:50.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.2.2.2.1.1.1"></span>
<span class="ltx_p" id="S1.F2.1.pic1.2.2.2.1.1.2"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.2.2.2.1.1.2.1">Embedding</span></span>
<span class="ltx_p" id="S1.F2.1.pic1.2.2.2.1.1.3"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.2.2.2.1.1.3.1">Compression</span></span>
</span></foreignobject></g><g stroke="#000000" stroke-width="0.8pt"><path d="M 151.78 -28.69 L 84.44 -28.69 C 81.38 -28.69 78.91 -31.16 78.91 -34.22 L 78.91 -44.52 C 78.91 -47.58 81.38 -50.05 84.44 -50.05 L 151.78 -50.05 C 154.84 -50.05 157.31 -47.58 157.31 -44.52 L 157.31 -34.22 C 157.31 -31.16 154.84 -28.69 151.78 -28.69 Z M 78.91 -50.05" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 83.52 -42.98)"><foreignobject height="12.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="69.19">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.3.3.3.1.1" style="width:50.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.3.3.3.1.1.1"></span>
<span class="ltx_p" id="S1.F2.1.pic1.3.3.3.1.1.2"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.3.3.3.1.1.2.1">Low-precision</span></span>
</span></foreignobject></g><g stroke="#000000" stroke-width="0.8pt"><path d="M 151.78 -127.42 L 84.44 -127.42 C 81.38 -127.42 78.91 -129.9 78.91 -132.95 L 78.91 -142.64 C 78.91 -145.7 81.38 -148.17 84.44 -148.17 L 151.78 -148.17 C 154.84 -148.17 157.31 -145.7 157.31 -142.64 L 157.31 -132.95 C 157.31 -129.9 154.84 -127.42 151.78 -127.42 Z M 78.91 -148.17" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 83.52 -142.64)"><foreignobject height="9.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="69.19">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.4.4.4.1.1" style="width:50.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.4.4.4.1.1.1"></span>
<span class="ltx_p" id="S1.F2.1.pic1.4.4.4.1.1.2"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.4.4.4.1.1.2.1">Mixed-dimension</span></span>
</span></foreignobject></g><g stroke="#000000" stroke-width="0.8pt"><path d="M 151.78 -225.46 L 84.44 -225.46 C 81.38 -225.46 78.91 -227.94 78.91 -230.99 L 78.91 -241.45 C 78.91 -244.5 81.38 -246.98 84.44 -246.98 L 151.78 -246.98 C 154.84 -246.98 157.31 -244.5 157.31 -241.45 L 157.31 -230.99 C 157.31 -227.94 154.84 -225.46 151.78 -225.46 Z M 78.91 -246.98" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 83.52 -239.76)"><foreignobject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="69.19">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.5.5.5.1.1" style="width:50.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.5.5.5.1.1.1"></span>
<span class="ltx_p" id="S1.F2.1.pic1.5.5.5.1.1.2"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.5.5.5.1.1.2.1">Weight-sharing</span></span>
</span></foreignobject></g><path d="M 314.96 -15.75 M 314.96 -57.09" style="fill:none"></path><g stroke="#000000" stroke-width="0.8pt"><path d="M 438.57 38.61 L 191.35 38.61 C 188.29 38.61 185.82 36.13 185.82 33.07 L 185.82 -64.57 C 185.82 -67.62 188.29 -70.1 191.35 -70.1 L 438.57 -70.1 C 441.63 -70.1 444.11 -67.62 444.11 -64.57 L 444.11 33.07 C 444.11 36.13 441.63 38.61 438.57 38.61 Z M 185.82 -70.1" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 190.43 24.31)"><foreignobject height="99.48" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="249.07">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" style="width:180.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></span>
<span class="ltx_tabular ltx_align_left ltx_align_middle" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
<span class="ltx_tr" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.1">Binarization:</span></span></span>
<span class="ltx_tr" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"><cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib43" title="">2014</a>)</cite>, <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib78" title="">2014</a>)</cite>, DCF <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib74" title="">2016</a>)</cite>, DCMF <cite class="ltx_cite ltx_citemacro_citep">(Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib34" title="">2017</a>)</cite>, DPR <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib77" title="">2017</a>)</cite>, DFM <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib38" title="">2018</a>)</cite></span></span>
<span class="ltx_tr" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">CIGAR <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib29" title="">2019</a>)</cite>, HashGNN <cite class="ltx_cite ltx_citemacro_citep">(Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib55" title="">2020</a>)</cite>, L<sup class="ltx_sup" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">2</sup>Q-GCN <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib6" title="">2021b</a>)</cite></span></span>
</span>
</span></foreignobject></g><g stroke="#000000" stroke-width="0.8pt"><path d="M 438.57 -20.58 L 191.35 -20.58 C 188.29 -20.58 185.82 -23.06 185.82 -26.12 L 185.82 -88.06 C 185.82 -91.11 188.29 -93.59 191.35 -93.59 L 438.57 -93.59 C 441.63 -93.59 444.11 -91.11 444.11 -88.06 L 444.11 -26.12 C 444.11 -23.06 441.63 -20.58 438.57 -20.58 Z M 185.82 -93.59" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 190.43 -34.88)"><foreignobject height="63.79" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="249.07">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.6.6.6.1.1" style="width:180.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.6.6.6.1.1.1"></span>
<span class="ltx_tabular ltx_align_left ltx_align_middle" id="S1.F2.1.pic1.6.6.6.1.1.2">
<span class="ltx_tr" id="S1.F2.1.pic1.6.6.6.1.1.2.1">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.6.6.6.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.6.6.6.1.1.2.1.1.1">Quantization:</span></span></span>
<span class="ltx_tr" id="S1.F2.1.pic1.6.6.6.1.1.2.2">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.6.6.6.1.1.2.2.1"><cite class="ltx_cite ltx_citemacro_citep">(Guan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib17" title="">2019</a>)</cite>, <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib70" title="">2020</a>)</cite>, <cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib67" title="">2021</a>)</cite>, ALPT <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib32" title="">2023</a>)</cite></span></span>
</span>
</span></foreignobject></g><path d="M 314.96 -96.46 M 314.96 -137.8 M 314.96 -179.13" style="fill:none"></path><g stroke="#000000" stroke-width="0.8pt"><path d="M 438.57 -66.25 L 191.35 -66.25 C 188.29 -66.25 185.82 -68.72 185.82 -71.78 L 185.82 -121.13 C 185.82 -124.19 188.29 -126.67 191.35 -126.67 L 438.57 -126.67 C 441.63 -126.67 444.11 -124.19 444.11 -121.13 L 444.11 -71.78 C 444.11 -68.72 441.63 -66.25 438.57 -66.25 Z M 185.82 -126.67" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 190.43 -80.54)"><foreignobject height="51.2" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="249.07">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.7.7.7.1.1" style="width:180.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.7.7.7.1.1.1"></span>
<span class="ltx_tabular ltx_align_left ltx_align_middle" id="S1.F2.1.pic1.7.7.7.1.1.2">
<span class="ltx_tr" id="S1.F2.1.pic1.7.7.7.1.1.2.1">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.7.7.7.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.7.7.7.1.1.2.1.1.1">Rule-based Approaches:</span></span></span>
<span class="ltx_tr" id="S1.F2.1.pic1.7.7.7.1.1.2.2">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.7.7.7.1.1.2.2.1">MDE <cite class="ltx_cite ltx_citemacro_citep">(Ginart et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib16" title="">2021</a>)</cite>, CpRec <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib54" title="">2020</a>)</cite></span></span>
</span>
</span></foreignobject></g><g stroke="#000000" stroke-width="0.8pt"><path d="M 438.57 -87.38 L 191.35 -87.38 C 188.29 -87.38 185.82 -89.86 185.82 -92.92 L 185.82 -182.67 C 185.82 -185.73 188.29 -188.21 191.35 -188.21 L 438.57 -188.21 C 441.63 -188.21 444.11 -185.73 444.11 -182.67 L 444.11 -92.92 C 444.11 -89.86 441.63 -87.38 438.57 -87.38 Z M 185.82 -188.21" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 190.43 -101.68)"><foreignobject height="91.6" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="249.07">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.8.8.8.1.1" style="width:180.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.8.8.8.1.1.1"></span>
<span class="ltx_tabular ltx_align_left ltx_align_middle" id="S1.F2.1.pic1.8.8.8.1.1.2">
<span class="ltx_tr" id="S1.F2.1.pic1.8.8.8.1.1.2.1">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.8.8.8.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.8.8.8.1.1.2.1.1.1">NAS-based Approaches:</span></span></span>
<span class="ltx_tr" id="S1.F2.1.pic1.8.8.8.1.1.2.2">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.8.8.8.1.1.2.2.1">NIS <cite class="ltx_cite ltx_citemacro_citep">(Joglekar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib26" title="">2020</a>)</cite>, ESAPN <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib40" title="">2020</a>)</cite>, AutoIAS <cite class="ltx_cite ltx_citemacro_citep">(Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib60" title="">2021</a>)</cite>,</span></span>
<span class="ltx_tr" id="S1.F2.1.pic1.8.8.8.1.1.2.3">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.8.8.8.1.1.2.3.1">AutoEmb <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib79" title="">2021</a>)</cite>, AutoDim <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib80" title="">2020</a>)</cite>, RULE <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib4" title="">2021a</a>)</cite>, OptEmbed <cite class="ltx_cite ltx_citemacro_citep">(Lyu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib44" title="">2022</a>)</cite></span></span>
</span>
</span></foreignobject></g><g stroke="#000000" stroke-width="0.8pt"><path d="M 438.57 -142.63 L 191.35 -142.63 C 188.29 -142.63 185.82 -145.11 185.82 -148.16 L 185.82 -210.11 C 185.82 -213.16 188.29 -215.64 191.35 -215.64 L 438.57 -215.64 C 441.63 -215.64 444.11 -213.16 444.11 -210.11 L 444.11 -148.16 C 444.11 -145.11 441.63 -142.63 438.57 -142.63 Z M 185.82 -215.64" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 190.43 -156.93)"><foreignobject height="63.79" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="249.07">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.9.9.9.1.1" style="width:180.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.9.9.9.1.1.1"></span>
<span class="ltx_tabular ltx_align_left ltx_align_middle" id="S1.F2.1.pic1.9.9.9.1.1.2">
<span class="ltx_tr" id="S1.F2.1.pic1.9.9.9.1.1.2.1">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.9.9.9.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.9.9.9.1.1.2.1.1.1">Pruning:</span></span></span>
<span class="ltx_tr" id="S1.F2.1.pic1.9.9.9.1.1.2.2">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.9.9.9.1.1.2.2.1">DeepLight <cite class="ltx_cite ltx_citemacro_citep">(Deng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib11" title="">2021</a>)</cite>, DNIS <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib8" title="">2020</a>)</cite>, AMTL <cite class="ltx_cite ltx_citemacro_citep">(Yan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib69" title="">2021b</a>)</cite>, PEP <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib42" title="">2021</a>)</cite>, SSEDS <cite class="ltx_cite ltx_citemacro_citep">(Qu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib49" title="">2022</a>)</cite></span></span>
</span>
</span></foreignobject></g><path d="M 314.96 -218.5 M 314.96 -253.94 M 314.96 -289.37" style="fill:none"></path><g stroke="#000000" stroke-width="0.8pt"><path d="M 438.57 -182 L 191.35 -182 C 188.29 -182 185.82 -184.48 185.82 -187.53 L 185.82 -249.48 C 185.82 -252.53 188.29 -255.01 191.35 -255.01 L 438.57 -255.01 C 441.63 -255.01 444.11 -252.53 444.11 -249.48 L 444.11 -187.53 C 444.11 -184.48 441.63 -182 438.57 -182 Z M 185.82 -255.01" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 190.43 -196.3)"><foreignobject height="63.79" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="249.07">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.10.10.10.1.1" style="width:180.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.10.10.10.1.1.1"></span>
<span class="ltx_tabular ltx_align_left ltx_align_middle" id="S1.F2.1.pic1.10.10.10.1.1.2">
<span class="ltx_tr" id="S1.F2.1.pic1.10.10.10.1.1.2.1">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.10.10.10.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.10.10.10.1.1.2.1.1.1">Hashing:</span></span></span>
<span class="ltx_tr" id="S1.F2.1.pic1.10.10.10.1.1.2.2">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.10.10.10.1.1.2.2.1">QR <cite class="ltx_cite ltx_citemacro_citep">(Shi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib51" title="">2020</a>)</cite>, MEmCom <cite class="ltx_cite ltx_citemacro_citep">(Pansare et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib48" title="">2022</a>)</cite>, BCH <cite class="ltx_cite ltx_citemacro_citep">(Yan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib68" title="">2021a</a>)</cite>, FDH <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib73" title="">2020</a>)</cite>, LMA <cite class="ltx_cite ltx_citemacro_citep">(Desai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib13" title="">2021</a>)</cite>, ROBE <cite class="ltx_cite ltx_citemacro_citep">(Desai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib12" title="">2022</a>)</cite></span></span>
</span>
</span></foreignobject></g><g stroke="#000000" stroke-width="0.8pt"><path d="M 438.57 -217.43 L 191.35 -217.43 C 188.29 -217.43 185.82 -219.91 185.82 -222.97 L 185.82 -284.91 C 185.82 -287.97 188.29 -290.44 191.35 -290.44 L 438.57 -290.44 C 441.63 -290.44 444.11 -287.97 444.11 -284.91 L 444.11 -222.97 C 444.11 -219.91 441.63 -217.43 438.57 -217.43 Z M 185.82 -290.44" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 190.43 -231.73)"><foreignobject height="63.79" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="249.07">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.11.11.11.1.1" style="width:180.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.11.11.11.1.1.1"></span>
<span class="ltx_tabular ltx_align_left ltx_align_middle" id="S1.F2.1.pic1.11.11.11.1.1.2">
<span class="ltx_tr" id="S1.F2.1.pic1.11.11.11.1.1.2.1">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.11.11.11.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.11.11.11.1.1.2.1.1.1">Vector Quantization:</span></span></span>
<span class="ltx_tr" id="S1.F2.1.pic1.11.11.11.1.1.2.2">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.11.11.11.1.1.2.2.1">Saec <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib63" title="">2020</a>)</cite>, MGQE <cite class="ltx_cite ltx_citemacro_citep">(Kang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib27" title="">2020</a>)</cite>, xLightFM <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib25" title="">2021</a>)</cite>, LightRec <cite class="ltx_cite ltx_citemacro_citep">(Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib35" title="">2020</a>)</cite>, LISA <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib64" title="">2021</a>)</cite></span></span>
</span>
</span></foreignobject></g><g stroke="#000000" stroke-width="0.8pt"><path d="M 438.57 -252.86 L 191.35 -252.86 C 188.29 -252.86 185.82 -255.34 185.82 -258.4 L 185.82 -320.34 C 185.82 -323.4 188.29 -325.88 191.35 -325.88 L 438.57 -325.88 C 441.63 -325.88 444.11 -323.4 444.11 -320.34 L 444.11 -258.4 C 444.11 -255.34 441.63 -252.86 438.57 -252.86 Z M 185.82 -325.88" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(1.0 0.0 0.0 1.0 190.43 -267.16)"><foreignobject height="63.79" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="249.07">
<span class="ltx_inline-block ltx_minipage ltx_align_top" id="S1.F2.1.pic1.12.12.12.1.1" style="width:180.0pt;">
<span class="ltx_p" id="S1.F2.1.pic1.12.12.12.1.1.1"></span>
<span class="ltx_tabular ltx_align_left ltx_align_middle" id="S1.F2.1.pic1.12.12.12.1.1.2">
<span class="ltx_tr" id="S1.F2.1.pic1.12.12.12.1.1.2.1">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.12.12.12.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S1.F2.1.pic1.12.12.12.1.1.2.1.1.1">Decomposition:</span></span></span>
<span class="ltx_tr" id="S1.F2.1.pic1.12.12.12.1.1.2.2">
<span class="ltx_td ltx_align_left" id="S1.F2.1.pic1.12.12.12.1.1.2.2.1">MLET <cite class="ltx_cite ltx_citemacro_citep">(Ghaemmaghami et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib15" title="">2020</a>)</cite>, ANT <cite class="ltx_cite ltx_citemacro_citep">(Liang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib36" title="">2021</a>)</cite>, DHE <cite class="ltx_cite ltx_citemacro_citep">(Kang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib28" title="">2021</a>)</cite>, TT-Rec<cite class="ltx_cite ltx_citemacro_citep">(Yin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib72" title="">2021</a>)</cite>, LLRec <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib57" title="">2020</a>)</cite>, <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib65" title="">2022</a>)</cite></span></span>
</span>
</span></foreignobject></g><path d="M 39.76 -137.8 L 78.35 -39.37" style="fill:none"></path><path d="M 39.76 -137.8 L 78.35 -137.8" style="fill:none"></path><path d="M 39.76 -137.8 L 78.35 -236.22" style="fill:none"></path><path d="M 157.87 -39.37 L 185.26 -15.75" style="fill:none"></path><path d="M 157.87 -39.37 L 185.26 -57.09" style="fill:none"></path><path d="M 157.87 -137.8 L 185.26 -96.46" style="fill:none"></path><path d="M 157.87 -137.8 L 185.26 -137.8" style="fill:none"></path><path d="M 157.87 -137.8 L 185.26 -179.13" style="fill:none"></path><path d="M 157.87 -236.22 L 185.26 -218.5" style="fill:none"></path><path d="M 157.87 -236.22 L 185.26 -253.94" style="fill:none"></path><path d="M 157.87 -236.22 L 185.26 -289.37" style="fill:none"></path></g></svg>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Summary of representative studies on embedding compression in recommender systems.</figcaption>
</figure>
<div class="ltx_para" id="S1.SS2.p3">
<p class="ltx_p" id="S1.SS2.p3.1">Recently, embedding compression has gained increasing attention in recommender systems, leading to the development and application of various embedding compression techniques for DLRMs.
However, there is currently no comprehensive survey summarizing the methods employed for embedding compression. Therefore, the primary objective of this paper is to review and summarize representative research in this field.
The embedding table can be regarded as a matrix with three dimensions, that are the precision of weights, the dimension of embeddings, and the number of embeddings.
To this end, we summary the embedding compression methods into three categories according to the dimensions they compress, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S1.F2" title="Figure 2 ‣ 1.2. Embedding Compression in Recommender Systems ‣ 1. Introduction ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">2</span></a>.
Firstly, <span class="ltx_text ltx_font_bold" id="S1.SS2.p3.1.1">low-precision</span> methods reduce the memory of each weight by decreasing its bit width. According to the size of bit width and its corresponding advantages, we further divide the low-precision methods into binarization and quantization.
Secondly, <span class="ltx_text ltx_font_bold" id="S1.SS2.p3.1.2">mixed-dimension</span> methods reduce the memory of specific embeddings by decreasing their dimensions and using mixed-dimension embeddings. According to the techniques of determining the embedding dimension for different features, we categorize the mixed-dimension methods into rule-based approaches, NAS-based approaches, and pruning.
Thirdly, <span class="ltx_text ltx_font_bold" id="S1.SS2.p3.1.3">weight-sharing</span> methods reduce the actual parameters of the embedding table by sharing weights among different embeddings.
Considering that the number of features is given by the dataset, a solution to reduce the number of embeddings is to reuse embeddings among features. Furthermore, we generalize the sharing to the weight level and define the weight-sharing methods as generating embeddings with shared weights.
According to the way embeddings are generated, we categorize the mixed-dimension methods into hashing, vector quantization, and decomposition.
We will introduce the three primary categories in Sections <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S2" title="2. Low-Precision ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S3" title="3. Mixed-Dimension ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">3</span></a> and  <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S4" title="4. Weight-Sharing ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">4</span></a>, respectively.</p>
</div>
<div class="ltx_para" id="S1.SS2.p4">
<p class="ltx_p" id="S1.SS2.p4.1">Note that embeddings are fed into the neural network as representations of categorical features and form the foundations of DLRMs. Therefore, when compressing embeddings, it may affect the model performance on many aspects, including model accuracy, inference efficiency, training efficiency, and training memory usage. We will discuss the pros and cons of different methods regarding these metrics at the end of each section. In Section <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S5" title="5. Summary ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">5</span></a>, the survey is summarized, providing general suggestions for different scenarios and discussing future prospects for this field.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Low-Precision</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">As we all know, embedding weights are typically stored in the format of FP32 <span class="ltx_note ltx_role_footnote" id="footnotex2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>The short of single-precision floating-point format.</span></span></span> which occupies 32 bits.
To reduce the storage of each weight, low-precision approaches are developed to represent a weight with fewer bits.
In particular, according to the bit width of weights, low-precision approaches can be further divided into <span class="ltx_text ltx_font_bold" id="S2.p1.1.1">binarization</span> and <span class="ltx_text ltx_font_bold" id="S2.p1.1.2">quantization</span>.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Binarization</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Binarization is to compress a full-precision weight into a binary code that only occupy 1 bit.
It is widely used in the embedding-based similarity search of recommender systems <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib29" title="">2019</a>; Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib55" title="">2020</a>)</cite>,
since the binary embeddings have two distinct advantages compared to the full-precision ones:
(1) less memory or disk cost for storing embeddings;
(2) higher inference efficiency as the similarity (i.e., inner product) between binary embeddings can be calculated more efficiently through the Hamming distance,
which has been proved in <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib74" title="">2016</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1"><cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib43" title="">2014</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib78" title="">2014</a>)</cite> pioneered to obtain binary embeddings in a two-stage (i.e, post-training) manner.
Specifically, they first learn a full-precision embedding table while ignoring the binary constraints,
and then perform binarization (e.g., <math alttext="sign(x)" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.2" xref="S2.SS1.p2.1.m1.1.2.cmml"><mi id="S2.SS1.p2.1.m1.1.2.2" xref="S2.SS1.p2.1.m1.1.2.2.cmml">s</mi><mo id="S2.SS1.p2.1.m1.1.2.1" xref="S2.SS1.p2.1.m1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.p2.1.m1.1.2.3" xref="S2.SS1.p2.1.m1.1.2.3.cmml">i</mi><mo id="S2.SS1.p2.1.m1.1.2.1a" xref="S2.SS1.p2.1.m1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.p2.1.m1.1.2.4" xref="S2.SS1.p2.1.m1.1.2.4.cmml">g</mi><mo id="S2.SS1.p2.1.m1.1.2.1b" xref="S2.SS1.p2.1.m1.1.2.1.cmml">⁢</mo><mi id="S2.SS1.p2.1.m1.1.2.5" xref="S2.SS1.p2.1.m1.1.2.5.cmml">n</mi><mo id="S2.SS1.p2.1.m1.1.2.1c" xref="S2.SS1.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p2.1.m1.1.2.6.2" xref="S2.SS1.p2.1.m1.1.2.cmml"><mo id="S2.SS1.p2.1.m1.1.2.6.2.1" stretchy="false" xref="S2.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">x</mi><mo id="S2.SS1.p2.1.m1.1.2.6.2.2" stretchy="false" xref="S2.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.2"><times id="S2.SS1.p2.1.m1.1.2.1.cmml" xref="S2.SS1.p2.1.m1.1.2.1"></times><ci id="S2.SS1.p2.1.m1.1.2.2.cmml" xref="S2.SS1.p2.1.m1.1.2.2">𝑠</ci><ci id="S2.SS1.p2.1.m1.1.2.3.cmml" xref="S2.SS1.p2.1.m1.1.2.3">𝑖</ci><ci id="S2.SS1.p2.1.m1.1.2.4.cmml" xref="S2.SS1.p2.1.m1.1.2.4">𝑔</ci><ci id="S2.SS1.p2.1.m1.1.2.5.cmml" xref="S2.SS1.p2.1.m1.1.2.5">𝑛</ci><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">sign(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_s italic_i italic_g italic_n ( italic_x )</annotation></semantics></math>) on the full-precision embeddings to get binary embeddings.
However, the binarization procedure is not in the training process and thus cannot be optimized by minimizing the training objective,
which will bring large irreparable errors and fail to meet an acceptable accuracy.
To reduce accuracy degradation, subsequent works have focused on end-to-end approaches to learn the binary embeddings during training.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.11">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S2.F3" title="Figure 3 ‣ 2.1. Binarization ‣ 2. Low-Precision ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">3</span></a>, recent works typically learn binary embeddings following two optimization paradigms, namely direct optimization and indirect optimization.
As Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S2.F3" title="Figure 3 ‣ 2.1. Binarization ‣ 2. Low-Precision ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">3</span></a>(a) shows, in the direct optimization of binarization,
the binary embeddings are maintained as part of the model parameters and will be optimized directly by the training loss.
For example, to improve the efficiency of Collaborative Filtering (CF), DCF <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib74" title="">2016</a>)</cite> learns a binary embedding table <math alttext="\mathbf{B}\in{\{\pm 1\}}^{n\times d}" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.1"><semantics id="S2.SS1.p3.1.m1.1a"><mrow id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml">𝐁</mi><mo id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">∈</mo><msup id="S2.SS1.p3.1.m1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.cmml"><mrow id="S2.SS1.p3.1.m1.1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.2.cmml"><mo id="S2.SS1.p3.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p3.1.m1.1.1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p3.1.m1.1.1.1.1.1.1a" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.cmml">±</mo><mn id="S2.SS1.p3.1.m1.1.1.1.1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.2.cmml">1</mn></mrow><mo id="S2.SS1.p3.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p3.1.m1.1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.1.3.cmml"><mi id="S2.SS1.p3.1.m1.1.1.1.3.2" xref="S2.SS1.p3.1.m1.1.1.1.3.2.cmml">n</mi><mo id="S2.SS1.p3.1.m1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p3.1.m1.1.1.1.3.1.cmml">×</mo><mi id="S2.SS1.p3.1.m1.1.1.1.3.3" xref="S2.SS1.p3.1.m1.1.1.1.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"><in id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2"></in><ci id="S2.SS1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3">𝐁</ci><apply id="S2.SS1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1">superscript</csymbol><set id="S2.SS1.p3.1.m1.1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1"><apply id="S2.SS1.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1">plus-or-minus</csymbol><cn id="S2.SS1.p3.1.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.SS1.p3.1.m1.1.1.1.1.1.1.2">1</cn></apply></set><apply id="S2.SS1.p3.1.m1.1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.3"><times id="S2.SS1.p3.1.m1.1.1.1.3.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.3.1"></times><ci id="S2.SS1.p3.1.m1.1.1.1.3.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.3.2">𝑛</ci><ci id="S2.SS1.p3.1.m1.1.1.1.3.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">\mathbf{B}\in{\{\pm 1\}}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.1d">bold_B ∈ { ± 1 } start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.
To maximize the information encoded in each binary embedding, DCF further adds a balance-uncorrelation constraint to <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="S2.SS1.p3.2.m2.1"><semantics id="S2.SS1.p3.2.m2.1a"><mi id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><ci id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.1d">bold_B</annotation></semantics></math>
(i.e., <math alttext="\mathbf{B}^{T}\mathbf{1}=\mathbf{0},\mathbf{B}^{T}\mathbf{B}=n\mathbf{I}" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.2"><semantics id="S2.SS1.p3.3.m3.2a"><mrow id="S2.SS1.p3.3.m3.2.2.2" xref="S2.SS1.p3.3.m3.2.2.3.cmml"><mrow id="S2.SS1.p3.3.m3.1.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.1.cmml"><mrow id="S2.SS1.p3.3.m3.1.1.1.1.2" xref="S2.SS1.p3.3.m3.1.1.1.1.2.cmml"><msup id="S2.SS1.p3.3.m3.1.1.1.1.2.2" xref="S2.SS1.p3.3.m3.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p3.3.m3.1.1.1.1.2.2.2" xref="S2.SS1.p3.3.m3.1.1.1.1.2.2.2.cmml">𝐁</mi><mi id="S2.SS1.p3.3.m3.1.1.1.1.2.2.3" xref="S2.SS1.p3.3.m3.1.1.1.1.2.2.3.cmml">T</mi></msup><mo id="S2.SS1.p3.3.m3.1.1.1.1.2.1" xref="S2.SS1.p3.3.m3.1.1.1.1.2.1.cmml">⁢</mo><mn id="S2.SS1.p3.3.m3.1.1.1.1.2.3" xref="S2.SS1.p3.3.m3.1.1.1.1.2.3.cmml">𝟏</mn></mrow><mo id="S2.SS1.p3.3.m3.1.1.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.1.1.cmml">=</mo><mn id="S2.SS1.p3.3.m3.1.1.1.1.3" xref="S2.SS1.p3.3.m3.1.1.1.1.3.cmml">𝟎</mn></mrow><mo id="S2.SS1.p3.3.m3.2.2.2.3" xref="S2.SS1.p3.3.m3.2.2.3a.cmml">,</mo><mrow id="S2.SS1.p3.3.m3.2.2.2.2" xref="S2.SS1.p3.3.m3.2.2.2.2.cmml"><mrow id="S2.SS1.p3.3.m3.2.2.2.2.2" xref="S2.SS1.p3.3.m3.2.2.2.2.2.cmml"><msup id="S2.SS1.p3.3.m3.2.2.2.2.2.2" xref="S2.SS1.p3.3.m3.2.2.2.2.2.2.cmml"><mi id="S2.SS1.p3.3.m3.2.2.2.2.2.2.2" xref="S2.SS1.p3.3.m3.2.2.2.2.2.2.2.cmml">𝐁</mi><mi id="S2.SS1.p3.3.m3.2.2.2.2.2.2.3" xref="S2.SS1.p3.3.m3.2.2.2.2.2.2.3.cmml">T</mi></msup><mo id="S2.SS1.p3.3.m3.2.2.2.2.2.1" xref="S2.SS1.p3.3.m3.2.2.2.2.2.1.cmml">⁢</mo><mi id="S2.SS1.p3.3.m3.2.2.2.2.2.3" xref="S2.SS1.p3.3.m3.2.2.2.2.2.3.cmml">𝐁</mi></mrow><mo id="S2.SS1.p3.3.m3.2.2.2.2.1" xref="S2.SS1.p3.3.m3.2.2.2.2.1.cmml">=</mo><mrow id="S2.SS1.p3.3.m3.2.2.2.2.3" xref="S2.SS1.p3.3.m3.2.2.2.2.3.cmml"><mi id="S2.SS1.p3.3.m3.2.2.2.2.3.2" xref="S2.SS1.p3.3.m3.2.2.2.2.3.2.cmml">n</mi><mo id="S2.SS1.p3.3.m3.2.2.2.2.3.1" xref="S2.SS1.p3.3.m3.2.2.2.2.3.1.cmml">⁢</mo><mi id="S2.SS1.p3.3.m3.2.2.2.2.3.3" xref="S2.SS1.p3.3.m3.2.2.2.2.3.3.cmml">𝐈</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.2b"><apply id="S2.SS1.p3.3.m3.2.2.3.cmml" xref="S2.SS1.p3.3.m3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.2.2.3a.cmml" xref="S2.SS1.p3.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS1.p3.3.m3.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1"><eq id="S2.SS1.p3.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.1"></eq><apply id="S2.SS1.p3.3.m3.1.1.1.1.2.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.2"><times id="S2.SS1.p3.3.m3.1.1.1.1.2.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.2.1"></times><apply id="S2.SS1.p3.3.m3.1.1.1.1.2.2.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.2.2">superscript</csymbol><ci id="S2.SS1.p3.3.m3.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.2.2.2">𝐁</ci><ci id="S2.SS1.p3.3.m3.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.2.2.3">𝑇</ci></apply><cn id="S2.SS1.p3.3.m3.1.1.1.1.2.3.cmml" type="integer" xref="S2.SS1.p3.3.m3.1.1.1.1.2.3">1</cn></apply><cn id="S2.SS1.p3.3.m3.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p3.3.m3.1.1.1.1.3">0</cn></apply><apply id="S2.SS1.p3.3.m3.2.2.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2"><eq id="S2.SS1.p3.3.m3.2.2.2.2.1.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.1"></eq><apply id="S2.SS1.p3.3.m3.2.2.2.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.2"><times id="S2.SS1.p3.3.m3.2.2.2.2.2.1.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.2.1"></times><apply id="S2.SS1.p3.3.m3.2.2.2.2.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m3.2.2.2.2.2.2.1.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.2.2">superscript</csymbol><ci id="S2.SS1.p3.3.m3.2.2.2.2.2.2.2.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.2.2.2">𝐁</ci><ci id="S2.SS1.p3.3.m3.2.2.2.2.2.2.3.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.2.2.3">𝑇</ci></apply><ci id="S2.SS1.p3.3.m3.2.2.2.2.2.3.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.2.3">𝐁</ci></apply><apply id="S2.SS1.p3.3.m3.2.2.2.2.3.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.3"><times id="S2.SS1.p3.3.m3.2.2.2.2.3.1.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.3.1"></times><ci id="S2.SS1.p3.3.m3.2.2.2.2.3.2.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.3.2">𝑛</ci><ci id="S2.SS1.p3.3.m3.2.2.2.2.3.3.cmml" xref="S2.SS1.p3.3.m3.2.2.2.2.3.3">𝐈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.2c">\mathbf{B}^{T}\mathbf{1}=\mathbf{0},\mathbf{B}^{T}\mathbf{B}=n\mathbf{I}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.2d">bold_B start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_1 = bold_0 , bold_B start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_B = italic_n bold_I</annotation></semantics></math>), where <math alttext="\mathbf{I}" class="ltx_Math" display="inline" id="S2.SS1.p3.4.m4.1"><semantics id="S2.SS1.p3.4.m4.1a"><mi id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.1b"><ci id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.1c">\mathbf{I}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.4.m4.1d">bold_I</annotation></semantics></math> is an identity matrix.
However, it is NP-hard to optimize the binary embeddings with such constraint.
To resolve this problem, DCF also maintains a full-precision embedding table <math alttext="\mathbf{E}\in\operatorname*{\mathbb{R}}^{n\times d}" class="ltx_Math" display="inline" id="S2.SS1.p3.5.m5.1"><semantics id="S2.SS1.p3.5.m5.1a"><mrow id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml"><mi id="S2.SS1.p3.5.m5.1.1.2" xref="S2.SS1.p3.5.m5.1.1.2.cmml">𝐄</mi><mo id="S2.SS1.p3.5.m5.1.1.1" rspace="0.1389em" xref="S2.SS1.p3.5.m5.1.1.1.cmml">∈</mo><msup id="S2.SS1.p3.5.m5.1.1.3" xref="S2.SS1.p3.5.m5.1.1.3.cmml"><mo id="S2.SS1.p3.5.m5.1.1.3.2" lspace="0.1389em" xref="S2.SS1.p3.5.m5.1.1.3.2.cmml">ℝ</mo><mrow id="S2.SS1.p3.5.m5.1.1.3.3" xref="S2.SS1.p3.5.m5.1.1.3.3.cmml"><mi id="S2.SS1.p3.5.m5.1.1.3.3.2" xref="S2.SS1.p3.5.m5.1.1.3.3.2.cmml">n</mi><mo id="S2.SS1.p3.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p3.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S2.SS1.p3.5.m5.1.1.3.3.3" xref="S2.SS1.p3.5.m5.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><apply id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1"><in id="S2.SS1.p3.5.m5.1.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1.1"></in><ci id="S2.SS1.p3.5.m5.1.1.2.cmml" xref="S2.SS1.p3.5.m5.1.1.2">𝐄</ci><apply id="S2.SS1.p3.5.m5.1.1.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m5.1.1.3.1.cmml" xref="S2.SS1.p3.5.m5.1.1.3">superscript</csymbol><ci id="S2.SS1.p3.5.m5.1.1.3.2.cmml" xref="S2.SS1.p3.5.m5.1.1.3.2">ℝ</ci><apply id="S2.SS1.p3.5.m5.1.1.3.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3.3"><times id="S2.SS1.p3.5.m5.1.1.3.3.1.cmml" xref="S2.SS1.p3.5.m5.1.1.3.3.1"></times><ci id="S2.SS1.p3.5.m5.1.1.3.3.2.cmml" xref="S2.SS1.p3.5.m5.1.1.3.3.2">𝑛</ci><ci id="S2.SS1.p3.5.m5.1.1.3.3.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">\mathbf{E}\in\operatorname*{\mathbb{R}}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.5.m5.1d">bold_E ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> with the same balance-uncorrelation constraint.
The constraint of <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="S2.SS1.p3.6.m6.1"><semantics id="S2.SS1.p3.6.m6.1a"><mi id="S2.SS1.p3.6.m6.1.1" xref="S2.SS1.p3.6.m6.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m6.1b"><ci id="S2.SS1.p3.6.m6.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.6.m6.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.6.m6.1d">bold_B</annotation></semantics></math> is then replaced by adding the mean-square-error (MSE) of <math alttext="(\mathbf{B}-\mathbf{E})" class="ltx_Math" display="inline" id="S2.SS1.p3.7.m7.1"><semantics id="S2.SS1.p3.7.m7.1a"><mrow id="S2.SS1.p3.7.m7.1.1.1" xref="S2.SS1.p3.7.m7.1.1.1.1.cmml"><mo id="S2.SS1.p3.7.m7.1.1.1.2" stretchy="false" xref="S2.SS1.p3.7.m7.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p3.7.m7.1.1.1.1" xref="S2.SS1.p3.7.m7.1.1.1.1.cmml"><mi id="S2.SS1.p3.7.m7.1.1.1.1.2" xref="S2.SS1.p3.7.m7.1.1.1.1.2.cmml">𝐁</mi><mo id="S2.SS1.p3.7.m7.1.1.1.1.1" xref="S2.SS1.p3.7.m7.1.1.1.1.1.cmml">−</mo><mi id="S2.SS1.p3.7.m7.1.1.1.1.3" xref="S2.SS1.p3.7.m7.1.1.1.1.3.cmml">𝐄</mi></mrow><mo id="S2.SS1.p3.7.m7.1.1.1.3" stretchy="false" xref="S2.SS1.p3.7.m7.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.7.m7.1b"><apply id="S2.SS1.p3.7.m7.1.1.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1.1"><minus id="S2.SS1.p3.7.m7.1.1.1.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1.1.1.1"></minus><ci id="S2.SS1.p3.7.m7.1.1.1.1.2.cmml" xref="S2.SS1.p3.7.m7.1.1.1.1.2">𝐁</ci><ci id="S2.SS1.p3.7.m7.1.1.1.1.3.cmml" xref="S2.SS1.p3.7.m7.1.1.1.1.3">𝐄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.7.m7.1c">(\mathbf{B}-\mathbf{E})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.7.m7.1d">( bold_B - bold_E )</annotation></semantics></math> to the objective function.
During training, DCF will update <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="S2.SS1.p3.8.m8.1"><semantics id="S2.SS1.p3.8.m8.1a"><mi id="S2.SS1.p3.8.m8.1.1" xref="S2.SS1.p3.8.m8.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.8.m8.1b"><ci id="S2.SS1.p3.8.m8.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.8.m8.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.8.m8.1d">bold_B</annotation></semantics></math> and <math alttext="\mathbf{E}" class="ltx_Math" display="inline" id="S2.SS1.p3.9.m9.1"><semantics id="S2.SS1.p3.9.m9.1a"><mi id="S2.SS1.p3.9.m9.1.1" xref="S2.SS1.p3.9.m9.1.1.cmml">𝐄</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.9.m9.1b"><ci id="S2.SS1.p3.9.m9.1.1.cmml" xref="S2.SS1.p3.9.m9.1.1">𝐄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.9.m9.1c">\mathbf{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.9.m9.1d">bold_E</annotation></semantics></math> alternatively through different optimization algorithms.
Specifically, <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="S2.SS1.p3.10.m10.1"><semantics id="S2.SS1.p3.10.m10.1a"><mi id="S2.SS1.p3.10.m10.1.1" xref="S2.SS1.p3.10.m10.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.10.m10.1b"><ci id="S2.SS1.p3.10.m10.1.1.cmml" xref="S2.SS1.p3.10.m10.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.10.m10.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.10.m10.1d">bold_B</annotation></semantics></math> is updated by Discrete Coordinate Descent (DCD) and <math alttext="\mathbf{E}" class="ltx_Math" display="inline" id="S2.SS1.p3.11.m11.1"><semantics id="S2.SS1.p3.11.m11.1a"><mi id="S2.SS1.p3.11.m11.1.1" xref="S2.SS1.p3.11.m11.1.1.cmml">𝐄</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.11.m11.1b"><ci id="S2.SS1.p3.11.m11.1.1.cmml" xref="S2.SS1.p3.11.m11.1.1">𝐄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.11.m11.1c">\mathbf{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.11.m11.1d">bold_E</annotation></semantics></math> is updated with the aid of Singular Value Decomposition (SVD).
This optimization paradigm has been widely used to learn binary embeddings in recommender systems, such as DPR <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib77" title="">2017</a>)</cite>, DCMF <cite class="ltx_cite ltx_citemacro_citep">(Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib34" title="">2017</a>)</cite>, DFM <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib38" title="">2018</a>)</cite>.
DPR changes the objective function of DCF (i.e., rating prediction) to personalized items ranking.
DCMF and DFM extends this binarization paradigm to Content-aware Collaborative Filtering <cite class="ltx_cite ltx_citemacro_citep">(Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib33" title="">2015</a>)</cite> and Factorization Machine (FM) <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib50" title="">2010</a>)</cite>, respectively.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="99" id="S2.F3.g1" src="extracted/5774277/figs/binarization.png" width="347"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>End-to-end optimization paradigms of learning binary embeddings. <math alttext="B" class="ltx_Math" display="inline" id="S2.F3.6.m1.1"><semantics id="S2.F3.6.m1.1b"><mi id="S2.F3.6.m1.1.1" xref="S2.F3.6.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S2.F3.6.m1.1c"><ci id="S2.F3.6.m1.1.1.cmml" xref="S2.F3.6.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.6.m1.1d">B</annotation><annotation encoding="application/x-llamapun" id="S2.F3.6.m1.1e">italic_B</annotation></semantics></math> (yellow) and <math alttext="E" class="ltx_Math" display="inline" id="S2.F3.7.m2.1"><semantics id="S2.F3.7.m2.1b"><mi id="S2.F3.7.m2.1.1" xref="S2.F3.7.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.F3.7.m2.1c"><ci id="S2.F3.7.m2.1.1.cmml" xref="S2.F3.7.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.7.m2.1d">E</annotation><annotation encoding="application/x-llamapun" id="S2.F3.7.m2.1e">italic_E</annotation></semantics></math> (green) represent the binary and full-precision weights, respectively.
<math alttext="Loss" class="ltx_Math" display="inline" id="S2.F3.8.m3.1"><semantics id="S2.F3.8.m3.1b"><mrow id="S2.F3.8.m3.1.1" xref="S2.F3.8.m3.1.1.cmml"><mi id="S2.F3.8.m3.1.1.2" xref="S2.F3.8.m3.1.1.2.cmml">L</mi><mo id="S2.F3.8.m3.1.1.1" xref="S2.F3.8.m3.1.1.1.cmml">⁢</mo><mi id="S2.F3.8.m3.1.1.3" xref="S2.F3.8.m3.1.1.3.cmml">o</mi><mo id="S2.F3.8.m3.1.1.1b" xref="S2.F3.8.m3.1.1.1.cmml">⁢</mo><mi id="S2.F3.8.m3.1.1.4" xref="S2.F3.8.m3.1.1.4.cmml">s</mi><mo id="S2.F3.8.m3.1.1.1c" xref="S2.F3.8.m3.1.1.1.cmml">⁢</mo><mi id="S2.F3.8.m3.1.1.5" xref="S2.F3.8.m3.1.1.5.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.F3.8.m3.1c"><apply id="S2.F3.8.m3.1.1.cmml" xref="S2.F3.8.m3.1.1"><times id="S2.F3.8.m3.1.1.1.cmml" xref="S2.F3.8.m3.1.1.1"></times><ci id="S2.F3.8.m3.1.1.2.cmml" xref="S2.F3.8.m3.1.1.2">𝐿</ci><ci id="S2.F3.8.m3.1.1.3.cmml" xref="S2.F3.8.m3.1.1.3">𝑜</ci><ci id="S2.F3.8.m3.1.1.4.cmml" xref="S2.F3.8.m3.1.1.4">𝑠</ci><ci id="S2.F3.8.m3.1.1.5.cmml" xref="S2.F3.8.m3.1.1.5">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.8.m3.1d">Loss</annotation><annotation encoding="application/x-llamapun" id="S2.F3.8.m3.1e">italic_L italic_o italic_s italic_s</annotation></semantics></math> (red) is the training loss where <math alttext="\Psi(\cdot)" class="ltx_Math" display="inline" id="S2.F3.9.m4.1"><semantics id="S2.F3.9.m4.1b"><mrow id="S2.F3.9.m4.1.2" xref="S2.F3.9.m4.1.2.cmml"><mi id="S2.F3.9.m4.1.2.2" mathvariant="normal" xref="S2.F3.9.m4.1.2.2.cmml">Ψ</mi><mo id="S2.F3.9.m4.1.2.1" xref="S2.F3.9.m4.1.2.1.cmml">⁢</mo><mrow id="S2.F3.9.m4.1.2.3.2" xref="S2.F3.9.m4.1.2.cmml"><mo id="S2.F3.9.m4.1.2.3.2.1" stretchy="false" xref="S2.F3.9.m4.1.2.cmml">(</mo><mo id="S2.F3.9.m4.1.1" lspace="0em" rspace="0em" xref="S2.F3.9.m4.1.1.cmml">⋅</mo><mo id="S2.F3.9.m4.1.2.3.2.2" stretchy="false" xref="S2.F3.9.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F3.9.m4.1c"><apply id="S2.F3.9.m4.1.2.cmml" xref="S2.F3.9.m4.1.2"><times id="S2.F3.9.m4.1.2.1.cmml" xref="S2.F3.9.m4.1.2.1"></times><ci id="S2.F3.9.m4.1.2.2.cmml" xref="S2.F3.9.m4.1.2.2">Ψ</ci><ci id="S2.F3.9.m4.1.1.cmml" xref="S2.F3.9.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.9.m4.1d">\Psi(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.F3.9.m4.1e">roman_Ψ ( ⋅ )</annotation></semantics></math> is the objective function and <math alttext="\text{MSE}(\cdot)" class="ltx_Math" display="inline" id="S2.F3.10.m5.1"><semantics id="S2.F3.10.m5.1b"><mrow id="S2.F3.10.m5.1.2" xref="S2.F3.10.m5.1.2.cmml"><mtext id="S2.F3.10.m5.1.2.2" xref="S2.F3.10.m5.1.2.2a.cmml">MSE</mtext><mo id="S2.F3.10.m5.1.2.1" xref="S2.F3.10.m5.1.2.1.cmml">⁢</mo><mrow id="S2.F3.10.m5.1.2.3.2" xref="S2.F3.10.m5.1.2.cmml"><mo id="S2.F3.10.m5.1.2.3.2.1" stretchy="false" xref="S2.F3.10.m5.1.2.cmml">(</mo><mo id="S2.F3.10.m5.1.1" lspace="0em" rspace="0em" xref="S2.F3.10.m5.1.1.cmml">⋅</mo><mo id="S2.F3.10.m5.1.2.3.2.2" stretchy="false" xref="S2.F3.10.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F3.10.m5.1c"><apply id="S2.F3.10.m5.1.2.cmml" xref="S2.F3.10.m5.1.2"><times id="S2.F3.10.m5.1.2.1.cmml" xref="S2.F3.10.m5.1.2.1"></times><ci id="S2.F3.10.m5.1.2.2a.cmml" xref="S2.F3.10.m5.1.2.2"><mtext id="S2.F3.10.m5.1.2.2.cmml" xref="S2.F3.10.m5.1.2.2">MSE</mtext></ci><ci id="S2.F3.10.m5.1.1.cmml" xref="S2.F3.10.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.10.m5.1d">\text{MSE}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.F3.10.m5.1e">MSE ( ⋅ )</annotation></semantics></math> is the mean-square-error function. </figcaption>
</figure>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.26">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S2.F3" title="Figure 3 ‣ 2.1. Binarization ‣ 2. Low-Precision ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">3</span></a>(b), another paradigm is the indirect optimization, where the binary embeddings <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.1"><semantics id="S2.SS1.p4.1.m1.1a"><mi id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><ci id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.1d">bold_B</annotation></semantics></math> are generated from full-precision embeddings <math alttext="\mathbf{E}" class="ltx_Math" display="inline" id="S2.SS1.p4.2.m2.1"><semantics id="S2.SS1.p4.2.m2.1a"><mi id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml">𝐄</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><ci id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1">𝐄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">\mathbf{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m2.1d">bold_E</annotation></semantics></math> on the fly and will be optimized indirectly by optimizing <math alttext="\mathbf{E}" class="ltx_Math" display="inline" id="S2.SS1.p4.3.m3.1"><semantics id="S2.SS1.p4.3.m3.1a"><mi id="S2.SS1.p4.3.m3.1.1" xref="S2.SS1.p4.3.m3.1.1.cmml">𝐄</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m3.1b"><ci id="S2.SS1.p4.3.m3.1.1.cmml" xref="S2.SS1.p4.3.m3.1.1">𝐄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m3.1c">\mathbf{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.3.m3.1d">bold_E</annotation></semantics></math>.
However, it is infeasible to optimize <math alttext="\mathbf{E}" class="ltx_Math" display="inline" id="S2.SS1.p4.4.m4.1"><semantics id="S2.SS1.p4.4.m4.1a"><mi id="S2.SS1.p4.4.m4.1.1" xref="S2.SS1.p4.4.m4.1.1.cmml">𝐄</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m4.1b"><ci id="S2.SS1.p4.4.m4.1.1.cmml" xref="S2.SS1.p4.4.m4.1.1">𝐄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m4.1c">\mathbf{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.4.m4.1d">bold_E</annotation></semantics></math> by the standard gradient descent as the gradients of the binary operations (e.g., <math alttext="sign(x)" class="ltx_Math" display="inline" id="S2.SS1.p4.5.m5.1"><semantics id="S2.SS1.p4.5.m5.1a"><mrow id="S2.SS1.p4.5.m5.1.2" xref="S2.SS1.p4.5.m5.1.2.cmml"><mi id="S2.SS1.p4.5.m5.1.2.2" xref="S2.SS1.p4.5.m5.1.2.2.cmml">s</mi><mo id="S2.SS1.p4.5.m5.1.2.1" xref="S2.SS1.p4.5.m5.1.2.1.cmml">⁢</mo><mi id="S2.SS1.p4.5.m5.1.2.3" xref="S2.SS1.p4.5.m5.1.2.3.cmml">i</mi><mo id="S2.SS1.p4.5.m5.1.2.1a" xref="S2.SS1.p4.5.m5.1.2.1.cmml">⁢</mo><mi id="S2.SS1.p4.5.m5.1.2.4" xref="S2.SS1.p4.5.m5.1.2.4.cmml">g</mi><mo id="S2.SS1.p4.5.m5.1.2.1b" xref="S2.SS1.p4.5.m5.1.2.1.cmml">⁢</mo><mi id="S2.SS1.p4.5.m5.1.2.5" xref="S2.SS1.p4.5.m5.1.2.5.cmml">n</mi><mo id="S2.SS1.p4.5.m5.1.2.1c" xref="S2.SS1.p4.5.m5.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p4.5.m5.1.2.6.2" xref="S2.SS1.p4.5.m5.1.2.cmml"><mo id="S2.SS1.p4.5.m5.1.2.6.2.1" stretchy="false" xref="S2.SS1.p4.5.m5.1.2.cmml">(</mo><mi id="S2.SS1.p4.5.m5.1.1" xref="S2.SS1.p4.5.m5.1.1.cmml">x</mi><mo id="S2.SS1.p4.5.m5.1.2.6.2.2" stretchy="false" xref="S2.SS1.p4.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.5.m5.1b"><apply id="S2.SS1.p4.5.m5.1.2.cmml" xref="S2.SS1.p4.5.m5.1.2"><times id="S2.SS1.p4.5.m5.1.2.1.cmml" xref="S2.SS1.p4.5.m5.1.2.1"></times><ci id="S2.SS1.p4.5.m5.1.2.2.cmml" xref="S2.SS1.p4.5.m5.1.2.2">𝑠</ci><ci id="S2.SS1.p4.5.m5.1.2.3.cmml" xref="S2.SS1.p4.5.m5.1.2.3">𝑖</ci><ci id="S2.SS1.p4.5.m5.1.2.4.cmml" xref="S2.SS1.p4.5.m5.1.2.4">𝑔</ci><ci id="S2.SS1.p4.5.m5.1.2.5.cmml" xref="S2.SS1.p4.5.m5.1.2.5">𝑛</ci><ci id="S2.SS1.p4.5.m5.1.1.cmml" xref="S2.SS1.p4.5.m5.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.5.m5.1c">sign(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.5.m5.1d">italic_s italic_i italic_g italic_n ( italic_x )</annotation></semantics></math>) are constantly zero.
To solve this problem, CIGAR <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib29" title="">2019</a>)</cite> replaces <math alttext="sign(x)" class="ltx_Math" display="inline" id="S2.SS1.p4.6.m6.1"><semantics id="S2.SS1.p4.6.m6.1a"><mrow id="S2.SS1.p4.6.m6.1.2" xref="S2.SS1.p4.6.m6.1.2.cmml"><mi id="S2.SS1.p4.6.m6.1.2.2" xref="S2.SS1.p4.6.m6.1.2.2.cmml">s</mi><mo id="S2.SS1.p4.6.m6.1.2.1" xref="S2.SS1.p4.6.m6.1.2.1.cmml">⁢</mo><mi id="S2.SS1.p4.6.m6.1.2.3" xref="S2.SS1.p4.6.m6.1.2.3.cmml">i</mi><mo id="S2.SS1.p4.6.m6.1.2.1a" xref="S2.SS1.p4.6.m6.1.2.1.cmml">⁢</mo><mi id="S2.SS1.p4.6.m6.1.2.4" xref="S2.SS1.p4.6.m6.1.2.4.cmml">g</mi><mo id="S2.SS1.p4.6.m6.1.2.1b" xref="S2.SS1.p4.6.m6.1.2.1.cmml">⁢</mo><mi id="S2.SS1.p4.6.m6.1.2.5" xref="S2.SS1.p4.6.m6.1.2.5.cmml">n</mi><mo id="S2.SS1.p4.6.m6.1.2.1c" xref="S2.SS1.p4.6.m6.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p4.6.m6.1.2.6.2" xref="S2.SS1.p4.6.m6.1.2.cmml"><mo id="S2.SS1.p4.6.m6.1.2.6.2.1" stretchy="false" xref="S2.SS1.p4.6.m6.1.2.cmml">(</mo><mi id="S2.SS1.p4.6.m6.1.1" xref="S2.SS1.p4.6.m6.1.1.cmml">x</mi><mo id="S2.SS1.p4.6.m6.1.2.6.2.2" stretchy="false" xref="S2.SS1.p4.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.6.m6.1b"><apply id="S2.SS1.p4.6.m6.1.2.cmml" xref="S2.SS1.p4.6.m6.1.2"><times id="S2.SS1.p4.6.m6.1.2.1.cmml" xref="S2.SS1.p4.6.m6.1.2.1"></times><ci id="S2.SS1.p4.6.m6.1.2.2.cmml" xref="S2.SS1.p4.6.m6.1.2.2">𝑠</ci><ci id="S2.SS1.p4.6.m6.1.2.3.cmml" xref="S2.SS1.p4.6.m6.1.2.3">𝑖</ci><ci id="S2.SS1.p4.6.m6.1.2.4.cmml" xref="S2.SS1.p4.6.m6.1.2.4">𝑔</ci><ci id="S2.SS1.p4.6.m6.1.2.5.cmml" xref="S2.SS1.p4.6.m6.1.2.5">𝑛</ci><ci id="S2.SS1.p4.6.m6.1.1.cmml" xref="S2.SS1.p4.6.m6.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.6.m6.1c">sign(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.6.m6.1d">italic_s italic_i italic_g italic_n ( italic_x )</annotation></semantics></math> with the scaled tanh function <math alttext="tanh(\alpha x)" class="ltx_Math" display="inline" id="S2.SS1.p4.7.m7.1"><semantics id="S2.SS1.p4.7.m7.1a"><mrow id="S2.SS1.p4.7.m7.1.1" xref="S2.SS1.p4.7.m7.1.1.cmml"><mi id="S2.SS1.p4.7.m7.1.1.3" xref="S2.SS1.p4.7.m7.1.1.3.cmml">t</mi><mo id="S2.SS1.p4.7.m7.1.1.2" xref="S2.SS1.p4.7.m7.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.7.m7.1.1.4" xref="S2.SS1.p4.7.m7.1.1.4.cmml">a</mi><mo id="S2.SS1.p4.7.m7.1.1.2a" xref="S2.SS1.p4.7.m7.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.7.m7.1.1.5" xref="S2.SS1.p4.7.m7.1.1.5.cmml">n</mi><mo id="S2.SS1.p4.7.m7.1.1.2b" xref="S2.SS1.p4.7.m7.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.7.m7.1.1.6" xref="S2.SS1.p4.7.m7.1.1.6.cmml">h</mi><mo id="S2.SS1.p4.7.m7.1.1.2c" xref="S2.SS1.p4.7.m7.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p4.7.m7.1.1.1.1" xref="S2.SS1.p4.7.m7.1.1.1.1.1.cmml"><mo id="S2.SS1.p4.7.m7.1.1.1.1.2" stretchy="false" xref="S2.SS1.p4.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p4.7.m7.1.1.1.1.1" xref="S2.SS1.p4.7.m7.1.1.1.1.1.cmml"><mi id="S2.SS1.p4.7.m7.1.1.1.1.1.2" xref="S2.SS1.p4.7.m7.1.1.1.1.1.2.cmml">α</mi><mo id="S2.SS1.p4.7.m7.1.1.1.1.1.1" xref="S2.SS1.p4.7.m7.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.7.m7.1.1.1.1.1.3" xref="S2.SS1.p4.7.m7.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.p4.7.m7.1.1.1.1.3" stretchy="false" xref="S2.SS1.p4.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.7.m7.1b"><apply id="S2.SS1.p4.7.m7.1.1.cmml" xref="S2.SS1.p4.7.m7.1.1"><times id="S2.SS1.p4.7.m7.1.1.2.cmml" xref="S2.SS1.p4.7.m7.1.1.2"></times><ci id="S2.SS1.p4.7.m7.1.1.3.cmml" xref="S2.SS1.p4.7.m7.1.1.3">𝑡</ci><ci id="S2.SS1.p4.7.m7.1.1.4.cmml" xref="S2.SS1.p4.7.m7.1.1.4">𝑎</ci><ci id="S2.SS1.p4.7.m7.1.1.5.cmml" xref="S2.SS1.p4.7.m7.1.1.5">𝑛</ci><ci id="S2.SS1.p4.7.m7.1.1.6.cmml" xref="S2.SS1.p4.7.m7.1.1.6">ℎ</ci><apply id="S2.SS1.p4.7.m7.1.1.1.1.1.cmml" xref="S2.SS1.p4.7.m7.1.1.1.1"><times id="S2.SS1.p4.7.m7.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.7.m7.1.1.1.1.1.1"></times><ci id="S2.SS1.p4.7.m7.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.7.m7.1.1.1.1.1.2">𝛼</ci><ci id="S2.SS1.p4.7.m7.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.7.m7.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.7.m7.1c">tanh(\alpha x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.7.m7.1d">italic_t italic_a italic_n italic_h ( italic_α italic_x )</annotation></semantics></math>
as <math alttext="\lim_{\alpha\to\infty}tanh(\alpha x)=sign(x)" class="ltx_Math" display="inline" id="S2.SS1.p4.8.m8.2"><semantics id="S2.SS1.p4.8.m8.2a"><mrow id="S2.SS1.p4.8.m8.2.2" xref="S2.SS1.p4.8.m8.2.2.cmml"><mrow id="S2.SS1.p4.8.m8.2.2.1" xref="S2.SS1.p4.8.m8.2.2.1.cmml"><msub id="S2.SS1.p4.8.m8.2.2.1.2" xref="S2.SS1.p4.8.m8.2.2.1.2.cmml"><mo id="S2.SS1.p4.8.m8.2.2.1.2.2" xref="S2.SS1.p4.8.m8.2.2.1.2.2.cmml">lim</mo><mrow id="S2.SS1.p4.8.m8.2.2.1.2.3" xref="S2.SS1.p4.8.m8.2.2.1.2.3.cmml"><mi id="S2.SS1.p4.8.m8.2.2.1.2.3.2" xref="S2.SS1.p4.8.m8.2.2.1.2.3.2.cmml">α</mi><mo id="S2.SS1.p4.8.m8.2.2.1.2.3.1" stretchy="false" xref="S2.SS1.p4.8.m8.2.2.1.2.3.1.cmml">→</mo><mi id="S2.SS1.p4.8.m8.2.2.1.2.3.3" mathvariant="normal" xref="S2.SS1.p4.8.m8.2.2.1.2.3.3.cmml">∞</mi></mrow></msub><mrow id="S2.SS1.p4.8.m8.2.2.1.1" xref="S2.SS1.p4.8.m8.2.2.1.1.cmml"><mi id="S2.SS1.p4.8.m8.2.2.1.1.3" xref="S2.SS1.p4.8.m8.2.2.1.1.3.cmml">t</mi><mo id="S2.SS1.p4.8.m8.2.2.1.1.2" xref="S2.SS1.p4.8.m8.2.2.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.8.m8.2.2.1.1.4" xref="S2.SS1.p4.8.m8.2.2.1.1.4.cmml">a</mi><mo id="S2.SS1.p4.8.m8.2.2.1.1.2a" xref="S2.SS1.p4.8.m8.2.2.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.8.m8.2.2.1.1.5" xref="S2.SS1.p4.8.m8.2.2.1.1.5.cmml">n</mi><mo id="S2.SS1.p4.8.m8.2.2.1.1.2b" xref="S2.SS1.p4.8.m8.2.2.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.8.m8.2.2.1.1.6" xref="S2.SS1.p4.8.m8.2.2.1.1.6.cmml">h</mi><mo id="S2.SS1.p4.8.m8.2.2.1.1.2c" xref="S2.SS1.p4.8.m8.2.2.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p4.8.m8.2.2.1.1.1.1" xref="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.cmml"><mo id="S2.SS1.p4.8.m8.2.2.1.1.1.1.2" stretchy="false" xref="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p4.8.m8.2.2.1.1.1.1.1" xref="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.cmml"><mi id="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.2" xref="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.2.cmml">α</mi><mo id="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.1" xref="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.3" xref="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.p4.8.m8.2.2.1.1.1.1.3" stretchy="false" xref="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS1.p4.8.m8.2.2.2" xref="S2.SS1.p4.8.m8.2.2.2.cmml">=</mo><mrow id="S2.SS1.p4.8.m8.2.2.3" xref="S2.SS1.p4.8.m8.2.2.3.cmml"><mi id="S2.SS1.p4.8.m8.2.2.3.2" xref="S2.SS1.p4.8.m8.2.2.3.2.cmml">s</mi><mo id="S2.SS1.p4.8.m8.2.2.3.1" xref="S2.SS1.p4.8.m8.2.2.3.1.cmml">⁢</mo><mi id="S2.SS1.p4.8.m8.2.2.3.3" xref="S2.SS1.p4.8.m8.2.2.3.3.cmml">i</mi><mo id="S2.SS1.p4.8.m8.2.2.3.1a" xref="S2.SS1.p4.8.m8.2.2.3.1.cmml">⁢</mo><mi id="S2.SS1.p4.8.m8.2.2.3.4" xref="S2.SS1.p4.8.m8.2.2.3.4.cmml">g</mi><mo id="S2.SS1.p4.8.m8.2.2.3.1b" xref="S2.SS1.p4.8.m8.2.2.3.1.cmml">⁢</mo><mi id="S2.SS1.p4.8.m8.2.2.3.5" xref="S2.SS1.p4.8.m8.2.2.3.5.cmml">n</mi><mo id="S2.SS1.p4.8.m8.2.2.3.1c" xref="S2.SS1.p4.8.m8.2.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p4.8.m8.2.2.3.6.2" xref="S2.SS1.p4.8.m8.2.2.3.cmml"><mo id="S2.SS1.p4.8.m8.2.2.3.6.2.1" stretchy="false" xref="S2.SS1.p4.8.m8.2.2.3.cmml">(</mo><mi id="S2.SS1.p4.8.m8.1.1" xref="S2.SS1.p4.8.m8.1.1.cmml">x</mi><mo id="S2.SS1.p4.8.m8.2.2.3.6.2.2" stretchy="false" xref="S2.SS1.p4.8.m8.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.8.m8.2b"><apply id="S2.SS1.p4.8.m8.2.2.cmml" xref="S2.SS1.p4.8.m8.2.2"><eq id="S2.SS1.p4.8.m8.2.2.2.cmml" xref="S2.SS1.p4.8.m8.2.2.2"></eq><apply id="S2.SS1.p4.8.m8.2.2.1.cmml" xref="S2.SS1.p4.8.m8.2.2.1"><apply id="S2.SS1.p4.8.m8.2.2.1.2.cmml" xref="S2.SS1.p4.8.m8.2.2.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.8.m8.2.2.1.2.1.cmml" xref="S2.SS1.p4.8.m8.2.2.1.2">subscript</csymbol><limit id="S2.SS1.p4.8.m8.2.2.1.2.2.cmml" xref="S2.SS1.p4.8.m8.2.2.1.2.2"></limit><apply id="S2.SS1.p4.8.m8.2.2.1.2.3.cmml" xref="S2.SS1.p4.8.m8.2.2.1.2.3"><ci id="S2.SS1.p4.8.m8.2.2.1.2.3.1.cmml" xref="S2.SS1.p4.8.m8.2.2.1.2.3.1">→</ci><ci id="S2.SS1.p4.8.m8.2.2.1.2.3.2.cmml" xref="S2.SS1.p4.8.m8.2.2.1.2.3.2">𝛼</ci><infinity id="S2.SS1.p4.8.m8.2.2.1.2.3.3.cmml" xref="S2.SS1.p4.8.m8.2.2.1.2.3.3"></infinity></apply></apply><apply id="S2.SS1.p4.8.m8.2.2.1.1.cmml" xref="S2.SS1.p4.8.m8.2.2.1.1"><times id="S2.SS1.p4.8.m8.2.2.1.1.2.cmml" xref="S2.SS1.p4.8.m8.2.2.1.1.2"></times><ci id="S2.SS1.p4.8.m8.2.2.1.1.3.cmml" xref="S2.SS1.p4.8.m8.2.2.1.1.3">𝑡</ci><ci id="S2.SS1.p4.8.m8.2.2.1.1.4.cmml" xref="S2.SS1.p4.8.m8.2.2.1.1.4">𝑎</ci><ci id="S2.SS1.p4.8.m8.2.2.1.1.5.cmml" xref="S2.SS1.p4.8.m8.2.2.1.1.5">𝑛</ci><ci id="S2.SS1.p4.8.m8.2.2.1.1.6.cmml" xref="S2.SS1.p4.8.m8.2.2.1.1.6">ℎ</ci><apply id="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p4.8.m8.2.2.1.1.1.1"><times id="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.1"></times><ci id="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.2">𝛼</ci><ci id="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.8.m8.2.2.1.1.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S2.SS1.p4.8.m8.2.2.3.cmml" xref="S2.SS1.p4.8.m8.2.2.3"><times id="S2.SS1.p4.8.m8.2.2.3.1.cmml" xref="S2.SS1.p4.8.m8.2.2.3.1"></times><ci id="S2.SS1.p4.8.m8.2.2.3.2.cmml" xref="S2.SS1.p4.8.m8.2.2.3.2">𝑠</ci><ci id="S2.SS1.p4.8.m8.2.2.3.3.cmml" xref="S2.SS1.p4.8.m8.2.2.3.3">𝑖</ci><ci id="S2.SS1.p4.8.m8.2.2.3.4.cmml" xref="S2.SS1.p4.8.m8.2.2.3.4">𝑔</ci><ci id="S2.SS1.p4.8.m8.2.2.3.5.cmml" xref="S2.SS1.p4.8.m8.2.2.3.5">𝑛</ci><ci id="S2.SS1.p4.8.m8.1.1.cmml" xref="S2.SS1.p4.8.m8.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.8.m8.2c">\lim_{\alpha\to\infty}tanh(\alpha x)=sign(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.8.m8.2d">roman_lim start_POSTSUBSCRIPT italic_α → ∞ end_POSTSUBSCRIPT italic_t italic_a italic_n italic_h ( italic_α italic_x ) = italic_s italic_i italic_g italic_n ( italic_x )</annotation></semantics></math> and <math alttext="tanh(\alpha x)" class="ltx_Math" display="inline" id="S2.SS1.p4.9.m9.1"><semantics id="S2.SS1.p4.9.m9.1a"><mrow id="S2.SS1.p4.9.m9.1.1" xref="S2.SS1.p4.9.m9.1.1.cmml"><mi id="S2.SS1.p4.9.m9.1.1.3" xref="S2.SS1.p4.9.m9.1.1.3.cmml">t</mi><mo id="S2.SS1.p4.9.m9.1.1.2" xref="S2.SS1.p4.9.m9.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.9.m9.1.1.4" xref="S2.SS1.p4.9.m9.1.1.4.cmml">a</mi><mo id="S2.SS1.p4.9.m9.1.1.2a" xref="S2.SS1.p4.9.m9.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.9.m9.1.1.5" xref="S2.SS1.p4.9.m9.1.1.5.cmml">n</mi><mo id="S2.SS1.p4.9.m9.1.1.2b" xref="S2.SS1.p4.9.m9.1.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.9.m9.1.1.6" xref="S2.SS1.p4.9.m9.1.1.6.cmml">h</mi><mo id="S2.SS1.p4.9.m9.1.1.2c" xref="S2.SS1.p4.9.m9.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p4.9.m9.1.1.1.1" xref="S2.SS1.p4.9.m9.1.1.1.1.1.cmml"><mo id="S2.SS1.p4.9.m9.1.1.1.1.2" stretchy="false" xref="S2.SS1.p4.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p4.9.m9.1.1.1.1.1" xref="S2.SS1.p4.9.m9.1.1.1.1.1.cmml"><mi id="S2.SS1.p4.9.m9.1.1.1.1.1.2" xref="S2.SS1.p4.9.m9.1.1.1.1.1.2.cmml">α</mi><mo id="S2.SS1.p4.9.m9.1.1.1.1.1.1" xref="S2.SS1.p4.9.m9.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.9.m9.1.1.1.1.1.3" xref="S2.SS1.p4.9.m9.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.p4.9.m9.1.1.1.1.3" stretchy="false" xref="S2.SS1.p4.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.9.m9.1b"><apply id="S2.SS1.p4.9.m9.1.1.cmml" xref="S2.SS1.p4.9.m9.1.1"><times id="S2.SS1.p4.9.m9.1.1.2.cmml" xref="S2.SS1.p4.9.m9.1.1.2"></times><ci id="S2.SS1.p4.9.m9.1.1.3.cmml" xref="S2.SS1.p4.9.m9.1.1.3">𝑡</ci><ci id="S2.SS1.p4.9.m9.1.1.4.cmml" xref="S2.SS1.p4.9.m9.1.1.4">𝑎</ci><ci id="S2.SS1.p4.9.m9.1.1.5.cmml" xref="S2.SS1.p4.9.m9.1.1.5">𝑛</ci><ci id="S2.SS1.p4.9.m9.1.1.6.cmml" xref="S2.SS1.p4.9.m9.1.1.6">ℎ</ci><apply id="S2.SS1.p4.9.m9.1.1.1.1.1.cmml" xref="S2.SS1.p4.9.m9.1.1.1.1"><times id="S2.SS1.p4.9.m9.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.9.m9.1.1.1.1.1.1"></times><ci id="S2.SS1.p4.9.m9.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.9.m9.1.1.1.1.1.2">𝛼</ci><ci id="S2.SS1.p4.9.m9.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.9.m9.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.9.m9.1c">tanh(\alpha x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.9.m9.1d">italic_t italic_a italic_n italic_h ( italic_α italic_x )</annotation></semantics></math> has better differential property.
In the early stages of training, a smaller value of <math alttext="\alpha" class="ltx_Math" display="inline" id="S2.SS1.p4.10.m10.1"><semantics id="S2.SS1.p4.10.m10.1a"><mi id="S2.SS1.p4.10.m10.1.1" xref="S2.SS1.p4.10.m10.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.10.m10.1b"><ci id="S2.SS1.p4.10.m10.1.1.cmml" xref="S2.SS1.p4.10.m10.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.10.m10.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.10.m10.1d">italic_α</annotation></semantics></math> is utilized to yield superior representations, and as the training progresses, its value gradually increases to approximate <math alttext="sign()" class="ltx_Math" display="inline" id="S2.SS1.p4.11.m11.1"><semantics id="S2.SS1.p4.11.m11.1a"><mrow id="S2.SS1.p4.11.m11.1.1" xref="S2.SS1.p4.11.m11.1.1.cmml"><mi id="S2.SS1.p4.11.m11.1.1.2" xref="S2.SS1.p4.11.m11.1.1.2.cmml">s</mi><mo id="S2.SS1.p4.11.m11.1.1.1" xref="S2.SS1.p4.11.m11.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.11.m11.1.1.3" xref="S2.SS1.p4.11.m11.1.1.3.cmml">i</mi><mo id="S2.SS1.p4.11.m11.1.1.1a" xref="S2.SS1.p4.11.m11.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.11.m11.1.1.4" xref="S2.SS1.p4.11.m11.1.1.4.cmml">g</mi><mo id="S2.SS1.p4.11.m11.1.1.1b" xref="S2.SS1.p4.11.m11.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.11.m11.1.1.5" xref="S2.SS1.p4.11.m11.1.1.5.cmml">n</mi><mo id="S2.SS1.p4.11.m11.1.1.1c" xref="S2.SS1.p4.11.m11.1.1.1.cmml">⁢</mo><mrow id="S2.SS1.p4.11.m11.1.1.6.2" xref="S2.SS1.p4.11.m11.1.1.cmml"><mo id="S2.SS1.p4.11.m11.1.1.6.2.1" stretchy="false" xref="S2.SS1.p4.11.m11.1.1.6.1.cmml">(</mo><mo id="S2.SS1.p4.11.m11.1.1.6.2.2" stretchy="false" xref="S2.SS1.p4.11.m11.1.1.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.11.m11.1b"><apply id="S2.SS1.p4.11.m11.1.1.cmml" xref="S2.SS1.p4.11.m11.1.1"><times id="S2.SS1.p4.11.m11.1.1.1.cmml" xref="S2.SS1.p4.11.m11.1.1.1"></times><ci id="S2.SS1.p4.11.m11.1.1.2.cmml" xref="S2.SS1.p4.11.m11.1.1.2">𝑠</ci><ci id="S2.SS1.p4.11.m11.1.1.3.cmml" xref="S2.SS1.p4.11.m11.1.1.3">𝑖</ci><ci id="S2.SS1.p4.11.m11.1.1.4.cmml" xref="S2.SS1.p4.11.m11.1.1.4">𝑔</ci><ci id="S2.SS1.p4.11.m11.1.1.5.cmml" xref="S2.SS1.p4.11.m11.1.1.5">𝑛</ci><list id="S2.SS1.p4.11.m11.1.1.6.1.cmml" xref="S2.SS1.p4.11.m11.1.1.6.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.11.m11.1c">sign()</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.11.m11.1d">italic_s italic_i italic_g italic_n ( )</annotation></semantics></math>.
Another way to solve the non-propagable gradient is straight-through-estimator (STE) <cite class="ltx_cite ltx_citemacro_citep">(Courbariaux et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib10" title="">2015</a>)</cite>, which treats some operations as identity maps during backpropagation. HashGNN <cite class="ltx_cite ltx_citemacro_citep">(Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib55" title="">2020</a>)</cite> employs the STE variant of <math alttext="sign()" class="ltx_Math" display="inline" id="S2.SS1.p4.12.m12.1"><semantics id="S2.SS1.p4.12.m12.1a"><mrow id="S2.SS1.p4.12.m12.1.1" xref="S2.SS1.p4.12.m12.1.1.cmml"><mi id="S2.SS1.p4.12.m12.1.1.2" xref="S2.SS1.p4.12.m12.1.1.2.cmml">s</mi><mo id="S2.SS1.p4.12.m12.1.1.1" xref="S2.SS1.p4.12.m12.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.12.m12.1.1.3" xref="S2.SS1.p4.12.m12.1.1.3.cmml">i</mi><mo id="S2.SS1.p4.12.m12.1.1.1a" xref="S2.SS1.p4.12.m12.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.12.m12.1.1.4" xref="S2.SS1.p4.12.m12.1.1.4.cmml">g</mi><mo id="S2.SS1.p4.12.m12.1.1.1b" xref="S2.SS1.p4.12.m12.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p4.12.m12.1.1.5" xref="S2.SS1.p4.12.m12.1.1.5.cmml">n</mi><mo id="S2.SS1.p4.12.m12.1.1.1c" xref="S2.SS1.p4.12.m12.1.1.1.cmml">⁢</mo><mrow id="S2.SS1.p4.12.m12.1.1.6.2" xref="S2.SS1.p4.12.m12.1.1.cmml"><mo id="S2.SS1.p4.12.m12.1.1.6.2.1" stretchy="false" xref="S2.SS1.p4.12.m12.1.1.6.1.cmml">(</mo><mo id="S2.SS1.p4.12.m12.1.1.6.2.2" stretchy="false" xref="S2.SS1.p4.12.m12.1.1.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.12.m12.1b"><apply id="S2.SS1.p4.12.m12.1.1.cmml" xref="S2.SS1.p4.12.m12.1.1"><times id="S2.SS1.p4.12.m12.1.1.1.cmml" xref="S2.SS1.p4.12.m12.1.1.1"></times><ci id="S2.SS1.p4.12.m12.1.1.2.cmml" xref="S2.SS1.p4.12.m12.1.1.2">𝑠</ci><ci id="S2.SS1.p4.12.m12.1.1.3.cmml" xref="S2.SS1.p4.12.m12.1.1.3">𝑖</ci><ci id="S2.SS1.p4.12.m12.1.1.4.cmml" xref="S2.SS1.p4.12.m12.1.1.4">𝑔</ci><ci id="S2.SS1.p4.12.m12.1.1.5.cmml" xref="S2.SS1.p4.12.m12.1.1.5">𝑛</ci><list id="S2.SS1.p4.12.m12.1.1.6.1.cmml" xref="S2.SS1.p4.12.m12.1.1.6.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.12.m12.1c">sign()</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.12.m12.1d">italic_s italic_i italic_g italic_n ( )</annotation></semantics></math> and thus updating <math alttext="\mathbf{E}" class="ltx_Math" display="inline" id="S2.SS1.p4.13.m13.1"><semantics id="S2.SS1.p4.13.m13.1a"><mi id="S2.SS1.p4.13.m13.1.1" xref="S2.SS1.p4.13.m13.1.1.cmml">𝐄</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.13.m13.1b"><ci id="S2.SS1.p4.13.m13.1.1.cmml" xref="S2.SS1.p4.13.m13.1.1">𝐄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.13.m13.1c">\mathbf{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.13.m13.1d">bold_E</annotation></semantics></math> with the gradients of <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="S2.SS1.p4.14.m14.1"><semantics id="S2.SS1.p4.14.m14.1a"><mi id="S2.SS1.p4.14.m14.1.1" xref="S2.SS1.p4.14.m14.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.14.m14.1b"><ci id="S2.SS1.p4.14.m14.1.1.cmml" xref="S2.SS1.p4.14.m14.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.14.m14.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.14.m14.1d">bold_B</annotation></semantics></math>.
However, the huge gap between <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="S2.SS1.p4.15.m15.1"><semantics id="S2.SS1.p4.15.m15.1a"><mi id="S2.SS1.p4.15.m15.1.1" xref="S2.SS1.p4.15.m15.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.15.m15.1b"><ci id="S2.SS1.p4.15.m15.1.1.cmml" xref="S2.SS1.p4.15.m15.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.15.m15.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.15.m15.1d">bold_B</annotation></semantics></math> and <math alttext="\mathbf{E}" class="ltx_Math" display="inline" id="S2.SS1.p4.16.m16.1"><semantics id="S2.SS1.p4.16.m16.1a"><mi id="S2.SS1.p4.16.m16.1.1" xref="S2.SS1.p4.16.m16.1.1.cmml">𝐄</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.16.m16.1b"><ci id="S2.SS1.p4.16.m16.1.1.cmml" xref="S2.SS1.p4.16.m16.1.1">𝐄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.16.m16.1c">\mathbf{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.16.m16.1d">bold_E</annotation></semantics></math> will cause an imprecise update for <math alttext="\mathbf{E}" class="ltx_Math" display="inline" id="S2.SS1.p4.17.m17.1"><semantics id="S2.SS1.p4.17.m17.1a"><mi id="S2.SS1.p4.17.m17.1.1" xref="S2.SS1.p4.17.m17.1.1.cmml">𝐄</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.17.m17.1b"><ci id="S2.SS1.p4.17.m17.1.1.cmml" xref="S2.SS1.p4.17.m17.1.1">𝐄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.17.m17.1c">\mathbf{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.17.m17.1d">bold_E</annotation></semantics></math>.
To solve this issue, HashGNN further develops a dropout-based binarization.
Specifically, <math alttext="\hat{{\mathbf{E}}}=(1-\mathbf{P})\odot\mathbf{E}+\mathbf{P}\odot\mathbf{B}" class="ltx_Math" display="inline" id="S2.SS1.p4.18.m18.1"><semantics id="S2.SS1.p4.18.m18.1a"><mrow id="S2.SS1.p4.18.m18.1.1" xref="S2.SS1.p4.18.m18.1.1.cmml"><mover accent="true" id="S2.SS1.p4.18.m18.1.1.3" xref="S2.SS1.p4.18.m18.1.1.3.cmml"><mi id="S2.SS1.p4.18.m18.1.1.3.2" xref="S2.SS1.p4.18.m18.1.1.3.2.cmml">𝐄</mi><mo id="S2.SS1.p4.18.m18.1.1.3.1" xref="S2.SS1.p4.18.m18.1.1.3.1.cmml">^</mo></mover><mo id="S2.SS1.p4.18.m18.1.1.2" xref="S2.SS1.p4.18.m18.1.1.2.cmml">=</mo><mrow id="S2.SS1.p4.18.m18.1.1.1" xref="S2.SS1.p4.18.m18.1.1.1.cmml"><mrow id="S2.SS1.p4.18.m18.1.1.1.1" xref="S2.SS1.p4.18.m18.1.1.1.1.cmml"><mrow id="S2.SS1.p4.18.m18.1.1.1.1.1.1" xref="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p4.18.m18.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p4.18.m18.1.1.1.1.1.1.1" xref="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.cmml"><mn id="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.2" xref="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.1" xref="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.3" xref="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.3.cmml">𝐏</mi></mrow><mo id="S2.SS1.p4.18.m18.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS1.p4.18.m18.1.1.1.1.2" rspace="0.222em" xref="S2.SS1.p4.18.m18.1.1.1.1.2.cmml">⊙</mo><mi id="S2.SS1.p4.18.m18.1.1.1.1.3" xref="S2.SS1.p4.18.m18.1.1.1.1.3.cmml">𝐄</mi></mrow><mo id="S2.SS1.p4.18.m18.1.1.1.2" xref="S2.SS1.p4.18.m18.1.1.1.2.cmml">+</mo><mrow id="S2.SS1.p4.18.m18.1.1.1.3" xref="S2.SS1.p4.18.m18.1.1.1.3.cmml"><mi id="S2.SS1.p4.18.m18.1.1.1.3.2" xref="S2.SS1.p4.18.m18.1.1.1.3.2.cmml">𝐏</mi><mo id="S2.SS1.p4.18.m18.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p4.18.m18.1.1.1.3.1.cmml">⊙</mo><mi id="S2.SS1.p4.18.m18.1.1.1.3.3" xref="S2.SS1.p4.18.m18.1.1.1.3.3.cmml">𝐁</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.18.m18.1b"><apply id="S2.SS1.p4.18.m18.1.1.cmml" xref="S2.SS1.p4.18.m18.1.1"><eq id="S2.SS1.p4.18.m18.1.1.2.cmml" xref="S2.SS1.p4.18.m18.1.1.2"></eq><apply id="S2.SS1.p4.18.m18.1.1.3.cmml" xref="S2.SS1.p4.18.m18.1.1.3"><ci id="S2.SS1.p4.18.m18.1.1.3.1.cmml" xref="S2.SS1.p4.18.m18.1.1.3.1">^</ci><ci id="S2.SS1.p4.18.m18.1.1.3.2.cmml" xref="S2.SS1.p4.18.m18.1.1.3.2">𝐄</ci></apply><apply id="S2.SS1.p4.18.m18.1.1.1.cmml" xref="S2.SS1.p4.18.m18.1.1.1"><plus id="S2.SS1.p4.18.m18.1.1.1.2.cmml" xref="S2.SS1.p4.18.m18.1.1.1.2"></plus><apply id="S2.SS1.p4.18.m18.1.1.1.1.cmml" xref="S2.SS1.p4.18.m18.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p4.18.m18.1.1.1.1.2.cmml" xref="S2.SS1.p4.18.m18.1.1.1.1.2">direct-product</csymbol><apply id="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.18.m18.1.1.1.1.1.1"><minus id="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.1"></minus><cn id="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.2">1</cn><ci id="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.18.m18.1.1.1.1.1.1.1.3">𝐏</ci></apply><ci id="S2.SS1.p4.18.m18.1.1.1.1.3.cmml" xref="S2.SS1.p4.18.m18.1.1.1.1.3">𝐄</ci></apply><apply id="S2.SS1.p4.18.m18.1.1.1.3.cmml" xref="S2.SS1.p4.18.m18.1.1.1.3"><csymbol cd="latexml" id="S2.SS1.p4.18.m18.1.1.1.3.1.cmml" xref="S2.SS1.p4.18.m18.1.1.1.3.1">direct-product</csymbol><ci id="S2.SS1.p4.18.m18.1.1.1.3.2.cmml" xref="S2.SS1.p4.18.m18.1.1.1.3.2">𝐏</ci><ci id="S2.SS1.p4.18.m18.1.1.1.3.3.cmml" xref="S2.SS1.p4.18.m18.1.1.1.3.3">𝐁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.18.m18.1c">\hat{{\mathbf{E}}}=(1-\mathbf{P})\odot\mathbf{E}+\mathbf{P}\odot\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.18.m18.1d">over^ start_ARG bold_E end_ARG = ( 1 - bold_P ) ⊙ bold_E + bold_P ⊙ bold_B</annotation></semantics></math> will be fed into the following networks,
where <math alttext="\mathbf{P}\in\{0,1\}^{n\times d}" class="ltx_Math" display="inline" id="S2.SS1.p4.19.m19.2"><semantics id="S2.SS1.p4.19.m19.2a"><mrow id="S2.SS1.p4.19.m19.2.3" xref="S2.SS1.p4.19.m19.2.3.cmml"><mi id="S2.SS1.p4.19.m19.2.3.2" xref="S2.SS1.p4.19.m19.2.3.2.cmml">𝐏</mi><mo id="S2.SS1.p4.19.m19.2.3.1" xref="S2.SS1.p4.19.m19.2.3.1.cmml">∈</mo><msup id="S2.SS1.p4.19.m19.2.3.3" xref="S2.SS1.p4.19.m19.2.3.3.cmml"><mrow id="S2.SS1.p4.19.m19.2.3.3.2.2" xref="S2.SS1.p4.19.m19.2.3.3.2.1.cmml"><mo id="S2.SS1.p4.19.m19.2.3.3.2.2.1" stretchy="false" xref="S2.SS1.p4.19.m19.2.3.3.2.1.cmml">{</mo><mn id="S2.SS1.p4.19.m19.1.1" xref="S2.SS1.p4.19.m19.1.1.cmml">0</mn><mo id="S2.SS1.p4.19.m19.2.3.3.2.2.2" xref="S2.SS1.p4.19.m19.2.3.3.2.1.cmml">,</mo><mn id="S2.SS1.p4.19.m19.2.2" xref="S2.SS1.p4.19.m19.2.2.cmml">1</mn><mo id="S2.SS1.p4.19.m19.2.3.3.2.2.3" stretchy="false" xref="S2.SS1.p4.19.m19.2.3.3.2.1.cmml">}</mo></mrow><mrow id="S2.SS1.p4.19.m19.2.3.3.3" xref="S2.SS1.p4.19.m19.2.3.3.3.cmml"><mi id="S2.SS1.p4.19.m19.2.3.3.3.2" xref="S2.SS1.p4.19.m19.2.3.3.3.2.cmml">n</mi><mo id="S2.SS1.p4.19.m19.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p4.19.m19.2.3.3.3.1.cmml">×</mo><mi id="S2.SS1.p4.19.m19.2.3.3.3.3" xref="S2.SS1.p4.19.m19.2.3.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.19.m19.2b"><apply id="S2.SS1.p4.19.m19.2.3.cmml" xref="S2.SS1.p4.19.m19.2.3"><in id="S2.SS1.p4.19.m19.2.3.1.cmml" xref="S2.SS1.p4.19.m19.2.3.1"></in><ci id="S2.SS1.p4.19.m19.2.3.2.cmml" xref="S2.SS1.p4.19.m19.2.3.2">𝐏</ci><apply id="S2.SS1.p4.19.m19.2.3.3.cmml" xref="S2.SS1.p4.19.m19.2.3.3"><csymbol cd="ambiguous" id="S2.SS1.p4.19.m19.2.3.3.1.cmml" xref="S2.SS1.p4.19.m19.2.3.3">superscript</csymbol><set id="S2.SS1.p4.19.m19.2.3.3.2.1.cmml" xref="S2.SS1.p4.19.m19.2.3.3.2.2"><cn id="S2.SS1.p4.19.m19.1.1.cmml" type="integer" xref="S2.SS1.p4.19.m19.1.1">0</cn><cn id="S2.SS1.p4.19.m19.2.2.cmml" type="integer" xref="S2.SS1.p4.19.m19.2.2">1</cn></set><apply id="S2.SS1.p4.19.m19.2.3.3.3.cmml" xref="S2.SS1.p4.19.m19.2.3.3.3"><times id="S2.SS1.p4.19.m19.2.3.3.3.1.cmml" xref="S2.SS1.p4.19.m19.2.3.3.3.1"></times><ci id="S2.SS1.p4.19.m19.2.3.3.3.2.cmml" xref="S2.SS1.p4.19.m19.2.3.3.3.2">𝑛</ci><ci id="S2.SS1.p4.19.m19.2.3.3.3.3.cmml" xref="S2.SS1.p4.19.m19.2.3.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.19.m19.2c">\mathbf{P}\in\{0,1\}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.19.m19.2d">bold_P ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\odot" class="ltx_Math" display="inline" id="S2.SS1.p4.20.m20.1"><semantics id="S2.SS1.p4.20.m20.1a"><mo id="S2.SS1.p4.20.m20.1.1" xref="S2.SS1.p4.20.m20.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.20.m20.1b"><csymbol cd="latexml" id="S2.SS1.p4.20.m20.1.1.cmml" xref="S2.SS1.p4.20.m20.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.20.m20.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.20.m20.1d">⊙</annotation></semantics></math> is the element-wise product.
Each element in <math alttext="\mathbf{P}" class="ltx_Math" display="inline" id="S2.SS1.p4.21.m21.1"><semantics id="S2.SS1.p4.21.m21.1a"><mi id="S2.SS1.p4.21.m21.1.1" xref="S2.SS1.p4.21.m21.1.1.cmml">𝐏</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.21.m21.1b"><ci id="S2.SS1.p4.21.m21.1.1.cmml" xref="S2.SS1.p4.21.m21.1.1">𝐏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.21.m21.1c">\mathbf{P}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.21.m21.1d">bold_P</annotation></semantics></math> is a Bernoulli random value with probability <math alttext="p" class="ltx_Math" display="inline" id="S2.SS1.p4.22.m22.1"><semantics id="S2.SS1.p4.22.m22.1a"><mi id="S2.SS1.p4.22.m22.1.1" xref="S2.SS1.p4.22.m22.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.22.m22.1b"><ci id="S2.SS1.p4.22.m22.1.1.cmml" xref="S2.SS1.p4.22.m22.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.22.m22.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.22.m22.1d">italic_p</annotation></semantics></math>.
During backpropagation, only the embeddings that are binarized will be updated through STE and the rest will be updated by standard gradient descent.
To ensure convergence, HashGNN adopts a small value for <math alttext="p" class="ltx_Math" display="inline" id="S2.SS1.p4.23.m23.1"><semantics id="S2.SS1.p4.23.m23.1a"><mi id="S2.SS1.p4.23.m23.1.1" xref="S2.SS1.p4.23.m23.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.23.m23.1b"><ci id="S2.SS1.p4.23.m23.1.1.cmml" xref="S2.SS1.p4.23.m23.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.23.m23.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.23.m23.1d">italic_p</annotation></semantics></math> in the initial training phase, gradually increasing it as the training progresses.
Similarly, <span class="ltx_text" id="S2.SS1.p4.24.1">L<sup class="ltx_sup" id="S2.SS1.p4.24.1.1">2</sup>Q-GCN</span> <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib6" title="">2021b</a>)</cite> uses STE to optimize the full-precision embeddings, while introducing a positive scaling factor <math alttext="s=mean(|\bm{e}|)" class="ltx_Math" display="inline" id="S2.SS1.p4.25.m24.2"><semantics id="S2.SS1.p4.25.m24.2a"><mrow id="S2.SS1.p4.25.m24.2.2" xref="S2.SS1.p4.25.m24.2.2.cmml"><mi id="S2.SS1.p4.25.m24.2.2.3" xref="S2.SS1.p4.25.m24.2.2.3.cmml">s</mi><mo id="S2.SS1.p4.25.m24.2.2.2" xref="S2.SS1.p4.25.m24.2.2.2.cmml">=</mo><mrow id="S2.SS1.p4.25.m24.2.2.1" xref="S2.SS1.p4.25.m24.2.2.1.cmml"><mi id="S2.SS1.p4.25.m24.2.2.1.3" xref="S2.SS1.p4.25.m24.2.2.1.3.cmml">m</mi><mo id="S2.SS1.p4.25.m24.2.2.1.2" xref="S2.SS1.p4.25.m24.2.2.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.25.m24.2.2.1.4" xref="S2.SS1.p4.25.m24.2.2.1.4.cmml">e</mi><mo id="S2.SS1.p4.25.m24.2.2.1.2a" xref="S2.SS1.p4.25.m24.2.2.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.25.m24.2.2.1.5" xref="S2.SS1.p4.25.m24.2.2.1.5.cmml">a</mi><mo id="S2.SS1.p4.25.m24.2.2.1.2b" xref="S2.SS1.p4.25.m24.2.2.1.2.cmml">⁢</mo><mi id="S2.SS1.p4.25.m24.2.2.1.6" xref="S2.SS1.p4.25.m24.2.2.1.6.cmml">n</mi><mo id="S2.SS1.p4.25.m24.2.2.1.2c" xref="S2.SS1.p4.25.m24.2.2.1.2.cmml">⁢</mo><mrow id="S2.SS1.p4.25.m24.2.2.1.1.1" xref="S2.SS1.p4.25.m24.2.2.1.cmml"><mo id="S2.SS1.p4.25.m24.2.2.1.1.1.2" stretchy="false" xref="S2.SS1.p4.25.m24.2.2.1.cmml">(</mo><mrow id="S2.SS1.p4.25.m24.2.2.1.1.1.1.2" xref="S2.SS1.p4.25.m24.2.2.1.1.1.1.1.cmml"><mo id="S2.SS1.p4.25.m24.2.2.1.1.1.1.2.1" stretchy="false" xref="S2.SS1.p4.25.m24.2.2.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p4.25.m24.1.1" xref="S2.SS1.p4.25.m24.1.1.cmml">𝒆</mi><mo id="S2.SS1.p4.25.m24.2.2.1.1.1.1.2.2" stretchy="false" xref="S2.SS1.p4.25.m24.2.2.1.1.1.1.1.1.cmml">|</mo></mrow><mo id="S2.SS1.p4.25.m24.2.2.1.1.1.3" stretchy="false" xref="S2.SS1.p4.25.m24.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.25.m24.2b"><apply id="S2.SS1.p4.25.m24.2.2.cmml" xref="S2.SS1.p4.25.m24.2.2"><eq id="S2.SS1.p4.25.m24.2.2.2.cmml" xref="S2.SS1.p4.25.m24.2.2.2"></eq><ci id="S2.SS1.p4.25.m24.2.2.3.cmml" xref="S2.SS1.p4.25.m24.2.2.3">𝑠</ci><apply id="S2.SS1.p4.25.m24.2.2.1.cmml" xref="S2.SS1.p4.25.m24.2.2.1"><times id="S2.SS1.p4.25.m24.2.2.1.2.cmml" xref="S2.SS1.p4.25.m24.2.2.1.2"></times><ci id="S2.SS1.p4.25.m24.2.2.1.3.cmml" xref="S2.SS1.p4.25.m24.2.2.1.3">𝑚</ci><ci id="S2.SS1.p4.25.m24.2.2.1.4.cmml" xref="S2.SS1.p4.25.m24.2.2.1.4">𝑒</ci><ci id="S2.SS1.p4.25.m24.2.2.1.5.cmml" xref="S2.SS1.p4.25.m24.2.2.1.5">𝑎</ci><ci id="S2.SS1.p4.25.m24.2.2.1.6.cmml" xref="S2.SS1.p4.25.m24.2.2.1.6">𝑛</ci><apply id="S2.SS1.p4.25.m24.2.2.1.1.1.1.1.cmml" xref="S2.SS1.p4.25.m24.2.2.1.1.1.1.2"><abs id="S2.SS1.p4.25.m24.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.25.m24.2.2.1.1.1.1.2.1"></abs><ci id="S2.SS1.p4.25.m24.1.1.cmml" xref="S2.SS1.p4.25.m24.1.1">𝒆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.25.m24.2c">s=mean(|\bm{e}|)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.25.m24.2d">italic_s = italic_m italic_e italic_a italic_n ( | bold_italic_e | )</annotation></semantics></math> for each binary embedding to enhance its presentation capability, where <math alttext="\bm{e}" class="ltx_Math" display="inline" id="S2.SS1.p4.26.m25.1"><semantics id="S2.SS1.p4.26.m25.1a"><mi id="S2.SS1.p4.26.m25.1.1" xref="S2.SS1.p4.26.m25.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.26.m25.1b"><ci id="S2.SS1.p4.26.m25.1.1.cmml" xref="S2.SS1.p4.26.m25.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.26.m25.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.26.m25.1d">bold_italic_e</annotation></semantics></math> is the full-precision embedding. The comparison of the above three methods is summarized in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#algorithm1" title="In 2.1. Binarization ‣ 2. Low-Precision ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="algorithm1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm1.18">
<div class="ltx_listingline" id="algorithm1.1.1">
<span class="ltx_text" id="algorithm1.1.1.1"><span class="ltx_text ltx_font_bold" id="algorithm1.1.1.1.1">Input:</span> </span>a full-precision embedding <math alttext="\bm{e}" class="ltx_Math" display="inline" id="algorithm1.1.1.m1.1"><semantics id="algorithm1.1.1.m1.1a"><mi id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.1.1.m1.1d">bold_italic_e</annotation></semantics></math>.
</div>
<div class="ltx_listingline" id="algorithm1.2.2">
<span class="ltx_text" id="algorithm1.2.2.1"><span class="ltx_text ltx_font_bold" id="algorithm1.2.2.1.1">Output:</span> </span>the output embedding <math alttext="\hat{\bm{e}}" class="ltx_Math" display="inline" id="algorithm1.2.2.m1.1"><semantics id="algorithm1.2.2.m1.1a"><mover accent="true" id="algorithm1.2.2.m1.1.1" xref="algorithm1.2.2.m1.1.1.cmml"><mi id="algorithm1.2.2.m1.1.1.2" xref="algorithm1.2.2.m1.1.1.2.cmml">𝒆</mi><mo id="algorithm1.2.2.m1.1.1.1" xref="algorithm1.2.2.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m1.1b"><apply id="algorithm1.2.2.m1.1.1.cmml" xref="algorithm1.2.2.m1.1.1"><ci id="algorithm1.2.2.m1.1.1.1.cmml" xref="algorithm1.2.2.m1.1.1.1">^</ci><ci id="algorithm1.2.2.m1.1.1.2.cmml" xref="algorithm1.2.2.m1.1.1.2">𝒆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m1.1c">\hat{\bm{e}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.2.2.m1.1d">over^ start_ARG bold_italic_e end_ARG</annotation></semantics></math>.
</div>
<div class="ltx_listingline" id="algorithm1.3.3">  <span class="ltx_text ltx_font_typewriter" id="algorithm1.3.3.1">// </span><math alttext="\hat{\bm{e}}" class="ltx_Math" display="inline" id="algorithm1.3.3.m1.1"><semantics id="algorithm1.3.3.m1.1a"><mover accent="true" id="algorithm1.3.3.m1.1.1" xref="algorithm1.3.3.m1.1.1.cmml"><mi id="algorithm1.3.3.m1.1.1.2" xref="algorithm1.3.3.m1.1.1.2.cmml">𝒆</mi><mo id="algorithm1.3.3.m1.1.1.1" xref="algorithm1.3.3.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m1.1b"><apply id="algorithm1.3.3.m1.1.1.cmml" xref="algorithm1.3.3.m1.1.1"><ci id="algorithm1.3.3.m1.1.1.1.cmml" xref="algorithm1.3.3.m1.1.1.1">^</ci><ci id="algorithm1.3.3.m1.1.1.2.cmml" xref="algorithm1.3.3.m1.1.1.2">𝒆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m1.1c">\hat{\bm{e}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.3.3.m1.1d">over^ start_ARG bold_italic_e end_ARG</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm1.3.3.2"> will be fed into following networks.</span>
</div>
<div class="ltx_listingline" id="algorithm1.18.19">
</div>
<div class="ltx_listingline" id="algorithm1.18.20">
</div>
<div class="ltx_listingline" id="algorithm1.4.4">
<span class="ltx_text ltx_font_bold" id="algorithm1.4.4.2">Func</span> <em class="ltx_emph ltx_font_typewriter" id="algorithm1.4.4.1">CIGAR(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="algorithm1.4.4.1.1.1"><math alttext="\bm{e}" class="ltx_Math" display="inline" id="algorithm1.4.4.1.1.1.m1.1"><semantics id="algorithm1.4.4.1.1.1.m1.1a"><mi id="algorithm1.4.4.1.1.1.m1.1.1" xref="algorithm1.4.4.1.1.1.m1.1.1.cmml">𝐞</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.1.1.1.m1.1b"><ci id="algorithm1.4.4.1.1.1.m1.1.1.cmml" xref="algorithm1.4.4.1.1.1.m1.1.1">𝐞</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.1.1.1.m1.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.4.4.1.1.1.m1.1d">bold_italic_e</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="algorithm1.4.4.3">:</span>
</div>
<div class="ltx_listingline" id="algorithm1.5.5">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\hat{\bm{e}}=tanh(\alpha\cdot\bm{e})" class="ltx_Math" display="inline" id="algorithm1.5.5.m1.1"><semantics id="algorithm1.5.5.m1.1a"><mrow id="algorithm1.5.5.m1.1.1" xref="algorithm1.5.5.m1.1.1.cmml"><mover accent="true" id="algorithm1.5.5.m1.1.1.3" xref="algorithm1.5.5.m1.1.1.3.cmml"><mi id="algorithm1.5.5.m1.1.1.3.2" xref="algorithm1.5.5.m1.1.1.3.2.cmml">𝒆</mi><mo id="algorithm1.5.5.m1.1.1.3.1" xref="algorithm1.5.5.m1.1.1.3.1.cmml">^</mo></mover><mo id="algorithm1.5.5.m1.1.1.2" xref="algorithm1.5.5.m1.1.1.2.cmml">=</mo><mrow id="algorithm1.5.5.m1.1.1.1" xref="algorithm1.5.5.m1.1.1.1.cmml"><mi id="algorithm1.5.5.m1.1.1.1.3" xref="algorithm1.5.5.m1.1.1.1.3.cmml">t</mi><mo id="algorithm1.5.5.m1.1.1.1.2" xref="algorithm1.5.5.m1.1.1.1.2.cmml">⁢</mo><mi id="algorithm1.5.5.m1.1.1.1.4" xref="algorithm1.5.5.m1.1.1.1.4.cmml">a</mi><mo id="algorithm1.5.5.m1.1.1.1.2a" xref="algorithm1.5.5.m1.1.1.1.2.cmml">⁢</mo><mi id="algorithm1.5.5.m1.1.1.1.5" xref="algorithm1.5.5.m1.1.1.1.5.cmml">n</mi><mo id="algorithm1.5.5.m1.1.1.1.2b" xref="algorithm1.5.5.m1.1.1.1.2.cmml">⁢</mo><mi id="algorithm1.5.5.m1.1.1.1.6" xref="algorithm1.5.5.m1.1.1.1.6.cmml">h</mi><mo id="algorithm1.5.5.m1.1.1.1.2c" xref="algorithm1.5.5.m1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm1.5.5.m1.1.1.1.1.1" xref="algorithm1.5.5.m1.1.1.1.1.1.1.cmml"><mo id="algorithm1.5.5.m1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.5.5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.5.5.m1.1.1.1.1.1.1" xref="algorithm1.5.5.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.5.5.m1.1.1.1.1.1.1.2" xref="algorithm1.5.5.m1.1.1.1.1.1.1.2.cmml">α</mi><mo id="algorithm1.5.5.m1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="algorithm1.5.5.m1.1.1.1.1.1.1.1.cmml">⋅</mo><mi id="algorithm1.5.5.m1.1.1.1.1.1.1.3" xref="algorithm1.5.5.m1.1.1.1.1.1.1.3.cmml">𝒆</mi></mrow><mo id="algorithm1.5.5.m1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.5.5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m1.1b"><apply id="algorithm1.5.5.m1.1.1.cmml" xref="algorithm1.5.5.m1.1.1"><eq id="algorithm1.5.5.m1.1.1.2.cmml" xref="algorithm1.5.5.m1.1.1.2"></eq><apply id="algorithm1.5.5.m1.1.1.3.cmml" xref="algorithm1.5.5.m1.1.1.3"><ci id="algorithm1.5.5.m1.1.1.3.1.cmml" xref="algorithm1.5.5.m1.1.1.3.1">^</ci><ci id="algorithm1.5.5.m1.1.1.3.2.cmml" xref="algorithm1.5.5.m1.1.1.3.2">𝒆</ci></apply><apply id="algorithm1.5.5.m1.1.1.1.cmml" xref="algorithm1.5.5.m1.1.1.1"><times id="algorithm1.5.5.m1.1.1.1.2.cmml" xref="algorithm1.5.5.m1.1.1.1.2"></times><ci id="algorithm1.5.5.m1.1.1.1.3.cmml" xref="algorithm1.5.5.m1.1.1.1.3">𝑡</ci><ci id="algorithm1.5.5.m1.1.1.1.4.cmml" xref="algorithm1.5.5.m1.1.1.1.4">𝑎</ci><ci id="algorithm1.5.5.m1.1.1.1.5.cmml" xref="algorithm1.5.5.m1.1.1.1.5">𝑛</ci><ci id="algorithm1.5.5.m1.1.1.1.6.cmml" xref="algorithm1.5.5.m1.1.1.1.6">ℎ</ci><apply id="algorithm1.5.5.m1.1.1.1.1.1.1.cmml" xref="algorithm1.5.5.m1.1.1.1.1.1"><ci id="algorithm1.5.5.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.5.5.m1.1.1.1.1.1.1.1">⋅</ci><ci id="algorithm1.5.5.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.5.5.m1.1.1.1.1.1.1.2">𝛼</ci><ci id="algorithm1.5.5.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.5.5.m1.1.1.1.1.1.1.3">𝒆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m1.1c">\hat{\bm{e}}=tanh(\alpha\cdot\bm{e})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.5.5.m1.1d">over^ start_ARG bold_italic_e end_ARG = italic_t italic_a italic_n italic_h ( italic_α ⋅ bold_italic_e )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.6.6">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm1.6.6.1">// </span><math alttext="\alpha" class="ltx_Math" display="inline" id="algorithm1.6.6.m1.1"><semantics id="algorithm1.6.6.m1.1a"><mi id="algorithm1.6.6.m1.1.1" xref="algorithm1.6.6.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.1b"><ci id="algorithm1.6.6.m1.1.1.cmml" xref="algorithm1.6.6.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="algorithm1.6.6.m1.1d">italic_α</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm1.6.6.2"> will increase as training progresses.</span>
</div>
<div class="ltx_listingline" id="algorithm1.18.21">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.7.7">
<span class="ltx_text ltx_font_bold" id="algorithm1.7.7.2">Func</span> <em class="ltx_emph ltx_font_typewriter" id="algorithm1.7.7.1">HashGNN(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="algorithm1.7.7.1.1.1"><math alttext="\bm{e}" class="ltx_Math" display="inline" id="algorithm1.7.7.1.1.1.m1.1"><semantics id="algorithm1.7.7.1.1.1.m1.1a"><mi id="algorithm1.7.7.1.1.1.m1.1.1" xref="algorithm1.7.7.1.1.1.m1.1.1.cmml">𝐞</mi><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.1.1.1.m1.1b"><ci id="algorithm1.7.7.1.1.1.m1.1.1.cmml" xref="algorithm1.7.7.1.1.1.m1.1.1">𝐞</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.1.1.1.m1.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.7.7.1.1.1.m1.1d">bold_italic_e</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="algorithm1.7.7.3">:</span>
</div>
<div class="ltx_listingline" id="algorithm1.8.8">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\bm{b}=sign\_ste(\bm{e})" class="ltx_Math" display="inline" id="algorithm1.8.8.m1.1"><semantics id="algorithm1.8.8.m1.1a"><mrow id="algorithm1.8.8.m1.1.2" xref="algorithm1.8.8.m1.1.2.cmml"><mi id="algorithm1.8.8.m1.1.2.2" xref="algorithm1.8.8.m1.1.2.2.cmml">𝒃</mi><mo id="algorithm1.8.8.m1.1.2.1" xref="algorithm1.8.8.m1.1.2.1.cmml">=</mo><mrow id="algorithm1.8.8.m1.1.2.3" xref="algorithm1.8.8.m1.1.2.3.cmml"><mi id="algorithm1.8.8.m1.1.2.3.2" xref="algorithm1.8.8.m1.1.2.3.2.cmml">s</mi><mo id="algorithm1.8.8.m1.1.2.3.1" xref="algorithm1.8.8.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.1.2.3.3" xref="algorithm1.8.8.m1.1.2.3.3.cmml">i</mi><mo id="algorithm1.8.8.m1.1.2.3.1a" xref="algorithm1.8.8.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.1.2.3.4" xref="algorithm1.8.8.m1.1.2.3.4.cmml">g</mi><mo id="algorithm1.8.8.m1.1.2.3.1b" xref="algorithm1.8.8.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.1.2.3.5" xref="algorithm1.8.8.m1.1.2.3.5.cmml">n</mi><mo id="algorithm1.8.8.m1.1.2.3.1c" xref="algorithm1.8.8.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.1.2.3.6" mathvariant="normal" xref="algorithm1.8.8.m1.1.2.3.6.cmml">_</mi><mo id="algorithm1.8.8.m1.1.2.3.1d" xref="algorithm1.8.8.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.1.2.3.7" xref="algorithm1.8.8.m1.1.2.3.7.cmml">s</mi><mo id="algorithm1.8.8.m1.1.2.3.1e" xref="algorithm1.8.8.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.1.2.3.8" xref="algorithm1.8.8.m1.1.2.3.8.cmml">t</mi><mo id="algorithm1.8.8.m1.1.2.3.1f" xref="algorithm1.8.8.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.1.2.3.9" xref="algorithm1.8.8.m1.1.2.3.9.cmml">e</mi><mo id="algorithm1.8.8.m1.1.2.3.1g" xref="algorithm1.8.8.m1.1.2.3.1.cmml">⁢</mo><mrow id="algorithm1.8.8.m1.1.2.3.10.2" xref="algorithm1.8.8.m1.1.2.3.cmml"><mo id="algorithm1.8.8.m1.1.2.3.10.2.1" stretchy="false" xref="algorithm1.8.8.m1.1.2.3.cmml">(</mo><mi id="algorithm1.8.8.m1.1.1" xref="algorithm1.8.8.m1.1.1.cmml">𝒆</mi><mo id="algorithm1.8.8.m1.1.2.3.10.2.2" stretchy="false" xref="algorithm1.8.8.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m1.1b"><apply id="algorithm1.8.8.m1.1.2.cmml" xref="algorithm1.8.8.m1.1.2"><eq id="algorithm1.8.8.m1.1.2.1.cmml" xref="algorithm1.8.8.m1.1.2.1"></eq><ci id="algorithm1.8.8.m1.1.2.2.cmml" xref="algorithm1.8.8.m1.1.2.2">𝒃</ci><apply id="algorithm1.8.8.m1.1.2.3.cmml" xref="algorithm1.8.8.m1.1.2.3"><times id="algorithm1.8.8.m1.1.2.3.1.cmml" xref="algorithm1.8.8.m1.1.2.3.1"></times><ci id="algorithm1.8.8.m1.1.2.3.2.cmml" xref="algorithm1.8.8.m1.1.2.3.2">𝑠</ci><ci id="algorithm1.8.8.m1.1.2.3.3.cmml" xref="algorithm1.8.8.m1.1.2.3.3">𝑖</ci><ci id="algorithm1.8.8.m1.1.2.3.4.cmml" xref="algorithm1.8.8.m1.1.2.3.4">𝑔</ci><ci id="algorithm1.8.8.m1.1.2.3.5.cmml" xref="algorithm1.8.8.m1.1.2.3.5">𝑛</ci><ci id="algorithm1.8.8.m1.1.2.3.6.cmml" xref="algorithm1.8.8.m1.1.2.3.6">_</ci><ci id="algorithm1.8.8.m1.1.2.3.7.cmml" xref="algorithm1.8.8.m1.1.2.3.7">𝑠</ci><ci id="algorithm1.8.8.m1.1.2.3.8.cmml" xref="algorithm1.8.8.m1.1.2.3.8">𝑡</ci><ci id="algorithm1.8.8.m1.1.2.3.9.cmml" xref="algorithm1.8.8.m1.1.2.3.9">𝑒</ci><ci id="algorithm1.8.8.m1.1.1.cmml" xref="algorithm1.8.8.m1.1.1">𝒆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m1.1c">\bm{b}=sign\_ste(\bm{e})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.8.8.m1.1d">bold_italic_b = italic_s italic_i italic_g italic_n _ italic_s italic_t italic_e ( bold_italic_e )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.10.10">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm1.10.10.2">// </span><math alttext="sign\_ste()" class="ltx_Math" display="inline" id="algorithm1.9.9.m1.1"><semantics id="algorithm1.9.9.m1.1a"><mrow id="algorithm1.9.9.m1.1.1" xref="algorithm1.9.9.m1.1.1.cmml"><mi id="algorithm1.9.9.m1.1.1.2" xref="algorithm1.9.9.m1.1.1.2.cmml">s</mi><mo id="algorithm1.9.9.m1.1.1.1" xref="algorithm1.9.9.m1.1.1.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.1.1.3" xref="algorithm1.9.9.m1.1.1.3.cmml">i</mi><mo id="algorithm1.9.9.m1.1.1.1a" xref="algorithm1.9.9.m1.1.1.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.1.1.4" xref="algorithm1.9.9.m1.1.1.4.cmml">g</mi><mo id="algorithm1.9.9.m1.1.1.1b" xref="algorithm1.9.9.m1.1.1.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.1.1.5" xref="algorithm1.9.9.m1.1.1.5.cmml">n</mi><mo id="algorithm1.9.9.m1.1.1.1c" xref="algorithm1.9.9.m1.1.1.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.1.1.6" mathvariant="normal" xref="algorithm1.9.9.m1.1.1.6.cmml">_</mi><mo id="algorithm1.9.9.m1.1.1.1d" xref="algorithm1.9.9.m1.1.1.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.1.1.7" xref="algorithm1.9.9.m1.1.1.7.cmml">s</mi><mo id="algorithm1.9.9.m1.1.1.1e" xref="algorithm1.9.9.m1.1.1.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.1.1.8" xref="algorithm1.9.9.m1.1.1.8.cmml">t</mi><mo id="algorithm1.9.9.m1.1.1.1f" xref="algorithm1.9.9.m1.1.1.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.1.1.9" xref="algorithm1.9.9.m1.1.1.9.cmml">e</mi><mo id="algorithm1.9.9.m1.1.1.1g" xref="algorithm1.9.9.m1.1.1.1.cmml">⁢</mo><mrow id="algorithm1.9.9.m1.1.1.10.2" xref="algorithm1.9.9.m1.1.1.cmml"><mo id="algorithm1.9.9.m1.1.1.10.2.1" stretchy="false" xref="algorithm1.9.9.m1.1.1.10.1.cmml">(</mo><mo id="algorithm1.9.9.m1.1.1.10.2.2" stretchy="false" xref="algorithm1.9.9.m1.1.1.10.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m1.1b"><apply id="algorithm1.9.9.m1.1.1.cmml" xref="algorithm1.9.9.m1.1.1"><times id="algorithm1.9.9.m1.1.1.1.cmml" xref="algorithm1.9.9.m1.1.1.1"></times><ci id="algorithm1.9.9.m1.1.1.2.cmml" xref="algorithm1.9.9.m1.1.1.2">𝑠</ci><ci id="algorithm1.9.9.m1.1.1.3.cmml" xref="algorithm1.9.9.m1.1.1.3">𝑖</ci><ci id="algorithm1.9.9.m1.1.1.4.cmml" xref="algorithm1.9.9.m1.1.1.4">𝑔</ci><ci id="algorithm1.9.9.m1.1.1.5.cmml" xref="algorithm1.9.9.m1.1.1.5">𝑛</ci><ci id="algorithm1.9.9.m1.1.1.6.cmml" xref="algorithm1.9.9.m1.1.1.6">_</ci><ci id="algorithm1.9.9.m1.1.1.7.cmml" xref="algorithm1.9.9.m1.1.1.7">𝑠</ci><ci id="algorithm1.9.9.m1.1.1.8.cmml" xref="algorithm1.9.9.m1.1.1.8">𝑡</ci><ci id="algorithm1.9.9.m1.1.1.9.cmml" xref="algorithm1.9.9.m1.1.1.9">𝑒</ci><list id="algorithm1.9.9.m1.1.1.10.1.cmml" xref="algorithm1.9.9.m1.1.1.10.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.1c">sign\_ste()</annotation><annotation encoding="application/x-llamapun" id="algorithm1.9.9.m1.1d">italic_s italic_i italic_g italic_n _ italic_s italic_t italic_e ( )</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm1.10.10.1"> is the STE variant of <math alttext="sign()" class="ltx_Math" display="inline" id="algorithm1.10.10.1.m1.1"><semantics id="algorithm1.10.10.1.m1.1a"><mrow id="algorithm1.10.10.1.m1.1.1" xref="algorithm1.10.10.1.m1.1.1.cmml"><mi id="algorithm1.10.10.1.m1.1.1.2" xref="algorithm1.10.10.1.m1.1.1.2.cmml">s</mi><mo id="algorithm1.10.10.1.m1.1.1.1" xref="algorithm1.10.10.1.m1.1.1.1.cmml">⁢</mo><mi id="algorithm1.10.10.1.m1.1.1.3" xref="algorithm1.10.10.1.m1.1.1.3.cmml">i</mi><mo id="algorithm1.10.10.1.m1.1.1.1a" xref="algorithm1.10.10.1.m1.1.1.1.cmml">⁢</mo><mi id="algorithm1.10.10.1.m1.1.1.4" xref="algorithm1.10.10.1.m1.1.1.4.cmml">g</mi><mo id="algorithm1.10.10.1.m1.1.1.1b" xref="algorithm1.10.10.1.m1.1.1.1.cmml">⁢</mo><mi id="algorithm1.10.10.1.m1.1.1.5" xref="algorithm1.10.10.1.m1.1.1.5.cmml">n</mi><mo id="algorithm1.10.10.1.m1.1.1.1c" xref="algorithm1.10.10.1.m1.1.1.1.cmml">⁢</mo><mrow id="algorithm1.10.10.1.m1.1.1.6.2" xref="algorithm1.10.10.1.m1.1.1.cmml"><mo id="algorithm1.10.10.1.m1.1.1.6.2.1" stretchy="false" xref="algorithm1.10.10.1.m1.1.1.6.1.cmml">(</mo><mo id="algorithm1.10.10.1.m1.1.1.6.2.2" stretchy="false" xref="algorithm1.10.10.1.m1.1.1.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.1.m1.1b"><apply id="algorithm1.10.10.1.m1.1.1.cmml" xref="algorithm1.10.10.1.m1.1.1"><times id="algorithm1.10.10.1.m1.1.1.1.cmml" xref="algorithm1.10.10.1.m1.1.1.1"></times><ci id="algorithm1.10.10.1.m1.1.1.2.cmml" xref="algorithm1.10.10.1.m1.1.1.2">𝑠</ci><ci id="algorithm1.10.10.1.m1.1.1.3.cmml" xref="algorithm1.10.10.1.m1.1.1.3">𝑖</ci><ci id="algorithm1.10.10.1.m1.1.1.4.cmml" xref="algorithm1.10.10.1.m1.1.1.4">𝑔</ci><ci id="algorithm1.10.10.1.m1.1.1.5.cmml" xref="algorithm1.10.10.1.m1.1.1.5">𝑛</ci><list id="algorithm1.10.10.1.m1.1.1.6.1.cmml" xref="algorithm1.10.10.1.m1.1.1.6.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.1.m1.1c">sign()</annotation><annotation encoding="application/x-llamapun" id="algorithm1.10.10.1.m1.1d">italic_s italic_i italic_g italic_n ( )</annotation></semantics></math>.</span>
</div>
<div class="ltx_listingline" id="algorithm1.18.22">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.11.11">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\bm{p}:=\{0,1\}^{d}" class="ltx_Math" display="inline" id="algorithm1.11.11.m1.2"><semantics id="algorithm1.11.11.m1.2a"><mrow id="algorithm1.11.11.m1.2.3" xref="algorithm1.11.11.m1.2.3.cmml"><mi id="algorithm1.11.11.m1.2.3.2" xref="algorithm1.11.11.m1.2.3.2.cmml">𝒑</mi><mo id="algorithm1.11.11.m1.2.3.1" lspace="0.278em" rspace="0.278em" xref="algorithm1.11.11.m1.2.3.1.cmml">:=</mo><msup id="algorithm1.11.11.m1.2.3.3" xref="algorithm1.11.11.m1.2.3.3.cmml"><mrow id="algorithm1.11.11.m1.2.3.3.2.2" xref="algorithm1.11.11.m1.2.3.3.2.1.cmml"><mo id="algorithm1.11.11.m1.2.3.3.2.2.1" stretchy="false" xref="algorithm1.11.11.m1.2.3.3.2.1.cmml">{</mo><mn id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml">0</mn><mo id="algorithm1.11.11.m1.2.3.3.2.2.2" xref="algorithm1.11.11.m1.2.3.3.2.1.cmml">,</mo><mn id="algorithm1.11.11.m1.2.2" xref="algorithm1.11.11.m1.2.2.cmml">1</mn><mo id="algorithm1.11.11.m1.2.3.3.2.2.3" stretchy="false" xref="algorithm1.11.11.m1.2.3.3.2.1.cmml">}</mo></mrow><mi id="algorithm1.11.11.m1.2.3.3.3" xref="algorithm1.11.11.m1.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.2b"><apply id="algorithm1.11.11.m1.2.3.cmml" xref="algorithm1.11.11.m1.2.3"><csymbol cd="latexml" id="algorithm1.11.11.m1.2.3.1.cmml" xref="algorithm1.11.11.m1.2.3.1">assign</csymbol><ci id="algorithm1.11.11.m1.2.3.2.cmml" xref="algorithm1.11.11.m1.2.3.2">𝒑</ci><apply id="algorithm1.11.11.m1.2.3.3.cmml" xref="algorithm1.11.11.m1.2.3.3"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.2.3.3.1.cmml" xref="algorithm1.11.11.m1.2.3.3">superscript</csymbol><set id="algorithm1.11.11.m1.2.3.3.2.1.cmml" xref="algorithm1.11.11.m1.2.3.3.2.2"><cn id="algorithm1.11.11.m1.1.1.cmml" type="integer" xref="algorithm1.11.11.m1.1.1">0</cn><cn id="algorithm1.11.11.m1.2.2.cmml" type="integer" xref="algorithm1.11.11.m1.2.2">1</cn></set><ci id="algorithm1.11.11.m1.2.3.3.3.cmml" xref="algorithm1.11.11.m1.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.2c">\bm{p}:=\{0,1\}^{d}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.11.11.m1.2d">bold_italic_p := { 0 , 1 } start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.12.12">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm1.12.12.2">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.12.12.1">sample from Bernoulli distribution with probability <math alttext="p" class="ltx_Math" display="inline" id="algorithm1.12.12.1.m1.1"><semantics id="algorithm1.12.12.1.m1.1a"><mi id="algorithm1.12.12.1.m1.1.1" xref="algorithm1.12.12.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.1.m1.1b"><ci id="algorithm1.12.12.1.m1.1.1.cmml" xref="algorithm1.12.12.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="algorithm1.12.12.1.m1.1d">italic_p</annotation></semantics></math>.</span>
</div>
<div class="ltx_listingline" id="algorithm1.18.23">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.13.13">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\hat{\bm{e}}=(1-\bm{p})\odot\bm{e}+\bm{p}\odot\bm{b}" class="ltx_Math" display="inline" id="algorithm1.13.13.m1.1"><semantics id="algorithm1.13.13.m1.1a"><mrow id="algorithm1.13.13.m1.1.1" xref="algorithm1.13.13.m1.1.1.cmml"><mover accent="true" id="algorithm1.13.13.m1.1.1.3" xref="algorithm1.13.13.m1.1.1.3.cmml"><mi id="algorithm1.13.13.m1.1.1.3.2" xref="algorithm1.13.13.m1.1.1.3.2.cmml">𝒆</mi><mo id="algorithm1.13.13.m1.1.1.3.1" xref="algorithm1.13.13.m1.1.1.3.1.cmml">^</mo></mover><mo id="algorithm1.13.13.m1.1.1.2" xref="algorithm1.13.13.m1.1.1.2.cmml">=</mo><mrow id="algorithm1.13.13.m1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.cmml"><mrow id="algorithm1.13.13.m1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.cmml"><mrow id="algorithm1.13.13.m1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.cmml"><mo id="algorithm1.13.13.m1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.13.13.m1.1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.cmml"><mn id="algorithm1.13.13.m1.1.1.1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="algorithm1.13.13.m1.1.1.1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.3.cmml">𝒑</mi></mrow><mo id="algorithm1.13.13.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="algorithm1.13.13.m1.1.1.1.1.2" rspace="0.222em" xref="algorithm1.13.13.m1.1.1.1.1.2.cmml">⊙</mo><mi id="algorithm1.13.13.m1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.3.cmml">𝒆</mi></mrow><mo id="algorithm1.13.13.m1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.2.cmml">+</mo><mrow id="algorithm1.13.13.m1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.3.cmml"><mi id="algorithm1.13.13.m1.1.1.1.3.2" xref="algorithm1.13.13.m1.1.1.1.3.2.cmml">𝒑</mi><mo id="algorithm1.13.13.m1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algorithm1.13.13.m1.1.1.1.3.1.cmml">⊙</mo><mi id="algorithm1.13.13.m1.1.1.1.3.3" xref="algorithm1.13.13.m1.1.1.1.3.3.cmml">𝒃</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><eq id="algorithm1.13.13.m1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.2"></eq><apply id="algorithm1.13.13.m1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.3"><ci id="algorithm1.13.13.m1.1.1.3.1.cmml" xref="algorithm1.13.13.m1.1.1.3.1">^</ci><ci id="algorithm1.13.13.m1.1.1.3.2.cmml" xref="algorithm1.13.13.m1.1.1.3.2">𝒆</ci></apply><apply id="algorithm1.13.13.m1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1"><plus id="algorithm1.13.13.m1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.2"></plus><apply id="algorithm1.13.13.m1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1"><csymbol cd="latexml" id="algorithm1.13.13.m1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.2">direct-product</csymbol><apply id="algorithm1.13.13.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1"><minus id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1"></minus><cn id="algorithm1.13.13.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.2">1</cn><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.3">𝒑</ci></apply><ci id="algorithm1.13.13.m1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3">𝒆</ci></apply><apply id="algorithm1.13.13.m1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.3"><csymbol cd="latexml" id="algorithm1.13.13.m1.1.1.1.3.1.cmml" xref="algorithm1.13.13.m1.1.1.1.3.1">direct-product</csymbol><ci id="algorithm1.13.13.m1.1.1.1.3.2.cmml" xref="algorithm1.13.13.m1.1.1.1.3.2">𝒑</ci><ci id="algorithm1.13.13.m1.1.1.1.3.3.cmml" xref="algorithm1.13.13.m1.1.1.1.3.3">𝒃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">\hat{\bm{e}}=(1-\bm{p})\odot\bm{e}+\bm{p}\odot\bm{b}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.13.13.m1.1d">over^ start_ARG bold_italic_e end_ARG = ( 1 - bold_italic_p ) ⊙ bold_italic_e + bold_italic_p ⊙ bold_italic_b</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.14.14">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm1.14.14.1">// </span><math alttext="p" class="ltx_Math" display="inline" id="algorithm1.14.14.m1.1"><semantics id="algorithm1.14.14.m1.1a"><mi id="algorithm1.14.14.m1.1.1" xref="algorithm1.14.14.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m1.1b"><ci id="algorithm1.14.14.m1.1.1.cmml" xref="algorithm1.14.14.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="algorithm1.14.14.m1.1d">italic_p</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm1.14.14.2"> will increase as training progresses.</span>
</div>
<div class="ltx_listingline" id="algorithm1.18.24">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.16.16">
<span class="ltx_text ltx_font_bold" id="algorithm1.16.16.3">Func</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.16.16.2"><span class="ltx_text ltx_font_typewriter ltx_font_upright" id="algorithm1.15.15.1.1">L<sup class="ltx_sup" id="algorithm1.15.15.1.1.1"><span class="ltx_text ltx_font_serif" id="algorithm1.15.15.1.1.1.1">2</span></sup>Q-GCN</span><span class="ltx_text ltx_font_typewriter ltx_font_upright" id="algorithm1.16.16.2.2">(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="algorithm1.16.16.2.2.1"><math alttext="\bm{e}" class="ltx_Math" display="inline" id="algorithm1.16.16.2.2.1.m1.1"><semantics id="algorithm1.16.16.2.2.1.m1.1a"><mi id="algorithm1.16.16.2.2.1.m1.1.1" xref="algorithm1.16.16.2.2.1.m1.1.1.cmml">𝐞</mi><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.2.2.1.m1.1b"><ci id="algorithm1.16.16.2.2.1.m1.1.1.cmml" xref="algorithm1.16.16.2.2.1.m1.1.1">𝐞</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.2.2.1.m1.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.16.16.2.2.1.m1.1d">bold_italic_e</annotation></semantics></math></em>)</span></em><span class="ltx_text ltx_font_bold" id="algorithm1.16.16.4">:</span>
</div>
<div class="ltx_listingline" id="algorithm1.17.17">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\bm{b}=sign\_ste(\bm{e})" class="ltx_Math" display="inline" id="algorithm1.17.17.m1.1"><semantics id="algorithm1.17.17.m1.1a"><mrow id="algorithm1.17.17.m1.1.2" xref="algorithm1.17.17.m1.1.2.cmml"><mi id="algorithm1.17.17.m1.1.2.2" xref="algorithm1.17.17.m1.1.2.2.cmml">𝒃</mi><mo id="algorithm1.17.17.m1.1.2.1" xref="algorithm1.17.17.m1.1.2.1.cmml">=</mo><mrow id="algorithm1.17.17.m1.1.2.3" xref="algorithm1.17.17.m1.1.2.3.cmml"><mi id="algorithm1.17.17.m1.1.2.3.2" xref="algorithm1.17.17.m1.1.2.3.2.cmml">s</mi><mo id="algorithm1.17.17.m1.1.2.3.1" xref="algorithm1.17.17.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.17.17.m1.1.2.3.3" xref="algorithm1.17.17.m1.1.2.3.3.cmml">i</mi><mo id="algorithm1.17.17.m1.1.2.3.1a" xref="algorithm1.17.17.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.17.17.m1.1.2.3.4" xref="algorithm1.17.17.m1.1.2.3.4.cmml">g</mi><mo id="algorithm1.17.17.m1.1.2.3.1b" xref="algorithm1.17.17.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.17.17.m1.1.2.3.5" xref="algorithm1.17.17.m1.1.2.3.5.cmml">n</mi><mo id="algorithm1.17.17.m1.1.2.3.1c" xref="algorithm1.17.17.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.17.17.m1.1.2.3.6" mathvariant="normal" xref="algorithm1.17.17.m1.1.2.3.6.cmml">_</mi><mo id="algorithm1.17.17.m1.1.2.3.1d" xref="algorithm1.17.17.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.17.17.m1.1.2.3.7" xref="algorithm1.17.17.m1.1.2.3.7.cmml">s</mi><mo id="algorithm1.17.17.m1.1.2.3.1e" xref="algorithm1.17.17.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.17.17.m1.1.2.3.8" xref="algorithm1.17.17.m1.1.2.3.8.cmml">t</mi><mo id="algorithm1.17.17.m1.1.2.3.1f" xref="algorithm1.17.17.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.17.17.m1.1.2.3.9" xref="algorithm1.17.17.m1.1.2.3.9.cmml">e</mi><mo id="algorithm1.17.17.m1.1.2.3.1g" xref="algorithm1.17.17.m1.1.2.3.1.cmml">⁢</mo><mrow id="algorithm1.17.17.m1.1.2.3.10.2" xref="algorithm1.17.17.m1.1.2.3.cmml"><mo id="algorithm1.17.17.m1.1.2.3.10.2.1" stretchy="false" xref="algorithm1.17.17.m1.1.2.3.cmml">(</mo><mi id="algorithm1.17.17.m1.1.1" xref="algorithm1.17.17.m1.1.1.cmml">𝒆</mi><mo id="algorithm1.17.17.m1.1.2.3.10.2.2" stretchy="false" xref="algorithm1.17.17.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m1.1b"><apply id="algorithm1.17.17.m1.1.2.cmml" xref="algorithm1.17.17.m1.1.2"><eq id="algorithm1.17.17.m1.1.2.1.cmml" xref="algorithm1.17.17.m1.1.2.1"></eq><ci id="algorithm1.17.17.m1.1.2.2.cmml" xref="algorithm1.17.17.m1.1.2.2">𝒃</ci><apply id="algorithm1.17.17.m1.1.2.3.cmml" xref="algorithm1.17.17.m1.1.2.3"><times id="algorithm1.17.17.m1.1.2.3.1.cmml" xref="algorithm1.17.17.m1.1.2.3.1"></times><ci id="algorithm1.17.17.m1.1.2.3.2.cmml" xref="algorithm1.17.17.m1.1.2.3.2">𝑠</ci><ci id="algorithm1.17.17.m1.1.2.3.3.cmml" xref="algorithm1.17.17.m1.1.2.3.3">𝑖</ci><ci id="algorithm1.17.17.m1.1.2.3.4.cmml" xref="algorithm1.17.17.m1.1.2.3.4">𝑔</ci><ci id="algorithm1.17.17.m1.1.2.3.5.cmml" xref="algorithm1.17.17.m1.1.2.3.5">𝑛</ci><ci id="algorithm1.17.17.m1.1.2.3.6.cmml" xref="algorithm1.17.17.m1.1.2.3.6">_</ci><ci id="algorithm1.17.17.m1.1.2.3.7.cmml" xref="algorithm1.17.17.m1.1.2.3.7">𝑠</ci><ci id="algorithm1.17.17.m1.1.2.3.8.cmml" xref="algorithm1.17.17.m1.1.2.3.8">𝑡</ci><ci id="algorithm1.17.17.m1.1.2.3.9.cmml" xref="algorithm1.17.17.m1.1.2.3.9">𝑒</ci><ci id="algorithm1.17.17.m1.1.1.cmml" xref="algorithm1.17.17.m1.1.1">𝒆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m1.1c">\bm{b}=sign\_ste(\bm{e})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.17.17.m1.1d">bold_italic_b = italic_s italic_i italic_g italic_n _ italic_s italic_t italic_e ( bold_italic_e )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.18.18">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\hat{\bm{e}}=mean(|\bm{e}|)\cdot\bm{b}" class="ltx_Math" display="inline" id="algorithm1.18.18.m1.2"><semantics id="algorithm1.18.18.m1.2a"><mrow id="algorithm1.18.18.m1.2.2" xref="algorithm1.18.18.m1.2.2.cmml"><mover accent="true" id="algorithm1.18.18.m1.2.2.3" xref="algorithm1.18.18.m1.2.2.3.cmml"><mi id="algorithm1.18.18.m1.2.2.3.2" xref="algorithm1.18.18.m1.2.2.3.2.cmml">𝒆</mi><mo id="algorithm1.18.18.m1.2.2.3.1" xref="algorithm1.18.18.m1.2.2.3.1.cmml">^</mo></mover><mo id="algorithm1.18.18.m1.2.2.2" xref="algorithm1.18.18.m1.2.2.2.cmml">=</mo><mrow id="algorithm1.18.18.m1.2.2.1" xref="algorithm1.18.18.m1.2.2.1.cmml"><mrow id="algorithm1.18.18.m1.2.2.1.1" xref="algorithm1.18.18.m1.2.2.1.1.cmml"><mi id="algorithm1.18.18.m1.2.2.1.1.3" xref="algorithm1.18.18.m1.2.2.1.1.3.cmml">m</mi><mo id="algorithm1.18.18.m1.2.2.1.1.2" xref="algorithm1.18.18.m1.2.2.1.1.2.cmml">⁢</mo><mi id="algorithm1.18.18.m1.2.2.1.1.4" xref="algorithm1.18.18.m1.2.2.1.1.4.cmml">e</mi><mo id="algorithm1.18.18.m1.2.2.1.1.2a" xref="algorithm1.18.18.m1.2.2.1.1.2.cmml">⁢</mo><mi id="algorithm1.18.18.m1.2.2.1.1.5" xref="algorithm1.18.18.m1.2.2.1.1.5.cmml">a</mi><mo id="algorithm1.18.18.m1.2.2.1.1.2b" xref="algorithm1.18.18.m1.2.2.1.1.2.cmml">⁢</mo><mi id="algorithm1.18.18.m1.2.2.1.1.6" xref="algorithm1.18.18.m1.2.2.1.1.6.cmml">n</mi><mo id="algorithm1.18.18.m1.2.2.1.1.2c" xref="algorithm1.18.18.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="algorithm1.18.18.m1.2.2.1.1.1.1" xref="algorithm1.18.18.m1.2.2.1.1.cmml"><mo id="algorithm1.18.18.m1.2.2.1.1.1.1.2" stretchy="false" xref="algorithm1.18.18.m1.2.2.1.1.cmml">(</mo><mrow id="algorithm1.18.18.m1.2.2.1.1.1.1.1.2" xref="algorithm1.18.18.m1.2.2.1.1.1.1.1.1.cmml"><mo id="algorithm1.18.18.m1.2.2.1.1.1.1.1.2.1" stretchy="false" xref="algorithm1.18.18.m1.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi id="algorithm1.18.18.m1.1.1" xref="algorithm1.18.18.m1.1.1.cmml">𝒆</mi><mo id="algorithm1.18.18.m1.2.2.1.1.1.1.1.2.2" stretchy="false" xref="algorithm1.18.18.m1.2.2.1.1.1.1.1.1.1.cmml">|</mo></mrow><mo id="algorithm1.18.18.m1.2.2.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="algorithm1.18.18.m1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.18.18.m1.2.2.1.2" rspace="0.222em" xref="algorithm1.18.18.m1.2.2.1.2.cmml">⋅</mo><mi id="algorithm1.18.18.m1.2.2.1.3" xref="algorithm1.18.18.m1.2.2.1.3.cmml">𝒃</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.2b"><apply id="algorithm1.18.18.m1.2.2.cmml" xref="algorithm1.18.18.m1.2.2"><eq id="algorithm1.18.18.m1.2.2.2.cmml" xref="algorithm1.18.18.m1.2.2.2"></eq><apply id="algorithm1.18.18.m1.2.2.3.cmml" xref="algorithm1.18.18.m1.2.2.3"><ci id="algorithm1.18.18.m1.2.2.3.1.cmml" xref="algorithm1.18.18.m1.2.2.3.1">^</ci><ci id="algorithm1.18.18.m1.2.2.3.2.cmml" xref="algorithm1.18.18.m1.2.2.3.2">𝒆</ci></apply><apply id="algorithm1.18.18.m1.2.2.1.cmml" xref="algorithm1.18.18.m1.2.2.1"><ci id="algorithm1.18.18.m1.2.2.1.2.cmml" xref="algorithm1.18.18.m1.2.2.1.2">⋅</ci><apply id="algorithm1.18.18.m1.2.2.1.1.cmml" xref="algorithm1.18.18.m1.2.2.1.1"><times id="algorithm1.18.18.m1.2.2.1.1.2.cmml" xref="algorithm1.18.18.m1.2.2.1.1.2"></times><ci id="algorithm1.18.18.m1.2.2.1.1.3.cmml" xref="algorithm1.18.18.m1.2.2.1.1.3">𝑚</ci><ci id="algorithm1.18.18.m1.2.2.1.1.4.cmml" xref="algorithm1.18.18.m1.2.2.1.1.4">𝑒</ci><ci id="algorithm1.18.18.m1.2.2.1.1.5.cmml" xref="algorithm1.18.18.m1.2.2.1.1.5">𝑎</ci><ci id="algorithm1.18.18.m1.2.2.1.1.6.cmml" xref="algorithm1.18.18.m1.2.2.1.1.6">𝑛</ci><apply id="algorithm1.18.18.m1.2.2.1.1.1.1.1.1.cmml" xref="algorithm1.18.18.m1.2.2.1.1.1.1.1.2"><abs id="algorithm1.18.18.m1.2.2.1.1.1.1.1.1.1.cmml" xref="algorithm1.18.18.m1.2.2.1.1.1.1.1.2.1"></abs><ci id="algorithm1.18.18.m1.1.1.cmml" xref="algorithm1.18.18.m1.1.1">𝒆</ci></apply></apply><ci id="algorithm1.18.18.m1.2.2.1.3.cmml" xref="algorithm1.18.18.m1.2.2.1.3">𝒃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.2c">\hat{\bm{e}}=mean(|\bm{e}|)\cdot\bm{b}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.18.18.m1.2d">over^ start_ARG bold_italic_e end_ARG = italic_m italic_e italic_a italic_n ( | bold_italic_e | ) ⋅ bold_italic_b</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.18.25">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm1.22.2.1">Algorithm 1</span> </span>Comparison between CIGAR <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib29" title="">2019</a>)</cite>, HashGNN <cite class="ltx_cite ltx_citemacro_citep">(Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib55" title="">2020</a>)</cite> and <span class="ltx_text" id="algorithm1.20.1">L<sup class="ltx_sup" id="algorithm1.20.1.1">2</sup>Q-GCN</span> <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib6" title="">2021b</a>)</cite>. </figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Quantization</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Although binarization has better efficiency and less memory cost at the inference stage,
it may lead to a significant drop of accuracy, which is not acceptable in several scenarios.
As Cheng et al. <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib7" title="">2016</a>)</cite> claim, even <math alttext="0.1\%" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mn id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">0.1</mn><mo id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1">percent</csymbol><cn id="S2.SS2.p1.1.m1.1.1.2.cmml" type="float" xref="S2.SS2.p1.1.m1.1.1.2">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">0.1\%</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">0.1 %</annotation></semantics></math> decrease of the prediction accuracy may result in large decline in revenue.
To trade off the memory cost and the prediction accuracy, quantization is used to represent each weight with a multi-bit integer.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.12">Quantization is the mapping of a 32-bit full-precision weight to an element in the set of quantized values <math alttext="\mathbb{S}=\{q_{0},q_{1},...,q_{k}\}" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.4"><semantics id="S2.SS2.p2.1.m1.4a"><mrow id="S2.SS2.p2.1.m1.4.4" xref="S2.SS2.p2.1.m1.4.4.cmml"><mi id="S2.SS2.p2.1.m1.4.4.5" xref="S2.SS2.p2.1.m1.4.4.5.cmml">𝕊</mi><mo id="S2.SS2.p2.1.m1.4.4.4" xref="S2.SS2.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S2.SS2.p2.1.m1.4.4.3.3" xref="S2.SS2.p2.1.m1.4.4.3.4.cmml"><mo id="S2.SS2.p2.1.m1.4.4.3.3.4" stretchy="false" xref="S2.SS2.p2.1.m1.4.4.3.4.cmml">{</mo><msub id="S2.SS2.p2.1.m1.2.2.1.1.1" xref="S2.SS2.p2.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.2.2.1.1.1.2" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2.cmml">q</mi><mn id="S2.SS2.p2.1.m1.2.2.1.1.1.3" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS2.p2.1.m1.4.4.3.3.5" xref="S2.SS2.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS2.p2.1.m1.3.3.2.2.2" xref="S2.SS2.p2.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS2.p2.1.m1.3.3.2.2.2.2" xref="S2.SS2.p2.1.m1.3.3.2.2.2.2.cmml">q</mi><mn id="S2.SS2.p2.1.m1.3.3.2.2.2.3" xref="S2.SS2.p2.1.m1.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S2.SS2.p2.1.m1.4.4.3.3.6" xref="S2.SS2.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.SS2.p2.1.m1.1.1" mathvariant="normal" xref="S2.SS2.p2.1.m1.1.1.cmml">…</mi><mo id="S2.SS2.p2.1.m1.4.4.3.3.7" xref="S2.SS2.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS2.p2.1.m1.4.4.3.3.3" xref="S2.SS2.p2.1.m1.4.4.3.3.3.cmml"><mi id="S2.SS2.p2.1.m1.4.4.3.3.3.2" xref="S2.SS2.p2.1.m1.4.4.3.3.3.2.cmml">q</mi><mi id="S2.SS2.p2.1.m1.4.4.3.3.3.3" xref="S2.SS2.p2.1.m1.4.4.3.3.3.3.cmml">k</mi></msub><mo id="S2.SS2.p2.1.m1.4.4.3.3.8" stretchy="false" xref="S2.SS2.p2.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.4b"><apply id="S2.SS2.p2.1.m1.4.4.cmml" xref="S2.SS2.p2.1.m1.4.4"><eq id="S2.SS2.p2.1.m1.4.4.4.cmml" xref="S2.SS2.p2.1.m1.4.4.4"></eq><ci id="S2.SS2.p2.1.m1.4.4.5.cmml" xref="S2.SS2.p2.1.m1.4.4.5">𝕊</ci><set id="S2.SS2.p2.1.m1.4.4.3.4.cmml" xref="S2.SS2.p2.1.m1.4.4.3.3"><apply id="S2.SS2.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.2.2.1.1.1.2">𝑞</ci><cn id="S2.SS2.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.1.m1.2.2.1.1.1.3">0</cn></apply><apply id="S2.SS2.p2.1.m1.3.3.2.2.2.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS2.p2.1.m1.3.3.2.2.2.2">𝑞</ci><cn id="S2.SS2.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS2.p2.1.m1.3.3.2.2.2.3">1</cn></apply><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">…</ci><apply id="S2.SS2.p2.1.m1.4.4.3.3.3.cmml" xref="S2.SS2.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.4.4.3.3.3.1.cmml" xref="S2.SS2.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.SS2.p2.1.m1.4.4.3.3.3.2.cmml" xref="S2.SS2.p2.1.m1.4.4.3.3.3.2">𝑞</ci><ci id="S2.SS2.p2.1.m1.4.4.3.3.3.3.cmml" xref="S2.SS2.p2.1.m1.4.4.3.3.3.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.4c">\mathbb{S}=\{q_{0},q_{1},...,q_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.4d">blackboard_S = { italic_q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_q start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math>,
where <math alttext="k=2^{s}-1" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">k</mi><mo id="S2.SS2.p2.2.m2.1.1.1" xref="S2.SS2.p2.2.m2.1.1.1.cmml">=</mo><mrow id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml"><msup id="S2.SS2.p2.2.m2.1.1.3.2" xref="S2.SS2.p2.2.m2.1.1.3.2.cmml"><mn id="S2.SS2.p2.2.m2.1.1.3.2.2" xref="S2.SS2.p2.2.m2.1.1.3.2.2.cmml">2</mn><mi id="S2.SS2.p2.2.m2.1.1.3.2.3" xref="S2.SS2.p2.2.m2.1.1.3.2.3.cmml">s</mi></msup><mo id="S2.SS2.p2.2.m2.1.1.3.1" xref="S2.SS2.p2.2.m2.1.1.3.1.cmml">−</mo><mn id="S2.SS2.p2.2.m2.1.1.3.3" xref="S2.SS2.p2.2.m2.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><eq id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1"></eq><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑘</ci><apply id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3"><minus id="S2.SS2.p2.2.m2.1.1.3.1.cmml" xref="S2.SS2.p2.2.m2.1.1.3.1"></minus><apply id="S2.SS2.p2.2.m2.1.1.3.2.cmml" xref="S2.SS2.p2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.3.2.1.cmml" xref="S2.SS2.p2.2.m2.1.1.3.2">superscript</csymbol><cn id="S2.SS2.p2.2.m2.1.1.3.2.2.cmml" type="integer" xref="S2.SS2.p2.2.m2.1.1.3.2.2">2</cn><ci id="S2.SS2.p2.2.m2.1.1.3.2.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3.2.3">𝑠</ci></apply><cn id="S2.SS2.p2.2.m2.1.1.3.3.cmml" type="integer" xref="S2.SS2.p2.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">k=2^{s}-1</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_k = 2 start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT - 1</annotation></semantics></math> and <math alttext="s" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><mi id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_s</annotation></semantics></math> is the bit width.
The most commonly used quantization function is uniform quantization, where the quantized values are uniformly distributed.
Specifically, the step size <math alttext="\Delta=q_{i}-q_{i-1}" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" mathvariant="normal" xref="S2.SS2.p2.4.m4.1.1.2.cmml">Δ</mi><mo id="S2.SS2.p2.4.m4.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.cmml">=</mo><mrow id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml"><msub id="S2.SS2.p2.4.m4.1.1.3.2" xref="S2.SS2.p2.4.m4.1.1.3.2.cmml"><mi id="S2.SS2.p2.4.m4.1.1.3.2.2" xref="S2.SS2.p2.4.m4.1.1.3.2.2.cmml">q</mi><mi id="S2.SS2.p2.4.m4.1.1.3.2.3" xref="S2.SS2.p2.4.m4.1.1.3.2.3.cmml">i</mi></msub><mo id="S2.SS2.p2.4.m4.1.1.3.1" xref="S2.SS2.p2.4.m4.1.1.3.1.cmml">−</mo><msub id="S2.SS2.p2.4.m4.1.1.3.3" xref="S2.SS2.p2.4.m4.1.1.3.3.cmml"><mi id="S2.SS2.p2.4.m4.1.1.3.3.2" xref="S2.SS2.p2.4.m4.1.1.3.3.2.cmml">q</mi><mrow id="S2.SS2.p2.4.m4.1.1.3.3.3" xref="S2.SS2.p2.4.m4.1.1.3.3.3.cmml"><mi id="S2.SS2.p2.4.m4.1.1.3.3.3.2" xref="S2.SS2.p2.4.m4.1.1.3.3.3.2.cmml">i</mi><mo id="S2.SS2.p2.4.m4.1.1.3.3.3.1" xref="S2.SS2.p2.4.m4.1.1.3.3.3.1.cmml">−</mo><mn id="S2.SS2.p2.4.m4.1.1.3.3.3.3" xref="S2.SS2.p2.4.m4.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><eq id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1"></eq><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">Δ</ci><apply id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3"><minus id="S2.SS2.p2.4.m4.1.1.3.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3.1"></minus><apply id="S2.SS2.p2.4.m4.1.1.3.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.3.2.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.3.2.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.2">𝑞</ci><ci id="S2.SS2.p2.4.m4.1.1.3.2.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.3">𝑖</ci></apply><apply id="S2.SS2.p2.4.m4.1.1.3.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.3.3.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.3.3.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3.2">𝑞</ci><apply id="S2.SS2.p2.4.m4.1.1.3.3.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3.3"><minus id="S2.SS2.p2.4.m4.1.1.3.3.3.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3.3.1"></minus><ci id="S2.SS2.p2.4.m4.1.1.3.3.3.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3.3.2">𝑖</ci><cn id="S2.SS2.p2.4.m4.1.1.3.3.3.3.cmml" type="integer" xref="S2.SS2.p2.4.m4.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">\Delta=q_{i}-q_{i-1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">roman_Δ = italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_q start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT</annotation></semantics></math> remains the same for any <math alttext="i\in[1,k]" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m5.2"><semantics id="S2.SS2.p2.5.m5.2a"><mrow id="S2.SS2.p2.5.m5.2.3" xref="S2.SS2.p2.5.m5.2.3.cmml"><mi id="S2.SS2.p2.5.m5.2.3.2" xref="S2.SS2.p2.5.m5.2.3.2.cmml">i</mi><mo id="S2.SS2.p2.5.m5.2.3.1" xref="S2.SS2.p2.5.m5.2.3.1.cmml">∈</mo><mrow id="S2.SS2.p2.5.m5.2.3.3.2" xref="S2.SS2.p2.5.m5.2.3.3.1.cmml"><mo id="S2.SS2.p2.5.m5.2.3.3.2.1" stretchy="false" xref="S2.SS2.p2.5.m5.2.3.3.1.cmml">[</mo><mn id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">1</mn><mo id="S2.SS2.p2.5.m5.2.3.3.2.2" xref="S2.SS2.p2.5.m5.2.3.3.1.cmml">,</mo><mi id="S2.SS2.p2.5.m5.2.2" xref="S2.SS2.p2.5.m5.2.2.cmml">k</mi><mo id="S2.SS2.p2.5.m5.2.3.3.2.3" stretchy="false" xref="S2.SS2.p2.5.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.2b"><apply id="S2.SS2.p2.5.m5.2.3.cmml" xref="S2.SS2.p2.5.m5.2.3"><in id="S2.SS2.p2.5.m5.2.3.1.cmml" xref="S2.SS2.p2.5.m5.2.3.1"></in><ci id="S2.SS2.p2.5.m5.2.3.2.cmml" xref="S2.SS2.p2.5.m5.2.3.2">𝑖</ci><interval closure="closed" id="S2.SS2.p2.5.m5.2.3.3.1.cmml" xref="S2.SS2.p2.5.m5.2.3.3.2"><cn id="S2.SS2.p2.5.m5.1.1.cmml" type="integer" xref="S2.SS2.p2.5.m5.1.1">1</cn><ci id="S2.SS2.p2.5.m5.2.2.cmml" xref="S2.SS2.p2.5.m5.2.2">𝑘</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.2c">i\in[1,k]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.2d">italic_i ∈ [ 1 , italic_k ]</annotation></semantics></math>.
Let <math alttext="w" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m6.1"><semantics id="S2.SS2.p2.6.m6.1a"><mi id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b"><ci id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">w</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m6.1d">italic_w</annotation></semantics></math> be a value clipped into the range <math alttext="[q_{0},q_{k}]" class="ltx_Math" display="inline" id="S2.SS2.p2.7.m7.2"><semantics id="S2.SS2.p2.7.m7.2a"><mrow id="S2.SS2.p2.7.m7.2.2.2" xref="S2.SS2.p2.7.m7.2.2.3.cmml"><mo id="S2.SS2.p2.7.m7.2.2.2.3" stretchy="false" xref="S2.SS2.p2.7.m7.2.2.3.cmml">[</mo><msub id="S2.SS2.p2.7.m7.1.1.1.1" xref="S2.SS2.p2.7.m7.1.1.1.1.cmml"><mi id="S2.SS2.p2.7.m7.1.1.1.1.2" xref="S2.SS2.p2.7.m7.1.1.1.1.2.cmml">q</mi><mn id="S2.SS2.p2.7.m7.1.1.1.1.3" xref="S2.SS2.p2.7.m7.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS2.p2.7.m7.2.2.2.4" xref="S2.SS2.p2.7.m7.2.2.3.cmml">,</mo><msub id="S2.SS2.p2.7.m7.2.2.2.2" xref="S2.SS2.p2.7.m7.2.2.2.2.cmml"><mi id="S2.SS2.p2.7.m7.2.2.2.2.2" xref="S2.SS2.p2.7.m7.2.2.2.2.2.cmml">q</mi><mi id="S2.SS2.p2.7.m7.2.2.2.2.3" xref="S2.SS2.p2.7.m7.2.2.2.2.3.cmml">k</mi></msub><mo id="S2.SS2.p2.7.m7.2.2.2.5" stretchy="false" xref="S2.SS2.p2.7.m7.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.2b"><interval closure="closed" id="S2.SS2.p2.7.m7.2.2.3.cmml" xref="S2.SS2.p2.7.m7.2.2.2"><apply id="S2.SS2.p2.7.m7.1.1.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.1.1.1.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.7.m7.1.1.1.1.2.cmml" xref="S2.SS2.p2.7.m7.1.1.1.1.2">𝑞</ci><cn id="S2.SS2.p2.7.m7.1.1.1.1.3.cmml" type="integer" xref="S2.SS2.p2.7.m7.1.1.1.1.3">0</cn></apply><apply id="S2.SS2.p2.7.m7.2.2.2.2.cmml" xref="S2.SS2.p2.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m7.2.2.2.2.1.cmml" xref="S2.SS2.p2.7.m7.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.7.m7.2.2.2.2.2.cmml" xref="S2.SS2.p2.7.m7.2.2.2.2.2">𝑞</ci><ci id="S2.SS2.p2.7.m7.2.2.2.2.3.cmml" xref="S2.SS2.p2.7.m7.2.2.2.2.3">𝑘</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.2c">[q_{0},q_{k}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m7.2d">[ italic_q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ]</annotation></semantics></math>, we can quantize it into an integer as <math alttext="\hat{w}=rd((w-q_{0})/\bigtriangleup)" class="ltx_math_unparsed" display="inline" id="S2.SS2.p2.8.m8.1"><semantics id="S2.SS2.p2.8.m8.1a"><mrow id="S2.SS2.p2.8.m8.1b"><mover accent="true" id="S2.SS2.p2.8.m8.1.1"><mi id="S2.SS2.p2.8.m8.1.1.2">w</mi><mo id="S2.SS2.p2.8.m8.1.1.1">^</mo></mover><mo id="S2.SS2.p2.8.m8.1.2">=</mo><mi id="S2.SS2.p2.8.m8.1.3">r</mi><mi id="S2.SS2.p2.8.m8.1.4">d</mi><mrow id="S2.SS2.p2.8.m8.1.5"><mo id="S2.SS2.p2.8.m8.1.5.1" stretchy="false">(</mo><mrow id="S2.SS2.p2.8.m8.1.5.2"><mo id="S2.SS2.p2.8.m8.1.5.2.1" stretchy="false">(</mo><mi id="S2.SS2.p2.8.m8.1.5.2.2">w</mi><mo id="S2.SS2.p2.8.m8.1.5.2.3">−</mo><msub id="S2.SS2.p2.8.m8.1.5.2.4"><mi id="S2.SS2.p2.8.m8.1.5.2.4.2">q</mi><mn id="S2.SS2.p2.8.m8.1.5.2.4.3">0</mn></msub><mo id="S2.SS2.p2.8.m8.1.5.2.5" stretchy="false">)</mo></mrow><mo id="S2.SS2.p2.8.m8.1.5.3" rspace="0em">/</mo><mo id="S2.SS2.p2.8.m8.1.5.4" lspace="0em" rspace="0em">△</mo><mo id="S2.SS2.p2.8.m8.1.5.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.1c">\hat{w}=rd((w-q_{0})/\bigtriangleup)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.8.m8.1d">over^ start_ARG italic_w end_ARG = italic_r italic_d ( ( italic_w - italic_q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) / △ )</annotation></semantics></math>,
where <math alttext="rd(x)" class="ltx_Math" display="inline" id="S2.SS2.p2.9.m9.1"><semantics id="S2.SS2.p2.9.m9.1a"><mrow id="S2.SS2.p2.9.m9.1.2" xref="S2.SS2.p2.9.m9.1.2.cmml"><mi id="S2.SS2.p2.9.m9.1.2.2" xref="S2.SS2.p2.9.m9.1.2.2.cmml">r</mi><mo id="S2.SS2.p2.9.m9.1.2.1" xref="S2.SS2.p2.9.m9.1.2.1.cmml">⁢</mo><mi id="S2.SS2.p2.9.m9.1.2.3" xref="S2.SS2.p2.9.m9.1.2.3.cmml">d</mi><mo id="S2.SS2.p2.9.m9.1.2.1a" xref="S2.SS2.p2.9.m9.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.p2.9.m9.1.2.4.2" xref="S2.SS2.p2.9.m9.1.2.cmml"><mo id="S2.SS2.p2.9.m9.1.2.4.2.1" stretchy="false" xref="S2.SS2.p2.9.m9.1.2.cmml">(</mo><mi id="S2.SS2.p2.9.m9.1.1" xref="S2.SS2.p2.9.m9.1.1.cmml">x</mi><mo id="S2.SS2.p2.9.m9.1.2.4.2.2" stretchy="false" xref="S2.SS2.p2.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m9.1b"><apply id="S2.SS2.p2.9.m9.1.2.cmml" xref="S2.SS2.p2.9.m9.1.2"><times id="S2.SS2.p2.9.m9.1.2.1.cmml" xref="S2.SS2.p2.9.m9.1.2.1"></times><ci id="S2.SS2.p2.9.m9.1.2.2.cmml" xref="S2.SS2.p2.9.m9.1.2.2">𝑟</ci><ci id="S2.SS2.p2.9.m9.1.2.3.cmml" xref="S2.SS2.p2.9.m9.1.2.3">𝑑</ci><ci id="S2.SS2.p2.9.m9.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m9.1c">rd(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.9.m9.1d">italic_r italic_d ( italic_x )</annotation></semantics></math> rounds <math alttext="x" class="ltx_Math" display="inline" id="S2.SS2.p2.10.m10.1"><semantics id="S2.SS2.p2.10.m10.1a"><mi id="S2.SS2.p2.10.m10.1.1" xref="S2.SS2.p2.10.m10.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m10.1b"><ci id="S2.SS2.p2.10.m10.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m10.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.10.m10.1d">italic_x</annotation></semantics></math> to an adjacent integer.
The integer <math alttext="\hat{w}" class="ltx_Math" display="inline" id="S2.SS2.p2.11.m11.1"><semantics id="S2.SS2.p2.11.m11.1a"><mover accent="true" id="S2.SS2.p2.11.m11.1.1" xref="S2.SS2.p2.11.m11.1.1.cmml"><mi id="S2.SS2.p2.11.m11.1.1.2" xref="S2.SS2.p2.11.m11.1.1.2.cmml">w</mi><mo id="S2.SS2.p2.11.m11.1.1.1" xref="S2.SS2.p2.11.m11.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.11.m11.1b"><apply id="S2.SS2.p2.11.m11.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1"><ci id="S2.SS2.p2.11.m11.1.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1.1">^</ci><ci id="S2.SS2.p2.11.m11.1.1.2.cmml" xref="S2.SS2.p2.11.m11.1.1.2">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.11.m11.1c">\hat{w}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.11.m11.1d">over^ start_ARG italic_w end_ARG</annotation></semantics></math> will be de-quantized into a floating-point value <math alttext="(\hat{w}\times\bigtriangleup+q_{0})" class="ltx_math_unparsed" display="inline" id="S2.SS2.p2.12.m12.1"><semantics id="S2.SS2.p2.12.m12.1a"><mrow id="S2.SS2.p2.12.m12.1b"><mo id="S2.SS2.p2.12.m12.1.1" stretchy="false">(</mo><mover accent="true" id="S2.SS2.p2.12.m12.1.2"><mi id="S2.SS2.p2.12.m12.1.2.2">w</mi><mo id="S2.SS2.p2.12.m12.1.2.1">^</mo></mover><mo id="S2.SS2.p2.12.m12.1.3" lspace="0.222em" rspace="0em">×</mo><mo id="S2.SS2.p2.12.m12.1.4" lspace="0em" rspace="0em">△</mo><mo id="S2.SS2.p2.12.m12.1.5" lspace="0em">+</mo><msub id="S2.SS2.p2.12.m12.1.6"><mi id="S2.SS2.p2.12.m12.1.6.2">q</mi><mn id="S2.SS2.p2.12.m12.1.6.3">0</mn></msub><mo id="S2.SS2.p2.12.m12.1.7" stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" id="S2.SS2.p2.12.m12.1c">(\hat{w}\times\bigtriangleup+q_{0})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.12.m12.1d">( over^ start_ARG italic_w end_ARG × △ + italic_q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math> when used.
Existing work on embedding quantization either performs post-training quantization or trains a quantized embedding table from scratch.</p>
</div>
<figure class="ltx_figure" id="S2.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="99" id="S2.F4.g1" src="extracted/5774277/figs/quantization.png" width="346"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Training frameworks of quantization. <math alttext="Loss" class="ltx_Math" display="inline" id="S2.F4.4.m1.1"><semantics id="S2.F4.4.m1.1b"><mrow id="S2.F4.4.m1.1.1" xref="S2.F4.4.m1.1.1.cmml"><mi id="S2.F4.4.m1.1.1.2" xref="S2.F4.4.m1.1.1.2.cmml">L</mi><mo id="S2.F4.4.m1.1.1.1" xref="S2.F4.4.m1.1.1.1.cmml">⁢</mo><mi id="S2.F4.4.m1.1.1.3" xref="S2.F4.4.m1.1.1.3.cmml">o</mi><mo id="S2.F4.4.m1.1.1.1b" xref="S2.F4.4.m1.1.1.1.cmml">⁢</mo><mi id="S2.F4.4.m1.1.1.4" xref="S2.F4.4.m1.1.1.4.cmml">s</mi><mo id="S2.F4.4.m1.1.1.1c" xref="S2.F4.4.m1.1.1.1.cmml">⁢</mo><mi id="S2.F4.4.m1.1.1.5" xref="S2.F4.4.m1.1.1.5.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.F4.4.m1.1c"><apply id="S2.F4.4.m1.1.1.cmml" xref="S2.F4.4.m1.1.1"><times id="S2.F4.4.m1.1.1.1.cmml" xref="S2.F4.4.m1.1.1.1"></times><ci id="S2.F4.4.m1.1.1.2.cmml" xref="S2.F4.4.m1.1.1.2">𝐿</ci><ci id="S2.F4.4.m1.1.1.3.cmml" xref="S2.F4.4.m1.1.1.3">𝑜</ci><ci id="S2.F4.4.m1.1.1.4.cmml" xref="S2.F4.4.m1.1.1.4">𝑠</ci><ci id="S2.F4.4.m1.1.1.5.cmml" xref="S2.F4.4.m1.1.1.5">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.4.m1.1d">Loss</annotation><annotation encoding="application/x-llamapun" id="S2.F4.4.m1.1e">italic_L italic_o italic_s italic_s</annotation></semantics></math> (red) is the training loss. <math alttext="M" class="ltx_Math" display="inline" id="S2.F4.5.m2.1"><semantics id="S2.F4.5.m2.1b"><mi id="S2.F4.5.m2.1.1" xref="S2.F4.5.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.F4.5.m2.1c"><ci id="S2.F4.5.m2.1.1.cmml" xref="S2.F4.5.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.5.m2.1d">M</annotation><annotation encoding="application/x-llamapun" id="S2.F4.5.m2.1e">italic_M</annotation></semantics></math> (purple) and <math alttext="E" class="ltx_Math" display="inline" id="S2.F4.6.m3.1"><semantics id="S2.F4.6.m3.1b"><mi id="S2.F4.6.m3.1.1" xref="S2.F4.6.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.F4.6.m3.1c"><ci id="S2.F4.6.m3.1.1.cmml" xref="S2.F4.6.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F4.6.m3.1d">E</annotation><annotation encoding="application/x-llamapun" id="S2.F4.6.m3.1e">italic_E</annotation></semantics></math> (green) represent the integer and full-precision weights, respectively.
</figcaption>
</figure>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">Guan et al. <cite class="ltx_cite ltx_citemacro_citep">(Guan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib17" title="">2019</a>)</cite> studies post-training quantization (PTQ) on the embedding tables and proposes a uniform and a non-uniform quantization algorithm.
Specifically, in the uniform quantization, they maintain a quantization range for each embedding and find the best quantization range by a greedy search algorithm.
In the non-uniform quantization, they divide similar embeddings into groups and apply k-means clustering on the weights to produce a codebook for each group.
The weights in each group will be mapped to the index of a value in the corresponding codebook.
These two algorithms improve the accuracy of PTQ, however, they still suffer from accuracy degradation.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">To further reduce accuracy degradation, recent works <cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib67" title="">2021</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib70" title="">2020</a>)</cite> learn quantized weights from scratch.
Unlike the well-known quantization-aware training (QAT) <cite class="ltx_cite ltx_citemacro_citep">(Esser et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib14" title="">2020</a>; Bhalgat et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib3" title="">2020</a>)</cite>,
<cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib67" title="">2021</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib70" title="">2020</a>)</cite> use another quantization training framework to exploit the sparsity of the input data, which we term low-precision training (LPT).
As Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S2.F4" title="Figure 4 ‣ 2.2. Quantization ‣ 2. Low-Precision ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">4</span></a>(a) shows, QAT quantizes the full-precision weights in the forward pass and updates the full-precision weights with the gradients estimated by STE.
As Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S2.F4" title="Figure 4 ‣ 2.2. Quantization ‣ 2. Low-Precision ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">4</span></a>(b) shows, in LPT, the weights are stored in the format of integers at training, thereby compressing the training memory.
The model takes the de-quantized weights as input and will quantize the weights back into integers after the backward propagation.
Since the input one-hot vectors of DLRMs are highly sparse, only extremely small part of the embeddings will be de-quantized into floating-point values, whose memory is negligible.
Xu et al. <cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib67" title="">2021</a>)</cite> uses 16-bit LPT on the embedding table without sacrificing accuracy.
To enhance the compression capability of LPT, Yang et al. <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib70" title="">2020</a>)</cite> proposes a mixed-precision scheme where most embeddings are stored in the format of integers,
only the most recently or frequently used embeddings are stored in a full-precision cache.
With a small cache, they achieve lossless compression with 8-bit or even 4-bit quantization.
Li et al. <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib32" title="">2023</a>)</cite> proposes an adaptive low-precision training scheme to learn the quantization step size for better model accuracy.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Discussion</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Low-precision is a simple yet effective way for embedding compression.
At the inference stage, binarization can reduce the memory usage by <math alttext="32\times" class="ltx_math_unparsed" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><mrow id="S2.SS3.p1.1.m1.1b"><mn id="S2.SS3.p1.1.m1.1.1">32</mn><mo id="S2.SS3.p1.1.m1.1.2" lspace="0.222em">×</mo></mrow><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">32\times</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">32 ×</annotation></semantics></math> and accelerate the inference through Hamming distance.
However, the binary embeddings usually cause severe accuracy degradation and need to be trained with the guidance of full-precision embeddings,
which requires more memory usage and computing resources at training.
In contrast, quantization has a limited compression capability but can achieve a comparable accuracy as the full-precision embeddings.
Besides, recent quantization approaches for embedding tables can also compress the memory usage at the training stage
and improve the training efficiency by reducing the communication traffic.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Mixed-Dimension</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Embedding tables usually assign a uniform dimension to all the embeddings in a heuristic way,
and it turns out to be suboptimal in both prediction accuracy and memory usage <cite class="ltx_cite ltx_citemacro_citep">(Joglekar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib26" title="">2020</a>)</cite>.
As confirmed in <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib79" title="">2021</a>)</cite>, a low dimensional embedding is good at handling less frequent features where a high dimensional embedding cannot be well trained.
Therefore, to boost the model performance, it is important to assign a appropriate dimension to each feature and use mixed-dimension embeddings.</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="102" id="S3.F5.g1" src="extracted/5774277/figs/mixed_dimension.png" width="288"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>Structures of mixed-dimension embeddings.</figcaption>
</figure>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">Existing methods can obtain mixed-dimension embeddings in a structured or an unstructured manner. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S3.F5" title="Figure 5 ‣ 3. Mixed-Dimension ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">5</span></a>, structured approaches divide the embeddings into groups each of which has a unique dimension, while unstructured approaches learn a sparse embedding table where the embeddings have various dimensions. However these mixed-dimension embeddings are not friendly for the operations (e.g., inner product) which require the embeddings of the same length. Therefore, the mixed-dimension embeddings need to be transformed into a uniform dimension before feeding into the following networks.
Such transformation is usually achieved by linear projection or simply zero padding. Apart from the difference of the embedding structures, existing methods also differ greatly in the way of generating mixed-dimension embeddings.
In this section, we will introduce three kinds of mixed-dimension approaches named <span class="ltx_text ltx_font_bold" id="S3.p2.1.1">rule-based</span> approaches, <span class="ltx_text ltx_font_bold" id="S3.p2.1.2">NAS-based</span> approaches and <span class="ltx_text ltx_font_bold" id="S3.p2.1.3">pruning</span>, respectively.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Rule-based Approaches</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.7">It is a common understanding that the features with higher frequencies are more informative and the fields with more features occupy more memory.
Thus, the embedding dimension can be set with a heuristic rule based on the feature frequency and the field size.
To deploy the item embeddings into resource-constraint devices, CpRec <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib54" title="">2020</a>)</cite> divides the items into several groups by frequency
and assigns a predefined dimension to each group according to the frequencies of owned features.
Similarly, MDE <cite class="ltx_cite ltx_citemacro_citep">(Ginart et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib16" title="">2021</a>)</cite> assigns each feature field with a unique dimension according to the number of features included in this field.
Specifically, let <math alttext="\bm{n}\in\operatorname*{\mathbb{R}}^{m}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝒏</mi><mo id="S3.SS1.p1.1.m1.1.1.1" rspace="0.1389em" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mo id="S3.SS1.p1.1.m1.1.1.3.2" lspace="0.1389em" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝒏</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\bm{n}\in\operatorname*{\mathbb{R}}^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_italic_n ∈ blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the number of features in all <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_m</annotation></semantics></math> feature fields and <math alttext="\bm{p}={1}/{\bm{n}}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">𝒑</mi><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mn id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">1</mn><mo id="S3.SS1.p1.3.m3.1.1.3.1" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">/</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml">𝒏</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><eq id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></eq><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝒑</ci><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><divide id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1"></divide><cn id="S3.SS1.p1.3.m3.1.1.3.2.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1.3.2">1</cn><ci id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">𝒏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\bm{p}={1}/{\bm{n}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">bold_italic_p = 1 / bold_italic_n</annotation></semantics></math>,
then the embedding dimension of <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_i</annotation></semantics></math>-th field would be <math alttext="{\bar{d}{\bm{p_{i}}}^{\alpha}}/{||{\bm{p}}||_{\infty}^{\alpha}}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.2" xref="S3.SS1.p1.5.m5.1.2.cmml"><mrow id="S3.SS1.p1.5.m5.1.2.2" xref="S3.SS1.p1.5.m5.1.2.2.cmml"><mover accent="true" id="S3.SS1.p1.5.m5.1.2.2.2" xref="S3.SS1.p1.5.m5.1.2.2.2.cmml"><mi id="S3.SS1.p1.5.m5.1.2.2.2.2" xref="S3.SS1.p1.5.m5.1.2.2.2.2.cmml">d</mi><mo id="S3.SS1.p1.5.m5.1.2.2.2.1" xref="S3.SS1.p1.5.m5.1.2.2.2.1.cmml">¯</mo></mover><mo id="S3.SS1.p1.5.m5.1.2.2.1" xref="S3.SS1.p1.5.m5.1.2.2.1.cmml">⁢</mo><mmultiscripts id="S3.SS1.p1.5.m5.1.2.2.3" xref="S3.SS1.p1.5.m5.1.2.2.3.cmml"><mi id="S3.SS1.p1.5.m5.1.2.2.3.2.2" xref="S3.SS1.p1.5.m5.1.2.2.3.2.2.cmml">𝒑</mi><mi id="S3.SS1.p1.5.m5.1.2.2.3.2.3" xref="S3.SS1.p1.5.m5.1.2.2.3.2.3.cmml">𝒊</mi><mrow id="S3.SS1.p1.5.m5.1.2.2.3a" xref="S3.SS1.p1.5.m5.1.2.2.3.cmml"></mrow><mrow id="S3.SS1.p1.5.m5.1.2.2.3b" xref="S3.SS1.p1.5.m5.1.2.2.3.cmml"></mrow><mi id="S3.SS1.p1.5.m5.1.2.2.3.3" xref="S3.SS1.p1.5.m5.1.2.2.3.3.cmml">α</mi></mmultiscripts></mrow><mo id="S3.SS1.p1.5.m5.1.2.1" xref="S3.SS1.p1.5.m5.1.2.1.cmml">/</mo><msubsup id="S3.SS1.p1.5.m5.1.2.3" xref="S3.SS1.p1.5.m5.1.2.3.cmml"><mrow id="S3.SS1.p1.5.m5.1.2.3.2.2.2" xref="S3.SS1.p1.5.m5.1.2.3.2.2.1.cmml"><mo id="S3.SS1.p1.5.m5.1.2.3.2.2.2.1" stretchy="false" xref="S3.SS1.p1.5.m5.1.2.3.2.2.1.1.cmml">‖</mo><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">𝒑</mi><mo id="S3.SS1.p1.5.m5.1.2.3.2.2.2.2" stretchy="false" xref="S3.SS1.p1.5.m5.1.2.3.2.2.1.1.cmml">‖</mo></mrow><mi id="S3.SS1.p1.5.m5.1.2.3.2.3" mathvariant="normal" xref="S3.SS1.p1.5.m5.1.2.3.2.3.cmml">∞</mi><mi id="S3.SS1.p1.5.m5.1.2.3.3" xref="S3.SS1.p1.5.m5.1.2.3.3.cmml">α</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.2.cmml" xref="S3.SS1.p1.5.m5.1.2"><divide id="S3.SS1.p1.5.m5.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.2.1"></divide><apply id="S3.SS1.p1.5.m5.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.2.2"><times id="S3.SS1.p1.5.m5.1.2.2.1.cmml" xref="S3.SS1.p1.5.m5.1.2.2.1"></times><apply id="S3.SS1.p1.5.m5.1.2.2.2.cmml" xref="S3.SS1.p1.5.m5.1.2.2.2"><ci id="S3.SS1.p1.5.m5.1.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.1.2.2.2.1">¯</ci><ci id="S3.SS1.p1.5.m5.1.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.1.2.2.2.2">𝑑</ci></apply><apply id="S3.SS1.p1.5.m5.1.2.2.3.cmml" xref="S3.SS1.p1.5.m5.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.2.2.3.1.cmml" xref="S3.SS1.p1.5.m5.1.2.2.3">superscript</csymbol><apply id="S3.SS1.p1.5.m5.1.2.2.3.2.cmml" xref="S3.SS1.p1.5.m5.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.2.2.3.2.1.cmml" xref="S3.SS1.p1.5.m5.1.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.2.2.3.2.2.cmml" xref="S3.SS1.p1.5.m5.1.2.2.3.2.2">𝒑</ci><ci id="S3.SS1.p1.5.m5.1.2.2.3.2.3.cmml" xref="S3.SS1.p1.5.m5.1.2.2.3.2.3">𝒊</ci></apply><ci id="S3.SS1.p1.5.m5.1.2.2.3.3.cmml" xref="S3.SS1.p1.5.m5.1.2.2.3.3">𝛼</ci></apply></apply><apply id="S3.SS1.p1.5.m5.1.2.3.cmml" xref="S3.SS1.p1.5.m5.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.2.3.1.cmml" xref="S3.SS1.p1.5.m5.1.2.3">superscript</csymbol><apply id="S3.SS1.p1.5.m5.1.2.3.2.cmml" xref="S3.SS1.p1.5.m5.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.2.3.2.1.cmml" xref="S3.SS1.p1.5.m5.1.2.3">subscript</csymbol><apply id="S3.SS1.p1.5.m5.1.2.3.2.2.1.cmml" xref="S3.SS1.p1.5.m5.1.2.3.2.2.2"><csymbol cd="latexml" id="S3.SS1.p1.5.m5.1.2.3.2.2.1.1.cmml" xref="S3.SS1.p1.5.m5.1.2.3.2.2.2.1">norm</csymbol><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝒑</ci></apply><infinity id="S3.SS1.p1.5.m5.1.2.3.2.3.cmml" xref="S3.SS1.p1.5.m5.1.2.3.2.3"></infinity></apply><ci id="S3.SS1.p1.5.m5.1.2.3.3.cmml" xref="S3.SS1.p1.5.m5.1.2.3.3">𝛼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">{\bar{d}{\bm{p_{i}}}^{\alpha}}/{||{\bm{p}}||_{\infty}^{\alpha}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">over¯ start_ARG italic_d end_ARG bold_italic_p start_POSTSUBSCRIPT bold_italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_α end_POSTSUPERSCRIPT / | | bold_italic_p | | start_POSTSUBSCRIPT ∞ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_α end_POSTSUPERSCRIPT</annotation></semantics></math>,
where <math alttext="\bar{d}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mover accent="true" id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">d</mi><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><ci id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1">¯</ci><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\bar{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">over¯ start_ARG italic_d end_ARG</annotation></semantics></math> is the base dimension and <math alttext="\alpha\in[0,1]" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.2"><semantics id="S3.SS1.p1.7.m7.2a"><mrow id="S3.SS1.p1.7.m7.2.3" xref="S3.SS1.p1.7.m7.2.3.cmml"><mi id="S3.SS1.p1.7.m7.2.3.2" xref="S3.SS1.p1.7.m7.2.3.2.cmml">α</mi><mo id="S3.SS1.p1.7.m7.2.3.1" xref="S3.SS1.p1.7.m7.2.3.1.cmml">∈</mo><mrow id="S3.SS1.p1.7.m7.2.3.3.2" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml"><mo id="S3.SS1.p1.7.m7.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml">[</mo><mn id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">0</mn><mo id="S3.SS1.p1.7.m7.2.3.3.2.2" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml">,</mo><mn id="S3.SS1.p1.7.m7.2.2" xref="S3.SS1.p1.7.m7.2.2.cmml">1</mn><mo id="S3.SS1.p1.7.m7.2.3.3.2.3" stretchy="false" xref="S3.SS1.p1.7.m7.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.2b"><apply id="S3.SS1.p1.7.m7.2.3.cmml" xref="S3.SS1.p1.7.m7.2.3"><in id="S3.SS1.p1.7.m7.2.3.1.cmml" xref="S3.SS1.p1.7.m7.2.3.1"></in><ci id="S3.SS1.p1.7.m7.2.3.2.cmml" xref="S3.SS1.p1.7.m7.2.3.2">𝛼</ci><interval closure="closed" id="S3.SS1.p1.7.m7.2.3.3.1.cmml" xref="S3.SS1.p1.7.m7.2.3.3.2"><cn id="S3.SS1.p1.7.m7.1.1.cmml" type="integer" xref="S3.SS1.p1.7.m7.1.1">0</cn><cn id="S3.SS1.p1.7.m7.2.2.cmml" type="integer" xref="S3.SS1.p1.7.m7.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.2c">\alpha\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.2d">italic_α ∈ [ 0 , 1 ]</annotation></semantics></math> denotes the temperature.
These rule-based approaches are simple yet effective in reducing the memory usage and alleviating the overfitting problems,
however, they suffer from suboptimal performance as the heuristic rules can not be optimized by the ultimate goal of minimizing the training objective.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>NAS-based Approaches</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">NAS was originally proposed to search for the optimal neural network architectures <cite class="ltx_cite ltx_citemacro_citep">(Zoph and Le, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib83" title="">2017</a>)</cite>.
Recently, it has also been adopted in searching embedding dimensions for different features.
Unlike the rule-based approaches where the dimension is set based on a priori, it is now learned.
Generally, there are three components in the NAS-based approaches:
(1) search space: relaxing the large optimization space of embedding dimensions with heuristic assumptions;
(2) controller: usually a neural network or learnable parameters, selecting candidate dimension from the search space in a hard or soft manner;
(3) updating algorithm: updating the controller with reinforcement learning (RL) algorithms or differential architecture search (DARTS) <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib39" title="">2019a</a>)</cite> techniques and so on.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.10">We first introduce the approaches of NIS <cite class="ltx_cite ltx_citemacro_citep">(Joglekar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib26" title="">2020</a>)</cite>, ESAPN <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib40" title="">2020</a>)</cite> and AutoIAS <cite class="ltx_cite ltx_citemacro_citep">(Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib60" title="">2021</a>)</cite>, which adopt a policy network as the controller and update the controller with RL algorithms.
NIS <cite class="ltx_cite ltx_citemacro_citep">(Joglekar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib26" title="">2020</a>)</cite> and ESAPN <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib40" title="">2020</a>)</cite> are designed to learn embedding dimensions of users and items.
In NIS, the authors relax the original search space <math alttext="n\times d" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">n</mi><mo id="S3.SS2.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.1.m1.1.1.1.cmml">×</mo><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><times id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1"></times><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑛</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">n\times d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_n × italic_d</annotation></semantics></math> to <math alttext="G\times B" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">G</mi><mo id="S3.SS2.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.2.m2.1.1.1.cmml">×</mo><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><times id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"></times><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐺</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">G\times B</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_G × italic_B</annotation></semantics></math> (<math alttext="G&lt;n" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">G</mi><mo id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml">&lt;</mo><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><lt id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"></lt><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝐺</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">G&lt;n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_G &lt; italic_n</annotation></semantics></math> and <math alttext="B&lt;d" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">B</mi><mo id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.cmml">&lt;</mo><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><lt id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"></lt><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝐵</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">B&lt;d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_B &lt; italic_d</annotation></semantics></math>)
by dividing the features into <math alttext="G" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">G</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_G</annotation></semantics></math> groups and cutting the embedding dimension of each group into <math alttext="B" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mi id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">italic_B</annotation></semantics></math> blocks.
Then, they use the controller to select several blocks and generate the final embeddings.
In ESAPN, the authors predefine the search space as a set of candidate embedding dimensions <math alttext="\mathbb{D}=\{d_{1},d_{2},...,d_{k}\}," class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.2"><semantics id="S3.SS2.p2.7.m7.2a"><mrow id="S3.SS2.p2.7.m7.2.2.1" xref="S3.SS2.p2.7.m7.2.2.1.1.cmml"><mrow id="S3.SS2.p2.7.m7.2.2.1.1" xref="S3.SS2.p2.7.m7.2.2.1.1.cmml"><mi id="S3.SS2.p2.7.m7.2.2.1.1.5" xref="S3.SS2.p2.7.m7.2.2.1.1.5.cmml">𝔻</mi><mo id="S3.SS2.p2.7.m7.2.2.1.1.4" xref="S3.SS2.p2.7.m7.2.2.1.1.4.cmml">=</mo><mrow id="S3.SS2.p2.7.m7.2.2.1.1.3.3" xref="S3.SS2.p2.7.m7.2.2.1.1.3.4.cmml"><mo id="S3.SS2.p2.7.m7.2.2.1.1.3.3.4" stretchy="false" xref="S3.SS2.p2.7.m7.2.2.1.1.3.4.cmml">{</mo><msub id="S3.SS2.p2.7.m7.2.2.1.1.1.1.1" xref="S3.SS2.p2.7.m7.2.2.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.7.m7.2.2.1.1.1.1.1.2" xref="S3.SS2.p2.7.m7.2.2.1.1.1.1.1.2.cmml">d</mi><mn id="S3.SS2.p2.7.m7.2.2.1.1.1.1.1.3" xref="S3.SS2.p2.7.m7.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p2.7.m7.2.2.1.1.3.3.5" xref="S3.SS2.p2.7.m7.2.2.1.1.3.4.cmml">,</mo><msub id="S3.SS2.p2.7.m7.2.2.1.1.2.2.2" xref="S3.SS2.p2.7.m7.2.2.1.1.2.2.2.cmml"><mi id="S3.SS2.p2.7.m7.2.2.1.1.2.2.2.2" xref="S3.SS2.p2.7.m7.2.2.1.1.2.2.2.2.cmml">d</mi><mn id="S3.SS2.p2.7.m7.2.2.1.1.2.2.2.3" xref="S3.SS2.p2.7.m7.2.2.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p2.7.m7.2.2.1.1.3.3.6" xref="S3.SS2.p2.7.m7.2.2.1.1.3.4.cmml">,</mo><mi id="S3.SS2.p2.7.m7.1.1" mathvariant="normal" xref="S3.SS2.p2.7.m7.1.1.cmml">…</mi><mo id="S3.SS2.p2.7.m7.2.2.1.1.3.3.7" xref="S3.SS2.p2.7.m7.2.2.1.1.3.4.cmml">,</mo><msub id="S3.SS2.p2.7.m7.2.2.1.1.3.3.3" xref="S3.SS2.p2.7.m7.2.2.1.1.3.3.3.cmml"><mi id="S3.SS2.p2.7.m7.2.2.1.1.3.3.3.2" xref="S3.SS2.p2.7.m7.2.2.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.p2.7.m7.2.2.1.1.3.3.3.3" xref="S3.SS2.p2.7.m7.2.2.1.1.3.3.3.3.cmml">k</mi></msub><mo id="S3.SS2.p2.7.m7.2.2.1.1.3.3.8" stretchy="false" xref="S3.SS2.p2.7.m7.2.2.1.1.3.4.cmml">}</mo></mrow></mrow><mo id="S3.SS2.p2.7.m7.2.2.1.2" xref="S3.SS2.p2.7.m7.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.2b"><apply id="S3.SS2.p2.7.m7.2.2.1.1.cmml" xref="S3.SS2.p2.7.m7.2.2.1"><eq id="S3.SS2.p2.7.m7.2.2.1.1.4.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.4"></eq><ci id="S3.SS2.p2.7.m7.2.2.1.1.5.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.5">𝔻</ci><set id="S3.SS2.p2.7.m7.2.2.1.1.3.4.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.3.3"><apply id="S3.SS2.p2.7.m7.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m7.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.1.1.1.2">𝑑</ci><cn id="S3.SS2.p2.7.m7.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p2.7.m7.2.2.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.p2.7.m7.2.2.1.1.2.2.2.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.2.2.1.1.2.2.2.1.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.7.m7.2.2.1.1.2.2.2.2.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.2.2.2.2">𝑑</ci><cn id="S3.SS2.p2.7.m7.2.2.1.1.2.2.2.3.cmml" type="integer" xref="S3.SS2.p2.7.m7.2.2.1.1.2.2.2.3">2</cn></apply><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">…</ci><apply id="S3.SS2.p2.7.m7.2.2.1.1.3.3.3.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.2.2.1.1.3.3.3.1.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p2.7.m7.2.2.1.1.3.3.3.2.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.p2.7.m7.2.2.1.1.3.3.3.3.cmml" xref="S3.SS2.p2.7.m7.2.2.1.1.3.3.3.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.2c">\mathbb{D}=\{d_{1},d_{2},...,d_{k}\},</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.2d">blackboard_D = { italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } ,</annotation></semantics></math> where <math alttext="d_{1}&lt;d_{2}&lt;...&lt;d_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m8.1"><semantics id="S3.SS2.p2.8.m8.1a"><mrow id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml"><msub id="S3.SS2.p2.8.m8.1.1.2" xref="S3.SS2.p2.8.m8.1.1.2.cmml"><mi id="S3.SS2.p2.8.m8.1.1.2.2" xref="S3.SS2.p2.8.m8.1.1.2.2.cmml">d</mi><mn id="S3.SS2.p2.8.m8.1.1.2.3" xref="S3.SS2.p2.8.m8.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS2.p2.8.m8.1.1.3" xref="S3.SS2.p2.8.m8.1.1.3.cmml">&lt;</mo><msub id="S3.SS2.p2.8.m8.1.1.4" xref="S3.SS2.p2.8.m8.1.1.4.cmml"><mi id="S3.SS2.p2.8.m8.1.1.4.2" xref="S3.SS2.p2.8.m8.1.1.4.2.cmml">d</mi><mn id="S3.SS2.p2.8.m8.1.1.4.3" xref="S3.SS2.p2.8.m8.1.1.4.3.cmml">2</mn></msub><mo id="S3.SS2.p2.8.m8.1.1.5" xref="S3.SS2.p2.8.m8.1.1.5.cmml">&lt;</mo><mi id="S3.SS2.p2.8.m8.1.1.6" mathvariant="normal" xref="S3.SS2.p2.8.m8.1.1.6.cmml">…</mi><mo id="S3.SS2.p2.8.m8.1.1.7" xref="S3.SS2.p2.8.m8.1.1.7.cmml">&lt;</mo><msub id="S3.SS2.p2.8.m8.1.1.8" xref="S3.SS2.p2.8.m8.1.1.8.cmml"><mi id="S3.SS2.p2.8.m8.1.1.8.2" xref="S3.SS2.p2.8.m8.1.1.8.2.cmml">d</mi><mi id="S3.SS2.p2.8.m8.1.1.8.3" xref="S3.SS2.p2.8.m8.1.1.8.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><apply id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1"><and id="S3.SS2.p2.8.m8.1.1a.cmml" xref="S3.SS2.p2.8.m8.1.1"></and><apply id="S3.SS2.p2.8.m8.1.1b.cmml" xref="S3.SS2.p2.8.m8.1.1"><lt id="S3.SS2.p2.8.m8.1.1.3.cmml" xref="S3.SS2.p2.8.m8.1.1.3"></lt><apply id="S3.SS2.p2.8.m8.1.1.2.cmml" xref="S3.SS2.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.2.1.cmml" xref="S3.SS2.p2.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.2.2.cmml" xref="S3.SS2.p2.8.m8.1.1.2.2">𝑑</ci><cn id="S3.SS2.p2.8.m8.1.1.2.3.cmml" type="integer" xref="S3.SS2.p2.8.m8.1.1.2.3">1</cn></apply><apply id="S3.SS2.p2.8.m8.1.1.4.cmml" xref="S3.SS2.p2.8.m8.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.4.1.cmml" xref="S3.SS2.p2.8.m8.1.1.4">subscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.4.2.cmml" xref="S3.SS2.p2.8.m8.1.1.4.2">𝑑</ci><cn id="S3.SS2.p2.8.m8.1.1.4.3.cmml" type="integer" xref="S3.SS2.p2.8.m8.1.1.4.3">2</cn></apply></apply><apply id="S3.SS2.p2.8.m8.1.1c.cmml" xref="S3.SS2.p2.8.m8.1.1"><lt id="S3.SS2.p2.8.m8.1.1.5.cmml" xref="S3.SS2.p2.8.m8.1.1.5"></lt><share href="https://arxiv.org/html/2408.02304v1#S3.SS2.p2.8.m8.1.1.4.cmml" id="S3.SS2.p2.8.m8.1.1d.cmml" xref="S3.SS2.p2.8.m8.1.1"></share><ci id="S3.SS2.p2.8.m8.1.1.6.cmml" xref="S3.SS2.p2.8.m8.1.1.6">…</ci></apply><apply id="S3.SS2.p2.8.m8.1.1e.cmml" xref="S3.SS2.p2.8.m8.1.1"><lt id="S3.SS2.p2.8.m8.1.1.7.cmml" xref="S3.SS2.p2.8.m8.1.1.7"></lt><share href="https://arxiv.org/html/2408.02304v1#S3.SS2.p2.8.m8.1.1.6.cmml" id="S3.SS2.p2.8.m8.1.1f.cmml" xref="S3.SS2.p2.8.m8.1.1"></share><apply id="S3.SS2.p2.8.m8.1.1.8.cmml" xref="S3.SS2.p2.8.m8.1.1.8"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.8.1.cmml" xref="S3.SS2.p2.8.m8.1.1.8">subscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.8.2.cmml" xref="S3.SS2.p2.8.m8.1.1.8.2">𝑑</ci><ci id="S3.SS2.p2.8.m8.1.1.8.3.cmml" xref="S3.SS2.p2.8.m8.1.1.8.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">d_{1}&lt;d_{2}&lt;...&lt;d_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m8.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &lt; italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT &lt; … &lt; italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
Inspired by the fact that the frequencies of features are monotonically increasing in the data stream,
they decide to increase or keep the current embedding dimension instead of selecting one in <math alttext="\mathbb{D}" class="ltx_Math" display="inline" id="S3.SS2.p2.9.m9.1"><semantics id="S3.SS2.p2.9.m9.1a"><mi id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml">𝔻</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><ci id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">𝔻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">\mathbb{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.9.m9.1d">blackboard_D</annotation></semantics></math>.
The decision is made by the controller based on the feature frequency and the current embedding dimension.
Different from NIS and ESAPN, AutoIAS searches not only the embedding dimensions of feature fields but also the following neural network architectures.
The authors design a search space for each model component (e.g., the search space of embedding dimensions is similar as <math alttext="\mathbb{D}" class="ltx_Math" display="inline" id="S3.SS2.p2.10.m10.1"><semantics id="S3.SS2.p2.10.m10.1a"><mi id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml">𝔻</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><ci id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">𝔻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">\mathbb{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.10.m10.1d">blackboard_D</annotation></semantics></math> in ESAPN.).
To boost the training efficiency, they maintain a supernet at training and use the controller to generate sub-architectures by inheriting parameters from the supernet.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.6">The RL-based approaches described above perform a hard selection by selecting only one embedding dimension for each feature or field at a time.
Instead, inspired by DARTS, AutoEmb <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib79" title="">2021</a>)</cite> and AutoDim <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib80" title="">2020</a>)</cite> make a soft selection by weighted summing over the embeddings of the candidate dimensions in <math alttext="\mathbb{D}=\{d_{1},d_{2},...,d_{k}\}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.4"><semantics id="S3.SS2.p3.1.m1.4a"><mrow id="S3.SS2.p3.1.m1.4.4" xref="S3.SS2.p3.1.m1.4.4.cmml"><mi id="S3.SS2.p3.1.m1.4.4.5" xref="S3.SS2.p3.1.m1.4.4.5.cmml">𝔻</mi><mo id="S3.SS2.p3.1.m1.4.4.4" xref="S3.SS2.p3.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS2.p3.1.m1.4.4.3.3" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml"><mo id="S3.SS2.p3.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.SS2.p3.1.m1.2.2.1.1.1" xref="S3.SS2.p3.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.2.2.1.1.1.2" xref="S3.SS2.p3.1.m1.2.2.1.1.1.2.cmml">d</mi><mn id="S3.SS2.p3.1.m1.2.2.1.1.1.3" xref="S3.SS2.p3.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p3.1.m1.4.4.3.3.5" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p3.1.m1.3.3.2.2.2" xref="S3.SS2.p3.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.p3.1.m1.3.3.2.2.2.2" xref="S3.SS2.p3.1.m1.3.3.2.2.2.2.cmml">d</mi><mn id="S3.SS2.p3.1.m1.3.3.2.2.2.3" xref="S3.SS2.p3.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p3.1.m1.4.4.3.3.6" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS2.p3.1.m1.1.1" mathvariant="normal" xref="S3.SS2.p3.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p3.1.m1.4.4.3.3.7" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p3.1.m1.4.4.3.3.3" xref="S3.SS2.p3.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS2.p3.1.m1.4.4.3.3.3.2" xref="S3.SS2.p3.1.m1.4.4.3.3.3.2.cmml">d</mi><mi id="S3.SS2.p3.1.m1.4.4.3.3.3.3" xref="S3.SS2.p3.1.m1.4.4.3.3.3.3.cmml">k</mi></msub><mo id="S3.SS2.p3.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS2.p3.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.4b"><apply id="S3.SS2.p3.1.m1.4.4.cmml" xref="S3.SS2.p3.1.m1.4.4"><eq id="S3.SS2.p3.1.m1.4.4.4.cmml" xref="S3.SS2.p3.1.m1.4.4.4"></eq><ci id="S3.SS2.p3.1.m1.4.4.5.cmml" xref="S3.SS2.p3.1.m1.4.4.5">𝔻</ci><set id="S3.SS2.p3.1.m1.4.4.3.4.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3"><apply id="S3.SS2.p3.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.2">𝑑</ci><cn id="S3.SS2.p3.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p3.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p3.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.2.2">𝑑</ci><cn id="S3.SS2.p3.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.p3.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">…</ci><apply id="S3.SS2.p3.1.m1.4.4.3.3.3.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p3.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3.3.2">𝑑</ci><ci id="S3.SS2.p3.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS2.p3.1.m1.4.4.3.3.3.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.4c">\mathbb{D}=\{d_{1},d_{2},...,d_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.4d">blackboard_D = { italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math>.
Let <math alttext="\bm{\omega}\in{[0,1]}^{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.2"><semantics id="S3.SS2.p3.2.m2.2a"><mrow id="S3.SS2.p3.2.m2.2.3" xref="S3.SS2.p3.2.m2.2.3.cmml"><mi id="S3.SS2.p3.2.m2.2.3.2" xref="S3.SS2.p3.2.m2.2.3.2.cmml">𝝎</mi><mo id="S3.SS2.p3.2.m2.2.3.1" xref="S3.SS2.p3.2.m2.2.3.1.cmml">∈</mo><msup id="S3.SS2.p3.2.m2.2.3.3" xref="S3.SS2.p3.2.m2.2.3.3.cmml"><mrow id="S3.SS2.p3.2.m2.2.3.3.2.2" xref="S3.SS2.p3.2.m2.2.3.3.2.1.cmml"><mo id="S3.SS2.p3.2.m2.2.3.3.2.2.1" stretchy="false" xref="S3.SS2.p3.2.m2.2.3.3.2.1.cmml">[</mo><mn id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">0</mn><mo id="S3.SS2.p3.2.m2.2.3.3.2.2.2" xref="S3.SS2.p3.2.m2.2.3.3.2.1.cmml">,</mo><mn id="S3.SS2.p3.2.m2.2.2" xref="S3.SS2.p3.2.m2.2.2.cmml">1</mn><mo id="S3.SS2.p3.2.m2.2.3.3.2.2.3" stretchy="false" xref="S3.SS2.p3.2.m2.2.3.3.2.1.cmml">]</mo></mrow><mi id="S3.SS2.p3.2.m2.2.3.3.3" xref="S3.SS2.p3.2.m2.2.3.3.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.2b"><apply id="S3.SS2.p3.2.m2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.3"><in id="S3.SS2.p3.2.m2.2.3.1.cmml" xref="S3.SS2.p3.2.m2.2.3.1"></in><ci id="S3.SS2.p3.2.m2.2.3.2.cmml" xref="S3.SS2.p3.2.m2.2.3.2">𝝎</ci><apply id="S3.SS2.p3.2.m2.2.3.3.cmml" xref="S3.SS2.p3.2.m2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.3.3.1.cmml" xref="S3.SS2.p3.2.m2.2.3.3">superscript</csymbol><interval closure="closed" id="S3.SS2.p3.2.m2.2.3.3.2.1.cmml" xref="S3.SS2.p3.2.m2.2.3.3.2.2"><cn id="S3.SS2.p3.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p3.2.m2.1.1">0</cn><cn id="S3.SS2.p3.2.m2.2.2.cmml" type="integer" xref="S3.SS2.p3.2.m2.2.2">1</cn></interval><ci id="S3.SS2.p3.2.m2.2.3.3.3.cmml" xref="S3.SS2.p3.2.m2.2.3.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.2c">\bm{\omega}\in{[0,1]}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.2d">bold_italic_ω ∈ [ 0 , 1 ] start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> denote the vector composed of the weighting coefficients.
AutoEmb searches for the embedding dimensions of individual features, while AutoDim searches for the embedding dimensions of the feature fields.
In AutoEmb, the controller is a neural network and generates <math alttext="\bm{\omega}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">𝝎</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝝎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\bm{\omega}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">bold_italic_ω</annotation></semantics></math> based on the feature frequency.
While AutoDim directly assigns each field with a learnable vector <math alttext="\bm{\omega}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><mi id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">𝝎</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">𝝎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\bm{\omega}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">bold_italic_ω</annotation></semantics></math>, and it further approximates the hard selection by performing gumbel-softmax <cite class="ltx_cite ltx_citemacro_citep">(Jang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib23" title="">2017</a>)</cite> on <math alttext="\bm{\omega}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">𝝎</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝝎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">\bm{\omega}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">bold_italic_ω</annotation></semantics></math>.
At training, the controller in AutoEmb and the learnable vectors in AutoDim are optimized through DARTS techniques.
After training, the corresponding dimension of the largest weight in <math alttext="\bm{\omega}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">𝝎</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝝎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">\bm{\omega}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">bold_italic_ω</annotation></semantics></math> is selected and the model will be retrained for a better accuracy.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.3">Considering that the training process of the controller is quite time-consuming,
recent works <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib4" title="">2021a</a>; Lyu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib44" title="">2022</a>)</cite> search for the optimal embedding dimensions after training the models, without using any controller.
They first sample some structures from the search space and then explore the entire search space by using evolutionary search strategies on the sampled structures.
Specifically, RULE <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib4" title="">2021a</a>)</cite> cuts the embedding table into <math alttext="G\times B" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">G</mi><mo id="S3.SS2.p4.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p4.1.m1.1.1.1.cmml">×</mo><mi id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><times id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1"></times><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝐺</ci><ci id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">G\times B</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_G × italic_B</annotation></semantics></math> blocks similar as NIS and adds a diversity regularization to the blocks in the same group for maximizing expressiveness.
After training, RULE selects the most suitable embedding blocks under a memory budget (i.e., the maximum number of blocks).
OptEmbed <cite class="ltx_cite ltx_citemacro_citep">(Lyu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib44" title="">2022</a>)</cite> trains a supernet while removing non-informative embeddings.
After training, it then assigns each field with a binary mask <math alttext="\bm{m}\in\{0,1\}^{d}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.2"><semantics id="S3.SS2.p4.2.m2.2a"><mrow id="S3.SS2.p4.2.m2.2.3" xref="S3.SS2.p4.2.m2.2.3.cmml"><mi id="S3.SS2.p4.2.m2.2.3.2" xref="S3.SS2.p4.2.m2.2.3.2.cmml">𝒎</mi><mo id="S3.SS2.p4.2.m2.2.3.1" xref="S3.SS2.p4.2.m2.2.3.1.cmml">∈</mo><msup id="S3.SS2.p4.2.m2.2.3.3" xref="S3.SS2.p4.2.m2.2.3.3.cmml"><mrow id="S3.SS2.p4.2.m2.2.3.3.2.2" xref="S3.SS2.p4.2.m2.2.3.3.2.1.cmml"><mo id="S3.SS2.p4.2.m2.2.3.3.2.2.1" stretchy="false" xref="S3.SS2.p4.2.m2.2.3.3.2.1.cmml">{</mo><mn id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">0</mn><mo id="S3.SS2.p4.2.m2.2.3.3.2.2.2" xref="S3.SS2.p4.2.m2.2.3.3.2.1.cmml">,</mo><mn id="S3.SS2.p4.2.m2.2.2" xref="S3.SS2.p4.2.m2.2.2.cmml">1</mn><mo id="S3.SS2.p4.2.m2.2.3.3.2.2.3" stretchy="false" xref="S3.SS2.p4.2.m2.2.3.3.2.1.cmml">}</mo></mrow><mi id="S3.SS2.p4.2.m2.2.3.3.3" xref="S3.SS2.p4.2.m2.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.2b"><apply id="S3.SS2.p4.2.m2.2.3.cmml" xref="S3.SS2.p4.2.m2.2.3"><in id="S3.SS2.p4.2.m2.2.3.1.cmml" xref="S3.SS2.p4.2.m2.2.3.1"></in><ci id="S3.SS2.p4.2.m2.2.3.2.cmml" xref="S3.SS2.p4.2.m2.2.3.2">𝒎</ci><apply id="S3.SS2.p4.2.m2.2.3.3.cmml" xref="S3.SS2.p4.2.m2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.2.3.3.1.cmml" xref="S3.SS2.p4.2.m2.2.3.3">superscript</csymbol><set id="S3.SS2.p4.2.m2.2.3.3.2.1.cmml" xref="S3.SS2.p4.2.m2.2.3.3.2.2"><cn id="S3.SS2.p4.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p4.2.m2.1.1">0</cn><cn id="S3.SS2.p4.2.m2.2.2.cmml" type="integer" xref="S3.SS2.p4.2.m2.2.2">1</cn></set><ci id="S3.SS2.p4.2.m2.2.3.3.3.cmml" xref="S3.SS2.p4.2.m2.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.2c">\bm{m}\in\{0,1\}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.2d">bold_italic_m ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> to obtain mixed-dimension embeddings, where <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_d</annotation></semantics></math> is the original dimension.
The block selections in RULE and the masks in OptEmbed are determined and evolved by the search strategies.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Pruning</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Instead of shortening the length of embeddings, pruning can obtain a sparse embedding table and thus get mixed-dimension embeddings.
For instance, DeepLight <cite class="ltx_cite ltx_citemacro_citep">(Deng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib11" title="">2021</a>)</cite> prunes the embedding table in a certain proportion.
During training, it prunes and retrains the embedding table alternatively so that the mistakenly pruned weights can grow back.
In addition, DeepLight will increase the pruning proportion gradually as training proceeds.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.16">Another way to prune the embeddings is to train the embeddings with learnable masks.
Specifically, an embedding <math alttext="\bm{e}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">bold_italic_e</annotation></semantics></math> is pruned as <math alttext="\hat{\bm{e}}=\bm{m}\odot\bm{e}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mover accent="true" id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.cmml">𝒆</mi><mo id="S3.SS3.p2.2.m2.1.1.2.1" xref="S3.SS3.p2.2.m2.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.3.2.cmml">𝒎</mi><mo id="S3.SS3.p2.2.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">⊙</mo><mi id="S3.SS3.p2.2.m2.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.3.3.cmml">𝒆</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><eq id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"></eq><apply id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2"><ci id="S3.SS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1">^</ci><ci id="S3.SS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2">𝒆</ci></apply><apply id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"><csymbol cd="latexml" id="S3.SS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3.1">direct-product</csymbol><ci id="S3.SS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.2">𝒎</ci><ci id="S3.SS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3">𝒆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\hat{\bm{e}}=\bm{m}\odot\bm{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">over^ start_ARG bold_italic_e end_ARG = bold_italic_m ⊙ bold_italic_e</annotation></semantics></math> for the forward pass, where <math alttext="\bm{m}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\bm{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">bold_italic_m</annotation></semantics></math> is the mask and <math alttext="\odot" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mo id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><csymbol cd="latexml" id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">⊙</annotation></semantics></math> is the element-wise product.
DNIS <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib8" title="">2020</a>)</cite> divides features into groups by frequency and assigns each group with a learnable mask <math alttext="\bm{m}\in[0,1]^{d}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.2"><semantics id="S3.SS3.p2.5.m5.2a"><mrow id="S3.SS3.p2.5.m5.2.3" xref="S3.SS3.p2.5.m5.2.3.cmml"><mi id="S3.SS3.p2.5.m5.2.3.2" xref="S3.SS3.p2.5.m5.2.3.2.cmml">𝒎</mi><mo id="S3.SS3.p2.5.m5.2.3.1" xref="S3.SS3.p2.5.m5.2.3.1.cmml">∈</mo><msup id="S3.SS3.p2.5.m5.2.3.3" xref="S3.SS3.p2.5.m5.2.3.3.cmml"><mrow id="S3.SS3.p2.5.m5.2.3.3.2.2" xref="S3.SS3.p2.5.m5.2.3.3.2.1.cmml"><mo id="S3.SS3.p2.5.m5.2.3.3.2.2.1" stretchy="false" xref="S3.SS3.p2.5.m5.2.3.3.2.1.cmml">[</mo><mn id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">0</mn><mo id="S3.SS3.p2.5.m5.2.3.3.2.2.2" xref="S3.SS3.p2.5.m5.2.3.3.2.1.cmml">,</mo><mn id="S3.SS3.p2.5.m5.2.2" xref="S3.SS3.p2.5.m5.2.2.cmml">1</mn><mo id="S3.SS3.p2.5.m5.2.3.3.2.2.3" stretchy="false" xref="S3.SS3.p2.5.m5.2.3.3.2.1.cmml">]</mo></mrow><mi id="S3.SS3.p2.5.m5.2.3.3.3" xref="S3.SS3.p2.5.m5.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.2b"><apply id="S3.SS3.p2.5.m5.2.3.cmml" xref="S3.SS3.p2.5.m5.2.3"><in id="S3.SS3.p2.5.m5.2.3.1.cmml" xref="S3.SS3.p2.5.m5.2.3.1"></in><ci id="S3.SS3.p2.5.m5.2.3.2.cmml" xref="S3.SS3.p2.5.m5.2.3.2">𝒎</ci><apply id="S3.SS3.p2.5.m5.2.3.3.cmml" xref="S3.SS3.p2.5.m5.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.2.3.3.1.cmml" xref="S3.SS3.p2.5.m5.2.3.3">superscript</csymbol><interval closure="closed" id="S3.SS3.p2.5.m5.2.3.3.2.1.cmml" xref="S3.SS3.p2.5.m5.2.3.3.2.2"><cn id="S3.SS3.p2.5.m5.1.1.cmml" type="integer" xref="S3.SS3.p2.5.m5.1.1">0</cn><cn id="S3.SS3.p2.5.m5.2.2.cmml" type="integer" xref="S3.SS3.p2.5.m5.2.2">1</cn></interval><ci id="S3.SS3.p2.5.m5.2.3.3.3.cmml" xref="S3.SS3.p2.5.m5.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.2c">\bm{m}\in[0,1]^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.2d">bold_italic_m ∈ [ 0 , 1 ] start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.
AMTL <cite class="ltx_cite ltx_citemacro_citep">(Yan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib69" title="">2021b</a>)</cite> develops a network to generate a binary mask <math alttext="\bm{m}\in\{0,1\}^{d}" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.2"><semantics id="S3.SS3.p2.6.m6.2a"><mrow id="S3.SS3.p2.6.m6.2.3" xref="S3.SS3.p2.6.m6.2.3.cmml"><mi id="S3.SS3.p2.6.m6.2.3.2" xref="S3.SS3.p2.6.m6.2.3.2.cmml">𝒎</mi><mo id="S3.SS3.p2.6.m6.2.3.1" xref="S3.SS3.p2.6.m6.2.3.1.cmml">∈</mo><msup id="S3.SS3.p2.6.m6.2.3.3" xref="S3.SS3.p2.6.m6.2.3.3.cmml"><mrow id="S3.SS3.p2.6.m6.2.3.3.2.2" xref="S3.SS3.p2.6.m6.2.3.3.2.1.cmml"><mo id="S3.SS3.p2.6.m6.2.3.3.2.2.1" stretchy="false" xref="S3.SS3.p2.6.m6.2.3.3.2.1.cmml">{</mo><mn id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">0</mn><mo id="S3.SS3.p2.6.m6.2.3.3.2.2.2" xref="S3.SS3.p2.6.m6.2.3.3.2.1.cmml">,</mo><mn id="S3.SS3.p2.6.m6.2.2" xref="S3.SS3.p2.6.m6.2.2.cmml">1</mn><mo id="S3.SS3.p2.6.m6.2.3.3.2.2.3" stretchy="false" xref="S3.SS3.p2.6.m6.2.3.3.2.1.cmml">}</mo></mrow><mi id="S3.SS3.p2.6.m6.2.3.3.3" xref="S3.SS3.p2.6.m6.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.2b"><apply id="S3.SS3.p2.6.m6.2.3.cmml" xref="S3.SS3.p2.6.m6.2.3"><in id="S3.SS3.p2.6.m6.2.3.1.cmml" xref="S3.SS3.p2.6.m6.2.3.1"></in><ci id="S3.SS3.p2.6.m6.2.3.2.cmml" xref="S3.SS3.p2.6.m6.2.3.2">𝒎</ci><apply id="S3.SS3.p2.6.m6.2.3.3.cmml" xref="S3.SS3.p2.6.m6.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.2.3.3.1.cmml" xref="S3.SS3.p2.6.m6.2.3.3">superscript</csymbol><set id="S3.SS3.p2.6.m6.2.3.3.2.1.cmml" xref="S3.SS3.p2.6.m6.2.3.3.2.2"><cn id="S3.SS3.p2.6.m6.1.1.cmml" type="integer" xref="S3.SS3.p2.6.m6.1.1">0</cn><cn id="S3.SS3.p2.6.m6.2.2.cmml" type="integer" xref="S3.SS3.p2.6.m6.2.2">1</cn></set><ci id="S3.SS3.p2.6.m6.2.3.3.3.cmml" xref="S3.SS3.p2.6.m6.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.2c">\bm{m}\in\{0,1\}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.2d">bold_italic_m ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>
for each feature based on its frequency.
Similarly, PEP <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib42" title="">2021</a>)</cite> generates a binary mask <math alttext="\bm{m}\in\{0,1\}^{d}" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.2"><semantics id="S3.SS3.p2.7.m7.2a"><mrow id="S3.SS3.p2.7.m7.2.3" xref="S3.SS3.p2.7.m7.2.3.cmml"><mi id="S3.SS3.p2.7.m7.2.3.2" xref="S3.SS3.p2.7.m7.2.3.2.cmml">𝒎</mi><mo id="S3.SS3.p2.7.m7.2.3.1" xref="S3.SS3.p2.7.m7.2.3.1.cmml">∈</mo><msup id="S3.SS3.p2.7.m7.2.3.3" xref="S3.SS3.p2.7.m7.2.3.3.cmml"><mrow id="S3.SS3.p2.7.m7.2.3.3.2.2" xref="S3.SS3.p2.7.m7.2.3.3.2.1.cmml"><mo id="S3.SS3.p2.7.m7.2.3.3.2.2.1" stretchy="false" xref="S3.SS3.p2.7.m7.2.3.3.2.1.cmml">{</mo><mn id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">0</mn><mo id="S3.SS3.p2.7.m7.2.3.3.2.2.2" xref="S3.SS3.p2.7.m7.2.3.3.2.1.cmml">,</mo><mn id="S3.SS3.p2.7.m7.2.2" xref="S3.SS3.p2.7.m7.2.2.cmml">1</mn><mo id="S3.SS3.p2.7.m7.2.3.3.2.2.3" stretchy="false" xref="S3.SS3.p2.7.m7.2.3.3.2.1.cmml">}</mo></mrow><mi id="S3.SS3.p2.7.m7.2.3.3.3" xref="S3.SS3.p2.7.m7.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.2b"><apply id="S3.SS3.p2.7.m7.2.3.cmml" xref="S3.SS3.p2.7.m7.2.3"><in id="S3.SS3.p2.7.m7.2.3.1.cmml" xref="S3.SS3.p2.7.m7.2.3.1"></in><ci id="S3.SS3.p2.7.m7.2.3.2.cmml" xref="S3.SS3.p2.7.m7.2.3.2">𝒎</ci><apply id="S3.SS3.p2.7.m7.2.3.3.cmml" xref="S3.SS3.p2.7.m7.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m7.2.3.3.1.cmml" xref="S3.SS3.p2.7.m7.2.3.3">superscript</csymbol><set id="S3.SS3.p2.7.m7.2.3.3.2.1.cmml" xref="S3.SS3.p2.7.m7.2.3.3.2.2"><cn id="S3.SS3.p2.7.m7.1.1.cmml" type="integer" xref="S3.SS3.p2.7.m7.1.1">0</cn><cn id="S3.SS3.p2.7.m7.2.2.cmml" type="integer" xref="S3.SS3.p2.7.m7.2.2">1</cn></set><ci id="S3.SS3.p2.7.m7.2.3.3.3.cmml" xref="S3.SS3.p2.7.m7.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.2c">\bm{m}\in\{0,1\}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.2d">bold_italic_m ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> for each feature as <math alttext="\bm{m}=\mathbb{I}(|\bm{e}|&gt;g(s))" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.3"><semantics id="S3.SS3.p2.8.m8.3a"><mrow id="S3.SS3.p2.8.m8.3.3" xref="S3.SS3.p2.8.m8.3.3.cmml"><mi id="S3.SS3.p2.8.m8.3.3.3" xref="S3.SS3.p2.8.m8.3.3.3.cmml">𝒎</mi><mo id="S3.SS3.p2.8.m8.3.3.2" xref="S3.SS3.p2.8.m8.3.3.2.cmml">=</mo><mrow id="S3.SS3.p2.8.m8.3.3.1" xref="S3.SS3.p2.8.m8.3.3.1.cmml"><mi id="S3.SS3.p2.8.m8.3.3.1.3" xref="S3.SS3.p2.8.m8.3.3.1.3.cmml">𝕀</mi><mo id="S3.SS3.p2.8.m8.3.3.1.2" xref="S3.SS3.p2.8.m8.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.8.m8.3.3.1.1.1" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.cmml"><mo id="S3.SS3.p2.8.m8.3.3.1.1.1.2" stretchy="false" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.8.m8.3.3.1.1.1.1" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.cmml"><mrow id="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.2" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.1.cmml"><mo id="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.2.1" stretchy="false" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.1.1.cmml">|</mo><mi id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml">𝒆</mi><mo id="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.2.2" stretchy="false" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.cmml">&gt;</mo><mrow id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.2" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.2.cmml">g</mi><mo id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.1" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.3.2" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.cmml"><mo id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.cmml">(</mo><mi id="S3.SS3.p2.8.m8.2.2" xref="S3.SS3.p2.8.m8.2.2.cmml">s</mi><mo id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS3.p2.8.m8.3.3.1.1.1.3" stretchy="false" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.3b"><apply id="S3.SS3.p2.8.m8.3.3.cmml" xref="S3.SS3.p2.8.m8.3.3"><eq id="S3.SS3.p2.8.m8.3.3.2.cmml" xref="S3.SS3.p2.8.m8.3.3.2"></eq><ci id="S3.SS3.p2.8.m8.3.3.3.cmml" xref="S3.SS3.p2.8.m8.3.3.3">𝒎</ci><apply id="S3.SS3.p2.8.m8.3.3.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1"><times id="S3.SS3.p2.8.m8.3.3.1.2.cmml" xref="S3.SS3.p2.8.m8.3.3.1.2"></times><ci id="S3.SS3.p2.8.m8.3.3.1.3.cmml" xref="S3.SS3.p2.8.m8.3.3.1.3">𝕀</ci><apply id="S3.SS3.p2.8.m8.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1"><gt id="S3.SS3.p2.8.m8.3.3.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.1"></gt><apply id="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.2"><abs id="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.1.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.2.2.1"></abs><ci id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">𝒆</ci></apply><apply id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3"><times id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.1"></times><ci id="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.8.m8.3.3.1.1.1.1.3.2">𝑔</ci><ci id="S3.SS3.p2.8.m8.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.3c">\bm{m}=\mathbb{I}(|\bm{e}|&gt;g(s))</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m8.3d">bold_italic_m = blackboard_I ( | bold_italic_e | &gt; italic_g ( italic_s ) )</annotation></semantics></math>, where <math alttext="\mathbb{I}(\cdot)" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m9.1"><semantics id="S3.SS3.p2.9.m9.1a"><mrow id="S3.SS3.p2.9.m9.1.2" xref="S3.SS3.p2.9.m9.1.2.cmml"><mi id="S3.SS3.p2.9.m9.1.2.2" xref="S3.SS3.p2.9.m9.1.2.2.cmml">𝕀</mi><mo id="S3.SS3.p2.9.m9.1.2.1" xref="S3.SS3.p2.9.m9.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.9.m9.1.2.3.2" xref="S3.SS3.p2.9.m9.1.2.cmml"><mo id="S3.SS3.p2.9.m9.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.9.m9.1.2.cmml">(</mo><mo id="S3.SS3.p2.9.m9.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p2.9.m9.1.1.cmml">⋅</mo><mo id="S3.SS3.p2.9.m9.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.2.cmml" xref="S3.SS3.p2.9.m9.1.2"><times id="S3.SS3.p2.9.m9.1.2.1.cmml" xref="S3.SS3.p2.9.m9.1.2.1"></times><ci id="S3.SS3.p2.9.m9.1.2.2.cmml" xref="S3.SS3.p2.9.m9.1.2.2">𝕀</ci><ci id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">\mathbb{I}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m9.1d">blackboard_I ( ⋅ )</annotation></semantics></math> is the indicator function and <math alttext="g(s)" class="ltx_Math" display="inline" id="S3.SS3.p2.10.m10.1"><semantics id="S3.SS3.p2.10.m10.1a"><mrow id="S3.SS3.p2.10.m10.1.2" xref="S3.SS3.p2.10.m10.1.2.cmml"><mi id="S3.SS3.p2.10.m10.1.2.2" xref="S3.SS3.p2.10.m10.1.2.2.cmml">g</mi><mo id="S3.SS3.p2.10.m10.1.2.1" xref="S3.SS3.p2.10.m10.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.10.m10.1.2.3.2" xref="S3.SS3.p2.10.m10.1.2.cmml"><mo id="S3.SS3.p2.10.m10.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.10.m10.1.2.cmml">(</mo><mi id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml">s</mi><mo id="S3.SS3.p2.10.m10.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.10.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><apply id="S3.SS3.p2.10.m10.1.2.cmml" xref="S3.SS3.p2.10.m10.1.2"><times id="S3.SS3.p2.10.m10.1.2.1.cmml" xref="S3.SS3.p2.10.m10.1.2.1"></times><ci id="S3.SS3.p2.10.m10.1.2.2.cmml" xref="S3.SS3.p2.10.m10.1.2.2">𝑔</ci><ci id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">g(s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.10.m10.1d">italic_g ( italic_s )</annotation></semantics></math> (e.g., <math alttext="sigmoid(s)" class="ltx_Math" display="inline" id="S3.SS3.p2.11.m11.1"><semantics id="S3.SS3.p2.11.m11.1a"><mrow id="S3.SS3.p2.11.m11.1.2" xref="S3.SS3.p2.11.m11.1.2.cmml"><mi id="S3.SS3.p2.11.m11.1.2.2" xref="S3.SS3.p2.11.m11.1.2.2.cmml">s</mi><mo id="S3.SS3.p2.11.m11.1.2.1" xref="S3.SS3.p2.11.m11.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.11.m11.1.2.3" xref="S3.SS3.p2.11.m11.1.2.3.cmml">i</mi><mo id="S3.SS3.p2.11.m11.1.2.1a" xref="S3.SS3.p2.11.m11.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.11.m11.1.2.4" xref="S3.SS3.p2.11.m11.1.2.4.cmml">g</mi><mo id="S3.SS3.p2.11.m11.1.2.1b" xref="S3.SS3.p2.11.m11.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.11.m11.1.2.5" xref="S3.SS3.p2.11.m11.1.2.5.cmml">m</mi><mo id="S3.SS3.p2.11.m11.1.2.1c" xref="S3.SS3.p2.11.m11.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.11.m11.1.2.6" xref="S3.SS3.p2.11.m11.1.2.6.cmml">o</mi><mo id="S3.SS3.p2.11.m11.1.2.1d" xref="S3.SS3.p2.11.m11.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.11.m11.1.2.7" xref="S3.SS3.p2.11.m11.1.2.7.cmml">i</mi><mo id="S3.SS3.p2.11.m11.1.2.1e" xref="S3.SS3.p2.11.m11.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p2.11.m11.1.2.8" xref="S3.SS3.p2.11.m11.1.2.8.cmml">d</mi><mo id="S3.SS3.p2.11.m11.1.2.1f" xref="S3.SS3.p2.11.m11.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.11.m11.1.2.9.2" xref="S3.SS3.p2.11.m11.1.2.cmml"><mo id="S3.SS3.p2.11.m11.1.2.9.2.1" stretchy="false" xref="S3.SS3.p2.11.m11.1.2.cmml">(</mo><mi id="S3.SS3.p2.11.m11.1.1" xref="S3.SS3.p2.11.m11.1.1.cmml">s</mi><mo id="S3.SS3.p2.11.m11.1.2.9.2.2" stretchy="false" xref="S3.SS3.p2.11.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m11.1b"><apply id="S3.SS3.p2.11.m11.1.2.cmml" xref="S3.SS3.p2.11.m11.1.2"><times id="S3.SS3.p2.11.m11.1.2.1.cmml" xref="S3.SS3.p2.11.m11.1.2.1"></times><ci id="S3.SS3.p2.11.m11.1.2.2.cmml" xref="S3.SS3.p2.11.m11.1.2.2">𝑠</ci><ci id="S3.SS3.p2.11.m11.1.2.3.cmml" xref="S3.SS3.p2.11.m11.1.2.3">𝑖</ci><ci id="S3.SS3.p2.11.m11.1.2.4.cmml" xref="S3.SS3.p2.11.m11.1.2.4">𝑔</ci><ci id="S3.SS3.p2.11.m11.1.2.5.cmml" xref="S3.SS3.p2.11.m11.1.2.5">𝑚</ci><ci id="S3.SS3.p2.11.m11.1.2.6.cmml" xref="S3.SS3.p2.11.m11.1.2.6">𝑜</ci><ci id="S3.SS3.p2.11.m11.1.2.7.cmml" xref="S3.SS3.p2.11.m11.1.2.7">𝑖</ci><ci id="S3.SS3.p2.11.m11.1.2.8.cmml" xref="S3.SS3.p2.11.m11.1.2.8">𝑑</ci><ci id="S3.SS3.p2.11.m11.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m11.1c">sigmoid(s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.11.m11.1d">italic_s italic_i italic_g italic_m italic_o italic_i italic_d ( italic_s )</annotation></semantics></math>) serves as a learnable threshold.
Specially, in PEP, the embeddings should minus <math alttext="g(s)" class="ltx_Math" display="inline" id="S3.SS3.p2.12.m12.1"><semantics id="S3.SS3.p2.12.m12.1a"><mrow id="S3.SS3.p2.12.m12.1.2" xref="S3.SS3.p2.12.m12.1.2.cmml"><mi id="S3.SS3.p2.12.m12.1.2.2" xref="S3.SS3.p2.12.m12.1.2.2.cmml">g</mi><mo id="S3.SS3.p2.12.m12.1.2.1" xref="S3.SS3.p2.12.m12.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.12.m12.1.2.3.2" xref="S3.SS3.p2.12.m12.1.2.cmml"><mo id="S3.SS3.p2.12.m12.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.12.m12.1.2.cmml">(</mo><mi id="S3.SS3.p2.12.m12.1.1" xref="S3.SS3.p2.12.m12.1.1.cmml">s</mi><mo id="S3.SS3.p2.12.m12.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.12.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m12.1b"><apply id="S3.SS3.p2.12.m12.1.2.cmml" xref="S3.SS3.p2.12.m12.1.2"><times id="S3.SS3.p2.12.m12.1.2.1.cmml" xref="S3.SS3.p2.12.m12.1.2.1"></times><ci id="S3.SS3.p2.12.m12.1.2.2.cmml" xref="S3.SS3.p2.12.m12.1.2.2">𝑔</ci><ci id="S3.SS3.p2.12.m12.1.1.cmml" xref="S3.SS3.p2.12.m12.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m12.1c">g(s)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.12.m12.1d">italic_g ( italic_s )</annotation></semantics></math> before being pruned by the masks (i.e. <math alttext="\hat{\bm{e}}=\bm{m}\odot(\bm{e}-g(s))" class="ltx_Math" display="inline" id="S3.SS3.p2.13.m13.2"><semantics id="S3.SS3.p2.13.m13.2a"><mrow id="S3.SS3.p2.13.m13.2.2" xref="S3.SS3.p2.13.m13.2.2.cmml"><mover accent="true" id="S3.SS3.p2.13.m13.2.2.3" xref="S3.SS3.p2.13.m13.2.2.3.cmml"><mi id="S3.SS3.p2.13.m13.2.2.3.2" xref="S3.SS3.p2.13.m13.2.2.3.2.cmml">𝒆</mi><mo id="S3.SS3.p2.13.m13.2.2.3.1" xref="S3.SS3.p2.13.m13.2.2.3.1.cmml">^</mo></mover><mo id="S3.SS3.p2.13.m13.2.2.2" xref="S3.SS3.p2.13.m13.2.2.2.cmml">=</mo><mrow id="S3.SS3.p2.13.m13.2.2.1" xref="S3.SS3.p2.13.m13.2.2.1.cmml"><mi id="S3.SS3.p2.13.m13.2.2.1.3" xref="S3.SS3.p2.13.m13.2.2.1.3.cmml">𝒎</mi><mo id="S3.SS3.p2.13.m13.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.13.m13.2.2.1.2.cmml">⊙</mo><mrow id="S3.SS3.p2.13.m13.2.2.1.1.1" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.cmml"><mo id="S3.SS3.p2.13.m13.2.2.1.1.1.2" stretchy="false" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.13.m13.2.2.1.1.1.1" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.cmml"><mi id="S3.SS3.p2.13.m13.2.2.1.1.1.1.2" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.2.cmml">𝒆</mi><mo id="S3.SS3.p2.13.m13.2.2.1.1.1.1.1" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.1.cmml">−</mo><mrow id="S3.SS3.p2.13.m13.2.2.1.1.1.1.3" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.2" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.2.cmml">g</mi><mo id="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.1" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.3.2" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.cmml"><mo id="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.cmml">(</mo><mi id="S3.SS3.p2.13.m13.1.1" xref="S3.SS3.p2.13.m13.1.1.cmml">s</mi><mo id="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS3.p2.13.m13.2.2.1.1.1.3" stretchy="false" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m13.2b"><apply id="S3.SS3.p2.13.m13.2.2.cmml" xref="S3.SS3.p2.13.m13.2.2"><eq id="S3.SS3.p2.13.m13.2.2.2.cmml" xref="S3.SS3.p2.13.m13.2.2.2"></eq><apply id="S3.SS3.p2.13.m13.2.2.3.cmml" xref="S3.SS3.p2.13.m13.2.2.3"><ci id="S3.SS3.p2.13.m13.2.2.3.1.cmml" xref="S3.SS3.p2.13.m13.2.2.3.1">^</ci><ci id="S3.SS3.p2.13.m13.2.2.3.2.cmml" xref="S3.SS3.p2.13.m13.2.2.3.2">𝒆</ci></apply><apply id="S3.SS3.p2.13.m13.2.2.1.cmml" xref="S3.SS3.p2.13.m13.2.2.1"><csymbol cd="latexml" id="S3.SS3.p2.13.m13.2.2.1.2.cmml" xref="S3.SS3.p2.13.m13.2.2.1.2">direct-product</csymbol><ci id="S3.SS3.p2.13.m13.2.2.1.3.cmml" xref="S3.SS3.p2.13.m13.2.2.1.3">𝒎</ci><apply id="S3.SS3.p2.13.m13.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.13.m13.2.2.1.1.1"><minus id="S3.SS3.p2.13.m13.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.1"></minus><ci id="S3.SS3.p2.13.m13.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.2">𝒆</ci><apply id="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.3"><times id="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.1"></times><ci id="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.13.m13.2.2.1.1.1.1.3.2">𝑔</ci><ci id="S3.SS3.p2.13.m13.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m13.2c">\hat{\bm{e}}=\bm{m}\odot(\bm{e}-g(s))</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.13.m13.2d">over^ start_ARG bold_italic_e end_ARG = bold_italic_m ⊙ ( bold_italic_e - italic_g ( italic_s ) )</annotation></semantics></math>).
At training, the network in AMTL and the learnable threshold in PEP are optimized together with the model parameters by gradient descent, while the learnable masks in DNIS are optimized by DARTS.
After training, AMTL and PEP preserve <math alttext="\hat{\bm{e}}" class="ltx_Math" display="inline" id="S3.SS3.p2.14.m14.1"><semantics id="S3.SS3.p2.14.m14.1a"><mover accent="true" id="S3.SS3.p2.14.m14.1.1" xref="S3.SS3.p2.14.m14.1.1.cmml"><mi id="S3.SS3.p2.14.m14.1.1.2" xref="S3.SS3.p2.14.m14.1.1.2.cmml">𝒆</mi><mo id="S3.SS3.p2.14.m14.1.1.1" xref="S3.SS3.p2.14.m14.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m14.1b"><apply id="S3.SS3.p2.14.m14.1.1.cmml" xref="S3.SS3.p2.14.m14.1.1"><ci id="S3.SS3.p2.14.m14.1.1.1.cmml" xref="S3.SS3.p2.14.m14.1.1.1">^</ci><ci id="S3.SS3.p2.14.m14.1.1.2.cmml" xref="S3.SS3.p2.14.m14.1.1.2">𝒆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m14.1c">\hat{\bm{e}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.14.m14.1d">over^ start_ARG bold_italic_e end_ARG</annotation></semantics></math> as the final embeddings,
while DNIS need pruning <math alttext="\hat{\bm{e}}" class="ltx_Math" display="inline" id="S3.SS3.p2.15.m15.1"><semantics id="S3.SS3.p2.15.m15.1a"><mover accent="true" id="S3.SS3.p2.15.m15.1.1" xref="S3.SS3.p2.15.m15.1.1.cmml"><mi id="S3.SS3.p2.15.m15.1.1.2" xref="S3.SS3.p2.15.m15.1.1.2.cmml">𝒆</mi><mo id="S3.SS3.p2.15.m15.1.1.1" xref="S3.SS3.p2.15.m15.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.15.m15.1b"><apply id="S3.SS3.p2.15.m15.1.1.cmml" xref="S3.SS3.p2.15.m15.1.1"><ci id="S3.SS3.p2.15.m15.1.1.1.cmml" xref="S3.SS3.p2.15.m15.1.1.1">^</ci><ci id="S3.SS3.p2.15.m15.1.1.2.cmml" xref="S3.SS3.p2.15.m15.1.1.2">𝒆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.15.m15.1c">\hat{\bm{e}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.15.m15.1d">over^ start_ARG bold_italic_e end_ARG</annotation></semantics></math> with a threshold as the redundant weights in <math alttext="\hat{\bm{e}}" class="ltx_Math" display="inline" id="S3.SS3.p2.16.m16.1"><semantics id="S3.SS3.p2.16.m16.1a"><mover accent="true" id="S3.SS3.p2.16.m16.1.1" xref="S3.SS3.p2.16.m16.1.1.cmml"><mi id="S3.SS3.p2.16.m16.1.1.2" xref="S3.SS3.p2.16.m16.1.1.2.cmml">𝒆</mi><mo id="S3.SS3.p2.16.m16.1.1.1" xref="S3.SS3.p2.16.m16.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.16.m16.1b"><apply id="S3.SS3.p2.16.m16.1.1.cmml" xref="S3.SS3.p2.16.m16.1.1"><ci id="S3.SS3.p2.16.m16.1.1.1.cmml" xref="S3.SS3.p2.16.m16.1.1.1">^</ci><ci id="S3.SS3.p2.16.m16.1.1.2.cmml" xref="S3.SS3.p2.16.m16.1.1.2">𝒆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.16.m16.1c">\hat{\bm{e}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.16.m16.1d">over^ start_ARG bold_italic_e end_ARG</annotation></semantics></math> are not exact zero. The differences between the above methods in generating masks are summarized in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#algorithm2" title="In 3.3. Pruning ‣ 3. Mixed-Dimension ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="algorithm2">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm2.19">
<div class="ltx_listingline" id="algorithm2.2.2">
<span class="ltx_text" id="algorithm2.2.2.1"><span class="ltx_text ltx_font_bold" id="algorithm2.2.2.1.1">Input:</span> </span>the full-precision embedding <math alttext="\bm{e}" class="ltx_Math" display="inline" id="algorithm2.1.1.m1.1"><semantics id="algorithm2.1.1.m1.1a"><mi id="algorithm2.1.1.m1.1.1" xref="algorithm2.1.1.m1.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="algorithm2.1.1.m1.1b"><ci id="algorithm2.1.1.m1.1.1.cmml" xref="algorithm2.1.1.m1.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.1.1.m1.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.1.1.m1.1d">bold_italic_e</annotation></semantics></math> and feature frequency <math alttext="f" class="ltx_Math" display="inline" id="algorithm2.2.2.m2.1"><semantics id="algorithm2.2.2.m2.1a"><mi id="algorithm2.2.2.m2.1.1" xref="algorithm2.2.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="algorithm2.2.2.m2.1b"><ci id="algorithm2.2.2.m2.1.1.cmml" xref="algorithm2.2.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.2.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="algorithm2.2.2.m2.1d">italic_f</annotation></semantics></math>.
</div>
<div class="ltx_listingline" id="algorithm2.3.3">
<span class="ltx_text" id="algorithm2.3.3.1"><span class="ltx_text ltx_font_bold" id="algorithm2.3.3.1.1">Output:</span> </span>the pruned embedding <math alttext="\hat{\bm{e}}" class="ltx_Math" display="inline" id="algorithm2.3.3.m1.1"><semantics id="algorithm2.3.3.m1.1a"><mover accent="true" id="algorithm2.3.3.m1.1.1" xref="algorithm2.3.3.m1.1.1.cmml"><mi id="algorithm2.3.3.m1.1.1.2" xref="algorithm2.3.3.m1.1.1.2.cmml">𝒆</mi><mo id="algorithm2.3.3.m1.1.1.1" xref="algorithm2.3.3.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="algorithm2.3.3.m1.1b"><apply id="algorithm2.3.3.m1.1.1.cmml" xref="algorithm2.3.3.m1.1.1"><ci id="algorithm2.3.3.m1.1.1.1.cmml" xref="algorithm2.3.3.m1.1.1.1">^</ci><ci id="algorithm2.3.3.m1.1.1.2.cmml" xref="algorithm2.3.3.m1.1.1.2">𝒆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.3.3.m1.1c">\hat{\bm{e}}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.3.3.m1.1d">over^ start_ARG bold_italic_e end_ARG</annotation></semantics></math>.
</div>
<div class="ltx_listingline" id="algorithm2.4.4"> <span class="ltx_text ltx_font_typewriter" id="algorithm2.4.4.1">// </span><math alttext="\hat{e}" class="ltx_Math" display="inline" id="algorithm2.4.4.m1.1"><semantics id="algorithm2.4.4.m1.1a"><mover accent="true" id="algorithm2.4.4.m1.1.1" xref="algorithm2.4.4.m1.1.1.cmml"><mi id="algorithm2.4.4.m1.1.1.2" xref="algorithm2.4.4.m1.1.1.2.cmml">e</mi><mo id="algorithm2.4.4.m1.1.1.1" xref="algorithm2.4.4.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="algorithm2.4.4.m1.1b"><apply id="algorithm2.4.4.m1.1.1.cmml" xref="algorithm2.4.4.m1.1.1"><ci id="algorithm2.4.4.m1.1.1.1.cmml" xref="algorithm2.4.4.m1.1.1.1">^</ci><ci id="algorithm2.4.4.m1.1.1.2.cmml" xref="algorithm2.4.4.m1.1.1.2">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.4.4.m1.1c">\hat{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.4.4.m1.1d">over^ start_ARG italic_e end_ARG</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm2.4.4.2"> will be fed into following networks. </span>
</div>
<div class="ltx_listingline" id="algorithm2.19.20">
</div>
<div class="ltx_listingline" id="algorithm2.19.21">
</div>
<div class="ltx_listingline" id="algorithm2.5.5">
<span class="ltx_text ltx_font_bold" id="algorithm2.5.5.2">Func</span> <em class="ltx_emph ltx_font_typewriter" id="algorithm2.5.5.1">DNIS(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="algorithm2.5.5.1.1.1"><math alttext="\bm{e}" class="ltx_Math" display="inline" id="algorithm2.5.5.1.1.1.m1.1"><semantics id="algorithm2.5.5.1.1.1.m1.1a"><mi id="algorithm2.5.5.1.1.1.m1.1.1" xref="algorithm2.5.5.1.1.1.m1.1.1.cmml">𝐞</mi><annotation-xml encoding="MathML-Content" id="algorithm2.5.5.1.1.1.m1.1b"><ci id="algorithm2.5.5.1.1.1.m1.1.1.cmml" xref="algorithm2.5.5.1.1.1.m1.1.1">𝐞</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.5.5.1.1.1.m1.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.5.5.1.1.1.m1.1d">bold_italic_e</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="algorithm2.5.5.3">:</span>
</div>
<div class="ltx_listingline" id="algorithm2.6.6">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\bm{m}:=[0,1]^{d}" class="ltx_Math" display="inline" id="algorithm2.6.6.m1.2"><semantics id="algorithm2.6.6.m1.2a"><mrow id="algorithm2.6.6.m1.2.3" xref="algorithm2.6.6.m1.2.3.cmml"><mi id="algorithm2.6.6.m1.2.3.2" xref="algorithm2.6.6.m1.2.3.2.cmml">𝒎</mi><mo id="algorithm2.6.6.m1.2.3.1" lspace="0.278em" rspace="0.278em" xref="algorithm2.6.6.m1.2.3.1.cmml">:=</mo><msup id="algorithm2.6.6.m1.2.3.3" xref="algorithm2.6.6.m1.2.3.3.cmml"><mrow id="algorithm2.6.6.m1.2.3.3.2.2" xref="algorithm2.6.6.m1.2.3.3.2.1.cmml"><mo id="algorithm2.6.6.m1.2.3.3.2.2.1" stretchy="false" xref="algorithm2.6.6.m1.2.3.3.2.1.cmml">[</mo><mn id="algorithm2.6.6.m1.1.1" xref="algorithm2.6.6.m1.1.1.cmml">0</mn><mo id="algorithm2.6.6.m1.2.3.3.2.2.2" xref="algorithm2.6.6.m1.2.3.3.2.1.cmml">,</mo><mn id="algorithm2.6.6.m1.2.2" xref="algorithm2.6.6.m1.2.2.cmml">1</mn><mo id="algorithm2.6.6.m1.2.3.3.2.2.3" stretchy="false" xref="algorithm2.6.6.m1.2.3.3.2.1.cmml">]</mo></mrow><mi id="algorithm2.6.6.m1.2.3.3.3" xref="algorithm2.6.6.m1.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.6.6.m1.2b"><apply id="algorithm2.6.6.m1.2.3.cmml" xref="algorithm2.6.6.m1.2.3"><csymbol cd="latexml" id="algorithm2.6.6.m1.2.3.1.cmml" xref="algorithm2.6.6.m1.2.3.1">assign</csymbol><ci id="algorithm2.6.6.m1.2.3.2.cmml" xref="algorithm2.6.6.m1.2.3.2">𝒎</ci><apply id="algorithm2.6.6.m1.2.3.3.cmml" xref="algorithm2.6.6.m1.2.3.3"><csymbol cd="ambiguous" id="algorithm2.6.6.m1.2.3.3.1.cmml" xref="algorithm2.6.6.m1.2.3.3">superscript</csymbol><interval closure="closed" id="algorithm2.6.6.m1.2.3.3.2.1.cmml" xref="algorithm2.6.6.m1.2.3.3.2.2"><cn id="algorithm2.6.6.m1.1.1.cmml" type="integer" xref="algorithm2.6.6.m1.1.1">0</cn><cn id="algorithm2.6.6.m1.2.2.cmml" type="integer" xref="algorithm2.6.6.m1.2.2">1</cn></interval><ci id="algorithm2.6.6.m1.2.3.3.3.cmml" xref="algorithm2.6.6.m1.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.6.6.m1.2c">\bm{m}:=[0,1]^{d}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.6.6.m1.2d">bold_italic_m := [ 0 , 1 ] start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.7.7">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm2.7.7.1">// </span><math alttext="\bm{m}" class="ltx_Math" display="inline" id="algorithm2.7.7.m1.1"><semantics id="algorithm2.7.7.m1.1a"><mi id="algorithm2.7.7.m1.1.1" xref="algorithm2.7.7.m1.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="algorithm2.7.7.m1.1b"><ci id="algorithm2.7.7.m1.1.1.cmml" xref="algorithm2.7.7.m1.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.7.7.m1.1c">\bm{m}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.7.7.m1.1d">bold_italic_m</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm2.7.7.2"> is a learnable mask.</span>
</div>
<div class="ltx_listingline" id="algorithm2.19.22">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.8.8">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\hat{\bm{e}}=\bm{m}\odot\bm{e}" class="ltx_Math" display="inline" id="algorithm2.8.8.m1.1"><semantics id="algorithm2.8.8.m1.1a"><mrow id="algorithm2.8.8.m1.1.1" xref="algorithm2.8.8.m1.1.1.cmml"><mover accent="true" id="algorithm2.8.8.m1.1.1.2" xref="algorithm2.8.8.m1.1.1.2.cmml"><mi id="algorithm2.8.8.m1.1.1.2.2" xref="algorithm2.8.8.m1.1.1.2.2.cmml">𝒆</mi><mo id="algorithm2.8.8.m1.1.1.2.1" xref="algorithm2.8.8.m1.1.1.2.1.cmml">^</mo></mover><mo id="algorithm2.8.8.m1.1.1.1" xref="algorithm2.8.8.m1.1.1.1.cmml">=</mo><mrow id="algorithm2.8.8.m1.1.1.3" xref="algorithm2.8.8.m1.1.1.3.cmml"><mi id="algorithm2.8.8.m1.1.1.3.2" xref="algorithm2.8.8.m1.1.1.3.2.cmml">𝒎</mi><mo id="algorithm2.8.8.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algorithm2.8.8.m1.1.1.3.1.cmml">⊙</mo><mi id="algorithm2.8.8.m1.1.1.3.3" xref="algorithm2.8.8.m1.1.1.3.3.cmml">𝒆</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.8.8.m1.1b"><apply id="algorithm2.8.8.m1.1.1.cmml" xref="algorithm2.8.8.m1.1.1"><eq id="algorithm2.8.8.m1.1.1.1.cmml" xref="algorithm2.8.8.m1.1.1.1"></eq><apply id="algorithm2.8.8.m1.1.1.2.cmml" xref="algorithm2.8.8.m1.1.1.2"><ci id="algorithm2.8.8.m1.1.1.2.1.cmml" xref="algorithm2.8.8.m1.1.1.2.1">^</ci><ci id="algorithm2.8.8.m1.1.1.2.2.cmml" xref="algorithm2.8.8.m1.1.1.2.2">𝒆</ci></apply><apply id="algorithm2.8.8.m1.1.1.3.cmml" xref="algorithm2.8.8.m1.1.1.3"><csymbol cd="latexml" id="algorithm2.8.8.m1.1.1.3.1.cmml" xref="algorithm2.8.8.m1.1.1.3.1">direct-product</csymbol><ci id="algorithm2.8.8.m1.1.1.3.2.cmml" xref="algorithm2.8.8.m1.1.1.3.2">𝒎</ci><ci id="algorithm2.8.8.m1.1.1.3.3.cmml" xref="algorithm2.8.8.m1.1.1.3.3">𝒆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.8.8.m1.1c">\hat{\bm{e}}=\bm{m}\odot\bm{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.8.8.m1.1d">over^ start_ARG bold_italic_e end_ARG = bold_italic_m ⊙ bold_italic_e</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.9.9">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm2.9.9.1">// </span><math alttext="\bm{m}" class="ltx_Math" display="inline" id="algorithm2.9.9.m1.1"><semantics id="algorithm2.9.9.m1.1a"><mi id="algorithm2.9.9.m1.1.1" xref="algorithm2.9.9.m1.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="algorithm2.9.9.m1.1b"><ci id="algorithm2.9.9.m1.1.1.cmml" xref="algorithm2.9.9.m1.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.9.9.m1.1c">\bm{m}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.9.9.m1.1d">bold_italic_m</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm2.9.9.2"> is shared by features with similar frequency.</span>
</div>
<div class="ltx_listingline" id="algorithm2.19.23">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.10.10">
<span class="ltx_text ltx_font_bold" id="algorithm2.10.10.2">Func</span> <em class="ltx_emph ltx_font_typewriter" id="algorithm2.10.10.1">AMTL(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="algorithm2.10.10.1.1.1"><math alttext="\bm{e}" class="ltx_Math" display="inline" id="algorithm2.10.10.1.1.1.m1.1"><semantics id="algorithm2.10.10.1.1.1.m1.1a"><mi id="algorithm2.10.10.1.1.1.m1.1.1" xref="algorithm2.10.10.1.1.1.m1.1.1.cmml">𝐞</mi><annotation-xml encoding="MathML-Content" id="algorithm2.10.10.1.1.1.m1.1b"><ci id="algorithm2.10.10.1.1.1.m1.1.1.cmml" xref="algorithm2.10.10.1.1.1.m1.1.1">𝐞</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.10.10.1.1.1.m1.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.10.10.1.1.1.m1.1d">bold_italic_e</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="algorithm2.10.10.3">:</span>
</div>
<div class="ltx_listingline" id="algorithm2.11.11">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\bm{m}:=amtl(f)" class="ltx_Math" display="inline" id="algorithm2.11.11.m1.1"><semantics id="algorithm2.11.11.m1.1a"><mrow id="algorithm2.11.11.m1.1.2" xref="algorithm2.11.11.m1.1.2.cmml"><mi id="algorithm2.11.11.m1.1.2.2" xref="algorithm2.11.11.m1.1.2.2.cmml">𝒎</mi><mo id="algorithm2.11.11.m1.1.2.1" lspace="0.278em" rspace="0.278em" xref="algorithm2.11.11.m1.1.2.1.cmml">:=</mo><mrow id="algorithm2.11.11.m1.1.2.3" xref="algorithm2.11.11.m1.1.2.3.cmml"><mi id="algorithm2.11.11.m1.1.2.3.2" xref="algorithm2.11.11.m1.1.2.3.2.cmml">a</mi><mo id="algorithm2.11.11.m1.1.2.3.1" xref="algorithm2.11.11.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm2.11.11.m1.1.2.3.3" xref="algorithm2.11.11.m1.1.2.3.3.cmml">m</mi><mo id="algorithm2.11.11.m1.1.2.3.1a" xref="algorithm2.11.11.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm2.11.11.m1.1.2.3.4" xref="algorithm2.11.11.m1.1.2.3.4.cmml">t</mi><mo id="algorithm2.11.11.m1.1.2.3.1b" xref="algorithm2.11.11.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm2.11.11.m1.1.2.3.5" xref="algorithm2.11.11.m1.1.2.3.5.cmml">l</mi><mo id="algorithm2.11.11.m1.1.2.3.1c" xref="algorithm2.11.11.m1.1.2.3.1.cmml">⁢</mo><mrow id="algorithm2.11.11.m1.1.2.3.6.2" xref="algorithm2.11.11.m1.1.2.3.cmml"><mo id="algorithm2.11.11.m1.1.2.3.6.2.1" stretchy="false" xref="algorithm2.11.11.m1.1.2.3.cmml">(</mo><mi id="algorithm2.11.11.m1.1.1" xref="algorithm2.11.11.m1.1.1.cmml">f</mi><mo id="algorithm2.11.11.m1.1.2.3.6.2.2" stretchy="false" xref="algorithm2.11.11.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.11.11.m1.1b"><apply id="algorithm2.11.11.m1.1.2.cmml" xref="algorithm2.11.11.m1.1.2"><csymbol cd="latexml" id="algorithm2.11.11.m1.1.2.1.cmml" xref="algorithm2.11.11.m1.1.2.1">assign</csymbol><ci id="algorithm2.11.11.m1.1.2.2.cmml" xref="algorithm2.11.11.m1.1.2.2">𝒎</ci><apply id="algorithm2.11.11.m1.1.2.3.cmml" xref="algorithm2.11.11.m1.1.2.3"><times id="algorithm2.11.11.m1.1.2.3.1.cmml" xref="algorithm2.11.11.m1.1.2.3.1"></times><ci id="algorithm2.11.11.m1.1.2.3.2.cmml" xref="algorithm2.11.11.m1.1.2.3.2">𝑎</ci><ci id="algorithm2.11.11.m1.1.2.3.3.cmml" xref="algorithm2.11.11.m1.1.2.3.3">𝑚</ci><ci id="algorithm2.11.11.m1.1.2.3.4.cmml" xref="algorithm2.11.11.m1.1.2.3.4">𝑡</ci><ci id="algorithm2.11.11.m1.1.2.3.5.cmml" xref="algorithm2.11.11.m1.1.2.3.5">𝑙</ci><ci id="algorithm2.11.11.m1.1.1.cmml" xref="algorithm2.11.11.m1.1.1">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.11.11.m1.1c">\bm{m}:=amtl(f)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.11.11.m1.1d">bold_italic_m := italic_a italic_m italic_t italic_l ( italic_f )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.14.14">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm2.14.14.3">// </span><math alttext="\bm{m}" class="ltx_Math" display="inline" id="algorithm2.12.12.m1.1"><semantics id="algorithm2.12.12.m1.1a"><mi id="algorithm2.12.12.m1.1.1" xref="algorithm2.12.12.m1.1.1.cmml">𝒎</mi><annotation-xml encoding="MathML-Content" id="algorithm2.12.12.m1.1b"><ci id="algorithm2.12.12.m1.1.1.cmml" xref="algorithm2.12.12.m1.1.1">𝒎</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.12.12.m1.1c">\bm{m}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.12.12.m1.1d">bold_italic_m</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm2.14.14.2"> is generated by a network <math alttext="amtl()" class="ltx_Math" display="inline" id="algorithm2.13.13.1.m1.1"><semantics id="algorithm2.13.13.1.m1.1a"><mrow id="algorithm2.13.13.1.m1.1.1" xref="algorithm2.13.13.1.m1.1.1.cmml"><mi id="algorithm2.13.13.1.m1.1.1.2" xref="algorithm2.13.13.1.m1.1.1.2.cmml">a</mi><mo id="algorithm2.13.13.1.m1.1.1.1" xref="algorithm2.13.13.1.m1.1.1.1.cmml">⁢</mo><mi id="algorithm2.13.13.1.m1.1.1.3" xref="algorithm2.13.13.1.m1.1.1.3.cmml">m</mi><mo id="algorithm2.13.13.1.m1.1.1.1a" xref="algorithm2.13.13.1.m1.1.1.1.cmml">⁢</mo><mi id="algorithm2.13.13.1.m1.1.1.4" xref="algorithm2.13.13.1.m1.1.1.4.cmml">t</mi><mo id="algorithm2.13.13.1.m1.1.1.1b" xref="algorithm2.13.13.1.m1.1.1.1.cmml">⁢</mo><mi id="algorithm2.13.13.1.m1.1.1.5" xref="algorithm2.13.13.1.m1.1.1.5.cmml">l</mi><mo id="algorithm2.13.13.1.m1.1.1.1c" xref="algorithm2.13.13.1.m1.1.1.1.cmml">⁢</mo><mrow id="algorithm2.13.13.1.m1.1.1.6.2" xref="algorithm2.13.13.1.m1.1.1.cmml"><mo id="algorithm2.13.13.1.m1.1.1.6.2.1" stretchy="false" xref="algorithm2.13.13.1.m1.1.1.6.1.cmml">(</mo><mo id="algorithm2.13.13.1.m1.1.1.6.2.2" stretchy="false" xref="algorithm2.13.13.1.m1.1.1.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.13.13.1.m1.1b"><apply id="algorithm2.13.13.1.m1.1.1.cmml" xref="algorithm2.13.13.1.m1.1.1"><times id="algorithm2.13.13.1.m1.1.1.1.cmml" xref="algorithm2.13.13.1.m1.1.1.1"></times><ci id="algorithm2.13.13.1.m1.1.1.2.cmml" xref="algorithm2.13.13.1.m1.1.1.2">𝑎</ci><ci id="algorithm2.13.13.1.m1.1.1.3.cmml" xref="algorithm2.13.13.1.m1.1.1.3">𝑚</ci><ci id="algorithm2.13.13.1.m1.1.1.4.cmml" xref="algorithm2.13.13.1.m1.1.1.4">𝑡</ci><ci id="algorithm2.13.13.1.m1.1.1.5.cmml" xref="algorithm2.13.13.1.m1.1.1.5">𝑙</ci><list id="algorithm2.13.13.1.m1.1.1.6.1.cmml" xref="algorithm2.13.13.1.m1.1.1.6.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.13.13.1.m1.1c">amtl()</annotation><annotation encoding="application/x-llamapun" id="algorithm2.13.13.1.m1.1d">italic_a italic_m italic_t italic_l ( )</annotation></semantics></math> with the frequency <math alttext="f" class="ltx_Math" display="inline" id="algorithm2.14.14.2.m2.1"><semantics id="algorithm2.14.14.2.m2.1a"><mi id="algorithm2.14.14.2.m2.1.1" xref="algorithm2.14.14.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="algorithm2.14.14.2.m2.1b"><ci id="algorithm2.14.14.2.m2.1.1.cmml" xref="algorithm2.14.14.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.14.14.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="algorithm2.14.14.2.m2.1d">italic_f</annotation></semantics></math>.</span>
</div>
<div class="ltx_listingline" id="algorithm2.19.24">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.15.15">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\hat{\bm{e}}=\bm{m}\odot\bm{e}" class="ltx_Math" display="inline" id="algorithm2.15.15.m1.1"><semantics id="algorithm2.15.15.m1.1a"><mrow id="algorithm2.15.15.m1.1.1" xref="algorithm2.15.15.m1.1.1.cmml"><mover accent="true" id="algorithm2.15.15.m1.1.1.2" xref="algorithm2.15.15.m1.1.1.2.cmml"><mi id="algorithm2.15.15.m1.1.1.2.2" xref="algorithm2.15.15.m1.1.1.2.2.cmml">𝒆</mi><mo id="algorithm2.15.15.m1.1.1.2.1" xref="algorithm2.15.15.m1.1.1.2.1.cmml">^</mo></mover><mo id="algorithm2.15.15.m1.1.1.1" xref="algorithm2.15.15.m1.1.1.1.cmml">=</mo><mrow id="algorithm2.15.15.m1.1.1.3" xref="algorithm2.15.15.m1.1.1.3.cmml"><mi id="algorithm2.15.15.m1.1.1.3.2" xref="algorithm2.15.15.m1.1.1.3.2.cmml">𝒎</mi><mo id="algorithm2.15.15.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algorithm2.15.15.m1.1.1.3.1.cmml">⊙</mo><mi id="algorithm2.15.15.m1.1.1.3.3" xref="algorithm2.15.15.m1.1.1.3.3.cmml">𝒆</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.15.15.m1.1b"><apply id="algorithm2.15.15.m1.1.1.cmml" xref="algorithm2.15.15.m1.1.1"><eq id="algorithm2.15.15.m1.1.1.1.cmml" xref="algorithm2.15.15.m1.1.1.1"></eq><apply id="algorithm2.15.15.m1.1.1.2.cmml" xref="algorithm2.15.15.m1.1.1.2"><ci id="algorithm2.15.15.m1.1.1.2.1.cmml" xref="algorithm2.15.15.m1.1.1.2.1">^</ci><ci id="algorithm2.15.15.m1.1.1.2.2.cmml" xref="algorithm2.15.15.m1.1.1.2.2">𝒆</ci></apply><apply id="algorithm2.15.15.m1.1.1.3.cmml" xref="algorithm2.15.15.m1.1.1.3"><csymbol cd="latexml" id="algorithm2.15.15.m1.1.1.3.1.cmml" xref="algorithm2.15.15.m1.1.1.3.1">direct-product</csymbol><ci id="algorithm2.15.15.m1.1.1.3.2.cmml" xref="algorithm2.15.15.m1.1.1.3.2">𝒎</ci><ci id="algorithm2.15.15.m1.1.1.3.3.cmml" xref="algorithm2.15.15.m1.1.1.3.3">𝒆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.15.15.m1.1c">\hat{\bm{e}}=\bm{m}\odot\bm{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.15.15.m1.1d">over^ start_ARG bold_italic_e end_ARG = bold_italic_m ⊙ bold_italic_e</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.16.16">
<span class="ltx_text ltx_font_bold" id="algorithm2.16.16.2">Func</span> <em class="ltx_emph ltx_font_typewriter" id="algorithm2.16.16.1">PEP(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="algorithm2.16.16.1.1.1"><math alttext="\bm{e}" class="ltx_Math" display="inline" id="algorithm2.16.16.1.1.1.m1.1"><semantics id="algorithm2.16.16.1.1.1.m1.1a"><mi id="algorithm2.16.16.1.1.1.m1.1.1" xref="algorithm2.16.16.1.1.1.m1.1.1.cmml">𝐞</mi><annotation-xml encoding="MathML-Content" id="algorithm2.16.16.1.1.1.m1.1b"><ci id="algorithm2.16.16.1.1.1.m1.1.1.cmml" xref="algorithm2.16.16.1.1.1.m1.1.1">𝐞</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.16.16.1.1.1.m1.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.16.16.1.1.1.m1.1d">bold_italic_e</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="algorithm2.16.16.3">:</span>
</div>
<div class="ltx_listingline" id="algorithm2.17.17">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\bm{m}=\mathbb{I}(|\bm{e}|&gt;sigmoid(s))" class="ltx_Math" display="inline" id="algorithm2.17.17.m1.3"><semantics id="algorithm2.17.17.m1.3a"><mrow id="algorithm2.17.17.m1.3.3" xref="algorithm2.17.17.m1.3.3.cmml"><mi id="algorithm2.17.17.m1.3.3.3" xref="algorithm2.17.17.m1.3.3.3.cmml">𝒎</mi><mo id="algorithm2.17.17.m1.3.3.2" xref="algorithm2.17.17.m1.3.3.2.cmml">=</mo><mrow id="algorithm2.17.17.m1.3.3.1" xref="algorithm2.17.17.m1.3.3.1.cmml"><mi id="algorithm2.17.17.m1.3.3.1.3" xref="algorithm2.17.17.m1.3.3.1.3.cmml">𝕀</mi><mo id="algorithm2.17.17.m1.3.3.1.2" xref="algorithm2.17.17.m1.3.3.1.2.cmml">⁢</mo><mrow id="algorithm2.17.17.m1.3.3.1.1.1" xref="algorithm2.17.17.m1.3.3.1.1.1.1.cmml"><mo id="algorithm2.17.17.m1.3.3.1.1.1.2" stretchy="false" xref="algorithm2.17.17.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="algorithm2.17.17.m1.3.3.1.1.1.1" xref="algorithm2.17.17.m1.3.3.1.1.1.1.cmml"><mrow id="algorithm2.17.17.m1.3.3.1.1.1.1.2.2" xref="algorithm2.17.17.m1.3.3.1.1.1.1.2.1.cmml"><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.2.2.1" stretchy="false" xref="algorithm2.17.17.m1.3.3.1.1.1.1.2.1.1.cmml">|</mo><mi id="algorithm2.17.17.m1.1.1" xref="algorithm2.17.17.m1.1.1.cmml">𝒆</mi><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.2.2.2" stretchy="false" xref="algorithm2.17.17.m1.3.3.1.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.1" xref="algorithm2.17.17.m1.3.3.1.1.1.1.1.cmml">&gt;</mo><mrow id="algorithm2.17.17.m1.3.3.1.1.1.1.3" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.cmml"><mi id="algorithm2.17.17.m1.3.3.1.1.1.1.3.2" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.2.cmml">s</mi><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.3.1" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.17.17.m1.3.3.1.1.1.1.3.3" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.3.cmml">i</mi><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.3.1a" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.17.17.m1.3.3.1.1.1.1.3.4" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.4.cmml">g</mi><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.3.1b" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.17.17.m1.3.3.1.1.1.1.3.5" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.5.cmml">m</mi><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.3.1c" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.17.17.m1.3.3.1.1.1.1.3.6" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.6.cmml">o</mi><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.3.1d" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.17.17.m1.3.3.1.1.1.1.3.7" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.7.cmml">i</mi><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.3.1e" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.17.17.m1.3.3.1.1.1.1.3.8" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.8.cmml">d</mi><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.3.1f" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mrow id="algorithm2.17.17.m1.3.3.1.1.1.1.3.9.2" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.cmml"><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.3.9.2.1" stretchy="false" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.cmml">(</mo><mi id="algorithm2.17.17.m1.2.2" xref="algorithm2.17.17.m1.2.2.cmml">s</mi><mo id="algorithm2.17.17.m1.3.3.1.1.1.1.3.9.2.2" stretchy="false" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="algorithm2.17.17.m1.3.3.1.1.1.3" stretchy="false" xref="algorithm2.17.17.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.17.17.m1.3b"><apply id="algorithm2.17.17.m1.3.3.cmml" xref="algorithm2.17.17.m1.3.3"><eq id="algorithm2.17.17.m1.3.3.2.cmml" xref="algorithm2.17.17.m1.3.3.2"></eq><ci id="algorithm2.17.17.m1.3.3.3.cmml" xref="algorithm2.17.17.m1.3.3.3">𝒎</ci><apply id="algorithm2.17.17.m1.3.3.1.cmml" xref="algorithm2.17.17.m1.3.3.1"><times id="algorithm2.17.17.m1.3.3.1.2.cmml" xref="algorithm2.17.17.m1.3.3.1.2"></times><ci id="algorithm2.17.17.m1.3.3.1.3.cmml" xref="algorithm2.17.17.m1.3.3.1.3">𝕀</ci><apply id="algorithm2.17.17.m1.3.3.1.1.1.1.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1"><gt id="algorithm2.17.17.m1.3.3.1.1.1.1.1.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.1"></gt><apply id="algorithm2.17.17.m1.3.3.1.1.1.1.2.1.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.2.2"><abs id="algorithm2.17.17.m1.3.3.1.1.1.1.2.1.1.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.2.2.1"></abs><ci id="algorithm2.17.17.m1.1.1.cmml" xref="algorithm2.17.17.m1.1.1">𝒆</ci></apply><apply id="algorithm2.17.17.m1.3.3.1.1.1.1.3.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3"><times id="algorithm2.17.17.m1.3.3.1.1.1.1.3.1.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.1"></times><ci id="algorithm2.17.17.m1.3.3.1.1.1.1.3.2.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.2">𝑠</ci><ci id="algorithm2.17.17.m1.3.3.1.1.1.1.3.3.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.3">𝑖</ci><ci id="algorithm2.17.17.m1.3.3.1.1.1.1.3.4.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.4">𝑔</ci><ci id="algorithm2.17.17.m1.3.3.1.1.1.1.3.5.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.5">𝑚</ci><ci id="algorithm2.17.17.m1.3.3.1.1.1.1.3.6.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.6">𝑜</ci><ci id="algorithm2.17.17.m1.3.3.1.1.1.1.3.7.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.7">𝑖</ci><ci id="algorithm2.17.17.m1.3.3.1.1.1.1.3.8.cmml" xref="algorithm2.17.17.m1.3.3.1.1.1.1.3.8">𝑑</ci><ci id="algorithm2.17.17.m1.2.2.cmml" xref="algorithm2.17.17.m1.2.2">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.17.17.m1.3c">\bm{m}=\mathbb{I}(|\bm{e}|&gt;sigmoid(s))</annotation><annotation encoding="application/x-llamapun" id="algorithm2.17.17.m1.3d">bold_italic_m = blackboard_I ( | bold_italic_e | &gt; italic_s italic_i italic_g italic_m italic_o italic_i italic_d ( italic_s ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.18.18">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm2.18.18.1">// </span><math alttext="sigmoid(s)" class="ltx_Math" display="inline" id="algorithm2.18.18.m1.1"><semantics id="algorithm2.18.18.m1.1a"><mrow id="algorithm2.18.18.m1.1.2" xref="algorithm2.18.18.m1.1.2.cmml"><mi id="algorithm2.18.18.m1.1.2.2" xref="algorithm2.18.18.m1.1.2.2.cmml">s</mi><mo id="algorithm2.18.18.m1.1.2.1" xref="algorithm2.18.18.m1.1.2.1.cmml">⁢</mo><mi id="algorithm2.18.18.m1.1.2.3" xref="algorithm2.18.18.m1.1.2.3.cmml">i</mi><mo id="algorithm2.18.18.m1.1.2.1a" xref="algorithm2.18.18.m1.1.2.1.cmml">⁢</mo><mi id="algorithm2.18.18.m1.1.2.4" xref="algorithm2.18.18.m1.1.2.4.cmml">g</mi><mo id="algorithm2.18.18.m1.1.2.1b" xref="algorithm2.18.18.m1.1.2.1.cmml">⁢</mo><mi id="algorithm2.18.18.m1.1.2.5" xref="algorithm2.18.18.m1.1.2.5.cmml">m</mi><mo id="algorithm2.18.18.m1.1.2.1c" xref="algorithm2.18.18.m1.1.2.1.cmml">⁢</mo><mi id="algorithm2.18.18.m1.1.2.6" xref="algorithm2.18.18.m1.1.2.6.cmml">o</mi><mo id="algorithm2.18.18.m1.1.2.1d" xref="algorithm2.18.18.m1.1.2.1.cmml">⁢</mo><mi id="algorithm2.18.18.m1.1.2.7" xref="algorithm2.18.18.m1.1.2.7.cmml">i</mi><mo id="algorithm2.18.18.m1.1.2.1e" xref="algorithm2.18.18.m1.1.2.1.cmml">⁢</mo><mi id="algorithm2.18.18.m1.1.2.8" xref="algorithm2.18.18.m1.1.2.8.cmml">d</mi><mo id="algorithm2.18.18.m1.1.2.1f" xref="algorithm2.18.18.m1.1.2.1.cmml">⁢</mo><mrow id="algorithm2.18.18.m1.1.2.9.2" xref="algorithm2.18.18.m1.1.2.cmml"><mo id="algorithm2.18.18.m1.1.2.9.2.1" stretchy="false" xref="algorithm2.18.18.m1.1.2.cmml">(</mo><mi id="algorithm2.18.18.m1.1.1" xref="algorithm2.18.18.m1.1.1.cmml">s</mi><mo id="algorithm2.18.18.m1.1.2.9.2.2" stretchy="false" xref="algorithm2.18.18.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.18.18.m1.1b"><apply id="algorithm2.18.18.m1.1.2.cmml" xref="algorithm2.18.18.m1.1.2"><times id="algorithm2.18.18.m1.1.2.1.cmml" xref="algorithm2.18.18.m1.1.2.1"></times><ci id="algorithm2.18.18.m1.1.2.2.cmml" xref="algorithm2.18.18.m1.1.2.2">𝑠</ci><ci id="algorithm2.18.18.m1.1.2.3.cmml" xref="algorithm2.18.18.m1.1.2.3">𝑖</ci><ci id="algorithm2.18.18.m1.1.2.4.cmml" xref="algorithm2.18.18.m1.1.2.4">𝑔</ci><ci id="algorithm2.18.18.m1.1.2.5.cmml" xref="algorithm2.18.18.m1.1.2.5">𝑚</ci><ci id="algorithm2.18.18.m1.1.2.6.cmml" xref="algorithm2.18.18.m1.1.2.6">𝑜</ci><ci id="algorithm2.18.18.m1.1.2.7.cmml" xref="algorithm2.18.18.m1.1.2.7">𝑖</ci><ci id="algorithm2.18.18.m1.1.2.8.cmml" xref="algorithm2.18.18.m1.1.2.8">𝑑</ci><ci id="algorithm2.18.18.m1.1.1.cmml" xref="algorithm2.18.18.m1.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.18.18.m1.1c">sigmoid(s)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.18.18.m1.1d">italic_s italic_i italic_g italic_m italic_o italic_i italic_d ( italic_s )</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm2.18.18.2"> serves as a learnable threshold.</span>
</div>
<div class="ltx_listingline" id="algorithm2.19.25">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.19.19">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\hat{\bm{e}}=\bm{m}\odot(\bm{e}-sigmoid(s))" class="ltx_Math" display="inline" id="algorithm2.19.19.m1.2"><semantics id="algorithm2.19.19.m1.2a"><mrow id="algorithm2.19.19.m1.2.2" xref="algorithm2.19.19.m1.2.2.cmml"><mover accent="true" id="algorithm2.19.19.m1.2.2.3" xref="algorithm2.19.19.m1.2.2.3.cmml"><mi id="algorithm2.19.19.m1.2.2.3.2" xref="algorithm2.19.19.m1.2.2.3.2.cmml">𝒆</mi><mo id="algorithm2.19.19.m1.2.2.3.1" xref="algorithm2.19.19.m1.2.2.3.1.cmml">^</mo></mover><mo id="algorithm2.19.19.m1.2.2.2" xref="algorithm2.19.19.m1.2.2.2.cmml">=</mo><mrow id="algorithm2.19.19.m1.2.2.1" xref="algorithm2.19.19.m1.2.2.1.cmml"><mi id="algorithm2.19.19.m1.2.2.1.3" xref="algorithm2.19.19.m1.2.2.1.3.cmml">𝒎</mi><mo id="algorithm2.19.19.m1.2.2.1.2" lspace="0.222em" rspace="0.222em" xref="algorithm2.19.19.m1.2.2.1.2.cmml">⊙</mo><mrow id="algorithm2.19.19.m1.2.2.1.1.1" xref="algorithm2.19.19.m1.2.2.1.1.1.1.cmml"><mo id="algorithm2.19.19.m1.2.2.1.1.1.2" stretchy="false" xref="algorithm2.19.19.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="algorithm2.19.19.m1.2.2.1.1.1.1" xref="algorithm2.19.19.m1.2.2.1.1.1.1.cmml"><mi id="algorithm2.19.19.m1.2.2.1.1.1.1.2" xref="algorithm2.19.19.m1.2.2.1.1.1.1.2.cmml">𝒆</mi><mo id="algorithm2.19.19.m1.2.2.1.1.1.1.1" xref="algorithm2.19.19.m1.2.2.1.1.1.1.1.cmml">−</mo><mrow id="algorithm2.19.19.m1.2.2.1.1.1.1.3" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.cmml"><mi id="algorithm2.19.19.m1.2.2.1.1.1.1.3.2" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.2.cmml">s</mi><mo id="algorithm2.19.19.m1.2.2.1.1.1.1.3.1" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.19.19.m1.2.2.1.1.1.1.3.3" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.3.cmml">i</mi><mo id="algorithm2.19.19.m1.2.2.1.1.1.1.3.1a" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.19.19.m1.2.2.1.1.1.1.3.4" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.4.cmml">g</mi><mo id="algorithm2.19.19.m1.2.2.1.1.1.1.3.1b" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.19.19.m1.2.2.1.1.1.1.3.5" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.5.cmml">m</mi><mo id="algorithm2.19.19.m1.2.2.1.1.1.1.3.1c" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.19.19.m1.2.2.1.1.1.1.3.6" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.6.cmml">o</mi><mo id="algorithm2.19.19.m1.2.2.1.1.1.1.3.1d" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.19.19.m1.2.2.1.1.1.1.3.7" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.7.cmml">i</mi><mo id="algorithm2.19.19.m1.2.2.1.1.1.1.3.1e" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.19.19.m1.2.2.1.1.1.1.3.8" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.8.cmml">d</mi><mo id="algorithm2.19.19.m1.2.2.1.1.1.1.3.1f" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mrow id="algorithm2.19.19.m1.2.2.1.1.1.1.3.9.2" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.cmml"><mo id="algorithm2.19.19.m1.2.2.1.1.1.1.3.9.2.1" stretchy="false" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.cmml">(</mo><mi id="algorithm2.19.19.m1.1.1" xref="algorithm2.19.19.m1.1.1.cmml">s</mi><mo id="algorithm2.19.19.m1.2.2.1.1.1.1.3.9.2.2" stretchy="false" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="algorithm2.19.19.m1.2.2.1.1.1.3" stretchy="false" xref="algorithm2.19.19.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.19.19.m1.2b"><apply id="algorithm2.19.19.m1.2.2.cmml" xref="algorithm2.19.19.m1.2.2"><eq id="algorithm2.19.19.m1.2.2.2.cmml" xref="algorithm2.19.19.m1.2.2.2"></eq><apply id="algorithm2.19.19.m1.2.2.3.cmml" xref="algorithm2.19.19.m1.2.2.3"><ci id="algorithm2.19.19.m1.2.2.3.1.cmml" xref="algorithm2.19.19.m1.2.2.3.1">^</ci><ci id="algorithm2.19.19.m1.2.2.3.2.cmml" xref="algorithm2.19.19.m1.2.2.3.2">𝒆</ci></apply><apply id="algorithm2.19.19.m1.2.2.1.cmml" xref="algorithm2.19.19.m1.2.2.1"><csymbol cd="latexml" id="algorithm2.19.19.m1.2.2.1.2.cmml" xref="algorithm2.19.19.m1.2.2.1.2">direct-product</csymbol><ci id="algorithm2.19.19.m1.2.2.1.3.cmml" xref="algorithm2.19.19.m1.2.2.1.3">𝒎</ci><apply id="algorithm2.19.19.m1.2.2.1.1.1.1.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1"><minus id="algorithm2.19.19.m1.2.2.1.1.1.1.1.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1.1.1"></minus><ci id="algorithm2.19.19.m1.2.2.1.1.1.1.2.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1.1.2">𝒆</ci><apply id="algorithm2.19.19.m1.2.2.1.1.1.1.3.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3"><times id="algorithm2.19.19.m1.2.2.1.1.1.1.3.1.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.1"></times><ci id="algorithm2.19.19.m1.2.2.1.1.1.1.3.2.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.2">𝑠</ci><ci id="algorithm2.19.19.m1.2.2.1.1.1.1.3.3.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.3">𝑖</ci><ci id="algorithm2.19.19.m1.2.2.1.1.1.1.3.4.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.4">𝑔</ci><ci id="algorithm2.19.19.m1.2.2.1.1.1.1.3.5.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.5">𝑚</ci><ci id="algorithm2.19.19.m1.2.2.1.1.1.1.3.6.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.6">𝑜</ci><ci id="algorithm2.19.19.m1.2.2.1.1.1.1.3.7.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.7">𝑖</ci><ci id="algorithm2.19.19.m1.2.2.1.1.1.1.3.8.cmml" xref="algorithm2.19.19.m1.2.2.1.1.1.1.3.8">𝑑</ci><ci id="algorithm2.19.19.m1.1.1.cmml" xref="algorithm2.19.19.m1.1.1">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.19.19.m1.2c">\hat{\bm{e}}=\bm{m}\odot(\bm{e}-sigmoid(s))</annotation><annotation encoding="application/x-llamapun" id="algorithm2.19.19.m1.2d">over^ start_ARG bold_italic_e end_ARG = bold_italic_m ⊙ ( bold_italic_e - italic_s italic_i italic_g italic_m italic_o italic_i italic_d ( italic_s ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.19.26">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm2.21.1.1">Algorithm 2</span> </span>Comparison between DNIS <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib8" title="">2020</a>)</cite>, AMTL <cite class="ltx_cite ltx_citemacro_citep">(Yan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib69" title="">2021b</a>)</cite> and PEP <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib42" title="">2021</a>)</cite>. </figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.12">To get rid of the extra training process of optimizing the masks, SSEDS <cite class="ltx_cite ltx_citemacro_citep">(Qu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib49" title="">2022</a>)</cite> develop a single-shot pruning algorithm to prune on the pretrained models. For a pretrained model, SSEDS will prune the columns of the embedding matrix for each field and produce structured embeddings. After training, SSEDS assigns each feature field with a mask and form a mask matrix <math alttext="\mathbf{M}=\{1\}^{\hat{n}\times d}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.2" xref="S3.SS3.p3.1.m1.1.2.cmml"><mi id="S3.SS3.p3.1.m1.1.2.2" xref="S3.SS3.p3.1.m1.1.2.2.cmml">𝐌</mi><mo id="S3.SS3.p3.1.m1.1.2.1" xref="S3.SS3.p3.1.m1.1.2.1.cmml">=</mo><msup id="S3.SS3.p3.1.m1.1.2.3" xref="S3.SS3.p3.1.m1.1.2.3.cmml"><mrow id="S3.SS3.p3.1.m1.1.2.3.2.2" xref="S3.SS3.p3.1.m1.1.2.3.2.1.cmml"><mo id="S3.SS3.p3.1.m1.1.2.3.2.2.1" stretchy="false" xref="S3.SS3.p3.1.m1.1.2.3.2.1.cmml">{</mo><mn id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">1</mn><mo id="S3.SS3.p3.1.m1.1.2.3.2.2.2" stretchy="false" xref="S3.SS3.p3.1.m1.1.2.3.2.1.cmml">}</mo></mrow><mrow id="S3.SS3.p3.1.m1.1.2.3.3" xref="S3.SS3.p3.1.m1.1.2.3.3.cmml"><mover accent="true" id="S3.SS3.p3.1.m1.1.2.3.3.2" xref="S3.SS3.p3.1.m1.1.2.3.3.2.cmml"><mi id="S3.SS3.p3.1.m1.1.2.3.3.2.2" xref="S3.SS3.p3.1.m1.1.2.3.3.2.2.cmml">n</mi><mo id="S3.SS3.p3.1.m1.1.2.3.3.2.1" xref="S3.SS3.p3.1.m1.1.2.3.3.2.1.cmml">^</mo></mover><mo id="S3.SS3.p3.1.m1.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p3.1.m1.1.2.3.3.1.cmml">×</mo><mi id="S3.SS3.p3.1.m1.1.2.3.3.3" xref="S3.SS3.p3.1.m1.1.2.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.2"><eq id="S3.SS3.p3.1.m1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.1.2.1"></eq><ci id="S3.SS3.p3.1.m1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.1.2.2">𝐌</ci><apply id="S3.SS3.p3.1.m1.1.2.3.cmml" xref="S3.SS3.p3.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.2.3.1.cmml" xref="S3.SS3.p3.1.m1.1.2.3">superscript</csymbol><set id="S3.SS3.p3.1.m1.1.2.3.2.1.cmml" xref="S3.SS3.p3.1.m1.1.2.3.2.2"><cn id="S3.SS3.p3.1.m1.1.1.cmml" type="integer" xref="S3.SS3.p3.1.m1.1.1">1</cn></set><apply id="S3.SS3.p3.1.m1.1.2.3.3.cmml" xref="S3.SS3.p3.1.m1.1.2.3.3"><times id="S3.SS3.p3.1.m1.1.2.3.3.1.cmml" xref="S3.SS3.p3.1.m1.1.2.3.3.1"></times><apply id="S3.SS3.p3.1.m1.1.2.3.3.2.cmml" xref="S3.SS3.p3.1.m1.1.2.3.3.2"><ci id="S3.SS3.p3.1.m1.1.2.3.3.2.1.cmml" xref="S3.SS3.p3.1.m1.1.2.3.3.2.1">^</ci><ci id="S3.SS3.p3.1.m1.1.2.3.3.2.2.cmml" xref="S3.SS3.p3.1.m1.1.2.3.3.2.2">𝑛</ci></apply><ci id="S3.SS3.p3.1.m1.1.2.3.3.3.cmml" xref="S3.SS3.p3.1.m1.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\mathbf{M}=\{1\}^{\hat{n}\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">bold_M = { 1 } start_POSTSUPERSCRIPT over^ start_ARG italic_n end_ARG × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\hat{n}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><mover accent="true" id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">n</mi><mo id="S3.SS3.p3.2.m2.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><ci id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1">^</ci><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\hat{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">over^ start_ARG italic_n end_ARG</annotation></semantics></math> is the number of fields and <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">italic_d</annotation></semantics></math> is the original embedding dimension.
Instead of learning <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m4.1"><semantics id="S3.SS3.p3.4.m4.1a"><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m4.1d">bold_M</annotation></semantics></math> in the training process, SSEDS use <math alttext="g_{ij}={\partial f(\mathbf{M},\mathbf{E})}/{\partial\mathbf{M}_{ij}}" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m5.2"><semantics id="S3.SS3.p3.5.m5.2a"><mrow id="S3.SS3.p3.5.m5.2.3" xref="S3.SS3.p3.5.m5.2.3.cmml"><msub id="S3.SS3.p3.5.m5.2.3.2" xref="S3.SS3.p3.5.m5.2.3.2.cmml"><mi id="S3.SS3.p3.5.m5.2.3.2.2" xref="S3.SS3.p3.5.m5.2.3.2.2.cmml">g</mi><mrow id="S3.SS3.p3.5.m5.2.3.2.3" xref="S3.SS3.p3.5.m5.2.3.2.3.cmml"><mi id="S3.SS3.p3.5.m5.2.3.2.3.2" xref="S3.SS3.p3.5.m5.2.3.2.3.2.cmml">i</mi><mo id="S3.SS3.p3.5.m5.2.3.2.3.1" xref="S3.SS3.p3.5.m5.2.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.2.3.2.3.3" xref="S3.SS3.p3.5.m5.2.3.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.p3.5.m5.2.3.1" rspace="0.1389em" xref="S3.SS3.p3.5.m5.2.3.1.cmml">=</mo><mrow id="S3.SS3.p3.5.m5.2.3.3" xref="S3.SS3.p3.5.m5.2.3.3.cmml"><mo id="S3.SS3.p3.5.m5.2.3.3.1" lspace="0.1389em" rspace="0em" xref="S3.SS3.p3.5.m5.2.3.3.1.cmml">∂</mo><mrow id="S3.SS3.p3.5.m5.2.3.3.2" xref="S3.SS3.p3.5.m5.2.3.3.2.cmml"><mrow id="S3.SS3.p3.5.m5.2.3.3.2.2" xref="S3.SS3.p3.5.m5.2.3.3.2.2.cmml"><mi id="S3.SS3.p3.5.m5.2.3.3.2.2.2" xref="S3.SS3.p3.5.m5.2.3.3.2.2.2.cmml">f</mi><mo id="S3.SS3.p3.5.m5.2.3.3.2.2.1" xref="S3.SS3.p3.5.m5.2.3.3.2.2.1.cmml">⁢</mo><mrow id="S3.SS3.p3.5.m5.2.3.3.2.2.3.2" xref="S3.SS3.p3.5.m5.2.3.3.2.2.3.1.cmml"><mo id="S3.SS3.p3.5.m5.2.3.3.2.2.3.2.1" stretchy="false" xref="S3.SS3.p3.5.m5.2.3.3.2.2.3.1.cmml">(</mo><mi id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">𝐌</mi><mo id="S3.SS3.p3.5.m5.2.3.3.2.2.3.2.2" xref="S3.SS3.p3.5.m5.2.3.3.2.2.3.1.cmml">,</mo><mi id="S3.SS3.p3.5.m5.2.2" xref="S3.SS3.p3.5.m5.2.2.cmml">𝐄</mi><mo id="S3.SS3.p3.5.m5.2.3.3.2.2.3.2.3" stretchy="false" xref="S3.SS3.p3.5.m5.2.3.3.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.5.m5.2.3.3.2.1" xref="S3.SS3.p3.5.m5.2.3.3.2.1.cmml">/</mo><mrow id="S3.SS3.p3.5.m5.2.3.3.2.3" xref="S3.SS3.p3.5.m5.2.3.3.2.3.cmml"><mo id="S3.SS3.p3.5.m5.2.3.3.2.3.1" lspace="0em" rspace="0em" xref="S3.SS3.p3.5.m5.2.3.3.2.3.1.cmml">∂</mo><msub id="S3.SS3.p3.5.m5.2.3.3.2.3.2" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2.cmml"><mi id="S3.SS3.p3.5.m5.2.3.3.2.3.2.2" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2.2.cmml">𝐌</mi><mrow id="S3.SS3.p3.5.m5.2.3.3.2.3.2.3" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.cmml"><mi id="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.2" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.2.cmml">i</mi><mo id="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.1" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.3" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.2b"><apply id="S3.SS3.p3.5.m5.2.3.cmml" xref="S3.SS3.p3.5.m5.2.3"><eq id="S3.SS3.p3.5.m5.2.3.1.cmml" xref="S3.SS3.p3.5.m5.2.3.1"></eq><apply id="S3.SS3.p3.5.m5.2.3.2.cmml" xref="S3.SS3.p3.5.m5.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.2.3.2.1.cmml" xref="S3.SS3.p3.5.m5.2.3.2">subscript</csymbol><ci id="S3.SS3.p3.5.m5.2.3.2.2.cmml" xref="S3.SS3.p3.5.m5.2.3.2.2">𝑔</ci><apply id="S3.SS3.p3.5.m5.2.3.2.3.cmml" xref="S3.SS3.p3.5.m5.2.3.2.3"><times id="S3.SS3.p3.5.m5.2.3.2.3.1.cmml" xref="S3.SS3.p3.5.m5.2.3.2.3.1"></times><ci id="S3.SS3.p3.5.m5.2.3.2.3.2.cmml" xref="S3.SS3.p3.5.m5.2.3.2.3.2">𝑖</ci><ci id="S3.SS3.p3.5.m5.2.3.2.3.3.cmml" xref="S3.SS3.p3.5.m5.2.3.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS3.p3.5.m5.2.3.3.cmml" xref="S3.SS3.p3.5.m5.2.3.3"><partialdiff id="S3.SS3.p3.5.m5.2.3.3.1.cmml" xref="S3.SS3.p3.5.m5.2.3.3.1"></partialdiff><apply id="S3.SS3.p3.5.m5.2.3.3.2.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2"><divide id="S3.SS3.p3.5.m5.2.3.3.2.1.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.1"></divide><apply id="S3.SS3.p3.5.m5.2.3.3.2.2.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.2"><times id="S3.SS3.p3.5.m5.2.3.3.2.2.1.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.2.1"></times><ci id="S3.SS3.p3.5.m5.2.3.3.2.2.2.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.2.2">𝑓</ci><interval closure="open" id="S3.SS3.p3.5.m5.2.3.3.2.2.3.1.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.2.3.2"><ci id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">𝐌</ci><ci id="S3.SS3.p3.5.m5.2.2.cmml" xref="S3.SS3.p3.5.m5.2.2">𝐄</ci></interval></apply><apply id="S3.SS3.p3.5.m5.2.3.3.2.3.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.3"><partialdiff id="S3.SS3.p3.5.m5.2.3.3.2.3.1.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.3.1"></partialdiff><apply id="S3.SS3.p3.5.m5.2.3.3.2.3.2.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.2.3.3.2.3.2.1.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2">subscript</csymbol><ci id="S3.SS3.p3.5.m5.2.3.3.2.3.2.2.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2.2">𝐌</ci><apply id="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2.3"><times id="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.1.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.1"></times><ci id="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.2.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.2">𝑖</ci><ci id="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.3.cmml" xref="S3.SS3.p3.5.m5.2.3.3.2.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.2c">g_{ij}={\partial f(\mathbf{M},\mathbf{E})}/{\partial\mathbf{M}_{ij}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m5.2d">italic_g start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = ∂ italic_f ( bold_M , bold_E ) / ∂ bold_M start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to identify the importance of <math alttext="j" class="ltx_Math" display="inline" id="S3.SS3.p3.6.m6.1"><semantics id="S3.SS3.p3.6.m6.1a"><mi id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><ci id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.6.m6.1d">italic_j</annotation></semantics></math>-th dimension in <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p3.7.m7.1"><semantics id="S3.SS3.p3.7.m7.1a"><mi id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><ci id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.7.m7.1d">italic_i</annotation></semantics></math>-th field,
where <math alttext="g_{ij}" class="ltx_Math" display="inline" id="S3.SS3.p3.8.m8.1"><semantics id="S3.SS3.p3.8.m8.1a"><msub id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml"><mi id="S3.SS3.p3.8.m8.1.1.2" xref="S3.SS3.p3.8.m8.1.1.2.cmml">g</mi><mrow id="S3.SS3.p3.8.m8.1.1.3" xref="S3.SS3.p3.8.m8.1.1.3.cmml"><mi id="S3.SS3.p3.8.m8.1.1.3.2" xref="S3.SS3.p3.8.m8.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.8.m8.1.1.3.1" xref="S3.SS3.p3.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.8.m8.1.1.3.3" xref="S3.SS3.p3.8.m8.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.1b"><apply id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m8.1.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p3.8.m8.1.1.2.cmml" xref="S3.SS3.p3.8.m8.1.1.2">𝑔</ci><apply id="S3.SS3.p3.8.m8.1.1.3.cmml" xref="S3.SS3.p3.8.m8.1.1.3"><times id="S3.SS3.p3.8.m8.1.1.3.1.cmml" xref="S3.SS3.p3.8.m8.1.1.3.1"></times><ci id="S3.SS3.p3.8.m8.1.1.3.2.cmml" xref="S3.SS3.p3.8.m8.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.8.m8.1.1.3.3.cmml" xref="S3.SS3.p3.8.m8.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.1c">g_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.8.m8.1d">italic_g start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the gradient of the loss function with respect to <math alttext="\mathbf{M}_{ij}" class="ltx_Math" display="inline" id="S3.SS3.p3.9.m9.1"><semantics id="S3.SS3.p3.9.m9.1a"><msub id="S3.SS3.p3.9.m9.1.1" xref="S3.SS3.p3.9.m9.1.1.cmml"><mi id="S3.SS3.p3.9.m9.1.1.2" xref="S3.SS3.p3.9.m9.1.1.2.cmml">𝐌</mi><mrow id="S3.SS3.p3.9.m9.1.1.3" xref="S3.SS3.p3.9.m9.1.1.3.cmml"><mi id="S3.SS3.p3.9.m9.1.1.3.2" xref="S3.SS3.p3.9.m9.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.9.m9.1.1.3.1" xref="S3.SS3.p3.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.9.m9.1.1.3.3" xref="S3.SS3.p3.9.m9.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m9.1b"><apply id="S3.SS3.p3.9.m9.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m9.1.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p3.9.m9.1.1.2.cmml" xref="S3.SS3.p3.9.m9.1.1.2">𝐌</ci><apply id="S3.SS3.p3.9.m9.1.1.3.cmml" xref="S3.SS3.p3.9.m9.1.1.3"><times id="S3.SS3.p3.9.m9.1.1.3.1.cmml" xref="S3.SS3.p3.9.m9.1.1.3.1"></times><ci id="S3.SS3.p3.9.m9.1.1.3.2.cmml" xref="S3.SS3.p3.9.m9.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.9.m9.1.1.3.3.cmml" xref="S3.SS3.p3.9.m9.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m9.1c">\mathbf{M}_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.9.m9.1d">bold_M start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
Specifically, a larger magnitude of <math alttext="|g_{ij}|" class="ltx_Math" display="inline" id="S3.SS3.p3.10.m10.1"><semantics id="S3.SS3.p3.10.m10.1a"><mrow id="S3.SS3.p3.10.m10.1.1.1" xref="S3.SS3.p3.10.m10.1.1.2.cmml"><mo id="S3.SS3.p3.10.m10.1.1.1.2" stretchy="false" xref="S3.SS3.p3.10.m10.1.1.2.1.cmml">|</mo><msub id="S3.SS3.p3.10.m10.1.1.1.1" xref="S3.SS3.p3.10.m10.1.1.1.1.cmml"><mi id="S3.SS3.p3.10.m10.1.1.1.1.2" xref="S3.SS3.p3.10.m10.1.1.1.1.2.cmml">g</mi><mrow id="S3.SS3.p3.10.m10.1.1.1.1.3" xref="S3.SS3.p3.10.m10.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.10.m10.1.1.1.1.3.2" xref="S3.SS3.p3.10.m10.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.10.m10.1.1.1.1.3.1" xref="S3.SS3.p3.10.m10.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.10.m10.1.1.1.1.3.3" xref="S3.SS3.p3.10.m10.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.p3.10.m10.1.1.1.3" stretchy="false" xref="S3.SS3.p3.10.m10.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m10.1b"><apply id="S3.SS3.p3.10.m10.1.1.2.cmml" xref="S3.SS3.p3.10.m10.1.1.1"><abs id="S3.SS3.p3.10.m10.1.1.2.1.cmml" xref="S3.SS3.p3.10.m10.1.1.1.2"></abs><apply id="S3.SS3.p3.10.m10.1.1.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m10.1.1.1.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.10.m10.1.1.1.1.2.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1.2">𝑔</ci><apply id="S3.SS3.p3.10.m10.1.1.1.1.3.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1.3"><times id="S3.SS3.p3.10.m10.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1.3.1"></times><ci id="S3.SS3.p3.10.m10.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.10.m10.1.1.1.1.3.3.cmml" xref="S3.SS3.p3.10.m10.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m10.1c">|g_{ij}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.10.m10.1d">| italic_g start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT |</annotation></semantics></math> means that the corresponding dimension has a greater impact on the loss function.
Note that all <math alttext="|g_{ij}|" class="ltx_Math" display="inline" id="S3.SS3.p3.11.m11.1"><semantics id="S3.SS3.p3.11.m11.1a"><mrow id="S3.SS3.p3.11.m11.1.1.1" xref="S3.SS3.p3.11.m11.1.1.2.cmml"><mo id="S3.SS3.p3.11.m11.1.1.1.2" stretchy="false" xref="S3.SS3.p3.11.m11.1.1.2.1.cmml">|</mo><msub id="S3.SS3.p3.11.m11.1.1.1.1" xref="S3.SS3.p3.11.m11.1.1.1.1.cmml"><mi id="S3.SS3.p3.11.m11.1.1.1.1.2" xref="S3.SS3.p3.11.m11.1.1.1.1.2.cmml">g</mi><mrow id="S3.SS3.p3.11.m11.1.1.1.1.3" xref="S3.SS3.p3.11.m11.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.11.m11.1.1.1.1.3.2" xref="S3.SS3.p3.11.m11.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.11.m11.1.1.1.1.3.1" xref="S3.SS3.p3.11.m11.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.11.m11.1.1.1.1.3.3" xref="S3.SS3.p3.11.m11.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.p3.11.m11.1.1.1.3" stretchy="false" xref="S3.SS3.p3.11.m11.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m11.1b"><apply id="S3.SS3.p3.11.m11.1.1.2.cmml" xref="S3.SS3.p3.11.m11.1.1.1"><abs id="S3.SS3.p3.11.m11.1.1.2.1.cmml" xref="S3.SS3.p3.11.m11.1.1.1.2"></abs><apply id="S3.SS3.p3.11.m11.1.1.1.1.cmml" xref="S3.SS3.p3.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.11.m11.1.1.1.1.1.cmml" xref="S3.SS3.p3.11.m11.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.11.m11.1.1.1.1.2.cmml" xref="S3.SS3.p3.11.m11.1.1.1.1.2">𝑔</ci><apply id="S3.SS3.p3.11.m11.1.1.1.1.3.cmml" xref="S3.SS3.p3.11.m11.1.1.1.1.3"><times id="S3.SS3.p3.11.m11.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.11.m11.1.1.1.1.3.1"></times><ci id="S3.SS3.p3.11.m11.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.11.m11.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.11.m11.1.1.1.1.3.3.cmml" xref="S3.SS3.p3.11.m11.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m11.1c">|g_{ij}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.11.m11.1d">| italic_g start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT |</annotation></semantics></math> can be computed efficiently via only one forward-backward pass.
Given a memory budget, SSEDS calculates a saliency score for each dimension as <math alttext="s_{ij}={|g_{ij}|}/{\sum_{i=0}^{\hat{n}}\sum_{j=0}^{d}|g_{ij}|}" class="ltx_Math" display="inline" id="S3.SS3.p3.12.m12.2"><semantics id="S3.SS3.p3.12.m12.2a"><mrow id="S3.SS3.p3.12.m12.2.2" xref="S3.SS3.p3.12.m12.2.2.cmml"><msub id="S3.SS3.p3.12.m12.2.2.4" xref="S3.SS3.p3.12.m12.2.2.4.cmml"><mi id="S3.SS3.p3.12.m12.2.2.4.2" xref="S3.SS3.p3.12.m12.2.2.4.2.cmml">s</mi><mrow id="S3.SS3.p3.12.m12.2.2.4.3" xref="S3.SS3.p3.12.m12.2.2.4.3.cmml"><mi id="S3.SS3.p3.12.m12.2.2.4.3.2" xref="S3.SS3.p3.12.m12.2.2.4.3.2.cmml">i</mi><mo id="S3.SS3.p3.12.m12.2.2.4.3.1" xref="S3.SS3.p3.12.m12.2.2.4.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.12.m12.2.2.4.3.3" xref="S3.SS3.p3.12.m12.2.2.4.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.p3.12.m12.2.2.3" xref="S3.SS3.p3.12.m12.2.2.3.cmml">=</mo><mrow id="S3.SS3.p3.12.m12.2.2.2" xref="S3.SS3.p3.12.m12.2.2.2.cmml"><mrow id="S3.SS3.p3.12.m12.1.1.1.1.1" xref="S3.SS3.p3.12.m12.1.1.1.1.2.cmml"><mo id="S3.SS3.p3.12.m12.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.12.m12.1.1.1.1.2.1.cmml">|</mo><msub id="S3.SS3.p3.12.m12.1.1.1.1.1.1" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.12.m12.1.1.1.1.1.1.2" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1.2.cmml">g</mi><mrow id="S3.SS3.p3.12.m12.1.1.1.1.1.1.3" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.2" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.1" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.3" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.p3.12.m12.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.12.m12.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS3.p3.12.m12.2.2.2.3" rspace="0.055em" xref="S3.SS3.p3.12.m12.2.2.2.3.cmml">/</mo><mrow id="S3.SS3.p3.12.m12.2.2.2.2" xref="S3.SS3.p3.12.m12.2.2.2.2.cmml"><msubsup id="S3.SS3.p3.12.m12.2.2.2.2.2" xref="S3.SS3.p3.12.m12.2.2.2.2.2.cmml"><mo id="S3.SS3.p3.12.m12.2.2.2.2.2.2.2" rspace="0em" xref="S3.SS3.p3.12.m12.2.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.SS3.p3.12.m12.2.2.2.2.2.2.3" xref="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.2" xref="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.1" xref="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.3" xref="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.3.cmml">0</mn></mrow><mover accent="true" id="S3.SS3.p3.12.m12.2.2.2.2.2.3" xref="S3.SS3.p3.12.m12.2.2.2.2.2.3.cmml"><mi id="S3.SS3.p3.12.m12.2.2.2.2.2.3.2" xref="S3.SS3.p3.12.m12.2.2.2.2.2.3.2.cmml">n</mi><mo id="S3.SS3.p3.12.m12.2.2.2.2.2.3.1" xref="S3.SS3.p3.12.m12.2.2.2.2.2.3.1.cmml">^</mo></mover></msubsup><mrow id="S3.SS3.p3.12.m12.2.2.2.2.1" xref="S3.SS3.p3.12.m12.2.2.2.2.1.cmml"><msubsup id="S3.SS3.p3.12.m12.2.2.2.2.1.2" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.cmml"><mo id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.2" rspace="0em" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.2.cmml">∑</mo><mrow id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.cmml"><mi id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.2" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.2.cmml">j</mi><mo id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.1" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.1.cmml">=</mo><mn id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.3" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.3.cmml">0</mn></mrow><mi id="S3.SS3.p3.12.m12.2.2.2.2.1.2.3" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.3.cmml">d</mi></msubsup><mrow id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.2.cmml"><mo id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.2" stretchy="false" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.2.1.cmml">|</mo><msub id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.cmml"><mi id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.2" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.2.cmml">g</mi><mrow id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.2" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.1" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.3" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.3" stretchy="false" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.12.m12.2b"><apply id="S3.SS3.p3.12.m12.2.2.cmml" xref="S3.SS3.p3.12.m12.2.2"><eq id="S3.SS3.p3.12.m12.2.2.3.cmml" xref="S3.SS3.p3.12.m12.2.2.3"></eq><apply id="S3.SS3.p3.12.m12.2.2.4.cmml" xref="S3.SS3.p3.12.m12.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m12.2.2.4.1.cmml" xref="S3.SS3.p3.12.m12.2.2.4">subscript</csymbol><ci id="S3.SS3.p3.12.m12.2.2.4.2.cmml" xref="S3.SS3.p3.12.m12.2.2.4.2">𝑠</ci><apply id="S3.SS3.p3.12.m12.2.2.4.3.cmml" xref="S3.SS3.p3.12.m12.2.2.4.3"><times id="S3.SS3.p3.12.m12.2.2.4.3.1.cmml" xref="S3.SS3.p3.12.m12.2.2.4.3.1"></times><ci id="S3.SS3.p3.12.m12.2.2.4.3.2.cmml" xref="S3.SS3.p3.12.m12.2.2.4.3.2">𝑖</ci><ci id="S3.SS3.p3.12.m12.2.2.4.3.3.cmml" xref="S3.SS3.p3.12.m12.2.2.4.3.3">𝑗</ci></apply></apply><apply id="S3.SS3.p3.12.m12.2.2.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2"><divide id="S3.SS3.p3.12.m12.2.2.2.3.cmml" xref="S3.SS3.p3.12.m12.2.2.2.3"></divide><apply id="S3.SS3.p3.12.m12.1.1.1.1.2.cmml" xref="S3.SS3.p3.12.m12.1.1.1.1.1"><abs id="S3.SS3.p3.12.m12.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.12.m12.1.1.1.1.1.2"></abs><apply id="S3.SS3.p3.12.m12.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m12.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.12.m12.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1.2">𝑔</ci><apply id="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1.3"><times id="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.1"></times><ci id="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p3.12.m12.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.SS3.p3.12.m12.2.2.2.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2"><apply id="S3.SS3.p3.12.m12.2.2.2.2.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m12.2.2.2.2.2.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.2">superscript</csymbol><apply id="S3.SS3.p3.12.m12.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m12.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.2">subscript</csymbol><sum id="S3.SS3.p3.12.m12.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.2.2.2"></sum><apply id="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.2.2.3"><eq id="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.1"></eq><ci id="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.2">𝑖</ci><cn id="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS3.p3.12.m12.2.2.2.2.2.2.3.3">0</cn></apply></apply><apply id="S3.SS3.p3.12.m12.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.2.3"><ci id="S3.SS3.p3.12.m12.2.2.2.2.2.3.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.2.3.1">^</ci><ci id="S3.SS3.p3.12.m12.2.2.2.2.2.3.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.2.3.2">𝑛</ci></apply></apply><apply id="S3.SS3.p3.12.m12.2.2.2.2.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1"><apply id="S3.SS3.p3.12.m12.2.2.2.2.1.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m12.2.2.2.2.1.2.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2">superscript</csymbol><apply id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2">subscript</csymbol><sum id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.2"></sum><apply id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3"><eq id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.1"></eq><ci id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.2">𝑗</ci><cn id="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.3.cmml" type="integer" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.2.3.3">0</cn></apply></apply><ci id="S3.SS3.p3.12.m12.2.2.2.2.1.2.3.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.2.3">𝑑</ci></apply><apply id="S3.SS3.p3.12.m12.2.2.2.2.1.1.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1"><abs id="S3.SS3.p3.12.m12.2.2.2.2.1.1.2.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.2"></abs><apply id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.2">𝑔</ci><apply id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3"><times id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.1"></times><ci id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.3.cmml" xref="S3.SS3.p3.12.m12.2.2.2.2.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.12.m12.2c">s_{ij}={|g_{ij}|}/{\sum_{i=0}^{\hat{n}}\sum_{j=0}^{d}|g_{ij}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.12.m12.2d">italic_s start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = | italic_g start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | / ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_n end_ARG end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT | italic_g start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT |</annotation></semantics></math> and prunes the dimensions with the lowest saliency scores.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Discussion</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Mixed-dimension approaches can alleviate the overfitting problems and obtain better accuracy,
but usually have worse efficiency at the training and the inference stage.
At inference, the structured approaches usually suffer from extra computing cost due to the linear transformation
and the unstructured approaches store the sparse embedding table using <span class="ltx_text ltx_font_italic" id="S3.SS4.p1.1.1">sparse matrix storage</span>, which will cost extra effort to access.
At training, NAS-based approaches require extremely long time for searching and pruning usually needs to retrain the pruned models for better accuracy which doubles the training time.
In contrast, rule-based approaches have little influence on the efficiency and can save memory also at the training stage. However, they cannot achieve the optimal accuracy.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Weight-Sharing</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Low-precision approaches reduce the number of bits in a weight and mixed-dimension approaches reduce the number of weights in an embedding.
Unlike them, weight-sharing approaches share weights among the embedding table, thereby reducing the actual number of parameters within it.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.5">Existing weight-sharing approaches usually generate embeddings with several shared vectors.
In this section, we relax the definition of weight-sharing and formulate a weight-sharing paradigm based on existing approaches.
Specifically, the embedding generation is formulated as <math alttext="\bm{e}=\bigcup/\sum_{i=1}^{s}\bm{I}^{i}\times\mathbf{T}^{i}" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">𝒆</mi><mo id="S4.p2.1.m1.1.1.1" rspace="0.111em" xref="S4.p2.1.m1.1.1.1.cmml">=</mo><mrow id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml"><mo id="S4.p2.1.m1.1.1.3.2" rspace="0em" xref="S4.p2.1.m1.1.1.3.2.cmml">⋃</mo><mo id="S4.p2.1.m1.1.1.3.1" lspace="0em" rspace="0.055em" xref="S4.p2.1.m1.1.1.3.1.cmml">/</mo><mrow id="S4.p2.1.m1.1.1.3.3" xref="S4.p2.1.m1.1.1.3.3.cmml"><msubsup id="S4.p2.1.m1.1.1.3.3.1" xref="S4.p2.1.m1.1.1.3.3.1.cmml"><mo id="S4.p2.1.m1.1.1.3.3.1.2.2" xref="S4.p2.1.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S4.p2.1.m1.1.1.3.3.1.2.3" xref="S4.p2.1.m1.1.1.3.3.1.2.3.cmml"><mi id="S4.p2.1.m1.1.1.3.3.1.2.3.2" xref="S4.p2.1.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S4.p2.1.m1.1.1.3.3.1.2.3.1" xref="S4.p2.1.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S4.p2.1.m1.1.1.3.3.1.2.3.3" xref="S4.p2.1.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.p2.1.m1.1.1.3.3.1.3" xref="S4.p2.1.m1.1.1.3.3.1.3.cmml">s</mi></msubsup><mrow id="S4.p2.1.m1.1.1.3.3.2" xref="S4.p2.1.m1.1.1.3.3.2.cmml"><msup id="S4.p2.1.m1.1.1.3.3.2.2" xref="S4.p2.1.m1.1.1.3.3.2.2.cmml"><mi id="S4.p2.1.m1.1.1.3.3.2.2.2" xref="S4.p2.1.m1.1.1.3.3.2.2.2.cmml">𝑰</mi><mi id="S4.p2.1.m1.1.1.3.3.2.2.3" xref="S4.p2.1.m1.1.1.3.3.2.2.3.cmml">i</mi></msup><mo id="S4.p2.1.m1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.p2.1.m1.1.1.3.3.2.1.cmml">×</mo><msup id="S4.p2.1.m1.1.1.3.3.2.3" xref="S4.p2.1.m1.1.1.3.3.2.3.cmml"><mi id="S4.p2.1.m1.1.1.3.3.2.3.2" xref="S4.p2.1.m1.1.1.3.3.2.3.2.cmml">𝐓</mi><mi id="S4.p2.1.m1.1.1.3.3.2.3.3" xref="S4.p2.1.m1.1.1.3.3.2.3.3.cmml">i</mi></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><eq id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1"></eq><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">𝒆</ci><apply id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3"><divide id="S4.p2.1.m1.1.1.3.1.cmml" xref="S4.p2.1.m1.1.1.3.1"></divide><union id="S4.p2.1.m1.1.1.3.2.cmml" xref="S4.p2.1.m1.1.1.3.2"></union><apply id="S4.p2.1.m1.1.1.3.3.cmml" xref="S4.p2.1.m1.1.1.3.3"><apply id="S4.p2.1.m1.1.1.3.3.1.cmml" xref="S4.p2.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.3.3.1.1.cmml" xref="S4.p2.1.m1.1.1.3.3.1">superscript</csymbol><apply id="S4.p2.1.m1.1.1.3.3.1.2.cmml" xref="S4.p2.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.3.3.1.2.1.cmml" xref="S4.p2.1.m1.1.1.3.3.1">subscript</csymbol><sum id="S4.p2.1.m1.1.1.3.3.1.2.2.cmml" xref="S4.p2.1.m1.1.1.3.3.1.2.2"></sum><apply id="S4.p2.1.m1.1.1.3.3.1.2.3.cmml" xref="S4.p2.1.m1.1.1.3.3.1.2.3"><eq id="S4.p2.1.m1.1.1.3.3.1.2.3.1.cmml" xref="S4.p2.1.m1.1.1.3.3.1.2.3.1"></eq><ci id="S4.p2.1.m1.1.1.3.3.1.2.3.2.cmml" xref="S4.p2.1.m1.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S4.p2.1.m1.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S4.p2.1.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.p2.1.m1.1.1.3.3.1.3.cmml" xref="S4.p2.1.m1.1.1.3.3.1.3">𝑠</ci></apply><apply id="S4.p2.1.m1.1.1.3.3.2.cmml" xref="S4.p2.1.m1.1.1.3.3.2"><times id="S4.p2.1.m1.1.1.3.3.2.1.cmml" xref="S4.p2.1.m1.1.1.3.3.2.1"></times><apply id="S4.p2.1.m1.1.1.3.3.2.2.cmml" xref="S4.p2.1.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.3.3.2.2.1.cmml" xref="S4.p2.1.m1.1.1.3.3.2.2">superscript</csymbol><ci id="S4.p2.1.m1.1.1.3.3.2.2.2.cmml" xref="S4.p2.1.m1.1.1.3.3.2.2.2">𝑰</ci><ci id="S4.p2.1.m1.1.1.3.3.2.2.3.cmml" xref="S4.p2.1.m1.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="S4.p2.1.m1.1.1.3.3.2.3.cmml" xref="S4.p2.1.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.3.3.2.3.1.cmml" xref="S4.p2.1.m1.1.1.3.3.2.3">superscript</csymbol><ci id="S4.p2.1.m1.1.1.3.3.2.3.2.cmml" xref="S4.p2.1.m1.1.1.3.3.2.3.2">𝐓</ci><ci id="S4.p2.1.m1.1.1.3.3.2.3.3.cmml" xref="S4.p2.1.m1.1.1.3.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\bm{e}=\bigcup/\sum_{i=1}^{s}\bm{I}^{i}\times\mathbf{T}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">bold_italic_e = ⋃ / ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT bold_italic_I start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT × bold_T start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>,
where <math alttext="\bigcup/\sum" class="ltx_Math" display="inline" id="S4.p2.2.m2.1"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mo id="S4.p2.2.m2.1.1.2" rspace="0em" xref="S4.p2.2.m2.1.1.2.cmml">⋃</mo><mo id="S4.p2.2.m2.1.1.1" lspace="0em" rspace="0.055em" xref="S4.p2.2.m2.1.1.1.cmml">/</mo><mo id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml">∑</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><divide id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1"></divide><union id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2"></union><sum id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3"></sum></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">\bigcup/\sum</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.1d">⋃ / ∑</annotation></semantics></math> denotes concatenation or summation, <math alttext="\mathbf{T}^{i}" class="ltx_Math" display="inline" id="S4.p2.3.m3.1"><semantics id="S4.p2.3.m3.1a"><msup id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mi id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">𝐓</mi><mi id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1">superscript</csymbol><ci id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2">𝐓</ci><ci id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">\mathbf{T}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.3.m3.1d">bold_T start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is a matrix composed of shared vectors and <math alttext="\bm{I}^{i}" class="ltx_Math" display="inline" id="S4.p2.4.m4.1"><semantics id="S4.p2.4.m4.1a"><msup id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml"><mi id="S4.p2.4.m4.1.1.2" xref="S4.p2.4.m4.1.1.2.cmml">𝑰</mi><mi id="S4.p2.4.m4.1.1.3" xref="S4.p2.4.m4.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><apply id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.1.cmml" xref="S4.p2.4.m4.1.1">superscript</csymbol><ci id="S4.p2.4.m4.1.1.2.cmml" xref="S4.p2.4.m4.1.1.2">𝑰</ci><ci id="S4.p2.4.m4.1.1.3.cmml" xref="S4.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">\bm{I}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.4.m4.1d">bold_italic_I start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is an index vector for selecting shared vectors in <math alttext="\mathbf{T}^{i}" class="ltx_Math" display="inline" id="S4.p2.5.m5.1"><semantics id="S4.p2.5.m5.1a"><msup id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml"><mi id="S4.p2.5.m5.1.1.2" xref="S4.p2.5.m5.1.1.2.cmml">𝐓</mi><mi id="S4.p2.5.m5.1.1.3" xref="S4.p2.5.m5.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><apply id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p2.5.m5.1.1.1.cmml" xref="S4.p2.5.m5.1.1">superscript</csymbol><ci id="S4.p2.5.m5.1.1.2.cmml" xref="S4.p2.5.m5.1.1.2">𝐓</ci><ci id="S4.p2.5.m5.1.1.3.cmml" xref="S4.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">\mathbf{T}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.5.m5.1d">bold_T start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>.
For ease of expression, we refer to the shared vectors as meta-embeddings and the matrices of shared vectors as meta-tables.
According to the principle of constructing the index vectors, we introduce three kinds of weight-sharing methods named <span class="ltx_text ltx_font_bold" id="S4.p2.5.1">hashing</span>, <span class="ltx_text ltx_font_bold" id="S4.p2.5.2">vector quantization</span>, and <span class="ltx_text ltx_font_bold" id="S4.p2.5.3">decomposition</span>, respectively.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Hashing</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.6">Hashing methods generate the index vectors by processing the original feature id with hash functions.
For instance, the naive hashing method <cite class="ltx_cite ltx_citemacro_citep">(Weinberger et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib61" title="">2009</a>)</cite> compresses the embedding table with a simple hash function (e.g., the reminder function).
Specifically, given the original size of the embedding table <math alttext="n\times d" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">n</mi><mo id="S4.SS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.1.m1.1.1.1.cmml">×</mo><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><times id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></times><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑛</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">n\times d</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_n × italic_d</annotation></semantics></math>, each feature has an embedding <math alttext="\bm{e}=\bm{I}\times\mathbf{T}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">𝒆</mi><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3.2" xref="S4.SS1.p1.2.m2.1.1.3.2.cmml">𝑰</mi><mo id="S4.SS1.p1.2.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.2.m2.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p1.2.m2.1.1.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.cmml">𝐓</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><eq id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></eq><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝒆</ci><apply id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3"><times id="S4.SS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3.1"></times><ci id="S4.SS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.2">𝑰</ci><ci id="S4.SS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3">𝐓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\bm{e}=\bm{I}\times\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">bold_italic_e = bold_italic_I × bold_T</annotation></semantics></math>,
where <math alttext="\mathbf{T}\in\operatorname*{\mathbb{R}}^{m\times d}(m&lt;n)" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.2"><semantics id="S4.SS1.p1.3.m3.2a"><mrow id="S4.SS1.p1.3.m3.2.2" xref="S4.SS1.p1.3.m3.2.2.cmml"><mi id="S4.SS1.p1.3.m3.2.2.4" xref="S4.SS1.p1.3.m3.2.2.4.cmml">𝐓</mi><mo id="S4.SS1.p1.3.m3.2.2.3" rspace="0.1389em" xref="S4.SS1.p1.3.m3.2.2.3.cmml">∈</mo><mrow id="S4.SS1.p1.3.m3.2.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.3.cmml"><msup id="S4.SS1.p1.3.m3.1.1.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.1.1.cmml"><mo id="S4.SS1.p1.3.m3.1.1.1.1.1.2" lspace="0.1389em" rspace="0em" xref="S4.SS1.p1.3.m3.1.1.1.1.1.2.cmml">ℝ</mo><mrow id="S4.SS1.p1.3.m3.1.1.1.1.1.3" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p1.3.m3.1.1.1.1.1.3.2" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3.2.cmml">m</mi><mo id="S4.SS1.p1.3.m3.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p1.3.m3.1.1.1.1.1.3.3" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3.3.cmml">d</mi></mrow></msup><mrow id="S4.SS1.p1.3.m3.2.2.2.2.2" xref="S4.SS1.p1.3.m3.2.2.2.3.cmml"><mo id="S4.SS1.p1.3.m3.2.2.2.2.2.2" stretchy="false" xref="S4.SS1.p1.3.m3.2.2.2.3.cmml">(</mo><mrow id="S4.SS1.p1.3.m3.2.2.2.2.2.1" xref="S4.SS1.p1.3.m3.2.2.2.2.2.1.cmml"><mi id="S4.SS1.p1.3.m3.2.2.2.2.2.1.2" xref="S4.SS1.p1.3.m3.2.2.2.2.2.1.2.cmml">m</mi><mo id="S4.SS1.p1.3.m3.2.2.2.2.2.1.1" xref="S4.SS1.p1.3.m3.2.2.2.2.2.1.1.cmml">&lt;</mo><mi id="S4.SS1.p1.3.m3.2.2.2.2.2.1.3" xref="S4.SS1.p1.3.m3.2.2.2.2.2.1.3.cmml">n</mi></mrow><mo id="S4.SS1.p1.3.m3.2.2.2.2.2.3" stretchy="false" xref="S4.SS1.p1.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.2b"><apply id="S4.SS1.p1.3.m3.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2"><in id="S4.SS1.p1.3.m3.2.2.3.cmml" xref="S4.SS1.p1.3.m3.2.2.3"></in><ci id="S4.SS1.p1.3.m3.2.2.4.cmml" xref="S4.SS1.p1.3.m3.2.2.4">𝐓</ci><apply id="S4.SS1.p1.3.m3.2.2.2.3.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2"><apply id="S4.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1.2">ℝ</ci><apply id="S4.SS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3"><times id="S4.SS1.p1.3.m3.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3.1"></times><ci id="S4.SS1.p1.3.m3.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3.2">𝑚</ci><ci id="S4.SS1.p1.3.m3.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p1.3.m3.1.1.1.1.1.3.3">𝑑</ci></apply></apply><apply id="S4.SS1.p1.3.m3.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2.1"><lt id="S4.SS1.p1.3.m3.2.2.2.2.2.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2.1.1"></lt><ci id="S4.SS1.p1.3.m3.2.2.2.2.2.1.2.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2.1.2">𝑚</ci><ci id="S4.SS1.p1.3.m3.2.2.2.2.2.1.3.cmml" xref="S4.SS1.p1.3.m3.2.2.2.2.2.1.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.2c">\mathbf{T}\in\operatorname*{\mathbb{R}}^{m\times d}(m&lt;n)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.2d">bold_T ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT ( italic_m &lt; italic_n )</annotation></semantics></math> and <math alttext="\bm{I}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}\%m)\in\{0,1\}^{m}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.4"><semantics id="S4.SS1.p1.4.m4.4a"><mrow id="S4.SS1.p1.4.m4.4.4" xref="S4.SS1.p1.4.m4.4.4.cmml"><mi id="S4.SS1.p1.4.m4.4.4.3" xref="S4.SS1.p1.4.m4.4.4.3.cmml">𝑰</mi><mo id="S4.SS1.p1.4.m4.4.4.4" xref="S4.SS1.p1.4.m4.4.4.4.cmml">=</mo><mrow id="S4.SS1.p1.4.m4.4.4.1.1" xref="S4.SS1.p1.4.m4.4.4.1.2.cmml"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">one</mi><mo id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">−</mo><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">hot</mi></mrow><mo id="S4.SS1.p1.4.m4.4.4.1.1a" xref="S4.SS1.p1.4.m4.4.4.1.2.cmml">⁡</mo><mrow id="S4.SS1.p1.4.m4.4.4.1.1.1" xref="S4.SS1.p1.4.m4.4.4.1.2.cmml"><mo id="S4.SS1.p1.4.m4.4.4.1.1.1.2" stretchy="false" xref="S4.SS1.p1.4.m4.4.4.1.2.cmml">(</mo><mrow id="S4.SS1.p1.4.m4.4.4.1.1.1.1" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1.cmml"><mrow id="S4.SS1.p1.4.m4.4.4.1.1.1.1.1" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.2" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.2a.cmml">id</mtext><mo id="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.1" lspace="0.167em" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.1.cmml">%</mo></mrow><mo id="S4.SS1.p1.4.m4.4.4.1.1.1.1a" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1.cmml">⁡</mo><mi id="S4.SS1.p1.4.m4.4.4.1.1.1.1.2" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1.2.cmml">m</mi></mrow><mo id="S4.SS1.p1.4.m4.4.4.1.1.1.3" stretchy="false" xref="S4.SS1.p1.4.m4.4.4.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.4.m4.4.4.5" xref="S4.SS1.p1.4.m4.4.4.5.cmml">∈</mo><msup id="S4.SS1.p1.4.m4.4.4.6" xref="S4.SS1.p1.4.m4.4.4.6.cmml"><mrow id="S4.SS1.p1.4.m4.4.4.6.2.2" xref="S4.SS1.p1.4.m4.4.4.6.2.1.cmml"><mo id="S4.SS1.p1.4.m4.4.4.6.2.2.1" stretchy="false" xref="S4.SS1.p1.4.m4.4.4.6.2.1.cmml">{</mo><mn id="S4.SS1.p1.4.m4.2.2" xref="S4.SS1.p1.4.m4.2.2.cmml">0</mn><mo id="S4.SS1.p1.4.m4.4.4.6.2.2.2" xref="S4.SS1.p1.4.m4.4.4.6.2.1.cmml">,</mo><mn id="S4.SS1.p1.4.m4.3.3" xref="S4.SS1.p1.4.m4.3.3.cmml">1</mn><mo id="S4.SS1.p1.4.m4.4.4.6.2.2.3" stretchy="false" xref="S4.SS1.p1.4.m4.4.4.6.2.1.cmml">}</mo></mrow><mi id="S4.SS1.p1.4.m4.4.4.6.3" xref="S4.SS1.p1.4.m4.4.4.6.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.4b"><apply id="S4.SS1.p1.4.m4.4.4.cmml" xref="S4.SS1.p1.4.m4.4.4"><and id="S4.SS1.p1.4.m4.4.4a.cmml" xref="S4.SS1.p1.4.m4.4.4"></and><apply id="S4.SS1.p1.4.m4.4.4b.cmml" xref="S4.SS1.p1.4.m4.4.4"><eq id="S4.SS1.p1.4.m4.4.4.4.cmml" xref="S4.SS1.p1.4.m4.4.4.4"></eq><ci id="S4.SS1.p1.4.m4.4.4.3.cmml" xref="S4.SS1.p1.4.m4.4.4.3">𝑰</ci><apply id="S4.SS1.p1.4.m4.4.4.1.2.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><minus id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></minus><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">one</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">hot</ci></apply><apply id="S4.SS1.p1.4.m4.4.4.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1"><apply id="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.1">percent</csymbol><ci id="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.2a.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1.1.2">id</mtext></ci></apply><ci id="S4.SS1.p1.4.m4.4.4.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.4.4.1.1.1.1.2">𝑚</ci></apply></apply></apply><apply id="S4.SS1.p1.4.m4.4.4c.cmml" xref="S4.SS1.p1.4.m4.4.4"><in id="S4.SS1.p1.4.m4.4.4.5.cmml" xref="S4.SS1.p1.4.m4.4.4.5"></in><share href="https://arxiv.org/html/2408.02304v1#S4.SS1.p1.4.m4.4.4.1.cmml" id="S4.SS1.p1.4.m4.4.4d.cmml" xref="S4.SS1.p1.4.m4.4.4"></share><apply id="S4.SS1.p1.4.m4.4.4.6.cmml" xref="S4.SS1.p1.4.m4.4.4.6"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.4.4.6.1.cmml" xref="S4.SS1.p1.4.m4.4.4.6">superscript</csymbol><set id="S4.SS1.p1.4.m4.4.4.6.2.1.cmml" xref="S4.SS1.p1.4.m4.4.4.6.2.2"><cn id="S4.SS1.p1.4.m4.2.2.cmml" type="integer" xref="S4.SS1.p1.4.m4.2.2">0</cn><cn id="S4.SS1.p1.4.m4.3.3.cmml" type="integer" xref="S4.SS1.p1.4.m4.3.3">1</cn></set><ci id="S4.SS1.p1.4.m4.4.4.6.3.cmml" xref="S4.SS1.p1.4.m4.4.4.6.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.4c">\bm{I}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}\%m)\in\{0,1\}^{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.4d">bold_italic_I = start_OPERATOR roman_one - roman_hot end_OPERATOR ( id % italic_m ) ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>.
Note that <math alttext="\bm{I}\times\mathbf{T}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">𝑰</mi><mo id="S4.SS1.p1.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p1.5.m5.1.1.1.cmml">×</mo><mi id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">𝐓</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><times id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></times><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">𝑰</ci><ci id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\bm{I}\times\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">bold_italic_I × bold_T</annotation></semantics></math> is actually achieved by table look-up when <math alttext="\bm{I}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">𝑰</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑰</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\bm{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">bold_italic_I</annotation></semantics></math> is a one-hot vector.
However, <cite class="ltx_cite ltx_citemacro_citep">(Weinberger et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib61" title="">2009</a>)</cite> naively maps multiple features to the same embedding. The collisions between features will result in loss of information and drop of accuracy.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="algorithm3">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm3.24">
<div class="ltx_listingline" id="algorithm3.1.1">
<span class="ltx_text" id="algorithm3.1.1.1"><span class="ltx_text ltx_font_bold" id="algorithm3.1.1.1.1">Input:</span> </span>the feature id <math alttext="(\operatorname*{\texttt{id}}\leq n)" class="ltx_Math" display="inline" id="algorithm3.1.1.m1.1"><semantics id="algorithm3.1.1.m1.1a"><mrow id="algorithm3.1.1.m1.1.1.1" xref="algorithm3.1.1.m1.1.1.1.1.cmml"><mo id="algorithm3.1.1.m1.1.1.1.2" stretchy="false" xref="algorithm3.1.1.m1.1.1.1.1.cmml">(</mo><mrow id="algorithm3.1.1.m1.1.1.1.1" xref="algorithm3.1.1.m1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm3.1.1.m1.1.1.1.1.2" xref="algorithm3.1.1.m1.1.1.1.1.2a.cmml">id</mtext><mo id="algorithm3.1.1.m1.1.1.1.1.1" xref="algorithm3.1.1.m1.1.1.1.1.1.cmml">≤</mo><mi id="algorithm3.1.1.m1.1.1.1.1.3" xref="algorithm3.1.1.m1.1.1.1.1.3.cmml">n</mi></mrow><mo id="algorithm3.1.1.m1.1.1.1.3" stretchy="false" xref="algorithm3.1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.1.1.m1.1b"><apply id="algorithm3.1.1.m1.1.1.1.1.cmml" xref="algorithm3.1.1.m1.1.1.1"><leq id="algorithm3.1.1.m1.1.1.1.1.1.cmml" xref="algorithm3.1.1.m1.1.1.1.1.1"></leq><ci id="algorithm3.1.1.m1.1.1.1.1.2a.cmml" xref="algorithm3.1.1.m1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="algorithm3.1.1.m1.1.1.1.1.2.cmml" xref="algorithm3.1.1.m1.1.1.1.1.2">id</mtext></ci><ci id="algorithm3.1.1.m1.1.1.1.1.3.cmml" xref="algorithm3.1.1.m1.1.1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.1.1.m1.1c">(\operatorname*{\texttt{id}}\leq n)</annotation><annotation encoding="application/x-llamapun" id="algorithm3.1.1.m1.1d">( id ≤ italic_n )</annotation></semantics></math>.
</div>
<div class="ltx_listingline" id="algorithm3.2.2">
<span class="ltx_text" id="algorithm3.2.2.1"><span class="ltx_text ltx_font_bold" id="algorithm3.2.2.1.1">Output:</span> </span>the generated embedding <math alttext="\hat{\bm{e}}" class="ltx_Math" display="inline" id="algorithm3.2.2.m1.1"><semantics id="algorithm3.2.2.m1.1a"><mover accent="true" id="algorithm3.2.2.m1.1.1" xref="algorithm3.2.2.m1.1.1.cmml"><mi id="algorithm3.2.2.m1.1.1.2" xref="algorithm3.2.2.m1.1.1.2.cmml">𝒆</mi><mo id="algorithm3.2.2.m1.1.1.1" xref="algorithm3.2.2.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="algorithm3.2.2.m1.1b"><apply id="algorithm3.2.2.m1.1.1.cmml" xref="algorithm3.2.2.m1.1.1"><ci id="algorithm3.2.2.m1.1.1.1.cmml" xref="algorithm3.2.2.m1.1.1.1">^</ci><ci id="algorithm3.2.2.m1.1.1.2.cmml" xref="algorithm3.2.2.m1.1.1.2">𝒆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.2.2.m1.1c">\hat{\bm{e}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.2.2.m1.1d">over^ start_ARG bold_italic_e end_ARG</annotation></semantics></math>.
</div>
<div class="ltx_listingline" id="algorithm3.3.3">  <span class="ltx_text ltx_font_typewriter" id="algorithm3.3.3.1">// </span><math alttext="\hat{e}" class="ltx_Math" display="inline" id="algorithm3.3.3.m1.1"><semantics id="algorithm3.3.3.m1.1a"><mover accent="true" id="algorithm3.3.3.m1.1.1" xref="algorithm3.3.3.m1.1.1.cmml"><mi id="algorithm3.3.3.m1.1.1.2" xref="algorithm3.3.3.m1.1.1.2.cmml">e</mi><mo id="algorithm3.3.3.m1.1.1.1" xref="algorithm3.3.3.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="algorithm3.3.3.m1.1b"><apply id="algorithm3.3.3.m1.1.1.cmml" xref="algorithm3.3.3.m1.1.1"><ci id="algorithm3.3.3.m1.1.1.1.cmml" xref="algorithm3.3.3.m1.1.1.1">^</ci><ci id="algorithm3.3.3.m1.1.1.2.cmml" xref="algorithm3.3.3.m1.1.1.2">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.3.3.m1.1c">\hat{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.3.3.m1.1d">over^ start_ARG italic_e end_ARG</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm3.3.3.2"> will be fed into following networks.</span>
</div>
<div class="ltx_listingline" id="algorithm3.24.25">
</div>
<div class="ltx_listingline" id="algorithm3.24.26">
</div>
<div class="ltx_listingline" id="algorithm3.4.4">
<span class="ltx_text ltx_font_bold" id="algorithm3.4.4.2">Func</span> <em class="ltx_emph ltx_font_typewriter" id="algorithm3.4.4.1">QR(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="algorithm3.4.4.1.1.1"><math alttext="\operatorname*{\texttt{id}}" class="ltx_Math" display="inline" id="algorithm3.4.4.1.1.1.m1.1"><semantics id="algorithm3.4.4.1.1.1.m1.1a"><mtext class="ltx_mathvariant_monospace" id="algorithm3.4.4.1.1.1.m1.1.1" xref="algorithm3.4.4.1.1.1.m1.1.1b.cmml"><em class="ltx_emph ltx_font_typewriter" id="algorithm3.4.4.1.1.1.m1.1.1.1nest">id</em></mtext><annotation-xml encoding="MathML-Content" id="algorithm3.4.4.1.1.1.m1.1b"><ci id="algorithm3.4.4.1.1.1.m1.1.1b.cmml" xref="algorithm3.4.4.1.1.1.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="algorithm3.4.4.1.1.1.m1.1.1.cmml" xref="algorithm3.4.4.1.1.1.m1.1.1"><em class="ltx_emph ltx_font_typewriter" id="algorithm3.4.4.1.1.1.m1.1.1.1anest">id</em></mtext></ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.4.4.1.1.1.m1.1c">\operatorname*{\texttt{id}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.4.4.1.1.1.m1.1d">id</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="algorithm3.4.4.3">:</span>
</div>
<div class="ltx_listingline" id="algorithm3.5.5">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\bm{I}^{1}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}\%m),\ \bm{I}^{2%
}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}\mid m)" class="ltx_Math" display="inline" id="algorithm3.5.5.m1.4"><semantics id="algorithm3.5.5.m1.4a"><mrow id="algorithm3.5.5.m1.4.4.2" xref="algorithm3.5.5.m1.4.4.3.cmml"><mrow id="algorithm3.5.5.m1.3.3.1.1" xref="algorithm3.5.5.m1.3.3.1.1.cmml"><msup id="algorithm3.5.5.m1.3.3.1.1.3" xref="algorithm3.5.5.m1.3.3.1.1.3.cmml"><mi id="algorithm3.5.5.m1.3.3.1.1.3.2" xref="algorithm3.5.5.m1.3.3.1.1.3.2.cmml">𝑰</mi><mn id="algorithm3.5.5.m1.3.3.1.1.3.3" xref="algorithm3.5.5.m1.3.3.1.1.3.3.cmml">1</mn></msup><mo id="algorithm3.5.5.m1.3.3.1.1.2" xref="algorithm3.5.5.m1.3.3.1.1.2.cmml">=</mo><mrow id="algorithm3.5.5.m1.3.3.1.1.1.1" xref="algorithm3.5.5.m1.3.3.1.1.1.2.cmml"><mrow id="algorithm3.5.5.m1.1.1" xref="algorithm3.5.5.m1.1.1.cmml"><mi id="algorithm3.5.5.m1.1.1.2" xref="algorithm3.5.5.m1.1.1.2.cmml">one</mi><mo id="algorithm3.5.5.m1.1.1.1" xref="algorithm3.5.5.m1.1.1.1.cmml">−</mo><mi id="algorithm3.5.5.m1.1.1.3" xref="algorithm3.5.5.m1.1.1.3.cmml">hot</mi></mrow><mo id="algorithm3.5.5.m1.3.3.1.1.1.1a" xref="algorithm3.5.5.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="algorithm3.5.5.m1.3.3.1.1.1.1.1" xref="algorithm3.5.5.m1.3.3.1.1.1.2.cmml"><mo id="algorithm3.5.5.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="algorithm3.5.5.m1.3.3.1.1.1.2.cmml">(</mo><mrow id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.2" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.2a.cmml">id</mtext><mo id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.1" lspace="0.167em" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.1.cmml">%</mo></mrow><mo id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1a" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.cmml">⁡</mo><mi id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.2" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.2.cmml">m</mi></mrow><mo id="algorithm3.5.5.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="algorithm3.5.5.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="algorithm3.5.5.m1.4.4.2.3" rspace="0.667em" xref="algorithm3.5.5.m1.4.4.3a.cmml">,</mo><mrow id="algorithm3.5.5.m1.4.4.2.2" xref="algorithm3.5.5.m1.4.4.2.2.cmml"><msup id="algorithm3.5.5.m1.4.4.2.2.3" xref="algorithm3.5.5.m1.4.4.2.2.3.cmml"><mi id="algorithm3.5.5.m1.4.4.2.2.3.2" xref="algorithm3.5.5.m1.4.4.2.2.3.2.cmml">𝑰</mi><mn id="algorithm3.5.5.m1.4.4.2.2.3.3" xref="algorithm3.5.5.m1.4.4.2.2.3.3.cmml">2</mn></msup><mo id="algorithm3.5.5.m1.4.4.2.2.2" xref="algorithm3.5.5.m1.4.4.2.2.2.cmml">=</mo><mrow id="algorithm3.5.5.m1.4.4.2.2.1.1" xref="algorithm3.5.5.m1.4.4.2.2.1.2.cmml"><mrow id="algorithm3.5.5.m1.2.2" xref="algorithm3.5.5.m1.2.2.cmml"><mi id="algorithm3.5.5.m1.2.2.2" xref="algorithm3.5.5.m1.2.2.2.cmml">one</mi><mo id="algorithm3.5.5.m1.2.2.1" xref="algorithm3.5.5.m1.2.2.1.cmml">−</mo><mi id="algorithm3.5.5.m1.2.2.3" xref="algorithm3.5.5.m1.2.2.3.cmml">hot</mi></mrow><mo id="algorithm3.5.5.m1.4.4.2.2.1.1a" xref="algorithm3.5.5.m1.4.4.2.2.1.2.cmml">⁡</mo><mrow id="algorithm3.5.5.m1.4.4.2.2.1.1.1" xref="algorithm3.5.5.m1.4.4.2.2.1.2.cmml"><mo id="algorithm3.5.5.m1.4.4.2.2.1.1.1.2" stretchy="false" xref="algorithm3.5.5.m1.4.4.2.2.1.2.cmml">(</mo><mrow id="algorithm3.5.5.m1.4.4.2.2.1.1.1.1" xref="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.2" xref="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.2a.cmml">id</mtext><mo id="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.1" xref="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.1.cmml">∣</mo><mi id="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.3" xref="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.3.cmml">m</mi></mrow><mo id="algorithm3.5.5.m1.4.4.2.2.1.1.1.3" stretchy="false" xref="algorithm3.5.5.m1.4.4.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.5.5.m1.4b"><apply id="algorithm3.5.5.m1.4.4.3.cmml" xref="algorithm3.5.5.m1.4.4.2"><csymbol cd="ambiguous" id="algorithm3.5.5.m1.4.4.3a.cmml" xref="algorithm3.5.5.m1.4.4.2.3">formulae-sequence</csymbol><apply id="algorithm3.5.5.m1.3.3.1.1.cmml" xref="algorithm3.5.5.m1.3.3.1.1"><eq id="algorithm3.5.5.m1.3.3.1.1.2.cmml" xref="algorithm3.5.5.m1.3.3.1.1.2"></eq><apply id="algorithm3.5.5.m1.3.3.1.1.3.cmml" xref="algorithm3.5.5.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="algorithm3.5.5.m1.3.3.1.1.3.1.cmml" xref="algorithm3.5.5.m1.3.3.1.1.3">superscript</csymbol><ci id="algorithm3.5.5.m1.3.3.1.1.3.2.cmml" xref="algorithm3.5.5.m1.3.3.1.1.3.2">𝑰</ci><cn id="algorithm3.5.5.m1.3.3.1.1.3.3.cmml" type="integer" xref="algorithm3.5.5.m1.3.3.1.1.3.3">1</cn></apply><apply id="algorithm3.5.5.m1.3.3.1.1.1.2.cmml" xref="algorithm3.5.5.m1.3.3.1.1.1.1"><apply id="algorithm3.5.5.m1.1.1.cmml" xref="algorithm3.5.5.m1.1.1"><minus id="algorithm3.5.5.m1.1.1.1.cmml" xref="algorithm3.5.5.m1.1.1.1"></minus><ci id="algorithm3.5.5.m1.1.1.2.cmml" xref="algorithm3.5.5.m1.1.1.2">one</ci><ci id="algorithm3.5.5.m1.1.1.3.cmml" xref="algorithm3.5.5.m1.1.1.3">hot</ci></apply><apply id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.cmml" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1"><apply id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.1">percent</csymbol><ci id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.2a.cmml" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.1.2">id</mtext></ci></apply><ci id="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="algorithm3.5.5.m1.3.3.1.1.1.1.1.1.2">𝑚</ci></apply></apply></apply><apply id="algorithm3.5.5.m1.4.4.2.2.cmml" xref="algorithm3.5.5.m1.4.4.2.2"><eq id="algorithm3.5.5.m1.4.4.2.2.2.cmml" xref="algorithm3.5.5.m1.4.4.2.2.2"></eq><apply id="algorithm3.5.5.m1.4.4.2.2.3.cmml" xref="algorithm3.5.5.m1.4.4.2.2.3"><csymbol cd="ambiguous" id="algorithm3.5.5.m1.4.4.2.2.3.1.cmml" xref="algorithm3.5.5.m1.4.4.2.2.3">superscript</csymbol><ci id="algorithm3.5.5.m1.4.4.2.2.3.2.cmml" xref="algorithm3.5.5.m1.4.4.2.2.3.2">𝑰</ci><cn id="algorithm3.5.5.m1.4.4.2.2.3.3.cmml" type="integer" xref="algorithm3.5.5.m1.4.4.2.2.3.3">2</cn></apply><apply id="algorithm3.5.5.m1.4.4.2.2.1.2.cmml" xref="algorithm3.5.5.m1.4.4.2.2.1.1"><apply id="algorithm3.5.5.m1.2.2.cmml" xref="algorithm3.5.5.m1.2.2"><minus id="algorithm3.5.5.m1.2.2.1.cmml" xref="algorithm3.5.5.m1.2.2.1"></minus><ci id="algorithm3.5.5.m1.2.2.2.cmml" xref="algorithm3.5.5.m1.2.2.2">one</ci><ci id="algorithm3.5.5.m1.2.2.3.cmml" xref="algorithm3.5.5.m1.2.2.3">hot</ci></apply><apply id="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.cmml" xref="algorithm3.5.5.m1.4.4.2.2.1.1.1.1"><csymbol cd="latexml" id="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.1.cmml" xref="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.1">conditional</csymbol><ci id="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.2a.cmml" xref="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.2.cmml" xref="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.2">id</mtext></ci><ci id="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.3.cmml" xref="algorithm3.5.5.m1.4.4.2.2.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.5.5.m1.4c">\bm{I}^{1}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}\%m),\ \bm{I}^{2%
}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}\mid m)</annotation><annotation encoding="application/x-llamapun" id="algorithm3.5.5.m1.4d">bold_italic_I start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT = start_OPERATOR roman_one - roman_hot end_OPERATOR ( id % italic_m ) , bold_italic_I start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = start_OPERATOR roman_one - roman_hot end_OPERATOR ( id ∣ italic_m )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.6.6">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm3.6.6.1">// </span><math alttext="{m}" class="ltx_Math" display="inline" id="algorithm3.6.6.m1.1"><semantics id="algorithm3.6.6.m1.1a"><mi id="algorithm3.6.6.m1.1.1" xref="algorithm3.6.6.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="algorithm3.6.6.m1.1b"><ci id="algorithm3.6.6.m1.1.1.cmml" xref="algorithm3.6.6.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.6.6.m1.1c">{m}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.6.6.m1.1d">italic_m</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm3.6.6.2"> is a predefined parameter.</span>
</div>
<div class="ltx_listingline" id="algorithm3.24.27">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm3.7.7">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\hat{\bm{e}}=\bm{I}^{1}\times\mathbf{T}^{1}+\bm{I}^{2}\times\mathbf{T}^{2}" class="ltx_Math" display="inline" id="algorithm3.7.7.m1.1"><semantics id="algorithm3.7.7.m1.1a"><mrow id="algorithm3.7.7.m1.1.1" xref="algorithm3.7.7.m1.1.1.cmml"><mover accent="true" id="algorithm3.7.7.m1.1.1.2" xref="algorithm3.7.7.m1.1.1.2.cmml"><mi id="algorithm3.7.7.m1.1.1.2.2" xref="algorithm3.7.7.m1.1.1.2.2.cmml">𝒆</mi><mo id="algorithm3.7.7.m1.1.1.2.1" xref="algorithm3.7.7.m1.1.1.2.1.cmml">^</mo></mover><mo id="algorithm3.7.7.m1.1.1.1" xref="algorithm3.7.7.m1.1.1.1.cmml">=</mo><mrow id="algorithm3.7.7.m1.1.1.3" xref="algorithm3.7.7.m1.1.1.3.cmml"><mrow id="algorithm3.7.7.m1.1.1.3.2" xref="algorithm3.7.7.m1.1.1.3.2.cmml"><msup id="algorithm3.7.7.m1.1.1.3.2.2" xref="algorithm3.7.7.m1.1.1.3.2.2.cmml"><mi id="algorithm3.7.7.m1.1.1.3.2.2.2" xref="algorithm3.7.7.m1.1.1.3.2.2.2.cmml">𝑰</mi><mn id="algorithm3.7.7.m1.1.1.3.2.2.3" xref="algorithm3.7.7.m1.1.1.3.2.2.3.cmml">1</mn></msup><mo id="algorithm3.7.7.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="algorithm3.7.7.m1.1.1.3.2.1.cmml">×</mo><msup id="algorithm3.7.7.m1.1.1.3.2.3" xref="algorithm3.7.7.m1.1.1.3.2.3.cmml"><mi id="algorithm3.7.7.m1.1.1.3.2.3.2" xref="algorithm3.7.7.m1.1.1.3.2.3.2.cmml">𝐓</mi><mn id="algorithm3.7.7.m1.1.1.3.2.3.3" xref="algorithm3.7.7.m1.1.1.3.2.3.3.cmml">1</mn></msup></mrow><mo id="algorithm3.7.7.m1.1.1.3.1" xref="algorithm3.7.7.m1.1.1.3.1.cmml">+</mo><mrow id="algorithm3.7.7.m1.1.1.3.3" xref="algorithm3.7.7.m1.1.1.3.3.cmml"><msup id="algorithm3.7.7.m1.1.1.3.3.2" xref="algorithm3.7.7.m1.1.1.3.3.2.cmml"><mi id="algorithm3.7.7.m1.1.1.3.3.2.2" xref="algorithm3.7.7.m1.1.1.3.3.2.2.cmml">𝑰</mi><mn id="algorithm3.7.7.m1.1.1.3.3.2.3" xref="algorithm3.7.7.m1.1.1.3.3.2.3.cmml">2</mn></msup><mo id="algorithm3.7.7.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="algorithm3.7.7.m1.1.1.3.3.1.cmml">×</mo><msup id="algorithm3.7.7.m1.1.1.3.3.3" xref="algorithm3.7.7.m1.1.1.3.3.3.cmml"><mi id="algorithm3.7.7.m1.1.1.3.3.3.2" xref="algorithm3.7.7.m1.1.1.3.3.3.2.cmml">𝐓</mi><mn id="algorithm3.7.7.m1.1.1.3.3.3.3" xref="algorithm3.7.7.m1.1.1.3.3.3.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.7.7.m1.1b"><apply id="algorithm3.7.7.m1.1.1.cmml" xref="algorithm3.7.7.m1.1.1"><eq id="algorithm3.7.7.m1.1.1.1.cmml" xref="algorithm3.7.7.m1.1.1.1"></eq><apply id="algorithm3.7.7.m1.1.1.2.cmml" xref="algorithm3.7.7.m1.1.1.2"><ci id="algorithm3.7.7.m1.1.1.2.1.cmml" xref="algorithm3.7.7.m1.1.1.2.1">^</ci><ci id="algorithm3.7.7.m1.1.1.2.2.cmml" xref="algorithm3.7.7.m1.1.1.2.2">𝒆</ci></apply><apply id="algorithm3.7.7.m1.1.1.3.cmml" xref="algorithm3.7.7.m1.1.1.3"><plus id="algorithm3.7.7.m1.1.1.3.1.cmml" xref="algorithm3.7.7.m1.1.1.3.1"></plus><apply id="algorithm3.7.7.m1.1.1.3.2.cmml" xref="algorithm3.7.7.m1.1.1.3.2"><times id="algorithm3.7.7.m1.1.1.3.2.1.cmml" xref="algorithm3.7.7.m1.1.1.3.2.1"></times><apply id="algorithm3.7.7.m1.1.1.3.2.2.cmml" xref="algorithm3.7.7.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="algorithm3.7.7.m1.1.1.3.2.2.1.cmml" xref="algorithm3.7.7.m1.1.1.3.2.2">superscript</csymbol><ci id="algorithm3.7.7.m1.1.1.3.2.2.2.cmml" xref="algorithm3.7.7.m1.1.1.3.2.2.2">𝑰</ci><cn id="algorithm3.7.7.m1.1.1.3.2.2.3.cmml" type="integer" xref="algorithm3.7.7.m1.1.1.3.2.2.3">1</cn></apply><apply id="algorithm3.7.7.m1.1.1.3.2.3.cmml" xref="algorithm3.7.7.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm3.7.7.m1.1.1.3.2.3.1.cmml" xref="algorithm3.7.7.m1.1.1.3.2.3">superscript</csymbol><ci id="algorithm3.7.7.m1.1.1.3.2.3.2.cmml" xref="algorithm3.7.7.m1.1.1.3.2.3.2">𝐓</ci><cn id="algorithm3.7.7.m1.1.1.3.2.3.3.cmml" type="integer" xref="algorithm3.7.7.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="algorithm3.7.7.m1.1.1.3.3.cmml" xref="algorithm3.7.7.m1.1.1.3.3"><times id="algorithm3.7.7.m1.1.1.3.3.1.cmml" xref="algorithm3.7.7.m1.1.1.3.3.1"></times><apply id="algorithm3.7.7.m1.1.1.3.3.2.cmml" xref="algorithm3.7.7.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="algorithm3.7.7.m1.1.1.3.3.2.1.cmml" xref="algorithm3.7.7.m1.1.1.3.3.2">superscript</csymbol><ci id="algorithm3.7.7.m1.1.1.3.3.2.2.cmml" xref="algorithm3.7.7.m1.1.1.3.3.2.2">𝑰</ci><cn id="algorithm3.7.7.m1.1.1.3.3.2.3.cmml" type="integer" xref="algorithm3.7.7.m1.1.1.3.3.2.3">2</cn></apply><apply id="algorithm3.7.7.m1.1.1.3.3.3.cmml" xref="algorithm3.7.7.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm3.7.7.m1.1.1.3.3.3.1.cmml" xref="algorithm3.7.7.m1.1.1.3.3.3">superscript</csymbol><ci id="algorithm3.7.7.m1.1.1.3.3.3.2.cmml" xref="algorithm3.7.7.m1.1.1.3.3.3.2">𝐓</ci><cn id="algorithm3.7.7.m1.1.1.3.3.3.3.cmml" type="integer" xref="algorithm3.7.7.m1.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.7.7.m1.1c">\hat{\bm{e}}=\bm{I}^{1}\times\mathbf{T}^{1}+\bm{I}^{2}\times\mathbf{T}^{2}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.7.7.m1.1d">over^ start_ARG bold_italic_e end_ARG = bold_italic_I start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT × bold_T start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT + bold_italic_I start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × bold_T start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.9.9">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm3.9.9.2">// </span><math alttext="\mathbf{T}^{1}\in\operatorname*{\mathbb{R}}^{m\times d}" class="ltx_Math" display="inline" id="algorithm3.8.8.m1.1"><semantics id="algorithm3.8.8.m1.1a"><mrow id="algorithm3.8.8.m1.1.1" xref="algorithm3.8.8.m1.1.1.cmml"><msup id="algorithm3.8.8.m1.1.1.2" xref="algorithm3.8.8.m1.1.1.2.cmml"><mi id="algorithm3.8.8.m1.1.1.2.2" xref="algorithm3.8.8.m1.1.1.2.2.cmml">𝐓</mi><mn id="algorithm3.8.8.m1.1.1.2.3" xref="algorithm3.8.8.m1.1.1.2.3.cmml">1</mn></msup><mo id="algorithm3.8.8.m1.1.1.1" rspace="0.1389em" xref="algorithm3.8.8.m1.1.1.1.cmml">∈</mo><msup id="algorithm3.8.8.m1.1.1.3" xref="algorithm3.8.8.m1.1.1.3.cmml"><mo id="algorithm3.8.8.m1.1.1.3.2" lspace="0.1389em" xref="algorithm3.8.8.m1.1.1.3.2.cmml">ℝ</mo><mrow id="algorithm3.8.8.m1.1.1.3.3" xref="algorithm3.8.8.m1.1.1.3.3.cmml"><mi id="algorithm3.8.8.m1.1.1.3.3.2" xref="algorithm3.8.8.m1.1.1.3.3.2.cmml">m</mi><mo id="algorithm3.8.8.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="algorithm3.8.8.m1.1.1.3.3.1.cmml">×</mo><mi id="algorithm3.8.8.m1.1.1.3.3.3" xref="algorithm3.8.8.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.8.8.m1.1b"><apply id="algorithm3.8.8.m1.1.1.cmml" xref="algorithm3.8.8.m1.1.1"><in id="algorithm3.8.8.m1.1.1.1.cmml" xref="algorithm3.8.8.m1.1.1.1"></in><apply id="algorithm3.8.8.m1.1.1.2.cmml" xref="algorithm3.8.8.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm3.8.8.m1.1.1.2.1.cmml" xref="algorithm3.8.8.m1.1.1.2">superscript</csymbol><ci id="algorithm3.8.8.m1.1.1.2.2.cmml" xref="algorithm3.8.8.m1.1.1.2.2">𝐓</ci><cn id="algorithm3.8.8.m1.1.1.2.3.cmml" type="integer" xref="algorithm3.8.8.m1.1.1.2.3">1</cn></apply><apply id="algorithm3.8.8.m1.1.1.3.cmml" xref="algorithm3.8.8.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm3.8.8.m1.1.1.3.1.cmml" xref="algorithm3.8.8.m1.1.1.3">superscript</csymbol><ci id="algorithm3.8.8.m1.1.1.3.2.cmml" xref="algorithm3.8.8.m1.1.1.3.2">ℝ</ci><apply id="algorithm3.8.8.m1.1.1.3.3.cmml" xref="algorithm3.8.8.m1.1.1.3.3"><times id="algorithm3.8.8.m1.1.1.3.3.1.cmml" xref="algorithm3.8.8.m1.1.1.3.3.1"></times><ci id="algorithm3.8.8.m1.1.1.3.3.2.cmml" xref="algorithm3.8.8.m1.1.1.3.3.2">𝑚</ci><ci id="algorithm3.8.8.m1.1.1.3.3.3.cmml" xref="algorithm3.8.8.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.8.8.m1.1c">\mathbf{T}^{1}\in\operatorname*{\mathbb{R}}^{m\times d}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.8.8.m1.1d">bold_T start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm3.9.9.1"> and <math alttext="\mathbf{T}^{2}\in\operatorname*{\mathbb{R}}^{(n\mid m)\times d}" class="ltx_Math" display="inline" id="algorithm3.9.9.1.m1.1"><semantics id="algorithm3.9.9.1.m1.1a"><mrow id="algorithm3.9.9.1.m1.1.2" xref="algorithm3.9.9.1.m1.1.2.cmml"><msup id="algorithm3.9.9.1.m1.1.2.2" xref="algorithm3.9.9.1.m1.1.2.2.cmml"><mi id="algorithm3.9.9.1.m1.1.2.2.2" xref="algorithm3.9.9.1.m1.1.2.2.2.cmml">𝐓</mi><mn id="algorithm3.9.9.1.m1.1.2.2.3" xref="algorithm3.9.9.1.m1.1.2.2.3.cmml">2</mn></msup><mo id="algorithm3.9.9.1.m1.1.2.1" rspace="0.1389em" xref="algorithm3.9.9.1.m1.1.2.1.cmml">∈</mo><msup id="algorithm3.9.9.1.m1.1.2.3" xref="algorithm3.9.9.1.m1.1.2.3.cmml"><mo id="algorithm3.9.9.1.m1.1.2.3.2" lspace="0.1389em" xref="algorithm3.9.9.1.m1.1.2.3.2.cmml">ℝ</mo><mrow id="algorithm3.9.9.1.m1.1.1.1" xref="algorithm3.9.9.1.m1.1.1.1.cmml"><mrow id="algorithm3.9.9.1.m1.1.1.1.1.1" xref="algorithm3.9.9.1.m1.1.1.1.1.1.1.cmml"><mo id="algorithm3.9.9.1.m1.1.1.1.1.1.2" stretchy="false" xref="algorithm3.9.9.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm3.9.9.1.m1.1.1.1.1.1.1" xref="algorithm3.9.9.1.m1.1.1.1.1.1.1.cmml"><mi id="algorithm3.9.9.1.m1.1.1.1.1.1.1.2" xref="algorithm3.9.9.1.m1.1.1.1.1.1.1.2.cmml">n</mi><mo id="algorithm3.9.9.1.m1.1.1.1.1.1.1.1" xref="algorithm3.9.9.1.m1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="algorithm3.9.9.1.m1.1.1.1.1.1.1.3" xref="algorithm3.9.9.1.m1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="algorithm3.9.9.1.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="algorithm3.9.9.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="algorithm3.9.9.1.m1.1.1.1.2" rspace="0.222em" xref="algorithm3.9.9.1.m1.1.1.1.2.cmml">×</mo><mi id="algorithm3.9.9.1.m1.1.1.1.3" xref="algorithm3.9.9.1.m1.1.1.1.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.9.9.1.m1.1b"><apply id="algorithm3.9.9.1.m1.1.2.cmml" xref="algorithm3.9.9.1.m1.1.2"><in id="algorithm3.9.9.1.m1.1.2.1.cmml" xref="algorithm3.9.9.1.m1.1.2.1"></in><apply id="algorithm3.9.9.1.m1.1.2.2.cmml" xref="algorithm3.9.9.1.m1.1.2.2"><csymbol cd="ambiguous" id="algorithm3.9.9.1.m1.1.2.2.1.cmml" xref="algorithm3.9.9.1.m1.1.2.2">superscript</csymbol><ci id="algorithm3.9.9.1.m1.1.2.2.2.cmml" xref="algorithm3.9.9.1.m1.1.2.2.2">𝐓</ci><cn id="algorithm3.9.9.1.m1.1.2.2.3.cmml" type="integer" xref="algorithm3.9.9.1.m1.1.2.2.3">2</cn></apply><apply id="algorithm3.9.9.1.m1.1.2.3.cmml" xref="algorithm3.9.9.1.m1.1.2.3"><csymbol cd="ambiguous" id="algorithm3.9.9.1.m1.1.2.3.1.cmml" xref="algorithm3.9.9.1.m1.1.2.3">superscript</csymbol><ci id="algorithm3.9.9.1.m1.1.2.3.2.cmml" xref="algorithm3.9.9.1.m1.1.2.3.2">ℝ</ci><apply id="algorithm3.9.9.1.m1.1.1.1.cmml" xref="algorithm3.9.9.1.m1.1.1.1"><times id="algorithm3.9.9.1.m1.1.1.1.2.cmml" xref="algorithm3.9.9.1.m1.1.1.1.2"></times><apply id="algorithm3.9.9.1.m1.1.1.1.1.1.1.cmml" xref="algorithm3.9.9.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="algorithm3.9.9.1.m1.1.1.1.1.1.1.1.cmml" xref="algorithm3.9.9.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="algorithm3.9.9.1.m1.1.1.1.1.1.1.2.cmml" xref="algorithm3.9.9.1.m1.1.1.1.1.1.1.2">𝑛</ci><ci id="algorithm3.9.9.1.m1.1.1.1.1.1.1.3.cmml" xref="algorithm3.9.9.1.m1.1.1.1.1.1.1.3">𝑚</ci></apply><ci id="algorithm3.9.9.1.m1.1.1.1.3.cmml" xref="algorithm3.9.9.1.m1.1.1.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.9.9.1.m1.1c">\mathbf{T}^{2}\in\operatorname*{\mathbb{R}}^{(n\mid m)\times d}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.9.9.1.m1.1d">bold_T start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_n ∣ italic_m ) × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.</span>
</div>
<div class="ltx_listingline" id="algorithm3.24.28">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm3.10.10">
<span class="ltx_text ltx_font_bold" id="algorithm3.10.10.2">Func</span> <em class="ltx_emph ltx_font_typewriter" id="algorithm3.10.10.1">MEmCom(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="algorithm3.10.10.1.1.1"><math alttext="\operatorname*{\texttt{id}}" class="ltx_Math" display="inline" id="algorithm3.10.10.1.1.1.m1.1"><semantics id="algorithm3.10.10.1.1.1.m1.1a"><mtext class="ltx_mathvariant_monospace" id="algorithm3.10.10.1.1.1.m1.1.1" xref="algorithm3.10.10.1.1.1.m1.1.1b.cmml"><em class="ltx_emph ltx_font_typewriter" id="algorithm3.10.10.1.1.1.m1.1.1.1nest">id</em></mtext><annotation-xml encoding="MathML-Content" id="algorithm3.10.10.1.1.1.m1.1b"><ci id="algorithm3.10.10.1.1.1.m1.1.1b.cmml" xref="algorithm3.10.10.1.1.1.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="algorithm3.10.10.1.1.1.m1.1.1.cmml" xref="algorithm3.10.10.1.1.1.m1.1.1"><em class="ltx_emph ltx_font_typewriter" id="algorithm3.10.10.1.1.1.m1.1.1.1anest">id</em></mtext></ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.10.10.1.1.1.m1.1c">\operatorname*{\texttt{id}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.10.10.1.1.1.m1.1d">id</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="algorithm3.10.10.3">:</span>
</div>
<div class="ltx_listingline" id="algorithm3.11.11">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\bm{I}^{1}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}\%m),\ \bm{I}^{2%
}=\operatorname*{one-hot}(\operatorname*{\texttt{id}})" class="ltx_Math" display="inline" id="algorithm3.11.11.m1.5"><semantics id="algorithm3.11.11.m1.5a"><mrow id="algorithm3.11.11.m1.5.5.2" xref="algorithm3.11.11.m1.5.5.3.cmml"><mrow id="algorithm3.11.11.m1.4.4.1.1" xref="algorithm3.11.11.m1.4.4.1.1.cmml"><msup id="algorithm3.11.11.m1.4.4.1.1.3" xref="algorithm3.11.11.m1.4.4.1.1.3.cmml"><mi id="algorithm3.11.11.m1.4.4.1.1.3.2" xref="algorithm3.11.11.m1.4.4.1.1.3.2.cmml">𝑰</mi><mn id="algorithm3.11.11.m1.4.4.1.1.3.3" xref="algorithm3.11.11.m1.4.4.1.1.3.3.cmml">1</mn></msup><mo id="algorithm3.11.11.m1.4.4.1.1.2" xref="algorithm3.11.11.m1.4.4.1.1.2.cmml">=</mo><mrow id="algorithm3.11.11.m1.4.4.1.1.1.1" xref="algorithm3.11.11.m1.4.4.1.1.1.2.cmml"><mrow id="algorithm3.11.11.m1.1.1" xref="algorithm3.11.11.m1.1.1.cmml"><mi id="algorithm3.11.11.m1.1.1.2" xref="algorithm3.11.11.m1.1.1.2.cmml">one</mi><mo id="algorithm3.11.11.m1.1.1.1" xref="algorithm3.11.11.m1.1.1.1.cmml">−</mo><mi id="algorithm3.11.11.m1.1.1.3" xref="algorithm3.11.11.m1.1.1.3.cmml">hot</mi></mrow><mo id="algorithm3.11.11.m1.4.4.1.1.1.1a" xref="algorithm3.11.11.m1.4.4.1.1.1.2.cmml">⁡</mo><mrow id="algorithm3.11.11.m1.4.4.1.1.1.1.1" xref="algorithm3.11.11.m1.4.4.1.1.1.2.cmml"><mo id="algorithm3.11.11.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="algorithm3.11.11.m1.4.4.1.1.1.2.cmml">(</mo><mrow id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.2" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.2a.cmml">id</mtext><mo id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.1" lspace="0.167em" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.1.cmml">%</mo></mrow><mo id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1a" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.cmml">⁡</mo><mi id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.2" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.2.cmml">m</mi></mrow><mo id="algorithm3.11.11.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="algorithm3.11.11.m1.4.4.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="algorithm3.11.11.m1.5.5.2.3" rspace="0.667em" xref="algorithm3.11.11.m1.5.5.3a.cmml">,</mo><mrow id="algorithm3.11.11.m1.5.5.2.2" xref="algorithm3.11.11.m1.5.5.2.2.cmml"><msup id="algorithm3.11.11.m1.5.5.2.2.2" xref="algorithm3.11.11.m1.5.5.2.2.2.cmml"><mi id="algorithm3.11.11.m1.5.5.2.2.2.2" xref="algorithm3.11.11.m1.5.5.2.2.2.2.cmml">𝑰</mi><mn id="algorithm3.11.11.m1.5.5.2.2.2.3" xref="algorithm3.11.11.m1.5.5.2.2.2.3.cmml">2</mn></msup><mo id="algorithm3.11.11.m1.5.5.2.2.1" xref="algorithm3.11.11.m1.5.5.2.2.1.cmml">=</mo><mrow id="algorithm3.11.11.m1.5.5.2.2.3.2" xref="algorithm3.11.11.m1.5.5.2.2.3.1.cmml"><mrow id="algorithm3.11.11.m1.2.2" xref="algorithm3.11.11.m1.2.2.cmml"><mi id="algorithm3.11.11.m1.2.2.2" xref="algorithm3.11.11.m1.2.2.2.cmml">one</mi><mo id="algorithm3.11.11.m1.2.2.1" xref="algorithm3.11.11.m1.2.2.1.cmml">−</mo><mi id="algorithm3.11.11.m1.2.2.3" xref="algorithm3.11.11.m1.2.2.3.cmml">hot</mi></mrow><mo id="algorithm3.11.11.m1.5.5.2.2.3.2a" xref="algorithm3.11.11.m1.5.5.2.2.3.1.cmml">⁡</mo><mrow id="algorithm3.11.11.m1.5.5.2.2.3.2.1" xref="algorithm3.11.11.m1.5.5.2.2.3.1.cmml"><mo id="algorithm3.11.11.m1.5.5.2.2.3.2.1.1" stretchy="false" xref="algorithm3.11.11.m1.5.5.2.2.3.1.cmml">(</mo><mtext class="ltx_mathvariant_monospace" id="algorithm3.11.11.m1.3.3" xref="algorithm3.11.11.m1.3.3a.cmml">id</mtext><mo id="algorithm3.11.11.m1.5.5.2.2.3.2.1.2" stretchy="false" xref="algorithm3.11.11.m1.5.5.2.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.11.11.m1.5b"><apply id="algorithm3.11.11.m1.5.5.3.cmml" xref="algorithm3.11.11.m1.5.5.2"><csymbol cd="ambiguous" id="algorithm3.11.11.m1.5.5.3a.cmml" xref="algorithm3.11.11.m1.5.5.2.3">formulae-sequence</csymbol><apply id="algorithm3.11.11.m1.4.4.1.1.cmml" xref="algorithm3.11.11.m1.4.4.1.1"><eq id="algorithm3.11.11.m1.4.4.1.1.2.cmml" xref="algorithm3.11.11.m1.4.4.1.1.2"></eq><apply id="algorithm3.11.11.m1.4.4.1.1.3.cmml" xref="algorithm3.11.11.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="algorithm3.11.11.m1.4.4.1.1.3.1.cmml" xref="algorithm3.11.11.m1.4.4.1.1.3">superscript</csymbol><ci id="algorithm3.11.11.m1.4.4.1.1.3.2.cmml" xref="algorithm3.11.11.m1.4.4.1.1.3.2">𝑰</ci><cn id="algorithm3.11.11.m1.4.4.1.1.3.3.cmml" type="integer" xref="algorithm3.11.11.m1.4.4.1.1.3.3">1</cn></apply><apply id="algorithm3.11.11.m1.4.4.1.1.1.2.cmml" xref="algorithm3.11.11.m1.4.4.1.1.1.1"><apply id="algorithm3.11.11.m1.1.1.cmml" xref="algorithm3.11.11.m1.1.1"><minus id="algorithm3.11.11.m1.1.1.1.cmml" xref="algorithm3.11.11.m1.1.1.1"></minus><ci id="algorithm3.11.11.m1.1.1.2.cmml" xref="algorithm3.11.11.m1.1.1.2">one</ci><ci id="algorithm3.11.11.m1.1.1.3.cmml" xref="algorithm3.11.11.m1.1.1.3">hot</ci></apply><apply id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.cmml" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1"><apply id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.cmml" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.1">percent</csymbol><ci id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.2a.cmml" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.1.2">id</mtext></ci></apply><ci id="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.2.cmml" xref="algorithm3.11.11.m1.4.4.1.1.1.1.1.1.2">𝑚</ci></apply></apply></apply><apply id="algorithm3.11.11.m1.5.5.2.2.cmml" xref="algorithm3.11.11.m1.5.5.2.2"><eq id="algorithm3.11.11.m1.5.5.2.2.1.cmml" xref="algorithm3.11.11.m1.5.5.2.2.1"></eq><apply id="algorithm3.11.11.m1.5.5.2.2.2.cmml" xref="algorithm3.11.11.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="algorithm3.11.11.m1.5.5.2.2.2.1.cmml" xref="algorithm3.11.11.m1.5.5.2.2.2">superscript</csymbol><ci id="algorithm3.11.11.m1.5.5.2.2.2.2.cmml" xref="algorithm3.11.11.m1.5.5.2.2.2.2">𝑰</ci><cn id="algorithm3.11.11.m1.5.5.2.2.2.3.cmml" type="integer" xref="algorithm3.11.11.m1.5.5.2.2.2.3">2</cn></apply><apply id="algorithm3.11.11.m1.5.5.2.2.3.1.cmml" xref="algorithm3.11.11.m1.5.5.2.2.3.2"><apply id="algorithm3.11.11.m1.2.2.cmml" xref="algorithm3.11.11.m1.2.2"><minus id="algorithm3.11.11.m1.2.2.1.cmml" xref="algorithm3.11.11.m1.2.2.1"></minus><ci id="algorithm3.11.11.m1.2.2.2.cmml" xref="algorithm3.11.11.m1.2.2.2">one</ci><ci id="algorithm3.11.11.m1.2.2.3.cmml" xref="algorithm3.11.11.m1.2.2.3">hot</ci></apply><ci id="algorithm3.11.11.m1.3.3a.cmml" xref="algorithm3.11.11.m1.3.3"><mtext class="ltx_mathvariant_monospace" id="algorithm3.11.11.m1.3.3.cmml" xref="algorithm3.11.11.m1.3.3">id</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.11.11.m1.5c">\bm{I}^{1}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}\%m),\ \bm{I}^{2%
}=\operatorname*{one-hot}(\operatorname*{\texttt{id}})</annotation><annotation encoding="application/x-llamapun" id="algorithm3.11.11.m1.5d">bold_italic_I start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT = start_OPERATOR roman_one - roman_hot end_OPERATOR ( id % italic_m ) , bold_italic_I start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = start_OPERATOR roman_one - roman_hot end_OPERATOR ( id )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.12.12">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\hat{\bm{e}}=(\bm{I}^{1}\times\mathbf{T}^{1})\cdot(\bm{I}^{2}\times\mathbf{T}^%
{2})" class="ltx_Math" display="inline" id="algorithm3.12.12.m1.2"><semantics id="algorithm3.12.12.m1.2a"><mrow id="algorithm3.12.12.m1.2.2" xref="algorithm3.12.12.m1.2.2.cmml"><mover accent="true" id="algorithm3.12.12.m1.2.2.4" xref="algorithm3.12.12.m1.2.2.4.cmml"><mi id="algorithm3.12.12.m1.2.2.4.2" xref="algorithm3.12.12.m1.2.2.4.2.cmml">𝒆</mi><mo id="algorithm3.12.12.m1.2.2.4.1" xref="algorithm3.12.12.m1.2.2.4.1.cmml">^</mo></mover><mo id="algorithm3.12.12.m1.2.2.3" xref="algorithm3.12.12.m1.2.2.3.cmml">=</mo><mrow id="algorithm3.12.12.m1.2.2.2" xref="algorithm3.12.12.m1.2.2.2.cmml"><mrow id="algorithm3.12.12.m1.1.1.1.1.1" xref="algorithm3.12.12.m1.1.1.1.1.1.1.cmml"><mo id="algorithm3.12.12.m1.1.1.1.1.1.2" stretchy="false" xref="algorithm3.12.12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm3.12.12.m1.1.1.1.1.1.1" xref="algorithm3.12.12.m1.1.1.1.1.1.1.cmml"><msup id="algorithm3.12.12.m1.1.1.1.1.1.1.2" xref="algorithm3.12.12.m1.1.1.1.1.1.1.2.cmml"><mi id="algorithm3.12.12.m1.1.1.1.1.1.1.2.2" xref="algorithm3.12.12.m1.1.1.1.1.1.1.2.2.cmml">𝑰</mi><mn id="algorithm3.12.12.m1.1.1.1.1.1.1.2.3" xref="algorithm3.12.12.m1.1.1.1.1.1.1.2.3.cmml">1</mn></msup><mo id="algorithm3.12.12.m1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="algorithm3.12.12.m1.1.1.1.1.1.1.1.cmml">×</mo><msup id="algorithm3.12.12.m1.1.1.1.1.1.1.3" xref="algorithm3.12.12.m1.1.1.1.1.1.1.3.cmml"><mi id="algorithm3.12.12.m1.1.1.1.1.1.1.3.2" xref="algorithm3.12.12.m1.1.1.1.1.1.1.3.2.cmml">𝐓</mi><mn id="algorithm3.12.12.m1.1.1.1.1.1.1.3.3" xref="algorithm3.12.12.m1.1.1.1.1.1.1.3.3.cmml">1</mn></msup></mrow><mo id="algorithm3.12.12.m1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="algorithm3.12.12.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="algorithm3.12.12.m1.2.2.2.3" rspace="0.222em" xref="algorithm3.12.12.m1.2.2.2.3.cmml">⋅</mo><mrow id="algorithm3.12.12.m1.2.2.2.2.1" xref="algorithm3.12.12.m1.2.2.2.2.1.1.cmml"><mo id="algorithm3.12.12.m1.2.2.2.2.1.2" stretchy="false" xref="algorithm3.12.12.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="algorithm3.12.12.m1.2.2.2.2.1.1" xref="algorithm3.12.12.m1.2.2.2.2.1.1.cmml"><msup id="algorithm3.12.12.m1.2.2.2.2.1.1.2" xref="algorithm3.12.12.m1.2.2.2.2.1.1.2.cmml"><mi id="algorithm3.12.12.m1.2.2.2.2.1.1.2.2" xref="algorithm3.12.12.m1.2.2.2.2.1.1.2.2.cmml">𝑰</mi><mn id="algorithm3.12.12.m1.2.2.2.2.1.1.2.3" xref="algorithm3.12.12.m1.2.2.2.2.1.1.2.3.cmml">2</mn></msup><mo id="algorithm3.12.12.m1.2.2.2.2.1.1.1" lspace="0.222em" rspace="0.222em" xref="algorithm3.12.12.m1.2.2.2.2.1.1.1.cmml">×</mo><msup id="algorithm3.12.12.m1.2.2.2.2.1.1.3" xref="algorithm3.12.12.m1.2.2.2.2.1.1.3.cmml"><mi id="algorithm3.12.12.m1.2.2.2.2.1.1.3.2" xref="algorithm3.12.12.m1.2.2.2.2.1.1.3.2.cmml">𝐓</mi><mn id="algorithm3.12.12.m1.2.2.2.2.1.1.3.3" xref="algorithm3.12.12.m1.2.2.2.2.1.1.3.3.cmml">2</mn></msup></mrow><mo id="algorithm3.12.12.m1.2.2.2.2.1.3" stretchy="false" xref="algorithm3.12.12.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.12.12.m1.2b"><apply id="algorithm3.12.12.m1.2.2.cmml" xref="algorithm3.12.12.m1.2.2"><eq id="algorithm3.12.12.m1.2.2.3.cmml" xref="algorithm3.12.12.m1.2.2.3"></eq><apply id="algorithm3.12.12.m1.2.2.4.cmml" xref="algorithm3.12.12.m1.2.2.4"><ci id="algorithm3.12.12.m1.2.2.4.1.cmml" xref="algorithm3.12.12.m1.2.2.4.1">^</ci><ci id="algorithm3.12.12.m1.2.2.4.2.cmml" xref="algorithm3.12.12.m1.2.2.4.2">𝒆</ci></apply><apply id="algorithm3.12.12.m1.2.2.2.cmml" xref="algorithm3.12.12.m1.2.2.2"><ci id="algorithm3.12.12.m1.2.2.2.3.cmml" xref="algorithm3.12.12.m1.2.2.2.3">⋅</ci><apply id="algorithm3.12.12.m1.1.1.1.1.1.1.cmml" xref="algorithm3.12.12.m1.1.1.1.1.1"><times id="algorithm3.12.12.m1.1.1.1.1.1.1.1.cmml" xref="algorithm3.12.12.m1.1.1.1.1.1.1.1"></times><apply id="algorithm3.12.12.m1.1.1.1.1.1.1.2.cmml" xref="algorithm3.12.12.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm3.12.12.m1.1.1.1.1.1.1.2.1.cmml" xref="algorithm3.12.12.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="algorithm3.12.12.m1.1.1.1.1.1.1.2.2.cmml" xref="algorithm3.12.12.m1.1.1.1.1.1.1.2.2">𝑰</ci><cn id="algorithm3.12.12.m1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="algorithm3.12.12.m1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="algorithm3.12.12.m1.1.1.1.1.1.1.3.cmml" xref="algorithm3.12.12.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm3.12.12.m1.1.1.1.1.1.1.3.1.cmml" xref="algorithm3.12.12.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="algorithm3.12.12.m1.1.1.1.1.1.1.3.2.cmml" xref="algorithm3.12.12.m1.1.1.1.1.1.1.3.2">𝐓</ci><cn id="algorithm3.12.12.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="algorithm3.12.12.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="algorithm3.12.12.m1.2.2.2.2.1.1.cmml" xref="algorithm3.12.12.m1.2.2.2.2.1"><times id="algorithm3.12.12.m1.2.2.2.2.1.1.1.cmml" xref="algorithm3.12.12.m1.2.2.2.2.1.1.1"></times><apply id="algorithm3.12.12.m1.2.2.2.2.1.1.2.cmml" xref="algorithm3.12.12.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="algorithm3.12.12.m1.2.2.2.2.1.1.2.1.cmml" xref="algorithm3.12.12.m1.2.2.2.2.1.1.2">superscript</csymbol><ci id="algorithm3.12.12.m1.2.2.2.2.1.1.2.2.cmml" xref="algorithm3.12.12.m1.2.2.2.2.1.1.2.2">𝑰</ci><cn id="algorithm3.12.12.m1.2.2.2.2.1.1.2.3.cmml" type="integer" xref="algorithm3.12.12.m1.2.2.2.2.1.1.2.3">2</cn></apply><apply id="algorithm3.12.12.m1.2.2.2.2.1.1.3.cmml" xref="algorithm3.12.12.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="algorithm3.12.12.m1.2.2.2.2.1.1.3.1.cmml" xref="algorithm3.12.12.m1.2.2.2.2.1.1.3">superscript</csymbol><ci id="algorithm3.12.12.m1.2.2.2.2.1.1.3.2.cmml" xref="algorithm3.12.12.m1.2.2.2.2.1.1.3.2">𝐓</ci><cn id="algorithm3.12.12.m1.2.2.2.2.1.1.3.3.cmml" type="integer" xref="algorithm3.12.12.m1.2.2.2.2.1.1.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.12.12.m1.2c">\hat{\bm{e}}=(\bm{I}^{1}\times\mathbf{T}^{1})\cdot(\bm{I}^{2}\times\mathbf{T}^%
{2})</annotation><annotation encoding="application/x-llamapun" id="algorithm3.12.12.m1.2d">over^ start_ARG bold_italic_e end_ARG = ( bold_italic_I start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT × bold_T start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) ⋅ ( bold_italic_I start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × bold_T start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.14.14">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm3.14.14.2">// </span><math alttext="\mathbf{T}^{1}\in\operatorname*{\mathbb{R}}^{m\times d}" class="ltx_Math" display="inline" id="algorithm3.13.13.m1.1"><semantics id="algorithm3.13.13.m1.1a"><mrow id="algorithm3.13.13.m1.1.1" xref="algorithm3.13.13.m1.1.1.cmml"><msup id="algorithm3.13.13.m1.1.1.2" xref="algorithm3.13.13.m1.1.1.2.cmml"><mi id="algorithm3.13.13.m1.1.1.2.2" xref="algorithm3.13.13.m1.1.1.2.2.cmml">𝐓</mi><mn id="algorithm3.13.13.m1.1.1.2.3" xref="algorithm3.13.13.m1.1.1.2.3.cmml">1</mn></msup><mo id="algorithm3.13.13.m1.1.1.1" rspace="0.1389em" xref="algorithm3.13.13.m1.1.1.1.cmml">∈</mo><msup id="algorithm3.13.13.m1.1.1.3" xref="algorithm3.13.13.m1.1.1.3.cmml"><mo id="algorithm3.13.13.m1.1.1.3.2" lspace="0.1389em" xref="algorithm3.13.13.m1.1.1.3.2.cmml">ℝ</mo><mrow id="algorithm3.13.13.m1.1.1.3.3" xref="algorithm3.13.13.m1.1.1.3.3.cmml"><mi id="algorithm3.13.13.m1.1.1.3.3.2" xref="algorithm3.13.13.m1.1.1.3.3.2.cmml">m</mi><mo id="algorithm3.13.13.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="algorithm3.13.13.m1.1.1.3.3.1.cmml">×</mo><mi id="algorithm3.13.13.m1.1.1.3.3.3" xref="algorithm3.13.13.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.13.13.m1.1b"><apply id="algorithm3.13.13.m1.1.1.cmml" xref="algorithm3.13.13.m1.1.1"><in id="algorithm3.13.13.m1.1.1.1.cmml" xref="algorithm3.13.13.m1.1.1.1"></in><apply id="algorithm3.13.13.m1.1.1.2.cmml" xref="algorithm3.13.13.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm3.13.13.m1.1.1.2.1.cmml" xref="algorithm3.13.13.m1.1.1.2">superscript</csymbol><ci id="algorithm3.13.13.m1.1.1.2.2.cmml" xref="algorithm3.13.13.m1.1.1.2.2">𝐓</ci><cn id="algorithm3.13.13.m1.1.1.2.3.cmml" type="integer" xref="algorithm3.13.13.m1.1.1.2.3">1</cn></apply><apply id="algorithm3.13.13.m1.1.1.3.cmml" xref="algorithm3.13.13.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm3.13.13.m1.1.1.3.1.cmml" xref="algorithm3.13.13.m1.1.1.3">superscript</csymbol><ci id="algorithm3.13.13.m1.1.1.3.2.cmml" xref="algorithm3.13.13.m1.1.1.3.2">ℝ</ci><apply id="algorithm3.13.13.m1.1.1.3.3.cmml" xref="algorithm3.13.13.m1.1.1.3.3"><times id="algorithm3.13.13.m1.1.1.3.3.1.cmml" xref="algorithm3.13.13.m1.1.1.3.3.1"></times><ci id="algorithm3.13.13.m1.1.1.3.3.2.cmml" xref="algorithm3.13.13.m1.1.1.3.3.2">𝑚</ci><ci id="algorithm3.13.13.m1.1.1.3.3.3.cmml" xref="algorithm3.13.13.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.13.13.m1.1c">\mathbf{T}^{1}\in\operatorname*{\mathbb{R}}^{m\times d}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.13.13.m1.1d">bold_T start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm3.14.14.1"> and <math alttext="\mathbf{T}^{2}\in\operatorname*{\mathbb{R}}^{n\times 1}" class="ltx_Math" display="inline" id="algorithm3.14.14.1.m1.1"><semantics id="algorithm3.14.14.1.m1.1a"><mrow id="algorithm3.14.14.1.m1.1.1" xref="algorithm3.14.14.1.m1.1.1.cmml"><msup id="algorithm3.14.14.1.m1.1.1.2" xref="algorithm3.14.14.1.m1.1.1.2.cmml"><mi id="algorithm3.14.14.1.m1.1.1.2.2" xref="algorithm3.14.14.1.m1.1.1.2.2.cmml">𝐓</mi><mn id="algorithm3.14.14.1.m1.1.1.2.3" xref="algorithm3.14.14.1.m1.1.1.2.3.cmml">2</mn></msup><mo id="algorithm3.14.14.1.m1.1.1.1" rspace="0.1389em" xref="algorithm3.14.14.1.m1.1.1.1.cmml">∈</mo><msup id="algorithm3.14.14.1.m1.1.1.3" xref="algorithm3.14.14.1.m1.1.1.3.cmml"><mo id="algorithm3.14.14.1.m1.1.1.3.2" lspace="0.1389em" xref="algorithm3.14.14.1.m1.1.1.3.2.cmml">ℝ</mo><mrow id="algorithm3.14.14.1.m1.1.1.3.3" xref="algorithm3.14.14.1.m1.1.1.3.3.cmml"><mi id="algorithm3.14.14.1.m1.1.1.3.3.2" xref="algorithm3.14.14.1.m1.1.1.3.3.2.cmml">n</mi><mo id="algorithm3.14.14.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="algorithm3.14.14.1.m1.1.1.3.3.1.cmml">×</mo><mn id="algorithm3.14.14.1.m1.1.1.3.3.3" xref="algorithm3.14.14.1.m1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.14.14.1.m1.1b"><apply id="algorithm3.14.14.1.m1.1.1.cmml" xref="algorithm3.14.14.1.m1.1.1"><in id="algorithm3.14.14.1.m1.1.1.1.cmml" xref="algorithm3.14.14.1.m1.1.1.1"></in><apply id="algorithm3.14.14.1.m1.1.1.2.cmml" xref="algorithm3.14.14.1.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm3.14.14.1.m1.1.1.2.1.cmml" xref="algorithm3.14.14.1.m1.1.1.2">superscript</csymbol><ci id="algorithm3.14.14.1.m1.1.1.2.2.cmml" xref="algorithm3.14.14.1.m1.1.1.2.2">𝐓</ci><cn id="algorithm3.14.14.1.m1.1.1.2.3.cmml" type="integer" xref="algorithm3.14.14.1.m1.1.1.2.3">2</cn></apply><apply id="algorithm3.14.14.1.m1.1.1.3.cmml" xref="algorithm3.14.14.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm3.14.14.1.m1.1.1.3.1.cmml" xref="algorithm3.14.14.1.m1.1.1.3">superscript</csymbol><ci id="algorithm3.14.14.1.m1.1.1.3.2.cmml" xref="algorithm3.14.14.1.m1.1.1.3.2">ℝ</ci><apply id="algorithm3.14.14.1.m1.1.1.3.3.cmml" xref="algorithm3.14.14.1.m1.1.1.3.3"><times id="algorithm3.14.14.1.m1.1.1.3.3.1.cmml" xref="algorithm3.14.14.1.m1.1.1.3.3.1"></times><ci id="algorithm3.14.14.1.m1.1.1.3.3.2.cmml" xref="algorithm3.14.14.1.m1.1.1.3.3.2">𝑛</ci><cn id="algorithm3.14.14.1.m1.1.1.3.3.3.cmml" type="integer" xref="algorithm3.14.14.1.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.14.14.1.m1.1c">\mathbf{T}^{2}\in\operatorname*{\mathbb{R}}^{n\times 1}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.14.14.1.m1.1d">bold_T start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × 1 end_POSTSUPERSCRIPT</annotation></semantics></math>.</span>
</div>
<div class="ltx_listingline" id="algorithm3.24.29">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm3.15.15">
<span class="ltx_text ltx_font_bold" id="algorithm3.15.15.2">Func</span> <em class="ltx_emph ltx_font_typewriter" id="algorithm3.15.15.1">BCH(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="algorithm3.15.15.1.1.1"><math alttext="\operatorname*{\texttt{id}}" class="ltx_Math" display="inline" id="algorithm3.15.15.1.1.1.m1.1"><semantics id="algorithm3.15.15.1.1.1.m1.1a"><mtext class="ltx_mathvariant_monospace" id="algorithm3.15.15.1.1.1.m1.1.1" xref="algorithm3.15.15.1.1.1.m1.1.1b.cmml"><em class="ltx_emph ltx_font_typewriter" id="algorithm3.15.15.1.1.1.m1.1.1.1nest">id</em></mtext><annotation-xml encoding="MathML-Content" id="algorithm3.15.15.1.1.1.m1.1b"><ci id="algorithm3.15.15.1.1.1.m1.1.1b.cmml" xref="algorithm3.15.15.1.1.1.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="algorithm3.15.15.1.1.1.m1.1.1.cmml" xref="algorithm3.15.15.1.1.1.m1.1.1"><em class="ltx_emph ltx_font_typewriter" id="algorithm3.15.15.1.1.1.m1.1.1.1anest">id</em></mtext></ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.15.15.1.1.1.m1.1c">\operatorname*{\texttt{id}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.15.15.1.1.1.m1.1d">id</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="algorithm3.15.15.3">:</span>
</div>
<div class="ltx_listingline" id="algorithm3.18.18">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
divide the bits within <math alttext="\operatorname*{\texttt{id}}" class="ltx_Math" display="inline" id="algorithm3.16.16.m1.1"><semantics id="algorithm3.16.16.m1.1a"><mtext class="ltx_mathvariant_monospace" id="algorithm3.16.16.m1.1.1" xref="algorithm3.16.16.m1.1.1a.cmml">id</mtext><annotation-xml encoding="MathML-Content" id="algorithm3.16.16.m1.1b"><ci id="algorithm3.16.16.m1.1.1a.cmml" xref="algorithm3.16.16.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="algorithm3.16.16.m1.1.1.cmml" xref="algorithm3.16.16.m1.1.1">id</mtext></ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.16.16.m1.1c">\operatorname*{\texttt{id}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.16.16.m1.1d">id</annotation></semantics></math> into <math alttext="s" class="ltx_Math" display="inline" id="algorithm3.17.17.m2.1"><semantics id="algorithm3.17.17.m2.1a"><mi id="algorithm3.17.17.m2.1.1" xref="algorithm3.17.17.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="algorithm3.17.17.m2.1b"><ci id="algorithm3.17.17.m2.1.1.cmml" xref="algorithm3.17.17.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.17.17.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="algorithm3.17.17.m2.1d">italic_s</annotation></semantics></math> sub-ids <math alttext="\{\operatorname*{\texttt{id}}_{1},...,\operatorname*{\texttt{id}}_{s}\}" class="ltx_Math" display="inline" id="algorithm3.18.18.m3.3"><semantics id="algorithm3.18.18.m3.3a"><mrow id="algorithm3.18.18.m3.3.3.2" xref="algorithm3.18.18.m3.3.3.3.cmml"><mo id="algorithm3.18.18.m3.3.3.2.3" stretchy="false" xref="algorithm3.18.18.m3.3.3.3.cmml">{</mo><msub id="algorithm3.18.18.m3.2.2.1.1" xref="algorithm3.18.18.m3.2.2.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm3.18.18.m3.2.2.1.1.2" xref="algorithm3.18.18.m3.2.2.1.1.2a.cmml">id</mtext><mn id="algorithm3.18.18.m3.2.2.1.1.3" xref="algorithm3.18.18.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="algorithm3.18.18.m3.3.3.2.4" xref="algorithm3.18.18.m3.3.3.3.cmml">,</mo><mi id="algorithm3.18.18.m3.1.1" mathvariant="normal" xref="algorithm3.18.18.m3.1.1.cmml">…</mi><mo id="algorithm3.18.18.m3.3.3.2.5" xref="algorithm3.18.18.m3.3.3.3.cmml">,</mo><msub id="algorithm3.18.18.m3.3.3.2.2" xref="algorithm3.18.18.m3.3.3.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm3.18.18.m3.3.3.2.2.2" xref="algorithm3.18.18.m3.3.3.2.2.2a.cmml">id</mtext><mi id="algorithm3.18.18.m3.3.3.2.2.3" xref="algorithm3.18.18.m3.3.3.2.2.3.cmml">s</mi></msub><mo id="algorithm3.18.18.m3.3.3.2.6" stretchy="false" xref="algorithm3.18.18.m3.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.18.18.m3.3b"><set id="algorithm3.18.18.m3.3.3.3.cmml" xref="algorithm3.18.18.m3.3.3.2"><apply id="algorithm3.18.18.m3.2.2.1.1.cmml" xref="algorithm3.18.18.m3.2.2.1.1"><csymbol cd="ambiguous" id="algorithm3.18.18.m3.2.2.1.1.1.cmml" xref="algorithm3.18.18.m3.2.2.1.1">subscript</csymbol><ci id="algorithm3.18.18.m3.2.2.1.1.2a.cmml" xref="algorithm3.18.18.m3.2.2.1.1.2"><mtext class="ltx_mathvariant_monospace" id="algorithm3.18.18.m3.2.2.1.1.2.cmml" xref="algorithm3.18.18.m3.2.2.1.1.2">id</mtext></ci><cn id="algorithm3.18.18.m3.2.2.1.1.3.cmml" type="integer" xref="algorithm3.18.18.m3.2.2.1.1.3">1</cn></apply><ci id="algorithm3.18.18.m3.1.1.cmml" xref="algorithm3.18.18.m3.1.1">…</ci><apply id="algorithm3.18.18.m3.3.3.2.2.cmml" xref="algorithm3.18.18.m3.3.3.2.2"><csymbol cd="ambiguous" id="algorithm3.18.18.m3.3.3.2.2.1.cmml" xref="algorithm3.18.18.m3.3.3.2.2">subscript</csymbol><ci id="algorithm3.18.18.m3.3.3.2.2.2a.cmml" xref="algorithm3.18.18.m3.3.3.2.2.2"><mtext class="ltx_mathvariant_monospace" id="algorithm3.18.18.m3.3.3.2.2.2.cmml" xref="algorithm3.18.18.m3.3.3.2.2.2">id</mtext></ci><ci id="algorithm3.18.18.m3.3.3.2.2.3.cmml" xref="algorithm3.18.18.m3.3.3.2.2.3">𝑠</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.18.18.m3.3c">\{\operatorname*{\texttt{id}}_{1},...,\operatorname*{\texttt{id}}_{s}\}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.18.18.m3.3d">{ id start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , id start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT }</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="algorithm3.19.19">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\hat{\bm{e}}=\sum_{i=1}^{s}\operatorname*{one-hot}(\operatorname*{\texttt{id}}%
_{i})\times\mathbf{T}" class="ltx_Math" display="inline" id="algorithm3.19.19.m1.2"><semantics id="algorithm3.19.19.m1.2a"><mrow id="algorithm3.19.19.m1.2.2" xref="algorithm3.19.19.m1.2.2.cmml"><mover accent="true" id="algorithm3.19.19.m1.2.2.3" xref="algorithm3.19.19.m1.2.2.3.cmml"><mi id="algorithm3.19.19.m1.2.2.3.2" xref="algorithm3.19.19.m1.2.2.3.2.cmml">𝒆</mi><mo id="algorithm3.19.19.m1.2.2.3.1" xref="algorithm3.19.19.m1.2.2.3.1.cmml">^</mo></mover><mo id="algorithm3.19.19.m1.2.2.2" rspace="0.111em" xref="algorithm3.19.19.m1.2.2.2.cmml">=</mo><mrow id="algorithm3.19.19.m1.2.2.1" xref="algorithm3.19.19.m1.2.2.1.cmml"><msubsup id="algorithm3.19.19.m1.2.2.1.2" xref="algorithm3.19.19.m1.2.2.1.2.cmml"><mo id="algorithm3.19.19.m1.2.2.1.2.2.2" xref="algorithm3.19.19.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="algorithm3.19.19.m1.2.2.1.2.2.3" xref="algorithm3.19.19.m1.2.2.1.2.2.3.cmml"><mi id="algorithm3.19.19.m1.2.2.1.2.2.3.2" xref="algorithm3.19.19.m1.2.2.1.2.2.3.2.cmml">i</mi><mo id="algorithm3.19.19.m1.2.2.1.2.2.3.1" xref="algorithm3.19.19.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="algorithm3.19.19.m1.2.2.1.2.2.3.3" xref="algorithm3.19.19.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="algorithm3.19.19.m1.2.2.1.2.3" xref="algorithm3.19.19.m1.2.2.1.2.3.cmml">s</mi></msubsup><mrow id="algorithm3.19.19.m1.2.2.1.1" xref="algorithm3.19.19.m1.2.2.1.1.cmml"><mrow id="algorithm3.19.19.m1.2.2.1.1.1.1" xref="algorithm3.19.19.m1.2.2.1.1.1.2.cmml"><mrow id="algorithm3.19.19.m1.1.1" xref="algorithm3.19.19.m1.1.1.cmml"><mi id="algorithm3.19.19.m1.1.1.2" xref="algorithm3.19.19.m1.1.1.2.cmml">one</mi><mo id="algorithm3.19.19.m1.1.1.1" xref="algorithm3.19.19.m1.1.1.1.cmml">−</mo><mi id="algorithm3.19.19.m1.1.1.3" xref="algorithm3.19.19.m1.1.1.3.cmml">hot</mi></mrow><mo id="algorithm3.19.19.m1.2.2.1.1.1.1a" xref="algorithm3.19.19.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="algorithm3.19.19.m1.2.2.1.1.1.1.1" xref="algorithm3.19.19.m1.2.2.1.1.1.2.cmml"><mo id="algorithm3.19.19.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="algorithm3.19.19.m1.2.2.1.1.1.2.cmml">(</mo><msub id="algorithm3.19.19.m1.2.2.1.1.1.1.1.1" xref="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.2" xref="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.2a.cmml">id</mtext><mi id="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.3" xref="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm3.19.19.m1.2.2.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="algorithm3.19.19.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="algorithm3.19.19.m1.2.2.1.1.2" rspace="0.222em" xref="algorithm3.19.19.m1.2.2.1.1.2.cmml">×</mo><mi id="algorithm3.19.19.m1.2.2.1.1.3" xref="algorithm3.19.19.m1.2.2.1.1.3.cmml">𝐓</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.19.19.m1.2b"><apply id="algorithm3.19.19.m1.2.2.cmml" xref="algorithm3.19.19.m1.2.2"><eq id="algorithm3.19.19.m1.2.2.2.cmml" xref="algorithm3.19.19.m1.2.2.2"></eq><apply id="algorithm3.19.19.m1.2.2.3.cmml" xref="algorithm3.19.19.m1.2.2.3"><ci id="algorithm3.19.19.m1.2.2.3.1.cmml" xref="algorithm3.19.19.m1.2.2.3.1">^</ci><ci id="algorithm3.19.19.m1.2.2.3.2.cmml" xref="algorithm3.19.19.m1.2.2.3.2">𝒆</ci></apply><apply id="algorithm3.19.19.m1.2.2.1.cmml" xref="algorithm3.19.19.m1.2.2.1"><apply id="algorithm3.19.19.m1.2.2.1.2.cmml" xref="algorithm3.19.19.m1.2.2.1.2"><csymbol cd="ambiguous" id="algorithm3.19.19.m1.2.2.1.2.1.cmml" xref="algorithm3.19.19.m1.2.2.1.2">superscript</csymbol><apply id="algorithm3.19.19.m1.2.2.1.2.2.cmml" xref="algorithm3.19.19.m1.2.2.1.2"><csymbol cd="ambiguous" id="algorithm3.19.19.m1.2.2.1.2.2.1.cmml" xref="algorithm3.19.19.m1.2.2.1.2">subscript</csymbol><sum id="algorithm3.19.19.m1.2.2.1.2.2.2.cmml" xref="algorithm3.19.19.m1.2.2.1.2.2.2"></sum><apply id="algorithm3.19.19.m1.2.2.1.2.2.3.cmml" xref="algorithm3.19.19.m1.2.2.1.2.2.3"><eq id="algorithm3.19.19.m1.2.2.1.2.2.3.1.cmml" xref="algorithm3.19.19.m1.2.2.1.2.2.3.1"></eq><ci id="algorithm3.19.19.m1.2.2.1.2.2.3.2.cmml" xref="algorithm3.19.19.m1.2.2.1.2.2.3.2">𝑖</ci><cn id="algorithm3.19.19.m1.2.2.1.2.2.3.3.cmml" type="integer" xref="algorithm3.19.19.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="algorithm3.19.19.m1.2.2.1.2.3.cmml" xref="algorithm3.19.19.m1.2.2.1.2.3">𝑠</ci></apply><apply id="algorithm3.19.19.m1.2.2.1.1.cmml" xref="algorithm3.19.19.m1.2.2.1.1"><times id="algorithm3.19.19.m1.2.2.1.1.2.cmml" xref="algorithm3.19.19.m1.2.2.1.1.2"></times><apply id="algorithm3.19.19.m1.2.2.1.1.1.2.cmml" xref="algorithm3.19.19.m1.2.2.1.1.1.1"><apply id="algorithm3.19.19.m1.1.1.cmml" xref="algorithm3.19.19.m1.1.1"><minus id="algorithm3.19.19.m1.1.1.1.cmml" xref="algorithm3.19.19.m1.1.1.1"></minus><ci id="algorithm3.19.19.m1.1.1.2.cmml" xref="algorithm3.19.19.m1.1.1.2">one</ci><ci id="algorithm3.19.19.m1.1.1.3.cmml" xref="algorithm3.19.19.m1.1.1.3">hot</ci></apply><apply id="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.cmml" xref="algorithm3.19.19.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.1.cmml" xref="algorithm3.19.19.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.2a.cmml" xref="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.2.cmml" xref="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.2">id</mtext></ci><ci id="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.3.cmml" xref="algorithm3.19.19.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="algorithm3.19.19.m1.2.2.1.1.3.cmml" xref="algorithm3.19.19.m1.2.2.1.1.3">𝐓</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.19.19.m1.2c">\hat{\bm{e}}=\sum_{i=1}^{s}\operatorname*{one-hot}(\operatorname*{\texttt{id}}%
_{i})\times\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.19.19.m1.2d">over^ start_ARG bold_italic_e end_ARG = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT start_OPERATOR roman_one - roman_hot end_OPERATOR ( id start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) × bold_T</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.20.20">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm3.20.20.1">// </span><math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="algorithm3.20.20.m1.1"><semantics id="algorithm3.20.20.m1.1a"><mi id="algorithm3.20.20.m1.1.1" xref="algorithm3.20.20.m1.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="algorithm3.20.20.m1.1b"><ci id="algorithm3.20.20.m1.1.1.cmml" xref="algorithm3.20.20.m1.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.20.20.m1.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.20.20.m1.1d">bold_T</annotation></semantics></math><span class="ltx_text ltx_font_typewriter" id="algorithm3.20.20.2"> is a shared meta-table.</span>
</div>
<div class="ltx_listingline" id="algorithm3.24.30">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm3.21.21">
<span class="ltx_text ltx_font_bold" id="algorithm3.21.21.2">Func</span> <em class="ltx_emph ltx_font_typewriter" id="algorithm3.21.21.1">FDH(<em class="ltx_emph ltx_font_serif ltx_font_italic" id="algorithm3.21.21.1.1.1"><math alttext="\operatorname*{\texttt{id}}" class="ltx_Math" display="inline" id="algorithm3.21.21.1.1.1.m1.1"><semantics id="algorithm3.21.21.1.1.1.m1.1a"><mtext class="ltx_mathvariant_monospace" id="algorithm3.21.21.1.1.1.m1.1.1" xref="algorithm3.21.21.1.1.1.m1.1.1b.cmml"><em class="ltx_emph ltx_font_typewriter" id="algorithm3.21.21.1.1.1.m1.1.1.1nest">id</em></mtext><annotation-xml encoding="MathML-Content" id="algorithm3.21.21.1.1.1.m1.1b"><ci id="algorithm3.21.21.1.1.1.m1.1.1b.cmml" xref="algorithm3.21.21.1.1.1.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="algorithm3.21.21.1.1.1.m1.1.1.cmml" xref="algorithm3.21.21.1.1.1.m1.1.1"><em class="ltx_emph ltx_font_typewriter" id="algorithm3.21.21.1.1.1.m1.1.1.1anest">id</em></mtext></ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.21.21.1.1.1.m1.1c">\operatorname*{\texttt{id}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.21.21.1.1.1.m1.1d">id</annotation></semantics></math></em>)</em><span class="ltx_text ltx_font_bold" id="algorithm3.21.21.3">:</span>
</div>
<div class="ltx_listingline" id="algorithm3.22.22">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="algorithm3.22.22.2">if</span> <em class="ltx_emph ltx_font_italic" id="algorithm3.22.22.1">feature <math alttext="\operatorname*{\texttt{id}}" class="ltx_Math" display="inline" id="algorithm3.22.22.1.m1.1"><semantics id="algorithm3.22.22.1.m1.1a"><mtext class="ltx_mathvariant_monospace" id="algorithm3.22.22.1.m1.1.1" xref="algorithm3.22.22.1.m1.1.1b.cmml"><em class="ltx_emph ltx_font_typewriter" id="algorithm3.22.22.1.m1.1.1.1nest">id</em></mtext><annotation-xml encoding="MathML-Content" id="algorithm3.22.22.1.m1.1b"><ci id="algorithm3.22.22.1.m1.1.1b.cmml" xref="algorithm3.22.22.1.m1.1.1"><mtext class="ltx_mathvariant_monospace" id="algorithm3.22.22.1.m1.1.1.cmml" xref="algorithm3.22.22.1.m1.1.1"><em class="ltx_emph ltx_font_typewriter" id="algorithm3.22.22.1.m1.1.1.1anest">id</em></mtext></ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.22.22.1.m1.1c">\operatorname*{\texttt{id}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.22.22.1.m1.1d">id</annotation></semantics></math> is frequent</em> <span class="ltx_text ltx_font_bold" id="algorithm3.22.22.3">then</span>
</div>
<div class="ltx_listingline" id="algorithm3.23.23">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\hat{\bm{e}}:=\operatorname*{\mathbb{R}}^{d}" class="ltx_Math" display="inline" id="algorithm3.23.23.m1.1"><semantics id="algorithm3.23.23.m1.1a"><mrow id="algorithm3.23.23.m1.1.1" xref="algorithm3.23.23.m1.1.1.cmml"><mover accent="true" id="algorithm3.23.23.m1.1.1.2" xref="algorithm3.23.23.m1.1.1.2.cmml"><mi id="algorithm3.23.23.m1.1.1.2.2" xref="algorithm3.23.23.m1.1.1.2.2.cmml">𝒆</mi><mo id="algorithm3.23.23.m1.1.1.2.1" xref="algorithm3.23.23.m1.1.1.2.1.cmml">^</mo></mover><mo id="algorithm3.23.23.m1.1.1.1" lspace="0.278em" xref="algorithm3.23.23.m1.1.1.1.cmml">:=</mo><msup id="algorithm3.23.23.m1.1.1.3" xref="algorithm3.23.23.m1.1.1.3.cmml"><mo id="algorithm3.23.23.m1.1.1.3.2" lspace="0.111em" xref="algorithm3.23.23.m1.1.1.3.2.cmml">ℝ</mo><mi id="algorithm3.23.23.m1.1.1.3.3" xref="algorithm3.23.23.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.23.23.m1.1b"><apply id="algorithm3.23.23.m1.1.1.cmml" xref="algorithm3.23.23.m1.1.1"><csymbol cd="latexml" id="algorithm3.23.23.m1.1.1.1.cmml" xref="algorithm3.23.23.m1.1.1.1">assign</csymbol><apply id="algorithm3.23.23.m1.1.1.2.cmml" xref="algorithm3.23.23.m1.1.1.2"><ci id="algorithm3.23.23.m1.1.1.2.1.cmml" xref="algorithm3.23.23.m1.1.1.2.1">^</ci><ci id="algorithm3.23.23.m1.1.1.2.2.cmml" xref="algorithm3.23.23.m1.1.1.2.2">𝒆</ci></apply><apply id="algorithm3.23.23.m1.1.1.3.cmml" xref="algorithm3.23.23.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm3.23.23.m1.1.1.3.1.cmml" xref="algorithm3.23.23.m1.1.1.3">superscript</csymbol><ci id="algorithm3.23.23.m1.1.1.3.2.cmml" xref="algorithm3.23.23.m1.1.1.3.2">ℝ</ci><ci id="algorithm3.23.23.m1.1.1.3.3.cmml" xref="algorithm3.23.23.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.23.23.m1.1c">\hat{\bm{e}}:=\operatorname*{\mathbb{R}}^{d}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.23.23.m1.1d">over^ start_ARG bold_italic_e end_ARG := blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.24.31">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_text ltx_font_typewriter" id="algorithm3.24.31.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm3.24.31.2">frequent features have unique embeddings.</span>
</div>
<div class="ltx_listingline" id="algorithm3.24.32">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm3.24.33">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm3.24.33.1">else</span>
</div>
<div class="ltx_listingline" id="algorithm3.24.24">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\hat{\bm{e}}=\text{QR}(\operatorname*{\texttt{id}})" class="ltx_Math" display="inline" id="algorithm3.24.24.m1.1"><semantics id="algorithm3.24.24.m1.1a"><mrow id="algorithm3.24.24.m1.1.2" xref="algorithm3.24.24.m1.1.2.cmml"><mover accent="true" id="algorithm3.24.24.m1.1.2.2" xref="algorithm3.24.24.m1.1.2.2.cmml"><mi id="algorithm3.24.24.m1.1.2.2.2" xref="algorithm3.24.24.m1.1.2.2.2.cmml">𝒆</mi><mo id="algorithm3.24.24.m1.1.2.2.1" xref="algorithm3.24.24.m1.1.2.2.1.cmml">^</mo></mover><mo id="algorithm3.24.24.m1.1.2.1" xref="algorithm3.24.24.m1.1.2.1.cmml">=</mo><mrow id="algorithm3.24.24.m1.1.2.3" xref="algorithm3.24.24.m1.1.2.3.cmml"><mtext id="algorithm3.24.24.m1.1.2.3.2" xref="algorithm3.24.24.m1.1.2.3.2a.cmml">QR</mtext><mo id="algorithm3.24.24.m1.1.2.3.1" xref="algorithm3.24.24.m1.1.2.3.1.cmml">⁢</mo><mrow id="algorithm3.24.24.m1.1.2.3.3.2" xref="algorithm3.24.24.m1.1.1a.cmml"><mo id="algorithm3.24.24.m1.1.2.3.3.2.1" stretchy="false" xref="algorithm3.24.24.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_monospace" id="algorithm3.24.24.m1.1.1" xref="algorithm3.24.24.m1.1.1.cmml">id</mtext><mo id="algorithm3.24.24.m1.1.2.3.3.2.2" stretchy="false" xref="algorithm3.24.24.m1.1.1a.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.24.24.m1.1b"><apply id="algorithm3.24.24.m1.1.2.cmml" xref="algorithm3.24.24.m1.1.2"><eq id="algorithm3.24.24.m1.1.2.1.cmml" xref="algorithm3.24.24.m1.1.2.1"></eq><apply id="algorithm3.24.24.m1.1.2.2.cmml" xref="algorithm3.24.24.m1.1.2.2"><ci id="algorithm3.24.24.m1.1.2.2.1.cmml" xref="algorithm3.24.24.m1.1.2.2.1">^</ci><ci id="algorithm3.24.24.m1.1.2.2.2.cmml" xref="algorithm3.24.24.m1.1.2.2.2">𝒆</ci></apply><apply id="algorithm3.24.24.m1.1.2.3.cmml" xref="algorithm3.24.24.m1.1.2.3"><times id="algorithm3.24.24.m1.1.2.3.1.cmml" xref="algorithm3.24.24.m1.1.2.3.1"></times><ci id="algorithm3.24.24.m1.1.2.3.2a.cmml" xref="algorithm3.24.24.m1.1.2.3.2"><mtext id="algorithm3.24.24.m1.1.2.3.2.cmml" xref="algorithm3.24.24.m1.1.2.3.2">QR</mtext></ci><ci id="algorithm3.24.24.m1.1.1a.cmml" xref="algorithm3.24.24.m1.1.2.3.3.2"><mtext class="ltx_mathvariant_monospace" id="algorithm3.24.24.m1.1.1.cmml" xref="algorithm3.24.24.m1.1.1">id</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.24.24.m1.1c">\hat{\bm{e}}=\text{QR}(\operatorname*{\texttt{id}})</annotation><annotation encoding="application/x-llamapun" id="algorithm3.24.24.m1.1d">over^ start_ARG bold_italic_e end_ARG = QR ( id )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.24.34"> 

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm3.26.1.1">Algorithm 3</span> </span>Comparison between QR <cite class="ltx_cite ltx_citemacro_citep">(Shi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib51" title="">2020</a>)</cite>, MEmCom <cite class="ltx_cite ltx_citemacro_citep">(Pansare et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib48" title="">2022</a>)</cite>, BCH <cite class="ltx_cite ltx_citemacro_citep">(Yan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib68" title="">2021a</a>)</cite> and FDH <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib73" title="">2020</a>)</cite>.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.14">To reduce the collisions, existing hashing methods use multiple hash functions to process the feature id.
They usually maintain multiple meta-tables (<math alttext="\mathbf{T}^{1},...,\mathbf{T}^{s}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.3"><semantics id="S4.SS1.p2.1.m1.3a"><mrow id="S4.SS1.p2.1.m1.3.3.2" xref="S4.SS1.p2.1.m1.3.3.3.cmml"><msup id="S4.SS1.p2.1.m1.2.2.1.1" xref="S4.SS1.p2.1.m1.2.2.1.1.cmml"><mi id="S4.SS1.p2.1.m1.2.2.1.1.2" xref="S4.SS1.p2.1.m1.2.2.1.1.2.cmml">𝐓</mi><mn id="S4.SS1.p2.1.m1.2.2.1.1.3" xref="S4.SS1.p2.1.m1.2.2.1.1.3.cmml">1</mn></msup><mo id="S4.SS1.p2.1.m1.3.3.2.3" xref="S4.SS1.p2.1.m1.3.3.3.cmml">,</mo><mi id="S4.SS1.p2.1.m1.1.1" mathvariant="normal" xref="S4.SS1.p2.1.m1.1.1.cmml">…</mi><mo id="S4.SS1.p2.1.m1.3.3.2.4" xref="S4.SS1.p2.1.m1.3.3.3.cmml">,</mo><msup id="S4.SS1.p2.1.m1.3.3.2.2" xref="S4.SS1.p2.1.m1.3.3.2.2.cmml"><mi id="S4.SS1.p2.1.m1.3.3.2.2.2" xref="S4.SS1.p2.1.m1.3.3.2.2.2.cmml">𝐓</mi><mi id="S4.SS1.p2.1.m1.3.3.2.2.3" xref="S4.SS1.p2.1.m1.3.3.2.2.3.cmml">s</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.3b"><list id="S4.SS1.p2.1.m1.3.3.3.cmml" xref="S4.SS1.p2.1.m1.3.3.2"><apply id="S4.SS1.p2.1.m1.2.2.1.1.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1">superscript</csymbol><ci id="S4.SS1.p2.1.m1.2.2.1.1.2.cmml" xref="S4.SS1.p2.1.m1.2.2.1.1.2">𝐓</ci><cn id="S4.SS1.p2.1.m1.2.2.1.1.3.cmml" type="integer" xref="S4.SS1.p2.1.m1.2.2.1.1.3">1</cn></apply><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">…</ci><apply id="S4.SS1.p2.1.m1.3.3.2.2.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.3.3.2.2.1.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2">superscript</csymbol><ci id="S4.SS1.p2.1.m1.3.3.2.2.2.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.2">𝐓</ci><ci id="S4.SS1.p2.1.m1.3.3.2.2.3.cmml" xref="S4.SS1.p2.1.m1.3.3.2.2.3">𝑠</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.3c">\mathbf{T}^{1},...,\mathbf{T}^{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.3d">bold_T start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , bold_T start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math>) and generate multiple index vectors as <math alttext="\bm{I}^{i}=\operatorname*{one-hot}(\text{hash}^{i}(\operatorname*{\texttt{id}}))" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.3"><semantics id="S4.SS1.p2.2.m2.3a"><mrow id="S4.SS1.p2.2.m2.3.3" xref="S4.SS1.p2.2.m2.3.3.cmml"><msup id="S4.SS1.p2.2.m2.3.3.3" xref="S4.SS1.p2.2.m2.3.3.3.cmml"><mi id="S4.SS1.p2.2.m2.3.3.3.2" xref="S4.SS1.p2.2.m2.3.3.3.2.cmml">𝑰</mi><mi id="S4.SS1.p2.2.m2.3.3.3.3" xref="S4.SS1.p2.2.m2.3.3.3.3.cmml">i</mi></msup><mo id="S4.SS1.p2.2.m2.3.3.2" xref="S4.SS1.p2.2.m2.3.3.2.cmml">=</mo><mrow id="S4.SS1.p2.2.m2.3.3.1.1" xref="S4.SS1.p2.2.m2.3.3.1.2.cmml"><mrow id="S4.SS1.p2.2.m2.2.2" xref="S4.SS1.p2.2.m2.2.2.cmml"><mi id="S4.SS1.p2.2.m2.2.2.2" xref="S4.SS1.p2.2.m2.2.2.2.cmml">one</mi><mo id="S4.SS1.p2.2.m2.2.2.1" xref="S4.SS1.p2.2.m2.2.2.1.cmml">−</mo><mi id="S4.SS1.p2.2.m2.2.2.3" xref="S4.SS1.p2.2.m2.2.2.3.cmml">hot</mi></mrow><mo id="S4.SS1.p2.2.m2.3.3.1.1a" xref="S4.SS1.p2.2.m2.3.3.1.2.cmml">⁡</mo><mrow id="S4.SS1.p2.2.m2.3.3.1.1.1" xref="S4.SS1.p2.2.m2.3.3.1.2.cmml"><mo id="S4.SS1.p2.2.m2.3.3.1.1.1.2" stretchy="false" xref="S4.SS1.p2.2.m2.3.3.1.2.cmml">(</mo><mrow id="S4.SS1.p2.2.m2.3.3.1.1.1.1" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.cmml"><msup id="S4.SS1.p2.2.m2.3.3.1.1.1.1.2" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.cmml"><mtext id="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.2" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.2a.cmml">hash</mtext><mi id="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.3" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.3.cmml">i</mi></msup><mo id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS1.p2.2.m2.3.3.1.1.1.1.3.2" xref="S4.SS1.p2.2.m2.1.1a.cmml"><mo id="S4.SS1.p2.2.m2.3.3.1.1.1.1.3.2.1" stretchy="false" xref="S4.SS1.p2.2.m2.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">id</mtext><mo id="S4.SS1.p2.2.m2.3.3.1.1.1.1.3.2.2" stretchy="false" xref="S4.SS1.p2.2.m2.1.1a.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p2.2.m2.3.3.1.1.1.3" stretchy="false" xref="S4.SS1.p2.2.m2.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.3b"><apply id="S4.SS1.p2.2.m2.3.3.cmml" xref="S4.SS1.p2.2.m2.3.3"><eq id="S4.SS1.p2.2.m2.3.3.2.cmml" xref="S4.SS1.p2.2.m2.3.3.2"></eq><apply id="S4.SS1.p2.2.m2.3.3.3.cmml" xref="S4.SS1.p2.2.m2.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.3.1.cmml" xref="S4.SS1.p2.2.m2.3.3.3">superscript</csymbol><ci id="S4.SS1.p2.2.m2.3.3.3.2.cmml" xref="S4.SS1.p2.2.m2.3.3.3.2">𝑰</ci><ci id="S4.SS1.p2.2.m2.3.3.3.3.cmml" xref="S4.SS1.p2.2.m2.3.3.3.3">𝑖</ci></apply><apply id="S4.SS1.p2.2.m2.3.3.1.2.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1"><apply id="S4.SS1.p2.2.m2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2"><minus id="S4.SS1.p2.2.m2.2.2.1.cmml" xref="S4.SS1.p2.2.m2.2.2.1"></minus><ci id="S4.SS1.p2.2.m2.2.2.2.cmml" xref="S4.SS1.p2.2.m2.2.2.2">one</ci><ci id="S4.SS1.p2.2.m2.2.2.3.cmml" xref="S4.SS1.p2.2.m2.2.2.3">hot</ci></apply><apply id="S4.SS1.p2.2.m2.3.3.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1"><times id="S4.SS1.p2.2.m2.3.3.1.1.1.1.1.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.1"></times><apply id="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2">superscript</csymbol><ci id="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.2a.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.2"><mtext id="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.2">hash</mtext></ci><ci id="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.3.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.p2.2.m2.1.1a.cmml" xref="S4.SS1.p2.2.m2.3.3.1.1.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">id</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.3c">\bm{I}^{i}=\operatorname*{one-hot}(\text{hash}^{i}(\operatorname*{\texttt{id}}))</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.3d">bold_italic_I start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = start_OPERATOR roman_one - roman_hot end_OPERATOR ( hash start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ( id ) )</annotation></semantics></math>,
where <math alttext="i\in[1,s]" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.2"><semantics id="S4.SS1.p2.3.m3.2a"><mrow id="S4.SS1.p2.3.m3.2.3" xref="S4.SS1.p2.3.m3.2.3.cmml"><mi id="S4.SS1.p2.3.m3.2.3.2" xref="S4.SS1.p2.3.m3.2.3.2.cmml">i</mi><mo id="S4.SS1.p2.3.m3.2.3.1" xref="S4.SS1.p2.3.m3.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p2.3.m3.2.3.3.2" xref="S4.SS1.p2.3.m3.2.3.3.1.cmml"><mo id="S4.SS1.p2.3.m3.2.3.3.2.1" stretchy="false" xref="S4.SS1.p2.3.m3.2.3.3.1.cmml">[</mo><mn id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">1</mn><mo id="S4.SS1.p2.3.m3.2.3.3.2.2" xref="S4.SS1.p2.3.m3.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p2.3.m3.2.2" xref="S4.SS1.p2.3.m3.2.2.cmml">s</mi><mo id="S4.SS1.p2.3.m3.2.3.3.2.3" stretchy="false" xref="S4.SS1.p2.3.m3.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.2b"><apply id="S4.SS1.p2.3.m3.2.3.cmml" xref="S4.SS1.p2.3.m3.2.3"><in id="S4.SS1.p2.3.m3.2.3.1.cmml" xref="S4.SS1.p2.3.m3.2.3.1"></in><ci id="S4.SS1.p2.3.m3.2.3.2.cmml" xref="S4.SS1.p2.3.m3.2.3.2">𝑖</ci><interval closure="closed" id="S4.SS1.p2.3.m3.2.3.3.1.cmml" xref="S4.SS1.p2.3.m3.2.3.3.2"><cn id="S4.SS1.p2.3.m3.1.1.cmml" type="integer" xref="S4.SS1.p2.3.m3.1.1">1</cn><ci id="S4.SS1.p2.3.m3.2.2.cmml" xref="S4.SS1.p2.3.m3.2.2">𝑠</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.2c">i\in[1,s]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.2d">italic_i ∈ [ 1 , italic_s ]</annotation></semantics></math> and <math alttext="\{\text{hash}^{i}\}_{i=1}^{s}" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><msubsup id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mrow id="S4.SS1.p2.4.m4.1.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.2.cmml"><mo id="S4.SS1.p2.4.m4.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p2.4.m4.1.1.1.1.2.cmml">{</mo><msup id="S4.SS1.p2.4.m4.1.1.1.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.cmml"><mtext id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2a.cmml">hash</mtext><mi id="S4.SS1.p2.4.m4.1.1.1.1.1.1.3" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S4.SS1.p2.4.m4.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p2.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p2.4.m4.1.1.1.3" xref="S4.SS1.p2.4.m4.1.1.1.3.cmml"><mi id="S4.SS1.p2.4.m4.1.1.1.3.2" xref="S4.SS1.p2.4.m4.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p2.4.m4.1.1.1.3.1" xref="S4.SS1.p2.4.m4.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p2.4.m4.1.1.1.3.3" xref="S4.SS1.p2.4.m4.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1">superscript</csymbol><apply id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1">subscript</csymbol><set id="S4.SS1.p2.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1"><apply id="S4.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2a.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2"><mtext id="S4.SS1.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.2">hash</mtext></ci><ci id="S4.SS1.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS1.p2.4.m4.1.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.1.3"><eq id="S4.SS1.p2.4.m4.1.1.1.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1.3.1"></eq><ci id="S4.SS1.p2.4.m4.1.1.1.3.2.cmml" xref="S4.SS1.p2.4.m4.1.1.1.3.2">𝑖</ci><cn id="S4.SS1.p2.4.m4.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p2.4.m4.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\{\text{hash}^{i}\}_{i=1}^{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">{ hash start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> is a group of hash functions.
For example, QR <cite class="ltx_cite ltx_citemacro_citep">(Shi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib51" title="">2020</a>)</cite> maintain two meta-tables and use the quotient function and the reminder function to generate two index vectors.
Similarly, MEmCom <cite class="ltx_cite ltx_citemacro_citep">(Pansare et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib48" title="">2022</a>)</cite> also maintain two meta-tables (<math alttext="\mathbf{T}^{1}\in\operatorname*{\mathbb{R}}^{m\times d}" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><mrow id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><msup id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml"><mi id="S4.SS1.p2.5.m5.1.1.2.2" xref="S4.SS1.p2.5.m5.1.1.2.2.cmml">𝐓</mi><mn id="S4.SS1.p2.5.m5.1.1.2.3" xref="S4.SS1.p2.5.m5.1.1.2.3.cmml">1</mn></msup><mo id="S4.SS1.p2.5.m5.1.1.1" rspace="0.1389em" xref="S4.SS1.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml"><mo id="S4.SS1.p2.5.m5.1.1.3.2" lspace="0.1389em" xref="S4.SS1.p2.5.m5.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS1.p2.5.m5.1.1.3.3" xref="S4.SS1.p2.5.m5.1.1.3.3.cmml"><mi id="S4.SS1.p2.5.m5.1.1.3.3.2" xref="S4.SS1.p2.5.m5.1.1.3.3.2.cmml">m</mi><mo id="S4.SS1.p2.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.5.m5.1.1.3.3.3" xref="S4.SS1.p2.5.m5.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><in id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1.1"></in><apply id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m5.1.1.2.1.cmml" xref="S4.SS1.p2.5.m5.1.1.2">superscript</csymbol><ci id="S4.SS1.p2.5.m5.1.1.2.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2.2">𝐓</ci><cn id="S4.SS1.p2.5.m5.1.1.2.3.cmml" type="integer" xref="S4.SS1.p2.5.m5.1.1.2.3">1</cn></apply><apply id="S4.SS1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m5.1.1.3.1.cmml" xref="S4.SS1.p2.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.5.m5.1.1.3.2.cmml" xref="S4.SS1.p2.5.m5.1.1.3.2">ℝ</ci><apply id="S4.SS1.p2.5.m5.1.1.3.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3.3"><times id="S4.SS1.p2.5.m5.1.1.3.3.1.cmml" xref="S4.SS1.p2.5.m5.1.1.3.3.1"></times><ci id="S4.SS1.p2.5.m5.1.1.3.3.2.cmml" xref="S4.SS1.p2.5.m5.1.1.3.3.2">𝑚</ci><ci id="S4.SS1.p2.5.m5.1.1.3.3.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">\mathbf{T}^{1}\in\operatorname*{\mathbb{R}}^{m\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">bold_T start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{T}^{2}\in\operatorname*{\mathbb{R}}^{n\times 1}" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m6.1"><semantics id="S4.SS1.p2.6.m6.1a"><mrow id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><msup id="S4.SS1.p2.6.m6.1.1.2" xref="S4.SS1.p2.6.m6.1.1.2.cmml"><mi id="S4.SS1.p2.6.m6.1.1.2.2" xref="S4.SS1.p2.6.m6.1.1.2.2.cmml">𝐓</mi><mn id="S4.SS1.p2.6.m6.1.1.2.3" xref="S4.SS1.p2.6.m6.1.1.2.3.cmml">2</mn></msup><mo id="S4.SS1.p2.6.m6.1.1.1" rspace="0.1389em" xref="S4.SS1.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml"><mo id="S4.SS1.p2.6.m6.1.1.3.2" lspace="0.1389em" xref="S4.SS1.p2.6.m6.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS1.p2.6.m6.1.1.3.3" xref="S4.SS1.p2.6.m6.1.1.3.3.cmml"><mi id="S4.SS1.p2.6.m6.1.1.3.3.2" xref="S4.SS1.p2.6.m6.1.1.3.3.2.cmml">n</mi><mo id="S4.SS1.p2.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.6.m6.1.1.3.3.1.cmml">×</mo><mn id="S4.SS1.p2.6.m6.1.1.3.3.3" xref="S4.SS1.p2.6.m6.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"><in id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1.1"></in><apply id="S4.SS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.2.1.cmml" xref="S4.SS1.p2.6.m6.1.1.2">superscript</csymbol><ci id="S4.SS1.p2.6.m6.1.1.2.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2.2">𝐓</ci><cn id="S4.SS1.p2.6.m6.1.1.2.3.cmml" type="integer" xref="S4.SS1.p2.6.m6.1.1.2.3">2</cn></apply><apply id="S4.SS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.3.1.cmml" xref="S4.SS1.p2.6.m6.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.6.m6.1.1.3.2.cmml" xref="S4.SS1.p2.6.m6.1.1.3.2">ℝ</ci><apply id="S4.SS1.p2.6.m6.1.1.3.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3"><times id="S4.SS1.p2.6.m6.1.1.3.3.1.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.1"></times><ci id="S4.SS1.p2.6.m6.1.1.3.3.2.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3.2">𝑛</ci><cn id="S4.SS1.p2.6.m6.1.1.3.3.3.cmml" type="integer" xref="S4.SS1.p2.6.m6.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">\mathbf{T}^{2}\in\operatorname*{\mathbb{R}}^{n\times 1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m6.1d">bold_T start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × 1 end_POSTSUPERSCRIPT</annotation></semantics></math>)
and generate two index vectors as <math alttext="\bm{I}^{1}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}\%m)" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m7.2"><semantics id="S4.SS1.p2.7.m7.2a"><mrow id="S4.SS1.p2.7.m7.2.2" xref="S4.SS1.p2.7.m7.2.2.cmml"><msup id="S4.SS1.p2.7.m7.2.2.3" xref="S4.SS1.p2.7.m7.2.2.3.cmml"><mi id="S4.SS1.p2.7.m7.2.2.3.2" xref="S4.SS1.p2.7.m7.2.2.3.2.cmml">𝑰</mi><mn id="S4.SS1.p2.7.m7.2.2.3.3" xref="S4.SS1.p2.7.m7.2.2.3.3.cmml">1</mn></msup><mo id="S4.SS1.p2.7.m7.2.2.2" xref="S4.SS1.p2.7.m7.2.2.2.cmml">=</mo><mrow id="S4.SS1.p2.7.m7.2.2.1.1" xref="S4.SS1.p2.7.m7.2.2.1.2.cmml"><mrow id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml"><mi id="S4.SS1.p2.7.m7.1.1.2" xref="S4.SS1.p2.7.m7.1.1.2.cmml">one</mi><mo id="S4.SS1.p2.7.m7.1.1.1" xref="S4.SS1.p2.7.m7.1.1.1.cmml">−</mo><mi id="S4.SS1.p2.7.m7.1.1.3" xref="S4.SS1.p2.7.m7.1.1.3.cmml">hot</mi></mrow><mo id="S4.SS1.p2.7.m7.2.2.1.1a" xref="S4.SS1.p2.7.m7.2.2.1.2.cmml">⁡</mo><mrow id="S4.SS1.p2.7.m7.2.2.1.1.1" xref="S4.SS1.p2.7.m7.2.2.1.2.cmml"><mo id="S4.SS1.p2.7.m7.2.2.1.1.1.2" stretchy="false" xref="S4.SS1.p2.7.m7.2.2.1.2.cmml">(</mo><mrow id="S4.SS1.p2.7.m7.2.2.1.1.1.1" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1.cmml"><mrow id="S4.SS1.p2.7.m7.2.2.1.1.1.1.1" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.2" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.2a.cmml">id</mtext><mo id="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.1" lspace="0.167em" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.1.cmml">%</mo></mrow><mo id="S4.SS1.p2.7.m7.2.2.1.1.1.1a" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1.cmml">⁡</mo><mi id="S4.SS1.p2.7.m7.2.2.1.1.1.1.2" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1.2.cmml">m</mi></mrow><mo id="S4.SS1.p2.7.m7.2.2.1.1.1.3" stretchy="false" xref="S4.SS1.p2.7.m7.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.2b"><apply id="S4.SS1.p2.7.m7.2.2.cmml" xref="S4.SS1.p2.7.m7.2.2"><eq id="S4.SS1.p2.7.m7.2.2.2.cmml" xref="S4.SS1.p2.7.m7.2.2.2"></eq><apply id="S4.SS1.p2.7.m7.2.2.3.cmml" xref="S4.SS1.p2.7.m7.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m7.2.2.3.1.cmml" xref="S4.SS1.p2.7.m7.2.2.3">superscript</csymbol><ci id="S4.SS1.p2.7.m7.2.2.3.2.cmml" xref="S4.SS1.p2.7.m7.2.2.3.2">𝑰</ci><cn id="S4.SS1.p2.7.m7.2.2.3.3.cmml" type="integer" xref="S4.SS1.p2.7.m7.2.2.3.3">1</cn></apply><apply id="S4.SS1.p2.7.m7.2.2.1.2.cmml" xref="S4.SS1.p2.7.m7.2.2.1.1"><apply id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1"><minus id="S4.SS1.p2.7.m7.1.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1.1"></minus><ci id="S4.SS1.p2.7.m7.1.1.2.cmml" xref="S4.SS1.p2.7.m7.1.1.2">one</ci><ci id="S4.SS1.p2.7.m7.1.1.3.cmml" xref="S4.SS1.p2.7.m7.1.1.3">hot</ci></apply><apply id="S4.SS1.p2.7.m7.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1"><apply id="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.1">percent</csymbol><ci id="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.2a.cmml" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1.1.2">id</mtext></ci></apply><ci id="S4.SS1.p2.7.m7.2.2.1.1.1.1.2.cmml" xref="S4.SS1.p2.7.m7.2.2.1.1.1.1.2">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.2c">\bm{I}^{1}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}\%m)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m7.2d">bold_italic_I start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT = start_OPERATOR roman_one - roman_hot end_OPERATOR ( id % italic_m )</annotation></semantics></math>, <math alttext="\bm{I}^{2}=\operatorname*{one-hot}(\operatorname*{\texttt{id}})" class="ltx_Math" display="inline" id="S4.SS1.p2.8.m8.2"><semantics id="S4.SS1.p2.8.m8.2a"><mrow id="S4.SS1.p2.8.m8.2.3" xref="S4.SS1.p2.8.m8.2.3.cmml"><msup id="S4.SS1.p2.8.m8.2.3.2" xref="S4.SS1.p2.8.m8.2.3.2.cmml"><mi id="S4.SS1.p2.8.m8.2.3.2.2" xref="S4.SS1.p2.8.m8.2.3.2.2.cmml">𝑰</mi><mn id="S4.SS1.p2.8.m8.2.3.2.3" xref="S4.SS1.p2.8.m8.2.3.2.3.cmml">2</mn></msup><mo id="S4.SS1.p2.8.m8.2.3.1" xref="S4.SS1.p2.8.m8.2.3.1.cmml">=</mo><mrow id="S4.SS1.p2.8.m8.2.3.3.2" xref="S4.SS1.p2.8.m8.2.3.3.1.cmml"><mrow id="S4.SS1.p2.8.m8.1.1" xref="S4.SS1.p2.8.m8.1.1.cmml"><mi id="S4.SS1.p2.8.m8.1.1.2" xref="S4.SS1.p2.8.m8.1.1.2.cmml">one</mi><mo id="S4.SS1.p2.8.m8.1.1.1" xref="S4.SS1.p2.8.m8.1.1.1.cmml">−</mo><mi id="S4.SS1.p2.8.m8.1.1.3" xref="S4.SS1.p2.8.m8.1.1.3.cmml">hot</mi></mrow><mo id="S4.SS1.p2.8.m8.2.3.3.2a" xref="S4.SS1.p2.8.m8.2.3.3.1.cmml">⁡</mo><mrow id="S4.SS1.p2.8.m8.2.3.3.2.1" xref="S4.SS1.p2.8.m8.2.3.3.1.cmml"><mo id="S4.SS1.p2.8.m8.2.3.3.2.1.1" stretchy="false" xref="S4.SS1.p2.8.m8.2.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.8.m8.2.2" xref="S4.SS1.p2.8.m8.2.2a.cmml">id</mtext><mo id="S4.SS1.p2.8.m8.2.3.3.2.1.2" stretchy="false" xref="S4.SS1.p2.8.m8.2.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m8.2b"><apply id="S4.SS1.p2.8.m8.2.3.cmml" xref="S4.SS1.p2.8.m8.2.3"><eq id="S4.SS1.p2.8.m8.2.3.1.cmml" xref="S4.SS1.p2.8.m8.2.3.1"></eq><apply id="S4.SS1.p2.8.m8.2.3.2.cmml" xref="S4.SS1.p2.8.m8.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.8.m8.2.3.2.1.cmml" xref="S4.SS1.p2.8.m8.2.3.2">superscript</csymbol><ci id="S4.SS1.p2.8.m8.2.3.2.2.cmml" xref="S4.SS1.p2.8.m8.2.3.2.2">𝑰</ci><cn id="S4.SS1.p2.8.m8.2.3.2.3.cmml" type="integer" xref="S4.SS1.p2.8.m8.2.3.2.3">2</cn></apply><apply id="S4.SS1.p2.8.m8.2.3.3.1.cmml" xref="S4.SS1.p2.8.m8.2.3.3.2"><apply id="S4.SS1.p2.8.m8.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1"><minus id="S4.SS1.p2.8.m8.1.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1.1"></minus><ci id="S4.SS1.p2.8.m8.1.1.2.cmml" xref="S4.SS1.p2.8.m8.1.1.2">one</ci><ci id="S4.SS1.p2.8.m8.1.1.3.cmml" xref="S4.SS1.p2.8.m8.1.1.3">hot</ci></apply><ci id="S4.SS1.p2.8.m8.2.2a.cmml" xref="S4.SS1.p2.8.m8.2.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.8.m8.2.2.cmml" xref="S4.SS1.p2.8.m8.2.2">id</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m8.2c">\bm{I}^{2}=\operatorname*{one-hot}(\operatorname*{\texttt{id}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.8.m8.2d">bold_italic_I start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = start_OPERATOR roman_one - roman_hot end_OPERATOR ( id )</annotation></semantics></math>.
To better distinguish the features, MEmCom multiplies two meta-embeddings as the final embedding.
Further, Yan et al. <cite class="ltx_cite ltx_citemacro_citep">(Yan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib68" title="">2021a</a>)</cite> use Binary Code based Hash (BCH) functions to process the feature id at bit level.
It divides the 64 bits of a feature id into <math alttext="s" class="ltx_Math" display="inline" id="S4.SS1.p2.9.m9.1"><semantics id="S4.SS1.p2.9.m9.1a"><mi id="S4.SS1.p2.9.m9.1.1" xref="S4.SS1.p2.9.m9.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m9.1b"><ci id="S4.SS1.p2.9.m9.1.1.cmml" xref="S4.SS1.p2.9.m9.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m9.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.9.m9.1d">italic_s</annotation></semantics></math> groups and restructures them into <math alttext="s" class="ltx_Math" display="inline" id="S4.SS1.p2.10.m10.1"><semantics id="S4.SS1.p2.10.m10.1a"><mi id="S4.SS1.p2.10.m10.1.1" xref="S4.SS1.p2.10.m10.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m10.1b"><ci id="S4.SS1.p2.10.m10.1.1.cmml" xref="S4.SS1.p2.10.m10.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m10.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.10.m10.1d">italic_s</annotation></semantics></math> sub-ids (<math alttext="\operatorname*{\texttt{id}}_{1},...,\operatorname*{\texttt{id}}_{s}" class="ltx_Math" display="inline" id="S4.SS1.p2.11.m11.3"><semantics id="S4.SS1.p2.11.m11.3a"><mrow id="S4.SS1.p2.11.m11.3.3.2" xref="S4.SS1.p2.11.m11.3.3.3.cmml"><msub id="S4.SS1.p2.11.m11.2.2.1.1" xref="S4.SS1.p2.11.m11.2.2.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.11.m11.2.2.1.1.2" xref="S4.SS1.p2.11.m11.2.2.1.1.2a.cmml">id</mtext><mn id="S4.SS1.p2.11.m11.2.2.1.1.3" xref="S4.SS1.p2.11.m11.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p2.11.m11.3.3.2.3" xref="S4.SS1.p2.11.m11.3.3.3.cmml">,</mo><mi id="S4.SS1.p2.11.m11.1.1" mathvariant="normal" xref="S4.SS1.p2.11.m11.1.1.cmml">…</mi><mo id="S4.SS1.p2.11.m11.3.3.2.4" xref="S4.SS1.p2.11.m11.3.3.3.cmml">,</mo><msub id="S4.SS1.p2.11.m11.3.3.2.2" xref="S4.SS1.p2.11.m11.3.3.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.11.m11.3.3.2.2.2" xref="S4.SS1.p2.11.m11.3.3.2.2.2a.cmml">id</mtext><mi id="S4.SS1.p2.11.m11.3.3.2.2.3" xref="S4.SS1.p2.11.m11.3.3.2.2.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m11.3b"><list id="S4.SS1.p2.11.m11.3.3.3.cmml" xref="S4.SS1.p2.11.m11.3.3.2"><apply id="S4.SS1.p2.11.m11.2.2.1.1.cmml" xref="S4.SS1.p2.11.m11.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.11.m11.2.2.1.1.1.cmml" xref="S4.SS1.p2.11.m11.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p2.11.m11.2.2.1.1.2a.cmml" xref="S4.SS1.p2.11.m11.2.2.1.1.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.11.m11.2.2.1.1.2.cmml" xref="S4.SS1.p2.11.m11.2.2.1.1.2">id</mtext></ci><cn id="S4.SS1.p2.11.m11.2.2.1.1.3.cmml" type="integer" xref="S4.SS1.p2.11.m11.2.2.1.1.3">1</cn></apply><ci id="S4.SS1.p2.11.m11.1.1.cmml" xref="S4.SS1.p2.11.m11.1.1">…</ci><apply id="S4.SS1.p2.11.m11.3.3.2.2.cmml" xref="S4.SS1.p2.11.m11.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.11.m11.3.3.2.2.1.cmml" xref="S4.SS1.p2.11.m11.3.3.2.2">subscript</csymbol><ci id="S4.SS1.p2.11.m11.3.3.2.2.2a.cmml" xref="S4.SS1.p2.11.m11.3.3.2.2.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.11.m11.3.3.2.2.2.cmml" xref="S4.SS1.p2.11.m11.3.3.2.2.2">id</mtext></ci><ci id="S4.SS1.p2.11.m11.3.3.2.2.3.cmml" xref="S4.SS1.p2.11.m11.3.3.2.2.3">𝑠</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m11.3c">\operatorname*{\texttt{id}}_{1},...,\operatorname*{\texttt{id}}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.11.m11.3d">id start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , id start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>).
Each sub-id corresponds to an index vector (i.e., <math alttext="\bm{I}^{i}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}_{i})" class="ltx_Math" display="inline" id="S4.SS1.p2.12.m12.2"><semantics id="S4.SS1.p2.12.m12.2a"><mrow id="S4.SS1.p2.12.m12.2.2" xref="S4.SS1.p2.12.m12.2.2.cmml"><msup id="S4.SS1.p2.12.m12.2.2.3" xref="S4.SS1.p2.12.m12.2.2.3.cmml"><mi id="S4.SS1.p2.12.m12.2.2.3.2" xref="S4.SS1.p2.12.m12.2.2.3.2.cmml">𝑰</mi><mi id="S4.SS1.p2.12.m12.2.2.3.3" xref="S4.SS1.p2.12.m12.2.2.3.3.cmml">i</mi></msup><mo id="S4.SS1.p2.12.m12.2.2.2" xref="S4.SS1.p2.12.m12.2.2.2.cmml">=</mo><mrow id="S4.SS1.p2.12.m12.2.2.1.1" xref="S4.SS1.p2.12.m12.2.2.1.2.cmml"><mrow id="S4.SS1.p2.12.m12.1.1" xref="S4.SS1.p2.12.m12.1.1.cmml"><mi id="S4.SS1.p2.12.m12.1.1.2" xref="S4.SS1.p2.12.m12.1.1.2.cmml">one</mi><mo id="S4.SS1.p2.12.m12.1.1.1" xref="S4.SS1.p2.12.m12.1.1.1.cmml">−</mo><mi id="S4.SS1.p2.12.m12.1.1.3" xref="S4.SS1.p2.12.m12.1.1.3.cmml">hot</mi></mrow><mo id="S4.SS1.p2.12.m12.2.2.1.1a" xref="S4.SS1.p2.12.m12.2.2.1.2.cmml">⁡</mo><mrow id="S4.SS1.p2.12.m12.2.2.1.1.1" xref="S4.SS1.p2.12.m12.2.2.1.2.cmml"><mo id="S4.SS1.p2.12.m12.2.2.1.1.1.2" stretchy="false" xref="S4.SS1.p2.12.m12.2.2.1.2.cmml">(</mo><msub id="S4.SS1.p2.12.m12.2.2.1.1.1.1" xref="S4.SS1.p2.12.m12.2.2.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.12.m12.2.2.1.1.1.1.2" xref="S4.SS1.p2.12.m12.2.2.1.1.1.1.2a.cmml">id</mtext><mi id="S4.SS1.p2.12.m12.2.2.1.1.1.1.3" xref="S4.SS1.p2.12.m12.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p2.12.m12.2.2.1.1.1.3" stretchy="false" xref="S4.SS1.p2.12.m12.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.12.m12.2b"><apply id="S4.SS1.p2.12.m12.2.2.cmml" xref="S4.SS1.p2.12.m12.2.2"><eq id="S4.SS1.p2.12.m12.2.2.2.cmml" xref="S4.SS1.p2.12.m12.2.2.2"></eq><apply id="S4.SS1.p2.12.m12.2.2.3.cmml" xref="S4.SS1.p2.12.m12.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m12.2.2.3.1.cmml" xref="S4.SS1.p2.12.m12.2.2.3">superscript</csymbol><ci id="S4.SS1.p2.12.m12.2.2.3.2.cmml" xref="S4.SS1.p2.12.m12.2.2.3.2">𝑰</ci><ci id="S4.SS1.p2.12.m12.2.2.3.3.cmml" xref="S4.SS1.p2.12.m12.2.2.3.3">𝑖</ci></apply><apply id="S4.SS1.p2.12.m12.2.2.1.2.cmml" xref="S4.SS1.p2.12.m12.2.2.1.1"><apply id="S4.SS1.p2.12.m12.1.1.cmml" xref="S4.SS1.p2.12.m12.1.1"><minus id="S4.SS1.p2.12.m12.1.1.1.cmml" xref="S4.SS1.p2.12.m12.1.1.1"></minus><ci id="S4.SS1.p2.12.m12.1.1.2.cmml" xref="S4.SS1.p2.12.m12.1.1.2">one</ci><ci id="S4.SS1.p2.12.m12.1.1.3.cmml" xref="S4.SS1.p2.12.m12.1.1.3">hot</ci></apply><apply id="S4.SS1.p2.12.m12.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.12.m12.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.12.m12.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.12.m12.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.12.m12.2.2.1.1.1.1.2a.cmml" xref="S4.SS1.p2.12.m12.2.2.1.1.1.1.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS1.p2.12.m12.2.2.1.1.1.1.2.cmml" xref="S4.SS1.p2.12.m12.2.2.1.1.1.1.2">id</mtext></ci><ci id="S4.SS1.p2.12.m12.2.2.1.1.1.1.3.cmml" xref="S4.SS1.p2.12.m12.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.12.m12.2c">\bm{I}^{i}=\operatorname*{one-hot}(\operatorname*{\texttt{id}}_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.12.m12.2d">bold_italic_I start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = start_OPERATOR roman_one - roman_hot end_OPERATOR ( id start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, <math alttext="i\in[1,s]" class="ltx_Math" display="inline" id="S4.SS1.p2.13.m13.2"><semantics id="S4.SS1.p2.13.m13.2a"><mrow id="S4.SS1.p2.13.m13.2.3" xref="S4.SS1.p2.13.m13.2.3.cmml"><mi id="S4.SS1.p2.13.m13.2.3.2" xref="S4.SS1.p2.13.m13.2.3.2.cmml">i</mi><mo id="S4.SS1.p2.13.m13.2.3.1" xref="S4.SS1.p2.13.m13.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p2.13.m13.2.3.3.2" xref="S4.SS1.p2.13.m13.2.3.3.1.cmml"><mo id="S4.SS1.p2.13.m13.2.3.3.2.1" stretchy="false" xref="S4.SS1.p2.13.m13.2.3.3.1.cmml">[</mo><mn id="S4.SS1.p2.13.m13.1.1" xref="S4.SS1.p2.13.m13.1.1.cmml">1</mn><mo id="S4.SS1.p2.13.m13.2.3.3.2.2" xref="S4.SS1.p2.13.m13.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p2.13.m13.2.2" xref="S4.SS1.p2.13.m13.2.2.cmml">s</mi><mo id="S4.SS1.p2.13.m13.2.3.3.2.3" stretchy="false" xref="S4.SS1.p2.13.m13.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.13.m13.2b"><apply id="S4.SS1.p2.13.m13.2.3.cmml" xref="S4.SS1.p2.13.m13.2.3"><in id="S4.SS1.p2.13.m13.2.3.1.cmml" xref="S4.SS1.p2.13.m13.2.3.1"></in><ci id="S4.SS1.p2.13.m13.2.3.2.cmml" xref="S4.SS1.p2.13.m13.2.3.2">𝑖</ci><interval closure="closed" id="S4.SS1.p2.13.m13.2.3.3.1.cmml" xref="S4.SS1.p2.13.m13.2.3.3.2"><cn id="S4.SS1.p2.13.m13.1.1.cmml" type="integer" xref="S4.SS1.p2.13.m13.1.1">1</cn><ci id="S4.SS1.p2.13.m13.2.2.cmml" xref="S4.SS1.p2.13.m13.2.2">𝑠</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.13.m13.2c">i\in[1,s]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.13.m13.2d">italic_i ∈ [ 1 , italic_s ]</annotation></semantics></math>) and obtains a meta-embedding.
Additionally, to enhance the compression capability, BCH keeps one single meta-table and shares it among all <math alttext="\mathbf{T}^{i},i\in[1,s]" class="ltx_Math" display="inline" id="S4.SS1.p2.14.m14.4"><semantics id="S4.SS1.p2.14.m14.4a"><mrow id="S4.SS1.p2.14.m14.4.4" xref="S4.SS1.p2.14.m14.4.4.cmml"><mrow id="S4.SS1.p2.14.m14.4.4.1.1" xref="S4.SS1.p2.14.m14.4.4.1.2.cmml"><msup id="S4.SS1.p2.14.m14.4.4.1.1.1" xref="S4.SS1.p2.14.m14.4.4.1.1.1.cmml"><mi id="S4.SS1.p2.14.m14.4.4.1.1.1.2" xref="S4.SS1.p2.14.m14.4.4.1.1.1.2.cmml">𝐓</mi><mi id="S4.SS1.p2.14.m14.4.4.1.1.1.3" xref="S4.SS1.p2.14.m14.4.4.1.1.1.3.cmml">i</mi></msup><mo id="S4.SS1.p2.14.m14.4.4.1.1.2" xref="S4.SS1.p2.14.m14.4.4.1.2.cmml">,</mo><mi id="S4.SS1.p2.14.m14.3.3" xref="S4.SS1.p2.14.m14.3.3.cmml">i</mi></mrow><mo id="S4.SS1.p2.14.m14.4.4.2" xref="S4.SS1.p2.14.m14.4.4.2.cmml">∈</mo><mrow id="S4.SS1.p2.14.m14.4.4.3.2" xref="S4.SS1.p2.14.m14.4.4.3.1.cmml"><mo id="S4.SS1.p2.14.m14.4.4.3.2.1" stretchy="false" xref="S4.SS1.p2.14.m14.4.4.3.1.cmml">[</mo><mn id="S4.SS1.p2.14.m14.1.1" xref="S4.SS1.p2.14.m14.1.1.cmml">1</mn><mo id="S4.SS1.p2.14.m14.4.4.3.2.2" xref="S4.SS1.p2.14.m14.4.4.3.1.cmml">,</mo><mi id="S4.SS1.p2.14.m14.2.2" xref="S4.SS1.p2.14.m14.2.2.cmml">s</mi><mo id="S4.SS1.p2.14.m14.4.4.3.2.3" stretchy="false" xref="S4.SS1.p2.14.m14.4.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.14.m14.4b"><apply id="S4.SS1.p2.14.m14.4.4.cmml" xref="S4.SS1.p2.14.m14.4.4"><in id="S4.SS1.p2.14.m14.4.4.2.cmml" xref="S4.SS1.p2.14.m14.4.4.2"></in><list id="S4.SS1.p2.14.m14.4.4.1.2.cmml" xref="S4.SS1.p2.14.m14.4.4.1.1"><apply id="S4.SS1.p2.14.m14.4.4.1.1.1.cmml" xref="S4.SS1.p2.14.m14.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m14.4.4.1.1.1.1.cmml" xref="S4.SS1.p2.14.m14.4.4.1.1.1">superscript</csymbol><ci id="S4.SS1.p2.14.m14.4.4.1.1.1.2.cmml" xref="S4.SS1.p2.14.m14.4.4.1.1.1.2">𝐓</ci><ci id="S4.SS1.p2.14.m14.4.4.1.1.1.3.cmml" xref="S4.SS1.p2.14.m14.4.4.1.1.1.3">𝑖</ci></apply><ci id="S4.SS1.p2.14.m14.3.3.cmml" xref="S4.SS1.p2.14.m14.3.3">𝑖</ci></list><interval closure="closed" id="S4.SS1.p2.14.m14.4.4.3.1.cmml" xref="S4.SS1.p2.14.m14.4.4.3.2"><cn id="S4.SS1.p2.14.m14.1.1.cmml" type="integer" xref="S4.SS1.p2.14.m14.1.1">1</cn><ci id="S4.SS1.p2.14.m14.2.2.cmml" xref="S4.SS1.p2.14.m14.2.2">𝑠</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.14.m14.4c">\mathbf{T}^{i},i\in[1,s]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.14.m14.4d">bold_T start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_i ∈ [ 1 , italic_s ]</annotation></semantics></math>.
Although the hashing methods described above are efficient in memory reduction, they still suffer from accuracy degradation and extra computing cost of the hash functions.
To alleviate these problems, Zhang et al. <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib73" title="">2020</a>)</cite> develop a Frequency-based Double Hashing (FDH) method, which only uses hashing on the features with low frequencies.
In this way, fewer features need to be processed by the hash function. With a little extra storage for the most frequent features,
FDH not only improves the prediction accuracy but also the inference efficiency. The difference between the above methods in generating embeddings is reflected in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#algorithm3" title="In 4.1. Hashing ‣ 4. Weight-Sharing ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.8">Instead of generating embeddings with meta-embeddings, LMA <cite class="ltx_cite ltx_citemacro_citep">(Desai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib13" title="">2021</a>)</cite> and ROBE <cite class="ltx_cite ltx_citemacro_citep">(Desai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib12" title="">2022</a>)</cite> use hash functions to map each weight in the embedding table into a shared memory <math alttext="{M}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_M</annotation></semantics></math>.
For a weight <math alttext="w_{i,j}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.2"><semantics id="S4.SS1.p3.2.m2.2a"><msub id="S4.SS1.p3.2.m2.2.3" xref="S4.SS1.p3.2.m2.2.3.cmml"><mi id="S4.SS1.p3.2.m2.2.3.2" xref="S4.SS1.p3.2.m2.2.3.2.cmml">w</mi><mrow id="S4.SS1.p3.2.m2.2.2.2.4" xref="S4.SS1.p3.2.m2.2.2.2.3.cmml"><mi id="S4.SS1.p3.2.m2.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p3.2.m2.2.2.2.4.1" xref="S4.SS1.p3.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p3.2.m2.2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.2b"><apply id="S4.SS1.p3.2.m2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.3.1.cmml" xref="S4.SS1.p3.2.m2.2.3">subscript</csymbol><ci id="S4.SS1.p3.2.m2.2.3.2.cmml" xref="S4.SS1.p3.2.m2.2.3.2">𝑤</ci><list id="S4.SS1.p3.2.m2.2.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4"><ci id="S4.SS1.p3.2.m2.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1">𝑖</ci><ci id="S4.SS1.p3.2.m2.2.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.2c">w_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.2d">italic_w start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in the embedding table, they take both <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><mi id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><ci id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">italic_j</annotation></semantics></math> as the input of hash functions.
LMA utilizes locality sensitive hashing (LSH) to map the weights of each embedding to <math alttext="{M}" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><mi id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><ci id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">italic_M</annotation></semantics></math> randomly.
ROBE organizes <math alttext="{M}" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><mi id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><ci id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">italic_M</annotation></semantics></math> as a circular array and divides the flattened embedding table (i.e. concatenate all rows) into blocks of size <math alttext="Z" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m7.1"><semantics id="S4.SS1.p3.7.m7.1a"><mi id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.1b"><ci id="S4.SS1.p3.7.m7.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m7.1d">italic_Z</annotation></semantics></math>.
The head of each block is mapped to <math alttext="{M}" class="ltx_Math" display="inline" id="S4.SS1.p3.8.m8.1"><semantics id="S4.SS1.p3.8.m8.1a"><mi id="S4.SS1.p3.8.m8.1.1" xref="S4.SS1.p3.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m8.1b"><ci id="S4.SS1.p3.8.m8.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m8.1c">{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.8.m8.1d">italic_M</annotation></semantics></math> randomly and the following weights in the block will be mapped to the position next to the head.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Vector Quantization</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.6">Hashing methods typically get the index vector by processing the feature id with hash functions, which fail to capture the similarity between features themselves <cite class="ltx_cite ltx_citemacro_citep">(Kang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib27" title="">2020</a>)</cite>.
To capture the similarity, vector quantization (VQ) constructs the index vectors through approximated nearest neighbor search (ANNS).
Specifically, for a feature with an original embedding of <math alttext="\bm{e}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">bold_italic_e</annotation></semantics></math>, VQ gets its index vector as <math alttext="\bm{I}=\operatorname*{one-hot}(\operatorname*{arg\,max}_{k}\text{sim}(\bm{e},%
\mathbf{T}_{k}))\in\{0,1\}^{m}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.5"><semantics id="S4.SS2.p1.2.m2.5a"><mrow id="S4.SS2.p1.2.m2.5.5" xref="S4.SS2.p1.2.m2.5.5.cmml"><mi id="S4.SS2.p1.2.m2.5.5.3" xref="S4.SS2.p1.2.m2.5.5.3.cmml">𝑰</mi><mo id="S4.SS2.p1.2.m2.5.5.4" xref="S4.SS2.p1.2.m2.5.5.4.cmml">=</mo><mrow id="S4.SS2.p1.2.m2.5.5.1.1" xref="S4.SS2.p1.2.m2.5.5.1.2.cmml"><mrow id="S4.SS2.p1.2.m2.2.2" xref="S4.SS2.p1.2.m2.2.2.cmml"><mi id="S4.SS2.p1.2.m2.2.2.2" xref="S4.SS2.p1.2.m2.2.2.2.cmml">one</mi><mo id="S4.SS2.p1.2.m2.2.2.1" xref="S4.SS2.p1.2.m2.2.2.1.cmml">−</mo><mi id="S4.SS2.p1.2.m2.2.2.3" xref="S4.SS2.p1.2.m2.2.2.3.cmml">hot</mi></mrow><mo id="S4.SS2.p1.2.m2.5.5.1.1a" xref="S4.SS2.p1.2.m2.5.5.1.2.cmml">⁡</mo><mrow id="S4.SS2.p1.2.m2.5.5.1.1.1" xref="S4.SS2.p1.2.m2.5.5.1.2.cmml"><mo id="S4.SS2.p1.2.m2.5.5.1.1.1.2" stretchy="false" xref="S4.SS2.p1.2.m2.5.5.1.2.cmml">(</mo><mrow id="S4.SS2.p1.2.m2.5.5.1.1.1.1" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.cmml"><mrow id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.cmml"><msub id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.cmml"><mrow id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.cmml"><mi id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.2" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.2.cmml">arg</mi><mo id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.1" lspace="0.170em" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.3" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.3.cmml">max</mi></mrow><mi id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.3" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.3.cmml">k</mi></msub><mo id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3a" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.cmml">⁡</mo><mtext id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.2" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.2a.cmml">sim</mtext></mrow><mo id="S4.SS2.p1.2.m2.5.5.1.1.1.1.2" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.2.cmml"><mo id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.2.cmml">(</mo><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">𝒆</mi><mo id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.3" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.2.cmml">,</mo><msub id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1.2.cmml">𝐓</mi><mi id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.4" stretchy="false" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.2.m2.5.5.1.1.1.3" stretchy="false" xref="S4.SS2.p1.2.m2.5.5.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.2.m2.5.5.5" xref="S4.SS2.p1.2.m2.5.5.5.cmml">∈</mo><msup id="S4.SS2.p1.2.m2.5.5.6" xref="S4.SS2.p1.2.m2.5.5.6.cmml"><mrow id="S4.SS2.p1.2.m2.5.5.6.2.2" xref="S4.SS2.p1.2.m2.5.5.6.2.1.cmml"><mo id="S4.SS2.p1.2.m2.5.5.6.2.2.1" stretchy="false" xref="S4.SS2.p1.2.m2.5.5.6.2.1.cmml">{</mo><mn id="S4.SS2.p1.2.m2.3.3" xref="S4.SS2.p1.2.m2.3.3.cmml">0</mn><mo id="S4.SS2.p1.2.m2.5.5.6.2.2.2" xref="S4.SS2.p1.2.m2.5.5.6.2.1.cmml">,</mo><mn id="S4.SS2.p1.2.m2.4.4" xref="S4.SS2.p1.2.m2.4.4.cmml">1</mn><mo id="S4.SS2.p1.2.m2.5.5.6.2.2.3" stretchy="false" xref="S4.SS2.p1.2.m2.5.5.6.2.1.cmml">}</mo></mrow><mi id="S4.SS2.p1.2.m2.5.5.6.3" xref="S4.SS2.p1.2.m2.5.5.6.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.5b"><apply id="S4.SS2.p1.2.m2.5.5.cmml" xref="S4.SS2.p1.2.m2.5.5"><and id="S4.SS2.p1.2.m2.5.5a.cmml" xref="S4.SS2.p1.2.m2.5.5"></and><apply id="S4.SS2.p1.2.m2.5.5b.cmml" xref="S4.SS2.p1.2.m2.5.5"><eq id="S4.SS2.p1.2.m2.5.5.4.cmml" xref="S4.SS2.p1.2.m2.5.5.4"></eq><ci id="S4.SS2.p1.2.m2.5.5.3.cmml" xref="S4.SS2.p1.2.m2.5.5.3">𝑰</ci><apply id="S4.SS2.p1.2.m2.5.5.1.2.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1"><apply id="S4.SS2.p1.2.m2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2"><minus id="S4.SS2.p1.2.m2.2.2.1.cmml" xref="S4.SS2.p1.2.m2.2.2.1"></minus><ci id="S4.SS2.p1.2.m2.2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2.2">one</ci><ci id="S4.SS2.p1.2.m2.2.2.3.cmml" xref="S4.SS2.p1.2.m2.2.2.3">hot</ci></apply><apply id="S4.SS2.p1.2.m2.5.5.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1"><times id="S4.SS2.p1.2.m2.5.5.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.2"></times><apply id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3"><apply id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.1.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1">subscript</csymbol><apply id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2"><times id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.1.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.1"></times><ci id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.2.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.2">arg</ci><ci id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.3.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.2.3">max</ci></apply><ci id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.3.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.1.3">𝑘</ci></apply><ci id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.2a.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.2"><mtext id="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.3.2">sim</mtext></ci></apply><interval closure="open" id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝒆</ci><apply id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1.2">𝐓</ci><ci id="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m2.5.5.1.1.1.1.1.1.1.3">𝑘</ci></apply></interval></apply></apply></apply><apply id="S4.SS2.p1.2.m2.5.5c.cmml" xref="S4.SS2.p1.2.m2.5.5"><in id="S4.SS2.p1.2.m2.5.5.5.cmml" xref="S4.SS2.p1.2.m2.5.5.5"></in><share href="https://arxiv.org/html/2408.02304v1#S4.SS2.p1.2.m2.5.5.1.cmml" id="S4.SS2.p1.2.m2.5.5d.cmml" xref="S4.SS2.p1.2.m2.5.5"></share><apply id="S4.SS2.p1.2.m2.5.5.6.cmml" xref="S4.SS2.p1.2.m2.5.5.6"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.5.5.6.1.cmml" xref="S4.SS2.p1.2.m2.5.5.6">superscript</csymbol><set id="S4.SS2.p1.2.m2.5.5.6.2.1.cmml" xref="S4.SS2.p1.2.m2.5.5.6.2.2"><cn id="S4.SS2.p1.2.m2.3.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.3.3">0</cn><cn id="S4.SS2.p1.2.m2.4.4.cmml" type="integer" xref="S4.SS2.p1.2.m2.4.4">1</cn></set><ci id="S4.SS2.p1.2.m2.5.5.6.3.cmml" xref="S4.SS2.p1.2.m2.5.5.6.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.5c">\bm{I}=\operatorname*{one-hot}(\operatorname*{arg\,max}_{k}\text{sim}(\bm{e},%
\mathbf{T}_{k}))\in\{0,1\}^{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.5d">bold_italic_I = start_OPERATOR roman_one - roman_hot end_OPERATOR ( start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT sim ( bold_italic_e , bold_T start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ) ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>,
where <math alttext="\mathbf{T}_{k}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><msub id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">𝐓</mi><mi id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝐓</ci><ci id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\mathbf{T}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">bold_T start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_k</annotation></semantics></math>-th meta-embedding in the meta-table <math alttext="\mathbf{T}\in\operatorname*{\mathbb{R}}^{m\times d}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">𝐓</mi><mo id="S4.SS2.p1.5.m5.1.1.1" rspace="0.1389em" xref="S4.SS2.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml"><mo id="S4.SS2.p1.5.m5.1.1.3.2" lspace="0.1389em" xref="S4.SS2.p1.5.m5.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS2.p1.5.m5.1.1.3.3" xref="S4.SS2.p1.5.m5.1.1.3.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.3.2" xref="S4.SS2.p1.5.m5.1.1.3.3.2.cmml">m</mi><mo id="S4.SS2.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p1.5.m5.1.1.3.3.3" xref="S4.SS2.p1.5.m5.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><in id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1"></in><ci id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2">𝐓</ci><apply id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S4.SS2.p1.5.m5.1.1.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3"><times id="S4.SS2.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.1"></times><ci id="S4.SS2.p1.5.m5.1.1.3.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.2">𝑚</ci><ci id="S4.SS2.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\mathbf{T}\in\operatorname*{\mathbb{R}}^{m\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">bold_T ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\text{sim}(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.1"><semantics id="S4.SS2.p1.6.m6.1a"><mrow id="S4.SS2.p1.6.m6.1.2" xref="S4.SS2.p1.6.m6.1.2.cmml"><mtext id="S4.SS2.p1.6.m6.1.2.2" xref="S4.SS2.p1.6.m6.1.2.2a.cmml">sim</mtext><mo id="S4.SS2.p1.6.m6.1.2.1" xref="S4.SS2.p1.6.m6.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.p1.6.m6.1.2.3.2" xref="S4.SS2.p1.6.m6.1.2.cmml"><mo id="S4.SS2.p1.6.m6.1.2.3.2.1" stretchy="false" xref="S4.SS2.p1.6.m6.1.2.cmml">(</mo><mo id="S4.SS2.p1.6.m6.1.1" lspace="0em" rspace="0em" xref="S4.SS2.p1.6.m6.1.1.cmml">⋅</mo><mo id="S4.SS2.p1.6.m6.1.2.3.2.2" stretchy="false" xref="S4.SS2.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.2.cmml" xref="S4.SS2.p1.6.m6.1.2"><times id="S4.SS2.p1.6.m6.1.2.1.cmml" xref="S4.SS2.p1.6.m6.1.2.1"></times><ci id="S4.SS2.p1.6.m6.1.2.2a.cmml" xref="S4.SS2.p1.6.m6.1.2.2"><mtext id="S4.SS2.p1.6.m6.1.2.2.cmml" xref="S4.SS2.p1.6.m6.1.2.2">sim</mtext></ci><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\text{sim}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.1d">sim ( ⋅ )</annotation></semantics></math> is a similarity function (e.g., Euclidean distance).
In other words, VQ takes the original embedding as input and quantizes it into its most similar meta-embedding.
Note that the meta-table and the meta-embedding are commonly referred to codebook and codeword in recent literature on VQ. Here we use meta-table and meta-embedding for consistency.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.2">Saec <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib63" title="">2020</a>)</cite> generates a meta-table <math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">bold_T</annotation></semantics></math> by clustering the most frequent embeddings of a pretrained model and then quantizes each original embedding into a meta-embedding in <math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">bold_T</annotation></semantics></math>.
However, assigning the same meta-embedding to different features (i.e., collisions) still results in drop of accuracy, even though the features have some similarity.
In addition, Saec cannot optimize the meta-table together with the original embeddings, which also results in suboptimal accuracy.
To alleviate the collisions, subsequent works adopt product quantization (PQ) <cite class="ltx_cite ltx_citemacro_citep">(Jégou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib24" title="">2011</a>)</cite> and additive quantization (AQ) <cite class="ltx_cite ltx_citemacro_citep">(Babenko and Lempitsky, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib2" title="">2014</a>)</cite> to quantize an embedding into multiple meta-embeddings.
To optimize the meta-table together with the original embeddings,
researchers usually quantize the original embeddings into meta-embeddings during training and use the meta-embeddings as the input of the following network, where the original embeddings will be optimized through STE <cite class="ltx_cite ltx_citemacro_citep">(Courbariaux et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib10" title="">2015</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.15">PQ considers an embedding as a concatenation of several segments (i.e., <math alttext="\bm{e}=\bigcup_{i=1}^{s}\bm{e}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">𝒆</mi><mo id="S4.SS2.p3.1.m1.1.1.1" rspace="0.111em" xref="S4.SS2.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml"><msubsup id="S4.SS2.p3.1.m1.1.1.3.1" xref="S4.SS2.p3.1.m1.1.1.3.1.cmml"><mo id="S4.SS2.p3.1.m1.1.1.3.1.2.2" xref="S4.SS2.p3.1.m1.1.1.3.1.2.2.cmml">⋃</mo><mrow id="S4.SS2.p3.1.m1.1.1.3.1.2.3" xref="S4.SS2.p3.1.m1.1.1.3.1.2.3.cmml"><mi id="S4.SS2.p3.1.m1.1.1.3.1.2.3.2" xref="S4.SS2.p3.1.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.SS2.p3.1.m1.1.1.3.1.2.3.1" xref="S4.SS2.p3.1.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.SS2.p3.1.m1.1.1.3.1.2.3.3" xref="S4.SS2.p3.1.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.p3.1.m1.1.1.3.1.3" xref="S4.SS2.p3.1.m1.1.1.3.1.3.cmml">s</mi></msubsup><msup id="S4.SS2.p3.1.m1.1.1.3.2" xref="S4.SS2.p3.1.m1.1.1.3.2.cmml"><mi id="S4.SS2.p3.1.m1.1.1.3.2.2" xref="S4.SS2.p3.1.m1.1.1.3.2.2.cmml">𝒆</mi><mi id="S4.SS2.p3.1.m1.1.1.3.2.3" xref="S4.SS2.p3.1.m1.1.1.3.2.3.cmml">i</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><eq id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></eq><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝒆</ci><apply id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3"><apply id="S4.SS2.p3.1.m1.1.1.3.1.cmml" xref="S4.SS2.p3.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.3.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.3.1">superscript</csymbol><apply id="S4.SS2.p3.1.m1.1.1.3.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.3.1.2.1.cmml" xref="S4.SS2.p3.1.m1.1.1.3.1">subscript</csymbol><union id="S4.SS2.p3.1.m1.1.1.3.1.2.2.cmml" xref="S4.SS2.p3.1.m1.1.1.3.1.2.2"></union><apply id="S4.SS2.p3.1.m1.1.1.3.1.2.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3.1.2.3"><eq id="S4.SS2.p3.1.m1.1.1.3.1.2.3.1.cmml" xref="S4.SS2.p3.1.m1.1.1.3.1.2.3.1"></eq><ci id="S4.SS2.p3.1.m1.1.1.3.1.2.3.2.cmml" xref="S4.SS2.p3.1.m1.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.SS2.p3.1.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p3.1.m1.1.1.3.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3.1.3">𝑠</ci></apply><apply id="S4.SS2.p3.1.m1.1.1.3.2.cmml" xref="S4.SS2.p3.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.3.2.1.cmml" xref="S4.SS2.p3.1.m1.1.1.3.2">superscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.3.2.2.cmml" xref="S4.SS2.p3.1.m1.1.1.3.2.2">𝒆</ci><ci id="S4.SS2.p3.1.m1.1.1.3.2.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\bm{e}=\bigcup_{i=1}^{s}\bm{e}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">bold_italic_e = ⋃ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT bold_italic_e start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>).
Each segment <math alttext="\bm{e}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><msup id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">𝒆</mi><mi id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝒆</ci><ci id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\bm{e}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">bold_italic_e start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> corresponds to a meta-table <math alttext="\mathbf{T}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><msup id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">𝐓</mi><mi id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝐓</ci><ci id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\mathbf{T}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">bold_T start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>.
At training, an embedding <math alttext="\bm{e}" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1"><semantics id="S4.SS2.p3.4.m4.1a"><mi id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><ci id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m4.1d">bold_italic_e</annotation></semantics></math> is quantized as <math alttext="\bigcup_{i=1}^{s}\bm{I}^{i}\times\mathbf{T}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.1"><semantics id="S4.SS2.p3.5.m5.1a"><mrow id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml"><msubsup id="S4.SS2.p3.5.m5.1.1.1" xref="S4.SS2.p3.5.m5.1.1.1.cmml"><mo id="S4.SS2.p3.5.m5.1.1.1.2.2" xref="S4.SS2.p3.5.m5.1.1.1.2.2.cmml">⋃</mo><mrow id="S4.SS2.p3.5.m5.1.1.1.2.3" xref="S4.SS2.p3.5.m5.1.1.1.2.3.cmml"><mi id="S4.SS2.p3.5.m5.1.1.1.2.3.2" xref="S4.SS2.p3.5.m5.1.1.1.2.3.2.cmml">i</mi><mo id="S4.SS2.p3.5.m5.1.1.1.2.3.1" xref="S4.SS2.p3.5.m5.1.1.1.2.3.1.cmml">=</mo><mn id="S4.SS2.p3.5.m5.1.1.1.2.3.3" xref="S4.SS2.p3.5.m5.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.p3.5.m5.1.1.1.3" xref="S4.SS2.p3.5.m5.1.1.1.3.cmml">s</mi></msubsup><mrow id="S4.SS2.p3.5.m5.1.1.2" xref="S4.SS2.p3.5.m5.1.1.2.cmml"><msup id="S4.SS2.p3.5.m5.1.1.2.2" xref="S4.SS2.p3.5.m5.1.1.2.2.cmml"><mi id="S4.SS2.p3.5.m5.1.1.2.2.2" xref="S4.SS2.p3.5.m5.1.1.2.2.2.cmml">𝑰</mi><mi id="S4.SS2.p3.5.m5.1.1.2.2.3" xref="S4.SS2.p3.5.m5.1.1.2.2.3.cmml">i</mi></msup><mo id="S4.SS2.p3.5.m5.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p3.5.m5.1.1.2.1.cmml">×</mo><msup id="S4.SS2.p3.5.m5.1.1.2.3" xref="S4.SS2.p3.5.m5.1.1.2.3.cmml"><mi id="S4.SS2.p3.5.m5.1.1.2.3.2" xref="S4.SS2.p3.5.m5.1.1.2.3.2.cmml">𝐓</mi><mi id="S4.SS2.p3.5.m5.1.1.2.3.3" xref="S4.SS2.p3.5.m5.1.1.2.3.3.cmml">i</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1"><apply id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1">superscript</csymbol><apply id="S4.SS2.p3.5.m5.1.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.1.2.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1">subscript</csymbol><union id="S4.SS2.p3.5.m5.1.1.1.2.2.cmml" xref="S4.SS2.p3.5.m5.1.1.1.2.2"></union><apply id="S4.SS2.p3.5.m5.1.1.1.2.3.cmml" xref="S4.SS2.p3.5.m5.1.1.1.2.3"><eq id="S4.SS2.p3.5.m5.1.1.1.2.3.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1.2.3.1"></eq><ci id="S4.SS2.p3.5.m5.1.1.1.2.3.2.cmml" xref="S4.SS2.p3.5.m5.1.1.1.2.3.2">𝑖</ci><cn id="S4.SS2.p3.5.m5.1.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.p3.5.m5.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p3.5.m5.1.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.1.3">𝑠</ci></apply><apply id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2"><times id="S4.SS2.p3.5.m5.1.1.2.1.cmml" xref="S4.SS2.p3.5.m5.1.1.2.1"></times><apply id="S4.SS2.p3.5.m5.1.1.2.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.2.2.1.cmml" xref="S4.SS2.p3.5.m5.1.1.2.2">superscript</csymbol><ci id="S4.SS2.p3.5.m5.1.1.2.2.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2.2.2">𝑰</ci><ci id="S4.SS2.p3.5.m5.1.1.2.2.3.cmml" xref="S4.SS2.p3.5.m5.1.1.2.2.3">𝑖</ci></apply><apply id="S4.SS2.p3.5.m5.1.1.2.3.cmml" xref="S4.SS2.p3.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.2.3.1.cmml" xref="S4.SS2.p3.5.m5.1.1.2.3">superscript</csymbol><ci id="S4.SS2.p3.5.m5.1.1.2.3.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2.3.2">𝐓</ci><ci id="S4.SS2.p3.5.m5.1.1.2.3.3.cmml" xref="S4.SS2.p3.5.m5.1.1.2.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">\bigcup_{i=1}^{s}\bm{I}^{i}\times\mathbf{T}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m5.1d">⋃ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT bold_italic_I start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT × bold_T start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\bm{I}^{i}=\operatorname*{one-hot}(\operatorname*{arg\,max}_{k}\text{sim}(\bm{%
e}^{i},\mathbf{T}^{i}_{k}))" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m6.2"><semantics id="S4.SS2.p3.6.m6.2a"><mrow id="S4.SS2.p3.6.m6.2.2" xref="S4.SS2.p3.6.m6.2.2.cmml"><msup id="S4.SS2.p3.6.m6.2.2.3" xref="S4.SS2.p3.6.m6.2.2.3.cmml"><mi id="S4.SS2.p3.6.m6.2.2.3.2" xref="S4.SS2.p3.6.m6.2.2.3.2.cmml">𝑰</mi><mi id="S4.SS2.p3.6.m6.2.2.3.3" xref="S4.SS2.p3.6.m6.2.2.3.3.cmml">i</mi></msup><mo id="S4.SS2.p3.6.m6.2.2.2" xref="S4.SS2.p3.6.m6.2.2.2.cmml">=</mo><mrow id="S4.SS2.p3.6.m6.2.2.1.1" xref="S4.SS2.p3.6.m6.2.2.1.2.cmml"><mrow id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml"><mi id="S4.SS2.p3.6.m6.1.1.2" xref="S4.SS2.p3.6.m6.1.1.2.cmml">one</mi><mo id="S4.SS2.p3.6.m6.1.1.1" xref="S4.SS2.p3.6.m6.1.1.1.cmml">−</mo><mi id="S4.SS2.p3.6.m6.1.1.3" xref="S4.SS2.p3.6.m6.1.1.3.cmml">hot</mi></mrow><mo id="S4.SS2.p3.6.m6.2.2.1.1a" xref="S4.SS2.p3.6.m6.2.2.1.2.cmml">⁡</mo><mrow id="S4.SS2.p3.6.m6.2.2.1.1.1" xref="S4.SS2.p3.6.m6.2.2.1.2.cmml"><mo id="S4.SS2.p3.6.m6.2.2.1.1.1.2" stretchy="false" xref="S4.SS2.p3.6.m6.2.2.1.2.cmml">(</mo><mrow id="S4.SS2.p3.6.m6.2.2.1.1.1.1" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.cmml"><mrow id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.cmml"><msub id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.cmml"><mrow id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.cmml"><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.2.cmml">arg</mi><mo id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.1" lspace="0.170em" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.3.cmml">max</mi></mrow><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.3.cmml">k</mi></msub><mo id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4a" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.cmml">⁡</mo><mtext id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.2a.cmml">sim</mtext></mrow><mo id="S4.SS2.p3.6.m6.2.2.1.1.1.1.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.3.cmml">⁢</mo><mrow id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.3.cmml"><mo id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.3" stretchy="false" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.3.cmml">(</mo><msup id="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1.2.cmml">𝒆</mi><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.4" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.3.cmml">,</mo><msubsup id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.cmml"><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.2.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.2.2.cmml">𝐓</mi><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.3.cmml">k</mi><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.2.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.5" stretchy="false" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p3.6.m6.2.2.1.1.1.3" stretchy="false" xref="S4.SS2.p3.6.m6.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.2b"><apply id="S4.SS2.p3.6.m6.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2"><eq id="S4.SS2.p3.6.m6.2.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.2"></eq><apply id="S4.SS2.p3.6.m6.2.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.3.1.cmml" xref="S4.SS2.p3.6.m6.2.2.3">superscript</csymbol><ci id="S4.SS2.p3.6.m6.2.2.3.2.cmml" xref="S4.SS2.p3.6.m6.2.2.3.2">𝑰</ci><ci id="S4.SS2.p3.6.m6.2.2.3.3.cmml" xref="S4.SS2.p3.6.m6.2.2.3.3">𝑖</ci></apply><apply id="S4.SS2.p3.6.m6.2.2.1.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1"><apply id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1"><minus id="S4.SS2.p3.6.m6.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1.1"></minus><ci id="S4.SS2.p3.6.m6.1.1.2.cmml" xref="S4.SS2.p3.6.m6.1.1.2">one</ci><ci id="S4.SS2.p3.6.m6.1.1.3.cmml" xref="S4.SS2.p3.6.m6.1.1.3">hot</ci></apply><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1"><times id="S4.SS2.p3.6.m6.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.3"></times><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4"><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1">subscript</csymbol><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2"><times id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.1"></times><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.2">arg</ci><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.2.3">max</ci></apply><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.3.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.1.3">𝑘</ci></apply><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.2a.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.2"><mtext id="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.4.2">sim</mtext></ci></apply><interval closure="open" id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2"><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1.2">𝒆</ci><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2">subscript</csymbol><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.2.2">𝐓</ci><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.2c">\bm{I}^{i}=\operatorname*{one-hot}(\operatorname*{arg\,max}_{k}\text{sim}(\bm{%
e}^{i},\mathbf{T}^{i}_{k}))</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m6.2d">bold_italic_I start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = start_OPERATOR roman_one - roman_hot end_OPERATOR ( start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT sim ( bold_italic_e start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , bold_T start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) )</annotation></semantics></math>.
In other words, PQ quantizes each segment into its most similar meta-embedding in the corresponding meta-table.
After training, the original embeddings are discarded and only the meta-tables are preserved.
Since the selection of a meta-embedding in a meta-table can be compactly encoded by <math alttext="\log N" class="ltx_Math" display="inline" id="S4.SS2.p3.7.m7.1"><semantics id="S4.SS2.p3.7.m7.1a"><mrow id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml"><mi id="S4.SS2.p3.7.m7.1.1.1" xref="S4.SS2.p3.7.m7.1.1.1.cmml">log</mi><mo id="S4.SS2.p3.7.m7.1.1a" lspace="0.167em" xref="S4.SS2.p3.7.m7.1.1.cmml">⁡</mo><mi id="S4.SS2.p3.7.m7.1.1.2" xref="S4.SS2.p3.7.m7.1.1.2.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b"><apply id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1"><log id="S4.SS2.p3.7.m7.1.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1.1"></log><ci id="S4.SS2.p3.7.m7.1.1.2.cmml" xref="S4.SS2.p3.7.m7.1.1.2">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.1c">\log N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.7.m7.1d">roman_log italic_N</annotation></semantics></math> bits, where <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p3.8.m8.1"><semantics id="S4.SS2.p3.8.m8.1a"><mi id="S4.SS2.p3.8.m8.1.1" xref="S4.SS2.p3.8.m8.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m8.1b"><ci id="S4.SS2.p3.8.m8.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.8.m8.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.8.m8.1d">italic_N</annotation></semantics></math> is the size of the meta-table,
an embedding can now be stored by <math alttext="s\log N" class="ltx_Math" display="inline" id="S4.SS2.p3.9.m9.1"><semantics id="S4.SS2.p3.9.m9.1a"><mrow id="S4.SS2.p3.9.m9.1.1" xref="S4.SS2.p3.9.m9.1.1.cmml"><mi id="S4.SS2.p3.9.m9.1.1.2" xref="S4.SS2.p3.9.m9.1.1.2.cmml">s</mi><mo id="S4.SS2.p3.9.m9.1.1.1" lspace="0.167em" xref="S4.SS2.p3.9.m9.1.1.1.cmml">⁢</mo><mrow id="S4.SS2.p3.9.m9.1.1.3" xref="S4.SS2.p3.9.m9.1.1.3.cmml"><mi id="S4.SS2.p3.9.m9.1.1.3.1" xref="S4.SS2.p3.9.m9.1.1.3.1.cmml">log</mi><mo id="S4.SS2.p3.9.m9.1.1.3a" lspace="0.167em" xref="S4.SS2.p3.9.m9.1.1.3.cmml">⁡</mo><mi id="S4.SS2.p3.9.m9.1.1.3.2" xref="S4.SS2.p3.9.m9.1.1.3.2.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.9.m9.1b"><apply id="S4.SS2.p3.9.m9.1.1.cmml" xref="S4.SS2.p3.9.m9.1.1"><times id="S4.SS2.p3.9.m9.1.1.1.cmml" xref="S4.SS2.p3.9.m9.1.1.1"></times><ci id="S4.SS2.p3.9.m9.1.1.2.cmml" xref="S4.SS2.p3.9.m9.1.1.2">𝑠</ci><apply id="S4.SS2.p3.9.m9.1.1.3.cmml" xref="S4.SS2.p3.9.m9.1.1.3"><log id="S4.SS2.p3.9.m9.1.1.3.1.cmml" xref="S4.SS2.p3.9.m9.1.1.3.1"></log><ci id="S4.SS2.p3.9.m9.1.1.3.2.cmml" xref="S4.SS2.p3.9.m9.1.1.3.2">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.9.m9.1c">s\log N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.9.m9.1d">italic_s roman_log italic_N</annotation></semantics></math> bits with the help of the meta-tables.
Further, MGQE <cite class="ltx_cite ltx_citemacro_citep">(Kang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib27" title="">2020</a>)</cite> takes the feature frequency into consideration when using PQ.
Specifically, it divides the embeddings of items into <math alttext="m" class="ltx_Math" display="inline" id="S4.SS2.p3.10.m10.1"><semantics id="S4.SS2.p3.10.m10.1a"><mi id="S4.SS2.p3.10.m10.1.1" xref="S4.SS2.p3.10.m10.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.10.m10.1b"><ci id="S4.SS2.p3.10.m10.1.1.cmml" xref="S4.SS2.p3.10.m10.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.10.m10.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.10.m10.1d">italic_m</annotation></semantics></math> groups in ascending order of frequency as <math alttext="\mathbb{G}=\{\mathbf{E}_{1},\mathbf{E}_{2},...,\mathbf{E}_{m}\}" class="ltx_Math" display="inline" id="S4.SS2.p3.11.m11.4"><semantics id="S4.SS2.p3.11.m11.4a"><mrow id="S4.SS2.p3.11.m11.4.4" xref="S4.SS2.p3.11.m11.4.4.cmml"><mi id="S4.SS2.p3.11.m11.4.4.5" xref="S4.SS2.p3.11.m11.4.4.5.cmml">𝔾</mi><mo id="S4.SS2.p3.11.m11.4.4.4" xref="S4.SS2.p3.11.m11.4.4.4.cmml">=</mo><mrow id="S4.SS2.p3.11.m11.4.4.3.3" xref="S4.SS2.p3.11.m11.4.4.3.4.cmml"><mo id="S4.SS2.p3.11.m11.4.4.3.3.4" stretchy="false" xref="S4.SS2.p3.11.m11.4.4.3.4.cmml">{</mo><msub id="S4.SS2.p3.11.m11.2.2.1.1.1" xref="S4.SS2.p3.11.m11.2.2.1.1.1.cmml"><mi id="S4.SS2.p3.11.m11.2.2.1.1.1.2" xref="S4.SS2.p3.11.m11.2.2.1.1.1.2.cmml">𝐄</mi><mn id="S4.SS2.p3.11.m11.2.2.1.1.1.3" xref="S4.SS2.p3.11.m11.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.p3.11.m11.4.4.3.3.5" xref="S4.SS2.p3.11.m11.4.4.3.4.cmml">,</mo><msub id="S4.SS2.p3.11.m11.3.3.2.2.2" xref="S4.SS2.p3.11.m11.3.3.2.2.2.cmml"><mi id="S4.SS2.p3.11.m11.3.3.2.2.2.2" xref="S4.SS2.p3.11.m11.3.3.2.2.2.2.cmml">𝐄</mi><mn id="S4.SS2.p3.11.m11.3.3.2.2.2.3" xref="S4.SS2.p3.11.m11.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS2.p3.11.m11.4.4.3.3.6" xref="S4.SS2.p3.11.m11.4.4.3.4.cmml">,</mo><mi id="S4.SS2.p3.11.m11.1.1" mathvariant="normal" xref="S4.SS2.p3.11.m11.1.1.cmml">…</mi><mo id="S4.SS2.p3.11.m11.4.4.3.3.7" xref="S4.SS2.p3.11.m11.4.4.3.4.cmml">,</mo><msub id="S4.SS2.p3.11.m11.4.4.3.3.3" xref="S4.SS2.p3.11.m11.4.4.3.3.3.cmml"><mi id="S4.SS2.p3.11.m11.4.4.3.3.3.2" xref="S4.SS2.p3.11.m11.4.4.3.3.3.2.cmml">𝐄</mi><mi id="S4.SS2.p3.11.m11.4.4.3.3.3.3" xref="S4.SS2.p3.11.m11.4.4.3.3.3.3.cmml">m</mi></msub><mo id="S4.SS2.p3.11.m11.4.4.3.3.8" stretchy="false" xref="S4.SS2.p3.11.m11.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.11.m11.4b"><apply id="S4.SS2.p3.11.m11.4.4.cmml" xref="S4.SS2.p3.11.m11.4.4"><eq id="S4.SS2.p3.11.m11.4.4.4.cmml" xref="S4.SS2.p3.11.m11.4.4.4"></eq><ci id="S4.SS2.p3.11.m11.4.4.5.cmml" xref="S4.SS2.p3.11.m11.4.4.5">𝔾</ci><set id="S4.SS2.p3.11.m11.4.4.3.4.cmml" xref="S4.SS2.p3.11.m11.4.4.3.3"><apply id="S4.SS2.p3.11.m11.2.2.1.1.1.cmml" xref="S4.SS2.p3.11.m11.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.11.m11.2.2.1.1.1.1.cmml" xref="S4.SS2.p3.11.m11.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.11.m11.2.2.1.1.1.2.cmml" xref="S4.SS2.p3.11.m11.2.2.1.1.1.2">𝐄</ci><cn id="S4.SS2.p3.11.m11.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS2.p3.11.m11.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS2.p3.11.m11.3.3.2.2.2.cmml" xref="S4.SS2.p3.11.m11.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.11.m11.3.3.2.2.2.1.cmml" xref="S4.SS2.p3.11.m11.3.3.2.2.2">subscript</csymbol><ci id="S4.SS2.p3.11.m11.3.3.2.2.2.2.cmml" xref="S4.SS2.p3.11.m11.3.3.2.2.2.2">𝐄</ci><cn id="S4.SS2.p3.11.m11.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS2.p3.11.m11.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS2.p3.11.m11.1.1.cmml" xref="S4.SS2.p3.11.m11.1.1">…</ci><apply id="S4.SS2.p3.11.m11.4.4.3.3.3.cmml" xref="S4.SS2.p3.11.m11.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.11.m11.4.4.3.3.3.1.cmml" xref="S4.SS2.p3.11.m11.4.4.3.3.3">subscript</csymbol><ci id="S4.SS2.p3.11.m11.4.4.3.3.3.2.cmml" xref="S4.SS2.p3.11.m11.4.4.3.3.3.2">𝐄</ci><ci id="S4.SS2.p3.11.m11.4.4.3.3.3.3.cmml" xref="S4.SS2.p3.11.m11.4.4.3.3.3.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.11.m11.4c">\mathbb{G}=\{\mathbf{E}_{1},\mathbf{E}_{2},...,\mathbf{E}_{m}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.11.m11.4d">blackboard_G = { bold_E start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_E start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT }</annotation></semantics></math> and defines <math alttext="\mathbb{N}=\{n_{1},n_{2},...,n_{m}\}" class="ltx_Math" display="inline" id="S4.SS2.p3.12.m12.4"><semantics id="S4.SS2.p3.12.m12.4a"><mrow id="S4.SS2.p3.12.m12.4.4" xref="S4.SS2.p3.12.m12.4.4.cmml"><mi id="S4.SS2.p3.12.m12.4.4.5" xref="S4.SS2.p3.12.m12.4.4.5.cmml">ℕ</mi><mo id="S4.SS2.p3.12.m12.4.4.4" xref="S4.SS2.p3.12.m12.4.4.4.cmml">=</mo><mrow id="S4.SS2.p3.12.m12.4.4.3.3" xref="S4.SS2.p3.12.m12.4.4.3.4.cmml"><mo id="S4.SS2.p3.12.m12.4.4.3.3.4" stretchy="false" xref="S4.SS2.p3.12.m12.4.4.3.4.cmml">{</mo><msub id="S4.SS2.p3.12.m12.2.2.1.1.1" xref="S4.SS2.p3.12.m12.2.2.1.1.1.cmml"><mi id="S4.SS2.p3.12.m12.2.2.1.1.1.2" xref="S4.SS2.p3.12.m12.2.2.1.1.1.2.cmml">n</mi><mn id="S4.SS2.p3.12.m12.2.2.1.1.1.3" xref="S4.SS2.p3.12.m12.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.p3.12.m12.4.4.3.3.5" xref="S4.SS2.p3.12.m12.4.4.3.4.cmml">,</mo><msub id="S4.SS2.p3.12.m12.3.3.2.2.2" xref="S4.SS2.p3.12.m12.3.3.2.2.2.cmml"><mi id="S4.SS2.p3.12.m12.3.3.2.2.2.2" xref="S4.SS2.p3.12.m12.3.3.2.2.2.2.cmml">n</mi><mn id="S4.SS2.p3.12.m12.3.3.2.2.2.3" xref="S4.SS2.p3.12.m12.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS2.p3.12.m12.4.4.3.3.6" xref="S4.SS2.p3.12.m12.4.4.3.4.cmml">,</mo><mi id="S4.SS2.p3.12.m12.1.1" mathvariant="normal" xref="S4.SS2.p3.12.m12.1.1.cmml">…</mi><mo id="S4.SS2.p3.12.m12.4.4.3.3.7" xref="S4.SS2.p3.12.m12.4.4.3.4.cmml">,</mo><msub id="S4.SS2.p3.12.m12.4.4.3.3.3" xref="S4.SS2.p3.12.m12.4.4.3.3.3.cmml"><mi id="S4.SS2.p3.12.m12.4.4.3.3.3.2" xref="S4.SS2.p3.12.m12.4.4.3.3.3.2.cmml">n</mi><mi id="S4.SS2.p3.12.m12.4.4.3.3.3.3" xref="S4.SS2.p3.12.m12.4.4.3.3.3.3.cmml">m</mi></msub><mo id="S4.SS2.p3.12.m12.4.4.3.3.8" stretchy="false" xref="S4.SS2.p3.12.m12.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.12.m12.4b"><apply id="S4.SS2.p3.12.m12.4.4.cmml" xref="S4.SS2.p3.12.m12.4.4"><eq id="S4.SS2.p3.12.m12.4.4.4.cmml" xref="S4.SS2.p3.12.m12.4.4.4"></eq><ci id="S4.SS2.p3.12.m12.4.4.5.cmml" xref="S4.SS2.p3.12.m12.4.4.5">ℕ</ci><set id="S4.SS2.p3.12.m12.4.4.3.4.cmml" xref="S4.SS2.p3.12.m12.4.4.3.3"><apply id="S4.SS2.p3.12.m12.2.2.1.1.1.cmml" xref="S4.SS2.p3.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.12.m12.2.2.1.1.1.1.cmml" xref="S4.SS2.p3.12.m12.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.12.m12.2.2.1.1.1.2.cmml" xref="S4.SS2.p3.12.m12.2.2.1.1.1.2">𝑛</ci><cn id="S4.SS2.p3.12.m12.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS2.p3.12.m12.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS2.p3.12.m12.3.3.2.2.2.cmml" xref="S4.SS2.p3.12.m12.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.12.m12.3.3.2.2.2.1.cmml" xref="S4.SS2.p3.12.m12.3.3.2.2.2">subscript</csymbol><ci id="S4.SS2.p3.12.m12.3.3.2.2.2.2.cmml" xref="S4.SS2.p3.12.m12.3.3.2.2.2.2">𝑛</ci><cn id="S4.SS2.p3.12.m12.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS2.p3.12.m12.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS2.p3.12.m12.1.1.cmml" xref="S4.SS2.p3.12.m12.1.1">…</ci><apply id="S4.SS2.p3.12.m12.4.4.3.3.3.cmml" xref="S4.SS2.p3.12.m12.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.12.m12.4.4.3.3.3.1.cmml" xref="S4.SS2.p3.12.m12.4.4.3.3.3">subscript</csymbol><ci id="S4.SS2.p3.12.m12.4.4.3.3.3.2.cmml" xref="S4.SS2.p3.12.m12.4.4.3.3.3.2">𝑛</ci><ci id="S4.SS2.p3.12.m12.4.4.3.3.3.3.cmml" xref="S4.SS2.p3.12.m12.4.4.3.3.3.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.12.m12.4c">\mathbb{N}=\{n_{1},n_{2},...,n_{m}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.12.m12.4d">blackboard_N = { italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_n start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_n start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT }</annotation></semantics></math>
where <math alttext="n_{1}&lt;n_{2}&lt;...&lt;n_{m}" class="ltx_Math" display="inline" id="S4.SS2.p3.13.m13.1"><semantics id="S4.SS2.p3.13.m13.1a"><mrow id="S4.SS2.p3.13.m13.1.1" xref="S4.SS2.p3.13.m13.1.1.cmml"><msub id="S4.SS2.p3.13.m13.1.1.2" xref="S4.SS2.p3.13.m13.1.1.2.cmml"><mi id="S4.SS2.p3.13.m13.1.1.2.2" xref="S4.SS2.p3.13.m13.1.1.2.2.cmml">n</mi><mn id="S4.SS2.p3.13.m13.1.1.2.3" xref="S4.SS2.p3.13.m13.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS2.p3.13.m13.1.1.3" xref="S4.SS2.p3.13.m13.1.1.3.cmml">&lt;</mo><msub id="S4.SS2.p3.13.m13.1.1.4" xref="S4.SS2.p3.13.m13.1.1.4.cmml"><mi id="S4.SS2.p3.13.m13.1.1.4.2" xref="S4.SS2.p3.13.m13.1.1.4.2.cmml">n</mi><mn id="S4.SS2.p3.13.m13.1.1.4.3" xref="S4.SS2.p3.13.m13.1.1.4.3.cmml">2</mn></msub><mo id="S4.SS2.p3.13.m13.1.1.5" xref="S4.SS2.p3.13.m13.1.1.5.cmml">&lt;</mo><mi id="S4.SS2.p3.13.m13.1.1.6" mathvariant="normal" xref="S4.SS2.p3.13.m13.1.1.6.cmml">…</mi><mo id="S4.SS2.p3.13.m13.1.1.7" xref="S4.SS2.p3.13.m13.1.1.7.cmml">&lt;</mo><msub id="S4.SS2.p3.13.m13.1.1.8" xref="S4.SS2.p3.13.m13.1.1.8.cmml"><mi id="S4.SS2.p3.13.m13.1.1.8.2" xref="S4.SS2.p3.13.m13.1.1.8.2.cmml">n</mi><mi id="S4.SS2.p3.13.m13.1.1.8.3" xref="S4.SS2.p3.13.m13.1.1.8.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.13.m13.1b"><apply id="S4.SS2.p3.13.m13.1.1.cmml" xref="S4.SS2.p3.13.m13.1.1"><and id="S4.SS2.p3.13.m13.1.1a.cmml" xref="S4.SS2.p3.13.m13.1.1"></and><apply id="S4.SS2.p3.13.m13.1.1b.cmml" xref="S4.SS2.p3.13.m13.1.1"><lt id="S4.SS2.p3.13.m13.1.1.3.cmml" xref="S4.SS2.p3.13.m13.1.1.3"></lt><apply id="S4.SS2.p3.13.m13.1.1.2.cmml" xref="S4.SS2.p3.13.m13.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.13.m13.1.1.2.1.cmml" xref="S4.SS2.p3.13.m13.1.1.2">subscript</csymbol><ci id="S4.SS2.p3.13.m13.1.1.2.2.cmml" xref="S4.SS2.p3.13.m13.1.1.2.2">𝑛</ci><cn id="S4.SS2.p3.13.m13.1.1.2.3.cmml" type="integer" xref="S4.SS2.p3.13.m13.1.1.2.3">1</cn></apply><apply id="S4.SS2.p3.13.m13.1.1.4.cmml" xref="S4.SS2.p3.13.m13.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.p3.13.m13.1.1.4.1.cmml" xref="S4.SS2.p3.13.m13.1.1.4">subscript</csymbol><ci id="S4.SS2.p3.13.m13.1.1.4.2.cmml" xref="S4.SS2.p3.13.m13.1.1.4.2">𝑛</ci><cn id="S4.SS2.p3.13.m13.1.1.4.3.cmml" type="integer" xref="S4.SS2.p3.13.m13.1.1.4.3">2</cn></apply></apply><apply id="S4.SS2.p3.13.m13.1.1c.cmml" xref="S4.SS2.p3.13.m13.1.1"><lt id="S4.SS2.p3.13.m13.1.1.5.cmml" xref="S4.SS2.p3.13.m13.1.1.5"></lt><share href="https://arxiv.org/html/2408.02304v1#S4.SS2.p3.13.m13.1.1.4.cmml" id="S4.SS2.p3.13.m13.1.1d.cmml" xref="S4.SS2.p3.13.m13.1.1"></share><ci id="S4.SS2.p3.13.m13.1.1.6.cmml" xref="S4.SS2.p3.13.m13.1.1.6">…</ci></apply><apply id="S4.SS2.p3.13.m13.1.1e.cmml" xref="S4.SS2.p3.13.m13.1.1"><lt id="S4.SS2.p3.13.m13.1.1.7.cmml" xref="S4.SS2.p3.13.m13.1.1.7"></lt><share href="https://arxiv.org/html/2408.02304v1#S4.SS2.p3.13.m13.1.1.6.cmml" id="S4.SS2.p3.13.m13.1.1f.cmml" xref="S4.SS2.p3.13.m13.1.1"></share><apply id="S4.SS2.p3.13.m13.1.1.8.cmml" xref="S4.SS2.p3.13.m13.1.1.8"><csymbol cd="ambiguous" id="S4.SS2.p3.13.m13.1.1.8.1.cmml" xref="S4.SS2.p3.13.m13.1.1.8">subscript</csymbol><ci id="S4.SS2.p3.13.m13.1.1.8.2.cmml" xref="S4.SS2.p3.13.m13.1.1.8.2">𝑛</ci><ci id="S4.SS2.p3.13.m13.1.1.8.3.cmml" xref="S4.SS2.p3.13.m13.1.1.8.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.13.m13.1c">n_{1}&lt;n_{2}&lt;...&lt;n_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.13.m13.1d">italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &lt; italic_n start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT &lt; … &lt; italic_n start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>. The embeddings in <math alttext="i" class="ltx_Math" display="inline" id="S4.SS2.p3.14.m14.1"><semantics id="S4.SS2.p3.14.m14.1a"><mi id="S4.SS2.p3.14.m14.1.1" xref="S4.SS2.p3.14.m14.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.14.m14.1b"><ci id="S4.SS2.p3.14.m14.1.1.cmml" xref="S4.SS2.p3.14.m14.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.14.m14.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.14.m14.1d">italic_i</annotation></semantics></math>-th group can only be quantized into the first <math alttext="n_{i}" class="ltx_Math" display="inline" id="S4.SS2.p3.15.m15.1"><semantics id="S4.SS2.p3.15.m15.1a"><msub id="S4.SS2.p3.15.m15.1.1" xref="S4.SS2.p3.15.m15.1.1.cmml"><mi id="S4.SS2.p3.15.m15.1.1.2" xref="S4.SS2.p3.15.m15.1.1.2.cmml">n</mi><mi id="S4.SS2.p3.15.m15.1.1.3" xref="S4.SS2.p3.15.m15.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.15.m15.1b"><apply id="S4.SS2.p3.15.m15.1.1.cmml" xref="S4.SS2.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.15.m15.1.1.1.cmml" xref="S4.SS2.p3.15.m15.1.1">subscript</csymbol><ci id="S4.SS2.p3.15.m15.1.1.2.cmml" xref="S4.SS2.p3.15.m15.1.1.2">𝑛</ci><ci id="S4.SS2.p3.15.m15.1.1.3.cmml" xref="S4.SS2.p3.15.m15.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.15.m15.1c">n_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.15.m15.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> meta-embeddings in each meta-table.
Similarly, xLightFM <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib25" title="">2021</a>)</cite> performs PQ in each feature field.
Considering that the feature fields have various size, xLightFM searches for the optimal size (i.e., the number of meta-embeddings) of the meta-tables for each field.
The search process is achieved by the DARTS algorithm which is similar as the embedding dimension search in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S3.SS2" title="3.2. NAS-based Approaches ‣ 3. Mixed-Dimension ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">3.2</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.11">Similar to PQ, AQ considers an embedding as a summation of <math alttext="s" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_s</annotation></semantics></math> vectors: <math alttext="\bm{e}=\sum_{i=1}^{s}\bm{e}_{i}" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">𝒆</mi><mo id="S4.SS2.p4.2.m2.1.1.1" rspace="0.111em" xref="S4.SS2.p4.2.m2.1.1.1.cmml">=</mo><mrow id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml"><msubsup id="S4.SS2.p4.2.m2.1.1.3.1" xref="S4.SS2.p4.2.m2.1.1.3.1.cmml"><mo id="S4.SS2.p4.2.m2.1.1.3.1.2.2" xref="S4.SS2.p4.2.m2.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.SS2.p4.2.m2.1.1.3.1.2.3" xref="S4.SS2.p4.2.m2.1.1.3.1.2.3.cmml"><mi id="S4.SS2.p4.2.m2.1.1.3.1.2.3.2" xref="S4.SS2.p4.2.m2.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.SS2.p4.2.m2.1.1.3.1.2.3.1" xref="S4.SS2.p4.2.m2.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.SS2.p4.2.m2.1.1.3.1.2.3.3" xref="S4.SS2.p4.2.m2.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.p4.2.m2.1.1.3.1.3" xref="S4.SS2.p4.2.m2.1.1.3.1.3.cmml">s</mi></msubsup><msub id="S4.SS2.p4.2.m2.1.1.3.2" xref="S4.SS2.p4.2.m2.1.1.3.2.cmml"><mi id="S4.SS2.p4.2.m2.1.1.3.2.2" xref="S4.SS2.p4.2.m2.1.1.3.2.2.cmml">𝒆</mi><mi id="S4.SS2.p4.2.m2.1.1.3.2.3" xref="S4.SS2.p4.2.m2.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><eq id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1"></eq><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">𝒆</ci><apply id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3"><apply id="S4.SS2.p4.2.m2.1.1.3.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.3.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3.1">superscript</csymbol><apply id="S4.SS2.p4.2.m2.1.1.3.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.3.1.2.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3.1">subscript</csymbol><sum id="S4.SS2.p4.2.m2.1.1.3.1.2.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.1.2.2"></sum><apply id="S4.SS2.p4.2.m2.1.1.3.1.2.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3.1.2.3"><eq id="S4.SS2.p4.2.m2.1.1.3.1.2.3.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3.1.2.3.1"></eq><ci id="S4.SS2.p4.2.m2.1.1.3.1.2.3.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.SS2.p4.2.m2.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.SS2.p4.2.m2.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p4.2.m2.1.1.3.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3.1.3">𝑠</ci></apply><apply id="S4.SS2.p4.2.m2.1.1.3.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.3.2.1.cmml" xref="S4.SS2.p4.2.m2.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p4.2.m2.1.1.3.2.2.cmml" xref="S4.SS2.p4.2.m2.1.1.3.2.2">𝒆</ci><ci id="S4.SS2.p4.2.m2.1.1.3.2.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\bm{e}=\sum_{i=1}^{s}\bm{e}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">bold_italic_e = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT bold_italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
AQ generates its quantized embeddings by <math alttext="\sum_{i=1}^{s}\bm{I}^{i}\times\mathbf{T}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mrow id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><msubsup id="S4.SS2.p4.3.m3.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.cmml"><mo id="S4.SS2.p4.3.m3.1.1.1.2.2" xref="S4.SS2.p4.3.m3.1.1.1.2.2.cmml">∑</mo><mrow id="S4.SS2.p4.3.m3.1.1.1.2.3" xref="S4.SS2.p4.3.m3.1.1.1.2.3.cmml"><mi id="S4.SS2.p4.3.m3.1.1.1.2.3.2" xref="S4.SS2.p4.3.m3.1.1.1.2.3.2.cmml">i</mi><mo id="S4.SS2.p4.3.m3.1.1.1.2.3.1" xref="S4.SS2.p4.3.m3.1.1.1.2.3.1.cmml">=</mo><mn id="S4.SS2.p4.3.m3.1.1.1.2.3.3" xref="S4.SS2.p4.3.m3.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.p4.3.m3.1.1.1.3" xref="S4.SS2.p4.3.m3.1.1.1.3.cmml">s</mi></msubsup><mrow id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml"><msup id="S4.SS2.p4.3.m3.1.1.2.2" xref="S4.SS2.p4.3.m3.1.1.2.2.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2.2.2" xref="S4.SS2.p4.3.m3.1.1.2.2.2.cmml">𝑰</mi><mi id="S4.SS2.p4.3.m3.1.1.2.2.3" xref="S4.SS2.p4.3.m3.1.1.2.2.3.cmml">i</mi></msup><mo id="S4.SS2.p4.3.m3.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.p4.3.m3.1.1.2.1.cmml">×</mo><msup id="S4.SS2.p4.3.m3.1.1.2.3" xref="S4.SS2.p4.3.m3.1.1.2.3.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2.3.2" xref="S4.SS2.p4.3.m3.1.1.2.3.2.cmml">𝐓</mi><mi id="S4.SS2.p4.3.m3.1.1.2.3.3" xref="S4.SS2.p4.3.m3.1.1.2.3.3.cmml">i</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><apply id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1">superscript</csymbol><apply id="S4.SS2.p4.3.m3.1.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.1.2.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1">subscript</csymbol><sum id="S4.SS2.p4.3.m3.1.1.1.2.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.2.2"></sum><apply id="S4.SS2.p4.3.m3.1.1.1.2.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.2.3"><eq id="S4.SS2.p4.3.m3.1.1.1.2.3.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.2.3.1"></eq><ci id="S4.SS2.p4.3.m3.1.1.1.2.3.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.2.3.2">𝑖</ci><cn id="S4.SS2.p4.3.m3.1.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.p4.3.m3.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p4.3.m3.1.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.3">𝑠</ci></apply><apply id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2"><times id="S4.SS2.p4.3.m3.1.1.2.1.cmml" xref="S4.SS2.p4.3.m3.1.1.2.1"></times><apply id="S4.SS2.p4.3.m3.1.1.2.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.2.2.1.cmml" xref="S4.SS2.p4.3.m3.1.1.2.2">superscript</csymbol><ci id="S4.SS2.p4.3.m3.1.1.2.2.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2.2.2">𝑰</ci><ci id="S4.SS2.p4.3.m3.1.1.2.2.3.cmml" xref="S4.SS2.p4.3.m3.1.1.2.2.3">𝑖</ci></apply><apply id="S4.SS2.p4.3.m3.1.1.2.3.cmml" xref="S4.SS2.p4.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.2.3.1.cmml" xref="S4.SS2.p4.3.m3.1.1.2.3">superscript</csymbol><ci id="S4.SS2.p4.3.m3.1.1.2.3.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2.3.2">𝐓</ci><ci id="S4.SS2.p4.3.m3.1.1.2.3.3.cmml" xref="S4.SS2.p4.3.m3.1.1.2.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">\sum_{i=1}^{s}\bm{I}^{i}\times\mathbf{T}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT bold_italic_I start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT × bold_T start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>,
<math alttext="\bm{I}^{i}=\operatorname*{one-hot}(\operatorname*{arg\,max}_{k}\text{sim}(\bm{%
e}-\sum_{v=1}^{i-1}\mathbf{T}_{k_{v}}^{v},\mathbf{T}_{k}^{i}))" class="ltx_Math" display="inline" id="S4.SS2.p4.4.m4.2"><semantics id="S4.SS2.p4.4.m4.2a"><mrow id="S4.SS2.p4.4.m4.2.2" xref="S4.SS2.p4.4.m4.2.2.cmml"><msup id="S4.SS2.p4.4.m4.2.2.3" xref="S4.SS2.p4.4.m4.2.2.3.cmml"><mi id="S4.SS2.p4.4.m4.2.2.3.2" xref="S4.SS2.p4.4.m4.2.2.3.2.cmml">𝑰</mi><mi id="S4.SS2.p4.4.m4.2.2.3.3" xref="S4.SS2.p4.4.m4.2.2.3.3.cmml">i</mi></msup><mo id="S4.SS2.p4.4.m4.2.2.2" xref="S4.SS2.p4.4.m4.2.2.2.cmml">=</mo><mrow id="S4.SS2.p4.4.m4.2.2.1.1" xref="S4.SS2.p4.4.m4.2.2.1.2.cmml"><mrow id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">one</mi><mo id="S4.SS2.p4.4.m4.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.cmml">−</mo><mi id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml">hot</mi></mrow><mo id="S4.SS2.p4.4.m4.2.2.1.1a" xref="S4.SS2.p4.4.m4.2.2.1.2.cmml">⁡</mo><mrow id="S4.SS2.p4.4.m4.2.2.1.1.1" xref="S4.SS2.p4.4.m4.2.2.1.2.cmml"><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.2" stretchy="false" xref="S4.SS2.p4.4.m4.2.2.1.2.cmml">(</mo><mrow id="S4.SS2.p4.4.m4.2.2.1.1.1.1" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.cmml"><mrow id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.cmml"><msub id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.cmml"><mrow id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.cmml"><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.2.cmml">arg</mi><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.1" lspace="0.170em" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.3.cmml">max</mi></mrow><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.3.cmml">k</mi></msub><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4a" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.cmml">⁡</mo><mtext id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.2a.cmml">sim</mtext></mrow><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.1.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.3.cmml">⁢</mo><mrow id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.3.cmml"><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.3" stretchy="false" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.3.cmml">(</mo><mrow id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.2.cmml">𝒆</mi><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.1" rspace="0.055em" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.cmml"><msubsup id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.cmml"><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.2.cmml">v</mi><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.1" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.cmml"><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.2.cmml">i</mi><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.1" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.1.cmml">−</mo><mn id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup><msubsup id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.2.cmml">𝐓</mi><msub id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3.cmml"><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3.2.cmml">k</mi><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3.3.cmml">v</mi></msub><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.3.cmml">v</mi></msubsup></mrow></mrow><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.4" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.3.cmml">,</mo><msubsup id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.cmml"><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.2.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.2.2.cmml">𝐓</mi><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.2.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.2.3.cmml">k</mi><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.3.cmml">i</mi></msubsup><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.5" stretchy="false" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.3" stretchy="false" xref="S4.SS2.p4.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.2b"><apply id="S4.SS2.p4.4.m4.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2"><eq id="S4.SS2.p4.4.m4.2.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2.2"></eq><apply id="S4.SS2.p4.4.m4.2.2.3.cmml" xref="S4.SS2.p4.4.m4.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.2.2.3.1.cmml" xref="S4.SS2.p4.4.m4.2.2.3">superscript</csymbol><ci id="S4.SS2.p4.4.m4.2.2.3.2.cmml" xref="S4.SS2.p4.4.m4.2.2.3.2">𝑰</ci><ci id="S4.SS2.p4.4.m4.2.2.3.3.cmml" xref="S4.SS2.p4.4.m4.2.2.3.3">𝑖</ci></apply><apply id="S4.SS2.p4.4.m4.2.2.1.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><minus id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1"></minus><ci id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2">one</ci><ci id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3">hot</ci></apply><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1"><times id="S4.SS2.p4.4.m4.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.3"></times><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4"><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1">subscript</csymbol><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2"><times id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.1"></times><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.2">arg</ci><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.2.3">max</ci></apply><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.1.3">𝑘</ci></apply><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.2a.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.2"><mtext id="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.4.2">sim</mtext></ci></apply><interval closure="open" id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2"><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1"><minus id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.1"></minus><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.2">𝒆</ci><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3"><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3"><eq id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.2">𝑣</ci><cn id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3"><minus id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.1"></minus><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.2">𝑖</ci><cn id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.3.cmml" type="integer" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.1.3.3">1</cn></apply></apply><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.2">𝐓</ci><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3">subscript</csymbol><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3.2">𝑘</ci><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.2.3.3">𝑣</ci></apply></apply><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.1.1.3.2.3">𝑣</ci></apply></apply></apply><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2">superscript</csymbol><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.2.2">𝐓</ci><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.2.3">𝑘</ci></apply><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.2c">\bm{I}^{i}=\operatorname*{one-hot}(\operatorname*{arg\,max}_{k}\text{sim}(\bm{%
e}-\sum_{v=1}^{i-1}\mathbf{T}_{k_{v}}^{v},\mathbf{T}_{k}^{i}))</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.4.m4.2d">bold_italic_I start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = start_OPERATOR roman_one - roman_hot end_OPERATOR ( start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT sim ( bold_italic_e - ∑ start_POSTSUBSCRIPT italic_v = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i - 1 end_POSTSUPERSCRIPT bold_T start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_v end_POSTSUPERSCRIPT , bold_T start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) )</annotation></semantics></math>
where <math alttext="k_{v}" class="ltx_Math" display="inline" id="S4.SS2.p4.5.m5.1"><semantics id="S4.SS2.p4.5.m5.1a"><msub id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml"><mi id="S4.SS2.p4.5.m5.1.1.2" xref="S4.SS2.p4.5.m5.1.1.2.cmml">k</mi><mi id="S4.SS2.p4.5.m5.1.1.3" xref="S4.SS2.p4.5.m5.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p4.5.m5.1.1.2.cmml" xref="S4.SS2.p4.5.m5.1.1.2">𝑘</ci><ci id="S4.SS2.p4.5.m5.1.1.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">k_{v}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.5.m5.1d">italic_k start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> is the index of the selected meta-embedding in the <math alttext="v" class="ltx_Math" display="inline" id="S4.SS2.p4.6.m6.1"><semantics id="S4.SS2.p4.6.m6.1a"><mi id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><ci id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">v</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.6.m6.1d">italic_v</annotation></semantics></math>-th meta-table.
Specifically, the first meta-table takes the embedding <math alttext="\bm{e}" class="ltx_Math" display="inline" id="S4.SS2.p4.7.m7.1"><semantics id="S4.SS2.p4.7.m7.1a"><mi id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.1b"><ci id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.7.m7.1d">bold_italic_e</annotation></semantics></math> as input, and outputs its nearest meta-embedding <math alttext="\mathbf{T}_{k_{1}}^{1}" class="ltx_Math" display="inline" id="S4.SS2.p4.8.m8.1"><semantics id="S4.SS2.p4.8.m8.1a"><msubsup id="S4.SS2.p4.8.m8.1.1" xref="S4.SS2.p4.8.m8.1.1.cmml"><mi id="S4.SS2.p4.8.m8.1.1.2.2" xref="S4.SS2.p4.8.m8.1.1.2.2.cmml">𝐓</mi><msub id="S4.SS2.p4.8.m8.1.1.2.3" xref="S4.SS2.p4.8.m8.1.1.2.3.cmml"><mi id="S4.SS2.p4.8.m8.1.1.2.3.2" xref="S4.SS2.p4.8.m8.1.1.2.3.2.cmml">k</mi><mn id="S4.SS2.p4.8.m8.1.1.2.3.3" xref="S4.SS2.p4.8.m8.1.1.2.3.3.cmml">1</mn></msub><mn id="S4.SS2.p4.8.m8.1.1.3" xref="S4.SS2.p4.8.m8.1.1.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m8.1b"><apply id="S4.SS2.p4.8.m8.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.1.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1">superscript</csymbol><apply id="S4.SS2.p4.8.m8.1.1.2.cmml" xref="S4.SS2.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.1.1.2.1.cmml" xref="S4.SS2.p4.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p4.8.m8.1.1.2.2.cmml" xref="S4.SS2.p4.8.m8.1.1.2.2">𝐓</ci><apply id="S4.SS2.p4.8.m8.1.1.2.3.cmml" xref="S4.SS2.p4.8.m8.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.1.1.2.3.1.cmml" xref="S4.SS2.p4.8.m8.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p4.8.m8.1.1.2.3.2.cmml" xref="S4.SS2.p4.8.m8.1.1.2.3.2">𝑘</ci><cn id="S4.SS2.p4.8.m8.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.p4.8.m8.1.1.2.3.3">1</cn></apply></apply><cn id="S4.SS2.p4.8.m8.1.1.3.cmml" type="integer" xref="S4.SS2.p4.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.8.m8.1c">\mathbf{T}_{k_{1}}^{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.8.m8.1d">bold_T start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math>,
the second meta-table then quantizes the residual part (<math alttext="\bm{e}-\mathbf{T}_{k_{1}}^{1}" class="ltx_Math" display="inline" id="S4.SS2.p4.9.m9.1"><semantics id="S4.SS2.p4.9.m9.1a"><mrow id="S4.SS2.p4.9.m9.1.1" xref="S4.SS2.p4.9.m9.1.1.cmml"><mi id="S4.SS2.p4.9.m9.1.1.2" xref="S4.SS2.p4.9.m9.1.1.2.cmml">𝒆</mi><mo id="S4.SS2.p4.9.m9.1.1.1" xref="S4.SS2.p4.9.m9.1.1.1.cmml">−</mo><msubsup id="S4.SS2.p4.9.m9.1.1.3" xref="S4.SS2.p4.9.m9.1.1.3.cmml"><mi id="S4.SS2.p4.9.m9.1.1.3.2.2" xref="S4.SS2.p4.9.m9.1.1.3.2.2.cmml">𝐓</mi><msub id="S4.SS2.p4.9.m9.1.1.3.2.3" xref="S4.SS2.p4.9.m9.1.1.3.2.3.cmml"><mi id="S4.SS2.p4.9.m9.1.1.3.2.3.2" xref="S4.SS2.p4.9.m9.1.1.3.2.3.2.cmml">k</mi><mn id="S4.SS2.p4.9.m9.1.1.3.2.3.3" xref="S4.SS2.p4.9.m9.1.1.3.2.3.3.cmml">1</mn></msub><mn id="S4.SS2.p4.9.m9.1.1.3.3" xref="S4.SS2.p4.9.m9.1.1.3.3.cmml">1</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.9.m9.1b"><apply id="S4.SS2.p4.9.m9.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1"><minus id="S4.SS2.p4.9.m9.1.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1.1"></minus><ci id="S4.SS2.p4.9.m9.1.1.2.cmml" xref="S4.SS2.p4.9.m9.1.1.2">𝒆</ci><apply id="S4.SS2.p4.9.m9.1.1.3.cmml" xref="S4.SS2.p4.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.9.m9.1.1.3.1.cmml" xref="S4.SS2.p4.9.m9.1.1.3">superscript</csymbol><apply id="S4.SS2.p4.9.m9.1.1.3.2.cmml" xref="S4.SS2.p4.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.9.m9.1.1.3.2.1.cmml" xref="S4.SS2.p4.9.m9.1.1.3">subscript</csymbol><ci id="S4.SS2.p4.9.m9.1.1.3.2.2.cmml" xref="S4.SS2.p4.9.m9.1.1.3.2.2">𝐓</ci><apply id="S4.SS2.p4.9.m9.1.1.3.2.3.cmml" xref="S4.SS2.p4.9.m9.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.9.m9.1.1.3.2.3.1.cmml" xref="S4.SS2.p4.9.m9.1.1.3.2.3">subscript</csymbol><ci id="S4.SS2.p4.9.m9.1.1.3.2.3.2.cmml" xref="S4.SS2.p4.9.m9.1.1.3.2.3.2">𝑘</ci><cn id="S4.SS2.p4.9.m9.1.1.3.2.3.3.cmml" type="integer" xref="S4.SS2.p4.9.m9.1.1.3.2.3.3">1</cn></apply></apply><cn id="S4.SS2.p4.9.m9.1.1.3.3.cmml" type="integer" xref="S4.SS2.p4.9.m9.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.9.m9.1c">\bm{e}-\mathbf{T}_{k_{1}}^{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.9.m9.1d">bold_italic_e - bold_T start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math>) into <math alttext="\mathbf{T}_{k_{2}}^{2}" class="ltx_Math" display="inline" id="S4.SS2.p4.10.m10.1"><semantics id="S4.SS2.p4.10.m10.1a"><msubsup id="S4.SS2.p4.10.m10.1.1" xref="S4.SS2.p4.10.m10.1.1.cmml"><mi id="S4.SS2.p4.10.m10.1.1.2.2" xref="S4.SS2.p4.10.m10.1.1.2.2.cmml">𝐓</mi><msub id="S4.SS2.p4.10.m10.1.1.2.3" xref="S4.SS2.p4.10.m10.1.1.2.3.cmml"><mi id="S4.SS2.p4.10.m10.1.1.2.3.2" xref="S4.SS2.p4.10.m10.1.1.2.3.2.cmml">k</mi><mn id="S4.SS2.p4.10.m10.1.1.2.3.3" xref="S4.SS2.p4.10.m10.1.1.2.3.3.cmml">2</mn></msub><mn id="S4.SS2.p4.10.m10.1.1.3" xref="S4.SS2.p4.10.m10.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.10.m10.1b"><apply id="S4.SS2.p4.10.m10.1.1.cmml" xref="S4.SS2.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.10.m10.1.1.1.cmml" xref="S4.SS2.p4.10.m10.1.1">superscript</csymbol><apply id="S4.SS2.p4.10.m10.1.1.2.cmml" xref="S4.SS2.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.10.m10.1.1.2.1.cmml" xref="S4.SS2.p4.10.m10.1.1">subscript</csymbol><ci id="S4.SS2.p4.10.m10.1.1.2.2.cmml" xref="S4.SS2.p4.10.m10.1.1.2.2">𝐓</ci><apply id="S4.SS2.p4.10.m10.1.1.2.3.cmml" xref="S4.SS2.p4.10.m10.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.10.m10.1.1.2.3.1.cmml" xref="S4.SS2.p4.10.m10.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p4.10.m10.1.1.2.3.2.cmml" xref="S4.SS2.p4.10.m10.1.1.2.3.2">𝑘</ci><cn id="S4.SS2.p4.10.m10.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.p4.10.m10.1.1.2.3.3">2</cn></apply></apply><cn id="S4.SS2.p4.10.m10.1.1.3.cmml" type="integer" xref="S4.SS2.p4.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.10.m10.1c">\mathbf{T}_{k_{2}}^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.10.m10.1d">bold_T start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> and so on.
The final output embedding <math alttext="\hat{\bm{e}}=\sum_{i=1}^{s}\mathbf{T}_{k_{i}}^{i}" class="ltx_Math" display="inline" id="S4.SS2.p4.11.m11.1"><semantics id="S4.SS2.p4.11.m11.1a"><mrow id="S4.SS2.p4.11.m11.1.1" xref="S4.SS2.p4.11.m11.1.1.cmml"><mover accent="true" id="S4.SS2.p4.11.m11.1.1.2" xref="S4.SS2.p4.11.m11.1.1.2.cmml"><mi id="S4.SS2.p4.11.m11.1.1.2.2" xref="S4.SS2.p4.11.m11.1.1.2.2.cmml">𝒆</mi><mo id="S4.SS2.p4.11.m11.1.1.2.1" xref="S4.SS2.p4.11.m11.1.1.2.1.cmml">^</mo></mover><mo id="S4.SS2.p4.11.m11.1.1.1" rspace="0.111em" xref="S4.SS2.p4.11.m11.1.1.1.cmml">=</mo><mrow id="S4.SS2.p4.11.m11.1.1.3" xref="S4.SS2.p4.11.m11.1.1.3.cmml"><msubsup id="S4.SS2.p4.11.m11.1.1.3.1" xref="S4.SS2.p4.11.m11.1.1.3.1.cmml"><mo id="S4.SS2.p4.11.m11.1.1.3.1.2.2" xref="S4.SS2.p4.11.m11.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.SS2.p4.11.m11.1.1.3.1.2.3" xref="S4.SS2.p4.11.m11.1.1.3.1.2.3.cmml"><mi id="S4.SS2.p4.11.m11.1.1.3.1.2.3.2" xref="S4.SS2.p4.11.m11.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.SS2.p4.11.m11.1.1.3.1.2.3.1" xref="S4.SS2.p4.11.m11.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.SS2.p4.11.m11.1.1.3.1.2.3.3" xref="S4.SS2.p4.11.m11.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.p4.11.m11.1.1.3.1.3" xref="S4.SS2.p4.11.m11.1.1.3.1.3.cmml">s</mi></msubsup><msubsup id="S4.SS2.p4.11.m11.1.1.3.2" xref="S4.SS2.p4.11.m11.1.1.3.2.cmml"><mi id="S4.SS2.p4.11.m11.1.1.3.2.2.2" xref="S4.SS2.p4.11.m11.1.1.3.2.2.2.cmml">𝐓</mi><msub id="S4.SS2.p4.11.m11.1.1.3.2.2.3" xref="S4.SS2.p4.11.m11.1.1.3.2.2.3.cmml"><mi id="S4.SS2.p4.11.m11.1.1.3.2.2.3.2" xref="S4.SS2.p4.11.m11.1.1.3.2.2.3.2.cmml">k</mi><mi id="S4.SS2.p4.11.m11.1.1.3.2.2.3.3" xref="S4.SS2.p4.11.m11.1.1.3.2.2.3.3.cmml">i</mi></msub><mi id="S4.SS2.p4.11.m11.1.1.3.2.3" xref="S4.SS2.p4.11.m11.1.1.3.2.3.cmml">i</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.11.m11.1b"><apply id="S4.SS2.p4.11.m11.1.1.cmml" xref="S4.SS2.p4.11.m11.1.1"><eq id="S4.SS2.p4.11.m11.1.1.1.cmml" xref="S4.SS2.p4.11.m11.1.1.1"></eq><apply id="S4.SS2.p4.11.m11.1.1.2.cmml" xref="S4.SS2.p4.11.m11.1.1.2"><ci id="S4.SS2.p4.11.m11.1.1.2.1.cmml" xref="S4.SS2.p4.11.m11.1.1.2.1">^</ci><ci id="S4.SS2.p4.11.m11.1.1.2.2.cmml" xref="S4.SS2.p4.11.m11.1.1.2.2">𝒆</ci></apply><apply id="S4.SS2.p4.11.m11.1.1.3.cmml" xref="S4.SS2.p4.11.m11.1.1.3"><apply id="S4.SS2.p4.11.m11.1.1.3.1.cmml" xref="S4.SS2.p4.11.m11.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS2.p4.11.m11.1.1.3.1.1.cmml" xref="S4.SS2.p4.11.m11.1.1.3.1">superscript</csymbol><apply id="S4.SS2.p4.11.m11.1.1.3.1.2.cmml" xref="S4.SS2.p4.11.m11.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS2.p4.11.m11.1.1.3.1.2.1.cmml" xref="S4.SS2.p4.11.m11.1.1.3.1">subscript</csymbol><sum id="S4.SS2.p4.11.m11.1.1.3.1.2.2.cmml" xref="S4.SS2.p4.11.m11.1.1.3.1.2.2"></sum><apply id="S4.SS2.p4.11.m11.1.1.3.1.2.3.cmml" xref="S4.SS2.p4.11.m11.1.1.3.1.2.3"><eq id="S4.SS2.p4.11.m11.1.1.3.1.2.3.1.cmml" xref="S4.SS2.p4.11.m11.1.1.3.1.2.3.1"></eq><ci id="S4.SS2.p4.11.m11.1.1.3.1.2.3.2.cmml" xref="S4.SS2.p4.11.m11.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.SS2.p4.11.m11.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.SS2.p4.11.m11.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p4.11.m11.1.1.3.1.3.cmml" xref="S4.SS2.p4.11.m11.1.1.3.1.3">𝑠</ci></apply><apply id="S4.SS2.p4.11.m11.1.1.3.2.cmml" xref="S4.SS2.p4.11.m11.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.11.m11.1.1.3.2.1.cmml" xref="S4.SS2.p4.11.m11.1.1.3.2">superscript</csymbol><apply id="S4.SS2.p4.11.m11.1.1.3.2.2.cmml" xref="S4.SS2.p4.11.m11.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.11.m11.1.1.3.2.2.1.cmml" xref="S4.SS2.p4.11.m11.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p4.11.m11.1.1.3.2.2.2.cmml" xref="S4.SS2.p4.11.m11.1.1.3.2.2.2">𝐓</ci><apply id="S4.SS2.p4.11.m11.1.1.3.2.2.3.cmml" xref="S4.SS2.p4.11.m11.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.11.m11.1.1.3.2.2.3.1.cmml" xref="S4.SS2.p4.11.m11.1.1.3.2.2.3">subscript</csymbol><ci id="S4.SS2.p4.11.m11.1.1.3.2.2.3.2.cmml" xref="S4.SS2.p4.11.m11.1.1.3.2.2.3.2">𝑘</ci><ci id="S4.SS2.p4.11.m11.1.1.3.2.2.3.3.cmml" xref="S4.SS2.p4.11.m11.1.1.3.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS2.p4.11.m11.1.1.3.2.3.cmml" xref="S4.SS2.p4.11.m11.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.11.m11.1c">\hat{\bm{e}}=\sum_{i=1}^{s}\mathbf{T}_{k_{i}}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.11.m11.1d">over^ start_ARG bold_italic_e end_ARG = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT bold_T start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>.
LightRec <cite class="ltx_cite ltx_citemacro_citep">(Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib35" title="">2020</a>)</cite> adopts AQ to compress the item embeddings and uses a pretrained model as a teacher to train the meta-tables effectively.
LISA <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib64" title="">2021</a>)</cite> utilizes AQ to compress the DLRMs where self-attention is performed for sequence processing.
Note that there is a mass of inner product between embeddings in self-attention which suffer from extremely expensive computing costs.
To alleviates this problem, LISA pre-calculates the inner product between meta-embeddings in the same meta-table and stores the results in a small table after training.
Then, the inner product of embeddings in self-attention can be calculated by summing the inner product of meta-embeddings which can
accelerate the inference significantly.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Decomposition</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.4">Hashing and vector quantization use one-hot index vectors to perform a hard selection (i.e., selecting only one meta-embedding) in the meta-table
and alleviate the collisions between features by maintaining multiply meta-tables.
On the contrary, decomposition approaches make a soft selection by summing over all the meta-embeddings in a meta-table <math alttext="\mathbf{T}\in\operatorname*{\mathbb{R}}^{m\times d}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">𝐓</mi><mo id="S4.SS3.p1.1.m1.1.1.1" rspace="0.1389em" xref="S4.SS3.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml"><mo id="S4.SS3.p1.1.m1.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p1.1.m1.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p1.1.m1.1.1.3.3" xref="S4.SS3.p1.1.m1.1.1.3.3.cmml"><mi id="S4.SS3.p1.1.m1.1.1.3.3.2" xref="S4.SS3.p1.1.m1.1.1.3.3.2.cmml">m</mi><mo id="S4.SS3.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p1.1.m1.1.1.3.3.3" xref="S4.SS3.p1.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><in id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></in><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝐓</ci><apply id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.3.2.cmml" xref="S4.SS3.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS3.p1.1.m1.1.1.3.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3"><times id="S4.SS3.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3.1"></times><ci id="S4.SS3.p1.1.m1.1.1.3.3.2.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3.2">𝑚</ci><ci id="S4.SS3.p1.1.m1.1.1.3.3.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\mathbf{T}\in\operatorname*{\mathbb{R}}^{m\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">bold_T ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> with a real-valued index vector <math alttext="\bm{I}\in\operatorname*{\mathbb{R}}^{m}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">𝑰</mi><mo id="S4.SS3.p1.2.m2.1.1.1" rspace="0.1389em" xref="S4.SS3.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml"><mo id="S4.SS3.p1.2.m2.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p1.2.m2.1.1.3.2.cmml">ℝ</mo><mi id="S4.SS3.p1.2.m2.1.1.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><in id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"></in><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝑰</ci><apply id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S4.SS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\bm{I}\in\operatorname*{\mathbb{R}}^{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">bold_italic_I ∈ blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>.
Due to the wide representation space of the real-valued index vectors, one meta-table is sufficient to resolve the collisions between features.
Each feature will have a unique index vector stored in the index matrix <math alttext="\mathbf{{I}}_{M}\in\operatorname*{\mathbb{R}}^{n\times m}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><msub id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2.2" xref="S4.SS3.p1.3.m3.1.1.2.2.cmml">𝐈</mi><mi id="S4.SS3.p1.3.m3.1.1.2.3" xref="S4.SS3.p1.3.m3.1.1.2.3.cmml">M</mi></msub><mo id="S4.SS3.p1.3.m3.1.1.1" rspace="0.1389em" xref="S4.SS3.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml"><mo id="S4.SS3.p1.3.m3.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p1.3.m3.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p1.3.m3.1.1.3.3" xref="S4.SS3.p1.3.m3.1.1.3.3.cmml"><mi id="S4.SS3.p1.3.m3.1.1.3.3.2" xref="S4.SS3.p1.3.m3.1.1.3.3.2.cmml">n</mi><mo id="S4.SS3.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p1.3.m3.1.1.3.3.3" xref="S4.SS3.p1.3.m3.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><in id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"></in><apply id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.2.1.cmml" xref="S4.SS3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.2.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2.2">𝐈</ci><ci id="S4.SS3.p1.3.m3.1.1.2.3.cmml" xref="S4.SS3.p1.3.m3.1.1.2.3">𝑀</ci></apply><apply id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S4.SS3.p1.3.m3.1.1.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3"><times id="S4.SS3.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.1"></times><ci id="S4.SS3.p1.3.m3.1.1.3.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.2">𝑛</ci><ci id="S4.SS3.p1.3.m3.1.1.3.3.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\mathbf{{I}}_{M}\in\operatorname*{\mathbb{R}}^{n\times m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">bold_I start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> when formulating the decomposition as <math alttext="\mathbf{E}={\mathbf{I}}_{M}\times\mathbf{T}" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><mrow id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">𝐄</mi><mo id="S4.SS3.p1.4.m4.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml"><msub id="S4.SS3.p1.4.m4.1.1.3.2" xref="S4.SS3.p1.4.m4.1.1.3.2.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.2.2" xref="S4.SS3.p1.4.m4.1.1.3.2.2.cmml">𝐈</mi><mi id="S4.SS3.p1.4.m4.1.1.3.2.3" xref="S4.SS3.p1.4.m4.1.1.3.2.3.cmml">M</mi></msub><mo id="S4.SS3.p1.4.m4.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.4.m4.1.1.3.1.cmml">×</mo><mi id="S4.SS3.p1.4.m4.1.1.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.cmml">𝐓</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><eq id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1"></eq><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">𝐄</ci><apply id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3"><times id="S4.SS3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3.1"></times><apply id="S4.SS3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.3.2.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.3.2.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2.2">𝐈</ci><ci id="S4.SS3.p1.4.m4.1.1.3.2.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2.3">𝑀</ci></apply><ci id="S4.SS3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3">𝐓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">\mathbf{E}={\mathbf{I}}_{M}\times\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">bold_E = bold_I start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT × bold_T</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.17">MLET <cite class="ltx_cite ltx_citemacro_citep">(Ghaemmaghami et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib15" title="">2020</a>)</cite> factorizes the embedding table <math alttext="\mathbf{E}\in\operatorname*{\mathbb{R}}^{n\times d}" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">𝐄</mi><mo id="S4.SS3.p2.1.m1.1.1.1" rspace="0.1389em" xref="S4.SS3.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml"><mo id="S4.SS3.p2.1.m1.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p2.1.m1.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p2.1.m1.1.1.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.3.2" xref="S4.SS3.p2.1.m1.1.1.3.3.2.cmml">n</mi><mo id="S4.SS3.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p2.1.m1.1.1.3.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><in id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1"></in><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝐄</ci><apply id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3"><times id="S4.SS3.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.1"></times><ci id="S4.SS3.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.2">𝑛</ci><ci id="S4.SS3.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\mathbf{E}\in\operatorname*{\mathbb{R}}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">bold_E ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> in terms of <math alttext="\mathbf{I}_{M}\in\operatorname*{\mathbb{R}}^{n\times m}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mrow id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><msub id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2.2" xref="S4.SS3.p2.2.m2.1.1.2.2.cmml">𝐈</mi><mi id="S4.SS3.p2.2.m2.1.1.2.3" xref="S4.SS3.p2.2.m2.1.1.2.3.cmml">M</mi></msub><mo id="S4.SS3.p2.2.m2.1.1.1" rspace="0.1389em" xref="S4.SS3.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml"><mo id="S4.SS3.p2.2.m2.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p2.2.m2.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p2.2.m2.1.1.3.3" xref="S4.SS3.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS3.p2.2.m2.1.1.3.3.2" xref="S4.SS3.p2.2.m2.1.1.3.3.2.cmml">n</mi><mo id="S4.SS3.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p2.2.m2.1.1.3.3.3" xref="S4.SS3.p2.2.m2.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><in id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1"></in><apply id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.2.1.cmml" xref="S4.SS3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2.2">𝐈</ci><ci id="S4.SS3.p2.2.m2.1.1.2.3.cmml" xref="S4.SS3.p2.2.m2.1.1.2.3">𝑀</ci></apply><apply id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.3.1.cmml" xref="S4.SS3.p2.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.3.2.cmml" xref="S4.SS3.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS3.p2.2.m2.1.1.3.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3.3"><times id="S4.SS3.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS3.p2.2.m2.1.1.3.3.1"></times><ci id="S4.SS3.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS3.p2.2.m2.1.1.3.3.2">𝑛</ci><ci id="S4.SS3.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\mathbf{I}_{M}\in\operatorname*{\mathbb{R}}^{n\times m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">bold_I start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{T}\in R^{m\times d}" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1"><semantics id="S4.SS3.p2.3.m3.1a"><mrow id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">𝐓</mi><mo id="S4.SS3.p2.3.m3.1.1.1" xref="S4.SS3.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml"><mi id="S4.SS3.p2.3.m3.1.1.3.2" xref="S4.SS3.p2.3.m3.1.1.3.2.cmml">R</mi><mrow id="S4.SS3.p2.3.m3.1.1.3.3" xref="S4.SS3.p2.3.m3.1.1.3.3.cmml"><mi id="S4.SS3.p2.3.m3.1.1.3.3.2" xref="S4.SS3.p2.3.m3.1.1.3.3.2.cmml">m</mi><mo id="S4.SS3.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p2.3.m3.1.1.3.3.3" xref="S4.SS3.p2.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><in id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1.1"></in><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">𝐓</ci><apply id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.1.1.3.1.cmml" xref="S4.SS3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.3.m3.1.1.3.2.cmml" xref="S4.SS3.p2.3.m3.1.1.3.2">𝑅</ci><apply id="S4.SS3.p2.3.m3.1.1.3.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3.3"><times id="S4.SS3.p2.3.m3.1.1.3.3.1.cmml" xref="S4.SS3.p2.3.m3.1.1.3.3.1"></times><ci id="S4.SS3.p2.3.m3.1.1.3.3.2.cmml" xref="S4.SS3.p2.3.m3.1.1.3.3.2">𝑚</ci><ci id="S4.SS3.p2.3.m3.1.1.3.3.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">\mathbf{T}\in R^{m\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">bold_T ∈ italic_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.
Different from the low-rank decomposition where <math alttext="m&lt;d" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><mrow id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml">m</mi><mo id="S4.SS3.p2.4.m4.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.cmml">&lt;</mo><mi id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><lt id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1"></lt><ci id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2">𝑚</ci><ci id="S4.SS3.p2.4.m4.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">m&lt;d</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">italic_m &lt; italic_d</annotation></semantics></math>,
MLET decomposes the embedding table into larger matrices (i.e., <math alttext="m&gt;d" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m5.1"><semantics id="S4.SS3.p2.5.m5.1a"><mrow id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml"><mi id="S4.SS3.p2.5.m5.1.1.2" xref="S4.SS3.p2.5.m5.1.1.2.cmml">m</mi><mo id="S4.SS3.p2.5.m5.1.1.1" xref="S4.SS3.p2.5.m5.1.1.1.cmml">&gt;</mo><mi id="S4.SS3.p2.5.m5.1.1.3" xref="S4.SS3.p2.5.m5.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><apply id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1"><gt id="S4.SS3.p2.5.m5.1.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1.1"></gt><ci id="S4.SS3.p2.5.m5.1.1.2.cmml" xref="S4.SS3.p2.5.m5.1.1.2">𝑚</ci><ci id="S4.SS3.p2.5.m5.1.1.3.cmml" xref="S4.SS3.p2.5.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">m&gt;d</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m5.1d">italic_m &gt; italic_d</annotation></semantics></math>) at training to ensure a larger optimization space.
After training, MLET generates the embedding table as <math alttext="\mathbf{E}={\mathbf{I}}_{M}\times\mathbf{T}" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m6.1"><semantics id="S4.SS3.p2.6.m6.1a"><mrow id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml"><mi id="S4.SS3.p2.6.m6.1.1.2" xref="S4.SS3.p2.6.m6.1.1.2.cmml">𝐄</mi><mo id="S4.SS3.p2.6.m6.1.1.1" xref="S4.SS3.p2.6.m6.1.1.1.cmml">=</mo><mrow id="S4.SS3.p2.6.m6.1.1.3" xref="S4.SS3.p2.6.m6.1.1.3.cmml"><msub id="S4.SS3.p2.6.m6.1.1.3.2" xref="S4.SS3.p2.6.m6.1.1.3.2.cmml"><mi id="S4.SS3.p2.6.m6.1.1.3.2.2" xref="S4.SS3.p2.6.m6.1.1.3.2.2.cmml">𝐈</mi><mi id="S4.SS3.p2.6.m6.1.1.3.2.3" xref="S4.SS3.p2.6.m6.1.1.3.2.3.cmml">M</mi></msub><mo id="S4.SS3.p2.6.m6.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p2.6.m6.1.1.3.1.cmml">×</mo><mi id="S4.SS3.p2.6.m6.1.1.3.3" xref="S4.SS3.p2.6.m6.1.1.3.3.cmml">𝐓</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><apply id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1"><eq id="S4.SS3.p2.6.m6.1.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1.1"></eq><ci id="S4.SS3.p2.6.m6.1.1.2.cmml" xref="S4.SS3.p2.6.m6.1.1.2">𝐄</ci><apply id="S4.SS3.p2.6.m6.1.1.3.cmml" xref="S4.SS3.p2.6.m6.1.1.3"><times id="S4.SS3.p2.6.m6.1.1.3.1.cmml" xref="S4.SS3.p2.6.m6.1.1.3.1"></times><apply id="S4.SS3.p2.6.m6.1.1.3.2.cmml" xref="S4.SS3.p2.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.1.1.3.2.1.cmml" xref="S4.SS3.p2.6.m6.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p2.6.m6.1.1.3.2.2.cmml" xref="S4.SS3.p2.6.m6.1.1.3.2.2">𝐈</ci><ci id="S4.SS3.p2.6.m6.1.1.3.2.3.cmml" xref="S4.SS3.p2.6.m6.1.1.3.2.3">𝑀</ci></apply><ci id="S4.SS3.p2.6.m6.1.1.3.3.cmml" xref="S4.SS3.p2.6.m6.1.1.3.3">𝐓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">\mathbf{E}={\mathbf{I}}_{M}\times\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m6.1d">bold_E = bold_I start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT × bold_T</annotation></semantics></math> for memory reduction and fast retrieval.
ANT <cite class="ltx_cite ltx_citemacro_citep">(Liang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib36" title="">2021</a>)</cite> adopt a better initialization for <math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="S4.SS3.p2.7.m7.1"><semantics id="S4.SS3.p2.7.m7.1a"><mi id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.1b"><ci id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.7.m7.1d">bold_T</annotation></semantics></math> and imposes a sparse constraint on <math alttext="\mathbf{I}_{M}" class="ltx_Math" display="inline" id="S4.SS3.p2.8.m8.1"><semantics id="S4.SS3.p2.8.m8.1a"><msub id="S4.SS3.p2.8.m8.1.1" xref="S4.SS3.p2.8.m8.1.1.cmml"><mi id="S4.SS3.p2.8.m8.1.1.2" xref="S4.SS3.p2.8.m8.1.1.2.cmml">𝐈</mi><mi id="S4.SS3.p2.8.m8.1.1.3" xref="S4.SS3.p2.8.m8.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m8.1b"><apply id="S4.SS3.p2.8.m8.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m8.1.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1">subscript</csymbol><ci id="S4.SS3.p2.8.m8.1.1.2.cmml" xref="S4.SS3.p2.8.m8.1.1.2">𝐈</ci><ci id="S4.SS3.p2.8.m8.1.1.3.cmml" xref="S4.SS3.p2.8.m8.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m8.1c">\mathbf{I}_{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.8.m8.1d">bold_I start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math>.
Specifically, ANT initializes the meta-table <math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="S4.SS3.p2.9.m9.1"><semantics id="S4.SS3.p2.9.m9.1a"><mi id="S4.SS3.p2.9.m9.1.1" xref="S4.SS3.p2.9.m9.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m9.1b"><ci id="S4.SS3.p2.9.m9.1.1.cmml" xref="S4.SS3.p2.9.m9.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m9.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.9.m9.1d">bold_T</annotation></semantics></math> by clustering the embeddings of a pretrained model.
In addition, to reduce redundancy, ANT use an <math alttext="\ell_{1}" class="ltx_Math" display="inline" id="S4.SS3.p2.10.m10.1"><semantics id="S4.SS3.p2.10.m10.1a"><msub id="S4.SS3.p2.10.m10.1.1" xref="S4.SS3.p2.10.m10.1.1.cmml"><mi id="S4.SS3.p2.10.m10.1.1.2" mathvariant="normal" xref="S4.SS3.p2.10.m10.1.1.2.cmml">ℓ</mi><mn id="S4.SS3.p2.10.m10.1.1.3" xref="S4.SS3.p2.10.m10.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.10.m10.1b"><apply id="S4.SS3.p2.10.m10.1.1.cmml" xref="S4.SS3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.10.m10.1.1.1.cmml" xref="S4.SS3.p2.10.m10.1.1">subscript</csymbol><ci id="S4.SS3.p2.10.m10.1.1.2.cmml" xref="S4.SS3.p2.10.m10.1.1.2">ℓ</ci><cn id="S4.SS3.p2.10.m10.1.1.3.cmml" type="integer" xref="S4.SS3.p2.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.10.m10.1c">\ell_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.10.m10.1d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> penalty on <math alttext="\mathbf{I}_{M}" class="ltx_Math" display="inline" id="S4.SS3.p2.11.m11.1"><semantics id="S4.SS3.p2.11.m11.1a"><msub id="S4.SS3.p2.11.m11.1.1" xref="S4.SS3.p2.11.m11.1.1.cmml"><mi id="S4.SS3.p2.11.m11.1.1.2" xref="S4.SS3.p2.11.m11.1.1.2.cmml">𝐈</mi><mi id="S4.SS3.p2.11.m11.1.1.3" xref="S4.SS3.p2.11.m11.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.11.m11.1b"><apply id="S4.SS3.p2.11.m11.1.1.cmml" xref="S4.SS3.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.11.m11.1.1.1.cmml" xref="S4.SS3.p2.11.m11.1.1">subscript</csymbol><ci id="S4.SS3.p2.11.m11.1.1.2.cmml" xref="S4.SS3.p2.11.m11.1.1.2">𝐈</ci><ci id="S4.SS3.p2.11.m11.1.1.3.cmml" xref="S4.SS3.p2.11.m11.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.11.m11.1c">\mathbf{I}_{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.11.m11.1d">bold_I start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> and constrain its domain to be non-negative.
Instead of learning and storing the index vectors at training,
DHE <cite class="ltx_cite ltx_citemacro_citep">(Kang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib28" title="">2021</a>)</cite> develop a hash encoder <math alttext="\mathcal{H}:\mathbb{N}\rightarrow\operatorname*{\mathbb{R}}^{m}" class="ltx_Math" display="inline" id="S4.SS3.p2.12.m12.1"><semantics id="S4.SS3.p2.12.m12.1a"><mrow id="S4.SS3.p2.12.m12.1.1" xref="S4.SS3.p2.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.12.m12.1.1.2" xref="S4.SS3.p2.12.m12.1.1.2.cmml">ℋ</mi><mo id="S4.SS3.p2.12.m12.1.1.1" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p2.12.m12.1.1.1.cmml">:</mo><mrow id="S4.SS3.p2.12.m12.1.1.3" xref="S4.SS3.p2.12.m12.1.1.3.cmml"><mi id="S4.SS3.p2.12.m12.1.1.3.2" xref="S4.SS3.p2.12.m12.1.1.3.2.cmml">ℕ</mi><mo id="S4.SS3.p2.12.m12.1.1.3.1" rspace="0.1389em" stretchy="false" xref="S4.SS3.p2.12.m12.1.1.3.1.cmml">→</mo><msup id="S4.SS3.p2.12.m12.1.1.3.3" xref="S4.SS3.p2.12.m12.1.1.3.3.cmml"><mo id="S4.SS3.p2.12.m12.1.1.3.3.2" lspace="0.1389em" xref="S4.SS3.p2.12.m12.1.1.3.3.2.cmml">ℝ</mo><mi id="S4.SS3.p2.12.m12.1.1.3.3.3" xref="S4.SS3.p2.12.m12.1.1.3.3.3.cmml">m</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.12.m12.1b"><apply id="S4.SS3.p2.12.m12.1.1.cmml" xref="S4.SS3.p2.12.m12.1.1"><ci id="S4.SS3.p2.12.m12.1.1.1.cmml" xref="S4.SS3.p2.12.m12.1.1.1">:</ci><ci id="S4.SS3.p2.12.m12.1.1.2.cmml" xref="S4.SS3.p2.12.m12.1.1.2">ℋ</ci><apply id="S4.SS3.p2.12.m12.1.1.3.cmml" xref="S4.SS3.p2.12.m12.1.1.3"><ci id="S4.SS3.p2.12.m12.1.1.3.1.cmml" xref="S4.SS3.p2.12.m12.1.1.3.1">→</ci><ci id="S4.SS3.p2.12.m12.1.1.3.2.cmml" xref="S4.SS3.p2.12.m12.1.1.3.2">ℕ</ci><apply id="S4.SS3.p2.12.m12.1.1.3.3.cmml" xref="S4.SS3.p2.12.m12.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p2.12.m12.1.1.3.3.1.cmml" xref="S4.SS3.p2.12.m12.1.1.3.3">superscript</csymbol><ci id="S4.SS3.p2.12.m12.1.1.3.3.2.cmml" xref="S4.SS3.p2.12.m12.1.1.3.3.2">ℝ</ci><ci id="S4.SS3.p2.12.m12.1.1.3.3.3.cmml" xref="S4.SS3.p2.12.m12.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.12.m12.1c">\mathcal{H}:\mathbb{N}\rightarrow\operatorname*{\mathbb{R}}^{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.12.m12.1d">caligraphic_H : blackboard_N → blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> to map each feature id into an index vector <math alttext="\bm{I}\in\operatorname*{\mathbb{R}}^{m}" class="ltx_Math" display="inline" id="S4.SS3.p2.13.m13.1"><semantics id="S4.SS3.p2.13.m13.1a"><mrow id="S4.SS3.p2.13.m13.1.1" xref="S4.SS3.p2.13.m13.1.1.cmml"><mi id="S4.SS3.p2.13.m13.1.1.2" xref="S4.SS3.p2.13.m13.1.1.2.cmml">𝑰</mi><mo id="S4.SS3.p2.13.m13.1.1.1" rspace="0.1389em" xref="S4.SS3.p2.13.m13.1.1.1.cmml">∈</mo><msup id="S4.SS3.p2.13.m13.1.1.3" xref="S4.SS3.p2.13.m13.1.1.3.cmml"><mo id="S4.SS3.p2.13.m13.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p2.13.m13.1.1.3.2.cmml">ℝ</mo><mi id="S4.SS3.p2.13.m13.1.1.3.3" xref="S4.SS3.p2.13.m13.1.1.3.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.13.m13.1b"><apply id="S4.SS3.p2.13.m13.1.1.cmml" xref="S4.SS3.p2.13.m13.1.1"><in id="S4.SS3.p2.13.m13.1.1.1.cmml" xref="S4.SS3.p2.13.m13.1.1.1"></in><ci id="S4.SS3.p2.13.m13.1.1.2.cmml" xref="S4.SS3.p2.13.m13.1.1.2">𝑰</ci><apply id="S4.SS3.p2.13.m13.1.1.3.cmml" xref="S4.SS3.p2.13.m13.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.13.m13.1.1.3.1.cmml" xref="S4.SS3.p2.13.m13.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.13.m13.1.1.3.2.cmml" xref="S4.SS3.p2.13.m13.1.1.3.2">ℝ</ci><ci id="S4.SS3.p2.13.m13.1.1.3.3.cmml" xref="S4.SS3.p2.13.m13.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.13.m13.1c">\bm{I}\in\operatorname*{\mathbb{R}}^{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.13.m13.1d">bold_italic_I ∈ blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> on the fly.
Specifically, <math alttext="\mathcal{H}(x)=[h^{1}(x),h^{2}(x),...,h^{m}(x)]" class="ltx_Math" display="inline" id="S4.SS3.p2.14.m14.8"><semantics id="S4.SS3.p2.14.m14.8a"><mrow id="S4.SS3.p2.14.m14.8.8" xref="S4.SS3.p2.14.m14.8.8.cmml"><mrow id="S4.SS3.p2.14.m14.8.8.5" xref="S4.SS3.p2.14.m14.8.8.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.14.m14.8.8.5.2" xref="S4.SS3.p2.14.m14.8.8.5.2.cmml">ℋ</mi><mo id="S4.SS3.p2.14.m14.8.8.5.1" xref="S4.SS3.p2.14.m14.8.8.5.1.cmml">⁢</mo><mrow id="S4.SS3.p2.14.m14.8.8.5.3.2" xref="S4.SS3.p2.14.m14.8.8.5.cmml"><mo id="S4.SS3.p2.14.m14.8.8.5.3.2.1" stretchy="false" xref="S4.SS3.p2.14.m14.8.8.5.cmml">(</mo><mi id="S4.SS3.p2.14.m14.1.1" xref="S4.SS3.p2.14.m14.1.1.cmml">x</mi><mo id="S4.SS3.p2.14.m14.8.8.5.3.2.2" stretchy="false" xref="S4.SS3.p2.14.m14.8.8.5.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p2.14.m14.8.8.4" xref="S4.SS3.p2.14.m14.8.8.4.cmml">=</mo><mrow id="S4.SS3.p2.14.m14.8.8.3.3" xref="S4.SS3.p2.14.m14.8.8.3.4.cmml"><mo id="S4.SS3.p2.14.m14.8.8.3.3.4" stretchy="false" xref="S4.SS3.p2.14.m14.8.8.3.4.cmml">[</mo><mrow id="S4.SS3.p2.14.m14.6.6.1.1.1" xref="S4.SS3.p2.14.m14.6.6.1.1.1.cmml"><msup id="S4.SS3.p2.14.m14.6.6.1.1.1.2" xref="S4.SS3.p2.14.m14.6.6.1.1.1.2.cmml"><mi id="S4.SS3.p2.14.m14.6.6.1.1.1.2.2" xref="S4.SS3.p2.14.m14.6.6.1.1.1.2.2.cmml">h</mi><mn id="S4.SS3.p2.14.m14.6.6.1.1.1.2.3" xref="S4.SS3.p2.14.m14.6.6.1.1.1.2.3.cmml">1</mn></msup><mo id="S4.SS3.p2.14.m14.6.6.1.1.1.1" xref="S4.SS3.p2.14.m14.6.6.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS3.p2.14.m14.6.6.1.1.1.3.2" xref="S4.SS3.p2.14.m14.6.6.1.1.1.cmml"><mo id="S4.SS3.p2.14.m14.6.6.1.1.1.3.2.1" stretchy="false" xref="S4.SS3.p2.14.m14.6.6.1.1.1.cmml">(</mo><mi id="S4.SS3.p2.14.m14.2.2" xref="S4.SS3.p2.14.m14.2.2.cmml">x</mi><mo id="S4.SS3.p2.14.m14.6.6.1.1.1.3.2.2" stretchy="false" xref="S4.SS3.p2.14.m14.6.6.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p2.14.m14.8.8.3.3.5" xref="S4.SS3.p2.14.m14.8.8.3.4.cmml">,</mo><mrow id="S4.SS3.p2.14.m14.7.7.2.2.2" xref="S4.SS3.p2.14.m14.7.7.2.2.2.cmml"><msup id="S4.SS3.p2.14.m14.7.7.2.2.2.2" xref="S4.SS3.p2.14.m14.7.7.2.2.2.2.cmml"><mi id="S4.SS3.p2.14.m14.7.7.2.2.2.2.2" xref="S4.SS3.p2.14.m14.7.7.2.2.2.2.2.cmml">h</mi><mn id="S4.SS3.p2.14.m14.7.7.2.2.2.2.3" xref="S4.SS3.p2.14.m14.7.7.2.2.2.2.3.cmml">2</mn></msup><mo id="S4.SS3.p2.14.m14.7.7.2.2.2.1" xref="S4.SS3.p2.14.m14.7.7.2.2.2.1.cmml">⁢</mo><mrow id="S4.SS3.p2.14.m14.7.7.2.2.2.3.2" xref="S4.SS3.p2.14.m14.7.7.2.2.2.cmml"><mo id="S4.SS3.p2.14.m14.7.7.2.2.2.3.2.1" stretchy="false" xref="S4.SS3.p2.14.m14.7.7.2.2.2.cmml">(</mo><mi id="S4.SS3.p2.14.m14.3.3" xref="S4.SS3.p2.14.m14.3.3.cmml">x</mi><mo id="S4.SS3.p2.14.m14.7.7.2.2.2.3.2.2" stretchy="false" xref="S4.SS3.p2.14.m14.7.7.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p2.14.m14.8.8.3.3.6" xref="S4.SS3.p2.14.m14.8.8.3.4.cmml">,</mo><mi id="S4.SS3.p2.14.m14.5.5" mathvariant="normal" xref="S4.SS3.p2.14.m14.5.5.cmml">…</mi><mo id="S4.SS3.p2.14.m14.8.8.3.3.7" xref="S4.SS3.p2.14.m14.8.8.3.4.cmml">,</mo><mrow id="S4.SS3.p2.14.m14.8.8.3.3.3" xref="S4.SS3.p2.14.m14.8.8.3.3.3.cmml"><msup id="S4.SS3.p2.14.m14.8.8.3.3.3.2" xref="S4.SS3.p2.14.m14.8.8.3.3.3.2.cmml"><mi id="S4.SS3.p2.14.m14.8.8.3.3.3.2.2" xref="S4.SS3.p2.14.m14.8.8.3.3.3.2.2.cmml">h</mi><mi id="S4.SS3.p2.14.m14.8.8.3.3.3.2.3" xref="S4.SS3.p2.14.m14.8.8.3.3.3.2.3.cmml">m</mi></msup><mo id="S4.SS3.p2.14.m14.8.8.3.3.3.1" xref="S4.SS3.p2.14.m14.8.8.3.3.3.1.cmml">⁢</mo><mrow id="S4.SS3.p2.14.m14.8.8.3.3.3.3.2" xref="S4.SS3.p2.14.m14.8.8.3.3.3.cmml"><mo id="S4.SS3.p2.14.m14.8.8.3.3.3.3.2.1" stretchy="false" xref="S4.SS3.p2.14.m14.8.8.3.3.3.cmml">(</mo><mi id="S4.SS3.p2.14.m14.4.4" xref="S4.SS3.p2.14.m14.4.4.cmml">x</mi><mo id="S4.SS3.p2.14.m14.8.8.3.3.3.3.2.2" stretchy="false" xref="S4.SS3.p2.14.m14.8.8.3.3.3.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p2.14.m14.8.8.3.3.8" stretchy="false" xref="S4.SS3.p2.14.m14.8.8.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.14.m14.8b"><apply id="S4.SS3.p2.14.m14.8.8.cmml" xref="S4.SS3.p2.14.m14.8.8"><eq id="S4.SS3.p2.14.m14.8.8.4.cmml" xref="S4.SS3.p2.14.m14.8.8.4"></eq><apply id="S4.SS3.p2.14.m14.8.8.5.cmml" xref="S4.SS3.p2.14.m14.8.8.5"><times id="S4.SS3.p2.14.m14.8.8.5.1.cmml" xref="S4.SS3.p2.14.m14.8.8.5.1"></times><ci id="S4.SS3.p2.14.m14.8.8.5.2.cmml" xref="S4.SS3.p2.14.m14.8.8.5.2">ℋ</ci><ci id="S4.SS3.p2.14.m14.1.1.cmml" xref="S4.SS3.p2.14.m14.1.1">𝑥</ci></apply><list id="S4.SS3.p2.14.m14.8.8.3.4.cmml" xref="S4.SS3.p2.14.m14.8.8.3.3"><apply id="S4.SS3.p2.14.m14.6.6.1.1.1.cmml" xref="S4.SS3.p2.14.m14.6.6.1.1.1"><times id="S4.SS3.p2.14.m14.6.6.1.1.1.1.cmml" xref="S4.SS3.p2.14.m14.6.6.1.1.1.1"></times><apply id="S4.SS3.p2.14.m14.6.6.1.1.1.2.cmml" xref="S4.SS3.p2.14.m14.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.14.m14.6.6.1.1.1.2.1.cmml" xref="S4.SS3.p2.14.m14.6.6.1.1.1.2">superscript</csymbol><ci id="S4.SS3.p2.14.m14.6.6.1.1.1.2.2.cmml" xref="S4.SS3.p2.14.m14.6.6.1.1.1.2.2">ℎ</ci><cn id="S4.SS3.p2.14.m14.6.6.1.1.1.2.3.cmml" type="integer" xref="S4.SS3.p2.14.m14.6.6.1.1.1.2.3">1</cn></apply><ci id="S4.SS3.p2.14.m14.2.2.cmml" xref="S4.SS3.p2.14.m14.2.2">𝑥</ci></apply><apply id="S4.SS3.p2.14.m14.7.7.2.2.2.cmml" xref="S4.SS3.p2.14.m14.7.7.2.2.2"><times id="S4.SS3.p2.14.m14.7.7.2.2.2.1.cmml" xref="S4.SS3.p2.14.m14.7.7.2.2.2.1"></times><apply id="S4.SS3.p2.14.m14.7.7.2.2.2.2.cmml" xref="S4.SS3.p2.14.m14.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.14.m14.7.7.2.2.2.2.1.cmml" xref="S4.SS3.p2.14.m14.7.7.2.2.2.2">superscript</csymbol><ci id="S4.SS3.p2.14.m14.7.7.2.2.2.2.2.cmml" xref="S4.SS3.p2.14.m14.7.7.2.2.2.2.2">ℎ</ci><cn id="S4.SS3.p2.14.m14.7.7.2.2.2.2.3.cmml" type="integer" xref="S4.SS3.p2.14.m14.7.7.2.2.2.2.3">2</cn></apply><ci id="S4.SS3.p2.14.m14.3.3.cmml" xref="S4.SS3.p2.14.m14.3.3">𝑥</ci></apply><ci id="S4.SS3.p2.14.m14.5.5.cmml" xref="S4.SS3.p2.14.m14.5.5">…</ci><apply id="S4.SS3.p2.14.m14.8.8.3.3.3.cmml" xref="S4.SS3.p2.14.m14.8.8.3.3.3"><times id="S4.SS3.p2.14.m14.8.8.3.3.3.1.cmml" xref="S4.SS3.p2.14.m14.8.8.3.3.3.1"></times><apply id="S4.SS3.p2.14.m14.8.8.3.3.3.2.cmml" xref="S4.SS3.p2.14.m14.8.8.3.3.3.2"><csymbol cd="ambiguous" id="S4.SS3.p2.14.m14.8.8.3.3.3.2.1.cmml" xref="S4.SS3.p2.14.m14.8.8.3.3.3.2">superscript</csymbol><ci id="S4.SS3.p2.14.m14.8.8.3.3.3.2.2.cmml" xref="S4.SS3.p2.14.m14.8.8.3.3.3.2.2">ℎ</ci><ci id="S4.SS3.p2.14.m14.8.8.3.3.3.2.3.cmml" xref="S4.SS3.p2.14.m14.8.8.3.3.3.2.3">𝑚</ci></apply><ci id="S4.SS3.p2.14.m14.4.4.cmml" xref="S4.SS3.p2.14.m14.4.4">𝑥</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.14.m14.8c">\mathcal{H}(x)=[h^{1}(x),h^{2}(x),...,h^{m}(x)]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.14.m14.8d">caligraphic_H ( italic_x ) = [ italic_h start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ( italic_x ) , italic_h start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_x ) , … , italic_h start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ( italic_x ) ]</annotation></semantics></math>, where <math alttext="\{h^{i}\}_{i=1}^{m}" class="ltx_Math" display="inline" id="S4.SS3.p2.15.m15.1"><semantics id="S4.SS3.p2.15.m15.1a"><msubsup id="S4.SS3.p2.15.m15.1.1" xref="S4.SS3.p2.15.m15.1.1.cmml"><mrow id="S4.SS3.p2.15.m15.1.1.1.1.1" xref="S4.SS3.p2.15.m15.1.1.1.1.2.cmml"><mo id="S4.SS3.p2.15.m15.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p2.15.m15.1.1.1.1.2.cmml">{</mo><msup id="S4.SS3.p2.15.m15.1.1.1.1.1.1" xref="S4.SS3.p2.15.m15.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p2.15.m15.1.1.1.1.1.1.2" xref="S4.SS3.p2.15.m15.1.1.1.1.1.1.2.cmml">h</mi><mi id="S4.SS3.p2.15.m15.1.1.1.1.1.1.3" xref="S4.SS3.p2.15.m15.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S4.SS3.p2.15.m15.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p2.15.m15.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.p2.15.m15.1.1.1.3" xref="S4.SS3.p2.15.m15.1.1.1.3.cmml"><mi id="S4.SS3.p2.15.m15.1.1.1.3.2" xref="S4.SS3.p2.15.m15.1.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p2.15.m15.1.1.1.3.1" xref="S4.SS3.p2.15.m15.1.1.1.3.1.cmml">=</mo><mn id="S4.SS3.p2.15.m15.1.1.1.3.3" xref="S4.SS3.p2.15.m15.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p2.15.m15.1.1.3" xref="S4.SS3.p2.15.m15.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.15.m15.1b"><apply id="S4.SS3.p2.15.m15.1.1.cmml" xref="S4.SS3.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.15.m15.1.1.2.cmml" xref="S4.SS3.p2.15.m15.1.1">superscript</csymbol><apply id="S4.SS3.p2.15.m15.1.1.1.cmml" xref="S4.SS3.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.15.m15.1.1.1.2.cmml" xref="S4.SS3.p2.15.m15.1.1">subscript</csymbol><set id="S4.SS3.p2.15.m15.1.1.1.1.2.cmml" xref="S4.SS3.p2.15.m15.1.1.1.1.1"><apply id="S4.SS3.p2.15.m15.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.15.m15.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.15.m15.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.15.m15.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS3.p2.15.m15.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.15.m15.1.1.1.1.1.1.2">ℎ</ci><ci id="S4.SS3.p2.15.m15.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p2.15.m15.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS3.p2.15.m15.1.1.1.3.cmml" xref="S4.SS3.p2.15.m15.1.1.1.3"><eq id="S4.SS3.p2.15.m15.1.1.1.3.1.cmml" xref="S4.SS3.p2.15.m15.1.1.1.3.1"></eq><ci id="S4.SS3.p2.15.m15.1.1.1.3.2.cmml" xref="S4.SS3.p2.15.m15.1.1.1.3.2">𝑖</ci><cn id="S4.SS3.p2.15.m15.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p2.15.m15.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.p2.15.m15.1.1.3.cmml" xref="S4.SS3.p2.15.m15.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.15.m15.1c">\{h^{i}\}_{i=1}^{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.15.m15.1d">{ italic_h start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> is a group of hash functions. With the hash encoder, DHE can eliminate the storage and optimization of <math alttext="\mathbf{I}_{M}" class="ltx_Math" display="inline" id="S4.SS3.p2.16.m16.1"><semantics id="S4.SS3.p2.16.m16.1a"><msub id="S4.SS3.p2.16.m16.1.1" xref="S4.SS3.p2.16.m16.1.1.cmml"><mi id="S4.SS3.p2.16.m16.1.1.2" xref="S4.SS3.p2.16.m16.1.1.2.cmml">𝐈</mi><mi id="S4.SS3.p2.16.m16.1.1.3" xref="S4.SS3.p2.16.m16.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.16.m16.1b"><apply id="S4.SS3.p2.16.m16.1.1.cmml" xref="S4.SS3.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.16.m16.1.1.1.cmml" xref="S4.SS3.p2.16.m16.1.1">subscript</csymbol><ci id="S4.SS3.p2.16.m16.1.1.2.cmml" xref="S4.SS3.p2.16.m16.1.1.2">𝐈</ci><ci id="S4.SS3.p2.16.m16.1.1.3.cmml" xref="S4.SS3.p2.16.m16.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.16.m16.1c">\mathbf{I}_{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.16.m16.1d">bold_I start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math>.
Moreover, considering that the index vectors are deterministic and cannot be optimized, DHE further decomposes the meta-table <math alttext="T" class="ltx_Math" display="inline" id="S4.SS3.p2.17.m17.1"><semantics id="S4.SS3.p2.17.m17.1a"><mi id="S4.SS3.p2.17.m17.1.1" xref="S4.SS3.p2.17.m17.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.17.m17.1b"><ci id="S4.SS3.p2.17.m17.1.1.cmml" xref="S4.SS3.p2.17.m17.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.17.m17.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.17.m17.1d">italic_T</annotation></semantics></math> into a multi-layer neural network to enhance its expressive ability.</p>
</div>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="81" id="S4.F6.g1" src="extracted/5774277/figs/ttd.png" width="382"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Example of TTD and STTD, where <math alttext="r_{3}=1" class="ltx_Math" display="inline" id="S4.F6.6.m1.1"><semantics id="S4.F6.6.m1.1b"><mrow id="S4.F6.6.m1.1.1" xref="S4.F6.6.m1.1.1.cmml"><msub id="S4.F6.6.m1.1.1.2" xref="S4.F6.6.m1.1.1.2.cmml"><mi id="S4.F6.6.m1.1.1.2.2" xref="S4.F6.6.m1.1.1.2.2.cmml">r</mi><mn id="S4.F6.6.m1.1.1.2.3" xref="S4.F6.6.m1.1.1.2.3.cmml">3</mn></msub><mo id="S4.F6.6.m1.1.1.1" xref="S4.F6.6.m1.1.1.1.cmml">=</mo><mn id="S4.F6.6.m1.1.1.3" xref="S4.F6.6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.6.m1.1c"><apply id="S4.F6.6.m1.1.1.cmml" xref="S4.F6.6.m1.1.1"><eq id="S4.F6.6.m1.1.1.1.cmml" xref="S4.F6.6.m1.1.1.1"></eq><apply id="S4.F6.6.m1.1.1.2.cmml" xref="S4.F6.6.m1.1.1.2"><csymbol cd="ambiguous" id="S4.F6.6.m1.1.1.2.1.cmml" xref="S4.F6.6.m1.1.1.2">subscript</csymbol><ci id="S4.F6.6.m1.1.1.2.2.cmml" xref="S4.F6.6.m1.1.1.2.2">𝑟</ci><cn id="S4.F6.6.m1.1.1.2.3.cmml" type="integer" xref="S4.F6.6.m1.1.1.2.3">3</cn></apply><cn id="S4.F6.6.m1.1.1.3.cmml" type="integer" xref="S4.F6.6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.6.m1.1d">r_{3}=1</annotation><annotation encoding="application/x-llamapun" id="S4.F6.6.m1.1e">italic_r start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT = 1</annotation></semantics></math>, <math alttext="r_{1}=r_{2}=k=2" class="ltx_Math" display="inline" id="S4.F6.7.m2.1"><semantics id="S4.F6.7.m2.1b"><mrow id="S4.F6.7.m2.1.1" xref="S4.F6.7.m2.1.1.cmml"><msub id="S4.F6.7.m2.1.1.2" xref="S4.F6.7.m2.1.1.2.cmml"><mi id="S4.F6.7.m2.1.1.2.2" xref="S4.F6.7.m2.1.1.2.2.cmml">r</mi><mn id="S4.F6.7.m2.1.1.2.3" xref="S4.F6.7.m2.1.1.2.3.cmml">1</mn></msub><mo id="S4.F6.7.m2.1.1.3" xref="S4.F6.7.m2.1.1.3.cmml">=</mo><msub id="S4.F6.7.m2.1.1.4" xref="S4.F6.7.m2.1.1.4.cmml"><mi id="S4.F6.7.m2.1.1.4.2" xref="S4.F6.7.m2.1.1.4.2.cmml">r</mi><mn id="S4.F6.7.m2.1.1.4.3" xref="S4.F6.7.m2.1.1.4.3.cmml">2</mn></msub><mo id="S4.F6.7.m2.1.1.5" xref="S4.F6.7.m2.1.1.5.cmml">=</mo><mi id="S4.F6.7.m2.1.1.6" xref="S4.F6.7.m2.1.1.6.cmml">k</mi><mo id="S4.F6.7.m2.1.1.7" xref="S4.F6.7.m2.1.1.7.cmml">=</mo><mn id="S4.F6.7.m2.1.1.8" xref="S4.F6.7.m2.1.1.8.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F6.7.m2.1c"><apply id="S4.F6.7.m2.1.1.cmml" xref="S4.F6.7.m2.1.1"><and id="S4.F6.7.m2.1.1a.cmml" xref="S4.F6.7.m2.1.1"></and><apply id="S4.F6.7.m2.1.1b.cmml" xref="S4.F6.7.m2.1.1"><eq id="S4.F6.7.m2.1.1.3.cmml" xref="S4.F6.7.m2.1.1.3"></eq><apply id="S4.F6.7.m2.1.1.2.cmml" xref="S4.F6.7.m2.1.1.2"><csymbol cd="ambiguous" id="S4.F6.7.m2.1.1.2.1.cmml" xref="S4.F6.7.m2.1.1.2">subscript</csymbol><ci id="S4.F6.7.m2.1.1.2.2.cmml" xref="S4.F6.7.m2.1.1.2.2">𝑟</ci><cn id="S4.F6.7.m2.1.1.2.3.cmml" type="integer" xref="S4.F6.7.m2.1.1.2.3">1</cn></apply><apply id="S4.F6.7.m2.1.1.4.cmml" xref="S4.F6.7.m2.1.1.4"><csymbol cd="ambiguous" id="S4.F6.7.m2.1.1.4.1.cmml" xref="S4.F6.7.m2.1.1.4">subscript</csymbol><ci id="S4.F6.7.m2.1.1.4.2.cmml" xref="S4.F6.7.m2.1.1.4.2">𝑟</ci><cn id="S4.F6.7.m2.1.1.4.3.cmml" type="integer" xref="S4.F6.7.m2.1.1.4.3">2</cn></apply></apply><apply id="S4.F6.7.m2.1.1c.cmml" xref="S4.F6.7.m2.1.1"><eq id="S4.F6.7.m2.1.1.5.cmml" xref="S4.F6.7.m2.1.1.5"></eq><share href="https://arxiv.org/html/2408.02304v1#S4.F6.7.m2.1.1.4.cmml" id="S4.F6.7.m2.1.1d.cmml" xref="S4.F6.7.m2.1.1"></share><ci id="S4.F6.7.m2.1.1.6.cmml" xref="S4.F6.7.m2.1.1.6">𝑘</ci></apply><apply id="S4.F6.7.m2.1.1e.cmml" xref="S4.F6.7.m2.1.1"><eq id="S4.F6.7.m2.1.1.7.cmml" xref="S4.F6.7.m2.1.1.7"></eq><share href="https://arxiv.org/html/2408.02304v1#S4.F6.7.m2.1.1.6.cmml" id="S4.F6.7.m2.1.1f.cmml" xref="S4.F6.7.m2.1.1"></share><cn id="S4.F6.7.m2.1.1.8.cmml" type="integer" xref="S4.F6.7.m2.1.1.8">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.7.m2.1d">r_{1}=r_{2}=k=2</annotation><annotation encoding="application/x-llamapun" id="S4.F6.7.m2.1e">italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_k = 2</annotation></semantics></math>, <math alttext="r_{0}" class="ltx_Math" display="inline" id="S4.F6.8.m3.1"><semantics id="S4.F6.8.m3.1b"><msub id="S4.F6.8.m3.1.1" xref="S4.F6.8.m3.1.1.cmml"><mi id="S4.F6.8.m3.1.1.2" xref="S4.F6.8.m3.1.1.2.cmml">r</mi><mn id="S4.F6.8.m3.1.1.3" xref="S4.F6.8.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F6.8.m3.1c"><apply id="S4.F6.8.m3.1.1.cmml" xref="S4.F6.8.m3.1.1"><csymbol cd="ambiguous" id="S4.F6.8.m3.1.1.1.cmml" xref="S4.F6.8.m3.1.1">subscript</csymbol><ci id="S4.F6.8.m3.1.1.2.cmml" xref="S4.F6.8.m3.1.1.2">𝑟</ci><cn id="S4.F6.8.m3.1.1.3.cmml" type="integer" xref="S4.F6.8.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.8.m3.1d">r_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.F6.8.m3.1e">italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is <math alttext="1" class="ltx_Math" display="inline" id="S4.F6.9.m4.1"><semantics id="S4.F6.9.m4.1b"><mn id="S4.F6.9.m4.1.1" xref="S4.F6.9.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.F6.9.m4.1c"><cn id="S4.F6.9.m4.1.1.cmml" type="integer" xref="S4.F6.9.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.9.m4.1d">1</annotation><annotation encoding="application/x-llamapun" id="S4.F6.9.m4.1e">1</annotation></semantics></math> in TTD and is <math alttext="2" class="ltx_Math" display="inline" id="S4.F6.10.m5.1"><semantics id="S4.F6.10.m5.1b"><mn id="S4.F6.10.m5.1.1" xref="S4.F6.10.m5.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.F6.10.m5.1c"><cn id="S4.F6.10.m5.1.1.cmml" type="integer" xref="S4.F6.10.m5.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.10.m5.1d">2</annotation><annotation encoding="application/x-llamapun" id="S4.F6.10.m5.1e">2</annotation></semantics></math> in STTD.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.27">Different from the above naive decomposition, <cite class="ltx_cite ltx_citemacro_citep">(Yin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib72" title="">2021</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib57" title="">2020</a>; Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib65" title="">2022</a>)</cite> use tensor train decomposition (TTD) to decompose the embedding tables.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S4.F6" title="Figure 6 ‣ 4.3. Decomposition ‣ 4. Weight-Sharing ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">6</span></a>, the embedding table <math alttext="\mathbf{E}\in\operatorname*{\mathbb{R}}^{n\times d}" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><mrow id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2.cmml">𝐄</mi><mo id="S4.SS3.p3.1.m1.1.1.1" rspace="0.1389em" xref="S4.SS3.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml"><mo id="S4.SS3.p3.1.m1.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p3.1.m1.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p3.1.m1.1.1.3.3" xref="S4.SS3.p3.1.m1.1.1.3.3.cmml"><mi id="S4.SS3.p3.1.m1.1.1.3.3.2" xref="S4.SS3.p3.1.m1.1.1.3.3.2.cmml">n</mi><mo id="S4.SS3.p3.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p3.1.m1.1.1.3.3.3" xref="S4.SS3.p3.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><in id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1"></in><ci id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2">𝐄</ci><apply id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.3.1.cmml" xref="S4.SS3.p3.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.3.2.cmml" xref="S4.SS3.p3.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.1.m1.1.1.3.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3.3"><times id="S4.SS3.p3.1.m1.1.1.3.3.1.cmml" xref="S4.SS3.p3.1.m1.1.1.3.3.1"></times><ci id="S4.SS3.p3.1.m1.1.1.3.3.2.cmml" xref="S4.SS3.p3.1.m1.1.1.3.3.2">𝑛</ci><ci id="S4.SS3.p3.1.m1.1.1.3.3.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\mathbf{E}\in\operatorname*{\mathbb{R}}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">bold_E ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> will first be reshaped into
<math alttext="\mathcal{E}\in\operatorname*{\mathbb{R}}^{(n_{1}d_{1})\times(n_{2}d_{2})\times%
...\times(n_{s}d_{s})}" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.3"><semantics id="S4.SS3.p3.2.m2.3a"><mrow id="S4.SS3.p3.2.m2.3.4" xref="S4.SS3.p3.2.m2.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.2.m2.3.4.2" xref="S4.SS3.p3.2.m2.3.4.2.cmml">ℰ</mi><mo id="S4.SS3.p3.2.m2.3.4.1" rspace="0.1389em" xref="S4.SS3.p3.2.m2.3.4.1.cmml">∈</mo><msup id="S4.SS3.p3.2.m2.3.4.3" xref="S4.SS3.p3.2.m2.3.4.3.cmml"><mo id="S4.SS3.p3.2.m2.3.4.3.2" lspace="0.1389em" xref="S4.SS3.p3.2.m2.3.4.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p3.2.m2.3.3.3" xref="S4.SS3.p3.2.m2.3.3.3.cmml"><mrow id="S4.SS3.p3.2.m2.1.1.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.cmml"><mo id="S4.SS3.p3.2.m2.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p3.2.m2.1.1.1.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.cmml"><msub id="S4.SS3.p3.2.m2.1.1.1.1.1.1.2" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p3.2.m2.1.1.1.1.1.1.2.2" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.2.2.cmml">n</mi><mn id="S4.SS3.p3.2.m2.1.1.1.1.1.1.2.3" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS3.p3.2.m2.1.1.1.1.1.1.1" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p3.2.m2.1.1.1.1.1.1.3" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.1.1.1.1.3.2" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.3.2.cmml">d</mi><mn id="S4.SS3.p3.2.m2.1.1.1.1.1.1.3.3" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S4.SS3.p3.2.m2.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS3.p3.2.m2.3.3.3.4" rspace="0.222em" xref="S4.SS3.p3.2.m2.3.3.3.4.cmml">×</mo><mrow id="S4.SS3.p3.2.m2.2.2.2.2.1" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.cmml"><mo id="S4.SS3.p3.2.m2.2.2.2.2.1.2" stretchy="false" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.SS3.p3.2.m2.2.2.2.2.1.1" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.cmml"><msub id="S4.SS3.p3.2.m2.2.2.2.2.1.1.2" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.2.cmml"><mi id="S4.SS3.p3.2.m2.2.2.2.2.1.1.2.2" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.2.2.cmml">n</mi><mn id="S4.SS3.p3.2.m2.2.2.2.2.1.1.2.3" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.2.3.cmml">2</mn></msub><mo id="S4.SS3.p3.2.m2.2.2.2.2.1.1.1" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p3.2.m2.2.2.2.2.1.1.3" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.3.cmml"><mi id="S4.SS3.p3.2.m2.2.2.2.2.1.1.3.2" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.3.2.cmml">d</mi><mn id="S4.SS3.p3.2.m2.2.2.2.2.1.1.3.3" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S4.SS3.p3.2.m2.2.2.2.2.1.3" rspace="0.055em" stretchy="false" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.cmml">)</mo></mrow><mo id="S4.SS3.p3.2.m2.3.3.3.4a" rspace="0.222em" xref="S4.SS3.p3.2.m2.3.3.3.4.cmml">×</mo><mi id="S4.SS3.p3.2.m2.3.3.3.5" mathvariant="normal" xref="S4.SS3.p3.2.m2.3.3.3.5.cmml">…</mi><mo id="S4.SS3.p3.2.m2.3.3.3.4b" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.2.m2.3.3.3.4.cmml">×</mo><mrow id="S4.SS3.p3.2.m2.3.3.3.3.1" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.cmml"><mo id="S4.SS3.p3.2.m2.3.3.3.3.1.2" stretchy="false" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.cmml">(</mo><mrow id="S4.SS3.p3.2.m2.3.3.3.3.1.1" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.cmml"><msub id="S4.SS3.p3.2.m2.3.3.3.3.1.1.2" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.2.cmml"><mi id="S4.SS3.p3.2.m2.3.3.3.3.1.1.2.2" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.2.2.cmml">n</mi><mi id="S4.SS3.p3.2.m2.3.3.3.3.1.1.2.3" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.2.3.cmml">s</mi></msub><mo id="S4.SS3.p3.2.m2.3.3.3.3.1.1.1" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p3.2.m2.3.3.3.3.1.1.3" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.3.cmml"><mi id="S4.SS3.p3.2.m2.3.3.3.3.1.1.3.2" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.3.2.cmml">d</mi><mi id="S4.SS3.p3.2.m2.3.3.3.3.1.1.3.3" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S4.SS3.p3.2.m2.3.3.3.3.1.3" stretchy="false" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.3b"><apply id="S4.SS3.p3.2.m2.3.4.cmml" xref="S4.SS3.p3.2.m2.3.4"><in id="S4.SS3.p3.2.m2.3.4.1.cmml" xref="S4.SS3.p3.2.m2.3.4.1"></in><ci id="S4.SS3.p3.2.m2.3.4.2.cmml" xref="S4.SS3.p3.2.m2.3.4.2">ℰ</ci><apply id="S4.SS3.p3.2.m2.3.4.3.cmml" xref="S4.SS3.p3.2.m2.3.4.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.3.4.3.1.cmml" xref="S4.SS3.p3.2.m2.3.4.3">superscript</csymbol><ci id="S4.SS3.p3.2.m2.3.4.3.2.cmml" xref="S4.SS3.p3.2.m2.3.4.3.2">ℝ</ci><apply id="S4.SS3.p3.2.m2.3.3.3.cmml" xref="S4.SS3.p3.2.m2.3.3.3"><times id="S4.SS3.p3.2.m2.3.3.3.4.cmml" xref="S4.SS3.p3.2.m2.3.3.3.4"></times><apply id="S4.SS3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1"><times id="S4.SS3.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.1"></times><apply id="S4.SS3.p3.2.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.2.2">𝑛</ci><cn id="S4.SS3.p3.2.m2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S4.SS3.p3.2.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.3.2">𝑑</ci><cn id="S4.SS3.p3.2.m2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.2.m2.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS3.p3.2.m2.2.2.2.2.1.1.cmml" xref="S4.SS3.p3.2.m2.2.2.2.2.1"><times id="S4.SS3.p3.2.m2.2.2.2.2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.1"></times><apply id="S4.SS3.p3.2.m2.2.2.2.2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.2.2.2.2.1.1.2.1.cmml" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.2.m2.2.2.2.2.1.1.2.2.cmml" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.2.2">𝑛</ci><cn id="S4.SS3.p3.2.m2.2.2.2.2.1.1.2.3.cmml" type="integer" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.2.3">2</cn></apply><apply id="S4.SS3.p3.2.m2.2.2.2.2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.2.2.2.2.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.2.m2.2.2.2.2.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.3.2">𝑑</ci><cn id="S4.SS3.p3.2.m2.2.2.2.2.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.2.m2.2.2.2.2.1.1.3.3">2</cn></apply></apply><ci id="S4.SS3.p3.2.m2.3.3.3.5.cmml" xref="S4.SS3.p3.2.m2.3.3.3.5">…</ci><apply id="S4.SS3.p3.2.m2.3.3.3.3.1.1.cmml" xref="S4.SS3.p3.2.m2.3.3.3.3.1"><times id="S4.SS3.p3.2.m2.3.3.3.3.1.1.1.cmml" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.1"></times><apply id="S4.SS3.p3.2.m2.3.3.3.3.1.1.2.cmml" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.3.3.3.3.1.1.2.1.cmml" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.2.m2.3.3.3.3.1.1.2.2.cmml" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.2.2">𝑛</ci><ci id="S4.SS3.p3.2.m2.3.3.3.3.1.1.2.3.cmml" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.2.3">𝑠</ci></apply><apply id="S4.SS3.p3.2.m2.3.3.3.3.1.1.3.cmml" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.3.3.3.3.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.2.m2.3.3.3.3.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.3.2">𝑑</ci><ci id="S4.SS3.p3.2.m2.3.3.3.3.1.1.3.3.cmml" xref="S4.SS3.p3.2.m2.3.3.3.3.1.1.3.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.3c">\mathcal{E}\in\operatorname*{\mathbb{R}}^{(n_{1}d_{1})\times(n_{2}d_{2})\times%
...\times(n_{s}d_{s})}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.3d">caligraphic_E ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_n start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) × ( italic_n start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) × … × ( italic_n start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="n=\prod_{i=1}^{s}n_{i}" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.1"><semantics id="S4.SS3.p3.3.m3.1a"><mrow id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml"><mi id="S4.SS3.p3.3.m3.1.1.2" xref="S4.SS3.p3.3.m3.1.1.2.cmml">n</mi><mo id="S4.SS3.p3.3.m3.1.1.1" rspace="0.111em" xref="S4.SS3.p3.3.m3.1.1.1.cmml">=</mo><mrow id="S4.SS3.p3.3.m3.1.1.3" xref="S4.SS3.p3.3.m3.1.1.3.cmml"><msubsup id="S4.SS3.p3.3.m3.1.1.3.1" xref="S4.SS3.p3.3.m3.1.1.3.1.cmml"><mo id="S4.SS3.p3.3.m3.1.1.3.1.2.2" xref="S4.SS3.p3.3.m3.1.1.3.1.2.2.cmml">∏</mo><mrow id="S4.SS3.p3.3.m3.1.1.3.1.2.3" xref="S4.SS3.p3.3.m3.1.1.3.1.2.3.cmml"><mi id="S4.SS3.p3.3.m3.1.1.3.1.2.3.2" xref="S4.SS3.p3.3.m3.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.3.m3.1.1.3.1.2.3.1" xref="S4.SS3.p3.3.m3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.SS3.p3.3.m3.1.1.3.1.2.3.3" xref="S4.SS3.p3.3.m3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p3.3.m3.1.1.3.1.3" xref="S4.SS3.p3.3.m3.1.1.3.1.3.cmml">s</mi></msubsup><msub id="S4.SS3.p3.3.m3.1.1.3.2" xref="S4.SS3.p3.3.m3.1.1.3.2.cmml"><mi id="S4.SS3.p3.3.m3.1.1.3.2.2" xref="S4.SS3.p3.3.m3.1.1.3.2.2.cmml">n</mi><mi id="S4.SS3.p3.3.m3.1.1.3.2.3" xref="S4.SS3.p3.3.m3.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.1b"><apply id="S4.SS3.p3.3.m3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1"><eq id="S4.SS3.p3.3.m3.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1"></eq><ci id="S4.SS3.p3.3.m3.1.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.2">𝑛</ci><apply id="S4.SS3.p3.3.m3.1.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3"><apply id="S4.SS3.p3.3.m3.1.1.3.1.cmml" xref="S4.SS3.p3.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.3.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.3.1">superscript</csymbol><apply id="S4.SS3.p3.3.m3.1.1.3.1.2.cmml" xref="S4.SS3.p3.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.3.1.2.1.cmml" xref="S4.SS3.p3.3.m3.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="S4.SS3.p3.3.m3.1.1.3.1.2.2.cmml" xref="S4.SS3.p3.3.m3.1.1.3.1.2.2">product</csymbol><apply id="S4.SS3.p3.3.m3.1.1.3.1.2.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3.1.2.3"><eq id="S4.SS3.p3.3.m3.1.1.3.1.2.3.1.cmml" xref="S4.SS3.p3.3.m3.1.1.3.1.2.3.1"></eq><ci id="S4.SS3.p3.3.m3.1.1.3.1.2.3.2.cmml" xref="S4.SS3.p3.3.m3.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.SS3.p3.3.m3.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.SS3.p3.3.m3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.SS3.p3.3.m3.1.1.3.1.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3.1.3">𝑠</ci></apply><apply id="S4.SS3.p3.3.m3.1.1.3.2.cmml" xref="S4.SS3.p3.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.1.1.3.2.1.cmml" xref="S4.SS3.p3.3.m3.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p3.3.m3.1.1.3.2.2.cmml" xref="S4.SS3.p3.3.m3.1.1.3.2.2">𝑛</ci><ci id="S4.SS3.p3.3.m3.1.1.3.2.3.cmml" xref="S4.SS3.p3.3.m3.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.1c">n=\prod_{i=1}^{s}n_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.1d">italic_n = ∏ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="d=\prod_{i=1}^{s}d_{i}" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m4.1"><semantics id="S4.SS3.p3.4.m4.1a"><mrow id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml"><mi id="S4.SS3.p3.4.m4.1.1.2" xref="S4.SS3.p3.4.m4.1.1.2.cmml">d</mi><mo id="S4.SS3.p3.4.m4.1.1.1" rspace="0.111em" xref="S4.SS3.p3.4.m4.1.1.1.cmml">=</mo><mrow id="S4.SS3.p3.4.m4.1.1.3" xref="S4.SS3.p3.4.m4.1.1.3.cmml"><msubsup id="S4.SS3.p3.4.m4.1.1.3.1" xref="S4.SS3.p3.4.m4.1.1.3.1.cmml"><mo id="S4.SS3.p3.4.m4.1.1.3.1.2.2" xref="S4.SS3.p3.4.m4.1.1.3.1.2.2.cmml">∏</mo><mrow id="S4.SS3.p3.4.m4.1.1.3.1.2.3" xref="S4.SS3.p3.4.m4.1.1.3.1.2.3.cmml"><mi id="S4.SS3.p3.4.m4.1.1.3.1.2.3.2" xref="S4.SS3.p3.4.m4.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.4.m4.1.1.3.1.2.3.1" xref="S4.SS3.p3.4.m4.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.SS3.p3.4.m4.1.1.3.1.2.3.3" xref="S4.SS3.p3.4.m4.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p3.4.m4.1.1.3.1.3" xref="S4.SS3.p3.4.m4.1.1.3.1.3.cmml">s</mi></msubsup><msub id="S4.SS3.p3.4.m4.1.1.3.2" xref="S4.SS3.p3.4.m4.1.1.3.2.cmml"><mi id="S4.SS3.p3.4.m4.1.1.3.2.2" xref="S4.SS3.p3.4.m4.1.1.3.2.2.cmml">d</mi><mi id="S4.SS3.p3.4.m4.1.1.3.2.3" xref="S4.SS3.p3.4.m4.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><apply id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1"><eq id="S4.SS3.p3.4.m4.1.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1.1"></eq><ci id="S4.SS3.p3.4.m4.1.1.2.cmml" xref="S4.SS3.p3.4.m4.1.1.2">𝑑</ci><apply id="S4.SS3.p3.4.m4.1.1.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3"><apply id="S4.SS3.p3.4.m4.1.1.3.1.cmml" xref="S4.SS3.p3.4.m4.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.1.1.3.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1.3.1">superscript</csymbol><apply id="S4.SS3.p3.4.m4.1.1.3.1.2.cmml" xref="S4.SS3.p3.4.m4.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.1.1.3.1.2.1.cmml" xref="S4.SS3.p3.4.m4.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="S4.SS3.p3.4.m4.1.1.3.1.2.2.cmml" xref="S4.SS3.p3.4.m4.1.1.3.1.2.2">product</csymbol><apply id="S4.SS3.p3.4.m4.1.1.3.1.2.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3.1.2.3"><eq id="S4.SS3.p3.4.m4.1.1.3.1.2.3.1.cmml" xref="S4.SS3.p3.4.m4.1.1.3.1.2.3.1"></eq><ci id="S4.SS3.p3.4.m4.1.1.3.1.2.3.2.cmml" xref="S4.SS3.p3.4.m4.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.SS3.p3.4.m4.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.SS3.p3.4.m4.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.SS3.p3.4.m4.1.1.3.1.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3.1.3">𝑠</ci></apply><apply id="S4.SS3.p3.4.m4.1.1.3.2.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m4.1.1.3.2.1.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p3.4.m4.1.1.3.2.2.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2.2">𝑑</ci><ci id="S4.SS3.p3.4.m4.1.1.3.2.3.cmml" xref="S4.SS3.p3.4.m4.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">d=\prod_{i=1}^{s}d_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m4.1d">italic_d = ∏ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
Then, <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S4.SS3.p3.5.m5.1"><semantics id="S4.SS3.p3.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><ci id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.5.m5.1d">caligraphic_E</annotation></semantics></math> will be decomposed as <math alttext="\mathcal{E}=\mathcal{G}_{1}\times\mathcal{G}_{2}\times...\times\mathcal{G}_{s}" class="ltx_Math" display="inline" id="S4.SS3.p3.6.m6.1"><semantics id="S4.SS3.p3.6.m6.1a"><mrow id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.6.m6.1.1.2" xref="S4.SS3.p3.6.m6.1.1.2.cmml">ℰ</mi><mo id="S4.SS3.p3.6.m6.1.1.1" xref="S4.SS3.p3.6.m6.1.1.1.cmml">=</mo><mrow id="S4.SS3.p3.6.m6.1.1.3" xref="S4.SS3.p3.6.m6.1.1.3.cmml"><msub id="S4.SS3.p3.6.m6.1.1.3.2" xref="S4.SS3.p3.6.m6.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.6.m6.1.1.3.2.2" xref="S4.SS3.p3.6.m6.1.1.3.2.2.cmml">𝒢</mi><mn id="S4.SS3.p3.6.m6.1.1.3.2.3" xref="S4.SS3.p3.6.m6.1.1.3.2.3.cmml">1</mn></msub><mo id="S4.SS3.p3.6.m6.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.6.m6.1.1.3.1.cmml">×</mo><msub id="S4.SS3.p3.6.m6.1.1.3.3" xref="S4.SS3.p3.6.m6.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.6.m6.1.1.3.3.2" xref="S4.SS3.p3.6.m6.1.1.3.3.2.cmml">𝒢</mi><mn id="S4.SS3.p3.6.m6.1.1.3.3.3" xref="S4.SS3.p3.6.m6.1.1.3.3.3.cmml">2</mn></msub><mo id="S4.SS3.p3.6.m6.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.6.m6.1.1.3.1.cmml">×</mo><mi id="S4.SS3.p3.6.m6.1.1.3.4" mathvariant="normal" xref="S4.SS3.p3.6.m6.1.1.3.4.cmml">…</mi><mo id="S4.SS3.p3.6.m6.1.1.3.1b" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.6.m6.1.1.3.1.cmml">×</mo><msub id="S4.SS3.p3.6.m6.1.1.3.5" xref="S4.SS3.p3.6.m6.1.1.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.6.m6.1.1.3.5.2" xref="S4.SS3.p3.6.m6.1.1.3.5.2.cmml">𝒢</mi><mi id="S4.SS3.p3.6.m6.1.1.3.5.3" xref="S4.SS3.p3.6.m6.1.1.3.5.3.cmml">s</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b"><apply id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1"><eq id="S4.SS3.p3.6.m6.1.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1.1"></eq><ci id="S4.SS3.p3.6.m6.1.1.2.cmml" xref="S4.SS3.p3.6.m6.1.1.2">ℰ</ci><apply id="S4.SS3.p3.6.m6.1.1.3.cmml" xref="S4.SS3.p3.6.m6.1.1.3"><times id="S4.SS3.p3.6.m6.1.1.3.1.cmml" xref="S4.SS3.p3.6.m6.1.1.3.1"></times><apply id="S4.SS3.p3.6.m6.1.1.3.2.cmml" xref="S4.SS3.p3.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.3.2.1.cmml" xref="S4.SS3.p3.6.m6.1.1.3.2">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.1.3.2.2.cmml" xref="S4.SS3.p3.6.m6.1.1.3.2.2">𝒢</ci><cn id="S4.SS3.p3.6.m6.1.1.3.2.3.cmml" type="integer" xref="S4.SS3.p3.6.m6.1.1.3.2.3">1</cn></apply><apply id="S4.SS3.p3.6.m6.1.1.3.3.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.3.3.1.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.1.3.3.2.cmml" xref="S4.SS3.p3.6.m6.1.1.3.3.2">𝒢</ci><cn id="S4.SS3.p3.6.m6.1.1.3.3.3.cmml" type="integer" xref="S4.SS3.p3.6.m6.1.1.3.3.3">2</cn></apply><ci id="S4.SS3.p3.6.m6.1.1.3.4.cmml" xref="S4.SS3.p3.6.m6.1.1.3.4">…</ci><apply id="S4.SS3.p3.6.m6.1.1.3.5.cmml" xref="S4.SS3.p3.6.m6.1.1.3.5"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m6.1.1.3.5.1.cmml" xref="S4.SS3.p3.6.m6.1.1.3.5">subscript</csymbol><ci id="S4.SS3.p3.6.m6.1.1.3.5.2.cmml" xref="S4.SS3.p3.6.m6.1.1.3.5.2">𝒢</ci><ci id="S4.SS3.p3.6.m6.1.1.3.5.3.cmml" xref="S4.SS3.p3.6.m6.1.1.3.5.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.1c">\mathcal{E}=\mathcal{G}_{1}\times\mathcal{G}_{2}\times...\times\mathcal{G}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.6.m6.1d">caligraphic_E = caligraphic_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT × caligraphic_G start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT × … × caligraphic_G start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>,
where <math alttext="\mathcal{G}_{i}\in\operatorname*{\mathbb{R}}^{r_{i-1}\times n_{i}d_{i}\times r%
_{i}}" class="ltx_Math" display="inline" id="S4.SS3.p3.7.m7.1"><semantics id="S4.SS3.p3.7.m7.1a"><mrow id="S4.SS3.p3.7.m7.1.1" xref="S4.SS3.p3.7.m7.1.1.cmml"><msub id="S4.SS3.p3.7.m7.1.1.2" xref="S4.SS3.p3.7.m7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.7.m7.1.1.2.2" xref="S4.SS3.p3.7.m7.1.1.2.2.cmml">𝒢</mi><mi id="S4.SS3.p3.7.m7.1.1.2.3" xref="S4.SS3.p3.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS3.p3.7.m7.1.1.1" rspace="0.1389em" xref="S4.SS3.p3.7.m7.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.7.m7.1.1.3" xref="S4.SS3.p3.7.m7.1.1.3.cmml"><mo id="S4.SS3.p3.7.m7.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p3.7.m7.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p3.7.m7.1.1.3.3" xref="S4.SS3.p3.7.m7.1.1.3.3.cmml"><mrow id="S4.SS3.p3.7.m7.1.1.3.3.2" xref="S4.SS3.p3.7.m7.1.1.3.3.2.cmml"><mrow id="S4.SS3.p3.7.m7.1.1.3.3.2.2" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.cmml"><msub id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.cmml"><mi id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.2" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.2.cmml">r</mi><mrow id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.cmml"><mi id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.2" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.1" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.1.cmml">−</mo><mn id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.3" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS3.p3.7.m7.1.1.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.1.cmml">×</mo><msub id="S4.SS3.p3.7.m7.1.1.3.3.2.2.3" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.3.cmml"><mi id="S4.SS3.p3.7.m7.1.1.3.3.2.2.3.2" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.3.2.cmml">n</mi><mi id="S4.SS3.p3.7.m7.1.1.3.3.2.2.3.3" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.3.3.cmml">i</mi></msub></mrow><mo id="S4.SS3.p3.7.m7.1.1.3.3.2.1" xref="S4.SS3.p3.7.m7.1.1.3.3.2.1.cmml">⁢</mo><msub id="S4.SS3.p3.7.m7.1.1.3.3.2.3" xref="S4.SS3.p3.7.m7.1.1.3.3.2.3.cmml"><mi id="S4.SS3.p3.7.m7.1.1.3.3.2.3.2" xref="S4.SS3.p3.7.m7.1.1.3.3.2.3.2.cmml">d</mi><mi id="S4.SS3.p3.7.m7.1.1.3.3.2.3.3" xref="S4.SS3.p3.7.m7.1.1.3.3.2.3.3.cmml">i</mi></msub></mrow><mo id="S4.SS3.p3.7.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.7.m7.1.1.3.3.1.cmml">×</mo><msub id="S4.SS3.p3.7.m7.1.1.3.3.3" xref="S4.SS3.p3.7.m7.1.1.3.3.3.cmml"><mi id="S4.SS3.p3.7.m7.1.1.3.3.3.2" xref="S4.SS3.p3.7.m7.1.1.3.3.3.2.cmml">r</mi><mi id="S4.SS3.p3.7.m7.1.1.3.3.3.3" xref="S4.SS3.p3.7.m7.1.1.3.3.3.3.cmml">i</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m7.1b"><apply id="S4.SS3.p3.7.m7.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1"><in id="S4.SS3.p3.7.m7.1.1.1.cmml" xref="S4.SS3.p3.7.m7.1.1.1"></in><apply id="S4.SS3.p3.7.m7.1.1.2.cmml" xref="S4.SS3.p3.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m7.1.1.2.1.cmml" xref="S4.SS3.p3.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.7.m7.1.1.2.2.cmml" xref="S4.SS3.p3.7.m7.1.1.2.2">𝒢</ci><ci id="S4.SS3.p3.7.m7.1.1.2.3.cmml" xref="S4.SS3.p3.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.p3.7.m7.1.1.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m7.1.1.3.1.cmml" xref="S4.SS3.p3.7.m7.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.7.m7.1.1.3.2.cmml" xref="S4.SS3.p3.7.m7.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.7.m7.1.1.3.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3"><times id="S4.SS3.p3.7.m7.1.1.3.3.1.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.1"></times><apply id="S4.SS3.p3.7.m7.1.1.3.3.2.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2"><times id="S4.SS3.p3.7.m7.1.1.3.3.2.1.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.1"></times><apply id="S4.SS3.p3.7.m7.1.1.3.3.2.2.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2"><times id="S4.SS3.p3.7.m7.1.1.3.3.2.2.1.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.1"></times><apply id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.1.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.2.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.2">𝑟</ci><apply id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3"><minus id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.1.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.1"></minus><ci id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.2.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.2">𝑖</ci><cn id="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.3.cmml" type="integer" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.2.3.3">1</cn></apply></apply><apply id="S4.SS3.p3.7.m7.1.1.3.3.2.2.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m7.1.1.3.3.2.2.3.1.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.3">subscript</csymbol><ci id="S4.SS3.p3.7.m7.1.1.3.3.2.2.3.2.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.3.2">𝑛</ci><ci id="S4.SS3.p3.7.m7.1.1.3.3.2.2.3.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.2.3.3">𝑖</ci></apply></apply><apply id="S4.SS3.p3.7.m7.1.1.3.3.2.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m7.1.1.3.3.2.3.1.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.3">subscript</csymbol><ci id="S4.SS3.p3.7.m7.1.1.3.3.2.3.2.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.3.2">𝑑</ci><ci id="S4.SS3.p3.7.m7.1.1.3.3.2.3.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.2.3.3">𝑖</ci></apply></apply><apply id="S4.SS3.p3.7.m7.1.1.3.3.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m7.1.1.3.3.3.1.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.3">subscript</csymbol><ci id="S4.SS3.p3.7.m7.1.1.3.3.3.2.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.3.2">𝑟</ci><ci id="S4.SS3.p3.7.m7.1.1.3.3.3.3.cmml" xref="S4.SS3.p3.7.m7.1.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m7.1c">\mathcal{G}_{i}\in\operatorname*{\mathbb{R}}^{r_{i-1}\times n_{i}d_{i}\times r%
_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.7.m7.1d">caligraphic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT × italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. <math alttext="\{\mathcal{G}_{i}\}_{i=1}^{s}" class="ltx_Math" display="inline" id="S4.SS3.p3.8.m8.1"><semantics id="S4.SS3.p3.8.m8.1a"><msubsup id="S4.SS3.p3.8.m8.1.1" xref="S4.SS3.p3.8.m8.1.1.cmml"><mrow id="S4.SS3.p3.8.m8.1.1.1.1.1" xref="S4.SS3.p3.8.m8.1.1.1.1.2.cmml"><mo id="S4.SS3.p3.8.m8.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p3.8.m8.1.1.1.1.2.cmml">{</mo><msub id="S4.SS3.p3.8.m8.1.1.1.1.1.1" xref="S4.SS3.p3.8.m8.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.8.m8.1.1.1.1.1.1.2" xref="S4.SS3.p3.8.m8.1.1.1.1.1.1.2.cmml">𝒢</mi><mi id="S4.SS3.p3.8.m8.1.1.1.1.1.1.3" xref="S4.SS3.p3.8.m8.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS3.p3.8.m8.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p3.8.m8.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.p3.8.m8.1.1.1.3" xref="S4.SS3.p3.8.m8.1.1.1.3.cmml"><mi id="S4.SS3.p3.8.m8.1.1.1.3.2" xref="S4.SS3.p3.8.m8.1.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p3.8.m8.1.1.1.3.1" xref="S4.SS3.p3.8.m8.1.1.1.3.1.cmml">=</mo><mn id="S4.SS3.p3.8.m8.1.1.1.3.3" xref="S4.SS3.p3.8.m8.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p3.8.m8.1.1.3" xref="S4.SS3.p3.8.m8.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m8.1b"><apply id="S4.SS3.p3.8.m8.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m8.1.1.2.cmml" xref="S4.SS3.p3.8.m8.1.1">superscript</csymbol><apply id="S4.SS3.p3.8.m8.1.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m8.1.1.1.2.cmml" xref="S4.SS3.p3.8.m8.1.1">subscript</csymbol><set id="S4.SS3.p3.8.m8.1.1.1.1.2.cmml" xref="S4.SS3.p3.8.m8.1.1.1.1.1"><apply id="S4.SS3.p3.8.m8.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m8.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.8.m8.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.8.m8.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.8.m8.1.1.1.1.1.1.2">𝒢</ci><ci id="S4.SS3.p3.8.m8.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.8.m8.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS3.p3.8.m8.1.1.1.3.cmml" xref="S4.SS3.p3.8.m8.1.1.1.3"><eq id="S4.SS3.p3.8.m8.1.1.1.3.1.cmml" xref="S4.SS3.p3.8.m8.1.1.1.3.1"></eq><ci id="S4.SS3.p3.8.m8.1.1.1.3.2.cmml" xref="S4.SS3.p3.8.m8.1.1.1.3.2">𝑖</ci><cn id="S4.SS3.p3.8.m8.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.8.m8.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.p3.8.m8.1.1.3.cmml" xref="S4.SS3.p3.8.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m8.1c">\{\mathcal{G}_{i}\}_{i=1}^{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.8.m8.1d">{ caligraphic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> are called TT-cores and <math alttext="\{r_{i}\}_{i=0}^{s}" class="ltx_Math" display="inline" id="S4.SS3.p3.9.m9.1"><semantics id="S4.SS3.p3.9.m9.1a"><msubsup id="S4.SS3.p3.9.m9.1.1" xref="S4.SS3.p3.9.m9.1.1.cmml"><mrow id="S4.SS3.p3.9.m9.1.1.1.1.1" xref="S4.SS3.p3.9.m9.1.1.1.1.2.cmml"><mo id="S4.SS3.p3.9.m9.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p3.9.m9.1.1.1.1.2.cmml">{</mo><msub id="S4.SS3.p3.9.m9.1.1.1.1.1.1" xref="S4.SS3.p3.9.m9.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p3.9.m9.1.1.1.1.1.1.2" xref="S4.SS3.p3.9.m9.1.1.1.1.1.1.2.cmml">r</mi><mi id="S4.SS3.p3.9.m9.1.1.1.1.1.1.3" xref="S4.SS3.p3.9.m9.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS3.p3.9.m9.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p3.9.m9.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.p3.9.m9.1.1.1.3" xref="S4.SS3.p3.9.m9.1.1.1.3.cmml"><mi id="S4.SS3.p3.9.m9.1.1.1.3.2" xref="S4.SS3.p3.9.m9.1.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p3.9.m9.1.1.1.3.1" xref="S4.SS3.p3.9.m9.1.1.1.3.1.cmml">=</mo><mn id="S4.SS3.p3.9.m9.1.1.1.3.3" xref="S4.SS3.p3.9.m9.1.1.1.3.3.cmml">0</mn></mrow><mi id="S4.SS3.p3.9.m9.1.1.3" xref="S4.SS3.p3.9.m9.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m9.1b"><apply id="S4.SS3.p3.9.m9.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.1.1.2.cmml" xref="S4.SS3.p3.9.m9.1.1">superscript</csymbol><apply id="S4.SS3.p3.9.m9.1.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.1.1.1.2.cmml" xref="S4.SS3.p3.9.m9.1.1">subscript</csymbol><set id="S4.SS3.p3.9.m9.1.1.1.1.2.cmml" xref="S4.SS3.p3.9.m9.1.1.1.1.1"><apply id="S4.SS3.p3.9.m9.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.9.m9.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.9.m9.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.9.m9.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.9.m9.1.1.1.1.1.1.2">𝑟</ci><ci id="S4.SS3.p3.9.m9.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.9.m9.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS3.p3.9.m9.1.1.1.3.cmml" xref="S4.SS3.p3.9.m9.1.1.1.3"><eq id="S4.SS3.p3.9.m9.1.1.1.3.1.cmml" xref="S4.SS3.p3.9.m9.1.1.1.3.1"></eq><ci id="S4.SS3.p3.9.m9.1.1.1.3.2.cmml" xref="S4.SS3.p3.9.m9.1.1.1.3.2">𝑖</ci><cn id="S4.SS3.p3.9.m9.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.9.m9.1.1.1.3.3">0</cn></apply></apply><ci id="S4.SS3.p3.9.m9.1.1.3.cmml" xref="S4.SS3.p3.9.m9.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m9.1c">\{r_{i}\}_{i=0}^{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.9.m9.1d">{ italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math> are called TT-ranks, in particular <math alttext="r_{0}=r_{s}=1" class="ltx_Math" display="inline" id="S4.SS3.p3.10.m10.1"><semantics id="S4.SS3.p3.10.m10.1a"><mrow id="S4.SS3.p3.10.m10.1.1" xref="S4.SS3.p3.10.m10.1.1.cmml"><msub id="S4.SS3.p3.10.m10.1.1.2" xref="S4.SS3.p3.10.m10.1.1.2.cmml"><mi id="S4.SS3.p3.10.m10.1.1.2.2" xref="S4.SS3.p3.10.m10.1.1.2.2.cmml">r</mi><mn id="S4.SS3.p3.10.m10.1.1.2.3" xref="S4.SS3.p3.10.m10.1.1.2.3.cmml">0</mn></msub><mo id="S4.SS3.p3.10.m10.1.1.3" xref="S4.SS3.p3.10.m10.1.1.3.cmml">=</mo><msub id="S4.SS3.p3.10.m10.1.1.4" xref="S4.SS3.p3.10.m10.1.1.4.cmml"><mi id="S4.SS3.p3.10.m10.1.1.4.2" xref="S4.SS3.p3.10.m10.1.1.4.2.cmml">r</mi><mi id="S4.SS3.p3.10.m10.1.1.4.3" xref="S4.SS3.p3.10.m10.1.1.4.3.cmml">s</mi></msub><mo id="S4.SS3.p3.10.m10.1.1.5" xref="S4.SS3.p3.10.m10.1.1.5.cmml">=</mo><mn id="S4.SS3.p3.10.m10.1.1.6" xref="S4.SS3.p3.10.m10.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.10.m10.1b"><apply id="S4.SS3.p3.10.m10.1.1.cmml" xref="S4.SS3.p3.10.m10.1.1"><and id="S4.SS3.p3.10.m10.1.1a.cmml" xref="S4.SS3.p3.10.m10.1.1"></and><apply id="S4.SS3.p3.10.m10.1.1b.cmml" xref="S4.SS3.p3.10.m10.1.1"><eq id="S4.SS3.p3.10.m10.1.1.3.cmml" xref="S4.SS3.p3.10.m10.1.1.3"></eq><apply id="S4.SS3.p3.10.m10.1.1.2.cmml" xref="S4.SS3.p3.10.m10.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m10.1.1.2.1.cmml" xref="S4.SS3.p3.10.m10.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.10.m10.1.1.2.2.cmml" xref="S4.SS3.p3.10.m10.1.1.2.2">𝑟</ci><cn id="S4.SS3.p3.10.m10.1.1.2.3.cmml" type="integer" xref="S4.SS3.p3.10.m10.1.1.2.3">0</cn></apply><apply id="S4.SS3.p3.10.m10.1.1.4.cmml" xref="S4.SS3.p3.10.m10.1.1.4"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m10.1.1.4.1.cmml" xref="S4.SS3.p3.10.m10.1.1.4">subscript</csymbol><ci id="S4.SS3.p3.10.m10.1.1.4.2.cmml" xref="S4.SS3.p3.10.m10.1.1.4.2">𝑟</ci><ci id="S4.SS3.p3.10.m10.1.1.4.3.cmml" xref="S4.SS3.p3.10.m10.1.1.4.3">𝑠</ci></apply></apply><apply id="S4.SS3.p3.10.m10.1.1c.cmml" xref="S4.SS3.p3.10.m10.1.1"><eq id="S4.SS3.p3.10.m10.1.1.5.cmml" xref="S4.SS3.p3.10.m10.1.1.5"></eq><share href="https://arxiv.org/html/2408.02304v1#S4.SS3.p3.10.m10.1.1.4.cmml" id="S4.SS3.p3.10.m10.1.1d.cmml" xref="S4.SS3.p3.10.m10.1.1"></share><cn id="S4.SS3.p3.10.m10.1.1.6.cmml" type="integer" xref="S4.SS3.p3.10.m10.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.10.m10.1c">r_{0}=r_{s}=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.10.m10.1d">italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = 1</annotation></semantics></math>.
TT-Rec <cite class="ltx_cite ltx_citemacro_citep">(Yin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib72" title="">2021</a>)</cite> is the first to use TTD on the embedding tables of DLRMs. It implements optimized kernels of TTD for embedding tables.
LLRec <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib57" title="">2020</a>)</cite> uses TTD on the embedding tables while maintaining the prediction accuracy by knowledge distillation.
To enhance the compression capability of TTD, <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib65" title="">2022</a>)</cite> further develop semi-tensor product based tensor train decomposition (STTD).
Semi-tensor product is a generalization of matrix product. Specifically, given <math alttext="\bm{a}\in\operatorname*{\mathbb{R}}^{1\times np}" class="ltx_Math" display="inline" id="S4.SS3.p3.11.m11.1"><semantics id="S4.SS3.p3.11.m11.1a"><mrow id="S4.SS3.p3.11.m11.1.1" xref="S4.SS3.p3.11.m11.1.1.cmml"><mi id="S4.SS3.p3.11.m11.1.1.2" xref="S4.SS3.p3.11.m11.1.1.2.cmml">𝒂</mi><mo id="S4.SS3.p3.11.m11.1.1.1" rspace="0.1389em" xref="S4.SS3.p3.11.m11.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.11.m11.1.1.3" xref="S4.SS3.p3.11.m11.1.1.3.cmml"><mo id="S4.SS3.p3.11.m11.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p3.11.m11.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p3.11.m11.1.1.3.3" xref="S4.SS3.p3.11.m11.1.1.3.3.cmml"><mrow id="S4.SS3.p3.11.m11.1.1.3.3.2" xref="S4.SS3.p3.11.m11.1.1.3.3.2.cmml"><mn id="S4.SS3.p3.11.m11.1.1.3.3.2.2" xref="S4.SS3.p3.11.m11.1.1.3.3.2.2.cmml">1</mn><mo id="S4.SS3.p3.11.m11.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.11.m11.1.1.3.3.2.1.cmml">×</mo><mi id="S4.SS3.p3.11.m11.1.1.3.3.2.3" xref="S4.SS3.p3.11.m11.1.1.3.3.2.3.cmml">n</mi></mrow><mo id="S4.SS3.p3.11.m11.1.1.3.3.1" xref="S4.SS3.p3.11.m11.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.11.m11.1.1.3.3.3" xref="S4.SS3.p3.11.m11.1.1.3.3.3.cmml">p</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.11.m11.1b"><apply id="S4.SS3.p3.11.m11.1.1.cmml" xref="S4.SS3.p3.11.m11.1.1"><in id="S4.SS3.p3.11.m11.1.1.1.cmml" xref="S4.SS3.p3.11.m11.1.1.1"></in><ci id="S4.SS3.p3.11.m11.1.1.2.cmml" xref="S4.SS3.p3.11.m11.1.1.2">𝒂</ci><apply id="S4.SS3.p3.11.m11.1.1.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.11.m11.1.1.3.1.cmml" xref="S4.SS3.p3.11.m11.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.11.m11.1.1.3.2.cmml" xref="S4.SS3.p3.11.m11.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.11.m11.1.1.3.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3"><times id="S4.SS3.p3.11.m11.1.1.3.3.1.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.1"></times><apply id="S4.SS3.p3.11.m11.1.1.3.3.2.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.2"><times id="S4.SS3.p3.11.m11.1.1.3.3.2.1.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.2.1"></times><cn id="S4.SS3.p3.11.m11.1.1.3.3.2.2.cmml" type="integer" xref="S4.SS3.p3.11.m11.1.1.3.3.2.2">1</cn><ci id="S4.SS3.p3.11.m11.1.1.3.3.2.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.2.3">𝑛</ci></apply><ci id="S4.SS3.p3.11.m11.1.1.3.3.3.cmml" xref="S4.SS3.p3.11.m11.1.1.3.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.11.m11.1c">\bm{a}\in\operatorname*{\mathbb{R}}^{1\times np}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.11.m11.1d">bold_italic_a ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_n italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\bm{b}\in\operatorname*{\mathbb{R}}^{p}" class="ltx_Math" display="inline" id="S4.SS3.p3.12.m12.1"><semantics id="S4.SS3.p3.12.m12.1a"><mrow id="S4.SS3.p3.12.m12.1.1" xref="S4.SS3.p3.12.m12.1.1.cmml"><mi id="S4.SS3.p3.12.m12.1.1.2" xref="S4.SS3.p3.12.m12.1.1.2.cmml">𝒃</mi><mo id="S4.SS3.p3.12.m12.1.1.1" rspace="0.1389em" xref="S4.SS3.p3.12.m12.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.12.m12.1.1.3" xref="S4.SS3.p3.12.m12.1.1.3.cmml"><mo id="S4.SS3.p3.12.m12.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p3.12.m12.1.1.3.2.cmml">ℝ</mo><mi id="S4.SS3.p3.12.m12.1.1.3.3" xref="S4.SS3.p3.12.m12.1.1.3.3.cmml">p</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.12.m12.1b"><apply id="S4.SS3.p3.12.m12.1.1.cmml" xref="S4.SS3.p3.12.m12.1.1"><in id="S4.SS3.p3.12.m12.1.1.1.cmml" xref="S4.SS3.p3.12.m12.1.1.1"></in><ci id="S4.SS3.p3.12.m12.1.1.2.cmml" xref="S4.SS3.p3.12.m12.1.1.2">𝒃</ci><apply id="S4.SS3.p3.12.m12.1.1.3.cmml" xref="S4.SS3.p3.12.m12.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.12.m12.1.1.3.1.cmml" xref="S4.SS3.p3.12.m12.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.12.m12.1.1.3.2.cmml" xref="S4.SS3.p3.12.m12.1.1.3.2">ℝ</ci><ci id="S4.SS3.p3.12.m12.1.1.3.3.cmml" xref="S4.SS3.p3.12.m12.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.12.m12.1c">\bm{b}\in\operatorname*{\mathbb{R}}^{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.12.m12.1d">bold_italic_b ∈ blackboard_R start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\bm{a}" class="ltx_Math" display="inline" id="S4.SS3.p3.13.m13.1"><semantics id="S4.SS3.p3.13.m13.1a"><mi id="S4.SS3.p3.13.m13.1.1" xref="S4.SS3.p3.13.m13.1.1.cmml">𝒂</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.13.m13.1b"><ci id="S4.SS3.p3.13.m13.1.1.cmml" xref="S4.SS3.p3.13.m13.1.1">𝒂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.13.m13.1c">\bm{a}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.13.m13.1d">bold_italic_a</annotation></semantics></math> can be cut into <math alttext="p" class="ltx_Math" display="inline" id="S4.SS3.p3.14.m14.1"><semantics id="S4.SS3.p3.14.m14.1a"><mi id="S4.SS3.p3.14.m14.1.1" xref="S4.SS3.p3.14.m14.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.14.m14.1b"><ci id="S4.SS3.p3.14.m14.1.1.cmml" xref="S4.SS3.p3.14.m14.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.14.m14.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.14.m14.1d">italic_p</annotation></semantics></math> blocks <math alttext="\{\bm{a}^{i}\in\operatorname*{\mathbb{R}}^{1\times n}\}_{i=1}^{p}" class="ltx_Math" display="inline" id="S4.SS3.p3.15.m15.1"><semantics id="S4.SS3.p3.15.m15.1a"><msubsup id="S4.SS3.p3.15.m15.1.1" xref="S4.SS3.p3.15.m15.1.1.cmml"><mrow id="S4.SS3.p3.15.m15.1.1.1.1.1" xref="S4.SS3.p3.15.m15.1.1.1.1.2.cmml"><mo id="S4.SS3.p3.15.m15.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p3.15.m15.1.1.1.1.2.cmml">{</mo><mrow id="S4.SS3.p3.15.m15.1.1.1.1.1.1" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.cmml"><msup id="S4.SS3.p3.15.m15.1.1.1.1.1.1.2" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.2.cmml"><mi id="S4.SS3.p3.15.m15.1.1.1.1.1.1.2.2" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.2.2.cmml">𝒂</mi><mi id="S4.SS3.p3.15.m15.1.1.1.1.1.1.2.3" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.2.3.cmml">i</mi></msup><mo id="S4.SS3.p3.15.m15.1.1.1.1.1.1.1" rspace="0.1389em" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.cmml"><mo id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.2" lspace="0.1389em" rspace="0em" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.cmml"><mn id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.2" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.3" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><mo id="S4.SS3.p3.15.m15.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p3.15.m15.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.p3.15.m15.1.1.1.3" xref="S4.SS3.p3.15.m15.1.1.1.3.cmml"><mi id="S4.SS3.p3.15.m15.1.1.1.3.2" xref="S4.SS3.p3.15.m15.1.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p3.15.m15.1.1.1.3.1" xref="S4.SS3.p3.15.m15.1.1.1.3.1.cmml">=</mo><mn id="S4.SS3.p3.15.m15.1.1.1.3.3" xref="S4.SS3.p3.15.m15.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p3.15.m15.1.1.3" xref="S4.SS3.p3.15.m15.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.15.m15.1b"><apply id="S4.SS3.p3.15.m15.1.1.cmml" xref="S4.SS3.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.15.m15.1.1.2.cmml" xref="S4.SS3.p3.15.m15.1.1">superscript</csymbol><apply id="S4.SS3.p3.15.m15.1.1.1.cmml" xref="S4.SS3.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.15.m15.1.1.1.2.cmml" xref="S4.SS3.p3.15.m15.1.1">subscript</csymbol><set id="S4.SS3.p3.15.m15.1.1.1.1.2.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1"><apply id="S4.SS3.p3.15.m15.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1"><in id="S4.SS3.p3.15.m15.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.1"></in><apply id="S4.SS3.p3.15.m15.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.15.m15.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.SS3.p3.15.m15.1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.2.2">𝒂</ci><ci id="S4.SS3.p3.15.m15.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3"><times id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.1"></times><cn id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.2.cmml" type="integer" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.2">1</cn><ci id="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS3.p3.15.m15.1.1.1.1.1.1.3.3.3">𝑛</ci></apply></apply></apply></set><apply id="S4.SS3.p3.15.m15.1.1.1.3.cmml" xref="S4.SS3.p3.15.m15.1.1.1.3"><eq id="S4.SS3.p3.15.m15.1.1.1.3.1.cmml" xref="S4.SS3.p3.15.m15.1.1.1.3.1"></eq><ci id="S4.SS3.p3.15.m15.1.1.1.3.2.cmml" xref="S4.SS3.p3.15.m15.1.1.1.3.2">𝑖</ci><cn id="S4.SS3.p3.15.m15.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.15.m15.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.p3.15.m15.1.1.3.cmml" xref="S4.SS3.p3.15.m15.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.15.m15.1c">\{\bm{a}^{i}\in\operatorname*{\mathbb{R}}^{1\times n}\}_{i=1}^{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.15.m15.1d">{ bold_italic_a start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_n end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>
and <math alttext="\bm{a}\ltimes\bm{b}=\sum_{i=1}^{p}\bm{a}^{i}\times\bm{b}_{i}\in\operatorname*{%
\mathbb{R}}^{1\times n}" class="ltx_Math" display="inline" id="S4.SS3.p3.16.m16.1"><semantics id="S4.SS3.p3.16.m16.1a"><mrow id="S4.SS3.p3.16.m16.1.1" xref="S4.SS3.p3.16.m16.1.1.cmml"><mrow id="S4.SS3.p3.16.m16.1.1.2" xref="S4.SS3.p3.16.m16.1.1.2.cmml"><mi id="S4.SS3.p3.16.m16.1.1.2.2" xref="S4.SS3.p3.16.m16.1.1.2.2.cmml">𝒂</mi><mo id="S4.SS3.p3.16.m16.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.16.m16.1.1.2.1.cmml">⋉</mo><mi id="S4.SS3.p3.16.m16.1.1.2.3" xref="S4.SS3.p3.16.m16.1.1.2.3.cmml">𝒃</mi></mrow><mo id="S4.SS3.p3.16.m16.1.1.3" rspace="0.111em" xref="S4.SS3.p3.16.m16.1.1.3.cmml">=</mo><mrow id="S4.SS3.p3.16.m16.1.1.4" xref="S4.SS3.p3.16.m16.1.1.4.cmml"><msubsup id="S4.SS3.p3.16.m16.1.1.4.1" xref="S4.SS3.p3.16.m16.1.1.4.1.cmml"><mo id="S4.SS3.p3.16.m16.1.1.4.1.2.2" xref="S4.SS3.p3.16.m16.1.1.4.1.2.2.cmml">∑</mo><mrow id="S4.SS3.p3.16.m16.1.1.4.1.2.3" xref="S4.SS3.p3.16.m16.1.1.4.1.2.3.cmml"><mi id="S4.SS3.p3.16.m16.1.1.4.1.2.3.2" xref="S4.SS3.p3.16.m16.1.1.4.1.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.16.m16.1.1.4.1.2.3.1" xref="S4.SS3.p3.16.m16.1.1.4.1.2.3.1.cmml">=</mo><mn id="S4.SS3.p3.16.m16.1.1.4.1.2.3.3" xref="S4.SS3.p3.16.m16.1.1.4.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p3.16.m16.1.1.4.1.3" xref="S4.SS3.p3.16.m16.1.1.4.1.3.cmml">p</mi></msubsup><mrow id="S4.SS3.p3.16.m16.1.1.4.2" xref="S4.SS3.p3.16.m16.1.1.4.2.cmml"><msup id="S4.SS3.p3.16.m16.1.1.4.2.2" xref="S4.SS3.p3.16.m16.1.1.4.2.2.cmml"><mi id="S4.SS3.p3.16.m16.1.1.4.2.2.2" xref="S4.SS3.p3.16.m16.1.1.4.2.2.2.cmml">𝒂</mi><mi id="S4.SS3.p3.16.m16.1.1.4.2.2.3" xref="S4.SS3.p3.16.m16.1.1.4.2.2.3.cmml">i</mi></msup><mo id="S4.SS3.p3.16.m16.1.1.4.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.16.m16.1.1.4.2.1.cmml">×</mo><msub id="S4.SS3.p3.16.m16.1.1.4.2.3" xref="S4.SS3.p3.16.m16.1.1.4.2.3.cmml"><mi id="S4.SS3.p3.16.m16.1.1.4.2.3.2" xref="S4.SS3.p3.16.m16.1.1.4.2.3.2.cmml">𝒃</mi><mi id="S4.SS3.p3.16.m16.1.1.4.2.3.3" xref="S4.SS3.p3.16.m16.1.1.4.2.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S4.SS3.p3.16.m16.1.1.5" rspace="0.1389em" xref="S4.SS3.p3.16.m16.1.1.5.cmml">∈</mo><msup id="S4.SS3.p3.16.m16.1.1.6" xref="S4.SS3.p3.16.m16.1.1.6.cmml"><mo id="S4.SS3.p3.16.m16.1.1.6.2" lspace="0.1389em" xref="S4.SS3.p3.16.m16.1.1.6.2.cmml">ℝ</mo><mrow id="S4.SS3.p3.16.m16.1.1.6.3" xref="S4.SS3.p3.16.m16.1.1.6.3.cmml"><mn id="S4.SS3.p3.16.m16.1.1.6.3.2" xref="S4.SS3.p3.16.m16.1.1.6.3.2.cmml">1</mn><mo id="S4.SS3.p3.16.m16.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.16.m16.1.1.6.3.1.cmml">×</mo><mi id="S4.SS3.p3.16.m16.1.1.6.3.3" xref="S4.SS3.p3.16.m16.1.1.6.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.16.m16.1b"><apply id="S4.SS3.p3.16.m16.1.1.cmml" xref="S4.SS3.p3.16.m16.1.1"><and id="S4.SS3.p3.16.m16.1.1a.cmml" xref="S4.SS3.p3.16.m16.1.1"></and><apply id="S4.SS3.p3.16.m16.1.1b.cmml" xref="S4.SS3.p3.16.m16.1.1"><eq id="S4.SS3.p3.16.m16.1.1.3.cmml" xref="S4.SS3.p3.16.m16.1.1.3"></eq><apply id="S4.SS3.p3.16.m16.1.1.2.cmml" xref="S4.SS3.p3.16.m16.1.1.2"><csymbol cd="latexml" id="S4.SS3.p3.16.m16.1.1.2.1.cmml" xref="S4.SS3.p3.16.m16.1.1.2.1">left-normal-factor-semidirect-product</csymbol><ci id="S4.SS3.p3.16.m16.1.1.2.2.cmml" xref="S4.SS3.p3.16.m16.1.1.2.2">𝒂</ci><ci id="S4.SS3.p3.16.m16.1.1.2.3.cmml" xref="S4.SS3.p3.16.m16.1.1.2.3">𝒃</ci></apply><apply id="S4.SS3.p3.16.m16.1.1.4.cmml" xref="S4.SS3.p3.16.m16.1.1.4"><apply id="S4.SS3.p3.16.m16.1.1.4.1.cmml" xref="S4.SS3.p3.16.m16.1.1.4.1"><csymbol cd="ambiguous" id="S4.SS3.p3.16.m16.1.1.4.1.1.cmml" xref="S4.SS3.p3.16.m16.1.1.4.1">superscript</csymbol><apply id="S4.SS3.p3.16.m16.1.1.4.1.2.cmml" xref="S4.SS3.p3.16.m16.1.1.4.1"><csymbol cd="ambiguous" id="S4.SS3.p3.16.m16.1.1.4.1.2.1.cmml" xref="S4.SS3.p3.16.m16.1.1.4.1">subscript</csymbol><sum id="S4.SS3.p3.16.m16.1.1.4.1.2.2.cmml" xref="S4.SS3.p3.16.m16.1.1.4.1.2.2"></sum><apply id="S4.SS3.p3.16.m16.1.1.4.1.2.3.cmml" xref="S4.SS3.p3.16.m16.1.1.4.1.2.3"><eq id="S4.SS3.p3.16.m16.1.1.4.1.2.3.1.cmml" xref="S4.SS3.p3.16.m16.1.1.4.1.2.3.1"></eq><ci id="S4.SS3.p3.16.m16.1.1.4.1.2.3.2.cmml" xref="S4.SS3.p3.16.m16.1.1.4.1.2.3.2">𝑖</ci><cn id="S4.SS3.p3.16.m16.1.1.4.1.2.3.3.cmml" type="integer" xref="S4.SS3.p3.16.m16.1.1.4.1.2.3.3">1</cn></apply></apply><ci id="S4.SS3.p3.16.m16.1.1.4.1.3.cmml" xref="S4.SS3.p3.16.m16.1.1.4.1.3">𝑝</ci></apply><apply id="S4.SS3.p3.16.m16.1.1.4.2.cmml" xref="S4.SS3.p3.16.m16.1.1.4.2"><times id="S4.SS3.p3.16.m16.1.1.4.2.1.cmml" xref="S4.SS3.p3.16.m16.1.1.4.2.1"></times><apply id="S4.SS3.p3.16.m16.1.1.4.2.2.cmml" xref="S4.SS3.p3.16.m16.1.1.4.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.16.m16.1.1.4.2.2.1.cmml" xref="S4.SS3.p3.16.m16.1.1.4.2.2">superscript</csymbol><ci id="S4.SS3.p3.16.m16.1.1.4.2.2.2.cmml" xref="S4.SS3.p3.16.m16.1.1.4.2.2.2">𝒂</ci><ci id="S4.SS3.p3.16.m16.1.1.4.2.2.3.cmml" xref="S4.SS3.p3.16.m16.1.1.4.2.2.3">𝑖</ci></apply><apply id="S4.SS3.p3.16.m16.1.1.4.2.3.cmml" xref="S4.SS3.p3.16.m16.1.1.4.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.16.m16.1.1.4.2.3.1.cmml" xref="S4.SS3.p3.16.m16.1.1.4.2.3">subscript</csymbol><ci id="S4.SS3.p3.16.m16.1.1.4.2.3.2.cmml" xref="S4.SS3.p3.16.m16.1.1.4.2.3.2">𝒃</ci><ci id="S4.SS3.p3.16.m16.1.1.4.2.3.3.cmml" xref="S4.SS3.p3.16.m16.1.1.4.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.SS3.p3.16.m16.1.1c.cmml" xref="S4.SS3.p3.16.m16.1.1"><in id="S4.SS3.p3.16.m16.1.1.5.cmml" xref="S4.SS3.p3.16.m16.1.1.5"></in><share href="https://arxiv.org/html/2408.02304v1#S4.SS3.p3.16.m16.1.1.4.cmml" id="S4.SS3.p3.16.m16.1.1d.cmml" xref="S4.SS3.p3.16.m16.1.1"></share><apply id="S4.SS3.p3.16.m16.1.1.6.cmml" xref="S4.SS3.p3.16.m16.1.1.6"><csymbol cd="ambiguous" id="S4.SS3.p3.16.m16.1.1.6.1.cmml" xref="S4.SS3.p3.16.m16.1.1.6">superscript</csymbol><ci id="S4.SS3.p3.16.m16.1.1.6.2.cmml" xref="S4.SS3.p3.16.m16.1.1.6.2">ℝ</ci><apply id="S4.SS3.p3.16.m16.1.1.6.3.cmml" xref="S4.SS3.p3.16.m16.1.1.6.3"><times id="S4.SS3.p3.16.m16.1.1.6.3.1.cmml" xref="S4.SS3.p3.16.m16.1.1.6.3.1"></times><cn id="S4.SS3.p3.16.m16.1.1.6.3.2.cmml" type="integer" xref="S4.SS3.p3.16.m16.1.1.6.3.2">1</cn><ci id="S4.SS3.p3.16.m16.1.1.6.3.3.cmml" xref="S4.SS3.p3.16.m16.1.1.6.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.16.m16.1c">\bm{a}\ltimes\bm{b}=\sum_{i=1}^{p}\bm{a}^{i}\times\bm{b}_{i}\in\operatorname*{%
\mathbb{R}}^{1\times n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.16.m16.1d">bold_italic_a ⋉ bold_italic_b = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT bold_italic_a start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT × bold_italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 1 × italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\ltimes" class="ltx_Math" display="inline" id="S4.SS3.p3.17.m17.1"><semantics id="S4.SS3.p3.17.m17.1a"><mo id="S4.SS3.p3.17.m17.1.1" xref="S4.SS3.p3.17.m17.1.1.cmml">⋉</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.17.m17.1b"><csymbol cd="latexml" id="S4.SS3.p3.17.m17.1.1.cmml" xref="S4.SS3.p3.17.m17.1.1">left-normal-factor-semidirect-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.17.m17.1c">\ltimes</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.17.m17.1d">⋉</annotation></semantics></math> is the left semi-tensor product.
For matrices <math alttext="\mathbf{A}\in\operatorname*{\mathbb{R}}^{h\times{np}}" class="ltx_Math" display="inline" id="S4.SS3.p3.18.m18.1"><semantics id="S4.SS3.p3.18.m18.1a"><mrow id="S4.SS3.p3.18.m18.1.1" xref="S4.SS3.p3.18.m18.1.1.cmml"><mi id="S4.SS3.p3.18.m18.1.1.2" xref="S4.SS3.p3.18.m18.1.1.2.cmml">𝐀</mi><mo id="S4.SS3.p3.18.m18.1.1.1" rspace="0.1389em" xref="S4.SS3.p3.18.m18.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.18.m18.1.1.3" xref="S4.SS3.p3.18.m18.1.1.3.cmml"><mo id="S4.SS3.p3.18.m18.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p3.18.m18.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p3.18.m18.1.1.3.3" xref="S4.SS3.p3.18.m18.1.1.3.3.cmml"><mrow id="S4.SS3.p3.18.m18.1.1.3.3.2" xref="S4.SS3.p3.18.m18.1.1.3.3.2.cmml"><mi id="S4.SS3.p3.18.m18.1.1.3.3.2.2" xref="S4.SS3.p3.18.m18.1.1.3.3.2.2.cmml">h</mi><mo id="S4.SS3.p3.18.m18.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.18.m18.1.1.3.3.2.1.cmml">×</mo><mi id="S4.SS3.p3.18.m18.1.1.3.3.2.3" xref="S4.SS3.p3.18.m18.1.1.3.3.2.3.cmml">n</mi></mrow><mo id="S4.SS3.p3.18.m18.1.1.3.3.1" xref="S4.SS3.p3.18.m18.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.18.m18.1.1.3.3.3" xref="S4.SS3.p3.18.m18.1.1.3.3.3.cmml">p</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.18.m18.1b"><apply id="S4.SS3.p3.18.m18.1.1.cmml" xref="S4.SS3.p3.18.m18.1.1"><in id="S4.SS3.p3.18.m18.1.1.1.cmml" xref="S4.SS3.p3.18.m18.1.1.1"></in><ci id="S4.SS3.p3.18.m18.1.1.2.cmml" xref="S4.SS3.p3.18.m18.1.1.2">𝐀</ci><apply id="S4.SS3.p3.18.m18.1.1.3.cmml" xref="S4.SS3.p3.18.m18.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.18.m18.1.1.3.1.cmml" xref="S4.SS3.p3.18.m18.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.18.m18.1.1.3.2.cmml" xref="S4.SS3.p3.18.m18.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.18.m18.1.1.3.3.cmml" xref="S4.SS3.p3.18.m18.1.1.3.3"><times id="S4.SS3.p3.18.m18.1.1.3.3.1.cmml" xref="S4.SS3.p3.18.m18.1.1.3.3.1"></times><apply id="S4.SS3.p3.18.m18.1.1.3.3.2.cmml" xref="S4.SS3.p3.18.m18.1.1.3.3.2"><times id="S4.SS3.p3.18.m18.1.1.3.3.2.1.cmml" xref="S4.SS3.p3.18.m18.1.1.3.3.2.1"></times><ci id="S4.SS3.p3.18.m18.1.1.3.3.2.2.cmml" xref="S4.SS3.p3.18.m18.1.1.3.3.2.2">ℎ</ci><ci id="S4.SS3.p3.18.m18.1.1.3.3.2.3.cmml" xref="S4.SS3.p3.18.m18.1.1.3.3.2.3">𝑛</ci></apply><ci id="S4.SS3.p3.18.m18.1.1.3.3.3.cmml" xref="S4.SS3.p3.18.m18.1.1.3.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.18.m18.1c">\mathbf{A}\in\operatorname*{\mathbb{R}}^{h\times{np}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.18.m18.1d">bold_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_h × italic_n italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{B}\in\operatorname*{\mathbb{R}}^{p\times q}" class="ltx_Math" display="inline" id="S4.SS3.p3.19.m19.1"><semantics id="S4.SS3.p3.19.m19.1a"><mrow id="S4.SS3.p3.19.m19.1.1" xref="S4.SS3.p3.19.m19.1.1.cmml"><mi id="S4.SS3.p3.19.m19.1.1.2" xref="S4.SS3.p3.19.m19.1.1.2.cmml">𝐁</mi><mo id="S4.SS3.p3.19.m19.1.1.1" rspace="0.1389em" xref="S4.SS3.p3.19.m19.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.19.m19.1.1.3" xref="S4.SS3.p3.19.m19.1.1.3.cmml"><mo id="S4.SS3.p3.19.m19.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p3.19.m19.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p3.19.m19.1.1.3.3" xref="S4.SS3.p3.19.m19.1.1.3.3.cmml"><mi id="S4.SS3.p3.19.m19.1.1.3.3.2" xref="S4.SS3.p3.19.m19.1.1.3.3.2.cmml">p</mi><mo id="S4.SS3.p3.19.m19.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.19.m19.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p3.19.m19.1.1.3.3.3" xref="S4.SS3.p3.19.m19.1.1.3.3.3.cmml">q</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.19.m19.1b"><apply id="S4.SS3.p3.19.m19.1.1.cmml" xref="S4.SS3.p3.19.m19.1.1"><in id="S4.SS3.p3.19.m19.1.1.1.cmml" xref="S4.SS3.p3.19.m19.1.1.1"></in><ci id="S4.SS3.p3.19.m19.1.1.2.cmml" xref="S4.SS3.p3.19.m19.1.1.2">𝐁</ci><apply id="S4.SS3.p3.19.m19.1.1.3.cmml" xref="S4.SS3.p3.19.m19.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.19.m19.1.1.3.1.cmml" xref="S4.SS3.p3.19.m19.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.19.m19.1.1.3.2.cmml" xref="S4.SS3.p3.19.m19.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.19.m19.1.1.3.3.cmml" xref="S4.SS3.p3.19.m19.1.1.3.3"><times id="S4.SS3.p3.19.m19.1.1.3.3.1.cmml" xref="S4.SS3.p3.19.m19.1.1.3.3.1"></times><ci id="S4.SS3.p3.19.m19.1.1.3.3.2.cmml" xref="S4.SS3.p3.19.m19.1.1.3.3.2">𝑝</ci><ci id="S4.SS3.p3.19.m19.1.1.3.3.3.cmml" xref="S4.SS3.p3.19.m19.1.1.3.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.19.m19.1c">\mathbf{B}\in\operatorname*{\mathbb{R}}^{p\times q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.19.m19.1d">bold_B ∈ blackboard_R start_POSTSUPERSCRIPT italic_p × italic_q end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{A}\ltimes\mathbf{B}\in\operatorname*{\mathbb{R}}^{h\times nq}" class="ltx_Math" display="inline" id="S4.SS3.p3.20.m20.1"><semantics id="S4.SS3.p3.20.m20.1a"><mrow id="S4.SS3.p3.20.m20.1.1" xref="S4.SS3.p3.20.m20.1.1.cmml"><mrow id="S4.SS3.p3.20.m20.1.1.2" xref="S4.SS3.p3.20.m20.1.1.2.cmml"><mi id="S4.SS3.p3.20.m20.1.1.2.2" xref="S4.SS3.p3.20.m20.1.1.2.2.cmml">𝐀</mi><mo id="S4.SS3.p3.20.m20.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.20.m20.1.1.2.1.cmml">⋉</mo><mi id="S4.SS3.p3.20.m20.1.1.2.3" xref="S4.SS3.p3.20.m20.1.1.2.3.cmml">𝐁</mi></mrow><mo id="S4.SS3.p3.20.m20.1.1.1" rspace="0.1389em" xref="S4.SS3.p3.20.m20.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.20.m20.1.1.3" xref="S4.SS3.p3.20.m20.1.1.3.cmml"><mo id="S4.SS3.p3.20.m20.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p3.20.m20.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p3.20.m20.1.1.3.3" xref="S4.SS3.p3.20.m20.1.1.3.3.cmml"><mrow id="S4.SS3.p3.20.m20.1.1.3.3.2" xref="S4.SS3.p3.20.m20.1.1.3.3.2.cmml"><mi id="S4.SS3.p3.20.m20.1.1.3.3.2.2" xref="S4.SS3.p3.20.m20.1.1.3.3.2.2.cmml">h</mi><mo id="S4.SS3.p3.20.m20.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.20.m20.1.1.3.3.2.1.cmml">×</mo><mi id="S4.SS3.p3.20.m20.1.1.3.3.2.3" xref="S4.SS3.p3.20.m20.1.1.3.3.2.3.cmml">n</mi></mrow><mo id="S4.SS3.p3.20.m20.1.1.3.3.1" xref="S4.SS3.p3.20.m20.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.p3.20.m20.1.1.3.3.3" xref="S4.SS3.p3.20.m20.1.1.3.3.3.cmml">q</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.20.m20.1b"><apply id="S4.SS3.p3.20.m20.1.1.cmml" xref="S4.SS3.p3.20.m20.1.1"><in id="S4.SS3.p3.20.m20.1.1.1.cmml" xref="S4.SS3.p3.20.m20.1.1.1"></in><apply id="S4.SS3.p3.20.m20.1.1.2.cmml" xref="S4.SS3.p3.20.m20.1.1.2"><csymbol cd="latexml" id="S4.SS3.p3.20.m20.1.1.2.1.cmml" xref="S4.SS3.p3.20.m20.1.1.2.1">left-normal-factor-semidirect-product</csymbol><ci id="S4.SS3.p3.20.m20.1.1.2.2.cmml" xref="S4.SS3.p3.20.m20.1.1.2.2">𝐀</ci><ci id="S4.SS3.p3.20.m20.1.1.2.3.cmml" xref="S4.SS3.p3.20.m20.1.1.2.3">𝐁</ci></apply><apply id="S4.SS3.p3.20.m20.1.1.3.cmml" xref="S4.SS3.p3.20.m20.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.20.m20.1.1.3.1.cmml" xref="S4.SS3.p3.20.m20.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.20.m20.1.1.3.2.cmml" xref="S4.SS3.p3.20.m20.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.20.m20.1.1.3.3.cmml" xref="S4.SS3.p3.20.m20.1.1.3.3"><times id="S4.SS3.p3.20.m20.1.1.3.3.1.cmml" xref="S4.SS3.p3.20.m20.1.1.3.3.1"></times><apply id="S4.SS3.p3.20.m20.1.1.3.3.2.cmml" xref="S4.SS3.p3.20.m20.1.1.3.3.2"><times id="S4.SS3.p3.20.m20.1.1.3.3.2.1.cmml" xref="S4.SS3.p3.20.m20.1.1.3.3.2.1"></times><ci id="S4.SS3.p3.20.m20.1.1.3.3.2.2.cmml" xref="S4.SS3.p3.20.m20.1.1.3.3.2.2">ℎ</ci><ci id="S4.SS3.p3.20.m20.1.1.3.3.2.3.cmml" xref="S4.SS3.p3.20.m20.1.1.3.3.2.3">𝑛</ci></apply><ci id="S4.SS3.p3.20.m20.1.1.3.3.3.cmml" xref="S4.SS3.p3.20.m20.1.1.3.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.20.m20.1c">\mathbf{A}\ltimes\mathbf{B}\in\operatorname*{\mathbb{R}}^{h\times nq}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.20.m20.1d">bold_A ⋉ bold_B ∈ blackboard_R start_POSTSUPERSCRIPT italic_h × italic_n italic_q end_POSTSUPERSCRIPT</annotation></semantics></math> contains <math alttext="h\times q" class="ltx_Math" display="inline" id="S4.SS3.p3.21.m21.1"><semantics id="S4.SS3.p3.21.m21.1a"><mrow id="S4.SS3.p3.21.m21.1.1" xref="S4.SS3.p3.21.m21.1.1.cmml"><mi id="S4.SS3.p3.21.m21.1.1.2" xref="S4.SS3.p3.21.m21.1.1.2.cmml">h</mi><mo id="S4.SS3.p3.21.m21.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.21.m21.1.1.1.cmml">×</mo><mi id="S4.SS3.p3.21.m21.1.1.3" xref="S4.SS3.p3.21.m21.1.1.3.cmml">q</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.21.m21.1b"><apply id="S4.SS3.p3.21.m21.1.1.cmml" xref="S4.SS3.p3.21.m21.1.1"><times id="S4.SS3.p3.21.m21.1.1.1.cmml" xref="S4.SS3.p3.21.m21.1.1.1"></times><ci id="S4.SS3.p3.21.m21.1.1.2.cmml" xref="S4.SS3.p3.21.m21.1.1.2">ℎ</ci><ci id="S4.SS3.p3.21.m21.1.1.3.cmml" xref="S4.SS3.p3.21.m21.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.21.m21.1c">h\times q</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.21.m21.1d">italic_h × italic_q</annotation></semantics></math> blocks
and each block is the semi-tensor product between a row of <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S4.SS3.p3.22.m22.1"><semantics id="S4.SS3.p3.22.m22.1a"><mi id="S4.SS3.p3.22.m22.1.1" xref="S4.SS3.p3.22.m22.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.22.m22.1b"><ci id="S4.SS3.p3.22.m22.1.1.cmml" xref="S4.SS3.p3.22.m22.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.22.m22.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.22.m22.1d">bold_A</annotation></semantics></math> and a column of <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="S4.SS3.p3.23.m23.1"><semantics id="S4.SS3.p3.23.m23.1a"><mi id="S4.SS3.p3.23.m23.1.1" xref="S4.SS3.p3.23.m23.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.23.m23.1b"><ci id="S4.SS3.p3.23.m23.1.1.cmml" xref="S4.SS3.p3.23.m23.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.23.m23.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.23.m23.1d">bold_B</annotation></semantics></math>. <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib65" title="">2022</a>)</cite> replaces the conventional matrix tensor product of TTD with the left semi-tensor product.
As Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S4.F6" title="Figure 6 ‣ 4.3. Decomposition ‣ 4. Weight-Sharing ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">6</span></a> shows, in STTD, <math alttext="\mathcal{E}=\mathcal{\hat{G}}_{1}\ltimes\mathcal{\hat{G}}_{2}\ltimes...\ltimes%
\mathcal{\hat{G}}_{s}" class="ltx_Math" display="inline" id="S4.SS3.p3.24.m24.1"><semantics id="S4.SS3.p3.24.m24.1a"><mrow id="S4.SS3.p3.24.m24.1.1" xref="S4.SS3.p3.24.m24.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.24.m24.1.1.2" xref="S4.SS3.p3.24.m24.1.1.2.cmml">ℰ</mi><mo id="S4.SS3.p3.24.m24.1.1.1" xref="S4.SS3.p3.24.m24.1.1.1.cmml">=</mo><mrow id="S4.SS3.p3.24.m24.1.1.3" xref="S4.SS3.p3.24.m24.1.1.3.cmml"><msub id="S4.SS3.p3.24.m24.1.1.3.2" xref="S4.SS3.p3.24.m24.1.1.3.2.cmml"><mover accent="true" id="S4.SS3.p3.24.m24.1.1.3.2.2" xref="S4.SS3.p3.24.m24.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.24.m24.1.1.3.2.2.2" xref="S4.SS3.p3.24.m24.1.1.3.2.2.2.cmml">𝒢</mi><mo id="S4.SS3.p3.24.m24.1.1.3.2.2.1" xref="S4.SS3.p3.24.m24.1.1.3.2.2.1.cmml">^</mo></mover><mn id="S4.SS3.p3.24.m24.1.1.3.2.3" xref="S4.SS3.p3.24.m24.1.1.3.2.3.cmml">1</mn></msub><mo id="S4.SS3.p3.24.m24.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.24.m24.1.1.3.1.cmml">⋉</mo><msub id="S4.SS3.p3.24.m24.1.1.3.3" xref="S4.SS3.p3.24.m24.1.1.3.3.cmml"><mover accent="true" id="S4.SS3.p3.24.m24.1.1.3.3.2" xref="S4.SS3.p3.24.m24.1.1.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.24.m24.1.1.3.3.2.2" xref="S4.SS3.p3.24.m24.1.1.3.3.2.2.cmml">𝒢</mi><mo id="S4.SS3.p3.24.m24.1.1.3.3.2.1" xref="S4.SS3.p3.24.m24.1.1.3.3.2.1.cmml">^</mo></mover><mn id="S4.SS3.p3.24.m24.1.1.3.3.3" xref="S4.SS3.p3.24.m24.1.1.3.3.3.cmml">2</mn></msub><mo id="S4.SS3.p3.24.m24.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.24.m24.1.1.3.1.cmml">⋉</mo><mi id="S4.SS3.p3.24.m24.1.1.3.4" mathvariant="normal" xref="S4.SS3.p3.24.m24.1.1.3.4.cmml">…</mi><mo id="S4.SS3.p3.24.m24.1.1.3.1b" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.24.m24.1.1.3.1.cmml">⋉</mo><msub id="S4.SS3.p3.24.m24.1.1.3.5" xref="S4.SS3.p3.24.m24.1.1.3.5.cmml"><mover accent="true" id="S4.SS3.p3.24.m24.1.1.3.5.2" xref="S4.SS3.p3.24.m24.1.1.3.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.24.m24.1.1.3.5.2.2" xref="S4.SS3.p3.24.m24.1.1.3.5.2.2.cmml">𝒢</mi><mo id="S4.SS3.p3.24.m24.1.1.3.5.2.1" xref="S4.SS3.p3.24.m24.1.1.3.5.2.1.cmml">^</mo></mover><mi id="S4.SS3.p3.24.m24.1.1.3.5.3" xref="S4.SS3.p3.24.m24.1.1.3.5.3.cmml">s</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.24.m24.1b"><apply id="S4.SS3.p3.24.m24.1.1.cmml" xref="S4.SS3.p3.24.m24.1.1"><eq id="S4.SS3.p3.24.m24.1.1.1.cmml" xref="S4.SS3.p3.24.m24.1.1.1"></eq><ci id="S4.SS3.p3.24.m24.1.1.2.cmml" xref="S4.SS3.p3.24.m24.1.1.2">ℰ</ci><apply id="S4.SS3.p3.24.m24.1.1.3.cmml" xref="S4.SS3.p3.24.m24.1.1.3"><csymbol cd="latexml" id="S4.SS3.p3.24.m24.1.1.3.1.cmml" xref="S4.SS3.p3.24.m24.1.1.3.1">left-normal-factor-semidirect-product</csymbol><apply id="S4.SS3.p3.24.m24.1.1.3.2.cmml" xref="S4.SS3.p3.24.m24.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p3.24.m24.1.1.3.2.1.cmml" xref="S4.SS3.p3.24.m24.1.1.3.2">subscript</csymbol><apply id="S4.SS3.p3.24.m24.1.1.3.2.2.cmml" xref="S4.SS3.p3.24.m24.1.1.3.2.2"><ci id="S4.SS3.p3.24.m24.1.1.3.2.2.1.cmml" xref="S4.SS3.p3.24.m24.1.1.3.2.2.1">^</ci><ci id="S4.SS3.p3.24.m24.1.1.3.2.2.2.cmml" xref="S4.SS3.p3.24.m24.1.1.3.2.2.2">𝒢</ci></apply><cn id="S4.SS3.p3.24.m24.1.1.3.2.3.cmml" type="integer" xref="S4.SS3.p3.24.m24.1.1.3.2.3">1</cn></apply><apply id="S4.SS3.p3.24.m24.1.1.3.3.cmml" xref="S4.SS3.p3.24.m24.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.24.m24.1.1.3.3.1.cmml" xref="S4.SS3.p3.24.m24.1.1.3.3">subscript</csymbol><apply id="S4.SS3.p3.24.m24.1.1.3.3.2.cmml" xref="S4.SS3.p3.24.m24.1.1.3.3.2"><ci id="S4.SS3.p3.24.m24.1.1.3.3.2.1.cmml" xref="S4.SS3.p3.24.m24.1.1.3.3.2.1">^</ci><ci id="S4.SS3.p3.24.m24.1.1.3.3.2.2.cmml" xref="S4.SS3.p3.24.m24.1.1.3.3.2.2">𝒢</ci></apply><cn id="S4.SS3.p3.24.m24.1.1.3.3.3.cmml" type="integer" xref="S4.SS3.p3.24.m24.1.1.3.3.3">2</cn></apply><ci id="S4.SS3.p3.24.m24.1.1.3.4.cmml" xref="S4.SS3.p3.24.m24.1.1.3.4">…</ci><apply id="S4.SS3.p3.24.m24.1.1.3.5.cmml" xref="S4.SS3.p3.24.m24.1.1.3.5"><csymbol cd="ambiguous" id="S4.SS3.p3.24.m24.1.1.3.5.1.cmml" xref="S4.SS3.p3.24.m24.1.1.3.5">subscript</csymbol><apply id="S4.SS3.p3.24.m24.1.1.3.5.2.cmml" xref="S4.SS3.p3.24.m24.1.1.3.5.2"><ci id="S4.SS3.p3.24.m24.1.1.3.5.2.1.cmml" xref="S4.SS3.p3.24.m24.1.1.3.5.2.1">^</ci><ci id="S4.SS3.p3.24.m24.1.1.3.5.2.2.cmml" xref="S4.SS3.p3.24.m24.1.1.3.5.2.2">𝒢</ci></apply><ci id="S4.SS3.p3.24.m24.1.1.3.5.3.cmml" xref="S4.SS3.p3.24.m24.1.1.3.5.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.24.m24.1c">\mathcal{E}=\mathcal{\hat{G}}_{1}\ltimes\mathcal{\hat{G}}_{2}\ltimes...\ltimes%
\mathcal{\hat{G}}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.24.m24.1d">caligraphic_E = over^ start_ARG caligraphic_G end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋉ over^ start_ARG caligraphic_G end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ⋉ … ⋉ over^ start_ARG caligraphic_G end_ARG start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>,
where <math alttext="\mathcal{\hat{G}}_{i}\in\operatorname*{\mathbb{R}}^{\frac{r_{i-1}}{k}\times%
\frac{n_{i}d_{i}}{k}\times r_{i}}" class="ltx_Math" display="inline" id="S4.SS3.p3.25.m25.1"><semantics id="S4.SS3.p3.25.m25.1a"><mrow id="S4.SS3.p3.25.m25.1.1" xref="S4.SS3.p3.25.m25.1.1.cmml"><msub id="S4.SS3.p3.25.m25.1.1.2" xref="S4.SS3.p3.25.m25.1.1.2.cmml"><mover accent="true" id="S4.SS3.p3.25.m25.1.1.2.2" xref="S4.SS3.p3.25.m25.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.25.m25.1.1.2.2.2" xref="S4.SS3.p3.25.m25.1.1.2.2.2.cmml">𝒢</mi><mo id="S4.SS3.p3.25.m25.1.1.2.2.1" xref="S4.SS3.p3.25.m25.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS3.p3.25.m25.1.1.2.3" xref="S4.SS3.p3.25.m25.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS3.p3.25.m25.1.1.1" rspace="0.1389em" xref="S4.SS3.p3.25.m25.1.1.1.cmml">∈</mo><msup id="S4.SS3.p3.25.m25.1.1.3" xref="S4.SS3.p3.25.m25.1.1.3.cmml"><mo id="S4.SS3.p3.25.m25.1.1.3.2" lspace="0.1389em" xref="S4.SS3.p3.25.m25.1.1.3.2.cmml">ℝ</mo><mrow id="S4.SS3.p3.25.m25.1.1.3.3" xref="S4.SS3.p3.25.m25.1.1.3.3.cmml"><mfrac id="S4.SS3.p3.25.m25.1.1.3.3.2" xref="S4.SS3.p3.25.m25.1.1.3.3.2.cmml"><msub id="S4.SS3.p3.25.m25.1.1.3.3.2.2" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2.cmml"><mi id="S4.SS3.p3.25.m25.1.1.3.3.2.2.2" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2.2.cmml">r</mi><mrow id="S4.SS3.p3.25.m25.1.1.3.3.2.2.3" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.cmml"><mi id="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.2" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.2.cmml">i</mi><mo id="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.1" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.1.cmml">−</mo><mn id="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.3" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.3.cmml">1</mn></mrow></msub><mi id="S4.SS3.p3.25.m25.1.1.3.3.2.3" xref="S4.SS3.p3.25.m25.1.1.3.3.2.3.cmml">k</mi></mfrac><mo id="S4.SS3.p3.25.m25.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.25.m25.1.1.3.3.1.cmml">×</mo><mfrac id="S4.SS3.p3.25.m25.1.1.3.3.3" xref="S4.SS3.p3.25.m25.1.1.3.3.3.cmml"><mrow id="S4.SS3.p3.25.m25.1.1.3.3.3.2" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.cmml"><msub id="S4.SS3.p3.25.m25.1.1.3.3.3.2.2" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.2.cmml"><mi id="S4.SS3.p3.25.m25.1.1.3.3.3.2.2.2" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.2.2.cmml">n</mi><mi id="S4.SS3.p3.25.m25.1.1.3.3.3.2.2.3" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.2.3.cmml">i</mi></msub><mo id="S4.SS3.p3.25.m25.1.1.3.3.3.2.1" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.1.cmml">⁢</mo><msub id="S4.SS3.p3.25.m25.1.1.3.3.3.2.3" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.3.cmml"><mi id="S4.SS3.p3.25.m25.1.1.3.3.3.2.3.2" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.3.2.cmml">d</mi><mi id="S4.SS3.p3.25.m25.1.1.3.3.3.2.3.3" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.3.3.cmml">i</mi></msub></mrow><mi id="S4.SS3.p3.25.m25.1.1.3.3.3.3" xref="S4.SS3.p3.25.m25.1.1.3.3.3.3.cmml">k</mi></mfrac><mo id="S4.SS3.p3.25.m25.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p3.25.m25.1.1.3.3.1.cmml">×</mo><msub id="S4.SS3.p3.25.m25.1.1.3.3.4" xref="S4.SS3.p3.25.m25.1.1.3.3.4.cmml"><mi id="S4.SS3.p3.25.m25.1.1.3.3.4.2" xref="S4.SS3.p3.25.m25.1.1.3.3.4.2.cmml">r</mi><mi id="S4.SS3.p3.25.m25.1.1.3.3.4.3" xref="S4.SS3.p3.25.m25.1.1.3.3.4.3.cmml">i</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.25.m25.1b"><apply id="S4.SS3.p3.25.m25.1.1.cmml" xref="S4.SS3.p3.25.m25.1.1"><in id="S4.SS3.p3.25.m25.1.1.1.cmml" xref="S4.SS3.p3.25.m25.1.1.1"></in><apply id="S4.SS3.p3.25.m25.1.1.2.cmml" xref="S4.SS3.p3.25.m25.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.25.m25.1.1.2.1.cmml" xref="S4.SS3.p3.25.m25.1.1.2">subscript</csymbol><apply id="S4.SS3.p3.25.m25.1.1.2.2.cmml" xref="S4.SS3.p3.25.m25.1.1.2.2"><ci id="S4.SS3.p3.25.m25.1.1.2.2.1.cmml" xref="S4.SS3.p3.25.m25.1.1.2.2.1">^</ci><ci id="S4.SS3.p3.25.m25.1.1.2.2.2.cmml" xref="S4.SS3.p3.25.m25.1.1.2.2.2">𝒢</ci></apply><ci id="S4.SS3.p3.25.m25.1.1.2.3.cmml" xref="S4.SS3.p3.25.m25.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.p3.25.m25.1.1.3.cmml" xref="S4.SS3.p3.25.m25.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.25.m25.1.1.3.1.cmml" xref="S4.SS3.p3.25.m25.1.1.3">superscript</csymbol><ci id="S4.SS3.p3.25.m25.1.1.3.2.cmml" xref="S4.SS3.p3.25.m25.1.1.3.2">ℝ</ci><apply id="S4.SS3.p3.25.m25.1.1.3.3.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3"><times id="S4.SS3.p3.25.m25.1.1.3.3.1.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.1"></times><apply id="S4.SS3.p3.25.m25.1.1.3.3.2.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.2"><divide id="S4.SS3.p3.25.m25.1.1.3.3.2.1.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.2"></divide><apply id="S4.SS3.p3.25.m25.1.1.3.3.2.2.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.25.m25.1.1.3.3.2.2.1.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.25.m25.1.1.3.3.2.2.2.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2.2">𝑟</ci><apply id="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2.3"><minus id="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.1.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.1"></minus><ci id="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.2.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.2">𝑖</ci><cn id="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.3.cmml" type="integer" xref="S4.SS3.p3.25.m25.1.1.3.3.2.2.3.3">1</cn></apply></apply><ci id="S4.SS3.p3.25.m25.1.1.3.3.2.3.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.2.3">𝑘</ci></apply><apply id="S4.SS3.p3.25.m25.1.1.3.3.3.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3"><divide id="S4.SS3.p3.25.m25.1.1.3.3.3.1.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3"></divide><apply id="S4.SS3.p3.25.m25.1.1.3.3.3.2.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2"><times id="S4.SS3.p3.25.m25.1.1.3.3.3.2.1.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.1"></times><apply id="S4.SS3.p3.25.m25.1.1.3.3.3.2.2.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p3.25.m25.1.1.3.3.3.2.2.1.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p3.25.m25.1.1.3.3.3.2.2.2.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.2.2">𝑛</ci><ci id="S4.SS3.p3.25.m25.1.1.3.3.3.2.2.3.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.2.3">𝑖</ci></apply><apply id="S4.SS3.p3.25.m25.1.1.3.3.3.2.3.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="S4.SS3.p3.25.m25.1.1.3.3.3.2.3.1.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.3">subscript</csymbol><ci id="S4.SS3.p3.25.m25.1.1.3.3.3.2.3.2.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.3.2">𝑑</ci><ci id="S4.SS3.p3.25.m25.1.1.3.3.3.2.3.3.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS3.p3.25.m25.1.1.3.3.3.3.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.3.3">𝑘</ci></apply><apply id="S4.SS3.p3.25.m25.1.1.3.3.4.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.SS3.p3.25.m25.1.1.3.3.4.1.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.4">subscript</csymbol><ci id="S4.SS3.p3.25.m25.1.1.3.3.4.2.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.4.2">𝑟</ci><ci id="S4.SS3.p3.25.m25.1.1.3.3.4.3.cmml" xref="S4.SS3.p3.25.m25.1.1.3.3.4.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.25.m25.1c">\mathcal{\hat{G}}_{i}\in\operatorname*{\mathbb{R}}^{\frac{r_{i-1}}{k}\times%
\frac{n_{i}d_{i}}{k}\times r_{i}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.25.m25.1d">over^ start_ARG caligraphic_G end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT divide start_ARG italic_r start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT end_ARG start_ARG italic_k end_ARG × divide start_ARG italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG italic_k end_ARG × italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> ,<math alttext="r_{0}=k" class="ltx_Math" display="inline" id="S4.SS3.p3.26.m26.1"><semantics id="S4.SS3.p3.26.m26.1a"><mrow id="S4.SS3.p3.26.m26.1.1" xref="S4.SS3.p3.26.m26.1.1.cmml"><msub id="S4.SS3.p3.26.m26.1.1.2" xref="S4.SS3.p3.26.m26.1.1.2.cmml"><mi id="S4.SS3.p3.26.m26.1.1.2.2" xref="S4.SS3.p3.26.m26.1.1.2.2.cmml">r</mi><mn id="S4.SS3.p3.26.m26.1.1.2.3" xref="S4.SS3.p3.26.m26.1.1.2.3.cmml">0</mn></msub><mo id="S4.SS3.p3.26.m26.1.1.1" xref="S4.SS3.p3.26.m26.1.1.1.cmml">=</mo><mi id="S4.SS3.p3.26.m26.1.1.3" xref="S4.SS3.p3.26.m26.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.26.m26.1b"><apply id="S4.SS3.p3.26.m26.1.1.cmml" xref="S4.SS3.p3.26.m26.1.1"><eq id="S4.SS3.p3.26.m26.1.1.1.cmml" xref="S4.SS3.p3.26.m26.1.1.1"></eq><apply id="S4.SS3.p3.26.m26.1.1.2.cmml" xref="S4.SS3.p3.26.m26.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.26.m26.1.1.2.1.cmml" xref="S4.SS3.p3.26.m26.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.26.m26.1.1.2.2.cmml" xref="S4.SS3.p3.26.m26.1.1.2.2">𝑟</ci><cn id="S4.SS3.p3.26.m26.1.1.2.3.cmml" type="integer" xref="S4.SS3.p3.26.m26.1.1.2.3">0</cn></apply><ci id="S4.SS3.p3.26.m26.1.1.3.cmml" xref="S4.SS3.p3.26.m26.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.26.m26.1c">r_{0}=k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.26.m26.1d">italic_r start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_k</annotation></semantics></math> and <math alttext="r_{s}=1" class="ltx_Math" display="inline" id="S4.SS3.p3.27.m27.1"><semantics id="S4.SS3.p3.27.m27.1a"><mrow id="S4.SS3.p3.27.m27.1.1" xref="S4.SS3.p3.27.m27.1.1.cmml"><msub id="S4.SS3.p3.27.m27.1.1.2" xref="S4.SS3.p3.27.m27.1.1.2.cmml"><mi id="S4.SS3.p3.27.m27.1.1.2.2" xref="S4.SS3.p3.27.m27.1.1.2.2.cmml">r</mi><mi id="S4.SS3.p3.27.m27.1.1.2.3" xref="S4.SS3.p3.27.m27.1.1.2.3.cmml">s</mi></msub><mo id="S4.SS3.p3.27.m27.1.1.1" xref="S4.SS3.p3.27.m27.1.1.1.cmml">=</mo><mn id="S4.SS3.p3.27.m27.1.1.3" xref="S4.SS3.p3.27.m27.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.27.m27.1b"><apply id="S4.SS3.p3.27.m27.1.1.cmml" xref="S4.SS3.p3.27.m27.1.1"><eq id="S4.SS3.p3.27.m27.1.1.1.cmml" xref="S4.SS3.p3.27.m27.1.1.1"></eq><apply id="S4.SS3.p3.27.m27.1.1.2.cmml" xref="S4.SS3.p3.27.m27.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.27.m27.1.1.2.1.cmml" xref="S4.SS3.p3.27.m27.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.27.m27.1.1.2.2.cmml" xref="S4.SS3.p3.27.m27.1.1.2.2">𝑟</ci><ci id="S4.SS3.p3.27.m27.1.1.2.3.cmml" xref="S4.SS3.p3.27.m27.1.1.2.3">𝑠</ci></apply><cn id="S4.SS3.p3.27.m27.1.1.3.cmml" type="integer" xref="S4.SS3.p3.27.m27.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.27.m27.1c">r_{s}=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.27.m27.1d">italic_r start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = 1</annotation></semantics></math>.
In addition, <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib65" title="">2022</a>)</cite> uses self-supervised knowledge distillation to to reduce accuracy loss from compression.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Discussion</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Weight sharing approaches usually make remarkable reduction to the memory usage.
However, they suffer from low efficiency at training due to extra computing cost for generating embeddings,
especially the nearest neighbor search in vector quantization and the matrix multiplication in decomposition approaches.
The extra computing cost will also slow down the inference speed except in vector quantization where we can store the results of inner product between meta-embeddings to accelerate the inference.
Nevertheless, vector quantization maintains the original embeddings during training which requires extra memory usage.
Moreover, these methods usually cannot improve the prediction accuracy, especially hashing usually causes severe drop of accuracy.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Summary</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Embedding tables usually constitute a large portion of model parameters in DLRMs, which need to be compressed for efficient and economical deployment.
As recommender systems continue to grow in scale, embedding compression has attracted more and more attention.
In this survey, we provide a comprehensive review of the embedding compression methods in recommender systems, accompanied by a systematic and rational organization of existing studies.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">The embedding table can be conceptualized as a matrix with three dimensions, namely the precision of weights, the dimension of embeddings, and the number of embeddings.
Consequently, we classify embedding compression methods into three primary categories according to the dimensions they compress, which are low-precision, mixed-dimension, and weight-sharing, respectively.
Low-precision methods reduce the memory of each weight by decreasing its bit width, including binarization and quantization.
Mixed-dimension methods reduce the memory of specific embeddings by decreasing their dimensions, including rule-based approaches, NAS-based approaches and pruning.
Weight-sharing methods reduce the actual parameters of the embedding table by sharing weights among different embeddings, including hashing, vector quantization and decomposition.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>General Suggestions</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">In the above sections, we have discussed the pros and cons of different compression methods in detail. However, there are no golden criteria to measure which one is the best.
How to choose a proper compression method depends greatly on the application scenarios and requirements.
Therefore, we offer some general suggestions for the common requirements on the key metrics discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#S1.SS2" title="1.2. Embedding Compression in Recommender Systems ‣ 1. Introduction ‣ Embedding Compression in Recommender Systems: A Survey"><span class="ltx_text ltx_ref_tag">1.2</span></a>, namely model accuracy, inference efficiency, training efficiency, and training memory usage, respectively.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">Model accuracy.</span>
In scenarios that demand high model accuracy, any accuracy degradation caused by compression is deemed unacceptable.
In such cases, mixed-dimension methods are recommended as they have been reported to remove redundant parameters and avoid model overfitting. With an appropriate compression ratio, mixed-dimension methods can effectively compress embeddings while maintaining or even improving accuracy.
Furthermore, accuracy can also be preserved when compressing embeddings by quantization with a higher bit width. For instance, using a 16-bit representation has been proven to be sufficient for achieving accurate results.
On the contrary, for scenarios that do not require high prediction accuracy, quantization with lower bit width or even binarization (1-bit) can be employed to achieve stronger compression.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">Inference efficiency.</span>
In scenarios such as online inference, model inference efficiency is of paramount importance. Generally speaking, most embedding compression methods will not have a great negative impact on the inference speed. However, in several decomposition methods where the embedding table is decomposed into multiple small matrices, the process of recovering embeddings may introduce significant inference latency and should be avoided in this context.
To improve inference efficiency while compressing embeddings, vector quantization is suggested, as the feature interaction (e.g., inner-product) of embeddings can be pre-calculated to accelerate the inference process. Additionally, binarization is also worth considering when there is no high requirement on model accuracy. The calculation of feature interactions between binary embeddings is faster compared to that between full-precision embeddings.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">Training efficiency.</span>
In scenarios where the models are supposed to be updated in a timely manner, training efficiency becomes a critical factor. However, it is unfortunate that most embedding compression methods do not contribute to improving the training efficiency. In fact, some of them may significantly reduce training efficiency, particularly NAS-based approaches, pruning, vector quantization, and decomposition.
Specifically, NAS-based approaches involve complex calculations to search for optimal embedding dimensions, which can be computationally intensive and time-consuming. Pruning often necessitates retraining to achieve higher accuracy, resulting in additional training overhead. Vector quantization also involves cumbersome calculations for nearest neighbor searches. Decomposition may require multiple matrix multiplications to recover and retrieve embeddings.
Therefore, in scenarios that prioritize training efficiency and timely model updates, these methods are not recommended.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.1">Training memory usage.</span>
In scenarios where computing devices have limited memory, it is desirable to compress the training memory usage of embeddings or, at the very least, avoid increasing it.
In such cases, we suggest using rule-based approaches, hashing, or decomposition, as they can compress the embedding table before training. Besides, the low-precision training of quantization is also worth considering, as the embeddings are stored in the format of integers during training.
On the contrary, NAS-based approaches and vector quantization are not recommended in this context. They often require storing a significant number of intermediate results to guide the training process, which will consume more memory.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Future Prospects</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Embedding compression in recommender systems has witnessed rapid development and notable achievements, although there are still several challenging issues that require attention. We identify several potential directions for further research in this field.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i1.p1.1.1">Low-precision.</span>
The key problem faced by low-precision methods is the severe accuracy degradation at extremely lower bit widths.
In view of the extensive and advanced research on quantization and binarization in the deep learning community, we can refer to related techniques to alleviate the accuracy loss when compressing embeddings, which is quite challenging and valuable.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i2.p1.1.1">Mixed-dimension.</span>
In recent advanced mixed-dimension methods, there is a need to enhance the training efficiency of NAS-based approaches and pruning.
To address this, we recommend designing lighter NAS frameworks that can efficiently search for the optimal embedding dimension.
On the other hand, finding solutions to avoid retraining pruned models is also crucial for enhancing training efficiency.
Furthermore, while numerous studies have demonstrated the significant impact of the embedding dimension on model accuracy, there is still a lack of theoretical understanding regarding how the embedding dimension precisely affects model accuracy. Having a solid theoretical basis would be invaluable in guiding the optimal selection of embedding dimensions, enabling more efficient and effective model training.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i3.p1">
<p class="ltx_p" id="S5.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i3.p1.1.1">Weight-sharing.</span>
To approach the limit of weight sharing methods, we believe that an intriguing direction to explore is the use of embedding generation networks.
Considering the powerful representation capabilities of neural networks, we may learn a powerful neural network to generate embeddings, instead of directly learning and maintaining the embeddings themselves.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i4.p1">
<p class="ltx_p" id="S5.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i4.p1.1.1">Hybrid approaches.</span>
Since the methods within the three primary categories compress the embeddings from different dimensions and enjoy different advantages, we expect future research to establish a unified method for compressing multiple dimensions, or develop hybrid approaches combining these techniques. By integrating the strengths of different compression methods, it is possible to create more powerful and comprehensive compression algorithms.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i5.p1">
<p class="ltx_p" id="S5.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i5.p1.1.1">Open benchmarks.</span>
This review offers a thorough discussion of embedding compression methods. However, we did not undertake an experimental comparison across these methods. On one hand, distinct methods are applied to different tasks in recommender systems, each of which has unique accuracy metrics. For example, in click-through rate (CTR) prediction, the commonly used metric is the Area Under the Curve (AUC); whereas for rating prediction, Root Mean Square Error (RMSE) and Mean Absolute Error (MAE) are typically employed; for Top-N recommendations, Mean Average Precision (MAP) and Normalized Discounted Cumulative Gain (NDCG) are commonly utilized as accuracy metrics. On the other hand, a majority of research relies on proprietary datasets without sharing open-source code, presenting obstacles to reproducibility and comparative analyses. Nonetheless, the implementation of these methods is not inherently complex. Given the focus on the embedding tables, a solution involves the definition of a new embedding module during implementation, coupled with the rewriting of the lookup operation for the embedding vector. Therefore, it is necessary to establish a foundational benchmark to evaluate the effectiveness of distinct methods across a spectrum of tasks, like BARS <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.02304v1#bib.bib82" title="">2022</a>)</cite>, a benchmark designed for recommendations. We posit that this would substantially expedite the application and advancement of this field.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This work is supported in part by National Natural Science Foundation of China under grants 62376103, 62302184, 62206102, and Science and Technology Support Program of Hubei Province under grant 2022BAA046.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Babenko and Lempitsky (2014)</span>
<span class="ltx_bibblock">
Artem Babenko and Victor S. Lempitsky. 2014.

</span>
<span class="ltx_bibblock">Additive Quantization for Extreme Vector Compression. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">2014 IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2014, Columbus, OH, USA, June 23-28, 2014</em>. IEEE Computer Society, Columbus, OH, USA, 931–938.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhalgat et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yash Bhalgat, Jinwon Lee, Markus Nagel, Tijmen Blankevoort, and Nojun Kwak. 2020.

</span>
<span class="ltx_bibblock">LSQ+: Improving low-bit quantization through learnable offsets and better initialization. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">2020 IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR Workshops 2020, Seattle, WA, USA, June 14-19, 2020</em>. Computer Vision Foundation / IEEE, 2978–2985.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2021a)</span>
<span class="ltx_bibblock">
Tong Chen, Hongzhi Yin, Yujia Zheng, Zi Huang, Yang Wang, and Meng Wang. 2021a.

</span>
<span class="ltx_bibblock">Learning Elastic Embeddings for Customizing On-Device Recommenders. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">KDD ’21: The 27th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, Virtual Event, Singapore, August 14-18, 2021</em>. ACM, 138–147.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Yunchuan Chen, Lili Mou, Yan Xu, Ge Li, and Zhi Jin. 2016.

</span>
<span class="ltx_bibblock">Compressing Neural Language Models by Sparse Word Representations. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics, ACL 2016, August 7-12, 2016, Berlin, Germany, Volume 1: Long Papers</em>. The Association for Computer Linguistics.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2021b)</span>
<span class="ltx_bibblock">
Yankai Chen, Yifei Zhang, Yingxue Zhang, Huifeng Guo, Jingjie Li, Ruiming Tang, Xiuqiang He, and Irwin King. 2021b.

</span>
<span class="ltx_bibblock">Towards Low-loss 1-bit Quantization of User-item Representations for Top-K Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">CoRR</em> abs/2112.01944 (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Heng-Tze Cheng, Levent Koc, Jeremiah Harmsen, Tal Shaked, Tushar Chandra, Hrishi Aradhye, Glen Anderson, Greg Corrado, Wei Chai, Mustafa Ispir, Rohan Anil, Zakaria Haque, Lichan Hong, Vihan Jain, Xiaobing Liu, and Hemal Shah. 2016.

</span>
<span class="ltx_bibblock">Wide &amp; Deep Learning for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the 1st Workshop on Deep Learning for Recommender Systems, DLRS@RecSys 2016, Boston, MA, USA, September 15, 2016</em>. ACM, 7–10.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Weiyu Cheng, Yanyan Shen, and Linpeng Huang. 2020.

</span>
<span class="ltx_bibblock">Differentiable Neural Input Search for Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">CoRR</em> abs/2006.04466 (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choudhary et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Tejalal Choudhary, Vipul Kumar Mishra, Anurag Goswami, and Jagannathan Sarangapani. 2020.

</span>
<span class="ltx_bibblock">A comprehensive survey on model compression and acceleration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Artif. Intell. Rev.</em> 53, 7 (2020), 5113–5155.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Courbariaux et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Matthieu Courbariaux, Yoshua Bengio, and Jean-Pierre David. 2015.

</span>
<span class="ltx_bibblock">BinaryConnect: Training Deep Neural Networks with binary weights during propagations. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Advances in Neural Information Processing Systems 28: Annual Conference on Neural Information Processing Systems 2015, December 7-12, 2015, Montreal, Quebec, Canada</em>. 3123–3131.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Wei Deng, Junwei Pan, Tian Zhou, Deguang Kong, Aaron Flores, and Guang Lin. 2021.

</span>
<span class="ltx_bibblock">DeepLight: Deep Lightweight Feature Interactions for Accelerating CTR Predictions in Ad Serving. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">WSDM ’21, The Fourteenth ACM International Conference on Web Search and Data Mining, Virtual Event, Israel, March 8-12, 2021</em>. ACM, 922–930.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Desai et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Aditya Desai, Li Chou, and Anshumali Shrivastava. 2022.

</span>
<span class="ltx_bibblock">Random Offset Block Embedding (ROBE) for compressed embedding tables in deep learning recommendation systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of Machine Learning and Systems</em> 4 (2022), 762–778.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Desai et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Aditya Desai, Yanzhou Pan, Kuangyuan Sun, et al<span class="ltx_text" id="bib.bib13.3.1">.</span> 2021.

</span>
<span class="ltx_bibblock">Semantically Constrained Memory Allocation (SCMA) for Embedding in Efficient Recommendation Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.4.1">CoRR</em> abs/2103.06124 (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Esser et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Steven K. Esser, Jeffrey L. McKinstry, Deepika Bablani, Rathinakumar Appuswamy, and Dharmendra S. Modha. 2020.

</span>
<span class="ltx_bibblock">Learned Step Size quantization. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">8th International Conference on Learning Representations, ICLR 2020, Addis Ababa, Ethiopia, April 26-30, 2020</em>. OpenReview.net.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghaemmaghami et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Benjamin Ghaemmaghami, Zihao Deng, Benjamin Y. Cho, et al<span class="ltx_text" id="bib.bib15.3.1">.</span> 2020.

</span>
<span class="ltx_bibblock">Training with Multi-Layer Embeddings for Model Reduction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.4.1">CoRR</em> abs/2006.05623 (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ginart et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Antonio A. Ginart, Maxim Naumov, Dheevatsa Mudigere, Jiyan Yang, and James Zou. 2021.

</span>
<span class="ltx_bibblock">Mixed Dimension Embeddings with Application to Memory-Efficient Recommendation Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">IEEE International Symposium on Information Theory, ISIT 2021, Melbourne, Australia, July 12-20, 2021</em>. IEEE, 2786–2791.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guan et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Hui Guan, Andrey Malevich, Jiyan Yang, Jongsoo Park, and Hector Yuen. 2019.

</span>
<span class="ltx_bibblock">Post-Training 4-bit Quantization on Embedding Tables.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">CoRR</em> abs/1911.02079 (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Huifeng Guo, Wei Guo, Yong Gao, Ruiming Tang, Xiuqiang He, and Wenzhi Liu. 2021.

</span>
<span class="ltx_bibblock">ScaleFreeCTR: MixCache-based Distributed Training System for CTR Models with Huge Embedding Table. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">SIGIR ’21: The 44th International ACM SIGIR Conference on Research and Development in Information Retrieval, Virtual Event, Canada, July 11-15, 2021</em>. ACM, 1269–1278.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Huifeng Guo, Ruiming Tang, Yunming Ye, Zhenguo Li, and Xiuqiang He. 2017.

</span>
<span class="ltx_bibblock">DeepFM: A Factorization-Machine based Neural Network for CTR Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Proceedings of the Twenty-Sixth International Joint Conference on Artificial Intelligence, IJCAI 2017, Melbourne, Australia, August 19-25, 2017</em>. ijcai.org, 1725–1731.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta and Agrawal (2022)</span>
<span class="ltx_bibblock">
Manish Gupta and Puneet Agrawal. 2022.

</span>
<span class="ltx_bibblock">Compression of Deep Learning Models for Text: A Survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">ACM Trans. Knowl. Discov. Data</em> 16, 4 (2022), 61:1–61:55.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Kai Han, Yunhe Wang, Qi Tian, Jianyuan Guo, Chunjing Xu, and Chang Xu. 2020.

</span>
<span class="ltx_bibblock">GhostNet: More Features From Cheap Operations. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">2020 IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2020, Seattle, WA, USA, June 13-19, 2020</em>. 1577–1586.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xin He, Kaiyong Zhao, and Xiaowen Chu. 2021.

</span>
<span class="ltx_bibblock">AutoML: A Survey of the State-of-the-Art.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Knowledge-Based Systems</em> 212 (2021), 106622.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jang et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Eric Jang, Shixiang Gu, and Ben Poole. 2017.

</span>
<span class="ltx_bibblock">Categorical Reparameterization with Gumbel-Softmax. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">5th International Conference on Learning Representations, ICLR 2017, Toulon, France, April 24-26, 2017, Conference Track Proceedings</em>. OpenReview.net.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jégou et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Hervé Jégou, Matthijs Douze, and Cordelia Schmid. 2011.

</span>
<span class="ltx_bibblock">Product Quantization for Nearest Neighbor Search.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">IEEE Trans. Pattern Anal. Mach. Intell.</em> 33, 1 (2011), 117–128.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Gangwei Jiang, Hao Wang, Jin Chen, Haoyu Wang, Defu Lian, and Enhong Chen. 2021.

</span>
<span class="ltx_bibblock">xLightFM: Extremely Memory-Efficient Factorization Machine. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">SIGIR ’21: The 44th International ACM SIGIR Conference on Research and Development in Information Retrieval, Virtual Event, Canada, July 11-15, 2021</em>. ACM, 337–346.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joglekar et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Manas R. Joglekar, Cong Li, Mei Chen, Taibai Xu, Xiaoming Wang, Jay K. Adams, Pranav Khaitan, Jiahui Liu, and Quoc V. Le. 2020.

</span>
<span class="ltx_bibblock">Neural Input Search for Large Scale Recommendation Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">KDD ’20: The 26th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, Virtual Event, CA, USA, August 23-27, 2020</em>. ACM, 2387–2397.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang, Derek Zhiyuan Cheng, Ting Chen, Xinyang Yi, Dong Lin, Lichan Hong, and Ed H. Chi. 2020.

</span>
<span class="ltx_bibblock">Learning Multi-granular Quantized Embeddings for Large-Vocab Categorical Features in Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Companion of The 2020 Web Conference 2020, Taipei, Taiwan, April 20-24, 2020</em>. ACM / IW3C2, 562–566.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang, Derek Zhiyuan Cheng, Tiansheng Yao, Xinyang Yi, Ting Chen, Lichan Hong, and Ed H. Chi. 2021.

</span>
<span class="ltx_bibblock">Learning to Embed Categorical Features without Embedding Tables for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">KDD ’21: The 27th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, Virtual Event, Singapore, August 14-18, 2021</em>. ACM, 840–850.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2019)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian John McAuley. 2019.

</span>
<span class="ltx_bibblock">Candidate Generation with Binary Codes for Large-Scale Top-N Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management, CIKM 2019, Beijing, China, November 3-7, 2019</em>. ACM, 1523–1532.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khawar et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Farhan Khawar, Xu Hang, Ruiming Tang, Bin Liu, Zhenguo Li, and Xiuqiang He. 2020.

</span>
<span class="ltx_bibblock">AutoFeature: Searching for Feature Interactions and Their Architectures for Click-through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">CIKM ’20: The 29th ACM International Conference on Information and Knowledge Management, Virtual Event, Ireland, October 19-23, 2020</em>. ACM, 625–634.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Houyi Li, Zhihong Chen, Chenliang Li, Rong Xiao, Hongbo Deng, Peng Zhang, Yongchao Liu, and Haihong Tang. 2021.

</span>
<span class="ltx_bibblock">Path-based Deep Network for Candidate Item Matching in Recommenders. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">SIGIR ’21: The 44th International ACM SIGIR Conference on Research and Development in Information Retrieval, Virtual Event, Canada, July 11-15, 2021</em>. ACM, 1493–1502.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shiwei Li, Huifeng Guo, Lu Hou, Wei Zhang, Xing Tang, Ruiming Tang, Rui Zhang, and Ruixuan Li. 2023.

</span>
<span class="ltx_bibblock">Adaptive Low-Precision Training for Embeddings in Click-Through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Thirty-Seventh AAAI Conference on Artificial Intelligence, AAAI 2023, Thirty-Fifth Conference on Innovative Applications of Artificial Intelligence, IAAI 2023, Thirteenth Symposium on Educational Advances in Artificial Intelligence, EAAI 2023, Washington, DC, USA, February 7-14, 2023</em>. AAAI Press, 4435–4443.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Defu Lian, Yong Ge, Fuzheng Zhang, Nicholas Jing Yuan, Xing Xie, Tao Zhou, and Yong Rui. 2015.

</span>
<span class="ltx_bibblock">Content-Aware Collaborative Filtering for Location Recommendation Based on Human Mobility Data. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">2015 IEEE International Conference on Data Mining, ICDM 2015, Atlantic City, NJ, USA, November 14-17, 2015</em>. IEEE Computer Society, 261–270.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Defu Lian, Rui Liu, Yong Ge, Kai Zheng, Xing Xie, and Longbing Cao. 2017.

</span>
<span class="ltx_bibblock">Discrete Content-aware Matrix Factorization. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, Halifax, NS, Canada, August 13 - 17, 2017</em>. ACM, 325–334.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Defu Lian, Haoyu Wang, Zheng Liu, Jianxun Lian, Enhong Chen, and Xing Xie. 2020.

</span>
<span class="ltx_bibblock">LightRec: A Memory and Search-Efficient Recommender System. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">WWW ’20: The Web Conference 2020, Taipei, Taiwan, April 20-24, 2020</em>. ACM / IW3C2, 695–705.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Paul Pu Liang, Manzil Zaheer, Yuan Wang, and Amr Ahmed. 2021.

</span>
<span class="ltx_bibblock">Anchor &amp; Transform: Learning Sparse Embeddings for Large Vocabularies. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>. OpenReview.net.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2019b)</span>
<span class="ltx_bibblock">
Bin Liu, Ruiming Tang, Yingzhi Chen, Jinkai Yu, Huifeng Guo, and Yuzhou Zhang. 2019b.

</span>
<span class="ltx_bibblock">Feature Generation by Convolutional Neural Network for Click-Through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">The World Wide Web Conference, WWW 2019, San Francisco, CA, USA, May 13-17, 2019</em>. ACM, 1119–1129.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Han Liu, Xiangnan He, Fuli Feng, Liqiang Nie, Rui Liu, and Hanwang Zhang. 2018.

</span>
<span class="ltx_bibblock">Discrete Factorization Machines for Fast Feature-based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Proceedings of the Twenty-Seventh International Joint Conference on Artificial Intelligence, IJCAI 2018, July 13-19, 2018, Stockholm, Sweden</em>. ijcai.org, 3449–3455.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2019a)</span>
<span class="ltx_bibblock">
Hanxiao Liu, Karen Simonyan, and Yiming Yang. 2019a.

</span>
<span class="ltx_bibblock">DARTS: Differentiable Architecture Search. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">7th International Conference on Learning Representations, ICLR 2019, New Orleans, LA, USA, May 6-9, 2019</em>. OpenReview.net.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Haochen Liu, Xiangyu Zhao, Chong Wang, Xiaobing Liu, and Jiliang Tang. 2020.

</span>
<span class="ltx_bibblock">Automated Embedding Size Search in Deep Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval, SIGIR 2020, Virtual Event, China, July 25-30, 2020</em>. ACM, 2307–2316.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Qiang Liu, Feng Yu, Shu Wu, and Liang Wang. 2015.

</span>
<span class="ltx_bibblock">A Convolutional Click Prediction Model. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Proceedings of the 24th ACM International Conference on Information and Knowledge Management, CIKM 2015, Melbourne, VIC, Australia, October 19 - 23, 2015</em>. ACM, 1743–1746.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Siyi Liu, Chen Gao, Yihong Chen, Depeng Jin, and Yong Li. 2021.

</span>
<span class="ltx_bibblock">Learnable Embedding sizes for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</em>. OpenReview.net.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Xianglong Liu, Junfeng He, Cheng Deng, and Bo Lang. 2014.

</span>
<span class="ltx_bibblock">Collaborative Hashing. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">2014 IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2014, Columbus, OH, USA, June 23-28, 2014</em>. IEEE Computer Society, 2147–2154.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lyu et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Fuyuan Lyu, Xing Tang, Hong Zhu, Huifeng Guo, Yingxue Zhang, Ruiming Tang, and Xue Liu. 2022.

</span>
<span class="ltx_bibblock">OptEmbed: Learning Optimal Embedding Table for Click-through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management, Atlanta, GA, USA, October 17-21, 2022</em>. ACM, 1399–1409.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Xiao Ma, Liqin Zhao, Guan Huang, Zhi Wang, Zelin Hu, Xiaoqiang Zhu, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Entire Space Multi-Task Model: An Effective Approach for Estimating Post-Click Conversion Rate. In <em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">The 41st International ACM SIGIR Conference on Research &amp; Development in Information Retrieval, SIGIR 2018, Ann Arbor, MI, USA, July 08-12, 2018</em>, Kevyn Collins-Thompson, Qiaozhu Mei, Brian D. Davison, Yiqun Liu, and Emine Yilmaz (Eds.). ACM, 1137–1140.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mao et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Kelong Mao, Jieming Zhu, Jinpeng Wang, Quanyu Dai, Zhenhua Dong, Xi Xiao, and Xiuqiang He. 2021.

</span>
<span class="ltx_bibblock">SimpleX: A Simple and Strong Baseline for Collaborative Filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">CIKM ’21: The 30th ACM International Conference on Information and Knowledge Management, Virtual Event, Queensland, Australia, November 1 - 5, 2021</em>. ACM, 1243–1252.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Gary Holt, David Sculley, Michael Young, Dietmar Ebner, Julian Grady, Lan Nie, Todd Phillips, Eugene Davydov, Daniel Golovin, Sharat Chikkerur, Dan Liu, Martin Wattenberg, Arnar Mar Hrafnkelsson, Tom Boulos, and Jeremy Kubica. 2013.

</span>
<span class="ltx_bibblock">Ad click prediction: a view from the trenches. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">The 19th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, KDD 2013, Chicago, IL, USA, August 11-14, 2013</em>. ACM, 1222–1230.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pansare et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Niketan Pansare, Jay Katukuri, Aditya Arora, Frank Cipollone, Riyaaz Shaik, Noyan Tokgozoglu, and Chandru Venkataraman. 2022.

</span>
<span class="ltx_bibblock">Learning Compressed Embeddings for On-Device Inference. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">Proceedings of Machine Learning and Systems 2022, MLSys 2022, Santa Clara, CA, USA, August 29 - September 1, 2022</em>. mlsys.org.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Liang Qu, Yonghong Ye, Ningzhi Tang, Lixin Zhang, Yuhui Shi, and Hongzhi Yin. 2022.

</span>
<span class="ltx_bibblock">Single-shot Embedding Dimension Search in Recommender System. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">SIGIR ’22: The 45th International ACM SIGIR Conference on Research and Development in Information Retrieval, Madrid, Spain, July 11 - 15, 2022</em>. ACM, 513–522.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle (2010)</span>
<span class="ltx_bibblock">
Steffen Rendle. 2010.

</span>
<span class="ltx_bibblock">Factorization Machines. In <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">ICDM 2010, The 10th IEEE International Conference on Data Mining, Sydney, Australia, 14-17 December 2010</em>. IEEE Computer Society, 995–1000.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Hao-Jun Michael Shi, Dheevatsa Mudigere, Maxim Naumov, and Jiyan Yang. 2020.

</span>
<span class="ltx_bibblock">Compositional Embeddings Using Complementary Partitions for Memory-Efficient Recommendation Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">KDD ’20: The 26th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, Virtual Event, CA, USA, August 23-27, 2020</em>. ACM, 165–175.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al<span class="ltx_text" id="bib.bib52.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yixin Su, Rui Zhang, Sarah M. Erfani, and Zhenghua Xu. 2021.

</span>
<span class="ltx_bibblock">Detecting Beneficial Feature Interactions for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">Thirty-Fifth AAAI Conference on Artificial Intelligence, AAAI 2021, Thirty-Third Conference on Innovative Applications of Artificial Intelligence, IAAI 2021, The Eleventh Symposium on Educational Advances in Artificial Intelligence, EAAI 2021, Virtual Event, February 2-9, 2021</em>. AAAI Press, 4357–4365.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al<span class="ltx_text" id="bib.bib53.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yixin Su, Yunxiang Zhao, Sarah M. Erfani, Junhao Gan, and Rui Zhang. 2022.

</span>
<span class="ltx_bibblock">Detecting Arbitrary Order Beneficial Feature Interactions for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">KDD ’22: The 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, Washington, DC, USA, August 14 - 18, 2022</em>. ACM, 1676–1686.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib54.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yang Sun, Fajie Yuan, Min Yang, Guoao Wei, Zhou Zhao, and Duo Liu. 2020.

</span>
<span class="ltx_bibblock">A Generic Network Compression Framework for Sequential Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib54.3.1">Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval, SIGIR 2020, Virtual Event, China, July 25-30, 2020</em>. ACM, 1299–1308.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al<span class="ltx_text" id="bib.bib55.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Qiaoyu Tan, Ninghao Liu, Xing Zhao, Hongxia Yang, Jingren Zhou, and Xia Hu. 2020.

</span>
<span class="ltx_bibblock">Learning to Hash with Graph Neural Networks for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib55.3.1">WWW ’20: The Web Conference 2020, Taipei, Taiwan, April 20-24, 2020</em>. ACM / IW3C2, 1988–1998.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib56.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jinpeng Wang, Ziyun Zeng, Yunxiao Wang, Yuting Wang, Xingyu Lu, Tianxiang Li, Jun Yuan, Rui Zhang, Hai-Tao Zheng, and Shu-Tao Xia. 2023.

</span>
<span class="ltx_bibblock">MISSRec: Pre-training and Transferring Multi-modal Interest-aware Sequence Representation for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib56.3.1">Proceedings of the 31st ACM International Conference on Multimedia, MM 2023, Ottawa, ON, Canada, 29 October 2023- 3 November 2023</em>. ACM, 6548–6557.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib57.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Qinyong Wang, Hongzhi Yin, Tong Chen, Zi Huang, Hao Wang, Yanchang Zhao, and Nguyen Quoc Viet Hung. 2020.

</span>
<span class="ltx_bibblock">Next Point-of-Interest Recommendation on Resource-Constrained Mobile Devices. In <em class="ltx_emph ltx_font_italic" id="bib.bib57.3.1">WWW ’20: The Web Conference 2020, Taipei, Taiwan, April 20-24, 2020</em>. ACM / IW3C2, 906–916.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib58.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Bin Fu, Gang Fu, and Mingliang Wang. 2017.

</span>
<span class="ltx_bibblock">Deep &amp; Cross Network for Ad Click Predictions. In <em class="ltx_emph ltx_font_italic" id="bib.bib58.3.1">Proceedings of the ADKDD’17, Halifax, NS, Canada, August 13 - 17, 2017</em>. ACM, 12:1–12:7.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib59.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Rakesh Shivanna, Derek Zhiyuan Cheng, Sagar Jain, Dong Lin, Lichan Hong, and Ed H. Chi. 2021.

</span>
<span class="ltx_bibblock">DCN V2: Improved Deep &amp; Cross Network and Practical Lessons for Web-scale Learning to Rank Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib59.3.1">WWW ’21: The Web Conference 2021, Virtual Event / Ljubljana, Slovenia, April 19-23, 2021</em>. ACM / IW3C2, 1785–1797.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span class="ltx_text" id="bib.bib60.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhikun Wei, Xin Wang, and Wenwu Zhu. 2021.

</span>
<span class="ltx_bibblock">AutoIAS: Automatic Integrated Architecture Searcher for Click-Trough Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib60.3.1">CIKM ’21: The 30th ACM International Conference on Information and Knowledge Management, Virtual Event, Queensland, Australia, November 1 - 5, 2021</em>. ACM, 2101–2110.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weinberger et al<span class="ltx_text" id="bib.bib61.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Kilian Q. Weinberger, Anirban Dasgupta, John Langford, Alexander J. Smola, and Josh Attenberg. 2009.

</span>
<span class="ltx_bibblock">Feature hashing for large scale multitask learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib61.3.1">Proceedings of the 26th Annual International Conference on Machine Learning, ICML 2009, Montreal, Quebec, Canada, June 14-18, 2009</em> <em class="ltx_emph ltx_font_italic" id="bib.bib61.4.2">(ACM International Conference Proceeding Series, Vol. 382)</em>. ACM, 1113–1120.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib62.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Le Wu, Xiangnan He, Xiang Wang, Kun Zhang, and Meng Wang. 2023.

</span>
<span class="ltx_bibblock">A Survey on Accuracy-Oriented Neural Recommendation: From Collaborative Filtering to Information-Rich Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.3.1">IEEE Trans. Knowl. Data Eng.</em> 35, 5 (2023), 4425–4445.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib63.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiaorui Wu, Hong Xu, Honglin Zhang, Huaming Chen, and Jian Wang. 2020.

</span>
<span class="ltx_bibblock">Saec: similarity-aware embedding compression in recommendation systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib63.3.1">APSys ’20: 11th ACM SIGOPS Asia-Pacific Workshop on Systems, Tsukuba, Japan, August 24-25, 2020</em>. ACM, 82–89.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib64.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yongji Wu, Defu Lian, Neil Zhenqiang Gong, Lu Yin, Mingyang Yin, Jingren Zhou, and Hongxia Yang. 2021.

</span>
<span class="ltx_bibblock">Linear-Time Self Attention with Codeword Histogram for Efficient Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib64.3.1">WWW ’21: The Web Conference 2021, Virtual Event / Ljubljana, Slovenia, April 19-23, 2021</em>. ACM / IW3C2, 1262–1273.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al<span class="ltx_text" id="bib.bib65.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Xin Xia, Hongzhi Yin, Junliang Yu, Qinyong Wang, Guandong Xu, and Quoc Viet Hung Nguyen. 2022.

</span>
<span class="ltx_bibblock">On-Device Next-Item Recommendation with Self-Supervised Knowledge Distillation. In <em class="ltx_emph ltx_font_italic" id="bib.bib65.3.1">SIGIR ’22: The 45th International ACM SIGIR Conference on Research and Development in Information Retrieval, Madrid, Spain, July 11 - 15, 2022</em>. ACM, 546–555.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al<span class="ltx_text" id="bib.bib66.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Jun Xiao, Hao Ye, Xiangnan He, Hanwang Zhang, Fei Wu, and Tat-Seng Chua. 2017.

</span>
<span class="ltx_bibblock">Attentional Factorization Machines: Learning the Weight of Feature Interactions via Attention Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib66.3.1">Proceedings of the Twenty-Sixth International Joint Conference on Artificial Intelligence, IJCAI 2017, Melbourne, Australia, August 19-25, 2017</em>. ijcai.org, 3119–3125.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span class="ltx_text" id="bib.bib67.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhiqiang Xu, Dong Li, Weijie Zhao, Xing Shen, Tianbo Huang, Xiaoyun Li, and Ping Li. 2021.

</span>
<span class="ltx_bibblock">Agile and Accurate CTR Prediction Model Training for Massive-Scale Online Advertising Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib67.3.1">SIGMOD ’21: International Conference on Management of Data, Virtual Event, China, June 20-25, 2021</em>. ACM, 2404–2409.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al<span class="ltx_text" id="bib.bib68.2.2.1">.</span> (2021a)</span>
<span class="ltx_bibblock">
Bencheng Yan, Pengjie Wang, Jinquan Liu, Wei Lin, Kuang-Chih Lee, Jian Xu, and Bo Zheng. 2021a.

</span>
<span class="ltx_bibblock">Binary Code based Hash Embedding for Web-scale Applications. In <em class="ltx_emph ltx_font_italic" id="bib.bib68.3.1">CIKM ’21: The 30th ACM International Conference on Information and Knowledge Management, Virtual Event, Queensland, Australia, November 1 - 5, 2021</em>. ACM, 3563–3567.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al<span class="ltx_text" id="bib.bib69.2.2.1">.</span> (2021b)</span>
<span class="ltx_bibblock">
Bencheng Yan, Pengjie Wang, Kai Zhang, Wei Lin, Kuang-Chih Lee, Jian Xu, and Bo Zheng. 2021b.

</span>
<span class="ltx_bibblock">Learning Effective and Efficient Embedding via an Adaptively-Masked Twins-based Layer. In <em class="ltx_emph ltx_font_italic" id="bib.bib69.3.1">CIKM ’21: The 30th ACM International Conference on Information and Knowledge Management, Virtual Event, Queensland, Australia, November 1 - 5, 2021</em>. ACM, 3568–3572.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib70.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jie Amy Yang, Jianyu Huang, Jongsoo Park, Ping Tak Peter Tang, and Andrew Tulloch. 2020.

</span>
<span class="ltx_bibblock">Mixed-Precision Embedding Using a Cache.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib70.3.1">CoRR</em> abs/2010.11305 (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al<span class="ltx_text" id="bib.bib71.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Quanming Yao, Xiangning Chen, James T. Kwok, Yong Li, and Cho-Jui Hsieh. 2020.

</span>
<span class="ltx_bibblock">Efficient Neural Interaction Function Search for Collaborative Filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib71.3.1">WWW ’20: The Web Conference 2020, Taipei, Taiwan, April 20-24, 2020</em>. ACM / IW3C2, 1660–1670.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al<span class="ltx_text" id="bib.bib72.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Chunxing Yin, Bilge Acun, Carole-Jean Wu, and Xing Liu. 2021.

</span>
<span class="ltx_bibblock">TT-Rec: Tensor Train Compression for Deep Learning Recommendation Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib72.3.1">Proceedings of Machine Learning and Systems 2021, MLSys 2021, virtual, April 5-9, 2021</em>. mlsys.org.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib73.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Caojin Zhang, Yicun Liu, Yuanpu Xie, Sofia Ira Ktena, Alykhan Tejani, Akshay Gupta, Pranay Kumar Myana, Deepak Dilipkumar, Suvadip Paul, Ikuhiro Ihara, Prasang Upadhyaya, Ferenc Huszar, and Wenzhe Shi. 2020.

</span>
<span class="ltx_bibblock">Model Size Reduction Using Frequency Based Double Hashing for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib73.3.1">RecSys 2020: Fourteenth ACM Conference on Recommender Systems, Virtual Event, Brazil, September 22-26, 2020</em>. ACM, 521–526.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib74.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Hanwang Zhang, Fumin Shen, Wei Liu, Xiangnan He, Huanbo Luan, and Tat-Seng Chua. 2016.

</span>
<span class="ltx_bibblock">Discrete Collaborative Filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib74.3.1">Proceedings of the 39th International ACM SIGIR conference on Research and Development in Information Retrieval, SIGIR 2016, Pisa, Italy, July 17-21, 2016</em>. ACM, 325–334.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib75.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shuai Zhang, Lina Yao, Aixin Sun, and Yi Tay. 2019.

</span>
<span class="ltx_bibblock">Deep Learning Based Recommender System: A Survey and New Perspectives.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib75.3.1">ACM Comput. Surv.</em> 52, 1 (2019), 5:1–5:38.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib76.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Weinan Zhang, Jiarui Qin, Wei Guo, Ruiming Tang, and Xiuqiang He. 2021.

</span>
<span class="ltx_bibblock">Deep Learning for Click-Through Rate Estimation. In <em class="ltx_emph ltx_font_italic" id="bib.bib76.3.1">Proceedings of the Thirtieth International Joint Conference on Artificial Intelligence, IJCAI 2021, Virtual Event / Montreal, Canada, 19-27 August 2021</em>. ijcai.org, 4695–4703.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib77.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Yan Zhang, Defu Lian, and Guowu Yang. 2017.

</span>
<span class="ltx_bibblock">Discrete Personalized Ranking for Fast Collaborative Filtering from Implicit Feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib77.3.1">Proceedings of the Thirty-First AAAI Conference on Artificial Intelligence, February 4-9, 2017, San Francisco, California, USA</em>. AAAI Press, 1669–1675.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib78.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Zhiwei Zhang, Qifan Wang, Lingyun Ruan, and Luo Si. 2014.

</span>
<span class="ltx_bibblock">Preference preserving hashing for efficient recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib78.3.1">The 37th International ACM SIGIR Conference on Research and Development in Information Retrieval, SIGIR ’14, Gold Coast , QLD, Australia - July 06 - 11, 2014</em>. ACM, 183–192.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib79.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiangyu Zhao, Haochen Liu, Wenqi Fan, Hui Liu, Jiliang Tang, Chong Wang, Ming Chen, Xudong Zheng, Xiaobing Liu, and Xiwang Yang. 2021.

</span>
<span class="ltx_bibblock">AutoEmb: Automated Embedding Dimensionality Search in Streaming Recommendations.

</span>
<span class="ltx_bibblock">(2021), 896–905.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib80.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiangyu Zhao, Haochen Liu, Hui Liu, Jiliang Tang, Weiwei Guo, Jun Shi, Sida Wang, Huiji Gao, and Bo Long. 2020.

</span>
<span class="ltx_bibblock">Memory-efficient Embedding for Recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib80.3.1">CoRR</em> abs/2006.14827 (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib81.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guorui Zhou, Xiaoqiang Zhu, Chengru Song, Ying Fan, Han Zhu, Xiao Ma, Yanghui Yan, Junqi Jin, Han Li, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Deep Interest Network for Click-Through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib81.3.1">Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining, KDD 2018, London, UK, August 19-23, 2018</em>. ACM, 1059–1068.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib82.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jieming Zhu, Quanyu Dai, Liangcai Su, Rong Ma, Jinyang Liu, Guohao Cai, Xi Xiao, and Rui Zhang. 2022.

</span>
<span class="ltx_bibblock">BARS: Towards Open Benchmarking for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib82.3.1">SIGIR ’22: The 45th International ACM SIGIR Conference on Research and Development in Information Retrieval, Madrid, Spain, July 11 - 15, 2022</em>. ACM, 2912–2923.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zoph and Le (2017)</span>
<span class="ltx_bibblock">
Barret Zoph and Quoc V. Le. 2017.

</span>
<span class="ltx_bibblock">Neural Architecture Search with Reinforcement Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib83.1.1">5th International Conference on Learning Representations, ICLR 2017, Toulon, France, April 24-26, 2017, Conference Track Proceedings</em>. OpenReview.net.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Aug  5 08:20:08 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
